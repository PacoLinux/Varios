
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:1    
        1        1        /*M* ZIG$DDC5         I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        DOEIS:
        8        8            PROC;
        9        9    1   DCL VAR_FIELDS SBIN HALF;
       10       10    1   DCL INDEX_NUM SBIN WORD STATIC;
       11       11    1   DCL CALC_NXT UBIN WORD STATIC;
       12       12    1   DCL CALC_PRI UBIN WORD STATIC;
       13       13    1   DCL GLOBAL_SIZE SBIN HALF STATIC;
       14       14    1   DCL PA_SIZE_1 SBIN WORD STATIC;
       15       15    1   DCL PA_SIZE_N SBIN WORD STATIC;
       16       16    1   DCL ALLOW SBIN WORD STATIC;
       17       17    1   DCL X SBIN WORD STATIC;
       18       18    1   DCL 01 XEIS STATIC,
       19       19    1         02 FIL1 BIT(3) INIT('011'B),
       20       20    1         02 BWRD BIT(15),
       21       21    1         02 BCHR BIT(3),
       22       22    1         02 FIL2 BIT(3) INIT('000'B),
       23       23    1         02 PREC BIT(12);
       24       24    1   DCL 01 EIS1 STATIC,
       25       25    1         02 FIL1 BIT(3) INIT('011'B),
       26       26    1         02 BWRD BIT(15),
       27       27    1         02 BCHR BIT(3),
       28       28    1         02 TYP BIT(1) INIT('1'B),
       29       29    1         02 SIGN BIT(2),
       30       30    1         02 SCALE BIT(6),
       31       31    1         02 PREC BIT(6);
       32       32        /* DCL 01 PNT_FR STATIC,
       33       33               02 FIL1 BIT(34),
       34       34               02 FTYPE BIT(5) INIT('00101'B),
       35       35               02 PREC BIT(12) INIT('000000000011'B),
       36       36               02 SCALE BIT(8) INIT('00000000'B),
       37       37               02 SIGN BIT(1) INIT('0'B),
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:2    
       38       38               02 FIL2 BIT(30),
       39       39               02 FIL3 BIT(36) ALIGNED,
       40       40               02 BUFFLOC BIT(36);   */
       41       41    1   DCL 01 MAP STATIC,
       42       42    1         02 XWORD SBIN HALF,
       43       43    1         02 HBYTE SBIN HALF;
       44       44    1   DCL P1 PTR;
       45       45    1   DCL P2 PTR;
       46       46         /* DEFINE DBCS INTERFACE ROUTINES */
       47       47         /* RETURN TO LABEL WILL ONLY OCCUR FOR FETCHNS WHEN A
       48       48            NON-ZERO STATUS OCCURS. FOR ALL OTHER ROUTINES
       49       49            THE 'LABEL' IS A DUMMY, BECAUSE OR A NON-ZERO
       50       50            STATUS THE DBCS ABORTS */
       51       51         /* FIND DBK AND GET */
       52       52    1   DCL 01 CURRENT EXT,
       53       53    1         02 CM BIT(36),
       54       54    1         02 RCM BIT(36),
       55       55    1         02 DNACM BIT(36),
       56       56    1         02 STATUS SBIN HALF,
       57       57    1         02 SUBENTRY SBIN WORD,
       58       58    1         02 SEPNTR SBIN WORD,
       59       59    1         02 SNPNTR SBIN WORD;
       60       60        %INCLUDE ZIA_IDS_DCL;
       61      168        %INCLUDE ZIG_DBA_INT;
       62      216        %INCLUDE ZI_ERRORS_SUBS;
       63      736        %INCLUDE ZI_SUB4_CAN;
       64     1393        %INCLUDE ZIG_GENERAL;
       65     1501        %LIST;
       66     1502        %UWA;
              1503    1   DCL 1    NAME EXT DALIGNED,
              1504    1         2 WORD1        SBIN (36) INIT (0)   UNAL,
              1505    1         2 DB_STATUS    CHAR (7)  INIT (' ') UNAL,
              1506    1         2 *            CHAR (1)  INIT (' ') UNAL,
              1507    1         2 AREA_NAME    CHAR (30) INIT (' ') UNAL,
              1508    1         2 *            UBIN (18) INIT (0)   UNAL,
              1509    1         2 SET_NAME     CHAR (30) INIT (' ') UNAL,
              1510    1         2 *            UBIN (18) INIT (0)   UNAL,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:3    
              1511    1         2 RECORD_NAME  CHAR (30) INIT (' ') UNAL,
              1512    1         2 *            UBIN (18) INIT (0)   UNAL,
              1513    1         2 PRIVACY_KEY  CHAR (12) INIT (' ') UNAL,
              1514    1         2 DIRECT_REF   UBIN (36) INIT (0)   UNAL,
              1515    1         2 DATA_NAME    CHAR (30) INIT (' ') UNAL,
              1516    1         2 *            UBIN (18) INIT (0)   UNAL,
              1517    1         2 KEY_NAME     CHAR (30) INIT (' ') UNAL,
              1518    1         2 *            UBIN (18) INIT (0)   UNAL,
              1519    1         2 *            UBIN (36) INIT (0)   UNAL,
              1520    1         2 SF DALIGNED,
              1521    1           3 RLSE CHAR (5) INIT (' ') UNAL,
              1522    1           3 DBKEY_SA UBIN (36) INIT (0) ALIGNED,
              1523    1           3 DBKEY_OA UBIN (36) INIT (0) ALIGNED,
              1524    1           3 DBKEY_DA UBIN (36) INIT (0) ALIGNED,
              1525    1           3 DBKEY_TA UBIN (36) INIT (0) ALIGNED,
              1526    1         2 AS DALIGNED,
              1527    1           3 SS_NAME CHAR (30) INIT (' ') UNAL,
              1528    1           3 SS_TRAN CHAR (12) INIT (' ') UNAL,
              1529    1           3 SS_LANG SBIN (36)  INIT (0) ALIGNED,
              1530    1           3 SS_DATE CHAR (4) INIT (' ') UNAL,
              1531    1           3 SS_TIME CHAR (4) INIT (' ') UNAL,
              1532    1         2 PG DALIGNED,
              1533    1           3 PROG_NAME CHAR (30) INIT (' ') UNAL,
              1534    1           3 AUTH CHAR (30) INIT (' ') UNAL,
              1535    1           3 COMP_DATE CHAR (12) INIT (' ') UNAL,
              1536    1         2 CA DALIGNED,
              1537    1           3 OWNER_TYPE SBIN (36)  INIT (0) ALIGNED,
              1538    1           3 OWNER_NAME CHAR (30) INIT (' ') UNAL,
              1539    1           3 CAT_FILE SBIN (36)  INIT (0) ALIGNED,
              1540    1           3 CFNAME CHAR (12) INIT (' ') UNAL,
              1541    1           3 PWORD CHAR (12) INIT (' ') UNAL,
              1542    1         2 SI DALIGNED,
              1543    1           3 LOCKED SBIN (36)  INIT (0) ALIGNED,
              1544    1           3 BINDCD SBIN (36)  INIT (0) ALIGNED,
              1545    1           3 LI_NE SBIN (36)  INIT (0) ALIGNED,
              1546    1           3 EXCLUDE SBIN (36)  INIT (0) ALIGNED,
              1547    1           3 SETYPE SBIN (36)  INIT (0) ALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:4    
              1548    1           3 A_LIAS SBIN (36)  INIT (0) ALIGNED,
              1549    1         2 AL DALIGNED,
              1550    1           3 ANAME CHAR (30) INIT (' ') UNAL,
              1551    1           3 DBKEY_SI SBIN (36)  INIT (0) ALIGNED,
              1552    1         2 VB DALIGNED,
              1553    1           3 V_TYPE SBIN(36) INIT(0) ALIGNED,
              1554    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1555    1         2 A_D DALIGNED,
              1556    1           3 AD_FUNCTION SBIN (36)  INIT (0) ALIGNED,
              1557    1           3 AD_DATE CHAR (12) INIT (' ') UNAL,
              1558    1           3 AD_IDENT CHAR (60) INIT (' ') UNAL,
              1559    1         2 OA DALIGNED,
              1560    1           3 NUMB_AC SBIN (36)  INIT (0) ALIGNED,
              1561    1           3 NUMB_RC SBIN (36)  INIT (0) ALIGNED,
              1562    1           3 NUMB_SC SBIN (36)  INIT (0) ALIGNED,
              1563    1           3 NUMB_RA SBIN (36)  INIT (0) ALIGNED,
              1564    1           3 NUMB_FR SBIN (36)  INIT (0) ALIGNED,
              1565    1           3 NUMB_SO SBIN (36)  INIT (0) ALIGNED,
              1566    1           3 NUMB_SM SBIN (36)  INIT (0) ALIGNED,
              1567    1           3 NUMB_SS SBIN (36)  INIT (0) ALIGNED,
              1568    1           3 NUMB_CF SBIN (36)  INIT (0) ALIGNED,
              1569    1           3 COEXIST SBIN (36)  INIT (0) ALIGNED,
              1570    1           3 GLOBAL SBIN (36)  INIT (0) ALIGNED,
              1571    1           3 FILE_CODE CHAR (2) INIT (' ') UNAL,
              1572    1           3 OA_CALC UBIN (36) INIT (0) ALIGNED,
              1573    1         2 AC DALIGNED,
              1574    1           3 DEFAULTS SBIN (36)  INIT (0) ALIGNED,
              1575    1           3 FLAG1 REDEF DEFAULTS,
              1576    1             4 ERROR_TYPE (0:26) BIT (1) UNAL,
              1577    1             4 ERROR_NUM REDEF ERROR_TYPE UBIN (27) UNAL,
              1578    1             4 STATUS  UBIN (9) UNAL,
              1579    1           3 FILE_CODE CHAR (2) INIT (' ') UNAL,
              1580    1           3 FLAGS REDEF FILE_CODE,
              1581    1             4 CHKSUM BIT (1) UNAL,
              1582    1             4 ENCRP  BIT (1) UNAL,
              1583    1             4 CJRNL  BIT (1) UNAL,
              1584    1             4 TMPLT  BIT (1) UNAL,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:5    
              1585    1             4 TJRNL BIT (1) UNAL,
              1586    1             4 *      BIT (13) UNAL,
              1587    1           3 INDEX_CODE CHAR (2) INIT (' ') UNAL,
              1588    1           3 PRIME_KEY SBIN (36)  INIT (0) ALIGNED,
              1589    1           3 SEC_KEY SBIN (36)  INIT (0) ALIGNED,
              1590    1           3 PERMTYPE SBIN (36)  INIT (0) ALIGNED,
              1591    1           3 PAGE_TYP SBIN (36)  INIT (0) ALIGNED,
              1592    1           3 PER_INV SBIN (36)  INIT (0) ALIGNED,
              1593    1           3 CALC_NULL SBIN (36)  INIT (0) ALIGNED,
              1594    1           3 BASE_DBK SBIN (36)  INIT (0) ALIGNED,
              1595    1           3 KEYS_ALLOC SBIN (36)  INIT (0) ALIGNED,
              1596    1           3 KEYS_RSRVD SBIN (36)  INIT (0) ALIGNED,
              1597    1           3 MIN_DBK SBIN (36)  INIT (0) ALIGNED,
              1598    1           3 MAX_DBK SBIN (36)  INIT (0) ALIGNED,
              1599    1           3 MIN_PAGE SBIN (36)  INIT (0) ALIGNED,
              1600    1           3 MAX_PAGE SBIN (36)  INIT (0) ALIGNED,
              1601    1           3 CALC_HDRS SBIN (36)  INIT (0) ALIGNED,
              1602    1           3 FRST_INV_PG SBIN (36)  INIT (0) ALIGNED,
              1603    1           3 DBK_PAGE SBIN (36)  INIT (0) ALIGNED,
              1604    1           3 DBK_CALC SBIN (36)  INIT (0) ALIGNED,
              1605    1           3 LINE_BITS SBIN (36)  INIT (0) ALIGNED,
              1606    1           3 INV_THRESH SBIN (36)  INIT (0) ALIGNED,
              1607    1           3 LOAD_LIMIT SBIN (36)  INIT (0) ALIGNED,
              1608    1           3 PGS_INV_PG SBIN (36)  INIT (0) ALIGNED,
              1609    1           3 INV_UNIT SBIN (36)  INIT (0) ALIGNED,
              1610    1           3 PAGE_SIZE SBIN (36)  INIT (0) ALIGNED,
              1611    1           3 SPACE_AVAIL SBIN (36)  INIT (0) ALIGNED,
              1612    1           3 SECTORS_PAGE SBIN (36)  INIT (0) ALIGNED,
              1613    1           3 CALC_NEXT SBIN (36)  INIT (0) ALIGNED,
              1614    1           3 CALC_NEXT_STRUCT REDEF CALC_NEXT ALIGNED,
              1615    1             4 EIS,                        /* Eis descriptor                     */
              1616    1               5 REG UBIN (3) UNAL,
              1617    1               5 WD UBIN (15) UNAL,   /* assumes word offset is l.e. 2**15-1     */
              1618    1               5 CHR UBIN (3) UNAL,
              1619    1               5 TA UBIN (2) UNAL,
              1620    1               5 * BIT (1) UNAL,
              1621    1               5 COUNT UBIN (12) UNAL,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:6    
              1622    1           3 CALC_PRIOR SBIN (36)  INIT (0) ALIGNED,
              1623    1           3 CALC_PRIOR_STRUCT REDEF CALC_PRIOR ALIGNED,
              1624    1             4 EIS,                        /* Eis descriptor                     */
              1625    1               5 REG UBIN (3) UNAL,
              1626    1               5 WD UBIN (15) UNAL,   /* assumes word offset is l.e. 2**15-1     */
              1627    1               5 CHR UBIN (3) UNAL,
              1628    1               5 TA UBIN (2) UNAL,
              1629    1               5 * BIT (1) UNAL,
              1630    1               5 COUNT UBIN (12) UNAL,
              1631    1         2 RC DALIGNED,
              1632    1           3 RTYPE SBIN (36)  INIT (0) ALIGNED,
              1633    1           3 PSMODE SBIN (36)  INIT (0) ALIGNED,
              1634    1           3 FIXVAR SBIN (36)  INIT (0) ALIGNED,
              1635    1           3 WITHINA SBIN (36)  INIT (0) ALIGNED,
              1636    1           3 SO SBIN (36)  INIT (0) ALIGNED,
              1637    1           3 SM SBIN (36)  INIT (0) ALIGNED,
              1638    1           3 CYCLE SBIN (36)  INIT (0) ALIGNED,
              1639    1           3 CALCDUP SBIN (36)  INIT (0) ALIGNED,
              1640    1           3 ANY_IND SBIN (36)  INIT (0) ALIGNED,
              1641    1           3 KEY_PRESENT SBIN (36)  INIT (0) ALIGNED,
              1642    1           3 CV_OFFSET SBIN (36)  INIT (0) ALIGNED,
              1643    1           3 PA_OFFSET SBIN (36)  INIT (0) ALIGNED,
              1644    1           3 PA_ENTRY SBIN (36)  INIT (0) ALIGNED,
              1645    1           3 NUM_SOSM SBIN (36)  INIT (0) ALIGNED,
              1646    1           3 LSIZE SBIN (36)  INIT (0) ALIGNED,
              1647    1           3 SLACK SBIN (36)  INIT (0) ALIGNED,
              1648    1         2 SC DALIGNED,
              1649    1           3 SETTYPE SBIN (36)  INIT (0) ALIGNED,
              1650    1           3 SETMODE SBIN (36)  INIT (0) ALIGNED,
              1651    1           3 SETORD SBIN (36)  INIT (0) ALIGNED,
              1652    1           3 SETGLO SBIN (36)  INIT (0) ALIGNED,
              1653    1           3 SETPTR SBIN (36)  INIT (0) ALIGNED,
              1654    1           3 PTRNO SBIN (36)  INIT (0) ALIGNED,
              1655    1           3 ALTOWN SBIN (36)  INIT (0) ALIGNED,
              1656    1           3 RECSET SBIN (36)  INIT (0) ALIGNED,
              1657    1           3 SEQDUP SBIN (36)  INIT (0) ALIGNED,
              1658    1           3 PTRSZ SBIN (36)  INIT (0) ALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:7    
              1659    1           3 USER_PTS SBIN (36)  INIT (0) ALIGNED,
              1660    1           3 INDEX_ID SBIN (36)  INIT (0) ALIGNED,
              1661    1           3 KEY_LENGTH SBIN (36)  INIT (0) ALIGNED,
              1662    1         2 RA DALIGNED,
              1663    1           3 LOWDBK SBIN (36)  INIT (0) ALIGNED,
              1664    1           3 HIGHDBK SBIN (36)  INIT (0) ALIGNED,
              1665    1           3 CALC_HDRS SBIN (36)  INIT (0) ALIGNED,
              1666    1           3 HDR_OFFS SBIN (36)  INIT (0) ALIGNED,
              1667    1         2 FR DALIGNED,
              1668    1           3 SYN SBIN (36)  INIT (0) ALIGNED,
              1669    1           3 REF SBIN (36)  INIT (0) ALIGNED,
              1670    1           3 FTYPE SBIN (36)  INIT (0) ALIGNED,
              1671    1           3 PREC SBIN (36)  INIT (0) ALIGNED,
              1672    1           3 SCALE SBIN (36)  INIT (0) ALIGNED,
              1673    1           3 F_SIGN SBIN (36)  INIT (0) ALIGNED,
              1674    1           3 ALGN SBIN (36)  INIT (0) ALIGNED,
              1675    1           3 GROUP_ALIGN SBIN (36)  INIT (0) ALIGNED,
              1676    1           3 F_SYNC SBIN (36)  INIT (0) ALIGNED,
              1677    1           3 F_USE SBIN (36)  INIT (0) ALIGNED,
              1678    1           3 RPT SBIN (36)  INIT (0) ALIGNED,
              1679    1           3 F_OCCURS SBIN (36)  INIT (0) ALIGNED,
              1680    1           3 LEVEL SBIN (36)  INIT (0) ALIGNED,
              1681    1           3 DERIVED SBIN (36)  INIT (0) ALIGNED,
              1682    1           3 BEIST SBIN (36)  INIT (0) ALIGNED,
              1683    1           3 BUFFLOC SBIN (36)  INIT (0) ALIGNED,
              1684    1           3 FR_FRH UBIN (36) INIT (0) ALIGNED,
              1685    1         2 SO DALIGNED,
              1686    1           3 PSEQ SBIN (36)  INIT (0) ALIGNED,
              1687    1           3 NXTPNT SBIN (36)  INIT (0) ALIGNED,
              1688    1           3 PRIPNT SBIN (36)  INIT (0) ALIGNED,
              1689    1         2 SM DALIGNED,
              1690    1           3 INSTYPE SBIN (36)  INIT (0) ALIGNED,
              1691    1           3 RETTYPE SBIN (36)  INIT (0) ALIGNED,
              1692    1           3 MEMDUP SBIN (36)  INIT (0) ALIGNED,
              1693    1           3 SEQDUP SBIN (36)  INIT (0) ALIGNED,
              1694    1           3 CALCDUP SBIN (36)  INIT (0) ALIGNED,
              1695    1           3 PAMEM SBIN (36)  INIT (0) ALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:8    
              1696    1           3 PSMODE SBIN (36)  INIT (0) ALIGNED,
              1697    1           3 PSEQ SBIN (36)  INIT (0) ALIGNED,
              1698    1           3 NXTPNT SBIN (36)  INIT (0) ALIGNED,
              1699    1           3 PRIPNT SBIN (36)  INIT (0) ALIGNED,
              1700    1           3 HDPNT SBIN (36)  INIT (0) ALIGNED,
              1701    1           3 PA_MEMPNT SBIN (36)  INIT (0) ALIGNED,
              1702    1         2 S_S DALIGNED,
              1703    1           3 STYP SBIN (36)  INIT (0) ALIGNED,
              1704    1           3 SC_SSH UBIN (36) INIT (0) ALIGNED,
              1705    1           3 SOSM_SSH UBIN (36) INIT (0) ALIGNED,
              1706    1           3 USE_PA SBIN (36)  INIT (0) ALIGNED,
              1707    1         2 C_F DALIGNED,
              1708    1           3 SYN SBIN (36)  INIT (0) ALIGNED,
              1709    1           3 CTRLTYPE SBIN (36)  INIT (0) ALIGNED,
              1710    1           3 DERIVED SBIN (36)  INIT (0) ALIGNED,
              1711    1           3 CTRLSEQ SBIN (36)  INIT (0) ALIGNED,
              1712    1           3 CNVRT SBIN (36)  INIT (0) ALIGNED,
              1713    1         2 DA DALIGNED,
              1714    1           3 NUMB_SN SBIN (36)  INIT (0) ALIGNED,
              1715    1           3 NUMB_NR SBIN (36)  INIT (0) ALIGNED,
              1716    1           3 NUMB_LK SBIN (36)  INIT (0) ALIGNED,
              1717    1           3 NUMB_PN SBIN (36)  INIT (0) ALIGNED,
              1718    1           3 NUMB_LT SBIN (36)  INIT (0) ALIGNED,
              1719    1           3 NUMB_PT SBIN (36)  INIT (0) ALIGNED,
              1720    1           3 NUMB_AG SBIN (36)  INIT (0) ALIGNED,
              1721    1           3 FRST_AC UBIN (36) INIT (0) ALIGNED,
              1722    1           3 FRST_RC UBIN (36) INIT (0) ALIGNED,
              1723    1           3 FRST_SC UBIN (36) INIT (0) ALIGNED,
              1724    1           3 FRST_KC UBIN (36) INIT (0) ALIGNED,
              1725    1           3 FRST_FR UBIN (36) INIT (0) ALIGNED,
              1726    1         2 SN DALIGNED,
              1727    1           3 DCLR SBIN (36)  INIT (0) ALIGNED,
              1728    1           3 ESCAPE SBIN (36)  INIT (0) ALIGNED,
              1729    1           3 SETYPE SBIN (36)  INIT (0) ALIGNED,
              1730    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1731    1           3 ACTLCKS SBIN (36)  INIT (0) ALIGNED,
              1732    1           3 SENAME CHAR (30) INIT (' ') UNAL,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:9    
              1733    1         2 LK DALIGNED,
              1734    1           3 PLNAME CHAR (30) INIT (' ') UNAL,
              1735    1           3 PLVALUE CHAR (12) INIT (' ') UNAL,
              1736    1         2 PN DALIGNED,
              1737    1           3 LANG SBIN (36)  INIT (0) ALIGNED,
              1738    1           3 PNAME CHAR (30) INIT (' ') UNAL,
              1739    1         2 NR DALIGNED,
              1740    1           3 SRCE SBIN (36)  INIT (0) ALIGNED,
              1741    1           3 IMPLCT SBIN (36)  INIT (0) ALIGNED,
              1742    1           3 RELTYPE SBIN (36)  INIT (0) ALIGNED,
              1743    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1744    1         2 LT DALIGNED,
              1745    1           3 SUBENTRY SBIN (36)  INIT (0) ALIGNED,
              1746    1           3 PLOCKS SBIN (36)  INIT (0) ALIGNED,
              1747    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1748    1         2 PT DALIGNED,
              1749    1           3 PTYPE SBIN (36)  INIT (0) ALIGNED,
              1750    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1751    1         2 AG DALIGNED,
              1752    1           3 ATYPE SBIN (36)  INIT (0) ALIGNED,
              1753    1           3 AG_SE UBIN (36) INIT (0) ALIGNED,
              1754    1         2  TX DALIGNED,
              1755    1           3 A_TXT CHAR (60) INIT (' ') UNAL,
              1756    1         2 SA DALIGNED,
              1757    1           3 NUMB_DD SBIN (36)  INIT (0) ALIGNED,
              1758    1           3 NUMB_DM SBIN (36)  INIT (0) ALIGNED,
              1759    1         2 DD DALIGNED,
              1760    1           3 DD_TXT_LINE CHAR (80) INIT (' ') UNAL,
              1761    1         2 DM DALIGNED,
              1762    1           3 DMCL_TXT_LINE CHAR (80) INIT (' ') UNAL,
              1763    1         2 DBP DALIGNED,
              1764    1           3 DB_ADDR UBIN (36) INIT (0) ALIGNED,
              1765    1           3 DBP_SF_KEY UBIN (36) INIT (0) ALIGNED,
              1766    1         2 OSE DALIGNED,
              1767    1           3 OFFSET_SE SBIN (36)  INIT (0) ALIGNED,
              1768    1           3 DBKEY_SE UBIN (36) INIT (0) ALIGNED,
              1769    1         2 OSN DALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:10   
              1770    1           3 OFFSET_SN SBIN (36)  INIT (0) ALIGNED,
              1771    1           3 DBKEY_SN UBIN (36) INIT (0) ALIGNED,
              1772    1         2 TA DALIGNED,
              1773    1           3 NUM_TOKS SBIN (36)  INIT (0) ALIGNED,
              1774    1         2 TOK DALIGNED,
              1775    1           3 TTYPE SBIN (36)  INIT (0) ALIGNED,
              1776    1           3 T_CODE SBIN (36)  INIT (0) ALIGNED,
              1777    1           3 T_LINE SBIN (36)  INIT (0) ALIGNED,
              1778    1           3 T_START SBIN (36)  INIT (0) ALIGNED,
              1779    1           3 TLENGTH SBIN (36)  INIT (0) ALIGNED,
              1780    1           3 TVALUE SBIN (36)  INIT (0) ALIGNED,
              1781    1           3 WORD1 CHAR (30) INIT (' ') UNAL,
              1782    1         2 VOA DALIGNED,
              1783    1           3 VOA_DATA CHAR (40) INIT (' ') UNAL,
              1784    1         2 VAC DALIGNED,
              1785    1           3 VAC_DATA CHAR (92) INIT (' ') UNAL,
              1786    1         2 VRA DALIGNED,
              1787    1           3 VRA_DATA CHAR (36) INIT (' ') UNAL,
              1788    1         2 VRC DALIGNED,
              1789    1           3 VRC_DATA CHAR (44) INIT (' ') UNAL,
              1790    1         2 VFR DALIGNED,
              1791    1           3 VFR_DATA CHAR (36) INIT (' ') UNAL,
              1792    1         2 VSC DALIGNED,
              1793    1           3 VSC_DATA CHAR (24) INIT (' ') UNAL,
              1794    1         2 VSO DALIGNED,
              1795    1           3 VSO_DATA CHAR (28) INIT (' ') UNAL,
              1796    1         2 VSM DALIGNED,
              1797    1           3 VSM_DATA CHAR (48) INIT (' ') UNAL,
              1798    1         2 VSS DALIGNED,
              1799    1           3 VSS_DATA CHAR (24) INIT (' ') UNAL,
              1800    1         2 VCF DALIGNED,
              1801    1           3 VCF_DATA CHAR (36) INIT (' ') UNAL,
              1802    1         2 VDA DALIGNED,
              1803    1           3 VDA_DATA CHAR (48) INIT (' ') UNAL,
              1804    1         2 VSN DALIGNED,
              1805    1           3 VSN_DATA CHAR (76) INIT (' ') UNAL,
              1806    1         2 VNR DALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:11   
              1807    1           3 VNR_DATA CHAR (32) INIT (' ') UNAL,
              1808    1         2 VLK DALIGNED,
              1809    1           3 VLK_DATA CHAR (44) INIT (' ') UNAL,
              1810    1         2 VLT DALIGNED,
              1811    1           3 VLT_DATA CHAR (32) INIT (' ') UNAL,
              1812    1         2 VPN DALIGNED,
              1813    1           3 VPN_DATA CHAR (48) INIT (' ') UNAL,
              1814    1         2 VPT DALIGNED,
              1815    1           3 VPT_DATA CHAR (28) INIT (' ') UNAL,
              1816    1         2 VAG DALIGNED,
              1817    1           3 VAG_DATA CHAR (16) INIT (' ') UNAL,
              1818    1         2 VTA DALIGNED,
              1819    1           3 VTA_DATA CHAR (32) INIT (' ') UNAL,
              1820    1         2 VLM DALIGNED,
              1821    1           3 VLM_DATA CHAR (20) INIT (' ') UNAL,
              1822    1         2 VMK DALIGNED,
              1823    1           3 VMK_DATA CHAR (20) INIT (' ') UNAL,
              1824    1         2 VMD DALIGNED,
              1825    1           3 VMD_DATA CHAR (20) INIT (' ') UNAL,
              1826    1         2 VKN DALIGNED,
              1827    1           3 VKN_DATA CHAR (20) INIT (' ') UNAL,
              1828    1         2 VWI DALIGNED,
              1829    1           3 VWI_DATA CHAR (20) INIT (' ') UNAL,
              1830    1         2 VSP DALIGNED,
              1831    1           3 VSP_DATA CHAR (24) INIT (' ') UNAL,
              1832    1         2 VT2 DALIGNED,
              1833    1           3 VT2_DATA CHAR (20) INIT (' ') UNAL,
              1834    1         2 VCTK DALIGNED,
              1835    1           3 VCTK_DATA CHAR (48) INIT (' ') UNAL;
       67     1837        %PLIST;
       68     1838    1   DCL 01 SOSM_TB(0:0) BASED(SP),
       69     1839    1         02 NAME CHAR(30), /* SET NAME (SN) */
       70     1840    1         02 XADDR SBIN WORD, /* SO OR SM DBK */
       71     1841    1         02 REC_TYPE SBIN WORD; /* 0=SO  1=SM */
       72     1842    1   DCL SP PTR;
       73     1843    1   DCL Z SBIN HALF;
       74     1844    1   DCL Z1 SBIN HALF;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:12   
       75     1845    1   DCL STYPE SBIN WORD;
       76     1846    1   DCL EISF$ PTR;
       77     1847    1   DCL EISF SBIN WORD BASED(EISF$);
       78     1848    1   DCL EISD$ PTR;
       79     1849    1   DCL EISD SBIN WORD BASED(EISD$);
       80     1850    1   DCL DBK_FR SBIN WORD;
       81     1851    1   DCL DBK SBIN WORD;
       82     1852    1   DCL NM_SOSM SBIN HALF;
       83     1853    1   DCL TEMP CHAR(30);
       84     1854    1   DCL TEMP_UBIN_WORD UBIN WORD;
       85     1855    1   DCL CHARV_PREC SBIN WORD;
       86     1856         /* S T A R T   O F   P R O G R A M */
       87     1857    1       EISF$ = ADDR(XEIS);
       88     1858    1       EISD$ = ADDR(EIS1);
       89     1859    1       MAP.XWORD = 1;
       90     1860    1       MAP.HBYTE = 0;
       91     1861    1       UWA.FR.FTYPE = 5;
       92     1862    1       UWA.FR.PREC = 3;
       93     1863    1       UWA.FR.SCALE = 0;
       94     1864    1       UWA.FR.F_SIGN = 0;
       95     1865    1       UWA.FR.SCALE = 0;
       96     1866         /* START AT BEGINNING - JUST IN CASE WE
       97     1867            HIT UPON EXISTING OCCURRENCE */
       98     1868    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);
       99     1869    1       CALL FETCHOS_6('OA-AC   ') ALTRET(ERROR1);
      100     1870    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      101     1871    1       GLOBAL_SIZE = UWA.OA.GLOBAL + 1;
      102     1872    1       UWA.FR.PREC = GLOBAL_SIZE;
      103     1873    1       CALL EISGEN;
      104     1874    1       CALC_NXT = UWA.FR.BUFFLOC;
      105     1875    1       CALL EISGEN;
      106     1876    1       CALC_PRI = UWA.FR.BUFFLOC;
      107     1877         /* GO THRU ALL AC RECORDS AND SET CALC_NEXT
      108     1878            AND CALC_PRIOR FIELDS */
      109     1879    1   DOAC:
      110     1880    1       CALL FETCHNS_6('OA-AC   ') ALTRET(DOSET);
      111     1881    1       UWA.AC.CALC_NEXT = CALC_NXT;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:13   
      112     1882    1       UWA.AC.CALC_PRIOR = CALC_PRI;
      113     1883    1       CALL MODIFY_6('AC  ') ALTRET(ERROR1);
      114     1884    1       GOTO DOAC;
      115     1885         /* FOR EACH RC SORT THE CORRESPONDING SO/SM
      116     1886            RECORDS BASE ON THEIR SET (SC) NAME */
      117     1887    1   DOSET:
      118     1888    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);
      119     1889    1       NM_SOSM = 0;
      120     1890    1   DOSETS: /* FIRST GO THRU RC RECORDS AND DETERMINE MAX
      121     1891         # OF SO/SM IN ANY ONE OCCURRENCE */
      122     1892    1       CALL FETCHNS_6('OA-RC   ') ALTRET(DOSET1);
      123     1893         /* CHECK IF POINTER SEQUENCE WAS SPECIFIED */
      124     1894    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(DOSETS1);
      125     1895    1       IF UWA.RECORD_NAME = 'SM' THEN
      126     1896    1           X = UWA.SM.PSEQ;
      127     1897    1       ELSE
      128     1898    1           X = UWA.SO.PSEQ;
      129     1899    1       IF X = 1 OR UWA.RC.PSMODE = 4 THEN
      130     1900    1           GOTO DOSETS; /* PTR_SEQ OR INDEX RECORD */
      131     1901    1   DOSETS1:
      132     1902    1       IF UWA.RC.NUM_SOSM > NM_SOSM THEN
      133     1903    1           NM_SOSM = UWA.RC.NUM_SOSM;
      134     1904    1       GOTO DOSETS;
      135     1905    1   DOSET1: /* ALLOCATE ENOUGH ENTRIES FOR MAX # OF SOSM OF
      136     1906         AN OCCURRENCE */
      137     1907    1       CALL ZIG$G_DYN_MEM_6(NM_SOSM * 10,SP);
      138     1908    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);
      139     1909    1   DOSETRC:
      140     1910    1       UWA.FR.F_SIGN = 0;
      141     1911    1       UWA.FR.SCALE = 0;
      142     1912    1       UWA.FR.PREC = 3;
      143     1913    1       UWA.FR.FTYPE = 5;
      144     1914    1       CALL FETCHNS_6('OA-RC   ') ALTRET(ENDEIS);
      145     1915    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(DOSETRC1);
      146     1916    1       IF UWA.RECORD_NAME = 'SM' THEN
      147     1917    1           X = UWA.SM.PSEQ;
      148     1918    1       ELSE
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:14   
      149     1919    1           X = UWA.SO.PSEQ;
      150     1920    1       IF X = 1 OR UWA.RC.PSMODE = 4 THEN
      151     1921    1           GOTO DOPNTS; /* PTR_SEQ OR INDEX RECORD */
      152     1922    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      153     1923    1   DOSETRC1:
      154     1924    1       NM_SOSM = UWA.RC.NUM_SOSM; /* # OF SO/SM THIS OCCURENCE */
      155     1925    1       IF NM_SOSM < 2 THEN /* MAKE SURE MORE THAN 1 SO/SM */
      156     1926    1           GOTO DOPNTS;
      157     1927    2       DO Z = 1 TO NM_SOSM;
      158     1928    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(DOSETSM);
      159     1929    2           DBK = UWA.DIRECT_REF;
      160     1930    2           IF UWA.RECORD_NAME = 'SM' THEN
      161     1931    2               SOSM_TB.REC_TYPE(Z) = 1;
      162     1932    2           ELSE
      163     1933    2               SOSM_TB.REC_TYPE(Z) = 0;
      164     1934    2           CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1); /* GET SO/SM 'S SC */
      165     1935    2           CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* GET SC NAME */
      166     1936    2           SOSM_TB.NAME(Z) = UWA.SN.SENAME;
      167     1937    2           SOSM_TB.XADDR(Z) = DBK;
      168     1938    2           END;
      169     1939    1   DOSETSM:
      170     1940         /* NOW MUST SORT SOSM_TB IN ASCENDING ORDER */
      171     1941    2       DO Z = 1 TO NM_SOSM - 1;
      172     1942    3           DO Z1 = Z + 1 TO NM_SOSM;
      173     1943    3               IF SOSM_TB.NAME(Z1) < SOSM_TB.NAME(Z) THEN
      174     1944    4               DO;
      175     1945    4                   TEMP = SOSM_TB.NAME(Z);
      176     1946    4                   DBK = SOSM_TB.XADDR(Z);
      177     1947    4                   STYPE = SOSM_TB.REC_TYPE(Z);
      178     1948    4                   SOSM_TB.NAME(Z) = SOSM_TB.NAME(Z1);
      179     1949    4                   SOSM_TB.XADDR(Z) = SOSM_TB.XADDR(Z1);
      180     1950    4                   SOSM_TB.REC_TYPE(Z) = SOSM_TB.REC_TYPE(Z1);
      181     1951    4                   SOSM_TB.NAME(Z1) = TEMP;
      182     1952    4                   SOSM_TB.XADDR(Z1) = DBK;
      183     1953    4                   SOSM_TB.REC_TYPE(Z1) = STYPE;
      184     1954    4                   END;
      185     1955    3               END;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:15   
      186     1956    2           END;
      187     1957         /* MUST NOW GO THROUGH AND RELINK SO/SM RECORDS
      188     1958            IN RC-SOSM SET ACCORDING TO ORDER IN SOSM_TB */
      189     1959    2       DO Z = 1 TO NM_SOSM;
      190     1960    2           TEMP_UBIN_WORD = SOSM_TB.XADDR(Z);
      191     1961    2           IF SOSM_TB.REC_TYPE(Z) = 1 THEN
      192     1962    2               CALL FETCHD_6('SM  ', TEMP_UBIN_WORD) ALTRET(ERROR1);
      193     1963    2           ELSE
      194     1964    2               CALL FETCHD_6('SO  ', TEMP_UBIN_WORD) ALTRET(ERROR1);
      195     1965    2           CALL DISCONNECT_6('RC-SOSM ') ALTRET(ERROR1);
      196     1966    2           CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      197     1967         /* MAKE SO/SM CURRENT OF RUN UNIT */
      198     1968    2           IF SOSM_TB.REC_TYPE(Z) = 1 THEN
      199     1969    2               CALL FCURR_R_6('SM  ') ALTRET(ERROR1);
      200     1970    2           ELSE
      201     1971    2               CALL FCURR_R_6('SO  ') ALTRET(ERROR1);
      202     1972    2           CALL CONNECT_6('RC-SOSM ') ALTRET(ERROR1);
      203     1973    2           END;
      204     1974         /* BUILD EIS DESCRIPTORS FOR EACH SET POINTER */
      205     1975    1   DOPNTS:
      206     1976         /* IN MOST CASES *CALC RECORD IS LINKED IN FIRST.
      207     1977            HOWEVER, FOR THOSE RECORDS SPECIFYING POINTER-SEQ
      208     1978            , THE *CALC RECORD IS NOT NECESSARILY FIRST.
      209     1979            SO LINK *CALC IN FIRST */
      210     1980    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      211     1981    1   DONXSM:
      212     1982    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(DONDON);
      213     1983    1       IF UWA.RECORD_NAME = 'SO' THEN
      214     1984    1           GOTO DONXSM;
      215     1985    1       IF UWA.SM.PSEQ = 0 THEN /* PTR_SEQ NOT SPECIFIED */
      216     1986    1           GOTO DONDON;
      217     1987    1       DBK = UWA.DIRECT_REF;
      218     1988    1       CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);
      219     1989    1       IF UWA.DIRECT_REF = UWA.OA.OA_CALC THEN /* *CALC */
      220     1990    2       DO;
      221     1991    2           IF UWA.RC.NUM_SOSM = 1 THEN
      222     1992    2               GOTO DONXSM;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:16   
      223     1993    2           CALL FCURR_R_6('SM  ') ALTRET(ERROR1);
      224     1994    2           CALL DISCONNECT_6('RC-SOSM ') ALTRET(ERROR1);
      225     1995    2           CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      226     1996    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(ERROR1);
      227     1997    2           TEMP_UBIN_WORD = DBK;
      228     1998    2           CALL FETCHD_6('SM  ', TEMP_UBIN_WORD) ALTRET(ERROR1);
      229     1999    2           CALL CONNECT_6('RC-SOSM ') ALTRET(ERROR1);
      230     2000    2           GOTO DONDON;
      231     2001    2           END;
      232     2002    1       GOTO DONXSM;
      233     2003    1   DONDON:
      234     2004    1       IF UWA.RC.PSMODE = 5
      235     2005         /* 4 = INDEXED AND 5 = POINTER ARRAY RC */
      236     2006    2       THEN DO;
      237     2007    2           MAP.XWORD = 2;
      238     2008    2           MAP.HBYTE = 0;
      239     2009    2           END;
      240     2010    2       ELSE DO;
      241     2011    2           IF UWA.RC.PSMODE = 4
      242     2012    3           THEN DO;
      243     2013    3               MAP.XWORD = 0;
      244     2014    3               MAP.HBYTE = 0;
      245     2015    3               END;
      246     2016    3           ELSE DO;
      247     2017    3               MAP.XWORD = 1;
      248     2018    3               MAP.HBYTE = 0;
      249     2019    3               END;
      250     2020    2           END;
      251     2021    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      252     2022    1       INDEX_NUM = 1;
      253     2023    1   EISA:
      254     2024    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(DOFLDS);
      255     2025    1       TEMP = UWA.RECORD_NAME;
      256     2026    1       CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);
      257     2027    1       IF UWA.SC.SETTYPE = 2 OR UWA.SC.SETTYPE = 3
      258     2028    2       THEN DO;
      259     2029    2           IF UWA.RC.PSMODE ~= 4
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:17   
      260     2030    2           THEN GOTO EISA;
      261     2031        /*
      262     2032              INDEXED AREA RECORD SO MUST PUT INDEX NUMBER IN
      263     2033            SM.PA_MEMPNT FOR THE INDEX IN THE FILE FOR THIS
      264     2034            ALTERNATE KEY.
      265     2035        */
      266     2036    2           IF UWA.SM.PSMODE = 1
      267     2037    3           THEN DO;
      268     2038    3               UWA.SM.PA_MEMPNT = 1;
      269     2039    3               END;
      270     2040    3           ELSE DO;
      271     2041    3               INDEX_NUM = INDEX_NUM + 1;
      272     2042    3               UWA.SM.PA_MEMPNT = INDEX_NUM;
      273     2043    3               END;
      274     2044    2           CALL FCURR_R_6('SM  ') ALTRET(ERROR1);
      275     2045    2           CALL MODIFY_6('SM  ') ALTRET(ERROR1);
      276     2046    2           GOTO EISA;
      277     2047    2           END;
      278     2048    1       UWA.FR.PREC = UWA.SC.PTRSZ;
      279     2049    1       IF TEMP = 'SM' THEN
      280     2050    2       DO;
      281     2051    2           IF UWA.SC.SETMODE = 2 THEN
      282     2052    3           DO;
      283     2053    3               IF UWA.SM.PAMEM = 0 THEN
      284     2054    4               DO;
      285     2055    4                   CALL EISGEN;
      286     2056    4                   UWA.SM.NXTPNT = UWA.FR.BUFFLOC;
      287     2057    4                   CALL EISGEN;
      288     2058    4                   UWA.SM.HDPNT = UWA.FR.BUFFLOC;
      289     2059    4                   END;
      290     2060    3               ELSE
      291     2061    4               DO;
      292     2062    4                   MAP.XWORD = 2;
      293     2063    4                   MAP.HBYTE = 0;
      294     2064    4                   CALL EISGEN;
      295     2065    4                   UWA.SM.NXTPNT = UWA.FR.BUFFLOC;
      296     2066    4                   CALL EISGEN;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:18   
      297     2067    4                   UWA.SM.PRIPNT = UWA.FR.BUFFLOC;
      298     2068    4                   CALL EISGEN;
      299     2069    4                   UWA.SM.HDPNT = UWA.FR.BUFFLOC;
      300     2070    4                   END;
      301     2071    3               CALL FCURR_R_6('SM  ') ALTRET(ERROR1);
      302     2072    3               CALL MODIFY_6('SM  ') ALTRET(ERROR1);
      303     2073    3               GOTO EISA;
      304     2074    3               END;
      305     2075         /* IS SC PTR = *CALC PTR */
      306     2076    2           IF UWA.DIRECT_REF = UWA.OA.OA_CALC THEN
      307     2077    3           DO;
      308     2078    3               UWA.SM.NXTPNT = CALC_NXT;
      309     2079    3               UWA.SM.PRIPNT = CALC_PRI;
      310     2080    3               CALL FCURR_R_6('SM  ') ALTRET(ERROR1);
      311     2081    3               CALL MODIFY_6('SM  ') ALTRET(ERROR1);
      312     2082    3               CALL ALLOCATE(GLOBAL_SIZE * 4);
      313     2083    3               GOTO EISA;
      314     2084    3               END;
      315     2085    2           CALL EISGEN;
      316     2086    2           UWA.SM.NXTPNT = UWA.FR.BUFFLOC;
      317     2087    2           CALL EISGEN;
      318     2088    2           UWA.SM.PRIPNT = UWA.FR.BUFFLOC;
      319     2089    2           CALL EISGEN;
      320     2090    2           UWA.SM.HDPNT = UWA.FR.BUFFLOC;
      321     2091    2           CALL FCURR_R_6('SM  ') ALTRET(ERROR1);
      322     2092    2           CALL MODIFY_6('SM  ') ALTRET(ERROR1);
      323     2093    2           GOTO EISA;
      324     2094    2           END;
      325     2095    1       IF TEMP = 'SO' THEN
      326     2096    2       DO;
      327     2097    2           CALL EISGEN;
      328     2098    2           UWA.SO.NXTPNT = UWA.FR.BUFFLOC;
      329     2099    2           CALL EISGEN;
      330     2100    2           UWA.SO.PRIPNT = UWA.FR.BUFFLOC;
      331     2101    2           CALL FCURR_R_6('SO  ') ALTRET(ERROR1);
      332     2102    2           CALL MODIFY_6('SO  ') ALTRET(ERROR1);
      333     2103    2           GOTO EISA;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:19   
      334     2104    2           END;
      335     2105    1       CALL ERROR(2400);
      336     2106        /*E*     ERROR:    ZIG-ZIG_ERR_IN_EIS_DESC-C
      337     2107        MESSAGE: Error in building EIS descriptors.
      338     2108                 <<<< SOFTWARE ERROR >>>>
      339     2109        */
      340     2110    1       GOTO EISA;
      341     2111         /* DETERMINE LENGTH OF FIXED FIELDS IN RC TYPE RECORD
      342     2112            BY GOING THROUGH RC RECORDS DETERMININ THE LENGTH
      343     2113            OF EACH FIELD */
      344     2114    1   DOFLDS:
      345     2115    1       CALL FETCHOS_6('RC-FR   ') ALTRET(ERROR1);
      346     2116    1       VAR_FIELDS = 0;
      347     2117    1       CHARV_PREC = 0;
      348     2118    1   DOFI:
      349     2119    1       CALL FETCHNS_6('RC-FR   ') ALTRET(VARFR);
      350     2120    1       IF UWA.FR.FTYPE = 19 THEN
      351     2121    2       DO;
      352     2122    2           VAR_FIELDS = VAR_FIELDS + 1; /* CHAR VARYING */
      353     2123    2           CHARV_PREC = CHARV_PREC + UWA.FR.PREC;
      354     2124    2           GOTO DOFI;
      355     2125    2           END;
      356     2126    1       IF UWA.FR.SYN = 0 THEN
      357     2127    2       DO;
      358     2128    2           IF UWA.RC.PSMODE = 4 /* TEST FOR INDEXED */
      359     2129    2              AND (UWA.FR.FTYPE = 3 OR
      360     2130    2              UWA.FR.FTYPE = 4)
      361     2131    2              AND MOD(MAP.HBYTE,2) ~= 0 THEN
      362     2132    3           DO; /*POSSIBLE NIBBLE ALIGNMENT ON DECIMAL FIELD */
      363     2133    3   FIND_KEY:
      364     2134    4               DO WHILE ('1'B); /* DO FOREVER */
      365     2135    4                   CALL FINDNS_6('FR-CFS  ') ALTRET(DONE_FR_CDS);
      366     2136    4                   CALL FINDOS_6('SMSS-CF ') ALTRET(ERROR1);
      367     2137    4                   CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);
      368     2138    4                   IF UWA.SC.SETTYPE = 2 OR
      369     2139    4                      UWA.SC.SETTYPE = 3 THEN
      370     2140    5                   DO;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:20   
      371     2141    5                       CALL ALIGN(2);
      372     2142    5                       EXIT FIND_KEY;
      373     2143    5                       END /*SETTYPE 2 OR 3*/;
      374     2144    4                   END FIND_KEY;
      375     2145    3   DONE_FR_CDS:
      376     2146    3               END /* TEST FOR INDEXED */;
      377     2147    2           CALL EISGEN;
      378     2148    2           CALL FCURR_R_6('FR  ') ALTRET(ERROR1);
      379     2149    2           CALL MODIFY_6('FR  ') ALTRET(ERROR1);
      380     2150    2           END;
      381     2151    1       GOTO DOFI;
      382     2152    1   VARFR: /* MUST NOW ISSUE EIS DESCRIPTOR */
      383     2153         /* FOR CHAR VARYING */
      384     2154    1       IF VAR_FIELDS = 0 THEN
      385     2155    1           GOTO SETRC;
      386     2156    1       CALL FETCHOS_6('RC-FR   ') ALTRET(ERROR1);
      387     2157    1   VARFR1:
      388     2158    1       CALL FETCHNS_6('RC-FR   ') ALTRET(SETRCA);
      389     2159    1       IF UWA.FR.FTYPE = 19 THEN
      390     2160    2       DO; /* CHAR VARYING */
      391     2161    2           CALL EISGEN;
      392     2162    2           CALL FCURR_R_6('FR  ') ALTRET(ERROR1);
      393     2163    2           CALL MODIFY_6('FR  ') ALTRET(ERROR1);
      394     2164    2           END;
      395     2165    1       GOTO VARFR1;
      396     2166    1   SETRCA:
      397     2167    1       UWA.RC.CV_OFFSET = (4 * MAP.XWORD) + (MAP.HBYTE / 2);
      398     2168    1   SETRC:
      399     2169    1       CALL ALIGN(2);
      400     2170    1       UWA.RC.LSIZE = (4 * MAP.XWORD) + (MAP.HBYTE / 2) + CHARV_PREC;
      401     2171    1       CALL FCURR_R_6('RC  ') ALTRET(ERROR1);
      402     2172    1       CALL MODIFY_6('RC  ') ALTRET(ERROR1);
      403     2173         /* CHECK IF RECORD WILL FIT ON PAGE */
      404     2174    1       IF UWA.RC.PSMODE = 4
      405     2175    1       THEN GOTO SETRC0;
      406     2176        /*W*     INDEXED SKIP THE CHECK TO SEE IF WILL FIT IN A PAGE IT WILL */
      407     2177    1       X = 0;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:21   
      408     2178    1       CALL FETCHOS_6('RC-RA   ') ALTRET(ERROR1);
      409     2179    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);
      410     2180    1       IF UWA.SN.SENAME = '*CALC.RC' OR UWA.SN.SENAME = '*DBPARAM' OR UWA.SN.SENAME
      411     2181    1          = '*SYSTEM' THEN
      412     2182    1           GOTO SETRC4;
      413     2183    1   SETRC1B:
      414     2184    1       CALL FETCHNS_6('RC-RA   ') ALTRET(SETRC1A);
      415     2185    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);
      416     2186    1       IF X = 0 THEN X = UWA.AC.SPACE_AVAIL;
      417     2187    1       ELSE IF X > UWA.AC.SPACE_AVAIL THEN
      418     2188    1               X = UWA.AC.SPACE_AVAIL;
      419     2189    1       GOTO SETRC1B;
      420     2190    1   SETRC1A:
      421     2191    1       IF VAR_FIELDS = 0 THEN
      422     2192    2       DO; /* NOT CHAR VARYING */
      423     2193    2           IF UWA.RC.LSIZE > X THEN
      424     2194    3           DO;
      425     2195    3               CALL FCURR_R_6('RC  ') ALTRET(ERROR1);
      426     2196    3               CALL CURRENCY(UWA.DIRECT_REF);
      427     2197    3               CALL SET_FIELDS(1,30,UWA.SN.SENAME);
      428     2198    3               CALL WARNING(2401);
      429     2199        /*E*     ERROR:    ZIG-ZIG_REC_GR_PG_SZ-C
      430     2200        MESSAGE: The record size of the record %U1 is larger than the page size.
      431     2201        */
      432     2202    3               END;
      433     2203    2           END;
      434     2204    1       ELSE /* CHAR VARYING */
      435     2205    2       DO;
      436     2206    2           IF UWA.RC.LSIZE > X THEN
      437     2207    3           DO;
      438     2208    3               CALL FCURR_R_6('RC  ') ALTRET(ERROR1);
      439     2209    3               CALL CURRENCY(UWA.DIRECT_REF);
      440     2210    3               CALL SET_FIELDS(1,30,UWA.SN.SENAME);
      441     2211    3               CALL WARNING(2402);
      442     2212        /*E*     ERROR:    ZIG-ZIG_MAX_REC_GR_PG_SZ-C
      443     2213        MESSAGE: The maximum record size of the record %U1 is larger than the
      444     2214                 page size.
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:22   
      445     2215        */
      446     2216    3               END;
      447     2217    2           IF UWA.RC.LSIZE - CHARV_PREC > X THEN
      448     2218    3           DO;
      449     2219    3               CALL FCURR_R_6('RC  ') ALTRET(ERROR1);
      450     2220    3               CALL CURRENCY(UWA.DIRECT_REF);
      451     2221    3               CALL SET_FIELDS(1,30,UWA.SN.SENAME);
      452     2222    3               CALL WARNING(2403);
      453     2223        /*E*     ERROR:    ZIG-ZIG_MIN_REC_GR_PG_SZ-C
      454     2224        MESSAGE: The minimum record size of the record %U1 is larger than the
      455     2225                 page size.
      456     2226        */
      457     2227    3               END;
      458     2228    2           END;
      459     2229         /* IF THIS RECORD HAS A KEYNAME, THEN WE MUST
      460     2230            BUILD PROCESS AREA EIS DESCRIPTOR IN SYNONYM
      461     2231            CF RECORD */
      462     2232    1       IF UWA.RC.KEY_PRESENT ~= 0 OR UWA.RC.PSMODE = 4 THEN
      463     2233    1           GOTO SETRC0;
      464     2234    1       GOTO SETRC4;
      465     2235    1   SETRC0:
      466     2236    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      467     2237    1   SETRC1:
      468     2238    1       IF UWA.RC.PSMODE ~=4
      469     2239    2       THEN DO;
      470     2240    2           MAP.XWORD = 0;
      471     2241    2           MAP.HBYTE = 6;
      472     2242    2           END;
      473     2243    2       ELSE DO;
      474     2244    2           MAP.XWORD = 0;
      475     2245    2           MAP.HBYTE = 2;
      476     2246    2           END;
      477     2247    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(SETRC4);
      478     2248    1       IF UWA.RECORD_NAME = 'SO' THEN
      479     2249    1           GOTO SETRC1;
      480     2250    1   SETRC2:
      481     2251    1       CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1); /* GET SC */
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:23   
      482     2252    1       IF UWA.SC.SETTYPE = 2 OR UWA.SC.SETTYPE = 3 THEN
      483     2253    2       DO;
      484     2254    2   SETRC21:
      485     2255    2           CALL FETCHNS_6('SMSS-CF ') ALTRET(SETRC4);
      486     2256    2           IF UWA.C_F.SYN = 0 THEN
      487     2257    2               GOTO SETRC21; /* NOT SYNONYM */
      488     2258    2           CALL FETCHOS_6('FR-CFS  ') ALTRET(ERROR1);
      489     2259    2           CALL EISGEN;
      490     2260    2           IF UWA.FR.FTYPE = 0 OR
      491     2261    2              UWA.FR.FTYPE = 1 OR
      492     2262    2              UWA.FR.FTYPE = 11 THEN
      493     2263    2               UWA.SC.KEY_LENGTH = 4;
      494     2264    2           IF UWA.FR.FTYPE = 12 THEN
      495     2265    2               UWA.SC.KEY_LENGTH = 8;
      496     2266    2           IF UWA.FR.FTYPE = 2 THEN
      497     2267    2               UWA.SC.KEY_LENGTH = 2;
      498     2268    2           IF UWA.FR.FTYPE = 3 OR UWA.FR.FTYPE = 4 THEN
      499     2269    2               UWA.SC.KEY_LENGTH = (UWA.FR.PREC + UWA.FR.F_SIGN + 1)/2;
      500     2270    2           IF UWA.FR.FTYPE = 5 OR UWA.FR.FTYPE = 9 THEN
      501     2271    2               UWA.SC.KEY_LENGTH = UWA.FR.PREC;
      502     2272    2           CALL MODIFY_6('FR  ') ALTRET(ERROR1);
      503     2273    2           CALL FCURR_R_6('SC  ') ALTRET(ERROR1);
      504     2274    2           CALL MODIFY_6('SC  ') ALTRET(ERROR1);
      505     2275    2           END;
      506     2276    1       GOTO SETRC1;
      507     2277    1   SETRC4:
      508     2278    1       GOTO DOSETRC;
      509     2279         /* GENERATE AN EIS DESRIPTOR */
      510     2280    1   EISGEN:
      511     2281    1       PROC;
      512     2282    2       UWA.FR.BEIST=0; /* SET EIS DIS. TYPE TO ADSC9 */
      513     2283    2       IF UWA.FR.FTYPE = 0 OR UWA.FR.FTYPE = 19 THEN /* DBK, CHAR VAR */
      514     2284    3       DO;
      515     2285    3           CALL ALIGN(2); /* GET ON BYTE BOUNDARY */
      516     2286    3           CALL SETEIS; /* SET EIS DESCRIPTOR */
      517     2287    3           XEIS.PREC = '000000000100'B;
      518     2288    3           CALL ALLOCATE(8); /* ALLOCATE 4 BYTES */
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:24   
      519     2289    3           UWA.FR.BUFFLOC = EISF; /* PUT EIS DESCRIPTOR IN FIXED */
      520     2290    3           RETURN;
      521     2291    3           END;
      522     2292    2       IF UWA.FR.FTYPE = 1 THEN /* 36 BIT BINARY */
      523     2293    3       DO;
      524     2294    3           CALL ALIGN(2); /* ALIGN ON BYTE BOUNDARY */
      525     2295    3           CALL SETEIS;
      526     2296    3           XEIS.PREC = '000000000100'B;
      527     2297    3           CALL ALLOCATE(8); /* ALLOCATE 4 BYTES */
      528     2298    3           UWA.FR.BUFFLOC = EISF; /* PUT IN FIXED FORMAT */
      529     2299    3           RETURN;
      530     2300    3           END;
      531     2301    2       IF UWA.FR.FTYPE = 2 THEN /* 18 BIT BINARY */
      532     2302    3       DO;
      533     2303    3           CALL ALIGN(2);
      534     2304    3           CALL SETEIS;
      535     2305    3           XEIS.PREC = '000000000010'B;
      536     2306    3           CALL ALLOCATE(4); /* ALLOCATE 2 BYTES */
      537     2307    3           UWA.FR.BUFFLOC = EISF; /* PUT IN FIXED FORMAT */
      538     2308    3           RETURN;
      539     2309    3           END;
      540     2310    2       IF UWA.FR.FTYPE = 3 THEN /* UNSIGNED PACKED DECIMAL */
      541     2311    3       DO;
      542     2312    3           CALL SETEIS1;
      543     2313    3           CALL ALLOCATE(UWA.FR.PREC);
      544     2314    3           UWA.FR.BUFFLOC = EISD;
      545     2315    3           UWA.FR.BEIST=1; /* SET EIS DIS. TYPE TO NUMERIC */
      546     2316    3           RETURN;
      547     2317    3           END;
      548     2318    2       IF UWA.FR.FTYPE = 4 THEN /* SIGNED PACKED DECIMAL */
      549     2319    3       DO;
      550     2320    3           UWA.FR.PREC = UWA.FR.PREC + 1; /* ADD HALF BYTE FOR SIGN */
      551     2321    3           CALL SETEIS1;
      552     2322    3           CALL ALLOCATE(UWA.FR.PREC);
      553     2323    3           UWA.FR.PREC = UWA.FR.PREC - 1;
      554     2324    3           UWA.FR.BUFFLOC = EISD;
      555     2325    3           UWA.FR.BEIST=1; /* SET EIS DIS. TYPE TO NUMERIC */
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:25   
      556     2326    3           RETURN;
      557     2327    3           END;
      558     2328    2       IF UWA.FR.FTYPE = 5 OR UWA.FR.FTYPE = 9 THEN /* ASCII CHAR */
      559     2329    3       DO;
      560     2330    3           CALL ALIGN(2); /* ALIGN ON BYTE BOUNDARY */
      561     2331    3           CALL SETEIS;
      562     2332    3           CALL ALLOCATE(UWA.FR.PREC * 2);
      563     2333    3           UWA.FR.BUFFLOC = EISF;
      564     2334    3           RETURN;
      565     2335    3           END;
      566     2336    2       IF UWA.FR.FTYPE = 11 THEN /* SINGLE PREC. FLT. BIN */
      567     2337    3       DO;
      568     2338    3           CALL ALIGN(2);
      569     2339    3           CALL SETEIS;
      570     2340    3           XEIS.PREC = '000000000100'B;
      571     2341    3           UWA.FR.BUFFLOC = EISF;
      572     2342    3           CALL ALLOCATE(8);
      573     2343    3           RETURN;
      574     2344    3           END;
      575     2345    2       IF UWA.FR.FTYPE = 12 THEN /* DOUBLE PREC. FLT. BIN */
      576     2346    3       DO;
      577     2347    3           CALL ALIGN(2);
      578     2348    3           CALL SETEIS;
      579     2349    3           XEIS.PREC = '000000001000'B;
      580     2350    3           UWA.FR.BUFFLOC = EISF;
      581     2351    3           CALL ALLOCATE(16);
      582     2352    3           RETURN;
      583     2353    3           END;
      584     2354    2       CALL ABORT; /* SOFTWARE ERROR */
      585     2355    2   END EISGEN;
      586     2356         /* ALIGN ON A BYTE (BNDRY=2) BOUNDARY */
      587     2357    1   ALIGN:
      588     2358    1       PROC(BNDRY);
      589     2359    2   DCL BNDRY SBIN (36);
      590     2360    3       DO WHILE(MOD(MAP.HBYTE, BNDRY) ~= 0);
      591     2361    3           MAP.HBYTE = MAP.HBYTE + 1;
      592     2362    3           END;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:26   
      593     2363    2       IF MAP.HBYTE = 8 THEN
      594     2364    3       DO;
      595     2365    3           MAP.HBYTE = 0;
      596     2366    3           MAP.XWORD = MAP.XWORD + 1;
      597     2367    3           END;
      598     2368    2   END ALIGN;
      599     2369         /* ALLOCATE PREC NUMBER OF HALF BYTES */
      600     2370    1   ALLOCATE:
      601     2371    1       PROC(PREC);
      602     2372    2   DCL PREC SBIN(36);
      603     2373    2       MAP.HBYTE = MAP.HBYTE + PREC;
      604     2374    3       DO WHILE(MAP.HBYTE > 7);
      605     2375    3           MAP.HBYTE = MAP.HBYTE - 8;
      606     2376    3           MAP.XWORD = MAP.XWORD + 1;
      607     2377    3           END;
      608     2378    2   END ALLOCATE;
      609     2379    1   SETEIS:
      610     2380    1       PROC;
      611     2381    2       XEIS.BWRD = BINBIT(MAP.XWORD, 15);
      612     2382    2       XEIS.BCHR = BINBIT(MAP.HBYTE, 3);
      613     2383    2       XEIS.PREC = BINBIT(UWA.FR.PREC, 12);
      614     2384    2   END SETEIS;
      615     2385    1   SETEIS1:
      616     2386    1       PROC;
      617     2387    2       EIS1.BWRD = BINBIT(MAP.XWORD, 15);
      618     2388    2       EIS1.BCHR = BINBIT(MAP.HBYTE, 3);
      619     2389    2       IF UWA.FR.F_SIGN = 1 THEN
      620     2390    2           EIS1.SIGN = '10'B; /* SIGN SPECIFIED */
      621     2391    2       ELSE
      622     2392    2           EIS1.SIGN = '11'B;
      623     2393    2       EIS1.SCALE = BINBIT(-1 * UWA.FR.SCALE, 6);
      624     2394    2       EIS1.PREC = BINBIT(UWA.FR.PREC, 6);
      625     2395    2   END SETEIS1;
      626     2396         /* ALL SET OCCURRENCES OF RC HAVE BEEN PROCESSED */
      627     2397         /* CONTROL COMES HERE AFTER ALL FR, SO, SM HAVE
      628     2398            EIS DESCRIPTORS FOR THIS OCCURRENCE */
      629     2399    1   ENDEIS:
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:27   
      630     2400    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);
      631     2401    1   GETRC:
      632     2402    1       CALL FETCHNS_6('OA-RC   ') ALTRET(TERMEIS);
      633     2403    1       IF UWA.RC.PSMODE = 5 /* PA-REC */
      634     2404    1       THEN
      635     2405    2       DO;
      636     2406    2           UWA.RC.LSIZE = 0;
      637     2407    2   PARC1:
      638     2408    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(PARC4);
      639     2409    2           CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);
      640     2410        /*          TOK.CODE = UWA.DIRECT_REF;  FOR POSS DIAG                    */
      641     2411    2           MAP.XWORD = 0;
      642     2412    2           MAP.HBYTE = 4;
      643     2413    2           UWA.FR.FTYPE = 5;
      644     2414    2           UWA.FR.PREC = UWA.SC.PTRSZ;
      645     2415    2           CALL EISGEN;
      646     2416    2           UWA.SM.PA_MEMPNT = UWA.FR.BUFFLOC;
      647     2417    2           CALL FCURR_R_6('SM  ') ALTRET(ERROR1);
      648     2418    2           CALL MODIFY_6('SM  ') ALTRET(ERROR1);
      649     2419    2   PARC2:
      650     2420    2           CALL FETCHNS_6('SMSS-CF ') ALTRET(PARC1);
      651     2421    2           CALL FETCHOS_6('FR-CFS  ') ALTRET(ERROR1);
      652     2422    2           CALL EISGEN;
      653     2423    2           CALL MODIFY_6('FR  ') ALTRET(ERROR1);
      654     2424    2           GOTO PARC2;
      655     2425    2   PARC4:
      656     2426    2           UWA.RC.PA_OFFSET = 8 + (3*UWA.SC.PTRSZ);
      657     2427    2           ALLOW = UWA.RC.PA_ENTRY;
      658     2428    2           CALL ALIGN(2);
      659     2429    2           UWA.RC.PA_ENTRY = (4*MAP.XWORD) + (MAP.HBYTE/2);
      660     2430    2           IF ALLOW ~= 0 THEN
      661     2431    2               PA_SIZE_N = 8 + (3*UWA.SC.PTRSZ) + (ALLOW*UWA.RC.PA_ENTRY);
      662     2432    2           ELSE
      663     2433    2               PA_SIZE_N = 0;
      664     2434    2           PA_SIZE_1 = 8+(3*UWA.SC.PTRSZ)+ UWA.RC.PA_ENTRY;
      665     2435    2   PARC5:
      666     2436    2           CALL FETCHNS_6('RC-RA   ') ALTRET(PARC6);
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:28   
      667     2437    2           CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);
      668     2438    2           CALL CURRENCY(UWA.DIRECT_REF);
      669     2439    2           IF UWA.RC.LSIZE = 0 THEN
      670     2440    2               UWA.RC.LSIZE = UWA.AC.SPACE_AVAIL;
      671     2441    2           ELSE
      672     2442    2               IF UWA.AC.SPACE_AVAIL < UWA.RC.LSIZE THEN
      673     2443    2                   UWA.RC.LSIZE = UWA.AC.SPACE_AVAIL;
      674     2444    2           GOTO PARC5;
      675     2445    2   PARC6:
      676     2446    2           IF ALLOW ~= 0 THEN
      677     2447    2               UWA.RC.LSIZE = PA_SIZE_N;
      678     2448    2           CALL FCURR_R_6('RC  ') ALTRET(ERROR1);
      679     2449    2           CALL MODIFY_6('RC  ') ALTRET(ERROR1);
      680     2450    2           GOTO GETRC;
      681     2451    2           END;
      682     2452    1       IF UWA.RC.PSMODE = 1 OR UWA.RC.PSMODE = 2 OR UWA.RC.PSMODE = 4 THEN
      683     2453    2       DO; /* CALC, INDEXED OR LOC VIA */
      684     2454    2   GETSM:
      685     2455    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(GETFR);
      686     2456         /* LINK PRIMARY KEY IN FIRST
      687     2457            LINK *CALC SET IN FIRST
      688     2458            LINK VIA SET IN FIRST
      689     2459         CHECK IF RECORD IS *CALC OR LOCATION VIA SOME SET
      690     2460         OR INDEXED RECORD.  IF SO, LINK SM (PSMODE = 1 )
      691     2461         IN FIRST */
      692     2462    2           IF UWA.RECORD_NAME = 'SO' THEN
      693     2463    2               GOTO GETSM;
      694     2464    2           IF UWA.SM.PSMODE = 1 THEN
      695     2465    3           DO;
      696     2466    3               DBK = UWA.DIRECT_REF;
      697     2467    3               IF UWA.RC.NUM_SOSM = 1 THEN
      698     2468    3                   GOTO GETSM; /* BYPASS IF 1 MEMBER */
      699     2469    3               CALL DISCONNECT_6('RC-SOSM ') ALTRET(ERROR1);
      700     2470    3               CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      701     2471    3               CALL FETCHNS_6('RC-SOSM ') ALTRET(TERMEIS);
      702     2472    3               TEMP_UBIN_WORD = DBK;
      703     2473    3               CALL FETCHD_6('SM  ', TEMP_UBIN_WORD) ALTRET(ERROR1);
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:29   
      704     2474    3               CALL CONNECT_6('RC-SOSM ') ALTRET(ERROR1);
      705     2475    3               GOTO GETFR;
      706     2476    3               END;
      707     2477    2           GOTO GETSM;
      708     2478    2           END;
      709     2479    1   GETFR:
      710     2480    1       CALL FETCHNS_6('RC-FR   ') ALTRET(GETRC);
      711     2481    1       IF UWA.FR.SYN = 0 THEN
      712     2482    1           GOTO GETFR;
      713     2483    1       IF UWA.FR.F_USE = 4 OR UWA.FR.F_USE = 5 THEN
      714     2484    1           GOTO GETFR1;
      715     2485    1       GOTO GETFR;
      716     2486    1   GETFR1:
      717     2487    1       IF UWA.FR.BUFFLOC = 0 THEN
      718     2488    1           GOTO GETFR;
      719     2489    1       DBK_FR = UWA.DIRECT_REF;
      720     2490    1       TEMP_UBIN_WORD = UWA.FR.BUFFLOC;
      721     2491    1       CALL FETCHD_6('FR  ', TEMP_UBIN_WORD) ALTRET(ERROR1);
      722     2492    1       DBK = UWA.FR.BUFFLOC;
      723     2493    1       TEMP_UBIN_WORD = DBK_FR;
      724     2494    1       CALL FETCHD_6('FR  ', TEMP_UBIN_WORD) ALTRET(ERROR1);
      725     2495    1       UWA.FR.BUFFLOC = DBK;
      726     2496    1       CALL MODIFY_6('FR  ') ALTRET(ERROR1);
      727     2497    1       GOTO GETFR;
      728     2498    1   CURRENCY:
      729     2499    1       PROC(DBK_C);
      730     2500    2   DCL DBK_C UBIN(36);
      731     2501    2       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR2);
      732     2502    2       CURRENT.SNPNTR = UWA.DIRECT_REF;
      733     2503    2       CURRENT.SUBENTRY = UWA.SN.SETYPE;
      734     2504    2       RETURN;
      735     2505    2   ERROR2: CALL ABORT;
      736     2506    2   END CURRENCY;
      737     2507    1   ERROR1:
      738     2508    1       CALL ABORT;
      739     2509    1   TERMEIS:
      740     2510    1   END DOEIS;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:30   

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:31   
--  Include file information  --

   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIA_IDS_DCL.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DOEIS.

   Procedure DOEIS requires 1392 words for executable code.
   Procedure DOEIS requires 36 words of local(AUTO) storage.

    No errors detected in file ZIG$M_C5.:ZIC0TSI    .

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:32   

 Object Unit name= DOEIS                                      File name= ZIG$M_C5.:ZIC0TOU
 UTS= SEP 05 '97 12:07:03.84 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    12     14  DOEIS
    1  LblCom even  none     7      7  CURRENT
    2  LblCom even  none     1      1  NUM_ERROR_MSG
    3  LblCom even  none     1      1  NUM_WARN_MSG
    4  LblCom even  none     1      1  ALLOCATE_END
    5  LblCom even  none     2      2  SUBSCHEMA_KEY
    6  LblCom even  none     1      1  BUFFER$
    7  LblCom even  none     1      1  ERROR_IO
    8  LblCom even  none     1      1  BUFFER_LEN
    9  LblCom even  none     2      2  UWA_KEY
   10  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   11  LblCom even  none     2      2  RVA_KEY
   12  LblCom even  none     2      2  IA__KEY
   13  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   14  LblCom even  none    32     40  SEARCHR_NB
   15  LblCom even  none    32     40  SEM_COM
   16  LblCom even  none    32     40  DMCL_XLATE
   17  LblCom even  none    32     40  Q2_PERCENT
   18  LblCom even  none   656   1220  UWA
   19  RoData even  UTS     32     40  DOEIS
   20   Proc  even  none  1392   2560  DOEIS
   21  RoData even  none    46     56  DOEIS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    20      0   yes            yes      Std        0  DOEIS
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:33   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FETCHOS_6
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 FETCHNS_6
 yes     yes           Std       1 DISCONNECT_6
 yes     yes           Std       1 FCURR_R_6
         yes           Std       3 SET_FIELDS
 yes     yes           Std       1 FINDNS_6
 yes     yes           Std       1 MODIFY_6
         yes           Std       2 ZIG$G_DYN_MEM_6
 yes     yes           Std       1 CONNECT_6
 yes     yes           Std       1 FINDOS_6
         yes           Std       1 WARNING
         yes           Std       1 ERROR
         yes           Std       0 ABORT
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:34   


        1        1        /*M* ZIG$DDC5         I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        DOEIS:
        8        8            PROC;

      8 20 000000   000000 700200 xent  DOEIS        TSX0  ! X66_AUTO_0
        20 000001   000044 000000                    ZERO    36,0

        9        9    1   DCL VAR_FIELDS SBIN HALF;
       10       10    1   DCL INDEX_NUM SBIN WORD STATIC;
       11       11    1   DCL CALC_NXT UBIN WORD STATIC;
       12       12    1   DCL CALC_PRI UBIN WORD STATIC;
       13       13    1   DCL GLOBAL_SIZE SBIN HALF STATIC;
       14       14    1   DCL PA_SIZE_1 SBIN WORD STATIC;
       15       15    1   DCL PA_SIZE_N SBIN WORD STATIC;
       16       16    1   DCL ALLOW SBIN WORD STATIC;
       17       17    1   DCL X SBIN WORD STATIC;
       18       18    1   DCL 01 XEIS STATIC,
       19       19    1         02 FIL1 BIT(3) INIT('011'B),
       20       20    1         02 BWRD BIT(15),
       21       21    1         02 BCHR BIT(3),
       22       22    1         02 FIL2 BIT(3) INIT('000'B),
       23       23    1         02 PREC BIT(12);
       24       24    1   DCL 01 EIS1 STATIC,
       25       25    1         02 FIL1 BIT(3) INIT('011'B),
       26       26    1         02 BWRD BIT(15),
       27       27    1         02 BCHR BIT(3),
       28       28    1         02 TYP BIT(1) INIT('1'B),
       29       29    1         02 SIGN BIT(2),
       30       30    1         02 SCALE BIT(6),
       31       31    1         02 PREC BIT(6);
       32       32        /* DCL 01 PNT_FR STATIC,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:35   
       33       33               02 FIL1 BIT(34),
       34       34               02 FTYPE BIT(5) INIT('00101'B),
       35       35               02 PREC BIT(12) INIT('000000000011'B),
       36       36               02 SCALE BIT(8) INIT('00000000'B),
       37       37               02 SIGN BIT(1) INIT('0'B),
       38       38               02 FIL2 BIT(30),
       39       39               02 FIL3 BIT(36) ALIGNED,
       40       40               02 BUFFLOC BIT(36);   */
       41       41    1   DCL 01 MAP STATIC,
       42       42    1         02 XWORD SBIN HALF,
       43       43    1         02 HBYTE SBIN HALF;
       44       44    1   DCL P1 PTR;
       45       45    1   DCL P2 PTR;
       46       46         /* DEFINE DBCS INTERFACE ROUTINES */
       47       47         /* RETURN TO LABEL WILL ONLY OCCUR FOR FETCHNS WHEN A
       48       48            NON-ZERO STATUS OCCURS. FOR ALL OTHER ROUTINES
       49       49            THE 'LABEL' IS A DUMMY, BECAUSE OR A NON-ZERO
       50       50            STATUS THE DBCS ABORTS */
       51       51         /* FIND DBK AND GET */
       52       52    1   DCL 01 CURRENT EXT,
       53       53    1         02 CM BIT(36),
       54       54    1         02 RCM BIT(36),
       55       55    1         02 DNACM BIT(36),
       56       56    1         02 STATUS SBIN HALF,
       57       57    1         02 SUBENTRY SBIN WORD,
       58       58    1         02 SEPNTR SBIN WORD,
       59       59    1         02 SNPNTR SBIN WORD;
       60       60        %INCLUDE ZIA_IDS_DCL;
       61      168        %INCLUDE ZIG_DBA_INT;
       62      216        %INCLUDE ZI_ERRORS_SUBS;
       63      736        %INCLUDE ZI_SUB4_CAN;
       64     1393        %INCLUDE ZIG_GENERAL;
       65     1501        %LIST;
       66     1502        %UWA;
              1503    1   DCL 1    NAME EXT DALIGNED,
              1504    1         2 WORD1        SBIN (36) INIT (0)   UNAL,
              1505    1         2 DB_STATUS    CHAR (7)  INIT (' ') UNAL,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:36   
              1506    1         2 *            CHAR (1)  INIT (' ') UNAL,
              1507    1         2 AREA_NAME    CHAR (30) INIT (' ') UNAL,
              1508    1         2 *            UBIN (18) INIT (0)   UNAL,
              1509    1         2 SET_NAME     CHAR (30) INIT (' ') UNAL,
              1510    1         2 *            UBIN (18) INIT (0)   UNAL,
              1511    1         2 RECORD_NAME  CHAR (30) INIT (' ') UNAL,
              1512    1         2 *            UBIN (18) INIT (0)   UNAL,
              1513    1         2 PRIVACY_KEY  CHAR (12) INIT (' ') UNAL,
              1514    1         2 DIRECT_REF   UBIN (36) INIT (0)   UNAL,
              1515    1         2 DATA_NAME    CHAR (30) INIT (' ') UNAL,
              1516    1         2 *            UBIN (18) INIT (0)   UNAL,
              1517    1         2 KEY_NAME     CHAR (30) INIT (' ') UNAL,
              1518    1         2 *            UBIN (18) INIT (0)   UNAL,
              1519    1         2 *            UBIN (36) INIT (0)   UNAL,
              1520    1         2 SF DALIGNED,
              1521    1           3 RLSE CHAR (5) INIT (' ') UNAL,
              1522    1           3 DBKEY_SA UBIN (36) INIT (0) ALIGNED,
              1523    1           3 DBKEY_OA UBIN (36) INIT (0) ALIGNED,
              1524    1           3 DBKEY_DA UBIN (36) INIT (0) ALIGNED,
              1525    1           3 DBKEY_TA UBIN (36) INIT (0) ALIGNED,
              1526    1         2 AS DALIGNED,
              1527    1           3 SS_NAME CHAR (30) INIT (' ') UNAL,
              1528    1           3 SS_TRAN CHAR (12) INIT (' ') UNAL,
              1529    1           3 SS_LANG SBIN (36)  INIT (0) ALIGNED,
              1530    1           3 SS_DATE CHAR (4) INIT (' ') UNAL,
              1531    1           3 SS_TIME CHAR (4) INIT (' ') UNAL,
              1532    1         2 PG DALIGNED,
              1533    1           3 PROG_NAME CHAR (30) INIT (' ') UNAL,
              1534    1           3 AUTH CHAR (30) INIT (' ') UNAL,
              1535    1           3 COMP_DATE CHAR (12) INIT (' ') UNAL,
              1536    1         2 CA DALIGNED,
              1537    1           3 OWNER_TYPE SBIN (36)  INIT (0) ALIGNED,
              1538    1           3 OWNER_NAME CHAR (30) INIT (' ') UNAL,
              1539    1           3 CAT_FILE SBIN (36)  INIT (0) ALIGNED,
              1540    1           3 CFNAME CHAR (12) INIT (' ') UNAL,
              1541    1           3 PWORD CHAR (12) INIT (' ') UNAL,
              1542    1         2 SI DALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:37   
              1543    1           3 LOCKED SBIN (36)  INIT (0) ALIGNED,
              1544    1           3 BINDCD SBIN (36)  INIT (0) ALIGNED,
              1545    1           3 LI_NE SBIN (36)  INIT (0) ALIGNED,
              1546    1           3 EXCLUDE SBIN (36)  INIT (0) ALIGNED,
              1547    1           3 SETYPE SBIN (36)  INIT (0) ALIGNED,
              1548    1           3 A_LIAS SBIN (36)  INIT (0) ALIGNED,
              1549    1         2 AL DALIGNED,
              1550    1           3 ANAME CHAR (30) INIT (' ') UNAL,
              1551    1           3 DBKEY_SI SBIN (36)  INIT (0) ALIGNED,
              1552    1         2 VB DALIGNED,
              1553    1           3 V_TYPE SBIN(36) INIT(0) ALIGNED,
              1554    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1555    1         2 A_D DALIGNED,
              1556    1           3 AD_FUNCTION SBIN (36)  INIT (0) ALIGNED,
              1557    1           3 AD_DATE CHAR (12) INIT (' ') UNAL,
              1558    1           3 AD_IDENT CHAR (60) INIT (' ') UNAL,
              1559    1         2 OA DALIGNED,
              1560    1           3 NUMB_AC SBIN (36)  INIT (0) ALIGNED,
              1561    1           3 NUMB_RC SBIN (36)  INIT (0) ALIGNED,
              1562    1           3 NUMB_SC SBIN (36)  INIT (0) ALIGNED,
              1563    1           3 NUMB_RA SBIN (36)  INIT (0) ALIGNED,
              1564    1           3 NUMB_FR SBIN (36)  INIT (0) ALIGNED,
              1565    1           3 NUMB_SO SBIN (36)  INIT (0) ALIGNED,
              1566    1           3 NUMB_SM SBIN (36)  INIT (0) ALIGNED,
              1567    1           3 NUMB_SS SBIN (36)  INIT (0) ALIGNED,
              1568    1           3 NUMB_CF SBIN (36)  INIT (0) ALIGNED,
              1569    1           3 COEXIST SBIN (36)  INIT (0) ALIGNED,
              1570    1           3 GLOBAL SBIN (36)  INIT (0) ALIGNED,
              1571    1           3 FILE_CODE CHAR (2) INIT (' ') UNAL,
              1572    1           3 OA_CALC UBIN (36) INIT (0) ALIGNED,
              1573    1         2 AC DALIGNED,
              1574    1           3 DEFAULTS SBIN (36)  INIT (0) ALIGNED,
              1575    1           3 FLAG1 REDEF DEFAULTS,
              1576    1             4 ERROR_TYPE (0:26) BIT (1) UNAL,
              1577    1             4 ERROR_NUM REDEF ERROR_TYPE UBIN (27) UNAL,
              1578    1             4 STATUS  UBIN (9) UNAL,
              1579    1           3 FILE_CODE CHAR (2) INIT (' ') UNAL,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:38   
              1580    1           3 FLAGS REDEF FILE_CODE,
              1581    1             4 CHKSUM BIT (1) UNAL,
              1582    1             4 ENCRP  BIT (1) UNAL,
              1583    1             4 CJRNL  BIT (1) UNAL,
              1584    1             4 TMPLT  BIT (1) UNAL,
              1585    1             4 TJRNL BIT (1) UNAL,
              1586    1             4 *      BIT (13) UNAL,
              1587    1           3 INDEX_CODE CHAR (2) INIT (' ') UNAL,
              1588    1           3 PRIME_KEY SBIN (36)  INIT (0) ALIGNED,
              1589    1           3 SEC_KEY SBIN (36)  INIT (0) ALIGNED,
              1590    1           3 PERMTYPE SBIN (36)  INIT (0) ALIGNED,
              1591    1           3 PAGE_TYP SBIN (36)  INIT (0) ALIGNED,
              1592    1           3 PER_INV SBIN (36)  INIT (0) ALIGNED,
              1593    1           3 CALC_NULL SBIN (36)  INIT (0) ALIGNED,
              1594    1           3 BASE_DBK SBIN (36)  INIT (0) ALIGNED,
              1595    1           3 KEYS_ALLOC SBIN (36)  INIT (0) ALIGNED,
              1596    1           3 KEYS_RSRVD SBIN (36)  INIT (0) ALIGNED,
              1597    1           3 MIN_DBK SBIN (36)  INIT (0) ALIGNED,
              1598    1           3 MAX_DBK SBIN (36)  INIT (0) ALIGNED,
              1599    1           3 MIN_PAGE SBIN (36)  INIT (0) ALIGNED,
              1600    1           3 MAX_PAGE SBIN (36)  INIT (0) ALIGNED,
              1601    1           3 CALC_HDRS SBIN (36)  INIT (0) ALIGNED,
              1602    1           3 FRST_INV_PG SBIN (36)  INIT (0) ALIGNED,
              1603    1           3 DBK_PAGE SBIN (36)  INIT (0) ALIGNED,
              1604    1           3 DBK_CALC SBIN (36)  INIT (0) ALIGNED,
              1605    1           3 LINE_BITS SBIN (36)  INIT (0) ALIGNED,
              1606    1           3 INV_THRESH SBIN (36)  INIT (0) ALIGNED,
              1607    1           3 LOAD_LIMIT SBIN (36)  INIT (0) ALIGNED,
              1608    1           3 PGS_INV_PG SBIN (36)  INIT (0) ALIGNED,
              1609    1           3 INV_UNIT SBIN (36)  INIT (0) ALIGNED,
              1610    1           3 PAGE_SIZE SBIN (36)  INIT (0) ALIGNED,
              1611    1           3 SPACE_AVAIL SBIN (36)  INIT (0) ALIGNED,
              1612    1           3 SECTORS_PAGE SBIN (36)  INIT (0) ALIGNED,
              1613    1           3 CALC_NEXT SBIN (36)  INIT (0) ALIGNED,
              1614    1           3 CALC_NEXT_STRUCT REDEF CALC_NEXT ALIGNED,
              1615    1             4 EIS,                        /* Eis descriptor                     */
              1616    1               5 REG UBIN (3) UNAL,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:39   
              1617    1               5 WD UBIN (15) UNAL,   /* assumes word offset is l.e. 2**15-1     */
              1618    1               5 CHR UBIN (3) UNAL,
              1619    1               5 TA UBIN (2) UNAL,
              1620    1               5 * BIT (1) UNAL,
              1621    1               5 COUNT UBIN (12) UNAL,
              1622    1           3 CALC_PRIOR SBIN (36)  INIT (0) ALIGNED,
              1623    1           3 CALC_PRIOR_STRUCT REDEF CALC_PRIOR ALIGNED,
              1624    1             4 EIS,                        /* Eis descriptor                     */
              1625    1               5 REG UBIN (3) UNAL,
              1626    1               5 WD UBIN (15) UNAL,   /* assumes word offset is l.e. 2**15-1     */
              1627    1               5 CHR UBIN (3) UNAL,
              1628    1               5 TA UBIN (2) UNAL,
              1629    1               5 * BIT (1) UNAL,
              1630    1               5 COUNT UBIN (12) UNAL,
              1631    1         2 RC DALIGNED,
              1632    1           3 RTYPE SBIN (36)  INIT (0) ALIGNED,
              1633    1           3 PSMODE SBIN (36)  INIT (0) ALIGNED,
              1634    1           3 FIXVAR SBIN (36)  INIT (0) ALIGNED,
              1635    1           3 WITHINA SBIN (36)  INIT (0) ALIGNED,
              1636    1           3 SO SBIN (36)  INIT (0) ALIGNED,
              1637    1           3 SM SBIN (36)  INIT (0) ALIGNED,
              1638    1           3 CYCLE SBIN (36)  INIT (0) ALIGNED,
              1639    1           3 CALCDUP SBIN (36)  INIT (0) ALIGNED,
              1640    1           3 ANY_IND SBIN (36)  INIT (0) ALIGNED,
              1641    1           3 KEY_PRESENT SBIN (36)  INIT (0) ALIGNED,
              1642    1           3 CV_OFFSET SBIN (36)  INIT (0) ALIGNED,
              1643    1           3 PA_OFFSET SBIN (36)  INIT (0) ALIGNED,
              1644    1           3 PA_ENTRY SBIN (36)  INIT (0) ALIGNED,
              1645    1           3 NUM_SOSM SBIN (36)  INIT (0) ALIGNED,
              1646    1           3 LSIZE SBIN (36)  INIT (0) ALIGNED,
              1647    1           3 SLACK SBIN (36)  INIT (0) ALIGNED,
              1648    1         2 SC DALIGNED,
              1649    1           3 SETTYPE SBIN (36)  INIT (0) ALIGNED,
              1650    1           3 SETMODE SBIN (36)  INIT (0) ALIGNED,
              1651    1           3 SETORD SBIN (36)  INIT (0) ALIGNED,
              1652    1           3 SETGLO SBIN (36)  INIT (0) ALIGNED,
              1653    1           3 SETPTR SBIN (36)  INIT (0) ALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:40   
              1654    1           3 PTRNO SBIN (36)  INIT (0) ALIGNED,
              1655    1           3 ALTOWN SBIN (36)  INIT (0) ALIGNED,
              1656    1           3 RECSET SBIN (36)  INIT (0) ALIGNED,
              1657    1           3 SEQDUP SBIN (36)  INIT (0) ALIGNED,
              1658    1           3 PTRSZ SBIN (36)  INIT (0) ALIGNED,
              1659    1           3 USER_PTS SBIN (36)  INIT (0) ALIGNED,
              1660    1           3 INDEX_ID SBIN (36)  INIT (0) ALIGNED,
              1661    1           3 KEY_LENGTH SBIN (36)  INIT (0) ALIGNED,
              1662    1         2 RA DALIGNED,
              1663    1           3 LOWDBK SBIN (36)  INIT (0) ALIGNED,
              1664    1           3 HIGHDBK SBIN (36)  INIT (0) ALIGNED,
              1665    1           3 CALC_HDRS SBIN (36)  INIT (0) ALIGNED,
              1666    1           3 HDR_OFFS SBIN (36)  INIT (0) ALIGNED,
              1667    1         2 FR DALIGNED,
              1668    1           3 SYN SBIN (36)  INIT (0) ALIGNED,
              1669    1           3 REF SBIN (36)  INIT (0) ALIGNED,
              1670    1           3 FTYPE SBIN (36)  INIT (0) ALIGNED,
              1671    1           3 PREC SBIN (36)  INIT (0) ALIGNED,
              1672    1           3 SCALE SBIN (36)  INIT (0) ALIGNED,
              1673    1           3 F_SIGN SBIN (36)  INIT (0) ALIGNED,
              1674    1           3 ALGN SBIN (36)  INIT (0) ALIGNED,
              1675    1           3 GROUP_ALIGN SBIN (36)  INIT (0) ALIGNED,
              1676    1           3 F_SYNC SBIN (36)  INIT (0) ALIGNED,
              1677    1           3 F_USE SBIN (36)  INIT (0) ALIGNED,
              1678    1           3 RPT SBIN (36)  INIT (0) ALIGNED,
              1679    1           3 F_OCCURS SBIN (36)  INIT (0) ALIGNED,
              1680    1           3 LEVEL SBIN (36)  INIT (0) ALIGNED,
              1681    1           3 DERIVED SBIN (36)  INIT (0) ALIGNED,
              1682    1           3 BEIST SBIN (36)  INIT (0) ALIGNED,
              1683    1           3 BUFFLOC SBIN (36)  INIT (0) ALIGNED,
              1684    1           3 FR_FRH UBIN (36) INIT (0) ALIGNED,
              1685    1         2 SO DALIGNED,
              1686    1           3 PSEQ SBIN (36)  INIT (0) ALIGNED,
              1687    1           3 NXTPNT SBIN (36)  INIT (0) ALIGNED,
              1688    1           3 PRIPNT SBIN (36)  INIT (0) ALIGNED,
              1689    1         2 SM DALIGNED,
              1690    1           3 INSTYPE SBIN (36)  INIT (0) ALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:41   
              1691    1           3 RETTYPE SBIN (36)  INIT (0) ALIGNED,
              1692    1           3 MEMDUP SBIN (36)  INIT (0) ALIGNED,
              1693    1           3 SEQDUP SBIN (36)  INIT (0) ALIGNED,
              1694    1           3 CALCDUP SBIN (36)  INIT (0) ALIGNED,
              1695    1           3 PAMEM SBIN (36)  INIT (0) ALIGNED,
              1696    1           3 PSMODE SBIN (36)  INIT (0) ALIGNED,
              1697    1           3 PSEQ SBIN (36)  INIT (0) ALIGNED,
              1698    1           3 NXTPNT SBIN (36)  INIT (0) ALIGNED,
              1699    1           3 PRIPNT SBIN (36)  INIT (0) ALIGNED,
              1700    1           3 HDPNT SBIN (36)  INIT (0) ALIGNED,
              1701    1           3 PA_MEMPNT SBIN (36)  INIT (0) ALIGNED,
              1702    1         2 S_S DALIGNED,
              1703    1           3 STYP SBIN (36)  INIT (0) ALIGNED,
              1704    1           3 SC_SSH UBIN (36) INIT (0) ALIGNED,
              1705    1           3 SOSM_SSH UBIN (36) INIT (0) ALIGNED,
              1706    1           3 USE_PA SBIN (36)  INIT (0) ALIGNED,
              1707    1         2 C_F DALIGNED,
              1708    1           3 SYN SBIN (36)  INIT (0) ALIGNED,
              1709    1           3 CTRLTYPE SBIN (36)  INIT (0) ALIGNED,
              1710    1           3 DERIVED SBIN (36)  INIT (0) ALIGNED,
              1711    1           3 CTRLSEQ SBIN (36)  INIT (0) ALIGNED,
              1712    1           3 CNVRT SBIN (36)  INIT (0) ALIGNED,
              1713    1         2 DA DALIGNED,
              1714    1           3 NUMB_SN SBIN (36)  INIT (0) ALIGNED,
              1715    1           3 NUMB_NR SBIN (36)  INIT (0) ALIGNED,
              1716    1           3 NUMB_LK SBIN (36)  INIT (0) ALIGNED,
              1717    1           3 NUMB_PN SBIN (36)  INIT (0) ALIGNED,
              1718    1           3 NUMB_LT SBIN (36)  INIT (0) ALIGNED,
              1719    1           3 NUMB_PT SBIN (36)  INIT (0) ALIGNED,
              1720    1           3 NUMB_AG SBIN (36)  INIT (0) ALIGNED,
              1721    1           3 FRST_AC UBIN (36) INIT (0) ALIGNED,
              1722    1           3 FRST_RC UBIN (36) INIT (0) ALIGNED,
              1723    1           3 FRST_SC UBIN (36) INIT (0) ALIGNED,
              1724    1           3 FRST_KC UBIN (36) INIT (0) ALIGNED,
              1725    1           3 FRST_FR UBIN (36) INIT (0) ALIGNED,
              1726    1         2 SN DALIGNED,
              1727    1           3 DCLR SBIN (36)  INIT (0) ALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:42   
              1728    1           3 ESCAPE SBIN (36)  INIT (0) ALIGNED,
              1729    1           3 SETYPE SBIN (36)  INIT (0) ALIGNED,
              1730    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1731    1           3 ACTLCKS SBIN (36)  INIT (0) ALIGNED,
              1732    1           3 SENAME CHAR (30) INIT (' ') UNAL,
              1733    1         2 LK DALIGNED,
              1734    1           3 PLNAME CHAR (30) INIT (' ') UNAL,
              1735    1           3 PLVALUE CHAR (12) INIT (' ') UNAL,
              1736    1         2 PN DALIGNED,
              1737    1           3 LANG SBIN (36)  INIT (0) ALIGNED,
              1738    1           3 PNAME CHAR (30) INIT (' ') UNAL,
              1739    1         2 NR DALIGNED,
              1740    1           3 SRCE SBIN (36)  INIT (0) ALIGNED,
              1741    1           3 IMPLCT SBIN (36)  INIT (0) ALIGNED,
              1742    1           3 RELTYPE SBIN (36)  INIT (0) ALIGNED,
              1743    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1744    1         2 LT DALIGNED,
              1745    1           3 SUBENTRY SBIN (36)  INIT (0) ALIGNED,
              1746    1           3 PLOCKS SBIN (36)  INIT (0) ALIGNED,
              1747    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1748    1         2 PT DALIGNED,
              1749    1           3 PTYPE SBIN (36)  INIT (0) ALIGNED,
              1750    1           3 LNO SBIN (36)  INIT (0) ALIGNED,
              1751    1         2 AG DALIGNED,
              1752    1           3 ATYPE SBIN (36)  INIT (0) ALIGNED,
              1753    1           3 AG_SE UBIN (36) INIT (0) ALIGNED,
              1754    1         2  TX DALIGNED,
              1755    1           3 A_TXT CHAR (60) INIT (' ') UNAL,
              1756    1         2 SA DALIGNED,
              1757    1           3 NUMB_DD SBIN (36)  INIT (0) ALIGNED,
              1758    1           3 NUMB_DM SBIN (36)  INIT (0) ALIGNED,
              1759    1         2 DD DALIGNED,
              1760    1           3 DD_TXT_LINE CHAR (80) INIT (' ') UNAL,
              1761    1         2 DM DALIGNED,
              1762    1           3 DMCL_TXT_LINE CHAR (80) INIT (' ') UNAL,
              1763    1         2 DBP DALIGNED,
              1764    1           3 DB_ADDR UBIN (36) INIT (0) ALIGNED,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:43   
              1765    1           3 DBP_SF_KEY UBIN (36) INIT (0) ALIGNED,
              1766    1         2 OSE DALIGNED,
              1767    1           3 OFFSET_SE SBIN (36)  INIT (0) ALIGNED,
              1768    1           3 DBKEY_SE UBIN (36) INIT (0) ALIGNED,
              1769    1         2 OSN DALIGNED,
              1770    1           3 OFFSET_SN SBIN (36)  INIT (0) ALIGNED,
              1771    1           3 DBKEY_SN UBIN (36) INIT (0) ALIGNED,
              1772    1         2 TA DALIGNED,
              1773    1           3 NUM_TOKS SBIN (36)  INIT (0) ALIGNED,
              1774    1         2 TOK DALIGNED,
              1775    1           3 TTYPE SBIN (36)  INIT (0) ALIGNED,
              1776    1           3 T_CODE SBIN (36)  INIT (0) ALIGNED,
              1777    1           3 T_LINE SBIN (36)  INIT (0) ALIGNED,
              1778    1           3 T_START SBIN (36)  INIT (0) ALIGNED,
              1779    1           3 TLENGTH SBIN (36)  INIT (0) ALIGNED,
              1780    1           3 TVALUE SBIN (36)  INIT (0) ALIGNED,
              1781    1           3 WORD1 CHAR (30) INIT (' ') UNAL,
              1782    1         2 VOA DALIGNED,
              1783    1           3 VOA_DATA CHAR (40) INIT (' ') UNAL,
              1784    1         2 VAC DALIGNED,
              1785    1           3 VAC_DATA CHAR (92) INIT (' ') UNAL,
              1786    1         2 VRA DALIGNED,
              1787    1           3 VRA_DATA CHAR (36) INIT (' ') UNAL,
              1788    1         2 VRC DALIGNED,
              1789    1           3 VRC_DATA CHAR (44) INIT (' ') UNAL,
              1790    1         2 VFR DALIGNED,
              1791    1           3 VFR_DATA CHAR (36) INIT (' ') UNAL,
              1792    1         2 VSC DALIGNED,
              1793    1           3 VSC_DATA CHAR (24) INIT (' ') UNAL,
              1794    1         2 VSO DALIGNED,
              1795    1           3 VSO_DATA CHAR (28) INIT (' ') UNAL,
              1796    1         2 VSM DALIGNED,
              1797    1           3 VSM_DATA CHAR (48) INIT (' ') UNAL,
              1798    1         2 VSS DALIGNED,
              1799    1           3 VSS_DATA CHAR (24) INIT (' ') UNAL,
              1800    1         2 VCF DALIGNED,
              1801    1           3 VCF_DATA CHAR (36) INIT (' ') UNAL,
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:44   
              1802    1         2 VDA DALIGNED,
              1803    1           3 VDA_DATA CHAR (48) INIT (' ') UNAL,
              1804    1         2 VSN DALIGNED,
              1805    1           3 VSN_DATA CHAR (76) INIT (' ') UNAL,
              1806    1         2 VNR DALIGNED,
              1807    1           3 VNR_DATA CHAR (32) INIT (' ') UNAL,
              1808    1         2 VLK DALIGNED,
              1809    1           3 VLK_DATA CHAR (44) INIT (' ') UNAL,
              1810    1         2 VLT DALIGNED,
              1811    1           3 VLT_DATA CHAR (32) INIT (' ') UNAL,
              1812    1         2 VPN DALIGNED,
              1813    1           3 VPN_DATA CHAR (48) INIT (' ') UNAL,
              1814    1         2 VPT DALIGNED,
              1815    1           3 VPT_DATA CHAR (28) INIT (' ') UNAL,
              1816    1         2 VAG DALIGNED,
              1817    1           3 VAG_DATA CHAR (16) INIT (' ') UNAL,
              1818    1         2 VTA DALIGNED,
              1819    1           3 VTA_DATA CHAR (32) INIT (' ') UNAL,
              1820    1         2 VLM DALIGNED,
              1821    1           3 VLM_DATA CHAR (20) INIT (' ') UNAL,
              1822    1         2 VMK DALIGNED,
              1823    1           3 VMK_DATA CHAR (20) INIT (' ') UNAL,
              1824    1         2 VMD DALIGNED,
              1825    1           3 VMD_DATA CHAR (20) INIT (' ') UNAL,
              1826    1         2 VKN DALIGNED,
              1827    1           3 VKN_DATA CHAR (20) INIT (' ') UNAL,
              1828    1         2 VWI DALIGNED,
              1829    1           3 VWI_DATA CHAR (20) INIT (' ') UNAL,
              1830    1         2 VSP DALIGNED,
              1831    1           3 VSP_DATA CHAR (24) INIT (' ') UNAL,
              1832    1         2 VT2 DALIGNED,
              1833    1           3 VT2_DATA CHAR (20) INIT (' ') UNAL,
              1834    1         2 VCTK DALIGNED,
              1835    1           3 VCTK_DATA CHAR (48) INIT (' ') UNAL;
       67     1837        %PLIST;
       68     1838    1   DCL 01 SOSM_TB(0:0) BASED(SP),
       69     1839    1         02 NAME CHAR(30), /* SET NAME (SN) */
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:45   
       70     1840    1         02 XADDR SBIN WORD, /* SO OR SM DBK */
       71     1841    1         02 REC_TYPE SBIN WORD; /* 0=SO  1=SM */
       72     1842    1   DCL SP PTR;
       73     1843    1   DCL Z SBIN HALF;
       74     1844    1   DCL Z1 SBIN HALF;
       75     1845    1   DCL STYPE SBIN WORD;
       76     1846    1   DCL EISF$ PTR;
       77     1847    1   DCL EISF SBIN WORD BASED(EISF$);
       78     1848    1   DCL EISD$ PTR;
       79     1849    1   DCL EISD SBIN WORD BASED(EISD$);
       80     1850    1   DCL DBK_FR SBIN WORD;
       81     1851    1   DCL DBK SBIN WORD;
       82     1852    1   DCL NM_SOSM SBIN HALF;
       83     1853    1   DCL TEMP CHAR(30);
       84     1854    1   DCL TEMP_UBIN_WORD UBIN WORD;
       85     1855    1   DCL CHARV_PREC SBIN WORD;
       86     1856         /* S T A R T   O F   P R O G R A M */
       87     1857    1       EISF$ = ADDR(XEIS);

   1857 20 000002   000000 236000 21                 LDQ     0
        20 000003   200012 756100                    STQ     EISF$,,AUTO

       88     1858    1       EISD$ = ADDR(EIS1);

   1858 20 000004   000001 236000 21                 LDQ     1
        20 000005   200013 756100                    STQ     EISD$,,AUTO

       89     1859    1       MAP.XWORD = 1;

   1859 20 000006   000001 220003                    LDX0    1,DU
        20 000007   000012 740000 0                  STX0    MAP

       90     1860    1       MAP.HBYTE = 0;

   1860 20 000010   000000 221003                    LDX1    0,DU
        20 000011   000013 741000 0                  STX1    MAP+1

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:46   
       91     1861    1       UWA.FR.FTYPE = 5;

   1861 20 000012   000005 235007                    LDA     5,DL
        20 000013   000334 755000 18                 STA     UWA+220

       92     1862    1       UWA.FR.PREC = 3;

   1862 20 000014   000003 235007                    LDA     3,DL
        20 000015   000335 755000 18                 STA     UWA+221

       93     1863    1       UWA.FR.SCALE = 0;

   1863 20 000016   000336 450000 18                 STZ     UWA+222

       94     1864    1       UWA.FR.F_SIGN = 0;

   1864 20 000017   000337 450000 18                 STZ     UWA+223

       95     1865    1       UWA.FR.SCALE = 0;

   1865 20 000020   000336 450000 18                 STZ     UWA+222

       96     1866         /* START AT BEGINNING - JUST IN CASE WE
       97     1867            HIT UPON EXISTING OCCURRENCE */
       98     1868    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);

   1868 20 000021   000003 630400 21                 EPPR0   3
        20 000022   000002 631400 21                 EPPR1   2
        20 000023   000000 701000 xent               TSX1    FETCHOS_6
        20 000024   002554 702000 20                 TSX2    ERROR1

       99     1869    1       CALL FETCHOS_6('OA-AC   ') ALTRET(ERROR1);

   1869 20 000025   000004 630400 21                 EPPR0   4
        20 000026   000002 631400 21                 EPPR1   2
        20 000027   000000 701000 xent               TSX1    FETCHOS_6
        20 000030   002554 702000 20                 TSX2    ERROR1
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:47   

      100     1870    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   1870 20 000031   000005 630400 21                 EPPR0   5
        20 000032   000002 631400 21                 EPPR1   2
        20 000033   000000 701000 xent               TSX1    FETCHOS_6
        20 000034   002554 702000 20                 TSX2    ERROR1

      101     1871    1       GLOBAL_SIZE = UWA.OA.GLOBAL + 1;

   1871 20 000035   000226 720000 18                 LXL0    UWA+150
        20 000036   000001 621010                    EAX1    1,X0
        20 000037   000003 741000 0                  STX1    GLOBAL_SIZE

      102     1872    1       UWA.FR.PREC = GLOBAL_SIZE;

   1872 20 000040   000003 235000 0                  LDA     GLOBAL_SIZE
        20 000041   000022 731000                    ARS     18
        20 000042   000335 755000 18                 STA     UWA+221

      103     1873    1       CALL EISGEN;

   1873 20 000043   001602 701000 20                 TSX1    EISGEN
        20 000044   000000 011000                    NOP     0

      104     1874    1       CALC_NXT = UWA.FR.BUFFLOC;

   1874 20 000045   000351 235000 18                 LDA     UWA+233
        20 000046   000001 755000 0                  STA     CALC_NXT

      105     1875    1       CALL EISGEN;

   1875 20 000047   001602 701000 20                 TSX1    EISGEN
        20 000050   000000 011000                    NOP     0

      106     1876    1       CALC_PRI = UWA.FR.BUFFLOC;

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:48   
   1876 20 000051   000351 235000 18                 LDA     UWA+233
        20 000052   000002 755000 0                  STA     CALC_PRI

      107     1877         /* GO THRU ALL AC RECORDS AND SET CALC_NEXT
      108     1878            AND CALC_PRIOR FIELDS */
      109     1879    1   DOAC:
      110     1880    1       CALL FETCHNS_6('OA-AC   ') ALTRET(DOSET);

   1880 20 000053   000004 630400 21    DOAC         EPPR0   4
        20 000054   000002 631400 21                 EPPR1   2
        20 000055   000000 701000 xent               TSX1    FETCHNS_6
        20 000056   000070 702000 20                 TSX2    DOSET

      111     1881    1       UWA.AC.CALC_NEXT = CALC_NXT;

   1881 20 000057   000001 235000 0                  LDA     CALC_NXT
        20 000060   000265 755000 18                 STA     UWA+181

      112     1882    1       UWA.AC.CALC_PRIOR = CALC_PRI;

   1882 20 000061   000002 236000 0                  LDQ     CALC_PRI
        20 000062   000266 756000 18                 STQ     UWA+182

      113     1883    1       CALL MODIFY_6('AC  ') ALTRET(ERROR1);

   1883 20 000063   000006 630400 21                 EPPR0   6
        20 000064   000002 631400 21                 EPPR1   2
        20 000065   000000 701000 xent               TSX1    MODIFY_6
        20 000066   002554 702000 20                 TSX2    ERROR1

      114     1884    1       GOTO DOAC;

   1884 20 000067   000053 710000 20                 TRA     DOAC

      115     1885         /* FOR EACH RC SORT THE CORRESPONDING SO/SM
      116     1886            RECORDS BASE ON THEIR SET (SC) NAME */
      117     1887    1   DOSET:
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:49   
      118     1888    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);

   1888 20 000070   000003 630400 21    DOSET        EPPR0   3
        20 000071   000002 631400 21                 EPPR1   2
        20 000072   000000 701000 xent               TSX1    FETCHOS_6
        20 000073   002554 702000 20                 TSX2    ERROR1

      119     1889    1       NM_SOSM = 0;

   1889 20 000074   000000 220003                    LDX0    0,DU
        20 000075   200016 740100                    STX0    NM_SOSM,,AUTO

      120     1890    1   DOSETS: /* FIRST GO THRU RC RECORDS AND DETERMINE MAX
      121     1891         # OF SO/SM IN ANY ONE OCCURRENCE */
      122     1892    1       CALL FETCHNS_6('OA-RC   ') ALTRET(DOSET1);

   1892 20 000076   000003 630400 21    DOSETS       EPPR0   3
        20 000077   000002 631400 21                 EPPR1   2
        20 000100   000000 701000 xent               TSX1    FETCHNS_6
        20 000101   000133 702000 20                 TSX2    DOSET1

      123     1893         /* CHECK IF POINTER SEQUENCE WAS SPECIFIED */
      124     1894    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(DOSETS1);

   1894 20 000102   000005 630400 21                 EPPR0   5
        20 000103   000002 631400 21                 EPPR1   2
        20 000104   000000 701000 xent               TSX1    FETCHNS_6
        20 000105   000124 702000 20                 TSX2    DOSETS1

      125     1895    1       IF UWA.RECORD_NAME = 'SM' THEN

   1895 20 000106   040000 106400                    CMPC    fill='040'O
        20 000107   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 000110   000007 000002 19                 ADSC9   7                        cn=0,n=2
        20 000111   000115 601000 20                 TNZ     s:1898

      126     1896    1           X = UWA.SM.PSEQ;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:50   

   1896 20 000112   000367 235000 18                 LDA     UWA+247
        20 000113   000007 755000 0                  STA     X
        20 000114   000117 710000 20                 TRA     s:1899

      127     1897    1       ELSE
      128     1898    1           X = UWA.SO.PSEQ;

   1898 20 000115   000354 235000 18                 LDA     UWA+236
        20 000116   000007 755000 0                  STA     X

      129     1899    1       IF X = 1 OR UWA.RC.PSMODE = 4 THEN

   1899 20 000117   000001 115007                    CMPA    1,DL
        20 000120   000076 600000 20                 TZE     DOSETS
        20 000121   000271 236000 18                 LDQ     UWA+185
        20 000122   000004 116007                    CMPQ    4,DL
        20 000123   000076 600000 20                 TZE     DOSETS

      130     1900    1           GOTO DOSETS; /* PTR_SEQ OR INDEX RECORD */
      131     1901    1   DOSETS1:
      132     1902    1       IF UWA.RC.NUM_SOSM > NM_SOSM THEN

   1902 20 000124   200016 236100       DOSETS1      LDQ     NM_SOSM,,AUTO
        20 000125   000022 732000                    QRS     18
        20 000126   000305 116000 18                 CMPQ    UWA+197
        20 000127   000132 605000 20                 TPL     s:1904

      133     1903    1           NM_SOSM = UWA.RC.NUM_SOSM;

   1903 20 000130   000305 720000 18                 LXL0    UWA+197
        20 000131   200016 740100                    STX0    NM_SOSM,,AUTO

      134     1904    1       GOTO DOSETS;

   1904 20 000132   000076 710000 20                 TRA     DOSETS

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:51   
      135     1905    1   DOSET1: /* ALLOCATE ENOUGH ENTRIES FOR MAX # OF SOSM OF
      136     1906         AN OCCURRENCE */
      137     1907    1       CALL ZIG$G_DYN_MEM_6(NM_SOSM * 10,SP);

   1907 20 000133   200016 236100       DOSET1       LDQ     NM_SOSM,,AUTO
        20 000134   000022 732000                    QRS     18
        20 000135   000012 402007                    MPY     10,DL
        20 000136   200036 756100                    STQ     @PREC+1,,AUTO
        20 000137   200006 630500                    EPPR0   SP,,AUTO
        20 000140   200041 450500                    STP0    @PREC+4,,AUTO
        20 000141   200036 631500                    EPPR1   @PREC+1,,AUTO
        20 000142   200040 451500                    STP1    @PREC+3,,AUTO
        20 000143   200040 630500                    EPPR0   @PREC+3,,AUTO
        20 000144   000007 631400 21                 EPPR1   7
        20 000145   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        20 000146   000000 011000                    NOP     0

      138     1908    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);

   1908 20 000147   000003 630400 21                 EPPR0   3
        20 000150   000002 631400 21                 EPPR1   2
        20 000151   000000 701000 xent               TSX1    FETCHOS_6
        20 000152   002554 702000 20                 TSX2    ERROR1

      139     1909    1   DOSETRC:
      140     1910    1       UWA.FR.F_SIGN = 0;

   1910 20 000153   000337 450000 18    DOSETRC      STZ     UWA+223

      141     1911    1       UWA.FR.SCALE = 0;

   1911 20 000154   000336 450000 18                 STZ     UWA+222

      142     1912    1       UWA.FR.PREC = 3;

   1912 20 000155   000003 235007                    LDA     3,DL
        20 000156   000335 755000 18                 STA     UWA+221
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:52   

      143     1913    1       UWA.FR.FTYPE = 5;

   1913 20 000157   000005 236007                    LDQ     5,DL
        20 000160   000334 756000 18                 STQ     UWA+220

      144     1914    1       CALL FETCHNS_6('OA-RC   ') ALTRET(ENDEIS);

   1914 20 000161   000003 630400 21                 EPPR0   3
        20 000162   000002 631400 21                 EPPR1   2
        20 000163   000000 701000 xent               TSX1    FETCHNS_6
        20 000164   002200 702000 20                 TSX2    ENDEIS

      145     1915    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(DOSETRC1);

   1915 20 000165   000005 630400 21                 EPPR0   5
        20 000166   000002 631400 21                 EPPR1   2
        20 000167   000000 701000 xent               TSX1    FETCHNS_6
        20 000170   000213 702000 20                 TSX2    DOSETRC1

      146     1916    1       IF UWA.RECORD_NAME = 'SM' THEN

   1916 20 000171   040000 106400                    CMPC    fill='040'O
        20 000172   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 000173   000007 000002 19                 ADSC9   7                        cn=0,n=2
        20 000174   000200 601000 20                 TNZ     s:1919

      147     1917    1           X = UWA.SM.PSEQ;

   1917 20 000175   000367 235000 18                 LDA     UWA+247
        20 000176   000007 755000 0                  STA     X
        20 000177   000202 710000 20                 TRA     s:1920

      148     1918    1       ELSE
      149     1919    1           X = UWA.SO.PSEQ;

   1919 20 000200   000354 235000 18                 LDA     UWA+236
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:53   
        20 000201   000007 755000 0                  STA     X

      150     1920    1       IF X = 1 OR UWA.RC.PSMODE = 4 THEN

   1920 20 000202   000001 115007                    CMPA    1,DL
        20 000203   000521 600000 20                 TZE     DOPNTS
        20 000204   000271 236000 18                 LDQ     UWA+185
        20 000205   000004 116007                    CMPQ    4,DL
        20 000206   000521 600000 20                 TZE     DOPNTS

      151     1921    1           GOTO DOPNTS; /* PTR_SEQ OR INDEX RECORD */
      152     1922    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   1922 20 000207   000005 630400 21                 EPPR0   5
        20 000210   000002 631400 21                 EPPR1   2
        20 000211   000000 701000 xent               TSX1    FETCHOS_6
        20 000212   002554 702000 20                 TSX2    ERROR1

      153     1923    1   DOSETRC1:
      154     1924    1       NM_SOSM = UWA.RC.NUM_SOSM; /* # OF SO/SM THIS OCCURENCE */

   1924 20 000213   000305 720000 18    DOSETRC1     LXL0    UWA+197
        20 000214   200016 740100                    STX0    NM_SOSM,,AUTO

      155     1925    1       IF NM_SOSM < 2 THEN /* MAKE SURE MORE THAN 1 SO/SM */

   1925 20 000215   000002 100003                    CMPX0   2,DU
        20 000216   000521 604000 20                 TMI     DOPNTS

      156     1926    1           GOTO DOPNTS;
      157     1927    2       DO Z = 1 TO NM_SOSM;

   1927 20 000217   000001 221003                    LDX1    1,DU
        20 000220   200007 741100                    STX1    Z,,AUTO
        20 000221   000300 710000 20                 TRA     s:1938+3

      158     1928    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(DOSETSM);
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:54   

   1928 20 000222   000005 630400 21                 EPPR0   5
        20 000223   000002 631400 21                 EPPR1   2
        20 000224   000000 701000 xent               TSX1    FETCHNS_6
        20 000225   000302 702000 20                 TSX2    DOSETSM

      159     1929    2           DBK = UWA.DIRECT_REF;

   1929 20 000226   000036 235000 18                 LDA     UWA+30
        20 000227   200015 755100                    STA     DBK,,AUTO

      160     1930    2           IF UWA.RECORD_NAME = 'SM' THEN

   1930 20 000230   040000 106400                    CMPC    fill='040'O
        20 000231   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 000232   000007 000002 19                 ADSC9   7                        cn=0,n=2
        20 000233   000243 601000 20                 TNZ     s:1933

      161     1931    2               SOSM_TB.REC_TYPE(Z) = 1;

   1931 20 000234   200007 236100                    LDQ     Z,,AUTO
        20 000235   000022 732000                    QRS     18
        20 000236   000012 402007                    MPY     10,DL
        20 000237   000001 235007                    LDA     1,DL
        20 000240   200006 470500                    LDP0    SP,,AUTO
        20 000241   000011 755106                    STA     9,QL,PR0
        20 000242   000250 710000 20                 TRA     s:1934

      162     1932    2           ELSE
      163     1933    2               SOSM_TB.REC_TYPE(Z) = 0;

   1933 20 000243   200007 236100                    LDQ     Z,,AUTO
        20 000244   000022 732000                    QRS     18
        20 000245   000012 402007                    MPY     10,DL
        20 000246   200006 470500                    LDP0    SP,,AUTO
        20 000247   000011 450106                    STZ     9,QL,PR0

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:55   
      164     1934    2           CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1); /* GET SO/SM 'S SC */

   1934 20 000250   000010 630400 21                 EPPR0   8
        20 000251   000002 631400 21                 EPPR1   2
        20 000252   000000 701000 xent               TSX1    FETCHOS_6
        20 000253   002554 702000 20                 TSX2    ERROR1

      165     1935    2           CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* GET SC NAME */

   1935 20 000254   000011 630400 21                 EPPR0   9
        20 000255   000002 631400 21                 EPPR1   2
        20 000256   000000 701000 xent               TSX1    FETCHOS_6
        20 000257   002554 702000 20                 TSX2    ERROR1

      166     1936    2           SOSM_TB.NAME(Z) = UWA.SN.SENAME;

   1936 20 000260   200007 236100                    LDQ     Z,,AUTO
        20 000261   000022 732000                    QRS     18
        20 000262   000050 402007                    MPY     40,DL
        20 000263   200006 470500                    LDP0    SP,,AUTO
        20 000264   040106 100400                    MLR     fill='040'O
        20 000265   000427 000036 18                 ADSC9   UWA+279                  cn=0,n=30
        20 000266   000000 000036                    ADSC9   0,Q,PR0                  cn=0,n=30

      167     1937    2           SOSM_TB.XADDR(Z) = DBK;

   1937 20 000267   200007 236100                    LDQ     Z,,AUTO
        20 000270   000022 732000                    QRS     18
        20 000271   000012 402007                    MPY     10,DL
        20 000272   200006 470500                    LDP0    SP,,AUTO
        20 000273   200015 235100                    LDA     DBK,,AUTO
        20 000274   000010 755106                    STA     8,QL,PR0

      168     1938    2           END;

   1938 20 000275   200007 220100                    LDX0    Z,,AUTO
        20 000276   000001 621010                    EAX1    1,X0
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:56   
        20 000277   200007 741100                    STX1    Z,,AUTO
        20 000300   200016 101100                    CMPX1   NM_SOSM,,AUTO
        20 000301   000222 604400 20                 TMOZ    s:1928

      169     1939    1   DOSETSM:
      170     1940         /* NOW MUST SORT SOSM_TB IN ASCENDING ORDER */
      171     1941    2       DO Z = 1 TO NM_SOSM - 1;

   1941 20 000302   000001 220003       DOSETSM      LDX0    1,DU
        20 000303   200007 740100                    STX0    Z,,AUTO
        20 000304   000420 710000 20                 TRA     s:1956+3

      172     1942    3           DO Z1 = Z + 1 TO NM_SOSM;

   1942 20 000305   200007 220100                    LDX0    Z,,AUTO
        20 000306   000001 621010                    EAX1    1,X0
        20 000307   200010 741100                    STX1    Z1,,AUTO
        20 000310   000413 710000 20                 TRA     s:1955+3

      173     1943    3               IF SOSM_TB.NAME(Z1) < SOSM_TB.NAME(Z) THEN

   1943 20 000311   200010 236100                    LDQ     Z1,,AUTO
        20 000312   000022 732000                    QRS     18
        20 000313   000050 402007                    MPY     40,DL
        20 000314   200036 756100                    STQ     @PREC+1,,AUTO
        20 000315   200007 236100                    LDQ     Z,,AUTO
        20 000316   000022 732000                    QRS     18
        20 000317   000050 402007                    MPY     40,DL
        20 000320   200006 470500                    LDP0    SP,,AUTO
        20 000321   200036 235100                    LDA     @PREC+1,,AUTO
        20 000322   040106 106505                    CMPC    fill='040'O
        20 000323   000000 000036                    ADSC9   0,A,PR0                  cn=0,n=30
        20 000324   000000 000036                    ADSC9   0,Q,PR0                  cn=0,n=30
        20 000325   000410 603000 20                 TRC     s:1955

      174     1944    4               DO;

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:57   
      175     1945    4                   TEMP = SOSM_TB.NAME(Z);

   1945 20 000326   040100 100506                    MLR     fill='040'O
        20 000327   000000 000036                    ADSC9   0,Q,PR0                  cn=0,n=30
        20 000330   200017 000036                    ADSC9   TEMP,,AUTO               cn=0,n=30

      176     1946    4                   DBK = SOSM_TB.XADDR(Z);

   1946 20 000331   200007 236100                    LDQ     Z,,AUTO
        20 000332   000022 732000                    QRS     18
        20 000333   000012 402007                    MPY     10,DL
        20 000334   000010 235106                    LDA     8,QL,PR0
        20 000335   200015 755100                    STA     DBK,,AUTO

      177     1947    4                   STYPE = SOSM_TB.REC_TYPE(Z);

   1947 20 000336   000011 235106                    LDA     9,QL,PR0
        20 000337   200011 755100                    STA     STYPE,,AUTO

      178     1948    4                   SOSM_TB.NAME(Z) = SOSM_TB.NAME(Z1);

   1948 20 000340   200010 236100                    LDQ     Z1,,AUTO
        20 000341   000022 732000                    QRS     18
        20 000342   000050 402007                    MPY     40,DL
        20 000343   200036 756100                    STQ     @PREC+1,,AUTO
        20 000344   200007 236100                    LDQ     Z,,AUTO
        20 000345   000022 732000                    QRS     18
        20 000346   000050 402007                    MPY     40,DL
        20 000347   200036 235100                    LDA     @PREC+1,,AUTO
        20 000350   040106 100505                    MLR     fill='040'O
        20 000351   000000 000036                    ADSC9   0,A,PR0                  cn=0,n=30
        20 000352   000000 000036                    ADSC9   0,Q,PR0                  cn=0,n=30

      179     1949    4                   SOSM_TB.XADDR(Z) = SOSM_TB.XADDR(Z1);

   1949 20 000353   200007 236100                    LDQ     Z,,AUTO
        20 000354   000022 732000                    QRS     18
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:58   
        20 000355   000012 402007                    MPY     10,DL
        20 000356   000000 620006                    EAX0    0,QL
        20 000357   200010 236100                    LDQ     Z1,,AUTO
        20 000360   000022 732000                    QRS     18
        20 000361   000012 402007                    MPY     10,DL
        20 000362   200006 470500                    LDP0    SP,,AUTO
        20 000363   000010 235106                    LDA     8,QL,PR0
        20 000364   000010 755110                    STA     8,X0,PR0

      180     1950    4                   SOSM_TB.REC_TYPE(Z) = SOSM_TB.REC_TYPE(Z1);

   1950 20 000365   200006 470500                    LDP0    SP,,AUTO
        20 000366   000011 235106                    LDA     9,QL,PR0
        20 000367   000011 755110                    STA     9,X0,PR0

      181     1951    4                   SOSM_TB.NAME(Z1) = TEMP;

   1951 20 000370   200010 236100                    LDQ     Z1,,AUTO
        20 000371   000022 732000                    QRS     18
        20 000372   000050 402007                    MPY     40,DL
        20 000373   200006 470500                    LDP0    SP,,AUTO
        20 000374   040106 100500                    MLR     fill='040'O
        20 000375   200017 000036                    ADSC9   TEMP,,AUTO               cn=0,n=30
        20 000376   000000 000036                    ADSC9   0,Q,PR0                  cn=0,n=30

      182     1952    4                   SOSM_TB.XADDR(Z1) = DBK;

   1952 20 000377   200010 236100                    LDQ     Z1,,AUTO
        20 000400   000022 732000                    QRS     18
        20 000401   000012 402007                    MPY     10,DL
        20 000402   200006 470500                    LDP0    SP,,AUTO
        20 000403   200015 235100                    LDA     DBK,,AUTO
        20 000404   000010 755106                    STA     8,QL,PR0

      183     1953    4                   SOSM_TB.REC_TYPE(Z1) = STYPE;

   1953 20 000405   200006 470500                    LDP0    SP,,AUTO
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:59   
        20 000406   200011 235100                    LDA     STYPE,,AUTO
        20 000407   000011 755106                    STA     9,QL,PR0

      184     1954    4                   END;

      185     1955    3               END;

   1955 20 000410   200010 220100                    LDX0    Z1,,AUTO
        20 000411   000001 621010                    EAX1    1,X0
        20 000412   200010 741100                    STX1    Z1,,AUTO
        20 000413   200016 101100                    CMPX1   NM_SOSM,,AUTO
        20 000414   000311 604400 20                 TMOZ    s:1943

      186     1956    2           END;

   1956 20 000415   200007 220100                    LDX0    Z,,AUTO
        20 000416   000001 622010                    EAX2    1,X0
        20 000417   200007 742100                    STX2    Z,,AUTO
        20 000420   200007 220100                    LDX0    Z,,AUTO
        20 000421   200016 100100                    CMPX0   NM_SOSM,,AUTO
        20 000422   000305 604000 20                 TMI     s:1942

      187     1957         /* MUST NOW GO THROUGH AND RELINK SO/SM RECORDS
      188     1958            IN RC-SOSM SET ACCORDING TO ORDER IN SOSM_TB */
      189     1959    2       DO Z = 1 TO NM_SOSM;

   1959 20 000423   000001 221003                    LDX1    1,DU
        20 000424   200007 741100                    STX1    Z,,AUTO
        20 000425   000517 710000 20                 TRA     s:1973+3

      190     1960    2           TEMP_UBIN_WORD = SOSM_TB.XADDR(Z);

   1960 20 000426   200007 236100                    LDQ     Z,,AUTO
        20 000427   000022 732000                    QRS     18
        20 000430   000012 402007                    MPY     10,DL
        20 000431   200006 470500                    LDP0    SP,,AUTO
        20 000432   000010 235106                    LDA     8,QL,PR0
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:60   
        20 000433   200027 755100                    STA     TEMP_UBIN_WORD,,AUTO

      191     1961    2           IF SOSM_TB.REC_TYPE(Z) = 1 THEN

   1961 20 000434   000011 235106                    LDA     9,QL,PR0
        20 000435   000001 115007                    CMPA    1,DL
        20 000436   000450 601000 20                 TNZ     s:1964

      192     1962    2               CALL FETCHD_6('SM  ', TEMP_UBIN_WORD) ALTRET(ERROR1);

   1962 20 000437   200027 631500                    EPPR1   TEMP_UBIN_WORD,,AUTO
        20 000440   200037 451500                    STP1    @PREC+2,,AUTO
        20 000441   000012 236000 21                 LDQ     10
        20 000442   200036 756100                    STQ     @PREC+1,,AUTO
        20 000443   200036 630500                    EPPR0   @PREC+1,,AUTO
        20 000444   000007 631400 21                 EPPR1   7
        20 000445   000000 701000 xent               TSX1    FETCHD_6
        20 000446   002554 702000 20                 TSX2    ERROR1
        20 000447   000460 710000 20                 TRA     s:1965

      193     1963    2           ELSE
      194     1964    2               CALL FETCHD_6('SO  ', TEMP_UBIN_WORD) ALTRET(ERROR1);

   1964 20 000450   200027 631500                    EPPR1   TEMP_UBIN_WORD,,AUTO
        20 000451   200037 451500                    STP1    @PREC+2,,AUTO
        20 000452   000013 236000 21                 LDQ     11
        20 000453   200036 756100                    STQ     @PREC+1,,AUTO
        20 000454   200036 630500                    EPPR0   @PREC+1,,AUTO
        20 000455   000007 631400 21                 EPPR1   7
        20 000456   000000 701000 xent               TSX1    FETCHD_6
        20 000457   002554 702000 20                 TSX2    ERROR1

      195     1965    2           CALL DISCONNECT_6('RC-SOSM ') ALTRET(ERROR1);

   1965 20 000460   000005 630400 21                 EPPR0   5
        20 000461   000002 631400 21                 EPPR1   2
        20 000462   000000 701000 xent               TSX1    DISCONNECT_6
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:61   
        20 000463   002554 702000 20                 TSX2    ERROR1

      196     1966    2           CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   1966 20 000464   000005 630400 21                 EPPR0   5
        20 000465   000002 631400 21                 EPPR1   2
        20 000466   000000 701000 xent               TSX1    FETCHOS_6
        20 000467   002554 702000 20                 TSX2    ERROR1

      197     1967         /* MAKE SO/SM CURRENT OF RUN UNIT */
      198     1968    2           IF SOSM_TB.REC_TYPE(Z) = 1 THEN

   1968 20 000470   200007 236100                    LDQ     Z,,AUTO
        20 000471   000022 732000                    QRS     18
        20 000472   000012 402007                    MPY     10,DL
        20 000473   200006 470500                    LDP0    SP,,AUTO
        20 000474   000011 235106                    LDA     9,QL,PR0
        20 000475   000001 115007                    CMPA    1,DL
        20 000476   000504 601000 20                 TNZ     s:1971

      199     1969    2               CALL FCURR_R_6('SM  ') ALTRET(ERROR1);

   1969 20 000477   000012 630400 21                 EPPR0   10
        20 000500   000002 631400 21                 EPPR1   2
        20 000501   000000 701000 xent               TSX1    FCURR_R_6
        20 000502   002554 702000 20                 TSX2    ERROR1
        20 000503   000510 710000 20                 TRA     s:1972

      200     1970    2           ELSE
      201     1971    2               CALL FCURR_R_6('SO  ') ALTRET(ERROR1);

   1971 20 000504   000013 630400 21                 EPPR0   11
        20 000505   000002 631400 21                 EPPR1   2
        20 000506   000000 701000 xent               TSX1    FCURR_R_6
        20 000507   002554 702000 20                 TSX2    ERROR1

      202     1972    2           CALL CONNECT_6('RC-SOSM ') ALTRET(ERROR1);
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:62   

   1972 20 000510   000005 630400 21                 EPPR0   5
        20 000511   000002 631400 21                 EPPR1   2
        20 000512   000000 701000 xent               TSX1    CONNECT_6
        20 000513   002554 702000 20                 TSX2    ERROR1

      203     1973    2           END;

   1973 20 000514   200007 220100                    LDX0    Z,,AUTO
        20 000515   000001 621010                    EAX1    1,X0
        20 000516   200007 741100                    STX1    Z,,AUTO
        20 000517   200016 101100                    CMPX1   NM_SOSM,,AUTO
        20 000520   000426 604400 20                 TMOZ    s:1960

      204     1974         /* BUILD EIS DESCRIPTORS FOR EACH SET POINTER */
      205     1975    1   DOPNTS:
      206     1976         /* IN MOST CASES *CALC RECORD IS LINKED IN FIRST.
      207     1977            HOWEVER, FOR THOSE RECORDS SPECIFYING POINTER-SEQ
      208     1978            , THE *CALC RECORD IS NOT NECESSARILY FIRST.
      209     1979            SO LINK *CALC IN FIRST */
      210     1980    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   1980 20 000521   000005 630400 21    DOPNTS       EPPR0   5
        20 000522   000002 631400 21                 EPPR1   2
        20 000523   000000 701000 xent               TSX1    FETCHOS_6
        20 000524   002554 702000 20                 TSX2    ERROR1

      211     1981    1   DONXSM:
      212     1982    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(DONDON);

   1982 20 000525   000005 630400 21    DONXSM       EPPR0   5
        20 000526   000002 631400 21                 EPPR1   2
        20 000527   000000 701000 xent               TSX1    FETCHNS_6
        20 000530   000613 702000 20                 TSX2    DONDON

      213     1983    1       IF UWA.RECORD_NAME = 'SO' THEN

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:63   
   1983 20 000531   040000 106400                    CMPC    fill='040'O
        20 000532   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 000533   000014 000002 19                 ADSC9   12                       cn=0,n=2
        20 000534   000525 600000 20                 TZE     DONXSM

      214     1984    1           GOTO DONXSM;
      215     1985    1       IF UWA.SM.PSEQ = 0 THEN /* PTR_SEQ NOT SPECIFIED */

   1985 20 000535   000367 235000 18                 LDA     UWA+247
        20 000536   000613 600000 20                 TZE     DONDON

      216     1986    1           GOTO DONDON;
      217     1987    1       DBK = UWA.DIRECT_REF;

   1987 20 000537   000036 236000 18                 LDQ     UWA+30
        20 000540   200015 756100                    STQ     DBK,,AUTO

      218     1988    1       CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);

   1988 20 000541   000010 630400 21                 EPPR0   8
        20 000542   000002 631400 21                 EPPR1   2
        20 000543   000000 701000 xent               TSX1    FETCHOS_6
        20 000544   002554 702000 20                 TSX2    ERROR1

      219     1989    1       IF UWA.DIRECT_REF = UWA.OA.OA_CALC THEN /* *CALC */

   1989 20 000545   000036 236000 18                 LDQ     UWA+30
        20 000546   000230 116000 18                 CMPQ    UWA+152
        20 000547   000612 601000 20                 TNZ     s:2002

      220     1990    2       DO;

      221     1991    2           IF UWA.RC.NUM_SOSM = 1 THEN

   1991 20 000550   000305 235000 18                 LDA     UWA+197
        20 000551   000001 115007                    CMPA    1,DL
        20 000552   000525 600000 20                 TZE     DONXSM
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:64   

      222     1992    2               GOTO DONXSM;
      223     1993    2           CALL FCURR_R_6('SM  ') ALTRET(ERROR1);

   1993 20 000553   000012 630400 21                 EPPR0   10
        20 000554   000002 631400 21                 EPPR1   2
        20 000555   000000 701000 xent               TSX1    FCURR_R_6
        20 000556   002554 702000 20                 TSX2    ERROR1

      224     1994    2           CALL DISCONNECT_6('RC-SOSM ') ALTRET(ERROR1);

   1994 20 000557   000005 630400 21                 EPPR0   5
        20 000560   000002 631400 21                 EPPR1   2
        20 000561   000000 701000 xent               TSX1    DISCONNECT_6
        20 000562   002554 702000 20                 TSX2    ERROR1

      225     1995    2           CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   1995 20 000563   000005 630400 21                 EPPR0   5
        20 000564   000002 631400 21                 EPPR1   2
        20 000565   000000 701000 xent               TSX1    FETCHOS_6
        20 000566   002554 702000 20                 TSX2    ERROR1

      226     1996    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(ERROR1);

   1996 20 000567   000005 630400 21                 EPPR0   5
        20 000570   000002 631400 21                 EPPR1   2
        20 000571   000000 701000 xent               TSX1    FETCHNS_6
        20 000572   002554 702000 20                 TSX2    ERROR1

      227     1997    2           TEMP_UBIN_WORD = DBK;

   1997 20 000573   200015 235100                    LDA     DBK,,AUTO
        20 000574   200027 755100                    STA     TEMP_UBIN_WORD,,AUTO

      228     1998    2           CALL FETCHD_6('SM  ', TEMP_UBIN_WORD) ALTRET(ERROR1);

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:65   
   1998 20 000575   200027 630500                    EPPR0   TEMP_UBIN_WORD,,AUTO
        20 000576   200037 450500                    STP0    @PREC+2,,AUTO
        20 000577   000012 236000 21                 LDQ     10
        20 000600   200036 756100                    STQ     @PREC+1,,AUTO
        20 000601   200036 630500                    EPPR0   @PREC+1,,AUTO
        20 000602   000007 631400 21                 EPPR1   7
        20 000603   000000 701000 xent               TSX1    FETCHD_6
        20 000604   002554 702000 20                 TSX2    ERROR1

      229     1999    2           CALL CONNECT_6('RC-SOSM ') ALTRET(ERROR1);

   1999 20 000605   000005 630400 21                 EPPR0   5
        20 000606   000002 631400 21                 EPPR1   2
        20 000607   000000 701000 xent               TSX1    CONNECT_6
        20 000610   002554 702000 20                 TSX2    ERROR1

      230     2000    2           GOTO DONDON;

   2000 20 000611   000613 710000 20                 TRA     DONDON

      231     2001    2           END;
      232     2002    1       GOTO DONXSM;

   2002 20 000612   000525 710000 20                 TRA     DONXSM

      233     2003    1   DONDON:
      234     2004    1       IF UWA.RC.PSMODE = 5

   2004 20 000613   000271 235000 18    DONDON       LDA     UWA+185
        20 000614   000005 115007                    CMPA    5,DL
        20 000615   000623 601000 20                 TNZ     s:2011

      235     2005         /* 4 = INDEXED AND 5 = POINTER ARRAY RC */
      236     2006    2       THEN DO;

      237     2007    2           MAP.XWORD = 2;

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:66   
   2007 20 000616   000002 220003                    LDX0    2,DU
        20 000617   000012 740000 0                  STX0    MAP

      238     2008    2           MAP.HBYTE = 0;

   2008 20 000620   000000 221003                    LDX1    0,DU
        20 000621   000013 741000 0                  STX1    MAP+1

      239     2009    2           END;

   2009 20 000622   000635 710000 20                 TRA     s:2021

      240     2010    2       ELSE DO;

      241     2011    2           IF UWA.RC.PSMODE = 4

   2011 20 000623   000004 115007                    CMPA    4,DL
        20 000624   000631 601000 20                 TNZ     s:2017

      242     2012    3           THEN DO;

      243     2013    3               MAP.XWORD = 0;

   2013 20 000625   000000 220003                    LDX0    0,DU
        20 000626   000012 740000 0                  STX0    MAP

      244     2014    3               MAP.HBYTE = 0;

   2014 20 000627   000013 740000 0                  STX0    MAP+1

      245     2015    3               END;

   2015 20 000630   000635 710000 20                 TRA     s:2021

      246     2016    3           ELSE DO;

      247     2017    3               MAP.XWORD = 1;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:67   

   2017 20 000631   000001 220003                    LDX0    1,DU
        20 000632   000012 740000 0                  STX0    MAP

      248     2018    3               MAP.HBYTE = 0;

   2018 20 000633   000000 221003                    LDX1    0,DU
        20 000634   000013 741000 0                  STX1    MAP+1

      249     2019    3               END;

      250     2020    2           END;

      251     2021    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   2021 20 000635   000005 630400 21                 EPPR0   5
        20 000636   000002 631400 21                 EPPR1   2
        20 000637   000000 701000 xent               TSX1    FETCHOS_6
        20 000640   002554 702000 20                 TSX2    ERROR1

      252     2022    1       INDEX_NUM = 1;

   2022 20 000641   000001 235007                    LDA     1,DL
        20 000642   000000 755000 0                  STA     INDEX_NUM

      253     2023    1   EISA:
      254     2024    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(DOFLDS);

   2024 20 000643   000005 630400 21    EISA         EPPR0   5
        20 000644   000002 631400 21                 EPPR1   2
        20 000645   000000 701000 xent               TSX1    FETCHNS_6
        20 000646   001074 702000 20                 TSX2    DOFLDS

      255     2025    1       TEMP = UWA.RECORD_NAME;

   2025 20 000647   040100 100400                    MLR     fill='040'O
        20 000650   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:68   
        20 000651   200017 000036                    ADSC9   TEMP,,AUTO               cn=0,n=30

      256     2026    1       CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);

   2026 20 000652   000010 630400 21                 EPPR0   8
        20 000653   000002 631400 21                 EPPR1   2
        20 000654   000000 701000 xent               TSX1    FETCHOS_6
        20 000655   002554 702000 20                 TSX2    ERROR1

      257     2027    1       IF UWA.SC.SETTYPE = 2 OR UWA.SC.SETTYPE = 3

   2027 20 000656   000310 235000 18                 LDA     UWA+200
        20 000657   000002 115007                    CMPA    2,DL
        20 000660   000663 600000 20                 TZE     s:2029
        20 000661   000003 115007                    CMPA    3,DL
        20 000662   000710 601000 20                 TNZ     s:2048

      258     2028    2       THEN DO;

      259     2029    2           IF UWA.RC.PSMODE ~= 4

   2029 20 000663   000271 236000 18                 LDQ     UWA+185
        20 000664   000004 116007                    CMPQ    4,DL
        20 000665   000643 601000 20                 TNZ     EISA

      260     2030    2           THEN GOTO EISA;
      261     2031        /*
      262     2032              INDEXED AREA RECORD SO MUST PUT INDEX NUMBER IN
      263     2033            SM.PA_MEMPNT FOR THE INDEX IN THE FILE FOR THIS
      264     2034            ALTERNATE KEY.
      265     2035        */
      266     2036    2           IF UWA.SM.PSMODE = 1

   2036 20 000666   000366 235000 18                 LDA     UWA+246
        20 000667   000001 115007                    CMPA    1,DL
        20 000670   000674 601000 20                 TNZ     s:2041

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:69   
      267     2037    3           THEN DO;

      268     2038    3               UWA.SM.PA_MEMPNT = 1;

   2038 20 000671   000001 235007                    LDA     1,DL
        20 000672   000373 755000 18                 STA     UWA+251

      269     2039    3               END;

   2039 20 000673   000677 710000 20                 TRA     s:2044

      270     2040    3           ELSE DO;

      271     2041    3               INDEX_NUM = INDEX_NUM + 1;

   2041 20 000674   000000 054000 0                  AOS     INDEX_NUM

      272     2042    3               UWA.SM.PA_MEMPNT = INDEX_NUM;

   2042 20 000675   000000 235000 0                  LDA     INDEX_NUM
        20 000676   000373 755000 18                 STA     UWA+251

      273     2043    3               END;

      274     2044    2           CALL FCURR_R_6('SM  ') ALTRET(ERROR1);

   2044 20 000677   000012 630400 21                 EPPR0   10
        20 000700   000002 631400 21                 EPPR1   2
        20 000701   000000 701000 xent               TSX1    FCURR_R_6
        20 000702   002554 702000 20                 TSX2    ERROR1

      275     2045    2           CALL MODIFY_6('SM  ') ALTRET(ERROR1);

   2045 20 000703   000012 630400 21                 EPPR0   10
        20 000704   000002 631400 21                 EPPR1   2
        20 000705   000000 701000 xent               TSX1    MODIFY_6
        20 000706   002554 702000 20                 TSX2    ERROR1
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:70   

      276     2046    2           GOTO EISA;

   2046 20 000707   000643 710000 20                 TRA     EISA

      277     2047    2           END;
      278     2048    1       UWA.FR.PREC = UWA.SC.PTRSZ;

   2048 20 000710   000321 236000 18                 LDQ     UWA+209
        20 000711   000335 756000 18                 STQ     UWA+221

      279     2049    1       IF TEMP = 'SM' THEN

   2049 20 000712   040000 106500                    CMPC    fill='040'O
        20 000713   200017 000036                    ADSC9   TEMP,,AUTO               cn=0,n=30
        20 000714   000007 000002 19                 ADSC9   7                        cn=0,n=2
        20 000715   001042 601000 20                 TNZ     s:2095

      280     2050    2       DO;

      281     2051    2           IF UWA.SC.SETMODE = 2 THEN

   2051 20 000716   000311 235000 18                 LDA     UWA+201
        20 000717   000002 115007                    CMPA    2,DL
        20 000720   000765 601000 20                 TNZ     s:2076

      282     2052    3           DO;

      283     2053    3               IF UWA.SM.PAMEM = 0 THEN

   2053 20 000721   000365 235000 18                 LDA     UWA+245
        20 000722   000734 601000 20                 TNZ     s:2062

      284     2054    4               DO;

      285     2055    4                   CALL EISGEN;

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:71   
   2055 20 000723   001602 701000 20                 TSX1    EISGEN
        20 000724   000000 011000                    NOP     0

      286     2056    4                   UWA.SM.NXTPNT = UWA.FR.BUFFLOC;

   2056 20 000725   000351 235000 18                 LDA     UWA+233
        20 000726   000370 755000 18                 STA     UWA+248

      287     2057    4                   CALL EISGEN;

   2057 20 000727   001602 701000 20                 TSX1    EISGEN
        20 000730   000000 011000                    NOP     0

      288     2058    4                   UWA.SM.HDPNT = UWA.FR.BUFFLOC;

   2058 20 000731   000351 235000 18                 LDA     UWA+233
        20 000732   000372 755000 18                 STA     UWA+250

      289     2059    4                   END;

   2059 20 000733   000754 710000 20                 TRA     s:2071

      290     2060    3               ELSE
      291     2061    4               DO;

      292     2062    4                   MAP.XWORD = 2;

   2062 20 000734   000002 220003                    LDX0    2,DU
        20 000735   000012 740000 0                  STX0    MAP

      293     2063    4                   MAP.HBYTE = 0;

   2063 20 000736   000000 221003                    LDX1    0,DU
        20 000737   000013 741000 0                  STX1    MAP+1

      294     2064    4                   CALL EISGEN;

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:72   
   2064 20 000740   001602 701000 20                 TSX1    EISGEN
        20 000741   000000 011000                    NOP     0

      295     2065    4                   UWA.SM.NXTPNT = UWA.FR.BUFFLOC;

   2065 20 000742   000351 235000 18                 LDA     UWA+233
        20 000743   000370 755000 18                 STA     UWA+248

      296     2066    4                   CALL EISGEN;

   2066 20 000744   001602 701000 20                 TSX1    EISGEN
        20 000745   000000 011000                    NOP     0

      297     2067    4                   UWA.SM.PRIPNT = UWA.FR.BUFFLOC;

   2067 20 000746   000351 235000 18                 LDA     UWA+233
        20 000747   000371 755000 18                 STA     UWA+249

      298     2068    4                   CALL EISGEN;

   2068 20 000750   001602 701000 20                 TSX1    EISGEN
        20 000751   000000 011000                    NOP     0

      299     2069    4                   UWA.SM.HDPNT = UWA.FR.BUFFLOC;

   2069 20 000752   000351 235000 18                 LDA     UWA+233
        20 000753   000372 755000 18                 STA     UWA+250

      300     2070    4                   END;

      301     2071    3               CALL FCURR_R_6('SM  ') ALTRET(ERROR1);

   2071 20 000754   000012 630400 21                 EPPR0   10
        20 000755   000002 631400 21                 EPPR1   2
        20 000756   000000 701000 xent               TSX1    FCURR_R_6
        20 000757   002554 702000 20                 TSX2    ERROR1

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:73   
      302     2072    3               CALL MODIFY_6('SM  ') ALTRET(ERROR1);

   2072 20 000760   000012 630400 21                 EPPR0   10
        20 000761   000002 631400 21                 EPPR1   2
        20 000762   000000 701000 xent               TSX1    MODIFY_6
        20 000763   002554 702000 20                 TSX2    ERROR1

      303     2073    3               GOTO EISA;

   2073 20 000764   000643 710000 20                 TRA     EISA

      304     2074    3               END;
      305     2075         /* IS SC PTR = *CALC PTR */
      306     2076    2           IF UWA.DIRECT_REF = UWA.OA.OA_CALC THEN

   2076 20 000765   000036 236000 18                 LDQ     UWA+30
        20 000766   000230 116000 18                 CMPQ    UWA+152
        20 000767   001015 601000 20                 TNZ     s:2085

      307     2077    3           DO;

      308     2078    3               UWA.SM.NXTPNT = CALC_NXT;

   2078 20 000770   000001 235000 0                  LDA     CALC_NXT
        20 000771   000370 755000 18                 STA     UWA+248

      309     2079    3               UWA.SM.PRIPNT = CALC_PRI;

   2079 20 000772   000002 235000 0                  LDA     CALC_PRI
        20 000773   000371 755000 18                 STA     UWA+249

      310     2080    3               CALL FCURR_R_6('SM  ') ALTRET(ERROR1);

   2080 20 000774   000012 630400 21                 EPPR0   10
        20 000775   000002 631400 21                 EPPR1   2
        20 000776   000000 701000 xent               TSX1    FCURR_R_6
        20 000777   002554 702000 20                 TSX2    ERROR1
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:74   

      311     2081    3               CALL MODIFY_6('SM  ') ALTRET(ERROR1);

   2081 20 001000   000012 630400 21                 EPPR0   10
        20 001001   000002 631400 21                 EPPR1   2
        20 001002   000000 701000 xent               TSX1    MODIFY_6
        20 001003   002554 702000 20                 TSX2    ERROR1

      312     2082    3               CALL ALLOCATE(GLOBAL_SIZE * 4);

   2082 20 001004   000003 235000 0                  LDA     GLOBAL_SIZE
        20 001005   777777 375003                    ANA     -1,DU
        20 001006   000020 731000                    ARS     16
        20 001007   200042 755100                    STA     @PREC+5,,AUTO
        20 001010   200042 630500                    EPPR0   @PREC+5,,AUTO
        20 001011   200035 450500                    STP0    @DBK_C+2,,AUTO
        20 001012   002067 701000 20                 TSX1    ALLOCATE
        20 001013   000000 011000                    NOP     0

      313     2083    3               GOTO EISA;

   2083 20 001014   000643 710000 20                 TRA     EISA

      314     2084    3               END;
      315     2085    2           CALL EISGEN;

   2085 20 001015   001602 701000 20                 TSX1    EISGEN
        20 001016   000000 011000                    NOP     0

      316     2086    2           UWA.SM.NXTPNT = UWA.FR.BUFFLOC;

   2086 20 001017   000351 235000 18                 LDA     UWA+233
        20 001020   000370 755000 18                 STA     UWA+248

      317     2087    2           CALL EISGEN;

   2087 20 001021   001602 701000 20                 TSX1    EISGEN
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:75   
        20 001022   000000 011000                    NOP     0

      318     2088    2           UWA.SM.PRIPNT = UWA.FR.BUFFLOC;

   2088 20 001023   000351 235000 18                 LDA     UWA+233
        20 001024   000371 755000 18                 STA     UWA+249

      319     2089    2           CALL EISGEN;

   2089 20 001025   001602 701000 20                 TSX1    EISGEN
        20 001026   000000 011000                    NOP     0

      320     2090    2           UWA.SM.HDPNT = UWA.FR.BUFFLOC;

   2090 20 001027   000351 235000 18                 LDA     UWA+233
        20 001030   000372 755000 18                 STA     UWA+250

      321     2091    2           CALL FCURR_R_6('SM  ') ALTRET(ERROR1);

   2091 20 001031   000012 630400 21                 EPPR0   10
        20 001032   000002 631400 21                 EPPR1   2
        20 001033   000000 701000 xent               TSX1    FCURR_R_6
        20 001034   002554 702000 20                 TSX2    ERROR1

      322     2092    2           CALL MODIFY_6('SM  ') ALTRET(ERROR1);

   2092 20 001035   000012 630400 21                 EPPR0   10
        20 001036   000002 631400 21                 EPPR1   2
        20 001037   000000 701000 xent               TSX1    MODIFY_6
        20 001040   002554 702000 20                 TSX2    ERROR1

      323     2093    2           GOTO EISA;

   2093 20 001041   000643 710000 20                 TRA     EISA

      324     2094    2           END;
      325     2095    1       IF TEMP = 'SO' THEN
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:76   

   2095 20 001042   040000 106500                    CMPC    fill='040'O
        20 001043   200017 000036                    ADSC9   TEMP,,AUTO               cn=0,n=30
        20 001044   000014 000002 19                 ADSC9   12                       cn=0,n=2
        20 001045   001067 601000 20                 TNZ     s:2105

      326     2096    2       DO;

      327     2097    2           CALL EISGEN;

   2097 20 001046   001602 701000 20                 TSX1    EISGEN
        20 001047   000000 011000                    NOP     0

      328     2098    2           UWA.SO.NXTPNT = UWA.FR.BUFFLOC;

   2098 20 001050   000351 235000 18                 LDA     UWA+233
        20 001051   000355 755000 18                 STA     UWA+237

      329     2099    2           CALL EISGEN;

   2099 20 001052   001602 701000 20                 TSX1    EISGEN
        20 001053   000000 011000                    NOP     0

      330     2100    2           UWA.SO.PRIPNT = UWA.FR.BUFFLOC;

   2100 20 001054   000351 235000 18                 LDA     UWA+233
        20 001055   000356 755000 18                 STA     UWA+238

      331     2101    2           CALL FCURR_R_6('SO  ') ALTRET(ERROR1);

   2101 20 001056   000013 630400 21                 EPPR0   11
        20 001057   000002 631400 21                 EPPR1   2
        20 001060   000000 701000 xent               TSX1    FCURR_R_6
        20 001061   002554 702000 20                 TSX2    ERROR1

      332     2102    2           CALL MODIFY_6('SO  ') ALTRET(ERROR1);

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:77   
   2102 20 001062   000013 630400 21                 EPPR0   11
        20 001063   000002 631400 21                 EPPR1   2
        20 001064   000000 701000 xent               TSX1    MODIFY_6
        20 001065   002554 702000 20                 TSX2    ERROR1

      333     2103    2           GOTO EISA;

   2103 20 001066   000643 710000 20                 TRA     EISA

      334     2104    2           END;
      335     2105    1       CALL ERROR(2400);

   2105 20 001067   000015 630400 21                 EPPR0   13
        20 001070   000002 631400 21                 EPPR1   2
        20 001071   000000 701000 xent               TSX1    ERROR
        20 001072   000000 011000                    NOP     0

      336     2106        /*E*     ERROR:    ZIG-ZIG_ERR_IN_EIS_DESC-C
      337     2107        MESSAGE: Error in building EIS descriptors.
      338     2108                 <<<< SOFTWARE ERROR >>>>
      339     2109        */
      340     2110    1       GOTO EISA;

   2110 20 001073   000643 710000 20                 TRA     EISA

      341     2111         /* DETERMINE LENGTH OF FIXED FIELDS IN RC TYPE RECORD
      342     2112            BY GOING THROUGH RC RECORDS DETERMININ THE LENGTH
      343     2113            OF EACH FIELD */
      344     2114    1   DOFLDS:
      345     2115    1       CALL FETCHOS_6('RC-FR   ') ALTRET(ERROR1);

   2115 20 001074   000016 630400 21    DOFLDS       EPPR0   14
        20 001075   000002 631400 21                 EPPR1   2
        20 001076   000000 701000 xent               TSX1    FETCHOS_6
        20 001077   002554 702000 20                 TSX2    ERROR1

      346     2116    1       VAR_FIELDS = 0;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:78   

   2116 20 001100   000000 220003                    LDX0    0,DU
        20 001101   200003 740100                    STX0    VAR_FIELDS,,AUTO

      347     2117    1       CHARV_PREC = 0;

   2117 20 001102   200030 450100                    STZ     CHARV_PREC,,AUTO

      348     2118    1   DOFI:
      349     2119    1       CALL FETCHNS_6('RC-FR   ') ALTRET(VARFR);

   2119 20 001103   000016 630400 21    DOFI         EPPR0   14
        20 001104   000002 631400 21                 EPPR1   2
        20 001105   000000 701000 xent               TSX1    FETCHNS_6
        20 001106   001202 702000 20                 TSX2    VARFR

      350     2120    1       IF UWA.FR.FTYPE = 19 THEN

   2120 20 001107   000334 235000 18                 LDA     UWA+220
        20 001110   000023 115007                    CMPA    19,DL
        20 001111   001121 601000 20                 TNZ     s:2126

      351     2121    2       DO;

      352     2122    2           VAR_FIELDS = VAR_FIELDS + 1; /* CHAR VARYING */

   2122 20 001112   200003 220100                    LDX0    VAR_FIELDS,,AUTO
        20 001113   000001 621010                    EAX1    1,X0
        20 001114   200003 741100                    STX1    VAR_FIELDS,,AUTO

      353     2123    2           CHARV_PREC = CHARV_PREC + UWA.FR.PREC;

   2123 20 001115   200030 236100                    LDQ     CHARV_PREC,,AUTO
        20 001116   000335 036000 18                 ADLQ    UWA+221
        20 001117   200030 756100                    STQ     CHARV_PREC,,AUTO

      354     2124    2           GOTO DOFI;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:79   

   2124 20 001120   001103 710000 20                 TRA     DOFI

      355     2125    2           END;
      356     2126    1       IF UWA.FR.SYN = 0 THEN

   2126 20 001121   000332 236000 18                 LDQ     UWA+218
        20 001122   001201 601000 20                 TNZ     s:2151

      357     2127    2       DO;

      358     2128    2           IF UWA.RC.PSMODE = 4 /* TEST FOR INDEXED */

   2128 20 001123   000271 235000 18                 LDA     UWA+185
        20 001124   000004 115007                    CMPA    4,DL
        20 001125   001167 601000 20                 TNZ     DONE_FR_CDS
        20 001126   000334 235000 18                 LDA     UWA+220
        20 001127   000003 115007                    CMPA    3,DL
        20 001130   001133 600000 20                 TZE     s:2128+8
        20 001131   000004 115007                    CMPA    4,DL
        20 001132   001167 601000 20                 TNZ     DONE_FR_CDS
        20 001133   000013 236000 0                  LDQ     MAP+1
        20 001134   000022 732000                    QRS     18
        20 001135   000002 506007                    DIV     2,DL
        20 001136   000044 733000                    LRS     36
        20 001137   000000 116003                    CMPQ    0,DU
        20 001140   001167 600000 20                 TZE     DONE_FR_CDS

      359     2129    2              AND (UWA.FR.FTYPE = 3 OR
      360     2130    2              UWA.FR.FTYPE = 4)
      361     2131    2              AND MOD(MAP.HBYTE,2) ~= 0 THEN
      362     2132    3           DO; /*POSSIBLE NIBBLE ALIGNMENT ON DECIMAL FIELD */

      363     2133    3   FIND_KEY:
      364     2134    4               DO WHILE ('1'B); /* DO FOREVER */

   2134 20 001141                       FIND_KEY     null
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:80   
      365     2135    4                   CALL FINDNS_6('FR-CFS  ') ALTRET(DONE_FR_CDS);

   2135 20 001141   000017 630400 21                 EPPR0   15
        20 001142   000002 631400 21                 EPPR1   2
        20 001143   000000 701000 xent               TSX1    FINDNS_6
        20 001144   001167 702000 20                 TSX2    DONE_FR_CDS

      366     2136    4                   CALL FINDOS_6('SMSS-CF ') ALTRET(ERROR1);

   2136 20 001145   000020 630400 21                 EPPR0   16
        20 001146   000002 631400 21                 EPPR1   2
        20 001147   000000 701000 xent               TSX1    FINDOS_6
        20 001150   002554 702000 20                 TSX2    ERROR1

      367     2137    4                   CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);

   2137 20 001151   000010 630400 21                 EPPR0   8
        20 001152   000002 631400 21                 EPPR1   2
        20 001153   000000 701000 xent               TSX1    FETCHOS_6
        20 001154   002554 702000 20                 TSX2    ERROR1

      368     2138    4                   IF UWA.SC.SETTYPE = 2 OR

   2138 20 001155   000310 235000 18                 LDA     UWA+200
        20 001156   000002 115007                    CMPA    2,DL
        20 001157   001162 600000 20                 TZE     s:2141
        20 001160   000003 115007                    CMPA    3,DL
        20 001161   001141 601000 20                 TNZ     FIND_KEY

      369     2139    4                      UWA.SC.SETTYPE = 3 THEN
      370     2140    5                   DO;

      371     2141    5                       CALL ALIGN(2);

   2141 20 001162   000022 236000 21                 LDQ     18
        20 001163   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001164   002041 701000 20                 TSX1    ALIGN
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:81   
        20 001165   000000 011000                    NOP     0

      372     2142    5                       EXIT FIND_KEY;

   2142 20 001166   001167 710000 20                 TRA     DONE_FR_CDS

      373     2143    5                       END /*SETTYPE 2 OR 3*/;
      374     2144    4                   END FIND_KEY;

      375     2145    3   DONE_FR_CDS:
      376     2146    3               END /* TEST FOR INDEXED */;

   2146 20 001167                       DONE_FR_CDS  null
      377     2147    2           CALL EISGEN;

   2147 20 001167   001602 701000 20                 TSX1    EISGEN
        20 001170   000000 011000                    NOP     0

      378     2148    2           CALL FCURR_R_6('FR  ') ALTRET(ERROR1);

   2148 20 001171   000023 630400 21                 EPPR0   19
        20 001172   000002 631400 21                 EPPR1   2
        20 001173   000000 701000 xent               TSX1    FCURR_R_6
        20 001174   002554 702000 20                 TSX2    ERROR1

      379     2149    2           CALL MODIFY_6('FR  ') ALTRET(ERROR1);

   2149 20 001175   000023 630400 21                 EPPR0   19
        20 001176   000002 631400 21                 EPPR1   2
        20 001177   000000 701000 xent               TSX1    MODIFY_6
        20 001200   002554 702000 20                 TSX2    ERROR1

      380     2150    2           END;

      381     2151    1       GOTO DOFI;

   2151 20 001201   001103 710000 20                 TRA     DOFI
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:82   

      382     2152    1   VARFR: /* MUST NOW ISSUE EIS DESCRIPTOR */
      383     2153         /* FOR CHAR VARYING */
      384     2154    1       IF VAR_FIELDS = 0 THEN

   2154 20 001202   200003 220100       VARFR        LDX0    VAR_FIELDS,,AUTO
        20 001203   001243 600000 20                 TZE     SETRC

      385     2155    1           GOTO SETRC;
      386     2156    1       CALL FETCHOS_6('RC-FR   ') ALTRET(ERROR1);

   2156 20 001204   000016 630400 21                 EPPR0   14
        20 001205   000002 631400 21                 EPPR1   2
        20 001206   000000 701000 xent               TSX1    FETCHOS_6
        20 001207   002554 702000 20                 TSX2    ERROR1

      387     2157    1   VARFR1:
      388     2158    1       CALL FETCHNS_6('RC-FR   ') ALTRET(SETRCA);

   2158 20 001210   000016 630400 21    VARFR1       EPPR0   14
        20 001211   000002 631400 21                 EPPR1   2
        20 001212   000000 701000 xent               TSX1    FETCHNS_6
        20 001213   001232 702000 20                 TSX2    SETRCA

      389     2159    1       IF UWA.FR.FTYPE = 19 THEN

   2159 20 001214   000334 235000 18                 LDA     UWA+220
        20 001215   000023 115007                    CMPA    19,DL
        20 001216   001231 601000 20                 TNZ     s:2165

      390     2160    2       DO; /* CHAR VARYING */

      391     2161    2           CALL EISGEN;

   2161 20 001217   001602 701000 20                 TSX1    EISGEN
        20 001220   000000 011000                    NOP     0

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:83   
      392     2162    2           CALL FCURR_R_6('FR  ') ALTRET(ERROR1);

   2162 20 001221   000023 630400 21                 EPPR0   19
        20 001222   000002 631400 21                 EPPR1   2
        20 001223   000000 701000 xent               TSX1    FCURR_R_6
        20 001224   002554 702000 20                 TSX2    ERROR1

      393     2163    2           CALL MODIFY_6('FR  ') ALTRET(ERROR1);

   2163 20 001225   000023 630400 21                 EPPR0   19
        20 001226   000002 631400 21                 EPPR1   2
        20 001227   000000 701000 xent               TSX1    MODIFY_6
        20 001230   002554 702000 20                 TSX2    ERROR1

      394     2164    2           END;

      395     2165    1       GOTO VARFR1;

   2165 20 001231   001210 710000 20                 TRA     VARFR1

      396     2166    1   SETRCA:
      397     2167    1       UWA.RC.CV_OFFSET = (4 * MAP.XWORD) + (MAP.HBYTE / 2);

   2167 20 001232   000013 236000 0     SETRCA       LDQ     MAP+1
        20 001233   000022 732000                    QRS     18
        20 001234   000002 506007                    DIV     2,DL
        20 001235   200036 756100                    STQ     @PREC+1,,AUTO
        20 001236   000012 236000 0                  LDQ     MAP
        20 001237   777777 376003                    ANQ     -1,DU
        20 001240   000020 732000                    QRS     16
        20 001241   200036 036100                    ADLQ    @PREC+1,,AUTO
        20 001242   000302 756000 18                 STQ     UWA+194

      398     2168    1   SETRC:
      399     2169    1       CALL ALIGN(2);

   2169 20 001243   000022 236000 21    SETRC        LDQ     18
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:84   
        20 001244   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001245   002041 701000 20                 TSX1    ALIGN
        20 001246   000000 011000                    NOP     0

      400     2170    1       UWA.RC.LSIZE = (4 * MAP.XWORD) + (MAP.HBYTE / 2) + CHARV_PREC;

   2170 20 001247   000013 236000 0                  LDQ     MAP+1
        20 001250   000022 732000                    QRS     18
        20 001251   000002 506007                    DIV     2,DL
        20 001252   200036 756100                    STQ     @PREC+1,,AUTO
        20 001253   000012 236000 0                  LDQ     MAP
        20 001254   777777 376003                    ANQ     -1,DU
        20 001255   000020 732000                    QRS     16
        20 001256   200036 036100                    ADLQ    @PREC+1,,AUTO
        20 001257   200030 036100                    ADLQ    CHARV_PREC,,AUTO
        20 001260   000306 756000 18                 STQ     UWA+198

      401     2171    1       CALL FCURR_R_6('RC  ') ALTRET(ERROR1);

   2171 20 001261   000024 630400 21                 EPPR0   20
        20 001262   000002 631400 21                 EPPR1   2
        20 001263   000000 701000 xent               TSX1    FCURR_R_6
        20 001264   002554 702000 20                 TSX2    ERROR1

      402     2172    1       CALL MODIFY_6('RC  ') ALTRET(ERROR1);

   2172 20 001265   000024 630400 21                 EPPR0   20
        20 001266   000002 631400 21                 EPPR1   2
        20 001267   000000 701000 xent               TSX1    MODIFY_6
        20 001270   002554 702000 20                 TSX2    ERROR1

      403     2173         /* CHECK IF RECORD WILL FIT ON PAGE */
      404     2174    1       IF UWA.RC.PSMODE = 4

   2174 20 001271   000271 235000 18                 LDA     UWA+185
        20 001272   000004 115007                    CMPA    4,DL
        20 001273   001447 600000 20                 TZE     SETRC0
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:85   

      405     2175    1       THEN GOTO SETRC0;
      406     2176        /*W*     INDEXED SKIP THE CHECK TO SEE IF WILL FIT IN A PAGE IT WILL */
      407     2177    1       X = 0;

   2177 20 001274   000007 450000 0                  STZ     X

      408     2178    1       CALL FETCHOS_6('RC-RA   ') ALTRET(ERROR1);

   2178 20 001275   000025 630400 21                 EPPR0   21
        20 001276   000002 631400 21                 EPPR1   2
        20 001277   000000 701000 xent               TSX1    FETCHOS_6
        20 001300   002554 702000 20                 TSX2    ERROR1

      409     2179    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);

   2179 20 001301   000011 630400 21                 EPPR0   9
        20 001302   000002 631400 21                 EPPR1   2
        20 001303   000000 701000 xent               TSX1    FETCHOS_6
        20 001304   002554 702000 20                 TSX2    ERROR1

      410     2180    1       IF UWA.SN.SENAME = '*CALC.RC' OR UWA.SN.SENAME = '*DBPARAM' OR UWA.SN.SENAME

   2180 20 001305   040000 106400                    CMPC    fill='040'O
        20 001306   000427 000036 18                 ADSC9   UWA+279                  cn=0,n=30
        20 001307   000027 000010 19                 ADSC9   23                       cn=0,n=8
        20 001310   001601 600000 20                 TZE     SETRC4
        20 001311   040000 106400                    CMPC    fill='040'O
        20 001312   000427 000036 18                 ADSC9   UWA+279                  cn=0,n=30
        20 001313   000031 000010 19                 ADSC9   25                       cn=0,n=8
        20 001314   001601 600000 20                 TZE     SETRC4
        20 001315   040000 106400                    CMPC    fill='040'O
        20 001316   000427 000036 18                 ADSC9   UWA+279                  cn=0,n=30
        20 001317   000033 000007 19                 ADSC9   27                       cn=0,n=7
        20 001320   001601 600000 20                 TZE     SETRC4

      411     2181    1          = '*SYSTEM' THEN
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:86   
      412     2182    1           GOTO SETRC4;
      413     2183    1   SETRC1B:
      414     2184    1       CALL FETCHNS_6('RC-RA   ') ALTRET(SETRC1A);

   2184 20 001321   000025 630400 21    SETRC1B      EPPR0   21
        20 001322   000002 631400 21                 EPPR1   2
        20 001323   000000 701000 xent               TSX1    FETCHNS_6
        20 001324   001344 702000 20                 TSX2    SETRC1A

      415     2185    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);

   2185 20 001325   000026 630400 21                 EPPR0   22
        20 001326   000002 631400 21                 EPPR1   2
        20 001327   000000 701000 xent               TSX1    FETCHOS_6
        20 001330   002554 702000 20                 TSX2    ERROR1

      416     2186    1       IF X = 0 THEN X = UWA.AC.SPACE_AVAIL;

   2186 20 001331   000007 235000 0                  LDA     X
        20 001332   001336 601000 20                 TNZ     s:2187

   2186 20 001333   000263 236000 18                 LDQ     UWA+179
        20 001334   000007 756000 0                  STQ     X
        20 001335   001343 710000 20                 TRA     s:2189

      417     2187    1       ELSE IF X > UWA.AC.SPACE_AVAIL THEN

   2187 20 001336   000007 236000 0                  LDQ     X
        20 001337   000263 116000 18                 CMPQ    UWA+179
        20 001340   001343 604400 20                 TMOZ    s:2189

      418     2188    1               X = UWA.AC.SPACE_AVAIL;

   2188 20 001341   000263 235000 18                 LDA     UWA+179
        20 001342   000007 755000 0                  STA     X

      419     2189    1       GOTO SETRC1B;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:87   

   2189 20 001343   001321 710000 20                 TRA     SETRC1B

      420     2190    1   SETRC1A:
      421     2191    1       IF VAR_FIELDS = 0 THEN

   2191 20 001344   200003 220100       SETRC1A      LDX0    VAR_FIELDS,,AUTO
        20 001345   001372 601000 20                 TNZ     s:2206

      422     2192    2       DO; /* NOT CHAR VARYING */

      423     2193    2           IF UWA.RC.LSIZE > X THEN

   2193 20 001346   000306 236000 18                 LDQ     UWA+198
        20 001347   000007 116000 0                  CMPQ    X
        20 001350   001441 604400 20                 TMOZ    s:2232

      424     2194    3           DO;

      425     2195    3               CALL FCURR_R_6('RC  ') ALTRET(ERROR1);

   2195 20 001351   000024 630400 21                 EPPR0   20
        20 001352   000002 631400 21                 EPPR1   2
        20 001353   000000 701000 xent               TSX1    FCURR_R_6
        20 001354   002554 702000 20                 TSX2    ERROR1

      426     2196    3               CALL CURRENCY(UWA.DIRECT_REF);

   2196 20 001355   000027 236000 21                 LDQ     23
        20 001356   200033 756100                    STQ     CHARV_PREC+3,,AUTO
        20 001357   002534 701000 20                 TSX1    CURRENCY
        20 001360   000000 011000                    NOP     0

      427     2197    3               CALL SET_FIELDS(1,30,UWA.SN.SENAME);

   2197 20 001361   000033 630400 21                 EPPR0   27
        20 001362   000030 631400 21                 EPPR1   24
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:88   
        20 001363   000000 701000 xent               TSX1    SET_FIELDS
        20 001364   000000 011000                    NOP     0

      428     2198    3               CALL WARNING(2401);

   2198 20 001365   000037 630400 21                 EPPR0   31
        20 001366   000002 631400 21                 EPPR1   2
        20 001367   000000 701000 xent               TSX1    WARNING
        20 001370   000000 011000                    NOP     0

      429     2199        /*E*     ERROR:    ZIG-ZIG_REC_GR_PG_SZ-C
      430     2200        MESSAGE: The record size of the record %U1 is larger than the page size.
      431     2201        */
      432     2202    3               END;

      433     2203    2           END;

   2203 20 001371   001441 710000 20                 TRA     s:2232

      434     2204    1       ELSE /* CHAR VARYING */
      435     2205    2       DO;

      436     2206    2           IF UWA.RC.LSIZE > X THEN

   2206 20 001372   000306 236000 18                 LDQ     UWA+198
        20 001373   000007 116000 0                  CMPQ    X
        20 001374   001415 604400 20                 TMOZ    s:2217

      437     2207    3           DO;

      438     2208    3               CALL FCURR_R_6('RC  ') ALTRET(ERROR1);

   2208 20 001375   000024 630400 21                 EPPR0   20
        20 001376   000002 631400 21                 EPPR1   2
        20 001377   000000 701000 xent               TSX1    FCURR_R_6
        20 001400   002554 702000 20                 TSX2    ERROR1

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:89   
      439     2209    3               CALL CURRENCY(UWA.DIRECT_REF);

   2209 20 001401   000027 236000 21                 LDQ     23
        20 001402   200033 756100                    STQ     CHARV_PREC+3,,AUTO
        20 001403   002534 701000 20                 TSX1    CURRENCY
        20 001404   000000 011000                    NOP     0

      440     2210    3               CALL SET_FIELDS(1,30,UWA.SN.SENAME);

   2210 20 001405   000033 630400 21                 EPPR0   27
        20 001406   000030 631400 21                 EPPR1   24
        20 001407   000000 701000 xent               TSX1    SET_FIELDS
        20 001410   000000 011000                    NOP     0

      441     2211    3               CALL WARNING(2402);

   2211 20 001411   000041 630400 21                 EPPR0   33
        20 001412   000002 631400 21                 EPPR1   2
        20 001413   000000 701000 xent               TSX1    WARNING
        20 001414   000000 011000                    NOP     0

      442     2212        /*E*     ERROR:    ZIG-ZIG_MAX_REC_GR_PG_SZ-C
      443     2213        MESSAGE: The maximum record size of the record %U1 is larger than the
      444     2214                 page size.
      445     2215        */
      446     2216    3               END;

      447     2217    2           IF UWA.RC.LSIZE - CHARV_PREC > X THEN

   2217 20 001415   000306 236000 18                 LDQ     UWA+198
        20 001416   200030 136100                    SBLQ    CHARV_PREC,,AUTO
        20 001417   000007 116000 0                  CMPQ    X
        20 001420   001441 604400 20                 TMOZ    s:2232

      448     2218    3           DO;

      449     2219    3               CALL FCURR_R_6('RC  ') ALTRET(ERROR1);
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:90   

   2219 20 001421   000024 630400 21                 EPPR0   20
        20 001422   000002 631400 21                 EPPR1   2
        20 001423   000000 701000 xent               TSX1    FCURR_R_6
        20 001424   002554 702000 20                 TSX2    ERROR1

      450     2220    3               CALL CURRENCY(UWA.DIRECT_REF);

   2220 20 001425   000027 236000 21                 LDQ     23
        20 001426   200033 756100                    STQ     CHARV_PREC+3,,AUTO
        20 001427   002534 701000 20                 TSX1    CURRENCY
        20 001430   000000 011000                    NOP     0

      451     2221    3               CALL SET_FIELDS(1,30,UWA.SN.SENAME);

   2221 20 001431   000033 630400 21                 EPPR0   27
        20 001432   000030 631400 21                 EPPR1   24
        20 001433   000000 701000 xent               TSX1    SET_FIELDS
        20 001434   000000 011000                    NOP     0

      452     2222    3               CALL WARNING(2403);

   2222 20 001435   000043 630400 21                 EPPR0   35
        20 001436   000002 631400 21                 EPPR1   2
        20 001437   000000 701000 xent               TSX1    WARNING
        20 001440   000000 011000                    NOP     0

      453     2223        /*E*     ERROR:    ZIG-ZIG_MIN_REC_GR_PG_SZ-C
      454     2224        MESSAGE: The minimum record size of the record %U1 is larger than the
      455     2225                 page size.
      456     2226        */
      457     2227    3               END;

      458     2228    2           END;

      459     2229         /* IF THIS RECORD HAS A KEYNAME, THEN WE MUST
      460     2230            BUILD PROCESS AREA EIS DESCRIPTOR IN SYNONYM
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:91   
      461     2231            CF RECORD */
      462     2232    1       IF UWA.RC.KEY_PRESENT ~= 0 OR UWA.RC.PSMODE = 4 THEN

   2232 20 001441   000301 235000 18                 LDA     UWA+193
        20 001442   001447 601000 20                 TNZ     SETRC0
        20 001443   000271 236000 18                 LDQ     UWA+185
        20 001444   000004 116007                    CMPQ    4,DL
        20 001445   001447 600000 20                 TZE     SETRC0

      463     2233    1           GOTO SETRC0;
      464     2234    1       GOTO SETRC4;

   2234 20 001446   001601 710000 20                 TRA     SETRC4

      465     2235    1   SETRC0:
      466     2236    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   2236 20 001447   000005 630400 21    SETRC0       EPPR0   5
        20 001450   000002 631400 21                 EPPR1   2
        20 001451   000000 701000 xent               TSX1    FETCHOS_6
        20 001452   002554 702000 20                 TSX2    ERROR1

      467     2237    1   SETRC1:
      468     2238    1       IF UWA.RC.PSMODE ~=4

   2238 20 001453   000271 235000 18    SETRC1       LDA     UWA+185
        20 001454   000004 115007                    CMPA    4,DL
        20 001455   001463 600000 20                 TZE     s:2244

      469     2239    2       THEN DO;

      470     2240    2           MAP.XWORD = 0;

   2240 20 001456   000000 220003                    LDX0    0,DU
        20 001457   000012 740000 0                  STX0    MAP

      471     2241    2           MAP.HBYTE = 6;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:92   

   2241 20 001460   000006 221003                    LDX1    6,DU
        20 001461   000013 741000 0                  STX1    MAP+1

      472     2242    2           END;

   2242 20 001462   001467 710000 20                 TRA     s:2247

      473     2243    2       ELSE DO;

      474     2244    2           MAP.XWORD = 0;

   2244 20 001463   000000 220003                    LDX0    0,DU
        20 001464   000012 740000 0                  STX0    MAP

      475     2245    2           MAP.HBYTE = 2;

   2245 20 001465   000002 221003                    LDX1    2,DU
        20 001466   000013 741000 0                  STX1    MAP+1

      476     2246    2           END;

      477     2247    1       CALL FETCHNS_6('RC-SOSM ') ALTRET(SETRC4);

   2247 20 001467   000005 630400 21                 EPPR0   5
        20 001470   000002 631400 21                 EPPR1   2
        20 001471   000000 701000 xent               TSX1    FETCHNS_6
        20 001472   001601 702000 20                 TSX2    SETRC4

      478     2248    1       IF UWA.RECORD_NAME = 'SO' THEN

   2248 20 001473   040000 106400                    CMPC    fill='040'O
        20 001474   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 001475   000014 000002 19                 ADSC9   12                       cn=0,n=2
        20 001476   001453 600000 20                 TZE     SETRC1

      479     2249    1           GOTO SETRC1;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:93   
      480     2250    1   SETRC2:
      481     2251    1       CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1); /* GET SC */

   2251 20 001477   000010 630400 21    SETRC2       EPPR0   8
        20 001500   000002 631400 21                 EPPR1   2
        20 001501   000000 701000 xent               TSX1    FETCHOS_6
        20 001502   002554 702000 20                 TSX2    ERROR1

      482     2252    1       IF UWA.SC.SETTYPE = 2 OR UWA.SC.SETTYPE = 3 THEN

   2252 20 001503   000310 235000 18                 LDA     UWA+200
        20 001504   000002 115007                    CMPA    2,DL
        20 001505   001510 600000 20                 TZE     SETRC21
        20 001506   000003 115007                    CMPA    3,DL
        20 001507   001600 601000 20                 TNZ     s:2276

      483     2253    2       DO;

      484     2254    2   SETRC21:
      485     2255    2           CALL FETCHNS_6('SMSS-CF ') ALTRET(SETRC4);

   2255 20 001510   000020 630400 21    SETRC21      EPPR0   16
        20 001511   000002 631400 21                 EPPR1   2
        20 001512   000000 701000 xent               TSX1    FETCHNS_6
        20 001513   001601 702000 20                 TSX2    SETRC4

      486     2256    2           IF UWA.C_F.SYN = 0 THEN

   2256 20 001514   000400 235000 18                 LDA     UWA+256
        20 001515   001510 600000 20                 TZE     SETRC21

      487     2257    2               GOTO SETRC21; /* NOT SYNONYM */
      488     2258    2           CALL FETCHOS_6('FR-CFS  ') ALTRET(ERROR1);

   2258 20 001516   000017 630400 21                 EPPR0   15
        20 001517   000002 631400 21                 EPPR1   2
        20 001520   000000 701000 xent               TSX1    FETCHOS_6
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:94   
        20 001521   002554 702000 20                 TSX2    ERROR1

      489     2259    2           CALL EISGEN;

   2259 20 001522   001602 701000 20                 TSX1    EISGEN
        20 001523   000000 011000                    NOP     0

      490     2260    2           IF UWA.FR.FTYPE = 0 OR

   2260 20 001524   000334 235000 18                 LDA     UWA+220
        20 001525   001532 600000 20                 TZE     s:2263
        20 001526   000001 115007                    CMPA    1,DL
        20 001527   001532 600000 20                 TZE     s:2263
        20 001530   000013 115007                    CMPA    11,DL
        20 001531   001534 601000 20                 TNZ     s:2264

      491     2261    2              UWA.FR.FTYPE = 1 OR
      492     2262    2              UWA.FR.FTYPE = 11 THEN
      493     2263    2               UWA.SC.KEY_LENGTH = 4;

   2263 20 001532   000004 236007                    LDQ     4,DL
        20 001533   000324 756000 18                 STQ     UWA+212

      494     2264    2           IF UWA.FR.FTYPE = 12 THEN

   2264 20 001534   000014 115007                    CMPA    12,DL
        20 001535   001540 601000 20                 TNZ     s:2266

      495     2265    2               UWA.SC.KEY_LENGTH = 8;

   2265 20 001536   000010 236007                    LDQ     8,DL
        20 001537   000324 756000 18                 STQ     UWA+212

      496     2266    2           IF UWA.FR.FTYPE = 2 THEN

   2266 20 001540   000002 115007                    CMPA    2,DL
        20 001541   001544 601000 20                 TNZ     s:2268
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:95   

      497     2267    2               UWA.SC.KEY_LENGTH = 2;

   2267 20 001542   000002 236007                    LDQ     2,DL
        20 001543   000324 756000 18                 STQ     UWA+212

      498     2268    2           IF UWA.FR.FTYPE = 3 OR UWA.FR.FTYPE = 4 THEN

   2268 20 001544   000003 115007                    CMPA    3,DL
        20 001545   001550 600000 20                 TZE     s:2269
        20 001546   000004 115007                    CMPA    4,DL
        20 001547   001555 601000 20                 TNZ     s:2270

      499     2269    2               UWA.SC.KEY_LENGTH = (UWA.FR.PREC + UWA.FR.F_SIGN + 1)/2;

   2269 20 001550   000335 236000 18                 LDQ     UWA+221
        20 001551   000337 036000 18                 ADLQ    UWA+223
        20 001552   000001 036007                    ADLQ    1,DL
        20 001553   000002 506007                    DIV     2,DL
        20 001554   000324 756000 18                 STQ     UWA+212

      500     2270    2           IF UWA.FR.FTYPE = 5 OR UWA.FR.FTYPE = 9 THEN

   2270 20 001555   000334 235000 18                 LDA     UWA+220
        20 001556   000005 115007                    CMPA    5,DL
        20 001557   001562 600000 20                 TZE     s:2271
        20 001560   000011 115007                    CMPA    9,DL
        20 001561   001564 601000 20                 TNZ     s:2272

      501     2271    2               UWA.SC.KEY_LENGTH = UWA.FR.PREC;

   2271 20 001562   000335 236000 18                 LDQ     UWA+221
        20 001563   000324 756000 18                 STQ     UWA+212

      502     2272    2           CALL MODIFY_6('FR  ') ALTRET(ERROR1);

   2272 20 001564   000023 630400 21                 EPPR0   19
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:96   
        20 001565   000002 631400 21                 EPPR1   2
        20 001566   000000 701000 xent               TSX1    MODIFY_6
        20 001567   002554 702000 20                 TSX2    ERROR1

      503     2273    2           CALL FCURR_R_6('SC  ') ALTRET(ERROR1);

   2273 20 001570   000044 630400 21                 EPPR0   36
        20 001571   000002 631400 21                 EPPR1   2
        20 001572   000000 701000 xent               TSX1    FCURR_R_6
        20 001573   002554 702000 20                 TSX2    ERROR1

      504     2274    2           CALL MODIFY_6('SC  ') ALTRET(ERROR1);

   2274 20 001574   000044 630400 21                 EPPR0   36
        20 001575   000002 631400 21                 EPPR1   2
        20 001576   000000 701000 xent               TSX1    MODIFY_6
        20 001577   002554 702000 20                 TSX2    ERROR1

      505     2275    2           END;

      506     2276    1       GOTO SETRC1;

   2276 20 001600   001453 710000 20                 TRA     SETRC1

      507     2277    1   SETRC4:
      508     2278    1       GOTO DOSETRC;

   2278 20 001601   000153 710000 20    SETRC4       TRA     DOSETRC

      509     2279         /* GENERATE AN EIS DESRIPTOR */
      510     2280    1   EISGEN:

   2280 20 001602   200032 741300       EISGEN       STX1  ! CHARV_PREC+2,,AUTO

      511     2281    1       PROC;
      512     2282    2       UWA.FR.BEIST=0; /* SET EIS DIS. TYPE TO ADSC9 */

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:97   
   2282 20 001603   000350 450000 18                 STZ     UWA+232

      513     2283    2       IF UWA.FR.FTYPE = 0 OR UWA.FR.FTYPE = 19 THEN /* DBK, CHAR VAR */

   2283 20 001604   000334 235000 18                 LDA     UWA+220
        20 001605   001610 600000 20                 TZE     s:2285
        20 001606   000023 115007                    CMPA    19,DL
        20 001607   001631 601000 20                 TNZ     s:2292

      514     2284    3       DO;

      515     2285    3           CALL ALIGN(2); /* GET ON BYTE BOUNDARY */

   2285 20 001610   000022 236000 21                 LDQ     18
        20 001611   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001612   002041 701000 20                 TSX1    ALIGN
        20 001613   000000 011000                    NOP     0

      516     2286    3           CALL SETEIS; /* SET EIS DESCRIPTOR */

   2286 20 001614   002112 701000 20                 TSX1    SETEIS
        20 001615   000000 011000                    NOP     0

      517     2287    3           XEIS.PREC = '000000000100'B;

   2287 20 001616   000004 236007                    LDQ     4,DL
        20 001617   000010 752003 0                  STCQ    XEIS,'03'O

      518     2288    3           CALL ALLOCATE(8); /* ALLOCATE 4 BYTES */

   2288 20 001620   000046 236000 21                 LDQ     38
        20 001621   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001622   002067 701000 20                 TSX1    ALLOCATE
        20 001623   000000 011000                    NOP     0

      519     2289    3           UWA.FR.BUFFLOC = EISF; /* PUT EIS DESCRIPTOR IN FIXED */

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:98   
   2289 20 001624   200012 470500                    LDP0    EISF$,,AUTO
        20 001625   000000 235100                    LDA     0,,PR0
        20 001626   000351 755000 18                 STA     UWA+233

      520     2290    3           RETURN;

   2290 20 001627   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 001630   000001 702211                    TSX2  ! 1,X1

      521     2291    3           END;
      522     2292    2       IF UWA.FR.FTYPE = 1 THEN /* 36 BIT BINARY */

   2292 20 001631   000001 115007                    CMPA    1,DL
        20 001632   001654 601000 20                 TNZ     s:2301

      523     2293    3       DO;

      524     2294    3           CALL ALIGN(2); /* ALIGN ON BYTE BOUNDARY */

   2294 20 001633   000022 236000 21                 LDQ     18
        20 001634   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001635   002041 701000 20                 TSX1    ALIGN
        20 001636   000000 011000                    NOP     0

      525     2295    3           CALL SETEIS;

   2295 20 001637   002112 701000 20                 TSX1    SETEIS
        20 001640   000000 011000                    NOP     0

      526     2296    3           XEIS.PREC = '000000000100'B;

   2296 20 001641   000004 236007                    LDQ     4,DL
        20 001642   000010 752003 0                  STCQ    XEIS,'03'O

      527     2297    3           CALL ALLOCATE(8); /* ALLOCATE 4 BYTES */

   2297 20 001643   000046 236000 21                 LDQ     38
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:99   
        20 001644   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001645   002067 701000 20                 TSX1    ALLOCATE
        20 001646   000000 011000                    NOP     0

      528     2298    3           UWA.FR.BUFFLOC = EISF; /* PUT IN FIXED FORMAT */

   2298 20 001647   200012 470500                    LDP0    EISF$,,AUTO
        20 001650   000000 235100                    LDA     0,,PR0
        20 001651   000351 755000 18                 STA     UWA+233

      529     2299    3           RETURN;

   2299 20 001652   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 001653   000001 702211                    TSX2  ! 1,X1

      530     2300    3           END;
      531     2301    2       IF UWA.FR.FTYPE = 2 THEN /* 18 BIT BINARY */

   2301 20 001654   000002 115007                    CMPA    2,DL
        20 001655   001677 601000 20                 TNZ     s:2310

      532     2302    3       DO;

      533     2303    3           CALL ALIGN(2);

   2303 20 001656   000022 236000 21                 LDQ     18
        20 001657   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001660   002041 701000 20                 TSX1    ALIGN
        20 001661   000000 011000                    NOP     0

      534     2304    3           CALL SETEIS;

   2304 20 001662   002112 701000 20                 TSX1    SETEIS
        20 001663   000000 011000                    NOP     0

      535     2305    3           XEIS.PREC = '000000000010'B;

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:100  
   2305 20 001664   000002 236007                    LDQ     2,DL
        20 001665   000010 752003 0                  STCQ    XEIS,'03'O

      536     2306    3           CALL ALLOCATE(4); /* ALLOCATE 2 BYTES */

   2306 20 001666   000050 236000 21                 LDQ     40
        20 001667   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001670   002067 701000 20                 TSX1    ALLOCATE
        20 001671   000000 011000                    NOP     0

      537     2307    3           UWA.FR.BUFFLOC = EISF; /* PUT IN FIXED FORMAT */

   2307 20 001672   200012 470500                    LDP0    EISF$,,AUTO
        20 001673   000000 235100                    LDA     0,,PR0
        20 001674   000351 755000 18                 STA     UWA+233

      538     2308    3           RETURN;

   2308 20 001675   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 001676   000001 702211                    TSX2  ! 1,X1

      539     2309    3           END;
      540     2310    2       IF UWA.FR.FTYPE = 3 THEN /* UNSIGNED PACKED DECIMAL */

   2310 20 001677   000003 115007                    CMPA    3,DL
        20 001700   001716 601000 20                 TNZ     s:2318

      541     2311    3       DO;

      542     2312    3           CALL SETEIS1;

   2312 20 001701   002136 701000 20                 TSX1    SETEIS1
        20 001702   000000 011000                    NOP     0

      543     2313    3           CALL ALLOCATE(UWA.FR.PREC);

   2313 20 001703   000051 236000 21                 LDQ     41
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:101  
        20 001704   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001705   002067 701000 20                 TSX1    ALLOCATE
        20 001706   000000 011000                    NOP     0

      544     2314    3           UWA.FR.BUFFLOC = EISD;

   2314 20 001707   200013 470500                    LDP0    EISD$,,AUTO
        20 001710   000000 235100                    LDA     0,,PR0
        20 001711   000351 755000 18                 STA     UWA+233

      545     2315    3           UWA.FR.BEIST=1; /* SET EIS DIS. TYPE TO NUMERIC */

   2315 20 001712   000001 236007                    LDQ     1,DL
        20 001713   000350 756000 18                 STQ     UWA+232

      546     2316    3           RETURN;

   2316 20 001714   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 001715   000001 702211                    TSX2  ! 1,X1

      547     2317    3           END;
      548     2318    2       IF UWA.FR.FTYPE = 4 THEN /* SIGNED PACKED DECIMAL */

   2318 20 001716   000004 115007                    CMPA    4,DL
        20 001717   001740 601000 20                 TNZ     s:2328

      549     2319    3       DO;

      550     2320    3           UWA.FR.PREC = UWA.FR.PREC + 1; /* ADD HALF BYTE FOR SIGN */

   2320 20 001720   000335 054000 18                 AOS     UWA+221

      551     2321    3           CALL SETEIS1;

   2321 20 001721   002136 701000 20                 TSX1    SETEIS1
        20 001722   000000 011000                    NOP     0

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:102  
      552     2322    3           CALL ALLOCATE(UWA.FR.PREC);

   2322 20 001723   000051 236000 21                 LDQ     41
        20 001724   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001725   002067 701000 20                 TSX1    ALLOCATE
        20 001726   000000 011000                    NOP     0

      553     2323    3           UWA.FR.PREC = UWA.FR.PREC - 1;

   2323 20 001727   000001 336007                    LCQ     1,DL
        20 001730   000335 056000 18                 ASQ     UWA+221

      554     2324    3           UWA.FR.BUFFLOC = EISD;

   2324 20 001731   200013 470500                    LDP0    EISD$,,AUTO
        20 001732   000000 235100                    LDA     0,,PR0
        20 001733   000351 755000 18                 STA     UWA+233

      555     2325    3           UWA.FR.BEIST=1; /* SET EIS DIS. TYPE TO NUMERIC */

   2325 20 001734   000001 235007                    LDA     1,DL
        20 001735   000350 755000 18                 STA     UWA+232

      556     2326    3           RETURN;

   2326 20 001736   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 001737   000001 702211                    TSX2  ! 1,X1

      557     2327    3           END;
      558     2328    2       IF UWA.FR.FTYPE = 5 OR UWA.FR.FTYPE = 9 THEN /* ASCII CHAR */

   2328 20 001740   000005 115007                    CMPA    5,DL
        20 001741   001744 600000 20                 TZE     s:2330
        20 001742   000011 115007                    CMPA    9,DL
        20 001743   001766 601000 20                 TNZ     s:2336

      559     2329    3       DO;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:103  

      560     2330    3           CALL ALIGN(2); /* ALIGN ON BYTE BOUNDARY */

   2330 20 001744   000022 236000 21                 LDQ     18
        20 001745   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001746   002041 701000 20                 TSX1    ALIGN
        20 001747   000000 011000                    NOP     0

      561     2331    3           CALL SETEIS;

   2331 20 001750   002112 701000 20                 TSX1    SETEIS
        20 001751   000000 011000                    NOP     0

      562     2332    3           CALL ALLOCATE(UWA.FR.PREC * 2);

   2332 20 001752   000335 235000 18                 LDA     UWA+221
        20 001753   000001 735000                    ALS     1
        20 001754   200043 755100                    STA     @PREC+6,,AUTO
        20 001755   200043 630500                    EPPR0   @PREC+6,,AUTO
        20 001756   200035 450500                    STP0    @DBK_C+2,,AUTO
        20 001757   002067 701000 20                 TSX1    ALLOCATE
        20 001760   000000 011000                    NOP     0

      563     2333    3           UWA.FR.BUFFLOC = EISF;

   2333 20 001761   200012 470500                    LDP0    EISF$,,AUTO
        20 001762   000000 235100                    LDA     0,,PR0
        20 001763   000351 755000 18                 STA     UWA+233

      564     2334    3           RETURN;

   2334 20 001764   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 001765   000001 702211                    TSX2  ! 1,X1

      565     2335    3           END;
      566     2336    2       IF UWA.FR.FTYPE = 11 THEN /* SINGLE PREC. FLT. BIN */

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:104  
   2336 20 001766   000013 115007                    CMPA    11,DL
        20 001767   002011 601000 20                 TNZ     s:2345

      567     2337    3       DO;

      568     2338    3           CALL ALIGN(2);

   2338 20 001770   000022 236000 21                 LDQ     18
        20 001771   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 001772   002041 701000 20                 TSX1    ALIGN
        20 001773   000000 011000                    NOP     0

      569     2339    3           CALL SETEIS;

   2339 20 001774   002112 701000 20                 TSX1    SETEIS
        20 001775   000000 011000                    NOP     0

      570     2340    3           XEIS.PREC = '000000000100'B;

   2340 20 001776   000004 236007                    LDQ     4,DL
        20 001777   000010 752003 0                  STCQ    XEIS,'03'O

      571     2341    3           UWA.FR.BUFFLOC = EISF;

   2341 20 002000   200012 470500                    LDP0    EISF$,,AUTO
        20 002001   000000 235100                    LDA     0,,PR0
        20 002002   000351 755000 18                 STA     UWA+233

      572     2342    3           CALL ALLOCATE(8);

   2342 20 002003   000046 236000 21                 LDQ     38
        20 002004   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 002005   002067 701000 20                 TSX1    ALLOCATE
        20 002006   000000 011000                    NOP     0

      573     2343    3           RETURN;

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:105  
   2343 20 002007   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 002010   000001 702211                    TSX2  ! 1,X1

      574     2344    3           END;
      575     2345    2       IF UWA.FR.FTYPE = 12 THEN /* DOUBLE PREC. FLT. BIN */

   2345 20 002011   000014 115007                    CMPA    12,DL
        20 002012   002034 601000 20                 TNZ     s:2354

      576     2346    3       DO;

      577     2347    3           CALL ALIGN(2);

   2347 20 002013   000022 236000 21                 LDQ     18
        20 002014   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 002015   002041 701000 20                 TSX1    ALIGN
        20 002016   000000 011000                    NOP     0

      578     2348    3           CALL SETEIS;

   2348 20 002017   002112 701000 20                 TSX1    SETEIS
        20 002020   000000 011000                    NOP     0

      579     2349    3           XEIS.PREC = '000000001000'B;

   2349 20 002021   000010 236007                    LDQ     8,DL
        20 002022   000010 752003 0                  STCQ    XEIS,'03'O

      580     2350    3           UWA.FR.BUFFLOC = EISF;

   2350 20 002023   200012 470500                    LDP0    EISF$,,AUTO
        20 002024   000000 235100                    LDA     0,,PR0
        20 002025   000351 755000 18                 STA     UWA+233

      581     2351    3           CALL ALLOCATE(16);

   2351 20 002026   000053 236000 21                 LDQ     43
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:106  
        20 002027   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 002030   002067 701000 20                 TSX1    ALLOCATE
        20 002031   000000 011000                    NOP     0

      582     2352    3           RETURN;

   2352 20 002032   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 002033   000001 702211                    TSX2  ! 1,X1

      583     2353    3           END;
      584     2354    2       CALL ABORT; /* SOFTWARE ERROR */

   2354 20 002034   000054 631400 21                 EPPR1   44
        20 002035   000000 701000 xent               TSX1    ABORT
        20 002036   000000 011000                    NOP     0

      585     2355    2   END EISGEN;

   2355 20 002037   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 002040   000001 702211                    TSX2  ! 1,X1

      586     2356         /* ALIGN ON A BYTE (BNDRY=2) BOUNDARY */
      587     2357    1   ALIGN:

   2357 20 002041   200034 741300       ALIGN        STX1  ! @DBK_C+1,,AUTO

      588     2358    1       PROC(BNDRY);
      589     2359    2   DCL BNDRY SBIN (36);
      590     2360    3       DO WHILE(MOD(MAP.HBYTE, BNDRY) ~= 0);

   2360 20 002042   002046 710000 20                 TRA     s:2362

      591     2361    3           MAP.HBYTE = MAP.HBYTE + 1;

   2361 20 002043   000013 220000 0                  LDX0    MAP+1
        20 002044   000001 621010                    EAX1    1,X0
        20 002045   000013 741000 0                  STX1    MAP+1
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:107  

      592     2362    3           END;

   2362 20 002046   200035 470500                    LDP0    @BNDRY,,AUTO
        20 002047   000013 236000 0                  LDQ     MAP+1
        20 002050   000022 732000                    QRS     18
        20 002051   000000 506100                    DIV     0,,PR0
        20 002052   000044 733000                    LRS     36
        20 002053   000000 116003                    CMPQ    0,DU
        20 002054   002043 601000 20                 TNZ     s:2361

      593     2363    2       IF MAP.HBYTE = 8 THEN

   2363 20 002055   000013 220000 0                  LDX0    MAP+1
        20 002056   000010 100003                    CMPX0   8,DU
        20 002057   002065 601000 20                 TNZ     s:2368

      594     2364    3       DO;

      595     2365    3           MAP.HBYTE = 0;

   2365 20 002060   000000 221003                    LDX1    0,DU
        20 002061   000013 741000 0                  STX1    MAP+1

      596     2366    3           MAP.XWORD = MAP.XWORD + 1;

   2366 20 002062   000012 220000 0                  LDX0    MAP
        20 002063   000001 622010                    EAX2    1,X0
        20 002064   000012 742000 0                  STX2    MAP

      597     2367    3           END;

      598     2368    2   END ALIGN;

   2368 20 002065   200034 221300                    LDX1  ! @DBK_C+1,,AUTO
        20 002066   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:108  
      599     2369         /* ALLOCATE PREC NUMBER OF HALF BYTES */
      600     2370    1   ALLOCATE:

   2370 20 002067   200034 741300       ALLOCATE     STX1  ! @DBK_C+1,,AUTO

      601     2371    1       PROC(PREC);
      602     2372    2   DCL PREC SBIN(36);
      603     2373    2       MAP.HBYTE = MAP.HBYTE + PREC;

   2373 20 002070   200035 470500                    LDP0    @PREC,,AUTO
        20 002071   000013 236000 0                  LDQ     MAP+1
        20 002072   000022 732000                    QRS     18
        20 002073   000000 036100                    ADLQ    0,,PR0
        20 002074   000000 620006                    EAX0    0,QL
        20 002075   000013 740000 0                  STX0    MAP+1

      604     2374    3       DO WHILE(MAP.HBYTE > 7);

   2374 20 002076   000007 100003                    CMPX0   7,DU
        20 002077   002110 604400 20                 TMOZ    s:2378

      605     2375    3           MAP.HBYTE = MAP.HBYTE - 8;

   2375 20 002100   000013 220000 0                  LDX0    MAP+1
        20 002101   777770 621010                    EAX1    -8,X0
        20 002102   000013 741000 0                  STX1    MAP+1

      606     2376    3           MAP.XWORD = MAP.XWORD + 1;

   2376 20 002103   000012 220000 0                  LDX0    MAP
        20 002104   000001 622010                    EAX2    1,X0
        20 002105   000012 742000 0                  STX2    MAP

      607     2377    3           END;

   2377 20 002106   000007 101003                    CMPX1   7,DU
        20 002107   002100 605400 20                 TPNZ    s:2375
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:109  

      608     2378    2   END ALLOCATE;

   2378 20 002110   200034 221300                    LDX1  ! @DBK_C+1,,AUTO
        20 002111   000001 702211                    TSX2  ! 1,X1

      609     2379    1   SETEIS:

   2379 20 002112   200034 741300       SETEIS       STX1  ! @DBK_C+1,,AUTO

      610     2380    1       PROC;
      611     2381    2       XEIS.BWRD = BINBIT(MAP.XWORD, 15);

   2381 20 002113   000012 236000 0                  LDQ     MAP
        20 002114   000022 732000                    QRS     18
        20 002115   000025 736000                    QLS     21
        20 002116   000003 772000                    QRL     3
        20 002117   000010 676000 0                  ERQ     XEIS
        20 002120   077777 376003                    ANQ     32767,DU
        20 002121   000010 656000 0                  ERSQ    XEIS

      612     2382    2       XEIS.BCHR = BINBIT(MAP.HBYTE, 3);

   2382 20 002122   000013 236000 0                  LDQ     MAP+1
        20 002123   000022 732000                    QRS     18
        20 002124   000041 736000                    QLS     33
        20 002125   000022 772000                    QRL     18
        20 002126   000010 676000 0                  ERQ     XEIS
        20 002127   700000 376007                    ANQ     -32768,DL
        20 002130   000010 656000 0                  ERSQ    XEIS

      613     2383    2       XEIS.PREC = BINBIT(UWA.FR.PREC, 12);

   2383 20 002131   000335 236000 18                 LDQ     UWA+221
        20 002132   000030 736000                    QLS     24
        20 002133   000030 772000                    QRL     24
        20 002134   000010 752003 0                  STCQ    XEIS,'03'O
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:110  

      614     2384    2   END SETEIS;

   2384 20 002135   000001 702211                    TSX2  ! 1,X1

      615     2385    1   SETEIS1:

   2385 20 002136   200034 741300       SETEIS1      STX1  ! @DBK_C+1,,AUTO

      616     2386    1       PROC;
      617     2387    2       EIS1.BWRD = BINBIT(MAP.XWORD, 15);

   2387 20 002137   000012 236000 0                  LDQ     MAP
        20 002140   000022 732000                    QRS     18
        20 002141   000025 736000                    QLS     21
        20 002142   000003 772000                    QRL     3
        20 002143   000011 676000 0                  ERQ     EIS1
        20 002144   077777 376003                    ANQ     32767,DU
        20 002145   000011 656000 0                  ERSQ    EIS1

      618     2388    2       EIS1.BCHR = BINBIT(MAP.HBYTE, 3);

   2388 20 002146   000013 236000 0                  LDQ     MAP+1
        20 002147   000022 732000                    QRS     18
        20 002150   000041 736000                    QLS     33
        20 002151   000022 772000                    QRL     18
        20 002152   000011 676000 0                  ERQ     EIS1
        20 002153   700000 376007                    ANQ     -32768,DL
        20 002154   000011 656000 0                  ERSQ    EIS1

      619     2389    2       IF UWA.FR.F_SIGN = 1 THEN

   2389 20 002155   000337 235000 18                 LDA     UWA+223
        20 002156   000001 115007                    CMPA    1,DL
        20 002157   002165 601000 20                 TNZ     s:2392

      620     2390    2           EIS1.SIGN = '10'B; /* SIGN SPECIFIED */
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:111  

   2390 20 002160   000011 236000 0                  LDQ     EIS1
        20 002161   000055 376000 21                 ANQ     45
        20 002162   020000 276007                    ORQ     8192,DL
        20 002163   000011 756000 0                  STQ     EIS1
        20 002164   002167 710000 20                 TRA     s:2393

      621     2391    2       ELSE
      622     2392    2           EIS1.SIGN = '11'B;

   2392 20 002165   030000 236007                    LDQ     12288,DL
        20 002166   000011 256000 0                  ORSQ    EIS1

      623     2393    2       EIS1.SCALE = BINBIT(-1 * UWA.FR.SCALE, 6);

   2393 20 002167   000336 336000 18                 LCQ     UWA+222
        20 002170   000036 736000                    QLS     30
        20 002171   000030 772000                    QRL     24
        20 002172   000011 752002 0                  STCQ    EIS1,'02'O

      624     2394    2       EIS1.PREC = BINBIT(UWA.FR.PREC, 6);

   2394 20 002173   000335 236000 18                 LDQ     UWA+221
        20 002174   000036 736000                    QLS     30
        20 002175   000036 772000                    QRL     30
        20 002176   000011 752001 0                  STCQ    EIS1,'01'O

      625     2395    2   END SETEIS1;

   2395 20 002177   000001 702211                    TSX2  ! 1,X1

      626     2396         /* ALL SET OCCURRENCES OF RC HAVE BEEN PROCESSED */
      627     2397         /* CONTROL COMES HERE AFTER ALL FR, SO, SM HAVE
      628     2398            EIS DESCRIPTORS FOR THIS OCCURRENCE */
      629     2399    1   ENDEIS:
      630     2400    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:112  
   2400 20 002200   000003 630400 21    ENDEIS       EPPR0   3
        20 002201   000002 631400 21                 EPPR1   2
        20 002202   000000 701000 xent               TSX1    FETCHOS_6
        20 002203   002554 702000 20                 TSX2    ERROR1

      631     2401    1   GETRC:
      632     2402    1       CALL FETCHNS_6('OA-RC   ') ALTRET(TERMEIS);

   2402 20 002204   000003 630400 21    GETRC        EPPR0   3
        20 002205   000002 631400 21                 EPPR1   2
        20 002206   000000 701000 xent               TSX1    FETCHNS_6
        20 002207   002557 702000 20                 TSX2    TERMEIS

      633     2403    1       IF UWA.RC.PSMODE = 5 /* PA-REC */

   2403 20 002210   000271 235000 18                 LDA     UWA+185
        20 002211   000005 115007                    CMPA    5,DL
        20 002212   002375 601000 20                 TNZ     s:2452

      634     2404    1       THEN
      635     2405    2       DO;

      636     2406    2           UWA.RC.LSIZE = 0;

   2406 20 002213   000306 450000 18                 STZ     UWA+198

      637     2407    2   PARC1:
      638     2408    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(PARC4);

   2408 20 002214   000005 630400 21    PARC1        EPPR0   5
        20 002215   000002 631400 21                 EPPR1   2
        20 002216   000000 701000 xent               TSX1    FETCHNS_6
        20 002217   002267 702000 20                 TSX2    PARC4

      639     2409    2           CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);

   2409 20 002220   000010 630400 21                 EPPR0   8
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:113  
        20 002221   000002 631400 21                 EPPR1   2
        20 002222   000000 701000 xent               TSX1    FETCHOS_6
        20 002223   002554 702000 20                 TSX2    ERROR1

      640     2410        /*          TOK.CODE = UWA.DIRECT_REF;  FOR POSS DIAG                    */
      641     2411    2           MAP.XWORD = 0;

   2411 20 002224   000000 220003                    LDX0    0,DU
        20 002225   000012 740000 0                  STX0    MAP

      642     2412    2           MAP.HBYTE = 4;

   2412 20 002226   000004 221003                    LDX1    4,DU
        20 002227   000013 741000 0                  STX1    MAP+1

      643     2413    2           UWA.FR.FTYPE = 5;

   2413 20 002230   000005 235007                    LDA     5,DL
        20 002231   000334 755000 18                 STA     UWA+220

      644     2414    2           UWA.FR.PREC = UWA.SC.PTRSZ;

   2414 20 002232   000321 236000 18                 LDQ     UWA+209
        20 002233   000335 756000 18                 STQ     UWA+221

      645     2415    2           CALL EISGEN;

   2415 20 002234   001602 701000 20                 TSX1    EISGEN
        20 002235   000000 011000                    NOP     0

      646     2416    2           UWA.SM.PA_MEMPNT = UWA.FR.BUFFLOC;

   2416 20 002236   000351 235000 18                 LDA     UWA+233
        20 002237   000373 755000 18                 STA     UWA+251

      647     2417    2           CALL FCURR_R_6('SM  ') ALTRET(ERROR1);

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:114  
   2417 20 002240   000012 630400 21                 EPPR0   10
        20 002241   000002 631400 21                 EPPR1   2
        20 002242   000000 701000 xent               TSX1    FCURR_R_6
        20 002243   002554 702000 20                 TSX2    ERROR1

      648     2418    2           CALL MODIFY_6('SM  ') ALTRET(ERROR1);

   2418 20 002244   000012 630400 21                 EPPR0   10
        20 002245   000002 631400 21                 EPPR1   2
        20 002246   000000 701000 xent               TSX1    MODIFY_6
        20 002247   002554 702000 20                 TSX2    ERROR1

      649     2419    2   PARC2:
      650     2420    2           CALL FETCHNS_6('SMSS-CF ') ALTRET(PARC1);

   2420 20 002250   000020 630400 21    PARC2        EPPR0   16
        20 002251   000002 631400 21                 EPPR1   2
        20 002252   000000 701000 xent               TSX1    FETCHNS_6
        20 002253   002214 702000 20                 TSX2    PARC1

      651     2421    2           CALL FETCHOS_6('FR-CFS  ') ALTRET(ERROR1);

   2421 20 002254   000017 630400 21                 EPPR0   15
        20 002255   000002 631400 21                 EPPR1   2
        20 002256   000000 701000 xent               TSX1    FETCHOS_6
        20 002257   002554 702000 20                 TSX2    ERROR1

      652     2422    2           CALL EISGEN;

   2422 20 002260   001602 701000 20                 TSX1    EISGEN
        20 002261   000000 011000                    NOP     0

      653     2423    2           CALL MODIFY_6('FR  ') ALTRET(ERROR1);

   2423 20 002262   000023 630400 21                 EPPR0   19
        20 002263   000002 631400 21                 EPPR1   2
        20 002264   000000 701000 xent               TSX1    MODIFY_6
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:115  
        20 002265   002554 702000 20                 TSX2    ERROR1

      654     2424    2           GOTO PARC2;

   2424 20 002266   002250 710000 20                 TRA     PARC2

      655     2425    2   PARC4:
      656     2426    2           UWA.RC.PA_OFFSET = 8 + (3*UWA.SC.PTRSZ);

   2426 20 002267   000321 236000 18    PARC4        LDQ     UWA+209
        20 002270   000003 402007                    MPY     3,DL
        20 002271   000010 036007                    ADLQ    8,DL
        20 002272   000303 756000 18                 STQ     UWA+195

      657     2427    2           ALLOW = UWA.RC.PA_ENTRY;

   2427 20 002273   000304 235000 18                 LDA     UWA+196
        20 002274   000006 755000 0                  STA     ALLOW

      658     2428    2           CALL ALIGN(2);

   2428 20 002275   000022 236000 21                 LDQ     18
        20 002276   200035 756100                    STQ     @DBK_C+2,,AUTO
        20 002277   002041 701000 20                 TSX1    ALIGN
        20 002300   000000 011000                    NOP     0

      659     2429    2           UWA.RC.PA_ENTRY = (4*MAP.XWORD) + (MAP.HBYTE/2);

   2429 20 002301   000013 236000 0                  LDQ     MAP+1
        20 002302   000022 732000                    QRS     18
        20 002303   000002 506007                    DIV     2,DL
        20 002304   200036 756100                    STQ     @PREC+1,,AUTO
        20 002305   000012 236000 0                  LDQ     MAP
        20 002306   777777 376003                    ANQ     -1,DU
        20 002307   000020 732000                    QRS     16
        20 002310   200036 036100                    ADLQ    @PREC+1,,AUTO
        20 002311   000304 756000 18                 STQ     UWA+196
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:116  

      660     2430    2           IF ALLOW ~= 0 THEN

   2430 20 002312   000006 235000 0                  LDA     ALLOW
        20 002313   002324 600000 20                 TZE     s:2433

      661     2431    2               PA_SIZE_N = 8 + (3*UWA.SC.PTRSZ) + (ALLOW*UWA.RC.PA_ENTRY);

   2431 20 002314   000006 402000 0                  MPY     ALLOW
        20 002315   200036 756100                    STQ     @PREC+1,,AUTO
        20 002316   000321 236000 18                 LDQ     UWA+209
        20 002317   000003 402007                    MPY     3,DL
        20 002320   200036 036100                    ADLQ    @PREC+1,,AUTO
        20 002321   000010 036007                    ADLQ    8,DL
        20 002322   000005 756000 0                  STQ     PA_SIZE_N
        20 002323   002325 710000 20                 TRA     s:2434

      662     2432    2           ELSE
      663     2433    2               PA_SIZE_N = 0;

   2433 20 002324   000005 450000 0                  STZ     PA_SIZE_N

      664     2434    2           PA_SIZE_1 = 8+(3*UWA.SC.PTRSZ)+ UWA.RC.PA_ENTRY;

   2434 20 002325   000321 236000 18                 LDQ     UWA+209
        20 002326   000003 402007                    MPY     3,DL
        20 002327   000304 036000 18                 ADLQ    UWA+196
        20 002330   000010 036007                    ADLQ    8,DL
        20 002331   000004 756000 0                  STQ     PA_SIZE_1

      665     2435    2   PARC5:
      666     2436    2           CALL FETCHNS_6('RC-RA   ') ALTRET(PARC6);

   2436 20 002332   000025 630400 21    PARC5        EPPR0   21
        20 002333   000002 631400 21                 EPPR1   2
        20 002334   000000 701000 xent               TSX1    FETCHNS_6
        20 002335   002360 702000 20                 TSX2    PARC6
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:117  

      667     2437    2           CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);

   2437 20 002336   000026 630400 21                 EPPR0   22
        20 002337   000002 631400 21                 EPPR1   2
        20 002340   000000 701000 xent               TSX1    FETCHOS_6
        20 002341   002554 702000 20                 TSX2    ERROR1

      668     2438    2           CALL CURRENCY(UWA.DIRECT_REF);

   2438 20 002342   000027 236000 21                 LDQ     23
        20 002343   200033 756100                    STQ     CHARV_PREC+3,,AUTO
        20 002344   002534 701000 20                 TSX1    CURRENCY
        20 002345   000000 011000                    NOP     0

      669     2439    2           IF UWA.RC.LSIZE = 0 THEN

   2439 20 002346   000306 235000 18                 LDA     UWA+198
        20 002347   002353 601000 20                 TNZ     s:2442

      670     2440    2               UWA.RC.LSIZE = UWA.AC.SPACE_AVAIL;

   2440 20 002350   000263 236000 18                 LDQ     UWA+179
        20 002351   000306 756000 18                 STQ     UWA+198
        20 002352   002357 710000 20                 TRA     s:2444

      671     2441    2           ELSE
      672     2442    2               IF UWA.AC.SPACE_AVAIL < UWA.RC.LSIZE THEN

   2442 20 002353   000263 236000 18                 LDQ     UWA+179
        20 002354   000306 116000 18                 CMPQ    UWA+198
        20 002355   002357 605000 20                 TPL     s:2444

      673     2443    2                   UWA.RC.LSIZE = UWA.AC.SPACE_AVAIL;

   2443 20 002356   000306 756000 18                 STQ     UWA+198

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:118  
      674     2444    2           GOTO PARC5;

   2444 20 002357   002332 710000 20                 TRA     PARC5

      675     2445    2   PARC6:
      676     2446    2           IF ALLOW ~= 0 THEN

   2446 20 002360   000006 235000 0     PARC6        LDA     ALLOW
        20 002361   002364 600000 20                 TZE     s:2448

      677     2447    2               UWA.RC.LSIZE = PA_SIZE_N;

   2447 20 002362   000005 236000 0                  LDQ     PA_SIZE_N
        20 002363   000306 756000 18                 STQ     UWA+198

      678     2448    2           CALL FCURR_R_6('RC  ') ALTRET(ERROR1);

   2448 20 002364   000024 630400 21                 EPPR0   20
        20 002365   000002 631400 21                 EPPR1   2
        20 002366   000000 701000 xent               TSX1    FCURR_R_6
        20 002367   002554 702000 20                 TSX2    ERROR1

      679     2449    2           CALL MODIFY_6('RC  ') ALTRET(ERROR1);

   2449 20 002370   000024 630400 21                 EPPR0   20
        20 002371   000002 631400 21                 EPPR1   2
        20 002372   000000 701000 xent               TSX1    MODIFY_6
        20 002373   002554 702000 20                 TSX2    ERROR1

      680     2450    2           GOTO GETRC;

   2450 20 002374   002204 710000 20                 TRA     GETRC

      681     2451    2           END;
      682     2452    1       IF UWA.RC.PSMODE = 1 OR UWA.RC.PSMODE = 2 OR UWA.RC.PSMODE = 4 THEN

   2452 20 002375   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:119  
        20 002376   002403 600000 20                 TZE     GETSM
        20 002377   000002 115007                    CMPA    2,DL
        20 002400   002403 600000 20                 TZE     GETSM
        20 002401   000004 115007                    CMPA    4,DL
        20 002402   002457 601000 20                 TNZ     GETFR

      683     2453    2       DO; /* CALC, INDEXED OR LOC VIA */

      684     2454    2   GETSM:
      685     2455    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(GETFR);

   2455 20 002403   000005 630400 21    GETSM        EPPR0   5
        20 002404   000002 631400 21                 EPPR1   2
        20 002405   000000 701000 xent               TSX1    FETCHNS_6
        20 002406   002457 702000 20                 TSX2    GETFR

      686     2456         /* LINK PRIMARY KEY IN FIRST
      687     2457            LINK *CALC SET IN FIRST
      688     2458            LINK VIA SET IN FIRST
      689     2459         CHECK IF RECORD IS *CALC OR LOCATION VIA SOME SET
      690     2460         OR INDEXED RECORD.  IF SO, LINK SM (PSMODE = 1 )
      691     2461         IN FIRST */
      692     2462    2           IF UWA.RECORD_NAME = 'SO' THEN

   2462 20 002407   040000 106400                    CMPC    fill='040'O
        20 002410   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 002411   000014 000002 19                 ADSC9   12                       cn=0,n=2
        20 002412   002403 600000 20                 TZE     GETSM

      693     2463    2               GOTO GETSM;
      694     2464    2           IF UWA.SM.PSMODE = 1 THEN

   2464 20 002413   000366 235000 18                 LDA     UWA+246
        20 002414   000001 115007                    CMPA    1,DL
        20 002415   002456 601000 20                 TNZ     s:2477

      695     2465    3           DO;
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:120  

      696     2466    3               DBK = UWA.DIRECT_REF;

   2466 20 002416   000036 236000 18                 LDQ     UWA+30
        20 002417   200015 756100                    STQ     DBK,,AUTO

      697     2467    3               IF UWA.RC.NUM_SOSM = 1 THEN

   2467 20 002420   000305 235000 18                 LDA     UWA+197
        20 002421   000001 115007                    CMPA    1,DL
        20 002422   002403 600000 20                 TZE     GETSM

      698     2468    3                   GOTO GETSM; /* BYPASS IF 1 MEMBER */
      699     2469    3               CALL DISCONNECT_6('RC-SOSM ') ALTRET(ERROR1);

   2469 20 002423   000005 630400 21                 EPPR0   5
        20 002424   000002 631400 21                 EPPR1   2
        20 002425   000000 701000 xent               TSX1    DISCONNECT_6
        20 002426   002554 702000 20                 TSX2    ERROR1

      700     2470    3               CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   2470 20 002427   000005 630400 21                 EPPR0   5
        20 002430   000002 631400 21                 EPPR1   2
        20 002431   000000 701000 xent               TSX1    FETCHOS_6
        20 002432   002554 702000 20                 TSX2    ERROR1

      701     2471    3               CALL FETCHNS_6('RC-SOSM ') ALTRET(TERMEIS);

   2471 20 002433   000005 630400 21                 EPPR0   5
        20 002434   000002 631400 21                 EPPR1   2
        20 002435   000000 701000 xent               TSX1    FETCHNS_6
        20 002436   002557 702000 20                 TSX2    TERMEIS

      702     2472    3               TEMP_UBIN_WORD = DBK;

   2472 20 002437   200015 235100                    LDA     DBK,,AUTO
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:121  
        20 002440   200027 755100                    STA     TEMP_UBIN_WORD,,AUTO

      703     2473    3               CALL FETCHD_6('SM  ', TEMP_UBIN_WORD) ALTRET(ERROR1);

   2473 20 002441   200027 630500                    EPPR0   TEMP_UBIN_WORD,,AUTO
        20 002442   200037 450500                    STP0    @PREC+2,,AUTO
        20 002443   000012 236000 21                 LDQ     10
        20 002444   200036 756100                    STQ     @PREC+1,,AUTO
        20 002445   200036 630500                    EPPR0   @PREC+1,,AUTO
        20 002446   000007 631400 21                 EPPR1   7
        20 002447   000000 701000 xent               TSX1    FETCHD_6
        20 002450   002554 702000 20                 TSX2    ERROR1

      704     2474    3               CALL CONNECT_6('RC-SOSM ') ALTRET(ERROR1);

   2474 20 002451   000005 630400 21                 EPPR0   5
        20 002452   000002 631400 21                 EPPR1   2
        20 002453   000000 701000 xent               TSX1    CONNECT_6
        20 002454   002554 702000 20                 TSX2    ERROR1

      705     2475    3               GOTO GETFR;

   2475 20 002455   002457 710000 20                 TRA     GETFR

      706     2476    3               END;
      707     2477    2           GOTO GETSM;

   2477 20 002456   002403 710000 20                 TRA     GETSM

      708     2478    2           END;
      709     2479    1   GETFR:
      710     2480    1       CALL FETCHNS_6('RC-FR   ') ALTRET(GETRC);

   2480 20 002457   000016 630400 21    GETFR        EPPR0   14
        20 002460   000002 631400 21                 EPPR1   2
        20 002461   000000 701000 xent               TSX1    FETCHNS_6
        20 002462   002204 702000 20                 TSX2    GETRC
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:122  

      711     2481    1       IF UWA.FR.SYN = 0 THEN

   2481 20 002463   000332 235000 18                 LDA     UWA+218
        20 002464   002457 600000 20                 TZE     GETFR

      712     2482    1           GOTO GETFR;
      713     2483    1       IF UWA.FR.F_USE = 4 OR UWA.FR.F_USE = 5 THEN

   2483 20 002465   000343 236000 18                 LDQ     UWA+227
        20 002466   000004 116007                    CMPQ    4,DL
        20 002467   002473 600000 20                 TZE     GETFR1
        20 002470   000005 116007                    CMPQ    5,DL
        20 002471   002473 600000 20                 TZE     GETFR1

      714     2484    1           GOTO GETFR1;
      715     2485    1       GOTO GETFR;

   2485 20 002472   002457 710000 20                 TRA     GETFR

      716     2486    1   GETFR1:
      717     2487    1       IF UWA.FR.BUFFLOC = 0 THEN

   2487 20 002473   000351 235000 18    GETFR1       LDA     UWA+233
        20 002474   002457 600000 20                 TZE     GETFR

      718     2488    1           GOTO GETFR;
      719     2489    1       DBK_FR = UWA.DIRECT_REF;

   2489 20 002475   000036 235000 18                 LDA     UWA+30
        20 002476   200014 755100                    STA     DBK_FR,,AUTO

      720     2490    1       TEMP_UBIN_WORD = UWA.FR.BUFFLOC;

   2490 20 002477   000351 235000 18                 LDA     UWA+233
        20 002500   200027 755100                    STA     TEMP_UBIN_WORD,,AUTO

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:123  
      721     2491    1       CALL FETCHD_6('FR  ', TEMP_UBIN_WORD) ALTRET(ERROR1);

   2491 20 002501   200027 630500                    EPPR0   TEMP_UBIN_WORD,,AUTO
        20 002502   200037 450500                    STP0    @PREC+2,,AUTO
        20 002503   000023 236000 21                 LDQ     19
        20 002504   200036 756100                    STQ     @PREC+1,,AUTO
        20 002505   200036 630500                    EPPR0   @PREC+1,,AUTO
        20 002506   000007 631400 21                 EPPR1   7
        20 002507   000000 701000 xent               TSX1    FETCHD_6
        20 002510   002554 702000 20                 TSX2    ERROR1

      722     2492    1       DBK = UWA.FR.BUFFLOC;

   2492 20 002511   000351 235000 18                 LDA     UWA+233
        20 002512   200015 755100                    STA     DBK,,AUTO

      723     2493    1       TEMP_UBIN_WORD = DBK_FR;

   2493 20 002513   200014 236100                    LDQ     DBK_FR,,AUTO
        20 002514   200027 756100                    STQ     TEMP_UBIN_WORD,,AUTO

      724     2494    1       CALL FETCHD_6('FR  ', TEMP_UBIN_WORD) ALTRET(ERROR1);

   2494 20 002515   200027 630500                    EPPR0   TEMP_UBIN_WORD,,AUTO
        20 002516   200037 450500                    STP0    @PREC+2,,AUTO
        20 002517   000023 236000 21                 LDQ     19
        20 002520   200036 756100                    STQ     @PREC+1,,AUTO
        20 002521   200036 630500                    EPPR0   @PREC+1,,AUTO
        20 002522   000007 631400 21                 EPPR1   7
        20 002523   000000 701000 xent               TSX1    FETCHD_6
        20 002524   002554 702000 20                 TSX2    ERROR1

      725     2495    1       UWA.FR.BUFFLOC = DBK;

   2495 20 002525   200015 235100                    LDA     DBK,,AUTO
        20 002526   000351 755000 18                 STA     UWA+233

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:124  
      726     2496    1       CALL MODIFY_6('FR  ') ALTRET(ERROR1);

   2496 20 002527   000023 630400 21                 EPPR0   19
        20 002530   000002 631400 21                 EPPR1   2
        20 002531   000000 701000 xent               TSX1    MODIFY_6
        20 002532   002554 702000 20                 TSX2    ERROR1

      727     2497    1       GOTO GETFR;

   2497 20 002533   002457 710000 20                 TRA     GETFR

      728     2498    1   CURRENCY:

   2498 20 002534   200032 741300       CURRENCY     STX1  ! CHARV_PREC+2,,AUTO

      729     2499    1       PROC(DBK_C);
      730     2500    2   DCL DBK_C UBIN(36);
      731     2501    2       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR2);

   2501 20 002535   000011 630400 21                 EPPR0   9
        20 002536   000002 631400 21                 EPPR1   2
        20 002537   000000 701000 xent               TSX1    FETCHOS_6
        20 002540   002547 702000 20                 TSX2    ERROR2

      732     2502    2       CURRENT.SNPNTR = UWA.DIRECT_REF;

   2502 20 002541   000036 235000 18                 LDA     UWA+30
        20 002542   000006 755000 1                  STA     CURRENT+6

      733     2503    2       CURRENT.SUBENTRY = UWA.SN.SETYPE;

   2503 20 002543   000424 236000 18                 LDQ     UWA+276
        20 002544   000004 756000 1                  STQ     CURRENT+4

      734     2504    2       RETURN;

   2504 20 002545   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:125  
        20 002546   000001 702211                    TSX2  ! 1,X1

      735     2505    2   ERROR2: CALL ABORT;

   2505 20 002547   000054 631400 21    ERROR2       EPPR1   44
        20 002550   000000 701000 xent               TSX1    ABORT
        20 002551   000000 011000                    NOP     0

      736     2506    2   END CURRENCY;

   2506 20 002552   200032 221300                    LDX1  ! CHARV_PREC+2,,AUTO
        20 002553   000001 702211                    TSX2  ! 1,X1

      737     2507    1   ERROR1:
      738     2508    1       CALL ABORT;

   2508 20 002554   000054 631400 21    ERROR1       EPPR1   44
        20 002555   000000 701000 xent               TSX1    ABORT
        20 002556   000000 011000                    NOP     0

      739     2509    1   TERMEIS:
      740     2510    1   END DOEIS;

   2510 20 002557                       TERMEIS      null
   2510 20 002557   000000 702200 xent               TSX2  ! X66_ARET

XEIS
 Sect OctLoc
   0     010   3***** *0****                                                    ....

EIS1
 Sect OctLoc
   0     011   3***** *4****                                                    .. .

CURRENT
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:126  

UWA_KEY
 Sect OctLoc
   9     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  11     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  12     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  14     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  14     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  14     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  14     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  15     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  15     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  15     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  15     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  15     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  15     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  15     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  15     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  16     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  16     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  16     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  16     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:127  
  16     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  16     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  16     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  16     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  17     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  17     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  17     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  17     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  17     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  17     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  17     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  17     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

UWA
 Sect OctLoc
  18     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  18     004   040040 040040   040040 040040   040040 040040   040040 040040
  18     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  18     014   040040 040040   040040 040040   040040 040040   040040 040040
  18     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  18     024   040040 040040   040040 040040   040040 040040   040040 040040
  18     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  18     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  18     040   040040 040040   040040 040040   040040 040040   040040 040040
  18     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  18     050   040040 040040   040040 040040   040040 040040   040040 040040
  18     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  18     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  18     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  18     070   040040 040040   040040 040040   040040 040040   040040 040040
  18     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  18     104   040040 040040   040040 040040   040040 040040   040040 040040
  18     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  18     130   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:128  
  18     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  18     140   040040 040040   040040 040040   040040 040040   040040 040040
  18     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  18     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     154   040040 040040   040040 040040   040040 040040   040040 040040
  18     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  18     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  18     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  18     174   040040 040040   040040 040040   040040 040040   040040 040040
  18     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  18     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  18     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  18     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  18     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  18     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  18     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  18     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  18     430   040040 040040   040040 040040   040040 040040   040040 040040
  18     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  18     440   040040 040040   040040 040040   040040 040040   040040 040040
  18     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  18     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  18     460   040040 040040   040040 040040   040040 040040   040040 040040
  18     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  18     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  18     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  18     504   040040 040040   040040 040040   040040 040040   040040 040040
  18     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  18     524   040040 040040   040040 040040   040040 040040   040040 040040
  18     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:129  
  18     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  18     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  18     614   040040 040040   040040 040040   040040 040040   040040 040040
  18     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  18     624   040040 040040   040040 040040   040040 040040   040040 040040
  18     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  18     664   040040 040040   040040 040040   040040 040040   040040 040040
  18     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18     700   040040 040040   040040 040040   040040 040040   040040 040040
  18     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18     714   040040 040040   040040 040040   040040 040040   040040 040040
  18     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  18     724   040040 040040   040040 040040   040040 040040   040040 040040
  18     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18     744   040040 040040   040040 040040   040040 040040   040040 040040
  18     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1000   040040 040040   040040 040040   040040 040040   040040 040040
  18    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1040   040040 040040   040040 040040   040040 040040   040040 040040
  18    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1064   040040 040040   040040 040040   040040 040040   040040 040040
  18    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1120   040040 040040   040040 040040   040040 040040   040040 040040
  18    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  18    1140   040040 040040   040040 040040   040040 040040   040040 040040
  18    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  18    1154   040040 040040   040040 040040   040040 040040   040040 040040
  18    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  18    1170   040040 040040   040040 040040   040040 040040   040040 040040
  18    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  18    1204   040040 040040   040040 040040   040040 040040   040040 040040
  18    1214*  040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:130  
 Sect OctLoc
  19     000   117101 055122   103040 040040   117101 055101   103040 040040    OA-RC   OA-AC
  19     004   122103 055123   117123 115040   101103 040040   123115 040040    RC-SOSM AC  SM
  19     010   123103 055123   117123 115040   123116 055123   105040 040040    SC-SOSM SN-SE
  19     014   123117 040040   122103 055106   122040 040040   106122 055103    SO  RC-FR   FR-C
  19     020   106123 040040   123115 123123   055103 106040   106122 040040    FS  SMSS-CF FR
  19     024   122103 040040   122103 055122   101040 040040   052103 101114    RC  RC-RA   *CAL
  19     030   103056 122103   052104 102120   101122 101115   052123 131123    C.RC*DBPARAM*SYS
  19     034   124105 115040   101103 055122   101040 040040   123103 040040    TEM AC-RA   SC

(unnamed)
 Sect OctLoc
  21     000   000010 006000   000011 006000   000001 000000   000000 006000    ................
  21     004   000002 006000   000004 006000   000006 006000   000002 000000    ................
  21     010   000010 006000   000012 006000   000007 006000   000014 006000    ................
  21     014   000000 004540   000014 006000   000015 006000   000017 006000    ................
  21     020   000021 006000   000000 000002   000021 006000   000023 006000    ................
  21     024   000024 006000   000025 006000   000035 006000   000036 006000    ................
  21     030   000003 000000   000000 000001   000000 000036   000031 006000    ................
  21     034   000032 006000   000427 006000   000000 004541   000036 006000    ................
  21     040   000000 004542   000040 006000   000000 004543   000042 006000    ..... ......."..
  21     044   000037 006000   000000 000010   000045 006000   000000 000004    .........%......
  21     050   000047 006000   000335 006000   000000 000020   000052 006000    .'...........*..
  21     054   000000 000000   777777 747777                                    ........

PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:131  
--  Include file information  --

   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIA_IDS_DCL.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DOEIS.

   Procedure DOEIS requires 1392 words for executable code.
   Procedure DOEIS requires 36 words of local(AUTO) storage.

    No errors detected in file ZIG$M_C5.:ZIC0TSI    .
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:132  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:133  
          MINI XREF LISTING

ABORT
      1414**DCL-ENT  2354--CALL     2505--CALL     2508--CALL
ALIGN
      2358**PROC     2141--CALL     2169--CALL     2285--CALL     2294--CALL     2303--CALL     2330--CALL
      2338--CALL     2347--CALL     2428--CALL
ALLOCATE
      2371**PROC     2082--CALL     2288--CALL     2297--CALL     2306--CALL     2313--CALL     2322--CALL
      2332--CALL     2342--CALL     2351--CALL
ALLOW
        16**DCL      2427<<ASSIGN   2430>>IF       2431>>ASSIGN   2446>>IF
BNDRY IN PROCEDURE ALIGN
      2359**DCL      2358--PROC     2360>>DOWHILE
CALC_NXT
        11**DCL      1874<<ASSIGN   1881>>ASSIGN   2078>>ASSIGN
CALC_PRI
        12**DCL      1876<<ASSIGN   1882>>ASSIGN   2079>>ASSIGN
CHARV_PREC
      1855**DCL      2117<<ASSIGN   2123<<ASSIGN   2123>>ASSIGN   2170>>ASSIGN   2217>>IF
CONNECT_6
       188**DCL-ENT  1972--CALL     1999--CALL     2474--CALL
CURRENCY
      2499**PROC     2196--CALL     2209--CALL     2220--CALL     2438--CALL
CURRENT.SNPNTR
        59**DCL      2502<<ASSIGN
CURRENT.SUBENTRY
        57**DCL      2503<<ASSIGN
DBK
      1851**DCL      1929<<ASSIGN   1937>>ASSIGN   1946<<ASSIGN   1952>>ASSIGN   1987<<ASSIGN   1997>>ASSIGN
      2466<<ASSIGN   2472>>ASSIGN   2492<<ASSIGN   2495>>ASSIGN
DBK_C IN PROCEDURE CURRENCY
      2500**DCL      2499--PROC
DBK_FR
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:134  
      1850**DCL      2489<<ASSIGN   2493>>ASSIGN
DISCONNECT_6
       189**DCL-ENT  1965--CALL     1994--CALL     2469--CALL
DOAC
      1880**LABEL    1884--GOTO
DOFI
      2119**LABEL    2124--GOTO     2151--GOTO
DOFLDS
      2115**LABEL    2024--CALLALT
DONDON
      2004**LABEL    1982--CALLALT  1986--GOTO     2000--GOTO
DONE_FR_CDS
      2146**LABEL    2135--CALLALT
DONXSM
      1982**LABEL    1984--GOTO     1992--GOTO     2002--GOTO
DOPNTS
      1980**LABEL    1921--GOTO     1926--GOTO
DOSET
      1888**LABEL    1880--CALLALT
DOSET1
      1907**LABEL    1892--CALLALT
DOSETRC
      1910**LABEL    2278--GOTO
DOSETRC1
      1924**LABEL    1915--CALLALT
DOSETS
      1892**LABEL    1900--GOTO     1904--GOTO
DOSETS1
      1902**LABEL    1894--CALLALT
DOSETSM
      1941**LABEL    1928--CALLALT
EIS1
        24**DCL      1858--ASSIGN
EIS1.BCHR
        27**DCL      2388<<ASSIGN
EIS1.BWRD
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:135  
        26**DCL      2387<<ASSIGN
EIS1.PREC
        31**DCL      2394<<ASSIGN
EIS1.SCALE
        30**DCL      2393<<ASSIGN
EIS1.SIGN
        29**DCL      2390<<ASSIGN   2392<<ASSIGN
EISA
      2024**LABEL    2030--GOTO     2046--GOTO     2073--GOTO     2083--GOTO     2093--GOTO     2103--GOTO
      2110--GOTO
EISD
      1849**DCL      2314>>ASSIGN   2324>>ASSIGN
EISD$
      1848**DCL      1849--IMP-PTR  1858<<ASSIGN   2314>>ASSIGN   2324>>ASSIGN
EISF
      1847**DCL      2289>>ASSIGN   2298>>ASSIGN   2307>>ASSIGN   2333>>ASSIGN   2341>>ASSIGN   2350>>ASSIGN
EISF$
      1846**DCL      1847--IMP-PTR  1857<<ASSIGN   2289>>ASSIGN   2298>>ASSIGN   2307>>ASSIGN   2333>>ASSIGN
      2341>>ASSIGN   2350>>ASSIGN
EISGEN
      2281**PROC     1873--CALL     1875--CALL     2055--CALL     2057--CALL     2064--CALL     2066--CALL
      2068--CALL     2085--CALL     2087--CALL     2089--CALL     2097--CALL     2099--CALL     2147--CALL
      2161--CALL     2259--CALL     2415--CALL     2422--CALL
ENDEIS
      2400**LABEL    1914--CALLALT
ERROR
      1406**DCL-ENT  2105--CALL
ERROR1
      2508**LABEL    1868--CALLALT  1869--CALLALT  1870--CALLALT  1883--CALLALT  1888--CALLALT  1908--CALLALT
      1922--CALLALT  1934--CALLALT  1935--CALLALT  1962--CALLALT  1964--CALLALT  1965--CALLALT  1966--CALLALT
      1969--CALLALT  1971--CALLALT  1972--CALLALT  1980--CALLALT  1988--CALLALT  1993--CALLALT  1994--CALLALT
      1995--CALLALT  1996--CALLALT  1998--CALLALT  1999--CALLALT  2021--CALLALT  2026--CALLALT  2044--CALLALT
      2045--CALLALT  2071--CALLALT  2072--CALLALT  2080--CALLALT  2081--CALLALT  2091--CALLALT  2092--CALLALT
      2101--CALLALT  2102--CALLALT  2115--CALLALT  2136--CALLALT  2137--CALLALT  2148--CALLALT  2149--CALLALT
      2156--CALLALT  2162--CALLALT  2163--CALLALT  2171--CALLALT  2172--CALLALT  2178--CALLALT  2179--CALLALT
      2185--CALLALT  2195--CALLALT  2208--CALLALT  2219--CALLALT  2236--CALLALT  2251--CALLALT  2258--CALLALT
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:136  
      2272--CALLALT  2273--CALLALT  2274--CALLALT  2400--CALLALT  2409--CALLALT  2417--CALLALT  2418--CALLALT
      2421--CALLALT  2423--CALLALT  2437--CALLALT  2448--CALLALT  2449--CALLALT  2469--CALLALT  2470--CALLALT
      2473--CALLALT  2474--CALLALT  2491--CALLALT  2494--CALLALT  2496--CALLALT
ERROR2 IN PROCEDURE CURRENCY
      2505**LABEL    2501--CALLALT
FCURR_R_6
       180**DCL-ENT  1969--CALL     1971--CALL     1993--CALL     2044--CALL     2071--CALL     2080--CALL
      2091--CALL     2101--CALL     2148--CALL     2162--CALL     2171--CALL     2195--CALL     2208--CALL
      2219--CALL     2273--CALL     2417--CALL     2448--CALL
FETCHD_6
       178**DCL-ENT  1962--CALL     1964--CALL     1998--CALL     2473--CALL     2491--CALL     2494--CALL
FETCHNS_6
       183**DCL-ENT  1880--CALL     1892--CALL     1894--CALL     1914--CALL     1915--CALL     1928--CALL
      1982--CALL     1996--CALL     2024--CALL     2119--CALL     2158--CALL     2184--CALL     2247--CALL
      2255--CALL     2402--CALL     2408--CALL     2420--CALL     2436--CALL     2455--CALL     2471--CALL
      2480--CALL
FETCHOS_6
       187**DCL-ENT  1868--CALL     1869--CALL     1870--CALL     1888--CALL     1908--CALL     1922--CALL
      1934--CALL     1935--CALL     1966--CALL     1980--CALL     1988--CALL     1995--CALL     2021--CALL
      2026--CALL     2115--CALL     2137--CALL     2156--CALL     2178--CALL     2179--CALL     2185--CALL
      2236--CALL     2251--CALL     2258--CALL     2400--CALL     2409--CALL     2421--CALL     2437--CALL
      2470--CALL     2501--CALL
FINDNS_6
       182**DCL-ENT  2135--CALL
FINDOS_6
       186**DCL-ENT  2136--CALL
FIND_KEY
      2134**LABEL    2142--EXIT
GETFR
      2480**LABEL    2455--CALLALT  2475--GOTO     2482--GOTO     2485--GOTO     2488--GOTO     2497--GOTO
GETFR1
      2487**LABEL    2484--GOTO
GETRC
      2402**LABEL    2450--GOTO     2480--CALLALT
GETSM
      2455**LABEL    2463--GOTO     2468--GOTO     2477--GOTO
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:137  
GLOBAL_SIZE
        13**DCL      1871<<ASSIGN   1872>>ASSIGN   2082>>CALL
INDEX_NUM
        10**DCL      2022<<ASSIGN   2041<<ASSIGN   2041>>ASSIGN   2042>>ASSIGN
MAP.HBYTE
        43**DCL      1860<<ASSIGN   2008<<ASSIGN   2014<<ASSIGN   2018<<ASSIGN   2063<<ASSIGN   2128>>IF
      2167>>ASSIGN   2170>>ASSIGN   2241<<ASSIGN   2245<<ASSIGN   2360>>DOWHILE  2361<<ASSIGN   2361>>ASSIGN
      2363>>IF       2365<<ASSIGN   2373<<ASSIGN   2373>>ASSIGN   2374>>DOWHILE  2375<<ASSIGN   2375>>ASSIGN
      2382>>ASSIGN   2388>>ASSIGN   2412<<ASSIGN   2429>>ASSIGN
MAP.XWORD
        42**DCL      1859<<ASSIGN   2007<<ASSIGN   2013<<ASSIGN   2017<<ASSIGN   2062<<ASSIGN   2167>>ASSIGN
      2170>>ASSIGN   2240<<ASSIGN   2244<<ASSIGN   2366<<ASSIGN   2366>>ASSIGN   2376<<ASSIGN   2376>>ASSIGN
      2381>>ASSIGN   2387>>ASSIGN   2411<<ASSIGN   2429>>ASSIGN
MODIFY_6
       181**DCL-ENT  1883--CALL     2045--CALL     2072--CALL     2081--CALL     2092--CALL     2102--CALL
      2149--CALL     2163--CALL     2172--CALL     2272--CALL     2274--CALL     2418--CALL     2423--CALL
      2449--CALL     2496--CALL
NM_SOSM
      1852**DCL      1889<<ASSIGN   1902>>IF       1903<<ASSIGN   1907>>CALL     1924<<ASSIGN   1925>>IF
      1927>>DOINDEX  1941>>DOINDEX  1942>>DOINDEX  1959>>DOINDEX
PARC1
      2408**LABEL    2420--CALLALT
PARC2
      2420**LABEL    2424--GOTO
PARC4
      2426**LABEL    2408--CALLALT
PARC5
      2436**LABEL    2444--GOTO
PARC6
      2446**LABEL    2436--CALLALT
PA_SIZE_1
        14**DCL      2434<<ASSIGN
PA_SIZE_N
        15**DCL      2431<<ASSIGN   2433<<ASSIGN   2447>>ASSIGN
PREC IN PROCEDURE ALLOCATE
      2372**DCL      2371--PROC     2373>>ASSIGN
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:138  
SETEIS
      2380**PROC     2286--CALL     2295--CALL     2304--CALL     2331--CALL     2339--CALL     2348--CALL
SETEIS1
      2386**PROC     2312--CALL     2321--CALL
SETRC
      2169**LABEL    2155--GOTO
SETRC0
      2236**LABEL    2175--GOTO     2233--GOTO
SETRC1
      2238**LABEL    2249--GOTO     2276--GOTO
SETRC1A
      2191**LABEL    2184--CALLALT
SETRC1B
      2184**LABEL    2189--GOTO
SETRC21
      2255**LABEL    2257--GOTO
SETRC4
      2278**LABEL    2182--GOTO     2234--GOTO     2247--CALLALT  2255--CALLALT
SETRCA
      2167**LABEL    2158--CALLALT
SET_FIELDS
      1409**DCL-ENT  2197--CALL     2210--CALL     2221--CALL
SOSM_TB.NAME
      1839**DCL      1936<<ASSIGN   1943>>IF       1943>>IF       1945>>ASSIGN   1948<<ASSIGN   1948>>ASSIGN
      1951<<ASSIGN
SOSM_TB.REC_TYPE
      1841**DCL      1931<<ASSIGN   1933<<ASSIGN   1947>>ASSIGN   1950<<ASSIGN   1950>>ASSIGN   1953<<ASSIGN
      1961>>IF       1968>>IF
SOSM_TB.XADDR
      1840**DCL      1937<<ASSIGN   1946>>ASSIGN   1949<<ASSIGN   1949>>ASSIGN   1952<<ASSIGN   1960>>ASSIGN
SP
      1842**DCL      1838--IMP-PTR  1907<>CALL     1931>>ASSIGN   1933>>ASSIGN   1936>>ASSIGN   1937>>ASSIGN
      1943>>IF       1943>>IF       1945>>ASSIGN   1946>>ASSIGN   1947>>ASSIGN   1948>>ASSIGN   1948>>ASSIGN
      1949>>ASSIGN   1949>>ASSIGN   1950>>ASSIGN   1950>>ASSIGN   1951>>ASSIGN   1952>>ASSIGN   1953>>ASSIGN
      1960>>ASSIGN   1961>>IF       1968>>IF
STYPE
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:139  
      1845**DCL      1947<<ASSIGN   1953>>ASSIGN
SUBSCHEMA_KEY
      1441**DCL      1442--REDEF
TEMP
      1853**DCL      1945<<ASSIGN   1951>>ASSIGN   2025<<ASSIGN   2049>>IF       2095>>IF
TEMP_UBIN_WORD
      1854**DCL      1960<<ASSIGN   1962<>CALL     1964<>CALL     1997<<ASSIGN   1998<>CALL     2472<<ASSIGN
      2473<>CALL     2490<<ASSIGN   2491<>CALL     2493<<ASSIGN   2494<>CALL
TERMEIS
      2510**LABEL    2402--CALLALT  2471--CALLALT
UWA.AC.CALC_NEXT
      1613**DCL      1614--REDEF    1881<<ASSIGN
UWA.AC.CALC_PRIOR
      1622**DCL      1623--REDEF    1882<<ASSIGN
UWA.AC.DEFAULTS
      1574**DCL      1575--REDEF
UWA.AC.FILE_CODE
      1579**DCL      1580--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      1576**DCL      1577--REDEF
UWA.AC.SPACE_AVAIL
      1611**DCL      2186>>ASSIGN   2187>>IF       2188>>ASSIGN   2440>>ASSIGN   2442>>IF       2443>>ASSIGN
UWA.C_F.SYN
      1708**DCL      2256>>IF
UWA.DIRECT_REF
      1514**DCL      1929>>ASSIGN   1987>>ASSIGN   1989>>IF       2076>>IF       2196<>CALL     2209<>CALL
      2220<>CALL     2438<>CALL     2466>>ASSIGN   2489>>ASSIGN   2502>>ASSIGN
UWA.FR.BEIST
      1682**DCL      2282<<ASSIGN   2315<<ASSIGN   2325<<ASSIGN
UWA.FR.BUFFLOC
      1683**DCL      1874>>ASSIGN   1876>>ASSIGN   2056>>ASSIGN   2058>>ASSIGN   2065>>ASSIGN   2067>>ASSIGN
      2069>>ASSIGN   2086>>ASSIGN   2088>>ASSIGN   2090>>ASSIGN   2098>>ASSIGN   2100>>ASSIGN   2289<<ASSIGN
      2298<<ASSIGN   2307<<ASSIGN   2314<<ASSIGN   2324<<ASSIGN   2333<<ASSIGN   2341<<ASSIGN   2350<<ASSIGN
      2416>>ASSIGN   2487>>IF       2490>>ASSIGN   2492>>ASSIGN   2495<<ASSIGN
UWA.FR.FTYPE
      1670**DCL      1861<<ASSIGN   1913<<ASSIGN   2120>>IF       2128>>IF       2128>>IF       2159>>IF
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:140  
      2260>>IF       2260>>IF       2260>>IF       2264>>IF       2266>>IF       2268>>IF       2268>>IF
      2270>>IF       2270>>IF       2283>>IF       2283>>IF       2292>>IF       2301>>IF       2310>>IF
      2318>>IF       2328>>IF       2328>>IF       2336>>IF       2345>>IF       2413<<ASSIGN
UWA.FR.F_SIGN
      1673**DCL      1864<<ASSIGN   1910<<ASSIGN   2269>>ASSIGN   2389>>IF
UWA.FR.F_USE
      1677**DCL      2483>>IF       2483>>IF
UWA.FR.PREC
      1671**DCL      1862<<ASSIGN   1872<<ASSIGN   1912<<ASSIGN   2048<<ASSIGN   2123>>ASSIGN   2269>>ASSIGN
      2271>>ASSIGN   2313<>CALL     2320<<ASSIGN   2320>>ASSIGN   2322<>CALL     2323<<ASSIGN   2323>>ASSIGN
      2332>>CALL     2383>>ASSIGN   2394>>ASSIGN   2414<<ASSIGN
UWA.FR.SCALE
      1672**DCL      1863<<ASSIGN   1865<<ASSIGN   1911<<ASSIGN   2393>>ASSIGN
UWA.FR.SYN
      1668**DCL      2126>>IF       2481>>IF
UWA.OA.GLOBAL
      1570**DCL      1871>>ASSIGN
UWA.OA.OA_CALC
      1572**DCL      1989>>IF       2076>>IF
UWA.RC.CV_OFFSET
      1642**DCL      2167<<ASSIGN
UWA.RC.KEY_PRESENT
      1641**DCL      2232>>IF
UWA.RC.LSIZE
      1646**DCL      2170<<ASSIGN   2193>>IF       2206>>IF       2217>>IF       2406<<ASSIGN   2439>>IF
      2440<<ASSIGN   2442>>IF       2443<<ASSIGN   2447<<ASSIGN
UWA.RC.NUM_SOSM
      1645**DCL      1902>>IF       1903>>ASSIGN   1924>>ASSIGN   1991>>IF       2467>>IF
UWA.RC.PA_ENTRY
      1644**DCL      2427>>ASSIGN   2429<<ASSIGN   2431>>ASSIGN   2434>>ASSIGN
UWA.RC.PA_OFFSET
      1643**DCL      2426<<ASSIGN
UWA.RC.PSMODE
      1633**DCL      1899>>IF       1920>>IF       2004>>IF       2011>>IF       2029>>IF       2128>>IF
      2174>>IF       2232>>IF       2238>>IF       2403>>IF       2452>>IF       2452>>IF       2452>>IF
UWA.RECORD_NAME
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:141  
      1511**DCL      1895>>IF       1916>>IF       1930>>IF       1983>>IF       2025>>ASSIGN   2248>>IF
      2462>>IF
UWA.SC.KEY_LENGTH
      1661**DCL      2263<<ASSIGN   2265<<ASSIGN   2267<<ASSIGN   2269<<ASSIGN   2271<<ASSIGN
UWA.SC.PTRSZ
      1658**DCL      2048>>ASSIGN   2414>>ASSIGN   2426>>ASSIGN   2431>>ASSIGN   2434>>ASSIGN
UWA.SC.SETMODE
      1650**DCL      2051>>IF
UWA.SC.SETTYPE
      1649**DCL      2027>>IF       2027>>IF       2138>>IF       2138>>IF       2252>>IF       2252>>IF
UWA.SM.HDPNT
      1700**DCL      2058<<ASSIGN   2069<<ASSIGN   2090<<ASSIGN
UWA.SM.NXTPNT
      1698**DCL      2056<<ASSIGN   2065<<ASSIGN   2078<<ASSIGN   2086<<ASSIGN
UWA.SM.PAMEM
      1695**DCL      2053>>IF
UWA.SM.PA_MEMPNT
      1701**DCL      2038<<ASSIGN   2042<<ASSIGN   2416<<ASSIGN
UWA.SM.PRIPNT
      1699**DCL      2067<<ASSIGN   2079<<ASSIGN   2088<<ASSIGN
UWA.SM.PSEQ
      1697**DCL      1896>>ASSIGN   1917>>ASSIGN   1985>>IF
UWA.SM.PSMODE
      1696**DCL      2036>>IF       2464>>IF
UWA.SN.SENAME
      1732**DCL      1936>>ASSIGN   2180>>IF       2180>>IF       2180>>IF       2197<>CALL     2210<>CALL
      2221<>CALL
UWA.SN.SETYPE
      1729**DCL      2503>>ASSIGN
UWA.SO.NXTPNT
      1687**DCL      2098<<ASSIGN
UWA.SO.PRIPNT
      1688**DCL      2100<<ASSIGN
UWA.SO.PSEQ
      1686**DCL      1898>>ASSIGN   1919>>ASSIGN
VARFR
PL6.E3A0      #001=DOEIS File=ZIG$M_C5.:ZIC0TSI                                  FRI 09/05/97 12:07 Page:142  
      2154**LABEL    2119--CALLALT
VARFR1
      2158**LABEL    2165--GOTO
VAR_FIELDS
         9**DCL      2116<<ASSIGN   2122<<ASSIGN   2122>>ASSIGN   2154>>IF       2191>>IF
WARNING
      1407**DCL-ENT  2198--CALL     2211--CALL     2222--CALL
X
        17**DCL      1896<<ASSIGN   1898<<ASSIGN   1899>>IF       1917<<ASSIGN   1919<<ASSIGN   1920>>IF
      2177<<ASSIGN   2186>>IF       2186<<ASSIGN   2187>>IF       2188<<ASSIGN   2193>>IF       2206>>IF
      2217>>IF
XEIS
        18**DCL      1857--ASSIGN
XEIS.BCHR
        21**DCL      2382<<ASSIGN
XEIS.BWRD
        20**DCL      2381<<ASSIGN
XEIS.PREC
        23**DCL      2287<<ASSIGN   2296<<ASSIGN   2305<<ASSIGN   2340<<ASSIGN   2349<<ASSIGN   2383<<ASSIGN
Z
      1843**DCL      1927<<DOINDEX  1931>>ASSIGN   1933>>ASSIGN   1936>>ASSIGN   1937>>ASSIGN   1941<<DOINDEX
      1942>>DOINDEX  1943>>IF       1945>>ASSIGN   1946>>ASSIGN   1947>>ASSIGN   1948>>ASSIGN   1949>>ASSIGN
      1950>>ASSIGN   1959<<DOINDEX  1960>>ASSIGN   1961>>IF       1968>>IF
Z1
      1844**DCL      1942<<DOINDEX  1943>>IF       1948>>ASSIGN   1949>>ASSIGN   1950>>ASSIGN   1951>>ASSIGN
      1952>>ASSIGN   1953>>ASSIGN
ZIG$G_DYN_MEM_6
      1416**DCL-ENT  1907--CALL
