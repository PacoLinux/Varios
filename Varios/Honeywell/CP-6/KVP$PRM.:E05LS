VERSION E05

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:1    
        1        1        /*M* KVP$PRM - VDH parameter processing routines.   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        KVP$PRM: PROC (KV$VDH_XXXPRM);
        9        9        /* INCLU DES */
       10       10        %INCLUDE LCP_6;
       11      201        %INCLUDE KH$CHN;
       12      323        %INCLUDE KV$INPFNC;
       13      882 S      %INCLUDE KV$INT;
       14      883 S      %INCLUDE KV$GLB;
       15      884 S      %INCLUDE KV$GLBCTX;
       16      885        %INCLUDE KV$PRM;
       17     1098 S      %INCLUDE KV$USR;
       18     1099 S      %INCLUDE KV$VDH;
       19     1100 S      %INCLUDE KV_GLBCNS_E;
       20     1101        %KV_BFRRLSDSP_E;
       21     1107        %KV_INPUNT_E;
       22     1112        %KV_PHSPSTMOD_E;
       23     1119        %KV_STRTYP_E;
       24     1157        %KV_USR_EVT_ID_E;
       25     1177        %KV_USR_FNC_E;
       26     1193 S      %INCLUDE KV_PRMID_E;
       27     1194        %INCLUDE KV_SCODE_C;
       28     1215        %KV#DATMOD_E;
       29     1221        %KV#VD_ORG_E;
       30     1229        %KV_PRMID_E;
       31     1385        %KV_SCP_E;
       32     1395        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:2    
       33     1396        %INCLUDE KV_PRMTBL_D;                   /* Generate the driver tables         */
       11+    2180        %KV_PARM (ID=KV_PRMID_3270, TYPE=OTHER);
       12+    2220        %KV_PARM (ID=KV_PRMID_ABSGRPRND, TYPE=OTHER, STR=MRD);
       13+    2260        %KV_PARM (ID=KV_PRMID_ACTCHRSET, TYPE=SHRBFR, STR=STR, OFFSET=KV$STR_ACTCHRTBL$#,
       14+    2261                 BFRTYP=KV_STRTYP_ACTCHR, BFRLNG=32);
       15+    2301        %KV_PARM (ID=KV_PRMID_ACTONTRN, TYPE=BIT, STR=STR, OFFSET=KV$STR_ACTONTRN#);
       16+    2341        %KV_PARM (ID=KV_PRMID_ADJTOPLFT, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_ADJTOPLFT#);
       17+    2381        %KV_PARM (ID=KV_PRMID_APL, TYPE=OTHER);
       18+    2421        %KV_PARM (ID=KV_PRMID_APLLCNRM, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_APLLCNRM#);
       19+    2461        %KV_PARM (ID=KV_PRMID_ATRSCRNPOS, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_ATRRQRDSPPST#);
       20+    2501        %KV_PARM (ID=KV_PRMID_AUTCRS, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_AUTCRS#);
       21+    2541        %KV_PARM (ID=KV_PRMID_AUTONL, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_AUTONL#);
       22+    2581        %KV_PARM (ID=KV_PRMID_AUTSAV, TYPE=STRLST);
       23+    2640           %KV_SUBSTR (ID=KV_PRMID_TRMCTL, OFFSET=8); /* Skip the first 8             */
       24+    2660           %KV_SUBSTR (ID=KV_PRMID_PROMPT);
       25+    2680           %KV_SUBSTR (ID=KV_PRMID_EOM);
       26+    2700           %KV_SUBSTR (ID=KV_PRMID_SINPUT);
       27+    2720           %KV_SUBSTR (ID=KV_PRMID_INPTAB);
       28+    2740           %KV_SUBSTR (ID=KV_PRMID_PLATEN);
       29+    2760           %KV_SUBSTR (ID=KV_PRMID_DCBHDR);
       30+    2780           %KV_SUBSTR (ID=KV_PRMID_SSNHDR);
       31+    2800        %KV_PARM (ID=KV_PRMID_AUTTABCLM, TYPE=BYTE, STR=STR, OFFSET=KV$STR_AUTTABCLM#);
       32+    2840        %KV_PARM (ID=KV_PRMID_BIN, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_BIN#);
       33+    2880        %KV_PARM (ID=KV_PRMID_BLANKERASES, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_BLANKERASES#);
       34+    2920        %KV_PARM (ID=KV_PRMID_BRKCNT, TYPE=BYTE, STR=SSN, OFFSET=KV$SSN_BRKCNT#, MAX=3);
       35+    2960        %KV_PARM (ID=KV_PRMID_BTMBRD, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_BTMBRD#);
       36+    3000        %KV_PARM (ID=KV_PRMID_CHARSETNAME, TYPE=SHRBFR, STR=MVD, OFFSET=KV$MVD_TRNTBL$#,
       37+    3001                 BFRTYP=KV_STRTYP_TRNTBL, BFRLNG=8);
       38+    3041        %KV_PARM (ID=KV_PRMID_CHNCAS, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_CHNCAS#);
       39+    3081        %KV_PARM (ID=KV_PRMID_CRISNL, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_CRISNL#);
       40+    3121        %KV_PARM (ID=KV_PRMID_CRSRED, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_CRSRED#);
       41+    3161        %KV_PARM (ID=KV_PRMID_CRTLINSPD, TYPE=BYTE, STR=VDI, OFFSET=KV$VDI_LINSPD#, MAX=15);
       42+    3201        %KV_PARM (ID=KV_PRMID_CTRCHR, TYPE=SHRBFR, STR=MRD, OFFSET=KV$MRD_ERD$#,
       43+    3202                 BFRTYP=KV_STRTYP_ERD, BFRLNG=KV$ERD_TXT#/8-8);
       44+    3242        %KV_PARM (ID=KV_PRMID_CURSORUP, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_CURSORUP#);
       45+    3282        %KV_PARM (ID=KV_PRMID_DADR, TYPE=STRUCT);
       46+    3341        %KV_PARM (ID=KV_PRMID_DCBHDR, TYPE=SHRBFR, STR=MVD, OFFSET=KV$MVD_DCBHDN$#,
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:3    
       47+    3342                 BFRTYP=KV_STRTYP_DCBHDN, BFRLNG=6);
       48+    3382        %KV_PARM (ID=KV_PRMID_DCHMOVFLD, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DCHMOVFLD#);
       49+    3422        %KV_PARM (ID=KV_PRMID_DEVCTL, TYPE=OTHER);
       50+    3462        %KV_PARM (ID=KV_PRMID_DEVICEBS, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVICEBS#);
       51+    3502        %KV_PARM (ID=KV_PRMID_DEVICECR, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVICECR#);
       52+    3542        %KV_PARM (ID=KV_PRMID_DEVICELF, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVICELF#);
       53+    3582        %KV_PARM (ID=KV_PRMID_DEVNUM, TYPE=OTHER);
       54+    3622        %KV_PARM (ID=KV_PRMID_DEVPOSOPTS, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVPOSOPTS#);
       55+    3662        %KV_PARM (ID=KV_PRMID_DEVSCROLL, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVSCROLL#);
       56+    3702        %KV_PARM (ID=KV_PRMID_DISPINPUT, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_DISPINPUT#);
       57+    3742        %KV_PARM (ID=KV_PRMID_DMN, TYPE=BYTE, STR=STR, OFFSET=KV$STR_ID#,
       58+    3743                 MIN=256, MAX=0);
       59+    3783        %KV_PARM (ID=KV_PRMID_DSPHEIGHT, TYPE=BYTE, STR=MRD, OFFSET=KV$MRD_DSPHEIGHT#);
       60+    3823        %KV_PARM (ID=KV_PRMID_DVCFLWCTRALG, STR=MRD, OFFSET=KV$MRD_DVCFLWCTRALG#,
       61+    3824                 TYPE=BYTE, MAX=3);
       62+    3864        %KV_PARM (ID=KV_PRMID_EDITOVR, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_EDITOVR#);
       63+    3904        %KV_PARM (ID=KV_PRMID_EDTBFR, TYPE=SHRBFR, STR=STR, OFFSET=KV$STR_EDTBFR__#,
       64+    3905                 BFRTYP=KV_STRTYP_REDBFR, BFRLNG=0);
       65+    3945        %KV_PARM (ID=KV_PRMID_EDTCTL, TYPE=STRUCT, MAX="(EDTCTL_ONESPACEEDIT#+16)");
       66+    4004           %KV_SUBSTR (ID=KV_PRMID_RCRWRAP, OFFSET=EDTCTL_RCRWRAP#, TYPE=BITCND);
       67+    4024           %KV_SUBSTR (ID=KV_PRMID_EDTCTL, TYPE=OTHER); /* Only for ORG=SE */
       68+    4044           %KV_SUBSTR (ID=KV_PRMID_HRZSCRALL, OFFSET=EDTCTL_HSALL#, TYPE=BITCND);
       69+    4064           %KV_SUBSTR (ID=KV_PRMID_TEXTEDIT, OFFSET=EDTCTL_TEXTEDIT#, TYPE=BITCND);
       70+    4084           %KV_SUBSTR (ID=KV_PRMID_EASYAPPEND, OFFSET=EDTCTL_EASYAPPEND#, TYPE=BITCND);
       71+    4104           %KV_SUBSTR (ID=KV_PRMID_KEYTYP, OFFSET=EDTCTL_KEYTYPE#, TYPE=BYTCND);
       72+    4124           %KV_SUBSTR (ID=KV_PRMID_VRTSCRMRG, OFFSET=EDTCTL_VSMARGIN#, TYPE=BYTCND);
       73+    4144           %KV_SUBSTR (ID=KV_PRMID_VRTSCRSHF, OFFSET=EDTCTL_VSSHIFT#, TYPE=BYTCND);
       74+    4164           %KV_SUBSTR (ID=KV_PRMID_KEYINC, OFFSET=EDTCTL_KEYINCR#, TYPE=OTHER);
       75+    4184           %KV_SUBSTR (ID=KV_PRMID_ONESPCEDT, OFFSET=EDTCTL_ONESPACEEDIT#, TYPE=BITCND);
       76+    4204        %KV_PARM (ID=KV_PRMID_EDTRHT, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_EDTRHT#);
       77+    4244        %KV_PARM (ID=KV_PRMID_ENBENTEXTSRDCHR, TYPE=BIT, STR=SRD, OFFSET=
              4244            KV$SRD_ENBENTEXTSRDCHR#);
       78+    4284        %KV_PARM (ID=KV_PRMID_ENTSRDCHR, TYPE=SHRBFR, STR=SRD, OFFSET=KV$SRD_ENTSRDCHR$#,
       79+    4285                 BFRTYP=KV_STRTYP_ENTSRD, BFRLNG=1);
       80+    4325        %KV_PARM (ID=KV_PRMID_EOM, TYPE=STRUCT, MAX=EOM_SIZE#);
       81+    4384           %KV_SUBSTR (ID=KV_PRMID_DMN, OFFSET=EOM_DMN#, TYPE=BYT);
       82+    4404           %KV_SUBSTR (ID=KV_PRMID_USRHLTINH, OFFSET=EOM_SUPPHALT#, TYPE=BIT);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:4    
       83+    4424           %KV_SUBSTR (ID=KV_PRMID_REDTIMOUTPRD, OFFSET=EOM_TIMEOUT#, TYPE=BYTCND);
       84+    4444           %KV_SUBSTR (ID=KV_PRMID_REDTIMOUTPRDUNT, OFFSET=EOM_UTYPE#, TYPE=BIN2);
       85+    4464           %KV_SUBSTR (ID=KV_PRMID_ACTCHRSET, OFFSET=EOM_TABLE#, TYPE=BFR);
       86+    4484        %KV_PARM (ID=KV_PRMID_EASYAPPEND, TYPE=BIT, STR=SVD, OFFSET=KV$RCRLST_ESYAPP#);
       87+    4524        %KV_PARM (ID=KV_PRMID_FCNTBL, STR=MVD, OFFSET=KV$MVD_SSTINPFNCTBL$#,
       88+    4525                 TYPE=SHRBFR, BFRTYP=KV_STRTYP_SSTINPFNCTBL, BFRLNG=8);
       89+    4565        %KV_PARM (ID=KV_PRMID_FF_FLUSH, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_FF_FLUSH#);
       90+    4605        %KV_PARM (ID=KV_PRMID_FF_INCCR, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_FF_INCCR#);
       91+    4645        %KV_PARM (ID=KV_PRMID_FIRSTLINE, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_FRSLIN#);
       92+    4685        %KV_PARM (ID=KV_PRMID_FOREIGN, TYPE=USRPRM);
       93+    4725        %KV_PARM (ID=KV_PRMID_FULLDUPLEXPAPERTAPE, TYPE=BIT, STR=VDI, OFFSET=
              4725            KV$VDI_FULLDUPLEXPAPERTAPE#);
       94+    4765        %KV_PARM (ID=KV_PRMID_HALFDUPLEXPAPERTAPE, TYPE=BIT, STR=VDI, OFFSET=
              4765            KV$VDI_HALFDUPLEXPAPERTAPE#);
       95+    4805        %KV_PARM (ID=KV_PRMID_HARDWIRE, TYPE=OTHER);
       96+    4845        %KV_PARM (ID=KV_PRMID_HBRDCHR, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_HBRDCHR#,
       97+    4846                 MIN=32, MAX=255);
       98+    4886        %KV_PARM (ID=KV_PRMID_HBRDSIZ, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_HBRDSIZ#-4,
       99+    4887                  MIN=1, MAX=15);
      100+    4927        %KV_PARM (ID=KV_PRMID_HRZSCR, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_HRZSCR#);
      101+    4967        %KV_PARM (ID=KV_PRMID_HRZSCRALL, TYPE=BIT, STR=SVD, OFFSET=KV$RCRLST_HRZSCRALL#);
      102+    5007        %KV_PARM (ID=KV_PRMID_HRZSCRMRG, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_HRZSCRMRGINT#);
      103+    5047        %KV_PARM (ID=KV_PRMID_HRZSCRSHF, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_HRZSCRSHF#);
      104+    5087        %KV_PARM (ID=KV_PRMID_INPTAB, TYPE=SHRBFR, STR=MVD, OFFSET=KV$MVD_INPTAB$#,
      105+    5088                 BFRTYP=KV_STRTYP_INPTAB, BFRLNG=1);
      106+    5128        %KV_PARM (ID=KV_PRMID_INPUT, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_INPUT#);
      107+    5168        %KV_PARM (ID=KV_PRMID_INSMOD, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_INSMOD#);
      108+    5208        %KV_PARM (ID=KV_PRMID_KEPTYP, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_KEPTYP#);
      109+    5248        %KV_PARM (ID=KV_PRMID_KEYDEFS, TYPE=OTHER, STR=MRD);
      110+    5288        %KV_PARM (ID=KV_PRMID_KEYINC, TYPE=WORD, STR=SVD, OFFSET=KV$RCRLST_KEYINC#,
      111+    5289                 MAX=65535, MIN=1);
      112+    5329        %KV_PARM (ID=KV_PRMID_KEYTYP, TYPE=BYTE, STR=SVD, OFFSET=KV$RCRLST_KEYTYP#);
      113+    5369        %KV_PARM (ID=KV_PRMID_LFISNL, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_LFISNL#);
      114+    5409        %KV_PARM (ID=KV_PRMID_LFTBRD, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_LFTBRD#);
      115+    5449        %KV_PARM (ID=KV_PRMID_LIMBO, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_LMB#);
      116+    5489        %KV_PARM (ID=KV_PRMID_LIMBOCLM, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_LIMBOCLM#);
      117+    5529        %KV_PARM (ID=KV_PRMID_LINEATTR, TYPE=STRUCT, MAX="(LINEATTR_DEVICE#+32)");
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:5    
      118+    5588           %KV_SUBSTR (ID=KV_PRMID_MULTIDEVICE, OFFSET=LINEATTR_MULTIDEVICE#, TYPE=BIT);
      119+    5608           %KV_SUBSTR (ID=KV_PRMID_HARDWIRE, OFFSET=LINEATTR_HARDWIRE#, TYPE=BIT);
      120+    5628           %KV_SUBSTR (ID=KV_PRMID_FOREIGN, OFFSET=LINEATTR_FOREIGN#, TYPE=BIT);
      121+    5648           %KV_SUBSTR (ID=KV_PRMID_MCRFPL, OFFSET=LINEATTR_MICROFPL#, TYPE=BIT);
      122+    5668           %KV_SUBSTR (ID=KV_PRMID_CRTLINSPD, OFFSET=LINEATTR_LINESPEED#, TYPE=BYT);
      123+    5688           %KV_SUBSTR (ID=KV_PRMID_PRFNAM, OFFSET=LINEATTR_PROFILE#, TYPE=BFR);
      124+    5708           %KV_SUBSTR (ID=KV_PRMID_NODE, OFFSET=LINEATTR_NODE#, TYPE=BFR);
      125+    5728           %KV_SUBSTR (ID=KV_PRMID_PORT, OFFSET=LINEATTR_PORT#, TYPE=BFR);
      126+    5748           %KV_SUBSTR (ID=KV_PRMID_DEVCTL, OFFSET=LINEATTR_CONTROLLER#, TYPE=BFR);
      127+    5768           %KV_SUBSTR (ID=KV_PRMID_DEVNUM, OFFSET=LINEATTR_DEVICE#, TYPE=BFR);
      128+    5788        %KV_PARM (ID=KV_PRMID_LINES, TYPE=STRUCT, MAX=16*2);
      129+    5847           %KV_SUBSTR (ID=KV_PRMID_LINES, TYPE=OTHER);
      130+    5867        %KV_PARM (ID=KV_PRMID_LOCALECHO, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_LOCALECHO#);
      131+    5907        %KV_PARM (ID=KV_PRMID_LOWERCASE, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_LOWERCASE#);
      132+    5947        %KV_PARM (ID=KV_PRMID_LOWERCASEPRINTS, TYPE=BIT, STR=MRD, OFFSET=
              5947            KV$MRD_LOWERCASEPRINTS#);
      133+    5987        %KV_PARM (ID=KV_PRMID_LPI, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_LPI#);
      134+    6027        %KV_PARM (ID=KV_PRMID_MAXATRS, TYPE=BYTE, STR=MRD, OFFSET=KV$MRD_MAXATRPERLIN#);
      135+    6067        %KV_PARM (ID=KV_PRMID_MCRFPL, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_MCRFPL#);
      136+    6107        %KV_PARM (ID=KV_PRMID_MINEDTBFRSIZ, TYPE=BYTE, STR=SSN, OFFSET=KV$SSN_MINEDTBFRSIZ#)
              6107            ;
      137+    6147        %KV_PARM (ID=KV_PRMID_MINLNG, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_MINLNG#);
      138+    6187        %KV_PARM (ID=KV_PRMID_MINREC, TYPE=OTHER);
      139+    6227        %KV_PARM (ID=KV_PRMID_MINWDT, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_MINWDT#);
      140+    6267        %KV_PARM (ID=KV_PRMID_MRDLNG, TYPE=BYTE, STR=MRD, OFFSET=KV$MRD_LNG#);
      141+    6307        %KV_PARM (ID=KV_PRMID_MRDWDT, TYPE=WORD, STR=MRD, OFFSET=KV$MRD_WDT#, MIN=1);
      142+    6347        %KV_PARM (ID=KV_PRMID_MSGHLT, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_MSGHLT#);
      143+    6387        %KV_PARM (ID=KV_PRMID_MSGLIN, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_MSGLIN#);
      144+    6427        %KV_PARM (ID=KV_PRMID_MULTIDEVICE, TYPE=OTHER);
      145+    6467        %KV_PARM (ID=KV_PRMID_MVDLNG, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_LNG#);
      146+    6507        %KV_PARM (ID=KV_PRMID_MVDWDT, TYPE=WORD, STR=MVD, OFFSET=KV$MVD_WDT#, MIN=1);
      147+    6547        %KV_PARM (ID=KV_PRMID_NODE, TYPE=OTHER);
      148+    6587        %KV_PARM (ID=KV_PRMID_NOOPTMIZ, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_NOOPTMIZ#);
      149+    6627        %KV_PARM (ID=KV_PRMID_NO_FLDTRM, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_NO_FLDTRM#);
      150+    6667        %KV_PARM (ID=KV_PRMID_ONESPCEDT, TYPE=BIT, STR=SVD, OFFSET=KV$RCRLST_ONESPCEDT#);
      151+    6707        %KV_PARM (ID=KV_PRMID_OPDTAB, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_OPDTAB#);
      152+    6747        %KV_PARM (ID=KV_PRMID_OTPTAB, TYPE=SHRBFR, STR=STR, OFFSET=KV$STR_OTPTAB$#,
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:6    
      153+    6748                 BFRTYP=KV_STRTYP_OTPTAB, BFRLNG=1);
      154+    6788        %KV_PARM (ID=KV_PRMID_OUTPUT, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_OUTPUT#);
      155+    6828        %KV_PARM (ID=KV_PRMID_OUTPUTDISCARD, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_OUTPUTDISCARD#
              6828            );
      156+    6868        %KV_PARM (ID=KV_PRMID_OVRSTR, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_OVRSTR#);
      157+    6908        %KV_PARM (ID=KV_PRMID_PAGEHALT, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_PAGEHALT#);
      158+    6948        %KV_PARM (ID=KV_PRMID_PARITY, TYPE=BYTE, STR=VDI, OFFSET=KV$VDI_PRTTYP#, MAX=4);
      159+    6988        %KV_PARM (ID=KV_PRMID_PARITYCHECK, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_PRTCHK#);
      160+    7028        %KV_PARM (ID=KV_PRMID_PLATEN, TYPE=STRUCT, MAX="(PLATEN_LPI#+8)");
      161+    7087           %KV_SUBSTR (ID=1, OFFSET=PLATEN_EXTWID#, TYPE=EXTBIT);
      162+    7107           %KV_SUBSTR (ID=KV_PRMID_MVDWDT, OFFSET=PLATEN_WIDTH#, TYPE=BYTCND);
      163+    7127           %KV_SUBSTR (ID=KV_PRMID_MVDLNG, OFFSET=PLATEN_LENGTH#, TYPE=BYTCND);
      164+    7147           %KV_SUBSTR (ID=KV_PRMID_LIMBO, OFFSET=PLATEN_LIMBO#, TYPE=BYTCND);
      165+    7167           %KV_SUBSTR (ID=KV_PRMID_FIRSTLINE, OFFSET=PLATEN_FIRSTLINE#, TYPE=BYTCND);
      166+    7187           %KV_SUBSTR (ID=KV_PRMID_LPI, OFFSET=PLATEN_LPI#, TYPE=BYTCND);
      167+    7207        %KV_PARM (ID=KV_PRMID_PORT, TYPE=OTHER);
      168+    7247        %KV_PARM (ID=KV_PRMID_PRFNAM, TYPE=TEXT, STR=MRD, OFFSET=KV$MRD_PRFNAM#,
      169+    7248                 BFRLNG=12);
      170+    7288        %KV_PARM (ID=KV_PRMID_PRINTHALT, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_PRINTHALT#);
      171+    7328        %KV_PARM (ID=KV_PRMID_PRINTTYPE, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_PRINTTYPE#);
      172+    7368        %KV_PARM (ID=KV_PRMID_PRKCRS, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_PRKCRS#);
      173+    7408        %KV_PARM (ID=KV_PRMID_PRM, TYPE=SHRBFR, STR=STR, OFFSET=KV$STR_PRM$#,
      174+    7409                 BFRTYP=KV_STRTYP_PRM, BFRLNG=1);
      175+    7449        %KV_PARM (ID=KV_PRMID_PROFILE, TYPE=STRUCT);
      176+    7508           %KV_SUBSTR (ID=KV_PRMID_PRFNAM, OFFSET=0, TYPE=BFR);
      177+    7528        %KV_PARM (ID=KV_PRMID_PROGDTAB, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_PROGDTAB#);
      178+    7568        %KV_PARM (ID=KV_PRMID_PROMPT, TYPE=STRUCT, MAX=0);
      179+    7627           %KV_SUBSTR (ID=KV_PRMID_DMN, OFFSET=PROMPT_DMN#, TYPE=BYT);
      180+    7647           %KV_SUBSTR (ID=KV_PRMID_PRM, OFFSET=PROMPT_VFC#, TYPE=BFR);
      181+    7667        %KV_PARM (ID=KV_PRMID_RCRWRAP, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_RCRWRAP#);
      182+    7707        %KV_PARM (ID=KV_PRMID_REDTIMOUTPRD, TYPE=BYTE, STR=STR, OFFSET=KV$STR_REDTIMOUTPRD#)
              7707            ;
      183+    7747        %KV_PARM (ID=KV_PRMID_REDTIMOUTPRDUNT, TYPE=BYTE, STR=STR, OFFSET=
              7747            KV$STR_REDTIMOUTPRDUNT#, MAX=2);
      184+    7787        %KV_PARM (ID=KV_PRMID_RELPAGE, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_RELPAGE#);
      185+    7827        %KV_PARM (ID=KV_PRMID_REREADCLM, TYPE=WORD, STR=STR, OFFSET=KV$STR_RE_REDCLM#);
      186+    7867        %KV_PARM (ID=KV_PRMID_RETYPOVR, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_RETYPOVR#);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:7    
      187+    7907        %KV_PARM (ID=KV_PRMID_RHTBRD, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_RHTBRD#);
      188+    7947        %KV_PARM (ID=KV_PRMID_SAVCTL, TYPE=STRUCT, MAX=8*8); /* 8 BYTES */
      189+    8006           %KV_SUBSTR (ID=KV_PRMID_DMN, OFFSET=0, TYPE=BYT);
      190+    8026           %KV_SUBSTR (ID=KV_PRMID_HRZSCRMRG, OFFSET=16, TYPE=BYT);
      191+    8046           %KV_SUBSTR (ID=KV_PRMID_HRZSCRSHF, OFFSET=24, TYPE=BYT);
      192+    8066           %KV_SUBSTR (ID=KV_PRMID_AUTTABCLM, OFFSET=32, TYPE=BYT);
      193+    8086           %KV_SUBSTR (ID=KV_PRMID_WRDWRPCLM, OFFSET=40, TYPE=BYT);
      194+    8106           %KV_SUBSTR (ID=KV_PRMID_HRZSCR, OFFSET=48, TYPE=BIT);
      195+    8126           %KV_SUBSTR (ID=KV_PRMID_WRDWRP, OFFSET=49, TYPE=BIT);
      196+    8146           %KV_SUBSTR (ID=KV_PRMID_TRUNCATE, OFFSET=50, TYPE=BIT);
      197+    8166           %KV_SUBSTR (ID=KV_PRMID_ENBENTEXTSRDCHR, OFFSET=51, TYPE=BIT);
      198+    8186           %KV_SUBSTR (ID=KV_PRMID_TRNUSRINPFNC, OFFSET=52, TYPE=BIT);
      199+    8206           %KV_SUBSTR (ID=KV_PRMID_ACTONTRN, OFFSET=53, TYPE=BIT);
      200+    8226           %KV_SUBSTR (ID=KV_PRMID_DISPINPUT, OFFSET=54, TYPE=BIT);
      201+    8246           %KV_SUBSTR (ID=KV_PRMID_NOOPTMIZ, OFFSET=55, TYPE=BIT);
      202+    8266           %KV_SUBSTR (ID=KV_PRMID_PRKCRS, OFFSET=56, TYPE=BIT);
      203+    8286        %KV_PARM (ID=KV_PRMID_SAVGET, TYPE=STRLST);
      204+    8345           %KV_SUBSTR (ID=KV_PRMID_SAVCTL); /* TRMCTL subset, per stream              */
      205+    8365           %KV_SUBSTR (ID=KV_PRMID_PROMPT);
      206+    8385           %KV_SUBSTR (ID=KV_PRMID_EOM, OFFSET=1); /* Skip SUPPHALT                   */
      207+    8405           %KV_SUBSTR (ID=KV_PRMID_DCBHDR);
      208+    8425           %KV_SUBSTR (ID=KV_PRMID_SSNHDR);
      209+    8445        %KV_PARM (ID=KV_PRMID_SCROLL, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_SCROLL#);
      210+    8485        %KV_PARM (ID=KV_PRMID_SDNUM, TYPE=OTHER);
      211+    8525        %KV_PARM (ID=KV_PRMID_SETUP_CHR, TYPE=OTHER, STR=MRD);
      212+    8565        %KV_PARM (ID=KV_PRMID_SIMPERF, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_SIMPERF#);
      213+    8605        %KV_PARM (ID=KV_PRMID_SINPUT, TYPE=STRUCT, MAX=0);
      214+    8664           %KV_SUBSTR (ID=KV_PRMID_DMN, OFFSET=SINPUT_DMN#, TYPE=BYT);
      215+    8684           %KV_SUBSTR (ID=KV_PRMID_REREADCLM, OFFSET=SINPUT_POSITION#, TYPE=OTHER);
      216+    8704           %KV_SUBSTR (ID=KV_PRMID_SINPUT, OFFSET=SINPUT_TXT#, TYPE=OTHER); /* ORG=SE */
      217+    8724           %KV_SUBSTR (ID=KV_PRMID_EDTBFR, OFFSET=SINPUT_TXT#, TYPE=BFR);
      218+    8744        %KV_PARM (ID=KV_PRMID_SPACEINSERT, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_SPACEINSERT#);
      219+    8784        %KV_PARM (ID=KV_PRMID_SRDOPT, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_OPT#);
      220+    8824        %KV_PARM (ID=KV_PRMID_SSNHDR, TYPE=SHRBFR, STR=SSN, OFFSET=KV$SSN_SSNHDN$#,
      221+    8825                 BFRTYP=KV_STRTYP_SSNHDN, BFRLNG=6);
      222+    8865        %KV_PARM (ID=KV_PRMID_TABRELATIVE, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_TABRELATIVE#);
      223+    8905        %KV_PARM (ID=KV_PRMID_TABSIM, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_TABSIM#);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:8    
      224+    8945        %KV_PARM (ID=KV_PRMID_TEXTEDIT, TYPE=BIT, STR=SVD, OFFSET=KV$RCRLST_TXTEDT#);
      225+    8985        %KV_PARM (ID=KV_PRMID_TOPBRD, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_TOPBRD#);
      226+    9025        %KV_PARM (ID=KV_PRMID_TRMATTR, TYPE=STRUCT, MAX="(TRMATTR_MAXATRS#+16)");
      227+    9084           %KV_SUBSTR (ID=KV_PRMID_PROGDTAB, OFFSET=TRMATTR_PROGDTAB#, TYPE=BITCND);
      228+    9104           %KV_SUBSTR (ID=KV_PRMID_OPDTAB, OFFSET=TRMATTR_OPDTAB#, TYPE=BITCND);
      229+    9124           %KV_SUBSTR (ID=KV_PRMID_DEVSCROLL, OFFSET=TRMATTR_DEVSCROLL#, TYPE=BITCND);
      230+    9144           %KV_SUBSTR (ID=KV_PRMID_CURSORUP, OFFSET=TRMATTR_CURSORUP#, TYPE=BITCND);
      231+    9164           %KV_SUBSTR (ID=KV_PRMID_DEVICECR, OFFSET=TRMATTR_DEVICECR#, TYPE=BITCND);
      232+    9184           %KV_SUBSTR (ID=KV_PRMID_DEVICELF, OFFSET=TRMATTR_DEVICELF#, TYPE=BITCND);
      233+    9204           %KV_SUBSTR (ID=KV_PRMID_DEVICEBS, OFFSET=TRMATTR_DEVICEBS#, TYPE=BITCND);
      234+    9224           %KV_SUBSTR (ID=KV_PRMID_AUTONL, OFFSET=TRMATTR_AUTONL#, TYPE=BITCND);
      235+    9244           %KV_SUBSTR (ID=KV_PRMID_CRISNL, OFFSET=TRMATTR_CRISNL#, TYPE=BITCND);
      236+    9264           %KV_SUBSTR (ID=KV_PRMID_LFISNL, OFFSET=TRMATTR_LFISNL#, TYPE=BITCND);
      237+    9284           %KV_SUBSTR (ID=KV_PRMID_BLANKERASES, OFFSET=TRMATTR_BLANKERASES#, TYPE=BITCND);
      238+    9304           %KV_SUBSTR (ID=KV_PRMID_DEVPOSOPTS, OFFSET=TRMATTR_DEVPOSOPTS#, TYPE=BITCND);
      239+    9324           %KV_SUBSTR (ID=KV_PRMID_TRUOVRPRT, OFFSET=TRMATTR_TRUOVRPRT#, TYPE=BITCND);
      240+    9344           %KV_SUBSTR (ID=KV_PRMID_APL, OFFSET=TRMATTR_APL#, TYPE=BITCND);
      241+    9364           %KV_SUBSTR (ID=KV_PRMID_BIN, OFFSET=TRMATTR_BIN#, TYPE=BITCND);
      242+    9384           %KV_SUBSTR (ID=KV_PRMID_LOWERCASEPRINTS, OFFSET=TRMATTR_LOWERCASEPRINTS#, TYPE=
              9384               BITCND);
      243+    9404           %KV_SUBSTR (ID=KV_PRMID_LIMBOCLM, OFFSET=TRMATTR_LIMBOCLM#, TYPE=BITCND);
      244+    9424           %KV_SUBSTR (ID=KV_PRMID_LOCALECHO, OFFSET=TRMATTR_LOCALECHO#, TYPE=BITCND);
      245+    9444           %KV_SUBSTR (ID=KV_PRMID_PARITY, OFFSET=TRMATTR_PARITY#, TYPE=BIN3);
      246+    9464           %KV_SUBSTR (ID=KV_PRMID_INPUT, OFFSET=TRMATTR_INPUT#, TYPE=BITCND);
      247+    9484           %KV_SUBSTR (ID=KV_PRMID_OUTPUT, OFFSET=TRMATTR_OUTPUT#, TYPE=BITCND);
      248+    9504           %KV_SUBSTR (ID=KV_PRMID_PRINTTYPE, OFFSET=TRMATTR_PRINTTYPE#, TYPE=BITCND);
      249+    9524           %KV_SUBSTR (ID=KV_PRMID_TTYTYPE, OFFSET=TRMATTR_TTYTYPE#, TYPE=BITCND);
      250+    9544           %KV_SUBSTR (ID=1, OFFSET=TRMATTR_EXTWID#, TYPE=EXTBIT);
      251+    9564           %KV_SUBSTR (ID=KV_PRMID_MRDWDT, OFFSET=TRMATTR_WIDTH#, TYPE=BYTCND);
      252+    9584           %KV_SUBSTR (ID=KV_PRMID_MRDLNG, OFFSET=TRMATTR_HEIGHT#, TYPE=BYTCND);
      253+    9604           %KV_SUBSTR (ID=KV_PRMID_MINREC, OFFSET=TRMATTR_MINREC#, TYPE=BYTCND);
      254+    9624           %KV_SUBSTR (ID=KV_PRMID_CRTLINSPD, OFFSET=TRMATTR_SPEED#, TYPE=BYTCND);
      255+    9644           %KV_SUBSTR (ID=KV_PRMID_CHARSETNAME, OFFSET=TRMATTR_CHARSETNAME#, TYPE=BFR);
      256+    9664           %KV_SUBSTR (ID=KV_PRMID_FCNTBL, OFFSET=TRMATTR_FCNTBL#, TYPE=BFR);
      257+    9684           %KV_SUBSTR (ID=KV_PRMID_NO_FLDTRM, OFFSET=TRMATTR_NO_FLDTRM#, TYPE=BITCND);
      258+    9704           %KV_SUBSTR (ID=KV_PRMID_ATRSCRNPOS, OFFSET=TRMATTR_ATRSCRNPOS#, TYPE=BITCND);
      259+    9724           %KV_SUBSTR (ID=KV_PRMID_STRDON, OFFSET=TRMATTR_C00FPT#, TYPE=EXTBIT);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:9    
      260+    9744           %KV_SUBSTR (ID=KV_PRMID_DVCFLWCTRALG, OFFSET=TRMATTR_DVCFLWCTRALG#, TYPE=BIN3);
      261+    9764           %KV_SUBSTR (ID=KV_PRMID_MAXATRS, OFFSET=TRMATTR_MAXATRS#, TYPE=BYTCND);
      262+    9784           %KV_SUBSTR (ID=KV_PRMID_DCHMOVFLD, OFFSET=TRMATTR_DCHMOVFLD#, TYPE=BITCND);
      263+    9804           %KV_SUBSTR (ID=KV_PRMID_DSPHEIGHT, OFFSET=TRMATTR_DSPHEIGHT#, TYPE=BYTCND);
      264+    9824           %KV_SUBSTR (ID=KV_PRMID_FF_FLUSH, OFFSET=TRMATTR_FF_FLUSH#, TYPE=BITCND);
      265+    9844           %KV_SUBSTR (ID=KV_PRMID_FF_INCCR, OFFSET=TRMATTR_FF_INCCR#, TYPE=BITCND);
      266+    9864           %KV_SUBSTR (ID=KV_PRMID_MCRFPL, OFFSET=TRMATTR_MICROFPL#, TYPE=BITCND);
      267+    9884        %KV_PARM (ID=KV_PRMID_TRMCTL, TYPE=STRUCT, MAX="(128)");
      268+    9943           %KV_SUBSTR (ID=KV_PRMID_DISPINPUT, OFFSET=TRMCTL_DISPINPUT#, TYPE=BITCND);
      269+    9963           %KV_SUBSTR (ID=KV_PRMID_PARITYCHECK, OFFSET=TRMCTL_PARITYCHECK#, TYPE=BITCND);
      270+    9983           %KV_SUBSTR (ID=KV_PRMID_OUTPUTDISCARD, OFFSET=TRMCTL_OUTPUTDISCARD#, TYPE=BITCND)
              9983               ;
      271+   10003           %KV_SUBSTR (ID=KV_PRMID_FULLDUPLEXPAPERTAPE, OFFSET=TRMCTL_FULLDUXPAPERTAPE#,
             10003               TYPE=BITCND);
      272+   10023           %KV_SUBSTR (ID=KV_PRMID_HALFDUPLEXPAPERTAPE, OFFSET=TRMCTL_HALFDUXPAPERTAPE#,
             10023               TYPE=BITCND);
      273+   10043           %KV_SUBSTR (ID=KV_PRMID_ACTONTRN, OFFSET=TRMCTL_ACTONTRN#, TYPE=BITCND);
      274+   10063           %KV_SUBSTR (ID=KV_PRMID_RETYPOVR, OFFSET=TRMCTL_RETYPOVR#, TYPE=BITCND);
      275+   10083           %KV_SUBSTR (ID=KV_PRMID_EDITOVR, OFFSET=TRMCTL_EDITOVR#, TYPE=BITCND);
      276+   10103           %KV_SUBSTR (ID=KV_PRMID_SCROLL, OFFSET=TRMCTL_SCROLL#, TYPE=BITCND);
      277+   10123           %KV_SUBSTR (ID=KV_PRMID_PAGEHALT, OFFSET=TRMCTL_PAGEHALT#, TYPE=BITCND);
      278+   10143           %KV_SUBSTR (ID=KV_PRMID_PRINTHALT, OFFSET=TRMCTL_PRINTHALT#, TYPE=BITCND);
      279+   10163           %KV_SUBSTR (ID=KV_PRMID_RELPAGE, OFFSET=TRMCTL_RELPAGE#, TYPE=BITCND);
      280+   10183           %KV_SUBSTR (ID=KV_PRMID_SIMPERF, OFFSET=TRMCTL_SIMPERF#, TYPE=BITCND);
      281+   10203           %KV_SUBSTR (ID=KV_PRMID_TABSIM, OFFSET=TRMCTL_TABSIM#, TYPE=BITCND);
      282+   10223           %KV_SUBSTR (ID=KV_PRMID_TABRELATIVE, OFFSET=TRMCTL_TABRELATIVE#, TYPE=BITCND);
      283+   10243           %KV_SUBSTR (ID=KV_PRMID_SPACEINSERT, OFFSET=TRMCTL_SPACEINSERT#, TYPE=BITCND);
      284+   10263           %KV_SUBSTR (ID=KV_PRMID_OVRSTR, OFFSET=TRMCTL_SENDBKSPACE#, TYPE=BITCND);
      285+   10283           %KV_SUBSTR (ID=KV_PRMID_UPPERCASE, OFFSET=TRMCTL_UPPERCASE#, TYPE=BITCND);
      286+   10303           %KV_SUBSTR (ID=KV_PRMID_LOWERCASE, OFFSET=TRMCTL_LOWERCASE#, TYPE=BITCND);
      287+   10323           %KV_SUBSTR (ID=KV_PRMID_APLLCNRM, OFFSET=TRMCTL_APLLCNRM#, TYPE=BITCND);
      288+   10343           %KV_SUBSTR (ID=KV_PRMID_NOOPTMIZ, OFFSET=TRMCTL_NOOPTMIZ#, TYPE=BITCND);
      289+   10363           %KV_SUBSTR (ID=KV_PRMID_WRPPAG, OFFSET=TRMCTL_WRAPPAGE#, TYPE=BITCND);
      290+   10383           %KV_SUBSTR (ID=KV_PRMID_MINEDTBFRSIZ, OFFSET=TRMCTL_SINPUTSZ#, TYPE=BYTCND);
      291+   10403           %KV_SUBSTR (ID=KV_PRMID_BRKCNT, OFFSET=TRMCTL_BREAKCOUNT#, TYPE=BYTCND);
      292+   10423           %KV_SUBSTR (ID=KV_PRMID_INSMOD, OFFSET=TRMCTL_INSERTMODE#, TYPE=BITCND);
      293+   10443           %KV_SUBSTR (ID=KV_PRMID_MSGHLT, OFFSET=TRMCTL_MSGHALT#, TYPE=BITCND);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:10   
      294+   10463           %KV_SUBSTR (ID=KV_PRMID_STRDON, OFFSET=TRMCTL_C00FPT#, TYPE=EXTBIT);
      295+   10483           %KV_SUBSTR (ID=KV_PRMID_MSGLIN, OFFSET=TRMCTL_MSGLINE#, TYPE=BITCND);
      296+   10503           %KV_SUBSTR (ID=KV_PRMID_HRZSCR, OFFSET=TRMCTL_HSCROLL#, TYPE=BITCND);
      297+   10523           %KV_SUBSTR (ID=KV_PRMID_HRZSCRMRG, OFFSET=TRMCTL_HSMARGIN#, TYPE=BYTCND);
      298+   10543           %KV_SUBSTR (ID=KV_PRMID_HRZSCRSHF, OFFSET=TRMCTL_HSSHIFT#, TYPE=BYTCND);
      299+   10563           %KV_SUBSTR (ID=KV_PRMID_TRUNCATE, OFFSET=TRMCTL_TRUNCATE#, TYPE=BITCND);
      300+   10583           %KV_SUBSTR (ID=KV_PRMID_ENBENTEXTSRDCHR, OFFSET=TRMCTL_ENBENTEXTSRDCHR#, TYPE=
             10583               BITCND);
      301+   10603           %KV_SUBSTR (ID=KV_PRMID_TRNUSRINPFNC, OFFSET=TRMCTL_TRNUSRINPFNC#, TYPE=BITCND);
      302+   10623           %KV_SUBSTR (ID=KV_PRMID_AUTTABCLM, OFFSET=TRMCTL_AUTOTABCLM#, TYPE=BYTCND);
      303+   10643           %KV_SUBSTR (ID=KV_PRMID_WRDWRP, OFFSET=TRMCTL_WORDWRAPCLM#, TYPE=BYTCND);
      304+   10663           %KV_SUBSTR (ID=KV_PRMID_WRDWRPCLM, OFFSET=TRMCTL_WORDWRAPCLM#, TYPE=BYTCND);
      305+   10683           %KV_SUBSTR (ID=KV_PRMID_PRKCRS, OFFSET=TRMCTL_PARKCURSOR#, TYPE=BITCND);
      306+   10703           %KV_SUBSTR (ID=KV_PRMID_CRSRED, OFFSET=TRMCTL_CURSORREAD#, TYPE=BITCND);
      307+   10723           %KV_SUBSTR (ID=KV_PRMID_AUTCRS, OFFSET=TRMCTL_AUTOCURSOR#, TYPE=BITCND);
      308+   10743           %KV_SUBSTR (ID=KV_PRMID_KEPTYP, OFFSET=TRMCTL_KEEPTYPAHD#, TYPE=BITCND);
      309+   10763           %KV_SUBSTR (ID=KV_PRMID_ADJTOPLFT, OFFSET=TRMCTL_ADJTOPLFT#, TYPE=BITCND);
      310+   10783        %KV_PARM (ID=KV_PRMID_TRMTAB, TYPE=SHRBFR, STR=MRD, OFFSET=KV$MRD_TRMTAB$#,
      311+   10784                 BFRTYP=KV_STRTYP_TRMTAB, BFRLNG=1);
      312+   10824        %KV_PARM (ID=KV_PRMID_TRNUSRINPFNC, TYPE=BIT, STR=STR, OFFSET=KV$STR_TRNUSRINPFNC#);
      313+   10864        %KV_PARM (ID=KV_PRMID_TRUNCATE, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_TRUNCATE#);
      314+   10904        %KV_PARM (ID=KV_PRMID_TRUOVRPRT, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_TRUOVRPRT#);
      315+   10944        %KV_PARM (ID=KV_PRMID_TTYTYPE, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_TTYTYPE#);
      316+   10984        %KV_PARM (ID=KV_PRMID_UPPERCASE, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_UPPERCASE#);
      317+   11024        %KV_PARM (ID=KV_PRMID_USRHLTINH, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_USRHLTINH#);
      318+   11064        %KV_PARM (ID=KV_PRMID_VBRDCHR, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_VBRDCHR#,
      319+   11065                 MIN=32, MAX=255);
      320+   11105        %KV_PARM (ID=KV_PRMID_VBRDSIZ, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_VBRDSIZ#-4,
      321+   11106                  MIN=1, MAX=15);
      322+   11146        %KV_PARM (ID=KV_PRMID_VFU, TYPE=SHRBFR, STR=MVD, OFFSET=KV$MVD_VFU$#,
      323+   11147                 BFRTYP=KV_STRTYP_VFU, BFRLNG=32);
      324+   11187        %KV_PARM (ID=KV_PRMID_VRTSCRMRG, TYPE=BYTE, STR=SVD, OFFSET=KV$RCRLST_VRTSCRMRG#);
      325+   11227        %KV_PARM (ID=KV_PRMID_VRTSCRSHF, TYPE=BYTE, STR=SVD, OFFSET=KV$RCRLST_VRTSCRSHF#);
      326+   11267        %KV_PARM (ID=KV_PRMID_WINDOW, TYPE=STRUCT, MAX="(WINDOW_REMOVABLE#+8)");
      327+   11326           %KV_SUBSTR (ID=KV_PRMID_WINDOW, TYPE=OTHER); /* Create it first */
      328+   11346           %KV_SUBSTR (ID=KV_PRMID_MINLNG, OFFSET=WINDOW_MINLENGTH#, TYPE=BYTCND);
      329+   11366           %KV_SUBSTR (ID=KV_PRMID_MINWDT, OFFSET=WINDOW_MINWIDTH#, TYPE=BYTCND);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:11   
      330+   11386           %KV_SUBSTR (ID=KV_PRMID_TOPBRD, OFFSET=WINDOW_TOPBRDR#, TYPE=BITCND);
      331+   11406           %KV_SUBSTR (ID=KV_PRMID_BTMBRD, OFFSET=WINDOW_BTMBRDR#, TYPE=BITCND);
      332+   11426           %KV_SUBSTR (ID=KV_PRMID_HBRDCHR, OFFSET=WINDOW_HBRDRCHR#, TYPE=BYT);
      333+   11446           %KV_SUBSTR (ID=KV_PRMID_LFTBRD, OFFSET=WINDOW_LFTBRDR#, TYPE=BITCND);
      334+   11466           %KV_SUBSTR (ID=KV_PRMID_RHTBRD, OFFSET=WINDOW_RHTBRDR#, TYPE=BITCND);
      335+   11486           %KV_SUBSTR (ID=KV_PRMID_VBRDCHR, OFFSET=WINDOW_VBRDRCHR#, TYPE=BYT);
      336+   11506           %KV_SUBSTR (ID=KV_PRMID_SRDOPT, OFFSET=WINDOW_REMOVABLE#, TYPE=BITCND);
      337+   11526           %KV_SUBSTR (ID=KV_PRMID_HBRDSIZ, OFFSET=WINDOW_HBRDRSIZ#, TYPE=BIN4);
      338+   11546           %KV_SUBSTR (ID=KV_PRMID_VBRDSIZ, OFFSET=WINDOW_VBRDRSIZ#, TYPE=BIN4);
      339+   11566           %KV_SUBSTR (ID=KV_PRMID_SRDOPT, TYPE=OTHER); /* Fix the screen if BRDUPD */
      340+   11586        %KV_PARM (ID=KV_PRMID_WRDWRP, TYPE=BIT, STR=STR, OFFSET=KV$STR_WRDWRP#);
      341+   11626        %KV_PARM (ID=KV_PRMID_WRDWRPCLM, TYPE=BYTE, STR=STR, OFFSET=KV$STR_WRDWRPCLM#);
      342+   11666        %KV_PARM (ID=KV_PRMID_WRPPAG, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_WRPPAG#);
      343+   11706        %KV_END_PARMS;
             11712    1   DCL 1 KV_PRMTBL CONSTANT SYMDEF,2 IDS CHAR(0)INIT('  \K:qL&6k  rnW |4l5` g  , jhi of
             11712        D>-%N      1}+8 _IJ^   "   u 7 $#m     	Hs*'9V { zy  ] ~bU(;e vFCPtE caQw3X d .[ZR M
             11712           O  S B  A@0   	)TpxGY    ! /  '),
             11714    1   2 TYPES CHAR(0)INIT('                                                               
             11714                                                                                            
             11714           '),2 TYPE(0:149)REDEF TYPES UBIN BYTE CALIGNED, 2 INDXS CHAR(0)INIT
             11715    1   ('            	                                       !  "#	  $%&''  () * ''+,-  .  
             11715        /   012  34567 89:; <)=	>?@ 0A2B  C DE5DFGHIJJK LMNOOx PQRSTU     #V W'),2 INDX(0:
             11715            149)REDEF INDXS UBIN BYTE CALIGNED;DCL 1 KV_WHERES CONSTANT SYMDEF,2 * CHAR(0)
             11715            INIT
             11716    1   ('  p 1H`|  Ajq   qsq}qnaC"xqr  q~q   qoqpqq  qyqvAXAiAY`xPZq q       AmPOqkAl 	p qw
             11716    1   aRq q	AZqj _  #y#z    aPqhPhqtql" A[`j Q  `hq{`}quAx`iAhaS`l  p AnA\a@A]A^PYaB1h`mqx
             11716        q|A_" 1i`o'),2 * CHAR(0)INIT(
             11716            '0< J <08p p+@;`9`8@/@,P P @)@9p, K`=`<p*p @(@  207060 `;`:P P 0:'),2 * CHAR(0)
             11716            INIT('0 @ p @ 0 ` @ @ 0 p 0   p @ ');
             11718    1   DCL 1 KV_WHERE(0:133)REDEF KV_WHERES,2 STRUCTURE UBIN(4)UNAL,2 OFFSET UBIN(12)UNAL;
             11718            DCL KV_WHROFFS(0:7)CONSTANT UBIN
             11721    1   INIT(0,0,88,120,88,120,0,0);DCL KV_MINS CONSTANT SYMDEF CHAR(0)INIT(
             11721            '                                                                ');DCL KV_MIN
             11722    1   (0:31)REDEF KV_MINS UBIN;DCL KV_MAXS CONSTANT SYMDEF CHAR(0)INIT(
             11722            '                                                                ');DCL KV_MAX
             11723    1   (0:31)REDEF KV_MAXS UBIN;DCL KV_BFRLNGS CONSTANT SYMDEF CHAR(0)INIT('  R           '
             11723            );DCL KV_BFRLNG
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:12   
             11724    1   (0:13)REDEF KV_BFRLNGS UBIN BYTE CALIGNED;DCL KV_BFRTYPS CONSTANT SYMDEF CHAR(0)INIT
             11724            ('              ');DCL
             11725    1   KV_BFRTYP(0:13)REDEF KV_BFRTYPS UBIN BYTE CALIGNED;
             11728    1   DCL 1 KV_STRS CONSTANT SYMDEF,2 * CHAR(0)INIT('                        @           
             11728    1    @  @ $        0  $          0 0 0 0 0   @    ''            0     0              0 1
             11728    1    2 3 4 5 6 7 8                @ @ 0                                      "0% ( * , .
             11728         $     	  0 0  4 2 \0]   6   X p Z                '),2 * CHAR(0)INIT('     " $ & (  
             11728                     , .     B D J H @     * F K       p r v t x  @      ` b   p r    @d@t@ 
             11728          ');DCL 1 KV_STR(0:176)REDEF
             11729    1   KV_STRS,2 TYPE UBIN(4)UNAL,2 OFFSET UBIN(12)UNAL;DCL KV_STRIDS CONSTANT SYMDEF CHAR(
             11729    1       0)INIT('           . "01# !$; >Y[Z\ ]^_9`abc      ~   * a >X >     /T )KDU3     
             11729          >    defghijklmnopqrs 	tuvwx yz{`|}(&=%',-+89 DEFIJKMNOPQRS@ABCGHLU VW  =    T ) /
             11729         3567:               ');DCL KV_STRID
             11730    1   (0:176)REDEF KV_STRIDS UBIN BYTE UNAL;
       34    11745    1   DCL MASKS(0:7) CONSTANT BIT(8) INIT('00'X,'01'X,'03'X,'07'X,'0F'X,'1F'X,'3F'X,'7F'X)
             11745            ;
       35    11746    1   DCL KV_PTR_OFFSETS(0:7) CONSTANT SBIN
       36    11747    1    INIT(0,0/*VDI*/,2/*SSN*/,4/*STR*/,6/*MVD*/,14/*SVD*/,10/*SRD*/,8/*MRD*/);
       37    11748        %PLIST;
       38    11749        %VLP_SCODE (FPTN=KVP_PRMID,STCLASS=CONSTANT,FCG=KV,MID=P,ERR#=%S$KV_PRMID);
       39    11810        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:13   
       40    11811        /* CONTEXT STRUCTURES */
       41    11812        %KV$PTR;
       42    11855        %KV$VDI;
       43    11926        %KV$SSN;
       44    12005        %KV$STR;
       45    12092        %KV$MVD;
       46    12136        %KV$SRD;
       47    12411        %KV$MRD;
       48    12458        %KV$SHRBFR;
       49    12490        %KV$TITLE;
       50    12538        %INCLUDE KV_GLBASM_E;
       51    12556        %KV$INPFNCTBL;
       52    12640        %KV$TRNTBL;
       53    12698    1   DCL KV_SND_RQSDAT_GNR UBIN SYMREF;
       54    12699        %KV$VDH_GETBFR(NAME=KV_VDH_GETBFR,STCLASS=SYMREF);
       55    12764        %KV$VDH_GETBFR;
       56    12829        %KV$VDH_OTPLCL (NAME=KV_VDH_OTPLCL_TRN, STCLASS=CONSTANT SYMDEF, TRN=YES);
       57    12902        %KV$VDH_OTPLCL;
       58    12975        %KV$VDH_RLSBFR;
       59    13011        %KV$USRPRM;
       60    13062        %KV$USR_DAT (NAME=KV_USR_DAT, STCLASS=SYMREF);
       61    13146        %KV$USR_DAT;
       62    13230        %KV$ERD (STCLASS="BASED(TEMP$)");
       63    13314        %KH$CHN;
       64    13438        %VLP_WINDOW (FPTN=WINDOW, STCLASS="BASED(STR$)");
       65    13482        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:14   
       66    13483        /* Program contained elsewhere */
       67    13484    1   DCL KHD$SCREECH ENTRY(1);
       68    13485    1   DCL KVC$DRWBRD ENTRY;
       69    13486    1   DCL KVC$WINDOW1 ENTRY(1) ALTRET;
       70    13487    1   DCL KVC$WINDOW2 ENTRY(1) ALTRET;
       71    13488    1   DCL KVE$FIXHRZSCR ENTRY ALTRET;
       72    13489    1   DCL KVE$PST ENTRY ALTRET;
       73    13490    1   DCL KVI$NEWINPFNCTBL ENTRY;
       74    13491    1   DCL KVM$SND ENTRY(1) ALTRET;
       75    13492    1   DCL KVO$OTP1_VRT ENTRY(1);
       76    13493    1   DCL KVO$OTPLCL ENTRY(1);
       77    13494    1   DCL KVP$FNCKEY ENTRY(1);
       78    13495    1   DCL KVS$GETBFR ENTRY(1) ALTRET;
       79    13496    1   DCL KVS$RLSBFR ENTRY(1) ALTRET;
       80    13497    1   DCL KVS$SETSTR ENTRY(1);
       81    13498    1   DCL KVV$CALUSR ENTRY(1) ALTRET;
       82    13499    1   DCL KVV$CALUSR_EVT ENTRY(1) ALTRET;
       83    13500    1   DCL KVV$CALUSR_PST ENTRY ALTRET;
       84    13501    1   DCL 1 BI BASED(STR$) ALIGNED,
       85    13502    1          2 T(0:0) BIT(1);
       86    13503    1   DCL 1 BYT BASED(STR$) ALIGNED,
       87    13504    1          2 E(0:0) UBIN(8) UNAL;
       88    13505    1   DCL 1 WOR BASED(STR$) ALIGNED,
       89    13506    1          2 D(0:0) UBIN;
       90    13507    1   DCL 1 PT BASED(TEMP$) ALIGNED,
       91    13508    1          2 R PTR;
       92    13509    1   DCL CHARS CHAR(255) BASED;
       93    13510        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:15   
       94    13511        /* AUTO VARIABLESS */
       95    13512    1   DCL KV$VDH_XXXPRM CHAR(I);
       96    13513        %KV$VDH_SETPRM (STCLASS=REDEF KV$VDH_XXXPRM);
       97    13575        %KV$VDH_GETPRM (STCLASS=REDEF KV$VDH_XXXPRM);
       98    13637    1   DCL STR$ PTR;
       99    13638    1   DCL TEMP$ PTR;
      100    13639        %KV$VDH_SETPRM(NAME=VDH_SETPRM,STCLASS=);
      101    13701        %KV$USR_SETPRM(NAME=USR_SETPRM REDEF VDH_SETPRM,STCLASS=);
      102    13763    1   DCL I UBIN;
      103    13764    1   DCL J UBIN;
      104    13765    1   DCL OFFSET SBIN;
      105    13766    1   DCL MAXBYTX SBIN;
      106    13767    1   DCL 1 STRLST REDEF MAXBYTX,        /* indicates many-part GETPRMS like SAVGET */
      107    13768    1          2 INDX UBIN BYTE CALIGNED,
      108    13769    1          2 SKPCNT UBIN BYTE CALIGNED;
      109    13770    1   DCL TEMP CHAR(1);                       /* **** PL6 BUG ****                  */
      110    13771    1   DCL FPT(0:15) UBIN;
      111    13772        %EQU CHRBFR=CHARTEXT('ADDR(FPT)->CHARS');
      112    13773        %EQU VDH_GETBFR=CHARTEXT('ADDR(FPT)->KV$VDH_GETBFR');
      113    13774        %EQU VDH_RLSBFR=CHARTEXT('ADDR(FPT)->KV$VDH_RLSBFR');
      114    13775        %EQU VDH_OTPLCL=CHARTEXT('ADDR(FPT)->KV$VDH_OTPLCL');
      115    13776        %EQU USR_DAT=CHARTEXT('ADDR(FPT)->KV$USR_DAT');
      116    13777        %EJECT;                                 /* CODE FOLLOWS                       */
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:16   
      117    13778    1   KVP$SETPRM: ENTRY (KV$VDH_XXXPRM);
      118    13779        /* Tell the user about it */
      119    13780    1      IF %KV_VDI.USREVTENB(%KV_USR_EVT_ID_BGNSETPRM)
      120    13781    1      THEN CALL KVV$CALUSR_EVT(%KV_USR_EVT_ID_BGNSETPRM);
      121    13782        /* Set up a local copy of SETPRM FPT */
      122    13783    1      VDH_SETPRM=KV$VDH_SETPRM;
      123    13784    1      MAXBYTX = MAXIMUM (VDH_SETPRM.VAL_.BYTX+VDH_SETPRM.VAL_.BYTSIZ, 1);
      124    13785    2      DO WHILE VDH_SETPRM.VAL_.BYTX < MAXBYTX;
      125    13786    3         IF KV$VDH_SETPRM.PRMID=%KV_PRMID_TYPLNG THEN DO;
      126    13787                                 /* We have a list of structures - as in a profile    */
      127    13788    3            VDH_SETPRM.PRMID=VDH_SETPRM.VAL_.ADR$->BYT.E(VDH_SETPRM.VAL_.BYTX);
      128    13789    3            VDH_SETPRM.VAL_.BYTSIZ=
      129    13790    3              VDH_SETPRM.VAL_.ADR$->BYT.E(VDH_SETPRM.VAL_.BYTX+1);
      130    13791    3            VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX+2;
      131    13792    3            VDH_SETPRM.VAL=VDH_SETPRM.VAL_.ADR$->WOR.D(VDH_SETPRM.VAL_.BYTX/2);
      132    13793    4            IF VDH_SETPRM.PRMID=%KV_PRMID_BIGTL THEN DO;
      133    13794    4               VDH_SETPRM.PRMID = VDH_SETPRM.VAL_.BYTSIZ;
      134    13795    4               VDH_SETPRM.VAL_.BYTSIZ = VDH_SETPRM.VAL;
      135    13796    4               VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX+2;
      136    13797    4               VDH_SETPRM.VAL=VDH_SETPRM.VAL_.ADR$->WOR.D(VDH_SETPRM.VAL_.BYTX/2);
      137    13798    4            END;
      138    13799    3         END;
      139    13800    2         ELSE MAXBYTX=0;                   /* Only one thing to do               */
      140    13801        /*N*  CALL INDEX(I,BINASC(VDH_SETPRM.PRMID),KV_PRMTBL.IDS) WHENRETURN DO;*/
      141    13802    2         TEMP=BINASC(VDH_SETPRM.PRMID);    /* **** PL6 BUG ****                  */
      142    13803    3         CALL INDEX(I,TEMP,KV_PRMTBL.IDS) WHENRETURN DO; /* **** PL6 BUG ****    */
      143    13804    3            VDH_SETPRM.DMN=0;
      144    13805    4            IF KV_PRMTBL.TYPE(I)=%PRM_TYPE_STRUCT THEN DO;
      145    13806                                 /* Got a packed structure,loop thru all the pieces   */
      146    13807
      147    13808    4               VDH_SETPRM.VAL = 0;
      148    13809    4               J=KV_PRMTBL.INDX(I);        /* Start of the structures stuff      */
      149    13810    4               STR$=PINCRW(VDH_SETPRM.VAL_.ADR$,VDH_SETPRM.VAL_.BYTX/2);
      150    13811    5   STR_LOOP:   DO WHILE '1'B;
      151    13812    5                  VDH_SETPRM.PRMID=KV_STRID(J);
      152    13813    5                  IF VDH_SETPRM.PRMID=0 THEN EXIT; /* done at zero entry         */
      153    13814    5                  OFFSET=KV_STR.OFFSET(J);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:17   
      154    13815    6                  DO CASE (KV_STR.TYPE(J));
      155    13816    6                  CASE(%PRM_STR_TYPE_BITCND);
      156    13817    6                     IF BI.T(OFFSET+1) THEN GOTO NO_PARM;
      157    13818    6                     GOTO STR_BIT;
      158    13819    6                  CASE(%PRM_STR_TYPE_BIT);
      159    13820    6   STR_BIT:          VDH_SETPRM.VAL=0;
      160    13821    6                     IF BI.T(OFFSET) THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;
      161    13822    6                  CASE(%PRM_STR_TYPE_EXTBIT);
      162    13823    6                     IF BI.T(OFFSET) THEN VDH_SETPRM.VAL=254;
      163    13824    6                     ELSE IF VDH_SETPRM.PRMID=%KV_PRMID_STRDON THEN EXIT STR_LOOP;
      164    13825    6                     GOTO EXT_XIT; /* don't do anything, just flag for next  val */
      165    13826    6                  CASE(%PRM_STR_TYPE_BYTCND);
      166    13827    7                     IF BYT.E(OFFSET)=255 THEN DO;
      167    13828    7                        IF VDH_SETPRM.PRMID=%KV_PRMID_REDTIMOUTPRD THEN J=J+1;
      168    13829        /* No value means no units,too. */
      169    13830    7                        GOTO NO_PARM;
      170    13831    7                     END;
      171    13832    6                     GOTO STR_BYTE;
      172    13833    6                  CASE(%PRM_STR_TYPE_BYT);
      173    13834    6   STR_BYTE:         VDH_SETPRM.VAL=VDH_SETPRM.VAL+BYT.E(OFFSET);
      174    13835    6                  CASE(%PRM_STR_TYPE_OTHER);
      175    13836    7                     DO SELECT VDH_SETPRM.PRMID;
      176    13837    7                        SELECT %KV_PRMID_SRDOPT;
      177    13838    7                        CALL KVC$WINDOW2 (WOR.D);
      178    13839    7                        IF %KV_SRD.BRDUPD THEN CALL KVC$DRWBRD;
      179    13840    7                        GOTO NO_PARM;
      180    13841    7                        SELECT %KV_PRMID_WINDOW;
      181    13842        /* Do the positioning if we're on the scheduled thread. */
      182    13843    7                        IF VDH_SETPRM.SCP~=%KV_SCP_ONE_ONLY THEN CALL KVS$SETSTR;
      183    13844    8                        CALL KVC$WINDOW1 (WOR.D) WHENALTRETURN DO;
      184    13845    8                           EXIT STR_LOOP;
      185    13846    8                        END;
      186    13847    7                        VDH_SETPRM.SCP = %KV_SCP_ONE_ONLY;
      187    13848    7                        SELECT %KV_PRMID_EDTCTL;
      188    13849    7                        IF %KV_MVD.ORG~=%KV#VD_ORG_SE THEN EXIT STR_LOOP;
      189    13850    7                        SELECT %KV_PRMID_SINPUT;
      190    13851    7                        IF %KV_MVD.ORG~=%KV#VD_ORG_SE
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:18   
      191    13852    7                          OR %KV_STR.ID~=VDH_SETPRM.DMN THEN GOTO NO_PARM;
      192    13853    7                        CALL KVE$PST;
      193    13854    7                        EXIT STR_LOOP;
      194    13855    7                        SELECT ELSE;
      195    13856    7                     VDH_SETPRM.VAL=WOR.D(OFFSET);
      196    13857    7                     END;
      197    13858    6                  CASE(ELSE);              /* ODD LENGTH BINARY (2 THRU 7 BITS)  */
      198    13859    6                     VDH_SETPRM.VAL=WOR.D(OFFSET/16);
      199    13860    6                     OFFSET=MOD(OFFSET,16)+KV_STR.TYPE(J);
      200    13861    7                     DO WHILE(OFFSET < 16);
      201    13862    7                        VDH_SETPRM.VAL=VDH_SETPRM.VAL/2;
      202    13863    7                        OFFSET=OFFSET+1;
      203    13864    7                     END;
      204    13865    6                     VDH_SETPRM.VAL=
      205    13866    6                       BITBIN(BINBIT(VDH_SETPRM.VAL,8)&MASKS(KV_STR.TYPE(J)));
      206    13867    6                  CASE(%PRM_STR_TYPE_BFR);
      207    13868    6                     IF VDH_SETPRM.VAL_.BYTSIZ<OFFSET THEN GOTO NO_PARM;
      208    13869    6                     VDH_SETPRM.VAL_.BYTSIZ=VDH_SETPRM.VAL_.BYTSIZ-OFFSET;
      209    13870    6                     VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX+OFFSET;
      210    13871    6                     CALL SETPTR;          /* We need to restore BYTX and BYTSIZ */
      211    13872    6                     VDH_SETPRM.VAL_.BYTSIZ=VDH_SETPRM.VAL_.BYTSIZ+OFFSET;
      212    13873    6                     VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX-OFFSET;
      213    13874    6                     GOTO NO_PARM;
      214    13875    6                  END;
      215    13876    5                  IF VDH_SETPRM.PRMID~=%KV_PRMID_DMN
      216    13877    5                  THEN CALL SETPTR;        /* do the setprm for elementary parm  */
      217    13878    5                  ELSE IF VDH_SETPRM.VAL~=0
      218    13879    5                  THEN VDH_SETPRM.DMN=VDH_SETPRM.VAL; /* Set domain.             */
      219    13880    5                  ELSE VDH_SETPRM.DMN=1;
      220    13881    5   NO_PARM:       VDH_SETPRM.VAL=0;
      221    13882    5   EXT_XIT:       J=J+1;
      222    13883    5               END;
      223    13884    4            END;
      224    13885    3            ELSE CALL SETPTR;              /* elementry parm, just do it         */
      225    13886    3         END; WHENALTRETURN DO;
      226    13887    3            IF MAXBYTX=0 THEN GOTO SCREECH; /* Single parm must exist.           */
      227    13888    3         END;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:19   
      228    13889    2         VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX+
      229    13890    2           2*((VDH_SETPRM.VAL_.BYTSIZ+1)/2);
      230    13891    2      END;
      231    13892        /* Now tell the user we're finished */
      232    13893    1      IF %KV_VDI.USREVTENB(%KV_USR_EVT_ID_ENDSETPRM)
      233    13894    1      THEN CALL KVV$CALUSR_EVT(%KV_USR_EVT_ID_ENDSETPRM);
      234    13895    1      RETURN;
      235    13896        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:20   
      236    13897        /*D* NAME: SETPTR
      237    13898        *    PURPOSE: Store elementary parameter in all copies of the
      238    13899        *             pertinent structure,as defined by VDH_SETPRM.SCP.
      239    13900        */
      240    13901    1   SETPTR: PROC;
      241    13902    2   DCL STR$ PTR;
      242    13903    2   DCL PRMID UBIN;
      243    13904    2   DCL PRMTYP UBIN;
      244    13905    2   DCL OFFSET SBIN;
      245    13906    2   DCL STRUCTURE UBIN;
      246    13907        %KV$BFRDSC (STCLASS="BASED(STR$)");
      247    13934        %KV$PRM_ABSGRPRND (NAME=PRM_ABSGRPRND, STCLASS="BASED(STR$)");
      248    13981        %KV$PTR(NAME=SAV_PTR,STCLASS=);
      249    14024    2   DCL OLDVAL UBIN;
      250    14025        /* First save the current KV$PTR */
      251    14026    2      SAV_PTR=KV$PTR;
      252    14027        /* Convert to internal PRMID */
      253    14028    2   /*N*** pl6 bug ****/ TEMP=BINASC(VDH_SETPRM.PRMID);
      254    14029    2      CALL INDEX(PRMID,TEMP,KV_PRMTBL.IDS) ALTRET(NO_STUFF);
      255    14030    2      PRMTYP=KV_PRMTBL.TYPE(PRMID);
      256    14031    2      PRMID=KV_PRMTBL.INDX(PRMID);
      257    14032    2      STRUCTURE=KV_WHERE.STRUCTURE(PRMID+KV_WHROFFS(PRMTYP));
      258    14033    2      IF STRUCTURE<%KV_SCP_MRD OR %KV_MRD.USRCNT=1
      259    14034    3      THEN DO WHILE '1'B;
      260    14035    3         OFFSET=KV_WHERE.OFFSET(PRMID+KV_WHROFFS(PRMTYP));
      261    14036    4         IF VDH_SETPRM.DMN~=0 AND VDH_SETPRM.DMN~=%KV_STR.ID THEN DO;
      262    14037        /* The request specifies stream: Find the right one */
      263    14038    4            KV$PTR.STR$=%KV_SSN.STR$;
      264    14039    5            DO WHILE %KV_STR.ID~=VDH_SETPRM.DMN;
      265    14040    5               IF %KV_STR.LNK$=ADDR(NIL) THEN GOTO NO_STUFF;
      266    14041    5               KV$PTR.STR$=%KV_STR.LNK$;
      267    14042    5            END;
      268    14043    4            KV$PTR.MVD$=%KV_STR.MVD$;
      269    14044    4            KV$PTR.MRD$=%KV_MVD.SRD$->KV$SRD.MRD$;
      270    14045    4            KV$PTR.SRD$=%KV_MRD.SRD$;
      271    14046    4            KV$PTR.LINLST$=%KV_MVD.LINLST$;
      272    14047    4         END;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:21   
      273    14048        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:22   
      274    14049        /* Stuff away the data */
      275    14050    3         USR_SETPRM.FNC=%KV_USR_FNC_SETPRM;
      276    14051    4         IF %KV_USRPRM.SETPRMPREPRC(VDH_SETPRM.PRMID) THEN DO;
      277    14052    4            USR_SETPRM.PREPRC='1'B;
      278    14053    4            CALL KVV$CALUSR(USR_SETPRM) ALTRET(NO_STUFF);
      279    14054    4         END;
      280    14055    3         TEMP$=PINCRW(ADDR(KV$PTR),KV_PTR_OFFSETS(STRUCTURE));
      281    14056    3         STR$=TEMP$->PT.R;
      282    14057    3         IF STR$=ADDR(NIL) THEN GOTO NO_STUFF;
      283    14058    3         OLDVAL=0;
      284    14059    4         DO CASE(PRMTYP);
      285    14060    4         CASE(%PRM_TYPE_BIT);
      286    14061    4            IF STR$->BI.T(OFFSET) THEN OLDVAL=1;
      287    14062    4            IF VDH_SETPRM.VAL~=0 THEN STR$->BI.T(OFFSET)='1'B;
      288    14063    4            ELSE STR$->BI.T(OFFSET)='0'B;
      289    14064    4         CASE(%PRM_TYPE_BYTE,%PRM_TYPE_WORD);
      290    14065    4            IF VDH_SETPRM.VAL < KV_MIN(PRMID) OR VDH_SETPRM.VAL > KV_MAX(PRMID)
      291    14066    4            THEN GOTO NO_STUFF;
      292    14067    5            IF PRMTYP=%PRM_TYPE_BYTE THEN DO;
      293    14068    5               OLDVAL=STR$->BYT.E(OFFSET);
      294    14069    5               STR$->BYT.E(OFFSET)=VDH_SETPRM.VAL;
      295    14070    5            END;
      296    14071    5            ELSE DO;
      297    14072    5               OLDVAL=STR$->WOR.D(OFFSET);
      298    14073    5               STR$->WOR.D(OFFSET)=VDH_SETPRM.VAL;
      299    14074    5            END;
      300    14075    4         CASE(%PRM_TYPE_TEXT);
      301    14076    4            IF VDH_SETPRM.VAL_.BYTSIZ < KV_BFRLNG(PRMID) THEN GOTO NO_STUFF;
      302    14077    4            SUBSTR(PINCRC(STR$,OFFSET)->CHARS,0,KV_BFRLNG(PRMID))=
      303    14078    4              SUBSTR(PINCRC(VDH_SETPRM.VAL_.ADR$,VDH_SETPRM.VAL_.BYTX)->
      304    14079    4              CHARS,0,KV_BFRLNG(PRMID));
      305    14080    4         CASE(%PRM_TYPE_SHRBFR);
      306    14081        /*  First check that there's enough data here */
      307    14082    4            IF VDH_SETPRM.VAL_.BYTSIZ < KV_BFRLNG(PRMID)
      308    14083    4            THEN IF VDH_SETPRM.VAL_.BYTSIZ~=0 THEN GOTO NO_STUFF;
      309    14084    4            OLDVAL=VDH_SETPRM.VAL;
      310    14085    4            %VDH_GETBFR=KV_VDH_GETBFR;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:23   
      311    14086    4            %VDH_GETBFR.STRTYP=KV_BFRTYP(PRMID);
      312    14087    5            IF VDH_SETPRM.VAL_.BYTSIZ~=0 THEN DO;
      313    14088    5               %VDH_GETBFR.DAT_=VDH_SETPRM.VAL_;
      314    14089    5               TEMP$=PINCRW(VDH_SETPRM.VAL_.ADR$,
      315    14090    5                 (VDH_SETPRM.VAL_.BYTX-SIZEC(KV$SHRBFR))/2);
      316    14091        /* HeaDeRs are a bit special - check the data some. */
      317    14092    5               IF VDH_SETPRM.PRMID=%KV_PRMID_SSNHDR
      318    14093    6                 OR VDH_SETPRM.PRMID=%KV_PRMID_DCBHDR THEN DO;
      319    14094    6                  %VDH_GETBFR.DAT_.BYTSIZ =
      320    14095    6                    TEMP$->KV$TITLE.TXTSIZ+SIZEV(KV$TITLE)-SIZEC(KV$SHRBFR);
      321    14096    6                  IF TEMP$->KV$TITLE.INDCLM=0 THEN TEMP$->KV$TITLE.INDCLM=1;
      322    14097    7                  IF TEMP$->KV$TITLE.RSTPAGNMB THEN DO;
      323    14098    7                     %KV_MVD.PAGNMB=0;
      324    14099    7                     TEMP$->KV$TITLE.RSTPAGNMB='0'B;
      325    14100    7                  END;
      326    14101    6               END;
      327    14102    6               ELSE IF VDH_SETPRM.PRMID=%KV_PRMID_CTRCHR THEN DO;
      328    14103    6                  OLDVAL=KV$ERD.CUP_CHR;
      329    14104    6                  IF OLDVAL~=0 AND KV$ERD.CNT(OLDVAL)>11
      330    14105                                 /* Overly large strings for this one make us trap.   */
      331    14106    6                  THEN KV$ERD.CNT(OLDVAL) = 11;
      332    14107    6                  IF KV$ERD.RGNSCR THEN KV$ERD.ILNRQRDLN = '1'B;
      333    14108    6               END;
      334    14109    5               IF %VDH_GETBFR.STRTYP=%KV_STRTYP_SSTINPFNCTBL
      335    14110    6                 OR %VDH_GETBFR.STRTYP=%KV_STRTYP_TRNTBL THEN DO;
      336    14111        /* Don't accept bad names for tables that are only named */
      337    14112    6                  %VDH_GETBFR.SHRBFR.ADD='0'B;
      338    14113    6                  %VDH_GETBFR.SHRBFR.GET='0'B;
      339    14114    6                  %VDH_GETBFR.DAT_.BYTSIZ=8; /* Exactly 8 chars in a name        */
      340    14115    6                  IF %VDH_GETBFR.STRTYP=%KV_STRTYP_SSTINPFNCTBL
      341    14116    7                    AND VDH_SETPRM.VAL/256=ASCBIN(':') THEN DO;
      342    14117    7                     %VDH_GETBFR.STRTYP=%KV_STRTYP_USRINPFNCTBL;
      343    14118    7                     OFFSET=OFFSET-2;
      344    14119    7                  END;
      345    14120    6               END;
      346    14121    5               CALL KVS$GETBFR(FPT) ALTRET(NO_STUFF);
      347    14122    5               TEMP$=%VDH_GETBFR.BFR$;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:24   
      348    14123    5            END;
      349    14124    4            ELSE IF %VDH_GETBFR.STRTYP=%KV_STRTYP_ACTCHR
      350    14125    4            THEN GOTO NO_STUFF;  /* Never reset ACTCHRTBL, it's always there.    */
      351    14126    4            ELSE TEMP$=ADDR(NIL);          /* 0 bytes ->reset funciton           */
      352    14127    4            STR$=PINCRW(STR$,OFFSET);
      353    14128    4            %VDH_RLSBFR.BFR$=STR$->PT.R;
      354    14129    4            IF %VDH_RLSBFR.STRTYP=%KV_STRTYP_TRNTBL
      355    14130
      356    14131        /* Don't switch from non-ASCII to ASCII translate table. */
      357    14132    4            THEN IF TEMP$->KV$TRNTBL.FNTCLS=%KV_FNTCLS_ASC
      358    14133    5              AND %VDH_RLSBFR.BFR$->KV$TRNTBL.FNTCLS~=%KV_FNTCLS_ASC THEN DO;
      359    14134    5               %VDH_RLSBFR.BFR$=TEMP$;
      360    14135    5               TEMP$=STR$->PT.R;
      361    14136    5            END;
      362    14137    4            IF %VDH_RLSBFR.BFR$~=TEMP$ THEN OLDVAL=OLDVAL+1; /* Make it differ.  */
      363    14138    4            STR$->PT.R=TEMP$;
      364    14139    5            IF %VDH_RLSBFR.STRTYP=%KV_STRTYP_REDBFR THEN DO;
      365    14140
      366    14141        /* RED buffers (EDTBFR, to be precise) are a bit different. */
      367    14142    5               OFFSET = %VDH_GETBFR.BYTSIZ;
      368    14143    5               %VDH_RLSBFR.BYTSIZ = KV$BFRDSC.BFRBYTSIZ;
      369    14144    5               KV$BFRDSC.BFRBYTSIZ = OFFSET;
      370    14145    5               KV$BFRDSC.DATBYTSIZ = %VDH_GETBFR.DAT_.BYTSIZ;
      371    14146    5               KV$BFRDSC.BYTX = 0;
      372    14147    5               KV$BFRDSC.STRTYP = %KV_STRTYP_REDBFR;
      373    14148    5               IF KV$BFRDSC.BFRRLSDSP~=%KV_BFRRLSDSP_MSG
      374    14149    5               THEN %VDH_RLSBFR.BFR$ = ADDR(NIL);
      375    14150    5               KV$BFRDSC.BFRRLSDSP = %KV_BFRRLSDSP_MSG;
      376    14151    5               %KV_SSN.LSTEDTBFRSTRID = %KV_STR.ID;
      377    14152    5            END;
      378    14153    4            OFFSET=-OFFSET;
      379    14154    4            STR$=PINCRW(STR$,OFFSET);
      380    14155    4            IF %VDH_RLSBFR.BFR$~=ADDR(NIL) THEN CALL KVS$RLSBFR(FPT);
      381    14156    4         CASE(%PRM_TYPE_OTHER);
      382    14157    5            DO SELECT(VDH_SETPRM.PRMID);
      383    14158    5               SELECT(%KV_PRMID_ABSGRPRND);
      384    14159    5               STR$ = PINCRW(VDH_SETPRM.VAL_.ADR$,VDH_SETPRM.VAL_.BYTX/2);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:25   
      385    14160    5               %KV_MRD.ABSGRPRND(PRM_ABSGRPRND.ID) = PRM_ABSGRPRND.GRPRND;
      386    14161    5               SELECT(%KV_PRMID_KEYDEFS);
      387    14162    5               OLDVAL=VDH_SETPRM.VAL;
      388    14163    5               CALL KVP$FNCKEY (VDH_SETPRM);
      389    14164    5               SELECT(%KV_PRMID_SETUP_CHR);
      390    14165    5               OLDVAL=VDH_SETPRM.VAL;
      391    14166    5               IF VDH_SETPRM.VAL_.BYTSIZ=0 THEN EXIT;
      392    14167    6               IF %KV_VDI.USEOTPBFRTRN THEN DO;
      393    14168    6                  %VDH_OTPLCL=KV_VDH_OTPLCL_TRN;
      394    14169    6                  %VDH_OTPLCL.BFR_=VDH_SETPRM.VAL_;
      395    14170    6                  CALL KVO$OTPLCL (FPT);
      396    14171    6               END; ELSE DO;
      397    14172    6                  %USR_DAT=KV_USR_DAT;
      398    14173    6                  %USR_DAT.DAT__=VDH_SETPRM.VAL_;
      399    14174    6                  %USR_DAT.DATMOD=%KV#DATMOD_TRN;
      400    14175    6                  CALL KVV$CALUSR (FPT);
      401    14176    6               END;
      402    14177    5            END;
      403    14178    4         END;
      404    14179    3         IF (OLDVAL~=VDH_SETPRM.VAL
      405    14180    3           OR VDH_SETPRM.PRMID=%KV_PRMID_MRDLNG) /* Always set PHSFRM            */
      406    14181        /* Make some equates for where the parameter just went */
      407    14182        %EQU Y_MRD=CHARTEXT('STR$->KV$MRD');
      408    14183        %EQU Y_SRD=CHARTEXT('STR$->KV$SRD');
      409    14184        %EQU Y_MVD=CHARTEXT('STR$->KV$MVD');
      410    14185        %EQU Y_STR=CHARTEXT('STR$->KV$STR');
      411    14186        %EQU Y_SMRD=CHARTEXT('STR$->KV$SRD.MRD$->KV$MRD');
      412    14187        %EQU Y_SSN=CHARTEXT('STR$->KV$SSN');
      413    14188        /* And load up a pointer to it. */
      414    14189    3           AND STR$~=KV$PTR.FLD$
      415    14190    4         THEN DO CASE(VDH_SETPRM.PRMID);
      416    14191                                      /* Process interrelationships if there are any  */
      417    14192    4         CASE(%KV_PRMID_APLLCNRM);
      418    14193    4            TEMP$ = %KV_USRPRM.TRNTBLHEDPTR$;
      419    14194    4            IF TEMP$~=ADDR(NIL)
      420    14195    5            THEN DO WHILE TEMP$->KV$TRNTBL.LNK$~=ADDR(NIL);
      421    14196    5               TEMP$ = TEMP$->KV$TRNTBL.LNK$;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:26   
      422    14197    5               IF TEMP$->KV$TRNTBL.FNTCLS=%Y_MVD.TRNTBL$->KV$TRNTBL.FNTCLS
      423    14198    5                 AND TEMP$->KV$TRNTBL.PRTAPL\%Y_MVD.TRNTBL$->KV$TRNTBL.PRTAPL
      424    14199    5                 AND NOT TEMP$->KV$TRNTBL.PRTAPL\%Y_MVD.APLLCNRM
      425    14200    5               THEN %Y_MVD.TRNTBL$=TEMP$;
      426    14201    5            END;
      427    14202    4         CASE(%KV_PRMID_BLANKERASES);
      428    14203    4            IF %Y_MRD.FSTERS OR %Y_MRD.BLANKERASES THEN %Y_MRD.CTNFRM='0'B;
      429    14204    4            ELSE %Y_MRD.CTNFRM='1'B;
      430    14205    4            IF %Y_MRD.ERD$~=ADDR(NIL)
      431    14206    4            THEN IF %Y_MRD.ERD$->KV$ERD.ED2_CHR~=0 THEN %Y_MRD.CTNFRM='0'B;
      432    14207    4         CASE(%KV_PRMID_CTRCHR);
      433    14208    4            IF KV$ERD.EL0_CHR~=0 OR KV$ERD.ED0_CHR~=0 THEN %Y_MRD.FSTERS='1'B;
      434    14209    4            ELSE %Y_MRD.FSTERS='0'B;
      435    14210    4            IF %Y_MRD.FSTERS OR %Y_MRD.BLANKERASES OR KV$ERD.ED2_CHR~=0
      436    14211    4            THEN %Y_MRD.CTNFRM='0'B;
      437    14212    4            ELSE %Y_MRD.CTNFRM='1'B;
      438    14213    4            IF KV$ERD.CUU_CHR~=0 OR KV$ERD.CUP_ALG~=0 THEN %Y_MRD.CURSORUP='1'B;
      439    14214    4            ELSE %Y_MRD.CURSORUP='0'B;
      440    14215    4            IF KV$ERD.ILN_CHR~=0 AND KV$ERD.DLN_CHR~=0 THEN %Y_MRD.VRTSCR='1'B;
      441    14216    4            ELSE %Y_MRD.VRTSCR='0'B;
      442    14217    5            IF %KV_SRD.WDT=%Y_MRD.WDT THEN DO;
      443    14218    5               %KV_SRD.VRTSCR=%Y_MRD.VRTSCR;
      444    14219    5               %KV_SRD.FSTERS=%Y_MRD.FSTERS;
      445    14220    5            END;
      446    14221    4            IF KV$ERD.ICH_CHR~=0 AND KV$ERD.DCH_CHR~=0 THEN %Y_MRD.HRZSCR='1'B;
      447    14222    4            ELSE %Y_MRD.HRZSCR='0'B;
      448    14223    4            %Y_MRD.FRSCLMFLD=KV$ERD.FRSCLMFLD;
      449    14224    4            IF KV$ERD.MSGLIN_CHR=0 OR KV$ERD.ENDMSGLIN_CHR=0
      450    14225    4            THEN %Y_MRD.MSGLIN='0'B;
      451    14226    4            ELSE %Y_MRD.MSGLIN='1'B;
      452    14227    4            IF KV$ERD.SGRHDN_CHR=BINASC(0) THEN %Y_MRD.SMLHDNATR='1'B;
      453    14228    4            ELSE %Y_MRD.SMLHDNATR='0'B;
      454    14229    4            IF KV$ERD.DCLFLD_ALG=3 THEN %Y_MRD.DCLATRWHNOTP='1'B;
      455    14230    4            ELSE %Y_MRD.DCLATRWHNOTP='0'B;
      456    14231    4         CASE(%KV_PRMID_CURSORUP);
      457    14232    4            IF NOT %Y_MRD.CALUSR_PST
      458    14233    4            THEN %Y_MRD.CURSORUP=BINBIT(OLDVAL,1);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:27   
      459    14234    4         CASE(%KV_PRMID_FCNTBL);
      460    14235    4            CALL KVI$NEWINPFNCTBL;
      461    14236    4         CASE(%KV_PRMID_FULLDUPLEXPAPERTAPE,%KV_PRMID_HALFDUPLEXPAPERTAPE);
      462    14237    4            IF OLDVAL=1 AND NOT %KV_SSN.REDRQSPND
      463    14238    4            THEN CALL KVO$OTP1_VRT ('11'X);
      464    14239    4            IF VDH_SETPRM.PRMID=%KV_PRMID_FULLDUPLEXPAPERTAPE THEN EXIT;
      465    14240    4            STR$=KV$PTR.SSN$;
      466    14241    4            GOTO SET_THROT;
      467    14242    4         CASE(%KV_PRMID_OUTPUT);
      468    14243    4            IF OLDVAL=1 THEN %KV_VDI.RQSOTP = '0'B;
      469    14244    4            STR$=KV$PTR.SSN$;
      470    14245    4            GOTO SET_THROT;
      471    14246    4         CASE(%KV_PRMID_OUTPUTDISCARD);
      472    14247    4   SET_THROT:;
      473    14248    4            %Y_SSN.OTPBLK='1'B;
      474    14249    4            CALL KVM$SND (KV_SND_RQSDAT_GNR);
      475    14250    4         CASE(%KV_PRMID_HRZSCR);
      476    14251    4            IF %Y_MVD.ORG<%KV#VD_ORG_FORM THEN GOTO HRZINS;
      477    14252    4            ELSE IF %Y_MVD.ORG=%KV#VD_ORG_SE THEN CALL KVE$FIXHRZSCR;
      478    14253    4            ELSE /* IF ORG=FORM */ %Y_MVD.HRZSCR='0'B;
      479    14254    4         CASE(%KV_PRMID_RETYPOVR,%KV_PRMID_EDITOVR);
      480    14255    4            IF %Y_MVD.ORG<%KV#VD_ORG_FORM THEN GOTO HRZINS;
      481    14256        /* Keep them on if they started that way */
      482    14257    4            STR$->BI.T(OFFSET)='1'B;
      483    14258    4         CASE(%KV_PRMID_INSMOD);
      484    14259    4   HRZINS:  ;
      485    14260    5            IF NOT %Y_MVD.RETYPOVR OR NOT %Y_MVD.EDITOVR THEN DO;
      486    14261    5               %Y_MVD.INSMOD='0'B;
      487    14262    5               %Y_MVD.HRZSCR='0'B;
      488    14263    5            END;
      489    14264    4         CASE(%KV_PRMID_MVDLNG,%KV_PRMID_LIMBO,%KV_PRMID_FIRSTLINE);
      490    14265    5            IF NOT %KV_MRD.PHSFRM THEN DO;
      491    14266                            /* This is a variable-length device,set other lengths     */
      492    14267    5               OFFSET=255;
      493    14268    5               OLDVAL=%KV_MRD.LNG;
      494    14269    5               GOTO SETLNG;
      495    14270    5            END;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:28   
      496    14271    4         CASE(%KV_PRMID_MINLNG,%KV_PRMID_MINWDT);
      497    14272    4            IF %KV_MVD.ORG=%KV#VD_ORG_FORM
      498    14273    4            THEN STR$->BYT.E(OFFSET)=OLDVAL;
      499    14274    4         CASE(%KV_PRMID_SRDOPT);
      500    14275    4            IF %KV_MVD.ORG=%KV#VD_ORG_FORM
      501    14276    4            THEN STR$->KV$SRD.OPT='0'B;
      502    14277    4         CASE(%KV_PRMID_PAGEHALT, %KV_PRMID_NOOPTMIZ, %KV_PRMID_TRUNCATE);
      503    14278    4            IF %KV_MVD.ORG>=%KV#VD_ORG_FORM
      504    14279    4            THEN STR$->BI.T(OFFSET)='0'B;
      505    14280    4         CASE(%KV_PRMID_TOPBRD,%KV_PRMID_BTMBRD,
      506    14281    4              %KV_PRMID_LFTBRD,%KV_PRMID_RHTBRD,
      507    14282    4              %KV_PRMID_HBRDCHR,%KV_PRMID_VBRDCHR);
      508    14283    4            %KV_SRD.BRDUPD='1'B;
      509    14284    4         CASE(%KV_PRMID_HBRDSIZ,%KV_PRMID_VBRDSIZ);
      510    14285    4            STR$->BYT.E(OFFSET)=OLDVAL;
      511    14286    4            OLDVAL=MOD(OLDVAL,16);
      512    14287    5            IF OLDVAL~=VDH_SETPRM.VAL THEN DO;
      513    14288    5               STR$->BYT.E(OFFSET)=STR$->BYT.E(OFFSET)+VDH_SETPRM.VAL-OLDVAL;
      514    14289    5               STR$->KV$SRD.BRDUPD='1'B;
      515    14290    5            END;
      516    14291    4         CASE(%KV_PRMID_WRPPAG);
      517    14292    4            IF NOT %Y_SRD.SCROLL AND OLDVAL~=0 THEN GOTO SETPST;
      518    14293    4         CASE(%KV_PRMID_OTPTAB);
      519    14294                                                /* First tab stop is MARGIN value     */
      520    14295    4            OFFSET=VDH_SETPRM.VAL/256;
      521    14296    4            IF OFFSET=0 OR OFFSET=255 OR OFFSET>=%KV_SRD.WDT
      522    14297    4              OR OFFSET=%KV_STR.LFTMRGCLM THEN EXIT;
      523    14298    4            %KV_SRD.LFTMRGCLM=OFFSET;
      524    14299    4            %KV_MVD.WDT = %KV_MVD.WDT+%Y_STR.LFTMRGCLM-OFFSET;
      525    14300    4            %Y_STR.LFTMRGCLM=OFFSET;
      526    14301    4            GOTO SETWDT;
      527    14302    4         CASE (%KV_PRMID_MRDWDT);
      528    14303    5            IF %KV_SRD.TOPLFT.CLM>VDH_SETPRM.VAL THEN DO;
      529    14304        /* Attempting to reduce MRD to less than an SRD, dont do it. */
      530    14305
      531    14306    5               VDH_SETPRM.VAL=OLDVAL;
      532    14307    5               %Y_MRD.WDT=OLDVAL;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:29   
      533    14308    5            END;
      534    14309    4            %KV_SRD.SRDEND.CLM=%Y_MRD.WDT;
      535    14310    4            GOTO SETWDT;
      536    14311    4         CASE (%KV_PRMID_MVDWDT);
      537    14312    4   SETWDT:  ;
      538    14313    4            STR$=KV$PTR.SRD$;
      539    14314    4            OFFSET=%Y_SRD.SRDEND.CLM-%Y_SRD.ORG.CLM;
      540    14315    4            IF %Y_SRD.LFTBRD THEN OFFSET=OFFSET-%Y_SRD.VBRDSIZ;
      541    14316    4            IF %Y_SRD.LFTMRGCLM>1 THEN OFFSET=OFFSET-%Y_SRD.LFTMRGCLM+1;
      542    14317    5            IF OFFSET<0 THEN DO;
      543    14318    5               OFFSET=%Y_SRD.SRDEND.CLM-%Y_SRD.ORG.CLM;
      544    14319    5               %Y_SRD.TOPLFT.CLM=%Y_SRD.ORG.CLM+1;
      545    14320    5            END; ELSE DO;
      546    14321    5               %Y_SRD.TOPLFT.CLM=%Y_SRD.SRDEND.CLM-OFFSET+1;
      547    14322    5               IF %Y_SRD.RHTBRD THEN OFFSET=OFFSET-%Y_SRD.VBRDSIZ;
      548    14323    5               IF OFFSET<0 THEN OFFSET=0;
      549    14324    5            END;
      550    14325    4            IF %KV_MVD.WDT > OFFSET THEN %KV_MVD.WDT=OFFSET;
      551    14326    4            %Y_SRD.WDT=%KV_MVD.WDT;
      552    14327    4            %Y_SRD.BTMRHT.CLM=%Y_SRD.WDT-1+%Y_SRD.TOPLFT.CLM;
      553    14328    4         CASE(%KV_PRMID_DSPHEIGHT);
      554    14329    4            OFFSET=%Y_MRD.LNG;
      555    14330    4            IF VDH_SETPRM.VAL=0 THEN %Y_MRD.DSPHEIGHT=OFFSET;
      556    14331    4            IF VDH_SETPRM.VAL=0 AND OFFSET=OLDVAL THEN EXIT;
      557    14332    4            OLDVAL=1;                      /* Force SETLNG to do something       */
      558    14333    4            GOTO SETLNG;
      559    14334    4         CASE(%KV_PRMID_MRDLNG);
      560    14335    4            OFFSET=%Y_MRD.LNG;
      561    14336    4            %Y_MRD.DSPHEIGHT=OFFSET;
      562    14337    5            IF OFFSET=0 THEN DO;
      563    14338    5               OFFSET=255;
      564    14339    5               %Y_MRD.LNG=OFFSET;
      565    14340    5               %Y_MRD.PHSFRM='0'B;
      566    14341    5            END;
      567    14342    4            ELSE %Y_MRD.PHSFRM='1'B;
      568    14343    4   SETLNG:  ;
      569    14344    4            STR$=KV$PTR.SRD$;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:30   
      570    14345    4            IF NOT %Y_SMRD.PHSFRM AND %KV_MVD.LNG>=12
      571    14346    4            THEN OFFSET=%KV_MVD.LNG+%KV_MVD.FRSLIN+%KV_MVD.LMB;
      572    14347    4            IF OFFSET=OLDVAL OR %Y_SMRD.USRCNT>1 OR %Y_SRD.USRCNT>1 THEN EXIT;
      573    14348    4            %Y_SMRD.LNG=OFFSET;
      574    14349    4            %Y_SRD.BTMRHT.LIN=OFFSET;
      575    14350    4            %Y_SRD.SRDEND.LIN=OFFSET;
      576    14351    4            IF %Y_SMRD.DSPHEIGHT=0 OR %Y_SMRD.DSPHEIGHT>OFFSET
      577    14352    4              OR %Y_SMRD.CTNFRM OR NOT %Y_SMRD.PHSFRM
      578    14353    4            THEN %Y_SMRD.DSPHEIGHT=OFFSET;
      579    14354    4            %Y_SRD.ORG.LIN=OFFSET-%Y_SMRD.DSPHEIGHT;
      580    14355    4            %Y_SRD.TOPLFT.LIN=%Y_SRD.ORG.LIN+1;
      581    14356    4            %Y_SRD.LNG=%Y_SRD.BTMRHT.LIN-%Y_SRD.ORG.LIN;
      582    14357    4            IF OLDVAL~=0 THEN GOTO SETPST; /* Adjust position to a legal spot    */
      583    14358    4         CASE(%KV_PRMID_SCROLL);
      584    14359    4            IF %KV_MVD.ORG<%KV#VD_ORG_FORM
      585    14360    4            THEN %Y_SRD.SAVSCROLL=%Y_SRD.SCROLL;
      586    14361    4            ELSE IF %KV_MVD.RETYPOVR THEN %Y_SRD.SCROLL='0'B;
      587    14362    4            IF NOT %Y_SRD.VRTSCR THEN %Y_SRD.SCROLL='0'B;
      588    14363    4            IF %Y_SRD.SCROLL OR OLDVAL~=0 THEN GOTO SETPST;
      589    14364    4         CASE(%KV_PRMID_DEVSCROLL);
      590    14365    4            STR$=KV$PTR.SRD$;
      591    14366    5            IF OLDVAL~=0 THEN DO;
      592    14367    5               %Y_SRD.SCROLL='0'B;
      593    14368    5               %Y_SRD.SAVSCROLL='0'B;
      594    14369    5            END;
      595    14370    4            ELSE IF NOT %Y_SRD.BRDEXS THEN %Y_SRD.VRTSCR = '1'B;
      596    14371    4   SETPST:  ;
      597    14372    4            IF NOT %Y_SMRD.PRINTTYPE THEN EXIT;
      598    14373    4            %Y_SRD.VRTPSTOK = '0'B;
      599    14374    4            %KV_VDI.UN_KNWPST='1'B;
      600    14375    5            IF %Y_SRD.SCROLL THEN DO;
      601    14376    5               IF %KV_VDI.INPUNT~=%KV_INPUNT_BLK THEN %Y_SRD.FLDEND='0'B;
      602    14377    5               %Y_SRD.CRT.LIN=%Y_SRD.TOPLFT.LIN;
      603    14378    5               %Y_SRD.CRTVRTLINPHSLIN=%Y_SRD.CRT.LIN;
      604    14379    5               %Y_SRD.NXTNONBLNLIN = 256;
      605    14380    5            END;
      606    14381    5            ELSE DO;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:31   
      607    14382    5               %KV_MVD.FRMLIN = MAXIMUM(%KV_MVD.LNG,1)-1;
      608    14383    5               %Y_SRD.CRT.LIN = %Y_SRD.BTMRHT.LIN;
      609    14384    5               IF NOT %Y_SRD.WRPPAG
      610    14385    5               THEN %Y_SRD.NXTNONBLNLIN = 256;
      611    14386    5               %Y_SRD.CRTVRTLINPHSLIN=%Y_SRD.CRT.LIN+1;
      612    14387    5            END;
      613    14388    4            %Y_SRD.HI_NONBLN.LIN=%Y_SRD.CRT.LIN;
      614    14389    4            %Y_SRD.DVCLINBIS=%Y_SRD.BTMRHT.LIN-%Y_SRD.CRT.LIN;
      615    14390    4            IF %Y_SMRD.DVCLIN > %Y_SMRD.LNG OR NOT %Y_SMRD.PHSFRM
      616    14391    4            THEN %Y_SMRD.DVCLIN=%Y_SMRD.LNG;
      617    14392    4         END;
      618    14393    4         IF %KV_USRPRM.SETPRMPSTPRC(VDH_SETPRM.PRMID) THEN DO;
      619    14394    4            USR_SETPRM.PREPRC='0'B;
      620    14395    4            CALL KVV$CALUSR(USR_SETPRM);
      621    14396    4         END;
      622    14397    3         IF STRUCTURE<=VDH_SETPRM.SCP OR VDH_SETPRM.DMN~=0 THEN EXIT;
      623    14398    3         IF KV$PTR.VDI$=ADDR(NIL) THEN TEMP$=ADDR(NIL);ELSE TEMP$ = ADDR(NIL);
      624    14399    3         IF STRUCTURE>=%KV_SCP_MRD THEN EXIT;
      625    14400    3         IF TEMP$=ADDR(NIL)
      626    14401    3         THEN IF VDH_SETPRM.SCP>=%KV_SCP_SRD THEN GOTO NO_STUFF;
      627    14402    4         ELSE DO;
      628    14403        /*N* We only want to link thru SRDs if SCP is specified from the
      629    14404             "MRD" end.  Likewise, don't link through the STRs unless SCP
      630    14405             is from the "SSN" end.   At present, SCP is always from the
      631    14406             "SSN" end, so this code is disabled.
      632    14407                 IF STRUCTURE>=%KV_SCP_SRD THEN TEMP$=%KV_SRD.LNK$;
      633    14408        */
      634    14409    4            IF TEMP$=ADDR(NIL)
      635    14410    4            THEN IF VDH_SETPRM.SCP>=%KV_SCP_MVD THEN GOTO NO_STUFF;
      636    14411    5            ELSE DO;
      637    14412        /*N* Likewise.
      638    14413                    IF STRUCTURE >= %KV_SCP_MVD THEN TEMP$=%KV_MVD.LNK$;
      639    14414        */
      640    14415    5               IF TEMP$=ADDR(NIL)
      641    14416    5               THEN IF VDH_SETPRM.SCP>=%KV_SCP_STR THEN GOTO NO_STUFF;
      642    14417    6               ELSE DO;
      643    14418    6                  IF STRUCTURE >= %KV_SCP_STR THEN TEMP$=%KV_STR.LNK$;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:32   
      644    14419    6                  IF TEMP$=ADDR(NIL)
      645    14420    6                  THEN IF VDH_SETPRM.SCP>=%KV_SCP_SSN THEN GOTO NO_STUFF;
      646    14421    7                  ELSE DO;
      647    14422    7                     IF STRUCTURE >= %KV_SCP_SSN THEN TEMP$=%KV_SSN.LNK$;
      648    14423    7                     IF TEMP$=ADDR(NIL) THEN GOTO NO_STUFF;
      649    14424    7                     KV$PTR.SSN$=TEMP$;
      650    14425    7                     TEMP$=%KV_SSN.STR$;
      651    14426    7                  END;
      652    14427    6                  IF STRUCTURE < %KV_SCP_STR THEN EXIT;
      653    14428    6                  KV$PTR.STR$=TEMP$;
      654    14429    6                  TEMP$=%KV_STR.MVD$;
      655    14430    6               END;
      656    14431    5               IF STRUCTURE < %KV_SCP_MVD THEN EXIT;
      657    14432    5               KV$PTR.MVD$=TEMP$;
      658    14433    5               TEMP$=%KV_MVD.SRD$;
      659    14434    5            END;
      660    14435    4            IF STRUCTURE < %KV_SCP_SRD THEN EXIT;
      661    14436    4            KV$PTR.SRD$=TEMP$;
      662    14437    4            TEMP$=%KV_SRD.MRD$;
      663    14438    4         END;
      664    14439    3         IF STRUCTURE>=%KV_SCP_MRD THEN KV$PTR.MRD$=TEMP$;
      665    14440    3         IF TEMP$=ADDR(NIL) OR STRUCTURE=0 THEN EXIT;
      666    14441    3         KV$PTR.LINLST$=%KV_MVD.LINLST$;
      667    14442    3      END;
      668    14443    2   NO_STUFF:;
      669    14444    2      KV$PTR=SAV_PTR;
      670    14445    2      RETURN;
      671    14446    2   END SETPTR;
      672    14447        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:33   
      673    14448        /*F*  NAME: KVP$GETPRM.
      674    14449              PURPOSE: Returns the value of a parameter, or a group thereof,
      675    14450                       or a list of groups thereof.
      676    14451              DESCRIPTION: Runs the same tables as KVP$SETPRM, but backwards,
      677    14452                           stuffing the parameter values into the FPT or a
      678    14453                           buffer allocated to return them.
      679    14454        */
      680    14455    1   KVP$GETPRM: ENTRY (KV$VDH_XXXPRM);
      681    14456        /* We'll put he current PRMID into I, and do this loop until it goes to 0 */
      682    14457    1      I=KV$VDH_GETPRM.PRMID;
      683    14458    1      STR$=ADDR(NIL);                      /* No current output buffer           */
      684    14459    1      TEMP$=ADDR(NIL);           /* For saving the stream pointer when changed   */
      685    14460    1      STRLST='0'B;
      686    14461    2      DO WHILE I~=0;
      687    14462        /*N*  CALL INDEX (I,BINASC(I),KV_PRMTBL.IDS) ALTRET(SCREECH); PL6 BUG */
      688    14463    2         TEMP=BINASC (I);
      689    14464    2         CALL INDEX (I,TEMP,KV_PRMTBL.IDS) ALTRET(SCREECH); /* END OF *N*/
      690    14465    2         IF KV_PRMTBL.TYPE(I)~=%PRM_TYPE_STRUCT
      691    14466    3           AND KV_PRMTBL.TYPE(I)~=%PRM_TYPE_STRLST THEN DO;
      692    14467        /* We have an elementary parameter request */
      693    14468
      694    14469    3            VDH_SETPRM.PRMID=ASCBIN(SUBSTR(KV_PRMTBL.IDS,I,1));
      695    14470    3            CALL GETPRM;
      696    14471    3            IF VDH_SETPRM.VAL_.BYTSIZ~=0
      697    14472    3            THEN IF KV$VDH_GETPRM.VAL_.ADR$=ADDR(NIL) AND NOT STRLST
      698    14473    3            THEN KV$VDH_GETPRM.VAL_=VDH_SETPRM.VAL_;
      699    14474    4            ELSE DO;
      700    14475    4               OFFSET=VDH_SETPRM.VAL_.BYTSIZ;
      701    14476    5               CALL GETSPACE WHENALTRETURN DO;
      702    14477    5                  KV$VDH_GETPRM.BFRLMTEXC='1'B;
      703    14478    5                  RETURN;
      704    14479    5               END;
      705    14480    4               SUBSTR(STR$->CHARS,0,OFFSET)=SUBSTR(VDH_SETPRM.VAL_.ADR$->CHARS,
      706    14481    4                 VDH_SETPRM.VAL_.BYTX,OFFSET);
      707    14482    4            END;
      708    14483    3            IF STRLST THEN GOTO NXTMLT;
      709    14484    3            KV$VDH_GETPRM.VAL=VDH_SETPRM.VAL;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:34   
      710    14485    3            RETURN;
      711    14486    3         END;
      712    14487        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:35   
      713    14488    3         IF KV_PRMTBL.TYPE(I)=%PRM_TYPE_STRUCT THEN DO;
      714    14489        /* A simple structure, build it from its parts. */
      715    14490
      716    14491    3            J=KV_PRMTBL.INDX(I);
      717    14492    3            IF KV_STRID(J)=%KV_PRMID_DMN
      718    14493        /* Run through all the streams if this is a STRLST */
      719    14494
      720    14495    4              AND STRLST THEN DO;
      721    14496    5               IF TEMP$=ADDR(NIL) THEN DO;
      722    14497    5                  TEMP$=KV$PTR.STR$;
      723    14498    5                  KV$PTR.STR$=%KV_SSN.STR$;
      724    14499    5               END;
      725    14500    5               ELSE DO;
      726    14501    5                  IF %KV_STR.LNK$~=ADDR(NIL) THEN KV$PTR.STR$=%KV_STR.LNK$;
      727    14502    6                  ELSE DO;
      728    14503    6                     KV$PTR.STR$=TEMP$;
      729    14504    6                     TEMP$=ADDR(NIL);
      730    14505    6                     GOTO NXTMLT;
      731    14506    6                  END;
      732    14507    5               END;
      733    14508    4               IF KV_STRID(STRLST.INDX)=%KV_PRMID_SINPUT
      734    14509    4                 AND NOT %KV_STR.RE_RED THEN GOTO NXTMLT;
      735    14510    4            END;
      736    14511    3            OFFSET=KV_STR.OFFSET(J-1);     /* Get the size of the structure      */
      737    14512    4            CALL GETSPACE WHENALTRETURN DO;
      738    14513    4               IF TEMP$~=ADDR(NIL) THEN KV$PTR.STR$=TEMP$;
      739    14514    4               KV$VDH_GETPRM.BFRLMTEXC='1'B;
      740    14515    4               RETURN;
      741    14516    4            END;
      742    14517    4   GET_LOOP:DO WHILE '1'B;
      743    14518    4               VDH_SETPRM.PRMID=KV_STRID(J);
      744    14519    4               IF VDH_SETPRM.PRMID=0 THEN EXIT;
      745    14520    4               IF KV_STR.TYPE(J)=%PRM_STR_TYPE_EXTBIT
      746    14521        /* Get the real data. Split it up in the store. */
      747    14522
      748    14523    5               THEN DO;
      749    14524    5                  VDH_SETPRM.PRMID=KV_STRID(J+1);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:36   
      750    14525    6                  IF KV_STRID(J)=%KV_PRMID_STRDON THEN DO;
      751    14526    6                     BI.T(KV_STR.OFFSET(J))='1'B;
      752    14527    6                     J=J+1;
      753    14528    6                  END;
      754    14529    5               END;
      755    14530    5               IF STRLST.SKPCNT>0 AND VDH_SETPRM.PRMID~=%KV_PRMID_DMN THEN DO;
      756    14531        /* We're still skipping items. */
      757    14532
      758    14533    5                  STRLST.SKPCNT=STRLST.SKPCNT-1;
      759    14534    6                  DO SELECT(KV_STR.TYPE(J));
      760    14535    6                     SELECT (%PRM_STR_TYPE_BITCND);
      761    14536    6                     VDH_SETPRM.VAL=2;
      762    14537    6                     SELECT (%PRM_STR_TYPE_BYTCND);
      763    14538    6                     VDH_SETPRM.VAL=511;
      764    14539    6                     SELECT (ELSE);
      765    14540    6                  VDH_SETPRM.VAL=0;
      766    14541    6                  VDH_SETPRM.VAL_.BYTSIZ=0;
      767    14542    6                  END;
      768    14543    5               END;
      769    14544    4               ELSE CALL GETPRM;
      770    14545        /* Got the value, now put it somewhere */
      771    14546
      772    14547    4               IF BI.T(KV_STR.OFFSET(J)) THEN OFFSET=0; /* DUMMY TO LOAD REGS    */
      773    14548    4               OFFSET=KV_STR.OFFSET(J);
      774    14549    5               DO CASE (KV_STR.TYPE(J));
      775    14550    5               CASE(%PRM_STR_TYPE_BITCND);
      776    14551    5                  IF VDH_SETPRM.VAL=2 THEN BI.T(OFFSET+1)='1'B;
      777    14552    5                  ELSE BI.T(OFFSET+1)='0'B;
      778    14553    5                  GOTO GET_BIT;
      779    14554    5               CASE(%PRM_STR_TYPE_BIT);
      780    14555    5   GET_BIT:       IF VDH_SETPRM.VAL=1 THEN BI.T(OFFSET)='1'B;
      781    14556    5                  ELSE BI.T(OFFSET)='0'B;
      782    14557    5               CASE(%PRM_STR_TYPE_EXTBIT);
      783    14558    6                  IF VDH_SETPRM.VAL>254 AND VDH_SETPRM.VAL<511 THEN DO;
      784    14559    6                     VDH_SETPRM.VAL=VDH_SETPRM.VAL-254;
      785    14560    6                     BI.T(OFFSET)='1'B;
      786    14561    6                  END;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:37   
      787    14562    5                  ELSE BI.T(OFFSET)='0'B;
      788    14563    5                  J=J+1;
      789    14564    5                  OFFSET=KV_STR.OFFSET(J);
      790    14565    5                  GOTO GET_BYT;
      791    14566    5               CASE(%PRM_STR_TYPE_BYT, %PRM_STR_TYPE_BYTCND);
      792    14567    5   GET_BYT:       BYT.E(OFFSET)=VDH_SETPRM.VAL;
      793    14568    5               CASE(%PRM_STR_TYPE_OTHER);
      794    14569    6                  DO SELECT VDH_SETPRM.PRMID;
      795    14570    6                     SELECT ELSE;
      796    14571    6                  WOR.D(OFFSET)=VDH_SETPRM.VAL;
      797    14572    6                  SELECT %KV_PRMID_LINES;
      798    14573    6                  IF %KV_MVD.PAGNMB=0 OR %KV_MVD.LNG<12 THEN EXIT;
      799    14574    6                  WOR.D(0)=%KV_MVD.LNG-%KV_MVD.FRMLIN;
      800    14575    6                  WOR.D(1)=%KV_MVD.PAGNMB;
      801    14576    6                  SELECT %KV_PRMID_SINPUT, /* Dummies so we don't trash WOR.D(0) */
      802    14577    6                    %KV_PRMID_SRDOPT;
      803    14578    6                  SELECT %KV_PRMID_EDTCTL;
      804    14579    6                  IF %KV_MVD.ORG~=%KV#VD_ORG_SE THEN EXIT GET_LOOP;
      805    14580    6                  SELECT %KV_PRMID_WINDOW;
      806    14581        /* Do the things that require calculation. */
      807    14582    6                  WINDOW.LENGTH=%KV_SRD.SRDEND.LIN-%KV_SRD.ORG.LIN;
      808    14583    6                  WINDOW.WIDTH=%KV_SRD.SRDEND.CLM-%KV_SRD.ORG.CLM;
      809    14584    6                  WINDOW.ORG_PST.LINE=%KV_SRD.ORG.LIN+1;
      810    14585    6                  WINDOW.ORG_PST.COLUMN=%KV_SRD.ORG.CLM+1;
      811    14586    6                  END;
      812    14587    5               CASE(%PRM_STR_TYPE_BFR);
      813    14588    5                  SUBSTR(STR$->CHARS,OFFSET,VDH_SETPRM.VAL_.BYTSIZ)=
      814    14589    5                    SUBSTR(VDH_SETPRM.VAL_.ADR$->CHARS,
      815    14590    5                    VDH_SETPRM.VAL_.BYTX,VDH_SETPRM.VAL_.BYTSIZ);
      816    14591    5               CASE(ELSE);                 /* Odd length ubin                    */
      817    14592    5                  VDH_SETPRM.VAL=
      818    14593    5                    BITBIN(BINBIT(VDH_SETPRM.VAL,8)&MASKS(KV_STR.TYPE(J)));
      819    14594    5                  OFFSET=OFFSET+KV_STR.TYPE(J);
      820    14595    6                  DO WHILE BINBIT(OFFSET,4);
      821    14596    6                     VDH_SETPRM.VAL=VDH_SETPRM.VAL+VDH_SETPRM.VAL;
      822    14597    6                     OFFSET=OFFSET+1;
      823    14598    6                  END;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:38   
      824    14599    5                  OFFSET=OFFSET/16-1;
      825    14600    5                  WOR.D(OFFSET)=WOR.D(OFFSET)+VDH_SETPRM.VAL;
      826    14601    5               END;
      827    14602    4               J=J+1;
      828    14603    4            END;
      829    14604    3         END;
      830    14605    3         ELSE IF KV_PRMTBL.TYPE(I)=%PRM_TYPE_STRLST THEN DO;
      831    14606    3            STRLST.INDX=KV_PRMTBL.INDX(I)-1;
      832    14607    3            GOTO NXTMLT;
      833    14608    3         END;
      834    14609    3         IF STRLST THEN DO;
      835    14610    3   NXTMLT:  IF TEMP$=ADDR(NIL) THEN STRLST.INDX=STRLST.INDX+1;
      836    14611    3            I=KV_STRID(STRLST.INDX);
      837    14612    3            STRLST.SKPCNT=KV_STR.OFFSET(STRLST.INDX);
      838    14613    3         END;
      839    14614    2         ELSE I=0;
      840    14615    2      END;
      841    14616    1      IF TEMP$~=ADDR(NIL) THEN KV$PTR.STR$=TEMP$;
      842    14617    1      RETURN;
      843    14618        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:39   
      844    14619        /*I* NAME: GETPRM.
      845    14620             PURPOSE: Moves the value (or a vector framing it) to VDH_SETPRM,
      846    14621                      for the elementary parameter VDH_SETPRM.PRMID.
      847    14622        */
      848    14623    1   GETPRM: PROC;
      849    14624    2   DCL KH_NODE# UBIN SYMREF;
      850    14625    2   DCL PRM$ PTR;
      851    14626    2   DCL PRMID UBIN;
      852    14627    2   DCL PRMTYP UBIN;
      853    14628    2   DCL OFFSET SBIN;
      854    14629    2   DCL HEXES CHAR(16) CONSTANT INIT('0123456789ABCDEF');
      855    14630    2   DCL 1 HEXVAL BASED ALIGNED,
      856    14631    2          2 V0 UBIN(4) UNAL,
      857    14632    2          2 V1 UBIN(4) UNAL,
      858    14633    2          2 V2 UBIN(4) UNAL,
      859    14634    2          2 V3 UBIN(4) UNAL;
      860    14635        %EQU VHEX=CHARTEXT('ADDR(VDH_SETPRM.VAL)->HEXVAL');
      861    14636        %KV$BFRDSC;
      862    14663        /* Initialize the answer(s) */
      863    14664
      864    14665    2      VDH_SETPRM.VAL=0;
      865    14666    2      VDH_SETPRM.VAL_='0'B;
      866    14667        /* Convert to internal PRMID. */
      867    14668        /*N* PL6 BUg: CALL INDEX (PRMID, BINASC(VDH_SETPRM.PRMID), */
      868    14669    2      TEMP=BINASC(VDH_SETPRM.PRMID);
      869    14670    2      CALL INDEX (PRMID,TEMP,              /* END OF BUG                         */
      870    14671    3        KV_PRMTBL.IDS) WHENALTRETURN DO; RETURN; END;
      871    14672    2      PRMTYP=KV_PRMTBL.TYPE(PRMID);
      872    14673    2      PRMID=KV_PRMTBL.INDX(PRMID)+KV_WHROFFS(PRMTYP);
      873    14674    2      PRM$=PINCRW(ADDR(KV$PTR),KV_PTR_OFFSETS(KV_WHERE.STRUCTURE(PRMID)))->PT.R;
      874    14675    2      IF PRM$=ADDR(NIL) THEN RETURN;
      875    14676    2      OFFSET=KV_WHERE.OFFSET(PRMID);
      876    14677    3      DO CASE (PRMTYP);
      877    14678    3      CASE(%PRM_TYPE_BIT);
      878    14679    3         IF PRM$->BI.T(OFFSET) THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;
      879    14680    3      CASE(%PRM_TYPE_BYTE);
      880    14681    3         VDH_SETPRM.VAL=PRM$->BYT.E(OFFSET);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:40   
      881    14682    3      CASE(%PRM_TYPE_WORD);
      882    14683    3         VDH_SETPRM.VAL=PRM$->WOR.D(OFFSET);
      883    14684    3      CASE(%PRM_TYPE_TEXT);
      884    14685    3         VDH_SETPRM.VAL_.ADR$=PRM$;
      885    14686    3         VDH_SETPRM.VAL_.BYTX=OFFSET;
      886    14687    3         VDH_SETPRM.VAL_.BYTSIZ=KV_BFRLNG(PRMID-KV_WHROFFS(%PRM_TYPE_TEXT));
      887    14688    3      CASE(%PRM_TYPE_SHRBFR);
      888    14689    3         VDH_SETPRM.VAL_.ADR$=PINCRW(PRM$,OFFSET)->PT.R;
      889    14690    3         VDH_SETPRM.VAL_.BYTX=SIZEC(KV$SHRBFR);
      890    14691    3         IF VDH_SETPRM.PRMID=%KV_PRMID_FCNTBL
      891    14692    3           OR VDH_SETPRM.PRMID=%KV_PRMID_CHARSETNAME
      892    14693    3         THEN VDH_SETPRM.VAL_.BYTSIZ=8;
      893    14694    4         ELSE IF VDH_SETPRM.PRMID=%KV_PRMID_EDTBFR THEN DO;
      894    14695    4            VDH_SETPRM.VAL_.BYTX=PINCRW(PRM$,OFFSET)->KV$BFRDSC.BYTX;
      895    14696    4            VDH_SETPRM.VAL_.BYTSIZ=PINCRW(PRM$,OFFSET)->KV$BFRDSC.DATBYTSIZ;
      896    14697    4         END;
      897    14698    3         ELSE IF VDH_SETPRM.VAL_.ADR$~=ADDR(NIL)
      898    14699    3         THEN VDH_SETPRM.VAL_.BYTSIZ=
      899    14700    3           VDH_SETPRM.VAL_.ADR$->KV$SHRBFR.BYTSIZ-SIZEC(KV$SHRBFR);
      900    14701    3      CASE(%PRM_TYPE_USRPRM);
      901    14702    3         VDH_SETPRM.FNC=%KV_USR_FNC_GETPRM;
      902    14703    3         CALL KVV$CALUSR (VDH_SETPRM);
      903    14704    3      CASE(%PRM_TYPE_OTHER);
      904    14705    4         DO SELECT (VDH_SETPRM.PRMID);
      905    14706    4            SELECT (%KV_PRMID_APL);
      906    14707    4            IF %KV_MVD.TRNTBL$~=ADDR(NIL)
      907    14708    4            THEN IF %KV_MVD.TRNTBL$->KV$TRNTBL.FNTCLS=%KV_FNTCLS_APLB
      908    14709    4              OR %KV_MVD.TRNTBL$->KV$TRNTBL.FNTCLS=%KV_FNTCLS_APLT
      909    14710    4            THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;
      910    14711    4            SELECT (%KV_PRMID_HARDWIRE);
      911    14712    4            IF %KH_CHN.DRCCNC THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;
      912    14713    4            SELECT (%KV_PRMID_MULTIDEVICE);
      913    14714    4            IF %KH_CHN.TERMID.LEV>1 OR %KH_CHN.SUB$~=ADDR(NIL)
      914    14715    4            THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;
      915    14716    4            SELECT (%KV_PRMID_DEVNUM);
      916    14717    4            IF %KH_CHN.TERMID.LEV<3 THEN GOTO BLANK_4;
      917    14718    4            VDH_SETPRM.VAL=%KH_CHN.TERMID.TERM.SUBSUBDEVICE;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:41   
      918    14719    4            GOTO DEC_4;
      919    14720    4            SELECT (%KV_PRMID_DEVCTL);
      920    14721    5            IF %KH_CHN.TERMID.LEV<2 THEN DO;
      921    14722    5   BLANK_4:    SUBSTR(%CHRBFR,0,4)='    ';
      922    14723    5               GOTO CHAR_4;
      923    14724    5            END;
      924    14725    4            VDH_SETPRM.VAL=%KH_CHN.TERMID.TERM.SUBDEVICE;
      925    14726    4            GOTO DEC_4;
      926    14727    4            SELECT (%KV_PRMID_NODE);
      927    14728    4            VDH_SETPRM.VAL=KH_NODE#;
      928    14729    4   DEC_4:   ;
      929    14730    4            CALL BINCHAR (SUBSTR(%CHRBFR,0,4), VDH_SETPRM.VAL);
      930    14731    4            GOTO CHAR_4;
      931    14732    4            SELECT (%KV_PRMID_PORT);
      932    14733    4            VDH_SETPRM.VAL=%KH_CHN.TERMID.TERM.CHANNEL;
      933    14734    4            SUBSTR(%CHRBFR,0,1)=SUBSTR(HEXES,%VHEX.V0,1);
      934    14735    4            SUBSTR(%CHRBFR,1,1)=SUBSTR(HEXES,%VHEX.V1,1);
      935    14736    4            SUBSTR(%CHRBFR,2,1)=SUBSTR(HEXES,%VHEX.V2,1);
      936    14737    4            SUBSTR(%CHRBFR,3,1)=SUBSTR(HEXES,%VHEX.V3,1);
      937    14738    4   CHAR_4:  ;
      938    14739    4            VDH_SETPRM.VAL_.ADR$=ADDR(%CHRBFR);
      939    14740    4            VDH_SETPRM.VAL_.BYTSIZ=4;
      940    14741    4         END;
      941    14742    3      END;
      942    14743    2      RETURN;
      943    14744    2   END GETPRM;
      944    14745        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:42   
      945    14746        /*I* NAME: GETSPACE.
      946    14747             PURPOSE: Get space for the current SCRUCT of a GETPRM.
      947    14748             DESCRIPTION: Returns a pointer to the space in STR$. ALtrets if not.
      948    14749                          If the caller provided a buffer, only it is ever used.
      949    14750                          Otherwise, a chain of buffers is used, each limited to
      950    14751                          the callers MAXBYTSIZ or 256 bytes if that is 0.
      951    14752                          The space is initialized to zero.
      952    14753                          If we're doing a STRLST, the T/L word is initialized.
      953    14754                          If we're doing a variable-length PRM (request is zero)
      954    14755                          the first SHRBFR in the struct is used to determine the
      955    14756                          size (e.g. prompts, headers, etc.).
      956    14757                          As a result, calls GETPRM.
      957    14758                          The request size is placed in OFFSET before calling
      958    14759                          GETSPACE.
      959    14760        */
      960    14761    1   GETSPACE: PROC ALTRET;
      961    14762    2   DCL GETPRM$ PTR;
      962    14763    2   DCL K SBIN;
      963    14764    2   DCL L SBIN;
      964    14765    2   DCL 1 CLEAR BASED(STR$) ALIGNED,
      965    14766    2          2 * CHAR(OFFSET);
      966    14767        %KV$GETPRM (STCLASS="BASED(GETPRM$)");
      967    14809        %KV$GETPRM (NAME=KV_GETPRM, STCLASS=CONSTANT, STRTYP=%KV_STRTYP_MSG,
      968    14810         BFRRLSDSP = %KV_BFRRLSDSP_MSG);
      969    14852    3      IF OFFSET=0 THEN DO;
      970    14853    3         K=J;
      971    14854    4         DO WHILE KV_STR.TYPE(K)~=%PRM_STR_TYPE_BFR;
      972    14855    4            K=K+1;
      973    14856    4         END;
      974    14857    3         VDH_SETPRM.PRMID=KV_STRID(K);
      975    14858    3         CALL GETPRM;
      976    14859    3         OFFSET=KV_STR.OFFSET(K)+VDH_SETPRM.VAL_.BYTSIZ;
      977    14860    3      END;
      978    14861    2      IF STRLST THEN IF OFFSET<256 THEN OFFSET=OFFSET+2; /* allow for t/l word   */
      979    14862    2      ELSE OFFSET=OFFSET+4;
      980    14863    2      K=OFFSET;
      981    14864    2      IF BINBIT(K,1) THEN K=K+1;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:43   
      982    14865    3      IF KV$VDH_GETPRM.VAL_.ADR$~=ADDR(NIL) THEN DO;
      983    14866        /* The caller provided a buffer - use it. */
      984    14867
      985    14868    3         IF OFFSET>KV$VDH_GETPRM.VAL_.BYTSIZ-KV$VDH_GETPRM.DATBYTSIZ
      986    14869    3         THEN ALTRETURN;
      987    14870    3         STR$=PINCRW(KV$VDH_GETPRM.VAL_.ADR$,
      988    14871    3           (KV$VDH_GETPRM.VAL_.BYTX+KV$VDH_GETPRM.DATBYTSIZ)/2);
      989    14872    3         KV$VDH_GETPRM.DATBYTSIZ=KV$VDH_GETPRM.DATBYTSIZ+K;
      990    14873    3      END;
      991    14874    3      ELSE DO;
      992    14875        /* We allocate our own. */
      993    14876
      994    14877    3         GETPRM$=ADDR(KV$VDH_GETPRM.BFRHED$);
      995    14878    4         DO WHILE KV$GETPRM.LNK$~=ADDR(NIL);
      996    14879    4            GETPRM$=KV$GETPRM.LNK$;
      997    14880    4         END;
      998    14881    3         IF GETPRM$=ADDR(KV$VDH_GETPRM.BFRHED$) OR OFFSET>
      999    14882    3           KV$GETPRM.DAT__.BFRBYTSIZ-KV$GETPRM.DAT__.DATBYTSIZ-SIZEC(KV$GETPRM)
     1000    14883    4         THEN DO;
     1001    14884        /* need to get another one. */
     1002    14885
     1003    14886    4            %VDH_GETBFR=KV_VDH_GETBFR;
     1004    14887    4            %VDH_GETBFR.STRTYP=%KV_STRTYP_MSG;
     1005    14888    4            %VDH_GETBFR.SCRNO_MMR='0'B;
     1006    14889    4            IF KV$VDH_GETPRM.MAXBYTSIZ~=0
     1007    14890    4            THEN %VDH_GETBFR.BYTSIZ=KV$VDH_GETPRM.MAXBYTSIZ+SIZEC(KV$GETPRM);
     1008    14891    4            ELSE %VDH_GETBFR.BYTSIZ=256;
     1009    14892    4   /*N* TEMP TIL CTN WORKS */ IF KV$VDH_GETPRM.BFRHED$~=ADDR(NIL) THEN ALTRETURN;
     1010    14893    4            IF OFFSET>%VDH_GETBFR.BYTSIZ-SIZEC(KV$GETPRM) THEN ALTRETURN;
     1011    14894        /* Won't fit anyway, don't bother. */
     1012    14895
     1013    14896    5            CALL KVS$GETBFR (FPT) WHENALTRETURN DO; ALTRETURN; END;
     1014    14897    4            L=%VDH_GETBFR.BYTSIZ/2-SIZEW(KV$GETPRM);
     1015    14898    4            KV$GETPRM.LNK$=PINCRW(%VDH_GETBFR.BFR$,L);
     1016    14899    4            GETPRM$=KV$GETPRM.LNK$;
     1017    14900    4            KV$GETPRM=KV_GETPRM;
     1018    14901    4            KV$GETPRM.DAT__.ADR$=%VDH_GETBFR.BFR$;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:44   
     1019    14902    4            KV$GETPRM.DAT__.BFRBYTSIZ=%VDH_GETBFR.BYTSIZ;
     1020    14903    4         END;
     1021    14904    3         L=KV$GETPRM.DAT__.DATBYTSIZ/2;
     1022    14905    3         STR$=PINCRW(KV$GETPRM.DAT__.ADR$,L);
     1023    14906    3         KV$GETPRM.DAT__.DATBYTSIZ=KV$GETPRM.DAT__.DATBYTSIZ+K;
     1024    14907    3      END;
     1025    14908    3      IF STRLST THEN DO;
     1026    14909        /* Make the T/L word. */
     1027    14910
     1028    14911    3         OFFSET=OFFSET-2;
     1029    14912    3         STR$->BYT.E(0)=KV_STRID(STRLST.INDX);
     1030    14913    3         STR$->BYT.E(1)=OFFSET;
     1031    14914    4         IF OFFSET>255 THEN DO;
     1032    14915    4            OFFSET=OFFSET-2;
     1033    14916    4            STR$->WOR.D(0)=STR$->BYT.E(0);
     1034    14917    4            STR$->BYT.E(0)=%KV_PRMID_BIGTL;
     1035    14918    4            STR$->WOR.D(1)=OFFSET;
     1036    14919    4            STR$=PINCRW(STR$,1);
     1037    14920    4         END;
     1038    14921    3         STR$=PINCRW(STR$,1);
     1039    14922    3      END;
     1040    14923    2      CLEAR='0'B;
     1041    14924    2      RETURN;
     1042    14925    2   END GETSPACE;
     1043    14926    1   SCREECH: CALL KHD$SCREECH (KVP_PRMID);
     1044    14927        /*S* SCREECH_CODE: KVP-S$KV_PRMID
     1045    14928             MESSAGE:VDH's parameter tables are messed up.
     1046    14929        */
     1047    14930    1   END;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:45   
--  Include file information  --

   KV_GLBASM_E.:E05TOU  is referenced.
   KV_PRMTBL_M.:E05TOU  is referenced.
   KV_PRMTBL_E.:E05TOU  is referenced.
   KV_PRMTBL_D.:E05TOU  cannot be made into a system file and is referenced.
   KV_SCODE_C.:E05TOU  is referenced.
   KV$PRM.:E05TOU  is referenced.
   KV$INPFNC.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KVP$PRM.

   Procedure KVP$PRM requires 4064 words for executable code.
   Procedure KVP$PRM requires 82 words of local(AUTO) storage.

    No errors detected in file KVP$PRM.:E05TSI    .
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:46   

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:47   

 Object Unit name= KVP$PRM                                    File name= KVP$PRM.:E05TOU
 UTS= JUL 30 '97 02:13:35.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS    749    2ED  KVP$PRM
    1   Proc  even  none  4064    FE0  KVP$PRM
    2  RoData even  none    14      E  KVP$PRM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KVP$PRM
     1      7                  yes      Std        1  KVP$SETPRM
     1    A32                  yes      Std        1  KVP$GETPRM

  ****  Data defs  ****

 Sect HexLoc  Name                           Sect HexLoc  Name
    0      0  KV_PRMTBL                          0     E1  KV_WHERES
    0    16F  KV_MINS                            0    18F  KV_MAXS
    0    1AF  KV_BFRLNGS                         0    1B6  KV_BFRTYPS
    0    1BD  KV_STRS                            0    26E  KV_STRIDS
    0    2D6  KV_VDH_OTPLCL_TRN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:48   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KVV$CALUSR_EVT
 yes     yes           Std       1 KVC$WINDOW2
         yes           Std       1 KVS$SETSTR
 yes     yes           Std       1 KVC$WINDOW1
         yes           Std       0 KVC$DRWBRD
 yes     yes           Std       0 KVE$PST
         yes           Std       1 KHD$SCREECH
 yes     yes           Std       1 KVV$CALUSR
 yes     yes           Std       1 KVS$GETBFR
         yes           Std       1 KVO$OTP1_VRT
 yes     yes           Std       1 KVS$RLSBFR
         yes           Std       1 KVP$FNCKEY
         yes           Std       1 KVO$OTPLCL
         yes           Std       0 KVI$NEWINPFNCTBL
 yes     yes           Std       1 KVM$SND
 yes     yes           Std       0 KVE$FIXHRZSCR
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
                       nStd      0 X6C_ALRZ

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KV$PTR$                               KV_SND_RQSDAT_GNR                     KV_VDH_GETBFR
     KV_USR_DAT                            KH_NODE#                         r    G$ROS$
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:49   


        1        1        /*M* KVP$PRM - VDH parameter processing routines.   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        KVP$PRM: PROC (KV$VDH_XXXPRM);

      8   1 000000  D380 0000 0000  xent KVP$PRM         LNJ,B5   X6A_AUTO_1
          1 000003       0052 0001                       DC       82,1
          1 000005  0F81 0006                            B        s:13780,PREL

        9        9        /* INCLU DES */
       10       10        %INCLUDE LCP_6;
       11      201        %INCLUDE KH$CHN;
       12      323        %INCLUDE KV$INPFNC;
       13      882 S      %INCLUDE KV$INT;
       14      883 S      %INCLUDE KV$GLB;
       15      884 S      %INCLUDE KV$GLBCTX;
       16      885        %INCLUDE KV$PRM;
       17     1098 S      %INCLUDE KV$USR;
       18     1099 S      %INCLUDE KV$VDH;
       19     1100 S      %INCLUDE KV_GLBCNS_E;
       20     1101        %KV_BFRRLSDSP_E;
       21     1107        %KV_INPUNT_E;
       22     1112        %KV_PHSPSTMOD_E;
       23     1119        %KV_STRTYP_E;
       24     1157        %KV_USR_EVT_ID_E;
       25     1177        %KV_USR_FNC_E;
       26     1193 S      %INCLUDE KV_PRMID_E;
       27     1194        %INCLUDE KV_SCODE_C;
       28     1215        %KV#DATMOD_E;
       29     1221        %KV#VD_ORG_E;
       30     1229        %KV_PRMID_E;
       31     1385        %KV_SCP_E;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:50   
       32     1395        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:51   
       33     1396        %INCLUDE KV_PRMTBL_D;                   /* Generate the driver tables         */
       11+    2180        %KV_PARM (ID=KV_PRMID_3270, TYPE=OTHER);
       12+    2220        %KV_PARM (ID=KV_PRMID_ABSGRPRND, TYPE=OTHER, STR=MRD);
       13+    2260        %KV_PARM (ID=KV_PRMID_ACTCHRSET, TYPE=SHRBFR, STR=STR, OFFSET=KV$STR_ACTCHRTBL$#,
       14+    2261                 BFRTYP=KV_STRTYP_ACTCHR, BFRLNG=32);
       15+    2301        %KV_PARM (ID=KV_PRMID_ACTONTRN, TYPE=BIT, STR=STR, OFFSET=KV$STR_ACTONTRN#);
       16+    2341        %KV_PARM (ID=KV_PRMID_ADJTOPLFT, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_ADJTOPLFT#);
       17+    2381        %KV_PARM (ID=KV_PRMID_APL, TYPE=OTHER);
       18+    2421        %KV_PARM (ID=KV_PRMID_APLLCNRM, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_APLLCNRM#);
       19+    2461        %KV_PARM (ID=KV_PRMID_ATRSCRNPOS, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_ATRRQRDSPPST#);
       20+    2501        %KV_PARM (ID=KV_PRMID_AUTCRS, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_AUTCRS#);
       21+    2541        %KV_PARM (ID=KV_PRMID_AUTONL, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_AUTONL#);
       22+    2581        %KV_PARM (ID=KV_PRMID_AUTSAV, TYPE=STRLST);
       23+    2640           %KV_SUBSTR (ID=KV_PRMID_TRMCTL, OFFSET=8); /* Skip the first 8             */
       24+    2660           %KV_SUBSTR (ID=KV_PRMID_PROMPT);
       25+    2680           %KV_SUBSTR (ID=KV_PRMID_EOM);
       26+    2700           %KV_SUBSTR (ID=KV_PRMID_SINPUT);
       27+    2720           %KV_SUBSTR (ID=KV_PRMID_INPTAB);
       28+    2740           %KV_SUBSTR (ID=KV_PRMID_PLATEN);
       29+    2760           %KV_SUBSTR (ID=KV_PRMID_DCBHDR);
       30+    2780           %KV_SUBSTR (ID=KV_PRMID_SSNHDR);
       31+    2800        %KV_PARM (ID=KV_PRMID_AUTTABCLM, TYPE=BYTE, STR=STR, OFFSET=KV$STR_AUTTABCLM#);
       32+    2840        %KV_PARM (ID=KV_PRMID_BIN, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_BIN#);
       33+    2880        %KV_PARM (ID=KV_PRMID_BLANKERASES, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_BLANKERASES#);
       34+    2920        %KV_PARM (ID=KV_PRMID_BRKCNT, TYPE=BYTE, STR=SSN, OFFSET=KV$SSN_BRKCNT#, MAX=3);
       35+    2960        %KV_PARM (ID=KV_PRMID_BTMBRD, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_BTMBRD#);
       36+    3000        %KV_PARM (ID=KV_PRMID_CHARSETNAME, TYPE=SHRBFR, STR=MVD, OFFSET=KV$MVD_TRNTBL$#,
       37+    3001                 BFRTYP=KV_STRTYP_TRNTBL, BFRLNG=8);
       38+    3041        %KV_PARM (ID=KV_PRMID_CHNCAS, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_CHNCAS#);
       39+    3081        %KV_PARM (ID=KV_PRMID_CRISNL, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_CRISNL#);
       40+    3121        %KV_PARM (ID=KV_PRMID_CRSRED, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_CRSRED#);
       41+    3161       %KV_PARM (ID=KV_PRMID_CRTLINSPD, TYPE=BYTE, STR=VDI, OFFSET=KV$VDI_LINSPD#, MAX=15);
       42+    3201        %KV_PARM (ID=KV_PRMID_CTRCHR, TYPE=SHRBFR, STR=MRD, OFFSET=KV$MRD_ERD$#,
       43+    3202                 BFRTYP=KV_STRTYP_ERD, BFRLNG=KV$ERD_TXT#/8-8);
       44+    3242        %KV_PARM (ID=KV_PRMID_CURSORUP, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_CURSORUP#);
       45+    3282        %KV_PARM (ID=KV_PRMID_DADR, TYPE=STRUCT);
       46+    3341        %KV_PARM (ID=KV_PRMID_DCBHDR, TYPE=SHRBFR, STR=MVD, OFFSET=KV$MVD_DCBHDN$#,
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:52   
       47+    3342                 BFRTYP=KV_STRTYP_DCBHDN, BFRLNG=6);
       48+    3382        %KV_PARM (ID=KV_PRMID_DCHMOVFLD, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DCHMOVFLD#);
       49+    3422        %KV_PARM (ID=KV_PRMID_DEVCTL, TYPE=OTHER);
       50+    3462        %KV_PARM (ID=KV_PRMID_DEVICEBS, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVICEBS#);
       51+    3502        %KV_PARM (ID=KV_PRMID_DEVICECR, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVICECR#);
       52+    3542        %KV_PARM (ID=KV_PRMID_DEVICELF, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVICELF#);
       53+    3582        %KV_PARM (ID=KV_PRMID_DEVNUM, TYPE=OTHER);
       54+    3622        %KV_PARM (ID=KV_PRMID_DEVPOSOPTS, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVPOSOPTS#);
       55+    3662        %KV_PARM (ID=KV_PRMID_DEVSCROLL, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_DEVSCROLL#);
       56+    3702        %KV_PARM (ID=KV_PRMID_DISPINPUT, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_DISPINPUT#);
       57+    3742        %KV_PARM (ID=KV_PRMID_DMN, TYPE=BYTE, STR=STR, OFFSET=KV$STR_ID#,
       58+    3743                 MIN=256, MAX=0);
       59+    3783        %KV_PARM (ID=KV_PRMID_DSPHEIGHT, TYPE=BYTE, STR=MRD, OFFSET=KV$MRD_DSPHEIGHT#);
       60+    3823        %KV_PARM (ID=KV_PRMID_DVCFLWCTRALG, STR=MRD, OFFSET=KV$MRD_DVCFLWCTRALG#,
       61+    3824                 TYPE=BYTE, MAX=3);
       62+    3864        %KV_PARM (ID=KV_PRMID_EDITOVR, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_EDITOVR#);
       63+    3904        %KV_PARM (ID=KV_PRMID_EDTBFR, TYPE=SHRBFR, STR=STR, OFFSET=KV$STR_EDTBFR__#,
       64+    3905                 BFRTYP=KV_STRTYP_REDBFR, BFRLNG=0);
       65+    3945        %KV_PARM (ID=KV_PRMID_EDTCTL, TYPE=STRUCT, MAX="(EDTCTL_ONESPACEEDIT#+16)");
       66+    4004           %KV_SUBSTR (ID=KV_PRMID_RCRWRAP, OFFSET=EDTCTL_RCRWRAP#, TYPE=BITCND);
       67+    4024           %KV_SUBSTR (ID=KV_PRMID_EDTCTL, TYPE=OTHER); /* Only for ORG=SE */
       68+    4044           %KV_SUBSTR (ID=KV_PRMID_HRZSCRALL, OFFSET=EDTCTL_HSALL#, TYPE=BITCND);
       69+    4064           %KV_SUBSTR (ID=KV_PRMID_TEXTEDIT, OFFSET=EDTCTL_TEXTEDIT#, TYPE=BITCND);
       70+    4084           %KV_SUBSTR (ID=KV_PRMID_EASYAPPEND, OFFSET=EDTCTL_EASYAPPEND#, TYPE=BITCND);
       71+    4104           %KV_SUBSTR (ID=KV_PRMID_KEYTYP, OFFSET=EDTCTL_KEYTYPE#, TYPE=BYTCND);
       72+    4124           %KV_SUBSTR (ID=KV_PRMID_VRTSCRMRG, OFFSET=EDTCTL_VSMARGIN#, TYPE=BYTCND);
       73+    4144           %KV_SUBSTR (ID=KV_PRMID_VRTSCRSHF, OFFSET=EDTCTL_VSSHIFT#, TYPE=BYTCND);
       74+    4164           %KV_SUBSTR (ID=KV_PRMID_KEYINC, OFFSET=EDTCTL_KEYINCR#, TYPE=OTHER);
       75+    4184           %KV_SUBSTR (ID=KV_PRMID_ONESPCEDT, OFFSET=EDTCTL_ONESPACEEDIT#, TYPE=BITCND);
       76+    4204        %KV_PARM (ID=KV_PRMID_EDTRHT, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_EDTRHT#);
       77+    4244        %KV_PARM (ID=KV_PRMID_ENBENTEXTSRDCHR, TYPE=BIT, STR=SRD, OFFSET=
              4244            KV$SRD_ENBENTEXTSRDCHR#);
       78+    4284        %KV_PARM (ID=KV_PRMID_ENTSRDCHR, TYPE=SHRBFR, STR=SRD, OFFSET=KV$SRD_ENTSRDCHR$#,
       79+    4285                 BFRTYP=KV_STRTYP_ENTSRD, BFRLNG=1);
       80+    4325        %KV_PARM (ID=KV_PRMID_EOM, TYPE=STRUCT, MAX=EOM_SIZE#);
       81+    4384           %KV_SUBSTR (ID=KV_PRMID_DMN, OFFSET=EOM_DMN#, TYPE=BYT);
       82+    4404           %KV_SUBSTR (ID=KV_PRMID_USRHLTINH, OFFSET=EOM_SUPPHALT#, TYPE=BIT);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:53   
       83+    4424           %KV_SUBSTR (ID=KV_PRMID_REDTIMOUTPRD, OFFSET=EOM_TIMEOUT#, TYPE=BYTCND);
       84+    4444           %KV_SUBSTR (ID=KV_PRMID_REDTIMOUTPRDUNT, OFFSET=EOM_UTYPE#, TYPE=BIN2);
       85+    4464           %KV_SUBSTR (ID=KV_PRMID_ACTCHRSET, OFFSET=EOM_TABLE#, TYPE=BFR);
       86+    4484        %KV_PARM (ID=KV_PRMID_EASYAPPEND, TYPE=BIT, STR=SVD, OFFSET=KV$RCRLST_ESYAPP#);
       87+    4524        %KV_PARM (ID=KV_PRMID_FCNTBL, STR=MVD, OFFSET=KV$MVD_SSTINPFNCTBL$#,
       88+    4525                 TYPE=SHRBFR, BFRTYP=KV_STRTYP_SSTINPFNCTBL, BFRLNG=8);
       89+    4565        %KV_PARM (ID=KV_PRMID_FF_FLUSH, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_FF_FLUSH#);
       90+    4605        %KV_PARM (ID=KV_PRMID_FF_INCCR, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_FF_INCCR#);
       91+    4645        %KV_PARM (ID=KV_PRMID_FIRSTLINE, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_FRSLIN#);
       92+    4685        %KV_PARM (ID=KV_PRMID_FOREIGN, TYPE=USRPRM);
       93+    4725        %KV_PARM (ID=KV_PRMID_FULLDUPLEXPAPERTAPE, TYPE=BIT, STR=VDI, OFFSET=
              4725            KV$VDI_FULLDUPLEXPAPERTAPE#);
       94+    4765        %KV_PARM (ID=KV_PRMID_HALFDUPLEXPAPERTAPE, TYPE=BIT, STR=VDI, OFFSET=
              4765            KV$VDI_HALFDUPLEXPAPERTAPE#);
       95+    4805        %KV_PARM (ID=KV_PRMID_HARDWIRE, TYPE=OTHER);
       96+    4845        %KV_PARM (ID=KV_PRMID_HBRDCHR, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_HBRDCHR#,
       97+    4846                 MIN=32, MAX=255);
       98+    4886        %KV_PARM (ID=KV_PRMID_HBRDSIZ, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_HBRDSIZ#-4,
       99+    4887                  MIN=1, MAX=15);
      100+    4927        %KV_PARM (ID=KV_PRMID_HRZSCR, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_HRZSCR#);
      101+    4967        %KV_PARM (ID=KV_PRMID_HRZSCRALL, TYPE=BIT, STR=SVD, OFFSET=KV$RCRLST_HRZSCRALL#);
      102+    5007        %KV_PARM (ID=KV_PRMID_HRZSCRMRG, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_HRZSCRMRGINT#);
      103+    5047        %KV_PARM (ID=KV_PRMID_HRZSCRSHF, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_HRZSCRSHF#);
      104+    5087        %KV_PARM (ID=KV_PRMID_INPTAB, TYPE=SHRBFR, STR=MVD, OFFSET=KV$MVD_INPTAB$#,
      105+    5088                 BFRTYP=KV_STRTYP_INPTAB, BFRLNG=1);
      106+    5128        %KV_PARM (ID=KV_PRMID_INPUT, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_INPUT#);
      107+    5168        %KV_PARM (ID=KV_PRMID_INSMOD, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_INSMOD#);
      108+    5208        %KV_PARM (ID=KV_PRMID_KEPTYP, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_KEPTYP#);
      109+    5248        %KV_PARM (ID=KV_PRMID_KEYDEFS, TYPE=OTHER, STR=MRD);
      110+    5288        %KV_PARM (ID=KV_PRMID_KEYINC, TYPE=WORD, STR=SVD, OFFSET=KV$RCRLST_KEYINC#,
      111+    5289                 MAX=65535, MIN=1);
      112+    5329        %KV_PARM (ID=KV_PRMID_KEYTYP, TYPE=BYTE, STR=SVD, OFFSET=KV$RCRLST_KEYTYP#);
      113+    5369        %KV_PARM (ID=KV_PRMID_LFISNL, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_LFISNL#);
      114+    5409        %KV_PARM (ID=KV_PRMID_LFTBRD, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_LFTBRD#);
      115+    5449        %KV_PARM (ID=KV_PRMID_LIMBO, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_LMB#);
      116+    5489        %KV_PARM (ID=KV_PRMID_LIMBOCLM, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_LIMBOCLM#);
      117+    5529        %KV_PARM (ID=KV_PRMID_LINEATTR, TYPE=STRUCT, MAX="(LINEATTR_DEVICE#+32)");
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:54   
      118+    5588           %KV_SUBSTR (ID=KV_PRMID_MULTIDEVICE, OFFSET=LINEATTR_MULTIDEVICE#, TYPE=BIT);
      119+    5608           %KV_SUBSTR (ID=KV_PRMID_HARDWIRE, OFFSET=LINEATTR_HARDWIRE#, TYPE=BIT);
      120+    5628           %KV_SUBSTR (ID=KV_PRMID_FOREIGN, OFFSET=LINEATTR_FOREIGN#, TYPE=BIT);
      121+    5648           %KV_SUBSTR (ID=KV_PRMID_MCRFPL, OFFSET=LINEATTR_MICROFPL#, TYPE=BIT);
      122+    5668           %KV_SUBSTR (ID=KV_PRMID_CRTLINSPD, OFFSET=LINEATTR_LINESPEED#, TYPE=BYT);
      123+    5688           %KV_SUBSTR (ID=KV_PRMID_PRFNAM, OFFSET=LINEATTR_PROFILE#, TYPE=BFR);
      124+    5708           %KV_SUBSTR (ID=KV_PRMID_NODE, OFFSET=LINEATTR_NODE#, TYPE=BFR);
      125+    5728           %KV_SUBSTR (ID=KV_PRMID_PORT, OFFSET=LINEATTR_PORT#, TYPE=BFR);
      126+    5748           %KV_SUBSTR (ID=KV_PRMID_DEVCTL, OFFSET=LINEATTR_CONTROLLER#, TYPE=BFR);
      127+    5768           %KV_SUBSTR (ID=KV_PRMID_DEVNUM, OFFSET=LINEATTR_DEVICE#, TYPE=BFR);
      128+    5788        %KV_PARM (ID=KV_PRMID_LINES, TYPE=STRUCT, MAX=16*2);
      129+    5847           %KV_SUBSTR (ID=KV_PRMID_LINES, TYPE=OTHER);
      130+    5867        %KV_PARM (ID=KV_PRMID_LOCALECHO, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_LOCALECHO#);
      131+    5907        %KV_PARM (ID=KV_PRMID_LOWERCASE, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_LOWERCASE#);
      132+    5947        %KV_PARM (ID=KV_PRMID_LOWERCASEPRINTS, TYPE=BIT, STR=MRD, OFFSET=
              5947            KV$MRD_LOWERCASEPRINTS#);
      133+    5987        %KV_PARM (ID=KV_PRMID_LPI, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_LPI#);
      134+    6027        %KV_PARM (ID=KV_PRMID_MAXATRS, TYPE=BYTE, STR=MRD, OFFSET=KV$MRD_MAXATRPERLIN#);
      135+    6067        %KV_PARM (ID=KV_PRMID_MCRFPL, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_MCRFPL#);
      136+    6107       %KV_PARM (ID=KV_PRMID_MINEDTBFRSIZ, TYPE=BYTE, STR=SSN, OFFSET=KV$SSN_MINEDTBFRSIZ#)
              6107            ;
      137+    6147        %KV_PARM (ID=KV_PRMID_MINLNG, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_MINLNG#);
      138+    6187        %KV_PARM (ID=KV_PRMID_MINREC, TYPE=OTHER);
      139+    6227        %KV_PARM (ID=KV_PRMID_MINWDT, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_MINWDT#);
      140+    6267        %KV_PARM (ID=KV_PRMID_MRDLNG, TYPE=BYTE, STR=MRD, OFFSET=KV$MRD_LNG#);
      141+    6307        %KV_PARM (ID=KV_PRMID_MRDWDT, TYPE=WORD, STR=MRD, OFFSET=KV$MRD_WDT#, MIN=1);
      142+    6347        %KV_PARM (ID=KV_PRMID_MSGHLT, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_MSGHLT#);
      143+    6387        %KV_PARM (ID=KV_PRMID_MSGLIN, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_MSGLIN#);
      144+    6427        %KV_PARM (ID=KV_PRMID_MULTIDEVICE, TYPE=OTHER);
      145+    6467        %KV_PARM (ID=KV_PRMID_MVDLNG, TYPE=BYTE, STR=MVD, OFFSET=KV$MVD_LNG#);
      146+    6507        %KV_PARM (ID=KV_PRMID_MVDWDT, TYPE=WORD, STR=MVD, OFFSET=KV$MVD_WDT#, MIN=1);
      147+    6547        %KV_PARM (ID=KV_PRMID_NODE, TYPE=OTHER);
      148+    6587        %KV_PARM (ID=KV_PRMID_NOOPTMIZ, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_NOOPTMIZ#);
      149+    6627        %KV_PARM (ID=KV_PRMID_NO_FLDTRM, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_NO_FLDTRM#);
      150+    6667        %KV_PARM (ID=KV_PRMID_ONESPCEDT, TYPE=BIT, STR=SVD, OFFSET=KV$RCRLST_ONESPCEDT#);
      151+    6707        %KV_PARM (ID=KV_PRMID_OPDTAB, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_OPDTAB#);
      152+    6747        %KV_PARM (ID=KV_PRMID_OTPTAB, TYPE=SHRBFR, STR=STR, OFFSET=KV$STR_OTPTAB$#,
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:55   
      153+    6748                 BFRTYP=KV_STRTYP_OTPTAB, BFRLNG=1);
      154+    6788        %KV_PARM (ID=KV_PRMID_OUTPUT, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_OUTPUT#);
      155+    6828       %KV_PARM (ID=KV_PRMID_OUTPUTDISCARD, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_OUTPUTDISCARD#
              6828            );
      156+    6868        %KV_PARM (ID=KV_PRMID_OVRSTR, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_OVRSTR#);
      157+    6908        %KV_PARM (ID=KV_PRMID_PAGEHALT, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_PAGEHALT#);
      158+    6948        %KV_PARM (ID=KV_PRMID_PARITY, TYPE=BYTE, STR=VDI, OFFSET=KV$VDI_PRTTYP#, MAX=4);
      159+    6988        %KV_PARM (ID=KV_PRMID_PARITYCHECK, TYPE=BIT, STR=VDI, OFFSET=KV$VDI_PRTCHK#);
      160+    7028        %KV_PARM (ID=KV_PRMID_PLATEN, TYPE=STRUCT, MAX="(PLATEN_LPI#+8)");
      161+    7087           %KV_SUBSTR (ID=1, OFFSET=PLATEN_EXTWID#, TYPE=EXTBIT);
      162+    7107           %KV_SUBSTR (ID=KV_PRMID_MVDWDT, OFFSET=PLATEN_WIDTH#, TYPE=BYTCND);
      163+    7127           %KV_SUBSTR (ID=KV_PRMID_MVDLNG, OFFSET=PLATEN_LENGTH#, TYPE=BYTCND);
      164+    7147           %KV_SUBSTR (ID=KV_PRMID_LIMBO, OFFSET=PLATEN_LIMBO#, TYPE=BYTCND);
      165+    7167           %KV_SUBSTR (ID=KV_PRMID_FIRSTLINE, OFFSET=PLATEN_FIRSTLINE#, TYPE=BYTCND);
      166+    7187           %KV_SUBSTR (ID=KV_PRMID_LPI, OFFSET=PLATEN_LPI#, TYPE=BYTCND);
      167+    7207        %KV_PARM (ID=KV_PRMID_PORT, TYPE=OTHER);
      168+    7247        %KV_PARM (ID=KV_PRMID_PRFNAM, TYPE=TEXT, STR=MRD, OFFSET=KV$MRD_PRFNAM#,
      169+    7248                 BFRLNG=12);
      170+    7288        %KV_PARM (ID=KV_PRMID_PRINTHALT, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_PRINTHALT#);
      171+    7328        %KV_PARM (ID=KV_PRMID_PRINTTYPE, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_PRINTTYPE#);
      172+    7368        %KV_PARM (ID=KV_PRMID_PRKCRS, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_PRKCRS#);
      173+    7408        %KV_PARM (ID=KV_PRMID_PRM, TYPE=SHRBFR, STR=STR, OFFSET=KV$STR_PRM$#,
      174+    7409                 BFRTYP=KV_STRTYP_PRM, BFRLNG=1);
      175+    7449        %KV_PARM (ID=KV_PRMID_PROFILE, TYPE=STRUCT);
      176+    7508           %KV_SUBSTR (ID=KV_PRMID_PRFNAM, OFFSET=0, TYPE=BFR);
      177+    7528        %KV_PARM (ID=KV_PRMID_PROGDTAB, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_PROGDTAB#);
      178+    7568        %KV_PARM (ID=KV_PRMID_PROMPT, TYPE=STRUCT, MAX=0);
      179+    7627           %KV_SUBSTR (ID=KV_PRMID_DMN, OFFSET=PROMPT_DMN#, TYPE=BYT);
      180+    7647           %KV_SUBSTR (ID=KV_PRMID_PRM, OFFSET=PROMPT_VFC#, TYPE=BFR);
      181+    7667        %KV_PARM (ID=KV_PRMID_RCRWRAP, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_RCRWRAP#);
      182+    7707       %KV_PARM (ID=KV_PRMID_REDTIMOUTPRD, TYPE=BYTE, STR=STR, OFFSET=KV$STR_REDTIMOUTPRD#)
              7707            ;
      183+    7747        %KV_PARM (ID=KV_PRMID_REDTIMOUTPRDUNT, TYPE=BYTE, STR=STR, OFFSET=
              7747            KV$STR_REDTIMOUTPRDUNT#, MAX=2);
      184+    7787        %KV_PARM (ID=KV_PRMID_RELPAGE, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_RELPAGE#);
      185+    7827        %KV_PARM (ID=KV_PRMID_REREADCLM, TYPE=WORD, STR=STR, OFFSET=KV$STR_RE_REDCLM#);
      186+    7867        %KV_PARM (ID=KV_PRMID_RETYPOVR, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_RETYPOVR#);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:56   
      187+    7907        %KV_PARM (ID=KV_PRMID_RHTBRD, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_RHTBRD#);
      188+    7947        %KV_PARM (ID=KV_PRMID_SAVCTL, TYPE=STRUCT, MAX=8*8); /* 8 BYTES */
      189+    8006           %KV_SUBSTR (ID=KV_PRMID_DMN, OFFSET=0, TYPE=BYT);
      190+    8026           %KV_SUBSTR (ID=KV_PRMID_HRZSCRMRG, OFFSET=16, TYPE=BYT);
      191+    8046           %KV_SUBSTR (ID=KV_PRMID_HRZSCRSHF, OFFSET=24, TYPE=BYT);
      192+    8066           %KV_SUBSTR (ID=KV_PRMID_AUTTABCLM, OFFSET=32, TYPE=BYT);
      193+    8086           %KV_SUBSTR (ID=KV_PRMID_WRDWRPCLM, OFFSET=40, TYPE=BYT);
      194+    8106           %KV_SUBSTR (ID=KV_PRMID_HRZSCR, OFFSET=48, TYPE=BIT);
      195+    8126           %KV_SUBSTR (ID=KV_PRMID_WRDWRP, OFFSET=49, TYPE=BIT);
      196+    8146           %KV_SUBSTR (ID=KV_PRMID_TRUNCATE, OFFSET=50, TYPE=BIT);
      197+    8166           %KV_SUBSTR (ID=KV_PRMID_ENBENTEXTSRDCHR, OFFSET=51, TYPE=BIT);
      198+    8186           %KV_SUBSTR (ID=KV_PRMID_TRNUSRINPFNC, OFFSET=52, TYPE=BIT);
      199+    8206           %KV_SUBSTR (ID=KV_PRMID_ACTONTRN, OFFSET=53, TYPE=BIT);
      200+    8226           %KV_SUBSTR (ID=KV_PRMID_DISPINPUT, OFFSET=54, TYPE=BIT);
      201+    8246           %KV_SUBSTR (ID=KV_PRMID_NOOPTMIZ, OFFSET=55, TYPE=BIT);
      202+    8266           %KV_SUBSTR (ID=KV_PRMID_PRKCRS, OFFSET=56, TYPE=BIT);
      203+    8286        %KV_PARM (ID=KV_PRMID_SAVGET, TYPE=STRLST);
      204+    8345           %KV_SUBSTR (ID=KV_PRMID_SAVCTL); /* TRMCTL subset, per stream              */
      205+    8365           %KV_SUBSTR (ID=KV_PRMID_PROMPT);
      206+    8385           %KV_SUBSTR (ID=KV_PRMID_EOM, OFFSET=1); /* Skip SUPPHALT                   */
      207+    8405           %KV_SUBSTR (ID=KV_PRMID_DCBHDR);
      208+    8425           %KV_SUBSTR (ID=KV_PRMID_SSNHDR);
      209+    8445        %KV_PARM (ID=KV_PRMID_SCROLL, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_SCROLL#);
      210+    8485        %KV_PARM (ID=KV_PRMID_SDNUM, TYPE=OTHER);
      211+    8525        %KV_PARM (ID=KV_PRMID_SETUP_CHR, TYPE=OTHER, STR=MRD);
      212+    8565        %KV_PARM (ID=KV_PRMID_SIMPERF, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_SIMPERF#);
      213+    8605        %KV_PARM (ID=KV_PRMID_SINPUT, TYPE=STRUCT, MAX=0);
      214+    8664           %KV_SUBSTR (ID=KV_PRMID_DMN, OFFSET=SINPUT_DMN#, TYPE=BYT);
      215+    8684           %KV_SUBSTR (ID=KV_PRMID_REREADCLM, OFFSET=SINPUT_POSITION#, TYPE=OTHER);
      216+    8704           %KV_SUBSTR (ID=KV_PRMID_SINPUT, OFFSET=SINPUT_TXT#, TYPE=OTHER); /* ORG=SE */
      217+    8724           %KV_SUBSTR (ID=KV_PRMID_EDTBFR, OFFSET=SINPUT_TXT#, TYPE=BFR);
      218+    8744        %KV_PARM (ID=KV_PRMID_SPACEINSERT, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_SPACEINSERT#);
      219+    8784        %KV_PARM (ID=KV_PRMID_SRDOPT, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_OPT#);
      220+    8824        %KV_PARM (ID=KV_PRMID_SSNHDR, TYPE=SHRBFR, STR=SSN, OFFSET=KV$SSN_SSNHDN$#,
      221+    8825                 BFRTYP=KV_STRTYP_SSNHDN, BFRLNG=6);
      222+    8865        %KV_PARM (ID=KV_PRMID_TABRELATIVE, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_TABRELATIVE#);
      223+    8905        %KV_PARM (ID=KV_PRMID_TABSIM, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_TABSIM#);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:57   
      224+    8945        %KV_PARM (ID=KV_PRMID_TEXTEDIT, TYPE=BIT, STR=SVD, OFFSET=KV$RCRLST_TXTEDT#);
      225+    8985        %KV_PARM (ID=KV_PRMID_TOPBRD, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_TOPBRD#);
      226+    9025        %KV_PARM (ID=KV_PRMID_TRMATTR, TYPE=STRUCT, MAX="(TRMATTR_MAXATRS#+16)");
      227+    9084           %KV_SUBSTR (ID=KV_PRMID_PROGDTAB, OFFSET=TRMATTR_PROGDTAB#, TYPE=BITCND);
      228+    9104           %KV_SUBSTR (ID=KV_PRMID_OPDTAB, OFFSET=TRMATTR_OPDTAB#, TYPE=BITCND);
      229+    9124           %KV_SUBSTR (ID=KV_PRMID_DEVSCROLL, OFFSET=TRMATTR_DEVSCROLL#, TYPE=BITCND);
      230+    9144           %KV_SUBSTR (ID=KV_PRMID_CURSORUP, OFFSET=TRMATTR_CURSORUP#, TYPE=BITCND);
      231+    9164           %KV_SUBSTR (ID=KV_PRMID_DEVICECR, OFFSET=TRMATTR_DEVICECR#, TYPE=BITCND);
      232+    9184           %KV_SUBSTR (ID=KV_PRMID_DEVICELF, OFFSET=TRMATTR_DEVICELF#, TYPE=BITCND);
      233+    9204           %KV_SUBSTR (ID=KV_PRMID_DEVICEBS, OFFSET=TRMATTR_DEVICEBS#, TYPE=BITCND);
      234+    9224           %KV_SUBSTR (ID=KV_PRMID_AUTONL, OFFSET=TRMATTR_AUTONL#, TYPE=BITCND);
      235+    9244           %KV_SUBSTR (ID=KV_PRMID_CRISNL, OFFSET=TRMATTR_CRISNL#, TYPE=BITCND);
      236+    9264           %KV_SUBSTR (ID=KV_PRMID_LFISNL, OFFSET=TRMATTR_LFISNL#, TYPE=BITCND);
      237+    9284           %KV_SUBSTR (ID=KV_PRMID_BLANKERASES, OFFSET=TRMATTR_BLANKERASES#, TYPE=BITCND);
      238+    9304           %KV_SUBSTR (ID=KV_PRMID_DEVPOSOPTS, OFFSET=TRMATTR_DEVPOSOPTS#, TYPE=BITCND);
      239+    9324           %KV_SUBSTR (ID=KV_PRMID_TRUOVRPRT, OFFSET=TRMATTR_TRUOVRPRT#, TYPE=BITCND);
      240+    9344           %KV_SUBSTR (ID=KV_PRMID_APL, OFFSET=TRMATTR_APL#, TYPE=BITCND);
      241+    9364           %KV_SUBSTR (ID=KV_PRMID_BIN, OFFSET=TRMATTR_BIN#, TYPE=BITCND);
      242+    9384           %KV_SUBSTR (ID=KV_PRMID_LOWERCASEPRINTS, OFFSET=TRMATTR_LOWERCASEPRINTS#, TYPE=
              9384               BITCND);
      243+    9404           %KV_SUBSTR (ID=KV_PRMID_LIMBOCLM, OFFSET=TRMATTR_LIMBOCLM#, TYPE=BITCND);
      244+    9424           %KV_SUBSTR (ID=KV_PRMID_LOCALECHO, OFFSET=TRMATTR_LOCALECHO#, TYPE=BITCND);
      245+    9444           %KV_SUBSTR (ID=KV_PRMID_PARITY, OFFSET=TRMATTR_PARITY#, TYPE=BIN3);
      246+    9464           %KV_SUBSTR (ID=KV_PRMID_INPUT, OFFSET=TRMATTR_INPUT#, TYPE=BITCND);
      247+    9484           %KV_SUBSTR (ID=KV_PRMID_OUTPUT, OFFSET=TRMATTR_OUTPUT#, TYPE=BITCND);
      248+    9504           %KV_SUBSTR (ID=KV_PRMID_PRINTTYPE, OFFSET=TRMATTR_PRINTTYPE#, TYPE=BITCND);
      249+    9524           %KV_SUBSTR (ID=KV_PRMID_TTYTYPE, OFFSET=TRMATTR_TTYTYPE#, TYPE=BITCND);
      250+    9544           %KV_SUBSTR (ID=1, OFFSET=TRMATTR_EXTWID#, TYPE=EXTBIT);
      251+    9564           %KV_SUBSTR (ID=KV_PRMID_MRDWDT, OFFSET=TRMATTR_WIDTH#, TYPE=BYTCND);
      252+    9584           %KV_SUBSTR (ID=KV_PRMID_MRDLNG, OFFSET=TRMATTR_HEIGHT#, TYPE=BYTCND);
      253+    9604           %KV_SUBSTR (ID=KV_PRMID_MINREC, OFFSET=TRMATTR_MINREC#, TYPE=BYTCND);
      254+    9624           %KV_SUBSTR (ID=KV_PRMID_CRTLINSPD, OFFSET=TRMATTR_SPEED#, TYPE=BYTCND);
      255+    9644           %KV_SUBSTR (ID=KV_PRMID_CHARSETNAME, OFFSET=TRMATTR_CHARSETNAME#, TYPE=BFR);
      256+    9664           %KV_SUBSTR (ID=KV_PRMID_FCNTBL, OFFSET=TRMATTR_FCNTBL#, TYPE=BFR);
      257+    9684           %KV_SUBSTR (ID=KV_PRMID_NO_FLDTRM, OFFSET=TRMATTR_NO_FLDTRM#, TYPE=BITCND);
      258+    9704           %KV_SUBSTR (ID=KV_PRMID_ATRSCRNPOS, OFFSET=TRMATTR_ATRSCRNPOS#, TYPE=BITCND);
      259+    9724           %KV_SUBSTR (ID=KV_PRMID_STRDON, OFFSET=TRMATTR_C00FPT#, TYPE=EXTBIT);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:58   
      260+    9744           %KV_SUBSTR (ID=KV_PRMID_DVCFLWCTRALG, OFFSET=TRMATTR_DVCFLWCTRALG#, TYPE=BIN3);
      261+    9764           %KV_SUBSTR (ID=KV_PRMID_MAXATRS, OFFSET=TRMATTR_MAXATRS#, TYPE=BYTCND);
      262+    9784           %KV_SUBSTR (ID=KV_PRMID_DCHMOVFLD, OFFSET=TRMATTR_DCHMOVFLD#, TYPE=BITCND);
      263+    9804           %KV_SUBSTR (ID=KV_PRMID_DSPHEIGHT, OFFSET=TRMATTR_DSPHEIGHT#, TYPE=BYTCND);
      264+    9824           %KV_SUBSTR (ID=KV_PRMID_FF_FLUSH, OFFSET=TRMATTR_FF_FLUSH#, TYPE=BITCND);
      265+    9844           %KV_SUBSTR (ID=KV_PRMID_FF_INCCR, OFFSET=TRMATTR_FF_INCCR#, TYPE=BITCND);
      266+    9864           %KV_SUBSTR (ID=KV_PRMID_MCRFPL, OFFSET=TRMATTR_MICROFPL#, TYPE=BITCND);
      267+    9884        %KV_PARM (ID=KV_PRMID_TRMCTL, TYPE=STRUCT, MAX="(128)");
      268+    9943           %KV_SUBSTR (ID=KV_PRMID_DISPINPUT, OFFSET=TRMCTL_DISPINPUT#, TYPE=BITCND);
      269+    9963           %KV_SUBSTR (ID=KV_PRMID_PARITYCHECK, OFFSET=TRMCTL_PARITYCHECK#, TYPE=BITCND);
      270+    9983          %KV_SUBSTR (ID=KV_PRMID_OUTPUTDISCARD, OFFSET=TRMCTL_OUTPUTDISCARD#, TYPE=BITCND)
              9983               ;
      271+   10003           %KV_SUBSTR (ID=KV_PRMID_FULLDUPLEXPAPERTAPE, OFFSET=TRMCTL_FULLDUXPAPERTAPE#,
             10003               TYPE=BITCND);
      272+   10023           %KV_SUBSTR (ID=KV_PRMID_HALFDUPLEXPAPERTAPE, OFFSET=TRMCTL_HALFDUXPAPERTAPE#,
             10023               TYPE=BITCND);
      273+   10043           %KV_SUBSTR (ID=KV_PRMID_ACTONTRN, OFFSET=TRMCTL_ACTONTRN#, TYPE=BITCND);
      274+   10063           %KV_SUBSTR (ID=KV_PRMID_RETYPOVR, OFFSET=TRMCTL_RETYPOVR#, TYPE=BITCND);
      275+   10083           %KV_SUBSTR (ID=KV_PRMID_EDITOVR, OFFSET=TRMCTL_EDITOVR#, TYPE=BITCND);
      276+   10103           %KV_SUBSTR (ID=KV_PRMID_SCROLL, OFFSET=TRMCTL_SCROLL#, TYPE=BITCND);
      277+   10123           %KV_SUBSTR (ID=KV_PRMID_PAGEHALT, OFFSET=TRMCTL_PAGEHALT#, TYPE=BITCND);
      278+   10143           %KV_SUBSTR (ID=KV_PRMID_PRINTHALT, OFFSET=TRMCTL_PRINTHALT#, TYPE=BITCND);
      279+   10163           %KV_SUBSTR (ID=KV_PRMID_RELPAGE, OFFSET=TRMCTL_RELPAGE#, TYPE=BITCND);
      280+   10183           %KV_SUBSTR (ID=KV_PRMID_SIMPERF, OFFSET=TRMCTL_SIMPERF#, TYPE=BITCND);
      281+   10203           %KV_SUBSTR (ID=KV_PRMID_TABSIM, OFFSET=TRMCTL_TABSIM#, TYPE=BITCND);
      282+   10223           %KV_SUBSTR (ID=KV_PRMID_TABRELATIVE, OFFSET=TRMCTL_TABRELATIVE#, TYPE=BITCND);
      283+   10243           %KV_SUBSTR (ID=KV_PRMID_SPACEINSERT, OFFSET=TRMCTL_SPACEINSERT#, TYPE=BITCND);
      284+   10263           %KV_SUBSTR (ID=KV_PRMID_OVRSTR, OFFSET=TRMCTL_SENDBKSPACE#, TYPE=BITCND);
      285+   10283           %KV_SUBSTR (ID=KV_PRMID_UPPERCASE, OFFSET=TRMCTL_UPPERCASE#, TYPE=BITCND);
      286+   10303           %KV_SUBSTR (ID=KV_PRMID_LOWERCASE, OFFSET=TRMCTL_LOWERCASE#, TYPE=BITCND);
      287+   10323           %KV_SUBSTR (ID=KV_PRMID_APLLCNRM, OFFSET=TRMCTL_APLLCNRM#, TYPE=BITCND);
      288+   10343           %KV_SUBSTR (ID=KV_PRMID_NOOPTMIZ, OFFSET=TRMCTL_NOOPTMIZ#, TYPE=BITCND);
      289+   10363           %KV_SUBSTR (ID=KV_PRMID_WRPPAG, OFFSET=TRMCTL_WRAPPAGE#, TYPE=BITCND);
      290+   10383           %KV_SUBSTR (ID=KV_PRMID_MINEDTBFRSIZ, OFFSET=TRMCTL_SINPUTSZ#, TYPE=BYTCND);
      291+   10403           %KV_SUBSTR (ID=KV_PRMID_BRKCNT, OFFSET=TRMCTL_BREAKCOUNT#, TYPE=BYTCND);
      292+   10423           %KV_SUBSTR (ID=KV_PRMID_INSMOD, OFFSET=TRMCTL_INSERTMODE#, TYPE=BITCND);
      293+   10443           %KV_SUBSTR (ID=KV_PRMID_MSGHLT, OFFSET=TRMCTL_MSGHALT#, TYPE=BITCND);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:59   
      294+   10463           %KV_SUBSTR (ID=KV_PRMID_STRDON, OFFSET=TRMCTL_C00FPT#, TYPE=EXTBIT);
      295+   10483           %KV_SUBSTR (ID=KV_PRMID_MSGLIN, OFFSET=TRMCTL_MSGLINE#, TYPE=BITCND);
      296+   10503           %KV_SUBSTR (ID=KV_PRMID_HRZSCR, OFFSET=TRMCTL_HSCROLL#, TYPE=BITCND);
      297+   10523           %KV_SUBSTR (ID=KV_PRMID_HRZSCRMRG, OFFSET=TRMCTL_HSMARGIN#, TYPE=BYTCND);
      298+   10543           %KV_SUBSTR (ID=KV_PRMID_HRZSCRSHF, OFFSET=TRMCTL_HSSHIFT#, TYPE=BYTCND);
      299+   10563           %KV_SUBSTR (ID=KV_PRMID_TRUNCATE, OFFSET=TRMCTL_TRUNCATE#, TYPE=BITCND);
      300+   10583           %KV_SUBSTR (ID=KV_PRMID_ENBENTEXTSRDCHR, OFFSET=TRMCTL_ENBENTEXTSRDCHR#, TYPE=
             10583               BITCND);
      301+   10603           %KV_SUBSTR (ID=KV_PRMID_TRNUSRINPFNC, OFFSET=TRMCTL_TRNUSRINPFNC#, TYPE=BITCND);
      302+   10623           %KV_SUBSTR (ID=KV_PRMID_AUTTABCLM, OFFSET=TRMCTL_AUTOTABCLM#, TYPE=BYTCND);
      303+   10643           %KV_SUBSTR (ID=KV_PRMID_WRDWRP, OFFSET=TRMCTL_WORDWRAPCLM#, TYPE=BYTCND);
      304+   10663           %KV_SUBSTR (ID=KV_PRMID_WRDWRPCLM, OFFSET=TRMCTL_WORDWRAPCLM#, TYPE=BYTCND);
      305+   10683           %KV_SUBSTR (ID=KV_PRMID_PRKCRS, OFFSET=TRMCTL_PARKCURSOR#, TYPE=BITCND);
      306+   10703           %KV_SUBSTR (ID=KV_PRMID_CRSRED, OFFSET=TRMCTL_CURSORREAD#, TYPE=BITCND);
      307+   10723           %KV_SUBSTR (ID=KV_PRMID_AUTCRS, OFFSET=TRMCTL_AUTOCURSOR#, TYPE=BITCND);
      308+   10743           %KV_SUBSTR (ID=KV_PRMID_KEPTYP, OFFSET=TRMCTL_KEEPTYPAHD#, TYPE=BITCND);
      309+   10763           %KV_SUBSTR (ID=KV_PRMID_ADJTOPLFT, OFFSET=TRMCTL_ADJTOPLFT#, TYPE=BITCND);
      310+   10783        %KV_PARM (ID=KV_PRMID_TRMTAB, TYPE=SHRBFR, STR=MRD, OFFSET=KV$MRD_TRMTAB$#,
      311+   10784                 BFRTYP=KV_STRTYP_TRMTAB, BFRLNG=1);
      312+   10824       %KV_PARM (ID=KV_PRMID_TRNUSRINPFNC, TYPE=BIT, STR=STR, OFFSET=KV$STR_TRNUSRINPFNC#);
      313+   10864        %KV_PARM (ID=KV_PRMID_TRUNCATE, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_TRUNCATE#);
      314+   10904        %KV_PARM (ID=KV_PRMID_TRUOVRPRT, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_TRUOVRPRT#);
      315+   10944        %KV_PARM (ID=KV_PRMID_TTYTYPE, TYPE=BIT, STR=MRD, OFFSET=KV$MRD_TTYTYPE#);
      316+   10984        %KV_PARM (ID=KV_PRMID_UPPERCASE, TYPE=BIT, STR=MVD, OFFSET=KV$MVD_UPPERCASE#);
      317+   11024        %KV_PARM (ID=KV_PRMID_USRHLTINH, TYPE=BIT, STR=SSN, OFFSET=KV$SSN_USRHLTINH#);
      318+   11064        %KV_PARM (ID=KV_PRMID_VBRDCHR, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_VBRDCHR#,
      319+   11065                 MIN=32, MAX=255);
      320+   11105        %KV_PARM (ID=KV_PRMID_VBRDSIZ, TYPE=BYTE, STR=SRD, OFFSET=KV$SRD_VBRDSIZ#-4,
      321+   11106                  MIN=1, MAX=15);
      322+   11146        %KV_PARM (ID=KV_PRMID_VFU, TYPE=SHRBFR, STR=MVD, OFFSET=KV$MVD_VFU$#,
      323+   11147                 BFRTYP=KV_STRTYP_VFU, BFRLNG=32);
      324+   11187        %KV_PARM (ID=KV_PRMID_VRTSCRMRG, TYPE=BYTE, STR=SVD, OFFSET=KV$RCRLST_VRTSCRMRG#);
      325+   11227        %KV_PARM (ID=KV_PRMID_VRTSCRSHF, TYPE=BYTE, STR=SVD, OFFSET=KV$RCRLST_VRTSCRSHF#);
      326+   11267        %KV_PARM (ID=KV_PRMID_WINDOW, TYPE=STRUCT, MAX="(WINDOW_REMOVABLE#+8)");
      327+   11326           %KV_SUBSTR (ID=KV_PRMID_WINDOW, TYPE=OTHER); /* Create it first */
      328+   11346           %KV_SUBSTR (ID=KV_PRMID_MINLNG, OFFSET=WINDOW_MINLENGTH#, TYPE=BYTCND);
      329+   11366           %KV_SUBSTR (ID=KV_PRMID_MINWDT, OFFSET=WINDOW_MINWIDTH#, TYPE=BYTCND);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:60   
      330+   11386           %KV_SUBSTR (ID=KV_PRMID_TOPBRD, OFFSET=WINDOW_TOPBRDR#, TYPE=BITCND);
      331+   11406           %KV_SUBSTR (ID=KV_PRMID_BTMBRD, OFFSET=WINDOW_BTMBRDR#, TYPE=BITCND);
      332+   11426           %KV_SUBSTR (ID=KV_PRMID_HBRDCHR, OFFSET=WINDOW_HBRDRCHR#, TYPE=BYT);
      333+   11446           %KV_SUBSTR (ID=KV_PRMID_LFTBRD, OFFSET=WINDOW_LFTBRDR#, TYPE=BITCND);
      334+   11466           %KV_SUBSTR (ID=KV_PRMID_RHTBRD, OFFSET=WINDOW_RHTBRDR#, TYPE=BITCND);
      335+   11486           %KV_SUBSTR (ID=KV_PRMID_VBRDCHR, OFFSET=WINDOW_VBRDRCHR#, TYPE=BYT);
      336+   11506           %KV_SUBSTR (ID=KV_PRMID_SRDOPT, OFFSET=WINDOW_REMOVABLE#, TYPE=BITCND);
      337+   11526           %KV_SUBSTR (ID=KV_PRMID_HBRDSIZ, OFFSET=WINDOW_HBRDRSIZ#, TYPE=BIN4);
      338+   11546           %KV_SUBSTR (ID=KV_PRMID_VBRDSIZ, OFFSET=WINDOW_VBRDRSIZ#, TYPE=BIN4);
      339+   11566           %KV_SUBSTR (ID=KV_PRMID_SRDOPT, TYPE=OTHER); /* Fix the screen if BRDUPD */
      340+   11586        %KV_PARM (ID=KV_PRMID_WRDWRP, TYPE=BIT, STR=STR, OFFSET=KV$STR_WRDWRP#);
      341+   11626        %KV_PARM (ID=KV_PRMID_WRDWRPCLM, TYPE=BYTE, STR=STR, OFFSET=KV$STR_WRDWRPCLM#);
      342+   11666        %KV_PARM (ID=KV_PRMID_WRPPAG, TYPE=BIT, STR=SRD, OFFSET=KV$SRD_WRPPAG#);
      343+   11706        %KV_END_PARMS;
             11712    1  DCL 1 KV_PRMTBL CONSTANT SYMDEF,2 IDS CHAR(0)INIT('  \K:qL&6k  rnW |4l5` g  , jhi of
             11712       D>-%N      1}+8 _IJ^   "   u 7 $#m     	Hs*'9V { zy  ] ~bU(;e vFCPtE caQw3X d .[ZR M
             11712           O  S B  A@0   	)TpxGY    ! /  '),
             11714    1  2 TYPES CHAR(0)INIT('                                                               
             11714                                                                                           
             11714           '),2 TYPE(0:149)REDEF TYPES UBIN BYTE CALIGNED, 2 INDXS CHAR(0)INIT
             11715    1  ('            	                                       !  "#	  $%&''  () * ''+,-  .  
             11715        /   012  34567 89:; <)=	>?@ 0A2B  C DE5DFGHIJJK LMNOOx PQRSTU     #V W'),2 INDX(0:
             11715            149)REDEF INDXS UBIN BYTE CALIGNED;DCL 1 KV_WHERES CONSTANT SYMDEF,2 * CHAR(0)
             11715            INIT
             11716    1  ('  p 1H`|  Ajq   qsq}qnaC"xqr  q~q   qoqpqq  qyqvAXAiAY`xPZq q       AmPOqkAl 	p qw
             11716    1  aRq q	AZqj _  #y#z    aPqhPhqtql" A[`j Q  `hq{`}quAx`iAhaS`l  p AnA\a@A]A^PYaB1h`mqx
             11716        q|A_" 1i`o'),2 * CHAR(0)INIT(
             11716            '0< J <08p p+@;`9`8@/@,P P @)@9p, K`=`<p*p @(@  207060 `;`:P P 0:'),2 * CHAR(0)
             11716            INIT('0 @ p @ 0 ` @ @ 0 p 0   p @ ');
             11718    1   DCL 1 KV_WHERE(0:133)REDEF KV_WHERES,2 STRUCTURE UBIN(4)UNAL,2 OFFSET UBIN(12)UNAL;
             11718            DCL KV_WHROFFS(0:7)CONSTANT UBIN
             11721    1   INIT(0,0,88,120,88,120,0,0);DCL KV_MINS CONSTANT SYMDEF CHAR(0)INIT(
             11721            '                                                                ');DCL KV_MIN
             11722    1   (0:31)REDEF KV_MINS UBIN;DCL KV_MAXS CONSTANT SYMDEF CHAR(0)INIT(
             11722            '                                                                ');DCL KV_MAX
             11723    1  (0:31)REDEF KV_MAXS UBIN;DCL KV_BFRLNGS CONSTANT SYMDEF CHAR(0)INIT('  R           '
             11723            );DCL KV_BFRLNG
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:61   
             11724    1  (0:13)REDEF KV_BFRLNGS UBIN BYTE CALIGNED;DCL KV_BFRTYPS CONSTANT SYMDEF CHAR(0)INIT
             11724            ('              ');DCL
             11725    1   KV_BFRTYP(0:13)REDEF KV_BFRTYPS UBIN BYTE CALIGNED;
             11728    1  DCL 1 KV_STRS CONSTANT SYMDEF,2 * CHAR(0)INIT('                        @           
             11728    1   @  @ $        0  $          0 0 0 0 0   @    ''            0     0              0 1
             11728    1   2 3 4 5 6 7 8                @ @ 0                                      "0% ( * , .
             11728        $     	  0 0  4 2 \0]   6   X p Z                '),2 * CHAR(0)INIT('     " $ & (  
             11728                    , .     B D J H @     * F K       p r v t x  @      ` b   p r    @d@t@ 
             11728          ');DCL 1 KV_STR(0:176)REDEF
             11729    1  KV_STRS,2 TYPE UBIN(4)UNAL,2 OFFSET UBIN(12)UNAL;DCL KV_STRIDS CONSTANT SYMDEF CHAR(
             11729    1      0)INIT('           . "01# !$; >Y[Z\ ]^_9`abc      ~   * a >X >     /T )KDU3     
             11729         >    defghijklmnopqrs 	tuvwx yz{`|}(&=%',-+89 DEFIJKMNOPQRS@ABCGHLU VW  =    T ) /
             11729         3567:               ');DCL KV_STRID
             11730    1   (0:176)REDEF KV_STRIDS UBIN BYTE UNAL;
       34    11745    1  DCL MASKS(0:7) CONSTANT BIT(8) INIT('00'X,'01'X,'03'X,'07'X,'0F'X,'1F'X,'3F'X,'7F'X)
             11745            ;
       35    11746    1   DCL KV_PTR_OFFSETS(0:7) CONSTANT SBIN
       36    11747    1    INIT(0,0/*VDI*/,2/*SSN*/,4/*STR*/,6/*MVD*/,14/*SVD*/,10/*SRD*/,8/*MRD*/);
       37    11748        %PLIST;
       38    11749        %VLP_SCODE (FPTN=KVP_PRMID,STCLASS=CONSTANT,FCG=KV,MID=P,ERR#=%S$KV_PRMID);
       39    11810        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:62   
       40    11811        /* CONTEXT STRUCTURES */
       41    11812        %KV$PTR;
       42    11855        %KV$VDI;
       43    11926        %KV$SSN;
       44    12005        %KV$STR;
       45    12092        %KV$MVD;
       46    12136        %KV$SRD;
       47    12411        %KV$MRD;
       48    12458        %KV$SHRBFR;
       49    12490        %KV$TITLE;
       50    12538        %INCLUDE KV_GLBASM_E;
       51    12556        %KV$INPFNCTBL;
       52    12640        %KV$TRNTBL;
       53    12698    1   DCL KV_SND_RQSDAT_GNR UBIN SYMREF;
       54    12699        %KV$VDH_GETBFR(NAME=KV_VDH_GETBFR,STCLASS=SYMREF);
       55    12764        %KV$VDH_GETBFR;
       56    12829        %KV$VDH_OTPLCL (NAME=KV_VDH_OTPLCL_TRN, STCLASS=CONSTANT SYMDEF, TRN=YES);
       57    12902        %KV$VDH_OTPLCL;
       58    12975        %KV$VDH_RLSBFR;
       59    13011        %KV$USRPRM;
       60    13062        %KV$USR_DAT (NAME=KV_USR_DAT, STCLASS=SYMREF);
       61    13146        %KV$USR_DAT;
       62    13230        %KV$ERD (STCLASS="BASED(TEMP$)");
       63    13314        %KH$CHN;
       64    13438        %VLP_WINDOW (FPTN=WINDOW, STCLASS="BASED(STR$)");
       65    13482        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:63   
       66    13483        /* Program contained elsewhere */
       67    13484    1   DCL KHD$SCREECH ENTRY(1);
       68    13485    1   DCL KVC$DRWBRD ENTRY;
       69    13486    1   DCL KVC$WINDOW1 ENTRY(1) ALTRET;
       70    13487    1   DCL KVC$WINDOW2 ENTRY(1) ALTRET;
       71    13488    1   DCL KVE$FIXHRZSCR ENTRY ALTRET;
       72    13489    1   DCL KVE$PST ENTRY ALTRET;
       73    13490    1   DCL KVI$NEWINPFNCTBL ENTRY;
       74    13491    1   DCL KVM$SND ENTRY(1) ALTRET;
       75    13492    1   DCL KVO$OTP1_VRT ENTRY(1);
       76    13493    1   DCL KVO$OTPLCL ENTRY(1);
       77    13494    1   DCL KVP$FNCKEY ENTRY(1);
       78    13495    1   DCL KVS$GETBFR ENTRY(1) ALTRET;
       79    13496    1   DCL KVS$RLSBFR ENTRY(1) ALTRET;
       80    13497    1   DCL KVS$SETSTR ENTRY(1);
       81    13498    1   DCL KVV$CALUSR ENTRY(1) ALTRET;
       82    13499    1   DCL KVV$CALUSR_EVT ENTRY(1) ALTRET;
       83    13500    1   DCL KVV$CALUSR_PST ENTRY ALTRET;
       84    13501    1   DCL 1 BI BASED(STR$) ALIGNED,
       85    13502    1          2 T(0:0) BIT(1);
       86    13503    1   DCL 1 BYT BASED(STR$) ALIGNED,
       87    13504    1          2 E(0:0) UBIN(8) UNAL;
       88    13505    1   DCL 1 WOR BASED(STR$) ALIGNED,
       89    13506    1          2 D(0:0) UBIN;
       90    13507    1   DCL 1 PT BASED(TEMP$) ALIGNED,
       91    13508    1          2 R PTR;
       92    13509    1   DCL CHARS CHAR(255) BASED;
       93    13510        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:64   
       94    13511        /* AUTO VARIABLESS */
       95    13512    1   DCL KV$VDH_XXXPRM CHAR(I);
       96    13513        %KV$VDH_SETPRM (STCLASS=REDEF KV$VDH_XXXPRM);
       97    13575        %KV$VDH_GETPRM (STCLASS=REDEF KV$VDH_XXXPRM);
       98    13637    1   DCL STR$ PTR;
       99    13638    1   DCL TEMP$ PTR;
      100    13639        %KV$VDH_SETPRM(NAME=VDH_SETPRM,STCLASS=);
      101    13701        %KV$USR_SETPRM(NAME=USR_SETPRM REDEF VDH_SETPRM,STCLASS=);
      102    13763    1   DCL I UBIN;
      103    13764    1   DCL J UBIN;
      104    13765    1   DCL OFFSET SBIN;
      105    13766    1   DCL MAXBYTX SBIN;
      106    13767    1   DCL 1 STRLST REDEF MAXBYTX,        /* indicates many-part GETPRMS like SAVGET */
      107    13768    1          2 INDX UBIN BYTE CALIGNED,
      108    13769    1          2 SKPCNT UBIN BYTE CALIGNED;
      109    13770    1   DCL TEMP CHAR(1);                       /* **** PL6 BUG ****                  */
      110    13771    1   DCL FPT(0:15) UBIN;
      111    13772        %EQU CHRBFR=CHARTEXT('ADDR(FPT)->CHARS');
      112    13773        %EQU VDH_GETBFR=CHARTEXT('ADDR(FPT)->KV$VDH_GETBFR');
      113    13774        %EQU VDH_RLSBFR=CHARTEXT('ADDR(FPT)->KV$VDH_RLSBFR');
      114    13775        %EQU VDH_OTPLCL=CHARTEXT('ADDR(FPT)->KV$VDH_OTPLCL');
      115    13776        %EQU USR_DAT=CHARTEXT('ADDR(FPT)->KV$USR_DAT');
      116    13777        %EJECT;                                 /* CODE FOLLOWS                       */
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:65   
      117    13778    1   KVP$SETPRM: ENTRY (KV$VDH_XXXPRM);

  13778   1 000007  D380 0000 0000  xent KVP$SETPRM      LNJ,B5   X6A_AUTO_1
          1 00000A       0052 0001                       DC       82,1

      118    13779        /* Tell the user about it */
      119    13780    1      IF %KV_VDI.USREVTENB(%KV_USR_EVT_ID_BGNSETPRM)

  13780   1 00000C  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00000F  DC86                                 LDB,B5   ,B6
          1 000010  82C5 001E                            LB,'0040'X        30,B5
          1 000012       0040
          1 000013  0581 000A                            BBF      s:13783,PREL

      120    13781    1      THEN CALL KVV$CALUSR_EVT(%KV_USR_EVT_ID_BGNSETPRM);

  13781   1 000015  BB80 0000 0001  02                   LAB,B3   +1
          1 000018  CBF0 0100                            LAB,B4   256,IMO
          1 00001A  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR_EVT
          1 00001D       0001                            DC       s:13783,PREL

      121    13782        /* Set up a local copy of SETPRM FPT */
      122    13783    1      VDH_SETPRM=KV$VDH_SETPRM;

  13783   1 00001E  ACC7 0004                            LDB,B2   @KV$VDH_XXXPRM,AUTO
          1 000020  2C00                                 LDV,R2   0
          1 000021  6C10                                 LDV,R6   16
          1 000022  BB87                                 LAB,B3   ,AUTO
          1 000023  3C14                                 LDV,R3   20
          1 000024  0008                                 MMM

      123    13784    1      MAXBYTX = MAXIMUM (VDH_SETPRM.VAL_.BYTX+VDH_SETPRM.VAL_.BYTSIZ, 1);

  13784   1 000025  E847 000F                            LDR,R6   VDH_SETPRM+5,AUTO
          1 000027  EA47 0010                            ADD,R6   VDH_SETPRM+6,AUTO
          1 000029  E970 0001                            CMR,R6   1,IMO
          1 00002B  0881 0002                            BAGE     s:13784+9,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:66   
          1 00002D  6C01                                 LDV,R6   1
          1 00002E  EF47 0015                            STR,R6   MAXBYTX,AUTO

      124    13785    2      DO WHILE VDH_SETPRM.VAL_.BYTX < MAXBYTX;

  13785   1 000030  E947 000F                            CMR,R6   VDH_SETPRM+5,AUTO
          1 000032  0A81 01E1                            BALE     s:13893,PREL

      125    13786    3         IF KV$VDH_SETPRM.PRMID=%KV_PRMID_TYPLNG THEN DO;

  13786   1 000034  ECC7 0004                            LDB,B6   @KV$VDH_XXXPRM,AUTO
          1 000036  E846 0001                            LDR,R6   1,B6
          1 000038  6D3F                                 CMV,R6   63
          1 000039  0981 002D                            BNE      s:13800,PREL

      126    13787                                 /* We have a list of structures - as in a profile    */
      127    13788    3            VDH_SETPRM.PRMID=VDH_SETPRM.VAL_.ADR$->BYT.E(VDH_SETPRM.VAL_.BYTX);

  13788   1 00003B  DCC7 000D                            LDB,B5   VDH_SETPRM+3,AUTO
          1 00003D  B847 000F                            LDR,R3   VDH_SETPRM+5,AUTO
          1 00003F  D2B5                                 LLH,R5   ,B5,R3
          1 000040  DF47 000B                            STR,R5   VDH_SETPRM+1,AUTO

      128    13789    3            VDH_SETPRM.VAL_.BYTSIZ=

  13789   1 000042  3E01                                 ADV,R3   1
          1 000043  E2B5                                 LLH,R6   ,B5,R3
          1 000044  EF47 0010                            STR,R6   VDH_SETPRM+6,AUTO

      129    13790    3              VDH_SETPRM.VAL_.ADR$->BYT.E(VDH_SETPRM.VAL_.BYTX+1);
      130    13791    3            VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX+2;

  13791   1 000046  C847 000F                            LDR,R4   VDH_SETPRM+5,AUTO
          1 000048  4E02                                 ADV,R4   2
          1 000049  CF47 000F                            STR,R4   VDH_SETPRM+5,AUTO

      131    13792    3            VDH_SETPRM.VAL=VDH_SETPRM.VAL_.ADR$->WOR.D(VDH_SETPRM.VAL_.BYTX/2);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:67   

  13792   1 00004B  C370 0002                            DIV,R4   2,IMO
          1 00004D  B854                                 LDR,R3   R4
          1 00004E  C835                                 LDR,R4   ,B5,R3
          1 00004F  CF47 000C                            STR,R4   VDH_SETPRM+2,AUTO

      132    13793    4            IF VDH_SETPRM.PRMID=%KV_PRMID_BIGTL THEN DO;

  13793   1 000051  D970 00FF                            CMR,R5   255,IMO
          1 000053  0981 0015                            BNE      s:13802,PREL

      133    13794    4               VDH_SETPRM.PRMID = VDH_SETPRM.VAL_.BYTSIZ;

  13794   1 000055  D856                                 LDR,R5   R6
          1 000056  DF47 000B                            STR,R5   VDH_SETPRM+1,AUTO

      134    13795    4               VDH_SETPRM.VAL_.BYTSIZ = VDH_SETPRM.VAL;

  13795   1 000058  D854                                 LDR,R5   R4
          1 000059  DF47 0010                            STR,R5   VDH_SETPRM+6,AUTO

      135    13796    4               VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX+2;

  13796   1 00005B  B847 000F                            LDR,R3   VDH_SETPRM+5,AUTO
          1 00005D  3E02                                 ADV,R3   2
          1 00005E  BF47 000F                            STR,R3   VDH_SETPRM+5,AUTO

      136    13797    4               VDH_SETPRM.VAL=VDH_SETPRM.VAL_.ADR$->WOR.D(VDH_SETPRM.VAL_.BYTX/2);

  13797   1 000060  B370 0002                            DIV,R3   2,IMO
          1 000062  C835                                 LDR,R4   ,B5,R3
          1 000063  CF47 000C                            STR,R4   VDH_SETPRM+2,AUTO

      137    13798    4            END;

      138    13799    3         END;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:68   
  13799   1 000065  0F81 0003                            B        s:13802,PREL

      139    13800    2         ELSE MAXBYTX=0;                   /* Only one thing to do               */

  13800   1 000067  8747 0015                            CL       MAXBYTX,AUTO

      140    13801        /*N*  CALL INDEX(I,BINASC(VDH_SETPRM.PRMID),KV_PRMTBL.IDS) WHENRETURN DO;*/
      141    13802    2         TEMP=BINASC(VDH_SETPRM.PRMID);    /* **** PL6 BUG ****                  */

  13802   1 000069  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 00006B  6008                                 SOL,R6   8
          1 00006C  6068                                 SAR,R6   8
          1 00006D  E7C7 0016                            STH,R6   TEMP,AUTO

      142    13803    3         CALL INDEX(I,TEMP,KV_PRMTBL.IDS) WHENRETURN DO; /* **** PL6 BUG ****    */

  13803   1 00006F  DB80 0000 0000  00                   LAB,B5   KV_PRMTBL
          1 000072  E870 0196                            LDR,R6   406,IMO
          1 000074  0028                                 SRH      ;
          1 000075       4107 0016                                ALPHANUM(TEMP,AUTO,,1),;
          1 000077       4407 0050                                BINARY(OLDVAL+2,AUTO,,4),;
          1 000079       4005 0000                                ALPHANUM(0,B5,,R6)
          1 00007B  5381 0007                            CBE      s:13803+20,PREL
          1 00007D  D870 0096                            LDR,R5   150,IMO
          1 00007F  DF47 0012                            STR,R5   I,AUTO
          1 000081  0F81 0181                            B        s:13887,PREL
          1 000083  D847 0051                            LDR,R5   OLDVAL+3,AUTO
          1 000085  DF47 0012                            STR,R5   I,AUTO

      143    13804    3            VDH_SETPRM.DMN=0;

  13804   1 000087  8847 0011                            LBF,'00FF'X       VDH_SETPRM+7,AUTO
  13804   1 000089       00FF

      144    13805    4            IF KV_PRMTBL.TYPE(I)=%PRM_TYPE_STRUCT THEN DO;

  13805   1 00008A  B855                                 LDR,R3   R5
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:69   
          1 00008B  C2B0 0000 004B  00                   LLH,R4   KV_PRMTBL+75,R3
          1 00008E  4D07                                 CMV,R4   7
          1 00008F  0981 016E                            BNE      s:13885,PREL

      145    13806                                 /* Got a packed structure,loop thru all the pieces   */
      146    13807
      147    13808    4               VDH_SETPRM.VAL = 0;

  13808   1 000091  8747 000C                            CL       VDH_SETPRM+2,AUTO

      148    13809    4               J=KV_PRMTBL.INDX(I);        /* Start of the structures stuff      */

  13809   1 000093  A2B0 0000 0096  00                   LLH,R2   KV_PRMTBL+150,R3
          1 000096  AF47 0013                            STR,R2   J,AUTO

      149    13810    4               STR$=PINCRW(VDH_SETPRM.VAL_.ADR$,VDH_SETPRM.VAL_.BYTX/2);

  13810   1 000098  9847 000F                            LDR,R1   VDH_SETPRM+5,AUTO
          1 00009A  9370 0002                            DIV,R1   2,IMO
          1 00009C  DCC7 000D                            LDB,B5   VDH_SETPRM+3,AUTO
          1 00009E  CB95                                 LAB,B4   ,B5,R1
          1 00009F  CFC7 0006                            STB,B4   STR$,AUTO

      150    13811    5   STR_LOOP:   DO WHILE '1'B;

  13811   1                              STR_LOOP        null
      151    13812    5                  VDH_SETPRM.PRMID=KV_STRID(J);

  13812   1 0000A1  B847 0013            STR_LOOP        LDR,R3   J,AUTO
          1 0000A3  E2B0 0000 026E  00                   LLH,R6   KV_STRIDS,R3
          1 0000A6  EF47 000B                            STR,R6   VDH_SETPRM+1,AUTO

      152    13813    5                  IF VDH_SETPRM.PRMID=0 THEN EXIT; /* done at zero entry         */

  13813   1 0000A8  6901 0153                            BEZ,R6   s:13884,PREL

      153    13814    5                  OFFSET=KV_STR.OFFSET(J);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:70   

  13814   1 0000AA  D830 0000 01BD  00                   LDR,R5   KV_STRS,R3
          1 0000AD  D570 0FFF                            AND,R5   4095,IMO
          1 0000AF  DF47 0014                            STR,R5   OFFSET,AUTO

      154    13815    6                  DO CASE (KV_STR.TYPE(J));

  13815   1 0000B1  A830 0000 01BD  00                   LDR,R2   KV_STRS,R3
          1 0000B4  204C                                 SOR,R2   12
          1 0000B5  2D0D                                 CMV,R2   13
          1 0000B6  0281 00D5                            BGE      s:13859,PREL
          1 0000B8  9820 0000 00BE  01                   LDR,R1   s:13815+13,R2
          1 0000BB  8390 0000 00CB  01                   JMP      s:13817,R1
          1 0000BE       0009                            DC       s:13819,PREL
          1 0000BF       0000                            DC       s:13817,PREL
          1 0000C0       00C1                            DC       s:13859,PREL
          1 0000C1       00C1                            DC       s:13859,PREL
          1 0000C2       00C1                            DC       s:13859,PREL
          1 0000C3       00C1                            DC       s:13859,PREL
          1 0000C4       00C1                            DC       s:13859,PREL
          1 0000C5       00C1                            DC       s:13859,PREL
          1 0000C6       0015                            DC       s:13823,PREL
          1 0000C7       0037                            DC       s:13833,PREL
          1 0000C8       0026                            DC       s:13827,PREL
          1 0000C9       00F2                            DC       s:13868,PREL
          1 0000CA       0041                            DC       s:13836,PREL

      155    13816    6                  CASE(%PRM_STR_TYPE_BITCND);

      156    13817    6                     IF BI.T(OFFSET+1) THEN GOTO NO_PARM;

  13817   1 0000CB  ECC7 0006                            LDB,B6   STR$,AUTO
          1 0000CD  B855                                 LDR,R3   R5
          1 0000CE  3E01                                 ADV,R3   1
          1 0000CF  82B6                                 LB       ,B6,R3
          1 0000D0  0501 0125                            BBT      s:13881,PREL

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:71   
      157    13818    6                     GOTO STR_BIT;

  13818   1 0000D2  0F81 0001                            B        s:13819,PREL

      158    13819    6                  CASE(%PRM_STR_TYPE_BIT);

      159    13820    6   STR_BIT:          VDH_SETPRM.VAL=0;

  13820   1 0000D4  8747 000C            STR_BIT         CL       VDH_SETPRM+2,AUTO

      160    13821    6                     IF BI.T(OFFSET) THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;

  13821   1 0000D6  ECC7 0006                            LDB,B6   STR$,AUTO
          1 0000D8  B855                                 LDR,R3   R5
          1 0000D9  82B6                                 LB       ,B6,R3
          1 0000DA  0581 0104                            BBF      s:13876,PREL

  13821   1 0000DC  8AC7 000C                            INC      VDH_SETPRM+2,AUTO
          1 0000DE  0F81 0100                            B        s:13876,PREL

      161    13822    6                  CASE(%PRM_STR_TYPE_EXTBIT);

      162    13823    6                     IF BI.T(OFFSET) THEN VDH_SETPRM.VAL=254;

  13823   1 0000E0  ECC7 0006                            LDB,B6   STR$,AUTO
          1 0000E2  B855                                 LDR,R3   R5
          1 0000E3  82B6                                 LB       ,B6,R3
          1 0000E4  0581 0007                            BBF      s:13824,PREL

  13823   1 0000E6  C870 00FE                            LDR,R4   254,IMO
          1 0000E8  CF47 000C                            STR,R4   VDH_SETPRM+2,AUTO
          1 0000EA  0F81 0004                            B        s:13825,PREL

      163    13824    6                     ELSE IF VDH_SETPRM.PRMID=%KV_PRMID_STRDON THEN EXIT STR_LOOP;

  13824   1 0000EC  6D3D                                 CMV,R6   61
          1 0000ED  0901 010E                            BE       s:13884,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:72   

      164    13825    6                     GOTO EXT_XIT; /* don't do anything, just flag for next  val */

  13825   1 0000EF  0F81 0108                            B        s:13882,PREL

      165    13826    6                  CASE(%PRM_STR_TYPE_BYTCND);

      166    13827    7                     IF BYT.E(OFFSET)=255 THEN DO;

  13827   1 0000F1  ECC7 0006                            LDB,B6   STR$,AUTO
          1 0000F3  B855                                 LDR,R3   R5
          1 0000F4  C2B6                                 LLH,R4   ,B6,R3
          1 0000F5  C970 00FF                            CMR,R4   255,IMO
          1 0000F7  0981 0008                            BNE      s:13832,PREL

      167    13828    7                        IF VDH_SETPRM.PRMID=%KV_PRMID_REDTIMOUTPRD THEN J=J+1;

  13828   1 0000F9  6D5B                                 CMV,R6   91
          1 0000FA  0981 0003                            BNE      s:13830,PREL

  13828   1 0000FC  8AC7 0013                            INC      J,AUTO

      168    13829        /* No value means no units,too. */
      169    13830    7                        GOTO NO_PARM;

  13830   1 0000FE  0F81 00F7                            B        s:13881,PREL

      170    13831    7                     END;
      171    13832    6                     GOTO STR_BYTE;

  13832   1 000100  0F81 0001                            B        s:13833,PREL

      172    13833    6                  CASE(%PRM_STR_TYPE_BYT);

      173    13834    6   STR_BYTE:         VDH_SETPRM.VAL=VDH_SETPRM.VAL+BYT.E(OFFSET);

  13834   1 000102  ECC7 0006            STR_BYTE        LDB,B6   STR$,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:73   
          1 000104  B855                                 LDR,R3   R5
          1 000105  C2B6                                 LLH,R4   ,B6,R3
          1 000106  CA47 000C                            ADD,R4   VDH_SETPRM+2,AUTO
          1 000108  CF47 000C                            STR,R4   VDH_SETPRM+2,AUTO
          1 00010A  0F81 00D4                            B        s:13876,PREL

      174    13835    6                  CASE(%PRM_STR_TYPE_OTHER);

      175    13836    7                     DO SELECT VDH_SETPRM.PRMID;

  13836   1 00010C  E970 0010                            CMR,R6   16,IMO
          1 00010E  0201 0009                            BL       s:13836+12,PREL
          1 000110  0901 002E                            BE       s:13843,PREL
          1 000112  E970 0098                            CMR,R6   152,IMO
          1 000114  0981 006F                            BNE      s:13856,PREL
          1 000116  0F81 000E                            B        s:13838,PREL
          1 000118  E970 000C                            CMR,R6   12,IMO
          1 00011A  0201 0005                            BL       s:13836+20,PREL
          1 00011C  0901 003E                            BE       s:13849,PREL
          1 00011E  0F81 0065                            B        s:13856,PREL
          1 000120  6D0B                                 CMV,R6   11
          1 000121  0981 0062                            BNE      s:13856,PREL
          1 000123  0F81 0043                            B        s:13851,PREL

      176    13837    7                        SELECT %KV_PRMID_SRDOPT;

      177    13838    7                        CALL KVC$WINDOW2 (WOR.D);

  13838   1 000125  BBC7 0006                            LAB,B3   STR$,AUTO
          1 000127  CBF0 0100                            LAB,B4   256,IMO
          1 000129  E380 0000 0000  xent                 LNJ,B6   KVC$WINDOW2
          1 00012C       0001                            DC       s:13839,PREL

      178    13839    7                        IF %KV_SRD.BRDUPD THEN CALL KVC$DRWBRD;

  13839   1 00012D  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000130  DCC6 000A                            LDB,B5   10,B6
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:74   
          1 000132  82C5 000F                            LB,'0010'X        15,B5
          1 000134       0010
          1 000135  0581 0007                            BBF      s:13840,PREL

  13839   1 000137  CBF0 0000                            LAB,B4   0,IMO
          1 000139  E380 0000 0000  xent                 LNJ,B6   KVC$DRWBRD
          1 00013C       0001                            DC       s:13840,PREL

      179    13840    7                        GOTO NO_PARM;

  13840   1 00013D  0F81 00B8                            B        s:13881,PREL

      180    13841    7                        SELECT %KV_PRMID_WINDOW;

      181    13842        /* Do the positioning if we're on the scheduled thread. */
      182    13843    7                        IF VDH_SETPRM.SCP~=%KV_SCP_ONE_ONLY THEN CALL KVS$SETSTR;

  13843   1 00013F  C2C7 0011                            LLH,R4   VDH_SETPRM+7,AUTO
          1 000141  4D08                                 CMV,R4   8
          1 000142  0901 0007                            BE       s:13844,PREL

  13843   1 000144  CBF0 0000                            LAB,B4   0,IMO
          1 000146  E380 0000 0000  xent                 LNJ,B6   KVS$SETSTR
          1 000149       0001                            DC       s:13844,PREL

      183    13844    8                        CALL KVC$WINDOW1 (WOR.D) WHENALTRETURN DO;

  13844   1 00014A  BBC7 0006                            LAB,B3   STR$,AUTO
          1 00014C  CBF0 0100                            LAB,B4   256,IMO
          1 00014E  E380 0000 0000  xent                 LNJ,B6   KVC$WINDOW1
          1 000151       0003                            DC       s:13845,PREL
          1 000152  0F81 0003                            B        s:13847,PREL

      184    13845    8                           EXIT STR_LOOP;

  13845   1 000154  0F81 00A7                            B        s:13884,PREL

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:75   
      185    13846    8                        END;
      186    13847    7                        VDH_SETPRM.SCP = %KV_SCP_ONE_ONLY;

  13847   1 000156  6C08                                 LDV,R6   8
          1 000157  E7C7 0011                            STH,R6   VDH_SETPRM+7,AUTO
          1 000159  0F81 0085                            B        s:13876,PREL

      187    13848    7                        SELECT %KV_PRMID_EDTCTL;

      188    13849    7                        IF %KV_MVD.ORG~=%KV#VD_ORG_SE THEN EXIT STR_LOOP;

  13849   1 00015B  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00015E  DCC6 0006                            LDB,B5   6,B6
          1 000160  C2C5 0015                            LLH,R4   21,B5
          1 000162  4D05                                 CMV,R4   5
          1 000163  0981 0098                            BNE      s:13884,PREL
          1 000165  0F81 0079                            B        s:13876,PREL

      189    13850    7                        SELECT %KV_PRMID_SINPUT;

      190    13851    7                        IF %KV_MVD.ORG~=%KV#VD_ORG_SE

  13851   1 000167  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00016A  DCC6 0006                            LDB,B5   6,B6
          1 00016C  C2C5 0015                            LLH,R4   21,B5
          1 00016E  4D05                                 CMV,R4   5
          1 00016F  0981 0086                            BNE      s:13881,PREL
          1 000171  CCC6 0004                            LDB,B4   4,B6
          1 000173  E2C4 001C                            LLH,R6   28,B4
          1 000175  D847 0011                            LDR,R5   VDH_SETPRM+7,AUTO
          1 000177  D570 00FF                            AND,R5   255,IMO
          1 000179  E955                                 CMR,R6   R5
          1 00017A  0981 007B                            BNE      s:13881,PREL

      191    13852    7                          OR %KV_STR.ID~=VDH_SETPRM.DMN THEN GOTO NO_PARM;
      192    13853    7                        CALL KVE$PST;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:76   
  13853   1 00017C  CBF0 0000                            LAB,B4   0,IMO
          1 00017E  E380 0000 0000  xent                 LNJ,B6   KVE$PST
          1 000181       0001                            DC       s:13854,PREL

      193    13854    7                        EXIT STR_LOOP;

  13854   1 000182  0F81 0079                            B        s:13884,PREL

      194    13855    7                        SELECT ELSE;

      195    13856    7                     VDH_SETPRM.VAL=WOR.D(OFFSET);

  13856   1 000184  ECC7 0006                            LDB,B6   STR$,AUTO
          1 000186  B855                                 LDR,R3   R5
          1 000187  C836                                 LDR,R4   ,B6,R3
          1 000188  CF47 000C                            STR,R4   VDH_SETPRM+2,AUTO

      196    13857    7                     END;

  13857   1 00018A  0F81 0054                            B        s:13876,PREL

      197    13858    6                  CASE(ELSE);              /* ODD LENGTH BINARY (2 THRU 7 BITS)  */

      198    13859    6                     VDH_SETPRM.VAL=WOR.D(OFFSET/16);

  13859   1 00018C  D370 0010                            DIV,R5   16,IMO
          1 00018E  ECC7 0006                            LDB,B6   STR$,AUTO
          1 000190  9855                                 LDR,R1   R5
          1 000191  D816                                 LDR,R5   ,B6,R1
          1 000192  DF47 000C                            STR,R5   VDH_SETPRM+2,AUTO

      199    13860    6                     OFFSET=MOD(OFFSET,16)+KV_STR.TYPE(J);

  13860   1 000194  E847 0014                            LDR,R6   OFFSET,AUTO
          1 000196  70F0                                 DAR,R7   16
          1 000197  F370 0010                            DIV,R7   16,IMO
          1 000199  AA56                                 ADD,R2   R6
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:77   
          1 00019A  AF47 0014                            STR,R2   OFFSET,AUTO

      200    13861    7                     DO WHILE(OFFSET < 16);

  13861   1 00019C  2D10                                 CMV,R2   16
          1 00019D  0881 000C                            BAGE     s:13865,PREL

      201    13862    7                        VDH_SETPRM.VAL=VDH_SETPRM.VAL/2;

  13862   1 00019F  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 0001A1  6041                                 SOR,R6   1
          1 0001A2  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO

      202    13863    7                        OFFSET=OFFSET+1;

  13863   1 0001A4  8AC7 0014                            INC      OFFSET,AUTO

      203    13864    7                     END;

  13864   1 0001A6  D847 0014                            LDR,R5   OFFSET,AUTO
          1 0001A8  5D10                                 CMV,R5   16
          1 0001A9  0876                                 BAL      s:13862,SPREL

      204    13865    6                     VDH_SETPRM.VAL=

  13865   1 0001AA  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 0001AC  6008                                 SOL,R6   8
          1 0001AD  B847 0013                            LDR,R3   J,AUTO
          1 0001AF  A830 0000 01BD  00                   LDR,R2   KV_STRS,R3
          1 0001B2  204C                                 SOR,R2   12
          1 0001B3  D2A0 0000 02C7  00                   LLH,R5   MASKS,R2
          1 0001B6  5008                                 SOL,R5   8
          1 0001B7  D556                                 AND,R5   R6
          1 0001B8  5048                                 SOR,R5   8
          1 0001B9  DF47 000C                            STR,R5   VDH_SETPRM+2,AUTO
          1 0001BB  0F81 0023                            B        s:13876,PREL

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:78   
      205    13866    6                       BITBIN(BINBIT(VDH_SETPRM.VAL,8)&MASKS(KV_STR.TYPE(J)));
      206    13867    6                  CASE(%PRM_STR_TYPE_BFR);

      207    13868    6                     IF VDH_SETPRM.VAL_.BYTSIZ<OFFSET THEN GOTO NO_PARM;

  13868   1 0001BD  5801 0005                            BLZ,R5   s:13869,PREL
          1 0001BF  D947 0010                            CMR,R5   VDH_SETPRM+6,AUTO
          1 0001C1  0301 0034                            BG       s:13881,PREL

      208    13869    6                     VDH_SETPRM.VAL_.BYTSIZ=VDH_SETPRM.VAL_.BYTSIZ-OFFSET;

  13869   1 0001C3  D247 0010                            SUB,R5   VDH_SETPRM+6,AUTO
          1 0001C5  8255                                 NEG      R5
          1 0001C6  DF47 0010                            STR,R5   VDH_SETPRM+6,AUTO

      209    13870    6                     VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX+OFFSET;

  13870   1 0001C8  C847 000F                            LDR,R4   VDH_SETPRM+5,AUTO
          1 0001CA  CA47 0014                            ADD,R4   OFFSET,AUTO
          1 0001CC  CF47 000F                            STR,R4   VDH_SETPRM+5,AUTO

      210    13871    6                     CALL SETPTR;          /* We need to restore BYTX and BYTSIZ */

  13871   1 0001CE  E3C0 005A                            LNJ,B6   s:0,PREL
          1 0001D0       0001                            DC       s:13872,PREL

      211    13872    6                     VDH_SETPRM.VAL_.BYTSIZ=VDH_SETPRM.VAL_.BYTSIZ+OFFSET;

  13872   1 0001D1  E847 0010                            LDR,R6   VDH_SETPRM+6,AUTO
          1 0001D3  EA47 0014                            ADD,R6   OFFSET,AUTO
          1 0001D5  EF47 0010                            STR,R6   VDH_SETPRM+6,AUTO

      212    13873    6                     VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX-OFFSET;

  13873   1 0001D7  D847 000F                            LDR,R5   VDH_SETPRM+5,AUTO
          1 0001D9  D247 0014                            SUB,R5   OFFSET,AUTO
          1 0001DB  DF47 000F                            STR,R5   VDH_SETPRM+5,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:79   

      213    13874    6                     GOTO NO_PARM;

  13874   1 0001DD  0F81 0018                            B        s:13881,PREL

      214    13875    6                  END;

      215    13876    5                  IF VDH_SETPRM.PRMID~=%KV_PRMID_DMN

  13876   1 0001DF  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 0001E1  6D3E                                 CMV,R6   62
          1 0001E2  0901 0006                            BE       s:13878,PREL

      216    13877    5                  THEN CALL SETPTR;        /* do the setprm for elementary parm  */

  13877   1 0001E4  E3C0 0044                            LNJ,B6   s:0,PREL
          1 0001E6       0001                            DC       s:13877+3,PREL
          1 0001E7  0F81 000E                            B        s:13881,PREL

      217    13878    5                  ELSE IF VDH_SETPRM.VAL~=0

  13878   1 0001E9  D847 000C                            LDR,R5   VDH_SETPRM+2,AUTO
          1 0001EB  5901 0006                            BEZ,R5   s:13880,PREL

      218    13879    5                  THEN VDH_SETPRM.DMN=VDH_SETPRM.VAL; /* Set domain.             */

  13879   1 0001ED  DAC7 0011                            SRM,R5,'00FF'X    VDH_SETPRM+7,AUTO
  13879   1 0001EF       00FF
          1 0001F0  0F81 0005                            B        s:13881,PREL

      219    13880    5                  ELSE VDH_SETPRM.DMN=1;

  13880   1 0001F2  4C01                                 LDV,R4   1
          1 0001F3  CAC7 0011                            SRM,R4,'00FF'X    VDH_SETPRM+7,AUTO
          1 0001F5       00FF

      220    13881    5   NO_PARM:       VDH_SETPRM.VAL=0;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:80   

  13881   1 0001F6  8747 000C            NO_PARM         CL       VDH_SETPRM+2,AUTO

      221    13882    5   EXT_XIT:       J=J+1;

  13882   1 0001F8  8AC7 0013            EXT_XIT         INC      J,AUTO

      222    13883    5               END;

  13883   1 0001FA  0F81 FEA6                            B        s:13811,PREL

      223    13884    4            END;

  13884   1 0001FC  0F81 0004                            B        s:13886,PREL

      224    13885    3            ELSE CALL SETPTR;              /* elementry parm, just do it         */

  13885   1 0001FE  E3C0 002A                            LNJ,B6   s:0,PREL
          1 000200       0001                            DC       s:13886,PREL

      225    13886    3         END; WHENALTRETURN DO;

  13886   1 000201  0F81 0005                            B        s:13889,PREL

      226    13887    3            IF MAXBYTX=0 THEN GOTO SCREECH; /* Single parm must exist.           */

  13887   1 000203  E847 0015                            LDR,R6   MAXBYTX,AUTO
          1 000205  6901 0DCE                            BEZ,R6   s:14926,PREL

      227    13888    3         END;

      228    13889    2         VDH_SETPRM.VAL_.BYTX=VDH_SETPRM.VAL_.BYTX+

  13889   1 000207  E847 0010                            LDR,R6   VDH_SETPRM+6,AUTO
          1 000209  6E01                                 ADV,R6   1
          1 00020A  6041                                 SOR,R6   1
          1 00020B  6001                                 SOL,R6   1
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:81   
          1 00020C  EA47 000F                            ADD,R6   VDH_SETPRM+5,AUTO
          1 00020E  EF47 000F                            STR,R6   VDH_SETPRM+5,AUTO

      229    13890    2           2*((VDH_SETPRM.VAL_.BYTSIZ+1)/2);
      230    13891    2      END;

  13891   1 000210  E947 0015                            CMR,R6   MAXBYTX,AUTO
          1 000212  0801 FE21                            BAL      s:13786,PREL

      231    13892        /* Now tell the user we're finished */
      232    13893    1      IF %KV_VDI.USREVTENB(%KV_USR_EVT_ID_ENDSETPRM)

  13893   1 000214  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000217  DC86                                 LDB,B5   ,B6
          1 000218  82C5 001E                            LB,'0004'X        30,B5
          1 00021A       0004
          1 00021B  0581 000A                            BBF      s:13895,PREL

      233    13894    1      THEN CALL KVV$CALUSR_EVT(%KV_USR_EVT_ID_ENDSETPRM);

  13894   1 00021D  BB80 0000 0004  02                   LAB,B3   +4
          1 000220  CBF0 0100                            LAB,B4   256,IMO
          1 000222  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR_EVT
          1 000225       0001                            DC       s:13895,PREL

      234    13895    1      RETURN;

  13895   1 000226  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      235    13896        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:82   
      236    13897        /*D* NAME: SETPTR
      237    13898        *    PURPOSE: Store elementary parameter in all copies of the
      238    13899        *             pertinent structure,as defined by VDH_SETPRM.SCP.
      239    13900        */
      240    13901    1   SETPTR: PROC;

  13901   1 000229  EFC7 0028            SETPTR          STB,B6   FPT+17,AUTO

      241    13902    2   DCL STR$ PTR;
      242    13903    2   DCL PRMID UBIN;
      243    13904    2   DCL PRMTYP UBIN;
      244    13905    2   DCL OFFSET SBIN;
      245    13906    2   DCL STRUCTURE UBIN;
      246    13907        %KV$BFRDSC (STCLASS="BASED(STR$)");
      247    13934        %KV$PRM_ABSGRPRND (NAME=PRM_ABSGRPRND, STCLASS="BASED(STR$)");
      248    13981        %KV$PTR(NAME=SAV_PTR,STCLASS=);
      249    14024    2   DCL OLDVAL UBIN;
      250    14025        /* First save the current KV$PTR */
      251    14026    2      SAV_PTR=KV$PTR;

  14026   1 00022B  AC80 0000 0000  xsym                 LDB,B2   KV$PTR$
          1 00022E  2C00                                 LDV,R2   0
          1 00022F  6C3C                                 LDV,R6   60
          1 000230  BB87                                 LAB,B3   ,AUTO
          1 000231  3C60                                 LDV,R3   96
          1 000232  0008                                 MMM

      252    14027        /* Convert to internal PRMID */
      253    14028    2   /*N*** pl6 bug ****/ TEMP=BINASC(VDH_SETPRM.PRMID);

  14028   1 000233  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 000235  6008                                 SOL,R6   8
          1 000236  6068                                 SAR,R6   8
          1 000237  E7C7 0016                            STH,R6   TEMP,AUTO

      254    14029    2      CALL INDEX(PRMID,TEMP,KV_PRMTBL.IDS) ALTRET(NO_STUFF);

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:83   
  14029   1 000239  EB80 0000 0000  00                   LAB,B6   KV_PRMTBL
          1 00023C  E870 0196                            LDR,R6   406,IMO
          1 00023E  0028                                 SRH      ;
          1 00023F       4107 0016                                ALPHANUM(TEMP,AUTO,,1),;
          1 000241       4407 0050                                BINARY(OLDVAL+2,AUTO,,4),;
          1 000243       4006 0000                                ALPHANUM(0,B6,,R6)
          1 000245  5381 0007                            CBE      s:14029+20,PREL
          1 000247  D870 0096                            LDR,R5   150,IMO
          1 000249  DF47 002C                            STR,R5   PRMID,AUTO
          1 00024B  0F81 07DA                            B        s:14440,PREL
          1 00024D  D847 0051                            LDR,R5   OLDVAL+3,AUTO
          1 00024F  DF47 002C                            STR,R5   PRMID,AUTO

      255    14030    2      PRMTYP=KV_PRMTBL.TYPE(PRMID);

  14030   1 000251  B855                                 LDR,R3   R5
          1 000252  C2B0 0000 004B  00                   LLH,R4   KV_PRMTBL+75,R3
          1 000255  CF47 002D                            STR,R4   PRMTYP,AUTO

      256    14031    2      PRMID=KV_PRMTBL.INDX(PRMID);

  14031   1 000257  B2B0 0000 0096  00                   LLH,R3   KV_PRMTBL+150,R3
          1 00025A  BF47 002C                            STR,R3   PRMID,AUTO

      257    14032    2      STRUCTURE=KV_WHERE.STRUCTURE(PRMID+KV_WHROFFS(PRMTYP));

  14032   1 00025C  A854                                 LDR,R2   R4
          1 00025D  BA20 0000 0167  00                   ADD,R3   KV_WHROFFS,R2
          1 000260  9830 0000 00E1  00                   LDR,R1   KV_WHERES,R3
          1 000263  104C                                 SOR,R1   12
          1 000264  9F47 002F                            STR,R1   STRUCTURE,AUTO

      258    14033    2      IF STRUCTURE<%KV_SCP_MRD OR %KV_MRD.USRCNT=1

  14033   1 000266  1D07                                 CMV,R1   7
          1 000267  0201 000D                            BL       s:14035,PREL
          1 000269  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:84   
          1 00026C  DCC6 0008                            LDB,B5   8,B6
          1 00026E  B845 000A                            LDR,R3   10,B5
          1 000270  B570 00FF                            AND,R3   255,IMO
          1 000272  3D01                                 CMV,R3   1
          1 000273  0981 07B2                            BNE      s:14440,PREL

      259    14034    3      THEN DO WHILE '1'B;

      260    14035    3         OFFSET=KV_WHERE.OFFSET(PRMID+KV_WHROFFS(PRMTYP));

  14035   1 000275  B847 002D                            LDR,R3   PRMTYP,AUTO
          1 000277  E847 002C                            LDR,R6   PRMID,AUTO
          1 000279  EA30 0000 0167  00                   ADD,R6   KV_WHROFFS,R3
          1 00027C  A856                                 LDR,R2   R6
          1 00027D  E820 0000 00E1  00                   LDR,R6   KV_WHERES,R2
          1 000280  E570 0FFF                            AND,R6   4095,IMO
          1 000282  EF47 002E                            STR,R6   OFFSET,AUTO

      261    14036    4         IF VDH_SETPRM.DMN~=0 AND VDH_SETPRM.DMN~=%KV_STR.ID THEN DO;

  14036   1 000284  82C7 0011                            LB,'00FF'X        VDH_SETPRM+7,AUTO
  14036   1 000286       00FF
          1 000287  0581 0045                            BBF      s:14050,PREL
          1 000289  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00028C  DCC6 0004                            LDB,B5   4,B6
          1 00028E  D847 0011                            LDR,R5   VDH_SETPRM+7,AUTO
          1 000290  D570 00FF                            AND,R5   255,IMO
          1 000292  C2C5 001C                            LLH,R4   28,B5
          1 000294  D954                                 CMR,R5   R4
          1 000295  0901 0037                            BE       s:14050,PREL

      262    14037        /* The request specifies stream: Find the right one */
      263    14038    4            KV$PTR.STR$=%KV_SSN.STR$;

  14038   1 000297  CCC6 0002                            LDB,B4   2,B6
          1 000299  BCC4 0004                            LDB,B3   4,B4
          1 00029B  BFC6 0004                            STB,B3   4,B6
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:85   

      264    14039    5            DO WHILE %KV_STR.ID~=VDH_SETPRM.DMN;

  14039   1 00029D  D2C3 001C                            LLH,R5   28,B3
          1 00029F  C847 0011                            LDR,R4   VDH_SETPRM+7,AUTO
          1 0002A1  C570 00FF                            AND,R4   255,IMO
          1 0002A3  D954                                 CMR,R5   R4
          1 0002A4  0901 0016                            BE       s:14043,PREL

      265    14040    5               IF %KV_STR.LNK$=ADDR(NIL) THEN GOTO NO_STUFF;

  14040   1 0002A6  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0002A9  DCC6 0004                            LDB,B5   4,B6
          1 0002AB  8DC5 0002                            CMN      2,B5
          1 0002AD  0901 0778                            BE       s:14440,PREL

      266    14041    5               KV$PTR.STR$=%KV_STR.LNK$;

  14041   1 0002AF  CCC5 0002                            LDB,B4   2,B5
          1 0002B1  CFC6 0004                            STB,B4   4,B6

      267    14042    5            END;

  14042   1 0002B3  E2C4 001C                            LLH,R6   28,B4
          1 0002B5  D847 0011                            LDR,R5   VDH_SETPRM+7,AUTO
          1 0002B7  D570 00FF                            AND,R5   255,IMO
          1 0002B9  E955                                 CMR,R6   R5
          1 0002BA  09EC                                 BNE      s:14040,SPREL

      268    14043    4            KV$PTR.MVD$=%KV_STR.MVD$;

  14043   1 0002BB  DCC6 0004                            LDB,B5   4,B6
          1 0002BD  CCC5 0004                            LDB,B4   4,B5
          1 0002BF  CFC6 0006                            STB,B4   6,B6

      269    14044    4            KV$PTR.MRD$=%KV_MVD.SRD$->KV$SRD.MRD$;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:86   
  14044   1 0002C1  BC84                                 LDB,B3   ,B4
          1 0002C2  AC83                                 LDB,B2   ,B3
          1 0002C3  AFC6 0008                            STB,B2   8,B6

      270    14045    4            KV$PTR.SRD$=%KV_MRD.SRD$;

  14045   1 0002C5  BCC2 0002                            LDB,B3   2,B2
          1 0002C7  BFC6 000A                            STB,B3   10,B6

      271    14046    4            KV$PTR.LINLST$=%KV_MVD.LINLST$;

  14046   1 0002C9  9CC4 0010                            LDB,B1   16,B4
          1 0002CB  9FC6 000E                            STB,B1   14,B6

      272    14047    4         END;

      273    14048        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:87   
      274    14049        /* Stuff away the data */
      275    14050    3         USR_SETPRM.FNC=%KV_USR_FNC_SETPRM;

  14050   1 0002CD  6C0F                                 LDV,R6   15
          1 0002CE  E7C7 000A                            STH,R6   VDH_SETPRM,AUTO

      276    14051    4         IF %KV_USRPRM.SETPRMPREPRC(VDH_SETPRM.PRMID) THEN DO;

  14051   1 0002D0  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0002D3  DC86                                 LDB,B5   ,B6
          1 0002D4  CCC5 0008                            LDB,B4   8,B5
          1 0002D6  BBC4 000B                            LAB,B3   11,B4
          1 0002D8  B847 000B                            LDR,R3   VDH_SETPRM+1,AUTO
          1 0002DA  82B3                                 LB       ,B3,R3
          1 0002DB  0581 0010                            BBF      s:14055,PREL

      277    14052    4            USR_SETPRM.PREPRC='1'B;

  14052   1 0002DD  8947 000A                            LBT,'0080'X       VDH_SETPRM,AUTO
  14052   1 0002DF       0080

      278    14053    4            CALL KVV$CALUSR(USR_SETPRM) ALTRET(NO_STUFF);

  14053   1 0002E0  DBC7 000A                            LAB,B5   VDH_SETPRM,AUTO
          1 0002E2  DFC7 0050                            STB,B5   OLDVAL+2,AUTO
          1 0002E4  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
          1 0002E6  CBF0 0100                            LAB,B4   256,IMO
          1 0002E8  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR
          1 0002EB       073B                            DC       s:14440,PREL

      279    14054    4         END;

      280    14055    3         TEMP$=PINCRW(ADDR(KV$PTR),KV_PTR_OFFSETS(STRUCTURE));

  14055   1 0002EC  B847 002F                            LDR,R3   STRUCTURE,AUTO
          1 0002EE  A830 0000 02CB  00                   LDR,R2   KV_PTR_OFFSETS,R3
          1 0002F1  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:88   
          1 0002F4  DBA6                                 LAB,B5   ,B6,R2
          1 0002F5  DFC7 0008                            STB,B5   TEMP$,AUTO

      281    14056    3         STR$=TEMP$->PT.R;

  14056   1 0002F7  CC85                                 LDB,B4   ,B5
          1 0002F8  CFC7 002A                            STB,B4   STR$,AUTO

      282    14057    3         IF STR$=ADDR(NIL) THEN GOTO NO_STUFF;

  14057   1 0002FA  8DC7 002A                            CMN      STR$,AUTO
          1 0002FC  0901 0729                            BE       s:14440,PREL

      283    14058    3         OLDVAL=0;

  14058   1 0002FE  8747 004E                            CL       OLDVAL,AUTO

      284    14059    4         DO CASE(PRMTYP);

  14059   1 000300  9847 002D                            LDR,R1   PRMTYP,AUTO
          1 000302  1D06                                 CMV,R1   6
          1 000303  0281 0203                            BGE      s:14179,PREL
          1 000305  B810 0000 030B  01                   LDR,R3   s:14059+11,R1
          1 000308  83B0 0000 0311  01                   JMP      s:14061,R3
          1 00030B       0171                            DC       s:14157,PREL
          1 00030C       0000                            DC       s:14061,PREL
          1 00030D       0012                            DC       s:14065,PREL
          1 00030E       0034                            DC       s:14076,PREL
          1 00030F       0012                            DC       s:14065,PREL
          1 000310       0047                            DC       s:14082,PREL

      285    14060    4         CASE(%PRM_TYPE_BIT);

      286    14061    4            IF STR$->BI.T(OFFSET) THEN OLDVAL=1;

  14061   1 000311  A847 002E                            LDR,R2   OFFSET,AUTO
          1 000313  82A4                                 LB       ,B4,R2
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:89   
          1 000314  0581 0004                            BBF      s:14062,PREL

  14061   1 000316  6C01                                 LDV,R6   1
          1 000317  EF47 004E                            STR,R6   OLDVAL,AUTO

      287    14062    4            IF VDH_SETPRM.VAL~=0 THEN STR$->BI.T(OFFSET)='1'B;

  14062   1 000319  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 00031B  6901 0004                            BEZ,R6   s:14063,PREL

  14062   1 00031D  8924                                 LBT      ,B4,R2
          1 00031E  0F81 01E8                            B        s:14179,PREL

      288    14063    4            ELSE STR$->BI.T(OFFSET)='0'B;

  14063   1 000320  8824                                 LBF      ,B4,R2
          1 000321  0F81 01E5                            B        s:14179,PREL

      289    14064    4         CASE(%PRM_TYPE_BYTE,%PRM_TYPE_WORD);

      290    14065    4            IF VDH_SETPRM.VAL < KV_MIN(PRMID) OR VDH_SETPRM.VAL > KV_MAX(PRMID)

  14065   1 000323  A847 002C                            LDR,R2   PRMID,AUTO
          1 000325  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000327  E920 0000 016F  00                   CMR,R6   KV_MINS,R2
          1 00032A  0201 06FB                            BL       s:14440,PREL
          1 00032C  E920 0000 018F  00                   CMR,R6   KV_MAXS,R2
          1 00032F  0301 06F6                            BG       s:14440,PREL

      291    14066    4            THEN GOTO NO_STUFF;
      292    14067    5            IF PRMTYP=%PRM_TYPE_BYTE THEN DO;

  14067   1 000331  1D02                                 CMV,R1   2
          1 000332  0981 0009                            BNE      s:14072,PREL

      293    14068    5               OLDVAL=STR$->BYT.E(OFFSET);

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:90   
  14068   1 000334  B847 002E                            LDR,R3   OFFSET,AUTO
          1 000336  D2B4                                 LLH,R5   ,B4,R3
          1 000337  DF47 004E                            STR,R5   OLDVAL,AUTO

      294    14069    5               STR$->BYT.E(OFFSET)=VDH_SETPRM.VAL;

  14069   1 000339  E7B4                                 STH,R6   ,B4,R3

      295    14070    5            END;

  14070   1 00033A  0F81 01CC                            B        s:14179,PREL

      296    14071    5            ELSE DO;

      297    14072    5               OLDVAL=STR$->WOR.D(OFFSET);

  14072   1 00033C  B847 002E                            LDR,R3   OFFSET,AUTO
          1 00033E  D834                                 LDR,R5   ,B4,R3
          1 00033F  DF47 004E                            STR,R5   OLDVAL,AUTO

      298    14073    5               STR$->WOR.D(OFFSET)=VDH_SETPRM.VAL;

  14073   1 000341  D856                                 LDR,R5   R6
          1 000342  DF34                                 STR,R5   ,B4,R3

      299    14074    5            END;

  14074   1 000343  0F81 01C3                            B        s:14179,PREL

      300    14075    4         CASE(%PRM_TYPE_TEXT);

      301    14076    4            IF VDH_SETPRM.VAL_.BYTSIZ < KV_BFRLNG(PRMID) THEN GOTO NO_STUFF;

  14076   1 000345  A847 002C                            LDR,R2   PRMID,AUTO
          1 000347  E2A0 0000 01AF  00                   LLH,R6   KV_BFRLNGS,R2
          1 00034A  E947 0010                            CMR,R6   VDH_SETPRM+6,AUTO
          1 00034C  0301 06D9                            BG       s:14440,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:91   

      302    14077    4            SUBSTR(PINCRC(STR$,OFFSET)->CHARS,0,KV_BFRLNG(PRMID))=

  14077   1 00034E  ACC7 000D                            LDB,B2   VDH_SETPRM+3,AUTO
          1 000350  A847 000F                            LDR,R2   VDH_SETPRM+5,AUTO
          1 000352  BB84                                 LAB,B3   ,B4
          1 000353  B847 002E                            LDR,R3   OFFSET,AUTO
          1 000355  0008                                 MMM
          1 000356  0F81 01B0                            B        s:14179,PREL

      303    14078    4              SUBSTR(PINCRC(VDH_SETPRM.VAL_.ADR$,VDH_SETPRM.VAL_.BYTX)->
      304    14079    4              CHARS,0,KV_BFRLNG(PRMID));
      305    14080    4         CASE(%PRM_TYPE_SHRBFR);

      306    14081        /*  First check that there's enough data here */
      307    14082    4            IF VDH_SETPRM.VAL_.BYTSIZ < KV_BFRLNG(PRMID)

  14082   1 000358  A847 002C                            LDR,R2   PRMID,AUTO
          1 00035A  E2A0 0000 01AF  00                   LLH,R6   KV_BFRLNGS,R2
          1 00035D  E947 0010                            CMR,R6   VDH_SETPRM+6,AUTO
          1 00035F  0381 0005                            BLE      s:14084,PREL

      308    14083    4            THEN IF VDH_SETPRM.VAL_.BYTSIZ~=0 THEN GOTO NO_STUFF;

  14083   1 000361  D847 0010                            LDR,R5   VDH_SETPRM+6,AUTO
          1 000363  5981 06C2                            BNEZ,R5  s:14440,PREL

      309    14084    4            OLDVAL=VDH_SETPRM.VAL;

  14084   1 000365  D847 000C                            LDR,R5   VDH_SETPRM+2,AUTO
          1 000367  DF47 004E                            STR,R5   OLDVAL,AUTO

      310    14085    4            %VDH_GETBFR=KV_VDH_GETBFR;

  14085   1 000369  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_GETBFR
          1 00036C  2C00                                 LDV,R2   0
          1 00036D  6C16                                 LDV,R6   22
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:92   
          1 00036E  BB87                                 LAB,B3   ,AUTO
          1 00036F  3C2E                                 LDV,R3   46
          1 000370  0008                                 MMM

      311    14086    4            %VDH_GETBFR.STRTYP=KV_BFRTYP(PRMID);

  14086   1 000371  B847 002C                            LDR,R3   PRMID,AUTO
          1 000373  E2B0 0000 01B6  00                   LLH,R6   KV_BFRTYPS,R3
          1 000376  E7C7 001D                            STH,R6   FPT+6,AUTO

      312    14087    5            IF VDH_SETPRM.VAL_.BYTSIZ~=0 THEN DO;

  14087   1 000378  D847 0010                            LDR,R5   VDH_SETPRM+6,AUTO
          1 00037A  5901 0086                            BEZ,R5   s:14124,PREL

      313    14088    5               %VDH_GETBFR.DAT_=VDH_SETPRM.VAL_;

  14088   1 00037C  AB87                                 LAB,B2   ,AUTO
          1 00037D  2C1A                                 LDV,R2   26
          1 00037E  6C08                                 LDV,R6   8
          1 00037F  BB87                                 LAB,B3   ,AUTO
          1 000380  3C3C                                 LDV,R3   60
          1 000381  0008                                 MMM

      314    14089    5               TEMP$=PINCRW(VDH_SETPRM.VAL_.ADR$,

  14089   1 000382  E847 000F                            LDR,R6   VDH_SETPRM+5,AUTO
          1 000384  6EF8                                 ADV,R6   -8
          1 000385  E370 0002                            DIV,R6   2,IMO
          1 000387  ECC7 000D                            LDB,B6   VDH_SETPRM+3,AUTO
          1 000389  B856                                 LDR,R3   R6
          1 00038A  DBB6                                 LAB,B5   ,B6,R3
          1 00038B  DFC7 0008                            STB,B5   TEMP$,AUTO

      315    14090    5                 (VDH_SETPRM.VAL_.BYTX-SIZEC(KV$SHRBFR))/2);
      316    14091        /* HeaDeRs are a bit special - check the data some. */
      317    14092    5               IF VDH_SETPRM.PRMID=%KV_PRMID_SSNHDR
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:93   

  14092   1 00038D  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 00038F  6D11                                 CMV,R6   17
          1 000390  0901 0004                            BE       s:14094,PREL
          1 000392  6D14                                 CMV,R6   20
          1 000393  0981 001E                            BNE      s:14102,PREL

      318    14093    6                 OR VDH_SETPRM.PRMID=%KV_PRMID_DCBHDR THEN DO;

      319    14094    6                  %VDH_GETBFR.DAT_.BYTSIZ =

  14094   1 000395  D2C5 0006                            LLH,R5   6,B5
          1 000397  5E05                                 ADV,R5   5
          1 000398  DF47 0021                            STR,R5   FPT+10,AUTO

      320    14095    6                    TEMP$->KV$TITLE.TXTSIZ+SIZEV(KV$TITLE)-SIZEC(KV$SHRBFR);
      321    14096    6                  IF TEMP$->KV$TITLE.INDCLM=0 THEN TEMP$->KV$TITLE.INDCLM=1;

  14096   1 00039A  C2C5 0005                            LLH,R4   5,B5
          1 00039C  4981 0004                            BNEZ,R4  s:14097,PREL

  14096   1 00039E  3C01                                 LDV,R3   1
          1 00039F  B7C5 0005                            STH,R3   5,B5

      322    14097    7                  IF TEMP$->KV$TITLE.RSTPAGNMB THEN DO;

  14097   1 0003A1  82C5 0004                            LB,'0100'X        4,B5
  14097   1 0003A3       0100
          1 0003A4  0581 0028                            BBF      s:14109,PREL

      323    14098    7                     %KV_MVD.PAGNMB=0;

  14098   1 0003A6  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0003A9  CCC6 0006                            LDB,B4   6,B6
          1 0003AB  8744 001E                            CL       30,B4

      324    14099    7                     TEMP$->KV$TITLE.RSTPAGNMB='0'B;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:94   

  14099   1 0003AD  8845 0004                            LBF,'0100'X       4,B5
  14099   1 0003AF       0100

      325    14100    7                  END;

      326    14101    6               END;

  14101   1 0003B0  0F81 001C                            B        s:14109,PREL

      327    14102    6               ELSE IF VDH_SETPRM.PRMID=%KV_PRMID_CTRCHR THEN DO;

  14102   1 0003B2  6D0F                                 CMV,R6   15
          1 0003B3  0981 0019                            BNE      s:14109,PREL

      328    14103    6                  OLDVAL=KV$ERD.CUP_CHR;

  14103   1 0003B5  D845 0020                            LDR,R5   32,B5
          1 0003B7  D570 00FF                            AND,R5   255,IMO
          1 0003B9  DF47 004E                            STR,R5   OLDVAL,AUTO

      329    14104    6                  IF OLDVAL~=0 AND KV$ERD.CNT(OLDVAL)>11

  14104   1 0003BB  5901 0009                            BEZ,R5   s:14107,PREL
          1 0003BD  B855                                 LDR,R3   R5
          1 0003BE  3E5A                                 ADV,R3   90
          1 0003BF  C2B5                                 LLH,R4   ,B5,R3
          1 0003C0  4D0B                                 CMV,R4   11
          1 0003C1  0381 0003                            BLE      s:14107,PREL

      330    14105                                 /* Overly large strings for this one make us trap.   */
      331    14106    6                  THEN KV$ERD.CNT(OLDVAL) = 11;

  14106   1 0003C3  2C0B                                 LDV,R2   11
          1 0003C4  A7B5                                 STH,R2   ,B5,R3

      332    14107    6                  IF KV$ERD.RGNSCR THEN KV$ERD.ILNRQRDLN = '1'B;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:95   

  14107   1 0003C5  82C5 0016                            LB,'0008'X        22,B5
  14107   1 0003C7       0008
          1 0003C8  0581 0004                            BBF      s:14109,PREL

  14107   1 0003CA  8945 0016                            LBT,'1000'X       22,B5
  14107   1 0003CC       1000

      333    14108    6               END;

      334    14109    5               IF %VDH_GETBFR.STRTYP=%KV_STRTYP_SSTINPFNCTBL

  14109   1 0003CD  E2C7 001D                            LLH,R6   FPT+6,AUTO
          1 0003CF  6D15                                 CMV,R6   21
          1 0003D0  0901 0004                            BE       s:14112,PREL
          1 0003D2  6D18                                 CMV,R6   24
          1 0003D3  0981 001B                            BNE      s:14121,PREL

      335    14110    6                 OR %VDH_GETBFR.STRTYP=%KV_STRTYP_TRNTBL THEN DO;

      336    14111        /* Don't accept bad names for tables that are only named */
      337    14112    6                  %VDH_GETBFR.SHRBFR.ADD='0'B;

  14112   1 0003D5  8847 001D                            LBF,'0020'X       FPT+6,AUTO
  14112   1 0003D7       0020

      338    14113    6                  %VDH_GETBFR.SHRBFR.GET='0'B;

  14113   1 0003D8  8847 001D                            LBF,'0040'X       FPT+6,AUTO
  14113   1 0003DA       0040

      339    14114    6                  %VDH_GETBFR.DAT_.BYTSIZ=8; /* Exactly 8 chars in a name        */

  14114   1 0003DB  5C08                                 LDV,R5   8
          1 0003DC  DF47 0021                            STR,R5   FPT+10,AUTO

      340    14115    6                  IF %VDH_GETBFR.STRTYP=%KV_STRTYP_SSTINPFNCTBL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:96   

  14115   1 0003DE  6D15                                 CMV,R6   21
          1 0003DF  0981 000F                            BNE      s:14121,PREL
          1 0003E1  C847 000C                            LDR,R4   VDH_SETPRM+2,AUTO
          1 0003E3  4048                                 SOR,R4   8
          1 0003E4  4D3A                                 CMV,R4   58
          1 0003E5  0981 0009                            BNE      s:14121,PREL

      341    14116    7                    AND VDH_SETPRM.VAL/256=ASCBIN(':') THEN DO;

      342    14117    7                     %VDH_GETBFR.STRTYP=%KV_STRTYP_USRINPFNCTBL;

  14117   1 0003E7  4C1A                                 LDV,R4   26
          1 0003E8  C7C7 001D                            STH,R4   FPT+6,AUTO

      343    14118    7                     OFFSET=OFFSET-2;

  14118   1 0003EA  E847 002E                            LDR,R6   OFFSET,AUTO
          1 0003EC  6EFE                                 ADV,R6   -2
          1 0003ED  EF47 002E                            STR,R6   OFFSET,AUTO

      344    14119    7                  END;

      345    14120    6               END;

      346    14121    5               CALL KVS$GETBFR(FPT) ALTRET(NO_STUFF);

  14121   1 0003EF  EBC7 0017                            LAB,B6   FPT,AUTO
          1 0003F1  EFC7 0050                            STB,B6   OLDVAL+2,AUTO
          1 0003F3  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
          1 0003F5  CBF0 0100                            LAB,B4   256,IMO
          1 0003F7  E380 0000 0000  xent                 LNJ,B6   KVS$GETBFR
          1 0003FA       062C                            DC       s:14440,PREL

      347    14122    5               TEMP$=%VDH_GETBFR.BFR$;

  14122   1 0003FB  ECC7 0018                            LDB,B6   FPT+1,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:97   
          1 0003FD  EFC7 0008                            STB,B6   TEMP$,AUTO

      348    14123    5            END;

  14123   1 0003FF  0F81 000B                            B        s:14127,PREL

      349    14124    4            ELSE IF %VDH_GETBFR.STRTYP=%KV_STRTYP_ACTCHR

  14124   1 000401  C2C7 001D                            LLH,R4   FPT+6,AUTO
          1 000403  4D01                                 CMV,R4   1
          1 000404  0901 0621                            BE       s:14440,PREL

      350    14125    4            THEN GOTO NO_STUFF;  /* Never reset ACTCHRTBL, it's always there.    */
      351    14126    4            ELSE TEMP$=ADDR(NIL);          /* 0 bytes ->reset funciton           */

  14126   1 000406  EB80 0000 0000                       LAB,B6   0
          1 000409  EFC7 0008                            STB,B6   TEMP$,AUTO

      352    14127    4            STR$=PINCRW(STR$,OFFSET);

  14127   1 00040B  DCC7 002A                            LDB,B5   STR$,AUTO
          1 00040D  B847 002E                            LDR,R3   OFFSET,AUTO
          1 00040F  CBB5                                 LAB,B4   ,B5,R3
          1 000410  CFC7 002A                            STB,B4   STR$,AUTO

      353    14128    4            %VDH_RLSBFR.BFR$=STR$->PT.R;

  14128   1 000412  DC84                                 LDB,B5   ,B4
          1 000413  DFC7 0018                            STB,B5   FPT+1,AUTO

      354    14129    4            IF %VDH_RLSBFR.STRTYP=%KV_STRTYP_TRNTBL

  14129   1 000415  E2C7 001D                            LLH,R6   FPT+6,AUTO
          1 000417  6D18                                 CMV,R6   24
          1 000418  0981 000E                            BNE      s:14137,PREL

      355    14130
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:98   
      356    14131        /* Don't switch from non-ASCII to ASCII translate table. */
      357    14132    4            THEN IF TEMP$->KV$TRNTBL.FNTCLS=%KV_FNTCLS_ASC

  14132   1 00041A  D2C6 001D                            LLH,R5   29,B6
          1 00041C  5981 000A                            BNEZ,R5  s:14137,PREL
          1 00041E  C2C5 001D                            LLH,R4   29,B5
          1 000420  4901 0006                            BEZ,R4   s:14137,PREL

      358    14133    5              AND %VDH_RLSBFR.BFR$->KV$TRNTBL.FNTCLS~=%KV_FNTCLS_ASC THEN DO;

      359    14134    5               %VDH_RLSBFR.BFR$=TEMP$;

  14134   1 000422  EFC7 0018                            STB,B6   FPT+1,AUTO

      360    14135    5               TEMP$=STR$->PT.R;

  14135   1 000424  DC84                                 LDB,B5   ,B4
          1 000425  DFC7 0008                            STB,B5   TEMP$,AUTO

      361    14136    5            END;

      362    14137    4            IF %VDH_RLSBFR.BFR$~=TEMP$ THEN OLDVAL=OLDVAL+1; /* Make it differ.  */

  14137   1 000427  ECC7 0018                            LDB,B6   FPT+1,AUTO
          1 000429  EDC7 0008                            CMB,B6   TEMP$,AUTO
          1 00042B  0901 0003                            BE       s:14138,PREL

  14137   1 00042D  8AC7 004E                            INC      OLDVAL,AUTO

      363    14138    4            STR$->PT.R=TEMP$;

  14138   1 00042F  DCC7 0008                            LDB,B5   TEMP$,AUTO
          1 000431  DF84                                 STB,B5   ,B4

      364    14139    5            IF %VDH_RLSBFR.STRTYP=%KV_STRTYP_REDBFR THEN DO;

  14139   1 000432  E2C7 001D                            LLH,R6   FPT+6,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:99   
          1 000434  6D11                                 CMV,R6   17
          1 000435  0981 0031                            BNE      s:14153,PREL

      365    14140
      366    14141        /* RED buffers (EDTBFR, to be precise) are a bit different. */
      367    14142    5               OFFSET = %VDH_GETBFR.BYTSIZ;

  14142   1 000437  B847 001A                            LDR,R3   FPT+3,AUTO
          1 000439  BF47 002E                            STR,R3   OFFSET,AUTO

      368    14143    5               %VDH_RLSBFR.BYTSIZ = KV$BFRDSC.BFRBYTSIZ;

  14143   1 00043B  B844 0004                            LDR,R3   4,B4
          1 00043D  BF47 001A                            STR,R3   FPT+3,AUTO

      369    14144    5               KV$BFRDSC.BFRBYTSIZ = OFFSET;

  14144   1 00043F  D847 002E                            LDR,R5   OFFSET,AUTO
          1 000441  DF44 0004                            STR,R5   4,B4

      370    14145    5               KV$BFRDSC.DATBYTSIZ = %VDH_GETBFR.DAT_.BYTSIZ;

  14145   1 000443  E847 0021                            LDR,R6   FPT+10,AUTO
          1 000445  EF44 0003                            STR,R6   3,B4

      371    14146    5               KV$BFRDSC.BYTX = 0;

  14146   1 000447  8744 0002                            CL       2,B4

      372    14147    5               KV$BFRDSC.STRTYP = %KV_STRTYP_REDBFR;

  14147   1 000449  4C11                                 LDV,R4   17
          1 00044A  C7C4 0005                            STH,R4   5,B4

      373    14148    5               IF KV$BFRDSC.BFRRLSDSP~=%KV_BFRRLSDSP_MSG

  14148   1 00044C  B844 0005                            LDR,R3   5,B4
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:100  
          1 00044E  B570 00FF                            AND,R3   255,IMO
          1 000450  3D01                                 CMV,R3   1
          1 000451  0901 0006                            BE       s:14150,PREL

      374    14149    5               THEN %VDH_RLSBFR.BFR$ = ADDR(NIL);

  14149   1 000453  EB80 0000 0000                       LAB,B6   0
          1 000456  EFC7 0018                            STB,B6   FPT+1,AUTO

      375    14150    5               KV$BFRDSC.BFRRLSDSP = %KV_BFRRLSDSP_MSG;

  14150   1 000458  6C01                                 LDV,R6   1
          1 000459  EAC4 0005                            SRM,R6,'00FF'X    5,B4
          1 00045B       00FF

      376    14151    5               %KV_SSN.LSTEDTBFRSTRID = %KV_STR.ID;

  14151   1 00045C  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00045F  BCC6 0002                            LDB,B3   2,B6
          1 000461  ACC6 0004                            LDB,B2   4,B6
          1 000463  B2C2 001C                            LLH,R3   28,B2
          1 000465  B7C3 0026                            STH,R3   38,B3

      377    14152    5            END;

      378    14153    4            OFFSET=-OFFSET;

  14153   1 000467  E847 002E                            LDR,R6   OFFSET,AUTO
          1 000469  8256                                 NEG      R6
          1 00046A  EF47 002E                            STR,R6   OFFSET,AUTO

      379    14154    4            STR$=PINCRW(STR$,OFFSET);

  14154   1 00046C  B856                                 LDR,R3   R6
          1 00046D  EBB4                                 LAB,B6   ,B4,R3
          1 00046E  EFC7 002A                            STB,B6   STR$,AUTO

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:101  
      380    14155    4            IF %VDH_RLSBFR.BFR$~=ADDR(NIL) THEN CALL KVS$RLSBFR(FPT);

  14155   1 000470  8DC7 0018                            CMN      FPT+1,AUTO
          1 000472  0901 0094                            BE       s:14179,PREL

  14155   1 000474  CBC7 0017                            LAB,B4   FPT,AUTO
          1 000476  CFC7 0050                            STB,B4   OLDVAL+2,AUTO
          1 000478  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
          1 00047A  CBF0 0100                            LAB,B4   256,IMO
          1 00047C  E380 0000 0000  xent                 LNJ,B6   KVS$RLSBFR
          1 00047F       0001                            DC       s:14155+16,PREL
          1 000480  0F81 0086                            B        s:14179,PREL

      381    14156    4         CASE(%PRM_TYPE_OTHER);

      382    14157    5            DO SELECT(VDH_SETPRM.PRMID);

  14157   1 000482  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 000484  E970 001A                            CMR,R6   26,IMO
          1 000486  0201 0008                            BL       s:14157+13,PREL
          1 000488  0901 000B                            BE       s:14159,PREL
          1 00048A  6D1C                                 CMV,R6   28
          1 00048B  0981 007B                            BNE      s:14179,PREL
          1 00048D  0F81 0030                            B        s:14165,PREL
          1 00048F  6D18                                 CMV,R6   24
          1 000490  0981 0076                            BNE      s:14179,PREL
          1 000492  0F81 0019                            B        s:14162,PREL

      383    14158    5               SELECT(%KV_PRMID_ABSGRPRND);

      384    14159    5               STR$ = PINCRW(VDH_SETPRM.VAL_.ADR$,VDH_SETPRM.VAL_.BYTX/2);

  14159   1 000494  D847 000F                            LDR,R5   VDH_SETPRM+5,AUTO
          1 000496  D370 0002                            DIV,R5   2,IMO
          1 000498  BCC7 000D                            LDB,B3   VDH_SETPRM+3,AUTO
          1 00049A  A855                                 LDR,R2   R5
          1 00049B  ABA3                                 LAB,B2   ,B3,R2
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:102  
          1 00049C  AFC7 002A                            STB,B2   STR$,AUTO

      385    14160    5               %KV_MRD.ABSGRPRND(PRM_ABSGRPRND.ID) = PRM_ABSGRPRND.GRPRND;

  14160   1 00049E  9CC6 0008                            LDB,B1   8,B6
          1 0004A0  A802                                 LDR,R2   ,B2
          1 0004A1  2048                                 SOR,R2   8
          1 0004A2  A570 007F                            AND,R2   127,IMO
          1 0004A4  D2C2 0001                            LLH,R5   1,B2
          1 0004A6  5008                                 SOL,R5   8
          1 0004A7  5048                                 SOR,R5   8
          1 0004A8  2E32                                 ADV,R2   50
          1 0004A9  D7A1                                 STH,R5   ,B1,R2
          1 0004AA  0F81 005C                            B        s:14179,PREL

      386    14161    5               SELECT(%KV_PRMID_KEYDEFS);

      387    14162    5               OLDVAL=VDH_SETPRM.VAL;

  14162   1 0004AC  D847 000C                            LDR,R5   VDH_SETPRM+2,AUTO
          1 0004AE  DF47 004E                            STR,R5   OLDVAL,AUTO

      388    14163    5               CALL KVP$FNCKEY (VDH_SETPRM);

  14163   1 0004B0  BBC7 000A                            LAB,B3   VDH_SETPRM,AUTO
          1 0004B2  BFC7 0050                            STB,B3   OLDVAL+2,AUTO
          1 0004B4  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
          1 0004B6  CBF0 0100                            LAB,B4   256,IMO
          1 0004B8  E380 0000 0000  xent                 LNJ,B6   KVP$FNCKEY
          1 0004BB       0001                            DC       s:14163+12,PREL
          1 0004BC  0F81 004A                            B        s:14179,PREL

      389    14164    5               SELECT(%KV_PRMID_SETUP_CHR);

      390    14165    5               OLDVAL=VDH_SETPRM.VAL;

  14165   1 0004BE  D847 000C                            LDR,R5   VDH_SETPRM+2,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:103  
          1 0004C0  DF47 004E                            STR,R5   OLDVAL,AUTO

      391    14166    5               IF VDH_SETPRM.VAL_.BYTSIZ=0 THEN EXIT;

  14166   1 0004C2  C847 0010                            LDR,R4   VDH_SETPRM+6,AUTO
          1 0004C4  4901 0042                            BEZ,R4   s:14179,PREL

      392    14167    6               IF %KV_VDI.USEOTPBFRTRN THEN DO;

  14167   1 0004C6  BC86                                 LDB,B3   ,B6
          1 0004C7  82C3 001D                            LB,'0080'X        29,B3
          1 0004C9       0080
          1 0004CA  0581 001D                            BBF      s:14172,PREL

      393    14168    6                  %VDH_OTPLCL=KV_VDH_OTPLCL_TRN;

  14168   1 0004CC  AB80 0000 02D6  00                   LAB,B2   KV_VDH_OTPLCL_TRN
          1 0004CF  2C00                                 LDV,R2   0
          1 0004D0  6C0A                                 LDV,R6   10
          1 0004D1  BB87                                 LAB,B3   ,AUTO
          1 0004D2  3C2E                                 LDV,R3   46
          1 0004D3  0008                                 MMM

      394    14169    6                  %VDH_OTPLCL.BFR_=VDH_SETPRM.VAL_;

  14169   1 0004D4  AB87                                 LAB,B2   ,AUTO
          1 0004D5  2C1A                                 LDV,R2   26
          1 0004D6  6C08                                 LDV,R6   8
          1 0004D7  BB87                                 LAB,B3   ,AUTO
          1 0004D8  3C30                                 LDV,R3   48
          1 0004D9  0008                                 MMM

      395    14170    6                  CALL KVO$OTPLCL (FPT);

  14170   1 0004DA  EBC7 0017                            LAB,B6   FPT,AUTO
          1 0004DC  EFC7 0050                            STB,B6   OLDVAL+2,AUTO
          1 0004DE  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:104  
          1 0004E0  CBF0 0100                            LAB,B4   256,IMO
          1 0004E2  E380 0000 0000  xent                 LNJ,B6   KVO$OTPLCL
          1 0004E5       0001                            DC       s:14171,PREL

      396    14171    6               END; ELSE DO;

  14171   1 0004E6  0F81 0020                            B        s:14179,PREL

      397    14172    6                  %USR_DAT=KV_USR_DAT;

  14172   1 0004E8  AB80 0000 0000  xsym                 LAB,B2   KV_USR_DAT
          1 0004EB  2C00                                 LDV,R2   0
          1 0004EC  6C10                                 LDV,R6   16
          1 0004ED  BB87                                 LAB,B3   ,AUTO
          1 0004EE  3C2E                                 LDV,R3   46
          1 0004EF  0008                                 MMM

      398    14173    6                  %USR_DAT.DAT__=VDH_SETPRM.VAL_;

  14173   1 0004F0  5C0C                                 LDV,R5   12
          1 0004F1  0021                                 ALR      ;
          1 0004F2       4807 000D                                ALPHANUM(VDH_SETPRM+3,AUTO,,8),;
          1 0004F4       4007 0018                                ALPHANUM(FPT+1,AUTO,,R5,FILL)

      399    14174    6                  %USR_DAT.DATMOD=%KV#DATMOD_TRN;

  14174   1 0004F6  6C04                                 LDV,R6   4
          1 0004F7  EAC7 0017                            SRM,R6,'000C'X    FPT,AUTO
          1 0004F9       000C

      400    14175    6                  CALL KVV$CALUSR (FPT);

  14175   1 0004FA  EBC7 0017                            LAB,B6   FPT,AUTO
          1 0004FC  437F                                 CSYNC    s:14175+1,SPREL
          1 0004FD  EFC7 0050                            STB,B6   OLDVAL+2,AUTO
          1 0004FF  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
          1 000501  CBF0 0100                            LAB,B4   256,IMO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:105  
          1 000503  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR
          1 000506       0001                            DC       s:14179,PREL

      401    14176    6               END;

      402    14177    5            END;

      403    14178    4         END;

      404    14179    3         IF (OLDVAL~=VDH_SETPRM.VAL

  14179   1 000507  E847 004E                            LDR,R6   OLDVAL,AUTO
          1 000509  E947 000C                            CMR,R6   VDH_SETPRM+2,AUTO
          1 00050B  0981 0006                            BNE      s:14179+11,PREL
          1 00050D  D847 000B                            LDR,R5   VDH_SETPRM+1,AUTO
          1 00050F  5D7A                                 CMV,R5   122
          1 000510  0981 0469                            BNE      s:14393,PREL
          1 000512  ECC7 002A                            LDB,B6   STR$,AUTO
          1 000514  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000517  EDC5 0014                            CMB,B6   20,B5
          1 000519  0901 0460                            BE       s:14393,PREL

      405    14180    3           OR VDH_SETPRM.PRMID=%KV_PRMID_MRDLNG) /* Always set PHSFRM            */
      406    14181        /* Make some equates for where the parameter just went */
      407    14182        %EQU Y_MRD=CHARTEXT('STR$->KV$MRD');
      408    14183        %EQU Y_SRD=CHARTEXT('STR$->KV$SRD');
      409    14184        %EQU Y_MVD=CHARTEXT('STR$->KV$MVD');
      410    14185        %EQU Y_STR=CHARTEXT('STR$->KV$STR');
      411    14186        %EQU Y_SMRD=CHARTEXT('STR$->KV$SRD.MRD$->KV$MRD');
      412    14187        %EQU Y_SSN=CHARTEXT('STR$->KV$SSN');
      413    14188        /* And load up a pointer to it. */
      414    14189    3           AND STR$~=KV$PTR.FLD$
      415    14190    4         THEN DO CASE(VDH_SETPRM.PRMID);

  14190   1 00051B  B847 000B                            LDR,R3   VDH_SETPRM+1,AUTO
          1 00051D  3EF1                                 ADV,R3   -15
          1 00051E  B970 009F                            CMR,R3   159,IMO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:106  
          1 000520  0281 0459                            BGE      s:14393,PREL
          1 000522  A830 0000 0528  01                   LDR,R2   s:14190+13,R3
          1 000525  83A0 0000 05C7  01                   JMP      s:14193,R2
          1 000528       005D                            DC       s:14208,PREL
          1 000529       03B3                            DC       s:14393,PREL
          1 00052A       03B3                            DC       s:14393,PREL
          1 00052B       03B3                            DC       s:14393,PREL
          1 00052C       03B3                            DC       s:14393,PREL
          1 00052D       03B3                            DC       s:14393,PREL
          1 00052E       03B3                            DC       s:14393,PREL
          1 00052F       01E0                            DC       s:14295,PREL
          1 000530       03B3                            DC       s:14393,PREL
          1 000531       03B3                            DC       s:14393,PREL
          1 000532       03B3                            DC       s:14393,PREL
          1 000533       03B3                            DC       s:14393,PREL
          1 000534       03B3                            DC       s:14393,PREL
          1 000535       03B3                            DC       s:14393,PREL
          1 000536       03B3                            DC       s:14393,PREL
          1 000537       03B3                            DC       s:14393,PREL
          1 000538       03B3                            DC       s:14393,PREL
          1 000539       03B3                            DC       s:14393,PREL
          1 00053A       03B3                            DC       s:14393,PREL
          1 00053B       03B3                            DC       s:14393,PREL
          1 00053C       03B3                            DC       s:14393,PREL
          1 00053D       03B3                            DC       s:14393,PREL
          1 00053E       03B3                            DC       s:14393,PREL
          1 00053F       03B3                            DC       s:14393,PREL
          1 000540       03B3                            DC       s:14393,PREL
          1 000541       03B3                            DC       s:14393,PREL
          1 000542       03B3                            DC       s:14393,PREL
          1 000543       03B3                            DC       s:14393,PREL
          1 000544       03B3                            DC       s:14393,PREL
          1 000545       03B3                            DC       s:14393,PREL
          1 000546       03B3                            DC       s:14393,PREL
          1 000547       03B3                            DC       s:14393,PREL
          1 000548       03B3                            DC       s:14393,PREL
          1 000549       03B3                            DC       s:14393,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:107  
          1 00054A       03B3                            DC       s:14393,PREL
          1 00054B       03B3                            DC       s:14393,PREL
          1 00054C       03B3                            DC       s:14393,PREL
          1 00054D       03B3                            DC       s:14393,PREL
          1 00054E       03B3                            DC       s:14393,PREL
          1 00054F       03B3                            DC       s:14393,PREL
          1 000550       03B3                            DC       s:14393,PREL
          1 000551       03B3                            DC       s:14393,PREL
          1 000552       03B3                            DC       s:14393,PREL
          1 000553       03B3                            DC       s:14393,PREL
          1 000554       03B3                            DC       s:14393,PREL
          1 000555       03B3                            DC       s:14393,PREL
          1 000556       03B3                            DC       s:14393,PREL
          1 000557       03B3                            DC       s:14393,PREL
          1 000558       03B3                            DC       s:14393,PREL
          1 000559       03B3                            DC       s:14393,PREL
          1 00055A       03B3                            DC       s:14393,PREL
          1 00055B       03B3                            DC       s:14393,PREL
          1 00055C       03B3                            DC       s:14393,PREL
          1 00055D       03B3                            DC       s:14393,PREL
          1 00055E       03B3                            DC       s:14393,PREL
          1 00055F       0145                            DC       s:14246,PREL
          1 000560       03B3                            DC       s:14393,PREL
          1 000561       03B3                            DC       s:14393,PREL
          1 000562       0117                            DC       s:14237,PREL
          1 000563       0117                            DC       s:14237,PREL
          1 000564       03B3                            DC       s:14393,PREL
          1 000565       0000                            DC       s:14193,PREL
          1 000566       016A                            DC       s:14255,PREL
          1 000567       016A                            DC       s:14255,PREL
          1 000568       0315                            DC       s:14359,PREL
          1 000569       01AF                            DC       s:14278,PREL
          1 00056A       03B3                            DC       s:14393,PREL
          1 00056B       03B3                            DC       s:14393,PREL
          1 00056C       03B3                            DC       s:14393,PREL
          1 00056D       01AF                            DC       s:14278,PREL
          1 00056E       01AF                            DC       s:14278,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:108  
          1 00056F       03B3                            DC       s:14393,PREL
          1 000570       03B3                            DC       s:14393,PREL
          1 000571       03B3                            DC       s:14393,PREL
          1 000572       03B3                            DC       s:14393,PREL
          1 000573       03B3                            DC       s:14393,PREL
          1 000574       03B3                            DC       s:14393,PREL
          1 000575       03B3                            DC       s:14393,PREL
          1 000576       03B3                            DC       s:14393,PREL
          1 000577       03B3                            DC       s:14393,PREL
          1 000578       03B3                            DC       s:14393,PREL
          1 000579       03B3                            DC       s:14393,PREL
          1 00057A       03B3                            DC       s:14393,PREL
          1 00057B       03B3                            DC       s:14393,PREL
          1 00057C       03B3                            DC       s:14393,PREL
          1 00057D       03B3                            DC       s:14393,PREL
          1 00057E       03B3                            DC       s:14393,PREL
          1 00057F       033D                            DC       s:14365,PREL
          1 000580       0103                            DC       s:14232,PREL
          1 000581       03B3                            DC       s:14393,PREL
          1 000582       03B3                            DC       s:14393,PREL
          1 000583       03B3                            DC       s:14393,PREL
          1 000584       03B3                            DC       s:14393,PREL
          1 000585       03B3                            DC       s:14393,PREL
          1 000586       03B3                            DC       s:14393,PREL
          1 000587       003C                            DC       s:14203,PREL
          1 000588       03B3                            DC       s:14393,PREL
          1 000589       03B3                            DC       s:14393,PREL
          1 00058A       03B3                            DC       s:14393,PREL
          1 00058B       03B3                            DC       s:14393,PREL
          1 00058C       03B3                            DC       s:14393,PREL
          1 00058D       03B3                            DC       s:14393,PREL
          1 00058E       03B3                            DC       s:14393,PREL
          1 00058F       0138                            DC       s:14243,PREL
          1 000590       03B3                            DC       s:14393,PREL
          1 000591       03B3                            DC       s:14393,PREL
          1 000592       020A                            DC       s:14303,PREL
          1 000593       02A2                            DC       s:14335,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:109  
          1 000594       03B3                            DC       s:14393,PREL
          1 000595       03B3                            DC       s:14393,PREL
          1 000596       010F                            DC       s:14235,PREL
          1 000597       0220                            DC       s:14311,PREL
          1 000598       0186                            DC       s:14265,PREL
          1 000599       0186                            DC       s:14265,PREL
          1 00059A       0186                            DC       s:14265,PREL
          1 00059B       03B3                            DC       s:14393,PREL
          1 00059C       03B3                            DC       s:14393,PREL
          1 00059D       03B3                            DC       s:14393,PREL
          1 00059E       03B3                            DC       s:14393,PREL
          1 00059F       03B3                            DC       s:14393,PREL
          1 0005A0       03B3                            DC       s:14393,PREL
          1 0005A1       01D7                            DC       s:14292,PREL
          1 0005A2       03B3                            DC       s:14393,PREL
          1 0005A3       03B3                            DC       s:14393,PREL
          1 0005A4       03B3                            DC       s:14393,PREL
          1 0005A5       03B3                            DC       s:14393,PREL
          1 0005A6       0174                            DC       s:14258,PREL
          1 0005A7       0197                            DC       s:14272,PREL
          1 0005A8       0197                            DC       s:14272,PREL
          1 0005A9       01BB                            DC       s:14283,PREL
          1 0005AA       01BB                            DC       s:14283,PREL
          1 0005AB       01C2                            DC       s:14285,PREL
          1 0005AC       01BB                            DC       s:14283,PREL
          1 0005AD       01BB                            DC       s:14283,PREL
          1 0005AE       01BB                            DC       s:14283,PREL
          1 0005AF       01C2                            DC       s:14285,PREL
          1 0005B0       01BB                            DC       s:14283,PREL
          1 0005B1       01A3                            DC       s:14275,PREL
          1 0005B2       03B3                            DC       s:14393,PREL
          1 0005B3       03B3                            DC       s:14393,PREL
          1 0005B4       03B3                            DC       s:14393,PREL
          1 0005B5       03B3                            DC       s:14393,PREL
          1 0005B6       0155                            DC       s:14251,PREL
          1 0005B7       03B3                            DC       s:14393,PREL
          1 0005B8       03B3                            DC       s:14393,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:110  
          1 0005B9       03B3                            DC       s:14393,PREL
          1 0005BA       03B3                            DC       s:14393,PREL
          1 0005BB       03B3                            DC       s:14393,PREL
          1 0005BC       03B3                            DC       s:14393,PREL
          1 0005BD       03B3                            DC       s:14393,PREL
          1 0005BE       03B3                            DC       s:14393,PREL
          1 0005BF       03B3                            DC       s:14393,PREL
          1 0005C0       03B3                            DC       s:14393,PREL
          1 0005C1       03B3                            DC       s:14393,PREL
          1 0005C2       03B3                            DC       s:14393,PREL
          1 0005C3       03B3                            DC       s:14393,PREL
          1 0005C4       03B3                            DC       s:14393,PREL
          1 0005C5       03B3                            DC       s:14393,PREL
          1 0005C6       028A                            DC       s:14329,PREL

      416    14191                                      /* Process interrelationships if there are any  */
      417    14192    4         CASE(%KV_PRMID_APLLCNRM);

      418    14193    4            TEMP$ = %KV_USRPRM.TRNTBLHEDPTR$;

  14193   1 0005C7  CC85                                 LDB,B4   ,B5
          1 0005C8  BCC4 0008                            LDB,B3   8,B4
          1 0005CA  ACC3 0031                            LDB,B2   49,B3
          1 0005CC  AFC7 0008                            STB,B2   TEMP$,AUTO

      419    14194    4            IF TEMP$~=ADDR(NIL)

  14194   1 0005CE  8DC7 0008                            CMN      TEMP$,AUTO
          1 0005D0  0901 03A9                            BE       s:14393,PREL

      420    14195    5            THEN DO WHILE TEMP$->KV$TRNTBL.LNK$~=ADDR(NIL);

  14195   1 0005D2  0F81 002A                            B        s:14201,PREL

      421    14196    5               TEMP$ = TEMP$->KV$TRNTBL.LNK$;

  14196   1 0005D4  ECC7 0008                            LDB,B6   TEMP$,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:111  
          1 0005D6  DC86                                 LDB,B5   ,B6
          1 0005D7  DFC7 0008                            STB,B5   TEMP$,AUTO

      422    14197    5               IF TEMP$->KV$TRNTBL.FNTCLS=%Y_MVD.TRNTBL$->KV$TRNTBL.FNTCLS

  14197   1 0005D9  ECC7 002A                            LDB,B6   STR$,AUTO
          1 0005DB  CCC6 000E                            LDB,B4   14,B6
          1 0005DD  E2C5 001D                            LLH,R6   29,B5
          1 0005DF  D2C4 001D                            LLH,R5   29,B4
          1 0005E1  E955                                 CMR,R6   R5
          1 0005E2  0981 001A                            BNE      s:14201,PREL
          1 0005E4  C845 001F                            LDR,R4   31,B5
          1 0005E6  C570 8000                            AND,R4   -32768,IMO
          1 0005E8  B844 001F                            LDR,R3   31,B4
          1 0005EA  B570 8000                            AND,R3   -32768,IMO
          1 0005EC  C653                                 XOR,R4   R3
          1 0005ED  4901 000F                            BEZ,R4   s:14201,PREL
          1 0005EF  C845 001F                            LDR,R4   31,B5
          1 0005F1  C570 8000                            AND,R4   -32768,IMO
          1 0005F3  A846 0016                            LDR,R2   22,B6
          1 0005F5  200A                                 SOL,R2   10
          1 0005F6  A570 8000                            AND,R2   -32768,IMO
          1 0005F8  C652                                 XOR,R4   R2
          1 0005F9  4981 0003                            BNEZ,R4  s:14201,PREL

      423    14198    5                 AND TEMP$->KV$TRNTBL.PRTAPL\%Y_MVD.TRNTBL$->KV$TRNTBL.PRTAPL
      424    14199    5                 AND NOT TEMP$->KV$TRNTBL.PRTAPL\%Y_MVD.APLLCNRM
      425    14200    5               THEN %Y_MVD.TRNTBL$=TEMP$;

  14200   1 0005FB  DFC6 000E                            STB,B5   14,B6

      426    14201    5            END;

  14201   1 0005FD  DCC7 0008                            LDB,B5   TEMP$,AUTO
          1 0005FF  8D85                                 CMN      ,B5
          1 000600  09D4                                 BNE      s:14196,SPREL
          1 000601  0F81 0378                            B        s:14393,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:112  

      427    14202    4         CASE(%KV_PRMID_BLANKERASES);

      428    14203    4            IF %Y_MRD.FSTERS OR %Y_MRD.BLANKERASES THEN %Y_MRD.CTNFRM='0'B;

  14203   1 000603  82C6 0017                            LB,'0001'X        23,B6
  14203   1 000605       0001
          1 000606  0501 0006                            BBT      s:14203+10,PREL
          1 000608  82C6 0016                            LB,'0002'X        22,B6
          1 00060A       0002
          1 00060B  0581 0006                            BBF      s:14204,PREL

  14203   1 00060D  8846 0018                            LBF,'0800'X       24,B6
  14203   1 00060F       0800
          1 000610  0F81 0004                            B        s:14205,PREL

      429    14204    4            ELSE %Y_MRD.CTNFRM='1'B;

  14204   1 000612  8946 0018                            LBT,'0800'X       24,B6
  14204   1 000614       0800

      430    14205    4            IF %Y_MRD.ERD$~=ADDR(NIL)

  14205   1 000615  8DC6 0008                            CMN      8,B6
          1 000617  0901 0362                            BE       s:14393,PREL

      431    14206    4            THEN IF %Y_MRD.ERD$->KV$ERD.ED2_CHR~=0 THEN %Y_MRD.CTNFRM='0'B;

  14206   1 000619  CCC6 0008                            LDB,B4   8,B6
          1 00061B  D2C4 0024                            LLH,R5   36,B4
          1 00061D  5901 035C                            BEZ,R5   s:14393,PREL

  14206   1 00061F  8846 0018                            LBF,'0800'X       24,B6
  14206   1 000621       0800
          1 000622  0F81 0357                            B        s:14393,PREL

      432    14207    4         CASE(%KV_PRMID_CTRCHR);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:113  

      433    14208    4            IF KV$ERD.EL0_CHR~=0 OR KV$ERD.ED0_CHR~=0 THEN %Y_MRD.FSTERS='1'B;

  14208   1 000624  CCC7 0008                            LDB,B4   TEMP$,AUTO
          1 000626  82C4 0021                            LB,'00FF'X        33,B4
          1 000628       00FF
          1 000629  0501 0005                            BBT      s:14208+11,PREL
          1 00062B  D2C4 0021                            LLH,R5   33,B4
          1 00062D  5901 0006                            BEZ,R5   s:14209,PREL

  14208   1 00062F  8946 0017                            LBT,'0001'X       23,B6
  14208   1 000631       0001
          1 000632  0F81 0004                            B        s:14210,PREL

      434    14209    4            ELSE %Y_MRD.FSTERS='0'B;

  14209   1 000634  8846 0017                            LBF,'0001'X       23,B6
  14209   1 000636       0001

      435    14210    4            IF %Y_MRD.FSTERS OR %Y_MRD.BLANKERASES OR KV$ERD.ED2_CHR~=0

  14210   1 000637  82C6 0017                            LB,'0001'X        23,B6
  14210   1 000639       0001
          1 00063A  0501 000A                            BBT      s:14211,PREL
          1 00063C  82C6 0016                            LB,'0002'X        22,B6
          1 00063E       0002
          1 00063F  0501 0005                            BBT      s:14211,PREL
          1 000641  D2C4 0024                            LLH,R5   36,B4
          1 000643  5901 0006                            BEZ,R5   s:14212,PREL

      436    14211    4            THEN %Y_MRD.CTNFRM='0'B;

  14211   1 000645  8846 0018                            LBF,'0800'X       24,B6
  14211   1 000647       0800
          1 000648  0F81 0004                            B        s:14213,PREL

      437    14212    4            ELSE %Y_MRD.CTNFRM='1'B;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:114  

  14212   1 00064A  8946 0018                            LBT,'0800'X       24,B6
  14212   1 00064C       0800

      438    14213    4            IF KV$ERD.CUU_CHR~=0 OR KV$ERD.CUP_ALG~=0 THEN %Y_MRD.CURSORUP='1'B;

  14213   1 00064D  D2C4 0023                            LLH,R5   35,B4
          1 00064F  5981 0005                            BNEZ,R5  s:14213+8,PREL
          1 000651  C2C4 0015                            LLH,R4   21,B4
          1 000653  4901 0006                            BEZ,R4   s:14214,PREL

  14213   1 000655  8946 0017                            LBT,'0002'X       23,B6
  14213   1 000657       0002
          1 000658  0F81 0004                            B        s:14215,PREL

      439    14214    4            ELSE %Y_MRD.CURSORUP='0'B;

  14214   1 00065A  8846 0017                            LBF,'0002'X       23,B6
  14214   1 00065C       0002

      440    14215    4            IF KV$ERD.ILN_CHR~=0 AND KV$ERD.DLN_CHR~=0 THEN %Y_MRD.VRTSCR='1'B;

  14215   1 00065D  D2C4 002A                            LLH,R5   42,B4
          1 00065F  5901 000B                            BEZ,R5   s:14216,PREL
          1 000661  82C4 002A                            LB,'00FF'X        42,B4
          1 000663       00FF
          1 000664  0581 0006                            BBF      s:14216,PREL

  14215   1 000666  8946 0018                            LBT,'0020'X       24,B6
  14215   1 000668       0020
          1 000669  0F81 0004                            B        s:14217,PREL

      441    14216    4            ELSE %Y_MRD.VRTSCR='0'B;

  14216   1 00066B  8846 0018                            LBF,'0020'X       24,B6
  14216   1 00066D       0020

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:115  
      442    14217    5            IF %KV_SRD.WDT=%Y_MRD.WDT THEN DO;

  14217   1 00066E  BCC5 000A                            LDB,B3   10,B5
          1 000670  D843 000D                            LDR,R5   13,B3
          1 000672  D946 000B                            CMR,R5   11,B6
          1 000674  0981 000F                            BNE      s:14221,PREL

      443    14218    5               %KV_SRD.VRTSCR=%Y_MRD.VRTSCR;

  14218   1 000676  C846 0018                            LDR,R4   24,B6
          1 000678  4009                                 SOL,R4   9
          1 000679  CAC3 001D                            SRM,R4,'4000'X    29,B3
          1 00067B       4000

      444    14219    5               %KV_SRD.FSTERS=%Y_MRD.FSTERS;

  14219   1 00067C  BCC5 000A                            LDB,B3   10,B5
          1 00067E  D846 0017                            LDR,R5   23,B6
          1 000680  5006                                 SOL,R5   6
          1 000681  DAC3 000F                            SRM,R5,'0040'X    15,B3
          1 000683       0040

      445    14220    5            END;

      446    14221    4            IF KV$ERD.ICH_CHR~=0 AND KV$ERD.DCH_CHR~=0 THEN %Y_MRD.HRZSCR='1'B;

  14221   1 000684  D2C4 001F                            LLH,R5   31,B4
          1 000686  5901 000B                            BEZ,R5   s:14222,PREL
          1 000688  82C4 001F                            LB,'00FF'X        31,B4
          1 00068A       00FF
          1 00068B  0581 0006                            BBF      s:14222,PREL

  14221   1 00068D  8946 0017                            LBT,'0020'X       23,B6
  14221   1 00068F       0020
          1 000690  0F81 0004                            B        s:14223,PREL

      447    14222    4            ELSE %Y_MRD.HRZSCR='0'B;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:116  

  14222   1 000692  8846 0017                            LBF,'0020'X       23,B6
  14222   1 000694       0020

      448    14223    4            %Y_MRD.FRSCLMFLD=KV$ERD.FRSCLMFLD;

  14223   1 000695  D844 0016                            LDR,R5   22,B4
          1 000697  5045                                 SOR,R5   5
          1 000698  DAC6 0018                            SRM,R5,'0010'X    24,B6
          1 00069A       0010

      449    14224    4            IF KV$ERD.MSGLIN_CHR=0 OR KV$ERD.ENDMSGLIN_CHR=0

  14224   1 00069B  82C4 002B                            LB,'00FF'X        43,B4
  14224   1 00069D       00FF
          1 00069E  0581 0005                            BBF      s:14225,PREL
          1 0006A0  D2C4 002C                            LLH,R5   44,B4
          1 0006A2  5981 0006                            BNEZ,R5  s:14226,PREL

      450    14225    4            THEN %Y_MRD.MSGLIN='0'B;

  14225   1 0006A4  8846 0018                            LBF,'0008'X       24,B6
  14225   1 0006A6       0008
          1 0006A7  0F81 0004                            B        s:14227,PREL

      451    14226    4            ELSE %Y_MRD.MSGLIN='1'B;

  14226   1 0006A9  8946 0018                            LBT,'0008'X       24,B6
  14226   1 0006AB       0008

      452    14227    4            IF KV$ERD.SGRHDN_CHR=BINASC(0) THEN %Y_MRD.SMLHDNATR='1'B;

  14227   1 0006AC  D844 0018                            LDR,R5   24,B4
          1 0006AE  5008                                 SOL,R5   8
          1 0006AF  5068                                 SAR,R5   8
          1 0006B0  5D00                                 CMV,R5   0
          1 0006B1  0981 0006                            BNE      s:14228,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:117  

  14227   1 0006B3  8946 0016                            LBT,'0040'X       22,B6
  14227   1 0006B5       0040
          1 0006B6  0F81 0004                            B        s:14229,PREL

      453    14228    4            ELSE %Y_MRD.SMLHDNATR='0'B;

  14228   1 0006B8  8846 0016                            LBF,'0040'X       22,B6
  14228   1 0006BA       0040

      454    14229    4            IF KV$ERD.DCLFLD_ALG=3 THEN %Y_MRD.DCLATRWHNOTP='1'B;

  14229   1 0006BB  D2C4 0018                            LLH,R5   24,B4
          1 0006BD  5D03                                 CMV,R5   3
          1 0006BE  0981 0006                            BNE      s:14230,PREL

  14229   1 0006C0  8946 0018                            LBT,'0200'X       24,B6
  14229   1 0006C2       0200
          1 0006C3  0F81 02B6                            B        s:14393,PREL

      455    14230    4            ELSE %Y_MRD.DCLATRWHNOTP='0'B;

  14230   1 0006C5  8846 0018                            LBF,'0200'X       24,B6
  14230   1 0006C7       0200
          1 0006C8  0F81 02B1                            B        s:14393,PREL

      456    14231    4         CASE(%KV_PRMID_CURSORUP);

      457    14232    4            IF NOT %Y_MRD.CALUSR_PST

  14232   1 0006CA  82C6 000C                            LB,'0040'X        12,B6
  14232   1 0006CC       0040
          1 0006CD  0501 02AC                            BBT      s:14393,PREL

      458    14233    4            THEN %Y_MRD.CURSORUP=BINBIT(OLDVAL,1);

  14233   1 0006CF  600F                                 SOL,R6   15
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:118  
          1 0006D0  604E                                 SOR,R6   14
          1 0006D1  EAC6 0017                            SRM,R6,'0002'X    23,B6
          1 0006D3       0002
          1 0006D4  0F81 02A5                            B        s:14393,PREL

      459    14234    4         CASE(%KV_PRMID_FCNTBL);

      460    14235    4            CALL KVI$NEWINPFNCTBL;

  14235   1 0006D6  CBF0 0000                            LAB,B4   0,IMO
          1 0006D8  E380 0000 0000  xent                 LNJ,B6   KVI$NEWINPFNCTBL
          1 0006DB       0001                            DC       s:14235+6,PREL
          1 0006DC  0F81 029D                            B        s:14393,PREL

      461    14236    4         CASE(%KV_PRMID_FULLDUPLEXPAPERTAPE,%KV_PRMID_HALFDUPLEXPAPERTAPE);

      462    14237    4            IF OLDVAL=1 AND NOT %KV_SSN.REDRQSPND

  14237   1 0006DE  6D01                                 CMV,R6   1
          1 0006DF  0981 0011                            BNE      s:14239,PREL
          1 0006E1  CCC5 0002                            LDB,B4   2,B5
          1 0006E3  82C4 0028                            LB,'0002'X        40,B4
          1 0006E5       0002
          1 0006E6  0501 000A                            BBT      s:14239,PREL

      463    14238    4            THEN CALL KVO$OTP1_VRT ('11'X);

  14238   1 0006E8  BB80 0000 0007  02                   LAB,B3   +7
          1 0006EB  CBF0 0100                            LAB,B4   256,IMO
          1 0006ED  E380 0000 0000  xent                 LNJ,B6   KVO$OTP1_VRT
          1 0006F0       0001                            DC       s:14239,PREL

      464    14239    4            IF VDH_SETPRM.PRMID=%KV_PRMID_FULLDUPLEXPAPERTAPE THEN EXIT;

  14239   1 0006F1  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 0006F3  6D49                                 CMV,R6   73
          1 0006F4  0901 0285                            BE       s:14393,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:119  

      465    14240    4            STR$=KV$PTR.SSN$;

  14240   1 0006F6  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0006F9  DCC6 0002                            LDB,B5   2,B6
          1 0006FB  DFC7 002A                            STB,B5   STR$,AUTO

      466    14241    4            GOTO SET_THROT;

  14241   1 0006FD  0F81 000E                            B        s:14246,PREL

      467    14242    4         CASE(%KV_PRMID_OUTPUT);

      468    14243    4            IF OLDVAL=1 THEN %KV_VDI.RQSOTP = '0'B;

  14243   1 0006FF  6D01                                 CMV,R6   1
          1 000700  0981 0005                            BNE      s:14244,PREL

  14243   1 000702  CC85                                 LDB,B4   ,B5
          1 000703  8844 0019                            LBF,'0008'X       25,B4
          1 000705       0008

      469    14244    4            STR$=KV$PTR.SSN$;

  14244   1 000706  CCC5 0002                            LDB,B4   2,B5
          1 000708  CFC7 002A                            STB,B4   STR$,AUTO

      470    14245    4            GOTO SET_THROT;

  14245   1 00070A  0F81 0001                            B        s:14246,PREL

      471    14246    4         CASE(%KV_PRMID_OUTPUTDISCARD);

  14245   1                              SET_THROT       null
      472    14247    4   SET_THROT:;
      473    14248    4            %Y_SSN.OTPBLK='1'B;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:120  
  14248   1 00070C  ECC7 002A            SET_THROT       LDB,B6   STR$,AUTO
          1 00070E  8946 0028                            LBT,'4000'X       40,B6
          1 000710       4000

      474    14249    4            CALL KVM$SND (KV_SND_RQSDAT_GNR);

  14249   1 000711  BB80 0000 0009  02                   LAB,B3   +9
          1 000714  CBF0 0100                            LAB,B4   256,IMO
          1 000716  E380 0000 0000  xent                 LNJ,B6   KVM$SND
          1 000719       0001                            DC       s:14249+9,PREL
          1 00071A  0F81 025F                            B        s:14393,PREL

      475    14250    4         CASE(%KV_PRMID_HRZSCR);

      476    14251    4            IF %Y_MVD.ORG<%KV#VD_ORG_FORM THEN GOTO HRZINS;

  14251   1 00071C  D2C6 0015                            LLH,R5   21,B6
          1 00071E  5D04                                 CMV,R5   4
          1 00071F  0201 001B                            BL       s:14258,PREL

      477    14252    4            ELSE IF %Y_MVD.ORG=%KV#VD_ORG_SE THEN CALL KVE$FIXHRZSCR;

  14252   1 000721  5D05                                 CMV,R5   5
          1 000722  0981 0009                            BNE      s:14253,PREL

  14252   1 000724  CBF0 0000                            LAB,B4   0,IMO
          1 000726  E380 0000 0000  xent                 LNJ,B6   KVE$FIXHRZSCR
          1 000729       0001                            DC       s:14252+9,PREL
          1 00072A  0F81 024F                            B        s:14393,PREL

      478    14253    4            ELSE /* IF ORG=FORM */ %Y_MVD.HRZSCR='0'B;

  14253   1 00072C  8846 0016                            LBF,'0004'X       22,B6
  14253   1 00072E       0004
          1 00072F  0F81 024A                            B        s:14393,PREL

      479    14254    4         CASE(%KV_PRMID_RETYPOVR,%KV_PRMID_EDITOVR);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:121  

      480    14255    4            IF %Y_MVD.ORG<%KV#VD_ORG_FORM THEN GOTO HRZINS;

  14255   1 000731  D2C6 0015                            LLH,R5   21,B6
          1 000733  5D04                                 CMV,R5   4
          1 000734  0201 0006                            BL       s:14258,PREL

      481    14256        /* Keep them on if they started that way */
      482    14257    4            STR$->BI.T(OFFSET)='1'B;

  14257   1 000736  9847 002E                            LDR,R1   OFFSET,AUTO
          1 000738  8916                                 LBT      ,B6,R1
          1 000739  0F81 0240                            B        s:14393,PREL

      483    14258    4         CASE(%KV_PRMID_INSMOD);

  14257   1                              HRZINS          null
      484    14259    4   HRZINS:  ;
      485    14260    5            IF NOT %Y_MVD.RETYPOVR OR NOT %Y_MVD.EDITOVR THEN DO;

  14260   1 00073B  82C6 0016            HRZINS          LB,'0080'X        22,B6
  14260   1 00073D       0080
          1 00073E  0581 0006                            BBF      s:14261,PREL
          1 000740  82C6 0016                            LB,'0040'X        22,B6
          1 000742       0040
          1 000743  0501 0236                            BBT      s:14393,PREL

      486    14261    5               %Y_MVD.INSMOD='0'B;

  14261   1 000745  8846 0016                            LBF,'0008'X       22,B6
  14261   1 000747       0008

      487    14262    5               %Y_MVD.HRZSCR='0'B;

  14262   1 000748  8846 0016                            LBF,'0004'X       22,B6
  14262   1 00074A       0004

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:122  
      488    14263    5            END;

  14263   1 00074B  0F81 022E                            B        s:14393,PREL

      489    14264    4         CASE(%KV_PRMID_MVDLNG,%KV_PRMID_LIMBO,%KV_PRMID_FIRSTLINE);

      490    14265    5            IF NOT %KV_MRD.PHSFRM THEN DO;

  14265   1 00074D  CCC5 0008                            LDB,B4   8,B5
          1 00074F  82C4 0018                            LB,'0400'X        24,B4
          1 000751       0400
          1 000752  0501 0227                            BBT      s:14393,PREL

      491    14266                            /* This is a variable-length device,set other lengths     */
      492    14267    5               OFFSET=255;

  14267   1 000754  D870 00FF                            LDR,R5   255,IMO
          1 000756  DF47 002E                            STR,R5   OFFSET,AUTO

      493    14268    5               OLDVAL=%KV_MRD.LNG;

  14268   1 000758  E2C4 0015                            LLH,R6   21,B4
          1 00075A  EF47 004E                            STR,R6   OLDVAL,AUTO

      494    14269    5               GOTO SETLNG;

  14269   1 00075C  0F81 0122                            B        s:14337,PREL

      495    14270    5            END;
      496    14271    4         CASE(%KV_PRMID_MINLNG,%KV_PRMID_MINWDT);

      497    14272    4            IF %KV_MVD.ORG=%KV#VD_ORG_FORM

  14272   1 00075E  CCC5 0006                            LDB,B4   6,B5
          1 000760  D2C4 0015                            LLH,R5   21,B4
          1 000762  5D04                                 CMV,R5   4
          1 000763  0981 0216                            BNE      s:14393,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:123  

      498    14273    4            THEN STR$->BYT.E(OFFSET)=OLDVAL;

  14273   1 000765  9847 002E                            LDR,R1   OFFSET,AUTO
          1 000767  E796                                 STH,R6   ,B6,R1
          1 000768  0F81 0211                            B        s:14393,PREL

      499    14274    4         CASE(%KV_PRMID_SRDOPT);

      500    14275    4            IF %KV_MVD.ORG=%KV#VD_ORG_FORM

  14275   1 00076A  CCC5 0006                            LDB,B4   6,B5
          1 00076C  D2C4 0015                            LLH,R5   21,B4
          1 00076E  5D04                                 CMV,R5   4
          1 00076F  0981 020A                            BNE      s:14393,PREL

      501    14276    4            THEN STR$->KV$SRD.OPT='0'B;

  14276   1 000771  8846 001C                            LBF,'8000'X       28,B6
  14276   1 000773       8000
          1 000774  0F81 0205                            B        s:14393,PREL

      502    14277    4         CASE(%KV_PRMID_PAGEHALT, %KV_PRMID_NOOPTMIZ, %KV_PRMID_TRUNCATE);

      503    14278    4            IF %KV_MVD.ORG>=%KV#VD_ORG_FORM

  14278   1 000776  CCC5 0006                            LDB,B4   6,B5
          1 000778  D2C4 0015                            LLH,R5   21,B4
          1 00077A  5D04                                 CMV,R5   4
          1 00077B  0201 01FE                            BL       s:14393,PREL

      504    14279    4            THEN STR$->BI.T(OFFSET)='0'B;

  14279   1 00077D  9847 002E                            LDR,R1   OFFSET,AUTO
          1 00077F  8816                                 LBF      ,B6,R1
          1 000780  0F81 01F9                            B        s:14393,PREL

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:124  
      505    14280    4         CASE(%KV_PRMID_TOPBRD,%KV_PRMID_BTMBRD,

      506    14281    4              %KV_PRMID_LFTBRD,%KV_PRMID_RHTBRD,
      507    14282    4              %KV_PRMID_HBRDCHR,%KV_PRMID_VBRDCHR);
      508    14283    4            %KV_SRD.BRDUPD='1'B;

  14283   1 000782  CCC5 000A                            LDB,B4   10,B5
          1 000784  8944 000F                            LBT,'0010'X       15,B4
          1 000786       0010
          1 000787  0F81 01F2                            B        s:14393,PREL

      509    14284    4         CASE(%KV_PRMID_HBRDSIZ,%KV_PRMID_VBRDSIZ);

      510    14285    4            STR$->BYT.E(OFFSET)=OLDVAL;

  14285   1 000789  9847 002E                            LDR,R1   OFFSET,AUTO
          1 00078B  E796                                 STH,R6   ,B6,R1

      511    14286    4            OLDVAL=MOD(OLDVAL,16);

  14286   1 00078C  E570 000F                            AND,R6   15,IMO
          1 00078E  EF47 004E                            STR,R6   OLDVAL,AUTO

      512    14287    5            IF OLDVAL~=VDH_SETPRM.VAL THEN DO;

  14287   1 000790  E947 000C                            CMR,R6   VDH_SETPRM+2,AUTO
          1 000792  0901 01E7                            BE       s:14393,PREL

      513    14288    5               STR$->BYT.E(OFFSET)=STR$->BYT.E(OFFSET)+VDH_SETPRM.VAL-OLDVAL;

  14288   1 000794  D296                                 LLH,R5   ,B6,R1
          1 000795  DA47 000C                            ADD,R5   VDH_SETPRM+2,AUTO
          1 000797  D256                                 SUB,R5   R6
          1 000798  D796                                 STH,R5   ,B6,R1

      514    14289    5               STR$->KV$SRD.BRDUPD='1'B;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:125  
  14289   1 000799  8946 000F                            LBT,'0010'X       15,B6
  14289   1 00079B       0010

      515    14290    5            END;

  14290   1 00079C  0F81 01DD                            B        s:14393,PREL

      516    14291    4         CASE(%KV_PRMID_WRPPAG);

      517    14292    4            IF NOT %Y_SRD.SCROLL AND OLDVAL~=0 THEN GOTO SETPST;

  14292   1 00079E  82C6 000E                            LB,'0008'X        14,B6
  14292   1 0007A0       0008
          1 0007A1  0501 0003                            BBT      s:14292+7,PREL
          1 0007A3  6981 0176                            BNEZ,R6  s:14366,PREL
          1 0007A5  0F81 01D4                            B        s:14393,PREL

      518    14293    4         CASE(%KV_PRMID_OTPTAB);

      519    14294                                                /* First tab stop is MARGIN value     */
      520    14295    4            OFFSET=VDH_SETPRM.VAL/256;

  14295   1 0007A7  D847 000C                            LDR,R5   VDH_SETPRM+2,AUTO
          1 0007A9  5048                                 SOR,R5   8
          1 0007AA  DF47 002E                            STR,R5   OFFSET,AUTO

      521    14296    4            IF OFFSET=0 OR OFFSET=255 OR OFFSET>=%KV_SRD.WDT

  14296   1 0007AC  5901 01CD                            BEZ,R5   s:14393,PREL
          1 0007AE  D970 00FF                            CMR,R5   255,IMO
          1 0007B0  0901 01C9                            BE       s:14393,PREL
          1 0007B2  CCC5 000A                            LDB,B4   10,B5
          1 0007B4  5801 0005                            BLZ,R5   s:14296+14,PREL
          1 0007B6  D944 000D                            CMR,R5   13,B4
          1 0007B8  0281 01C1                            BGE      s:14393,PREL
          1 0007BA  BCC5 0004                            LDB,B3   4,B5
          1 0007BC  5801 0005                            BLZ,R5   s:14298,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:126  
          1 0007BE  D943 001A                            CMR,R5   26,B3
          1 0007C0  0901 01B9                            BE       s:14393,PREL

      522    14297    4              OR OFFSET=%KV_STR.LFTMRGCLM THEN EXIT;
      523    14298    4            %KV_SRD.LFTMRGCLM=OFFSET;

  14298   1 0007C2  D7C4 000F                            STH,R5   15,B4

      524    14299    4            %KV_MVD.WDT = %KV_MVD.WDT+%Y_STR.LFTMRGCLM-OFFSET;

  14299   1 0007C4  CCC5 0006                            LDB,B4   6,B5
          1 0007C6  C844 0013                            LDR,R4   19,B4
          1 0007C8  CA46 001A                            ADD,R4   26,B6
          1 0007CA  C255                                 SUB,R4   R5
          1 0007CB  CF44 0013                            STR,R4   19,B4

      525    14300    4            %Y_STR.LFTMRGCLM=OFFSET;

  14300   1 0007CD  DF46 001A                            STR,R5   26,B6

      526    14301    4            GOTO SETWDT;

  14301   1 0007CF  0F81 0017                            B        s:14311,PREL

      527    14302    4         CASE (%KV_PRMID_MRDWDT);

      528    14303    5            IF %KV_SRD.TOPLFT.CLM>VDH_SETPRM.VAL THEN DO;

  14303   1 0007D1  CCC5 000A                            LDB,B4   10,B5
          1 0007D3  D844 000A                            LDR,R5   10,B4
          1 0007D5  5801 0009                            BLZ,R5   s:14309,PREL
          1 0007D7  D947 000C                            CMR,R5   VDH_SETPRM+2,AUTO
          1 0007D9  0381 0005                            BLE      s:14309,PREL

      529    14304        /* Attempting to reduce MRD to less than an SRD, dont do it. */
      530    14305
      531    14306    5               VDH_SETPRM.VAL=OLDVAL;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:127  

  14306   1 0007DB  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO

      532    14307    5               %Y_MRD.WDT=OLDVAL;

  14307   1 0007DD  EF46 000B                            STR,R6   11,B6

      533    14308    5            END;

      534    14309    4            %KV_SRD.SRDEND.CLM=%Y_MRD.WDT;

  14309   1 0007DF  CCC5 000A                            LDB,B4   10,B5
          1 0007E1  D846 000B                            LDR,R5   11,B6
          1 0007E3  DF44 001B                            STR,R5   27,B4

      535    14310    4            GOTO SETWDT;

  14310   1 0007E5  0F81 0001                            B        s:14311,PREL

      536    14311    4         CASE (%KV_PRMID_MVDWDT);

  14310   1                              SETWDT          null
      537    14312    4   SETWDT:  ;
      538    14313    4            STR$=KV$PTR.SRD$;

  14313   1 0007E7  CCC5 000A            SETWDT          LDB,B4   10,B5
          1 0007E9  CFC7 002A                            STB,B4   STR$,AUTO

      539    14314    4            OFFSET=%Y_SRD.SRDEND.CLM-%Y_SRD.ORG.CLM;

  14314   1 0007EB  D844 001B                            LDR,R5   27,B4
          1 0007ED  D244 0008                            SUB,R5   8,B4
          1 0007EF  DF47 002E                            STR,R5   OFFSET,AUTO

      540    14315    4            IF %Y_SRD.LFTBRD THEN OFFSET=OFFSET-%Y_SRD.VBRDSIZ;

  14315   1 0007F1  82C4 001D                            LB,'2000'X        29,B4
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:128  
  14315   1 0007F3       2000
          1 0007F4  0581 000B                            BBF      s:14316,PREL

  14315   1 0007F6  C844 001D                            LDR,R4   29,B4
          1 0007F8  4048                                 SOR,R4   8
          1 0007F9  C570 000F                            AND,R4   15,IMO
          1 0007FB  C255                                 SUB,R4   R5
          1 0007FC  D854                                 LDR,R5   R4
          1 0007FD  8255                                 NEG      R5
          1 0007FE  DF47 002E                            STR,R5   OFFSET,AUTO

      541    14316    4            IF %Y_SRD.LFTMRGCLM>1 THEN OFFSET=OFFSET-%Y_SRD.LFTMRGCLM+1;

  14316   1 000800  C2C4 000F                            LLH,R4   15,B4
          1 000802  4D01                                 CMV,R4   1
          1 000803  0381 0007                            BLE      s:14317,PREL

  14316   1 000805  C255                                 SUB,R4   R5
          1 000806  D854                                 LDR,R5   R4
          1 000807  8255                                 NEG      R5
          1 000808  5E01                                 ADV,R5   1
          1 000809  DF47 002E                            STR,R5   OFFSET,AUTO

      542    14317    5            IF OFFSET<0 THEN DO;

  14317   1 00080B  5881 000F                            BGEZ,R5  s:14321,PREL

      543    14318    5               OFFSET=%Y_SRD.SRDEND.CLM-%Y_SRD.ORG.CLM;

  14318   1 00080D  C844 001B                            LDR,R4   27,B4
          1 00080F  C244 0008                            SUB,R4   8,B4
          1 000811  D854                                 LDR,R5   R4
          1 000812  DF47 002E                            STR,R5   OFFSET,AUTO

      544    14319    5               %Y_SRD.TOPLFT.CLM=%Y_SRD.ORG.CLM+1;

  14319   1 000814  C844 0008                            LDR,R4   8,B4
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:129  
          1 000816  4E01                                 ADV,R4   1
          1 000817  CF44 000A                            STR,R4   10,B4

      545    14320    5            END; ELSE DO;

  14320   1 000819  0F81 001C                            B        s:14325,PREL

      546    14321    5               %Y_SRD.TOPLFT.CLM=%Y_SRD.SRDEND.CLM-OFFSET+1;

  14321   1 00081B  D244 001B                            SUB,R5   27,B4
          1 00081D  8255                                 NEG      R5
          1 00081E  5E01                                 ADV,R5   1
          1 00081F  DF44 000A                            STR,R5   10,B4

      547    14322    5               IF %Y_SRD.RHTBRD THEN OFFSET=OFFSET-%Y_SRD.VBRDSIZ;

  14322   1 000821  82C4 001D                            LB,'1000'X        29,B4
  14322   1 000823       1000
          1 000824  0581 000B                            BBF      s:14323,PREL

  14322   1 000826  C844 001D                            LDR,R4   29,B4
          1 000828  4048                                 SOR,R4   8
          1 000829  C570 000F                            AND,R4   15,IMO
          1 00082B  C247 002E                            SUB,R4   OFFSET,AUTO
          1 00082D  8254                                 NEG      R4
          1 00082E  CF47 002E                            STR,R4   OFFSET,AUTO

      548    14323    5               IF OFFSET<0 THEN OFFSET=0;

  14323   1 000830  C847 002E                            LDR,R4   OFFSET,AUTO
          1 000832  4881 0003                            BGEZ,R4  s:14325,PREL

  14323   1 000834  8747 002E                            CL       OFFSET,AUTO

      549    14324    5            END;

      550    14325    4            IF %KV_MVD.WDT > OFFSET THEN %KV_MVD.WDT=OFFSET;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:130  

  14325   1 000836  ECC5 0006                            LDB,B6   6,B5
          1 000838  D846 0013                            LDR,R5   19,B6
          1 00083A  5801 0005                            BLZ,R5   s:14325+10,PREL
          1 00083C  D947 002E                            CMR,R5   OFFSET,AUTO
          1 00083E  0A81 0005                            BALE     s:14326,PREL

  14325   1 000840  D847 002E                            LDR,R5   OFFSET,AUTO
          1 000842  DF46 0013                            STR,R5   19,B6

      551    14326    4            %Y_SRD.WDT=%KV_MVD.WDT;

  14326   1 000844  ECC5 0006                            LDB,B6   6,B5
          1 000846  D846 0013                            LDR,R5   19,B6
          1 000848  DF44 000D                            STR,R5   13,B4

      552    14327    4            %Y_SRD.BTMRHT.CLM=%Y_SRD.WDT-1+%Y_SRD.TOPLFT.CLM;

  14327   1 00084A  DA44 000A                            ADD,R5   10,B4
          1 00084C  5EFF                                 ADV,R5   -1
          1 00084D  DF44 000C                            STR,R5   12,B4
          1 00084F  0F81 012A                            B        s:14393,PREL

      553    14328    4         CASE(%KV_PRMID_DSPHEIGHT);

      554    14329    4            OFFSET=%Y_MRD.LNG;

  14329   1 000851  D2C6 0015                            LLH,R5   21,B6
          1 000853  DF47 002E                            STR,R5   OFFSET,AUTO

      555    14330    4            IF VDH_SETPRM.VAL=0 THEN %Y_MRD.DSPHEIGHT=OFFSET;

  14330   1 000855  C847 000C                            LDR,R4   VDH_SETPRM+2,AUTO
          1 000857  4981 0003                            BNEZ,R4  s:14331,PREL

  14330   1 000859  D7C6 000A                            STH,R5   10,B6

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:131  
      556    14331    4            IF VDH_SETPRM.VAL=0 AND OFFSET=OLDVAL THEN EXIT;

  14331   1 00085B  C847 000C                            LDR,R4   VDH_SETPRM+2,AUTO
          1 00085D  4981 0006                            BNEZ,R4  s:14332,PREL
          1 00085F  5801 0004                            BLZ,R5   s:14332,PREL
          1 000861  D956                                 CMR,R5   R6
          1 000862  0901 0117                            BE       s:14393,PREL

      557    14332    4            OLDVAL=1;                      /* Force SETLNG to do something       */

  14332   1 000864  6C01                                 LDV,R6   1
          1 000865  EF47 004E                            STR,R6   OLDVAL,AUTO

      558    14333    4            GOTO SETLNG;

  14333   1 000867  0F81 0017                            B        s:14337,PREL

      559    14334    4         CASE(%KV_PRMID_MRDLNG);

      560    14335    4            OFFSET=%Y_MRD.LNG;

  14335   1 000869  D2C6 0015                            LLH,R5   21,B6
          1 00086B  DF47 002E                            STR,R5   OFFSET,AUTO

      561    14336    4            %Y_MRD.DSPHEIGHT=OFFSET;

  14336   1 00086D  D7C6 000A                            STH,R5   10,B6

      562    14337    5            IF OFFSET=0 THEN DO;

  14337   1 00086F  5981 000C                            BNEZ,R5  s:14342,PREL

      563    14338    5               OFFSET=255;

  14338   1 000871  D870 00FF                            LDR,R5   255,IMO
          1 000873  DF47 002E                            STR,R5   OFFSET,AUTO

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:132  
      564    14339    5               %Y_MRD.LNG=OFFSET;

  14339   1 000875  D7C6 0015                            STH,R5   21,B6

      565    14340    5               %Y_MRD.PHSFRM='0'B;

  14340   1 000877  8846 0018                            LBF,'0400'X       24,B6
  14340   1 000879       0400

      566    14341    5            END;

  14341   1 00087A  0F81 0004                            B        s:14337,PREL

      567    14342    4            ELSE %Y_MRD.PHSFRM='1'B;

  14342   1 00087C  8946 0018                            LBT,'0400'X       24,B6
  14342   1 00087E       0400

  14337   1                              SETLNG          null
      568    14343    4   SETLNG:  ;
      569    14344    4            STR$=KV$PTR.SRD$;

  14344   1 00087F  CCC5 000A            SETLNG          LDB,B4   10,B5
          1 000881  CFC7 002A                            STB,B4   STR$,AUTO

      570    14345    4            IF NOT %Y_SMRD.PHSFRM AND %KV_MVD.LNG>=12

  14345   1 000883  EC84                                 LDB,B6   ,B4
          1 000884  82C6 0018                            LB,'0400'X        24,B6
          1 000886       0400
          1 000887  0501 0015                            BBT      s:14347,PREL
          1 000889  BCC5 0006                            LDB,B3   6,B5
          1 00088B  C2C3 0014                            LLH,R4   20,B3
          1 00088D  4D0C                                 CMV,R4   12
          1 00088E  0201 000E                            BL       s:14347,PREL

      571    14346    4            THEN OFFSET=%KV_MVD.LNG+%KV_MVD.FRSLIN+%KV_MVD.LMB;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:133  

  14346   1 000890  B843 001D                            LDR,R3   29,B3
          1 000892  B570 00FF                            AND,R3   255,IMO
          1 000894  CA53                                 ADD,R4   R3
          1 000895  A843 0014                            LDR,R2   20,B3
          1 000897  A570 00FF                            AND,R2   255,IMO
          1 000899  AA54                                 ADD,R2   R4
          1 00089A  D852                                 LDR,R5   R2
          1 00089B  DF47 002E                            STR,R5   OFFSET,AUTO

      572    14347    4            IF OFFSET=OLDVAL OR %Y_SMRD.USRCNT>1 OR %Y_SRD.USRCNT>1 THEN EXIT;

  14347   1 00089D  5801 0004                            BLZ,R5   s:14347+5,PREL
          1 00089F  D956                                 CMR,R5   R6
          1 0008A0  0901 00D9                            BE       s:14393,PREL
          1 0008A2  C846 000A                            LDR,R4   10,B6
          1 0008A4  C570 00FF                            AND,R4   255,IMO
          1 0008A6  4D01                                 CMV,R4   1
          1 0008A7  0301 00D2                            BG       s:14393,PREL
          1 0008A9  B844 0006                            LDR,R3   6,B4
          1 0008AB  3D01                                 CMV,R3   1
          1 0008AC  0301 00CD                            BG       s:14393,PREL

      573    14348    4            %Y_SMRD.LNG=OFFSET;

  14348   1 0008AE  D7C6 0015                            STH,R5   21,B6

      574    14349    4            %Y_SRD.BTMRHT.LIN=OFFSET;

  14349   1 0008B0  DF44 000B                            STR,R5   11,B4

      575    14350    4            %Y_SRD.SRDEND.LIN=OFFSET;

  14350   1 0008B2  DF44 001A                            STR,R5   26,B4

      576    14351    4            IF %Y_SMRD.DSPHEIGHT=0 OR %Y_SMRD.DSPHEIGHT>OFFSET

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:134  
  14351   1 0008B4  EC84                                 LDB,B6   ,B4
          1 0008B5  C2C6 000A                            LLH,R4   10,B6
          1 0008B7  4901 000E                            BEZ,R4   s:14353,PREL
          1 0008B9  C955                                 CMR,R4   R5
          1 0008BA  0A01 000B                            BAG      s:14353,PREL
          1 0008BC  82C6 0018                            LB,'0800'X        24,B6
          1 0008BE       0800
          1 0008BF  0501 0006                            BBT      s:14353,PREL
          1 0008C1  82C6 0018                            LB,'0400'X        24,B6
          1 0008C3       0400
          1 0008C4  0501 0003                            BBT      s:14354,PREL

      577    14352    4              OR %Y_SMRD.CTNFRM OR NOT %Y_SMRD.PHSFRM
      578    14353    4            THEN %Y_SMRD.DSPHEIGHT=OFFSET;

  14353   1 0008C6  D7C6 000A                            STH,R5   10,B6

      579    14354    4            %Y_SRD.ORG.LIN=OFFSET-%Y_SMRD.DSPHEIGHT;

  14354   1 0008C8  EC84                                 LDB,B6   ,B4
          1 0008C9  C2C6 000A                            LLH,R4   10,B6
          1 0008CB  C255                                 SUB,R4   R5
          1 0008CC  8254                                 NEG      R4
          1 0008CD  CF44 0007                            STR,R4   7,B4

      580    14355    4            %Y_SRD.TOPLFT.LIN=%Y_SRD.ORG.LIN+1;

  14355   1 0008CF  4E01                                 ADV,R4   1
          1 0008D0  CF44 0009                            STR,R4   9,B4

      581    14356    4            %Y_SRD.LNG=%Y_SRD.BTMRHT.LIN-%Y_SRD.ORG.LIN;

  14356   1 0008D2  B844 000B                            LDR,R3   11,B4
          1 0008D4  B244 0007                            SUB,R3   7,B4
          1 0008D6  B7C4 000E                            STH,R3   14,B4

      582    14357    4            IF OLDVAL~=0 THEN GOTO SETPST; /* Adjust position to a legal spot    */
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:135  

  14357   1 0008D8  6981 0041                            BNEZ,R6  s:14366,PREL
          1 0008DA  0F81 009F                            B        s:14393,PREL

      583    14358    4         CASE(%KV_PRMID_SCROLL);

      584    14359    4            IF %KV_MVD.ORG<%KV#VD_ORG_FORM

  14359   1 0008DC  CCC5 0006                            LDB,B4   6,B5
          1 0008DE  D2C4 0015                            LLH,R5   21,B4
          1 0008E0  5D04                                 CMV,R5   4
          1 0008E1  0281 0009                            BGE      s:14361,PREL

      585    14360    4            THEN %Y_SRD.SAVSCROLL=%Y_SRD.SCROLL;

  14360   1 0008E3  C846 000E                            LDR,R4   14,B6
          1 0008E5  4043                                 SOR,R4   3
          1 0008E6  CAC6 000F                            SRM,R4,'0001'X    15,B6
          1 0008E8       0001
          1 0008E9  0F81 0009                            B        s:14362,PREL

      586    14361    4            ELSE IF %KV_MVD.RETYPOVR THEN %Y_SRD.SCROLL='0'B;

  14361   1 0008EB  82C4 0016                            LB,'0080'X        22,B4
  14361   1 0008ED       0080
          1 0008EE  0581 0004                            BBF      s:14362,PREL

  14361   1 0008F0  8846 000E                            LBF,'0008'X       14,B6
  14361   1 0008F2       0008

      587    14362    4            IF NOT %Y_SRD.VRTSCR THEN %Y_SRD.SCROLL='0'B;

  14362   1 0008F3  82C6 001D                            LB,'4000'X        29,B6
  14362   1 0008F5       4000
          1 0008F6  0501 0004                            BBT      s:14363,PREL

  14362   1 0008F8  8846 000E                            LBF,'0008'X       14,B6
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:136  
  14362   1 0008FA       0008

      588    14363    4            IF %Y_SRD.SCROLL OR OLDVAL~=0 THEN GOTO SETPST;

  14363   1 0008FB  82C6 000E                            LB,'0008'X        14,B6
  14363   1 0008FD       0008
          1 0008FE  0501 001B                            BBT      s:14366,PREL
          1 000900  6981 0019                            BNEZ,R6  s:14366,PREL
          1 000902  0F81 0077                            B        s:14393,PREL

      589    14364    4         CASE(%KV_PRMID_DEVSCROLL);

      590    14365    4            STR$=KV$PTR.SRD$;

  14365   1 000904  CCC5 000A                            LDB,B4   10,B5
          1 000906  CFC7 002A                            STB,B4   STR$,AUTO

      591    14366    5            IF OLDVAL~=0 THEN DO;

  14366   1 000908  6901 0009                            BEZ,R6   s:14370,PREL

      592    14367    5               %Y_SRD.SCROLL='0'B;

  14367   1 00090A  8844 000E                            LBF,'0008'X       14,B4
  14367   1 00090C       0008

      593    14368    5               %Y_SRD.SAVSCROLL='0'B;

  14368   1 00090D  8844 000F                            LBF,'0001'X       15,B4
  14368   1 00090F       0001

      594    14369    5            END;

  14369   1 000910  0F81 0009                            B        s:14366,PREL

      595    14370    4            ELSE IF NOT %Y_SRD.BRDEXS THEN %Y_SRD.VRTSCR = '1'B;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:137  
  14370   1 000912  82C4 000F                            LB,'0020'X        15,B4
  14370   1 000914       0020
          1 000915  0501 0004                            BBT      s:14366,PREL

  14370   1 000917  8944 001D                            LBT,'4000'X       29,B4
  14370   1 000919       4000

  14366   1                              SETPST          null
      596    14371    4   SETPST:  ;
      597    14372    4            IF NOT %Y_SMRD.PRINTTYPE THEN EXIT;

  14372   1 00091A  ECC7 002A            SETPST          LDB,B6   STR$,AUTO
          1 00091C  CC86                                 LDB,B4   ,B6
          1 00091D  82C4 0017                            LB,'0010'X        23,B4
          1 00091F       0010
          1 000920  0581 0059                            BBF      s:14393,PREL

      598    14373    4            %Y_SRD.VRTPSTOK = '0'B;

  14373   1 000922  8846 000E                            LBF,'0010'X       14,B6
  14373   1 000924       0010

      599    14374    4            %KV_VDI.UN_KNWPST='1'B;

  14374   1 000925  BC85                                 LDB,B3   ,B5
          1 000926  8943 001D                            LBT,'1000'X       29,B3
          1 000928       1000

      600    14375    5            IF %Y_SRD.SCROLL THEN DO;

  14375   1 000929  82C6 000E                            LB,'0008'X        14,B6
  14375   1 00092B       0008
          1 00092C  0581 001A                            BBF      s:14382,PREL

      601    14376    5               IF %KV_VDI.INPUNT~=%KV_INPUNT_BLK THEN %Y_SRD.FLDEND='0'B;

  14376   1 00092E  CC85                                 LDB,B4   ,B5
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:138  
          1 00092F  D844 001D                            LDR,R5   29,B4
          1 000931  5045                                 SOR,R5   5
          1 000932  D570 0003                            AND,R5   3,IMO
          1 000934  5D03                                 CMV,R5   3
          1 000935  0901 0005                            BE       s:14377,PREL

  14376   1 000937  8746 0010                            CL       16,B6
          1 000939  8746 0011                            CL       17,B6

      602    14377    5               %Y_SRD.CRT.LIN=%Y_SRD.TOPLFT.LIN;

  14377   1 00093B  D846 0009                            LDR,R5   9,B6
          1 00093D  DF46 0015                            STR,R5   21,B6

      603    14378    5               %Y_SRD.CRTVRTLINPHSLIN=%Y_SRD.CRT.LIN;

  14378   1 00093F  DF46 0013                            STR,R5   19,B6

      604    14379    5               %Y_SRD.NXTNONBLNLIN = 256;

  14379   1 000941  C870 0100                            LDR,R4   256,IMO
          1 000943  CF46 0014                            STR,R4   20,B6

      605    14380    5            END;

  14380   1 000945  0F81 001D                            B        s:14388,PREL

      606    14381    5            ELSE DO;

      607    14382    5               %KV_MVD.FRMLIN = MAXIMUM(%KV_MVD.LNG,1)-1;

  14382   1 000947  CCC5 0006                            LDB,B4   6,B5
          1 000949  5C01                                 LDV,R5   1
          1 00094A  C2C4 0014                            LLH,R4   20,B4
          1 00094C  C955                                 CMR,R4   R5
          1 00094D  0381 0002                            BLE      s:14382+9,PREL
          1 00094F  D854                                 LDR,R5   R4
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:139  
          1 000950  5EFF                                 ADV,R5   -1
          1 000951  D7C4 001D                            STH,R5   29,B4

      608    14383    5               %Y_SRD.CRT.LIN = %Y_SRD.BTMRHT.LIN;

  14383   1 000953  D846 000B                            LDR,R5   11,B6
          1 000955  DF46 0015                            STR,R5   21,B6

      609    14384    5               IF NOT %Y_SRD.WRPPAG

  14384   1 000957  82C6 000E                            LB,'0001'X        14,B6
  14384   1 000959       0001
          1 00095A  0501 0005                            BBT      s:14386,PREL

      610    14385    5               THEN %Y_SRD.NXTNONBLNLIN = 256;

  14385   1 00095C  C870 0100                            LDR,R4   256,IMO
          1 00095E  CF46 0014                            STR,R4   20,B6

      611    14386    5               %Y_SRD.CRTVRTLINPHSLIN=%Y_SRD.CRT.LIN+1;

  14386   1 000960  5E01                                 ADV,R5   1
          1 000961  DF46 0013                            STR,R5   19,B6

      612    14387    5            END;

      613    14388    4            %Y_SRD.HI_NONBLN.LIN=%Y_SRD.CRT.LIN;

  14388   1 000963  C846 0015                            LDR,R4   21,B6
          1 000965  CF46 0017                            STR,R4   23,B6

      614    14389    4            %Y_SRD.DVCLINBIS=%Y_SRD.BTMRHT.LIN-%Y_SRD.CRT.LIN;

  14389   1 000967  C246 000B                            SUB,R4   11,B6
          1 000969  8254                                 NEG      R4
          1 00096A  CF46 0019                            STR,R4   25,B6

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:140  
      615    14390    4            IF %Y_SMRD.DVCLIN > %Y_SMRD.LNG OR NOT %Y_SMRD.PHSFRM

  14390   1 00096C  CC86                                 LDB,B4   ,B6
          1 00096D  B2C4 0015                            LLH,R3   21,B4
          1 00096F  B944 001D                            CMR,R3   29,B4
          1 000971  0801 0006                            BAL      s:14391,PREL
          1 000973  82C4 0018                            LB,'0400'X        24,B4
          1 000975       0400
          1 000976  0501 0003                            BBT      s:14393,PREL

      616    14391    4            THEN %Y_SMRD.DVCLIN=%Y_SMRD.LNG;

  14391   1 000978  BF44 001D                            STR,R3   29,B4

      617    14392    4         END;

      618    14393    4         IF %KV_USRPRM.SETPRMPSTPRC(VDH_SETPRM.PRMID) THEN DO;

  14393   1 00097A  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00097D  DC86                                 LDB,B5   ,B6
          1 00097E  CCC5 0008                            LDB,B4   8,B5
          1 000980  BBC4 001B                            LAB,B3   27,B4
          1 000982  B847 000B                            LDR,R3   VDH_SETPRM+1,AUTO
          1 000984  82B3                                 LB       ,B3,R3
          1 000985  0581 0010                            BBF      s:14397,PREL

      619    14394    4            USR_SETPRM.PREPRC='0'B;

  14394   1 000987  8847 000A                            LBF,'0080'X       VDH_SETPRM,AUTO
  14394   1 000989       0080

      620    14395    4            CALL KVV$CALUSR(USR_SETPRM);

  14395   1 00098A  DBC7 000A                            LAB,B5   VDH_SETPRM,AUTO
          1 00098C  DFC7 0050                            STB,B5   OLDVAL+2,AUTO
          1 00098E  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
          1 000990  CBF0 0100                            LAB,B4   256,IMO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:141  
          1 000992  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR
          1 000995       0001                            DC       s:14397,PREL

      621    14396    4         END;

      622    14397    3         IF STRUCTURE<=VDH_SETPRM.SCP OR VDH_SETPRM.DMN~=0 THEN EXIT;

  14397   1 000996  E2C7 0011                            LLH,R6   VDH_SETPRM+7,AUTO
          1 000998  E947 002F                            CMR,R6   STRUCTURE,AUTO
          1 00099A  0281 008B                            BGE      s:14440,PREL
          1 00099C  82C7 0011                            LB,'00FF'X        VDH_SETPRM+7,AUTO
          1 00099E       00FF
          1 00099F  0501 0086                            BBT      s:14440,PREL

      623    14398    3         IF KV$PTR.VDI$=ADDR(NIL) THEN TEMP$=ADDR(NIL);ELSE TEMP$ = ADDR(NIL);

  14398   1 0009A1  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0009A4  8D86                                 CMN      ,B6
          1 0009A5  0981 0008                            BNE      s:14398+13,PREL

  14398   1 0009A7  DB80 0000 0000                       LAB,B5   0
          1 0009AA  DFC7 0008                            STB,B5   TEMP$,AUTO
          1 0009AC  0F81 0006                            B        s:14399,PREL

  14398   1 0009AE  DB80 0000 0000                       LAB,B5   0
          1 0009B1  DFC7 0008                            STB,B5   TEMP$,AUTO

      624    14399    3         IF STRUCTURE>=%KV_SCP_MRD THEN EXIT;

  14399   1 0009B3  D847 002F                            LDR,R5   STRUCTURE,AUTO
          1 0009B5  5D07                                 CMV,R5   7
          1 0009B6  0281 006F                            BGE      s:14440,PREL

      625    14400    3         IF TEMP$=ADDR(NIL)

  14400   1 0009B8  8DC7 0008                            CMN      TEMP$,AUTO
          1 0009BA  0981 0056                            BNE      s:14439,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:142  

      626    14401    3         THEN IF VDH_SETPRM.SCP>=%KV_SCP_SRD THEN GOTO NO_STUFF;

  14401   1 0009BC  6D06                                 CMV,R6   6
          1 0009BD  0281 0068                            BGE      s:14440,PREL

      627    14402    4         ELSE DO;

      628    14403        /*N* We only want to link thru SRDs if SCP is specified from the
      629    14404             "MRD" end.  Likewise, don't link through the STRs unless SCP
      630    14405             is from the "SSN" end.   At present, SCP is always from the
      631    14406             "SSN" end, so this code is disabled.
      632    14407                 IF STRUCTURE>=%KV_SCP_SRD THEN TEMP$=%KV_SRD.LNK$;
      633    14408        */
      634    14409    4            IF TEMP$=ADDR(NIL)

  14409   1 0009BF  8DC7 0008                            CMN      TEMP$,AUTO
          1 0009C1  0981 0045                            BNE      s:14435,PREL

      635    14410    4            THEN IF VDH_SETPRM.SCP>=%KV_SCP_MVD THEN GOTO NO_STUFF;

  14410   1 0009C3  6D04                                 CMV,R6   4
          1 0009C4  0281 0061                            BGE      s:14440,PREL

      636    14411    5            ELSE DO;

      637    14412        /*N* Likewise.
      638    14413                    IF STRUCTURE >= %KV_SCP_MVD THEN TEMP$=%KV_MVD.LNK$;
      639    14414        */
      640    14415    5               IF TEMP$=ADDR(NIL)

  14415   1 0009C6  8DC7 0008                            CMN      TEMP$,AUTO
          1 0009C8  0981 0034                            BNE      s:14431,PREL

      641    14416    5               THEN IF VDH_SETPRM.SCP>=%KV_SCP_STR THEN GOTO NO_STUFF;

  14416   1 0009CA  6D03                                 CMV,R6   3
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:143  
          1 0009CB  0281 005A                            BGE      s:14440,PREL

      642    14417    6               ELSE DO;

      643    14418    6                  IF STRUCTURE >= %KV_SCP_STR THEN TEMP$=%KV_STR.LNK$;

  14418   1 0009CD  5D03                                 CMV,R5   3
          1 0009CE  0201 0007                            BL       s:14419,PREL

  14418   1 0009D0  CCC6 0004                            LDB,B4   4,B6
          1 0009D2  BCC4 0002                            LDB,B3   2,B4
          1 0009D4  BFC7 0008                            STB,B3   TEMP$,AUTO

      644    14419    6                  IF TEMP$=ADDR(NIL)

  14419   1 0009D6  8DC7 0008                            CMN      TEMP$,AUTO
          1 0009D8  0981 0019                            BNE      s:14427,PREL

      645    14420    6                  THEN IF VDH_SETPRM.SCP>=%KV_SCP_SSN THEN GOTO NO_STUFF;

  14420   1 0009DA  6D02                                 CMV,R6   2
          1 0009DB  0281 004A                            BGE      s:14440,PREL

      646    14421    7                  ELSE DO;

      647    14422    7                     IF STRUCTURE >= %KV_SCP_SSN THEN TEMP$=%KV_SSN.LNK$;

  14422   1 0009DD  5D02                                 CMV,R5   2
          1 0009DE  0201 0007                            BL       s:14423,PREL

  14422   1 0009E0  DCC6 0002                            LDB,B5   2,B6
          1 0009E2  CCC5 0002                            LDB,B4   2,B5
          1 0009E4  CFC7 0008                            STB,B4   TEMP$,AUTO

      648    14423    7                     IF TEMP$=ADDR(NIL) THEN GOTO NO_STUFF;

  14423   1 0009E6  8DC7 0008                            CMN      TEMP$,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:144  
          1 0009E8  0901 003D                            BE       s:14440,PREL

      649    14424    7                     KV$PTR.SSN$=TEMP$;

  14424   1 0009EA  DCC7 0008                            LDB,B5   TEMP$,AUTO
          1 0009EC  DFC6 0002                            STB,B5   2,B6

      650    14425    7                     TEMP$=%KV_SSN.STR$;

  14425   1 0009EE  CCC5 0004                            LDB,B4   4,B5
          1 0009F0  CFC7 0008                            STB,B4   TEMP$,AUTO

      651    14426    7                  END;

      652    14427    6                  IF STRUCTURE < %KV_SCP_STR THEN EXIT;

  14427   1 0009F2  5D03                                 CMV,R5   3
          1 0009F3  0201 0009                            BL       s:14431,PREL

      653    14428    6                  KV$PTR.STR$=TEMP$;

  14428   1 0009F5  DCC7 0008                            LDB,B5   TEMP$,AUTO
          1 0009F7  DFC6 0004                            STB,B5   4,B6

      654    14429    6                  TEMP$=%KV_STR.MVD$;

  14429   1 0009F9  CCC5 0004                            LDB,B4   4,B5
          1 0009FB  CFC7 0008                            STB,B4   TEMP$,AUTO

      655    14430    6               END;

      656    14431    5               IF STRUCTURE < %KV_SCP_MVD THEN EXIT;

  14431   1 0009FD  5D04                                 CMV,R5   4
          1 0009FE  0201 0008                            BL       s:14435,PREL

      657    14432    5               KV$PTR.MVD$=TEMP$;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:145  

  14432   1 000A00  DCC7 0008                            LDB,B5   TEMP$,AUTO
          1 000A02  DFC6 0006                            STB,B5   6,B6

      658    14433    5               TEMP$=%KV_MVD.SRD$;

  14433   1 000A04  CC85                                 LDB,B4   ,B5
          1 000A05  CFC7 0008                            STB,B4   TEMP$,AUTO

      659    14434    5            END;

      660    14435    4            IF STRUCTURE < %KV_SCP_SRD THEN EXIT;

  14435   1 000A07  5D06                                 CMV,R5   6
          1 000A08  0201 0008                            BL       s:14439,PREL

      661    14436    4            KV$PTR.SRD$=TEMP$;

  14436   1 000A0A  DCC7 0008                            LDB,B5   TEMP$,AUTO
          1 000A0C  DFC6 000A                            STB,B5   10,B6

      662    14437    4            TEMP$=%KV_SRD.MRD$;

  14437   1 000A0E  CC85                                 LDB,B4   ,B5
          1 000A0F  CFC7 0008                            STB,B4   TEMP$,AUTO

      663    14438    4         END;

      664    14439    3         IF STRUCTURE>=%KV_SCP_MRD THEN KV$PTR.MRD$=TEMP$;

  14439   1 000A11  5D07                                 CMV,R5   7
          1 000A12  0201 0005                            BL       s:14440,PREL

  14439   1 000A14  DCC7 0008                            LDB,B5   TEMP$,AUTO
          1 000A16  DFC6 0008                            STB,B5   8,B6

      665    14440    3         IF TEMP$=ADDR(NIL) OR STRUCTURE=0 THEN EXIT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:146  

  14440   1 000A18  8DC7 0008                            CMN      TEMP$,AUTO
          1 000A1A  0901 000B                            BE       s:14440,PREL
          1 000A1C  5901 0009                            BEZ,R5   s:14440,PREL

      666    14441    3         KV$PTR.LINLST$=%KV_MVD.LINLST$;

  14441   1 000A1E  DCC6 0006                            LDB,B5   6,B6
          1 000A20  CCC5 0010                            LDB,B4   16,B5
          1 000A22  CFC6 000E                            STB,B4   14,B6

      667    14442    3      END;

  14442   1 000A24  0F81 F850                            B        s:14035,PREL

  14440   1                              NO_STUFF        null
      668    14443    2   NO_STUFF:;
      669    14444    2      KV$PTR=SAV_PTR;

  14444   1 000A26  AB87                 NO_STUFF        LAB,B2   ,AUTO
          1 000A27  2C60                                 LDV,R2   96
          1 000A28  6C3C                                 LDV,R6   60
          1 000A29  BC80 0000 0000  xsym                 LDB,B3   KV$PTR$
          1 000A2C  3C00                                 LDV,R3   0
          1 000A2D  0008                                 MMM

      670    14445    2      RETURN;

  14445   1 000A2E  ECC7 0028                            LDB,B6   FPT+17,AUTO
          1 000A30  C3C6 0001                            LNJ,B4   1,B6

      671    14446    2   END SETPTR;
      672    14447        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:147  
      673    14448        /*F*  NAME: KVP$GETPRM.
      674    14449              PURPOSE: Returns the value of a parameter, or a group thereof,
      675    14450                       or a list of groups thereof.
      676    14451              DESCRIPTION: Runs the same tables as KVP$SETPRM, but backwards,
      677    14452                           stuffing the parameter values into the FPT or a
      678    14453                           buffer allocated to return them.
      679    14454        */
      680    14455    1   KVP$GETPRM: ENTRY (KV$VDH_XXXPRM);

  14455   1 000A32  D380 0000 0000  xent KVP$GETPRM      LNJ,B5   X6A_AUTO_1
          1 000A35       0052 0001                       DC       82,1

      681    14456        /* We'll put he current PRMID into I, and do this loop until it goes to 0 */
      682    14457    1      I=KV$VDH_GETPRM.PRMID;

  14457   1 000A37  ECC7 0004                            LDB,B6   @KV$VDH_XXXPRM,AUTO
          1 000A39  E846 0001                            LDR,R6   1,B6
          1 000A3B  EF47 0012                            STR,R6   I,AUTO

      683    14458    1      STR$=ADDR(NIL);                      /* No current output buffer           */

  14458   1 000A3D  DB80 0000 0000                       LAB,B5   0
          1 000A40  DFC7 0006                            STB,B5   STR$,AUTO

      684    14459    1      TEMP$=ADDR(NIL);           /* For saving the stream pointer when changed   */

  14459   1 000A42  CB80 0000 0000                       LAB,B4   0
          1 000A45  CFC7 0008                            STB,B4   TEMP$,AUTO

      685    14460    1      STRLST='0'B;

  14460   1 000A47  8747 0015                            CL       MAXBYTX,AUTO

      686    14461    2      DO WHILE I~=0;

  14461   1 000A49  6901 0281                            BEZ,R6   s:14616,PREL

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:148  
      687    14462        /*N*  CALL INDEX (I,BINASC(I),KV_PRMTBL.IDS) ALTRET(SCREECH); PL6 BUG */
      688    14463    2         TEMP=BINASC (I);

  14463   1 000A4B  E847 0012                            LDR,R6   I,AUTO
          1 000A4D  6008                                 SOL,R6   8
          1 000A4E  6068                                 SAR,R6   8
          1 000A4F  E7C7 0016                            STH,R6   TEMP,AUTO

      689    14464    2         CALL INDEX (I,TEMP,KV_PRMTBL.IDS) ALTRET(SCREECH); /* END OF *N*/

  14464   1 000A51  EB80 0000 0000  00                   LAB,B6   KV_PRMTBL
          1 000A54  E870 0196                            LDR,R6   406,IMO
          1 000A56  0028                                 SRH      ;
          1 000A57       4107 0016                                ALPHANUM(TEMP,AUTO,,1),;
          1 000A59       4407 0050                                BINARY(OLDVAL+2,AUTO,,4),;
          1 000A5B       4006 0000                                ALPHANUM(0,B6,,R6)
          1 000A5D  5381 0007                            CBE      s:14464+20,PREL
          1 000A5F  D870 0096                            LDR,R5   150,IMO
          1 000A61  DF47 0012                            STR,R5   I,AUTO
          1 000A63  0F81 0570                            B        s:14926,PREL
          1 000A65  D847 0051                            LDR,R5   OLDVAL+3,AUTO
          1 000A67  DF47 0012                            STR,R5   I,AUTO

      690    14465    2         IF KV_PRMTBL.TYPE(I)~=%PRM_TYPE_STRUCT

  14465   1 000A69  B855                                 LDR,R3   R5
          1 000A6A  C2B0 0000 004B  00                   LLH,R4   KV_PRMTBL+75,R3
          1 000A6D  4D07                                 CMV,R4   7
          1 000A6E  0901 0047                            BE       s:14488,PREL
          1 000A70  4D08                                 CMV,R4   8
          1 000A71  0901 0044                            BE       s:14488,PREL

      691    14466    3           AND KV_PRMTBL.TYPE(I)~=%PRM_TYPE_STRLST THEN DO;

      692    14467        /* We have an elementary parameter request */
      693    14468
      694    14469    3            VDH_SETPRM.PRMID=ASCBIN(SUBSTR(KV_PRMTBL.IDS,I,1));
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:149  

  14469   1 000A73  A2B0 0000 0000  00                   LLH,R2   KV_PRMTBL,R3
          1 000A76  AF47 000B                            STR,R2   VDH_SETPRM+1,AUTO

      695    14470    3            CALL GETPRM;

  14470   1 000A78  E3C0 0260                            LNJ,B6   s:0,PREL
          1 000A7A       0001                            DC       s:14471,PREL

      696    14471    3            IF VDH_SETPRM.VAL_.BYTSIZ~=0

  14471   1 000A7B  E847 0010                            LDR,R6   VDH_SETPRM+6,AUTO
          1 000A7D  6901 002B                            BEZ,R6   s:14483,PREL

      697    14472    3            THEN IF KV$VDH_GETPRM.VAL_.ADR$=ADDR(NIL) AND NOT STRLST

  14472   1 000A7F  ECC7 0004                            LDB,B6   @KV$VDH_XXXPRM,AUTO
          1 000A81  8DC6 0003                            CMN      3,B6
          1 000A83  0981 000D                            BNE      s:14475,PREL
          1 000A85  D847 0015                            LDR,R5   MAXBYTX,AUTO
          1 000A87  5981 0009                            BNEZ,R5  s:14475,PREL

      698    14473    3            THEN KV$VDH_GETPRM.VAL_=VDH_SETPRM.VAL_;

  14473   1 000A89  AB87                                 LAB,B2   ,AUTO
          1 000A8A  2C1A                                 LDV,R2   26
          1 000A8B  6C08                                 LDV,R6   8
          1 000A8C  BB86                                 LAB,B3   ,B6
          1 000A8D  3C06                                 LDV,R3   6
          1 000A8E  0008                                 MMM
          1 000A8F  0F81 0019                            B        s:14483,PREL

      699    14474    4            ELSE DO;

      700    14475    4               OFFSET=VDH_SETPRM.VAL_.BYTSIZ;

  14475   1 000A91  EF47 0014                            STR,R6   OFFSET,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:150  

      701    14476    5               CALL GETSPACE WHENALTRETURN DO;

  14476   1 000A93  E3C0 0407                            LNJ,B6   s:0,PREL
          1 000A95       0003                            DC       s:14477,PREL
          1 000A96  0F81 0008                            B        s:14480,PREL

      702    14477    5                  KV$VDH_GETPRM.BFRLMTEXC='1'B;

  14477   1 000A98  ECC7 0004                            LDB,B6   @KV$VDH_XXXPRM,AUTO
          1 000A9A  8906                                 LBT,'0080'X       ,B6
          1 000A9B       0080

      703    14478    5                  RETURN;

  14478   1 000A9C  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      704    14479    5               END;
      705    14480    4               SUBSTR(STR$->CHARS,0,OFFSET)=SUBSTR(VDH_SETPRM.VAL_.ADR$->CHARS,

  14480   1 000A9F  ACC7 000D                            LDB,B2   VDH_SETPRM+3,AUTO
          1 000AA1  A847 000F                            LDR,R2   VDH_SETPRM+5,AUTO
          1 000AA3  E847 0014                            LDR,R6   OFFSET,AUTO
          1 000AA5  BCC7 0006                            LDB,B3   STR$,AUTO
          1 000AA7  3C00                                 LDV,R3   0
          1 000AA8  0008                                 MMM

      706    14481    4                 VDH_SETPRM.VAL_.BYTX,OFFSET);
      707    14482    4            END;

      708    14483    3            IF STRLST THEN GOTO NXTMLT;

  14483   1 000AA9  E847 0015                            LDR,R6   MAXBYTX,AUTO
          1 000AAB  6981 0201                            BNEZ,R6  s:14610,PREL

      709    14484    3            KV$VDH_GETPRM.VAL=VDH_SETPRM.VAL;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:151  
  14484   1 000AAD  ECC7 0004                            LDB,B6   @KV$VDH_XXXPRM,AUTO
          1 000AAF  D847 000C                            LDR,R5   VDH_SETPRM+2,AUTO
          1 000AB1  DF46 0002                            STR,R5   2,B6

      710    14485    3            RETURN;

  14485   1 000AB3  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      711    14486    3         END;
      712    14487        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:152  
      713    14488    3         IF KV_PRMTBL.TYPE(I)=%PRM_TYPE_STRUCT THEN DO;

  14488   1 000AB6  4D07                                 CMV,R4   7
          1 000AB7  0981 01E6                            BNE      s:14605,PREL

      714    14489        /* A simple structure, build it from its parts. */
      715    14490
      716    14491    3            J=KV_PRMTBL.INDX(I);

  14491   1 000AB9  A2B0 0000 0096  00                   LLH,R2   KV_PRMTBL+150,R3
          1 000ABC  AF47 0013                            STR,R2   J,AUTO

      717    14492    3            IF KV_STRID(J)=%KV_PRMID_DMN

  14492   1 000ABE  92A0 0000 026E  00                   LLH,R1   KV_STRIDS,R2
          1 000AC1  1D3E                                 CMV,R1   62
          1 000AC2  0981 0041                            BNE      s:14511,PREL
          1 000AC4  E847 0015                            LDR,R6   MAXBYTX,AUTO
          1 000AC6  6901 003D                            BEZ,R6   s:14511,PREL

      718    14493        /* Run through all the streams if this is a STRLST */
      719    14494
      720    14495    4              AND STRLST THEN DO;

      721    14496    5               IF TEMP$=ADDR(NIL) THEN DO;

  14496   1 000AC8  8DC7 0008                            CMN      TEMP$,AUTO
          1 000ACA  0981 0010                            BNE      s:14501,PREL

      722    14497    5                  TEMP$=KV$PTR.STR$;

  14497   1 000ACC  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000ACF  DCC6 0004                            LDB,B5   4,B6
          1 000AD1  DFC7 0008                            STB,B5   TEMP$,AUTO

      723    14498    5                  KV$PTR.STR$=%KV_SSN.STR$;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:153  
  14498   1 000AD3  CCC6 0002                            LDB,B4   2,B6
          1 000AD5  BCC4 0004                            LDB,B3   4,B4
          1 000AD7  BFC6 0004                            STB,B3   4,B6

      724    14499    5               END;

  14499   1 000AD9  0F81 001B                            B        s:14508,PREL

      725    14500    5               ELSE DO;

      726    14501    5                  IF %KV_STR.LNK$~=ADDR(NIL) THEN KV$PTR.STR$=%KV_STR.LNK$;

  14501   1 000ADB  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000ADE  DCC6 0004                            LDB,B5   4,B6
          1 000AE0  8DC5 0002                            CMN      2,B5
          1 000AE2  0901 0007                            BE       s:14503,PREL

  14501   1 000AE4  CCC5 0002                            LDB,B4   2,B5
          1 000AE6  CFC6 0004                            STB,B4   4,B6
          1 000AE8  0F81 000C                            B        s:14508,PREL

      727    14502    6                  ELSE DO;

      728    14503    6                     KV$PTR.STR$=TEMP$;

  14503   1 000AEA  CCC7 0008                            LDB,B4   TEMP$,AUTO
          1 000AEC  CFC6 0004                            STB,B4   4,B6

      729    14504    6                     TEMP$=ADDR(NIL);

  14504   1 000AEE  DB80 0000 0000                       LAB,B5   0
          1 000AF1  DFC7 0008                            STB,B5   TEMP$,AUTO

      730    14505    6                     GOTO NXTMLT;

  14505   1 000AF3  0F81 01B9                            B        s:14610,PREL

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:154  
      731    14506    6                  END;
      732    14507    5               END;
      733    14508    4               IF KV_STRID(STRLST.INDX)=%KV_PRMID_SINPUT

  14508   1 000AF5  B2C7 0015                            LLH,R3   MAXBYTX,AUTO
          1 000AF7  C2B0 0000 026E  00                   LLH,R4   KV_STRIDS,R3
          1 000AFA  4D0B                                 CMV,R4   11
          1 000AFB  0981 0008                            BNE      s:14511,PREL
          1 000AFD  DCC6 0004                            LDB,B5   4,B6
          1 000AFF  82C5 001C                            LB,'0040'X        28,B5
          1 000B01       0040
          1 000B02  0581 01AA                            BBF      s:14610,PREL

      734    14509    4                 AND NOT %KV_STR.RE_RED THEN GOTO NXTMLT;
      735    14510    4            END;

      736    14511    3            OFFSET=KV_STR.OFFSET(J-1);     /* Get the size of the structure      */

  14511   1 000B04  E820 0000 01BC  00                   LDR,R6   KV_BFRTYPS+6,R2
          1 000B07  E570 0FFF                            AND,R6   4095,IMO
          1 000B09  EF47 0014                            STR,R6   OFFSET,AUTO

      737    14512    4            CALL GETSPACE WHENALTRETURN DO;

  14512   1 000B0B  E3C0 038F                            LNJ,B6   s:0,PREL
          1 000B0D       0003                            DC       s:14513,PREL
          1 000B0E  0F81 0013                            B        s:14517,PREL

      738    14513    4               IF TEMP$~=ADDR(NIL) THEN KV$PTR.STR$=TEMP$;

  14513   1 000B10  8DC7 0008                            CMN      TEMP$,AUTO
          1 000B12  0901 0008                            BE       s:14514,PREL

  14513   1 000B14  ECC7 0008                            LDB,B6   TEMP$,AUTO
          1 000B16  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000B19  EFC5 0004                            STB,B6   4,B5

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:155  
      739    14514    4               KV$VDH_GETPRM.BFRLMTEXC='1'B;

  14514   1 000B1B  ECC7 0004                            LDB,B6   @KV$VDH_XXXPRM,AUTO
          1 000B1D  8906                                 LBT,'0080'X       ,B6
          1 000B1E       0080

      740    14515    4               RETURN;

  14515   1 000B1F  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      741    14516    4            END;
      742    14517    4   GET_LOOP:DO WHILE '1'B;

  14517   1                              GET_LOOP        null
      743    14518    4               VDH_SETPRM.PRMID=KV_STRID(J);

  14518   1 000B22  B847 0013            GET_LOOP        LDR,R3   J,AUTO
          1 000B24  E2B0 0000 026E  00                   LLH,R6   KV_STRIDS,R3
          1 000B27  EF47 000B                            STR,R6   VDH_SETPRM+1,AUTO

      744    14519    4               IF VDH_SETPRM.PRMID=0 THEN EXIT;

  14519   1 000B29  6901 0172                            BEZ,R6   s:14604,PREL

      745    14520    4               IF KV_STR.TYPE(J)=%PRM_STR_TYPE_EXTBIT

  14520   1 000B2B  D830 0000 01BD  00                   LDR,R5   KV_STRS,R3
          1 000B2E  504C                                 SOR,R5   12
          1 000B2F  5D08                                 CMV,R5   8
          1 000B30  0981 0019                            BNE      s:14530,PREL

      746    14521        /* Get the real data. Split it up in the store. */
      747    14522
      748    14523    5               THEN DO;

      749    14524    5                  VDH_SETPRM.PRMID=KV_STRID(J+1);

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:156  
  14524   1 000B32  3E01                                 ADV,R3   1
          1 000B33  E2B0 0000 026E  00                   LLH,R6   KV_STRIDS,R3
          1 000B36  EF47 000B                            STR,R6   VDH_SETPRM+1,AUTO

      750    14525    6                  IF KV_STRID(J)=%KV_PRMID_STRDON THEN DO;

  14525   1 000B38  A847 0013                            LDR,R2   J,AUTO
          1 000B3A  D2A0 0000 026E  00                   LLH,R5   KV_STRIDS,R2
          1 000B3D  5D3D                                 CMV,R5   61
          1 000B3E  0981 000B                            BNE      s:14530,PREL

      751    14526    6                     BI.T(KV_STR.OFFSET(J))='1'B;

  14526   1 000B40  9820 0000 01BD  00                   LDR,R1   KV_STRS,R2
          1 000B43  9570 0FFF                            AND,R1   4095,IMO
          1 000B45  ECC7 0006                            LDB,B6   STR$,AUTO
          1 000B47  8916                                 LBT      ,B6,R1

      752    14527    6                     J=J+1;

  14527   1 000B48  8AC7 0013                            INC      J,AUTO

      753    14528    6                  END;

      754    14529    5               END;

      755    14530    5               IF STRLST.SKPCNT>0 AND VDH_SETPRM.PRMID~=%KV_PRMID_DMN THEN DO;

  14530   1 000B4A  82C7 0015                            LB,'00FF'X        MAXBYTX,AUTO
  14530   1 000B4C       00FF
          1 000B4D  0581 002F                            BBF      s:14544,PREL
          1 000B4F  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 000B51  6D3E                                 CMV,R6   62
          1 000B52  0901 002A                            BE       s:14544,PREL

      756    14531        /* We're still skipping items. */
      757    14532
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:157  
      758    14533    5                  STRLST.SKPCNT=STRLST.SKPCNT-1;

  14533   1 000B54  D847 0015                            LDR,R5   MAXBYTX,AUTO
          1 000B56  DA70 00FF                            ADD,R5   255,IMO
          1 000B58  DAC7 0015                            SRM,R5,'00FF'X    MAXBYTX,AUTO
          1 000B5A       00FF

      759    14534    6                  DO SELECT(KV_STR.TYPE(J));

  14534   1 000B5B  B847 0013                            LDR,R3   J,AUTO
          1 000B5D  D830 0000 01BD  00                   LDR,R5   KV_STRS,R3
          1 000B60  504C                                 SOR,R5   12
          1 000B61  D970 0001                            CMR,R5   1,IMO
          1 000B63  0201 0013                            BL       s:14540,PREL
          1 000B65  0901 0006                            BE       s:14536,PREL
          1 000B67  5D0A                                 CMV,R5   10
          1 000B68  0981 000E                            BNE      s:14540,PREL
          1 000B6A  0F81 0006                            B        s:14538,PREL

      760    14535    6                     SELECT (%PRM_STR_TYPE_BITCND);

      761    14536    6                     VDH_SETPRM.VAL=2;

  14536   1 000B6C  4C02                                 LDV,R4   2
          1 000B6D  CF47 000C                            STR,R4   VDH_SETPRM+2,AUTO
          1 000B6F  0F81 0010                            B        s:14547,PREL

      762    14537    6                     SELECT (%PRM_STR_TYPE_BYTCND);

      763    14538    6                     VDH_SETPRM.VAL=511;

  14538   1 000B71  C870 01FF                            LDR,R4   511,IMO
          1 000B73  CF47 000C                            STR,R4   VDH_SETPRM+2,AUTO
          1 000B75  0F81 000A                            B        s:14547,PREL

      764    14539    6                     SELECT (ELSE);

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:158  
      765    14540    6                  VDH_SETPRM.VAL=0;

  14540   1 000B77  8747 000C                            CL       VDH_SETPRM+2,AUTO

      766    14541    6                  VDH_SETPRM.VAL_.BYTSIZ=0;

  14541   1 000B79  8747 0010                            CL       VDH_SETPRM+6,AUTO

      767    14542    6                  END;

      768    14543    5               END;

  14543   1 000B7B  0F81 0004                            B        s:14547,PREL

      769    14544    4               ELSE CALL GETPRM;

  14544   1 000B7D  E3C0 015B                            LNJ,B6   s:0,PREL
          1 000B7F       0001                            DC       s:14547,PREL

      770    14545        /* Got the value, now put it somewhere */
      771    14546
      772    14547    4               IF BI.T(KV_STR.OFFSET(J)) THEN OFFSET=0; /* DUMMY TO LOAD REGS    */

  14547   1 000B80  B847 0013                            LDR,R3   J,AUTO
          1 000B82  A830 0000 01BD  00                   LDR,R2   KV_STRS,R3
          1 000B85  A570 0FFF                            AND,R2   4095,IMO
          1 000B87  ECC7 0006                            LDB,B6   STR$,AUTO
          1 000B89  82A6                                 LB       ,B6,R2
          1 000B8A  0581 0003                            BBF      s:14548,PREL

  14547   1 000B8C  8747 0014                            CL       OFFSET,AUTO

      773    14548    4               OFFSET=KV_STR.OFFSET(J);

  14548   1 000B8E  AF47 0014                            STR,R2   OFFSET,AUTO

      774    14549    5               DO CASE (KV_STR.TYPE(J));
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:159  

  14549   1 000B90  9830 0000 01BD  00                   LDR,R1   KV_STRS,R3
          1 000B93  104C                                 SOR,R1   12
          1 000B94  1D0D                                 CMV,R1   13
          1 000B95  0281 00D2                            BGE      s:14592,PREL
          1 000B97  B810 0000 0B9D  01                   LDR,R3   s:14549+13,R1
          1 000B9A  83B0 0000 0BAA  01                   JMP      s:14551,R3
          1 000B9D       000D                            DC       s:14554,PREL
          1 000B9E       0000                            DC       s:14551,PREL
          1 000B9F       00BE                            DC       s:14592,PREL
          1 000BA0       00BE                            DC       s:14592,PREL
          1 000BA1       00BE                            DC       s:14592,PREL
          1 000BA2       00BE                            DC       s:14592,PREL
          1 000BA3       00BE                            DC       s:14592,PREL
          1 000BA4       00BE                            DC       s:14592,PREL
          1 000BA5       001C                            DC       s:14558,PREL
          1 000BA6       003B                            DC       s:14566,PREL
          1 000BA7       003B                            DC       s:14566,PREL
          1 000BA8       00B2                            DC       s:14588,PREL
          1 000BA9       0040                            DC       s:14569,PREL

      775    14550    5               CASE(%PRM_STR_TYPE_BITCND);

      776    14551    5                  IF VDH_SETPRM.VAL=2 THEN BI.T(OFFSET+1)='1'B;

  14551   1 000BAA  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000BAC  6D02                                 CMV,R6   2
          1 000BAD  0981 0005                            BNE      s:14552,PREL

  14551   1 000BAF  2E01                                 ADV,R2   1
          1 000BB0  8926                                 LBT      ,B6,R2
          1 000BB1  0F81 0003                            B        s:14553,PREL

      777    14552    5                  ELSE BI.T(OFFSET+1)='0'B;

  14552   1 000BB3  2E01                                 ADV,R2   1
          1 000BB4  8826                                 LBF      ,B6,R2
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:160  

      778    14553    5                  GOTO GET_BIT;

  14553   1 000BB5  0F81 0001                            B        s:14554,PREL

      779    14554    5               CASE(%PRM_STR_TYPE_BIT);

      780    14555    5   GET_BIT:       IF VDH_SETPRM.VAL=1 THEN BI.T(OFFSET)='1'B;

  14555   1 000BB7  E847 000C            GET_BIT         LDR,R6   VDH_SETPRM+2,AUTO
          1 000BB9  6D01                                 CMV,R6   1
          1 000BBA  0981 0006                            BNE      s:14556,PREL

  14555   1 000BBC  B847 0014                            LDR,R3   OFFSET,AUTO
          1 000BBE  8936                                 LBT      ,B6,R3
          1 000BBF  0F81 00D8                            B        s:14602,PREL

      781    14556    5                  ELSE BI.T(OFFSET)='0'B;

  14556   1 000BC1  B847 0014                            LDR,R3   OFFSET,AUTO
          1 000BC3  8836                                 LBF      ,B6,R3
          1 000BC4  0F81 00D3                            B        s:14602,PREL

      782    14557    5               CASE(%PRM_STR_TYPE_EXTBIT);

      783    14558    6                  IF VDH_SETPRM.VAL>254 AND VDH_SETPRM.VAL<511 THEN DO;

  14558   1 000BC6  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000BC8  E970 00FE                            CMR,R6   254,IMO
          1 000BCA  0381 000C                            BLE      s:14562,PREL
          1 000BCC  E970 01FF                            CMR,R6   511,IMO
          1 000BCE  0281 0008                            BGE      s:14562,PREL

      784    14559    6                     VDH_SETPRM.VAL=VDH_SETPRM.VAL-254;

  14559   1 000BD0  EA70 FF02                            ADD,R6   -254,IMO
          1 000BD2  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:161  

      785    14560    6                     BI.T(OFFSET)='1'B;

  14560   1 000BD4  8926                                 LBT      ,B6,R2

      786    14561    6                  END;

  14561   1 000BD5  0F81 0002                            B        s:14563,PREL

      787    14562    5                  ELSE BI.T(OFFSET)='0'B;

  14562   1 000BD7  8826                                 LBF      ,B6,R2

      788    14563    5                  J=J+1;

  14563   1 000BD8  8AC7 0013                            INC      J,AUTO

      789    14564    5                  OFFSET=KV_STR.OFFSET(J);

  14564   1 000BDA  B847 0013                            LDR,R3   J,AUTO
          1 000BDC  A830 0000 01BD  00                   LDR,R2   KV_STRS,R3
          1 000BDF  A570 0FFF                            AND,R2   4095,IMO
          1 000BE1  AF47 0014                            STR,R2   OFFSET,AUTO

      790    14565    5                  GOTO GET_BYT;

  14565   1 000BE3  0F81 0001                            B        s:14566,PREL

      791    14566    5               CASE(%PRM_STR_TYPE_BYT, %PRM_STR_TYPE_BYTCND);

      792    14567    5   GET_BYT:       BYT.E(OFFSET)=VDH_SETPRM.VAL;

  14567   1 000BE5  E847 000C            GET_BYT         LDR,R6   VDH_SETPRM+2,AUTO
          1 000BE7  E7A6                                 STH,R6   ,B6,R2
          1 000BE8  0F81 00AF                            B        s:14602,PREL

      793    14568    5               CASE(%PRM_STR_TYPE_OTHER);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:162  

      794    14569    6                  DO SELECT VDH_SETPRM.PRMID;

  14569   1 000BEA  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 000BEC  E970 0013                            CMR,R6   19,IMO
          1 000BEE  0201 0009                            BL       s:14569+14,PREL
          1 000BF0  0901 001C                            BE       s:14573,PREL
          1 000BF2  E970 0098                            CMR,R6   152,IMO
          1 000BF4  0981 0013                            BNE      s:14571,PREL
          1 000BF6  0F81 0033                            B        s:14576,PREL
          1 000BF8  E970 000C                            CMR,R6   12,IMO
          1 000BFA  0201 0008                            BL       s:14569+25,PREL
          1 000BFC  0901 002F                            BE       s:14579,PREL
          1 000BFE  6D10                                 CMV,R6   16
          1 000BFF  0981 0008                            BNE      s:14571,PREL
          1 000C01  0F81 0036                            B        s:14582,PREL
          1 000C03  6D0B                                 CMV,R6   11
          1 000C04  0981 0003                            BNE      s:14571,PREL
          1 000C06  0F81 0023                            B        s:14576,PREL

      795    14570    6                     SELECT ELSE;

      796    14571    6                  WOR.D(OFFSET)=VDH_SETPRM.VAL;

  14571   1 000C08  D847 000C                            LDR,R5   VDH_SETPRM+2,AUTO
          1 000C0A  DF26                                 STR,R5   ,B6,R2
          1 000C0B  0F81 008C                            B        s:14602,PREL

      797    14572    6                  SELECT %KV_PRMID_LINES;

      798    14573    6                  IF %KV_MVD.PAGNMB=0 OR %KV_MVD.LNG<12 THEN EXIT;

  14573   1 000C0D  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000C10  CCC5 0006                            LDB,B4   6,B5
          1 000C12  D844 001E                            LDR,R5   30,B4
          1 000C14  5901 0045                            BEZ,R5   s:14586,PREL
          1 000C16  C2C4 0014                            LLH,R4   20,B4
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:163  
          1 000C18  4D0C                                 CMV,R4   12
          1 000C19  0201 0040                            BL       s:14586,PREL

      799    14574    6                  WOR.D(0)=%KV_MVD.LNG-%KV_MVD.FRMLIN;

  14574   1 000C1B  B2C4 001D                            LLH,R3   29,B4
          1 000C1D  C253                                 SUB,R4   R3
          1 000C1E  CF06                                 STR,R4   ,B6

      800    14575    6                  WOR.D(1)=%KV_MVD.PAGNMB;

  14575   1 000C1F  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000C22  CCC5 0006                            LDB,B4   6,B5
          1 000C24  E844 001E                            LDR,R6   30,B4
          1 000C26  EF46 0001                            STR,R6   1,B6
          1 000C28  0F81 006F                            B        s:14602,PREL

      801    14576    6                  SELECT %KV_PRMID_SINPUT, /* Dummies so we don't trash WOR.D(0) */

  14576   1 000C2A  0F81 006D                            B        s:14602,PREL

      802    14577    6                    %KV_PRMID_SRDOPT;
      803    14578    6                  SELECT %KV_PRMID_EDTCTL;

      804    14579    6                  IF %KV_MVD.ORG~=%KV#VD_ORG_SE THEN EXIT GET_LOOP;

  14579   1 000C2C  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000C2F  CCC5 0006                            LDB,B4   6,B5
          1 000C31  D2C4 0015                            LLH,R5   21,B4
          1 000C33  5D05                                 CMV,R5   5
          1 000C34  0981 0067                            BNE      s:14604,PREL
          1 000C36  0F81 0061                            B        s:14602,PREL

      805    14580    6                  SELECT %KV_PRMID_WINDOW;

      806    14581        /* Do the things that require calculation. */
      807    14582    6                  WINDOW.LENGTH=%KV_SRD.SRDEND.LIN-%KV_SRD.ORG.LIN;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:164  

  14582   1 000C38  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000C3B  CCC5 000A                            LDB,B4   10,B5
          1 000C3D  D844 001A                            LDR,R5   26,B4
          1 000C3F  D244 0007                            SUB,R5   7,B4
          1 000C41  DF46 0002                            STR,R5   2,B6

      808    14583    6                  WINDOW.WIDTH=%KV_SRD.SRDEND.CLM-%KV_SRD.ORG.CLM;

  14583   1 000C43  CCC5 000A                            LDB,B4   10,B5
          1 000C45  E844 001B                            LDR,R6   27,B4
          1 000C47  E244 0008                            SUB,R6   8,B4
          1 000C49  EF46 0003                            STR,R6   3,B6

      809    14584    6                  WINDOW.ORG_PST.LINE=%KV_SRD.ORG.LIN+1;

  14584   1 000C4B  CCC5 000A                            LDB,B4   10,B5
          1 000C4D  C844 0007                            LDR,R4   7,B4
          1 000C4F  4E01                                 ADV,R4   1
          1 000C50  CAC6 0004                            SRM,R4,'00FF'X    4,B6
          1 000C52       00FF

      810    14585    6                  WINDOW.ORG_PST.COLUMN=%KV_SRD.ORG.CLM+1;

  14585   1 000C53  CCC5 000A                            LDB,B4   10,B5
          1 000C55  C844 0008                            LDR,R4   8,B4
          1 000C57  4E01                                 ADV,R4   1
          1 000C58  CF46 0005                            STR,R4   5,B6

      811    14586    6                  END;

  14586   1 000C5A  0F81 003D                            B        s:14602,PREL

      812    14587    5               CASE(%PRM_STR_TYPE_BFR);

      813    14588    5                  SUBSTR(STR$->CHARS,OFFSET,VDH_SETPRM.VAL_.BYTSIZ)=

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:165  
  14588   1 000C5C  ACC7 000D                            LDB,B2   VDH_SETPRM+3,AUTO
          1 000C5E  A847 000F                            LDR,R2   VDH_SETPRM+5,AUTO
          1 000C60  E847 0010                            LDR,R6   VDH_SETPRM+6,AUTO
          1 000C62  BB86                                 LAB,B3   ,B6
          1 000C63  B847 0014                            LDR,R3   OFFSET,AUTO
          1 000C65  0008                                 MMM
          1 000C66  0F81 0031                            B        s:14602,PREL

      814    14589    5                    SUBSTR(VDH_SETPRM.VAL_.ADR$->CHARS,
      815    14590    5                    VDH_SETPRM.VAL_.BYTX,VDH_SETPRM.VAL_.BYTSIZ);
      816    14591    5               CASE(ELSE);                 /* Odd length ubin                    */

      817    14592    5                  VDH_SETPRM.VAL=

  14592   1 000C68  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000C6A  6008                                 SOL,R6   8
          1 000C6B  B847 0013                            LDR,R3   J,AUTO
          1 000C6D  9830 0000 01BD  00                   LDR,R1   KV_STRS,R3
          1 000C70  104C                                 SOR,R1   12
          1 000C71  D290 0000 02C7  00                   LLH,R5   MASKS,R1
          1 000C74  5008                                 SOL,R5   8
          1 000C75  D556                                 AND,R5   R6
          1 000C76  5048                                 SOR,R5   8
          1 000C77  DF47 000C                            STR,R5   VDH_SETPRM+2,AUTO

      818    14593    5                    BITBIN(BINBIT(VDH_SETPRM.VAL,8)&MASKS(KV_STR.TYPE(J)));
      819    14594    5                  OFFSET=OFFSET+KV_STR.TYPE(J);

  14594   1 000C79  9A52                                 ADD,R1   R2
          1 000C7A  A851                                 LDR,R2   R1
          1 000C7B  AF47 0014                            STR,R2   OFFSET,AUTO

      820    14595    6                  DO WHILE BINBIT(OFFSET,4);

  14595   1 000C7D  0F81 0008                            B        s:14598,PREL

      821    14596    6                     VDH_SETPRM.VAL=VDH_SETPRM.VAL+VDH_SETPRM.VAL;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:166  

  14596   1 000C7F  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000C81  6001                                 SOL,R6   1
          1 000C82  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO

      822    14597    6                     OFFSET=OFFSET+1;

  14597   1 000C84  8AC7 0014                            INC      OFFSET,AUTO

      823    14598    6                  END;

  14598   1 000C86  E847 0014                            LDR,R6   OFFSET,AUTO
          1 000C88  600C                                 SOL,R6   12
          1 000C89  69F6                                 BNEZ,R6  s:14596,SPREL

      824    14599    5                  OFFSET=OFFSET/16-1;

  14599   1 000C8A  E847 0014                            LDR,R6   OFFSET,AUTO
          1 000C8C  E370 0010                            DIV,R6   16,IMO
          1 000C8E  6EFF                                 ADV,R6   -1
          1 000C8F  EF47 0014                            STR,R6   OFFSET,AUTO

      825    14600    5                  WOR.D(OFFSET)=WOR.D(OFFSET)+VDH_SETPRM.VAL;

  14600   1 000C91  ECC7 0006                            LDB,B6   STR$,AUTO
          1 000C93  B856                                 LDR,R3   R6
          1 000C94  D836                                 LDR,R5   ,B6,R3
          1 000C95  DA47 000C                            ADD,R5   VDH_SETPRM+2,AUTO
          1 000C97  DF36                                 STR,R5   ,B6,R3

      826    14601    5               END;

      827    14602    4               J=J+1;

  14602   1 000C98  8AC7 0013                            INC      J,AUTO

      828    14603    4            END;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:167  

  14603   1 000C9A  0F81 FE87                            B        s:14517,PREL

      829    14604    3         END;

  14604   1 000C9C  0F81 000C                            B        s:14609,PREL

      830    14605    3         ELSE IF KV_PRMTBL.TYPE(I)=%PRM_TYPE_STRLST THEN DO;

  14605   1 000C9E  4D08                                 CMV,R4   8
          1 000C9F  0981 0009                            BNE      s:14609,PREL

      831    14606    3            STRLST.INDX=KV_PRMTBL.INDX(I)-1;

  14606   1 000CA1  A2B0 0000 0096  00                   LLH,R2   KV_PRMTBL+150,R3
          1 000CA4  2EFF                                 ADV,R2   -1
          1 000CA5  A7C7 0015                            STH,R2   MAXBYTX,AUTO

      832    14607    3            GOTO NXTMLT;

  14607   1 000CA7  0F81 0005                            B        s:14610,PREL

      833    14608    3         END;
      834    14609    3         IF STRLST THEN DO;

  14609   1 000CA9  E847 0015                            LDR,R6   MAXBYTX,AUTO
          1 000CAB  6901 0019                            BEZ,R6   s:14614,PREL

      835    14610    3   NXTMLT:  IF TEMP$=ADDR(NIL) THEN STRLST.INDX=STRLST.INDX+1;

  14610   1 000CAD  8DC7 0008            NXTMLT          CMN      TEMP$,AUTO
          1 000CAF  0981 0006                            BNE      s:14611,PREL

  14610   1 000CB1  E2C7 0015                            LLH,R6   MAXBYTX,AUTO
          1 000CB3  6E01                                 ADV,R6   1
          1 000CB4  E7C7 0015                            STH,R6   MAXBYTX,AUTO

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:168  
      836    14611    3            I=KV_STRID(STRLST.INDX);

  14611   1 000CB6  B2C7 0015                            LLH,R3   MAXBYTX,AUTO
          1 000CB8  E2B0 0000 026E  00                   LLH,R6   KV_STRIDS,R3
          1 000CBB  EF47 0012                            STR,R6   I,AUTO

      837    14612    3            STRLST.SKPCNT=KV_STR.OFFSET(STRLST.INDX);

  14612   1 000CBD  D830 0000 01BD  00                   LDR,R5   KV_STRS,R3
          1 000CC0  DAC7 0015                            SRM,R5,'00FF'X    MAXBYTX,AUTO
          1 000CC2       00FF

      838    14613    3         END;

  14613   1 000CC3  0F81 0003                            B        s:14615,PREL

      839    14614    2         ELSE I=0;

  14614   1 000CC5  8747 0012                            CL       I,AUTO

      840    14615    2      END;

  14615   1 000CC7  E847 0012                            LDR,R6   I,AUTO
          1 000CC9  6981 FD81                            BNEZ,R6  s:14463,PREL

      841    14616    1      IF TEMP$~=ADDR(NIL) THEN KV$PTR.STR$=TEMP$;

  14616   1 000CCB  8DC7 0008                            CMN      TEMP$,AUTO
          1 000CCD  0901 0008                            BE       s:14617,PREL

  14616   1 000CCF  ECC7 0008                            LDB,B6   TEMP$,AUTO
          1 000CD1  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000CD4  EFC5 0004                            STB,B6   4,B5

      842    14617    1      RETURN;

  14617   1 000CD6  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:169  

      843    14618        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:170  
      844    14619        /*I* NAME: GETPRM.
      845    14620             PURPOSE: Moves the value (or a vector framing it) to VDH_SETPRM,
      846    14621                      for the elementary parameter VDH_SETPRM.PRMID.
      847    14622        */
      848    14623    1   GETPRM: PROC;

  14623   1 000CD9  EFC7 002E            GETPRM          STB,B6   OFFSET,AUTO

      849    14624    2   DCL KH_NODE# UBIN SYMREF;
      850    14625    2   DCL PRM$ PTR;
      851    14626    2   DCL PRMID UBIN;
      852    14627    2   DCL PRMTYP UBIN;
      853    14628    2   DCL OFFSET SBIN;
      854    14629    2   DCL HEXES CHAR(16) CONSTANT INIT('0123456789ABCDEF');
      855    14630    2   DCL 1 HEXVAL BASED ALIGNED,
      856    14631    2          2 V0 UBIN(4) UNAL,
      857    14632    2          2 V1 UBIN(4) UNAL,
      858    14633    2          2 V2 UBIN(4) UNAL,
      859    14634    2          2 V3 UBIN(4) UNAL;
      860    14635        %EQU VHEX=CHARTEXT('ADDR(VDH_SETPRM.VAL)->HEXVAL');
      861    14636        %KV$BFRDSC;
      862    14663        /* Initialize the answer(s) */
      863    14664
      864    14665    2      VDH_SETPRM.VAL=0;

  14665   1 000CDB  8747 000C                            CL       VDH_SETPRM+2,AUTO

      865    14666    2      VDH_SETPRM.VAL_='0'B;

  14666   1 000CDD  5C08                                 LDV,R5   8
          1 000CDE  0021                                 ALR      ;
          1 000CDF       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 000CE1       4007 000D                                ALPHANUM(VDH_SETPRM+3,AUTO,,R5,FILL)

      866    14667        /* Convert to internal PRMID. */
      867    14668        /*N* PL6 BUg: CALL INDEX (PRMID, BINASC(VDH_SETPRM.PRMID), */
      868    14669    2      TEMP=BINASC(VDH_SETPRM.PRMID);
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:171  

  14669   1 000CE3  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 000CE5  6008                                 SOL,R6   8
          1 000CE6  6068                                 SAR,R6   8
          1 000CE7  437F                                 CSYNC    s:14669+3,SPREL
          1 000CE8  E7C7 0016                            STH,R6   TEMP,AUTO

      869    14670    2      CALL INDEX (PRMID,TEMP,              /* END OF BUG                         */

  14670   1 000CEA  EB80 0000 0000  00                   LAB,B6   KV_PRMTBL
          1 000CED  E870 0196                            LDR,R6   406,IMO
          1 000CEF  0028                                 SRH      ;
          1 000CF0       4107 0016                                ALPHANUM(TEMP,AUTO,,1),;
          1 000CF2       4407 0050                                BINARY(OLDVAL+2,AUTO,,4),;
          1 000CF4       4006 0000                                ALPHANUM(0,B6,,R6)
          1 000CF6  5381 0007                            CBE      s:14670+20,PREL
          1 000CF8  C870 0096                            LDR,R4   150,IMO
          1 000CFA  CF47 0032                            STR,R4   PRMID,AUTO
          1 000CFC  0F81 0007                            B        s:14671,PREL
          1 000CFE  C847 0051                            LDR,R4   OLDVAL+3,AUTO
          1 000D00  CF47 0032                            STR,R4   PRMID,AUTO
          1 000D02  0F81 0005                            B        s:14672,PREL

      870    14671    3        KV_PRMTBL.IDS) WHENALTRETURN DO; RETURN; END;

  14671   1 000D04  ECC7 002E                            LDB,B6   OFFSET,AUTO
          1 000D06  C3C6 0001                            LNJ,B4   1,B6

      871    14672    2      PRMTYP=KV_PRMTBL.TYPE(PRMID);

  14672   1 000D08  B854                                 LDR,R3   R4
          1 000D09  A2B0 0000 004B  00                   LLH,R2   KV_PRMTBL+75,R3
          1 000D0C  AF47 0033                            STR,R2   PRMTYP,AUTO

      872    14673    2      PRMID=KV_PRMTBL.INDX(PRMID)+KV_WHROFFS(PRMTYP);

  14673   1 000D0E  92B0 0000 0096  00                   LLH,R1   KV_PRMTBL+150,R3
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:172  
          1 000D11  9A20 0000 0167  00                   ADD,R1   KV_WHROFFS,R2
          1 000D14  B851                                 LDR,R3   R1
          1 000D15  BF47 0032                            STR,R3   PRMID,AUTO

      873    14674    2      PRM$=PINCRW(ADDR(KV$PTR),KV_PTR_OFFSETS(KV_WHERE.STRUCTURE(PRMID)))->PT.R;

  14674   1 000D17  9830 0000 00E1  00                   LDR,R1   KV_WHERES,R3
          1 000D1A  104C                                 SOR,R1   12
          1 000D1B  B810 0000 02CB  00                   LDR,R3   KV_PTR_OFFSETS,R1
          1 000D1E  AC80 0000 0000  xsym                 LDB,B2   KV$PTR$
          1 000D21  A853                                 LDR,R2   R3
          1 000D22  2001                                 SOL,R2   1
          1 000D23  6C04                                 LDV,R6   4
          1 000D24  BB87                                 LAB,B3   ,AUTO
          1 000D25  3C60                                 LDV,R3   96
          1 000D26  0008                                 MMM

      874    14675    2      IF PRM$=ADDR(NIL) THEN RETURN;

  14675   1 000D27  8DC7 0030                            CMN      PRM$,AUTO
          1 000D29  0981 0005                            BNE      s:14676,PREL

  14675   1 000D2B  ECC7 002E                            LDB,B6   OFFSET,AUTO
          1 000D2D  C3C6 0001                            LNJ,B4   1,B6

      875    14676    2      OFFSET=KV_WHERE.OFFSET(PRMID);

  14676   1 000D2F  B847 0032                            LDR,R3   PRMID,AUTO
          1 000D31  E830 0000 00E1  00                   LDR,R6   KV_WHERES,R3
          1 000D34  E570 0FFF                            AND,R6   4095,IMO
          1 000D36  EF47 0034                            STR,R6   OFFSET,AUTO

      876    14677    3      DO CASE (PRMTYP);

  14677   1 000D38  A847 0033                            LDR,R2   PRMTYP,AUTO
          1 000D3A  2D07                                 CMV,R2   7
          1 000D3B  0281 015B                            BGE      s:14743,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:173  
          1 000D3D  9820 0000 0D43  01                   LDR,R1   s:14677+11,R2
          1 000D40  8390 0000 0D4A  01                   JMP      s:14679,R1
          1 000D43       0071                            DC       s:14705,PREL
          1 000D44       0000                            DC       s:14679,PREL
          1 000D45       000A                            DC       s:14681,PREL
          1 000D46       001A                            DC       s:14685,PREL
          1 000D47       0012                            DC       s:14683,PREL
          1 000D48       002A                            DC       s:14689,PREL
          1 000D49       0061                            DC       s:14702,PREL

      877    14678    3      CASE(%PRM_TYPE_BIT);

      878    14679    3         IF PRM$->BI.T(OFFSET) THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;

  14679   1 000D4A  ECC7 0030                            LDB,B6   PRM$,AUTO
          1 000D4C  B856                                 LDR,R3   R6
          1 000D4D  82B6                                 LB       ,B6,R3
          1 000D4E  0581 0148                            BBF      s:14743,PREL

  14679   1 000D50  8AC7 000C                            INC      VDH_SETPRM+2,AUTO
          1 000D52  0F81 0144                            B        s:14743,PREL

      879    14680    3      CASE(%PRM_TYPE_BYTE);

      880    14681    3         VDH_SETPRM.VAL=PRM$->BYT.E(OFFSET);

  14681   1 000D54  ECC7 0030                            LDB,B6   PRM$,AUTO
          1 000D56  B856                                 LDR,R3   R6
          1 000D57  E2B6                                 LLH,R6   ,B6,R3
          1 000D58  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO
          1 000D5A  0F81 013C                            B        s:14743,PREL

      881    14682    3      CASE(%PRM_TYPE_WORD);

      882    14683    3         VDH_SETPRM.VAL=PRM$->WOR.D(OFFSET);

  14683   1 000D5C  ECC7 0030                            LDB,B6   PRM$,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:174  
          1 000D5E  B856                                 LDR,R3   R6
          1 000D5F  E836                                 LDR,R6   ,B6,R3
          1 000D60  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO
          1 000D62  0F81 0134                            B        s:14743,PREL

      883    14684    3      CASE(%PRM_TYPE_TEXT);

      884    14685    3         VDH_SETPRM.VAL_.ADR$=PRM$;

  14685   1 000D64  ECC7 0030                            LDB,B6   PRM$,AUTO
          1 000D66  EFC7 000D                            STB,B6   VDH_SETPRM+3,AUTO

      885    14686    3         VDH_SETPRM.VAL_.BYTX=OFFSET;

  14686   1 000D68  EF47 000F                            STR,R6   VDH_SETPRM+5,AUTO

      886    14687    3         VDH_SETPRM.VAL_.BYTSIZ=KV_BFRLNG(PRMID-KV_WHROFFS(%PRM_TYPE_TEXT));

  14687   1 000D6A  B200 0000 016A  00                   SUB,R3   KV_WHROFFS+3
          1 000D6D  E2B0 0000 01AF  00                   LLH,R6   KV_BFRLNGS,R3
          1 000D70  EF47 0010                            STR,R6   VDH_SETPRM+6,AUTO
          1 000D72  0F81 0124                            B        s:14743,PREL

      887    14688    3      CASE(%PRM_TYPE_SHRBFR);

      888    14689    3         VDH_SETPRM.VAL_.ADR$=PINCRW(PRM$,OFFSET)->PT.R;

  14689   1 000D74  ACC7 0030                            LDB,B2   PRM$,AUTO
          1 000D76  A856                                 LDR,R2   R6
          1 000D77  2001                                 SOL,R2   1
          1 000D78  6C04                                 LDV,R6   4
          1 000D79  BB87                                 LAB,B3   ,AUTO
          1 000D7A  3C1A                                 LDV,R3   26
          1 000D7B  0008                                 MMM

      889    14690    3         VDH_SETPRM.VAL_.BYTX=SIZEC(KV$SHRBFR);

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:175  
  14690   1 000D7C  DF47 000F                            STR,R5   VDH_SETPRM+5,AUTO

      890    14691    3         IF VDH_SETPRM.PRMID=%KV_PRMID_FCNTBL

  14691   1 000D7E  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 000D80  6D7D                                 CMV,R6   125
          1 000D81  0901 0004                            BE       s:14693,PREL
          1 000D83  6D7C                                 CMV,R6   124
          1 000D84  0981 0005                            BNE      s:14694,PREL

      891    14692    3           OR VDH_SETPRM.PRMID=%KV_PRMID_CHARSETNAME
      892    14693    3         THEN VDH_SETPRM.VAL_.BYTSIZ=8;

  14693   1 000D86  DF47 0010                            STR,R5   VDH_SETPRM+6,AUTO
          1 000D88  0F81 010E                            B        s:14743,PREL

      893    14694    4         ELSE IF VDH_SETPRM.PRMID=%KV_PRMID_EDTBFR THEN DO;

  14694   1 000D8A  E970 0083                            CMR,R6   131,IMO
          1 000D8C  0981 0011                            BNE      s:14698,PREL

      894    14695    4            VDH_SETPRM.VAL_.BYTX=PINCRW(PRM$,OFFSET)->KV$BFRDSC.BYTX;

  14695   1 000D8E  ECC7 0030                            LDB,B6   PRM$,AUTO
          1 000D90  B847 0034                            LDR,R3   OFFSET,AUTO
          1 000D92  3E02                                 ADV,R3   2
          1 000D93  D836                                 LDR,R5   ,B6,R3
          1 000D94  DF47 000F                            STR,R5   VDH_SETPRM+5,AUTO

      895    14696    4            VDH_SETPRM.VAL_.BYTSIZ=PINCRW(PRM$,OFFSET)->KV$BFRDSC.DATBYTSIZ;

  14696   1 000D96  A847 0034                            LDR,R2   OFFSET,AUTO
          1 000D98  2E03                                 ADV,R2   3
          1 000D99  9826                                 LDR,R1   ,B6,R2
          1 000D9A  9F47 0010                            STR,R1   VDH_SETPRM+6,AUTO

      896    14697    4         END;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:176  

  14697   1 000D9C  0F81 00FA                            B        s:14743,PREL

      897    14698    3         ELSE IF VDH_SETPRM.VAL_.ADR$~=ADDR(NIL)

  14698   1 000D9E  8DC7 000D                            CMN      VDH_SETPRM+3,AUTO
          1 000DA0  0901 00F6                            BE       s:14743,PREL

      898    14699    3         THEN VDH_SETPRM.VAL_.BYTSIZ=

  14699   1 000DA2  ECC7 000D                            LDB,B6   VDH_SETPRM+3,AUTO
          1 000DA4  B846 0002                            LDR,R3   2,B6
          1 000DA6  3EF8                                 ADV,R3   -8
          1 000DA7  BF47 0010                            STR,R3   VDH_SETPRM+6,AUTO
          1 000DA9  0F81 00ED                            B        s:14743,PREL

      899    14700    3           VDH_SETPRM.VAL_.ADR$->KV$SHRBFR.BYTSIZ-SIZEC(KV$SHRBFR);
      900    14701    3      CASE(%PRM_TYPE_USRPRM);

      901    14702    3         VDH_SETPRM.FNC=%KV_USR_FNC_GETPRM;

  14702   1 000DAB  D7C7 000A                            STH,R5   VDH_SETPRM,AUTO

      902    14703    3         CALL KVV$CALUSR (VDH_SETPRM);

  14703   1 000DAD  EBC7 000A                            LAB,B6   VDH_SETPRM,AUTO
          1 000DAF  EFC7 0050                            STB,B6   OLDVAL+2,AUTO
          1 000DB1  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
          1 000DB3  CBF0 0100                            LAB,B4   256,IMO
          1 000DB5  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR
          1 000DB8       0001                            DC       s:14703+12,PREL
          1 000DB9  0F81 00DD                            B        s:14743,PREL

      903    14704    3      CASE(%PRM_TYPE_OTHER);

      904    14705    4         DO SELECT (VDH_SETPRM.PRMID);

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:177  
  14705   1 000DBB  E847 000B                            LDR,R6   VDH_SETPRM+1,AUTO
          1 000DBD  E970 0071                            CMR,R6   113,IMO
          1 000DBF  0201 000F                            BL       s:14705+20,PREL
          1 000DC1  0901 0023                            BE       s:14707,PREL
          1 000DC3  E970 0084                            CMR,R6   132,IMO
          1 000DC5  0201 00D1                            BL       s:14743,PREL
          1 000DC7  0901 0055                            BE       s:14717,PREL
          1 000DC9  E970 0086                            CMR,R6   134,IMO
          1 000DCB  0981 00CB                            BNE      s:14743,PREL
          1 000DCD  0F81 0061                            B        s:14721,PREL
          1 000DCF  E970 005E                            CMR,R6   94,IMO
          1 000DD1  0201 000E                            BL       s:14705+37,PREL
          1 000DD3  0901 0028                            BE       s:14712,PREL
          1 000DD5  E970 0062                            CMR,R6   98,IMO
          1 000DD7  0201 00BF                            BL       s:14743,PREL
          1 000DD9  0901 0071                            BE       s:14728,PREL
          1 000DDB  6D63                                 CMV,R6   99
          1 000DDC  0981 00BA                            BNE      s:14743,PREL
          1 000DDE  0F81 007D                            B        s:14733,PREL
          1 000DE0  6D5D                                 CMV,R6   93
          1 000DE1  0981 00B5                            BNE      s:14743,PREL
          1 000DE3  0F81 0025                            B        s:14714,PREL

      905    14706    4            SELECT (%KV_PRMID_APL);

      906    14707    4            IF %KV_MVD.TRNTBL$~=ADDR(NIL)

  14707   1 000DE5  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000DE8  DCC6 0006                            LDB,B5   6,B6
          1 000DEA  8DC5 000E                            CMN      14,B5
          1 000DEC  0901 00AA                            BE       s:14743,PREL

      907    14708    4            THEN IF %KV_MVD.TRNTBL$->KV$TRNTBL.FNTCLS=%KV_FNTCLS_APLB

  14708   1 000DEE  CCC5 000E                            LDB,B4   14,B5
          1 000DF0  E2C4 001D                            LLH,R6   29,B4
          1 000DF2  6D01                                 CMV,R6   1
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:178  
          1 000DF3  0901 0004                            BE       s:14710,PREL
          1 000DF5  6D02                                 CMV,R6   2
          1 000DF6  0981 00A0                            BNE      s:14743,PREL

      908    14709    4              OR %KV_MVD.TRNTBL$->KV$TRNTBL.FNTCLS=%KV_FNTCLS_APLT
      909    14710    4            THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;

  14710   1 000DF8  8AC7 000C                            INC      VDH_SETPRM+2,AUTO
          1 000DFA  0F81 009C                            B        s:14743,PREL

      910    14711    4            SELECT (%KV_PRMID_HARDWIRE);

      911    14712    4            IF %KH_CHN.DRCCNC THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;

  14712   1 000DFC  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000DFF  DC86                                 LDB,B5   ,B6
          1 000E00  CC85                                 LDB,B4   ,B5
          1 000E01  89C4 0007                            CMZ      7,B4
          1 000E03  0881 0093                            BAGE     s:14743,PREL

  14712   1 000E05  8AC7 000C                            INC      VDH_SETPRM+2,AUTO
          1 000E07  0F81 008F                            B        s:14743,PREL

      912    14713    4            SELECT (%KV_PRMID_MULTIDEVICE);

      913    14714    4            IF %KH_CHN.TERMID.LEV>1 OR %KH_CHN.SUB$~=ADDR(NIL)

  14714   1 000E09  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000E0C  DC86                                 LDB,B5   ,B6
          1 000E0D  CC85                                 LDB,B4   ,B5
          1 000E0E  E844 0012                            LDR,R6   18,B4
          1 000E10  E570 00FF                            AND,R6   255,IMO
          1 000E12  6D01                                 CMV,R6   1
          1 000E13  0301 0005                            BG       s:14715,PREL
          1 000E15  8DC4 001A                            CMN      26,B4
          1 000E17  0901 007F                            BE       s:14743,PREL

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:179  
      914    14715    4            THEN VDH_SETPRM.VAL=VDH_SETPRM.VAL+1;

  14715   1 000E19  8AC7 000C                            INC      VDH_SETPRM+2,AUTO
          1 000E1B  0F81 007B                            B        s:14743,PREL

      915    14716    4            SELECT (%KV_PRMID_DEVNUM);

      916    14717    4            IF %KH_CHN.TERMID.LEV<3 THEN GOTO BLANK_4;

  14717   1 000E1D  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000E20  DC86                                 LDB,B5   ,B6
          1 000E21  CC85                                 LDB,B4   ,B5
          1 000E22  E844 0012                            LDR,R6   18,B4
          1 000E24  E570 00FF                            AND,R6   255,IMO
          1 000E26  6D03                                 CMV,R6   3
          1 000E27  0201 0013                            BL       s:14722,PREL

      917    14718    4            VDH_SETPRM.VAL=%KH_CHN.TERMID.TERM.SUBSUBDEVICE;

  14718   1 000E29  E844 0015                            LDR,R6   21,B4
          1 000E2B  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO

      918    14719    4            GOTO DEC_4;

  14719   1 000E2D  0F81 0022                            B        s:14728,PREL

      919    14720    4            SELECT (%KV_PRMID_DEVCTL);

      920    14721    5            IF %KH_CHN.TERMID.LEV<2 THEN DO;

  14721   1 000E2F  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000E32  DC86                                 LDB,B5   ,B6
          1 000E33  CC85                                 LDB,B4   ,B5
          1 000E34  E844 0012                            LDR,R6   18,B4
          1 000E36  E570 00FF                            AND,R6   255,IMO
          1 000E38  6D02                                 CMV,R6   2
          1 000E39  0281 000B                            BGE      s:14725,PREL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:180  

      921    14722    5   BLANK_4:    SUBSTR(%CHRBFR,0,4)='    ';

  14722   1 000E3B  AB80 0000 02EB  00   BLANK_4         LAB,B2   KV_GETPRM+8
          1 000E3E  2C00                                 LDV,R2   0
          1 000E3F  6C04                                 LDV,R6   4
          1 000E40  BB87                                 LAB,B3   ,AUTO
          1 000E41  3C2E                                 LDV,R3   46
          1 000E42  0008                                 MMM

      922    14723    5               GOTO CHAR_4;

  14723   1 000E43  0F81 004C                            B        s:14737,PREL

      923    14724    5            END;
      924    14725    4            VDH_SETPRM.VAL=%KH_CHN.TERMID.TERM.SUBDEVICE;

  14725   1 000E45  E844 0014                            LDR,R6   20,B4
          1 000E47  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO

      925    14726    4            GOTO DEC_4;

  14726   1 000E49  0F81 0006                            B        s:14728,PREL

      926    14727    4            SELECT (%KV_PRMID_NODE);

      927    14728    4            VDH_SETPRM.VAL=KH_NODE#;

  14728   1 000E4B  E800 0000 0000  xsym                 LDR,R6   KH_NODE#
          1 000E4E  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO

  14728   1                              DEC_4           null
      928    14729    4   DEC_4:   ;
      929    14730    4            CALL BINCHAR (SUBSTR(%CHRBFR,0,4), VDH_SETPRM.VAL);

  14730   1 000E50  F856                 DEC_4           LDR,R7   R6
          1 000E51  6C00                                 LDV,R6   0
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:181  
          1 000E52  8D47 0050                            SDI      OLDVAL+2,AUTO
          1 000E54  0027                                 CBD      ;
          1 000E55       0407 0050                                BINARY(OLDVAL+2,AUTO,,4),;
          1 000E57       0407 0017                                UNPACKED(FPT,AUTO,,4,UNSIGNED)

      930    14731    4            GOTO CHAR_4;

  14731   1 000E59  437F                                 CSYNC    s:14728+8,SPREL
          1 000E5A  0F81 0035                            B        s:14737,PREL

      931    14732    4            SELECT (%KV_PRMID_PORT);

      932    14733    4            VDH_SETPRM.VAL=%KH_CHN.TERMID.TERM.CHANNEL;

  14733   1 000E5C  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000E5F  DC86                                 LDB,B5   ,B6
          1 000E60  CC85                                 LDB,B4   ,B5
          1 000E61  E844 0013                            LDR,R6   19,B4
          1 000E63  EF47 000C                            STR,R6   VDH_SETPRM+2,AUTO

      933    14734    4            SUBSTR(%CHRBFR,0,1)=SUBSTR(HEXES,%VHEX.V0,1);

  14734   1 000E65  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000E67  604C                                 SOR,R6   12
          1 000E68  B856                                 LDR,R3   R6
          1 000E69  E0B0 0000 02DB  00                   LDH,R6   HEXES,R3
          1 000E6C  E7C7 0017                            STH,R6   FPT,AUTO

      934    14735    4            SUBSTR(%CHRBFR,1,1)=SUBSTR(HEXES,%VHEX.V1,1);

  14735   1 000E6E  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000E70  6048                                 SOR,R6   8
          1 000E71  E570 000F                            AND,R6   15,IMO
          1 000E73  B856                                 LDR,R3   R6
          1 000E74  E0B0 0000 02DB  00                   LDH,R6   HEXES,R3
          1 000E77  EAC7 0017                            SRM,R6,'00FF'X    FPT,AUTO
          1 000E79       00FF
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:182  

      935    14736    4            SUBSTR(%CHRBFR,2,1)=SUBSTR(HEXES,%VHEX.V2,1);

  14736   1 000E7A  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000E7C  6044                                 SOR,R6   4
          1 000E7D  E570 000F                            AND,R6   15,IMO
          1 000E7F  B856                                 LDR,R3   R6
          1 000E80  E0B0 0000 02DB  00                   LDH,R6   HEXES,R3
          1 000E83  E7C7 0018                            STH,R6   FPT+1,AUTO

      936    14737    4            SUBSTR(%CHRBFR,3,1)=SUBSTR(HEXES,%VHEX.V3,1);

  14737   1 000E85  E847 000C                            LDR,R6   VDH_SETPRM+2,AUTO
          1 000E87  E570 000F                            AND,R6   15,IMO
          1 000E89  B856                                 LDR,R3   R6
          1 000E8A  E0B0 0000 02DB  00                   LDH,R6   HEXES,R3
          1 000E8D  EAC7 0018                            SRM,R6,'00FF'X    FPT+1,AUTO
          1 000E8F       00FF

  14737   1                              CHAR_4          null
      937    14738    4   CHAR_4:  ;
      938    14739    4            VDH_SETPRM.VAL_.ADR$=ADDR(%CHRBFR);

  14739   1 000E90  EBC7 0017            CHAR_4          LAB,B6   FPT,AUTO
          1 000E92  EFC7 000D                            STB,B6   VDH_SETPRM+3,AUTO

      939    14740    4            VDH_SETPRM.VAL_.BYTSIZ=4;

  14740   1 000E94  6C04                                 LDV,R6   4
          1 000E95  EF47 0010                            STR,R6   VDH_SETPRM+6,AUTO

      940    14741    4         END;

      941    14742    3      END;

      942    14743    2      RETURN;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:183  
  14743   1 000E97  ECC7 002E                            LDB,B6   OFFSET,AUTO
          1 000E99  C3C6 0001                            LNJ,B4   1,B6

      943    14744    2   END GETPRM;
      944    14745        %EJECT;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:184  
      945    14746        /*I* NAME: GETSPACE.
      946    14747             PURPOSE: Get space for the current SCRUCT of a GETPRM.
      947    14748             DESCRIPTION: Returns a pointer to the space in STR$. ALtrets if not.
      948    14749                          If the caller provided a buffer, only it is ever used.
      949    14750                          Otherwise, a chain of buffers is used, each limited to
      950    14751                          the callers MAXBYTSIZ or 256 bytes if that is 0.
      951    14752                          The space is initialized to zero.
      952    14753                          If we're doing a STRLST, the T/L word is initialized.
      953    14754                          If we're doing a variable-length PRM (request is zero)
      954    14755                          the first SHRBFR in the struct is used to determine the
      955    14756                          size (e.g. prompts, headers, etc.).
      956    14757                          As a result, calls GETPRM.
      957    14758                          The request size is placed in OFFSET before calling
      958    14759                          GETSPACE.
      959    14760        */
      960    14761    1   GETSPACE: PROC ALTRET;

  14761   1 000E9B  EFC7 0028            GETSPACE        STB,B6   FPT+17,AUTO

      961    14762    2   DCL GETPRM$ PTR;
      962    14763    2   DCL K SBIN;
      963    14764    2   DCL L SBIN;
      964    14765    2   DCL 1 CLEAR BASED(STR$) ALIGNED,
      965    14766    2          2 * CHAR(OFFSET);
      966    14767        %KV$GETPRM (STCLASS="BASED(GETPRM$)");
      967    14809        %KV$GETPRM (NAME=KV_GETPRM, STCLASS=CONSTANT, STRTYP=%KV_STRTYP_MSG,
      968    14810         BFRRLSDSP = %KV_BFRRLSDSP_MSG);
      969    14852    3      IF OFFSET=0 THEN DO;

  14852   1 000E9D  E847 0014                            LDR,R6   OFFSET,AUTO
          1 000E9F  6981 002A                            BNEZ,R6  s:14861,PREL

      970    14853    3         K=J;

  14853   1 000EA1  D847 0013                            LDR,R5   J,AUTO
          1 000EA3  DF47 002C                            STR,R5   K,AUTO

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:185  
      971    14854    4         DO WHILE KV_STR.TYPE(K)~=%PRM_STR_TYPE_BFR;

  14854   1 000EA5  B855                                 LDR,R3   R5
          1 000EA6  C830 0000 01BD  00                   LDR,R4   KV_STRS,R3
          1 000EA9  404C                                 SOR,R4   12
          1 000EAA  4D0B                                 CMV,R4   11
          1 000EAB  0901 000B                            BE       s:14857,PREL

      972    14855    4            K=K+1;

  14855   1 000EAD  8AC7 002C                            INC      K,AUTO

      973    14856    4         END;

  14856   1 000EAF  B847 002C                            LDR,R3   K,AUTO
          1 000EB1  E830 0000 01BD  00                   LDR,R6   KV_STRS,R3
          1 000EB4  604C                                 SOR,R6   12
          1 000EB5  6D0B                                 CMV,R6   11
          1 000EB6  09F7                                 BNE      s:14855,SPREL

      974    14857    3         VDH_SETPRM.PRMID=KV_STRID(K);

  14857   1 000EB7  E2B0 0000 026E  00                   LLH,R6   KV_STRIDS,R3
          1 000EBA  EF47 000B                            STR,R6   VDH_SETPRM+1,AUTO

      975    14858    3         CALL GETPRM;

  14858   1 000EBC  E3C0 FE1C                            LNJ,B6   s:0,PREL
          1 000EBE       0001                            DC       s:14859,PREL

      976    14859    3         OFFSET=KV_STR.OFFSET(K)+VDH_SETPRM.VAL_.BYTSIZ;

  14859   1 000EBF  B847 002C                            LDR,R3   K,AUTO
          1 000EC1  E830 0000 01BD  00                   LDR,R6   KV_STRS,R3
          1 000EC4  E570 0FFF                            AND,R6   4095,IMO
          1 000EC6  EA47 0010                            ADD,R6   VDH_SETPRM+6,AUTO
          1 000EC8  EF47 0014                            STR,R6   OFFSET,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:186  

      977    14860    3      END;

      978    14861    2      IF STRLST THEN IF OFFSET<256 THEN OFFSET=OFFSET+2; /* allow for t/l word   */

  14861   1 000ECA  D847 0015                            LDR,R5   MAXBYTX,AUTO
          1 000ECC  5901 000D                            BEZ,R5   s:14863,PREL

  14861   1 000ECE  E970 0100                            CMR,R6   256,IMO
          1 000ED0  0881 0006                            BAGE     s:14862,PREL

  14861   1 000ED2  6E02                                 ADV,R6   2
          1 000ED3  EF47 0014                            STR,R6   OFFSET,AUTO
          1 000ED5  0F81 0004                            B        s:14863,PREL

      979    14862    2      ELSE OFFSET=OFFSET+4;

  14862   1 000ED7  6E04                                 ADV,R6   4
          1 000ED8  EF47 0014                            STR,R6   OFFSET,AUTO

      980    14863    2      K=OFFSET;

  14863   1 000EDA  EF47 002C                            STR,R6   K,AUTO

      981    14864    2      IF BINBIT(K,1) THEN K=K+1;

  14864   1 000EDC  600F                                 SOL,R6   15
          1 000EDD  6901 0003                            BEZ,R6   s:14865,PREL

  14864   1 000EDF  8AC7 002C                            INC      K,AUTO

      982    14865    3      IF KV$VDH_GETPRM.VAL_.ADR$~=ADDR(NIL) THEN DO;

  14865   1 000EE1  ECC7 0004                            LDB,B6   @KV$VDH_XXXPRM,AUTO
          1 000EE3  8DC6 0003                            CMN      3,B6
          1 000EE5  0901 0021                            BE       s:14877,PREL

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:187  
      983    14866        /* The caller provided a buffer - use it. */
      984    14867
      985    14868    3         IF OFFSET>KV$VDH_GETPRM.VAL_.BYTSIZ-KV$VDH_GETPRM.DATBYTSIZ

  14868   1 000EE7  E846 0006                            LDR,R6   6,B6
          1 000EE9  E246 0009                            SUB,R6   9,B6
          1 000EEB  E947 0014                            CMR,R6   OFFSET,AUTO
          1 000EED  0881 0005                            BAGE     s:14870,PREL

      986    14869    3         THEN ALTRETURN;

  14869   1 000EEF  ECC7 0028                            LDB,B6   FPT+17,AUTO
          1 000EF1  B806                                 LDR,R3   ,B6
          1 000EF2  C3B6                                 LNJ,B4   ,B6,R3

      987    14870    3         STR$=PINCRW(KV$VDH_GETPRM.VAL_.ADR$,

  14870   1 000EF3  E846 0005                            LDR,R6   5,B6
          1 000EF5  EA46 0009                            ADD,R6   9,B6
          1 000EF7  E370 0002                            DIV,R6   2,IMO
          1 000EF9  DCC6 0003                            LDB,B5   3,B6
          1 000EFB  B856                                 LDR,R3   R6
          1 000EFC  CBB5                                 LAB,B4   ,B5,R3
          1 000EFD  CFC7 0006                            STB,B4   STR$,AUTO

      988    14871    3           (KV$VDH_GETPRM.VAL_.BYTX+KV$VDH_GETPRM.DATBYTSIZ)/2);
      989    14872    3         KV$VDH_GETPRM.DATBYTSIZ=KV$VDH_GETPRM.DATBYTSIZ+K;

  14872   1 000EFF  E846 0009                            LDR,R6   9,B6
          1 000F01  EA47 002C                            ADD,R6   K,AUTO
          1 000F03  EF46 0009                            STR,R6   9,B6

      990    14873    3      END;

  14873   1 000F05  0F81 0095                            B        s:14908,PREL

      991    14874    3      ELSE DO;
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:188  

      992    14875        /* We allocate our own. */
      993    14876
      994    14877    3         GETPRM$=ADDR(KV$VDH_GETPRM.BFRHED$);

  14877   1 000F07  DBC6 0007                            LAB,B5   7,B6
          1 000F09  DFC7 002A                            STB,B5   GETPRM$,AUTO

      995    14878    4         DO WHILE KV$GETPRM.LNK$~=ADDR(NIL);

  14878   1 000F0B  0F81 0006                            B        s:14880,PREL

      996    14879    4            GETPRM$=KV$GETPRM.LNK$;

  14879   1 000F0D  ECC7 002A                            LDB,B6   GETPRM$,AUTO
          1 000F0F  DC86                                 LDB,B5   ,B6
          1 000F10  DFC7 002A                            STB,B5   GETPRM$,AUTO

      997    14880    4         END;

  14880   1 000F12  8D85                                 CMN      ,B5
          1 000F13  09FA                                 BNE      s:14879,SPREL

      998    14881    3         IF GETPRM$=ADDR(KV$VDH_GETPRM.BFRHED$) OR OFFSET>

  14881   1 000F14  ECC7 0004                            LDB,B6   @KV$VDH_XXXPRM,AUTO
          1 000F16  CBC6 0007                            LAB,B4   7,B6
          1 000F18  CFC7 0050                            STB,B4   OLDVAL+2,AUTO
          1 000F1A  DDC7 0050                            CMB,B5   OLDVAL+2,AUTO
          1 000F1C  0901 000A                            BE       s:14886,PREL
          1 000F1E  E845 0006                            LDR,R6   6,B5
          1 000F20  E245 0005                            SUB,R6   5,B5
          1 000F22  6EF0                                 ADV,R6   -16
          1 000F23  E947 0014                            CMR,R6   OFFSET,AUTO
          1 000F25  0881 0062                            BAGE     s:14904,PREL

      999    14882    3           KV$GETPRM.DAT__.BFRBYTSIZ-KV$GETPRM.DAT__.DATBYTSIZ-SIZEC(KV$GETPRM)
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:189  
     1000    14883    4         THEN DO;

     1001    14884        /* need to get another one. */
     1002    14885
     1003    14886    4            %VDH_GETBFR=KV_VDH_GETBFR;

  14886   1 000F27  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_GETBFR
          1 000F2A  2C00                                 LDV,R2   0
          1 000F2B  6C16                                 LDV,R6   22
          1 000F2C  BB87                                 LAB,B3   ,AUTO
          1 000F2D  3C2E                                 LDV,R3   46
          1 000F2E  0008                                 MMM

     1004    14887    4            %VDH_GETBFR.STRTYP=%KV_STRTYP_MSG;

  14887   1 000F2F  6C0B                                 LDV,R6   11
          1 000F30  E7C7 001D                            STH,R6   FPT+6,AUTO

     1005    14888    4            %VDH_GETBFR.SCRNO_MMR='0'B;

  14888   1 000F32  8847 001D                            LBF,'0001'X       FPT+6,AUTO
  14888   1 000F34       0001

     1006    14889    4            IF KV$VDH_GETPRM.MAXBYTSIZ~=0

  14889   1 000F35  D846 0009                            LDR,R5   9,B6
          1 000F37  5901 0006                            BEZ,R5   s:14891,PREL

     1007    14890    4            THEN %VDH_GETBFR.BYTSIZ=KV$VDH_GETPRM.MAXBYTSIZ+SIZEC(KV$GETPRM);

  14890   1 000F39  5E10                                 ADV,R5   16
          1 000F3A  DF47 001A                            STR,R5   FPT+3,AUTO
          1 000F3C  0F81 0005                            B        s:14892,PREL

     1008    14891    4            ELSE %VDH_GETBFR.BYTSIZ=256;

  14891   1 000F3E  C870 0100                            LDR,R4   256,IMO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:190  
          1 000F40  CF47 001A                            STR,R4   FPT+3,AUTO

     1009    14892    4   /*N* TEMP TIL CTN WORKS */ IF KV$VDH_GETPRM.BFRHED$~=ADDR(NIL) THEN ALTRETURN;

  14892   1 000F42  8DC6 0007                            CMN      7,B6
          1 000F44  0901 0005                            BE       s:14893,PREL

  14892   1 000F46  ECC7 0028                            LDB,B6   FPT+17,AUTO
          1 000F48  B806                                 LDR,R3   ,B6
          1 000F49  C3B6                                 LNJ,B4   ,B6,R3

     1010    14893    4            IF OFFSET>%VDH_GETBFR.BYTSIZ-SIZEC(KV$GETPRM) THEN ALTRETURN;

  14893   1 000F4A  D847 001A                            LDR,R5   FPT+3,AUTO
          1 000F4C  5EF0                                 ADV,R5   -16
          1 000F4D  D947 0014                            CMR,R5   OFFSET,AUTO
          1 000F4F  0881 0005                            BAGE     s:14896,PREL

  14893   1 000F51  ECC7 0028                            LDB,B6   FPT+17,AUTO
          1 000F53  B806                                 LDR,R3   ,B6
          1 000F54  C3B6                                 LNJ,B4   ,B6,R3

     1011    14894        /* Won't fit anyway, don't bother. */
     1012    14895
     1013    14896    5            CALL KVS$GETBFR (FPT) WHENALTRETURN DO; ALTRETURN; END;

  14896   1 000F55  DBC7 0017                            LAB,B5   FPT,AUTO
          1 000F57  DFC7 0050                            STB,B5   OLDVAL+2,AUTO
          1 000F59  BBC7 0050                            LAB,B3   OLDVAL+2,AUTO
          1 000F5B  CBF0 0100                            LAB,B4   256,IMO
          1 000F5D  E380 0000 0000  xent                 LNJ,B6   KVS$GETBFR
          1 000F60       0003                            DC       s:14896+14,PREL
          1 000F61  0F81 0005                            B        s:14897,PREL

  14896   1 000F63  ECC7 0028                            LDB,B6   FPT+17,AUTO
          1 000F65  B806                                 LDR,R3   ,B6
          1 000F66  C3B6                                 LNJ,B4   ,B6,R3
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:191  

     1014    14897    4            L=%VDH_GETBFR.BYTSIZ/2-SIZEW(KV$GETPRM);

  14897   1 000F67  E847 001A                            LDR,R6   FPT+3,AUTO
          1 000F69  6041                                 SOR,R6   1
          1 000F6A  6EF8                                 ADV,R6   -8
          1 000F6B  EF47 002D                            STR,R6   L,AUTO

     1015    14898    4            KV$GETPRM.LNK$=PINCRW(%VDH_GETBFR.BFR$,L);

  14898   1 000F6D  ECC7 0018                            LDB,B6   FPT+1,AUTO
          1 000F6F  B856                                 LDR,R3   R6
          1 000F70  DBB6                                 LAB,B5   ,B6,R3
          1 000F71  CCC7 002A                            LDB,B4   GETPRM$,AUTO
          1 000F73  DF84                                 STB,B5   ,B4

     1016    14899    4            GETPRM$=KV$GETPRM.LNK$;

  14899   1 000F74  DFC7 002A                            STB,B5   GETPRM$,AUTO

     1017    14900    4            KV$GETPRM=KV_GETPRM;

  14900   1 000F76  AB80 0000 02E3  00                   LAB,B2   KV_GETPRM
          1 000F79  2C00                                 LDV,R2   0
          1 000F7A  6C10                                 LDV,R6   16
          1 000F7B  BB85                                 LAB,B3   ,B5
          1 000F7C  3C00                                 LDV,R3   0
          1 000F7D  0008                                 MMM

     1018    14901    4            KV$GETPRM.DAT__.ADR$=%VDH_GETBFR.BFR$;

  14901   1 000F7E  ECC7 0018                            LDB,B6   FPT+1,AUTO
          1 000F80  CCC7 002A                            LDB,B4   GETPRM$,AUTO
          1 000F82  EFC4 0002                            STB,B6   2,B4

     1019    14902    4            KV$GETPRM.DAT__.BFRBYTSIZ=%VDH_GETBFR.BYTSIZ;

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:192  
  14902   1 000F84  E847 001A                            LDR,R6   FPT+3,AUTO
          1 000F86  EF44 0006                            STR,R6   6,B4

     1020    14903    4         END;

     1021    14904    3         L=KV$GETPRM.DAT__.DATBYTSIZ/2;

  14904   1 000F88  ECC7 002A                            LDB,B6   GETPRM$,AUTO
          1 000F8A  E846 0005                            LDR,R6   5,B6
          1 000F8C  6041                                 SOR,R6   1
          1 000F8D  EF47 002D                            STR,R6   L,AUTO

     1022    14905    3         STR$=PINCRW(KV$GETPRM.DAT__.ADR$,L);

  14905   1 000F8F  DCC6 0002                            LDB,B5   2,B6
          1 000F91  B856                                 LDR,R3   R6
          1 000F92  CBB5                                 LAB,B4   ,B5,R3
          1 000F93  CFC7 0006                            STB,B4   STR$,AUTO

     1023    14906    3         KV$GETPRM.DAT__.DATBYTSIZ=KV$GETPRM.DAT__.DATBYTSIZ+K;

  14906   1 000F95  D846 0005                            LDR,R5   5,B6
          1 000F97  DA47 002C                            ADD,R5   K,AUTO
          1 000F99  DF46 0005                            STR,R5   5,B6

     1024    14907    3      END;

     1025    14908    3      IF STRLST THEN DO;

  14908   1 000F9B  E847 0015                            LDR,R6   MAXBYTX,AUTO
          1 000F9D  6901 0025                            BEZ,R6   s:14923,PREL

     1026    14909        /* Make the T/L word. */
     1027    14910
     1028    14911    3         OFFSET=OFFSET-2;

  14911   1 000F9F  D847 0014                            LDR,R5   OFFSET,AUTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:193  
          1 000FA1  5EFE                                 ADV,R5   -2
          1 000FA2  DF47 0014                            STR,R5   OFFSET,AUTO

     1029    14912    3         STR$->BYT.E(0)=KV_STRID(STRLST.INDX);

  14912   1 000FA4  B2C7 0015                            LLH,R3   MAXBYTX,AUTO
          1 000FA6  C2B0 0000 026E  00                   LLH,R4   KV_STRIDS,R3
          1 000FA9  C784                                 STH,R4   ,B4

     1030    14913    3         STR$->BYT.E(1)=OFFSET;

  14913   1 000FAA  DA84                                 SRM,R5,'00FF'X    ,B4
  14913   1 000FAB       00FF

     1031    14914    4         IF OFFSET>255 THEN DO;

  14914   1 000FAC  D970 00FF                            CMR,R5   255,IMO
          1 000FAE  0A81 000E                            BALE     s:14921,PREL

     1032    14915    4            OFFSET=OFFSET-2;

  14915   1 000FB0  5EFE                                 ADV,R5   -2
          1 000FB1  DF47 0014                            STR,R5   OFFSET,AUTO

     1033    14916    4            STR$->WOR.D(0)=STR$->BYT.E(0);

  14916   1 000FB3  A284                                 LLH,R2   ,B4
          1 000FB4  AF04                                 STR,R2   ,B4

     1034    14917    4            STR$->BYT.E(0)=%KV_PRMID_BIGTL;

  14917   1 000FB5  8904                                 LBT,'FF00'X       ,B4
  14917   1 000FB6       FF00

     1035    14918    4            STR$->WOR.D(1)=OFFSET;

  14918   1 000FB7  DF44 0001                            STR,R5   1,B4
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:194  

     1036    14919    4            STR$=PINCRW(STR$,1);

  14919   1 000FB9  EBC4 0001                            LAB,B6   1,B4
          1 000FBB  EFC7 0006                            STB,B6   STR$,AUTO

     1037    14920    4         END;

     1038    14921    3         STR$=PINCRW(STR$,1);

  14921   1 000FBD  ECC7 0006                            LDB,B6   STR$,AUTO
          1 000FBF  DBC6 0001                            LAB,B5   1,B6
          1 000FC1  DFC7 0006                            STB,B5   STR$,AUTO

     1039    14922    3      END;

     1040    14923    2      CLEAR='0'B;

  14923   1 000FC3  AB80 0000 0000  02                   LAB,B2   0
          1 000FC6  2C16                                 LDV,R2   22
          1 000FC7  6C01                                 LDV,R6   1
          1 000FC8  BCC7 0006                            LDB,B3   STR$,AUTO
          1 000FCA  3C00                                 LDV,R3   0
          1 000FCB  F847 0014                            LDR,R7   OFFSET,AUTO
          1 000FCD  D380 0000 0000  xent                 LNJ,B5   X6C_ALRZ

     1041    14924    2      RETURN;

  14924   1 000FD0  ECC7 0028                            LDB,B6   FPT+17,AUTO
          1 000FD2  C3C6 0001                            LNJ,B4   1,B6

     1042    14925    2   END GETSPACE;
     1043    14926    1   SCREECH: CALL KHD$SCREECH (KVP_PRMID);

  14926   1 000FD4  BB80 0000 000C  02   SCREECH         LAB,B3   +12
          1 000FD7  CBF0 0100                            LAB,B4   256,IMO
          1 000FD9  E380 0000 0000  xent                 LNJ,B6   KHD$SCREECH
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:195  
          1 000FDC       0001                            DC       s:14930,PREL

     1044    14927        /*S* SCREECH_CODE: KVP-S$KV_PRMID
     1045    14928             MESSAGE:VDH's parameter tables are messed up.
     1046    14929        */
     1047    14930    1   END;

  14930   1 000FDD  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:196  
--  Include file information  --

   KV_GLBASM_E.:E05TOU  is referenced.
   KV_PRMTBL_M.:E05TOU  is referenced.
   KV_PRMTBL_E.:E05TOU  is referenced.
   KV_PRMTBL_D.:E05TOU  cannot be made into a system file and is referenced.
   KV_SCODE_C.:E05TOU  is referenced.
   KV$PRM.:E05TOU  is referenced.
   KV$INPFNC.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KVP$PRM.
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:197  

 **** Variables and constants ****

  ****  Section 000 RoData KVP$PRM

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

   2DB-0-0/c CHAR(16)    r     1 HEXES                    2D3-0-0/w STRC(48)    r     1 KVP_PRMID
   1AF-0-0/c UBIN(8)     r     1 KV_BFRLNG(0:13)
   1AF-0-0/c CHAR(14)    r     1 KV_BFRLNGS
   1B6-0-0/c UBIN(8)     r     1 KV_BFRTYP(0:13)
   1B6-0-0/c CHAR(14)    r     1 KV_BFRTYPS               2E3-0-0/w STRC(128)   r     1 KV_GETPRM
   18F-0-0/w UBIN(16)    r     1 KV_MAX(0:31)             18F-0-0/c CHAR(64)    r     1 KV_MAXS
   16F-0-0/w UBIN(16)    r     1 KV_MIN(0:31)             16F-0-0/c CHAR(64)    r     1 KV_MINS
     0-0-0/c STRC(3600)  r     1 KV_PRMTBL
   2CB-0-0/w SBIN(16)    r     1 KV_PTR_OFFSETS(0:7)
   1BD-0-0/c STRC(16)    r     1 KV_STR(0:176)            26E-0-0/c UBIN(8)     r     1 KV_STRID(0:176)
   26E-0-0/c CHAR(177)   r     1 KV_STRIDS                1BD-0-0/c STRC(2832)  r     1 KV_STRS
   2D6-0-0/w STRC(80)    r     1 KV_VDH_OTPLCL_TRN         E1-0-0/c STRC(16)    r     1 KV_WHERE(0:133)
    E1-0-0/c STRC(2144)  r     1 KV_WHERES
   167-0-0/w UBIN(16)    r     1 KV_WHROFFS(0:7)
   2C7-0-0/b BIT (8)     r     1 MASKS(0:7)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KV$VDH_XXXPRM            17-0-0/w UBIN(16)    r     1 FPT(0:15)
    2A-0-0/w PTR         r     1 GETPRM$                   12-0-0/w UBIN(16)    r     1 I
    13-0-0/w UBIN(16)    r     1 J                         2C-0-0/w SBIN(16)    r     1 K
    *0-0-0/w STRC(160)   r     1 KV$VDH_GETPRM             *0-0-0/w STRC(128)   r     1 KV$VDH_SETPRM
    *0-0-0/w ACHR        r     1 KV$VDH_XXXPRM             2D-0-0/w SBIN(16)    r     1 L
    15-0-0/w SBIN(16)    r     1 MAXBYTX                   14-0-0/w SBIN(16)    r     1 OFFSET
    2E-0-0/w SBIN(16)    r     1 OFFSET                    34-0-0/w SBIN(16)    r     1 OFFSET
    4E-0-0/w UBIN(16)    r     1 OLDVAL                    30-0-0/w PTR         r     1 PRM$
    2C-0-0/w UBIN(16)    r     1 PRMID                     32-0-0/w UBIN(16)    r     1 PRMID
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:198  
    2D-0-0/w UBIN(16)    r     1 PRMTYP                    33-0-0/w UBIN(16)    r     1 PRMTYP
    30-0-0/w STRC(480)   r     1 SAV_PTR                    6-0-0/w PTR         r     1 STR$
    2A-0-0/w PTR         r     1 STR$                      15-0-0/w STRC(16)    r     1 STRLST
    2F-0-0/w UBIN(16)    r     1 STRUCTURE                 16-0-0/c CHAR        r     1 TEMP
     8-0-0/w PTR         r     1 TEMP$                      A-0-0/w STRC(128)   r     1 USR_SETPRM
     A-0-0/w STRC(128)   r     1 VDH_SETPRM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(16)    r     1 KH_NODE#                   0-0-0/w PTR         r     1 KV$PTR$
     0-0-0/w UBIN(16)    r     1 KV_SND_RQSDAT_GNR          0-0-0/w STRC(128)   r     1 KV_USR_DAT
     0-0-0/w STRC(176)   r     1 KV_VDH_GETBFR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 BI                         0-0-0/w STRC(8)     r     1 BYT
     0-0-0/c CHAR(255)   r     1 CHARS                      0-0-0/w ASTR(0)     r     1 CLEAR
     0-0-0/w STRC(16)    r     1 HEXVAL                     0-0-0/w STRC(512)   r     1 KH$CHN
     0-0-0/w STRC(96)    r     1 KV$BFRDSC                  0-0-0/w STRC(96)    r     1 KV$BFRDSC
     0-0-0/w STRC(728)   r     1 KV$ERD                     0-0-0/w STRC(128)   r     1 KV$GETPRM
     0-0-0/w STRC(512)   r     1 KV$MRD                     0-0-0/w STRC(512)   r     1 KV$MVD
     0-0-0/w STRC(480)   r     1 KV$PTR                     0-0-0/w STRC(64)    r     1 KV$SHRBFR
     0-0-0/w STRC(496)   r     1 KV$SRD                     0-0-0/w STRC(1024)  r     1 KV$SSN
     0-0-0/w STRC(512)   r     1 KV$STR                     0-0-0/w STRC(104)   r     1 KV$TITLE
     0-0-0/w STRC(499)   r     1 KV$TRNTBL                  0-0-0/w STRC(912)   r     1 KV$USRPRM
     0-0-0/w STRC(128)   r     1 KV$USR_DAT                 0-0-0/w STRC(176)   r     1 KV$VDH_GETBFR
     0-0-0/w STRC(80)    r     1 KV$VDH_OTPLCL              0-0-0/w STRC(112)   r     1 KV$VDH_RLSBFR
     0-0-0/w STRC(512)   r     1 KV$VDI                     0-0-0/w STRC(24)    r     1 PRM_ABSGRPRND
     0-0-0/w STRC(32)    r     1 PT                         0-0-0/w STRC(256)   r     1 WINDOW
     0-0-0/w STRC(16)    r     1 WOR

PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:199  

   Procedure KVP$PRM requires 4064 words for executable code.
   Procedure KVP$PRM requires 82 words of local(AUTO) storage.

    No errors detected in file KVP$PRM.:E05TSI    .
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:200  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:201  
          MINI XREF LISTING

BI.T
     13502**DCL     13817>>IF      13821>>IF      13823>>IF      14061>>IF      14062<<ASSIGN  14063<<ASSIGN
     14257<<ASSIGN  14279<<ASSIGN  14526<<ASSIGN  14547>>IF      14551<<ASSIGN  14552<<ASSIGN  14555<<ASSIGN
     14556<<ASSIGN  14560<<ASSIGN  14562<<ASSIGN  14679>>IF
BLANK_4 IN PROCEDURE GETPRM
     14722**LABEL   14717--GOTO
BYT.E
     13504**DCL     13788>>ASSIGN  13789>>ASSIGN  13827>>IF      13834>>ASSIGN  14068>>ASSIGN  14069<<ASSIGN
     14273<<ASSIGN  14285<<ASSIGN  14288<<ASSIGN  14288>>ASSIGN  14567<<ASSIGN  14681>>ASSIGN  14912<<ASSIGN
     14913<<ASSIGN  14916>>ASSIGN  14917<<ASSIGN
CHARS
     13509**DCL     14077<<ASSIGN  14077>>ASSIGN  14480<<ASSIGN  14480>>ASSIGN  14588<<ASSIGN  14588>>ASSIGN
     14722<<ASSIGN  14730<<CALLBLT 14734<<ASSIGN  14735<<ASSIGN  14736<<ASSIGN  14737<<ASSIGN  14739--ASSIGN
CHAR_4 IN PROCEDURE GETPRM
     14737**LABEL   14723--GOTO    14731--GOTO
CLEAR IN PROCEDURE GETSPACE
     14765**DCL     14923<<ASSIGN
DEC_4 IN PROCEDURE GETPRM
     14728**LABEL   14719--GOTO    14726--GOTO
EXT_XIT
     13882**LABEL   13825--GOTO
FPT
     13771**DCL     14085--ASSIGN  14086--ASSIGN  14088--ASSIGN  14094--ASSIGN  14109--IF      14109--IF
     14112--ASSIGN  14113--ASSIGN  14114--ASSIGN  14115--IF      14117--ASSIGN  14121<>CALL    14122--ASSIGN
     14124--IF      14128--ASSIGN  14129--IF      14132--IF      14134--ASSIGN  14137--IF      14139--IF
     14142--ASSIGN  14143--ASSIGN  14145--ASSIGN  14149--ASSIGN  14155--IF      14155<>CALL    14168--ASSIGN
     14169--ASSIGN  14170<>CALL    14172--ASSIGN  14173--ASSIGN  14174--ASSIGN  14175<>CALL    14722--ASSIGN
     14730--CALLBLT 14734--ASSIGN  14735--ASSIGN  14736--ASSIGN  14737--ASSIGN  14739--ASSIGN  14886--ASSIGN
     14887--ASSIGN  14888--ASSIGN  14890--ASSIGN  14891--ASSIGN  14893--IF      14896<>CALL    14897--ASSIGN
     14898--ASSIGN  14901--ASSIGN  14902--ASSIGN
GETPRM
     14623**PROC    14470--CALL    14544--CALL    14858--CALL
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:202  
GETPRM$ IN PROCEDURE GETSPACE
     14762**DCL     14780--IMP-PTR 14877<<ASSIGN  14878>>DOWHILE 14879<<ASSIGN  14879>>ASSIGN  14881>>IF
     14881>>IF      14881>>IF      14898>>ASSIGN  14899<<ASSIGN  14899>>ASSIGN  14900>>ASSIGN  14901>>ASSIGN
     14902>>ASSIGN  14904>>ASSIGN  14905>>ASSIGN  14906>>ASSIGN  14906>>ASSIGN
GETSPACE
     14761**PROC    14476--CALL    14512--CALL
GET_BIT
     14555**LABEL   14553--GOTO
GET_BYT
     14567**LABEL   14565--GOTO
GET_LOOP
     14517**LABEL   14579--EXIT
HEXES IN PROCEDURE GETPRM
     14629**DCL     14734>>ASSIGN  14735>>ASSIGN  14736>>ASSIGN  14737>>ASSIGN
HEXVAL.V0 IN PROCEDURE GETPRM
     14631**DCL     14734>>ASSIGN
HEXVAL.V1 IN PROCEDURE GETPRM
     14632**DCL     14735>>ASSIGN
HEXVAL.V2 IN PROCEDURE GETPRM
     14633**DCL     14736>>ASSIGN
HEXVAL.V3 IN PROCEDURE GETPRM
     14634**DCL     14737>>ASSIGN
HRZINS IN PROCEDURE SETPTR
     14257**LABEL   14251--GOTO    14255--GOTO
I
     13763**DCL     13512--IMP-SIZ 13803<<CALLBLT 13805>>IF      13809>>ASSIGN  14457<<ASSIGN  14461>>DOWHILE
     14463>>ASSIGN  14464<<CALLBLT 14465>>IF      14465>>IF      14469>>ASSIGN  14488>>IF      14491>>ASSIGN
     14605>>IF      14606>>ASSIGN  14611<<ASSIGN  14614<<ASSIGN
J
     13764**DCL     13809<<ASSIGN  13812>>ASSIGN  13814>>ASSIGN  13815>>DOCASE  13828<<ASSIGN  13828>>ASSIGN
     13860>>ASSIGN  13865>>ASSIGN  13882<<ASSIGN  13882>>ASSIGN  14491<<ASSIGN  14492>>IF      14511>>ASSIGN
     14518>>ASSIGN  14520>>IF      14524>>ASSIGN  14525>>IF      14526>>ASSIGN  14527<<ASSIGN  14527>>ASSIGN
     14534>>DOSELCT 14547>>IF      14548>>ASSIGN  14549>>DOCASE  14563<<ASSIGN  14563>>ASSIGN  14564>>ASSIGN
     14592>>ASSIGN  14594>>ASSIGN  14602<<ASSIGN  14602>>ASSIGN  14853>>ASSIGN
K IN PROCEDURE GETSPACE
     14763**DCL     14853<<ASSIGN  14854>>DOWHILE 14855<<ASSIGN  14855>>ASSIGN  14857>>ASSIGN  14859>>ASSIGN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:203  
     14863<<ASSIGN  14864>>IF      14864<<ASSIGN  14864>>ASSIGN  14872>>ASSIGN  14906>>ASSIGN
KH$CHN.DRCCNC
     13367**DCL     14712>>IF
KH$CHN.SUB$
     13436**DCL     14714>>IF
KH$CHN.TERMID.LEV
     13425**DCL     14714>>IF      14717>>IF      14721>>IF
KH$CHN.TERMID.TERM
     13425**DCL     13434--REDEF
KH$CHN.TERMID.TERM.CHANNEL
     13431**DCL     14733>>ASSIGN
KH$CHN.TERMID.TERM.SUBDEVICE
     13431**DCL     14725>>ASSIGN
KH$CHN.TERMID.TERM.SUBSUBDEVICE
     13431**DCL     14718>>ASSIGN
KHD$SCREECH
     13484**DCL-ENT 14926--CALL
KH_NODE# IN PROCEDURE GETPRM
     14624**DCL     14728>>ASSIGN
KV$BFRDSC.BYTX IN PROCEDURE GETPRM
     14659**DCL     14695>>ASSIGN
KV$BFRDSC.DATBYTSIZ IN PROCEDURE GETPRM
     14659**DCL     14696>>ASSIGN
KV$BFRDSC.BFRBYTSIZ IN PROCEDURE SETPTR
     13931**DCL     14143>>ASSIGN  14144<<ASSIGN
KV$BFRDSC.BFRRLSDSP IN PROCEDURE SETPTR
     13932**DCL     14148>>IF      14150<<ASSIGN
KV$BFRDSC.BYTX IN PROCEDURE SETPTR
     13930**DCL     14146<<ASSIGN
KV$BFRDSC.DATBYTSIZ IN PROCEDURE SETPTR
     13930**DCL     14145<<ASSIGN
KV$BFRDSC.STRTYP IN PROCEDURE SETPTR
     13931**DCL     14147<<ASSIGN
KV$ERD.CNT
     13309**DCL     14104>>IF      14106<<ASSIGN
KV$ERD.CUP_ALG
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:204  
     13288**DCL     14213>>IF
KV$ERD.CUP_CHR
     13299**DCL     14103>>ASSIGN
KV$ERD.CUU_CHR
     13301**DCL     14213>>IF
KV$ERD.DCH_CHR
     13299**DCL     14221>>IF
KV$ERD.DCLFLD_ALG
     13293**DCL     14229>>IF
KV$ERD.DLN_CHR
     13306**DCL     14215>>IF
KV$ERD.ED0_CHR
     13300**DCL     14208>>IF
KV$ERD.ED2_CHR
     13302**DCL     14206>>IF      14210>>IF
KV$ERD.EL0_CHR
     13300**DCL     14208>>IF
KV$ERD.ENDMSGLIN_CHR
     13307**DCL     14224>>IF
KV$ERD.EXTSRD_CHR
     13308**DCL     13308--REDEF   13309--REDEF
KV$ERD.FRSCLMFLD
     13291**DCL     14223>>ASSIGN
KV$ERD.ICH_CHR
     13298**DCL     14221>>IF
KV$ERD.ILNRQRDLN
     13290**DCL     14107<<ASSIGN
KV$ERD.ILN_CHR
     13306**DCL     14215>>IF
KV$ERD.MSGLIN_CHR
     13307**DCL     14224>>IF
KV$ERD.RGNSCR
     13292**DCL     14107>>IF
KV$ERD.SGRHDN_CHR
     13294**DCL     14227>>IF
KV$GETPRM IN PROCEDURE GETSPACE
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:205  
     14780**DCL     14881--IF      14890--ASSIGN  14893--IF      14897--ASSIGN  14900<<ASSIGN
KV$GETPRM.DAT__.ADR$ IN PROCEDURE GETSPACE
     14804**DCL     14901<<ASSIGN  14905>>ASSIGN
KV$GETPRM.DAT__.BFRBYTSIZ IN PROCEDURE GETSPACE
     14805**DCL     14881>>IF      14902<<ASSIGN
KV$GETPRM.DAT__.DATBYTSIZ IN PROCEDURE GETSPACE
     14804**DCL     14881>>IF      14904>>ASSIGN  14906<<ASSIGN  14906>>ASSIGN
KV$GETPRM.LNK$ IN PROCEDURE GETSPACE
     14780**DCL     14878>>DOWHILE 14879>>ASSIGN  14898<<ASSIGN  14899>>ASSIGN
KV$MRD.ABSGRPRND
     12451**DCL     14160<<ASSIGN
KV$MRD.BLANKERASES
     12440**DCL     14203>>IF      14210>>IF
KV$MRD.CALUSR_PST
     12435**DCL     14232>>IF
KV$MRD.CTNFRM
     12446**DCL     14203<<ASSIGN  14204<<ASSIGN  14206<<ASSIGN  14211<<ASSIGN  14212<<ASSIGN  14351>>IF
KV$MRD.CURSORUP
     12444**DCL     14213<<ASSIGN  14214<<ASSIGN  14233<<ASSIGN
KV$MRD.DCLATRWHNOTP
     12446**DCL     14229<<ASSIGN  14230<<ASSIGN
KV$MRD.DSPHEIGHT
     12434**DCL     14330<<ASSIGN  14336<<ASSIGN  14351>>IF      14351>>IF      14353<<ASSIGN  14354>>ASSIGN
KV$MRD.DVCLIN
     12455**DCL     14390>>IF      14391<<ASSIGN
KV$MRD.ERD$
     12433**DCL     14205>>IF      14206>>IF
KV$MRD.FRSCLMFLD
     12448**DCL     14223<<ASSIGN
KV$MRD.FSTERS
     12444**DCL     14203>>IF      14208<<ASSIGN  14209<<ASSIGN  14210>>IF      14219>>ASSIGN
KV$MRD.HRZSCR
     12443**DCL     14221<<ASSIGN  14222<<ASSIGN
KV$MRD.LNG
     12437**DCL     14268>>ASSIGN  14329>>ASSIGN  14335>>ASSIGN  14339<<ASSIGN  14348<<ASSIGN  14390>>IF
     14391>>ASSIGN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:206  
KV$MRD.MSGLIN
     12448**DCL     14225<<ASSIGN  14226<<ASSIGN
KV$MRD.PHSFRM
     12446**DCL     14265>>IF      14340<<ASSIGN  14342<<ASSIGN  14345>>IF      14351>>IF      14390>>IF
KV$MRD.PRINTTYPE
     12443**DCL     14372>>IF
KV$MRD.SMLHDNATR
     12438**DCL     14227<<ASSIGN  14228<<ASSIGN
KV$MRD.SRD$
     12432**DCL     14045>>ASSIGN
KV$MRD.USRCNT
     12434**DCL     14033>>IF      14347>>IF
KV$MRD.VRTSCR
     12447**DCL     14215<<ASSIGN  14216<<ASSIGN  14218>>ASSIGN
KV$MRD.WDT
     12434**DCL     14217>>IF      14307<<ASSIGN  14309>>ASSIGN
KV$MVD.APLLCNRM
     12122**DCL     14197>>IF
KV$MVD.EDITOVR
     12122**DCL     14260>>IF
KV$MVD.FRMLIN
     12132**DCL     14382<<ASSIGN  14574>>ASSIGN
KV$MVD.FRSLIN
     12132**DCL     14346>>ASSIGN
KV$MVD.HRZSCR
     12123**DCL     14253<<ASSIGN  14262<<ASSIGN
KV$MVD.INSMOD
     12123**DCL     14261<<ASSIGN
KV$MVD.LINLST$
     12117**DCL     14046>>ASSIGN  14441>>ASSIGN
KV$MVD.LMB
     12118**DCL     14346>>ASSIGN
KV$MVD.LNG
     12118**DCL     14345>>IF      14346>>ASSIGN  14382>>ASSIGN  14573>>IF      14574>>ASSIGN
KV$MVD.ORG
     12119**DCL     13849>>IF      13851>>IF      14251>>IF      14252>>IF      14255>>IF      14272>>IF
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:207  
     14275>>IF      14278>>IF      14359>>IF      14579>>IF
KV$MVD.PAGNMB
     12133**DCL     14098<<ASSIGN  14573>>IF      14575>>ASSIGN
KV$MVD.RETYPOVR
     12122**DCL     14260>>IF      14361>>IF
KV$MVD.SRD$
     12114**DCL     14044>>ASSIGN  14433>>ASSIGN
KV$MVD.TRNTBL$
     12116**DCL     14197>>IF      14197>>IF      14200<<ASSIGN  14707>>IF      14708>>IF      14708>>IF
KV$MVD.WDT
     12118**DCL     14299<<ASSIGN  14299>>ASSIGN  14325>>IF      14325<<ASSIGN  14326>>ASSIGN
KV$PTR
     11833**DCL     14026>>ASSIGN  14055--ASSIGN  14444<<ASSIGN  14674--ASSIGN
KV$PTR.FLD$
     11837**DCL     14179>>IF
KV$PTR.INPCNDPND
     11839**DCL     11848--REDEF   11852--REDEF
KV$PTR.LINLST$
     11835**DCL     11836--REDEF   14046<<ASSIGN  14441<<ASSIGN
KV$PTR.MRD$
     11834**DCL     14033>>IF      14044<<ASSIGN  14045>>ASSIGN  14160>>ASSIGN  14265>>IF      14268>>ASSIGN
     14439<<ASSIGN
KV$PTR.MVD$
     11834**DCL     13849>>IF      13851>>IF      14043<<ASSIGN  14044>>ASSIGN  14046>>ASSIGN  14098>>ASSIGN
     14272>>IF      14275>>IF      14278>>IF      14299>>ASSIGN  14299>>ASSIGN  14325>>IF      14325>>ASSIGN
     14326>>ASSIGN  14345>>IF      14346>>ASSIGN  14346>>ASSIGN  14346>>ASSIGN  14359>>IF      14361>>IF
     14382>>ASSIGN  14382>>ASSIGN  14432<<ASSIGN  14433>>ASSIGN  14441>>ASSIGN  14573>>IF      14573>>IF
     14574>>ASSIGN  14574>>ASSIGN  14575>>ASSIGN  14579>>IF      14707>>IF      14708>>IF      14708>>IF
KV$PTR.SRD$
     11835**DCL     13839>>IF      14045<<ASSIGN  14217>>IF      14218>>ASSIGN  14219>>ASSIGN  14283>>ASSIGN
     14296>>IF      14298>>ASSIGN  14303>>IF      14309>>ASSIGN  14313>>ASSIGN  14344>>ASSIGN  14365>>ASSIGN
     14436<<ASSIGN  14437>>ASSIGN  14582>>ASSIGN  14582>>ASSIGN  14583>>ASSIGN  14583>>ASSIGN  14584>>ASSIGN
     14585>>ASSIGN
KV$PTR.SSN$
     11833**DCL     14038>>ASSIGN  14151>>ASSIGN  14237>>IF      14240>>ASSIGN  14244>>ASSIGN  14422>>ASSIGN
     14424<<ASSIGN  14425>>ASSIGN  14498>>ASSIGN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:208  
KV$PTR.STR$
     11833**DCL     13851>>IF      14036>>IF      14038<<ASSIGN  14039>>DOWHILE 14040>>IF      14041<<ASSIGN
     14041>>ASSIGN  14043>>ASSIGN  14151>>ASSIGN  14296>>IF      14418>>ASSIGN  14428<<ASSIGN  14429>>ASSIGN
     14497>>ASSIGN  14498<<ASSIGN  14501>>IF      14501<<ASSIGN  14501>>ASSIGN  14503<<ASSIGN  14508>>IF
     14513<<ASSIGN  14616<<ASSIGN
KV$PTR.VDI$
     11833**DCL     13780>>IF      13893>>IF      14051>>IF      14167>>IF      14193>>ASSIGN  14243>>ASSIGN
     14374>>ASSIGN  14376>>IF      14393>>IF      14398>>IF      14712>>IF      14714>>IF      14714>>IF
     14717>>IF      14718>>ASSIGN  14721>>IF      14725>>ASSIGN  14733>>ASSIGN
KV$PTR$
     11827**DCL     11833--IMP-PTR 13780>>IF      13839>>IF      13849>>IF      13851>>IF      13851>>IF
     13893>>IF      14026>>ASSIGN  14033>>IF      14036>>IF      14038>>ASSIGN  14038>>ASSIGN  14039>>DOWHILE
     14040>>IF      14041>>ASSIGN  14041>>ASSIGN  14043>>ASSIGN  14043>>ASSIGN  14044>>ASSIGN  14044>>ASSIGN
     14045>>ASSIGN  14045>>ASSIGN  14046>>ASSIGN  14046>>ASSIGN  14051>>IF      14055>>ASSIGN  14098>>ASSIGN
     14151>>ASSIGN  14151>>ASSIGN  14160>>ASSIGN  14167>>IF      14179>>IF      14193>>ASSIGN  14217>>IF
     14218>>ASSIGN  14219>>ASSIGN  14237>>IF      14240>>ASSIGN  14243>>ASSIGN  14244>>ASSIGN  14265>>IF
     14268>>ASSIGN  14272>>IF      14275>>IF      14278>>IF      14283>>ASSIGN  14296>>IF      14296>>IF
     14298>>ASSIGN  14299>>ASSIGN  14299>>ASSIGN  14303>>IF      14309>>ASSIGN  14313>>ASSIGN  14325>>IF
     14325>>ASSIGN  14326>>ASSIGN  14344>>ASSIGN  14345>>IF      14346>>ASSIGN  14346>>ASSIGN  14346>>ASSIGN
     14359>>IF      14361>>IF      14365>>ASSIGN  14374>>ASSIGN  14376>>IF      14382>>ASSIGN  14382>>ASSIGN
     14393>>IF      14398>>IF      14418>>ASSIGN  14422>>ASSIGN  14424>>ASSIGN  14425>>ASSIGN  14428>>ASSIGN
     14429>>ASSIGN  14432>>ASSIGN  14433>>ASSIGN  14436>>ASSIGN  14437>>ASSIGN  14439>>ASSIGN  14441>>ASSIGN
     14441>>ASSIGN  14444>>ASSIGN  14497>>ASSIGN  14498>>ASSIGN  14498>>ASSIGN  14501>>IF      14501>>ASSIGN
     14501>>ASSIGN  14503>>ASSIGN  14508>>IF      14513>>ASSIGN  14573>>IF      14573>>IF      14574>>ASSIGN
     14574>>ASSIGN  14575>>ASSIGN  14579>>IF      14582>>ASSIGN  14582>>ASSIGN  14583>>ASSIGN  14583>>ASSIGN
     14584>>ASSIGN  14585>>ASSIGN  14616>>ASSIGN  14674>>ASSIGN  14707>>IF      14708>>IF      14708>>IF
     14712>>IF      14714>>IF      14714>>IF      14717>>IF      14718>>ASSIGN  14721>>IF      14725>>ASSIGN
     14733>>ASSIGN
KV$SHRBFR
     12475**DCL     14089--ASSIGN  14094--ASSIGN  14690--ASSIGN  14699--ASSIGN
KV$SHRBFR.BYTSIZ
     12484**DCL     14699>>ASSIGN
KV$SRD.BRDEXS
     12264**DCL     14370>>IF
KV$SRD.BRDUPD
     12265**DCL     13839>>IF      14283<<ASSIGN  14289<<ASSIGN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:209  
KV$SRD.BTMRHT
     12253**DCL     12258--REDEF
KV$SRD.BTMRHT.CLM
     12255**DCL     14327<<ASSIGN
KV$SRD.BTMRHT.LIN
     12255**DCL     14349<<ASSIGN  14356>>ASSIGN  14383>>ASSIGN  14389>>ASSIGN
KV$SRD.CRT
     12329**DCL     12334--REDEF
KV$SRD.CRT.LIN
     12331**DCL     14377<<ASSIGN  14378>>ASSIGN  14383<<ASSIGN  14386>>ASSIGN  14388>>ASSIGN  14389>>ASSIGN
KV$SRD.CRTVRTLINPHSLIN
     12301**DCL     14378<<ASSIGN  14386<<ASSIGN
KV$SRD.DVCLINBIS
     12371**DCL     14389<<ASSIGN
KV$SRD.FLDEND
     12293**DCL     12298--REDEF   14376<<ASSIGN
KV$SRD.FSTERS
     12264**DCL     14219<<ASSIGN
KV$SRD.HI_NONBLN
     12363**DCL     12368--REDEF
KV$SRD.HI_NONBLN.LIN
     12365**DCL     14388<<ASSIGN
KV$SRD.LFTBRD
     12408**DCL     14315>>IF
KV$SRD.LFTMRGCLM
     12263**DCL     14298<<ASSIGN  14316>>IF      14316>>ASSIGN
KV$SRD.LNG
     12261**DCL     14356<<ASSIGN
KV$SRD.MRD$
     12157**DCL     14044>>ASSIGN  14345>>IF      14347>>IF      14348>>ASSIGN  14351>>IF      14351>>IF
     14351>>IF      14351>>IF      14353>>ASSIGN  14354>>ASSIGN  14372>>IF      14390>>IF      14390>>IF
     14390>>IF      14391>>ASSIGN  14391>>ASSIGN  14437>>ASSIGN
KV$SRD.NXTNONBLNLIN
     12301**DCL     14379<<ASSIGN  14385<<ASSIGN
KV$SRD.OPT
     12406**DCL     14276<<ASSIGN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:210  
KV$SRD.ORG
     12185**DCL     12190--REDEF
KV$SRD.ORG.CLM
     12187**DCL     14314>>ASSIGN  14318>>ASSIGN  14319>>ASSIGN  14583>>ASSIGN  14585>>ASSIGN
KV$SRD.ORG.LIN
     12187**DCL     14354<<ASSIGN  14355>>ASSIGN  14356>>ASSIGN  14582>>ASSIGN  14584>>ASSIGN
KV$SRD.RHTBRD
     12408**DCL     14322>>IF
KV$SRD.SAVSCROLL
     12266**DCL     14360<<ASSIGN  14368<<ASSIGN
KV$SRD.SCROLL
     12262**DCL     14292>>IF      14360>>ASSIGN  14361<<ASSIGN  14362<<ASSIGN  14363>>IF      14367<<ASSIGN
     14375>>IF
KV$SRD.SRDEND
     12398**DCL     12403--REDEF
KV$SRD.SRDEND.CLM
     12400**DCL     14309<<ASSIGN  14314>>ASSIGN  14318>>ASSIGN  14321>>ASSIGN  14583>>ASSIGN
KV$SRD.SRDEND.LIN
     12400**DCL     14350<<ASSIGN  14582>>ASSIGN
KV$SRD.TOPLFT
     12219**DCL     12224--REDEF
KV$SRD.TOPLFT.CLM
     12221**DCL     14303>>IF      14319<<ASSIGN  14321<<ASSIGN  14327>>ASSIGN
KV$SRD.TOPLFT.LIN
     12221**DCL     14355<<ASSIGN  14377>>ASSIGN
KV$SRD.USRCNT
     12158**DCL     14347>>IF
KV$SRD.VBRDSIZ
     12408**DCL     14315>>ASSIGN  14322>>ASSIGN
KV$SRD.VRTPSTOK
     12262**DCL     14373<<ASSIGN
KV$SRD.VRTSCR
     12407**DCL     14218<<ASSIGN  14362>>IF      14370<<ASSIGN
KV$SRD.WDT
     12261**DCL     14217>>IF      14296>>IF      14326<<ASSIGN  14327>>ASSIGN
KV$SRD.WRPPAG
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:211  
     12263**DCL     14384>>IF
KV$SSN.LNK$
     11949**DCL     14422>>ASSIGN
KV$SSN.LSTEDTBFRSTRID
     11960**DCL     14151<<ASSIGN
KV$SSN.OTPBLK
     11963**DCL     14248<<ASSIGN
KV$SSN.REDRQSPND
     11967**DCL     14237>>IF
KV$SSN.REDRSPCNT
     11955**DCL     11956--REDEF
KV$SSN.STR$
     11949**DCL     14038>>ASSIGN  14425>>ASSIGN  14498>>ASSIGN
KV$STR.ID
     12086**DCL     13851>>IF      14036>>IF      14039>>DOWHILE 14151>>ASSIGN
KV$STR.LFTMRGCLM
     12084**DCL     14296>>IF      14299>>ASSIGN  14300<<ASSIGN
KV$STR.LNK$
     12026**DCL     14040>>IF      14041>>ASSIGN  14418>>ASSIGN  14501>>IF      14501>>ASSIGN
KV$STR.MVD$
     12026**DCL     14043>>ASSIGN  14429>>ASSIGN
KV$STR.RE_RED
     12086**DCL     14508>>IF
KV$TITLE
     12520**DCL     14094--ASSIGN
KV$TITLE.INDCLM
     12535**DCL     14096>>IF      14096<<ASSIGN
KV$TITLE.RSTPAGNMB
     12535**DCL     14097>>IF      14099<<ASSIGN
KV$TITLE.TXTSIZ
     12536**DCL     12536--REDEF   14094>>ASSIGN
KV$TRNTBL.FNTCLS
     12693**DCL     14132>>IF      14132>>IF      14197>>IF      14197>>IF      14708>>IF      14708>>IF
KV$TRNTBL.LNK$
     12677**DCL     14195>>DOWHILE 14196>>ASSIGN
KV$TRNTBL.OTPESCCHR
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:212  
     12691**DCL     12691--REDEF
KV$TRNTBL.PRTAPL
     12694**DCL     14197>>IF      14197>>IF      14197>>IF
KV$USRPRM.SETPRMPREPRC
     13041**DCL     14051>>IF
KV$USRPRM.SETPRMPSTPRC
     13050**DCL     14393>>IF
KV$USRPRM.TRNTBLHEDPTR$
     13058**DCL     14193>>ASSIGN
KV$USR_DAT
     13162**DCL     14172<<ASSIGN
KV$USR_DAT.DATMOD
     13190**DCL     14174<<ASSIGN
KV$USR_DAT.DAT__
     13216**DCL     14173<<ASSIGN
KV$VDH_GETBFR
     12791**DCL     14085<<ASSIGN  14886<<ASSIGN
KV$VDH_GETBFR.BFR$
     12797**DCL     14122>>ASSIGN  14898>>ASSIGN  14901>>ASSIGN
KV$VDH_GETBFR.BYTSIZ
     12797**DCL     14142>>ASSIGN  14890<<ASSIGN  14891<<ASSIGN  14893>>IF      14897>>ASSIGN  14902>>ASSIGN
KV$VDH_GETBFR.DAT_
     12823**DCL     14088<<ASSIGN
KV$VDH_GETBFR.DAT_.BYTSIZ
     12825**DCL     14094<<ASSIGN  14114<<ASSIGN  14145>>ASSIGN
KV$VDH_GETBFR.SCRNO_MMR
     12801**DCL     14888<<ASSIGN
KV$VDH_GETBFR.SHRBFR.ADD
     12799**DCL     14112<<ASSIGN
KV$VDH_GETBFR.SHRBFR.GET
     12798**DCL     14113<<ASSIGN
KV$VDH_GETBFR.STRTYP
     12797**DCL     14086<<ASSIGN  14109>>IF      14109>>IF      14115>>IF      14117<<ASSIGN  14124>>IF
     14887<<ASSIGN
KV$VDH_GETPRM.BFRHED$
     13635**DCL     14877--ASSIGN  14881--IF      14892>>IF
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:213  
KV$VDH_GETPRM.BFRLMTEXC
     13608**DCL     14477<<ASSIGN  14514<<ASSIGN
KV$VDH_GETPRM.DATBYTSIZ
     13635**DCL     14868>>IF      14870>>ASSIGN  14872<<ASSIGN  14872>>ASSIGN
KV$VDH_GETPRM.MAXBYTSIZ
     13635**DCL     13635--REDEF   14889>>IF      14890>>ASSIGN
KV$VDH_GETPRM.PRMID
     13608**DCL     14457>>ASSIGN
KV$VDH_GETPRM.VAL
     13608**DCL     14484<<ASSIGN
KV$VDH_GETPRM.VAL_
     13630**DCL     14473<<ASSIGN
KV$VDH_GETPRM.VAL_.ADR$
     13632**DCL     14472>>IF      14865>>IF      14870>>ASSIGN
KV$VDH_GETPRM.VAL_.BYTSIZ
     13632**DCL     14868>>IF
KV$VDH_GETPRM.VAL_.BYTX
     13632**DCL     14870>>ASSIGN
KV$VDH_OTPLCL
     12938**DCL     14168<<ASSIGN
KV$VDH_OTPLCL.BFR_
     12969**DCL     14169<<ASSIGN
KV$VDH_RLSBFR.BFR$
     13008**DCL     14128<<ASSIGN  14132>>IF      14134<<ASSIGN  14137>>IF      14149<<ASSIGN  14155>>IF
KV$VDH_RLSBFR.BYTSIZ
     13008**DCL     14143<<ASSIGN
KV$VDH_RLSBFR.STRTYP
     13008**DCL     14129>>IF      14139>>IF
KV$VDH_SETPRM
     13540**DCL     13783>>ASSIGN
KV$VDH_SETPRM.PRMID
     13546**DCL     13786>>IF
KV$VDH_XXXPRM
     13512**DCL         8--PROC    13540--REDEF   13602--REDEF   13778--ENTRY   14455--ENTRY
KV$VDI.CHN$
     11876**DCL     14712>>IF      14714>>IF      14714>>IF      14717>>IF      14718>>ASSIGN  14721>>IF
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:214  
     14725>>ASSIGN  14733>>ASSIGN
KV$VDI.INPUNT
     11917**DCL     14376>>IF
KV$VDI.RQSOTP
     11912**DCL     14243<<ASSIGN
KV$VDI.UN_KNWPST
     11915**DCL     14374<<ASSIGN
KV$VDI.USEOTPBFRTRN
     11917**DCL     14167>>IF
KV$VDI.USREVTENB
     11919**DCL     13780>>IF      13893>>IF
KV$VDI.USRPRM$
     11877**DCL     14051>>IF      14193>>ASSIGN  14393>>IF
KVC$DRWBRD
     13485**DCL-ENT 13839--CALL
KVC$WINDOW1
     13486**DCL-ENT 13844--CALL
KVC$WINDOW2
     13487**DCL-ENT 13838--CALL
KVE$FIXHRZSCR
     13488**DCL-ENT 14252--CALL
KVE$PST
     13489**DCL-ENT 13853--CALL
KVI$NEWINPFNCTBL
     13490**DCL-ENT 14235--CALL
KVM$SND
     13491**DCL-ENT 14249--CALL
KVO$OTP1_VRT
     13492**DCL-ENT 14238--CALL
KVO$OTPLCL
     13493**DCL-ENT 14170--CALL
KVP$FNCKEY
     13494**DCL-ENT 14163--CALL
KVP_PRMID
     11776**DCL     14926<>CALL
KVS$GETBFR
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:215  
     13495**DCL-ENT 14121--CALL    14896--CALL
KVS$RLSBFR
     13496**DCL-ENT 14155--CALL
KVS$SETSTR
     13497**DCL-ENT 13843--CALL
KVV$CALUSR
     13498**DCL-ENT 14053--CALL    14175--CALL    14395--CALL    14703--CALL
KVV$CALUSR_EVT
     13499**DCL-ENT 13781--CALL    13894--CALL
KV_BFRLNG
     11723**DCL     14076>>IF      14077>>ASSIGN  14077>>ASSIGN  14082>>IF      14687>>ASSIGN
KV_BFRLNGS
     11723**DCL     11723--REDEF
KV_BFRTYP
     11724**DCL     14086>>ASSIGN
KV_BFRTYPS
     11724**DCL     11724--REDEF
KV_GETPRM IN PROCEDURE GETSPACE
     14823**DCL     14900>>ASSIGN
KV_MAX
     11722**DCL     14065>>IF
KV_MAXS
     11722**DCL     11722--REDEF
KV_MIN
     11721**DCL     14065>>IF
KV_MINS
     11721**DCL     11721--REDEF
KV_PRMTBL.IDS
     11712**DCL     13803>>CALLBLT 14029>>CALLBLT 14464>>CALLBLT 14469>>ASSIGN  14670>>CALLBLT
KV_PRMTBL.INDX
     11715**DCL     13809>>ASSIGN  14031>>ASSIGN  14491>>ASSIGN  14606>>ASSIGN  14673>>ASSIGN
KV_PRMTBL.INDXS
     11714**DCL     11715--REDEF
KV_PRMTBL.TYPE
     11714**DCL     13805>>IF      14030>>ASSIGN  14465>>IF      14465>>IF      14488>>IF      14605>>IF
     14672>>ASSIGN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:216  
KV_PRMTBL.TYPES
     11714**DCL     11714--REDEF
KV_PTR_OFFSETS
     11746**DCL     14055>>ASSIGN  14674>>ASSIGN
KV_SND_RQSDAT_GNR
     12698**DCL     14249<>CALL
KV_STR.OFFSET
     11729**DCL     13814>>ASSIGN  14511>>ASSIGN  14526>>ASSIGN  14547>>IF      14548>>ASSIGN  14564>>ASSIGN
     14612>>ASSIGN  14859>>ASSIGN
KV_STR.TYPE
     11729**DCL     13815>>DOCASE  13860>>ASSIGN  13865>>ASSIGN  14520>>IF      14534>>DOSELCT 14549>>DOCASE
     14592>>ASSIGN  14594>>ASSIGN  14854>>DOWHILE
KV_STRID
     11729**DCL     13812>>ASSIGN  14492>>IF      14508>>IF      14518>>ASSIGN  14524>>ASSIGN  14525>>IF
     14611>>ASSIGN  14857>>ASSIGN  14912>>ASSIGN
KV_STRIDS
     11729**DCL     11729--REDEF
KV_STRS
     11728**DCL     11728--REDEF
KV_USR_DAT
     13078**DCL     14172>>ASSIGN
KV_VDH_GETBFR
     12726**DCL     14085>>ASSIGN  14886>>ASSIGN
KV_VDH_OTPLCL_TRN
     12865**DCL     14168>>ASSIGN
KV_WHERE.OFFSET
     11718**DCL     14035>>ASSIGN  14676>>ASSIGN
KV_WHERE.STRUCTURE
     11718**DCL     14032>>ASSIGN  14674>>ASSIGN
KV_WHERES
     11715**DCL     11718--REDEF
KV_WHROFFS
     11718**DCL     14032>>ASSIGN  14035>>ASSIGN  14673>>ASSIGN  14687>>ASSIGN
L IN PROCEDURE GETSPACE
     14764**DCL     14897<<ASSIGN  14898>>ASSIGN  14904<<ASSIGN  14905>>ASSIGN
MASKS
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:217  
     11745**DCL     13865>>ASSIGN  14592>>ASSIGN
MAXBYTX
     13766**DCL     13767--REDEF   13784<<ASSIGN  13785>>DOWHILE 13800<<ASSIGN  13887>>IF
NO_PARM
     13881**LABEL   13817--GOTO    13830--GOTO    13840--GOTO    13852--GOTO    13868--GOTO    13874--GOTO
NO_STUFF IN PROCEDURE SETPTR
     14440**LABEL   14029--CALLALT 14040--GOTO    14053--CALLALT 14057--GOTO    14066--GOTO    14076--GOTO
     14083--GOTO    14121--CALLALT 14125--GOTO    14401--GOTO    14410--GOTO    14416--GOTO    14420--GOTO
     14423--GOTO
NXTMLT
     14610**LABEL   14483--GOTO    14505--GOTO    14509--GOTO    14607--GOTO
OFFSET
     13765**DCL     13814<<ASSIGN  13817>>IF      13821>>IF      13823>>IF      13827>>IF      13834>>ASSIGN
     13856>>ASSIGN  13859>>ASSIGN  13860<<ASSIGN  13860>>ASSIGN  13861>>DOWHILE 13863<<ASSIGN  13863>>ASSIGN
     13868>>IF      13869>>ASSIGN  13870>>ASSIGN  13872>>ASSIGN  13873>>ASSIGN  14475<<ASSIGN  14480>>ASSIGN
     14480>>ASSIGN  14511<<ASSIGN  14547<<ASSIGN  14548<<ASSIGN  14551>>ASSIGN  14552>>ASSIGN  14555>>ASSIGN
     14556>>ASSIGN  14560>>ASSIGN  14562>>ASSIGN  14564<<ASSIGN  14567>>ASSIGN  14571>>ASSIGN  14588>>ASSIGN
     14594<<ASSIGN  14594>>ASSIGN  14595>>DOWHILE 14597<<ASSIGN  14597>>ASSIGN  14599<<ASSIGN  14599>>ASSIGN
     14600>>ASSIGN  14600>>ASSIGN  14766--IMP-SIZ 14852>>IF      14859<<ASSIGN  14861>>IF      14861<<ASSIGN
     14861>>ASSIGN  14862<<ASSIGN  14862>>ASSIGN  14863>>ASSIGN  14868>>IF      14881>>IF      14893>>IF
     14911<<ASSIGN  14911>>ASSIGN  14913>>ASSIGN  14914>>IF      14915<<ASSIGN  14915>>ASSIGN  14918>>ASSIGN
     14923>>ASSIGN
OFFSET IN PROCEDURE GETPRM
     14628**DCL     14676<<ASSIGN  14679>>IF      14681>>ASSIGN  14683>>ASSIGN  14686>>ASSIGN  14689>>ASSIGN
     14695>>ASSIGN  14696>>ASSIGN
OFFSET IN PROCEDURE SETPTR
     13905**DCL     14035<<ASSIGN  14061>>IF      14062>>ASSIGN  14063>>ASSIGN  14068>>ASSIGN  14069>>ASSIGN
     14072>>ASSIGN  14073>>ASSIGN  14077>>ASSIGN  14118<<ASSIGN  14118>>ASSIGN  14127>>ASSIGN  14142<<ASSIGN
     14144>>ASSIGN  14153<<ASSIGN  14153>>ASSIGN  14154>>ASSIGN  14257>>ASSIGN  14267<<ASSIGN  14273>>ASSIGN
     14279>>ASSIGN  14285>>ASSIGN  14288>>ASSIGN  14288>>ASSIGN  14295<<ASSIGN  14296>>IF      14296>>IF
     14296>>IF      14296>>IF      14298>>ASSIGN  14299>>ASSIGN  14300>>ASSIGN  14314<<ASSIGN  14315<<ASSIGN
     14315>>ASSIGN  14316<<ASSIGN  14316>>ASSIGN  14317>>IF      14318<<ASSIGN  14321>>ASSIGN  14322<<ASSIGN
     14322>>ASSIGN  14323>>IF      14323<<ASSIGN  14325>>IF      14325>>ASSIGN  14329<<ASSIGN  14330>>ASSIGN
     14331>>IF      14335<<ASSIGN  14336>>ASSIGN  14337>>IF      14338<<ASSIGN  14339>>ASSIGN  14346<<ASSIGN
     14347>>IF      14348>>ASSIGN  14349>>ASSIGN  14350>>ASSIGN  14351>>IF      14353>>ASSIGN  14354>>ASSIGN
OLDVAL IN PROCEDURE SETPTR
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:218  
     14024**DCL     14058<<ASSIGN  14061<<ASSIGN  14068<<ASSIGN  14072<<ASSIGN  14084<<ASSIGN  14103<<ASSIGN
     14104>>IF      14104>>IF      14106>>ASSIGN  14137<<ASSIGN  14137>>ASSIGN  14162<<ASSIGN  14165<<ASSIGN
     14179>>IF      14233>>ASSIGN  14237>>IF      14243>>IF      14268<<ASSIGN  14273>>ASSIGN  14285>>ASSIGN
     14286<<ASSIGN  14286>>ASSIGN  14287>>IF      14288>>ASSIGN  14292>>IF      14306>>ASSIGN  14307>>ASSIGN
     14331>>IF      14332<<ASSIGN  14347>>IF      14357>>IF      14363>>IF      14366>>IF
PRM$ IN PROCEDURE GETPRM
     14625**DCL     14674<<ASSIGN  14675>>IF      14679>>IF      14681>>ASSIGN  14683>>ASSIGN  14685>>ASSIGN
     14689>>ASSIGN  14695>>ASSIGN  14696>>ASSIGN
PRMID IN PROCEDURE GETPRM
     14626**DCL     14670<<CALLBLT 14672>>ASSIGN  14673<<ASSIGN  14673>>ASSIGN  14674>>ASSIGN  14676>>ASSIGN
     14687>>ASSIGN
PRMID IN PROCEDURE SETPTR
     13903**DCL     14029<<CALLBLT 14030>>ASSIGN  14031<<ASSIGN  14031>>ASSIGN  14032>>ASSIGN  14035>>ASSIGN
     14065>>IF      14065>>IF      14076>>IF      14077>>ASSIGN  14077>>ASSIGN  14082>>IF      14086>>ASSIGN
PRMTYP IN PROCEDURE GETPRM
     14627**DCL     14672<<ASSIGN  14673>>ASSIGN  14677>>DOCASE
PRMTYP IN PROCEDURE SETPTR
     13904**DCL     14030<<ASSIGN  14032>>ASSIGN  14035>>ASSIGN  14059>>DOCASE  14067>>IF
PRM_ABSGRPRND.GRPRND IN PROCEDURE SETPTR
     13973**DCL     13979--REDEF   14160>>ASSIGN
PRM_ABSGRPRND.ID IN PROCEDURE SETPTR
     13950**DCL     14160>>ASSIGN
PT.R
     13508**DCL     14056>>ASSIGN  14128>>ASSIGN  14135>>ASSIGN  14138<<ASSIGN  14674>>ASSIGN  14689>>ASSIGN
SAV_PTR IN PROCEDURE SETPTR
     14002**DCL     14026<<ASSIGN  14444>>ASSIGN
SAV_PTR.INPCNDPND IN PROCEDURE SETPTR
     14008**DCL     14017--REDEF   14021--REDEF
SAV_PTR.LINLST$ IN PROCEDURE SETPTR
     14004**DCL     14005--REDEF
SCREECH
     14926**LABEL   13887--GOTO    14464--CALLALT
SETLNG IN PROCEDURE SETPTR
     14337**LABEL   14269--GOTO    14333--GOTO
SETPST IN PROCEDURE SETPTR
     14366**LABEL   14292--GOTO    14357--GOTO    14363--GOTO
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:219  
SETPTR
     13901**PROC    13871--CALL    13877--CALL    13885--CALL
SETWDT IN PROCEDURE SETPTR
     14310**LABEL   14301--GOTO    14310--GOTO
SET_THROT IN PROCEDURE SETPTR
     14245**LABEL   14241--GOTO    14245--GOTO
STR$
     13637**DCL     13456--IMP-PTR 13501--IMP-PTR 13503--IMP-PTR 13505--IMP-PTR 13810<<ASSIGN  13817>>IF
     13821>>IF      13823>>IF      13827>>IF      13834>>ASSIGN  13838>>CALL    13844>>CALL    13856>>ASSIGN
     13859>>ASSIGN  14458<<ASSIGN  14480>>ASSIGN  14526>>ASSIGN  14547>>IF      14551>>ASSIGN  14552>>ASSIGN
     14555>>ASSIGN  14556>>ASSIGN  14560>>ASSIGN  14562>>ASSIGN  14567>>ASSIGN  14571>>ASSIGN  14574>>ASSIGN
     14575>>ASSIGN  14582>>ASSIGN  14583>>ASSIGN  14584>>ASSIGN  14585>>ASSIGN  14588>>ASSIGN  14600>>ASSIGN
     14600>>ASSIGN  14765--IMP-PTR 14870<<ASSIGN  14905<<ASSIGN  14912>>ASSIGN  14913>>ASSIGN  14916>>ASSIGN
     14916>>ASSIGN  14917>>ASSIGN  14918>>ASSIGN  14919<<ASSIGN  14919>>ASSIGN  14921<<ASSIGN  14921>>ASSIGN
     14923>>ASSIGN
STR$ IN PROCEDURE SETPTR
     13902**DCL     13926--IMP-PTR 13948--IMP-PTR 14056<<ASSIGN  14057>>IF      14061>>IF      14062>>ASSIGN
     14063>>ASSIGN  14068>>ASSIGN  14069>>ASSIGN  14072>>ASSIGN  14073>>ASSIGN  14077>>ASSIGN  14127<<ASSIGN
     14127>>ASSIGN  14128>>ASSIGN  14135>>ASSIGN  14138>>ASSIGN  14143>>ASSIGN  14144>>ASSIGN  14145>>ASSIGN
     14146>>ASSIGN  14147>>ASSIGN  14148>>IF      14150>>ASSIGN  14154<<ASSIGN  14154>>ASSIGN  14159<<ASSIGN
     14160>>ASSIGN  14160>>ASSIGN  14179>>IF      14197>>IF      14197>>IF      14197>>IF      14200>>ASSIGN
     14203>>IF      14203>>IF      14203>>ASSIGN  14204>>ASSIGN  14205>>IF      14206>>IF      14206>>ASSIGN
     14208>>ASSIGN  14209>>ASSIGN  14210>>IF      14210>>IF      14211>>ASSIGN  14212>>ASSIGN  14213>>ASSIGN
     14214>>ASSIGN  14215>>ASSIGN  14216>>ASSIGN  14217>>IF      14218>>ASSIGN  14219>>ASSIGN  14221>>ASSIGN
     14222>>ASSIGN  14223>>ASSIGN  14225>>ASSIGN  14226>>ASSIGN  14227>>ASSIGN  14228>>ASSIGN  14229>>ASSIGN
     14230>>ASSIGN  14232>>IF      14233>>ASSIGN  14240<<ASSIGN  14244<<ASSIGN  14248>>ASSIGN  14251>>IF
     14252>>IF      14253>>ASSIGN  14255>>IF      14257>>ASSIGN  14260>>IF      14260>>IF      14261>>ASSIGN
     14262>>ASSIGN  14273>>ASSIGN  14276>>ASSIGN  14279>>ASSIGN  14285>>ASSIGN  14288>>ASSIGN  14288>>ASSIGN
     14289>>ASSIGN  14292>>IF      14299>>ASSIGN  14300>>ASSIGN  14307>>ASSIGN  14309>>ASSIGN  14313<<ASSIGN
     14314>>ASSIGN  14314>>ASSIGN  14315>>IF      14315>>ASSIGN  14316>>IF      14316>>ASSIGN  14318>>ASSIGN
     14318>>ASSIGN  14319>>ASSIGN  14319>>ASSIGN  14321>>ASSIGN  14321>>ASSIGN  14322>>IF      14322>>ASSIGN
     14326>>ASSIGN  14327>>ASSIGN  14327>>ASSIGN  14327>>ASSIGN  14329>>ASSIGN  14330>>ASSIGN  14335>>ASSIGN
     14336>>ASSIGN  14339>>ASSIGN  14340>>ASSIGN  14342>>ASSIGN  14344<<ASSIGN  14345>>IF      14347>>IF
     14347>>IF      14348>>ASSIGN  14349>>ASSIGN  14350>>ASSIGN  14351>>IF      14351>>IF      14351>>IF
     14351>>IF      14353>>ASSIGN  14354>>ASSIGN  14354>>ASSIGN  14355>>ASSIGN  14355>>ASSIGN  14356>>ASSIGN
     14356>>ASSIGN  14356>>ASSIGN  14360>>ASSIGN  14360>>ASSIGN  14361>>ASSIGN  14362>>IF      14362>>ASSIGN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:220  
     14363>>IF      14365<<ASSIGN  14367>>ASSIGN  14368>>ASSIGN  14370>>IF      14370>>ASSIGN  14372>>IF
     14373>>ASSIGN  14375>>IF      14376>>ASSIGN  14377>>ASSIGN  14377>>ASSIGN  14378>>ASSIGN  14378>>ASSIGN
     14379>>ASSIGN  14383>>ASSIGN  14383>>ASSIGN  14384>>IF      14385>>ASSIGN  14386>>ASSIGN  14386>>ASSIGN
     14388>>ASSIGN  14388>>ASSIGN  14389>>ASSIGN  14389>>ASSIGN  14389>>ASSIGN  14390>>IF      14390>>IF
     14390>>IF      14391>>ASSIGN  14391>>ASSIGN
STRLST
     13767**DCL     14460<<ASSIGN  14472>>IF      14483>>IF      14492>>IF      14609>>IF      14861>>IF
     14908>>IF
STRLST.INDX
     13768**DCL     14508>>IF      14606<<ASSIGN  14610<<ASSIGN  14610>>ASSIGN  14611>>ASSIGN  14612>>ASSIGN
     14912>>ASSIGN
STRLST.SKPCNT
     13769**DCL     14530>>IF      14533<<ASSIGN  14533>>ASSIGN  14612<<ASSIGN
STRUCTURE IN PROCEDURE SETPTR
     13906**DCL     14032<<ASSIGN  14033>>IF      14055>>ASSIGN  14397>>IF      14399>>IF      14418>>IF
     14422>>IF      14427>>IF      14431>>IF      14435>>IF      14439>>IF      14440>>IF
STR_BIT
     13820**LABEL   13818--GOTO
STR_BYTE
     13834**LABEL   13832--GOTO
STR_LOOP
     13811**LABEL   13824--EXIT    13845--EXIT    13849--EXIT    13854--EXIT
TEMP
     13770**DCL     13802<<ASSIGN  13803>>CALLBLT 14028<<ASSIGN  14029>>CALLBLT 14463<<ASSIGN  14464>>CALLBLT
     14669<<ASSIGN  14670>>CALLBLT
TEMP$
     13638**DCL     13265--IMP-PTR 13507--IMP-PTR 14055<<ASSIGN  14056>>ASSIGN  14089<<ASSIGN  14094>>ASSIGN
     14096>>IF      14096>>ASSIGN  14097>>IF      14099>>ASSIGN  14103>>ASSIGN  14104>>IF      14106>>ASSIGN
     14107>>IF      14107>>ASSIGN  14122<<ASSIGN  14126<<ASSIGN  14132>>IF      14134>>ASSIGN  14135<<ASSIGN
     14137>>IF      14138>>ASSIGN  14193<<ASSIGN  14194>>IF      14195>>DOWHILE 14196<<ASSIGN  14196>>ASSIGN
     14197>>IF      14197>>IF      14197>>IF      14200>>ASSIGN  14208>>IF      14208>>IF      14210>>IF
     14213>>IF      14213>>IF      14215>>IF      14215>>IF      14221>>IF      14221>>IF      14223>>ASSIGN
     14224>>IF      14224>>IF      14227>>IF      14229>>IF      14398<<ASSIGN  14398<<ASSIGN  14400>>IF
     14409>>IF      14415>>IF      14418<<ASSIGN  14419>>IF      14422<<ASSIGN  14423>>IF      14424>>ASSIGN
     14425<<ASSIGN  14428>>ASSIGN  14429<<ASSIGN  14432>>ASSIGN  14433<<ASSIGN  14436>>ASSIGN  14437<<ASSIGN
     14439>>ASSIGN  14440>>IF      14459<<ASSIGN  14496>>IF      14497<<ASSIGN  14503>>ASSIGN  14504<<ASSIGN
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:221  
     14513>>IF      14513>>ASSIGN  14610>>IF      14616>>IF      14616>>ASSIGN
USR_SETPRM
     13728**DCL     14053<>CALL    14395<>CALL
USR_SETPRM.FNC
     13732**DCL     14050<<ASSIGN
USR_SETPRM.PREPRC
     13734**DCL     14052<<ASSIGN  14394<<ASSIGN
VDH_SETPRM
     13666**DCL     13728--REDEF   13783<<ASSIGN  14163<>CALL    14703<>CALL
VDH_SETPRM.DMN
     13699**DCL     13804<<ASSIGN  13851>>IF      13879<<ASSIGN  13880<<ASSIGN  14036>>IF      14036>>IF
     14039>>DOWHILE 14397>>IF
VDH_SETPRM.FNC
     13670**DCL     14702<<ASSIGN
VDH_SETPRM.PRMID
     13672**DCL     13788<<ASSIGN  13793>>IF      13794<<ASSIGN  13802>>ASSIGN  13812<<ASSIGN  13813>>IF
     13824>>IF      13828>>IF      13836>>DOSELCT 13876>>IF      14028>>ASSIGN  14051>>IF      14092>>IF
     14092>>IF      14102>>IF      14157>>DOSELCT 14179>>IF      14190>>DOCASE  14239>>IF      14393>>IF
     14469<<ASSIGN  14518<<ASSIGN  14519>>IF      14524<<ASSIGN  14530>>IF      14569>>DOSELCT 14669>>ASSIGN
     14691>>IF      14691>>IF      14694>>IF      14705>>DOSELCT 14857<<ASSIGN
VDH_SETPRM.SCP
     13699**DCL     13843>>IF      13847<<ASSIGN  14397>>IF      14401>>IF      14410>>IF      14416>>IF
     14420>>IF
VDH_SETPRM.VAL
     13672**DCL     13792<<ASSIGN  13795>>ASSIGN  13797<<ASSIGN  13808<<ASSIGN  13820<<ASSIGN  13821<<ASSIGN
     13821>>ASSIGN  13823<<ASSIGN  13834<<ASSIGN  13834>>ASSIGN  13856<<ASSIGN  13859<<ASSIGN  13862<<ASSIGN
     13862>>ASSIGN  13865<<ASSIGN  13865>>ASSIGN  13878>>IF      13879>>ASSIGN  13881<<ASSIGN  14062>>IF
     14065>>IF      14065>>IF      14069>>ASSIGN  14073>>ASSIGN  14084>>ASSIGN  14115>>IF      14162>>ASSIGN
     14165>>ASSIGN  14179>>IF      14287>>IF      14288>>ASSIGN  14295>>ASSIGN  14303>>IF      14306<<ASSIGN
     14330>>IF      14331>>IF      14484>>ASSIGN  14536<<ASSIGN  14538<<ASSIGN  14540<<ASSIGN  14551>>IF
     14555>>IF      14558>>IF      14558>>IF      14559<<ASSIGN  14559>>ASSIGN  14567>>ASSIGN  14571>>ASSIGN
     14592<<ASSIGN  14592>>ASSIGN  14596<<ASSIGN  14596>>ASSIGN  14596>>ASSIGN  14600>>ASSIGN  14665<<ASSIGN
     14679<<ASSIGN  14679>>ASSIGN  14681<<ASSIGN  14683<<ASSIGN  14710<<ASSIGN  14710>>ASSIGN  14712<<ASSIGN
     14712>>ASSIGN  14715<<ASSIGN  14715>>ASSIGN  14718<<ASSIGN  14725<<ASSIGN  14728<<ASSIGN  14730>>CALLBLT
     14733<<ASSIGN  14734--ASSIGN  14735--ASSIGN  14736--ASSIGN  14737--ASSIGN
VDH_SETPRM.VAL_
PL6.E3A0      #001=KVP$PRM File=KVP$PRM.:E05TSI                                  WED 07/30/97 02:13 Page:222  
     13694**DCL     14088>>ASSIGN  14169>>ASSIGN  14173>>ASSIGN  14473>>ASSIGN  14666<<ASSIGN
VDH_SETPRM.VAL_.ADR$
     13696**DCL     13788>>ASSIGN  13789>>ASSIGN  13792>>ASSIGN  13797>>ASSIGN  13810>>ASSIGN  14077>>ASSIGN
     14089>>ASSIGN  14159>>ASSIGN  14480>>ASSIGN  14588>>ASSIGN  14685<<ASSIGN  14689<<ASSIGN  14698>>IF
     14699>>ASSIGN  14739<<ASSIGN
VDH_SETPRM.VAL_.BYTSIZ
     13696**DCL     13784>>ASSIGN  13789<<ASSIGN  13794>>ASSIGN  13795<<ASSIGN  13868>>IF      13869<<ASSIGN
     13869>>ASSIGN  13872<<ASSIGN  13872>>ASSIGN  13889>>ASSIGN  14076>>IF      14082>>IF      14083>>IF
     14087>>IF      14166>>IF      14471>>IF      14475>>ASSIGN  14541<<ASSIGN  14588>>ASSIGN  14588>>ASSIGN
     14687<<ASSIGN  14693<<ASSIGN  14696<<ASSIGN  14699<<ASSIGN  14740<<ASSIGN  14859>>ASSIGN
VDH_SETPRM.VAL_.BYTX
     13696**DCL     13784>>ASSIGN  13785>>DOWHILE 13788>>ASSIGN  13789>>ASSIGN  13791<<ASSIGN  13791>>ASSIGN
     13792>>ASSIGN  13796<<ASSIGN  13796>>ASSIGN  13797>>ASSIGN  13810>>ASSIGN  13870<<ASSIGN  13870>>ASSIGN
     13873<<ASSIGN  13873>>ASSIGN  13889<<ASSIGN  13889>>ASSIGN  14077>>ASSIGN  14089>>ASSIGN  14159>>ASSIGN
     14480>>ASSIGN  14588>>ASSIGN  14686<<ASSIGN  14690<<ASSIGN  14695<<ASSIGN
WINDOW.FWINDOW
     13456**DCL     13456--REDEF   13457--REDEF
WINDOW.LENGTH
     13470**DCL     14582<<ASSIGN
WINDOW.ORG_PST.COLUMN
     13471**DCL     14585<<ASSIGN
WINDOW.ORG_PST.LINE
     13471**DCL     14584<<ASSIGN
WINDOW.WIDTH
     13470**DCL     14583<<ASSIGN
WOR.D
     13506**DCL     13792>>ASSIGN  13797>>ASSIGN  13838<>CALL    13844<>CALL    13856>>ASSIGN  13859>>ASSIGN
     14072>>ASSIGN  14073<<ASSIGN  14571<<ASSIGN  14574<<ASSIGN  14575<<ASSIGN  14600<<ASSIGN  14600>>ASSIGN
     14683>>ASSIGN  14916<<ASSIGN  14918<<ASSIGN
