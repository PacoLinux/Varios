VERSION E05

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:1    
        1        1        /*M* DDS$CNSNT - Builds constant frames for LET/IF commands */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F* NAME: DDS$CNSNT
       10       10             PURPOSE: To build constant reference.
       11       11             DESCRIPTION: Pointer to node "CNSNT_REF" is input. The type of
       12       12             constant is determined by using the code of the first returned
       13       13             sub-block. The constant value is converted from textc to the
       14       14             internal representation. If no error condition was encountered
       15       15             then returns, else altreturns. */
       16       16        /*D* NAME: DDS$CNSNT
       17       17             CALL: CALL DDS$CNSNT( N$, WORK, TYPE ) ALTRET( error );
       18       18             INTERFACE: DDS$OCTAL
       19       19                        DDS$DECIMAL
       20       20                        DDS$SDO
       21       21                        XPN_7LSPTOD
       22       22             ENVIRONMENT: DDS$SCAN active.
       23       23             INPUT: N$ - pointer to "CNSNT_REF" node.
       24       24                    WORK - output build buffer.
       25       25             OUTPUT: TYPE - format for for type of constant.
       26       26             SCRATCH: Local auto only.
       27       27             DESCRIPTION: Pointer to node "CNSNT_REF" is input. The type of
       28       28             constant is determined by using the code of the first returned
       29       29             sub-block. The constant value is converted from textc to the
       30       30             internal representation. If no error condition was encountered
       31       31             then returns, else altreturns. */
       32       32
       33       33        DDS$CNSNT: PROC( N$, WORK, TYPE, FMT ) ALTRET;
       34       34
       35       35    1   DCL N$ PTR;
       36       36        %INCLUDE DD$BASED;
       37     1339        %IF$CONST (NAME=WORK,STCLASS=);
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:2    
       38     1377    1   DCL TYPE UBIN;
       39     1378    1   DCL FMT UBIN;
       40     1379    1   DCL V SBIN;
       41     1380    1   DCL A UBIN;
       42     1381    1   DCL H UBIN;
       43     1382    1   DCL NSUB UBIN;
       44     1383    1   DCL NCD UBIN;
       45     1384    1   DCL CODE UBIN;
       46     1385    1   DCL NC$ PTR;
       47     1386    1   DCL NN$ PTR;
       48     1387    1   DCL TNC$ PTR;
       49     1388    1   DCL C CHAR(1);
       50     1389    1   DCL O SBIN;
       51     1390    1   DCL FT$ PTR;
       52     1391    1   DCL FLOAT BIT(72) DALIGNED;
       53     1392    1   DCL FTEXT CHAR(22);
       54     1393    1   DCL FTSIZ UBIN;
       55     1394    1   DCL BITT BIT(1) BASED( BIT$ ) UNAL;
       56     1395    1   DCL OCT UBIN(3) BASED( OCT$ ) UNAL;
       57     1396    1   DCL HEX UBIN(4) BASED( HEX$ ) UNAL;
       58     1397    1   DCL CHAR$1 CHAR(1) BASED UNAL;
       59     1398    1   DCL DECI$MAL CHAR( V ) BASED( DEC$ ) UNAL;
       60     1399    1   DCL 1 CHAR$T1 BASED UNAL,
       61     1400    1         2 * CHAR(1) UNAL,
       62     1401    1         2 ODIG CHAR(1) UNAL;
       63     1402        %TEXT$C;
       64     1407    1   DCL BIT$ PTR;
       65     1408    1   DCL OCT$ PTR;
       66     1409    1   DCL HEX$ PTR;
       67     1410    1   DCL DEC$ PTR;
       68     1411    1   DCL IX UBIN;
       69     1412    1   DCL HELP UBIN;                          /* Kludge for pointer do case */
       70     1413    1   DCL GOTDOT BIT(1) ALIGNED;
       71     1414        %INCLUDE XU_MACRO_C;
       72     4520        %PARSE$OUT (NAME=POB,STCLASS=BASED,NSUBLKS=NSB);
       73     4565        %INCLUDE XUH_MACRO_C;
       74     4649        %INCLUDE DD_SD_M;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:3    
       75     5985        %S_D;
       76     7303    1   DCL DDS$OCTAL ENTRY(2) ALTRET;
       77     7304    1   DCL DDS$HEX ENTRY(2) ALTRET;
       78     7305    1   DCL DDS$DECIMAL ENTRY(2) ALTRET;
       79     7306    1   DCL DDS$SDO ENTRY(2) ALTRET;
       80     7307    1   DCL XPN_7LSPTOD ENTRY(4) ALTRET;
       81     7308        %INCLUDE DD$DITEM;
       12+    7411             %LIST;
       13+    7412    1        DCL SDD$ PTR;
       14+    7413    1        DCL ZITEM$ PTR;
       15+    7414    1        DCL SDD_L6$ PTR;
       16+    7415    1        DCL ZITEM_L6$ PTR;
       82     7989        %INCLUDE DD_ERR_C;
       83     8386        %INCLUDE DD_PSUBS_C;
       84     8861
       85     8862    1        WORK = '0'B;
       86     8863    1        NN$ = N$ -> POB.SUBLK$( 0 );
       87     8864    1        CODE = NN$ -> POB.CODE;
       88     8865
       89     8866    2        DO CASE ( CODE );
       90     8867
       91     8868        /* Quote string constants - 'string'B,O,C | C,O,X'string' */
       92     8869
       93     8870    2          CASE ( 200,                /* CNR1_CODE */
       94     8871    2          202 );                     /* CNR3_CODE */
       95     8872    2             NCD = 472 ;              /* C@SPECC - default */
       96     8873    2             NSUB = NN$ -> POB.NSB - 1;
       97     8874    2             IF ( NSUB = 1 )               /* Really 2 */
       98     8875    2             THEN IF ( CODE = 202 )  /* CNR3_CODE */
       99     8876    3                  THEN DO;
      100     8877    3                       NCD = NN$ -> POB.SUBLK$( 0 ) -> POB.CODE;
      101     8878    3                       NC$ = NN$ -> POB.SUBLK$( 1 ) -> POB.SUBLK$( 0 );
      102     8879    3                     END;
      103     8880    3                  ELSE DO;
      104     8881    3                       NCD = NN$ -> POB.SUBLK$( 1 ) -> POB.CODE;
      105     8882    3                       NC$ = NN$ -> POB.SUBLK$( 0 ) -> POB.SUBLK$( 0 );
      106     8883    3                     END;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:4    
      107     8884    2             ELSE NC$ = NN$ -> POB.SUBLK$( 0 ) -> POB.SUBLK$( 0 );
      108     8885    2             V = NC$ -> TEXT$C.SIZE;
      109     8886    3             DO CASE( NCD );
      110     8887
      111     8888    3               CASE ( 470 );          /* C@FPSECB - Bit string */
      112     8889    3                  TYPE = %BIT_FMT;         /* BIT_FMT */
      113     8890    3                  IF ( V > LENGTHB( WORK.BITS.TRING ) ) THEN GOTO CONSTOOBIG;
      114     8891    3                  WORK.SIZE = V;
      115     8892    3                  WORK.BITS.TRING = '0'B;
      116     8893    3                  BIT$ = ADDR( WORK.BITS.TRING );
      117     8894    4                  DO IX = 1 TO V;
      118     8895    4                       C = SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 );
      119     8896    4                       IF ( C = '0' )
      120     8897    5                       THEN DO;            /* Zilch */
      121     8898    5                          END;
      122     8899    4                       ELSE IF ( C = '1' )
      123     8900    4                            THEN BITT = '1'B;
      124     8901    4                            ELSE GOTO BADDIG;
      125     8902    4                       BIT$ = PINCRB( BIT$, LENGTHB( BITT ) );
      126     8903    4                     END;                  /* "DO IX" */
      127     8904
      128     8905    3               CASE ( 471 );          /* C@FSPECO - Octal bit string */
      129     8906    3                  TYPE = %OBIT_FMT;        /* OBIT_FMT */
      130     8907    3                  IF ( V > LENGTHB( WORK.BITS.TRING ) / 3 ) THEN GOTO CONSTOOBIG;
      131     8908    3                  WORK.SIZE = V * 3;
      132     8909    3                  WORK.BITS.TRING = '0'B;
      133     8910    3                  OCT$ = ADDR( WORK.BITS.TRING );
      134     8911    4                  DO IX = 1 TO V;
      135     8912    4                       O = ASCBIN( SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 ) ) - ASCBIN(
              8912                                '0' );
      136     8913    4                       IF ( O < 0 ) OR ( O > 7 ) THEN GOTO BADDIG;
      137     8914    4                       OCT = O;
      138     8915    4                       OCT$ = PINCRB( OCT$, LENGTHB( OCT ) );
      139     8916    4                     END;                  /* "DO IX" */
      140     8917
      141     8918    3               CASE ( 472 );          /* C@FSPECC - Character string */
      142     8919    3                  TYPE = %CHAR_FMT;        /* CHAR_FMT */
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:5    
      143     8920    3                  IF ( V > LENGTHC( WORK.TEXT ) ) THEN GOTO CONSTOOBIG;
      144     8921    3                  WORK.SIZE = V;
      145     8922    3                  WORK.TEXT = NC$ -> TEXT$C.TXT;
      146     8923
      147     8924    3               CASE ( 473 );         /* C@FSPECOF - FORTRAN octal */
      148     8925    3                  TYPE = %OFORT_FMT;       /* OFORT_FMT */
      149     8926    3                  IF ( V > 12 ) THEN GOTO CONSTOOBIG;
      150     8927    3                  WORK.SIZE = SIZEB( WORK.CONS.TANT );
      151     8928    3                  A = 0;
      152     8929    4                  DO IX = 1 TO V;
      153     8930    4                       O = ASCBIN( SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 ) ) - ASCBIN(
              8930                                '0' );
      154     8931    4                       IF ( O < 0 ) OR ( O > 7 ) THEN GOTO BADDIG;
      155     8932    4                       A = ( A * 8 ) + O;
      156     8933    4                     END;
      157     8934    3                  WORK.CONS.TANT = A;
      158     8935
      159     8936    3               CASE ( 474 );          /* C@FPSECX - FORTRAN hexadecimal */
      160     8937    3                  IF CODE = 202      /* CNR3_CODE */
      161     8938    4                  THEN DO;
      162     8939    4                       TYPE = %ZFORT_FMT;  /* ZFORT_FMT */
      163     8940    4                       IF ( V > 9 ) THEN GOTO CONSTOOBIG;
      164     8941    4                       WORK.SIZE = SIZEB( WORK.CONS.TANT );
      165     8942    4                       A = 0;
      166     8943    5                       DO IX = 1 TO V;
      167     8944    5                            C = SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 );
      168     8945    5                            IF ( C >= '0' ) AND ( C <= '9' )
      169     8946    5                            THEN H = ASCBIN( C ) - ASCBIN( '0' );
      170     8947    5                            ELSE IF ( C >= 'A' ) AND ( C <= 'F' )
      171     8948    5                                 THEN H = ASCBIN( C ) - ASCBIN( 'A' ) + 10;
      172     8949    5                                 ELSE GOTO BADDIG;
      173     8950    5                            A = ( A * 16 ) + H;
      174     8951    5                          END;
      175     8952    4                       WORK.CONS.TANT = A;
      176     8953    4                     END;
      177     8954    4                  ELSE DO;
      178     8955    4                       TYPE = %X_FMT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:6    
      179     8956    4                       IF (V > LENGTHB(WORK.BITS.TRING)/4)
      180     8957    4                       THEN GOTO CONSTOOBIG;
      181     8958    4                       WORK.SIZE = V * 4;
      182     8959    4                       WORK.BITS.TRING = '0'B;
      183     8960    4                       HEX$ = ADDR(WORK.BITS.TRING);
      184     8961    5                       DO IX = 1 TO V;
      185     8962    5                            C = SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 );
      186     8963    5                            IF ( C >= '0' ) AND ( C <= '9' )
      187     8964    5                            THEN H = ASCBIN( C ) - ASCBIN( '0' );
      188     8965    5                            ELSE IF ( C >= 'A' ) AND ( C <= 'F' )
      189     8966    5                                 THEN H = ASCBIN( C ) - ASCBIN( 'A' ) + 10;
      190     8967    5                                 ELSE GOTO BADDIG;
      191     8968    5                            HEX = H;
      192     8969    5                            HEX$ = PINCRB(HEX$, LENGTHB(HEX));
      193     8970    5                          END;
      194     8971    4                     END;
      195     8972    3               END;                        /* "DO CASE( NCD )" */
      196     8973        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:7    
      197     8974        /* HOST Pointer constant - .octal-c-b,$Xn  X=LS,AS,PS ; n=decimal,.octal */
      198     8975
      199     8976    2          CASE ( 201 );          /* CNR2HOST_CODE */
      200     8977    2             WORK.SIZE = 36;
      201     8978    2             TYPE = %PTR_FMT;              /* PTR_FMT */
      202     8979    2             NSUB = NN$ -> POB.NSB - 1;
      203     8980    3             DO IX = 0 TO NSUB;
      204     8981    3                  NC$ = NN$ -> POB.SUBLK$( IX );
      205     8982    3                  NCD = NC$ -> POB.CODE;
      206     8983    3                  HELP = IX;
      207     8984    3                  IF NSUB = 4
      208     8985    3                  THEN IF IX > 2
      209     8986    3                       THEN HELP = HELP + 2;
      210     8987    3                       ELSE ;              /* This is not redundant! */
      211     8988    3                  ELSE IF NSUB = 2
      212     8989    3                       THEN IF IX > 0
      213     8990    3                            THEN HELP = HELP + 4;
      214     8991    4                  DO CASE ( HELP );
      215     8992
      216     8993    4                    CASE ( 0 );            /* "OCTIL" */
      217     8994    4                       CALL DDS$OCTAL( NC$, V ) ALTRET( ARET );
      218     8995    4                       IF ( V > BITBIN( '777777'O ) ) THEN GOTO TOOLARGE;
      219     8996    4                       WORK.P.ADR.W = V;
      220     8997
      221     8998    4                    CASE ( 1, 3 );         /* "MINUS" */
      222     8999        /*D* Ignore minus sign */
      223     9000
      224     9001    4                    CASE ( 2 );            /* "ODIG" */
      225     9002    4                       V = ASCBIN( NC$ -> POB.SUBLK$( 0 ) -> CHAR$T1.ODIG ) - ASCBIN(
              9002                                '0' );
      226     9003    4                       IF ( V > 3 ) THEN GOTO TOOLARGE;
      227     9004    4                       WORK.P.ADR.C = V;
      228     9005
      229     9006    4                    CASE ( 4 );            /* "OCTIL1 */
      230     9007    4                       CALL DDS$OCTAL( NC$, V ) ALTRET( ARET );
      231     9008    4                       IF ( V > 8 ) THEN GOTO TOOLARGE;
      232     9009    4                       WORK.P.ADR.B = V;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:8    
      233     9010
      234     9011    4                    CASE ( 5 );            /* "CNR21" */
      235     9012    5                       DO CASE ( NCD );
      236     9013    5                         CASE ( 460 ); V = 3; /* C@$LS */
      237     9014    5                         CASE ( 461 ); V = 0; /* C@$PS */
      238     9015    5                         CASE ( 462 ); V = 2; /* C@$AS */
      239     9016    5                         END;              /* "DO CASE ( NCD )" */
      240     9017    4                       WORK.P.S = V;
      241     9018
      242     9019    4                    CASE ( 6 );            /* "SDO" */
      243     9020    4                       CALL DDS$SDO( NC$, V ) ALTRET( ARET );
      244     9021    4                       IF ( V > BITBIN( '1777'O ) ) THEN GOTO TOOLARGE;
      245     9022    4                       WORK.P.D = V;
      246     9023    4                    END;                   /* "DO CASE( IX )" */
      247     9024    3                END;                       /* "DO IX" */
      248     9025        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:9    
      249     9026        /* L6 Pointer constant - .hex[-.b]  */
      250     9027    2          CASE ( 207 );            /* CNR2L6_CODE */
      251     9028    2             WORK.SIZE = 21;
      252     9029    2             TYPE = %PTR_FMT;
      253     9030    2             NSUB = NN$ -> POB.NSB - 1;
      254     9031    3             DO IX = 0 TO NSUB;
      255     9032    3                  NC$ = NN$ -> POB.SUBLK$( IX );
      256     9033    3                  NCD = NC$ -> POB.CODE;
      257     9034    4                  DO CASE ( IX );
      258     9035    4                    CASE( 0 );             /* "HEXIL" */
      259     9036    4                       CALL DDS$HEX( NC$, V ) ALTRET(ARET);
      260     9037    4                       IF (V > BITBIN('3777777'O))
      261     9038    4                       THEN GOTO TOOLARGE;
      262     9039    4                       WORK.P.ADR6.W = V;
      263     9040    4                    CASE( 1 );             /* "MINUS" */
      264     9041    4                       ;
      265     9042    4                    CASE( 2 );             /* "HEXIL1" */
      266     9043    4                       CALL DDS$HEX( NC$, V ) ALTRET(ARET);
      267     9044    4                       IF (V > 1)
      268     9045    4                       THEN GOTO TOOLARGE;
      269     9046    4                       WORK.P.ADR6.C = V;
      270     9047    4                    END;
      271     9048    3                END;
      272     9049        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:10   
      273     9050        /* COBOL unpacked decimal constant, leading sign */
      274     9051
      275     9052    2          CASE ( 204 );         /* CNR4COBOL_CODE */
      276     9053    2             TYPE = %PUP_FMT;              /* PUP_FMT */
      277     9054    2             IF ADDR(FMT) ~= ADDR(NIL) AND
      278     9055    2               FMT = %FLOAT_FMT            /* FLOAT_FMT */
      279     9056    2             THEN GOTO FLOAT;
      280     9057        /*********WORK.EXP = 0;*********/
      281     9058    2             WORK.TEXT =
              9058                      '+00000000000000000000000000000000000000000000000000000000000000';
      282     9059    2             DEC$ = PINCRC( ADDR( WORK.TEXT ), LENGTHC( WORK.TEXT ) );
      283     9060    2             GOTDOT = '0'B;
      284     9061    2             O = 0;
      285     9062    2             A = 0;
      286     9063    2             NSUB = NN$ -> POB.NSB;
      287     9064    3             DO IX = 1 TO NSUB;
      288     9065    3                  NC$ = NN$ -> POB.SUBLK$( NSUB - IX );
      289     9066    3                  NCD = NC$ -> POB.CODE;
      290     9067    3                  IF NCD = 8        /* DEC_CODE */
      291     9068    4                  THEN DO;
      292     9069    4                       NC$ = NC$ -> POB.SUBLK$( 0 );
      293     9070    4                       V = NC$ -> TEXT$C.SIZE;
      294     9071    4                       A = A + V;
      295     9072    4                       IF A > LENGTHC( WORK.TEXT ) - 1 THEN GOTO TOOLARGE;
      296     9073    4                       DEC$ = PINCRC( DEC$, -V );
      297     9074    4                       DECI$MAL = NC$ -> TEXT$C.TXT;
      298     9075    4                       IF NOT GOTDOT
      299     9076    4                       THEN O = V;
      300     9077    4                     END;
      301     9078    3                  ELSE IF NCD = 80   /* C@PERIOD */
      302     9079    4                       THEN DO;
      303     9080    4                            WORK.EXP = -O;
      304     9081    4                            GOTDOT = '1'B;
      305     9082    4                          END;
      306     9083    3                       ELSE IF NCD = 591 /* MINUS_CODE */
      307     9084    3                            THEN ADDR( WORK.TEXT ) -> CHAR$1 = '-';
      308     9085    3                END;                       /* "DO IX = 1 TO NSUB" */
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:11   
      309     9086        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:12   
      310     9087        /* FORTRAN floating point (real) constant - +/-iiii.ffffD/E+/-eeee */
      311     9088
      312     9089    2          CASE ( 203 );          /* CNR4FORT_CODE */
      313     9090    2             TYPE = %FLOAT_FMT;            /* FLOAT_FMT */
      314     9091    2   FLOAT:    ;
      315     9092    2             WORK.SIZE = SIZEB( WORK.BITS.TRING );
      316     9093    2             FT$ = NN$;
      317     9094    2             CALL REAL_CNSNT ALTRET( ARET );
      318     9095    2             WORK.BITS.TRING = FLOAT;
      319     9096
      320     9097        /* FORTRAN complex constant - (real,real) */
      321     9098
      322     9099    2          CASE ( 205 );              /* CNR5_CODE */
      323     9100    2             TYPE = %CMPXFORT_FMT;         /* CMPXFORT_FMT */
      324     9101    2             WORK.SIZE = SIZEB( WORK.COMP.LEX1 );
      325     9102    2             FT$ = NN$ -> POB.SUBLK$( 0 );
      326     9103    2             CALL REAL_CNSNT ALTRET( ARET );
      327     9104    2             WORK.COMP.LEX1 = FLOAT;
      328     9105    2             FT$ = NN$ -> POB.SUBLK$( 1 );
      329     9106    2             CALL REAL_CNSNT ALTRET( ARET );
      330     9107    2             WORK.COMP.LEX2 = FLOAT;
      331     9108
      332     9109        /* FORTRAN logical constant - TRUE, FALSE, .TRUE., .FALSE. */
      333     9110
      334     9111    2          CASE ( 206 );              /* CNR6_CODE */
      335     9112    2             TYPE = %BIT_FMT;              /* BIT_FMT */
      336     9113    2             WORK.SIZE = 1;
      337     9114    2             IF NN$ -> POB.SUBLK$( 0 ) -> POB.CODE = 90 /* C@TRUE */
      338     9115    2             THEN WORK.BITS.TRING = '1'B;
      339     9116        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:13   
      340     9117        /* Signed decimal or octal constants - +/-decimal, +/-.octal */
      341     9118
      342     9119    2          CASE ( ELSE );                   /* OPMD | OPMO */
      343     9120    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      344     9121    2             THEN WORK.SIZE = SIZEB( WORK.CONS.TANT );
      345     9122    2             ELSE WORK.SIZE = 32;
      346     9123    2             NSUB = N$ -> POB.NSB - 1;
      347     9124    2             NC$ = NN$;
      348     9125    2             NCD = NN$ -> POB.CODE;
      349     9126    2             IF ( NSUB = 1 )               /* Really 2 */
      350     9127    2             THEN NC$ = N$ -> POB.SUBLK$( 1 );
      351     9128    2             IF ( NC$ -> POB.CODE = 8 ) /* DEC_CODE */
      352     9129    3             THEN DO;
      353     9130    3                  IF ( NCD = 590 ) OR ( NCD = 591 ) /* PLUS_CODE, MINUS_CODE */
      354     9131    3                  THEN TYPE = %SINT_FMT;   /* SINT_FMT */
      355     9132    3                  ELSE TYPE = %UINT_FMT;   /* UINT_FMT */
      356     9133    3                  CALL DDS$DECIMAL( NC$, V ) ALTRET( ARET );
      357     9134    3                END;
      358     9135    3             ELSE DO;
      359     9136    3                  TYPE = %OCT_FMT;         /* OCT_FMT */
      360     9137    3                  CALL DDS$OCTAL( NC$, V ) ALTRET( ARET );
      361     9138    3                END;
      362     9139    2             IF ( NCD = 591 )       /* MINUS_CODE */
      363     9140    2             THEN V = -V;
      364     9141    2             WORK.CONS.TANT = V;
      365     9142
      366     9143    2          END;                             /* "DO CASE ( CODE )" */
      367     9144
      368     9145    1        RETURN;
      369     9146
      370     9147    1   BADDIG: S_D.ERROR = 65; GOTO ARET; /* E@BADDIG */
      371     9148    1   CONSTOOBIG: S_D.ERROR = 64; GOTO ARET; /* E@CONSTOOBIG */
      372     9149    1   TOOLARGE: S_D.ERROR = 46;       /* E@TOOLARGE */
      373     9150
      374     9151    1   ARET: ALTRETURN;
      375     9152
      376     9153        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:14   
      377     9154        /*F* NAME: REAL_CNSNT
      378     9155             PURPOSE: To convert text to a FORTRAN floating point constant.
      379     9156             DESCRIPTION: The sign, integer, fraction, and exponent parts are
      380     9157                          processed in turn. The actual conversion is done by
      381     9158                          the common library routine XPN_7LSPTOD. */
      382     9159        /*D* NAME: REAL_CNSNT
      383     9160             CALL: CALL REAL_CNSNT ALTRET( error );
      384     9161             INTERFACE: DDS$DECIMAL
      385     9162                        XPN_7LSPTOD
      386     9163             ENVIRONMENT: DDS$CNSNT active.
      387     9164             INPUT: FT$ - Pointer to "FORT_REAL" node.
      388     9165             OUTPUT: FLOAT - floating point constant.
      389     9166             SCRATCH: O, A, V, FTEXT, FTSIZ, NSUB, IX, NC$, NCD
      390     9167             DESCRIPTION: The sign, integer part & fractional part are picked
      391     9168                          up and packed into FTEXT. The exponent is picked up,
      392     9169                          converted to binary, and adjusted by the number of
      393     9170                          digits in the fractional part. The actual conversion
      394     9171                          is done by XPN_7LSPTOD. */
      395     9172
      396     9173    1   REAL_CNSNT: PROC ALTRET;
      397     9174
      398     9175    2        O = 0;
      399     9176    2        V = 0;
      400     9177    2        FTEXT = '+';
      401     9178    2        FTSIZ = LENGTHC( '+' );
      402     9179    2        NSUB = FT$ -> POB.NSB - 1;
      403     9180    2        IF CODE = 204           /* CNR4COBOL_CODE */
      404     9181    3        THEN DO;
      405     9182    3             IF NSUB < 2
      406     9183    3             THEN GOTO BADCONST;
      407     9184    3             IX = 0;
      408     9185    3             NC$ = FT$ -> POB.SUBLK$( IX );
      409     9186    3             NCD = NC$ -> POB.CODE;
      410     9187    3             IF NCD = 8             /* DEC_CODE */
      411     9188    4             THEN DO;
      412     9189    4                  NC$ = NC$ -> POB.SUBLK$( 0 );
      413     9190    4                  A = FTSIZ + NC$ -> TEXT$C.SIZE;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:15   
      414     9191    4                  IF A > LENGTHC( FTEXT ) THEN GOTO TOOL;
      415     9192    4                  CALL INSERT( FTEXT, FTSIZ, , NC$ -> TEXT$C.TXT);
      416     9193    4                  FTSIZ = A;
      417     9194    4                  IX = IX + 1;
      418     9195    4                END;
      419     9196    3             NC$ = FT$ -> POB.SUBLK$( IX );
      420     9197    3             NCD = NC$ -> POB.CODE;
      421     9198    3             IF NCD ~= 80            /* C@PERIOD */
      422     9199    3             THEN GOTO ARET;
      423     9200    3             IX = IX + 1;
      424     9201    3             NC$ = FT$ -> POB.SUBLK$( IX );
      425     9202    3             NCD = NC$ -> POB.CODE;
      426     9203    3             IF NCD = 8             /* DEC_CODE */
      427     9204    4             THEN DO;
      428     9205    4                  NC$ = NC$ -> POB.SUBLK$( 0 );
      429     9206    4                  O = - NC$ -> TEXT$C.SIZE;
      430     9207    4                  A = FTSIZ - O;
      431     9208    4                  IF A > LENGTHC( FTEXT ) THEN GOTO TOOL;
      432     9209    4                  CALL INSERT( FTEXT, FTSIZ, , NC$ -> TEXT$C.TXT);
      433     9210    4                  FTSIZ = A;
      434     9211    4                END;
      435     9212    3             GOTO COMMON;
      436     9213    3           END;
      437     9214    3        DO IX = 0 TO NSUB;
      438     9215    3             NC$ = FT$ -> POB.SUBLK$( IX );
      439     9216    3             NCD = NC$ -> POB.CODE;
      440     9217    3             IF NCD = 591           /* MINUS_CODE */
      441     9218    3             THEN FTEXT = '-';
      442     9219    3             ELSE IF NCD = 570      /* FORTI_CODE */
      443     9220    4                  THEN DO;
      444     9221    4                       NC$ = NC$ -> POB.SUBLK$( 0 ) -> POB.SUBLK$( 0 );
      445     9222    4                       A = FTSIZ + NC$ -> TEXT$C.SIZE;
      446     9223    4                       IF A > LENGTHC( FTEXT ) THEN GOTO TOOL;
      447     9224    4                       CALL INSERT( FTEXT, FTSIZ, , NC$ -> TEXT$C.TXT );
      448     9225    4                       FTSIZ = A;
      449     9226    4                     END;
      450     9227    3                  ELSE IF NCD = 571 /* FORTF_CODE */
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:16   
      451     9228    4                       THEN DO;
      452     9229    4                            NC$ = NC$ -> POB.SUBLK$( 0 ) -> POB.SUBLK$( 0 );
      453     9230    4                            O = -NC$ -> TEXT$C.SIZE;
      454     9231    4                            A = FTSIZ - O;
      455     9232    4                            IF A > LENGTHC( FTEXT ) THEN GOTO TOOL;
      456     9233    4                            CALL INSERT( FTEXT, FTSIZ, , NC$ -> TEXT$C.TXT );
      457     9234    4                            FTSIZ = A;
      458     9235    4                          END;
      459     9236    3                       ELSE IF NCD = 572 /* FORTE_CODE */
      460     9237    4                            THEN DO;
      461     9238    4                                 V = 1;
      462     9239    4                                 IF NC$ -> POB.NSB > 1
      463     9240    5                                 THEN DO;
      464     9241    5                                      IF NC$ -> POB.SUBLK$( 0 ) -> POB.CODE = 591
              9241                                               /* MINUS_CODE */
      465     9242    5                                      THEN V = -1;
      466     9243    5                                      NC$ = NC$ -> POB.SUBLK$( 1 );
      467     9244    5                                    END;
      468     9245    4                                 ELSE NC$ = NC$ -> POB.SUBLK$( 0 );
      469     9246    4                                 CALL DDS$DECIMAL( NC$, A ) ALTRET( ARET );
      470     9247    4                                 V = V * A;
      471     9248    4                               END;
      472     9249    3           END;
      473     9250
      474     9251    2   COMMON: ;
      475     9252    2        O = O + V;
      476     9253    2        FTSIZ = FTSIZ - 1;                 /* Number of digits */
      477     9254    2        CALL XPN_7LSPTOD( FLOAT, FTEXT, FTSIZ, O ) ALTRET( XPNA );
      478     9255
      479     9256    2        RETURN;
      480     9257
      481     9258    2   TOOL: S_D.ERROR = 46; GOTO ARET; /* E@TOOLARGE */
      482     9259    2   BADCONST: S_D.ERROR = 293; GOTO ARET; /* E@BAD_CONSTANT */
      483     9260    2   XPNA: S_D.ERROR = 199;           /* E@FORTREAL */
      484     9261
      485     9262    2   ARET: ALTRETURN;
      486     9263
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:17   
      487     9264    2   END REAL_CNSNT;
      488     9265
      489     9266    1   END DDS$CNSNT;

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:18   
--  Include file information  --

   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDS$CNSNT.

   Procedure DDS$CNSNT requires 1011 words for executable code.
   Procedure DDS$CNSNT requires 46 words of local(AUTO) storage.

    No errors detected in file DDS$CNSNT.:E05TSI    .

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:19   

 Object Unit name= DDS$CNSNT                                  File name= DDS$CNSNT.:E05TOU
 UTS= JUL 29 '97 14:14:53.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     17     21  DDS$CNSNT
    1   Proc  even  none  1011   1763  DDS$CNSNT
    2  RoData even  none     2      2  DDS$CNSNT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        4  DDS$CNSNT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDS$OCTAL
 yes     yes           Std       2 DDS$SDO
 yes     yes           Std       2 DDS$HEX
 yes     yes           Std       2 DDS$DECIMAL
 yes     yes           Std       4 XPN_7LSPTOD
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:20   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  B_VECTNIL
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:21   


        1        1        /*M* DDS$CNSNT - Builds constant frames for LET/IF commands */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F* NAME: DDS$CNSNT
       10       10             PURPOSE: To build constant reference.
       11       11             DESCRIPTION: Pointer to node "CNSNT_REF" is input. The type of
       12       12             constant is determined by using the code of the first returned
       13       13             sub-block. The constant value is converted from textc to the
       14       14             internal representation. If no error condition was encountered
       15       15             then returns, else altreturns. */
       16       16        /*D* NAME: DDS$CNSNT
       17       17             CALL: CALL DDS$CNSNT( N$, WORK, TYPE ) ALTRET( error );
       18       18             INTERFACE: DDS$OCTAL
       19       19                        DDS$DECIMAL
       20       20                        DDS$SDO
       21       21                        XPN_7LSPTOD
       22       22             ENVIRONMENT: DDS$SCAN active.
       23       23             INPUT: N$ - pointer to "CNSNT_REF" node.
       24       24                    WORK - output build buffer.
       25       25             OUTPUT: TYPE - format for for type of constant.
       26       26             SCRATCH: Local auto only.
       27       27             DESCRIPTION: Pointer to node "CNSNT_REF" is input. The type of
       28       28             constant is determined by using the code of the first returned
       29       29             sub-block. The constant value is converted from textc to the
       30       30             internal representation. If no error condition was encountered
       31       31             then returns, else altreturns. */
       32       32
       33       33        DDS$CNSNT: PROC( N$, WORK, TYPE, FMT ) ALTRET;

     33  1 000000   000000 700200 xent  DDS$CNSNT    TSX0  ! X66_AUTO_4
         1 000001   000056 000004                    ZERO    46,4
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:22   

       34       34
       35       35    1   DCL N$ PTR;
       36       36        %INCLUDE DD$BASED;
       37     1339        %IF$CONST (NAME=WORK,STCLASS=);
       38     1377    1   DCL TYPE UBIN;
       39     1378    1   DCL FMT UBIN;
       40     1379    1   DCL V SBIN;
       41     1380    1   DCL A UBIN;
       42     1381    1   DCL H UBIN;
       43     1382    1   DCL NSUB UBIN;
       44     1383    1   DCL NCD UBIN;
       45     1384    1   DCL CODE UBIN;
       46     1385    1   DCL NC$ PTR;
       47     1386    1   DCL NN$ PTR;
       48     1387    1   DCL TNC$ PTR;
       49     1388    1   DCL C CHAR(1);
       50     1389    1   DCL O SBIN;
       51     1390    1   DCL FT$ PTR;
       52     1391    1   DCL FLOAT BIT(72) DALIGNED;
       53     1392    1   DCL FTEXT CHAR(22);
       54     1393    1   DCL FTSIZ UBIN;
       55     1394    1   DCL BITT BIT(1) BASED( BIT$ ) UNAL;
       56     1395    1   DCL OCT UBIN(3) BASED( OCT$ ) UNAL;
       57     1396    1   DCL HEX UBIN(4) BASED( HEX$ ) UNAL;
       58     1397    1   DCL CHAR$1 CHAR(1) BASED UNAL;
       59     1398    1   DCL DECI$MAL CHAR( V ) BASED( DEC$ ) UNAL;
       60     1399    1   DCL 1 CHAR$T1 BASED UNAL,
       61     1400    1         2 * CHAR(1) UNAL,
       62     1401    1         2 ODIG CHAR(1) UNAL;
       63     1402        %TEXT$C;
       64     1407    1   DCL BIT$ PTR;
       65     1408    1   DCL OCT$ PTR;
       66     1409    1   DCL HEX$ PTR;
       67     1410    1   DCL DEC$ PTR;
       68     1411    1   DCL IX UBIN;
       69     1412    1   DCL HELP UBIN;                          /* Kludge for pointer do case */
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:23   
       70     1413    1   DCL GOTDOT BIT(1) ALIGNED;
       71     1414        %INCLUDE XU_MACRO_C;
       72     4520        %PARSE$OUT (NAME=POB,STCLASS=BASED,NSUBLKS=NSB);
       73     4565        %INCLUDE XUH_MACRO_C;
       74     4649        %INCLUDE DD_SD_M;
       75     5985        %S_D;
       76     7303    1   DCL DDS$OCTAL ENTRY(2) ALTRET;
       77     7304    1   DCL DDS$HEX ENTRY(2) ALTRET;
       78     7305    1   DCL DDS$DECIMAL ENTRY(2) ALTRET;
       79     7306    1   DCL DDS$SDO ENTRY(2) ALTRET;
       80     7307    1   DCL XPN_7LSPTOD ENTRY(4) ALTRET;
       81     7308        %INCLUDE DD$DITEM;
       12+    7411             %LIST;
       13+    7412    1        DCL SDD$ PTR;
       14+    7413    1        DCL ZITEM$ PTR;
       15+    7414    1        DCL SDD_L6$ PTR;
       16+    7415    1        DCL ZITEM_L6$ PTR;
       82     7989        %INCLUDE DD_ERR_C;
       83     8386        %INCLUDE DD_PSUBS_C;
       84     8861
       85     8862    1        WORK = '0'B;

   8862  1 000002   200004 470500                    LDP0    @WORK,,AUTO
         1 000003   000100 100400                    MLR     fill='000'O
         1 000004   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000005   000000 000100                    ADSC9   0,,PR0                   cn=0,n=64

       86     8863    1        NN$ = N$ -> POB.SUBLK$( 0 );

   8863  1 000006   200003 471500                    LDP1    @N$,,AUTO
         1 000007   100000 473500                    LDP3    0,,PR1
         1 000010   300003 236100                    LDQ     3,,PR3
         1 000011   200016 756100                    STQ     NN$,,AUTO

       87     8864    1        CODE = NN$ -> POB.CODE;

   8864  1 000012   200016 474500                    LDP4    NN$,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:24   
         1 000013   400000 236100                    LDQ     0,,PR4
         1 000014   777777 376007                    ANQ     -1,DL
         1 000015   200014 756100                    STQ     CODE,,AUTO

       88     8865
       89     8866    2        DO CASE ( CODE );

   8866  1 000016   000310 136007                    SBLQ    200,DL
         1 000017   000010 116007                    CMPQ    8,DL
         1 000020   000022 602006 1                  TNC     s:8866+4,QL
         1 000021   001265 710000 1                  TRA     s:9120
         1 000022   000032 710000 1                  TRA     s:8872
         1 000023   000533 710000 1                  TRA     s:8977
         1 000024   000032 710000 1                  TRA     s:8872
         1 000025   001202 710000 1                  TRA     s:9090
         1 000026   001056 710000 1                  TRA     s:9053
         1 000027   001220 710000 1                  TRA     s:9100
         1 000030   001247 710000 1                  TRA     s:9112
         1 000031   000750 710000 1                  TRA     s:9028

       90     8867
       91     8868        /* Quote string constants - 'string'B,O,C | C,O,X'string' */
       92     8869
       93     8870    2          CASE ( 200,                /* CNR1_CODE */

       94     8871    2          202 );                     /* CNR3_CODE */
       95     8872    2             NCD = 472 ;              /* C@SPECC - default */

   8872  1 000032   000730 235007                    LDA     472,DL
         1 000033   200013 755100                    STA     NCD,,AUTO

       96     8873    2             NSUB = NN$ -> POB.NSB - 1;

   8873  1 000034   400001 236100                    LDQ     1,,PR4
         1 000035   000022 772000                    QRL     18
         1 000036   000001 136007                    SBLQ    1,DL
         1 000037   200012 756100                    STQ     NSUB,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:25   

       97     8874    2             IF ( NSUB = 1 )               /* Really 2 */

   8874  1 000040   000001 116007                    CMPQ    1,DL
         1 000041   000065 601000 1                  TNZ     s:8884

       98     8875    2             THEN IF ( CODE = 202 )  /* CNR3_CODE */

   8875  1 000042   200014 235100                    LDA     CODE,,AUTO
         1 000043   000312 115007                    CMPA    202,DL
         1 000044   000055 601000 1                  TNZ     s:8881

       99     8876    3                  THEN DO;

      100     8877    3                       NCD = NN$ -> POB.SUBLK$( 0 ) -> POB.CODE;

   8877  1 000045   400003 475500                    LDP5    3,,PR4
         1 000046   500000 236100                    LDQ     0,,PR5
         1 000047   777777 376007                    ANQ     -1,DL
         1 000050   200013 756100                    STQ     NCD,,AUTO

      101     8878    3                       NC$ = NN$ -> POB.SUBLK$( 1 ) -> POB.SUBLK$( 0 );

   8878  1 000051   400004 476500                    LDP6    4,,PR4
         1 000052   600003 236100                    LDQ     3,,PR6
         1 000053   200015 756100                    STQ     NC$,,AUTO

      102     8879    3                     END;

   8879  1 000054   000070 710000 1                  TRA     s:8885

      103     8880    3                  ELSE DO;

      104     8881    3                       NCD = NN$ -> POB.SUBLK$( 1 ) -> POB.CODE;

   8881  1 000055   400004 475500                    LDP5    4,,PR4
         1 000056   500000 236100                    LDQ     0,,PR5
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:26   
         1 000057   777777 376007                    ANQ     -1,DL
         1 000060   200013 756100                    STQ     NCD,,AUTO

      105     8882    3                       NC$ = NN$ -> POB.SUBLK$( 0 ) -> POB.SUBLK$( 0 );

   8882  1 000061   400003 476500                    LDP6    3,,PR4
         1 000062   600003 236100                    LDQ     3,,PR6
         1 000063   200015 756100                    STQ     NC$,,AUTO

      106     8883    3                     END;

   8883  1 000064   000070 710000 1                  TRA     s:8885

      107     8884    2             ELSE NC$ = NN$ -> POB.SUBLK$( 0 ) -> POB.SUBLK$( 0 );

   8884  1 000065   400003 475500                    LDP5    3,,PR4
         1 000066   500003 236100                    LDQ     3,,PR5
         1 000067   200015 756100                    STQ     NC$,,AUTO

      108     8885    2             V = NC$ -> TEXT$C.SIZE;

   8885  1 000070   200015 473500                    LDP3    NC$,,AUTO
         1 000071   300000 236100                    LDQ     0,,PR3
         1 000072   000033 772000                    QRL     27
         1 000073   200007 756100                    STQ     V,,AUTO

      109     8886    3             DO CASE( NCD );

   8886  1 000074   200013 235100                    LDA     NCD,,AUTO
         1 000075   000726 135007                    SBLA    470,DL
         1 000076   000005 115007                    CMPA    5,DL
         1 000077   000101 602005 1                  TNC     s:8886+5,AL
         1 000100   001372 710000 1                  TRA     s:9145
         1 000101   000106 710000 1                  TRA     s:8889
         1 000102   000166 710000 1                  TRA     s:8906
         1 000103   000242 710000 1                  TRA     s:8919
         1 000104   000262 710000 1                  TRA     s:8925
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:27   
         1 000105   000331 710000 1                  TRA     s:8937

      110     8887
      111     8888    3               CASE ( 470 );          /* C@FPSECB - Bit string */

      112     8889    3                  TYPE = %BIT_FMT;         /* BIT_FMT */

   8889  1 000106   000005 235007                    LDA     5,DL
         1 000107   200005 475500                    LDP5    @TYPE,,AUTO
         1 000110   500000 755100                    STA     0,,PR5

      113     8890    3                  IF ( V > LENGTHB( WORK.BITS.TRING ) ) THEN GOTO CONSTOOBIG;

   8890  1 000111   200007 236100                    LDQ     V,,AUTO
         1 000112   000110 116007                    CMPQ    72,DL
         1 000113   001377 605400 1                  TPNZ    CONSTOOBIG

      114     8891    3                  WORK.SIZE = V;

   8891  1 000114   000033 736000                    QLS     27
         1 000115   000000 552140                    STBQ    0,'40'O,PR0

      115     8892    3                  WORK.BITS.TRING = '0'B;

   8892  1 000116   000001 450100                    STZ     1,,PR0
         1 000117   000002 450100                    STZ     2,,PR0

      116     8893    3                  BIT$ = ADDR( WORK.BITS.TRING );

   8893  1 000120   200004 236100                    LDQ     @WORK,,AUTO
         1 000121   000001 036003                    ADLQ    1,DU
         1 000122   200035 756100                    STQ     BIT$,,AUTO

      117     8894    4                  DO IX = 1 TO V;

   8894  1 000123   000001 235007                    LDA     1,DL
         1 000124   200041 755100                    STA     IX,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:28   
         1 000125   000161 710000 1                  TRA     s:8903+2

      118     8895    4                       C = SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 );

   8895  1 000126   200015 470500                    LDP0    NC$,,AUTO
         1 000127   000000 236100                    LDQ     0,,PR0
         1 000130   000033 772000                    QRL     27
         1 000131   200041 235100                    LDA     IX,,AUTO
         1 000132   040100 100505                    MLR     fill='040'O
         1 000133   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 000134   200020 000001                    ADSC9   C,,AUTO                  cn=0,n=1

      119     8896    4                       IF ( C = '0' )

   8896  1 000135   200020 236100                    LDQ     C,,AUTO
         1 000136   777000 376003                    ANQ     -512,DU
         1 000137   060000 116003                    CMPQ    24576,DU
         1 000140   000142 601000 1                  TNZ     s:8899

      120     8897    5                       THEN DO;            /* Zilch */

      121     8898    5                          END;

   8898  1 000141   000153 710000 1                  TRA     s:8902

      122     8899    4                       ELSE IF ( C = '1' )

   8899  1 000142   200020 236100                    LDQ     C,,AUTO
         1 000143   777000 376003                    ANQ     -512,DU
         1 000144   061000 116003                    CMPQ    25088,DU
         1 000145   001373 601000 1                  TNZ     BADDIG

      123     8900    4                            THEN BITT = '1'B;

   8900  1 000146   200035 471500                    LDP1    BIT$,,AUTO
         1 000147   003100 060400                    CSL     bolr='003'O
         1 000150   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:29   
         1 000151   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         1 000152   000153 710000 1                  TRA     s:8902

      124     8901    4                            ELSE GOTO BADDIG;
      125     8902    4                       BIT$ = PINCRB( BIT$, LENGTHB( BITT ) );

   8902  1 000153   200035 470500                    LDP0    BIT$,,AUTO
         1 000154   000001 220003                    LDX0    1,DU
         1 000155   000000 503510                    ABD     0,X0,PR0
         1 000156   200035 450500                    STP0    BIT$,,AUTO

      126     8903    4                     END;                  /* "DO IX" */

   8903  1 000157   000001 035007                    ADLA    1,DL
         1 000160   200041 755100                    STA     IX,,AUTO
         1 000161   200041 236100                    LDQ     IX,,AUTO
         1 000162   000165 604000 1                  TMI     s:8903+6
         1 000163   200007 116100                    CMPQ    V,,AUTO
         1 000164   000126 604400 1                  TMOZ    s:8895
         1 000165   001372 710000 1                  TRA     s:9145

      127     8904
      128     8905    3               CASE ( 471 );          /* C@FSPECO - Octal bit string */

      129     8906    3                  TYPE = %OBIT_FMT;        /* OBIT_FMT */

   8906  1 000166   000016 235007                    LDA     14,DL
         1 000167   200005 475500                    LDP5    @TYPE,,AUTO
         1 000170   500000 755100                    STA     0,,PR5

      130     8907    3                  IF ( V > LENGTHB( WORK.BITS.TRING ) / 3 ) THEN GOTO CONSTOOBIG;

   8907  1 000171   200007 236100                    LDQ     V,,AUTO
         1 000172   000030 116007                    CMPQ    24,DL
         1 000173   001377 605400 1                  TPNZ    CONSTOOBIG

      131     8908    3                  WORK.SIZE = V * 3;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:30   

   8908  1 000174   000003 402007                    MPY     3,DL
         1 000175   000033 736000                    QLS     27
         1 000176   000000 552140                    STBQ    0,'40'O,PR0

      132     8909    3                  WORK.BITS.TRING = '0'B;

   8909  1 000177   000001 450100                    STZ     1,,PR0
         1 000200   000002 450100                    STZ     2,,PR0

      133     8910    3                  OCT$ = ADDR( WORK.BITS.TRING );

   8910  1 000201   200004 236100                    LDQ     @WORK,,AUTO
         1 000202   000001 036003                    ADLQ    1,DU
         1 000203   200036 756100                    STQ     OCT$,,AUTO

      134     8911    4                  DO IX = 1 TO V;

   8911  1 000204   000001 235007                    LDA     1,DL
         1 000205   200041 755100                    STA     IX,,AUTO
         1 000206   000235 710000 1                  TRA     s:8916+2

      135     8912    4                       O = ASCBIN( SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 ) ) - ASCBIN(
              8912                                '0' );

   8912  1 000207   200015 470500                    LDP0    NC$,,AUTO
         1 000210   000000 236100                    LDQ     0,,PR0
         1 000211   000033 772000                    QRL     27
         1 000212   200041 235100                    LDA     IX,,AUTO
         1 000213   000100 101505                    MRL     fill='000'O
         1 000214   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 000215   200052 000004                    ADSC9   GOTDOT+7,,AUTO           cn=0,n=4
         1 000216   200052 236100                    LDQ     GOTDOT+7,,AUTO
         1 000217   000060 136007                    SBLQ    48,DL
         1 000220   200021 756100                    STQ     O,,AUTO

      136     8913    4                       IF ( O < 0 ) OR ( O > 7 ) THEN GOTO BADDIG;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:31   

   8913  1 000221   001373 604000 1                  TMI     BADDIG
         1 000222   000007 116007                    CMPQ    7,DL
         1 000223   001373 605400 1                  TPNZ    BADDIG

      137     8914    4                       OCT = O;

   8914  1 000224   200036 471500                    LDP1    OCT$,,AUTO
         1 000225   003100 061500                    CSR     bolr='003'O
         1 000226   200021 000044                    BDSC    O,,AUTO                  by=0,bit=0,n=36
         1 000227   100000 000003                    BDSC    0,,PR1                   by=0,bit=0,n=3

      138     8915    4                       OCT$ = PINCRB( OCT$, LENGTHB( OCT ) );

   8915  1 000230   000003 220003                    LDX0    3,DU
         1 000231   100000 503510                    ABD     0,X0,PR1
         1 000232   200036 451500                    STP1    OCT$,,AUTO

      139     8916    4                     END;                  /* "DO IX" */

   8916  1 000233   000001 035007                    ADLA    1,DL
         1 000234   200041 755100                    STA     IX,,AUTO
         1 000235   200041 236100                    LDQ     IX,,AUTO
         1 000236   000241 604000 1                  TMI     s:8916+6
         1 000237   200007 116100                    CMPQ    V,,AUTO
         1 000240   000207 604400 1                  TMOZ    s:8912
         1 000241   001372 710000 1                  TRA     s:9145

      140     8917
      141     8918    3               CASE ( 472 );          /* C@FSPECC - Character string */

      142     8919    3                  TYPE = %CHAR_FMT;        /* CHAR_FMT */

   8919  1 000242   000004 235007                    LDA     4,DL
         1 000243   200005 475500                    LDP5    @TYPE,,AUTO
         1 000244   500000 755100                    STA     0,,PR5

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:32   
      143     8920    3                  IF ( V > LENGTHC( WORK.TEXT ) ) THEN GOTO CONSTOOBIG;

   8920  1 000245   200007 236100                    LDQ     V,,AUTO
         1 000246   000077 116007                    CMPQ    63,DL
         1 000247   001377 605400 1                  TPNZ    CONSTOOBIG

      144     8921    3                  WORK.SIZE = V;

   8921  1 000250   000033 736000                    QLS     27
         1 000251   000000 552140                    STBQ    0,'40'O,PR0

      145     8922    3                  WORK.TEXT = NC$ -> TEXT$C.TXT;

   8922  1 000252   200015 473500                    LDP3    NC$,,AUTO
         1 000253   300000 236100                    LDQ     0,,PR3
         1 000254   000033 772000                    QRL     27
         1 000255   000000 620006                    EAX0    0,QL
         1 000256   040100 100540                    MLR     fill='040'O
         1 000257   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         1 000260   000000 200077                    ADSC9   0,,PR0                   cn=1,n=63
         1 000261   001372 710000 1                  TRA     s:9145

      146     8923
      147     8924    3               CASE ( 473 );         /* C@FSPECOF - FORTRAN octal */

      148     8925    3                  TYPE = %OFORT_FMT;       /* OFORT_FMT */

   8925  1 000262   000027 235007                    LDA     23,DL
         1 000263   200005 475500                    LDP5    @TYPE,,AUTO
         1 000264   500000 755100                    STA     0,,PR5

      149     8926    3                  IF ( V > 12 ) THEN GOTO CONSTOOBIG;

   8926  1 000265   200007 236100                    LDQ     V,,AUTO
         1 000266   000014 116007                    CMPQ    12,DL
         1 000267   001377 605400 1                  TPNZ    CONSTOOBIG

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:33   
      150     8927    3                  WORK.SIZE = SIZEB( WORK.CONS.TANT );

   8927  1 000270   044000 236003                    LDQ     18432,DU
         1 000271   000000 552140                    STBQ    0,'40'O,PR0

      151     8928    3                  A = 0;

   8928  1 000272   200010 450100                    STZ     A,,AUTO

      152     8929    4                  DO IX = 1 TO V;

   8929  1 000273   000001 235007                    LDA     1,DL
         1 000274   200041 755100                    STA     IX,,AUTO
         1 000275   000321 710000 1                  TRA     s:8933+2

      153     8930    4                       O = ASCBIN( SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 ) ) - ASCBIN(
              8930                                '0' );

   8930  1 000276   200015 470500                    LDP0    NC$,,AUTO
         1 000277   000000 236100                    LDQ     0,,PR0
         1 000300   000033 772000                    QRL     27
         1 000301   200041 235100                    LDA     IX,,AUTO
         1 000302   000100 101505                    MRL     fill='000'O
         1 000303   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 000304   200052 000004                    ADSC9   GOTDOT+7,,AUTO           cn=0,n=4
         1 000305   200052 236100                    LDQ     GOTDOT+7,,AUTO
         1 000306   000060 136007                    SBLQ    48,DL
         1 000307   200021 756100                    STQ     O,,AUTO

      154     8931    4                       IF ( O < 0 ) OR ( O > 7 ) THEN GOTO BADDIG;

   8931  1 000310   001373 604000 1                  TMI     BADDIG
         1 000311   000007 116007                    CMPQ    7,DL
         1 000312   001373 605400 1                  TPNZ    BADDIG

      155     8932    4                       A = ( A * 8 ) + O;

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:34   
   8932  1 000313   200010 236100                    LDQ     A,,AUTO
         1 000314   000003 736000                    QLS     3
         1 000315   200021 036100                    ADLQ    O,,AUTO
         1 000316   200010 756100                    STQ     A,,AUTO

      156     8933    4                     END;

   8933  1 000317   000001 035007                    ADLA    1,DL
         1 000320   200041 755100                    STA     IX,,AUTO
         1 000321   200041 236100                    LDQ     IX,,AUTO
         1 000322   000325 604000 1                  TMI     s:8934
         1 000323   200007 116100                    CMPQ    V,,AUTO
         1 000324   000276 604400 1                  TMOZ    s:8930

      157     8934    3                  WORK.CONS.TANT = A;

   8934  1 000325   200010 235100                    LDA     A,,AUTO
         1 000326   200004 470500                    LDP0    @WORK,,AUTO
         1 000327   000001 755100                    STA     1,,PR0
         1 000330   001372 710000 1                  TRA     s:9145

      158     8935
      159     8936    3               CASE ( 474 );          /* C@FPSECX - FORTRAN hexadecimal */

      160     8937    3                  IF CODE = 202      /* CNR3_CODE */

   8937  1 000331   200014 235100                    LDA     CODE,,AUTO
         1 000332   000312 115007                    CMPA    202,DL
         1 000333   000431 601000 1                  TNZ     s:8955

      161     8938    4                  THEN DO;

      162     8939    4                       TYPE = %ZFORT_FMT;  /* ZFORT_FMT */

   8939  1 000334   000030 235007                    LDA     24,DL
         1 000335   200005 475500                    LDP5    @TYPE,,AUTO
         1 000336   500000 755100                    STA     0,,PR5
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:35   

      163     8940    4                       IF ( V > 9 ) THEN GOTO CONSTOOBIG;

   8940  1 000337   200007 236100                    LDQ     V,,AUTO
         1 000340   000011 116007                    CMPQ    9,DL
         1 000341   001377 605400 1                  TPNZ    CONSTOOBIG

      164     8941    4                       WORK.SIZE = SIZEB( WORK.CONS.TANT );

   8941  1 000342   044000 236003                    LDQ     18432,DU
         1 000343   000000 552140                    STBQ    0,'40'O,PR0

      165     8942    4                       A = 0;

   8942  1 000344   200010 450100                    STZ     A,,AUTO

      166     8943    5                       DO IX = 1 TO V;

   8943  1 000345   000001 235007                    LDA     1,DL
         1 000346   200041 755100                    STA     IX,,AUTO
         1 000347   000421 710000 1                  TRA     s:8951+2

      167     8944    5                            C = SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 );

   8944  1 000350   200015 470500                    LDP0    NC$,,AUTO
         1 000351   000000 236100                    LDQ     0,,PR0
         1 000352   000033 772000                    QRL     27
         1 000353   200041 235100                    LDA     IX,,AUTO
         1 000354   040100 100505                    MLR     fill='040'O
         1 000355   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 000356   200020 000001                    ADSC9   C,,AUTO                  cn=0,n=1

      168     8945    5                            IF ( C >= '0' ) AND ( C <= '9' )

   8945  1 000357   200020 236100                    LDQ     C,,AUTO
         1 000360   777000 376003                    ANQ     -512,DU
         1 000361   060000 116003                    CMPQ    24576,DU
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:36   
         1 000362   000375 602000 1                  TNC     s:8947
         1 000363   200020 236100                    LDQ     C,,AUTO
         1 000364   777000 376003                    ANQ     -512,DU
         1 000365   071000 116003                    CMPQ    29184,DU
         1 000366   000370 600000 1                  TZE     s:8946
         1 000367   000375 603000 1                  TRC     s:8947

      169     8946    5                            THEN H = ASCBIN( C ) - ASCBIN( '0' );

   8946  1 000370   200020 236100                    LDQ     C,,AUTO
         1 000371   000033 772000                    QRL     27
         1 000372   000060 136007                    SBLQ    48,DL
         1 000373   200011 756100                    STQ     H,,AUTO
         1 000374   000413 710000 1                  TRA     s:8950

      170     8947    5                            ELSE IF ( C >= 'A' ) AND ( C <= 'F' )

   8947  1 000375   200020 236100                    LDQ     C,,AUTO
         1 000376   777000 376003                    ANQ     -512,DU
         1 000377   101000 116003                    CMPQ    33280,DU
         1 000400   001373 602000 1                  TNC     BADDIG
         1 000401   200020 236100                    LDQ     C,,AUTO
         1 000402   777000 376003                    ANQ     -512,DU
         1 000403   106000 116003                    CMPQ    35840,DU
         1 000404   000406 600000 1                  TZE     s:8948
         1 000405   001373 603000 1                  TRC     BADDIG

      171     8948    5                                 THEN H = ASCBIN( C ) - ASCBIN( 'A' ) + 10;

   8948  1 000406   200020 236100                    LDQ     C,,AUTO
         1 000407   000033 772000                    QRL     27
         1 000410   000067 136007                    SBLQ    55,DL
         1 000411   200011 756100                    STQ     H,,AUTO
         1 000412   000413 710000 1                  TRA     s:8950

      172     8949    5                                 ELSE GOTO BADDIG;
      173     8950    5                            A = ( A * 16 ) + H;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:37   

   8950  1 000413   200010 236100                    LDQ     A,,AUTO
         1 000414   000004 736000                    QLS     4
         1 000415   200011 036100                    ADLQ    H,,AUTO
         1 000416   200010 756100                    STQ     A,,AUTO

      174     8951    5                          END;

   8951  1 000417   000001 035007                    ADLA    1,DL
         1 000420   200041 755100                    STA     IX,,AUTO
         1 000421   200041 236100                    LDQ     IX,,AUTO
         1 000422   000425 604000 1                  TMI     s:8952
         1 000423   200007 116100                    CMPQ    V,,AUTO
         1 000424   000350 604400 1                  TMOZ    s:8944

      175     8952    4                       WORK.CONS.TANT = A;

   8952  1 000425   200010 235100                    LDA     A,,AUTO
         1 000426   200004 470500                    LDP0    @WORK,,AUTO
         1 000427   000001 755100                    STA     1,,PR0

      176     8953    4                     END;

   8953  1 000430   001372 710000 1                  TRA     s:9145

      177     8954    4                  ELSE DO;

      178     8955    4                       TYPE = %X_FMT;

   8955  1 000431   000015 235007                    LDA     13,DL
         1 000432   200005 475500                    LDP5    @TYPE,,AUTO
         1 000433   500000 755100                    STA     0,,PR5

      179     8956    4                       IF (V > LENGTHB(WORK.BITS.TRING)/4)

   8956  1 000434   200007 236100                    LDQ     V,,AUTO
         1 000435   000022 116007                    CMPQ    18,DL
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:38   
         1 000436   001377 605400 1                  TPNZ    CONSTOOBIG

      180     8957    4                       THEN GOTO CONSTOOBIG;
      181     8958    4                       WORK.SIZE = V * 4;

   8958  1 000437   000002 736000                    QLS     2
         1 000440   000033 736000                    QLS     27
         1 000441   000000 552140                    STBQ    0,'40'O,PR0

      182     8959    4                       WORK.BITS.TRING = '0'B;

   8959  1 000442   000001 450100                    STZ     1,,PR0
         1 000443   000002 450100                    STZ     2,,PR0

      183     8960    4                       HEX$ = ADDR(WORK.BITS.TRING);

   8960  1 000444   200004 236100                    LDQ     @WORK,,AUTO
         1 000445   000001 036003                    ADLQ    1,DU
         1 000446   200037 756100                    STQ     HEX$,,AUTO

      184     8961    5                       DO IX = 1 TO V;

   8961  1 000447   000001 235007                    LDA     1,DL
         1 000450   200041 755100                    STA     IX,,AUTO
         1 000451   000526 710000 1                  TRA     s:8970+2

      185     8962    5                            C = SUBSTR( NC$ -> TEXT$C.TXT, IX - 1, 1 );

   8962  1 000452   200015 470500                    LDP0    NC$,,AUTO
         1 000453   000000 236100                    LDQ     0,,PR0
         1 000454   000033 772000                    QRL     27
         1 000455   200041 235100                    LDA     IX,,AUTO
         1 000456   040100 100505                    MLR     fill='040'O
         1 000457   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 000460   200020 000001                    ADSC9   C,,AUTO                  cn=0,n=1

      186     8963    5                            IF ( C >= '0' ) AND ( C <= '9' )
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:39   

   8963  1 000461   200020 236100                    LDQ     C,,AUTO
         1 000462   777000 376003                    ANQ     -512,DU
         1 000463   060000 116003                    CMPQ    24576,DU
         1 000464   000477 602000 1                  TNC     s:8965
         1 000465   200020 236100                    LDQ     C,,AUTO
         1 000466   777000 376003                    ANQ     -512,DU
         1 000467   071000 116003                    CMPQ    29184,DU
         1 000470   000472 600000 1                  TZE     s:8964
         1 000471   000477 603000 1                  TRC     s:8965

      187     8964    5                            THEN H = ASCBIN( C ) - ASCBIN( '0' );

   8964  1 000472   200020 236100                    LDQ     C,,AUTO
         1 000473   000033 772000                    QRL     27
         1 000474   000060 136007                    SBLQ    48,DL
         1 000475   200011 756100                    STQ     H,,AUTO
         1 000476   000515 710000 1                  TRA     s:8968

      188     8965    5                            ELSE IF ( C >= 'A' ) AND ( C <= 'F' )

   8965  1 000477   200020 236100                    LDQ     C,,AUTO
         1 000500   777000 376003                    ANQ     -512,DU
         1 000501   101000 116003                    CMPQ    33280,DU
         1 000502   001373 602000 1                  TNC     BADDIG
         1 000503   200020 236100                    LDQ     C,,AUTO
         1 000504   777000 376003                    ANQ     -512,DU
         1 000505   106000 116003                    CMPQ    35840,DU
         1 000506   000510 600000 1                  TZE     s:8966
         1 000507   001373 603000 1                  TRC     BADDIG

      189     8966    5                                 THEN H = ASCBIN( C ) - ASCBIN( 'A' ) + 10;

   8966  1 000510   200020 236100                    LDQ     C,,AUTO
         1 000511   000033 772000                    QRL     27
         1 000512   000067 136007                    SBLQ    55,DL
         1 000513   200011 756100                    STQ     H,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:40   
         1 000514   000515 710000 1                  TRA     s:8968

      190     8967    5                                 ELSE GOTO BADDIG;
      191     8968    5                            HEX = H;

   8968  1 000515   200037 471500                    LDP1    HEX$,,AUTO
         1 000516   003100 061500                    CSR     bolr='003'O
         1 000517   200011 000044                    BDSC    H,,AUTO                  by=0,bit=0,n=36
         1 000520   100000 000004                    BDSC    0,,PR1                   by=0,bit=0,n=4

      192     8969    5                            HEX$ = PINCRB(HEX$, LENGTHB(HEX));

   8969  1 000521   000004 220003                    LDX0    4,DU
         1 000522   100000 503510                    ABD     0,X0,PR1
         1 000523   200037 451500                    STP1    HEX$,,AUTO

      193     8970    5                          END;

   8970  1 000524   000001 035007                    ADLA    1,DL
         1 000525   200041 755100                    STA     IX,,AUTO
         1 000526   200041 236100                    LDQ     IX,,AUTO
         1 000527   000532 604000 1                  TMI     s:8972
         1 000530   200007 116100                    CMPQ    V,,AUTO
         1 000531   000452 604400 1                  TMOZ    s:8962

      194     8971    4                     END;

      195     8972    3               END;                        /* "DO CASE( NCD )" */

   8972  1 000532   001372 710000 1                  TRA     s:9145

      196     8973        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:41   
      197     8974        /* HOST Pointer constant - .octal-c-b,$Xn  X=LS,AS,PS ; n=decimal,.octal */
      198     8975
      199     8976    2          CASE ( 201 );          /* CNR2HOST_CODE */

      200     8977    2             WORK.SIZE = 36;

   8977  1 000533   044000 236003                    LDQ     18432,DU
         1 000534   000000 552140                    STBQ    0,'40'O,PR0

      201     8978    2             TYPE = %PTR_FMT;              /* PTR_FMT */

   8978  1 000535   000007 235007                    LDA     7,DL
         1 000536   200005 473500                    LDP3    @TYPE,,AUTO
         1 000537   300000 755100                    STA     0,,PR3

      202     8979    2             NSUB = NN$ -> POB.NSB - 1;

   8979  1 000540   400001 236100                    LDQ     1,,PR4
         1 000541   000022 772000                    QRL     18
         1 000542   000001 136007                    SBLQ    1,DL
         1 000543   200012 756100                    STQ     NSUB,,AUTO

      203     8980    3             DO IX = 0 TO NSUB;

   8980  1 000544   200041 450100                    STZ     IX,,AUTO
         1 000545   000744 710000 1                  TRA     s:9024+3

      204     8981    3                  NC$ = NN$ -> POB.SUBLK$( IX );

   8981  1 000546   200016 470500                    LDP0    NN$,,AUTO
         1 000547   200041 720100                    LXL0    IX,,AUTO
         1 000550   000003 236110                    LDQ     3,X0,PR0
         1 000551   200015 756100                    STQ     NC$,,AUTO

      205     8982    3                  NCD = NC$ -> POB.CODE;

   8982  1 000552   200015 471500                    LDP1    NC$,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:42   
         1 000553   100000 236100                    LDQ     0,,PR1
         1 000554   777777 376007                    ANQ     -1,DL
         1 000555   200013 756100                    STQ     NCD,,AUTO

      206     8983    3                  HELP = IX;

   8983  1 000556   200041 235100                    LDA     IX,,AUTO
         1 000557   200042 755100                    STA     HELP,,AUTO

      207     8984    3                  IF NSUB = 4

   8984  1 000560   200012 235100                    LDA     NSUB,,AUTO
         1 000561   000004 115007                    CMPA    4,DL
         1 000562   000572 601000 1                  TNZ     s:8988

      208     8985    3                  THEN IF IX > 2

   8985  1 000563   200041 235100                    LDA     IX,,AUTO
         1 000564   000003 115007                    CMPA    3,DL
         1 000565   000601 602000 1                  TNC     s:8991

      209     8986    3                       THEN HELP = HELP + 2;

   8986  1 000566   200042 235100                    LDA     HELP,,AUTO
         1 000567   000002 035007                    ADLA    2,DL
         1 000570   200042 755100                    STA     HELP,,AUTO
         1 000571   000601 710000 1                  TRA     s:8991

      210     8987    3                       ELSE ;              /* This is not redundant! */
      211     8988    3                  ELSE IF NSUB = 2

   8988  1 000572   000002 115007                    CMPA    2,DL
         1 000573   000601 601000 1                  TNZ     s:8991

      212     8989    3                       THEN IF IX > 0

   8989  1 000574   200041 235100                    LDA     IX,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:43   
         1 000575   000601 600000 1                  TZE     s:8991

      213     8990    3                            THEN HELP = HELP + 4;

   8990  1 000576   200042 235100                    LDA     HELP,,AUTO
         1 000577   000004 035007                    ADLA    4,DL
         1 000600   200042 755100                    STA     HELP,,AUTO

      214     8991    4                  DO CASE ( HELP );

   8991  1 000601   200042 235100                    LDA     HELP,,AUTO
         1 000602   000007 115007                    CMPA    7,DL
         1 000603   000605 602005 1                  TNC     s:8991+4,AL
         1 000604   000741 710000 1                  TRA     s:9024
         1 000605   000614 710000 1                  TRA     s:8994
         1 000606   000741 710000 1                  TRA     s:9024
         1 000607   000633 710000 1                  TRA     s:9002
         1 000610   000741 710000 1                  TRA     s:9024
         1 000611   000652 710000 1                  TRA     s:9007
         1 000612   000674 710000 1                  TRA     s:9012
         1 000613   000721 710000 1                  TRA     s:9020

      215     8992
      216     8993    4                    CASE ( 0 );            /* "OCTIL" */

      217     8994    4                       CALL DDS$OCTAL( NC$, V ) ALTRET( ARET );

   8994  1 000614   200007 633500                    EPPR3   V,,AUTO
         1 000615   200053 453500                    STP3    GOTDOT+8,,AUTO
         1 000616   200015 634500                    EPPR4   NC$,,AUTO
         1 000617   200052 454500                    STP4    GOTDOT+7,,AUTO
         1 000620   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 000621   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000622   000000 701000 xent               TSX1    DDS$OCTAL
         1 000623   001406 702000 1                  TSX2    ARET

      218     8995    4                       IF ( V > BITBIN( '777777'O ) ) THEN GOTO TOOLARGE;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:44   

   8995  1 000624   200007 235100                    LDA     V,,AUTO
         1 000625   777777 115007                    CMPA    -1,DL
         1 000626   001403 605400 1                  TPNZ    TOOLARGE

      219     8996    4                       WORK.P.ADR.W = V;

   8996  1 000627   000000 620005                    EAX0    0,AL
         1 000630   200004 470500                    LDP0    @WORK,,AUTO
         1 000631   000001 740100                    STX0    1,,PR0
         1 000632   000741 710000 1                  TRA     s:9024

      220     8997
      221     8998    4                    CASE ( 1, 3 );         /* "MINUS" */

      222     8999        /*D* Ignore minus sign */
      223     9000
      224     9001    4                    CASE ( 2 );            /* "ODIG" */

      225     9002    4                       V = ASCBIN( NC$ -> POB.SUBLK$( 0 ) -> CHAR$T1.ODIG ) - ASCBIN(
              9002                                '0' );

   9002  1 000633   100003 473500                    LDP3    3,,PR1
         1 000634   000100 101500                    MRL     fill='000'O
         1 000635   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1
         1 000636   200052 000004                    ADSC9   GOTDOT+7,,AUTO           cn=0,n=4
         1 000637   200052 236100                    LDQ     GOTDOT+7,,AUTO
         1 000640   000060 136007                    SBLQ    48,DL
         1 000641   200007 756100                    STQ     V,,AUTO

      226     9003    4                       IF ( V > 3 ) THEN GOTO TOOLARGE;

   9003  1 000642   000003 116007                    CMPQ    3,DL
         1 000643   001403 605400 1                  TPNZ    TOOLARGE

      227     9004    4                       WORK.P.ADR.C = V;

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:45   
   9004  1 000644   200004 473500                    LDP3    @WORK,,AUTO
         1 000645   000020 736000                    QLS     16
         1 000646   300001 676100                    ERQ     1,,PR3
         1 000647   600000 376007                    ANQ     -65536,DL
         1 000650   300001 656100                    ERSQ    1,,PR3
         1 000651   000741 710000 1                  TRA     s:9024

      228     9005
      229     9006    4                    CASE ( 4 );            /* "OCTIL1 */

      230     9007    4                       CALL DDS$OCTAL( NC$, V ) ALTRET( ARET );

   9007  1 000652   200007 633500                    EPPR3   V,,AUTO
         1 000653   200053 453500                    STP3    GOTDOT+8,,AUTO
         1 000654   200015 634500                    EPPR4   NC$,,AUTO
         1 000655   200052 454500                    STP4    GOTDOT+7,,AUTO
         1 000656   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 000657   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000660   000000 701000 xent               TSX1    DDS$OCTAL
         1 000661   001406 702000 1                  TSX2    ARET

      231     9008    4                       IF ( V > 8 ) THEN GOTO TOOLARGE;

   9008  1 000662   200007 235100                    LDA     V,,AUTO
         1 000663   000010 115007                    CMPA    8,DL
         1 000664   001403 605400 1                  TPNZ    TOOLARGE

      232     9009    4                       WORK.P.ADR.B = V;

   9009  1 000665   200004 470500                    LDP0    @WORK,,AUTO
         1 000666   200007 236100                    LDQ     V,,AUTO
         1 000667   000014 736000                    QLS     12
         1 000670   000001 676100                    ERQ     1,,PR0
         1 000671   170000 376007                    ANQ     61440,DL
         1 000672   000001 656100                    ERSQ    1,,PR0
         1 000673   000741 710000 1                  TRA     s:9024

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:46   
      233     9010
      234     9011    4                    CASE ( 5 );            /* "CNR21" */

      235     9012    5                       DO CASE ( NCD );

   9012  1 000674   000714 136007                    SBLQ    460,DL
         1 000675   000003 116007                    CMPQ    3,DL
         1 000676   000700 602006 1                  TNC     s:9012+4,QL
         1 000677   000712 710000 1                  TRA     s:9017
         1 000700   000703 710000 1                  TRA     s:9013
         1 000701   000706 710000 1                  TRA     s:9014
         1 000702   000710 710000 1                  TRA     s:9015

      236     9013    5                         CASE ( 460 ); V = 3; /* C@$LS */

   9013  1 000703   000003 235007                    LDA     3,DL
         1 000704   200007 755100                    STA     V,,AUTO
         1 000705   000712 710000 1                  TRA     s:9017

      237     9014    5                         CASE ( 461 ); V = 0; /* C@$PS */

   9014  1 000706   200007 450100                    STZ     V,,AUTO
         1 000707   000712 710000 1                  TRA     s:9017

      238     9015    5                         CASE ( 462 ); V = 2; /* C@$AS */

   9015  1 000710   000002 235007                    LDA     2,DL
         1 000711   200007 755100                    STA     V,,AUTO

      239     9016    5                         END;              /* "DO CASE ( NCD )" */

      240     9017    4                       WORK.P.S = V;

   9017  1 000712   200004 473500                    LDP3    @WORK,,AUTO
         1 000713   200007 236100                    LDQ     V,,AUTO
         1 000714   000012 736000                    QLS     10
         1 000715   300001 676100                    ERQ     1,,PR3
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:47   
         1 000716   006000 376007                    ANQ     3072,DL
         1 000717   300001 656100                    ERSQ    1,,PR3
         1 000720   000741 710000 1                  TRA     s:9024

      241     9018
      242     9019    4                    CASE ( 6 );            /* "SDO" */

      243     9020    4                       CALL DDS$SDO( NC$, V ) ALTRET( ARET );

   9020  1 000721   200007 633500                    EPPR3   V,,AUTO
         1 000722   200053 453500                    STP3    GOTDOT+8,,AUTO
         1 000723   200015 634500                    EPPR4   NC$,,AUTO
         1 000724   200052 454500                    STP4    GOTDOT+7,,AUTO
         1 000725   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 000726   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000727   000000 701000 xent               TSX1    DDS$SDO
         1 000730   001406 702000 1                  TSX2    ARET

      244     9021    4                       IF ( V > BITBIN( '1777'O ) ) THEN GOTO TOOLARGE;

   9021  1 000731   200007 235100                    LDA     V,,AUTO
         1 000732   001777 115007                    CMPA    1023,DL
         1 000733   001403 605400 1                  TPNZ    TOOLARGE

      245     9022    4                       WORK.P.D = V;

   9022  1 000734   200004 470500                    LDP0    @WORK,,AUTO
         1 000735   200007 236100                    LDQ     V,,AUTO
         1 000736   000001 676100                    ERQ     1,,PR0
         1 000737   001777 376007                    ANQ     1023,DL
         1 000740   000001 656100                    ERSQ    1,,PR0

      246     9023    4                    END;                   /* "DO CASE( IX )" */

      247     9024    3                END;                       /* "DO IX" */

   9024  1 000741   200041 235100                    LDA     IX,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:48   
         1 000742   000001 035007                    ADLA    1,DL
         1 000743   200041 755100                    STA     IX,,AUTO
         1 000744   200012 236100                    LDQ     NSUB,,AUTO
         1 000745   200041 116100                    CMPQ    IX,,AUTO
         1 000746   000546 603000 1                  TRC     s:8981
         1 000747   001372 710000 1                  TRA     s:9145

      248     9025        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:49   
      249     9026        /* L6 Pointer constant - .hex[-.b]  */
      250     9027    2          CASE ( 207 );            /* CNR2L6_CODE */

      251     9028    2             WORK.SIZE = 21;

   9028  1 000750   025000 236003                    LDQ     10752,DU
         1 000751   000000 552140                    STBQ    0,'40'O,PR0

      252     9029    2             TYPE = %PTR_FMT;

   9029  1 000752   000007 235007                    LDA     7,DL
         1 000753   200005 473500                    LDP3    @TYPE,,AUTO
         1 000754   300000 755100                    STA     0,,PR3

      253     9030    2             NSUB = NN$ -> POB.NSB - 1;

   9030  1 000755   400001 236100                    LDQ     1,,PR4
         1 000756   000022 772000                    QRL     18
         1 000757   000001 136007                    SBLQ    1,DL
         1 000760   200012 756100                    STQ     NSUB,,AUTO

      254     9031    3             DO IX = 0 TO NSUB;

   9031  1 000761   200041 450100                    STZ     IX,,AUTO
         1 000762   001052 710000 1                  TRA     s:9048+3

      255     9032    3                  NC$ = NN$ -> POB.SUBLK$( IX );

   9032  1 000763   200016 470500                    LDP0    NN$,,AUTO
         1 000764   200041 720100                    LXL0    IX,,AUTO
         1 000765   000003 236110                    LDQ     3,X0,PR0
         1 000766   200015 756100                    STQ     NC$,,AUTO

      256     9033    3                  NCD = NC$ -> POB.CODE;

   9033  1 000767   200015 471500                    LDP1    NC$,,AUTO
         1 000770   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:50   
         1 000771   777777 376007                    ANQ     -1,DL
         1 000772   200013 756100                    STQ     NCD,,AUTO

      257     9034    4                  DO CASE ( IX );

   9034  1 000773   200041 235100                    LDA     IX,,AUTO
         1 000774   000003 115007                    CMPA    3,DL
         1 000775   000777 602005 1                  TNC     s:9034+4,AL
         1 000776   001047 710000 1                  TRA     s:9048
         1 000777   001002 710000 1                  TRA     s:9036
         1 001000   001047 710000 1                  TRA     s:9048
         1 001001   001026 710000 1                  TRA     s:9043

      258     9035    4                    CASE( 0 );             /* "HEXIL" */

      259     9036    4                       CALL DDS$HEX( NC$, V ) ALTRET(ARET);

   9036  1 001002   200007 633500                    EPPR3   V,,AUTO
         1 001003   200053 453500                    STP3    GOTDOT+8,,AUTO
         1 001004   200015 634500                    EPPR4   NC$,,AUTO
         1 001005   200052 454500                    STP4    GOTDOT+7,,AUTO
         1 001006   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 001007   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001010   000000 701000 xent               TSX1    DDS$HEX
         1 001011   001406 702000 1                  TSX2    ARET

      260     9037    4                       IF (V > BITBIN('3777777'O))

   9037  1 001012   000000 236000 0                  LDQ     0
         1 001013   000017 772000                    QRL     15
         1 001014   001017 604000 1                  TMI     s:9039
         1 001015   200007 116100                    CMPQ    V,,AUTO
         1 001016   001403 604000 1                  TMI     TOOLARGE

      261     9038    4                       THEN GOTO TOOLARGE;
      262     9039    4                       WORK.P.ADR6.W = V;

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:51   
   9039  1 001017   200004 470500                    LDP0    @WORK,,AUTO
         1 001020   200007 236100                    LDQ     V,,AUTO
         1 001021   000020 736000                    QLS     16
         1 001022   000001 676100                    ERQ     1,,PR0
         1 001023   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 001024   000001 656100                    ERSQ    1,,PR0
         1 001025   001047 710000 1                  TRA     s:9048

      263     9040    4                    CASE( 1 );             /* "MINUS" */

      264     9041    4                       ;
      265     9042    4                    CASE( 2 );             /* "HEXIL1" */

      266     9043    4                       CALL DDS$HEX( NC$, V ) ALTRET(ARET);

   9043  1 001026   200007 633500                    EPPR3   V,,AUTO
         1 001027   200053 453500                    STP3    GOTDOT+8,,AUTO
         1 001030   200015 634500                    EPPR4   NC$,,AUTO
         1 001031   200052 454500                    STP4    GOTDOT+7,,AUTO
         1 001032   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 001033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001034   000000 701000 xent               TSX1    DDS$HEX
         1 001035   001406 702000 1                  TSX2    ARET

      267     9044    4                       IF (V > 1)

   9044  1 001036   200007 235100                    LDA     V,,AUTO
         1 001037   000001 115007                    CMPA    1,DL
         1 001040   001403 605400 1                  TPNZ    TOOLARGE

      268     9045    4                       THEN GOTO TOOLARGE;
      269     9046    4                       WORK.P.ADR6.C = V;

   9046  1 001041   200004 470500                    LDP0    @WORK,,AUTO
         1 001042   200007 236100                    LDQ     V,,AUTO
         1 001043   000017 736000                    QLS     15
         1 001044   000001 676100                    ERQ     1,,PR0
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:52   
         1 001045   100000 376007                    ANQ     32768,DL
         1 001046   000001 656100                    ERSQ    1,,PR0

      270     9047    4                    END;

      271     9048    3                END;

   9048  1 001047   200041 235100                    LDA     IX,,AUTO
         1 001050   000001 035007                    ADLA    1,DL
         1 001051   200041 755100                    STA     IX,,AUTO
         1 001052   200012 236100                    LDQ     NSUB,,AUTO
         1 001053   200041 116100                    CMPQ    IX,,AUTO
         1 001054   000763 603000 1                  TRC     s:9032
         1 001055   001372 710000 1                  TRA     s:9145

      272     9049        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:53   
      273     9050        /* COBOL unpacked decimal constant, leading sign */
      274     9051
      275     9052    2          CASE ( 204 );         /* CNR4COBOL_CODE */

      276     9053    2             TYPE = %PUP_FMT;              /* PUP_FMT */

   9053  1 001056   000035 235007                    LDA     29,DL
         1 001057   200005 475500                    LDP5    @TYPE,,AUTO
         1 001060   500000 755100                    STA     0,,PR5

      277     9054    2             IF ADDR(FMT) ~= ADDR(NIL) AND

   9054  1 001061   200006 236100                    LDQ     @FMT,,AUTO
         1 001062   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001063   001070 600000 1                  TZE     s:9058
         1 001064   200006 473500                    LDP3    @FMT,,AUTO
         1 001065   300000 235100                    LDA     0,,PR3
         1 001066   000020 115007                    CMPA    16,DL
         1 001067   001205 600000 1                  TZE     FLOAT

      278     9055    2               FMT = %FLOAT_FMT            /* FLOAT_FMT */
      279     9056    2             THEN GOTO FLOAT;
      280     9057        /*********WORK.EXP = 0;*********/
      281     9058    2             WORK.TEXT =
              9058                      '+00000000000000000000000000000000000000000000000000000000000000';

   9058  1 001070   040100 100400                    MLR     fill='040'O
         1 001071   000001 000077 0                  ADSC9   1                        cn=0,n=63
         1 001072   000000 200077                    ADSC9   0,,PR0                   cn=1,n=63

      282     9059    2             DEC$ = PINCRC( ADDR( WORK.TEXT ), LENGTHC( WORK.TEXT ) );

   9059  1 001073   200004 236100                    LDQ     @WORK,,AUTO
         1 001074   000020 036003                    ADLQ    16,DU
         1 001075   200040 756100                    STQ     DEC$,,AUTO

      283     9060    2             GOTDOT = '0'B;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:54   

   9060  1 001076   200043 450100                    STZ     GOTDOT,,AUTO

      284     9061    2             O = 0;

   9061  1 001077   200021 450100                    STZ     O,,AUTO

      285     9062    2             A = 0;

   9062  1 001100   200010 450100                    STZ     A,,AUTO

      286     9063    2             NSUB = NN$ -> POB.NSB;

   9063  1 001101   400001 236100                    LDQ     1,,PR4
         1 001102   000022 772000                    QRL     18
         1 001103   200012 756100                    STQ     NSUB,,AUTO

      287     9064    3             DO IX = 1 TO NSUB;

   9064  1 001104   000001 235007                    LDA     1,DL
         1 001105   200041 755100                    STA     IX,,AUTO
         1 001106   001176 710000 1                  TRA     s:9085+3

      288     9065    3                  NC$ = NN$ -> POB.SUBLK$( NSUB - IX );

   9065  1 001107   200012 236100                    LDQ     NSUB,,AUTO
         1 001110   200041 136100                    SBLQ    IX,,AUTO
         1 001111   200016 470500                    LDP0    NN$,,AUTO
         1 001112   000003 236106                    LDQ     3,QL,PR0
         1 001113   200015 756100                    STQ     NC$,,AUTO

      289     9066    3                  NCD = NC$ -> POB.CODE;

   9066  1 001114   200015 471500                    LDP1    NC$,,AUTO
         1 001115   100000 236100                    LDQ     0,,PR1
         1 001116   777777 376007                    ANQ     -1,DL
         1 001117   200013 756100                    STQ     NCD,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:55   

      290     9067    3                  IF NCD = 8        /* DEC_CODE */

   9067  1 001120   000010 116007                    CMPQ    8,DL
         1 001121   001155 601000 1                  TNZ     s:9078

      291     9068    4                  THEN DO;

      292     9069    4                       NC$ = NC$ -> POB.SUBLK$( 0 );

   9069  1 001122   100003 236100                    LDQ     3,,PR1
         1 001123   200015 756100                    STQ     NC$,,AUTO

      293     9070    4                       V = NC$ -> TEXT$C.SIZE;

   9070  1 001124   200015 471500                    LDP1    NC$,,AUTO
         1 001125   100000 236100                    LDQ     0,,PR1
         1 001126   000033 772000                    QRL     27
         1 001127   200007 756100                    STQ     V,,AUTO

      294     9071    4                       A = A + V;

   9071  1 001130   200010 036100                    ADLQ    A,,AUTO
         1 001131   200010 756100                    STQ     A,,AUTO

      295     9072    4                       IF A > LENGTHC( WORK.TEXT ) - 1 THEN GOTO TOOLARGE;

   9072  1 001132   000077 116007                    CMPQ    63,DL
         1 001133   001403 603000 1                  TRC     TOOLARGE

      296     9073    4                       DEC$ = PINCRC( DEC$, -V );

   9073  1 001134   200007 336100                    LCQ     V,,AUTO
         1 001135   000020 736000                    QLS     16
         1 001136   200040 036100                    ADLQ    DEC$,,AUTO
         1 001137   200040 756100                    STQ     DEC$,,AUTO

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:56   
      297     9074    4                       DECI$MAL = NC$ -> TEXT$C.TXT;

   9074  1 001140   100000 236100                    LDQ     0,,PR1
         1 001141   000033 772000                    QRL     27
         1 001142   000000 620006                    EAX0    0,QL
         1 001143   200040 473500                    LDP3    DEC$,,AUTO
         1 001144   200007 721100                    LXL1    V,,AUTO
         1 001145   040140 100540                    MLR     fill='040'O
         1 001146   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         1 001147   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

      298     9075    4                       IF NOT GOTDOT

   9075  1 001150   200043 234100                    SZN     GOTDOT,,AUTO
         1 001151   001173 604000 1                  TMI     s:9085

      299     9076    4                       THEN O = V;

   9076  1 001152   200007 235100                    LDA     V,,AUTO
         1 001153   200021 755100                    STA     O,,AUTO

      300     9077    4                     END;

   9077  1 001154   001173 710000 1                  TRA     s:9085

      301     9078    3                  ELSE IF NCD = 80   /* C@PERIOD */

   9078  1 001155   000120 116007                    CMPQ    80,DL
         1 001156   001166 601000 1                  TNZ     s:9083

      302     9079    4                       THEN DO;

      303     9080    4                            WORK.EXP = -O;

   9080  1 001157   200004 473500                    LDP3    @WORK,,AUTO
         1 001160   200021 336100                    LCQ     O,,AUTO
         1 001161   000033 736000                    QLS     27
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:57   
         1 001162   300000 552140                    STBQ    0,'40'O,PR3

      304     9081    4                            GOTDOT = '1'B;

   9081  1 001163   400000 236003                    LDQ     -131072,DU
         1 001164   200043 756100                    STQ     GOTDOT,,AUTO

      305     9082    4                          END;

   9082  1 001165   001173 710000 1                  TRA     s:9085

      306     9083    3                       ELSE IF NCD = 591 /* MINUS_CODE */

   9083  1 001166   001117 116007                    CMPQ    591,DL
         1 001167   001173 601000 1                  TNZ     s:9085

      307     9084    3                            THEN ADDR( WORK.TEXT ) -> CHAR$1 = '-';

   9084  1 001170   200004 473500                    LDP3    @WORK,,AUTO
         1 001171   000055 236003                    LDQ     45,DU
         1 001172   300000 552120                    STBQ    0,'20'O,PR3

      308     9085    3                END;                       /* "DO IX = 1 TO NSUB" */

   9085  1 001173   200041 235100                    LDA     IX,,AUTO
         1 001174   000001 035007                    ADLA    1,DL
         1 001175   200041 755100                    STA     IX,,AUTO
         1 001176   200012 236100                    LDQ     NSUB,,AUTO
         1 001177   200041 116100                    CMPQ    IX,,AUTO
         1 001200   001107 603000 1                  TRC     s:9065
         1 001201   001372 710000 1                  TRA     s:9145

      309     9086        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:58   
      310     9087        /* FORTRAN floating point (real) constant - +/-iiii.ffffD/E+/-eeee */
      311     9088
      312     9089    2          CASE ( 203 );          /* CNR4FORT_CODE */

      313     9090    2             TYPE = %FLOAT_FMT;            /* FLOAT_FMT */

   9090  1 001202   000020 235007                    LDA     16,DL
         1 001203   200005 475500                    LDP5    @TYPE,,AUTO
         1 001204   500000 755100                    STA     0,,PR5

   9090  1 001205                       FLOAT        null
      314     9091    2   FLOAT:    ;
      315     9092    2             WORK.SIZE = SIZEB( WORK.BITS.TRING );

   9092  1 001205   110000 236003                    LDQ     36864,DU
         1 001206   000000 552140                    STBQ    0,'40'O,PR0

      316     9093    2             FT$ = NN$;

   9093  1 001207   200016 236100                    LDQ     NN$,,AUTO
         1 001210   200022 756100                    STQ     FT$,,AUTO

      317     9094    2             CALL REAL_CNSNT ALTRET( ARET );

   9094  1 001211   001407 701000 1                  TSX1    REAL_CNSNT
         1 001212   001406 702000 1                  TSX2    ARET

      318     9095    2             WORK.BITS.TRING = FLOAT;

   9095  1 001213   200004 470500                    LDP0    @WORK,,AUTO
         1 001214   200024 237100                    LDAQ    FLOAT,,AUTO
         1 001215   000001 755100                    STA     1,,PR0
         1 001216   000002 756100                    STQ     2,,PR0
         1 001217   001372 710000 1                  TRA     s:9145

      319     9096
      320     9097        /* FORTRAN complex constant - (real,real) */
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:59   
      321     9098
      322     9099    2          CASE ( 205 );              /* CNR5_CODE */

      323     9100    2             TYPE = %CMPXFORT_FMT;         /* CMPXFORT_FMT */

   9100  1 001220   000032 235007                    LDA     26,DL
         1 001221   200005 475500                    LDP5    @TYPE,,AUTO
         1 001222   500000 755100                    STA     0,,PR5

      324     9101    2             WORK.SIZE = SIZEB( WORK.COMP.LEX1 );

   9101  1 001223   110000 236003                    LDQ     36864,DU
         1 001224   000000 552140                    STBQ    0,'40'O,PR0

      325     9102    2             FT$ = NN$ -> POB.SUBLK$( 0 );

   9102  1 001225   400003 236100                    LDQ     3,,PR4
         1 001226   200022 756100                    STQ     FT$,,AUTO

      326     9103    2             CALL REAL_CNSNT ALTRET( ARET );

   9103  1 001227   001407 701000 1                  TSX1    REAL_CNSNT
         1 001230   001406 702000 1                  TSX2    ARET

      327     9104    2             WORK.COMP.LEX1 = FLOAT;

   9104  1 001231   200004 470500                    LDP0    @WORK,,AUTO
         1 001232   200024 237100                    LDAQ    FLOAT,,AUTO
         1 001233   000001 755100                    STA     1,,PR0
         1 001234   000002 756100                    STQ     2,,PR0

      328     9105    2             FT$ = NN$ -> POB.SUBLK$( 1 );

   9105  1 001235   200016 471500                    LDP1    NN$,,AUTO
         1 001236   100004 236100                    LDQ     4,,PR1
         1 001237   200022 756100                    STQ     FT$,,AUTO

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:60   
      329     9106    2             CALL REAL_CNSNT ALTRET( ARET );

   9106  1 001240   001407 701000 1                  TSX1    REAL_CNSNT
         1 001241   001406 702000 1                  TSX2    ARET

      330     9107    2             WORK.COMP.LEX2 = FLOAT;

   9107  1 001242   200004 470500                    LDP0    @WORK,,AUTO
         1 001243   200024 237100                    LDAQ    FLOAT,,AUTO
         1 001244   000003 755100                    STA     3,,PR0
         1 001245   000004 756100                    STQ     4,,PR0
         1 001246   001372 710000 1                  TRA     s:9145

      331     9108
      332     9109        /* FORTRAN logical constant - TRUE, FALSE, .TRUE., .FALSE. */
      333     9110
      334     9111    2          CASE ( 206 );              /* CNR6_CODE */

      335     9112    2             TYPE = %BIT_FMT;              /* BIT_FMT */

   9112  1 001247   000005 235007                    LDA     5,DL
         1 001250   200005 475500                    LDP5    @TYPE,,AUTO
         1 001251   500000 755100                    STA     0,,PR5

      336     9113    2             WORK.SIZE = 1;

   9113  1 001252   001000 236003                    LDQ     512,DU
         1 001253   000000 552140                    STBQ    0,'40'O,PR0

      337     9114    2             IF NN$ -> POB.SUBLK$( 0 ) -> POB.CODE = 90 /* C@TRUE */

   9114  1 001254   400003 473500                    LDP3    3,,PR4
         1 001255   300000 720100                    LXL0    0,,PR3
         1 001256   000132 100003                    CMPX0   90,DU
         1 001257   001372 601000 1                  TNZ     s:9145

      338     9115    2             THEN WORK.BITS.TRING = '1'B;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:61   

   9115  1 001260   400000 235003                    LDA     -131072,DU
         1 001261   000000 236003                    LDQ     0,DU
         1 001262   000001 755100                    STA     1,,PR0
         1 001263   000002 756100                    STQ     2,,PR0
         1 001264   001372 710000 1                  TRA     s:9145

      339     9116        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:62   
      340     9117        /* Signed decimal or octal constants - +/-decimal, +/-.octal */
      341     9118
      342     9119    2          CASE ( ELSE );                   /* OPMD | OPMO */

      343     9120    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   9120  1 001265   000000 475400 xsym               LDP5    S_D$
         1 001266   506714 235100                    LDA     3532,,PR5
         1 001267   000001 115007                    CMPA    1,DL
         1 001270   001274 601000 1                  TNZ     s:9122

      344     9121    2             THEN WORK.SIZE = SIZEB( WORK.CONS.TANT );

   9121  1 001271   044000 236003                    LDQ     18432,DU
         1 001272   000000 552140                    STBQ    0,'40'O,PR0
         1 001273   001276 710000 1                  TRA     s:9123

      345     9122    2             ELSE WORK.SIZE = 32;

   9122  1 001274   040000 236003                    LDQ     16384,DU
         1 001275   000000 552140                    STBQ    0,'40'O,PR0

      346     9123    2             NSUB = N$ -> POB.NSB - 1;

   9123  1 001276   100000 473500                    LDP3    0,,PR1
         1 001277   300001 236100                    LDQ     1,,PR3
         1 001300   000022 772000                    QRL     18
         1 001301   000001 136007                    SBLQ    1,DL
         1 001302   200012 756100                    STQ     NSUB,,AUTO

      347     9124    2             NC$ = NN$;

   9124  1 001303   200016 236100                    LDQ     NN$,,AUTO
         1 001304   200015 756100                    STQ     NC$,,AUTO

      348     9125    2             NCD = NN$ -> POB.CODE;

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:63   
   9125  1 001305   400000 236100                    LDQ     0,,PR4
         1 001306   777777 376007                    ANQ     -1,DL
         1 001307   200013 756100                    STQ     NCD,,AUTO

      349     9126    2             IF ( NSUB = 1 )               /* Really 2 */

   9126  1 001310   200012 235100                    LDA     NSUB,,AUTO
         1 001311   000001 115007                    CMPA    1,DL
         1 001312   001316 601000 1                  TNZ     s:9128

      350     9127    2             THEN NC$ = N$ -> POB.SUBLK$( 1 );

   9127  1 001313   100000 473500                    LDP3    0,,PR1
         1 001314   300004 236100                    LDQ     4,,PR3
         1 001315   200015 756100                    STQ     NC$,,AUTO

      351     9128    2             IF ( NC$ -> POB.CODE = 8 ) /* DEC_CODE */

   9128  1 001316   200015 473500                    LDP3    NC$,,AUTO
         1 001317   300000 720100                    LXL0    0,,PR3
         1 001320   000010 100003                    CMPX0   8,DU
         1 001321   001347 601000 1                  TNZ     s:9136

      352     9129    3             THEN DO;

      353     9130    3                  IF ( NCD = 590 ) OR ( NCD = 591 ) /* PLUS_CODE, MINUS_CODE */

   9130  1 001322   200013 236100                    LDQ     NCD,,AUTO
         1 001323   001116 116007                    CMPQ    590,DL
         1 001324   001327 600000 1                  TZE     s:9131
         1 001325   001117 116007                    CMPQ    591,DL
         1 001326   001333 601000 1                  TNZ     s:9132

      354     9131    3                  THEN TYPE = %SINT_FMT;   /* SINT_FMT */

   9131  1 001327   000003 235007                    LDA     3,DL
         1 001330   200005 476500                    LDP6    @TYPE,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:64   
         1 001331   600000 755100                    STA     0,,PR6
         1 001332   001336 710000 1                  TRA     s:9133

      355     9132    3                  ELSE TYPE = %UINT_FMT;   /* UINT_FMT */

   9132  1 001333   000002 235007                    LDA     2,DL
         1 001334   200005 476500                    LDP6    @TYPE,,AUTO
         1 001335   600000 755100                    STA     0,,PR6

      356     9133    3                  CALL DDS$DECIMAL( NC$, V ) ALTRET( ARET );

   9133  1 001336   200007 633500                    EPPR3   V,,AUTO
         1 001337   200053 453500                    STP3    GOTDOT+8,,AUTO
         1 001340   200015 637500                    EPPR7   NC$,,AUTO
         1 001341   200052 457500                    STP7    GOTDOT+7,,AUTO
         1 001342   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 001343   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001344   000000 701000 xent               TSX1    DDS$DECIMAL
         1 001345   001406 702000 1                  TSX2    ARET

      357     9134    3                END;

   9134  1 001346   001362 710000 1                  TRA     s:9139

      358     9135    3             ELSE DO;

      359     9136    3                  TYPE = %OCT_FMT;         /* OCT_FMT */

   9136  1 001347   000001 236007                    LDQ     1,DL
         1 001350   200005 476500                    LDP6    @TYPE,,AUTO
         1 001351   600000 756100                    STQ     0,,PR6

      360     9137    3                  CALL DDS$OCTAL( NC$, V ) ALTRET( ARET );

   9137  1 001352   200007 633500                    EPPR3   V,,AUTO
         1 001353   200053 453500                    STP3    GOTDOT+8,,AUTO
         1 001354   200015 637500                    EPPR7   NC$,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:65   
         1 001355   200052 457500                    STP7    GOTDOT+7,,AUTO
         1 001356   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 001357   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001360   000000 701000 xent               TSX1    DDS$OCTAL
         1 001361   001406 702000 1                  TSX2    ARET

      361     9138    3                END;

      362     9139    2             IF ( NCD = 591 )       /* MINUS_CODE */

   9139  1 001362   200013 235100                    LDA     NCD,,AUTO
         1 001363   001117 115007                    CMPA    591,DL
         1 001364   001367 601000 1                  TNZ     s:9141

      363     9140    2             THEN V = -V;

   9140  1 001365   200007 336100                    LCQ     V,,AUTO
         1 001366   200007 756100                    STQ     V,,AUTO

      364     9141    2             WORK.CONS.TANT = V;

   9141  1 001367   200004 470500                    LDP0    @WORK,,AUTO
         1 001370   200007 236100                    LDQ     V,,AUTO
         1 001371   000001 756100                    STQ     1,,PR0

      365     9142
      366     9143    2          END;                             /* "DO CASE ( CODE )" */

      367     9144
      368     9145    1        RETURN;

   9145  1 001372   000000 702200 xent               TSX2  ! X66_ARET

      369     9146
      370     9147    1   BADDIG: S_D.ERROR = 65; GOTO ARET; /* E@BADDIG */

   9147  1 001373   000101 236007       BADDIG       LDQ     65,DL
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:66   
         1 001374   000000 471400 xsym               LDP1    S_D$
         1 001375   100013 756100                    STQ     11,,PR1

   9147  1 001376   001406 710000 1                  TRA     ARET

      371     9148    1   CONSTOOBIG: S_D.ERROR = 64; GOTO ARET; /* E@CONSTOOBIG */

   9148  1 001377   000100 235007       CONSTOOBIG   LDA     64,DL
         1 001400   000000 473400 xsym               LDP3    S_D$
         1 001401   300013 755100                    STA     11,,PR3

   9148  1 001402   001406 710000 1                  TRA     ARET

      372     9149    1   TOOLARGE: S_D.ERROR = 46;       /* E@TOOLARGE */

   9149  1 001403   000056 235007       TOOLARGE     LDA     46,DL
         1 001404   000000 470400 xsym               LDP0    S_D$
         1 001405   000013 755100                    STA     11,,PR0

      373     9150
      374     9151    1   ARET: ALTRETURN;

   9151  1 001406   000000 702200 xent  ARET         TSX2  ! X66_AALT

      375     9152
      376     9153        %EJECT;
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:67   
      377     9154        /*F* NAME: REAL_CNSNT
      378     9155             PURPOSE: To convert text to a FORTRAN floating point constant.
      379     9156             DESCRIPTION: The sign, integer, fraction, and exponent parts are
      380     9157                          processed in turn. The actual conversion is done by
      381     9158                          the common library routine XPN_7LSPTOD. */
      382     9159        /*D* NAME: REAL_CNSNT
      383     9160             CALL: CALL REAL_CNSNT ALTRET( error );
      384     9161             INTERFACE: DDS$DECIMAL
      385     9162                        XPN_7LSPTOD
      386     9163             ENVIRONMENT: DDS$CNSNT active.
      387     9164             INPUT: FT$ - Pointer to "FORT_REAL" node.
      388     9165             OUTPUT: FLOAT - floating point constant.
      389     9166             SCRATCH: O, A, V, FTEXT, FTSIZ, NSUB, IX, NC$, NCD
      390     9167             DESCRIPTION: The sign, integer part & fractional part are picked
      391     9168                          up and packed into FTEXT. The exponent is picked up,
      392     9169                          converted to binary, and adjusted by the number of
      393     9170                          digits in the fractional part. The actual conversion
      394     9171                          is done by XPN_7LSPTOD. */
      395     9172
      396     9173    1   REAL_CNSNT: PROC ALTRET;

   9173  1 001407   200050 741300       REAL_CNSNT   STX1  ! GOTDOT+5,,AUTO

      397     9174
      398     9175    2        O = 0;

   9175  1 001410   200021 450100                    STZ     O,,AUTO

      399     9176    2        V = 0;

   9176  1 001411   200007 450100                    STZ     V,,AUTO

      400     9177    2        FTEXT = '+';

   9177  1 001412   040100 100400                    MLR     fill='040'O
         1 001413   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 001414   200026 000026                    ADSC9   FTEXT,,AUTO              cn=0,n=22
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:68   

      401     9178    2        FTSIZ = LENGTHC( '+' );

   9178  1 001415   000001 235007                    LDA     1,DL
         1 001416   200034 755100                    STA     FTSIZ,,AUTO

      402     9179    2        NSUB = FT$ -> POB.NSB - 1;

   9179  1 001417   200022 470500                    LDP0    FT$,,AUTO
         1 001420   000001 236100                    LDQ     1,,PR0
         1 001421   000022 772000                    QRL     18
         1 001422   000001 136007                    SBLQ    1,DL
         1 001423   200012 756100                    STQ     NSUB,,AUTO

      403     9180    2        IF CODE = 204           /* CNR4COBOL_CODE */

   9180  1 001424   200014 235100                    LDA     CODE,,AUTO
         1 001425   000314 115007                    CMPA    204,DL
         1 001426   001551 601000 1                  TNZ     s:9214

      404     9181    3        THEN DO;

      405     9182    3             IF NSUB < 2

   9182  1 001427   000002 116007                    CMPQ    2,DL
         1 001430   001752 602000 1                  TNC     BADCONST

      406     9183    3             THEN GOTO BADCONST;
      407     9184    3             IX = 0;

   9184  1 001431   200041 450100                    STZ     IX,,AUTO

      408     9185    3             NC$ = FT$ -> POB.SUBLK$( IX );

   9185  1 001432   200041 720100                    LXL0    IX,,AUTO
         1 001433   000003 236110                    LDQ     3,X0,PR0
         1 001434   200015 756100                    STQ     NC$,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:69   

      409     9186    3             NCD = NC$ -> POB.CODE;

   9186  1 001435   200015 471500                    LDP1    NC$,,AUTO
         1 001436   100000 236100                    LDQ     0,,PR1
         1 001437   777777 376007                    ANQ     -1,DL
         1 001440   200013 756100                    STQ     NCD,,AUTO

      410     9187    3             IF NCD = 8             /* DEC_CODE */

   9187  1 001441   000010 116007                    CMPQ    8,DL
         1 001442   001473 601000 1                  TNZ     s:9196

      411     9188    4             THEN DO;

      412     9189    4                  NC$ = NC$ -> POB.SUBLK$( 0 );

   9189  1 001443   100003 236100                    LDQ     3,,PR1
         1 001444   200015 756100                    STQ     NC$,,AUTO

      413     9190    4                  A = FTSIZ + NC$ -> TEXT$C.SIZE;

   9190  1 001445   200015 471500                    LDP1    NC$,,AUTO
         1 001446   100000 236100                    LDQ     0,,PR1
         1 001447   000033 772000                    QRL     27
         1 001450   200034 036100                    ADLQ    FTSIZ,,AUTO
         1 001451   200010 756100                    STQ     A,,AUTO

      414     9191    4                  IF A > LENGTHC( FTEXT ) THEN GOTO TOOL;

   9191  1 001452   000027 116007                    CMPQ    23,DL
         1 001453   001746 603000 1                  TRC     TOOL

      415     9192    4                  CALL INSERT( FTEXT, FTSIZ, , NC$ -> TEXT$C.TXT);

   9192  1 001454   100000 236100                    LDQ     0,,PR1
         1 001455   000033 772000                    QRL     27
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:70   
         1 001456   200034 722100                    LXL2    FTSIZ,,AUTO
         1 001457   777751 622012                    EAX2    -23,X2
         1 001460   777777 662003                    ERX2    -1,DU
         1 001461   000000 623006                    EAX3    0,QL
         1 001462   200034 235100                    LDA     FTSIZ,,AUTO
         1 001463   040145 100540                    MLR     fill='040'O
         1 001464   100000 200013                    ADSC9   0,,PR1                   cn=1,n=*X3
         1 001465   200026 000012                    ADSC9   FTEXT,A,AUTO             cn=0,n=*X2

      416     9193    4                  FTSIZ = A;

   9193  1 001466   200010 235100                    LDA     A,,AUTO
         1 001467   200034 755100                    STA     FTSIZ,,AUTO

      417     9194    4                  IX = IX + 1;

   9194  1 001470   200041 236100                    LDQ     IX,,AUTO
         1 001471   000001 036007                    ADLQ    1,DL
         1 001472   200041 756100                    STQ     IX,,AUTO

      418     9195    4                END;

      419     9196    3             NC$ = FT$ -> POB.SUBLK$( IX );

   9196  1 001473   200041 720100                    LXL0    IX,,AUTO
         1 001474   000003 236110                    LDQ     3,X0,PR0
         1 001475   200015 756100                    STQ     NC$,,AUTO

      420     9197    3             NCD = NC$ -> POB.CODE;

   9197  1 001476   200015 471500                    LDP1    NC$,,AUTO
         1 001477   100000 236100                    LDQ     0,,PR1
         1 001500   777777 376007                    ANQ     -1,DL
         1 001501   200013 756100                    STQ     NCD,,AUTO

      421     9198    3             IF NCD ~= 80            /* C@PERIOD */

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:71   
   9198  1 001502   000120 116007                    CMPQ    80,DL
         1 001503   001761 601000 1                  TNZ     ARET

      422     9199    3             THEN GOTO ARET;
      423     9200    3             IX = IX + 1;

   9200  1 001504   200041 235100                    LDA     IX,,AUTO
         1 001505   000001 035007                    ADLA    1,DL
         1 001506   200041 755100                    STA     IX,,AUTO

      424     9201    3             NC$ = FT$ -> POB.SUBLK$( IX );

   9201  1 001507   000003 236105                    LDQ     3,AL,PR0
         1 001510   200015 756100                    STQ     NC$,,AUTO

      425     9202    3             NCD = NC$ -> POB.CODE;

   9202  1 001511   200015 471500                    LDP1    NC$,,AUTO
         1 001512   100000 236100                    LDQ     0,,PR1
         1 001513   777777 376007                    ANQ     -1,DL
         1 001514   200013 756100                    STQ     NCD,,AUTO

      426     9203    3             IF NCD = 8             /* DEC_CODE */

   9203  1 001515   000010 116007                    CMPQ    8,DL
         1 001516   001550 601000 1                  TNZ     s:9212

      427     9204    4             THEN DO;

      428     9205    4                  NC$ = NC$ -> POB.SUBLK$( 0 );

   9205  1 001517   100003 236100                    LDQ     3,,PR1
         1 001520   200015 756100                    STQ     NC$,,AUTO

      429     9206    4                  O = - NC$ -> TEXT$C.SIZE;

   9206  1 001521   200015 471500                    LDP1    NC$,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:72   
         1 001522   100000 236100                    LDQ     0,,PR1
         1 001523   000033 772000                    QRL     27
         1 001524   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 001525   000001 036007                    ADLQ    1,DL
         1 001526   200021 756100                    STQ     O,,AUTO

      430     9207    4                  A = FTSIZ - O;

   9207  1 001527   200034 236100                    LDQ     FTSIZ,,AUTO
         1 001530   200021 136100                    SBLQ    O,,AUTO
         1 001531   200010 756100                    STQ     A,,AUTO

      431     9208    4                  IF A > LENGTHC( FTEXT ) THEN GOTO TOOL;

   9208  1 001532   000027 116007                    CMPQ    23,DL
         1 001533   001746 603000 1                  TRC     TOOL

      432     9209    4                  CALL INSERT( FTEXT, FTSIZ, , NC$ -> TEXT$C.TXT);

   9209  1 001534   100000 236100                    LDQ     0,,PR1
         1 001535   000033 772000                    QRL     27
         1 001536   200034 720100                    LXL0    FTSIZ,,AUTO
         1 001537   777751 620010                    EAX0    -23,X0
         1 001540   777777 660003                    ERX0    -1,DU
         1 001541   000000 621006                    EAX1    0,QL
         1 001542   200034 235100                    LDA     FTSIZ,,AUTO
         1 001543   040145 100540                    MLR     fill='040'O
         1 001544   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         1 001545   200026 000010                    ADSC9   FTEXT,A,AUTO             cn=0,n=*X0

      433     9210    4                  FTSIZ = A;

   9210  1 001546   200010 235100                    LDA     A,,AUTO
         1 001547   200034 755100                    STA     FTSIZ,,AUTO

      434     9211    4                END;

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:73   
      435     9212    3             GOTO COMMON;

   9212  1 001550   001722 710000 1                  TRA     COMMON

      436     9213    3           END;
      437     9214    3        DO IX = 0 TO NSUB;

   9214  1 001551   200041 450100                    STZ     IX,,AUTO
         1 001552   001717 710000 1                  TRA     s:9249+3

      438     9215    3             NC$ = FT$ -> POB.SUBLK$( IX );

   9215  1 001553   200022 470500                    LDP0    FT$,,AUTO
         1 001554   200041 720100                    LXL0    IX,,AUTO
         1 001555   000003 236110                    LDQ     3,X0,PR0
         1 001556   200015 756100                    STQ     NC$,,AUTO

      439     9216    3             NCD = NC$ -> POB.CODE;

   9216  1 001557   200015 471500                    LDP1    NC$,,AUTO
         1 001560   100000 236100                    LDQ     0,,PR1
         1 001561   777777 376007                    ANQ     -1,DL
         1 001562   200013 756100                    STQ     NCD,,AUTO

      440     9217    3             IF NCD = 591           /* MINUS_CODE */

   9217  1 001563   001117 116007                    CMPQ    591,DL
         1 001564   001571 601000 1                  TNZ     s:9219

      441     9218    3             THEN FTEXT = '-';

   9218  1 001565   040100 100400                    MLR     fill='040'O
         1 001566   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 001567   200026 000026                    ADSC9   FTEXT,,AUTO              cn=0,n=22
         1 001570   001714 710000 1                  TRA     s:9249

      442     9219    3             ELSE IF NCD = 570      /* FORTI_CODE */
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:74   

   9219  1 001571   001072 116007                    CMPQ    570,DL
         1 001572   001622 601000 1                  TNZ     s:9227

      443     9220    4                  THEN DO;

      444     9221    4                       NC$ = NC$ -> POB.SUBLK$( 0 ) -> POB.SUBLK$( 0 );

   9221  1 001573   100003 473500                    LDP3    3,,PR1
         1 001574   300003 236100                    LDQ     3,,PR3
         1 001575   200015 756100                    STQ     NC$,,AUTO

      445     9222    4                       A = FTSIZ + NC$ -> TEXT$C.SIZE;

   9222  1 001576   200015 471500                    LDP1    NC$,,AUTO
         1 001577   100000 236100                    LDQ     0,,PR1
         1 001600   000033 772000                    QRL     27
         1 001601   200034 036100                    ADLQ    FTSIZ,,AUTO
         1 001602   200010 756100                    STQ     A,,AUTO

      446     9223    4                       IF A > LENGTHC( FTEXT ) THEN GOTO TOOL;

   9223  1 001603   000027 116007                    CMPQ    23,DL
         1 001604   001746 603000 1                  TRC     TOOL

      447     9224    4                       CALL INSERT( FTEXT, FTSIZ, , NC$ -> TEXT$C.TXT );

   9224  1 001605   100000 236100                    LDQ     0,,PR1
         1 001606   000033 772000                    QRL     27
         1 001607   200034 721100                    LXL1    FTSIZ,,AUTO
         1 001610   777751 621011                    EAX1    -23,X1
         1 001611   777777 661003                    ERX1    -1,DU
         1 001612   000000 622006                    EAX2    0,QL
         1 001613   200034 235100                    LDA     FTSIZ,,AUTO
         1 001614   040145 100540                    MLR     fill='040'O
         1 001615   100000 200012                    ADSC9   0,,PR1                   cn=1,n=*X2
         1 001616   200026 000011                    ADSC9   FTEXT,A,AUTO             cn=0,n=*X1
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:75   

      448     9225    4                       FTSIZ = A;

   9225  1 001617   200010 235100                    LDA     A,,AUTO
         1 001620   200034 755100                    STA     FTSIZ,,AUTO

      449     9226    4                     END;

   9226  1 001621   001714 710000 1                  TRA     s:9249

      450     9227    3                  ELSE IF NCD = 571 /* FORTF_CODE */

   9227  1 001622   001073 116007                    CMPQ    571,DL
         1 001623   001657 601000 1                  TNZ     s:9236

      451     9228    4                       THEN DO;

      452     9229    4                            NC$ = NC$ -> POB.SUBLK$( 0 ) -> POB.SUBLK$( 0 );

   9229  1 001624   100003 473500                    LDP3    3,,PR1
         1 001625   300003 236100                    LDQ     3,,PR3
         1 001626   200015 756100                    STQ     NC$,,AUTO

      453     9230    4                            O = -NC$ -> TEXT$C.SIZE;

   9230  1 001627   200015 471500                    LDP1    NC$,,AUTO
         1 001630   100000 236100                    LDQ     0,,PR1
         1 001631   000033 772000                    QRL     27
         1 001632   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 001633   000001 036007                    ADLQ    1,DL
         1 001634   200021 756100                    STQ     O,,AUTO

      454     9231    4                            A = FTSIZ - O;

   9231  1 001635   200034 236100                    LDQ     FTSIZ,,AUTO
         1 001636   200021 136100                    SBLQ    O,,AUTO
         1 001637   200010 756100                    STQ     A,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:76   

      455     9232    4                            IF A > LENGTHC( FTEXT ) THEN GOTO TOOL;

   9232  1 001640   000027 116007                    CMPQ    23,DL
         1 001641   001746 603000 1                  TRC     TOOL

      456     9233    4                            CALL INSERT( FTEXT, FTSIZ, , NC$ -> TEXT$C.TXT );

   9233  1 001642   100000 236100                    LDQ     0,,PR1
         1 001643   000033 772000                    QRL     27
         1 001644   200034 721100                    LXL1    FTSIZ,,AUTO
         1 001645   777751 621011                    EAX1    -23,X1
         1 001646   777777 661003                    ERX1    -1,DU
         1 001647   000000 622006                    EAX2    0,QL
         1 001650   200034 235100                    LDA     FTSIZ,,AUTO
         1 001651   040145 100540                    MLR     fill='040'O
         1 001652   100000 200012                    ADSC9   0,,PR1                   cn=1,n=*X2
         1 001653   200026 000011                    ADSC9   FTEXT,A,AUTO             cn=0,n=*X1

      457     9234    4                            FTSIZ = A;

   9234  1 001654   200010 235100                    LDA     A,,AUTO
         1 001655   200034 755100                    STA     FTSIZ,,AUTO

      458     9235    4                          END;

   9235  1 001656   001714 710000 1                  TRA     s:9249

      459     9236    3                       ELSE IF NCD = 572 /* FORTE_CODE */

   9236  1 001657   001074 116007                    CMPQ    572,DL
         1 001660   001714 601000 1                  TNZ     s:9249

      460     9237    4                            THEN DO;

      461     9238    4                                 V = 1;

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:77   
   9238  1 001661   000001 235007                    LDA     1,DL
         1 001662   200007 755100                    STA     V,,AUTO

      462     9239    4                                 IF NC$ -> POB.NSB > 1

   9239  1 001663   100001 221100                    LDX1    1,,PR1
         1 001664   000002 101003                    CMPX1   2,DU
         1 001665   001677 602000 1                  TNC     s:9245

      463     9240    5                                 THEN DO;

      464     9241    5                                      IF NC$ -> POB.SUBLK$( 0 ) -> POB.CODE = 591
              9241                                               /* MINUS_CODE */

   9241  1 001666   100003 473500                    LDP3    3,,PR1
         1 001667   300000 722100                    LXL2    0,,PR3
         1 001670   001117 102003                    CMPX2   591,DU
         1 001671   001674 601000 1                  TNZ     s:9243

      465     9242    5                                      THEN V = -1;

   9242  1 001672   000001 335007                    LCA     1,DL
         1 001673   200007 755100                    STA     V,,AUTO

      466     9243    5                                      NC$ = NC$ -> POB.SUBLK$( 1 );

   9243  1 001674   100004 236100                    LDQ     4,,PR1
         1 001675   200015 756100                    STQ     NC$,,AUTO

      467     9244    5                                    END;

   9244  1 001676   001701 710000 1                  TRA     s:9246

      468     9245    4                                 ELSE NC$ = NC$ -> POB.SUBLK$( 0 );

   9245  1 001677   100003 236100                    LDQ     3,,PR1
         1 001700   200015 756100                    STQ     NC$,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:78   

      469     9246    4                                 CALL DDS$DECIMAL( NC$, A ) ALTRET( ARET );

   9246  1 001701   200010 631500                    EPPR1   A,,AUTO
         1 001702   200053 451500                    STP1    GOTDOT+8,,AUTO
         1 001703   200015 633500                    EPPR3   NC$,,AUTO
         1 001704   200052 453500                    STP3    GOTDOT+7,,AUTO
         1 001705   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 001706   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001707   000000 701000 xent               TSX1    DDS$DECIMAL
         1 001710   001761 702000 1                  TSX2    ARET

      470     9247    4                                 V = V * A;

   9247  1 001711   200007 236100                    LDQ     V,,AUTO
         1 001712   200010 402100                    MPY     A,,AUTO
         1 001713   200007 756100                    STQ     V,,AUTO

      471     9248    4                               END;

      472     9249    3           END;

   9249  1 001714   200041 235100                    LDA     IX,,AUTO
         1 001715   000001 035007                    ADLA    1,DL
         1 001716   200041 755100                    STA     IX,,AUTO
         1 001717   200012 236100                    LDQ     NSUB,,AUTO
         1 001720   200041 116100                    CMPQ    IX,,AUTO
         1 001721   001553 603000 1                  TRC     s:9215

   9247  1 001722                       COMMON       null
      473     9250
      474     9251    2   COMMON: ;
      475     9252    2        O = O + V;

   9252  1 001722   200021 236100                    LDQ     O,,AUTO
         1 001723   200007 036100                    ADLQ    V,,AUTO
         1 001724   200021 756100                    STQ     O,,AUTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:79   

      476     9253    2        FTSIZ = FTSIZ - 1;                 /* Number of digits */

   9253  1 001725   200034 235100                    LDA     FTSIZ,,AUTO
         1 001726   000001 135007                    SBLA    1,DL
         1 001727   200034 755100                    STA     FTSIZ,,AUTO

      477     9254    2        CALL XPN_7LSPTOD( FLOAT, FTEXT, FTSIZ, O ) ALTRET( XPNA );

   9254  1 001730   200021 630500                    EPPR0   O,,AUTO
         1 001731   200055 450500                    STP0    GOTDOT+10,,AUTO
         1 001732   200034 631500                    EPPR1   FTSIZ,,AUTO
         1 001733   200054 451500                    STP1    GOTDOT+9,,AUTO
         1 001734   200026 633500                    EPPR3   FTEXT,,AUTO
         1 001735   200053 453500                    STP3    GOTDOT+8,,AUTO
         1 001736   200024 634500                    EPPR4   FLOAT,,AUTO
         1 001737   200052 454500                    STP4    GOTDOT+7,,AUTO
         1 001740   200052 630500                    EPPR0   GOTDOT+7,,AUTO
         1 001741   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001742   000000 701000 xent               TSX1    XPN_7LSPTOD
         1 001743   001756 702000 1                  TSX2    XPNA

      478     9255
      479     9256    2        RETURN;

   9256  1 001744   200050 221300                    LDX1  ! GOTDOT+5,,AUTO
         1 001745   000001 702211                    TSX2  ! 1,X1

      480     9257
      481     9258    2   TOOL: S_D.ERROR = 46; GOTO ARET; /* E@TOOLARGE */

   9258  1 001746   000056 235007       TOOL         LDA     46,DL
         1 001747   000000 473400 xsym               LDP3    S_D$
         1 001750   300013 755100                    STA     11,,PR3

   9258  1 001751   001761 710000 1                  TRA     ARET

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:80   
      482     9259    2   BADCONST: S_D.ERROR = 293; GOTO ARET; /* E@BAD_CONSTANT */

   9259  1 001752   000445 235007       BADCONST     LDA     293,DL
         1 001753   000000 471400 xsym               LDP1    S_D$
         1 001754   100013 755100                    STA     11,,PR1

   9259  1 001755   001761 710000 1                  TRA     ARET

      483     9260    2   XPNA: S_D.ERROR = 199;           /* E@FORTREAL */

   9260  1 001756   000307 235007       XPNA         LDA     199,DL
         1 001757   000000 470400 xsym               LDP0    S_D$
         1 001760   000013 755100                    STA     11,,PR0

      484     9261
      485     9262    2   ARET: ALTRETURN;

   9262  1 001761   200050 221300       ARET         LDX1  ! GOTDOT+5,,AUTO
         1 001762   000000 702211                    TSX2  ! 0,X1

(unnamed)
 Sect OctLoc
   0     000   377777 700000   053060 060060   060060 060060   060060 060060    ....+00000000000
   0     004   060060 060060   060060 060060   060060 060060   060060 060060    0000000000000000
   0     020*  060060 060040                                                    000

(unnamed)
 Sect OctLoc
   2     000   053040 040040   055040 040040                                    +   -
      486     9263
      487     9264    2   END REAL_CNSNT;
      488     9265
      489     9266    1   END DDS$CNSNT;

PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:81   
--  Include file information  --

   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDS$CNSNT.

   Procedure DDS$CNSNT requires 1011 words for executable code.
   Procedure DDS$CNSNT requires 46 words of local(AUTO) storage.

    No errors detected in file DDS$CNSNT.:E05TSI    .
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:82   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:83   
          MINI XREF LISTING

A
      1380**DCL      8928<<ASSIGN   8932<<ASSIGN   8932>>ASSIGN   8934>>ASSIGN   8942<<ASSIGN   8950<<ASSIGN
      8950>>ASSIGN   8952>>ASSIGN   9062<<ASSIGN   9071<<ASSIGN   9071>>ASSIGN   9072>>IF       9190<<ASSIGN
      9191>>IF       9193>>ASSIGN   9207<<ASSIGN   9208>>IF       9210>>ASSIGN   9222<<ASSIGN   9223>>IF
      9225>>ASSIGN   9231<<ASSIGN   9232>>IF       9234>>ASSIGN   9246<>CALL     9247>>ASSIGN
ARET
      9151**LABEL    8994--CALLALT  9007--CALLALT  9020--CALLALT  9036--CALLALT  9043--CALLALT  9094--CALLALT
      9103--CALLALT  9106--CALLALT  9133--CALLALT  9137--CALLALT  9147--GOTO     9148--GOTO
ARET IN PROCEDURE REAL_CNSNT
      9262**LABEL    9199--GOTO     9246--CALLALT  9258--GOTO     9259--GOTO
BADCONST IN PROCEDURE REAL_CNSNT
      9259**LABEL    9183--GOTO
BADDIG
      9147**LABEL    8901--GOTO     8913--GOTO     8931--GOTO     8949--GOTO     8967--GOTO
BIT$
      1407**DCL      1394--IMP-PTR  8893<<ASSIGN   8900>>ASSIGN   8902<<ASSIGN   8902>>ASSIGN
BITT
      1394**DCL      8900<<ASSIGN   8902--ASSIGN
C
      1388**DCL      8895<<ASSIGN   8896>>IF       8899>>IF       8944<<ASSIGN   8945>>IF       8945>>IF
      8946>>ASSIGN   8947>>IF       8947>>IF       8948>>ASSIGN   8962<<ASSIGN   8963>>IF       8963>>IF
      8964>>ASSIGN   8965>>IF       8965>>IF       8966>>ASSIGN
CHAR$1
      1397**DCL      9084<<ASSIGN
CHAR$T1.ODIG
      1401**DCL      9002>>ASSIGN
CODE
      1384**DCL      8864<<ASSIGN   8866>>DOCASE   8875>>IF       8937>>IF       9180>>IF
COMMON IN PROCEDURE REAL_CNSNT
      9247**LABEL    9212--GOTO
CONSTOOBIG
      9148**LABEL    8890--GOTO     8907--GOTO     8920--GOTO     8926--GOTO     8940--GOTO     8957--GOTO
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:84   
DDS$DECIMAL
      7305**DCL-ENT  9133--CALL     9246--CALL
DDS$HEX
      7304**DCL-ENT  9036--CALL     9043--CALL
DDS$OCTAL
      7303**DCL-ENT  8994--CALL     9007--CALL     9137--CALL
DDS$SDO
      7306**DCL-ENT  9020--CALL
DEC$
      1410**DCL      1398--IMP-PTR  9059<<ASSIGN   9073<<ASSIGN   9073>>ASSIGN   9074>>ASSIGN
DECI$MAL
      1398**DCL      9074<<ASSIGN
FLOAT
      9090**LABEL    9056--GOTO     9095>>ASSIGN   9104>>ASSIGN   9107>>ASSIGN   9254<>CALL
FMT
      1378**DCL        33--PROC     9054--IF       9054>>IF
FT$
      1390**DCL      9093<<ASSIGN   9102<<ASSIGN   9105<<ASSIGN   9179>>ASSIGN   9185>>ASSIGN   9196>>ASSIGN
      9201>>ASSIGN   9215>>ASSIGN
FTEXT
      1392**DCL      9177<<ASSIGN   9191--IF       9192<<CALLBLT  9208--IF       9209<<CALLBLT  9218<<ASSIGN
      9223--IF       9224<<CALLBLT  9232--IF       9233<<CALLBLT  9254<>CALL
FTSIZ
      1393**DCL      9178<<ASSIGN   9190>>ASSIGN   9192>>CALLBLT  9193<<ASSIGN   9207>>ASSIGN   9209>>CALLBLT
      9210<<ASSIGN   9222>>ASSIGN   9224>>CALLBLT  9225<<ASSIGN   9231>>ASSIGN   9233>>CALLBLT  9234<<ASSIGN
      9253<<ASSIGN   9253>>ASSIGN   9254<>CALL
GOTDOT
      1413**DCL      9060<<ASSIGN   9075>>IF       9081<<ASSIGN
H
      1381**DCL      8946<<ASSIGN   8948<<ASSIGN   8950>>ASSIGN   8964<<ASSIGN   8966<<ASSIGN   8968>>ASSIGN
HELP
      1412**DCL      8983<<ASSIGN   8986<<ASSIGN   8986>>ASSIGN   8990<<ASSIGN   8990>>ASSIGN   8991>>DOCASE
HEX
      1396**DCL      8968<<ASSIGN   8969--ASSIGN
HEX$
      1409**DCL      1396--IMP-PTR  8960<<ASSIGN   8968>>ASSIGN   8969<<ASSIGN   8969>>ASSIGN
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:85   
IX
      1411**DCL      8894<<DOINDEX  8895>>ASSIGN   8911<<DOINDEX  8912>>ASSIGN   8929<<DOINDEX  8930>>ASSIGN
      8943<<DOINDEX  8944>>ASSIGN   8961<<DOINDEX  8962>>ASSIGN   8980<<DOINDEX  8981>>ASSIGN   8983>>ASSIGN
      8985>>IF       8989>>IF       9031<<DOINDEX  9032>>ASSIGN   9034>>DOCASE   9064<<DOINDEX  9065>>ASSIGN
      9184<<ASSIGN   9185>>ASSIGN   9194<<ASSIGN   9194>>ASSIGN   9196>>ASSIGN   9200<<ASSIGN   9200>>ASSIGN
      9201>>ASSIGN   9214<<DOINDEX  9215>>ASSIGN
N$
        35**DCL        33--PROC     8863>>ASSIGN   9123>>ASSIGN   9127>>ASSIGN
NC$
      1385**DCL      8878<<ASSIGN   8882<<ASSIGN   8884<<ASSIGN   8885>>ASSIGN   8895>>ASSIGN   8895>>ASSIGN
      8912>>ASSIGN   8912>>ASSIGN   8922>>ASSIGN   8922>>ASSIGN   8930>>ASSIGN   8930>>ASSIGN   8944>>ASSIGN
      8944>>ASSIGN   8962>>ASSIGN   8962>>ASSIGN   8981<<ASSIGN   8982>>ASSIGN   8994<>CALL     9002>>ASSIGN
      9007<>CALL     9020<>CALL     9032<<ASSIGN   9033>>ASSIGN   9036<>CALL     9043<>CALL     9065<<ASSIGN
      9066>>ASSIGN   9069<<ASSIGN   9069>>ASSIGN   9070>>ASSIGN   9074>>ASSIGN   9074>>ASSIGN   9124<<ASSIGN
      9127<<ASSIGN   9128>>IF       9133<>CALL     9137<>CALL     9185<<ASSIGN   9186>>ASSIGN   9189<<ASSIGN
      9189>>ASSIGN   9190>>ASSIGN   9192>>CALLBLT  9192>>CALLBLT  9196<<ASSIGN   9197>>ASSIGN   9201<<ASSIGN
      9202>>ASSIGN   9205<<ASSIGN   9205>>ASSIGN   9206>>ASSIGN   9209>>CALLBLT  9209>>CALLBLT  9215<<ASSIGN
      9216>>ASSIGN   9221<<ASSIGN   9221>>ASSIGN   9222>>ASSIGN   9224>>CALLBLT  9224>>CALLBLT  9229<<ASSIGN
      9229>>ASSIGN   9230>>ASSIGN   9233>>CALLBLT  9233>>CALLBLT  9239>>IF       9241>>IF       9243<<ASSIGN
      9243>>ASSIGN   9245<<ASSIGN   9245>>ASSIGN   9246<>CALL
NCD
      1383**DCL      8872<<ASSIGN   8877<<ASSIGN   8881<<ASSIGN   8886>>DOCASE   8982<<ASSIGN   9012>>DOCASE
      9033<<ASSIGN   9066<<ASSIGN   9067>>IF       9078>>IF       9083>>IF       9125<<ASSIGN   9130>>IF
      9130>>IF       9139>>IF       9186<<ASSIGN   9187>>IF       9197<<ASSIGN   9198>>IF       9202<<ASSIGN
      9203>>IF       9216<<ASSIGN   9217>>IF       9219>>IF       9227>>IF       9236>>IF
NN$
      1386**DCL      8863<<ASSIGN   8864>>ASSIGN   8873>>ASSIGN   8877>>ASSIGN   8878>>ASSIGN   8881>>ASSIGN
      8882>>ASSIGN   8884>>ASSIGN   8979>>ASSIGN   8981>>ASSIGN   9030>>ASSIGN   9032>>ASSIGN   9063>>ASSIGN
      9065>>ASSIGN   9093>>ASSIGN   9102>>ASSIGN   9105>>ASSIGN   9114>>IF       9124>>ASSIGN   9125>>ASSIGN
NSUB
      1382**DCL      8873<<ASSIGN   8874>>IF       8979<<ASSIGN   8980>>DOINDEX  8984>>IF       8988>>IF
      9030<<ASSIGN   9031>>DOINDEX  9063<<ASSIGN   9064>>DOINDEX  9065>>ASSIGN   9123<<ASSIGN   9126>>IF
      9179<<ASSIGN   9182>>IF       9214>>DOINDEX
O
      1389**DCL      8912<<ASSIGN   8913>>IF       8913>>IF       8914>>ASSIGN   8930<<ASSIGN   8931>>IF
      8931>>IF       8932>>ASSIGN   9061<<ASSIGN   9076<<ASSIGN   9080>>ASSIGN   9175<<ASSIGN   9206<<ASSIGN
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:86   
      9207>>ASSIGN   9230<<ASSIGN   9231>>ASSIGN   9252<<ASSIGN   9252>>ASSIGN   9254<>CALL
OCT
      1395**DCL      8914<<ASSIGN   8915--ASSIGN
OCT$
      1408**DCL      1395--IMP-PTR  8910<<ASSIGN   8914>>ASSIGN   8915<<ASSIGN   8915>>ASSIGN
POB.CODE
      4534**DCL      8864>>ASSIGN   8877>>ASSIGN   8881>>ASSIGN   8982>>ASSIGN   9033>>ASSIGN   9066>>ASSIGN
      9114>>IF       9125>>ASSIGN   9128>>IF       9186>>ASSIGN   9197>>ASSIGN   9202>>ASSIGN   9216>>ASSIGN
      9241>>IF
POB.NSB
      4538**DCL      8873>>ASSIGN   8979>>ASSIGN   9030>>ASSIGN   9063>>ASSIGN   9123>>ASSIGN   9179>>ASSIGN
      9239>>IF
POB.SUBLK$
      4559**DCL      8863>>ASSIGN   8877>>ASSIGN   8878>>ASSIGN   8878>>ASSIGN   8881>>ASSIGN   8882>>ASSIGN
      8882>>ASSIGN   8884>>ASSIGN   8884>>ASSIGN   8981>>ASSIGN   9002>>ASSIGN   9032>>ASSIGN   9065>>ASSIGN
      9069>>ASSIGN   9102>>ASSIGN   9105>>ASSIGN   9114>>IF       9127>>ASSIGN   9185>>ASSIGN   9189>>ASSIGN
      9196>>ASSIGN   9201>>ASSIGN   9205>>ASSIGN   9215>>ASSIGN   9221>>ASSIGN   9221>>ASSIGN   9229>>ASSIGN
      9229>>ASSIGN   9241>>IF       9243>>ASSIGN   9245>>ASSIGN
REAL_CNSNT
      9173**PROC     9094--CALL     9103--CALL     9106--CALL
S_D.CURRENT_CHANNEL
      6937**DCL      6939--REDEF
S_D.DEBUGA
      6089**DCL      6091--REDEF
S_D.EIS
      7047**DCL      7076--REDEF
S_D.ERROR
      6018**DCL      9147<<ASSIGN   9148<<ASSIGN   9149<<ASSIGN   9258<<ASSIGN   9259<<ASSIGN   9260<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      6980**DCL      6981--REDEF    6995--REDEF
S_D.JDE
      6594**DCL      6595--REDEF
S_D.L$.VALUE
      6147**DCL      6153--REDEF    6161--REDEF    6164--REDEF    6167--REDEF    6170--REDEF
S_D.L$.VALUE.L
      6148**DCL      6149--REDEF    6150--REDEF
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:87   
S_D.L6_MESSAGE_BUF
      7001**DCL      7003--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      7012**DCL      9120>>IF
S_D.OUTPUT
      6967**DCL      6969--REDEF
S_D.REMOTE_MSG.FNCC
      6986**DCL      6987--REDEF
S_D.REMOTE_MSG.STXC
      6982**DCL      6983--REDEF
S_D.REMOTE_MSG.SUBFNCC
      6990**DCL      6991--REDEF
S_D.SV
      6046**DCL      6067--REDEF
S_D$
      7298**DCL      5994--IMP-PTR  9120>>IF       9147>>ASSIGN   9148>>ASSIGN   9149>>ASSIGN   9258>>ASSIGN
      9259>>ASSIGN   9260>>ASSIGN
TEXT$C.SIZE
      1404**DCL      1405--IMP-SIZ  8885>>ASSIGN   8895>>ASSIGN   8912>>ASSIGN   8922>>ASSIGN   8930>>ASSIGN
      8944>>ASSIGN   8962>>ASSIGN   9070>>ASSIGN   9074>>ASSIGN   9190>>ASSIGN   9192>>CALLBLT  9206>>ASSIGN
      9209>>CALLBLT  9222>>ASSIGN   9224>>CALLBLT  9230>>ASSIGN   9233>>CALLBLT
TEXT$C.TXT
      1405**DCL      8895>>ASSIGN   8912>>ASSIGN   8922>>ASSIGN   8930>>ASSIGN   8944>>ASSIGN   8962>>ASSIGN
      9074>>ASSIGN   9192>>CALLBLT  9209>>CALLBLT  9224>>CALLBLT  9233>>CALLBLT
TOOL IN PROCEDURE REAL_CNSNT
      9258**LABEL    9191--GOTO     9208--GOTO     9223--GOTO     9232--GOTO
TOOLARGE
      9149**LABEL    8995--GOTO     9003--GOTO     9008--GOTO     9021--GOTO     9038--GOTO     9045--GOTO
      9072--GOTO
TYPE
      1377**DCL        33--PROC     8889<<ASSIGN   8906<<ASSIGN   8919<<ASSIGN   8925<<ASSIGN   8939<<ASSIGN
      8955<<ASSIGN   8978<<ASSIGN   9029<<ASSIGN   9053<<ASSIGN   9090<<ASSIGN   9100<<ASSIGN   9112<<ASSIGN
      9131<<ASSIGN   9132<<ASSIGN   9136<<ASSIGN
V
      1379**DCL      1398--IMP-SIZ  8885<<ASSIGN   8890>>IF       8891>>ASSIGN   8894>>DOINDEX  8907>>IF
      8908>>ASSIGN   8911>>DOINDEX  8920>>IF       8921>>ASSIGN   8926>>IF       8929>>DOINDEX  8940>>IF
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:88   
      8943>>DOINDEX  8956>>IF       8958>>ASSIGN   8961>>DOINDEX  8994<>CALL     8995>>IF       8996>>ASSIGN
      9002<<ASSIGN   9003>>IF       9004>>ASSIGN   9007<>CALL     9008>>IF       9009>>ASSIGN   9013<<ASSIGN
      9014<<ASSIGN   9015<<ASSIGN   9017>>ASSIGN   9020<>CALL     9021>>IF       9022>>ASSIGN   9036<>CALL
      9037>>IF       9039>>ASSIGN   9043<>CALL     9044>>IF       9046>>ASSIGN   9070<<ASSIGN   9071>>ASSIGN
      9073>>ASSIGN   9074>>ASSIGN   9076>>ASSIGN   9133<>CALL     9137<>CALL     9140<<ASSIGN   9140>>ASSIGN
      9141>>ASSIGN   9176<<ASSIGN   9238<<ASSIGN   9242<<ASSIGN   9247<<ASSIGN   9247>>ASSIGN   9252>>ASSIGN
WORK
      1340**DCL        33--PROC     8862<<ASSIGN
WORK.BITS.TRING
      1356**DCL      8890--IF       8892<<ASSIGN   8893--ASSIGN   8907--IF       8909<<ASSIGN   8910--ASSIGN
      8956--IF       8959<<ASSIGN   8960--ASSIGN   9092--ASSIGN   9095<<ASSIGN   9115<<ASSIGN
WORK.COMP.LEX1
      1373**DCL      9101--ASSIGN   9104<<ASSIGN
WORK.COMP.LEX2
      1374**DCL      9107<<ASSIGN
WORK.CONS.TANT
      1351**DCL      1352--REDEF    8927--ASSIGN   8934<<ASSIGN   8941--ASSIGN   8952<<ASSIGN   9121--ASSIGN
      9141<<ASSIGN
WORK.EXP
      1342**DCL      9080<<ASSIGN
WORK.P.ADR
      1360**DCL      1364--REDEF
WORK.P.ADR.B
      1363**DCL      9009<<ASSIGN
WORK.P.ADR.C
      1362**DCL      9004<<ASSIGN
WORK.P.ADR.W
      1361**DCL      8996<<ASSIGN
WORK.P.ADR6.C
      1366**DCL      9046<<ASSIGN
WORK.P.ADR6.W
      1365**DCL      9039<<ASSIGN
WORK.P.D
      1369**DCL      9022<<ASSIGN
WORK.P.S
      1368**DCL      9017<<ASSIGN
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:89   
WORK.SIZE
      1341**DCL      1342--REDEF    8891<<ASSIGN   8908<<ASSIGN   8921<<ASSIGN   8927<<ASSIGN   8941<<ASSIGN
      8958<<ASSIGN   8977<<ASSIGN   9028<<ASSIGN   9092<<ASSIGN   9101<<ASSIGN   9113<<ASSIGN   9121<<ASSIGN
      9122<<ASSIGN
WORK.TEXT
      1343**DCL      1344--REDEF    1345--REDEF    1349--REDEF    1354--REDEF    1358--REDEF    1371--REDEF
      8920--IF       8922<<ASSIGN   9058<<ASSIGN   9059--ASSIGN   9059--ASSIGN   9072--IF       9084--ASSIGN
WORK.TEXTA8.BYT
      1347**DCL      1348--REDEF
XPNA IN PROCEDURE REAL_CNSNT
      9260**LABEL    9254--CALLALT
XPN_7LSPTOD
      7307**DCL-ENT  9254--CALL
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:90   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDS$CNSNT File=DDS$CNSNT.:E05TSI                              TUE 07/29/97 14:14 Page:91   
              MINI UREF LISTING

DDS$CNSNT      33**PROC
SDD$    7412**DCL
SDD_L6$    7414**DCL
TNC$    1387**DCL
ZITEM$    7413**DCL
ZITEM_L6$    7415**DCL
