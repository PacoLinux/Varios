VERSION E05

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:1    
        1        1        /*M* QQB$CHECK - Process CHECK command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$CHECK:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B_ERRORS_C;
       16     1277        %INCLUDE QQ_MACROS_C;
       17     1702        %INCLUDE QQ_DATA_R;
       18     1948        %INCLUDE XU_MACRO_C;
       19     5054        %INCLUDE XU_FORMAT_C;
       20     5216        %INCLUDE QQ_PERR_C;
       21     5377        %INCLUDE Q_ERRCODE_C;
       22     5400        %INCLUDE QQ_SUBS_C;
       23     5592        %PAGE(ARG="Externally defined routines");

              5609    1   /***************************************************************************
              5610    1    *                                                                         *
              5611    1    *                        Externally defined routines                      *
              5612    1    *                                                                         *
              5613    1    ***************************************************************************/

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:2    
       24     5617    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       25     5618    1   DCL QQC$BLDMSG ENTRY(1);
       26     5619    1   DCL QQC$EX_SPEC ENTRY(3) ALTRET;
       27     5620    1   DCL QQC$PRINT_FMT ENTRY(2) ALTRET;
       28     5621    1   DCL X$FORMAT ENTRY(1);
       29     5622    1   DCL QQC$CONVERT_NUM ENTRY(3);
       30     5623    1   DCL QQC$CONVERT_XID ENTRY(4);
       31     5624    1   DCL QQC$SCREECH ENTRY;
       32     5625        %PAGE(ARG="EQUs");

              5642    1   /***************************************************************************
              5643    1    *                                                                         *
              5644    1    *                                    EQUs                                 *
              5645    1    *                                                                         *
              5646    1    ***************************************************************************/

       33     5650        %EQU_CG;
       34     5698        %PAGE(ARG="Symrefs");

              5715    1   /***************************************************************************
              5716    1    *                                                                         *
              5717    1    *                                  Symrefs                                *
              5718    1    *                                                                         *
              5719    1    ***************************************************************************/

       35     5723    1   DCL B$TCB$ PTR SYMREF;
       36     5724        %PAGE(ARG="DCBs");

              5741    1   /***************************************************************************
              5742    1    *                                                                         *
              5743    1    *                                    DCBs                                 *
              5744    1    *                                                                         *
              5745    1    ***************************************************************************/

       37     5749    1   DCL M$INFOSTA DCB;
       38     5750        %PAGE(ARG="Based");

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:3    
              5767    1   /***************************************************************************
              5768    1    *                                                                         *
              5769    1    *                                   Based                                 *
              5770    1    *                                                                         *
              5771    1    ***************************************************************************/

       39     5775        %PARSE$OUT(STCLASS=BASED);
       40     5820        %PARSE$SYM(STCLASS=BASED);
       41     5858        %VLP_CGMA(FPTN=VLP$CGMA, STCLASS="BASED(CGMA$)");
       42     5885        %B$CGAURD(FPTN=B$CGAURD, STCLASS=BASED, LAST=";");
       43     5904        %B$TCB;
       44     5907        %B$ALT;
       45     5915        %TP$STATION;
       46     5988    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       47     5989        %PAGE(ARG="Constants");

              6006    1   /***************************************************************************
              6007    1    *                                                                         *
              6008    1    *                                 Constants                               *
              6009    1    *                                                                         *
              6010    1    ***************************************************************************/

       48     6014    1   DCL 1 FORMAT1 CONSTANT,
       49     6015    1         2 * CHAR(0) INIT(' %A %A %A    %3D %3D  %5.36.0U %5D %A');
       50     6016        %VLP_CGMA(FPTN=VLP_CGMA_C, STCLASS=CONSTANT);
       51     6043        %VLP_SCGMA(FPTN=VLP_SCGMA_C, STCLASS=CONSTANT, MSGTYP=YES);
       52     6060        %PAGE(ARG="Static");

              6077    1   /***************************************************************************
              6078    1    *                                                                         *
              6079    1    *                                   Static                                *
              6080    1    *                                                                         *
              6081    1    ***************************************************************************/

       53     6085        %F_FDS(FMT=FORMAT1, NVECS=8, OUTPUT=QQC$PRINT_FMT, DVFC=' ');
       54     6198        %PAGE(ARG="Auto");

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:4    
              6215    1   /***************************************************************************
              6216    1    *                                                                         *
              6217    1    *                                    Auto                                 *
              6218    1    *                                                                         *
              6219    1    ***************************************************************************/

       55     6223    1   DCL SUMMARY_FLAG BIT(1) ALIGNED;
       56     6224    1   DCL HELD_FLAG BIT(1) ALIGNED;
       57     6225
       58     6226    1   DCL SIZE SBIN WORD;
       59     6227    1   DCL NUM_LEFT SBIN WORD;
       60     6228    1   DCL NUM_THIS_READ SBIN WORD;
       61     6229    1   DCL CHAR_STRING_SIZE SBIN WORD;
       62     6230    1   DCL BYTES_THIS_READ SBIN WORD;
       63     6231    1   DCL I SBIN WORD;
       64     6232    1   DCL II SBIN WORD;
       65     6233    1   DCL NSUBLKS SBIN WORD;
       66     6234    1   DCL MAX_READ_SIZE SBIN WORD;
       67     6235
       68     6236    1   DCL OPT$ PTR;
       69     6237    1   DCL SUM$ PTR;
       70     6238    1   DCL SUBLK$ PTR;
       71     6239    1   DCL SPECIFIER$ PTR;
       72     6240    1   DCL CGMA$ PTR;
       73     6241
       74     6242    1   DCL TEXT_XID CHAR(20);
       75     6243    1   DCL BUF CHAR(80);
       76     6244
       77     6245    1   DCL DATA_VECTRS(0:7) BIT(72);
       78     6246
       79     6247    1   DCL   LAST_MSGTYP# CHAR(8) ;
       80     6248    1   DCL   LAST_MSG_CNT UBIN ;
       81     6249    1   DCL 1 PRIO UBIN(18) UNAL;
       82     6250    1   DCL 1 PRIO_ELEMENTS REDEF PRIO,
       83     6251    1         2 MSG UBIN(9) UNAL,
       84     6252    1         2 STATION UBIN(9) UNAL;
       85     6253        %VLP_NAME(FPTN=TEXTC_NUM, LEN=10, NAME=' ');
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:5    
       86     6280        %VLP_NAME(FPTN=TEXTC_NAME, LEN=8, NAME=' ');
       87     6307        %MSGBLK;
       88     6397        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:6    
              6414    1   /***************************************************************************
              6415    1    *                                                                         *
              6416    1    *                                Error codes                              *
              6417    1    *                                                                         *
              6418    1    ***************************************************************************/

       89     6422        %ERRCODE(NAME=CODE_NRF, CODE#=%E$NRF, FCG#=%FCG_QQ, MID#=%MID_B);
       90     6429        %ERRCODE(NAME=CODE_NTF, CODE#=%E$NTF, FCG#=%FCG_QQ, MID#=%MID_B);
       91     6436        %ERRCODE(NAME=CODE_NHTF, CODE#=%E$NHTF, FCG#=%FCG_QQ, MID#=%MID_B);
       92     6443        %ERRCODE(NAME=CODE_CHKTITLE, CODE#=%E$CHKTITLE, FCG#=%FCG_QQ, MID#=%MID_B);
       93     6450        %ERRCODE(NAME=CODE_CHKSUMTITLE, CODE#=%E$CHKSUMTITLE, FCG#=%FCG_QQ, MID#=%MID_B);
       94     6457        /*E*       ERROR: QQB-E$NRF-C
       95     6458
       96     6459                 MESSAGE: %U1 report(s) found
       97     6460             DESCRIPTION: The number of messages found by a CHECK command
       98     6461        */
       99     6462        /*E*       ERROR: QQB-E$NTF-C
      100     6463
      101     6464                 MESSAGE: %U1 transaction(s) found
      102     6465             DESCRIPTION: The number of messages found by a CHECK command
      103     6466        */
      104     6467        /*E*       ERROR: QQB-E$NHTF-C
      105     6468
      106     6469                 MESSAGE: %U1 held transaction(s) found
      107     6470             DESCRIPTION: The number of messages found by a CHECK command
      108     6471        */
      109     6472        /*E*       ERROR: QQB-E$CHKTITLE-C
      110     6473
      111     6474                 MESSAGE: Msgtyp   Origin   Destination Priority  UTS  Bytes Msg-id
      112     6475             DESCRIPTION: Title for the CHECK command output
      113     6476        */
      114     6477        /*E*       ERROR: QQB-E$CHKSUMTITLE-C
      115     6478
      116     6479                 MESSAGE:  %U1  %U2
      117     6480             DESCRIPTION: Title for the CHECK SUM command output
      118     6481        */
      119     6482        %PAGE(ARG="FPTs", PAGE=YES);
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:7    

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:8    
              6499    1   /***************************************************************************
              6500    1    *                                                                         *
              6501    1    *                                    FPTs                                 *
              6502    1    *                                                                         *
              6503    1    ***************************************************************************/

      120     6507        %FPT_FWCG(DCB=M$INFOSTA, CRITERIA=VLP_CGMA, SCA=VLP_SCGMA,
      121     6508        RESULTS=VLR_FWCG);
      122     6527
      123     6528        %FPT_READ(DCB=M$INFOSTA, STATION=VLP_STATION);
      124     6567        %PAGE(ARG="VLPs");

              6584    1   /***************************************************************************
              6585    1    *                                                                         *
              6586    1    *                                    VLPs                                 *
              6587    1    *                                                                         *
              6588    1    ***************************************************************************/

      125     6592        %FPT_UNLATCH(DCB=M$INFOSTA, INPUT=DELETE, OUTPUT=DELETE, TELLAU=NO,
      126     6593        TELLOS=NO);
      127     6610        %VLP_CGMA;
      128     6637        %VLP_SCGMA;
      129     6654        %VLP_STATION(LATCH=YES, DIRONLY=YES);
      130     6681        %PAGE(ARG="VLRs");

              6698    1   /***************************************************************************
              6699    1    *                                                                         *
              6700    1    *                                    VLRs                                 *
              6701    1    *                                                                         *
              6702    1    ***************************************************************************/

      131     6706        %VLR_FWCG;
      132     6720        %PAGE(ARG="QQB$CHECK", PAGE=YES);

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:9    
              6737    1   /***************************************************************************
              6738    1    *                                                                         *
              6739    1    *                                 QQB$CHECK                               *
              6740    1    *                                                                         *
              6741    1    ***************************************************************************/

      133     6745    1           LAST_MSGTYP# = ' ';
      134     6746    1           LAST_MSG_CNT = 0;
      135     6747    1           F_FDS.BUF_ = VECTOR(BUF);
      136     6748    1           F_FDS.VECTR$ = ADDR(DATA_VECTRS);
      137     6749
      138     6750    1           VLP_CGMA = VLP_CGMA_C;
      139     6751    1           VLP_SCGMA = VLP_SCGMA_C;
      140     6752
      141     6753    1           SUMMARY_FLAG = '0'B;
      142     6754    1           HELD_FLAG = '0'B;
      143     6755    1           FPT_FWCG.V.INFORM# = '1'B;
      144     6756
      145     6757    1           OPT$ = ADDR(NIL);
      146     6758    1           SPECIFIER$ = ADDR(NIL);
      147     6759
      148     6760    1           IF QQ_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS = 0 THEN
      149     6761    2             DO;
      150     6762                            /*  make ORIGIN station S$->TP$STATION.ID instead of ?    */
      151     6763    2               VLP_CGMA.ORIGIN# = QQ_CMDBLK.S$ -> TP$STATION.ID;
      152     6764    2               GOTO TRANS_CHK;
      153     6765    2             END;
      154     6766
      155     6767    1           NSUBLKS = QQ_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;
      156     6768
      157     6769    2           DO I = 0 TO NSUBLKS;
      158     6770    2             SUBLK$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      159     6771    3             DO CASE (SUBLK$ -> OUT$BLK.CODE);
      160     6772
      161     6773    3               CASE (3 /* OPT_HELD */);
      162     6774    3                 OPT$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      163     6775    3                 HELD_FLAG = '1'B;
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:10   
      164     6776    3                 IF NSUBLKS >= 1 AND
      165     6777    3                     QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I+1)
      166     6778    3                     -> OUT$BLK.CODE = 2 /* OPT_TRANSACTIONS */ THEN
      167     6779    4                   DO;
      168     6780    4                     I = I + 1;
      169     6781    4                   END;
      170     6782
      171     6783    3               CASE (4 /* OPT_REPORTS */, 2 /* OPT_TRANSACTIONS */);
      172     6784    3                 OPT$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      173     6785
      174     6786    3               CASE (6 /* OPT_SUMMARY */);
      175     6787    3                 SUMMARY_FLAG = '1'B;
      176     6788
      177     6789    3               CASE ( 1 /* Specifier */ );
      178     6790    3                 SPECIFIER$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      179     6791    3                 SUM$ = SPECIFIER$ -> OUT$BLK.SUBLK$(0);
      180     6792    3                 CALL INDEX(II,'SUM',SUM$->OUT$SYM.TEXT);
      181     6793    3                 IF II = 0 THEN
      182     6794    4                   DO;
      183     6795    4                     SUMMARY_FLAG = '1'B;
      184     6796    4                     SPECIFIER$ = ADDR(NIL);
      185     6797    4                   END;
      186     6798
      187     6799    3             END;                          /* CASE                               */
      188     6800    2           END;                            /* of DO loop                         */
      189     6801
      190     6802    1           IF SPECIFIER$ ~= ADDR(NIL) THEN
      191     6803    1             CALL QQC$EX_SPEC(SPECIFIER$, VLP_SCGMA, VLP_CGMA) ALTRET(RET);
      192     6804
      193     6805    1           IF OPT$ = ADDR(NIL) OR
      194     6806    1               OPT$ -> OUT$BLK.CODE = 2 /* OPT_TRANSACTIONS */ THEN
      195     6807    1   TRANS_CHK:
      196     6808    2             DO;
      197     6809    2               VLP_SCGMA.ORIGIN# = '1'B;
      198     6810    2               FPT_FWCG.V.QSELECT# = 3 /* CG_QSELECT_ANONYMOUS# */;
      199     6811    2               QQ_CMDBLK.MINOR_ERR = CODE_NTF;
      200     6812    2             END;
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:11   
      201     6813    1           ELSE
      202     6814    1   REPORT_CHK:
      203     6815    2             DO;
      204     6816    2               VLP_SCGMA.DEST# = '1'B;
      205     6817    2               VLP_SCGMA.ORIGIN# = '0'B;
      206     6818    2               VLP_CGMA.DEST# = VLP_CGMA.ORIGIN#;
      207     6819    2               FPT_FWCG.V.QSELECT# = 2 /* CG_QSELECT_DIRECT# */;
      208     6820    2               IF HELD_FLAG THEN
      209     6821    3                 DO;
      210     6822    3                   VLP_CGMA.ORIGIN# = 'HOLDSTA';
      211     6823    3                   VLP_CGMA.DEST# = VLP_CGMA.ORIGIN#;
      212     6824    3                   QQ_CMDBLK.MINOR_ERR = CODE_NHTF;
      213     6825    3                 END;
      214     6826    2               ELSE
      215     6827    2                 QQ_CMDBLK.MINOR_ERR = CODE_NRF;
      216     6828    2             END;
      217     6829
      218     6830    1           CALL M$FWCG(FPT_FWCG) ALTRET(FWCG_ERR);
      219     6831
      220     6832    2           DO WHILE('0'B);
      221     6833
      222     6834    2   FWCG_ERR:
      223     6835    2             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1170 /* E$FWCG_NONE */ THEN
      224     6836    3               DO;
      225     6837    3                 GOTO MON_ERR;
      226     6838    3               END;
      227     6839    2           END /* NEVER */;
      228     6840
      229     6841    1           CALL QQC$CONVERT_NUM(VLR_FWCG.FOUND#, SIZE, ADDR(TEXTC_NUM.NAME#));
      230     6842    1           CALL QQC$BLDMSG_BLK(MSGBLK);
      231     6843    1           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);
      232     6844    1           TEXTC_NUM.L# = SIZE;
      233     6845    1           CALL QQC$BLDMSG(MSGBLK);
      234     6846
      235     6847    1           IF VLR_FWCG.FOUND# = 0 THEN
      236     6848    2             DO;
      237     6849    2               GOTO MORE_CHK;
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:12   
      238     6850    2             END;
      239     6851
      240     6852    2           IF ~SUMMARY_FLAG THEN DO;
      241     6853    2               QQ_CMDBLK.MINOR_ERR = CODE_CHKTITLE;
      242     6854    2               CALL QQC$BLDMSG_BLK(MSGBLK);
      243     6855    2               CALL QQC$BLDMSG(MSGBLK);
      244     6856    2             END;
      245     6857
      246     6858    1           IF QQ_GLOBAL.CGSIZEMAX < QQ_GLOBAL.TRASHBUF_SIZE THEN
      247     6859    2             DO;
      248     6860    2               MAX_READ_SIZE = QQ_GLOBAL.CGSIZEMAX;
      249     6861    2             END;
      250     6862    1           ELSE
      251     6863    2             DO;
      252     6864    2               MAX_READ_SIZE = QQ_GLOBAL.TRASHBUF_SIZE;
      253     6865    2             END;
      254     6866
      255     6867    1           NUM_LEFT = VLR_FWCG.FOUND#;
      256     6868    1           CGMA$ = PINCRC(QQ_GLOBAL.TRASHBUF$, SIZEC(B$CGAURD));
      257     6869    1           NUM_THIS_READ = (MAX_READ_SIZE - SIZEC(B$CGAURD)) /
      258     6870    1               SIZEC(VLP$CGMA);
      259     6871    1           BYTES_THIS_READ = SIZEC(B$CGAURD) + NUM_THIS_READ * SIZEC(VLP$CGMA);
      260     6872    1           FPT_READ.BUF_.BUF$ = QQ_GLOBAL.TRASHBUF$;
      261     6873    1           FPT_READ.BUF_.BOUND = BYTES_THIS_READ - 1;
      262     6874    1           FPT_READ.V.DVBYTE.CONT# = '0'B;
      263     6875
      264     6876    2           DO WHILE(NUM_LEFT > 0);
      265     6877    2             CALL M$READ(FPT_READ) ALTRET(READ_ERR);
      266     6878
      267     6879    3             DO WHILE('0'B);
      268     6880
      269     6881    3   READ_ERR:
      270     6882    3               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 7 /* E$LD */ THEN
      271     6883    4                 DO;
      272     6884    4                   GOTO MON_ERR;
      273     6885    4                 END;
      274     6886    3             END /* NEVER */;
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:13   
      275     6887
      276     6888    2             IF NUM_LEFT < NUM_THIS_READ THEN
      277     6889    3               DO;
      278     6890    3                 NUM_THIS_READ = NUM_LEFT;
      279     6891    3               END;
      280     6892
      281     6893    3             DO I = 1 TO NUM_THIS_READ;
      282     6894    4               IF SUMMARY_FLAG THEN DO;
      283     6895    4                   IF VLP$CGMA.MSGTYP# = LAST_MSGTYP# THEN
      284     6896    4                     LAST_MSG_CNT = LAST_MSG_CNT + 1;
      285     6897    5                   ELSE DO;
      286     6898    6                       IF LAST_MSGTYP# ~= ' ' THEN DO;
      287     6899    6                           QQ_CMDBLK.MINOR_ERR = CODE_CHKSUMTITLE;
      288     6900    6                           CALL QQC$BLDMSG_BLK(MSGBLK);
      289     6901    6                           TEXTC_NAME.L# = 8;
      290     6902    6                           TEXTC_NAME.NAME# = LAST_MSGTYP#;
      291     6903    6                           MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_NAME);
      292     6904    6                           CALL QQC$CONVERT_NUM(LAST_MSG_CNT,SIZE,ADDR(TEXTC_NUM.NAME#)
              6904                                    );
      293     6905    6                           TEXTC_NUM.L# = SIZE;
      294     6906    6                           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);
      295     6907    6                           CALL QQC$BLDMSG(MSGBLK);
      296     6908    6                         END;
      297     6909    5                       LAST_MSGTYP# = VLP$CGMA.MSGTYP#;
      298     6910    5                       LAST_MSG_CNT = 1;
      299     6911    5                     END;
      300     6912    4                 END;
      301     6913    4               ELSE DO;
      302     6914    4                   DATA_VECTRS(0) = VECTOR(VLP$CGMA.MSGTYP#);
      303     6915
      304     6916    4                   DATA_VECTRS(1) = VECTOR(VLP$CGMA.ORIGIN#);
      305     6917
      306     6918    4                   DATA_VECTRS(2) = VECTOR(VLP$CGMA.DEST#);
      307     6919
      308     6920    4                   PRIO = VLP$CGMA.PRIO#;
      309     6921    4                   DATA_VECTRS(3) = VECTOR(PRIO_ELEMENTS.MSG);
      310     6922    4                   DATA_VECTRS(4) = VECTOR(PRIO_ELEMENTS.STATION);
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:14   
      311     6923
      312     6924    4                   DATA_VECTRS(5) = VECTOR(VLP$CGMA.UTS#);
      313     6925
      314     6926    4                   DATA_VECTRS(6) = VECTOR(VLP$CGMA.MSGSIZE#);
      315     6927
      316     6928    4                   CALL QQC$CONVERT_XID(CHAR_STRING_SIZE, ADDR(TEXT_XID),
      317     6929    4                       VLP$CGMA.MSGID#, VLP$CGMA.MSGIDBXT);
      318     6930    4                   DATA_VECTRS(7) = VECTOR(ADDR(TEXT_XID) -> CHAR$STRING);
      319     6931
      320     6932    4                   CALL X$FORMAT(F_FDS);
      321     6933
      322     6934    4                 END;
      323     6935    3               CGMA$ = PINCRC(CGMA$, SIZEC(VLP$CGMA));
      324     6936    3               NUM_LEFT = NUM_LEFT - 1;
      325     6937    3             END;
      326     6938
      327     6939    2             CGMA$ = QQ_GLOBAL.TRASHBUF$;
      328     6940    2             FPT_READ.V.DVBYTE.CONT# = '1'B;
      329     6941    2             NUM_THIS_READ = MAX_READ_SIZE / SIZEC(VLP$CGMA);
      330     6942    2             BYTES_THIS_READ = NUM_THIS_READ * SIZEC(VLP$CGMA);
      331     6943    2             FPT_READ.BUF_.BOUND = BYTES_THIS_READ - 1;
      332     6944    2           END;
      333     6945    2           IF SUMMARY_FLAG AND LAST_MSG_CNT ~= 0 THEN DO;
      334     6946    2               QQ_CMDBLK.MINOR_ERR = CODE_CHKSUMTITLE;
      335     6947    2               CALL QQC$BLDMSG_BLK(MSGBLK);
      336     6948    2               TEXTC_NAME.L# = 8;
      337     6949    2               TEXTC_NAME.NAME# = LAST_MSGTYP#;
      338     6950    2               MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_NAME);
      339     6951    2               CALL QQC$CONVERT_NUM(LAST_MSG_CNT,SIZE,ADDR(TEXTC_NUM.NAME#));
      340     6952    2               TEXTC_NUM.L# = SIZE;
      341     6953    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);
      342     6954    2               CALL QQC$BLDMSG(MSGBLK);
      343     6955    2               LAST_MSGTYP# = ' ';
      344     6956    2               LAST_MSG_CNT = 0;
      345     6957    2             END;
      346     6958    1           CALL M$UNLATCH(FPT_UNLATCH) ALTRET(MON_ERR);
      347     6959
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:15   
      348     6960    1   MORE_CHK:
      349     6961    1           IF OPT$ = ADDR(NIL) AND (NOT VLP_SCGMA.DEST#) THEN
      350     6962    1             GOTO REPORT_CHK;
      351     6963
      352     6964    1           IF OPT$ = ADDR(NIL) AND
      353     6965    1               VLP_CGMA.ORIGIN# ~= 'HOLDSTA' THEN
      354     6966    2             DO;
      355     6967    2               HELD_FLAG = '1'B;
      356     6968    2               GOTO REPORT_CHK;
      357     6969    2             END;
      358     6970
      359     6971    1   RET:
      360     6972    1           RETURN;
      361     6973
      362     6974    1   MON_ERR:
      363     6975    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      364     6976    1           CALL QQC$SCREECH;
      365     6977
      366     6978    1   END QQB$CHECK;

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:16   
--  Include file information  --

   QQ_SUBS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$CHECK.

   Procedure QQB$CHECK requires 502 words for executable code.
   Procedure QQB$CHECK requires 92 words of local(AUTO) storage.

    No errors detected in file QQB$CHECK.:E05TSI    .

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:17   

 Object Unit name= QQB$CHECK                                  File name= QQB$CHECK.:E05TOU
 UTS= JUL 30 '97 05:28:55.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$INFOSTA
    2  RoData even  UTS     36     44  QQB$CHECK
    3   Data  even  none   138    212  QQB$CHECK
    4   Proc  even  none   502    766  QQB$CHECK
    5  RoData even  none    16     20  QQB$CHECK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  QQB$CHECK
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:18   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 QQC$PRINT_FMT
         yes           Std       1 QQC$BLDMSG_BLK
         yes           Std       1 QQC$BLDMSG
         yes           Std       1 X$FORMAT
         yes           Std       0 QQC$SCREECH
 yes     yes           Std       3 QQC$EX_SPEC
         yes           Std       3 QQC$CONVERT_NUM
         yes           Std       4 QQC$CONVERT_XID
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_INDEX
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             QQ_GLOBAL
     B$TCB$                                M$INFOSTA                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:19   


        1        1        /*M* QQB$CHECK - Process CHECK command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$CHECK:
        9        9                PROC;

      9  4 000000   000000 700200 xent  QQB$CHECK    TSX0  ! X66_AUTO_0
         4 000001   000134 000000                    ZERO    92,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B_ERRORS_C;
       16     1277        %INCLUDE QQ_MACROS_C;
       17     1702        %INCLUDE QQ_DATA_R;
       18     1948        %INCLUDE XU_MACRO_C;
       19     5054        %INCLUDE XU_FORMAT_C;
       20     5216        %INCLUDE QQ_PERR_C;
       21     5377        %INCLUDE Q_ERRCODE_C;
       22     5400        %INCLUDE QQ_SUBS_C;
       23     5592        %PAGE(ARG="Externally defined routines");

              5609    1   /***************************************************************************
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:20   
              5610    1    *                                                                         *
              5611    1    *                        Externally defined routines                      *
              5612    1    *                                                                         *
              5613    1    ***************************************************************************/

       24     5617    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       25     5618    1   DCL QQC$BLDMSG ENTRY(1);
       26     5619    1   DCL QQC$EX_SPEC ENTRY(3) ALTRET;
       27     5620    1   DCL QQC$PRINT_FMT ENTRY(2) ALTRET;
       28     5621    1   DCL X$FORMAT ENTRY(1);
       29     5622    1   DCL QQC$CONVERT_NUM ENTRY(3);
       30     5623    1   DCL QQC$CONVERT_XID ENTRY(4);
       31     5624    1   DCL QQC$SCREECH ENTRY;
       32     5625        %PAGE(ARG="EQUs");

              5642    1   /***************************************************************************
              5643    1    *                                                                         *
              5644    1    *                                    EQUs                                 *
              5645    1    *                                                                         *
              5646    1    ***************************************************************************/

       33     5650        %EQU_CG;
       34     5698        %PAGE(ARG="Symrefs");

              5715    1   /***************************************************************************
              5716    1    *                                                                         *
              5717    1    *                                  Symrefs                                *
              5718    1    *                                                                         *
              5719    1    ***************************************************************************/

       35     5723    1   DCL B$TCB$ PTR SYMREF;
       36     5724        %PAGE(ARG="DCBs");

              5741    1   /***************************************************************************
              5742    1    *                                                                         *
              5743    1    *                                    DCBs                                 *
              5744    1    *                                                                         *
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:21   
              5745    1    ***************************************************************************/

       37     5749    1   DCL M$INFOSTA DCB;
       38     5750        %PAGE(ARG="Based");

              5767    1   /***************************************************************************
              5768    1    *                                                                         *
              5769    1    *                                   Based                                 *
              5770    1    *                                                                         *
              5771    1    ***************************************************************************/

       39     5775        %PARSE$OUT(STCLASS=BASED);
       40     5820        %PARSE$SYM(STCLASS=BASED);
       41     5858        %VLP_CGMA(FPTN=VLP$CGMA, STCLASS="BASED(CGMA$)");
       42     5885        %B$CGAURD(FPTN=B$CGAURD, STCLASS=BASED, LAST=";");
       43     5904        %B$TCB;
       44     5907        %B$ALT;
       45     5915        %TP$STATION;
       46     5988    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       47     5989        %PAGE(ARG="Constants");

              6006    1   /***************************************************************************
              6007    1    *                                                                         *
              6008    1    *                                 Constants                               *
              6009    1    *                                                                         *
              6010    1    ***************************************************************************/

       48     6014    1   DCL 1 FORMAT1 CONSTANT,
       49     6015    1         2 * CHAR(0) INIT(' %A %A %A    %3D %3D  %5.36.0U %5D %A');
       50     6016        %VLP_CGMA(FPTN=VLP_CGMA_C, STCLASS=CONSTANT);
       51     6043        %VLP_SCGMA(FPTN=VLP_SCGMA_C, STCLASS=CONSTANT, MSGTYP=YES);
       52     6060        %PAGE(ARG="Static");

              6077    1   /***************************************************************************
              6078    1    *                                                                         *
              6079    1    *                                   Static                                *
              6080    1    *                                                                         *
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:22   
              6081    1    ***************************************************************************/

       53     6085        %F_FDS(FMT=FORMAT1, NVECS=8, OUTPUT=QQC$PRINT_FMT, DVFC=' ');
       54     6198        %PAGE(ARG="Auto");

              6215    1   /***************************************************************************
              6216    1    *                                                                         *
              6217    1    *                                    Auto                                 *
              6218    1    *                                                                         *
              6219    1    ***************************************************************************/

       55     6223    1   DCL SUMMARY_FLAG BIT(1) ALIGNED;
       56     6224    1   DCL HELD_FLAG BIT(1) ALIGNED;
       57     6225
       58     6226    1   DCL SIZE SBIN WORD;
       59     6227    1   DCL NUM_LEFT SBIN WORD;
       60     6228    1   DCL NUM_THIS_READ SBIN WORD;
       61     6229    1   DCL CHAR_STRING_SIZE SBIN WORD;
       62     6230    1   DCL BYTES_THIS_READ SBIN WORD;
       63     6231    1   DCL I SBIN WORD;
       64     6232    1   DCL II SBIN WORD;
       65     6233    1   DCL NSUBLKS SBIN WORD;
       66     6234    1   DCL MAX_READ_SIZE SBIN WORD;
       67     6235
       68     6236    1   DCL OPT$ PTR;
       69     6237    1   DCL SUM$ PTR;
       70     6238    1   DCL SUBLK$ PTR;
       71     6239    1   DCL SPECIFIER$ PTR;
       72     6240    1   DCL CGMA$ PTR;
       73     6241
       74     6242    1   DCL TEXT_XID CHAR(20);
       75     6243    1   DCL BUF CHAR(80);
       76     6244
       77     6245    1   DCL DATA_VECTRS(0:7) BIT(72);
       78     6246
       79     6247    1   DCL   LAST_MSGTYP# CHAR(8) ;
       80     6248    1   DCL   LAST_MSG_CNT UBIN ;
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:23   
       81     6249    1   DCL 1 PRIO UBIN(18) UNAL;
       82     6250    1   DCL 1 PRIO_ELEMENTS REDEF PRIO,
       83     6251    1         2 MSG UBIN(9) UNAL,
       84     6252    1         2 STATION UBIN(9) UNAL;
       85     6253        %VLP_NAME(FPTN=TEXTC_NUM, LEN=10, NAME=' ');
       86     6280        %VLP_NAME(FPTN=TEXTC_NAME, LEN=8, NAME=' ');
       87     6307        %MSGBLK;
       88     6397        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:24   
              6414    1   /***************************************************************************
              6415    1    *                                                                         *
              6416    1    *                                Error codes                              *
              6417    1    *                                                                         *
              6418    1    ***************************************************************************/

       89     6422        %ERRCODE(NAME=CODE_NRF, CODE#=%E$NRF, FCG#=%FCG_QQ, MID#=%MID_B);
       90     6429        %ERRCODE(NAME=CODE_NTF, CODE#=%E$NTF, FCG#=%FCG_QQ, MID#=%MID_B);
       91     6436        %ERRCODE(NAME=CODE_NHTF, CODE#=%E$NHTF, FCG#=%FCG_QQ, MID#=%MID_B);
       92     6443        %ERRCODE(NAME=CODE_CHKTITLE, CODE#=%E$CHKTITLE, FCG#=%FCG_QQ, MID#=%MID_B);
       93     6450        %ERRCODE(NAME=CODE_CHKSUMTITLE, CODE#=%E$CHKSUMTITLE, FCG#=%FCG_QQ, MID#=%MID_B);
       94     6457        /*E*       ERROR: QQB-E$NRF-C
       95     6458
       96     6459                 MESSAGE: %U1 report(s) found
       97     6460             DESCRIPTION: The number of messages found by a CHECK command
       98     6461        */
       99     6462        /*E*       ERROR: QQB-E$NTF-C
      100     6463
      101     6464                 MESSAGE: %U1 transaction(s) found
      102     6465             DESCRIPTION: The number of messages found by a CHECK command
      103     6466        */
      104     6467        /*E*       ERROR: QQB-E$NHTF-C
      105     6468
      106     6469                 MESSAGE: %U1 held transaction(s) found
      107     6470             DESCRIPTION: The number of messages found by a CHECK command
      108     6471        */
      109     6472        /*E*       ERROR: QQB-E$CHKTITLE-C
      110     6473
      111     6474                 MESSAGE: Msgtyp   Origin   Destination Priority  UTS  Bytes Msg-id
      112     6475             DESCRIPTION: Title for the CHECK command output
      113     6476        */
      114     6477        /*E*       ERROR: QQB-E$CHKSUMTITLE-C
      115     6478
      116     6479                 MESSAGE:  %U1  %U2
      117     6480             DESCRIPTION: Title for the CHECK SUM command output
      118     6481        */
      119     6482        %PAGE(ARG="FPTs", PAGE=YES);
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:25   

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:26   
              6499    1   /***************************************************************************
              6500    1    *                                                                         *
              6501    1    *                                    FPTs                                 *
              6502    1    *                                                                         *
              6503    1    ***************************************************************************/

      120     6507        %FPT_FWCG(DCB=M$INFOSTA, CRITERIA=VLP_CGMA, SCA=VLP_SCGMA,
      121     6508        RESULTS=VLR_FWCG);
      122     6527
      123     6528        %FPT_READ(DCB=M$INFOSTA, STATION=VLP_STATION);
      124     6567        %PAGE(ARG="VLPs");

              6584    1   /***************************************************************************
              6585    1    *                                                                         *
              6586    1    *                                    VLPs                                 *
              6587    1    *                                                                         *
              6588    1    ***************************************************************************/

      125     6592        %FPT_UNLATCH(DCB=M$INFOSTA, INPUT=DELETE, OUTPUT=DELETE, TELLAU=NO,
      126     6593        TELLOS=NO);
      127     6610        %VLP_CGMA;
      128     6637        %VLP_SCGMA;
      129     6654        %VLP_STATION(LATCH=YES, DIRONLY=YES);
      130     6681        %PAGE(ARG="VLRs");

              6698    1   /***************************************************************************
              6699    1    *                                                                         *
              6700    1    *                                    VLRs                                 *
              6701    1    *                                                                         *
              6702    1    ***************************************************************************/

      131     6706        %VLR_FWCG;
      132     6720        %PAGE(ARG="QQB$CHECK", PAGE=YES);

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:27   
              6737    1   /***************************************************************************
              6738    1    *                                                                         *
              6739    1    *                                 QQB$CHECK                               *
              6740    1    *                                                                         *
              6741    1    ***************************************************************************/

      133     6745    1           LAST_MSGTYP# = ' ';

   6745  4 000002   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000003   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000004   200075 755100                    STA     LAST_MSGTYP#,,AUTO
         4 000005   200076 756100                    STQ     LAST_MSGTYP#+1,,AUTO

      134     6746    1           LAST_MSG_CNT = 0;

   6746  4 000006   200077 450100                    STZ     LAST_MSG_CNT,,AUTO

      135     6747    1           F_FDS.BUF_ = VECTOR(BUF);

   6747  4 000007   000000 235000 5                  LDA     0
         4 000010   200126 452500                    STP2    MSGBLK+21,,AUTO
         4 000011   200126 236100                    LDQ     MSGBLK+21,,AUTO
         4 000012   000031 036003                    ADLQ    25,DU
         4 000013   000005 755000 3                  STA     F_FDS+5
         4 000014   000006 756000 3                  STQ     F_FDS+6

      136     6748    1           F_FDS.VECTR$ = ADDR(DATA_VECTRS);

   6748  4 000015   200055 630500                    EPPR0   DATA_VECTRS,,AUTO
         4 000016   000012 450400 3                  STP0    F_FDS+10

      137     6749
      138     6750    1           VLP_CGMA = VLP_CGMA_C;

   6750  4 000017   000000 100400                    MLR     fill='000'O
         4 000020   000012 000100 2                  ADSC9   VLP_CGMA_C               cn=0,n=64
         4 000021   000146 000100 3                  ADSC9   VLP_CGMA                 cn=0,n=64
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:28   

      139     6751    1           VLP_SCGMA = VLP_SCGMA_C;

   6751  4 000022   000032 237000 2                  LDAQ    VLP_SCGMA_C
         4 000023   000166 757000 3                  STAQ    VLP_SCGMA

      140     6752
      141     6753    1           SUMMARY_FLAG = '0'B;

   6753  4 000024   200004 450100                    STZ     SUMMARY_FLAG,,AUTO

      142     6754    1           HELD_FLAG = '0'B;

   6754  4 000025   200005 450100                    STZ     HELD_FLAG,,AUTO

      143     6755    1           FPT_FWCG.V.INFORM# = '1'B;

   6755  4 000026   200000 236003                    LDQ     65536,DU
         4 000027   000101 256000 3                  ORSQ    FPT_FWCG+29

      144     6756
      145     6757    1           OPT$ = ADDR(NIL);

   6757  4 000030   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000031   200017 756100                    STQ     OPT$,,AUTO

      146     6758    1           SPECIFIER$ = ADDR(NIL);

   6758  4 000032   200022 756100                    STQ     SPECIFIER$,,AUTO

      147     6759
      148     6760    1           IF QQ_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS = 0 THEN

   6760  4 000033   000005 471400 xsym               LDP1    QQ_CMDBLK+5
         4 000034   100001 220100                    LDX0    1,,PR1
         4 000035   000043 601000 4                  TNZ     s:6767

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:29   
      149     6761    2             DO;

      150     6762                            /*  make ORIGIN station S$->TP$STATION.ID instead of ?    */
      151     6763    2               VLP_CGMA.ORIGIN# = QQ_CMDBLK.S$ -> TP$STATION.ID;

   6763  4 000036   000004 473400 xsym               LDP3    QQ_CMDBLK+4
         4 000037   040000 100500                    MLR     fill='040'O
         4 000040   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         4 000041   000152 000010 3                  ADSC9   VLP_CGMA+4               cn=0,n=8

      152     6764    2               GOTO TRANS_CHK;

   6764  4 000042   000170 710000 4                  TRA     TRANS_CHK

      153     6765    2             END;
      154     6766
      155     6767    1           NSUBLKS = QQ_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;

   6767  4 000043   100001 236100                    LDQ     1,,PR1
         4 000044   000022 772000                    QRL     18
         4 000045   000001 136007                    SBLQ    1,DL
         4 000046   200015 756100                    STQ     NSUBLKS,,AUTO

      156     6768
      157     6769    2           DO I = 0 TO NSUBLKS;

   6769  4 000047   200013 450100                    STZ     I,,AUTO
         4 000050   000141 710000 4                  TRA     s:6800+1

      158     6770    2             SUBLK$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   6770  4 000051   000005 470400 xsym               LDP0    QQ_CMDBLK+5
         4 000052   200013 720100                    LXL0    I,,AUTO
         4 000053   000003 236110                    LDQ     3,X0,PR0
         4 000054   200021 756100                    STQ     SUBLK$,,AUTO

      159     6771    3             DO CASE (SUBLK$ -> OUT$BLK.CODE);
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:30   

   6771  4 000055   200021 471500                    LDP1    SUBLK$,,AUTO
         4 000056   100000 721100                    LXL1    0,,PR1
         4 000057   000007 101003                    CMPX1   7,DU
         4 000060   000062 602011 4                  TNC     s:6771+5,X1
         4 000061   000140 710000 4                  TRA     s:6800
         4 000062   000140 710000 4                  TRA     s:6800
         4 000063   000111 710000 4                  TRA     s:6790
         4 000064   000104 710000 4                  TRA     s:6784
         4 000065   000071 710000 4                  TRA     s:6774
         4 000066   000104 710000 4                  TRA     s:6784
         4 000067   000140 710000 4                  TRA     s:6800
         4 000070   000106 710000 4                  TRA     s:6787

      160     6772
      161     6773    3               CASE (3 /* OPT_HELD */);

      162     6774    3                 OPT$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   6774  4 000071   200017 756100                    STQ     OPT$,,AUTO

      163     6775    3                 HELD_FLAG = '1'B;

   6775  4 000072   400000 236003                    LDQ     -131072,DU
         4 000073   200005 756100                    STQ     HELD_FLAG,,AUTO

      164     6776    3                 IF NSUBLKS >= 1 AND

   6776  4 000074   200015 235100                    LDA     NSUBLKS,,AUTO
         4 000075   000140 604400 4                  TMOZ    s:6800
         4 000076   000004 473510                    LDP3    4,X0,PR0
         4 000077   300000 722100                    LXL2    0,,PR3
         4 000100   000002 102003                    CMPX2   2,DU
         4 000101   000140 601000 4                  TNZ     s:6800

      165     6777    3                     QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I+1)
      166     6778    3                     -> OUT$BLK.CODE = 2 /* OPT_TRANSACTIONS */ THEN
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:31   
      167     6779    4                   DO;

      168     6780    4                     I = I + 1;

   6780  4 000102   200013 054100                    AOS     I,,AUTO

      169     6781    4                   END;

   6781  4 000103   000140 710000 4                  TRA     s:6800

      170     6782
      171     6783    3               CASE (4 /* OPT_REPORTS */, 2 /* OPT_TRANSACTIONS */);

      172     6784    3                 OPT$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   6784  4 000104   200017 756100                    STQ     OPT$,,AUTO
         4 000105   000140 710000 4                  TRA     s:6800

      173     6785
      174     6786    3               CASE (6 /* OPT_SUMMARY */);

      175     6787    3                 SUMMARY_FLAG = '1'B;

   6787  4 000106   400000 236003                    LDQ     -131072,DU
         4 000107   200004 756100                    STQ     SUMMARY_FLAG,,AUTO
         4 000110   000140 710000 4                  TRA     s:6800

      176     6788
      177     6789    3               CASE ( 1 /* Specifier */ );

      178     6790    3                 SPECIFIER$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   6790  4 000111   200022 756100                    STQ     SPECIFIER$,,AUTO

      179     6791    3                 SUM$ = SPECIFIER$ -> OUT$BLK.SUBLK$(0);

   6791  4 000112   200022 473500                    LDP3    SPECIFIER$,,AUTO
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:32   
         4 000113   300003 236100                    LDQ     3,,PR3
         4 000114   200020 756100                    STQ     SUM$,,AUTO

      180     6792    3                 CALL INDEX(II,'SUM',SUM$->OUT$SYM.TEXT);

   6792  4 000115   200020 474500                    LDP4    SUM$,,AUTO
         4 000116   400004 236100                    LDQ     4,,PR4
         4 000117   000033 772000                    QRL     27
         4 000120   200014 631500                    EPPR1   II,,AUTO
         4 000121   000041 633400 2                  EPPR3   CODE_CHKSUMTITLE+1
         4 000122   000003 223003                    LDX3    3,DU
         4 000123   400000 630500                    EPPR0   0,,PR4
         4 000124   000021 221003                    LDX1    17,DU
         4 000125   000000 500511                    A9BD    0,X1,PR0
         4 000126   000000 620006                    EAX0    0,QL
         4 000127   000000 236003                    LDQ     0,DU
         4 000130   000000 701000 xent               TSX1    X66_INDEX
         4 000131   000000 011000                    NOP     0

      181     6793    3                 IF II = 0 THEN

   6793  4 000132   200014 235100                    LDA     II,,AUTO
         4 000133   000140 601000 4                  TNZ     s:6800

      182     6794    4                   DO;

      183     6795    4                     SUMMARY_FLAG = '1'B;

   6795  4 000134   400000 236003                    LDQ     -131072,DU
         4 000135   200004 756100                    STQ     SUMMARY_FLAG,,AUTO

      184     6796    4                     SPECIFIER$ = ADDR(NIL);

   6796  4 000136   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000137   200022 756100                    STQ     SPECIFIER$,,AUTO

      185     6797    4                   END;
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:33   

      186     6798
      187     6799    3             END;                          /* CASE                               */

      188     6800    2           END;                            /* of DO loop                         */

   6800  4 000140   200013 054100                    AOS     I,,AUTO
         4 000141   200013 236100                    LDQ     I,,AUTO
         4 000142   200015 116100                    CMPQ    NSUBLKS,,AUTO
         4 000143   000051 604400 4                  TMOZ    s:6770

      189     6801
      190     6802    1           IF SPECIFIER$ ~= ADDR(NIL) THEN

   6802  4 000144   200022 236100                    LDQ     SPECIFIER$,,AUTO
         4 000145   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000146   000161 600000 4                  TZE     s:6805

      191     6803    1             CALL QQC$EX_SPEC(SPECIFIER$, VLP_SCGMA, VLP_CGMA) ALTRET(RET);

   6803  4 000147   000001 236000 5                  LDQ     1
         4 000150   200130 756100                    STQ     MSGBLK+23,,AUTO
         4 000151   000002 236000 5                  LDQ     2
         4 000152   200127 756100                    STQ     MSGBLK+22,,AUTO
         4 000153   200022 630500                    EPPR0   SPECIFIER$,,AUTO
         4 000154   200126 450500                    STP0    MSGBLK+21,,AUTO
         4 000155   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000156   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000157   000000 701000 xent               TSX1    QQC$EX_SPEC
         4 000160   000755 702000 4                  TSX2    RET

      192     6804
      193     6805    1           IF OPT$ = ADDR(NIL) OR

   6805  4 000161   200017 236100                    LDQ     OPT$,,AUTO
         4 000162   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000163   000170 600000 4                  TZE     TRANS_CHK
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:34   
         4 000164   200017 470500                    LDP0    OPT$,,AUTO
         4 000165   000000 720100                    LXL0    0,,PR0
         4 000166   000002 100003                    CMPX0   2,DU
         4 000167   000201 601000 4                  TNZ     REPORT_CHK

      194     6806    1               OPT$ -> OUT$BLK.CODE = 2 /* OPT_TRANSACTIONS */ THEN
      195     6807    1   TRANS_CHK:
      196     6808    2             DO;

   6808  4 000170                       TRANS_CHK    null
      197     6809    2               VLP_SCGMA.ORIGIN# = '1'B;

   6809  4 000170   200000 236003                    LDQ     65536,DU
         4 000171   000166 256000 3                  ORSQ    VLP_SCGMA

      198     6810    2               FPT_FWCG.V.QSELECT# = 3 /* CG_QSELECT_ANONYMOUS# */;

   6810  4 000172   000101 236000 3                  LDQ     FPT_FWCG+29
         4 000173   000003 376000 5                  ANQ     3
         4 000174   060000 276003                    ORQ     24576,DU
         4 000175   000101 756000 3                  STQ     FPT_FWCG+29

      199     6811    2               QQ_CMDBLK.MINOR_ERR = CODE_NTF;

   6811  4 000176   000035 236000 2                  LDQ     CODE_NTF
         4 000177   000001 756000 xsym               STQ     QQ_CMDBLK+1

      200     6812    2             END;

   6812  4 000200   000231 710000 4                  TRA     s:6830

      201     6813    1           ELSE
      202     6814    1   REPORT_CHK:
      203     6815    2             DO;

   6815  4 000201                       REPORT_CHK   null
      204     6816    2               VLP_SCGMA.DEST# = '1'B;
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:35   

   6816  4 000201   100000 236003                    LDQ     32768,DU
         4 000202   000166 256000 3                  ORSQ    VLP_SCGMA

      205     6817    2               VLP_SCGMA.ORIGIN# = '0'B;

   6817  4 000203   000004 236000 5                  LDQ     4
         4 000204   000166 356000 3                  ANSQ    VLP_SCGMA

      206     6818    2               VLP_CGMA.DEST# = VLP_CGMA.ORIGIN#;

   6818  4 000205   000152 237000 3                  LDAQ    VLP_CGMA+4
         4 000206   000157 755000 3                  STA     VLP_CGMA+9
         4 000207   000160 756000 3                  STQ     VLP_CGMA+10

      207     6819    2               FPT_FWCG.V.QSELECT# = 2 /* CG_QSELECT_DIRECT# */;

   6819  4 000210   000101 236000 3                  LDQ     FPT_FWCG+29
         4 000211   000003 376000 5                  ANQ     3
         4 000212   040000 276003                    ORQ     16384,DU
         4 000213   000101 756000 3                  STQ     FPT_FWCG+29

      208     6820    2               IF HELD_FLAG THEN

   6820  4 000214   200005 234100                    SZN     HELD_FLAG,,AUTO
         4 000215   000227 605000 4                  TPL     s:6827

      209     6821    3                 DO;

      210     6822    3                   VLP_CGMA.ORIGIN# = 'HOLDSTA';

   6822  4 000216   040000 100400                    MLR     fill='040'O
         4 000217   000042 000007 2                  ADSC9   CODE_CHKSUMTITLE+2       cn=0,n=7
         4 000220   000152 000010 3                  ADSC9   VLP_CGMA+4               cn=0,n=8

      211     6823    3                   VLP_CGMA.DEST# = VLP_CGMA.ORIGIN#;

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:36   
   6823  4 000221   000152 237000 3                  LDAQ    VLP_CGMA+4
         4 000222   000157 755000 3                  STA     VLP_CGMA+9
         4 000223   000160 756000 3                  STQ     VLP_CGMA+10

      212     6824    3                   QQ_CMDBLK.MINOR_ERR = CODE_NHTF;

   6824  4 000224   000036 236000 2                  LDQ     CODE_NHTF
         4 000225   000001 756000 xsym               STQ     QQ_CMDBLK+1

      213     6825    3                 END;

   6825  4 000226   000231 710000 4                  TRA     s:6830

      214     6826    2               ELSE
      215     6827    2                 QQ_CMDBLK.MINOR_ERR = CODE_NRF;

   6827  4 000227   000034 236000 2                  LDQ     CODE_NRF
         4 000230   000001 756000 xsym               STQ     QQ_CMDBLK+1

      216     6828    2             END;

      217     6829
      218     6830    1           CALL M$FWCG(FPT_FWCG) ALTRET(FWCG_ERR);

   6830  4 000231   000044 630400 3                  EPPR0   FPT_FWCG
         4 000232   500005 713400                    CLIMB   alt,+32773
         4 000233   406400 401760                    pmme    nvectors=14
         4 000234   000236 702000 4                  TSX2    FWCG_ERR

      219     6831
      220     6832    2           DO WHILE('0'B);

   6832  4 000235   000245 710000 4                  TRA     s:6841

      221     6833
      222     6834    2   FWCG_ERR:
      223     6835    2             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1170 /* E$FWCG_NONE */ THEN
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:37   

   6835  4 000236   000000 470400 xsym  FWCG_ERR     LDP0    B$TCB$
         4 000237   000000 471500                    LDP1    0,,PR0
         4 000240   100102 236100                    LDQ     66,,PR1
         4 000241   377770 376007                    ANQ     131064,DL
         4 000242   022220 116007                    CMPQ    9360,DL
         4 000243   000245 600000 4                  TZE     s:6841

      224     6836    3               DO;

      225     6837    3                 GOTO MON_ERR;

   6837  4 000244   000756 710000 4                  TRA     MON_ERR

      226     6838    3               END;
      227     6839    2           END /* NEVER */;

      228     6840
      229     6841    1           CALL QQC$CONVERT_NUM(VLR_FWCG.FOUND#, SIZE, ADDR(TEXTC_NUM.NAME#));

   6841  4 000245   000005 236000 5                  LDQ     5
         4 000246   200126 756100                    STQ     MSGBLK+21,,AUTO
         4 000247   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000250   200131 450500                    STP0    MSGBLK+24,,AUTO
         4 000251   200006 631500                    EPPR1   SIZE,,AUTO
         4 000252   200130 451500                    STP1    MSGBLK+23,,AUTO
         4 000253   000006 236000 5                  LDQ     6
         4 000254   200127 756100                    STQ     MSGBLK+22,,AUTO
         4 000255   200127 630500                    EPPR0   MSGBLK+22,,AUTO
         4 000256   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000257   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         4 000260   000000 011000                    NOP     0

      230     6842    1           CALL QQC$BLDMSG_BLK(MSGBLK);

   6842  4 000261   200101 630500                    EPPR0   MSGBLK,,AUTO
         4 000262   200126 450500                    STP0    MSGBLK+21,,AUTO
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:38   
         4 000263   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000265   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000266   000000 011000                    NOP     0

      231     6843    1           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);

   6843  4 000267   000100 100400                    MLR     fill='000'O
         4 000270   000010 000010 5                  ADSC9   8                        cn=0,n=8
         4 000271   200110 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      232     6844    1           TEXTC_NUM.L# = SIZE;

   6844  4 000272   200006 236100                    LDQ     SIZE,,AUTO
         4 000273   000033 736000                    QLS     27
         4 000274   000036 552040 3                  STBQ    TEXTC_NUM,'40'O

      233     6845    1           CALL QQC$BLDMSG(MSGBLK);

   6845  4 000275   200101 630500                    EPPR0   MSGBLK,,AUTO
         4 000276   200126 450500                    STP0    MSGBLK+21,,AUTO
         4 000277   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000300   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000301   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000302   000000 011000                    NOP     0

      234     6846
      235     6847    1           IF VLR_FWCG.FOUND# = 0 THEN

   6847  4 000303   000200 235000 3                  LDA     VLR_FWCG
         4 000304   000306 601000 4                  TNZ     s:6852

      236     6848    2             DO;

      237     6849    2               GOTO MORE_CHK;

   6849  4 000305   000735 710000 4                  TRA     MORE_CHK
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:39   

      238     6850    2             END;
      239     6851
      240     6852    2           IF ~SUMMARY_FLAG THEN DO;

   6852  4 000306   200004 236100                    LDQ     SUMMARY_FLAG,,AUTO
         4 000307   400000 376003                    ANQ     -131072,DU
         4 000310   400000 676003                    ERQ     -131072,DU
         4 000311   000330 600000 4                  TZE     s:6858

      241     6853    2               QQ_CMDBLK.MINOR_ERR = CODE_CHKTITLE;

   6853  4 000312   000037 236000 2                  LDQ     CODE_CHKTITLE
         4 000313   000001 756000 xsym               STQ     QQ_CMDBLK+1

      242     6854    2               CALL QQC$BLDMSG_BLK(MSGBLK);

   6854  4 000314   200101 630500                    EPPR0   MSGBLK,,AUTO
         4 000315   200126 450500                    STP0    MSGBLK+21,,AUTO
         4 000316   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000317   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000320   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000321   000000 011000                    NOP     0

      243     6855    2               CALL QQC$BLDMSG(MSGBLK);

   6855  4 000322   200101 630500                    EPPR0   MSGBLK,,AUTO
         4 000323   200126 450500                    STP0    MSGBLK+21,,AUTO
         4 000324   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000325   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000326   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000327   000000 011000                    NOP     0

      244     6856    2             END;

      245     6857
      246     6858    1           IF QQ_GLOBAL.CGSIZEMAX < QQ_GLOBAL.TRASHBUF_SIZE THEN
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:40   

   6858  4 000330   000021 236000 xsym               LDQ     QQ_GLOBAL+17
         4 000331   000060 116000 xsym               CMPQ    QQ_GLOBAL+48
         4 000332   000335 603000 4                  TRC     s:6864

      247     6859    2             DO;

      248     6860    2               MAX_READ_SIZE = QQ_GLOBAL.CGSIZEMAX;

   6860  4 000333   200016 756100                    STQ     MAX_READ_SIZE,,AUTO

      249     6861    2             END;

   6861  4 000334   000337 710000 4                  TRA     s:6867

      250     6862    1           ELSE
      251     6863    2             DO;

      252     6864    2               MAX_READ_SIZE = QQ_GLOBAL.TRASHBUF_SIZE;

   6864  4 000335   000060 235000 xsym               LDA     QQ_GLOBAL+48
         4 000336   200016 755100                    STA     MAX_READ_SIZE,,AUTO

      253     6865    2             END;

      254     6866
      255     6867    1           NUM_LEFT = VLR_FWCG.FOUND#;

   6867  4 000337   000200 235000 3                  LDA     VLR_FWCG
         4 000340   200007 755100                    STA     NUM_LEFT,,AUTO

      256     6868    1           CGMA$ = PINCRC(QQ_GLOBAL.TRASHBUF$, SIZEC(B$CGAURD));

   6868  4 000341   000057 236000 xsym               LDQ     QQ_GLOBAL+47
         4 000342   000004 036003                    ADLQ    4,DU
         4 000343   200023 756100                    STQ     CGMA$,,AUTO

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:41   
      257     6869    1           NUM_THIS_READ = (MAX_READ_SIZE - SIZEC(B$CGAURD)) /

   6869  4 000344   200016 236100                    LDQ     MAX_READ_SIZE,,AUTO
         4 000345   000020 136007                    SBLQ    16,DL
         4 000346   000100 506007                    DIV     64,DL
         4 000347   200010 756100                    STQ     NUM_THIS_READ,,AUTO

      258     6870    1               SIZEC(VLP$CGMA);
      259     6871    1           BYTES_THIS_READ = SIZEC(B$CGAURD) + NUM_THIS_READ * SIZEC(VLP$CGMA);

   6871  4 000350   200010 235100                    LDA     NUM_THIS_READ,,AUTO
         4 000351   000006 735000                    ALS     6
         4 000352   000020 035007                    ADLA    16,DL
         4 000353   200012 755100                    STA     BYTES_THIS_READ,,AUTO

      260     6872    1           FPT_READ.BUF_.BUF$ = QQ_GLOBAL.TRASHBUF$;

   6872  4 000354   000057 236000 xsym               LDQ     QQ_GLOBAL+47
         4 000355   000123 756000 3                  STQ     FPT_READ+5

      261     6873    1           FPT_READ.BUF_.BOUND = BYTES_THIS_READ - 1;

   6873  4 000356   200012 236100                    LDQ     BYTES_THIS_READ,,AUTO
         4 000357   000001 136007                    SBLQ    1,DL
         4 000360   000020 736000                    QLS     16
         4 000361   000122 676000 3                  ERQ     FPT_READ+4
         4 000362   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000363   000122 656000 3                  ERSQ    FPT_READ+4

      262     6874    1           FPT_READ.V.DVBYTE.CONT# = '0'B;

   6874  4 000364   000012 236000 5                  LDQ     10
         4 000365   000131 356000 3                  ANSQ    FPT_READ+11

      263     6875
      264     6876    2           DO WHILE(NUM_LEFT > 0);

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:42   
   6876  4 000366   200007 235100                    LDA     NUM_LEFT,,AUTO
         4 000367   000650 604400 4                  TMOZ    s:6945

      265     6877    2             CALL M$READ(FPT_READ) ALTRET(READ_ERR);

   6877  4 000370   000116 630400 3                  EPPR0   FPT_READ
         4 000371   440000 713400                    CLIMB   alt,read
         4 000372   401400 401760                    pmme    nvectors=4
         4 000373   000375 702000 4                  TSX2    READ_ERR

      266     6878
      267     6879    3             DO WHILE('0'B);

   6879  4 000374   000404 710000 4                  TRA     s:6888

      268     6880
      269     6881    3   READ_ERR:
      270     6882    3               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 7 /* E$LD */ THEN

   6882  4 000375   000000 470400 xsym  READ_ERR     LDP0    B$TCB$
         4 000376   000000 471500                    LDP1    0,,PR0
         4 000377   100102 236100                    LDQ     66,,PR1
         4 000400   377770 376007                    ANQ     131064,DL
         4 000401   000070 116007                    CMPQ    56,DL
         4 000402   000404 600000 4                  TZE     s:6888

      271     6883    4                 DO;

      272     6884    4                   GOTO MON_ERR;

   6884  4 000403   000756 710000 4                  TRA     MON_ERR

      273     6885    4                 END;
      274     6886    3             END /* NEVER */;

      275     6887
      276     6888    2             IF NUM_LEFT < NUM_THIS_READ THEN
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:43   

   6888  4 000404   200007 236100                    LDQ     NUM_LEFT,,AUTO
         4 000405   200010 116100                    CMPQ    NUM_THIS_READ,,AUTO
         4 000406   000410 605000 4                  TPL     s:6893

      277     6889    3               DO;

      278     6890    3                 NUM_THIS_READ = NUM_LEFT;

   6890  4 000407   200010 756100                    STQ     NUM_THIS_READ,,AUTO

      279     6891    3               END;

      280     6892
      281     6893    3             DO I = 1 TO NUM_THIS_READ;

   6893  4 000410   000001 235007                    LDA     1,DL
         4 000411   200013 755100                    STA     I,,AUTO
         4 000412   000623 710000 4                  TRA     s:6937+1

      282     6894    4               IF SUMMARY_FLAG THEN DO;

   6894  4 000413   200004 234100                    SZN     SUMMARY_FLAG,,AUTO
         4 000414   000511 605000 4                  TPL     s:6914

      283     6895    4                   IF VLP$CGMA.MSGTYP# = LAST_MSGTYP# THEN

   6895  4 000415   200023 470500                    LDP0    CGMA$,,AUTO
         4 000416   040100 106500                    CMPC    fill='040'O
         4 000417   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         4 000420   200075 000010                    ADSC9   LAST_MSGTYP#,,AUTO       cn=0,n=8
         4 000421   000426 601000 4                  TNZ     s:6898

      284     6896    4                     LAST_MSG_CNT = LAST_MSG_CNT + 1;

   6896  4 000422   200077 235100                    LDA     LAST_MSG_CNT,,AUTO
         4 000423   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:44   
         4 000424   200077 755100                    STA     LAST_MSG_CNT,,AUTO
         4 000425   000615 710000 4                  TRA     s:6935

      285     6897    5                   ELSE DO;

      286     6898    6                       IF LAST_MSGTYP# ~= ' ' THEN DO;

   6898  4 000426   040000 106500                    CMPC    fill='040'O
         4 000427   200075 000010                    ADSC9   LAST_MSGTYP#,,AUTO       cn=0,n=8
         4 000430   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000431   000502 600000 4                  TZE     s:6909

      287     6899    6                           QQ_CMDBLK.MINOR_ERR = CODE_CHKSUMTITLE;

   6899  4 000432   000040 236000 2                  LDQ     CODE_CHKSUMTITLE
         4 000433   000001 756000 xsym               STQ     QQ_CMDBLK+1

      288     6900    6                           CALL QQC$BLDMSG_BLK(MSGBLK);

   6900  4 000434   200101 631500                    EPPR1   MSGBLK,,AUTO
         4 000435   200126 451500                    STP1    MSGBLK+21,,AUTO
         4 000436   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000437   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000440   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000441   000000 011000                    NOP     0

      289     6901    6                           TEXTC_NAME.L# = 8;

   6901  4 000442   010000 236003                    LDQ     4096,DU
         4 000443   000041 552040 3                  STBQ    TEXTC_NAME,'40'O

      290     6902    6                           TEXTC_NAME.NAME# = LAST_MSGTYP#;

   6902  4 000444   040000 100500                    MLR     fill='040'O
         4 000445   200075 000010                    ADSC9   LAST_MSGTYP#,,AUTO       cn=0,n=8
         4 000446   000041 200010 3                  ADSC9   TEXTC_NAME               cn=1,n=8

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:45   
      291     6903    6                           MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_NAME);

   6903  4 000447   000100 100400                    MLR     fill='000'O
         4 000450   000014 000010 5                  ADSC9   12                       cn=0,n=8
         4 000451   200112 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8

      292     6904    6                          CALL QQC$CONVERT_NUM(LAST_MSG_CNT,SIZE,ADDR(TEXTC_NUM.NAME#)
              6904                                    );

   6904  4 000452   000005 236000 5                  LDQ     5
         4 000453   200126 756100                    STQ     MSGBLK+21,,AUTO
         4 000454   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000455   200131 450500                    STP0    MSGBLK+24,,AUTO
         4 000456   200006 631500                    EPPR1   SIZE,,AUTO
         4 000457   200130 451500                    STP1    MSGBLK+23,,AUTO
         4 000460   200077 633500                    EPPR3   LAST_MSG_CNT,,AUTO
         4 000461   200127 453500                    STP3    MSGBLK+22,,AUTO
         4 000462   200127 630500                    EPPR0   MSGBLK+22,,AUTO
         4 000463   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000464   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         4 000465   000000 011000                    NOP     0

      293     6905    6                           TEXTC_NUM.L# = SIZE;

   6905  4 000466   200006 236100                    LDQ     SIZE,,AUTO
         4 000467   000033 736000                    QLS     27
         4 000470   000036 552040 3                  STBQ    TEXTC_NUM,'40'O

      294     6906    6                           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);

   6906  4 000471   000100 100400                    MLR     fill='000'O
         4 000472   000010 000010 5                  ADSC9   8                        cn=0,n=8
         4 000473   200110 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      295     6907    6                           CALL QQC$BLDMSG(MSGBLK);

   6907  4 000474   200101 630500                    EPPR0   MSGBLK,,AUTO
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:46   
         4 000475   200126 450500                    STP0    MSGBLK+21,,AUTO
         4 000476   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000477   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000500   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000501   000000 011000                    NOP     0

      296     6908    6                         END;

      297     6909    5                       LAST_MSGTYP# = VLP$CGMA.MSGTYP#;

   6909  4 000502   200023 470500                    LDP0    CGMA$,,AUTO
         4 000503   040100 100500                    MLR     fill='040'O
         4 000504   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         4 000505   200075 000010                    ADSC9   LAST_MSGTYP#,,AUTO       cn=0,n=8

      298     6910    5                       LAST_MSG_CNT = 1;

   6910  4 000506   000001 235007                    LDA     1,DL
         4 000507   200077 755100                    STA     LAST_MSG_CNT,,AUTO

      299     6911    5                     END;

      300     6912    4                 END;

   6912  4 000510   000615 710000 4                  TRA     s:6935

      301     6913    4               ELSE DO;

      302     6914    4                   DATA_VECTRS(0) = VECTOR(VLP$CGMA.MSGTYP#);

   6914  4 000511   000013 235000 5                  LDA     11
         4 000512   200023 236100                    LDQ     CGMA$,,AUTO
         4 000513   000002 036003                    ADLQ    2,DU
         4 000514   200055 755100                    STA     DATA_VECTRS,,AUTO
         4 000515   200056 756100                    STQ     DATA_VECTRS+1,,AUTO

      303     6915
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:47   
      304     6916    4                   DATA_VECTRS(1) = VECTOR(VLP$CGMA.ORIGIN#);

   6916  4 000516   000013 235000 5                  LDA     11
         4 000517   200023 236100                    LDQ     CGMA$,,AUTO
         4 000520   000004 036003                    ADLQ    4,DU
         4 000521   200057 755100                    STA     DATA_VECTRS+2,,AUTO
         4 000522   200060 756100                    STQ     DATA_VECTRS+3,,AUTO

      305     6917
      306     6918    4                   DATA_VECTRS(2) = VECTOR(VLP$CGMA.DEST#);

   6918  4 000523   000013 235000 5                  LDA     11
         4 000524   200023 236100                    LDQ     CGMA$,,AUTO
         4 000525   000011 036003                    ADLQ    9,DU
         4 000526   200061 755100                    STA     DATA_VECTRS+4,,AUTO
         4 000527   200062 756100                    STQ     DATA_VECTRS+5,,AUTO

      307     6919
      308     6920    4                   PRIO = VLP$CGMA.PRIO#;

   6920  4 000530   200023 470500                    LDP0    CGMA$,,AUTO
         4 000531   000001 220100                    LDX0    1,,PR0
         4 000532   200100 740100                    STX0    PRIO,,AUTO

      309     6921    4                   DATA_VECTRS(3) = VECTOR(PRIO_ELEMENTS.MSG);

   6921  4 000533   177640 235007                    LDA     65440,DL
         4 000534   200126 452500                    STP2    MSGBLK+21,,AUTO
         4 000535   200126 236100                    LDQ     MSGBLK+21,,AUTO
         4 000536   000100 036003                    ADLQ    64,DU
         4 000537   200063 755100                    STA     DATA_VECTRS+6,,AUTO
         4 000540   200064 756100                    STQ     DATA_VECTRS+7,,AUTO

      310     6922    4                   DATA_VECTRS(4) = VECTOR(PRIO_ELEMENTS.STATION);

   6922  4 000541   177640 235007                    LDA     65440,DL
         4 000542   200126 452500                    STP2    MSGBLK+21,,AUTO
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:48   
         4 000543   200126 236100                    LDQ     MSGBLK+21,,AUTO
         4 000544   000016 036000 5                  ADLQ    14
         4 000545   200065 755100                    STA     DATA_VECTRS+8,,AUTO
         4 000546   200066 756100                    STQ     DATA_VECTRS+9,,AUTO

      311     6923
      312     6924    4                   DATA_VECTRS(5) = VECTOR(VLP$CGMA.UTS#);

   6924  4 000547   777640 235007                    LDA     -96,DL
         4 000550   200023 236100                    LDQ     CGMA$,,AUTO
         4 000551   000007 036003                    ADLQ    7,DU
         4 000552   200067 755100                    STA     DATA_VECTRS+10,,AUTO
         4 000553   200070 756100                    STQ     DATA_VECTRS+11,,AUTO

      313     6925
      314     6926    4                   DATA_VECTRS(6) = VECTOR(VLP$CGMA.MSGSIZE#);

   6926  4 000554   777640 235007                    LDA     -96,DL
         4 000555   200023 236100                    LDQ     CGMA$,,AUTO
         4 000556   000016 036003                    ADLQ    14,DU
         4 000557   200071 755100                    STA     DATA_VECTRS+12,,AUTO
         4 000560   200072 756100                    STQ     DATA_VECTRS+13,,AUTO

      315     6927
      316     6928    4                   CALL QQC$CONVERT_XID(CHAR_STRING_SIZE, ADDR(TEXT_XID),

   6928  4 000561   200024 631500                    EPPR1   TEXT_XID,,AUTO
         4 000562   200126 451500                    STP1    MSGBLK+21,,AUTO
         4 000563   200023 236100                    LDQ     CGMA$,,AUTO
         4 000564   000015 036003                    ADLQ    13,DU
         4 000565   200133 756100                    STQ     MSGBLK+26,,AUTO
         4 000566   200023 236100                    LDQ     CGMA$,,AUTO
         4 000567   000014 036003                    ADLQ    12,DU
         4 000570   200132 756100                    STQ     MSGBLK+25,,AUTO
         4 000571   200126 633500                    EPPR3   MSGBLK+21,,AUTO
         4 000572   200131 453500                    STP3    MSGBLK+24,,AUTO
         4 000573   200011 634500                    EPPR4   CHAR_STRING_SIZE,,AUTO
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:49   
         4 000574   200130 454500                    STP4    MSGBLK+23,,AUTO
         4 000575   200130 630500                    EPPR0   MSGBLK+23,,AUTO
         4 000576   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000577   000000 701000 xent               TSX1    QQC$CONVERT_XID
         4 000600   000000 011000                    NOP     0

      317     6929    4                       VLP$CGMA.MSGID#, VLP$CGMA.MSGIDBXT);
      318     6930    4                   DATA_VECTRS(7) = VECTOR(ADDR(TEXT_XID) -> CHAR$STRING);

   6930  4 000601   200011 235100                    LDA     CHAR_STRING_SIZE,,AUTO
         4 000602   000020 735000                    ALS     16
         4 000603   000140 135007                    SBLA    96,DL
         4 000604   200126 452500                    STP2    MSGBLK+21,,AUTO
         4 000605   200126 236100                    LDQ     MSGBLK+21,,AUTO
         4 000606   000024 036003                    ADLQ    20,DU
         4 000607   200073 755100                    STA     DATA_VECTRS+14,,AUTO
         4 000610   200074 756100                    STQ     DATA_VECTRS+15,,AUTO

      319     6931
      320     6932    4                   CALL X$FORMAT(F_FDS);

   6932  4 000611   000017 630400 5                  EPPR0   15
         4 000612   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000613   000000 701000 xent               TSX1    X$FORMAT
         4 000614   000000 011000                    NOP     0

      321     6933
      322     6934    4                 END;

      323     6935    3               CGMA$ = PINCRC(CGMA$, SIZEC(VLP$CGMA));

   6935  4 000615   200023 236100                    LDQ     CGMA$,,AUTO
         4 000616   000020 036003                    ADLQ    16,DU
         4 000617   200023 756100                    STQ     CGMA$,,AUTO

      324     6936    3               NUM_LEFT = NUM_LEFT - 1;

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:50   
   6936  4 000620   000001 336007                    LCQ     1,DL
         4 000621   200007 056100                    ASQ     NUM_LEFT,,AUTO

      325     6937    3             END;

   6937  4 000622   200013 054100                    AOS     I,,AUTO
         4 000623   200013 236100                    LDQ     I,,AUTO
         4 000624   200010 116100                    CMPQ    NUM_THIS_READ,,AUTO
         4 000625   000413 604400 4                  TMOZ    s:6894

      326     6938
      327     6939    2             CGMA$ = QQ_GLOBAL.TRASHBUF$;

   6939  4 000626   000057 236000 xsym               LDQ     QQ_GLOBAL+47
         4 000627   200023 756100                    STQ     CGMA$,,AUTO

      328     6940    2             FPT_READ.V.DVBYTE.CONT# = '1'B;

   6940  4 000630   001000 236003                    LDQ     512,DU
         4 000631   000131 256000 3                  ORSQ    FPT_READ+11

      329     6941    2             NUM_THIS_READ = MAX_READ_SIZE / SIZEC(VLP$CGMA);

   6941  4 000632   200016 236100                    LDQ     MAX_READ_SIZE,,AUTO
         4 000633   000100 506007                    DIV     64,DL
         4 000634   200010 756100                    STQ     NUM_THIS_READ,,AUTO

      330     6942    2             BYTES_THIS_READ = NUM_THIS_READ * SIZEC(VLP$CGMA);

   6942  4 000635   200010 235100                    LDA     NUM_THIS_READ,,AUTO
         4 000636   000006 735000                    ALS     6
         4 000637   200012 755100                    STA     BYTES_THIS_READ,,AUTO

      331     6943    2             FPT_READ.BUF_.BOUND = BYTES_THIS_READ - 1;

   6943  4 000640   200012 236100                    LDQ     BYTES_THIS_READ,,AUTO
         4 000641   000001 136007                    SBLQ    1,DL
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:51   
         4 000642   000020 736000                    QLS     16
         4 000643   000122 676000 3                  ERQ     FPT_READ+4
         4 000644   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000645   000122 656000 3                  ERSQ    FPT_READ+4

      332     6944    2           END;

   6944  4 000646   200007 236100                    LDQ     NUM_LEFT,,AUTO
         4 000647   000370 605400 4                  TPNZ    s:6877

      333     6945    2           IF SUMMARY_FLAG AND LAST_MSG_CNT ~= 0 THEN DO;

   6945  4 000650   200004 234100                    SZN     SUMMARY_FLAG,,AUTO
         4 000651   000731 605000 4                  TPL     s:6958
         4 000652   200077 235100                    LDA     LAST_MSG_CNT,,AUTO
         4 000653   000731 600000 4                  TZE     s:6958

      334     6946    2               QQ_CMDBLK.MINOR_ERR = CODE_CHKSUMTITLE;

   6946  4 000654   000040 236000 2                  LDQ     CODE_CHKSUMTITLE
         4 000655   000001 756000 xsym               STQ     QQ_CMDBLK+1

      335     6947    2               CALL QQC$BLDMSG_BLK(MSGBLK);

   6947  4 000656   200101 630500                    EPPR0   MSGBLK,,AUTO
         4 000657   200126 450500                    STP0    MSGBLK+21,,AUTO
         4 000660   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000661   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000662   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000663   000000 011000                    NOP     0

      336     6948    2               TEXTC_NAME.L# = 8;

   6948  4 000664   010000 236003                    LDQ     4096,DU
         4 000665   000041 552040 3                  STBQ    TEXTC_NAME,'40'O

      337     6949    2               TEXTC_NAME.NAME# = LAST_MSGTYP#;
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:52   

   6949  4 000666   040000 100500                    MLR     fill='040'O
         4 000667   200075 000010                    ADSC9   LAST_MSGTYP#,,AUTO       cn=0,n=8
         4 000670   000041 200010 3                  ADSC9   TEXTC_NAME               cn=1,n=8

      338     6950    2               MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_NAME);

   6950  4 000671   000100 100400                    MLR     fill='000'O
         4 000672   000014 000010 5                  ADSC9   12                       cn=0,n=8
         4 000673   200112 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8

      339     6951    2               CALL QQC$CONVERT_NUM(LAST_MSG_CNT,SIZE,ADDR(TEXTC_NUM.NAME#));

   6951  4 000674   000005 236000 5                  LDQ     5
         4 000675   200126 756100                    STQ     MSGBLK+21,,AUTO
         4 000676   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000677   200131 450500                    STP0    MSGBLK+24,,AUTO
         4 000700   200006 631500                    EPPR1   SIZE,,AUTO
         4 000701   200130 451500                    STP1    MSGBLK+23,,AUTO
         4 000702   200077 633500                    EPPR3   LAST_MSG_CNT,,AUTO
         4 000703   200127 453500                    STP3    MSGBLK+22,,AUTO
         4 000704   200127 630500                    EPPR0   MSGBLK+22,,AUTO
         4 000705   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000706   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         4 000707   000000 011000                    NOP     0

      340     6952    2               TEXTC_NUM.L# = SIZE;

   6952  4 000710   200006 236100                    LDQ     SIZE,,AUTO
         4 000711   000033 736000                    QLS     27
         4 000712   000036 552040 3                  STBQ    TEXTC_NUM,'40'O

      341     6953    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);

   6953  4 000713   000100 100400                    MLR     fill='000'O
         4 000714   000010 000010 5                  ADSC9   8                        cn=0,n=8
         4 000715   200110 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:53   

      342     6954    2               CALL QQC$BLDMSG(MSGBLK);

   6954  4 000716   200101 630500                    EPPR0   MSGBLK,,AUTO
         4 000717   200126 450500                    STP0    MSGBLK+21,,AUTO
         4 000720   200126 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000722   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000723   000000 011000                    NOP     0

      343     6955    2               LAST_MSGTYP# = ' ';

   6955  4 000724   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000725   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000726   200075 755100                    STA     LAST_MSGTYP#,,AUTO
         4 000727   200076 756100                    STQ     LAST_MSGTYP#+1,,AUTO

      344     6956    2               LAST_MSG_CNT = 0;

   6956  4 000730   200077 450100                    STZ     LAST_MSG_CNT,,AUTO

      345     6957    2             END;

      346     6958    1           CALL M$UNLATCH(FPT_UNLATCH) ALTRET(MON_ERR);

   6958  4 000731   000134 630400 3                  EPPR0   FPT_UNLATCH
         4 000732   500002 713400                    CLIMB   alt,+32770
         4 000733   401000 401760                    pmme    nvectors=3
         4 000734   000756 702000 4                  TSX2    MON_ERR

      347     6959
      348     6960    1   MORE_CHK:
      349     6961    1           IF OPT$ = ADDR(NIL) AND (NOT VLP_SCGMA.DEST#) THEN

   6961  4 000735   200017 236100       MORE_CHK     LDQ     OPT$,,AUTO
         4 000736   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000737   000743 601000 4                  TNZ     s:6964
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:54   
         4 000740   000166 236000 3                  LDQ     VLP_SCGMA
         4 000741   100000 316003                    CANQ    32768,DU
         4 000742   000201 600000 4                  TZE     REPORT_CHK

      350     6962    1             GOTO REPORT_CHK;
      351     6963
      352     6964    1           IF OPT$ = ADDR(NIL) AND

   6964  4 000743   200017 236100                    LDQ     OPT$,,AUTO
         4 000744   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000745   000755 601000 4                  TNZ     RET
         4 000746   040000 106400                    CMPC    fill='040'O
         4 000747   000152 000010 3                  ADSC9   VLP_CGMA+4               cn=0,n=8
         4 000750   000042 000007 2                  ADSC9   CODE_CHKSUMTITLE+2       cn=0,n=7
         4 000751   000755 600000 4                  TZE     RET

      353     6965    1               VLP_CGMA.ORIGIN# ~= 'HOLDSTA' THEN
      354     6966    2             DO;

      355     6967    2               HELD_FLAG = '1'B;

   6967  4 000752   400000 236003                    LDQ     -131072,DU
         4 000753   200005 756100                    STQ     HELD_FLAG,,AUTO

      356     6968    2               GOTO REPORT_CHK;

   6968  4 000754   000201 710000 4                  TRA     REPORT_CHK

      357     6969    2             END;
      358     6970
      359     6971    1   RET:
      360     6972    1           RETURN;

   6972  4 000755   000000 702200 xent  RET          TSX2  ! X66_ARET

      361     6973
      362     6974    1   MON_ERR:
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:55   
      363     6975    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   6975  4 000756   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         4 000757   000000 471500                    LDP1    0,,PR0
         4 000760   100102 236100                    LDQ     66,,PR1
         4 000761   000000 756000 xsym               STQ     QQ_GLOBAL

      364     6976    1           CALL QQC$SCREECH;

   6976  4 000762   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000763   000000 701000 xent               TSX1    QQC$SCREECH
         4 000764   000000 011000                    NOP     0

      365     6977
      366     6978    1   END QQB$CHECK;

   6978  4 000765   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:56   
--  Include file information  --

   QQ_SUBS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$CHECK.
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:57   

 **** Variables and constants ****

  ****  Section 002 RoData QQB$CHECK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    40-0-0/b STRC        r     1 CODE_CHKSUMTITLE          37-0-0/b STRC        r     1 CODE_CHKTITLE
    36-0-0/b STRC        r     1 CODE_NHTF                 34-0-0/b STRC        r     1 CODE_NRF
    35-0-0/b STRC        r     1 CODE_NTF                   0-0-0/c STRC(333)   r     1 FORMAT1
    12-0-0/w STRC(576)   r     1 VLP_CGMA_C                32-0-0/d STRC(72)    r     1 VLP_SCGMA_C

  ****  Section 003  Data  QQB$CHECK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    44-0-0/d STRC(1512)  r     1 FPT_FWCG                 116-0-0/d STRC(504)   r     1 FPT_READ
   134-0-0/d STRC(360)   r     1 FPT_UNLATCH                0-0-0/w STRC(1080)  r     1 F_FDS
    41-0-0/c STRC(81)    r     1 TEXTC_NAME                36-0-0/c STRC(99)    r     1 TEXTC_NUM
   146-0-0/w STRC(576)   r     1 VLP_CGMA                 166-0-0/d STRC(72)    r     1 VLP_SCGMA
   170-0-0/w STRC(288)   r     1 VLP_STATION              200-0-0/d STRC(360)   r     1 VLR_FWCG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    31-0-0/c CHAR(80)    r     1 BUF                       12-0-0/w SBIN        r     1 BYTES_THIS_READ
    23-0-0/w PTR         r     1 CGMA$                     11-0-0/w SBIN        r     1 CHAR_STRING_SIZE
    55-0-0/b BIT (72)    r     1 DATA_VECTRS(0:7)
     5-0-0/w BIT         r     1 HELD_FLAG                 13-0-0/w SBIN        r     1 I
    14-0-0/w SBIN        r     1 II                        75-0-0/c CHAR(8)     r     1 LAST_MSGTYP#
    77-0-0/w UBIN        r     1 LAST_MSG_CNT              16-0-0/w SBIN        r     1 MAX_READ_SIZE
   101-0-0/w STRC(738)   r     1 MSGBLK                    15-0-0/w SBIN        r     1 NSUBLKS
     7-0-0/w SBIN        r     1 NUM_LEFT                  10-0-0/w SBIN        r     1 NUM_THIS_READ
    17-0-0/w PTR         r     1 OPT$                     100-0-0/b UBIN(18)    r     1 PRIO
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:58   
   100-0-0/b STRC(18)    r     1 PRIO_ELEMENTS              3-0-0/w PTR         r     1 S$
     6-0-0/w SBIN        r     1 SIZE                      22-0-0/w PTR         r     1 SPECIFIER$
    21-0-0/w PTR         r     1 SUBLK$                    20-0-0/w PTR         r     1 SUM$
     4-0-0/w BIT         r     1 SUMMARY_FLAG              24-0-0/c CHAR(20)    r     1 TEXT_XID

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(315)   r     1 QQ_CMDBLK
     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$CGAURD
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 CHAR$STRING
     0-0-0N  NULL        r     1 M$INFOSTA                  0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(909)   r     1 TP$STATION
     0-0-0/w STRC(576)   r     1 VLP$CGMA


   Procedure QQB$CHECK requires 502 words for executable code.
   Procedure QQB$CHECK requires 92 words of local(AUTO) storage.

    No errors detected in file QQB$CHECK.:E05TSI    .
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:59   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:60   
          MINI XREF LISTING

B$ALT.CODE
      5909**DCL      5909--REDEF    5910--REDEF    5910--REDEF
B$ALT.ERR
      5910**DCL      6975>>ASSIGN
B$ALT.ERR.CODE
      5911**DCL      6835>>IF       6882>>IF
B$ALT.ERR.ERR#
      5911**DCL      5911--REDEF
B$ALT.EVID
      5910**DCL      5910--REDEF    5910--REDEF
B$CGAURD
      5897**DCL      6868--ASSIGN   6869--ASSIGN   6871--ASSIGN
B$CGAURD.STATION
      5901**DCL      5901--REDEF
B$TCB.ALT$
      5905**DCL      6835>>IF       6882>>IF       6975>>ASSIGN
B$TCB$
      5723**DCL      6835>>IF       6882>>IF       6975>>ASSIGN
BUF
      6243**DCL      6747--ASSIGN
BYTES_THIS_READ
      6230**DCL      6871<<ASSIGN   6873>>ASSIGN   6942<<ASSIGN   6943>>ASSIGN
CGMA$
      6240**DCL      5870--IMP-PTR  6868<<ASSIGN   6895>>IF       6909>>ASSIGN   6914>>ASSIGN   6916>>ASSIGN
      6918>>ASSIGN   6920>>ASSIGN   6924>>ASSIGN   6926>>ASSIGN   6928>>CALL     6928>>CALL     6935<<ASSIGN
      6935>>ASSIGN   6939<<ASSIGN
CHAR$STRING
      5988**DCL      6930--ASSIGN
CHAR_STRING_SIZE
      6229**DCL      5988--IMP-SIZ  6928<>CALL     6930>>ASSIGN
CODE_CHKSUMTITLE
      6451**DCL      6899>>ASSIGN   6946>>ASSIGN
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:61   
CODE_CHKTITLE
      6444**DCL      6853>>ASSIGN
CODE_NHTF
      6437**DCL      6824>>ASSIGN
CODE_NRF
      6423**DCL      6827>>ASSIGN
CODE_NTF
      6430**DCL      6811>>ASSIGN
DATA_VECTRS
      6245**DCL      6748--ASSIGN   6914<<ASSIGN   6916<<ASSIGN   6918<<ASSIGN   6921<<ASSIGN   6922<<ASSIGN
      6924<<ASSIGN   6926<<ASSIGN   6930<<ASSIGN
FORMAT1
      6014**DCL      6104--DCLINIT  6106--DCLINIT
FPT_FWCG
      6519**DCL      6830<>CALL
FPT_FWCG.V
      6522**DCL      6519--DCLINIT
FPT_FWCG.V.INFORM#
      6523**DCL      6755<<ASSIGN
FPT_FWCG.V.QSELECT#
      6524**DCL      6810<<ASSIGN   6819<<ASSIGN
FPT_READ
      6545**DCL      6877<>CALL
FPT_READ.BUF_.BOUND
      6547**DCL      6873<<ASSIGN   6943<<ASSIGN
FPT_READ.BUF_.BUF$
      6548**DCL      6872<<ASSIGN
FPT_READ.STATION_
      6548**DCL      6549--REDEF
FPT_READ.V
      6549**DCL      6545--DCLINIT
FPT_READ.V.DVBYTE.CONT#
      6562**DCL      6874<<ASSIGN   6940<<ASSIGN
FPT_READ.V.DVBYTE.REREAD#
      6560**DCL      6560--REDEF
FPT_READ.V.INDX#
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:62   
      6558**DCL      6558--REDEF
FPT_UNLATCH
      6604**DCL      6958<>CALL
FPT_UNLATCH.V
      6604**DCL      6604--DCLINIT
FWCG_ERR
      6835**LABEL    6830--CALLALT
F_FDS
      6099**DCL      6932<>CALL
F_FDS.BUF_
      6116**DCL      6747<<ASSIGN
F_FDS.VECTR$
      6129**DCL      6748<<ASSIGN
HELD_FLAG
      6224**DCL      6754<<ASSIGN   6775<<ASSIGN   6820>>IF       6967<<ASSIGN
I
      6231**DCL      6769<<DOINDEX  6770>>ASSIGN   6774>>ASSIGN   6776>>IF       6780<<ASSIGN   6780>>ASSIGN
      6784>>ASSIGN   6790>>ASSIGN   6893<<DOINDEX
II
      6232**DCL      6792<<CALLBLT  6793>>IF
LAST_MSGTYP#
      6247**DCL      6745<<ASSIGN   6895>>IF       6898>>IF       6902>>ASSIGN   6909<<ASSIGN   6949>>ASSIGN
      6955<<ASSIGN
LAST_MSG_CNT
      6248**DCL      6746<<ASSIGN   6896<<ASSIGN   6896>>ASSIGN   6904<>CALL     6910<<ASSIGN   6945>>IF
      6951<>CALL     6956<<ASSIGN
M$FWCG
        99**DCL-ENT  6830--CALL
M$READ
        79**DCL-ENT  6877--CALL
M$UNLATCH
        98**DCL-ENT  6958--CALL
MAX_READ_SIZE
      6234**DCL      6860<<ASSIGN   6864<<ASSIGN   6869>>ASSIGN   6941>>ASSIGN
MON_ERR
      6975**LABEL    6837--GOTO     6884--GOTO     6958--CALLALT
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:63   
MORE_CHK
      6961**LABEL    6849--GOTO
MSGBLK
      6308**DCL      6842<>CALL     6845<>CALL     6854<>CALL     6855<>CALL     6900<>CALL     6907<>CALL
      6947<>CALL     6954<>CALL
MSGBLK.ERRINFO.FIELD1
      6390**DCL      6843<<ASSIGN   6906<<ASSIGN   6953<<ASSIGN
MSGBLK.ERRINFO.FIELD2
      6392**DCL      6903<<ASSIGN   6950<<ASSIGN
NSUBLKS
      6233**DCL      6767<<ASSIGN   6769>>DOINDEX  6776>>IF
NUM_LEFT
      6227**DCL      6867<<ASSIGN   6876>>DOWHILE  6888>>IF       6890>>ASSIGN   6936<<ASSIGN   6936>>ASSIGN
NUM_THIS_READ
      6228**DCL      6869<<ASSIGN   6871>>ASSIGN   6888>>IF       6890<<ASSIGN   6893>>DOINDEX  6941<<ASSIGN
      6942>>ASSIGN
OPT$
      6236**DCL      6757<<ASSIGN   6774<<ASSIGN   6784<<ASSIGN   6805>>IF       6805>>IF       6961>>IF
      6964>>IF
OUT$BLK.CODE
      5789**DCL      6771>>DOCASE   6776>>IF       6805>>IF
OUT$BLK.NSUBLKS
      5793**DCL      6760>>IF       6767>>ASSIGN
OUT$BLK.SUBLK$
      5814**DCL      6770>>ASSIGN   6774>>ASSIGN   6776>>IF       6784>>ASSIGN   6790>>ASSIGN   6791>>ASSIGN
OUT$SYM.COUNT
      5850**DCL      5853--IMP-SIZ  6792>>CALLBLT
OUT$SYM.TEXT
      5853**DCL      6792>>CALLBLT
PRIO
      6249**DCL      6250--REDEF    6920<<ASSIGN
PRIO_ELEMENTS.MSG
      6251**DCL      6921--ASSIGN
PRIO_ELEMENTS.STATION
      6252**DCL      6922--ASSIGN
QQC$BLDMSG
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:64   
      5618**DCL-ENT  6845--CALL     6855--CALL     6907--CALL     6954--CALL
QQC$BLDMSG_BLK
      5617**DCL-ENT  6842--CALL     6854--CALL     6900--CALL     6947--CALL
QQC$CONVERT_NUM
      5622**DCL-ENT  6841--CALL     6904--CALL     6951--CALL
QQC$CONVERT_XID
      5623**DCL-ENT  6928--CALL
QQC$EX_SPEC
      5619**DCL-ENT  6803--CALL
QQC$PRINT_FMT
      5620**DCL-ENT  6153--DCLINIT
QQC$SCREECH
      5624**DCL-ENT  6976--CALL
QQ_CMDBLK.MINOR_ERR
      1711**DCL      6811<<ASSIGN   6824<<ASSIGN   6827<<ASSIGN   6853<<ASSIGN   6899<<ASSIGN   6946<<ASSIGN
QQ_CMDBLK.OUT$
      1711**DCL      6760>>IF       6767>>ASSIGN   6770>>ASSIGN   6774>>ASSIGN   6776>>IF       6784>>ASSIGN
      6790>>ASSIGN
QQ_CMDBLK.S$
      1711**DCL      6763>>ASSIGN
QQ_GLOBAL.CGSIZEMAX
      1715**DCL      6858>>IF       6860>>ASSIGN
QQ_GLOBAL.DS1$_BITS
      1722**DCL      1722--REDEF
QQ_GLOBAL.DS2$_BITS
      1722**DCL      1723--REDEF
QQ_GLOBAL.DS3$_BITS
      1723**DCL      1723--REDEF
QQ_GLOBAL.DS4$_BITS
      1723**DCL      1724--REDEF
QQ_GLOBAL.ERR
      1712**DCL      6975<<ASSIGN
QQ_GLOBAL.TRASHBUF$
      1720**DCL      6868>>ASSIGN   6872>>ASSIGN   6939>>ASSIGN
QQ_GLOBAL.TRASHBUF_SIZE
      1720**DCL      6858>>IF       6864>>ASSIGN
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:65   
READ_ERR
      6882**LABEL    6877--CALLALT
REPORT_CHK
      6815**LABEL    6962--GOTO     6968--GOTO
RET
      6972**LABEL    6803--CALLALT
S$
      5927**DCL      5929--IMP-PTR
SIZE
      6226**DCL      6841<>CALL     6844>>ASSIGN   6904<>CALL     6905>>ASSIGN   6951<>CALL     6952>>ASSIGN
SPECIFIER$
      6239**DCL      6758<<ASSIGN   6790<<ASSIGN   6791>>ASSIGN   6796<<ASSIGN   6802>>IF       6803<>CALL
SUBLK$
      6238**DCL      6770<<ASSIGN   6771>>DOCASE
SUM$
      6237**DCL      6791<<ASSIGN   6792>>CALLBLT  6792>>CALLBLT
SUMMARY_FLAG
      6223**DCL      6753<<ASSIGN   6787<<ASSIGN   6795<<ASSIGN   6852>>IF       6894>>IF       6945>>IF
TEXTC_NAME
      6305**DCL      6903--ASSIGN   6950--ASSIGN
TEXTC_NAME.L#
      6305**DCL      6901<<ASSIGN   6948<<ASSIGN
TEXTC_NAME.NAME#
      6305**DCL      6902<<ASSIGN   6949<<ASSIGN
TEXTC_NUM
      6278**DCL      6843--ASSIGN   6906--ASSIGN   6953--ASSIGN
TEXTC_NUM.L#
      6278**DCL      6844<<ASSIGN   6905<<ASSIGN   6952<<ASSIGN
TEXTC_NUM.NAME#
      6278**DCL      6841--CALL     6904--CALL     6951--CALL
TEXT_XID
      6242**DCL      6928--CALL     6930--ASSIGN
TP$STATION.ID
      5930**DCL      6763>>ASSIGN
TRANS_CHK
      6808**LABEL    6764--GOTO
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:66   
VLP$CGMA
      5870**DCL      6869--ASSIGN   6871--ASSIGN   6935--ASSIGN   6941--ASSIGN   6942--ASSIGN
VLP$CGMA.DEST#
      5878**DCL      6918--ASSIGN
VLP$CGMA.MSGID#
      5878**DCL      6928<>CALL
VLP$CGMA.MSGIDBXT
      5882**DCL      6928<>CALL
VLP$CGMA.MSGIDXT
      5879**DCL      5882--REDEF
VLP$CGMA.MSGSIZE#
      5882**DCL      6926--ASSIGN
VLP$CGMA.MSGTYP#
      5875**DCL      6895>>IF       6909>>ASSIGN   6914--ASSIGN
VLP$CGMA.ORIGIN#
      5875**DCL      6916--ASSIGN
VLP$CGMA.PRIO#
      5874**DCL      6920>>ASSIGN
VLP$CGMA.UTS#
      5876**DCL      6924--ASSIGN
VLP_CGMA
      6622**DCL      6519--DCLINIT  6750<<ASSIGN   6803<>CALL
VLP_CGMA.DEST#
      6630**DCL      6818<<ASSIGN   6823<<ASSIGN
VLP_CGMA.MSGIDXT
      6631**DCL      6634--REDEF
VLP_CGMA.ORIGIN#
      6627**DCL      6763<<ASSIGN   6818>>ASSIGN   6822<<ASSIGN   6823>>ASSIGN   6964>>IF
VLP_CGMA_C
      6028**DCL      6750>>ASSIGN
VLP_CGMA_C.MSGIDXT
      6037**DCL      6040--REDEF
VLP_SCGMA
      6648**DCL      6520--DCLINIT  6751<<ASSIGN   6803<>CALL
VLP_SCGMA.DEST#
      6648**DCL      6816<<ASSIGN   6961>>IF
PL6.E3A0      #001=QQB$CHECK File=QQB$CHECK.:E05TSI                              WED 07/30/97 05:28 Page:67   
VLP_SCGMA.ORIGIN#
      6648**DCL      6809<<ASSIGN   6817<<ASSIGN
VLP_SCGMA_C
      6054**DCL      6751>>ASSIGN
VLP_STATION
      6666**DCL      6548--DCLINIT
VLP_STATION.MSGIDXT
      6676**DCL      6679--REDEF
VLR_FWCG
      6717**DCL      6521--DCLINIT
VLR_FWCG.FOUND#
      6717**DCL      6841<>CALL     6847>>IF       6867>>ASSIGN
X$FORMAT
      5621**DCL-ENT  6932--CALL
