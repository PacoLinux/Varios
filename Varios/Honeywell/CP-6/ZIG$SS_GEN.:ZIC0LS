
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:1    
        1        1        /*M*     ZIG$SS_GEN          DBACS     I_D-S/II */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$SS_GEN
        9        9        PURPOSE: To generate the following subschemas DDL
       10       10                 COBOL:
       11       11                      The subschema DDL is about the same as GCOS DDl (module
       12       12                    SSJEN) except for the COMP-11 and COMP-12 for floating
       13       13                    point schema data types (UWA.FR.FTYPE = 12 or 13).
       14       14                 FORTRAN:
       15       15                      The subschema DDL is new to CP6 and creates the DDL
       16       16                    for the new DBACS subschema translator ( ZIG$SS_PDRI )
       17       17                    and the subschema DDL should be compatable with GCOS
       18       18                    subschema FORTRAN DDL.
       19       19                 APL:
       20       20                      The subschema DDL is also new to CP6 and creates the
       21       21                    APL subschema DDL for the new DBACS subschema translator.
       22       22                 BASIC:
       23       23                      The BASIC DDL is essencially the same as the APL DDL.
       24       24
       25       25
       26       26                 Data conversions from schema to subschema.
       27       27
       28       28                  SCHEMA         APL            FORTRAN          BASIC
       29       29                ----------  ------------   -----------------  ------------
       30       30              CHARACTER     CHARACTER      CHARACTER          CHARACTER
       31       31              CHAR VARYING  CHARACTER      CHARACTER          CHARACTER
       32       32              FIXED 17      INTEGER        INTEGER            DOUBLE PRECISION
       33       33              FIXED 35      INTEGER        INTEGER            DOUBLE PRECISION
       34       34              FLOAT 35      FLOAT DWORD    REAL               DOUBLE PRECISION
       35       35              FLOAT 71      FLOAT DWORD    DOUBLE PRECISION   DOUBLE PRECISION
       36       36              DECIMAL  _,_  FLOAT DWORD    DOUBLE PRECISION   DOUBLE PRECISION
       37       37              UNSPECIFIED   CHARACTER      CHARACTER          CHARACTER
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:2    
       38       38
       39       39
       40       40            ARRAYS WILL BE GENERATED WHEN THE OCCURS CLAUSE IS PUT
       41       41          IN THE SCHEMA DDL.
       42       42
       43       43
       44       44
       45       45        */
       46       46        /*D*     NAME: ZIG$SS_GEN
       47       47        DESCRIPTION:
       48       48              This modual reads the schema file throw IDS and creates a
       49       49            subschema DDL for one of four languages ( COBOL, APL, BASIC,or
       50       50            FORTRAN ).
       51       51              It works in to passes:
       52       52            Pass1 builds all the aliases into the hashtables created by
       53       53            ZIG$HASH_IT and puts out all text for the areas, sets , keys,
       54       54            records, and items to a temporay file called '5*'.
       55       55            Pass2 builds the aliases and writes out the subschema DDL text
       56       56            to both M$LO and M$SO. Some of the subschema DDL is read from
       57       57            the '5*' file.
       58       58        */
       59       59        /*D*     NAME:     SUB_LANGUAGE
       60       60                 THIS VARIABLE TELLS WHAT LANGUAGE TO GENERATE THE SUBSCHEMA
       61       61               DDL FOR:
       62       62                 1    _    COBOL
       63       63                 2    _    FORTRAN
       64       64                 3    _    APL
       65       65                 4    _    BASIC
       66       66        */
       67       67        ZIG$SS_GEN:
       68       68            PROC;
       69       69        %INCLUDE ZI_SUB_LANG;
       70     1784        %INCLUDE ZI_SUB4_CAN;
       71     2441        %UWA;
       72     2776        %INCLUDE ZIG_FIVESTAR_DESC;
       73     2819        %INCLUDE ZIG_DIR_STRUCS;
       74     2949        %INCLUDE ZIG_DBA_INT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:3    
       75     2997        %INCLUDE ZIG_GENERAL;
       76     3105        %GENERAL;
       77     3229        %INCLUDE ZI_ERRORS_SUBS;
       78     3749        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:4    
       79     3750    1   DCL LOCKED BIT (1);
       80     3751    1   DCL DONE BIT (1);
       81     3752    1   DCL STEPCC UBIN (36) EXT;
       82     3753    1   DCL PTR$ PTR;
       83     3754    1   DCL ALIAS_PTR$ PTR;
       84     3755    1   DCL BUFFER_SIZE UBIN (36);
       85     3756    1   DCL BUFFER_INPUT CHAR (25) BASED (DESCPTR);
       86     3757    1   DCL ALIASS (0:0) CHAR (25) BASED (ALIAS_PTR$);
       87     3758    1   DCL NU_ALIAS UBIN (36);
       88     3759    1   DCL NEW_ALIAS_PTR$ PTR;
       89     3760    1   DCL ERROR_ALIAS UBIN (36);
       90     3761    1   DCL TYPE_OF_ALIAS UBIN (36);
       91     3762    1   DCL 1 ALIAS_DESC BASED (DESCPTR),
       92     3763    1         2 TYPE UBIN (36),
       93     3764    1         2 S,
       94     3765    1           3 QUAL CHAR (30),
       95     3766    1           3 NAME CHAR (30),
       96     3767    1         2 SS,
       97     3768    1           3 NAME CHAR (30),
       98     3769    1         2 DUMM CHAR (6);
       99     3770    1   DCL 1 H_ALIAS BASED,
      100     3771    1         2 INFO BIT (18) UNAL,
      101     3772    1         2 C_NAME CHAR (30) UNAL,
      102     3773    1         2 NEXT_LINK_PTR$ PTR UNAL,
      103     3774    1         2 SUB$ PTR UNAL,
      104     3775    1         2 QUAL$ PTR UNAL;
      105     3776    1   DCL 1 B BASED ALIGNED,
      106     3777    1         2 BIT36 BIT (1) UNAL,
      107     3778    1         2 * BIT (35) UNAL;
      108     3779    1   DCL TITLE CHAR (80);
      109     3780    1   DCL SUB_TITLE CHAR (80);
      110     3781    1   DCL OUTPUT_REC CHAR (80);
      111     3782    1   DCL I UBIN (36);
      112     3783    1   DCL J UBIN (36);
      113     3784    1   DCL TVBL UBIN(36);
      114     3785    1   DCL 1 DSTRING UNAL,
      115     3786    1         2 COUNT UBIN (9) UNAL,
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:5    
      116     3787    1         2 START CHAR (31) UNAL;
      117     3788    1   DCL EOF UBIN (36);
      118     3789    1   DCL DESCPTR PTR;
      119     3790    1   DCL REAL_NAME CHAR (30);
      120     3791    1   DCL STATUS UBIN (6);
      121     3792    1   DCL SUB_NAME_LENGHT UBIN (36);
      122     3793    1   DCL SCHEMA_NAME_LENGHT UBIN (36);
      123     3794    1   DCL LEN_REAL_NAME UBIN (36);
      124     3795    1   DCL 1 O_REC EXT,
      125     3796    1         2 STATUS (0:35) BIT (1) UNAL,
      126     3797    1         2 W_STATUS REDEF STATUS UBIN (36) ,
      127     3798    1         2 STRING CHAR (180) UNAL;
      128     3799    1   DCL COUNT UBIN (36);
      129     3800    1   DCL INT SBIN (36);
      130     3801    1   DCL DP SBIN (36);
      131     3802    1   DCL VARIABLE_TYPE CHAR (40);
      132     3803    1   DCL NUM_STRING CHAR (10);
      133     3804    1   DCL HOLD_DBKEY UBIN (36);
      134     3805    1   DCL TEMP_SBIN SBIN (36);
      135     3806    1   DCL FIRST_NO_ZERO UBIN (36);
      136     3807    1   DCL ZIG$HASH_IT ENTRY (8);
      137     3808    1   DCL UNSC ENTRY (2);
      138     3809    1   DCL POSITION UBIN (36);
      139     3810    1   DCL NPTR$ PTR;
      140     3811    1   DCL ERROR_STATUS UBIN (36);
      141     3812    1   DCL PTR_C$ PTR;
      142     3813    1   DCL SAVE_RECORD_NAME CHAR (30) EXT;
      143     3814    1   DCL POS UBIN (36);
      144     3815    1   DCL LETTER_STRING CHAR (26) STATIC INIT ('ABCDEFGHIJKLMNOPQRSTUVWXYZ');
      145     3816    1   DCL NUM_LETTER_STRING CHAR (36) STATIC INIT ('0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ')
              3816            ;
      146     3817    1   DCL NUM_VAL UBIN (36);
      147     3818    1   DCL LETTER_VAL UBIN (36);
      148     3819    1   DCL ALIAS_TYPE (0:6) CHAR(11) STATIC INIT(' ','REALM-NAME','SET-NAME',
      149     3820    1    'KEY-NAME','RECORD-NAME','ITEM-NAME','ITEM-NAME');
      150     3821    1   DCL A_TYPE (0:12) CHAR(9) STATIC INIT(' ','AREA','SET',
      151     3822    1    'KEY','RECORD','ITEM','ITEM','(REALM)','(SET)',
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:6    
      152     3823    1    '(KEY)','(RECORD)','(ITEM)','(ITEM)');
      153     3824    1   DCL FIRST_GEN_ALIAS BIT (1);
      154     3825    1   DCL HAS_TABLE (0:808) PTR EXT INIT (ADDR(NIL)*809);
      155     3826    1   DCL STORE_NAME CHAR (30);
      156     3827    1   DCL ITEM_NU UBIN (36) EXT;
      157     3828    1   DCL TEMP_NU UBIN (36);
      158     3829    1   DCL TEMP_STATUS UBIN (6);
      159     3830    1   DCL TEMP_WORD CHAR(30);
      160     3831        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:7    
      161     3832    1   START:
      162     3833    1       IF LANG_ALLOWED(SUB_LANGUAGE) = 0
      163     3834    2       THEN DO;
      164     3835    2           STORE_NAME = LANG_TEXT(SUB_LANGUAGE);
      165     3836    2           CALL SET_FIELDS(1,30,STORE_NAME);
      166     3837    2           CALL ERROR(%ZIG_INTERFACE_NO_$);
      167     3838        /*E*  ERROR:  ZIG-ZIG_INTERFACE_NO_$-C
      168     3839              MESSAGE: The subschema language, %U1, is not allowed.
      169     3840        */
      170     3841    2           RETURN;
      171     3842    2           END;
      172     3843    1       ITEM_NU=3;
      173     3844    1       NUM_VAL = 0;
      174     3845    1       LETTER_VAL = 25;
      175     3846    1       CALL CONCAT(HEADING_TEXT,LANG_TEXT(SUB_LANGUAGE),' SUBSCHEMA GENERATOR');
      176     3847    1       CALL SUBLST (HEADING_TEXT);
      177     3848    1       CALL FETCHD_6('SF  ',2);
      178     3849    1       CALL FETCHD_6('DA  ',UWA.SF.DBKEY_DA);
      179     3850    1       CALL FETCHD_6('OA  ',UWA.SF.DBKEY_OA);
      180     3851    1       CALL FETCHOS_6('SN-SE   ');
      181     3852    1       UWA.A_D.AD_FUNCTION=9;
      182     3853    1       CALL GET_TIME(UWA.A_D.AD_DATE);
      183     3854    1       CALL CONCAT(UWA.A_D.AD_IDENT,LANG_TEXT(SUB_LANGUAGE),SSGEN.SSNAME);
      184     3855    1       CALL STRE_6('A-D ');
      185     3856        /*
      186     3857            STORE A ACTIVITIES RECORD TO SHOW THAT A SUBSCHEMA GENERATION
      187     3858          WAS STARTED AND WHICH LANGUAGE IT WAS FOR.
      188     3859        */
      189     3860    1       LOCKED = '0'B;
      190     3861    1       DONE = '0'B;
      191     3862    2       DO WHILE (~DONE);
      192     3863    2           CALL FETCHNS_6('SN-LT   ') ALTRET(CHECK_LOCK);
      193     3864    2           IF ADDR(UWA.LT.PLOCKS) -> B.BIT36
      194     3865    3           THEN DO;
      195     3866    3               LOCKED = '1'B;
      196     3867    3               CALL FETCHOS_6('LK-LT   ');
      197     3868    3               CALL UNSC(UWA.LK.PLVALUE,STORE_NAME);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:8    
      198     3869    3               IF SSGEN.DISP_KEY = SUBSTR(STORE_NAME,0,12)
      199     3870    3                  OR SUBSTR(UWA.LK.PLVALUE,0,6) = '"NULL"'
      200     3871    4               THEN DO;
      201     3872    4                   LOCKED = '0'B;
      202     3873    4                   DONE = '1'B;
      203     3874    4                   END;
      204     3875    3               END;
      205     3876    2           END;
      206     3877    1   CHECK_LOCK:
      207     3878    1       IF LOCKED
      208     3879    2       THEN DO;
      209     3880    2           CALL ERROR(#BAD_LOCK_DISPLAY);
      210     3881        /*E*     ERROR:    ZIG-#BAD_LOCK_DISPLAY-C
      211     3882        MESSAGE: The schema is locked for DISPLAYs and either
      212     3883                 no privacy key was given or the wrong privacy key
      213     3884                 was given.
      214     3885        */
      215     3886    2           STEPCC = 7; /* BAD PRIVACY LOCK */
      216     3887    2           RETURN;
      217     3888    2           END;
      218     3889        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:9    
      219     3890    1       IF SSGEN.ALIAS_NAMES
      220     3891    2       THEN DO;
      221     3892    2           STATUS=#IN_ALIAS;
      222     3893    2           CALL UOPEN ('5*',0);
      223     3894    2           CALL UGET ('5*',DESCPTR,EOF,BUFFER_SIZE);
      224     3895    2           NU_ALIAS=0;
      225     3896    2           CALL ZIG$G_DYN_MEM_6(0,ALIAS_PTR$);
      226     3897    3           DO WHILE (EOF=0);
      227     3898    3               NU_ALIAS = NU_ALIAS + 1;
      228     3899    3               CALL CHECK_CHAR_SET(ALIAS_DESC.SS.NAME,ERROR_ALIAS,POSITION);
      229     3900    3               IF ERROR_ALIAS>1
      230     3901    4               THEN DO;
      231     3902    4                   CALL SET_FIELDS(1,30,ALIAS_DESC.S.QUAL);
      232     3903    4                   CALL SET_FIELDS(2,30,ALIAS_DESC.SS.NAME);
      233     3904    4                   CALL SET_FIELDS(3,30,
      234     3905    4                      TYPE_NAME(ALIAS_DESC.TYPE-1));
      235     3906    4                   CALL ERROR(#BAD_CHAR_ALIAS);
      236     3907        /*E*     ERROR:    ZIG-#BAD_CHAR_ALIAS-C
      237     3908        MESSAGE: In the alias list of type %U3 there is a bad
      238     3909                 character in the name %U2.
      239     3910                 This alias will not be processed.
      240     3911        */
      241     3912    4                   END;
      242     3913    4               ELSE DO;
      243     3914    4                   TEMP_STATUS = 7;
      244     3915    4                   CALL ZIG$HASH_IT(ALIAS_DESC.SS.NAME,#NO_ADD,
      245     3916    4                      ERROR_ALIAS,0,0,9,NEW_ALIAS_PTR$,
      246     3917    4                      TEMP_STATUS);
      247     3918    4                   IF ERROR_ALIAS > 0 AND ALIAS_DESC.TYPE = 5
      248     3919    5                   THEN DO;
      249     3920    5                       CALL SET_FIELDS(1,30,ALIAS_DESC.S.QUAL);
      250     3921    5                       CALL SET_FIELDS(2,30,ALIAS_DESC.SS.NAME);
      251     3922    5                       CALL ERROR (#DUP_ALIAS);
      252     3923        /*E*     ERROR:    ZIG-#DUP_ALIAS-C
      253     3924        MESSAGE: The fatal error occurred on the processing of the alias list:
      254     3925                 for the type %U3 the name %U1 and %U1 are equivalent.
      255     3926                 The one aliased to %U2 will not be changed.
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:10   
      256     3927        */
      257     3928    5                       END;
      258     3929    5                   ELSE DO;
      259     3930    5                       IF SUB_LANGUAGE = #FORTRAN AND
      260     3931    5                          ERROR_ALIAS >0
      261     3932    6                       THEN DO;
      262     3933    6                           CALL SET_FIELDS(1,30,ALIAS_DESC.S.QUAL);
      263     3934    6                           CALL SET_FIELDS(2,30,ALIAS_DESC.S.NAME);
      264     3935    6                           CALL SET_FIELDS(3,30,ALIAS_DESC.SS.NAME);
      265     3936    6                           CALL ERROR (#DUP_ALIAS_DATA);
      266     3937        /*E*     ERROR:    ZIG-#DUP_ALIAS_DATA-C
      267     3938        MESSAGE: The fatal error occurred on the processing of the alias data
      268     3939                 names; for the record "%U1" and the field "%U2" there are
      269     3940                 duplicate aliases. The one aliased to %U3 will be
      270     3941                 deleted!
      271     3942        */
      272     3943    6                           END;
      273     3944    6                       ELSE DO;
      274     3945    6                           CALL CHECK_CHAR_SET(ALIAS_DESC.S.NAME,
      275     3946    6                              ERROR_ALIAS,POSITION);
      276     3947    6                           IF ALIAS_DESC.TYPE = 5 AND ALIAS_DESC.S.QUAL = ' '
      277     3948    6                           THEN TYPE_OF_ALIAS = 6;
      278     3949    6                           ELSE TYPE_OF_ALIAS = ALIAS_DESC.TYPE;
      279     3950    6                           HASH_SCHEMA_NAME = '1'B;
      280     3951    6                           CALL ZIG$HASH_IT(ALIAS_DESC.S.NAME,#ADD,
      281     3952    6                              ERROR_ALIAS,TYPE_OF_ALIAS,2,11,NPTR$,
      282     3953    6                              STATUS);
      283     3954    6                           NPTR$ -> H_ALIAS.SUB$ = NEW_ALIAS_PTR$;
      284     3955    6                           IF TYPE_OF_ALIAS = 5
      285     3956    7                           THEN DO;
      286     3957    7                               HASH_SCHEMA_NAME = '1'B;
      287     3958    7                               CALL ZIG$HASH_IT(ALIAS_DESC.S.QUAL,#NO_ADD,
      288     3959    7                                  ERROR_ALIAS,7,2,9,NPTR$ ->
      289     3960    7                                  H_ALIAS.QUAL$,TEMP_STATUS);
      290     3961    7                               END;
      291     3962    6                           ELSE NPTR$ -> H_ALIAS.QUAL$ = ADDR(NIL);
      292     3963    6                           END;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:11   
      293     3964    5                       END;
      294     3965    4                   END;
      295     3966    3               CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);
      296     3967    3               END;
      297     3968    2           CALL UCLOSE('5*');
      298     3969    2           END;
      299     3970    1       CALL UOPEN('5*',1);
      300     3971        /*
      301     3972            Now start the generation of the structure division.
      302     3973            The part that has the areas name, set names, record and item
      303     3974            names.
      304     3975
      305     3976            These are generated first so and conficts can be resolved by
      306     3977            alias generated by the generate process.
      307     3978
      308     3979            Things are first written to the 5* file then the alias are
      309     3980            generated for the whole subschema. Then everying is written
      310     3981            through M$LO and M$SO.
      311     3982        */
      312     3983    1       CALL FETCHD_6('SN  ',UWA.DA.FRST_AC);
      313     3984    1       STATUS = #IN_AREA_PROCESSING;
      314     3985    1       TITLE = '       STRUCTURE DIVISION.';
      315     3986    1       IF SUB_LANGUAGE=#COBOL
      316     3987    2       THEN DO;
      317     3988    2           TITLE='       STRUCTURE DIVISION.';
      318     3989    2           CALL STORE(TITLE);
      319     3990    2           END;
      320     3991    1       IF UWA.SN.SETYPE = 20 /*AREA TYPE */
      321     3992    2       THEN DO;
      322     3993    2           IF SUB_LANGUAGE=#COBOL
      323     3994    3           THEN DO;
      324     3995    3               SUB_TITLE='       REALM SECTION.';
      325     3996    3               CALL STORE(SUB_TITLE);
      326     3997    3               END;
      327     3998    3           ELSE DO;
      328     3999    3               SUB_TITLE='      REALM =';
      329     4000    3               CALL STORE(SUB_TITLE);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:12   
      330     4001    3               END;
      331     4002    3           DO WHILE (UWA.SN.SETYPE=20 AND UWA.DB_STATUS = '0000000');/* AREA TYPES */
      332     4003    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*'
      333     4004    4               THEN DO;
      334     4005    4                   CALL CHECK_ALIAS(UWA.SN.SENAME);
      335     4006    4                   IF SUB_LANGUAGE=#COBOL
      336     4007    5                   THEN DO;
      337     4008    5                       CALL CONCAT(OUTPUT_REC,'         RD ',SUBSTR(
      338     4009    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      339     4010    5                       END;
      340     4011    5                   ELSE DO;
      341     4012    5                       CALL CONCAT(OUTPUT_REC,'             ',SUBSTR(
      342     4013    5                          REAL_NAME,0,LEN_REAL_NAME),',');
      343     4014    5                       END;
      344     4015    4                   CALL FETCHNS_6('DA-SN   ') ALTRET (END_OF_AREA);
      345     4016    4   END_OF_AREA:
      346     4017    4                   IF UWA.DB_STATUS = '0502100' | UWA.SN.SETYPE ~= 20
      347     4018    5                   THEN DO;
      348     4019    5                       CALL INDEX1R(I,',',OUTPUT_REC);
      349     4020    5                       CALL INSERT(OUTPUT_REC,I,1,'.');
      350     4021    5                       END;
      351     4022    4                   IF SUB_LANGUAGE = #FORTRAN
      352     4023    5                   THEN DO;
      353     4024    5                       CALL INSERT(OUTPUT_REC,5,1,'*');
      354     4025    5                       END;
      355     4026    4                   CALL STORE(OUTPUT_REC);
      356     4027    4                   END;
      357     4028    3               ELSE CALL FETCHNS_6('DA-SN   ') ALTRET(CONT_AREAS);
      358     4029    3   CONT_AREAS:
      359     4030    3               END;
      360     4031    2           END;
      361     4032        /*
      362     4033            NOW PROCESS ALL THE SET NAMES IN THE SCHEMA.
      363     4034        */
      364     4035    1       CALL FETCHD_6('SN  ',UWA.DA.FRST_SC);
      365     4036    1       STATUS = #IN_SET_PROCESSING;
      366     4037    2       DO WHILE (UWA.SN.SETYPE = 30 AND SUBSTR(UWA.SN.SENAME,0,1) = '*');
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:13   
      367     4038    2           CALL FETCHNS_6('DA-SN   ') ALTRET(NO_SETS);
      368     4039    2           END;
      369     4040    1       IF UWA.SN.SETYPE = 30
      370     4041    2       THEN DO;
      371     4042    2           IF SUB_LANGUAGE=#COBOL
      372     4043    3           THEN DO;
      373     4044    3               SUB_TITLE='       SET SECTION.';
      374     4045    3               CALL STORE(SUB_TITLE);
      375     4046    3               END;
      376     4047    3           ELSE DO;
      377     4048    3               SUB_TITLE='      SET =';
      378     4049    3               CALL STORE(SUB_TITLE);
      379     4050    3               END;
      380     4051    3           DO WHILE (UWA.SN.SETYPE=30 AND UWA.DB_STATUS = '0000000');/* SETS TYPES */
      381     4052    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*'
      382     4053    4               THEN DO;
      383     4054    4                   CALL CHECK_ALIAS(UWA.SN.SENAME);
      384     4055    4                   IF SUB_LANGUAGE=#COBOL
      385     4056    5                   THEN DO;
      386     4057    5                       CALL CONCAT(OUTPUT_REC,'         SD ',SUBSTR(
      387     4058    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      388     4059    5                       END;
      389     4060    5                   ELSE DO;
      390     4061    5                       CALL CONCAT(OUTPUT_REC,'            ',SUBSTR(
      391     4062    5                          REAL_NAME,0,LEN_REAL_NAME),',');
      392     4063    5                       END;
      393     4064    4                   CALL FETCHNS_6('DA-SN   ') ALTRET (END_OF_SETS);
      394     4065    4   END_OF_SETS:
      395     4066    4                   IF UWA.DB_STATUS = '0502100' | UWA.SN.SETYPE ~= 30
      396     4067    5                   THEN DO;
      397     4068    5                       CALL INDEX1R(I,',',OUTPUT_REC);
      398     4069    5                       CALL INSERT(OUTPUT_REC,I,1,'.');
      399     4070    5                       END;
      400     4071    4                   IF SUB_LANGUAGE = #FORTRAN
      401     4072    5                   THEN DO;
      402     4073    5                       CALL INSERT(OUTPUT_REC,5,1,'*');
      403     4074    5                       END;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:14   
      404     4075    4                   CALL STORE(OUTPUT_REC);
      405     4076    4                   END;
      406     4077    3               ELSE CALL FETCHNS_6('DA-SN   ') ALTRET(CONT_SETS);
      407     4078    3   CONT_SETS:
      408     4079    3               END;
      409     4080    2           END;
      410     4081        /*
      411     4082            NOW GENERATE ALL THE KEYS THAT GO IN THE KEY SECTION.
      412     4083        */
      413     4084    1   NO_SETS:
      414     4085    1       STATUS = #IN_KEY_PROCESSING;
      415     4086    1       CALL FETCHD_6('SN  ',UWA.DA.FRST_KC);
      416     4087    1       IF UWA.SN.SETYPE = 31
      417     4088    2       THEN DO;
      418     4089    2           IF SUB_LANGUAGE=#COBOL
      419     4090    3           THEN DO;
      420     4091    3               SUB_TITLE='       KEY SECTION.';
      421     4092    3               CALL STORE(SUB_TITLE);
      422     4093    3               END;
      423     4094    3           ELSE DO;
      424     4095    3               SUB_TITLE='      KEY =';
      425     4096    3               CALL STORE(SUB_TITLE);
      426     4097    3               END;
      427     4098    3           DO WHILE (UWA.SN.SETYPE=31 AND UWA.DB_STATUS = '0000000');/* KEYS TYPES */
      428     4099    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*'
      429     4100    4               THEN DO;
      430     4101    4                   CALL CHECK_ALIAS(UWA.SN.SENAME);
      431     4102    4                   IF SUB_LANGUAGE=#COBOL
      432     4103    5                   THEN DO;
      433     4104    5                       CALL CONCAT(OUTPUT_REC,'         KD ',SUBSTR(
      434     4105    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      435     4106    5                       END;
      436     4107    5                   ELSE DO;
      437     4108    5                       CALL CONCAT(OUTPUT_REC,'             ',SUBSTR(
      438     4109    5                          REAL_NAME,0,LEN_REAL_NAME),',');
      439     4110    5                       END;
      440     4111    4                   CALL FETCHNS_6('DA-SN   ') ALTRET (END_OF_KEYS);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:15   
      441     4112    4   END_OF_KEYS:
      442     4113    4                   IF UWA.DB_STATUS = '0502100' | UWA.SN.SETYPE ~= 31
      443     4114    5                   THEN DO;
      444     4115    5                       CALL INDEX1R(I,',',OUTPUT_REC);
      445     4116    5                       CALL INSERT(OUTPUT_REC,I,1,'.');
      446     4117    5                       END;
      447     4118    4                   IF SUB_LANGUAGE = #FORTRAN
      448     4119    5                   THEN DO;
      449     4120    5                       CALL INSERT(OUTPUT_REC,5,1,'*');
      450     4121    5                       END;
      451     4122    4                   CALL STORE(OUTPUT_REC);
      452     4123    4                   END;
      453     4124    3               ELSE CALL FETCHNS_6('DA-SN   ') ALTRET(CONT_KEYS);
      454     4125    3   CONT_KEYS:
      455     4126    3               END;
      456     4127    2           END;
      457     4128        /*
      458     4129            NOW GENERATE ALL THE RECORDS AND THE ITEMS UNDER EACH ONE.
      459     4130        */
      460     4131    1       CALL FETCHD_6('SN  ',UWA.DA.FRST_RC);
      461     4132    1       IF UWA.SN.SETYPE = 40
      462     4133    2       THEN DO;
      463     4134    2           IF SUB_LANGUAGE=#COBOL
      464     4135    3           THEN DO;
      465     4136    3               SUB_TITLE='       RECORD SECTION.';
      466     4137    3               CALL STORE(SUB_TITLE);
      467     4138    3               END;
      468     4139    3           DO WHILE (UWA.SN.SETYPE=40) ;/* RECORDS TYPES */
      469     4140    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*'
      470     4141    4               THEN DO;
      471     4142    4                   STATUS = #IN_RECORD_PROCESSING;
      472     4143    4                   ITEM_NU=ITEM_NU + 1;
      473     4144    4                   CALL CHECK_ALIAS(UWA.SN.SENAME);
      474     4145    4                   SAVE_RECORD_NAME=UWA.SN.SENAME;
      475     4146    4                   IF SUB_LANGUAGE=#COBOL
      476     4147    5                   THEN DO;
      477     4148    5                       CALL CONCAT(OUTPUT_REC,'         01 ',SUBSTR(
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:16   
      478     4149    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      479     4150    5                       END;
      480     4151    5                   ELSE DO;
      481     4152    5                       CALL CONCAT(OUTPUT_REC,'      RECORD 01 ',SUBSTR(
      482     4153    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      483     4154    5                       END;
      484     4155    4                   CALL STORE(OUTPUT_REC);
      485     4156    4                   HOLD_DBKEY = UWA.DIRECT_REF;
      486     4157    4                   CALL FETCHNS_6('SN-SE   ') ALTRET (END_OF_RECORDS);
      487     4158    4                   IF SUB_LANGUAGE = #COBOL
      488     4159    4                   THEN CALL GET_COBOL_ITEMS;
      489     4160    4                   ELSE IF SUB_LANGUAGE = #FORTRAN
      490     4161    4                       THEN CALL GET_FORTRAN_ITEMS;
      491     4162    4                       ELSE IF SUB_LANGUAGE = #APL
      492     4163    4                           THEN CALL GET_APL_ITEMS;
      493     4164    4                           ELSE IF SUB_LANGUAGE = #BASIC
      494     4165    4                               THEN CALL GET_BASIC_ITEMS;
      495     4166    4                   CALL FETCHD_6('SN  ',HOLD_DBKEY);
      496     4167    4                   CALL FETCHNS_6('DA-SN   ') ALTRET (END_OF_RECORDS);
      497     4168    4                   END;
      498     4169    3               ELSE CALL FETCHNS_6('DA-SN   ') ALTRET(END_OF_RECORDS);
      499     4170    3               END;
      500     4171    2   END_OF_RECORDS:
      501     4172    2           END;
      502     4173    1       CALL UCLOSE ('5*');
      503     4174        /*
      504     4175            Every thing has been generated so now go throw things and
      505     4176          find what alias need to be generated.
      506     4177
      507     4178            write out all the aliases then start reading in the 5*
      508     4179          file and write things out to M$SO and M$LO.
      509     4180        */
      510     4181    1       CALL FIND_LENGTH(SSGEN.SNAME,SCHEMA_NAME_LENGHT);
      511     4182    1       CALL FIND_LENGTH(SSGEN.SSNAME,SUB_NAME_LENGHT);
      512     4183    1       CALL CHECK_CHAR_SET(SSGEN.SSNAME,ERROR_ALIAS,I);
      513     4184    1       O_REC.W_STATUS=0;
      514     4185    1       CALL CONCAT(O_REC.STRING,'DBACS TRANSLATE ',LANG_TEXT(SUB_LANGUAGE),
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:17   
      515     4186    1          ' SUBSCHEMA ',SUBSTR(SSGEN.SSNAME,0,SUB_NAME_LENGHT),' DDL END');
      516     4187    1       CALL WRITER(O_REC.W_STATUS);
      517     4188    1       IF ERROR_ALIAS ~= 0
      518     4189    2       THEN DO;
      519     4190    2           CALL SET_FIELDS(1,30,SSGEN.SSNAME);
      520     4191    2           CALL ERROR(%ZIG_BAD_CHAR_IN_SSNAME);
      521     4192        /*E*     ERROR:    ZIG-ZIG_BAD_CHAR_IN_SSNAME-C
      522     4193        MESSAGE: There is an illegal character in the subschema name
      523     4194                 %U1.
      524     4195        */
      525     4196    2           END;
      526     4197    1       IF SUB_LANGUAGE = #COBOL
      527     4198    2       THEN DO;
      528     4199    2           O_REC.STRING='       TITLE DIVISION.';
      529     4200    2           CALL WRITER(O_REC.W_STATUS);
      530     4201    2           CALL CHECK_CHAR_SET(SSGEN.SNAME,ERROR_ALIAS,POSITION);
      531     4202    2           CALL CONCAT(O_REC.STRING,'         SS ',SUBSTR(SSGEN.SSNAME,0,
              4202                    SUB_NAME_LENGHT),
      532     4203    2              ' WITHIN ',SUBSTR(SSGEN.SNAME,0,SCHEMA_NAME_LENGHT),'.');
      533     4204    2           CALL WRITER(O_REC.W_STATUS);
      534     4205    2           O_REC.STRING='       MAPPING DIVISION.';
      535     4206    2           CALL WRITER(O_REC.W_STATUS);
      536     4207    2           END;
      537     4208    2       ELSE DO;
      538     4209    2           CALL CONCAT(O_REC.STRING,'       SUBSCHEMA ',SUBSTR(SSGEN.SSNAME,0,
              4209                    SUB_NAME_LENGHT),
      539     4210    2              ' , SCHEMA = ',SUBSTR(SSGEN.SNAME,0,SCHEMA_NAME_LENGHT),'.');
      540     4211    2           CALL WRITER(O_REC.W_STATUS);
      541     4212    2           END;
      542     4213    1       CALL GEN_ALIASES;
      543     4214    1       CALL UOPEN('5*',0);
      544     4215    1       CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);
      545     4216    2       DO WHILE (EOF=0);
      546     4217    2           CALL WRITER(BUFFER_INPUT);
      547     4218    2           CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);
      548     4219    2           END;
      549     4220    1       CALL UCLOSE('5*');
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:18   
      550     4221    1       O_REC.STRING='       END.';
      551     4222    1       CALL WRITER(O_REC.W_STATUS);
      552     4223    1       RETURN;
      553     4224        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:19   
      554     4225        /*
      555     4226              NOW COMES ALL THE SUBROUTINES THAT THE MAIN PROGRAM USES.
      556     4227
      557     4228            THESES SUBROUTINES ARE:
      558     4229                 WRITER
      559     4230                 STORE
      560     4231                 CHECK_ALIAS
      561     4232                 GEN_ALIASES
      562     4233                 FIND_LENGTH
      563     4234                 GET_COBOL_ITEMS
      564     4235                 GET_FORTRAN_ITEMS
      565     4236                 GET_APL_ITEMS
      566     4237                 GET_BASIC_ITEMS
      567     4238                 FLAG_LINE
      568     4239                 ERROR_EVAL
      569     4240
      570     4241        */
      571     4242    1   WRITER:
      572     4243    1       PROC (O_REC);
      573     4244    2   DCL LIST_STRING CHAR (128) ;
      574     4245    2   DCL RECORD_POINTER PTR EXT;
      575     4246    2   DCL 1 O_REC,
      576     4247    2         2 STATUS (0:35) BIT (1) UNAL,
      577     4248    2         2 W_STATUS REDEF STATUS UBIN (36) ,
      578     4249    2         2 STRING CHAR (80) UNAL;
      579     4250    2       RECORD_POINTER=ADDR(O_REC.STRING);
      580     4251    2       CALL WRITERECORD_TO_SEQ_FILE;
      581     4252    2       LIST_STRING = O_REC.STRING;
      582     4253    2       CALL LIST(LIST_STRING);
      583     4254    2       IF O_REC.W_STATUS ~= 0
      584     4255    2       THEN CALL ERROR_EVAL(O_REC.W_STATUS);
      585     4256    2       RETURN;
      586     4257    2   END WRITER;
      587     4258        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:20   
      588     4259        /*
      589     4260              NOW STORE WHICH WRITES THINGS OUT TO THE TEMP FILE 5*
      590     4261            SO THE CAN BE READ BACK IN AFTER ALL THE ALIASES HAVE BEEN
      591     4262            GENERATED. SO THINGS CAN BE WRITTEN TO THE USER IN THE CORRECT
      592     4263            ORDER.
      593     4264        */
      594     4265    1   STORE:
      595     4266    1       PROC (STRING_TO_STORE);
      596     4267    2   DCL STRING_TO_STORE CHAR (80);
      597     4268    2       O_REC.STRING=STRING_TO_STORE;
      598     4269    2       CALL UPUT('5*',ADDR(O_REC.STATUS),25);
      599     4270    2       O_REC.W_STATUS = 0;
      600     4271    2       RETURN;
      601     4272    2   END STORE;
      602     4273        /*
      603     4274              NOW COMES THE PROCEDURE THAT DETERMINES THE LENGHT OF
      604     4275            A CHARACTER STRING THAT IS FIXED LENGHT SO WE DON'T HAVE
      605     4276            A MILLION BLANKS AFTER EVERY NAME.
      606     4277        */
      607     4278        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:21   
      608     4279    1   FIND_LENGTH:
      609     4280    1       PROC(STRING_TO_GET,RETURN_LENGTH);
      610     4281    2   DCL RETURN_LENGTH UBIN (36);
      611     4282    2   DCL STRING_TO_GET CHAR (30);
      612     4283    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);
      613     4284    2       RETURN;
      614     4285    2   NOT_BLANK:
      615     4286    2       RETURN_LENGTH = 30;
      616     4287    2       RETURN;
      617     4288    2   END FIND_LENGTH;
      618     4289        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:22   
      619     4290        /*
      620     4291              NOW COMES THE GET ITEMS THE DIFERENT SUBSCHEMAS.
      621     4292            THEN GENERATE THE NAMES AND THE TYPES OF THE ITEMS IN
      622     4293            THAT RECORD.
      623     4294
      624     4295        */
      625     4296    1   GET_COBOL_ITEMS:
      626     4297    1       PROC;
      627     4298    2       STATUS = #IN_ITEM_PROCESSING;
      628     4299    2       CALL FETCHNS_6 ('RC-FR   ') ALTRET(END_COBOL_RECORD);
      629     4300    3       DO WHILE (UWA.DB_STATUS ~= '0502100');
      630     4301    3           IF UWA.FR.SYN = 0 AND UWA.FR.F_USE = 0
      631     4302    4           THEN DO;
      632     4303    4               CALL FETCHOS_6('SN-SE   ');
      633     4304    4               CALL CHECK_ALIAS(UWA.SN.SENAME);
      634     4305    4               IF UWA.FR.FTYPE=5 OR UWA.FR.FTYPE = 9 OR UWA.FR.FTYPE = 19
      635     4306    5               THEN DO;
      636     4307    5                   IF UWA.FR.PREC > 1
      637     4308    6                   THEN DO;
      638     4309    6                       TEMP_SBIN = UWA.FR.PREC;
      639     4310    6                       CALL BINXCHAR(NUM_STRING,-TEMP_SBIN);
      640     4311    6                       CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);
      641     4312    6                       CALL CONCAT( VARIABLE_TYPE,'DISPLAY PIC X(',
      642     4313    6                          SUBSTR(NUM_STRING,FIRST_NO_ZERO),').');
      643     4314    6                       END;
      644     4315    6                   ELSE DO;
      645     4316    6                       VARIABLE_TYPE='DISPLAY PIC X.';
      646     4317    6                       END;
      647     4318    5                   END;
      648     4319    4               ELSE
      649     4320    4                   IF UWA.FR.FTYPE = 1 OR UWA.FR.FTYPE = 2
      650     4321    4                   THEN VARIABLE_TYPE = 'COMP-6.';
      651     4322    4                   ELSE
      652     4323    4                       IF UWA.FR.FTYPE = 0
      653     4324    4                       THEN VARIABLE_TYPE = 'DB-KEY.';
      654     4325    4                       ELSE
      655     4326    4                           IF UWA.FR.FTYPE = 3 OR UWA.FR.FTYPE = 4
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:23   
      656     4327    5                           THEN DO;
      657     4328    5                               COUNT=12;
      658     4329    5                               VARIABLE_TYPE = 'COMP-4  PIC ';
      659     4330    5                               IF UWA.FR.FTYPE = 4
      660     4331    6                               THEN DO;
      661     4332    6                                   CALL INSERT (VARIABLE_TYPE,COUNT,1,'S');
      662     4333    6                                   COUNT = COUNT + 1;
      663     4334    6                                   END;
      664     4335    5                               INT = UWA.FR.PREC - UWA.FR.SCALE;
      665     4336    5                               IF INT > UWA.FR.PREC
      666     4337    5                               THEN INT =UWA.FR.PREC;
      667     4338    5                               DP = UWA.FR.SCALE;
      668     4339    5                               IF DP > UWA.FR.PREC
      669     4340    5                               THEN DP = UWA.FR.PREC;
      670     4341    5                               IF INT > 0
      671     4342    6                               THEN DO;
      672     4343    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'9');
      673     4344    6                                   COUNT = COUNT + 1;
      674     4345    6                                   END;
      675     4346    5                               IF INT > 1
      676     4347    6                               THEN DO;
      677     4348    6                                   CALL BINXCHAR(NUM_STRING,-INT);
      678     4349    6                                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);
      679     4350    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,10,'(',SUBSTR(
              4350                                            NUM_STRING
      680     4351    6                                      ,FIRST_NO_ZERO),')');
      681     4352    6                                   COUNT=COUNT + 12 - FIRST_NO_ZERO;
      682     4353    6                                   END;
      683     4354    5                               IF DP < 0
      684     4355    6                               THEN DO;
      685     4356    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'P');
      686     4357    6                                   COUNT = COUNT + 1;
      687     4358    6                                   END;
      688     4359    5                               IF DP < -1
      689     4360    6                               THEN DO;
      690     4361    6                                   CALL BINXCHAR(NUM_STRING,DP);
      691     4362    6                                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:24   
      692     4363    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,10,'(',SUBSTR(
              4363                                            NUM_STRING
      693     4364    6                                      ,FIRST_NO_ZERO),')');
      694     4365    6                                   COUNT=COUNT + 12 - FIRST_NO_ZERO;
      695     4366    6                                   END;
      696     4367    5                               IF DP ~= 0
      697     4368    6                               THEN DO;
      698     4369    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'V');
      699     4370    6                                   COUNT = COUNT + 1;
      700     4371    6                                   END;
      701     4372    5                               IF INT < 0
      702     4373    6                               THEN DO;
      703     4374    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'P');
      704     4375    6                                   COUNT = COUNT + 1;
      705     4376    6                                   END;
      706     4377    5                               IF INT < -1
      707     4378    6                               THEN DO;
      708     4379    6                                   CALL BINXCHAR(NUM_STRING,INT);
      709     4380    6                                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);
      710     4381    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,10,'(',SUBSTR(
              4381                                            NUM_STRING
      711     4382    6                                      ,FIRST_NO_ZERO),')');
      712     4383    6                                   COUNT=COUNT + 12 - FIRST_NO_ZERO;
      713     4384    6                                   END;
      714     4385    5                               IF DP > 0
      715     4386    6                               THEN DO;
      716     4387    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'9');
      717     4388    6                                   COUNT = COUNT + 1;
      718     4389    6                                   END;
      719     4390    5                               IF DP > 1
      720     4391    6                               THEN DO;
      721     4392    6                                   CALL BINXCHAR(NUM_STRING,-DP);
      722     4393    6                                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);
      723     4394    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,10,'(',SUBSTR(
              4394                                            NUM_STRING
      724     4395    6                                      ,FIRST_NO_ZERO),')');
      725     4396    6                                   COUNT=COUNT + 12 - FIRST_NO_ZERO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:25   
      726     4397    6                                   END;
      727     4398    5                               CALL INSERT( VARIABLE_TYPE,COUNT,1,'.');
      728     4399    5                               END;
      729     4400    4                           ELSE
      730     4401    4                               IF UWA.FR.FTYPE = 11
      731     4402    5                               THEN DO;
      732     4403    5                                   VARIABLE_TYPE='COMP-11.';
      733     4404    5                                   END;
      734     4405    4                               ELSE
      735     4406    4                                   IF UWA.FR.FTYPE = 12
      736     4407    5                                   THEN DO;
      737     4408    5                                       VARIABLE_TYPE = 'COMP-12.';
      738     4409    5                                       END;
      739     4410    5                                   ELSE DO;
      740     4411    5                                       VARIABLE_TYPE=' **** NO DEFAULT DATA TYPE ****';
      741     4412    5                                       CALL FLAG_LINE(#NO_DEFAULT_TYPE);
      742     4413    5                                       END;
      743     4414    4               CALL CONCAT(OUTPUT_REC,'           02 ',REAL_NAME,
      744     4415    4                  ' ',VARIABLE_TYPE);
      745     4416    4               CALL STORE(OUTPUT_REC);
      746     4417    4               END;
      747     4418    3           CALL FETCHNS_6('RC-FR   ') ALTRET(END_COBOL_RECORD);
      748     4419    3           END;
      749     4420    2   END_COBOL_RECORD:
      750     4421    2       RETURN;
      751     4422    2   END GET_COBOL_ITEMS;
      752     4423        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:26   
      753     4424        /*
      754     4425              NOW GENERATE THE APL ITEMS FOR THE CURRENT RECORD.
      755     4426        */
      756     4427    1   GET_APL_ITEMS:
      757     4428    1       PROC;
      758     4429    2       STATUS = #IN_ITEM_PROCESSING;
      759     4430    2       CALL FETCHNS_6 ('RC-FR   ') ALTRET(END_APL_RECORD);
      760     4431    3       DO WHILE (UWA.DB_STATUS ~= '0502100');
      761     4432    3           IF UWA.FR.SYN = 0 AND UWA.FR.F_USE = 0
      762     4433    4           THEN DO;
      763     4434    4               CALL FETCHOS_6('SN-SE   ');
      764     4435    4               CALL CHECK_ALIAS(UWA.SN.SENAME);
      765     4436    4               IF UWA.FR.FTYPE=5 OR UWA.FR.FTYPE = 9 OR UWA.FR.FTYPE = 19
      766     4437    5               THEN DO;
      767     4438    5                   TEMP_SBIN = UWA.FR.PREC;
      768     4439    5                   CALL BINXCHAR(NUM_STRING,-TEMP_SBIN);
      769     4440    5                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);
      770     4441    5                   CALL CONCAT( VARIABLE_TYPE,'CHARACTER (',
      771     4442    5                      SUBSTR(NUM_STRING,FIRST_NO_ZERO),').');
      772     4443    5                   END;
      773     4444    4               ELSE
      774     4445    4                   IF UWA.FR.FTYPE = 1 OR UWA.FR.FTYPE = 2 OR UWA.FR.FTYPE = 0
      775     4446    4                   THEN VARIABLE_TYPE = 'INTEGER.';
      776     4447    4                   ELSE
      777     4448    4                       IF UWA.FR.FTYPE = 3 OR UWA.FR.FTYPE = 4 OR UWA.FR.FTYPE = 7 OR
      778     4449    4                          UWA.FR.FTYPE = 8 OR UWA.FR.FTYPE = 11 OR UWA.FR.FTYPE = 12
      779     4450    4                          OR UWA.FR.FTYPE = 17 OR UWA.FR.FTYPE = 18
      780     4451    5                       THEN DO;
      781     4452    5                           VARIABLE_TYPE='DOUBLE PRECISION.';
      782     4453    5                           END;
      783     4454    5                       ELSE DO;
      784     4455    5                           VARIABLE_TYPE=' **** NO DEFAULT DATA TYPE ****';
      785     4456    5                           CALL FLAG_LINE(#NO_DEFAULT_TYPE);
      786     4457    5                           END;
      787     4458    4               CALL CONCAT(OUTPUT_REC,'           02 ',REAL_NAME,
      788     4459    4                  ' ',VARIABLE_TYPE);
      789     4460    4               CALL STORE(OUTPUT_REC);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:27   
      790     4461    4               END;
      791     4462    3           CALL FETCHNS_6('RC-FR   ') ALTRET(END_APL_RECORD);
      792     4463    3           END;
      793     4464    2   END_APL_RECORD:
      794     4465    2       RETURN;
      795     4466    2   END GET_APL_ITEMS;
      796     4467        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:28   
      797     4468        /*
      798     4469              NOW GENERATE THE BASIC ITEMS FOR THE CURRENT RECORD.
      799     4470        */
      800     4471    1   GET_BASIC_ITEMS:
      801     4472    1       PROC;
      802     4473    2       STATUS = #IN_ITEM_PROCESSING;
      803     4474    2       CALL FETCHNS_6 ('RC-FR   ') ALTRET(END_BASIC_RECORD);
      804     4475    3       DO WHILE (UWA.DB_STATUS ~= '0502100');
      805     4476    3           IF UWA.FR.SYN = 0 AND UWA.FR.F_USE = 0
      806     4477    4           THEN DO;
      807     4478    4               CALL FETCHOS_6('SN-SE   ');
      808     4479    4               CALL CHECK_ALIAS(UWA.SN.SENAME);
      809     4480    4               IF UWA.FR.FTYPE=5 OR UWA.FR.FTYPE = 9 OR UWA.FR.FTYPE = 19
      810     4481    5               THEN DO;
      811     4482    5                   CALL INDEX1(TEMP_SBIN,' ',REAL_NAME);
      812     4483    6                   IF TEMP_SBIN = LENGTHC(REAL_NAME) THEN DO;
      813     4484    6                       TEMP_SBIN = TEMP_SBIN - 1;
      814     4485    6                       CALL INSERT(REAL_NAME,TEMP_SBIN,1,'$');
      815     4486    6                       CALL ADD_A_ALIAS;
      816     4487    6                       END;
      817     4488    5                   ELSE CALL INSERT(REAL_NAME,TEMP_SBIN,1,'$');
      818     4489    5                   TEMP_SBIN = UWA.FR.PREC;
      819     4490    5                   CALL BINXCHAR(NUM_STRING,-TEMP_SBIN);
      820     4491    5                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);
      821     4492    5                   CALL CONCAT( VARIABLE_TYPE,'CHARACTER (',
      822     4493    5                      SUBSTR(NUM_STRING,FIRST_NO_ZERO),').');
      823     4494    5                   END;
      824     4495    4               ELSE
      825     4496    4                   IF UWA.FR.FTYPE = 11
      826     4497    4                   THEN VARIABLE_TYPE = 'SINGLE PRECISION.';
      827     4498    4                   ELSE
      828     4499    4                       IF UWA.FR.FTYPE = 3 OR UWA.FR.FTYPE = 4 OR UWA.FR.FTYPE = 7 OR
      829     4500    4                          UWA.FR.FTYPE = 0 OR UWA.FR.FTYPE = 1 OR UWA.FR.FTYPE = 2 OR
      830     4501    4                          UWA.FR.FTYPE = 8 OR UWA.FR.FTYPE = 12
      831     4502    4                          OR UWA.FR.FTYPE = 17 OR UWA.FR.FTYPE = 18
      832     4503    5                       THEN DO;
      833     4504    5                           VARIABLE_TYPE='DOUBLE PRECISION.';
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:29   
      834     4505    5                           END;
      835     4506    5                       ELSE DO;
      836     4507    5                           VARIABLE_TYPE=' **** NO DEFAULT DATA TYPE ****';
      837     4508    5                           CALL FLAG_LINE(#NO_DEFAULT_TYPE);
      838     4509    5                           END;
      839     4510    4               CALL CONCAT(OUTPUT_REC,'           02 ',REAL_NAME,
      840     4511    4                  ' ',VARIABLE_TYPE);
      841     4512    4               CALL STORE(OUTPUT_REC);
      842     4513    4               END;
      843     4514    3           CALL FETCHNS_6('RC-FR   ') ALTRET(END_BASIC_RECORD);
      844     4515    3           END;
      845     4516    2   END_BASIC_RECORD:
      846     4517    2       RETURN;
      847     4518    2   END GET_BASIC_ITEMS;
      848     4519        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:30   
      849     4520        /*
      850     4521              NOW GENERATE THE FORTRAN ITEMS FOR THE CURRENT RECORD.
      851     4522        */
      852     4523    1   GET_FORTRAN_ITEMS:
      853     4524    1       PROC;
      854     4525    2       STATUS = #IN_ITEM_PROCESSING;
      855     4526    2       CALL FETCHNS_6 ('RC-FR   ') ALTRET(END_FORTRAN_RECORD);
      856     4527    3       DO WHILE (UWA.DB_STATUS ~= '0502100');
      857     4528    3           IF UWA.FR.SYN = 0 AND UWA.FR.F_USE = 0
      858     4529    4           THEN DO;
      859     4530    4               CALL FETCHOS_6('SN-SE   ');
      860     4531    4               CALL CHECK_ALIAS(UWA.SN.SENAME);
      861     4532    4               IF UWA.FR.FTYPE=5 OR UWA.FR.FTYPE = 9 OR UWA.FR.FTYPE = 19
      862     4533    5               THEN DO;
      863     4534    5                   TEMP_SBIN = UWA.FR.PREC;
      864     4535    5                   CALL BINXCHAR(NUM_STRING,-TEMP_SBIN);
      865     4536    5                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);
      866     4537    5                   CALL CONCAT( VARIABLE_TYPE,'CHARACTER*',
      867     4538    5                      SUBSTR(NUM_STRING,FIRST_NO_ZERO));
      868     4539    5                   END;
      869     4540    4               ELSE
      870     4541    5               DO CASE (UWA.FR.FTYPE);
      871     4542    5               CASE (0, 1, 2);
      872     4543    5                   VARIABLE_TYPE = 'INTEGER';
      873     4544    5               CASE (11);
      874     4545    5                   VARIABLE_TYPE = 'REAL';
      875     4546    5               CASE (7, 12, 18);
      876     4547    5                   VARIABLE_TYPE = 'DOUBLE PRECISION';
      877     4548    5               CASE (3, 4, 8, 17);
      878     4549    5                   IF SSGEN.MAP = '0'B THEN
      879     4550    5                       VARIABLE_TYPE = 'REAL';
      880     4551    5                   IF SSGEN.MAP = '1'B THEN
      881     4552    5                       VARIABLE_TYPE = 'DOUBLE PRECISION';
      882     4553    5               CASE (ELSE);
      883     4554    5                   VARIABLE_TYPE = ' **** NO DEFAULT DATA TYPE **** ';
      884     4555    5                   CALL FLAG_LINE (#NO_DEFAULT_TYPE);
      885     4556    5                   END; /* case */
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:31   
      886     4557    4               CALL CONCAT(OUTPUT_REC,'       ',SUBSTR(VARIABLE_TYPE,0,20),
      887     4558    4                  SUBSTR(REAL_NAME,0,LEN_REAL_NAME),'.');
      888     4559    4               CALL STORE(OUTPUT_REC);
      889     4560    4               END;
      890     4561    3           CALL FETCHNS_6('RC-FR   ') ALTRET(END_FORTRAN_RECORD);
      891     4562    3           END;
      892     4563    2   END_FORTRAN_RECORD:
      893     4564    2       RETURN;
      894     4565    2   END GET_FORTRAN_ITEMS;
      895     4566        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:32   
      896     4567        /*
      897     4568            THIS SUBROUTINE CHANGES COBOL WORDS INTO SCHEMA WORDS '-' TO '_'.
      898     4569        */
      899     4570    1   CHANGE_TO_STR:
      900     4571    1       PROC (CHANGE_STR);
      901     4572    2   DCL CHANGE_STR CHAR (30);
      902     4573    2   DCL COUNT1 UBIN (36);
      903     4574    2   DCL ONE_CHANGE (0:4) CHAR (2) STATIC INIT ('  ',
      904     4575    2    '_-' /* COBOL */, '_$' /* FORTRAN */, '__' /* APL */, '__' /* BASIC */);
      905     4576    2       IF SUB_LANGUAGE = #APL OR SUB_LANGUAGE = #BASIC THEN RETURN;
      906     4577    3       DO WHILE ('1'B);
      907     4578    3           CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),1,1),CHANGE_STR)
      908     4579    3              ALTRET (ALT);
      909     4580    3           CALL INSERT(CHANGE_STR,COUNT1,1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1));
      910     4581    3           END;
      911     4582    2   ALT:
      912     4583    2       RETURN;
      913     4584    2   END CHANGE_TO_STR;
      914     4585        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:33   
      915     4586        /*
      916     4587            Now comes the subroutinue that generates all the aliases
      917     4588          for this subschema.
      918     4589        */
      919     4590    1   GEN_ALIASES:
      920     4591    1       PROC;
      921     4592    2   DCL I UBIN (36);
      922     4593    2   DCL J UBIN (36);
      923     4594    2   DCL CHAR_256 CHAR (256);
      924     4595    2   ALIAS_WRITER:
      925     4596    2       PROC;
      926     4597    3   DCL I UBIN (36);
      927     4598    3   DCL J UBIN (36);
      928     4599    3       CALL INDEX1R(I,'.',CHAR_256);
      929     4600    3       IF I > 77
      930     4601    4       THEN DO;
      931     4602    4           CALL INDEX1R(J,'=',CHAR_256);
      932     4603    4           O_REC.STRING = SUBSTR(CHAR_256,0,J+1);
      933     4604    4           CALL WRITER(O_REC);
      934     4605    4           CALL CONCAT(O_REC.STRING,'            ',SUBSTR(CHAR_256,J+1));
      935     4606    4           IF SUB_LANGUAGE = #FORTRAN
      936     4607    5           THEN DO;
      937     4608    5               CALL INSERT(O_REC.STRING,5,1,'*');
      938     4609    5               END;
      939     4610    4           CALL WRITER(O_REC);
      940     4611    4           END;
      941     4612    4       ELSE DO;
      942     4613    4           O_REC.STRING = CHAR_256;
      943     4614    4           CALL WRITER(O_REC);
      944     4615    4           END;
      945     4616    3   END ALIAS_WRITER;
      946     4617    2       IF SUB_LANGUAGE = #COBOL
      947     4618    3       THEN DO;
      948     4619    3           CHAR_256='         ALIAS SECTION.';
      949     4620    3           END;
      950     4621    2       FIRST_GEN_ALIAS='1'B;
      951     4622    3       DO I = 0 TO 808;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:34   
      952     4623    3           NPTR$ = HAS_TABLE(I);
      953     4624    4           DO WHILE (NPTR$ ~= ADDR(NIL) AND NPTR$->HASH_STRUCT.TYPE =0);
      954     4625    4               NPTR$ = NPTR$ -> HASH_STRUCT.PTR$;
      955     4626    4               END;
      956     4627    4           DO WHILE (NPTR$ ~= ADDR(NIL) AND NPTR$ ->HASH_STRUCT.TYPE =6
      957     4628    4              AND NPTR$ -> HASH_STRUCT.DUPS = 1);
      958     4629    4               IF FIRST_GEN_ALIAS
      959     4630    5               THEN DO;
      960     4631    5                   IF SUB_LANGUAGE=#COBOL THEN CALL ALIAS_WRITER;
      961     4632    5                   CALL WARNING(#GEN_ALIASES);
      962     4633        /*E*     ERROR:    ZIG-#GEN_ALIASES-C
      963     4634        MESSAGE: Warning: The following aliases have been generated by the
      964     4635                 generation of the subschema. So, these names have changed
      965     4636                 from the schema to the subschema.
      966     4637        */
      967     4638    5                   FIRST_GEN_ALIAS = '0'B;
      968     4639    5                   END;
      969     4640    4               CALL CHECK_CHAR_SET(NPTR$->H_ALIAS.SUB$
      970     4641    4                  -> HASH_STRUCT.C_NAME,ERROR_STATUS,POS);
      971     4642    4               CALL FIND_LENGTH(NPTR$ -> H_ALIAS.SUB$
      972     4643    4                  -> HASH_STRUCT.C_NAME,SCHEMA_NAME_LENGHT);
      973     4644    4               CALL FIND_LENGTH(NPTR$ -> H_ALIAS.C_NAME,SUB_NAME_LENGHT);
      974     4645    4               CALL CHANGE_TO_STR(NPTR$ -> H_ALIAS.SUB$
      975     4646    4                  -> HASH_STRUCT.C_NAME);
      976     4647    4               IF SUB_LANGUAGE = #COBOL
      977     4648    5               THEN DO;
      978     4649    5                   IF NPTR$ -> HASH_STRUCT.ALIAS_TYPE = 5
      979     4650    6                   THEN DO;
      980     4651    6                       CALL FIND_LENGTH(NPTR$ -> H_ALIAS.QUAL$
      981     4652    6                          -> HASH_STRUCT.C_NAME,J);
      982     4653    6                       CALL CHANGE_TO_STR(NPTR$ -> H_ALIAS.QUAL$
      983     4654    6                          -> HASH_STRUCT.C_NAME);
      984     4655    6                       CHAR_256='           AD ==';
      985     4656    6                       CALL INSERT(CHAR_256,16,160,
      986     4657    6                          SUBSTR(NPTR$ -> H_ALIAS.QUAL$
      987     4658    6                          -> HASH_STRUCT.C_NAME,0,J),'; ',SUBSTR(
      988     4659    6                          NPTR$ -> H_ALIAS.SUB$ ->
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:35   
      989     4660    6                          HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),
      990     4661    6                          '== BECOMES ',SUBSTR(NPTR$ ->
      991     4662    6                          H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'.');
      992     4663    6                       END;
      993     4664    6                   ELSE DO;
      994     4665    6                       CHAR_256='           AD ==';
      995     4666    6                       CALL INSERT(CHAR_256,16,160,
      996     4667    6                          SUBSTR(
      997     4668    6                          NPTR$ -> H_ALIAS.SUB$ ->
      998     4669    6                          HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'== ',
      999     4670    6                          ALIAS_TYPE(NPTR$ -> HASH_STRUCT.ALIAS_TYPE)
     1000     4671    6                          ,' BECOMES ',SUBSTR(NPTR$ ->
     1001     4672    6                          H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'.');
     1002     4673    6                       END;
     1003     4674    5                   END;
     1004     4675    5               ELSE DO;
     1005     4676    5                   IF NPTR$ -> HASH_STRUCT.ALIAS_TYPE = 5
     1006     4677    6                   THEN DO;
     1007     4678    6                       CALL FIND_LENGTH(NPTR$ -> H_ALIAS.QUAL$
     1008     4679    6                          -> HASH_STRUCT.C_NAME,J);
     1009     4680    6                       CALL CHANGE_TO_STR(NPTR$ -> H_ALIAS.QUAL$
     1010     4681    6                          -> HASH_STRUCT.C_NAME);
     1011     4682    6                       CHAR_256='      ALIAS ';
     1012     4683    6                       CALL INSERT(CHAR_256,12,160,
     1013     4684    6                          SUBSTR(NPTR$->H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'=',
     1014     4685    6                          SUBSTR(NPTR$ -> H_ALIAS.QUAL$
     1015     4686    6                          -> HASH_STRUCT.C_NAME,0,J),'.',SUBSTR(
     1016     4687    6                          NPTR$ -> H_ALIAS.SUB$ ->
     1017     4688    6                          HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'.');
     1018     4689    6                       END;
     1019     4690    6                   ELSE DO;
     1020     4691    6                       CHAR_256='      ALIAS ';
     1021     4692    6                       TVBL = NPTR$->HASH_STRUCT.ALIAS_TYPE + 6;
     1022     4693    6                       CALL INSERT(CHAR_256,12,160,A_TYPE(TVBL),
     1023     4694    6                          SUBSTR(NPTR$->
     1024     4695    6                          H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'=',SUBSTR(
     1025     4696    6                          NPTR$ -> H_ALIAS.SUB$ ->
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:36   
     1026     4697    6                          HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'.');
     1027     4698    6                       END;
     1028     4699    5                   END;
     1029     4700    4               CALL ALIAS_WRITER;
     1030     4701    4               NPTR$ = NPTR$ -> HASH_STRUCT.PTR$;
     1031     4702    4               END;
     1032     4703    3           END;
     1033     4704    2       IF ~FIRST_GEN_ALIAS
     1034     4705    3       THEN DO;
     1035     4706    3           CALL INFO_ONLY(#GEN_ALIAS_END);
     1036     4707        /*E*     ERROR:    ZIG-#GEN_ALIAS_END-C
     1037     4708        MESSAGE: The aliases above were generated by the generator.
     1038     4709        */
     1039     4710    3           END;
     1040     4711    3       DO I = 0 TO 808;
     1041     4712    3           NPTR$ = HAS_TABLE(I);
     1042     4713    4           DO WHILE (NPTR$ ~= ADDR(NIL) AND NPTR$->HASH_STRUCT.TYPE =0);
     1043     4714    4               NPTR$ = NPTR$ -> HASH_STRUCT.PTR$;
     1044     4715    4               END;
     1045     4716    4           DO WHILE (NPTR$ ~= ADDR(NIL) AND NPTR$ ->HASH_STRUCT.TYPE =6);
     1046     4717    4               IF NPTR$ -> HASH_STRUCT.DUPS ~= 1
     1047     4718    5               THEN DO;
     1048     4719    5                   IF FIRST_GEN_ALIAS
     1049     4720    6                   THEN DO;
     1050     4721    6                       IF SUB_LANGUAGE=#COBOL THEN CALL ALIAS_WRITER;
     1051     4722    6                       FIRST_GEN_ALIAS = '0'B;
     1052     4723    6                       END;
     1053     4724    5                   CALL CHECK_CHAR_SET(NPTR$->H_ALIAS.SUB$
     1054     4725    5                      -> HASH_STRUCT.C_NAME,ERROR_STATUS,POS);
     1055     4726    5                   CALL FIND_LENGTH(NPTR$ -> H_ALIAS.SUB$
     1056     4727    5                      -> HASH_STRUCT.C_NAME,SCHEMA_NAME_LENGHT);
     1057     4728    5                   CALL FIND_LENGTH(NPTR$ -> H_ALIAS.C_NAME,SUB_NAME_LENGHT);
     1058     4729    5                   IF SUB_LANGUAGE = #COBOL
     1059     4730    6                   THEN DO;
     1060     4731    6                       IF NPTR$ -> HASH_STRUCT.ALIAS_TYPE = 5
     1061     4732    7                       THEN DO;
     1062     4733    7                           CALL FIND_LENGTH(NPTR$ -> H_ALIAS.QUAL$
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:37   
     1063     4734    7                              -> HASH_STRUCT.C_NAME,J);
     1064     4735    7                           CHAR_256='           AD ==';
     1065     4736    7                           CALL INSERT(CHAR_256,16,160,
     1066     4737    7                              SUBSTR(NPTR$ -> H_ALIAS.QUAL$
     1067     4738    7                              -> HASH_STRUCT.C_NAME,0,J),'; ',SUBSTR(
     1068     4739    7                              NPTR$ -> HASH_STRUCT.C_NAME
     1069     4740    7                              ,0,SUB_NAME_LENGHT),
     1070     4741    7                              '== BECOMES ',SUBSTR(NPTR$ ->
     1071     4742    7                              H_ALIAS.SUB$ ->
     1072     4743    7                              HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'.');
     1073     4744    7                           END;
     1074     4745    7                       ELSE DO;
     1075     4746    7                           CHAR_256='           AD ==';
     1076     4747    7                           CALL INSERT(CHAR_256,16,160,
     1077     4748    7                              SUBSTR(
     1078     4749    7                              NPTR$ -> H_ALIAS.C_NAME
     1079     4750    7                              ,0,SUB_NAME_LENGHT),'== ',
     1080     4751    7                              ALIAS_TYPE(NPTR$ -> HASH_STRUCT.ALIAS_TYPE)
     1081     4752    7                              ,' BECOMES ',SUBSTR(NPTR$ ->
     1082     4753    7                              H_ALIAS.SUB$ ->
     1083     4754    7                              HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'.');
     1084     4755    7                           END;
     1085     4756    6                       END;
     1086     4757    6                   ELSE DO;
     1087     4758    6                       IF NPTR$ -> HASH_STRUCT.ALIAS_TYPE = 5
     1088     4759    7                       THEN DO;
     1089     4760    7                           CALL FIND_LENGTH(NPTR$ -> H_ALIAS.QUAL$
     1090     4761    7                              -> HASH_STRUCT.C_NAME,J);
     1091     4762    7                           CHAR_256='      ALIAS ';
     1092     4763    7                           CALL INSERT(CHAR_256,12,160,
     1093     4764    7                              SUBSTR(NPTR$ -> H_ALIAS.QUAL$ ->
     1094     4765    7                              HASH_STRUCT.C_NAME,0,J),'.',SUBSTR(NPTR$ ->
     1095     4766    7                              H_ALIAS.SUB$ -> HASH_STRUCT.C_NAME,0,
     1096     4767    7                              SCHEMA_NAME_LENGHT),'=',SUBSTR(NPTR$ ->
     1097     4768    7                              H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'.');
     1098     4769    7                           END;
     1099     4770    7                       ELSE DO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:38   
     1100     4771    7                           CHAR_256='      ALIAS ';
     1101     4772    7                           TVBL = NPTR$->HASH_STRUCT.ALIAS_TYPE + 6;
     1102     4773    7                           CALL INSERT(CHAR_256,12,160,A_TYPE(TVBL),
     1103     4774    7                              SUBSTR(NPTR$->
     1104     4775    7                              H_ALIAS.SUB$ -> HASH_STRUCT.C_NAME,0,
     1105     4776    7                              SCHEMA_NAME_LENGHT),'=',SUBSTR(NPTR$ ->
     1106     4777    7                              H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'.');
     1107     4778    7                           END;
     1108     4779    6                       END;
     1109     4780    5                   CALL ALIAS_WRITER;
     1110     4781    5                   IF NPTR$ -> HASH_STRUCT.DUPS <3
     1111     4782    6                   THEN DO;
     1112     4783    6                       CALL WARNING(#ALIAS_NOT_USED);
     1113     4784        /*E*     ERROR:    ZIG-#ALIAS_NOT_USED-C
     1114     4785        MESSAGE: The above alias has not been used by the generator because
     1115     4786                 no schema name was equal to the name given in the rename
     1116     4787                 clause.
     1117     4788        */
     1118     4789    6                       END;
     1119     4790    5                   IF NPTR$ -> HASH_STRUCT.DUPS >3
     1120     4791    6                   THEN DO;
     1121     4792    6                       CALL WARNING(#ALIAS_USED_MORE);
     1122     4793        /*E*     ERROR:    ZIG-#ALIAS_USED_MORE-C
     1123     4794        MESSAGE: The above alias was used for more than one variable in
     1124     4795                 the subschema.
     1125     4796        */
     1126     4797    6                       END;
     1127     4798    5                   END;
     1128     4799    4               NPTR$ = NPTR$ -> HASH_STRUCT.PTR$;
     1129     4800    4               END;
     1130     4801    3           END;
     1131     4802    2       RETURN;
     1132     4803    2   END GEN_ALIASES;
     1133     4804        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:39   
     1134     4805        /*
     1135     4806              Now the routine that flags the line to show what errors occured
     1136     4807            on this line of output so that we can print out the error message
     1137     4808            ( or infomation) after we print out the line of text.
     1138     4809        */
     1139     4810    1   FLAG_LINE:
     1140     4811    1       PROC (BIT_TO_FLAG);
     1141     4812    2   DCL BIT_TO_FLAG UBIN (36);
     1142     4813    2       O_REC.STATUS(BIT_TO_FLAG) = '1'B;
     1143     4814    2       RETURN;
     1144     4815    2   END FLAG_LINE;
     1145     4816        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:40   
     1146     4817        /*
     1147     4818              Now the routine that evals what was the matter with this line
     1148     4819            of output and sets fields so things will look nice for a error
     1149     4820            message.
     1150     4821        */
     1151     4822    1   ERROR_EVAL:
     1152     4823    1       PROC (ERROR_ARRAY);
     1153     4824    2   DCL 1 ERROR_ARRAY ALIGNED,
     1154     4825    2         2 ERROR_TYPE (0:35) BIT (1) UNAL;
     1155     4826    2       IF ERROR_ARRAY.ERROR_TYPE(#NO_DEFAULT_TYPE)
     1156     4827    3       THEN DO;
     1157     4828    3           CALL SET_FIELDS(1,10,LANG_TEXT(SUB_LANGUAGE));
     1158     4829    3           CALL ERROR(#ERR_NO_DEFAULT_TYPE);
     1159     4830        /*E*     ERROR:    ZIG-#ERR_NO_DEFAULT_TYPE-C
     1160     4831        MESSAGE: The above data name has no default conversion for the
     1161     4832                 %U1 subschema.
     1162     4833        */
     1163     4834    3           END;
     1164     4835    2       RETURN;
     1165     4836    2   END ERROR_EVAL;
     1166     4837        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:41   
     1167     4838        /*
     1168     4839              Now the subroutine that sees if this name has been aliased or
     1169     4840            if this word is a reserved word so it should be aliased or
     1170     4841            if it was used some place else so the word should also
     1171     4842            be aliased to something.
     1172     4843
     1173     4844            note2:
     1174     4845                      cobol names musted convert all '_' to '-'
     1175     4846
     1176     4847            note3:
     1177     4848                      fortran names musted convert all '_' to '$'
     1178     4849
     1179     4850            note4:
     1180     4851                      things are not changed in the variable passted but in
     1181     4852                 the variable named REAL_NAME with the lenght of that variable
     1182     4853                 in the variable LEN_REAL_NAME.
     1183     4854        */
     1184     4855    1   CHECK_ALIAS:
     1185     4856    1       PROC (NAME_TO_CHECK);
     1186     4857    2   DCL NAME_TO_CHECK CHAR (30);
     1187     4858    2       REAL_NAME=NAME_TO_CHECK;
     1188     4859    2       CALL FIND_LENGTH(REAL_NAME,LEN_REAL_NAME);
     1189     4860    2       CALL CHECK_CHAR_SET(REAL_NAME,ERROR_STATUS,POS);
     1190     4861    2       IF STATUS = #IN_ITEM_PROCESSING
     1191     4862    2       THEN TEMP_NU = ITEM_NU;
     1192     4863    2       ELSE TEMP_NU = 1;
     1193     4864    2       IF ERROR_STATUS ~= 0
     1194     4865    2       THEN CALL ALIAS_IT;
     1195     4866    3       DO CASE (SUB_LANGUAGE);
     1196     4867    3       CASE (#COBOL);
     1197     4868    3           CALL ZIG$HASH_IT(REAL_NAME,#ADD,ERROR_STATUS,0,TEMP_NU,9,PTR$,
     1198     4869    3              STATUS);
     1199     4870    3           IF ERROR_STATUS ~= 0
     1200     4871    4           THEN DO;
     1201     4872    4               CALL ALIAS_IT;
     1202     4873    4               END;
     1203     4874    3       CASE (#FORTRAN,#APL,#BASIC);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:42   
     1204     4875    3           CALL ZIG$HASH_IT(REAL_NAME,#ADD,ERROR_STATUS,0,0,9,PTR$,
     1205     4876    3              STATUS);
     1206     4877    3           IF ERROR_STATUS ~= 0
     1207     4878    4           THEN DO;
     1208     4879    4               CALL ALIAS_IT;
     1209     4880    4               END;
     1210     4881    4           ELSE DO;
     1211     4882    4               IF SUB_LANGUAGE = #FORTRAN
     1212     4883    5               THEN DO;
     1213     4884    5                   HASH_SCHEMA_NAME = '1'B;
     1214     4885    5                   CALL ZIG$HASH_IT(REAL_NAME,#NO_ADD,ERROR_STATUS,
     1215     4886    5                      0,0,9,PTR$,STATUS);
     1216     4887    5                   IF ERROR_STATUS = 1
     1217     4888    6                   THEN DO;
     1218     4889    6                       CALL ALIAS_IT;
     1219     4890    6                       END;
     1220     4891    5                   END;
     1221     4892    4               END;
     1222     4893    3           END;
     1223     4894    2       RETURN;
     1224     4895    2   END CHECK_ALIAS;
     1225     4896        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:43   
     1226     4897    1   LAST_ZERO: PROC (POS,NUM_STRING);
     1227     4898    2   DCL NUM_STRING CHAR (10);
     1228     4899    2   DCL POS UBIN (36);
     1229     4900    2   DCL I UBIN (36);
     1230     4901    3       DO I = 1 TO 9;
     1231     4902    3           IF SUBSTR(NUM_STRING,I,1) ~= '0'
     1232     4903    4           THEN DO;
     1233     4904    4               POS=I;
     1234     4905    4               RETURN;
     1235     4906    4               END;
     1236     4907    3           END;
     1237     4908    2   END LAST_ZERO;
     1238     4909        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:44   
     1239     4910    1   CHECK_CHAR_SET:
     1240     4911    1       PROC (WORD_TO_TRAN,MUST_ALIAS,POS);
     1241     4912    2   DCL WORD_TO_TRAN CHAR (30);
     1242     4913    2   DCL MUST_ALIAS UBIN (36);
     1243     4914    2   DCL POS UBIN (36);
     1244     4915    2   DCL CHAR_SET (0:4) CHAR (39) STATIC INIT ( 'NOT USED',
     1245     4916    2    'QWERTYUIOPASDFGHJKLZXCVBNM-1234567890  ' /* COBOLS */,
     1246     4917    2    'QWERTYUIOPASDFGHJKLZXCVBNM$1234567890  ' /* FORTRANS */,
     1247     4918    2   'QWERTYUIOPASDFGHJKLZXCVBNM_1234567890  ' /* APLS                              */,
     1248     4919    2   'QWERTYUIOPASDFGHJKLZXCVBNM_1234567890$ ' /* BASICS */
     1249     4920    2    );
     1250     4921    2   DCL ONE_CHANGE (0:3) CHAR (2) STATIC INIT ('  ',
     1251     4922    2    '_-' /* COBOL */, '_$' /* FORTRAN */, '__' /* APL */);
     1252     4923    2   DCL I UBIN (36);
     1253     4924    2   DCL J UBIN (36);
     1254     4925    2       MUST_ALIAS = 0;
     1255     4926    3       DO I = 1 TO 29;
     1256     4927    3           CALL INDEX1(J,SUBSTR(WORD_TO_TRAN,I,1),CHAR_SET(SUB_LANGUAGE));
     1257     4928    3           IF J > 38
     1258     4929    4           THEN DO;
     1259     4930    4               IF SUBSTR(WORD_TO_TRAN,I,1)=SUBSTR(ONE_CHANGE(SUB_LANGUAGE)
     1260     4931    4                  ,0,1)
     1261     4932    4               THEN CALL INSERT(WORD_TO_TRAN,I,1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),1,1));
     1262     4933    5               ELSE DO;
     1263     4934    5                   MUST_ALIAS = 4;
     1264     4935    5                   POS = I;
     1265     4936    5                   END;
     1266     4937    4               END;
     1267     4938    3           END;
     1268     4939    2       CALL INDEX1(J,SUBSTR(WORD_TO_TRAN,0,1),CHAR_SET(SUB_LANGUAGE));
     1269     4940    2       IF J > 25
     1270     4941    3       THEN DO;
     1271     4942    3           MUST_ALIAS = 4;
     1272     4943    3           POS = 0;
     1273     4944    3           END;
     1274     4945    2       RETURN;
     1275     4946    2   END CHECK_CHAR_SET;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:45   
     1276     4947        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:46   
     1277     4948        /*
     1278     4949              ALIAS THIS NAME BECAUSE IT NEEDS IT TO BE ALIASED.
     1279     4950                 THIS PROC IS PASSED ERROR_STATUS AND PTR_C$.
     1280     4951        */
     1281     4952    1   ALIAS_IT:
     1282     4953    1       PROC;
     1283     4954    3       DO WHILE (ERROR_STATUS ~= 0);
     1284     4955    4           DO CASE (ERROR_STATUS);
     1285     4956    4           CASE (1); /* THERE IS A ALIAS IN THE HASH TABLE FOR THIS VARAIBLE.*/
     1286     4957    4               REAL_NAME=PTR$ -> HASH_STRUCT.SUBSCHEMA_NAME -> HASH_STRUCT.C_NAME;
     1287     4958    4               CALL FIND_LENGTH(REAL_NAME,LEN_REAL_NAME);
     1288     4959    4               PTR$ -> HASH_STRUCT.DUPS = PTR$ -> HASH_STRUCT.DUPS +1;
     1289     4960    4               RETURN;
     1290     4961    4           CASE (2,3); /* DUP DATA ITEM OR RESWORD */
     1291     4962    4               STORE_NAME=REAL_NAME;
     1292     4963    4               CALL CONCAT(REAL_NAME,SUBSTR(LETTER_STRING,LETTER_VAL,1),
     1293     4964    4                  SUBSTR(NUM_LETTER_STRING,NUM_VAL,1),STORE_NAME);
     1294     4965    4               LEN_REAL_NAME = LEN_REAL_NAME + 2;
     1295     4966    4               NUM_VAL= MOD(NUM_VAL+1,36);
     1296     4967    4               IF NUM_VAL = 0
     1297     4968    4               THEN LETTER_VAL = MOD(LETTER_VAL+1,26);
     1298     4969    4               CALL ADD_A_ALIAS;
     1299     4970    4           CASE (4); /* THERE IS A BAD CARACTER IN THIS WORD */
     1300     4971    5               DO WHILE (ERROR_STATUS ~= 0);
     1301     4972    5                   IF POS = 0
     1302     4973    6                   THEN DO;
     1303     4974    6                       CALL INSERT(REAL_NAME,0,1,'Z');
     1304     4975    6                       END;
     1305     4976    6                   ELSE DO;
     1306     4977    6                       CALL INSERT(REAL_NAME,POS,1,'0');
     1307     4978    6                       END;
     1308     4979    5                   CALL CHECK_CHAR_SET(REAL_NAME,ERROR_STATUS,POS);
     1309     4980    5                   END;
     1310     4981    4               CALL ADD_A_ALIAS;
     1311     4982    4               END; /* THIS IS THE END OF THE CASE STATEMENT */
     1312     4983    3           END;
     1313     4984    2   END ALIAS_IT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:47   
     1314     4985        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:48   
     1315     4986        /*
     1316     4987              THIS SUBROUTINE ADDS A ALIAS TO THE HASH TABLE.
     1317     4988
     1318     4989            REAL_NAME = THE SUBSCHEMA NAME.
     1319     4990            UWA.SN.SENAME = THE SCHEMA NAME.
     1320     4991            SAVE_RECORD_NAME = THE RECORD NAME IF THIS IS A ITEM NAME.
     1321     4992
     1322     4993        */
     1323     4994    1   ADD_A_ALIAS:
     1324     4995    1       PROC;
     1325     4996    2       TYPE_OF_ALIAS = STATUS;
     1326     4997    2       TEMP_STATUS = 6;
     1327     4998    2       IF SUB_LANGUAGE = #BASIC AND (UWA.FR.FTYPE=5 OR
     1328     4999    2          UWA.FR.FTYPE=9 OR UWA.FR.FTYPE=19) THEN
     1329     5000    3       DO;
     1330     5001    3           CALL INDEX1(TEMP_SBIN,' ',REAL_NAME);
     1331     5002    3           TEMP_WORD = REAL_NAME;
     1332     5003    3           IF TEMP_SBIN = LENGTHC(REAL_NAME) THEN
     1333     5004    4           DO;
     1334     5005    4               TEMP_SBIN = TEMP_SBIN - 1;
     1335     5006    4               END;
     1336     5007    3           CALL INSERT(TEMP_WORD,TEMP_SBIN,1,'$');
     1337     5008    3           CALL ZIG$HASH_IT(TEMP_WORD,#ADD,ERROR_STATUS,
     1338     5009    3              TYPE_OF_ALIAS,1,11,NPTR$,TEMP_STATUS);
     1339     5010    3           END;
     1340     5011    2       ELSE
     1341     5012    2           CALL ZIG$HASH_IT(REAL_NAME,#ADD,
     1342     5013    2              ERROR_STATUS,TYPE_OF_ALIAS,1,11,NPTR$,
     1343     5014    2              TEMP_STATUS);
     1344     5015    2       IF ERROR_STATUS > 0
     1345     5016    2       THEN RETURN;
     1346     5017    2       TEMP_STATUS = 7;
     1347     5018    2       CALL ZIG$HASH_IT(UWA.SN.SENAME,#NO_ADD,
     1348     5019    2          ERROR_STATUS,0,2,9,NPTR$ -> H_ALIAS.SUB$,
     1349     5020    2          TEMP_STATUS);
     1350     5021    2       IF TYPE_OF_ALIAS = 5
     1351     5022    3       THEN DO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:49   
     1352     5023    3           CALL ZIG$HASH_IT(SAVE_RECORD_NAME,#NO_ADD,
     1353     5024    3              ERROR_STATUS,7,2,9,NPTR$ ->
     1354     5025    3              H_ALIAS.QUAL$,TEMP_STATUS);
     1355     5026    3           END;
     1356     5027    2       ELSE NPTR$ -> H_ALIAS.QUAL$ = ADDR(NIL);
     1357     5028    2   END ADD_A_ALIAS;
     1358     5029
     1359     5030        /*
     1360     5031              This is the end.
     1361     5032        */
     1362     5033    1   END ZIG$SS_GEN;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:50   
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_FIVESTAR_DESC.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$SS_GEN.

   Procedure ZIG$SS_GEN requires 3231 words for executable code.
   Procedure ZIG$SS_GEN requires 258 words of local(AUTO) storage.

    No errors detected in file ZIG$SS_GEN.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:51   

 Object Unit name= ZIG$SS_GEN                                 File name= ZIG$SS_GEN.:ZIC0TOU
 UTS= SEP 05 '97 12:10:50.76 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none   656   1220  UWA
    1  LblCom even  none    25     31  DESC
    2   Data  even  none   158    236  ZIG$SS_GEN
    3  LblCom even  none    12     14  ANALS
    4  LblCom even  none    13     15  PURGE
    5  LblCom even  none    19     23  DICTS
    6  LblCom even  none    23     27  DISPS
    7  LblCom even  none    22     26  VALIDS
    8  LblCom even  none    12     14  LOCKS
    9  LblCom even  none    10     12  STRAN
   10  LblCom even  none    12     14  DTRAN
   11  LblCom even  none    16     20  SSTRANS
   12  LblCom even  none    20     24  SSGEN
   13  LblCom even  none     1      1  NUM_ERROR_MSG
   14  LblCom even  none     1      1  NUM_WARN_MSG
   15  LblCom even  none     1      1  ALLOCATE_END
   16  LblCom even  none     2      2  SUBSCHEMA_KEY
   17  LblCom even  none     1      1  BUFFER$
   18  LblCom even  none     1      1  ERROR_IO
   19  LblCom even  none     1      1  BUFFER_LEN
   20  LblCom even  none     2      2  UWA_KEY
   21  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   22  LblCom even  none     2      2  RVA_KEY
   23  LblCom even  none     2      2  IA__KEY
   24  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   25  LblCom even  none    32     40  SEARCHR_NB
   26  LblCom even  none    32     40  SEM_COM
   27  LblCom even  none    32     40  DMCL_XLATE
   28  LblCom even  none    32     40  Q2_PERCENT
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:52   
   29  LblCom even  none     5      5  LANG_ALLOWED
   30  LblCom even  none     1      1  SUB_LANGUAGE
   31  LblCom even  none    16     20  HEADING_TEXT
   32  LblCom even  none    13     15  LANG_TEXT
   33  LblCom even  none     1      1  HASH_SCHEMA_NAME
   34  LblCom even  none     1      1  CURRENT_RECORD
   35  LblCom even  none     1      1  STEPCC
   36  LblCom even  none    46     56  O_REC
   37  LblCom even  none     8     10  SAVE_RECORD_NAME
   38  LblCom even  none   809   1451  HAS_TABLE
   39  LblCom even  none     1      1  ITEM_NU
   40  LblCom even  none     1      1  RECORD_POINTER
   41  RoData even  UTS    191    277  ZIG$SS_GEN
   42   Proc  even  none  3231   6237  ZIG$SS_GEN
   43  RoData even  none   116    164  ZIG$SS_GEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    42      0   yes            yes      Std        0  ZIG$SS_GEN
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:53   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 SET_FIELDS
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 FETCHOS_6
         yes           Std       2 UOPEN
         yes           Std       4 UGET
 yes     yes           Std       1 STRE_6
         yes           Std       2 UNSC
         yes           Std       1 ERROR
         yes           Std       2 SUBLST
         yes           Std       1 GET_TIME
 yes     yes           Std       1 FETCHNS_6
         yes           Std       8 ZIG$HASH_IT
         yes           Std       2 ZIG$G_DYN_MEM_6
         yes           Std       1 UCLOSE
         yes           Std       0 WRITERECORD_TO_SEQ_FILE
         yes           Std       1 LIST
         yes           Std       3 UPUT
         yes           Std       1 WARNING
         yes           Std       1 INFO_ONLY
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:54   


        1        1        /*M*     ZIG$SS_GEN          DBACS     I_D-S/II */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$SS_GEN
        9        9        PURPOSE: To generate the following subschemas DDL
       10       10                 COBOL:
       11       11                      The subschema DDL is about the same as GCOS DDl (module
       12       12                    SSJEN) except for the COMP-11 and COMP-12 for floating
       13       13                    point schema data types (UWA.FR.FTYPE = 12 or 13).
       14       14                 FORTRAN:
       15       15                      The subschema DDL is new to CP6 and creates the DDL
       16       16                    for the new DBACS subschema translator ( ZIG$SS_PDRI )
       17       17                    and the subschema DDL should be compatable with GCOS
       18       18                    subschema FORTRAN DDL.
       19       19                 APL:
       20       20                      The subschema DDL is also new to CP6 and creates the
       21       21                    APL subschema DDL for the new DBACS subschema translator.
       22       22                 BASIC:
       23       23                      The BASIC DDL is essencially the same as the APL DDL.
       24       24
       25       25
       26       26                 Data conversions from schema to subschema.
       27       27
       28       28                  SCHEMA         APL            FORTRAN          BASIC
       29       29                ----------  ------------   -----------------  ------------
       30       30              CHARACTER     CHARACTER      CHARACTER          CHARACTER
       31       31              CHAR VARYING  CHARACTER      CHARACTER          CHARACTER
       32       32              FIXED 17      INTEGER        INTEGER            DOUBLE PRECISION
       33       33              FIXED 35      INTEGER        INTEGER            DOUBLE PRECISION
       34       34              FLOAT 35      FLOAT DWORD    REAL               DOUBLE PRECISION
       35       35              FLOAT 71      FLOAT DWORD    DOUBLE PRECISION   DOUBLE PRECISION
       36       36              DECIMAL  _,_  FLOAT DWORD    DOUBLE PRECISION   DOUBLE PRECISION
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:55   
       37       37              UNSPECIFIED   CHARACTER      CHARACTER          CHARACTER
       38       38
       39       39
       40       40            ARRAYS WILL BE GENERATED WHEN THE OCCURS CLAUSE IS PUT
       41       41          IN THE SCHEMA DDL.
       42       42
       43       43
       44       44
       45       45        */
       46       46        /*D*     NAME: ZIG$SS_GEN
       47       47        DESCRIPTION:
       48       48              This modual reads the schema file throw IDS and creates a
       49       49            subschema DDL for one of four languages ( COBOL, APL, BASIC,or
       50       50            FORTRAN ).
       51       51              It works in to passes:
       52       52            Pass1 builds all the aliases into the hashtables created by
       53       53            ZIG$HASH_IT and puts out all text for the areas, sets , keys,
       54       54            records, and items to a temporay file called '5*'.
       55       55            Pass2 builds the aliases and writes out the subschema DDL text
       56       56            to both M$LO and M$SO. Some of the subschema DDL is read from
       57       57            the '5*' file.
       58       58        */
       59       59        /*D*     NAME:     SUB_LANGUAGE
       60       60                 THIS VARIABLE TELLS WHAT LANGUAGE TO GENERATE THE SUBSCHEMA
       61       61               DDL FOR:
       62       62                 1    _    COBOL
       63       63                 2    _    FORTRAN
       64       64                 3    _    APL
       65       65                 4    _    BASIC
       66       66        */
       67       67        ZIG$SS_GEN:
       68       68            PROC;

     68 42 000000   000000 700200 xent  ZIG$SS_GEN   TSX0  ! X66_AUTO_0
        42 000001   000402 000000                    ZERO    258,0

       69       69        %INCLUDE ZI_SUB_LANG;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:56   
       70     1784        %INCLUDE ZI_SUB4_CAN;
       71     2441        %UWA;
       72     2776        %INCLUDE ZIG_FIVESTAR_DESC;
       73     2819        %INCLUDE ZIG_DIR_STRUCS;
       74     2949        %INCLUDE ZIG_DBA_INT;
       75     2997        %INCLUDE ZIG_GENERAL;
       76     3105        %GENERAL;
       77     3229        %INCLUDE ZI_ERRORS_SUBS;
       78     3749        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:57   
       79     3750    1   DCL LOCKED BIT (1);
       80     3751    1   DCL DONE BIT (1);
       81     3752    1   DCL STEPCC UBIN (36) EXT;
       82     3753    1   DCL PTR$ PTR;
       83     3754    1   DCL ALIAS_PTR$ PTR;
       84     3755    1   DCL BUFFER_SIZE UBIN (36);
       85     3756    1   DCL BUFFER_INPUT CHAR (25) BASED (DESCPTR);
       86     3757    1   DCL ALIASS (0:0) CHAR (25) BASED (ALIAS_PTR$);
       87     3758    1   DCL NU_ALIAS UBIN (36);
       88     3759    1   DCL NEW_ALIAS_PTR$ PTR;
       89     3760    1   DCL ERROR_ALIAS UBIN (36);
       90     3761    1   DCL TYPE_OF_ALIAS UBIN (36);
       91     3762    1   DCL 1 ALIAS_DESC BASED (DESCPTR),
       92     3763    1         2 TYPE UBIN (36),
       93     3764    1         2 S,
       94     3765    1           3 QUAL CHAR (30),
       95     3766    1           3 NAME CHAR (30),
       96     3767    1         2 SS,
       97     3768    1           3 NAME CHAR (30),
       98     3769    1         2 DUMM CHAR (6);
       99     3770    1   DCL 1 H_ALIAS BASED,
      100     3771    1         2 INFO BIT (18) UNAL,
      101     3772    1         2 C_NAME CHAR (30) UNAL,
      102     3773    1         2 NEXT_LINK_PTR$ PTR UNAL,
      103     3774    1         2 SUB$ PTR UNAL,
      104     3775    1         2 QUAL$ PTR UNAL;
      105     3776    1   DCL 1 B BASED ALIGNED,
      106     3777    1         2 BIT36 BIT (1) UNAL,
      107     3778    1         2 * BIT (35) UNAL;
      108     3779    1   DCL TITLE CHAR (80);
      109     3780    1   DCL SUB_TITLE CHAR (80);
      110     3781    1   DCL OUTPUT_REC CHAR (80);
      111     3782    1   DCL I UBIN (36);
      112     3783    1   DCL J UBIN (36);
      113     3784    1   DCL TVBL UBIN(36);
      114     3785    1   DCL 1 DSTRING UNAL,
      115     3786    1         2 COUNT UBIN (9) UNAL,
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:58   
      116     3787    1         2 START CHAR (31) UNAL;
      117     3788    1   DCL EOF UBIN (36);
      118     3789    1   DCL DESCPTR PTR;
      119     3790    1   DCL REAL_NAME CHAR (30);
      120     3791    1   DCL STATUS UBIN (6);
      121     3792    1   DCL SUB_NAME_LENGHT UBIN (36);
      122     3793    1   DCL SCHEMA_NAME_LENGHT UBIN (36);
      123     3794    1   DCL LEN_REAL_NAME UBIN (36);
      124     3795    1   DCL 1 O_REC EXT,
      125     3796    1         2 STATUS (0:35) BIT (1) UNAL,
      126     3797    1         2 W_STATUS REDEF STATUS UBIN (36) ,
      127     3798    1         2 STRING CHAR (180) UNAL;
      128     3799    1   DCL COUNT UBIN (36);
      129     3800    1   DCL INT SBIN (36);
      130     3801    1   DCL DP SBIN (36);
      131     3802    1   DCL VARIABLE_TYPE CHAR (40);
      132     3803    1   DCL NUM_STRING CHAR (10);
      133     3804    1   DCL HOLD_DBKEY UBIN (36);
      134     3805    1   DCL TEMP_SBIN SBIN (36);
      135     3806    1   DCL FIRST_NO_ZERO UBIN (36);
      136     3807    1   DCL ZIG$HASH_IT ENTRY (8);
      137     3808    1   DCL UNSC ENTRY (2);
      138     3809    1   DCL POSITION UBIN (36);
      139     3810    1   DCL NPTR$ PTR;
      140     3811    1   DCL ERROR_STATUS UBIN (36);
      141     3812    1   DCL PTR_C$ PTR;
      142     3813    1   DCL SAVE_RECORD_NAME CHAR (30) EXT;
      143     3814    1   DCL POS UBIN (36);
      144     3815    1   DCL LETTER_STRING CHAR (26) STATIC INIT ('ABCDEFGHIJKLMNOPQRSTUVWXYZ');
      145     3816    1  DCL NUM_LETTER_STRING CHAR (36) STATIC INIT ('0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ')
              3816            ;
      146     3817    1   DCL NUM_VAL UBIN (36);
      147     3818    1   DCL LETTER_VAL UBIN (36);
      148     3819    1   DCL ALIAS_TYPE (0:6) CHAR(11) STATIC INIT(' ','REALM-NAME','SET-NAME',
      149     3820    1    'KEY-NAME','RECORD-NAME','ITEM-NAME','ITEM-NAME');
      150     3821    1   DCL A_TYPE (0:12) CHAR(9) STATIC INIT(' ','AREA','SET',
      151     3822    1    'KEY','RECORD','ITEM','ITEM','(REALM)','(SET)',
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:59   
      152     3823    1    '(KEY)','(RECORD)','(ITEM)','(ITEM)');
      153     3824    1   DCL FIRST_GEN_ALIAS BIT (1);
      154     3825    1   DCL HAS_TABLE (0:808) PTR EXT INIT (ADDR(NIL)*809);
      155     3826    1   DCL STORE_NAME CHAR (30);
      156     3827    1   DCL ITEM_NU UBIN (36) EXT;
      157     3828    1   DCL TEMP_NU UBIN (36);
      158     3829    1   DCL TEMP_STATUS UBIN (6);
      159     3830    1   DCL TEMP_WORD CHAR(30);
      160     3831        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:60   
      161     3832    1   START:
      162     3833    1       IF LANG_ALLOWED(SUB_LANGUAGE) = 0

   3833 42 000002   000000 720000 30    START        LXL0    SUB_LANGUAGE
        42 000003   000000 235010 29                 LDA     LANG_ALLOWED,X0
        42 000004   000027 601000 42                 TNZ     s:3843

      163     3834    2       THEN DO;

      164     3835    2           STORE_NAME = LANG_TEXT(SUB_LANGUAGE);

   3835 42 000005   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 000006   000012 402007                    MPY     10,DL
        42 000007   040100 100406                    MLR     fill='040'O
        42 000010   000000 000012 32                 ADSC9   LANG_TEXT,Q              cn=0,n=10
        42 000011   200174 000036                    ADSC9   STORE_NAME,,AUTO         cn=0,n=30

      165     3836    2           CALL SET_FIELDS(1,30,STORE_NAME);

   3836 42 000012   200174 630500                    EPPR0   STORE_NAME,,AUTO
        42 000013   200374 450500                    STP0    @ERROR_ARRAY+3,,AUTO
        42 000014   000004 237000 43                 LDAQ    4
        42 000015   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000016   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000017   000000 631400 43                 EPPR1   0
        42 000020   000000 701000 xent               TSX1    SET_FIELDS
        42 000021   000000 011000                    NOP     0

      166     3837    2           CALL ERROR(%ZIG_INTERFACE_NO_$);

   3837 42 000022   000007 630400 43                 EPPR0   7
        42 000023   000003 631400 43                 EPPR1   3
        42 000024   000000 701000 xent               TSX1    ERROR
        42 000025   000000 011000                    NOP     0

      167     3838        /*E*  ERROR:  ZIG-ZIG_INTERFACE_NO_$-C
      168     3839              MESSAGE: The subschema language, %U1, is not allowed.
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:61   
      169     3840        */
      170     3841    2           RETURN;

   3841 42 000026   000000 702200 xent               TSX2  ! X66_ARET

      171     3842    2           END;
      172     3843    1       ITEM_NU=3;

   3843 42 000027   000003 236007                    LDQ     3,DL
        42 000030   000000 756000 39                 STQ     ITEM_NU

      173     3844    1       NUM_VAL = 0;

   3844 42 000031   200171 450100                    STZ     NUM_VAL,,AUTO

      174     3845    1       LETTER_VAL = 25;

   3845 42 000032   000031 235007                    LDA     25,DL
        42 000033   200172 755100                    STA     LETTER_VAL,,AUTO

      175     3846    1       CALL CONCAT(HEADING_TEXT,LANG_TEXT(SUB_LANGUAGE),' SUBSCHEMA GENERATOR');

   3846 42 000034   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 000035   000012 402007                    MPY     10,DL
        42 000036   040000 100406                    MLR     fill='040'O
        42 000037   000000 000012 32                 ADSC9   LANG_TEXT,Q              cn=0,n=10
        42 000040   000000 000012 31                 ADSC9   HEADING_TEXT             cn=0,n=10
        42 000041   040000 100400                    MLR     fill='040'O
        42 000042   000000 000024 41                 ADSC9   0                        cn=0,n=20
        42 000043   000002 400066 31                 ADSC9   HEADING_TEXT+2           cn=2,n=54

      176     3847    1       CALL SUBLST (HEADING_TEXT);

   3847 42 000044   000010 630400 43                 EPPR0   8
        42 000045   000003 631400 43                 EPPR1   3
        42 000046   000000 701000 xent               TSX1    SUBLST
        42 000047   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:62   

      177     3848    1       CALL FETCHD_6('SF  ',2);

   3848 42 000050   000013 630400 43                 EPPR0   11
        42 000051   000011 631400 43                 EPPR1   9
        42 000052   000000 701000 xent               TSX1    FETCHD_6
        42 000053   000000 011000                    NOP     0

      178     3849    1       CALL FETCHD_6('DA  ',UWA.SF.DBKEY_DA);

   3849 42 000054   000015 630400 43                 EPPR0   13
        42 000055   000011 631400 43                 EPPR1   9
        42 000056   000000 701000 xent               TSX1    FETCHD_6
        42 000057   000000 011000                    NOP     0

      179     3850    1       CALL FETCHD_6('OA  ',UWA.SF.DBKEY_OA);

   3850 42 000060   000017 630400 43                 EPPR0   15
        42 000061   000011 631400 43                 EPPR1   9
        42 000062   000000 701000 xent               TSX1    FETCHD_6
        42 000063   000000 011000                    NOP     0

      180     3851    1       CALL FETCHOS_6('SN-SE   ');

   3851 42 000064   000021 630400 43                 EPPR0   17
        42 000065   000003 631400 43                 EPPR1   3
        42 000066   000000 701000 xent               TSX1    FETCHOS_6
        42 000067   000000 011000                    NOP     0

      181     3852    1       UWA.A_D.AD_FUNCTION=9;

   3852 42 000070   000011 235007                    LDA     9,DL
        42 000071   000170 755000 0                  STA     UWA+120

      182     3853    1       CALL GET_TIME(UWA.A_D.AD_DATE);

   3853 42 000072   000022 630400 43                 EPPR0   18
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:63   
        42 000073   000003 631400 43                 EPPR1   3
        42 000074   000000 701000 xent               TSX1    GET_TIME
        42 000075   000000 011000                    NOP     0

      183     3854    1       CALL CONCAT(UWA.A_D.AD_IDENT,LANG_TEXT(SUB_LANGUAGE),SSGEN.SSNAME);

   3854 42 000076   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 000077   000012 402007                    MPY     10,DL
        42 000100   040000 100406                    MLR     fill='040'O
        42 000101   000000 000012 32                 ADSC9   LANG_TEXT,Q              cn=0,n=10
        42 000102   000174 000012 0                  ADSC9   UWA+124                  cn=0,n=10
        42 000103   040000 100400                    MLR     fill='040'O
        42 000104   000003 600036 12                 ADSC9   SSGEN+3                  cn=3,n=30
        42 000105   000176 400062 0                  ADSC9   UWA+126                  cn=2,n=50

      184     3855    1       CALL STRE_6('A-D ');

   3855 42 000106   000023 630400 43                 EPPR0   19
        42 000107   000003 631400 43                 EPPR1   3
        42 000110   000000 701000 xent               TSX1    STRE_6
        42 000111   000000 011000                    NOP     0

      185     3856        /*
      186     3857            STORE A ACTIVITIES RECORD TO SHOW THAT A SUBSCHEMA GENERATION
      187     3858          WAS STARTED AND WHICH LANGUAGE IT WAS FOR.
      188     3859        */
      189     3860    1       LOCKED = '0'B;

   3860 42 000112   200003 450100                    STZ     LOCKED,,AUTO

      190     3861    1       DONE = '0'B;

   3861 42 000113   200004 450100                    STZ     DONE,,AUTO

      191     3862    2       DO WHILE (~DONE);

   3862 42 000114   000154 710000 42                 TRA     s:3876
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:64   

      192     3863    2           CALL FETCHNS_6('SN-LT   ') ALTRET(CHECK_LOCK);

   3863 42 000115   000024 630400 43                 EPPR0   20
        42 000116   000003 631400 43                 EPPR1   3
        42 000117   000000 701000 xent               TSX1    FETCHNS_6
        42 000120   000160 702000 42                 TSX2    CHECK_LOCK

      193     3864    2           IF ADDR(UWA.LT.PLOCKS) -> B.BIT36

   3864 42 000121   000473 234000 0                  SZN     UWA+315
        42 000122   000154 605000 42                 TPL     s:3876

      194     3865    3           THEN DO;

      195     3866    3               LOCKED = '1'B;

   3866 42 000123   400000 236003                    LDQ     -131072,DU
        42 000124   200003 756100                    STQ     LOCKED,,AUTO

      196     3867    3               CALL FETCHOS_6('LK-LT   ');

   3867 42 000125   000025 630400 43                 EPPR0   21
        42 000126   000003 631400 43                 EPPR1   3
        42 000127   000000 701000 xent               TSX1    FETCHOS_6
        42 000130   000000 011000                    NOP     0

      197     3868    3               CALL UNSC(UWA.LK.PLVALUE,STORE_NAME);

   3868 42 000131   200174 630500                    EPPR0   STORE_NAME,,AUTO
        42 000132   200373 450500                    STP0    @ERROR_ARRAY+2,,AUTO
        42 000133   000026 236000 43                 LDQ     22
        42 000134   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000135   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000136   000011 631400 43                 EPPR1   9
        42 000137   000000 701000 xent               TSX1    UNSC
        42 000140   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:65   

      198     3869    3               IF SSGEN.DISP_KEY = SUBSTR(STORE_NAME,0,12)

   3869 42 000141   040100 106400                    CMPC    fill='040'O
        42 000142   000000 600014 12                 ADSC9   SSGEN                    cn=3,n=12
        42 000143   200174 000014                    ADSC9   STORE_NAME,,AUTO         cn=0,n=12
        42 000144   000151 600000 42                 TZE     s:3872
        42 000145   040000 106400                    CMPC    fill='040'O
        42 000146   000447 400006 0                  ADSC9   UWA+295                  cn=2,n=6
        42 000147   000017 000006 41                 ADSC9   15                       cn=0,n=6
        42 000150   000154 601000 42                 TNZ     s:3876

      199     3870    3                  OR SUBSTR(UWA.LK.PLVALUE,0,6) = '"NULL"'
      200     3871    4               THEN DO;

      201     3872    4                   LOCKED = '0'B;

   3872 42 000151   200003 450100                    STZ     LOCKED,,AUTO

      202     3873    4                   DONE = '1'B;

   3873 42 000152   400000 236003                    LDQ     -131072,DU
        42 000153   200004 756100                    STQ     DONE,,AUTO

      203     3874    4                   END;

      204     3875    3               END;

      205     3876    2           END;

   3876 42 000154   200004 236100                    LDQ     DONE,,AUTO
        42 000155   400000 376003                    ANQ     -131072,DU
        42 000156   400000 676003                    ERQ     -131072,DU
        42 000157   000115 601000 42                 TNZ     s:3863

      206     3877    1   CHECK_LOCK:
      207     3878    1       IF LOCKED
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:66   

   3878 42 000160   200003 234100       CHECK_LOCK   SZN     LOCKED,,AUTO
        42 000161   000171 605000 42                 TPL     s:3890

      208     3879    2       THEN DO;

      209     3880    2           CALL ERROR(#BAD_LOCK_DISPLAY);

   3880 42 000162   000030 630400 43                 EPPR0   24
        42 000163   000003 631400 43                 EPPR1   3
        42 000164   000000 701000 xent               TSX1    ERROR
        42 000165   000000 011000                    NOP     0

      210     3881        /*E*     ERROR:    ZIG-#BAD_LOCK_DISPLAY-C
      211     3882        MESSAGE: The schema is locked for DISPLAYs and either
      212     3883                 no privacy key was given or the wrong privacy key
      213     3884                 was given.
      214     3885        */
      215     3886    2           STEPCC = 7; /* BAD PRIVACY LOCK */

   3886 42 000166   000007 235007                    LDA     7,DL
        42 000167   000000 755000 35                 STA     STEPCC

      216     3887    2           RETURN;

   3887 42 000170   000000 702200 xent               TSX2  ! X66_ARET

      217     3888    2           END;
      218     3889        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:67   
      219     3890    1       IF SSGEN.ALIAS_NAMES

   3890 42 000171   000000 236000 12                 LDQ     SSGEN
        42 000172   040000 316003                    CANQ    16384,DU
        42 000173   000602 600000 42                 TZE     s:3970

      220     3891    2       THEN DO;

      221     3892    2           STATUS=#IN_ALIAS;

   3892 42 000174   060000 236003                    LDQ     24576,DU
        42 000175   200135 756100                    STQ     STATUS,,AUTO

      222     3893    2           CALL UOPEN ('5*',0);

   3893 42 000176   000032 630400 43                 EPPR0   26
        42 000177   000011 631400 43                 EPPR1   9
        42 000200   000000 701000 xent               TSX1    UOPEN
        42 000201   000000 011000                    NOP     0

      223     3894    2           CALL UGET ('5*',DESCPTR,EOF,BUFFER_SIZE);

   3894 42 000202   200007 630500                    EPPR0   BUFFER_SIZE,,AUTO
        42 000203   200375 450500                    STP0    @ERROR_ARRAY+4,,AUTO
        42 000204   200123 631500                    EPPR1   EOF,,AUTO
        42 000205   200374 451500                    STP1    @ERROR_ARRAY+3,,AUTO
        42 000206   200124 633500                    EPPR3   DESCPTR,,AUTO
        42 000207   200373 453500                    STP3    @ERROR_ARRAY+2,,AUTO
        42 000210   000032 236000 43                 LDQ     26
        42 000211   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000212   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000213   000034 631400 43                 EPPR1   28
        42 000214   000000 701000 xent               TSX1    UGET
        42 000215   000000 011000                    NOP     0

      224     3895    2           NU_ALIAS=0;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:68   
   3895 42 000216   200010 450100                    STZ     NU_ALIAS,,AUTO

      225     3896    2           CALL ZIG$G_DYN_MEM_6(0,ALIAS_PTR$);

   3896 42 000217   200006 630500                    EPPR0   ALIAS_PTR$,,AUTO
        42 000220   200373 450500                    STP0    @ERROR_ARRAY+2,,AUTO
        42 000221   000033 236000 43                 LDQ     27
        42 000222   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000223   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000224   000011 631400 43                 EPPR1   9
        42 000225   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        42 000226   000000 011000                    NOP     0

      226     3897    3           DO WHILE (EOF=0);

   3897 42 000227   200123 235100                    LDA     EOF,,AUTO
        42 000230   000576 601000 42                 TNZ     s:3968

      227     3898    3               NU_ALIAS = NU_ALIAS + 1;

   3898 42 000231   200010 235100                    LDA     NU_ALIAS,,AUTO
        42 000232   000001 035007                    ADLA    1,DL
        42 000233   200010 755100                    STA     NU_ALIAS,,AUTO

      228     3899    3               CALL CHECK_CHAR_SET(ALIAS_DESC.SS.NAME,ERROR_ALIAS,POSITION);

   3899 42 000234   200164 630500                    EPPR0   POSITION,,AUTO
        42 000235   200325 450500                    STP0    @MUST_ALIAS+1,,AUTO
        42 000236   200012 631500                    EPPR1   ERROR_ALIAS,,AUTO
        42 000237   200324 451500                    STP1    @WORD_TO_TRAN+1,,AUTO
        42 000240   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000241   000020 036003                    ADLQ    16,DU
        42 000242   200323 756100                    STQ     I+64,,AUTO
        42 000243   005631 701000 42                 TSX1    CHECK_CHAR_SET
        42 000244   000000 011000                    NOP     0

      229     3900    3               IF ERROR_ALIAS>1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:69   

   3900 42 000245   200012 235100                    LDA     ERROR_ALIAS,,AUTO
        42 000246   000002 115007                    CMPA    2,DL
        42 000247   000313 602000 42                 TNC     s:3914

      230     3901    4               THEN DO;

      231     3902    4                   CALL SET_FIELDS(1,30,ALIAS_DESC.S.QUAL);

   3902 42 000250   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000251   000001 036003                    ADLQ    1,DU
        42 000252   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 000253   000004 237000 43                 LDAQ    4
        42 000254   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000255   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000256   000000 631400 43                 EPPR1   0
        42 000257   000000 701000 xent               TSX1    SET_FIELDS
        42 000260   000000 011000                    NOP     0

      232     3903    4                   CALL SET_FIELDS(2,30,ALIAS_DESC.SS.NAME);

   3903 42 000261   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000262   000020 036003                    ADLQ    16,DU
        42 000263   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 000264   000036 237000 43                 LDAQ    30
        42 000265   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000266   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000267   000000 631400 43                 EPPR1   0
        42 000270   000000 701000 xent               TSX1    SET_FIELDS
        42 000271   000000 011000                    NOP     0

      233     3904    4                   CALL SET_FIELDS(3,30,

   3904 42 000272   200124 470500                    LDP0    DESCPTR,,AUTO
        42 000273   000000 235100                    LDA     0,,PR0
        42 000274   000044 733000                    LRS     36
        42 000275   000041 402000 43                 MPY     33
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:70   
        42 000276   000040 036000 43                 ADLQ    32
        42 000277   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 000300   000042 237000 43                 LDAQ    34
        42 000301   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000302   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000303   000000 631400 43                 EPPR1   0
        42 000304   000000 701000 xent               TSX1    SET_FIELDS
        42 000305   000000 011000                    NOP     0

      234     3905    4                      TYPE_NAME(ALIAS_DESC.TYPE-1));
      235     3906    4                   CALL ERROR(#BAD_CHAR_ALIAS);

   3906 42 000306   000045 630400 43                 EPPR0   37
        42 000307   000003 631400 43                 EPPR1   3
        42 000310   000000 701000 xent               TSX1    ERROR
        42 000311   000000 011000                    NOP     0

      236     3907        /*E*     ERROR:    ZIG-#BAD_CHAR_ALIAS-C
      237     3908        MESSAGE: In the alias list of type %U3 there is a bad
      238     3909                 character in the name %U2.
      239     3910                 This alias will not be processed.
      240     3911        */
      241     3912    4                   END;

   3912 42 000312   000560 710000 42                 TRA     s:3966

      242     3913    4               ELSE DO;

      243     3914    4                   TEMP_STATUS = 7;

   3914 42 000313   070000 236003                    LDQ     28672,DU
        42 000314   200205 756100                    STQ     TEMP_STATUS,,AUTO

      244     3915    4                   CALL ZIG$HASH_IT(ALIAS_DESC.SS.NAME,#NO_ADD,

   3915 42 000315   200205 630500                    EPPR0   TEMP_STATUS,,AUTO
        42 000316   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:71   
        42 000317   200011 631500                    EPPR1   NEW_ALIAS_PTR$,,AUTO
        42 000320   200400 451500                    STP1    @ERROR_ARRAY+7,,AUTO
        42 000321   000050 237000 43                 LDAQ    40
        42 000322   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 000323   000033 236000 43                 LDQ     27
        42 000324   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 000325   200012 633500                    EPPR3   ERROR_ALIAS,,AUTO
        42 000326   200374 453500                    STP3    @ERROR_ARRAY+3,,AUTO
        42 000327   000004 236000 43                 LDQ     4
        42 000330   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 000331   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000332   000020 036003                    ADLQ    16,DU
        42 000333   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000334   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000335   000046 631400 43                 EPPR1   38
        42 000336   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 000337   000000 011000                    NOP     0

      245     3916    4                      ERROR_ALIAS,0,0,9,NEW_ALIAS_PTR$,
      246     3917    4                      TEMP_STATUS);
      247     3918    4                   IF ERROR_ALIAS > 0 AND ALIAS_DESC.TYPE = 5

   3918 42 000340   200012 235100                    LDA     ERROR_ALIAS,,AUTO
        42 000341   000375 600000 42                 TZE     s:3930
        42 000342   200124 470500                    LDP0    DESCPTR,,AUTO
        42 000343   000000 235100                    LDA     0,,PR0
        42 000344   000005 115007                    CMPA    5,DL
        42 000345   000375 601000 42                 TNZ     s:3930

      248     3919    5                   THEN DO;

      249     3920    5                       CALL SET_FIELDS(1,30,ALIAS_DESC.S.QUAL);

   3920 42 000346   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000347   000001 036003                    ADLQ    1,DU
        42 000350   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 000351   000004 237000 43                 LDAQ    4
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:72   
        42 000352   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000353   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000354   000000 631400 43                 EPPR1   0
        42 000355   000000 701000 xent               TSX1    SET_FIELDS
        42 000356   000000 011000                    NOP     0

      250     3921    5                       CALL SET_FIELDS(2,30,ALIAS_DESC.SS.NAME);

   3921 42 000357   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000360   000020 036003                    ADLQ    16,DU
        42 000361   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 000362   000036 237000 43                 LDAQ    30
        42 000363   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000364   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000365   000000 631400 43                 EPPR1   0
        42 000366   000000 701000 xent               TSX1    SET_FIELDS
        42 000367   000000 011000                    NOP     0

      251     3922    5                       CALL ERROR (#DUP_ALIAS);

   3922 42 000370   000053 630400 43                 EPPR0   43
        42 000371   000003 631400 43                 EPPR1   3
        42 000372   000000 701000 xent               TSX1    ERROR
        42 000373   000000 011000                    NOP     0

      252     3923        /*E*     ERROR:    ZIG-#DUP_ALIAS-C
      253     3924        MESSAGE: The fatal error occurred on the processing of the alias list:
      254     3925                 for the type %U3 the name %U1 and %U1 are equivalent.
      255     3926                 The one aliased to %U2 will not be changed.
      256     3927        */
      257     3928    5                       END;

   3928 42 000374   000560 710000 42                 TRA     s:3966

      258     3929    5                   ELSE DO;

      259     3930    5                       IF SUB_LANGUAGE = #FORTRAN AND
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:73   

   3930 42 000375   000000 235000 30                 LDA     SUB_LANGUAGE
        42 000376   000002 115007                    CMPA    2,DL
        42 000377   000442 601000 42                 TNZ     s:3945
        42 000400   200012 236100                    LDQ     ERROR_ALIAS,,AUTO
        42 000401   000442 600000 42                 TZE     s:3945

      260     3931    5                          ERROR_ALIAS >0
      261     3932    6                       THEN DO;

      262     3933    6                           CALL SET_FIELDS(1,30,ALIAS_DESC.S.QUAL);

   3933 42 000402   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000403   000001 036003                    ADLQ    1,DU
        42 000404   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 000405   000004 237000 43                 LDAQ    4
        42 000406   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000407   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000410   000000 631400 43                 EPPR1   0
        42 000411   000000 701000 xent               TSX1    SET_FIELDS
        42 000412   000000 011000                    NOP     0

      263     3934    6                           CALL SET_FIELDS(2,30,ALIAS_DESC.S.NAME);

   3934 42 000413   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000414   000054 036000 43                 ADLQ    44
        42 000415   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 000416   000036 237000 43                 LDAQ    30
        42 000417   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000420   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000421   000000 631400 43                 EPPR1   0
        42 000422   000000 701000 xent               TSX1    SET_FIELDS
        42 000423   000000 011000                    NOP     0

      264     3935    6                           CALL SET_FIELDS(3,30,ALIAS_DESC.SS.NAME);

   3935 42 000424   200124 236100                    LDQ     DESCPTR,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:74   
        42 000425   000020 036003                    ADLQ    16,DU
        42 000426   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 000427   000042 237000 43                 LDAQ    34
        42 000430   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 000431   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000432   000000 631400 43                 EPPR1   0
        42 000433   000000 701000 xent               TSX1    SET_FIELDS
        42 000434   000000 011000                    NOP     0

      265     3936    6                           CALL ERROR (#DUP_ALIAS_DATA);

   3936 42 000435   000056 630400 43                 EPPR0   46
        42 000436   000003 631400 43                 EPPR1   3
        42 000437   000000 701000 xent               TSX1    ERROR
        42 000440   000000 011000                    NOP     0

      266     3937        /*E*     ERROR:    ZIG-#DUP_ALIAS_DATA-C
      267     3938        MESSAGE: The fatal error occurred on the processing of the alias data
      268     3939                 names; for the record "%U1" and the field "%U2" there are
      269     3940                 duplicate aliases. The one aliased to %U3 will be
      270     3941                 deleted!
      271     3942        */
      272     3943    6                           END;

   3943 42 000441   000560 710000 42                 TRA     s:3966

      273     3944    6                       ELSE DO;

      274     3945    6                           CALL CHECK_CHAR_SET(ALIAS_DESC.S.NAME,

   3945 42 000442   200164 630500                    EPPR0   POSITION,,AUTO
        42 000443   200325 450500                    STP0    @MUST_ALIAS+1,,AUTO
        42 000444   200012 631500                    EPPR1   ERROR_ALIAS,,AUTO
        42 000445   200324 451500                    STP1    @WORD_TO_TRAN+1,,AUTO
        42 000446   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000447   000054 036000 43                 ADLQ    44
        42 000450   200323 756100                    STQ     I+64,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:75   
        42 000451   005631 701000 42                 TSX1    CHECK_CHAR_SET
        42 000452   000000 011000                    NOP     0

      275     3946    6                              ERROR_ALIAS,POSITION);
      276     3947    6                           IF ALIAS_DESC.TYPE = 5 AND ALIAS_DESC.S.QUAL = ' '

   3947 42 000453   200124 470500                    LDP0    DESCPTR,,AUTO
        42 000454   000000 235100                    LDA     0,,PR0
        42 000455   000005 115007                    CMPA    5,DL
        42 000456   000466 601000 42                 TNZ     s:3949
        42 000457   040000 106500                    CMPC    fill='040'O
        42 000460   000001 000036                    ADSC9   1,,PR0                   cn=0,n=30
        42 000461   000057 000001 43                 ADSC9   47                       cn=0,n=1
        42 000462   000466 601000 42                 TNZ     s:3949

      277     3948    6                           THEN TYPE_OF_ALIAS = 6;

   3948 42 000463   000006 236007                    LDQ     6,DL
        42 000464   200013 756100                    STQ     TYPE_OF_ALIAS,,AUTO
        42 000465   000467 710000 42                 TRA     s:3950

      278     3949    6                           ELSE TYPE_OF_ALIAS = ALIAS_DESC.TYPE;

   3949 42 000466   200013 755100                    STA     TYPE_OF_ALIAS,,AUTO

      279     3950    6                           HASH_SCHEMA_NAME = '1'B;

   3950 42 000467   400000 236003                    LDQ     -131072,DU
        42 000470   000000 756000 33                 STQ     HASH_SCHEMA_NAME

      280     3951    6                           CALL ZIG$HASH_IT(ALIAS_DESC.S.NAME,#ADD,

   3951 42 000471   200135 631500                    EPPR1   STATUS,,AUTO
        42 000472   200401 451500                    STP1    @ERROR_ARRAY+8,,AUTO
        42 000473   200165 633500                    EPPR3   NPTR$,,AUTO
        42 000474   200400 453500                    STP3    @ERROR_ARRAY+7,,AUTO
        42 000475   000062 237000 43                 LDAQ    50
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:76   
        42 000476   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 000477   200013 634500                    EPPR4   TYPE_OF_ALIAS,,AUTO
        42 000500   200375 454500                    STP4    @ERROR_ARRAY+4,,AUTO
        42 000501   200012 635500                    EPPR5   ERROR_ALIAS,,AUTO
        42 000502   200374 455500                    STP5    @ERROR_ARRAY+3,,AUTO
        42 000503   000033 236000 43                 LDQ     27
        42 000504   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 000505   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000506   000054 036000 43                 ADLQ    44
        42 000507   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000510   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000511   000046 631400 43                 EPPR1   38
        42 000512   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 000513   000000 011000                    NOP     0

      281     3952    6                              ERROR_ALIAS,TYPE_OF_ALIAS,2,11,NPTR$,
      282     3953    6                              STATUS);
      283     3954    6                           NPTR$ -> H_ALIAS.SUB$ = NEW_ALIAS_PTR$;

   3954 42 000514   200165 470500                    LDP0    NPTR$,,AUTO
        42 000515   000100 100500                    MLR     fill='000'O
        42 000516   200011 000004                    ADSC9   NEW_ALIAS_PTR$,,AUTO     cn=0,n=4
        42 000517   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4

      284     3955    6                           IF TYPE_OF_ALIAS = 5

   3955 42 000520   200013 235100                    LDA     TYPE_OF_ALIAS,,AUTO
        42 000521   000005 115007                    CMPA    5,DL
        42 000522   000552 601000 42                 TNZ     s:3962

      285     3956    7                           THEN DO;

      286     3957    7                               HASH_SCHEMA_NAME = '1'B;

   3957 42 000523   400000 236003                    LDQ     -131072,DU
        42 000524   000000 756000 33                 STQ     HASH_SCHEMA_NAME

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:77   
      287     3958    7                               CALL ZIG$HASH_IT(ALIAS_DESC.S.QUAL,#NO_ADD,

   3958 42 000525   200205 630500                    EPPR0   TEMP_STATUS,,AUTO
        42 000526   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
        42 000527   200165 236100                    LDQ     NPTR$,,AUTO
        42 000530   000012 036003                    ADLQ    10,DU
        42 000531   200400 756100                    STQ     @ERROR_ARRAY+7,,AUTO
        42 000532   000064 237000 43                 LDAQ    52
        42 000533   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 000534   000066 236000 43                 LDQ     54
        42 000535   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 000536   200012 631500                    EPPR1   ERROR_ALIAS,,AUTO
        42 000537   200374 451500                    STP1    @ERROR_ARRAY+3,,AUTO
        42 000540   000004 236000 43                 LDQ     4
        42 000541   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 000542   200124 236100                    LDQ     DESCPTR,,AUTO
        42 000543   000001 036003                    ADLQ    1,DU
        42 000544   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000545   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000546   000046 631400 43                 EPPR1   38
        42 000547   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 000550   000000 011000                    NOP     0

      288     3959    7                                  ERROR_ALIAS,7,2,9,NPTR$ ->
      289     3960    7                                  H_ALIAS.QUAL$,TEMP_STATUS);
      290     3961    7                               END;

   3961 42 000551   000560 710000 42                 TRA     s:3966

      291     3962    6                           ELSE NPTR$ -> H_ALIAS.QUAL$ = ADDR(NIL);

   3962 42 000552   000067 236000 43                 LDQ     55
        42 000553   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000554   200165 470500                    LDP0    NPTR$,,AUTO
        42 000555   000100 100500                    MLR     fill='000'O
        42 000556   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 000557   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:78   

      292     3963    6                           END;

      293     3964    5                       END;

      294     3965    4                   END;

      295     3966    3               CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);

   3966 42 000560   200007 630500                    EPPR0   BUFFER_SIZE,,AUTO
        42 000561   200375 450500                    STP0    @ERROR_ARRAY+4,,AUTO
        42 000562   200123 631500                    EPPR1   EOF,,AUTO
        42 000563   200374 451500                    STP1    @ERROR_ARRAY+3,,AUTO
        42 000564   200124 633500                    EPPR3   DESCPTR,,AUTO
        42 000565   200373 453500                    STP3    @ERROR_ARRAY+2,,AUTO
        42 000566   000032 236000 43                 LDQ     26
        42 000567   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000570   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 000571   000034 631400 43                 EPPR1   28
        42 000572   000000 701000 xent               TSX1    UGET
        42 000573   000000 011000                    NOP     0

      296     3967    3               END;

   3967 42 000574   200123 235100                    LDA     EOF,,AUTO
        42 000575   000231 600000 42                 TZE     s:3898

      297     3968    2           CALL UCLOSE('5*');

   3968 42 000576   000032 630400 43                 EPPR0   26
        42 000577   000003 631400 43                 EPPR1   3
        42 000600   000000 701000 xent               TSX1    UCLOSE
        42 000601   000000 011000                    NOP     0

      298     3969    2           END;

      299     3970    1       CALL UOPEN('5*',1);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:79   

   3970 42 000602   000070 630400 43                 EPPR0   56
        42 000603   000011 631400 43                 EPPR1   9
        42 000604   000000 701000 xent               TSX1    UOPEN
        42 000605   000000 011000                    NOP     0

      300     3971        /*
      301     3972            Now start the generation of the structure division.
      302     3973            The part that has the areas name, set names, record and item
      303     3974            names.
      304     3975
      305     3976            These are generated first so and conficts can be resolved by
      306     3977            alias generated by the generate process.
      307     3978
      308     3979            Things are first written to the 5* file then the alias are
      309     3980            generated for the whole subschema. Then everying is written
      310     3981            through M$LO and M$SO.
      311     3982        */
      312     3983    1       CALL FETCHD_6('SN  ',UWA.DA.FRST_AC);

   3983 42 000606   000072 630400 43                 EPPR0   58
        42 000607   000011 631400 43                 EPPR1   9
        42 000610   000000 701000 xent               TSX1    FETCHD_6
        42 000611   000000 011000                    NOP     0

      313     3984    1       STATUS = #IN_AREA_PROCESSING;

   3984 42 000612   010000 236003                    LDQ     4096,DU
        42 000613   200135 756100                    STQ     STATUS,,AUTO

      314     3985    1       TITLE = '       STRUCTURE DIVISION.';

   3985 42 000614   040100 100400                    MLR     fill='040'O
        42 000615   000023 000032 41                 ADSC9   19                       cn=0,n=26
        42 000616   200014 000120                    ADSC9   TITLE,,AUTO              cn=0,n=80

      315     3986    1       IF SUB_LANGUAGE=#COBOL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:80   

   3986 42 000617   000000 235000 30                 LDA     SUB_LANGUAGE
        42 000620   000001 115007                    CMPA    1,DL
        42 000621   000631 601000 42                 TNZ     s:3991

      316     3987    2       THEN DO;

      317     3988    2           TITLE='       STRUCTURE DIVISION.';

   3988 42 000622   040100 100400                    MLR     fill='040'O
        42 000623   000023 000032 41                 ADSC9   19                       cn=0,n=26
        42 000624   200014 000120                    ADSC9   TITLE,,AUTO              cn=0,n=80

      318     3989    2           CALL STORE(TITLE);

   3989 42 000625   200014 630500                    EPPR0   TITLE,,AUTO
        42 000626   200221 450500                    STP0    J+1,,AUTO
        42 000627   002166 701000 42                 TSX1    STORE
        42 000630   000000 011000                    NOP     0

      319     3990    2           END;

      320     3991    1       IF UWA.SN.SETYPE = 20 /*AREA TYPE */

   3991 42 000631   000424 235000 0                  LDA     UWA+276
        42 000632   000024 115007                    CMPA    20,DL
        42 000633   001015 601000 42                 TNZ     s:4035

      321     3992    2       THEN DO;

      322     3993    2           IF SUB_LANGUAGE=#COBOL

   3993 42 000634   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 000635   000001 116007                    CMPQ    1,DL
        42 000636   000647 601000 42                 TNZ     s:3999

      323     3994    3           THEN DO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:81   

      324     3995    3               SUB_TITLE='       REALM SECTION.';

   3995 42 000637   040100 100400                    MLR     fill='040'O
        42 000640   000032 000025 41                 ADSC9   26                       cn=0,n=21
        42 000641   200040 000120                    ADSC9   SUB_TITLE,,AUTO          cn=0,n=80

      325     3996    3               CALL STORE(SUB_TITLE);

   3996 42 000642   200040 630500                    EPPR0   SUB_TITLE,,AUTO
        42 000643   200221 450500                    STP0    J+1,,AUTO
        42 000644   002166 701000 42                 TSX1    STORE
        42 000645   000000 011000                    NOP     0

      326     3997    3               END;

   3997 42 000646   000656 710000 42                 TRA     s:4002

      327     3998    3           ELSE DO;

      328     3999    3               SUB_TITLE='      REALM =';

   3999 42 000647   040100 100400                    MLR     fill='040'O
        42 000650   000040 000015 41                 ADSC9   32                       cn=0,n=13
        42 000651   200040 000120                    ADSC9   SUB_TITLE,,AUTO          cn=0,n=80

      329     4000    3               CALL STORE(SUB_TITLE);

   4000 42 000652   200040 630500                    EPPR0   SUB_TITLE,,AUTO
        42 000653   200221 450500                    STP0    J+1,,AUTO
        42 000654   002166 701000 42                 TSX1    STORE
        42 000655   000000 011000                    NOP     0

      330     4001    3               END;

      331     4002    3           DO WHILE (UWA.SN.SETYPE=20 AND UWA.DB_STATUS = '0000000');/* AREA TYPES */

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:82   
   4002 42 000656   001006 710000 42                 TRA     CONT_AREAS

      332     4003    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*'

   4003 42 000657   000427 236000 0                  LDQ     UWA+279
        42 000660   777000 376003                    ANQ     -512,DU
        42 000661   052000 116003                    CMPQ    21504,DU
        42 000662   001002 600000 42                 TZE     s:4028

      333     4004    4               THEN DO;

      334     4005    4                   CALL CHECK_ALIAS(UWA.SN.SENAME);

   4005 42 000663   000074 236000 43                 LDQ     60
        42 000664   200221 756100                    STQ     J+1,,AUTO
        42 000665   005421 701000 42                 TSX1    CHECK_ALIAS
        42 000666   000000 011000                    NOP     0

      335     4006    4                   IF SUB_LANGUAGE=#COBOL

   4006 42 000667   000000 235000 30                 LDA     SUB_LANGUAGE
        42 000670   000001 115007                    CMPA    1,DL
        42 000671   000712 601000 42                 TNZ     s:4012

      336     4007    5                   THEN DO;

      337     4008    5                       CALL CONCAT(OUTPUT_REC,'         RD ',SUBSTR(

   4008 42 000672   040100 100400                    MLR     fill='040'O
        42 000673   000044 000014 41                 ADSC9   36                       cn=0,n=12
        42 000674   200064 000014                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=12
        42 000675   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 000676   040100 100540                    MLR     fill='040'O
        42 000677   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 000700   200067 000104                    ADSC9   OUTPUT_REC+3,,AUTO       cn=0,n=68
        42 000701   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 000702   000104 116007                    CMPQ    68,DL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:83   
        42 000703   000711 603000 42                 TRC     s:4010
        42 000704   777673 621006                    EAX1    -69,QL
        42 000705   777777 661003                    ERX1    -1,DU
        42 000706   040146 100400                    MLR     fill='040'O
        42 000707   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 000710   200067 000011                    ADSC9   OUTPUT_REC+3,Q,AUTO      cn=0,n=*X1

      338     4009    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      339     4010    5                       END;

   4010 42 000711   000731 710000 42                 TRA     s:4015

      340     4011    5                   ELSE DO;

      341     4012    5                       CALL CONCAT(OUTPUT_REC,'             ',SUBSTR(

   4012 42 000712   040100 100400                    MLR     fill='040'O
        42 000713   000047 000015 41                 ADSC9   39                       cn=0,n=13
        42 000714   200064 000015                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=13
        42 000715   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 000716   040100 100540                    MLR     fill='040'O
        42 000717   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 000720   200067 200103                    ADSC9   OUTPUT_REC+3,,AUTO       cn=1,n=67
        42 000721   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 000722   000103 116007                    CMPQ    67,DL
        42 000723   000731 603000 42                 TRC     s:4015
        42 000724   777674 621006                    EAX1    -68,QL
        42 000725   777777 661003                    ERX1    -1,DU
        42 000726   040146 100400                    MLR     fill='040'O
        42 000727   000076 000001 43                 ADSC9   62                       cn=0,n=1
        42 000730   200067 200011                    ADSC9   OUTPUT_REC+3,Q,AUTO      cn=1,n=*X1

      342     4013    5                          REAL_NAME,0,LEN_REAL_NAME),',');
      343     4014    5                       END;

      344     4015    4                   CALL FETCHNS_6('DA-SN   ') ALTRET (END_OF_AREA);

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:84   
   4015 42 000731   000077 630400 43                 EPPR0   63
        42 000732   000003 631400 43                 EPPR1   3
        42 000733   000000 701000 xent               TSX1    FETCHNS_6
        42 000734   000735 702000 42                 TSX2    END_OF_AREA

      345     4016    4   END_OF_AREA:
      346     4017    4                   IF UWA.DB_STATUS = '0502100' | UWA.SN.SETYPE ~= 20

   4017 42 000735   400000 220003       END_OF_AREA  LDX0    -131072,DU
        42 000736   040000 106400                    CMPC    fill='040'O
        42 000737   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 000740   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 000741   000743 600000 42                 TZE     END_OF_AREA+6
        42 000742   000000 220003                    LDX0    0,DU
        42 000743   400000 221003                    LDX1    -131072,DU
        42 000744   000424 235000 0                  LDA     UWA+276
        42 000745   000024 115007                    CMPA    20,DL
        42 000746   000750 601000 42                 TNZ     END_OF_AREA+11
        42 000747   000000 221003                    LDX1    0,DU
        42 000750   000000 636011                    EAQ     0,X1
        42 000751   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 000752   000000 636010                    EAQ     0,X0
        42 000753   200372 276100                    ORQ     @ERROR_ARRAY+1,,AUTO
        42 000754   000770 600000 42                 TZE     s:4022

      347     4018    5                   THEN DO;

      348     4019    5                       CALL INDEX1R(I,',',OUTPUT_REC);

   4019 42 000755   000000 125500                    SCMR    mask='000'O
        42 000756   200064 000120                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=80
        42 000757   000076 000001 43                 ADSC9   62                       cn=0,n=1
        42 000760   200110 000100                    ARG     I,,AUTO
        42 000761   000764 606400 42                 TTN     s:4020
        42 000762   000117 236007                    LDQ     79,DL
        42 000763   200110 156100                    SSQ     I,,AUTO

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:85   
      349     4020    5                       CALL INSERT(OUTPUT_REC,I,1,'.');

   4020 42 000764   200110 236100                    LDQ     I,,AUTO
        42 000765   040106 100400                    MLR     fill='040'O
        42 000766   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 000767   200064 000001                    ADSC9   OUTPUT_REC,Q,AUTO        cn=0,n=1

      350     4021    5                       END;

      351     4022    4                   IF SUB_LANGUAGE = #FORTRAN

   4022 42 000770   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 000771   000002 116007                    CMPQ    2,DL
        42 000772   000775 601000 42                 TNZ     s:4026

      352     4023    5                   THEN DO;

      353     4024    5                       CALL INSERT(OUTPUT_REC,5,1,'*');

   4024 42 000773   000052 236003                    LDQ     42,DU
        42 000774   200065 552120                    STBQ    OUTPUT_REC+1,'20'O,AUTO

      354     4025    5                       END;

      355     4026    4                   CALL STORE(OUTPUT_REC);

   4026 42 000775   200064 630500                    EPPR0   OUTPUT_REC,,AUTO
        42 000776   200221 450500                    STP0    J+1,,AUTO
        42 000777   002166 701000 42                 TSX1    STORE
        42 001000   000000 011000                    NOP     0

      356     4027    4                   END;

   4027 42 001001   001006 710000 42                 TRA     CONT_AREAS

      357     4028    3               ELSE CALL FETCHNS_6('DA-SN   ') ALTRET(CONT_AREAS);

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:86   
   4028 42 001002   000077 630400 43                 EPPR0   63
        42 001003   000003 631400 43                 EPPR1   3
        42 001004   000000 701000 xent               TSX1    FETCHNS_6
        42 001005   001006 702000 42                 TSX2    CONT_AREAS

      358     4029    3   CONT_AREAS:
      359     4030    3               END;

   4030 42 001006   000424 235000 0     CONT_AREAS   LDA     UWA+276
        42 001007   000024 115007                    CMPA    20,DL
        42 001010   001015 601000 42                 TNZ     s:4035
        42 001011   040000 106400                    CMPC    fill='040'O
        42 001012   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 001013   000057 000007 41                 ADSC9   47                       cn=0,n=7
        42 001014   000657 600000 42                 TZE     s:4003

      360     4031    2           END;

      361     4032        /*
      362     4033            NOW PROCESS ALL THE SET NAMES IN THE SCHEMA.
      363     4034        */
      364     4035    1       CALL FETCHD_6('SN  ',UWA.DA.FRST_SC);

   4035 42 001015   000100 630400 43                 EPPR0   64
        42 001016   000011 631400 43                 EPPR1   9
        42 001017   000000 701000 xent               TSX1    FETCHD_6
        42 001020   000000 011000                    NOP     0

      365     4036    1       STATUS = #IN_SET_PROCESSING;

   4036 42 001021   020000 236003                    LDQ     8192,DU
        42 001022   200135 756100                    STQ     STATUS,,AUTO

      366     4037    2       DO WHILE (UWA.SN.SETYPE = 30 AND SUBSTR(UWA.SN.SENAME,0,1) = '*');

   4037 42 001023   001030 710000 42                 TRA     s:4039

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:87   
      367     4038    2           CALL FETCHNS_6('DA-SN   ') ALTRET(NO_SETS);

   4038 42 001024   000077 630400 43                 EPPR0   63
        42 001025   000003 631400 43                 EPPR1   3
        42 001026   000000 701000 xent               TSX1    FETCHNS_6
        42 001027   001222 702000 42                 TSX2    NO_SETS

      368     4039    2           END;

   4039 42 001030   000424 235000 0                  LDA     UWA+276
        42 001031   000036 115007                    CMPA    30,DL
        42 001032   001037 601000 42                 TNZ     s:4040
        42 001033   000427 236000 0                  LDQ     UWA+279
        42 001034   777000 376003                    ANQ     -512,DU
        42 001035   052000 116003                    CMPQ    21504,DU
        42 001036   001024 600000 42                 TZE     s:4038

      369     4040    1       IF UWA.SN.SETYPE = 30

   4040 42 001037   000036 115007                    CMPA    30,DL
        42 001040   001222 601000 42                 TNZ     NO_SETS

      370     4041    2       THEN DO;

      371     4042    2           IF SUB_LANGUAGE=#COBOL

   4042 42 001041   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 001042   000001 116007                    CMPQ    1,DL
        42 001043   001054 601000 42                 TNZ     s:4048

      372     4043    3           THEN DO;

      373     4044    3               SUB_TITLE='       SET SECTION.';

   4044 42 001044   040100 100400                    MLR     fill='040'O
        42 001045   000061 000023 41                 ADSC9   49                       cn=0,n=19
        42 001046   200040 000120                    ADSC9   SUB_TITLE,,AUTO          cn=0,n=80
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:88   

      374     4045    3               CALL STORE(SUB_TITLE);

   4045 42 001047   200040 630500                    EPPR0   SUB_TITLE,,AUTO
        42 001050   200221 450500                    STP0    J+1,,AUTO
        42 001051   002166 701000 42                 TSX1    STORE
        42 001052   000000 011000                    NOP     0

      375     4046    3               END;

   4046 42 001053   001063 710000 42                 TRA     s:4051

      376     4047    3           ELSE DO;

      377     4048    3               SUB_TITLE='      SET =';

   4048 42 001054   040100 100400                    MLR     fill='040'O
        42 001055   000066 000013 41                 ADSC9   54                       cn=0,n=11
        42 001056   200040 000120                    ADSC9   SUB_TITLE,,AUTO          cn=0,n=80

      378     4049    3               CALL STORE(SUB_TITLE);

   4049 42 001057   200040 630500                    EPPR0   SUB_TITLE,,AUTO
        42 001060   200221 450500                    STP0    J+1,,AUTO
        42 001061   002166 701000 42                 TSX1    STORE
        42 001062   000000 011000                    NOP     0

      379     4050    3               END;

      380     4051    3           DO WHILE (UWA.SN.SETYPE=30 AND UWA.DB_STATUS = '0000000');/* SETS TYPES */

   4051 42 001063   001213 710000 42                 TRA     CONT_SETS

      381     4052    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*'

   4052 42 001064   000427 236000 0                  LDQ     UWA+279
        42 001065   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:89   
        42 001066   052000 116003                    CMPQ    21504,DU
        42 001067   001207 600000 42                 TZE     s:4077

      382     4053    4               THEN DO;

      383     4054    4                   CALL CHECK_ALIAS(UWA.SN.SENAME);

   4054 42 001070   000074 236000 43                 LDQ     60
        42 001071   200221 756100                    STQ     J+1,,AUTO
        42 001072   005421 701000 42                 TSX1    CHECK_ALIAS
        42 001073   000000 011000                    NOP     0

      384     4055    4                   IF SUB_LANGUAGE=#COBOL

   4055 42 001074   000000 235000 30                 LDA     SUB_LANGUAGE
        42 001075   000001 115007                    CMPA    1,DL
        42 001076   001117 601000 42                 TNZ     s:4061

      385     4056    5                   THEN DO;

      386     4057    5                       CALL CONCAT(OUTPUT_REC,'         SD ',SUBSTR(

   4057 42 001077   040100 100400                    MLR     fill='040'O
        42 001100   000071 000014 41                 ADSC9   57                       cn=0,n=12
        42 001101   200064 000014                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=12
        42 001102   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 001103   040100 100540                    MLR     fill='040'O
        42 001104   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 001105   200067 000104                    ADSC9   OUTPUT_REC+3,,AUTO       cn=0,n=68
        42 001106   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 001107   000104 116007                    CMPQ    68,DL
        42 001110   001116 603000 42                 TRC     s:4059
        42 001111   777673 621006                    EAX1    -69,QL
        42 001112   777777 661003                    ERX1    -1,DU
        42 001113   040146 100400                    MLR     fill='040'O
        42 001114   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 001115   200067 000011                    ADSC9   OUTPUT_REC+3,Q,AUTO      cn=0,n=*X1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:90   

      387     4058    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      388     4059    5                       END;

   4059 42 001116   001136 710000 42                 TRA     s:4064

      389     4060    5                   ELSE DO;

      390     4061    5                       CALL CONCAT(OUTPUT_REC,'            ',SUBSTR(

   4061 42 001117   040100 100400                    MLR     fill='040'O
        42 001120   000047 000014 41                 ADSC9   39                       cn=0,n=12
        42 001121   200064 000014                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=12
        42 001122   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 001123   040100 100540                    MLR     fill='040'O
        42 001124   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 001125   200067 000104                    ADSC9   OUTPUT_REC+3,,AUTO       cn=0,n=68
        42 001126   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 001127   000104 116007                    CMPQ    68,DL
        42 001130   001136 603000 42                 TRC     s:4064
        42 001131   777673 621006                    EAX1    -69,QL
        42 001132   777777 661003                    ERX1    -1,DU
        42 001133   040146 100400                    MLR     fill='040'O
        42 001134   000076 000001 43                 ADSC9   62                       cn=0,n=1
        42 001135   200067 000011                    ADSC9   OUTPUT_REC+3,Q,AUTO      cn=0,n=*X1

      391     4062    5                          REAL_NAME,0,LEN_REAL_NAME),',');
      392     4063    5                       END;

      393     4064    4                   CALL FETCHNS_6('DA-SN   ') ALTRET (END_OF_SETS);

   4064 42 001136   000077 630400 43                 EPPR0   63
        42 001137   000003 631400 43                 EPPR1   3
        42 001140   000000 701000 xent               TSX1    FETCHNS_6
        42 001141   001142 702000 42                 TSX2    END_OF_SETS

      394     4065    4   END_OF_SETS:
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:91   
      395     4066    4                   IF UWA.DB_STATUS = '0502100' | UWA.SN.SETYPE ~= 30

   4066 42 001142   400000 220003       END_OF_SETS  LDX0    -131072,DU
        42 001143   040000 106400                    CMPC    fill='040'O
        42 001144   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 001145   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 001146   001150 600000 42                 TZE     END_OF_SETS+6
        42 001147   000000 220003                    LDX0    0,DU
        42 001150   400000 221003                    LDX1    -131072,DU
        42 001151   000424 235000 0                  LDA     UWA+276
        42 001152   000036 115007                    CMPA    30,DL
        42 001153   001155 601000 42                 TNZ     END_OF_SETS+11
        42 001154   000000 221003                    LDX1    0,DU
        42 001155   000000 636011                    EAQ     0,X1
        42 001156   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 001157   000000 636010                    EAQ     0,X0
        42 001160   200372 276100                    ORQ     @ERROR_ARRAY+1,,AUTO
        42 001161   001175 600000 42                 TZE     s:4071

      396     4067    5                   THEN DO;

      397     4068    5                       CALL INDEX1R(I,',',OUTPUT_REC);

   4068 42 001162   000000 125500                    SCMR    mask='000'O
        42 001163   200064 000120                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=80
        42 001164   000076 000001 43                 ADSC9   62                       cn=0,n=1
        42 001165   200110 000100                    ARG     I,,AUTO
        42 001166   001171 606400 42                 TTN     s:4069
        42 001167   000117 236007                    LDQ     79,DL
        42 001170   200110 156100                    SSQ     I,,AUTO

      398     4069    5                       CALL INSERT(OUTPUT_REC,I,1,'.');

   4069 42 001171   200110 236100                    LDQ     I,,AUTO
        42 001172   040106 100400                    MLR     fill='040'O
        42 001173   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 001174   200064 000001                    ADSC9   OUTPUT_REC,Q,AUTO        cn=0,n=1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:92   

      399     4070    5                       END;

      400     4071    4                   IF SUB_LANGUAGE = #FORTRAN

   4071 42 001175   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 001176   000002 116007                    CMPQ    2,DL
        42 001177   001202 601000 42                 TNZ     s:4075

      401     4072    5                   THEN DO;

      402     4073    5                       CALL INSERT(OUTPUT_REC,5,1,'*');

   4073 42 001200   000052 236003                    LDQ     42,DU
        42 001201   200065 552120                    STBQ    OUTPUT_REC+1,'20'O,AUTO

      403     4074    5                       END;

      404     4075    4                   CALL STORE(OUTPUT_REC);

   4075 42 001202   200064 630500                    EPPR0   OUTPUT_REC,,AUTO
        42 001203   200221 450500                    STP0    J+1,,AUTO
        42 001204   002166 701000 42                 TSX1    STORE
        42 001205   000000 011000                    NOP     0

      405     4076    4                   END;

   4076 42 001206   001213 710000 42                 TRA     CONT_SETS

      406     4077    3               ELSE CALL FETCHNS_6('DA-SN   ') ALTRET(CONT_SETS);

   4077 42 001207   000077 630400 43                 EPPR0   63
        42 001210   000003 631400 43                 EPPR1   3
        42 001211   000000 701000 xent               TSX1    FETCHNS_6
        42 001212   001213 702000 42                 TSX2    CONT_SETS

      407     4078    3   CONT_SETS:
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:93   
      408     4079    3               END;

   4079 42 001213   000424 235000 0     CONT_SETS    LDA     UWA+276
        42 001214   000036 115007                    CMPA    30,DL
        42 001215   001222 601000 42                 TNZ     NO_SETS
        42 001216   040000 106400                    CMPC    fill='040'O
        42 001217   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 001220   000057 000007 41                 ADSC9   47                       cn=0,n=7
        42 001221   001064 600000 42                 TZE     s:4052

      409     4080    2           END;

      410     4081        /*
      411     4082            NOW GENERATE ALL THE KEYS THAT GO IN THE KEY SECTION.
      412     4083        */
      413     4084    1   NO_SETS:
      414     4085    1       STATUS = #IN_KEY_PROCESSING;

   4085 42 001222   030000 236003       NO_SETS      LDQ     12288,DU
        42 001223   200135 756100                    STQ     STATUS,,AUTO

      415     4086    1       CALL FETCHD_6('SN  ',UWA.DA.FRST_KC);

   4086 42 001224   000102 630400 43                 EPPR0   66
        42 001225   000011 631400 43                 EPPR1   9
        42 001226   000000 701000 xent               TSX1    FETCHD_6
        42 001227   000000 011000                    NOP     0

      416     4087    1       IF UWA.SN.SETYPE = 31

   4087 42 001230   000424 235000 0                  LDA     UWA+276
        42 001231   000037 115007                    CMPA    31,DL
        42 001232   001414 601000 42                 TNZ     s:4131

      417     4088    2       THEN DO;

      418     4089    2           IF SUB_LANGUAGE=#COBOL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:94   

   4089 42 001233   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 001234   000001 116007                    CMPQ    1,DL
        42 001235   001246 601000 42                 TNZ     s:4095

      419     4090    3           THEN DO;

      420     4091    3               SUB_TITLE='       KEY SECTION.';

   4091 42 001236   040100 100400                    MLR     fill='040'O
        42 001237   000074 000023 41                 ADSC9   60                       cn=0,n=19
        42 001240   200040 000120                    ADSC9   SUB_TITLE,,AUTO          cn=0,n=80

      421     4092    3               CALL STORE(SUB_TITLE);

   4092 42 001241   200040 630500                    EPPR0   SUB_TITLE,,AUTO
        42 001242   200221 450500                    STP0    J+1,,AUTO
        42 001243   002166 701000 42                 TSX1    STORE
        42 001244   000000 011000                    NOP     0

      422     4093    3               END;

   4093 42 001245   001255 710000 42                 TRA     s:4098

      423     4094    3           ELSE DO;

      424     4095    3               SUB_TITLE='      KEY =';

   4095 42 001246   040100 100400                    MLR     fill='040'O
        42 001247   000101 000013 41                 ADSC9   65                       cn=0,n=11
        42 001250   200040 000120                    ADSC9   SUB_TITLE,,AUTO          cn=0,n=80

      425     4096    3               CALL STORE(SUB_TITLE);

   4096 42 001251   200040 630500                    EPPR0   SUB_TITLE,,AUTO
        42 001252   200221 450500                    STP0    J+1,,AUTO
        42 001253   002166 701000 42                 TSX1    STORE
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:95   
        42 001254   000000 011000                    NOP     0

      426     4097    3               END;

      427     4098    3           DO WHILE (UWA.SN.SETYPE=31 AND UWA.DB_STATUS = '0000000');/* KEYS TYPES */

   4098 42 001255   001405 710000 42                 TRA     CONT_KEYS

      428     4099    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*'

   4099 42 001256   000427 236000 0                  LDQ     UWA+279
        42 001257   777000 376003                    ANQ     -512,DU
        42 001260   052000 116003                    CMPQ    21504,DU
        42 001261   001401 600000 42                 TZE     s:4124

      429     4100    4               THEN DO;

      430     4101    4                   CALL CHECK_ALIAS(UWA.SN.SENAME);

   4101 42 001262   000074 236000 43                 LDQ     60
        42 001263   200221 756100                    STQ     J+1,,AUTO
        42 001264   005421 701000 42                 TSX1    CHECK_ALIAS
        42 001265   000000 011000                    NOP     0

      431     4102    4                   IF SUB_LANGUAGE=#COBOL

   4102 42 001266   000000 235000 30                 LDA     SUB_LANGUAGE
        42 001267   000001 115007                    CMPA    1,DL
        42 001270   001311 601000 42                 TNZ     s:4108

      432     4103    5                   THEN DO;

      433     4104    5                       CALL CONCAT(OUTPUT_REC,'         KD ',SUBSTR(

   4104 42 001271   040100 100400                    MLR     fill='040'O
        42 001272   000104 000014 41                 ADSC9   68                       cn=0,n=12
        42 001273   200064 000014                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=12
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:96   
        42 001274   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 001275   040100 100540                    MLR     fill='040'O
        42 001276   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 001277   200067 000104                    ADSC9   OUTPUT_REC+3,,AUTO       cn=0,n=68
        42 001300   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 001301   000104 116007                    CMPQ    68,DL
        42 001302   001310 603000 42                 TRC     s:4106
        42 001303   777673 621006                    EAX1    -69,QL
        42 001304   777777 661003                    ERX1    -1,DU
        42 001305   040146 100400                    MLR     fill='040'O
        42 001306   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 001307   200067 000011                    ADSC9   OUTPUT_REC+3,Q,AUTO      cn=0,n=*X1

      434     4105    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      435     4106    5                       END;

   4106 42 001310   001330 710000 42                 TRA     s:4111

      436     4107    5                   ELSE DO;

      437     4108    5                       CALL CONCAT(OUTPUT_REC,'             ',SUBSTR(

   4108 42 001311   040100 100400                    MLR     fill='040'O
        42 001312   000047 000015 41                 ADSC9   39                       cn=0,n=13
        42 001313   200064 000015                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=13
        42 001314   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 001315   040100 100540                    MLR     fill='040'O
        42 001316   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 001317   200067 200103                    ADSC9   OUTPUT_REC+3,,AUTO       cn=1,n=67
        42 001320   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 001321   000103 116007                    CMPQ    67,DL
        42 001322   001330 603000 42                 TRC     s:4111
        42 001323   777674 621006                    EAX1    -68,QL
        42 001324   777777 661003                    ERX1    -1,DU
        42 001325   040146 100400                    MLR     fill='040'O
        42 001326   000076 000001 43                 ADSC9   62                       cn=0,n=1
        42 001327   200067 200011                    ADSC9   OUTPUT_REC+3,Q,AUTO      cn=1,n=*X1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:97   

      438     4109    5                          REAL_NAME,0,LEN_REAL_NAME),',');
      439     4110    5                       END;

      440     4111    4                   CALL FETCHNS_6('DA-SN   ') ALTRET (END_OF_KEYS);

   4111 42 001330   000077 630400 43                 EPPR0   63
        42 001331   000003 631400 43                 EPPR1   3
        42 001332   000000 701000 xent               TSX1    FETCHNS_6
        42 001333   001334 702000 42                 TSX2    END_OF_KEYS

      441     4112    4   END_OF_KEYS:
      442     4113    4                   IF UWA.DB_STATUS = '0502100' | UWA.SN.SETYPE ~= 31

   4113 42 001334   400000 220003       END_OF_KEYS  LDX0    -131072,DU
        42 001335   040000 106400                    CMPC    fill='040'O
        42 001336   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 001337   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 001340   001342 600000 42                 TZE     END_OF_KEYS+6
        42 001341   000000 220003                    LDX0    0,DU
        42 001342   400000 221003                    LDX1    -131072,DU
        42 001343   000424 235000 0                  LDA     UWA+276
        42 001344   000037 115007                    CMPA    31,DL
        42 001345   001347 601000 42                 TNZ     END_OF_KEYS+11
        42 001346   000000 221003                    LDX1    0,DU
        42 001347   000000 636011                    EAQ     0,X1
        42 001350   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 001351   000000 636010                    EAQ     0,X0
        42 001352   200372 276100                    ORQ     @ERROR_ARRAY+1,,AUTO
        42 001353   001367 600000 42                 TZE     s:4118

      443     4114    5                   THEN DO;

      444     4115    5                       CALL INDEX1R(I,',',OUTPUT_REC);

   4115 42 001354   000000 125500                    SCMR    mask='000'O
        42 001355   200064 000120                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=80
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:98   
        42 001356   000076 000001 43                 ADSC9   62                       cn=0,n=1
        42 001357   200110 000100                    ARG     I,,AUTO
        42 001360   001363 606400 42                 TTN     s:4116
        42 001361   000117 236007                    LDQ     79,DL
        42 001362   200110 156100                    SSQ     I,,AUTO

      445     4116    5                       CALL INSERT(OUTPUT_REC,I,1,'.');

   4116 42 001363   200110 236100                    LDQ     I,,AUTO
        42 001364   040106 100400                    MLR     fill='040'O
        42 001365   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 001366   200064 000001                    ADSC9   OUTPUT_REC,Q,AUTO        cn=0,n=1

      446     4117    5                       END;

      447     4118    4                   IF SUB_LANGUAGE = #FORTRAN

   4118 42 001367   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 001370   000002 116007                    CMPQ    2,DL
        42 001371   001374 601000 42                 TNZ     s:4122

      448     4119    5                   THEN DO;

      449     4120    5                       CALL INSERT(OUTPUT_REC,5,1,'*');

   4120 42 001372   000052 236003                    LDQ     42,DU
        42 001373   200065 552120                    STBQ    OUTPUT_REC+1,'20'O,AUTO

      450     4121    5                       END;

      451     4122    4                   CALL STORE(OUTPUT_REC);

   4122 42 001374   200064 630500                    EPPR0   OUTPUT_REC,,AUTO
        42 001375   200221 450500                    STP0    J+1,,AUTO
        42 001376   002166 701000 42                 TSX1    STORE
        42 001377   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:99   
      452     4123    4                   END;

   4123 42 001400   001405 710000 42                 TRA     CONT_KEYS

      453     4124    3               ELSE CALL FETCHNS_6('DA-SN   ') ALTRET(CONT_KEYS);

   4124 42 001401   000077 630400 43                 EPPR0   63
        42 001402   000003 631400 43                 EPPR1   3
        42 001403   000000 701000 xent               TSX1    FETCHNS_6
        42 001404   001405 702000 42                 TSX2    CONT_KEYS

      454     4125    3   CONT_KEYS:
      455     4126    3               END;

   4126 42 001405   000424 235000 0     CONT_KEYS    LDA     UWA+276
        42 001406   000037 115007                    CMPA    31,DL
        42 001407   001414 601000 42                 TNZ     s:4131
        42 001410   040000 106400                    CMPC    fill='040'O
        42 001411   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 001412   000057 000007 41                 ADSC9   47                       cn=0,n=7
        42 001413   001256 600000 42                 TZE     s:4099

      456     4127    2           END;

      457     4128        /*
      458     4129            NOW GENERATE ALL THE RECORDS AND THE ITEMS UNDER EACH ONE.
      459     4130        */
      460     4131    1       CALL FETCHD_6('SN  ',UWA.DA.FRST_RC);

   4131 42 001414   000104 630400 43                 EPPR0   68
        42 001415   000011 631400 43                 EPPR1   9
        42 001416   000000 701000 xent               TSX1    FETCHD_6
        42 001417   000000 011000                    NOP     0

      461     4132    1       IF UWA.SN.SETYPE = 40

   4132 42 001420   000424 235000 0                  LDA     UWA+276
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:100  
        42 001421   000050 115007                    CMPA    40,DL
        42 001422   001604 601000 42                 TNZ     END_OF_RECORDS

      462     4133    2       THEN DO;

      463     4134    2           IF SUB_LANGUAGE=#COBOL

   4134 42 001423   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 001424   000001 116007                    CMPQ    1,DL
        42 001425   001435 601000 42                 TNZ     s:4139

      464     4135    3           THEN DO;

      465     4136    3               SUB_TITLE='       RECORD SECTION.';

   4136 42 001426   040100 100400                    MLR     fill='040'O
        42 001427   000107 000026 41                 ADSC9   71                       cn=0,n=22
        42 001430   200040 000120                    ADSC9   SUB_TITLE,,AUTO          cn=0,n=80

      466     4137    3               CALL STORE(SUB_TITLE);

   4137 42 001431   200040 630500                    EPPR0   SUB_TITLE,,AUTO
        42 001432   200221 450500                    STP0    J+1,,AUTO
        42 001433   002166 701000 42                 TSX1    STORE
        42 001434   000000 011000                    NOP     0

      467     4138    3               END;

      468     4139    3           DO WHILE (UWA.SN.SETYPE=40) ;/* RECORDS TYPES */

   4139 42 001435   000424 235000 0                  LDA     UWA+276
        42 001436   000050 115007                    CMPA    40,DL
        42 001437   001604 601000 42                 TNZ     END_OF_RECORDS

      469     4140    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*'

   4140 42 001440   000427 236000 0                  LDQ     UWA+279
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:101  
        42 001441   777000 376003                    ANQ     -512,DU
        42 001442   052000 116003                    CMPQ    21504,DU
        42 001443   001575 600000 42                 TZE     s:4169

      470     4141    4               THEN DO;

      471     4142    4                   STATUS = #IN_RECORD_PROCESSING;

   4142 42 001444   040000 236003                    LDQ     16384,DU
        42 001445   200135 756100                    STQ     STATUS,,AUTO

      472     4143    4                   ITEM_NU=ITEM_NU + 1;

   4143 42 001446   000000 235000 39                 LDA     ITEM_NU
        42 001447   000001 035007                    ADLA    1,DL
        42 001450   000000 755000 39                 STA     ITEM_NU

      473     4144    4                   CALL CHECK_ALIAS(UWA.SN.SENAME);

   4144 42 001451   000074 236000 43                 LDQ     60
        42 001452   200221 756100                    STQ     J+1,,AUTO
        42 001453   005421 701000 42                 TSX1    CHECK_ALIAS
        42 001454   000000 011000                    NOP     0

      474     4145    4                   SAVE_RECORD_NAME=UWA.SN.SENAME;

   4145 42 001455   040000 100400                    MLR     fill='040'O
        42 001456   000427 000036 0                  ADSC9   UWA+279                  cn=0,n=30
        42 001457   000000 000036 37                 ADSC9   SAVE_RECORD_NAME         cn=0,n=30

      475     4146    4                   IF SUB_LANGUAGE=#COBOL

   4146 42 001460   000000 235000 30                 LDA     SUB_LANGUAGE
        42 001461   000001 115007                    CMPA    1,DL
        42 001462   001503 601000 42                 TNZ     s:4152

      476     4147    5                   THEN DO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:102  

      477     4148    5                       CALL CONCAT(OUTPUT_REC,'         01 ',SUBSTR(

   4148 42 001463   040100 100400                    MLR     fill='040'O
        42 001464   000115 000014 41                 ADSC9   77                       cn=0,n=12
        42 001465   200064 000014                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=12
        42 001466   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 001467   040100 100540                    MLR     fill='040'O
        42 001470   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 001471   200067 000104                    ADSC9   OUTPUT_REC+3,,AUTO       cn=0,n=68
        42 001472   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 001473   000104 116007                    CMPQ    68,DL
        42 001474   001502 603000 42                 TRC     s:4150
        42 001475   777673 621006                    EAX1    -69,QL
        42 001476   777777 661003                    ERX1    -1,DU
        42 001477   040146 100400                    MLR     fill='040'O
        42 001500   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 001501   200067 000011                    ADSC9   OUTPUT_REC+3,Q,AUTO      cn=0,n=*X1

      478     4149    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      479     4150    5                       END;

   4150 42 001502   001522 710000 42                 TRA     s:4155

      480     4151    5                   ELSE DO;

      481     4152    5                       CALL CONCAT(OUTPUT_REC,'      RECORD 01 ',SUBSTR(

   4152 42 001503   040100 100400                    MLR     fill='040'O
        42 001504   000120 000020 41                 ADSC9   80                       cn=0,n=16
        42 001505   200064 000020                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=16
        42 001506   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 001507   040100 100540                    MLR     fill='040'O
        42 001510   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 001511   200070 000100                    ADSC9   OUTPUT_REC+4,,AUTO       cn=0,n=64
        42 001512   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 001513   000100 116007                    CMPQ    64,DL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:103  
        42 001514   001522 603000 42                 TRC     s:4155
        42 001515   777677 621006                    EAX1    -65,QL
        42 001516   777777 661003                    ERX1    -1,DU
        42 001517   040146 100400                    MLR     fill='040'O
        42 001520   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 001521   200070 000011                    ADSC9   OUTPUT_REC+4,Q,AUTO      cn=0,n=*X1

      482     4153    5                          REAL_NAME,0,LEN_REAL_NAME),'.');
      483     4154    5                       END;

      484     4155    4                   CALL STORE(OUTPUT_REC);

   4155 42 001522   200064 630500                    EPPR0   OUTPUT_REC,,AUTO
        42 001523   200221 450500                    STP0    J+1,,AUTO
        42 001524   002166 701000 42                 TSX1    STORE
        42 001525   000000 011000                    NOP     0

      485     4156    4                   HOLD_DBKEY = UWA.DIRECT_REF;

   4156 42 001526   000036 235000 0                  LDA     UWA+30
        42 001527   200161 755100                    STA     HOLD_DBKEY,,AUTO

      486     4157    4                   CALL FETCHNS_6('SN-SE   ') ALTRET (END_OF_RECORDS);

   4157 42 001530   000021 630400 43                 EPPR0   17
        42 001531   000003 631400 43                 EPPR1   3
        42 001532   000000 701000 xent               TSX1    FETCHNS_6
        42 001533   001604 702000 42                 TSX2    END_OF_RECORDS

      487     4158    4                   IF SUB_LANGUAGE = #COBOL

   4158 42 001534   000000 235000 30                 LDA     SUB_LANGUAGE
        42 001535   000001 115007                    CMPA    1,DL
        42 001536   001542 601000 42                 TNZ     s:4160

      488     4159    4                   THEN CALL GET_COBOL_ITEMS;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:104  
   4159 42 001537   002231 701000 42                 TSX1    GET_COBOL_ITEMS
        42 001540   000000 011000                    NOP     0
        42 001541   001560 710000 42                 TRA     s:4166

      489     4160    4                   ELSE IF SUB_LANGUAGE = #FORTRAN

   4160 42 001542   000002 115007                    CMPA    2,DL
        42 001543   001547 601000 42                 TNZ     s:4162

      490     4161    4                       THEN CALL GET_FORTRAN_ITEMS;

   4161 42 001544   003403 701000 42                 TSX1    GET_FORTRAN_ITEMS
        42 001545   000000 011000                    NOP     0
        42 001546   001560 710000 42                 TRA     s:4166

      491     4162    4                       ELSE IF SUB_LANGUAGE = #APL

   4162 42 001547   000003 115007                    CMPA    3,DL
        42 001550   001554 601000 42                 TNZ     s:4164

      492     4163    4                           THEN CALL GET_APL_ITEMS;

   4163 42 001551   002764 701000 42                 TSX1    GET_APL_ITEMS
        42 001552   000000 011000                    NOP     0
        42 001553   001560 710000 42                 TRA     s:4166

      493     4164    4                           ELSE IF SUB_LANGUAGE = #BASIC

   4164 42 001554   000004 115007                    CMPA    4,DL
        42 001555   001560 601000 42                 TNZ     s:4166

      494     4165    4                               THEN CALL GET_BASIC_ITEMS;

   4165 42 001556   003162 701000 42                 TSX1    GET_BASIC_ITEMS
        42 001557   000000 011000                    NOP     0

      495     4166    4                   CALL FETCHD_6('SN  ',HOLD_DBKEY);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:105  

   4166 42 001560   200161 630500                    EPPR0   HOLD_DBKEY,,AUTO
        42 001561   200373 450500                    STP0    @ERROR_ARRAY+2,,AUTO
        42 001562   000072 236000 43                 LDQ     58
        42 001563   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 001564   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 001565   000011 631400 43                 EPPR1   9
        42 001566   000000 701000 xent               TSX1    FETCHD_6
        42 001567   000000 011000                    NOP     0

      496     4167    4                   CALL FETCHNS_6('DA-SN   ') ALTRET (END_OF_RECORDS);

   4167 42 001570   000077 630400 43                 EPPR0   63
        42 001571   000003 631400 43                 EPPR1   3
        42 001572   000000 701000 xent               TSX1    FETCHNS_6
        42 001573   001604 702000 42                 TSX2    END_OF_RECORDS

      497     4168    4                   END;

   4168 42 001574   001601 710000 42                 TRA     s:4170

      498     4169    3               ELSE CALL FETCHNS_6('DA-SN   ') ALTRET(END_OF_RECORDS);

   4169 42 001575   000077 630400 43                 EPPR0   63
        42 001576   000003 631400 43                 EPPR1   3
        42 001577   000000 701000 xent               TSX1    FETCHNS_6
        42 001600   001604 702000 42                 TSX2    END_OF_RECORDS

      499     4170    3               END;

   4170 42 001601   000424 235000 0                  LDA     UWA+276
        42 001602   000050 115007                    CMPA    40,DL
        42 001603   001440 600000 42                 TZE     s:4140

      500     4171    2   END_OF_RECORDS:
      501     4172    2           END;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:106  
   4172 42 001604                       END_OF_RECO* null
      502     4173    1       CALL UCLOSE ('5*');

   4173 42 001604   000032 630400 43                 EPPR0   26
        42 001605   000003 631400 43                 EPPR1   3
        42 001606   000000 701000 xent               TSX1    UCLOSE
        42 001607   000000 011000                    NOP     0

      503     4174        /*
      504     4175            Every thing has been generated so now go throw things and
      505     4176          find what alias need to be generated.
      506     4177
      507     4178            write out all the aliases then start reading in the 5*
      508     4179          file and write things out to M$SO and M$LO.
      509     4180        */
      510     4181    1       CALL FIND_LENGTH(SSGEN.SNAME,SCHEMA_NAME_LENGHT);

   4181 42 001610   200137 630500                    EPPR0   SCHEMA_NAME_LENGHT,,AUTO
        42 001611   200324 450500                    STP0    @WORD_TO_TRAN+1,,AUTO
        42 001612   000106 236000 43                 LDQ     70
        42 001613   200323 756100                    STQ     I+64,,AUTO
        42 001614   002212 701000 42                 TSX1    FIND_LENGTH
        42 001615   000000 011000                    NOP     0

      511     4182    1       CALL FIND_LENGTH(SSGEN.SSNAME,SUB_NAME_LENGHT);

   4182 42 001616   200136 630500                    EPPR0   SUB_NAME_LENGHT,,AUTO
        42 001617   200324 450500                    STP0    @WORD_TO_TRAN+1,,AUTO
        42 001620   000107 236000 43                 LDQ     71
        42 001621   200323 756100                    STQ     I+64,,AUTO
        42 001622   002212 701000 42                 TSX1    FIND_LENGTH
        42 001623   000000 011000                    NOP     0

      512     4183    1       CALL CHECK_CHAR_SET(SSGEN.SSNAME,ERROR_ALIAS,I);

   4183 42 001624   200110 630500                    EPPR0   I,,AUTO
        42 001625   200325 450500                    STP0    @MUST_ALIAS+1,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:107  
        42 001626   200012 631500                    EPPR1   ERROR_ALIAS,,AUTO
        42 001627   200324 451500                    STP1    @WORD_TO_TRAN+1,,AUTO
        42 001630   000107 236000 43                 LDQ     71
        42 001631   200323 756100                    STQ     I+64,,AUTO
        42 001632   005631 701000 42                 TSX1    CHECK_CHAR_SET
        42 001633   000000 011000                    NOP     0

      513     4184    1       O_REC.W_STATUS=0;

   4184 42 001634   000000 450000 36                 STZ     O_REC

      514     4185    1       CALL CONCAT(O_REC.STRING,'DBACS TRANSLATE ',LANG_TEXT(SUB_LANGUAGE),

   4185 42 001635   040000 100400                    MLR     fill='040'O
        42 001636   000124 000020 41                 ADSC9   84                       cn=0,n=16
        42 001637   000001 000020 36                 ADSC9   O_REC+1                  cn=0,n=16
        42 001640   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 001641   000012 402007                    MPY     10,DL
        42 001642   040000 100406                    MLR     fill='040'O
        42 001643   000000 000012 32                 ADSC9   LANG_TEXT,Q              cn=0,n=10
        42 001644   000005 000012 36                 ADSC9   O_REC+5                  cn=0,n=10
        42 001645   040000 100400                    MLR     fill='040'O
        42 001646   000000 000013 41                 ADSC9   0                        cn=0,n=11
        42 001647   000007 400013 36                 ADSC9   O_REC+7                  cn=2,n=11
        42 001650   200136 720100                    LXL0    SUB_NAME_LENGHT,,AUTO
        42 001651   040000 100440                    MLR     fill='040'O
        42 001652   000003 600010 12                 ADSC9   SSGEN+3                  cn=3,n=*X0
        42 001653   000012 200217 36                 ADSC9   O_REC+10                 cn=1,n=143
        42 001654   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 001655   000217 116007                    CMPQ    143,DL
        42 001656   001664 603000 42                 TRC     s:4187
        42 001657   777560 621006                    EAX1    -144,QL
        42 001660   777777 661003                    ERX1    -1,DU
        42 001661   040046 100400                    MLR     fill='040'O
        42 001662   000130 000010 41                 ADSC9   88                       cn=0,n=8
        42 001663   000012 200011 36                 ADSC9   O_REC+10,Q               cn=1,n=*X1

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:108  
      515     4186    1          ' SUBSCHEMA ',SUBSTR(SSGEN.SSNAME,0,SUB_NAME_LENGHT),' DDL END');
      516     4187    1       CALL WRITER(O_REC.W_STATUS);

   4187 42 001664   000110 236000 43                 LDQ     72
        42 001665   200327 756100                    STQ     I+1,,AUTO
        42 001666   002134 701000 42                 TSX1    WRITER
        42 001667   000000 011000                    NOP     0

      517     4188    1       IF ERROR_ALIAS ~= 0

   4188 42 001670   200012 235100                    LDA     ERROR_ALIAS,,AUTO
        42 001671   001702 600000 42                 TZE     s:4197

      518     4189    2       THEN DO;

      519     4190    2           CALL SET_FIELDS(1,30,SSGEN.SSNAME);

   4190 42 001672   000111 630400 43                 EPPR0   73
        42 001673   000000 631400 43                 EPPR1   0
        42 001674   000000 701000 xent               TSX1    SET_FIELDS
        42 001675   000000 011000                    NOP     0

      520     4191    2           CALL ERROR(%ZIG_BAD_CHAR_IN_SSNAME);

   4191 42 001676   000115 630400 43                 EPPR0   77
        42 001677   000003 631400 43                 EPPR1   3
        42 001700   000000 701000 xent               TSX1    ERROR
        42 001701   000000 011000                    NOP     0

      521     4192        /*E*     ERROR:    ZIG-ZIG_BAD_CHAR_IN_SSNAME-C
      522     4193        MESSAGE: There is an illegal character in the subschema name
      523     4194                 %U1.
      524     4195        */
      525     4196    2           END;

      526     4197    1       IF SUB_LANGUAGE = #COBOL

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:109  
   4197 42 001702   000000 235000 30                 LDA     SUB_LANGUAGE
        42 001703   000001 115007                    CMPA    1,DL
        42 001704   002003 601000 42                 TNZ     s:4209

      527     4198    2       THEN DO;

      528     4199    2           O_REC.STRING='       TITLE DIVISION.';

   4199 42 001705   040000 100400                    MLR     fill='040'O
        42 001706   000132 000026 41                 ADSC9   90                       cn=0,n=22
        42 001707   000001 000264 36                 ADSC9   O_REC+1                  cn=0,n=180

      529     4200    2           CALL WRITER(O_REC.W_STATUS);

   4200 42 001710   000110 236000 43                 LDQ     72
        42 001711   200327 756100                    STQ     I+1,,AUTO
        42 001712   002134 701000 42                 TSX1    WRITER
        42 001713   000000 011000                    NOP     0

      530     4201    2           CALL CHECK_CHAR_SET(SSGEN.SNAME,ERROR_ALIAS,POSITION);

   4201 42 001714   200164 630500                    EPPR0   POSITION,,AUTO
        42 001715   200325 450500                    STP0    @MUST_ALIAS+1,,AUTO
        42 001716   200012 631500                    EPPR1   ERROR_ALIAS,,AUTO
        42 001717   200324 451500                    STP1    @WORD_TO_TRAN+1,,AUTO
        42 001720   000106 236000 43                 LDQ     70
        42 001721   200323 756100                    STQ     I+64,,AUTO
        42 001722   005631 701000 42                 TSX1    CHECK_CHAR_SET
        42 001723   000000 011000                    NOP     0

      531     4202    2           CALL CONCAT(O_REC.STRING,'         SS ',SUBSTR(SSGEN.SSNAME,0,
              4202                    SUB_NAME_LENGHT),

   4202 42 001724   040000 100400                    MLR     fill='040'O
        42 001725   000140 000014 41                 ADSC9   96                       cn=0,n=12
        42 001726   000001 000014 36                 ADSC9   O_REC+1                  cn=0,n=12
        42 001727   200136 720100                    LXL0    SUB_NAME_LENGHT,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:110  
        42 001730   040000 100440                    MLR     fill='040'O
        42 001731   000003 600010 12                 ADSC9   SSGEN+3                  cn=3,n=*X0
        42 001732   000004 000250 36                 ADSC9   O_REC+4                  cn=0,n=168
        42 001733   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 001734   000250 116007                    CMPQ    168,DL
        42 001735   001767 603000 42                 TRC     s:4204
        42 001736   777527 621006                    EAX1    -169,QL
        42 001737   777777 661003                    ERX1    -1,DU
        42 001740   040046 100400                    MLR     fill='040'O
        42 001741   000143 000010 41                 ADSC9   99                       cn=0,n=8
        42 001742   000004 000011 36                 ADSC9   O_REC+4,Q                cn=0,n=*X1
        42 001743   000240 116007                    CMPQ    160,DL
        42 001744   001767 603000 42                 TRC     s:4204
        42 001745   777537 622006                    EAX2    -161,QL
        42 001746   777777 662003                    ERX2    -1,DU
        42 001747   200137 723100                    LXL3    SCHEMA_NAME_LENGHT,,AUTO
        42 001750   040046 100440                    MLR     fill='040'O
        42 001751   000013 200013 12                 ADSC9   SSGEN+11                 cn=1,n=*X3
        42 001752   000006 000012 36                 ADSC9   O_REC+6,Q                cn=0,n=*X2
        42 001753   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 001754   000240 116007                    CMPQ    160,DL
        42 001755   001767 603000 42                 TRC     s:4204
        42 001756   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 001757   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 001760   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 001761   200372 724100                    LXL4    @ERROR_ARRAY+1,,AUTO
        42 001762   777537 624014                    EAX4    -161,X4
        42 001763   777777 664003                    ERX4    -1,DU
        42 001764   040046 100400                    MLR     fill='040'O
        42 001765   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 001766   000006 000014 36                 ADSC9   O_REC+6,Q                cn=0,n=*X4

      532     4203    2              ' WITHIN ',SUBSTR(SSGEN.SNAME,0,SCHEMA_NAME_LENGHT),'.');
      533     4204    2           CALL WRITER(O_REC.W_STATUS);

   4204 42 001767   000110 236000 43                 LDQ     72
        42 001770   200327 756100                    STQ     I+1,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:111  
        42 001771   002134 701000 42                 TSX1    WRITER
        42 001772   000000 011000                    NOP     0

      534     4205    2           O_REC.STRING='       MAPPING DIVISION.';

   4205 42 001773   040000 100400                    MLR     fill='040'O
        42 001774   000145 000030 41                 ADSC9   101                      cn=0,n=24
        42 001775   000001 000264 36                 ADSC9   O_REC+1                  cn=0,n=180

      535     4206    2           CALL WRITER(O_REC.W_STATUS);

   4206 42 001776   000110 236000 43                 LDQ     72
        42 001777   200327 756100                    STQ     I+1,,AUTO
        42 002000   002134 701000 42                 TSX1    WRITER
        42 002001   000000 011000                    NOP     0

      536     4207    2           END;

   4207 42 002002   002052 710000 42                 TRA     s:4213

      537     4208    2       ELSE DO;

      538     4209    2           CALL CONCAT(O_REC.STRING,'       SUBSCHEMA ',SUBSTR(SSGEN.SSNAME,0,
              4209                    SUB_NAME_LENGHT),

   4209 42 002003   040000 100400                    MLR     fill='040'O
        42 002004   000153 000021 41                 ADSC9   107                      cn=0,n=17
        42 002005   000001 000021 36                 ADSC9   O_REC+1                  cn=0,n=17
        42 002006   200136 720100                    LXL0    SUB_NAME_LENGHT,,AUTO
        42 002007   040000 100440                    MLR     fill='040'O
        42 002010   000003 600010 12                 ADSC9   SSGEN+3                  cn=3,n=*X0
        42 002011   000005 200243 36                 ADSC9   O_REC+5                  cn=1,n=163
        42 002012   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 002013   000243 116007                    CMPQ    163,DL
        42 002014   002046 603000 42                 TRC     s:4211
        42 002015   777534 621006                    EAX1    -164,QL
        42 002016   777777 661003                    ERX1    -1,DU
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:112  
        42 002017   040046 100400                    MLR     fill='040'O
        42 002020   000160 000014 41                 ADSC9   112                      cn=0,n=12
        42 002021   000005 200011 36                 ADSC9   O_REC+5,Q                cn=1,n=*X1
        42 002022   000227 116007                    CMPQ    151,DL
        42 002023   002046 603000 42                 TRC     s:4211
        42 002024   777550 622006                    EAX2    -152,QL
        42 002025   777777 662003                    ERX2    -1,DU
        42 002026   200137 723100                    LXL3    SCHEMA_NAME_LENGHT,,AUTO
        42 002027   040046 100440                    MLR     fill='040'O
        42 002030   000013 200013 12                 ADSC9   SSGEN+11                 cn=1,n=*X3
        42 002031   000010 200012 36                 ADSC9   O_REC+8,Q                cn=1,n=*X2
        42 002032   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 002033   000227 116007                    CMPQ    151,DL
        42 002034   002046 603000 42                 TRC     s:4211
        42 002035   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 002036   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 002037   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 002040   200372 724100                    LXL4    @ERROR_ARRAY+1,,AUTO
        42 002041   777550 624014                    EAX4    -152,X4
        42 002042   777777 664003                    ERX4    -1,DU
        42 002043   040046 100400                    MLR     fill='040'O
        42 002044   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 002045   000010 200014 36                 ADSC9   O_REC+8,Q                cn=1,n=*X4

      539     4210    2              ' , SCHEMA = ',SUBSTR(SSGEN.SNAME,0,SCHEMA_NAME_LENGHT),'.');
      540     4211    2           CALL WRITER(O_REC.W_STATUS);

   4211 42 002046   000110 236000 43                 LDQ     72
        42 002047   200327 756100                    STQ     I+1,,AUTO
        42 002050   002134 701000 42                 TSX1    WRITER
        42 002051   000000 011000                    NOP     0

      541     4212    2           END;

      542     4213    1       CALL GEN_ALIASES;

   4213 42 002052   003644 701000 42                 TSX1    GEN_ALIASES
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:113  
        42 002053   000000 011000                    NOP     0

      543     4214    1       CALL UOPEN('5*',0);

   4214 42 002054   000032 630400 43                 EPPR0   26
        42 002055   000011 631400 43                 EPPR1   9
        42 002056   000000 701000 xent               TSX1    UOPEN
        42 002057   000000 011000                    NOP     0

      544     4215    1       CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);

   4215 42 002060   200007 630500                    EPPR0   BUFFER_SIZE,,AUTO
        42 002061   200375 450500                    STP0    @ERROR_ARRAY+4,,AUTO
        42 002062   200123 631500                    EPPR1   EOF,,AUTO
        42 002063   200374 451500                    STP1    @ERROR_ARRAY+3,,AUTO
        42 002064   200124 633500                    EPPR3   DESCPTR,,AUTO
        42 002065   200373 453500                    STP3    @ERROR_ARRAY+2,,AUTO
        42 002066   000032 236000 43                 LDQ     26
        42 002067   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 002070   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 002071   000034 631400 43                 EPPR1   28
        42 002072   000000 701000 xent               TSX1    UGET
        42 002073   000000 011000                    NOP     0

      545     4216    2       DO WHILE (EOF=0);

   4216 42 002074   200123 235100                    LDA     EOF,,AUTO
        42 002075   002120 601000 42                 TNZ     s:4220

      546     4217    2           CALL WRITER(BUFFER_INPUT);

   4217 42 002076   200124 236100                    LDQ     DESCPTR,,AUTO
        42 002077   200327 756100                    STQ     I+1,,AUTO
        42 002100   002134 701000 42                 TSX1    WRITER
        42 002101   000000 011000                    NOP     0

      547     4218    2           CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:114  

   4218 42 002102   200007 630500                    EPPR0   BUFFER_SIZE,,AUTO
        42 002103   200375 450500                    STP0    @ERROR_ARRAY+4,,AUTO
        42 002104   200123 631500                    EPPR1   EOF,,AUTO
        42 002105   200374 451500                    STP1    @ERROR_ARRAY+3,,AUTO
        42 002106   200124 633500                    EPPR3   DESCPTR,,AUTO
        42 002107   200373 453500                    STP3    @ERROR_ARRAY+2,,AUTO
        42 002110   000032 236000 43                 LDQ     26
        42 002111   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 002112   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 002113   000034 631400 43                 EPPR1   28
        42 002114   000000 701000 xent               TSX1    UGET
        42 002115   000000 011000                    NOP     0

      548     4219    2           END;

   4219 42 002116   200123 235100                    LDA     EOF,,AUTO
        42 002117   002076 600000 42                 TZE     s:4217

      549     4220    1       CALL UCLOSE('5*');

   4220 42 002120   000032 630400 43                 EPPR0   26
        42 002121   000003 631400 43                 EPPR1   3
        42 002122   000000 701000 xent               TSX1    UCLOSE
        42 002123   000000 011000                    NOP     0

      550     4221    1       O_REC.STRING='       END.';

   4221 42 002124   040000 100400                    MLR     fill='040'O
        42 002125   000163 000013 41                 ADSC9   115                      cn=0,n=11
        42 002126   000001 000264 36                 ADSC9   O_REC+1                  cn=0,n=180

      551     4222    1       CALL WRITER(O_REC.W_STATUS);

   4222 42 002127   000110 236000 43                 LDQ     72
        42 002130   200327 756100                    STQ     I+1,,AUTO
        42 002131   002134 701000 42                 TSX1    WRITER
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:115  
        42 002132   000000 011000                    NOP     0

      552     4223    1       RETURN;

   4223 42 002133   000000 702200 xent               TSX2  ! X66_ARET

      553     4224        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:116  
      554     4225        /*
      555     4226              NOW COMES ALL THE SUBROUTINES THAT THE MAIN PROGRAM USES.
      556     4227
      557     4228            THESES SUBROUTINES ARE:
      558     4229                 WRITER
      559     4230                 STORE
      560     4231                 CHECK_ALIAS
      561     4232                 GEN_ALIASES
      562     4233                 FIND_LENGTH
      563     4234                 GET_COBOL_ITEMS
      564     4235                 GET_FORTRAN_ITEMS
      565     4236                 GET_APL_ITEMS
      566     4237                 GET_BASIC_ITEMS
      567     4238                 FLAG_LINE
      568     4239                 ERROR_EVAL
      569     4240
      570     4241        */
      571     4242    1   WRITER:

   4242 42 002134   200326 741300       WRITER       STX1  ! @POS+1,,AUTO

      572     4243    1       PROC (O_REC);
      573     4244    2   DCL LIST_STRING CHAR (128) ;
      574     4245    2   DCL RECORD_POINTER PTR EXT;
      575     4246    2   DCL 1 O_REC,
      576     4247    2         2 STATUS (0:35) BIT (1) UNAL,
      577     4248    2         2 W_STATUS REDEF STATUS UBIN (36) ,
      578     4249    2         2 STRING CHAR (80) UNAL;
      579     4250    2       RECORD_POINTER=ADDR(O_REC.STRING);

   4250 42 002135   200327 236100                    LDQ     @O_REC,,AUTO
        42 002136   000001 036003                    ADLQ    1,DU
        42 002137   000000 756000 40                 STQ     RECORD_POINTER

      580     4251    2       CALL WRITERECORD_TO_SEQ_FILE;

   4251 42 002140   000031 631400 43                 EPPR1   25
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:117  
        42 002141   000000 701000 xent               TSX1    WRITERECORD_TO_SEQ_FILE
        42 002142   000000 011000                    NOP     0

      581     4252    2       LIST_STRING = O_REC.STRING;

   4252 42 002143   200327 470500                    LDP0    @O_REC,,AUTO
        42 002144   040100 100500                    MLR     fill='040'O
        42 002145   000001 000120                    ADSC9   1,,PR0                   cn=0,n=80
        42 002146   200330 000200                    ADSC9   LIST_STRING,,AUTO        cn=0,n=128

      582     4253    2       CALL LIST(LIST_STRING);

   4253 42 002147   200330 631500                    EPPR1   LIST_STRING,,AUTO
        42 002150   200372 451500                    STP1    @ERROR_ARRAY+1,,AUTO
        42 002151   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 002152   000003 631400 43                 EPPR1   3
        42 002153   000000 701000 xent               TSX1    LIST
        42 002154   000000 011000                    NOP     0

      583     4254    2       IF O_REC.W_STATUS ~= 0

   4254 42 002155   200327 470500                    LDP0    @O_REC,,AUTO
        42 002156   000000 235100                    LDA     0,,PR0
        42 002157   002164 600000 42                 TZE     s:4256

      584     4255    2       THEN CALL ERROR_EVAL(O_REC.W_STATUS);

   4255 42 002160   200327 236100                    LDQ     @O_REC,,AUTO
        42 002161   200371 756100                    STQ     LIST_STRING+33,,AUTO
        42 002162   005375 701000 42                 TSX1    ERROR_EVAL
        42 002163   000000 011000                    NOP     0

      585     4256    2       RETURN;

   4256 42 002164   200326 221300                    LDX1  ! @POS+1,,AUTO
        42 002165   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:118  
      586     4257    2   END WRITER;
      587     4258        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:119  
      588     4259        /*
      589     4260              NOW STORE WHICH WRITES THINGS OUT TO THE TEMP FILE 5*
      590     4261            SO THE CAN BE READ BACK IN AFTER ALL THE ALIASES HAVE BEEN
      591     4262            GENERATED. SO THINGS CAN BE WRITTEN TO THE USER IN THE CORRECT
      592     4263            ORDER.
      593     4264        */
      594     4265    1   STORE:

   4265 42 002166   200220 741300       STORE        STX1  ! I+1,,AUTO

      595     4266    1       PROC (STRING_TO_STORE);
      596     4267    2   DCL STRING_TO_STORE CHAR (80);
      597     4268    2       O_REC.STRING=STRING_TO_STORE;

   4268 42 002167   200221 470500                    LDP0    @STRING_TO_STORE,,AUTO
        42 002170   040000 100500                    MLR     fill='040'O
        42 002171   000000 000120                    ADSC9   0,,PR0                   cn=0,n=80
        42 002172   000001 000264 36                 ADSC9   O_REC+1                  cn=0,n=180

      598     4269    2       CALL UPUT('5*',ADDR(O_REC.STATUS),25);

   4269 42 002173   000110 236000 43                 LDQ     72
        42 002174   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 002175   000117 236000 43                 LDQ     79
        42 002176   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 002177   200372 631500                    EPPR1   @ERROR_ARRAY+1,,AUTO
        42 002200   200374 451500                    STP1    @ERROR_ARRAY+3,,AUTO
        42 002201   000032 236000 43                 LDQ     26
        42 002202   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 002203   200373 630500                    EPPR0   @ERROR_ARRAY+2,,AUTO
        42 002204   000000 631400 43                 EPPR1   0
        42 002205   000000 701000 xent               TSX1    UPUT
        42 002206   000000 011000                    NOP     0

      599     4270    2       O_REC.W_STATUS = 0;

   4270 42 002207   000000 450000 36                 STZ     O_REC
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:120  

      600     4271    2       RETURN;

   4271 42 002210   200220 221300                    LDX1  ! I+1,,AUTO
        42 002211   000001 702211                    TSX2  ! 1,X1

      601     4272    2   END STORE;
      602     4273        /*
      603     4274              NOW COMES THE PROCEDURE THAT DETERMINES THE LENGHT OF
      604     4275            A CHARACTER STRING THAT IS FIXED LENGHT SO WE DON'T HAVE
      605     4276            A MILLION BLANKS AFTER EVERY NAME.
      606     4277        */
      607     4278        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:121  
      608     4279    1   FIND_LENGTH:

   4279 42 002212   200322 741300       FIND_LENGTH  STX1  ! I+63,,AUTO

      609     4280    1       PROC(STRING_TO_GET,RETURN_LENGTH);
      610     4281    2   DCL RETURN_LENGTH UBIN (36);
      611     4282    2   DCL STRING_TO_GET CHAR (30);
      612     4283    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);

   4283 42 002213   200324 470500                    LDP0    @RETURN_LENGTH,,AUTO
        42 002214   200323 471500                    LDP1    @STRING_TO_GET,,AUTO
        42 002215   000000 124500                    SCM     mask='000'O
        42 002216   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        42 002217   000057 000001 43                 ADSC9   47                       cn=0,n=1
        42 002220   000000 000100                    ARG     0,,PR0
        42 002221   002224 606400 42                 TTN     NOT_BLANK

      613     4284    2       RETURN;

   4284 42 002222   200322 221300                    LDX1  ! I+63,,AUTO
        42 002223   000001 702211                    TSX2  ! 1,X1

      614     4285    2   NOT_BLANK:
      615     4286    2       RETURN_LENGTH = 30;

   4286 42 002224   000036 235007       NOT_BLANK    LDA     30,DL
        42 002225   200324 470500                    LDP0    @RETURN_LENGTH,,AUTO
        42 002226   000000 755100                    STA     0,,PR0

      616     4287    2       RETURN;

   4287 42 002227   200322 221300                    LDX1  ! I+63,,AUTO
        42 002230   000001 702211                    TSX2  ! 1,X1

      617     4288    2   END FIND_LENGTH;
      618     4289        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:122  
      619     4290        /*
      620     4291              NOW COMES THE GET ITEMS THE DIFERENT SUBSCHEMAS.
      621     4292            THEN GENERATE THE NAMES AND THE TYPES OF THE ITEMS IN
      622     4293            THAT RECORD.
      623     4294
      624     4295        */
      625     4296    1   GET_COBOL_ITEMS:

   4296 42 002231   200216 741300       GET_COBOL_I* STX1  ! TEMP_WORD+8,,AUTO

      626     4297    1       PROC;
      627     4298    2       STATUS = #IN_ITEM_PROCESSING;

   4298 42 002232   050000 236003                    LDQ     20480,DU
        42 002233   200135 756100                    STQ     STATUS,,AUTO

      628     4299    2       CALL FETCHNS_6 ('RC-FR   ') ALTRET(END_COBOL_RECORD);

   4299 42 002234   000120 630400 43                 EPPR0   80
        42 002235   000003 631400 43                 EPPR1   3
        42 002236   000000 701000 xent               TSX1    FETCHNS_6
        42 002237   002762 702000 42                 TSX2    END_COBOL_RECORD

      629     4300    3       DO WHILE (UWA.DB_STATUS ~= '0502100');

   4300 42 002240   040000 106400                    CMPC    fill='040'O
        42 002241   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 002242   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 002243   002762 600000 42                 TZE     END_COBOL_RECORD

      630     4301    3           IF UWA.FR.SYN = 0 AND UWA.FR.F_USE = 0

   4301 42 002244   000332 235000 0                  LDA     UWA+218
        42 002245   002752 601000 42                 TNZ     s:4418
        42 002246   000343 236000 0                  LDQ     UWA+227
        42 002247   002752 601000 42                 TNZ     s:4418

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:123  
      631     4302    4           THEN DO;

      632     4303    4               CALL FETCHOS_6('SN-SE   ');

   4303 42 002250   000021 630400 43                 EPPR0   17
        42 002251   000003 631400 43                 EPPR1   3
        42 002252   000000 701000 xent               TSX1    FETCHOS_6
        42 002253   000000 011000                    NOP     0

      633     4304    4               CALL CHECK_ALIAS(UWA.SN.SENAME);

   4304 42 002254   000074 236000 43                 LDQ     60
        42 002255   200221 756100                    STQ     @STRING_TO_STORE,,AUTO
        42 002256   005421 701000 42                 TSX1    CHECK_ALIAS
        42 002257   000000 011000                    NOP     0

      634     4305    4               IF UWA.FR.FTYPE=5 OR UWA.FR.FTYPE = 9 OR UWA.FR.FTYPE = 19

   4305 42 002260   000334 235000 0                  LDA     UWA+220
        42 002261   000005 115007                    CMPA    5,DL
        42 002262   002267 600000 42                 TZE     s:4307
        42 002263   000011 115007                    CMPA    9,DL
        42 002264   002267 600000 42                 TZE     s:4307
        42 002265   000023 115007                    CMPA    19,DL
        42 002266   002337 601000 42                 TNZ     s:4320

      635     4306    5               THEN DO;

      636     4307    5                   IF UWA.FR.PREC > 1

   4307 42 002267   000335 236000 0                  LDQ     UWA+221
        42 002270   000001 116007                    CMPQ    1,DL
        42 002271   002333 604400 42                 TMOZ    s:4316

      637     4308    6                   THEN DO;

      638     4309    6                       TEMP_SBIN = UWA.FR.PREC;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:124  

   4309 42 002272   200162 756100                    STQ     TEMP_SBIN,,AUTO

      639     4310    6                       CALL BINXCHAR(NUM_STRING,-TEMP_SBIN);

   4310 42 002273   200162 335100                    LCA     TEMP_SBIN,,AUTO
        42 002274   200372 755100                    STA     @ERROR_ARRAY+1,,AUTO
        42 002275   000100 301500                    BTD
        42 002276   200372 000004                    NDSC9   @ERROR_ARRAY+1,,AUTO     cn=0,s=lsgnf,sf=0,n=4
        42 002277   200156 010012                    NDSC9   NUM_STRING,,AUTO         cn=0,s=lsgns,sf=0,n=10

      640     4311    6                       CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);

   4311 42 002300   200156 630500                    EPPR0   NUM_STRING,,AUTO
        42 002301   200222 450500                    STP0    @POS+1,,AUTO
        42 002302   200163 631500                    EPPR1   FIRST_NO_ZERO,,AUTO
        42 002303   200221 451500                    STP1    @STRING_TO_STORE,,AUTO
        42 002304   005606 701000 42                 TSX1    LAST_ZERO
        42 002305   000000 011000                    NOP     0

      641     4312    6                       CALL CONCAT( VARIABLE_TYPE,'DISPLAY PIC X(',

   4312 42 002306   040100 100400                    MLR     fill='040'O
        42 002307   000170 000016 41                 ADSC9   120                      cn=0,n=14
        42 002310   200144 000016                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=14
        42 002311   200163 720100                    LXL0    FIRST_NO_ZERO,,AUTO
        42 002312   777765 620010                    EAX0    -11,X0
        42 002313   777777 660003                    ERX0    -1,DU
        42 002314   200163 235100                    LDA     FIRST_NO_ZERO,,AUTO
        42 002315   040100 100545                    MLR     fill='040'O
        42 002316   200156 000010                    ADSC9   NUM_STRING,A,AUTO        cn=0,n=*X0
        42 002317   200147 400032                    ADSC9   VARIABLE_TYPE+3,,AUTO    cn=2,n=26
        42 002320   200163 236100                    LDQ     FIRST_NO_ZERO,,AUTO
        42 002321   002324 604000 42                 TMI     s:4312+14
        42 002322   000121 116000 43                 CMPQ    81
        42 002323   002332 604000 42                 TMI     s:4314
        42 002324   000020 621006                    EAX1    16,QL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:125  
        42 002325   000122 675000 43                 ERA     82
        42 002326   000001 035007                    ADLA    1,DL
        42 002327   040145 100400                    MLR     fill='040'O
        42 002330   000174 000002 41                 ADSC9   124                      cn=0,n=2
        42 002331   200152 000011                    ADSC9   VARIABLE_TYPE+6,A,AUTO   cn=0,n=*X1

      642     4313    6                          SUBSTR(NUM_STRING,FIRST_NO_ZERO),').');
      643     4314    6                       END;

   4314 42 002332   002733 710000 42                 TRA     s:4414

      644     4315    6                   ELSE DO;

      645     4316    6                       VARIABLE_TYPE='DISPLAY PIC X.';

   4316 42 002333   040100 100400                    MLR     fill='040'O
        42 002334   000175 000016 41                 ADSC9   125                      cn=0,n=14
        42 002335   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      646     4317    6                       END;

      647     4318    5                   END;

   4318 42 002336   002733 710000 42                 TRA     s:4414

      648     4319    4               ELSE
      649     4320    4                   IF UWA.FR.FTYPE = 1 OR UWA.FR.FTYPE = 2

   4320 42 002337   000001 115007                    CMPA    1,DL
        42 002340   002343 600000 42                 TZE     s:4321
        42 002341   000002 115007                    CMPA    2,DL
        42 002342   002347 601000 42                 TNZ     s:4323

      650     4321    4                   THEN VARIABLE_TYPE = 'COMP-6.';

   4321 42 002343   040100 100400                    MLR     fill='040'O
        42 002344   000201 000007 41                 ADSC9   129                      cn=0,n=7
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:126  
        42 002345   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40
        42 002346   002733 710000 42                 TRA     s:4414

      651     4322    4                   ELSE
      652     4323    4                       IF UWA.FR.FTYPE = 0

   4323 42 002347   000000 115003                    CMPA    0,DU
        42 002350   002355 601000 42                 TNZ     s:4326

      653     4324    4                       THEN VARIABLE_TYPE = 'DB-KEY.';

   4324 42 002351   040100 100400                    MLR     fill='040'O
        42 002352   000203 000007 41                 ADSC9   131                      cn=0,n=7
        42 002353   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40
        42 002354   002733 710000 42                 TRA     s:4414

      654     4325    4                       ELSE
      655     4326    4                           IF UWA.FR.FTYPE = 3 OR UWA.FR.FTYPE = 4

   4326 42 002355   000003 115007                    CMPA    3,DL
        42 002356   002361 600000 42                 TZE     s:4328
        42 002357   000004 115007                    CMPA    4,DL
        42 002360   002710 601000 42                 TNZ     s:4401

      656     4327    5                           THEN DO;

      657     4328    5                               COUNT=12;

   4328 42 002361   000014 236007                    LDQ     12,DL
        42 002362   200141 756100                    STQ     COUNT,,AUTO

      658     4329    5                               VARIABLE_TYPE = 'COMP-4  PIC ';

   4329 42 002363   040100 100400                    MLR     fill='040'O
        42 002364   000205 000014 41                 ADSC9   133                      cn=0,n=12
        42 002365   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:127  
      659     4330    5                               IF UWA.FR.FTYPE = 4

   4330 42 002366   000004 115007                    CMPA    4,DL
        42 002367   002375 601000 42                 TNZ     s:4335

      660     4331    6                               THEN DO;

      661     4332    6                                   CALL INSERT (VARIABLE_TYPE,COUNT,1,'S');

   4332 42 002370   040106 100400                    MLR     fill='040'O
        42 002371   000123 000001 43                 ADSC9   83                       cn=0,n=1
        42 002372   200144 000001                    ADSC9   VARIABLE_TYPE,Q,AUTO     cn=0,n=1

      662     4333    6                                   COUNT = COUNT + 1;

   4333 42 002373   000001 036007                    ADLQ    1,DL
        42 002374   200141 756100                    STQ     COUNT,,AUTO

      663     4334    6                                   END;

      664     4335    5                               INT = UWA.FR.PREC - UWA.FR.SCALE;

   4335 42 002375   000335 236000 0                  LDQ     UWA+221
        42 002376   000336 136000 0                  SBLQ    UWA+222
        42 002377   200142 756100                    STQ     INT,,AUTO

      665     4336    5                               IF INT > UWA.FR.PREC

   4336 42 002400   000335 116000 0                  CMPQ    UWA+221
        42 002401   002404 604400 42                 TMOZ    s:4338

      666     4337    5                               THEN INT =UWA.FR.PREC;

   4337 42 002402   000335 235000 0                  LDA     UWA+221
        42 002403   200142 755100                    STA     INT,,AUTO

      667     4338    5                               DP = UWA.FR.SCALE;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:128  

   4338 42 002404   000336 235000 0                  LDA     UWA+222
        42 002405   200143 755100                    STA     DP,,AUTO

      668     4339    5                               IF DP > UWA.FR.PREC

   4339 42 002406   200143 236100                    LDQ     DP,,AUTO
        42 002407   000335 116000 0                  CMPQ    UWA+221
        42 002410   002413 604400 42                 TMOZ    s:4341

      669     4340    5                               THEN DP = UWA.FR.PREC;

   4340 42 002411   000335 235000 0                  LDA     UWA+221
        42 002412   200143 755100                    STA     DP,,AUTO

      670     4341    5                               IF INT > 0

   4341 42 002413   200142 236100                    LDQ     INT,,AUTO
        42 002414   002423 604400 42                 TMOZ    s:4346

      671     4342    6                               THEN DO;

      672     4343    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'9');

   4343 42 002415   200141 235100                    LDA     COUNT,,AUTO
        42 002416   040105 100400                    MLR     fill='040'O
        42 002417   000124 000001 43                 ADSC9   84                       cn=0,n=1
        42 002420   200144 000001                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=0,n=1

      673     4344    6                                   COUNT = COUNT + 1;

   4344 42 002421   000001 035007                    ADLA    1,DL
        42 002422   200141 755100                    STA     COUNT,,AUTO

      674     4345    6                                   END;

      675     4346    5                               IF INT > 1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:129  

   4346 42 002423   000001 116007                    CMPQ    1,DL
        42 002424   002470 604400 42                 TMOZ    s:4354

      676     4347    6                               THEN DO;

      677     4348    6                                   CALL BINXCHAR(NUM_STRING,-INT);

   4348 42 002425   200142 335100                    LCA     INT,,AUTO
        42 002426   200372 755100                    STA     @ERROR_ARRAY+1,,AUTO
        42 002427   000100 301500                    BTD
        42 002430   200372 000004                    NDSC9   @ERROR_ARRAY+1,,AUTO     cn=0,s=lsgnf,sf=0,n=4
        42 002431   200156 010012                    NDSC9   NUM_STRING,,AUTO         cn=0,s=lsgns,sf=0,n=10

      678     4349    6                                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);

   4349 42 002432   200156 630500                    EPPR0   NUM_STRING,,AUTO
        42 002433   200222 450500                    STP0    @POS+1,,AUTO
        42 002434   200163 631500                    EPPR1   FIRST_NO_ZERO,,AUTO
        42 002435   200221 451500                    STP1    @STRING_TO_STORE,,AUTO
        42 002436   005606 701000 42                 TSX1    LAST_ZERO
        42 002437   000000 011000                    NOP     0

      679     4350    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,10,'(',SUBSTR(
              4350                                            NUM_STRING

   4350 42 002440   200141 235100                    LDA     COUNT,,AUTO
        42 002441   040105 100400                    MLR     fill='040'O
        42 002442   000125 000001 43                 ADSC9   85                       cn=0,n=1
        42 002443   200144 000001                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=0,n=1
        42 002444   200163 720100                    LXL0    FIRST_NO_ZERO,,AUTO
        42 002445   777765 620010                    EAX0    -11,X0
        42 002446   777777 660003                    ERX0    -1,DU
        42 002447   200163 236100                    LDQ     FIRST_NO_ZERO,,AUTO
        42 002450   040105 100546                    MLR     fill='040'O
        42 002451   200156 000010                    ADSC9   NUM_STRING,Q,AUTO        cn=0,n=*X0
        42 002452   200144 200011                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=1,n=9
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:130  
        42 002453   000002 116007                    CMPQ    2,DL
        42 002454   002464 602000 42                 TNC     s:4352
        42 002455   200141 236100                    LDQ     COUNT,,AUTO
        42 002456   200163 136100                    SBLQ    FIRST_NO_ZERO,,AUTO
        42 002457   200163 721100                    LXL1    FIRST_NO_ZERO,,AUTO
        42 002460   777777 622011                    EAX2    -1,X1
        42 002461   040146 100400                    MLR     fill='040'O
        42 002462   000126 000001 43                 ADSC9   86                       cn=0,n=1
        42 002463   200146 600012                    ADSC9   VARIABLE_TYPE+2,Q,AUTO   cn=3,n=*X2

      680     4351    6                                      ,FIRST_NO_ZERO),')');
      681     4352    6                                   COUNT=COUNT + 12 - FIRST_NO_ZERO;

   4352 42 002464   200141 236100                    LDQ     COUNT,,AUTO
        42 002465   200163 136100                    SBLQ    FIRST_NO_ZERO,,AUTO
        42 002466   000014 036007                    ADLQ    12,DL
        42 002467   200141 756100                    STQ     COUNT,,AUTO

      682     4353    6                                   END;

      683     4354    5                               IF DP < 0

   4354 42 002470   200143 235100                    LDA     DP,,AUTO
        42 002471   002500 605000 42                 TPL     s:4359

      684     4355    6                               THEN DO;

      685     4356    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'P');

   4356 42 002472   200141 236100                    LDQ     COUNT,,AUTO
        42 002473   040106 100400                    MLR     fill='040'O
        42 002474   000127 000001 43                 ADSC9   87                       cn=0,n=1
        42 002475   200144 000001                    ADSC9   VARIABLE_TYPE,Q,AUTO     cn=0,n=1

      686     4357    6                                   COUNT = COUNT + 1;

   4357 42 002476   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:131  
        42 002477   200141 756100                    STQ     COUNT,,AUTO

      687     4358    6                                   END;

      688     4359    5                               IF DP < -1

   4359 42 002500   000122 115000 43                 CMPA    82
        42 002501   002543 605000 42                 TPL     s:4367

      689     4360    6                               THEN DO;

      690     4361    6                                   CALL BINXCHAR(NUM_STRING,DP);

   4361 42 002502   000100 301500                    BTD
        42 002503   200143 000004                    NDSC9   DP,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
        42 002504   200156 010012                    NDSC9   NUM_STRING,,AUTO         cn=0,s=lsgns,sf=0,n=10

      691     4362    6                                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);

   4362 42 002505   200156 630500                    EPPR0   NUM_STRING,,AUTO
        42 002506   200222 450500                    STP0    @POS+1,,AUTO
        42 002507   200163 631500                    EPPR1   FIRST_NO_ZERO,,AUTO
        42 002510   200221 451500                    STP1    @STRING_TO_STORE,,AUTO
        42 002511   005606 701000 42                 TSX1    LAST_ZERO
        42 002512   000000 011000                    NOP     0

      692     4363    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,10,'(',SUBSTR(
              4363                                            NUM_STRING

   4363 42 002513   200141 235100                    LDA     COUNT,,AUTO
        42 002514   040105 100400                    MLR     fill='040'O
        42 002515   000125 000001 43                 ADSC9   85                       cn=0,n=1
        42 002516   200144 000001                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=0,n=1
        42 002517   200163 720100                    LXL0    FIRST_NO_ZERO,,AUTO
        42 002520   777765 620010                    EAX0    -11,X0
        42 002521   777777 660003                    ERX0    -1,DU
        42 002522   200163 236100                    LDQ     FIRST_NO_ZERO,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:132  
        42 002523   040105 100546                    MLR     fill='040'O
        42 002524   200156 000010                    ADSC9   NUM_STRING,Q,AUTO        cn=0,n=*X0
        42 002525   200144 200011                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=1,n=9
        42 002526   000002 116007                    CMPQ    2,DL
        42 002527   002537 602000 42                 TNC     s:4365
        42 002530   200141 236100                    LDQ     COUNT,,AUTO
        42 002531   200163 136100                    SBLQ    FIRST_NO_ZERO,,AUTO
        42 002532   200163 721100                    LXL1    FIRST_NO_ZERO,,AUTO
        42 002533   777777 622011                    EAX2    -1,X1
        42 002534   040146 100400                    MLR     fill='040'O
        42 002535   000126 000001 43                 ADSC9   86                       cn=0,n=1
        42 002536   200146 600012                    ADSC9   VARIABLE_TYPE+2,Q,AUTO   cn=3,n=*X2

      693     4364    6                                      ,FIRST_NO_ZERO),')');
      694     4365    6                                   COUNT=COUNT + 12 - FIRST_NO_ZERO;

   4365 42 002537   200141 236100                    LDQ     COUNT,,AUTO
        42 002540   200163 136100                    SBLQ    FIRST_NO_ZERO,,AUTO
        42 002541   000014 036007                    ADLQ    12,DL
        42 002542   200141 756100                    STQ     COUNT,,AUTO

      695     4366    6                                   END;

      696     4367    5                               IF DP ~= 0

   4367 42 002543   200143 235100                    LDA     DP,,AUTO
        42 002544   002553 600000 42                 TZE     s:4372

      697     4368    6                               THEN DO;

      698     4369    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'V');

   4369 42 002545   200141 236100                    LDQ     COUNT,,AUTO
        42 002546   040106 100400                    MLR     fill='040'O
        42 002547   000130 000001 43                 ADSC9   88                       cn=0,n=1
        42 002550   200144 000001                    ADSC9   VARIABLE_TYPE,Q,AUTO     cn=0,n=1

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:133  
      699     4370    6                                   COUNT = COUNT + 1;

   4370 42 002551   000001 036007                    ADLQ    1,DL
        42 002552   200141 756100                    STQ     COUNT,,AUTO

      700     4371    6                                   END;

      701     4372    5                               IF INT < 0

   4372 42 002553   200142 236100                    LDQ     INT,,AUTO
        42 002554   002563 605000 42                 TPL     s:4377

      702     4373    6                               THEN DO;

      703     4374    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'P');

   4374 42 002555   200141 235100                    LDA     COUNT,,AUTO
        42 002556   040105 100400                    MLR     fill='040'O
        42 002557   000127 000001 43                 ADSC9   87                       cn=0,n=1
        42 002560   200144 000001                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=0,n=1

      704     4375    6                                   COUNT = COUNT + 1;

   4375 42 002561   000001 035007                    ADLA    1,DL
        42 002562   200141 755100                    STA     COUNT,,AUTO

      705     4376    6                                   END;

      706     4377    5                               IF INT < -1

   4377 42 002563   000122 116000 43                 CMPQ    82
        42 002564   002626 605000 42                 TPL     s:4385

      707     4378    6                               THEN DO;

      708     4379    6                                   CALL BINXCHAR(NUM_STRING,INT);

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:134  
   4379 42 002565   000100 301500                    BTD
        42 002566   200142 000004                    NDSC9   INT,,AUTO                cn=0,s=lsgnf,sf=0,n=4
        42 002567   200156 010012                    NDSC9   NUM_STRING,,AUTO         cn=0,s=lsgns,sf=0,n=10

      709     4380    6                                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);

   4380 42 002570   200156 630500                    EPPR0   NUM_STRING,,AUTO
        42 002571   200222 450500                    STP0    @POS+1,,AUTO
        42 002572   200163 631500                    EPPR1   FIRST_NO_ZERO,,AUTO
        42 002573   200221 451500                    STP1    @STRING_TO_STORE,,AUTO
        42 002574   005606 701000 42                 TSX1    LAST_ZERO
        42 002575   000000 011000                    NOP     0

      710     4381    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,10,'(',SUBSTR(
              4381                                            NUM_STRING

   4381 42 002576   200141 235100                    LDA     COUNT,,AUTO
        42 002577   040105 100400                    MLR     fill='040'O
        42 002600   000125 000001 43                 ADSC9   85                       cn=0,n=1
        42 002601   200144 000001                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=0,n=1
        42 002602   200163 720100                    LXL0    FIRST_NO_ZERO,,AUTO
        42 002603   777765 620010                    EAX0    -11,X0
        42 002604   777777 660003                    ERX0    -1,DU
        42 002605   200163 236100                    LDQ     FIRST_NO_ZERO,,AUTO
        42 002606   040105 100546                    MLR     fill='040'O
        42 002607   200156 000010                    ADSC9   NUM_STRING,Q,AUTO        cn=0,n=*X0
        42 002610   200144 200011                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=1,n=9
        42 002611   000002 116007                    CMPQ    2,DL
        42 002612   002622 602000 42                 TNC     s:4383
        42 002613   200141 236100                    LDQ     COUNT,,AUTO
        42 002614   200163 136100                    SBLQ    FIRST_NO_ZERO,,AUTO
        42 002615   200163 721100                    LXL1    FIRST_NO_ZERO,,AUTO
        42 002616   777777 622011                    EAX2    -1,X1
        42 002617   040146 100400                    MLR     fill='040'O
        42 002620   000126 000001 43                 ADSC9   86                       cn=0,n=1
        42 002621   200146 600012                    ADSC9   VARIABLE_TYPE+2,Q,AUTO   cn=3,n=*X2

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:135  
      711     4382    6                                      ,FIRST_NO_ZERO),')');
      712     4383    6                                   COUNT=COUNT + 12 - FIRST_NO_ZERO;

   4383 42 002622   200141 236100                    LDQ     COUNT,,AUTO
        42 002623   200163 136100                    SBLQ    FIRST_NO_ZERO,,AUTO
        42 002624   000014 036007                    ADLQ    12,DL
        42 002625   200141 756100                    STQ     COUNT,,AUTO

      713     4384    6                                   END;

      714     4385    5                               IF DP > 0

   4385 42 002626   200143 235100                    LDA     DP,,AUTO
        42 002627   002636 604400 42                 TMOZ    s:4390

      715     4386    6                               THEN DO;

      716     4387    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,1,'9');

   4387 42 002630   200141 236100                    LDQ     COUNT,,AUTO
        42 002631   040106 100400                    MLR     fill='040'O
        42 002632   000124 000001 43                 ADSC9   84                       cn=0,n=1
        42 002633   200144 000001                    ADSC9   VARIABLE_TYPE,Q,AUTO     cn=0,n=1

      717     4388    6                                   COUNT = COUNT + 1;

   4388 42 002634   000001 036007                    ADLQ    1,DL
        42 002635   200141 756100                    STQ     COUNT,,AUTO

      718     4389    6                                   END;

      719     4390    5                               IF DP > 1

   4390 42 002636   000001 115007                    CMPA    1,DL
        42 002637   002703 604400 42                 TMOZ    s:4398

      720     4391    6                               THEN DO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:136  

      721     4392    6                                   CALL BINXCHAR(NUM_STRING,-DP);

   4392 42 002640   000000 531000                    NEG     0
        42 002641   200372 755100                    STA     @ERROR_ARRAY+1,,AUTO
        42 002642   000100 301500                    BTD
        42 002643   200372 000004                    NDSC9   @ERROR_ARRAY+1,,AUTO     cn=0,s=lsgnf,sf=0,n=4
        42 002644   200156 010012                    NDSC9   NUM_STRING,,AUTO         cn=0,s=lsgns,sf=0,n=10

      722     4393    6                                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);

   4393 42 002645   200156 630500                    EPPR0   NUM_STRING,,AUTO
        42 002646   200222 450500                    STP0    @POS+1,,AUTO
        42 002647   200163 631500                    EPPR1   FIRST_NO_ZERO,,AUTO
        42 002650   200221 451500                    STP1    @STRING_TO_STORE,,AUTO
        42 002651   005606 701000 42                 TSX1    LAST_ZERO
        42 002652   000000 011000                    NOP     0

      723     4394    6                                   CALL INSERT(VARIABLE_TYPE,COUNT,10,'(',SUBSTR(
              4394                                            NUM_STRING

   4394 42 002653   200141 235100                    LDA     COUNT,,AUTO
        42 002654   040105 100400                    MLR     fill='040'O
        42 002655   000125 000001 43                 ADSC9   85                       cn=0,n=1
        42 002656   200144 000001                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=0,n=1
        42 002657   200163 720100                    LXL0    FIRST_NO_ZERO,,AUTO
        42 002660   777765 620010                    EAX0    -11,X0
        42 002661   777777 660003                    ERX0    -1,DU
        42 002662   200163 236100                    LDQ     FIRST_NO_ZERO,,AUTO
        42 002663   040105 100546                    MLR     fill='040'O
        42 002664   200156 000010                    ADSC9   NUM_STRING,Q,AUTO        cn=0,n=*X0
        42 002665   200144 200011                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=1,n=9
        42 002666   000002 116007                    CMPQ    2,DL
        42 002667   002677 602000 42                 TNC     s:4396
        42 002670   200141 236100                    LDQ     COUNT,,AUTO
        42 002671   200163 136100                    SBLQ    FIRST_NO_ZERO,,AUTO
        42 002672   200163 721100                    LXL1    FIRST_NO_ZERO,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:137  
        42 002673   777777 622011                    EAX2    -1,X1
        42 002674   040146 100400                    MLR     fill='040'O
        42 002675   000126 000001 43                 ADSC9   86                       cn=0,n=1
        42 002676   200146 600012                    ADSC9   VARIABLE_TYPE+2,Q,AUTO   cn=3,n=*X2

      724     4395    6                                      ,FIRST_NO_ZERO),')');
      725     4396    6                                   COUNT=COUNT + 12 - FIRST_NO_ZERO;

   4396 42 002677   200141 236100                    LDQ     COUNT,,AUTO
        42 002700   200163 136100                    SBLQ    FIRST_NO_ZERO,,AUTO
        42 002701   000014 036007                    ADLQ    12,DL
        42 002702   200141 756100                    STQ     COUNT,,AUTO

      726     4397    6                                   END;

      727     4398    5                               CALL INSERT( VARIABLE_TYPE,COUNT,1,'.');

   4398 42 002703   200141 235100                    LDA     COUNT,,AUTO
        42 002704   040105 100400                    MLR     fill='040'O
        42 002705   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 002706   200144 000001                    ADSC9   VARIABLE_TYPE,A,AUTO     cn=0,n=1

      728     4399    5                               END;

   4399 42 002707   002733 710000 42                 TRA     s:4414

      729     4400    4                           ELSE
      730     4401    4                               IF UWA.FR.FTYPE = 11

   4401 42 002710   000013 115007                    CMPA    11,DL
        42 002711   002716 601000 42                 TNZ     s:4406

      731     4402    5                               THEN DO;

      732     4403    5                                   VARIABLE_TYPE='COMP-11.';

   4403 42 002712   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:138  
        42 002713   000210 000010 41                 ADSC9   136                      cn=0,n=8
        42 002714   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      733     4404    5                                   END;

   4404 42 002715   002733 710000 42                 TRA     s:4414

      734     4405    4                               ELSE
      735     4406    4                                   IF UWA.FR.FTYPE = 12

   4406 42 002716   000014 115007                    CMPA    12,DL
        42 002717   002724 601000 42                 TNZ     s:4411

      736     4407    5                                   THEN DO;

      737     4408    5                                       VARIABLE_TYPE = 'COMP-12.';

   4408 42 002720   040100 100400                    MLR     fill='040'O
        42 002721   000212 000010 41                 ADSC9   138                      cn=0,n=8
        42 002722   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      738     4409    5                                       END;

   4409 42 002723   002733 710000 42                 TRA     s:4414

      739     4410    5                                   ELSE DO;

      740     4411    5                                      VARIABLE_TYPE=' **** NO DEFAULT DATA TYPE ****';

   4411 42 002724   040100 100400                    MLR     fill='040'O
        42 002725   000214 000037 41                 ADSC9   140                      cn=0,n=31
        42 002726   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      741     4412    5                                       CALL FLAG_LINE(#NO_DEFAULT_TYPE);

   4412 42 002727   000033 236000 43                 LDQ     27
        42 002730   200221 756100                    STQ     @STRING_TO_STORE,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:139  
        42 002731   005366 701000 42                 TSX1    FLAG_LINE
        42 002732   000000 011000                    NOP     0

      742     4413    5                                       END;

      743     4414    4               CALL CONCAT(OUTPUT_REC,'           02 ',REAL_NAME,

   4414 42 002733   040100 100400                    MLR     fill='040'O
        42 002734   000224 000016 41                 ADSC9   148                      cn=0,n=14
        42 002735   200064 000016                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=14
        42 002736   040100 100500                    MLR     fill='040'O
        42 002737   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30
        42 002740   200067 400036                    ADSC9   OUTPUT_REC+3,,AUTO       cn=2,n=30
        42 002741   040000 236003                    LDQ     16384,DU
        42 002742   200077 756100                    STQ     OUTPUT_REC+11,,AUTO
        42 002743   040100 100500                    MLR     fill='040'O
        42 002744   200144 000043                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=35
        42 002745   200077 200043                    ADSC9   OUTPUT_REC+11,,AUTO      cn=1,n=35

      744     4415    4                  ' ',VARIABLE_TYPE);
      745     4416    4               CALL STORE(OUTPUT_REC);

   4416 42 002746   200064 630500                    EPPR0   OUTPUT_REC,,AUTO
        42 002747   200221 450500                    STP0    @STRING_TO_STORE,,AUTO
        42 002750   002166 701000 42                 TSX1    STORE
        42 002751   000000 011000                    NOP     0

      746     4417    4               END;

      747     4418    3           CALL FETCHNS_6('RC-FR   ') ALTRET(END_COBOL_RECORD);

   4418 42 002752   000120 630400 43                 EPPR0   80
        42 002753   000003 631400 43                 EPPR1   3
        42 002754   000000 701000 xent               TSX1    FETCHNS_6
        42 002755   002762 702000 42                 TSX2    END_COBOL_RECORD

      748     4419    3           END;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:140  

   4419 42 002756   040000 106400                    CMPC    fill='040'O
        42 002757   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 002760   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 002761   002244 601000 42                 TNZ     s:4301

      749     4420    2   END_COBOL_RECORD:
      750     4421    2       RETURN;

   4421 42 002762   200216 221300       END_COBOL_R* LDX1  ! TEMP_WORD+8,,AUTO
        42 002763   000001 702211                    TSX2  ! 1,X1

      751     4422    2   END GET_COBOL_ITEMS;
      752     4423        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:141  
      753     4424        /*
      754     4425              NOW GENERATE THE APL ITEMS FOR THE CURRENT RECORD.
      755     4426        */
      756     4427    1   GET_APL_ITEMS:

   4427 42 002764   200216 741300       GET_APL_ITE* STX1  ! TEMP_WORD+8,,AUTO

      757     4428    1       PROC;
      758     4429    2       STATUS = #IN_ITEM_PROCESSING;

   4429 42 002765   050000 236003                    LDQ     20480,DU
        42 002766   200135 756100                    STQ     STATUS,,AUTO

      759     4430    2       CALL FETCHNS_6 ('RC-FR   ') ALTRET(END_APL_RECORD);

   4430 42 002767   000120 630400 43                 EPPR0   80
        42 002770   000003 631400 43                 EPPR1   3
        42 002771   000000 701000 xent               TSX1    FETCHNS_6
        42 002772   003160 702000 42                 TSX2    END_APL_RECORD

      760     4431    3       DO WHILE (UWA.DB_STATUS ~= '0502100');

   4431 42 002773   040000 106400                    CMPC    fill='040'O
        42 002774   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 002775   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 002776   003160 600000 42                 TZE     END_APL_RECORD

      761     4432    3           IF UWA.FR.SYN = 0 AND UWA.FR.F_USE = 0

   4432 42 002777   000332 235000 0                  LDA     UWA+218
        42 003000   003150 601000 42                 TNZ     s:4462
        42 003001   000343 236000 0                  LDQ     UWA+227
        42 003002   003150 601000 42                 TNZ     s:4462

      762     4433    4           THEN DO;

      763     4434    4               CALL FETCHOS_6('SN-SE   ');
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:142  

   4434 42 003003   000021 630400 43                 EPPR0   17
        42 003004   000003 631400 43                 EPPR1   3
        42 003005   000000 701000 xent               TSX1    FETCHOS_6
        42 003006   000000 011000                    NOP     0

      764     4435    4               CALL CHECK_ALIAS(UWA.SN.SENAME);

   4435 42 003007   000074 236000 43                 LDQ     60
        42 003010   200221 756100                    STQ     @STRING_TO_STORE,,AUTO
        42 003011   005421 701000 42                 TSX1    CHECK_ALIAS
        42 003012   000000 011000                    NOP     0

      765     4436    4               IF UWA.FR.FTYPE=5 OR UWA.FR.FTYPE = 9 OR UWA.FR.FTYPE = 19

   4436 42 003013   000334 235000 0                  LDA     UWA+220
        42 003014   000005 115007                    CMPA    5,DL
        42 003015   003022 600000 42                 TZE     s:4438
        42 003016   000011 115007                    CMPA    9,DL
        42 003017   003022 600000 42                 TZE     s:4438
        42 003020   000023 115007                    CMPA    19,DL
        42 003021   003064 601000 42                 TNZ     s:4445

      766     4437    5               THEN DO;

      767     4438    5                   TEMP_SBIN = UWA.FR.PREC;

   4438 42 003022   000335 236000 0                  LDQ     UWA+221
        42 003023   200162 756100                    STQ     TEMP_SBIN,,AUTO

      768     4439    5                   CALL BINXCHAR(NUM_STRING,-TEMP_SBIN);

   4439 42 003024   200162 335100                    LCA     TEMP_SBIN,,AUTO
        42 003025   200372 755100                    STA     @ERROR_ARRAY+1,,AUTO
        42 003026   000100 301500                    BTD
        42 003027   200372 000004                    NDSC9   @ERROR_ARRAY+1,,AUTO     cn=0,s=lsgnf,sf=0,n=4
        42 003030   200156 010012                    NDSC9   NUM_STRING,,AUTO         cn=0,s=lsgns,sf=0,n=10
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:143  

      769     4440    5                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);

   4440 42 003031   200156 630500                    EPPR0   NUM_STRING,,AUTO
        42 003032   200222 450500                    STP0    @POS+1,,AUTO
        42 003033   200163 631500                    EPPR1   FIRST_NO_ZERO,,AUTO
        42 003034   200221 451500                    STP1    @STRING_TO_STORE,,AUTO
        42 003035   005606 701000 42                 TSX1    LAST_ZERO
        42 003036   000000 011000                    NOP     0

      770     4441    5                   CALL CONCAT( VARIABLE_TYPE,'CHARACTER (',

   4441 42 003037   040100 100400                    MLR     fill='040'O
        42 003040   000230 000013 41                 ADSC9   152                      cn=0,n=11
        42 003041   200144 000013                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=11
        42 003042   200163 720100                    LXL0    FIRST_NO_ZERO,,AUTO
        42 003043   777765 620010                    EAX0    -11,X0
        42 003044   777777 660003                    ERX0    -1,DU
        42 003045   200163 235100                    LDA     FIRST_NO_ZERO,,AUTO
        42 003046   040100 100545                    MLR     fill='040'O
        42 003047   200156 000010                    ADSC9   NUM_STRING,A,AUTO        cn=0,n=*X0
        42 003050   200146 600035                    ADSC9   VARIABLE_TYPE+2,,AUTO    cn=3,n=29
        42 003051   200163 236100                    LDQ     FIRST_NO_ZERO,,AUTO
        42 003052   003055 604000 42                 TMI     s:4441+14
        42 003053   000131 116000 43                 CMPQ    89
        42 003054   003063 604000 42                 TMI     s:4443
        42 003055   000023 621006                    EAX1    19,QL
        42 003056   000122 675000 43                 ERA     82
        42 003057   000001 035007                    ADLA    1,DL
        42 003060   040145 100400                    MLR     fill='040'O
        42 003061   000174 000002 41                 ADSC9   124                      cn=0,n=2
        42 003062   200151 200011                    ADSC9   VARIABLE_TYPE+5,A,AUTO   cn=1,n=*X1

      771     4442    5                      SUBSTR(NUM_STRING,FIRST_NO_ZERO),').');
      772     4443    5                   END;

   4443 42 003063   003131 710000 42                 TRA     s:4458
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:144  

      773     4444    4               ELSE
      774     4445    4                   IF UWA.FR.FTYPE = 1 OR UWA.FR.FTYPE = 2 OR UWA.FR.FTYPE = 0

   4445 42 003064   000001 115007                    CMPA    1,DL
        42 003065   003072 600000 42                 TZE     s:4446
        42 003066   000002 115007                    CMPA    2,DL
        42 003067   003072 600000 42                 TZE     s:4446
        42 003070   000000 115003                    CMPA    0,DU
        42 003071   003076 601000 42                 TNZ     s:4448

      775     4446    4                   THEN VARIABLE_TYPE = 'INTEGER.';

   4446 42 003072   040100 100400                    MLR     fill='040'O
        42 003073   000233 000010 41                 ADSC9   155                      cn=0,n=8
        42 003074   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40
        42 003075   003131 710000 42                 TRA     s:4458

      776     4447    4                   ELSE
      777     4448    4                       IF UWA.FR.FTYPE = 3 OR UWA.FR.FTYPE = 4 OR UWA.FR.FTYPE = 7 OR

   4448 42 003076   000003 115007                    CMPA    3,DL
        42 003077   003116 600000 42                 TZE     s:4452
        42 003100   000004 115007                    CMPA    4,DL
        42 003101   003116 600000 42                 TZE     s:4452
        42 003102   000007 115007                    CMPA    7,DL
        42 003103   003116 600000 42                 TZE     s:4452
        42 003104   000010 115007                    CMPA    8,DL
        42 003105   003116 600000 42                 TZE     s:4452
        42 003106   000013 115007                    CMPA    11,DL
        42 003107   003116 600000 42                 TZE     s:4452
        42 003110   000014 115007                    CMPA    12,DL
        42 003111   003116 600000 42                 TZE     s:4452
        42 003112   000021 115007                    CMPA    17,DL
        42 003113   003116 600000 42                 TZE     s:4452
        42 003114   000022 115007                    CMPA    18,DL
        42 003115   003122 601000 42                 TNZ     s:4455
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:145  

      778     4449    4                          UWA.FR.FTYPE = 8 OR UWA.FR.FTYPE = 11 OR UWA.FR.FTYPE = 12
      779     4450    4                          OR UWA.FR.FTYPE = 17 OR UWA.FR.FTYPE = 18
      780     4451    5                       THEN DO;

      781     4452    5                           VARIABLE_TYPE='DOUBLE PRECISION.';

   4452 42 003116   040100 100400                    MLR     fill='040'O
        42 003117   000235 000021 41                 ADSC9   157                      cn=0,n=17
        42 003120   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      782     4453    5                           END;

   4453 42 003121   003131 710000 42                 TRA     s:4458

      783     4454    5                       ELSE DO;

      784     4455    5                           VARIABLE_TYPE=' **** NO DEFAULT DATA TYPE ****';

   4455 42 003122   040100 100400                    MLR     fill='040'O
        42 003123   000214 000037 41                 ADSC9   140                      cn=0,n=31
        42 003124   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      785     4456    5                           CALL FLAG_LINE(#NO_DEFAULT_TYPE);

   4456 42 003125   000033 236000 43                 LDQ     27
        42 003126   200221 756100                    STQ     @STRING_TO_STORE,,AUTO
        42 003127   005366 701000 42                 TSX1    FLAG_LINE
        42 003130   000000 011000                    NOP     0

      786     4457    5                           END;

      787     4458    4               CALL CONCAT(OUTPUT_REC,'           02 ',REAL_NAME,

   4458 42 003131   040100 100400                    MLR     fill='040'O
        42 003132   000224 000016 41                 ADSC9   148                      cn=0,n=14
        42 003133   200064 000016                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=14
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:146  
        42 003134   040100 100500                    MLR     fill='040'O
        42 003135   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30
        42 003136   200067 400036                    ADSC9   OUTPUT_REC+3,,AUTO       cn=2,n=30
        42 003137   040000 236003                    LDQ     16384,DU
        42 003140   200077 756100                    STQ     OUTPUT_REC+11,,AUTO
        42 003141   040100 100500                    MLR     fill='040'O
        42 003142   200144 000043                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=35
        42 003143   200077 200043                    ADSC9   OUTPUT_REC+11,,AUTO      cn=1,n=35

      788     4459    4                  ' ',VARIABLE_TYPE);
      789     4460    4               CALL STORE(OUTPUT_REC);

   4460 42 003144   200064 630500                    EPPR0   OUTPUT_REC,,AUTO
        42 003145   200221 450500                    STP0    @STRING_TO_STORE,,AUTO
        42 003146   002166 701000 42                 TSX1    STORE
        42 003147   000000 011000                    NOP     0

      790     4461    4               END;

      791     4462    3           CALL FETCHNS_6('RC-FR   ') ALTRET(END_APL_RECORD);

   4462 42 003150   000120 630400 43                 EPPR0   80
        42 003151   000003 631400 43                 EPPR1   3
        42 003152   000000 701000 xent               TSX1    FETCHNS_6
        42 003153   003160 702000 42                 TSX2    END_APL_RECORD

      792     4463    3           END;

   4463 42 003154   040000 106400                    CMPC    fill='040'O
        42 003155   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 003156   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 003157   002777 601000 42                 TNZ     s:4432

      793     4464    2   END_APL_RECORD:
      794     4465    2       RETURN;

   4465 42 003160   200216 221300       END_APL_REC* LDX1  ! TEMP_WORD+8,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:147  
        42 003161   000001 702211                    TSX2  ! 1,X1

      795     4466    2   END GET_APL_ITEMS;
      796     4467        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:148  
      797     4468        /*
      798     4469              NOW GENERATE THE BASIC ITEMS FOR THE CURRENT RECORD.
      799     4470        */
      800     4471    1   GET_BASIC_ITEMS:

   4471 42 003162   200216 741300       GET_BASIC_I* STX1  ! TEMP_WORD+8,,AUTO

      801     4472    1       PROC;
      802     4473    2       STATUS = #IN_ITEM_PROCESSING;

   4473 42 003163   050000 236003                    LDQ     20480,DU
        42 003164   200135 756100                    STQ     STATUS,,AUTO

      803     4474    2       CALL FETCHNS_6 ('RC-FR   ') ALTRET(END_BASIC_RECORD);

   4474 42 003165   000120 630400 43                 EPPR0   80
        42 003166   000003 631400 43                 EPPR1   3
        42 003167   000000 701000 xent               TSX1    FETCHNS_6
        42 003170   003401 702000 42                 TSX2    END_BASIC_RECORD

      804     4475    3       DO WHILE (UWA.DB_STATUS ~= '0502100');

   4475 42 003171   040000 106400                    CMPC    fill='040'O
        42 003172   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 003173   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 003174   003401 600000 42                 TZE     END_BASIC_RECORD

      805     4476    3           IF UWA.FR.SYN = 0 AND UWA.FR.F_USE = 0

   4476 42 003175   000332 235000 0                  LDA     UWA+218
        42 003176   003371 601000 42                 TNZ     s:4514
        42 003177   000343 236000 0                  LDQ     UWA+227
        42 003200   003371 601000 42                 TNZ     s:4514

      806     4477    4           THEN DO;

      807     4478    4               CALL FETCHOS_6('SN-SE   ');
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:149  

   4478 42 003201   000021 630400 43                 EPPR0   17
        42 003202   000003 631400 43                 EPPR1   3
        42 003203   000000 701000 xent               TSX1    FETCHOS_6
        42 003204   000000 011000                    NOP     0

      808     4479    4               CALL CHECK_ALIAS(UWA.SN.SENAME);

   4479 42 003205   000074 236000 43                 LDQ     60
        42 003206   200221 756100                    STQ     @STRING_TO_STORE,,AUTO
        42 003207   005421 701000 42                 TSX1    CHECK_ALIAS
        42 003210   000000 011000                    NOP     0

      809     4480    4               IF UWA.FR.FTYPE=5 OR UWA.FR.FTYPE = 9 OR UWA.FR.FTYPE = 19

   4480 42 003211   000334 235000 0                  LDA     UWA+220
        42 003212   000005 115007                    CMPA    5,DL
        42 003213   003220 600000 42                 TZE     s:4482
        42 003214   000011 115007                    CMPA    9,DL
        42 003215   003220 600000 42                 TZE     s:4482
        42 003216   000023 115007                    CMPA    19,DL
        42 003217   003305 601000 42                 TNZ     s:4496

      810     4481    5               THEN DO;

      811     4482    5                   CALL INDEX1(TEMP_SBIN,' ',REAL_NAME);

   4482 42 003220   000000 124500                    SCM     mask='000'O
        42 003221   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30
        42 003222   000057 000001 43                 ADSC9   47                       cn=0,n=1
        42 003223   200162 000100                    ARG     TEMP_SBIN,,AUTO

      812     4483    6                   IF TEMP_SBIN = LENGTHC(REAL_NAME) THEN DO;

   4483 42 003224   200162 236100                    LDQ     TEMP_SBIN,,AUTO
        42 003225   000036 116007                    CMPQ    30,DL
        42 003226   003240 601000 42                 TNZ     s:4488
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:150  

      813     4484    6                       TEMP_SBIN = TEMP_SBIN - 1;

   4484 42 003227   000001 336007                    LCQ     1,DL
        42 003230   200162 056100                    ASQ     TEMP_SBIN,,AUTO

      814     4485    6                       CALL INSERT(REAL_NAME,TEMP_SBIN,1,'$');

   4485 42 003231   200162 235100                    LDA     TEMP_SBIN,,AUTO
        42 003232   040105 100400                    MLR     fill='040'O
        42 003233   000132 000001 43                 ADSC9   90                       cn=0,n=1
        42 003234   200125 000001                    ADSC9   REAL_NAME,A,AUTO         cn=0,n=1

      815     4486    6                       CALL ADD_A_ALIAS;

   4486 42 003235   006046 701000 42                 TSX1    ADD_A_ALIAS
        42 003236   000000 011000                    NOP     0

      816     4487    6                       END;

   4487 42 003237   003243 710000 42                 TRA     s:4489

      817     4488    5                   ELSE CALL INSERT(REAL_NAME,TEMP_SBIN,1,'$');

   4488 42 003240   040106 100400                    MLR     fill='040'O
        42 003241   000132 000001 43                 ADSC9   90                       cn=0,n=1
        42 003242   200125 000001                    ADSC9   REAL_NAME,Q,AUTO         cn=0,n=1

      818     4489    5                   TEMP_SBIN = UWA.FR.PREC;

   4489 42 003243   000335 235000 0                  LDA     UWA+221
        42 003244   200162 755100                    STA     TEMP_SBIN,,AUTO

      819     4490    5                   CALL BINXCHAR(NUM_STRING,-TEMP_SBIN);

   4490 42 003245   000000 531000                    NEG     0
        42 003246   200372 755100                    STA     @ERROR_ARRAY+1,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:151  
        42 003247   000100 301500                    BTD
        42 003250   200372 000004                    NDSC9   @ERROR_ARRAY+1,,AUTO     cn=0,s=lsgnf,sf=0,n=4
        42 003251   200156 010012                    NDSC9   NUM_STRING,,AUTO         cn=0,s=lsgns,sf=0,n=10

      820     4491    5                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);

   4491 42 003252   200156 630500                    EPPR0   NUM_STRING,,AUTO
        42 003253   200222 450500                    STP0    @POS+1,,AUTO
        42 003254   200163 631500                    EPPR1   FIRST_NO_ZERO,,AUTO
        42 003255   200221 451500                    STP1    @STRING_TO_STORE,,AUTO
        42 003256   005606 701000 42                 TSX1    LAST_ZERO
        42 003257   000000 011000                    NOP     0

      821     4492    5                   CALL CONCAT( VARIABLE_TYPE,'CHARACTER (',

   4492 42 003260   040100 100400                    MLR     fill='040'O
        42 003261   000230 000013 41                 ADSC9   152                      cn=0,n=11
        42 003262   200144 000013                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=11
        42 003263   200163 720100                    LXL0    FIRST_NO_ZERO,,AUTO
        42 003264   777765 620010                    EAX0    -11,X0
        42 003265   777777 660003                    ERX0    -1,DU
        42 003266   200163 235100                    LDA     FIRST_NO_ZERO,,AUTO
        42 003267   040100 100545                    MLR     fill='040'O
        42 003270   200156 000010                    ADSC9   NUM_STRING,A,AUTO        cn=0,n=*X0
        42 003271   200146 600035                    ADSC9   VARIABLE_TYPE+2,,AUTO    cn=3,n=29
        42 003272   200163 236100                    LDQ     FIRST_NO_ZERO,,AUTO
        42 003273   003276 604000 42                 TMI     s:4492+14
        42 003274   000131 116000 43                 CMPQ    89
        42 003275   003304 604000 42                 TMI     s:4494
        42 003276   000023 621006                    EAX1    19,QL
        42 003277   000122 675000 43                 ERA     82
        42 003300   000001 035007                    ADLA    1,DL
        42 003301   040145 100400                    MLR     fill='040'O
        42 003302   000174 000002 41                 ADSC9   124                      cn=0,n=2
        42 003303   200151 200011                    ADSC9   VARIABLE_TYPE+5,A,AUTO   cn=1,n=*X1

      822     4493    5                      SUBSTR(NUM_STRING,FIRST_NO_ZERO),').');
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:152  
      823     4494    5                   END;

   4494 42 003304   003352 710000 42                 TRA     s:4510

      824     4495    4               ELSE
      825     4496    4                   IF UWA.FR.FTYPE = 11

   4496 42 003305   000013 115007                    CMPA    11,DL
        42 003306   003313 601000 42                 TNZ     s:4499

      826     4497    4                   THEN VARIABLE_TYPE = 'SINGLE PRECISION.';

   4497 42 003307   040100 100400                    MLR     fill='040'O
        42 003310   000242 000021 41                 ADSC9   162                      cn=0,n=17
        42 003311   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40
        42 003312   003352 710000 42                 TRA     s:4510

      827     4498    4                   ELSE
      828     4499    4                       IF UWA.FR.FTYPE = 3 OR UWA.FR.FTYPE = 4 OR UWA.FR.FTYPE = 7 OR

   4499 42 003313   000003 115007                    CMPA    3,DL
        42 003314   003337 600000 42                 TZE     s:4504
        42 003315   000004 115007                    CMPA    4,DL
        42 003316   003337 600000 42                 TZE     s:4504
        42 003317   000007 115007                    CMPA    7,DL
        42 003320   003337 600000 42                 TZE     s:4504
        42 003321   000000 115003                    CMPA    0,DU
        42 003322   003337 600000 42                 TZE     s:4504
        42 003323   000001 115007                    CMPA    1,DL
        42 003324   003337 600000 42                 TZE     s:4504
        42 003325   000002 115007                    CMPA    2,DL
        42 003326   003337 600000 42                 TZE     s:4504
        42 003327   000010 115007                    CMPA    8,DL
        42 003330   003337 600000 42                 TZE     s:4504
        42 003331   000014 115007                    CMPA    12,DL
        42 003332   003337 600000 42                 TZE     s:4504
        42 003333   000021 115007                    CMPA    17,DL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:153  
        42 003334   003337 600000 42                 TZE     s:4504
        42 003335   000022 115007                    CMPA    18,DL
        42 003336   003343 601000 42                 TNZ     s:4507

      829     4500    4                          UWA.FR.FTYPE = 0 OR UWA.FR.FTYPE = 1 OR UWA.FR.FTYPE = 2 OR
      830     4501    4                          UWA.FR.FTYPE = 8 OR UWA.FR.FTYPE = 12
      831     4502    4                          OR UWA.FR.FTYPE = 17 OR UWA.FR.FTYPE = 18
      832     4503    5                       THEN DO;

      833     4504    5                           VARIABLE_TYPE='DOUBLE PRECISION.';

   4504 42 003337   040100 100400                    MLR     fill='040'O
        42 003340   000235 000021 41                 ADSC9   157                      cn=0,n=17
        42 003341   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      834     4505    5                           END;

   4505 42 003342   003352 710000 42                 TRA     s:4510

      835     4506    5                       ELSE DO;

      836     4507    5                           VARIABLE_TYPE=' **** NO DEFAULT DATA TYPE ****';

   4507 42 003343   040100 100400                    MLR     fill='040'O
        42 003344   000214 000037 41                 ADSC9   140                      cn=0,n=31
        42 003345   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      837     4508    5                           CALL FLAG_LINE(#NO_DEFAULT_TYPE);

   4508 42 003346   000033 236000 43                 LDQ     27
        42 003347   200221 756100                    STQ     @STRING_TO_STORE,,AUTO
        42 003350   005366 701000 42                 TSX1    FLAG_LINE
        42 003351   000000 011000                    NOP     0

      838     4509    5                           END;

      839     4510    4               CALL CONCAT(OUTPUT_REC,'           02 ',REAL_NAME,
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:154  

   4510 42 003352   040100 100400                    MLR     fill='040'O
        42 003353   000224 000016 41                 ADSC9   148                      cn=0,n=14
        42 003354   200064 000016                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=14
        42 003355   040100 100500                    MLR     fill='040'O
        42 003356   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30
        42 003357   200067 400036                    ADSC9   OUTPUT_REC+3,,AUTO       cn=2,n=30
        42 003360   040000 236003                    LDQ     16384,DU
        42 003361   200077 756100                    STQ     OUTPUT_REC+11,,AUTO
        42 003362   040100 100500                    MLR     fill='040'O
        42 003363   200144 000043                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=35
        42 003364   200077 200043                    ADSC9   OUTPUT_REC+11,,AUTO      cn=1,n=35

      840     4511    4                  ' ',VARIABLE_TYPE);
      841     4512    4               CALL STORE(OUTPUT_REC);

   4512 42 003365   200064 630500                    EPPR0   OUTPUT_REC,,AUTO
        42 003366   200221 450500                    STP0    @STRING_TO_STORE,,AUTO
        42 003367   002166 701000 42                 TSX1    STORE
        42 003370   000000 011000                    NOP     0

      842     4513    4               END;

      843     4514    3           CALL FETCHNS_6('RC-FR   ') ALTRET(END_BASIC_RECORD);

   4514 42 003371   000120 630400 43                 EPPR0   80
        42 003372   000003 631400 43                 EPPR1   3
        42 003373   000000 701000 xent               TSX1    FETCHNS_6
        42 003374   003401 702000 42                 TSX2    END_BASIC_RECORD

      844     4515    3           END;

   4515 42 003375   040000 106400                    CMPC    fill='040'O
        42 003376   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 003377   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 003400   003175 601000 42                 TNZ     s:4476

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:155  
      845     4516    2   END_BASIC_RECORD:
      846     4517    2       RETURN;

   4517 42 003401   200216 221300       END_BASIC_R* LDX1  ! TEMP_WORD+8,,AUTO
        42 003402   000001 702211                    TSX2  ! 1,X1

      847     4518    2   END GET_BASIC_ITEMS;
      848     4519        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:156  
      849     4520        /*
      850     4521              NOW GENERATE THE FORTRAN ITEMS FOR THE CURRENT RECORD.
      851     4522        */
      852     4523    1   GET_FORTRAN_ITEMS:

   4523 42 003403   200216 741300       GET_FORTRAN* STX1  ! TEMP_WORD+8,,AUTO

      853     4524    1       PROC;
      854     4525    2       STATUS = #IN_ITEM_PROCESSING;

   4525 42 003404   050000 236003                    LDQ     20480,DU
        42 003405   200135 756100                    STQ     STATUS,,AUTO

      855     4526    2       CALL FETCHNS_6 ('RC-FR   ') ALTRET(END_FORTRAN_RECORD);

   4526 42 003406   000120 630400 43                 EPPR0   80
        42 003407   000003 631400 43                 EPPR1   3
        42 003410   000000 701000 xent               TSX1    FETCHNS_6
        42 003411   003614 702000 42                 TSX2    END_FORTRAN_RECORD

      856     4527    3       DO WHILE (UWA.DB_STATUS ~= '0502100');

   4527 42 003412   040000 106400                    CMPC    fill='040'O
        42 003413   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 003414   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 003415   003614 600000 42                 TZE     END_FORTRAN_RECORD

      857     4528    3           IF UWA.FR.SYN = 0 AND UWA.FR.F_USE = 0

   4528 42 003416   000332 235000 0                  LDA     UWA+218
        42 003417   003604 601000 42                 TNZ     s:4561
        42 003420   000343 236000 0                  LDQ     UWA+227
        42 003421   003604 601000 42                 TNZ     s:4561

      858     4529    4           THEN DO;

      859     4530    4               CALL FETCHOS_6('SN-SE   ');
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:157  

   4530 42 003422   000021 630400 43                 EPPR0   17
        42 003423   000003 631400 43                 EPPR1   3
        42 003424   000000 701000 xent               TSX1    FETCHOS_6
        42 003425   000000 011000                    NOP     0

      860     4531    4               CALL CHECK_ALIAS(UWA.SN.SENAME);

   4531 42 003426   000074 236000 43                 LDQ     60
        42 003427   200221 756100                    STQ     @STRING_TO_STORE,,AUTO
        42 003430   005421 701000 42                 TSX1    CHECK_ALIAS
        42 003431   000000 011000                    NOP     0

      861     4532    4               IF UWA.FR.FTYPE=5 OR UWA.FR.FTYPE = 9 OR UWA.FR.FTYPE = 19

   4532 42 003432   000334 235000 0                  LDA     UWA+220
        42 003433   000005 115007                    CMPA    5,DL
        42 003434   003441 600000 42                 TZE     s:4534
        42 003435   000011 115007                    CMPA    9,DL
        42 003436   003441 600000 42                 TZE     s:4534
        42 003437   000023 115007                    CMPA    19,DL
        42 003440   003471 601000 42                 TNZ     s:4541

      862     4533    5               THEN DO;

      863     4534    5                   TEMP_SBIN = UWA.FR.PREC;

   4534 42 003441   000335 236000 0                  LDQ     UWA+221
        42 003442   200162 756100                    STQ     TEMP_SBIN,,AUTO

      864     4535    5                   CALL BINXCHAR(NUM_STRING,-TEMP_SBIN);

   4535 42 003443   200162 335100                    LCA     TEMP_SBIN,,AUTO
        42 003444   200372 755100                    STA     @ERROR_ARRAY+1,,AUTO
        42 003445   000100 301500                    BTD
        42 003446   200372 000004                    NDSC9   @ERROR_ARRAY+1,,AUTO     cn=0,s=lsgnf,sf=0,n=4
        42 003447   200156 010012                    NDSC9   NUM_STRING,,AUTO         cn=0,s=lsgns,sf=0,n=10
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:158  

      865     4536    5                   CALL LAST_ZERO(FIRST_NO_ZERO,NUM_STRING);

   4536 42 003450   200156 630500                    EPPR0   NUM_STRING,,AUTO
        42 003451   200222 450500                    STP0    @POS+1,,AUTO
        42 003452   200163 631500                    EPPR1   FIRST_NO_ZERO,,AUTO
        42 003453   200221 451500                    STP1    @STRING_TO_STORE,,AUTO
        42 003454   005606 701000 42                 TSX1    LAST_ZERO
        42 003455   000000 011000                    NOP     0

      866     4537    5                   CALL CONCAT( VARIABLE_TYPE,'CHARACTER*',

   4537 42 003456   040100 100400                    MLR     fill='040'O
        42 003457   000247 000012 41                 ADSC9   167                      cn=0,n=10
        42 003460   200144 000012                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=10
        42 003461   200163 720100                    LXL0    FIRST_NO_ZERO,,AUTO
        42 003462   777765 620010                    EAX0    -11,X0
        42 003463   777777 660003                    ERX0    -1,DU
        42 003464   200163 235100                    LDA     FIRST_NO_ZERO,,AUTO
        42 003465   040100 100545                    MLR     fill='040'O
        42 003466   200156 000010                    ADSC9   NUM_STRING,A,AUTO        cn=0,n=*X0
        42 003467   200146 400036                    ADSC9   VARIABLE_TYPE+2,,AUTO    cn=2,n=30

      867     4538    5                      SUBSTR(NUM_STRING,FIRST_NO_ZERO));
      868     4539    5                   END;

   4539 42 003470   003556 710000 42                 TRA     s:4557

      869     4540    4               ELSE
      870     4541    5               DO CASE (UWA.FR.FTYPE);

   4541 42 003471   000023 115007                    CMPA    19,DL
        42 003472   003474 602005 42                 TNC     s:4541+3,AL
        42 003473   003547 710000 42                 TRA     s:4554
        42 003474   003517 710000 42                 TRA     s:4543
        42 003475   003517 710000 42                 TRA     s:4543
        42 003476   003517 710000 42                 TRA     s:4543
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:159  
        42 003477   003533 710000 42                 TRA     s:4549
        42 003500   003533 710000 42                 TRA     s:4549
        42 003501   003547 710000 42                 TRA     s:4554
        42 003502   003547 710000 42                 TRA     s:4554
        42 003503   003527 710000 42                 TRA     s:4547
        42 003504   003533 710000 42                 TRA     s:4549
        42 003505   003547 710000 42                 TRA     s:4554
        42 003506   003547 710000 42                 TRA     s:4554
        42 003507   003523 710000 42                 TRA     s:4545
        42 003510   003527 710000 42                 TRA     s:4547
        42 003511   003547 710000 42                 TRA     s:4554
        42 003512   003547 710000 42                 TRA     s:4554
        42 003513   003547 710000 42                 TRA     s:4554
        42 003514   003547 710000 42                 TRA     s:4554
        42 003515   003533 710000 42                 TRA     s:4549
        42 003516   003527 710000 42                 TRA     s:4547

      871     4542    5               CASE (0, 1, 2);

      872     4543    5                   VARIABLE_TYPE = 'INTEGER';

   4543 42 003517   040100 100400                    MLR     fill='040'O
        42 003520   000233 000007 41                 ADSC9   155                      cn=0,n=7
        42 003521   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40
        42 003522   003556 710000 42                 TRA     s:4557

      873     4544    5               CASE (11);

      874     4545    5                   VARIABLE_TYPE = 'REAL';

   4545 42 003523   040100 100400                    MLR     fill='040'O
        42 003524   000252 000004 41                 ADSC9   170                      cn=0,n=4
        42 003525   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40
        42 003526   003556 710000 42                 TRA     s:4557

      875     4546    5               CASE (7, 12, 18);

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:160  
      876     4547    5                   VARIABLE_TYPE = 'DOUBLE PRECISION';

   4547 42 003527   040100 100400                    MLR     fill='040'O
        42 003530   000235 000020 41                 ADSC9   157                      cn=0,n=16
        42 003531   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40
        42 003532   003556 710000 42                 TRA     s:4557

      877     4548    5               CASE (3, 4, 8, 17);

      878     4549    5                   IF SSGEN.MAP = '0'B THEN

   4549 42 003533   000022 236000 12                 LDQ     SSGEN+18
        42 003534   000400 316007                    CANQ    256,DL
        42 003535   003541 601000 42                 TNZ     s:4551

      879     4550    5                       VARIABLE_TYPE = 'REAL';

   4550 42 003536   040100 100400                    MLR     fill='040'O
        42 003537   000252 000004 41                 ADSC9   170                      cn=0,n=4
        42 003540   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      880     4551    5                   IF SSGEN.MAP = '1'B THEN

   4551 42 003541   000400 316007                    CANQ    256,DL
        42 003542   003556 600000 42                 TZE     s:4557

      881     4552    5                       VARIABLE_TYPE = 'DOUBLE PRECISION';

   4552 42 003543   040100 100400                    MLR     fill='040'O
        42 003544   000235 000020 41                 ADSC9   157                      cn=0,n=16
        42 003545   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40
        42 003546   003556 710000 42                 TRA     s:4557

      882     4553    5               CASE (ELSE);

      883     4554    5                   VARIABLE_TYPE = ' **** NO DEFAULT DATA TYPE **** ';

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:161  
   4554 42 003547   040100 100400                    MLR     fill='040'O
        42 003550   000214 000040 41                 ADSC9   140                      cn=0,n=32
        42 003551   200144 000050                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=40

      884     4555    5                   CALL FLAG_LINE (#NO_DEFAULT_TYPE);

   4555 42 003552   000033 236000 43                 LDQ     27
        42 003553   200221 756100                    STQ     @STRING_TO_STORE,,AUTO
        42 003554   005366 701000 42                 TSX1    FLAG_LINE
        42 003555   000000 011000                    NOP     0

      885     4556    5                   END; /* case */

      886     4557    4               CALL CONCAT(OUTPUT_REC,'       ',SUBSTR(VARIABLE_TYPE,0,20),

   4557 42 003556   040100 100400                    MLR     fill='040'O
        42 003557   000023 000007 41                 ADSC9   19                       cn=0,n=7
        42 003560   200064 000007                    ADSC9   OUTPUT_REC,,AUTO         cn=0,n=7
        42 003561   040100 100500                    MLR     fill='040'O
        42 003562   200144 000024                    ADSC9   VARIABLE_TYPE,,AUTO      cn=0,n=20
        42 003563   200065 600024                    ADSC9   OUTPUT_REC+1,,AUTO       cn=3,n=20
        42 003564   200140 720100                    LXL0    LEN_REAL_NAME,,AUTO
        42 003565   040100 100540                    MLR     fill='040'O
        42 003566   200125 000010                    ADSC9   REAL_NAME,,AUTO          cn=0,n=*X0
        42 003567   200072 600065                    ADSC9   OUTPUT_REC+6,,AUTO       cn=3,n=53
        42 003570   200140 236100                    LDQ     LEN_REAL_NAME,,AUTO
        42 003571   000065 116007                    CMPQ    53,DL
        42 003572   003600 603000 42                 TRC     s:4559
        42 003573   777712 621006                    EAX1    -54,QL
        42 003574   777777 661003                    ERX1    -1,DU
        42 003575   040146 100400                    MLR     fill='040'O
        42 003576   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 003577   200072 600011                    ADSC9   OUTPUT_REC+6,Q,AUTO      cn=3,n=*X1

      887     4558    4                  SUBSTR(REAL_NAME,0,LEN_REAL_NAME),'.');
      888     4559    4               CALL STORE(OUTPUT_REC);

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:162  
   4559 42 003600   200064 630500                    EPPR0   OUTPUT_REC,,AUTO
        42 003601   200221 450500                    STP0    @STRING_TO_STORE,,AUTO
        42 003602   002166 701000 42                 TSX1    STORE
        42 003603   000000 011000                    NOP     0

      889     4560    4               END;

      890     4561    3           CALL FETCHNS_6('RC-FR   ') ALTRET(END_FORTRAN_RECORD);

   4561 42 003604   000120 630400 43                 EPPR0   80
        42 003605   000003 631400 43                 EPPR1   3
        42 003606   000000 701000 xent               TSX1    FETCHNS_6
        42 003607   003614 702000 42                 TSX2    END_FORTRAN_RECORD

      891     4562    3           END;

   4562 42 003610   040000 106400                    CMPC    fill='040'O
        42 003611   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
        42 003612   000055 000007 41                 ADSC9   45                       cn=0,n=7
        42 003613   003416 601000 42                 TNZ     s:4528

      892     4563    2   END_FORTRAN_RECORD:
      893     4564    2       RETURN;

   4564 42 003614   200216 221300       END_FORTRAN* LDX1  ! TEMP_WORD+8,,AUTO
        42 003615   000001 702211                    TSX2  ! 1,X1

      894     4565    2   END GET_FORTRAN_ITEMS;
      895     4566        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:163  
      896     4567        /*
      897     4568            THIS SUBROUTINE CHANGES COBOL WORDS INTO SCHEMA WORDS '-' TO '_'.
      898     4569        */
      899     4570    1   CHANGE_TO_STR:

   4570 42 003616   200322 741300       CHANGE_TO_S* STX1  ! I+63,,AUTO

      900     4571    1       PROC (CHANGE_STR);
      901     4572    2   DCL CHANGE_STR CHAR (30);
      902     4573    2   DCL COUNT1 UBIN (36);
      903     4574    2   DCL ONE_CHANGE (0:4) CHAR (2) STATIC INIT ('  ',
      904     4575    2    '_-' /* COBOL */, '_$' /* FORTRAN */, '__' /* APL */, '__' /* BASIC */);
      905     4576    2       IF SUB_LANGUAGE = #APL OR SUB_LANGUAGE = #BASIC THEN RETURN;

   4576 42 003617   000000 235000 30                 LDA     SUB_LANGUAGE
        42 003620   000003 115007                    CMPA    3,DL
        42 003621   003624 600000 42                 TZE     s:4576+5
        42 003622   000004 115007                    CMPA    4,DL
        42 003623   003625 601000 42                 TNZ     s:4578

   4576 42 003624   000001 702211                    TSX2  ! 1,X1

      906     4577    3       DO WHILE ('1'B);

      907     4578    3           CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),1,1),CHANGE_STR)

   4578 42 003625   000000 235000 30                 LDA     SUB_LANGUAGE
        42 003626   000001 735000                    ALS     1
        42 003627   200323 470500                    LDP0    @CHANGE_STR,,AUTO
        42 003630   000005 124500                    SCM     mask='000'O
        42 003631   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        42 003632   000150 200001 2                  ADSC9   ONE_CHANGE,A             cn=1,n=1
        42 003633   200324 000100                    ARG     COUNT1,,AUTO
        42 003634   003642 606400 42                 TTN     ALT

      908     4579    3              ALTRET (ALT);
      909     4580    3           CALL INSERT(CHANGE_STR,COUNT1,1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1));
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:164  

   4580 42 003635   200324 236100                    LDQ     COUNT1,,AUTO
        42 003636   040106 100405                    MLR     fill='040'O
        42 003637   000150 000001 2                  ADSC9   ONE_CHANGE,A             cn=0,n=1
        42 003640   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

      910     4581    3           END;

   4581 42 003641   003625 710000 42                 TRA     s:4578

      911     4582    2   ALT:
      912     4583    2       RETURN;

   4583 42 003642   200322 221300       ALT          LDX1  ! I+63,,AUTO
        42 003643   000001 702211                    TSX2  ! 1,X1

      913     4584    2   END CHANGE_TO_STR;
      914     4585        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:165  
      915     4586        /*
      916     4587            Now comes the subroutinue that generates all the aliases
      917     4588          for this subschema.
      918     4589        */
      919     4590    1   GEN_ALIASES:

   4590 42 003644   200216 741300       GEN_ALIASES  STX1  ! TEMP_WORD+8,,AUTO
        42 003645   003736 710000 42                 TRA     s:4617

      920     4591    1       PROC;
      921     4592    2   DCL I UBIN (36);
      922     4593    2   DCL J UBIN (36);
      923     4594    2   DCL CHAR_256 CHAR (256);
      924     4595    2   ALIAS_WRITER:

   4595 42 003646   200322 741300       ALIAS_WRITER STX1  ! I+63,,AUTO

      925     4596    2       PROC;
      926     4597    3   DCL I UBIN (36);
      927     4598    3   DCL J UBIN (36);
      928     4599    3       CALL INDEX1R(I,'.',CHAR_256);

   4599 42 003647   000000 125500                    SCMR    mask='000'O
        42 003650   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256
        42 003651   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 003652   200323 000100                    ARG     I,,AUTO
        42 003653   003656 606400 42                 TTN     s:4600
        42 003654   000377 236007                    LDQ     255,DL
        42 003655   200323 156100                    SSQ     I,,AUTO

      929     4600    3       IF I > 77

   4600 42 003656   200323 235100                    LDA     I,,AUTO
        42 003657   000116 115007                    CMPA    78,DL
        42 003660   003725 602000 42                 TNC     s:4613

      930     4601    4       THEN DO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:166  

      931     4602    4           CALL INDEX1R(J,'=',CHAR_256);

   4602 42 003661   000000 125500                    SCMR    mask='000'O
        42 003662   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256
        42 003663   000133 000001 43                 ADSC9   91                       cn=0,n=1
        42 003664   200324 000100                    ARG     J,,AUTO
        42 003665   003670 606400 42                 TTN     s:4603
        42 003666   000377 236007                    LDQ     255,DL
        42 003667   200324 156100                    SSQ     J,,AUTO

      932     4603    4           O_REC.STRING = SUBSTR(CHAR_256,0,J+1);

   4603 42 003670   200324 720100                    LXL0    J,,AUTO
        42 003671   000001 622010                    EAX2    1,X0
        42 003672   040000 100540                    MLR     fill='040'O
        42 003673   200221 000012                    ADSC9   CHAR_256,,AUTO           cn=0,n=*X2
        42 003674   000001 000264 36                 ADSC9   O_REC+1                  cn=0,n=180

      933     4604    4           CALL WRITER(O_REC);

   4604 42 003675   000110 236000 43                 LDQ     72
        42 003676   200327 756100                    STQ     @O_REC,,AUTO
        42 003677   002134 701000 42                 TSX1    WRITER
        42 003700   000000 011000                    NOP     0

      934     4605    4           CALL CONCAT(O_REC.STRING,'            ',SUBSTR(CHAR_256,J+1));

   4605 42 003701   040000 100400                    MLR     fill='040'O
        42 003702   000047 000014 41                 ADSC9   39                       cn=0,n=12
        42 003703   000001 000014 36                 ADSC9   O_REC+1                  cn=0,n=12
        42 003704   200324 720100                    LXL0    J,,AUTO
        42 003705   777400 620010                    EAX0    -256,X0
        42 003706   777777 660003                    ERX0    -1,DU
        42 003707   200324 235100                    LDA     J,,AUTO
        42 003710   040000 100545                    MLR     fill='040'O
        42 003711   200221 200010                    ADSC9   CHAR_256,A,AUTO          cn=1,n=*X0
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:167  
        42 003712   000004 000250 36                 ADSC9   O_REC+4                  cn=0,n=168

      935     4606    4           IF SUB_LANGUAGE = #FORTRAN

   4606 42 003713   000000 235000 30                 LDA     SUB_LANGUAGE
        42 003714   000002 115007                    CMPA    2,DL
        42 003715   003720 601000 42                 TNZ     s:4610

      936     4607    5           THEN DO;

      937     4608    5               CALL INSERT(O_REC.STRING,5,1,'*');

   4608 42 003716   000052 236003                    LDQ     42,DU
        42 003717   000002 552020 36                 STBQ    O_REC+2,'20'O

      938     4609    5               END;

      939     4610    4           CALL WRITER(O_REC);

   4610 42 003720   000110 236000 43                 LDQ     72
        42 003721   200327 756100                    STQ     @O_REC,,AUTO
        42 003722   002134 701000 42                 TSX1    WRITER
        42 003723   000000 011000                    NOP     0

      940     4611    4           END;

   4611 42 003724   003734 710000 42                 TRA     s:4616

      941     4612    4       ELSE DO;

      942     4613    4           O_REC.STRING = CHAR_256;

   4613 42 003725   040000 100500                    MLR     fill='040'O
        42 003726   200221 000264                    ADSC9   CHAR_256,,AUTO           cn=0,n=180
        42 003727   000001 000264 36                 ADSC9   O_REC+1                  cn=0,n=180

      943     4614    4           CALL WRITER(O_REC);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:168  

   4614 42 003730   000110 236000 43                 LDQ     72
        42 003731   200327 756100                    STQ     @O_REC,,AUTO
        42 003732   002134 701000 42                 TSX1    WRITER
        42 003733   000000 011000                    NOP     0

      944     4615    4           END;

      945     4616    3   END ALIAS_WRITER;

   4616 42 003734   200322 221300                    LDX1  ! I+63,,AUTO
        42 003735   000001 702211                    TSX2  ! 1,X1

      946     4617    2       IF SUB_LANGUAGE = #COBOL

   4617 42 003736   000000 235000 30                 LDA     SUB_LANGUAGE
        42 003737   000001 115007                    CMPA    1,DL
        42 003740   003744 601000 42                 TNZ     s:4621

      947     4618    3       THEN DO;

      948     4619    3           CHAR_256='         ALIAS SECTION.';

   4619 42 003741   040100 100400                    MLR     fill='040'O
        42 003742   000253 000027 41                 ADSC9   171                      cn=0,n=23
        42 003743   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

      949     4620    3           END;

      950     4621    2       FIRST_GEN_ALIAS='1'B;

   4621 42 003744   400000 236003                    LDQ     -131072,DU
        42 003745   200173 756100                    STQ     FIRST_GEN_ALIAS,,AUTO

      951     4622    3       DO I = 0 TO 808;

   4622 42 003746   200217 450100                    STZ     I,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:169  

      952     4623    3           NPTR$ = HAS_TABLE(I);

   4623 42 003747   200217 720100                    LXL0    I,,AUTO
        42 003750   000000 236010 38                 LDQ     HAS_TABLE,X0
        42 003751   200165 756100                    STQ     NPTR$,,AUTO

      953     4624    4           DO WHILE (NPTR$ ~= ADDR(NIL) AND NPTR$->HASH_STRUCT.TYPE =0);

   4624 42 003752   003756 710000 42                 TRA     s:4626

      954     4625    4               NPTR$ = NPTR$ -> HASH_STRUCT.PTR$;

   4625 42 003753   200165 470500                    LDP0    NPTR$,,AUTO
        42 003754   000010 236100                    LDQ     8,,PR0
        42 003755   200165 756100                    STQ     NPTR$,,AUTO

      955     4626    4               END;

   4626 42 003756   000067 116000 43                 CMPQ    55
        42 003757   003764 600000 42                 TZE     s:4627
        42 003760   200165 470500                    LDP0    NPTR$,,AUTO
        42 003761   000000 236100                    LDQ     0,,PR0
        42 003762   070000 316003                    CANQ    28672,DU
        42 003763   003753 600000 42                 TZE     s:4625

      956     4627    4           DO WHILE (NPTR$ ~= ADDR(NIL) AND NPTR$ ->HASH_STRUCT.TYPE =6

   4627 42 003764   004541 710000 42                 TRA     s:4702

      957     4628    4              AND NPTR$ -> HASH_STRUCT.DUPS = 1);
      958     4629    4               IF FIRST_GEN_ALIAS

   4629 42 003765   200173 234100                    SZN     FIRST_GEN_ALIAS,,AUTO
        42 003766   004001 605000 42                 TPL     s:4640

      959     4630    5               THEN DO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:170  

      960     4631    5                   IF SUB_LANGUAGE=#COBOL THEN CALL ALIAS_WRITER;

   4631 42 003767   000000 235000 30                 LDA     SUB_LANGUAGE
        42 003770   000001 115007                    CMPA    1,DL
        42 003771   003774 601000 42                 TNZ     s:4632

   4631 42 003772   003646 701000 42                 TSX1    ALIAS_WRITER
        42 003773   000000 011000                    NOP     0

      961     4632    5                   CALL WARNING(#GEN_ALIASES);

   4632 42 003774   000135 630400 43                 EPPR0   93
        42 003775   000003 631400 43                 EPPR1   3
        42 003776   000000 701000 xent               TSX1    WARNING
        42 003777   000000 011000                    NOP     0

      962     4633        /*E*     ERROR:    ZIG-#GEN_ALIASES-C
      963     4634        MESSAGE: Warning: The following aliases have been generated by the
      964     4635                 generation of the subschema. So, these names have changed
      965     4636                 from the schema to the subschema.
      966     4637        */
      967     4638    5                   FIRST_GEN_ALIAS = '0'B;

   4638 42 004000   200173 450100                    STZ     FIRST_GEN_ALIAS,,AUTO

      968     4639    5                   END;

      969     4640    4               CALL CHECK_CHAR_SET(NPTR$->H_ALIAS.SUB$

   4640 42 004001   200165 470500                    LDP0    NPTR$,,AUTO
        42 004002   000100 100500                    MLR     fill='000'O
        42 004003   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004004   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004005   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004006   200170 633500                    EPPR3   POS,,AUTO
        42 004007   200325 453500                    STP3    @MUST_ALIAS+1,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:171  
        42 004010   200166 634500                    EPPR4   ERROR_STATUS,,AUTO
        42 004011   200324 454500                    STP4    COUNT1,,AUTO
        42 004012   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004013   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004014   400000 036007                    ADLQ    -131072,DL
        42 004015   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004016   005631 701000 42                 TSX1    CHECK_CHAR_SET
        42 004017   000000 011000                    NOP     0

      970     4641    4                  -> HASH_STRUCT.C_NAME,ERROR_STATUS,POS);
      971     4642    4               CALL FIND_LENGTH(NPTR$ -> H_ALIAS.SUB$

   4642 42 004020   200165 470500                    LDP0    NPTR$,,AUTO
        42 004021   000100 100500                    MLR     fill='000'O
        42 004022   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004023   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004024   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004025   200137 633500                    EPPR3   SCHEMA_NAME_LENGHT,,AUTO
        42 004026   200324 453500                    STP3    COUNT1,,AUTO
        42 004027   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004030   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004031   400000 036007                    ADLQ    -131072,DL
        42 004032   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004033   002212 701000 42                 TSX1    FIND_LENGTH
        42 004034   000000 011000                    NOP     0

      972     4643    4                  -> HASH_STRUCT.C_NAME,SCHEMA_NAME_LENGHT);
      973     4644    4               CALL FIND_LENGTH(NPTR$ -> H_ALIAS.C_NAME,SUB_NAME_LENGHT);

   4644 42 004035   200136 630500                    EPPR0   SUB_NAME_LENGHT,,AUTO
        42 004036   200324 450500                    STP0    COUNT1,,AUTO
        42 004037   200165 236100                    LDQ     NPTR$,,AUTO
        42 004040   400000 036007                    ADLQ    -131072,DL
        42 004041   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004042   002212 701000 42                 TSX1    FIND_LENGTH
        42 004043   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:172  
      974     4645    4               CALL CHANGE_TO_STR(NPTR$ -> H_ALIAS.SUB$

   4645 42 004044   200165 470500                    LDP0    NPTR$,,AUTO
        42 004045   000100 100500                    MLR     fill='000'O
        42 004046   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004047   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004050   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004051   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004052   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004053   400000 036007                    ADLQ    -131072,DL
        42 004054   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004055   003616 701000 42                 TSX1    CHANGE_TO_STR
        42 004056   000000 011000                    NOP     0

      975     4646    4                  -> HASH_STRUCT.C_NAME);
      976     4647    4               IF SUB_LANGUAGE = #COBOL

   4647 42 004057   000000 235000 30                 LDA     SUB_LANGUAGE
        42 004060   000001 115007                    CMPA    1,DL
        42 004061   004315 601000 42                 TNZ     s:4676

      977     4648    5               THEN DO;

      978     4649    5                   IF NPTR$ -> HASH_STRUCT.ALIAS_TYPE = 5

   4649 42 004062   200165 470500                    LDP0    NPTR$,,AUTO
        42 004063   000000 236100                    LDQ     0,,PR0
        42 004064   700000 376003                    ANQ     -32768,DU
        42 004065   500000 116003                    CMPQ    -98304,DU
        42 004066   004222 601000 42                 TNZ     s:4665

      979     4650    6                   THEN DO;

      980     4651    6                       CALL FIND_LENGTH(NPTR$ -> H_ALIAS.QUAL$

   4651 42 004067   000100 100500                    MLR     fill='000'O
        42 004070   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:173  
        42 004071   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004072   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004073   200220 633500                    EPPR3   J,,AUTO
        42 004074   200324 453500                    STP3    COUNT1,,AUTO
        42 004075   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004076   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004077   400000 036007                    ADLQ    -131072,DL
        42 004100   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004101   002212 701000 42                 TSX1    FIND_LENGTH
        42 004102   000000 011000                    NOP     0

      981     4652    6                          -> HASH_STRUCT.C_NAME,J);
      982     4653    6                       CALL CHANGE_TO_STR(NPTR$ -> H_ALIAS.QUAL$

   4653 42 004103   200165 470500                    LDP0    NPTR$,,AUTO
        42 004104   000100 100500                    MLR     fill='000'O
        42 004105   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 004106   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004107   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004110   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004111   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004112   400000 036007                    ADLQ    -131072,DL
        42 004113   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004114   003616 701000 42                 TSX1    CHANGE_TO_STR
        42 004115   000000 011000                    NOP     0

      983     4654    6                          -> HASH_STRUCT.C_NAME);
      984     4655    6                       CHAR_256='           AD ==';

   4655 42 004116   040100 100400                    MLR     fill='040'O
        42 004117   000261 000020 41                 ADSC9   177                      cn=0,n=16
        42 004120   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

      985     4656    6                       CALL INSERT(CHAR_256,16,160,

   4656 42 004121   200165 470500                    LDP0    NPTR$,,AUTO
        42 004122   000100 100500                    MLR     fill='000'O
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:174  
        42 004123   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 004124   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004125   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004126   000100 100500                    MLR     fill='000'O
        42 004127   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004130   200373 000004                    ADSC9   @ERROR_ARRAY+2,,AUTO     cn=0,n=4
        42 004131   200373 473500                    LDP3    @ERROR_ARRAY+2,,AUTO
        42 004132   200220 720100                    LXL0    J,,AUTO
        42 004133   040100 100540                    MLR     fill='040'O
        42 004134   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
        42 004135   200225 000240                    ADSC9   I+2,,AUTO                cn=0,n=160
        42 004136   200220 236100                    LDQ     J,,AUTO
        42 004137   000240 116007                    CMPQ    160,DL
        42 004140   004221 603000 42                 TRC     s:4663
        42 004141   777537 621006                    EAX1    -161,QL
        42 004142   777777 661003                    ERX1    -1,DU
        42 004143   040146 100400                    MLR     fill='040'O
        42 004144   000265 000002 41                 ADSC9   181                      cn=0,n=2
        42 004145   200225 000011                    ADSC9   I+2,Q,AUTO               cn=0,n=*X1
        42 004146   000236 116007                    CMPQ    158,DL
        42 004147   004221 603000 42                 TRC     s:4663
        42 004150   777541 622006                    EAX2    -159,QL
        42 004151   777777 662003                    ERX2    -1,DU
        42 004152   200137 723100                    LXL3    SCHEMA_NAME_LENGHT,,AUTO
        42 004153   040146 100540                    MLR     fill='040'O
        42 004154   300000 400013                    ADSC9   0,,PR3                   cn=2,n=*X3
        42 004155   200225 400012                    ADSC9   I+2,Q,AUTO               cn=2,n=*X2
        42 004156   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 004157   000236 116007                    CMPQ    158,DL
        42 004160   004221 603000 42                 TRC     s:4663
        42 004161   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 004162   200220 236100                    LDQ     J,,AUTO
        42 004163   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 004164   200374 724100                    LXL4    @ERROR_ARRAY+3,,AUTO
        42 004165   777541 624014                    EAX4    -159,X4
        42 004166   777777 664003                    ERX4    -1,DU
        42 004167   040146 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:175  
        42 004170   000266 000013 41                 ADSC9   182                      cn=0,n=11
        42 004171   200225 400014                    ADSC9   I+2,Q,AUTO               cn=2,n=*X4
        42 004172   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 004173   200374 236100                    LDQ     @ERROR_ARRAY+3,,AUTO
        42 004174   000223 116007                    CMPQ    147,DL
        42 004175   004221 603000 42                 TRC     s:4663
        42 004176   777554 625006                    EAX5    -148,QL
        42 004177   777777 665003                    ERX5    -1,DU
        42 004200   200136 726100                    LXL6    SUB_NAME_LENGHT,,AUTO
        42 004201   200375 235100                    LDA     @ERROR_ARRAY+4,,AUTO
        42 004202   040145 100540                    MLR     fill='040'O
        42 004203   000000 400016                    ADSC9   0,,PR0                   cn=2,n=*X6
        42 004204   200230 200015                    ADSC9   I+5,A,AUTO               cn=1,n=*X5
        42 004205   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 004206   000223 116007                    CMPQ    147,DL
        42 004207   004221 603000 42                 TRC     s:4663
        42 004210   200376 756100                    STQ     @ERROR_ARRAY+5,,AUTO
        42 004211   200375 236100                    LDQ     @ERROR_ARRAY+4,,AUTO
        42 004212   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 004213   200376 727100                    LXL7    @ERROR_ARRAY+5,,AUTO
        42 004214   777554 627017                    EAX7    -148,X7
        42 004215   777777 667003                    ERX7    -1,DU
        42 004216   040146 100400                    MLR     fill='040'O
        42 004217   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 004220   200230 200017                    ADSC9   I+5,Q,AUTO               cn=1,n=*X7

      986     4657    6                          SUBSTR(NPTR$ -> H_ALIAS.QUAL$
      987     4658    6                          -> HASH_STRUCT.C_NAME,0,J),'; ',SUBSTR(
      988     4659    6                          NPTR$ -> H_ALIAS.SUB$ ->
      989     4660    6                          HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),
      990     4661    6                          '== BECOMES ',SUBSTR(NPTR$ ->
      991     4662    6                          H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'.');
      992     4663    6                       END;

   4663 42 004221   004534 710000 42                 TRA     s:4700

      993     4664    6                   ELSE DO;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:176  

      994     4665    6                       CHAR_256='           AD ==';

   4665 42 004222   040100 100400                    MLR     fill='040'O
        42 004223   000261 000020 41                 ADSC9   177                      cn=0,n=16
        42 004224   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

      995     4666    6                       CALL INSERT(CHAR_256,16,160,

   4666 42 004225   000100 100500                    MLR     fill='000'O
        42 004226   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004227   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004230   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004231   000000 236100                    LDQ     0,,PR0
        42 004232   000041 772000                    QRL     33
        42 004233   000013 402007                    MPY     11,DL
        42 004234   200137 720100                    LXL0    SCHEMA_NAME_LENGHT,,AUTO
        42 004235   040100 100540                    MLR     fill='040'O
        42 004236   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
        42 004237   200225 000240                    ADSC9   I+2,,AUTO                cn=0,n=160
        42 004240   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 004241   200137 236100                    LDQ     SCHEMA_NAME_LENGHT,,AUTO
        42 004242   000240 116007                    CMPQ    160,DL
        42 004243   004314 603000 42                 TRC     s:4674
        42 004244   777537 621006                    EAX1    -161,QL
        42 004245   777777 661003                    ERX1    -1,DU
        42 004246   040146 100400                    MLR     fill='040'O
        42 004247   000266 000003 41                 ADSC9   182                      cn=0,n=3
        42 004250   200225 000011                    ADSC9   I+2,Q,AUTO               cn=0,n=*X1
        42 004251   000235 116007                    CMPQ    157,DL
        42 004252   004314 603000 42                 TRC     s:4674
        42 004253   777542 622006                    EAX2    -158,QL
        42 004254   777777 662003                    ERX2    -1,DU
        42 004255   200373 235100                    LDA     @ERROR_ARRAY+2,,AUTO
        42 004256   040146 100405                    MLR     fill='040'O
        42 004257   000066 000013 2                  ADSC9   ALIAS_TYPE,A             cn=0,n=11
        42 004260   200225 600012                    ADSC9   I+2,Q,AUTO               cn=3,n=*X2
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:177  
        42 004261   000222 116007                    CMPQ    146,DL
        42 004262   004314 603000 42                 TRC     s:4674
        42 004263   777555 623006                    EAX3    -147,QL
        42 004264   777777 663003                    ERX3    -1,DU
        42 004265   040146 100400                    MLR     fill='040'O
        42 004266   000271 000011 41                 ADSC9   185                      cn=0,n=9
        42 004267   200230 400013                    ADSC9   I+5,Q,AUTO               cn=2,n=*X3
        42 004270   000211 116007                    CMPQ    137,DL
        42 004271   004314 603000 42                 TRC     s:4674
        42 004272   777566 624006                    EAX4    -138,QL
        42 004273   777777 664003                    ERX4    -1,DU
        42 004274   200136 725100                    LXL5    SUB_NAME_LENGHT,,AUTO
        42 004275   040146 100540                    MLR     fill='040'O
        42 004276   000000 400015                    ADSC9   0,,PR0                   cn=2,n=*X5
        42 004277   200232 600014                    ADSC9   I+7,Q,AUTO               cn=3,n=*X4
        42 004300   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 004301   000211 116007                    CMPQ    137,DL
        42 004302   004314 603000 42                 TRC     s:4674
        42 004303   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 004304   200137 236100                    LDQ     SCHEMA_NAME_LENGHT,,AUTO
        42 004305   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 004306   200374 726100                    LXL6    @ERROR_ARRAY+3,,AUTO
        42 004307   777566 626016                    EAX6    -138,X6
        42 004310   777777 666003                    ERX6    -1,DU
        42 004311   040146 100400                    MLR     fill='040'O
        42 004312   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 004313   200232 600016                    ADSC9   I+7,Q,AUTO               cn=3,n=*X6

      996     4667    6                          SUBSTR(
      997     4668    6                          NPTR$ -> H_ALIAS.SUB$ ->
      998     4669    6                          HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'== ',
      999     4670    6                          ALIAS_TYPE(NPTR$ -> HASH_STRUCT.ALIAS_TYPE)
     1000     4671    6                          ,' BECOMES ',SUBSTR(NPTR$ ->
     1001     4672    6                          H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'.');
     1002     4673    6                       END;

     1003     4674    5                   END;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:178  

   4674 42 004314   004534 710000 42                 TRA     s:4700

     1004     4675    5               ELSE DO;

     1005     4676    5                   IF NPTR$ -> HASH_STRUCT.ALIAS_TYPE = 5

   4676 42 004315   200165 470500                    LDP0    NPTR$,,AUTO
        42 004316   000000 236100                    LDQ     0,,PR0
        42 004317   700000 376003                    ANQ     -32768,DU
        42 004320   500000 116003                    CMPQ    -98304,DU
        42 004321   004455 601000 42                 TNZ     s:4691

     1006     4677    6                   THEN DO;

     1007     4678    6                       CALL FIND_LENGTH(NPTR$ -> H_ALIAS.QUAL$

   4678 42 004322   000100 100500                    MLR     fill='000'O
        42 004323   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 004324   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004325   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004326   200220 633500                    EPPR3   J,,AUTO
        42 004327   200324 453500                    STP3    COUNT1,,AUTO
        42 004330   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004331   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004332   400000 036007                    ADLQ    -131072,DL
        42 004333   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004334   002212 701000 42                 TSX1    FIND_LENGTH
        42 004335   000000 011000                    NOP     0

     1008     4679    6                          -> HASH_STRUCT.C_NAME,J);
     1009     4680    6                       CALL CHANGE_TO_STR(NPTR$ -> H_ALIAS.QUAL$

   4680 42 004336   200165 470500                    LDP0    NPTR$,,AUTO
        42 004337   000100 100500                    MLR     fill='000'O
        42 004340   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 004341   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:179  
        42 004342   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004343   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004344   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004345   400000 036007                    ADLQ    -131072,DL
        42 004346   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004347   003616 701000 42                 TSX1    CHANGE_TO_STR
        42 004350   000000 011000                    NOP     0

     1010     4681    6                          -> HASH_STRUCT.C_NAME);
     1011     4682    6                       CHAR_256='      ALIAS ';

   4682 42 004351   040100 100400                    MLR     fill='040'O
        42 004352   000274 000014 41                 ADSC9   188                      cn=0,n=12
        42 004353   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

     1012     4683    6                       CALL INSERT(CHAR_256,12,160,

   4683 42 004354   200165 470500                    LDP0    NPTR$,,AUTO
        42 004355   000100 100500                    MLR     fill='000'O
        42 004356   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 004357   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004360   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004361   000100 100500                    MLR     fill='000'O
        42 004362   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004363   200373 000004                    ADSC9   @ERROR_ARRAY+2,,AUTO     cn=0,n=4
        42 004364   200373 473500                    LDP3    @ERROR_ARRAY+2,,AUTO
        42 004365   200136 720100                    LXL0    SUB_NAME_LENGHT,,AUTO
        42 004366   040100 100540                    MLR     fill='040'O
        42 004367   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
        42 004370   200224 000240                    ADSC9   I+1,,AUTO                cn=0,n=160
        42 004371   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 004372   000240 116007                    CMPQ    160,DL
        42 004373   004454 603000 42                 TRC     s:4689
        42 004374   777537 621006                    EAX1    -161,QL
        42 004375   777777 661003                    ERX1    -1,DU
        42 004376   040146 100400                    MLR     fill='040'O
        42 004377   000133 000001 43                 ADSC9   91                       cn=0,n=1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:180  
        42 004400   200224 000011                    ADSC9   I+1,Q,AUTO               cn=0,n=*X1
        42 004401   000237 116007                    CMPQ    159,DL
        42 004402   004454 603000 42                 TRC     s:4689
        42 004403   777540 622006                    EAX2    -160,QL
        42 004404   777777 662003                    ERX2    -1,DU
        42 004405   200220 723100                    LXL3    J,,AUTO
        42 004406   040146 100540                    MLR     fill='040'O
        42 004407   100000 400013                    ADSC9   0,,PR1                   cn=2,n=*X3
        42 004410   200224 200012                    ADSC9   I+1,Q,AUTO               cn=1,n=*X2
        42 004411   200220 036100                    ADLQ    J,,AUTO
        42 004412   000237 116007                    CMPQ    159,DL
        42 004413   004454 603000 42                 TRC     s:4689
        42 004414   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 004415   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 004416   200220 036100                    ADLQ    J,,AUTO
        42 004417   200374 724100                    LXL4    @ERROR_ARRAY+3,,AUTO
        42 004420   777540 624014                    EAX4    -160,X4
        42 004421   777777 664003                    ERX4    -1,DU
        42 004422   040146 100400                    MLR     fill='040'O
        42 004423   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 004424   200224 200014                    ADSC9   I+1,Q,AUTO               cn=1,n=*X4
        42 004425   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 004426   200374 236100                    LDQ     @ERROR_ARRAY+3,,AUTO
        42 004427   000236 116007                    CMPQ    158,DL
        42 004430   004454 603000 42                 TRC     s:4689
        42 004431   777541 625006                    EAX5    -159,QL
        42 004432   777777 665003                    ERX5    -1,DU
        42 004433   200137 726100                    LXL6    SCHEMA_NAME_LENGHT,,AUTO
        42 004434   200375 235100                    LDA     @ERROR_ARRAY+4,,AUTO
        42 004435   040145 100540                    MLR     fill='040'O
        42 004436   300000 400016                    ADSC9   0,,PR3                   cn=2,n=*X6
        42 004437   200224 400015                    ADSC9   I+1,A,AUTO               cn=2,n=*X5
        42 004440   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 004441   000236 116007                    CMPQ    158,DL
        42 004442   004454 603000 42                 TRC     s:4689
        42 004443   200376 756100                    STQ     @ERROR_ARRAY+5,,AUTO
        42 004444   200375 236100                    LDQ     @ERROR_ARRAY+4,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:181  
        42 004445   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 004446   200376 727100                    LXL7    @ERROR_ARRAY+5,,AUTO
        42 004447   777541 627017                    EAX7    -159,X7
        42 004450   777777 667003                    ERX7    -1,DU
        42 004451   040146 100400                    MLR     fill='040'O
        42 004452   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 004453   200224 400017                    ADSC9   I+1,Q,AUTO               cn=2,n=*X7

     1013     4684    6                          SUBSTR(NPTR$->H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'=',
     1014     4685    6                          SUBSTR(NPTR$ -> H_ALIAS.QUAL$
     1015     4686    6                          -> HASH_STRUCT.C_NAME,0,J),'.',SUBSTR(
     1016     4687    6                          NPTR$ -> H_ALIAS.SUB$ ->
     1017     4688    6                          HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'.');
     1018     4689    6                       END;

   4689 42 004454   004534 710000 42                 TRA     s:4700

     1019     4690    6                   ELSE DO;

     1020     4691    6                       CHAR_256='      ALIAS ';

   4691 42 004455   040100 100400                    MLR     fill='040'O
        42 004456   000274 000014 41                 ADSC9   188                      cn=0,n=12
        42 004457   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

     1021     4692    6                       TVBL = NPTR$->HASH_STRUCT.ALIAS_TYPE + 6;

   4692 42 004460   000000 236100                    LDQ     0,,PR0
        42 004461   000041 772000                    QRL     33
        42 004462   000006 036007                    ADLQ    6,DL
        42 004463   200112 756100                    STQ     TVBL,,AUTO

     1022     4693    6                       CALL INSERT(CHAR_256,12,160,A_TYPE(TVBL),

   4693 42 004464   000100 100500                    MLR     fill='000'O
        42 004465   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004466   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:182  
        42 004467   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004470   000011 402007                    MPY     9,DL
        42 004471   040100 100406                    MLR     fill='040'O
        42 004472   000112 000011 2                  ADSC9   A_TYPE,Q                 cn=0,n=9
        42 004473   200224 000011                    ADSC9   I+1,,AUTO                cn=0,n=9
        42 004474   200136 720100                    LXL0    SUB_NAME_LENGHT,,AUTO
        42 004475   040100 100540                    MLR     fill='040'O
        42 004476   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
        42 004477   200226 200227                    ADSC9   I+3,,AUTO                cn=1,n=151
        42 004500   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 004501   000227 116007                    CMPQ    151,DL
        42 004502   004534 603000 42                 TRC     s:4700
        42 004503   777550 621006                    EAX1    -152,QL
        42 004504   777777 661003                    ERX1    -1,DU
        42 004505   040146 100400                    MLR     fill='040'O
        42 004506   000133 000001 43                 ADSC9   91                       cn=0,n=1
        42 004507   200226 200011                    ADSC9   I+3,Q,AUTO               cn=1,n=*X1
        42 004510   000226 116007                    CMPQ    150,DL
        42 004511   004534 603000 42                 TRC     s:4700
        42 004512   777551 622006                    EAX2    -151,QL
        42 004513   777777 662003                    ERX2    -1,DU
        42 004514   200137 723100                    LXL3    SCHEMA_NAME_LENGHT,,AUTO
        42 004515   040146 100540                    MLR     fill='040'O
        42 004516   100000 400013                    ADSC9   0,,PR1                   cn=2,n=*X3
        42 004517   200226 400012                    ADSC9   I+3,Q,AUTO               cn=2,n=*X2
        42 004520   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 004521   000226 116007                    CMPQ    150,DL
        42 004522   004534 603000 42                 TRC     s:4700
        42 004523   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 004524   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 004525   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 004526   200373 724100                    LXL4    @ERROR_ARRAY+2,,AUTO
        42 004527   777551 624014                    EAX4    -151,X4
        42 004530   777777 664003                    ERX4    -1,DU
        42 004531   040146 100400                    MLR     fill='040'O
        42 004532   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 004533   200226 400014                    ADSC9   I+3,Q,AUTO               cn=2,n=*X4
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:183  

     1023     4694    6                          SUBSTR(NPTR$->
     1024     4695    6                          H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'=',SUBSTR(
     1025     4696    6                          NPTR$ -> H_ALIAS.SUB$ ->
     1026     4697    6                          HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'.');
     1027     4698    6                       END;

     1028     4699    5                   END;

     1029     4700    4               CALL ALIAS_WRITER;

   4700 42 004534   003646 701000 42                 TSX1    ALIAS_WRITER
        42 004535   000000 011000                    NOP     0

     1030     4701    4               NPTR$ = NPTR$ -> HASH_STRUCT.PTR$;

   4701 42 004536   200165 470500                    LDP0    NPTR$,,AUTO
        42 004537   000010 236100                    LDQ     8,,PR0
        42 004540   200165 756100                    STQ     NPTR$,,AUTO

     1031     4702    4               END;

   4702 42 004541   200165 236100                    LDQ     NPTR$,,AUTO
        42 004542   000067 116000 43                 CMPQ    55
        42 004543   004555 600000 42                 TZE     s:4703
        42 004544   200165 470500                    LDP0    NPTR$,,AUTO
        42 004545   000000 236100                    LDQ     0,,PR0
        42 004546   070000 376003                    ANQ     28672,DU
        42 004547   060000 116003                    CMPQ    24576,DU
        42 004550   004555 601000 42                 TNZ     s:4703
        42 004551   000000 236100                    LDQ     0,,PR0
        42 004552   007777 376003                    ANQ     4095,DU
        42 004553   000001 116003                    CMPQ    1,DU
        42 004554   003765 600000 42                 TZE     s:4629

     1032     4703    3           END;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:184  
   4703 42 004555   200217 235100                    LDA     I,,AUTO
        42 004556   000001 035007                    ADLA    1,DL
        42 004557   200217 755100                    STA     I,,AUTO
        42 004560   001451 115007                    CMPA    809,DL
        42 004561   003747 602000 42                 TNC     s:4623

     1033     4704    2       IF ~FIRST_GEN_ALIAS

   4704 42 004562   200173 236100                    LDQ     FIRST_GEN_ALIAS,,AUTO
        42 004563   400000 376003                    ANQ     -131072,DU
        42 004564   400000 676003                    ERQ     -131072,DU
        42 004565   004572 600000 42                 TZE     s:4711

     1034     4705    3       THEN DO;

     1035     4706    3           CALL INFO_ONLY(#GEN_ALIAS_END);

   4706 42 004566   000137 630400 43                 EPPR0   95
        42 004567   000003 631400 43                 EPPR1   3
        42 004570   000000 701000 xent               TSX1    INFO_ONLY
        42 004571   000000 011000                    NOP     0

     1036     4707        /*E*     ERROR:    ZIG-#GEN_ALIAS_END-C
     1037     4708        MESSAGE: The aliases above were generated by the generator.
     1038     4709        */
     1039     4710    3           END;

     1040     4711    3       DO I = 0 TO 808;

   4711 42 004572   200217 450100                    STZ     I,,AUTO

     1041     4712    3           NPTR$ = HAS_TABLE(I);

   4712 42 004573   200217 720100                    LXL0    I,,AUTO
        42 004574   000000 236010 38                 LDQ     HAS_TABLE,X0
        42 004575   200165 756100                    STQ     NPTR$,,AUTO

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:185  
     1042     4713    4           DO WHILE (NPTR$ ~= ADDR(NIL) AND NPTR$->HASH_STRUCT.TYPE =0);

   4713 42 004576   004602 710000 42                 TRA     s:4715

     1043     4714    4               NPTR$ = NPTR$ -> HASH_STRUCT.PTR$;

   4714 42 004577   200165 470500                    LDP0    NPTR$,,AUTO
        42 004600   000010 236100                    LDQ     8,,PR0
        42 004601   200165 756100                    STQ     NPTR$,,AUTO

     1044     4715    4               END;

   4715 42 004602   000067 116000 43                 CMPQ    55
        42 004603   004610 600000 42                 TZE     s:4716
        42 004604   200165 470500                    LDP0    NPTR$,,AUTO
        42 004605   000000 236100                    LDQ     0,,PR0
        42 004606   070000 316003                    CANQ    28672,DU
        42 004607   004577 600000 42                 TZE     s:4714

     1045     4716    4           DO WHILE (NPTR$ ~= ADDR(NIL) AND NPTR$ ->HASH_STRUCT.TYPE =6);

   4716 42 004610   005347 710000 42                 TRA     s:4800

     1046     4717    4               IF NPTR$ -> HASH_STRUCT.DUPS ~= 1

   4717 42 004611   200165 470500                    LDP0    NPTR$,,AUTO
        42 004612   000000 236100                    LDQ     0,,PR0
        42 004613   007777 376003                    ANQ     4095,DU
        42 004614   000001 116003                    CMPQ    1,DU
        42 004615   005344 600000 42                 TZE     s:4799

     1047     4718    5               THEN DO;

     1048     4719    5                   IF FIRST_GEN_ALIAS

   4719 42 004616   200173 234100                    SZN     FIRST_GEN_ALIAS,,AUTO
        42 004617   004626 605000 42                 TPL     s:4724
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:186  

     1049     4720    6                   THEN DO;

     1050     4721    6                       IF SUB_LANGUAGE=#COBOL THEN CALL ALIAS_WRITER;

   4721 42 004620   000000 235000 30                 LDA     SUB_LANGUAGE
        42 004621   000001 115007                    CMPA    1,DL
        42 004622   004625 601000 42                 TNZ     s:4722

   4721 42 004623   003646 701000 42                 TSX1    ALIAS_WRITER
        42 004624   000000 011000                    NOP     0

     1051     4722    6                       FIRST_GEN_ALIAS = '0'B;

   4722 42 004625   200173 450100                    STZ     FIRST_GEN_ALIAS,,AUTO

     1052     4723    6                       END;

     1053     4724    5                   CALL CHECK_CHAR_SET(NPTR$->H_ALIAS.SUB$

   4724 42 004626   200165 470500                    LDP0    NPTR$,,AUTO
        42 004627   000100 100500                    MLR     fill='000'O
        42 004630   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004631   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004632   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004633   200170 633500                    EPPR3   POS,,AUTO
        42 004634   200325 453500                    STP3    @MUST_ALIAS+1,,AUTO
        42 004635   200166 634500                    EPPR4   ERROR_STATUS,,AUTO
        42 004636   200324 454500                    STP4    COUNT1,,AUTO
        42 004637   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004640   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004641   400000 036007                    ADLQ    -131072,DL
        42 004642   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004643   005631 701000 42                 TSX1    CHECK_CHAR_SET
        42 004644   000000 011000                    NOP     0

     1054     4725    5                      -> HASH_STRUCT.C_NAME,ERROR_STATUS,POS);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:187  
     1055     4726    5                   CALL FIND_LENGTH(NPTR$ -> H_ALIAS.SUB$

   4726 42 004645   200165 470500                    LDP0    NPTR$,,AUTO
        42 004646   000100 100500                    MLR     fill='000'O
        42 004647   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004650   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004651   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004652   200137 633500                    EPPR3   SCHEMA_NAME_LENGHT,,AUTO
        42 004653   200324 453500                    STP3    COUNT1,,AUTO
        42 004654   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004655   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004656   400000 036007                    ADLQ    -131072,DL
        42 004657   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004660   002212 701000 42                 TSX1    FIND_LENGTH
        42 004661   000000 011000                    NOP     0

     1056     4727    5                      -> HASH_STRUCT.C_NAME,SCHEMA_NAME_LENGHT);
     1057     4728    5                   CALL FIND_LENGTH(NPTR$ -> H_ALIAS.C_NAME,SUB_NAME_LENGHT);

   4728 42 004662   200136 630500                    EPPR0   SUB_NAME_LENGHT,,AUTO
        42 004663   200324 450500                    STP0    COUNT1,,AUTO
        42 004664   200165 236100                    LDQ     NPTR$,,AUTO
        42 004665   400000 036007                    ADLQ    -131072,DL
        42 004666   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004667   002212 701000 42                 TSX1    FIND_LENGTH
        42 004670   000000 011000                    NOP     0

     1058     4729    5                   IF SUB_LANGUAGE = #COBOL

   4729 42 004671   000000 235000 30                 LDA     SUB_LANGUAGE
        42 004672   000001 115007                    CMPA    1,DL
        42 004673   005114 601000 42                 TNZ     s:4758

     1059     4730    6                   THEN DO;

     1060     4731    6                       IF NPTR$ -> HASH_STRUCT.ALIAS_TYPE = 5

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:188  
   4731 42 004674   200165 470500                    LDP0    NPTR$,,AUTO
        42 004675   000000 236100                    LDQ     0,,PR0
        42 004676   700000 376003                    ANQ     -32768,DU
        42 004677   500000 116003                    CMPQ    -98304,DU
        42 004700   005021 601000 42                 TNZ     s:4746

     1061     4732    7                       THEN DO;

     1062     4733    7                           CALL FIND_LENGTH(NPTR$ -> H_ALIAS.QUAL$

   4733 42 004701   000100 100500                    MLR     fill='000'O
        42 004702   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 004703   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004704   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 004705   200220 633500                    EPPR3   J,,AUTO
        42 004706   200324 453500                    STP3    COUNT1,,AUTO
        42 004707   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 004710   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 004711   400000 036007                    ADLQ    -131072,DL
        42 004712   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 004713   002212 701000 42                 TSX1    FIND_LENGTH
        42 004714   000000 011000                    NOP     0

     1063     4734    7                              -> HASH_STRUCT.C_NAME,J);
     1064     4735    7                           CHAR_256='           AD ==';

   4735 42 004715   040100 100400                    MLR     fill='040'O
        42 004716   000261 000020 41                 ADSC9   177                      cn=0,n=16
        42 004717   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

     1065     4736    7                           CALL INSERT(CHAR_256,16,160,

   4736 42 004720   200165 470500                    LDP0    NPTR$,,AUTO
        42 004721   000100 100500                    MLR     fill='000'O
        42 004722   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 004723   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 004724   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:189  
        42 004725   000100 100500                    MLR     fill='000'O
        42 004726   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 004727   200373 000004                    ADSC9   @ERROR_ARRAY+2,,AUTO     cn=0,n=4
        42 004730   200373 473500                    LDP3    @ERROR_ARRAY+2,,AUTO
        42 004731   200220 720100                    LXL0    J,,AUTO
        42 004732   040100 100540                    MLR     fill='040'O
        42 004733   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
        42 004734   200225 000240                    ADSC9   I+2,,AUTO                cn=0,n=160
        42 004735   200220 236100                    LDQ     J,,AUTO
        42 004736   000240 116007                    CMPQ    160,DL
        42 004737   005020 603000 42                 TRC     s:4744
        42 004740   777537 621006                    EAX1    -161,QL
        42 004741   777777 661003                    ERX1    -1,DU
        42 004742   040146 100400                    MLR     fill='040'O
        42 004743   000265 000002 41                 ADSC9   181                      cn=0,n=2
        42 004744   200225 000011                    ADSC9   I+2,Q,AUTO               cn=0,n=*X1
        42 004745   000236 116007                    CMPQ    158,DL
        42 004746   005020 603000 42                 TRC     s:4744
        42 004747   777541 622006                    EAX2    -159,QL
        42 004750   777777 662003                    ERX2    -1,DU
        42 004751   200136 723100                    LXL3    SUB_NAME_LENGHT,,AUTO
        42 004752   040146 100540                    MLR     fill='040'O
        42 004753   000000 400013                    ADSC9   0,,PR0                   cn=2,n=*X3
        42 004754   200225 400012                    ADSC9   I+2,Q,AUTO               cn=2,n=*X2
        42 004755   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 004756   000236 116007                    CMPQ    158,DL
        42 004757   005020 603000 42                 TRC     s:4744
        42 004760   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 004761   200220 236100                    LDQ     J,,AUTO
        42 004762   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 004763   200374 724100                    LXL4    @ERROR_ARRAY+3,,AUTO
        42 004764   777541 624014                    EAX4    -159,X4
        42 004765   777777 664003                    ERX4    -1,DU
        42 004766   040146 100400                    MLR     fill='040'O
        42 004767   000266 000013 41                 ADSC9   182                      cn=0,n=11
        42 004770   200225 400014                    ADSC9   I+2,Q,AUTO               cn=2,n=*X4
        42 004771   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:190  
        42 004772   200374 236100                    LDQ     @ERROR_ARRAY+3,,AUTO
        42 004773   000223 116007                    CMPQ    147,DL
        42 004774   005020 603000 42                 TRC     s:4744
        42 004775   777554 625006                    EAX5    -148,QL
        42 004776   777777 665003                    ERX5    -1,DU
        42 004777   200137 726100                    LXL6    SCHEMA_NAME_LENGHT,,AUTO
        42 005000   200375 235100                    LDA     @ERROR_ARRAY+4,,AUTO
        42 005001   040145 100540                    MLR     fill='040'O
        42 005002   300000 400016                    ADSC9   0,,PR3                   cn=2,n=*X6
        42 005003   200230 200015                    ADSC9   I+5,A,AUTO               cn=1,n=*X5
        42 005004   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 005005   000223 116007                    CMPQ    147,DL
        42 005006   005020 603000 42                 TRC     s:4744
        42 005007   200376 756100                    STQ     @ERROR_ARRAY+5,,AUTO
        42 005010   200375 236100                    LDQ     @ERROR_ARRAY+4,,AUTO
        42 005011   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 005012   200376 727100                    LXL7    @ERROR_ARRAY+5,,AUTO
        42 005013   777554 627017                    EAX7    -148,X7
        42 005014   777777 667003                    ERX7    -1,DU
        42 005015   040146 100400                    MLR     fill='040'O
        42 005016   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 005017   200230 200017                    ADSC9   I+5,Q,AUTO               cn=1,n=*X7

     1066     4737    7                              SUBSTR(NPTR$ -> H_ALIAS.QUAL$
     1067     4738    7                              -> HASH_STRUCT.C_NAME,0,J),'; ',SUBSTR(
     1068     4739    7                              NPTR$ -> HASH_STRUCT.C_NAME
     1069     4740    7                              ,0,SUB_NAME_LENGHT),
     1070     4741    7                              '== BECOMES ',SUBSTR(NPTR$ ->
     1071     4742    7                              H_ALIAS.SUB$ ->
     1072     4743    7                              HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'.');
     1073     4744    7                           END;

   4744 42 005020   005320 710000 42                 TRA     s:4780

     1074     4745    7                       ELSE DO;

     1075     4746    7                           CHAR_256='           AD ==';
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:191  

   4746 42 005021   040100 100400                    MLR     fill='040'O
        42 005022   000261 000020 41                 ADSC9   177                      cn=0,n=16
        42 005023   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

     1076     4747    7                           CALL INSERT(CHAR_256,16,160,

   4747 42 005024   000000 236100                    LDQ     0,,PR0
        42 005025   000041 772000                    QRL     33
        42 005026   000013 402007                    MPY     11,DL
        42 005027   000100 100500                    MLR     fill='000'O
        42 005030   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 005031   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 005032   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 005033   200136 720100                    LXL0    SUB_NAME_LENGHT,,AUTO
        42 005034   040100 100540                    MLR     fill='040'O
        42 005035   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
        42 005036   200225 000240                    ADSC9   I+2,,AUTO                cn=0,n=160
        42 005037   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 005040   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 005041   000240 116007                    CMPQ    160,DL
        42 005042   005113 603000 42                 TRC     s:4756
        42 005043   777537 621006                    EAX1    -161,QL
        42 005044   777777 661003                    ERX1    -1,DU
        42 005045   040146 100400                    MLR     fill='040'O
        42 005046   000266 000003 41                 ADSC9   182                      cn=0,n=3
        42 005047   200225 000011                    ADSC9   I+2,Q,AUTO               cn=0,n=*X1
        42 005050   000235 116007                    CMPQ    157,DL
        42 005051   005113 603000 42                 TRC     s:4756
        42 005052   777542 622006                    EAX2    -158,QL
        42 005053   777777 662003                    ERX2    -1,DU
        42 005054   200373 235100                    LDA     @ERROR_ARRAY+2,,AUTO
        42 005055   040146 100405                    MLR     fill='040'O
        42 005056   000066 000013 2                  ADSC9   ALIAS_TYPE,A             cn=0,n=11
        42 005057   200225 600012                    ADSC9   I+2,Q,AUTO               cn=3,n=*X2
        42 005060   000222 116007                    CMPQ    146,DL
        42 005061   005113 603000 42                 TRC     s:4756
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:192  
        42 005062   777555 623006                    EAX3    -147,QL
        42 005063   777777 663003                    ERX3    -1,DU
        42 005064   040146 100400                    MLR     fill='040'O
        42 005065   000271 000011 41                 ADSC9   185                      cn=0,n=9
        42 005066   200230 400013                    ADSC9   I+5,Q,AUTO               cn=2,n=*X3
        42 005067   000211 116007                    CMPQ    137,DL
        42 005070   005113 603000 42                 TRC     s:4756
        42 005071   777566 624006                    EAX4    -138,QL
        42 005072   777777 664003                    ERX4    -1,DU
        42 005073   200137 725100                    LXL5    SCHEMA_NAME_LENGHT,,AUTO
        42 005074   040146 100540                    MLR     fill='040'O
        42 005075   100000 400015                    ADSC9   0,,PR1                   cn=2,n=*X5
        42 005076   200232 600014                    ADSC9   I+7,Q,AUTO               cn=3,n=*X4
        42 005077   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 005100   000211 116007                    CMPQ    137,DL
        42 005101   005113 603000 42                 TRC     s:4756
        42 005102   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 005103   200136 236100                    LDQ     SUB_NAME_LENGHT,,AUTO
        42 005104   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 005105   200374 726100                    LXL6    @ERROR_ARRAY+3,,AUTO
        42 005106   777566 626016                    EAX6    -138,X6
        42 005107   777777 666003                    ERX6    -1,DU
        42 005110   040146 100400                    MLR     fill='040'O
        42 005111   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 005112   200232 600016                    ADSC9   I+7,Q,AUTO               cn=3,n=*X6

     1077     4748    7                              SUBSTR(
     1078     4749    7                              NPTR$ -> H_ALIAS.C_NAME
     1079     4750    7                              ,0,SUB_NAME_LENGHT),'== ',
     1080     4751    7                              ALIAS_TYPE(NPTR$ -> HASH_STRUCT.ALIAS_TYPE)
     1081     4752    7                              ,' BECOMES ',SUBSTR(NPTR$ ->
     1082     4753    7                              H_ALIAS.SUB$ ->
     1083     4754    7                              HASH_STRUCT.C_NAME,0,SCHEMA_NAME_LENGHT),'.');
     1084     4755    7                           END;

     1085     4756    6                       END;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:193  
   4756 42 005113   005320 710000 42                 TRA     s:4780

     1086     4757    6                   ELSE DO;

     1087     4758    6                       IF NPTR$ -> HASH_STRUCT.ALIAS_TYPE = 5

   4758 42 005114   200165 470500                    LDP0    NPTR$,,AUTO
        42 005115   000000 236100                    LDQ     0,,PR0
        42 005116   700000 376003                    ANQ     -32768,DU
        42 005117   500000 116003                    CMPQ    -98304,DU
        42 005120   005241 601000 42                 TNZ     s:4771

     1088     4759    7                       THEN DO;

     1089     4760    7                           CALL FIND_LENGTH(NPTR$ -> H_ALIAS.QUAL$

   4760 42 005121   000100 100500                    MLR     fill='000'O
        42 005122   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 005123   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 005124   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 005125   200220 633500                    EPPR3   J,,AUTO
        42 005126   200324 453500                    STP3    COUNT1,,AUTO
        42 005127   200373 451500                    STP1    @ERROR_ARRAY+2,,AUTO
        42 005130   200373 236100                    LDQ     @ERROR_ARRAY+2,,AUTO
        42 005131   400000 036007                    ADLQ    -131072,DL
        42 005132   200323 756100                    STQ     @CHANGE_STR,,AUTO
        42 005133   002212 701000 42                 TSX1    FIND_LENGTH
        42 005134   000000 011000                    NOP     0

     1090     4761    7                              -> HASH_STRUCT.C_NAME,J);
     1091     4762    7                           CHAR_256='      ALIAS ';

   4762 42 005135   040100 100400                    MLR     fill='040'O
        42 005136   000274 000014 41                 ADSC9   188                      cn=0,n=12
        42 005137   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

     1092     4763    7                           CALL INSERT(CHAR_256,12,160,
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:194  

   4763 42 005140   200165 470500                    LDP0    NPTR$,,AUTO
        42 005141   000100 100500                    MLR     fill='000'O
        42 005142   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4
        42 005143   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 005144   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 005145   000100 100500                    MLR     fill='000'O
        42 005146   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 005147   200373 000004                    ADSC9   @ERROR_ARRAY+2,,AUTO     cn=0,n=4
        42 005150   200373 473500                    LDP3    @ERROR_ARRAY+2,,AUTO
        42 005151   200220 720100                    LXL0    J,,AUTO
        42 005152   040100 100540                    MLR     fill='040'O
        42 005153   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
        42 005154   200224 000240                    ADSC9   I+1,,AUTO                cn=0,n=160
        42 005155   200220 236100                    LDQ     J,,AUTO
        42 005156   000240 116007                    CMPQ    160,DL
        42 005157   005240 603000 42                 TRC     s:4769
        42 005160   777537 621006                    EAX1    -161,QL
        42 005161   777777 661003                    ERX1    -1,DU
        42 005162   040146 100400                    MLR     fill='040'O
        42 005163   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 005164   200224 000011                    ADSC9   I+1,Q,AUTO               cn=0,n=*X1
        42 005165   000237 116007                    CMPQ    159,DL
        42 005166   005240 603000 42                 TRC     s:4769
        42 005167   777540 622006                    EAX2    -160,QL
        42 005170   777777 662003                    ERX2    -1,DU
        42 005171   200137 723100                    LXL3    SCHEMA_NAME_LENGHT,,AUTO
        42 005172   040146 100540                    MLR     fill='040'O
        42 005173   300000 400013                    ADSC9   0,,PR3                   cn=2,n=*X3
        42 005174   200224 200012                    ADSC9   I+1,Q,AUTO               cn=1,n=*X2
        42 005175   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 005176   000237 116007                    CMPQ    159,DL
        42 005177   005240 603000 42                 TRC     s:4769
        42 005200   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 005201   200220 236100                    LDQ     J,,AUTO
        42 005202   200137 036100                    ADLQ    SCHEMA_NAME_LENGHT,,AUTO
        42 005203   200374 724100                    LXL4    @ERROR_ARRAY+3,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:195  
        42 005204   777540 624014                    EAX4    -160,X4
        42 005205   777777 664003                    ERX4    -1,DU
        42 005206   040146 100400                    MLR     fill='040'O
        42 005207   000133 000001 43                 ADSC9   91                       cn=0,n=1
        42 005210   200224 200014                    ADSC9   I+1,Q,AUTO               cn=1,n=*X4
        42 005211   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 005212   200374 236100                    LDQ     @ERROR_ARRAY+3,,AUTO
        42 005213   000236 116007                    CMPQ    158,DL
        42 005214   005240 603000 42                 TRC     s:4769
        42 005215   777541 625006                    EAX5    -159,QL
        42 005216   777777 665003                    ERX5    -1,DU
        42 005217   200136 726100                    LXL6    SUB_NAME_LENGHT,,AUTO
        42 005220   200375 235100                    LDA     @ERROR_ARRAY+4,,AUTO
        42 005221   040145 100540                    MLR     fill='040'O
        42 005222   000000 400016                    ADSC9   0,,PR0                   cn=2,n=*X6
        42 005223   200224 400015                    ADSC9   I+1,A,AUTO               cn=2,n=*X5
        42 005224   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 005225   000236 116007                    CMPQ    158,DL
        42 005226   005240 603000 42                 TRC     s:4769
        42 005227   200376 756100                    STQ     @ERROR_ARRAY+5,,AUTO
        42 005230   200375 236100                    LDQ     @ERROR_ARRAY+4,,AUTO
        42 005231   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 005232   200376 727100                    LXL7    @ERROR_ARRAY+5,,AUTO
        42 005233   777541 627017                    EAX7    -159,X7
        42 005234   777777 667003                    ERX7    -1,DU
        42 005235   040146 100400                    MLR     fill='040'O
        42 005236   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 005237   200224 400017                    ADSC9   I+1,Q,AUTO               cn=2,n=*X7

     1093     4764    7                              SUBSTR(NPTR$ -> H_ALIAS.QUAL$ ->
     1094     4765    7                              HASH_STRUCT.C_NAME,0,J),'.',SUBSTR(NPTR$ ->
     1095     4766    7                              H_ALIAS.SUB$ -> HASH_STRUCT.C_NAME,0,
     1096     4767    7                              SCHEMA_NAME_LENGHT),'=',SUBSTR(NPTR$ ->
     1097     4768    7                              H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'.');
     1098     4769    7                           END;

   4769 42 005240   005320 710000 42                 TRA     s:4780
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:196  

     1099     4770    7                       ELSE DO;

     1100     4771    7                           CHAR_256='      ALIAS ';

   4771 42 005241   040100 100400                    MLR     fill='040'O
        42 005242   000274 000014 41                 ADSC9   188                      cn=0,n=12
        42 005243   200221 000400                    ADSC9   CHAR_256,,AUTO           cn=0,n=256

     1101     4772    7                           TVBL = NPTR$->HASH_STRUCT.ALIAS_TYPE + 6;

   4772 42 005244   000000 236100                    LDQ     0,,PR0
        42 005245   000041 772000                    QRL     33
        42 005246   000006 036007                    ADLQ    6,DL
        42 005247   200112 756100                    STQ     TVBL,,AUTO

     1102     4773    7                           CALL INSERT(CHAR_256,12,160,A_TYPE(TVBL),

   4773 42 005250   000100 100500                    MLR     fill='000'O
        42 005251   000011 000004                    ADSC9   9,,PR0                   cn=0,n=4
        42 005252   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 005253   200372 471500                    LDP1    @ERROR_ARRAY+1,,AUTO
        42 005254   000011 402007                    MPY     9,DL
        42 005255   040100 100406                    MLR     fill='040'O
        42 005256   000112 000011 2                  ADSC9   A_TYPE,Q                 cn=0,n=9
        42 005257   200224 000011                    ADSC9   I+1,,AUTO                cn=0,n=9
        42 005260   200137 720100                    LXL0    SCHEMA_NAME_LENGHT,,AUTO
        42 005261   040100 100540                    MLR     fill='040'O
        42 005262   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
        42 005263   200226 200227                    ADSC9   I+3,,AUTO                cn=1,n=151
        42 005264   200137 236100                    LDQ     SCHEMA_NAME_LENGHT,,AUTO
        42 005265   000227 116007                    CMPQ    151,DL
        42 005266   005320 603000 42                 TRC     s:4780
        42 005267   777550 621006                    EAX1    -152,QL
        42 005270   777777 661003                    ERX1    -1,DU
        42 005271   040146 100400                    MLR     fill='040'O
        42 005272   000133 000001 43                 ADSC9   91                       cn=0,n=1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:197  
        42 005273   200226 200011                    ADSC9   I+3,Q,AUTO               cn=1,n=*X1
        42 005274   000226 116007                    CMPQ    150,DL
        42 005275   005320 603000 42                 TRC     s:4780
        42 005276   777551 622006                    EAX2    -151,QL
        42 005277   777777 662003                    ERX2    -1,DU
        42 005300   200136 723100                    LXL3    SUB_NAME_LENGHT,,AUTO
        42 005301   040146 100540                    MLR     fill='040'O
        42 005302   000000 400013                    ADSC9   0,,PR0                   cn=2,n=*X3
        42 005303   200226 400012                    ADSC9   I+3,Q,AUTO               cn=2,n=*X2
        42 005304   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 005305   000226 116007                    CMPQ    150,DL
        42 005306   005320 603000 42                 TRC     s:4780
        42 005307   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 005310   200137 236100                    LDQ     SCHEMA_NAME_LENGHT,,AUTO
        42 005311   200136 036100                    ADLQ    SUB_NAME_LENGHT,,AUTO
        42 005312   200373 724100                    LXL4    @ERROR_ARRAY+2,,AUTO
        42 005313   777551 624014                    EAX4    -151,X4
        42 005314   777777 664003                    ERX4    -1,DU
        42 005315   040146 100400                    MLR     fill='040'O
        42 005316   000075 000001 43                 ADSC9   61                       cn=0,n=1
        42 005317   200226 400014                    ADSC9   I+3,Q,AUTO               cn=2,n=*X4

     1103     4774    7                              SUBSTR(NPTR$->
     1104     4775    7                              H_ALIAS.SUB$ -> HASH_STRUCT.C_NAME,0,
     1105     4776    7                              SCHEMA_NAME_LENGHT),'=',SUBSTR(NPTR$ ->
     1106     4777    7                              H_ALIAS.C_NAME,0,SUB_NAME_LENGHT),'.');
     1107     4778    7                           END;

     1108     4779    6                       END;

     1109     4780    5                   CALL ALIAS_WRITER;

   4780 42 005320   003646 701000 42                 TSX1    ALIAS_WRITER
        42 005321   000000 011000                    NOP     0

     1110     4781    5                   IF NPTR$ -> HASH_STRUCT.DUPS <3

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:198  
   4781 42 005322   200165 470500                    LDP0    NPTR$,,AUTO
        42 005323   000000 236100                    LDQ     0,,PR0
        42 005324   007777 376003                    ANQ     4095,DU
        42 005325   000003 116003                    CMPQ    3,DU
        42 005326   005333 603000 42                 TRC     s:4790

     1111     4782    6                   THEN DO;

     1112     4783    6                       CALL WARNING(#ALIAS_NOT_USED);

   4783 42 005327   000141 630400 43                 EPPR0   97
        42 005330   000003 631400 43                 EPPR1   3
        42 005331   000000 701000 xent               TSX1    WARNING
        42 005332   000000 011000                    NOP     0

     1113     4784        /*E*     ERROR:    ZIG-#ALIAS_NOT_USED-C
     1114     4785        MESSAGE: The above alias has not been used by the generator because
     1115     4786                 no schema name was equal to the name given in the rename
     1116     4787                 clause.
     1117     4788        */
     1118     4789    6                       END;

     1119     4790    5                   IF NPTR$ -> HASH_STRUCT.DUPS >3

   4790 42 005333   200165 470500                    LDP0    NPTR$,,AUTO
        42 005334   000000 236100                    LDQ     0,,PR0
        42 005335   007777 376003                    ANQ     4095,DU
        42 005336   000004 116003                    CMPQ    4,DU
        42 005337   005344 602000 42                 TNC     s:4799

     1120     4791    6                   THEN DO;

     1121     4792    6                       CALL WARNING(#ALIAS_USED_MORE);

   4792 42 005340   000143 630400 43                 EPPR0   99
        42 005341   000003 631400 43                 EPPR1   3
        42 005342   000000 701000 xent               TSX1    WARNING
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:199  
        42 005343   000000 011000                    NOP     0

     1122     4793        /*E*     ERROR:    ZIG-#ALIAS_USED_MORE-C
     1123     4794        MESSAGE: The above alias was used for more than one variable in
     1124     4795                 the subschema.
     1125     4796        */
     1126     4797    6                       END;

     1127     4798    5                   END;

     1128     4799    4               NPTR$ = NPTR$ -> HASH_STRUCT.PTR$;

   4799 42 005344   200165 470500                    LDP0    NPTR$,,AUTO
        42 005345   000010 236100                    LDQ     8,,PR0
        42 005346   200165 756100                    STQ     NPTR$,,AUTO

     1129     4800    4               END;

   4800 42 005347   200165 236100                    LDQ     NPTR$,,AUTO
        42 005350   000067 116000 43                 CMPQ    55
        42 005351   005357 600000 42                 TZE     s:4801
        42 005352   200165 470500                    LDP0    NPTR$,,AUTO
        42 005353   000000 236100                    LDQ     0,,PR0
        42 005354   070000 376003                    ANQ     28672,DU
        42 005355   060000 116003                    CMPQ    24576,DU
        42 005356   004611 600000 42                 TZE     s:4717

     1130     4801    3           END;

   4801 42 005357   200217 235100                    LDA     I,,AUTO
        42 005360   000001 035007                    ADLA    1,DL
        42 005361   200217 755100                    STA     I,,AUTO
        42 005362   001451 115007                    CMPA    809,DL
        42 005363   004573 602000 42                 TNC     s:4712

     1131     4802    2       RETURN;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:200  
   4802 42 005364   200216 221300                    LDX1  ! TEMP_WORD+8,,AUTO
        42 005365   000001 702211                    TSX2  ! 1,X1

     1132     4803    2   END GEN_ALIASES;
     1133     4804        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:201  
     1134     4805        /*
     1135     4806              Now the routine that flags the line to show what errors occured
     1136     4807            on this line of output so that we can print out the error message
     1137     4808            ( or infomation) after we print out the line of text.
     1138     4809        */
     1139     4810    1   FLAG_LINE:

   4810 42 005366   200220 741300       FLAG_LINE    STX1  ! J,,AUTO

     1140     4811    1       PROC (BIT_TO_FLAG);
     1141     4812    2   DCL BIT_TO_FLAG UBIN (36);
     1142     4813    2       O_REC.STATUS(BIT_TO_FLAG) = '1'B;

   4813 42 005367   200221 470500                    LDP0    @BIT_TO_FLAG,,AUTO
        42 005370   000000 235100                    LDA     0,,PR0
        42 005371   003005 060400                    CSL     bolr='003'O
        42 005372   000144 000001 43                 BDSC    100                      by=0,bit=0,n=1
        42 005373   000000 000001 36                 BDSC    O_REC,A                  by=0,bit=0,n=1

     1143     4814    2       RETURN;

   4814 42 005374   000001 702211                    TSX2  ! 1,X1

     1144     4815    2   END FLAG_LINE;
     1145     4816        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:202  
     1146     4817        /*
     1147     4818              Now the routine that evals what was the matter with this line
     1148     4819            of output and sets fields so things will look nice for a error
     1149     4820            message.
     1150     4821        */
     1151     4822    1   ERROR_EVAL:

   4822 42 005375   200370 741300       ERROR_EVAL   STX1  ! LIST_STRING+32,,AUTO

     1152     4823    1       PROC (ERROR_ARRAY);
     1153     4824    2   DCL 1 ERROR_ARRAY ALIGNED,
     1154     4825    2         2 ERROR_TYPE (0:35) BIT (1) UNAL;
     1155     4826    2       IF ERROR_ARRAY.ERROR_TYPE(#NO_DEFAULT_TYPE)

   4826 42 005376   200371 470500                    LDP0    @ERROR_ARRAY,,AUTO
        42 005377   000000 234100                    SZN     0,,PR0
        42 005400   005417 605000 42                 TPL     s:4835

     1156     4827    3       THEN DO;

     1157     4828    3           CALL SET_FIELDS(1,10,LANG_TEXT(SUB_LANGUAGE));

   4828 42 005401   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 005402   000147 402000 43                 MPY     103
        42 005403   000146 036000 43                 ADLQ    102
        42 005404   200374 756100                    STQ     @ERROR_ARRAY+3,,AUTO
        42 005405   000150 237000 43                 LDAQ    104
        42 005406   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 005407   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 005410   000000 631400 43                 EPPR1   0
        42 005411   000000 701000 xent               TSX1    SET_FIELDS
        42 005412   000000 011000                    NOP     0

     1158     4829    3           CALL ERROR(#ERR_NO_DEFAULT_TYPE);

   4829 42 005413   000153 630400 43                 EPPR0   107
        42 005414   000003 631400 43                 EPPR1   3
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:203  
        42 005415   000000 701000 xent               TSX1    ERROR
        42 005416   000000 011000                    NOP     0

     1159     4830        /*E*     ERROR:    ZIG-#ERR_NO_DEFAULT_TYPE-C
     1160     4831        MESSAGE: The above data name has no default conversion for the
     1161     4832                 %U1 subschema.
     1162     4833        */
     1163     4834    3           END;

     1164     4835    2       RETURN;

   4835 42 005417   200370 221300                    LDX1  ! LIST_STRING+32,,AUTO
        42 005420   000001 702211                    TSX2  ! 1,X1

     1165     4836    2   END ERROR_EVAL;
     1166     4837        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:204  
     1167     4838        /*
     1168     4839              Now the subroutine that sees if this name has been aliased or
     1169     4840            if this word is a reserved word so it should be aliased or
     1170     4841            if it was used some place else so the word should also
     1171     4842            be aliased to something.
     1172     4843
     1173     4844            note2:
     1174     4845                      cobol names musted convert all '_' to '-'
     1175     4846
     1176     4847            note3:
     1177     4848                      fortran names musted convert all '_' to '$'
     1178     4849
     1179     4850            note4:
     1180     4851                      things are not changed in the variable passted but in
     1181     4852                 the variable named REAL_NAME with the lenght of that variable
     1182     4853                 in the variable LEN_REAL_NAME.
     1183     4854        */
     1184     4855    1   CHECK_ALIAS:

   4855 42 005421   200220 741300       CHECK_ALIAS  STX1  ! J,,AUTO

     1185     4856    1       PROC (NAME_TO_CHECK);
     1186     4857    2   DCL NAME_TO_CHECK CHAR (30);
     1187     4858    2       REAL_NAME=NAME_TO_CHECK;

   4858 42 005422   200221 470500                    LDP0    @NAME_TO_CHECK,,AUTO
        42 005423   040100 100500                    MLR     fill='040'O
        42 005424   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        42 005425   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30

     1188     4859    2       CALL FIND_LENGTH(REAL_NAME,LEN_REAL_NAME);

   4859 42 005426   200140 631500                    EPPR1   LEN_REAL_NAME,,AUTO
        42 005427   200324 451500                    STP1    J,,AUTO
        42 005430   200125 633500                    EPPR3   REAL_NAME,,AUTO
        42 005431   200323 453500                    STP3    I,,AUTO
        42 005432   002212 701000 42                 TSX1    FIND_LENGTH
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:205  
        42 005433   000000 011000                    NOP     0

     1189     4860    2       CALL CHECK_CHAR_SET(REAL_NAME,ERROR_STATUS,POS);

   4860 42 005434   200170 630500                    EPPR0   POS,,AUTO
        42 005435   200325 450500                    STP0    @MUST_ALIAS+1,,AUTO
        42 005436   200166 631500                    EPPR1   ERROR_STATUS,,AUTO
        42 005437   200324 451500                    STP1    J,,AUTO
        42 005440   200125 633500                    EPPR3   REAL_NAME,,AUTO
        42 005441   200323 453500                    STP3    I,,AUTO
        42 005442   005631 701000 42                 TSX1    CHECK_CHAR_SET
        42 005443   000000 011000                    NOP     0

     1190     4861    2       IF STATUS = #IN_ITEM_PROCESSING

   4861 42 005444   200135 236100                    LDQ     STATUS,,AUTO
        42 005445   770000 376003                    ANQ     -4096,DU
        42 005446   050000 116003                    CMPQ    20480,DU
        42 005447   005453 601000 42                 TNZ     s:4863

     1191     4862    2       THEN TEMP_NU = ITEM_NU;

   4862 42 005450   000000 235000 39                 LDA     ITEM_NU
        42 005451   200204 755100                    STA     TEMP_NU,,AUTO
        42 005452   005455 710000 42                 TRA     s:4864

     1192     4863    2       ELSE TEMP_NU = 1;

   4863 42 005453   000001 235007                    LDA     1,DL
        42 005454   200204 755100                    STA     TEMP_NU,,AUTO

     1193     4864    2       IF ERROR_STATUS ~= 0

   4864 42 005455   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 005456   005461 600000 42                 TZE     s:4866

     1194     4865    2       THEN CALL ALIAS_IT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:206  

   4865 42 005457   005716 701000 42                 TSX1    ALIAS_IT
        42 005460   000000 011000                    NOP     0

     1195     4866    3       DO CASE (SUB_LANGUAGE);

   4866 42 005461   000000 235000 30                 LDA     SUB_LANGUAGE
        42 005462   000005 115007                    CMPA    5,DL
        42 005463   005465 602005 42                 TNC     s:4866+4,AL
        42 005464   005604 710000 42                 TRA     s:4894
        42 005465   005604 710000 42                 TRA     s:4894
        42 005466   005472 710000 42                 TRA     s:4868
        42 005467   005522 710000 42                 TRA     s:4875
        42 005470   005522 710000 42                 TRA     s:4875
        42 005471   005522 710000 42                 TRA     s:4875

     1196     4867    3       CASE (#COBOL);

     1197     4868    3           CALL ZIG$HASH_IT(REAL_NAME,#ADD,ERROR_STATUS,0,TEMP_NU,9,PTR$,

   4868 42 005472   200135 630500                    EPPR0   STATUS,,AUTO
        42 005473   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
        42 005474   200005 631500                    EPPR1   PTR$,,AUTO
        42 005475   200400 451500                    STP1    @ERROR_ARRAY+7,,AUTO
        42 005476   000051 236000 43                 LDQ     41
        42 005477   200377 756100                    STQ     @ERROR_ARRAY+6,,AUTO
        42 005500   200204 633500                    EPPR3   TEMP_NU,,AUTO
        42 005501   200376 453500                    STP3    @ERROR_ARRAY+5,,AUTO
        42 005502   000033 236000 43                 LDQ     27
        42 005503   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 005504   200166 634500                    EPPR4   ERROR_STATUS,,AUTO
        42 005505   200374 454500                    STP4    @ERROR_ARRAY+3,,AUTO
        42 005506   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 005507   200125 635500                    EPPR5   REAL_NAME,,AUTO
        42 005510   200372 455500                    STP5    @ERROR_ARRAY+1,,AUTO
        42 005511   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 005512   000046 631400 43                 EPPR1   38
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:207  
        42 005513   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 005514   000000 011000                    NOP     0

     1198     4869    3              STATUS);
     1199     4870    3           IF ERROR_STATUS ~= 0

   4870 42 005515   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 005516   005604 600000 42                 TZE     s:4894

     1200     4871    4           THEN DO;

     1201     4872    4               CALL ALIAS_IT;

   4872 42 005517   005716 701000 42                 TSX1    ALIAS_IT
        42 005520   000000 011000                    NOP     0

     1202     4873    4               END;

   4873 42 005521   005604 710000 42                 TRA     s:4894

     1203     4874    3       CASE (#FORTRAN,#APL,#BASIC);

     1204     4875    3           CALL ZIG$HASH_IT(REAL_NAME,#ADD,ERROR_STATUS,0,0,9,PTR$,

   4875 42 005522   200135 630500                    EPPR0   STATUS,,AUTO
        42 005523   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
        42 005524   200005 631500                    EPPR1   PTR$,,AUTO
        42 005525   200400 451500                    STP1    @ERROR_ARRAY+7,,AUTO
        42 005526   000050 237000 43                 LDAQ    40
        42 005527   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 005530   000033 236000 43                 LDQ     27
        42 005531   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 005532   200166 633500                    EPPR3   ERROR_STATUS,,AUTO
        42 005533   200374 453500                    STP3    @ERROR_ARRAY+3,,AUTO
        42 005534   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 005535   200125 634500                    EPPR4   REAL_NAME,,AUTO
        42 005536   200372 454500                    STP4    @ERROR_ARRAY+1,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:208  
        42 005537   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 005540   000046 631400 43                 EPPR1   38
        42 005541   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 005542   000000 011000                    NOP     0

     1205     4876    3              STATUS);
     1206     4877    3           IF ERROR_STATUS ~= 0

   4877 42 005543   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 005544   005550 600000 42                 TZE     s:4882

     1207     4878    4           THEN DO;

     1208     4879    4               CALL ALIAS_IT;

   4879 42 005545   005716 701000 42                 TSX1    ALIAS_IT
        42 005546   000000 011000                    NOP     0

     1209     4880    4               END;

   4880 42 005547   005604 710000 42                 TRA     s:4894

     1210     4881    4           ELSE DO;

     1211     4882    4               IF SUB_LANGUAGE = #FORTRAN

   4882 42 005550   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 005551   000002 116007                    CMPQ    2,DL
        42 005552   005604 601000 42                 TNZ     s:4894

     1212     4883    5               THEN DO;

     1213     4884    5                   HASH_SCHEMA_NAME = '1'B;

   4884 42 005553   400000 236003                    LDQ     -131072,DU
        42 005554   000000 756000 33                 STQ     HASH_SCHEMA_NAME

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:209  
     1214     4885    5                   CALL ZIG$HASH_IT(REAL_NAME,#NO_ADD,ERROR_STATUS,

   4885 42 005555   200135 630500                    EPPR0   STATUS,,AUTO
        42 005556   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
        42 005557   200005 631500                    EPPR1   PTR$,,AUTO
        42 005560   200400 451500                    STP1    @ERROR_ARRAY+7,,AUTO
        42 005561   000050 237000 43                 LDAQ    40
        42 005562   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 005563   000033 236000 43                 LDQ     27
        42 005564   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 005565   200166 633500                    EPPR3   ERROR_STATUS,,AUTO
        42 005566   200374 453500                    STP3    @ERROR_ARRAY+3,,AUTO
        42 005567   000004 236000 43                 LDQ     4
        42 005570   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 005571   200125 634500                    EPPR4   REAL_NAME,,AUTO
        42 005572   200372 454500                    STP4    @ERROR_ARRAY+1,,AUTO
        42 005573   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 005574   000046 631400 43                 EPPR1   38
        42 005575   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 005576   000000 011000                    NOP     0

     1215     4886    5                      0,0,9,PTR$,STATUS);
     1216     4887    5                   IF ERROR_STATUS = 1

   4887 42 005577   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 005600   000001 115007                    CMPA    1,DL
        42 005601   005604 601000 42                 TNZ     s:4894

     1217     4888    6                   THEN DO;

     1218     4889    6                       CALL ALIAS_IT;

   4889 42 005602   005716 701000 42                 TSX1    ALIAS_IT
        42 005603   000000 011000                    NOP     0

     1219     4890    6                       END;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:210  
     1220     4891    5                   END;

     1221     4892    4               END;

     1222     4893    3           END;

     1223     4894    2       RETURN;

   4894 42 005604   200220 221300                    LDX1  ! J,,AUTO
        42 005605   000001 702211                    TSX2  ! 1,X1

     1224     4895    2   END CHECK_ALIAS;
     1225     4896        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:211  
     1226     4897    1   LAST_ZERO: PROC (POS,NUM_STRING);

   4897 42 005606   200220 741300       LAST_ZERO    STX1  ! J,,AUTO

     1227     4898    2   DCL NUM_STRING CHAR (10);
     1228     4899    2   DCL POS UBIN (36);
     1229     4900    2   DCL I UBIN (36);
     1230     4901    3       DO I = 1 TO 9;

   4901 42 005607   000001 235007                    LDA     1,DL
        42 005610   200223 755100                    STA     I,,AUTO

     1231     4902    3           IF SUBSTR(NUM_STRING,I,1) ~= '0'

   4902 42 005611   200222 470500                    LDP0    @NUM_STRING,,AUTO
        42 005612   200223 235100                    LDA     I,,AUTO
        42 005613   040000 106505                    CMPC    fill='040'O
        42 005614   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        42 005615   000154 000001 43                 ADSC9   108                      cn=0,n=1
        42 005616   005623 600000 42                 TZE     s:4907

     1232     4903    4           THEN DO;

     1233     4904    4               POS=I;

   4904 42 005617   200221 471500                    LDP1    @POS,,AUTO
        42 005620   100000 755100                    STA     0,,PR1

     1234     4905    4               RETURN;

   4905 42 005621   200220 221300                    LDX1  ! J,,AUTO
        42 005622   000001 702211                    TSX2  ! 1,X1

     1235     4906    4               END;
     1236     4907    3           END;

   4907 42 005623   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:212  
        42 005624   200223 755100                    STA     I,,AUTO
        42 005625   000012 115007                    CMPA    10,DL
        42 005626   005611 602000 42                 TNC     s:4902

     1237     4908    2   END LAST_ZERO;

   4908 42 005627   200220 221300                    LDX1  ! J,,AUTO
        42 005630   000001 702211                    TSX2  ! 1,X1

     1238     4909        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:213  
     1239     4910    1   CHECK_CHAR_SET:

   4910 42 005631   200322 741300       CHECK_CHAR_* STX1  ! I+63,,AUTO

     1240     4911    1       PROC (WORD_TO_TRAN,MUST_ALIAS,POS);
     1241     4912    2   DCL WORD_TO_TRAN CHAR (30);
     1242     4913    2   DCL MUST_ALIAS UBIN (36);
     1243     4914    2   DCL POS UBIN (36);
     1244     4915    2   DCL CHAR_SET (0:4) CHAR (39) STATIC INIT ( 'NOT USED',
     1245     4916    2    'QWERTYUIOPASDFGHJKLZXCVBNM-1234567890  ' /* COBOLS */,
     1246     4917    2    'QWERTYUIOPASDFGHJKLZXCVBNM$1234567890  ' /* FORTRANS */,
     1247     4918    2   'QWERTYUIOPASDFGHJKLZXCVBNM_1234567890  ' /* APLS                              */,
     1248     4919    2   'QWERTYUIOPASDFGHJKLZXCVBNM_1234567890$ ' /* BASICS */
     1249     4920    2    );
     1250     4921    2   DCL ONE_CHANGE (0:3) CHAR (2) STATIC INIT ('  ',
     1251     4922    2    '_-' /* COBOL */, '_$' /* FORTRAN */, '__' /* APL */);
     1252     4923    2   DCL I UBIN (36);
     1253     4924    2   DCL J UBIN (36);
     1254     4925    2       MUST_ALIAS = 0;

   4925 42 005632   200324 470500                    LDP0    @MUST_ALIAS,,AUTO
        42 005633   000000 450100                    STZ     0,,PR0

     1255     4926    3       DO I = 1 TO 29;

   4926 42 005634   000001 235007                    LDA     1,DL
        42 005635   200326 755100                    STA     I,,AUTO

     1256     4927    3           CALL INDEX1(J,SUBSTR(WORD_TO_TRAN,I,1),CHAR_SET(SUB_LANGUAGE));

   4927 42 005636   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 005637   000047 402007                    MPY     39,DL
        42 005640   200323 470500                    LDP0    @WORD_TO_TRAN,,AUTO
        42 005641   200326 235100                    LDA     I,,AUTO
        42 005642   000105 124406                    SCM     mask='000'O
        42 005643   000153 000047 2                  ADSC9   CHAR_SET,Q               cn=0,n=39
        42 005644   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:214  
        42 005645   200327 000100                    ARG     J,,AUTO

     1257     4928    3           IF J > 38

   4928 42 005646   200327 235100                    LDA     J,,AUTO
        42 005647   000047 115007                    CMPA    39,DL
        42 005650   005671 602000 42                 TNC     s:4938

     1258     4929    4           THEN DO;

     1259     4930    4               IF SUBSTR(WORD_TO_TRAN,I,1)=SUBSTR(ONE_CHANGE(SUB_LANGUAGE)

   4930 42 005651   000000 235000 30                 LDA     SUB_LANGUAGE
        42 005652   000001 735000                    ALS     1
        42 005653   200326 236100                    LDQ     I,,AUTO
        42 005654   040005 106506                    CMPC    fill='040'O
        42 005655   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
        42 005656   000234 000001 2                  ADSC9   ONE_CHANGE,A             cn=0,n=1
        42 005657   005664 601000 42                 TNZ     s:4934

     1260     4931    4                  ,0,1)
     1261     4932    4              THEN CALL INSERT(WORD_TO_TRAN,I,1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),1,1));

   4932 42 005660   040106 100405                    MLR     fill='040'O
        42 005661   000234 200001 2                  ADSC9   ONE_CHANGE,A             cn=1,n=1
        42 005662   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
        42 005663   005671 710000 42                 TRA     s:4938

     1262     4933    5               ELSE DO;

     1263     4934    5                   MUST_ALIAS = 4;

   4934 42 005664   000004 235007                    LDA     4,DL
        42 005665   200324 471500                    LDP1    @MUST_ALIAS,,AUTO
        42 005666   100000 755100                    STA     0,,PR1

     1264     4935    5                   POS = I;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:215  

   4935 42 005667   200325 473500                    LDP3    @POS,,AUTO
        42 005670   300000 756100                    STQ     0,,PR3

     1265     4936    5                   END;

     1266     4937    4               END;

     1267     4938    3           END;

   4938 42 005671   200326 235100                    LDA     I,,AUTO
        42 005672   000001 035007                    ADLA    1,DL
        42 005673   200326 755100                    STA     I,,AUTO
        42 005674   000036 115007                    CMPA    30,DL
        42 005675   005636 602000 42                 TNC     s:4927

     1268     4939    2       CALL INDEX1(J,SUBSTR(WORD_TO_TRAN,0,1),CHAR_SET(SUB_LANGUAGE));

   4939 42 005676   000000 236000 30                 LDQ     SUB_LANGUAGE
        42 005677   000047 402007                    MPY     39,DL
        42 005700   000100 124406                    SCM     mask='000'O
        42 005701   000153 000047 2                  ADSC9   CHAR_SET,Q               cn=0,n=39
        42 005702   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        42 005703   200327 000100                    ARG     J,,AUTO

     1269     4940    2       IF J > 25

   4940 42 005704   200327 235100                    LDA     J,,AUTO
        42 005705   000032 115007                    CMPA    26,DL
        42 005706   005714 602000 42                 TNC     s:4945

     1270     4941    3       THEN DO;

     1271     4942    3           MUST_ALIAS = 4;

   4942 42 005707   000004 235007                    LDA     4,DL
        42 005710   200324 471500                    LDP1    @MUST_ALIAS,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:216  
        42 005711   100000 755100                    STA     0,,PR1

     1272     4943    3           POS = 0;

   4943 42 005712   200325 473500                    LDP3    @POS,,AUTO
        42 005713   300000 450100                    STZ     0,,PR3

     1273     4944    3           END;

     1274     4945    2       RETURN;

   4945 42 005714   200322 221300                    LDX1  ! I+63,,AUTO
        42 005715   000001 702211                    TSX2  ! 1,X1

     1275     4946    2   END CHECK_CHAR_SET;
     1276     4947        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:217  
     1277     4948        /*
     1278     4949              ALIAS THIS NAME BECAUSE IT NEEDS IT TO BE ALIASED.
     1279     4950                 THIS PROC IS PASSED ERROR_STATUS AND PTR_C$.
     1280     4951        */
     1281     4952    1   ALIAS_IT:

   4952 42 005716   200222 741300       ALIAS_IT     STX1  ! @NUM_STRING,,AUTO

     1282     4953    1       PROC;
     1283     4954    3       DO WHILE (ERROR_STATUS ~= 0);

   4954 42 005717   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 005720   006044 600000 42                 TZE     s:4984

     1284     4955    4           DO CASE (ERROR_STATUS);

   4955 42 005721   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 005722   000005 115007                    CMPA    5,DL
        42 005723   005725 602005 42                 TNC     s:4955+4,AL
        42 005724   006042 710000 42                 TRA     s:4983
        42 005725   006042 710000 42                 TRA     s:4983
        42 005726   005732 710000 42                 TRA     s:4957
        42 005727   005753 710000 42                 TRA     s:4962
        42 005730   005753 710000 42                 TRA     s:4962
        42 005731   006014 710000 42                 TRA     s:4971

     1285     4956    4           CASE (1); /* THERE IS A ALIAS IN THE HASH TABLE FOR THIS VARAIBLE.*/

     1286     4957    4               REAL_NAME=PTR$ -> HASH_STRUCT.SUBSCHEMA_NAME -> HASH_STRUCT.C_NAME;

   4957 42 005732   200005 470500                    LDP0    PTR$,,AUTO
        42 005733   000011 471500                    LDP1    9,,PR0
        42 005734   040100 100500                    MLR     fill='040'O
        42 005735   100000 400036                    ADSC9   0,,PR1                   cn=2,n=30
        42 005736   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30

     1287     4958    4               CALL FIND_LENGTH(REAL_NAME,LEN_REAL_NAME);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:218  

   4958 42 005737   200140 631500                    EPPR1   LEN_REAL_NAME,,AUTO
        42 005740   200324 451500                    STP1    @MUST_ALIAS,,AUTO
        42 005741   200125 633500                    EPPR3   REAL_NAME,,AUTO
        42 005742   200323 453500                    STP3    @WORD_TO_TRAN,,AUTO
        42 005743   002212 701000 42                 TSX1    FIND_LENGTH
        42 005744   000000 011000                    NOP     0

     1288     4959    4               PTR$ -> HASH_STRUCT.DUPS = PTR$ -> HASH_STRUCT.DUPS +1;

   4959 42 005745   200005 470500                    LDP0    PTR$,,AUTO
        42 005746   000000 236100                    LDQ     0,,PR0
        42 005747   000001 036003                    ADLQ    1,DU
        42 005750   000000 752130                    STCQ    0,'30'O,PR0

     1289     4960    4               RETURN;

   4960 42 005751   200222 221300                    LDX1  ! @NUM_STRING,,AUTO
        42 005752   000001 702211                    TSX2  ! 1,X1

     1290     4961    4           CASE (2,3); /* DUP DATA ITEM OR RESWORD */

     1291     4962    4               STORE_NAME=REAL_NAME;

   4962 42 005753   040100 100500                    MLR     fill='040'O
        42 005754   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30
        42 005755   200174 000036                    ADSC9   STORE_NAME,,AUTO         cn=0,n=30

     1292     4963    4               CALL CONCAT(REAL_NAME,SUBSTR(LETTER_STRING,LETTER_VAL,1),

   4963 42 005756   200172 236100                    LDQ     LETTER_VAL,,AUTO
        42 005757   040100 100406                    MLR     fill='040'O
        42 005760   000046 000001 2                  ADSC9   LETTER_STRING,Q          cn=0,n=1
        42 005761   200125 000001                    ADSC9   REAL_NAME,,AUTO          cn=0,n=1
        42 005762   200171 235100                    LDA     NUM_VAL,,AUTO
        42 005763   040100 100405                    MLR     fill='040'O
        42 005764   000055 000001 2                  ADSC9   NUM_LETTER_STRING,A      cn=0,n=1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:219  
        42 005765   200125 200001                    ADSC9   REAL_NAME,,AUTO          cn=1,n=1
        42 005766   040100 100500                    MLR     fill='040'O
        42 005767   200174 000034                    ADSC9   STORE_NAME,,AUTO         cn=0,n=28
        42 005770   200125 400034                    ADSC9   REAL_NAME,,AUTO          cn=2,n=28

     1293     4964    4                  SUBSTR(NUM_LETTER_STRING,NUM_VAL,1),STORE_NAME);
     1294     4965    4               LEN_REAL_NAME = LEN_REAL_NAME + 2;

   4965 42 005771   200140 235100                    LDA     LEN_REAL_NAME,,AUTO
        42 005772   000002 035007                    ADLA    2,DL
        42 005773   200140 755100                    STA     LEN_REAL_NAME,,AUTO

     1295     4966    4               NUM_VAL= MOD(NUM_VAL+1,36);

   4966 42 005774   200171 236100                    LDQ     NUM_VAL,,AUTO
        42 005775   000001 036007                    ADLQ    1,DL
        42 005776   000044 737000                    LLS     36
        42 005777   000043 773000                    LRL     35
        42 006000   000044 507007                    DVF     36,DL
        42 006001   200171 756100                    STQ     NUM_VAL,,AUTO

     1296     4967    4               IF NUM_VAL = 0

   4967 42 006002   000000 116003                    CMPQ    0,DU
        42 006003   006011 601000 42                 TNZ     s:4969

     1297     4968    4               THEN LETTER_VAL = MOD(LETTER_VAL+1,26);

   4968 42 006004   200172 235100                    LDA     LETTER_VAL,,AUTO
        42 006005   000001 035007                    ADLA    1,DL
        42 006006   000043 773000                    LRL     35
        42 006007   000032 507007                    DVF     26,DL
        42 006010   200172 756100                    STQ     LETTER_VAL,,AUTO

     1298     4969    4               CALL ADD_A_ALIAS;

   4969 42 006011   006046 701000 42                 TSX1    ADD_A_ALIAS
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:220  
        42 006012   000000 011000                    NOP     0
        42 006013   006042 710000 42                 TRA     s:4983

     1299     4970    4           CASE (4); /* THERE IS A BAD CARACTER IN THIS WORD */

     1300     4971    5               DO WHILE (ERROR_STATUS ~= 0);

   4971 42 006014   000000 115003                    CMPA    0,DU
        42 006015   006040 600000 42                 TZE     s:4981

     1301     4972    5                   IF POS = 0

   4972 42 006016   200170 235100                    LDA     POS,,AUTO
        42 006017   006023 601000 42                 TNZ     s:4977

     1302     4973    6                   THEN DO;

     1303     4974    6                       CALL INSERT(REAL_NAME,0,1,'Z');

   4974 42 006020   132000 236003                    LDQ     46080,DU
        42 006021   200125 552140                    STBQ    REAL_NAME,'40'O,AUTO

     1304     4975    6                       END;

   4975 42 006022   006026 710000 42                 TRA     s:4979

     1305     4976    6                   ELSE DO;

     1306     4977    6                       CALL INSERT(REAL_NAME,POS,1,'0');

   4977 42 006023   040105 100400                    MLR     fill='040'O
        42 006024   000154 000001 43                 ADSC9   108                      cn=0,n=1
        42 006025   200125 000001                    ADSC9   REAL_NAME,A,AUTO         cn=0,n=1

     1307     4978    6                       END;

     1308     4979    5                   CALL CHECK_CHAR_SET(REAL_NAME,ERROR_STATUS,POS);
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:221  

   4979 42 006026   200170 630500                    EPPR0   POS,,AUTO
        42 006027   200325 450500                    STP0    @POS,,AUTO
        42 006030   200166 631500                    EPPR1   ERROR_STATUS,,AUTO
        42 006031   200324 451500                    STP1    @MUST_ALIAS,,AUTO
        42 006032   200125 633500                    EPPR3   REAL_NAME,,AUTO
        42 006033   200323 453500                    STP3    @WORD_TO_TRAN,,AUTO
        42 006034   005631 701000 42                 TSX1    CHECK_CHAR_SET
        42 006035   000000 011000                    NOP     0

     1309     4980    5                   END;

   4980 42 006036   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 006037   006016 601000 42                 TNZ     s:4972

     1310     4981    4               CALL ADD_A_ALIAS;

   4981 42 006040   006046 701000 42                 TSX1    ADD_A_ALIAS
        42 006041   000000 011000                    NOP     0

     1311     4982    4               END; /* THIS IS THE END OF THE CASE STATEMENT */

     1312     4983    3           END;

   4983 42 006042   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 006043   005721 601000 42                 TNZ     s:4955

     1313     4984    2   END ALIAS_IT;

   4984 42 006044   200222 221300                    LDX1  ! @NUM_STRING,,AUTO
        42 006045   000001 702211                    TSX2  ! 1,X1

     1314     4985        %EJECT;
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:222  
     1315     4986        /*
     1316     4987              THIS SUBROUTINE ADDS A ALIAS TO THE HASH TABLE.
     1317     4988
     1318     4989            REAL_NAME = THE SUBSCHEMA NAME.
     1319     4990            UWA.SN.SENAME = THE SCHEMA NAME.
     1320     4991            SAVE_RECORD_NAME = THE RECORD NAME IF THIS IS A ITEM NAME.
     1321     4992
     1322     4993        */
     1323     4994    1   ADD_A_ALIAS:

   4994 42 006046   200224 741300       ADD_A_ALIAS  STX1  ! I+1,,AUTO

     1324     4995    1       PROC;
     1325     4996    2       TYPE_OF_ALIAS = STATUS;

   4996 42 006047   200135 236100                    LDQ     STATUS,,AUTO
        42 006050   000036 772000                    QRL     30
        42 006051   200013 756100                    STQ     TYPE_OF_ALIAS,,AUTO

     1326     4997    2       TEMP_STATUS = 6;

   4997 42 006052   060000 236003                    LDQ     24576,DU
        42 006053   200205 756100                    STQ     TEMP_STATUS,,AUTO

     1327     4998    2       IF SUB_LANGUAGE = #BASIC AND (UWA.FR.FTYPE=5 OR

   4998 42 006054   000000 235000 30                 LDA     SUB_LANGUAGE
        42 006055   000004 115007                    CMPA    4,DL
        42 006056   006131 601000 42                 TNZ     s:5012
        42 006057   000334 235000 0                  LDA     UWA+220
        42 006060   000005 115007                    CMPA    5,DL
        42 006061   006066 600000 42                 TZE     s:5001
        42 006062   000011 115007                    CMPA    9,DL
        42 006063   006066 600000 42                 TZE     s:5001
        42 006064   000023 115007                    CMPA    19,DL
        42 006065   006131 601000 42                 TNZ     s:5012

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:223  
     1328     4999    2          UWA.FR.FTYPE=9 OR UWA.FR.FTYPE=19) THEN
     1329     5000    3       DO;

     1330     5001    3           CALL INDEX1(TEMP_SBIN,' ',REAL_NAME);

   5001 42 006066   000000 124500                    SCM     mask='000'O
        42 006067   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30
        42 006070   000057 000001 43                 ADSC9   47                       cn=0,n=1
        42 006071   200162 000100                    ARG     TEMP_SBIN,,AUTO

     1331     5002    3           TEMP_WORD = REAL_NAME;

   5002 42 006072   040100 100500                    MLR     fill='040'O
        42 006073   200125 000036                    ADSC9   REAL_NAME,,AUTO          cn=0,n=30
        42 006074   200206 000036                    ADSC9   TEMP_WORD,,AUTO          cn=0,n=30

     1332     5003    3           IF TEMP_SBIN = LENGTHC(REAL_NAME) THEN

   5003 42 006075   200162 235100                    LDA     TEMP_SBIN,,AUTO
        42 006076   000036 115007                    CMPA    30,DL
        42 006077   006102 601000 42                 TNZ     s:5007

     1333     5004    4           DO;

     1334     5005    4               TEMP_SBIN = TEMP_SBIN - 1;

   5005 42 006100   000001 336007                    LCQ     1,DL
        42 006101   200162 056100                    ASQ     TEMP_SBIN,,AUTO

     1335     5006    4               END;

     1336     5007    3           CALL INSERT(TEMP_WORD,TEMP_SBIN,1,'$');

   5007 42 006102   200162 235100                    LDA     TEMP_SBIN,,AUTO
        42 006103   040105 100400                    MLR     fill='040'O
        42 006104   000132 000001 43                 ADSC9   90                       cn=0,n=1
        42 006105   200206 000001                    ADSC9   TEMP_WORD,A,AUTO         cn=0,n=1
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:224  

     1337     5008    3           CALL ZIG$HASH_IT(TEMP_WORD,#ADD,ERROR_STATUS,

   5008 42 006106   200205 630500                    EPPR0   TEMP_STATUS,,AUTO
        42 006107   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
        42 006110   200165 631500                    EPPR1   NPTR$,,AUTO
        42 006111   200400 451500                    STP1    @ERROR_ARRAY+7,,AUTO
        42 006112   000156 237000 43                 LDAQ    110
        42 006113   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 006114   200013 633500                    EPPR3   TYPE_OF_ALIAS,,AUTO
        42 006115   200375 453500                    STP3    @ERROR_ARRAY+4,,AUTO
        42 006116   200166 634500                    EPPR4   ERROR_STATUS,,AUTO
        42 006117   200374 454500                    STP4    @ERROR_ARRAY+3,,AUTO
        42 006120   000033 236000 43                 LDQ     27
        42 006121   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 006122   200206 635500                    EPPR5   TEMP_WORD,,AUTO
        42 006123   200372 455500                    STP5    @ERROR_ARRAY+1,,AUTO
        42 006124   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 006125   000046 631400 43                 EPPR1   38
        42 006126   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 006127   000000 011000                    NOP     0

     1338     5009    3              TYPE_OF_ALIAS,1,11,NPTR$,TEMP_STATUS);
     1339     5010    3           END;

   5010 42 006130   006153 710000 42                 TRA     s:5015

     1340     5011    2       ELSE
     1341     5012    2           CALL ZIG$HASH_IT(REAL_NAME,#ADD,

   5012 42 006131   200205 630500                    EPPR0   TEMP_STATUS,,AUTO
        42 006132   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
        42 006133   200165 631500                    EPPR1   NPTR$,,AUTO
        42 006134   200400 451500                    STP1    @ERROR_ARRAY+7,,AUTO
        42 006135   000156 237000 43                 LDAQ    110
        42 006136   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 006137   200013 633500                    EPPR3   TYPE_OF_ALIAS,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:225  
        42 006140   200375 453500                    STP3    @ERROR_ARRAY+4,,AUTO
        42 006141   200166 634500                    EPPR4   ERROR_STATUS,,AUTO
        42 006142   200374 454500                    STP4    @ERROR_ARRAY+3,,AUTO
        42 006143   000033 236000 43                 LDQ     27
        42 006144   200373 756100                    STQ     @ERROR_ARRAY+2,,AUTO
        42 006145   200125 635500                    EPPR5   REAL_NAME,,AUTO
        42 006146   200372 455500                    STP5    @ERROR_ARRAY+1,,AUTO
        42 006147   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 006150   000046 631400 43                 EPPR1   38
        42 006151   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 006152   000000 011000                    NOP     0

     1342     5013    2              ERROR_STATUS,TYPE_OF_ALIAS,1,11,NPTR$,
     1343     5014    2              TEMP_STATUS);
     1344     5015    2       IF ERROR_STATUS > 0

   5015 42 006153   200166 235100                    LDA     ERROR_STATUS,,AUTO
        42 006154   006157 600000 42                 TZE     s:5017

     1345     5016    2       THEN RETURN;

   5016 42 006155   200224 221300                    LDX1  ! I+1,,AUTO
        42 006156   000001 702211                    TSX2  ! 1,X1

     1346     5017    2       TEMP_STATUS = 7;

   5017 42 006157   070000 236003                    LDQ     28672,DU
        42 006160   200205 756100                    STQ     TEMP_STATUS,,AUTO

     1347     5018    2       CALL ZIG$HASH_IT(UWA.SN.SENAME,#NO_ADD,

   5018 42 006161   200205 630500                    EPPR0   TEMP_STATUS,,AUTO
        42 006162   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
        42 006163   200165 236100                    LDQ     NPTR$,,AUTO
        42 006164   000011 036003                    ADLQ    9,DU
        42 006165   200400 756100                    STQ     @ERROR_ARRAY+7,,AUTO
        42 006166   000064 237000 43                 LDAQ    52
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:226  
        42 006167   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 006170   000033 236000 43                 LDQ     27
        42 006171   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 006172   200166 631500                    EPPR1   ERROR_STATUS,,AUTO
        42 006173   200374 451500                    STP1    @ERROR_ARRAY+3,,AUTO
        42 006174   000160 237000 43                 LDAQ    112
        42 006175   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
        42 006176   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 006177   000046 631400 43                 EPPR1   38
        42 006200   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 006201   000000 011000                    NOP     0

     1348     5019    2          ERROR_STATUS,0,2,9,NPTR$ -> H_ALIAS.SUB$,
     1349     5020    2          TEMP_STATUS);
     1350     5021    2       IF TYPE_OF_ALIAS = 5

   5021 42 006202   200013 235100                    LDA     TYPE_OF_ALIAS,,AUTO
        42 006203   000005 115007                    CMPA    5,DL
        42 006204   006227 601000 42                 TNZ     s:5027

     1351     5022    3       THEN DO;

     1352     5023    3           CALL ZIG$HASH_IT(SAVE_RECORD_NAME,#NO_ADD,

   5023 42 006205   200205 630500                    EPPR0   TEMP_STATUS,,AUTO
        42 006206   200401 450500                    STP0    @ERROR_ARRAY+8,,AUTO
        42 006207   200165 236100                    LDQ     NPTR$,,AUTO
        42 006210   000012 036003                    ADLQ    10,DU
        42 006211   200400 756100                    STQ     @ERROR_ARRAY+7,,AUTO
        42 006212   000064 237000 43                 LDAQ    52
        42 006213   200376 757100                    STAQ    @ERROR_ARRAY+5,,AUTO
        42 006214   000066 236000 43                 LDQ     54
        42 006215   200375 756100                    STQ     @ERROR_ARRAY+4,,AUTO
        42 006216   200166 631500                    EPPR1   ERROR_STATUS,,AUTO
        42 006217   200374 451500                    STP1    @ERROR_ARRAY+3,,AUTO
        42 006220   000162 237000 43                 LDAQ    114
        42 006221   200372 757100                    STAQ    @ERROR_ARRAY+1,,AUTO
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:227  
        42 006222   200372 630500                    EPPR0   @ERROR_ARRAY+1,,AUTO
        42 006223   000046 631400 43                 EPPR1   38
        42 006224   000000 701000 xent               TSX1    ZIG$HASH_IT
        42 006225   000000 011000                    NOP     0

     1353     5024    3              ERROR_STATUS,7,2,9,NPTR$ ->
     1354     5025    3              H_ALIAS.QUAL$,TEMP_STATUS);
     1355     5026    3           END;

   5026 42 006226   006235 710000 42                 TRA     s:5028

     1356     5027    2       ELSE NPTR$ -> H_ALIAS.QUAL$ = ADDR(NIL);

   5027 42 006227   000067 236000 43                 LDQ     55
        42 006230   200372 756100                    STQ     @ERROR_ARRAY+1,,AUTO
        42 006231   200165 470500                    LDP0    NPTR$,,AUTO
        42 006232   000100 100500                    MLR     fill='000'O
        42 006233   200372 000004                    ADSC9   @ERROR_ARRAY+1,,AUTO     cn=0,n=4
        42 006234   000012 000004                    ADSC9   10,,PR0                  cn=0,n=4

     1357     5028    2   END ADD_A_ALIAS;

   5028 42 006235   200224 221300                    LDX1  ! I+1,,AUTO
        42 006236   000001 702211                    TSX2  ! 1,X1

UWA
 Sect OctLoc
   0     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
   0     004   040040 040040   040040 040040   040040 040040   040040 040040
   0     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
   0     014   040040 040040   040040 040040   040040 040040   040040 040040
   0     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
   0     024   040040 040040   040040 040040   040040 040040   040040 040040
   0     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
   0     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
   0     040   040040 040040   040040 040040   040040 040040   040040 040040
   0     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:228  
   0     050   040040 040040   040040 040040   040040 040040   040040 040040
   0     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
   0     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
   0     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
   0     070   040040 040040   040040 040040   040040 040040   040040 040040
   0     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
   0     104   040040 040040   040040 040040   040040 040040   040040 040040
   0     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
   0     130   040040 040040   040040 040040   040040 040040   040040 040040
   0     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
   0     140   040040 040040   040040 040040   040040 040040   040040 040040
   0     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
   0     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     154   040040 040040   040040 040040   040040 040040   040040 040040
   0     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
   0     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
   0     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
   0     174   040040 040040   040040 040040   040040 040040   040040 040040
   0     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   0     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
   0     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
   0     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
   0     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
   0     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
   0     430   040040 040040   040040 040040   040040 040040   040040 040040
   0     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
   0     440   040040 040040   040040 040040   040040 040040   040040 040040
   0     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
   0     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:229  
   0     460   040040 040040   040040 040040   040040 040040   040040 040040
   0     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
   0     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
   0     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
   0     504   040040 040040   040040 040040   040040 040040   040040 040040
   0     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
   0     524   040040 040040   040040 040040   040040 040040   040040 040040
   0     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
   0     614   040040 040040   040040 040040   040040 040040   040040 040040
   0     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
   0     624   040040 040040   040040 040040   040040 040040   040040 040040
   0     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   0     664   040040 040040   040040 040040   040040 040040   040040 040040
   0     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0     700   040040 040040   040040 040040   040040 040040   040040 040040
   0     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0     714   040040 040040   040040 040040   040040 040040   040040 040040
   0     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
   0     724   040040 040040   040040 040040   040040 040040   040040 040040
   0     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0     744   040040 040040   040040 040040   040040 040040   040040 040040
   0     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1000   040040 040040   040040 040040   040040 040040   040040 040040
   0    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1040   040040 040040   040040 040040   040040 040040   040040 040040
   0    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1064   040040 040040   040040 040040   040040 040040   040040 040040
   0    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1120   040040 040040   040040 040040   040040 040040   040040 040040
   0    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   0    1140   040040 040040   040040 040040   040040 040040   040040 040040
   0    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:230  
   0    1154   040040 040040   040040 040040   040040 040040   040040 040040
   0    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
   0    1170   040040 040040   040040 040040   040040 040040   040040 040040
   0    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   0    1204   040040 040040   040040 040040   040040 040040   040040 040040
   0    1214*  040040 040040   040040 040040   040040 040040   040040 040040

DESC
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

TYPE_NAME
 Sect OctLoc
   2     000   101122 105101   137116 101115   105040 040040   040040 040040    AREA_NAME
   2     004   040040 040040   040040 040040   040040 040040   040040 123105                  SE
   2     010   124137 116101   115105 040040   040040 040040   040040 040040    T_NAME
   2     014   040040 040040   040040 040040   040040 040040   113105 131137                KEY_
   2     020   116101 115105   040040 040040   040040 040040   040040 040040    NAME
   2     024   040040 040040   040040 040040   040040 122105   103117 122104              RECORD
   2     030   137116 101115   105040 040040   040040 040040   040040 040040    _NAME
   2     034   040040 040040   040040 040040   104101 124101   137116 101115            DATA_NAM
   2     040   105040 040040   040040 040040   040040 040040   040040 040040    E
   2     044   040040 040040   040040 ******                                          ..

LETTER_STRING
 Sect OctLoc
   2     046   101102 103104   105106 107110   111112 113114   115116 117120    ABCDEFGHIJKLMNOP
   2     052   121122 123124   125126 127130   131132 ******                    QRSTUVWXYZ..

NUM_LETTER_STRING
 Sect OctLoc
   2     055   060061 062063   064065 066067   070071 101102   103104 105106    0123456789ABCDEF
   2     061   107110 111112   113114 115116   117120 121122   123124 125126    GHIJKLMNOPQRSTUV
   2     065   127130 131132                                                    WXYZ

ALIAS_TYPE
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:231  
 Sect OctLoc
   2     066   040040 040040   040040 040040   040040 040122   105101 114115               REALM
   2     072   055116 101115   105040 123105   124055 116101   115105 040040    -NAME SET-NAME
   2     076   040113 105131   055116 101115   105040 040040   122105 103117     KEY-NAME   RECO
   2     102   122104 055116   101115 105111   124105 115055   116101 115105    RD-NAMEITEM-NAME
   2     106   040040 111124   105115 055116   101115 105040   040*** ******      ITEM-NAME  ...

A_TYPE
 Sect OctLoc
   2     112   040040 040040   040040 040040   040101 122105   101040 040040             AREA
   2     116   040040 123105   124040 040040   040040 040113   105131 040040      SET      KEY
   2     122   040040 040040   122105 103117   122104 040040   040111 124105        RECORD   ITE
   2     126   115040 040040   040040 111124   105115 040040   040040 040050    M     ITEM     (
   2     132   122105 101114   115051 040040   050123 105124   051040 040040    REALM)  (SET)
   2     136   040050 113105   131051 040040   040040 050122   105103 117122     (KEY)    (RECOR
   2     142   104051 040050   111124 105115   051040 040040   050111 124105    D) (ITEM)   (ITE
   2     146   115051 040040   040*** ******                                    M)   ...

ONE_CHANGE
 Sect OctLoc
   2     150   040040 137055   137044 137137   137137 ******                      _-_$____..

CHAR_SET
 Sect OctLoc
   2     153   116117 124040   125123 105104   040040 040040   040040 040040    NOT USED
   2     157   040040 040040   040040 040040   040040 040040   040040 040040
   2     163   040040 040040   040040 040121   127105 122124   131125 111117           QWERTYUIO
   2     167   120101 123104   106107 110112   113114 132130   103126 102116    PASDFGHJKLZXCVBN
   2     173   115055 061062   063064 065066   067070 071060   040040 121127    M-1234567890  QW
   2     177   105122 124131   125111 117120   101123 104106   107110 112113    ERTYUIOPASDFGHJK
   2     203   114132 130103   126102 116115   044061 062063   064065 066067    LZXCVBNM$1234567
   2     207   070071 060040   040121 127105   122124 131125   111117 120101    890  QWERTYUIOPA
   2     213   123104 106107   110112 113114   132130 103126   102116 115137    SDFGHJKLZXCVBNM_
   2     217   061062 063064   065066 067070   071060 040040   121127 105122    1234567890  QWER
   2     223   124131 125111   117120 101123   104106 107110   112113 114132    TYUIOPASDFGHJKLZ
   2     227   130103 126102   116115 137061   062063 064065   066067 070071    XCVBNM_123456789
   2     233   060044 040***                                                    0$ .
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:232  

ONE_CHANGE
 Sect OctLoc
   2     234   040040 137055   137044 137137                                      _-_$__

ANALS
 Sect OctLoc
   3     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
   4     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
   5     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
 Sect OctLoc
   6     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
   6     024*  ****** ******   ****** ******   ****** ******                    ............

VALIDS
 Sect OctLoc
   7     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCKS
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
   9     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DTRAN
 Sect OctLoc
  10     000   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:233  

SSTRANS
 Sect OctLoc
  11     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSGEN
 Sect OctLoc
  12     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  20     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  22     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  23     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  25     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  25     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  25     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  25     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  26     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  26     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  26     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  26     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  26     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  26     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  26     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:234  
  26     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  27     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  27     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  27     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  27     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  27     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  27     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  27     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  27     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  28     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  28     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  28     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  28     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  28     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  28     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  28     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  28     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

LANG_ALLOWED
 Sect OctLoc
  29     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_TEXT
 Sect OctLoc
  31     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_TEXT
 Sect OctLoc
  32     000   116117 124040   125123 105104   040040 103117   102117 114040    NOT USED  COBOL
  32     004   040040 040040   106117 122124   122101 116040   040040 101120        FORTRAN   AP
  32     010   114040 040040   040040 040040   102101 123111   103040 040040    L       BASIC
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:235  
  32     014   040040 ******                                                      ..

HASH_SCHEMA_NAME
 Sect OctLoc
  33     000   0***** ******                                                    ....

O_REC
 Sect OctLoc
  36     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SAVE_RECORD_NAME
 Sect OctLoc
  37     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HAS_TABLE
 Sect OctLoc
  38     000   000000 006014   000000 006014   000000 006014   000000 006014    ................
  38    1450*  000000 006014                                                    ....

(unnamed)
 Sect OctLoc
  41     000   040123 125102   123103 110105   115101 040107   105116 105122     SUBSCHEMA GENER
  41     004   101124 117122   123106 040040   104101 040040   117101 040040    ATORSF  DA  OA
  41     010   123116 055123   105040 040040   101055 104040   123116 055114    SN-SE   A-D SN-L
  41     014   124040 040040   114113 055114   124040 040040   042116 125114    T   LK-LT   "NUL
  41     020   114042 040040   065052 040040   123116 040040   040040 040040    L"  5*  SN
  41     024   040040 040123   124122 125103   124125 122105   040104 111126       STRUCTURE DIV
  41     030   111123 111117   116056 040040   040040 040040   040040 040122    ISION.         R
  41     034   105101 114115   040123 105103   124111 117116   056040 040040    EALM SECTION.
  41     040   040040 040040   040040 122105   101114 115040   075040 040040          REALM =
  41     044   040040 040040   040040 040040   040122 104040   040040 040040             RD
  41     050   040040 040040   040040 040040   040040 040040   104101 055123                DA-S
  41     054   116040 040040   060065 060062   061060 060040   060060 060060    N   0502100 0000
  41     060   060060 060040   040040 040040   040040 040123   105124 040123    000        SET S
  41     064   105103 124111   117116 056040   040040 040040   040040 123105    ECTION.       SE
  41     070   124040 075040   040040 040040   040040 040040   040123 104040    T =          SD
  41     074   040040 040040   040040 040113   105131 040123   105103 124111           KEY SECTI
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:236  
  41     100   117116 056040   040040 040040   040040 113105   131040 075040    ON.       KEY =
  41     104   040040 040040   040040 040040   040113 104040   040040 040040             KD
  41     110   040040 040122   105103 117122   104040 123105   103124 111117       RECORD SECTIO
  41     114   116056 040040   040040 040040   040040 040040   040060 061040    N.           01
  41     120   040040 040040   040040 122105   103117 122104   040060 061040          RECORD 01
  41     124   104102 101103   123040 124122   101116 123114   101124 105040    DBACS TRANSLATE
  41     130   040104 104114   040105 116104   040040 040040   040040 040124     DDL END       T
  41     134   111124 114105   040104 111126   111123 111117   116056 040040    ITLE DIVISION.
  41     140   040040 040040   040040 040040   040123 123040   040127 111124             SS  WIT
  41     144   110111 116040   040040 040040   040040 040115   101120 120111    HIN        MAPPI
  41     150   116107 040104   111126 111123   111117 116056   040040 040040    NG DIVISION.
  41     154   040040 040123   125102 123103   110105 115101   040040 040040       SUBSCHEMA
  41     160   040054 040123   103110 105115   101040 075040   040040 040040     , SCHEMA =
  41     164   040040 040105   116104 056040   122103 055106   122040 040040       END. RC-FR
  41     170   104111 123120   114101 131040   120111 103040   130050 040040    DISPLAY PIC X(
  41     174   051056 040040   104111 123120   114101 131040   120111 103040    ).  DISPLAY PIC
  41     200   130056 040040   103117 115120   055066 056040   104102 055113    X.  COMP-6. DB-K
  41     204   105131 056040   103117 115120   055064 040040   120111 103040    EY. COMP-4  PIC
  41     210   103117 115120   055061 061056   103117 115120   055061 062056    COMP-11.COMP-12.
  41     214   040052 052052   052040 116117   040104 105106   101125 114124     **** NO DEFAULT
  41     220   040104 101124   101040 124131   120105 040052   052052 052040     DATA TYPE ****
  41     224   040040 040040   040040 040040   040040 040060   062040 040040               02
  41     230   103110 101122   101103 124105   122040 050040   111116 124105    CHARACTER ( INTE
  41     234   107105 122056   104117 125102   114105 040120   122105 103111    GER.DOUBLE PRECI
  41     240   123111 117116   056040 040040   123111 116107   114105 040120    SION.   SINGLE P
  41     244   122105 103111   123111 117116   056040 040040   103110 101122    RECISION.   CHAR
  41     250   101103 124105   122052 040040   122105 101114   040040 040040    ACTER*  REAL
  41     254   040040 040040   040101 114111   101123 040123   105103 124111         ALIAS SECTI
  41     260   117116 056040   040040 040040   040040 040040   040040 040101    ON.            A
  41     264   104040 075075   073040 040040   075075 040102   105103 117115    D ==;   == BECOM
  41     270   105123 040040   040102 105103   117115 105123   040040 040040    ES   BECOMES
  41     274   040040 040040   040040 101114   111101 123040                          ALIAS

(unnamed)
 Sect OctLoc
  43     000   000003 000000   000000 000001   000000 000036   000001 000000    ................
  43     004   000001 006000   000002 006000   000000 021543   000006 006000    ................
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:237  
  43     010   000000 006000   000002 000000   000000 000002   000005 006000    ................
  43     014   000012 006000   000006 006000   000064 006000   000007 006000    .........4......
  43     020   000063 006000   000010 006000   000171 006000   000012 006000    .3.......y......
  43     024   000013 006000   000015 006000   000447 406000   000000 023317    ................
  43     030   000027 006000   000000 000000   000021 006000   000031 006000    ................
  43     034   000004 000000   000000 000003   000012 006000   000002 006000    ................
  43     040   777770 406000   000007 400000   000035 006000   000002 006000    ................
  43     044   000000 023311   000044 006000   000010 000000   000000 000011    .....$..........
  43     050   000031 006000   000047 006000   000000 023316   000052 006000    .....'.......*..
  43     054   000010 400000   000000 023315   000055 006000   040040 040040    .........-..
  43     060   000000 000013   000000 000007   000012 006000   000060 006000    .............0..
  43     064   000012 006000   000047 006000   000061 006000   000000 006014    .....'...1......
  43     070   000021 006000   000001 006000   000022 006000   000415 006000    ................
  43     074   000427 006000   056040 040040   054040 040040   000053 006000    .....   ,   .+..
  43     100   000022 006000   000417 006000   000022 006000   000420 006000    ................
  43     104   000022 006000   000416 006000   000013 206000   000003 606000    ................
  43     110   000000 006000   000001 006000   000002 006000   000003 606000    ................
  43     114   000000 021500   000114 006000   000000 000031   000116 006000    .....L.......N..
  43     120   000166 006000   777777 777761   777777 777777   123040 040040    .v..........S
  43     124   071040 040040   050040 040040   051040 040040   120040 040040    9   (   )   P
  43     130   126040 040040   777777 777756   044040 040040   075040 040040    V   ....$   =
  43     134   000000 023310   000134 006000   000000 023307   000136 006000    .....\.......^..
  43     140   000000 023306   000140 006000   000000 023305   000142 006000    .....`.......b..
  43     144   400000 000000   000000 000012   000000 006000   000002 400000    ................
  43     150   000001 006000   000145 006000   000000 023314   000152 006000    .....e.......j..
  43     154   060040 040040   000000 000000   000001 006000   000060 006000    0   .........0..
  43     160   000427 006000   000001 006000   000000 006000   000001 006000    ................
     1358     5029
     1359     5030        /*
     1360     5031              This is the end.
     1361     5032        */
     1362     5033    1   END ZIG$SS_GEN;

PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:238  
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_FIVESTAR_DESC.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$SS_GEN.

   Procedure ZIG$SS_GEN requires 3231 words for executable code.
   Procedure ZIG$SS_GEN requires 258 words of local(AUTO) storage.

    No errors detected in file ZIG$SS_GEN.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:239  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:240  
          MINI XREF LISTING

ADD_A_ALIAS
      4995**PROC     4486--CALL     4969--CALL     4981--CALL
ALIAS_DESC.S.NAME
      3766**DCL      3934<>CALL     3945<>CALL     3951<>CALL
ALIAS_DESC.S.QUAL
      3765**DCL      3902<>CALL     3920<>CALL     3933<>CALL     3947>>IF       3958<>CALL
ALIAS_DESC.SS.NAME
      3768**DCL      3899<>CALL     3903<>CALL     3915<>CALL     3921<>CALL     3935<>CALL
ALIAS_DESC.TYPE
      3763**DCL      3904>>CALL     3918>>IF       3947>>IF       3949>>ASSIGN
ALIAS_IT
      4953**PROC     4865--CALL     4872--CALL     4879--CALL     4889--CALL
ALIAS_PTR$
      3754**DCL      3757--IMP-PTR  3896<>CALL
ALIAS_TYPE
      3819**DCL      4666>>CALLBLT  4747>>CALLBLT
ALIAS_WRITER IN PROCEDURE GEN_ALIASES
      4596**PROC     4631--CALL     4700--CALL     4721--CALL     4780--CALL
ALT IN PROCEDURE CHANGE_TO_STR
      4583**LABEL    4578--CALLALT
A_TYPE
      3821**DCL      4693>>CALLBLT  4773>>CALLBLT
B.BIT36
      3777**DCL      3864>>IF
BIT_TO_FLAG IN PROCEDURE FLAG_LINE
      4812**DCL      4811--PROC     4813>>ASSIGN
BUFFER_INPUT
      3756**DCL      4217<>CALL
BUFFER_SIZE
      3755**DCL      3894<>CALL     3966<>CALL     4215<>CALL     4218<>CALL
CHANGE_STR IN PROCEDURE CHANGE_TO_STR
      4572**DCL      4571--PROC     4578>>CALLBLT  4580<<CALLBLT
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:241  
CHANGE_TO_STR
      4571**PROC     4645--CALL     4653--CALL     4680--CALL
CHAR_256 IN PROCEDURE GEN_ALIASES
      4594**DCL      4599>>CALLBLT  4602>>CALLBLT  4603>>ASSIGN   4605>>CALLBLT  4613>>ASSIGN   4619<<ASSIGN
      4655<<ASSIGN   4656<<CALLBLT  4665<<ASSIGN   4666<<CALLBLT  4682<<ASSIGN   4683<<CALLBLT  4691<<ASSIGN
      4693<<CALLBLT  4735<<ASSIGN   4736<<CALLBLT  4746<<ASSIGN   4747<<CALLBLT  4762<<ASSIGN   4763<<CALLBLT
      4771<<ASSIGN   4773<<CALLBLT
CHAR_SET IN PROCEDURE CHECK_CHAR_SET
      4915**DCL      4927>>CALLBLT  4939>>CALLBLT
CHECK_ALIAS
      4856**PROC     4005--CALL     4054--CALL     4101--CALL     4144--CALL     4304--CALL     4435--CALL
      4479--CALL     4531--CALL
CHECK_CHAR_SET
      4911**PROC     3899--CALL     3945--CALL     4183--CALL     4201--CALL     4640--CALL     4724--CALL
      4860--CALL     4979--CALL
CHECK_LOCK
      3878**LABEL    3863--CALLALT
CONT_AREAS
      4030**LABEL    4028--CALLALT
CONT_KEYS
      4126**LABEL    4124--CALLALT
CONT_SETS
      4079**LABEL    4077--CALLALT
COUNT
      3799**DCL      4328<<ASSIGN   4332>>CALLBLT  4333<<ASSIGN   4333>>ASSIGN   4343>>CALLBLT  4344<<ASSIGN
      4344>>ASSIGN   4350>>CALLBLT  4352<<ASSIGN   4352>>ASSIGN   4356>>CALLBLT  4357<<ASSIGN   4357>>ASSIGN
      4363>>CALLBLT  4365<<ASSIGN   4365>>ASSIGN   4369>>CALLBLT  4370<<ASSIGN   4370>>ASSIGN   4374>>CALLBLT
      4375<<ASSIGN   4375>>ASSIGN   4381>>CALLBLT  4383<<ASSIGN   4383>>ASSIGN   4387>>CALLBLT  4388<<ASSIGN
      4388>>ASSIGN   4394>>CALLBLT  4396<<ASSIGN   4396>>ASSIGN   4398>>CALLBLT
COUNT1 IN PROCEDURE CHANGE_TO_STR
      4573**DCL      4578<<CALLBLT  4580>>CALLBLT
DESC
      2789**DCL      2790--REDEF    2799--REDEF    2802--REDEF    2807--REDEF
DESCPTR
      3789**DCL      3756--IMP-PTR  3762--IMP-PTR  3894<>CALL     3899>>CALL     3902>>CALL     3903>>CALL
      3904>>CALL     3915>>CALL     3918>>IF       3920>>CALL     3921>>CALL     3933>>CALL     3934>>CALL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:242  
      3935>>CALL     3945>>CALL     3947>>IF       3947>>IF       3949>>ASSIGN   3951>>CALL     3958>>CALL
      3966<>CALL     4215<>CALL     4217>>CALL     4218<>CALL
DONE
      3751**DCL      3861<<ASSIGN   3862>>DOWHILE  3873<<ASSIGN
DP
      3801**DCL      4338<<ASSIGN   4339>>IF       4340<<ASSIGN   4354>>IF       4359>>IF       4361>>CALLBLT
      4367>>IF       4385>>IF       4390>>IF       4392>>CALLBLT
END_APL_RECORD IN PROCEDURE GET_APL_ITEMS
      4465**LABEL    4430--CALLALT  4462--CALLALT
END_BASIC_RECORD IN PROCEDURE GET_BASIC_ITEMS
      4517**LABEL    4474--CALLALT  4514--CALLALT
END_COBOL_RECORD IN PROCEDURE GET_COBOL_ITEMS
      4421**LABEL    4299--CALLALT  4418--CALLALT
END_FORTRAN_RECORD IN PROCEDURE GET_FORTRAN_ITEMS
      4564**LABEL    4526--CALLALT  4561--CALLALT
END_OF_AREA
      4017**LABEL    4015--CALLALT
END_OF_KEYS
      4113**LABEL    4111--CALLALT
END_OF_RECORDS
      4172**LABEL    4157--CALLALT  4167--CALLALT  4169--CALLALT
END_OF_SETS
      4066**LABEL    4064--CALLALT
EOF
      3788**DCL      3894<>CALL     3897>>DOWHILE  3966<>CALL     4215<>CALL     4216>>DOWHILE  4218<>CALL
ERROR
      3010**DCL-ENT  3837--CALL     3880--CALL     3906--CALL     3922--CALL     3936--CALL     4191--CALL
      4829--CALL
ERROR_ALIAS
      3760**DCL      3899<>CALL     3900>>IF       3915<>CALL     3918>>IF       3930>>IF       3945<>CALL
      3951<>CALL     3958<>CALL     4183<>CALL     4188>>IF       4201<>CALL
ERROR_ARRAY IN PROCEDURE ERROR_EVAL
      4824**DCL      4823--PROC
ERROR_ARRAY.ERROR_TYPE IN PROCEDURE ERROR_EVAL
      4825**DCL      4826>>IF
ERROR_EVAL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:243  
      4823**PROC     4255--CALL
ERROR_STATUS
      3811**DCL      4640<>CALL     4724<>CALL     4860<>CALL     4864>>IF       4868<>CALL     4870>>IF
      4875<>CALL     4877>>IF       4885<>CALL     4887>>IF       4954>>DOWHILE  4955>>DOCASE   4971>>DOWHILE
      4979<>CALL     5008<>CALL     5012<>CALL     5015>>IF       5018<>CALL     5023<>CALL
FETCHD_6
      2959**DCL-ENT  3848--CALL     3849--CALL     3850--CALL     3983--CALL     4035--CALL     4086--CALL
      4131--CALL     4166--CALL
FETCHNS_6
      2964**DCL-ENT  3863--CALL     4015--CALL     4028--CALL     4038--CALL     4064--CALL     4077--CALL
      4111--CALL     4124--CALL     4157--CALL     4167--CALL     4169--CALL     4299--CALL     4418--CALL
      4430--CALL     4462--CALL     4474--CALL     4514--CALL     4526--CALL     4561--CALL
FETCHOS_6
      2968**DCL-ENT  3851--CALL     3867--CALL     4303--CALL     4434--CALL     4478--CALL     4530--CALL
FIND_LENGTH
      4280**PROC     4181--CALL     4182--CALL     4642--CALL     4644--CALL     4651--CALL     4678--CALL
      4726--CALL     4728--CALL     4733--CALL     4760--CALL     4859--CALL     4958--CALL
FIRST_GEN_ALIAS
      3824**DCL      4621<<ASSIGN   4629>>IF       4638<<ASSIGN   4704>>IF       4719>>IF       4722<<ASSIGN
FIRST_NO_ZERO
      3806**DCL      4311<>CALL     4312>>CALLBLT  4349<>CALL     4350>>CALLBLT  4352>>ASSIGN   4362<>CALL
      4363>>CALLBLT  4365>>ASSIGN   4380<>CALL     4381>>CALLBLT  4383>>ASSIGN   4393<>CALL     4394>>CALLBLT
      4396>>ASSIGN   4440<>CALL     4441>>CALLBLT  4491<>CALL     4492>>CALLBLT  4536<>CALL     4537>>CALLBLT
FLAG_LINE
      4811**PROC     4412--CALL     4456--CALL     4508--CALL     4555--CALL
GEN_ALIASES
      4591**PROC     4213--CALL
GET_APL_ITEMS
      4428**PROC     4163--CALL
GET_BASIC_ITEMS
      4472**PROC     4165--CALL
GET_COBOL_ITEMS
      4297**PROC     4159--CALL
GET_FORTRAN_ITEMS
      4524**PROC     4161--CALL
GET_TIME
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:244  
      3029**DCL-ENT  3853--CALL
HASH_SCHEMA_NAME
      3157**DCL      3950<<ASSIGN   3957<<ASSIGN   4884<<ASSIGN
HASH_STRUCT.ALIAS_TYPE
      3159**DCL      4649>>IF       4666>>CALLBLT  4676>>IF       4692>>ASSIGN   4731>>IF       4747>>CALLBLT
      4758>>IF       4772>>ASSIGN
HASH_STRUCT.C_NAME
      3162**DCL      4640<>CALL     4642<>CALL     4645<>CALL     4651<>CALL     4653<>CALL     4656>>CALLBLT
      4656>>CALLBLT  4666>>CALLBLT  4678<>CALL     4680<>CALL     4683>>CALLBLT  4683>>CALLBLT  4693>>CALLBLT
      4724<>CALL     4726<>CALL     4733<>CALL     4736>>CALLBLT  4736>>CALLBLT  4736>>CALLBLT  4747>>CALLBLT
      4760<>CALL     4763>>CALLBLT  4763>>CALLBLT  4773>>CALLBLT  4957>>ASSIGN
HASH_STRUCT.DUPS
      3161**DCL      4627>>DOWHILE  4717>>IF       4781>>IF       4790>>IF       4959<<ASSIGN   4959>>ASSIGN
HASH_STRUCT.PTR$
      3163**DCL      4625>>ASSIGN   4701>>ASSIGN   4714>>ASSIGN   4799>>ASSIGN
HASH_STRUCT.SUBSCHEMA_NAME
      3164**DCL      4957>>ASSIGN
HASH_STRUCT.TYPE
      3160**DCL      4624>>DOWHILE  4627>>DOWHILE  4713>>DOWHILE  4716>>DOWHILE
HAS_TABLE
      3825**DCL      4623>>ASSIGN   4712>>ASSIGN
HEADING_TEXT
      3126**DCL      3846<<CALLBLT  3847<>CALL
HOLD_DBKEY
      3804**DCL      4156<<ASSIGN   4166<>CALL
H_ALIAS.C_NAME
      3772**DCL      4644<>CALL     4656>>CALLBLT  4666>>CALLBLT  4683>>CALLBLT  4693>>CALLBLT  4728<>CALL
      4747>>CALLBLT  4763>>CALLBLT  4773>>CALLBLT
H_ALIAS.QUAL$
      3775**DCL      3958<>CALL     3962<<ASSIGN   4651>>CALL     4653>>CALL     4656>>CALLBLT  4678>>CALL
      4680>>CALL     4683>>CALLBLT  4733>>CALL     4736>>CALLBLT  4760>>CALL     4763>>CALLBLT  5023<>CALL
      5027<<ASSIGN
H_ALIAS.SUB$
      3774**DCL      3954<<ASSIGN   4640>>CALL     4642>>CALL     4645>>CALL     4656>>CALLBLT  4666>>CALLBLT
      4683>>CALLBLT  4693>>CALLBLT  4724>>CALL     4726>>CALL     4736>>CALLBLT  4747>>CALLBLT  4763>>CALLBLT
      4773>>CALLBLT  5018<>CALL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:245  
I
      3782**DCL      4019<<CALLBLT  4020>>CALLBLT  4068<<CALLBLT  4069>>CALLBLT  4115<<CALLBLT  4116>>CALLBLT
      4183<>CALL
I IN PROCEDURE ALIAS_WRITER
      4597**DCL      4599<<CALLBLT  4600>>IF
I IN PROCEDURE CHECK_CHAR_SET
      4923**DCL      4926<<DOINDEX  4927>>CALLBLT  4930>>IF       4932>>CALLBLT  4935>>ASSIGN
I IN PROCEDURE GEN_ALIASES
      4592**DCL      4622<<DOINDEX  4623>>ASSIGN   4711<<DOINDEX  4712>>ASSIGN
I IN PROCEDURE LAST_ZERO
      4900**DCL      4901<<DOINDEX  4902>>IF       4904>>ASSIGN
INFO_ONLY
      3012**DCL-ENT  4706--CALL
INT
      3800**DCL      4335<<ASSIGN   4336>>IF       4337<<ASSIGN   4341>>IF       4346>>IF       4348>>CALLBLT
      4372>>IF       4377>>IF       4379>>CALLBLT
ITEM_NU
      3827**DCL      3843<<ASSIGN   4143<<ASSIGN   4143>>ASSIGN   4862>>ASSIGN
J IN PROCEDURE ALIAS_WRITER
      4598**DCL      4602<<CALLBLT  4603>>ASSIGN   4605>>CALLBLT
J IN PROCEDURE CHECK_CHAR_SET
      4924**DCL      4927<<CALLBLT  4928>>IF       4939<<CALLBLT  4940>>IF
J IN PROCEDURE GEN_ALIASES
      4593**DCL      4651<>CALL     4656>>CALLBLT  4678<>CALL     4683>>CALLBLT  4733<>CALL     4736>>CALLBLT
      4760<>CALL     4763>>CALLBLT
LANG_ALLOWED
      3112**DCL      3833>>IF
LANG_TEXT
      3127**DCL      3835>>ASSIGN   3846>>CALLBLT  3854>>CALLBLT  4185>>CALLBLT  4828<>CALL
LAST_ZERO
      4897**PROC     4311--CALL     4349--CALL     4362--CALL     4380--CALL     4393--CALL     4440--CALL
      4491--CALL     4536--CALL
LEN_REAL_NAME
      3794**DCL      4008>>CALLBLT  4012>>CALLBLT  4057>>CALLBLT  4061>>CALLBLT  4104>>CALLBLT  4108>>CALLBLT
      4148>>CALLBLT  4152>>CALLBLT  4557>>CALLBLT  4859<>CALL     4958<>CALL     4965<<ASSIGN   4965>>ASSIGN
LETTER_STRING
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:246  
      3815**DCL      4963>>CALLBLT
LETTER_VAL
      3818**DCL      3845<<ASSIGN   4963>>CALLBLT  4968<<ASSIGN   4968>>ASSIGN
LIST
      3025**DCL-ENT  4253--CALL
LIST_STRING IN PROCEDURE WRITER
      4244**DCL      4252<<ASSIGN   4253<>CALL
LOCKED
      3750**DCL      3860<<ASSIGN   3866<<ASSIGN   3872<<ASSIGN   3878>>IF
MUST_ALIAS IN PROCEDURE CHECK_CHAR_SET
      4913**DCL      4911--PROC     4925<<ASSIGN   4934<<ASSIGN   4942<<ASSIGN
NAME_TO_CHECK IN PROCEDURE CHECK_ALIAS
      4857**DCL      4856--PROC     4858>>ASSIGN
NEW_ALIAS_PTR$
      3759**DCL      3915<>CALL     3954>>ASSIGN
NOT_BLANK IN PROCEDURE FIND_LENGTH
      4286**LABEL    4283--CALLALT
NO_SETS
      4085**LABEL    4038--CALLALT
NPTR$
      3810**DCL      3951<>CALL     3954>>ASSIGN   3958>>CALL     3962>>ASSIGN   4623<<ASSIGN   4624>>DOWHILE
      4624>>DOWHILE  4625<<ASSIGN   4625>>ASSIGN   4627>>DOWHILE  4627>>DOWHILE  4627>>DOWHILE  4640>>CALL
      4642>>CALL     4644>>CALL     4645>>CALL     4649>>IF       4651>>CALL     4653>>CALL     4656>>CALLBLT
      4656>>CALLBLT  4656>>CALLBLT  4666>>CALLBLT  4666>>CALLBLT  4666>>CALLBLT  4676>>IF       4678>>CALL
      4680>>CALL     4683>>CALLBLT  4683>>CALLBLT  4683>>CALLBLT  4692>>ASSIGN   4693>>CALLBLT  4693>>CALLBLT
      4701<<ASSIGN   4701>>ASSIGN   4712<<ASSIGN   4713>>DOWHILE  4713>>DOWHILE  4714<<ASSIGN   4714>>ASSIGN
      4716>>DOWHILE  4716>>DOWHILE  4717>>IF       4724>>CALL     4726>>CALL     4728>>CALL     4731>>IF
      4733>>CALL     4736>>CALLBLT  4736>>CALLBLT  4736>>CALLBLT  4747>>CALLBLT  4747>>CALLBLT  4747>>CALLBLT
      4758>>IF       4760>>CALL     4763>>CALLBLT  4763>>CALLBLT  4763>>CALLBLT  4772>>ASSIGN   4773>>CALLBLT
      4773>>CALLBLT  4781>>IF       4790>>IF       4799<<ASSIGN   4799>>ASSIGN   5008<>CALL     5012<>CALL
      5018>>CALL     5023>>CALL     5027>>ASSIGN
NUM_LETTER_STRING
      3816**DCL      4963>>CALLBLT
NUM_STRING
      3803**DCL      4310<<CALLBLT  4311<>CALL     4312>>CALLBLT  4348<<CALLBLT  4349<>CALL     4350>>CALLBLT
      4361<<CALLBLT  4362<>CALL     4363>>CALLBLT  4379<<CALLBLT  4380<>CALL     4381>>CALLBLT  4392<<CALLBLT
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:247  
      4393<>CALL     4394>>CALLBLT  4439<<CALLBLT  4440<>CALL     4441>>CALLBLT  4490<<CALLBLT  4491<>CALL
      4492>>CALLBLT  4535<<CALLBLT  4536<>CALL     4537>>CALLBLT
NUM_STRING IN PROCEDURE LAST_ZERO
      4898**DCL      4897--PROC     4902>>IF
NUM_VAL
      3817**DCL      3844<<ASSIGN   4963>>CALLBLT  4966<<ASSIGN   4966>>ASSIGN   4967>>IF
NU_ALIAS
      3758**DCL      3895<<ASSIGN   3898<<ASSIGN   3898>>ASSIGN
ONE_CHANGE IN PROCEDURE CHANGE_TO_STR
      4574**DCL      4578>>CALLBLT  4580>>CALLBLT
ONE_CHANGE IN PROCEDURE CHECK_CHAR_SET
      4921**DCL      4930>>IF       4932>>CALLBLT
OUTPUT_REC
      3781**DCL      4008<<CALLBLT  4012<<CALLBLT  4019>>CALLBLT  4020<<CALLBLT  4024<<CALLBLT  4026<>CALL
      4057<<CALLBLT  4061<<CALLBLT  4068>>CALLBLT  4069<<CALLBLT  4073<<CALLBLT  4075<>CALL     4104<<CALLBLT
      4108<<CALLBLT  4115>>CALLBLT  4116<<CALLBLT  4120<<CALLBLT  4122<>CALL     4148<<CALLBLT  4152<<CALLBLT
      4155<>CALL     4414<<CALLBLT  4416<>CALL     4458<<CALLBLT  4460<>CALL     4510<<CALLBLT  4512<>CALL
      4557<<CALLBLT  4559<>CALL
O_REC
      3795**DCL      4604<>CALL     4610<>CALL     4614<>CALL
O_REC.STATUS
      3796**DCL      3797--REDEF    4269--CALL     4813<<ASSIGN
O_REC.STRING
      3798**DCL      4185<<CALLBLT  4199<<ASSIGN   4202<<CALLBLT  4205<<ASSIGN   4209<<CALLBLT  4221<<ASSIGN
      4268<<ASSIGN   4603<<ASSIGN   4605<<CALLBLT  4608<<CALLBLT  4613<<ASSIGN
O_REC.W_STATUS
      3797**DCL      4184<<ASSIGN   4187<>CALL     4200<>CALL     4204<>CALL     4206<>CALL     4211<>CALL
      4222<>CALL     4270<<ASSIGN
O_REC IN PROCEDURE WRITER
      4246**DCL      4243--PROC
O_REC.STATUS IN PROCEDURE WRITER
      4247**DCL      4248--REDEF
O_REC.STRING IN PROCEDURE WRITER
      4249**DCL      4250--ASSIGN   4252>>ASSIGN
O_REC.W_STATUS IN PROCEDURE WRITER
      4248**DCL      4254>>IF       4255<>CALL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:248  
POS
      3814**DCL      4640<>CALL     4724<>CALL     4860<>CALL     4972>>IF       4977>>CALLBLT  4979<>CALL
POS IN PROCEDURE CHECK_CHAR_SET
      4914**DCL      4911--PROC     4935<<ASSIGN   4943<<ASSIGN
POS IN PROCEDURE LAST_ZERO
      4899**DCL      4897--PROC     4904<<ASSIGN
POSITION
      3809**DCL      3899<>CALL     3945<>CALL     4201<>CALL
PTR$
      3753**DCL      4868<>CALL     4875<>CALL     4885<>CALL     4957>>ASSIGN   4959>>ASSIGN   4959>>ASSIGN
REAL_NAME
      3790**DCL      4008>>CALLBLT  4012>>CALLBLT  4057>>CALLBLT  4061>>CALLBLT  4104>>CALLBLT  4108>>CALLBLT
      4148>>CALLBLT  4152>>CALLBLT  4414>>CALLBLT  4458>>CALLBLT  4482>>CALLBLT  4483--IF       4485<<CALLBLT
      4488<<CALLBLT  4510>>CALLBLT  4557>>CALLBLT  4858<<ASSIGN   4859<>CALL     4860<>CALL     4868<>CALL
      4875<>CALL     4885<>CALL     4957<<ASSIGN   4958<>CALL     4962>>ASSIGN   4963<<CALLBLT  4974<<CALLBLT
      4977<<CALLBLT  4979<>CALL     5001>>CALLBLT  5002>>ASSIGN   5003--IF       5012<>CALL
RECORD_POINTER IN PROCEDURE WRITER
      4245**DCL      4250<<ASSIGN
RETURN_LENGTH IN PROCEDURE FIND_LENGTH
      4281**DCL      4280--PROC     4283<<CALLBLT  4286<<ASSIGN
SAVE_RECORD_NAME
      3813**DCL      4145<<ASSIGN   5023<>CALL
SCHEMA_NAME_LENGHT
      3793**DCL      4181<>CALL     4202>>CALLBLT  4209>>CALLBLT  4642<>CALL     4656>>CALLBLT  4666>>CALLBLT
      4683>>CALLBLT  4693>>CALLBLT  4726<>CALL     4736>>CALLBLT  4747>>CALLBLT  4763>>CALLBLT  4773>>CALLBLT
SET_FIELDS
      3013**DCL-ENT  3836--CALL     3902--CALL     3903--CALL     3904--CALL     3920--CALL     3921--CALL
      3933--CALL     3934--CALL     3935--CALL     4190--CALL     4828--CALL
SSGEN.ALIAS_NAMES
      2942**DCL      3890>>IF
SSGEN.DISP_KEY
      2944**DCL      3869>>IF
SSGEN.MAP
      2947**DCL      4549>>IF       4551>>IF
SSGEN.SNAME
      2946**DCL      4181<>CALL     4201<>CALL     4202>>CALLBLT  4209>>CALLBLT
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:249  
SSGEN.SSNAME
      2945**DCL      3854>>CALLBLT  4182<>CALL     4183<>CALL     4185>>CALLBLT  4190<>CALL     4202>>CALLBLT
      4209>>CALLBLT
STATUS
      3791**DCL      3892<<ASSIGN   3951<>CALL     3984<<ASSIGN   4036<<ASSIGN   4085<<ASSIGN   4142<<ASSIGN
      4298<<ASSIGN   4429<<ASSIGN   4473<<ASSIGN   4525<<ASSIGN   4861>>IF       4868<>CALL     4875<>CALL
      4885<>CALL     4996>>ASSIGN
STEPCC
      3752**DCL      3886<<ASSIGN
STORE
      4266**PROC     3989--CALL     3996--CALL     4000--CALL     4026--CALL     4045--CALL     4049--CALL
      4075--CALL     4092--CALL     4096--CALL     4122--CALL     4137--CALL     4155--CALL     4416--CALL
      4460--CALL     4512--CALL     4559--CALL
STORE_NAME
      3826**DCL      3835<<ASSIGN   3836<>CALL     3868<>CALL     3869>>IF       4962<<ASSIGN   4963>>CALLBLT
STRE_6
      2956**DCL-ENT  3855--CALL
STRING_TO_GET IN PROCEDURE FIND_LENGTH
      4282**DCL      4280--PROC     4283>>CALLBLT
STRING_TO_STORE IN PROCEDURE STORE
      4267**DCL      4266--PROC     4268>>ASSIGN
SUBLST
      3027**DCL-ENT  3847--CALL
SUBSCHEMA_KEY
      3045**DCL      3046--REDEF
SUB_LANGUAGE
      3113**DCL      3833>>IF       3835>>ASSIGN   3846>>CALLBLT  3854>>CALLBLT  3930>>IF       3986>>IF
      3993>>IF       4006>>IF       4022>>IF       4042>>IF       4055>>IF       4071>>IF       4089>>IF
      4102>>IF       4118>>IF       4134>>IF       4146>>IF       4158>>IF       4160>>IF       4162>>IF
      4164>>IF       4185>>CALLBLT  4197>>IF       4576>>IF       4576>>IF       4578>>CALLBLT  4580>>CALLBLT
      4606>>IF       4617>>IF       4631>>IF       4647>>IF       4721>>IF       4729>>IF       4828>>CALL
      4866>>DOCASE   4882>>IF       4927>>CALLBLT  4930>>IF       4932>>CALLBLT  4939>>CALLBLT  4998>>IF
SUB_NAME_LENGHT
      3792**DCL      4182<>CALL     4185>>CALLBLT  4202>>CALLBLT  4209>>CALLBLT  4644<>CALL     4656>>CALLBLT
      4666>>CALLBLT  4683>>CALLBLT  4693>>CALLBLT  4728<>CALL     4736>>CALLBLT  4747>>CALLBLT  4763>>CALLBLT
      4773>>CALLBLT
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:250  
SUB_TITLE
      3780**DCL      3995<<ASSIGN   3996<>CALL     3999<<ASSIGN   4000<>CALL     4044<<ASSIGN   4045<>CALL
      4048<<ASSIGN   4049<>CALL     4091<<ASSIGN   4092<>CALL     4095<<ASSIGN   4096<>CALL     4136<<ASSIGN
      4137<>CALL
TEMP_NU
      3828**DCL      4862<<ASSIGN   4863<<ASSIGN   4868<>CALL
TEMP_SBIN
      3805**DCL      4309<<ASSIGN   4310>>CALLBLT  4438<<ASSIGN   4439>>CALLBLT  4482<<CALLBLT  4483>>IF
      4484<<ASSIGN   4484>>ASSIGN   4485>>CALLBLT  4488>>CALLBLT  4489<<ASSIGN   4490>>CALLBLT  4534<<ASSIGN
      4535>>CALLBLT  5001<<CALLBLT  5003>>IF       5005<<ASSIGN   5005>>ASSIGN   5007>>CALLBLT
TEMP_STATUS
      3829**DCL      3914<<ASSIGN   3915<>CALL     3958<>CALL     4997<<ASSIGN   5008<>CALL     5012<>CALL
      5017<<ASSIGN   5018<>CALL     5023<>CALL
TEMP_WORD
      3830**DCL      5002<<ASSIGN   5007<<CALLBLT  5008<>CALL
TITLE
      3779**DCL      3985<<ASSIGN   3988<<ASSIGN   3989<>CALL
TVBL
      3784**DCL      4692<<ASSIGN   4693>>CALLBLT  4772<<ASSIGN   4773>>CALLBLT
TYPE_NAME
      2816**DCL      3904<>CALL
TYPE_OF_ALIAS
      3761**DCL      3948<<ASSIGN   3949<<ASSIGN   3951<>CALL     3955>>IF       4996<<ASSIGN   5008<>CALL
      5012<>CALL     5021>>IF
UCLOSE
      3034**DCL-ENT  3968--CALL     4173--CALL     4220--CALL
UGET
      3032**DCL-ENT  3894--CALL     3966--CALL     4215--CALL     4218--CALL
UNSC
      3808**DCL-ENT  3868--CALL
UOPEN
      3031**DCL-ENT  3893--CALL     3970--CALL     4214--CALL
UPUT
      3033**DCL-ENT  4269--CALL
UWA.AC.CALC_NEXT
      2552**DCL      2553--REDEF
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:251  
UWA.AC.CALC_PRIOR
      2561**DCL      2562--REDEF
UWA.AC.DEFAULTS
      2513**DCL      2514--REDEF
UWA.AC.FILE_CODE
      2518**DCL      2519--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      2515**DCL      2516--REDEF
UWA.A_D.AD_DATE
      2496**DCL      3853<>CALL
UWA.A_D.AD_FUNCTION
      2495**DCL      3852<<ASSIGN
UWA.A_D.AD_IDENT
      2497**DCL      3854<<CALLBLT
UWA.DA.FRST_AC
      2660**DCL      3983<>CALL
UWA.DA.FRST_KC
      2663**DCL      4086<>CALL
UWA.DA.FRST_RC
      2661**DCL      4131<>CALL
UWA.DA.FRST_SC
      2662**DCL      4035<>CALL
UWA.DB_STATUS
      2444**DCL      4002>>DOWHILE  4017>>IF       4051>>DOWHILE  4066>>IF       4098>>DOWHILE  4113>>IF
      4300>>DOWHILE  4431>>DOWHILE  4475>>DOWHILE  4527>>DOWHILE
UWA.DIRECT_REF
      2453**DCL      4156>>ASSIGN
UWA.FR.FTYPE
      2609**DCL      4305>>IF       4305>>IF       4305>>IF       4320>>IF       4320>>IF       4323>>IF
      4326>>IF       4326>>IF       4330>>IF       4401>>IF       4406>>IF       4436>>IF       4436>>IF
      4436>>IF       4445>>IF       4445>>IF       4445>>IF       4448>>IF       4448>>IF       4448>>IF
      4448>>IF       4448>>IF       4448>>IF       4448>>IF       4448>>IF       4480>>IF       4480>>IF
      4480>>IF       4496>>IF       4499>>IF       4499>>IF       4499>>IF       4499>>IF       4499>>IF
      4499>>IF       4499>>IF       4499>>IF       4499>>IF       4499>>IF       4532>>IF       4532>>IF
      4532>>IF       4541>>DOCASE   4998>>IF       4998>>IF       4998>>IF
UWA.FR.F_USE
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:252  
      2616**DCL      4301>>IF       4432>>IF       4476>>IF       4528>>IF
UWA.FR.PREC
      2610**DCL      4307>>IF       4309>>ASSIGN   4335>>ASSIGN   4336>>IF       4337>>ASSIGN   4339>>IF
      4340>>ASSIGN   4438>>ASSIGN   4489>>ASSIGN   4534>>ASSIGN
UWA.FR.SCALE
      2611**DCL      4335>>ASSIGN   4338>>ASSIGN
UWA.FR.SYN
      2607**DCL      4301>>IF       4432>>IF       4476>>IF       4528>>IF
UWA.LK.PLVALUE
      2674**DCL      3868<>CALL     3869>>IF
UWA.LT.PLOCKS
      2685**DCL      3864--IF
UWA.SF.DBKEY_DA
      2463**DCL      3849<>CALL
UWA.SF.DBKEY_OA
      2462**DCL      3850<>CALL
UWA.SN.SENAME
      2671**DCL      4003>>IF       4005<>CALL     4037>>DOWHILE  4052>>IF       4054<>CALL     4099>>IF
      4101<>CALL     4140>>IF       4144<>CALL     4145>>ASSIGN   4304<>CALL     4435<>CALL     4479<>CALL
      4531<>CALL     5018<>CALL
UWA.SN.SETYPE
      2668**DCL      3991>>IF       4002>>DOWHILE  4017>>IF       4037>>DOWHILE  4040>>IF       4051>>DOWHILE
      4066>>IF       4087>>IF       4098>>DOWHILE  4113>>IF       4132>>IF       4139>>DOWHILE
VARIABLE_TYPE
      3802**DCL      4312<<CALLBLT  4316<<ASSIGN   4321<<ASSIGN   4324<<ASSIGN   4329<<ASSIGN   4332<<CALLBLT
      4343<<CALLBLT  4350<<CALLBLT  4356<<CALLBLT  4363<<CALLBLT  4369<<CALLBLT  4374<<CALLBLT  4381<<CALLBLT
      4387<<CALLBLT  4394<<CALLBLT  4398<<CALLBLT  4403<<ASSIGN   4408<<ASSIGN   4411<<ASSIGN   4414>>CALLBLT
      4441<<CALLBLT  4446<<ASSIGN   4452<<ASSIGN   4455<<ASSIGN   4458>>CALLBLT  4492<<CALLBLT  4497<<ASSIGN
      4504<<ASSIGN   4507<<ASSIGN   4510>>CALLBLT  4537<<CALLBLT  4543<<ASSIGN   4545<<ASSIGN   4547<<ASSIGN
      4550<<ASSIGN   4552<<ASSIGN   4554<<ASSIGN   4557>>CALLBLT
WARNING
      3011**DCL-ENT  4632--CALL     4783--CALL     4792--CALL
WORD_TO_TRAN IN PROCEDURE CHECK_CHAR_SET
      4912**DCL      4911--PROC     4927>>CALLBLT  4930>>IF       4932<<CALLBLT  4939>>CALLBLT
WRITER
      4243**PROC     4187--CALL     4200--CALL     4204--CALL     4206--CALL     4211--CALL     4217--CALL
PL6.E3A0      #001=ZIG$SS_GEN File=ZIG$SS_GEN.:ZIC0TSI                           FRI 09/05/97 12:10 Page:253  
      4222--CALL     4604--CALL     4610--CALL     4614--CALL
WRITERECORD_TO_SEQ_FILE
      3023**DCL-ENT  4251--CALL
ZIG$G_DYN_MEM_6
      3020**DCL-ENT  3896--CALL
ZIG$HASH_IT
      3807**DCL-ENT  3915--CALL     3951--CALL     3958--CALL     4868--CALL     4875--CALL     4885--CALL
      5008--CALL     5012--CALL     5018--CALL     5023--CALL
