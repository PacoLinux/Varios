VERSION E05

PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:1    
        1        1        /*M*  PSD$HISTO   Produce STATS histograms                                    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CLM=77,CRM=80,CRT=1,PLM=3,CTI=1,THI=2                                    */
        8        8        PSD$HISTO: PROC (SPECIFIC_BUCKET);
        9        9        %INCLUDE CP_6;
       10       90        %INCLUDE PS_DATA_R;
       11     5386        %INCLUDE CP_6_SUBS;
       12     5926
       13     5927        %DUMMY_BUCKET (NAME=SPECIFIC_BUCKET, STCLASS=" ");
       14     5933        %DUMMY_BUCKET (NAME=BUCKET, STCLASS=BASED);
       15     5939    1   DCL LINE_FORMAT CHAR(0) CONSTANT INIT ('%6D to %D%18-|%40A| %8D (%3D %%)');
       16     5940
       17     5941    1   DCL LAST_FORMAT CHAR(0) CONSTANT INIT ('%6D and above%18-|%40A| %8D (%3D %%)');
       18     5942
       19     5943    1   DCL 1 HEADER_FORMAT CONSTANT,
       20     5944    1         2 P1 CHAR(0) INIT ('%2/%N-%A histogram of %A%2/'),
       21     5945    1         2 P2 CHAR(0) INIT ('%N-%A%18-/---|---|---|---|---|---|---|---|---|---|\');
       22     5946
       23     5947    1   DCL SIMPLE_FORMAT CHAR (0) CONSTANT
       24     5948    1      INIT ('%2/%18-/---|---|---|---|---|---|---|---|---|---|\');
       25     5949
       26     5950    1   DCL 1 TRAILER_FORMAT CONSTANT,
       27     5951    1         2 P1 CHAR(0) INIT ('%18-\---|---|---|---|---|---|---|---|---|---|/'),
       28     5952    1         2 P2 CHAR (0) INIT ('%10A%/%61-%8D%2/');
       29     5953
       30     5954    1   DCL BLOTTO_FORMAT CHAR(0) CONSTANT INIT
       31     5955    1         ('%12-No events occurred in this interval - histogram skipped.%/');
       32     5956
       33     5957    1   DCL TITLE_VECTOR BIT(72) DALIGNED STATIC;
       34     5958    1   DCL UNITS_VECTOR BIT(72) DALIGNED STATIC;
       35     5959    1   DCL LOW UBIN WORD STATIC;
       36     5960    1   DCL HIGH UBIN WORD STATIC;
       37     5961    1   DCL NR UBIN WORD STATIC;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:2    
       38     5962    1   DCL NP UBIN WORD STATIC;
       39     5963    1   DCL DID_ONE LOGICAL;
       40     5964    1   DCL EVENT_COUNT UBIN WORD STATIC;
       41     5965    1   DCL EVENT_COUNT_SBIN REDEF EVENT_COUNT SBIN WORD ;
       42     5966    1   DCL HEADER_TAB_1 UBIN WORD STATIC;
       43     5967    1   DCL HEADER_TAB_2 UBIN WORD STATIC;
       44     5968    1   DCL HEADER_TYPE CHAR (6) STATIC;
       45     5969    1   DCL BAR CHAR (40) STATIC;
       46     5970    1   DCL IBAR (0:39) REDEF BAR CHAR (1);
       47     5971    1   DCL XSTAR (0:39) CHAR (1) CONSTANT INIT ('*'*0);
       48     5972    1   DCL STARS REDEF XSTAR CHAR (40);
       49     5973    1   DCL UNDERLINER CHAR(10) STATIC;
       50     5974    1   DCL UNDERLINE_STUFF CHAR(17) CONSTANT INIT ('       ----------');
       51     5975    1   DCL XFILL (0:39) CHAR (1) CONSTANT INIT ('`', '-'*39);
       52     5976    1   DCL FILL REDEF XFILL CHAR (40);
       53     5977    1   DCL BUCKET$ PTR;
       54     5978    1   DCL OLD_BUCKET$ PTR;
       55     5979
       56     5980        %EJECT;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:3    
       57     5981    1   DCL PSL$LOCATE ENTRY (3);
       58     5982        %INCLUDE XUF_ENTRY;
       59     5990    1   DCL PSD$SKIP ENTRY;
       60     5991    1   DCL PSD$EJECT ENTRY (1);
       61     5992
       62     5993        %MACRO HISTOGRAM (NAME=*, CODE=0, TITLE="' '", UNITS="' '");
       63     5994        DCL 1 NAME CONSTANT,
       64     5995              2 CODE# UBIN WORD INIT (CODE),
       65     5996              2 UNITS#,
       66     5997                3 LEN UBIN BYTE UNAL INIT (LENGTHC(UNITS)),
       67     5998                3 TEXT CHAR (16) INIT (UNITS),
       68     5999              2 TITLE#,
       69     6000                3 LEN UBIN BYTE UNAL INIT (LENGTHC(TITLE)),
       70     6001                3 TEXT CHAR (0) INIT (TITLE);
       71     6002        %MEND;
       72     6003        %HISTOGRAM (NAME=RESPONSE,UNITS="'(milliseconds)'",CODE=P_RT#,
       73     6004                    TITLE="'interactive response time'");
       74     6014        %HISTOGRAM (NAME=USER_SIZE,UNITS="'(pages)'",CODE=P_USERSIZE#,
       75     6015                    TITLE="'user memory sizes'");
       76     6025        %HISTOGRAM (NAME=PMME_TIMES,UNITS="'(microseconds)'",CODE=P_PMME_TIME#,
       77     6026                    TITLE="'time required to complete user service requests'");
       78     6036        %HISTOGRAM (NAME=INTERACTION_TIME, UNITS="'(milliseconds)'", CODE=P_INTCOMP#,
       79     6037                    TITLE="'compute time between interactions'");
       80     6047        %EJECT;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:4    
       81     6048    1   GENERATE: PROC (TYPE, BUCKET, OLD_BUCKET);
       82     6049        %DUMMY_BUCKET (NAME=BUCKET);
       83     6055        %DUMMY_BUCKET (NAME=OLD_BUCKET);
       84     6061    2   DCL TYPE CHAR (6);
       85     6062
       86     6063    2   DCL I UBIN;
       87     6064    2   DCL J UBIN;
       88     6065    2   DCL SUM UBIN;
       89     6066    2   DCL NR_POS UBIN;
       90     6067    2   DCL SUM_POS UBIN;
       91     6068    2   DCL OLD_SUM_POS UBIN;
       92     6069    2   DCL FILL_SIZE SBIN;
       93     6070    2   DCL FILL_IN CHAR (FILL_SIZE) BASED;
       94     6071
       95     6072
       96     6073    2   GET_POS: PROC (N, NP);
       97     6074
       98     6075    3   DCL N UBIN;
       99     6076    3   DCL NP UBIN;
      100     6077
      101     6078    3      NP = (N + ((EVENT_COUNT - 1) / 80)) * 40 / EVENT_COUNT_SBIN ;
      102     6079
      103     6080    3      IF NP = 0
      104     6081    3       AND N > 0
      105     6082    3        THEN
      106     6083    3         NP = 1;
      107     6084
      108     6085    3      RETURN;
      109     6086
      110     6087    3   END GET_POS;
      111     6088
      112     6089    2      HEADER_TYPE = TYPE;
      113     6090    2      EVENT_COUNT = 0;
      114     6091    2      OLD_SUM_POS = 0;
      115     6092
      116     6093    3      DO I = 0 TO BUCKET.SIZE;
      117     6094
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:5    
      118     6095    3         EVENT_COUNT = EVENT_COUNT + BUCKET.DATA(BUCKET.SIZE + I + 1);
      119     6096
      120     6097    3         IF ADDR(OLD_BUCKET) ~= ADDR(NIL)
      121     6098    3           THEN
      122     6099    3            EVENT_COUNT = EVENT_COUNT - OLD_BUCKET.DATA(OLD_BUCKET.SIZE + I + 1);
      123     6100
      124     6101    3         END;
      125     6102
      126     6103    2      IF TYPE = ' '
      127     6104    2        THEN
      128     6105    2         CALL X$WRITE (PS_FDS, VECTOR(SIMPLE_FORMAT));
      129     6106
      130     6107    3        ELSE DO;
      131     6108
      132     6109    3         IF EVENT_COUNT = 0
      133     6110    4           THEN DO;
      134     6111
      135     6112    4            CALL X$WRITE (PS_FDS, VECTOR(HEADER_FORMAT.P1),
      136     6113    4             VECTOR(HEADER_TAB_1), VECTOR(HEADER_TYPE), TITLE_VECTOR);
      137     6114
      138     6115    4            CALL X$WRITE (PS_FDS, VECTOR(BLOTTO_FORMAT));
      139     6116
      140     6117    4            RETURN;
      141     6118
      142     6119    4            END;
      143     6120
      144     6121    3         CALL PSD$EJECT (BUCKET.SIZE + 8);
      145     6122
      146     6123    3         CALL X$WRITE (PS_FDS, VECTOR(HEADER_FORMAT),
      147     6124    3          VECTOR(HEADER_TAB_1), VECTOR(HEADER_TYPE), TITLE_VECTOR,
      148     6125    3          VECTOR(HEADER_TAB_2), UNITS_VECTOR);
      149     6126
      150     6127    3         END;
      151     6128
      152     6129    2      LOW = 0;
      153     6130    2      SUM = 0;
      154     6131
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:6    
      155     6132    3      DO I = 0 TO BUCKET.SIZE;
      156     6133
      157     6134    3         HIGH = BUCKET.DATA(I);
      158     6135
      159     6136    3         IF ADDR(OLD_BUCKET) = ADDR(NIL)
      160     6137    3           THEN
      161     6138    3            NR = BUCKET.DATA(BUCKET.SIZE + I + 1);
      162     6139    3           ELSE
      163     6140    3            NR = BUCKET.DATA(BUCKET.SIZE + I + 1) -
      164     6141    3             OLD_BUCKET.DATA(OLD_BUCKET.SIZE + I + 1);
      165     6142
      166     6143    3         SUM = SUM + NR;
      167     6144
      168     6145    3         CALL GET_POS (NR, NR_POS);
      169     6146    3         CALL GET_POS (SUM, SUM_POS);
      170     6147
      171     6148    3         BAR = ' ';
      172     6149
      173     6150    3         IF (SUM_POS > 0) AND (SUM_POS > NR_POS)
      174     6151    3           THEN
      175     6152    3            IF SUM_POS = OLD_SUM_POS
      176     6153    3              THEN
      177     6154    3               IBAR(SUM_POS - 1) = '!';
      178     6155    3              ELSE
      179     6156    3               IBAR(SUM_POS - 1) = '\';
      180     6157
      181     6158    3         FILL_SIZE = SUM_POS - OLD_SUM_POS - 1;
      182     6159
      183     6160    3         IF OLD_SUM_POS > 0
      184     6161    3          AND FILL_SIZE > 0
      185     6162    3           THEN
      186     6163    3            ADDR(IBAR(OLD_SUM_POS)) -> FILL_IN = SUBSTR(FILL, 0, FILL_SIZE);
      187     6164
      188     6165    3         FILL_SIZE = NR_POS;
      189     6166
      190     6167    3         IF FILL_SIZE > 0
      191     6168    3           THEN
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:7    
      192     6169    3            ADDR(BAR) -> FILL_IN = STARS;
      193     6170
      194     6171    3         NP = ( NR * 100 + EVENT_COUNT_SBIN / 2 ) / EVENT_COUNT_SBIN ;
      195     6172
      196     6173    3         IF I = BUCKET.SIZE
      197     6174    3           THEN
      198     6175    3            CALL X$WRITE (PS_FDS, VECTOR(LAST_FORMAT),
      199     6176    3             VECTOR(LOW), VECTOR(BAR), VECTOR(NR), VECTOR(NP));
      200     6177    3           ELSE
      201     6178    3            CALL X$WRITE (PS_FDS, VECTOR(LINE_FORMAT),
      202     6179    3             VECTOR(LOW), VECTOR(HIGH), VECTOR(BAR), VECTOR(NR), VECTOR(NP));
      203     6180
      204     6181    3         LOW = HIGH + 1;
      205     6182    3         OLD_SUM_POS = SUM_POS;
      206     6183
      207     6184    3         END;
      208     6185
      209     6186    2      I = EVENT_COUNT;
      210     6187    2      J = 0;
      211     6188
      212     6189    3      DO WHILE (I >= 10 AND J < 7);
      213     6190
      214     6191    3         I = I / 10;
      215     6192    3         J = J + 1;
      216     6193
      217     6194    3         END;
      218     6195
      219     6196    2      UNDERLINER = SUBSTR(UNDERLINE_STUFF, J, 10);
      220     6197
      221     6198    2      CALL X$WRITE (PS_FDS, VECTOR(TRAILER_FORMAT),
      222     6199    2       VECTOR(UNDERLINER), VECTOR(EVENT_COUNT));
      223     6200
      224     6201    2      DID_ONE = %YES#;
      225     6202
      226     6203    2      RETURN;
      227     6204
      228     6205    2   END GENERATE;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:8    
      229     6206        %EJECT;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:9    
      230     6207    1   PRODUCE: PROC (FLAGS, HISTOGRAM);
      231     6208
      232     6209    2   DCL 1 FLAGS UNAL,
      233     6210    2         2 SNAP LOGICAL,
      234     6211    2         2 ALL LOGICAL;
      235     6212
      236     6213    2   DCL 1 HISTOGRAM,
      237     6214    2         2 CODE UBIN WORD,
      238     6215    2         2 UNITS,
      239     6216    2           3 LEN UBIN BYTE UNAL,
      240     6217    2           3 TEXT CHAR(16),
      241     6218    2         2 TITLE,
      242     6219    2           3 LEN UBIN BYTE UNAL,
      243     6220    2           3 TEXT CHAR (HISTOGRAM.TITLE.LEN);
      244     6221
      245     6222    2      IF NOT FLAGS
      246     6223    2        THEN
      247     6224    2         RETURN;
      248     6225
      249     6226    2      CALL PSL$LOCATE (HISTOGRAM.CODE, BUCKET$, OLD_BUCKET$);
      250     6227
      251     6228    2      BUCKET$ = ADDR(BUCKET$ -> BLOCK.DATA);
      252     6229
      253     6230    2      IF OLD_BUCKET$ ~= ADDR(NIL)
      254     6231    2        THEN
      255     6232    2         OLD_BUCKET$ = ADDR(OLD_BUCKET$ -> BLOCK.DATA);
      256     6233
      257     6234    2      TITLE_VECTOR = VECTOR(HISTOGRAM.TITLE.TEXT);
      258     6235    2      UNITS_VECTOR = VECTOR(ADDR(HISTOGRAM.UNITS)->TEXTC.TEXT);
      259     6236
      260     6237    2      HEADER_TAB_1 = (57 - HISTOGRAM.TITLE.LEN) / 2;
      261     6238    2      HEADER_TAB_2 = (18 - HISTOGRAM.UNITS.LEN) / 2;
      262     6239
      263     6240    2      IF OLD_BUCKET$ ~= ADDR(NIL) AND FLAGS.SNAP
      264     6241    2        THEN
      265     6242    2         CALL GENERATE ('"Snap"', BUCKET$->BUCKET, OLD_BUCKET$->BUCKET);
      266     6243
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:10   
      267     6244    2      IF (OLD_BUCKET$ = ADDR(NIL) AND FLAGS.SNAP) OR FLAGS.ALL
      268     6245    2        THEN
      269     6246    2         CALL GENERATE (' "All"', BUCKET$->BUCKET);
      270     6247
      271     6248    2      RETURN;
      272     6249
      273     6250    2   END PRODUCE;
      274     6251        %EJECT;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:11   
      275     6252    1      DID_ONE = %NO#;
      276     6253
      277     6254    1      CALL PRODUCE(PS_HISTOGRAM_FLAGS.RESPONSE, RESPONSE);
      278     6255    1      CALL PRODUCE(PS_HISTOGRAM_FLAGS.USER_SIZE, USER_SIZE);
      279     6256    1      CALL PRODUCE(PS_HISTOGRAM_FLAGS.PMME_TIMES, PMME_TIMES);
      280     6257    1      CALL PRODUCE(PS_HISTOGRAM_FLAGS.INTERACTION_TIME, INTERACTION_TIME);
      281     6258
      282     6259    1      IF DID_ONE
      283     6260    1        THEN
      284     6261    1         CALL PSD$EJECT;
      285     6262
      286     6263    1      RETURN;
      287     6264
      288     6265    1   PSD$HIST_BUCKET: ENTRY (SPECIFIC_BUCKET);
      289     6266
      290     6267    1      CALL GENERATE ('      ', SPECIFIC_BUCKET);
      291     6268
      292     6269    1      RETURN;
      293     6270
      294     6271    1   END PSD$HISTO;

PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:12   
--  Include file information  --

   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   PM_BUCKET_C.:E05TOU  is referenced.
   PS_SUBS_C.:E05TOU  is referenced.
   PS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PSD$HISTO.

   Procedure PSD$HISTO requires 372 words for executable code.
   Procedure PSD$HISTO requires 32 words of local(AUTO) storage.

    No errors detected in file PSD$HISTO.:E05TSI    .

PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:13   

 Object Unit name= PSD$HISTO                                  File name= PSD$HISTO.:E05TOU
 UTS= JUL 30 '97 04:30:16.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   DCB   even  none     0      0  M$DO
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  F$LOG
    5   DCB   even  none     0      0  M$ME
    6   DCB   even  none     0      0  M$HLPCG
    7  RtLbCm even  none    30     36  PS_FDS
    8  RtLbCm even  none    32     40  PS_SELECT_RPN
    9  RtLbCm even  none    17     21  PS_STATS_RPN
   10  RtLbCm even  none    34     42  PS_STATS_BUCKET
   11  RoData even  UTS    167    247  PSD$HISTO
   12   Data  even  none    26     32  PSD$HISTO
   13   Proc  even  none   372    564  PSD$HISTO
   14  RoData even  none    85    125  PSD$HISTO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        1  PSD$HISTO
    13    552                  yes      Std        1  PSD$HIST_BUCKET
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:14   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 PSD$EJECT
         yes           Std      22 X$WRITE
         yes           Std       3 PSL$LOCATE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$LO                                  M$DO
     M$SI                                  F$LOG                                 M$ME
     M$HLPCG                               PS_HISTOGRAM_FLAGS                    PS_BUFFER
     PS_STATS$                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:15   


        1        1        /*M*  PSD$HISTO   Produce STATS histograms                                    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CLM=77,CRM=80,CRT=1,PLM=3,CTI=1,THI=2                                    */
        8        8        PSD$HISTO: PROC (SPECIFIC_BUCKET);

      8 13 000000   000000 700200 xent  PSD$HISTO    TSX0  ! X66_AUTO_1
        13 000001   000040 000001                    ZERO    32,1
        13 000002   000513 710000 13                 TRA     s:6252

        9        9        %INCLUDE CP_6;
       10       90        %INCLUDE PS_DATA_R;
       11     5386        %INCLUDE CP_6_SUBS;
       12     5926
       13     5927        %DUMMY_BUCKET (NAME=SPECIFIC_BUCKET, STCLASS=" ");
       14     5933        %DUMMY_BUCKET (NAME=BUCKET, STCLASS=BASED);
       15     5939    1   DCL LINE_FORMAT CHAR(0) CONSTANT INIT ('%6D to %D%18-|%40A| %8D (%3D %%)');
       16     5940
       17     5941    1   DCL LAST_FORMAT CHAR(0) CONSTANT INIT ('%6D and above%18-|%40A| %8D (%3D %%)');
       18     5942
       19     5943    1   DCL 1 HEADER_FORMAT CONSTANT,
       20     5944    1         2 P1 CHAR(0) INIT ('%2/%N-%A histogram of %A%2/'),
       21     5945    1         2 P2 CHAR(0) INIT ('%N-%A%18-/---|---|---|---|---|---|---|---|---|---|\');
       22     5946
       23     5947    1   DCL SIMPLE_FORMAT CHAR (0) CONSTANT
       24     5948    1      INIT ('%2/%18-/---|---|---|---|---|---|---|---|---|---|\');
       25     5949
       26     5950    1   DCL 1 TRAILER_FORMAT CONSTANT,
       27     5951    1         2 P1 CHAR(0) INIT ('%18-\---|---|---|---|---|---|---|---|---|---|/'),
       28     5952    1         2 P2 CHAR (0) INIT ('%10A%/%61-%8D%2/');
       29     5953
       30     5954    1   DCL BLOTTO_FORMAT CHAR(0) CONSTANT INIT
       31     5955    1         ('%12-No events occurred in this interval - histogram skipped.%/');
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:16   
       32     5956
       33     5957    1   DCL TITLE_VECTOR BIT(72) DALIGNED STATIC;
       34     5958    1   DCL UNITS_VECTOR BIT(72) DALIGNED STATIC;
       35     5959    1   DCL LOW UBIN WORD STATIC;
       36     5960    1   DCL HIGH UBIN WORD STATIC;
       37     5961    1   DCL NR UBIN WORD STATIC;
       38     5962    1   DCL NP UBIN WORD STATIC;
       39     5963    1   DCL DID_ONE LOGICAL;
       40     5964    1   DCL EVENT_COUNT UBIN WORD STATIC;
       41     5965    1   DCL EVENT_COUNT_SBIN REDEF EVENT_COUNT SBIN WORD ;
       42     5966    1   DCL HEADER_TAB_1 UBIN WORD STATIC;
       43     5967    1   DCL HEADER_TAB_2 UBIN WORD STATIC;
       44     5968    1   DCL HEADER_TYPE CHAR (6) STATIC;
       45     5969    1   DCL BAR CHAR (40) STATIC;
       46     5970    1   DCL IBAR (0:39) REDEF BAR CHAR (1);
       47     5971    1   DCL XSTAR (0:39) CHAR (1) CONSTANT INIT ('*'*0);
       48     5972    1   DCL STARS REDEF XSTAR CHAR (40);
       49     5973    1   DCL UNDERLINER CHAR(10) STATIC;
       50     5974    1   DCL UNDERLINE_STUFF CHAR(17) CONSTANT INIT ('       ----------');
       51     5975    1   DCL XFILL (0:39) CHAR (1) CONSTANT INIT ('`', '-'*39);
       52     5976    1   DCL FILL REDEF XFILL CHAR (40);
       53     5977    1   DCL BUCKET$ PTR;
       54     5978    1   DCL OLD_BUCKET$ PTR;
       55     5979
       56     5980        %EJECT;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:17   
       57     5981    1   DCL PSL$LOCATE ENTRY (3);
       58     5982        %INCLUDE XUF_ENTRY;
       59     5990    1   DCL PSD$SKIP ENTRY;
       60     5991    1   DCL PSD$EJECT ENTRY (1);
       61     5992
       62     5993        %MACRO HISTOGRAM (NAME=*, CODE=0, TITLE="' '", UNITS="' '");
       63     5994        DCL 1 NAME CONSTANT,
       64     5995              2 CODE# UBIN WORD INIT (CODE),
       65     5996              2 UNITS#,
       66     5997                3 LEN UBIN BYTE UNAL INIT (LENGTHC(UNITS)),
       67     5998                3 TEXT CHAR (16) INIT (UNITS),
       68     5999              2 TITLE#,
       69     6000                3 LEN UBIN BYTE UNAL INIT (LENGTHC(TITLE)),
       70     6001                3 TEXT CHAR (0) INIT (TITLE);
       71     6002        %MEND;
       72     6003        %HISTOGRAM (NAME=RESPONSE,UNITS="'(milliseconds)'",CODE=P_RT#,
       73     6004                    TITLE="'interactive response time'");
       74     6014        %HISTOGRAM (NAME=USER_SIZE,UNITS="'(pages)'",CODE=P_USERSIZE#,
       75     6015                    TITLE="'user memory sizes'");
       76     6025        %HISTOGRAM (NAME=PMME_TIMES,UNITS="'(microseconds)'",CODE=P_PMME_TIME#,
       77     6026                    TITLE="'time required to complete user service requests'");
       78     6036        %HISTOGRAM (NAME=INTERACTION_TIME, UNITS="'(milliseconds)'", CODE=P_INTCOMP#,
       79     6037                    TITLE="'compute time between interactions'");
       80     6047        %EJECT;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:18   
       81     6048    1   GENERATE: PROC (TYPE, BUCKET, OLD_BUCKET);

   6048 13 000003   200014 741300       GENERATE     STX1  ! @HISTOGRAM+2,,AUTO
        13 000004   000041 710000 13                 TRA     s:6089

       82     6049        %DUMMY_BUCKET (NAME=BUCKET);
       83     6055        %DUMMY_BUCKET (NAME=OLD_BUCKET);
       84     6061    2   DCL TYPE CHAR (6);
       85     6062
       86     6063    2   DCL I UBIN;
       87     6064    2   DCL J UBIN;
       88     6065    2   DCL SUM UBIN;
       89     6066    2   DCL NR_POS UBIN;
       90     6067    2   DCL SUM_POS UBIN;
       91     6068    2   DCL OLD_SUM_POS UBIN;
       92     6069    2   DCL FILL_SIZE SBIN;
       93     6070    2   DCL FILL_IN CHAR (FILL_SIZE) BASED;
       94     6071
       95     6072
       96     6073    2   GET_POS: PROC (N, NP);

   6073 13 000005   200030 741300       GET_POS      STX1  ! FILL_SIZE+2,,AUTO

       97     6074
       98     6075    3   DCL N UBIN;
       99     6076    3   DCL NP UBIN;
      100     6077
      101     6078    3      NP = (N + ((EVENT_COUNT - 1) / 80)) * 40 / EVENT_COUNT_SBIN ;

   6078 13 000006   000010 236000 12                 LDQ     EVENT_COUNT
        13 000007   000001 136007                    SBLQ    1,DL
        13 000010   000120 506007                    DIV     80,DL
        13 000011   200031 470500                    LDP0    @N,,AUTO
        13 000012   000000 036100                    ADLQ    0,,PR0
        13 000013   000050 402007                    MPY     40,DL
        13 000014   000000 116003                    CMPQ    0,DU
        13 000015   000026 605000 13                 TPL     s:6078+16
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:19   
        13 000016   000010 235000 12                 LDA     EVENT_COUNT
        13 000017   000001 405007                    CMG     1,DL
        13 000020   000027 600000 13                 TZE     s:6078+17
        13 000021   000000 235003                    LDA     0,DU
        13 000022   000001 737000                    LLS     1
        13 000023   000010 507000 12                 DVF     EVENT_COUNT
        13 000024   000044 733000                    LRS     36
        13 000025   000027 710000 13                 TRA     s:6078+17
        13 000026   000010 506000 12                 DIV     EVENT_COUNT
        13 000027   200032 471500                    LDP1    @NP,,AUTO
        13 000030   100000 756100                    STQ     0,,PR1

      102     6079
      103     6080    3      IF NP = 0

   6080 13 000031   000000 116003                    CMPQ    0,DU
        13 000032   000037 601000 13                 TNZ     s:6085
        13 000033   000000 235100                    LDA     0,,PR0
        13 000034   000037 600000 13                 TZE     s:6085

      104     6081    3       AND N > 0
      105     6082    3        THEN
      106     6083    3         NP = 1;

   6083 13 000035   000001 235007                    LDA     1,DL
        13 000036   100000 755100                    STA     0,,PR1

      107     6084
      108     6085    3      RETURN;

   6085 13 000037   200030 221300                    LDX1  ! FILL_SIZE+2,,AUTO
        13 000040   000001 702211                    TSX2  ! 1,X1

      109     6086
      110     6087    3   END GET_POS;
      111     6088
      112     6089    2      HEADER_TYPE = TYPE;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:20   

   6089 13 000041   200015 470500                    LDP0    @TYPE,,AUTO
        13 000042   040000 100500                    MLR     fill='040'O
        13 000043   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
        13 000044   000013 000006 12                 ADSC9   HEADER_TYPE              cn=0,n=6

      113     6090    2      EVENT_COUNT = 0;

   6090 13 000045   000010 450000 12                 STZ     EVENT_COUNT

      114     6091    2      OLD_SUM_POS = 0;

   6091 13 000046   200025 450100                    STZ     OLD_SUM_POS,,AUTO

      115     6092
      116     6093    3      DO I = 0 TO BUCKET.SIZE;

   6093 13 000047   200020 450100                    STZ     I,,AUTO
        13 000050   000075 710000 13                 TRA     s:6101+3

      117     6094
      118     6095    3         EVENT_COUNT = EVENT_COUNT + BUCKET.DATA(BUCKET.SIZE + I + 1);

   6095 13 000051   200016 470500                    LDP0    @BUCKET,,AUTO
        13 000052   000000 236100                    LDQ     0,,PR0
        13 000053   200020 036100                    ADLQ    I,,AUTO
        13 000054   000000 620006                    EAX0    0,QL
        13 000055   000010 236000 12                 LDQ     EVENT_COUNT
        13 000056   000003 036110                    ADLQ    3,X0,PR0
        13 000057   000010 756000 12                 STQ     EVENT_COUNT

      119     6096
      120     6097    3         IF ADDR(OLD_BUCKET) ~= ADDR(NIL)

   6097 13 000060   200017 236100                    LDQ     @OLD_BUCKET,,AUTO
        13 000061   000001 116000 xsym               CMPQ    B_VECTNIL+1
        13 000062   000072 600000 13                 TZE     s:6101
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:21   

      121     6098    3           THEN
      122     6099    3            EVENT_COUNT = EVENT_COUNT - OLD_BUCKET.DATA(OLD_BUCKET.SIZE + I + 1);

   6099 13 000063   200017 471500                    LDP1    @OLD_BUCKET,,AUTO
        13 000064   100000 236100                    LDQ     0,,PR1
        13 000065   200020 036100                    ADLQ    I,,AUTO
        13 000066   000000 620006                    EAX0    0,QL
        13 000067   000010 236000 12                 LDQ     EVENT_COUNT
        13 000070   100003 136110                    SBLQ    3,X0,PR1
        13 000071   000010 756000 12                 STQ     EVENT_COUNT

      123     6100
      124     6101    3         END;

   6101 13 000072   200020 235100                    LDA     I,,AUTO
        13 000073   000001 035007                    ADLA    1,DL
        13 000074   200020 755100                    STA     I,,AUTO
        13 000075   200016 470500                    LDP0    @BUCKET,,AUTO
        13 000076   000000 236100                    LDQ     0,,PR0
        13 000077   200020 116100                    CMPQ    I,,AUTO
        13 000100   000051 603000 13                 TRC     s:6095

      125     6102
      126     6103    2      IF TYPE = ' '

   6103 13 000101   200015 471500                    LDP1    @TYPE,,AUTO
        13 000102   040000 106500                    CMPC    fill='040'O
        13 000103   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
        13 000104   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        13 000105   000113 601000 13                 TNZ     s:6109

      127     6104    2        THEN
      128     6105    2         CALL X$WRITE (PS_FDS, VECTOR(SIMPLE_FORMAT));

   6105 13 000106   000002 630400 14                 EPPR0   2
        13 000107   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:22   
        13 000110   000000 701000 xent               TSX1    X$WRITE
        13 000111   000000 011000                    NOP     0
        13 000112   000143 710000 13                 TRA     s:6129

      129     6106
      130     6107    3        ELSE DO;

      131     6108
      132     6109    3         IF EVENT_COUNT = 0

   6109 13 000113   000010 235000 12                 LDA     EVENT_COUNT
        13 000114   000127 601000 13                 TNZ     s:6121

      133     6110    4           THEN DO;

      134     6111
      135     6112    4            CALL X$WRITE (PS_FDS, VECTOR(HEADER_FORMAT.P1),

   6112 13 000115   000012 630400 14                 EPPR0   10
        13 000116   000023 631400 xsym               EPPR1   B_VECTNIL+19
        13 000117   000000 701000 xent               TSX1    X$WRITE
        13 000120   000000 011000                    NOP     0

      136     6113    4             VECTOR(HEADER_TAB_1), VECTOR(HEADER_TYPE), TITLE_VECTOR);
      137     6114
      138     6115    4            CALL X$WRITE (PS_FDS, VECTOR(BLOTTO_FORMAT));

   6115 13 000121   000022 630400 14                 EPPR0   18
        13 000122   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 000123   000000 701000 xent               TSX1    X$WRITE
        13 000124   000000 011000                    NOP     0

      139     6116
      140     6117    4            RETURN;

   6117 13 000125   200014 221300                    LDX1  ! @HISTOGRAM+2,,AUTO
        13 000126   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:23   

      141     6118
      142     6119    4            END;
      143     6120
      144     6121    3         CALL PSD$EJECT (BUCKET.SIZE + 8);

   6121 13 000127   000010 036007                    ADLQ    8,DL
        13 000130   200034 756100                    STQ     @NP+2,,AUTO
        13 000131   200034 633500                    EPPR3   @NP+2,,AUTO
        13 000132   200035 453500                    STP3    @NP+3,,AUTO
        13 000133   200035 630500                    EPPR0   @NP+3,,AUTO
        13 000134   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 000135   000000 701000 xent               TSX1    PSD$EJECT
        13 000136   000000 011000                    NOP     0

      145     6122
      146     6123    3         CALL X$WRITE (PS_FDS, VECTOR(HEADER_FORMAT),

   6123 13 000137   000030 630400 14                 EPPR0   24
        13 000140   000025 631400 xsym               EPPR1   B_VECTNIL+21
        13 000141   000000 701000 xent               TSX1    X$WRITE
        13 000142   000000 011000                    NOP     0

      147     6124    3          VECTOR(HEADER_TAB_1), VECTOR(HEADER_TYPE), TITLE_VECTOR,
      148     6125    3          VECTOR(HEADER_TAB_2), UNITS_VECTOR);
      149     6126
      150     6127    3         END;

      151     6128
      152     6129    2      LOW = 0;

   6129 13 000143   000004 450000 12                 STZ     LOW

      153     6130    2      SUM = 0;

   6130 13 000144   200022 450100                    STZ     SUM,,AUTO

PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:24   
      154     6131
      155     6132    3      DO I = 0 TO BUCKET.SIZE;

   6132 13 000145   200020 450100                    STZ     I,,AUTO
        13 000146   000320 710000 13                 TRA     s:6184+3

      156     6133
      157     6134    3         HIGH = BUCKET.DATA(I);

   6134 13 000147   200016 470500                    LDP0    @BUCKET,,AUTO
        13 000150   200020 720100                    LXL0    I,,AUTO
        13 000151   000002 235110                    LDA     2,X0,PR0
        13 000152   000005 755000 12                 STA     HIGH

      158     6135
      159     6136    3         IF ADDR(OLD_BUCKET) = ADDR(NIL)

   6136 13 000153   200017 236100                    LDQ     @OLD_BUCKET,,AUTO
        13 000154   000001 116000 xsym               CMPQ    B_VECTNIL+1
        13 000155   000163 601000 13                 TNZ     s:6140

      160     6137    3           THEN
      161     6138    3            NR = BUCKET.DATA(BUCKET.SIZE + I + 1);

   6138 13 000156   000000 236100                    LDQ     0,,PR0
        13 000157   200020 036100                    ADLQ    I,,AUTO
        13 000160   000003 235106                    LDA     3,QL,PR0
        13 000161   000006 755000 12                 STA     NR
        13 000162   000176 710000 13                 TRA     s:6143

      162     6139    3           ELSE
      163     6140    3            NR = BUCKET.DATA(BUCKET.SIZE + I + 1) -

   6140 13 000163   000000 236100                    LDQ     0,,PR0
        13 000164   200020 036100                    ADLQ    I,,AUTO
        13 000165   200017 471500                    LDP1    @OLD_BUCKET,,AUTO
        13 000166   200034 756100                    STQ     @NP+2,,AUTO
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:25   
        13 000167   100000 236100                    LDQ     0,,PR1
        13 000170   200020 036100                    ADLQ    I,,AUTO
        13 000171   000000 621006                    EAX1    0,QL
        13 000172   200034 722100                    LXL2    @NP+2,,AUTO
        13 000173   000003 236112                    LDQ     3,X2,PR0
        13 000174   100003 136111                    SBLQ    3,X1,PR1
        13 000175   000006 756000 12                 STQ     NR

      164     6141    3             OLD_BUCKET.DATA(OLD_BUCKET.SIZE + I + 1);
      165     6142
      166     6143    3         SUM = SUM + NR;

   6143 13 000176   200022 236100                    LDQ     SUM,,AUTO
        13 000177   000006 036000 12                 ADLQ    NR
        13 000200   200022 756100                    STQ     SUM,,AUTO

      167     6144
      168     6145    3         CALL GET_POS (NR, NR_POS);

   6145 13 000201   200023 631500                    EPPR1   NR_POS,,AUTO
        13 000202   200032 451500                    STP1    @N+1,,AUTO
        13 000203   000037 236000 14                 LDQ     31
        13 000204   200031 756100                    STQ     FILL_SIZE+3,,AUTO
        13 000205   000005 701000 13                 TSX1    GET_POS
        13 000206   000000 011000                    NOP     0

      169     6146    3         CALL GET_POS (SUM, SUM_POS);

   6146 13 000207   200024 630500                    EPPR0   SUM_POS,,AUTO
        13 000210   200032 450500                    STP0    @N+1,,AUTO
        13 000211   200022 631500                    EPPR1   SUM,,AUTO
        13 000212   200031 451500                    STP1    FILL_SIZE+3,,AUTO
        13 000213   000005 701000 13                 TSX1    GET_POS
        13 000214   000000 011000                    NOP     0

      170     6147
      171     6148    3         BAR = ' ';
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:26   

   6148 13 000215   040000 100400                    MLR     fill='040'O
        13 000216   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        13 000217   000015 000050 12                 ADSC9   BAR                      cn=0,n=40

      172     6149
      173     6150    3         IF (SUM_POS > 0) AND (SUM_POS > NR_POS)

   6150 13 000220   200024 235100                    LDA     SUM_POS,,AUTO
        13 000221   000237 600000 13                 TZE     s:6158
        13 000222   200023 236100                    LDQ     NR_POS,,AUTO
        13 000223   200024 116100                    CMPQ    SUM_POS,,AUTO
        13 000224   000237 603000 13                 TRC     s:6158

      174     6151    3           THEN
      175     6152    3            IF SUM_POS = OLD_SUM_POS

   6152 13 000225   200024 236100                    LDQ     SUM_POS,,AUTO
        13 000226   200025 116100                    CMPQ    OLD_SUM_POS,,AUTO
        13 000227   000234 601000 13                 TNZ     s:6156

      176     6153    3              THEN
      177     6154    3               IBAR(SUM_POS - 1) = '!';

   6154 13 000230   040006 100400                    MLR     fill='040'O
        13 000231   000040 000001 14                 ADSC9   32                       cn=0,n=1
        13 000232   000014 600001 12                 ADSC9   HEADER_TYPE+1,Q          cn=3,n=1
        13 000233   000237 710000 13                 TRA     s:6158

      178     6155    3              ELSE
      179     6156    3               IBAR(SUM_POS - 1) = '\';

   6156 13 000234   040006 100400                    MLR     fill='040'O
        13 000235   000041 000001 14                 ADSC9   33                       cn=0,n=1
        13 000236   000014 600001 12                 ADSC9   HEADER_TYPE+1,Q          cn=3,n=1

      180     6157
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:27   
      181     6158    3         FILL_SIZE = SUM_POS - OLD_SUM_POS - 1;

   6158 13 000237   200024 236100                    LDQ     SUM_POS,,AUTO
        13 000240   200025 136100                    SBLQ    OLD_SUM_POS,,AUTO
        13 000241   000001 136007                    SBLQ    1,DL
        13 000242   200026 756100                    STQ     FILL_SIZE,,AUTO

      182     6159
      183     6160    3         IF OLD_SUM_POS > 0

   6160 13 000243   200025 235100                    LDA     OLD_SUM_POS,,AUTO
        13 000244   000254 600000 13                 TZE     s:6165
        13 000245   000000 116003                    CMPQ    0,DU
        13 000246   000254 604400 13                 TMOZ    s:6165

      184     6161    3          AND FILL_SIZE > 0
      185     6162    3           THEN
      186     6163    3            ADDR(IBAR(OLD_SUM_POS)) -> FILL_IN = SUBSTR(FILL, 0, FILL_SIZE);

   6163 13 000247   000000 620006                    EAX0    0,QL
        13 000250   200026 721100                    LXL1    FILL_SIZE,,AUTO
        13 000251   040045 100440                    MLR     fill='040'O
        13 000252   000141 000010 11                 ADSC9   XFILL                    cn=0,n=*X0
        13 000253   000015 000011 12                 ADSC9   BAR,A                    cn=0,n=*X1

      187     6164
      188     6165    3         FILL_SIZE = NR_POS;

   6165 13 000254   200023 236100                    LDQ     NR_POS,,AUTO
        13 000255   200026 756100                    STQ     FILL_SIZE,,AUTO

      189     6166
      190     6167    3         IF FILL_SIZE > 0

   6167 13 000256   000263 604400 13                 TMOZ    s:6171

      191     6168    3           THEN
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:28   
      192     6169    3            ADDR(BAR) -> FILL_IN = STARS;

   6169 13 000257   000000 620006                    EAX0    0,QL
        13 000260   040040 100400                    MLR     fill='040'O
        13 000261   000122 000050 11                 ADSC9   XSTAR                    cn=0,n=40
        13 000262   000015 000010 12                 ADSC9   BAR                      cn=0,n=*X0

      193     6170
      194     6171    3         NP = ( NR * 100 + EVENT_COUNT_SBIN / 2 ) / EVENT_COUNT_SBIN ;

   6171 13 000263   000010 236000 12                 LDQ     EVENT_COUNT
        13 000264   000002 506007                    DIV     2,DL
        13 000265   200034 756100                    STQ     @NP+2,,AUTO
        13 000266   000006 236000 12                 LDQ     NR
        13 000267   000144 402007                    MPY     100,DL
        13 000270   200034 036100                    ADLQ    @NP+2,,AUTO
        13 000271   000010 506000 12                 DIV     EVENT_COUNT
        13 000272   000007 756000 12                 STQ     NP

      195     6172
      196     6173    3         IF I = BUCKET.SIZE

   6173 13 000273   200016 470500                    LDP0    @BUCKET,,AUTO
        13 000274   200020 236100                    LDQ     I,,AUTO
        13 000275   000000 116100                    CMPQ    0,,PR0
        13 000276   000304 601000 13                 TNZ     s:6178

      197     6174    3           THEN
      198     6175    3            CALL X$WRITE (PS_FDS, VECTOR(LAST_FORMAT),

   6175 13 000277   000054 630400 14                 EPPR0   44
        13 000300   000024 631400 xsym               EPPR1   B_VECTNIL+20
        13 000301   000000 701000 xent               TSX1    X$WRITE
        13 000302   000000 011000                    NOP     0
        13 000303   000310 710000 13                 TRA     s:6181

      199     6176    3             VECTOR(LOW), VECTOR(BAR), VECTOR(NR), VECTOR(NP));
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:29   
      200     6177    3           ELSE
      201     6178    3            CALL X$WRITE (PS_FDS, VECTOR(LINE_FORMAT),

   6178 13 000304   000066 630400 14                 EPPR0   54
        13 000305   000025 631400 xsym               EPPR1   B_VECTNIL+21
        13 000306   000000 701000 xent               TSX1    X$WRITE
        13 000307   000000 011000                    NOP     0

      202     6179    3             VECTOR(LOW), VECTOR(HIGH), VECTOR(BAR), VECTOR(NR), VECTOR(NP));
      203     6180
      204     6181    3         LOW = HIGH + 1;

   6181 13 000310   000005 235000 12                 LDA     HIGH
        13 000311   000001 035007                    ADLA    1,DL
        13 000312   000004 755000 12                 STA     LOW

      205     6182    3         OLD_SUM_POS = SUM_POS;

   6182 13 000313   200024 236100                    LDQ     SUM_POS,,AUTO
        13 000314   200025 756100                    STQ     OLD_SUM_POS,,AUTO

      206     6183
      207     6184    3         END;

   6184 13 000315   200020 235100                    LDA     I,,AUTO
        13 000316   000001 035007                    ADLA    1,DL
        13 000317   200020 755100                    STA     I,,AUTO
        13 000320   200016 470500                    LDP0    @BUCKET,,AUTO
        13 000321   000000 236100                    LDQ     0,,PR0
        13 000322   200020 116100                    CMPQ    I,,AUTO
        13 000323   000147 603000 13                 TRC     s:6134

      208     6185
      209     6186    2      I = EVENT_COUNT;

   6186 13 000324   000010 235000 12                 LDA     EVENT_COUNT
        13 000325   200020 755100                    STA     I,,AUTO
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:30   

      210     6187    2      J = 0;

   6187 13 000326   200021 450100                    STZ     J,,AUTO

      211     6188
      212     6189    3      DO WHILE (I >= 10 AND J < 7);

   6189 13 000327   000337 710000 13                 TRA     s:6194

      213     6190
      214     6191    3         I = I / 10;

   6191 13 000330   200020 236100                    LDQ     I,,AUTO
        13 000331   000001 772000                    QRL     1
        13 000332   000005 506007                    DIV     5,DL
        13 000333   200020 756100                    STQ     I,,AUTO

      215     6192    3         J = J + 1;

   6192 13 000334   200021 235100                    LDA     J,,AUTO
        13 000335   000001 035007                    ADLA    1,DL
        13 000336   200021 755100                    STA     J,,AUTO

      216     6193
      217     6194    3         END;

   6194 13 000337   200020 235100                    LDA     I,,AUTO
        13 000340   000012 115007                    CMPA    10,DL
        13 000341   000345 602000 13                 TNC     s:6196
        13 000342   200021 236100                    LDQ     J,,AUTO
        13 000343   000007 116007                    CMPQ    7,DL
        13 000344   000330 602000 13                 TNC     s:6191

      218     6195
      219     6196    2      UNDERLINER = SUBSTR(UNDERLINE_STUFF, J, 10);

PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:31   
   6196 13 000345   200021 236100                    LDQ     J,,AUTO
        13 000346   040000 100406                    MLR     fill='040'O
        13 000347   000134 000012 11                 ADSC9   UNDERLINE_STUFF,Q        cn=0,n=10
        13 000350   000027 000012 12                 ADSC9   UNDERLINER               cn=0,n=10

      220     6197
      221     6198    2      CALL X$WRITE (PS_FDS, VECTOR(TRAILER_FORMAT),

   6198 13 000351   000104 630400 14                 EPPR0   68
        13 000352   000022 631400 xsym               EPPR1   B_VECTNIL+18
        13 000353   000000 701000 xent               TSX1    X$WRITE
        13 000354   000000 011000                    NOP     0

      222     6199    2       VECTOR(UNDERLINER), VECTOR(EVENT_COUNT));
      223     6200
      224     6201    2      DID_ONE = %YES#;

   6201 13 000355   400000 236003                    LDQ     -131072,DU
        13 000356   200005 756100                    STQ     DID_ONE,,AUTO

      225     6202
      226     6203    2      RETURN;

   6203 13 000357   200014 221300                    LDX1  ! @HISTOGRAM+2,,AUTO
        13 000360   000001 702211                    TSX2  ! 1,X1

      227     6204
      228     6205    2   END GENERATE;
      229     6206        %EJECT;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:32   
      230     6207    1   PRODUCE: PROC (FLAGS, HISTOGRAM);

   6207 13 000361   200010 741300       PRODUCE      STX1  ! OLD_BUCKET$+1,,AUTO

      231     6208
      232     6209    2   DCL 1 FLAGS UNAL,
      233     6210    2         2 SNAP LOGICAL,
      234     6211    2         2 ALL LOGICAL;
      235     6212
      236     6213    2   DCL 1 HISTOGRAM,
      237     6214    2         2 CODE UBIN WORD,
      238     6215    2         2 UNITS,
      239     6216    2           3 LEN UBIN BYTE UNAL,
      240     6217    2           3 TEXT CHAR(16),
      241     6218    2         2 TITLE,
      242     6219    2           3 LEN UBIN BYTE UNAL,
      243     6220    2           3 TEXT CHAR (HISTOGRAM.TITLE.LEN);
      244     6221
      245     6222    2      IF NOT FLAGS

   6222 13 000362   200011 470500                    LDP0    @FLAGS,,AUTO
        13 000363   000000 066500                    CMPB    filb='0'B
        13 000364   000000 000002                    BDSC    0,,PR0                   by=0,bit=0,n=2
        13 000365   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        13 000366   000370 601000 13                 TNZ     s:6226

      246     6223    2        THEN
      247     6224    2         RETURN;

   6224 13 000367   000001 702211                    TSX2  ! 1,X1

      248     6225
      249     6226    2      CALL PSL$LOCATE (HISTOGRAM.CODE, BUCKET$, OLD_BUCKET$);

   6226 13 000370   200007 631500                    EPPR1   OLD_BUCKET$,,AUTO
        13 000371   200036 451500                    STP1    @NP+4,,AUTO
        13 000372   200006 633500                    EPPR3   BUCKET$,,AUTO
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:33   
        13 000373   200035 453500                    STP3    @NP+3,,AUTO
        13 000374   200012 236100                    LDQ     @HISTOGRAM,,AUTO
        13 000375   200034 756100                    STQ     @NP+2,,AUTO
        13 000376   200034 630500                    EPPR0   @NP+2,,AUTO
        13 000377   000021 631400 xsym               EPPR1   B_VECTNIL+17
        13 000400   000000 701000 xent               TSX1    PSL$LOCATE
        13 000401   000000 011000                    NOP     0

      250     6227
      251     6228    2      BUCKET$ = ADDR(BUCKET$ -> BLOCK.DATA);

   6228 13 000402   200006 236100                    LDQ     BUCKET$,,AUTO
        13 000403   000002 036003                    ADLQ    2,DU
        13 000404   200006 756100                    STQ     BUCKET$,,AUTO

      252     6229
      253     6230    2      IF OLD_BUCKET$ ~= ADDR(NIL)

   6230 13 000405   200007 236100                    LDQ     OLD_BUCKET$,,AUTO
        13 000406   000001 116000 xsym               CMPQ    B_VECTNIL+1
        13 000407   000412 600000 13                 TZE     s:6234

      254     6231    2        THEN
      255     6232    2         OLD_BUCKET$ = ADDR(OLD_BUCKET$ -> BLOCK.DATA);

   6232 13 000410   000002 036003                    ADLQ    2,DU
        13 000411   200007 756100                    STQ     OLD_BUCKET$,,AUTO

      256     6233
      257     6234    2      TITLE_VECTOR = VECTOR(HISTOGRAM.TITLE.TEXT);

   6234 13 000412   200012 470500                    LDP0    @HISTOGRAM,,AUTO
        13 000413   000005 220100                    LDX0    5,,PR0
        13 000414   000777 360003                    ANX0    511,DU
        13 000415   000000 635010                    EAA     0,X0
        13 000416   000002 771000                    ARL     2
        13 000417   000140 135007                    SBLA    96,DL
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:34   
        13 000420   200012 236100                    LDQ     @HISTOGRAM,,AUTO
        13 000421   000110 036000 14                 ADLQ    72
        13 000422   000000 757000 12                 STAQ    TITLE_VECTOR

      258     6235    2      UNITS_VECTOR = VECTOR(ADDR(HISTOGRAM.UNITS)->TEXTC.TEXT);

   6235 13 000423   000001 236100                    LDQ     1,,PR0
        13 000424   000033 772000                    QRL     27
        13 000425   000064 737000                    LLS     52
        13 000426   000140 135007                    SBLA    96,DL
        13 000427   200012 236100                    LDQ     @HISTOGRAM,,AUTO
        13 000430   000111 036000 14                 ADLQ    73
        13 000431   000002 757000 12                 STAQ    UNITS_VECTOR

      259     6236
      260     6237    2      HEADER_TAB_1 = (57 - HISTOGRAM.TITLE.LEN) / 2;

   6237 13 000432   000005 236100                    LDQ     5,,PR0
        13 000433   000022 772000                    QRL     18
        13 000434   000777 376007                    ANQ     511,DL
        13 000435   000027 676000 xsym               ERQ     B_VECTNIL+23
        13 000436   000072 036007                    ADLQ    58,DL
        13 000437   000002 506007                    DIV     2,DL
        13 000440   000011 756000 12                 STQ     HEADER_TAB_1

      261     6238    2      HEADER_TAB_2 = (18 - HISTOGRAM.UNITS.LEN) / 2;

   6238 13 000441   000001 236100                    LDQ     1,,PR0
        13 000442   000033 772000                    QRL     27
        13 000443   000027 676000 xsym               ERQ     B_VECTNIL+23
        13 000444   000023 036007                    ADLQ    19,DL
        13 000445   000002 506007                    DIV     2,DL
        13 000446   000012 756000 12                 STQ     HEADER_TAB_2

      262     6239
      263     6240    2      IF OLD_BUCKET$ ~= ADDR(NIL) AND FLAGS.SNAP

PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:35   
   6240 13 000447   200007 236100                    LDQ     OLD_BUCKET$,,AUTO
        13 000450   000001 116000 xsym               CMPQ    B_VECTNIL+1
        13 000451   000465 600000 13                 TZE     s:6244
        13 000452   200011 471500                    LDP1    @FLAGS,,AUTO
        13 000453   000000 066500                    CMPB    filb='0'B
        13 000454   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
        13 000455   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        13 000456   000465 600000 13                 TZE     s:6244

      264     6241    2        THEN
      265     6242    2         CALL GENERATE ('"Snap"', BUCKET$->BUCKET, OLD_BUCKET$->BUCKET);

   6242 13 000457   200006 237100                    LDAQ    BUCKET$,,AUTO
        13 000460   200016 757100                    STAQ    @BUCKET,,AUTO
        13 000461   000112 236000 14                 LDQ     74
        13 000462   200015 756100                    STQ     @TYPE,,AUTO
        13 000463   000003 701000 13                 TSX1    GENERATE
        13 000464   000000 011000                    NOP     0

      266     6243
      267     6244    2      IF (OLD_BUCKET$ = ADDR(NIL) AND FLAGS.SNAP) OR FLAGS.ALL

   6244 13 000465   200007 236100                    LDQ     OLD_BUCKET$,,AUTO
        13 000466   000001 116000 xsym               CMPQ    B_VECTNIL+1
        13 000467   000475 601000 13                 TNZ     s:6244+8
        13 000470   200011 470500                    LDP0    @FLAGS,,AUTO
        13 000471   000000 066500                    CMPB    filb='0'B
        13 000472   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
        13 000473   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        13 000474   000502 601000 13                 TNZ     s:6246
        13 000475   200011 470500                    LDP0    @FLAGS,,AUTO
        13 000476   000000 066500                    CMPB    filb='0'B
        13 000477   000000 010001                    BDSC    0,,PR0                   by=0,bit=1,n=1
        13 000500   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        13 000501   000511 600000 13                 TZE     s:6248

      268     6245    2        THEN
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:36   
      269     6246    2         CALL GENERATE (' "All"', BUCKET$->BUCKET);

   6246 13 000502   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 000503   200006 235100                    LDA     BUCKET$,,AUTO
        13 000504   200016 757100                    STAQ    @BUCKET,,AUTO
        13 000505   000113 236000 14                 LDQ     75
        13 000506   200015 756100                    STQ     @TYPE,,AUTO
        13 000507   000003 701000 13                 TSX1    GENERATE
        13 000510   000000 011000                    NOP     0

      270     6247
      271     6248    2      RETURN;

   6248 13 000511   200010 221300                    LDX1  ! OLD_BUCKET$+1,,AUTO
        13 000512   000001 702211                    TSX2  ! 1,X1

      272     6249
      273     6250    2   END PRODUCE;
      274     6251        %EJECT;
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:37   
      275     6252    1      DID_ONE = %NO#;

   6252 13 000513   200005 450100                    STZ     DID_ONE,,AUTO

      276     6253
      277     6254    1      CALL PRODUCE(PS_HISTOGRAM_FLAGS.RESPONSE, RESPONSE);

   6254 13 000514   000114 236000 14                 LDQ     76
        13 000515   200012 756100                    STQ     @FLAGS+1,,AUTO
        13 000516   000115 236000 14                 LDQ     77
        13 000517   200011 756100                    STQ     OLD_BUCKET$+2,,AUTO
        13 000520   000361 701000 13                 TSX1    PRODUCE
        13 000521   000000 011000                    NOP     0

      278     6255    1      CALL PRODUCE(PS_HISTOGRAM_FLAGS.USER_SIZE, USER_SIZE);

   6255 13 000522   000116 236000 14                 LDQ     78
        13 000523   200012 756100                    STQ     @FLAGS+1,,AUTO
        13 000524   000117 236000 14                 LDQ     79
        13 000525   200011 756100                    STQ     OLD_BUCKET$+2,,AUTO
        13 000526   000361 701000 13                 TSX1    PRODUCE
        13 000527   000000 011000                    NOP     0

      279     6256    1      CALL PRODUCE(PS_HISTOGRAM_FLAGS.PMME_TIMES, PMME_TIMES);

   6256 13 000530   000120 236000 14                 LDQ     80
        13 000531   200012 756100                    STQ     @FLAGS+1,,AUTO
        13 000532   000121 236000 14                 LDQ     81
        13 000533   200011 756100                    STQ     OLD_BUCKET$+2,,AUTO
        13 000534   000361 701000 13                 TSX1    PRODUCE
        13 000535   000000 011000                    NOP     0

      280     6257    1      CALL PRODUCE(PS_HISTOGRAM_FLAGS.INTERACTION_TIME, INTERACTION_TIME);

   6257 13 000536   000122 236000 14                 LDQ     82
        13 000537   200012 756100                    STQ     @FLAGS+1,,AUTO
        13 000540   000123 236000 14                 LDQ     83
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:38   
        13 000541   200011 756100                    STQ     OLD_BUCKET$+2,,AUTO
        13 000542   000361 701000 13                 TSX1    PRODUCE
        13 000543   000000 011000                    NOP     0

      281     6258
      282     6259    1      IF DID_ONE

   6259 13 000544   200005 234100                    SZN     DID_ONE,,AUTO
        13 000545   000551 605000 13                 TPL     s:6263

      283     6260    1        THEN
      284     6261    1         CALL PSD$EJECT;

   6261 13 000546   000002 631400 xsym               EPPR1   B_VECTNIL+2
        13 000547   000000 701000 xent               TSX1    PSD$EJECT
        13 000550   000000 011000                    NOP     0

      285     6262
      286     6263    1      RETURN;

   6263 13 000551   000000 702200 xent               TSX2  ! X66_ARET

      287     6264
      288     6265    1   PSD$HIST_BUCKET: ENTRY (SPECIFIC_BUCKET);

   6265 13 000552   000000 700200 xent  PSD$HIST_BU* TSX0  ! X66_AUTO_1
        13 000553   000040 000001                    ZERO    32,1

      289     6266
      290     6267    1      CALL GENERATE ('      ', SPECIFIC_BUCKET);

   6267 13 000554   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 000555   200003 235100                    LDA     @SPECIFIC_BUCKET,,AUTO
        13 000556   200016 757100                    STAQ    @TYPE+1,,AUTO
        13 000557   000124 236000 14                 LDQ     84
        13 000560   200015 756100                    STQ     @HISTOGRAM+3,,AUTO
        13 000561   000003 701000 13                 TSX1    GENERATE
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:39   
        13 000562   000000 011000                    NOP     0

      291     6268
      292     6269    1      RETURN;

   6269 13 000563   000000 702200 xent               TSX2  ! X66_ARET
      293     6270
      294     6271    1   END PSD$HISTO;

PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:40   
--  Include file information  --

   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   PM_BUCKET_C.:E05TOU  is referenced.
   PS_SUBS_C.:E05TOU  is referenced.
   PS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PSD$HISTO.
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:41   

 **** Variables and constants ****

  ****  Section 007 RtLmCm PS_FDS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1080)  r     1 PS_FDS

  ****  Section 011 RoData PSD$HISTO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   102-0-0/c CHAR(62)    r     1 BLOTTO_FORMAT            141-0-0/c CHAR(40)    r     1 FILL
    21-0-0/c STRC(702)   r     1 HEADER_FORMAT            223-0-0/w STRC(495)   r     1 INTERACTION_TIME
    10-0-0/c CHAR        r     1 LAST_FORMAT                0-0-0/c CHAR(32)    r     1 LINE_FORMAT
   201-0-0/w STRC(621)   r     1 PMME_TIMES               153-0-0/w STRC(423)   r     1 RESPONSE
    45-0-0/c CHAR(49)    r     1 SIMPLE_FORMAT            122-0-0/c CHAR(40)    r     1 STARS
    62-0-0/c STRC(558)   r     1 TRAILER_FORMAT           134-0-0/c CHAR(17)    r     1 UNDERLINE_STUFF
   167-0-0/w STRC(351)   r     1 USER_SIZE                141-0-0/c CHAR        r     1 XFILL(0:39)
   122-0-0/c CHAR        r     1 XSTAR(0:39)

  ****  Section 012  Data  PSD$HISTO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/c CHAR(40)    r     1 BAR                       10-0-0/w UBIN        r     1 EVENT_COUNT
    10-0-0/w SBIN        r     1 EVENT_COUNT_SBIN          11-0-0/w UBIN        r     1 HEADER_TAB_1
    12-0-0/w UBIN        r     1 HEADER_TAB_2              13-0-0/c CHAR(6)     r     1 HEADER_TYPE
     5-0-0/w UBIN        r     1 HIGH                      15-0-0/c CHAR        r     1 IBAR(0:39)
     4-0-0/w UBIN        r     1 LOW                        7-0-0/w UBIN        r     1 NP
     6-0-0/w UBIN        r     1 NR                         0-0-0/d BIT (72)    r     1 TITLE_VECTOR
    27-0-0/c CHAR(10)    r     1 UNDERLINER                 2-0-0/d BIT (72)    r     1 UNITS_VECTOR

  ****  Auto variables  ****
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:42   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/w PTR         r     1 @BUCKET                   11-0-0/w PTR         r     1 @FLAGS
    12-0-0/w PTR         r     1 @HISTOGRAM                31-0-0/w PTR         r     1 @N
    32-0-0/w PTR         r     1 @NP                       17-0-0/w PTR         r     1 @OLD_BUCKET
     3-0-0/w PTR         r     1 @SPECIFIC_BUCKET          15-0-0/w PTR         r     1 @TYPE
    *0-0-0/d STRC(108)   r     1 BUCKET                     6-0-0/w PTR         r     1 BUCKET$
     5-0-0/b BIT         r     1 DID_ONE                   26-0-0/w SBIN        r     1 FILL_SIZE
    *0-0-0/b STRC(2)     r     1 FLAGS                     *0-0-0/w ASTR(198)   r     1 HISTOGRAM
    20-0-0/w UBIN        r     1 I                         21-0-0/w UBIN        r     1 J
    *0-0-0/w UBIN        r     1 N                         *0-0-0/w UBIN        r     1 NP
    23-0-0/w UBIN        r     1 NR_POS                    *0-0-0/d STRC(108)   r     1 OLD_BUCKET
     7-0-0/w PTR         r     1 OLD_BUCKET$               25-0-0/w UBIN        r     1 OLD_SUM_POS
    *0-0-0/d STRC(108)   r     1 SPECIFIC_BUCKET           22-0-0/w UBIN        r     1 SUM
    24-0-0/w UBIN        r     1 SUM_POS                   *0-0-0/c CHAR(6)     r     1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(140)   r     1 PS_BUFFER                  0-0-0/b STRC(8)     r     1 PS_HISTOGRAM_FLAGS
     0-0-0/w PTR         r     1 PS_STATS$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)   r     1 BLOCK                      0-0-0/d STRC(108)   r     1 BUCKET
     0-0-0/c ACHR        r     1 FILL_IN                    0-0-0N  NULL        r     1 M$LO
     0-0-0/c ASTR(9)     r     1 TEXTC

PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:43   

   Procedure PSD$HISTO requires 372 words for executable code.
   Procedure PSD$HISTO requires 32 words of local(AUTO) storage.

    No errors detected in file PSD$HISTO.:E05TSI    .
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:44   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:45   
          MINI XREF LISTING

BAR
      5969**DCL      5970--REDEF    6148<<ASSIGN   6169--ASSIGN   6175--CALL     6178--CALL
BLOCK.DATA
      4918**DCL      6228--ASSIGN   6232--ASSIGN
BLOTTO_FORMAT
      5954**DCL      6115--CALL
BUCKET
      5934**DCL      6242<>CALL     6242<>CALL     6246<>CALL
BUCKET IN PROCEDURE GENERATE
      6050**DCL      6048--PROC
BUCKET.DATA IN PROCEDURE GENERATE
      6053**DCL      6095>>ASSIGN   6134>>ASSIGN   6138>>ASSIGN   6140>>ASSIGN
BUCKET.SIZE IN PROCEDURE GENERATE
      6051**DCL      6093>>DOINDEX  6095>>ASSIGN   6121>>CALL     6132>>DOINDEX  6138>>ASSIGN   6140>>ASSIGN
      6173>>IF
BUCKET$
      5977**DCL      6226<>CALL     6228<<ASSIGN   6228>>ASSIGN   6242>>CALL     6246>>CALL
DID_ONE
      5963**DCL      6201<<ASSIGN   6252<<ASSIGN   6259>>IF
EVENT_COUNT
      5964**DCL      5965--REDEF    6078>>ASSIGN   6090<<ASSIGN   6095<<ASSIGN   6095>>ASSIGN   6099<<ASSIGN
      6099>>ASSIGN   6109>>IF       6186>>ASSIGN   6198--CALL
EVENT_COUNT_SBIN
      5965**DCL      6078>>ASSIGN   6171>>ASSIGN   6171>>ASSIGN
FILL
      5976**DCL      6163>>ASSIGN
FILL_IN IN PROCEDURE GENERATE
      6070**DCL      6163<<ASSIGN   6169<<ASSIGN
FILL_SIZE IN PROCEDURE GENERATE
      6069**DCL      6070--IMP-SIZ  6158<<ASSIGN   6160>>IF       6163>>ASSIGN   6163>>ASSIGN   6165<<ASSIGN
      6167>>IF       6169>>ASSIGN
FLAGS IN PROCEDURE PRODUCE
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:46   
      6209**DCL      6207--PROC     6222>>IF
FLAGS.ALL IN PROCEDURE PRODUCE
      6211**DCL      6244>>IF
FLAGS.SNAP IN PROCEDURE PRODUCE
      6210**DCL      6240>>IF       6244>>IF
GENERATE
      6048**PROC     6242--CALL     6246--CALL     6267--CALL
GET_POS IN PROCEDURE GENERATE
      6073**PROC     6145--CALL     6146--CALL
HEADER_FORMAT
      5943**DCL      6123--CALL
HEADER_FORMAT.P1
      5944**DCL      6112--CALL
HEADER_TAB_1
      5966**DCL      6112--CALL     6123--CALL     6237<<ASSIGN
HEADER_TAB_2
      5967**DCL      6123--CALL     6238<<ASSIGN
HEADER_TYPE
      5968**DCL      6089<<ASSIGN   6112--CALL     6123--CALL
HIGH
      5960**DCL      6134<<ASSIGN   6178--CALL     6181>>ASSIGN
HISTOGRAM IN PROCEDURE PRODUCE
      6213**DCL      6207--PROC
HISTOGRAM.CODE IN PROCEDURE PRODUCE
      6214**DCL      6226<>CALL
HISTOGRAM.TITLE.LEN IN PROCEDURE PRODUCE
      6219**DCL      6220--IMP-SIZ  6234>>ASSIGN   6237>>ASSIGN
HISTOGRAM.TITLE.TEXT IN PROCEDURE PRODUCE
      6220**DCL      6234--ASSIGN
HISTOGRAM.UNITS IN PROCEDURE PRODUCE
      6215**DCL      6235--ASSIGN   6235--ASSIGN
HISTOGRAM.UNITS.LEN IN PROCEDURE PRODUCE
      6216**DCL      6238>>ASSIGN
I IN PROCEDURE GENERATE
      6063**DCL      6093<<DOINDEX  6095>>ASSIGN   6099>>ASSIGN   6132<<DOINDEX  6134>>ASSIGN   6138>>ASSIGN
      6140>>ASSIGN   6140>>ASSIGN   6173>>IF       6186<<ASSIGN   6189>>DOWHILE  6191<<ASSIGN   6191>>ASSIGN
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:47   
IBAR
      5970**DCL      6154<<ASSIGN   6156<<ASSIGN   6163--ASSIGN
INTERACTION_TIME
      6038**DCL      6257<>CALL
J IN PROCEDURE GENERATE
      6064**DCL      6187<<ASSIGN   6189>>DOWHILE  6192<<ASSIGN   6192>>ASSIGN   6196>>ASSIGN
LAST_FORMAT
      5941**DCL      6175--CALL
LINE_FORMAT
      5939**DCL      6178--CALL
LOW
      5959**DCL      6129<<ASSIGN   6175--CALL     6178--CALL     6181<<ASSIGN
N IN PROCEDURE GET_POS
      6075**DCL      6073--PROC     6078>>ASSIGN   6080>>IF
NP
      5962**DCL      6171<<ASSIGN   6175--CALL     6178--CALL
NP IN PROCEDURE GET_POS
      6076**DCL      6073--PROC     6078<<ASSIGN   6080>>IF       6083<<ASSIGN
NR
      5961**DCL      6138<<ASSIGN   6140<<ASSIGN   6143>>ASSIGN   6145<>CALL     6171>>ASSIGN   6175--CALL
      6178--CALL
NR_POS IN PROCEDURE GENERATE
      6066**DCL      6145<>CALL     6150>>IF       6165>>ASSIGN
OLD_BUCKET IN PROCEDURE GENERATE
      6056**DCL      6048--PROC     6097--IF       6136--IF
OLD_BUCKET.DATA IN PROCEDURE GENERATE
      6059**DCL      6099>>ASSIGN   6140>>ASSIGN
OLD_BUCKET.SIZE IN PROCEDURE GENERATE
      6057**DCL      6099>>ASSIGN   6140>>ASSIGN
OLD_BUCKET$
      5978**DCL      6226<>CALL     6230>>IF       6232<<ASSIGN   6232>>ASSIGN   6240>>IF       6242>>CALL
      6244>>IF
OLD_SUM_POS IN PROCEDURE GENERATE
      6068**DCL      6091<<ASSIGN   6152>>IF       6158>>ASSIGN   6160>>IF       6163>>ASSIGN   6182<<ASSIGN
PMME_TIMES
      6027**DCL      6256<>CALL
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:48   
PRODUCE
      6207**PROC     6254--CALL     6255--CALL     6256--CALL     6257--CALL
PSD$EJECT
      5991**DCL-ENT  6121--CALL     6261--CALL
PSL$LOCATE
      5981**DCL-ENT  6226--CALL
PS_BUFFER
      4921**DCL      4956--DCLINIT  4958--DCLINIT
PS_COLLECT.CALCNT
      5076**DCL      5076--REDEF
PS_COLLECT.USRSRV
      5073**DCL      5074--REDEF
PS_FDS
      4938**DCL      6105<>CALL     6112<>CALL     6115<>CALL     6123<>CALL     6175<>CALL     6178<>CALL
      6198<>CALL
PS_HISTOGRAM_FLAGS.INTERACTION_TIME
      4917**DCL      6257<>CALL
PS_HISTOGRAM_FLAGS.PMME_TIMES
      4916**DCL      6256<>CALL
PS_HISTOGRAM_FLAGS.RESPONSE
      4916**DCL      6254<>CALL
PS_HISTOGRAM_FLAGS.USER_SIZE
      4916**DCL      6255<>CALL
PS_HLPCGBUF.DSPMSK
      5333**DCL      5339--REDEF
PS_HLPCGBUF.SLCMSK
      5374**DCL      5381--REDEF
PS_OLD_COLLECT.CALCNT
      5080**DCL      5081--REDEF
PS_OLD_COLLECT.USRSRV
      5078**DCL      5078--REDEF
PS_STATS$
      5082**DCL      5084--IMP-PTR
RESPONSE
      6005**DCL      6254<>CALL
SIMPLE_FORMAT
PL6.E3A0      #001=PSD$HISTO File=PSD$HISTO.:E05TSI                              WED 07/30/97 04:30 Page:49   
      5947**DCL      6105--CALL
SPECIFIC_BUCKET
      5928**DCL         8--PROC     6265--ENTRY    6267<>CALL
STARS
      5972**DCL      6169>>ASSIGN
SUM IN PROCEDURE GENERATE
      6065**DCL      6130<<ASSIGN   6143<<ASSIGN   6143>>ASSIGN   6146<>CALL
SUM_POS IN PROCEDURE GENERATE
      6067**DCL      6146<>CALL     6150>>IF       6150>>IF       6152>>IF       6154>>ASSIGN   6156>>ASSIGN
      6158>>ASSIGN   6182>>ASSIGN
TEXTC.LEN
      5086**DCL      5086--IMP-SIZ  6235>>ASSIGN
TEXTC.TEXT
      5086**DCL      6235--ASSIGN
TITLE_VECTOR
      5957**DCL      6112<>CALL     6123<>CALL     6234<<ASSIGN
TRAILER_FORMAT
      5950**DCL      6198--CALL
TYPE IN PROCEDURE GENERATE
      6061**DCL      6048--PROC     6089>>ASSIGN   6103>>IF
UNDERLINER
      5973**DCL      6196<<ASSIGN   6198--CALL
UNDERLINE_STUFF
      5974**DCL      6196>>ASSIGN
UNITS_VECTOR
      5958**DCL      6123<>CALL     6235<<ASSIGN
USER_SIZE
      6016**DCL      6255<>CALL
X$WRITE
      5988**DCL-ENT  6105--CALL     6112--CALL     6115--CALL     6123--CALL     6175--CALL     6178--CALL
      6198--CALL
XFILL
      5975**DCL      5976--REDEF
XSTAR
      5971**DCL      5972--REDEF
