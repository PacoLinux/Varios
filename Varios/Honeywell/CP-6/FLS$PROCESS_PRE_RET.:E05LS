VERSION E05

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* THI=1,PLM=3 */
        7        7        FLS$PROCESS_PRE_RET: PROC ALTRET;
        8        8        /*F*  NAME: FLS$PROCESS_PRE_RET
        9        9              PURPOSE: Convert list of files to retrieve into RETRIEVE commands.
       10       10        */
       11       11
       12       12        /***
       13       13         *** INCLUDE:
       14       14         ***/
       15       15
       16       16        %INCLUDE B_ERRORS_C;
       17     1143        %INCLUDE CP_6;
       18     6702        %INCLUDE CP_6_SUBS;
       19     7242        %INCLUDE FLI_DATA_R;
       20     8656
       21     8657        /***
       22     8658         *** DCB:
       23     8659         ***/
       24     8660
       25     8661    1   DCL M$DISK00 DCB;
       26     8662
       27     8663        /***
       28     8664         *** ENTRY:
       29     8665         ***/
       30     8666
       31     8667    1   DCL FLI$RPT_ERR ENTRY(5);
       32     8668
       33     8669        /***
       34     8670         *** AUTO:
       35     8671         ***/
       36     8672
       37     8673    1   DCL RES$ PTR;
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:2    
       38     8674    1   DCL SN$ PTR;
       39     8675    1   DCL PSN$ PTR;
       40     8676    1   DCL ACCT$ PTR;
       41     8677    1   DCL FNAME$ PTR;
       42     8678    1   DCL NRES SBIN;
       43     8679    1   DCL NSN SBIN;
       44     8680    1   DCL NPSN SBIN;
       45     8681    1   DCL NACCT SBIN;
       46     8682    1   DCL NFNAME SBIN;
       47     8683    1   DCL FSNCHARS CHAR(4);
       48     8684    1   DCL ODFSNCHARS CHAR(6);
       49     8685    1   DCL CTN SBIN;
       50     8686    1   DCL CMD_LINE CHAR(80);
       51     8687    1   DCL CMD_LINE_X SBIN;
       52     8688    1   DCL CMD_LINE_CHARS$ PTR;
       53     8689    1   DCL LAST_SN$ PTR;
       54     8690    1   DCL NLAST_SN SBIN;
       55     8691    1   DCL LAST_FSN SBIN;
       56     8692    1   DCL LASTACCT$ PTR;
       57     8693    1   DCL NLASTACCT SBIN;
       58     8694    1   DCL LASTACCT_CHARS CHAR(8);
       59     8695    1   DCL SECOND_SN_CHARS CHAR(6);
       60     8696    1   DCL SECOND_SN$ PTR;
       61     8697    1   DCL NSECOND_SN SBIN;
       62     8698    1   DCL SAW_FILE BIT(1);
       63     8699    1   DCL LAST_SN_CHARS CHAR(6);
       64     8700
       65     8701        /***
       66     8702         *** BASED:
       67     8703         ***/
       68     8704
       69     8705    1   DCL RESCHARS CHAR(NRES) BASED(RES$) CALIGNED;
       70     8706    1   DCL SNCHARS CHAR(NSN) BASED(SN$) CALIGNED;
       71     8707    1   DCL PSNCHARS CHAR(NPSN) BASED(PSN$) CALIGNED;
       72     8708    1   DCL ACCTCHARS CHAR(NACCT) BASED(ACCT$) CALIGNED;
       73     8709    1   DCL FNAMECHARS CHAR(NFNAME) BASED(FNAME$) CALIGNED;
       74     8710    1   DCL LAST_SN CHAR(NLAST_SN) BASED(LAST_SN$) CALIGNED;
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:3    
       75     8711    1   DCL LASTACCT CHAR(NLASTACCT) BASED(LASTACCT$) CALIGNED;
       76     8712        %B$TCB;
       77     8715        %B$ALT;
       78     8723
       79     8724        /***
       80     8725         *** CONSTANT:
       81     8726         ***/
       82     8727
       83     8728    1   DCL CMD CHAR(0) CONSTANT INIT('RETRIEVE ');
       84     8729    1   DCL SEP CHAR(0) CONSTANT INIT('#');
       85     8730    1   DCL FSNC CHAR(0) CONSTANT INIT('(FSN(');
       86     8731    1   DCL RPAR CHAR(0) CONSTANT INIT(')');
       87     8732    1   DCL PSNC CHAR(0) CONSTANT INIT(' DP#');
       88     8733    1   DCL SLASH CHAR(0) CONSTANT INIT('/');
       89     8734    1   DCL DOT CHAR(0) CONSTANT INIT('.');
       90     8735    1   DCL REMC CHAR(0) CONSTANT INIT('REMOVE LT#');
       91     8736    1   DCL REMODC CHAR(0) CONSTANT INIT('REMOVE OD#');
       92     8737    1   DCL COMMA CHAR(0) CONSTANT INIT(',');
       93     8738    1   DCL IOEC CHAR(0) CONSTANT INIT('IO CONT');
       94     8739
       95     8740        /***
       96     8741         *** FPT
       97     8742         ***/
       98     8743
       99     8744        %VLP_NAME( FPTN=RET_CMDS_FNAME,
      100     8745                   NAME='*RET_CMDS' );
      101     8772
      102     8773        %FPT_OPEN( FPTN=RET_CMDS_OPEN,
      103     8774                   DCB=M$DISK00,
      104     8775                   FUN=CREATE,
      105     8776                   CTG=YES,
      106     8777                   ASN=FILE,
      107     8778                   SCRUB=YES,
      108     8779                   ORG=CONSEC,
      109     8780                   NAME=RET_CMDS_FNAME );
      110     8889
      111     8890        %FPT_WRITE( FPTN=RET_CMDS_WRITE,
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:4    
      112     8891                    DCB=M$DISK00 );
      113     8922
      114     8923        %FPT_CLOSE( FPTN=RET_CMDS_CLOSE,
      115     8924                    DCB=M$DISK00 );
      116     8966
      117     8967        /****************************************/
      118     8968
      119     8969    1      PRE_RET_OPEN.V.FUN# = %IN#;
      120     8970    1      CALL M$OPEN( PRE_RET_OPEN )
      121     8971    2       WHENALTRETURN DO;
      122     8972    2   REPERRALT: ;
      123     8973    2         CALL FLI$RPT_ERR;
      124     8974    2         ALTRETURN;
      125     8975    2         END;
      126     8976
      127     8977    1      CALL M$OPEN( RET_CMDS_OPEN ) ALTRET( REPERRALT );
      128     8978
      129     8979        /***
      130     8980         *** Necessary initialization.
      131     8981         ***/
      132     8982
      133     8983    1      RES$ = ADDR(PRE_RET_KEY.RES);
      134     8984    1      SN$ = ADDR(PRE_RET_KEY.SN);
      135     8985    1      PSN$ = ADDR(PRE_RET_KEY.PSN);
      136     8986    1      ACCT$ = ADDR(PRE_RET_KEY.ACCT);
      137     8987    1      FNAME$ = ADDR(PRE_RET_KEY.FNAME);
      138     8988    1      LASTACCT$ = ADDR(LASTACCT_CHARS);
      139     8989    1      LASTACCT_CHARS = ' ';
      140     8990    1      NLASTACCT = 0;
      141     8991
      142     8992    1      RET_CMDS_WRITE.BUF_ = VECTOR(CMD_LINE);
      143     8993    1      LAST_FSN = 0;
      144     8994    1      LAST_SN$ = ADDR(LAST_SN_CHARS);
      145     8995    1      NLAST_SN = 0;
      146     8996    1      CMD_LINE_CHARS$ = ADDR(CMD_LINE);
      147     8997    1      SECOND_SN$ = ADDR(SECOND_SN_CHARS);
      148     8998
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:5    
      149     8999         /***
      150     9000          *** Read each record of PRE_RET file converting it to RETRIEVE
      151     9001          *** command.
      152     9002          ***/
      153     9003
      154     9004    2      DO WHILE('1'B);
      155     9005    2         CALL M$READ( PRE_RET_READ ) ALTRET( CHKEOF );
      156     9006    2         CALL INDEX( NRES, ' ', PRE_RET_KEY.RES );
      157     9007    2         CALL INDEX( NSN, ' ', PRE_RET_KEY.SN );
      158     9008    2         CALL INDEX( NPSN, ' ', PRE_RET_KEY.PSN );
      159     9009    2         CALL INDEX( NACCT, ' ', PRE_RET_KEY.ACCT );
      160     9010    2         NFNAME = PRE_RET_KEY.FNAME.L;
      161     9011    2         IF RESCHARS = 'CT'
      162     9012    2          THEN CALL BINCHAR( FSNCHARS, PRE_RET_KEY.FSN );
      163     9013    2          ELSE CALL BINCHAR(ODFSNCHARS, PRE_RET_KEY.FSN );
      164     9014    2         IF LAST_SN ~= SNCHARS OR LAST_FSN ~= PRE_RET_KEY.FSN
      165     9015    3          THEN DO;
      166     9016    3            IF CMD_LINE_CHARS$ ~= ADDR(CMD_LINE)
      167     9017    4             THEN DO;                      /* Flush previous buffer              */
      168     9018    4               RET_CMDS_WRITE.BUF_.BOUND = POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE))-1;
      169     9019    4               CALL M$WRITE( RET_CMDS_WRITE ) ALTRET( ERRCLSALT );
      170     9020    4               CMD_LINE_CHARS$ = ADDR(CMD_LINE);
      171     9021    4               END;
      172     9022    3            IF LAST_SN ~= SNCHARS AND NLAST_SN > 0
      173     9023    4             THEN DO;                      /* Remove previous tape               */
      174     9024    4               IF RESCHARS = 'CT'
      175     9025    4                THEN CALL FLS_ADD_CHARS( ADDR(REMC), LENGTHC(REMC) ) ALTRET( ERRCLSALT
              9025                         );
      176     9026    4                ELSE CALL FLS_ADD_CHARS( ADDR(REMODC), LENGTHC(REMODC) ) ALTRET(
              9026                         ERRCLSALT );
      177     9027    4               CALL FLS_ADD_CHARS( LAST_SN$, NLAST_SN ) ALTRET( ERRCLSALT );
      178     9028    4               RET_CMDS_WRITE.BUF_.BOUND = POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE))-1;
      179     9029    4               CALL M$WRITE( RET_CMDS_WRITE ) ALTRET( ERRCLSALT );
      180     9030    4               CMD_LINE_CHARS$ = ADDR(CMD_LINE);
      181     9031    4               END;
      182     9032    3            LAST_FSN = PRE_RET_KEY.FSN;
      183     9033    3            CALL FLS_ADD_CHARS( ADDR(CMD), LENGTHC(CMD) ) ALTRET( ERRCLSALT );
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:6    
      184     9034    3            CALL FLS_ADD_CHARS( RES$, NRES )  ALTRET( ERRCLSALT );
      185     9035    3            CALL FLS_ADD_CHARS( ADDR(SEP), LENGTHC(SEP) )  ALTRET( ERRCLSALT );
      186     9036    3            NLAST_SN = NSN;
      187     9037    3            LAST_SN = SNCHARS;
      188     9038    3            CALL FLS_ADD_CHARS( SN$, NSN ) ALTRET( ERRCLSALT );
      189     9039    3            CALL FLS_ADD_CHARS( ADDR(FSNC), LENGTHC(FSNC) ) ALTRET( ERRCLSALT );
      190     9040    3            IF RESCHARS = 'CT'
      191     9041    3             THEN CALL FLS_ADD_CHARS( ADDR(FSNCHARS), LENGTHC(FSNCHARS) ) ALTRET(
              9041                      ERRCLSALT );
      192     9042    3             ELSE CALL FLS_ADD_CHARS( ADDR(ODFSNCHARS), LENGTHC(ODFSNCHARS) ) ALTRET(
              9042                      ERRCLSALT );
      193     9043    3            CALL FLS_ADD_CHARS( ADDR(RPAR), LENGTHC(RPAR) ) ALTRET( ERRCLSALT );
      194     9044    3            IF PRE_RET_REC.IOERRORC
      195     9045    4             THEN DO;
      196     9046    4               CALL FLS_ADD_CHARS( ADDR(COMMA), LENGTHC(COMMA) ) ALTRET( ERRCLSALT );
      197     9047    4               CALL FLS_ADD_CHARS( ADDR(IOEC), LENGTHC(IOEC) ) ALTRET(ERRCLSALT);
      198     9048    4               END;
      199     9049    3            CALL FLS_ADD_CHARS( ADDR(RPAR), LENGTHC(RPAR) ) ALTRET( ERRCLSALT );
      200     9050    3            CALL FLS_ADD_CHARS( ADDR(PSNC), LENGTHC(PSNC) ) ALTRET( ERRCLSALT );
      201     9051    3            CALL FLS_ADD_CHARS( PSN$, NPSN ) ALTRET( ERRCLSALT );
      202     9052    3            CALL FLS_ADD_CHARS( ADDR(SLASH), LENGTHC(SLASH) ) ALTRET( ERRCLSALT );
      203     9053    3            SAW_FILE = '0'B;
      204     9054    3            LASTACCT_CHARS = ' ';
      205     9055    3            END;
      206     9056    2         IF SAW_FILE
      207     9057    3          THEN DO;
      208     9058    3            CALL FLS_ADD_CHARS( ADDR(COMMA), LENGTHC(COMMA) ) ALTRET( ERRCLSALT );
      209     9059    3            END;
      210     9060    2         CALL FLS_ADD_CHARS( FNAME$, NFNAME ) ALTRET( ERRCLSALT );
      211     9061    2         SAW_FILE = '1'B;
      212     9062    2         IF LASTACCT ~= ACCTCHARS
      213     9063    3          THEN DO;
      214     9064    3            CALL FLS_ADD_CHARS( ADDR(DOT), LENGTHC(DOT) ) ALTRET( ERRCLSALT );
      215     9065    3            CALL FLS_ADD_CHARS( ACCT$, NACCT ) ALTRET( ERRCLSALT );
      216     9066    3            NLASTACCT = NACCT;
      217     9067    3            LASTACCT = ACCTCHARS;
      218     9068    3            END;
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:7    
      219     9069    2         END;
      220     9070
      221     9071    1   CHKEOF: ;
      222     9072    1      IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF
      223     9073    2       THEN DO;
      224     9074    2   ERRCLSALT: ;
      225     9075    2         CALL FLI$RPT_ERR;
      226     9076    2         CALL M$CLOSE( PRE_RET_CLOSE )
      227     9077    3          WHENALTRETURN DO;
      228     9078    3            END;
      229     9079    2         CALL M$CLOSE( RET_CMDS_CLOSE )
      230     9080    3          WHENALTRETURN DO;
      231     9081    3            END;
      232     9082    2         ALTRETURN;
      233     9083    2         END;
      234     9084
      235     9085    1      IF CMD_LINE_CHARS$ ~= ADDR(CMD_LINE)
      236     9086    2       THEN DO;                            /* Flush previous buffer              */
      237     9087    2         RET_CMDS_WRITE.BUF_.BOUND = POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE))-1;
      238     9088    2         CALL M$WRITE( RET_CMDS_WRITE ) ALTRET( ERRCLSALT );
      239     9089    2         CMD_LINE_CHARS$ = ADDR(CMD_LINE);
      240     9090    2         END;
      241     9091    1      CALL M$CLOSE( PRE_RET_CLOSE )
      242     9092    2       WHENALTRETURN DO;
      243     9093    2         CALL FLI$RPT_ERR;
      244     9094    2         CALL M$CLOSE( RET_CMDS_CLOSE )
      245     9095    3          WHENALTRETURN DO;
      246     9096    3            END;
      247     9097    2         ALTRETURN;
      248     9098    2         END;
      249     9099
      250     9100    1      CALL M$CLOSE( RET_CMDS_CLOSE )
      251     9101    2       WHENALTRETURN DO;
      252     9102    2         END;
      253     9103
      254     9104
      255     9105    1      RETURN;
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:8    
      256     9106
      257     9107    1   FLS_ADD_CHARS: PROC( FROM$, NFROM ) ALTRET;
      258     9108
      259     9109    2   DCL FROM$ PTR;
      260     9110    2   DCL NFROM SBIN;
      261     9111
      262     9112        /***
      263     9113         *** BASED:
      264     9114         ***/
      265     9115
      266     9116    2   DCL TO_CHARS CHAR(NFROM) BASED(CMD_LINE_CHARS$) CALIGNED;
      267     9117    2   DCL TO1_CHAR CHAR(1) BASED(CMD_LINE_CHARS$) CALIGNED;
      268     9118    2   DCL FROM_CHARS CHAR(NFROM) BASED(FROM$) CALIGNED;
      269     9119
      270     9120        /********************/
      271     9121
      272     9122    2      IF NFROM+POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE))>=LENGTHV(CMD_LINE)
      273     9123    3       THEN DO;
      274     9124    3         RET_CMDS_WRITE.BUF_.BOUND = POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE));
      275     9125    3         TO1_CHAR = ';';                   /* Continuation                       */
      276     9126    3         CALL M$WRITE( RET_CMDS_WRITE ) ALTRET( JUSTALT );
      277     9127    3         CMD_LINE_CHARS$ = ADDR(CMD_LINE);
      278     9128    3         END;
      279     9129    2      TO_CHARS = FROM_CHARS;
      280     9130    2      CMD_LINE_CHARS$ = PINCRC( CMD_LINE_CHARS$, NFROM );
      281     9131    2      RETURN;
      282     9132
      283     9133    2   JUSTALT: ;
      284     9134    2      ALTRETURN;
      285     9135
      286     9136    2   END FLS_ADD_CHARS;
      287     9137
      288     9138    1   END FLS$PROCESS_PRE_RET;
      289     9139        %EOD;

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:9    
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLS$PROCESS_PRE_RET.

   Procedure FLS$PROCESS_PRE_RET requires 485 words for executable code.
   Procedure FLS$PROCESS_PRE_RET requires 76 words of local(AUTO) storage.

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:10   

 Object Unit name= FLS$PROCESS_PRE_RET                        File name= FLS$PROCESS_PRE_RET.:E05TOU
 UTS= JUL 29 '97 16:21:08.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none   110    156  FLS$PROCESS_PRE_RET
    3   DCB   even  none     0      0  M$DISK00
    4  RoData even  UTS     20     24  FLS$PROCESS_PRE_RET
    5   Proc  even  none   485    745  FLS$PROCESS_PRE_RET
    6  RoData even  none    25     31  FLS$PROCESS_PRE_RET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        0  FLS$PROCESS_PRE_RET

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         SNVECLIST$
     B$TCB$                                DPLIST$                               DPRESLIST$
     DISK_FILE_SPEC$                       SPECCHARS                             EFTWORD
     M$PRE_RET                             PRE_RET_KEY                           PRE_RET_REC
     PRE_RET_READ                          PRE_RET_OPEN                          PRE_RET_CLOSE
     RET_CMDS_NAME                         M$DISK00                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:12   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* THI=1,PLM=3 */
        7        7        FLS$PROCESS_PRE_RET: PROC ALTRET;

      7  5 000000   000000 700200 xent  FLS$PROCESS* TSX0  ! X66_AUTO_0
         5 000001   000114 000000                    ZERO    76,0

        8        8        /*F*  NAME: FLS$PROCESS_PRE_RET
        9        9              PURPOSE: Convert list of files to retrieve into RETRIEVE commands.
       10       10        */
       11       11
       12       12        /***
       13       13         *** INCLUDE:
       14       14         ***/
       15       15
       16       16        %INCLUDE B_ERRORS_C;
       17     1143        %INCLUDE CP_6;
       18     6702        %INCLUDE CP_6_SUBS;
       19     7242        %INCLUDE FLI_DATA_R;
       20     8656
       21     8657        /***
       22     8658         *** DCB:
       23     8659         ***/
       24     8660
       25     8661    1   DCL M$DISK00 DCB;
       26     8662
       27     8663        /***
       28     8664         *** ENTRY:
       29     8665         ***/
       30     8666
       31     8667    1   DCL FLI$RPT_ERR ENTRY(5);
       32     8668
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:13   
       33     8669        /***
       34     8670         *** AUTO:
       35     8671         ***/
       36     8672
       37     8673    1   DCL RES$ PTR;
       38     8674    1   DCL SN$ PTR;
       39     8675    1   DCL PSN$ PTR;
       40     8676    1   DCL ACCT$ PTR;
       41     8677    1   DCL FNAME$ PTR;
       42     8678    1   DCL NRES SBIN;
       43     8679    1   DCL NSN SBIN;
       44     8680    1   DCL NPSN SBIN;
       45     8681    1   DCL NACCT SBIN;
       46     8682    1   DCL NFNAME SBIN;
       47     8683    1   DCL FSNCHARS CHAR(4);
       48     8684    1   DCL ODFSNCHARS CHAR(6);
       49     8685    1   DCL CTN SBIN;
       50     8686    1   DCL CMD_LINE CHAR(80);
       51     8687    1   DCL CMD_LINE_X SBIN;
       52     8688    1   DCL CMD_LINE_CHARS$ PTR;
       53     8689    1   DCL LAST_SN$ PTR;
       54     8690    1   DCL NLAST_SN SBIN;
       55     8691    1   DCL LAST_FSN SBIN;
       56     8692    1   DCL LASTACCT$ PTR;
       57     8693    1   DCL NLASTACCT SBIN;
       58     8694    1   DCL LASTACCT_CHARS CHAR(8);
       59     8695    1   DCL SECOND_SN_CHARS CHAR(6);
       60     8696    1   DCL SECOND_SN$ PTR;
       61     8697    1   DCL NSECOND_SN SBIN;
       62     8698    1   DCL SAW_FILE BIT(1);
       63     8699    1   DCL LAST_SN_CHARS CHAR(6);
       64     8700
       65     8701        /***
       66     8702         *** BASED:
       67     8703         ***/
       68     8704
       69     8705    1   DCL RESCHARS CHAR(NRES) BASED(RES$) CALIGNED;
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:14   
       70     8706    1   DCL SNCHARS CHAR(NSN) BASED(SN$) CALIGNED;
       71     8707    1   DCL PSNCHARS CHAR(NPSN) BASED(PSN$) CALIGNED;
       72     8708    1   DCL ACCTCHARS CHAR(NACCT) BASED(ACCT$) CALIGNED;
       73     8709    1   DCL FNAMECHARS CHAR(NFNAME) BASED(FNAME$) CALIGNED;
       74     8710    1   DCL LAST_SN CHAR(NLAST_SN) BASED(LAST_SN$) CALIGNED;
       75     8711    1   DCL LASTACCT CHAR(NLASTACCT) BASED(LASTACCT$) CALIGNED;
       76     8712        %B$TCB;
       77     8715        %B$ALT;
       78     8723
       79     8724        /***
       80     8725         *** CONSTANT:
       81     8726         ***/
       82     8727
       83     8728    1   DCL CMD CHAR(0) CONSTANT INIT('RETRIEVE ');
       84     8729    1   DCL SEP CHAR(0) CONSTANT INIT('#');
       85     8730    1   DCL FSNC CHAR(0) CONSTANT INIT('(FSN(');
       86     8731    1   DCL RPAR CHAR(0) CONSTANT INIT(')');
       87     8732    1   DCL PSNC CHAR(0) CONSTANT INIT(' DP#');
       88     8733    1   DCL SLASH CHAR(0) CONSTANT INIT('/');
       89     8734    1   DCL DOT CHAR(0) CONSTANT INIT('.');
       90     8735    1   DCL REMC CHAR(0) CONSTANT INIT('REMOVE LT#');
       91     8736    1   DCL REMODC CHAR(0) CONSTANT INIT('REMOVE OD#');
       92     8737    1   DCL COMMA CHAR(0) CONSTANT INIT(',');
       93     8738    1   DCL IOEC CHAR(0) CONSTANT INIT('IO CONT');
       94     8739
       95     8740        /***
       96     8741         *** FPT
       97     8742         ***/
       98     8743
       99     8744        %VLP_NAME( FPTN=RET_CMDS_FNAME,
      100     8745                   NAME='*RET_CMDS' );
      101     8772
      102     8773        %FPT_OPEN( FPTN=RET_CMDS_OPEN,
      103     8774                   DCB=M$DISK00,
      104     8775                   FUN=CREATE,
      105     8776                   CTG=YES,
      106     8777                   ASN=FILE,
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:15   
      107     8778                   SCRUB=YES,
      108     8779                   ORG=CONSEC,
      109     8780                   NAME=RET_CMDS_FNAME );
      110     8889
      111     8890        %FPT_WRITE( FPTN=RET_CMDS_WRITE,
      112     8891                    DCB=M$DISK00 );
      113     8922
      114     8923        %FPT_CLOSE( FPTN=RET_CMDS_CLOSE,
      115     8924                    DCB=M$DISK00 );
      116     8966
      117     8967        /****************************************/
      118     8968
      119     8969    1      PRE_RET_OPEN.V.FUN# = %IN#;

   8969  5 000002   002000 236007                    LDQ     1024,DL
         5 000003   000045 552010 xsym               STBQ    PRE_RET_OPEN+37,'10'O

      120     8970    1      CALL M$OPEN( PRE_RET_OPEN )

   8970  5 000004   000000 630400 xsym               EPPR0   PRE_RET_OPEN
         5 000005   450000 713400                    CLIMB   alt,open
         5 000006   410400 401760                    pmme    nvectors=18
         5 000007   000011 702000 5                  TSX2    REPERRALT
         5 000010   000015 710000 5                  TRA     s:8977

      121     8971    2       WHENALTRETURN DO;

   8964  5 000011                       REPERRALT    null
      122     8972    2   REPERRALT: ;
      123     8973    2         CALL FLI$RPT_ERR;

   8973  5 000011   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000012   000000 701000 xent               TSX1    FLI$RPT_ERR
         5 000013   000000 011000                    NOP     0

      124     8974    2         ALTRETURN;

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:16   
   8974  5 000014   000000 702200 xent               TSX2  ! X66_AALT

      125     8975    2         END;
      126     8976
      127     8977    1      CALL M$OPEN( RET_CMDS_OPEN ) ALTRET( REPERRALT );

   8977  5 000015   000012 630400 2                  EPPR0   RET_CMDS_OPEN
         5 000016   450000 713400                    CLIMB   alt,open
         5 000017   410400 401760                    pmme    nvectors=18
         5 000020   000011 702000 5                  TSX2    REPERRALT

      128     8978
      129     8979        /***
      130     8980         *** Necessary initialization.
      131     8981         ***/
      132     8982
      133     8983    1      RES$ = ADDR(PRE_RET_KEY.RES);

   8983  5 000021   000000 236000 6                  LDQ     0
         5 000022   200003 756100                    STQ     RES$,,AUTO

      134     8984    1      SN$ = ADDR(PRE_RET_KEY.SN);

   8984  5 000023   000001 236000 6                  LDQ     1
         5 000024   200004 756100                    STQ     SN$,,AUTO

      135     8985    1      PSN$ = ADDR(PRE_RET_KEY.PSN);

   8985  5 000025   000002 236000 6                  LDQ     2
         5 000026   200005 756100                    STQ     PSN$,,AUTO

      136     8986    1      ACCT$ = ADDR(PRE_RET_KEY.ACCT);

   8986  5 000027   000003 236000 6                  LDQ     3
         5 000030   200006 756100                    STQ     ACCT$,,AUTO

      137     8987    1      FNAME$ = ADDR(PRE_RET_KEY.FNAME);
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:17   

   8987  5 000031   000004 236000 6                  LDQ     4
         5 000032   200007 756100                    STQ     FNAME$,,AUTO

      138     8988    1      LASTACCT$ = ADDR(LASTACCT_CHARS);

   8988  5 000033   200054 630500                    EPPR0   LASTACCT_CHARS,,AUTO
         5 000034   200052 450500                    STP0    LASTACCT$,,AUTO

      139     8989    1      LASTACCT_CHARS = ' ';

   8989  5 000035   000035 235000 xsym               LDA     B_VECTNIL+29
         5 000036   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000037   200054 757100                    STAQ    LASTACCT_CHARS,,AUTO

      140     8990    1      NLASTACCT = 0;

   8990  5 000040   200053 450100                    STZ     NLASTACCT,,AUTO

      141     8991
      142     8992    1      RET_CMDS_WRITE.BUF_ = VECTOR(CMD_LINE);

   8992  5 000041   000005 235000 6                  LDA     5
         5 000042   200072 452500                    STP2    @NFROM+2,,AUTO
         5 000043   200072 236100                    LDQ     @NFROM+2,,AUTO
         5 000044   000021 036003                    ADLQ    17,DU
         5 000045   000110 757000 2                  STAQ    RET_CMDS_WRITE+4

      143     8993    1      LAST_FSN = 0;

   8993  5 000046   200051 450100                    STZ     LAST_FSN,,AUTO

      144     8994    1      LAST_SN$ = ADDR(LAST_SN_CHARS);

   8994  5 000047   200063 631500                    EPPR1   LAST_SN_CHARS,,AUTO
         5 000050   200047 451500                    STP1    LAST_SN$,,AUTO

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:18   
      145     8995    1      NLAST_SN = 0;

   8995  5 000051   200050 450100                    STZ     NLAST_SN,,AUTO

      146     8996    1      CMD_LINE_CHARS$ = ADDR(CMD_LINE);

   8996  5 000052   200021 633500                    EPPR3   CMD_LINE,,AUTO
         5 000053   200046 453500                    STP3    CMD_LINE_CHARS$,,AUTO

      147     8997    1      SECOND_SN$ = ADDR(SECOND_SN_CHARS);

   8997  5 000054   200056 634500                    EPPR4   SECOND_SN_CHARS,,AUTO
         5 000055   200060 454500                    STP4    SECOND_SN$,,AUTO

      148     8998
      149     8999         /***
      150     9000          *** Read each record of PRE_RET file converting it to RETRIEVE
      151     9001          *** command.
      152     9002          ***/
      153     9003
      154     9004    2      DO WHILE('1'B);

      155     9005    2         CALL M$READ( PRE_RET_READ ) ALTRET( CHKEOF );

   9005  5 000056   000000 630400 xsym               EPPR0   PRE_RET_READ
         5 000057   440000 713400                    CLIMB   alt,read
         5 000060   401400 401760                    pmme    nvectors=4
         5 000061   000562 702000 5                  TSX2    CHKEOF

      156     9006    2         CALL INDEX( NRES, ' ', PRE_RET_KEY.RES );

   9006  5 000062   000000 124400                    SCM     mask='000'O
         5 000063   000000 200002 xsym               ADSC9   PRE_RET_KEY              cn=1,n=2
         5 000064   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000065   200010 000100                    ARG     NRES,,AUTO

      157     9007    2         CALL INDEX( NSN, ' ', PRE_RET_KEY.SN );
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:19   

   9007  5 000066   000000 124400                    SCM     mask='000'O
         5 000067   000000 600006 xsym               ADSC9   PRE_RET_KEY              cn=3,n=6
         5 000070   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000071   200011 000100                    ARG     NSN,,AUTO

      158     9008    2         CALL INDEX( NPSN, ' ', PRE_RET_KEY.PSN );

   9008  5 000072   000000 124400                    SCM     mask='000'O
         5 000073   000002 600006 xsym               ADSC9   PRE_RET_KEY+2            cn=3,n=6
         5 000074   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000075   200012 000100                    ARG     NPSN,,AUTO

      159     9009    2         CALL INDEX( NACCT, ' ', PRE_RET_KEY.ACCT );

   9009  5 000076   000000 124400                    SCM     mask='000'O
         5 000077   000004 200010 xsym               ADSC9   PRE_RET_KEY+4            cn=1,n=8
         5 000100   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000101   200013 000100                    ARG     NACCT,,AUTO

      160     9010    2         NFNAME = PRE_RET_KEY.FNAME.L;

   9010  5 000102   000016 236000 xsym               LDQ     PRE_RET_KEY+14
         5 000103   000033 772000                    QRL     27
         5 000104   200014 756100                    STQ     NFNAME,,AUTO

      161     9011    2         IF RESCHARS = 'CT'

   9011  5 000105   200003 470500                    LDP0    RES$,,AUTO
         5 000106   200010 720100                    LXL0    NRES,,AUTO
         5 000107   040000 106540                    CMPC    fill='040'O
         5 000110   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 000111   000023 000002 4                  ADSC9   IOEC+2                   cn=0,n=2
         5 000112   000124 601000 5                  TNZ     s:9013

      162     9012    2          THEN CALL BINCHAR( FSNCHARS, PRE_RET_KEY.FSN );

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:20   
   9012  5 000113   000002 236000 xsym               LDQ     PRE_RET_KEY+2
         5 000114   000011 772000                    QRL     9
         5 000115   777777 376007                    ANQ     -1,DL
         5 000116   000000 235003                    LDA     0,DU
         5 000117   200072 757100                    STAQ    @NFROM+2,,AUTO
         5 000120   000100 301500                    BTD
         5 000121   200072 000010                    NDSC9   @NFROM+2,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         5 000122   200015 030004                    NDSC9   FSNCHARS,,AUTO           cn=0,s=nosgn,sf=0,n=4
         5 000123   000134 710000 5                  TRA     s:9014

      163     9013    2          ELSE CALL BINCHAR(ODFSNCHARS, PRE_RET_KEY.FSN );

   9013  5 000124   000002 236000 xsym               LDQ     PRE_RET_KEY+2
         5 000125   000011 772000                    QRL     9
         5 000126   777777 376007                    ANQ     -1,DL
         5 000127   000000 235003                    LDA     0,DU
         5 000130   200072 757100                    STAQ    @NFROM+2,,AUTO
         5 000131   000100 301500                    BTD
         5 000132   200072 000010                    NDSC9   @NFROM+2,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         5 000133   200016 030006                    NDSC9   ODFSNCHARS,,AUTO         cn=0,s=nosgn,sf=0,n=6

      164     9014    2         IF LAST_SN ~= SNCHARS OR LAST_FSN ~= PRE_RET_KEY.FSN

   9014  5 000134   200047 471500                    LDP1    LAST_SN$,,AUTO
         5 000135   200050 721100                    LXL1    NLAST_SN,,AUTO
         5 000136   200004 473500                    LDP3    SN$,,AUTO
         5 000137   200011 722100                    LXL2    NSN,,AUTO
         5 000140   040140 106540                    CMPC    fill='040'O
         5 000141   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         5 000142   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
         5 000143   000151 601000 5                  TNZ     s:9016
         5 000144   000002 236000 xsym               LDQ     PRE_RET_KEY+2
         5 000145   000011 772000                    QRL     9
         5 000146   777777 376007                    ANQ     -1,DL
         5 000147   200051 116100                    CMPQ    LAST_FSN,,AUTO
         5 000150   000500 600000 5                  TZE     s:9056

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:21   
      165     9015    3          THEN DO;

      166     9016    3            IF CMD_LINE_CHARS$ ~= ADDR(CMD_LINE)

   9016  5 000151   200072 452500                    STP2    @NFROM+2,,AUTO
         5 000152   200072 236100                    LDQ     @NFROM+2,,AUTO
         5 000153   000021 036003                    ADLQ    17,DU
         5 000154   200046 116100                    CMPQ    CMD_LINE_CHARS$,,AUTO
         5 000155   000201 600000 5                  TZE     s:9022

      167     9017    4             THEN DO;                      /* Flush previous buffer              */

      168     9018    4               RET_CMDS_WRITE.BUF_.BOUND = POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE))-1;

   9018  5 000156   200072 452500                    STP2    @NFROM+2,,AUTO
         5 000157   200072 236100                    LDQ     @NFROM+2,,AUTO
         5 000160   000021 036003                    ADLQ    17,DU
         5 000161   000020 772000                    QRL     16
         5 000162   200073 756100                    STQ     @NFROM+3,,AUTO
         5 000163   200046 236100                    LDQ     CMD_LINE_CHARS$,,AUTO
         5 000164   000020 772000                    QRL     16
         5 000165   200073 136100                    SBLQ    @NFROM+3,,AUTO
         5 000166   000001 136007                    SBLQ    1,DL
         5 000167   000020 736000                    QLS     16
         5 000170   000110 676000 2                  ERQ     RET_CMDS_WRITE+4
         5 000171   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000172   000110 656000 2                  ERSQ    RET_CMDS_WRITE+4

      169     9019    4               CALL M$WRITE( RET_CMDS_WRITE ) ALTRET( ERRCLSALT );

   9019  5 000173   000104 630400 2                  EPPR0   RET_CMDS_WRITE
         5 000174   440001 713400                    CLIMB   alt,write
         5 000175   401400 401760                    pmme    nvectors=4
         5 000176   000570 702000 5                  TSX2    ERRCLSALT

      170     9020    4               CMD_LINE_CHARS$ = ADDR(CMD_LINE);

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:22   
   9020  5 000177   200021 630500                    EPPR0   CMD_LINE,,AUTO
         5 000200   200046 450500                    STP0    CMD_LINE_CHARS$,,AUTO

      171     9021    4               END;

      172     9022    3            IF LAST_SN ~= SNCHARS AND NLAST_SN > 0

   9022  5 000201   200047 470500                    LDP0    LAST_SN$,,AUTO
         5 000202   200050 720100                    LXL0    NLAST_SN,,AUTO
         5 000203   200004 471500                    LDP1    SN$,,AUTO
         5 000204   200011 721100                    LXL1    NSN,,AUTO
         5 000205   040140 106540                    CMPC    fill='040'O
         5 000206   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 000207   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         5 000210   000273 600000 5                  TZE     s:9032
         5 000211   200050 235100                    LDA     NLAST_SN,,AUTO
         5 000212   000273 604400 5                  TMOZ    s:9032

      173     9023    4             THEN DO;                      /* Remove previous tape               */

      174     9024    4               IF RESCHARS = 'CT'

   9024  5 000213   200003 473500                    LDP3    RES$,,AUTO
         5 000214   200010 722100                    LXL2    NRES,,AUTO
         5 000215   040000 106540                    CMPC    fill='040'O
         5 000216   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
         5 000217   000023 000002 4                  ADSC9   IOEC+2                   cn=0,n=2
         5 000220   000232 601000 5                  TNZ     s:9026

      175     9025    4                THEN CALL FLS_ADD_CHARS( ADDR(REMC), LENGTHC(REMC) ) ALTRET( ERRCLSALT
              9025                         );

   9025  5 000221   000006 236000 6                  LDQ     6
         5 000222   200074 756100                    STQ     @NFROM+4,,AUTO
         5 000223   000007 236000 6                  LDQ     7
         5 000224   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000225   200074 634500                    EPPR4   @NFROM+4,,AUTO
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:23   
         5 000226   200067 454500                    STP4    LAST_SN_CHARS+4,,AUTO
         5 000227   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000230   000570 702000 5                  TSX2    ERRCLSALT
         5 000231   000242 710000 5                  TRA     s:9027

      176     9026    4                ELSE CALL FLS_ADD_CHARS( ADDR(REMODC), LENGTHC(REMODC) ) ALTRET(
              9026                         ERRCLSALT );

   9026  5 000232   000010 236000 6                  LDQ     8
         5 000233   200075 756100                    STQ     @NFROM+5,,AUTO
         5 000234   000007 236000 6                  LDQ     7
         5 000235   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000236   200075 634500                    EPPR4   @NFROM+5,,AUTO
         5 000237   200067 454500                    STP4    LAST_SN_CHARS+4,,AUTO
         5 000240   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000241   000570 702000 5                  TSX2    ERRCLSALT

      177     9027    4               CALL FLS_ADD_CHARS( LAST_SN$, NLAST_SN ) ALTRET( ERRCLSALT );

   9027  5 000242   200050 630500                    EPPR0   NLAST_SN,,AUTO
         5 000243   200070 450500                    STP0    @FROM$+1,,AUTO
         5 000244   200047 631500                    EPPR1   LAST_SN$,,AUTO
         5 000245   200067 451500                    STP1    LAST_SN_CHARS+4,,AUTO
         5 000246   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000247   000570 702000 5                  TSX2    ERRCLSALT

      178     9028    4               RET_CMDS_WRITE.BUF_.BOUND = POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE))-1;

   9028  5 000250   200072 452500                    STP2    @NFROM+2,,AUTO
         5 000251   200072 236100                    LDQ     @NFROM+2,,AUTO
         5 000252   000021 036003                    ADLQ    17,DU
         5 000253   000020 772000                    QRL     16
         5 000254   200073 756100                    STQ     @NFROM+3,,AUTO
         5 000255   200046 236100                    LDQ     CMD_LINE_CHARS$,,AUTO
         5 000256   000020 772000                    QRL     16
         5 000257   200073 136100                    SBLQ    @NFROM+3,,AUTO
         5 000260   000001 136007                    SBLQ    1,DL
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:24   
         5 000261   000020 736000                    QLS     16
         5 000262   000110 676000 2                  ERQ     RET_CMDS_WRITE+4
         5 000263   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000264   000110 656000 2                  ERSQ    RET_CMDS_WRITE+4

      179     9029    4               CALL M$WRITE( RET_CMDS_WRITE ) ALTRET( ERRCLSALT );

   9029  5 000265   000104 630400 2                  EPPR0   RET_CMDS_WRITE
         5 000266   440001 713400                    CLIMB   alt,write
         5 000267   401400 401760                    pmme    nvectors=4
         5 000270   000570 702000 5                  TSX2    ERRCLSALT

      180     9030    4               CMD_LINE_CHARS$ = ADDR(CMD_LINE);

   9030  5 000271   200021 630500                    EPPR0   CMD_LINE,,AUTO
         5 000272   200046 450500                    STP0    CMD_LINE_CHARS$,,AUTO

      181     9031    4               END;

      182     9032    3            LAST_FSN = PRE_RET_KEY.FSN;

   9032  5 000273   000002 236000 xsym               LDQ     PRE_RET_KEY+2
         5 000274   000011 772000                    QRL     9
         5 000275   777777 376007                    ANQ     -1,DL
         5 000276   200051 756100                    STQ     LAST_FSN,,AUTO

      183     9033    3            CALL FLS_ADD_CHARS( ADDR(CMD), LENGTHC(CMD) ) ALTRET( ERRCLSALT );

   9033  5 000277   000011 236000 6                  LDQ     9
         5 000300   200076 756100                    STQ     @NFROM+6,,AUTO
         5 000301   000012 236000 6                  LDQ     10
         5 000302   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000303   200076 630500                    EPPR0   @NFROM+6,,AUTO
         5 000304   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000305   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000306   000570 702000 5                  TSX2    ERRCLSALT

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:25   
      184     9034    3            CALL FLS_ADD_CHARS( RES$, NRES )  ALTRET( ERRCLSALT );

   9034  5 000307   200010 630500                    EPPR0   NRES,,AUTO
         5 000310   200070 450500                    STP0    @FROM$+1,,AUTO
         5 000311   200003 631500                    EPPR1   RES$,,AUTO
         5 000312   200067 451500                    STP1    LAST_SN_CHARS+4,,AUTO
         5 000313   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000314   000570 702000 5                  TSX2    ERRCLSALT

      185     9035    3            CALL FLS_ADD_CHARS( ADDR(SEP), LENGTHC(SEP) )  ALTRET( ERRCLSALT );

   9035  5 000315   000013 236000 6                  LDQ     11
         5 000316   200077 756100                    STQ     @NFROM+7,,AUTO
         5 000317   000014 236000 6                  LDQ     12
         5 000320   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000321   200077 630500                    EPPR0   @NFROM+7,,AUTO
         5 000322   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000323   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000324   000570 702000 5                  TSX2    ERRCLSALT

      186     9036    3            NLAST_SN = NSN;

   9036  5 000325   200011 235100                    LDA     NSN,,AUTO
         5 000326   200050 755100                    STA     NLAST_SN,,AUTO

      187     9037    3            LAST_SN = SNCHARS;

   9037  5 000327   200004 470500                    LDP0    SN$,,AUTO
         5 000330   000000 620005                    EAX0    0,AL
         5 000331   200047 471500                    LDP1    LAST_SN$,,AUTO
         5 000332   200050 721100                    LXL1    NLAST_SN,,AUTO
         5 000333   040140 100540                    MLR     fill='040'O
         5 000334   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 000335   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      188     9038    3            CALL FLS_ADD_CHARS( SN$, NSN ) ALTRET( ERRCLSALT );

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:26   
   9038  5 000336   200011 630500                    EPPR0   NSN,,AUTO
         5 000337   200070 450500                    STP0    @FROM$+1,,AUTO
         5 000340   200004 631500                    EPPR1   SN$,,AUTO
         5 000341   200067 451500                    STP1    LAST_SN_CHARS+4,,AUTO
         5 000342   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000343   000570 702000 5                  TSX2    ERRCLSALT

      189     9039    3            CALL FLS_ADD_CHARS( ADDR(FSNC), LENGTHC(FSNC) ) ALTRET( ERRCLSALT );

   9039  5 000344   000015 236000 6                  LDQ     13
         5 000345   200100 756100                    STQ     @NFROM+8,,AUTO
         5 000346   000016 236000 6                  LDQ     14
         5 000347   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000350   200100 630500                    EPPR0   @NFROM+8,,AUTO
         5 000351   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000352   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000353   000570 702000 5                  TSX2    ERRCLSALT

      190     9040    3            IF RESCHARS = 'CT'

   9040  5 000354   200003 470500                    LDP0    RES$,,AUTO
         5 000355   200010 720100                    LXL0    NRES,,AUTO
         5 000356   040000 106540                    CMPC    fill='040'O
         5 000357   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 000360   000023 000002 4                  ADSC9   IOEC+2                   cn=0,n=2
         5 000361   000373 601000 5                  TNZ     s:9042

      191     9041    3             THEN CALL FLS_ADD_CHARS( ADDR(FSNCHARS), LENGTHC(FSNCHARS) ) ALTRET(
              9041                      ERRCLSALT );

   9041  5 000362   200015 631500                    EPPR1   FSNCHARS,,AUTO
         5 000363   200101 451500                    STP1    @NFROM+9,,AUTO
         5 000364   000017 236000 6                  LDQ     15
         5 000365   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000366   200101 633500                    EPPR3   @NFROM+9,,AUTO
         5 000367   200067 453500                    STP3    LAST_SN_CHARS+4,,AUTO
         5 000370   000662 701000 5                  TSX1    FLS_ADD_CHARS
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:27   
         5 000371   000570 702000 5                  TSX2    ERRCLSALT
         5 000372   000403 710000 5                  TRA     s:9043

      192     9042    3             ELSE CALL FLS_ADD_CHARS( ADDR(ODFSNCHARS), LENGTHC(ODFSNCHARS) ) ALTRET(
              9042                      ERRCLSALT );

   9042  5 000373   200016 631500                    EPPR1   ODFSNCHARS,,AUTO
         5 000374   200102 451500                    STP1    @NFROM+10,,AUTO
         5 000375   000020 236000 6                  LDQ     16
         5 000376   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000377   200102 633500                    EPPR3   @NFROM+10,,AUTO
         5 000400   200067 453500                    STP3    LAST_SN_CHARS+4,,AUTO
         5 000401   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000402   000570 702000 5                  TSX2    ERRCLSALT

      193     9043    3            CALL FLS_ADD_CHARS( ADDR(RPAR), LENGTHC(RPAR) ) ALTRET( ERRCLSALT );

   9043  5 000403   000021 236000 6                  LDQ     17
         5 000404   200103 756100                    STQ     @NFROM+11,,AUTO
         5 000405   000014 236000 6                  LDQ     12
         5 000406   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000407   200103 630500                    EPPR0   @NFROM+11,,AUTO
         5 000410   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000411   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000412   000570 702000 5                  TSX2    ERRCLSALT

      194     9044    3            IF PRE_RET_REC.IOERRORC

   9044  5 000413   000000 236000 xsym               LDQ     PRE_RET_REC
         5 000414   200000 316003                    CANQ    65536,DU
         5 000415   000436 600000 5                  TZE     s:9049

      195     9045    4             THEN DO;

      196     9046    4               CALL FLS_ADD_CHARS( ADDR(COMMA), LENGTHC(COMMA) ) ALTRET( ERRCLSALT );

   9046  5 000416   000022 236000 6                  LDQ     18
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:28   
         5 000417   200104 756100                    STQ     @NFROM+12,,AUTO
         5 000420   000014 236000 6                  LDQ     12
         5 000421   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000422   200104 630500                    EPPR0   @NFROM+12,,AUTO
         5 000423   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000424   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000425   000570 702000 5                  TSX2    ERRCLSALT

      197     9047    4               CALL FLS_ADD_CHARS( ADDR(IOEC), LENGTHC(IOEC) ) ALTRET(ERRCLSALT);

   9047  5 000426   000023 236000 6                  LDQ     19
         5 000427   200105 756100                    STQ     @NFROM+13,,AUTO
         5 000430   000024 236000 6                  LDQ     20
         5 000431   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000432   200105 630500                    EPPR0   @NFROM+13,,AUTO
         5 000433   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000434   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000435   000570 702000 5                  TSX2    ERRCLSALT

      198     9048    4               END;

      199     9049    3            CALL FLS_ADD_CHARS( ADDR(RPAR), LENGTHC(RPAR) ) ALTRET( ERRCLSALT );

   9049  5 000436   000021 236000 6                  LDQ     17
         5 000437   200106 756100                    STQ     @NFROM+14,,AUTO
         5 000440   000014 236000 6                  LDQ     12
         5 000441   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000442   200106 630500                    EPPR0   @NFROM+14,,AUTO
         5 000443   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000444   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000445   000570 702000 5                  TSX2    ERRCLSALT

      200     9050    3            CALL FLS_ADD_CHARS( ADDR(PSNC), LENGTHC(PSNC) ) ALTRET( ERRCLSALT );

   9050  5 000446   000025 236000 6                  LDQ     21
         5 000447   200107 756100                    STQ     @NFROM+15,,AUTO
         5 000450   000017 236000 6                  LDQ     15
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:29   
         5 000451   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000452   200107 630500                    EPPR0   @NFROM+15,,AUTO
         5 000453   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000454   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000455   000570 702000 5                  TSX2    ERRCLSALT

      201     9051    3            CALL FLS_ADD_CHARS( PSN$, NPSN ) ALTRET( ERRCLSALT );

   9051  5 000456   200012 630500                    EPPR0   NPSN,,AUTO
         5 000457   200070 450500                    STP0    @FROM$+1,,AUTO
         5 000460   200005 631500                    EPPR1   PSN$,,AUTO
         5 000461   200067 451500                    STP1    LAST_SN_CHARS+4,,AUTO
         5 000462   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000463   000570 702000 5                  TSX2    ERRCLSALT

      202     9052    3            CALL FLS_ADD_CHARS( ADDR(SLASH), LENGTHC(SLASH) ) ALTRET( ERRCLSALT );

   9052  5 000464   000026 236000 6                  LDQ     22
         5 000465   200110 756100                    STQ     @NFROM+16,,AUTO
         5 000466   000014 236000 6                  LDQ     12
         5 000467   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000470   200110 630500                    EPPR0   @NFROM+16,,AUTO
         5 000471   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000472   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000473   000570 702000 5                  TSX2    ERRCLSALT

      203     9053    3            SAW_FILE = '0'B;

   9053  5 000474   200062 450100                    STZ     SAW_FILE,,AUTO

      204     9054    3            LASTACCT_CHARS = ' ';

   9054  5 000475   000035 235000 xsym               LDA     B_VECTNIL+29
         5 000476   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000477   200054 757100                    STAQ    LASTACCT_CHARS,,AUTO

      205     9055    3            END;
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:30   

      206     9056    2         IF SAW_FILE

   9056  5 000500   200062 234100                    SZN     SAW_FILE,,AUTO
         5 000501   000512 605000 5                  TPL     s:9060

      207     9057    3          THEN DO;

      208     9058    3            CALL FLS_ADD_CHARS( ADDR(COMMA), LENGTHC(COMMA) ) ALTRET( ERRCLSALT );

   9058  5 000502   000022 236000 6                  LDQ     18
         5 000503   200111 756100                    STQ     @NFROM+17,,AUTO
         5 000504   000014 236000 6                  LDQ     12
         5 000505   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000506   200111 630500                    EPPR0   @NFROM+17,,AUTO
         5 000507   200067 450500                    STP0    LAST_SN_CHARS+4,,AUTO
         5 000510   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000511   000570 702000 5                  TSX2    ERRCLSALT

      209     9059    3            END;

      210     9060    2         CALL FLS_ADD_CHARS( FNAME$, NFNAME ) ALTRET( ERRCLSALT );

   9060  5 000512   200014 630500                    EPPR0   NFNAME,,AUTO
         5 000513   200070 450500                    STP0    @FROM$+1,,AUTO
         5 000514   200007 631500                    EPPR1   FNAME$,,AUTO
         5 000515   200067 451500                    STP1    LAST_SN_CHARS+4,,AUTO
         5 000516   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000517   000570 702000 5                  TSX2    ERRCLSALT

      211     9061    2         SAW_FILE = '1'B;

   9061  5 000520   400000 236003                    LDQ     -131072,DU
         5 000521   200062 756100                    STQ     SAW_FILE,,AUTO

      212     9062    2         IF LASTACCT ~= ACCTCHARS

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:31   
   9062  5 000522   200052 470500                    LDP0    LASTACCT$,,AUTO
         5 000523   200053 720100                    LXL0    NLASTACCT,,AUTO
         5 000524   200006 471500                    LDP1    ACCT$,,AUTO
         5 000525   200013 721100                    LXL1    NACCT,,AUTO
         5 000526   040140 106540                    CMPC    fill='040'O
         5 000527   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 000530   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         5 000531   000056 600000 5                  TZE     s:9005

      213     9063    3          THEN DO;

      214     9064    3            CALL FLS_ADD_CHARS( ADDR(DOT), LENGTHC(DOT) ) ALTRET( ERRCLSALT );

   9064  5 000532   000027 236000 6                  LDQ     23
         5 000533   200112 756100                    STQ     @NFROM+18,,AUTO
         5 000534   000014 236000 6                  LDQ     12
         5 000535   200070 756100                    STQ     @FROM$+1,,AUTO
         5 000536   200112 633500                    EPPR3   @NFROM+18,,AUTO
         5 000537   200067 453500                    STP3    LAST_SN_CHARS+4,,AUTO
         5 000540   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000541   000570 702000 5                  TSX2    ERRCLSALT

      215     9065    3            CALL FLS_ADD_CHARS( ACCT$, NACCT ) ALTRET( ERRCLSALT );

   9065  5 000542   200013 630500                    EPPR0   NACCT,,AUTO
         5 000543   200070 450500                    STP0    @FROM$+1,,AUTO
         5 000544   200006 631500                    EPPR1   ACCT$,,AUTO
         5 000545   200067 451500                    STP1    LAST_SN_CHARS+4,,AUTO
         5 000546   000662 701000 5                  TSX1    FLS_ADD_CHARS
         5 000547   000570 702000 5                  TSX2    ERRCLSALT

      216     9066    3            NLASTACCT = NACCT;

   9066  5 000550   200013 235100                    LDA     NACCT,,AUTO
         5 000551   200053 755100                    STA     NLASTACCT,,AUTO

      217     9067    3            LASTACCT = ACCTCHARS;
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:32   

   9067  5 000552   200006 470500                    LDP0    ACCT$,,AUTO
         5 000553   000000 620005                    EAX0    0,AL
         5 000554   200052 471500                    LDP1    LASTACCT$,,AUTO
         5 000555   200053 721100                    LXL1    NLASTACCT,,AUTO
         5 000556   040140 100540                    MLR     fill='040'O
         5 000557   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 000560   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      218     9068    3            END;

      219     9069    2         END;

   9069  5 000561   000056 710000 5                  TRA     s:9005

   9067  5 000562                       CHKEOF       null
      220     9070
      221     9071    1   CHKEOF: ;
      222     9072    1      IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF

   9072  5 000562   000000 470400 xsym               LDP0    B$TCB$
         5 000563   000000 471500                    LDP1    0,,PR0
         5 000564   100102 236100                    LDQ     66,,PR1
         5 000565   377770 376007                    ANQ     131064,DL
         5 000566   000060 116007                    CMPQ    48,DL
         5 000567   000606 600000 5                  TZE     s:9085

      223     9073    2       THEN DO;

   9072  5 000570                       ERRCLSALT    null
      224     9074    2   ERRCLSALT: ;
      225     9075    2         CALL FLI$RPT_ERR;

   9075  5 000570   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000571   000000 701000 xent               TSX1    FLI$RPT_ERR
         5 000572   000000 011000                    NOP     0

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:33   
      226     9076    2         CALL M$CLOSE( PRE_RET_CLOSE )

   9076  5 000573   000000 630400 xsym               EPPR0   PRE_RET_CLOSE
         5 000574   450001 713400                    CLIMB   alt,close
         5 000575   406000 401760                    pmme    nvectors=13
         5 000576   000600 702000 5                  TSX2    s:9079
         5 000577   000600 710000 5                  TRA     s:9079

      227     9077    3          WHENALTRETURN DO;

      228     9078    3            END;

      229     9079    2         CALL M$CLOSE( RET_CMDS_CLOSE )

   9079  5 000600   000120 630400 2                  EPPR0   RET_CMDS_CLOSE
         5 000601   450001 713400                    CLIMB   alt,close
         5 000602   406000 401760                    pmme    nvectors=13
         5 000603   000605 702000 5                  TSX2    s:9082
         5 000604   000605 710000 5                  TRA     s:9082

      230     9080    3          WHENALTRETURN DO;

      231     9081    3            END;

      232     9082    2         ALTRETURN;

   9082  5 000605   000000 702200 xent               TSX2  ! X66_AALT

      233     9083    2         END;
      234     9084
      235     9085    1      IF CMD_LINE_CHARS$ ~= ADDR(CMD_LINE)

   9085  5 000606   200072 452500                    STP2    @NFROM+2,,AUTO
         5 000607   200072 236100                    LDQ     @NFROM+2,,AUTO
         5 000610   000021 036003                    ADLQ    17,DU
         5 000611   200046 116100                    CMPQ    CMD_LINE_CHARS$,,AUTO
         5 000612   000636 600000 5                  TZE     s:9091
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:34   

      236     9086    2       THEN DO;                            /* Flush previous buffer              */

      237     9087    2         RET_CMDS_WRITE.BUF_.BOUND = POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE))-1;

   9087  5 000613   200072 452500                    STP2    @NFROM+2,,AUTO
         5 000614   200072 236100                    LDQ     @NFROM+2,,AUTO
         5 000615   000021 036003                    ADLQ    17,DU
         5 000616   000020 772000                    QRL     16
         5 000617   200073 756100                    STQ     @NFROM+3,,AUTO
         5 000620   200046 236100                    LDQ     CMD_LINE_CHARS$,,AUTO
         5 000621   000020 772000                    QRL     16
         5 000622   200073 136100                    SBLQ    @NFROM+3,,AUTO
         5 000623   000001 136007                    SBLQ    1,DL
         5 000624   000020 736000                    QLS     16
         5 000625   000110 676000 2                  ERQ     RET_CMDS_WRITE+4
         5 000626   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000627   000110 656000 2                  ERSQ    RET_CMDS_WRITE+4

      238     9088    2         CALL M$WRITE( RET_CMDS_WRITE ) ALTRET( ERRCLSALT );

   9088  5 000630   000104 630400 2                  EPPR0   RET_CMDS_WRITE
         5 000631   440001 713400                    CLIMB   alt,write
         5 000632   401400 401760                    pmme    nvectors=4
         5 000633   000570 702000 5                  TSX2    ERRCLSALT

      239     9089    2         CMD_LINE_CHARS$ = ADDR(CMD_LINE);

   9089  5 000634   200021 630500                    EPPR0   CMD_LINE,,AUTO
         5 000635   200046 450500                    STP0    CMD_LINE_CHARS$,,AUTO

      240     9090    2         END;

      241     9091    1      CALL M$CLOSE( PRE_RET_CLOSE )

   9091  5 000636   000000 630400 xsym               EPPR0   PRE_RET_CLOSE
         5 000637   450001 713400                    CLIMB   alt,close
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:35   
         5 000640   406000 401760                    pmme    nvectors=13
         5 000641   000643 702000 5                  TSX2    s:9093
         5 000642   000654 710000 5                  TRA     s:9100

      242     9092    2       WHENALTRETURN DO;

      243     9093    2         CALL FLI$RPT_ERR;

   9093  5 000643   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000644   000000 701000 xent               TSX1    FLI$RPT_ERR
         5 000645   000000 011000                    NOP     0

      244     9094    2         CALL M$CLOSE( RET_CMDS_CLOSE )

   9094  5 000646   000120 630400 2                  EPPR0   RET_CMDS_CLOSE
         5 000647   450001 713400                    CLIMB   alt,close
         5 000650   406000 401760                    pmme    nvectors=13
         5 000651   000653 702000 5                  TSX2    s:9097
         5 000652   000653 710000 5                  TRA     s:9097

      245     9095    3          WHENALTRETURN DO;

      246     9096    3            END;

      247     9097    2         ALTRETURN;

   9097  5 000653   000000 702200 xent               TSX2  ! X66_AALT

      248     9098    2         END;
      249     9099
      250     9100    1      CALL M$CLOSE( RET_CMDS_CLOSE )

   9100  5 000654   000120 630400 2                  EPPR0   RET_CMDS_CLOSE
         5 000655   450001 713400                    CLIMB   alt,close
         5 000656   406000 401760                    pmme    nvectors=13
         5 000657   000661 702000 5                  TSX2    s:9105
         5 000660   000661 710000 5                  TRA     s:9105
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:36   

      251     9101    2       WHENALTRETURN DO;

      252     9102    2         END;

      253     9103
      254     9104
      255     9105    1      RETURN;

   9105  5 000661   000000 702200 xent               TSX2  ! X66_ARET

      256     9106
      257     9107    1   FLS_ADD_CHARS: PROC( FROM$, NFROM ) ALTRET;

   9107  5 000662   200066 741300       FLS_ADD_CHA* STX1  ! LAST_SN_CHARS+3,,AUTO

      258     9108
      259     9109    2   DCL FROM$ PTR;
      260     9110    2   DCL NFROM SBIN;
      261     9111
      262     9112        /***
      263     9113         *** BASED:
      264     9114         ***/
      265     9115
      266     9116    2   DCL TO_CHARS CHAR(NFROM) BASED(CMD_LINE_CHARS$) CALIGNED;
      267     9117    2   DCL TO1_CHAR CHAR(1) BASED(CMD_LINE_CHARS$) CALIGNED;
      268     9118    2   DCL FROM_CHARS CHAR(NFROM) BASED(FROM$) CALIGNED;
      269     9119
      270     9120        /********************/
      271     9121
      272     9122    2      IF NFROM+POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE))>=LENGTHV(CMD_LINE)

   9122  5 000663   200072 452500                    STP2    @NFROM+2,,AUTO
         5 000664   200072 236100                    LDQ     @NFROM+2,,AUTO
         5 000665   000021 036003                    ADLQ    17,DU
         5 000666   000020 772000                    QRL     16
         5 000667   200073 756100                    STQ     @NFROM+3,,AUTO
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:37   
         5 000670   200046 236100                    LDQ     CMD_LINE_CHARS$,,AUTO
         5 000671   000020 772000                    QRL     16
         5 000672   200073 136100                    SBLQ    @NFROM+3,,AUTO
         5 000673   200070 470500                    LDP0    @NFROM,,AUTO
         5 000674   000000 036100                    ADLQ    0,,PR0
         5 000675   000117 116007                    CMPQ    79,DL
         5 000676   000725 604000 5                  TMI     s:9129

      273     9123    3       THEN DO;

      274     9124    3         RET_CMDS_WRITE.BUF_.BOUND = POFFC(CMD_LINE_CHARS$,ADDR(CMD_LINE));

   9124  5 000677   200072 452500                    STP2    @NFROM+2,,AUTO
         5 000700   200072 236100                    LDQ     @NFROM+2,,AUTO
         5 000701   000021 036003                    ADLQ    17,DU
         5 000702   000020 772000                    QRL     16
         5 000703   200073 756100                    STQ     @NFROM+3,,AUTO
         5 000704   200046 236100                    LDQ     CMD_LINE_CHARS$,,AUTO
         5 000705   000020 772000                    QRL     16
         5 000706   200073 136100                    SBLQ    @NFROM+3,,AUTO
         5 000707   000020 736000                    QLS     16
         5 000710   000110 676000 2                  ERQ     RET_CMDS_WRITE+4
         5 000711   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000712   000110 656000 2                  ERSQ    RET_CMDS_WRITE+4

      275     9125    3         TO1_CHAR = ';';                   /* Continuation                       */

   9125  5 000713   200046 471500                    LDP1    CMD_LINE_CHARS$,,AUTO
         5 000714   040100 100400                    MLR     fill='040'O
         5 000715   000030 000001 6                  ADSC9   24                       cn=0,n=1
         5 000716   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      276     9126    3         CALL M$WRITE( RET_CMDS_WRITE ) ALTRET( JUSTALT );

   9126  5 000717   000104 630400 2                  EPPR0   RET_CMDS_WRITE
         5 000720   440001 713400                    CLIMB   alt,write
         5 000721   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:38   
         5 000722   000743 702000 5                  TSX2    JUSTALT

      277     9127    3         CMD_LINE_CHARS$ = ADDR(CMD_LINE);

   9127  5 000723   200021 630500                    EPPR0   CMD_LINE,,AUTO
         5 000724   200046 450500                    STP0    CMD_LINE_CHARS$,,AUTO

      278     9128    3         END;

      279     9129    2      TO_CHARS = FROM_CHARS;

   9129  5 000725   200070 470500                    LDP0    @NFROM,,AUTO
         5 000726   000000 720100                    LXL0    0,,PR0
         5 000727   200067 471500                    LDP1    @FROM$,,AUTO
         5 000730   100000 473500                    LDP3    0,,PR1
         5 000731   200046 474500                    LDP4    CMD_LINE_CHARS$,,AUTO
         5 000732   040140 100540                    MLR     fill='040'O
         5 000733   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         5 000734   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

      280     9130    2      CMD_LINE_CHARS$ = PINCRC( CMD_LINE_CHARS$, NFROM );

   9130  5 000735   000000 236100                    LDQ     0,,PR0
         5 000736   000020 736000                    QLS     16
         5 000737   200046 036100                    ADLQ    CMD_LINE_CHARS$,,AUTO
         5 000740   200046 756100                    STQ     CMD_LINE_CHARS$,,AUTO

      281     9131    2      RETURN;

   9131  5 000741   200066 221300                    LDX1  ! LAST_SN_CHARS+3,,AUTO
         5 000742   000001 702211                    TSX2  ! 1,X1

   9130  5 000743                       JUSTALT      null
      282     9132
      283     9133    2   JUSTALT: ;
      284     9134    2      ALTRETURN;

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:39   
   9134  5 000743   200066 221300                    LDX1  ! LAST_SN_CHARS+3,,AUTO
         5 000744   000000 702211                    TSX2  ! 0,X1
      285     9135
      286     9136    2   END FLS_ADD_CHARS;
      287     9137
      288     9138    1   END FLS$PROCESS_PRE_RET;
      289     9139        %EOD;

PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:40   
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLS$PROCESS_PRE_RET.
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:41   

 **** Variables and constants ****

  ****  Section 002  Data  FLS$PROCESS_PRE_RET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   120-0-0/d STRC(1080)  r     1 RET_CMDS_CLOSE             6-0-0/c STRC(90)    r     1 RET_CMDS_FNAME
    12-0-0/d STRC(2088)  r     1 RET_CMDS_OPEN            104-0-0/d STRC(432)   r     1 RET_CMDS_WRITE

  ****  Section 004 RoData FLS$PROCESS_PRE_RET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(9)     r     1 CMD                       20-0-0/c CHAR        r     1 COMMA
    11-0-0/c CHAR        r     1 DOT                        4-0-0/c CHAR(5)     r     1 FSNC
    21-0-0/c CHAR(7)     r     1 IOEC                       7-0-0/c CHAR(4)     r     1 PSNC
    12-0-0/c CHAR(10)    r     1 REMC                      15-0-0/c CHAR(10)    r     1 REMODC
     6-0-0/c CHAR        r     1 RPAR                       3-0-0/c CHAR        r     1 SEP
    10-0-0/c CHAR        r     1 SLASH

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    67-0-0/w PTR         r     1 @FROM$                    70-0-0/w PTR         r     1 @NFROM
     6-0-0/w PTR         r     1 ACCT$                     21-0-0/c CHAR(80)    r     1 CMD_LINE
    46-0-0/w PTR         r     1 CMD_LINE_CHARS$            7-0-0/w PTR         r     1 FNAME$
    *0-0-0/w PTR         r     1 FROM$                     15-0-0/c CHAR(4)     r     1 FSNCHARS
    52-0-0/w PTR         r     1 LASTACCT$                 54-0-0/c CHAR(8)     r     1 LASTACCT_CHARS
    51-0-0/w SBIN        r     1 LAST_FSN                  47-0-0/w PTR         r     1 LAST_SN$
    63-0-0/c CHAR(6)     r     1 LAST_SN_CHARS             13-0-0/w SBIN        r     1 NACCT
    14-0-0/w SBIN        r     1 NFNAME                    *0-0-0/w SBIN        r     1 NFROM
    53-0-0/w SBIN        r     1 NLASTACCT                 50-0-0/w SBIN        r     1 NLAST_SN
    12-0-0/w SBIN        r     1 NPSN                      10-0-0/w SBIN        r     1 NRES
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:42   
    11-0-0/w SBIN        r     1 NSN                       16-0-0/c CHAR(6)     r     1 ODFSNCHARS
     5-0-0/w PTR         r     1 PSN$                       3-0-0/w PTR         r     1 RES$
    62-0-0/b BIT         r     1 SAW_FILE                  60-0-0/w PTR         r     1 SECOND_SN$
    56-0-0/c CHAR(6)     r     1 SECOND_SN_CHARS            4-0-0/w PTR         r     1 SN$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 DISK_FILE_SPEC$
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/d STRC(1080)  r     1 PRE_RET_CLOSE              0-0-0/c STRC(513)   r     1 PRE_RET_KEY
     0-0-0/d STRC(2088)  r     1 PRE_RET_OPEN               0-0-0/d STRC(504)   r     1 PRE_RET_READ
     0-0-0/b STRC(9)     r     1 PRE_RET_REC                0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w PTR         r     1 TAPE_DCBLIST$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 ACCTCHARS                  0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 FROM_CHARS
     0-0-0/c ACHR        r     1 LASTACCT                   0-0-0/c ACHR        r     1 LAST_SN
     0-0-0N  NULL        r     1 M$DISK00                   0-0-0/c ACHR        r     1 RESCHARS
     0-0-0/c ACHR        r     1 SNCHARS                    0-0-0/c CHAR        r     1 TO1_CHAR
     0-0-0/c ACHR        r     1 TO_CHARS


   Procedure FLS$PROCESS_PRE_RET requires 485 words for executable code.
   Procedure FLS$PROCESS_PRE_RET requires 76 words of local(AUTO) storage.
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:43   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:44   
          MINI XREF LISTING

ACCT$
      8676**DCL      8708--IMP-PTR  8986<<ASSIGN   9062>>IF       9065<>CALL     9067>>ASSIGN
ACCTCHARS
      8708**DCL      9062>>IF       9067>>ASSIGN
B$ALT.CODE
      8717**DCL      8717--REDEF    8718--REDEF    8718--REDEF
B$ALT.ERR.CODE
      8719**DCL      9072>>IF
B$ALT.ERR.ERR#
      8719**DCL      8719--REDEF
B$ALT.EVID
      8718**DCL      8718--REDEF    8718--REDEF
B$TCB.ALT$
      8713**DCL      9072>>IF
B$TCB$
      8173**DCL      9072>>IF
CHKEOF
      9067**LABEL    9005--CALLALT
CMD
      8728**DCL      9033--CALL     9033--CALL
CMD_LINE
      8686**DCL      8992--ASSIGN   8996--ASSIGN   9016--IF       9018--ASSIGN   9020--ASSIGN   9028--ASSIGN
      9030--ASSIGN   9085--IF       9087--ASSIGN   9089--ASSIGN   9122--IF       9122--IF       9124--ASSIGN
      9127--ASSIGN
CMD_LINE_CHARS$
      8688**DCL      8996<<ASSIGN   9016>>IF       9018>>ASSIGN   9020<<ASSIGN   9028>>ASSIGN   9030<<ASSIGN
      9085>>IF       9087>>ASSIGN   9089<<ASSIGN   9116--IMP-PTR  9117--IMP-PTR  9122>>IF       9124>>ASSIGN
      9125>>ASSIGN   9127<<ASSIGN   9129>>ASSIGN   9130<<ASSIGN   9130>>ASSIGN
COMMA
      8737**DCL      9046--CALL     9046--CALL     9058--CALL     9058--CALL
DISK_CLOSE.SN_
      7853**DCL      7853--REDEF
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:45   
DISK_CLOSE.UTL_
      7854**DCL      7854--REDEF
DISK_CLOSE.V.EXPIRE#
      7868**DCL      7868--REDEF
DISK_CLOSE.V.TYPE#
      7866**DCL      7866--REDEF
DISK_CLOSE.V.XTNSIZE#
      7863**DCL      7863--REDEF    7865--REDEF
DISK_FILE_SPEC.SPEC
      8218**DCL      8220--REDEF
DISK_FILE_SPEC.SPEC.START
      8219**DCL      8219--REDEF
DISK_FILE_SPEC.SPEC.STOP
      8220**DCL      8220--REDEF
DISK_FILE_SPEC$
      8217**DCL      8218--IMP-PTR
DISK_OPEN.ACSVEH_
      7718**DCL      7719--REDEF
DISK_OPEN.ALTKEYS_
      7724**DCL      7725--REDEF    7725--REDEF
DISK_OPEN.HDR_
      7723**DCL      7724--REDEF
DISK_OPEN.TAB_
      7722**DCL      7723--REDEF
DISK_OPEN.UHL_
      7716**DCL      7717--REDEF    7717--REDEF
DISK_OPEN.V.FSN#
      7756**DCL      7756--REDEF    7756--REDEF
DISK_OPEN.WSN_
      7722**DCL      7722--REDEF
DISK_READ.STATION_
      7780**DCL      7781--REDEF
DISK_READ.V.DVBYTE.REREAD#
      7792**DCL      7792--REDEF
DISK_READ.V.INDX#
      7790**DCL      7790--REDEF
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:46   
DISK_WRITE.STATION_
      7818**DCL      7818--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      7825**DCL      7825--REDEF
DOT
      8734**DCL      9064--CALL     9064--CALL
DPLIST$
      8203**DCL      8215--IMP-PTR
DPRESLIST$
      8217**DCL      8217--IMP-PTR
EFTWORD
      8338**DCL      8338--REDEF
ERRCLSALT
      9072**LABEL    9019--CALLALT  9025--CALLALT  9026--CALLALT  9027--CALLALT  9029--CALLALT  9033--CALLALT
      9034--CALLALT  9035--CALLALT  9038--CALLALT  9039--CALLALT  9041--CALLALT  9042--CALLALT  9043--CALLALT
      9046--CALLALT  9047--CALLALT  9049--CALLALT  9050--CALLALT  9051--CALLALT  9052--CALLALT  9058--CALLALT
      9060--CALLALT  9064--CALLALT  9065--CALLALT  9088--CALLALT
FLI$RPT_ERR
      8667**DCL-ENT  8973--CALL     9075--CALL     9093--CALL
FLS_ADD_CHARS
      9107**PROC     9025--CALL     9026--CALL     9027--CALL     9033--CALL     9034--CALL     9035--CALL
      9038--CALL     9039--CALL     9041--CALL     9042--CALL     9043--CALL     9046--CALL     9047--CALL
      9049--CALL     9050--CALL     9051--CALL     9052--CALL     9058--CALL     9060--CALL     9064--CALL
      9065--CALL
FNAME$
      8677**DCL      8709--IMP-PTR  8987<<ASSIGN   9060<>CALL
FPT_EXIT.V.STEPCC#
      7643**DCL      7643--REDEF
FROM$ IN PROCEDURE FLS_ADD_CHARS
      9109**DCL      9107--PROC     9118--IMP-PTR  9129>>ASSIGN
FROM_CHARS IN PROCEDURE FLS_ADD_CHARS
      9118**DCL      9129>>ASSIGN
FSNC
      8730**DCL      9039--CALL     9039--CALL
FSNCHARS
      8683**DCL      9012<<CALLBLT  9041--CALL     9041--CALL
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:47   
IOEC
      8738**DCL      9047--CALL     9047--CALL
JUSTALT IN PROCEDURE FLS_ADD_CHARS
      9130**LABEL    9126--CALLALT
LASTACCT
      8711**DCL      9062>>IF       9067<<ASSIGN
LASTACCT$
      8692**DCL      8711--IMP-PTR  8988<<ASSIGN   9062>>IF       9067>>ASSIGN
LASTACCT_CHARS
      8694**DCL      8988--ASSIGN   8989<<ASSIGN   9054<<ASSIGN
LAST_FSN
      8691**DCL      8993<<ASSIGN   9014>>IF       9032<<ASSIGN
LAST_SN
      8710**DCL      9014>>IF       9022>>IF       9037<<ASSIGN
LAST_SN$
      8689**DCL      8710--IMP-PTR  8994<<ASSIGN   9014>>IF       9022>>IF       9027<>CALL     9037>>ASSIGN
LAST_SN_CHARS
      8699**DCL      8994--ASSIGN
M$CLOSE
      6630**DCL-ENT  9076--CALL     9079--CALL     9091--CALL     9094--CALL     9100--CALL
M$OPEN
      6630**DCL-ENT  8970--CALL     8977--CALL
M$READ
      6631**DCL-ENT  9005--CALL
M$WRITE
      6631**DCL-ENT  9019--CALL     9029--CALL     9088--CALL     9126--CALL
NACCT
      8681**DCL      8708--IMP-SIZ  9009<<CALLBLT  9062>>IF       9065<>CALL     9066>>ASSIGN   9067>>ASSIGN
NFNAME
      8682**DCL      8709--IMP-SIZ  9010<<ASSIGN   9060<>CALL
NFROM IN PROCEDURE FLS_ADD_CHARS
      9110**DCL      9107--PROC     9116--IMP-SIZ  9118--IMP-SIZ  9122>>IF       9129>>ASSIGN   9129>>ASSIGN
      9130>>ASSIGN
NLASTACCT
      8693**DCL      8711--IMP-SIZ  8990<<ASSIGN   9062>>IF       9066<<ASSIGN   9067>>ASSIGN
NLAST_SN
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:48   
      8690**DCL      8710--IMP-SIZ  8995<<ASSIGN   9014>>IF       9022>>IF       9022>>IF       9027<>CALL
      9036<<ASSIGN   9037>>ASSIGN
NPSN
      8680**DCL      8707--IMP-SIZ  9008<<CALLBLT  9051<>CALL
NRES
      8678**DCL      8705--IMP-SIZ  9006<<CALLBLT  9011>>IF       9024>>IF       9034<>CALL     9040>>IF
NSN
      8679**DCL      8706--IMP-SIZ  9007<<CALLBLT  9014>>IF       9022>>IF       9036>>ASSIGN   9037>>ASSIGN
      9038<>CALL
ODFSNCHARS
      8684**DCL      9013<<CALLBLT  9042--CALL     9042--CALL
PRE_RET_CLOSE
      8581**DCL      9076<>CALL     9091<>CALL
PRE_RET_CLOSE.SN_
      8581**DCL      8581--REDEF
PRE_RET_CLOSE.UTL_
      8582**DCL      8582--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      8596**DCL      8596--REDEF
PRE_RET_CLOSE.V.TYPE#
      8594**DCL      8594--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      8591**DCL      8591--REDEF    8593--REDEF
PRE_RET_KEY.ACCT
      8349**DCL      8986--ASSIGN   9009>>CALLBLT
PRE_RET_KEY.FNAME
      8349**DCL      8987--ASSIGN
PRE_RET_KEY.FNAME.L
      8349**DCL      9010>>ASSIGN
PRE_RET_KEY.FSN
      8349**DCL      9012>>CALLBLT  9013>>CALLBLT  9014>>IF       9032>>ASSIGN
PRE_RET_KEY.PSN
      8349**DCL      8985--ASSIGN   9008>>CALLBLT
PRE_RET_KEY.RES
      8348**DCL      8983--ASSIGN   9006>>CALLBLT
PRE_RET_KEY.SN
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:49   
      8349**DCL      8984--ASSIGN   9007>>CALLBLT
PRE_RET_OPEN
      8514**DCL      8970<>CALL
PRE_RET_OPEN.ACSVEH_
      8516**DCL      8517--REDEF
PRE_RET_OPEN.ALTKEYS_
      8522**DCL      8523--REDEF    8523--REDEF
PRE_RET_OPEN.HDR_
      8521**DCL      8522--REDEF
PRE_RET_OPEN.TAB_
      8520**DCL      8521--REDEF
PRE_RET_OPEN.UHL_
      8514**DCL      8515--REDEF    8515--REDEF
PRE_RET_OPEN.V.FSN#
      8554**DCL      8554--REDEF    8554--REDEF
PRE_RET_OPEN.V.FUN#
      8533**DCL      8969<<ASSIGN
PRE_RET_OPEN.WSN_
      8520**DCL      8520--REDEF
PRE_RET_READ
      8368**DCL      9005<>CALL
PRE_RET_READ.STATION_
      8371**DCL      8372--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      8383**DCL      8383--REDEF
PRE_RET_READ.V.INDX#
      8381**DCL      8381--REDEF
PRE_RET_REC.IOERRORC
      8350**DCL      9044>>IF
PRE_RET_WRITE.STATION_
      8409**DCL      8409--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      8416**DCL      8416--REDEF
PSN$
      8675**DCL      8707--IMP-PTR  8985<<ASSIGN   9051<>CALL
PSNC
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:50   
      8732**DCL      9050--CALL     9050--CALL
REMC
      8735**DCL      9025--CALL     9025--CALL
REMODC
      8736**DCL      9026--CALL     9026--CALL
REPERRALT
      8964**LABEL    8977--CALLALT
RES$
      8673**DCL      8705--IMP-PTR  8983<<ASSIGN   9011>>IF       9024>>IF       9034<>CALL     9040>>IF
RESCHARS
      8705**DCL      9011>>IF       9024>>IF       9040>>IF
RET_CMDS_CLOSE
      8947**DCL      9079<>CALL     9094<>CALL     9100<>CALL
RET_CMDS_CLOSE.SN_
      8947**DCL      8947--REDEF
RET_CMDS_CLOSE.UTL_
      8948**DCL      8948--REDEF
RET_CMDS_CLOSE.V
      8952**DCL      8947--DCLINIT
RET_CMDS_CLOSE.V.EXPIRE#
      8962**DCL      8962--REDEF
RET_CMDS_CLOSE.V.TYPE#
      8960**DCL      8960--REDEF
RET_CMDS_CLOSE.V.XTNSIZE#
      8957**DCL      8957--REDEF    8959--REDEF
RET_CMDS_FNAME
      8770**DCL      8846--DCLINIT
RET_CMDS_NAME.L#
      8625**DCL      8625--IMP-SIZ
RET_CMDS_OPEN
      8845**DCL      8977<>CALL
RET_CMDS_OPEN.ACSVEH_
      8847**DCL      8848--REDEF
RET_CMDS_OPEN.ALTKEYS_
      8853**DCL      8854--REDEF    8854--REDEF
RET_CMDS_OPEN.HDR_
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:51   
      8852**DCL      8853--REDEF
RET_CMDS_OPEN.TAB_
      8851**DCL      8852--REDEF
RET_CMDS_OPEN.UHL_
      8845**DCL      8846--REDEF    8846--REDEF
RET_CMDS_OPEN.V
      8854**DCL      8845--DCLINIT
RET_CMDS_OPEN.V.FSN#
      8885**DCL      8885--REDEF    8885--REDEF
RET_CMDS_OPEN.WSN_
      8851**DCL      8851--REDEF
RET_CMDS_WRITE
      8908**DCL      9019<>CALL     9029<>CALL     9088<>CALL     9126<>CALL
RET_CMDS_WRITE.BUF_
      8908**DCL      8992<<ASSIGN
RET_CMDS_WRITE.BUF_.BOUND
      8908**DCL      9018<<ASSIGN   9028<<ASSIGN   9087<<ASSIGN   9124<<ASSIGN
RET_CMDS_WRITE.STATION_
      8910**DCL      8910--REDEF
RET_CMDS_WRITE.V
      8911**DCL      8908--DCLINIT
RET_CMDS_WRITE.V.DVBYTE.VFC#
      8917**DCL      8917--REDEF
RPAR
      8731**DCL      9043--CALL     9043--CALL     9049--CALL     9049--CALL
SAW_FILE
      8698**DCL      9053<<ASSIGN   9056>>IF       9061<<ASSIGN
SECOND_SN$
      8696**DCL      8997<<ASSIGN
SECOND_SN_CHARS
      8695**DCL      8997--ASSIGN
SEP
      8729**DCL      9035--CALL     9035--CALL
SLASH
      8733**DCL      9052--CALL     9052--CALL
SN$
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:52   
      8674**DCL      8706--IMP-PTR  8984<<ASSIGN   9014>>IF       9022>>IF       9037>>ASSIGN   9038<>CALL
SNCHARS
      8706**DCL      9014>>IF       9022>>IF       9037>>ASSIGN
SNVECLIST$
      8157**DCL      8157--IMP-PTR
SPEC.START
      8221**DCL      8222--REDEF
SPEC.STOP
      8222**DCL      8223--REDEF
SPECCHARS
      8221**DCL      8221--REDEF
TAPE_CLOSE.SN_
      8074**DCL      8074--REDEF
TAPE_CLOSE.UTL_
      8075**DCL      8075--REDEF
TAPE_CLOSE.V.EXPIRE#
      8089**DCL      8089--REDEF
TAPE_CLOSE.V.TYPE#
      8087**DCL      8087--REDEF
TAPE_CLOSE.V.XTNSIZE#
      8084**DCL      8084--REDEF    8086--REDEF
TAPE_DCBLIST$
      7630**DCL      7630--IMP-PTR
TAPE_OPEN.ACSVEH_
      7939**DCL      7940--REDEF
TAPE_OPEN.ALTKEYS_
      7945**DCL      7946--REDEF    7946--REDEF
TAPE_OPEN.HDR_
      7944**DCL      7945--REDEF
TAPE_OPEN.TAB_
      7943**DCL      7944--REDEF
TAPE_OPEN.UHL_
      7937**DCL      7938--REDEF    7938--REDEF
TAPE_OPEN.V.FSN#
      7977**DCL      7977--REDEF    7977--REDEF
TAPE_OPEN.WSN_
PL6.E3A0      #001=FLS$PROCESS_PRE_RET File=FLS$PROCESS_PRE_RET.:E05TSI          TUE 07/29/97 16:21 Page:53   
      7943**DCL      7943--REDEF
TAPE_READ.STATION_
      8001**DCL      8002--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      8013**DCL      8013--REDEF
TAPE_READ.V.INDX#
      8011**DCL      8011--REDEF
TAPE_WRITE.STATION_
      8039**DCL      8039--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      8046**DCL      8046--REDEF
TO1_CHAR IN PROCEDURE FLS_ADD_CHARS
      9117**DCL      9125<<ASSIGN
TO_CHARS IN PROCEDURE FLS_ADD_CHARS
      9116**DCL      9129<<ASSIGN
TVECTOR.W2
      8170**DCL      8171--REDEF

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:54   
      290        1        /*T***********************************************************/
      291        2        /*T*                                                         */
      292        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      293        4        /*T*                                                         */
      294        5        /*T***********************************************************/
      295        6        %EJECT;
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:55   
      296        7        FLS$BUILD_BACKUP: PROC ALTRET;
      297        8
      298        9        /*** INCLUDE FILES ***/
      299       10
      300       11        %INCLUDE CP_6;
      301     5570        %INCLUDE CP_6_SUBS;
      302     6110        %INCLUDE B_ERRORS_C;
      303     7237        %INCLUDE FLI_DATA_R;
      304     8651        %INCLUDE FLS_DATA_R;
      305    10451
      306    10452        /*** ENTRIES ***/
      307    10453
      308    10454    1   DCL FLI$RPT_ERR ENTRY ( 5 );
      309    10455
      310    10456        /*** CONSTANT ***/
      311    10457
      312    10458    1   DCL SLASH CHAR(1) CONSTANT INIT ('/');
      313    10459    1   DCL XTEND CHAR(5) CONSTANT INIT( 'XTEND' );
      314    10460    1   DCL LEFT_PAREN CHAR(1) CONSTANT INIT( '(' );
      315    10461    1   DCL RIGHT_PAREN CHAR(1) CONSTANT INIT( ')');
      316    10462    1   DCL DP# CHAR(3) CONSTANT INIT('DP#');
      317    10463    1   DCL LT# CHAR(3) CONSTANT INIT('LT#');
      318    10464    1   DCL POUND CHAR(1) CONSTANT INIT('#');
      319    10465    1   DCL COMMA CHAR(1) CONSTANT INIT(',');
      320    10466    1   DCL BACKUP CHAR(6) CONSTANT INIT('BACKUP');
      321    10467    1   DCL BLANK CHAR(1) CONSTANT INIT(' ');
      322    10468    1   DCL SEMI_COLON CHAR(1) CONSTANT INIT(';');
      323    10469    1   DCL EFT_ACCT CHAR(6) CONSTANT INIT ('.$$EFT');
      324    10470
      325    10471        /*** AUTO ***/
      326    10472
      327    10473    1   DCL I SBIN;
      328    10474    1   DCL CMD$ PTR;
      329    10475    1   DCL CMD CHAR(80);
      330    10476    1   DCL CT_LEN UBIN;
      331    10477    1   DCL LT1 CHAR(6);
      332    10478    1   DCL LT2 CHAR(6);
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:56   
      333    10479    1   DCL SNLIST$ PTR ALIGNED;
      334    10480
      335    10481        /*** MACROS ***/
      336    10482
      337    10483        %FPT_OPEN ( FPTN = BACKUP_CMD_OPEN,
      338    10484                    DCB = M$DISK00,
      339    10485                    FUN = CREATE,
      340    10486                    CTG = YES,
      341    10487                    ASN = FILE,
      342    10488                    SCRUB = YES,
      343    10489                    ORG = CONSEC,
      344    10490                    NAME = BACKUP_CMD_FNAME );
      345    10599        %FPT_WRITE ( FPTN = BACKUP_CMD_WRITE,
      346    10600                     DCB = M$DISK00 );
      347    10631        %FPT_CLOSE ( FPTN = BACKUP_CMD_CLOSE,
      348    10632                     DCB = M$DISK00 );
      349    10674        %F$DCB ( STCLASS = "BASED" );
      350    10731        %VLP_SN ( FPTN = VLP_SN, STCLASS = "BASED" );
      351    10744
      352    10745    1   DCL M$DISK00 DCB;
      353    10746
      354    10747        /*** BASED VARIABLES ***/
      355    10748
      356    10749    1   DCL CHAR6 CHAR(6) BASED;
      357    10750    1   DCL CHAR5 CHAR (5) BASED;
      358    10751    1   DCL CHAR3 CHAR(3) BASED;
      359    10752    1   DCL CHAR2 CHAR(2) BASED;
      360    10753    1   DCL CHAR1 CHAR(1) BASED;
      361    10754    1   DCL CHAR13 CHAR(13) BASED;
      362    10755    1   DCL 1 BASE_VEC BASED DALIGNED,
      363    10756    1         2 * BIT(36),
      364    10757    1         2 PTR$ PTR;
      365    10758
      366    10759    1      CMD$ = ADDR ( CMD );
      367    10760    1      CMD = BLANK;
      368    10761    1      CALL M$OPEN ( BACKUP_CMD_OPEN )
      369    10762    2       WHENALTRETURN DO;
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:57   
      370    10763    2         CALL FLI$RPT_ERR;
      371    10764    2         ALTRETURN;
      372    10765    2         END;
      373    10766    1      BACKUP_CMD_WRITE.BUF_.BUF$ = ADDR ( CMD );
      374    10767
      375    10768    1      CMD$ -> CHAR6 = BACKUP;
      376    10769    1      CMD$ = PINCRC ( CMD$, LENGTHC ( BACKUP ) );
      377    10770    1      CMD$ -> CHAR1 = BLANK;
      378    10771    1      CMD$ = PINCRC ( CMD$, LENGTHC ( BLANK ) );
      379    10772
      380    10773                                                /* Disk Packset list                  */
      381    10774
      382    10775    1      IF DPLIST.NUM# < 1
      383    10776    1       THEN GOTO CLOSE_ALT;
      384    10777    2      DO I = 0 TO DPLIST.NUM# - 1;
      385    10778    2         IF DPLIST.SN# ( I ) ~= ' '
      386    10779    3          THEN DO;
      387    10780    3            CALL CHECK_CMD_BUF ( LENGTHC ( DP# ),'0'B ) ALTRET ( CLOSE_ALT );
      388    10781    3            CMD$ -> CHAR3 = DP#;
      389    10782    3            CMD$ = PINCRC ( CMD$, LENGTHC ( DP# ) );
      390    10783    3            CALL CHECK_CMD_BUF ( LENGTHC ( DPLIST.SN# ( 0 ) ),'0'B ) ALTRET ( CLOSE_ALT
             10783                     );
      391    10784    3            CMD$ -> CHAR6 = DPLIST.SN# ( I );
      392    10785    3            CMD$ = PINCRC ( CMD$, LENGTHC ( DPLIST.SN# ( 0 ) ) );
      393    10786    3            CALL CHECK_CMD_BUF ( LENGTHC ( DPLIST.SN# ( 0 ) ),'0'B )
      394    10787    3              ALTRET ( CLOSE_ALT );
      395    10788    3            CMD$ -> CHAR1 = COMMA;
      396    10789    3            CMD$ = PINCRC ( CMD$, LENGTHC ( COMMA ) );
      397    10790    3            END;
      398    10791    2          ELSE GOTO CLOSE_ALT;
      399    10792    2         END;
      400    10793    1      CMD$ = PINCRC ( CMD$, -LENGTHC ( COMMA ) );
      401    10794    1      CMD$ -> CHAR1 = BLANK;
      402    10795    1      IF CMD$ ~= ADDR ( CMD )
      403    10796    1       THEN CALL CHECK_CMD_BUF ( 0, '0'B ) ALTRET ( CLOSE_ALT );
      404    10797
      405    10798                                                /* <slash>(.$$EFT) XTEND              */
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:58   
      406    10799
      407    10800    1      CMD$ -> CHAR1 = SLASH;
      408    10801    1      CMD$ = PINCRC ( CMD$, LENGTHC ( SLASH ) );
      409    10802    1      CMD$ -> CHAR1 = LEFT_PAREN;
      410    10803    1      CMD$ = PINCRC ( CMD$, LENGTHC ( LEFT_PAREN ) );
      411    10804    1      CMD$ -> CHAR6 = EFT_ACCT;
      412    10805    1      CMD$ = PINCRC ( CMD$, LENGTHC ( EFT_ACCT ) );
      413    10806    1      CMD$ -> CHAR1 = RIGHT_PAREN;
      414    10807    1      CMD$ = PINCRC ( CMD$, LENGTHC ( CHAR1 ) );
      415    10808    1      CMD$ -> CHAR1 = BLANK;
      416    10809    1      CMD$ = PINCRC ( CMD$, LENGTHC ( CHAR1 ) );
      417    10810
      418    10811    1      CMD$ -> CHAR5 = XTEND;
      419    10812    1      CMD$ = PINCRC ( CMD$, LENGTHC ( XTEND ) );
      420    10813    1      CALL CHECK_CMD_BUF ( 0,'0'B ) ALTRET ( CLOSE_ALT );
      421    10814
      422    10815
      423    10816                                                /* Tape serial number                 */
      424    10817
      425    10818    1      IF NBR_SNLISTS < 1
      426    10819    1       THEN GOTO CLOSE_ALT;
      427    10820    1      CT_LEN = LENGTHC ( LT# ) + LENGTHC ( POUND ) +
      428    10821    1        2 * LENGTHC ( VLP_SN.SN# ( 0 ) ) + LENGTHC ( COMMA );
      429    10822    2      DO I = 0 TO NBR_SNLISTS - 1;
      430    10823    2         SNLIST$ = ADDR ( SNVECLIST ( I ) ) -> BASE_VEC.PTR$;
      431    10824    2         LT1 = SNLIST$ -> VLP_SN.SN# ( DEST_TAPE_VOL - 1 );
      432    10825    2         IF LT1 = ' '
      433    10826    2          THEN GOTO CLOSE_ALT;
      434    10827    2         IF DEST_TAPE_VOL < SNLIST$ -> VLP_SN.NUM#
      435    10828    2          THEN LT2 = SNLIST$ -> VLP_SN.SN# ( DEST_TAPE_VOL );
      436    10829    2         CALL CHECK_CMD_BUF ( CT_LEN,'0'B ) ALTRET ( CLOSE_ALT );
      437    10830    2         CMD$ -> CHAR3 = LT#;
      438    10831    2         CMD$ = PINCRC ( CMD$, LENGTHC ( LT# ) );
      439    10832    2         CMD$ -> CHAR6 = LT1;
      440    10833    2         CMD$ = PINCRC ( CMD$, LENGTHC ( LT1 ) );
      441    10834    2         IF ( LT2 = BLANK ) OR ( DEST_TAPE_VOL >= SNLIST$ -> VLP_SN.NUM# )
      442    10835    2          THEN ;
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:59   
      443    10836    3          ELSE DO;
      444    10837    3            CMD$ -> CHAR1 = POUND;
      445    10838    3            CMD$ = PINCRC ( CMD$, LENGTHC ( POUND ) );
      446    10839    3            CMD$ -> CHAR6 = LT2;
      447    10840    3            CMD$ = PINCRC ( CMD$, LENGTHC ( LT2 ) );
      448    10841    3            END;
      449    10842    2         CMD$ -> CHAR1 = COMMA;
      450    10843    2         CMD$ = PINCRC ( CMD$, LENGTHC ( COMMA ) );
      451    10844    2         END;
      452    10845    1      CMD$ = PINCRC ( CMD$, -LENGTHC ( COMMA ) );
      453    10846    1      CMD$ -> CHAR1 = BLANK;
      454    10847    1      IF CMD$ ~= ADDR ( CMD )
      455    10848    1       THEN CALL CHECK_CMD_BUF ( 0, '1'B ) ALTRET ( CLOSE_ALT );
      456    10849    2      DO WHILE ( '0'B );
      457    10850    2   CLOSE_ALT:;
      458    10851    2         IF DCBADDR ( DCBNUM ( M$DISK00 ) ) -> F$DCB.FCD#
      459    10852    2          THEN CALL M$CLOSE ( BACKUP_CMD_CLOSE )
      460    10853    3             WHENALTRETURN DO;
      461    10854    3               CALL FLI$RPT_ERR;
      462    10855    3               END;
      463    10856    2         ALTRETURN;
      464    10857    2         END;
      465    10858    1      IF DCBADDR ( DCBNUM ( M$DISK00 ) ) -> F$DCB.FCD#
      466    10859    1       THEN CALL M$CLOSE ( BACKUP_CMD_CLOSE )
      467    10860    2          WHENALTRETURN DO;
      468    10861    2            CALL FLI$RPT_ERR;
      469    10862    2            END;
      470    10863    1      RETURN;
      471    10864    1   CHECK_CMD_BUF :PROC ( NEED, LAST_OUTPUT )ALTRET;
      472    10865
      473    10866    2   DCL NEED UBIN;
      474    10867    2   DCL LAST_OUTPUT BIT(1) ALIGNED;
      475    10868
      476    10869    2      IF NEED > ( 79 - POFFC ( ADDR ( CMD ), CMD$ ) ) OR NEED = 0
      477    10870    3       THEN DO;
      478    10871    3         IF NOT LAST_OUTPUT
      479    10872    4          THEN DO;
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:60   
      480    10873    4            CMD$ -> CHAR1 = SEMI_COLON;
      481    10874    4            CMD$ = PINCRC ( CMD$, LENGTHC ( SEMI_COLON ) );
      482    10875    4            END;
      483    10876    3         BACKUP_CMD_WRITE.BUF_.BOUND = POFFC ( CMD$, ADDR ( CMD ) ) - 1;
      484    10877    3         CALL M$WRITE ( BACKUP_CMD_WRITE )
      485    10878    4          WHENALTRETURN DO;
      486    10879    4            CALL FLI$RPT_ERR;
      487    10880    4            ALTRETURN;
      488    10881    4            END;
      489    10882    3         CMD$ = ADDR ( CMD );
      490    10883    3         CMD = BLANK;
      491    10884    3         END;
      492    10885    2      RETURN;
      493    10886    2   END CHECK_CMD_BUF;
      494    10887    1   END FLS$BUILD_BACKUP;

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:61   
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLS$BUILD_BACKUP.

   Procedure FLS$BUILD_BACKUP requires 339 words for executable code.
   Procedure FLS$BUILD_BACKUP requires 40 words of local(AUTO) storage.

    No errors detected in file FLS$PROCESS_PRE_RET.:E05TSI    .

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:62   

 Object Unit name= FLS$BUILD_BACKUP                           File name= FLS$PROCESS_PRE_RET.:E05TOU
 UTS= JUL 29 '97 16:22:07.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none   120    170  FLS$BUILD_BACKUP
    3   DCB   even  none     0      0  M$TSN_USED
    4   DCB   even  none     0      0  M$STATUS
    5   DCB   even  none     0      0  M$REBUILD
    6   DCB   even  none     0      0  M$ARCHIVE
    7   DCB   even  none     0      0  M$NODATA_LIST
    8  RoData even  UTS     15     17  FLS$BUILD_BACKUP
    9   DCB   even  none     0      0  M$DISK00
   10   Proc  even  none   339    523  FLS$BUILD_BACKUP
   11  RoData even  none     7      7  FLS$BUILD_BACKUP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes    yes     yes      Std        0  FLS$BUILD_BACKUP
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:63   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  NBR_SNLISTS                           TAPE_DCBLIST$
     SNVECLIST$                            DPLIST$                               DPRESLIST$
     DISK_FILE_SPEC$                       SPECCHARS                             EFTWORD
     M$PRE_RET                             RET_CMDS_NAME                         M$TSN_USED
     M$STATUS                              M$REBUILD                             M$ARCHIVE
     M$NODATA_LIST                         BLK_TAG$                              BLK_TAG0$
     NBR_BYTES_TO_MOVE                     DISK_GRAN$                            BLOCK_GRAN$
r    EFT_CVOL_FILE                    r    EFT_RESTRICT_FILE                     DEST_TAPE_VOL
     TSN_USED_NAME                         BACKUP_NAME                      r    ARCHIVE_NAME
r    PRIME_FILE                       r    DUAL_FILE                             REBUILD_NAME
     REBUILD_DIR_KEY                       REBUILD_KEY                           NODATA_FILE_NAME
     NODATA_KEY                            M$DISK00                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:64   


      290        1        /*T***********************************************************/
      291        2        /*T*                                                         */
      292        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      293        4        /*T*                                                         */
      294        5        /*T***********************************************************/
      295        6        %EJECT;
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:65   
      296        7        FLS$BUILD_BACKUP: PROC ALTRET;

      7 10 000000   000000 700200 xent  FLS$BUILD_B* TSX0  ! X66_AUTO_0
        10 000001   000050 000000                    ZERO    40,0

      297        8
      298        9        /*** INCLUDE FILES ***/
      299       10
      300       11        %INCLUDE CP_6;
      301     5570        %INCLUDE CP_6_SUBS;
      302     6110        %INCLUDE B_ERRORS_C;
      303     7237        %INCLUDE FLI_DATA_R;
      304     8651        %INCLUDE FLS_DATA_R;
      305    10451
      306    10452        /*** ENTRIES ***/
      307    10453
      308    10454    1   DCL FLI$RPT_ERR ENTRY ( 5 );
      309    10455
      310    10456        /*** CONSTANT ***/
      311    10457
      312    10458    1   DCL SLASH CHAR(1) CONSTANT INIT ('/');
      313    10459    1   DCL XTEND CHAR(5) CONSTANT INIT( 'XTEND' );
      314    10460    1   DCL LEFT_PAREN CHAR(1) CONSTANT INIT( '(' );
      315    10461    1   DCL RIGHT_PAREN CHAR(1) CONSTANT INIT( ')');
      316    10462    1   DCL DP# CHAR(3) CONSTANT INIT('DP#');
      317    10463    1   DCL LT# CHAR(3) CONSTANT INIT('LT#');
      318    10464    1   DCL POUND CHAR(1) CONSTANT INIT('#');
      319    10465    1   DCL COMMA CHAR(1) CONSTANT INIT(',');
      320    10466    1   DCL BACKUP CHAR(6) CONSTANT INIT('BACKUP');
      321    10467    1   DCL BLANK CHAR(1) CONSTANT INIT(' ');
      322    10468    1   DCL SEMI_COLON CHAR(1) CONSTANT INIT(';');
      323    10469    1   DCL EFT_ACCT CHAR(6) CONSTANT INIT ('.$$EFT');
      324    10470
      325    10471        /*** AUTO ***/
      326    10472
      327    10473    1   DCL I SBIN;
      328    10474    1   DCL CMD$ PTR;
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:66   
      329    10475    1   DCL CMD CHAR(80);
      330    10476    1   DCL CT_LEN UBIN;
      331    10477    1   DCL LT1 CHAR(6);
      332    10478    1   DCL LT2 CHAR(6);
      333    10479    1   DCL SNLIST$ PTR ALIGNED;
      334    10480
      335    10481        /*** MACROS ***/
      336    10482
      337    10483        %FPT_OPEN ( FPTN = BACKUP_CMD_OPEN,
      338    10484                    DCB = M$DISK00,
      339    10485                    FUN = CREATE,
      340    10486                    CTG = YES,
      341    10487                    ASN = FILE,
      342    10488                    SCRUB = YES,
      343    10489                    ORG = CONSEC,
      344    10490                    NAME = BACKUP_CMD_FNAME );
      345    10599        %FPT_WRITE ( FPTN = BACKUP_CMD_WRITE,
      346    10600                     DCB = M$DISK00 );
      347    10631        %FPT_CLOSE ( FPTN = BACKUP_CMD_CLOSE,
      348    10632                     DCB = M$DISK00 );
      349    10674        %F$DCB ( STCLASS = "BASED" );
      350    10731        %VLP_SN ( FPTN = VLP_SN, STCLASS = "BASED" );
      351    10744
      352    10745    1   DCL M$DISK00 DCB;
      353    10746
      354    10747        /*** BASED VARIABLES ***/
      355    10748
      356    10749    1   DCL CHAR6 CHAR(6) BASED;
      357    10750    1   DCL CHAR5 CHAR (5) BASED;
      358    10751    1   DCL CHAR3 CHAR(3) BASED;
      359    10752    1   DCL CHAR2 CHAR(2) BASED;
      360    10753    1   DCL CHAR1 CHAR(1) BASED;
      361    10754    1   DCL CHAR13 CHAR(13) BASED;
      362    10755    1   DCL 1 BASE_VEC BASED DALIGNED,
      363    10756    1         2 * BIT(36),
      364    10757    1         2 PTR$ PTR;
      365    10758
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:67   
      366    10759    1      CMD$ = ADDR ( CMD );

  10759 10 000002   200005 630500                    EPPR0   CMD,,AUTO
        10 000003   200004 450500                    STP0    CMD$,,AUTO

      367    10760    1      CMD = BLANK;

  10760 10 000004   040100 100400                    MLR     fill='040'O
        10 000005   000013 000001 8                  ADSC9   BLANK                    cn=0,n=1
        10 000006   200005 000120                    ADSC9   CMD,,AUTO                cn=0,n=80

      368    10761    1      CALL M$OPEN ( BACKUP_CMD_OPEN )

  10761 10 000007   000024 630400 2                  EPPR0   BACKUP_CMD_OPEN
        10 000010   450000 713400                    CLIMB   alt,open
        10 000011   410400 401760                    pmme    nvectors=18
        10 000012   000014 702000 10                 TSX2    s:10763
        10 000013   000020 710000 10                 TRA     s:10766

      369    10762    2       WHENALTRETURN DO;

      370    10763    2         CALL FLI$RPT_ERR;

  10763 10 000014   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000015   000000 701000 xent               TSX1    FLI$RPT_ERR
        10 000016   000000 011000                    NOP     0

      371    10764    2         ALTRETURN;

  10764 10 000017   000000 702200 xent               TSX2  ! X66_AALT

      372    10765    2         END;
      373    10766    1      BACKUP_CMD_WRITE.BUF_.BUF$ = ADDR ( CMD );

  10766 10 000020   200005 630500                    EPPR0   CMD,,AUTO
        10 000021   000123 450400 2                  STP0    BACKUP_CMD_WRITE+5

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:68   
      374    10767
      375    10768    1      CMD$ -> CHAR6 = BACKUP;

  10768 10 000022   200004 471500                    LDP1    CMD$,,AUTO
        10 000023   040100 100400                    MLR     fill='040'O
        10 000024   000011 000006 8                  ADSC9   BACKUP                   cn=0,n=6
        10 000025   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6

      376    10769    1      CMD$ = PINCRC ( CMD$, LENGTHC ( BACKUP ) );

  10769 10 000026   200004 236100                    LDQ     CMD$,,AUTO
        10 000027   000000 036000 11                 ADLQ    0
        10 000030   200004 756100                    STQ     CMD$,,AUTO

      377    10770    1      CMD$ -> CHAR1 = BLANK;

  10770 10 000031   200004 470500                    LDP0    CMD$,,AUTO
        10 000032   040100 100400                    MLR     fill='040'O
        10 000033   000013 000001 8                  ADSC9   BLANK                    cn=0,n=1
        10 000034   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      378    10771    1      CMD$ = PINCRC ( CMD$, LENGTHC ( BLANK ) );

  10771 10 000035   200000 036007                    ADLQ    65536,DL
        10 000036   200004 756100                    STQ     CMD$,,AUTO

      379    10772
      380    10773                                                /* Disk Packset list                  */
      381    10774
      382    10775    1      IF DPLIST.NUM# < 1

  10775 10 000037   000000 470400 xsym               LDP0    DPLIST$
        10 000040   000000 235100                    LDA     0,,PR0
        10 000041   000370 604400 10                 TMOZ    CLOSE_ALT

      383    10776    1       THEN GOTO CLOSE_ALT;
      384    10777    2      DO I = 0 TO DPLIST.NUM# - 1;
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:69   

  10777 10 000042   200003 450100                    STZ     I,,AUTO
        10 000043   000127 710000 10                 TRA     s:10792+1

      385    10778    2         IF DPLIST.SN# ( I ) ~= ' '

  10778 10 000044   200003 236100                    LDQ     I,,AUTO
        10 000045   000006 402007                    MPY     6,DL
        10 000046   000000 470400 xsym               LDP0    DPLIST$
        10 000047   040000 106506                    CMPC    fill='040'O
        10 000050   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6
        10 000051   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 000052   000370 600000 10                 TZE     CLOSE_ALT

      386    10779    3          THEN DO;

      387    10780    3            CALL CHECK_CMD_BUF ( LENGTHC ( DP# ),'0'B ) ALTRET ( CLOSE_ALT );

  10780 10 000053   000001 236000 11                 LDQ     1
        10 000054   200042 756100                    STQ     @NEED+1,,AUTO
        10 000055   000002 236000 11                 LDQ     2
        10 000056   200041 756100                    STQ     SNLIST$+3,,AUTO
        10 000057   000430 701000 10                 TSX1    CHECK_CMD_BUF
        10 000060   000370 702000 10                 TSX2    CLOSE_ALT

      388    10781    3            CMD$ -> CHAR3 = DP#;

  10781 10 000061   200004 470500                    LDP0    CMD$,,AUTO
        10 000062   040100 100400                    MLR     fill='040'O
        10 000063   000005 000003 8                  ADSC9   DP#                      cn=0,n=3
        10 000064   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

      389    10782    3            CMD$ = PINCRC ( CMD$, LENGTHC ( DP# ) );

  10782 10 000065   200004 236100                    LDQ     CMD$,,AUTO
        10 000066   600000 036007                    ADLQ    -65536,DL
        10 000067   200004 756100                    STQ     CMD$,,AUTO
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:70   

      390    10783    3           CALL CHECK_CMD_BUF ( LENGTHC ( DPLIST.SN# ( 0 ) ),'0'B ) ALTRET ( CLOSE_ALT
             10783                     );

  10783 10 000070   000001 236000 11                 LDQ     1
        10 000071   200042 756100                    STQ     @NEED+1,,AUTO
        10 000072   000003 236000 11                 LDQ     3
        10 000073   200041 756100                    STQ     SNLIST$+3,,AUTO
        10 000074   000430 701000 10                 TSX1    CHECK_CMD_BUF
        10 000075   000370 702000 10                 TSX2    CLOSE_ALT

      391    10784    3            CMD$ -> CHAR6 = DPLIST.SN# ( I );

  10784 10 000076   200003 236100                    LDQ     I,,AUTO
        10 000077   000006 402007                    MPY     6,DL
        10 000100   000000 470400 xsym               LDP0    DPLIST$
        10 000101   200004 471500                    LDP1    CMD$,,AUTO
        10 000102   040100 100506                    MLR     fill='040'O
        10 000103   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6
        10 000104   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6

      392    10785    3            CMD$ = PINCRC ( CMD$, LENGTHC ( DPLIST.SN# ( 0 ) ) );

  10785 10 000105   200004 236100                    LDQ     CMD$,,AUTO
        10 000106   000000 036000 11                 ADLQ    0
        10 000107   200004 756100                    STQ     CMD$,,AUTO

      393    10786    3            CALL CHECK_CMD_BUF ( LENGTHC ( DPLIST.SN# ( 0 ) ),'0'B )

  10786 10 000110   000001 236000 11                 LDQ     1
        10 000111   200042 756100                    STQ     @NEED+1,,AUTO
        10 000112   000003 236000 11                 LDQ     3
        10 000113   200041 756100                    STQ     SNLIST$+3,,AUTO
        10 000114   000430 701000 10                 TSX1    CHECK_CMD_BUF
        10 000115   000370 702000 10                 TSX2    CLOSE_ALT

      394    10787    3              ALTRET ( CLOSE_ALT );
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:71   
      395    10788    3            CMD$ -> CHAR1 = COMMA;

  10788 10 000116   200004 470500                    LDP0    CMD$,,AUTO
        10 000117   040100 100400                    MLR     fill='040'O
        10 000120   000010 000001 8                  ADSC9   COMMA                    cn=0,n=1
        10 000121   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      396    10789    3            CMD$ = PINCRC ( CMD$, LENGTHC ( COMMA ) );

  10789 10 000122   200004 236100                    LDQ     CMD$,,AUTO
        10 000123   200000 036007                    ADLQ    65536,DL
        10 000124   200004 756100                    STQ     CMD$,,AUTO

      397    10790    3            END;

  10790 10 000125   000126 710000 10                 TRA     s:10792

      398    10791    2          ELSE GOTO CLOSE_ALT;
      399    10792    2         END;

  10792 10 000126   200003 054100                    AOS     I,,AUTO
        10 000127   000000 470400 xsym               LDP0    DPLIST$
        10 000130   200003 236100                    LDQ     I,,AUTO
        10 000131   000000 116100                    CMPQ    0,,PR0
        10 000132   000044 604000 10                 TMI     s:10778

      400    10793    1      CMD$ = PINCRC ( CMD$, -LENGTHC ( COMMA ) );

  10793 10 000133   200004 236100                    LDQ     CMD$,,AUTO
        10 000134   000034 036000 xsym               ADLQ    B_VECTNIL+28
        10 000135   200004 756100                    STQ     CMD$,,AUTO

      401    10794    1      CMD$ -> CHAR1 = BLANK;

  10794 10 000136   200004 471500                    LDP1    CMD$,,AUTO
        10 000137   040100 100400                    MLR     fill='040'O
        10 000140   000013 000001 8                  ADSC9   BLANK                    cn=0,n=1
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:72   
        10 000141   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      402    10795    1      IF CMD$ ~= ADDR ( CMD )

  10795 10 000142   200044 452500                    STP2    @LAST_OUTPUT+2,,AUTO
        10 000143   200044 236100                    LDQ     @LAST_OUTPUT+2,,AUTO
        10 000144   000005 036003                    ADLQ    5,DU
        10 000145   200004 116100                    CMPQ    CMD$,,AUTO
        10 000146   000154 600000 10                 TZE     s:10800

      403    10796    1       THEN CALL CHECK_CMD_BUF ( 0, '0'B ) ALTRET ( CLOSE_ALT );

  10796 10 000147   000001 236000 11                 LDQ     1
        10 000150   200042 756100                    STQ     @NEED+1,,AUTO
        10 000151   200041 756100                    STQ     SNLIST$+3,,AUTO
        10 000152   000430 701000 10                 TSX1    CHECK_CMD_BUF
        10 000153   000370 702000 10                 TSX2    CLOSE_ALT

      404    10797
      405    10798                                                /* <slash>(.$$EFT) XTEND              */
      406    10799
      407    10800    1      CMD$ -> CHAR1 = SLASH;

  10800 10 000154   200004 470500                    LDP0    CMD$,,AUTO
        10 000155   040100 100400                    MLR     fill='040'O
        10 000156   000000 000001 8                  ADSC9   SLASH                    cn=0,n=1
        10 000157   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      408    10801    1      CMD$ = PINCRC ( CMD$, LENGTHC ( SLASH ) );

  10801 10 000160   200004 236100                    LDQ     CMD$,,AUTO
        10 000161   200000 036007                    ADLQ    65536,DL
        10 000162   200004 756100                    STQ     CMD$,,AUTO

      409    10802    1      CMD$ -> CHAR1 = LEFT_PAREN;

  10802 10 000163   200004 470500                    LDP0    CMD$,,AUTO
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:73   
        10 000164   040100 100400                    MLR     fill='040'O
        10 000165   000003 000001 8                  ADSC9   LEFT_PAREN               cn=0,n=1
        10 000166   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      410    10803    1      CMD$ = PINCRC ( CMD$, LENGTHC ( LEFT_PAREN ) );

  10803 10 000167   200000 036007                    ADLQ    65536,DL
        10 000170   200004 756100                    STQ     CMD$,,AUTO

      411    10804    1      CMD$ -> CHAR6 = EFT_ACCT;

  10804 10 000171   200004 470500                    LDP0    CMD$,,AUTO
        10 000172   040100 100400                    MLR     fill='040'O
        10 000173   000015 000006 8                  ADSC9   EFT_ACCT                 cn=0,n=6
        10 000174   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6

      412    10805    1      CMD$ = PINCRC ( CMD$, LENGTHC ( EFT_ACCT ) );

  10805 10 000175   000000 036000 11                 ADLQ    0
        10 000176   200004 756100                    STQ     CMD$,,AUTO

      413    10806    1      CMD$ -> CHAR1 = RIGHT_PAREN;

  10806 10 000177   200004 470500                    LDP0    CMD$,,AUTO
        10 000200   040100 100400                    MLR     fill='040'O
        10 000201   000004 000001 8                  ADSC9   RIGHT_PAREN              cn=0,n=1
        10 000202   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      414    10807    1      CMD$ = PINCRC ( CMD$, LENGTHC ( CHAR1 ) );

  10807 10 000203   200000 036007                    ADLQ    65536,DL
        10 000204   200004 756100                    STQ     CMD$,,AUTO

      415    10808    1      CMD$ -> CHAR1 = BLANK;

  10808 10 000205   200004 470500                    LDP0    CMD$,,AUTO
        10 000206   040100 100400                    MLR     fill='040'O
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:74   
        10 000207   000013 000001 8                  ADSC9   BLANK                    cn=0,n=1
        10 000210   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      416    10809    1      CMD$ = PINCRC ( CMD$, LENGTHC ( CHAR1 ) );

  10809 10 000211   200000 036007                    ADLQ    65536,DL
        10 000212   200004 756100                    STQ     CMD$,,AUTO

      417    10810
      418    10811    1      CMD$ -> CHAR5 = XTEND;

  10811 10 000213   200004 470500                    LDP0    CMD$,,AUTO
        10 000214   040100 100400                    MLR     fill='040'O
        10 000215   000001 000005 8                  ADSC9   XTEND                    cn=0,n=5
        10 000216   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

      419    10812    1      CMD$ = PINCRC ( CMD$, LENGTHC ( XTEND ) );

  10812 10 000217   000004 036000 11                 ADLQ    4
        10 000220   200004 756100                    STQ     CMD$,,AUTO

      420    10813    1      CALL CHECK_CMD_BUF ( 0,'0'B ) ALTRET ( CLOSE_ALT );

  10813 10 000221   000001 236000 11                 LDQ     1
        10 000222   200042 756100                    STQ     @NEED+1,,AUTO
        10 000223   200041 756100                    STQ     SNLIST$+3,,AUTO
        10 000224   000430 701000 10                 TSX1    CHECK_CMD_BUF
        10 000225   000370 702000 10                 TSX2    CLOSE_ALT

      421    10814
      422    10815
      423    10816                                                /* Tape serial number                 */
      424    10817
      425    10818    1      IF NBR_SNLISTS < 1

  10818 10 000226   000000 235000 xsym               LDA     NBR_SNLISTS
        10 000227   000370 604400 10                 TMOZ    CLOSE_ALT
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:75   

      426    10819    1       THEN GOTO CLOSE_ALT;
      427    10820    1      CT_LEN = LENGTHC ( LT# ) + LENGTHC ( POUND ) +

  10820 10 000230   000021 236007                    LDQ     17,DL
        10 000231   200031 756100                    STQ     CT_LEN,,AUTO

      428    10821    1        2 * LENGTHC ( VLP_SN.SN# ( 0 ) ) + LENGTHC ( COMMA );
      429    10822    2      DO I = 0 TO NBR_SNLISTS - 1;

  10822 10 000232   200003 450100                    STZ     I,,AUTO
        10 000233   000342 710000 10                 TRA     s:10844+1

      430    10823    2         SNLIST$ = ADDR ( SNVECLIST ( I ) ) -> BASE_VEC.PTR$;

  10823 10 000234   200003 235100                    LDA     I,,AUTO
        10 000235   000001 735000                    ALS     1
        10 000236   000000 470400 xsym               LDP0    SNVECLIST$
        10 000237   000001 236105                    LDQ     1,AL,PR0
        10 000240   200036 756100                    STQ     SNLIST$,,AUTO

      431    10824    2         LT1 = SNLIST$ -> VLP_SN.SN# ( DEST_TAPE_VOL - 1 );

  10824 10 000241   000000 236000 xsym               LDQ     DEST_TAPE_VOL
        10 000242   000006 402007                    MPY     6,DL
        10 000243   200036 471500                    LDP1    SNLIST$,,AUTO
        10 000244   040100 100506                    MLR     fill='040'O
        10 000245   177777 400006                    ADSC9   -1,Q,PR1                 cn=2,n=6
        10 000246   200032 000006                    ADSC9   LT1,,AUTO                cn=0,n=6

      432    10825    2         IF LT1 = ' '

  10825 10 000247   040000 106500                    CMPC    fill='040'O
        10 000250   200032 000006                    ADSC9   LT1,,AUTO                cn=0,n=6
        10 000251   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 000252   000370 600000 10                 TZE     CLOSE_ALT

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:76   
      433    10826    2          THEN GOTO CLOSE_ALT;
      434    10827    2         IF DEST_TAPE_VOL < SNLIST$ -> VLP_SN.NUM#

  10827 10 000253   000000 236000 xsym               LDQ     DEST_TAPE_VOL
        10 000254   100000 116100                    CMPQ    0,,PR1
        10 000255   000262 605000 10                 TPL     s:10829

      435    10828    2          THEN LT2 = SNLIST$ -> VLP_SN.SN# ( DEST_TAPE_VOL );

  10828 10 000256   000006 402007                    MPY     6,DL
        10 000257   040100 100506                    MLR     fill='040'O
        10 000260   100001 000006                    ADSC9   1,Q,PR1                  cn=0,n=6
        10 000261   200034 000006                    ADSC9   LT2,,AUTO                cn=0,n=6

      436    10829    2         CALL CHECK_CMD_BUF ( CT_LEN,'0'B ) ALTRET ( CLOSE_ALT );

  10829 10 000262   000001 236000 11                 LDQ     1
        10 000263   200042 756100                    STQ     @NEED+1,,AUTO
        10 000264   200031 633500                    EPPR3   CT_LEN,,AUTO
        10 000265   200041 453500                    STP3    SNLIST$+3,,AUTO
        10 000266   000430 701000 10                 TSX1    CHECK_CMD_BUF
        10 000267   000370 702000 10                 TSX2    CLOSE_ALT

      437    10830    2         CMD$ -> CHAR3 = LT#;

  10830 10 000270   200004 470500                    LDP0    CMD$,,AUTO
        10 000271   040100 100400                    MLR     fill='040'O
        10 000272   000006 000003 8                  ADSC9   LT#                      cn=0,n=3
        10 000273   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

      438    10831    2         CMD$ = PINCRC ( CMD$, LENGTHC ( LT# ) );

  10831 10 000274   200004 236100                    LDQ     CMD$,,AUTO
        10 000275   600000 036007                    ADLQ    -65536,DL
        10 000276   200004 756100                    STQ     CMD$,,AUTO

      439    10832    2         CMD$ -> CHAR6 = LT1;
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:77   

  10832 10 000277   200004 470500                    LDP0    CMD$,,AUTO
        10 000300   040100 100500                    MLR     fill='040'O
        10 000301   200032 000006                    ADSC9   LT1,,AUTO                cn=0,n=6
        10 000302   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6

      440    10833    2         CMD$ = PINCRC ( CMD$, LENGTHC ( LT1 ) );

  10833 10 000303   000000 036000 11                 ADLQ    0
        10 000304   200004 756100                    STQ     CMD$,,AUTO

      441    10834    2         IF ( LT2 = BLANK ) OR ( DEST_TAPE_VOL >= SNLIST$ -> VLP_SN.NUM# )

  10834 10 000305   040000 106500                    CMPC    fill='040'O
        10 000306   200034 000006                    ADSC9   LT2,,AUTO                cn=0,n=6
        10 000307   000013 000001 8                  ADSC9   BLANK                    cn=0,n=1
        10 000310   000332 600000 10                 TZE     s:10842
        10 000311   200036 470500                    LDP0    SNLIST$,,AUTO
        10 000312   000000 236000 xsym               LDQ     DEST_TAPE_VOL
        10 000313   000000 116100                    CMPQ    0,,PR0
        10 000314   000332 605000 10                 TPL     s:10842

      442    10835    2          THEN ;
      443    10836    3          ELSE DO;

      444    10837    3            CMD$ -> CHAR1 = POUND;

  10837 10 000315   200004 471500                    LDP1    CMD$,,AUTO
        10 000316   040100 100400                    MLR     fill='040'O
        10 000317   000007 000001 8                  ADSC9   POUND                    cn=0,n=1
        10 000320   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      445    10838    3            CMD$ = PINCRC ( CMD$, LENGTHC ( POUND ) );

  10838 10 000321   200004 236100                    LDQ     CMD$,,AUTO
        10 000322   200000 036007                    ADLQ    65536,DL
        10 000323   200004 756100                    STQ     CMD$,,AUTO
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:78   

      446    10839    3            CMD$ -> CHAR6 = LT2;

  10839 10 000324   200004 471500                    LDP1    CMD$,,AUTO
        10 000325   040100 100500                    MLR     fill='040'O
        10 000326   200034 000006                    ADSC9   LT2,,AUTO                cn=0,n=6
        10 000327   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6

      447    10840    3            CMD$ = PINCRC ( CMD$, LENGTHC ( LT2 ) );

  10840 10 000330   000000 036000 11                 ADLQ    0
        10 000331   200004 756100                    STQ     CMD$,,AUTO

      448    10841    3            END;

      449    10842    2         CMD$ -> CHAR1 = COMMA;

  10842 10 000332   200004 470500                    LDP0    CMD$,,AUTO
        10 000333   040100 100400                    MLR     fill='040'O
        10 000334   000010 000001 8                  ADSC9   COMMA                    cn=0,n=1
        10 000335   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      450    10843    2         CMD$ = PINCRC ( CMD$, LENGTHC ( COMMA ) );

  10843 10 000336   200004 236100                    LDQ     CMD$,,AUTO
        10 000337   200000 036007                    ADLQ    65536,DL
        10 000340   200004 756100                    STQ     CMD$,,AUTO

      451    10844    2         END;

  10844 10 000341   200003 054100                    AOS     I,,AUTO
        10 000342   200003 236100                    LDQ     I,,AUTO
        10 000343   000000 116000 xsym               CMPQ    NBR_SNLISTS
        10 000344   000234 604000 10                 TMI     s:10823

      452    10845    1      CMD$ = PINCRC ( CMD$, -LENGTHC ( COMMA ) );

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:79   
  10845 10 000345   200004 236100                    LDQ     CMD$,,AUTO
        10 000346   000034 036000 xsym               ADLQ    B_VECTNIL+28
        10 000347   200004 756100                    STQ     CMD$,,AUTO

      453    10846    1      CMD$ -> CHAR1 = BLANK;

  10846 10 000350   200004 470500                    LDP0    CMD$,,AUTO
        10 000351   040100 100400                    MLR     fill='040'O
        10 000352   000013 000001 8                  ADSC9   BLANK                    cn=0,n=1
        10 000353   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      454    10847    1      IF CMD$ ~= ADDR ( CMD )

  10847 10 000354   200044 452500                    STP2    @LAST_OUTPUT+2,,AUTO
        10 000355   200044 236100                    LDQ     @LAST_OUTPUT+2,,AUTO
        10 000356   000005 036003                    ADLQ    5,DU
        10 000357   200004 116100                    CMPQ    CMD$,,AUTO
        10 000360   000367 600000 10                 TZE     s:10849

      455    10848    1       THEN CALL CHECK_CMD_BUF ( 0, '1'B ) ALTRET ( CLOSE_ALT );

  10848 10 000361   000005 236000 11                 LDQ     5
        10 000362   200042 756100                    STQ     @NEED+1,,AUTO
        10 000363   000001 236000 11                 LDQ     1
        10 000364   200041 756100                    STQ     SNLIST$+3,,AUTO
        10 000365   000430 701000 10                 TSX1    CHECK_CMD_BUF
        10 000366   000370 702000 10                 TSX2    CLOSE_ALT

      456    10849    2      DO WHILE ( '0'B );

  10849 10 000367   000410 710000 10                 TRA     s:10858

  10848 10 000370                       CLOSE_ALT    null
      457    10850    2   CLOSE_ALT:;
      458    10851    2         IF DCBADDR ( DCBNUM ( M$DISK00 ) ) -> F$DCB.FCD#

  10851 10 000370   000000 236007 xsym               LDQ     M$DISK00,DL
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:80   
        10 000371   000006 470400 11                 LDP0    6
        10 000372   000000 471500                    LDP1    0,,PR0
        10 000373   100000 473506                    LDP3    0,QL,PR1
        10 000374   300031 236100                    LDQ     25,,PR3
        10 000375   020000 316007                    CANQ    8192,DL
        10 000376   000407 600000 10                 TZE     s:10856

      459    10852    2          THEN CALL M$CLOSE ( BACKUP_CMD_CLOSE )

  10852 10 000377   000132 630400 2                  EPPR0   BACKUP_CMD_CLOSE
        10 000400   450001 713400                    CLIMB   alt,close
        10 000401   406000 401760                    pmme    nvectors=13
        10 000402   000404 702000 10                 TSX2    s:10854
        10 000403   000407 710000 10                 TRA     s:10856

      460    10853    3             WHENALTRETURN DO;

      461    10854    3               CALL FLI$RPT_ERR;

  10854 10 000404   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000405   000000 701000 xent               TSX1    FLI$RPT_ERR
        10 000406   000000 011000                    NOP     0

      462    10855    3               END;

      463    10856    2         ALTRETURN;

  10856 10 000407   000000 702200 xent               TSX2  ! X66_AALT

      464    10857    2         END;

      465    10858    1      IF DCBADDR ( DCBNUM ( M$DISK00 ) ) -> F$DCB.FCD#

  10858 10 000410   000000 236007 xsym               LDQ     M$DISK00,DL
        10 000411   000006 470400 11                 LDP0    6
        10 000412   000000 471500                    LDP1    0,,PR0
        10 000413   100000 473506                    LDP3    0,QL,PR1
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:81   
        10 000414   300031 236100                    LDQ     25,,PR3
        10 000415   020000 316007                    CANQ    8192,DL
        10 000416   000427 600000 10                 TZE     s:10863

      466    10859    1       THEN CALL M$CLOSE ( BACKUP_CMD_CLOSE )

  10859 10 000417   000132 630400 2                  EPPR0   BACKUP_CMD_CLOSE
        10 000420   450001 713400                    CLIMB   alt,close
        10 000421   406000 401760                    pmme    nvectors=13
        10 000422   000424 702000 10                 TSX2    s:10861
        10 000423   000427 710000 10                 TRA     s:10863

      467    10860    2          WHENALTRETURN DO;

      468    10861    2            CALL FLI$RPT_ERR;

  10861 10 000424   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000425   000000 701000 xent               TSX1    FLI$RPT_ERR
        10 000426   000000 011000                    NOP     0

      469    10862    2            END;

      470    10863    1      RETURN;

  10863 10 000427   000000 702200 xent               TSX2  ! X66_ARET

      471    10864    1   CHECK_CMD_BUF :PROC ( NEED, LAST_OUTPUT )ALTRET;

  10864 10 000430   200040 741300       CHECK_CMD_B* STX1  ! SNLIST$+2,,AUTO

      472    10865
      473    10866    2   DCL NEED UBIN;
      474    10867    2   DCL LAST_OUTPUT BIT(1) ALIGNED;
      475    10868
      476    10869    2      IF NEED > ( 79 - POFFC ( ADDR ( CMD ), CMD$ ) ) OR NEED = 0

  10869 10 000431   200044 452500                    STP2    @LAST_OUTPUT+2,,AUTO
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:82   
        10 000432   200044 236100                    LDQ     @LAST_OUTPUT+2,,AUTO
        10 000433   000005 036003                    ADLQ    5,DU
        10 000434   000020 772000                    QRL     16
        10 000435   200045 756100                    STQ     @LAST_OUTPUT+3,,AUTO
        10 000436   200004 236100                    LDQ     CMD$,,AUTO
        10 000437   000020 772000                    QRL     16
        10 000440   200046 756100                    STQ     @LAST_OUTPUT+4,,AUTO
        10 000441   200045 236100                    LDQ     @LAST_OUTPUT+3,,AUTO
        10 000442   200046 136100                    SBLQ    @LAST_OUTPUT+4,,AUTO
        10 000443   200041 470500                    LDP0    @NEED,,AUTO
        10 000444   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 000445   000120 036007                    ADLQ    80,DL
        10 000446   000453 604000 10                 TMI     s:10871
        10 000447   000000 116100                    CMPQ    0,,PR0
        10 000450   000453 602000 10                 TNC     s:10871
        10 000451   000000 235100                    LDA     0,,PR0
        10 000452   000521 601000 10                 TNZ     s:10885

      477    10870    3       THEN DO;

      478    10871    3         IF NOT LAST_OUTPUT

  10871 10 000453   200042 471500                    LDP1    @LAST_OUTPUT,,AUTO
        10 000454   100000 234100                    SZN     0,,PR1
        10 000455   000465 604000 10                 TMI     s:10876

      479    10872    4          THEN DO;

      480    10873    4            CMD$ -> CHAR1 = SEMI_COLON;

  10873 10 000456   200004 473500                    LDP3    CMD$,,AUTO
        10 000457   040100 100400                    MLR     fill='040'O
        10 000460   000014 000001 8                  ADSC9   SEMI_COLON               cn=0,n=1
        10 000461   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      481    10874    4            CMD$ = PINCRC ( CMD$, LENGTHC ( SEMI_COLON ) );

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:83   
  10874 10 000462   200004 236100                    LDQ     CMD$,,AUTO
        10 000463   200000 036007                    ADLQ    65536,DL
        10 000464   200004 756100                    STQ     CMD$,,AUTO

      482    10875    4            END;

      483    10876    3         BACKUP_CMD_WRITE.BUF_.BOUND = POFFC ( CMD$, ADDR ( CMD ) ) - 1;

  10876 10 000465   200044 452500                    STP2    @LAST_OUTPUT+2,,AUTO
        10 000466   200044 236100                    LDQ     @LAST_OUTPUT+2,,AUTO
        10 000467   000005 036003                    ADLQ    5,DU
        10 000470   000020 772000                    QRL     16
        10 000471   200045 756100                    STQ     @LAST_OUTPUT+3,,AUTO
        10 000472   200004 236100                    LDQ     CMD$,,AUTO
        10 000473   000020 772000                    QRL     16
        10 000474   200045 136100                    SBLQ    @LAST_OUTPUT+3,,AUTO
        10 000475   000001 136007                    SBLQ    1,DL
        10 000476   000020 736000                    QLS     16
        10 000477   000122 676000 2                  ERQ     BACKUP_CMD_WRITE+4
        10 000500   000034 376000 xsym               ANQ     B_VECTNIL+28
        10 000501   000122 656000 2                  ERSQ    BACKUP_CMD_WRITE+4

      484    10877    3         CALL M$WRITE ( BACKUP_CMD_WRITE )

  10877 10 000502   000116 630400 2                  EPPR0   BACKUP_CMD_WRITE
        10 000503   440001 713400                    CLIMB   alt,write
        10 000504   401400 401760                    pmme    nvectors=4
        10 000505   000507 702000 10                 TSX2    s:10879
        10 000506   000514 710000 10                 TRA     s:10882

      485    10878    4          WHENALTRETURN DO;

      486    10879    4            CALL FLI$RPT_ERR;

  10879 10 000507   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000510   000000 701000 xent               TSX1    FLI$RPT_ERR
        10 000511   000000 011000                    NOP     0
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:84   

      487    10880    4            ALTRETURN;

  10880 10 000512   200040 221300                    LDX1  ! SNLIST$+2,,AUTO
        10 000513   000000 702211                    TSX2  ! 0,X1

      488    10881    4            END;
      489    10882    3         CMD$ = ADDR ( CMD );

  10882 10 000514   200005 630500                    EPPR0   CMD,,AUTO
        10 000515   200004 450500                    STP0    CMD$,,AUTO

      490    10883    3         CMD = BLANK;

  10883 10 000516   040100 100400                    MLR     fill='040'O
        10 000517   000013 000001 8                  ADSC9   BLANK                    cn=0,n=1
        10 000520   200005 000120                    ADSC9   CMD,,AUTO                cn=0,n=80

      491    10884    3         END;

      492    10885    2      RETURN;

  10885 10 000521   200040 221300                    LDX1  ! SNLIST$+2,,AUTO
        10 000522   000001 702211                    TSX2  ! 1,X1
      493    10886    2   END CHECK_CMD_BUF;
      494    10887    1   END FLS$BUILD_BACKUP;

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:85   
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLS$BUILD_BACKUP.
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:86   

 **** Variables and constants ****

  ****  Section 002  Data  FLS$BUILD_BACKUP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   132-0-0/d STRC(1080)  r     1 BACKUP_CMD_CLOSE           3-0-0/c STRC(108)   r     1 BACKUP_CMD_FNAME
    24-0-0/d STRC(2088)  r     1 BACKUP_CMD_OPEN          116-0-0/d STRC(432)   r     1 BACKUP_CMD_WRITE
    12-0-0/d STRC(360)   r     1 DEL_NODATA_REC

  ****  Section 008 RoData FLS$BUILD_BACKUP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/c CHAR(6)     r     1 BACKUP                    13-0-0/c CHAR        r     1 BLANK
    10-0-0/c CHAR        r     1 COMMA                      5-0-0/c CHAR(3)     r     1 DP#
    15-0-0/c CHAR(6)     r     1 EFT_ACCT                   3-0-0/c CHAR        r     1 LEFT_PAREN
     6-0-0/c CHAR(3)     r     1 LT#                        7-0-0/c CHAR        r     1 POUND
     4-0-0/c CHAR        r     1 RIGHT_PAREN               14-0-0/c CHAR        r     1 SEMI_COLON
     0-0-0/c CHAR        r     1 SLASH                      1-0-0/c CHAR(5)     r     1 XTEND

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    42-0-0/w PTR         r     1 @LAST_OUTPUT              41-0-0/w PTR         r     1 @NEED
     5-0-0/c CHAR(80)    r     1 CMD                        4-0-0/w PTR         r     1 CMD$
    31-0-0/w UBIN        r     1 CT_LEN                     3-0-0/w SBIN        r     1 I
    *0-0-0/w BIT         r     1 LAST_OUTPUT               32-0-0/c CHAR(6)     r     1 LT1
    34-0-0/c CHAR(6)     r     1 LT2                       *0-0-0/w UBIN        r     1 NEED
    36-0-0/w PTR         r     1 SNLIST$

  ****  SYMREF variables  ****

PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:87   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/c ASTR(9)     r     1 BACKUP_NAME
     0-0-0/w PTR         r     1 BLK_TAG$                   0-0-0/w PTR         r     1 BLK_TAG0$
     0-0-0/w PTR         r     1 BLOCK_GRAN$                0-0-0/w SBIN        r     1 DEST_TAPE_VOL
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DISK_GRAN$
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/c ASTR(9)     r     1 DUAL_FILE                  0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE
     0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE          0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE
     0-0-0/w SBIN        r     1 NBR_SNLISTS                0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME
     0-0-0/c STRC(369)   r     1 NODATA_KEY                 0-0-0/c ASTR(9)     r     1 PRIME_FILE
     0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY            0-0-0/c ASTR(9)     r     1 REBUILD_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_NAME               0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w PTR         r     1 TAPE_DCBLIST$
     0-0-0/c ASTR(9)     r     1 TSN_USED_NAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(72)    r     1 BASE_VEC                   0-0-0/c CHAR        r     1 CHAR1
     0-0-0/c CHAR(3)     r     1 CHAR3                      0-0-0/c CHAR(5)     r     1 CHAR5
     0-0-0/c CHAR(6)     r     1 CHAR6                      0-0-0/d STRC(90)    r     1 DPLIST
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DISK00
     0-0-0N  NULL        r     1 M$NODATA_LIST
     0-0-0/d STRC(72)    r     1 SNVECLIST(0:0)
     0-0-0/d STRC(90)    r     1 VLP_SN


   Procedure FLS$BUILD_BACKUP requires 339 words for executable code.
   Procedure FLS$BUILD_BACKUP requires 40 words of local(AUTO) storage.

    No errors detected in file FLS$PROCESS_PRE_RET.:E05TSI    .
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:88   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:89   
          MINI XREF LISTING

ARCHIVE_NAME.L#
      9543**DCL      9543--IMP-SIZ
BACKUP
     10466**DCL     10768>>ASSIGN  10769--ASSIGN
BACKUP_CMD_CLOSE
     10655**DCL     10852<>CALL    10859<>CALL
BACKUP_CMD_CLOSE.SN_
     10655**DCL     10655--REDEF
BACKUP_CMD_CLOSE.UTL_
     10656**DCL     10656--REDEF
BACKUP_CMD_CLOSE.V
     10660**DCL     10655--DCLINIT
BACKUP_CMD_CLOSE.V.EXPIRE#
     10670**DCL     10670--REDEF
BACKUP_CMD_CLOSE.V.TYPE#
     10668**DCL     10668--REDEF
BACKUP_CMD_CLOSE.V.XTNSIZE#
     10665**DCL     10665--REDEF   10667--REDEF
BACKUP_CMD_FNAME
      8647**DCL     10556--DCLINIT
BACKUP_CMD_OPEN
     10555**DCL     10761<>CALL
BACKUP_CMD_OPEN.ACSVEH_
     10557**DCL     10558--REDEF
BACKUP_CMD_OPEN.ALTKEYS_
     10563**DCL     10564--REDEF   10564--REDEF
BACKUP_CMD_OPEN.HDR_
     10562**DCL     10563--REDEF
BACKUP_CMD_OPEN.TAB_
     10561**DCL     10562--REDEF
BACKUP_CMD_OPEN.UHL_
     10555**DCL     10556--REDEF   10556--REDEF
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:90   
BACKUP_CMD_OPEN.V
     10564**DCL     10555--DCLINIT
BACKUP_CMD_OPEN.V.FSN#
     10595**DCL     10595--REDEF   10595--REDEF
BACKUP_CMD_OPEN.WSN_
     10561**DCL     10561--REDEF
BACKUP_CMD_WRITE
     10617**DCL     10877<>CALL
BACKUP_CMD_WRITE.BUF_.BOUND
     10617**DCL     10876<<ASSIGN
BACKUP_CMD_WRITE.BUF_.BUF$
     10619**DCL     10766<<ASSIGN
BACKUP_CMD_WRITE.STATION_
     10619**DCL     10619--REDEF
BACKUP_CMD_WRITE.V
     10620**DCL     10617--DCLINIT
BACKUP_CMD_WRITE.V.DVBYTE.VFC#
     10626**DCL     10626--REDEF
BACKUP_NAME.L#
      9187**DCL      9187--IMP-SIZ
BASE_VEC.PTR$
     10757**DCL     10823>>ASSIGN
BLANK
     10467**DCL     10760>>ASSIGN  10770>>ASSIGN  10771--ASSIGN  10794>>ASSIGN  10808>>ASSIGN  10834>>IF
     10846>>ASSIGN  10883>>ASSIGN
BLK_TAG.NAME
      8679**DCL      8679--REDEF
BLK_TAG$
      8676**DCL      8676--IMP-PTR
BLK_TAG0.NAME
      8685**DCL      8685--REDEF
BLK_TAG0$
      8682**DCL      8682--IMP-PTR
BLOCK_GRAN$
      8689**DCL      8690--IMP-PTR
CHAR1
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:91   
     10753**DCL     10770<<ASSIGN  10788<<ASSIGN  10794<<ASSIGN  10800<<ASSIGN  10802<<ASSIGN  10806<<ASSIGN
     10807--ASSIGN  10808<<ASSIGN  10809--ASSIGN  10837<<ASSIGN  10842<<ASSIGN  10846<<ASSIGN  10873<<ASSIGN
CHAR3
     10751**DCL     10781<<ASSIGN  10830<<ASSIGN
CHAR5
     10750**DCL     10811<<ASSIGN
CHAR6
     10749**DCL     10768<<ASSIGN  10784<<ASSIGN  10804<<ASSIGN  10832<<ASSIGN  10839<<ASSIGN
CHECK_CMD_BUF
     10864**PROC    10780--CALL    10783--CALL    10786--CALL    10796--CALL    10813--CALL    10829--CALL
     10848--CALL
CLOSE_ALT
     10848**LABEL   10776--GOTO    10780--CALLALT 10783--CALLALT 10786--CALLALT 10791--GOTO    10796--CALLALT
     10813--CALLALT 10819--GOTO    10826--GOTO    10829--CALLALT 10848--CALLALT
CLOSE_NODATA_LIST.SN_
     10341**DCL     10341--REDEF
CLOSE_NODATA_LIST.UTL_
     10342**DCL     10342--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
     10356**DCL     10356--REDEF
CLOSE_NODATA_LIST.V.TYPE#
     10354**DCL     10354--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
     10351**DCL     10351--REDEF   10353--REDEF
CLOSE_PRIME_DUAL.SN_
      9818**DCL      9818--REDEF
CLOSE_PRIME_DUAL.UTL_
      9819**DCL      9819--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
      9833**DCL      9833--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
      9831**DCL      9831--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
      9828**DCL      9828--REDEF    9830--REDEF
CLOSE_REBUILD.SN_
     10093**DCL     10093--REDEF
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:92   
CLOSE_REBUILD.UTL_
     10094**DCL     10094--REDEF
CLOSE_REBUILD.V.EXPIRE#
     10108**DCL     10108--REDEF
CLOSE_REBUILD.V.TYPE#
     10106**DCL     10106--REDEF
CLOSE_REBUILD.V.XTNSIZE#
     10103**DCL     10103--REDEF   10105--REDEF
CLOSE_STATUS.SN_
      9308**DCL      9308--REDEF
CLOSE_STATUS.UTL_
      9309**DCL      9309--REDEF
CLOSE_STATUS.V.EXPIRE#
      9323**DCL      9323--REDEF
CLOSE_STATUS.V.TYPE#
      9321**DCL      9321--REDEF
CLOSE_STATUS.V.XTNSIZE#
      9318**DCL      9318--REDEF    9320--REDEF
CLOSE_TSN_USED.SN_
      9018**DCL      9018--REDEF
CLOSE_TSN_USED.UTL_
      9019**DCL      9019--REDEF
CLOSE_TSN_USED.V.EXPIRE#
      9033**DCL      9033--REDEF
CLOSE_TSN_USED.V.TYPE#
      9031**DCL      9031--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
      9028**DCL      9028--REDEF    9030--REDEF
CMD
     10475**DCL     10759--ASSIGN  10760<<ASSIGN  10766--ASSIGN  10795--IF      10847--IF      10869--IF
     10876--ASSIGN  10882--ASSIGN  10883<<ASSIGN
CMD$
     10474**DCL     10759<<ASSIGN  10768>>ASSIGN  10769<<ASSIGN  10769>>ASSIGN  10770>>ASSIGN  10771<<ASSIGN
     10771>>ASSIGN  10781>>ASSIGN  10782<<ASSIGN  10782>>ASSIGN  10784>>ASSIGN  10785<<ASSIGN  10785>>ASSIGN
     10788>>ASSIGN  10789<<ASSIGN  10789>>ASSIGN  10793<<ASSIGN  10793>>ASSIGN  10794>>ASSIGN  10795>>IF
     10800>>ASSIGN  10801<<ASSIGN  10801>>ASSIGN  10802>>ASSIGN  10803<<ASSIGN  10803>>ASSIGN  10804>>ASSIGN
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:93   
     10805<<ASSIGN  10805>>ASSIGN  10806>>ASSIGN  10807<<ASSIGN  10807>>ASSIGN  10808>>ASSIGN  10809<<ASSIGN
     10809>>ASSIGN  10811>>ASSIGN  10812<<ASSIGN  10812>>ASSIGN  10830>>ASSIGN  10831<<ASSIGN  10831>>ASSIGN
     10832>>ASSIGN  10833<<ASSIGN  10833>>ASSIGN  10837>>ASSIGN  10838<<ASSIGN  10838>>ASSIGN  10839>>ASSIGN
     10840<<ASSIGN  10840>>ASSIGN  10842>>ASSIGN  10843<<ASSIGN  10843>>ASSIGN  10845<<ASSIGN  10845>>ASSIGN
     10846>>ASSIGN  10847>>IF      10869>>IF      10873>>ASSIGN  10874<<ASSIGN  10874>>ASSIGN  10876>>ASSIGN
     10882<<ASSIGN
COMMA
     10465**DCL     10788>>ASSIGN  10789--ASSIGN  10793--ASSIGN  10820--ASSIGN  10842>>ASSIGN  10843--ASSIGN
     10845--ASSIGN
CON_CLOSE_ARCHIVE.SN_
      9350**DCL      9350--REDEF
CON_CLOSE_ARCHIVE.UTL_
      9351**DCL      9351--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
      9365**DCL      9365--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
      9363**DCL      9363--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
      9360**DCL      9360--REDEF    9362--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
      9437**DCL      9438--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
      9443**DCL      9444--REDEF    9444--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
      9442**DCL      9443--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
      9441**DCL      9442--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
      9435**DCL      9436--REDEF    9436--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
      9475**DCL      9475--REDEF    9475--REDEF
CON_OPEN_ARCHIVE_FILE.WSN_
      9441**DCL      9441--REDEF
CON_READ_ARCHIVE_FILE.STATION_
      9499**DCL      9500--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:94   
      9511**DCL      9511--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
      9509**DCL      9509--REDEF
CT_LEN
     10476**DCL     10820<<ASSIGN  10829<>CALL
CVOL_UTL.ULBL#
      8778**DCL      8778--REDEF
DEL_NODATA_REC.V
     10444**DCL     10441--DCLINIT
DEST_TAPE_VOL
      8782**DCL     10824>>ASSIGN  10827>>IF      10828>>ASSIGN  10834>>IF
DISK_CLOSE.SN_
      7848**DCL      7848--REDEF
DISK_CLOSE.UTL_
      7849**DCL      7849--REDEF
DISK_CLOSE.V.EXPIRE#
      7863**DCL      7863--REDEF
DISK_CLOSE.V.TYPE#
      7861**DCL      7861--REDEF
DISK_CLOSE.V.XTNSIZE#
      7858**DCL      7858--REDEF    7860--REDEF
DISK_FILE_SPEC.SPEC
      8213**DCL      8215--REDEF
DISK_FILE_SPEC.SPEC.START
      8214**DCL      8214--REDEF
DISK_FILE_SPEC.SPEC.STOP
      8215**DCL      8215--REDEF
DISK_FILE_SPEC$
      8212**DCL      8213--IMP-PTR
DISK_GRAN$
      8689**DCL      8689--IMP-PTR
DISK_OPEN.ACSVEH_
      7713**DCL      7714--REDEF
DISK_OPEN.ALTKEYS_
      7719**DCL      7720--REDEF    7720--REDEF
DISK_OPEN.HDR_
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:95   
      7718**DCL      7719--REDEF
DISK_OPEN.TAB_
      7717**DCL      7718--REDEF
DISK_OPEN.UHL_
      7711**DCL      7712--REDEF    7712--REDEF
DISK_OPEN.V.FSN#
      7751**DCL      7751--REDEF    7751--REDEF
DISK_OPEN.WSN_
      7717**DCL      7717--REDEF
DISK_READ.STATION_
      7775**DCL      7776--REDEF
DISK_READ.V.DVBYTE.REREAD#
      7787**DCL      7787--REDEF
DISK_READ.V.INDX#
      7785**DCL      7785--REDEF
DISK_WRITE.STATION_
      7813**DCL      7813--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      7820**DCL      7820--REDEF
DP#
     10462**DCL     10780--CALL    10781>>ASSIGN  10782--ASSIGN
DPLIST.NUM#
      8210**DCL     10775>>IF      10777>>DOINDEX
DPLIST.SN#
      8210**DCL     10778>>IF      10783--CALL    10784>>ASSIGN  10785--ASSIGN  10786--CALL
DPLIST$
      8198**DCL      8210--IMP-PTR 10775>>IF      10777>>DOINDEX 10778>>IF      10784>>ASSIGN
DPRESLIST$
      8212**DCL      8212--IMP-PTR
DUAL_FILE.L#
      9614**DCL      9614--IMP-SIZ
EFTWORD
      8333**DCL      8333--REDEF
EFT_ACCT
     10469**DCL     10804>>ASSIGN  10805--ASSIGN
EFT_CVOL_FILE.L#
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:96   
      8738**DCL      8738--IMP-SIZ
EFT_RESTRICT_FILE.L#
      8765**DCL      8765--IMP-SIZ
F$DCB.ACTPOS
     10707**DCL     10707--REDEF
F$DCB.ARS#
     10681**DCL     10681--REDEF
F$DCB.ATTR
     10700**DCL     10701--REDEF
F$DCB.BORROW
     10715**DCL     10715--REDEF   10715--REDEF   10715--REDEF
F$DCB.DCBNAME.L
     10729**DCL     10729--IMP-SIZ
F$DCB.EOMCHAR#
     10685**DCL     10685--REDEF
F$DCB.FCD#
     10694**DCL     10851>>IF      10858>>IF
F$DCB.FLDID
     10710**DCL     10710--REDEF
F$DCB.FORM$
     10704**DCL     10704--REDEF
F$DCB.FSECT
     10720**DCL     10720--REDEF
F$DCB.FSN#
     10697**DCL     10697--REDEF   10697--REDEF   10698--REDEF
F$DCB.HEADER$
     10703**DCL     10703--REDEF
F$DCB.IXTNSIZE#
     10701**DCL     10701--REDEF
F$DCB.LASTSTA$
     10690**DCL     10690--REDEF
F$DCB.LVL
     10716**DCL     10716--REDEF
F$DCB.NAME#.C
     10691**DCL     10691--REDEF
F$DCB.NOEOF
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:97   
     10713**DCL     10713--REDEF
F$DCB.NRECS#
     10702**DCL     10702--REDEF
F$DCB.NRECX
     10721**DCL     10721--REDEF
F$DCB.OHDR
     10713**DCL     10713--REDEF
F$DCB.ORG#
     10696**DCL     10696--REDEF
F$DCB.PRECNO
     10719**DCL     10719--REDEF
F$DCB.RCSZ
     10725**DCL     10725--REDEF
F$DCB.RES#
     10692**DCL     10692--REDEF
F$DCB.SETX
     10704**DCL     10704--REDEF
F$DCB.TAB$
     10704**DCL     10704--REDEF
F$DCB.TDA
     10718**DCL     10719--REDEF
F$DCB.WSN#
     10692**DCL     10692--REDEF
FIT_AREA.W2
      9049**DCL      9050--REDEF
FLI$RPT_ERR
     10454**DCL-ENT 10763--CALL    10854--CALL    10861--CALL    10879--CALL
FPT_EXIT.V.STEPCC#
      7638**DCL      7638--REDEF
I
     10473**DCL     10777<<DOINDEX 10778>>IF      10784>>ASSIGN  10822<<DOINDEX 10823>>ASSIGN
LAST_OUTPUT IN PROCEDURE CHECK_CMD_BUF
     10867**DCL     10864--PROC    10871>>IF
LEFT_PAREN
     10460**DCL     10802>>ASSIGN  10803--ASSIGN
LT#
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:98   
     10463**DCL     10820--ASSIGN  10830>>ASSIGN  10831--ASSIGN
LT1
     10477**DCL     10824<<ASSIGN  10825>>IF      10832>>ASSIGN  10833--ASSIGN
LT2
     10478**DCL     10828<<ASSIGN  10834>>IF      10839>>ASSIGN  10840--ASSIGN
M$CLOSE
      5498**DCL-ENT 10852--CALL    10859--CALL
M$DISK00
     10745**DCL     10851--IF      10858--IF
M$OPEN
      5498**DCL-ENT 10761--CALL
M$WRITE
      5499**DCL-ENT 10877--CALL
NBR_BYTES_TO_MOVE
      8688**DCL      8689--IMP-SIZ  8690--IMP-SIZ
NBR_SNLISTS
      7625**DCL     10818>>IF      10822>>DOINDEX
NEED IN PROCEDURE CHECK_CMD_BUF
     10866**DCL     10864--PROC    10869>>IF      10869>>IF
NODATA_FILE_NAME.L#
     10303**DCL     10303--IMP-SIZ
NODATA_KEY
     10449**DCL     10441--DCLINIT 10442--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
     10236**DCL     10237--REDEF
OPEN_NODATA_LIST.ALTKEYS_
     10242**DCL     10243--REDEF   10243--REDEF
OPEN_NODATA_LIST.HDR_
     10241**DCL     10242--REDEF
OPEN_NODATA_LIST.TAB_
     10240**DCL     10241--REDEF
OPEN_NODATA_LIST.UHL_
     10234**DCL     10235--REDEF   10235--REDEF
OPEN_NODATA_LIST.V.FSN#
     10274**DCL     10274--REDEF   10274--REDEF
OPEN_NODATA_LIST.WSN_
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:99   
     10240**DCL     10240--REDEF
OPEN_PRIME_DUAL.ACSVEH_
      9683**DCL      9684--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
      9689**DCL      9690--REDEF    9690--REDEF
OPEN_PRIME_DUAL.HDR_
      9688**DCL      9689--REDEF
OPEN_PRIME_DUAL.TAB_
      9687**DCL      9688--REDEF
OPEN_PRIME_DUAL.UHL_
      9681**DCL      9682--REDEF    9682--REDEF
OPEN_PRIME_DUAL.V.FSN#
      9721**DCL      9721--REDEF    9721--REDEF
OPEN_PRIME_DUAL.WSN_
      9687**DCL      9687--REDEF
OPEN_REBUILD.ACSVEH_
      9918**DCL      9919--REDEF
OPEN_REBUILD.ALTKEYS_
      9924**DCL      9925--REDEF    9925--REDEF
OPEN_REBUILD.HDR_
      9923**DCL      9924--REDEF
OPEN_REBUILD.TAB_
      9922**DCL      9923--REDEF
OPEN_REBUILD.UHL_
      9916**DCL      9917--REDEF    9917--REDEF
OPEN_REBUILD.V.FSN#
      9956**DCL      9956--REDEF    9956--REDEF
OPEN_REBUILD.WSN_
      9922**DCL      9922--REDEF
OPEN_STATUS.ACSVEH_
      9120**DCL      9121--REDEF
OPEN_STATUS.ALTKEYS_
      9126**DCL      9127--REDEF    9127--REDEF
OPEN_STATUS.HDR_
      9125**DCL      9126--REDEF
OPEN_STATUS.TAB_
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:100  
      9124**DCL      9125--REDEF
OPEN_STATUS.UHL_
      9118**DCL      9119--REDEF    9119--REDEF
OPEN_STATUS.V.FSN#
      9158**DCL      9158--REDEF    9158--REDEF
OPEN_STATUS.WSN_
      9124**DCL      9124--REDEF
OPEN_TSN_USED.ACSVEH_
      8856**DCL      8857--REDEF
OPEN_TSN_USED.ALTKEYS_
      8862**DCL      8863--REDEF    8863--REDEF
OPEN_TSN_USED.HDR_
      8861**DCL      8862--REDEF
OPEN_TSN_USED.TAB_
      8860**DCL      8861--REDEF
OPEN_TSN_USED.UHL_
      8854**DCL      8855--REDEF    8855--REDEF
OPEN_TSN_USED.V.FSN#
      8894**DCL      8894--REDEF    8894--REDEF
OPEN_TSN_USED.WSN_
      8860**DCL      8860--REDEF
POUND
     10464**DCL     10820--ASSIGN  10837>>ASSIGN  10838--ASSIGN
PRE_RET_CLOSE.SN_
      8576**DCL      8576--REDEF
PRE_RET_CLOSE.UTL_
      8577**DCL      8577--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      8591**DCL      8591--REDEF
PRE_RET_CLOSE.V.TYPE#
      8589**DCL      8589--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      8586**DCL      8586--REDEF    8588--REDEF
PRE_RET_OPEN.ACSVEH_
      8511**DCL      8512--REDEF
PRE_RET_OPEN.ALTKEYS_
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:101  
      8517**DCL      8518--REDEF    8518--REDEF
PRE_RET_OPEN.HDR_
      8516**DCL      8517--REDEF
PRE_RET_OPEN.TAB_
      8515**DCL      8516--REDEF
PRE_RET_OPEN.UHL_
      8509**DCL      8510--REDEF    8510--REDEF
PRE_RET_OPEN.V.FSN#
      8549**DCL      8549--REDEF    8549--REDEF
PRE_RET_OPEN.WSN_
      8515**DCL      8515--REDEF
PRE_RET_READ.STATION_
      8366**DCL      8367--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      8378**DCL      8378--REDEF
PRE_RET_READ.V.INDX#
      8376**DCL      8376--REDEF
PRE_RET_WRITE.STATION_
      8404**DCL      8404--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      8411**DCL      8411--REDEF
PRIME_FILE.L#
      9587**DCL      9587--IMP-SIZ
READ_NODATA_LIST.STATION_
     10380**DCL     10381--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
     10392**DCL     10392--REDEF
READ_NODATA_LIST.V.INDX#
     10390**DCL     10390--REDEF
READ_PRIME_DUAL.STATION_
      9745**DCL      9746--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
      9757**DCL      9757--REDEF
READ_PRIME_DUAL.V.INDX#
      9755**DCL      9755--REDEF
READ_REBUILD.STATION_
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:102  
     10051**DCL     10052--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
     10063**DCL     10063--REDEF
READ_REBUILD.V.INDX#
     10061**DCL     10061--REDEF
READ_STATUS.STATION_
      9266**DCL      9267--REDEF
READ_STATUS.V.DVBYTE.REREAD#
      9278**DCL      9278--REDEF
READ_STATUS.V.INDX#
      9276**DCL      9276--REDEF
READ_TSN_USED.STATION_
      8976**DCL      8977--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
      8988**DCL      8988--REDEF
READ_TSN_USED.V.INDX#
      8986**DCL      8986--REDEF
REBUILD_DIR_KEY.L#
     10137**DCL     10137--IMP-SIZ
REBUILD_KEY.L#
     10164**DCL     10164--IMP-SIZ
REBUILD_NAME.L#
      9985**DCL      9985--IMP-SIZ
RET_CMDS_NAME.L#
      8620**DCL      8620--IMP-SIZ
RIGHT_PAREN
     10461**DCL     10806>>ASSIGN
SEMI_COLON
     10468**DCL     10873>>ASSIGN  10874--ASSIGN
SLASH
     10458**DCL     10800>>ASSIGN  10801--ASSIGN
SNLIST$
     10479**DCL     10823<<ASSIGN  10824>>ASSIGN  10827>>IF      10828>>ASSIGN  10834>>IF
SNVECLIST
      8152**DCL     10823--ASSIGN
SNVECLIST$
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:103  
      8152**DCL      8152--IMP-PTR 10823>>ASSIGN
SPEC.START
      8216**DCL      8217--REDEF
SPEC.STOP
      8217**DCL      8218--REDEF
SPECCHARS
      8216**DCL      8216--REDEF
TAPE_BLOCK_.W2
      8704**DCL      8705--REDEF
TAPE_CLOSE.SN_
      8069**DCL      8069--REDEF
TAPE_CLOSE.UTL_
      8070**DCL      8070--REDEF
TAPE_CLOSE.V.EXPIRE#
      8084**DCL      8084--REDEF
TAPE_CLOSE.V.TYPE#
      8082**DCL      8082--REDEF
TAPE_CLOSE.V.XTNSIZE#
      8079**DCL      8079--REDEF    8081--REDEF
TAPE_DCBLIST$
      7625**DCL      7625--IMP-PTR
TAPE_OPEN.ACSVEH_
      7934**DCL      7935--REDEF
TAPE_OPEN.ALTKEYS_
      7940**DCL      7941--REDEF    7941--REDEF
TAPE_OPEN.HDR_
      7939**DCL      7940--REDEF
TAPE_OPEN.TAB_
      7938**DCL      7939--REDEF
TAPE_OPEN.UHL_
      7932**DCL      7933--REDEF    7933--REDEF
TAPE_OPEN.V.FSN#
      7972**DCL      7972--REDEF    7972--REDEF
TAPE_OPEN.WSN_
      7938**DCL      7938--REDEF
TAPE_READ.STATION_
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:104  
      7996**DCL      7997--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      8008**DCL      8008--REDEF
TAPE_READ.V.INDX#
      8006**DCL      8006--REDEF
TAPE_WRITE.STATION_
      8034**DCL      8034--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      8041**DCL      8041--REDEF
TSN_USED_NAME.L#
      8923**DCL      8923--IMP-SIZ
TVECTOR.W2
      8165**DCL      8166--REDEF
VLP_SN.NUM#
     10742**DCL     10827>>IF      10834>>IF
VLP_SN.SN#
     10742**DCL     10820--ASSIGN  10824>>ASSIGN  10828>>ASSIGN
WRITE_NODATA_LIST.STATION_
     10418**DCL     10418--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
     10425**DCL     10425--REDEF
WRITE_PRIME_DUAL.STATION_
      9783**DCL      9783--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
      9790**DCL      9790--REDEF
WRITE_REBUILD.STATION_
     10019**DCL     10019--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
     10026**DCL     10026--REDEF
WRITE_STATUS.STATION_
      9234**DCL      9234--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
      9241**DCL      9241--REDEF
WRITE_TSN_USED.STATION_
      8944**DCL      8944--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
PL6.E3A0      #002=FLS$BUILD_BACKUP File=FLS$PROCESS_PRE_RET.:E05TSI             TUE 07/29/97 16:22 Page:105  
      8951**DCL      8951--REDEF
XTEND
     10459**DCL     10811>>ASSIGN  10812--ASSIGN
