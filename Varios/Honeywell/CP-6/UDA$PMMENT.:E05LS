VERSION E05

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:1    
        1        1        /*M*   UDA$PMMENT   Monitor Services Decoder    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0    */
        8        8
        9        9        UDA$PMMENT: PROC;
       10       10
       11       11                                                /* INCLUDE files                      */
       12       12        %INCLUDE B$SS;
       13      191        %INCLUDE B$JIT;
       14      794        %INCLUDE B$ROSEG;
       15      857        %INCLUDE B_MAGIC_C;
       16      975        %INCLUDE B_STRINGS_C;
       17     1104        %INCLUDE CP_6_SUBS;
       18     1644        %INCLUDE EL_SUBS_C;
       19     1728        %INCLUDE ES_TABLES_M;
       20     2122        %INCLUDE ES_SUBS_E;
       21     2148        %INCLUDE F$CP6V_C;
       22     2374        %INCLUDE HF_ERRORS_C;
       23     2459        %INCLUDE HF_LOCK_C;
       24     2473        %INCLUDE JG_GHOSTS_C;
       25     2563        %INCLUDE M_ERRORS_C;
       26     2627        %INCLUDE M_INFO_C;
       27     2767        %INCLUDE MM$CP6V_C;
       28     2835        %INCLUDE PC_SUBS_C;
       29     3167        %INCLUDE TD$CP6V_C;
       30     3203        %INCLUDE UD_ERRORS_C;
       31     3245        %INCLUDE UD_SEV_C;
       32     3259        %INCLUDE UD_EQU_E;
       33     3648        %INCLUDE UM_CP6;
       34     4500
       35     4501                                                /* AUTO Storage                       */
       36     4502
       37     4503    1   DCL CODE SBIN;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:2    
       38     4504    1   DCL FLINK REDEF CODE SBIN;
       39     4505    1   DCL FCG UBIN(36);
       40     4506    1   DCL PP REDEF FCG SBIN;
       41     4507    1   DCL DOMAIN# UBIN(36);
       42     4508    1   DCL ES_INDX UBIN;
       43     4509    1   DCL VPNO UBIN(36);
       44     4510    1   DCL ERR REDEF VPNO BIT(36);
       45     4511        %ES$MON_SRV (STCLASS=STATIC);
       46     4526    1   DCL TEMP STATIC BIT(36);
       47     4527
       48     4528                                                /* External Procedures                */
       49     4529
       50     4530    1   DCL AFA$ACCT      ENTRY;
       51     4531    1   DCL ELA$SYSLOG    ENTRY(6) ALTRET;
       52     4532    1   DCL EMH$HELP      ENTRY;
       53     4533    1   DCL EMR$ERRMSG    ENTRY;
       54     4534    1   DCL FMF$CHECK     ENTRY;
       55     4535    1   DCL FMF$CORRES    ENTRY;
       56     4536    1   DCL FMF$PMME      ENTRY(1);
       57     4537    1   DCL FMF$SETFMA    ENTRY;
       58     4538    1   DCL FMF$TRUNC     ENTRY(1);
       59     4539    1   DCL FMM$GETDCB    ENTRY;
       60     4540    1   DCL FMM$OPN       ENTRY;
       61     4541    1   DCL FMM$RELDCB    ENTRY;
       62     4542    1   DCL FMN$MADMUCK   ENTRY;
       63     4543    1   DCL FMP$CLS       ENTRY;
       64     4544    1   DCL FMQ$RELSTARFP ENTRY;
       65     4545    1   DCL FOM$PMME      ENTRY(1);
       66     4546    1   DCL FOS$PMME      ENTRY;
       67     4547    1   DCL FRP$PMME      ENTRY(1);
       68     4548    1   DCL FSD$XFLUSH    ENTRY    ALTRET;
       69     4549    1   DCL FSL$LDEV      ENTRY;
       70     4550    1   DCL FSM$DEVICE    ENTRY;
       71     4551    1   DCL FSM$LINES     ENTRY;
       72     4552    1   DCL FTC$REM       ENTRY;
       73     4553    1   DCL FTC$REW       ENTRY;
       74     4554    1   DCL FTW$CVOL      ENTRY    ALTRET;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:3    
       75     4555    1   DCL JGP$PMME      ENTRY(1);
       76     4556    1   DCL JSE$ABORTM    ENTRY;
       77     4557    1   DCL JSE$EXITS     ENTRY;
       78     4558    1   DCL JSP$PMME      ENTRY(1);
       79     4559    1   DCL JSS$FIXLASR   ENTRY;
       80     4560    1   DCL JZD$ASUSER    ENTRY    ALTRET;
       81     4561    1   DCL JZD$DSUSER    ENTRY    ALTRET;
       82     4562    1   DCL JZD$FSUSER    ENTRY    ALTRET;
       83     4563    1   DCL KCP$PMME      ENTRY(1) ALTRET;
       84     4564    1   DCL KIC$CONFIG    ENTRY;
       85     4565    1   DCL KIF$FPRG      ENTRY(1) ALTRET;
       86     4566    1   DCL KIP$CPMME     ENTRY(1);
       87     4567    1   DCL KIP$PMME      ENTRY(1);
       88     4568    1   DCL KLM$EXHUME    ENTRY    ALTRET;
       89     4569    1   DCL KLM$PATHCON   ENTRY    ALTRET;
       90     4570    1   DCL MMP$PMME      ENTRY(2);
       91     4571    1   DCL OCU$OCMSG     ENTRY(1);
       92     4572    1   DCL OCU$PMME      ENTRY    ALTRET;
       93     4573    1   DCL OTW$PMME      ENTRY(1);
       94     4574    1   DCL PHA$SMOUSE    ENTRY;
       95     4575    1   DCL PHA$XMOUSE    ENTRY;
       96     4576    1   DCL PHA$GETMOUSE  ENTRY;
       97     4577    1   DCL PHA$GETPM     ENTRY;
       98     4578    1   DCL PHP$START_PMME ENTRY;
       99     4579    1   DCL SSC$STATE     ENTRY;
      100     4580    1   DCL SSR$MRUE      ENTRY;
      101     4581    1   DCL UMS$NXTUSR      ENTRY    ALTRET;
      102     4582    1   DCL UMS$SYSID ENTRY;
      103     4583    1   DCL SSS$BLOCK     ENTRY;
      104     4584    1   DCL S_TIME        ENTRY(3);
      105     4585    1   DCL TDP$PMME      ENTRY(1);
      106     4586    1   DCL UDB$AUTOQ     ENTRY;
      107     4587    1   DCL UDB$PMMEXIT   ENTRY;
      108     4588    1   DCL UDB$PMMEXIT1  ENTRY;
      109     4589    1   DCL UEP$PMME      ENTRY(3) ALTRET;
      110     4590    1   DCL UMC$CMDVAR    ENTRY;
      111     4591    1   DCL UMD$DRIBBLE   ENTRY(2)    ALTRET;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:4    
      112     4592    1   DCL UMF$FID       ENTRY;
      113     4593    1   DCL UMT$CHGUNIT   ENTRY;
      114     4594    1   DCL UMT$MISC      ENTRY;
      115     4595    1   DCL UMT$MONINFO   ENTRY;
      116     4596    1   DCL UMT$RPRIV     ENTRY;
      117     4597    1   DCL UMT$RSWITCH   ENTRY;
      118     4598    1   DCL UMT$SPRIV     ENTRY;
      119     4599    1   DCL UMT$SSWITCH   ENTRY;
      120     4600    1   DCL UMT$SYSLOAD   ENTRY;
      121     4601    1   DCL UMT$TIME      ENTRY    ALTRET;
      122     4602    1   DCL UMT$WAIT      ENTRY;
      123     4603    1   DCL UMT$XEQTIME   ENTRY;
      124     4604    1   DCL UMU$UNFID     ENTRY;
      125     4605    1   DCL UQB$UDEQ      ENTRY(1) ALTRET;
      126     4606    1   DCL UQB$UENQ      ENTRY(1) ALTRET;
      127     4607
      128     4608    1   DCL SC_FMC96 ENTRY CONV(2, 0);
      129     4609
      130     4610                                                /* External Data                      */
      131     4611
      132     4612    1   DCL UD_MAXTAB(0:%MAX_FCG#) SBIN SYMREF;
      133     4613
      134     4614    1   DCL B$ROSEG$ PTR SYMREF READONLY;
      135     4615    1   DCL B$JIT$ PTR SYMREF READONLY;
      136     4616    1   DCL B$PS0$ PTR SYMREF READONLY;
      137     4617    1   DCL FMC_TYPTBL$ PTR SYMREF;
      138     4618        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
      139     4711
      140     4712    1   DCL ES_LOGMONSER UBIN WORD SYMREF;
      141     4713    1   DCL ES_MONSERTBL(0:%MAX_FCG#) BIT(36) ALIGNED SYMREF;
      142     4714
      143     4715    1   DCL FMC_LOCK BIT(72) SYMREF;
      144     4716    1   DCL J_SYSTXT CHAR(8) SYMREF;
      145     4717    1   DCL PH_MOUSE_USERS SBIN WORD SYMREF;
      146     4718    1   DCL S_PNO UBIN(36) SYMREF;
      147     4719    1   DCL P_CALCNT(0:3) SBIN SYMREF;
      148     4720    1   DCL P_CALCOMP(0:3) SBIN SYMREF;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:5    
      149     4721    1   DCL S_CUN SBIN SYMREF;
      150     4722    1   DCL S_MING SBIN SYMREF;
      151     4723    1   DCL S_INCTIME SBIN SYMREF;
      152     4724    1   DCL S_TIMR UBIN SYMREF;
      153     4725
      154     4726                                                /* BASED Structures                   */
      155     4727
      156     4728    1   DCL B$DCB$TAB(0:15) PTR BASED;
      157     4729    1   DCL DCB# UBIN HALF BASED;
      158     4730
      159     4731        %FPT$CVM_V;
      160     4735        %FPT$RESCTL_V;
      161     4738        %FPT$SMPRT_V;
      162     4741        %FPT$SYSCON_V;
      163     4745
      164     4746
      165     4747        /* Data for the Security features implemented for C00.
      166     4748        */
      167     4749
      168     4750    1   DCL MM_PRIVS(0:12) BIT(36) CONSTANT INIT(
      169     4751    1       %PR_EXMM#/*M$STLPP*/,
      170     4752    1       %PR_EXMM#/*M$RSPP*/,
      171     4753    1       %PR_MM#/*M$CVM*/,
      172     4754    1       %PR_EXMM#/*M$SMPRT*/,
      173     4755    1       %PR_EXMM#/*M$SSC*/,
      174     4756    1       '0'B/*M$GDDL*/,
      175     4757    1       %PR_MM#/*M$SAD*/,
      176     4758    1       '0'B/*M$STD*/,
      177     4759    1       %PR_TDSYSCN#/*M$BADPP*/,
      178     4760    1       %PR_TDSYSCN#/*M$GOODPP*/,
      179     4761    1       %PR_TDSYSCN#/*M$GBPL*/,
      180     4762    1       %PR_TDSYSCN#/*M$MPL*/,
      181     4763    1       %PR_TDSYSCN#/*M$UMPL*/);
      182     4764
      183     4765    1   DCL TD_PRIVS(0:8) BIT(36) CONSTANT INIT(
      184     4766    1       %PR_SYSACCT#/*M$RDSYSLOG*/,
      185     4767    1       %PR_WRSYSLG#/*M$WRSYSLOG*/,
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:6    
      186     4768    1       %PR_TND#/*M$TDOPEN*/,
      187     4769    1       %PR_TND#/*M$TDCLOSE*/,
      188     4770    1       %PR_TND#/*M$TDIO*/,
      189     4771    1       %PR_TND#/*M$TDREQCPU*/,
      190     4772    1       %PR_IOQ#/*M$IOQ*/,
      191     4773    1       %PR_SYSCON#/*M$SYSCON*/,
      192     4774    1       %(PR_IOQ#|PR_IOQW#)/*M$MIRROR*/);
      193     4775
      194     4776    1   DCL PH_PRIVS(0:3) BIT(36) CONSTANT INIT(
      195     4777    1       %PR_EXPM#/*M$SMOUSE*/,
      196     4778    1       %PR_EXPM#/*M$XMOUSE*/,
      197     4779    1       %PR_PM#/*M$GETMOUSE*/,
      198     4780    1       %PR_PM#/*M$GETPM*/);
      199     4781
      200     4782
      201     4783
      202     4784                                                /* String Substitutions               */
      203     4785
      204     4786        %SUB B$JIT = B$JIT$->B$JIT;
      205     4787        %SUB B$SS = B_MPT.SS$->B$SS;
      206     4788        %SUB B$ROSEG = B$ROSEG$->B$ROSEG;
      207     4789
      208     4790
      209     4791                                                /* Error Codes                        */
      210     4792
      211     4793        %VLP_ERRCODE (FPTN=MM_PRIV,FCG=MM,MID=A,ERR#=%E$MMPRIV,SEV=SEV_ERR#);
      212     4838        %VLP_ERRCODE (FPTN=TD_PRIV,FCG=TD,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      213     4883        %VLP_ERRCODE (FPTN=PH_PRIV,FCG=PH,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      214     4928        %VLP_ERRCODE (FPTN=KI_PRIV,FCG=KI,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      215     4973        %VLP_ERRCODE (FPTN=OC_PRIV,FCG=OC,MID=A,ERR#=%E$DOMAIN,SEV=SEV_ERR#);
      216     5018        %VLP_ERRCODE (FPTN=UM_PRIV,FCG=UM,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      217     5063        %VLP_ERRCODE (FPTN=JS_PRIV,FCG=JS,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      218     5108        %VLP_ERRCODE (FPTN=FR_PRIV,FCG=FR,MID=A,ERR#=%E$DOMAIN,SEV=SEV_ERR#);
      219     5153
      220     5154        %VLP_ERRCODE (FPTN=EBADDCB,FCG=UD,MID=A,ERR#=%E$BADDCB#,SEV=SEV_ERR#);
      221     5199        %VLP_ERRCODE (FPTN=EOPTPMME,FCG=UD,MID=A,ERR#=%E$OPTPMME,SEV=SEV_ERR#);
      222     5244        %VLP_ERRCODE (FPTN=EBADCODE,FCG=UD,MID=A,ERR#=%E$BADCODE,SEV=SEV_ERR#);
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:7    
      223     5289        %VLP_ERRCODE (FPTN=EDOMAIN,FCG=UD,MID=A,ERR#=%E$DOMAIN,SEV=SEV_ERR#);
      224     5334        %VLP_ERRCODE (FPTN=EOLDPMME,FCG=PH,MID=A,ERR#=%E$OLDPMME,SEV=SEV_ERR#);
      225     5379
      226     5380        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:8    
      227     5381         /*F*  NAME:         UDA$PMMENT
      228     5382
      229     5383               PURPOSE:      UDA $PMMENT is the CP-6 monitor services decoder.
      230     5384
      231     5385               DESCRIPTION:
      232     5386
      233     5387         UDA$PMMENT is entered with the auto pointer and the
      234     5388         contents of X0 saved in the Safe-Store frame by a
      235     5389         BMAP routine.
      236     5390
      237     5391        */
      238     5392    1      GOTO NOTUPMME;
      239     5393
      240     5394    1   UDA$UPMMENT: ENTRY;
      241     5395
      242     5396    2      DO INHIBIT;
      243     5397    2           B$JIT.XTIME=B$JIT.XTIME+S_INCTIME;
      244     5398    2           S_TIMR=1;
      245     5399    2           END;
      246     5400    1      B$JIT.CALCNT=B$JIT.CALCNT+1;
      247     5401
      248     5402    1   NOTUPMME: P_CALCNT(S_PNO) = P_CALCNT(S_PNO)+1;
      249     5403
      250     5404
      251     5405    1      IF PH_MOUSE_USERS ~=0 THEN CALL PHP$START_PMME;
      252     5406
      253     5407    1      CODE = B$SS.FPT.CODE;
      254     5408    1      FCG = B$SS.FPT.FCG;
      255     5409
      256     5410    1      IF FCG = %FCG_FM1#
      257     5411    2      THEN DO;
      258     5412    2           B$JIT.ERR = '0'B;
      259     5413    2           IF CODE > UD_MAXTAB(%FCG_FM1#)
      260     5414    2           THEN GOTO BADX0;
      261     5415
      262     5416    2           IF B$PS0$ -> DCB# > B$ROSEG.NUMDCBS
      263     5417    2           THEN GOTO FM1_BADDCB;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:9    
      264     5418
      265     5419    2           B$JIT.DCBNO = B$PS0$ -> DCB#;
      266     5420    2           B$JIT.DCB$ = B$ROSEG.DCBPTR$ -> B$DCB$TAB (B$PS0$ -> DCB#);
      267     5421    2           IF B$JIT.DCB$ = ADDR(NIL)
      268     5422    2           THEN GOTO FM1_BADDCB;
      269     5423
      270     5424    2           CALL FMF$PMME (CODE);
      271     5425    2           END;
      272     5426
      273     5427
      274     5428    2      ELSE DO;
      275     5429    2           IF ( (FCG > %MAX_FCG#) OR (CODE > UD_MAXTAB(FCG)) )
      276     5430    3           THEN DO;
      277     5431    3   BADX0:       ;
      278     5432    3                B$JIT.ERR=EBADCODE;
      279     5433    3                CALL UDB$PMMEXIT;
      280     5434    3                END;
      281     5435
      282     5436    2           IF UD_MAXTAB(FCG) = -1
      283     5437    3           THEN DO;
      284     5438    3                B$JIT.ERR =EOPTPMME;
      285     5439    3                CALL UDB$PMMEXIT;
      286     5440    3                END;
      287     5441
      288     5442    2           B$JIT.ERR='0'B;
      289     5443    2           B$JIT.DCB$ = ADDR(NIL);
      290     5444    2           B$JIT.DCBNO=0;
      291     5445
      292     5446    2           DOMAIN# = B$SS.ISR.WSR;
      293     5447        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:10   
      294     5448
      295     5449    3           DO CASE(FCG);
      296     5450
      297     5451    3            CASE(%FCG_JS#);
      298     5452    4              DO CASE(CODE);
      299     5453    4               CASE(0);
      300     5454    4                 GOTO BADX0;
      301     5455
      302     5456    4               CASE(%C$EXIT#, %C$ERR#, %C$XXX#);
      303     5457    4                 CALL JSE$EXITS;
      304     5458
      305     5459    4               CASE(%C$SCREECH#);
      306     5460    4                 IF (B$SS.ISR.WSR  = %USERWSR) AND (S_CUN > S_MING)
      307     5461    5                 THEN DO;
      308     5462    5                      ES$MON_SRV.PRIV# = %PR_EXMM#;
      309     5463
      310     5464    5                      IF NOT(B$JIT.PRIV.ACTIVE & %PR_EXMM#)
      311     5465    5                      THEN B$JIT.ERR = JS_PRIV;
      312     5466    5                      END;
      313     5467
      314     5468    4                 CALL SEC_LOG
      315     5469    5                 WHENRETURN DO;
      316     5470    5                      CALL JSP$PMME(CODE);
      317     5471    5                      END;
      318     5472
      319     5473    4               CASE(%C$FSUSER#);
      320     5474    4                 CALL JZD$FSUSER;
      321     5475    4               CASE(%C$ASUSER#);
      322     5476    4                 CALL JZD$ASUSER;
      323     5477    4               CASE(%C$DSUSER#);
      324     5478    4                 CALL JZD$DSUSER;
      325     5479
      326     5480    4               CASE(%C$ACCT#);
      327     5481    4                 CALL AFA$ACCT;
      328     5482
      329     5483    4               CASE(ELSE);
      330     5484    4                 CALL JSP$PMME(CODE);
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:11   
      331     5485    4                 END;
      332     5486
      333     5487    3            CASE(%FCG_UE#);
      334     5488    3              CALL UEP$PMME(CODE);
      335     5489
      336     5490        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:12   
      337     5491    3            CASE(%FCG_UM#);
      338     5492    4              DO CASE(CODE);
      339     5493    4               CASE(%C$ERRMSG#);
      340     5494    4                 CALL EMR$ERRMSG;
      341     5495    4               CASE(%C$FID#);
      342     5496    4                 CALL UMF$FID;
      343     5497    4               CASE(%C$ENQ#);
      344     5498    4                 CALL UQB$UENQ(DOMAIN#);
      345     5499    4               CASE(%C$DEQ#);
      346     5500    4                 CALL UQB$UDEQ(DOMAIN#);
      347     5501    4               CASE(%C$TIME#);
      348     5502    4                 CALL UMT$TIME;
      349     5503    4               CASE(%C$NXTUSR#);
      350     5504    4                 CALL UMS$NXTUSR;
      351     5505
      352     5506    4               CASE(%C$WAIT#);
      353     5507    4                 CALL UMT$WAIT;
      354     5508
      355     5509    4               CASE(%C$DISPLAY#);
      356     5510    4                 CALL UMT$SYSLOAD;
      357     5511
      358     5512    4               CASE(%C$STATE#);
      359     5513    4                 CALL SSC$STATE;
      360     5514
      361     5515    4               CASE(%C$XEQTIME#);
      362     5516    4                 CALL UMT$XEQTIME;
      363     5517
      364     5518    4               CASE(%C$SPRIV#);
      365     5519    4                 CALL UMT$SPRIV;
      366     5520
      367     5521    4               CASE(%C$RPRIV#);
      368     5522    4                 CALL UMT$RPRIV;
      369     5523
      370     5524    4               CASE(%C$SSWITCH#);
      371     5525    4                 CALL UMT$SSWITCH;
      372     5526
      373     5527    4               CASE(%C$RSWITCH#);
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:13   
      374     5528    4                 CALL UMT$RSWITCH;
      375     5529
      376     5530    4               CASE(%C$CHGUNIT#);
      377     5531    4                 CALL UMT$CHGUNIT;
      378     5532
      379     5533    4               CASE(%C$USRFIELD#);
      380     5534    4                 CALL UMT$MISC;
      381     5535
      382     5536    4               CASE(%C$RUE#);
      383     5537    4                 ES$MON_SRV.PRIV# = %PR_MSYS#;
      384     5538    4                 IF NOT ((B$JIT.ACCN = J_SYSTXT) OR (B$JIT.PRIV.ACTIVE & %PR_MSYS#))
      385     5539    5                 THEN DO;
      386     5540    5                      B$JIT.ERR = UM_PRIV;
      387     5541    5                      END;
      388     5542
      389     5543    4                 CALL SEC_LOG
      390     5544    5                 WHENRETURN DO;
      391     5545    5                      CALL SSR$MRUE;
      392     5546    5                      END;
      393     5547
      394     5548    4               CASE(%C$UNFID#);
      395     5549    4                 CALL UMU$UNFID;
      396     5550
      397     5551    4               CASE(%C$GJOB#);
      398     5552    4                 CALL JGP$PMME(DOMAIN#);
      399     5553
      400     5554    4               CASE(%C$MONINFO#);
      401     5555    4                 CALL UMT$MONINFO;
      402     5556
      403     5557    4               CASE(%C$HELP#);
      404     5558    4                 CALL EMH$HELP;
      405     5559
      406     5560    4               CASE(%C$CMDVAR#);
      407     5561    4                 CALL UMC$CMDVAR;
      408     5562    4               CASE(%C$SYSID#);
      409     5563    4                 CALL UMS$SYSID;
      410     5564    4                 END;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:14   
      411     5565
      412     5566        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:15   
      413     5567    3            CASE(%FCG_MM#);
      414     5568    3              IF (CODE >= %C$STLPP#) AND (CODE <= %C$UMPL#)
      415     5569    3                AND (CODE ~= %C$GDDL#) AND (CODE ~= %C$STD#)
      416     5570    4              THEN DO;
      417     5571    4                   ES_INDX = CODE - %C$STLPP#;
      418     5572    4                   ES$MON_SRV.PRIV# = MM_PRIVS(ES_INDX);
      419     5573
      420     5574    4                   IF (CODE = %C$CVM#) AND (B$PS0$->FPT$CVM_V.WSQFLG='1'B)
      421     5575    4                     AND ( (B$JIT.PRIV.ACTIVE & %PR_EXMM#)='0'B)
      422     5576    5                   THEN DO;
      423     5577    5                        ES$MON_SRV.PRIV# = %PR_EXMM#;
      424     5578    5                        GOTO ERR_MM;
      425     5579    5                        END;
      426     5580
      427     5581    4                   IF (CODE = %C$SMPRT#)
      428     5582    5                   THEN DO;
      429     5583    5                        IF (B$PS0$->FPT$SMPRT_V.WSQFLG)
      430     5584    5                          AND NOT(B$JIT.PRIV.ACTIVE & %PR_EXMM#)
      431     5585    5                        THEN GOTO ERR_MM;
      432     5586
      433     5587    5                        IF NOT(B$JIT.PRIV.ACTIVE & %PR_EXMM#)
      434     5588    6                        THEN DO;
      435     5589    6                             VPNO = B$PS0$->FPT$SMPRT_V.VPNO;
      436     5590    6                             IF (VPNO < %ISEGLO) OR (VPNO > %ISEGHI)
      437     5591    6                               OR ( (VPNO + B$PS0$->FPT$SMPRT_V.NUMPGS -1) > %ISEGHI)
      438     5592    6                             THEN GOTO ERR_MM;
      439     5593    6                             END;
      440     5594
      441     5595    5                        GOTO CALL_MM;
      442     5596    5                        END/* C$SMPRT */;
      443     5597
      444     5598    4                   IF (CODE = %C$SSC#) AND (B$SS.ISR.WSR = %DBWSR)
      445     5599    5                   THEN DO;
      446     5600    5                        ES$MON_SRV.PRIV# = %PR_DOMAIN#;
      447     5601    5                        GOTO CALL_MM;
      448     5602    5                        END;
      449     5603
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:16   
      450     5604    4                   IF NOT( B$JIT.PRIV.ACTIVE & MM_PRIVS(ES_INDX) )
      451     5605    5                   THEN DO;
      452     5606    5   ERR_MM:              ;
      453     5607    5                        B$JIT.ERR = MM_PRIV;
      454     5608    5                        END/*do if not priv.active*/;
      455     5609
      456     5610    4                   END/*do if STLPP <- code -> UMPL*/;
      457     5611
      458     5612    3   CALL_MM:   ;
      459     5613    3              CALL SEC_LOG ALTRET(SKIP_MM);
      460     5614    3              IF DOMAIN#=%USERWSR THEN DOMAIN#=%USERWSQ;
      461     5615    3              IF DOMAIN#=%MONWSR THEN DOMAIN#=%MONWSQ;
      462     5616    3              CALL MMP$PMME(CODE,DOMAIN#);
      463     5617
      464     5618    3   SKIP_MM:   ;
      465     5619
      466     5620        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:17   
      467     5621    3            CASE(%FCG_FM2#);
      468     5622    3              CALL CHECK_DCB ALTRET(BADDCB);
      469     5623    4              DO CASE(CODE);
      470     5624    4               CASE(%C$OPEN#);
      471     5625    4                 CALL FMM$OPN;
      472     5626
      473     5627    4               CASE(%C$CLOSE#);
      474     5628    4                 CALL FMP$CLS;
      475     5629
      476     5630    4               CASE(%C$CHECK#);
      477     5631    4                 CALL FMF$CHECK;
      478     5632
      479     5633    4               CASE(%C$TRUNC#);
      480     5634    4                 CALL FMF$TRUNC(0);
      481     5635
      482     5636    4               CASE(%C$CVOL#);
      483     5637    4                 CALL FTW$CVOL;
      484     5638
      485     5639    4               CASE(%C$LINES#);
      486     5640    4                 CALL FSM$LINES;
      487     5641
      488     5642    4               CASE(%C$DEVICE#);
      489     5643    4                 CALL FSM$DEVICE;
      490     5644
      491     5645    4                 END;                      /*DO(FM2CODE)*/
      492     5646
      493     5647    3            CASE(%FCG_FM3#);
      494     5648    4              DO CASE(CODE);
      495     5649    4               CASE(%C$CORRES#);
      496     5650    4                 CALL FMF$CORRES;
      497     5651
      498     5652    4               CASE(%C$SETFMA#);
      499     5653    4                 CALL FMF$SETFMA;
      500     5654
      501     5655    4               CASE(%C$GETDCB#);
      502     5656    4                 CALL FMM$GETDCB;
      503     5657
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:18   
      504     5658    4               CASE(%C$RELDCB#);
      505     5659    4                 CALL FMM$RELDCB;
      506     5660
      507     5661    4               CASE(%C$LDEV#);
      508     5662    4                 CALL FSL$LDEV;
      509     5663
      510     5664    4               CASE(%C$MADMUCK#);
      511     5665    4                 CALL FMN$MADMUCK;
      512     5666
      513     5667    4                 ES$MON_SRV.PRIV# = %PR_FMDIAG#;
      514     5668
      515     5669    4                 ERR = B$JIT.ERR;
      516     5670    4                 IF B$JIT.ERR.CODE ~= %E$NOTAUTH
      517     5671    4                 THEN B$JIT.ERR = '0'B;
      518     5672
      519     5673    4                 CALL SEC_LOG;
      520     5674    4                 B$JIT.ERR = ERR;
      521     5675
      522     5676    4               CASE(%C$REM#);
      523     5677    4                 CALL FTC$REM;
      524     5678
      525     5679    4               CASE(%C$XFLUSH#);
      526     5680    4                 CALL FSD$XFLUSH;
      527     5681
      528     5682    4               CASE(%C$RELSTARF#);
      529     5683    4                 CALL FMQ$RELSTARFP;
      530     5684
      531     5685    4                 END;
      532     5686
      533     5687        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:19   
      534     5688    3            CASE(%FCG_TD#);
      535     5689    3              CALL SSS$BLOCK;
      536     5690
      537     5691    3              ES$MON_SRV.PRIV# = TD_PRIVS(CODE);
      538     5692
      539     5693    3              IF (CODE = %C$RDSYSLOG#) AND (B$JIT.ACCN = J_SYSTXT)
      540     5694    3              THEN GOTO CALL_TD;
      541     5695
      542     5696    3              IF (CODE = %C$WRSYSLOG#) AND (B$SS.ISR.WSR <= %ASLWSR)
      543     5697    4              THEN DO;
      544     5698    4                   ES$MON_SRV.PRIV# = %PR_DOMAIN#;
      545     5699    4                   GOTO CALL_TD;
      546     5700    4                   END;
      547     5701
      548     5702    3              IF (CODE = %C$SYSCON#)
      549     5703    4              THEN DO;
      550     5704    4                   IF (B$PS0$->FPT$SYSCON_V.FUNCTION = %DISPLAY#)
      551     5705    4                     AND (B$JIT.PRIV.ACTIVE & (%PR_MM# | %PR_TND#) )
      552     5706    5                   THEN DO;
      553     5707    5                        ES$MON_SRV.PRIV# = (%PR_MM# | %PR_TND#);
      554     5708    5                        GOTO CALL_TD;
      555     5709    5                        END;
      556     5710    4                   END;
      557     5711
      558     5712    3              IF NOT( B$JIT.PRIV.ACTIVE & TD_PRIVS(CODE) )
      559     5713    4              THEN DO;
      560     5714    4                   B$JIT.ERR = TD_PRIV;
      561     5715    4                   END;
      562     5716
      563     5717    3   CALL_TD:   ;
      564     5718    3              CALL SEC_LOG
      565     5719    4              WHENRETURN DO;
      566     5720    4                   IF (CODE=%C$IOQ#) OR ( (CODE>=%C$TDOPEN#) AND (CODE<=%C$TDIO#) )
      567     5721    4                   THEN CALL CHECK_DCB ALTRET(BADDCB);
      568     5722
      569     5723    4                   CALL TDP$PMME(CODE);
      570     5724    4                   END/*do on return from SEC_LOG*/;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:20   
      571     5725
      572     5726        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:21   
      573     5727    3            CASE(%FCG_KC#);
      574     5728    3              CALL CHECK_DCB ALTRET(BADDCB);
      575     5729    3              CALL KCP$PMME(CODE);
      576     5730
      577     5731    3            CASE(%FCG_OT#);
      578     5732    3              CALL SSS$BLOCK;
      579     5733    3              CALL OTW$PMME (CODE);
      580     5734
      581     5735    3            CASE(%FCG_OC#);
      582     5736    3              CALL SSS$BLOCK;
      583     5737    4              DO CASE(CODE);
      584     5738    4               CASE(%C$KEYIN#);
      585     5739    4                 CALL OCU$PMME;
      586     5740
      587     5741    4               CASE(%C$OCMSG#);
      588     5742    4                 ES$MON_SRV.PRIV# = %PR_DOMAIN#;
      589     5743    4                 IF B$SS.ISR.WSR >%DBWSR
      590     5744    4                   AND
      591     5745    4                   NOT B$JIT.PRIV.ACTIVE & %PR_MSYS#
      592     5746    4                 THEN B$JIT.ERR = OC_PRIV;
      593     5747
      594     5748    4                 CALL SEC_LOG
      595     5749    5                 WHENRETURN DO;
      596     5750    5                      CALL OCU$OCMSG(CODE);
      597     5751    5                      END;
      598     5752    4                 END;
      599     5753
      600     5754    3            CASE(%FCG_KL#);
      601     5755    3              CALL SSS$BLOCK;
      602     5756    4              DO CASE (CODE);
      603     5757    4               CASE(%C$PATHCON#);
      604     5758    4                 CALL KLM$PATHCON;
      605     5759    4               CASE(%C$EXHUME#);
      606     5760    4                 CALL KLM$EXHUME;
      607     5761    4                 END;
      608     5762
      609     5763        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:22   
      610     5764    3            CASE(%FCG_PH#);
      611     5765    3              IF (CODE < %C$SMOUSE#) OR (CODE = %C$FEPDATA#)
      612     5766    3              THEN B$JIT.ERR = EOLDPMME;
      613     5767
      614     5768    4              ELSE DO;
      615     5769    4                   ES_INDX = CODE - %C$SMOUSE#;
      616     5770    4                   ES$MON_SRV.PRIV# = PH_PRIVS(ES_INDX);
      617     5771
      618     5772    4                   IF NOT( B$JIT.PRIV.ACTIVE & PH_PRIVS(ES_INDX) )
      619     5773    5                   THEN DO;
      620     5774    5                        B$JIT.ERR = PH_PRIV;
      621     5775    5                        END;
      622     5776
      623     5777    4                   CALL SEC_LOG
      624     5778    5                   WHENRETURN DO;
      625     5779    6                        DO CASE(CODE);
      626     5780    6                         CASE(%C$SMOUSE#);
      627     5781    6                           CALL PHA$SMOUSE;
      628     5782    6                         CASE(%C$XMOUSE#);
      629     5783    6                           CALL PHA$XMOUSE;
      630     5784    6                         CASE(%C$GETMOUSE#);
      631     5785    6                           CALL PHA$GETMOUSE;
      632     5786    6                         CASE(%C$GETPM#);
      633     5787    6                           CALL PHA$GETPM;
      634     5788    6                           END/*do case PH code*/;
      635     5789    5                        END/*do on return from SEC_LOG*/;
      636     5790    4                   END/*do if not old pmme*/;
      637     5791
      638     5792
      639     5793        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:23   
      640     5794    3            CASE(%FCG_FR#);
      641     5795    3              CALL SSS$BLOCK;
      642     5796
      643     5797    3              ES$MON_SRV.PRIV# = %PR_DOMAIN#;
      644     5798
      645     5799    3              IF (CODE=%C$LIMIT#) OR (CODE=%C$RACST#) OR (CODE=%C$MBS#)
      646     5800    4              THEN DO;
      647     5801    4                   IF (CODE = %C$MBS#) AND (B$JIT.SYSID <= JG_MING#)
      648     5802    5                   THEN DO;
      649     5803    5                        IF B$PS0$->FPT$RESCTL_V.MBSDISP = '0'B
      650     5804    5                        THEN IF (B$JIT.SYSID = JG_MBS#)
      651     5805    5                             THEN GOTO CALL_FR;
      652     5806    5                             ELSE GOTO SET_FR_ERR;
      653     5807    5                        ELSE GOTO CALL_FR;
      654     5808    5                        END;
      655     5809
      656     5810    4                   IF DOMAIN# > %CPWSR
      657     5811    5                   THEN DO;
      658     5812    5   SET_FR_ERR:          ;
      659     5813    5                        B$JIT.ERR = FR_PRIV;
      660     5814    5                        END;
      661     5815    4                   END;
      662     5816
      663     5817    3   CALL_FR:   ;
      664     5818    3              CALL SEC_LOG
      665     5819    4              WHENRETURN DO;
      666     5820    4                   CALL FRP$PMME(CODE);
      667     5821    4                   END;
      668     5822
      669     5823        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:24   
      670     5824    3            CASE(%FCG_KI#);
      671     5825    4              DO CASE(CODE);
      672     5826    4               CASE(%C$DRIBBLE#);
      673     5827    4                 CALL UMD$DRIBBLE;
      674     5828    4               CASE(%C$CONFIG#);
      675     5829    4                 CALL KIC$CONFIG;
      676     5830
      677     5831    4               CASE(%C$FEBOOT#, %C$FEDUMP#, %C$FECTL#);
      678     5832    4                 ES$MON_SRV.PRIV# = %PR_MFEP#;
      679     5833
      680     5834    4                 IF NOT(B$JIT.PRIV.ACTIVE & %PR_MFEP#)
      681     5835    5                 THEN DO;
      682     5836    5                      B$JIT.ERR = KI_PRIV;
      683     5837    5                      END/*do if not priv.active*/;
      684     5838
      685     5839    4                 CALL SEC_LOG
      686     5840    5                 WHENRETURN DO;
      687     5841    5                      CALL KIP$CPMME(CODE);
      688     5842    5                      END;
      689     5843
      690     5844    4               CASE(%C$NODEINFO#);
      691     5845    4                 CALL KIP$CPMME(CODE);
      692     5846
      693     5847    4               CASE(ELSE);
      694     5848    4                 CALL CHECK_DCB ALTRET(BADDCB);
      695     5849    4                 IF CODE = %C$SETFP#
      696     5850    4                 THEN CALL KIF$FPRG;
      697     5851    4                 ELSE CALL KIP$PMME(CODE);
      698     5852    4                 END;
      699     5853
      700     5854        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:25   
      701     5855    3            CASE(%FCG_FO#);
      702     5856    3              CALL SSS$BLOCK;
      703     5857    4              DO CASE(CODE);
      704     5858    4               CASE(%C$SYMBIO#);
      705     5859    4                 CALL CHECK_DCB ALTRET(BADDCB);
      706     5860    4                 CALL FOM$PMME(CODE);
      707     5861    4               CASE(%C$JOBSTATS#);
      708     5862    4                 CALL FOS$PMME;
      709     5863    4                 END;
      710     5864
      711     5865    3            CASE(ELSE);
      712     5866    3              GOTO BADX0;
      713     5867
      714     5868    3              END/*do(fcg) */;
      715     5869    2           END/*do if not fcg FM1*/;
      716     5870
      717     5871        /* In the simplest and most common case, no need to call PMMEXIT,
      718     5872           just get out.
      719     5873        */
      720     5874    1      IF (B$JIT.ERR='0'B)
      721     5875    1        AND (PH_MOUSE_USERS = 0)
      722     5876    1        AND ((B$JIT.JUNK&%JJ_BAKIC#)='0'B)
      723     5877    2      THEN DO;
      724     5878    2           P_CALCOMP(S_PNO)=P_CALCOMP(S_PNO)+1;
      725     5879    2           CALL UDB$AUTOQ;
      726     5880    2           END;
      727     5881
      728     5882    1      ELSE
      729     5883    1           IF B$JIT.ERR = '0'B
      730     5884    1           THEN CALL UDB$PMMEXIT1;
      731     5885    1           ELSE CALL UDB$PMMEXIT;
      732     5886
      733     5887        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:26   
      734     5888
      735     5889
      736     5890                                                /* Error Routines                     */
      737     5891    1   FM1_BADDCB: ;
      738     5892    1      IF (CODE=%C$REW#) AND (B$PS0$ -> DCB# = 0)
      739     5893    2      THEN DO;
      740     5894    2           CALL FTC$REW;
      741     5895    2           CALL UDB$PMMEXIT;
      742     5896    2           END;
      743     5897    1   BADDCB: B$JIT.ERR=EBADDCB;
      744     5898    1      CALL UDB$PMMEXIT;
      745     5899
      746     5900        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:27   
      747     5901                                                /* CHECK_DCB   Internal Routine       */
      748     5902    1   CHECK_DCB: PROC ALTRET;
      749     5903    2      IF B$PS0$ -> DCB# > B$ROSEG.NUMDCBS
      750     5904    2      THEN ALTRETURN;
      751     5905
      752     5906    2      B$JIT.DCBNO = B$PS0$ -> DCB#;
      753     5907    2      B$JIT.DCB$ = B$ROSEG.DCBPTR$ -> B$DCB$TAB (B$PS0$ -> DCB#);
      754     5908    2      IF B$JIT.DCB$ = ADDR(NIL)
      755     5909    2      THEN ALTRETURN;
      756     5910
      757     5911    2      RETURN;
      758     5912    2   END CHECK_DCB;
      759     5913        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:28   
      760     5914
      761     5915                                                /* SEC_LOG  Internal Routine          */
      762     5916    1   SEC_LOG: PROC ALTRET;
      763     5917
      764     5918    2   DCL B$MONSER(0:35) BIT(1) BASED;
      765     5919
      766     5920
      767     5921    2      IF (ES_LOGMONSER ~= %PC_ES_NONE#) AND (ADDR(ES_MONSERTBL(FCG))->B$MONSER(CODE) ~=
              5921               '0'B)
      768     5922    2        AND (S_CUN > S_MING)
      769     5923    3      THEN DO;
      770     5924    3           ES$MON_SRV.PMME_TYPE# = BITBIN(B$SS.FPT & '377777'O);
      771     5925
      772     5926    3           IF B$JIT.ERR.CODE ~= 0
      773     5927    4           THEN DO;
      774     5928    4                B$JIT.ERR.UMID = B$JIT.ERR.UMID + CODE;
      775     5929
      776     5930    4                IF (ES_LOGMONSER = %PC_ES_DENIED#) OR (ES_LOGMONSER = %PC_ES_ALL#)
      777     5931    5                THEN DO;
      778     5932    5                     ES$MON_SRV.REASON# = %ES_MON_SRV_DENIED#;
      779     5933    5                     ES$MON_SRV.GRANTED# = '0'B;
      780     5934    5                     END;
      781     5935    4                ELSE GOTO SEC_LOG_EXIT;
      782     5936    4                END/*do if error*/;
      783     5937
      784     5938    4           ELSE DO;
      785     5939    4                IF (ES_LOGMONSER = %PC_ES_GRANTED#) OR (ES_LOGMONSER = %PC_ES_ALL#)
      786     5940    5                THEN DO;
      787     5941    5                     ES$MON_SRV.REASON# = %ES_MON_SRV_GRANTED#;
      788     5942    5                     ES$MON_SRV.GRANTED# = '1'B;
      789     5943    5                     END;
      790     5944    4                ELSE GOTO SEC_LOG_EXIT;
      791     5945    4                END/* do if no err - priv granted*/;
      792     5946
      793     5947    3           CALL ELA$SYSLOG(%EL_MON_SRV, ES$MON_SRV,
      794     5948    3             SIZEW(ES$MON_SRV),'0'B,%EL_SEC, TEMP)
      795     5949    4           WHENALTRETURN DO;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:29   
      796     5950
      797     5951    4                END;
      798     5952
      799     5953    3           END/*if this PMME bit in ES_MONSERTBL and not PC_ES_NONE#*/;
      800     5954
      801     5955    2      ELSE IF B$JIT.ERR.CODE ~= 0
      802     5956    2           THEN B$JIT.ERR.UMID = B$JIT.ERR.UMID + CODE;
      803     5957
      804     5958    2   SEC_LOG_EXIT: ;
      805     5959    2      IF B$JIT.ERR.CODE = 0
      806     5960    2      THEN RETURN;
      807     5961    2      ELSE ALTRETURN;
      808     5962
      809     5963    2   END SEC_LOG;
      810     5964        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:30   
      811     5965        /*E*   ERROR: -E$OLDPMME-E
      812     5966               MESSAGE: That Service Request is no longer supported by CP-6.
      813     5967        */
      814     5968
      815     5969        /*E*   ERROR: PHA-E$OLDPMME-E
      816     5970              MESSAGE: M$SSTATE, M$XSTATE, M$GETSTATE and M$FEPDATA are no longer supported.
      817     5971        */
      818     5972
      819     5973
      820     5974
      821     5975
      822     5976        /*E*     ERROR:    -E$BADDCB#-E
      823     5977                 MESSAGE: DCB# in your FPT is bad.
      824     5978        */
      825     5979        /*E*   ERROR:  UDA-E$BADDCB#-E
      826     5980               MESSAGE: DCB# in your FPT is bad.
      827     5981        */
      828     5982
      829     5983
      830     5984
      831     5985        /*E*     ERROR:  UDA-E$OPTPMME-E
      832     5986                 MESSAGE: System does not include Service Request.
      833     5987        */
      834     5988
      835     5989
      836     5990
      837     5991        /*E*     ERROR:  UDA-E$BADCODE-E
      838     5992                 MESSAGE: Undefined Service Request.
      839     5993                 DESCRIPTION:  The value in X0 on entry to the PMME
      840     5994                               Handler cannot be found in UD_MAXTAB,
      841     5995                               the table that defines the valid Service
      842     5996                               Request codes.
      843     5997        */
      844     5998        /*E*     ERROR:     -E$BADCODE-E
      845     5999                 MESSAGE: Undefined Service Request.
      846     6000        */
      847     6001
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:31   
      848     6002
      849     6003
      850     6004        /*E*     ERROR:    -E$DOMAIN-E
      851     6005                 MESSAGE: That Service Request is not permitted from your domain.
      852     6006        */
      853     6007        /*E*   ERROR:   UDA-E$DOMAIN-E
      854     6008               MESSAGE: That Service Request is not permitted from your domain.
      855     6009        */
      856     6010
      857     6011        /*E*  ERROR: -E$MODE-E
      858     6012              MESSAGE:  That Service Request is not permitted for your user mode.
      859     6013        */
      860     6014
      861     6015
      862     6016        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:32   
      863     6017        /*E*     ERROR:    -E$NOTAUTH-E
      864     6018                 MESSAGE: You are not permitted to use that Service Request.
      865     6019        */
      866     6020
      867     6021
      868     6022                                           /* TD security violation error messages    */
      869     6023
      870     6024
      871     6025        /*E*     ERROR:    TDA-E$NOTAUTH-E
      872     6026                 MESSAGE: M$RDSYSLOG users must run in the system account.
      873     6027        */
      874     6028        /*E*     ERROR:    TDB-E$NOTAUTH-E
      875     6029                 MESSAGE: M$WRSYSLOG requires TND, SYSLOG or SYSCON privilege.
      876     6030                 DESCRIPTION: Special shared processors may also use M$WRSYSLOG.
      877     6031        */
      878     6032        /*E*     ERROR:    TDC-E$NOTAUTH-E
      879     6033                 MESSAGE: M$TDOPEN requires TND privilege.
      880     6034        */
      881     6035        /*E*     ERROR:    TDD-E$NOTAUTH-E
      882     6036                 MESSAGE: M$TDCLOSE requires TND privilege.
      883     6037        */
      884     6038        /*E*     ERROR:    TDE-E$NOTAUTH-E
      885     6039                 MESSAGE: M$TDIO requires TND privilege.
      886     6040        */
      887     6041        /*E*     ERROR:    TDF-E$NOTAUTH-E
      888     6042                 MESSAGE: M$TDREQCPU requires TND privilege.
      889     6043        */
      890     6044        /*E*     ERROR:    TDG-E$NOTAUTH-E
      891     6045                 MESSAGE: M$IOQ users must run with the IOQ privilege on.
      892     6046        */
      893     6047        /*E*    ERROR:      TDH-E$NOTAUTH
      894     6048                MESSAGE: You do not have the privilege to use the M$SYSCON service.
      895     6049                MESSAGE1: The PR_SYSCON privilege is required to partition or
      896     6050                          return components.  PR_TND or PR_SPCLMM or PR_EXMM
      897     6051                          is required to display the status of a component.
      898     6052                MESSAGE7: You do not have the privilege to use the M$SYSCON service.
      899     6053        */
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:33   
      900     6054        /*E*    ERROR:    TDI-E$NOTAUTH-E
      901     6055                MESSAGE:  M$MIRROR requires IOQ and IOQW privileges.
      902     6056        */
      903     6057
      904     6058        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:34   
      905     6059                                           /* OC security violation error messages    */
      906     6060        /*E* ERROR: OCB-E$DOMAIN-E
      907     6061             MESSAGE: M$OCMSG may only be used by a command processor or debugger.
      908     6062        */
      909     6063
      910     6064
      911     6065
      912     6066
      913     6067                                           /* UM security violation error messages    */
      914     6068
      915     6069        /*E*     ERROR:    UMQ-E$NOTAUTH-E
      916     6070                 MESSAGE: M$RUE users must run in :SYS or have MSYS privilege on.
      917     6071        */
      918     6072
      919     6073
      920     6074
      921     6075
      922     6076                                           /* JS security violation error messages    */
      923     6077
      924     6078        /*E*     ERROR:  JSL-E$NOTAUTH-E
      925     6079                 MESSAGE: M$SCREECH users must have EXMM privilege on.
      926     6080                 DESCRIPTION: User programs (except System Ghosts) must
      927     6081                              have EXMM privilege to use M$SCREECH.
      928     6082        */
      929     6083
      930     6084
      931     6085
      932     6086
      933     6087                                           /* FR security violation error messages    */
      934     6088
      935     6089        /*E* ERROR: FRA-E$DOMAIN-E
      936     6090             MESSAGE: M$LIMIT may only be used by a command processor.
      937     6091        */
      938     6092        /*E* ERROR: FRB-E$DOMAIN-E
      939     6093             MESSAGE: M$MBS is not available to user programs.
      940     6094             MESSAGE1: Only System Ghosts and CPs may use M$MBS, and except
      941     6095                       MBS, may only do the display form of the PMME.
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:35   
      942     6096             MESSAGE7: M$MBS is not available to user programs.
      943     6097        */
      944     6098        /*E* ERROR: FRF-E$DOMAIN-E
      945     6099             MESSAGE: M$RACST may only be used by a command processor.
      946     6100        */
      947     6101        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:36   
      948     6102                                           /* MM security violation error messages    */
      949     6103
      950     6104        /*E* ERROR: MMH-E$MMPRIV-E
      951     6105             MESSAGE: M$STLPP users must have EXMM privilege on.
      952     6106        */
      953     6107        /*E* ERROR: MMI-E$MMPRIV-E
      954     6108             MESSAGE: M$RSPP users must have EXMM privilege on.
      955     6109        */
      956     6110        /*E* ERROR: MMJ-E$MMPRIV-E
      957     6111             MESSAGE0: M$CVM users must have EXMM or SPCLMM privilege on.
      958     6112         MESSAGE1: Using M$CVM to map into your Instruction Segment requires SPCLMM privileg
              6112        e.
      959     6113             MESSAGE2: Using M$CVM to map relative to your WSQ requires EXMM privilege.
      960     6114             MESSAGE7: M$CVM users must have EXMM or SPCLMM privilege on.
      961     6115        */
      962     6116        /*E* ERROR: MMK-E$MMPRIV-E
      963     6117             MESSAGE: WSQFLG may not be used with M$SMPRT without EXMM privilege.
      964     6118        */
      965     6119        /*E* ERROR: MML-E$MMPRIV-E
      966     6120             MESSAGE: M$SSC users must have EXMM privilege on.
      967     6121             DESCRIPTION: The debugger domain may also use M$SSC.
      968     6122        */
      969     6123        /*E* ERROR: MMN-E$MMPRIV-E
      970     6124             MESSAGE: M$SAD users must have EXMM or SPCLMM privilege on.
      971     6125        */
      972     6126        /*E* ERROR: MMP-E$MMPRIV-E
      973     6127             MESSAGE: M$BADPP users must have TND or SYSCON privilege on.
      974     6128        */
      975     6129        /*E* ERROR: MMQ-E$MMPRIV-E
      976     6130             MESSAGE: M$GOODPP users must have TND or SYSCON privilege on.
      977     6131        */
      978     6132        /*E* ERROR: MMR-E$MMPRIV-E
      979     6133             MESSAGE: M$GBPL users must have TND or SYSCON privilege on.
      980     6134        */
      981     6135        /*E* ERROR: MMS-E$MMPRIV-E
      982     6136             MESSAGE: M$MPL users must have TND or SYSCON privilege on.
      983     6137        */
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:37   
      984     6138        /*E* ERROR: MMT-E$MMPRIV-E
      985     6139             MESSAGE: M$UMPL users must have TND or SYSCON privilege on.
      986     6140        */
      987     6141
      988     6142        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:38   
      989     6143                                           /* PH security violation error messages    */
      990     6144
      991     6145        /*E* ERROR: PHD-E$NOTAUTH-E
      992     6146             MESSAGE: M$SMOUSE users must have EXPM privilege on.
      993     6147        */
      994     6148        /*E* ERROR: PHE-E$NOTAUTH-E
      995     6149             MESSAGE: M$XMOUSE users must have EXPM privilege on.
      996     6150        */
      997     6151        /*E* ERROR: PHF-E$NOTAUTH-E
      998     6152             MESSAGE: M$GETMOUSE users must have PM privilege on.
      999     6153        */
     1000     6154        /*E* ERROR: PHG-E$NOTAUTH-E
     1001     6155             MESSAGE: M$GETPM users must have PM privilege on.
     1002     6156        */
     1003     6157        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:39   
     1004     6158                                           /* KI security violation error messages    */
     1005     6159
     1006     6160        /*E* ERROR: KIN-E$NOTAUTH-E
     1007     6161             MESSAGE: M$FEBOOT users must have MFEP privilege on.
     1008     6162        */
     1009     6163        /*E* ERROR: KIO-E$NOTAUTH-E
     1010     6164             MESSAGE: M$FEDUMP users must have MFEP privilege on.
     1011     6165        */
     1012     6166        /*E* ERROR: KIP-E$NOTAUTH-E
     1013     6167             MESSAGE: M$FECTL users must have MFEP privilege on.
     1014     6168        */
     1015     6169    1   END UDA$PMMENT;

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:40   
--  Include file information  --

   UM_CP6.:E05TOU  is referenced.
   UD_EQU_E.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   TD$CP6V_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   MM$CP6V_C.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   M_ERRORS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   HF_ERRORS_C.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_MAGIC_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure UDA$PMMENT.

   Procedure UDA$PMMENT requires 967 words for executable code.
   Procedure UDA$PMMENT requires 12 words of local(AUTO) storage.

    No errors detected in file UDA$PMMENT.:E05TSI    .

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:41   

 Object Unit name= UDA$PMMENT                                 File name= UDA$PMMENT.:E05TOU
 UTS= JUL 30 '97 06:54:28.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    17     21  UDA$PMMENT
    1  RoData even  UTS     30     36  UDA$PMMENT
    2   Proc  even  none   967   1707  UDA$PMMENT
    3  RoData even  none     9     11  UDA$PMMENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  UDA$PMMENT
     2      3                  yes      Std        0  UDA$UPMMENT
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:42   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 PHP$START_PMME
         yes           Std       0 JSE$EXITS
         yes           Std       0 UMT$SYSLOAD
         yes           Std       0 FMF$CHECK
         yes           Std       0 FSM$LINES
         yes           Std       1 FOM$PMME
         yes           Std       0 UMT$RPRIV
         yes           Std       2 MMP$PMME
         yes           Std       0 FMM$GETDCB
 yes     yes           Std       1 KIF$FPRG
         yes           Std       1 FMF$TRUNC
 yes     yes           Std       1 KCP$PMME
 yes     yes           Std       0 KLM$PATHCON
 yes     yes           Std       0 KLM$EXHUME
         yes           Std       1 KIP$CPMME
 yes     yes           Std       0 JZD$ASUSER
         yes           Std       0 AFA$ACCT
         yes           Std       0 UMS$SYSID
         yes           Std       1 KIP$PMME
         yes           Std       0 UMT$XEQTIME
 yes     yes           Std       0 JZD$DSUSER
         yes           Std       0 UMF$FID
 yes     yes           Std       1 UQB$UDEQ
         yes           Std       1 JGP$PMME
         yes           Std       0 PHA$GETMOUSE
         yes           Std       0 PHA$GETPM
 yes     yes           Std       0 UMS$NXTUSR
         yes           Std       0 EMH$HELP
         yes           Std       1 TDP$PMME
         yes           Std       0 UMT$MONINFO
 yes     yes           Std       0 FSD$XFLUSH
         yes           Std       1 OTW$PMME
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:43   
         yes           Std       0 FMF$SETFMA
         yes           Std       0 KIC$CONFIG
         yes           Std       0 PHA$SMOUSE
 yes     yes           Std       0 UMT$TIME
         yes           Std       0 UMC$CMDVAR
         yes           Std       0 FMF$CORRES
         yes           Std       0 FMN$MADMUCK
         yes           Std       0 FOS$PMME
 yes     yes           Std       0 FTW$CVOL
         yes           Std       0 FSL$LDEV
         yes           Std       1 FMF$PMME
         yes           Std       0 UDB$PMMEXIT
 yes     yes           Std       1 UQB$UENQ
         yes           Std       0 SSC$STATE
         yes           Std       0 UMT$SPRIV
         yes           Std       0 PHA$XMOUSE
 yes     yes           Std       2 UMD$DRIBBLE
         yes           Std       1 FRP$PMME
         yes           Std       0 FTC$REW
         yes           Std       0 UMU$UNFID
         yes           Std       0 FMQ$RELSTARFP
         yes           Std       0 EMR$ERRMSG
         yes           Std       0 UMT$RSWITCH
         yes           Std       0 FMM$OPN
         yes           Std       0 FMM$RELDCB
         yes           Std       0 FTC$REM
         yes           Std       0 UMT$MISC
         yes           Std       0 SSS$BLOCK
         yes           Std       0 UMT$WAIT
         yes           Std       0 UMT$SSWITCH
 yes     yes           Std       0 OCU$PMME
         yes           Std       0 SSR$MRUE
         yes           Std       1 JSP$PMME
 yes     yes           Std       0 JZD$FSUSER
 yes     yes           Std       3 UEP$PMME
         yes           Std       0 UMT$CHGUNIT
         yes           Std       0 FMP$CLS
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:44   
         yes           Std       0 UDB$PMMEXIT1
         yes           Std       1 OCU$OCMSG
         yes           Std       0 FSM$DEVICE
         yes           Std       0 UDB$AUTOQ
 yes     yes           Std       6 ELA$SYSLOG
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     UD_MAXTAB                        r    B$ROSEG$                         r    B$JIT$
r    B$PS0$                                B_MPT                                 ES_LOGMONSER
     ES_MONSERTBL                          J_SYSTXT                              PH_MOUSE_USERS
     S_PNO                                 P_CALCNT                              P_CALCOMP
     S_CUN                                 S_MING                                S_INCTIME
     S_TIMR                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:45   


        1        1        /*M*   UDA$PMMENT   Monitor Services Decoder    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0    */
        8        8
        9        9        UDA$PMMENT: PROC;

      9  2 000000   000000 700200 xent  UDA$PMMENT   TSX0  ! X66_AUTO_0
         2 000001   000014 000000                    ZERO    12,0

       10       10
       11       11                                                /* INCLUDE files                      */
       12       12        %INCLUDE B$SS;
       13      191        %INCLUDE B$JIT;
       14      794        %INCLUDE B$ROSEG;
       15      857        %INCLUDE B_MAGIC_C;
       16      975        %INCLUDE B_STRINGS_C;
       17     1104        %INCLUDE CP_6_SUBS;
       18     1644        %INCLUDE EL_SUBS_C;
       19     1728        %INCLUDE ES_TABLES_M;
       20     2122        %INCLUDE ES_SUBS_E;
       21     2148        %INCLUDE F$CP6V_C;
       22     2374        %INCLUDE HF_ERRORS_C;
       23     2459        %INCLUDE HF_LOCK_C;
       24     2473        %INCLUDE JG_GHOSTS_C;
       25     2563        %INCLUDE M_ERRORS_C;
       26     2627        %INCLUDE M_INFO_C;
       27     2767        %INCLUDE MM$CP6V_C;
       28     2835        %INCLUDE PC_SUBS_C;
       29     3167        %INCLUDE TD$CP6V_C;
       30     3203        %INCLUDE UD_ERRORS_C;
       31     3245        %INCLUDE UD_SEV_C;
       32     3259        %INCLUDE UD_EQU_E;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:46   
       33     3648        %INCLUDE UM_CP6;
       34     4500
       35     4501                                                /* AUTO Storage                       */
       36     4502
       37     4503    1   DCL CODE SBIN;
       38     4504    1   DCL FLINK REDEF CODE SBIN;
       39     4505    1   DCL FCG UBIN(36);
       40     4506    1   DCL PP REDEF FCG SBIN;
       41     4507    1   DCL DOMAIN# UBIN(36);
       42     4508    1   DCL ES_INDX UBIN;
       43     4509    1   DCL VPNO UBIN(36);
       44     4510    1   DCL ERR REDEF VPNO BIT(36);
       45     4511        %ES$MON_SRV (STCLASS=STATIC);
       46     4526    1   DCL TEMP STATIC BIT(36);
       47     4527
       48     4528                                                /* External Procedures                */
       49     4529
       50     4530    1   DCL AFA$ACCT      ENTRY;
       51     4531    1   DCL ELA$SYSLOG    ENTRY(6) ALTRET;
       52     4532    1   DCL EMH$HELP      ENTRY;
       53     4533    1   DCL EMR$ERRMSG    ENTRY;
       54     4534    1   DCL FMF$CHECK     ENTRY;
       55     4535    1   DCL FMF$CORRES    ENTRY;
       56     4536    1   DCL FMF$PMME      ENTRY(1);
       57     4537    1   DCL FMF$SETFMA    ENTRY;
       58     4538    1   DCL FMF$TRUNC     ENTRY(1);
       59     4539    1   DCL FMM$GETDCB    ENTRY;
       60     4540    1   DCL FMM$OPN       ENTRY;
       61     4541    1   DCL FMM$RELDCB    ENTRY;
       62     4542    1   DCL FMN$MADMUCK   ENTRY;
       63     4543    1   DCL FMP$CLS       ENTRY;
       64     4544    1   DCL FMQ$RELSTARFP ENTRY;
       65     4545    1   DCL FOM$PMME      ENTRY(1);
       66     4546    1   DCL FOS$PMME      ENTRY;
       67     4547    1   DCL FRP$PMME      ENTRY(1);
       68     4548    1   DCL FSD$XFLUSH    ENTRY    ALTRET;
       69     4549    1   DCL FSL$LDEV      ENTRY;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:47   
       70     4550    1   DCL FSM$DEVICE    ENTRY;
       71     4551    1   DCL FSM$LINES     ENTRY;
       72     4552    1   DCL FTC$REM       ENTRY;
       73     4553    1   DCL FTC$REW       ENTRY;
       74     4554    1   DCL FTW$CVOL      ENTRY    ALTRET;
       75     4555    1   DCL JGP$PMME      ENTRY(1);
       76     4556    1   DCL JSE$ABORTM    ENTRY;
       77     4557    1   DCL JSE$EXITS     ENTRY;
       78     4558    1   DCL JSP$PMME      ENTRY(1);
       79     4559    1   DCL JSS$FIXLASR   ENTRY;
       80     4560    1   DCL JZD$ASUSER    ENTRY    ALTRET;
       81     4561    1   DCL JZD$DSUSER    ENTRY    ALTRET;
       82     4562    1   DCL JZD$FSUSER    ENTRY    ALTRET;
       83     4563    1   DCL KCP$PMME      ENTRY(1) ALTRET;
       84     4564    1   DCL KIC$CONFIG    ENTRY;
       85     4565    1   DCL KIF$FPRG      ENTRY(1) ALTRET;
       86     4566    1   DCL KIP$CPMME     ENTRY(1);
       87     4567    1   DCL KIP$PMME      ENTRY(1);
       88     4568    1   DCL KLM$EXHUME    ENTRY    ALTRET;
       89     4569    1   DCL KLM$PATHCON   ENTRY    ALTRET;
       90     4570    1   DCL MMP$PMME      ENTRY(2);
       91     4571    1   DCL OCU$OCMSG     ENTRY(1);
       92     4572    1   DCL OCU$PMME      ENTRY    ALTRET;
       93     4573    1   DCL OTW$PMME      ENTRY(1);
       94     4574    1   DCL PHA$SMOUSE    ENTRY;
       95     4575    1   DCL PHA$XMOUSE    ENTRY;
       96     4576    1   DCL PHA$GETMOUSE  ENTRY;
       97     4577    1   DCL PHA$GETPM     ENTRY;
       98     4578    1   DCL PHP$START_PMME ENTRY;
       99     4579    1   DCL SSC$STATE     ENTRY;
      100     4580    1   DCL SSR$MRUE      ENTRY;
      101     4581    1   DCL UMS$NXTUSR      ENTRY    ALTRET;
      102     4582    1   DCL UMS$SYSID ENTRY;
      103     4583    1   DCL SSS$BLOCK     ENTRY;
      104     4584    1   DCL S_TIME        ENTRY(3);
      105     4585    1   DCL TDP$PMME      ENTRY(1);
      106     4586    1   DCL UDB$AUTOQ     ENTRY;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:48   
      107     4587    1   DCL UDB$PMMEXIT   ENTRY;
      108     4588    1   DCL UDB$PMMEXIT1  ENTRY;
      109     4589    1   DCL UEP$PMME      ENTRY(3) ALTRET;
      110     4590    1   DCL UMC$CMDVAR    ENTRY;
      111     4591    1   DCL UMD$DRIBBLE   ENTRY(2)    ALTRET;
      112     4592    1   DCL UMF$FID       ENTRY;
      113     4593    1   DCL UMT$CHGUNIT   ENTRY;
      114     4594    1   DCL UMT$MISC      ENTRY;
      115     4595    1   DCL UMT$MONINFO   ENTRY;
      116     4596    1   DCL UMT$RPRIV     ENTRY;
      117     4597    1   DCL UMT$RSWITCH   ENTRY;
      118     4598    1   DCL UMT$SPRIV     ENTRY;
      119     4599    1   DCL UMT$SSWITCH   ENTRY;
      120     4600    1   DCL UMT$SYSLOAD   ENTRY;
      121     4601    1   DCL UMT$TIME      ENTRY    ALTRET;
      122     4602    1   DCL UMT$WAIT      ENTRY;
      123     4603    1   DCL UMT$XEQTIME   ENTRY;
      124     4604    1   DCL UMU$UNFID     ENTRY;
      125     4605    1   DCL UQB$UDEQ      ENTRY(1) ALTRET;
      126     4606    1   DCL UQB$UENQ      ENTRY(1) ALTRET;
      127     4607
      128     4608    1   DCL SC_FMC96 ENTRY CONV(2, 0);
      129     4609
      130     4610                                                /* External Data                      */
      131     4611
      132     4612    1   DCL UD_MAXTAB(0:%MAX_FCG#) SBIN SYMREF;
      133     4613
      134     4614    1   DCL B$ROSEG$ PTR SYMREF READONLY;
      135     4615    1   DCL B$JIT$ PTR SYMREF READONLY;
      136     4616    1   DCL B$PS0$ PTR SYMREF READONLY;
      137     4617    1   DCL FMC_TYPTBL$ PTR SYMREF;
      138     4618        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
      139     4711
      140     4712    1   DCL ES_LOGMONSER UBIN WORD SYMREF;
      141     4713    1   DCL ES_MONSERTBL(0:%MAX_FCG#) BIT(36) ALIGNED SYMREF;
      142     4714
      143     4715    1   DCL FMC_LOCK BIT(72) SYMREF;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:49   
      144     4716    1   DCL J_SYSTXT CHAR(8) SYMREF;
      145     4717    1   DCL PH_MOUSE_USERS SBIN WORD SYMREF;
      146     4718    1   DCL S_PNO UBIN(36) SYMREF;
      147     4719    1   DCL P_CALCNT(0:3) SBIN SYMREF;
      148     4720    1   DCL P_CALCOMP(0:3) SBIN SYMREF;
      149     4721    1   DCL S_CUN SBIN SYMREF;
      150     4722    1   DCL S_MING SBIN SYMREF;
      151     4723    1   DCL S_INCTIME SBIN SYMREF;
      152     4724    1   DCL S_TIMR UBIN SYMREF;
      153     4725
      154     4726                                                /* BASED Structures                   */
      155     4727
      156     4728    1   DCL B$DCB$TAB(0:15) PTR BASED;
      157     4729    1   DCL DCB# UBIN HALF BASED;
      158     4730
      159     4731        %FPT$CVM_V;
      160     4735        %FPT$RESCTL_V;
      161     4738        %FPT$SMPRT_V;
      162     4741        %FPT$SYSCON_V;
      163     4745
      164     4746
      165     4747        /* Data for the Security features implemented for C00.
      166     4748        */
      167     4749
      168     4750    1   DCL MM_PRIVS(0:12) BIT(36) CONSTANT INIT(
      169     4751    1       %PR_EXMM#/*M$STLPP*/,
      170     4752    1       %PR_EXMM#/*M$RSPP*/,
      171     4753    1       %PR_MM#/*M$CVM*/,
      172     4754    1       %PR_EXMM#/*M$SMPRT*/,
      173     4755    1       %PR_EXMM#/*M$SSC*/,
      174     4756    1       '0'B/*M$GDDL*/,
      175     4757    1       %PR_MM#/*M$SAD*/,
      176     4758    1       '0'B/*M$STD*/,
      177     4759    1       %PR_TDSYSCN#/*M$BADPP*/,
      178     4760    1       %PR_TDSYSCN#/*M$GOODPP*/,
      179     4761    1       %PR_TDSYSCN#/*M$GBPL*/,
      180     4762    1       %PR_TDSYSCN#/*M$MPL*/,
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:50   
      181     4763    1       %PR_TDSYSCN#/*M$UMPL*/);
      182     4764
      183     4765    1   DCL TD_PRIVS(0:8) BIT(36) CONSTANT INIT(
      184     4766    1       %PR_SYSACCT#/*M$RDSYSLOG*/,
      185     4767    1       %PR_WRSYSLG#/*M$WRSYSLOG*/,
      186     4768    1       %PR_TND#/*M$TDOPEN*/,
      187     4769    1       %PR_TND#/*M$TDCLOSE*/,
      188     4770    1       %PR_TND#/*M$TDIO*/,
      189     4771    1       %PR_TND#/*M$TDREQCPU*/,
      190     4772    1       %PR_IOQ#/*M$IOQ*/,
      191     4773    1       %PR_SYSCON#/*M$SYSCON*/,
      192     4774    1       %(PR_IOQ#|PR_IOQW#)/*M$MIRROR*/);
      193     4775
      194     4776    1   DCL PH_PRIVS(0:3) BIT(36) CONSTANT INIT(
      195     4777    1       %PR_EXPM#/*M$SMOUSE*/,
      196     4778    1       %PR_EXPM#/*M$XMOUSE*/,
      197     4779    1       %PR_PM#/*M$GETMOUSE*/,
      198     4780    1       %PR_PM#/*M$GETPM*/);
      199     4781
      200     4782
      201     4783
      202     4784                                                /* String Substitutions               */
      203     4785
      204     4786        %SUB B$JIT = B$JIT$->B$JIT;
      205     4787        %SUB B$SS = B_MPT.SS$->B$SS;
      206     4788        %SUB B$ROSEG = B$ROSEG$->B$ROSEG;
      207     4789
      208     4790
      209     4791                                                /* Error Codes                        */
      210     4792
      211     4793        %VLP_ERRCODE (FPTN=MM_PRIV,FCG=MM,MID=A,ERR#=%E$MMPRIV,SEV=SEV_ERR#);
      212     4838        %VLP_ERRCODE (FPTN=TD_PRIV,FCG=TD,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      213     4883        %VLP_ERRCODE (FPTN=PH_PRIV,FCG=PH,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      214     4928        %VLP_ERRCODE (FPTN=KI_PRIV,FCG=KI,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      215     4973        %VLP_ERRCODE (FPTN=OC_PRIV,FCG=OC,MID=A,ERR#=%E$DOMAIN,SEV=SEV_ERR#);
      216     5018        %VLP_ERRCODE (FPTN=UM_PRIV,FCG=UM,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
      217     5063        %VLP_ERRCODE (FPTN=JS_PRIV,FCG=JS,MID=A,ERR#=%E$NOTAUTH,SEV=SEV_ERR#);
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:51   
      218     5108        %VLP_ERRCODE (FPTN=FR_PRIV,FCG=FR,MID=A,ERR#=%E$DOMAIN,SEV=SEV_ERR#);
      219     5153
      220     5154        %VLP_ERRCODE (FPTN=EBADDCB,FCG=UD,MID=A,ERR#=%E$BADDCB#,SEV=SEV_ERR#);
      221     5199        %VLP_ERRCODE (FPTN=EOPTPMME,FCG=UD,MID=A,ERR#=%E$OPTPMME,SEV=SEV_ERR#);
      222     5244        %VLP_ERRCODE (FPTN=EBADCODE,FCG=UD,MID=A,ERR#=%E$BADCODE,SEV=SEV_ERR#);
      223     5289        %VLP_ERRCODE (FPTN=EDOMAIN,FCG=UD,MID=A,ERR#=%E$DOMAIN,SEV=SEV_ERR#);
      224     5334        %VLP_ERRCODE (FPTN=EOLDPMME,FCG=PH,MID=A,ERR#=%E$OLDPMME,SEV=SEV_ERR#);
      225     5379
      226     5380        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:52   
      227     5381         /*F*  NAME:         UDA$PMMENT
      228     5382
      229     5383               PURPOSE:      UDA $PMMENT is the CP-6 monitor services decoder.
      230     5384
      231     5385               DESCRIPTION:
      232     5386
      233     5387         UDA$PMMENT is entered with the auto pointer and the
      234     5388         contents of X0 saved in the Safe-Store frame by a
      235     5389         BMAP routine.
      236     5390
      237     5391        */
      238     5392    1      GOTO NOTUPMME;

   5392  2 000002   000014 710000 2                  TRA     NOTUPMME

      239     5393
      240     5394    1   UDA$UPMMENT: ENTRY;

   5394  2 000003   000000 700200 xent  UDA$UPMMENT  TSX0  ! X66_AUTO_0
         2 000004   000014 000000                    ZERO    12,0

      241     5395
      242     5396    2      DO INHIBIT;

      243     5397    2           B$JIT.XTIME=B$JIT.XTIME+S_INCTIME;

   5397  2 000005   000000 470600 xsym               LDP0  ! B$JIT$
         2 000006   000262 236300                    LDQ   ! 178,,PR0
         2 000007   000000 036200 xsym               ADLQ  ! S_INCTIME
         2 000010   000262 756300                    STQ   ! 178,,PR0

      244     5398    2           S_TIMR=1;

   5398  2 000011   000001 235207                    LDA   ! 1,DL
         2 000012   000000 755200 xsym               STA   ! S_TIMR

      245     5399    2           END;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:53   

      246     5400    1      B$JIT.CALCNT=B$JIT.CALCNT+1;

   5400  2 000013   000267 054100                    AOS     183,,PR0

      247     5401
      248     5402    1   NOTUPMME: P_CALCNT(S_PNO) = P_CALCNT(S_PNO)+1;

   5402  2 000014   000000 720000 xsym  NOTUPMME     LXL0    S_PNO
         2 000015   000000 054010 xsym               AOS     P_CALCNT,X0

      249     5403
      250     5404
      251     5405    1      IF PH_MOUSE_USERS ~=0 THEN CALL PHP$START_PMME;

   5405  2 000016   000000 235000 xsym               LDA     PH_MOUSE_USERS
         2 000017   000023 600000 2                  TZE     s:5407

   5405  2 000020   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000021   000000 701000 xent               TSX1    PHP$START_PMME
         2 000022   000000 011000                    NOP     0

      252     5406
      253     5407    1      CODE = B$SS.FPT.CODE;

   5407  2 000023   000000 470400 xsym               LDP0    B_MPT
         2 000024   000001 236100                    LDQ     1,,PR0
         2 000025   000022 772000                    QRL     18
         2 000026   007777 376007                    ANQ     4095,DL
         2 000027   200003 756100                    STQ     CODE,,AUTO

      254     5408    1      FCG = B$SS.FPT.FCG;

   5408  2 000030   000001 236100                    LDQ     1,,PR0
         2 000031   000036 772000                    QRL     30
         2 000032   000037 376007                    ANQ     31,DL
         2 000033   200004 756100                    STQ     FCG,,AUTO
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:54   

      255     5409
      256     5410    1      IF FCG = %FCG_FM1#

   5410  2 000034   000004 116007                    CMPQ    4,DL
         2 000035   000070 601000 2                  TNZ     s:5429

      257     5411    2      THEN DO;

      258     5412    2           B$JIT.ERR = '0'B;

   5412  2 000036   000000 471400 xsym               LDP1    B$JIT$
         2 000037   100012 450100                    STZ     10,,PR1

      259     5413    2           IF CODE > UD_MAXTAB(%FCG_FM1#)

   5413  2 000040   200003 236100                    LDQ     CODE,,AUTO
         2 000041   000004 116000 xsym               CMPQ    UD_MAXTAB+4
         2 000042   000076 605400 2                  TPNZ    BADX0

      260     5414    2           THEN GOTO BADX0;
      261     5415
      262     5416    2           IF B$PS0$ -> DCB# > B$ROSEG.NUMDCBS

   5416  2 000043   000000 473400 xsym               LDP3    B$ROSEG$
         2 000044   300002 220100                    LDX0    2,,PR3
         2 000045   000000 474400 xsym               LDP4    B$PS0$
         2 000046   400000 100100                    CMPX0   0,,PR4
         2 000047   001524 602000 2                  TNC     FM1_BADDCB

      263     5417    2           THEN GOTO FM1_BADDCB;
      264     5418
      265     5419    2           B$JIT.DCBNO = B$PS0$ -> DCB#;

   5419  2 000050   400000 236100                    LDQ     0,,PR4
         2 000051   000022 772000                    QRL     18
         2 000052   100022 552104                    STBQ    18,'04'O,PR1
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:55   

      266     5420    2           B$JIT.DCB$ = B$ROSEG.DCBPTR$ -> B$DCB$TAB (B$PS0$ -> DCB#);

   5420  2 000053   300000 475500                    LDP5    0,,PR3
         2 000054   400000 220100                    LDX0    0,,PR4
         2 000055   500000 236110                    LDQ     0,X0,PR5
         2 000056   100232 756100                    STQ     154,,PR1

      267     5421    2           IF B$JIT.DCB$ = ADDR(NIL)

   5421  2 000057   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000060   001524 600000 2                  TZE     FM1_BADDCB

      268     5422    2           THEN GOTO FM1_BADDCB;
      269     5423
      270     5424    2           CALL FMF$PMME (CODE);

   5424  2 000061   200003 635500                    EPPR5   CODE,,AUTO
         2 000062   200012 455500                    STP5    VPNO+3,,AUTO
         2 000063   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 000064   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000065   000000 701000 xent               TSX1    FMF$PMME
         2 000066   000000 011000                    NOP     0

      271     5425    2           END;

   5425  2 000067   001475 710000 2                  TRA     s:5874

      272     5426
      273     5427
      274     5428    2      ELSE DO;

      275     5429    2           IF ( (FCG > %MAX_FCG#) OR (CODE > UD_MAXTAB(FCG)) )

   5429  2 000070   000020 116007                    CMPQ    16,DL
         2 000071   000076 603000 2                  TRC     BADX0
         2 000072   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:56   
         2 000073   200003 236100                    LDQ     CODE,,AUTO
         2 000074   000000 116010 xsym               CMPQ    UD_MAXTAB,X0
         2 000075   000104 604400 2                  TMOZ    s:5436

      276     5430    3           THEN DO;

   5429  2 000076                       BADX0        null
      277     5431    3   BADX0:       ;
      278     5432    3                B$JIT.ERR=EBADCODE;

   5432  2 000076   000016 236000 0                  LDQ     EBADCODE
         2 000077   000000 470400 xsym               LDP0    B$JIT$
         2 000100   000012 756100                    STQ     10,,PR0

      279     5433    3                CALL UDB$PMMEXIT;

   5433  2 000101   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000102   000000 701000 xent               TSX1    UDB$PMMEXIT
         2 000103   000000 011000                    NOP     0

      280     5434    3                END;

      281     5435
      282     5436    2           IF UD_MAXTAB(FCG) = -1

   5436  2 000104   200004 720100                    LXL0    FCG,,AUTO
         2 000105   000000 235010 xsym               LDA     UD_MAXTAB,X0
         2 000106   000027 115000 xsym               CMPA    B_VECTNIL+23
         2 000107   000116 601000 2                  TNZ     s:5442

      283     5437    3           THEN DO;

      284     5438    3                B$JIT.ERR =EOPTPMME;

   5438  2 000110   000015 236000 0                  LDQ     EOPTPMME
         2 000111   000000 470400 xsym               LDP0    B$JIT$
         2 000112   000012 756100                    STQ     10,,PR0
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:57   

      285     5439    3                CALL UDB$PMMEXIT;

   5439  2 000113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000114   000000 701000 xent               TSX1    UDB$PMMEXIT
         2 000115   000000 011000                    NOP     0

      286     5440    3                END;

      287     5441
      288     5442    2           B$JIT.ERR='0'B;

   5442  2 000116   000000 470400 xsym               LDP0    B$JIT$
         2 000117   000012 450100                    STZ     10,,PR0

      289     5443    2           B$JIT.DCB$ = ADDR(NIL);

   5443  2 000120   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000121   000232 756100                    STQ     154,,PR0

      290     5444    2           B$JIT.DCBNO=0;

   5444  2 000122   000000 236003                    LDQ     0,DU
         2 000123   000022 552104                    STBQ    18,'04'O,PR0

      291     5445
      292     5446    2           DOMAIN# = B$SS.ISR.WSR;

   5446  2 000124   000000 471400 xsym               LDP1    B_MPT
         2 000125   100010 236100                    LDQ     8,,PR1
         2 000126   000004 772000                    QRL     4
         2 000127   000007 376007                    ANQ     7,DL
         2 000130   200005 756100                    STQ     DOMAIN#,,AUTO

      293     5447        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:58   
      294     5448
      295     5449    3           DO CASE(FCG);

   5449  2 000131   200004 235100                    LDA     FCG,,AUTO
         2 000132   000020 115007                    CMPA    16,DL
         2 000133   000135 602005 2                  TNC     s:5449+4,AL
         2 000134   001474 710000 2                  TRA     s:5866
         2 000135   000155 710000 2                  TRA     s:5452
         2 000136   000271 710000 2                  TRA     s:5488
         2 000137   000300 710000 2                  TRA     s:5492
         2 000140   000514 710000 2                  TRA     s:5568
         2 000141   001474 710000 2                  TRA     s:5866
         2 000142   000640 710000 2                  TRA     s:5622
         2 000143   000712 710000 2                  TRA     s:5648
         2 000144   001012 710000 2                  TRA     s:5689
         2 000145   001111 710000 2                  TRA     s:5728
         2 000146   001122 710000 2                  TRA     s:5732
         2 000147   001134 710000 2                  TRA     s:5736
         2 000150   001177 710000 2                  TRA     s:5755
         2 000151   001220 710000 2                  TRA     s:5765
         2 000152   001277 710000 2                  TRA     s:5795
         2 000153   001346 710000 2                  TRA     s:5825
         2 000154   001446 710000 2                  TRA     s:5856

      296     5450
      297     5451    3            CASE(%FCG_JS#);

      298     5452    4              DO CASE(CODE);

   5452  2 000155   200003 235100                    LDA     CODE,,AUTO
         2 000156   000027 115007                    CMPA    23,DL
         2 000157   000161 602005 2                  TNC     s:5452+4,AL
         2 000160   000262 710000 2                  TRA     s:5484
         2 000161   000210 710000 2                  TRA     s:5454
         2 000162   000211 710000 2                  TRA     s:5457
         2 000163   000211 710000 2                  TRA     s:5457
         2 000164   000211 710000 2                  TRA     s:5457
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:59   
         2 000165   000262 710000 2                  TRA     s:5484
         2 000166   000262 710000 2                  TRA     s:5484
         2 000167   000262 710000 2                  TRA     s:5484
         2 000170   000262 710000 2                  TRA     s:5484
         2 000171   000262 710000 2                  TRA     s:5484
         2 000172   000262 710000 2                  TRA     s:5484
         2 000173   000262 710000 2                  TRA     s:5484
         2 000174   000215 710000 2                  TRA     s:5460
         2 000175   000242 710000 2                  TRA     s:5474
         2 000176   000246 710000 2                  TRA     s:5476
         2 000177   000252 710000 2                  TRA     s:5478
         2 000200   000262 710000 2                  TRA     s:5484
         2 000201   000262 710000 2                  TRA     s:5484
         2 000202   000262 710000 2                  TRA     s:5484
         2 000203   000262 710000 2                  TRA     s:5484
         2 000204   000262 710000 2                  TRA     s:5484
         2 000205   000262 710000 2                  TRA     s:5484
         2 000206   000262 710000 2                  TRA     s:5484
         2 000207   000256 710000 2                  TRA     s:5481

      299     5453    4               CASE(0);

      300     5454    4                 GOTO BADX0;

   5454  2 000210   000076 710000 2                  TRA     BADX0

      301     5455
      302     5456    4               CASE(%C$EXIT#, %C$ERR#, %C$XXX#);

      303     5457    4                 CALL JSE$EXITS;

   5457  2 000211   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000212   000000 701000 xent               TSX1    JSE$EXITS
         2 000213   000000 011000                    NOP     0
         2 000214   001475 710000 2                  TRA     s:5874

      304     5458
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:60   
      305     5459    4               CASE(%C$SCREECH#);

      306     5460    4                 IF (B$SS.ISR.WSR  = %USERWSR) AND (S_CUN > S_MING)

   5460  2 000215   000004 736000                    QLS     4
         2 000216   000160 116007                    CMPQ    112,DL
         2 000217   000231 601000 2                  TNZ     s:5468
         2 000220   000000 236000 xsym               LDQ     S_CUN
         2 000221   000000 116000 xsym               CMPQ    S_MING
         2 000222   000231 604400 2                  TMOZ    s:5468

      307     5461    5                 THEN DO;

      308     5462    5                      ES$MON_SRV.PRIV# = %PR_EXMM#;

   5462  2 000223   000004 236000 xsym               LDQ     B_VECTNIL+4
         2 000224   000002 756000 0                  STQ     ES$MON_SRV+2

      309     5463
      310     5464    5                      IF NOT(B$JIT.PRIV.ACTIVE & %PR_EXMM#)

   5464  2 000225   000013 376100                    ANQ     11,,PR0
         2 000226   000231 601000 2                  TNZ     s:5468

      311     5465    5                      THEN B$JIT.ERR = JS_PRIV;

   5465  2 000227   000012 236000 0                  LDQ     JS_PRIV
         2 000230   000012 756100                    STQ     10,,PR0

      312     5466    5                      END;

      313     5467
      314     5468    4                 CALL SEC_LOG

   5468  2 000231   001572 701000 2                  TSX1    SEC_LOG
         2 000232   000241 702000 2                  TSX2    s:5471

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:61   
      315     5469    5                 WHENRETURN DO;

      316     5470    5                      CALL JSP$PMME(CODE);

   5470  2 000233   200003 630500                    EPPR0   CODE,,AUTO
         2 000234   200012 450500                    STP0    VPNO+3,,AUTO
         2 000235   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 000236   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000237   000000 701000 xent               TSX1    JSP$PMME
         2 000240   000000 011000                    NOP     0

      317     5471    5                      END;

   5471  2 000241   001475 710000 2                  TRA     s:5874

      318     5472
      319     5473    4               CASE(%C$FSUSER#);

      320     5474    4                 CALL JZD$FSUSER;

   5474  2 000242   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000243   000000 701000 xent               TSX1    JZD$FSUSER
         2 000244   000000 011000                    NOP     0
         2 000245   001475 710000 2                  TRA     s:5874

      321     5475    4               CASE(%C$ASUSER#);

      322     5476    4                 CALL JZD$ASUSER;

   5476  2 000246   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000247   000000 701000 xent               TSX1    JZD$ASUSER
         2 000250   000000 011000                    NOP     0
         2 000251   001475 710000 2                  TRA     s:5874

      323     5477    4               CASE(%C$DSUSER#);

      324     5478    4                 CALL JZD$DSUSER;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:62   

   5478  2 000252   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000253   000000 701000 xent               TSX1    JZD$DSUSER
         2 000254   000000 011000                    NOP     0
         2 000255   001475 710000 2                  TRA     s:5874

      325     5479
      326     5480    4               CASE(%C$ACCT#);

      327     5481    4                 CALL AFA$ACCT;

   5481  2 000256   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000257   000000 701000 xent               TSX1    AFA$ACCT
         2 000260   000000 011000                    NOP     0
         2 000261   001475 710000 2                  TRA     s:5874

      328     5482
      329     5483    4               CASE(ELSE);

      330     5484    4                 CALL JSP$PMME(CODE);

   5484  2 000262   200003 633500                    EPPR3   CODE,,AUTO
         2 000263   200012 453500                    STP3    VPNO+3,,AUTO
         2 000264   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 000265   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000266   000000 701000 xent               TSX1    JSP$PMME
         2 000267   000000 011000                    NOP     0

      331     5485    4                 END;

   5485  2 000270   001475 710000 2                  TRA     s:5874

      332     5486
      333     5487    3            CASE(%FCG_UE#);

      334     5488    3              CALL UEP$PMME(CODE);

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:63   
   5488  2 000271   200003 633500                    EPPR3   CODE,,AUTO
         2 000272   200012 453500                    STP3    VPNO+3,,AUTO
         2 000273   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 000274   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000275   000000 701000 xent               TSX1    UEP$PMME
         2 000276   000000 011000                    NOP     0
         2 000277   001475 710000 2                  TRA     s:5874

      335     5489
      336     5490        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:64   
      337     5491    3            CASE(%FCG_UM#);

      338     5492    4              DO CASE(CODE);

   5492  2 000300   200003 235100                    LDA     CODE,,AUTO
         2 000301   000027 115007                    CMPA    23,DL
         2 000302   000304 602005 2                  TNC     s:5492+4,AL
         2 000303   001475 710000 2                  TRA     s:5874
         2 000304   000333 710000 2                  TRA     s:5494
         2 000305   000337 710000 2                  TRA     s:5496
         2 000306   000343 710000 2                  TRA     s:5498
         2 000307   000352 710000 2                  TRA     s:5500
         2 000310   000361 710000 2                  TRA     s:5502
         2 000311   000365 710000 2                  TRA     s:5504
         2 000312   000371 710000 2                  TRA     s:5507
         2 000313   000375 710000 2                  TRA     s:5510
         2 000314   000401 710000 2                  TRA     s:5513
         2 000315   000405 710000 2                  TRA     s:5516
         2 000316   000411 710000 2                  TRA     s:5519
         2 000317   000415 710000 2                  TRA     s:5522
         2 000320   000421 710000 2                  TRA     s:5525
         2 000321   000425 710000 2                  TRA     s:5528
         2 000322   000431 710000 2                  TRA     s:5531
         2 000323   000435 710000 2                  TRA     s:5534
         2 000324   000441 710000 2                  TRA     s:5537
         2 000325   000461 710000 2                  TRA     s:5549
         2 000326   000465 710000 2                  TRA     s:5552
         2 000327   000474 710000 2                  TRA     s:5555
         2 000330   000500 710000 2                  TRA     s:5558
         2 000331   000504 710000 2                  TRA     s:5561
         2 000332   000510 710000 2                  TRA     s:5563

      339     5493    4               CASE(%C$ERRMSG#);

      340     5494    4                 CALL EMR$ERRMSG;

   5494  2 000333   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:65   
         2 000334   000000 701000 xent               TSX1    EMR$ERRMSG
         2 000335   000000 011000                    NOP     0
         2 000336   001475 710000 2                  TRA     s:5874

      341     5495    4               CASE(%C$FID#);

      342     5496    4                 CALL UMF$FID;

   5496  2 000337   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000340   000000 701000 xent               TSX1    UMF$FID
         2 000341   000000 011000                    NOP     0
         2 000342   001475 710000 2                  TRA     s:5874

      343     5497    4               CASE(%C$ENQ#);

      344     5498    4                 CALL UQB$UENQ(DOMAIN#);

   5498  2 000343   200005 633500                    EPPR3   DOMAIN#,,AUTO
         2 000344   200012 453500                    STP3    VPNO+3,,AUTO
         2 000345   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 000346   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000347   000000 701000 xent               TSX1    UQB$UENQ
         2 000350   000000 011000                    NOP     0
         2 000351   001475 710000 2                  TRA     s:5874

      345     5499    4               CASE(%C$DEQ#);

      346     5500    4                 CALL UQB$UDEQ(DOMAIN#);

   5500  2 000352   200005 633500                    EPPR3   DOMAIN#,,AUTO
         2 000353   200012 453500                    STP3    VPNO+3,,AUTO
         2 000354   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 000355   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000356   000000 701000 xent               TSX1    UQB$UDEQ
         2 000357   000000 011000                    NOP     0
         2 000360   001475 710000 2                  TRA     s:5874

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:66   
      347     5501    4               CASE(%C$TIME#);

      348     5502    4                 CALL UMT$TIME;

   5502  2 000361   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000362   000000 701000 xent               TSX1    UMT$TIME
         2 000363   000000 011000                    NOP     0
         2 000364   001475 710000 2                  TRA     s:5874

      349     5503    4               CASE(%C$NXTUSR#);

      350     5504    4                 CALL UMS$NXTUSR;

   5504  2 000365   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000366   000000 701000 xent               TSX1    UMS$NXTUSR
         2 000367   000000 011000                    NOP     0
         2 000370   001475 710000 2                  TRA     s:5874

      351     5505
      352     5506    4               CASE(%C$WAIT#);

      353     5507    4                 CALL UMT$WAIT;

   5507  2 000371   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000372   000000 701000 xent               TSX1    UMT$WAIT
         2 000373   000000 011000                    NOP     0
         2 000374   001475 710000 2                  TRA     s:5874

      354     5508
      355     5509    4               CASE(%C$DISPLAY#);

      356     5510    4                 CALL UMT$SYSLOAD;

   5510  2 000375   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000376   000000 701000 xent               TSX1    UMT$SYSLOAD
         2 000377   000000 011000                    NOP     0
         2 000400   001475 710000 2                  TRA     s:5874
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:67   

      357     5511
      358     5512    4               CASE(%C$STATE#);

      359     5513    4                 CALL SSC$STATE;

   5513  2 000401   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000402   000000 701000 xent               TSX1    SSC$STATE
         2 000403   000000 011000                    NOP     0
         2 000404   001475 710000 2                  TRA     s:5874

      360     5514
      361     5515    4               CASE(%C$XEQTIME#);

      362     5516    4                 CALL UMT$XEQTIME;

   5516  2 000405   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000406   000000 701000 xent               TSX1    UMT$XEQTIME
         2 000407   000000 011000                    NOP     0
         2 000410   001475 710000 2                  TRA     s:5874

      363     5517
      364     5518    4               CASE(%C$SPRIV#);

      365     5519    4                 CALL UMT$SPRIV;

   5519  2 000411   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000412   000000 701000 xent               TSX1    UMT$SPRIV
         2 000413   000000 011000                    NOP     0
         2 000414   001475 710000 2                  TRA     s:5874

      366     5520
      367     5521    4               CASE(%C$RPRIV#);

      368     5522    4                 CALL UMT$RPRIV;

   5522  2 000415   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:68   
         2 000416   000000 701000 xent               TSX1    UMT$RPRIV
         2 000417   000000 011000                    NOP     0
         2 000420   001475 710000 2                  TRA     s:5874

      369     5523
      370     5524    4               CASE(%C$SSWITCH#);

      371     5525    4                 CALL UMT$SSWITCH;

   5525  2 000421   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000422   000000 701000 xent               TSX1    UMT$SSWITCH
         2 000423   000000 011000                    NOP     0
         2 000424   001475 710000 2                  TRA     s:5874

      372     5526
      373     5527    4               CASE(%C$RSWITCH#);

      374     5528    4                 CALL UMT$RSWITCH;

   5528  2 000425   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000426   000000 701000 xent               TSX1    UMT$RSWITCH
         2 000427   000000 011000                    NOP     0
         2 000430   001475 710000 2                  TRA     s:5874

      375     5529
      376     5530    4               CASE(%C$CHGUNIT#);

      377     5531    4                 CALL UMT$CHGUNIT;

   5531  2 000431   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000432   000000 701000 xent               TSX1    UMT$CHGUNIT
         2 000433   000000 011000                    NOP     0
         2 000434   001475 710000 2                  TRA     s:5874

      378     5532
      379     5533    4               CASE(%C$USRFIELD#);

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:69   
      380     5534    4                 CALL UMT$MISC;

   5534  2 000435   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000436   000000 701000 xent               TSX1    UMT$MISC
         2 000437   000000 011000                    NOP     0
         2 000440   001475 710000 2                  TRA     s:5874

      381     5535
      382     5536    4               CASE(%C$RUE#);

      383     5537    4                 ES$MON_SRV.PRIV# = %PR_MSYS#;

   5537  2 000441   000012 236000 xsym               LDQ     B_VECTNIL+10
         2 000442   000002 756000 0                  STQ     ES$MON_SRV+2

      384     5538    4                 IF NOT ((B$JIT.ACCN = J_SYSTXT) OR (B$JIT.PRIV.ACTIVE & %PR_MSYS#))

   5538  2 000443   040000 106500                    CMPC    fill='040'O
         2 000444   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 000445   000000 000010 xsym               ADSC9   J_SYSTXT                 cn=0,n=8
         2 000446   000453 600000 2                  TZE     s:5543
         2 000447   000013 376100                    ANQ     11,,PR0
         2 000450   000453 601000 2                  TNZ     s:5543

      385     5539    5                 THEN DO;

      386     5540    5                      B$JIT.ERR = UM_PRIV;

   5540  2 000451   000011 236000 0                  LDQ     UM_PRIV
         2 000452   000012 756100                    STQ     10,,PR0

      387     5541    5                      END;

      388     5542
      389     5543    4                 CALL SEC_LOG

   5543  2 000453   001572 701000 2                  TSX1    SEC_LOG
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:70   
         2 000454   000460 702000 2                  TSX2    s:5546

      390     5544    5                 WHENRETURN DO;

      391     5545    5                      CALL SSR$MRUE;

   5545  2 000455   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000456   000000 701000 xent               TSX1    SSR$MRUE
         2 000457   000000 011000                    NOP     0

      392     5546    5                      END;

   5546  2 000460   001475 710000 2                  TRA     s:5874

      393     5547
      394     5548    4               CASE(%C$UNFID#);

      395     5549    4                 CALL UMU$UNFID;

   5549  2 000461   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000462   000000 701000 xent               TSX1    UMU$UNFID
         2 000463   000000 011000                    NOP     0
         2 000464   001475 710000 2                  TRA     s:5874

      396     5550
      397     5551    4               CASE(%C$GJOB#);

      398     5552    4                 CALL JGP$PMME(DOMAIN#);

   5552  2 000465   200005 633500                    EPPR3   DOMAIN#,,AUTO
         2 000466   200012 453500                    STP3    VPNO+3,,AUTO
         2 000467   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 000470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000471   000000 701000 xent               TSX1    JGP$PMME
         2 000472   000000 011000                    NOP     0
         2 000473   001475 710000 2                  TRA     s:5874

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:71   
      399     5553
      400     5554    4               CASE(%C$MONINFO#);

      401     5555    4                 CALL UMT$MONINFO;

   5555  2 000474   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000475   000000 701000 xent               TSX1    UMT$MONINFO
         2 000476   000000 011000                    NOP     0
         2 000477   001475 710000 2                  TRA     s:5874

      402     5556
      403     5557    4               CASE(%C$HELP#);

      404     5558    4                 CALL EMH$HELP;

   5558  2 000500   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000501   000000 701000 xent               TSX1    EMH$HELP
         2 000502   000000 011000                    NOP     0
         2 000503   001475 710000 2                  TRA     s:5874

      405     5559
      406     5560    4               CASE(%C$CMDVAR#);

      407     5561    4                 CALL UMC$CMDVAR;

   5561  2 000504   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000505   000000 701000 xent               TSX1    UMC$CMDVAR
         2 000506   000000 011000                    NOP     0
         2 000507   001475 710000 2                  TRA     s:5874

      408     5562    4               CASE(%C$SYSID#);

      409     5563    4                 CALL UMS$SYSID;

   5563  2 000510   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000511   000000 701000 xent               TSX1    UMS$SYSID
         2 000512   000000 011000                    NOP     0
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:72   

      410     5564    4                 END;

   5564  2 000513   001475 710000 2                  TRA     s:5874

      411     5565
      412     5566        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:73   
      413     5567    3            CASE(%FCG_MM#);

      414     5568    3              IF (CODE >= %C$STLPP#) AND (CODE <= %C$UMPL#)

   5568  2 000514   200003 235100                    LDA     CODE,,AUTO
         2 000515   000007 115007                    CMPA    7,DL
         2 000516   000614 604000 2                  TMI     CALL_MM
         2 000517   000023 115007                    CMPA    19,DL
         2 000520   000614 605400 2                  TPNZ    CALL_MM
         2 000521   000014 115007                    CMPA    12,DL
         2 000522   000614 600000 2                  TZE     CALL_MM
         2 000523   000016 115007                    CMPA    14,DL
         2 000524   000614 600000 2                  TZE     CALL_MM

      415     5569    3                AND (CODE ~= %C$GDDL#) AND (CODE ~= %C$STD#)
      416     5570    4              THEN DO;

      417     5571    4                   ES_INDX = CODE - %C$STLPP#;

   5571  2 000525   000007 135007                    SBLA    7,DL
         2 000526   200006 755100                    STA     ES_INDX,,AUTO

      418     5572    4                   ES$MON_SRV.PRIV# = MM_PRIVS(ES_INDX);

   5572  2 000527   000000 236005 1                  LDQ     MM_PRIVS,AL
         2 000530   000002 756000 0                  STQ     ES$MON_SRV+2

      419     5573
      420     5574    4                   IF (CODE = %C$CVM#) AND (B$PS0$->FPT$CVM_V.WSQFLG='1'B)

   5574  2 000531   200003 235100                    LDA     CODE,,AUTO
         2 000532   000011 115007                    CMPA    9,DL
         2 000533   000545 601000 2                  TNZ     s:5581
         2 000534   000000 473400 xsym               LDP3    B$PS0$
         2 000535   300000 234100                    SZN     0,,PR3
         2 000536   000545 605000 2                  TPL     s:5581
         2 000537   000013 236100                    LDQ     11,,PR0
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:74   
         2 000540   000004 376000 xsym               ANQ     B_VECTNIL+4
         2 000541   000545 601000 2                  TNZ     s:5581

      421     5575    4                     AND ( (B$JIT.PRIV.ACTIVE & %PR_EXMM#)='0'B)
      422     5576    5                   THEN DO;

      423     5577    5                        ES$MON_SRV.PRIV# = %PR_EXMM#;

   5577  2 000542   000004 236000 xsym               LDQ     B_VECTNIL+4
         2 000543   000002 756000 0                  STQ     ES$MON_SRV+2

      424     5578    5                        GOTO ERR_MM;

   5578  2 000544   000612 710000 2                  TRA     ERR_MM

      425     5579    5                        END;
      426     5580
      427     5581    4                   IF (CODE = %C$SMPRT#)

   5581  2 000545   000012 115007                    CMPA    10,DL
         2 000546   000575 601000 2                  TNZ     s:5598

      428     5582    5                   THEN DO;

      429     5583    5                        IF (B$PS0$->FPT$SMPRT_V.WSQFLG)

   5583  2 000547   000000 473400 xsym               LDP3    B$PS0$
         2 000550   300000 234100                    SZN     0,,PR3
         2 000551   000555 605000 2                  TPL     s:5587
         2 000552   000013 236100                    LDQ     11,,PR0
         2 000553   000004 376000 xsym               ANQ     B_VECTNIL+4
         2 000554   000612 600000 2                  TZE     ERR_MM

      430     5584    5                          AND NOT(B$JIT.PRIV.ACTIVE & %PR_EXMM#)
      431     5585    5                        THEN GOTO ERR_MM;
      432     5586
      433     5587    5                        IF NOT(B$JIT.PRIV.ACTIVE & %PR_EXMM#)
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:75   

   5587  2 000555   000013 236100                    LDQ     11,,PR0
         2 000556   000004 376000 xsym               ANQ     B_VECTNIL+4
         2 000557   000574 601000 2                  TNZ     s:5595

      434     5588    6                        THEN DO;

      435     5589    6                             VPNO = B$PS0$->FPT$SMPRT_V.VPNO;

   5589  2 000560   300001 236100                    LDQ     1,,PR3
         2 000561   777777 376007                    ANQ     -1,DL
         2 000562   200007 756100                    STQ     VPNO,,AUTO

      436     5590    6                             IF (VPNO < %ISEGLO) OR (VPNO > %ISEGHI)

   5590  2 000563   000100 116007                    CMPQ    64,DL
         2 000564   000612 602000 2                  TNC     ERR_MM
         2 000565   000500 116007                    CMPQ    320,DL
         2 000566   000612 603000 2                  TRC     ERR_MM
         2 000567   300001 236100                    LDQ     1,,PR3
         2 000570   000022 772000                    QRL     18
         2 000571   200007 036100                    ADLQ    VPNO,,AUTO
         2 000572   000501 116007                    CMPQ    321,DL
         2 000573   000612 603000 2                  TRC     ERR_MM

      437     5591    6                               OR ( (VPNO + B$PS0$->FPT$SMPRT_V.NUMPGS -1) > %ISEGHI)
      438     5592    6                             THEN GOTO ERR_MM;
      439     5593    6                             END;

      440     5594
      441     5595    5                        GOTO CALL_MM;

   5595  2 000574   000614 710000 2                  TRA     CALL_MM

      442     5596    5                        END/* C$SMPRT */;
      443     5597
      444     5598    4                   IF (CODE = %C$SSC#) AND (B$SS.ISR.WSR = %DBWSR)
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:76   

   5598  2 000575   000013 115007                    CMPA    11,DL
         2 000576   000606 601000 2                  TNZ     s:5604
         2 000577   100010 236100                    LDQ     8,,PR1
         2 000600   000160 376007                    ANQ     112,DL
         2 000601   000120 116007                    CMPQ    80,DL
         2 000602   000606 601000 2                  TNZ     s:5604

      445     5599    5                   THEN DO;

      446     5600    5                        ES$MON_SRV.PRIV# = %PR_DOMAIN#;

   5600  2 000603   000032 236000 1                  LDQ     PH_PRIVS+4
         2 000604   000002 756000 0                  STQ     ES$MON_SRV+2

      447     5601    5                        GOTO CALL_MM;

   5601  2 000605   000614 710000 2                  TRA     CALL_MM

      448     5602    5                        END;
      449     5603
      450     5604    4                   IF NOT( B$JIT.PRIV.ACTIVE & MM_PRIVS(ES_INDX) )

   5604  2 000606   200006 720100                    LXL0    ES_INDX,,AUTO
         2 000607   000013 236100                    LDQ     11,,PR0
         2 000610   000000 376010 1                  ANQ     MM_PRIVS,X0
         2 000611   000614 601000 2                  TNZ     CALL_MM

      451     5605    5                   THEN DO;

   5604  2 000612                       ERR_MM       null
      452     5606    5   ERR_MM:              ;
      453     5607    5                        B$JIT.ERR = MM_PRIV;

   5607  2 000612   000004 236000 0                  LDQ     MM_PRIV
         2 000613   000012 756100                    STQ     10,,PR0

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:77   
      454     5608    5                        END/*do if not priv.active*/;

      455     5609
      456     5610    4                   END/*do if STLPP <- code -> UMPL*/;

   5604  2 000614                       CALL_MM      null
      457     5611
      458     5612    3   CALL_MM:   ;
      459     5613    3              CALL SEC_LOG ALTRET(SKIP_MM);

   5613  2 000614   001572 701000 2                  TSX1    SEC_LOG
         2 000615   000637 702000 2                  TSX2    SKIP_MM

      460     5614    3              IF DOMAIN#=%USERWSR THEN DOMAIN#=%USERWSQ;

   5614  2 000616   200005 235100                    LDA     DOMAIN#,,AUTO
         2 000617   000007 115007                    CMPA    7,DL
         2 000620   000623 601000 2                  TNZ     s:5615

   5614  2 000621   000010 236007                    LDQ     8,DL
         2 000622   200005 756100                    STQ     DOMAIN#,,AUTO

      461     5615    3              IF DOMAIN#=%MONWSR THEN DOMAIN#=%MONWSQ;

   5615  2 000623   200005 235100                    LDA     DOMAIN#,,AUTO
         2 000624   000627 601000 2                  TNZ     s:5616

   5615  2 000625   000001 236007                    LDQ     1,DL
         2 000626   200005 756100                    STQ     DOMAIN#,,AUTO

      462     5616    3              CALL MMP$PMME(CODE,DOMAIN#);

   5616  2 000627   200005 630500                    EPPR0   DOMAIN#,,AUTO
         2 000630   200013 450500                    STP0    VPNO+4,,AUTO
         2 000631   200003 631500                    EPPR1   CODE,,AUTO
         2 000632   200012 451500                    STP1    VPNO+3,,AUTO
         2 000633   200012 630500                    EPPR0   VPNO+3,,AUTO
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:78   
         2 000634   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000635   000000 701000 xent               TSX1    MMP$PMME
         2 000636   000000 011000                    NOP     0

   5615  2 000637   001475 710000 2     SKIP_MM      TRA     s:5874

      463     5617
      464     5618    3   SKIP_MM:   ;
      465     5619
      466     5620        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:79   
      467     5621    3            CASE(%FCG_FM2#);

      468     5622    3              CALL CHECK_DCB ALTRET(BADDCB);

   5622  2 000640   001547 701000 2                  TSX1    CHECK_DCB
         2 000641   001540 702000 2                  TSX2    BADDCB

      469     5623    4              DO CASE(CODE);

   5623  2 000642   200003 235100                    LDA     CODE,,AUTO
         2 000643   000007 115007                    CMPA    7,DL
         2 000644   000646 602005 2                  TNC     s:5623+4,AL
         2 000645   001475 710000 2                  TRA     s:5874
         2 000646   000655 710000 2                  TRA     s:5625
         2 000647   000661 710000 2                  TRA     s:5628
         2 000650   000665 710000 2                  TRA     s:5631
         2 000651   000671 710000 2                  TRA     s:5634
         2 000652   000676 710000 2                  TRA     s:5637
         2 000653   000702 710000 2                  TRA     s:5640
         2 000654   000706 710000 2                  TRA     s:5643

      470     5624    4               CASE(%C$OPEN#);

      471     5625    4                 CALL FMM$OPN;

   5625  2 000655   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000656   000000 701000 xent               TSX1    FMM$OPN
         2 000657   000000 011000                    NOP     0
         2 000660   001475 710000 2                  TRA     s:5874

      472     5626
      473     5627    4               CASE(%C$CLOSE#);

      474     5628    4                 CALL FMP$CLS;

   5628  2 000661   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000662   000000 701000 xent               TSX1    FMP$CLS
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:80   
         2 000663   000000 011000                    NOP     0
         2 000664   001475 710000 2                  TRA     s:5874

      475     5629
      476     5630    4               CASE(%C$CHECK#);

      477     5631    4                 CALL FMF$CHECK;

   5631  2 000665   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000666   000000 701000 xent               TSX1    FMF$CHECK
         2 000667   000000 011000                    NOP     0
         2 000670   001475 710000 2                  TRA     s:5874

      478     5632
      479     5633    4               CASE(%C$TRUNC#);

      480     5634    4                 CALL FMF$TRUNC(0);

   5634  2 000671   000000 630400 3                  EPPR0   0
         2 000672   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000673   000000 701000 xent               TSX1    FMF$TRUNC
         2 000674   000000 011000                    NOP     0
         2 000675   001475 710000 2                  TRA     s:5874

      481     5635
      482     5636    4               CASE(%C$CVOL#);

      483     5637    4                 CALL FTW$CVOL;

   5637  2 000676   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000677   000000 701000 xent               TSX1    FTW$CVOL
         2 000700   000000 011000                    NOP     0
         2 000701   001475 710000 2                  TRA     s:5874

      484     5638
      485     5639    4               CASE(%C$LINES#);

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:81   
      486     5640    4                 CALL FSM$LINES;

   5640  2 000702   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000703   000000 701000 xent               TSX1    FSM$LINES
         2 000704   000000 011000                    NOP     0
         2 000705   001475 710000 2                  TRA     s:5874

      487     5641
      488     5642    4               CASE(%C$DEVICE#);

      489     5643    4                 CALL FSM$DEVICE;

   5643  2 000706   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000707   000000 701000 xent               TSX1    FSM$DEVICE
         2 000710   000000 011000                    NOP     0

      490     5644
      491     5645    4                 END;                      /*DO(FM2CODE)*/

   5645  2 000711   001475 710000 2                  TRA     s:5874

      492     5646
      493     5647    3            CASE(%FCG_FM3#);

      494     5648    4              DO CASE(CODE);

   5648  2 000712   200003 235100                    LDA     CODE,,AUTO
         2 000713   000011 115007                    CMPA    9,DL
         2 000714   000716 602005 2                  TNC     s:5648+4,AL
         2 000715   001475 710000 2                  TRA     s:5874
         2 000716   000727 710000 2                  TRA     s:5650
         2 000717   000733 710000 2                  TRA     s:5653
         2 000720   000737 710000 2                  TRA     s:5656
         2 000721   000743 710000 2                  TRA     s:5659
         2 000722   000747 710000 2                  TRA     s:5662
         2 000723   000753 710000 2                  TRA     s:5665
         2 000724   000776 710000 2                  TRA     s:5677
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:82   
         2 000725   001002 710000 2                  TRA     s:5680
         2 000726   001006 710000 2                  TRA     s:5683

      495     5649    4               CASE(%C$CORRES#);

      496     5650    4                 CALL FMF$CORRES;

   5650  2 000727   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000730   000000 701000 xent               TSX1    FMF$CORRES
         2 000731   000000 011000                    NOP     0
         2 000732   001475 710000 2                  TRA     s:5874

      497     5651
      498     5652    4               CASE(%C$SETFMA#);

      499     5653    4                 CALL FMF$SETFMA;

   5653  2 000733   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000734   000000 701000 xent               TSX1    FMF$SETFMA
         2 000735   000000 011000                    NOP     0
         2 000736   001475 710000 2                  TRA     s:5874

      500     5654
      501     5655    4               CASE(%C$GETDCB#);

      502     5656    4                 CALL FMM$GETDCB;

   5656  2 000737   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000740   000000 701000 xent               TSX1    FMM$GETDCB
         2 000741   000000 011000                    NOP     0
         2 000742   001475 710000 2                  TRA     s:5874

      503     5657
      504     5658    4               CASE(%C$RELDCB#);

      505     5659    4                 CALL FMM$RELDCB;

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:83   
   5659  2 000743   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000744   000000 701000 xent               TSX1    FMM$RELDCB
         2 000745   000000 011000                    NOP     0
         2 000746   001475 710000 2                  TRA     s:5874

      506     5660
      507     5661    4               CASE(%C$LDEV#);

      508     5662    4                 CALL FSL$LDEV;

   5662  2 000747   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000750   000000 701000 xent               TSX1    FSL$LDEV
         2 000751   000000 011000                    NOP     0
         2 000752   001475 710000 2                  TRA     s:5874

      509     5663
      510     5664    4               CASE(%C$MADMUCK#);

      511     5665    4                 CALL FMN$MADMUCK;

   5665  2 000753   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000754   000000 701000 xent               TSX1    FMN$MADMUCK
         2 000755   000000 011000                    NOP     0

      512     5666
      513     5667    4                 ES$MON_SRV.PRIV# = %PR_FMDIAG#;

   5667  2 000756   000033 236000 1                  LDQ     PH_PRIVS+5
         2 000757   000002 756000 0                  STQ     ES$MON_SRV+2

      514     5668
      515     5669    4                 ERR = B$JIT.ERR;

   5669  2 000760   000000 470400 xsym               LDP0    B$JIT$
         2 000761   000012 236100                    LDQ     10,,PR0
         2 000762   200007 756100                    STQ     VPNO,,AUTO

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:84   
      516     5670    4                 IF B$JIT.ERR.CODE ~= %E$NOTAUTH

   5670  2 000763   000012 236100                    LDQ     10,,PR0
         2 000764   377770 376007                    ANQ     131064,DL
         2 000765   006250 116007                    CMPQ    3240,DL
         2 000766   000770 600000 2                  TZE     s:5673

      517     5671    4                 THEN B$JIT.ERR = '0'B;

   5671  2 000767   000012 450100                    STZ     10,,PR0

      518     5672
      519     5673    4                 CALL SEC_LOG;

   5673  2 000770   001572 701000 2                  TSX1    SEC_LOG
         2 000771   000000 011000                    NOP     0

      520     5674    4                 B$JIT.ERR = ERR;

   5674  2 000772   200007 236100                    LDQ     VPNO,,AUTO
         2 000773   000000 470400 xsym               LDP0    B$JIT$
         2 000774   000012 756100                    STQ     10,,PR0
         2 000775   001475 710000 2                  TRA     s:5874

      521     5675
      522     5676    4               CASE(%C$REM#);

      523     5677    4                 CALL FTC$REM;

   5677  2 000776   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000777   000000 701000 xent               TSX1    FTC$REM
         2 001000   000000 011000                    NOP     0
         2 001001   001475 710000 2                  TRA     s:5874

      524     5678
      525     5679    4               CASE(%C$XFLUSH#);

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:85   
      526     5680    4                 CALL FSD$XFLUSH;

   5680  2 001002   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001003   000000 701000 xent               TSX1    FSD$XFLUSH
         2 001004   000000 011000                    NOP     0
         2 001005   001475 710000 2                  TRA     s:5874

      527     5681
      528     5682    4               CASE(%C$RELSTARF#);

      529     5683    4                 CALL FMQ$RELSTARFP;

   5683  2 001006   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001007   000000 701000 xent               TSX1    FMQ$RELSTARFP
         2 001010   000000 011000                    NOP     0

      530     5684
      531     5685    4                 END;

   5685  2 001011   001475 710000 2                  TRA     s:5874

      532     5686
      533     5687        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:86   
      534     5688    3            CASE(%FCG_TD#);

      535     5689    3              CALL SSS$BLOCK;

   5689  2 001012   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001013   000000 701000 xent               TSX1    SSS$BLOCK
         2 001014   000000 011000                    NOP     0

      536     5690
      537     5691    3              ES$MON_SRV.PRIV# = TD_PRIVS(CODE);

   5691  2 001015   200003 720100                    LXL0    CODE,,AUTO
         2 001016   000015 236010 1                  LDQ     TD_PRIVS,X0
         2 001017   000002 756000 0                  STQ     ES$MON_SRV+2

      538     5692
      539     5693    3              IF (CODE = %C$RDSYSLOG#) AND (B$JIT.ACCN = J_SYSTXT)

   5693  2 001020   200003 235100                    LDA     CODE,,AUTO
         2 001021   001027 601000 2                  TNZ     s:5696
         2 001022   000000 470400 xsym               LDP0    B$JIT$
         2 001023   040000 106500                    CMPC    fill='040'O
         2 001024   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 001025   000000 000010 xsym               ADSC9   J_SYSTXT                 cn=0,n=8
         2 001026   001067 600000 2                  TZE     CALL_TD

      540     5694    3              THEN GOTO CALL_TD;
      541     5695
      542     5696    3              IF (CODE = %C$WRSYSLOG#) AND (B$SS.ISR.WSR <= %ASLWSR)

   5696  2 001027   000001 115007                    CMPA    1,DL
         2 001030   001041 601000 2                  TNZ     s:5702
         2 001031   000000 470400 xsym               LDP0    B_MPT
         2 001032   000010 236100                    LDQ     8,,PR0
         2 001033   000160 376007                    ANQ     112,DL
         2 001034   000160 116007                    CMPQ    112,DL
         2 001035   001041 603000 2                  TRC     s:5702
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:87   

      543     5697    4              THEN DO;

      544     5698    4                   ES$MON_SRV.PRIV# = %PR_DOMAIN#;

   5698  2 001036   000032 236000 1                  LDQ     PH_PRIVS+4
         2 001037   000002 756000 0                  STQ     ES$MON_SRV+2

      545     5699    4                   GOTO CALL_TD;

   5699  2 001040   001067 710000 2                  TRA     CALL_TD

      546     5700    4                   END;
      547     5701
      548     5702    3              IF (CODE = %C$SYSCON#)

   5702  2 001041   000007 115007                    CMPA    7,DL
         2 001042   001061 601000 2                  TNZ     s:5712

      549     5703    4              THEN DO;

      550     5704    4                   IF (B$PS0$->FPT$SYSCON_V.FUNCTION = %DISPLAY#)

   5704  2 001043   000000 470400 xsym               LDP0    B$PS0$
         2 001044   000000 236100                    LDQ     0,,PR0
         2 001045   777000 376003                    ANQ     -512,DU
         2 001046   003000 116003                    CMPQ    1536,DU
         2 001047   001061 601000 2                  TNZ     s:5712
         2 001050   000005 236000 xsym               LDQ     B_VECTNIL+5
         2 001051   000034 276000 1                  ORQ     PH_PRIVS+6
         2 001052   000000 471400 xsym               LDP1    B$JIT$
         2 001053   100013 376100                    ANQ     11,,PR1
         2 001054   001061 600000 2                  TZE     s:5712

      551     5705    4                     AND (B$JIT.PRIV.ACTIVE & (%PR_MM# | %PR_TND#) )
      552     5706    5                   THEN DO;

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:88   
      553     5707    5                        ES$MON_SRV.PRIV# = (%PR_MM# | %PR_TND#);

   5707  2 001055   000005 236000 xsym               LDQ     B_VECTNIL+5
         2 001056   000034 276000 1                  ORQ     PH_PRIVS+6
         2 001057   000002 756000 0                  STQ     ES$MON_SRV+2

      554     5708    5                        GOTO CALL_TD;

   5708  2 001060   001067 710000 2                  TRA     CALL_TD

      555     5709    5                        END;
      556     5710    4                   END;
      557     5711
      558     5712    3              IF NOT( B$JIT.PRIV.ACTIVE & TD_PRIVS(CODE) )

   5712  2 001061   000000 470400 xsym               LDP0    B$JIT$
         2 001062   000013 236100                    LDQ     11,,PR0
         2 001063   000015 376010 1                  ANQ     TD_PRIVS,X0
         2 001064   001067 601000 2                  TNZ     CALL_TD

      559     5713    4              THEN DO;

      560     5714    4                   B$JIT.ERR = TD_PRIV;

   5714  2 001065   000005 236000 0                  LDQ     TD_PRIV
         2 001066   000012 756100                    STQ     10,,PR0

      561     5715    4                   END;

   5712  2 001067                       CALL_TD      null
      562     5716
      563     5717    3   CALL_TD:   ;
      564     5718    3              CALL SEC_LOG

   5718  2 001067   001572 701000 2                  TSX1    SEC_LOG
         2 001070   001110 702000 2                  TSX2    s:5724

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:89   
      565     5719    4              WHENRETURN DO;

      566     5720    4                   IF (CODE=%C$IOQ#) OR ( (CODE>=%C$TDOPEN#) AND (CODE<=%C$TDIO#) )

   5720  2 001071   200003 235100                    LDA     CODE,,AUTO
         2 001072   000006 115007                    CMPA    6,DL
         2 001073   001100 600000 2                  TZE     s:5721
         2 001074   000002 115007                    CMPA    2,DL
         2 001075   001102 604000 2                  TMI     s:5723
         2 001076   000004 115007                    CMPA    4,DL
         2 001077   001102 605400 2                  TPNZ    s:5723

      567     5721    4                   THEN CALL CHECK_DCB ALTRET(BADDCB);

   5721  2 001100   001547 701000 2                  TSX1    CHECK_DCB
         2 001101   001540 702000 2                  TSX2    BADDCB

      568     5722
      569     5723    4                   CALL TDP$PMME(CODE);

   5723  2 001102   200003 630500                    EPPR0   CODE,,AUTO
         2 001103   200012 450500                    STP0    VPNO+3,,AUTO
         2 001104   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001105   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001106   000000 701000 xent               TSX1    TDP$PMME
         2 001107   000000 011000                    NOP     0

      570     5724    4                   END/*do on return from SEC_LOG*/;

   5724  2 001110   001475 710000 2                  TRA     s:5874

      571     5725
      572     5726        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:90   
      573     5727    3            CASE(%FCG_KC#);

      574     5728    3              CALL CHECK_DCB ALTRET(BADDCB);

   5728  2 001111   001547 701000 2                  TSX1    CHECK_DCB
         2 001112   001540 702000 2                  TSX2    BADDCB

      575     5729    3              CALL KCP$PMME(CODE);

   5729  2 001113   200003 630500                    EPPR0   CODE,,AUTO
         2 001114   200012 450500                    STP0    VPNO+3,,AUTO
         2 001115   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001116   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001117   000000 701000 xent               TSX1    KCP$PMME
         2 001120   000000 011000                    NOP     0
         2 001121   001475 710000 2                  TRA     s:5874

      576     5730
      577     5731    3            CASE(%FCG_OT#);

      578     5732    3              CALL SSS$BLOCK;

   5732  2 001122   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001123   000000 701000 xent               TSX1    SSS$BLOCK
         2 001124   000000 011000                    NOP     0

      579     5733    3              CALL OTW$PMME (CODE);

   5733  2 001125   200003 630500                    EPPR0   CODE,,AUTO
         2 001126   200012 450500                    STP0    VPNO+3,,AUTO
         2 001127   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001131   000000 701000 xent               TSX1    OTW$PMME
         2 001132   000000 011000                    NOP     0
         2 001133   001475 710000 2                  TRA     s:5874

      580     5734
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:91   
      581     5735    3            CASE(%FCG_OC#);

      582     5736    3              CALL SSS$BLOCK;

   5736  2 001134   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001135   000000 701000 xent               TSX1    SSS$BLOCK
         2 001136   000000 011000                    NOP     0

      583     5737    4              DO CASE(CODE);

   5737  2 001137   200003 235100                    LDA     CODE,,AUTO
         2 001140   000002 115007                    CMPA    2,DL
         2 001141   001143 602005 2                  TNC     s:5737+4,AL
         2 001142   001475 710000 2                  TRA     s:5874
         2 001143   001145 710000 2                  TRA     s:5739
         2 001144   001151 710000 2                  TRA     s:5742

      584     5738    4               CASE(%C$KEYIN#);

      585     5739    4                 CALL OCU$PMME;

   5739  2 001145   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001146   000000 701000 xent               TSX1    OCU$PMME
         2 001147   000000 011000                    NOP     0
         2 001150   001475 710000 2                  TRA     s:5874

      586     5740
      587     5741    4               CASE(%C$OCMSG#);

      588     5742    4                 ES$MON_SRV.PRIV# = %PR_DOMAIN#;

   5742  2 001151   000032 236000 1                  LDQ     PH_PRIVS+4
         2 001152   000002 756000 0                  STQ     ES$MON_SRV+2

      589     5743    4                 IF B$SS.ISR.WSR >%DBWSR

   5743  2 001153   000000 470400 xsym               LDP0    B_MPT
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:92   
         2 001154   000010 236100                    LDQ     8,,PR0
         2 001155   000160 376007                    ANQ     112,DL
         2 001156   000140 116007                    CMPQ    96,DL
         2 001157   001166 602000 2                  TNC     s:5748
         2 001160   000000 471400 xsym               LDP1    B$JIT$
         2 001161   100013 236100                    LDQ     11,,PR1
         2 001162   000012 376000 xsym               ANQ     B_VECTNIL+10
         2 001163   001166 601000 2                  TNZ     s:5748

      590     5744    4                   AND
      591     5745    4                   NOT B$JIT.PRIV.ACTIVE & %PR_MSYS#
      592     5746    4                 THEN B$JIT.ERR = OC_PRIV;

   5746  2 001164   000010 236000 0                  LDQ     OC_PRIV
         2 001165   100012 756100                    STQ     10,,PR1

      593     5747
      594     5748    4                 CALL SEC_LOG

   5748  2 001166   001572 701000 2                  TSX1    SEC_LOG
         2 001167   001176 702000 2                  TSX2    s:5752

      595     5749    5                 WHENRETURN DO;

      596     5750    5                      CALL OCU$OCMSG(CODE);

   5750  2 001170   200003 630500                    EPPR0   CODE,,AUTO
         2 001171   200012 450500                    STP0    VPNO+3,,AUTO
         2 001172   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001173   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001174   000000 701000 xent               TSX1    OCU$OCMSG
         2 001175   000000 011000                    NOP     0

      597     5751    5                      END;

      598     5752    4                 END;

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:93   
   5752  2 001176   001475 710000 2                  TRA     s:5874

      599     5753
      600     5754    3            CASE(%FCG_KL#);

      601     5755    3              CALL SSS$BLOCK;

   5755  2 001177   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001200   000000 701000 xent               TSX1    SSS$BLOCK
         2 001201   000000 011000                    NOP     0

      602     5756    4              DO CASE (CODE);

   5756  2 001202   200003 235100                    LDA     CODE,,AUTO
         2 001203   000002 115007                    CMPA    2,DL
         2 001204   001206 602005 2                  TNC     s:5756+4,AL
         2 001205   001475 710000 2                  TRA     s:5874
         2 001206   001210 710000 2                  TRA     s:5758
         2 001207   001214 710000 2                  TRA     s:5760

      603     5757    4               CASE(%C$PATHCON#);

      604     5758    4                 CALL KLM$PATHCON;

   5758  2 001210   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001211   000000 701000 xent               TSX1    KLM$PATHCON
         2 001212   000000 011000                    NOP     0
         2 001213   001475 710000 2                  TRA     s:5874

      605     5759    4               CASE(%C$EXHUME#);

      606     5760    4                 CALL KLM$EXHUME;

   5760  2 001214   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001215   000000 701000 xent               TSX1    KLM$EXHUME
         2 001216   000000 011000                    NOP     0

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:94   
      607     5761    4                 END;

   5761  2 001217   001475 710000 2                  TRA     s:5874

      608     5762
      609     5763        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:95   
      610     5764    3            CASE(%FCG_PH#);

      611     5765    3              IF (CODE < %C$SMOUSE#) OR (CODE = %C$FEPDATA#)

   5765  2 001220   200003 235100                    LDA     CODE,,AUTO
         2 001221   000003 115007                    CMPA    3,DL
         2 001222   001225 604000 2                  TMI     s:5766
         2 001223   000007 115007                    CMPA    7,DL
         2 001224   001230 601000 2                  TNZ     s:5769

      612     5766    3              THEN B$JIT.ERR = EOLDPMME;

   5766  2 001225   000020 236000 0                  LDQ     EOLDPMME
         2 001226   000012 756100                    STQ     10,,PR0
         2 001227   001475 710000 2                  TRA     s:5874

      613     5767
      614     5768    4              ELSE DO;

      615     5769    4                   ES_INDX = CODE - %C$SMOUSE#;

   5769  2 001230   000003 135007                    SBLA    3,DL
         2 001231   200006 755100                    STA     ES_INDX,,AUTO

      616     5770    4                   ES$MON_SRV.PRIV# = PH_PRIVS(ES_INDX);

   5770  2 001232   000026 236005 1                  LDQ     PH_PRIVS,AL
         2 001233   000002 756000 0                  STQ     ES$MON_SRV+2

      617     5771
      618     5772    4                   IF NOT( B$JIT.PRIV.ACTIVE & PH_PRIVS(ES_INDX) )

   5772  2 001234   200006 720100                    LXL0    ES_INDX,,AUTO
         2 001235   000013 236100                    LDQ     11,,PR0
         2 001236   000026 376010 1                  ANQ     PH_PRIVS,X0
         2 001237   001242 601000 2                  TNZ     s:5777

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:96   
      619     5773    5                   THEN DO;

      620     5774    5                        B$JIT.ERR = PH_PRIV;

   5774  2 001240   000006 236000 0                  LDQ     PH_PRIV
         2 001241   000012 756100                    STQ     10,,PR0

      621     5775    5                        END;

      622     5776
      623     5777    4                   CALL SEC_LOG

   5777  2 001242   001572 701000 2                  TSX1    SEC_LOG
         2 001243   001276 702000 2                  TSX2    s:5790

      624     5778    5                   WHENRETURN DO;

      625     5779    6                        DO CASE(CODE);

   5779  2 001244   200003 235100                    LDA     CODE,,AUTO
         2 001245   000007 115007                    CMPA    7,DL
         2 001246   001250 602005 2                  TNC     s:5779+4,AL
         2 001247   001276 710000 2                  TRA     s:5790
         2 001250   001276 710000 2                  TRA     s:5790
         2 001251   001276 710000 2                  TRA     s:5790
         2 001252   001276 710000 2                  TRA     s:5790
         2 001253   001257 710000 2                  TRA     s:5781
         2 001254   001263 710000 2                  TRA     s:5783
         2 001255   001267 710000 2                  TRA     s:5785
         2 001256   001273 710000 2                  TRA     s:5787

      626     5780    6                         CASE(%C$SMOUSE#);

      627     5781    6                           CALL PHA$SMOUSE;

   5781  2 001257   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001260   000000 701000 xent               TSX1    PHA$SMOUSE
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:97   
         2 001261   000000 011000                    NOP     0
         2 001262   001276 710000 2                  TRA     s:5790

      628     5782    6                         CASE(%C$XMOUSE#);

      629     5783    6                           CALL PHA$XMOUSE;

   5783  2 001263   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001264   000000 701000 xent               TSX1    PHA$XMOUSE
         2 001265   000000 011000                    NOP     0
         2 001266   001276 710000 2                  TRA     s:5790

      630     5784    6                         CASE(%C$GETMOUSE#);

      631     5785    6                           CALL PHA$GETMOUSE;

   5785  2 001267   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001270   000000 701000 xent               TSX1    PHA$GETMOUSE
         2 001271   000000 011000                    NOP     0
         2 001272   001276 710000 2                  TRA     s:5790

      632     5786    6                         CASE(%C$GETPM#);

      633     5787    6                           CALL PHA$GETPM;

   5787  2 001273   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001274   000000 701000 xent               TSX1    PHA$GETPM
         2 001275   000000 011000                    NOP     0

      634     5788    6                           END/*do case PH code*/;

      635     5789    5                        END/*do on return from SEC_LOG*/;

      636     5790    4                   END/*do if not old pmme*/;

   5790  2 001276   001475 710000 2                  TRA     s:5874

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:98   
      637     5791
      638     5792
      639     5793        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:99   
      640     5794    3            CASE(%FCG_FR#);

      641     5795    3              CALL SSS$BLOCK;

   5795  2 001277   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001300   000000 701000 xent               TSX1    SSS$BLOCK
         2 001301   000000 011000                    NOP     0

      642     5796
      643     5797    3              ES$MON_SRV.PRIV# = %PR_DOMAIN#;

   5797  2 001302   000032 236000 1                  LDQ     PH_PRIVS+4
         2 001303   000002 756000 0                  STQ     ES$MON_SRV+2

      644     5798
      645     5799    3              IF (CODE=%C$LIMIT#) OR (CODE=%C$RACST#) OR (CODE=%C$MBS#)

   5799  2 001304   200003 235100                    LDA     CODE,,AUTO
         2 001305   001312 600000 2                  TZE     s:5801
         2 001306   000005 115007                    CMPA    5,DL
         2 001307   001312 600000 2                  TZE     s:5801
         2 001310   000001 115007                    CMPA    1,DL
         2 001311   001335 601000 2                  TNZ     CALL_FR

      646     5800    4              THEN DO;

      647     5801    4                   IF (CODE = %C$MBS#) AND (B$JIT.SYSID <= JG_MING#)

   5801  2 001312   000001 115007                    CMPA    1,DL
         2 001313   001327 601000 2                  TNZ     s:5810
         2 001314   000000 470400 xsym               LDP0    B$JIT$
         2 001315   000000 720100                    LXL0    0,,PR0
         2 001316   000020 100003                    CMPX0   16,DU
         2 001317   001327 603000 2                  TRC     s:5810

      648     5802    5                   THEN DO;

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:100  
      649     5803    5                        IF B$PS0$->FPT$RESCTL_V.MBSDISP = '0'B

   5803  2 001320   000000 471400 xsym               LDP1    B$PS0$
         2 001321   100001 236100                    LDQ     1,,PR1
         2 001322   200000 316003                    CANQ    65536,DU
         2 001323   001335 601000 2                  TNZ     CALL_FR

      650     5804    5                        THEN IF (B$JIT.SYSID = JG_MBS#)

   5804  2 001324   000001 100003                    CMPX0   1,DU
         2 001325   001335 600000 2                  TZE     CALL_FR

      651     5805    5                             THEN GOTO CALL_FR;
      652     5806    5                             ELSE GOTO SET_FR_ERR;

   5806  2 001326   001332 710000 2                  TRA     SET_FR_ERR

      653     5807    5                        ELSE GOTO CALL_FR;
      654     5808    5                        END;
      655     5809
      656     5810    4                   IF DOMAIN# > %CPWSR

   5810  2 001327   200005 235100                    LDA     DOMAIN#,,AUTO
         2 001330   000005 115007                    CMPA    5,DL
         2 001331   001335 602000 2                  TNC     CALL_FR

      657     5811    5                   THEN DO;

   5804  2 001332                       SET_FR_ERR   null
      658     5812    5   SET_FR_ERR:          ;
      659     5813    5                        B$JIT.ERR = FR_PRIV;

   5813  2 001332   000013 236000 0                  LDQ     FR_PRIV
         2 001333   000000 470400 xsym               LDP0    B$JIT$
         2 001334   000012 756100                    STQ     10,,PR0

      660     5814    5                        END;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:101  

      661     5815    4                   END;

   5804  2 001335                       CALL_FR      null
      662     5816
      663     5817    3   CALL_FR:   ;
      664     5818    3              CALL SEC_LOG

   5818  2 001335   001572 701000 2                  TSX1    SEC_LOG
         2 001336   001345 702000 2                  TSX2    s:5821

      665     5819    4              WHENRETURN DO;

      666     5820    4                   CALL FRP$PMME(CODE);

   5820  2 001337   200003 630500                    EPPR0   CODE,,AUTO
         2 001340   200012 450500                    STP0    VPNO+3,,AUTO
         2 001341   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001342   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001343   000000 701000 xent               TSX1    FRP$PMME
         2 001344   000000 011000                    NOP     0

      667     5821    4                   END;

   5821  2 001345   001475 710000 2                  TRA     s:5874

      668     5822
      669     5823        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:102  
      670     5824    3            CASE(%FCG_KI#);

      671     5825    4              DO CASE(CODE);

   5825  2 001346   200003 235100                    LDA     CODE,,AUTO
         2 001347   000015 135007                    SBLA    13,DL
         2 001350   000015 115007                    CMPA    13,DL
         2 001351   001353 602005 2                  TNC     s:5825+5,AL
         2 001352   001426 710000 2                  TRA     s:5848
         2 001353   001400 710000 2                  TRA     s:5832
         2 001354   001400 710000 2                  TRA     s:5832
         2 001355   001400 710000 2                  TRA     s:5832
         2 001356   001426 710000 2                  TRA     s:5848
         2 001357   001426 710000 2                  TRA     s:5848
         2 001360   001370 710000 2                  TRA     s:5827
         2 001361   001374 710000 2                  TRA     s:5829
         2 001362   001426 710000 2                  TRA     s:5848
         2 001363   001426 710000 2                  TRA     s:5848
         2 001364   001426 710000 2                  TRA     s:5848
         2 001365   001426 710000 2                  TRA     s:5848
         2 001366   001426 710000 2                  TRA     s:5848
         2 001367   001417 710000 2                  TRA     s:5845

      672     5826    4               CASE(%C$DRIBBLE#);

      673     5827    4                 CALL UMD$DRIBBLE;

   5827  2 001370   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001371   000000 701000 xent               TSX1    UMD$DRIBBLE
         2 001372   000000 011000                    NOP     0
         2 001373   001475 710000 2                  TRA     s:5874

      674     5828    4               CASE(%C$CONFIG#);

      675     5829    4                 CALL KIC$CONFIG;

   5829  2 001374   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:103  
         2 001375   000000 701000 xent               TSX1    KIC$CONFIG
         2 001376   000000 011000                    NOP     0
         2 001377   001475 710000 2                  TRA     s:5874

      676     5830
      677     5831    4               CASE(%C$FEBOOT#, %C$FEDUMP#, %C$FECTL#);

      678     5832    4                 ES$MON_SRV.PRIV# = %PR_MFEP#;

   5832  2 001400   000035 236000 1                  LDQ     PH_PRIVS+7
         2 001401   000002 756000 0                  STQ     ES$MON_SRV+2

      679     5833
      680     5834    4                 IF NOT(B$JIT.PRIV.ACTIVE & %PR_MFEP#)

   5834  2 001402   000013 376100                    ANQ     11,,PR0
         2 001403   001406 601000 2                  TNZ     s:5839

      681     5835    5                 THEN DO;

      682     5836    5                      B$JIT.ERR = KI_PRIV;

   5836  2 001404   000007 236000 0                  LDQ     KI_PRIV
         2 001405   000012 756100                    STQ     10,,PR0

      683     5837    5                      END/*do if not priv.active*/;

      684     5838
      685     5839    4                 CALL SEC_LOG

   5839  2 001406   001572 701000 2                  TSX1    SEC_LOG
         2 001407   001416 702000 2                  TSX2    s:5842

      686     5840    5                 WHENRETURN DO;

      687     5841    5                      CALL KIP$CPMME(CODE);

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:104  
   5841  2 001410   200003 630500                    EPPR0   CODE,,AUTO
         2 001411   200012 450500                    STP0    VPNO+3,,AUTO
         2 001412   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001413   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001414   000000 701000 xent               TSX1    KIP$CPMME
         2 001415   000000 011000                    NOP     0

      688     5842    5                      END;

   5842  2 001416   001475 710000 2                  TRA     s:5874

      689     5843
      690     5844    4               CASE(%C$NODEINFO#);

      691     5845    4                 CALL KIP$CPMME(CODE);

   5845  2 001417   200003 633500                    EPPR3   CODE,,AUTO
         2 001420   200012 453500                    STP3    VPNO+3,,AUTO
         2 001421   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001422   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001423   000000 701000 xent               TSX1    KIP$CPMME
         2 001424   000000 011000                    NOP     0
         2 001425   001475 710000 2                  TRA     s:5874

      692     5846
      693     5847    4               CASE(ELSE);

      694     5848    4                 CALL CHECK_DCB ALTRET(BADDCB);

   5848  2 001426   001547 701000 2                  TSX1    CHECK_DCB
         2 001427   001540 702000 2                  TSX2    BADDCB

      695     5849    4                 IF CODE = %C$SETFP#

   5849  2 001430   200003 235100                    LDA     CODE,,AUTO
         2 001431   000021 115007                    CMPA    17,DL
         2 001432   001437 601000 2                  TNZ     s:5851
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:105  

      696     5850    4                 THEN CALL KIF$FPRG;

   5850  2 001433   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001434   000000 701000 xent               TSX1    KIF$FPRG
         2 001435   000000 011000                    NOP     0
         2 001436   001475 710000 2                  TRA     s:5874

      697     5851    4                 ELSE CALL KIP$PMME(CODE);

   5851  2 001437   200003 630500                    EPPR0   CODE,,AUTO
         2 001440   200012 450500                    STP0    VPNO+3,,AUTO
         2 001441   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001442   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001443   000000 701000 xent               TSX1    KIP$PMME
         2 001444   000000 011000                    NOP     0

      698     5852    4                 END;

   5852  2 001445   001475 710000 2                  TRA     s:5874

      699     5853
      700     5854        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:106  
      701     5855    3            CASE(%FCG_FO#);

      702     5856    3              CALL SSS$BLOCK;

   5856  2 001446   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001447   000000 701000 xent               TSX1    SSS$BLOCK
         2 001450   000000 011000                    NOP     0

      703     5857    4              DO CASE(CODE);

   5857  2 001451   200003 235100                    LDA     CODE,,AUTO
         2 001452   000002 115007                    CMPA    2,DL
         2 001453   001455 602005 2                  TNC     s:5857+4,AL
         2 001454   001475 710000 2                  TRA     s:5874
         2 001455   001457 710000 2                  TRA     s:5859
         2 001456   001470 710000 2                  TRA     s:5862

      704     5858    4               CASE(%C$SYMBIO#);

      705     5859    4                 CALL CHECK_DCB ALTRET(BADDCB);

   5859  2 001457   001547 701000 2                  TSX1    CHECK_DCB
         2 001460   001540 702000 2                  TSX2    BADDCB

      706     5860    4                 CALL FOM$PMME(CODE);

   5860  2 001461   200003 630500                    EPPR0   CODE,,AUTO
         2 001462   200012 450500                    STP0    VPNO+3,,AUTO
         2 001463   200012 630500                    EPPR0   VPNO+3,,AUTO
         2 001464   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001465   000000 701000 xent               TSX1    FOM$PMME
         2 001466   000000 011000                    NOP     0
         2 001467   001475 710000 2                  TRA     s:5874

      707     5861    4               CASE(%C$JOBSTATS#);

      708     5862    4                 CALL FOS$PMME;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:107  

   5862  2 001470   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001471   000000 701000 xent               TSX1    FOS$PMME
         2 001472   000000 011000                    NOP     0

      709     5863    4                 END;

   5863  2 001473   001475 710000 2                  TRA     s:5874

      710     5864
      711     5865    3            CASE(ELSE);

      712     5866    3              GOTO BADX0;

   5866  2 001474   000076 710000 2                  TRA     BADX0

      713     5867
      714     5868    3              END/*do(fcg) */;

      715     5869    2           END/*do if not fcg FM1*/;
      716     5870
      717     5871        /* In the simplest and most common case, no need to call PMMEXIT,
      718     5872           just get out.
      719     5873        */
      720     5874    1      IF (B$JIT.ERR='0'B)

   5874  2 001475   000000 470400 xsym               LDP0    B$JIT$
         2 001476   000012 235100                    LDA     10,,PR0
         2 001477   001513 601000 2                  TNZ     s:5883
         2 001500   000000 236000 xsym               LDQ     PH_MOUSE_USERS
         2 001501   001513 601000 2                  TNZ     s:5883
         2 001502   000315 220100                    LDX0    205,,PR0
         2 001503   001000 360003                    ANX0    512,DU
         2 001504   001513 601000 2                  TNZ     s:5883

      721     5875    1        AND (PH_MOUSE_USERS = 0)
      722     5876    1        AND ((B$JIT.JUNK&%JJ_BAKIC#)='0'B)
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:108  
      723     5877    2      THEN DO;

      724     5878    2           P_CALCOMP(S_PNO)=P_CALCOMP(S_PNO)+1;

   5878  2 001505   000000 720000 xsym               LXL0    S_PNO
         2 001506   000000 054010 xsym               AOS     P_CALCOMP,X0

      725     5879    2           CALL UDB$AUTOQ;

   5879  2 001507   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001510   000000 701000 xent               TSX1    UDB$AUTOQ
         2 001511   000000 011000                    NOP     0

      726     5880    2           END;

   5880  2 001512   001524 710000 2                  TRA     FM1_BADDCB

      727     5881
      728     5882    1      ELSE
      729     5883    1           IF B$JIT.ERR = '0'B

   5883  2 001513   000000 115003                    CMPA    0,DU
         2 001514   001521 601000 2                  TNZ     s:5885

      730     5884    1           THEN CALL UDB$PMMEXIT1;

   5884  2 001515   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001516   000000 701000 xent               TSX1    UDB$PMMEXIT1
         2 001517   000000 011000                    NOP     0
         2 001520   001524 710000 2                  TRA     FM1_BADDCB

      731     5885    1           ELSE CALL UDB$PMMEXIT;

   5885  2 001521   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001522   000000 701000 xent               TSX1    UDB$PMMEXIT
         2 001523   000000 011000                    NOP     0

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:109  
   5883  2 001524                       FM1_BADDCB   null
      732     5886
      733     5887        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:110  
      734     5888
      735     5889
      736     5890                                                /* Error Routines                     */
      737     5891    1   FM1_BADDCB: ;
      738     5892    1      IF (CODE=%C$REW#) AND (B$PS0$ -> DCB# = 0)

   5892  2 001524   200003 235100                    LDA     CODE,,AUTO
         2 001525   000006 115007                    CMPA    6,DL
         2 001526   001540 601000 2                  TNZ     BADDCB
         2 001527   000000 470400 xsym               LDP0    B$PS0$
         2 001530   000000 220100                    LDX0    0,,PR0
         2 001531   001540 601000 2                  TNZ     BADDCB

      739     5893    2      THEN DO;

      740     5894    2           CALL FTC$REW;

   5894  2 001532   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001533   000000 701000 xent               TSX1    FTC$REW
         2 001534   000000 011000                    NOP     0

      741     5895    2           CALL UDB$PMMEXIT;

   5895  2 001535   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001536   000000 701000 xent               TSX1    UDB$PMMEXIT
         2 001537   000000 011000                    NOP     0

      742     5896    2           END;

      743     5897    1   BADDCB: B$JIT.ERR=EBADDCB;

   5897  2 001540   000014 236000 0     BADDCB       LDQ     EBADDCB
         2 001541   000000 470400 xsym               LDP0    B$JIT$
         2 001542   000012 756100                    STQ     10,,PR0

      744     5898    1      CALL UDB$PMMEXIT;

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:111  
   5898  2 001543   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001544   000000 701000 xent               TSX1    UDB$PMMEXIT
         2 001545   000000 011000                    NOP     0
         2 001546   001706 710000 2                  TRA     s:6169

      745     5899
      746     5900        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:112  
      747     5901                                                /* CHECK_DCB   Internal Routine       */
      748     5902    1   CHECK_DCB: PROC ALTRET;

   5902  2 001547   200010 741300       CHECK_DCB    STX1  ! VPNO+1,,AUTO

      749     5903    2      IF B$PS0$ -> DCB# > B$ROSEG.NUMDCBS

   5903  2 001550   000000 470400 xsym               LDP0    B$ROSEG$
         2 001551   000002 220100                    LDX0    2,,PR0
         2 001552   000000 471400 xsym               LDP1    B$PS0$
         2 001553   100000 100100                    CMPX0   0,,PR1
         2 001554   001556 603000 2                  TRC     s:5906

      750     5904    2      THEN ALTRETURN;

   5904  2 001555   000000 702211                    TSX2  ! 0,X1

      751     5905
      752     5906    2      B$JIT.DCBNO = B$PS0$ -> DCB#;

   5906  2 001556   000000 473400 xsym               LDP3    B$JIT$
         2 001557   100000 236100                    LDQ     0,,PR1
         2 001560   000022 772000                    QRL     18
         2 001561   300022 552104                    STBQ    18,'04'O,PR3

      753     5907    2      B$JIT.DCB$ = B$ROSEG.DCBPTR$ -> B$DCB$TAB (B$PS0$ -> DCB#);

   5907  2 001562   000000 474500                    LDP4    0,,PR0
         2 001563   100000 220100                    LDX0    0,,PR1
         2 001564   400000 236110                    LDQ     0,X0,PR4
         2 001565   300232 756100                    STQ     154,,PR3

      754     5908    2      IF B$JIT.DCB$ = ADDR(NIL)

   5908  2 001566   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001567   001571 601000 2                  TNZ     s:5911

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:113  
      755     5909    2      THEN ALTRETURN;

   5909  2 001570   000000 702211                    TSX2  ! 0,X1

      756     5910
      757     5911    2      RETURN;

   5911  2 001571   000001 702211                    TSX2  ! 1,X1

      758     5912    2   END CHECK_DCB;
      759     5913        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:114  
      760     5914
      761     5915                                                /* SEC_LOG  Internal Routine          */
      762     5916    1   SEC_LOG: PROC ALTRET;

   5916  2 001572   200010 741300       SEC_LOG      STX1  ! VPNO+1,,AUTO

      763     5917
      764     5918    2   DCL B$MONSER(0:35) BIT(1) BASED;
      765     5919
      766     5920
      767     5921    2     IF (ES_LOGMONSER ~= %PC_ES_NONE#) AND (ADDR(ES_MONSERTBL(FCG))->B$MONSER(CODE) ~=
              5921               '0'B)

   5921  2 001573   000000 235000 xsym               LDA     ES_LOGMONSER
         2 001574   001664 600000 2                  TZE     s:5955
         2 001575   200004 236100                    LDQ     FCG,,AUTO
         2 001576   000044 402007                    MPY     36,DL
         2 001577   200003 036100                    ADLQ    CODE,,AUTO
         2 001600   001602 605000 2                  TPL     s:5921+7
         2 001601   000044 036003                    ADLQ    36,DU
         2 001602   000000 066406                    CMPB    filb='0'B
         2 001603   000000 000001 xsym               BDSC    ES_MONSERTBL,Q           by=0,bit=0,n=1
         2 001604   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 001605   001664 600000 2                  TZE     s:5955
         2 001606   000000 236000 xsym               LDQ     S_CUN
         2 001607   000000 116000 xsym               CMPQ    S_MING
         2 001610   001664 604400 2                  TMOZ    s:5955

      768     5922    2        AND (S_CUN > S_MING)
      769     5923    3      THEN DO;

      770     5924    3           ES$MON_SRV.PMME_TYPE# = BITBIN(B$SS.FPT & '377777'O);

   5924  2 001611   000000 470400 xsym               LDP0    B_MPT
         2 001612   000001 220100                    LDX0    1,,PR0
         2 001613   377777 360003                    ANX0    131071,DU
         2 001614   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:115  
         2 001615   000022 772000                    QRL     18
         2 001616   000000 620006                    EAX0    0,QL
         2 001617   000001 740000 0                  STX0    ES$MON_SRV+1

      771     5925
      772     5926    3           IF B$JIT.ERR.CODE ~= 0

   5926  2 001620   000000 471400 xsym               LDP1    B$JIT$
         2 001621   100012 236100                    LDQ     10,,PR1
         2 001622   377770 316007                    CANQ    131064,DL
         2 001623   001644 600000 2                  TZE     s:5939

      773     5927    4           THEN DO;

      774     5928    4                B$JIT.ERR.UMID = B$JIT.ERR.UMID + CODE;

   5928  2 001624   100012 236100                    LDQ     10,,PR1
         2 001625   000022 772000                    QRL     18
         2 001626   000077 376007                    ANQ     63,DL
         2 001627   200003 036100                    ADLQ    CODE,,AUTO
         2 001630   000022 736000                    QLS     18
         2 001631   100012 752110                    STCQ    10,'10'O,PR1

      775     5929
      776     5930    4                IF (ES_LOGMONSER = %PC_ES_DENIED#) OR (ES_LOGMONSER = %PC_ES_ALL#)

   5930  2 001632   000000 235000 xsym               LDA     ES_LOGMONSER
         2 001633   000001 115007                    CMPA    1,DL
         2 001634   001637 600000 2                  TZE     s:5932
         2 001635   000003 115007                    CMPA    3,DL
         2 001636   001676 601000 2                  TNZ     SEC_LOG_EXIT

      777     5931    5                THEN DO;

      778     5932    5                     ES$MON_SRV.REASON# = %ES_MON_SRV_DENIED#;

   5932  2 001637   001000 236003                    LDQ     512,DU
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:116  
         2 001640   000000 552040 0                  STBQ    ES$MON_SRV,'40'O

      779     5933    5                     ES$MON_SRV.GRANTED# = '0'B;

   5933  2 001641   000001 236000 3                  LDQ     1
         2 001642   000000 356000 0                  ANSQ    ES$MON_SRV

      780     5934    5                     END;

   5934  2 001643   001656 710000 2                  TRA     s:5947

      781     5935    4                ELSE GOTO SEC_LOG_EXIT;
      782     5936    4                END/*do if error*/;
      783     5937
      784     5938    4           ELSE DO;

      785     5939    4                IF (ES_LOGMONSER = %PC_ES_GRANTED#) OR (ES_LOGMONSER = %PC_ES_ALL#)

   5939  2 001644   000000 235000 xsym               LDA     ES_LOGMONSER
         2 001645   000002 115007                    CMPA    2,DL
         2 001646   001651 600000 2                  TZE     s:5941
         2 001647   000003 115007                    CMPA    3,DL
         2 001650   001676 601000 2                  TNZ     SEC_LOG_EXIT

      786     5940    5                THEN DO;

      787     5941    5                     ES$MON_SRV.REASON# = %ES_MON_SRV_GRANTED#;

   5941  2 001651   002000 236003                    LDQ     1024,DU
         2 001652   000000 552040 0                  STBQ    ES$MON_SRV,'40'O

      788     5942    5                     ES$MON_SRV.GRANTED# = '1'B;

   5942  2 001653   000400 236003                    LDQ     256,DU
         2 001654   000000 256000 0                  ORSQ    ES$MON_SRV

      789     5943    5                     END;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:117  

   5943  2 001655   001656 710000 2                  TRA     s:5947

      790     5944    4                ELSE GOTO SEC_LOG_EXIT;
      791     5945    4                END/* do if no err - priv granted*/;
      792     5946
      793     5947    3           CALL ELA$SYSLOG(%EL_MON_SRV, ES$MON_SRV,

   5947  2 001656   000003 630400 3                  EPPR0   3
         2 001657   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001660   000000 701000 xent               TSX1    ELA$SYSLOG
         2 001661   001663 702000 2                  TSX2    s:5953
         2 001662   001663 710000 2                  TRA     s:5953

      794     5948    3             SIZEW(ES$MON_SRV),'0'B,%EL_SEC, TEMP)
      795     5949    4           WHENALTRETURN DO;

      796     5950
      797     5951    4                END;

      798     5952
      799     5953    3           END/*if this PMME bit in ES_MONSERTBL and not PC_ES_NONE#*/;

   5953  2 001663   001676 710000 2                  TRA     SEC_LOG_EXIT

      800     5954
      801     5955    2      ELSE IF B$JIT.ERR.CODE ~= 0

   5955  2 001664   000000 470400 xsym               LDP0    B$JIT$
         2 001665   000012 236100                    LDQ     10,,PR0
         2 001666   377770 316007                    CANQ    131064,DL
         2 001667   001676 600000 2                  TZE     SEC_LOG_EXIT

      802     5956    2           THEN B$JIT.ERR.UMID = B$JIT.ERR.UMID + CODE;

   5956  2 001670   000012 236100                    LDQ     10,,PR0
         2 001671   000022 772000                    QRL     18
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:118  
         2 001672   000077 376007                    ANQ     63,DL
         2 001673   200003 036100                    ADLQ    CODE,,AUTO
         2 001674   000022 736000                    QLS     18
         2 001675   000012 752110                    STCQ    10,'10'O,PR0

   5955  2 001676                       SEC_LOG_EXIT null
      803     5957
      804     5958    2   SEC_LOG_EXIT: ;
      805     5959    2      IF B$JIT.ERR.CODE = 0

   5959  2 001676   000000 470400 xsym               LDP0    B$JIT$
         2 001677   000012 236100                    LDQ     10,,PR0
         2 001700   377770 316007                    CANQ    131064,DL
         2 001701   001704 601000 2                  TNZ     s:5961

      806     5960    2      THEN RETURN;

   5960  2 001702   200010 221300                    LDX1  ! VPNO+1,,AUTO
         2 001703   000001 702211                    TSX2  ! 1,X1

      807     5961    2      ELSE ALTRETURN;

   5961  2 001704   200010 221300                    LDX1  ! VPNO+1,,AUTO
         2 001705   000000 702211                    TSX2  ! 0,X1

      808     5962
      809     5963    2   END SEC_LOG;
      810     5964        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:119  
      811     5965        /*E*   ERROR: -E$OLDPMME-E
      812     5966               MESSAGE: That Service Request is no longer supported by CP-6.
      813     5967        */
      814     5968
      815     5969        /*E*   ERROR: PHA-E$OLDPMME-E
      816     5970             MESSAGE: M$SSTATE, M$XSTATE, M$GETSTATE and M$FEPDATA are no longer supported.
      817     5971        */
      818     5972
      819     5973
      820     5974
      821     5975
      822     5976        /*E*     ERROR:    -E$BADDCB#-E
      823     5977                 MESSAGE: DCB# in your FPT is bad.
      824     5978        */
      825     5979        /*E*   ERROR:  UDA-E$BADDCB#-E
      826     5980               MESSAGE: DCB# in your FPT is bad.
      827     5981        */
      828     5982
      829     5983
      830     5984
      831     5985        /*E*     ERROR:  UDA-E$OPTPMME-E
      832     5986                 MESSAGE: System does not include Service Request.
      833     5987        */
      834     5988
      835     5989
      836     5990
      837     5991        /*E*     ERROR:  UDA-E$BADCODE-E
      838     5992                 MESSAGE: Undefined Service Request.
      839     5993                 DESCRIPTION:  The value in X0 on entry to the PMME
      840     5994                               Handler cannot be found in UD_MAXTAB,
      841     5995                               the table that defines the valid Service
      842     5996                               Request codes.
      843     5997        */
      844     5998        /*E*     ERROR:     -E$BADCODE-E
      845     5999                 MESSAGE: Undefined Service Request.
      846     6000        */
      847     6001
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:120  
      848     6002
      849     6003
      850     6004        /*E*     ERROR:    -E$DOMAIN-E
      851     6005                 MESSAGE: That Service Request is not permitted from your domain.
      852     6006        */
      853     6007        /*E*   ERROR:   UDA-E$DOMAIN-E
      854     6008               MESSAGE: That Service Request is not permitted from your domain.
      855     6009        */
      856     6010
      857     6011        /*E*  ERROR: -E$MODE-E
      858     6012              MESSAGE:  That Service Request is not permitted for your user mode.
      859     6013        */
      860     6014
      861     6015
      862     6016        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:121  
      863     6017        /*E*     ERROR:    -E$NOTAUTH-E
      864     6018                 MESSAGE: You are not permitted to use that Service Request.
      865     6019        */
      866     6020
      867     6021
      868     6022                                           /* TD security violation error messages    */
      869     6023
      870     6024
      871     6025        /*E*     ERROR:    TDA-E$NOTAUTH-E
      872     6026                 MESSAGE: M$RDSYSLOG users must run in the system account.
      873     6027        */
      874     6028        /*E*     ERROR:    TDB-E$NOTAUTH-E
      875     6029                 MESSAGE: M$WRSYSLOG requires TND, SYSLOG or SYSCON privilege.
      876     6030                 DESCRIPTION: Special shared processors may also use M$WRSYSLOG.
      877     6031        */
      878     6032        /*E*     ERROR:    TDC-E$NOTAUTH-E
      879     6033                 MESSAGE: M$TDOPEN requires TND privilege.
      880     6034        */
      881     6035        /*E*     ERROR:    TDD-E$NOTAUTH-E
      882     6036                 MESSAGE: M$TDCLOSE requires TND privilege.
      883     6037        */
      884     6038        /*E*     ERROR:    TDE-E$NOTAUTH-E
      885     6039                 MESSAGE: M$TDIO requires TND privilege.
      886     6040        */
      887     6041        /*E*     ERROR:    TDF-E$NOTAUTH-E
      888     6042                 MESSAGE: M$TDREQCPU requires TND privilege.
      889     6043        */
      890     6044        /*E*     ERROR:    TDG-E$NOTAUTH-E
      891     6045                 MESSAGE: M$IOQ users must run with the IOQ privilege on.
      892     6046        */
      893     6047        /*E*    ERROR:      TDH-E$NOTAUTH
      894     6048                MESSAGE: You do not have the privilege to use the M$SYSCON service.
      895     6049                MESSAGE1: The PR_SYSCON privilege is required to partition or
      896     6050                          return components.  PR_TND or PR_SPCLMM or PR_EXMM
      897     6051                          is required to display the status of a component.
      898     6052                MESSAGE7: You do not have the privilege to use the M$SYSCON service.
      899     6053        */
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:122  
      900     6054        /*E*    ERROR:    TDI-E$NOTAUTH-E
      901     6055                MESSAGE:  M$MIRROR requires IOQ and IOQW privileges.
      902     6056        */
      903     6057
      904     6058        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:123  
      905     6059                                           /* OC security violation error messages    */
      906     6060        /*E* ERROR: OCB-E$DOMAIN-E
      907     6061             MESSAGE: M$OCMSG may only be used by a command processor or debugger.
      908     6062        */
      909     6063
      910     6064
      911     6065
      912     6066
      913     6067                                           /* UM security violation error messages    */
      914     6068
      915     6069        /*E*     ERROR:    UMQ-E$NOTAUTH-E
      916     6070                 MESSAGE: M$RUE users must run in :SYS or have MSYS privilege on.
      917     6071        */
      918     6072
      919     6073
      920     6074
      921     6075
      922     6076                                           /* JS security violation error messages    */
      923     6077
      924     6078        /*E*     ERROR:  JSL-E$NOTAUTH-E
      925     6079                 MESSAGE: M$SCREECH users must have EXMM privilege on.
      926     6080                 DESCRIPTION: User programs (except System Ghosts) must
      927     6081                              have EXMM privilege to use M$SCREECH.
      928     6082        */
      929     6083
      930     6084
      931     6085
      932     6086
      933     6087                                           /* FR security violation error messages    */
      934     6088
      935     6089        /*E* ERROR: FRA-E$DOMAIN-E
      936     6090             MESSAGE: M$LIMIT may only be used by a command processor.
      937     6091        */
      938     6092        /*E* ERROR: FRB-E$DOMAIN-E
      939     6093             MESSAGE: M$MBS is not available to user programs.
      940     6094             MESSAGE1: Only System Ghosts and CPs may use M$MBS, and except
      941     6095                       MBS, may only do the display form of the PMME.
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:124  
      942     6096             MESSAGE7: M$MBS is not available to user programs.
      943     6097        */
      944     6098        /*E* ERROR: FRF-E$DOMAIN-E
      945     6099             MESSAGE: M$RACST may only be used by a command processor.
      946     6100        */
      947     6101        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:125  
      948     6102                                           /* MM security violation error messages    */
      949     6103
      950     6104        /*E* ERROR: MMH-E$MMPRIV-E
      951     6105             MESSAGE: M$STLPP users must have EXMM privilege on.
      952     6106        */
      953     6107        /*E* ERROR: MMI-E$MMPRIV-E
      954     6108             MESSAGE: M$RSPP users must have EXMM privilege on.
      955     6109        */
      956     6110        /*E* ERROR: MMJ-E$MMPRIV-E
      957     6111             MESSAGE0: M$CVM users must have EXMM or SPCLMM privilege on.
      958     6112        MESSAGE1: Using M$CVM to map into your Instruction Segment requires SPCLMM privileg
              6112        e.
      959     6113             MESSAGE2: Using M$CVM to map relative to your WSQ requires EXMM privilege.
      960     6114             MESSAGE7: M$CVM users must have EXMM or SPCLMM privilege on.
      961     6115        */
      962     6116        /*E* ERROR: MMK-E$MMPRIV-E
      963     6117             MESSAGE: WSQFLG may not be used with M$SMPRT without EXMM privilege.
      964     6118        */
      965     6119        /*E* ERROR: MML-E$MMPRIV-E
      966     6120             MESSAGE: M$SSC users must have EXMM privilege on.
      967     6121             DESCRIPTION: The debugger domain may also use M$SSC.
      968     6122        */
      969     6123        /*E* ERROR: MMN-E$MMPRIV-E
      970     6124             MESSAGE: M$SAD users must have EXMM or SPCLMM privilege on.
      971     6125        */
      972     6126        /*E* ERROR: MMP-E$MMPRIV-E
      973     6127             MESSAGE: M$BADPP users must have TND or SYSCON privilege on.
      974     6128        */
      975     6129        /*E* ERROR: MMQ-E$MMPRIV-E
      976     6130             MESSAGE: M$GOODPP users must have TND or SYSCON privilege on.
      977     6131        */
      978     6132        /*E* ERROR: MMR-E$MMPRIV-E
      979     6133             MESSAGE: M$GBPL users must have TND or SYSCON privilege on.
      980     6134        */
      981     6135        /*E* ERROR: MMS-E$MMPRIV-E
      982     6136             MESSAGE: M$MPL users must have TND or SYSCON privilege on.
      983     6137        */
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:126  
      984     6138        /*E* ERROR: MMT-E$MMPRIV-E
      985     6139             MESSAGE: M$UMPL users must have TND or SYSCON privilege on.
      986     6140        */
      987     6141
      988     6142        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:127  
      989     6143                                           /* PH security violation error messages    */
      990     6144
      991     6145        /*E* ERROR: PHD-E$NOTAUTH-E
      992     6146             MESSAGE: M$SMOUSE users must have EXPM privilege on.
      993     6147        */
      994     6148        /*E* ERROR: PHE-E$NOTAUTH-E
      995     6149             MESSAGE: M$XMOUSE users must have EXPM privilege on.
      996     6150        */
      997     6151        /*E* ERROR: PHF-E$NOTAUTH-E
      998     6152             MESSAGE: M$GETMOUSE users must have PM privilege on.
      999     6153        */
     1000     6154        /*E* ERROR: PHG-E$NOTAUTH-E
     1001     6155             MESSAGE: M$GETPM users must have PM privilege on.
     1002     6156        */
     1003     6157        %EJECT;
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:128  
     1004     6158                                           /* KI security violation error messages    */
     1005     6159
     1006     6160        /*E* ERROR: KIN-E$NOTAUTH-E
     1007     6161             MESSAGE: M$FEBOOT users must have MFEP privilege on.
     1008     6162        */
     1009     6163        /*E* ERROR: KIO-E$NOTAUTH-E
     1010     6164             MESSAGE: M$FEDUMP users must have MFEP privilege on.
     1011     6165        */
     1012     6166        /*E* ERROR: KIP-E$NOTAUTH-E
     1013     6167             MESSAGE: M$FECTL users must have MFEP privilege on.
     1014     6168        */
     1015     6169    1   END UDA$PMMENT;

   6169  2 001706   000000 702200 xent               TSX2  ! X66_ARET

ES$MON_SRV
 Sect OctLoc
   0     000   000000 000000   000000 000000   000000 000000                    ............

MM_PRIV
 Sect OctLoc
   0     004   151501 011444                                                    i...

TD_PRIV
 Sect OctLoc
   0     005   240401 006254                                                    ....

PH_PRIV
 Sect OctLoc
   0     006   201001 006254                                                    ....

KI_PRIV
 Sect OctLoc
   0     007   131101 006254                                                    YA..

OC_PRIV
 Sect OctLoc
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:129  
   0     010   170301 006264                                                    x...

UM_PRIV
 Sect OctLoc
   0     011   251501 006254                                                    ....

JS_PRIV
 Sect OctLoc
   0     012   122301 006254                                                    R...

FR_PRIV
 Sect OctLoc
   0     013   062201 006264                                                    2...

EBADDCB
 Sect OctLoc
   0     014   250401 006244                                                    ....

EOPTPMME
 Sect OctLoc
   0     015   250401 006234                                                    ....

EBADCODE
 Sect OctLoc
   0     016   250401 006204                                                    ....

(unnamed)
 Sect OctLoc
   0     017   250401 006264                                                    ....

EOLDPMME
 Sect OctLoc
   0     020   201001 006214                                                    ....

MM_PRIVS
 Sect OctLoc
   1     000   000000 000002   000000 000002   000000 000003   000000 000002    ................
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:130  
   1     004   000000 000002   000000 000000   000000 000003   000000 000000    ................
   1     010   000002 000100   000002 000100   000002 000100   000002 000100    ...@...@...@...@
   1     014   000002 000100                                                    ...@

TD_PRIVS
 Sect OctLoc
   1     015   004000 000000   000002 100100   000000 000100   000000 000100    ......@@...@...@
   1     021   000000 000100   000000 000100   000000 001000   000002 000000    ...@...@........
   1     025   000000 003000                                                    ....

PH_PRIVS
 Sect OctLoc
   1     026   000000 000400   000000 000400   000000 000200   000000 000200    ................

(unnamed)
 Sect OctLoc
   1     032   002000 000000   040000 000000   000000 000100   000000 040000    .... ......@.. .

(unnamed)
 Sect OctLoc
   3     000   000002 006000   777377 777777   000000 000767   000002 006000    ................
   3     004   000000 006000   000005 006000   000002 006000   000005 006000    ................
   3     010   000003 006000                                                    ....

PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:131  
--  Include file information  --

   UM_CP6.:E05TOU  is referenced.
   UD_EQU_E.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   TD$CP6V_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   MM$CP6V_C.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   M_ERRORS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   HF_ERRORS_C.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_MAGIC_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure UDA$PMMENT.
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:132  

 **** Variables and constants ****

  ****  Section 000  Data  UDA$PMMENT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/w STRC        r     1 EBADCODE                  14-0-0/w STRC        r     1 EBADDCB
    20-0-0/w STRC        r     1 EOLDPMME                  15-0-0/w STRC        r     1 EOPTPMME
     0-0-0/w STRC(108)   r     1 ES$MON_SRV                13-0-0/w STRC        r     1 FR_PRIV
    12-0-0/w STRC        r     1 JS_PRIV                    7-0-0/w STRC        r     1 KI_PRIV
     4-0-0/w STRC        r     1 MM_PRIV                   10-0-0/w STRC        r     1 OC_PRIV
     6-0-0/w STRC        r     1 PH_PRIV                    5-0-0/w STRC        r     1 TD_PRIV
     3-0-0/b BIT         r     1 TEMP                      11-0-0/w STRC        r     1 UM_PRIV

  ****  Section 001 RoData UDA$PMMENT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 MM_PRIVS(0:12)
    26-0-0/b BIT         r     1 PH_PRIVS(0:3)
    15-0-0/b BIT         r     1 TD_PRIVS(0:8)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w SBIN        r     1 CODE                       5-0-0/w UBIN        r     1 DOMAIN#
     7-0-0/w BIT         r     1 ERR                        6-0-0/w UBIN        r     1 ES_INDX
     4-0-0/w UBIN        r     1 FCG                        7-0-0/w UBIN        r     1 VPNO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:133  

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$ROSEG$                   0-0-0/d STRC(432)   r     1 B_MPT
     0-0-0/w UBIN        r     1 ES_LOGMONSER
     0-0-0/w BIT         r     1 ES_MONSERTBL(0:15)
     0-0-0/c CHAR(8)     r     1 J_SYSTXT                   0-0-0/w SBIN        r     1 PH_MOUSE_USERS
     0-0-0/w SBIN        r     1 P_CALCNT(0:3)
     0-0-0/w SBIN        r     1 P_CALCOMP(0:3)
     0-0-0/w SBIN        r     1 S_CUN                      0-0-0/w SBIN        r     1 S_INCTIME
     0-0-0/w SBIN        r     1 S_MING                     0-0-0/w UBIN        r     1 S_PNO
     0-0-0/w UBIN        r     1 S_TIMR
     0-0-0/w SBIN        r     1 UD_MAXTAB(0:15)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DCB$TAB(0:15)
     0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/b BIT         r     1 B$MONSER(0:35)
     0-0-0/d STRC(3024)  r     1 B$ROSEG                    0-0-0/d STRC(2304)  r     1 B$SS
     0-0-0/w UBIN(18)    r     1 DCB#                       0-0-0/d STRC(108)   r     1 FPT$CVM_V
     0-0-0/d STRC(216)   r     1 FPT$RESCTL_V               0-0-0/d STRC(72)    r     1 FPT$SMPRT_V
     0-0-0/d STRC(118)   r     1 FPT$SYSCON_V


   Procedure UDA$PMMENT requires 967 words for executable code.
   Procedure UDA$PMMENT requires 12 words of local(AUTO) storage.

    No errors detected in file UDA$PMMENT.:E05TSI    .
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:134  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:135  
          MINI XREF LISTING

AFA$ACCT
      4530**DCL-ENT  5481--CALL
B$DCB$TAB
      4728**DCL      5420>>ASSIGN   5907>>ASSIGN
B$JIT.ACCN
       518**DCL      5538>>IF       5693>>IF
B$JIT.CALCNT
       692**DCL      5400<<ASSIGN   5400>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       612**DCL       612--REDEF
B$JIT.DCB$
       686**DCL      5420<<ASSIGN   5421>>IF       5443<<ASSIGN   5907<<ASSIGN   5908>>IF
B$JIT.DCBNO
       599**DCL      5419<<ASSIGN   5444<<ASSIGN   5906<<ASSIGN
B$JIT.ERR
       518**DCL      5412<<ASSIGN   5432<<ASSIGN   5438<<ASSIGN   5442<<ASSIGN   5465<<ASSIGN   5540<<ASSIGN
      5607<<ASSIGN   5669>>ASSIGN   5671<<ASSIGN   5674<<ASSIGN   5714<<ASSIGN   5746<<ASSIGN   5766<<ASSIGN
      5774<<ASSIGN   5813<<ASSIGN   5836<<ASSIGN   5874>>IF       5883>>IF       5897<<ASSIGN
B$JIT.ERR.CODE
       519**DCL      5670>>IF       5926>>IF       5955>>IF       5959>>IF
B$JIT.ERR.MID
       519**DCL       519--REDEF
B$JIT.ERR.UMID
       519**DCL      5928<<ASSIGN   5928>>ASSIGN   5956<<ASSIGN   5956>>ASSIGN
B$JIT.JRESPEAK
       680**DCL       681--REDEF
B$JIT.JUNK
       718**DCL      5874>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       789**DCL       789--REDEF     790--REDEF
B$JIT.PNR
       693**DCL       693--REDEF
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:136  
B$JIT.PRIV.ACTIVE
       519**DCL      5464>>IF       5538>>IF       5574>>IF       5583>>IF       5587>>IF       5604>>IF
      5704>>IF       5712>>IF       5743>>IF       5772>>IF       5834>>IF
B$JIT.SYSID
       518**DCL      5801>>IF       5804>>IF
B$JIT.TSLINE
       787**DCL       788--REDEF
B$JIT.XTIME
       691**DCL      5397<<ASSIGN   5397>>ASSIGN
B$JIT$
      4615**DCL       513--IMP-PTR  5397>>ASSIGN   5397>>ASSIGN   5400>>ASSIGN   5400>>ASSIGN   5412>>ASSIGN
      5419>>ASSIGN   5420>>ASSIGN   5421>>IF       5432>>ASSIGN   5438>>ASSIGN   5442>>ASSIGN   5443>>ASSIGN
      5444>>ASSIGN   5464>>IF       5465>>ASSIGN   5538>>IF       5538>>IF       5540>>ASSIGN   5574>>IF
      5583>>IF       5587>>IF       5604>>IF       5607>>ASSIGN   5669>>ASSIGN   5670>>IF       5671>>ASSIGN
      5674>>ASSIGN   5693>>IF       5704>>IF       5712>>IF       5714>>ASSIGN   5743>>IF       5746>>ASSIGN
      5766>>ASSIGN   5772>>IF       5774>>ASSIGN   5801>>IF       5804>>IF       5813>>ASSIGN   5834>>IF
      5836>>ASSIGN   5874>>IF       5874>>IF       5883>>IF       5897>>ASSIGN   5906>>ASSIGN   5907>>ASSIGN
      5908>>IF       5926>>IF       5928>>ASSIGN   5928>>ASSIGN   5955>>IF       5956>>ASSIGN   5956>>ASSIGN
      5959>>IF
B$MONSER IN PROCEDURE SEC_LOG
      5918**DCL      5921>>IF
B$PS0$
      4616**DCL      5416>>IF       5419>>ASSIGN   5420>>ASSIGN   5574>>IF       5583>>IF       5589>>ASSIGN
      5590>>IF       5704>>IF       5803>>IF       5892>>IF       5903>>IF       5906>>ASSIGN   5907>>ASSIGN
B$ROSEG.DCBPTR$
       805**DCL      5420>>ASSIGN   5907>>ASSIGN
B$ROSEG.NUMDCBS
       807**DCL      5416>>IF       5903>>IF
B$ROSEG$
      4614**DCL      5416>>IF       5420>>ASSIGN   5903>>IF       5907>>ASSIGN
B$SS.FPT
        23**DCL      5924>>ASSIGN
B$SS.FPT.CODE
        26**DCL      5407>>ASSIGN
B$SS.FPT.FCG
        25**DCL      5408>>ASSIGN
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:137  
B$SS.ISR.WSR
        69**DCL      5446>>ASSIGN   5460>>IF       5598>>IF       5696>>IF       5743>>IF
B$SS.RVA
        64**DCL        65--REDEF
BADDCB
      5897**LABEL    5622--CALLALT  5721--CALLALT  5728--CALLALT  5848--CALLALT  5859--CALLALT
BADX0
      5429**LABEL    5414--GOTO     5454--GOTO     5866--GOTO
B_MPT.AS
      4654**DCL      4657--REDEF
B_MPT.ASDESC
      4686**DCL      4690--REDEF
B_MPT.ECCB
      4669**DCL      4672--REDEF
B_MPT.ECCBDESC
      4704**DCL      4708--REDEF
B_MPT.LS
      4649**DCL      4652--REDEF
B_MPT.LSDESC
      4680**DCL      4684--REDEF
B_MPT.PS
      4659**DCL      4662--REDEF
B_MPT.PSDESC
      4692**DCL      4696--REDEF
B_MPT.SS
      4644**DCL      4647--REDEF
B_MPT.SS$
      4647**DCL      5407>>ASSIGN   5408>>ASSIGN   5446>>ASSIGN   5460>>IF       5598>>IF       5696>>IF
      5743>>IF       5924>>ASSIGN
B_MPT.SSDESC
      4674**DCL      4678--REDEF
B_MPT.TCB
      4664**DCL      4667--REDEF
B_MPT.TCBDESC
      4698**DCL      4702--REDEF
CALL_FR
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:138  
      5804**LABEL    5805--GOTO     5807--GOTO
CALL_MM
      5604**LABEL    5595--GOTO     5601--GOTO
CALL_TD
      5712**LABEL    5694--GOTO     5699--GOTO     5708--GOTO
CHECK_DCB
      5902**PROC     5622--CALL     5721--CALL     5728--CALL     5848--CALL     5859--CALL
CODE
      4503**DCL      4504--REDEF    5407<<ASSIGN   5413>>IF       5424<>CALL     5429>>IF       5452>>DOCASE
      5470<>CALL     5484<>CALL     5488<>CALL     5492>>DOCASE   5568>>IF       5568>>IF       5568>>IF
      5568>>IF       5571>>ASSIGN   5574>>IF       5581>>IF       5598>>IF       5616<>CALL     5623>>DOCASE
      5648>>DOCASE   5691>>ASSIGN   5693>>IF       5696>>IF       5702>>IF       5712>>IF       5720>>IF
      5720>>IF       5720>>IF       5723<>CALL     5729<>CALL     5733<>CALL     5737>>DOCASE   5750<>CALL
      5756>>DOCASE   5765>>IF       5765>>IF       5769>>ASSIGN   5779>>DOCASE   5799>>IF       5799>>IF
      5799>>IF       5801>>IF       5820<>CALL     5825>>DOCASE   5841<>CALL     5845<>CALL     5849>>IF
      5851<>CALL     5857>>DOCASE   5860<>CALL     5892>>IF       5921>>IF       5928>>ASSIGN   5956>>ASSIGN
DCB#
      4729**DCL      5416>>IF       5419>>ASSIGN   5420>>ASSIGN   5892>>IF       5903>>IF       5906>>ASSIGN
      5907>>ASSIGN
DOMAIN#
      4507**DCL      5446<<ASSIGN   5498<>CALL     5500<>CALL     5552<>CALL     5614>>IF       5614<<ASSIGN
      5615>>IF       5615<<ASSIGN   5616<>CALL     5810>>IF
EBADCODE
      5256**DCL      5432>>ASSIGN
EBADDCB
      5166**DCL      5897>>ASSIGN
ELA$SYSLOG
      4531**DCL-ENT  5947--CALL
EMH$HELP
      4532**DCL-ENT  5558--CALL
EMR$ERRMSG
      4533**DCL-ENT  5494--CALL
EOLDPMME
      5346**DCL      5766>>ASSIGN
EOPTPMME
      5211**DCL      5438>>ASSIGN
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:139  
ERR
      4510**DCL      5669<<ASSIGN   5674>>ASSIGN
ERR_MM
      5604**LABEL    5578--GOTO     5585--GOTO     5592--GOTO
ES$MON_SRV
      4522**DCL      5947<>CALL     5947--CALL
ES$MON_SRV.GRANTED#
      4522**DCL      5933<<ASSIGN   5942<<ASSIGN
ES$MON_SRV.PMME_TYPE#
      4523**DCL      5924<<ASSIGN
ES$MON_SRV.PRIV#
      4524**DCL      5462<<ASSIGN   5537<<ASSIGN   5572<<ASSIGN   5577<<ASSIGN   5600<<ASSIGN   5667<<ASSIGN
      5691<<ASSIGN   5698<<ASSIGN   5707<<ASSIGN   5742<<ASSIGN   5770<<ASSIGN   5797<<ASSIGN   5832<<ASSIGN
ES$MON_SRV.REASON#
      4522**DCL      5932<<ASSIGN   5941<<ASSIGN
ES_INDX
      4508**DCL      5571<<ASSIGN   5572>>ASSIGN   5604>>IF       5769<<ASSIGN   5770>>ASSIGN   5772>>IF
ES_LOGMONSER
      4712**DCL      5921>>IF       5930>>IF       5930>>IF       5939>>IF       5939>>IF
ES_MONSERTBL
      4713**DCL      5921--IF
FCG
      4505**DCL      4506--REDEF    5408<<ASSIGN   5410>>IF       5429>>IF       5429>>IF       5436>>IF
      5449>>DOCASE   5921>>IF
FM1_BADDCB
      5883**LABEL    5417--GOTO     5422--GOTO
FMF$CHECK
      4534**DCL-ENT  5631--CALL
FMF$CORRES
      4535**DCL-ENT  5650--CALL
FMF$PMME
      4536**DCL-ENT  5424--CALL
FMF$SETFMA
      4537**DCL-ENT  5653--CALL
FMF$TRUNC
      4538**DCL-ENT  5634--CALL
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:140  
FMM$GETDCB
      4539**DCL-ENT  5656--CALL
FMM$OPN
      4540**DCL-ENT  5625--CALL
FMM$RELDCB
      4541**DCL-ENT  5659--CALL
FMN$MADMUCK
      4542**DCL-ENT  5665--CALL
FMP$CLS
      4543**DCL-ENT  5628--CALL
FMQ$RELSTARFP
      4544**DCL-ENT  5683--CALL
FOM$PMME
      4545**DCL-ENT  5860--CALL
FOS$PMME
      4546**DCL-ENT  5862--CALL
FPT$CVM_V.WSQFLG
      4732**DCL      5574>>IF
FPT$RESCTL_V.MBSDISP
      4736**DCL      5803>>IF
FPT$SMPRT_V.NUMPGS
      4739**DCL      5590>>IF
FPT$SMPRT_V.VPNO
      4739**DCL      5589>>ASSIGN
FPT$SMPRT_V.WSQFLG
      4739**DCL      5583>>IF
FPT$SYSCON_V.FUNCTION
      4742**DCL      5704>>IF
FPT$SYSCON_V.IOM
      4742**DCL      4742--REDEF    4742--REDEF
FRP$PMME
      4547**DCL-ENT  5820--CALL
FR_PRIV
      5120**DCL      5813>>ASSIGN
FSD$XFLUSH
      4548**DCL-ENT  5680--CALL
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:141  
FSL$LDEV
      4549**DCL-ENT  5662--CALL
FSM$DEVICE
      4550**DCL-ENT  5643--CALL
FSM$LINES
      4551**DCL-ENT  5640--CALL
FTC$REM
      4552**DCL-ENT  5677--CALL
FTC$REW
      4553**DCL-ENT  5894--CALL
FTW$CVOL
      4554**DCL-ENT  5637--CALL
JGP$PMME
      4555**DCL-ENT  5552--CALL
JSE$EXITS
      4557**DCL-ENT  5457--CALL
JSP$PMME
      4558**DCL-ENT  5470--CALL     5484--CALL
JS_PRIV
      5075**DCL      5465>>ASSIGN
JZD$ASUSER
      4560**DCL-ENT  5476--CALL
JZD$DSUSER
      4561**DCL-ENT  5478--CALL
JZD$FSUSER
      4562**DCL-ENT  5474--CALL
J_SYSTXT
      4716**DCL      5538>>IF       5693>>IF
KCP$PMME
      4563**DCL-ENT  5729--CALL
KIC$CONFIG
      4564**DCL-ENT  5829--CALL
KIF$FPRG
      4565**DCL-ENT  5850--CALL
KIP$CPMME
      4566**DCL-ENT  5841--CALL     5845--CALL
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:142  
KIP$PMME
      4567**DCL-ENT  5851--CALL
KI_PRIV
      4940**DCL      5836>>ASSIGN
KLM$EXHUME
      4568**DCL-ENT  5760--CALL
KLM$PATHCON
      4569**DCL-ENT  5758--CALL
MMP$PMME
      4570**DCL-ENT  5616--CALL
MM_PRIV
      4805**DCL      5607>>ASSIGN
MM_PRIVS
      4750**DCL      5572>>ASSIGN   5604>>IF
NOTUPMME
      5402**LABEL    5392--GOTO
OCU$OCMSG
      4571**DCL-ENT  5750--CALL
OCU$PMME
      4572**DCL-ENT  5739--CALL
OC_PRIV
      4985**DCL      5746>>ASSIGN
OTW$PMME
      4573**DCL-ENT  5733--CALL
PHA$GETMOUSE
      4576**DCL-ENT  5785--CALL
PHA$GETPM
      4577**DCL-ENT  5787--CALL
PHA$SMOUSE
      4574**DCL-ENT  5781--CALL
PHA$XMOUSE
      4575**DCL-ENT  5783--CALL
PHP$START_PMME
      4578**DCL-ENT  5405--CALL
PH_MOUSE_USERS
      4717**DCL      5405>>IF       5874>>IF
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:143  
PH_PRIV
      4895**DCL      5774>>ASSIGN
PH_PRIVS
      4776**DCL      5770>>ASSIGN   5772>>IF
P_CALCNT
      4719**DCL      5402<<ASSIGN   5402>>ASSIGN
P_CALCOMP
      4720**DCL      5878<<ASSIGN   5878>>ASSIGN
SEC_LOG
      5916**PROC     5468--CALL     5543--CALL     5613--CALL     5673--CALL     5718--CALL     5748--CALL
      5777--CALL     5818--CALL     5839--CALL
SEC_LOG_EXIT IN PROCEDURE SEC_LOG
      5955**LABEL    5935--GOTO     5944--GOTO
SET_FR_ERR
      5804**LABEL    5806--GOTO
SKIP_MM
      5615**LABEL    5613--CALLALT
SSC$STATE
      4579**DCL-ENT  5513--CALL
SSR$MRUE
      4580**DCL-ENT  5545--CALL
SSS$BLOCK
      4583**DCL-ENT  5689--CALL     5732--CALL     5736--CALL     5755--CALL     5795--CALL     5856--CALL
S_CUN
      4721**DCL      5460>>IF       5921>>IF
S_INCTIME
      4723**DCL      5397>>ASSIGN
S_MING
      4722**DCL      5460>>IF       5921>>IF
S_PNO
      4718**DCL      5402>>ASSIGN   5402>>ASSIGN   5878>>ASSIGN   5878>>ASSIGN
S_TIMR
      4724**DCL      5398<<ASSIGN
TDP$PMME
      4585**DCL-ENT  5723--CALL
TD_PRIV
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:144  
      4850**DCL      5714>>ASSIGN
TD_PRIVS
      4765**DCL      5691>>ASSIGN   5712>>IF
TEMP
      4526**DCL      5947<>CALL
UDB$AUTOQ
      4586**DCL-ENT  5879--CALL
UDB$PMMEXIT
      4587**DCL-ENT  5433--CALL     5439--CALL     5885--CALL     5895--CALL     5898--CALL
UDB$PMMEXIT1
      4588**DCL-ENT  5884--CALL
UD_MAXTAB
      4612**DCL      5413>>IF       5429>>IF       5436>>IF
UEP$PMME
      4589**DCL-ENT  5488--CALL
UMC$CMDVAR
      4590**DCL-ENT  5561--CALL
UMD$DRIBBLE
      4591**DCL-ENT  5827--CALL
UMF$FID
      4592**DCL-ENT  5496--CALL
UMS$NXTUSR
      4581**DCL-ENT  5504--CALL
UMS$SYSID
      4582**DCL-ENT  5563--CALL
UMT$CHGUNIT
      4593**DCL-ENT  5531--CALL
UMT$MISC
      4594**DCL-ENT  5534--CALL
UMT$MONINFO
      4595**DCL-ENT  5555--CALL
UMT$RPRIV
      4596**DCL-ENT  5522--CALL
UMT$RSWITCH
      4597**DCL-ENT  5528--CALL
UMT$SPRIV
PL6.E3A0      #001=UDA$PMMENT File=UDA$PMMENT.:E05TSI                            WED 07/30/97 06:54 Page:145  
      4598**DCL-ENT  5519--CALL
UMT$SSWITCH
      4599**DCL-ENT  5525--CALL
UMT$SYSLOAD
      4600**DCL-ENT  5510--CALL
UMT$TIME
      4601**DCL-ENT  5502--CALL
UMT$WAIT
      4602**DCL-ENT  5507--CALL
UMT$XEQTIME
      4603**DCL-ENT  5516--CALL
UMU$UNFID
      4604**DCL-ENT  5549--CALL
UM_PRIV
      5030**DCL      5540>>ASSIGN
UQB$UDEQ
      4605**DCL-ENT  5500--CALL
UQB$UENQ
      4606**DCL-ENT  5498--CALL
VPNO
      4509**DCL      4510--REDEF    5589<<ASSIGN   5590>>IF       5590>>IF       5590>>IF
