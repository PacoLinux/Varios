VERSION E05

PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:1    
        1        1        /*M* QBC$CLOSE:  Close DCBs for FORM and/or TRANSACTION files.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBC$CLOSE
       10       10              PURPOSE:      Close DCBs for FORM and/or TRANSACTION files.
       11       11              DESCRIPTION:  Execute a CLOSE op-code, whose argument
       12       12                            may be a file or a list of files (of any type).
       13       13        */
       14       14
       15       15        QBC$CLOSE: PROC;
       16       16
       17       17        /*D*  NAME:         QBC$CLOSE
       18       18              CALL:         CALL QBC$CLOSE;
       19       19              PARAMETERS:   None.
       20       20              INTERFACE:    Called by QAT$TALLYHO when an CLOSE op-code
       21       21                            is encountered.
       22       22                            Calls M$CLOSE.
       23       23              ENVIRONMENT:  Nothing unusual.
       24       24              INPUT:        QI_1,
       25       25                            FPL rununit static data following the op-code.
       26       26              OUTPUT:       Resets all kinds of flags,
       27       27                            does the same thing as DEACTIVATE if that's not
       28       28                            already done.
       29       29              SCRATCH:      Various otter data.
       30       30              DESCRIPTION:  The arguments may be files of either type FORM or
       31       31                            TRANSACTION, or a combination.
       32       32                            Delink the FD from the appropriate open chain
       33       33                            and call M$CLOSE with the right stuff.  For FORMs,
       34       34                            if a DEACTIVATE statement wasn't ever executed for
       35       35                            the fields within the FORM in question, then the
       36       36                            dynamic memory has to be marked dead and stuff.
       37       37        */
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:2    
       38       38
       39       39          %INCLUDE LCP_6;
       40      230          %FPT_CLOSE ( FPTN = FPT@CLOSE,
       41      231                       STCLASS = AUTO );
       42      251
       43      252          %INCLUDE QG_MACRO_M;
       44      389          %QGB_ENTRIES;
       45      402          %INCLUDE QI_EQUATES_E;
       46      761          %INCLUDE QI_PERR_C;
       47      929          %INCLUDE QI_MACROS_M;
       48     5987          %QI$ALL;
       49    17100          %QI_FPTS;
       50    19145
       51    19146    1     DCL ERROR_STATUS$ PTR;
       52    19147    1     DCL FILE_COUNT UBIN;
       53    19148    1     DCL FILE_INDEX UBIN;
       54    19149    1     DCL FILE_LINK$ PTR;
       55    19150    1     DCL FILE_STATUS$ PTR;
       56    19151    1     DCL INSTR$ PTR;
       57    19152    1     DCL TYPE_INDEX UBIN;
       58    19153
       59    19154    1     DCL QBA$DEACTIVATE_FORM ENTRY ALTRET;
       60    19155    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
       61    19156    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
       62    19157    1     DCL QCU$UPDATE_SCREEN ENTRY;
       63    19158    1     DCL QCU$USE_IO ENTRY (1);
       64    19159
       65    19160          %SET LISTMAC = '1'B;
       66    19161
       67    19162          %INCLUDE QCU_USE_M;
       68    19216          %QCU@USE;
             19217            %BEGIN_MACRO;
             19218            %SET LISTDIR = '0'B;
             19231    1     DCL 1 QCU@USE AUTO ALIGNED,
             19232    1           2 CURR_FRAME$ PTR,
             19233                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             19234    1           2 CURR_NODE$ PTR,
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:3    
             19235                          /* Pointer to current node or ADDR (NIL).  */
             19236    1           2 USE_DEFAULT_IO UBIN,
             19237                          /* For USE procedures which default applies
             19238                             (see corresponding EQUs).  */
             19239    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             19240                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             19241                             save the fields within the bounds of
             19242                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             19243                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             19244                             before calling the USE procedure.  */
             19245    1           2 FRAME_START_INDEX UBIN,
             19246                          /* Foist frame of the CURRENT.FORM$
             19247                             involved with the I-O error.  */
             19248    1           2 FRAME_STOP_INDEX UBIN,
             19249                          /* Larst frame of the CURRENT.FORM$
             19250                             involved with the I-O error.  */
             19251    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19252                          /* If IS_FIELD_INDEXES_VALID, use them;
             19253                             else use all the fields in the frame.  */
             19254    1           2 FIELD_START_INDEX UBIN,
             19255                          /* Starting index into QI$GZ_FIELD
             19256                             which may have values "pushed".  */
             19257    1           2 FIELD_STOP_INDEX UBIN,
             19258                          /* Stopping index into QI$GZ_FIELD
             19259                             which may have values "pushed".  */
             19260    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19261                          /* If IS_CURSOR_POSITION_VALID, use it;
             19262                             else allow cursor to default to upper-left-most field.  */
             19263    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19264                          /* POSition of the field on which to place the cursor.  */
             19265    1           2 STATUS UBIN;
             19266                          /* Returned action code; see corresponding EQUs.  */
             19273            %ENDIF;
       69    19276
       70    19277          %SET LISTMAC = '0'B;
       71    19278        %EJECT;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:4    
       72    19279    1       INSTR$ = QI_1.INSTR$;
       73    19280    1       FILE_COUNT = INSTR$ -> QI$OP_CLOSE.FILE_COUNT;
       74    19281    1       QI_1.INSTR$ = PINCRW ( INSTR$, ( FILE_COUNT * 2 ) + 2 );
       75    19282
       76    19283    1       IF QI_1.SCREEN_UPDATE_FLAGS.WAS_APPLIED
       77    19284    1         OR QI_1.SCREEN_UPDATE_FLAGS.WAS_WRITTEN
       78    19285    1       THEN
       79    19286    1         CALL QCU$UPDATE_SCREEN;
       80    19287    1   CLOSE_FILES:
       81    19288    2       DO FILE_INDEX = 0 TO FILE_COUNT - 1;
       82    19289
       83    19290              %PROC_ADDRESS ( THING@P =
             19290                  "INSTR$ -> QI$OP_CLOSE.OPERAND_A.FILE@P ( FILE_INDEX )",
       84    19291              CHECK_FOR_INDIRECTION = NO,
       85    19292              RESULT$ = "QI_1.CURRENT.FILE$" );
       86    19329
       87    19330              %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FILE$ -> QI$FILE.STATUS_AREA@D",
       88    19331              CHECK_FOR_INDIRECTION = NO,
       89    19332              RESULT$ = "QI_1.CURRENT.FILE_STATUS$" );
       90    19369
       91    19370    2   RETRY_STATUS_FLAGS:
       92    19371    2         IF NOT QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.
             19371                  IS_INPUT
       93    19372    2           AND NOT QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.
             19372                    IS_OUTPUT
       94    19373    2         THEN
       95    19374    3           DO;
       96    19375    3             QI_1.ERROR_STATUS = %E$FILE_ALREADY_CLOSED;
       97    19376    3             GOTO CHECK_FOR_USE_PROCEDURE;
       98    19377    3           END;
       99    19378
      100    19379    3         DO CASE ( QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE );
      101    19380
      102    19381    3           CASE ( %QI#TYPE_FORM );
      103    19382    3             CALL QBA$DEACTIVATE_FORM
      104    19383    3             WHENALTRETURN
      105    19384    4               DO;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:5    
      106    19385    4                 CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      107    19386    4               END;
      108    19387
      109    19388    3           CASE ( %QI#TYPE_TRANSACTION );
      110    19389        /*  Used to be (pre-C00) there was a thing called G$REP_OPT_COMP              */
      111    19390        /*  which got called to "REPort_OutPuT_COMPlete" on the last                  */
      112    19391        /*  MSGID# we read with RRR set.   Don't do that no more, but                 */
      113    19392        /*  this is how it would have went (sort of).                                 */
      114    19393        /*  Also, see RRR comments in QBR$READ_TRAN.                                  */
      115    19394        /*        IF QI_1.CURRENT.TRAN_STATUS$ ->                                     */
      116    19395        /*          QI$TRAN_STATUS.CURRENT.IS_RRR_ID_VALID                            */
      117    19396        /*        THEN                                                                */
      118    19397        /*          DO;                                                               */
      119    19398        /*           FPT@REP_OTP_COMP.RRR_ID = QI_1.CURRENT.TRAN_STATUS$ ->           */
      120    19399        /*             QI$TRAN_STATUS.RRR_ID;                                         */
      121    19400        /*           CALL M$REP_OTP_COMP ( FPT@REP_OTP_COMP )                         */
      122    19401        /*           WHENALTRETURN                                                    */
      123    19402        /*           DO;                                                              */
      124    19403        /*             CALL M$WRSYSLOG ( FPT@WRSYSLOG )                               */
      125    19404        /*             WHENALTRETURN                                                  */
      126    19405        /*             DO;                                                            */
      127    19406        /*               CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );          */
      128    19407        /*                 G$EXCFR.TRLR.ERR.ERR# );                                   */
      129    19408        /*             END;                                                           */
      130    19409        /*           END;                                                             */
      131    19410        /*         END;                                                               */
      132    19411        /*                                                                            */
      133    19412
      134    19413    3           CASE ( ELSE );
      135    19414    3             CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      136    19415
      137    19416    3         END;
      138    19417
      139    19418    2         FPT@CLOSE = QI_FPT_CLOSE;
      140    19419    2         VBASE ( FPT@CLOSE.V_ ) = ADDR ( FPT@CLOSE.V );
      141    19420    2         FPT@CLOSE.V.DCB# = QI_1.CURRENT.FILE$ -> QI$FILE.DCB#;
      142    19421
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:6    
      143    19422    2         CALL QGB$CLOSE ( FPT@CLOSE, QGB_PARAM )
      144    19423    2         WHENALTRETURN
      145    19424    3           DO;
      146    19425    3             CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      147    19426    3           END;
      148    19427
      149    19428    2         TYPE_INDEX = QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE - %QI#TYPE_FORM;
      150    19429
      151    19430    2         IF QI_1.FILE_HEAD_A$ ( TYPE_INDEX ) = QI_1.CURRENT.FILE$
      152    19431    2         THEN
      153    19432    2           QI_1.FILE_HEAD_A$ ( TYPE_INDEX ) = QI_1.CURRENT.FILE_STATUS$ ->
             19432                    QI$FILE_STATUS.FLINK$;
      154    19433    2         ELSE
      155    19434    3           DO;
      156    19435
      157    19436    3             FILE_LINK$ = QI_1.FILE_HEAD_A$ ( TYPE_INDEX );
      158    19437
      159    19438    3   FIND_THIS_LINK:
      160    19439    4             DO WHILE ( FILE_LINK$ ~= QI_1.CURRENT.FILE$ );
      161    19440
      162    19441                    %DATA_ADDRESS ( THING@D = "FILE_LINK$ -> QI$FILE.STATUS_AREA@D",
      163    19442                    CHECK_FOR_INDIRECTION = NO,
      164    19443                    RESULT$ = FILE_STATUS$ );
      165    19480
      166    19481    4               FILE_LINK$ = FILE_STATUS$ -> QI$FILE_STATUS.FLINK$;
      167    19482
      168    19483    4             END FIND_THIS_LINK;
      169    19484
      170    19485    3             FILE_STATUS$ -> QI$FILE_STATUS.FLINK$ =
      171    19486    3               QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.FLINK$;
      172    19487
      173    19488    3           END;
      174    19489
      175    19490    2         QI_1.OPENED_COUNT_A ( TYPE_INDEX ) =
      176    19491    2           QI_1.OPENED_COUNT_A ( TYPE_INDEX ) - 1;
      177    19492
      178    19493    2         IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE = %QI#TYPE_FORM
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:7    
      179    19494    2         THEN
      180    19495    2           QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS = '0'B;
      181    19496    2         ELSE
      182    19497    2           QI_1.CURRENT.TRAN_STATUS$ -> QI$TRAN_STATUS = '0'B;
      183    19498
      184    19499    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.CURRENT.USAGE.CLOSED = %YES;
      185    19500    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.CURRENT.USAGE.OPENED = %YES;
      186    19501
      187    19502    2         IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
      188    19503    2         THEN
      189    19504    3           DO;
      190    19505                  %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FILE$ -> QI$FILE.ERROR_STATUS@D",
      191    19506                  CHECK_FOR_INDIRECTION = NO,
      192    19507                  RESULT$ = ERROR_STATUS$ );
      193    19544    3             ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_CLOSE_TEXT;
      194    19545    3           END;
      195    19546
      196    19547    2   NEXT_FILE_PLEASE:
      197    19548
      198    19549    2       END CLOSE_FILES;
      199    19550
      200    19551    1       RETURN;
      201    19552
      202    19553        %EJECT;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:8    
      203    19554    1   CHECK_FOR_USE_PROCEDURE:
      204    19555    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;
      205    19556    1       QCU@USE.CURR_FRAME$ = ADDR (NIL);
      206    19557    1       QCU@USE.CURR_NODE$ = ADDR (NIL);
      207    19558    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;
      208    19559
      209    19560    1       CALL QCU$USE_IO ( QCU@USE );
      210    19561
      211    19562    2       DO CASE ( QCU@USE.STATUS );
      212    19563
      213    19564    2         CASE ( %QI#USE_INVALID_RETURN );
      214    19565    2           RETURN;
      215    19566
      216    19567    2         CASE ( %QI#USE_INVALID_RETRY );
      217    19568    2           GOTO RETRY_STATUS_FLAGS;
      218    19569
      219    19570    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );
      220    19571    2           GOTO NEXT_FILE_PLEASE;
      221    19572
      222    19573    2         CASE ( ELSE );
      223    19574    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      224    19575
      225    19576    2       END;
      226    19577
      227    19578    1   END QBC$CLOSE;

PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:9    
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBC$CLOSE.

   Procedure QBC$CLOSE requires 393 words for executable code.
   Procedure QBC$CLOSE requires 50 words of local(AUTO) storage.

    No errors detected in file QBC$CLOSE.:E05TSI    .

PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:10   

 Object Unit name= QBC$CLOSE                                  File name= QBC$CLOSE.:E05TOU
 UTS= JUL 30 '97 04:45:11.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS      1      1  QBC$CLOSE
    1   Proc  even  none   393    189  QBC$CLOSE
    2  RoData even  none     9      9  QBC$CLOSE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  QBC$CLOSE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 QCU$UPDATE_SCREEN
         yes           Std       4 QCE$ERROR_INTERNAL
         yes           Std       4 QCE$ERROR_M$INTERNAL
 yes     yes           Std       0 QBA$DEACTIVATE_FORM
         yes           Std       1 QCU$USE_IO
 yes     yes           Std       2 QGB$CLOSE
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QI_1                                  QGB_PARAM                             QI_4_CHAR_ALPHANUMERIC
     QI_31_DIGIT_SLS_DISPLAY               QI_16_BIT_BINARY                      QI_32_BIT_BINARY
     QI_31_DIGIT_ST_PACKED                 QI_PICTURE_STRING                     QI_FPT_CLOSE
r    G$ROS$
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:12   


        1        1        /*M* QBC$CLOSE:  Close DCBs for FORM and/or TRANSACTION files.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBC$CLOSE
       10       10              PURPOSE:      Close DCBs for FORM and/or TRANSACTION files.
       11       11              DESCRIPTION:  Execute a CLOSE op-code, whose argument
       12       12                            may be a file or a list of files (of any type).
       13       13        */
       14       14
       15       15        QBC$CLOSE: PROC;

     15   1 000000  D380 0000 0000  xent QBC$CLOSE       LNJ,B5   X6A_AUTO_0
          1 000003       0032 0000                       DC       50,0

       16       16
       17       17        /*D*  NAME:         QBC$CLOSE
       18       18              CALL:         CALL QBC$CLOSE;
       19       19              PARAMETERS:   None.
       20       20              INTERFACE:    Called by QAT$TALLYHO when an CLOSE op-code
       21       21                            is encountered.
       22       22                            Calls M$CLOSE.
       23       23              ENVIRONMENT:  Nothing unusual.
       24       24              INPUT:        QI_1,
       25       25                            FPL rununit static data following the op-code.
       26       26              OUTPUT:       Resets all kinds of flags,
       27       27                            does the same thing as DEACTIVATE if that's not
       28       28                            already done.
       29       29              SCRATCH:      Various otter data.
       30       30              DESCRIPTION:  The arguments may be files of either type FORM or
       31       31                            TRANSACTION, or a combination.
       32       32                            Delink the FD from the appropriate open chain
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:13   
       33       33                            and call M$CLOSE with the right stuff.  For FORMs,
       34       34                            if a DEACTIVATE statement wasn't ever executed for
       35       35                            the fields within the FORM in question, then the
       36       36                            dynamic memory has to be marked dead and stuff.
       37       37        */
       38       38
       39       39          %INCLUDE LCP_6;
       40      230          %FPT_CLOSE ( FPTN = FPT@CLOSE,
       41      231                       STCLASS = AUTO );
       42      251
       43      252          %INCLUDE QG_MACRO_M;
       44      389          %QGB_ENTRIES;
       45      402          %INCLUDE QI_EQUATES_E;
       46      761          %INCLUDE QI_PERR_C;
       47      929          %INCLUDE QI_MACROS_M;
       48     5987          %QI$ALL;
       49    17100          %QI_FPTS;
       50    19145
       51    19146    1     DCL ERROR_STATUS$ PTR;
       52    19147    1     DCL FILE_COUNT UBIN;
       53    19148    1     DCL FILE_INDEX UBIN;
       54    19149    1     DCL FILE_LINK$ PTR;
       55    19150    1     DCL FILE_STATUS$ PTR;
       56    19151    1     DCL INSTR$ PTR;
       57    19152    1     DCL TYPE_INDEX UBIN;
       58    19153
       59    19154    1     DCL QBA$DEACTIVATE_FORM ENTRY ALTRET;
       60    19155    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
       61    19156    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
       62    19157    1     DCL QCU$UPDATE_SCREEN ENTRY;
       63    19158    1     DCL QCU$USE_IO ENTRY (1);
       64    19159
       65    19160          %SET LISTMAC = '1'B;
       66    19161
       67    19162          %INCLUDE QCU_USE_M;
       68    19216          %QCU@USE;
             19217            %BEGIN_MACRO;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:14   
             19218            %SET LISTDIR = '0'B;
             19231    1     DCL 1 QCU@USE AUTO ALIGNED,
             19232    1           2 CURR_FRAME$ PTR,
             19233                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             19234    1           2 CURR_NODE$ PTR,
             19235                          /* Pointer to current node or ADDR (NIL).  */
             19236    1           2 USE_DEFAULT_IO UBIN,
             19237                          /* For USE procedures which default applies
             19238                             (see corresponding EQUs).  */
             19239    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             19240                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             19241                             save the fields within the bounds of
             19242                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             19243                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             19244                             before calling the USE procedure.  */
             19245    1           2 FRAME_START_INDEX UBIN,
             19246                          /* Foist frame of the CURRENT.FORM$
             19247                             involved with the I-O error.  */
             19248    1           2 FRAME_STOP_INDEX UBIN,
             19249                          /* Larst frame of the CURRENT.FORM$
             19250                             involved with the I-O error.  */
             19251    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19252                          /* If IS_FIELD_INDEXES_VALID, use them;
             19253                             else use all the fields in the frame.  */
             19254    1           2 FIELD_START_INDEX UBIN,
             19255                          /* Starting index into QI$GZ_FIELD
             19256                             which may have values "pushed".  */
             19257    1           2 FIELD_STOP_INDEX UBIN,
             19258                          /* Stopping index into QI$GZ_FIELD
             19259                             which may have values "pushed".  */
             19260    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19261                          /* If IS_CURSOR_POSITION_VALID, use it;
             19262                             else allow cursor to default to upper-left-most field.  */
             19263    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19264                          /* POSition of the field on which to place the cursor.  */
             19265    1           2 STATUS UBIN;
             19266                          /* Returned action code; see corresponding EQUs.  */
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:15   
             19273            %ENDIF;
       69    19276
       70    19277          %SET LISTMAC = '0'B;
       71    19278        %EJECT;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:16   
       72    19279    1       INSTR$ = QI_1.INSTR$;

  19279   1 000005  EC80 0000 0006  xsym                 LDB,B6   QI_1+6
          1 000008  EFC7 001C                            STB,B6   INSTR$,AUTO

       73    19280    1       FILE_COUNT = INSTR$ -> QI$OP_CLOSE.FILE_COUNT;

  19280   1 00000A  E846 0001                            LDR,R6   1,B6
          1 00000C  EF47 0016                            STR,R6   FILE_COUNT,AUTO

       74    19281    1       QI_1.INSTR$ = PINCRW ( INSTR$, ( FILE_COUNT * 2 ) + 2 );

  19281   1 00000E  F856                                 LDR,R7   R6
          1 00000F  6C00                                 LDV,R6   0
          1 000010  7081                                 DOL,R7   1
          1 000011  8447 001C                            AID      INSTR$,AUTO
          1 000013  8470 0000 0002                       AID      2,IMO
          1 000016  8D00 0000 0006  xsym                 SDI      QI_1+6

       75    19282
       76    19283    1       IF QI_1.SCREEN_UPDATE_FLAGS.WAS_APPLIED

  19283   1 000019  8980 0000 0016  xsym                 CMZ      QI_1+22
          1 00001C  0801 0007                            BAL      s:19286,PREL
          1 00001E  8280 0000 0016  xsym                 LB,'1000'X        QI_1+22
          1 000021       1000
          1 000022  0581 0007                            BBF      s:19288,PREL

       77    19284    1         OR QI_1.SCREEN_UPDATE_FLAGS.WAS_WRITTEN
       78    19285    1       THEN
       79    19286    1         CALL QCU$UPDATE_SCREEN;

  19286   1 000024  CBF0 0000                            LAB,B4   0,IMO
          1 000026  E380 0000 0000  xent                 LNJ,B6   QCU$UPDATE_SCREEN
          1 000029       0001                            DC       s:19288,PREL

       80    19287    1   CLOSE_FILES:
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:17   
       81    19288    2       DO FILE_INDEX = 0 TO FILE_COUNT - 1;

  19288   1 00002A  8747 0017            CLOSE_FILES     CL       FILE_INDEX,AUTO
          1 00002C  0F81 0119                            B        s:19545+3,PREL

       82    19289
       83    19290              %PROC_ADDRESS ( THING@P =
             19290                  "INSTR$ -> QI$OP_CLOSE.OPERAND_A.FILE@P ( FILE_INDEX )",
       84    19291              CHECK_FOR_INDIRECTION = NO,
       85    19292              RESULT$ = "QI_1.CURRENT.FILE$" );

  19310   1 00002E  ECC7 001C                            LDB,B6   INSTR$,AUTO
          1 000030  B847 0017                            LDR,R3   FILE_INDEX,AUTO
          1 000032  3001                                 SOL,R3   1
          1 000033  3E03                                 ADV,R3   3
          1 000034  A836                                 LDR,R2   ,B6,R3
          1 000035  F852                                 LDR,R7   R2
          1 000036  6C00                                 LDV,R6   0
          1 000037  8400 0000 0002  xsym                 AID      QI_1+2
          1 00003A  8D00 0000 0076  xsym                 SDI      QI_1+118

       86    19329
       87    19330              %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FILE$ -> QI$FILE.STATUS_AREA@D",
       88    19331              CHECK_FOR_INDIRECTION = NO,
       89    19332              RESULT$ = "QI_1.CURRENT.FILE_STATUS$" );

  19350   1 00003D  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          1 000040  9845 0006                            LDR,R1   6,B5
          1 000042  F851                                 LDR,R7   R1
          1 000043  6C00                                 LDV,R6   0
          1 000044  8400 0000 0000  xsym                 AID      QI_1
          1 000047  8D00 0000 0078  xsym                 SDI      QI_1+120

       90    19369
       91    19370    2   RETRY_STATUS_FLAGS:
       92    19371    2         IF NOT QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.
             19371                  IS_INPUT
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:18   

  19371   1 00004A  EC80 0000 0078  xsym RETRY_STATUS_FL*LDB,B6   QI_1+120
          1 00004D  82C6 0008                            LB,'0200'X        8,B6
          1 00004F       0200
          1 000050  0501 000C                            BBT      s:19379,PREL
          1 000052  82C6 0008                            LB,'0400'X        8,B6
          1 000054       0400
          1 000055  0501 0007                            BBT      s:19379,PREL

       93    19372    2           AND NOT QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.
             19372                    IS_OUTPUT
       94    19373    2         THEN
       95    19374    3           DO;

       96    19375    3             QI_1.ERROR_STATUS = %E$FILE_ALREADY_CLOSED;

  19375   1 000057  6C04                                 LDV,R6   4
          1 000058  EF00 0000 008C  xsym                 STR,R6   QI_1+140

       97    19376    3             GOTO CHECK_FOR_USE_PROCEDURE;

  19376   1 00005B  0F81 00F3                            B        s:19555,PREL

       98    19377    3           END;
       99    19378
      100    19379    3         DO CASE ( QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE );

  19379   1 00005D  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          1 000060  B805                                 LDR,R3   ,B5
          1 000061  B570 000F                            AND,R3   15,IMO
          1 000063  3EF5                                 ADV,R3   -11
          1 000064  3D02                                 CMV,R3   2
          1 000065  0281 001C                            BGE      s:19414,PREL
          1 000067  A830 0000 006D  01                   LDR,R2   s:19379+16,R3
          1 00006A  83A0 0000 006F  01                   JMP      s:19382,R2
          1 00006D       0000                            DC       s:19382,PREL
          1 00006E       001C                            DC       s:19418,PREL
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:19   

      101    19380
      102    19381    3           CASE ( %QI#TYPE_FORM );

      103    19382    3             CALL QBA$DEACTIVATE_FORM

  19382   1 00006F  CBF0 0000                            LAB,B4   0,IMO
          1 000071  E380 0000 0000  xent                 LNJ,B6   QBA$DEACTIVATE_FORM
          1 000074       0003                            DC       s:19385,PREL
          1 000075  0F81 000A                            B        s:19386,PREL

      104    19383    3             WHENALTRETURN
      105    19384    4               DO;

      106    19385    4                 CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  19385   1 000077  BB80 0000 0001  02                   LAB,B3   +1
          1 00007A  CBF0 0100                            LAB,B4   256,IMO
          1 00007C  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 00007F       0001                            DC       s:19386,PREL

      107    19386    4               END;

  19386   1 000080  0F81 000A                            B        s:19418,PREL

      108    19387
      109    19388    3           CASE ( %QI#TYPE_TRANSACTION );

      110    19389        /*  Used to be (pre-C00) there was a thing called G$REP_OPT_COMP              */
      111    19390        /*  which got called to "REPort_OutPuT_COMPlete" on the last                  */
      112    19391        /*  MSGID# we read with RRR set.   Don't do that no more, but                 */
      113    19392        /*  this is how it would have went (sort of).                                 */
      114    19393        /*  Also, see RRR comments in QBR$READ_TRAN.                                  */
      115    19394        /*        IF QI_1.CURRENT.TRAN_STATUS$ ->                                     */
      116    19395        /*          QI$TRAN_STATUS.CURRENT.IS_RRR_ID_VALID                            */
      117    19396        /*        THEN                                                                */
      118    19397        /*          DO;                                                               */
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:20   
      119    19398        /*           FPT@REP_OTP_COMP.RRR_ID = QI_1.CURRENT.TRAN_STATUS$ ->           */
      120    19399        /*             QI$TRAN_STATUS.RRR_ID;                                         */
      121    19400        /*           CALL M$REP_OTP_COMP ( FPT@REP_OTP_COMP )                         */
      122    19401        /*           WHENALTRETURN                                                    */
      123    19402        /*           DO;                                                              */
      124    19403        /*             CALL M$WRSYSLOG ( FPT@WRSYSLOG )                               */
      125    19404        /*             WHENALTRETURN                                                  */
      126    19405        /*             DO;                                                            */
      127    19406        /*               CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );          */
      128    19407        /*                 G$EXCFR.TRLR.ERR.ERR# );                                   */
      129    19408        /*             END;                                                           */
      130    19409        /*           END;                                                             */
      131    19410        /*         END;                                                               */
      132    19411        /*                                                                            */
      133    19412
      134    19413    3           CASE ( ELSE );

      135    19414    3             CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  19414   1 000082  BB80 0000 0004  02                   LAB,B3   +4
          1 000085  CBF0 0100                            LAB,B4   256,IMO
          1 000087  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 00008A       0001                            DC       s:19418,PREL

      136    19415
      137    19416    3         END;

      138    19417
      139    19418    2         FPT@CLOSE = QI_FPT_CLOSE;

  19418   1 00008B  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_CLOSE
          1 00008E  2C00                                 LDV,R2   0
          1 00008F  6C20                                 LDV,R6   32
          1 000090  BB87                                 LAB,B3   ,AUTO
          1 000091  3C08                                 LDV,R3   8
          1 000092  0008                                 MMM

PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:21   
      140    19419    2         VBASE ( FPT@CLOSE.V_ ) = ADDR ( FPT@CLOSE.V );

  19419   1 000093  EBC7 0013                            LAB,B6   FPT@CLOSE+15,AUTO
          1 000095  EFC7 0005                            STB,B6   FPT@CLOSE+1,AUTO

      141    19420    2         FPT@CLOSE.V.DCB# = QI_1.CURRENT.FILE$ -> QI$FILE.DCB#;

  19420   1 000097  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          1 00009A  E845 0008                            LDR,R6   8,B5
          1 00009C  E7C7 0013                            STH,R6   FPT@CLOSE+15,AUTO

      142    19421
      143    19422    2         CALL QGB$CLOSE ( FPT@CLOSE, QGB_PARAM )

  19422   1 00009E  CB80 0000 0000  xsym                 LAB,B4   QGB_PARAM
          1 0000A1  CFC7 0030                            STB,B4   QCU@USE+17,AUTO
          1 0000A3  ABC7 0004                            LAB,B2   FPT@CLOSE,AUTO
          1 0000A5  AFC7 002E                            STB,B2   QCU@USE+15,AUTO
          1 0000A7  BBC7 002E                            LAB,B3   QCU@USE+15,AUTO
          1 0000A9  CBF0 0200                            LAB,B4   512,IMO
          1 0000AB  E380 0000 0000  xent                 LNJ,B6   QGB$CLOSE
          1 0000AE       0003                            DC       s:19425,PREL
          1 0000AF  0F81 000A                            B        s:19428,PREL

      144    19423    2         WHENALTRETURN
      145    19424    3           DO;

      146    19425    3             CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19425   1 0000B1  BB80 0000 0007  02                   LAB,B3   +7
          1 0000B4  CBF0 0100                            LAB,B4   256,IMO
          1 0000B6  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          1 0000B9       0001                            DC       s:19428,PREL

      147    19426    3           END;

      148    19427
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:22   
      149    19428    2         TYPE_INDEX = QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE - %QI#TYPE_FORM;

  19428   1 0000BA  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 0000BD  E806                                 LDR,R6   ,B6
          1 0000BE  E570 000F                            AND,R6   15,IMO
          1 0000C0  6EF5                                 ADV,R6   -11
          1 0000C1  EF47 001E                            STR,R6   TYPE_INDEX,AUTO

      150    19429
      151    19430    2         IF QI_1.FILE_HEAD_A$ ( TYPE_INDEX ) = QI_1.CURRENT.FILE$

  19430   1 0000C3  B856                                 LDR,R3   R6
          1 0000C4  DCB0 0000 0070  xsym                 LDB,B5   QI_1+112,R3
          1 0000C7  DD80 0000 0076  xsym                 CMB,B5   QI_1+118
          1 0000CA  0981 000B                            BNE      s:19436,PREL

      152    19431    2         THEN
      153    19432    2           QI_1.FILE_HEAD_A$ ( TYPE_INDEX ) = QI_1.CURRENT.FILE_STATUS$ ->
             19432                    QI$FILE_STATUS.FLINK$;

  19432   1 0000CC  CC80 0000 0078  xsym                 LDB,B4   QI_1+120
          1 0000CF  BCC4 0002                            LDB,B3   2,B4
          1 0000D1  BFB0 0000 0070  xsym                 STB,B3   QI_1+112,R3
          1 0000D4  0F81 0026                            B        s:19490,PREL

      154    19433    2         ELSE
      155    19434    3           DO;

      156    19435
      157    19436    3             FILE_LINK$ = QI_1.FILE_HEAD_A$ ( TYPE_INDEX );

  19436   1 0000D6  DFC7 0018                            STB,B5   FILE_LINK$,AUTO

      158    19437
      159    19438    3   FIND_THIS_LINK:
      160    19439    4             DO WHILE ( FILE_LINK$ ~= QI_1.CURRENT.FILE$ );

PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:23   
  19439   1 0000D8  DD80 0000 0076  xsym FIND_THIS_LINK  CMB,B5   QI_1+118
          1 0000DB  0901 0016                            BE       s:19485,PREL

      161    19440
      162    19441                    %DATA_ADDRESS ( THING@D = "FILE_LINK$ -> QI$FILE.STATUS_AREA@D",
      163    19442                    CHECK_FOR_INDIRECTION = NO,
      164    19443                    RESULT$ = FILE_STATUS$ );

  19461   1 0000DD  ECC7 0018                            LDB,B6   FILE_LINK$,AUTO
          1 0000DF  B846 0006                            LDR,R3   6,B6
          1 0000E1  F853                                 LDR,R7   R3
          1 0000E2  6C00                                 LDV,R6   0
          1 0000E3  8400 0000 0000  xsym                 AID      QI_1
          1 0000E6  8D47 001A                            SDI      FILE_STATUS$,AUTO

      165    19480
      166    19481    4               FILE_LINK$ = FILE_STATUS$ -> QI$FILE_STATUS.FLINK$;

  19481   1 0000E8  DCC7 001A                            LDB,B5   FILE_STATUS$,AUTO
          1 0000EA  CCC5 0002                            LDB,B4   2,B5
          1 0000EC  CFC7 0018                            STB,B4   FILE_LINK$,AUTO

      167    19482
      168    19483    4             END FIND_THIS_LINK;

  19483   1 0000EE  CD80 0000 0076  xsym                 CMB,B4   QI_1+118
          1 0000F1  09EC                                 BNE      s:19461,SPREL

      169    19484
      170    19485    3             FILE_STATUS$ -> QI$FILE_STATUS.FLINK$ =

  19485   1 0000F2  EC80 0000 0078  xsym                 LDB,B6   QI_1+120
          1 0000F5  DCC6 0002                            LDB,B5   2,B6
          1 0000F7  CCC7 001A                            LDB,B4   FILE_STATUS$,AUTO
          1 0000F9  DFC4 0002                            STB,B5   2,B4

      171    19486    3               QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.FLINK$;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:24   
      172    19487
      173    19488    3           END;

      174    19489
      175    19490    2         QI_1.OPENED_COUNT_A ( TYPE_INDEX ) =

  19490   1 0000FB  B847 001E                            LDR,R3   TYPE_INDEX,AUTO
          1 0000FD  88B0 0000 0074  xsym                 DEC      QI_1+116,R3

      176    19491    2           QI_1.OPENED_COUNT_A ( TYPE_INDEX ) - 1;
      177    19492
      178    19493    2         IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE = %QI#TYPE_FORM

  19493   1 000100  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 000103  E806                                 LDR,R6   ,B6
          1 000104  E570 000F                            AND,R6   15,IMO
          1 000106  6D0B                                 CMV,R6   11
          1 000107  0981 000D                            BNE      s:19497,PREL

      179    19494    2         THEN
      180    19495    2           QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS = '0'B;

  19495   1 000109  DC80 0000 0078  xsym                 LDB,B5   QI_1+120
          1 00010C  5C12                                 LDV,R5   18
          1 00010D  0021                                 ALR      ;
          1 00010E       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 000110       4005 0000                                ALPHANUM(0,B5,,R5,FILL)
          1 000112  437F                                 CSYNC    s:19495+8,SPREL
          1 000113  0F81 000A                            B        s:19499,PREL

      181    19496    2         ELSE
      182    19497    2           QI_1.CURRENT.TRAN_STATUS$ -> QI$TRAN_STATUS = '0'B;

  19497   1 000115  DC80 0000 0078  xsym                 LDB,B5   QI_1+120
          1 000118  5C12                                 LDV,R5   18
          1 000119  0021                                 ALR      ;
          1 00011A       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:25   
          1 00011C       4005 0000                                ALPHANUM(0,B5,,R5,FILL)

      183    19498
      184    19499    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.CURRENT.USAGE.CLOSED = %YES;

  19499   1 00011E  437F                                 CSYNC    s:19497+8,SPREL
          1 00011F  EC80 0000 0078  xsym                 LDB,B6   QI_1+120
          1 000122  8906                                 LBT,'0200'X       ,B6
          1 000123       0200

      185    19500    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.CURRENT.USAGE.OPENED = %YES;

  19500   1 000124  EC80 0000 0078  xsym                 LDB,B6   QI_1+120
          1 000127  8906                                 LBT,'0400'X       ,B6
          1 000128       0400

      186    19501
      187    19502    2         IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID

  19502   1 000129  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 00012C  8286                                 LB,'4000'X        ,B6
          1 00012D       4000
          1 00012E  0581 0014                            BBF      s:19545,PREL

      188    19503    2         THEN
      189    19504    3           DO;

      190    19505                  %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FILE$ -> QI$FILE.ERROR_STATUS@D",
      191    19506                  CHECK_FOR_INDIRECTION = NO,
      192    19507                  RESULT$ = ERROR_STATUS$ );

  19525   1 000130  B846 0003                            LDR,R3   3,B6
          1 000132  F853                                 LDR,R7   R3
          1 000133  6C00                                 LDV,R6   0
          1 000134  8400 0000 0000  xsym                 AID      QI_1
          1 000137  8D47 0014                            SDI      ERROR_STATUS$,AUTO

PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:26   
      193    19544    3             ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_CLOSE_TEXT;

  19544   1 000139  DB80 0000 0000  00                   LAB,B5   0
          1 00013C  CCC7 0014                            LDB,B4   ERROR_STATUS$,AUTO
          1 00013E  0021                                 ALR      ;
          1 00013F       4205 0000                                ALPHANUM(0,B5,,2),;
          1 000141       4804 0000                                ALPHANUM(0,B4,,8,FILL)

      194    19545    3           END;

      195    19546
      196    19547    2   NEXT_FILE_PLEASE:
      197    19548
      198    19549    2       END CLOSE_FILES;

  19549   1 000143  437F                 NEXT_FILE_PLEASECSYNC    s:19544+9,SPREL
          1 000144  8AC7 0017                            INC      FILE_INDEX,AUTO
          1 000146  E847 0017                            LDR,R6   FILE_INDEX,AUTO
          1 000148  E947 0016                            CMR,R6   FILE_COUNT,AUTO
          1 00014A  0201 FEE3                            BL       s:19310,PREL

      199    19550
      200    19551    1       RETURN;

  19551   1 00014C  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      201    19552
      202    19553        %EJECT;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:27   
      203    19554    1   CHECK_FOR_USE_PROCEDURE:
      204    19555    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;

  19555   1 00014F  8747 0024            CHECK_FOR_USE_P*CL       QCU@USE+5,AUTO

      205    19556    1       QCU@USE.CURR_FRAME$ = ADDR (NIL);

  19556   1 000151  DB80 0000 0000                       LAB,B5   0
          1 000154  DFC7 001F                            STB,B5   QCU@USE,AUTO

      206    19557    1       QCU@USE.CURR_NODE$ = ADDR (NIL);

  19557   1 000156  CB80 0000 0000                       LAB,B4   0
          1 000159  CFC7 0021                            STB,B4   QCU@USE+2,AUTO

      207    19558    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;

  19558   1 00015B  8747 0023                            CL       QCU@USE+4,AUTO

      208    19559
      209    19560    1       CALL QCU$USE_IO ( QCU@USE );

  19560   1 00015D  BBC7 001F                            LAB,B3   QCU@USE,AUTO
          1 00015F  BFC7 002E                            STB,B3   QCU@USE+15,AUTO
          1 000161  BBC7 002E                            LAB,B3   QCU@USE+15,AUTO
          1 000163  CBF0 0100                            LAB,B4   256,IMO
          1 000165  E380 0000 0000  xent                 LNJ,B6   QCU$USE_IO
          1 000168       0001                            DC       s:19562,PREL

      210    19561
      211    19562    2       DO CASE ( QCU@USE.STATUS );

  19562   1 000169  B847 002C                            LDR,R3   QCU@USE+13,AUTO
          1 00016B  3D03                                 CMV,R3   3
          1 00016C  0281 0010                            BGE      s:19574,PREL
          1 00016E  A830 0000 0174  01                   LDR,R2   s:19562+11,R3
          1 000171  83A0 0000 0177  01                   JMP      s:19565,R2
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:28   
          1 000174       0000                            DC       s:19565,PREL
          1 000175       0003                            DC       s:19568,PREL
          1 000176       0005                            DC       s:19571,PREL

      212    19563
      213    19564    2         CASE ( %QI#USE_INVALID_RETURN );

      214    19565    2           RETURN;

  19565   1 000177  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      215    19566
      216    19567    2         CASE ( %QI#USE_INVALID_RETRY );

      217    19568    2           GOTO RETRY_STATUS_FLAGS;

  19568   1 00017A  0F81 FECF                            B        s:19359,PREL

      218    19569
      219    19570    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );

      220    19571    2           GOTO NEXT_FILE_PLEASE;

  19571   1 00017C  0FC7                                 B        s:19545,SPREL

      221    19572
      222    19573    2         CASE ( ELSE );

      223    19574    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  19574   1 00017D  BB80 0000 0001  02                   LAB,B3   +1
          1 000180  CBF0 0100                            LAB,B4   256,IMO
          1 000182  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 000185       0001                            DC       s:19578,PREL

      224    19575
      225    19576    2       END;
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:29   

      226    19577
      227    19578    1   END QBC$CLOSE;

  19578   1 000186  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:30   
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBC$CLOSE.
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:31   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/w PTR         r     1 ERROR_STATUS$             16-0-0/w UBIN(16)    r     1 FILE_COUNT
    17-0-0/w UBIN(16)    r     1 FILE_INDEX                18-0-0/w PTR         r     1 FILE_LINK$
    1A-0-0/w PTR         r     1 FILE_STATUS$               4-0-0/w STRC(256)   r     1 FPT@CLOSE
    1C-0-0/w PTR         r     1 INSTR$                    1F-0-0/w STRC(224)   r     1 QCU@USE
    1E-0-0/w UBIN(16)    r     1 TYPE_INDEX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 QGB_PARAM                  0-0-0/d STRC(2576)  r     1 QI_1
     0-0-0/w STRC(256)   r     1 QI_FPT_CLOSE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(64)    r     1 QI$ERROR_STATUS            0-0-0/w STRC(176)   r     1 QI$FILE
     0-0-0/w STRC(144)   r     1 QI$FILE_STATUS             0-0-0/w STRC(144)   r     1 QI$FORM_STATUS
     0-0-0/w STRC(64)    r     1 QI$OP_CLOSE                0-0-0/w STRC(144)   r     1 QI$TRAN_STATUS
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER


   Procedure QBC$CLOSE requires 393 words for executable code.
   Procedure QBC$CLOSE requires 50 words of local(AUTO) storage.
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:32   

    No errors detected in file QBC$CLOSE.:E05TSI    .
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:33   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:34   
          MINI XREF LISTING

CHECK_FOR_USE_PROCEDURE
     19555**LABEL   19376--GOTO
ERROR_STATUS$
     19146**DCL     19525<<ASSIGN  19544>>ASSIGN
FILE_COUNT
     19147**DCL     19280<<ASSIGN  19281>>ASSIGN  19288>>DOINDEX
FILE_INDEX
     19148**DCL     19288<<DOINDEX 19310>>ASSIGN
FILE_LINK$
     19149**DCL     19436<<ASSIGN  19439>>DOWHILE 19461>>ASSIGN  19481<<ASSIGN
FILE_STATUS$
     19150**DCL     19461<<ASSIGN  19481>>ASSIGN  19485>>ASSIGN
FPT@CLOSE
       244**DCL     19418<<ASSIGN  19422<>CALL
FPT@CLOSE.V
       249**DCL     19419--ASSIGN
FPT@CLOSE.V.DCB#
       249**DCL     19420<<ASSIGN
FPT@CLOSE.V_
       246**DCL     19419<<ASSIGN
INSTR$
     19151**DCL     19279<<ASSIGN  19280>>ASSIGN  19281>>ASSIGN  19310>>ASSIGN
NEXT_FILE_PLEASE
     19549**LABEL   19571--GOTO
QBA$DEACTIVATE_FORM
     19154**DCL-ENT 19382--CALL
QCE$ERROR_INTERNAL
     19155**DCL-ENT 19385--CALL    19414--CALL    19574--CALL
QCE$ERROR_M$INTERNAL
     19156**DCL-ENT 19425--CALL
QCU$UPDATE_SCREEN
     19157**DCL-ENT 19286--CALL
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:35   
QCU$USE_IO
     19158**DCL-ENT 19560--CALL
QCU@USE
     19231**DCL     19560<>CALL
QCU@USE.CURR_FRAME$
     19232**DCL     19556<<ASSIGN
QCU@USE.CURR_NODE$
     19234**DCL     19557<<ASSIGN
QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS
     19239**DCL     19555<<ASSIGN
QCU@USE.STATUS
     19265**DCL     19562>>DOCASE
QCU@USE.USE_DEFAULT_IO
     19236**DCL     19558<<ASSIGN
QGB$CLOSE
       391**DCL-ENT 19422--CALL
QGB_PARAM
     11516**DCL     19422<>CALL
QGB_PARAM.DVE.DVBYTE.VFC
     11584**DCL     11585--REDEF
QGB_PARAM.DVE.EOMCHAR
     11596**DCL     11597--REDEF
QGB_PARAM.MSG$
     11578**DCL     11579--REDEF
QGB_PARAM.UHDR$
     11603**DCL     11604--REDEF
QI$ACTIVATION_STATUS
      9342**DCL      9348--REDEF
QI$CIP
      8183**DCL      8253--REDEF
QI$CIP.CA
      8188**DCL      8192--REDEF    8195--REDEF    8198--REDEF
QI$COBOL_DAD.PSEUDO_CIP
      8427**DCL      8452--REDEF
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      8429**DCL      8434--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:36   
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      8435**DCL      8438--REDEF    8441--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      8463**DCL      8479--REDEF    8487--REDEF    8495--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8464**DCL      8474--REDEF    8477--REDEF
QI$COBOL_DAD.WORD0
      8391**DCL      8392--REDEF    8406--REDEF
QI$COBOL_DAD_P_BITS.P
      8531**DCL      8537--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      8017**DCL      8018--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
      8013**DCL      8016--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      8050**DCL      8051--REDEF    8052--REDEF
QI$DAD.PSEUDO_CIP
      8330**DCL      8355--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      8332**DCL      8337--REDEF
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      8338**DCL      8341--REDEF    8344--REDEF
QI$DAD.WORD0
      8299**DCL      8300--REDEF
QI$ERROR_MESSAGE_LINE
     11691**DCL     11693--REDEF
QI$ERROR_STATUS
     11688**DCL     11690--REDEF
QI$ERROR_STATUS.TEXT
     11689**DCL     19544<<ASSIGN
QI$FIELD_DAD.ELEMENTARY_ITEM.P
      8745**DCL      8752--REDEF
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
      8765**DCL      8772--REDEF
QI$FIELD_DAD.PSEUDO_CIP
      8672**DCL      8697--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:37   
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
      8674**DCL      8679--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
      8680**DCL      8683--REDEF    8686--REDEF
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
      8785**DCL      8792--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
      8728**DCL      8744--REDEF    8762--REDEF    8780--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8729**DCL      8739--REDEF    8742--REDEF
QI$FIELD_DAD.WORD0
      8624**DCL      8625--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      8628**DCL      8633--REDEF
QI$FIELD_DAD_P.P
      8826**DCL      8833--REDEF
QI$FIELD_STATUS.INDICATORS
      9492**DCL      9524--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
      9496**DCL      9501--REDEF
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
      9508**DCL      9515--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
      9502**DCL      9507--REDEF
QI$FILE.DCB#
      8972**DCL     19420>>ASSIGN
QI$FILE.ERROR_STATUS@D
      8961**DCL     19525>>ASSIGN
QI$FILE.STATUS_AREA@D
      8966**DCL     19350>>ASSIGN  19461>>ASSIGN
QI$FILE.WORD0
      8948**DCL      8949--REDEF
QI$FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
      8953**DCL     19502>>IF
QI$FILE.WORD0_FLAGS.TYPE
      8957**DCL     19379>>DOCASE  19428>>ASSIGN  19493>>IF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:38   
QI$FILE_STATUS.CURRENT.USAGE.CLOSED
      9752**DCL     19499<<ASSIGN
QI$FILE_STATUS.CURRENT.USAGE.OPENED
      9749**DCL     19500<<ASSIGN
QI$FILE_STATUS.FLINK$
      9759**DCL     19432>>ASSIGN  19481>>ASSIGN  19485<<ASSIGN  19485>>ASSIGN
QI$FILE_STATUS.INDICATORS
      9785**DCL      9817--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
      9789**DCL      9794--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
      9801**DCL      9808--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.IS_INPUT
      9805**DCL     19371>>IF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.IS_OUTPUT
      9802**DCL     19371>>IF
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
      9795**DCL      9800--REDEF
QI$FORM_FILE.USE_PROCEDURE
      9048**DCL      9055--REDEF
QI$FORM_FILE.WORD0
      9002**DCL      9003--REDEF
QI$FORM_STATUS
      9852**DCL     19495<<ASSIGN
QI$FORM_STATUS.INDICATORS
      9906**DCL      9938--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
      9910**DCL      9915--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
      9922**DCL      9929--REDEF
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
      9916**DCL      9921--REDEF
QI$FRAME.WORD0
      9163**DCL      9164--REDEF
QI$FRAME_STATUS.INDICATORS
     10135**DCL     10167--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:39   
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
     10139**DCL     10144--REDEF
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
     10151**DCL     10158--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
     10145**DCL     10150--REDEF
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     17017**DCL     17022--REDEF
QI$IDENTIFIER
     11694**DCL     11696--REDEF
QI$INDICATORS
      9406**DCL      9436--REDEF
QI$INDICATORS.ENABLED_FLAGS
      9412**DCL      9417--REDEF
QI$INDICATORS.OPEN_FLAGS
      9424**DCL      9431--REDEF
QI$INDICATORS.STATE_FLAGS
      9418**DCL      9423--REDEF
QI$MAJOR_NODE.WORD0
      8862**DCL      8863--REDEF
QI$MAJOR_STATUS.INDICATORS
      9585**DCL      9617--REDEF
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
      9589**DCL      9594--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
      9601**DCL      9608--REDEF
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
      9595**DCL      9600--REDEF
QI$MESSAGE_TYPE
     11685**DCL     11687--REDEF
QI$MINOR_NODE.WORD0
      8905**DCL      8906--REDEF
QI$MINOR_STATUS.INDICATORS
      9678**DCL      9710--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
      9682**DCL      9687--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:40   
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
      9694**DCL      9701--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
      9688**DCL      9693--REDEF
QI$OP_ACCEPT.DATANAME@P
      6093**DCL      6094--REDEF
QI$OP_CALL.EPTR$
      6265**DCL      6266--REDEF
QI$OP_CLEAR.IO_FLAGS
      6298**DCL      6301--REDEF
QI$OP_CLOSE.FILE_COUNT
      6330**DCL     19280>>ASSIGN
QI$OP_CLOSE.OPERAND_A.FILE@P
      6333**DCL     19310>>ASSIGN
QI$OP_DISPLAY.FIELD_A@P
      6565**DCL      6566--REDEF
QI$OP_ENABLE.IO_FLAGS
      6652**DCL      6655--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
      6745**DCL      6750--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      6979**DCL      6980--REDEF
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      6981**DCL      6982--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      6977**DCL      6978--REDEF
QI$OP_OPEN.IO_FLAGS
      7539**DCL      7542--REDEF
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
      7577**DCL      7578--REDEF
QI$PSEUDO_CIP
      8078**DCL      8102--REDEF
QI$PSEUDO_CIP.ALPHANUMERIC
      8082**DCL      8087--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      8088**DCL      8091--REDEF    8094--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:41   
QI$TERMINAL_ATTRIBUTES
      9299**DCL      9312--REDEF
QI$TRAN_FILE.WORD0
      9084**DCL      9085--REDEF
QI$TRAN_STATUS
      9973**DCL     19497<<ASSIGN
QI$TRAN_STATUS.INDICATORS
     10019**DCL     10051--REDEF
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
     10023**DCL     10028--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
     10035**DCL     10042--REDEF
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
     10029**DCL     10034--REDEF
QI$VARIABLE_IDENTIFIER.LENGTH
     11698**DCL     11699--IMP-SIZ
QI_1.BASE
     10227**DCL     10234--REDEF
QI_1.BASE.DATA$
     10228**DCL     19350>>ASSIGN  19461>>ASSIGN  19525>>ASSIGN
QI_1.BASE.PROC$
     10230**DCL     19310>>ASSIGN
QI_1.CURRENT.FILE$
     11118**DCL     11120--REDEF   11122--REDEF   19310<<ASSIGN  19350>>ASSIGN  19379>>DOCASE  19420>>ASSIGN
     19428>>ASSIGN  19430>>IF      19439>>DOWHILE 19493>>IF      19502>>IF      19525>>ASSIGN
QI_1.CURRENT.FILE_STATUS$
     11124**DCL     11126--REDEF   11128--REDEF   19350<<ASSIGN  19371>>IF      19371>>IF      19432>>ASSIGN
     19485>>ASSIGN  19499>>ASSIGN  19500>>ASSIGN
QI_1.CURRENT.FORM_STATUS$
     11126**DCL     19495>>ASSIGN
QI_1.CURRENT.TRAN_STATUS$
     11128**DCL     19497>>ASSIGN
QI_1.DAD
     10922**DCL     10927--REDEF
QI_1.ERROR_STATUS
     11152**DCL     19375<<ASSIGN
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:42   
QI_1.FILE_HEAD
     11105**DCL     11112--REDEF
QI_1.FILE_HEAD_A$
     11112**DCL     19430>>IF      19432<<ASSIGN  19436>>ASSIGN
QI_1.INSTR$
     10235**DCL     19279>>ASSIGN  19281<<ASSIGN
QI_1.IS_ALL_LIT
     10928**DCL     10933--REDEF
QI_1.IS_FORM_VARIABLE
     10934**DCL     10939--REDEF
QI_1.IS_TEMP
     10940**DCL     10945--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     11038**DCL     11063--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     11040**DCL     11045--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     11046**DCL     11049--REDEF   11052--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     11007**DCL     11008--REDEF
QI_1.OFFSET
     10946**DCL     10951--REDEF
QI_1.OP.CIP
     10307**DCL     10758--REDEF
QI_1.OP.CIP.AUX
     10673**DCL     10744--REDEF
QI_1.OP.CIP.AUX.CD
     10718**DCL     10721--REDEF   10725--REDEF   10728--REDEF
QI_1.OP.CIP.S
     10377**DCL     10448--REDEF
QI_1.OP.CIP.S.CD
     10422**DCL     10425--REDEF   10429--REDEF   10432--REDEF
QI_1.OP.CIP.T
     10525**DCL     10596--REDEF
QI_1.OP.CIP.T.CD
     10570**DCL     10573--REDEF   10577--REDEF   10580--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:43   
QI_1.OP.DATA
     10765**DCL     10769--REDEF
QI_1.OP.FILL_CHAR
     10889**DCL     10892--REDEF
QI_1.OP.INX
     10822**DCL     10826--REDEF   10827--REDEF   10831--REDEF
QI_1.OP.LEN
     10805**DCL     10809--REDEF   10810--REDEF   10814--REDEF   10815--REDEF   10819--REDEF
QI_1.OP.LEN.AUX
     10808**DCL     11709--IMP-SIZ
QI_1.OP.LEN.S
     10806**DCL     11705--IMP-SIZ
QI_1.OP.LEN.T
     10807**DCL     11707--IMP-SIZ
QI_1.OP.PICTURE_STRING
     10875**DCL     10878--REDEF   10879--REDEF   10882--REDEF   10883--REDEF   10886--REDEF
QI_1.OP.ROUND
     10908**DCL     10909--REDEF   10910--REDEF
QI_1.OP.SRCH_VRFY_ELEMS
     10844**DCL     10847--REDEF
QI_1.OPENED_COUNT
     11113**DCL     11116--REDEF
QI_1.OPENED_COUNT_A
     11116**DCL     19490<<ASSIGN  19490>>ASSIGN
QI_1.OTTER_SPACE
     10952**DCL     10957--REDEF
QI_1.PICTURE_STRING
     10958**DCL     10963--REDEF
QI_1.SCREEN_UPDATE_FLAGS.WAS_APPLIED
     10270**DCL     19283>>IF
QI_1.SCREEN_UPDATE_FLAGS.WAS_WRITTEN
     10276**DCL     19283>>IF
QI_1.SPECIAL_NAMES
     11141**DCL     11150--REDEF
QI_1.TYPE
     10964**DCL     10969--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:44   
QI_16_BIT_BINARY
     16154**DCL     16224--REDEF
QI_16_BIT_BINARY.CB
     16173**DCL     16176--REDEF   16180--REDEF   16183--REDEF
QI_31_DIGIT_SLS_DISPLAY
     15987**DCL     16057--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     16034**DCL     16037--REDEF   16041--REDEF   16044--REDEF
QI_31_DIGIT_ST_PACKED
     16489**DCL     16559--REDEF
QI_31_DIGIT_ST_PACKED.CP
     16522**DCL     16525--REDEF   16529--REDEF   16532--REDEF
QI_32_BIT_BINARY
     16321**DCL     16391--REDEF
QI_32_BIT_BINARY.CB
     16340**DCL     16343--REDEF   16347--REDEF   16350--REDEF
QI_4_CHAR_ALPHANUMERIC
     15819**DCL     15889--REDEF
QI_4_CHAR_ALPHANUMERIC.CA
     15824**DCL     15828--REDEF   15831--REDEF   15834--REDEF
QI_ACCUMULATOR_DAD.CIP
     16832**DCL     16903--REDEF
QI_ACCUMULATOR_DAD.CIP.CP
     16863**DCL     16866--REDEF   16870--REDEF   16873--REDEF
QI_ALR.CIP
     11784**DCL     12235--REDEF
QI_ALR.CIP.AUX
     12150**DCL     12221--REDEF
QI_ALR.CIP.AUX.CA
     12153**DCL     12157--REDEF   12160--REDEF   12163--REDEF
QI_ALR.CIP.S
     11854**DCL     11925--REDEF
QI_ALR.CIP.S.CA
     11857**DCL     11861--REDEF   11864--REDEF   11867--REDEF
QI_ALR.CIP.T
     12002**DCL     12073--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:45   
QI_ALR.CIP.T.CA
     12005**DCL     12009--REDEF   12012--REDEF   12015--REDEF
QI_ALR.DATA
     12242**DCL     12246--REDEF
QI_ALR.FILL_CHAR
     12366**DCL     12369--REDEF
QI_ALR.INX
     12299**DCL     12303--REDEF   12304--REDEF   12308--REDEF
QI_ALR.LEN
     12282**DCL     12286--REDEF   12287--REDEF   12291--REDEF   12292--REDEF   12296--REDEF
QI_ALR.PICTURE_STRING
     12352**DCL     12355--REDEF   12356--REDEF   12359--REDEF   12360--REDEF   12363--REDEF
QI_ALR.ROUND
     12385**DCL     12386--REDEF   12387--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     12321**DCL     12324--REDEF
QI_FPT_CLOSE
     17146**DCL     19418>>ASSIGN
QI_FPT_DBCONTROL.V_
     17204**DCL     17204--REDEF
QI_FPT_INT.V_
     18042**DCL     18042--REDEF
QI_MAT.CIP
     15123**DCL     15574--REDEF
QI_MAT.CIP.AUX
     15489**DCL     15560--REDEF
QI_MAT.CIP.AUX.CA
     15492**DCL     15496--REDEF   15499--REDEF   15502--REDEF
QI_MAT.CIP.S
     15193**DCL     15264--REDEF
QI_MAT.CIP.S.CA
     15196**DCL     15200--REDEF   15203--REDEF   15206--REDEF
QI_MAT.CIP.T
     15341**DCL     15412--REDEF
QI_MAT.CIP.T.CA
     15344**DCL     15348--REDEF   15351--REDEF   15354--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:46   
QI_MAT.DATA
     15581**DCL     15585--REDEF
QI_MAT.DEC
     15649**DCL     15653--REDEF   15654--REDEF   15658--REDEF
QI_MAT.FILL_CHAR
     15705**DCL     15708--REDEF
QI_MAT.LEN
     15621**DCL     15625--REDEF   15626--REDEF   15630--REDEF   15631--REDEF   15635--REDEF
QI_MAT.PICTURE_STRING
     15691**DCL     15694--REDEF   15695--REDEF   15698--REDEF   15699--REDEF   15702--REDEF
QI_MAT.ROUND
     15724**DCL     15725--REDEF   15726--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     15660**DCL     15663--REDEF
QI_PICTURE_STRING
     16657**DCL     16727--REDEF
QI_PICTURE_STRING.CA
     16662**DCL     16666--REDEF   16669--REDEF   16672--REDEF
QI_SRCH_VRFY.CIP
     14454**DCL     14905--REDEF
QI_SRCH_VRFY.CIP.AUX
     14820**DCL     14891--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     14823**DCL     14827--REDEF   14830--REDEF   14833--REDEF
QI_SRCH_VRFY.CIP.S
     14524**DCL     14595--REDEF
QI_SRCH_VRFY.CIP.S.CA
     14527**DCL     14531--REDEF   14534--REDEF   14537--REDEF
QI_SRCH_VRFY.CIP.T
     14672**DCL     14743--REDEF
QI_SRCH_VRFY.CIP.T.CA
     14675**DCL     14679--REDEF   14682--REDEF   14685--REDEF
QI_SRCH_VRFY.DATA
     14912**DCL     14916--REDEF
QI_SRCH_VRFY.DEC
     14980**DCL     14984--REDEF   14985--REDEF   14989--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:47   
QI_SRCH_VRFY.FILL_CHAR
     15036**DCL     15039--REDEF
QI_SRCH_VRFY.ROUND
     15055**DCL     15056--REDEF   15057--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     14996**DCL     14999--REDEF   15000--REDEF   15003--REDEF   15004--REDEF   15007--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     14920**DCL     14924--REDEF   14925--REDEF   14929--REDEF   14930--REDEF   14934--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     14991**DCL     14994--REDEF
QI_TYPE_BINARY_TARGET.CIP
     13781**DCL     14232--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     14147**DCL     14218--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
     14150**DCL     14154--REDEF   14157--REDEF   14160--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     13851**DCL     13922--REDEF
QI_TYPE_BINARY_TARGET.CIP.S.CA
     13854**DCL     13858--REDEF   13861--REDEF   13864--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     13999**DCL     14070--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     14016**DCL     14019--REDEF   14023--REDEF   14026--REDEF
QI_TYPE_BINARY_TARGET.DATA
     14239**DCL     14243--REDEF
QI_TYPE_BINARY_TARGET.DEC
     14307**DCL     14311--REDEF   14312--REDEF   14316--REDEF
QI_TYPE_BINARY_TARGET.LEN
     14279**DCL     14283--REDEF   14284--REDEF   14288--REDEF   14289--REDEF   14293--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     14349**DCL     14352--REDEF   14353--REDEF   14356--REDEF   14357--REDEF   14360--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     14382**DCL     14383--REDEF   14384--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     14368**DCL     14369--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:48   
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     14318**DCL     14321--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
     12449**DCL     12900--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     12815**DCL     12886--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     12818**DCL     12822--REDEF   12825--REDEF   12828--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     12519**DCL     12590--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     12564**DCL     12567--REDEF   12571--REDEF   12574--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     12667**DCL     12738--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
     12670**DCL     12674--REDEF   12677--REDEF   12680--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     12907**DCL     12911--REDEF
QI_TYPE_DISPLAY_SOURCE.DEC
     12975**DCL     12979--REDEF   12980--REDEF   12984--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     12947**DCL     12951--REDEF   12952--REDEF   12956--REDEF   12957--REDEF   12961--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     13017**DCL     13020--REDEF   13021--REDEF   13024--REDEF   13025--REDEF   13028--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     13050**DCL     13051--REDEF   13052--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     13036**DCL     13037--REDEF
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
     12986**DCL     12989--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     13115**DCL     13566--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     13481**DCL     13552--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     13484**DCL     13488--REDEF   13491--REDEF   13494--REDEF
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:49   
QI_TYPE_DISPLAY_TARGET.CIP.S
     13185**DCL     13256--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
     13188**DCL     13192--REDEF   13195--REDEF   13198--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     13333**DCL     13404--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     13378**DCL     13381--REDEF   13385--REDEF   13388--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     13573**DCL     13577--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     13641**DCL     13645--REDEF   13646--REDEF   13650--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     13613**DCL     13617--REDEF   13618--REDEF   13622--REDEF   13623--REDEF   13627--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
     13683**DCL     13686--REDEF   13687--REDEF   13690--REDEF   13691--REDEF   13694--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     13716**DCL     13717--REDEF   13718--REDEF
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     13702**DCL     13703--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     13652**DCL     13655--REDEF
QI_VLP_SEGMENT.BASE
     17741**DCL     17741--REDEF
QI_VLP_SEGMENT_BUFFER.BASE
     17839**DCL     17839--REDEF
QI_VLP_SEGMENT_LOAD.BASE
     17937**DCL     17937--REDEF
QI_VLP_TRMCTL.BREAKCOUNT
     18931**DCL     18932--REDEF
QI_VLP_XBREAK.IC
     19121**DCL     19121--REDEF
QI_VLP_XBREAK.OLDIC
     19121**DCL     19122--REDEF   19122--REDEF
RETRY_STATUS_FLAGS
     19371**LABEL   19568--GOTO
PL6.E3A0      #001=QBC$CLOSE File=QBC$CLOSE.:E05TSI                              WED 07/30/97 04:45 Page:50   
TYPE_INDEX
     19152**DCL     19428<<ASSIGN  19430>>IF      19432>>ASSIGN  19436>>ASSIGN  19490>>ASSIGN  19490>>ASSIGN
