VERSION E05

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:1    
        1        1        /*M* ASA$CONSOLE - Processes CREATE and MODIFY for CONSOLE. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        /*   ASA$CONSOLE : This module consists of procedures:
       11       11                             ASA$CONSOLE
       12       12                             ASA$CON_OPTS
       13       13                                                               */
       14       14        /*P*  NAME: ASA$CONSOLE
       15       15              PURPOSE:  This module of SUPER processes the
       16       16                        'CREATE CONSOLE' and 'MODIFY CONSOLE' commands.
       17       17                        It calls ASA$CON_OPTS to process the options.
       18       18        */
       19       19        ASA$CONSOLE: PROC ;
       20       20                                                              /**/
       21       21        %SET LISTSUB = '1'B ;
       22       22        /*********************************************************************/
       23       23        /*   Include files   include files   include files   include files   */
       24       24        /*********************************************************************/
       25       25                                                              /**/
       26       26              %INCLUDE  AS_ENTRIES_M ;
       27     1076              %INCLUDE  AS_PERR_C    ;
       28     1678              %INCLUDE  AS_SSUBS_C   ;
       29     1770              %INCLUDE  AS_SUBS_C    ;
       30     3184              %INCLUDE  XU_FORMAT_C  ;
       31     3346              %INCLUDE  XU_MACRO_C   ;
       32     6452              %INCLUDE  KL_SUPER_C   ;
       33     9354              %INCLUDE  AS_SUPER_C   ;
       34     9789              %INCLUDE  AS_MAC_C     ;
       35     9869              %INCLUDE  AS_SUPER_R   ;
       36    12885              %INCLUDE  B_MACROS_C   ;
       37    12996              %INCLUDE  CP_6         ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:2    
       38    13077              %INCLUDE  KC$CGBLK     ;
       39    13125              %INCLUDE  OC$INFO      ;
       40    13181              %INCLUDE  QQ_SUPER_C   ;
       41    13236        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:3    
       42    13237        /*********************************************************************/
       43    13238        /*   Auto data       auto data       auto data       auto data       */
       44    13239        /*********************************************************************/
       45    13240                                                              /**/
       46    13241    1   DCL CREATE BIT(1) ;
       47    13242    1   DCL TYPE CHAR(2) ;
       48    13243    1   DCL SNAME CHAR(8);
       49    13244    1   DCL TWSNC CHAR(4) ;
       50    13245    1   DCL TWSN# UBIN WORD ;
       51    13246    1   DCL TWSN_INDEX UBIN WORD ;
       52    13247    1   DCL CON_ARS UBIN WORD ;
       53    13248    1   DCL TWSN_ARS UBIN WORD ;
       54    13249    1   DCL ARS UBIN WORD ;
       55    13250    1   DCL I UBIN WORD ;
       56    13251    1   DCL J UBIN WORD;
       57    13252    1   DCL LOCAL BIT(1) ;
       58    13253    1   DCL BLK$ PTR ;
       59    13254    1   DCL KLDREC CHAR(4096) ;
       60    13255    1   DCL DREC$ PTR ;
       61    13256    1   DCL TREC$ PTR ;
       62    13257    1   DCL WSNCVT$ PTR ;
       63    13258    1   DCL PRO$ PTR ;
       64    13259    1   DCL TWSNR$ PTR ;
       65    13260    1   DCL 1 CON_NAME,
       66    13261    1          2 COUNT UBIN BYTE UNAL,
       67    13262    1          2 TEXT CHAR(8) UNAL;
       68    13263        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:4    
       69    13264        /*********************************************************************/
       70    13265        /*   Symref's        symref's        symref's        symref's        */
       71    13266        /*********************************************************************/
       72    13267                                                              /**/
       73    13268    1   DCL CONSOLE_CMD SYMREF UBIN WORD ;
       74    13269        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:5    
       75    13270        /*********************************************************************/
       76    13271        /*   Static data     static data     static data     static data     */
       77    13272        /*********************************************************************/
       78    13273                                                              /**/
       79    13274    1   DCL 1 CON_KEY ALIGNED STATIC ,
       80    13275    1          2 CNT UBIN BYTE UNAL INIT( 9 ),
       81    13276    1          2 TXT UNAL ,
       82    13277    1             3 ACCT CHAR(8) UNAL INIT(' ') ,
       83    13278    1             3 ASTR CHAR(1) UNAL INIT('*') ;
       84    13279        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:6    
       85    13280        /********************************************************************/
       86    13281        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       87    13282        /*********************************************************************/
       88    13283                                                              /**/
       89    13284    1   DCL X$PARSE ENTRY(1) ALTRET ;
       90    13285        %ASA$CON_OPTS ;
       91    13288        %ASB$ENQ_HLP ;
       92    13291        %ASB$DEQ_HLP ;
       93    13294        %ASB$READ_HLP ;
       94    13297        %ASB$WRITE_HLP ;
       95    13300        %ASB$GETSEG ;
       96    13303        %ASB$FIND_TWSN_INDEX ;
       97    13306        %ASH$ERROR ;
       98    13309        %ASH$WARN ;
       99    13312        %ASB$WRITE_LO ;
      100    13315        %ASB$CHECK_TYPE ;
      101    13318        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:7    
      102    13319        /*********************************************************************/
      103    13320        /*   Local based     local based     local based     local based     */
      104    13321        /*********************************************************************/
      105    13322                                                              /**/
      106    13323            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      107    13324                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      108    13369              %PARSE$SYM( NAME = OUT$SYM ,
      109    13370                          STCLASS="BASED(BLK$)") ;
      110    13408              %KL_DREC ( NAME = KL$TREC , LAST=";", STCLASS="BASED( TREC$ )" ) ;
      111    13521              %KL_DREC ( NAME = KL$DREC, STCLASS="BASED( DREC$ )" , LAST="," ) ;
      112    13634              %KC$CGID(FPTN=KC$CGID,
      113    13635                        STCLASS=STCLASS,
      114    13636                        LVL = 2 ,
      115    13637                        LAST = "," );
      116    13663              %OC$INFO (FPTN = OCINFO,
      117    13664                        LVL = 2 ) ;
      118    13701              %KL_TWSNREC(  NAME = KL$TWSNREC ,
      119    13702                            STCLASS="BASED( TWSNR$ )") ;
      120    13727        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:8    
      121    13728        /*********************************************************************/
      122    13729        /*   Procedure       procedure       procedure       procedure       */
      123    13730        /*********************************************************************/
      124    13731                                                              /**/
      125    13732        /*
      126    13733            ***            Begin procedure                    ***
      127    13734        */
      128    13735    1   P_PCB.ROOT$ = ADDR( CONSOLE_CMD ) ;
      129    13736    2   CALL X$PARSE( P_PCB ) WHENALTRETURN DO;
      130    13737    2      CALL ASH$ERROR( P_PCB.ERROR ) ;
      131    13738    2      RETURN ;
      132    13739    2      END; /*  Whanaltreturn  */
      133    13740                                                              /**/
      134    13741                                                              /**/
      135    13742    1   NODE$ = P_PCB.OUT$ ;
      136    13743    1   IF P$NODE.CODE = 38 /* CR_CONSOLE */
      137    13744    1   THEN
      138    13745    1      CREATE = AS_TRUE ;
      139    13746    1   ELSE
      140    13747    1      CREATE = AS_FALSE ;
      141    13748                                                              /* Did we get data SEG.? */
      142    13749    1   IF NOT DSEG_FLG
      143    13750    1   THEN                                        /* No, get them. */
      144    13751    2      CALL ASB$GETSEG WHENALTRETURN DO;
      145    13752        /*E*  ERROR:  AS-E$GETSEGERR-C
      146    13753              MESSAGE:  Unable to get data segment memory.
      147    13754        */
      148    13755              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A' ) ;
      149    13770    2         RETURN ;
      150    13771    2         END; /* Whenaltreturn  */
      151    13772                                                              /**/
      152    13773                                                              /* Pick up acct.  */
      153    13774    1   BLK$ = P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      154    13775    2   IF OUT$SYM.COUNT > 8 THEN DO;
      155    13776        /*E*  ERROR:    ASA-E$CNAMETOOBIG-C
      156    13777              MESSAGE:  Console name too long.
      157    13778              MESSAGE1: Console names can be at most 8 characters.
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:9    
      158    13779        */
      159    13780           %SCREAM( ERR#=E$CNAMETOOBIG , LEVEL=ERROR, MID='A' );
      160    13795    2      RETURN ;
      161    13796    2      END ; /* Then do */
      162    13797    1   CON_NAME.COUNT = OUT$SYM.COUNT;
      163    13798    1   CON_NAME.TEXT  = OUT$SYM.TEXT;
      164    13799    1   CON_KEY.TXT.ACCT = OUT$SYM.TEXT ;
      165    13800                                                              /* See if console exists. */
      166    13801    1   USERS_KEY = CON_KEY ;
      167    13802    1   DREC$ = ADDR( KLDREC ) ;
      168    13803    1   ARS = LENGTHC( KLDREC ) ;
      169    13804    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;
      170    13805    1   CALL ASB$READ_HLP( DREC$, ARS )
      171    13806    2   WHENRETURN DO;
      172    13807    2      CALL ASB$CHECK_TYPE( DREC$, ARS, 4 /* CONSOLE */, CREATE, CON_NAME ) ALTRET(EXIT#
             13807               );
      173    13808    3      IF CREATE THEN DO;                             /* Console exists */
      174    13809           /*E*  ERROR:    ASA-E$CONS_ALREADY_EXISTS-C
      175    13810                 MESSAGE:  Console exists.
      176    13811                 MESSAGE1: Console %"%U1" %already exists.
      177    13812           */
      178    13813    3         AS_FIELD1 = CON_NAME;
      179    13814              %SCREAM( ERR#=E$CONS_ALREADY_EXISTS, LEVEL=ERROR, MID='A' ) ;
      180    13829    3         RETURN ;
      181    13830    3         END ; /* Then do */
      182    13831    2      CON_ARS = ARS ;
      183    13832    2      TREC$ = DSEG1$ ;
      184    13833    2      END; /*  Whenreturn  */
      185    13834    2   WHENALTRETURN DO;
      186    13835    3      IF NOT CREATE THEN DO ;                 /* If create ok as is */
      187    13836           /*E*  ERROR:    ASA-E$CONS_DOESNT_EXIST-C
      188    13837                 MESSAGE:  ** Console does not exist. Switching to CREATE mode.
      189    13838           */
      190    13839              %SCREAM( ERR#=E$CONS_DOESNT_EXIST, LEVEL=WARN, MID='A' ) ;
      191    13854    3         CREATE = AS_TRUE ;
      192    13855    3         END; /*   If not create  */
      193    13856    2      END; /*   Whenaltreturn  */
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:10   
      194    13857                                                              /* Check to see if
      195    13858                                                                 'FOR' was specified. */
      196    13859    1   IF P$NODE.SUBNODES > 2
      197    13860    1   THEN                                        /* Yes it was */
      198    13861    2   DO ;
      199    13862    2      BLK$ = P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0) ;
      200    13863    2      IF OUT$SYM.COUNT > 8
      201    13864    2      THEN
      202    13865    3      DO ;
      203    13866              %SCREAM( ERR#=E$CNAMETOOBIG, MID='A', LEVEL=ERROR );
      204    13881    3         RETURN ;
      205    13882    3         END ;        /* Then do */
      206    13883    2      SNAME = OUT$SYM.TEXT ;
      207    13884    2      IF NOT CREATE  AND  KL$DREC.SNAME ~= SNAME
      208    13885    3      THEN DO;
      209    13886        /*E* ERROR:   ASA-E$CON_FOR_WRONG-C
      210    13887             MESSAGE: Warning:  Console %U1 was created for %U2, not %U3.
      211    13888        */
      212    13889    3         AS_FIELD1 = CON_NAME;
      213    13890    3         CALL INDEX( I, AS_BLANK, KL$DREC.SNAME );
      214    13891    3         AS_FIELD2.COUNT = I;
      215    13892    3         AS_FIELD2.TEXT  = KL$DREC.SNAME ;
      216    13893    3         AS_FIELD3.COUNT = OUT$SYM.COUNT ;
      217    13894    3         AS_FIELD3.TEXT  = OUT$SYM.TEXT ;
      218    13895              %SCREAM( ERR#=E$CON_FOR_WRONG, MID='A', LEVEL=WARN );
      219    13910    3         SNAME = KL$DREC.SNAME;
      220    13911    3         END;
      221    13912    2      END ; /* Then do */
      222    13913    1   ELSE                                        /* No it wasn't */
      223    13914    1      IF CREATE
      224    13915    1      THEN SNAME = 'LOCAL';
      225    13916    1      ELSE SNAME = KL$DREC.SNAME ;
      226    13917
      227    13918    1   IF SNAME = 'LOCAL'
      228    13919    1   THEN
      229    13920    1      LOCAL = AS_TRUE ;
      230    13921    1   ELSE
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:11   
      231    13922    1      LOCAL = AS_FALSE ;
      232    13923    1   CALL CONCAT( USERS_KEY.TXTC, SNAME, 'STATION' );
      233    13924    1   USERS_KEY.COUNT = 15;
      234    13925                                                              /* Pick up terminal record */
      235    13926    1   TREC$ = DSEG1$ ;
      236    13927    1   ARS = DSEG1SIZE ;
      237    13928    1   CALL ASB$READ_HLP( TREC$, ARS )
      238    13929    2   WHENALTRETURN DO;
      239    13930           /*E*  ERROR:    ASA-E$TERMINAL_NOEXIST-C
      240    13931                 MESSAGE:  %%U1 %does not exist.
      241    13932                 MESSAGE1: TERMINAL %%U1 %does not exist.
      242    13933           */
      243    13934    2      CALL INDEX( J, ' ', USERS_KEY.TXTC );
      244    13935    2      IF J <= 8
      245    13936    2      THEN AS_FIELD1.COUNT = J;
      246    13937    2      ELSE AS_FIELD1.COUNT = 8;
      247    13938    2      AS_FIELD1.TEXT = USERS_KEY.TXTC;
      248    13939           %SCREAM( ERR#=E$TERMINAL_NOEXIST, LEVEL=ERROR, MID='A' );
      249    13954    2      RETURN ;
      250    13955    2      END; /*  Whenaltreturn  */
      251    13956                                                                 /**/
      252    13957                                                              /* Get twsn number */
      253    13958    1   TWSNC = KL$TREC.TWSN# ;
      254    13959    1   CALL CHARBIN( TWSN#, TWSNC ) ;
      255    13960                                                              /* Pick up twsn record */
      256    13961    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;
      257    13962    1   USERS_KEY.COUNT = 8 ;
      258    13963    1   TWSNR$ = DSEG2$ ;
      259    13964    1   TWSN_ARS = DSEG2SIZE ;
      260    13965    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;
      261    13966    1   CALL ASB$READ_HLP( TWSNR$, TWSN_ARS )
      262    13967    2   WHENALTRETURN DO;
      263    13968    2      AS_FIELD1 = USERS_KEY ;
      264    13969           %SCREAM( ERR#=E$TWSN_NO_EXIST, LEVEL=ERROR, MID='A' ) ;
      265    13984    2      RETURN ;
      266    13985    2      END; /*  Whenaltreturn  */
      267    13986                                                              /**/
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:12   
      268    13987                                                       /* Get index in twsn record */
      269    13988    1   IF CREATE THEN
      270    13989    1      TWSN_INDEX = KL$TWSNREC.NDEV ;
      271    13990    1   ELSE
      272    13991    1      CALL ASB$FIND_TWSN_INDEX(TREC$,DREC$,TWSNR$,AS_FALSE,CON_KEY.TXT.ACCT,TWSN_INDEX)
             13991               ALTRET(EXIT#);
      273    13992                                                              /* Do options */
      274    13993                                                                   /**/
      275    13994    1   CALL ASA$CON_OPTS(DREC$,TWSNR$,TWSNC,CREATE,'0'B,'    ',LOCAL,TWSN_INDEX);
      276    13995                                                              /* Write twsn record */
      277    13996    2   IF CREATE THEN DO ;
      278    13997    2      KL$TWSNREC.NDEV = TWSN_INDEX + 1 ;
      279    13998    2      TWSN_ARS = TWSN_ARS + LENGTHC( KL$TWSNREC.DEVS(0) ) ;
      280    13999    2      END ;
      281    14000    1   KL$TWSNREC.DEVS.ACCT(TWSN_INDEX) = CON_KEY.TXT.ACCT ;
      282    14001    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;
      283    14002    1   USERS_KEY.COUNT = 8 ;
      284    14003    1   CALL ASB$WRITE_HLP( TWSNR$, TWSN_ARS ) ALTRET( WRITE_TWSNR_ERR ) ;
      285    14004                                                              /* Write out console rec */
      286    14005                                                                   /**/
      287    14006    1   IF CREATE THEN KL$DREC.SNAME = SNAME;
      288    14007    1   USERS_KEY = CON_KEY ;
      289    14008    1   CON_ARS = LENGTHC(KL_DREC_CNT) + (KL$DREC.NWINFO*4) ;
      290    14009    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;
      291    14010    1   CALL ASB$WRITE_HLP( DREC$, CON_ARS )  ALTRET( WRITE_TWSNR_ERR ) ;
      292    14011    1   CALL ASB$DEQ_HLP ALTRET( DEQ_ERR2 ) ;
      293    14012                                                              /**/
      294    14013    1   IF CREATE THEN
      295    14014    1      CALL ASB$WRITE_LO( AS_CREATED_TEXT, LENGTHC(AS_CREATED_TEXT) ) ;
      296    14015
      297    14016    1   EXIT#: RETURN ;
      298    14017                                                              /* Errors */
      299    14018                                                              /**/
      300    14019    1   ENQ_ERR2: ;
      301    14020
      302    14021    1   DEQ_ERR2: ;
      303    14022                                                              /**/
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:13   
      304    14023    1   RETURN ;
      305    14024                                                              /**/
      306    14025                                                              /**/
      307    14026    1   WRITE_TWSNR_ERR: ;
      308    14027    1   CALL ASH$ERROR( ERR_CODE ) ;
      309    14028    1   RETURN ;
      310    14029                                                              /**/
      311    14030                                                              /**/
      312    14031    1   END   ASA$CONSOLE ;
      313    14032        %EOD;

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:14   
--  Include file information  --

   QQ_SUPER_C.:E05TOU  is referenced.
   OC$INFO.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$CONSOLE.

   Procedure ASA$CONSOLE requires 398 words for executable code.
   Procedure ASA$CONSOLE requires 1058 words of local(AUTO) storage.

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:15   

 Object Unit name= ASA$CONSOLE                                File name= ASA$CONSOLE.:E05TOU
 UTS= JUL 29 '97 08:33:48.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$UC
    2   Data  even  none     3      3  ASA$CONSOLE
    3  RoData even  UTS     13     15  ASA$CONSOLE
    4   Proc  even  none   398    616  ASA$CONSOLE
    5  RoData even  none    20     24  ASA$CONSOLE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  ASA$CONSOLE
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:16   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       6 ASB$FIND_TWSN_INDEX
 yes     yes           Std       2 ASB$WRITE_HLP
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       1 X$PARSE
         yes           Std       2 ASH$ERROR
 yes     yes           Std       0 ASB$ENQ_HLP
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std      10 ASA$CON_OPTS
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$WARN
 yes     yes           Std       0 ASB$DEQ_HLP
 yes     yes           Std       5 ASB$CHECK_TYPE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_TRUE                          r    AS_FALSE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             AS_CREATED_TEXT                       NODE$
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     AS_FIELD3                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG_FLG                              DSEG1$
     DSEG1SIZE                             DSEG2$                                DSEG2SIZE
     P_PCB                                 KL_DREC_CNT                           M$UC
     CONSOLE_CMD                           B_VECTNIL
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:17   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:18   


        1        1        /*M* ASA$CONSOLE - Processes CREATE and MODIFY for CONSOLE. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        /*   ASA$CONSOLE : This module consists of procedures:
       11       11                             ASA$CONSOLE
       12       12                             ASA$CON_OPTS
       13       13                                                               */
       14       14        /*P*  NAME: ASA$CONSOLE
       15       15              PURPOSE:  This module of SUPER processes the
       16       16                        'CREATE CONSOLE' and 'MODIFY CONSOLE' commands.
       17       17                        It calls ASA$CON_OPTS to process the options.
       18       18        */
       19       19        ASA$CONSOLE: PROC ;

     19  4 000000   000000 700200 xent  ASA$CONSOLE  TSX0  ! X66_AUTO_0
         4 000001   002042 000000                    ZERO    1058,0

       20       20                                                              /**/
       21       21        %SET LISTSUB = '1'B ;
       22       22        /*********************************************************************/
       23       23        /*   Include files   include files   include files   include files   */
       24       24        /*********************************************************************/
       25       25                                                              /**/
       26       26              %INCLUDE  AS_ENTRIES_M ;
       27     1076              %INCLUDE  AS_PERR_C    ;
       28     1678              %INCLUDE  AS_SSUBS_C   ;
       29     1770              %INCLUDE  AS_SUBS_C    ;
       30     3184              %INCLUDE  XU_FORMAT_C  ;
       31     3346              %INCLUDE  XU_MACRO_C   ;
       32     6452              %INCLUDE  KL_SUPER_C   ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:19   
       33     9354              %INCLUDE  AS_SUPER_C   ;
       34     9789              %INCLUDE  AS_MAC_C     ;
       35     9869              %INCLUDE  AS_SUPER_R   ;
       36    12885              %INCLUDE  B_MACROS_C   ;
       37    12996              %INCLUDE  CP_6         ;
       38    13077              %INCLUDE  KC$CGBLK     ;
       39    13125              %INCLUDE  OC$INFO      ;
       40    13181              %INCLUDE  QQ_SUPER_C   ;
       41    13236        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:20   
       42    13237        /*********************************************************************/
       43    13238        /*   Auto data       auto data       auto data       auto data       */
       44    13239        /*********************************************************************/
       45    13240                                                              /**/
       46    13241    1   DCL CREATE BIT(1) ;
       47    13242    1   DCL TYPE CHAR(2) ;
       48    13243    1   DCL SNAME CHAR(8);
       49    13244    1   DCL TWSNC CHAR(4) ;
       50    13245    1   DCL TWSN# UBIN WORD ;
       51    13246    1   DCL TWSN_INDEX UBIN WORD ;
       52    13247    1   DCL CON_ARS UBIN WORD ;
       53    13248    1   DCL TWSN_ARS UBIN WORD ;
       54    13249    1   DCL ARS UBIN WORD ;
       55    13250    1   DCL I UBIN WORD ;
       56    13251    1   DCL J UBIN WORD;
       57    13252    1   DCL LOCAL BIT(1) ;
       58    13253    1   DCL BLK$ PTR ;
       59    13254    1   DCL KLDREC CHAR(4096) ;
       60    13255    1   DCL DREC$ PTR ;
       61    13256    1   DCL TREC$ PTR ;
       62    13257    1   DCL WSNCVT$ PTR ;
       63    13258    1   DCL PRO$ PTR ;
       64    13259    1   DCL TWSNR$ PTR ;
       65    13260    1   DCL 1 CON_NAME,
       66    13261    1          2 COUNT UBIN BYTE UNAL,
       67    13262    1          2 TEXT CHAR(8) UNAL;
       68    13263        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:21   
       69    13264        /*********************************************************************/
       70    13265        /*   Symref's        symref's        symref's        symref's        */
       71    13266        /*********************************************************************/
       72    13267                                                              /**/
       73    13268    1   DCL CONSOLE_CMD SYMREF UBIN WORD ;
       74    13269        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:22   
       75    13270        /*********************************************************************/
       76    13271        /*   Static data     static data     static data     static data     */
       77    13272        /*********************************************************************/
       78    13273                                                              /**/
       79    13274    1   DCL 1 CON_KEY ALIGNED STATIC ,
       80    13275    1          2 CNT UBIN BYTE UNAL INIT( 9 ),
       81    13276    1          2 TXT UNAL ,
       82    13277    1             3 ACCT CHAR(8) UNAL INIT(' ') ,
       83    13278    1             3 ASTR CHAR(1) UNAL INIT('*') ;
       84    13279        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:23   
       85    13280        /********************************************************************/
       86    13281        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       87    13282        /*********************************************************************/
       88    13283                                                              /**/
       89    13284    1   DCL X$PARSE ENTRY(1) ALTRET ;
       90    13285        %ASA$CON_OPTS ;
       91    13288        %ASB$ENQ_HLP ;
       92    13291        %ASB$DEQ_HLP ;
       93    13294        %ASB$READ_HLP ;
       94    13297        %ASB$WRITE_HLP ;
       95    13300        %ASB$GETSEG ;
       96    13303        %ASB$FIND_TWSN_INDEX ;
       97    13306        %ASH$ERROR ;
       98    13309        %ASH$WARN ;
       99    13312        %ASB$WRITE_LO ;
      100    13315        %ASB$CHECK_TYPE ;
      101    13318        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:24   
      102    13319        /*********************************************************************/
      103    13320        /*   Local based     local based     local based     local based     */
      104    13321        /*********************************************************************/
      105    13322                                                              /**/
      106    13323            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      107    13324                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      108    13369              %PARSE$SYM( NAME = OUT$SYM ,
      109    13370                          STCLASS="BASED(BLK$)") ;
      110    13408              %KL_DREC ( NAME = KL$TREC , LAST=";", STCLASS="BASED( TREC$ )" ) ;
      111    13521              %KL_DREC ( NAME = KL$DREC, STCLASS="BASED( DREC$ )" , LAST="," ) ;
      112    13634              %KC$CGID(FPTN=KC$CGID,
      113    13635                        STCLASS=STCLASS,
      114    13636                        LVL = 2 ,
      115    13637                        LAST = "," );
      116    13663              %OC$INFO (FPTN = OCINFO,
      117    13664                        LVL = 2 ) ;
      118    13701              %KL_TWSNREC(  NAME = KL$TWSNREC ,
      119    13702                            STCLASS="BASED( TWSNR$ )") ;
      120    13727        %EJECT ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:25   
      121    13728        /*********************************************************************/
      122    13729        /*   Procedure       procedure       procedure       procedure       */
      123    13730        /*********************************************************************/
      124    13731                                                              /**/
      125    13732        /*
      126    13733            ***            Begin procedure                    ***
      127    13734        */
      128    13735    1   P_PCB.ROOT$ = ADDR( CONSOLE_CMD ) ;

  13735  4 000002   000000 236000 5                  LDQ     0
         4 000003   000001 756000 xsym               STQ     P_PCB+1

      129    13736    2   CALL X$PARSE( P_PCB ) WHENALTRETURN DO;

  13736  4 000004   000001 630400 5                  EPPR0   1
         4 000005   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000006   000000 701000 xent               TSX1    X$PARSE
         4 000007   000011 702000 4                  TSX2    s:13737
         4 000010   000016 710000 4                  TRA     s:13742

      130    13737    2      CALL ASH$ERROR( P_PCB.ERROR ) ;

  13737  4 000011   000002 630400 5                  EPPR0   2
         4 000012   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000013   000000 701000 xent               TSX1    ASH$ERROR
         4 000014   000000 011000                    NOP     0

      131    13738    2      RETURN ;

  13738  4 000015   000000 702200 xent               TSX2  ! X66_ARET

      132    13739    2      END; /*  Whanaltreturn  */
      133    13740                                                              /**/
      134    13741                                                              /**/
      135    13742    1   NODE$ = P_PCB.OUT$ ;

  13742  4 000016   000003 236000 xsym               LDQ     P_PCB+3
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:26   
         4 000017   000000 756000 xsym               STQ     NODE$

      136    13743    1   IF P$NODE.CODE = 38 /* CR_CONSOLE */

  13743  4 000020   000000 470400 xsym               LDP0    NODE$
         4 000021   000000 720100                    LXL0    0,,PR0
         4 000022   000046 100003                    CMPX0   38,DU
         4 000023   000030 601000 4                  TNZ     s:13747

      137    13744    1   THEN
      138    13745    1      CREATE = AS_TRUE ;

  13745  4 000024   000000 236000 xsym               LDQ     AS_TRUE
         4 000025   400000 376003                    ANQ     -131072,DU
         4 000026   200003 756100                    STQ     CREATE,,AUTO
         4 000027   000033 710000 4                  TRA     s:13749

      139    13746    1   ELSE
      140    13747    1      CREATE = AS_FALSE ;

  13747  4 000030   000000 236000 xsym               LDQ     AS_FALSE
         4 000031   400000 376003                    ANQ     -131072,DU
         4 000032   200003 756100                    STQ     CREATE,,AUTO

      141    13748                                                              /* Did we get data SEG.? */
      142    13749    1   IF NOT DSEG_FLG

  13749  4 000033   000000 234000 xsym               SZN     DSEG_FLG
         4 000034   000046 604000 4                  TMI     s:13774

      143    13750    1   THEN                                        /* No, get them. */
      144    13751    2      CALL ASB$GETSEG WHENALTRETURN DO;

  13751  4 000035   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000036   000000 701000 xent               TSX1    ASB$GETSEG
         4 000037   000041 702000 4                  TSX2    s:13767
         4 000040   000046 710000 4                  TRA     s:13774
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:27   

      145    13752        /*E*  ERROR:  AS-E$GETSEGERR-C
      146    13753              MESSAGE:  Unable to get data segment memory.
      147    13754        */
      148    13755              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A' ) ;

  13767  4 000041   000003 630400 5                  EPPR0   3
         4 000042   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000043   000000 701000 xent               TSX1    ASH$ERROR
         4 000044   000000 011000                    NOP     0

      149    13770    2         RETURN ;

  13770  4 000045   000000 702200 xent               TSX2  ! X66_ARET

      150    13771    2         END; /* Whenaltreturn  */
      151    13772                                                              /**/
      152    13773                                                              /* Pick up acct.  */
      153    13774    1   BLK$ = P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;

  13774  4 000046   000000 470400 xsym               LDP0    NODE$
         4 000047   000003 471500                    LDP1    3,,PR0
         4 000050   100003 236100                    LDQ     3,,PR1
         4 000051   200020 756100                    STQ     BLK$,,AUTO

      154    13775    2   IF OUT$SYM.COUNT > 8 THEN DO;

  13775  4 000052   200020 473500                    LDP3    BLK$,,AUTO
         4 000053   300004 236100                    LDQ     4,,PR3
         4 000054   777000 376003                    ANQ     -512,DU
         4 000055   011000 116003                    CMPQ    4608,DU
         4 000056   000064 602000 4                  TNC     s:13797

      155    13776        /*E*  ERROR:    ASA-E$CNAMETOOBIG-C
      156    13777              MESSAGE:  Console name too long.
      157    13778              MESSAGE1: Console names can be at most 8 characters.
      158    13779        */
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:28   
      159    13780           %SCREAM( ERR#=E$CNAMETOOBIG , LEVEL=ERROR, MID='A' );

  13792  4 000057   000004 630400 5                  EPPR0   4
         4 000060   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000061   000000 701000 xent               TSX1    ASH$ERROR
         4 000062   000000 011000                    NOP     0

      160    13795    2      RETURN ;

  13795  4 000063   000000 702200 xent               TSX2  ! X66_ARET

      161    13796    2      END ; /* Then do */
      162    13797    1   CON_NAME.COUNT = OUT$SYM.COUNT;

  13797  4 000064   300004 236100                    LDQ     4,,PR3
         4 000065   202026 552140                    STBQ    CON_NAME,'40'O,AUTO

      163    13798    1   CON_NAME.TEXT  = OUT$SYM.TEXT;

  13798  4 000066   300004 236100                    LDQ     4,,PR3
         4 000067   000033 772000                    QRL     27
         4 000070   000000 620006                    EAX0    0,QL
         4 000071   040100 100540                    MLR     fill='040'O
         4 000072   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000073   202026 200010                    ADSC9   CON_NAME,,AUTO           cn=1,n=8

      164    13799    1   CON_KEY.TXT.ACCT = OUT$SYM.TEXT ;

  13799  4 000074   300004 236100                    LDQ     4,,PR3
         4 000075   000033 772000                    QRL     27
         4 000076   000000 620006                    EAX0    0,QL
         4 000077   040000 100540                    MLR     fill='040'O
         4 000100   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000101   000000 200010 2                  ADSC9   CON_KEY                  cn=1,n=8

      165    13800                                                              /* See if console exists. */
      166    13801    1   USERS_KEY = CON_KEY ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:29   

  13801  4 000102   000000 100400                    MLR     fill='000'O
         4 000103   000000 000012 2                  ADSC9   CON_KEY                  cn=0,n=10
         4 000104   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      167    13802    1   DREC$ = ADDR( KLDREC ) ;

  13802  4 000105   200021 631500                    EPPR1   KLDREC,,AUTO
         4 000106   202021 451500                    STP1    DREC$,,AUTO

      168    13803    1   ARS = LENGTHC( KLDREC ) ;

  13803  4 000107   010000 235007                    LDA     4096,DL
         4 000110   200014 755100                    STA     ARS,,AUTO

      169    13804    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;

  13804  4 000111   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000112   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000113   000610 702000 4                  TSX2    ENQ_ERR2

      170    13805    1   CALL ASB$READ_HLP( DREC$, ARS )

  13805  4 000114   200014 630500                    EPPR0   ARS,,AUTO
         4 000115   202033 450500                    STP0    CON_NAME+5,,AUTO
         4 000116   202021 631500                    EPPR1   DREC$,,AUTO
         4 000117   202032 451500                    STP1    CON_NAME+4,,AUTO
         4 000120   202032 630500                    EPPR0   CON_NAME+4,,AUTO
         4 000121   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000122   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000123   000161 702000 4                  TSX2    s:13835

      171    13806    2   WHENRETURN DO;

      172    13807    2     CALL ASB$CHECK_TYPE( DREC$, ARS, 4 /* CONSOLE */, CREATE, CON_NAME ) ALTRET(EXIT#
             13807               );

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:30   
  13807  4 000124   202026 630500                    EPPR0   CON_NAME,,AUTO
         4 000125   202036 450500                    STP0    CON_NAME+8,,AUTO
         4 000126   200003 631500                    EPPR1   CREATE,,AUTO
         4 000127   202035 451500                    STP1    CON_NAME+7,,AUTO
         4 000130   000005 236000 5                  LDQ     5
         4 000131   202034 756100                    STQ     CON_NAME+6,,AUTO
         4 000132   200014 633500                    EPPR3   ARS,,AUTO
         4 000133   202033 453500                    STP3    CON_NAME+5,,AUTO
         4 000134   202021 634500                    EPPR4   DREC$,,AUTO
         4 000135   202032 454500                    STP4    CON_NAME+4,,AUTO
         4 000136   202032 630500                    EPPR0   CON_NAME+4,,AUTO
         4 000137   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 000140   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 000141   000607 702000 4                  TSX2    EXIT#

      173    13808    3      IF CREATE THEN DO;                             /* Console exists */

  13808  4 000142   200003 234100                    SZN     CREATE,,AUTO
         4 000143   000154 605000 4                  TPL     s:13831

      174    13809           /*E*  ERROR:    ASA-E$CONS_ALREADY_EXISTS-C
      175    13810                 MESSAGE:  Console exists.
      176    13811                 MESSAGE1: Console %"%U1" %already exists.
      177    13812           */
      178    13813    3         AS_FIELD1 = CON_NAME;

  13813  4 000144   000000 100500                    MLR     fill='000'O
         4 000145   202026 000011                    ADSC9   CON_NAME,,AUTO           cn=0,n=9
         4 000146   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      179    13814              %SCREAM( ERR#=E$CONS_ALREADY_EXISTS, LEVEL=ERROR, MID='A' ) ;

  13826  4 000147   000006 630400 5                  EPPR0   6
         4 000150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000151   000000 701000 xent               TSX1    ASH$ERROR
         4 000152   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:31   
      180    13829    3         RETURN ;

  13829  4 000153   000000 702200 xent               TSX2  ! X66_ARET

      181    13830    3         END ; /* Then do */
      182    13831    2      CON_ARS = ARS ;

  13831  4 000154   200014 235100                    LDA     ARS,,AUTO
         4 000155   200012 755100                    STA     CON_ARS,,AUTO

      183    13832    2      TREC$ = DSEG1$ ;

  13832  4 000156   000000 236000 xsym               LDQ     DSEG1$
         4 000157   202022 756100                    STQ     TREC$,,AUTO

      184    13833    2      END; /*  Whenreturn  */

  13833  4 000160   000172 710000 4                  TRA     s:13859

      185    13834    2   WHENALTRETURN DO;

      186    13835    3      IF NOT CREATE THEN DO ;                 /* If create ok as is */

  13835  4 000161   200003 234100                    SZN     CREATE,,AUTO
         4 000162   000172 604000 4                  TMI     s:13859

      187    13836           /*E*  ERROR:    ASA-E$CONS_DOESNT_EXIST-C
      188    13837                 MESSAGE:  ** Console does not exist. Switching to CREATE mode.
      189    13838           */
      190    13839              %SCREAM( ERR#=E$CONS_DOESNT_EXIST, LEVEL=WARN, MID='A' ) ;

  13849  4 000163   000007 630400 5                  EPPR0   7
         4 000164   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000165   000000 701000 xent               TSX1    ASH$WARN
         4 000166   000000 011000                    NOP     0

      191    13854    3         CREATE = AS_TRUE ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:32   

  13854  4 000167   000000 236000 xsym               LDQ     AS_TRUE
         4 000170   400000 376003                    ANQ     -131072,DU
         4 000171   200003 756100                    STQ     CREATE,,AUTO

      192    13855    3         END; /*   If not create  */

      193    13856    2      END; /*   Whenaltreturn  */

      194    13857                                                              /* Check to see if
      195    13858                                                                 'FOR' was specified. */
      196    13859    1   IF P$NODE.SUBNODES > 2

  13859  4 000172   000000 470400 xsym               LDP0    NODE$
         4 000173   000001 220100                    LDX0    1,,PR0
         4 000174   000003 100003                    CMPX0   3,DU
         4 000175   000266 602000 4                  TNC     s:13914

      197    13860    1   THEN                                        /* Yes it was */
      198    13861    2   DO ;

      199    13862    2      BLK$ = P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0) ;

  13862  4 000176   000004 471500                    LDP1    4,,PR0
         4 000177   100003 236100                    LDQ     3,,PR1
         4 000200   200020 756100                    STQ     BLK$,,AUTO

      200    13863    2      IF OUT$SYM.COUNT > 8

  13863  4 000201   200020 473500                    LDP3    BLK$,,AUTO
         4 000202   300004 236100                    LDQ     4,,PR3
         4 000203   777000 376003                    ANQ     -512,DU
         4 000204   011000 116003                    CMPQ    4608,DU
         4 000205   000213 602000 4                  TNC     s:13883

      201    13864    2      THEN
      202    13865    3      DO ;
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:33   

      203    13866              %SCREAM( ERR#=E$CNAMETOOBIG, MID='A', LEVEL=ERROR );

  13878  4 000206   000004 630400 5                  EPPR0   4
         4 000207   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000210   000000 701000 xent               TSX1    ASH$ERROR
         4 000211   000000 011000                    NOP     0

      204    13881    3         RETURN ;

  13881  4 000212   000000 702200 xent               TSX2  ! X66_ARET

      205    13882    3         END ;        /* Then do */
      206    13883    2      SNAME = OUT$SYM.TEXT ;

  13883  4 000213   300004 236100                    LDQ     4,,PR3
         4 000214   000033 772000                    QRL     27
         4 000215   000000 621006                    EAX1    0,QL
         4 000216   040100 100540                    MLR     fill='040'O
         4 000217   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 000220   200005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      207    13884    2      IF NOT CREATE  AND  KL$DREC.SNAME ~= SNAME

  13884  4 000221   200003 234100                    SZN     CREATE,,AUTO
         4 000222   000300 604000 4                  TMI     s:13918
         4 000223   202021 474500                    LDP4    DREC$,,AUTO
         4 000224   040100 106500                    CMPC    fill='040'O
         4 000225   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000226   200005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000227   000300 600000 4                  TZE     s:13918

      208    13885    3      THEN DO;

      209    13886        /*E* ERROR:   ASA-E$CON_FOR_WRONG-C
      210    13887             MESSAGE: Warning:  Console %U1 was created for %U2, not %U3.
      211    13888        */
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:34   
      212    13889    3         AS_FIELD1 = CON_NAME;

  13889  4 000230   000000 100500                    MLR     fill='000'O
         4 000231   202026 000011                    ADSC9   CON_NAME,,AUTO           cn=0,n=9
         4 000232   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      213    13890    3         CALL INDEX( I, AS_BLANK, KL$DREC.SNAME );

  13890  4 000233   000000 124500                    SCM     mask='000'O
         4 000234   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000235   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000236   200015 000100                    ARG     I,,AUTO

      214    13891    3         AS_FIELD2.COUNT = I;

  13891  4 000237   200015 236100                    LDQ     I,,AUTO
         4 000240   000033 736000                    QLS     27
         4 000241   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      215    13892    3         AS_FIELD2.TEXT  = KL$DREC.SNAME ;

  13892  4 000242   040000 100500                    MLR     fill='040'O
         4 000243   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000244   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      216    13893    3         AS_FIELD3.COUNT = OUT$SYM.COUNT ;

  13893  4 000245   300004 236100                    LDQ     4,,PR3
         4 000246   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

      217    13894    3         AS_FIELD3.TEXT  = OUT$SYM.TEXT ;

  13894  4 000247   300004 236100                    LDQ     4,,PR3
         4 000250   000033 772000                    QRL     27
         4 000251   000000 620006                    EAX0    0,QL
         4 000252   040000 100540                    MLR     fill='040'O
         4 000253   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:35   
         4 000254   000000 200050 xsym               ADSC9   AS_FIELD3                cn=1,n=40

      218    13895              %SCREAM( ERR#=E$CON_FOR_WRONG, MID='A', LEVEL=WARN );

  13905  4 000255   000010 630400 5                  EPPR0   8
         4 000256   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000257   000000 701000 xent               TSX1    ASH$WARN
         4 000260   000000 011000                    NOP     0

      219    13910    3         SNAME = KL$DREC.SNAME;

  13910  4 000261   202021 470500                    LDP0    DREC$,,AUTO
         4 000262   040100 100500                    MLR     fill='040'O
         4 000263   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         4 000264   200005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      220    13911    3         END;

      221    13912    2      END ; /* Then do */

  13912  4 000265   000300 710000 4                  TRA     s:13918

      222    13913    1   ELSE                                        /* No it wasn't */
      223    13914    1      IF CREATE

  13914  4 000266   200003 234100                    SZN     CREATE,,AUTO
         4 000267   000274 605000 4                  TPL     s:13916

      224    13915    1      THEN SNAME = 'LOCAL';

  13915  4 000270   040100 100400                    MLR     fill='040'O
         4 000271   000005 000005 3                  ADSC9   5                        cn=0,n=5
         4 000272   200005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000273   000300 710000 4                  TRA     s:13918

      225    13916    1      ELSE SNAME = KL$DREC.SNAME ;

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:36   
  13916  4 000274   202021 471500                    LDP1    DREC$,,AUTO
         4 000275   040100 100500                    MLR     fill='040'O
         4 000276   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         4 000277   200005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      226    13917
      227    13918    1   IF SNAME = 'LOCAL'

  13918  4 000300   040000 106500                    CMPC    fill='040'O
         4 000301   200005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000302   000005 000005 3                  ADSC9   5                        cn=0,n=5
         4 000303   000310 601000 4                  TNZ     s:13922

      228    13919    1   THEN
      229    13920    1      LOCAL = AS_TRUE ;

  13920  4 000304   000000 236000 xsym               LDQ     AS_TRUE
         4 000305   400000 376003                    ANQ     -131072,DU
         4 000306   200017 756100                    STQ     LOCAL,,AUTO
         4 000307   000313 710000 4                  TRA     s:13923

      230    13921    1   ELSE
      231    13922    1      LOCAL = AS_FALSE ;

  13922  4 000310   000000 236000 xsym               LDQ     AS_FALSE
         4 000311   400000 376003                    ANQ     -131072,DU
         4 000312   200017 756100                    STQ     LOCAL,,AUTO

      232    13923    1   CALL CONCAT( USERS_KEY.TXTC, SNAME, 'STATION' );

  13923  4 000313   040000 100500                    MLR     fill='040'O
         4 000314   200005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000315   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000316   040000 100400                    MLR     fill='040'O
         4 000317   000007 000007 3                  ADSC9   7                        cn=0,n=7
         4 000320   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:37   
      233    13924    1   USERS_KEY.COUNT = 15;

  13924  4 000321   017000 236003                    LDQ     7680,DU
         4 000322   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      234    13925                                                              /* Pick up terminal record */
      235    13926    1   TREC$ = DSEG1$ ;

  13926  4 000323   000000 236000 xsym               LDQ     DSEG1$
         4 000324   202022 756100                    STQ     TREC$,,AUTO

      236    13927    1   ARS = DSEG1SIZE ;

  13927  4 000325   000000 235000 xsym               LDA     DSEG1SIZE
         4 000326   200014 755100                    STA     ARS,,AUTO

      237    13928    1   CALL ASB$READ_HLP( TREC$, ARS )

  13928  4 000327   200014 630500                    EPPR0   ARS,,AUTO
         4 000330   202033 450500                    STP0    CON_NAME+5,,AUTO
         4 000331   202022 631500                    EPPR1   TREC$,,AUTO
         4 000332   202032 451500                    STP1    CON_NAME+4,,AUTO
         4 000333   202032 630500                    EPPR0   CON_NAME+4,,AUTO
         4 000334   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000335   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000336   000340 702000 4                  TSX2    s:13934
         4 000337   000365 710000 4                  TRA     s:13958

      238    13929    2   WHENALTRETURN DO;

      239    13930           /*E*  ERROR:    ASA-E$TERMINAL_NOEXIST-C
      240    13931                 MESSAGE:  %%U1 %does not exist.
      241    13932                 MESSAGE1: TERMINAL %%U1 %does not exist.
      242    13933           */
      243    13934    2      CALL INDEX( J, ' ', USERS_KEY.TXTC );

  13934  4 000340   000000 124400                    SCM     mask='000'O
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:38   
         4 000341   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 000342   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000343   200016 000100                    ARG     J,,AUTO

      244    13935    2      IF J <= 8

  13935  4 000344   200016 235100                    LDA     J,,AUTO
         4 000345   000011 115007                    CMPA    9,DL
         4 000346   000353 603000 4                  TRC     s:13937

      245    13936    2      THEN AS_FIELD1.COUNT = J;

  13936  4 000347   200016 236100                    LDQ     J,,AUTO
         4 000350   000033 736000                    QLS     27
         4 000351   000000 552040 xsym               STBQ    AS_FIELD1,'40'O
         4 000352   000355 710000 4                  TRA     s:13938

      246    13937    2      ELSE AS_FIELD1.COUNT = 8;

  13937  4 000353   010000 236003                    LDQ     4096,DU
         4 000354   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      247    13938    2      AS_FIELD1.TEXT = USERS_KEY.TXTC;

  13938  4 000355   040000 100400                    MLR     fill='040'O
         4 000356   000000 200050 xsym               ADSC9   USERS_KEY                cn=1,n=40
         4 000357   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      248    13939           %SCREAM( ERR#=E$TERMINAL_NOEXIST, LEVEL=ERROR, MID='A' );

  13951  4 000360   000011 630400 5                  EPPR0   9
         4 000361   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000362   000000 701000 xent               TSX1    ASH$ERROR
         4 000363   000000 011000                    NOP     0

      249    13954    2      RETURN ;

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:39   
  13954  4 000364   000000 702200 xent               TSX2  ! X66_ARET

      250    13955    2      END; /*  Whenaltreturn  */
      251    13956                                                                 /**/
      252    13957                                                              /* Get twsn number */
      253    13958    1   TWSNC = KL$TREC.TWSN# ;

  13958  4 000365   202022 470500                    LDP0    TREC$,,AUTO
         4 000366   000001 236100                    LDQ     1,,PR0
         4 000367   200007 756100                    STQ     TWSNC,,AUTO

      254    13959    1   CALL CHARBIN( TWSN#, TWSNC ) ;

  13959  4 000370   000100 305500                    DTB
         4 000371   200007 030004                    NDSC9   TWSNC,,AUTO              cn=0,s=nosgn,sf=0,n=4
         4 000372   202032 000010                    NDSC9   CON_NAME+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 000373   202033 235100                    LDA     CON_NAME+5,,AUTO
         4 000374   200010 755100                    STA     TWSN#,,AUTO

      255    13960                                                              /* Pick up twsn record */
      256    13961    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;

  13961  4 000375   040000 100400                    MLR     fill='040'O
         4 000376   000012 000004 3                  ADSC9   10                       cn=0,n=4
         4 000377   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 000400   040000 100500                    MLR     fill='040'O
         4 000401   200007 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 000402   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      257    13962    1   USERS_KEY.COUNT = 8 ;

  13962  4 000403   010000 236003                    LDQ     4096,DU
         4 000404   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      258    13963    1   TWSNR$ = DSEG2$ ;

  13963  4 000405   000000 236000 xsym               LDQ     DSEG2$
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:40   
         4 000406   202025 756100                    STQ     TWSNR$,,AUTO

      259    13964    1   TWSN_ARS = DSEG2SIZE ;

  13964  4 000407   000000 235000 xsym               LDA     DSEG2SIZE
         4 000410   200013 755100                    STA     TWSN_ARS,,AUTO

      260    13965    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;

  13965  4 000411   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000412   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000413   000610 702000 4                  TSX2    ENQ_ERR2

      261    13966    1   CALL ASB$READ_HLP( TWSNR$, TWSN_ARS )

  13966  4 000414   200013 630500                    EPPR0   TWSN_ARS,,AUTO
         4 000415   202033 450500                    STP0    CON_NAME+5,,AUTO
         4 000416   202025 631500                    EPPR1   TWSNR$,,AUTO
         4 000417   202032 451500                    STP1    CON_NAME+4,,AUTO
         4 000420   202032 630500                    EPPR0   CON_NAME+4,,AUTO
         4 000421   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000422   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000423   000425 702000 4                  TSX2    s:13968
         4 000424   000435 710000 4                  TRA     s:13988

      262    13967    2   WHENALTRETURN DO;

      263    13968    2      AS_FIELD1 = USERS_KEY ;

  13968  4 000425   000000 100400                    MLR     fill='000'O
         4 000426   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         4 000427   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      264    13969           %SCREAM( ERR#=E$TWSN_NO_EXIST, LEVEL=ERROR, MID='A' ) ;

  13981  4 000430   000012 630400 5                  EPPR0   10
         4 000431   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:41   
         4 000432   000000 701000 xent               TSX1    ASH$ERROR
         4 000433   000000 011000                    NOP     0

      265    13984    2      RETURN ;

  13984  4 000434   000000 702200 xent               TSX2  ! X66_ARET

      266    13985    2      END; /*  Whenaltreturn  */
      267    13986                                                              /**/
      268    13987                                                       /* Get index in twsn record */
      269    13988    1   IF CREATE THEN

  13988  4 000435   200003 234100                    SZN     CREATE,,AUTO
         4 000436   000443 605000 4                  TPL     s:13991

      270    13989    1      TWSN_INDEX = KL$TWSNREC.NDEV ;

  13989  4 000437   202025 470500                    LDP0    TWSNR$,,AUTO
         4 000440   000004 235100                    LDA     4,,PR0
         4 000441   200011 755100                    STA     TWSN_INDEX,,AUTO
         4 000442   000463 710000 4                  TRA     s:13994

      271    13990    1   ELSE
      272    13991    1     CALL ASB$FIND_TWSN_INDEX(TREC$,DREC$,TWSNR$,AS_FALSE,CON_KEY.TXT.ACCT,TWSN_INDEX)
             13991               ALTRET(EXIT#);

  13991  4 000443   200011 630500                    EPPR0   TWSN_INDEX,,AUTO
         4 000444   202037 450500                    STP0    CON_NAME+9,,AUTO
         4 000445   000013 236000 5                  LDQ     11
         4 000446   202036 756100                    STQ     CON_NAME+8,,AUTO
         4 000447   000014 236000 5                  LDQ     12
         4 000450   202035 756100                    STQ     CON_NAME+7,,AUTO
         4 000451   202025 631500                    EPPR1   TWSNR$,,AUTO
         4 000452   202034 451500                    STP1    CON_NAME+6,,AUTO
         4 000453   202021 633500                    EPPR3   DREC$,,AUTO
         4 000454   202033 453500                    STP3    CON_NAME+5,,AUTO
         4 000455   202022 634500                    EPPR4   TREC$,,AUTO
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:42   
         4 000456   202032 454500                    STP4    CON_NAME+4,,AUTO
         4 000457   202032 630500                    EPPR0   CON_NAME+4,,AUTO
         4 000460   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 000461   000000 701000 xent               TSX1    ASB$FIND_TWSN_INDEX
         4 000462   000607 702000 4                  TSX2    EXIT#

      273    13992                                                              /* Do options */
      274    13993                                                                   /**/
      275    13994    1   CALL ASA$CON_OPTS(DREC$,TWSNR$,TWSNC,CREATE,'0'B,'    ',LOCAL,TWSN_INDEX);

  13994  4 000463   200011 630500                    EPPR0   TWSN_INDEX,,AUTO
         4 000464   202041 450500                    STP0    CON_NAME+11,,AUTO
         4 000465   200017 631500                    EPPR1   LOCAL,,AUTO
         4 000466   202040 451500                    STP1    CON_NAME+10,,AUTO
         4 000467   000016 237000 5                  LDAQ    14
         4 000470   202036 757100                    STAQ    CON_NAME+8,,AUTO
         4 000471   200003 633500                    EPPR3   CREATE,,AUTO
         4 000472   202035 453500                    STP3    CON_NAME+7,,AUTO
         4 000473   200007 634500                    EPPR4   TWSNC,,AUTO
         4 000474   202034 454500                    STP4    CON_NAME+6,,AUTO
         4 000475   202025 635500                    EPPR5   TWSNR$,,AUTO
         4 000476   202033 455500                    STP5    CON_NAME+5,,AUTO
         4 000477   202021 636500                    EPPR6   DREC$,,AUTO
         4 000500   202032 456500                    STP6    CON_NAME+4,,AUTO
         4 000501   202032 630500                    EPPR0   CON_NAME+4,,AUTO
         4 000502   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000503   000000 701000 xent               TSX1    ASA$CON_OPTS
         4 000504   000000 011000                    NOP     0

      276    13995                                                              /* Write twsn record */
      277    13996    2   IF CREATE THEN DO ;

  13996  4 000505   200003 234100                    SZN     CREATE,,AUTO
         4 000506   000516 605000 4                  TPL     s:14000

      278    13997    2      KL$TWSNREC.NDEV = TWSN_INDEX + 1 ;

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:43   
  13997  4 000507   202025 470500                    LDP0    TWSNR$,,AUTO
         4 000510   200011 235100                    LDA     TWSN_INDEX,,AUTO
         4 000511   000001 035007                    ADLA    1,DL
         4 000512   000004 755100                    STA     4,,PR0

      279    13998    2      TWSN_ARS = TWSN_ARS + LENGTHC( KL$TWSNREC.DEVS(0) ) ;

  13998  4 000513   200013 235100                    LDA     TWSN_ARS,,AUTO
         4 000514   000054 035007                    ADLA    44,DL
         4 000515   200013 755100                    STA     TWSN_ARS,,AUTO

      280    13999    2      END ;

      281    14000    1   KL$TWSNREC.DEVS.ACCT(TWSN_INDEX) = CON_KEY.TXT.ACCT ;

  14000  4 000516   200011 236100                    LDQ     TWSN_INDEX,,AUTO
         4 000517   000013 402007                    MPY     11,DL
         4 000520   000002 736000                    QLS     2
         4 000521   202025 470500                    LDP0    TWSNR$,,AUTO
         4 000522   040106 100400                    MLR     fill='040'O
         4 000523   000000 200010 2                  ADSC9   CON_KEY                  cn=1,n=8
         4 000524   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8

      282    14001    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;

  14001  4 000525   040000 100400                    MLR     fill='040'O
         4 000526   000012 000004 3                  ADSC9   10                       cn=0,n=4
         4 000527   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 000530   040000 100500                    MLR     fill='040'O
         4 000531   200007 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 000532   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      283    14002    1   USERS_KEY.COUNT = 8 ;

  14002  4 000533   010000 236003                    LDQ     4096,DU
         4 000534   000000 552040 xsym               STBQ    USERS_KEY,'40'O

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:44   
      284    14003    1   CALL ASB$WRITE_HLP( TWSNR$, TWSN_ARS ) ALTRET( WRITE_TWSNR_ERR ) ;

  14003  4 000535   200013 630500                    EPPR0   TWSN_ARS,,AUTO
         4 000536   202033 450500                    STP0    CON_NAME+5,,AUTO
         4 000537   202025 631500                    EPPR1   TWSNR$,,AUTO
         4 000540   202032 451500                    STP1    CON_NAME+4,,AUTO
         4 000541   202032 630500                    EPPR0   CON_NAME+4,,AUTO
         4 000542   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000543   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000544   000611 702000 4                  TSX2    WRITE_TWSNR_ERR

      285    14004                                                              /* Write out console rec */
      286    14005                                                                   /**/
      287    14006    1   IF CREATE THEN KL$DREC.SNAME = SNAME;

  14006  4 000545   200003 234100                    SZN     CREATE,,AUTO
         4 000546   000553 605000 4                  TPL     s:14007

  14006  4 000547   202021 470500                    LDP0    DREC$,,AUTO
         4 000550   040100 100500                    MLR     fill='040'O
         4 000551   200005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000552   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8

      288    14007    1   USERS_KEY = CON_KEY ;

  14007  4 000553   000000 100400                    MLR     fill='000'O
         4 000554   000000 000012 2                  ADSC9   CON_KEY                  cn=0,n=10
         4 000555   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      289    14008    1   CON_ARS = LENGTHC(KL_DREC_CNT) + (KL$DREC.NWINFO*4) ;

  14008  4 000556   202021 470500                    LDP0    DREC$,,AUTO
         4 000557   000017 235100                    LDA     15,,PR0
         4 000560   000002 735000                    ALS     2
         4 000561   000100 035007                    ADLA    64,DL
         4 000562   200012 755100                    STA     CON_ARS,,AUTO

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:45   
      290    14009    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;

  14009  4 000563   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000564   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000565   000610 702000 4                  TSX2    ENQ_ERR2

      291    14010    1   CALL ASB$WRITE_HLP( DREC$, CON_ARS )  ALTRET( WRITE_TWSNR_ERR ) ;

  14010  4 000566   200012 630500                    EPPR0   CON_ARS,,AUTO
         4 000567   202033 450500                    STP0    CON_NAME+5,,AUTO
         4 000570   202021 631500                    EPPR1   DREC$,,AUTO
         4 000571   202032 451500                    STP1    CON_NAME+4,,AUTO
         4 000572   202032 630500                    EPPR0   CON_NAME+4,,AUTO
         4 000573   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000574   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000575   000611 702000 4                  TSX2    WRITE_TWSNR_ERR

      292    14011    1   CALL ASB$DEQ_HLP ALTRET( DEQ_ERR2 ) ;

  14011  4 000576   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000577   000000 701000 xent               TSX1    ASB$DEQ_HLP
         4 000600   000610 702000 4                  TSX2    ENQ_ERR2

      293    14012                                                              /**/
      294    14013    1   IF CREATE THEN

  14013  4 000601   200003 234100                    SZN     CREATE,,AUTO
         4 000602   000607 605000 4                  TPL     EXIT#

      295    14014    1      CALL ASB$WRITE_LO( AS_CREATED_TEXT, LENGTHC(AS_CREATED_TEXT) ) ;

  14014  4 000603   000021 630400 5                  EPPR0   17
         4 000604   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000605   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000606   000000 011000                    NOP     0

      296    14015
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:46   
      297    14016    1   EXIT#: RETURN ;

  14016  4 000607   000000 702200 xent  EXIT#        TSX2  ! X66_ARET

  14013  4 000610                       ENQ_ERR2     null
  14013  4 000610                       DEQ_ERR2     null
      298    14017                                                              /* Errors */
      299    14018                                                              /**/
      300    14019    1   ENQ_ERR2: ;
      301    14020
      302    14021    1   DEQ_ERR2: ;
      303    14022                                                              /**/
      304    14023    1   RETURN ;

  14023  4 000610   000000 702200 xent               TSX2  ! X66_ARET

  14013  4 000611                       WRITE_TWSNR* null
      305    14024                                                              /**/
      306    14025                                                              /**/
      307    14026    1   WRITE_TWSNR_ERR: ;
      308    14027    1   CALL ASH$ERROR( ERR_CODE ) ;

  14027  4 000611   000023 630400 5                  EPPR0   19
         4 000612   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000613   000000 701000 xent               TSX1    ASH$ERROR
         4 000614   000000 011000                    NOP     0

      309    14028    1   RETURN ;

  14028  4 000615   000000 702200 xent               TSX2  ! X66_ARET
      310    14029                                                              /**/
      311    14030                                                              /**/
      312    14031    1   END   ASA$CONSOLE ;
      313    14032        %EOD;

PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:47   
--  Include file information  --

   QQ_SUPER_C.:E05TOU  is referenced.
   OC$INFO.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$CONSOLE.
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:48   

 **** Variables and constants ****

  ****  Section 002  Data  ASA$CONSOLE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(90)    r     1 CON_KEY

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/w UBIN        r     1 ARS                       20-0-0/w PTR         r     1 BLK$
    12-0-0/w UBIN        r     1 CON_ARS                 2026-0-0/c STRC(81)    r     1 CON_NAME
     3-0-0/b BIT         r     1 CREATE                  2021-0-0/w PTR         r     1 DREC$
    15-0-0/w UBIN        r     1 I                         16-0-0/w UBIN        r     1 J
    21-0-0/c CHAR(4096)  r     1 KLDREC                    17-0-0/b BIT         r     1 LOCAL
     5-0-0/c CHAR(8)     r     1 SNAME                   2022-0-0/w PTR         r     1 TREC$
    10-0-0/w UBIN        r     1 TWSN#                      7-0-0/c CHAR(4)     r     1 TWSNC
  2025-0-0/w PTR         r     1 TWSNR$                    13-0-0/w UBIN        r     1 TWSN_ARS
    11-0-0/w UBIN        r     1 TWSN_INDEX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/c CHAR(20)    r     1 AS_CREATED_TEXT
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w STRC(369)   r     1 AS_FIELD2                  0-0-0/w STRC(369)   r     1 AS_FIELD3
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w UBIN        r     1 CONSOLE_CMD
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w UBIN        r     1 DSEG2SIZE
     0-0-0/b BIT         r     1 DSEG_FLG                   0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/w STRC(576)   r     1 KL_DREC_CNT                0-0-0/w PTR         r     1 NODE$
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:49   
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2016)  r     1 KL$DREC                    0-0-0/w STRC(576)   r     1 KL$TREC
     0-0-0/w STRC(576)   r     1 KL$TWSNREC                 0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE


   Procedure ASA$CONSOLE requires 398 words for executable code.
   Procedure ASA$CONSOLE requires 1058 words of local(AUTO) storage.
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:50   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:51   
          MINI XREF LISTING

ARS
     13249**DCL     13803<<ASSIGN  13805<>CALL    13807<>CALL    13831>>ASSIGN  13927<<ASSIGN  13928<>CALL
ASA$CON_OPTS
     13286**DCL-ENT 13994--CALL
ASA_BRKS_LOC
     10033**DCL     10033--REDEF
ASB$CHECK_TYPE
     13316**DCL-ENT 13807--CALL
ASB$DEQ_HLP
     13292**DCL-ENT 14011--CALL
ASB$ENQ_HLP
     13289**DCL-ENT 13804--CALL    13965--CALL    14009--CALL
ASB$FIND_TWSN_INDEX
     13304**DCL-ENT 13991--CALL
ASB$GETSEG
     13301**DCL-ENT 13751--CALL
ASB$READ_HLP
     13295**DCL-ENT 13805--CALL    13928--CALL    13966--CALL
ASB$WRITE_HLP
     13298**DCL-ENT 14003--CALL    14010--CALL
ASB$WRITE_LO
     13313**DCL-ENT 14014--CALL
ASH$ERROR
     13307**DCL-ENT 13737--CALL    13767--CALL    13792--CALL    13826--CALL    13878--CALL    13951--CALL
     13981--CALL    14027--CALL
ASH$WARN
     13310**DCL-ENT 13849--CALL    13905--CALL
AS_BLANK
      9893**DCL     13890>>CALLBLT
AS_CREATED_TEXT
      9907**DCL     14014<>CALL    14014--CALL
AS_DEFAULT.BANNER_PERM
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:52   
     10726**DCL     10727--REDEF
AS_DEFAULT.BUDGET.MACCT
     10631**DCL     10635--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10644**DCL     10647--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10627**DCL     10629--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10622**DCL     10624--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10742**DCL     10743--REDEF   10744--REDEF
AS_DEFAULT_DREC.PASSWORD
     11996**DCL     12000--REDEF
AS_DEFAULT_DREC.RENAME
     12019**DCL     12020--REDEF
AS_DFLT.BANNER_PERM
     10548**DCL     10549--REDEF
AS_DFLT.BUDGET.MACCT
     10453**DCL     10457--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10466**DCL     10469--REDEF
AS_DFLT.BUDGET.PACCUM
     10449**DCL     10451--REDEF
AS_DFLT.BUDGET.PMAXC
     10444**DCL     10446--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10564**DCL     10565--REDEF   10566--REDEF
AS_FALSE
      9893**DCL     13747>>ASSIGN  13922>>ASSIGN  13991<>CALL
AS_FE_MODE
      9899**DCL      9900--REDEF
AS_FIELD1
     10029**DCL     13813<<ASSIGN  13889<<ASSIGN  13968<<ASSIGN
AS_FIELD1.COUNT
     10030**DCL     13936<<ASSIGN  13937<<ASSIGN
AS_FIELD1.TEXT
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:53   
     10030**DCL     13938<<ASSIGN
AS_FIELD2.COUNT
     10030**DCL     13891<<ASSIGN
AS_FIELD2.TEXT
     10030**DCL     13892<<ASSIGN
AS_FIELD3.COUNT
     10031**DCL     13893<<ASSIGN
AS_FIELD3.TEXT
     10031**DCL     13894<<ASSIGN
AS_MODE
      9896**DCL      9898--REDEF
AS_MOD_USER.ACCESS
     12761**DCL     12762--REDEF
AS_MOD_USER.BANNER
     12748**DCL     12749--REDEF
AS_MOD_USER.BANNER_PERM
     12750**DCL     12751--REDEF
AS_MOD_USER.BILL
     12756**DCL     12757--REDEF
AS_MOD_USER.CPROC
     12752**DCL     12753--REDEF
AS_MOD_USER.FEBILL
     12832**DCL     12833--REDEF
AS_MOD_USER.FECXTMEM
     12849**DCL     12850--REDEF
AS_MOD_USER.FEMINTS
     12834**DCL     12835--REDEF
AS_MOD_USER.FEMMEM
     12845**DCL     12846--REDEF
AS_MOD_USER.FEMTIME
     12843**DCL     12844--REDEF
AS_MOD_USER.FEPPRIV
     12840**DCL     12842--REDEF
AS_MOD_USER.FEPRIV
     12837**DCL     12839--REDEF
AS_MOD_USER.FORCE_BIT
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:54   
     12746**DCL     12747--REDEF
AS_MOD_USER.KEY
     12828**DCL     12830--REDEF
AS_MOD_USER.LASTCPROC
     12754**DCL     12755--REDEF
AS_MOD_USER.LIMITS.DO_
     12802**DCL     12803--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12818**DCL     12819--REDEF
AS_MOD_USER.LIMITS.LO
     12798**DCL     12799--REDEF
AS_MOD_USER.LIMITS.MEM
     12794**DCL     12795--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12822**DCL     12823--REDEF
AS_MOD_USER.LIMITS.PDIS
     12810**DCL     12811--REDEF
AS_MOD_USER.LIMITS.PO
     12806**DCL     12807--REDEF
AS_MOD_USER.LIMITS.TDIS
     12814**DCL     12815--REDEF
AS_MOD_USER.LIMITS.TIME
     12790**DCL     12791--REDEF
AS_MOD_USER.MAXENQ
     12771**DCL     12772--REDEF
AS_MOD_USER.PERM_BIT
     12744**DCL     12745--REDEF
AS_MOD_USER.PPRIV
     12766**DCL     12768--REDEF
AS_MOD_USER.PRIOB
     12773**DCL     12774--REDEF
AS_MOD_USER.PRIV
     12763**DCL     12765--REDEF
AS_MOD_USER.QUAN
     12769**DCL     12770--REDEF
AS_MOD_USER.SETUP
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:55   
     12742**DCL     12743--REDEF
AS_PROJECT.BANNER_PERM
     11082**DCL     11083--REDEF
AS_PROJECT.BUDGET.MACCT
     10987**DCL     10991--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11000**DCL     11003--REDEF
AS_PROJECT.BUDGET.PACCUM
     10983**DCL     10985--REDEF
AS_PROJECT.BUDGET.PMAXC
     10978**DCL     10980--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11098**DCL     11099--REDEF   11100--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11260**DCL     11261--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11165**DCL     11169--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11178**DCL     11181--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11161**DCL     11163--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11156**DCL     11158--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11276**DCL     11277--REDEF   11278--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12482**DCL     12486--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12505**DCL     12506--REDEF
AS_PROJECT_DREC.PASSWORD
     12320**DCL     12324--REDEF
AS_PROJECT_DREC.RENAME
     12343**DCL     12344--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10904**DCL     10905--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:56   
     10809**DCL     10813--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10822**DCL     10825--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10805**DCL     10807--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10800**DCL     10802--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10920**DCL     10921--REDEF   10922--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12158**DCL     12162--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12181**DCL     12182--REDEF
AS_TRUE
      9893**DCL     13745>>ASSIGN  13854>>ASSIGN  13920>>ASSIGN
AS_USERS.BANNER_PERM
     10370**DCL     10371--REDEF
AS_USERS.BUDGET.MACCT
     10275**DCL     10279--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10288**DCL     10291--REDEF
AS_USERS.BUDGET.PACCUM
     10271**DCL     10273--REDEF
AS_USERS.BUDGET.PMAXC
     10266**DCL     10268--REDEF
AS_USERS.SETUP_CHRA.TXT
     10386**DCL     10387--REDEF   10388--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11438**DCL     11439--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11343**DCL     11347--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11356**DCL     11359--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11339**DCL     11341--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:57   
     11334**DCL     11336--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11454**DCL     11455--REDEF   11456--REDEF
BLK$
     13253**DCL     13377--IMP-PTR 13774<<ASSIGN  13775>>IF      13797>>ASSIGN  13798>>ASSIGN  13798>>ASSIGN
     13799>>ASSIGN  13799>>ASSIGN  13862<<ASSIGN  13863>>IF      13883>>ASSIGN  13883>>ASSIGN  13893>>ASSIGN
     13894>>ASSIGN  13894>>ASSIGN
CONSOLE_CMD
     13268**DCL     13735--ASSIGN
CON_ARS
     13247**DCL     13831<<ASSIGN  14008<<ASSIGN  14010<>CALL
CON_KEY
     13274**DCL     13801>>ASSIGN  14007>>ASSIGN
CON_KEY.TXT.ACCT
     13277**DCL     13799<<ASSIGN  13991<>CALL    14000>>ASSIGN
CON_NAME
     13260**DCL     13807<>CALL    13813>>ASSIGN  13889>>ASSIGN
CON_NAME.COUNT
     13261**DCL     13797<<ASSIGN
CON_NAME.TEXT
     13262**DCL     13798<<ASSIGN
CREATE
     13241**DCL     13745<<ASSIGN  13747<<ASSIGN  13807<>CALL    13808>>IF      13835>>IF      13854<<ASSIGN
     13884>>IF      13914>>IF      13988>>IF      13994<>CALL    13996>>IF      14006>>IF      14013>>IF
DEQ_ERR2
     14013**LABEL   14011--CALLALT
DREC$
     13255**DCL     13534--IMP-PTR 13802<<ASSIGN  13805<>CALL    13807<>CALL    13884>>IF      13890>>CALLBLT
     13892>>ASSIGN  13910>>ASSIGN  13916>>ASSIGN  13991<>CALL    13994<>CALL    14006>>ASSIGN  14008>>ASSIGN
     14010<>CALL
DSEG1$
     10034**DCL     13832>>ASSIGN  13926>>ASSIGN
DSEG1SIZE
     10035**DCL     13927>>ASSIGN
DSEG2$
     10035**DCL     13963>>ASSIGN
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:58   
DSEG2SIZE
     10035**DCL     13964>>ASSIGN
DSEG_FLG
     10034**DCL     13749>>IF
ENQ_ERR2
     14013**LABEL   13804--CALLALT 13965--CALLALT 14009--CALLALT
ERR_CODE
     10028**DCL     10029--REDEF   14027<>CALL
EXIT#
     14016**LABEL   13807--CALLALT 13991--CALLALT
I
     13250**DCL     13890<<CALLBLT 13891>>ASSIGN
J
     13251**DCL     13934<<CALLBLT 13935>>IF      13936>>ASSIGN
KL$DREC.NWINFO
     13632**DCL     14008>>ASSIGN
KL$DREC.PASSWORD
     13592**DCL     13596--REDEF
KL$DREC.RENAME
     13615**DCL     13616--REDEF
KL$DREC.SNAME
     13629**DCL     13884>>IF      13890>>CALLBLT 13892>>ASSIGN  13910>>ASSIGN  13916>>ASSIGN  14006<<ASSIGN
KL$TREC.PASSWORD
     13479**DCL     13483--REDEF
KL$TREC.RENAME
     13502**DCL     13503--REDEF
KL$TREC.TWSN#
     13476**DCL     13958>>ASSIGN
KL$TWSNREC.DEVS
     13707**DCL     13998--ASSIGN
KL$TWSNREC.DEVS.ACCT
     13721**DCL     14000<<ASSIGN
KL$TWSNREC.NDEV
     13706**DCL     13989>>ASSIGN  13997<<ASSIGN
KLDREC
     13254**DCL     13802--ASSIGN  13803--ASSIGN
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:59   
KL_DEFAULT.PASSWORD
     12644**DCL     12648--REDEF
KL_DEFAULT.RENAME
     12667**DCL     12668--REDEF
KL_DFLT.PASSWORD
     11834**DCL     11838--REDEF
KL_DFLT.RENAME
     11857**DCL     11858--REDEF
KL_DREC.PASSWORD
     11672**DCL     11676--REDEF
KL_DREC.RENAME
     11695**DCL     11696--REDEF
KL_DREC_CNT
     11501**DCL     14008--ASSIGN
KL_DREC_CNT.PASSWORD
     11559**DCL     11563--REDEF
KL_DREC_CNT.RENAME
     11582**DCL     11583--REDEF
LOCAL
     13252**DCL     13920<<ASSIGN  13922<<ASSIGN  13994<>CALL
NODE$
     10026**DCL     13330--IMP-PTR 13742<<ASSIGN  13743>>IF      13774>>ASSIGN  13859>>IF      13862>>ASSIGN
OUT$SYM.COUNT
     13400**DCL     13403--IMP-SIZ 13775>>IF      13797>>ASSIGN  13798>>ASSIGN  13799>>ASSIGN  13863>>IF
     13883>>ASSIGN  13893>>ASSIGN  13894>>ASSIGN
OUT$SYM.TEXT
     13403**DCL     13798>>ASSIGN  13799>>ASSIGN  13883>>ASSIGN  13894>>ASSIGN
P$NODE.CODE
     13338**DCL     13743>>IF
P$NODE.SUBLK$
     13363**DCL     13774>>ASSIGN  13774>>ASSIGN  13862>>ASSIGN  13862>>ASSIGN
P$NODE.SUBNODES
     13342**DCL     13859>>IF
PROJ_KEY.TEXT
      9906**DCL      9906--REDEF
PROJ_KEY.TXT.PROJECT
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:60   
      9906**DCL      9906--REDEF
P_PCB
     10061**DCL     13736<>CALL
P_PCB.ERROR
     10165**DCL     13737<>CALL
P_PCB.OUT$
     10074**DCL     13742>>ASSIGN
P_PCB.ROOT$
     10066**DCL     13735<<ASSIGN
REMEM_VAR
     10032**DCL     10032--REDEF
REM_FCMD
     10032**DCL     10033--REDEF
SNAME
     13243**DCL     13883<<ASSIGN  13884>>IF      13910<<ASSIGN  13915<<ASSIGN  13916<<ASSIGN  13918>>IF
     13923>>CALLBLT 14006>>ASSIGN
TREC$
     13256**DCL     13421--IMP-PTR 13832<<ASSIGN  13926<<ASSIGN  13928<>CALL    13958>>ASSIGN  13991<>CALL
TWSN#
     13245**DCL     13959<<CALLBLT
TWSNC
     13244**DCL     13958<<ASSIGN  13959>>CALLBLT 13961>>CALLBLT 13994<>CALL    14001>>CALLBLT
TWSNR$
     13259**DCL     13703--IMP-PTR 13963<<ASSIGN  13966<>CALL    13989>>ASSIGN  13991<>CALL    13994<>CALL
     13997>>ASSIGN  14000>>ASSIGN  14003<>CALL
TWSN_ARS
     13248**DCL     13964<<ASSIGN  13966<>CALL    13998<<ASSIGN  13998>>ASSIGN  14003<>CALL
TWSN_INDEX
     13246**DCL     13989<<ASSIGN  13991<>CALL    13994<>CALL    13997>>ASSIGN  14000>>ASSIGN
USERS_KEY
      9903**DCL     13801<<ASSIGN  13968>>ASSIGN  14007<<ASSIGN
USERS_KEY.COUNT
      9903**DCL     13924<<ASSIGN  13962<<ASSIGN  14002<<ASSIGN
USERS_KEY.TEXT
      9903**DCL      9904--REDEF    9904--REDEF    9904--REDEF    9905--REDEF
USERS_KEY.TXTC
PL6.E3A0      #001=ASA$CONSOLE File=ASA$CONSOLE.:E05TSI                          TUE 07/29/97 08:33 Page:61   
      9904**DCL     13923<<CALLBLT 13934>>CALLBLT 13938>>ASSIGN  13961<<CALLBLT 14001<<CALLBLT
WRITE_TWSNR_ERR
     14013**LABEL   14003--CALLALT 14010--CALLALT
X$PARSE
     13284**DCL-ENT 13736--CALL

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:62   
      314        1        /*T***********************************************************/
      315        2        /*T*                                                         */
      316        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      317        4        /*T*                                                         */
      318        5        /*T***********************************************************/
      319        6        /*P*     NAME:  ASA$CON_OPTS
      320        7                 PURPOSE: This module of SUPER processes the options of the
      321        8                          'CREATE CONSOLE' command and the sub-options of the
      322        9                          'CONSOLE' option of the 'CREATE TERMINAL' command.
      323       10                          It is called from ASA$CONSOLE or ASA$TERMINAL.
      324       11                          The parameters are:
      325       12                            TREC$  A pointer the the console record (KL$DREC).
      326       13                            TWSNR$  A pointer to the the TWSN record.
      327       14                            TWSNC   The twsn number, in character.
      328       15                            CREATE  A bit that tells if we are creating
      329       16                                    this console.
      330       17                            SUB     A bit that tells if we are being
      331       18                                    called from ASA$TERMINAL.
      332       19                            TERM_T  The type of terminal, used to set
      333       20                                    the default PROFILE.
      334       21                            LOCAL   A bit that tells that this console is
      335       22                                    for terminal LOCAL.
      336       23                            TWSN_INDEX   The TWSN record index for the device.
      337       24                                         Valid only if CREATE is false.
      338       25                            SS      A terminal sign-on block for a terminal
      339       26                                    device.  Valid only if SUB=true.
      340       27                            DADR$   A pointer to a KL_DADR structure position.
      341       28                                    Valid only if SUB=true.
      342       29        */
      343       30        ASA$CON_OPTS: PROC(TREC$,TWSNR$,TWSNC,CREATE,SUB,TERM_T,LOCAL,TWSN_INDEX,SS,DADR$);
      344       31                                                                                    /**/
      345       32        %SET LISTSUB = '1'B ;
      346       33        /*********************************************************************/
      347       34        /*   Include files   include files   include files   include files   */
      348       35        /*********************************************************************/
      349       36                                                                                    /**/
      350       37              %INCLUDE  AS_ENTRIES_M  ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:63   
      351     1087              %INCLUDE  AS_PERR_C     ;
      352     1689              %INCLUDE  AS_SSUBS_C    ;
      353     1781              %INCLUDE  AS_SUBS_C     ;
      354     3195              %INCLUDE  KL_SUPER_C    ;
      355     6097              %INCLUDE  XU_FORMAT_C   ;
      356     6259              %INCLUDE  XU_MACRO_C    ;
      357     9365              %INCLUDE  AS_MAC_C      ;
      358     9445              %INCLUDE  AS_SUPER_C    ;
      359     9880              %INCLUDE  AS_SUPER_R    ;
      360    12896              %INCLUDE  B_MACROS_C    ;
      361    13007              %INCLUDE  CP_6          ;
      362    13088              %INCLUDE  KC$CGBLK      ;
      363    13136              %INCLUDE  OC$INFO       ;
      364    13192              %INCLUDE  OCI_SUBS_C    ;
      365    13290        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:64   
      366    13291        /*********************************************************************/
      367    13292        /*   Parameters      parameters      parameters      paramaters      */
      368    13293        /*********************************************************************/
      369    13294                                                                                    /**/
      370    13295    1   DCL TREC$ PTR ;
      371    13296    1   DCL TWSNR$ PTR ;
      372    13297    1   DCL TWSNC CHAR(4) ;
      373    13298    1   DCL CREATE BIT(1) ALIGNED;
      374    13299    1   DCL SUB BIT(1) ALIGNED;
      375    13300    1   DCL LOCAL BIT(1) ALIGNED;
      376    13301    1   DCL TERM_T CHAR(7) ;
      377    13302    1   DCL TWSN_INDEX SBIN ;
      378    13303        %KL_SS (NAME=SS,STCLASS=PARAM);
      379    13338    1   DCL DADR$  PTR;
      380    13339
      381    13340        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:65   
      382    13341        /*********************************************************************/
      383    13342        /*   Auto data       auto data       auto data       auto data       */
      384    13343        /*********************************************************************/
      385    13344                                                                                    /**/
      386    13345    1   DCL TYPE CHAR(2) ;
      387    13346    1   DCL NUM CHAR(2) ;
      388    13347    1   DCL ARS UBIN WORD ;
      389    13348    1   DCL I UBIN WORD ;
      390    13349    1   DCL CODE2 UBIN WORD ;
      391    13350    1   DCL CNT UBIN WORD ;
      392    13351    1   DCL PTR$ PTR ;
      393    13352    1   DCL MORE BIT(1) ;
      394    13353    1   DCL KCADDR BIT(18);
      395    13354    1   DCL CADDR BIT(18);
      396    13355    1   DCL PATTR BIT(18) ;
      397    13356    1   DCL 1 IO,
      398    13357    1          2 INPUT BIT(1),
      399    13358    1          2 OUTPUT BIT(1);
      400    13359    1   DCL DDEV BIT(9);
      401    13360    1   DCL MASK BIT(36) ;
      402    13361    1   DCL BLK$ PTR ;
      403    13362    1   DCL WSNCVT$ PTR ;
      404    13363    1   DCL PRO$ PTR ;
      405    13364    1   DCL PRO_BUF CHAR(1024 /* AS_PRO_BUF_SIZEC */);
      406    13365    1   DCL WORK$ PTR;
      407    13366    1   DCL WKSZ UBIN;
      408    13367    1   DCL WK_USED UBIN;
      409    13368    1   DCL ROOT$ PTR;
      410    13369    1   DCL T_NODE$ PTR;
      411    13370    1   DCL C_WSN_FLG BIT(1);
      412    13371    1   DCL C_SYS_FLG BIT(1);
      413    13372    1   DCL COMMAND CHAR(80);
      414    13373    1   DCL 1 SPLIT ,
      415    13374    1          2 * UBIN(1) UNAL ,
      416    13375    1          2 T UBIN(8) UNAL ,
      417    13376    1          2 * UBIN(1) UNAL ,
      418    13377    1          2 B UBIN(8) UNAL ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:66   
      419    13378    1   DCL HEX(0:255) UBIN BYTE UNAL;
      420    13379    1   DCL 1 OPTION,
      421    13380    1          2 COUNT UBIN BYTE CALIGNED,
      422    13381    1          2 TEXT  CHAR(31)  CALIGNED;
      423    13382    1   DCL P$  PTR;
      424    13383    1   DCL TEMP   UBIN WORD;
      425    13384    1   DCL TEMP$   PTR;
      426    13385    1   DCL ACHAR    CHAR(1) BASED;
      427    13386    1   DCL J       UBIN WORD;
      428    13387    1   DCL K       UBIN WORD;
      429    13388    1   DCL L       UBIN WORD;
      430    13389        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:67   
      431    13390        /*********************************************************************/
      432    13391        /*   Symref's        symref's        symref's        symref's        */
      433    13392        /*********************************************************************/
      434    13393                                                                                    /**/
      435    13394    1   DCL CONSOLE_OPTS_LIST SYMREF UBIN WORD ;
      436    13395        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:68   
      437    13396        /*********************************************************************/
      438    13397        /*   Static data     static data     static data     static data     */
      439    13398        /*********************************************************************/
      440    13399                                                                                    /**/
      441    13400        %SET LISTSUB='1'B ;
      442    13401              %KL_DREC( NAME = KL_CREC ,
      443    13402                        STCLASS = CONSTANT ,
      444    13403                        TYP = %KLAT_CG# ,
      445    13404                        SUPR = AS_CON# ,
      446    13405                        RN = '1'B ,
      447    13406                        LAST = ","  );
      448    13519              %KC$CGID(FPTN=KC_CGID,
      449    13520                       STCLASS=CONSTANT,
      450    13521                        LVL = 2 ,
      451    13522                        LAST = "," ) ;
      452    13548              %OC$INFO (FPTN = OCINFO,
      453    13549                        STCLASS=CONSTANT ,
      454    13550                        LVL = 2 ) ;
      455    13587    1   DCL Z_ACCT(0:1) UBIN WORD CONSTANT INIT(0*0);
      456    13588        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:69   
      457    13589        /********************************************************************/
      458    13590        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      459    13591        /*********************************************************************/
      460    13592                                                                                    /**/
      461    13593    1   DCL X$PARSE ENTRY(1) ALTRET ;
      462    13594        %ASB$FIND_NUM ;
      463    13597        %ASB$GET_HEX_VAL ;
      464    13600        %ASB$READ_SI ;
      465    13603        %ASB$SET_PROMPT ;
      466    13606        %ASD$READ_PRO ;
      467    13609        %ASH$ERROR ;
      468    13612        %ASH$WARN ;
      469    13615        %ASH$HELP ;
      470    13618        %ASH$QUEST ;
      471    13621        %ASH$DQUEST ;
      472    13624        %ASZ$SCRAMBLE ;
      473    13627        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:70   
      474    13628        /*********************************************************************/
      475    13629        /*   Local based     local based     local based     local based     */
      476    13630        /*********************************************************************/
      477    13631                                                                                    /**/
      478    13632            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      479    13633                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      480    13678              %PARSE$SYM( NAME = OUT$SYM ,
      481    13679                          STCLASS="BASED(BLK$)") ;
      482    13717              %KL_DREC( NAME = KL$TREC ,
      483    13718                        STCLASS="BASED( TREC$ )",
      484    13719                        LAST = "," ) ;
      485    13832              %KC$CGID(FPTN=KC$CGID,
      486    13833                        LVL = 2 ,
      487    13834                        LAST = "," );
      488    13860              %OC$INFO(FPTN = OCINFO,
      489    13861                        LVL = 2 ) ;
      490    13898        %KL_DADR ( NAME = KL$DADR,
      491    13899                   STCLASS="BASED(DADR$)",
      492    13900                   LVL = 1,
      493    13901                   LAST = ";" );
      494    13949              %KL_TWSNREC(  NAME = KL$TWSNREC ,
      495    13950                            STCLASS="BASED( TWSNR$ )") ;
      496    13975              %KL_PHDR ( NAME = KL$PHDR ,
      497    13976                        STCLASS="BASED( PRO$ )") ;
      498    14017        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:71   
      499    14018        /*********************************************************************/
      500    14019        /*   Procedure       procedure       procedure       procedure       */
      501    14020        /*********************************************************************/
      502    14021                                                                                    /**/
      503    14022        /*
      504    14023            ***            Begin procedure                    ***
      505    14024        */
      506    14025    1   WORK$ = P_PCB.WORK$ ;
      507    14026    1   WKSZ = P_PCB.WKSZ ;
      508    14027    1   WK_USED = P_PCB.WK_USED ;
      509    14028    1   ROOT$ = P_PCB.ROOT$ ;
      510    14029                                                /* Bump past area used.               */
      511    14030    1   P_PCB.WORK$ = PINCRW( WORK$, P_PCB.WK_USED ) ;
      512    14031    1   P_PCB.WKSZ = WKSZ - P_PCB.WK_USED ;
      513    14032                                                /* Save NODE$                         */
      514    14033    1   T_NODE$ = NODE$ ;
      515    14034    1   MORE = AS_TRUE ;
      516    14035    1   TYPE='OC';
      517    14036    1   C_WSN_FLG = AS_FALSE;
      518    14037    1   C_SYS_FLG = AS_FALSE;
      519    14038                                                                                    /**/
      520    14039    2   IF CREATE THEN DO;
      521    14040    2      KL$TREC = KL_CREC;
      522    14041    2      IO='11'B;
      523    14042    2      PATTR='0'B;
      524    14043    2      DDEV='0'B;
      525    14044    2      KL$TREC.PNAME.CNT = 0;
      526    14045    2      KL$TREC.PNAME.TXT = ' ' ;
      527    14046    2      CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD );
      528    14047    2      KL$TREC.KC$CGID.NAME#.CNT = 0 ;
      529    14048    2      KL$TREC.OCINFO.TNAME =KL$TWSNREC.STATION ;
      530    14049    2      KL$TREC.RENAME=' ';
      531    14050    2      KL$TREC.TWSN# = TWSNC;
      532    14051    2      CALL ASB$FIND_NUM(TWSNR$,TYPE,NUM)
      533    14052    3      WHENALTRETURN DO;
      534    14053              %SCREAM(ERR#=E$UNABLE_FIND_NUMBER, LEVEL=ERROR, MID='A');
      535    14068    3         RETURN;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:72   
      536    14069    3         END;  /*  Whenaltreturn  */
      537    14070    2      CALL CONCAT(KL$TREC.RENAME,TYPE,NUM,TWSNC);
      538    14071    2      FROM_KEY.TEXT = KL$TREC.RENAME ;
      539    14072    2      CADDR  = '040000'O /* K_ADMIN */ | '100000'O /* K_DEVC  */ ;
      540    14073    2      KCADDR = '100000'O /* K_DEVC  */ ;
      541    14074    2      KL$TREC.OCINFO.MXPRI=%KLOC_DFPRI;
      542    14075    3      IF SUB THEN DO;
      543    14076    3         CALL CONCAT(KL$TREC.PNAME.TXT,TERM_T,'OC');
      544    14077    3         KL$TREC.PNAME.CNT=6;
      545    14078    3         IF CREATE THEN
      546    14079    4            IF TERM_T = 'STDHASP' THEN DO;
      547    14080    4               KL$DADR.DEVNUM# = %KLDN_HASPOC#;
      548    14081    4               KL$DADR.DEVCTL.B = %KLDCB_HASPOC#;
      549    14082    4               KL$DADR.DEVCTL.T = '0'B;
      550    14083    4               END; /*  Term type is stdhasp  */
      551    14084    3         END;
      552    14085    2      END;
      553    14086    2   ELSE DO;
      554    14087    2      TWSNC = KL$TREC.TWSN#;
      555    14088    2      NUM = SUBSTR(KL$TREC.RENAME,2,2);
      556    14089    2      PATTR= KL$TWSNREC.DEVS.ATTR(TWSN_INDEX) ;
      557    14090    2      IO   = KL$TWSNREC.DEVS.IO(TWSN_INDEX) ;
      558    14091    2      DDEV = KL$TWSNREC.DEVS.DDEV(TWSN_INDEX) ;
      559    14092    2      END;
      560    14093    1   KL$TWSNREC.DEVS(TWSN_INDEX) = '0'B ;
      561    14094    1   KL$TREC.KC$CGID.NAME#.TXT = 'OCCG' ;
      562    14095    1   KL$TREC.KC$CGID.NAME#.CNT = 4 ;
      563    14096    1   KL$TREC.KC$CGID.ACCT# = ':SYS' ;
      564    14097    1   KL$TREC.KC$CGID.PSN# = AS_BLANK ;
      565    14098    1   P_PCB.ROOT$ = ADDR( CONSOLE_OPTS_LIST ) ;
      566    14099                                                /* Set prompt                         */
      567    14100    2   IF SUB THEN DO;
      568    14101    2      CALL ASB$SET_PROMPT ( %PROMPT_SUB );
      569    14102    2      END;
      570    14103    2   ELSE DO;
      571    14104    2      CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;
      572    14105    2      END;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:73   
      573    14106    1   REMEMBER CON_LOOP IN REMEM_VAR ;
      574    14107    1   CON_LOOP:
      575    14108                                                                                    /**/
      576    14109    2   DO WHILE( MORE ) ;
      577    14110                                                /* Read input                         */
      578    14111    2      CALL ASB$READ_SI( IN_BUF, ARS ) ;
      579    14112    2      P_PCB.NCHARS = ARS ;
      580    14113    2      CALL X$PARSE( P_PCB )
      581    14114    3      WHENALTRETURN DO;
      582    14115    3         CALL ASH$ERROR( P_PCB.ERROR ) ;
      583    14116    3         GOTO CON_LOOP ;
      584    14117    3         END; /*  Whenaltreturn  */
      585    14118                                                                                    /**/
      586    14119    2      NODE$ = P_PCB.OUT$ ;
      587    14120    3      DO I = 0 TO P$NODE.SUBNODES-1 ;
      588    14121    3         PTR$ = P$NODE.SUBLK$(I) ;
      589    14122    3         CODE = PTR$ -> P$NODE.CODE ;
      590    14123                                                              /* Check if slave is set. */
      591    14124    3         IF KL$TREC.OCINFO.CADDR = '002000'O /* K_SLAVE */
      592    14125    3         THEN
      593    14126    4         DO SELECT(CODE) ;                 /* Stop the following options. */
      594    14127    4            SELECT( 25 /* C_SYSTEM */,
      595    14128    4                 23 /* C_UADMIN */,
      596    14129    4                 27 /* C_PADMIN */,
      597    14130    4                 30 /* CONSOLE ADMIN  */,
      598    14131    4                 28 /* C_DEVICE */,
      599    14132    4                 21 /* C_TP */,
      600    14133    4                 29 /* C_COMM */ ) ;
      601    14134        /*E*  ERROR:    ASA-E$BADOPTSLVCON-C
      602    14135              MESSAGE0: Illegal option for SLAVE IRBT.
      603    14136        */
      604    14137                 %SCREAM( ERR#=E$BADOPTSLVCON, MID='A', LEVEL=ERROR );
      605    14152    4            GOTO END_OPTION ;
      606    14153    4            END ; /* Do case */
      607    14154    4         DO SELECT( CODE ) ;
      608    14155                                                                                    /**/
      609    14156    4            SELECT( 45 /* TCD_PRO_VAL */ ) ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:74   
      610    14157                                                /* Profile                            */
      611    14158    5            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE = 7   /*  NONE_VAL  */ THEN DO;
      612    14159    5               KL$TREC.PNAME.CNT=0;
      613    14160    5               KL$TREC.PNAME.TXT=' ';
      614    14161    5               GOTO END_OPTION;
      615    14162    5               END;  /*  Profile = none  */
      616    14163    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
      617    14164    4            CNT = OUT$SYM.COUNT ;
      618    14165    4            IF CNT > 11
      619    14166    4            THEN
      620    14167    5            DO ;
      621    14168                    %SCREAM( ERR#=E$PRO_TOO_LONG, MID='A', LEVEL=ERROR );
      622    14183    5               GOTO END_OPTION ;
      623    14184    5               END ;               /* Then do                            */
      624    14185                                                /* Check if profile exists            */
      625    14186    4            PRO$ = ADDR(PRO_BUF);
      626    14187    4            ARS=LENGTHC(PRO_BUF);
      627    14188    4            USERS_KEY.COUNT = OUT$SYM.COUNT ;
      628    14189    4            USERS_KEY.TXTC = OUT$SYM.TEXT ;
      629    14190    4            CALL ASD$READ_PRO( USERS_KEY, KL$PHDR, ARS )
      630    14191    5            WHENALTRETURN DO ;
      631    14192    5               AS_FIELD1 = USERS_KEY ;
      632    14193                    %SCREAM( ERR#=E$PRO_NO_EXIST, LEVEL=ERROR, MID='A' ) ;
      633    14208    5               GOTO CON_LOOP ;
      634    14209    5               END; /*  Whenaltreturn  */
      635    14210                                                                                    /**/
      636    14211                                                /* It exists                          */
      637    14212    5            IF SUB AND KL$PHDR.TTYP ~= %KLTY_SDEV# THEN DO;
      638    14213        /*E* ERROR: ASA-E$CONPROTYPE-0
      639    14214             MESSAGE: Profile must be of terminal-console type.
      640    14215             MESSAGE1: The profile be one that describes a terminal-console
      641    14216                       For example, IRBTOC or 2780OC.
      642    14217        */
      643    14218                    %SCREAM( ERR#=E$CONPROTYPE, MID='A', LEVEL=ERROR );
      644    14233    5               GOTO END_OPTION;
      645    14234    5               END;
      646    14235    5            IF NOT SUB AND (KL$PHDR.TTYP~=%KLTY_TTY# AND KL$PHDR.TTYP~=%KLTY_LINEDEV#)
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:75   
             14235                     THEN DO;
      647    14236                    %SCREAM( ERR#=E$ASYNCPROTYPE, MID='A', LEVEL=ERROR ) ;
      648    14251    5               GOTO END_OPTION;
      649    14252    5               END;
      650    14253    4            PATTR = KL$PHDR.ATTR ;
      651    14254    4            IO=KL$PHDR.IO;
      652    14255    4            DDEV=KL$PHDR.DDEV;
      653    14256    4            KL$TREC.PNAME = USERS_KEY ;
      654    14257                                                                                    /**/
      655    14258    4            SELECT( 16   /*  EOL_VAL  */ ) ;
      656    14259                                                              /**/
      657    14260    4            SELECT( 302 /* HELP_VAL */ ) ;
      658    14261    4            CALL ASH$HELP ;
      659    14262                                                              /**/
      660    14263    4            SELECT( 301 /* QUESTION_VAL */ ) ;
      661    14264    4            CALL ASH$QUEST ;
      662    14265                                                              /**/
      663    14266    4            SELECT( 300 /* DQUESTION_VAL */ ) ;
      664    14267    4            CALL ASH$DQUEST ;
      665    14268                                                                                    /**/
      666    14269    4            SELECT( 12   /*  END_VAL  */ ,
      667    14270    4                 26   /*  BLANK_LINE_VAL */ ) ;
      668    14271                                                /* Done                               */
      669    14272    4            MORE = AS_FALSE ;
      670    14273                                                                                    /**/
      671    14274                                                                                    /**/
      672    14275    4            SELECT( 33 /* TERM_PASS */ ) ;
      673    14276                                                /* Password                           */
      674    14277    5            IF SUB THEN DO;
      675    14278        /*   ERROR: ASA-E$DEVSUBPASS-0
      676    14279             MESSAGE: The password option is not legal.
      677    14280             MESSAGE1: Passwords dont make sense for devices that cant log on.
      678    14281        */
      679    14282                    %SCREAM( ERR#=E$DEVSUBPASS, LEVEL=ERROR, MID='A' ) ;
      680    14297    5               GOTO END_OPTION;
      681    14298    5               END;
      682    14299    4            CODE2 = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:76   
      683    14300    5            DO SELECT( CODE2 ) ;
      684    14301                                                                                    /**/
      685    14302    5               SELECT( 7   /*  NONE_VAL  */ ) ;
      686    14303    5               KL$TREC.PASSWORD = AS_BLANK ;
      687    14304    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;
      688    14305                                                                                    /**/
      689    14306    5               SELECT( 43 /* TERM_PW */ ) ;
      690    14307    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
      691    14308    5               CNT =  OUT$SYM.COUNT ;
      692    14309    5               IF CNT > 8
      693    14310    5               THEN
      694    14311    6               DO ;
      695    14312                       %SCREAM( ERR#=E$PASSW_TOO_LONG, MID='A', LEVEL=ERROR);
      696    14327    6                  GOTO END_OPTION ;
      697    14328    6                  END ;            /* Then do                            */
      698    14329    5               KL$TREC.PASSWORD = OUT$SYM.TEXT ;
      699    14330    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;
      700    14331                                                                                    /**/
      701    14332    5               SELECT( 47   /*  OCT_PASS_VAL */ ) ;
      702    14333    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);
      703    14334    5               CNT = OUT$SYM.COUNT;
      704    14335    6               IF CNT ~= 24 THEN DO;
      705    14336        /*E*  ERROR:    AS-E$OCTAL_PASSWORD_LENGTH_ERR-C
      706    14337              MESSAGE: PASSWORD not the right size.
      707    14338              MESSAGE1: PASSWORD in octal form must be 24 characters long.
      708    14339        */
      709    14340                       %SCREAM(ERR#=E$OCTAL_PASSWORD_LENGTH_ERR,LEVEL=ERROR,MID='A');
      710    14355    6                  END; /*  Length error  */
      711    14356    6               ELSE DO;
      712    14357    6                  P$ = ADDR ( OUT$SYM.TEXT );
      713    14358    6                  PTR$ = PINCRC (P$,24);
      714    14359    6                  TEMP$ = ADDR (KL$TREC.PASSWORD);
      715    14360    7                  DO WHILE P$ < PTR$ ;
      716    14361    7                     CALL CHARBIN (L, P$->ACHAR);
      717    14362    7                     P$ = PINCRC (P$,1);
      718    14363    7                     CALL CHARBIN (J, P$-> ACHAR);
      719    14364    7                     P$ = PINCRC (P$,1);
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:77   
      720    14365    7                     CALL CHARBIN (K, P$->ACHAR);
      721    14366    7                     TEMP = L * 64 + J * 8 + K;
      722    14367    7                     P$ = PINCRC (P$, 1);
      723    14368    7                     TEMP$ -> ACHAR = BINASC ( TEMP );
      724    14369    7                     TEMP$ = PINCRC (TEMP$, 1);
      725    14370    7                     END; /*  Do while P$ < PTR$  */
      726    14371    6                  END; /*  Length ok  */
      727    14372    5               END ;                 /* Do case( CODE2 )                   */
      728    14373                                                                                    /**/
      729    14374    4            SELECT( 49 /* TCD_MAXPRIO */ ) ;
      730    14375    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
      731    14376    4            CALL CHARBIN( CNT, OUT$SYM.TEXT ) ;
      732    14377    4            IF CNT > 15
      733    14378    4            THEN
      734    14379    5            DO ;
      735    14380        /*E*  ERROR:    ASA-E$MAXPRIO_TOO_BIG-C
      736    14381              MESSAGE:  MAXPRIO too big.
      737    14382              MESSAGE1: MAXPRIO may not exceed 15.
      738    14383        */
      739    14384                    %SCREAM( ERR#=E$MAXPRIO_TOO_BIG, LEVEL=ERROR, MID='A' ) ;
      740    14399    5               GOTO END_OPTION ;
      741    14400    5               END ;               /* Then do                            */
      742    14401    4            KL$TREC.OCINFO.MXPRI = CNT ;
      743    14402                                                                                    /**/
      744    14403    4            BLK$= PTR$->P$NODE.SUBLK$(0) ;
      745    14404
      746    14405    4            SELECT(31 /* CONSOLE WSN */) ;
      747    14406    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;
      748    14407    4            IF OUT$SYM.COUNT > 8
      749    14408    5            THEN DO;
      750    14409                              /*E* ERROR:   ASA-E$WSNNAMETOOBIG-C
      751    14410                                   MESSAGE: %U1 is too long for a WSN name.
      752    14411                                   MESSAGE1: Max length for a WSN name is 8 characters.
      753    14412                              */
      754    14413                    %SCREAM (ERR#=E$WSNNAMETOOBIG, MID='A', LEVEL=ERROR );
      755    14428    5               END;
      756    14429    5            ELSE DO;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:78   
      757    14430    5               KL$TREC.OCINFO.WSN = OUT$SYM.TEXT;
      758    14431    5               C_WSN_FLG = AS_TRUE;
      759    14432    5               END;
      760    14433                                                             /**/
      761    14434    4            SELECT( 32  /* CONSOLE COMMAND */ );
      762    14435    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;
      763    14436    4            IF OUT$SYM.CODE = 7   /*  NONE_VAL  */
      764    14437    5            THEN DO;
      765    14438    5               CNT = 0;
      766    14439    5               COMMAND = AS_BLANK;
      767    14440    5               END;
      768    14441    5            ELSE DO;
      769    14442    5               CNT = OUT$SYM.COUNT ;
      770    14443    5               COMMAND = OUT$SYM.TEXT;
      771    14444    5               END;
      772    14445    4            IF CNT>80 THEN
      773    14446    5            DO;
      774    14447        /*    ERROR: ASA-E$CMDTOOBIG-C
      775    14448              MESSAGE: Command is too long.
      776    14449              MESSAGE1: Command is limited to 80 characters.
      777    14450        */
      778    14451                    %SCREAM( ERR#=E$CMDTOOBIG, LEVEL=ERROR, MID='A' ) ;
      779    14466    5               GOTO END_OPTION ;
      780    14467    5               END ;            /* Then do                            */
      781    14468    4            KL$TREC.OCINFO.CMDCNT = CNT ;
      782    14469    4            KL$TREC.OCINFO.CMD = COMMAND;
      783    14470    4            SELECT ( 20  /* CONSOLE NATIVE LANGUAGE */ ) ;
      784    14471    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;
      785    14472    4            CNT = OUT$SYM.COUNT ;
      786    14473    4            IF CNT = 1 THEN
      787    14474    4               KL$TREC.OCINFO.LANG = OUT$SYM.TEXT ;
      788    14475    4            ELSE
      789    14476    4               KL$TREC.OCINFO.LANG = ' ' ;
      790    14477
      791    14478    4            SELECT( 25 /* C_SYSTEM */ ,
      792    14479    4                 23 /* C_UADMIN */ ,
      793    14480    4                 27 /* C_PADMIN */ ,
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:79   
      794    14481    4                 28 /* C_DEVICE */ ,
      795    14482    4                 29 /* C_COMM */ ,
      796    14483    4                 21 /* C_TP */ ,
      797    14484    4                 30 /* CONSOLE ADMIN  */,
      798    14485    4                 24 /* C_SLAVE */ ) ;
      799    14486        /*E*  ERROR:    ASA-E$ILLEGAL_OPT_FOR_LOCAL-C
      800    14487              MESSAGE:  Illegal option for a LOCAL terminal.
      801    14488        */
      802    14489        /*E*  ERROR:    ASA-E$ILLEGAL_OPT_FOR_NONLOCAL-C
      803    14490              MESSAGE:  Illegal option for a NON-LOCAL terminal.
      804    14491        */
      805    14492    4            IF PTR$ -> P$NODE.SUBNODES > 0
      806    14493    4            THEN
      807    14494    4               CNT = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      808    14495    4            ELSE
      809    14496    4               CNT = 1   /*  YES_VAL  */ ;
      810    14497    4            CODE2 = CODE ;
      811    14498    5            DO SELECT( CODE2 ) ;
      812    14499                                                                                    /**/
      813    14500    5               SELECT( 25 /* C_SYSTEM */ ) ;
      814    14501    5               IF NOT LOCAL AND (CNT = 45 /* KEYIN  */ OR CNT = 1   /*  YES_VAL  */)
      815    14502    6               THEN DO;
      816    14503                       %SCREAM( ERR#=E$ILLEGAL_OPT_FOR_NONLOCAL, LEVEL=ERROR, MID='A' );
      817    14518    6                  GOTO END_OPTION ;
      818    14519    6                  END ;            /* Then do                            */
      819    14520    5               C_SYS_FLG = ( CNT = 1   /*  YES_VAL  */ );
      820    14521    5               MASK = '200000'O /* K_SYS  */ ;
      821    14522    5               GOTO SET_KCADDR_CADDR;
      822    14523
      823    14524    5               SELECT(30 /* CONSOLE ADMIN  */ ) ;
      824    14525    5               MASK = '040000'O /* K_ADMIN */ ;
      825    14526    5               GOTO SET_KCADDR_CADDR;
      826    14527                                                                                    /**/
      827    14528    5               SELECT( 23 /* C_UADMIN */ ) ;
      828    14529    6               IF CNT = 1   /*  YES_VAL  */ THEN DO;
      829    14530    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~'040000'O
             14530                           /* K_ADMIN */;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:80   
      830    14531    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR | '040000'O /* K_ADMIN */
             14531                           ;
      831    14532    6                  END;
      832    14533    6               ELSE DO;
      833    14534    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR & ~'040000'O
             14534                           /* K_ADMIN */;
      834    14535    6                  CADDR = CADDR & ~'040000'O /* K_ADMIN */;
      835    14536                                                                                    /**/
      836    14537    6                  END;
      837    14538    5               SELECT( 27 /* C_PADMIN */ ) ;
      838    14539    6               IF CNT = 1   /*  YES_VAL  */ THEN DO;
      839    14540    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR | '040000'O
             14540                           /* K_ADMIN */;
      840    14541    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR | '040000'O /* K_ADMIN */
             14541                           ;
      841    14542    6                  END;
      842    14543    5               ELSE
      843    14544    5                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~'040000'O
             14544                           /* K_ADMIN */;
      844    14545                                                                                    /**/
      845    14546    5               SELECT( 28 /* C_DEVICE */ ) ;
      846    14547    5               MASK = '100000'O /* K_DEVC  */ ;
      847    14548    5               GOTO SET_KCADDR_CADDR;
      848    14549                                                                                    /**/
      849    14550    5               SELECT( 29 /* C_COMM */ ) ;
      850    14551    5               MASK = '004000'O /* K_COMM */ ;
      851    14552    5               GOTO SET_KCADDR_CADDR ;
      852    14553                                                                                    /**/
      853    14554    5               SELECT( 21 /* C_TP */ ) ;
      854    14555    5               MASK = '001000'O /* K_TP */ ;
      855    14556    5   SET_KCADDR_CADDR:
      856    14557    6               DO SELECT(CNT) ;
      857    14558    6                  SELECT(1   /*  YES_VAL  */) ;
      858    14559    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR | MASK;
      859    14560    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR | MASK;
      860    14561    6                  SELECT(2   /*  NO_VAL  */ ) ;
      861    14562    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~MASK;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:81   
      862    14563    6                  KCADDR = KCADDR & ~MASK;
      863    14564    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR & ~MASK;
      864    14565    6                  CADDR = CADDR & ~MASK;
      865    14566    6                  SELECT ( 25 /* DISPLAY */ ) ;
      866    14567    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~MASK;
      867    14568    6                  KCADDR = KCADDR & ~MASK;
      868    14569    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR | MASK;
      869    14570    6                  SELECT( 45 /* KEYIN  */ ) ;
      870    14571    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR | MASK;
      871    14572    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR & ~MASK;
      872    14573    6                  CADDR = CADDR & ~MASK;
      873    14574    6                  END;   /* Do case  */
      874    14575    5               SELECT( 24 /* C_SLAVE */ ) ;
      875    14576    6               IF LOCAL AND CNT = 1 THEN DO;
      876    14577                       %SCREAM( ERR#=E$ILLEGAL_OPT_FOR_LOCAL,LEVEL=ERROR,MID='A' );
      877    14592    6                  GOTO END_OPTION ;
      878    14593    6                  END ;            /* Then do                            */
      879    14594    6               IF CNT = 1   /*  YES_VAL  */ THEN DO;
      880    14595    6                  KL$TREC.OCINFO.CADDR = '002000'O /* K_SLAVE */ ;
      881    14596    6                  KL$TREC.OCINFO.KCADDR = '002000'O /* K_SLAVE */ ;
      882    14597    6                  END;
      883    14598    6               ELSE DO;
      884    14599    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR & ~'002000'O
             14599                           /* K_SLAVE */;
      885    14600    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~'002000'O
             14600                           /* K_SLAVE */;
      886    14601    6                  END;  /* Do */
      887    14602                                                                                    /**/
      888    14603    5               END ;                 /* Do case( CODE2 )                   */
      889    14604                                                                                    /**/
      890    14605    4            SELECT ( %DEV_DEVNUM_VAL ) ;
      891    14606
      892    14607    5            IF NOT SUB THEN DO;
      893    14608        /*E*  ERROR:  ASA-E$DEVNUMNOTLEGL-0
      894    14609             MESSAGE:  The DEVNUM option is not legal here.
      895    14610             MESSAGE1:  A device number is legal only for a subdevice or subconsole.
      896    14611        */
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:82   
      897    14612                    %SCREAM (ERR#=%E$DEVNUMNOTLEGL,LEVEL=ERROR,MID='A');
      898    14627    5               GOTO END_OPTION;
      899    14628    5               END; /*  Not sub  */
      900    14629
      901    14630    5            DO SELECT( PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE ) ;
      902    14631
      903    14632    5               SELECT( %PD_2780LP_VAL ) ;
      904    14633    5               KL$DADR.DEVNUM# = %KLDN_2780LP# ;
      905    14634
      906    14635    5               SELECT( %PD_2780CR_VAL ) ;
      907    14636    5               KL$DADR.DEVNUM# = %KLDN_2780CR# ;
      908    14637
      909    14638    5               SELECT( %PD_2780CP_VAL ) ;
      910    14639    5               KL$DADR.DEVNUM# = %KLDN_2780CP# ;
      911    14640
      912    14641    5               SELECT( %PD_3780LP_VAL ) ;
      913    14642    5               KL$DADR.DEVNUM# = %KLDN_3780LP# ;
      914    14643
      915    14644    5               SELECT( %PD_3780CR_VAL ) ;
      916    14645    5               KL$DADR.DEVNUM# = %KLDN_3780CR# ;
      917    14646
      918    14647    5               SELECT( %PD_3780CP_VAL ) ;
      919    14648    5               KL$DADR.DEVNUM# = %KLDN_3780CP# ;
      920    14649
      921    14650    5               SELECT( %PD_HASPOC_VAL ) ;
      922    14651    5               KL$DADR.DEVNUM# = %KLDN_HASPOC# ;
      923    14652    5               KL$DADR.SDNUM# = %KLDN_HASPOCS# ;
      924    14653    5               KL$DADR.DEVCTL.T = '0'B ;
      925    14654    5               KL$DADR.DEVCTL.B = %KLDCB_HASPOC# ;
      926    14655
      927    14656    5               SELECT( %PD_HASPLP_VAL ) ;
      928    14657    5               KL$DADR.DEVNUM#  = %KLDN_HASPLP# ;
      929    14658    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP# ;
      930    14659    5               KL$DADR.DEVCTL.B ='0'B ;
      931    14660
      932    14661    5               SELECT( %PD_HASPCR_VAL ) ;
      933    14662    5               KL$DADR.DEVNUM# = %KLDN_HASPCR# ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:83   
      934    14663    5               KL$DADR.DEVCTL.T = '0'B ;
      935    14664    5               KL$DADR.DEVCTL.B = %KLDCB_HASPCR# ;
      936    14665
      937    14666    5               SELECT( %PD_HASPCP_VAL ) ;
      938    14667    5               KL$DADR.DEVNUM# = %KLDN_HASPCP# ;
      939    14668    5               KL$DADR.DEVCTL.T = '0'B ;
      940    14669    5               KL$DADR.DEVCTL.B = %KLDCB_HASPCP# ;
      941    14670
      942    14671    5               SELECT( %PD_HASPLP2_VAL ) ;
      943    14672    5               KL$DADR.DEVNUM#  = %KLDN_HASPLP2# ;
      944    14673    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP2# ;
      945    14674    5               KL$DADR.DEVCTL.B ='0'B ;
      946    14675
      947    14676    5               SELECT( %PD_HASPLP3_VAL ) ;
      948    14677    5               KL$DADR.DEVNUM# = %KLDN_HASPLP3# ;
      949    14678    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP3# ;
      950    14679    5               KL$DADR.DEVCTL.B = '0'B ;
      951    14680
      952    14681    5               SELECT( %PD_IBMCR_VAL ) ;
      953    14682    5               KL$DADR.DEVNUM# = %KLDN_IBMCR# ;
      954    14683    5               KL$DADR.DEVCTL.T = %KLDCT_IBMCR# ;
      955    14684    5               KL$DADR.DEVCTL.B = '0'B ;
      956    14685
      957    14686    5               SELECT( 22 /* HEX */ ) ;
      958    14687    5               OPTION.COUNT = 7;
      959    14688    5               OPTION.TEXT = 'DEVNUM ';
      960    14689    5               CALL ASB$GET_HEX_VAL( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );
      961    14690    5               KL$DADR.DEVNUM# = BINBIT( HEX(1), 9 );
      962    14691
      963    14692    5               END ; /* Do case( CODE2 )*/
      964    14693
      965    14694    4            SELECT ( %DEV_SDNUM_VAL ) ;
      966    14695    5            IF NOT SUB THEN DO;
      967    14696        /*E*  ERROR:  ASA-E$SDNUMNOTLEGL-0
      968    14697             MESSAGE:  An SDNUM option is not legal here.
      969    14698             MESSAGE1:  An SDNUM is legal only for a subdevice or subconsole.
      970    14699        */
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:84   
      971    14700                    %SCREAM (ERR#=%E$SDNUMNOTLEGL,LEVEL=ERROR,MID='A');
      972    14715    5               GOTO END_OPTION;
      973    14716    5               END; /*  Not sub  */
      974    14717
      975    14718    4            OPTION.COUNT = 6;
      976    14719    4            OPTION.TEXT = 'SDNUM ';
      977    14720    4            CALL ASB$GET_HEX_VAL( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );
      978    14721    4            KL$DADR.SDNUM# = BINBIT( HEX(1), 9 );
      979    14722
      980    14723    4            SELECT ( %DEV_DEVCTL_VAL ) ;
      981    14724    5            IF NOT SUB THEN DO;
      982    14725        /*E*  ERROR:  ASA-E$DEVCTLNOTLEGL-0
      983    14726             MESSAGE:  A DEVCTL option is not legal here.
      984    14727             MESSAGE1:  A susbit value is legal only for a subdevice or subconsole.
      985    14728        */
      986    14729                    %SCREAM (ERR#=%E$SDNUMNOTLEGL,LEVEL=ERROR,MID='A');
      987    14744    5               GOTO END_OPTION;
      988    14745    5               END; /*  Not sub  */
      989    14746
      990    14747    4            OPTION.COUNT = 7;
      991    14748    4            OPTION.TEXT = 'DEVCTL ';
      992    14749    4            CALL ASB$GET_HEX_VAL ( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );
      993    14750    4            SPLIT.T = HEX(1);
      994    14751    4            SPLIT.B = HEX(2);
      995    14752    4            KL$DADR.DEVCTL = SPLIT;
      996    14753
      997    14754    4            END ;                    /* Do case( code )                    */
      998    14755    3   END_OPTION: ;
      999    14756    3         END;                      /* Do i                               */
     1000    14757    2      END ;                        /* Do while                           */
     1001    14758    2   IF SUB AND KL$TREC.PNAME.TXT ~= ' ' THEN DO;
     1002    14759    2      PRO$ = ADDR(PRO_BUF);
     1003    14760    2      ARS=LENGTHC(PRO_BUF);
     1004    14761    2      USERS_KEY.COUNT=KL$TREC.PNAME.CNT;
     1005    14762    2      USERS_KEY.TXTC=KL$TREC.PNAME.TXT;
     1006    14763    2      CALL ASD$READ_PRO (USERS_KEY,KL$PHDR,ARS)
     1007    14764    3      WHENALTRETURN DO ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:85   
     1008    14765        /*   ERROR:  ASA-E$MUSTPRO-C
     1009    14766             MESSAGE: You must specify a profile name for this device
     1010    14767        */
     1011    14768              %SCREAM( ERR#=E$MUSTPRO, LEVEL=ERROR, MID='A' ) ;
     1012    14783    3         MORE=AS_TRUE;
     1013    14784    3         GOTO CON_LOOP;
     1014    14785    3         END; /*  Whenaltreturn  */
     1015    14786                                                                                    /**/
     1016    14787    3      IF KL$PHDR.TTYP ~= %KLTY_SDEV# THEN DO;
     1017    14788              %SCREAM( ERR#=E$CONPROTYPE, LEVEL=ERROR, MID='A' ) ;
     1018    14803    3         MORE=AS_TRUE;
     1019    14804    3         GOTO CON_LOOP;
     1020    14805    3         END;
     1021    14806    2      PATTR=KL$PHDR.ATTR;
     1022    14807    2      IO=KL$PHDR.IO;
     1023    14808    2      DDEV=KL$PHDR.DDEV;
     1024    14809    2      END;
     1025    14810                                                /* Restore P_PCB                      */
     1026    14811    1   P_PCB.WORK$ = WORK$ ;
     1027    14812    1   P_PCB.WKSZ = WKSZ ;
     1028    14813    1   P_PCB.WK_USED = WK_USED ;
     1029    14814    1   P_PCB.ROOT$ = ROOT$ ;
     1030    14815                                                /* Restore NODE$                      */
     1031    14816    1   NODE$ = T_NODE$ ;
     1032    14817                                                          /* Set up twsn record */
     1033    14818    1   KL$TWSNREC.DEVS.TYP(TWSN_INDEX)  = SUBSTR(KL$TREC.RENAME,0,2);
     1034    14819    1   KL$TWSNREC.DEVS.NUM(TWSN_INDEX)  = SUBSTR(KL$TREC.RENAME,2,2);
     1035    14820    1   KL$TWSNREC.DEVS.ATTR(TWSN_INDEX) = PATTR ;
     1036    14821    1   KL$TWSNREC.DEVS.IO(TWSN_INDEX)   = IO;
     1037    14822    1   KL$TWSNREC.DEVS.DDEV(TWSN_INDEX) = DDEV;
     1038    14823    1   KL$TWSNREC.DEVS.ACCT(TWSN_INDEX) = KL$TREC.RENAME;
     1039    14824    1   KL$TWSNREC.DEVS.TDEV(TWSN_INDEX) = '0'B;
     1040    14825    1   KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = ' ';
     1041    14826    1   IF SUB THEN
     1042    14827    1      KL$TWSNREC.DEVS.TDEV(TWSN_INDEX) = '1'B;
     1043    14828    1   IF CREATE  AND  NOT KL$TREC.OCINFO.CADDR  AND  NOT KL$TREC.OCINFO.KCADDR
     1044    14829    2   THEN DO;            /* Set the defualt attributes */
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:86   
     1045    14830    2      KL$TREC.OCINFO.CADDR = CADDR;
     1046    14831    2      KL$TREC.OCINFO.KCADDR = KCADDR;
     1047    14832    2      END;
     1048    14833                                    /* If sys=yes or tp console then wsn=? by default */
     1049    14834    1   IF CREATE AND NOT C_WSN_FLG THEN
     1050    14835    1      IF C_SYS_FLG
     1051    14836    1           OR (KL$TREC.OCINFO.CADDR | KL$TREC.OCINFO.KCADDR) = '001000'O /* K_TP */
     1052    14837    1      THEN
     1053    14838    1         KL$TREC.OCINFO.WSN = '?';
     1054    14839                                                  /* Build KL_TSS for terminal device */
     1055    14840    2   IF SUB THEN DO;
     1056    14841    2      SS.SGN.TYPE = TYPE;
     1057    14842    2      SS.SGN.PNAME = KL$TREC.PNAME.TXT;
     1058    14843    2      SS.SGN.NUM = NUM;
     1059    14844    2      SS.SGN.TWSN = TWSNC;
     1060    14845    2      END;
     1061    14846    1   KL$TREC.NWINFO = LENGTHW(KL$TREC.KC$CGID) + LENGTHW(KL$TREC.OCINFO) ;
     1062    14847    1   IF CREATE THEN
     1063    14848    1      CALL CONCAT( AS_CREATED_TEXT,'  ',SUBSTR(KL$TREC.RENAME,0,4),' created.');
     1064    14849    1   RETURN;
     1065    14850
     1066    14851    1   END ASA$CON_OPTS;

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:87   
--  Include file information  --

   OCI_SUBS_C.:E05TOU  is referenced.
   OC$INFO.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$CON_OPTS.

   Procedure ASA$CON_OPTS requires 1506 words for executable code.
   Procedure ASA$CON_OPTS requires 396 words of local(AUTO) storage.

    No errors detected in file ASA$CONSOLE.:E05TSI    .

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:88   

 Object Unit name= ASA$CON_OPTS                               File name= ASA$CONSOLE.:E05TOU
 UTS= JUL 29 '97 08:35:30.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS     90    132  ASA$CON_OPTS
    3   Proc  even  none  1506   2742  ASA$CON_OPTS
    4  RoData even  none    44     54  ASA$CON_OPTS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std       10  ASA$CON_OPTS
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:89   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
         yes           Std       1 ASZ$SCRAMBLE
 yes     yes           Std       3 ASB$FIND_NUM
 yes     yes           Std       3 ASD$READ_PRO
         yes           Std       0 ASH$HELP
         yes           Std       2 ASH$ERROR
         yes           Std       0 ASH$QUEST
 yes     yes           Std       3 ASB$SET_PROMPT
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASH$DQUEST
 yes     yes           Std       4 ASB$GET_HEX_VAL
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_TRUE                          r    AS_FALSE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             AS_CREATED_TEXT                       FROM_KEY
     IN_BUF                                NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          P_PCB
     M$UC                                  CONSOLE_OPTS_LIST                     B_VECTNIL
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:90   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:91   


      314        1        /*T***********************************************************/
      315        2        /*T*                                                         */
      316        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      317        4        /*T*                                                         */
      318        5        /*T***********************************************************/
      319        6        /*P*     NAME:  ASA$CON_OPTS
      320        7                 PURPOSE: This module of SUPER processes the options of the
      321        8                          'CREATE CONSOLE' command and the sub-options of the
      322        9                          'CONSOLE' option of the 'CREATE TERMINAL' command.
      323       10                          It is called from ASA$CONSOLE or ASA$TERMINAL.
      324       11                          The parameters are:
      325       12                            TREC$  A pointer the the console record (KL$DREC).
      326       13                            TWSNR$  A pointer to the the TWSN record.
      327       14                            TWSNC   The twsn number, in character.
      328       15                            CREATE  A bit that tells if we are creating
      329       16                                    this console.
      330       17                            SUB     A bit that tells if we are being
      331       18                                    called from ASA$TERMINAL.
      332       19                            TERM_T  The type of terminal, used to set
      333       20                                    the default PROFILE.
      334       21                            LOCAL   A bit that tells that this console is
      335       22                                    for terminal LOCAL.
      336       23                            TWSN_INDEX   The TWSN record index for the device.
      337       24                                         Valid only if CREATE is false.
      338       25                            SS      A terminal sign-on block for a terminal
      339       26                                    device.  Valid only if SUB=true.
      340       27                            DADR$   A pointer to a KL_DADR structure position.
      341       28                                    Valid only if SUB=true.
      342       29        */
      343       30        ASA$CON_OPTS: PROC(TREC$,TWSNR$,TWSNC,CREATE,SUB,TERM_T,LOCAL,TWSN_INDEX,SS,DADR$);

     30  3 000000   000000 700200 xent  ASA$CON_OPTS TSX0  ! X66_AUTO_N
         3 000001   000614 000012                    ZERO    396,10

      344       31                                                                                    /**/
      345       32        %SET LISTSUB = '1'B ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:92   
      346       33        /*********************************************************************/
      347       34        /*   Include files   include files   include files   include files   */
      348       35        /*********************************************************************/
      349       36                                                                                    /**/
      350       37              %INCLUDE  AS_ENTRIES_M  ;
      351     1087              %INCLUDE  AS_PERR_C     ;
      352     1689              %INCLUDE  AS_SSUBS_C    ;
      353     1781              %INCLUDE  AS_SUBS_C     ;
      354     3195              %INCLUDE  KL_SUPER_C    ;
      355     6097              %INCLUDE  XU_FORMAT_C   ;
      356     6259              %INCLUDE  XU_MACRO_C    ;
      357     9365              %INCLUDE  AS_MAC_C      ;
      358     9445              %INCLUDE  AS_SUPER_C    ;
      359     9880              %INCLUDE  AS_SUPER_R    ;
      360    12896              %INCLUDE  B_MACROS_C    ;
      361    13007              %INCLUDE  CP_6          ;
      362    13088              %INCLUDE  KC$CGBLK      ;
      363    13136              %INCLUDE  OC$INFO       ;
      364    13192              %INCLUDE  OCI_SUBS_C    ;
      365    13290        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:93   
      366    13291        /*********************************************************************/
      367    13292        /*   Parameters      parameters      parameters      paramaters      */
      368    13293        /*********************************************************************/
      369    13294                                                                                    /**/
      370    13295    1   DCL TREC$ PTR ;
      371    13296    1   DCL TWSNR$ PTR ;
      372    13297    1   DCL TWSNC CHAR(4) ;
      373    13298    1   DCL CREATE BIT(1) ALIGNED;
      374    13299    1   DCL SUB BIT(1) ALIGNED;
      375    13300    1   DCL LOCAL BIT(1) ALIGNED;
      376    13301    1   DCL TERM_T CHAR(7) ;
      377    13302    1   DCL TWSN_INDEX SBIN ;
      378    13303        %KL_SS (NAME=SS,STCLASS=PARAM);
      379    13338    1   DCL DADR$  PTR;
      380    13339
      381    13340        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:94   
      382    13341        /*********************************************************************/
      383    13342        /*   Auto data       auto data       auto data       auto data       */
      384    13343        /*********************************************************************/
      385    13344                                                                                    /**/
      386    13345    1   DCL TYPE CHAR(2) ;
      387    13346    1   DCL NUM CHAR(2) ;
      388    13347    1   DCL ARS UBIN WORD ;
      389    13348    1   DCL I UBIN WORD ;
      390    13349    1   DCL CODE2 UBIN WORD ;
      391    13350    1   DCL CNT UBIN WORD ;
      392    13351    1   DCL PTR$ PTR ;
      393    13352    1   DCL MORE BIT(1) ;
      394    13353    1   DCL KCADDR BIT(18);
      395    13354    1   DCL CADDR BIT(18);
      396    13355    1   DCL PATTR BIT(18) ;
      397    13356    1   DCL 1 IO,
      398    13357    1          2 INPUT BIT(1),
      399    13358    1          2 OUTPUT BIT(1);
      400    13359    1   DCL DDEV BIT(9);
      401    13360    1   DCL MASK BIT(36) ;
      402    13361    1   DCL BLK$ PTR ;
      403    13362    1   DCL WSNCVT$ PTR ;
      404    13363    1   DCL PRO$ PTR ;
      405    13364    1   DCL PRO_BUF CHAR(1024 /* AS_PRO_BUF_SIZEC */);
      406    13365    1   DCL WORK$ PTR;
      407    13366    1   DCL WKSZ UBIN;
      408    13367    1   DCL WK_USED UBIN;
      409    13368    1   DCL ROOT$ PTR;
      410    13369    1   DCL T_NODE$ PTR;
      411    13370    1   DCL C_WSN_FLG BIT(1);
      412    13371    1   DCL C_SYS_FLG BIT(1);
      413    13372    1   DCL COMMAND CHAR(80);
      414    13373    1   DCL 1 SPLIT ,
      415    13374    1          2 * UBIN(1) UNAL ,
      416    13375    1          2 T UBIN(8) UNAL ,
      417    13376    1          2 * UBIN(1) UNAL ,
      418    13377    1          2 B UBIN(8) UNAL ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:95   
      419    13378    1   DCL HEX(0:255) UBIN BYTE UNAL;
      420    13379    1   DCL 1 OPTION,
      421    13380    1          2 COUNT UBIN BYTE CALIGNED,
      422    13381    1          2 TEXT  CHAR(31)  CALIGNED;
      423    13382    1   DCL P$  PTR;
      424    13383    1   DCL TEMP   UBIN WORD;
      425    13384    1   DCL TEMP$   PTR;
      426    13385    1   DCL ACHAR    CHAR(1) BASED;
      427    13386    1   DCL J       UBIN WORD;
      428    13387    1   DCL K       UBIN WORD;
      429    13388    1   DCL L       UBIN WORD;
      430    13389        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:96   
      431    13390        /*********************************************************************/
      432    13391        /*   Symref's        symref's        symref's        symref's        */
      433    13392        /*********************************************************************/
      434    13393                                                                                    /**/
      435    13394    1   DCL CONSOLE_OPTS_LIST SYMREF UBIN WORD ;
      436    13395        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:97   
      437    13396        /*********************************************************************/
      438    13397        /*   Static data     static data     static data     static data     */
      439    13398        /*********************************************************************/
      440    13399                                                                                    /**/
      441    13400        %SET LISTSUB='1'B ;
      442    13401              %KL_DREC( NAME = KL_CREC ,
      443    13402                        STCLASS = CONSTANT ,
      444    13403                        TYP = %KLAT_CG# ,
      445    13404                        SUPR = AS_CON# ,
      446    13405                        RN = '1'B ,
      447    13406                        LAST = ","  );
      448    13519              %KC$CGID(FPTN=KC_CGID,
      449    13520                       STCLASS=CONSTANT,
      450    13521                        LVL = 2 ,
      451    13522                        LAST = "," ) ;
      452    13548              %OC$INFO (FPTN = OCINFO,
      453    13549                        STCLASS=CONSTANT ,
      454    13550                        LVL = 2 ) ;
      455    13587    1   DCL Z_ACCT(0:1) UBIN WORD CONSTANT INIT(0*0);
      456    13588        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:98   
      457    13589        /********************************************************************/
      458    13590        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      459    13591        /*********************************************************************/
      460    13592                                                                                    /**/
      461    13593    1   DCL X$PARSE ENTRY(1) ALTRET ;
      462    13594        %ASB$FIND_NUM ;
      463    13597        %ASB$GET_HEX_VAL ;
      464    13600        %ASB$READ_SI ;
      465    13603        %ASB$SET_PROMPT ;
      466    13606        %ASD$READ_PRO ;
      467    13609        %ASH$ERROR ;
      468    13612        %ASH$WARN ;
      469    13615        %ASH$HELP ;
      470    13618        %ASH$QUEST ;
      471    13621        %ASH$DQUEST ;
      472    13624        %ASZ$SCRAMBLE ;
      473    13627        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:99   
      474    13628        /*********************************************************************/
      475    13629        /*   Local based     local based     local based     local based     */
      476    13630        /*********************************************************************/
      477    13631                                                                                    /**/
      478    13632            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      479    13633                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      480    13678              %PARSE$SYM( NAME = OUT$SYM ,
      481    13679                          STCLASS="BASED(BLK$)") ;
      482    13717              %KL_DREC( NAME = KL$TREC ,
      483    13718                        STCLASS="BASED( TREC$ )",
      484    13719                        LAST = "," ) ;
      485    13832              %KC$CGID(FPTN=KC$CGID,
      486    13833                        LVL = 2 ,
      487    13834                        LAST = "," );
      488    13860              %OC$INFO(FPTN = OCINFO,
      489    13861                        LVL = 2 ) ;
      490    13898        %KL_DADR ( NAME = KL$DADR,
      491    13899                   STCLASS="BASED(DADR$)",
      492    13900                   LVL = 1,
      493    13901                   LAST = ";" );
      494    13949              %KL_TWSNREC(  NAME = KL$TWSNREC ,
      495    13950                            STCLASS="BASED( TWSNR$ )") ;
      496    13975              %KL_PHDR ( NAME = KL$PHDR ,
      497    13976                        STCLASS="BASED( PRO$ )") ;
      498    14017        %EJECT ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:100  
      499    14018        /*********************************************************************/
      500    14019        /*   Procedure       procedure       procedure       procedure       */
      501    14020        /*********************************************************************/
      502    14021                                                                                    /**/
      503    14022        /*
      504    14023            ***            Begin procedure                    ***
      505    14024        */
      506    14025    1   WORK$ = P_PCB.WORK$ ;

  14025  3 000002   000002 236000 xsym               LDQ     P_PCB+2
         3 000003   200436 756100                    STQ     WORK$,,AUTO

      507    14026    1   WKSZ = P_PCB.WKSZ ;

  14026  3 000004   000005 235000 xsym               LDA     P_PCB+5
         3 000005   000022 771000                    ARL     18
         3 000006   200437 755100                    STA     WKSZ,,AUTO

      508    14027    1   WK_USED = P_PCB.WK_USED ;

  14027  3 000007   000010 235000 xsym               LDA     P_PCB+8
         3 000010   000022 771000                    ARL     18
         3 000011   200440 755100                    STA     WK_USED,,AUTO

      509    14028    1   ROOT$ = P_PCB.ROOT$ ;

  14028  3 000012   000001 236000 xsym               LDQ     P_PCB+1
         3 000013   200441 756100                    STQ     ROOT$,,AUTO

      510    14029                                                /* Bump past area used.               */
      511    14030    1   P_PCB.WORK$ = PINCRW( WORK$, P_PCB.WK_USED ) ;

  14030  3 000014   000010 236000 xsym               LDQ     P_PCB+8
         3 000015   777777 376003                    ANQ     -1,DU
         3 000016   200436 036100                    ADLQ    WORK$,,AUTO
         3 000017   000002 756000 xsym               STQ     P_PCB+2

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:101  
      512    14031    1   P_PCB.WKSZ = WKSZ - P_PCB.WK_USED ;

  14031  3 000020   200610 755100                    STA     L+1,,AUTO
         3 000021   200437 236100                    LDQ     WKSZ,,AUTO
         3 000022   200610 136100                    SBLQ    L+1,,AUTO
         3 000023   000000 620006                    EAX0    0,QL
         3 000024   000005 740000 xsym               STX0    P_PCB+5

      513    14032                                                /* Save NODE$                         */
      514    14033    1   T_NODE$ = NODE$ ;

  14033  3 000025   000000 236000 xsym               LDQ     NODE$
         3 000026   200442 756100                    STQ     T_NODE$,,AUTO

      515    14034    1   MORE = AS_TRUE ;

  14034  3 000027   000000 236000 xsym               LDQ     AS_TRUE
         3 000030   400000 376003                    ANQ     -131072,DU
         3 000031   200024 756100                    STQ     MORE,,AUTO

      516    14035    1   TYPE='OC';

  14035  3 000032   000072 221000 2                  LDX1    KL_CREC+58
         3 000033   200015 741100                    STX1    TYPE,,AUTO

      517    14036    1   C_WSN_FLG = AS_FALSE;

  14036  3 000034   000000 236000 xsym               LDQ     AS_FALSE
         3 000035   400000 376003                    ANQ     -131072,DU
         3 000036   200443 756100                    STQ     C_WSN_FLG,,AUTO

      518    14037    1   C_SYS_FLG = AS_FALSE;

  14037  3 000037   200444 756100                    STQ     C_SYS_FLG,,AUTO

      519    14038                                                                                    /**/
      520    14039    2   IF CREATE THEN DO;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:102  

  14039  3 000040   200006 470500                    LDP0    @CREATE,,AUTO
         3 000041   000000 234100                    SZN     0,,PR0
         3 000042   000233 605000 3                  TPL     s:14087

      521    14040    2      KL$TREC = KL_CREC;

  14040  3 000043   200003 471500                    LDP1    @TREC$,,AUTO
         3 000044   100000 473500                    LDP3    0,,PR1
         3 000045   000100 100400                    MLR     fill='000'O
         3 000046   000000 000340 2                  ADSC9   KL_CREC                  cn=0,n=224
         3 000047   300000 000340                    ADSC9   0,,PR3                   cn=0,n=224

      522    14041    2      IO='11'B;

  14041  3 000050   600000 236003                    LDQ     -65536,DU
         3 000051   200030 756100                    STQ     IO,,AUTO

      523    14042    2      PATTR='0'B;

  14042  3 000052   000000 220003                    LDX0    0,DU
         3 000053   200027 740100                    STX0    PATTR,,AUTO

      524    14043    2      DDEV='0'B;

  14043  3 000054   200031 450100                    STZ     DDEV,,AUTO

      525    14044    2      KL$TREC.PNAME.CNT = 0;

  14044  3 000055   100000 473500                    LDP3    0,,PR1
         3 000056   000000 236003                    LDQ     0,DU
         3 000057   300004 552140                    STBQ    4,'40'O,PR3

      526    14045    2      KL$TREC.PNAME.TXT = ' ' ;

  14045  3 000060   100000 473500                    LDP3    0,,PR1
         3 000061   040100 100400                    MLR     fill='040'O
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:103  
         3 000062   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000063   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11

      527    14046    2      CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD );

  14046  3 000064   100000 473500                    LDP3    0,,PR1
         3 000065   300002 634500                    EPPR4   2,,PR3
         3 000066   200610 454500                    STP4    L+1,,AUTO
         3 000067   200610 630500                    EPPR0   L+1,,AUTO
         3 000070   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000071   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         3 000072   000000 011000                    NOP     0

      528    14047    2      KL$TREC.KC$CGID.NAME#.CNT = 0 ;

  14047  3 000073   200003 470500                    LDP0    @TREC$,,AUTO
         3 000074   000000 471500                    LDP1    0,,PR0
         3 000075   000000 236003                    LDQ     0,DU
         3 000076   100024 552140                    STBQ    20,'40'O,PR1

      529    14048    2      KL$TREC.OCINFO.TNAME =KL$TWSNREC.STATION ;

  14048  3 000077   000000 471500                    LDP1    0,,PR0
         3 000100   200004 473500                    LDP3    @TWSNR$,,AUTO
         3 000101   300000 474500                    LDP4    0,,PR3
         3 000102   040100 100500                    MLR     fill='040'O
         3 000103   400002 000010                    ADSC9   2,,PR4                   cn=0,n=8
         3 000104   100040 000010                    ADSC9   32,,PR1                  cn=0,n=8

      530    14049    2      KL$TREC.RENAME=' ';

  14049  3 000105   000000 471500                    LDP1    0,,PR0
         3 000106   000035 235000 xsym               LDA     B_VECTNIL+29
         3 000107   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 000110   100011 755100                    STA     9,,PR1
         3 000111   100012 756100                    STQ     10,,PR1

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:104  
      531    14050    2      KL$TREC.TWSN# = TWSNC;

  14050  3 000112   000000 471500                    LDP1    0,,PR0
         3 000113   200005 474500                    LDP4    @TWSNC,,AUTO
         3 000114   040100 100500                    MLR     fill='040'O
         3 000115   400000 000004                    ADSC9   0,,PR4                   cn=0,n=4
         3 000116   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4

      532    14051    2      CALL ASB$FIND_NUM(TWSNR$,TYPE,NUM)

  14051  3 000117   200016 631500                    EPPR1   NUM,,AUTO
         3 000120   200612 451500                    STP1    L+3,,AUTO
         3 000121   200015 635500                    EPPR5   TYPE,,AUTO
         3 000122   200611 455500                    STP5    L+2,,AUTO
         3 000123   200004 236100                    LDQ     @TWSNR$,,AUTO
         3 000124   200610 756100                    STQ     L+1,,AUTO
         3 000125   200610 630500                    EPPR0   L+1,,AUTO
         3 000126   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000127   000000 701000 xent               TSX1    ASB$FIND_NUM
         3 000130   000132 702000 3                  TSX2    s:14065
         3 000131   000137 710000 3                  TRA     s:14070

      533    14052    3      WHENALTRETURN DO;

      534    14053              %SCREAM(ERR#=E$UNABLE_FIND_NUMBER, LEVEL=ERROR, MID='A');

  14065  3 000132   000000 630400 4                  EPPR0   0
         3 000133   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000134   000000 701000 xent               TSX1    ASH$ERROR
         3 000135   000000 011000                    NOP     0

      535    14068    3         RETURN;

  14068  3 000136   000000 702200 xent               TSX2  ! X66_ARET

      536    14069    3         END;  /*  Whenaltreturn  */
      537    14070    2      CALL CONCAT(KL$TREC.RENAME,TYPE,NUM,TWSNC);
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:105  

  14070  3 000137   200003 470500                    LDP0    @TREC$,,AUTO
         3 000140   000000 471500                    LDP1    0,,PR0
         3 000141   200015 220100                    LDX0    TYPE,,AUTO
         3 000142   100011 740100                    STX0    9,,PR1
         3 000143   200016 220100                    LDX0    NUM,,AUTO
         3 000144   100011 440100                    SXL0    9,,PR1
         3 000145   200005 473500                    LDP3    @TWSNC,,AUTO
         3 000146   040100 100500                    MLR     fill='040'O
         3 000147   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         3 000150   100012 000004                    ADSC9   10,,PR1                  cn=0,n=4

      538    14071    2      FROM_KEY.TEXT = KL$TREC.RENAME ;

  14071  3 000151   200003 470500                    LDP0    @TREC$,,AUTO
         3 000152   000000 471500                    LDP1    0,,PR0
         3 000153   040000 100500                    MLR     fill='040'O
         3 000154   100011 000010                    ADSC9   9,,PR1                   cn=0,n=8
         3 000155   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

      539    14072    2      CADDR  = '040000'O /* K_ADMIN */ | '100000'O /* K_DEVC  */ ;

  14072  3 000156   140000 220003                    LDX0    49152,DU
         3 000157   200026 740100                    STX0    CADDR,,AUTO

      540    14073    2      KCADDR = '100000'O /* K_DEVC  */ ;

  14073  3 000160   100000 221003                    LDX1    32768,DU
         3 000161   200025 741100                    STX1    KCADDR,,AUTO

      541    14074    2      KL$TREC.OCINFO.MXPRI=%KLOC_DFPRI;

  14074  3 000162   000000 471500                    LDP1    0,,PR0
         3 000163   000007 236007                    LDQ     7,DL
         3 000164   100034 552104                    STBQ    28,'04'O,PR1

      542    14075    3      IF SUB THEN DO;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:106  

  14075  3 000165   200007 471500                    LDP1    @SUB,,AUTO
         3 000166   100000 234100                    SZN     0,,PR1
         3 000167   000267 605000 3                  TPL     s:14093

      543    14076    3         CALL CONCAT(KL$TREC.PNAME.TXT,TERM_T,'OC');

  14076  3 000170   000000 473500                    LDP3    0,,PR0
         3 000171   200010 474500                    LDP4    @TERM_T,,AUTO
         3 000172   040100 100500                    MLR     fill='040'O
         3 000173   400000 000007                    ADSC9   0,,PR4                   cn=0,n=7
         3 000174   300004 200007                    ADSC9   4,,PR3                   cn=1,n=7
         3 000175   000072 236000 2                  LDQ     KL_CREC+58
         3 000176   777777 376003                    ANQ     -1,DU
         3 000177   040040 276007                    ORQ     16416,DL
         3 000200   300006 756100                    STQ     6,,PR3

      544    14077    3         KL$TREC.PNAME.CNT=6;

  14077  3 000201   200003 470500                    LDP0    @TREC$,,AUTO
         3 000202   000000 471500                    LDP1    0,,PR0
         3 000203   006000 236003                    LDQ     3072,DU
         3 000204   100004 552140                    STBQ    4,'40'O,PR1

      545    14078    3         IF CREATE THEN

  14078  3 000205   200006 471500                    LDP1    @CREATE,,AUTO
         3 000206   100000 234100                    SZN     0,,PR1
         3 000207   000267 605000 3                  TPL     s:14093

      546    14079    4            IF TERM_T = 'STDHASP' THEN DO;

  14079  3 000210   200010 473500                    LDP3    @TERM_T,,AUTO
         3 000211   040000 106500                    CMPC    fill='040'O
         3 000212   300000 000007                    ADSC9   0,,PR3                   cn=0,n=7
         3 000213   000074 000007 2                  ADSC9   KL_CREC+60               cn=0,n=7
         3 000214   000267 601000 3                  TNZ     s:14093
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:107  

      547    14080    4               KL$DADR.DEVNUM# = %KLDN_HASPOC#;

  14080  3 000215   200014 474500                    LDP4    @DADR$,,AUTO
         3 000216   400000 475500                    LDP5    0,,PR4
         3 000217   003100 060400                    CSL     bolr='003'O
         3 000220   000001 000011 4                  BDSC    1                        by=0,bit=0,n=9
         3 000221   500000 000011                    BDSC    0,,PR5                   by=0,bit=0,n=9

      548    14081    4               KL$DADR.DEVCTL.B = %KLDCB_HASPOC#;

  14081  3 000222   400000 475500                    LDP5    0,,PR4
         3 000223   003100 060400                    CSL     bolr='003'O
         3 000224   000002 000010 4                  BDSC    2                        by=0,bit=0,n=8
         3 000225   500000 610010                    BDSC    0,,PR5                   by=3,bit=1,n=8

      549    14082    4               KL$DADR.DEVCTL.T = '0'B;

  14082  3 000226   400000 475500                    LDP5    0,,PR4
         3 000227   003100 060400                    CSL     bolr='003'O
         3 000230   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 000231   500000 410010                    BDSC    0,,PR5                   by=2,bit=1,n=8

      550    14083    4               END; /*  Term type is stdhasp  */

      551    14084    3         END;

      552    14085    2      END;

  14085  3 000232   000267 710000 3                  TRA     s:14093

      553    14086    2   ELSE DO;

      554    14087    2      TWSNC = KL$TREC.TWSN#;

  14087  3 000233   200003 471500                    LDP1    @TREC$,,AUTO
         3 000234   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:108  
         3 000235   200005 474500                    LDP4    @TWSNC,,AUTO
         3 000236   040100 100500                    MLR     fill='040'O
         3 000237   300001 000004                    ADSC9   1,,PR3                   cn=0,n=4
         3 000240   400000 000004                    ADSC9   0,,PR4                   cn=0,n=4

      555    14088    2      NUM = SUBSTR(KL$TREC.RENAME,2,2);

  14088  3 000241   100000 473500                    LDP3    0,,PR1
         3 000242   300011 720100                    LXL0    9,,PR3
         3 000243   200016 740100                    STX0    NUM,,AUTO

      556    14089    2      PATTR= KL$TWSNREC.DEVS.ATTR(TWSN_INDEX) ;

  14089  3 000244   200004 473500                    LDP3    @TWSNR$,,AUTO
         3 000245   300000 475500                    LDP5    0,,PR3
         3 000246   200012 476500                    LDP6    @TWSN_INDEX,,AUTO
         3 000247   600000 236100                    LDQ     0,,PR6
         3 000250   000013 402007                    MPY     11,DL
         3 000251   500006 222106                    LDX2    6,QL,PR5
         3 000252   200027 742100                    STX2    PATTR,,AUTO

      557    14090    2      IO   = KL$TWSNREC.DEVS.IO(TWSN_INDEX) ;

  14090  3 000253   600000 236100                    LDQ     0,,PR6
         3 000254   000013 402007                    MPY     11,DL
         3 000255   500006 236106                    LDQ     6,QL,PR5
         3 000256   000033 736000                    QLS     27
         3 000257   600000 376003                    ANQ     -65536,DU
         3 000260   200030 756100                    STQ     IO,,AUTO

      558    14091    2      DDEV = KL$TWSNREC.DEVS.DDEV(TWSN_INDEX) ;

  14091  3 000261   600000 236100                    LDQ     0,,PR6
         3 000262   000013 402007                    MPY     11,DL
         3 000263   500006 236106                    LDQ     6,QL,PR5
         3 000264   000022 736000                    QLS     18
         3 000265   777000 376003                    ANQ     -512,DU
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:109  
         3 000266   200031 756100                    STQ     DDEV,,AUTO

      559    14092    2      END;

      560    14093    1   KL$TWSNREC.DEVS(TWSN_INDEX) = '0'B ;

  14093  3 000267   200004 470500                    LDP0    @TWSNR$,,AUTO
         3 000270   000000 471500                    LDP1    0,,PR0
         3 000271   200012 473500                    LDP3    @TWSN_INDEX,,AUTO
         3 000272   300000 236100                    LDQ     0,,PR3
         3 000273   000013 402007                    MPY     11,DL
         3 000274   000002 736000                    QLS     2
         3 000275   000106 100400                    MLR     fill='000'O
         3 000276   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000277   100005 000054                    ADSC9   5,Q,PR1                  cn=0,n=44

      561    14094    1   KL$TREC.KC$CGID.NAME#.TXT = 'OCCG' ;

  14094  3 000300   200003 471500                    LDP1    @TREC$,,AUTO
         3 000301   100000 474500                    LDP4    0,,PR1
         3 000302   040100 100400                    MLR     fill='040'O
         3 000303   000076 000004 2                  ADSC9   KL_CREC+62               cn=0,n=4
         3 000304   400024 200037                    ADSC9   20,,PR4                  cn=1,n=31

      562    14095    1   KL$TREC.KC$CGID.NAME#.CNT = 4 ;

  14095  3 000305   100000 474500                    LDP4    0,,PR1
         3 000306   004000 236003                    LDQ     2048,DU
         3 000307   400024 552140                    STBQ    20,'40'O,PR4

      563    14096    1   KL$TREC.KC$CGID.ACCT# = ':SYS' ;

  14096  3 000310   100000 474500                    LDP4    0,,PR1
         3 000311   040100 100400                    MLR     fill='040'O
         3 000312   000077 000004 2                  ADSC9   KL_CREC+63               cn=0,n=4
         3 000313   400020 000010                    ADSC9   16,,PR4                  cn=0,n=8

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:110  
      564    14097    1   KL$TREC.KC$CGID.PSN# = AS_BLANK ;

  14097  3 000314   100000 474500                    LDP4    0,,PR1
         3 000315   040100 100400                    MLR     fill='040'O
         3 000316   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000317   400022 000006                    ADSC9   18,,PR4                  cn=0,n=6

      565    14098    1   P_PCB.ROOT$ = ADDR( CONSOLE_OPTS_LIST ) ;

  14098  3 000320   000003 236000 4                  LDQ     3
         3 000321   000001 756000 xsym               STQ     P_PCB+1

      566    14099                                                /* Set prompt                         */
      567    14100    2   IF SUB THEN DO;

  14100  3 000322   200007 474500                    LDP4    @SUB,,AUTO
         3 000323   400000 234100                    SZN     0,,PR4
         3 000324   000332 605000 3                  TPL     s:14104

      568    14101    2      CALL ASB$SET_PROMPT ( %PROMPT_SUB );

  14101  3 000325   000004 630400 4                  EPPR0   4
         3 000326   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000327   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 000330   000000 011000                    NOP     0

      569    14102    2      END;

  14102  3 000331   000336 710000 3                  TRA     s:14106

      570    14103    2   ELSE DO;

      571    14104    2      CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;

  14104  3 000332   000005 630400 4                  EPPR0   5
         3 000333   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000334   000000 701000 xent               TSX1    ASB$SET_PROMPT
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:111  
         3 000335   000000 011000                    NOP     0

      572    14105    2      END;

      573    14106    1   REMEMBER CON_LOOP IN REMEM_VAR ;

  14106  3 000336   000341 635000 3                  EAA     CON_LOOP
         3 000337   000000 452400 xsym               STP2    REMEM_VAR
         3 000340   000001 755000 xsym               STA     REMEM_VAR+1

      574    14107    1   CON_LOOP:
      575    14108                                                                                    /**/
      576    14109    2   DO WHILE( MORE ) ;

  14109  3 000341   200024 234100       CON_LOOP     SZN     MORE,,AUTO
         3 000342   002427 605000 3                  TPL     s:14758

      577    14110                                                /* Read input                         */
      578    14111    2      CALL ASB$READ_SI( IN_BUF, ARS ) ;

  14111  3 000343   200017 630500                    EPPR0   ARS,,AUTO
         3 000344   200611 450500                    STP0    L+2,,AUTO
         3 000345   000006 236000 4                  LDQ     6
         3 000346   200610 756100                    STQ     L+1,,AUTO
         3 000347   200610 630500                    EPPR0   L+1,,AUTO
         3 000350   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000351   000000 701000 xent               TSX1    ASB$READ_SI
         3 000352   000000 011000                    NOP     0

      579    14112    2      P_PCB.NCHARS = ARS ;

  14112  3 000353   200017 235100                    LDA     ARS,,AUTO
         3 000354   000011 755000 xsym               STA     P_PCB+9

      580    14113    2      CALL X$PARSE( P_PCB )

  14113  3 000355   000007 630400 4                  EPPR0   7
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:112  
         3 000356   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000357   000000 701000 xent               TSX1    X$PARSE
         3 000360   000362 702000 3                  TSX2    s:14115
         3 000361   000367 710000 3                  TRA     s:14119

      581    14114    3      WHENALTRETURN DO;

      582    14115    3         CALL ASH$ERROR( P_PCB.ERROR ) ;

  14115  3 000362   000010 630400 4                  EPPR0   8
         3 000363   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000364   000000 701000 xent               TSX1    ASH$ERROR
         3 000365   000000 011000                    NOP     0

      583    14116    3         GOTO CON_LOOP ;

  14116  3 000366   000341 710000 3                  TRA     CON_LOOP

      584    14117    3         END; /*  Whenaltreturn  */
      585    14118                                                                                    /**/
      586    14119    2      NODE$ = P_PCB.OUT$ ;

  14119  3 000367   000003 236000 xsym               LDQ     P_PCB+3
         3 000370   000000 756000 xsym               STQ     NODE$

      587    14120    3      DO I = 0 TO P$NODE.SUBNODES-1 ;

  14120  3 000371   200020 450100                    STZ     I,,AUTO
         3 000372   002417 710000 3                  TRA     END_OPTION+3

      588    14121    3         PTR$ = P$NODE.SUBLK$(I) ;

  14121  3 000373   000000 470400 xsym               LDP0    NODE$
         3 000374   200020 720100                    LXL0    I,,AUTO
         3 000375   000003 236110                    LDQ     3,X0,PR0
         3 000376   200023 756100                    STQ     PTR$,,AUTO

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:113  
      589    14122    3         CODE = PTR$ -> P$NODE.CODE ;

  14122  3 000377   200023 471500                    LDP1    PTR$,,AUTO
         3 000400   100000 236100                    LDQ     0,,PR1
         3 000401   777777 376007                    ANQ     -1,DL
         3 000402   000000 756000 xsym               STQ     CODE

      590    14123                                                              /* Check if slave is set. */
      591    14124    3         IF KL$TREC.OCINFO.CADDR = '002000'O /* K_SLAVE */

  14124  3 000403   200003 473500                    LDP3    @TREC$,,AUTO
         3 000404   300000 474500                    LDP4    0,,PR3
         3 000405   400034 221100                    LDX1    28,,PR4
         3 000406   002000 101003                    CMPX1   1024,DU
         3 000407   000444 601000 3                  TNZ     s:14154

      592    14125    3         THEN
      593    14126    4         DO SELECT(CODE) ;                 /* Stop the following options. */

  14126  3 000410   000031 116007                    CMPQ    25,DL
         3 000411   000430 602000 3                  TNC     s:14126+16
         3 000412   000437 600000 3                  TZE     s:14149
         3 000413   000034 116007                    CMPQ    28,DL
         3 000414   000425 602000 3                  TNC     s:14126+13
         3 000415   000437 600000 3                  TZE     s:14149
         3 000416   000036 116007                    CMPQ    30,DL
         3 000417   000422 602000 3                  TNC     s:14126+10
         3 000420   000437 600000 3                  TZE     s:14149
         3 000421   000444 710000 3                  TRA     s:14154
         3 000422   000035 116007                    CMPQ    29,DL
         3 000423   000444 601000 3                  TNZ     s:14154
         3 000424   000437 710000 3                  TRA     s:14149
         3 000425   000033 116007                    CMPQ    27,DL
         3 000426   000444 601000 3                  TNZ     s:14154
         3 000427   000437 710000 3                  TRA     s:14149
         3 000430   000027 116007                    CMPQ    23,DL
         3 000431   000434 602000 3                  TNC     s:14126+20
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:114  
         3 000432   000437 600000 3                  TZE     s:14149
         3 000433   000444 710000 3                  TRA     s:14154
         3 000434   000025 116007                    CMPQ    21,DL
         3 000435   000444 601000 3                  TNZ     s:14154
         3 000436   000437 710000 3                  TRA     s:14149

      594    14127    4            SELECT( 25 /* C_SYSTEM */,

      595    14128    4                 23 /* C_UADMIN */,
      596    14129    4                 27 /* C_PADMIN */,
      597    14130    4                 30 /* CONSOLE ADMIN  */,
      598    14131    4                 28 /* C_DEVICE */,
      599    14132    4                 21 /* C_TP */,
      600    14133    4                 29 /* C_COMM */ ) ;
      601    14134        /*E*  ERROR:    ASA-E$BADOPTSLVCON-C
      602    14135              MESSAGE0: Illegal option for SLAVE IRBT.
      603    14136        */
      604    14137                 %SCREAM( ERR#=E$BADOPTSLVCON, MID='A', LEVEL=ERROR );

  14149  3 000437   000011 630400 4                  EPPR0   9
         3 000440   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000441   000000 701000 xent               TSX1    ASH$ERROR
         3 000442   000000 011000                    NOP     0

      605    14152    4            GOTO END_OPTION ;

  14152  3 000443   002414 710000 3                  TRA     END_OPTION

      606    14153    4            END ; /* Do case */

      607    14154    4         DO SELECT( CODE ) ;

  14154  3 000444   000037 116007                    CMPQ    31,DL
         3 000445   000507 602000 3                  TNC     s:14154+35
         3 000446   001204 600000 3                  TZE     s:14406
         3 000447   000071 116007                    CMPQ    57,DL
         3 000450   000472 602000 3                  TNC     s:14154+22
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:115  
         3 000451   001734 600000 3                  TZE     s:14607
         3 000452   000454 116007                    CMPQ    300,DL
         3 000453   000463 602000 3                  TNC     s:14154+15
         3 000454   000744 600000 3                  TZE     s:14267
         3 000455   000455 116007                    CMPQ    301,DL
         3 000456   002414 602000 3                  TNC     END_OPTION
         3 000457   000740 600000 3                  TZE     s:14264
         3 000460   000456 116007                    CMPQ    302,DL
         3 000461   002414 601000 3                  TNZ     END_OPTION
         3 000462   000734 710000 3                  TRA     s:14261
         3 000463   000073 116007                    CMPQ    59,DL
         3 000464   000467 602000 3                  TNC     s:14154+19
         3 000465   002300 600000 3                  TZE     s:14695
         3 000466   002414 710000 3                  TRA     END_OPTION
         3 000467   000072 116007                    CMPQ    58,DL
         3 000470   002414 601000 3                  TNZ     END_OPTION
         3 000471   002344 710000 3                  TRA     s:14724
         3 000472   000055 116007                    CMPQ    45,DL
         3 000473   000500 602000 3                  TNC     s:14154+28
         3 000474   000557 600000 3                  TZE     s:14158
         3 000475   000061 116007                    CMPQ    49,DL
         3 000476   002414 601000 3                  TNZ     END_OPTION
         3 000477   001154 710000 3                  TRA     s:14375
         3 000500   000041 116007                    CMPQ    33,DL
         3 000501   000504 602000 3                  TNC     s:14154+32
         3 000502   000754 600000 3                  TZE     s:14277
         3 000503   002414 710000 3                  TRA     END_OPTION
         3 000504   000040 116007                    CMPQ    32,DL
         3 000505   002414 601000 3                  TNZ     END_OPTION
         3 000506   001232 710000 3                  TRA     s:14435
         3 000507   000031 116007                    CMPQ    25,DL
         3 000510   000533 602000 3                  TNC     s:14154+55
         3 000511   001317 600000 3                  TZE     s:14492
         3 000512   000033 116007                    CMPQ    27,DL
         3 000513   000527 602000 3                  TNC     s:14154+51
         3 000514   001317 600000 3                  TZE     s:14492
         3 000515   000035 116007                    CMPQ    29,DL
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:116  
         3 000516   000523 602000 3                  TNC     s:14154+47
         3 000517   001317 600000 3                  TZE     s:14492
         3 000520   000036 116007                    CMPQ    30,DL
         3 000521   002414 601000 3                  TNZ     END_OPTION
         3 000522   001317 710000 3                  TRA     s:14492
         3 000523   000000 235000 xsym               LDA     CODE
         3 000524   000034 115007                    CMPA    28,DL
         3 000525   002414 601000 3                  TNZ     END_OPTION
         3 000526   001317 710000 3                  TRA     s:14492
         3 000527   000000 235000 xsym               LDA     CODE
         3 000530   000032 115007                    CMPA    26,DL
         3 000531   002414 601000 3                  TNZ     END_OPTION
         3 000532   000750 710000 3                  TRA     s:14272
         3 000533   000000 236000 xsym               LDQ     CODE
         3 000534   000024 116007                    CMPQ    20,DL
         3 000535   000550 602000 3                  TNC     s:14154+68
         3 000536   001272 600000 3                  TZE     s:14471
         3 000537   000027 116007                    CMPQ    23,DL
         3 000540   000545 602000 3                  TNC     s:14154+65
         3 000541   001317 600000 3                  TZE     s:14492
         3 000542   000030 116007                    CMPQ    24,DL
         3 000543   002414 601000 3                  TNZ     END_OPTION
         3 000544   001317 710000 3                  TRA     s:14492
         3 000545   000025 116007                    CMPQ    21,DL
         3 000546   002414 601000 3                  TNZ     END_OPTION
         3 000547   001317 710000 3                  TRA     s:14492
         3 000550   000020 116007                    CMPQ    16,DL
         3 000551   000554 602000 3                  TNC     s:14154+72
         3 000552   000733 600000 3                  TZE     s:14258
         3 000553   002414 710000 3                  TRA     END_OPTION
         3 000554   000014 116007                    CMPQ    12,DL
         3 000555   002414 601000 3                  TNZ     END_OPTION
         3 000556   000750 710000 3                  TRA     s:14272

      608    14155                                                                                    /**/
      609    14156    4            SELECT( 45 /* TCD_PRO_VAL */ ) ;

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:117  
      610    14157                                                /* Profile                            */
      611    14158    5            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE = 7   /*  NONE_VAL  */ THEN DO;

  14158  3 000557   200023 470500                    LDP0    PTR$,,AUTO
         3 000560   000003 471500                    LDP1    3,,PR0
         3 000561   100000 720100                    LXL0    0,,PR1
         3 000562   000007 100003                    CMPX0   7,DU
         3 000563   000575 601000 3                  TNZ     s:14163

      612    14159    5               KL$TREC.PNAME.CNT=0;

  14159  3 000564   200003 473500                    LDP3    @TREC$,,AUTO
         3 000565   300000 474500                    LDP4    0,,PR3
         3 000566   000000 236003                    LDQ     0,DU
         3 000567   400004 552140                    STBQ    4,'40'O,PR4

      613    14160    5               KL$TREC.PNAME.TXT=' ';

  14160  3 000570   300000 470500                    LDP0    0,,PR3
         3 000571   040100 100400                    MLR     fill='040'O
         3 000572   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000573   000004 200013                    ADSC9   4,,PR0                   cn=1,n=11

      614    14161    5               GOTO END_OPTION;

  14161  3 000574   002414 710000 3                  TRA     END_OPTION

      615    14162    5               END;  /*  Profile = none  */
      616    14163    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  14163  3 000575   000003 236100                    LDQ     3,,PR0
         3 000576   200033 756100                    STQ     BLK$,,AUTO

      617    14164    4            CNT = OUT$SYM.COUNT ;

  14164  3 000577   200033 473500                    LDP3    BLK$,,AUTO
         3 000600   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:118  
         3 000601   000033 772000                    QRL     27
         3 000602   200022 756100                    STQ     CNT,,AUTO

      618    14165    4            IF CNT > 11

  14165  3 000603   000014 116007                    CMPQ    12,DL
         3 000604   000612 602000 3                  TNC     s:14186

      619    14166    4            THEN
      620    14167    5            DO ;

      621    14168                    %SCREAM( ERR#=E$PRO_TOO_LONG, MID='A', LEVEL=ERROR );

  14180  3 000605   000012 630400 4                  EPPR0   10
         3 000606   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000607   000000 701000 xent               TSX1    ASH$ERROR
         3 000610   000000 011000                    NOP     0

      622    14183    5               GOTO END_OPTION ;

  14183  3 000611   002414 710000 3                  TRA     END_OPTION

      623    14184    5               END ;               /* Then do                            */
      624    14185                                                /* Check if profile exists            */
      625    14186    4            PRO$ = ADDR(PRO_BUF);

  14186  3 000612   200036 634500                    EPPR4   PRO_BUF,,AUTO
         3 000613   200035 454500                    STP4    PRO$,,AUTO

      626    14187    4            ARS=LENGTHC(PRO_BUF);

  14187  3 000614   002000 235007                    LDA     1024,DL
         3 000615   200017 755100                    STA     ARS,,AUTO

      627    14188    4            USERS_KEY.COUNT = OUT$SYM.COUNT ;

  14188  3 000616   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:119  
         3 000617   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      628    14189    4            USERS_KEY.TXTC = OUT$SYM.TEXT ;

  14189  3 000620   300004 236100                    LDQ     4,,PR3
         3 000621   000033 772000                    QRL     27
         3 000622   000000 620006                    EAX0    0,QL
         3 000623   040000 100540                    MLR     fill='040'O
         3 000624   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 000625   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      629    14190    4            CALL ASD$READ_PRO( USERS_KEY, KL$PHDR, ARS )

  14190  3 000626   200017 631500                    EPPR1   ARS,,AUTO
         3 000627   200612 451500                    STP1    L+3,,AUTO
         3 000630   200035 236100                    LDQ     PRO$,,AUTO
         3 000631   000013 235000 4                  LDA     11
         3 000632   200610 757100                    STAQ    L+1,,AUTO
         3 000633   200610 630500                    EPPR0   L+1,,AUTO
         3 000634   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000635   000000 701000 xent               TSX1    ASD$READ_PRO
         3 000636   000640 702000 3                  TSX2    s:14192
         3 000637   000650 710000 3                  TRA     s:14212

      630    14191    5            WHENALTRETURN DO ;

      631    14192    5               AS_FIELD1 = USERS_KEY ;

  14192  3 000640   000000 100400                    MLR     fill='000'O
         3 000641   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         3 000642   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      632    14193                    %SCREAM( ERR#=E$PRO_NO_EXIST, LEVEL=ERROR, MID='A' ) ;

  14205  3 000643   000014 630400 4                  EPPR0   12
         3 000644   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000645   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:120  
         3 000646   000000 011000                    NOP     0

      633    14208    5               GOTO CON_LOOP ;

  14208  3 000647   000341 710000 3                  TRA     CON_LOOP

      634    14209    5               END; /*  Whenaltreturn  */
      635    14210                                                                                    /**/
      636    14211                                                /* It exists                          */
      637    14212    5            IF SUB AND KL$PHDR.TTYP ~= %KLTY_SDEV# THEN DO;

  14212  3 000650   200007 470500                    LDP0    @SUB,,AUTO
         3 000651   000000 234100                    SZN     0,,PR0
         3 000652   000667 605000 3                  TPL     s:14235
         3 000653   200035 471500                    LDP1    PRO$,,AUTO
         3 000654   000100 101500                    MRL     fill='000'O
         3 000655   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         3 000656   200610 000004                    ADSC9   L+1,,AUTO                cn=0,n=4
         3 000657   200610 236100                    LDQ     L+1,,AUTO
         3 000660   000001 116007                    CMPQ    1,DL
         3 000661   000667 600000 3                  TZE     s:14235

      638    14213        /*E* ERROR: ASA-E$CONPROTYPE-0
      639    14214             MESSAGE: Profile must be of terminal-console type.
      640    14215             MESSAGE1: The profile be one that describes a terminal-console
      641    14216                       For example, IRBTOC or 2780OC.
      642    14217        */
      643    14218                    %SCREAM( ERR#=E$CONPROTYPE, MID='A', LEVEL=ERROR );

  14230  3 000662   000015 630400 4                  EPPR0   13
         3 000663   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000664   000000 701000 xent               TSX1    ASH$ERROR
         3 000665   000000 011000                    NOP     0

      644    14233    5               GOTO END_OPTION;

  14233  3 000666   002414 710000 3                  TRA     END_OPTION
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:121  

      645    14234    5               END;
      646    14235    5            IF NOT SUB AND (KL$PHDR.TTYP~=%KLTY_TTY# AND KL$PHDR.TTYP~=%KLTY_LINEDEV#)
             14235                     THEN DO;

  14235  3 000667   000000 234100                    SZN     0,,PR0
         3 000670   000713 604000 3                  TMI     s:14253
         3 000671   200035 471500                    LDP1    PRO$,,AUTO
         3 000672   000100 101500                    MRL     fill='000'O
         3 000673   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         3 000674   200610 000004                    ADSC9   L+1,,AUTO                cn=0,n=4
         3 000675   200610 236100                    LDQ     L+1,,AUTO
         3 000676   000002 116007                    CMPQ    2,DL
         3 000677   000713 600000 3                  TZE     s:14253
         3 000700   000100 101500                    MRL     fill='000'O
         3 000701   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         3 000702   200611 000004                    ADSC9   L+2,,AUTO                cn=0,n=4
         3 000703   200611 236100                    LDQ     L+2,,AUTO
         3 000704   000012 116007                    CMPQ    10,DL
         3 000705   000713 600000 3                  TZE     s:14253

      647    14236                    %SCREAM( ERR#=E$ASYNCPROTYPE, MID='A', LEVEL=ERROR ) ;

  14248  3 000706   000016 630400 4                  EPPR0   14
         3 000707   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000710   000000 701000 xent               TSX1    ASH$ERROR
         3 000711   000000 011000                    NOP     0

      648    14251    5               GOTO END_OPTION;

  14251  3 000712   002414 710000 3                  TRA     END_OPTION

      649    14252    5               END;
      650    14253    4            PATTR = KL$PHDR.ATTR ;

  14253  3 000713   200035 471500                    LDP1    PRO$,,AUTO
         3 000714   000100 100500                    MLR     fill='000'O
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:122  
         3 000715   100001 000002                    ADSC9   1,,PR1                   cn=0,n=2
         3 000716   200027 000002                    ADSC9   PATTR,,AUTO              cn=0,n=2

      651    14254    4            IO=KL$PHDR.IO;

  14254  3 000717   003100 060500                    CSL     bolr='003'O
         3 000720   100001 400002                    BDSC    1,,PR1                   by=2,bit=0,n=2
         3 000721   200030 000002                    BDSC    IO,,AUTO                 by=0,bit=0,n=2

      652    14255    4            DDEV=KL$PHDR.DDEV;

  14255  3 000722   000100 100500                    MLR     fill='000'O
         3 000723   100001 600001                    ADSC9   1,,PR1                   cn=3,n=1
         3 000724   200031 000001                    ADSC9   DDEV,,AUTO               cn=0,n=1

      653    14256    4            KL$TREC.PNAME = USERS_KEY ;

  14256  3 000725   200003 473500                    LDP3    @TREC$,,AUTO
         3 000726   300000 474500                    LDP4    0,,PR3
         3 000727   000100 100400                    MLR     fill='000'O
         3 000730   000000 000014 xsym               ADSC9   USERS_KEY                cn=0,n=12
         3 000731   400004 000014                    ADSC9   4,,PR4                   cn=0,n=12
         3 000732   002414 710000 3                  TRA     END_OPTION

      654    14257                                                                                    /**/
      655    14258    4            SELECT( 16   /*  EOL_VAL  */ ) ;

  14258  3 000733   002414 710000 3                  TRA     END_OPTION

      656    14259                                                              /**/
      657    14260    4            SELECT( 302 /* HELP_VAL */ ) ;

      658    14261    4            CALL ASH$HELP ;

  14261  3 000734   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000735   000000 701000 xent               TSX1    ASH$HELP
         3 000736   000000 011000                    NOP     0
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:123  
         3 000737   002414 710000 3                  TRA     END_OPTION

      659    14262                                                              /**/
      660    14263    4            SELECT( 301 /* QUESTION_VAL */ ) ;

      661    14264    4            CALL ASH$QUEST ;

  14264  3 000740   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000741   000000 701000 xent               TSX1    ASH$QUEST
         3 000742   000000 011000                    NOP     0
         3 000743   002414 710000 3                  TRA     END_OPTION

      662    14265                                                              /**/
      663    14266    4            SELECT( 300 /* DQUESTION_VAL */ ) ;

      664    14267    4            CALL ASH$DQUEST ;

  14267  3 000744   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000745   000000 701000 xent               TSX1    ASH$DQUEST
         3 000746   000000 011000                    NOP     0
         3 000747   002414 710000 3                  TRA     END_OPTION

      665    14268                                                                                    /**/
      666    14269    4            SELECT( 12   /*  END_VAL  */ ,

      667    14270    4                 26   /*  BLANK_LINE_VAL */ ) ;
      668    14271                                                /* Done                               */
      669    14272    4            MORE = AS_FALSE ;

  14272  3 000750   000000 236000 xsym               LDQ     AS_FALSE
         3 000751   400000 376003                    ANQ     -131072,DU
         3 000752   200024 756100                    STQ     MORE,,AUTO
         3 000753   002414 710000 3                  TRA     END_OPTION

      670    14273                                                                                    /**/
      671    14274                                                                                    /**/
      672    14275    4            SELECT( 33 /* TERM_PASS */ ) ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:124  

      673    14276                                                /* Password                           */
      674    14277    5            IF SUB THEN DO;

  14277  3 000754   200007 470500                    LDP0    @SUB,,AUTO
         3 000755   000000 234100                    SZN     0,,PR0
         3 000756   000764 605000 3                  TPL     s:14299

      675    14278        /*   ERROR: ASA-E$DEVSUBPASS-0
      676    14279             MESSAGE: The password option is not legal.
      677    14280             MESSAGE1: Passwords dont make sense for devices that cant log on.
      678    14281        */
      679    14282                    %SCREAM( ERR#=E$DEVSUBPASS, LEVEL=ERROR, MID='A' ) ;

  14294  3 000757   000017 630400 4                  EPPR0   15
         3 000760   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000761   000000 701000 xent               TSX1    ASH$ERROR
         3 000762   000000 011000                    NOP     0

      680    14297    5               GOTO END_OPTION;

  14297  3 000763   002414 710000 3                  TRA     END_OPTION

      681    14298    5               END;
      682    14299    4            CODE2 = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14299  3 000764   200023 471500                    LDP1    PTR$,,AUTO
         3 000765   100003 473500                    LDP3    3,,PR1
         3 000766   300000 236100                    LDQ     0,,PR3
         3 000767   777777 376007                    ANQ     -1,DL
         3 000770   200021 756100                    STQ     CODE2,,AUTO

      683    14300    5            DO SELECT( CODE2 ) ;

  14300  3 000771   000053 116007                    CMPQ    43,DL
         3 000772   000777 602000 3                  TNC     s:14300+6
         3 000773   001017 600000 3                  TZE     s:14307
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:125  
         3 000774   000057 116007                    CMPQ    47,DL
         3 000775   002414 601000 3                  TNZ     END_OPTION
         3 000776   001052 710000 3                  TRA     s:14333
         3 000777   000007 116007                    CMPQ    7,DL
         3 001000   002414 601000 3                  TNZ     END_OPTION
         3 001001   001002 710000 3                  TRA     s:14303

      684    14301                                                                                    /**/
      685    14302    5               SELECT( 7   /*  NONE_VAL  */ ) ;

      686    14303    5               KL$TREC.PASSWORD = AS_BLANK ;

  14303  3 001002   200003 474500                    LDP4    @TREC$,,AUTO
         3 001003   400000 475500                    LDP5    0,,PR4
         3 001004   040100 100400                    MLR     fill='040'O
         3 001005   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 001006   500002 000010                    ADSC9   2,,PR5                   cn=0,n=8

      687    14304    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;

  14304  3 001007   400000 471500                    LDP1    0,,PR4
         3 001010   100002 633500                    EPPR3   2,,PR1
         3 001011   200610 453500                    STP3    L+1,,AUTO
         3 001012   200610 630500                    EPPR0   L+1,,AUTO
         3 001013   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001014   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         3 001015   000000 011000                    NOP     0
         3 001016   002414 710000 3                  TRA     END_OPTION

      688    14305                                                                                    /**/
      689    14306    5               SELECT( 43 /* TERM_PW */ ) ;

      690    14307    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  14307  3 001017   100003 236100                    LDQ     3,,PR1
         3 001020   200033 756100                    STQ     BLK$,,AUTO

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:126  
      691    14308    5               CNT =  OUT$SYM.COUNT ;

  14308  3 001021   200033 474500                    LDP4    BLK$,,AUTO
         3 001022   400004 236100                    LDQ     4,,PR4
         3 001023   000033 772000                    QRL     27
         3 001024   200022 756100                    STQ     CNT,,AUTO

      692    14309    5               IF CNT > 8

  14309  3 001025   000011 116007                    CMPQ    9,DL
         3 001026   001034 602000 3                  TNC     s:14329

      693    14310    5               THEN
      694    14311    6               DO ;

      695    14312                       %SCREAM( ERR#=E$PASSW_TOO_LONG, MID='A', LEVEL=ERROR);

  14324  3 001027   000020 630400 4                  EPPR0   16
         3 001030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001031   000000 701000 xent               TSX1    ASH$ERROR
         3 001032   000000 011000                    NOP     0

      696    14327    6                  GOTO END_OPTION ;

  14327  3 001033   002414 710000 3                  TRA     END_OPTION

      697    14328    6                  END ;            /* Then do                            */
      698    14329    5               KL$TREC.PASSWORD = OUT$SYM.TEXT ;

  14329  3 001034   200003 475500                    LDP5    @TREC$,,AUTO
         3 001035   500000 476500                    LDP6    0,,PR5
         3 001036   000000 620006                    EAX0    0,QL
         3 001037   040100 100540                    MLR     fill='040'O
         3 001040   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         3 001041   600002 000010                    ADSC9   2,,PR6                   cn=0,n=8

      699    14330    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:127  

  14330  3 001042   500000 471500                    LDP1    0,,PR5
         3 001043   100002 633500                    EPPR3   2,,PR1
         3 001044   200610 453500                    STP3    L+1,,AUTO
         3 001045   200610 630500                    EPPR0   L+1,,AUTO
         3 001046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001047   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         3 001050   000000 011000                    NOP     0
         3 001051   002414 710000 3                  TRA     END_OPTION

      700    14331                                                                                    /**/
      701    14332    5               SELECT( 47   /*  OCT_PASS_VAL */ ) ;

      702    14333    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);

  14333  3 001052   300003 236100                    LDQ     3,,PR3
         3 001053   200033 756100                    STQ     BLK$,,AUTO

      703    14334    5               CNT = OUT$SYM.COUNT;

  14334  3 001054   200033 474500                    LDP4    BLK$,,AUTO
         3 001055   400004 236100                    LDQ     4,,PR4
         3 001056   000033 772000                    QRL     27
         3 001057   200022 756100                    STQ     CNT,,AUTO

      704    14335    6               IF CNT ~= 24 THEN DO;

  14335  3 001060   000030 116007                    CMPQ    24,DL
         3 001061   001067 600000 3                  TZE     s:14357

      705    14336        /*E*  ERROR:    AS-E$OCTAL_PASSWORD_LENGTH_ERR-C
      706    14337              MESSAGE: PASSWORD not the right size.
      707    14338              MESSAGE1: PASSWORD in octal form must be 24 characters long.
      708    14339        */
      709    14340                       %SCREAM(ERR#=E$OCTAL_PASSWORD_LENGTH_ERR,LEVEL=ERROR,MID='A');

  14352  3 001062   000021 630400 4                  EPPR0   17
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:128  
         3 001063   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001064   000000 701000 xent               TSX1    ASH$ERROR
         3 001065   000000 011000                    NOP     0

      710    14355    6                  END; /*  Length error  */

  14355  3 001066   002414 710000 3                  TRA     END_OPTION

      711    14356    6               ELSE DO;

      712    14357    6                  P$ = ADDR ( OUT$SYM.TEXT );

  14357  3 001067   200033 236100                    LDQ     BLK$,,AUTO
         3 001070   000022 036000 4                  ADLQ    18
         3 001071   200602 756100                    STQ     P$,,AUTO

      713    14358    6                  PTR$ = PINCRC (P$,24);

  14358  3 001072   000006 036003                    ADLQ    6,DU
         3 001073   200023 756100                    STQ     PTR$,,AUTO

      714    14359    6                  TEMP$ = ADDR (KL$TREC.PASSWORD);

  14359  3 001074   200003 471500                    LDP1    @TREC$,,AUTO
         3 001075   100000 473500                    LDP3    0,,PR1
         3 001076   300002 635500                    EPPR5   2,,PR3
         3 001077   200604 455500                    STP5    TEMP$,,AUTO

      715    14360    7                  DO WHILE P$ < PTR$ ;

  14360  3 001100   200602 116100                    CMPQ    P$,,AUTO
         3 001101   002414 602000 3                  TNC     END_OPTION
         3 001102   002414 600000 3                  TZE     END_OPTION

      716    14361    7                     CALL CHARBIN (L, P$->ACHAR);

  14361  3 001103   200602 470500                    LDP0    P$,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:129  
         3 001104   000100 305500                    DTB
         3 001105   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         3 001106   200607 000004                    NDSC9   L,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      717    14362    7                     P$ = PINCRC (P$,1);

  14362  3 001107   200602 236100                    LDQ     P$,,AUTO
         3 001110   200000 036007                    ADLQ    65536,DL
         3 001111   200602 756100                    STQ     P$,,AUTO

      718    14363    7                     CALL CHARBIN (J, P$-> ACHAR);

  14363  3 001112   200602 470500                    LDP0    P$,,AUTO
         3 001113   000100 305500                    DTB
         3 001114   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         3 001115   200605 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      719    14364    7                     P$ = PINCRC (P$,1);

  14364  3 001116   200000 036007                    ADLQ    65536,DL
         3 001117   200602 756100                    STQ     P$,,AUTO

      720    14365    7                     CALL CHARBIN (K, P$->ACHAR);

  14365  3 001120   200602 470500                    LDP0    P$,,AUTO
         3 001121   000100 305500                    DTB
         3 001122   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         3 001123   200606 000004                    NDSC9   K,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      721    14366    7                     TEMP = L * 64 + J * 8 + K;

  14366  3 001124   200607 236100                    LDQ     L,,AUTO
         3 001125   000003 736000                    QLS     3
         3 001126   200605 036100                    ADLQ    J,,AUTO
         3 001127   000003 736000                    QLS     3
         3 001130   200606 036100                    ADLQ    K,,AUTO
         3 001131   200603 756100                    STQ     TEMP,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:130  

      722    14367    7                     P$ = PINCRC (P$, 1);

  14367  3 001132   200602 236100                    LDQ     P$,,AUTO
         3 001133   200000 036007                    ADLQ    65536,DL
         3 001134   200602 756100                    STQ     P$,,AUTO

      723    14368    7                     TEMP$ -> ACHAR = BINASC ( TEMP );

  14368  3 001135   200603 236100                    LDQ     TEMP,,AUTO
         3 001136   000033 736000                    QLS     27
         3 001137   000023 276000 4                  ORQ     19
         3 001140   200610 756100                    STQ     L+1,,AUTO
         3 001141   200604 470500                    LDP0    TEMP$,,AUTO
         3 001142   040100 100500                    MLR     fill='040'O
         3 001143   200610 000004                    ADSC9   L+1,,AUTO                cn=0,n=4
         3 001144   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      724    14369    7                     TEMP$ = PINCRC (TEMP$, 1);

  14369  3 001145   200604 236100                    LDQ     TEMP$,,AUTO
         3 001146   200000 036007                    ADLQ    65536,DL
         3 001147   200604 756100                    STQ     TEMP$,,AUTO

      725    14370    7                     END; /*  Do while P$ < PTR$  */

  14370  3 001150   200602 236100                    LDQ     P$,,AUTO
         3 001151   200023 116100                    CMPQ    PTR$,,AUTO
         3 001152   001103 602000 3                  TNC     s:14361

      726    14371    6                  END; /*  Length ok  */

      727    14372    5               END ;                 /* Do case( CODE2 )                   */

  14372  3 001153   002414 710000 3                  TRA     END_OPTION

      728    14373                                                                                    /**/
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:131  
      729    14374    4            SELECT( 49 /* TCD_MAXPRIO */ ) ;

      730    14375    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  14375  3 001154   100003 236100                    LDQ     3,,PR1
         3 001155   200033 756100                    STQ     BLK$,,AUTO

      731    14376    4            CALL CHARBIN( CNT, OUT$SYM.TEXT ) ;

  14376  3 001156   200033 475500                    LDP5    BLK$,,AUTO
         3 001157   500004 236100                    LDQ     4,,PR5
         3 001160   000033 772000                    QRL     27
         3 001161   000000 622006                    EAX2    0,QL
         3 001162   000100 305540                    DTB
         3 001163   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 001164   200610 000010                    NDSC9   L+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         3 001165   200611 235100                    LDA     L+2,,AUTO
         3 001166   200022 755100                    STA     CNT,,AUTO

      732    14377    4            IF CNT > 15

  14377  3 001167   000020 115007                    CMPA    16,DL
         3 001170   001176 602000 3                  TNC     s:14401

      733    14378    4            THEN
      734    14379    5            DO ;

      735    14380        /*E*  ERROR:    ASA-E$MAXPRIO_TOO_BIG-C
      736    14381              MESSAGE:  MAXPRIO too big.
      737    14382              MESSAGE1: MAXPRIO may not exceed 15.
      738    14383        */
      739    14384                    %SCREAM( ERR#=E$MAXPRIO_TOO_BIG, LEVEL=ERROR, MID='A' ) ;

  14396  3 001171   000024 630400 4                  EPPR0   20
         3 001172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001173   000000 701000 xent               TSX1    ASH$ERROR
         3 001174   000000 011000                    NOP     0
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:132  

      740    14399    5               GOTO END_OPTION ;

  14399  3 001175   002414 710000 3                  TRA     END_OPTION

      741    14400    5               END ;               /* Then do                            */
      742    14401    4            KL$TREC.OCINFO.MXPRI = CNT ;

  14401  3 001176   300000 474500                    LDP4    0,,PR3
         3 001177   200022 236100                    LDQ     CNT,,AUTO
         3 001200   400034 552104                    STBQ    28,'04'O,PR4

      743    14402                                                                                    /**/
      744    14403    4            BLK$= PTR$->P$NODE.SUBLK$(0) ;

  14403  3 001201   100003 236100                    LDQ     3,,PR1
         3 001202   200033 756100                    STQ     BLK$,,AUTO
         3 001203   002414 710000 3                  TRA     END_OPTION

      745    14404
      746    14405    4            SELECT(31 /* CONSOLE WSN */) ;

      747    14406    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;

  14406  3 001204   100003 236100                    LDQ     3,,PR1
         3 001205   200033 756100                    STQ     BLK$,,AUTO

      748    14407    4            IF OUT$SYM.COUNT > 8

  14407  3 001206   200033 475500                    LDP5    BLK$,,AUTO
         3 001207   500004 236100                    LDQ     4,,PR5
         3 001210   777000 376003                    ANQ     -512,DU
         3 001211   011000 116003                    CMPQ    4608,DU
         3 001212   001220 602000 3                  TNC     s:14430

      749    14408    5            THEN DO;

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:133  
      750    14409                              /*E* ERROR:   ASA-E$WSNNAMETOOBIG-C
      751    14410                                   MESSAGE: %U1 is too long for a WSN name.
      752    14411                                   MESSAGE1: Max length for a WSN name is 8 characters.
      753    14412                              */
      754    14413                    %SCREAM (ERR#=E$WSNNAMETOOBIG, MID='A', LEVEL=ERROR );

  14425  3 001213   000025 630400 4                  EPPR0   21
         3 001214   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001215   000000 701000 xent               TSX1    ASH$ERROR
         3 001216   000000 011000                    NOP     0

      755    14428    5               END;

  14428  3 001217   002414 710000 3                  TRA     END_OPTION

      756    14429    5            ELSE DO;

      757    14430    5               KL$TREC.OCINFO.WSN = OUT$SYM.TEXT;

  14430  3 001220   500004 236100                    LDQ     4,,PR5
         3 001221   000033 772000                    QRL     27
         3 001222   000000 622006                    EAX2    0,QL
         3 001223   040100 100540                    MLR     fill='040'O
         3 001224   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 001225   400036 000010                    ADSC9   30,,PR4                  cn=0,n=8

      758    14431    5               C_WSN_FLG = AS_TRUE;

  14431  3 001226   000000 236000 xsym               LDQ     AS_TRUE
         3 001227   400000 376003                    ANQ     -131072,DU
         3 001230   200443 756100                    STQ     C_WSN_FLG,,AUTO

      759    14432    5               END;

  14432  3 001231   002414 710000 3                  TRA     END_OPTION

      760    14433                                                             /**/
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:134  
      761    14434    4            SELECT( 32  /* CONSOLE COMMAND */ );

      762    14435    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;

  14435  3 001232   100003 236100                    LDQ     3,,PR1
         3 001233   200033 756100                    STQ     BLK$,,AUTO

      763    14436    4            IF OUT$SYM.CODE = 7   /*  NONE_VAL  */

  14436  3 001234   200033 475500                    LDP5    BLK$,,AUTO
         3 001235   500000 722100                    LXL2    0,,PR5
         3 001236   000007 102003                    CMPX2   7,DU
         3 001237   001245 601000 3                  TNZ     s:14442

      764    14437    5            THEN DO;

      765    14438    5               CNT = 0;

  14438  3 001240   200022 450100                    STZ     CNT,,AUTO

      766    14439    5               COMMAND = AS_BLANK;

  14439  3 001241   040100 100400                    MLR     fill='040'O
         3 001242   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 001243   200445 000120                    ADSC9   COMMAND,,AUTO            cn=0,n=80

      767    14440    5               END;

  14440  3 001244   001254 710000 3                  TRA     s:14445

      768    14441    5            ELSE DO;

      769    14442    5               CNT = OUT$SYM.COUNT ;

  14442  3 001245   500004 236100                    LDQ     4,,PR5
         3 001246   000033 772000                    QRL     27
         3 001247   200022 756100                    STQ     CNT,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:135  

      770    14443    5               COMMAND = OUT$SYM.TEXT;

  14443  3 001250   000000 623006                    EAX3    0,QL
         3 001251   040100 100540                    MLR     fill='040'O
         3 001252   500004 200013                    ADSC9   4,,PR5                   cn=1,n=*X3
         3 001253   200445 000120                    ADSC9   COMMAND,,AUTO            cn=0,n=80

      771    14444    5               END;

      772    14445    4            IF CNT>80 THEN

  14445  3 001254   200022 235100                    LDA     CNT,,AUTO
         3 001255   000121 115007                    CMPA    81,DL
         3 001256   001264 602000 3                  TNC     s:14468

      773    14446    5            DO;

      774    14447        /*    ERROR: ASA-E$CMDTOOBIG-C
      775    14448              MESSAGE: Command is too long.
      776    14449              MESSAGE1: Command is limited to 80 characters.
      777    14450        */
      778    14451                    %SCREAM( ERR#=E$CMDTOOBIG, LEVEL=ERROR, MID='A' ) ;

  14463  3 001257   000026 630400 4                  EPPR0   22
         3 001260   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001261   000000 701000 xent               TSX1    ASH$ERROR
         3 001262   000000 011000                    NOP     0

      779    14466    5               GOTO END_OPTION ;

  14466  3 001263   002414 710000 3                  TRA     END_OPTION

      780    14467    5               END ;            /* Then do                            */
      781    14468    4            KL$TREC.OCINFO.CMDCNT = CNT ;

  14468  3 001264   400043 755100                    STA     35,,PR4
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:136  

      782    14469    4            KL$TREC.OCINFO.CMD = COMMAND;

  14469  3 001265   300000 474500                    LDP4    0,,PR3
         3 001266   040100 100500                    MLR     fill='040'O
         3 001267   200445 000120                    ADSC9   COMMAND,,AUTO            cn=0,n=80
         3 001270   400044 000120                    ADSC9   36,,PR4                  cn=0,n=80
         3 001271   002414 710000 3                  TRA     END_OPTION

      783    14470    4            SELECT ( 20  /* CONSOLE NATIVE LANGUAGE */ ) ;

      784    14471    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;

  14471  3 001272   200023 470500                    LDP0    PTR$,,AUTO
         3 001273   000003 236100                    LDQ     3,,PR0
         3 001274   200033 756100                    STQ     BLK$,,AUTO

      785    14472    4            CNT = OUT$SYM.COUNT ;

  14472  3 001275   200033 471500                    LDP1    BLK$,,AUTO
         3 001276   100004 236100                    LDQ     4,,PR1
         3 001277   000033 772000                    QRL     27
         3 001300   200022 756100                    STQ     CNT,,AUTO

      786    14473    4            IF CNT = 1 THEN

  14473  3 001301   000001 116007                    CMPQ    1,DL
         3 001302   001312 601000 3                  TNZ     s:14476

      787    14474    4               KL$TREC.OCINFO.LANG = OUT$SYM.TEXT ;

  14474  3 001303   200003 473500                    LDP3    @TREC$,,AUTO
         3 001304   300000 474500                    LDP4    0,,PR3
         3 001305   000000 620006                    EAX0    0,QL
         3 001306   040100 100540                    MLR     fill='040'O
         3 001307   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         3 001310   400034 400001                    ADSC9   28,,PR4                  cn=2,n=1
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:137  
         3 001311   002414 710000 3                  TRA     END_OPTION

      788    14475    4            ELSE
      789    14476    4               KL$TREC.OCINFO.LANG = ' ' ;

  14476  3 001312   200003 473500                    LDP3    @TREC$,,AUTO
         3 001313   300000 474500                    LDP4    0,,PR3
         3 001314   040000 236007                    LDQ     16384,DL
         3 001315   400034 552110                    STBQ    28,'10'O,PR4
         3 001316   002414 710000 3                  TRA     END_OPTION

      790    14477
      791    14478    4            SELECT( 25 /* C_SYSTEM */ ,

      792    14479    4                 23 /* C_UADMIN */ ,
      793    14480    4                 27 /* C_PADMIN */ ,
      794    14481    4                 28 /* C_DEVICE */ ,
      795    14482    4                 29 /* C_COMM */ ,
      796    14483    4                 21 /* C_TP */ ,
      797    14484    4                 30 /* CONSOLE ADMIN  */,
      798    14485    4                 24 /* C_SLAVE */ ) ;
      799    14486        /*E*  ERROR:    ASA-E$ILLEGAL_OPT_FOR_LOCAL-C
      800    14487              MESSAGE:  Illegal option for a LOCAL terminal.
      801    14488        */
      802    14489        /*E*  ERROR:    ASA-E$ILLEGAL_OPT_FOR_NONLOCAL-C
      803    14490              MESSAGE:  Illegal option for a NON-LOCAL terminal.
      804    14491        */
      805    14492    4            IF PTR$ -> P$NODE.SUBNODES > 0

  14492  3 001317   200023 470500                    LDP0    PTR$,,AUTO
         3 001320   000001 220100                    LDX0    1,,PR0
         3 001321   001327 600000 3                  TZE     s:14496

      806    14493    4            THEN
      807    14494    4               CNT = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14494  3 001322   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:138  
         3 001323   100000 236100                    LDQ     0,,PR1
         3 001324   777777 376007                    ANQ     -1,DL
         3 001325   200022 756100                    STQ     CNT,,AUTO
         3 001326   001331 710000 3                  TRA     s:14497

      808    14495    4            ELSE
      809    14496    4               CNT = 1   /*  YES_VAL  */ ;

  14496  3 001327   000001 235007                    LDA     1,DL
         3 001330   200022 755100                    STA     CNT,,AUTO

      810    14497    4            CODE2 = CODE ;

  14497  3 001331   000000 235000 xsym               LDA     CODE
         3 001332   200021 755100                    STA     CODE2,,AUTO

      811    14498    5            DO SELECT( CODE2 ) ;

  14498  3 001333   200021 236100                    LDQ     CODE2,,AUTO
         3 001334   000034 116007                    CMPQ    28,DL
         3 001335   001346 602000 3                  TNC     s:14498+11
         3 001336   001470 600000 3                  TZE     s:14547
         3 001337   000036 116007                    CMPQ    30,DL
         3 001340   001343 602000 3                  TNC     s:14498+8
         3 001341   001414 600000 3                  TZE     s:14525
         3 001342   002414 710000 3                  TRA     END_OPTION
         3 001343   000035 116007                    CMPQ    29,DL
         3 001344   002414 601000 3                  TNZ     END_OPTION
         3 001345   001473 710000 3                  TRA     s:14551
         3 001346   000031 116007                    CMPQ    25,DL
         3 001347   001354 602000 3                  TNC     s:14498+17
         3 001350   001365 600000 3                  TZE     s:14501
         3 001351   000033 116007                    CMPQ    27,DL
         3 001352   002414 601000 3                  TNZ     END_OPTION
         3 001353   001445 710000 3                  TRA     s:14539
         3 001354   000027 116007                    CMPQ    23,DL
         3 001355   001362 602000 3                  TNC     s:14498+23
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:139  
         3 001356   001417 600000 3                  TZE     s:14529
         3 001357   000030 116007                    CMPQ    24,DL
         3 001360   002414 601000 3                  TNZ     END_OPTION
         3 001361   001675 710000 3                  TRA     s:14576
         3 001362   000025 116007                    CMPQ    21,DL
         3 001363   002414 601000 3                  TNZ     END_OPTION
         3 001364   001476 710000 3                  TRA     s:14555

      812    14499                                                                                    /**/
      813    14500    5               SELECT( 25 /* C_SYSTEM */ ) ;

      814    14501    5               IF NOT LOCAL AND (CNT = 45 /* KEYIN  */ OR CNT = 1   /*  YES_VAL  */)

  14501  3 001365   200011 471500                    LDP1    @LOCAL,,AUTO
         3 001366   100000 234100                    SZN     0,,PR1
         3 001367   001402 604000 3                  TMI     s:14520
         3 001370   200022 235100                    LDA     CNT,,AUTO
         3 001371   000055 115007                    CMPA    45,DL
         3 001372   001375 600000 3                  TZE     s:14515
         3 001373   000001 115007                    CMPA    1,DL
         3 001374   001402 601000 3                  TNZ     s:14520

      815    14502    6               THEN DO;

      816    14503                       %SCREAM( ERR#=E$ILLEGAL_OPT_FOR_NONLOCAL, LEVEL=ERROR, MID='A' );

  14515  3 001375   000027 630400 4                  EPPR0   23
         3 001376   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001377   000000 701000 xent               TSX1    ASH$ERROR
         3 001400   000000 011000                    NOP     0

      817    14518    6                  GOTO END_OPTION ;

  14518  3 001401   002414 710000 3                  TRA     END_OPTION

      818    14519    6                  END ;            /* Then do                            */
      819    14520    5               C_SYS_FLG = ( CNT = 1   /*  YES_VAL  */ );
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:140  

  14520  3 001402   400000 221003                    LDX1    -131072,DU
         3 001403   200022 235100                    LDA     CNT,,AUTO
         3 001404   000001 115007                    CMPA    1,DL
         3 001405   001407 600000 3                  TZE     s:14520+5
         3 001406   000000 221003                    LDX1    0,DU
         3 001407   000000 636011                    EAQ     0,X1
         3 001410   200444 756100                    STQ     C_SYS_FLG,,AUTO

      820    14521    5               MASK = '200000'O /* K_SYS  */ ;

  14521  3 001411   200000 236003                    LDQ     65536,DU
         3 001412   200032 756100                    STQ     MASK,,AUTO

      821    14522    5               GOTO SET_KCADDR_CADDR;

  14522  3 001413   001500 710000 3                  TRA     SET_KCADDR_CADDR

      822    14523
      823    14524    5               SELECT(30 /* CONSOLE ADMIN  */ ) ;

      824    14525    5               MASK = '040000'O /* K_ADMIN */ ;

  14525  3 001414   040000 236003                    LDQ     16384,DU
         3 001415   200032 756100                    STQ     MASK,,AUTO

      825    14526    5               GOTO SET_KCADDR_CADDR;

  14526  3 001416   001500 710000 3                  TRA     SET_KCADDR_CADDR

      826    14527                                                                                    /**/
      827    14528    5               SELECT( 23 /* C_UADMIN */ ) ;

      828    14529    6               IF CNT = 1   /*  YES_VAL  */ THEN DO;

  14529  3 001417   200022 235100                    LDA     CNT,,AUTO
         3 001420   000001 115007                    CMPA    1,DL
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:141  
         3 001421   001434 601000 3                  TNZ     s:14534

      829    14530    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~'040000'O
             14530                           /* K_ADMIN */;

  14530  3 001422   200003 471500                    LDP1    @TREC$,,AUTO
         3 001423   100000 473500                    LDP3    0,,PR1
         3 001424   300035 221100                    LDX1    29,,PR3
         3 001425   737777 361003                    ANX1    -16385,DU
         3 001426   300035 741100                    STX1    29,,PR3

      830    14531    6                 KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR | '040000'O /* K_ADMIN */
             14531                           ;

  14531  3 001427   100000 473500                    LDP3    0,,PR1
         3 001430   300034 220100                    LDX0    28,,PR3
         3 001431   040000 260003                    ORX0    16384,DU
         3 001432   300034 740100                    STX0    28,,PR3

      831    14532    6                  END;

  14532  3 001433   002414 710000 3                  TRA     END_OPTION

      832    14533    6               ELSE DO;

      833    14534    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR & ~'040000'O
             14534                           /* K_ADMIN */;

  14534  3 001434   200003 471500                    LDP1    @TREC$,,AUTO
         3 001435   100000 473500                    LDP3    0,,PR1
         3 001436   300034 221100                    LDX1    28,,PR3
         3 001437   737777 361003                    ANX1    -16385,DU
         3 001440   300034 741100                    STX1    28,,PR3

      834    14535    6                  CADDR = CADDR & ~'040000'O /* K_ADMIN */;

  14535  3 001441   200026 220100                    LDX0    CADDR,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:142  
         3 001442   737777 360003                    ANX0    -16385,DU
         3 001443   200026 740100                    STX0    CADDR,,AUTO

      835    14536                                                                                    /**/
      836    14537    6                  END;

  14537  3 001444   002414 710000 3                  TRA     END_OPTION

      837    14538    5               SELECT( 27 /* C_PADMIN */ ) ;

      838    14539    6               IF CNT = 1   /*  YES_VAL  */ THEN DO;

  14539  3 001445   200022 235100                    LDA     CNT,,AUTO
         3 001446   000001 115007                    CMPA    1,DL
         3 001447   001462 601000 3                  TNZ     s:14544

      839    14540    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR | '040000'O
             14540                           /* K_ADMIN */;

  14540  3 001450   200003 471500                    LDP1    @TREC$,,AUTO
         3 001451   100000 473500                    LDP3    0,,PR1
         3 001452   300035 221100                    LDX1    29,,PR3
         3 001453   040000 261003                    ORX1    16384,DU
         3 001454   300035 741100                    STX1    29,,PR3

      840    14541    6                 KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR | '040000'O /* K_ADMIN */
             14541                           ;

  14541  3 001455   100000 473500                    LDP3    0,,PR1
         3 001456   300034 220100                    LDX0    28,,PR3
         3 001457   040000 260003                    ORX0    16384,DU
         3 001460   300034 740100                    STX0    28,,PR3

      841    14542    6                  END;

  14542  3 001461   002414 710000 3                  TRA     END_OPTION

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:143  
      842    14543    5               ELSE
      843    14544    5                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~'040000'O
             14544                           /* K_ADMIN */;

  14544  3 001462   200003 471500                    LDP1    @TREC$,,AUTO
         3 001463   100000 473500                    LDP3    0,,PR1
         3 001464   300035 221100                    LDX1    29,,PR3
         3 001465   737777 361003                    ANX1    -16385,DU
         3 001466   300035 741100                    STX1    29,,PR3
         3 001467   002414 710000 3                  TRA     END_OPTION

      844    14545                                                                                    /**/
      845    14546    5               SELECT( 28 /* C_DEVICE */ ) ;

      846    14547    5               MASK = '100000'O /* K_DEVC  */ ;

  14547  3 001470   100000 236003                    LDQ     32768,DU
         3 001471   200032 756100                    STQ     MASK,,AUTO

      847    14548    5               GOTO SET_KCADDR_CADDR;

  14548  3 001472   001500 710000 3                  TRA     SET_KCADDR_CADDR

      848    14549                                                                                    /**/
      849    14550    5               SELECT( 29 /* C_COMM */ ) ;

      850    14551    5               MASK = '004000'O /* K_COMM */ ;

  14551  3 001473   004000 236003                    LDQ     2048,DU
         3 001474   200032 756100                    STQ     MASK,,AUTO

      851    14552    5               GOTO SET_KCADDR_CADDR ;

  14552  3 001475   001500 710000 3                  TRA     SET_KCADDR_CADDR

      852    14553                                                                                    /**/
      853    14554    5               SELECT( 21 /* C_TP */ ) ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:144  

      854    14555    5               MASK = '001000'O /* K_TP */ ;

  14555  3 001476   001000 236003                    LDQ     512,DU
         3 001477   200032 756100                    STQ     MASK,,AUTO

      855    14556    5   SET_KCADDR_CADDR:
      856    14557    6               DO SELECT(CNT) ;

  14557  3 001500   200022 236100       SET_KCADDR_* LDQ     CNT,,AUTO
         3 001501   000002 116007                    CMPQ    2,DL
         3 001502   001512 602000 3                  TNC     SET_KCADDR_CADDR+10
         3 001503   001535 600000 3                  TZE     s:14562
         3 001504   000031 116007                    CMPQ    25,DL
         3 001505   002414 602000 3                  TNC     END_OPTION
         3 001506   001605 600000 3                  TZE     s:14567
         3 001507   000055 116007                    CMPQ    45,DL
         3 001510   002414 601000 3                  TNZ     END_OPTION
         3 001511   001641 710000 3                  TRA     s:14571
         3 001512   000001 116007                    CMPQ    1,DL
         3 001513   002414 601000 3                  TNZ     END_OPTION
         3 001514   001515 710000 3                  TRA     s:14559

      857    14558    6                  SELECT(1   /*  YES_VAL  */) ;

      858    14559    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR | MASK;

  14559  3 001515   200003 471500                    LDP1    @TREC$,,AUTO
         3 001516   100000 473500                    LDP3    0,,PR1
         3 001517   300035 236100                    LDQ     29,,PR3
         3 001520   777777 376003                    ANQ     -1,DU
         3 001521   200032 276100                    ORQ     MASK,,AUTO
         3 001522   000022 772000                    QRL     18
         3 001523   000000 621006                    EAX1    0,QL
         3 001524   300035 741100                    STX1    29,,PR3

      859    14560    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR | MASK;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:145  

  14560  3 001525   100000 473500                    LDP3    0,,PR1
         3 001526   300034 236100                    LDQ     28,,PR3
         3 001527   777777 376003                    ANQ     -1,DU
         3 001530   200032 276100                    ORQ     MASK,,AUTO
         3 001531   000022 772000                    QRL     18
         3 001532   000000 620006                    EAX0    0,QL
         3 001533   300034 740100                    STX0    28,,PR3
         3 001534   002414 710000 3                  TRA     END_OPTION

      860    14561    6                  SELECT(2   /*  NO_VAL  */ ) ;

      861    14562    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~MASK;

  14562  3 001535   200003 471500                    LDP1    @TREC$,,AUTO
         3 001536   100000 473500                    LDP3    0,,PR1
         3 001537   200032 236100                    LDQ     MASK,,AUTO
         3 001540   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001541   200610 756100                    STQ     L+1,,AUTO
         3 001542   300035 236100                    LDQ     29,,PR3
         3 001543   777777 376003                    ANQ     -1,DU
         3 001544   200610 376100                    ANQ     L+1,,AUTO
         3 001545   000022 772000                    QRL     18
         3 001546   000000 620006                    EAX0    0,QL
         3 001547   300035 740100                    STX0    29,,PR3

      862    14563    6                  KCADDR = KCADDR & ~MASK;

  14563  3 001550   200032 236100                    LDQ     MASK,,AUTO
         3 001551   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001552   200610 756100                    STQ     L+1,,AUTO
         3 001553   200025 236100                    LDQ     KCADDR,,AUTO
         3 001554   777777 376003                    ANQ     -1,DU
         3 001555   200610 376100                    ANQ     L+1,,AUTO
         3 001556   000022 772000                    QRL     18
         3 001557   000000 620006                    EAX0    0,QL
         3 001560   200025 740100                    STX0    KCADDR,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:146  

      863    14564    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR & ~MASK;

  14564  3 001561   100000 473500                    LDP3    0,,PR1
         3 001562   200032 236100                    LDQ     MASK,,AUTO
         3 001563   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001564   200610 756100                    STQ     L+1,,AUTO
         3 001565   300034 236100                    LDQ     28,,PR3
         3 001566   777777 376003                    ANQ     -1,DU
         3 001567   200610 376100                    ANQ     L+1,,AUTO
         3 001570   000022 772000                    QRL     18
         3 001571   000000 621006                    EAX1    0,QL
         3 001572   300034 741100                    STX1    28,,PR3

      864    14565    6                  CADDR = CADDR & ~MASK;

  14565  3 001573   200032 236100                    LDQ     MASK,,AUTO
         3 001574   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001575   200610 756100                    STQ     L+1,,AUTO
         3 001576   200026 236100                    LDQ     CADDR,,AUTO
         3 001577   777777 376003                    ANQ     -1,DU
         3 001600   200610 376100                    ANQ     L+1,,AUTO
         3 001601   000022 772000                    QRL     18
         3 001602   000000 621006                    EAX1    0,QL
         3 001603   200026 741100                    STX1    CADDR,,AUTO
         3 001604   002414 710000 3                  TRA     END_OPTION

      865    14566    6                  SELECT ( 25 /* DISPLAY */ ) ;

      866    14567    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~MASK;

  14567  3 001605   200003 471500                    LDP1    @TREC$,,AUTO
         3 001606   100000 473500                    LDP3    0,,PR1
         3 001607   200032 236100                    LDQ     MASK,,AUTO
         3 001610   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001611   200610 756100                    STQ     L+1,,AUTO
         3 001612   300035 236100                    LDQ     29,,PR3
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:147  
         3 001613   777777 376003                    ANQ     -1,DU
         3 001614   200610 376100                    ANQ     L+1,,AUTO
         3 001615   000022 772000                    QRL     18
         3 001616   000000 620006                    EAX0    0,QL
         3 001617   300035 740100                    STX0    29,,PR3

      867    14568    6                  KCADDR = KCADDR & ~MASK;

  14568  3 001620   200032 236100                    LDQ     MASK,,AUTO
         3 001621   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001622   200610 756100                    STQ     L+1,,AUTO
         3 001623   200025 236100                    LDQ     KCADDR,,AUTO
         3 001624   777777 376003                    ANQ     -1,DU
         3 001625   200610 376100                    ANQ     L+1,,AUTO
         3 001626   000022 772000                    QRL     18
         3 001627   000000 620006                    EAX0    0,QL
         3 001630   200025 740100                    STX0    KCADDR,,AUTO

      868    14569    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR | MASK;

  14569  3 001631   100000 473500                    LDP3    0,,PR1
         3 001632   300034 236100                    LDQ     28,,PR3
         3 001633   777777 376003                    ANQ     -1,DU
         3 001634   200032 276100                    ORQ     MASK,,AUTO
         3 001635   000022 772000                    QRL     18
         3 001636   000000 621006                    EAX1    0,QL
         3 001637   300034 741100                    STX1    28,,PR3
         3 001640   002414 710000 3                  TRA     END_OPTION

      869    14570    6                  SELECT( 45 /* KEYIN  */ ) ;

      870    14571    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR | MASK;

  14571  3 001641   200003 471500                    LDP1    @TREC$,,AUTO
         3 001642   100000 473500                    LDP3    0,,PR1
         3 001643   300035 236100                    LDQ     29,,PR3
         3 001644   777777 376003                    ANQ     -1,DU
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:148  
         3 001645   200032 276100                    ORQ     MASK,,AUTO
         3 001646   000022 772000                    QRL     18
         3 001647   000000 621006                    EAX1    0,QL
         3 001650   300035 741100                    STX1    29,,PR3

      871    14572    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR & ~MASK;

  14572  3 001651   100000 473500                    LDP3    0,,PR1
         3 001652   200032 236100                    LDQ     MASK,,AUTO
         3 001653   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001654   200610 756100                    STQ     L+1,,AUTO
         3 001655   300034 236100                    LDQ     28,,PR3
         3 001656   777777 376003                    ANQ     -1,DU
         3 001657   200610 376100                    ANQ     L+1,,AUTO
         3 001660   000022 772000                    QRL     18
         3 001661   000000 620006                    EAX0    0,QL
         3 001662   300034 740100                    STX0    28,,PR3

      872    14573    6                  CADDR = CADDR & ~MASK;

  14573  3 001663   200032 236100                    LDQ     MASK,,AUTO
         3 001664   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001665   200610 756100                    STQ     L+1,,AUTO
         3 001666   200026 236100                    LDQ     CADDR,,AUTO
         3 001667   777777 376003                    ANQ     -1,DU
         3 001670   200610 376100                    ANQ     L+1,,AUTO
         3 001671   000022 772000                    QRL     18
         3 001672   000000 620006                    EAX0    0,QL
         3 001673   200026 740100                    STX0    CADDR,,AUTO

      873    14574    6                  END;   /* Do case  */

  14574  3 001674   002414 710000 3                  TRA     END_OPTION

      874    14575    5               SELECT( 24 /* C_SLAVE */ ) ;

      875    14576    6               IF LOCAL AND CNT = 1 THEN DO;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:149  

  14576  3 001675   200011 471500                    LDP1    @LOCAL,,AUTO
         3 001676   100000 234100                    SZN     0,,PR1
         3 001677   001710 605000 3                  TPL     s:14594
         3 001700   200022 235100                    LDA     CNT,,AUTO
         3 001701   000001 115007                    CMPA    1,DL
         3 001702   001710 601000 3                  TNZ     s:14594

      876    14577                       %SCREAM( ERR#=E$ILLEGAL_OPT_FOR_LOCAL,LEVEL=ERROR,MID='A' );

  14589  3 001703   000030 630400 4                  EPPR0   24
         3 001704   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001705   000000 701000 xent               TSX1    ASH$ERROR
         3 001706   000000 011000                    NOP     0

      877    14592    6                  GOTO END_OPTION ;

  14592  3 001707   002414 710000 3                  TRA     END_OPTION

      878    14593    6                  END ;            /* Then do                            */
      879    14594    6               IF CNT = 1   /*  YES_VAL  */ THEN DO;

  14594  3 001710   200022 235100                    LDA     CNT,,AUTO
         3 001711   000001 115007                    CMPA    1,DL
         3 001712   001722 601000 3                  TNZ     s:14599

      880    14595    6                  KL$TREC.OCINFO.CADDR = '002000'O /* K_SLAVE */ ;

  14595  3 001713   200003 473500                    LDP3    @TREC$,,AUTO
         3 001714   300000 474500                    LDP4    0,,PR3
         3 001715   002000 221003                    LDX1    1024,DU
         3 001716   400034 741100                    STX1    28,,PR4

      881    14596    6                  KL$TREC.OCINFO.KCADDR = '002000'O /* K_SLAVE */ ;

  14596  3 001717   300000 474500                    LDP4    0,,PR3
         3 001720   400035 741100                    STX1    29,,PR4
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:150  

      882    14597    6                  END;

  14597  3 001721   002414 710000 3                  TRA     END_OPTION

      883    14598    6               ELSE DO;

      884    14599    6                  KL$TREC.OCINFO.CADDR = KL$TREC.OCINFO.CADDR & ~'002000'O
             14599                           /* K_SLAVE */;

  14599  3 001722   200003 473500                    LDP3    @TREC$,,AUTO
         3 001723   300000 474500                    LDP4    0,,PR3
         3 001724   400034 221100                    LDX1    28,,PR4
         3 001725   775777 361003                    ANX1    -1025,DU
         3 001726   400034 741100                    STX1    28,,PR4

      885    14600    6                  KL$TREC.OCINFO.KCADDR = KL$TREC.OCINFO.KCADDR & ~'002000'O
             14600                           /* K_SLAVE */;

  14600  3 001727   300000 474500                    LDP4    0,,PR3
         3 001730   400035 220100                    LDX0    29,,PR4
         3 001731   775777 360003                    ANX0    -1025,DU
         3 001732   400035 740100                    STX0    29,,PR4

      886    14601    6                  END;  /* Do */

      887    14602                                                                                    /**/
      888    14603    5               END ;                 /* Do case( CODE2 )                   */

  14603  3 001733   002414 710000 3                  TRA     END_OPTION

      889    14604                                                                                    /**/
      890    14605    4            SELECT ( %DEV_DEVNUM_VAL ) ;

      891    14606
      892    14607    5            IF NOT SUB THEN DO;

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:151  
  14607  3 001734   200007 475500                    LDP5    @SUB,,AUTO
         3 001735   500000 234100                    SZN     0,,PR5
         3 001736   001744 604000 3                  TMI     s:14630

      893    14608        /*E*  ERROR:  ASA-E$DEVNUMNOTLEGL-0
      894    14609             MESSAGE:  The DEVNUM option is not legal here.
      895    14610             MESSAGE1:  A device number is legal only for a subdevice or subconsole.
      896    14611        */
      897    14612                    %SCREAM (ERR#=%E$DEVNUMNOTLEGL,LEVEL=ERROR,MID='A');

  14624  3 001737   000031 630400 4                  EPPR0   25
         3 001740   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001741   000000 701000 xent               TSX1    ASH$ERROR
         3 001742   000000 011000                    NOP     0

      898    14627    5               GOTO END_OPTION;

  14627  3 001743   002414 710000 3                  TRA     END_OPTION

      899    14628    5               END; /*  Not sub  */
      900    14629
      901    14630    5            DO SELECT( PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE ) ;

  14630  3 001744   100003 476500                    LDP6    3,,PR1
         3 001745   600000 236100                    LDQ     0,,PR6
         3 001746   777777 376007                    ANQ     -1,DL
         3 001747   000010 116007                    CMPQ    8,DL
         3 001750   001777 602000 3                  TNC     s:14630+27
         3 001751   002120 600000 3                  TZE     s:14657
         3 001752   000013 116007                    CMPQ    11,DL
         3 001753   001770 602000 3                  TNC     s:14630+20
         3 001754   002136 600000 3                  TZE     s:14662
         3 001755   000015 116007                    CMPQ    13,DL
         3 001756   001764 602000 3                  TNC     s:14630+16
         3 001757   002226 600000 3                  TZE     s:14682
         3 001760   600000 722100                    LXL2    0,,PR6
         3 001761   000026 102003                    CMPX2   22,DU
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:152  
         3 001762   002414 601000 3                  TNZ     END_OPTION
         3 001763   002244 710000 3                  TRA     s:14687
         3 001764   600000 722100                    LXL2    0,,PR6
         3 001765   000014 102003                    CMPX2   12,DU
         3 001766   002414 601000 3                  TNZ     END_OPTION
         3 001767   002154 710000 3                  TRA     s:14667
         3 001770   000011 116007                    CMPQ    9,DL
         3 001771   002414 602000 3                  TNC     END_OPTION
         3 001772   002172 600000 3                  TZE     s:14672
         3 001773   600000 722100                    LXL2    0,,PR6
         3 001774   000012 102003                    CMPX2   10,DU
         3 001775   002414 601000 3                  TNZ     END_OPTION
         3 001776   002210 710000 3                  TRA     s:14677
         3 001777   000004 116007                    CMPQ    4,DL
         3 002000   002015 602000 3                  TNC     s:14630+41
         3 002001   002054 600000 3                  TZE     s:14642
         3 002002   000006 116007                    CMPQ    6,DL
         3 002003   002011 602000 3                  TNC     s:14630+37
         3 002004   002070 600000 3                  TZE     s:14648
         3 002005   600000 722100                    LXL2    0,,PR6
         3 002006   000007 102003                    CMPX2   7,DU
         3 002007   002414 601000 3                  TNZ     END_OPTION
         3 002010   002076 710000 3                  TRA     s:14651
         3 002011   600000 720100                    LXL0    0,,PR6
         3 002012   000005 100003                    CMPX0   5,DU
         3 002013   002414 601000 3                  TNZ     END_OPTION
         3 002014   002062 710000 3                  TRA     s:14645
         3 002015   600000 236100                    LDQ     0,,PR6
         3 002016   777777 376007                    ANQ     -1,DL
         3 002017   000002 116007                    CMPQ    2,DL
         3 002020   002026 602000 3                  TNC     s:14630+50
         3 002021   002040 600000 3                  TZE     s:14636
         3 002022   600000 720100                    LXL0    0,,PR6
         3 002023   000003 100003                    CMPX0   3,DU
         3 002024   002414 601000 3                  TNZ     END_OPTION
         3 002025   002046 710000 3                  TRA     s:14639
         3 002026   600000 720100                    LXL0    0,,PR6
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:153  
         3 002027   000001 100003                    CMPX0   1,DU
         3 002030   002414 601000 3                  TNZ     END_OPTION
         3 002031   002032 710000 3                  TRA     s:14633

      902    14631
      903    14632    5               SELECT( %PD_2780LP_VAL ) ;

      904    14633    5               KL$DADR.DEVNUM# = %KLDN_2780LP# ;

  14633  3 002032   200014 470500                    LDP0    @DADR$,,AUTO
         3 002033   000000 471500                    LDP1    0,,PR0
         3 002034   003100 060400                    CSL     bolr='003'O
         3 002035   000032 000011 4                  BDSC    26                       by=0,bit=0,n=9
         3 002036   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         3 002037   002414 710000 3                  TRA     END_OPTION

      905    14634
      906    14635    5               SELECT( %PD_2780CR_VAL ) ;

      907    14636    5               KL$DADR.DEVNUM# = %KLDN_2780CR# ;

  14636  3 002040   200014 470500                    LDP0    @DADR$,,AUTO
         3 002041   000000 471500                    LDP1    0,,PR0
         3 002042   003100 060400                    CSL     bolr='003'O
         3 002043   000033 000011 4                  BDSC    27                       by=0,bit=0,n=9
         3 002044   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         3 002045   002414 710000 3                  TRA     END_OPTION

      908    14637
      909    14638    5               SELECT( %PD_2780CP_VAL ) ;

      910    14639    5               KL$DADR.DEVNUM# = %KLDN_2780CP# ;

  14639  3 002046   200014 470500                    LDP0    @DADR$,,AUTO
         3 002047   000000 471500                    LDP1    0,,PR0
         3 002050   003100 060400                    CSL     bolr='003'O
         3 002051   000034 000011 4                  BDSC    28                       by=0,bit=0,n=9
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:154  
         3 002052   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         3 002053   002414 710000 3                  TRA     END_OPTION

      911    14640
      912    14641    5               SELECT( %PD_3780LP_VAL ) ;

      913    14642    5               KL$DADR.DEVNUM# = %KLDN_3780LP# ;

  14642  3 002054   200014 477500                    LDP7    @DADR$,,AUTO
         3 002055   700000 470500                    LDP0    0,,PR7
         3 002056   003100 060400                    CSL     bolr='003'O
         3 002057   000035 000011 4                  BDSC    29                       by=0,bit=0,n=9
         3 002060   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         3 002061   002414 710000 3                  TRA     END_OPTION

      914    14643
      915    14644    5               SELECT( %PD_3780CR_VAL ) ;

      916    14645    5               KL$DADR.DEVNUM# = %KLDN_3780CR# ;

  14645  3 002062   200014 470500                    LDP0    @DADR$,,AUTO
         3 002063   000000 471500                    LDP1    0,,PR0
         3 002064   003100 060400                    CSL     bolr='003'O
         3 002065   000002 000011 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=9
         3 002066   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         3 002067   002414 710000 3                  TRA     END_OPTION

      917    14646
      918    14647    5               SELECT( %PD_3780CP_VAL ) ;

      919    14648    5               KL$DADR.DEVNUM# = %KLDN_3780CP# ;

  14648  3 002070   200014 470500                    LDP0    @DADR$,,AUTO
         3 002071   000000 471500                    LDP1    0,,PR0
         3 002072   003100 060400                    CSL     bolr='003'O
         3 002073   000036 000011 4                  BDSC    30                       by=0,bit=0,n=9
         3 002074   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:155  
         3 002075   002414 710000 3                  TRA     END_OPTION

      920    14649
      921    14650    5               SELECT( %PD_HASPOC_VAL ) ;

      922    14651    5               KL$DADR.DEVNUM# = %KLDN_HASPOC# ;

  14651  3 002076   200014 470500                    LDP0    @DADR$,,AUTO
         3 002077   000000 471500                    LDP1    0,,PR0
         3 002100   003100 060400                    CSL     bolr='003'O
         3 002101   000001 000011 4                  BDSC    1                        by=0,bit=0,n=9
         3 002102   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9

      923    14652    5               KL$DADR.SDNUM# = %KLDN_HASPOCS# ;

  14652  3 002103   000000 471500                    LDP1    0,,PR0
         3 002104   003100 060400                    CSL     bolr='003'O
         3 002105   000037 000011 4                  BDSC    31                       by=0,bit=0,n=9
         3 002106   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9

      924    14653    5               KL$DADR.DEVCTL.T = '0'B ;

  14653  3 002107   000000 471500                    LDP1    0,,PR0
         3 002110   003100 060400                    CSL     bolr='003'O
         3 002111   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 002112   100000 410010                    BDSC    0,,PR1                   by=2,bit=1,n=8

      925    14654    5               KL$DADR.DEVCTL.B = %KLDCB_HASPOC# ;

  14654  3 002113   000000 471500                    LDP1    0,,PR0
         3 002114   003100 060400                    CSL     bolr='003'O
         3 002115   000002 000010 4                  BDSC    2                        by=0,bit=0,n=8
         3 002116   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         3 002117   002414 710000 3                  TRA     END_OPTION

      926    14655
      927    14656    5               SELECT( %PD_HASPLP_VAL ) ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:156  

      928    14657    5               KL$DADR.DEVNUM#  = %KLDN_HASPLP# ;

  14657  3 002120   200014 477500                    LDP7    @DADR$,,AUTO
         3 002121   700000 470500                    LDP0    0,,PR7
         3 002122   003100 060400                    CSL     bolr='003'O
         3 002123   000040 000011 4                  BDSC    32                       by=0,bit=0,n=9
         3 002124   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      929    14658    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP# ;

  14658  3 002125   700000 470500                    LDP0    0,,PR7
         3 002126   003100 060400                    CSL     bolr='003'O
         3 002127   000041 000010 4                  BDSC    33                       by=0,bit=0,n=8
         3 002130   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

      930    14659    5               KL$DADR.DEVCTL.B ='0'B ;

  14659  3 002131   700000 470500                    LDP0    0,,PR7
         3 002132   003100 060400                    CSL     bolr='003'O
         3 002133   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 002134   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         3 002135   002414 710000 3                  TRA     END_OPTION

      931    14660
      932    14661    5               SELECT( %PD_HASPCR_VAL ) ;

      933    14662    5               KL$DADR.DEVNUM# = %KLDN_HASPCR# ;

  14662  3 002136   200014 477500                    LDP7    @DADR$,,AUTO
         3 002137   700000 470500                    LDP0    0,,PR7
         3 002140   003100 060400                    CSL     bolr='003'O
         3 002141   000042 000011 4                  BDSC    34                       by=0,bit=0,n=9
         3 002142   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      934    14663    5               KL$DADR.DEVCTL.T = '0'B ;

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:157  
  14663  3 002143   700000 470500                    LDP0    0,,PR7
         3 002144   003100 060400                    CSL     bolr='003'O
         3 002145   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 002146   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

      935    14664    5               KL$DADR.DEVCTL.B = %KLDCB_HASPCR# ;

  14664  3 002147   700000 470500                    LDP0    0,,PR7
         3 002150   003100 060400                    CSL     bolr='003'O
         3 002151   000043 000010 4                  BDSC    35                       by=0,bit=0,n=8
         3 002152   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         3 002153   002414 710000 3                  TRA     END_OPTION

      936    14665
      937    14666    5               SELECT( %PD_HASPCP_VAL ) ;

      938    14667    5               KL$DADR.DEVNUM# = %KLDN_HASPCP# ;

  14667  3 002154   200014 477500                    LDP7    @DADR$,,AUTO
         3 002155   700000 470500                    LDP0    0,,PR7
         3 002156   003100 060400                    CSL     bolr='003'O
         3 002157   000044 000011 4                  BDSC    36                       by=0,bit=0,n=9
         3 002160   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      939    14668    5               KL$DADR.DEVCTL.T = '0'B ;

  14668  3 002161   700000 470500                    LDP0    0,,PR7
         3 002162   003100 060400                    CSL     bolr='003'O
         3 002163   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 002164   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

      940    14669    5               KL$DADR.DEVCTL.B = %KLDCB_HASPCP# ;

  14669  3 002165   700000 470500                    LDP0    0,,PR7
         3 002166   003100 060400                    CSL     bolr='003'O
         3 002167   000043 000010 4                  BDSC    35                       by=0,bit=0,n=8
         3 002170   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:158  
         3 002171   002414 710000 3                  TRA     END_OPTION

      941    14670
      942    14671    5               SELECT( %PD_HASPLP2_VAL ) ;

      943    14672    5               KL$DADR.DEVNUM#  = %KLDN_HASPLP2# ;

  14672  3 002172   200014 477500                    LDP7    @DADR$,,AUTO
         3 002173   700000 470500                    LDP0    0,,PR7
         3 002174   003100 060400                    CSL     bolr='003'O
         3 002175   000045 000011 4                  BDSC    37                       by=0,bit=0,n=9
         3 002176   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      944    14673    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP2# ;

  14673  3 002177   700000 470500                    LDP0    0,,PR7
         3 002200   003100 060400                    CSL     bolr='003'O
         3 002201   000046 000010 4                  BDSC    38                       by=0,bit=0,n=8
         3 002202   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

      945    14674    5               KL$DADR.DEVCTL.B ='0'B ;

  14674  3 002203   700000 470500                    LDP0    0,,PR7
         3 002204   003100 060400                    CSL     bolr='003'O
         3 002205   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 002206   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         3 002207   002414 710000 3                  TRA     END_OPTION

      946    14675
      947    14676    5               SELECT( %PD_HASPLP3_VAL ) ;

      948    14677    5               KL$DADR.DEVNUM# = %KLDN_HASPLP3# ;

  14677  3 002210   200014 470500                    LDP0    @DADR$,,AUTO
         3 002211   000000 471500                    LDP1    0,,PR0
         3 002212   003100 060400                    CSL     bolr='003'O
         3 002213   000047 000011 4                  BDSC    39                       by=0,bit=0,n=9
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:159  
         3 002214   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9

      949    14678    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP3# ;

  14678  3 002215   000000 471500                    LDP1    0,,PR0
         3 002216   003100 060400                    CSL     bolr='003'O
         3 002217   000034 000010 4                  BDSC    28                       by=0,bit=0,n=8
         3 002220   100000 410010                    BDSC    0,,PR1                   by=2,bit=1,n=8

      950    14679    5               KL$DADR.DEVCTL.B = '0'B ;

  14679  3 002221   000000 471500                    LDP1    0,,PR0
         3 002222   003100 060400                    CSL     bolr='003'O
         3 002223   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 002224   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         3 002225   002414 710000 3                  TRA     END_OPTION

      951    14680
      952    14681    5               SELECT( %PD_IBMCR_VAL ) ;

      953    14682    5               KL$DADR.DEVNUM# = %KLDN_IBMCR# ;

  14682  3 002226   200014 477500                    LDP7    @DADR$,,AUTO
         3 002227   700000 470500                    LDP0    0,,PR7
         3 002230   003100 060400                    CSL     bolr='003'O
         3 002231   000042 000011 4                  BDSC    34                       by=0,bit=0,n=9
         3 002232   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      954    14683    5               KL$DADR.DEVCTL.T = %KLDCT_IBMCR# ;

  14683  3 002233   700000 470500                    LDP0    0,,PR7
         3 002234   003100 060400                    CSL     bolr='003'O
         3 002235   000041 000010 4                  BDSC    33                       by=0,bit=0,n=8
         3 002236   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

      955    14684    5               KL$DADR.DEVCTL.B = '0'B ;

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:160  
  14684  3 002237   700000 470500                    LDP0    0,,PR7
         3 002240   003100 060400                    CSL     bolr='003'O
         3 002241   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 002242   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         3 002243   002414 710000 3                  TRA     END_OPTION

      956    14685
      957    14686    5               SELECT( 22 /* HEX */ ) ;

      958    14687    5               OPTION.COUNT = 7;

  14687  3 002244   007000 236003                    LDQ     3584,DU
         3 002245   200572 552140                    STBQ    OPTION,'40'O,AUTO

      959    14688    5               OPTION.TEXT = 'DEVNUM ';

  14688  3 002246   040100 100400                    MLR     fill='040'O
         3 002247   000116 000007 2                  ADSC9   KL_CREC+78               cn=0,n=7
         3 002250   200572 200037                    ADSC9   OPTION,,AUTO             cn=1,n=31

      960    14689    5               CALL ASB$GET_HEX_VAL( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );

  14689  3 002251   200572 634500                    EPPR4   OPTION,,AUTO
         3 002252   200613 454500                    STP4    L+4,,AUTO
         3 002253   200023 636500                    EPPR6   PTR$,,AUTO
         3 002254   200612 456500                    STP6    L+3,,AUTO
         3 002255   200472 637500                    EPPR7   HEX,,AUTO
         3 002256   200611 457500                    STP7    L+2,,AUTO
         3 002257   000005 236000 4                  LDQ     5
         3 002260   200610 756100                    STQ     L+1,,AUTO
         3 002261   200610 630500                    EPPR0   L+1,,AUTO
         3 002262   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 002263   000000 701000 xent               TSX1    ASB$GET_HEX_VAL
         3 002264   002414 702000 3                  TSX2    END_OPTION

      961    14690    5               KL$DADR.DEVNUM# = BINBIT( HEX(1), 9 );

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:161  
  14690  3 002265   200014 470500                    LDP0    @DADR$,,AUTO
         3 002266   000000 471500                    LDP1    0,,PR0
         3 002267   200472 236100                    LDQ     HEX,,AUTO
         3 002270   000022 772000                    QRL     18
         3 002271   000777 376007                    ANQ     511,DL
         3 002272   000033 736000                    QLS     27
         3 002273   200610 756100                    STQ     L+1,,AUTO
         3 002274   003100 060500                    CSL     bolr='003'O
         3 002275   200610 000044                    BDSC    L+1,,AUTO                by=0,bit=0,n=36
         3 002276   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9

      962    14691
      963    14692    5               END ; /* Do case( CODE2 )*/

  14692  3 002277   002414 710000 3                  TRA     END_OPTION

      964    14693
      965    14694    4            SELECT ( %DEV_SDNUM_VAL ) ;

      966    14695    5            IF NOT SUB THEN DO;

  14695  3 002300   200007 475500                    LDP5    @SUB,,AUTO
         3 002301   500000 234100                    SZN     0,,PR5
         3 002302   002310 604000 3                  TMI     s:14718

      967    14696        /*E*  ERROR:  ASA-E$SDNUMNOTLEGL-0
      968    14697             MESSAGE:  An SDNUM option is not legal here.
      969    14698             MESSAGE1:  An SDNUM is legal only for a subdevice or subconsole.
      970    14699        */
      971    14700                    %SCREAM (ERR#=%E$SDNUMNOTLEGL,LEVEL=ERROR,MID='A');

  14712  3 002303   000050 630400 4                  EPPR0   40
         3 002304   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002305   000000 701000 xent               TSX1    ASH$ERROR
         3 002306   000000 011000                    NOP     0

      972    14715    5               GOTO END_OPTION;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:162  

  14715  3 002307   002414 710000 3                  TRA     END_OPTION

      973    14716    5               END; /*  Not sub  */
      974    14717
      975    14718    4            OPTION.COUNT = 6;

  14718  3 002310   006000 236003                    LDQ     3072,DU
         3 002311   200572 552140                    STBQ    OPTION,'40'O,AUTO

      976    14719    4            OPTION.TEXT = 'SDNUM ';

  14719  3 002312   040100 100400                    MLR     fill='040'O
         3 002313   000121 000006 2                  ADSC9   KL_CREC+81               cn=0,n=6
         3 002314   200572 200037                    ADSC9   OPTION,,AUTO             cn=1,n=31

      977    14720    4            CALL ASB$GET_HEX_VAL( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );

  14720  3 002315   200572 634500                    EPPR4   OPTION,,AUTO
         3 002316   200613 454500                    STP4    L+4,,AUTO
         3 002317   200023 636500                    EPPR6   PTR$,,AUTO
         3 002320   200612 456500                    STP6    L+3,,AUTO
         3 002321   200472 637500                    EPPR7   HEX,,AUTO
         3 002322   200611 457500                    STP7    L+2,,AUTO
         3 002323   000005 236000 4                  LDQ     5
         3 002324   200610 756100                    STQ     L+1,,AUTO
         3 002325   200610 630500                    EPPR0   L+1,,AUTO
         3 002326   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 002327   000000 701000 xent               TSX1    ASB$GET_HEX_VAL
         3 002330   002414 702000 3                  TSX2    END_OPTION

      978    14721    4            KL$DADR.SDNUM# = BINBIT( HEX(1), 9 );

  14721  3 002331   200014 470500                    LDP0    @DADR$,,AUTO
         3 002332   000000 471500                    LDP1    0,,PR0
         3 002333   200472 236100                    LDQ     HEX,,AUTO
         3 002334   000022 772000                    QRL     18
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:163  
         3 002335   000777 376007                    ANQ     511,DL
         3 002336   000033 736000                    QLS     27
         3 002337   200610 756100                    STQ     L+1,,AUTO
         3 002340   003100 060500                    CSL     bolr='003'O
         3 002341   200610 000044                    BDSC    L+1,,AUTO                by=0,bit=0,n=36
         3 002342   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9
         3 002343   002414 710000 3                  TRA     END_OPTION

      979    14722
      980    14723    4            SELECT ( %DEV_DEVCTL_VAL ) ;

      981    14724    5            IF NOT SUB THEN DO;

  14724  3 002344   200007 475500                    LDP5    @SUB,,AUTO
         3 002345   500000 234100                    SZN     0,,PR5
         3 002346   002354 604000 3                  TMI     s:14747

      982    14725        /*E*  ERROR:  ASA-E$DEVCTLNOTLEGL-0
      983    14726             MESSAGE:  A DEVCTL option is not legal here.
      984    14727             MESSAGE1:  A susbit value is legal only for a subdevice or subconsole.
      985    14728        */
      986    14729                    %SCREAM (ERR#=%E$SDNUMNOTLEGL,LEVEL=ERROR,MID='A');

  14741  3 002347   000050 630400 4                  EPPR0   40
         3 002350   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002351   000000 701000 xent               TSX1    ASH$ERROR
         3 002352   000000 011000                    NOP     0

      987    14744    5               GOTO END_OPTION;

  14744  3 002353   002414 710000 3                  TRA     END_OPTION

      988    14745    5               END; /*  Not sub  */
      989    14746
      990    14747    4            OPTION.COUNT = 7;

  14747  3 002354   007000 236003                    LDQ     3584,DU
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:164  
         3 002355   200572 552140                    STBQ    OPTION,'40'O,AUTO

      991    14748    4            OPTION.TEXT = 'DEVCTL ';

  14748  3 002356   040100 100400                    MLR     fill='040'O
         3 002357   000123 000007 2                  ADSC9   KL_CREC+83               cn=0,n=7
         3 002360   200572 200037                    ADSC9   OPTION,,AUTO             cn=1,n=31

      992    14749    4            CALL ASB$GET_HEX_VAL ( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );

  14749  3 002361   200572 634500                    EPPR4   OPTION,,AUTO
         3 002362   200613 454500                    STP4    L+4,,AUTO
         3 002363   200023 636500                    EPPR6   PTR$,,AUTO
         3 002364   200612 456500                    STP6    L+3,,AUTO
         3 002365   200472 637500                    EPPR7   HEX,,AUTO
         3 002366   200611 457500                    STP7    L+2,,AUTO
         3 002367   000005 236000 4                  LDQ     5
         3 002370   200610 756100                    STQ     L+1,,AUTO
         3 002371   200610 630500                    EPPR0   L+1,,AUTO
         3 002372   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 002373   000000 701000 xent               TSX1    ASB$GET_HEX_VAL
         3 002374   002414 702000 3                  TSX2    END_OPTION

      993    14750    4            SPLIT.T = HEX(1);

  14750  3 002375   200472 236100                    LDQ     HEX,,AUTO
         3 002376   000011 736000                    QLS     9
         3 002377   200471 676100                    ERQ     SPLIT,,AUTO
         3 002400   377000 376003                    ANQ     130560,DU
         3 002401   200471 656100                    ERSQ    SPLIT,,AUTO

      994    14751    4            SPLIT.B = HEX(2);

  14751  3 002402   200472 236100                    LDQ     HEX,,AUTO
         3 002403   000011 736000                    QLS     9
         3 002404   200471 676100                    ERQ     SPLIT,,AUTO
         3 002405   000377 376003                    ANQ     255,DU
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:165  
         3 002406   200471 656100                    ERSQ    SPLIT,,AUTO

      995    14752    4            KL$DADR.DEVCTL = SPLIT;

  14752  3 002407   200014 470500                    LDP0    @DADR$,,AUTO
         3 002410   000000 471500                    LDP1    0,,PR0
         3 002411   003100 060500                    CSL     bolr='003'O
         3 002412   200471 000022                    BDSC    SPLIT,,AUTO              by=0,bit=0,n=18
         3 002413   100000 400022                    BDSC    0,,PR1                   by=2,bit=0,n=18

      996    14753
      997    14754    4            END ;                    /* Do case( code )                    */

  14749  3 002414                       END_OPTION   null
      998    14755    3   END_OPTION: ;
      999    14756    3         END;                      /* Do i                               */

  14756  3 002414   200020 235100                    LDA     I,,AUTO
         3 002415   000001 035007                    ADLA    1,DL
         3 002416   200020 755100                    STA     I,,AUTO
         3 002417   000000 470400 xsym               LDP0    NODE$
         3 002420   000001 236100                    LDQ     1,,PR0
         3 002421   000022 772000                    QRL     18
         3 002422   200020 116100                    CMPQ    I,,AUTO
         3 002423   002425 600000 3                  TZE     s:14757
         3 002424   000373 603000 3                  TRC     s:14121

     1000    14757    2      END ;                        /* Do while                           */

  14757  3 002425   200024 234100                    SZN     MORE,,AUTO
         3 002426   000343 604000 3                  TMI     s:14111

     1001    14758    2   IF SUB AND KL$TREC.PNAME.TXT ~= ' ' THEN DO;

  14758  3 002427   200007 470500                    LDP0    @SUB,,AUTO
         3 002430   000000 234100                    SZN     0,,PR0
         3 002431   002525 605000 3                  TPL     s:14811
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:166  
         3 002432   200003 471500                    LDP1    @TREC$,,AUTO
         3 002433   100000 473500                    LDP3    0,,PR1
         3 002434   040000 106500                    CMPC    fill='040'O
         3 002435   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11
         3 002436   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 002437   002525 600000 3                  TZE     s:14811

     1002    14759    2      PRO$ = ADDR(PRO_BUF);

  14759  3 002440   200036 634500                    EPPR4   PRO_BUF,,AUTO
         3 002441   200035 454500                    STP4    PRO$,,AUTO

     1003    14760    2      ARS=LENGTHC(PRO_BUF);

  14760  3 002442   002000 235007                    LDA     1024,DL
         3 002443   200017 755100                    STA     ARS,,AUTO

     1004    14761    2      USERS_KEY.COUNT=KL$TREC.PNAME.CNT;

  14761  3 002444   100000 473500                    LDP3    0,,PR1
         3 002445   300004 236100                    LDQ     4,,PR3
         3 002446   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1005    14762    2      USERS_KEY.TXTC=KL$TREC.PNAME.TXT;

  14762  3 002447   100000 473500                    LDP3    0,,PR1
         3 002450   040000 100500                    MLR     fill='040'O
         3 002451   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11
         3 002452   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

     1006    14763    2      CALL ASD$READ_PRO (USERS_KEY,KL$PHDR,ARS)

  14763  3 002453   200017 633500                    EPPR3   ARS,,AUTO
         3 002454   200612 453500                    STP3    L+3,,AUTO
         3 002455   200035 236100                    LDQ     PRO$,,AUTO
         3 002456   000013 235000 4                  LDA     11
         3 002457   200610 757100                    STAQ    L+1,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:167  
         3 002460   200610 630500                    EPPR0   L+1,,AUTO
         3 002461   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 002462   000000 701000 xent               TSX1    ASD$READ_PRO
         3 002463   002465 702000 3                  TSX2    s:14780
         3 002464   002475 710000 3                  TRA     s:14787

     1007    14764    3      WHENALTRETURN DO ;

     1008    14765        /*   ERROR:  ASA-E$MUSTPRO-C
     1009    14766             MESSAGE: You must specify a profile name for this device
     1010    14767        */
     1011    14768              %SCREAM( ERR#=E$MUSTPRO, LEVEL=ERROR, MID='A' ) ;

  14780  3 002465   000051 630400 4                  EPPR0   41
         3 002466   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002467   000000 701000 xent               TSX1    ASH$ERROR
         3 002470   000000 011000                    NOP     0

     1012    14783    3         MORE=AS_TRUE;

  14783  3 002471   000000 236000 xsym               LDQ     AS_TRUE
         3 002472   400000 376003                    ANQ     -131072,DU
         3 002473   200024 756100                    STQ     MORE,,AUTO

     1013    14784    3         GOTO CON_LOOP;

  14784  3 002474   000341 710000 3                  TRA     CON_LOOP

     1014    14785    3         END; /*  Whenaltreturn  */
     1015    14786                                                                                    /**/
     1016    14787    3      IF KL$PHDR.TTYP ~= %KLTY_SDEV# THEN DO;

  14787  3 002475   200035 470500                    LDP0    PRO$,,AUTO
         3 002476   000100 101500                    MRL     fill='000'O
         3 002477   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         3 002500   200610 000004                    ADSC9   L+1,,AUTO                cn=0,n=4
         3 002501   200610 236100                    LDQ     L+1,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:168  
         3 002502   000001 116007                    CMPQ    1,DL
         3 002503   002514 600000 3                  TZE     s:14806

     1017    14788              %SCREAM( ERR#=E$CONPROTYPE, LEVEL=ERROR, MID='A' ) ;

  14800  3 002504   000015 630400 4                  EPPR0   13
         3 002505   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002506   000000 701000 xent               TSX1    ASH$ERROR
         3 002507   000000 011000                    NOP     0

     1018    14803    3         MORE=AS_TRUE;

  14803  3 002510   000000 236000 xsym               LDQ     AS_TRUE
         3 002511   400000 376003                    ANQ     -131072,DU
         3 002512   200024 756100                    STQ     MORE,,AUTO

     1019    14804    3         GOTO CON_LOOP;

  14804  3 002513   000341 710000 3                  TRA     CON_LOOP

     1020    14805    3         END;
     1021    14806    2      PATTR=KL$PHDR.ATTR;

  14806  3 002514   000100 100500                    MLR     fill='000'O
         3 002515   000001 000002                    ADSC9   1,,PR0                   cn=0,n=2
         3 002516   200027 000002                    ADSC9   PATTR,,AUTO              cn=0,n=2

     1022    14807    2      IO=KL$PHDR.IO;

  14807  3 002517   003100 060500                    CSL     bolr='003'O
         3 002520   000001 400002                    BDSC    1,,PR0                   by=2,bit=0,n=2
         3 002521   200030 000002                    BDSC    IO,,AUTO                 by=0,bit=0,n=2

     1023    14808    2      DDEV=KL$PHDR.DDEV;

  14808  3 002522   000100 100500                    MLR     fill='000'O
         3 002523   000001 600001                    ADSC9   1,,PR0                   cn=3,n=1
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:169  
         3 002524   200031 000001                    ADSC9   DDEV,,AUTO               cn=0,n=1

     1024    14809    2      END;

     1025    14810                                                /* Restore P_PCB                      */
     1026    14811    1   P_PCB.WORK$ = WORK$ ;

  14811  3 002525   200436 236100                    LDQ     WORK$,,AUTO
         3 002526   000002 756000 xsym               STQ     P_PCB+2

     1027    14812    1   P_PCB.WKSZ = WKSZ ;

  14812  3 002527   200437 720100                    LXL0    WKSZ,,AUTO
         3 002530   000005 740000 xsym               STX0    P_PCB+5

     1028    14813    1   P_PCB.WK_USED = WK_USED ;

  14813  3 002531   200440 721100                    LXL1    WK_USED,,AUTO
         3 002532   000010 741000 xsym               STX1    P_PCB+8

     1029    14814    1   P_PCB.ROOT$ = ROOT$ ;

  14814  3 002533   200441 236100                    LDQ     ROOT$,,AUTO
         3 002534   000001 756000 xsym               STQ     P_PCB+1

     1030    14815                                                /* Restore NODE$                      */
     1031    14816    1   NODE$ = T_NODE$ ;

  14816  3 002535   200442 236100                    LDQ     T_NODE$,,AUTO
         3 002536   000000 756000 xsym               STQ     NODE$

     1032    14817                                                          /* Set up twsn record */
     1033    14818    1   KL$TWSNREC.DEVS.TYP(TWSN_INDEX)  = SUBSTR(KL$TREC.RENAME,0,2);

  14818  3 002537   200004 470500                    LDP0    @TWSNR$,,AUTO
         3 002540   000000 471500                    LDP1    0,,PR0
         3 002541   200012 473500                    LDP3    @TWSN_INDEX,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:170  
         3 002542   300000 236100                    LDQ     0,,PR3
         3 002543   000013 402007                    MPY     11,DL
         3 002544   200003 474500                    LDP4    @TREC$,,AUTO
         3 002545   400000 475500                    LDP5    0,,PR4
         3 002546   500011 222100                    LDX2    9,,PR5
         3 002547   100005 742106                    STX2    5,QL,PR1

     1034    14819    1   KL$TWSNREC.DEVS.NUM(TWSN_INDEX)  = SUBSTR(KL$TREC.RENAME,2,2);

  14819  3 002550   000000 471500                    LDP1    0,,PR0
         3 002551   300000 236100                    LDQ     0,,PR3
         3 002552   000013 402007                    MPY     11,DL
         3 002553   400000 475500                    LDP5    0,,PR4
         3 002554   500011 722100                    LXL2    9,,PR5
         3 002555   100005 442106                    SXL2    5,QL,PR1

     1035    14820    1   KL$TWSNREC.DEVS.ATTR(TWSN_INDEX) = PATTR ;

  14820  3 002556   000000 471500                    LDP1    0,,PR0
         3 002557   300000 236100                    LDQ     0,,PR3
         3 002560   000013 402007                    MPY     11,DL
         3 002561   200027 222100                    LDX2    PATTR,,AUTO
         3 002562   100006 742106                    STX2    6,QL,PR1

     1036    14821    1   KL$TWSNREC.DEVS.IO(TWSN_INDEX)   = IO;

  14821  3 002563   000000 471500                    LDP1    0,,PR0
         3 002564   300000 236100                    LDQ     0,,PR3
         3 002565   000013 402007                    MPY     11,DL
         3 002566   000000 623006                    EAX3    0,QL
         3 002567   200030 236100                    LDQ     IO,,AUTO
         3 002570   000033 772000                    QRL     27
         3 002571   100006 676113                    ERQ     6,X3,PR1
         3 002572   000600 376007                    ANQ     384,DL
         3 002573   100006 656113                    ERSQ    6,X3,PR1

     1037    14822    1   KL$TWSNREC.DEVS.DDEV(TWSN_INDEX) = DDEV;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:171  

  14822  3 002574   000000 471500                    LDP1    0,,PR0
         3 002575   300000 236100                    LDQ     0,,PR3
         3 002576   000013 402007                    MPY     11,DL
         3 002577   000000 623006                    EAX3    0,QL
         3 002600   200031 236100                    LDQ     DDEV,,AUTO
         3 002601   000022 772000                    QRL     18
         3 002602   100006 676113                    ERQ     6,X3,PR1
         3 002603   777000 376007                    ANQ     -512,DL
         3 002604   100006 656113                    ERSQ    6,X3,PR1

     1038    14823    1   KL$TWSNREC.DEVS.ACCT(TWSN_INDEX) = KL$TREC.RENAME;

  14823  3 002605   000000 471500                    LDP1    0,,PR0
         3 002606   300000 236100                    LDQ     0,,PR3
         3 002607   000013 402007                    MPY     11,DL
         3 002610   400000 475500                    LDP5    0,,PR4
         3 002611   000002 736000                    QLS     2
         3 002612   040106 100500                    MLR     fill='040'O
         3 002613   500011 000010                    ADSC9   9,,PR5                   cn=0,n=8
         3 002614   100011 000010                    ADSC9   9,Q,PR1                  cn=0,n=8

     1039    14824    1   KL$TWSNREC.DEVS.TDEV(TWSN_INDEX) = '0'B;

  14824  3 002615   000000 471500                    LDP1    0,,PR0
         3 002616   300000 236100                    LDQ     0,,PR3
         3 002617   000013 402007                    MPY     11,DL
         3 002620   000000 623006                    EAX3    0,QL
         3 002621   000052 236000 4                  LDQ     42
         3 002622   100006 356113                    ANSQ    6,X3,PR1

     1040    14825    1   KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = ' ';

  14825  3 002623   000000 471500                    LDP1    0,,PR0
         3 002624   300000 236100                    LDQ     0,,PR3
         3 002625   000013 402007                    MPY     11,DL
         3 002626   000000 623006                    EAX3    0,QL
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:172  
         3 002627   000000 624006                    EAX4    0,QL
         3 002630   000035 235000 xsym               LDA     B_VECTNIL+29
         3 002631   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 002632   100013 755113                    STA     11,X3,PR1
         3 002633   100014 756114                    STQ     12,X4,PR1

     1041    14826    1   IF SUB THEN

  14826  3 002634   200007 471500                    LDP1    @SUB,,AUTO
         3 002635   100000 234100                    SZN     0,,PR1
         3 002636   002645 605000 3                  TPL     s:14828

     1042    14827    1      KL$TWSNREC.DEVS.TDEV(TWSN_INDEX) = '1'B;

  14827  3 002637   000000 475500                    LDP5    0,,PR0
         3 002640   300000 236100                    LDQ     0,,PR3
         3 002641   000013 402007                    MPY     11,DL
         3 002642   000000 623006                    EAX3    0,QL
         3 002643   000100 236007                    LDQ     64,DL
         3 002644   500006 256113                    ORSQ    6,X3,PR5

     1043    14828    1   IF CREATE  AND  NOT KL$TREC.OCINFO.CADDR  AND  NOT KL$TREC.OCINFO.KCADDR

  14828  3 002645   200006 475500                    LDP5    @CREATE,,AUTO
         3 002646   500000 234100                    SZN     0,,PR5
         3 002647   002662 605000 3                  TPL     s:14834
         3 002650   400000 476500                    LDP6    0,,PR4
         3 002651   600034 223100                    LDX3    28,,PR6
         3 002652   002662 601000 3                  TNZ     s:14834
         3 002653   600035 224100                    LDX4    29,,PR6
         3 002654   002662 601000 3                  TNZ     s:14834

     1044    14829    2   THEN DO;            /* Set the defualt attributes */

     1045    14830    2      KL$TREC.OCINFO.CADDR = CADDR;

  14830  3 002655   200026 225100                    LDX5    CADDR,,AUTO
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:173  
         3 002656   600034 745100                    STX5    28,,PR6

     1046    14831    2      KL$TREC.OCINFO.KCADDR = KCADDR;

  14831  3 002657   400000 476500                    LDP6    0,,PR4
         3 002660   200025 223100                    LDX3    KCADDR,,AUTO
         3 002661   600035 743100                    STX3    29,,PR6

     1047    14832    2      END;

     1048    14833                                    /* If sys=yes or tp console then wsn=? by default */
     1049    14834    1   IF CREATE AND NOT C_WSN_FLG THEN

  14834  3 002662   500000 234100                    SZN     0,,PR5
         3 002663   002702 605000 3                  TPL     s:14840
         3 002664   200443 234100                    SZN     C_WSN_FLG,,AUTO
         3 002665   002702 604000 3                  TMI     s:14840

     1050    14835    1      IF C_SYS_FLG

  14835  3 002666   200444 234100                    SZN     C_SYS_FLG,,AUTO
         3 002667   002675 604000 3                  TMI     s:14838
         3 002670   400000 476500                    LDP6    0,,PR4
         3 002671   600034 223100                    LDX3    28,,PR6
         3 002672   600035 263100                    ORX3    29,,PR6
         3 002673   001000 103003                    CMPX3   512,DU
         3 002674   002702 601000 3                  TNZ     s:14840

     1051    14836    1           OR (KL$TREC.OCINFO.CADDR | KL$TREC.OCINFO.KCADDR) = '001000'O /* K_TP */
     1052    14837    1      THEN
     1053    14838    1         KL$TREC.OCINFO.WSN = '?';

  14838  3 002675   400000 476500                    LDP6    0,,PR4
         3 002676   000053 235000 4                  LDA     43
         3 002677   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 002700   600036 755100                    STA     30,,PR6
         3 002701   600037 756100                    STQ     31,,PR6
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:174  

     1054    14839                                                  /* Build KL_TSS for terminal device */
     1055    14840    2   IF SUB THEN DO;

  14840  3 002702   100000 234100                    SZN     0,,PR1
         3 002703   002723 605000 3                  TPL     s:14846

     1056    14841    2      SS.SGN.TYPE = TYPE;

  14841  3 002704   200013 476500                    LDP6    @SS,,AUTO
         3 002705   040100 100500                    MLR     fill='040'O
         3 002706   200015 000002                    ADSC9   TYPE,,AUTO               cn=0,n=2
         3 002707   600000 200002                    ADSC9   0,,PR6                   cn=1,n=2

     1057    14842    2      SS.SGN.PNAME = KL$TREC.PNAME.TXT;

  14842  3 002710   400000 477500                    LDP7    0,,PR4
         3 002711   040100 100500                    MLR     fill='040'O
         3 002712   700004 200013                    ADSC9   4,,PR7                   cn=1,n=11
         3 002713   600004 000013                    ADSC9   4,,PR6                   cn=0,n=11

     1058    14843    2      SS.SGN.NUM = NUM;

  14843  3 002714   040100 100500                    MLR     fill='040'O
         3 002715   200016 000002                    ADSC9   NUM,,AUTO                cn=0,n=2
         3 002716   600000 600002                    ADSC9   0,,PR6                   cn=3,n=2

     1059    14844    2      SS.SGN.TWSN = TWSNC;

  14844  3 002717   200005 477500                    LDP7    @TWSNC,,AUTO
         3 002720   040100 100500                    MLR     fill='040'O
         3 002721   700000 000004                    ADSC9   0,,PR7                   cn=0,n=4
         3 002722   600001 200004                    ADSC9   1,,PR6                   cn=1,n=4

     1060    14845    2      END;

     1061    14846    1   KL$TREC.NWINFO = LENGTHW(KL$TREC.KC$CGID) + LENGTHW(KL$TREC.OCINFO) ;
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:175  

  14846  3 002723   400000 476500                    LDP6    0,,PR4
         3 002724   000050 235007                    LDA     40,DL
         3 002725   600017 755100                    STA     15,,PR6

     1062    14847    1   IF CREATE THEN

  14847  3 002726   500000 234100                    SZN     0,,PR5
         3 002727   002741 605000 3                  TPL     s:14849

     1063    14848    1      CALL CONCAT( AS_CREATED_TEXT,'  ',SUBSTR(KL$TREC.RENAME,0,4),' created.');

  14848  3 002730   400000 476500                    LDP6    0,,PR4
         3 002731   000126 223000 2                  LDX3    KL_CREC+86
         3 002732   000000 743000 xsym               STX3    AS_CREATED_TEXT
         3 002733   040000 100500                    MLR     fill='040'O
         3 002734   600011 000004                    ADSC9   9,,PR6                   cn=0,n=4
         3 002735   000000 400004 xsym               ADSC9   AS_CREATED_TEXT          cn=2,n=4
         3 002736   040000 100400                    MLR     fill='040'O
         3 002737   000127 000011 2                  ADSC9   KL_CREC+87               cn=0,n=9
         3 002740   000001 400016 xsym               ADSC9   AS_CREATED_TEXT+1        cn=2,n=14

     1064    14849    1   RETURN;

  14849  3 002741   000000 702200 xent               TSX2  ! X66_ARET
     1065    14850
     1066    14851    1   END ASA$CON_OPTS;

PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:176  
--  Include file information  --

   OCI_SUBS_C.:E05TOU  is referenced.
   OC$INFO.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$CON_OPTS.
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:177  

 **** Variables and constants ****

  ****  Section 002 RoData ASA$CON_OPTS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2016)  r     1 KL_CREC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @CREATE                   14-0-0/w PTR         r     1 @DADR$
    11-0-0/w PTR         r     1 @LOCAL                    13-0-0/w PTR         r     1 @SS
     7-0-0/w PTR         r     1 @SUB                      10-0-0/w PTR         r     1 @TERM_T
     3-0-0/w PTR         r     1 @TREC$                     5-0-0/w PTR         r     1 @TWSNC
     4-0-0/w PTR         r     1 @TWSNR$                   12-0-0/w PTR         r     1 @TWSN_INDEX
    17-0-0/w UBIN        r     1 ARS                       33-0-0/w PTR         r     1 BLK$
    26-0-0/b BIT (18)    r     1 CADDR                     22-0-0/w UBIN        r     1 CNT
    21-0-0/w UBIN        r     1 CODE2                    445-0-0/c CHAR(80)    r     1 COMMAND
    *0-0-0/w BIT         r     1 CREATE                   444-0-0/b BIT         r     1 C_SYS_FLG
   443-0-0/b BIT         r     1 C_WSN_FLG                 *0-0-0/w PTR         r     1 DADR$
    31-0-0/b BIT (9)     r     1 DDEV                     472-0-0/b UBIN(9)     r     1 HEX(0:255)
    20-0-0/w UBIN        r     1 I                         30-0-0/b STRC(2)     r     1 IO
   605-0-0/w UBIN        r     1 J                        606-0-0/w UBIN        r     1 K
    25-0-0/b BIT (18)    r     1 KCADDR                   607-0-0/w UBIN        r     1 L
    *0-0-0/w BIT         r     1 LOCAL                     32-0-0/b BIT         r     1 MASK
    24-0-0/b BIT         r     1 MORE                      16-0-0/c CHAR(2)     r     1 NUM
   572-0-0/c STRC(288)   r     1 OPTION                   602-0-0/w PTR         r     1 P$
    27-0-0/b BIT (18)    r     1 PATTR                     35-0-0/w PTR         r     1 PRO$
    36-0-0/c CHAR(1024)  r     1 PRO_BUF                   23-0-0/w PTR         r     1 PTR$
   441-0-0/w PTR         r     1 ROOT$                    471-0-0/b STRC(18)    r     1 SPLIT
    *0-0-0/c STRC(243)   r     1 SS                        *0-0-0/w BIT         r     1 SUB
   603-0-0/w UBIN        r     1 TEMP                     604-0-0/w PTR         r     1 TEMP$
    *0-0-0/c CHAR(7)     r     1 TERM_T                    *0-0-0/w PTR         r     1 TREC$
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:178  
    *0-0-0/c CHAR(4)     r     1 TWSNC                     *0-0-0/w PTR         r     1 TWSNR$
    *0-0-0/w SBIN        r     1 TWSN_INDEX                15-0-0/c CHAR(2)     r     1 TYPE
   442-0-0/w PTR         r     1 T_NODE$                  437-0-0/w UBIN        r     1 WKSZ
   440-0-0/w UBIN        r     1 WK_USED                  436-0-0/w PTR         r     1 WORK$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/c CHAR(20)    r     1 AS_CREATED_TEXT
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w UBIN        r     1 CODE
     0-0-0/w UBIN        r     1 CONSOLE_OPTS_LIST          0-0-0/c STRC(189)   r     1 FROM_KEY
     0-0-0/c CHAR(255)   r     1 IN_BUF                     0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/d REMB        r     1 REMEM_VAR
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 ACHAR                      0-0-0/b STRC        r     1 KL$DADR
     0-0-0/c STRC(720)   r     1 KL$PHDR                    0-0-0/w STRC(2016)  r     1 KL$TREC
     0-0-0/w STRC(576)   r     1 KL$TWSNREC                 0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE


   Procedure ASA$CON_OPTS requires 1506 words for executable code.
   Procedure ASA$CON_OPTS requires 396 words of local(AUTO) storage.

    No errors detected in file ASA$CONSOLE.:E05TSI    .
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:179  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:180  
          MINI XREF LISTING

ACHAR
     13385**DCL     14361>>CALLBLT 14363>>CALLBLT 14365>>CALLBLT 14368<<ASSIGN
ARS
     13347**DCL     14111<>CALL    14112>>ASSIGN  14187<<ASSIGN  14190<>CALL    14760<<ASSIGN  14763<>CALL
ASA_BRKS_LOC
     10044**DCL     10044--REDEF
ASB$FIND_NUM
     13595**DCL-ENT 14051--CALL
ASB$GET_HEX_VAL
     13598**DCL-ENT 14689--CALL    14720--CALL    14749--CALL
ASB$READ_SI
     13601**DCL-ENT 14111--CALL
ASB$SET_PROMPT
     13604**DCL-ENT 14101--CALL    14104--CALL
ASD$READ_PRO
     13607**DCL-ENT 14190--CALL    14763--CALL
ASH$DQUEST
     13622**DCL-ENT 14267--CALL
ASH$ERROR
     13610**DCL-ENT 14065--CALL    14115--CALL    14149--CALL    14180--CALL    14205--CALL    14230--CALL
     14248--CALL    14294--CALL    14324--CALL    14352--CALL    14396--CALL    14425--CALL    14463--CALL
     14515--CALL    14589--CALL    14624--CALL    14712--CALL    14741--CALL    14780--CALL    14800--CALL
ASH$HELP
     13616**DCL-ENT 14261--CALL
ASH$QUEST
     13619**DCL-ENT 14264--CALL
ASZ$SCRAMBLE
     13625**DCL-ENT 14046--CALL    14304--CALL    14330--CALL
AS_BLANK
      9904**DCL     14097>>ASSIGN  14303>>ASSIGN  14439>>ASSIGN
AS_CREATED_TEXT
      9918**DCL     14848<<CALLBLT
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:181  
AS_DEFAULT.BANNER_PERM
     10737**DCL     10738--REDEF
AS_DEFAULT.BUDGET.MACCT
     10642**DCL     10646--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10655**DCL     10658--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10638**DCL     10640--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10633**DCL     10635--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10753**DCL     10754--REDEF   10755--REDEF
AS_DEFAULT_DREC.PASSWORD
     12007**DCL     12011--REDEF
AS_DEFAULT_DREC.RENAME
     12030**DCL     12031--REDEF
AS_DFLT.BANNER_PERM
     10559**DCL     10560--REDEF
AS_DFLT.BUDGET.MACCT
     10464**DCL     10468--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10477**DCL     10480--REDEF
AS_DFLT.BUDGET.PACCUM
     10460**DCL     10462--REDEF
AS_DFLT.BUDGET.PMAXC
     10455**DCL     10457--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10575**DCL     10576--REDEF   10577--REDEF
AS_FALSE
      9904**DCL     14036>>ASSIGN  14037>>ASSIGN  14272>>ASSIGN
AS_FE_MODE
      9910**DCL      9911--REDEF
AS_FIELD1
     10040**DCL     14192<<ASSIGN
AS_MODE
      9907**DCL      9909--REDEF
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:182  
AS_MOD_USER.ACCESS
     12772**DCL     12773--REDEF
AS_MOD_USER.BANNER
     12759**DCL     12760--REDEF
AS_MOD_USER.BANNER_PERM
     12761**DCL     12762--REDEF
AS_MOD_USER.BILL
     12767**DCL     12768--REDEF
AS_MOD_USER.CPROC
     12763**DCL     12764--REDEF
AS_MOD_USER.FEBILL
     12843**DCL     12844--REDEF
AS_MOD_USER.FECXTMEM
     12860**DCL     12861--REDEF
AS_MOD_USER.FEMINTS
     12845**DCL     12846--REDEF
AS_MOD_USER.FEMMEM
     12856**DCL     12857--REDEF
AS_MOD_USER.FEMTIME
     12854**DCL     12855--REDEF
AS_MOD_USER.FEPPRIV
     12851**DCL     12853--REDEF
AS_MOD_USER.FEPRIV
     12848**DCL     12850--REDEF
AS_MOD_USER.FORCE_BIT
     12757**DCL     12758--REDEF
AS_MOD_USER.KEY
     12839**DCL     12841--REDEF
AS_MOD_USER.LASTCPROC
     12765**DCL     12766--REDEF
AS_MOD_USER.LIMITS.DO_
     12813**DCL     12814--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12829**DCL     12830--REDEF
AS_MOD_USER.LIMITS.LO
     12809**DCL     12810--REDEF
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:183  
AS_MOD_USER.LIMITS.MEM
     12805**DCL     12806--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12833**DCL     12834--REDEF
AS_MOD_USER.LIMITS.PDIS
     12821**DCL     12822--REDEF
AS_MOD_USER.LIMITS.PO
     12817**DCL     12818--REDEF
AS_MOD_USER.LIMITS.TDIS
     12825**DCL     12826--REDEF
AS_MOD_USER.LIMITS.TIME
     12801**DCL     12802--REDEF
AS_MOD_USER.MAXENQ
     12782**DCL     12783--REDEF
AS_MOD_USER.PERM_BIT
     12755**DCL     12756--REDEF
AS_MOD_USER.PPRIV
     12777**DCL     12779--REDEF
AS_MOD_USER.PRIOB
     12784**DCL     12785--REDEF
AS_MOD_USER.PRIV
     12774**DCL     12776--REDEF
AS_MOD_USER.QUAN
     12780**DCL     12781--REDEF
AS_MOD_USER.SETUP
     12753**DCL     12754--REDEF
AS_PROJECT.BANNER_PERM
     11093**DCL     11094--REDEF
AS_PROJECT.BUDGET.MACCT
     10998**DCL     11002--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11011**DCL     11014--REDEF
AS_PROJECT.BUDGET.PACCUM
     10994**DCL     10996--REDEF
AS_PROJECT.BUDGET.PMAXC
     10989**DCL     10991--REDEF
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:184  
AS_PROJECT.SETUP_CHRA.TXT
     11109**DCL     11110--REDEF   11111--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11271**DCL     11272--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11176**DCL     11180--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11189**DCL     11192--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11172**DCL     11174--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11167**DCL     11169--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11287**DCL     11288--REDEF   11289--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12493**DCL     12497--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12516**DCL     12517--REDEF
AS_PROJECT_DREC.PASSWORD
     12331**DCL     12335--REDEF
AS_PROJECT_DREC.RENAME
     12354**DCL     12355--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10915**DCL     10916--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10820**DCL     10824--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10833**DCL     10836--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10816**DCL     10818--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10811**DCL     10813--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10931**DCL     10932--REDEF   10933--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12169**DCL     12173--REDEF
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:185  
AS_PROJ_ADMIN_DREC.RENAME
     12192**DCL     12193--REDEF
AS_TRUE
      9904**DCL     14034>>ASSIGN  14431>>ASSIGN  14783>>ASSIGN  14803>>ASSIGN
AS_USERS.BANNER_PERM
     10381**DCL     10382--REDEF
AS_USERS.BUDGET.MACCT
     10286**DCL     10290--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10299**DCL     10302--REDEF
AS_USERS.BUDGET.PACCUM
     10282**DCL     10284--REDEF
AS_USERS.BUDGET.PMAXC
     10277**DCL     10279--REDEF
AS_USERS.SETUP_CHRA.TXT
     10397**DCL     10398--REDEF   10399--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11449**DCL     11450--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11354**DCL     11358--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11367**DCL     11370--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11350**DCL     11352--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11345**DCL     11347--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11465**DCL     11466--REDEF   11467--REDEF
BLK$
     13361**DCL     13686--IMP-PTR 14163<<ASSIGN  14164>>ASSIGN  14188>>ASSIGN  14189>>ASSIGN  14189>>ASSIGN
     14307<<ASSIGN  14308>>ASSIGN  14329>>ASSIGN  14329>>ASSIGN  14333<<ASSIGN  14334>>ASSIGN  14357>>ASSIGN
     14375<<ASSIGN  14376>>CALLBLT 14376>>CALLBLT 14403<<ASSIGN  14406<<ASSIGN  14407>>IF      14430>>ASSIGN
     14430>>ASSIGN  14435<<ASSIGN  14436>>IF      14442>>ASSIGN  14443>>ASSIGN  14443>>ASSIGN  14471<<ASSIGN
     14472>>ASSIGN  14474>>ASSIGN  14474>>ASSIGN
CADDR
     13354**DCL     14072<<ASSIGN  14535<<ASSIGN  14535>>ASSIGN  14565<<ASSIGN  14565>>ASSIGN  14573<<ASSIGN
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:186  
     14573>>ASSIGN  14830>>ASSIGN
CNT
     13350**DCL     14164<<ASSIGN  14165>>IF      14308<<ASSIGN  14309>>IF      14334<<ASSIGN  14335>>IF
     14376<<CALLBLT 14377>>IF      14401>>ASSIGN  14438<<ASSIGN  14442<<ASSIGN  14445>>IF      14468>>ASSIGN
     14472<<ASSIGN  14473>>IF      14494<<ASSIGN  14496<<ASSIGN  14501>>IF      14501>>IF      14520>>ASSIGN
     14529>>IF      14539>>IF      14557>>DOSELCT 14576>>IF      14594>>IF
CODE
     10037**DCL     14122<<ASSIGN  14126>>DOSELCT 14154>>DOSELCT 14497>>ASSIGN
CODE2
     13349**DCL     14299<<ASSIGN  14300>>DOSELCT 14497<<ASSIGN  14498>>DOSELCT
COMMAND
     13372**DCL     14439<<ASSIGN  14443<<ASSIGN  14469>>ASSIGN
CONSOLE_OPTS_LIST
     13394**DCL     14098--ASSIGN
CON_LOOP
     14109**LABEL   14106--REMEMBR 14116--GOTO    14208--GOTO    14784--GOTO    14804--GOTO
CREATE
     13298**DCL        30--PROC    14039>>IF      14078>>IF      14828>>IF      14834>>IF      14847>>IF
C_SYS_FLG
     13371**DCL     14037<<ASSIGN  14520<<ASSIGN  14835>>IF
C_WSN_FLG
     13370**DCL     14036<<ASSIGN  14431<<ASSIGN  14834>>IF
DADR$
     13338**DCL        30--PROC    13915--IMP-PTR 14080>>ASSIGN  14081>>ASSIGN  14082>>ASSIGN  14633>>ASSIGN
     14636>>ASSIGN  14639>>ASSIGN  14642>>ASSIGN  14645>>ASSIGN  14648>>ASSIGN  14651>>ASSIGN  14652>>ASSIGN
     14653>>ASSIGN  14654>>ASSIGN  14657>>ASSIGN  14658>>ASSIGN  14659>>ASSIGN  14662>>ASSIGN  14663>>ASSIGN
     14664>>ASSIGN  14667>>ASSIGN  14668>>ASSIGN  14669>>ASSIGN  14672>>ASSIGN  14673>>ASSIGN  14674>>ASSIGN
     14677>>ASSIGN  14678>>ASSIGN  14679>>ASSIGN  14682>>ASSIGN  14683>>ASSIGN  14684>>ASSIGN  14690>>ASSIGN
     14721>>ASSIGN  14752>>ASSIGN
DDEV
     13359**DCL     14043<<ASSIGN  14091<<ASSIGN  14255<<ASSIGN  14808<<ASSIGN  14822>>ASSIGN
END_OPTION
     14749**LABEL   14152--GOTO    14161--GOTO    14183--GOTO    14233--GOTO    14251--GOTO    14297--GOTO
     14327--GOTO    14399--GOTO    14466--GOTO    14518--GOTO    14592--GOTO    14627--GOTO    14689--CALLALT
     14715--GOTO    14720--CALLALT 14744--GOTO    14749--CALLALT
ERR_CODE
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:187  
     10039**DCL     10040--REDEF
FROM_KEY.TEXT
      9918**DCL     14071<<ASSIGN
HEX
     13378**DCL     14689<>CALL    14690>>ASSIGN  14720<>CALL    14721>>ASSIGN  14749<>CALL    14750>>ASSIGN
     14751>>ASSIGN
I
     13348**DCL     14120<<DOINDEX 14121>>ASSIGN
IN_BUF
     10035**DCL     14111<>CALL
IO
     13356**DCL     14041<<ASSIGN  14090<<ASSIGN  14254<<ASSIGN  14807<<ASSIGN  14821>>ASSIGN
J
     13386**DCL     14363<<CALLBLT 14366>>ASSIGN
K
     13387**DCL     14365<<CALLBLT 14366>>ASSIGN
KCADDR
     13353**DCL     14073<<ASSIGN  14563<<ASSIGN  14563>>ASSIGN  14568<<ASSIGN  14568>>ASSIGN  14831>>ASSIGN
KL$DADR.DEVCTL
     13935**DCL     14752<<ASSIGN
KL$DADR.DEVCTL.B
     13944**DCL     14081<<ASSIGN  14654<<ASSIGN  14659<<ASSIGN  14664<<ASSIGN  14669<<ASSIGN  14674<<ASSIGN
     14679<<ASSIGN  14684<<ASSIGN
KL$DADR.DEVCTL.T
     13942**DCL     14082<<ASSIGN  14653<<ASSIGN  14658<<ASSIGN  14663<<ASSIGN  14668<<ASSIGN  14673<<ASSIGN
     14678<<ASSIGN  14683<<ASSIGN
KL$DADR.DEVNUM#
     13926**DCL     14080<<ASSIGN  14633<<ASSIGN  14636<<ASSIGN  14639<<ASSIGN  14642<<ASSIGN  14645<<ASSIGN
     14648<<ASSIGN  14651<<ASSIGN  14657<<ASSIGN  14662<<ASSIGN  14667<<ASSIGN  14672<<ASSIGN  14677<<ASSIGN
     14682<<ASSIGN  14690<<ASSIGN
KL$DADR.SDNUM#
     13933**DCL     14652<<ASSIGN  14721<<ASSIGN
KL$PHDR
     13989**DCL     14190<>CALL    14763<>CALL
KL$PHDR.ATTR
     13993**DCL     14253>>ASSIGN  14806>>ASSIGN
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:188  
KL$PHDR.DDEV
     14008**DCL     14255>>ASSIGN  14808>>ASSIGN
KL$PHDR.IO
     14004**DCL     14254>>ASSIGN  14807>>ASSIGN
KL$PHDR.TTYP
     13990**DCL     14212>>IF      14235>>IF      14235>>IF      14787>>IF
KL$TREC
     13732**DCL     14040<<ASSIGN
KL$TREC.KC$CGID
     13851**DCL     14846--ASSIGN
KL$TREC.KC$CGID.ACCT#
     13853**DCL     14096<<ASSIGN
KL$TREC.KC$CGID.NAME#.CNT
     13857**DCL     14047<<ASSIGN  14095<<ASSIGN
KL$TREC.KC$CGID.NAME#.TXT
     13858**DCL     14094<<ASSIGN
KL$TREC.KC$CGID.PSN#
     13854**DCL     14097<<ASSIGN
KL$TREC.NWINFO
     13830**DCL     14846<<ASSIGN
KL$TREC.OCINFO
     13877**DCL     14846--ASSIGN
KL$TREC.OCINFO.CADDR
     13879**DCL     14124>>IF      14531<<ASSIGN  14531>>ASSIGN  14534<<ASSIGN  14534>>ASSIGN  14541<<ASSIGN
     14541>>ASSIGN  14560<<ASSIGN  14560>>ASSIGN  14564<<ASSIGN  14564>>ASSIGN  14569<<ASSIGN  14569>>ASSIGN
     14572<<ASSIGN  14572>>ASSIGN  14595<<ASSIGN  14599<<ASSIGN  14599>>ASSIGN  14828>>IF      14830<<ASSIGN
     14835>>IF
KL$TREC.OCINFO.CMD
     13895**DCL     14469<<ASSIGN
KL$TREC.OCINFO.CMDCNT
     13893**DCL     14468<<ASSIGN
KL$TREC.OCINFO.KCADDR
     13885**DCL     14530<<ASSIGN  14530>>ASSIGN  14540<<ASSIGN  14540>>ASSIGN  14544<<ASSIGN  14544>>ASSIGN
     14559<<ASSIGN  14559>>ASSIGN  14562<<ASSIGN  14562>>ASSIGN  14567<<ASSIGN  14567>>ASSIGN  14571<<ASSIGN
     14571>>ASSIGN  14596<<ASSIGN  14600<<ASSIGN  14600>>ASSIGN  14828>>IF      14831<<ASSIGN  14835>>IF
KL$TREC.OCINFO.LANG
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:189  
     13881**DCL     14474<<ASSIGN  14476<<ASSIGN
KL$TREC.OCINFO.MXPRI
     13883**DCL     14074<<ASSIGN  14401<<ASSIGN
KL$TREC.OCINFO.TNAME
     13890**DCL     14048<<ASSIGN
KL$TREC.OCINFO.WSN
     13888**DCL     14430<<ASSIGN  14838<<ASSIGN
KL$TREC.PASSWORD
     13790**DCL     13794--REDEF   14046<>CALL    14303<<ASSIGN  14304<>CALL    14329<<ASSIGN  14330<>CALL
     14359--ASSIGN
KL$TREC.PNAME
     13796**DCL     14256<<ASSIGN
KL$TREC.PNAME.CNT
     13804**DCL     14044<<ASSIGN  14077<<ASSIGN  14159<<ASSIGN  14761>>ASSIGN
KL$TREC.PNAME.TXT
     13807**DCL     14045<<ASSIGN  14076<<CALLBLT 14160<<ASSIGN  14758>>IF      14762>>ASSIGN  14842>>ASSIGN
KL$TREC.RENAME
     13813**DCL     13814--REDEF   14049<<ASSIGN  14070<<CALLBLT 14071>>ASSIGN  14088>>ASSIGN  14818>>ASSIGN
     14819>>ASSIGN  14823>>ASSIGN  14848>>CALLBLT
KL$TREC.TWSN#
     13787**DCL     14050<<ASSIGN  14087>>ASSIGN
KL$TWSNREC.DEVS
     13955**DCL     14093<<ASSIGN
KL$TWSNREC.DEVS.ACCT
     13969**DCL     14823<<ASSIGN
KL$TWSNREC.DEVS.ATTR
     13958**DCL     14089>>ASSIGN  14820<<ASSIGN
KL$TWSNREC.DEVS.DDEV
     13959**DCL     14091>>ASSIGN  14822<<ASSIGN
KL$TWSNREC.DEVS.IO
     13960**DCL     14090>>ASSIGN  14821<<ASSIGN
KL$TWSNREC.DEVS.NUM
     13957**DCL     14819<<ASSIGN
KL$TWSNREC.DEVS.TDEV
     13963**DCL     14824<<ASSIGN  14827<<ASSIGN
KL$TWSNREC.DEVS.TERM
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:190  
     13970**DCL     14825<<ASSIGN
KL$TWSNREC.DEVS.TYP
     13956**DCL     14818<<ASSIGN
KL$TWSNREC.STATION
     13953**DCL     14048>>ASSIGN
KL_CREC
     13419**DCL     14040>>ASSIGN
KL_CREC.PASSWORD
     13477**DCL     13481--REDEF
KL_CREC.RENAME
     13500**DCL     13501--REDEF
KL_DEFAULT.PASSWORD
     12655**DCL     12659--REDEF
KL_DEFAULT.RENAME
     12678**DCL     12679--REDEF
KL_DFLT.PASSWORD
     11845**DCL     11849--REDEF
KL_DFLT.RENAME
     11868**DCL     11869--REDEF
KL_DREC.PASSWORD
     11683**DCL     11687--REDEF
KL_DREC.RENAME
     11706**DCL     11707--REDEF
KL_DREC_CNT.PASSWORD
     11570**DCL     11574--REDEF
KL_DREC_CNT.RENAME
     11593**DCL     11594--REDEF
L
     13388**DCL     14361<<CALLBLT 14366>>ASSIGN
LOCAL
     13300**DCL        30--PROC    14501>>IF      14576>>IF
MASK
     13360**DCL     14521<<ASSIGN  14525<<ASSIGN  14547<<ASSIGN  14551<<ASSIGN  14555<<ASSIGN  14559>>ASSIGN
     14560>>ASSIGN  14562>>ASSIGN  14563>>ASSIGN  14564>>ASSIGN  14565>>ASSIGN  14567>>ASSIGN  14568>>ASSIGN
     14569>>ASSIGN  14571>>ASSIGN  14572>>ASSIGN  14573>>ASSIGN
MORE
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:191  
     13352**DCL     14034<<ASSIGN  14109>>DOWHILE 14272<<ASSIGN  14783<<ASSIGN  14803<<ASSIGN
NODE$
     10037**DCL     13639--IMP-PTR 14033>>ASSIGN  14119<<ASSIGN  14120>>DOINDEX 14121>>ASSIGN  14816<<ASSIGN
NUM
     13346**DCL     14051<>CALL    14070>>CALLBLT 14088<<ASSIGN  14843>>ASSIGN
OPTION
     13379**DCL     14689<>CALL    14720<>CALL    14749<>CALL
OPTION.COUNT
     13380**DCL     14687<<ASSIGN  14718<<ASSIGN  14747<<ASSIGN
OPTION.TEXT
     13381**DCL     14688<<ASSIGN  14719<<ASSIGN  14748<<ASSIGN
OUT$SYM.CODE
     13692**DCL     14436>>IF
OUT$SYM.COUNT
     13709**DCL     13712--IMP-SIZ 14164>>ASSIGN  14188>>ASSIGN  14189>>ASSIGN  14308>>ASSIGN  14329>>ASSIGN
     14334>>ASSIGN  14376>>CALLBLT 14407>>IF      14430>>ASSIGN  14442>>ASSIGN  14443>>ASSIGN  14472>>ASSIGN
     14474>>ASSIGN
OUT$SYM.TEXT
     13712**DCL     14189>>ASSIGN  14329>>ASSIGN  14357--ASSIGN  14376>>CALLBLT 14430>>ASSIGN  14443>>ASSIGN
     14474>>ASSIGN
P$
     13382**DCL     14357<<ASSIGN  14358>>ASSIGN  14360>>DOWHILE 14361>>CALLBLT 14362<<ASSIGN  14362>>ASSIGN
     14363>>CALLBLT 14364<<ASSIGN  14364>>ASSIGN  14365>>CALLBLT 14367<<ASSIGN  14367>>ASSIGN
P$NODE.CODE
     13647**DCL     14122>>ASSIGN  14158>>IF      14299>>ASSIGN  14494>>ASSIGN  14630>>DOSELCT
P$NODE.SUBLK$
     13672**DCL     14121>>ASSIGN  14158>>IF      14163>>ASSIGN  14299>>ASSIGN  14307>>ASSIGN  14333>>ASSIGN
     14333>>ASSIGN  14375>>ASSIGN  14403>>ASSIGN  14406>>ASSIGN  14435>>ASSIGN  14471>>ASSIGN  14494>>ASSIGN
     14630>>DOSELCT
P$NODE.SUBNODES
     13651**DCL     14120>>DOINDEX 14492>>IF
PATTR
     13355**DCL     14042<<ASSIGN  14089<<ASSIGN  14253<<ASSIGN  14806<<ASSIGN  14820>>ASSIGN
PRO$
     13363**DCL     13989--IMP-PTR 14186<<ASSIGN  14190>>CALL    14212>>IF      14235>>IF      14235>>IF
     14253>>ASSIGN  14254>>ASSIGN  14255>>ASSIGN  14759<<ASSIGN  14763>>CALL    14787>>IF      14806>>ASSIGN
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:192  
     14807>>ASSIGN  14808>>ASSIGN
PROJ_KEY.TEXT
      9917**DCL      9917--REDEF
PROJ_KEY.TXT.PROJECT
      9917**DCL      9917--REDEF
PRO_BUF
     13364**DCL     14186--ASSIGN  14187--ASSIGN  14759--ASSIGN  14760--ASSIGN
PTR$
     13351**DCL     14121<<ASSIGN  14122>>ASSIGN  14158>>IF      14163>>ASSIGN  14299>>ASSIGN  14307>>ASSIGN
     14333>>ASSIGN  14358<<ASSIGN  14360>>DOWHILE 14375>>ASSIGN  14403>>ASSIGN  14406>>ASSIGN  14435>>ASSIGN
     14471>>ASSIGN  14492>>IF      14494>>ASSIGN  14630>>DOSELCT 14689<>CALL    14720<>CALL    14749<>CALL
P_PCB
     10072**DCL     14113<>CALL
P_PCB.ERROR
     10176**DCL     14115<>CALL
P_PCB.NCHARS
     10219**DCL     14112<<ASSIGN
P_PCB.OUT$
     10085**DCL     14119>>ASSIGN
P_PCB.ROOT$
     10077**DCL     14028>>ASSIGN  14098<<ASSIGN  14814<<ASSIGN
P_PCB.WKSZ
     10102**DCL     14026>>ASSIGN  14031<<ASSIGN  14812<<ASSIGN
P_PCB.WK_USED
     10205**DCL     14027>>ASSIGN  14030>>ASSIGN  14031>>ASSIGN  14813<<ASSIGN
P_PCB.WORK$
     10081**DCL     14025>>ASSIGN  14030<<ASSIGN  14811<<ASSIGN
REMEM_VAR
     10043**DCL     10043--REDEF   14106<<REMEMBR
REM_FCMD
     10043**DCL     10044--REDEF
ROOT$
     13368**DCL     14028<<ASSIGN  14814>>ASSIGN
SET_KCADDR_CADDR
     14557**LABEL   14522--GOTO    14526--GOTO    14548--GOTO    14552--GOTO
SPLIT
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:193  
     13373**DCL     14752>>ASSIGN
SPLIT.B
     13377**DCL     14751<<ASSIGN
SPLIT.T
     13375**DCL     14750<<ASSIGN
SS
     13322**DCL        30--PROC
SS.SGN
     13327**DCL     13336--REDEF
SS.SGN.NUM
     13329**DCL     14843<<ASSIGN
SS.SGN.PNAME
     13335**DCL     14842<<ASSIGN
SS.SGN.TWSN
     13330**DCL     14844<<ASSIGN
SS.SGN.TYPE
     13328**DCL     14841<<ASSIGN
SUB
     13299**DCL        30--PROC    14075>>IF      14100>>IF      14212>>IF      14235>>IF      14277>>IF
     14607>>IF      14695>>IF      14724>>IF      14758>>IF      14826>>IF      14840>>IF
TEMP
     13383**DCL     14366<<ASSIGN  14368>>ASSIGN
TEMP$
     13384**DCL     14359<<ASSIGN  14368>>ASSIGN  14369<<ASSIGN  14369>>ASSIGN
TERM_T
     13301**DCL        30--PROC    14076>>CALLBLT 14079>>IF
TREC$
     13295**DCL        30--PROC    13732--IMP-PTR 14040>>ASSIGN  14044>>ASSIGN  14045>>ASSIGN  14046>>CALL
     14047>>ASSIGN  14048>>ASSIGN  14049>>ASSIGN  14050>>ASSIGN  14070>>CALLBLT 14071>>ASSIGN  14074>>ASSIGN
     14076>>CALLBLT 14077>>ASSIGN  14087>>ASSIGN  14088>>ASSIGN  14094>>ASSIGN  14095>>ASSIGN  14096>>ASSIGN
     14097>>ASSIGN  14124>>IF      14159>>ASSIGN  14160>>ASSIGN  14256>>ASSIGN  14303>>ASSIGN  14304>>CALL
     14329>>ASSIGN  14330>>CALL    14359>>ASSIGN  14401>>ASSIGN  14430>>ASSIGN  14468>>ASSIGN  14469>>ASSIGN
     14474>>ASSIGN  14476>>ASSIGN  14530>>ASSIGN  14530>>ASSIGN  14531>>ASSIGN  14531>>ASSIGN  14534>>ASSIGN
     14534>>ASSIGN  14540>>ASSIGN  14540>>ASSIGN  14541>>ASSIGN  14541>>ASSIGN  14544>>ASSIGN  14544>>ASSIGN
     14559>>ASSIGN  14559>>ASSIGN  14560>>ASSIGN  14560>>ASSIGN  14562>>ASSIGN  14562>>ASSIGN  14564>>ASSIGN
     14564>>ASSIGN  14567>>ASSIGN  14567>>ASSIGN  14569>>ASSIGN  14569>>ASSIGN  14571>>ASSIGN  14571>>ASSIGN
PL6.E3A0      #002=ASA$CON_OPTS File=ASA$CONSOLE.:E05TSI                         TUE 07/29/97 08:35 Page:194  
     14572>>ASSIGN  14572>>ASSIGN  14595>>ASSIGN  14596>>ASSIGN  14599>>ASSIGN  14599>>ASSIGN  14600>>ASSIGN
     14600>>ASSIGN  14758>>IF      14761>>ASSIGN  14762>>ASSIGN  14818>>ASSIGN  14819>>ASSIGN  14823>>ASSIGN
     14828>>IF      14828>>IF      14830>>ASSIGN  14831>>ASSIGN  14835>>IF      14835>>IF      14838>>ASSIGN
     14842>>ASSIGN  14846>>ASSIGN  14848>>CALLBLT
TWSNC
     13297**DCL        30--PROC    14050>>ASSIGN  14070>>CALLBLT 14087<<ASSIGN  14844>>ASSIGN
TWSNR$
     13296**DCL        30--PROC    13951--IMP-PTR 14048>>ASSIGN  14051<>CALL    14089>>ASSIGN  14090>>ASSIGN
     14091>>ASSIGN  14093>>ASSIGN  14818>>ASSIGN  14819>>ASSIGN  14820>>ASSIGN  14821>>ASSIGN  14822>>ASSIGN
     14823>>ASSIGN  14824>>ASSIGN  14825>>ASSIGN  14827>>ASSIGN
TWSN_INDEX
     13302**DCL        30--PROC    14089>>ASSIGN  14090>>ASSIGN  14091>>ASSIGN  14093>>ASSIGN  14818>>ASSIGN
     14819>>ASSIGN  14820>>ASSIGN  14821>>ASSIGN  14822>>ASSIGN  14823>>ASSIGN  14824>>ASSIGN  14825>>ASSIGN
     14827>>ASSIGN
TYPE
     13345**DCL     14035<<ASSIGN  14051<>CALL    14070>>CALLBLT 14841>>ASSIGN
T_NODE$
     13369**DCL     14033<<ASSIGN  14816>>ASSIGN
USERS_KEY
      9914**DCL     14190<>CALL    14192>>ASSIGN  14256>>ASSIGN  14763<>CALL
USERS_KEY.COUNT
      9914**DCL     14188<<ASSIGN  14761<<ASSIGN
USERS_KEY.TEXT
      9914**DCL      9915--REDEF    9915--REDEF    9915--REDEF    9916--REDEF
USERS_KEY.TXTC
      9915**DCL     14189<<ASSIGN  14762<<ASSIGN
WKSZ
     13366**DCL     14026<<ASSIGN  14031>>ASSIGN  14812>>ASSIGN
WK_USED
     13367**DCL     14027<<ASSIGN  14813>>ASSIGN
WORK$
     13365**DCL     14025<<ASSIGN  14030>>ASSIGN  14811>>ASSIGN
X$PARSE
     13593**DCL-ENT 14113--CALL
