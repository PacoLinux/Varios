VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:1    
        1        1        /*M* ASL$LIST_ALL_LINES:  routine to handle LIST LINE cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_LINES: PROC;
       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_LINES
       14       14             CALL:     CALL ASL$LIST_ALL_LINES
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_LINES is a subroutine to handle
       18       18                           the LIST LINE command for SUPER.
       19       19                           Line records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual line name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for lines
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For lines the
       35       35                           EQU is KLAT_LINE# and its value is 5.
       36       36                           This routine will either read a single line
       37       37                           record or it will cycle through all of the line
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:2    
       38       38                           records looking for matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will do either
       42       42                           of two things.  It will call the display routine
       43       43                           if the command was a DISPLAY command, or it will
       44       44                           put the vector framing the line name into the
       45       45                           formatter vector list.
       46       46
       47       47                  MEMORY REQUIREMENTS:
       48       48                           For all of the routines that deal with listing/
       49       49                           displaying lines:
       50       50
       51       51                            ASL$LIST_ALL_LINES
       52       52                            ASL$DISP_ONE_LINE
       53       53
       54       54                            The line record will be read into
       55       55                            data segment 1.  The name will be used by the
       56       56                            ASL$LIST_ALL_LINES, while the other info
       57       57                            will be used by the ASL$DISP_ONE_LINE routine.
       58       58        */
       59       59        /********************************************************************/
       60       60        /*   Include files   include files   include files   include files  */
       61       61        /********************************************************************/
       62       62        %INCLUDE AS_PERR_C;
       63      664        %INCLUDE AS_SUPER_C;
       64     1099        %INCLUDE AS_SUBS_C;
       65     2513        %INCLUDE AS_MAC_C;
       66     2593        %INCLUDE AS_ENTRIES_M;
       67     3643        %INCLUDE AS_SSUBS_C;
       68     3735        %INCLUDE B_ERRORS_C;
       69     4862        %INCLUDE CP_6_SUBS;
       70     5402        %INCLUDE KL_SUPER_C;
       71     8304        %INCLUDE XU_MACRO_C;
       72    11410        %INCLUDE XU_FORMAT_C;
       73    11572        %INCLUDE OCI_SUBS_C;
       74    11670        %INCLUDE AS_SUPER_R;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:3    
       75    14686        /********************************************************************/
       76    14687        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       77    14688        /********************************************************************/
       78    14689        %ASB$PREC_HLP ;
       79    14692        %ASB$READ_HLP ;
       80    14695        %ASB$READ_HLP_SEQ ;
       81    14698        %ASH$ERROR ;
       82    14701        %ASA$ERROR ;
       83    14704        %ASL$DISP_ONE_LINE ;
       84    14707        %ASB$WILD_MATCH ;
       85    14710    1   DCL X$FORMAT ENTRY(1) ;
       86    14711        /********************************************************************/
       87    14712        /*   Local based     local based     local based     local based    */
       88    14713        /********************************************************************/
       89    14714        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       90    14715                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       91    14760        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       92    14798        %KL_DREC ( NAME = LINE$DREC,
       93    14799                   STCLASS = "BASED(DSEG1$)",
       94    14800                   LAST = ";");
       95    14913        /********************************************************************/
       96    14914        /*   Auto data       auto data       auto data       auto data      */
       97    14915        /********************************************************************/
       98    14916    1   DCL ALL_LINES              BIT(1);
       99    14917    1   DCL 1 BEGIN_KEY ,
      100    14918    1          2 COUNT             UBIN BYTE,
      101    14919    1          2 TEXT              CHAR(8);
      102    14920    1   DCL CODE2                  UBIN;
      103    14921    1   DCL CURRENT_LINE           CHAR(8);
      104    14922    1   DCL DISP                   BIT(1);
      105    14923    1   DCL DISP_LINES             SBIN;
      106    14924    1   DCL 1 END_KEY ,
      107    14925    1          2 COUNT             UBIN BYTE,
      108    14926    1          2 TEXT              CHAR(8);
      109    14927    1   DCL I                      UBIN;
      110    14928    1   DCL J                      UBIN;
      111    14929    1   DCL JCL                    BIT(1);
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:4    
      112    14930    1   DCL 1 LINE_NAME,
      113    14931    1          2 COUNT             UBIN BYTE UNAL,
      114    14932    1          2 TEXT              CHAR(8) UNAL;
      115    14933    1   DCL WILD_CARD              BIT(1);
      116    14934        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:5    
      117    14935        /********************************************************************/
      118    14936        /*   Constant data   constant data   constant data   constant data  */
      119    14937        /********************************************************************/
      120    14938    1   DCL LINE_STR               CHAR(0) CONSTANT INIT ('line');
      121    14939    1   DCL LINES_STR              CHAR(0) CONSTANT INIT ('lines');
      122    14940    1   DCL LIST_STR               CHAR(0) CONSTANT INIT ('listed');
      123    14941    1   DCL DISPLAY_STR            CHAR(0) CONSTANT INIT ('displayed');
      124    14942        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:6    
      125    14943        /********************************************************************/
      126    14944        /*   Procedure       procedure       procedure       procedure      */
      127    14945        /********************************************************************/
      128    14946    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      129    14947    1   JCL = %NO#;
      130    14948    1   WILD_CARD = %NO#;
      131    14949    1   LINE_NAME.TEXT = ' ';
      132    14950    1   LINE_NAME.COUNT = 0;
      133    14951    1   DISP_LINES = 0;
      134    14952
      135    14953    2   DO SELECT (CODE);
      136    14954
      137    14955    2      SELECT (%LIST_ALL_VAL);
      138    14956
      139    14957    2      DISP = %NO#;
      140    14958    2      JCL = %NO#;
      141    14959
      142    14960    2      SELECT (%DISPLAY_ALL_VAL);
      143    14961
      144    14962    2      DISP = %YES#;
      145    14963    3      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN DO;
      146    14964    3         IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL THEN
      147    14965    3            JCL = %YES#;
      148    14966    4         ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN DO;
      149    14967    4               IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL THEN
      150    14968    4                  JCL = %YES#;
      151    14969    4               END; /*  Nsublks = 2  */
      152    14970    3         END; /*  Nsublks > 0  */
      153    14971
      154    14972    2      SELECT (%LIST_LINE_VAL);
      155    14973
      156    14974    2      DISP = %NO#;
      157    14975    2      JCL = %NO#;
      158    14976    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;
      159    14977    3         LINE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      160    14978    3         LINE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      161    14979    3         END; /*  Number of sublocks > 1  */
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:7    
      162    14980
      163    14981    2      SELECT (%DISPLAY_LINE_VAL);
      164    14982
      165    14983    2      DISP = %YES#;
      166    14984    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      167    14985    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      168    14986
      169    14987    4         DO SELECT (CODE2);
      170    14988
      171    14989    4            SELECT (%LINE_NAME_WILD_VAL);
      172    14990
      173    14991    4            LINE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      174    14992    4            LINE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      175    14993
      176    14994    4            SELECT (%JCL_VAL);
      177    14995
      178    14996    4            JCL = %YES#;
      179    14997
      180    14998    4            END;  /* Do case (CODE2) */
      181    14999
      182    15000    3         END;  /*  Do i  */
      183    15001
      184    15002    2      END;  /*  Do case (code)  */
      185    15003
      186    15004    1   IF LINE_NAME.COUNT = 0 THEN
      187    15005    1      ALL_LINES = %YES#;
      188    15006    1   ELSE IF LINE_NAME.TEXT = '?' THEN
      189    15007    1         ALL_LINES = %YES#;
      190    15008    2      ELSE DO;
      191    15009    2         ALL_LINES = %NO#;
      192    15010    2         BEGIN_KEY.TEXT = ' ';
      193    15011    2         END_KEY.TEXT = ' ';
      194    15012    3         CALL INDEX (I,'?',LINE_NAME.TEXT) WHENRETURN DO;
      195    15013    3            BEGIN_KEY.TEXT = SUBSTR(LINE_NAME.TEXT,0,I);
      196    15014    3            BEGIN_KEY.COUNT = 8;
      197    15015    3            CALL CONCAT (END_KEY.TEXT,SUBSTR(LINE_NAME.TEXT,0,I),'~');
      198    15016    3            END_KEY.COUNT = I + 1;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:8    
      199    15017    3            WILD_CARD = %YES#;
      200    15018    3            END; /*  Whenreturn from index  */
      201    15019    3         WHENALTRETURN DO;
      202    15020    3            WILD_CARD = %NO#;
      203    15021    3            END; /* Whenaltreturn  */
      204    15022    2         END; /*  Else  */
      205    15023
      206    15024    1   FDS.NVECS# = 0;
      207    15025    2   IF JCL THEN DO;
      208    15026    2      CALL CONCAT (FMT_BUF, '%1/"', LINES_STR, '%1/');
      209    15027    2      FDS.FMT_.BOUND = LENGTHC (LINES_STR) + 6;
      210    15028    2      END;  /*  Jcl  */
      211    15029    2   ELSE DO;
      212    15030    2      CALL CONCAT (FMT_BUF, '%1/', LINES_STR, '%1/');
      213    15031    2      FDS.FMT_.BOUND = LENGTHC (LINES_STR) + 5;
      214    15032    2      END;  /*  Jcl  */
      215    15033    1   FDS.TABDFLT# = 10;
      216    15034    1   CALL X$FORMAT (FDS);
      217    15035
      218    15036    2   IF ALL_LINES THEN DO;
      219    15037    2      USERS_KEY = '001040'O;     /* To precord to begin of :HLP */
      220    15038    2      END;  /*  ALL_LINES  */
      221    15039    2   ELSE IF WILD_CARD THEN DO;
      222    15040    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');
      223    15041    2         USERS_KEY.COUNT = 9 ;
      224    15042    2         END; /*  WILD_CARD  */
      225    15043    2      ELSE DO;  /*  Single line  */
      226    15044    2         CALL CONCAT (USERS_KEY.TXTC,LINE_NAME.TEXT,'*');
      227    15045    2         USERS_KEY.COUNT = 9 ;
      228    15046    2         I = DSEG1SIZE;
      229    15047    2         CALL ASB$READ_HLP (DSEG1$,I,1)
      230    15048    3         WHENRETURN DO;
      231    15049    4            IF LINE$DREC.ATYP ~= %KLAT_LINE# THEN DO;
      232    15050                 /*E*  ERROR:    ASL-E$NOTLINE-C
      233    15051                       MESSAGE: %%U1 %is not a line.
      234    15052                       MESSAGE1: %%U1 %is a %U2.
      235    15053                 */
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:9    
      236    15054    4               AS_FIELD1 = LINE_NAME;
      237    15055                    %SCREAM( ERR#=E$NOTLINE , LEVEL=ERROR, MID='L' );
      238    15070    4               RETURN ;
      239    15071    4               END ; /* Then do */
      240    15072    3            IF DISP THEN
      241    15073    4            DO;
      242    15074    4               CALL ASL$DISP_ONE_LINE (JCL);
      243    15075    4               END; /*  If disp  */
      244    15076    4            ELSE DO;
      245    15077    4               CALL CONCAT (FMT_BUF, SUBSTR(LINE_NAME.TEXT,0,LINE_NAME.COUNT), '%1/');
      246    15078    4               FDS.FMT_.BOUND = LINE_NAME.COUNT + 2;
      247    15079    4               CALL X$FORMAT (FDS);
      248    15080    4               END; /*  Else  disp  */
      249    15081    3            END;  /*  Whenreturn  */
      250    15082    3         WHENALTRETURN DO;
      251    15083    3            IF MERR_CODE.CODE = %E$NOKEY
      252    15084    4            THEN DO;
      253    15085        /*E* ERROR:   ASL-E$LINE_NO_EXIST2-C
      254    15086             MESSAGE: Line %U1 does not exist.
      255    15087             MESSAGE1: The specified LINE does not exist.
      256    15088        */
      257    15089    4               AS_FIELD1 = LINE_NAME;
      258    15090                    %SCREAM( ERR#=E$LINE_NO_EXIST2, MID='L', LEVEL=ERROR );
      259    15105    4               END;  /*  Error = nokey  */
      260    15106    4            ELSE DO;
      261    15107    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      262    15108    4               END;  /* Error ~= nokey */
      263    15109    3            END;  /*  Whenaltreturn  */
      264    15110    2         RETURN;
      265    15111    2         END; /*  Else  */
      266    15112    1   CALL ASB$PREC_HLP ;
      267    15113    2   DO FOREVER;
      268    15114
      269    15115    3      DO UNTIL LINE$DREC.ATYP = %KLAT_LINE# ;
      270    15116    3         I = DSEG1SIZE;
      271    15117    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)
      272    15118    4         WHENALTRETURN DO;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:10   
      273    15119    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);
      274    15120    4            GOTO FINISH_UP;
      275    15121    4            END;  /*  Whenaltreturn  */
      276    15122    3         END;  /*  Do until we find a line record  */
      277    15123    3      CALL INDEX (I,' ',USERS_KEY.TXTC) WHENALTRETURN DO;
      278    15124    3         I = 8;
      279    15125    3         END;  /*  Whenaltreturn  */
      280    15126    2      IF I > 8 THEN I = 8;
      281    15127    2      CURRENT_LINE = SUBSTR(USERS_KEY.TXTC,0,I);
      282    15128    3      IF WILD_CARD THEN DO;
      283    15129    3         J = LINE_NAME.COUNT;
      284    15130    3         CALL ASB$WILD_MATCH (I, CURRENT_LINE, J, LINE_NAME.TEXT)
      285    15131    4         WHENALTRETURN DO;
      286    15132    4            IF CURRENT_LINE > END_KEY.TEXT THEN
      287    15133    4               GOTO FINISH_UP;
      288    15134    4            ELSE
      289    15135    4               GOTO END_FOREVER;
      290    15136    4            END;  /*  Whenaltreturn  */
      291    15137    3         END; /*  WILD_CARD  */
      292    15138    2      IF DISP THEN
      293    15139    3      DO;
      294    15140    3         CALL ASL$DISP_ONE_LINE (JCL);
      295    15141    3         END; /*  If disp  */
      296    15142    3      ELSE DO;
      297    15143    4         IF DISP_LINES = 0 THEN DO;
      298    15144    4            CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_LINE,0,I));
      299    15145    4            FDS.FMT_.BOUND = I+1 ;
      300    15146    4            END; /*  DISP_LINES = 0  */
      301    15147    4         ELSE DO;
      302    15148    4            CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_LINE,0,I));
      303    15149    4            FDS.FMT_.BOUND = I + 7;
      304    15150    4            END; /*  Else  */
      305    15151    3         CALL X$FORMAT (FDS);
      306    15152    3         END; /*  Else  disp  */
      307    15153    2      DISP_LINES = DISP_LINES + 1;
      308    15154    2   END_FOREVER:
      309    15155    2      END;  /*  Do forever  */
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:11   
      310    15156    1   FINISH_UP:
      311    15157    2   IF NOT DISP THEN DO;
      312    15158    2      FMT_BUF = '%\%/';
      313    15159    2      FDS.FMT_.BOUND = 3;
      314    15160    2      FDS.NVECS# = 0;
      315    15161    2      CALL X$FORMAT(FDS);
      316    15162    2      END; /*  If not disp  */
      317    15163    2   IF NOT JCL THEN DO;
      318    15164    2      FMT_VEC(0) = VECTOR (DISP_LINES);
      319    15165    2      IF DISP_LINES = 1 THEN
      320    15166    3      DO;
      321    15167    3         FMT_VEC(1) = VECTOR (LINE_STR);
      322    15168    3         END; /*  DISP_LINES = 1  */
      323    15169    3      ELSE DO;
      324    15170    3         FMT_VEC(1) = VECTOR (LINES_STR);
      325    15171    3         END; /*  DISP_LINES ~= 1  */
      326    15172    2      IF DISP THEN
      327    15173    3      DO;
      328    15174    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      329    15175    3         END; /*  If disp  */
      330    15176    3      ELSE DO;
      331    15177    3         FMT_VEC(2) = VECTOR (LIST_STR);
      332    15178    3         END; /*  If ~ disp  */
      333    15179    2      FDS.NVECS# = 3;
      334    15180    2      FMT_BUF = '   %5D %A %A.';
      335    15181    2      FDS.FMT_.BOUND = 12;
      336    15182    2      CALL X$FORMAT(FDS);
      337    15183    2      END; /* Not jcl */
      338    15184    1   RETURN;
      339    15185    1   END ASL$LIST_ALL_LINES;
      340    15186        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:12   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_LINES.

   Procedure ASL$LIST_ALL_LINES requires 464 words for executable code.
   Procedure ASL$LIST_ALL_LINES requires 28 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:13   

 Object Unit name= ASL$LIST_ALL_LINES                         File name= ASL$LIST_LINES.:E05TOU
 UTS= JUL 29 '97 10:11:58.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     19     23  ASL$LIST_ALL_LINES
    2   Proc  even  none   464    720  ASL$LIST_ALL_LINES
    3  RoData even  none    26     32  ASL$LIST_ALL_LINES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_LINES

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 ASL$DISP_ONE_LINE
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASH$ERROR
         yes           Std       3 ASA$ERROR
 yes     yes           Std       0 ASB$PREC_HLP
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       3 ASB$READ_HLP_SEQ
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:14   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:15   


        1        1        /*M* ASL$LIST_ALL_LINES:  routine to handle LIST LINE cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_LINES: PROC;

     10  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000034 000000                    ZERO    28,0

       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_LINES
       14       14             CALL:     CALL ASL$LIST_ALL_LINES
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_LINES is a subroutine to handle
       18       18                           the LIST LINE command for SUPER.
       19       19                           Line records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual line name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for lines
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:16   
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For lines the
       35       35                           EQU is KLAT_LINE# and its value is 5.
       36       36                           This routine will either read a single line
       37       37                           record or it will cycle through all of the line
       38       38                           records looking for matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will do either
       42       42                           of two things.  It will call the display routine
       43       43                           if the command was a DISPLAY command, or it will
       44       44                           put the vector framing the line name into the
       45       45                           formatter vector list.
       46       46
       47       47                  MEMORY REQUIREMENTS:
       48       48                           For all of the routines that deal with listing/
       49       49                           displaying lines:
       50       50
       51       51                            ASL$LIST_ALL_LINES
       52       52                            ASL$DISP_ONE_LINE
       53       53
       54       54                            The line record will be read into
       55       55                            data segment 1.  The name will be used by the
       56       56                            ASL$LIST_ALL_LINES, while the other info
       57       57                            will be used by the ASL$DISP_ONE_LINE routine.
       58       58        */
       59       59        /********************************************************************/
       60       60        /*   Include files   include files   include files   include files  */
       61       61        /********************************************************************/
       62       62        %INCLUDE AS_PERR_C;
       63      664        %INCLUDE AS_SUPER_C;
       64     1099        %INCLUDE AS_SUBS_C;
       65     2513        %INCLUDE AS_MAC_C;
       66     2593        %INCLUDE AS_ENTRIES_M;
       67     3643        %INCLUDE AS_SSUBS_C;
       68     3735        %INCLUDE B_ERRORS_C;
       69     4862        %INCLUDE CP_6_SUBS;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:17   
       70     5402        %INCLUDE KL_SUPER_C;
       71     8304        %INCLUDE XU_MACRO_C;
       72    11410        %INCLUDE XU_FORMAT_C;
       73    11572        %INCLUDE OCI_SUBS_C;
       74    11670        %INCLUDE AS_SUPER_R;
       75    14686        /********************************************************************/
       76    14687        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       77    14688        /********************************************************************/
       78    14689        %ASB$PREC_HLP ;
       79    14692        %ASB$READ_HLP ;
       80    14695        %ASB$READ_HLP_SEQ ;
       81    14698        %ASH$ERROR ;
       82    14701        %ASA$ERROR ;
       83    14704        %ASL$DISP_ONE_LINE ;
       84    14707        %ASB$WILD_MATCH ;
       85    14710    1   DCL X$FORMAT ENTRY(1) ;
       86    14711        /********************************************************************/
       87    14712        /*   Local based     local based     local based     local based    */
       88    14713        /********************************************************************/
       89    14714        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       90    14715                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       91    14760        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       92    14798        %KL_DREC ( NAME = LINE$DREC,
       93    14799                   STCLASS = "BASED(DSEG1$)",
       94    14800                   LAST = ";");
       95    14913        /********************************************************************/
       96    14914        /*   Auto data       auto data       auto data       auto data      */
       97    14915        /********************************************************************/
       98    14916    1   DCL ALL_LINES              BIT(1);
       99    14917    1   DCL 1 BEGIN_KEY ,
      100    14918    1          2 COUNT             UBIN BYTE,
      101    14919    1          2 TEXT              CHAR(8);
      102    14920    1   DCL CODE2                  UBIN;
      103    14921    1   DCL CURRENT_LINE           CHAR(8);
      104    14922    1   DCL DISP                   BIT(1);
      105    14923    1   DCL DISP_LINES             SBIN;
      106    14924    1   DCL 1 END_KEY ,
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:18   
      107    14925    1          2 COUNT             UBIN BYTE,
      108    14926    1          2 TEXT              CHAR(8);
      109    14927    1   DCL I                      UBIN;
      110    14928    1   DCL J                      UBIN;
      111    14929    1   DCL JCL                    BIT(1);
      112    14930    1   DCL 1 LINE_NAME,
      113    14931    1          2 COUNT             UBIN BYTE UNAL,
      114    14932    1          2 TEXT              CHAR(8) UNAL;
      115    14933    1   DCL WILD_CARD              BIT(1);
      116    14934        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:19   
      117    14935        /********************************************************************/
      118    14936        /*   Constant data   constant data   constant data   constant data  */
      119    14937        /********************************************************************/
      120    14938    1   DCL LINE_STR               CHAR(0) CONSTANT INIT ('line');
      121    14939    1   DCL LINES_STR              CHAR(0) CONSTANT INIT ('lines');
      122    14940    1   DCL LIST_STR               CHAR(0) CONSTANT INIT ('listed');
      123    14941    1   DCL DISPLAY_STR            CHAR(0) CONSTANT INIT ('displayed');
      124    14942        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:20   
      125    14943        /********************************************************************/
      126    14944        /*   Procedure       procedure       procedure       procedure      */
      127    14945        /********************************************************************/
      128    14946    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  14946  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      129    14947    1   JCL = %NO#;

  14947  2 000007   200021 450100                    STZ     JCL,,AUTO

      130    14948    1   WILD_CARD = %NO#;

  14948  2 000010   200025 450100                    STZ     WILD_CARD,,AUTO

      131    14949    1   LINE_NAME.TEXT = ' ';

  14949  2 000011   040100 100400                    MLR     fill='040'O
         2 000012   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000013   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8

      132    14950    1   LINE_NAME.COUNT = 0;

  14950  2 000014   000000 236003                    LDQ     0,DU
         2 000015   200022 552140                    STBQ    LINE_NAME,'40'O,AUTO

      133    14951    1   DISP_LINES = 0;

  14951  2 000016   200013 450100                    STZ     DISP_LINES,,AUTO

      134    14952
      135    14953    2   DO SELECT (CODE);

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:21   
  14953  2 000017   000000 236000 xsym               LDQ     CODE
         2 000020   000022 116007                    CMPQ    18,DL
         2 000021   000032 602000 2                  TNC     s:14953+11
         2 000022   000035 600000 2                  TZE     s:14957
         2 000023   000144 116007                    CMPQ    100,DL
         2 000024   000027 602000 2                  TNC     s:14953+8
         2 000025   000040 600000 2                  TZE     s:14962
         2 000026   000152 710000 2                  TRA     s:15004
         2 000027   000127 116007                    CMPQ    87,DL
         2 000030   000152 601000 2                  TNZ     s:15004
         2 000031   000103 710000 2                  TRA     s:14983
         2 000032   000011 116007                    CMPQ    9,DL
         2 000033   000152 601000 2                  TNZ     s:15004
         2 000034   000063 710000 2                  TRA     s:14974

      136    14954
      137    14955    2      SELECT (%LIST_ALL_VAL);

      138    14956
      139    14957    2      DISP = %NO#;

  14957  2 000035   200012 450100                    STZ     DISP,,AUTO

      140    14958    2      JCL = %NO#;

  14958  2 000036   200021 450100                    STZ     JCL,,AUTO
         2 000037   000152 710000 2                  TRA     s:15004

      141    14959
      142    14960    2      SELECT (%DISPLAY_ALL_VAL);

      143    14961
      144    14962    2      DISP = %YES#;

  14962  2 000040   400000 236003                    LDQ     -131072,DU
         2 000041   200012 756100                    STQ     DISP,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:22   
      145    14963    3      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN DO;

  14963  2 000042   000003 471500                    LDP1    3,,PR0
         2 000043   100001 220100                    LDX0    1,,PR1
         2 000044   000152 600000 2                  TZE     s:15004

      146    14964    3         IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL THEN

  14964  2 000045   100003 473500                    LDP3    3,,PR1
         2 000046   300000 721100                    LXL1    0,,PR3
         2 000047   000001 101003                    CMPX1   1,DU
         2 000050   000053 601000 2                  TNZ     s:14966

      147    14965    3            JCL = %YES#;

  14965  2 000051   200021 756100                    STQ     JCL,,AUTO
         2 000052   000152 710000 2                  TRA     s:15004

      148    14966    4         ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN DO;

  14966  2 000053   000002 100003                    CMPX0   2,DU
         2 000054   000152 601000 2                  TNZ     s:15004

      149    14967    4               IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL THEN

  14967  2 000055   100004 474500                    LDP4    4,,PR1
         2 000056   400000 722100                    LXL2    0,,PR4
         2 000057   000001 102003                    CMPX2   1,DU
         2 000060   000152 601000 2                  TNZ     s:15004

      150    14968    4                  JCL = %YES#;

  14968  2 000061   200021 756100                    STQ     JCL,,AUTO

      151    14969    4               END; /*  Nsublks = 2  */

      152    14970    3         END; /*  Nsublks > 0  */
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:23   

  14970  2 000062   000152 710000 2                  TRA     s:15004

      153    14971
      154    14972    2      SELECT (%LIST_LINE_VAL);

      155    14973
      156    14974    2      DISP = %NO#;

  14974  2 000063   200012 450100                    STZ     DISP,,AUTO

      157    14975    2      JCL = %NO#;

  14975  2 000064   200021 450100                    STZ     JCL,,AUTO

      158    14976    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;

  14976  2 000065   000001 220100                    LDX0    1,,PR0
         2 000066   000002 100003                    CMPX0   2,DU
         2 000067   000152 602000 2                  TNC     s:15004

      159    14977    3         LINE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  14977  2 000070   000004 471500                    LDP1    4,,PR0
         2 000071   100004 236100                    LDQ     4,,PR1
         2 000072   000033 772000                    QRL     27
         2 000073   000000 621006                    EAX1    0,QL
         2 000074   040100 100540                    MLR     fill='040'O
         2 000075   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000076   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8

      160    14978    3         LINE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  14978  2 000077   000004 471500                    LDP1    4,,PR0
         2 000100   100004 236100                    LDQ     4,,PR1
         2 000101   200022 552140                    STBQ    LINE_NAME,'40'O,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:24   
      161    14979    3         END; /*  Number of sublocks > 1  */

  14979  2 000102   000152 710000 2                  TRA     s:15004

      162    14980
      163    14981    2      SELECT (%DISPLAY_LINE_VAL);

      164    14982
      165    14983    2      DISP = %YES#;

  14983  2 000103   400000 236003                    LDQ     -131072,DU
         2 000104   200012 756100                    STQ     DISP,,AUTO

      166    14984    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  14984  2 000105   000001 235007                    LDA     1,DL
         2 000106   200017 755100                    STA     I,,AUTO
         2 000107   000145 710000 2                  TRA     s:15000+3

      167    14985    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  14985  2 000110   000003 470400 xsym               LDP0    P_PCB+3
         2 000111   200017 720100                    LXL0    I,,AUTO
         2 000112   000003 471510                    LDP1    3,X0,PR0
         2 000113   100000 236100                    LDQ     0,,PR1
         2 000114   777777 376007                    ANQ     -1,DL
         2 000115   200007 756100                    STQ     CODE2,,AUTO

      168    14986
      169    14987    4         DO SELECT (CODE2);

  14987  2 000116   000353 116007                    CMPQ    235,DL
         2 000117   000122 602000 2                  TNC     s:14987+4
         2 000120   000125 600000 2                  TZE     s:14991
         2 000121   000142 710000 2                  TRA     s:15000
         2 000122   000001 116007                    CMPQ    1,DL
         2 000123   000142 601000 2                  TNZ     s:15000
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:25   
         2 000124   000140 710000 2                  TRA     s:14996

      170    14988
      171    14989    4            SELECT (%LINE_NAME_WILD_VAL);

      172    14990
      173    14991    4            LINE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  14991  2 000125   000004 473500                    LDP3    4,,PR0
         2 000126   300004 236100                    LDQ     4,,PR3
         2 000127   000033 772000                    QRL     27
         2 000130   000000 621006                    EAX1    0,QL
         2 000131   040100 100540                    MLR     fill='040'O
         2 000132   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         2 000133   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8

      174    14992    4            LINE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  14992  2 000134   000004 471500                    LDP1    4,,PR0
         2 000135   100004 236100                    LDQ     4,,PR1
         2 000136   200022 552140                    STBQ    LINE_NAME,'40'O,AUTO
         2 000137   000142 710000 2                  TRA     s:15000

      175    14993
      176    14994    4            SELECT (%JCL_VAL);

      177    14995
      178    14996    4            JCL = %YES#;

  14996  2 000140   400000 236003                    LDQ     -131072,DU
         2 000141   200021 756100                    STQ     JCL,,AUTO

      179    14997
      180    14998    4            END;  /* Do case (CODE2) */

      181    14999
      182    15000    3         END;  /*  Do i  */
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:26   

  15000  2 000142   200017 235100                    LDA     I,,AUTO
         2 000143   000001 035007                    ADLA    1,DL
         2 000144   200017 755100                    STA     I,,AUTO
         2 000145   000001 236100                    LDQ     1,,PR0
         2 000146   000022 772000                    QRL     18
         2 000147   200017 116100                    CMPQ    I,,AUTO
         2 000150   000152 600000 2                  TZE     s:15004
         2 000151   000110 603000 2                  TRC     s:14985

      183    15001
      184    15002    2      END;  /*  Do case (code)  */

      185    15003
      186    15004    1   IF LINE_NAME.COUNT = 0 THEN

  15004  2 000152   200022 236100                    LDQ     LINE_NAME,,AUTO
         2 000153   777000 316003                    CANQ    -512,DU
         2 000154   000160 601000 2                  TNZ     s:15006

      187    15005    1      ALL_LINES = %YES#;

  15005  2 000155   400000 236003                    LDQ     -131072,DU
         2 000156   200003 756100                    STQ     ALL_LINES,,AUTO
         2 000157   000235 710000 2                  TRA     s:15024

      188    15006    1   ELSE IF LINE_NAME.TEXT = '?' THEN

  15006  2 000160   040000 106500                    CMPC    fill='040'O
         2 000161   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000162   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000163   000167 601000 2                  TNZ     s:15009

      189    15007    1         ALL_LINES = %YES#;

  15007  2 000164   400000 236003                    LDQ     -131072,DU
         2 000165   200003 756100                    STQ     ALL_LINES,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:27   
         2 000166   000235 710000 2                  TRA     s:15024

      190    15008    2      ELSE DO;

      191    15009    2         ALL_LINES = %NO#;

  15009  2 000167   200003 450100                    STZ     ALL_LINES,,AUTO

      192    15010    2         BEGIN_KEY.TEXT = ' ';

  15010  2 000170   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000171   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000172   200005 755100                    STA     BEGIN_KEY+1,,AUTO
         2 000173   200006 756100                    STQ     BEGIN_KEY+2,,AUTO

      193    15011    2         END_KEY.TEXT = ' ';

  15011  2 000174   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000175   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000176   200015 755100                    STA     END_KEY+1,,AUTO
         2 000177   200016 756100                    STQ     END_KEY+2,,AUTO

      194    15012    3         CALL INDEX (I,'?',LINE_NAME.TEXT) WHENRETURN DO;

  15012  2 000200   000000 124500                    SCM     mask='000'O
         2 000201   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000202   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000203   200017 000100                    ARG     I,,AUTO
         2 000204   000234 606400 2                  TTN     s:15020

      195    15013    3            BEGIN_KEY.TEXT = SUBSTR(LINE_NAME.TEXT,0,I);

  15013  2 000205   200017 720100                    LXL0    I,,AUTO
         2 000206   040100 100540                    MLR     fill='040'O
         2 000207   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=*X0
         2 000210   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:28   
      196    15014    3            BEGIN_KEY.COUNT = 8;

  15014  2 000211   010000 236003                    LDQ     4096,DU
         2 000212   200004 756100                    STQ     BEGIN_KEY,,AUTO

      197    15015    3            CALL CONCAT (END_KEY.TEXT,SUBSTR(LINE_NAME.TEXT,0,I),'~');

  15015  2 000213   040100 100540                    MLR     fill='040'O
         2 000214   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=*X0
         2 000215   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000216   200017 236100                    LDQ     I,,AUTO
         2 000217   000010 116007                    CMPQ    8,DL
         2 000220   000226 603000 2                  TRC     s:15016
         2 000221   777767 621006                    EAX1    -9,QL
         2 000222   777777 661003                    ERX1    -1,DU
         2 000223   040146 100400                    MLR     fill='040'O
         2 000224   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000225   200015 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1

      198    15016    3            END_KEY.COUNT = I + 1;

  15016  2 000226   000001 036007                    ADLQ    1,DL
         2 000227   000033 736000                    QLS     27
         2 000230   200014 756100                    STQ     END_KEY,,AUTO

      199    15017    3            WILD_CARD = %YES#;

  15017  2 000231   400000 236003                    LDQ     -131072,DU
         2 000232   200025 756100                    STQ     WILD_CARD,,AUTO

      200    15018    3            END; /*  Whenreturn from index  */

  15018  2 000233   000235 710000 2                  TRA     s:15024

      201    15019    3         WHENALTRETURN DO;

      202    15020    3            WILD_CARD = %NO#;
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:29   

  15020  2 000234   200025 450100                    STZ     WILD_CARD,,AUTO

      203    15021    3            END; /* Whenaltreturn  */

      204    15022    2         END; /*  Else  */

      205    15023
      206    15024    1   FDS.NVECS# = 0;

  15024  2 000235   000011 450000 xsym               STZ     FDS+9

      207    15025    2   IF JCL THEN DO;

  15025  2 000236   200021 234100                    SZN     JCL,,AUTO
         2 000237   000255 605000 2                  TPL     s:15030

      208    15026    2      CALL CONCAT (FMT_BUF, '%1/"', LINES_STR, '%1/');

  15026  2 000240   000010 236000 1                  LDQ     DISPLAY_STR+3
         2 000241   000000 756000 xsym               STQ     FMT_BUF
         2 000242   040000 100400                    MLR     fill='040'O
         2 000243   000001 000005 1                  ADSC9   LINES_STR                cn=0,n=5
         2 000244   000001 000005 xsym               ADSC9   FMT_BUF+1                cn=0,n=5
         2 000245   040000 100400                    MLR     fill='040'O
         2 000246   000010 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000247   000002 200366 xsym               ADSC9   FMT_BUF+2                cn=1,n=246

      209    15027    2      FDS.FMT_.BOUND = LENGTHC (LINES_STR) + 6;

  15027  2 000250   000000 236000 xsym               LDQ     FDS
         2 000251   177777 376007                    ANQ     65535,DL
         2 000252   000002 276000 3                  ORQ     2
         2 000253   000000 756000 xsym               STQ     FDS

      210    15028    2      END;  /*  Jcl  */

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:30   
  15028  2 000254   000273 710000 2                  TRA     s:15033

      211    15029    2   ELSE DO;

      212    15030    2      CALL CONCAT (FMT_BUF, '%1/', LINES_STR, '%1/');

  15030  2 000255   000010 236000 1                  LDQ     DISPLAY_STR+3
         2 000256   000003 376000 3                  ANQ     3
         2 000257   000040 276007                    ORQ     32,DL
         2 000260   000000 756000 xsym               STQ     FMT_BUF
         2 000261   040000 100400                    MLR     fill='040'O
         2 000262   000001 000005 1                  ADSC9   LINES_STR                cn=0,n=5
         2 000263   000000 600005 xsym               ADSC9   FMT_BUF                  cn=3,n=5
         2 000264   040000 100400                    MLR     fill='040'O
         2 000265   000010 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000266   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      213    15031    2      FDS.FMT_.BOUND = LENGTHC (LINES_STR) + 5;

  15031  2 000267   000000 236000 xsym               LDQ     FDS
         2 000270   177777 376007                    ANQ     65535,DL
         2 000271   000004 276000 3                  ORQ     4
         2 000272   000000 756000 xsym               STQ     FDS

      214    15032    2      END;  /*  Jcl  */

      215    15033    1   FDS.TABDFLT# = 10;

  15033  2 000273   000012 235007                    LDA     10,DL
         2 000274   000017 755000 xsym               STA     FDS+15

      216    15034    1   CALL X$FORMAT (FDS);

  15034  2 000275   000005 630400 3                  EPPR0   5
         2 000276   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000277   000000 701000 xent               TSX1    X$FORMAT
         2 000300   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:31   

      217    15035
      218    15036    2   IF ALL_LINES THEN DO;

  15036  2 000301   200003 234100                    SZN     ALL_LINES,,AUTO
         2 000302   000307 605000 2                  TPL     s:15039

      219    15037    2      USERS_KEY = '001040'O;     /* To precord to begin of :HLP */

  15037  2 000303   000000 100400                    MLR     fill='000'O
         2 000304   000006 000002 3                  ADSC9   6                        cn=0,n=2
         2 000305   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      220    15038    2      END;  /*  ALL_LINES  */

  15038  2 000306   000446 710000 2                  TRA     s:15112

      221    15039    2   ELSE IF WILD_CARD THEN DO;

  15039  2 000307   200025 234100                    SZN     WILD_CARD,,AUTO
         2 000310   000322 605000 2                  TPL     s:15044

      222    15040    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');

  15040  2 000311   040000 100500                    MLR     fill='040'O
         2 000312   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8
         2 000313   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000314   040000 100400                    MLR     fill='040'O
         2 000315   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 000316   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      223    15041    2         USERS_KEY.COUNT = 9 ;

  15041  2 000317   011000 236003                    LDQ     4608,DU
         2 000320   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      224    15042    2         END; /*  WILD_CARD  */
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:32   

  15042  2 000321   000446 710000 2                  TRA     s:15112

      225    15043    2      ELSE DO;  /*  Single line  */

      226    15044    2         CALL CONCAT (USERS_KEY.TXTC,LINE_NAME.TEXT,'*');

  15044  2 000322   040000 100500                    MLR     fill='040'O
         2 000323   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000324   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000325   040000 100400                    MLR     fill='040'O
         2 000326   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 000327   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      227    15045    2         USERS_KEY.COUNT = 9 ;

  15045  2 000330   011000 236003                    LDQ     4608,DU
         2 000331   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      228    15046    2         I = DSEG1SIZE;

  15046  2 000332   000000 235000 xsym               LDA     DSEG1SIZE
         2 000333   200017 755100                    STA     I,,AUTO

      229    15047    2         CALL ASB$READ_HLP (DSEG1$,I,1)

  15047  2 000334   000010 236000 3                  LDQ     8
         2 000335   200030 756100                    STQ     WILD_CARD+3,,AUTO
         2 000336   200017 630500                    EPPR0   I,,AUTO
         2 000337   200027 450500                    STP0    WILD_CARD+2,,AUTO
         2 000340   000011 236000 3                  LDQ     9
         2 000341   200026 756100                    STQ     WILD_CARD+1,,AUTO
         2 000342   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000343   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000344   000000 701000 xent               TSX1    ASB$READ_HLP
         2 000345   000425 702000 2                  TSX2    s:15083

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:33   
      230    15048    3         WHENRETURN DO;

      231    15049    4            IF LINE$DREC.ATYP ~= %KLAT_LINE# THEN DO;

  15049  2 000346   000000 470400 xsym               LDP0    DSEG1$
         2 000347   000000 236100                    LDQ     0,,PR0
         2 000350   777000 376003                    ANQ     -512,DU
         2 000351   005000 116003                    CMPQ    2560,DU
         2 000352   000363 600000 2                  TZE     s:15072

      232    15050                 /*E*  ERROR:    ASL-E$NOTLINE-C
      233    15051                       MESSAGE: %%U1 %is not a line.
      234    15052                       MESSAGE1: %%U1 %is a %U2.
      235    15053                 */
      236    15054    4               AS_FIELD1 = LINE_NAME;

  15054  2 000353   000000 100500                    MLR     fill='000'O
         2 000354   200022 000011                    ADSC9   LINE_NAME,,AUTO          cn=0,n=9
         2 000355   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      237    15055                    %SCREAM( ERR#=E$NOTLINE , LEVEL=ERROR, MID='L' );

  15067  2 000356   000012 630400 3                  EPPR0   10
         2 000357   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000360   000000 701000 xent               TSX1    ASH$ERROR
         2 000361   000000 011000                    NOP     0

      238    15070    4               RETURN ;

  15070  2 000362   000000 702200 xent               TSX2  ! X66_ARET

      239    15071    4               END ; /* Then do */
      240    15072    3            IF DISP THEN

  15072  2 000363   200012 234100                    SZN     DISP,,AUTO
         2 000364   000374 605000 2                  TPL     s:15077

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:34   
      241    15073    4            DO;

      242    15074    4               CALL ASL$DISP_ONE_LINE (JCL);

  15074  2 000365   200021 631500                    EPPR1   JCL,,AUTO
         2 000366   200026 451500                    STP1    WILD_CARD+1,,AUTO
         2 000367   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000370   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000371   000000 701000 xent               TSX1    ASL$DISP_ONE_LINE
         2 000372   000000 011000                    NOP     0

      243    15075    4               END; /*  If disp  */

  15075  2 000373   000424 710000 2                  TRA     s:15081

      244    15076    4            ELSE DO;

      245    15077    4               CALL CONCAT (FMT_BUF, SUBSTR(LINE_NAME.TEXT,0,LINE_NAME.COUNT), '%1/');

  15077  2 000374   200022 236100                    LDQ     LINE_NAME,,AUTO
         2 000375   000033 772000                    QRL     27
         2 000376   000000 620006                    EAX0    0,QL
         2 000377   040000 100540                    MLR     fill='040'O
         2 000400   200022 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=*X0
         2 000401   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255
         2 000402   000377 116007                    CMPQ    255,DL
         2 000403   000411 603000 2                  TRC     s:15078
         2 000404   777400 620006                    EAX0    -256,QL
         2 000405   777777 660003                    ERX0    -1,DU
         2 000406   040046 100400                    MLR     fill='040'O
         2 000407   000010 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000410   000000 000010 xsym               ADSC9   FMT_BUF,Q                cn=0,n=*X0

      246    15078    4               FDS.FMT_.BOUND = LINE_NAME.COUNT + 2;

  15078  2 000411   200022 236100                    LDQ     LINE_NAME,,AUTO
         2 000412   000033 772000                    QRL     27
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:35   
         2 000413   000002 036007                    ADLQ    2,DL
         2 000414   000020 736000                    QLS     16
         2 000415   000000 676000 xsym               ERQ     FDS
         2 000416   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000417   000000 656000 xsym               ERSQ    FDS

      247    15079    4               CALL X$FORMAT (FDS);

  15079  2 000420   000005 630400 3                  EPPR0   5
         2 000421   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000422   000000 701000 xent               TSX1    X$FORMAT
         2 000423   000000 011000                    NOP     0

      248    15080    4               END; /*  Else  disp  */

      249    15081    3            END;  /*  Whenreturn  */

  15081  2 000424   000445 710000 2                  TRA     s:15110

      250    15082    3         WHENALTRETURN DO;

      251    15083    3            IF MERR_CODE.CODE = %E$NOKEY

  15083  2 000425   000000 236000 xsym               LDQ     ERR_CODE
         2 000426   377770 376007                    ANQ     131064,DL
         2 000427   001020 116007                    CMPQ    528,DL
         2 000430   000441 601000 2                  TNZ     s:15107

      252    15084    4            THEN DO;

      253    15085        /*E* ERROR:   ASL-E$LINE_NO_EXIST2-C
      254    15086             MESSAGE: Line %U1 does not exist.
      255    15087             MESSAGE1: The specified LINE does not exist.
      256    15088        */
      257    15089    4               AS_FIELD1 = LINE_NAME;

  15089  2 000431   000000 100500                    MLR     fill='000'O
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:36   
         2 000432   200022 000011                    ADSC9   LINE_NAME,,AUTO          cn=0,n=9
         2 000433   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      258    15090                    %SCREAM( ERR#=E$LINE_NO_EXIST2, MID='L', LEVEL=ERROR );

  15102  2 000434   000013 630400 3                  EPPR0   11
         2 000435   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000436   000000 701000 xent               TSX1    ASH$ERROR
         2 000437   000000 011000                    NOP     0

      259    15105    4               END;  /*  Error = nokey  */

  15105  2 000440   000445 710000 2                  TRA     s:15110

      260    15106    4            ELSE DO;

      261    15107    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  15107  2 000441   000015 630400 3                  EPPR0   13
         2 000442   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000443   000000 701000 xent               TSX1    ASA$ERROR
         2 000444   000000 011000                    NOP     0

      262    15108    4               END;  /* Error ~= nokey */

      263    15109    3            END;  /*  Whenaltreturn  */

      264    15110    2         RETURN;

  15110  2 000445   000000 702200 xent               TSX2  ! X66_ARET

      265    15111    2         END; /*  Else  */
      266    15112    1   CALL ASB$PREC_HLP ;

  15112  2 000446   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000447   000000 701000 xent               TSX1    ASB$PREC_HLP
         2 000450   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:37   

      267    15113    2   DO FOREVER;

      268    15114
      269    15115    3      DO UNTIL LINE$DREC.ATYP = %KLAT_LINE# ;

      270    15116    3         I = DSEG1SIZE;

  15116  2 000451   000000 235000 xsym               LDA     DSEG1SIZE
         2 000452   200017 755100                    STA     I,,AUTO

      271    15117    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)

  15117  2 000453   000010 236000 3                  LDQ     8
         2 000454   200030 756100                    STQ     WILD_CARD+3,,AUTO
         2 000455   200017 630500                    EPPR0   I,,AUTO
         2 000456   200027 450500                    STP0    WILD_CARD+2,,AUTO
         2 000457   000011 236000 3                  LDQ     9
         2 000460   200026 756100                    STQ     WILD_CARD+1,,AUTO
         2 000461   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000462   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000463   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         2 000464   000466 702000 2                  TSX2    s:15119
         2 000465   000477 710000 2                  TRA     s:15122

      272    15118    4         WHENALTRETURN DO;

      273    15119    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);

  15119  2 000466   000000 236000 xsym               LDQ     ERR_CODE
         2 000467   377770 376007                    ANQ     131064,DL
         2 000470   000060 116007                    CMPQ    48,DL
         2 000471   000476 600000 2                  TZE     s:15120

  15119  2 000472   000017 630400 3                  EPPR0   15
         2 000473   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000474   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:38   
         2 000475   000000 011000                    NOP     0

      274    15120    4            GOTO FINISH_UP;

  15120  2 000476   000631 710000 2                  TRA     FINISH_UP

      275    15121    4            END;  /*  Whenaltreturn  */
      276    15122    3         END;  /*  Do until we find a line record  */

  15122  2 000477   000000 470400 xsym               LDP0    DSEG1$
         2 000500   000000 236100                    LDQ     0,,PR0
         2 000501   777000 376003                    ANQ     -512,DU
         2 000502   005000 116003                    CMPQ    2560,DU
         2 000503   000451 601000 2                  TNZ     s:15116

      277    15123    3      CALL INDEX (I,' ',USERS_KEY.TXTC) WHENALTRETURN DO;

  15123  2 000504   000000 124400                    SCM     mask='000'O
         2 000505   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         2 000506   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000507   200017 000100                    ARG     I,,AUTO
         2 000510   000512 606400 2                  TTN     s:15124
         2 000511   000514 710000 2                  TRA     s:15126

      278    15124    3         I = 8;

  15124  2 000512   000010 235007                    LDA     8,DL
         2 000513   200017 755100                    STA     I,,AUTO

      279    15125    3         END;  /*  Whenaltreturn  */

      280    15126    2      IF I > 8 THEN I = 8;

  15126  2 000514   200017 235100                    LDA     I,,AUTO
         2 000515   000011 115007                    CMPA    9,DL
         2 000516   000521 602000 2                  TNC     s:15127

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:39   
  15126  2 000517   000010 236007                    LDQ     8,DL
         2 000520   200017 756100                    STQ     I,,AUTO

      281    15127    2      CURRENT_LINE = SUBSTR(USERS_KEY.TXTC,0,I);

  15127  2 000521   200017 720100                    LXL0    I,,AUTO
         2 000522   040100 100440                    MLR     fill='040'O
         2 000523   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         2 000524   200010 000010                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=8

      282    15128    3      IF WILD_CARD THEN DO;

  15128  2 000525   200025 234100                    SZN     WILD_CARD,,AUTO
         2 000526   000556 605000 2                  TPL     s:15138

      283    15129    3         J = LINE_NAME.COUNT;

  15129  2 000527   200022 236100                    LDQ     LINE_NAME,,AUTO
         2 000530   000033 772000                    QRL     27
         2 000531   200020 756100                    STQ     J,,AUTO

      284    15130    3         CALL ASB$WILD_MATCH (I, CURRENT_LINE, J, LINE_NAME.TEXT)

  15130  2 000532   200032 452500                    STP2    WILD_CARD+5,,AUTO
         2 000533   200032 236100                    LDQ     WILD_CARD+5,,AUTO
         2 000534   000020 036000 3                  ADLQ    16
         2 000535   200031 756100                    STQ     WILD_CARD+4,,AUTO
         2 000536   200020 630500                    EPPR0   J,,AUTO
         2 000537   200030 450500                    STP0    WILD_CARD+3,,AUTO
         2 000540   200010 631500                    EPPR1   CURRENT_LINE,,AUTO
         2 000541   200027 451500                    STP1    WILD_CARD+2,,AUTO
         2 000542   200017 633500                    EPPR3   I,,AUTO
         2 000543   200026 453500                    STP3    WILD_CARD+1,,AUTO
         2 000544   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000545   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000546   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000547   000551 702000 2                  TSX2    s:15132
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:40   
         2 000550   000556 710000 2                  TRA     s:15138

      285    15131    4         WHENALTRETURN DO;

      286    15132    4            IF CURRENT_LINE > END_KEY.TEXT THEN

  15132  2 000551   040100 106500                    CMPC    fill='040'O
         2 000552   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000553   200010 000010                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=8
         2 000554   000631 602000 2                  TNC     FINISH_UP

      287    15133    4               GOTO FINISH_UP;
      288    15134    4            ELSE
      289    15135    4               GOTO END_FOREVER;

  15135  2 000555   000630 710000 2                  TRA     END_FOREVER

      290    15136    4            END;  /*  Whenaltreturn  */
      291    15137    3         END; /*  WILD_CARD  */

      292    15138    2      IF DISP THEN

  15138  2 000556   200012 234100                    SZN     DISP,,AUTO
         2 000557   000567 605000 2                  TPL     s:15143

      293    15139    3      DO;

      294    15140    3         CALL ASL$DISP_ONE_LINE (JCL);

  15140  2 000560   200021 630500                    EPPR0   JCL,,AUTO
         2 000561   200026 450500                    STP0    WILD_CARD+1,,AUTO
         2 000562   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000563   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000564   000000 701000 xent               TSX1    ASL$DISP_ONE_LINE
         2 000565   000000 011000                    NOP     0

      295    15141    3         END; /*  If disp  */
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:41   

  15141  2 000566   000627 710000 2                  TRA     s:15153

      296    15142    3      ELSE DO;

      297    15143    4         IF DISP_LINES = 0 THEN DO;

  15143  2 000567   200013 235100                    LDA     DISP_LINES,,AUTO
         2 000570   000606 601000 2                  TNZ     s:15148

      298    15144    4            CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_LINE,0,I));

  15144  2 000571   000013 220000 1                  LDX0    DISPLAY_STR+6
         2 000572   000000 740000 xsym               STX0    FMT_BUF
         2 000573   200017 721100                    LXL1    I,,AUTO
         2 000574   040000 100540                    MLR     fill='040'O
         2 000575   200010 000011                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=*X1
         2 000576   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      299    15145    4            FDS.FMT_.BOUND = I+1 ;

  15145  2 000577   200017 236100                    LDQ     I,,AUTO
         2 000600   000001 036007                    ADLQ    1,DL
         2 000601   000020 736000                    QLS     16
         2 000602   000000 676000 xsym               ERQ     FDS
         2 000603   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000604   000000 656000 xsym               ERSQ    FDS

      300    15146    4            END; /*  DISP_LINES = 0  */

  15146  2 000605   000623 710000 2                  TRA     s:15151

      301    15147    4         ELSE DO;

      302    15148    4            CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_LINE,0,I));

  15148  2 000606   000014 237000 1                  LDAQ    DISPLAY_STR+7
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:42   
         2 000607   000000 755000 xsym               STA     FMT_BUF
         2 000610   000001 756000 xsym               STQ     FMT_BUF+1
         2 000611   200017 720100                    LXL0    I,,AUTO
         2 000612   040000 100540                    MLR     fill='040'O
         2 000613   200010 000010                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=*X0
         2 000614   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      303    15149    4            FDS.FMT_.BOUND = I + 7;

  15149  2 000615   200017 236100                    LDQ     I,,AUTO
         2 000616   000007 036007                    ADLQ    7,DL
         2 000617   000020 736000                    QLS     16
         2 000620   000000 676000 xsym               ERQ     FDS
         2 000621   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000622   000000 656000 xsym               ERSQ    FDS

      304    15150    4            END; /*  Else  */

      305    15151    3         CALL X$FORMAT (FDS);

  15151  2 000623   000005 630400 3                  EPPR0   5
         2 000624   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000625   000000 701000 xent               TSX1    X$FORMAT
         2 000626   000000 011000                    NOP     0

      306    15152    3         END; /*  Else  disp  */

      307    15153    2      DISP_LINES = DISP_LINES + 1;

  15153  2 000627   200013 054100                    AOS     DISP_LINES,,AUTO

      308    15154    2   END_FOREVER:
      309    15155    2      END;  /*  Do forever  */

  15155  2 000630   000451 710000 2     END_FOREVER  TRA     s:15116

      310    15156    1   FINISH_UP:
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:43   
      311    15157    2   IF NOT DISP THEN DO;

  15157  2 000631   200012 234100       FINISH_UP    SZN     DISP,,AUTO
         2 000632   000647 604000 2                  TMI     s:15163

      312    15158    2      FMT_BUF = '%\%/';

  15158  2 000633   040000 100400                    MLR     fill='040'O
         2 000634   000016 000004 1                  ADSC9   DISPLAY_STR+9            cn=0,n=4
         2 000635   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      313    15159    2      FDS.FMT_.BOUND = 3;

  15159  2 000636   000000 236000 xsym               LDQ     FDS
         2 000637   177777 376007                    ANQ     65535,DL
         2 000640   600000 276007                    ORQ     -65536,DL
         2 000641   000000 756000 xsym               STQ     FDS

      314    15160    2      FDS.NVECS# = 0;

  15160  2 000642   000011 450000 xsym               STZ     FDS+9

      315    15161    2      CALL X$FORMAT(FDS);

  15161  2 000643   000005 630400 3                  EPPR0   5
         2 000644   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000645   000000 701000 xent               TSX1    X$FORMAT
         2 000646   000000 011000                    NOP     0

      316    15162    2      END; /*  If not disp  */

      317    15163    2   IF NOT JCL THEN DO;

  15163  2 000647   200021 234100                    SZN     JCL,,AUTO
         2 000650   000717 604000 2                  TMI     s:15184

      318    15164    2      FMT_VEC(0) = VECTOR (DISP_LINES);
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:44   

  15164  2 000651   777640 235007                    LDA     -96,DL
         2 000652   200026 452500                    STP2    WILD_CARD+1,,AUTO
         2 000653   200026 236100                    LDQ     WILD_CARD+1,,AUTO
         2 000654   000013 036003                    ADLQ    11,DU
         2 000655   000000 755000 xsym               STA     FMT_VEC
         2 000656   000001 756000 xsym               STQ     FMT_VEC+1

      319    15165    2      IF DISP_LINES = 1 THEN

  15165  2 000657   200013 235100                    LDA     DISP_LINES,,AUTO
         2 000660   000001 115007                    CMPA    1,DL
         2 000661   000666 601000 2                  TNZ     s:15170

      320    15166    3      DO;

      321    15167    3         FMT_VEC(1) = VECTOR (LINE_STR);

  15167  2 000662   000022 237000 3                  LDAQ    18
         2 000663   000002 755000 xsym               STA     FMT_VEC+2
         2 000664   000003 756000 xsym               STQ     FMT_VEC+3

      322    15168    3         END; /*  DISP_LINES = 1  */

  15168  2 000665   000671 710000 2                  TRA     s:15172

      323    15169    3      ELSE DO;

      324    15170    3         FMT_VEC(1) = VECTOR (LINES_STR);

  15170  2 000666   000024 237000 3                  LDAQ    20
         2 000667   000002 755000 xsym               STA     FMT_VEC+2
         2 000670   000003 756000 xsym               STQ     FMT_VEC+3

      325    15171    3         END; /*  DISP_LINES ~= 1  */

      326    15172    2      IF DISP THEN
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:45   

  15172  2 000671   200012 234100                    SZN     DISP,,AUTO
         2 000672   000677 605000 2                  TPL     s:15177

      327    15173    3      DO;

      328    15174    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15174  2 000673   000026 237000 3                  LDAQ    22
         2 000674   000004 755000 xsym               STA     FMT_VEC+4
         2 000675   000005 756000 xsym               STQ     FMT_VEC+5

      329    15175    3         END; /*  If disp  */

  15175  2 000676   000702 710000 2                  TRA     s:15179

      330    15176    3      ELSE DO;

      331    15177    3         FMT_VEC(2) = VECTOR (LIST_STR);

  15177  2 000677   000030 237000 3                  LDAQ    24
         2 000700   000004 755000 xsym               STA     FMT_VEC+4
         2 000701   000005 756000 xsym               STQ     FMT_VEC+5

      332    15178    3         END; /*  If ~ disp  */

      333    15179    2      FDS.NVECS# = 3;

  15179  2 000702   000003 235007                    LDA     3,DL
         2 000703   000011 755000 xsym               STA     FDS+9

      334    15180    2      FMT_BUF = '   %5D %A %A.';

  15180  2 000704   040000 100400                    MLR     fill='040'O
         2 000705   000017 000015 1                  ADSC9   DISPLAY_STR+10           cn=0,n=13
         2 000706   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:46   
      335    15181    2      FDS.FMT_.BOUND = 12;

  15181  2 000707   000000 236000 xsym               LDQ     FDS
         2 000710   177777 376007                    ANQ     65535,DL
         2 000711   000003 276003                    ORQ     3,DU
         2 000712   000000 756000 xsym               STQ     FDS

      336    15182    2      CALL X$FORMAT(FDS);

  15182  2 000713   000005 630400 3                  EPPR0   5
         2 000714   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000715   000000 701000 xent               TSX1    X$FORMAT
         2 000716   000000 011000                    NOP     0

      337    15183    2      END; /* Not jcl */

      338    15184    1   RETURN;

  15184  2 000717   000000 702200 xent               TSX2  ! X66_ARET
      339    15185    1   END ASL$LIST_ALL_LINES;
      340    15186        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:47   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_LINES.
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:48   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_LINES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/c CHAR(9)     r     1 DISPLAY_STR                1-0-0/c CHAR(5)     r     1 LINES_STR
     0-0-0/c CHAR(4)     r     1 LINE_STR                   3-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_LINES                  4-0-0/w STRC(108)   r     1 BEGIN_KEY
     7-0-0/w UBIN        r     1 CODE2                     10-0-0/c CHAR(8)     r     1 CURRENT_LINE
    12-0-0/b BIT         r     1 DISP                      13-0-0/w SBIN        r     1 DISP_LINES
    14-0-0/w STRC(108)   r     1 END_KEY                   17-0-0/w UBIN        r     1 I
    20-0-0/w UBIN        r     1 J                         21-0-0/b BIT         r     1 JCL
    22-0-0/c STRC(81)    r     1 LINE_NAME                 25-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:49   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 LINE$DREC                  0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_LINES requires 464 words for executable code.
   Procedure ASL$LIST_ALL_LINES requires 28 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:50   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:51   
          MINI XREF LISTING

ALL_LINES
     14916**DCL     15005<<ASSIGN  15007<<ASSIGN  15009<<ASSIGN  15036>>IF
ASA$ERROR
     14702**DCL-ENT 15107--CALL
ASA_BRKS_LOC
     11834**DCL     11834--REDEF
ASB$PREC_HLP
     14690**DCL-ENT 15112--CALL
ASB$READ_HLP
     14693**DCL-ENT 15047--CALL
ASB$READ_HLP_SEQ
     14696**DCL-ENT 15117--CALL
ASB$WILD_MATCH
     14708**DCL-ENT 15130--CALL
ASH$ERROR
     14699**DCL-ENT 15067--CALL    15102--CALL    15119--CALL
ASL$DISP_ONE_LINE
     14705**DCL-ENT 15074--CALL    15140--CALL
AS_DEFAULT.BANNER_PERM
     12527**DCL     12528--REDEF
AS_DEFAULT.BUDGET.MACCT
     12432**DCL     12436--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12445**DCL     12448--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12428**DCL     12430--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12423**DCL     12425--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12543**DCL     12544--REDEF   12545--REDEF
AS_DEFAULT_DREC.PASSWORD
     13797**DCL     13801--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:52   
AS_DEFAULT_DREC.RENAME
     13820**DCL     13821--REDEF
AS_DFLT.BANNER_PERM
     12349**DCL     12350--REDEF
AS_DFLT.BUDGET.MACCT
     12254**DCL     12258--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12267**DCL     12270--REDEF
AS_DFLT.BUDGET.PACCUM
     12250**DCL     12252--REDEF
AS_DFLT.BUDGET.PMAXC
     12245**DCL     12247--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12365**DCL     12366--REDEF   12367--REDEF
AS_FE_MODE
     11700**DCL     11701--REDEF
AS_FIELD1
     11830**DCL     15054<<ASSIGN  15089<<ASSIGN
AS_MODE
     11697**DCL     11699--REDEF
AS_MOD_USER.ACCESS
     14562**DCL     14563--REDEF
AS_MOD_USER.BANNER
     14549**DCL     14550--REDEF
AS_MOD_USER.BANNER_PERM
     14551**DCL     14552--REDEF
AS_MOD_USER.BILL
     14557**DCL     14558--REDEF
AS_MOD_USER.CPROC
     14553**DCL     14554--REDEF
AS_MOD_USER.FEBILL
     14633**DCL     14634--REDEF
AS_MOD_USER.FECXTMEM
     14650**DCL     14651--REDEF
AS_MOD_USER.FEMINTS
     14635**DCL     14636--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:53   
AS_MOD_USER.FEMMEM
     14646**DCL     14647--REDEF
AS_MOD_USER.FEMTIME
     14644**DCL     14645--REDEF
AS_MOD_USER.FEPPRIV
     14641**DCL     14643--REDEF
AS_MOD_USER.FEPRIV
     14638**DCL     14640--REDEF
AS_MOD_USER.FORCE_BIT
     14547**DCL     14548--REDEF
AS_MOD_USER.KEY
     14629**DCL     14631--REDEF
AS_MOD_USER.LASTCPROC
     14555**DCL     14556--REDEF
AS_MOD_USER.LIMITS.DO_
     14603**DCL     14604--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14619**DCL     14620--REDEF
AS_MOD_USER.LIMITS.LO
     14599**DCL     14600--REDEF
AS_MOD_USER.LIMITS.MEM
     14595**DCL     14596--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14623**DCL     14624--REDEF
AS_MOD_USER.LIMITS.PDIS
     14611**DCL     14612--REDEF
AS_MOD_USER.LIMITS.PO
     14607**DCL     14608--REDEF
AS_MOD_USER.LIMITS.TDIS
     14615**DCL     14616--REDEF
AS_MOD_USER.LIMITS.TIME
     14591**DCL     14592--REDEF
AS_MOD_USER.MAXENQ
     14572**DCL     14573--REDEF
AS_MOD_USER.PERM_BIT
     14545**DCL     14546--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:54   
AS_MOD_USER.PPRIV
     14567**DCL     14569--REDEF
AS_MOD_USER.PRIOB
     14574**DCL     14575--REDEF
AS_MOD_USER.PRIV
     14564**DCL     14566--REDEF
AS_MOD_USER.QUAN
     14570**DCL     14571--REDEF
AS_MOD_USER.SETUP
     14543**DCL     14544--REDEF
AS_PROJECT.BANNER_PERM
     12883**DCL     12884--REDEF
AS_PROJECT.BUDGET.MACCT
     12788**DCL     12792--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12801**DCL     12804--REDEF
AS_PROJECT.BUDGET.PACCUM
     12784**DCL     12786--REDEF
AS_PROJECT.BUDGET.PMAXC
     12779**DCL     12781--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12899**DCL     12900--REDEF   12901--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13061**DCL     13062--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12966**DCL     12970--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12979**DCL     12982--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12962**DCL     12964--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12957**DCL     12959--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13077**DCL     13078--REDEF   13079--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14283**DCL     14287--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:55   
AS_PROJECT_DFLT_DREC.RENAME
     14306**DCL     14307--REDEF
AS_PROJECT_DREC.PASSWORD
     14121**DCL     14125--REDEF
AS_PROJECT_DREC.RENAME
     14144**DCL     14145--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12705**DCL     12706--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12610**DCL     12614--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12623**DCL     12626--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12606**DCL     12608--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12601**DCL     12603--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12721**DCL     12722--REDEF   12723--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13959**DCL     13963--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13982**DCL     13983--REDEF
AS_USERS.BANNER_PERM
     12171**DCL     12172--REDEF
AS_USERS.BUDGET.MACCT
     12076**DCL     12080--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12089**DCL     12092--REDEF
AS_USERS.BUDGET.PACCUM
     12072**DCL     12074--REDEF
AS_USERS.BUDGET.PMAXC
     12067**DCL     12069--REDEF
AS_USERS.SETUP_CHRA.TXT
     12187**DCL     12188--REDEF   12189--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13239**DCL     13240--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:56   
AS_USERS_CONSTANT.BUDGET.MACCT
     13144**DCL     13148--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13157**DCL     13160--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13140**DCL     13142--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13135**DCL     13137--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13255**DCL     13256--REDEF   13257--REDEF
BEGIN_KEY.COUNT
     14918**DCL     15014<<ASSIGN
BEGIN_KEY.TEXT
     14919**DCL     15010<<ASSIGN  15013<<ASSIGN  15040>>CALLBLT
CODE
     11827**DCL     14946<<ASSIGN  14953>>DOSELCT
CODE2
     14920**DCL     14985<<ASSIGN  14987>>DOSELCT
CURRENT_LINE
     14921**DCL     15127<<ASSIGN  15130<>CALL    15132>>IF      15144>>CALLBLT 15148>>CALLBLT
DISP
     14922**DCL     14957<<ASSIGN  14962<<ASSIGN  14974<<ASSIGN  14983<<ASSIGN  15072>>IF      15138>>IF
     15157>>IF      15172>>IF
DISPLAY_STR
     14941**DCL     15174--ASSIGN
DISP_LINES
     14923**DCL     14951<<ASSIGN  15143>>IF      15153<<ASSIGN  15153>>ASSIGN  15164--ASSIGN  15165>>IF
DSEG1$
     11835**DCL     14813--IMP-PTR 15047<>CALL    15049>>IF      15115>>DOUNTIL 15117<>CALL
DSEG1SIZE
     11836**DCL     15046>>ASSIGN  15116>>ASSIGN
END_FOREVER
     15155**LABEL   15135--GOTO
END_KEY.COUNT
     14925**DCL     15016<<ASSIGN
END_KEY.TEXT
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:57   
     14926**DCL     15011<<ASSIGN  15015<<CALLBLT 15132>>IF
ERR_CODE
     11829**DCL     11830--REDEF
FDS
     11726**DCL     15034<>CALL    15079<>CALL    15151<>CALL    15161<>CALL    15182<>CALL
FDS.FMT_.BOUND
     11731**DCL     15027<<ASSIGN  15031<<ASSIGN  15078<<ASSIGN  15145<<ASSIGN  15149<<ASSIGN  15159<<ASSIGN
     15181<<ASSIGN
FDS.NVECS#
     11754**DCL     15024<<ASSIGN  15160<<ASSIGN  15179<<ASSIGN
FDS.TABDFLT#
     11792**DCL     15033<<ASSIGN
FINISH_UP
     15157**LABEL   15120--GOTO    15133--GOTO
FMT_BUF
     11825**DCL     15026<<CALLBLT 15030<<CALLBLT 15077<<CALLBLT 15144<<CALLBLT 15148<<CALLBLT 15158<<ASSIGN
     15180<<ASSIGN
FMT_VEC
     11825**DCL     15164<<ASSIGN  15167<<ASSIGN  15170<<ASSIGN  15174<<ASSIGN  15177<<ASSIGN
I
     14927**DCL     14984<<DOINDEX 14985>>ASSIGN  15012<<CALLBLT 15013>>ASSIGN  15015>>CALLBLT 15016>>ASSIGN
     15046<<ASSIGN  15047<>CALL    15116<<ASSIGN  15117<>CALL    15123<<CALLBLT 15124<<ASSIGN  15126>>IF
     15126<<ASSIGN  15127>>ASSIGN  15130<>CALL    15144>>CALLBLT 15145>>ASSIGN  15148>>CALLBLT 15149>>ASSIGN
J
     14928**DCL     15129<<ASSIGN  15130<>CALL
JCL
     14929**DCL     14947<<ASSIGN  14958<<ASSIGN  14965<<ASSIGN  14968<<ASSIGN  14975<<ASSIGN  14996<<ASSIGN
     15025>>IF      15074<>CALL    15140<>CALL    15163>>IF
KL_DEFAULT.PASSWORD
     14445**DCL     14449--REDEF
KL_DEFAULT.RENAME
     14468**DCL     14469--REDEF
KL_DFLT.PASSWORD
     13635**DCL     13639--REDEF
KL_DFLT.RENAME
     13658**DCL     13659--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:58   
KL_DREC.PASSWORD
     13473**DCL     13477--REDEF
KL_DREC.RENAME
     13496**DCL     13497--REDEF
KL_DREC_CNT.PASSWORD
     13360**DCL     13364--REDEF
KL_DREC_CNT.RENAME
     13383**DCL     13384--REDEF
LINE$DREC.ATYP
     14818**DCL     15049>>IF      15115>>DOUNTIL
LINE$DREC.PASSWORD
     14871**DCL     14875--REDEF
LINE$DREC.RENAME
     14894**DCL     14895--REDEF
LINES_STR
     14939**DCL     15026>>CALLBLT 15027--ASSIGN  15030>>CALLBLT 15031--ASSIGN  15170--ASSIGN
LINE_NAME
     14930**DCL     15054>>ASSIGN  15089>>ASSIGN
LINE_NAME.COUNT
     14931**DCL     14950<<ASSIGN  14978<<ASSIGN  14992<<ASSIGN  15004>>IF      15077>>CALLBLT 15078>>ASSIGN
     15129>>ASSIGN
LINE_NAME.TEXT
     14932**DCL     14949<<ASSIGN  14977<<ASSIGN  14991<<ASSIGN  15006>>IF      15012>>CALLBLT 15013>>ASSIGN
     15015>>CALLBLT 15044>>CALLBLT 15077>>CALLBLT 15130<>CALL
LINE_STR
     14938**DCL     15167--ASSIGN
LIST_STR
     14940**DCL     15177--ASSIGN
MERR_CODE
     11830**DCL     15119<>CALL
MERR_CODE.CODE
     11830**DCL     15083>>IF      15119>>IF
NODE$
     11827**DCL     14721--IMP-PTR
P$B.CODE
     14729**DCL     14946>>ASSIGN  14964>>IF      14967>>IF      14985>>ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_LINES File=ASL$LIST_LINES.:E05TSI                TUE 07/29/97 10:11 Page:59   
P$B.NSUBLKS
     14733**DCL     14963>>IF      14966>>IF      14976>>IF      14984>>DOINDEX
P$B.SUBLK$
     14754**DCL     14946>>ASSIGN  14963>>IF      14964>>IF      14964>>IF      14966>>IF      14967>>IF
     14967>>IF      14977>>ASSIGN  14977>>ASSIGN  14978>>ASSIGN  14985>>ASSIGN  14991>>ASSIGN  14991>>ASSIGN
     14992>>ASSIGN
P$S.COUNT
     14790**DCL     14793--IMP-SIZ 14977>>ASSIGN  14978>>ASSIGN  14991>>ASSIGN  14992>>ASSIGN
P$S.TEXT
     14793**DCL     14977>>ASSIGN  14991>>ASSIGN
PROJ_KEY.TEXT
     11707**DCL     11707--REDEF
PROJ_KEY.TXT.PROJECT
     11707**DCL     11707--REDEF
P_PCB.OUT$
     11875**DCL     14946>>ASSIGN  14963>>IF      14964>>IF      14966>>IF      14967>>IF      14976>>IF
     14977>>ASSIGN  14977>>ASSIGN  14978>>ASSIGN  14984>>DOINDEX 14985>>ASSIGN  14991>>ASSIGN  14991>>ASSIGN
     14992>>ASSIGN
REMEM_VAR
     11833**DCL     11833--REDEF
REM_FCMD
     11833**DCL     11834--REDEF
USERS_KEY
     11704**DCL     15037<<ASSIGN  15107<>CALL
USERS_KEY.COUNT
     11704**DCL     15041<<ASSIGN  15045<<ASSIGN
USERS_KEY.TEXT
     11704**DCL     11705--REDEF   11705--REDEF   11705--REDEF   11706--REDEF
USERS_KEY.TXTC
     11705**DCL     15040<<CALLBLT 15044<<CALLBLT 15123>>CALLBLT 15127>>ASSIGN
WILD_CARD
     14933**DCL     14948<<ASSIGN  15017<<ASSIGN  15020<<ASSIGN  15039>>IF      15128>>IF
X$FORMAT
     14710**DCL-ENT 15034--CALL    15079--CALL    15151--CALL    15161--CALL    15182--CALL

PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:60   
      341        1        /*T***********************************************************/
      342        2        /*T*                                                         */
      343        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      344        4        /*T*                                                         */
      345        5        /*T***********************************************************/
      346        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:61   
      347        7        /*M* ASL$DISP_ONE_LINE: External routine to display lines.    */
      348        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      349        9              ECU=3,CSU=3,SDI=3                                           */
      350       10        ASL$DISP_ONE_LINE: PROC (JCL);
      351       11        /**********************************************************/
      352       12
      353       13        /*D* NAME:     ASL$DISP_ONE_LINE
      354       14             CALL:     CALL ASL$DISP_ONE_LINE (JCL)
      355       15             INPUT:    JCL - bit set for JCL type display.
      356       16             OUTPUT:   Nothing is returned.
      357       17             DESCRIPTION:  ASL$DISP_ONE_LINE is the routine to handle
      358       18                           the DISP LINE option for SUPER.  ASL$DISP_ONE_LINE
      359       19                           displays the line that is in data segment 1.
      360       20        */
      361       21        /********************************************************************/
      362       22        /*   Include files   include files   include files   include files  */
      363       23        /********************************************************************/
      364       24        %INCLUDE AS_PERR_C;
      365      626        %INCLUDE AS_SUPER_C;
      366     1061        %INCLUDE AS_SUBS_C;
      367     2475        %INCLUDE AS_MAC_C;
      368     2555        %INCLUDE AS_ENTRIES_M;
      369     3605        %INCLUDE AS_SSUBS_C;
      370     3697        %INCLUDE B_ERRORS_C;
      371     4824        %INCLUDE CP_6_SUBS;
      372     5364        %INCLUDE KL_SUPER_C;
      373     8266        %INCLUDE XU_MACRO_C;
      374    11372        %INCLUDE XU_FORMAT_C;
      375    11534        %INCLUDE OCI_SUBS_C;
      376    11632        %INCLUDE AS_SUPER_R;
      377    14648        /********************************************************************/
      378    14649        /*   Parameters      parameters      parameters      parameters     */
      379    14650        /********************************************************************/
      380    14651    1   DCL JCL BIT(1);
      381    14652        /********************************************************************/
      382    14653        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      383    14654        /********************************************************************/
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:62   
      384    14655        %ASB$WRITE_LO ;
      385    14658        %ASL$FIND_CONTROLLER ;
      386    14661        %ASL$FIND_LINE_DEVICE ;
      387    14664        %ASL$DISP_ONE_CONTROLLER ;
      388    14667        %ASL$DISP_ONE_LINE_DEVICE ;
      389    14670    1   DCL X$FORMAT ENTRY(1) ;
      390    14671        /********************************************************************/
      391    14672        /*   Local based     local based     local based     local based    */
      392    14673        /********************************************************************/
      393    14674        %KL_DREC         ( NAME      = LINE$DREC,
      394    14675                           STCLASS   = "BASED(DSEG1$)",
      395    14676                           LAST      = ",");
      396    14789        %KL_LN3270       ( NAME      = LN,
      397    14790                           LVL       = 2,
      398    14791                           STCLASS   = BASED);
      399    14933        %KL_CONTROLLER   ( NAME      = KL$CONTROLLER,
      400    14934                           LVL       = 1,
      401    14935                           STCLASS   = "BASED (CONT$)" );
      402    15084    1   DCL 1 TEXT$C BASED ALIGNED,
      403    15085    1          2 CNT                  UBIN(9) UNAL ,
      404    15086    1          2 TEXT                 CHAR(TEXT$C.CNT) UNAL;
      405    15087        /********************************************************************/
      406    15088        /*   Auto data       auto data       auto data       auto data      */
      407    15089        /********************************************************************/
      408    15090    1   DCL ARS                    UBIN;
      409    15091    1   DCL CONT$                  PTR;
      410    15092    1   DCL CONTROLLER_NUMBER      UBIN;
      411    15093    1   DCL DEV$                   PTR;
      412    15094    1   DCL DEV_ARS                UBIN;
      413    15095    1   DCL END$                   PTR;
      414    15096    1   DCL I                      UBIN;
      415    15097    1   DCL J                      UBIN;
      416    15098    1   DCL LINE_NAME              CHAR(8);
      417    15099    1   DCL NEW_CONTROLLER         BIT(1);
      418    15100        /********************************************************************/
      419    15101        /*   Constant data   constant data   constant data   constant data  */
      420    15102        /********************************************************************/
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:63   
      421    15103    1   DCL 1 CONT_NAME CONSTANT,
      422    15104    1          2 COUNT             UBIN BYTE UNAL INIT (1),
      423    15105    1          2 TEXT              CHAR(2) UNAL INIT ('? ');
      424    15106    1   DCL 1 DEV_NAME CONSTANT,
      425    15107    1          2 COUNT             UBIN BYTE UNAL INIT (1),
      426    15108    1          2 TEXT              CHAR(2) UNAL INIT ('? ');
      427    15109    1   DCL LINE_STR               CHAR(0) CONSTANT INIT('LINE');
      428    15110    1   DCL YES_STR                CHAR(0) CONSTANT INIT('YES');
      429    15111    1   DCL NO_STR                 CHAR(0) CONSTANT INIT('NO');
      430    15112    1   DCL LINE_HDR_FMT           CHAR(0) CONSTANT INIT
      431    15113    1                              ('%>A %>A  PRO=%>A  SLAVE=%>A');
      432    15114    1   DCL LINE_HDR_FMT_JCL       CHAR(0) CONSTANT INIT
      433    15115    1                              ('CREATE %>A %>A  %/PRO=%>A  ;SLAVE=%>A%/   END');
      434    15116        %KL_CONTROLLER ( NAME = KL_CONTROLLER, LVL = 1, STCLASS = CONSTANT );
      435    15265        %KL_LINEDEV    ( NAME = KL_LINEDEV, LVL = 1, STCLASS = CONSTANT );
      436    15414        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:64   
      437    15415        /********************************************************************/
      438    15416        /*   Procedure       procedure       procedure       procedure      */
      439    15417        /********************************************************************/
      440    15418                                                  /* List line info. */
      441    15419    1   LINE_NAME = SUBSTR(USERS_KEY.TXTC,0,8);
      442    15420    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );
      443    15421    1   FMT_VEC(0) = VECTOR( LINE_STR );
      444    15422    1   FMT_VEC(1) = VECTOR( LINE_NAME);
      445    15423    1   FMT_VEC(2) = VECTOR(ADDR(LINE$DREC.PNAME)->TEXT$C.TEXT);
      446    15424    1   IF LINE$DREC.LN.SLAVE# THEN
      447    15425    1      FMT_VEC (3) = VECTOR (YES_STR);
      448    15426    1   ELSE
      449    15427    1      FMT_VEC (3) = VECTOR (NO_STR);
      450    15428    2   IF JCL THEN DO;
      451    15429    2      FMT_BUF = LINE_HDR_FMT_JCL;
      452    15430    2      FDS.FMT_.BOUND = SIZEC (LINE_HDR_FMT_JCL);
      453    15431    2      END; /*  Jcl  */
      454    15432    2   ELSE DO;
      455    15433    2      FMT_BUF = LINE_HDR_FMT;
      456    15434    2      FDS.FMT_.BOUND = SIZEC (LINE_HDR_FMT);
      457    15435    2      END; /*  Not jcl  */
      458    15436    1   FDS.NVECS# = 4;
      459    15437    1   CALL X$FORMAT( FDS );
      460    15438    1   CONT$ = DSEG1$;
      461    15439    1   ARS = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;
      462    15440    2   DO FOREVER;
      463    15441    2      CALL ASL$FIND_CONTROLLER (DSEG1$, ARS, CONT_NAME, CONT$) ALTRET (END_FOREVER);
      464    15442    2      CALL ASB$WRITE_LO(' ',1);
      465    15443    2      CALL ASL$DISP_ONE_CONTROLLER (CONT$, JCL, LINE_NAME );
      466    15444    2      DEV_ARS = SIZEW (KL_CONTROLLER) + (KL$CONTROLLER.BLKHDR.NSUBS * SIZEW(KL_LINEDEV)
             15444               );
      467    15445    2      DEV$ = CONT$;
      468    15446    2      END$ = PINCRW (CONT$, DEV_ARS);
      469    15447    2      CONTROLLER_NUMBER = KL$CONTROLLER.CONT#;
      470    15448    2      NEW_CONTROLLER = %YES#;
      471    15449    3      DO WHILE DEV$ < END$ ;
      472    15450    3         CALL ASL$FIND_LINE_DEVICE (CONT$, DEV_ARS, DEV_NAME, DEV$) ALTRET (END_J);
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:65   
      473    15451    3         CALL ASL$DISP_ONE_LINE_DEVICE (DEV$, JCL, LINE_NAME, CONTROLLER_NUMBER,
             15451                  NEW_CONTROLLER);
      474    15452    3         NEW_CONTROLLER = %NO#;
      475    15453    3         END;  /* Do while DEV$ < END$  */
      476    15454    2   END_J:
      477    15455    2      END;  /*  Do forever  */
      478    15456    1   END_FOREVER:
      479    15457    1   RETURN ;
      480    15458    1   END ASL$DISP_ONE_LINE;

PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:66   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_LINE.

   Procedure ASL$DISP_ONE_LINE requires 149 words for executable code.
   Procedure ASL$DISP_ONE_LINE requires 22 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_LINES.:E05TSI    .

PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:67   

 Object Unit name= ASL$DISP_ONE_LINE                          File name= ASL$LIST_LINES.:E05TOU
 UTS= JUL 29 '97 10:13:56.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     32     40  ASL$DISP_ONE_LINE
    2   Proc  even  none   149    225  ASL$DISP_ONE_LINE
    3  RoData even  none    18     22  ASL$DISP_ONE_LINE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  ASL$DISP_ONE_LINE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
         yes           Std       5 ASL$DISP_ONE_LINE_DEVICE
         yes           Std       1 X$FORMAT
 yes     yes           Std       4 ASL$FIND_CONTROLLER
         yes           Std       3 ASL$DISP_ONE_CONTROLLER
 yes     yes           Std       4 ASL$FIND_LINE_DEVICE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:68   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             FDS
     FMT_BUF                               FMT_VEC                               ERR_CODE
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG1$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:69   


      341        1        /*T***********************************************************/
      342        2        /*T*                                                         */
      343        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      344        4        /*T*                                                         */
      345        5        /*T***********************************************************/
      346        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:70   
      347        7        /*M* ASL$DISP_ONE_LINE: External routine to display lines.    */
      348        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      349        9              ECU=3,CSU=3,SDI=3                                           */
      350       10        ASL$DISP_ONE_LINE: PROC (JCL);

     10  2 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_1
         2 000001   000026 000001                    ZERO    22,1

      351       11        /**********************************************************/
      352       12
      353       13        /*D* NAME:     ASL$DISP_ONE_LINE
      354       14             CALL:     CALL ASL$DISP_ONE_LINE (JCL)
      355       15             INPUT:    JCL - bit set for JCL type display.
      356       16             OUTPUT:   Nothing is returned.
      357       17             DESCRIPTION:  ASL$DISP_ONE_LINE is the routine to handle
      358       18                           the DISP LINE option for SUPER.  ASL$DISP_ONE_LINE
      359       19                           displays the line that is in data segment 1.
      360       20        */
      361       21        /********************************************************************/
      362       22        /*   Include files   include files   include files   include files  */
      363       23        /********************************************************************/
      364       24        %INCLUDE AS_PERR_C;
      365      626        %INCLUDE AS_SUPER_C;
      366     1061        %INCLUDE AS_SUBS_C;
      367     2475        %INCLUDE AS_MAC_C;
      368     2555        %INCLUDE AS_ENTRIES_M;
      369     3605        %INCLUDE AS_SSUBS_C;
      370     3697        %INCLUDE B_ERRORS_C;
      371     4824        %INCLUDE CP_6_SUBS;
      372     5364        %INCLUDE KL_SUPER_C;
      373     8266        %INCLUDE XU_MACRO_C;
      374    11372        %INCLUDE XU_FORMAT_C;
      375    11534        %INCLUDE OCI_SUBS_C;
      376    11632        %INCLUDE AS_SUPER_R;
      377    14648        /********************************************************************/
      378    14649        /*   Parameters      parameters      parameters      parameters     */
      379    14650        /********************************************************************/
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:71   
      380    14651    1   DCL JCL BIT(1);
      381    14652        /********************************************************************/
      382    14653        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      383    14654        /********************************************************************/
      384    14655        %ASB$WRITE_LO ;
      385    14658        %ASL$FIND_CONTROLLER ;
      386    14661        %ASL$FIND_LINE_DEVICE ;
      387    14664        %ASL$DISP_ONE_CONTROLLER ;
      388    14667        %ASL$DISP_ONE_LINE_DEVICE ;
      389    14670    1   DCL X$FORMAT ENTRY(1) ;
      390    14671        /********************************************************************/
      391    14672        /*   Local based     local based     local based     local based    */
      392    14673        /********************************************************************/
      393    14674        %KL_DREC         ( NAME      = LINE$DREC,
      394    14675                           STCLASS   = "BASED(DSEG1$)",
      395    14676                           LAST      = ",");
      396    14789        %KL_LN3270       ( NAME      = LN,
      397    14790                           LVL       = 2,
      398    14791                           STCLASS   = BASED);
      399    14933        %KL_CONTROLLER   ( NAME      = KL$CONTROLLER,
      400    14934                           LVL       = 1,
      401    14935                           STCLASS   = "BASED (CONT$)" );
      402    15084    1   DCL 1 TEXT$C BASED ALIGNED,
      403    15085    1          2 CNT                  UBIN(9) UNAL ,
      404    15086    1          2 TEXT                 CHAR(TEXT$C.CNT) UNAL;
      405    15087        /********************************************************************/
      406    15088        /*   Auto data       auto data       auto data       auto data      */
      407    15089        /********************************************************************/
      408    15090    1   DCL ARS                    UBIN;
      409    15091    1   DCL CONT$                  PTR;
      410    15092    1   DCL CONTROLLER_NUMBER      UBIN;
      411    15093    1   DCL DEV$                   PTR;
      412    15094    1   DCL DEV_ARS                UBIN;
      413    15095    1   DCL END$                   PTR;
      414    15096    1   DCL I                      UBIN;
      415    15097    1   DCL J                      UBIN;
      416    15098    1   DCL LINE_NAME              CHAR(8);
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:72   
      417    15099    1   DCL NEW_CONTROLLER         BIT(1);
      418    15100        /********************************************************************/
      419    15101        /*   Constant data   constant data   constant data   constant data  */
      420    15102        /********************************************************************/
      421    15103    1   DCL 1 CONT_NAME CONSTANT,
      422    15104    1          2 COUNT             UBIN BYTE UNAL INIT (1),
      423    15105    1          2 TEXT              CHAR(2) UNAL INIT ('? ');
      424    15106    1   DCL 1 DEV_NAME CONSTANT,
      425    15107    1          2 COUNT             UBIN BYTE UNAL INIT (1),
      426    15108    1          2 TEXT              CHAR(2) UNAL INIT ('? ');
      427    15109    1   DCL LINE_STR               CHAR(0) CONSTANT INIT('LINE');
      428    15110    1   DCL YES_STR                CHAR(0) CONSTANT INIT('YES');
      429    15111    1   DCL NO_STR                 CHAR(0) CONSTANT INIT('NO');
      430    15112    1   DCL LINE_HDR_FMT           CHAR(0) CONSTANT INIT
      431    15113    1                              ('%>A %>A  PRO=%>A  SLAVE=%>A');
      432    15114    1   DCL LINE_HDR_FMT_JCL       CHAR(0) CONSTANT INIT
      433    15115    1                              ('CREATE %>A %>A  %/PRO=%>A  ;SLAVE=%>A%/   END');
      434    15116        %KL_CONTROLLER ( NAME = KL_CONTROLLER, LVL = 1, STCLASS = CONSTANT );
      435    15265        %KL_LINEDEV    ( NAME = KL_LINEDEV, LVL = 1, STCLASS = CONSTANT );
      436    15414        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:73   
      437    15415        /********************************************************************/
      438    15416        /*   Procedure       procedure       procedure       procedure      */
      439    15417        /********************************************************************/
      440    15418                                                  /* List line info. */
      441    15419    1   LINE_NAME = SUBSTR(USERS_KEY.TXTC,0,8);

  15419  2 000002   040100 100400                    MLR     fill='040'O
         2 000003   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000004   200014 000010                    ADSC9   LINE_NAME,,AUTO          cn=0,n=8

      442    15420    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  15420  2 000005   000000 630400 3                  EPPR0   0
         2 000006   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000007   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000010   000000 011000                    NOP     0

      443    15421    1   FMT_VEC(0) = VECTOR( LINE_STR );

  15421  2 000011   000002 237000 3                  LDAQ    2
         2 000012   000000 755000 xsym               STA     FMT_VEC
         2 000013   000001 756000 xsym               STQ     FMT_VEC+1

      444    15422    1   FMT_VEC(1) = VECTOR( LINE_NAME);

  15422  2 000014   000004 235000 3                  LDA     4
         2 000015   200020 452500                    STP2    NEW_CONTROLLER+2,,AUTO
         2 000016   200020 236100                    LDQ     NEW_CONTROLLER+2,,AUTO
         2 000017   000014 036003                    ADLQ    12,DU
         2 000020   000002 755000 xsym               STA     FMT_VEC+2
         2 000021   000003 756000 xsym               STQ     FMT_VEC+3

      445    15423    1   FMT_VEC(2) = VECTOR(ADDR(LINE$DREC.PNAME)->TEXT$C.TEXT);

  15423  2 000022   000000 470400 xsym               LDP0    DSEG1$
         2 000023   000004 236100                    LDQ     4,,PR0
         2 000024   000033 772000                    QRL     27
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:74   
         2 000025   000064 737000                    LLS     52
         2 000026   000140 135007                    SBLA    96,DL
         2 000027   000000 236000 xsym               LDQ     DSEG1$
         2 000030   000005 036000 3                  ADLQ    5
         2 000031   000004 755000 xsym               STA     FMT_VEC+4
         2 000032   000005 756000 xsym               STQ     FMT_VEC+5

      446    15424    1   IF LINE$DREC.LN.SLAVE# THEN

  15424  2 000033   000022 236100                    LDQ     18,,PR0
         2 000034   300000 316003                    CANQ    98304,DU
         2 000035   000042 600000 2                  TZE     s:15427

      447    15425    1      FMT_VEC (3) = VECTOR (YES_STR);

  15425  2 000036   000006 237000 3                  LDAQ    6
         2 000037   000006 755000 xsym               STA     FMT_VEC+6
         2 000040   000007 756000 xsym               STQ     FMT_VEC+7
         2 000041   000045 710000 2                  TRA     s:15428

      448    15426    1   ELSE
      449    15427    1      FMT_VEC (3) = VECTOR (NO_STR);

  15427  2 000042   000010 237000 3                  LDAQ    8
         2 000043   000006 755000 xsym               STA     FMT_VEC+6
         2 000044   000007 756000 xsym               STQ     FMT_VEC+7

      450    15428    2   IF JCL THEN DO;

  15428  2 000045   200003 471500                    LDP1    @JCL,,AUTO
         2 000046   000000 066500                    CMPB    filb='0'B
         2 000047   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         2 000050   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000051   000062 600000 2                  TZE     s:15433

      451    15429    2      FMT_BUF = LINE_HDR_FMT_JCL;

PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:75   
  15429  2 000052   040000 100400                    MLR     fill='040'O
         2 000053   000014 000055 1                  ADSC9   LINE_HDR_FMT_JCL         cn=0,n=45
         2 000054   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      452    15430    2      FDS.FMT_.BOUND = SIZEC (LINE_HDR_FMT_JCL);

  15430  2 000055   000000 236000 xsym               LDQ     FDS
         2 000056   177777 376007                    ANQ     65535,DL
         2 000057   000012 276000 3                  ORQ     10
         2 000060   000000 756000 xsym               STQ     FDS

      453    15431    2      END; /*  Jcl  */

  15431  2 000061   000071 710000 2                  TRA     s:15436

      454    15432    2   ELSE DO;

      455    15433    2      FMT_BUF = LINE_HDR_FMT;

  15433  2 000062   040000 100400                    MLR     fill='040'O
         2 000063   000005 000033 1                  ADSC9   LINE_HDR_FMT             cn=0,n=27
         2 000064   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      456    15434    2      FDS.FMT_.BOUND = SIZEC (LINE_HDR_FMT);

  15434  2 000065   000000 236000 xsym               LDQ     FDS
         2 000066   177777 376007                    ANQ     65535,DL
         2 000067   000013 276000 3                  ORQ     11
         2 000070   000000 756000 xsym               STQ     FDS

      457    15435    2      END; /*  Not jcl  */

      458    15436    1   FDS.NVECS# = 4;

  15436  2 000071   000004 235007                    LDA     4,DL
         2 000072   000011 755000 xsym               STA     FDS+9

PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:76   
      459    15437    1   CALL X$FORMAT( FDS );

  15437  2 000073   000014 630400 3                  EPPR0   12
         2 000074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000075   000000 701000 xent               TSX1    X$FORMAT
         2 000076   000000 011000                    NOP     0

      460    15438    1   CONT$ = DSEG1$;

  15438  2 000077   000000 236000 xsym               LDQ     DSEG1$
         2 000100   200005 756100                    STQ     CONT$,,AUTO

      461    15439    1   ARS = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;

  15439  2 000101   000000 470400 xsym               LDP0    DSEG1$
         2 000102   000017 235100                    LDA     15,,PR0
         2 000103   000023 035007                    ADLA    19,DL
         2 000104   200004 755100                    STA     ARS,,AUTO

      462    15440    2   DO FOREVER;

      463    15441    2      CALL ASL$FIND_CONTROLLER (DSEG1$, ARS, CONT_NAME, CONT$) ALTRET (END_FOREVER);

  15441  2 000105   200005 630500                    EPPR0   CONT$,,AUTO
         2 000106   200023 450500                    STP0    NEW_CONTROLLER+5,,AUTO
         2 000107   000015 236000 3                  LDQ     13
         2 000110   200022 756100                    STQ     NEW_CONTROLLER+4,,AUTO
         2 000111   200004 631500                    EPPR1   ARS,,AUTO
         2 000112   200021 451500                    STP1    NEW_CONTROLLER+3,,AUTO
         2 000113   000016 236000 3                  LDQ     14
         2 000114   200020 756100                    STQ     NEW_CONTROLLER+2,,AUTO
         2 000115   200020 630500                    EPPR0   NEW_CONTROLLER+2,,AUTO
         2 000116   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000117   000000 701000 xent               TSX1    ASL$FIND_CONTROLLER
         2 000120   000224 702000 2                  TSX2    END_FOREVER

      464    15442    2      CALL ASB$WRITE_LO(' ',1);
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:77   

  15442  2 000121   000017 630400 3                  EPPR0   15
         2 000122   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000123   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000124   000000 011000                    NOP     0

      465    15443    2      CALL ASL$DISP_ONE_CONTROLLER (CONT$, JCL, LINE_NAME );

  15443  2 000125   200014 630500                    EPPR0   LINE_NAME,,AUTO
         2 000126   200022 450500                    STP0    NEW_CONTROLLER+4,,AUTO
         2 000127   200003 236100                    LDQ     @JCL,,AUTO
         2 000130   200021 756100                    STQ     NEW_CONTROLLER+3,,AUTO
         2 000131   200005 631500                    EPPR1   CONT$,,AUTO
         2 000132   200020 451500                    STP1    NEW_CONTROLLER+2,,AUTO
         2 000133   200020 630500                    EPPR0   NEW_CONTROLLER+2,,AUTO
         2 000134   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000135   000000 701000 xent               TSX1    ASL$DISP_ONE_CONTROLLER
         2 000136   000000 011000                    NOP     0

      466    15444    2     DEV_ARS = SIZEW (KL_CONTROLLER) + (KL$CONTROLLER.BLKHDR.NSUBS * SIZEW(KL_LINEDEV)
             15444               );

  15444  2 000137   200005 470500                    LDP0    CONT$,,AUTO
         2 000140   000100 101500                    MRL     fill='000'O
         2 000141   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         2 000142   200020 000004                    ADSC9   NEW_CONTROLLER+2,,AUTO   cn=0,n=4
         2 000143   200020 236100                    LDQ     NEW_CONTROLLER+2,,AUTO
         2 000144   000002 736000                    QLS     2
         2 000145   000004 036007                    ADLQ    4,DL
         2 000146   200010 756100                    STQ     DEV_ARS,,AUTO

      467    15445    2      DEV$ = CONT$;

  15445  2 000147   200005 236100                    LDQ     CONT$,,AUTO
         2 000150   200007 756100                    STQ     DEV$,,AUTO

      468    15446    2      END$ = PINCRW (CONT$, DEV_ARS);
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:78   

  15446  2 000151   200010 236100                    LDQ     DEV_ARS,,AUTO
         2 000152   000022 736000                    QLS     18
         2 000153   200005 036100                    ADLQ    CONT$,,AUTO
         2 000154   200011 756100                    STQ     END$,,AUTO

      469    15447    2      CONTROLLER_NUMBER = KL$CONTROLLER.CONT#;

  15447  2 000155   000100 101500                    MRL     fill='000'O
         2 000156   000002 000001                    ADSC9   2,,PR0                   cn=0,n=1
         2 000157   200006 000004                    ADSC9   CONTROLLER_NUMBER,,AUTO  cn=0,n=4

      470    15448    2      NEW_CONTROLLER = %YES#;

  15448  2 000160   400000 236003                    LDQ     -131072,DU
         2 000161   200016 756100                    STQ     NEW_CONTROLLER,,AUTO

      471    15449    3      DO WHILE DEV$ < END$ ;

  15449  2 000162   200007 236100                    LDQ     DEV$,,AUTO
         2 000163   200011 116100                    CMPQ    END$,,AUTO
         2 000164   000223 603000 2                  TRC     END_J

      472    15450    3         CALL ASL$FIND_LINE_DEVICE (CONT$, DEV_ARS, DEV_NAME, DEV$) ALTRET (END_J);

  15450  2 000165   200007 630500                    EPPR0   DEV$,,AUTO
         2 000166   200023 450500                    STP0    NEW_CONTROLLER+5,,AUTO
         2 000167   000021 236000 3                  LDQ     17
         2 000170   200022 756100                    STQ     NEW_CONTROLLER+4,,AUTO
         2 000171   200010 631500                    EPPR1   DEV_ARS,,AUTO
         2 000172   200021 451500                    STP1    NEW_CONTROLLER+3,,AUTO
         2 000173   200005 633500                    EPPR3   CONT$,,AUTO
         2 000174   200020 453500                    STP3    NEW_CONTROLLER+2,,AUTO
         2 000175   200020 630500                    EPPR0   NEW_CONTROLLER+2,,AUTO
         2 000176   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000177   000000 701000 xent               TSX1    ASL$FIND_LINE_DEVICE
         2 000200   000223 702000 2                  TSX2    END_J
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:79   

      473    15451    3         CALL ASL$DISP_ONE_LINE_DEVICE (DEV$, JCL, LINE_NAME, CONTROLLER_NUMBER,
             15451                  NEW_CONTROLLER);

  15451  2 000201   200016 630500                    EPPR0   NEW_CONTROLLER,,AUTO
         2 000202   200024 450500                    STP0    NEW_CONTROLLER+6,,AUTO
         2 000203   200006 631500                    EPPR1   CONTROLLER_NUMBER,,AUTO
         2 000204   200023 451500                    STP1    NEW_CONTROLLER+5,,AUTO
         2 000205   200014 633500                    EPPR3   LINE_NAME,,AUTO
         2 000206   200022 453500                    STP3    NEW_CONTROLLER+4,,AUTO
         2 000207   200003 236100                    LDQ     @JCL,,AUTO
         2 000210   200021 756100                    STQ     NEW_CONTROLLER+3,,AUTO
         2 000211   200007 634500                    EPPR4   DEV$,,AUTO
         2 000212   200020 454500                    STP4    NEW_CONTROLLER+2,,AUTO
         2 000213   200020 630500                    EPPR0   NEW_CONTROLLER+2,,AUTO
         2 000214   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000215   000000 701000 xent               TSX1    ASL$DISP_ONE_LINE_DEVICE
         2 000216   000000 011000                    NOP     0

      474    15452    3         NEW_CONTROLLER = %NO#;

  15452  2 000217   200016 450100                    STZ     NEW_CONTROLLER,,AUTO

      475    15453    3         END;  /* Do while DEV$ < END$  */

  15453  2 000220   200007 236100                    LDQ     DEV$,,AUTO
         2 000221   200011 116100                    CMPQ    END$,,AUTO
         2 000222   000165 602000 2                  TNC     s:15450

      476    15454    2   END_J:
      477    15455    2      END;  /*  Do forever  */

  15455  2 000223   000105 710000 2     END_J        TRA     s:15441

      478    15456    1   END_FOREVER:
      479    15457    1   RETURN ;

PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:80   
  15457  2 000224   000000 702200 xent  END_FOREVER  TSX2  ! X66_ARET
      480    15458    1   END ASL$DISP_ONE_LINE;

PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:81   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_LINE.
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:82   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$DISP_ONE_LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(27)    r     1 CONT_NAME                  1-0-0/c STRC(27)    r     1 DEV_NAME
    30-0-0/c STRC(144)   r     1 KL_CONTROLLER             34-0-0/c STRC(144)   r     1 KL_LINEDEV
     5-0-0/c CHAR(27)    r     1 LINE_HDR_FMT              14-0-0/c CHAR(45)    r     1 LINE_HDR_FMT_JCL
     2-0-0/c CHAR(4)     r     1 LINE_STR                   4-0-0/c CHAR(2)     r     1 NO_STR
     3-0-0/c CHAR(3)     r     1 YES_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @JCL                       4-0-0/w UBIN        r     1 ARS
     5-0-0/w PTR         r     1 CONT$                      6-0-0/w UBIN        r     1 CONTROLLER_NUMBER
     7-0-0/w PTR         r     1 DEV$                      10-0-0/w UBIN        r     1 DEV_ARS
    11-0-0/w PTR         r     1 END$                      *0-0-0/b BIT         r     1 JCL
    14-0-0/c CHAR(8)     r     1 LINE_NAME                 16-0-0/b BIT         r     1 NEW_CONTROLLER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)              0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:83   

     0-0-0/c STRC(144)   r     1 KL$CONTROLLER              0-0-0/w STRC(684)   r     1 LINE$DREC
     0-0-0/w ASTR(9)     r     1 TEXT$C


   Procedure ASL$DISP_ONE_LINE requires 149 words for executable code.
   Procedure ASL$DISP_ONE_LINE requires 22 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_LINES.:E05TSI    .
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:84   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:85   
          MINI XREF LISTING

ARS
     15090**DCL     15439<<ASSIGN  15441<>CALL
ASA_BRKS_LOC
     11796**DCL     11796--REDEF
ASB$WRITE_LO
     14656**DCL-ENT 15420--CALL    15442--CALL
ASL$DISP_ONE_CONTROLLER
     14665**DCL-ENT 15443--CALL
ASL$DISP_ONE_LINE_DEVICE
     14668**DCL-ENT 15451--CALL
ASL$FIND_CONTROLLER
     14659**DCL-ENT 15441--CALL
ASL$FIND_LINE_DEVICE
     14662**DCL-ENT 15450--CALL
AS_BLANK
     11656**DCL     15420<>CALL
AS_DEFAULT.BANNER_PERM
     12489**DCL     12490--REDEF
AS_DEFAULT.BUDGET.MACCT
     12394**DCL     12398--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12407**DCL     12410--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12390**DCL     12392--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12385**DCL     12387--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12505**DCL     12506--REDEF   12507--REDEF
AS_DEFAULT_DREC.PASSWORD
     13759**DCL     13763--REDEF
AS_DEFAULT_DREC.RENAME
     13782**DCL     13783--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:86   
AS_DFLT.BANNER_PERM
     12311**DCL     12312--REDEF
AS_DFLT.BUDGET.MACCT
     12216**DCL     12220--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12229**DCL     12232--REDEF
AS_DFLT.BUDGET.PACCUM
     12212**DCL     12214--REDEF
AS_DFLT.BUDGET.PMAXC
     12207**DCL     12209--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12327**DCL     12328--REDEF   12329--REDEF
AS_FE_MODE
     11662**DCL     11663--REDEF
AS_MODE
     11659**DCL     11661--REDEF
AS_MOD_USER.ACCESS
     14524**DCL     14525--REDEF
AS_MOD_USER.BANNER
     14511**DCL     14512--REDEF
AS_MOD_USER.BANNER_PERM
     14513**DCL     14514--REDEF
AS_MOD_USER.BILL
     14519**DCL     14520--REDEF
AS_MOD_USER.CPROC
     14515**DCL     14516--REDEF
AS_MOD_USER.FEBILL
     14595**DCL     14596--REDEF
AS_MOD_USER.FECXTMEM
     14612**DCL     14613--REDEF
AS_MOD_USER.FEMINTS
     14597**DCL     14598--REDEF
AS_MOD_USER.FEMMEM
     14608**DCL     14609--REDEF
AS_MOD_USER.FEMTIME
     14606**DCL     14607--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:87   
AS_MOD_USER.FEPPRIV
     14603**DCL     14605--REDEF
AS_MOD_USER.FEPRIV
     14600**DCL     14602--REDEF
AS_MOD_USER.FORCE_BIT
     14509**DCL     14510--REDEF
AS_MOD_USER.KEY
     14591**DCL     14593--REDEF
AS_MOD_USER.LASTCPROC
     14517**DCL     14518--REDEF
AS_MOD_USER.LIMITS.DO_
     14565**DCL     14566--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14581**DCL     14582--REDEF
AS_MOD_USER.LIMITS.LO
     14561**DCL     14562--REDEF
AS_MOD_USER.LIMITS.MEM
     14557**DCL     14558--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14585**DCL     14586--REDEF
AS_MOD_USER.LIMITS.PDIS
     14573**DCL     14574--REDEF
AS_MOD_USER.LIMITS.PO
     14569**DCL     14570--REDEF
AS_MOD_USER.LIMITS.TDIS
     14577**DCL     14578--REDEF
AS_MOD_USER.LIMITS.TIME
     14553**DCL     14554--REDEF
AS_MOD_USER.MAXENQ
     14534**DCL     14535--REDEF
AS_MOD_USER.PERM_BIT
     14507**DCL     14508--REDEF
AS_MOD_USER.PPRIV
     14529**DCL     14531--REDEF
AS_MOD_USER.PRIOB
     14536**DCL     14537--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:88   
AS_MOD_USER.PRIV
     14526**DCL     14528--REDEF
AS_MOD_USER.QUAN
     14532**DCL     14533--REDEF
AS_MOD_USER.SETUP
     14505**DCL     14506--REDEF
AS_PROJECT.BANNER_PERM
     12845**DCL     12846--REDEF
AS_PROJECT.BUDGET.MACCT
     12750**DCL     12754--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12763**DCL     12766--REDEF
AS_PROJECT.BUDGET.PACCUM
     12746**DCL     12748--REDEF
AS_PROJECT.BUDGET.PMAXC
     12741**DCL     12743--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12861**DCL     12862--REDEF   12863--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13023**DCL     13024--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12928**DCL     12932--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12941**DCL     12944--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12924**DCL     12926--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12919**DCL     12921--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13039**DCL     13040--REDEF   13041--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14245**DCL     14249--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14268**DCL     14269--REDEF
AS_PROJECT_DREC.PASSWORD
     14083**DCL     14087--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:89   
AS_PROJECT_DREC.RENAME
     14106**DCL     14107--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12667**DCL     12668--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12572**DCL     12576--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12585**DCL     12588--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12568**DCL     12570--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12563**DCL     12565--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12683**DCL     12684--REDEF   12685--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13921**DCL     13925--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13944**DCL     13945--REDEF
AS_USERS.BANNER_PERM
     12133**DCL     12134--REDEF
AS_USERS.BUDGET.MACCT
     12038**DCL     12042--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12051**DCL     12054--REDEF
AS_USERS.BUDGET.PACCUM
     12034**DCL     12036--REDEF
AS_USERS.BUDGET.PMAXC
     12029**DCL     12031--REDEF
AS_USERS.SETUP_CHRA.TXT
     12149**DCL     12150--REDEF   12151--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13201**DCL     13202--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13106**DCL     13110--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13119**DCL     13122--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:90   
AS_USERS_CONSTANT.BUDGET.PACCUM
     13102**DCL     13104--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13097**DCL     13099--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13217**DCL     13218--REDEF   13219--REDEF
CONT$
     15091**DCL     14950--IMP-PTR 15438<<ASSIGN  15441<>CALL    15443<>CALL    15444>>ASSIGN  15445>>ASSIGN
     15446>>ASSIGN  15447>>ASSIGN  15450<>CALL
CONTROLLER_NUMBER
     15092**DCL     15447<<ASSIGN  15451<>CALL
CONT_NAME
     15103**DCL     15441<>CALL
DEV$
     15093**DCL     15445<<ASSIGN  15449>>DOWHILE 15450<>CALL    15451<>CALL
DEV_ARS
     15094**DCL     15444<<ASSIGN  15446>>ASSIGN  15450<>CALL
DEV_NAME
     15106**DCL     15450<>CALL
DSEG1$
     11797**DCL     14689--IMP-PTR 15423>>ASSIGN  15423>>ASSIGN  15424>>IF      15438>>ASSIGN  15439>>ASSIGN
     15441<>CALL
END$
     15095**DCL     15446<<ASSIGN  15449>>DOWHILE
END_FOREVER
     15457**LABEL   15441--CALLALT
END_J
     15455**LABEL   15450--CALLALT
ERR_CODE
     11791**DCL     11792--REDEF
FDS
     11688**DCL     15437<>CALL
FDS.FMT_.BOUND
     11693**DCL     15430<<ASSIGN  15434<<ASSIGN
FDS.NVECS#
     11716**DCL     15436<<ASSIGN
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:91   
FMT_BUF
     11787**DCL     15429<<ASSIGN  15433<<ASSIGN
FMT_VEC
     11787**DCL     15421<<ASSIGN  15422<<ASSIGN  15423<<ASSIGN  15425<<ASSIGN  15427<<ASSIGN
JCL
     14651**DCL        10--PROC    15428>>IF      15443<>CALL    15451<>CALL
KL$CONTROLLER.BLKHDR.NSUBS
     14998**DCL     15444>>ASSIGN
KL$CONTROLLER.CONT#
     15067**DCL     15447>>ASSIGN
KL_CONTROLLER
     15131**DCL     15444--ASSIGN
KL_DEFAULT.PASSWORD
     14407**DCL     14411--REDEF
KL_DEFAULT.RENAME
     14430**DCL     14431--REDEF
KL_DFLT.PASSWORD
     13597**DCL     13601--REDEF
KL_DFLT.RENAME
     13620**DCL     13621--REDEF
KL_DREC.PASSWORD
     13435**DCL     13439--REDEF
KL_DREC.RENAME
     13458**DCL     13459--REDEF
KL_DREC_CNT.PASSWORD
     13322**DCL     13326--REDEF
KL_DREC_CNT.RENAME
     13345**DCL     13346--REDEF
KL_LINEDEV
     15280**DCL     15444--ASSIGN
LINE$DREC
     14689**DCL     15439--ASSIGN
LINE$DREC.LN.SLAVE#
     14925**DCL     15424>>IF
LINE$DREC.NWINFO
     14787**DCL     15439>>ASSIGN
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:92   
LINE$DREC.PASSWORD
     14747**DCL     14751--REDEF
LINE$DREC.PNAME
     14753**DCL     15423--ASSIGN  15423--ASSIGN
LINE$DREC.RENAME
     14770**DCL     14771--REDEF
LINE_HDR_FMT
     15112**DCL     15433>>ASSIGN  15434--ASSIGN
LINE_HDR_FMT_JCL
     15114**DCL     15429>>ASSIGN  15430--ASSIGN
LINE_NAME
     15098**DCL     15419<<ASSIGN  15422--ASSIGN  15443<>CALL    15451<>CALL
LINE_STR
     15109**DCL     15421--ASSIGN
NEW_CONTROLLER
     15099**DCL     15448<<ASSIGN  15451<>CALL    15452<<ASSIGN
NO_STR
     15111**DCL     15427--ASSIGN
PROJ_KEY.TEXT
     11669**DCL     11669--REDEF
PROJ_KEY.TXT.PROJECT
     11669**DCL     11669--REDEF
REMEM_VAR
     11795**DCL     11795--REDEF
REM_FCMD
     11795**DCL     11796--REDEF
TEXT$C.CNT
     15085**DCL     15086--IMP-SIZ 15423>>ASSIGN
TEXT$C.TEXT
     15086**DCL     15423--ASSIGN
USERS_KEY.TEXT
     11666**DCL     11667--REDEF   11667--REDEF   11667--REDEF   11668--REDEF
USERS_KEY.TXTC
     11667**DCL     15419>>ASSIGN
X$FORMAT
     14670**DCL-ENT 15437--CALL
PL6.E3A0      #002=ASL$DISP_ONE_LINE File=ASL$LIST_LINES.:E05TSI                 TUE 07/29/97 10:13 Page:93   
YES_STR
     15110**DCL     15425--ASSIGN
