VERSION E05

PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:1    
        1        1        /*M* VPC$SETOUT Set up and open output file                                   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DTI=1,THI=1  */
        8        8        /* Next available error code = 95 by 1  */
        9        9        /*  ALSO AVAILABLE:  NONE  */
       10       10        VPC$CALL_OPEN: PROC(FPT_OPEN) ALTRET;
       11       11        /*D* NAME: VPC$CALL_OPEN
       12       12             CALL: CALL VPC$CALL_OPEN(FPT_OPEN);
       13       13             DESCRIPTION: This procedure will do an OPEN using the passed FPT.
       14       14                          If it is suitable for FSFA, WRITE_MODE will be set
       15       15                          to 1.  Otherwise it'll be 0.
       16       16        */
       17       17        /**/
       18       18        /*  INCLUDE FILES  */
       19       19        /**/
       20       20        %INCLUDE VP_DATA_R;
       21     7007        /**/
       22     7008        /*  Parameters  */
       23     7009        /**/
       24     7010        %FPT_OPEN(FPTN = FPT_OPEN,
       25     7011                  STCLASS = " ");
       26     7120        %FPT_OPEN(FPTN=FPT_OPEN_SETUP_EO,STCLASS=" ");
       27     7229        /**/
       28     7230        /*  Based Structures  */
       29     7231        /**/
       30     7232        %B$ALT;
       31     7240        %FPT_CLOSE(FPTN = FPT_CLOSE,
       32     7241                   STCLASS = "BASED(CLOSE$)");
       33     7283        %B$TCB;
       34     7286        /**/
       35     7287        /*  Local Storage  */
       36     7288        /**/
       37     7289    1   DCL CLOSE$ PTR;
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:2    
       38     7290        /**/
       39     7291        /* Next available error code = 250 (by 10s)   */
       40     7292        /**/
       41     7293    1   DCL VPD$GET_BUF ENTRY(2) ALTRET;
       42     7294    1   DCL VPD$REL_BUF ENTRY(2) ALTRET;
       43     7295    1   DCL XSA$OPEN ENTRY(2) ALTRET;
       44     7296    1   DCL XSA$CLOSE ENTRY(2) ALTRET;
       45     7297        /**/
       46     7298    1           IF FPT_OPEN.V.OPER.TEST#        /* TEST OPEN                          */
       47     7299    1             OR FPT_OPEN.V.INITZ.REASSIGN# /* or AMR specified                   */
       48     7300    1             OR NOT CMD_MASK & '34'O       /* Not COPYs                          */
       49     7301    1             OR OCB.CRPT ~= 0              /* Encryption                         */
       50     7302    1             OR OCB.BIN = 2                /* BINary                             */
       51     7303    1             OR OCB.TRANS = 2              /* TRANSparent                        */
       52     7304    1            THEN                           /* Unsuitable for FSFA routines       */
       53     7305    1              GOTO PMME_OPEN;
       54     7306        /**/
       55     7307    1           CALL VPD$GET_BUF(OKBUF_PTR$,1024) ALTRET(PMME_OPEN);
       56     7308    1           OFSFA_PARAM.KBUF_.BUF$ = OKBUF_PTR$;
       57     7309    1           OFSFA_PARAM.KBUF_.BOUND = 1024 * 4 -1;
       58     7310        /**/
       59     7311    1           OBBUF_WSIZE = 1024 * 5;
       60     7312    1           CALL VPD$GET_BUF(OBBUF_PTR$,OBBUF_WSIZE) ALTRET(PMME_OPEN);
       61     7313    1           OFSFA_PARAM.BBUF_.BUF$ = OBBUF_PTR$;
       62     7314    1           OFSFA_PARAM.BBUF_.BOUND = OBBUF_WSIZE * 4 -1;
       63     7315        /**/
       64     7316    1           CALL XSA$OPEN(FPT_OPEN,OFSFA_PARAM) ALTRET(FSFA_ALT);
       65     7317        /**/
       66     7318    1           IF OFSFA_PARAM.ORG = 0
       67     7319    1            THEN                           /* Unsuitable for FSFA                */
       68     7320    2            DO;
       69     7321    2               WRITE_MODE = 0;
       70     7322    2               CALL CLEANUP;
       71     7323    2               END;
       72     7324    1            ELSE                           /* FSFA must be used                  */
       73     7325    2            DO;
       74     7326    2               WRITE_MODE = 1;
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:3    
       75     7327    2               IF OFSFA_PARAM.ORG = %CONSEC#
       76     7328    2                THEN                       /* KBUF isn't needed                  */
       77     7329    2                  CALL VPD$REL_BUF(OKBUF_PTR$,1024); /* Release it               */
       78     7330    2               END;
       79     7331    1           RETURN;
       80     7332        /**/
       81     7333    1   PMME_OPEN:
       82     7334    1           CALL CLEANUP;                   /* Cleanup after FSFA attempt         */
       83     7335    2           IF FPT_OPEN.V.INITZ.REASSIGN# THEN DO; /* AMR specified               */
       84     7336    2               FPT_OPEN_SETUP_EO = FPT_OPEN; /* Get all options given to PCL     */
       85     7337    2               FPT_OPEN_SETUP_EO.V_=VECTOR(FPT_OPEN_SETUP_EO.V);
       86     7338    2               FPT_OPEN_SETUP_EO.V.SETDCB#='1'B;
       87     7339    2               FPT_OPEN_SETUP_EO.V.INITZ.REASSIGN#='0'B;
       88     7340    2               FPT_OPEN_SETUP_EO.V.OPER.TEST#='1'B;
       89     7341    2               CALL M$OPEN(FPT_OPEN_SETUP_EO) ALTRET(PMME_ALT);
              7341                        /* Put PCL's options/defaults into DCB */
       90     7342    2               FPT_OPEN = FPT_OPEN_OUT_SAVE; /* Startout with a fresh FPT        */
       91     7343    2               FPT_OPEN.V_=VECTOR(FPT_OPEN.V);
       92     7344    2               FPT_OPEN.V.INITZ.REASSIGN#='1'B;
              7344                        /* and merge in the stuff on the !SET */
       93     7345    2               FPT_OPEN.V.DCB# = FPT_OPEN_SETUP_EO.V.DCB#;
       94     7346    2               END;
       95     7347    1           CALL M$OPEN (FPT_OPEN) ALTRET(PMME_ALT);
       96     7348    1           WRITE_MODE = 0;
       97     7349    1           RETURN;
       98     7350        /**/
       99     7351    1   VPC$CALL_CLOSE: ENTRY(FPT_OPEN) ALTRET;
      100     7352    1           CLOSE$ = ADDR(FPT_OPEN);        /* PL-6 KLUDGE                        */
      101     7353    1           IF NOT CMD_MASK & '34'O         /* Not COPYs                          */
      102     7354    1            THEN                           /* Don't trust WRITE_MODE             */
      103     7355    1              GOTO PMME_CLOSE;
      104     7356    2           DO CASE(WRITE_MODE);
      105     7357    2            CASE(0);                       /* Normal PMME                        */
      106     7358    2   PMME_CLOSE: CALL M$CLOSE(FPT_CLOSE) ALTRET(PMME_ALT);
      107     7359    2            CASE(1);                       /* FSFA routines                      */
      108     7360    2              CALL XSA$CLOSE(FPT_CLOSE,OFSFA_PARAM) ALTRET(FSFA_ALT);
      109     7361    2              CALL CLEANUP;
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:4    
      110     7362    2            END;                           /* END CASE                           */
      111     7363    1           RETURN;
      112     7364        /**/
      113     7365    1   PMME_ALT:
      114     7366    1           OUTPUT_ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      115     7367    1           ALTRETURN;
      116     7368        /**/
      117     7369    1   FSFA_ALT:
      118     7370    1           OUTPUT_ERR = OFSFA_PARAM.ERR;
      119     7371    1           CALL CLEANUP;
      120     7372    1           ALTRETURN;
      121     7373        /**/
      122     7374    1   CLEANUP: PROC;
      123     7375    2           IF OKBUF_PTR$ ~= ADDR(NIL)
      124     7376    2            THEN                           /* Key buffer leftover                */
      125     7377    2              CALL VPD$REL_BUF(OKBUF_PTR$,1024);
      126     7378        /**/
      127     7379    2           IF OBBUF_PTR$ ~= ADDR(NIL)
      128     7380    2            THEN                           /* Data buffer leftover               */
      129     7381    2              CALL VPD$REL_BUF(OBBUF_PTR$,OBBUF_WSIZE);
      130     7382        /**/
      131     7383    2           RETURN;
      132     7384        /**/
      133     7385    2   END CLEANUP;
      134     7386        /**/
      135     7387    1   END VPC$CALL_OPEN;
      136     7388        %EOD;

PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:5    
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPC$CALL_OPEN.

   Procedure VPC$CALL_OPEN requires 171 words for executable code.
   Procedure VPC$CALL_OPEN requires 68 words of local(AUTO) storage.

PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:6    

 Object Unit name= VPC$CALL_OPEN                              File name= VPC$SETOUT.:E05TOU
 UTS= JUL 30 '97 07:19:39.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Proc  even  none   171    253  VPC$CALL_OPEN
   11  RoData even  none    11     13  VPC$CALL_OPEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes    yes     yes      Std        1  VPC$CALL_OPEN
    10    161          yes     yes      Std        1  VPC$CALL_CLOSE
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:7    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 VPD$GET_BUF
 yes     yes           Std       2 VPD$REL_BUF
 yes     yes           Std       2 XSA$OPEN
 yes     yes           Std       2 XSA$CLOSE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OUTPUT_ERR                            BREAK_LOC
     BREAK_MESSAGE_REPORTER                CMD_MASK                              SPEC_BUF
     OCB                                   IN_RES                                WRITE_MODE
     OBBUF_PTR$                            OBBUF_WSIZE                           OKBUF_PTR$
     OFSFA_PARAM                           M$EI                                  M$EO
     M$EO1                                 M$ME                                  M$SI
     M$READFILE                            M$DO                                  M$STD1
     M$SORT1                               B$TCB$                                FPT_OPEN_OUT_SAVE
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:8    


        1        1        /*M* VPC$SETOUT Set up and open output file                                   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DTI=1,THI=1  */
        8        8        /* Next available error code = 95 by 1  */
        9        9        /*  ALSO AVAILABLE:  NONE  */
       10       10        VPC$CALL_OPEN: PROC(FPT_OPEN) ALTRET;

     10 10 000000   000000 700200 xent  VPC$CALL_OP* TSX0  ! X66_AUTO_1
        10 000001   000104 000001                    ZERO    68,1

       11       11        /*D* NAME: VPC$CALL_OPEN
       12       12             CALL: CALL VPC$CALL_OPEN(FPT_OPEN);
       13       13             DESCRIPTION: This procedure will do an OPEN using the passed FPT.
       14       14                          If it is suitable for FSFA, WRITE_MODE will be set
       15       15                          to 1.  Otherwise it'll be 0.
       16       16        */
       17       17        /**/
       18       18        /*  INCLUDE FILES  */
       19       19        /**/
       20       20        %INCLUDE VP_DATA_R;
       21     7007        /**/
       22     7008        /*  Parameters  */
       23     7009        /**/
       24     7010        %FPT_OPEN(FPTN = FPT_OPEN,
       25     7011                  STCLASS = " ");
       26     7120        %FPT_OPEN(FPTN=FPT_OPEN_SETUP_EO,STCLASS=" ");
       27     7229        /**/
       28     7230        /*  Based Structures  */
       29     7231        /**/
       30     7232        %B$ALT;
       31     7240        %FPT_CLOSE(FPTN = FPT_CLOSE,
       32     7241                   STCLASS = "BASED(CLOSE$)");
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:9    
       33     7283        %B$TCB;
       34     7286        /**/
       35     7287        /*  Local Storage  */
       36     7288        /**/
       37     7289    1   DCL CLOSE$ PTR;
       38     7290        /**/
       39     7291        /* Next available error code = 250 (by 10s)   */
       40     7292        /**/
       41     7293    1   DCL VPD$GET_BUF ENTRY(2) ALTRET;
       42     7294    1   DCL VPD$REL_BUF ENTRY(2) ALTRET;
       43     7295    1   DCL XSA$OPEN ENTRY(2) ALTRET;
       44     7296    1   DCL XSA$CLOSE ENTRY(2) ALTRET;
       45     7297        /**/
       46     7298    1           IF FPT_OPEN.V.OPER.TEST#        /* TEST OPEN                          */

   7298 10 000002   200003 470500                    LDP0    @FPT_OPEN,,AUTO
        10 000003   000044 236100                    LDQ     36,,PR0
        10 000004   020000 316007                    CANQ    8192,DL
        10 000005   000110 601000 10                 TNZ     PMME_OPEN
        10 000006   200000 316007                    CANQ    65536,DL
        10 000007   000110 601000 10                 TNZ     PMME_OPEN
        10 000010   000100 100400                    MLR     fill='000'O
        10 000011   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        10 000012   200102 000010                    ADSC9   CLOSE$+4,,AUTO           cn=0,n=8
        10 000013   200102 237100                    LDAQ    CLOSE$+4,,AUTO
        10 000014   000000 377000 11                 ANAQ    0
        10 000015   000110 600000 10                 TZE     PMME_OPEN
        10 000016   000002 235000 xsym               LDA     OCB+2
        10 000017   000110 601000 10                 TNZ     PMME_OPEN
        10 000020   000016 236000 xsym               LDQ     OCB+14
        10 000021   000002 116007                    CMPQ    2,DL
        10 000022   000110 600000 10                 TZE     PMME_OPEN
        10 000023   000017 235000 xsym               LDA     OCB+15
        10 000024   000002 115007                    CMPA    2,DL
        10 000025   000110 600000 10                 TZE     PMME_OPEN

       47     7299    1             OR FPT_OPEN.V.INITZ.REASSIGN# /* or AMR specified                   */
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:10   
       48     7300    1             OR NOT CMD_MASK & '34'O       /* Not COPYs                          */
       49     7301    1             OR OCB.CRPT ~= 0              /* Encryption                         */
       50     7302    1             OR OCB.BIN = 2                /* BINary                             */
       51     7303    1             OR OCB.TRANS = 2              /* TRANSparent                        */
       52     7304    1            THEN                           /* Unsuitable for FSFA routines       */
       53     7305    1              GOTO PMME_OPEN;
       54     7306        /**/
       55     7307    1           CALL VPD$GET_BUF(OKBUF_PTR$,1024) ALTRET(PMME_OPEN);

   7307 10 000026   000003 630400 11                 EPPR0   3
        10 000027   000020 631400 xsym               EPPR1   B_VECTNIL+16
        10 000030   000000 701000 xent               TSX1    VPD$GET_BUF
        10 000031   000110 702000 10                 TSX2    PMME_OPEN

       56     7308    1           OFSFA_PARAM.KBUF_.BUF$ = OKBUF_PTR$;

   7308 10 000032   000000 236000 xsym               LDQ     OKBUF_PTR$
        10 000033   000003 756000 xsym               STQ     OFSFA_PARAM+3

       57     7309    1           OFSFA_PARAM.KBUF_.BOUND = 1024 * 4 -1;

   7309 10 000034   000002 236000 xsym               LDQ     OFSFA_PARAM+2
        10 000035   177777 376007                    ANQ     65535,DL
        10 000036   000005 276000 11                 ORQ     5
        10 000037   000002 756000 xsym               STQ     OFSFA_PARAM+2

       58     7310        /**/
       59     7311    1           OBBUF_WSIZE = 1024 * 5;

   7311 10 000040   012000 235007                    LDA     5120,DL
        10 000041   000000 755000 xsym               STA     OBBUF_WSIZE

       60     7312    1           CALL VPD$GET_BUF(OBBUF_PTR$,OBBUF_WSIZE) ALTRET(PMME_OPEN);

   7312 10 000042   000006 630400 11                 EPPR0   6
        10 000043   000020 631400 xsym               EPPR1   B_VECTNIL+16
        10 000044   000000 701000 xent               TSX1    VPD$GET_BUF
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:11   
        10 000045   000110 702000 10                 TSX2    PMME_OPEN

       61     7313    1           OFSFA_PARAM.BBUF_.BUF$ = OBBUF_PTR$;

   7313 10 000046   000000 236000 xsym               LDQ     OBBUF_PTR$
        10 000047   000005 756000 xsym               STQ     OFSFA_PARAM+5

       62     7314    1           OFSFA_PARAM.BBUF_.BOUND = OBBUF_WSIZE * 4 -1;

   7314 10 000050   000000 236000 xsym               LDQ     OBBUF_WSIZE
        10 000051   000002 736000                    QLS     2
        10 000052   000001 136007                    SBLQ    1,DL
        10 000053   000020 736000                    QLS     16
        10 000054   000004 676000 xsym               ERQ     OFSFA_PARAM+4
        10 000055   000034 376000 xsym               ANQ     B_VECTNIL+28
        10 000056   000004 656000 xsym               ERSQ    OFSFA_PARAM+4

       63     7315        /**/
       64     7316    1           CALL XSA$OPEN(FPT_OPEN,OFSFA_PARAM) ALTRET(FSFA_ALT);

   7316 10 000057   000010 236000 11                 LDQ     8
        10 000060   200003 235100                    LDA     @FPT_OPEN,,AUTO
        10 000061   200102 757100                    STAQ    CLOSE$+4,,AUTO
        10 000062   200102 630500                    EPPR0   CLOSE$+4,,AUTO
        10 000063   000020 631400 xsym               EPPR1   B_VECTNIL+16
        10 000064   000000 701000 xent               TSX1    XSA$OPEN
        10 000065   000225 702000 10                 TSX2    FSFA_ALT

       65     7317        /**/
       66     7318    1           IF OFSFA_PARAM.ORG = 0

   7318 10 000066   000014 236000 xsym               LDQ     OFSFA_PARAM+12
        10 000067   000777 316003                    CANQ    511,DU
        10 000070   000075 601000 10                 TNZ     s:7326

       67     7319    1            THEN                           /* Unsuitable for FSFA                */
       68     7320    2            DO;
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:12   

       69     7321    2               WRITE_MODE = 0;

   7321 10 000071   000000 450000 xsym               STZ     WRITE_MODE

       70     7322    2               CALL CLEANUP;

   7322 10 000072   000232 701000 10                 TSX1    CLEANUP
        10 000073   000000 011000                    NOP     0

       71     7323    2               END;

   7323 10 000074   000107 710000 10                 TRA     s:7331

       72     7324    1            ELSE                           /* FSFA must be used                  */
       73     7325    2            DO;

       74     7326    2               WRITE_MODE = 1;

   7326 10 000075   000001 235007                    LDA     1,DL
        10 000076   000000 755000 xsym               STA     WRITE_MODE

       75     7327    2               IF OFSFA_PARAM.ORG = %CONSEC#

   7327 10 000077   000014 236000 xsym               LDQ     OFSFA_PARAM+12
        10 000100   000777 376003                    ANQ     511,DU
        10 000101   000001 116003                    CMPQ    1,DU
        10 000102   000107 601000 10                 TNZ     s:7331

       76     7328    2                THEN                       /* KBUF isn't needed                  */
       77     7329    2                  CALL VPD$REL_BUF(OKBUF_PTR$,1024); /* Release it               */

   7329 10 000103   000003 630400 11                 EPPR0   3
        10 000104   000020 631400 xsym               EPPR1   B_VECTNIL+16
        10 000105   000000 701000 xent               TSX1    VPD$REL_BUF
        10 000106   000000 011000                    NOP     0

PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:13   
       78     7330    2               END;

       79     7331    1           RETURN;

   7331 10 000107   000000 702200 xent               TSX2  ! X66_ARET

       80     7332        /**/
       81     7333    1   PMME_OPEN:
       82     7334    1           CALL CLEANUP;                   /* Cleanup after FSFA attempt         */

   7334 10 000110   000232 701000 10    PMME_OPEN    TSX1    CLEANUP
        10 000111   000000 011000                    NOP     0

       83     7335    2           IF FPT_OPEN.V.INITZ.REASSIGN# THEN DO; /* AMR specified               */

   7335 10 000112   200003 470500                    LDP0    @FPT_OPEN,,AUTO
        10 000113   000044 236100                    LDQ     36,,PR0
        10 000114   200000 316007                    CANQ    65536,DL
        10 000115   000154 600000 10                 TZE     s:7347

       84     7336    2               FPT_OPEN_SETUP_EO = FPT_OPEN; /* Get all options given to PCL     */

   7336 10 000116   000100 100500                    MLR     fill='000'O
        10 000117   000000 000350                    ADSC9   0,,PR0                   cn=0,n=232
        10 000120   200004 000350                    ADSC9   FPT_OPEN_SETUP_EO,,AUTO  cn=0,n=232

       85     7337    2               FPT_OPEN_SETUP_EO.V_=VECTOR(FPT_OPEN_SETUP_EO.V);

   7337 10 000121   000011 235000 11                 LDA     9
        10 000122   200102 452500                    STP2    CLOSE$+4,,AUTO
        10 000123   200102 236100                    LDQ     CLOSE$+4,,AUTO
        10 000124   000050 036003                    ADLQ    40,DU
        10 000125   200004 757100                    STAQ    FPT_OPEN_SETUP_EO,,AUTO

       86     7338    2               FPT_OPEN_SETUP_EO.V.SETDCB#='1'B;

   7338 10 000126   100000 236007                    LDQ     32768,DL
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:14   
        10 000127   200050 256100                    ORSQ    FPT_OPEN_SETUP_EO+36,,AUTO

       87     7339    2               FPT_OPEN_SETUP_EO.V.INITZ.REASSIGN#='0'B;

   7339 10 000130   000012 236000 11                 LDQ     10
        10 000131   200050 356100                    ANSQ    FPT_OPEN_SETUP_EO+36,,AUTO

       88     7340    2               FPT_OPEN_SETUP_EO.V.OPER.TEST#='1'B;

   7340 10 000132   020000 236007                    LDQ     8192,DL
        10 000133   200050 256100                    ORSQ    FPT_OPEN_SETUP_EO+36,,AUTO

       89     7341    2               CALL M$OPEN(FPT_OPEN_SETUP_EO) ALTRET(PMME_ALT);
              7341                        /* Put PCL's options/defaults into DCB */

   7341 10 000134   200004 630500                    EPPR0   FPT_OPEN_SETUP_EO,,AUTO
        10 000135   450000 713400                    CLIMB   alt,open
        10 000136   410400 401760                    pmme    nvectors=18
        10 000137   000220 702000 10                 TSX2    PMME_ALT

       90     7342    2               FPT_OPEN = FPT_OPEN_OUT_SAVE; /* Startout with a fresh FPT        */

   7342 10 000140   200003 470500                    LDP0    @FPT_OPEN,,AUTO
        10 000141   000100 100400                    MLR     fill='000'O
        10 000142   000000 000350 xsym               ADSC9   FPT_OPEN_OUT_SAVE        cn=0,n=232
        10 000143   000000 000350                    ADSC9   0,,PR0                   cn=0,n=232

       91     7343    2               FPT_OPEN.V_=VECTOR(FPT_OPEN.V);

   7343 10 000144   000011 235000 11                 LDA     9
        10 000145   200003 236100                    LDQ     @FPT_OPEN,,AUTO
        10 000146   000044 036003                    ADLQ    36,DU
        10 000147   000000 757100                    STAQ    0,,PR0

       92     7344    2               FPT_OPEN.V.INITZ.REASSIGN#='1'B;
              7344                        /* and merge in the stuff on the !SET */

PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:15   
   7344 10 000150   200000 236007                    LDQ     65536,DL
        10 000151   000044 256100                    ORSQ    36,,PR0

       93     7345    2               FPT_OPEN.V.DCB# = FPT_OPEN_SETUP_EO.V.DCB#;

   7345 10 000152   200050 220100                    LDX0    FPT_OPEN_SETUP_EO+36,,AUTO
        10 000153   000044 740100                    STX0    36,,PR0

       94     7346    2               END;

       95     7347    1           CALL M$OPEN (FPT_OPEN) ALTRET(PMME_ALT);

   7347 10 000154   450000 713400                    CLIMB   alt,open
        10 000155   410400 401760                    pmme    nvectors=18
        10 000156   000220 702000 10                 TSX2    PMME_ALT

       96     7348    1           WRITE_MODE = 0;

   7348 10 000157   000000 450000 xsym               STZ     WRITE_MODE

       97     7349    1           RETURN;

   7349 10 000160   000000 702200 xent               TSX2  ! X66_ARET

       98     7350        /**/
       99     7351    1   VPC$CALL_CLOSE: ENTRY(FPT_OPEN) ALTRET;

   7351 10 000161   000000 700200 xent  VPC$CALL_CL* TSX0  ! X66_AUTO_1
        10 000162   000104 000001                    ZERO    68,1

      100     7352    1           CLOSE$ = ADDR(FPT_OPEN);        /* PL-6 KLUDGE                        */

   7352 10 000163   200003 236100                    LDQ     @FPT_OPEN,,AUTO
        10 000164   200076 756100                    STQ     CLOSE$,,AUTO

      101     7353    1           IF NOT CMD_MASK & '34'O         /* Not COPYs                          */

PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:16   
   7353 10 000165   000100 100400                    MLR     fill='000'O
        10 000166   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        10 000167   200102 000010                    ADSC9   CLOSE$+4,,AUTO           cn=0,n=8
        10 000170   200102 237100                    LDAQ    CLOSE$+4,,AUTO
        10 000171   000000 377000 11                 ANAQ    0
        10 000172   000201 600000 10                 TZE     PMME_CLOSE

      102     7354    1            THEN                           /* Don't trust WRITE_MODE             */
      103     7355    1              GOTO PMME_CLOSE;
      104     7356    2           DO CASE(WRITE_MODE);

   7356 10 000173   000000 235000 xsym               LDA     WRITE_MODE
        10 000174   000002 115007                    CMPA    2,DL
        10 000175   000177 602005 10                 TNC     s:7356+4,AL
        10 000176   000217 710000 10                 TRA     s:7363
        10 000177   000201 710000 10                 TRA     PMME_CLOSE
        10 000200   000206 710000 10                 TRA     s:7360

      105     7357    2            CASE(0);                       /* Normal PMME                        */

      106     7358    2   PMME_CLOSE: CALL M$CLOSE(FPT_CLOSE) ALTRET(PMME_ALT);

   7358 10 000201   200076 470500       PMME_CLOSE   LDP0    CLOSE$,,AUTO
        10 000202   450001 713400                    CLIMB   alt,close
        10 000203   406000 401760                    pmme    nvectors=13
        10 000204   000220 702000 10                 TSX2    PMME_ALT
        10 000205   000217 710000 10                 TRA     s:7363

      107     7359    2            CASE(1);                       /* FSFA routines                      */

      108     7360    2              CALL XSA$CLOSE(FPT_CLOSE,OFSFA_PARAM) ALTRET(FSFA_ALT);

   7360 10 000206   000010 236000 11                 LDQ     8
        10 000207   200076 235100                    LDA     CLOSE$,,AUTO
        10 000210   200102 757100                    STAQ    CLOSE$+4,,AUTO
        10 000211   200102 630500                    EPPR0   CLOSE$+4,,AUTO
        10 000212   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:17   
        10 000213   000000 701000 xent               TSX1    XSA$CLOSE
        10 000214   000225 702000 10                 TSX2    FSFA_ALT

      109     7361    2              CALL CLEANUP;

   7361 10 000215   000232 701000 10                 TSX1    CLEANUP
        10 000216   000000 011000                    NOP     0

      110     7362    2            END;                           /* END CASE                           */

      111     7363    1           RETURN;

   7363 10 000217   000000 702200 xent               TSX2  ! X66_ARET

      112     7364        /**/
      113     7365    1   PMME_ALT:
      114     7366    1           OUTPUT_ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   7366 10 000220   000000 470400 xsym  PMME_ALT     LDP0    B$TCB$
        10 000221   000000 471500                    LDP1    0,,PR0
        10 000222   100102 236100                    LDQ     66,,PR1
        10 000223   000000 756000 xsym               STQ     OUTPUT_ERR

      115     7367    1           ALTRETURN;

   7367 10 000224   000000 702200 xent               TSX2  ! X66_AALT

      116     7368        /**/
      117     7369    1   FSFA_ALT:
      118     7370    1           OUTPUT_ERR = OFSFA_PARAM.ERR;

   7370 10 000225   000001 236000 xsym  FSFA_ALT     LDQ     OFSFA_PARAM+1
        10 000226   000000 756000 xsym               STQ     OUTPUT_ERR

      119     7371    1           CALL CLEANUP;

   7371 10 000227   000232 701000 10                 TSX1    CLEANUP
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:18   
        10 000230   000000 011000                    NOP     0

      120     7372    1           ALTRETURN;

   7372 10 000231   000000 702200 xent               TSX2  ! X66_AALT

      121     7373        /**/
      122     7374    1   CLEANUP: PROC;

   7374 10 000232   200100 741300       CLEANUP      STX1  ! CLOSE$+2,,AUTO

      123     7375    2           IF OKBUF_PTR$ ~= ADDR(NIL)

   7375 10 000233   000000 236000 xsym               LDQ     OKBUF_PTR$
        10 000234   000001 116000 xsym               CMPQ    B_VECTNIL+1
        10 000235   000242 600000 10                 TZE     s:7379

      124     7376    2            THEN                           /* Key buffer leftover                */
      125     7377    2              CALL VPD$REL_BUF(OKBUF_PTR$,1024);

   7377 10 000236   000003 630400 11                 EPPR0   3
        10 000237   000020 631400 xsym               EPPR1   B_VECTNIL+16
        10 000240   000000 701000 xent               TSX1    VPD$REL_BUF
        10 000241   000000 011000                    NOP     0

      126     7378        /**/
      127     7379    2           IF OBBUF_PTR$ ~= ADDR(NIL)

   7379 10 000242   000000 236000 xsym               LDQ     OBBUF_PTR$
        10 000243   000001 116000 xsym               CMPQ    B_VECTNIL+1
        10 000244   000251 600000 10                 TZE     s:7383

      128     7380    2            THEN                           /* Data buffer leftover               */
      129     7381    2              CALL VPD$REL_BUF(OBBUF_PTR$,OBBUF_WSIZE);

   7381 10 000245   000006 630400 11                 EPPR0   6
        10 000246   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:19   
        10 000247   000000 701000 xent               TSX1    VPD$REL_BUF
        10 000250   000000 011000                    NOP     0

      130     7382        /**/
      131     7383    2           RETURN;

   7383 10 000251   200100 221300                    LDX1  ! CLOSE$+2,,AUTO
        10 000252   000001 702211                    TSX2  ! 1,X1
      132     7384        /**/
      133     7385    2   END CLEANUP;
      134     7386        /**/
      135     7387    1   END VPC$CALL_OPEN;
      136     7388        %EOD;

PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:20   
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPC$CALL_OPEN.
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:21   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPT_OPEN                 76-0-0/w PTR         r     1 CLOSE$
    *0-0-0/d STRC(2088)  r     1 FPT_OPEN                   4-0-0/d STRC(2088)  r     1 FPT_OPEN_SETUP_EO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/b BIT         r     1 CMD_MASK(0:71)
     0-0-0/d STRC(2088)  r     1 FPT_OPEN_OUT_SAVE          0-0-0/w PTR         r     1 OBBUF_PTR$
     0-0-0/w SBIN        r     1 OBBUF_WSIZE                0-0-0/d STRC(6840)  r     1 OCB
     0-0-0/d STRC(504)   r     1 OFSFA_PARAM                0-0-0/w PTR         r     1 OKBUF_PTR$
     0-0-0/w STRC        r     1 OUTPUT_ERR                 0-0-0/w SBIN        r     1 WRITE_MODE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d STRC(1080)  r     1 FPT_CLOSE


   Procedure VPC$CALL_OPEN requires 171 words for executable code.
   Procedure VPC$CALL_OPEN requires 68 words of local(AUTO) storage.
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:22   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:23   
          MINI XREF LISTING

B$ALT.CODE
      7234**DCL      7234--REDEF    7235--REDEF    7235--REDEF
B$ALT.ERR
      7235**DCL      7366>>ASSIGN
B$ALT.ERR.ERR#
      7236**DCL      7236--REDEF
B$ALT.EVID
      7235**DCL      7235--REDEF    7235--REDEF
B$TCB.ALT$
      7284**DCL      7366>>ASSIGN
B$TCB$
      5992**DCL      7366>>ASSIGN
BREAK_LOC
      5227**DCL      5227--REDEF
CLEANUP
      7374**PROC     7322--CALL     7334--CALL     7361--CALL     7371--CALL
CLOSE$
      7289**DCL      7264--IMP-PTR  7352<<ASSIGN   7358>>CALL     7360>>CALL
CMD_MASK
      5229**DCL      7298>>IF       7353>>IF
DEF_ICB.FID.STRING
      5825**DCL      5826--REDEF
DEV_ICB.FID.STRING
      5711**DCL      5712--REDEF
EI_KEY.KEY
      5923**DCL      5923--REDEF    5923--REDEF    5923--REDEF
EO_OCB.TYPE
      5423**DCL      5424--REDEF
FPT_CLOSE
      7264**DCL      7358<>CALL     7360<>CALL
FPT_CLOSE.SN_
      7264**DCL      7264--REDEF
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:24   
FPT_CLOSE.UTL_
      7265**DCL      7265--REDEF
FPT_CLOSE.V.EXPIRE#
      7279**DCL      7279--REDEF
FPT_CLOSE.V.TYPE#
      7277**DCL      7277--REDEF
FPT_CLOSE.V.XTNSIZE#
      7274**DCL      7274--REDEF    7276--REDEF
FPT_CLOSE_EI.SN_
      6764**DCL      6764--REDEF
FPT_CLOSE_EI.UTL_
      6765**DCL      6765--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6779**DCL      6779--REDEF
FPT_CLOSE_EI.V.TYPE#
      6777**DCL      6777--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6774**DCL      6774--REDEF    6776--REDEF
FPT_CLOSE_PTL.SN_
      6890**DCL      6890--REDEF
FPT_CLOSE_PTL.UTL_
      6891**DCL      6891--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6905**DCL      6905--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6903**DCL      6903--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6900**DCL      6900--REDEF    6902--REDEF
FPT_CLOSE_READ.SN_
      6806**DCL      6806--REDEF
FPT_CLOSE_READ.UTL_
      6807**DCL      6807--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6821**DCL      6821--REDEF
FPT_CLOSE_READ.V.TYPE#
      6819**DCL      6819--REDEF
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:25   
FPT_CLOSE_READ.V.XTNSIZE#
      6816**DCL      6816--REDEF    6818--REDEF
FPT_CLOSE_SI.SN_
      6974**DCL      6974--REDEF
FPT_CLOSE_SI.UTL_
      6975**DCL      6975--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6989**DCL      6989--REDEF
FPT_CLOSE_SI.V.TYPE#
      6987**DCL      6987--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6984**DCL      6984--REDEF    6986--REDEF
FPT_CLOSE_STD.SN_
      6932**DCL      6932--REDEF
FPT_CLOSE_STD.UTL_
      6933**DCL      6933--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6947**DCL      6947--REDEF
FPT_CLOSE_STD.V.TYPE#
      6945**DCL      6945--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6942**DCL      6942--REDEF    6944--REDEF
FPT_CLSEI_FT.SN_
      6848**DCL      6848--REDEF
FPT_CLSEI_FT.UTL_
      6849**DCL      6849--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6863**DCL      6863--REDEF
FPT_CLSEI_FT.V.TYPE#
      6861**DCL      6861--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6858**DCL      6858--REDEF    6860--REDEF
FPT_OPEN
      7076**DCL        10--PROC     7316<>CALL     7336>>ASSIGN   7342<<ASSIGN   7347<>CALL     7351--ENTRY
      7352--ASSIGN
FPT_OPEN.ACSVEH_
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:26   
      7078**DCL      7079--REDEF
FPT_OPEN.ALTKEYS_
      7084**DCL      7085--REDEF    7085--REDEF
FPT_OPEN.HDR_
      7083**DCL      7084--REDEF
FPT_OPEN.TAB_
      7082**DCL      7083--REDEF
FPT_OPEN.UHL_
      7076**DCL      7077--REDEF    7077--REDEF
FPT_OPEN.V
      7085**DCL      7343--ASSIGN
FPT_OPEN.V.DCB#
      7085**DCL      7345<<ASSIGN
FPT_OPEN.V.FSN#
      7116**DCL      7116--REDEF    7116--REDEF
FPT_OPEN.V.INITZ.REASSIGN#
      7086**DCL      7298>>IF       7335>>IF       7344<<ASSIGN
FPT_OPEN.V.OPER.TEST#
      7087**DCL      7298>>IF
FPT_OPEN.V_
      7076**DCL      7343<<ASSIGN
FPT_OPEN.WSN_
      7082**DCL      7082--REDEF
FPT_OPEN_EI.ACSVEH_
      6419**DCL      6420--REDEF
FPT_OPEN_EI.ALTKEYS_
      6425**DCL      6426--REDEF    6426--REDEF
FPT_OPEN_EI.HDR_
      6424**DCL      6425--REDEF
FPT_OPEN_EI.TAB_
      6423**DCL      6424--REDEF
FPT_OPEN_EI.UHL_
      6417**DCL      6418--REDEF    6418--REDEF
FPT_OPEN_EI.V.FSN#
      6457**DCL      6457--REDEF    6457--REDEF
FPT_OPEN_EI.WSN_
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:27   
      6423**DCL      6423--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6528**DCL      6529--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6534**DCL      6535--REDEF    6535--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6533**DCL      6534--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6532**DCL      6533--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6526**DCL      6527--REDEF    6527--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6566**DCL      6566--REDEF    6566--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6532**DCL      6532--REDEF
FPT_OPEN_OUT.ACSVEH_
      6310**DCL      6311--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6316**DCL      6317--REDEF    6317--REDEF
FPT_OPEN_OUT.HDR_
      6315**DCL      6316--REDEF
FPT_OPEN_OUT.TAB_
      6314**DCL      6315--REDEF
FPT_OPEN_OUT.UHL_
      6308**DCL      6309--REDEF    6309--REDEF
FPT_OPEN_OUT.V.FSN#
      6348**DCL      6348--REDEF    6348--REDEF
FPT_OPEN_OUT.WSN_
      6314**DCL      6314--REDEF
FPT_OPEN_OUT_SAVE
      6199**DCL      7342>>ASSIGN
FPT_OPEN_OUT_SAVE.ACSVEH_
      6201**DCL      6202--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6207**DCL      6208--REDEF    6208--REDEF
FPT_OPEN_OUT_SAVE.HDR_
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:28   
      6206**DCL      6207--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6205**DCL      6206--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6199**DCL      6200--REDEF    6200--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6239**DCL      6239--REDEF    6239--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6205**DCL      6205--REDEF
FPT_OPEN_SETUP_EO
      7185**DCL      7336<<ASSIGN   7341<>CALL
FPT_OPEN_SETUP_EO.ACSVEH_
      7187**DCL      7188--REDEF
FPT_OPEN_SETUP_EO.ALTKEYS_
      7193**DCL      7194--REDEF    7194--REDEF
FPT_OPEN_SETUP_EO.HDR_
      7192**DCL      7193--REDEF
FPT_OPEN_SETUP_EO.TAB_
      7191**DCL      7192--REDEF
FPT_OPEN_SETUP_EO.UHL_
      7185**DCL      7186--REDEF    7186--REDEF
FPT_OPEN_SETUP_EO.V
      7194**DCL      7337--ASSIGN
FPT_OPEN_SETUP_EO.V.DCB#
      7194**DCL      7345>>ASSIGN
FPT_OPEN_SETUP_EO.V.FSN#
      7225**DCL      7225--REDEF    7225--REDEF
FPT_OPEN_SETUP_EO.V.INITZ.REASSIGN#
      7195**DCL      7339<<ASSIGN
FPT_OPEN_SETUP_EO.V.OPER.TEST#
      7196**DCL      7340<<ASSIGN
FPT_OPEN_SETUP_EO.V.SETDCB#
      7195**DCL      7338<<ASSIGN
FPT_OPEN_SETUP_EO.V_
      7185**DCL      7337<<ASSIGN
FPT_OPEN_SETUP_EO.WSN_
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:29   
      7191**DCL      7191--REDEF
FPT_READ_STD.STATION_
      6629**DCL      6630--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6641**DCL      6641--REDEF
FPT_READ_STD.V.INDX#
      6639**DCL      6639--REDEF
FPT_READ_UC.STATION_
      6590**DCL      6591--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6602**DCL      6602--REDEF
FPT_READ_UC.V.INDX#
      6600**DCL      6600--REDEF
FPT_WRITE_ME.STATION_
      6698**DCL      6698--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6705**DCL      6705--REDEF
FPT_WRITE_OUT.STATION_
      6729**DCL      6729--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6736**DCL      6736--REDEF
FPT_WRITE_UC.STATION_
      6667**DCL      6667--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6674**DCL      6674--REDEF
FROM_SN.SN
      5573**DCL      5574--REDEF
FSFA_ALT
      7370**LABEL    7316--CALLALT  7360--CALLALT
GETCMD.OUT$
      4780**DCL      4786--REDEF
ICB.FID.STRING
      5597**DCL      5598--REDEF
IFSFA_PARAM.EOMCHAR#
      5952**DCL      5953--REDEF
IFSFA_PARAM.SIG1
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:30   
      5946**DCL      5946--REDEF
IFSFA_PARAM.SIG2
      5946**DCL      5947--REDEF
IN_RES
      5519**DCL      5519--REDEF
IN_SN.SN
      5535**DCL      5536--REDEF
M$CLOSE
        37**DCL-ENT  7358--CALL
M$OPEN
        37**DCL-ENT  7341--CALL     7347--CALL
OBBUF_PTR$
      5926**DCL      7312<>CALL     7313>>ASSIGN   7379>>IF       7381<>CALL
OBBUF_WSIZE
      5927**DCL      7311<<ASSIGN   7312<>CALL     7314>>ASSIGN   7381<>CALL
OCB.BIN
      5253**DCL      7298>>IF
OCB.CRPT
      5238**DCL      7298>>IF
OCB.TRANS
      5254**DCL      7298>>IF
OCB.TYPE
      5281**DCL      5282--REDEF
OFSFA_PARAM
      5966**DCL      7316<>CALL     7360<>CALL
OFSFA_PARAM.BBUF_.BOUND
      5974**DCL      7314<<ASSIGN
OFSFA_PARAM.BBUF_.BUF$
      5975**DCL      7313<<ASSIGN
OFSFA_PARAM.EOMCHAR#
      5982**DCL      5983--REDEF
OFSFA_PARAM.ERR
      5970**DCL      7370>>ASSIGN
OFSFA_PARAM.KBUF_.BOUND
      5972**DCL      7309<<ASSIGN
OFSFA_PARAM.KBUF_.BUF$
PL6.E3A0      #001=VPC$CALL_OPEN File=VPC$SETOUT.:E05TSI                         WED 07/30/97 07:19 Page:31   
      5973**DCL      7308<<ASSIGN
OFSFA_PARAM.ORG
      5981**DCL      7318>>IF       7327>>IF
OFSFA_PARAM.SIG1
      5976**DCL      5976--REDEF
OFSFA_PARAM.SIG2
      5976**DCL      5977--REDEF
OKBUF_PTR$
      5927**DCL      7307<>CALL     7308>>ASSIGN   7329<>CALL     7375>>IF       7377<>CALL
OUTPUT_ERR
      5157**DCL      7366<<ASSIGN   7370<<ASSIGN
OUT_SN.SN
      5553**DCL      5554--REDEF
PMME_ALT
      7366**LABEL    7341--CALLALT  7347--CALLALT  7358--CALLALT
PMME_CLOSE
      7358**LABEL    7355--GOTO
PMME_OPEN
      7334**LABEL    7305--GOTO     7307--CALLALT  7312--CALLALT
SPEC_BUF
      5231**DCL      5231--REDEF
VPD$GET_BUF
      7293**DCL-ENT  7307--CALL     7312--CALL
VPD$REL_BUF
      7294**DCL-ENT  7329--CALL     7377--CALL     7381--CALL
WRITE_MODE
      5926**DCL      7321<<ASSIGN   7326<<ASSIGN   7348<<ASSIGN   7356>>DOCASE
XSA$CLOSE
      7296**DCL-ENT  7360--CALL
XSA$OPEN
      7295**DCL-ENT  7316--CALL

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:32   
      137        1        /*T***********************************************************/
      138        2        /*T*                                                         */
      139        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      140        4        /*T*                                                         */
      141        5        /*T***********************************************************/
      142        6        /*F* NAME: VPC$SETOUT
      143        7             PURPOSE: To process the output specification of a PCL command.
      144        8             DESCRIPTION: This module processes PCL's output specification. It
      145        9                          validates all options, sets up OCB, and
      146       10                          opens the output file.
      147       11        */
      148       12        VPC$SETOUT: PROC(OUT_SPEC$);
      149       13        /*D* NAME: VPC$SETOUT
      150       14             CALL: CALL VPC$SETOUT(OUT_SPEC$);
      151       15                    where OUT_SPEC$ is a pointer to the output specification head
      152       16                    node and must be present.  If it is NIL, a default is used.
      153       17             DESCRIPTION: This procedure opens the output file if no errors are
      154       18                          encountered on processing the input specification.
      155       19                          If an output specification is present (OUT_SPEC$~=ADDR(NIL))
      156       20                          it is checked for validity, its options processed, and
      157       21                          if no errors have occured, the file is opened CREATE.
      158       22                          If no output specification is present and the command is
      159       23                          COPY, the last opened COPY output file is opened CREATE,
      160       24                          OLDFILE. If no output
      161       25                          specification is present and the command is not COPY,
      162       26                          the output file is opened CREATE, NEWFILE to the default
      163       27                          destination for that command(user's public disk srea for
      164       28                          COPYALL, COPYSTD, and COPYLIST; device ME for all other
      165       29                          commands).
      166       30        */
      167       31        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:33   
      168       32        /**/
      169       33        /*  INCLUDE FILES  */
      170       34        /**/
      171       35        %INCLUDE VP_DATA_R;
      172     7022        %INCLUDE B_ERRORS_C;
      173     8149        %INCLUDE F$DCB;
      174     8198        %INCLUDE FM$FIT;
      175     8419        /**/
      176     8420        /*  PARAMETERS  */
      177     8421        /**/
      178     8422    1   DCL OUT_SPEC$ PTR;                      /* POINTER TO OUT_SPEC SUB_TREE       */
      179     8423        /**/
      180     8424        /*  BASED STRUCTURES  */
      181     8425        /**/
      182     8426        %B$TCB;
      183     8429        %B$ALT;
      184     8437        %CODE03;
      185     8444        %CODE04;                                /* DATES in FPARAM                    */
      186     8452        %CODE16;                                /* FORM & COPIES                      */
      187     8460        %CODE18;
      188     8464        %CODE19;
      189     8467        %CODE21;
      190     8470        %PARSE$OUT(STCLASS=BASED);
      191     8515        %PARSE$SYM(STCLASS=BASED);
      192     8553        %VLP_VECTOR(FPTN=B$VECTOR,STCLASS=BASED);
      193     8568    1   DCL B$WORD UBIN BASED;
      194     8569    1   DCL 1 TEXT$C BASED,
      195     8570    1         2 LEN UBIN BYTE UNAL,
      196     8571    1         2 STRING CHAR(TEXT$C.LEN);
      197     8572    1   DCL 1 TEXT$C_ARY BASED,
      198     8573    1         2 LEN UBIN BYTE UNAL,
      199     8574    1         2 STRING(0:0) CHAR(1);
      200     8575        /**/
      201     8576        /* STATIC DATA  */
      202     8577        /**/
      203     8578    1   DCL NAME_SPEC_TYPE SBIN WORD;
      204     8579                    %FPT_FID(FPTN = FPT_FID,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:34   
      205     8580                             NAME = NAME#,
      206     8581                             ACCT = ACCT#,
      207     8582                             PASS = PASS#,
      208     8583                             SN   = OUT_SN,
      209     8584                             WSN  = WSN#,
      210     8585                             ASN  = ASN#,
      211     8586                             RES  = RES#,
      212     8587                             RESULTS = RESULTS_FID);
      213     8610        %VLR_FID(FPTN = RESULTS_FID);
      214     8629        %VLP_FPRG (STCLASS=BASED);              /* Structure of CODE17                */
      215     8650    1   DCL 1 NAME# STATIC,
      216     8651    1         2 L UBIN BYTE UNAL,
      217     8652    1         2 C CHAR(31);
      218     8653    1   DCL ACCT# CHAR(8) STATIC;
      219     8654    1   DCL PASS# CHAR(8) STATIC;
      220     8655    1   DCL PASSB# REDEF PASS# BIT(72);
      221     8656    1   DCL WSN# CHAR(8) STATIC;
      222     8657    1   DCL ASN# UBIN BYTE STATIC;
      223     8658    1   DCL RES# CHAR(4) STATIC;
      224     8659    1   DCL I SBIN WORD;
      225     8660    1   DCL J SBIN WORD;
      226     8661    1   DCL PTR$ PTR;
      227     8662    1   DCL FIELD1_ BIT(72) DALIGNED;
      228     8663    1   DCL FIELD2_ BIT(72) DALIGNED;
      229     8664    1   DCL OPT_START SBIN WORD;
      230     8665    1   DCL ERROR UBIN WORD;
      231     8666    1   DCL RECORD_SELECTION BIT(1) ALIGNED;
      232     8667    1   DCL OUT_FILE_EXISTS BIT(1);
      233     8668    1   DCL OUT_FID_GIVEN BIT(1);
      234     8669        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:35   
      235     8670        /**/
      236     8671        /*  CONSTANT  */
      237     8672        /**/
      238     8673    1   DCL CMD_ABORT_ERR(0:29) UBIN HALF UNAL CONSTANT INIT(
      239     8674    1           %E$OPER,     %E$IOERR,    %E$NORES,    %E$NOTUR,    %E$CANT,
      240     8675    1           %E$PROT,     %E$OPROT,    %E$NORING,   %E$EBCDICTAP,%E$ASCIITAP,
      241     8676    1           %E$NORSS,    %E$NONEWU,   %E$NOCFUS,   %E$NONEWFD,  %E$PSGRANS,
      242     8677    1           %E$USGRANS,  %E$ACGRANS,  %E$XCLSET,   %E$SETDOWN,  %E$MNTBRK,
      243     8678    1           %E$TAPBRK,   %E$CANTIO,   %E$VOLOUT,   0,           0,
      244     8679    1           0,           0,        0, 0, 0);/* SPARE/PATCH                        */
      245     8680        /**/
      246     8681        /* ENTRY POINTS  */
      247     8682        /**/
      248     8683    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
      249     8684        %VP_ENTRIES (OMIT=VPC$SETOUT);
      250     8892        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:36   
      251     8893    1           FPT_OPEN_OUT = FPT_OPEN_OUT_SAVE; /* Initialize the OPEN FPT          */
      252     8894    1           OUT_FID_GIVEN = %YES#;          /* Assume they gave a file name       */
      253     8895    1           IF CMD_MASK(1)                  /* IF 'COPY'...                       */
      254     8896    1            THEN
      255     8897    1              FPT_OPEN_OUT.V.DCB# = DCBNUM(M$EO);
      256     8898    1            ELSE
      257     8899    1              FPT_OPEN_OUT.V.DCB# = DCBNUM(M$EO1);
      258     8900    1           IF OUT_SPEC$ ~= ADDR(NIL)       /* If output specifications exist     */
      259     8901    1            THEN
      260     8902    2            DO;                            /* AN OUTPUT SPEC IS PRESENT          */
      261     8903    2               OCB = '0'B;                 /* Clear all output specs             */
      262     8904    2               FPT_OPEN_OUT.V.INITZ.SCRUB# = %YES#;
      263     8905    2               CALL PROCESS_FID;
      264     8906    2               CALL GET_OUT_DEV_MASK;
      265     8907    2               IF OCB.DEV_MASK & '001'O    /* If its a disk file                 */
      266     8908    2                THEN
      267     8909    3                DO;
      268     8910    3                   FPT_OPEN_OUT.V.OPER.TEST# = %YES#;
      269     8911    3                   FPT_OPEN_OUT.V.FUN# = %IN#; /* TRY TO OPEN IT FOR INPUT       */
      270     8912    3                   OUT_FILE_EXISTS = %YES#;
      271     8913    3                   CALL M$OPEN(FPT_OPEN_OUT)
      272     8914    4                    WHENALTRETURN DO;
      273     8915    4                       OUT_FILE_EXISTS = %NO#;
      274     8916    4                       END;
      275     8917    3                   FPT_OPEN_OUT.V.OPER.TEST# = %NO#;
      276     8918    3                   END;
      277     8919    2               FPT_OPEN_OUT.V.CTG# = %NO#;
      278     8920    2               FPT_OPEN_OUT.V.FUN# = %CREATE#;
      279     8921    3               DO CASE(OUT_SPEC$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);
      280     8922    3                CASE(1,2);                 /* 'TO','ON'                          */
      281     8923    3                  FPT_OPEN_OUT.V.EXIST# = %ERROR#;
      282     8924    3                CASE(3);                   /* 'OVER'                             */
      283     8925    3                  FPT_OPEN_OUT.V.EXIST# = %NEWFILE#;
      284     8926    3                CASE(4);                   /* 'INTO'                             */
      285     8927    3                  FPT_OPEN_OUT.V.EXIST# = %OLDFILE#;
      286     8928    3                END;
      287     8929    2               CALL PROCESS_OPTS;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:37   
      288     8930    2               CALL NAME_AND_FPARAM;
      289     8931    2               IF ~OUT_FID_GIVEN AND ~FPT_OPEN_OUT.V.INITZ.REASSIGN#
      290     8932    2                THEN
      291     8933    2                  CALL VPL$ERR_PROC(3,30,'03'O);
      292     8934    2               END;
      293     8935    1            ELSE                           /* NO OUTPUT SPEC                     */
      294     8936    1              IF CMD_MASK(1)               /* COPY COMMAND                       */
      295     8937    1               THEN
      296     8938    2               DO;
      297     8939    2                  IF EO_OCB ='0'B          /* If last copy bombed                */
      298     8940    2                   THEN
      299     8941    2                     GOTO DEFAULT_TO_ME;   /* Default to ME                      */
      300     8942    2                  FPT_OPEN_OUT.V.INITZ.SCRUB# = %NO#;
      301     8943    2                  OCB = EO_OCB;
      302     8944    2                  FPT_OPEN_OUT.V.FUN# = %CREATE#;
      303     8945    2                  FPT_OPEN_OUT.V.EXIST# = %OLDFILE#;
      304     8946    2                  END;
      305     8947    1               ELSE                        /* No output spec and not COPY        */
      306     8948    2               DO;
      307     8949    2                  FPT_OPEN_OUT.V.INITZ.SCRUB# = %YES#;
      308     8950    2                  FPT_OPEN_OUT.V.FUN# = %CREATE#;
      309     8951    2                  FPT_OPEN_OUT.V.EXIST# = %NEWFILE#;
      310     8952    2                  IF CMD_MASK & '14'O      /* COPYALL AND COPYSTD DEFAULT        */
      311     8953    2                   THEN                    /* TO 'OVER DP'                       */
      312     8954    3                   DO;
      313     8955    3                      OCB = '0'B;
      314     8956    3                      OCB.FLAVOR.CARRY_ATTR = %YES#;
      315     8957    3                      CALL NAME_AND_FPARAM;
      316     8958    3                      OCB = '0'B;
      317     8959    3                      OCB.FLAVOR.CARRY_ATTR = %YES#;
      318     8960    3                      FPT_OPEN_OUT.V.ASN# = %FILE#;
      319     8961    3                      OCB.DEV_MASK = '001'O; /* DISK file                        */
      320     8962    3                      FPT_OPEN_OUT.V.ORG# = M$EI$->F$DCB.ORG;
      321     8963    3                      END;
      322     8964    2                   ELSE
      323     8965    3                   DO;
      324     8966    3   DEFAULT_TO_ME:     EO_OCB.DEV_MASK = '040'O;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:38   
      325     8967    3                      OCB = '0'B;
      326     8968    3                      FPT_OPEN_OUT.V.RES# = 'ME';
      327     8969    3                      FPT_OPEN_OUT.V.ASN# = %DEVICE#;
      328     8970    3                      OCB.DEV_MASK = '040'O; /* non FT device                    */
      329     8971    3                      END;
      330     8972    2                  END;
      331     8973    1           OCB.DCBNM = FPT_OPEN_OUT.V.DCB#;
      332     8974    1           OCB.DCBPTR$ = DCBADDR(OCB.DCBNM);
      333     8975        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:39   
      334     8976    1           IF OCB.FLAVOR.CARRY_ATTR AND ASN# = %TAPE#
      335     8977    1            THEN
      336     8978    2            DO;
      337     8979    2               IF OCB.ACCESS_FLG
      338     8980    2                THEN
      339     8981    2                  CALL VPD$PROCESS_CONTROLS(9,FPT_OPEN_OUT.ACCESS_);
      340     8982    2               IF OCB.ACSVEH_FLG
      341     8983    2                THEN
      342     8984    2                  CALL VPD$PROCESS_CONTROLS(10,FPT_OPEN_OUT.ACSVEH_);
      343     8985    2               IF OCB.TYPE_BIT = '0'B      /* If no TYPE specified               */
      344     8986    2                THEN
      345     8987    2                  FPT_OPEN_OUT.V.TYPE# = M$EI$->F$DCB.TYPE; /* Keep TYPE         */
      346     8988    3               IF USER_LABELS$ ~= ADDR(NIL) THEN DO;
      347     8989    3                   IF USER_LABELS$->B$WORD=0 THEN GOTO NOLBLS;
              8989                            /* No labels after all */
      348     8990    3                   ADDR(FPT_OPEN_OUT.UHL_)->B$VECTOR.PTR$ = USER_LABELS$;
      349     8991    3                   ADDR(FPT_OPEN_OUT.UHL_)->B$VECTOR.W1.VSIZE# = USER_LABELS$->B$WORD*
              8991                            80+4-1;
      350     8992    3                   END;
      351     8993    2                ELSE
      352     8994    2   NOLBLS:        FPT_OPEN_OUT.UHL_ = VECTOR(NIL);
      353     8995    2               END;
      354     8996    1           IF CMD_MASK(1)                  /* trying to be COPY                  */
      355     8997    1             AND NOT OCB.FLAVOR.FORMATTED  /* and we won't muck with it          */
      356     8998    1             AND OCB.DEV_MASK.DEVICE       /* and to a device                    */
      357     8999    1            THEN
      358     9000    2            DO;                            /* See if an FPRG is specified in FIT */
      359     9001    2               I=17;                       /* VLP_FPRG is in CODE17              */
      360     9002    2               PTR$ = FPARAM$;
      361     9003    2               CALL XSF$LOCCODP(PTR$,I) ALTRET (OPEN_IT);
      362     9004    2               FPT_OPEN_OUT.FPRG_ = VECTOR(PTR$->VLP_FPRG);
      363     9005    2               FPT_OPEN_OUT.V.ORG# = %FPRG#;
      364     9006    2               END;
      365     9007    1           IF (FPT_OPEN_OUT.V.BLKL#~=0 OR FPT_OPEN_OUT.V.RECL#~=262143)
      366     9008    1             AND OCB.ORG=0 AND FPT_OPEN_OUT.V.ASN#=%DEVICE# AND
      367     9009    2             SUBSTR(FPT_OPEN_OUT.V.RES#,0,2)='FT' THEN DO;
      368     9010    2               FPT_OPEN_OUT.V.ORG# = %FIXED#;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:40   
      369     9011    2               OCB.ORG = 2;                /* PCL's code for FIXED               */
      370     9012    2               END;
      371     9013    1   OPEN_IT:;
      372     9014    1           CALL VPC$CALL_OPEN(FPT_OPEN_OUT) ALTRET(OPEN_OUT_ALT);
      373     9015    1           IF FPT_OPEN_OUT.V.EXIST# = %OLDFILE# /* INTO                          */
      374     9016    1             AND FPT_OPEN_OUT.V.ASN# = %FILE# /* DISK                            */
      375     9017    1             AND OCB.ORG > 0               /* Specifying ORG                     */
      376     9018    1             AND ORG_TBL.ORG_MON(OCB.ORG) ~= OCB.DCBPTR$->F$DCB.ORG /* No take   */
      377     9019    1            THEN
      378     9020    2            DO;
      379     9021    2               CALL VPD$CLOSE_OUT(0);      /* Save the existing file             */
      380     9022    2               CALL VPL$ERR_PROC(3,92,'03'O); /* ABORT Command                   */
      381     9023    2               END;
      382     9024        /*E*  ERROR: VPC-00092
      383     9025              MESSAGE: You can't change ORG when a file already EXISTS.
      384     9026          MESSAGE1: This operation is INTO an existing file, so it's ORG may not be changed.
      385     9027        */
      386     9028    1           OCB.DEV_MASK.IC = OCB.DCBPTR$->F$DCB.DDEV.IC;
      387     9029    1           OCB.DEV_MASK.LP = OCB.DCBPTR$->F$DCB.DDEV.LP;
      388     9030    1           CALL VPD$GET_OUT_FLAVOR;
      389     9031    1           CALL RECONCILE_DEFAULTS_AFTER_OPEN;
      390     9032    1           IF OCB.FLAVOR.TAPE
      391     9033    1            THEN                           /* Tapes are invloved                 */
      392     9034    1              CALL VPD$CHECK_VOL(OUT_SN,0,OCB.DCBNM,,1); /* Check VOL transition */
      393     9035    1           RETURN;
      394     9036    1   OPEN_OUT_ALT:
      395     9037    1           IF BREAKS=0 AND (OUTPUT_ERR.ERR# = %E$MNTBRK OR OUTPUT_ERR.ERR# = %E$TAPBRK)
      396     9038    1            THEN
      397     9039    1              GOTO OPEN_IT;                /* CNTL-Y, GO                         */
      398     9040    1           IF NOT (CMD_MASK & '14'O)       /* IF NOT COPYSTD OR COPYALL          */
      399     9041    1            THEN
      400     9042    1              CALL VPL$ERR_PROC(3,0,,OUTPUT_ERR,,,OCB.DCBNM); /* ABORT COMMAND   */
      401     9043    1            ELSE
      402     9044    2            DO;                            /* CHECK IF THIS ERROR IS SEVERE      */
      403     9045                                                /* ENOUGH TO ABORT THE COMMAND        */
      404     9046    2               I=0;
      405     9047    3               DO WHILE(CMD_ABORT_ERR(I)~=0);
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:41   
      406     9048    3                  IF CMD_ABORT_ERR(I) = OUTPUT_ERR.ERR#
      407     9049    3                   THEN
      408     9050    3                     CALL VPL$ERR_PROC(3,0,,OUTPUT_ERR,,,OCB.DCBNM); /* ABORT CMD*/
      409     9051    3                   ELSE
      410     9052    3                     I = I+1;
      411     9053    3                  END;
      412     9054    2               CALL VPL$ERR_PROC(2,0,,OUTPUT_ERR,,,OCB.DCBNM); /* ABORT STEP     */
      413     9055                                                /* JUST ABORT THE STEP                */
      414     9056    2               END;
      415     9057        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:42   
      416     9058    1   VPC$SETMOD: ENTRY(OUT_SPEC$);
      417     9059        /*D* NAME: VPC$SETMOD
      418     9060             CALL: CALL VPC$SETMOD(OUT_SPEC$);
      419     9061             DESCRIPTION: This entry point sets up for closing
      420     9062                          all selected files from the MODIFY command while
      421     9063                          processing the output fid into NAME and PASSWORD.
      422     9064                          They are placed into OCB.MOD_NAME and
      423     9065                          OCB.MOD_PASS.
      424     9066        */
      425     9067    1           OCB = '0'B;
      426     9068    1           OCB.DCBNM = DCBNUM(M$EI);
      427     9069    1           OCB.DCBPTR$ = DCBADDR(OCB.DCBNM);
      428     9070    1           OCB.DEV_MASK = '001'O;          /* DISK file default                  */
      429     9071    1           ASN# = %FILE#;                  /* Assume FILE to modify, until M$FID */
      430     9072    1           CALL VPD$GET_OUT_FLAVOR;
      431     9073    2           DO I=0 TO OUT_SPEC$->OUT$BLK.NSUBLKS-1;
      432     9074    2              IF OUT_SPEC$->OUT$BLK.SUBLK$(I)->OUT$BLK.CODE=4
      433     9075    2               THEN
      434     9076    3               DO;                         /* A FID HAS BEEN SPECIFIED           */
      435     9077    3                  FPT_FID.TEXTFID_   = VECTOR(OUT_SPEC$->OUT$BLK.SUBLK$(I)->
      436     9078    3                    OUT$SYM.TEXT);
      437     9079    3                  CALL VPD$FID(FPT_FID);
      438     9080    3                  CALL GET_OUT_DEV_MASK;
      439     9081    3                  IF ACCT#=' '
      440     9082    3                   THEN
      441     9083    3                     RESULTS_FID.ACCT = '0'B;
      442     9084    3                  IF RESULTS_FID.ACCT
      443     9085    3                    OR RESULTS_FID.WSN
      444     9086    3                    OR RESULTS_FID.SN
      445     9087    3                   THEN
      446     9088    3                     CALL VPL$ERR_PROC(3,83,'03'O);
      447     9089        /*E*   ERROR: VPC-00083
      448     9090             MESSAGE: To FID may only contain NAME and/or PASSWORD
      449     9091        */
      450     9092    3                  IF RESULTS_FID.NAME
      451     9093    3                   THEN                    /* Process MOD name                   */
      452     9094    4                   DO;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:43   
      453     9095    4                      IF RESULTS_FID.TYPE.NAME ~= %UMF$SIMPLE_STRING#
      454     9096    4                       THEN                /* NAME was octal or quoted           */
      455     9097    5                       DO;
      456     9098    5                          NAME_SPEC_TYPE = 1; /* Consider it a single file       */
      457     9099    5                          GOTO ONE_FILE;
      458     9100    5                          END;
      459     9101    4                      CALL VPD$ANAL_NAME(NAME#,NAME_SPEC_TYPE);
      460     9102    4                      IF NAME_SPEC_TYPE = 1
      461     9103    4                       THEN                /* Single fid output                  */
      462     9104    4   ONE_FILE:             OCB.MOD_NAME = NAME#;
      463     9105    4                       ELSE                /* Wild output fid                    */
      464     9106    4                         CALL VPD$MAKE_WILD_OUT(NAME#,OCB.MOD_NAME);
      465     9107    4                      END;
      466     9108    3                  IF RESULTS_FID.PASS
      467     9109    4                   THEN DO;
      468     9110    4                      OCB.MOD_PASS_FLG = %YES#;
      469     9111    4                      IF PASSB#='0'B
      470     9112    4                       THEN
      471     9113    4                         OCB.MOD_PASS = ' '; /* This will remove any password    */
      472     9114    4                       ELSE
      473     9115    4                         OCB.MOD_PASS = PASS#;
      474     9116    4                      END;
      475     9117    3                  END;
      476     9118    2               ELSE
      477     9119    2                 CALL PROCESS_MOD_OPTS(OUT_SPEC$->OUT$BLK.SUBLK$(I));
      478     9120    2              END;
      479     9121    1           RETURN;
      480     9122        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:44   
      481     9123    1   NAME_AND_FPARAM: PROC;
      482     9124        /*I* NAME: NAME_AND_FPARAM
      483     9125             PURPOSE: To handle NAME and FPARAM transfer for COPY commands.
      484     9126             CALL: CALL NAME_AND_FPARAM;
      485     9127             DESCRIPTION: This procedure moves the name of the input file to the
      486     9128                          open fpt for the output file for COPYALL and COPYSTD commands
      487     9129                          when necessary. It also decides whether or not to
      488     9130                          transfer the FPARAM buffer from the input file to the
      489     9131                          output file.
      490     9132        */
      491     9133        /**/
      492     9134    2   DCL VECTR VECTOR;
      493     9135        /**/
      494     9136    2           IF (CMD_MASK & '14'O/* COPYALL or COPYSTD */)~='0'B
      495     9137    2             AND (OUT_SPEC$=ADDR(NIL) OR RESULTS_FID.NAME='0'B)
      496     9138    2             OR (CMD_MASK(1) AND FPT_OPEN_OUT.V.ASN#=%TAPE# AND ~RESULTS_FID.NAME AND
              9138                      ICB.SPEC_TYPE = 1)
      497     9139                                                /* Not output wildcarded              */
      498     9140    2            THEN
      499     9141    2              FPT_OPEN_OUT.NAME_ = VECTOR(DIN_NAME);
      500     9142    2           IF NOT OCB.NFA                  /* If not NFA                         */
      501     9143    2             AND OCB.FLAVOR.CARRY_ATTR     /* and trying to carry attributes     */
      502     9144    3            THEN DO;
      503     9145    3               VECTR = VECTOR (NIL);       /* For flags                          */
      504     9146    3               VBASE(VECTR) = FPARAM$;
      505     9147    3               VBOUND(VECTR) = FPARAM_BOUND;
      506     9148    3               FPT_OPEN_OUT.IFPARAM_ = VECTR;
      507     9149    3               END;
      508     9150    3           IF M$EI$->F$DCB.ORG = %VARIABLE# THEN DO; /* Damn IBM tapes!          */
      509     9151    3               FPT_OPEN_OUT.V.CNVRT#  = M$EI$->F$DCB.CNVRT;
      510     9152    3               FPT_OPEN_OUT.V.BLKL#   = M$EI$->F$DCB.BLKL;
      511     9153    3               FPT_OPEN_OUT.V.RECL#   = M$EI$->F$DCB.RECL;
      512     9154    3               FPT_OPEN_OUT.V.EBCDIC# = M$EI$->F$DCB.EBCDIC;
      513     9155    3               FPT_OPEN_OUT.V.BLOCKED# = M$EI$->F$DCB.BLOCKED;
      514     9156    3               FPT_OPEN_OUT.V.SPANNED# = M$EI$->F$DCB.SPANNED;
      515     9157    3               IF FPT_OPEN_OUT.V.SPANNED# = '0'B THEN
              9157                        /* Non-SPANNED have bogus record lengths */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:45   
      516     9158    3                  FPT_OPEN_OUT.V.RECL# = FPT_OPEN_OUT.V.RECL# - 4; /* So fix it  */
      517     9159    3               IF OCB.ORG = 0 THEN         /* NO OUTPUT ORG SPECIFIED            */
      518     9160    3                  FPT_OPEN_OUT.V.ORG# = M$EI$->F$DCB.ORG;
      519     9161    3               OCB.ORG = %MAX_ORG#;
      520     9162    4               DO WHILE (OCB.ORG > 0 AND
      521     9163    4                 ORG_TBL.ORG_MON(OCB.ORG) ~= FPT_OPEN_OUT.V.ORG#);
      522     9164    4                  OCB.ORG = OCB.ORG - 1;
      523     9165    4                  END;
      524     9166    3               END;
      525     9167    2   END NAME_AND_FPARAM;
      526     9168        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:46   
      527     9169    1   PROCESS_FID: PROC;
      528     9170        /*I* NAME: PROCESS_FID
      529     9171             PURPOSE: To parse and validate the output fid
      530     9172             CALL: CALL PROCESS_FID;
      531     9173             DESCRIPTION: The output fid is sent to M$FID to be parsed. On its
      532     9174                          successful return, the fid is checked to be sure that
      533     9175                          COPYALL and COPYSTD commands to managed disk
      534     9176                          files don't specify a filename, or that other commands
      535     9177                          to managed disk files do specify a filename. If no errors
      536     9178                          occur, the fid pieces are merged into the output file's
      537     9179                          OPEN FPT.
      538     9180        */
      539     9181        /**/
      540     9182        /*  STATIC DATA  */
      541     9183        /**/
      542     9184    2   DCL NAME_SPEC_TYPE SBIN WORD;
      543     9185    2   DCL 1 TNAME#,
      544     9186    2         2 L UBIN BYTE UNAL,
      545     9187    2         2 C CHAR(31);
      546     9188    2   DCL IDX SBIN WORD;
      547     9189        /**/
      548     9190    2           FPT_FID.TEXTFID_   = VECTOR(OUT_SPEC$->OUT$BLK.SUBLK$(1)->
      549     9191    2             OUT$BLK.SUBLK$(0)->TEXT$C.STRING);
      550     9192    2           CALL VPD$FID(FPT_FID);
      551     9193    2           IF CMD_MASK & '14'O             /* COPYALL OR COPYSTD                 */
      552     9194    2            THEN                           /* ARE THE ONLY COMMANDS WHERE        */
      553     9195                                                /* ASN=FILE# FIDS WITH A BLANK        */
      554     9196                                                /* OR NONEXISTANT FILENAME ARE        */
      555     9197                                                /* REQUIRED OR TOLERATED              */
      556     9198    3            DO;
      557     9199    3               IF RESULTS_FID.NAME
      558     9200    3                THEN
      559     9201    4                DO;
      560     9202    4                   IF RESULTS_FID.TYPE.NAME ~= %UMF$SIMPLE_STRING#
      561     9203    4                    THEN                   /* NAME was octal or quoted           */
      562     9204    5                    DO;
      563     9205    5                       NAME_SPEC_TYPE = 1; /* Consider as single file            */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:47   
      564     9206    5                       GOTO SINGLE_FILE;
      565     9207    5                       END;
      566     9208    4                   CALL VPD$ANAL_NAME(NAME#,NAME_SPEC_TYPE);
      567     9209    4                   IF NAME_SPEC_TYPE = 1
      568     9210    4                    THEN
      569     9211    4   SINGLE_FILE:       CALL VPL$ERR_PROC(3,86,'03'O);
      570     9212    4                   IF NAME_SPEC_TYPE ~= 4 AND NAME_SPEC_TYPE ~= 5
      571     9213    4                    THEN                   /* No wildcard for output             */
      572     9214    4                      RESULTS_FID.NAME = %NO#;
      573     9215    4                    ELSE                   /* Make an output name                */
      574     9216    5                    DO;
      575     9217    5                       TNAME# = NAME#;
      576     9218    5                       CALL VPD$MAKE_WILD_OUT(TNAME#,NAME#);
      577     9219    5                       END;
      578     9220    4                   END;
      579     9221    3               END;
      580     9222        /*E* ERROR:   VPC-00086
      581     9223             MESSAGE: Filename not allowed
      582     9224            MESSAGE1: Filename not allowed in destination fid
      583     9225        */
      584     9226    2            ELSE                           /* Vanilla COPY, LIST, etc.           */
      585     9227    3            DO;
      586     9228    3               IF ASN#=%FILE#
      587     9229    3                THEN                       /* FILE, NAME is required             */
      588     9230    4                DO;
      589     9231    4                   IF ~RESULTS_FID.NAME
      590     9232    4                    THEN                   /* NAME required but missing          */
      591     9233    4                      OUT_FID_GIVEN = %NO#;
      592     9234        /*E* ERROR:   VPC-00030
      593     9235             MESSAGE: Filename needed
      594     9236            MESSAGE1: Filename needed but not available in destination fid
      595     9237        */
      596     9238    4                   IF RESULTS_FID.TYPE.NAME = %UMF$SIMPLE_STRING# /* Straight    */
      597     9239    4                    THEN                   /* May (accidently) contain '?'       */
      598     9240    5                    DO;
      599     9241    5                       CALL INDEX(IDX,'?',NAME#.C);
      600     9242    5                       IF IDX < NAME#.L
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:48   
      601     9243    5                        THEN               /* Vanilla COPY NAME contains '?'     */
      602     9244    5                          CALL VPL$ERR_PROC(3,91,'03'O);
      603     9245    5                       END;
      604     9246        /*E* ERROR:   VPC-00091
      605     9247             MESSAGE: Wildcarding not legal here
      606     9248            MESSAGE1: COPY command may not have a wildcard output name
      607     9249        */
      608     9250    4                   END;
      609     9251    3                ELSE                       /* Not a FILE                         */
      610     9252    3                  ;                        /* Don't bother checking NAME         */
      611     9253    3               END;
      612     9254    2           IF RESULTS_FID.NAME
      613     9255    2            THEN
      614     9256    2              FPT_OPEN_OUT.NAME_ = VECTOR(NAME#);
      615     9257    2           IF RESULTS_FID.ACCT
      616     9258    2            THEN
      617     9259    2              FPT_OPEN_OUT.ACCT_ = VECTOR(ACCT#);
      618     9260    2           IF RESULTS_FID.PASS
      619     9261    2            THEN
      620     9262    2              FPT_OPEN_OUT.PASS_ = VECTOR(PASS#);
      621     9263    2           IF RESULTS_FID.SN
      622     9264    2            THEN
      623     9265    2              FPT_OPEN_OUT.SN_ = VECTOR(OUT_SN);
      624     9266    2           IF RESULTS_FID.WSN
      625     9267    2            THEN
      626     9268    2              FPT_OPEN_OUT.WSN_ = VECTOR(WSN#);
      627     9269    2           IF RESULTS_FID.RES
      628     9270    2            THEN
      629     9271    2              FPT_OPEN_OUT.V.RES# = RES#;
      630     9272    2           FPT_OPEN_OUT.V.ASN# = ASN#;
      631     9273    2           RETURN;
      632     9274    2   END PROCESS_FID;
      633     9275        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:49   
      634     9276    1   GET_OUT_DEV_MASK: PROC;
      635     9277        /*I* NAME: GET_OUT_DEV_MASK
      636     9278             PURPOSE: To produce a code indicating which type device the output fid is
      637     9279             CALL: CALL GET_OUT_DEV_MASK
      638     9280             DESCRIPTION: The output file is examined to determine which device type
      639     9281                          it is. The results are placed in OCB.DEV_MASK (BIT(9))
      640     9282                          which takes on the following values:
      641     9283                            OCTAL VALUE          DEVICE TYPE
      642     9284                            -----------          -----------
      643     9285                                1             disk file
      644     9286                                2             labeled tape file
      645     9287                                4             free tape
      646     9288                               10             LP set  ***NOT YET VALID
      647     9289                               20             IC set  ***NOT YET VALID
      648     9290                               40             non-FT device
      649     9291                              100             comgroup
      650     9292        */
      651     9293        /**/
      652     9294        /*  STATIC DATA  */
      653     9295        /**/
      654     9296    2   DCL RES CHAR(2);
      655     9297    3           DO CASE(ASN#);
      656     9298    3            CASE(%FILE#);
      657     9299    3              OCB.DEV_MASK = '001'O;
      658     9300    3            CASE(%TAPE#);
      659     9301    3              OCB.DEV_MASK = '002'O;
      660     9302    3            CASE(%DEVICE#);
      661     9303    3              RES = SUBSTR(RES#,0,2);
      662     9304    3              IF RES = 'MT' OR RES = 'FT'
      663     9305    3               THEN                        /* FREE TAPE                          */
      664     9306    3                 OCB.DEV_MASK = '004'O;
      665     9307    3               ELSE                        /* NON-FT device                      */
      666     9308    3                 OCB.DEV_MASK = '040'O;
      667     9309    3            CASE(%COMGROUP#);
      668     9310    3              OCB.DEV_MASK = '100'O;
      669     9311    3            END;                           /* END CASE                           */
      670     9312    2           RETURN;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:50   
      671     9313    2   END GET_OUT_DEV_MASK;
      672     9314        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:51   
      673     9315    1   RECONCILE_DEFAULTS_AFTER_OPEN: PROC;
      674     9316        /*I* NAME:  RECONCILE_DEFAULTS_AFTER_OPEN
      675     9317             CALL:  CALL RECONCILE_DEFAULTS_AFTER_OPEN;
      676     9318             DESCRIPTION:  This routine decides on certain defaults AFTER all
      677     9319                           the options have been processed and after the OPEN.
      678     9320
      679     9321                           The main idea is to take any option that still is
      680     9322                           marked 'default', and put a definitive value there.
      681     9323        */
      682     9324        /*  This routine must be called after VPD$GET_OUT_FLAVOR                      */
      683     9325        /*  If writing in X/X1/OCT dump format, certain attributes default.           */
      684     9326        /*  If writing with KEYS, these same items default depending on the           */
      685     9327        /*  length of the key for this particular record.  The code for this must     */
      686     9328        /*  reside in VPG$WRITE.                                                      */
      687     9329        /**/
      688     9330    2           IF OCB.OCT_HEX.TYPE = 0         /* Not a dump format                  */
      689     9331    2            THEN
      690     9332    2              GOTO NO_DUMP;
      691     9333    2           IF OCB.KEY.FORMAT = '0'B
      692     9334    2            THEN
      693     9335    3            DO;
      694     9336    3               OCB.KEY.FORMAT.S = %YES#;
      695     9337    3               OCB.KEY.FORMAT.O = %YES#;
      696     9338    3               OCB.KEY.FORMAT.C = %YES#;
      697     9339    3               OCB.KEY.FORMAT.E = %YES#;
      698     9340    3               END;
      699     9341    2           IF OCB.KEY.DVBYTE = 0
      700     9342    2            THEN
      701     9343    2              OCB.KEY.DVBYTE = 2;          /* DO                                 */
      702     9344    2           IF OCB.KEY.RECSIZ = 0
      703     9345    2            THEN
      704     9346    2              OCB.KEY.RECSIZ = 2;          /* DO                                 */
      705     9347    2           IF OCB.KEY.ONDATA = 0
      706     9348    2            THEN
      707     9349    2              OCB.KEY.ONDATA = 1;          /* DONT                               */
      708     9350    2   NO_DUMP: ;
      709     9351        /**/
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:52   
      710     9352    2           RETURN;
      711     9353    2   END RECONCILE_DEFAULTS_AFTER_OPEN;
      712     9354        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:53   
      713     9355    1   PROCESS_OPTS: PROC(OPTS$);
      714     9356        /*I* NAME: PROCESS_OPTS
      715     9357             PURPOSE: To accept, validate, and act upon all output options input
      716     9358             CALL: CALL PROCESS_OPTS;
      717     9359             DESCRIPTION: PROCESS_OPTS first obtains the output file organization
      718     9360                          and checks it to be sure it is allowed for the output device
      719     9361                          and that no more than one organization option was given.
      720     9362                          It then proceeds to check each option by the following tests:
      721     9363                            1) Is it allowed for this command?
      722     9364                            2) Is it allowed for this output device?
      723     9365                            3) Is it allowed for this output organization?
      724     9366                            4) Is it a conflicting or duplicate option?
      725     9367                          If it passes all these tests successfully, PROCESS_OUTPUT_OPTION
      726     9368                          is called for further handling of this option.
      727     9369                          OPT$ is unused for this proc; it is used in PROCESS_MOD_OPTS
      728     9370                          only.
      729     9371        */
      730     9372        /**/
      731     9373        /*  PARAMETERS  */
      732     9374        /**/
      733     9375    2   DCL OPTS$ PTR;
      734     9376        /**/
      735     9377        /*  STATIC DATA  */
      736     9378        /**/
      737     9379    2   DCL OPTIONS$ PTR;
      738     9380    2   DCL HIGHEST_SEV SBIN WORD;
      739     9381    2   DCL I SBIN WORD;
      740     9382    2   DCL J SBIN WORD;
      741     9383    2   DCL OPT_IDX SBIN;
      742     9384    2   DCL DUP_IDX SBIN;
      743     9385    2   DCL OPTION_CODE SBIN WORD;
      744     9386    2   DCL ORG_CODE SBIN WORD;
      745     9387    2   DCL ORG_MASK(0:35) BIT(1) UNAL;         /* For option verification by ORG     */
      746     9388    2   DCL CON_DUP_TBL(0:65) UBIN BYTE UNAL;
      747     9389        /**/
      748     9390        /*  CONSTANT DATA  */
      749     9391        /**/
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:54   
      750     9392    2   DCL 1 OPT_TABLE(0:%(MAX_OUT_OP#+3)) CONSTANT, /* NOTE the extra three options */
      751     9393                                                /* these are RESERVED for patching!   */
      752     9394                                                /* do NOT use for new-in-source       */
      753     9395                                                /* expansion of PCL!                  */
      754     9396    2         2 NAME,
      755     9397    2           3 LEN UBIN BYTE UNAL INIT(0,
      756     9398                    /*K* LEN = VALUE-DEC. Indexed by the option code, LEN
      757     9399                    contains the length (in characters) of the option NAME.           */
      758     9400    2             06,06,07,06,05,
      759     9401    2             04,02,02,10,03,
      760     9402    2             07,06,06,05,09,
      761     9403    2             09,04,04,02,02,
      762     9404    2             05,06,06,03,07,
      763     9405    2             03,03,12,03,12,
      764     9406    2             05,08,04,09,07,
      765     9407    2             07,05,03,02,04,
      766     9408    2             02,10,03,06,05,
      767     9409    2             01,10,04,04,08,
      768     9410    2             06,08,06,02,08,
      769     9411    2             07,05,07,07,11,
      770     9412    2             05,06,04,04,05,
      771     9413    2             05,11,12,04,05,
      772     9414    2             04,06,05,04,05,
      773     9415    2             08,07,04,03,06,
      774     9416    2             07,07,07,08,08,
      775     9417    2             09,07,07,07)  ,               /* Spares at the END                  */
      776     9418    2           3 NAME CHAR(12) UNAL INIT(' ',
      777     9419                    /*K* NAME = VALUE-CHAR(12). Indexed by the option code, NAME
      778     9420                    contains the option name.                                         */
      779     9421    2             'ACCESS      ','NCNVRT      ','NBINARY     ','BINARY      ','BLOCK       '
              9421                      ,
      780     9422    2             'CRPT        ','CS          ','CR          ','COMPRESSED  ','DSP         '
              9422                      ,
      781     9423    2             'DENSITY     ','EBCDIC      ','EXPIRE      ','XTEND       ','VOLACCESS   '
              9423                      ,
      782     9424    2             'KEYLENGTH   ','KEYX        ','KEYS        ','LC          ','LN          '
              9424                      ,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:55   
      783     9425    2             'LRDL0       ','LSLIDE      ','MAXVOL      ','AMR         ','NBLANKS     '
              9425                      ,
      784     9426    2             'NCR         ','NCS         ','NFATTRIBUTES','NLN         ','ORGANIZATION'
              9426                      ,
      785     9427    2             'OCTAL       ','IXTNSIZE    ','READ        ','RECLENGTH   ','RELEASE     '
              9427                      ,
      786     9428    2             'XTNSIZE     ','SPARE       ','SSP         ','TX          ','TYPE        '
              9428                      ,
      787     9429    2             'UC          ','ACSVEHICLE  ','VFC         ','VOLUME      ','WRITE       '
              9429                      ,
      788     9430    2             'X           ','NUMRECORDS  ','FVFC        ','NVFC        ','NRELEASE    '
              9430                      ,
      789     9431    2             'NEWKEY      ','NSPANNED    ','BACKUP      ','X1          ','NBLOCKED    '
              9431                      ,
      790     9432    2             'RECSIZE     ','SHARE       ','NBACKUP     ','REBUILD     ','TRANSPARENT '
              9432                      ,
      791     9433    2             'VREAD       ','VWRITE      ','SVFC        ','WRAP        ','NWRAP       '
              9433                      ,
      792     9434    2             'WIDTH       ','NCOMPRESSED ','NTRANSPARENT','HEAD        ','NHEAD       '
              9434                      ,
      793     9435    2             'FORM        ','COPIES      ','NPAGE       ','PAGE        ','NLOAD       '
              9435                      ,
      794     9436    2             'NSUMMARY    ','SUMMARY     ','SAVE        ','UFA         ','ALTBLD      '
              9436                      ,
      795     9437    2             'NALTBLD     ','GHSTACS     ','IOERROK     ','NIOERROK    ',
      796     9438    2             'ANSISPAN    ','NANSISPAN   ',
      797     9439    2             'SPARE3!     ','SPARE2!     ','SPARE1!     '),
      798     9440    2         2 ORG_ALLOWED BIT(36) UNAL INIT('0'O,
      799     9441                    /*K* ORG_ALLOWED = VALUE-BIT(36). Indexed by the option code,
      800     9442                    ORG_ALLOWED masks the allowable organizations for which this
      801     9443                    option is allowed. Organizations mask as below:
      802     9444                        OCTAL VALUE       ORGANIZATION
      803     9445                        -----------       ------------
      804     9446                        200000000000      Consecutive
      805     9447                        100000000000      Fixed
      806     9448                         40000000000      Indexed
      807     9449                         20000000000      Keyed
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:56   
      808     9450                         10000000000      Relative
      809     9451                          4000000000      Undefined
      810     9452                          2000000000      Variable
      811     9453                          1000000000      Random
      812     9454                           400000000      UR
      813     9455                           200000000      IDS
      814     9456                           100000000      Restricted
      815     9457                            40000000      Irel
      816     9458                            20000000      Free
      817     9459                            10000000      Symbiont
      818     9460                             4000000      Comgroup
      819     9461                             2000000      Terminal
      820     9462                             1000000      Forms Program
      821     9463                              400000      Handler
      822     9464                              200000      DBGDCB
      823     9465                              100000      DBGCG
      824     9466                               40000      DBGSYSID
      825     9467                               20000      Screen Edit
      826     9468                               10000      X364 */
      827     9469    2           '377777777777'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9469                    '377777770000'O,
      828     9470    2           '337777770000'O,'377777770000'O,'377777770000'O,'220400000000'O,
              9470                    '377777770000'O,
      829     9471    2           '377777770000'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9471                    '377777770000'O,
      830     9472    2           '040000000000'O,'040000000000'O,'376577770000'O,'377777770000'O,
              9472                    '000000000000'O,
      831     9473    2           '060040000000'O,'060040000000'O,'377777770000'O,'377777770000'O,
              9473                    '377777770000'O,
      832     9474    2           '377777770000'O,'377777770000'O,'377777770000'O,'000000000000'O,
              9474                    '000000000000'O,
      833     9475    2           '377777770000'O,'271640000000'O,'377777770000'O,'377777770000'O,
              9475                    '260400000000'O,
      834     9476    2           '271640000000'O,'060040000000'O,'377777770000'O,'377777770000'O,
              9476                    '377777770000'O,
      835     9477    2           '377777770000'O,'377777777777'O,'377777770000'O,'377777770000'O,
              9477                    '377777770000'O,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:57   
      836     9478    2           '377777770000'O,'010000000000'O,'377777770000'O,'377777770000'O,
              9478                    '377777770000'O,
      837     9479    2           '070040000000'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9479                    '377777770000'O,
      838     9480    2           '377777770000'O,'071254000000'O,'377777770000'O,'060040000000'O,
              9480                    '377777770000'O,
      839     9481    2           '377777770000'O,'271645000000'O,'377777770000'O,'376477770000'O,
              9481                    '376477770000'O,
      840     9482    2           '377777770000'O,'220400000000'O,'376477770000'O,'376477770000'O,
              9482                    '377777770000'O,
      841     9483    2           '377777770000'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9483                    '377777770000'O,
      842     9484    2           '377777770000'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9484                    '040040000000'O,
      843     9485    2           '040040000000'O,'377777770000'O,'377777770000'O,'377777770000'O,
      844     9486    2           '377000000000'O,'377000000000'O,
      845     9487    2           '333333333333'O,'222222222222'O,'111111111111'O),
      846     9488    2         2 DEV_ALLOWED BIT(18) UNAL INIT('0'O,
      847     9489                    /*K* DEV_ALLOWED = VALUE-BIT(18). Indexed by option code, DEV_ALLOWED
      848     9490                    masks the allowable devices for which this option is allowed.
      849     9491                    Devices mask as below:
      850     9492                            OCTAL VALUE          DEVICE TYPE
      851     9493                            -----------          -----------
      852     9494                                1             disk file
      853     9495                                2             labeled tape file
      854     9496                                4             free tape
      855     9497                               10             LP set  ***NOT YET VALID
      856     9498                               20             IC set  ***NOT YET VALID
      857     9499                               40             non-FT device
      858     9500                              100             comgroup                                */
      859     9501    2           '003'O,'002'O,'177'O,'177'O,'006'O,
      860     9502    2           '001'O,'177'O,'177'O,'001'O,'073'O,
      861     9503    2           '006'O,'006'O,'003'O,'002'O,'002'O,
      862     9504    2           '003'O,'003'O,'177'O,'177'O,'003'O,
      863     9505    2           '003'O,'003'O,'002'O,'177'O,'177'O,
      864     9506    2           '177'O,'177'O,'003'O,'177'O,'177'O,
      865     9507    2           '177'O,'001'O,'003'O,'007'O,'001'O,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:58   
      866     9508    2           '001'O,'003'O,'073'O,'177'O,'003'O,
      867     9509    2           '177'O,'003'O,'173'O,'006'O,'003'O,
      868     9510    2           '177'O,'003'O,'173'O,'173'O,'001'O,
      869     9511    2           '001'O,'006'O,'001'O,'177'O,'006'O,
      870     9512    2           '177'O,'001'O,'001'O,'001'O,'075'O,
      871     9513    2           '003'O,'003'O,'073'O,'177'O,'177'O,
      872     9514    2           '177'O,'001'O,'075'O,'077'O,'077'O,
      873     9515    2           '073'O,'073'O,'077'O,'077'O,'003'O,
      874     9516    2           '177'O,'177'O,'177'O,'103'O,'001'O,
      875     9517    2           '001'O,'177'O,'006'O,'006'O,'006'O,
      876     9518    2           '006'O,'333'O,'222'O,'111'O)  ,
      877     9519    2         2 CMD_ALLOWED BIT(36) UNAL INIT('0'O,
      878     9520                    /*K* CMD_ALLOWED = VALUE-BIT(36). Indexed by option code, CMD_ALLOWED
      879     9521                    masks the allowable commands for which this option is valid.
      880     9522                    Commands of interest are:
      881     9523                        OCTAL VALUE        COMMAND
      882     9524                        -----------        -------
      883     9525                        20000              COPY
      884     9526                        10000              COPYALL
      885     9527                         4000              COPYSTD
      886     9528                           40              LIST
      887     9529                           20              LISTSTD
      888     9530                            4              MODIFY                                     */
      889     9531    2           '3406400002'O, '3406000002'O, '3406000002'O, '3406000002'O, '3406000002'O,
      890     9532    2           '3406000002'O, '3406000002'O, '3400000000'O, '3406000002'O, '3406000002'O,
      891     9533    2           '3406000002'O, '3406000002'O, '3406400002'O, '3406000002'O, '3400000000'O,
      892     9534    2           '3406000002'O, '3406000002'O, '3406000002'O, '3400000000'O, '3406000002'O,
      893     9535    2           '3406400002'O, '3406400002'O, '3406000002'O, '3406000002'O, '3406000002'O,
      894     9536    2           '3400000000'O, '3406000002'O, '3400000000'O, '3406000002'O, '3406000002'O,
      895     9537    2           '3400000000'O, '3406000002'O, '3406400002'O, '3406000002'O, '3406400002'O,
      896     9538    2           '3406400002'O, '3406400002'O, '3406000002'O, '3400000000'O, '3406400002'O,
      897     9539    2           '3400000000'O, '3406400002'O, '3400000000'O, '3406000002'O, '3406400002'O,
      898     9540    2           '3400000000'O, '3406000002'O, '3400000000'O, '3400000000'O, '3406400002'O,
      899     9541    2           '3406000002'O, '3406000002'O, '3406400002'O, '3400000000'O, '3406000002'O,
      900     9542    2           '3400000000'O, '3406000002'O, '3406400002'O, '3400400000'O, '3400000000'O,
      901     9543    2           '3406400002'O, '3406400002'O, '3400000000'O, '3400000000'O, '3400000000'O,
      902     9544    2           '3406000002'O, '3400000000'O, '3400000000'O, '3400000000'O, '3400000000'O,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:59   
      903     9545    2           '3406000000'O, '3406000000'O, '3400000000'O, '3400000000'O, '3400000000'O,
      904     9546    2           '0006000000'O, '0006000000'O, '3406000000'O, '3406400000'O, '3400400000'O,
      905     9547    2           '3406000000'O, '3406000000'O,
      906     9548    2           '3400400000'O, '3406400000'O, '3406400000'O, '3406400000'O,
      907     9549    2           '3333333333'O,'2222222222'O,'1111111111'O);
      908     9550    2   DCL CON_DUP_IDX(0:%((MAX_OUT_OP#+3)*4+3)) CONSTANT UBIN BYTE UNAL INIT(0,0,0,0,
      909     9551                    /*K* CON_DUP_IDX = VALUE-DEC. Indexed by (option_code * 4) through
      910     9552                    (option_code*4 + 3), this table contains an index into CON_DUP_TBL.
      911     9553                    CON_DUP_TBL contains in each cell, either the option_code of
      912     9554                    another previously specified duplicate or conflicting option
      913     9555                    or 0 if no previous option has occured. 0 is a special index and
      914     9556                    denotes that this option does not conflict with any other option
      915     9557                    including itself. All options which conflict with each other
      916     9558                    then will have the same index. Any option may have up to 4 indices
      917     9559                    associated with it indicating membership in up to 4 conflict
      918     9560                    groups.                                                           */
      919     9561        /*     Some conflict groups are:
      920     9562               1 - NCNVRT
      921     9563               2 - NBINARY & BINARY
      922     9564               3 - BLOCK
      923     9565               4 - SUMMARY & NSUMMARY
      924     9566               5 - CS & NCS
      925     9567               6 - CR & NCR
      926     9568               7 - XTEND
      927     9569               8 - DENSITY
      928     9570               9 - EBCDIC
      929     9571              10 - EXPIRE
      930     9572              11 - XTEND
      931     9573              12 - NFATTBIBUTES
      932     9574              13 - KEYLENGTH
      933     9575              14 - KEYX
      934     9576              15 - LC & UC
      935     9577              16 - LN & NLN & ORG
      936     9578              17 - LRDLO
      937     9579              18 - LSLIDE
      938     9580              19 - MAXVOL
      939     9581              20 - AMR
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:60   
      940     9582              21 - NBLANKS
      941     9583              22 - IXTNSIZE
      942     9584              23 - RECL
      943     9585              24 - RELEASE & NRELEASE
      944     9586              25 - XTNSIZE
      945     9587              26 - SPARE
      946     9588              27 - TX
      947     9589              28 - TYPE
      948     9590              29 - VOLUME
      949     9591              30 - NUMRECORDS
      950     9592              31 - NEWKEY
      951     9593              32 - NSPANNED
      952     9594              33 - BACKUP
      953     9595              34 - DSP & SSP & VFC
      954     9596              35 - VFC & NVFC & SVFC
      955     9597              36 - FVFC & NVFC & SVFC
      956     9598              37 - OCTAL & VFC & X & X1
      957     9599              38 - OCTAL & X & FVFC & X1
      958     9600              39 - KEYS & VFC
      959     9601              40 - KEYS & FVFC
      960     9602              41 - NBLOCKED
      961     9603              42 - RECSIZE
      962     9604              43 - SHARE
      963     9605              44 - NBACKUP
      964     9606              45 - REBUILD
      965     9607              46 - TRANSPARENT & NTRANSPARENT
      966     9608              47 - WRAP & UNWRAP
      967     9609              48 - WIDTH
      968     9610              49 - COMPRESSED & NCOMPRESSED
      969     9611              50 - HEAD & NHEAD
      970     9612              51 - FORM
      971     9613              52 - COPIES
      972     9614              53 - PAGE & NPAGE
      973     9615              54 - ALTBLD & NALTBLD
      974     9616              55 - GHSTACS
      975     9617              56 - IOERROK & NIOERROK
      976     9618        */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:61   
      977     9619    2        0, 0, 0, 0,   1, 0, 0, 0,   2, 0, 0, 0,   2, 0, 0, 0,   3, 0, 0, 0,
      978     9620    2        0, 0, 0, 0,   5, 0, 0, 0,   6, 0, 0, 0,  49,0, 0, 0,   34, 0, 0, 0,
      979     9621    2        8, 0, 0, 0,   9, 0, 0, 0,  10, 0, 0, 0,  11, 0, 0, 0,   7, 0, 0, 0,
      980     9622    2       13, 0, 0, 0,  14, 0, 0, 0,  39,40, 0, 0,  15, 0, 0, 0,  16, 0, 0, 0,
      981     9623    2       17, 0, 0, 0,  18, 0, 0, 0,  19, 0, 0, 0,  20, 0, 0, 0,  21, 0, 0, 0,
      982     9624    2        6, 0, 0, 0,   5, 0, 0, 0,  12, 0, 0, 0,  16, 0, 0, 0,  16, 0, 0, 0,
      983     9625    2       37,38, 0, 0,  22, 0, 0, 0,   0, 0, 0, 0,  23, 0, 0, 0,  24, 0, 0, 0,
      984     9626    2       25, 0, 0, 0,  26, 0, 0, 0,  34, 0, 0, 0,  27, 0, 0, 0,  28, 0, 0, 0,
      985     9627    2       15, 0, 0, 0,   0, 0, 0, 0,  34,35,37,39,  29, 0, 0, 0,   0, 0, 0, 0,
      986     9628    2       37,38, 0, 0,  30, 0, 0, 0,  36,38,40, 0,  35,36, 0, 0,  24, 0, 0, 0,
      987     9629    2       31, 0, 0, 0,  32, 0, 0, 0,  33, 0, 0, 0,  37,38, 0, 0,  41, 0, 0, 0,
      988     9630    2       42, 0, 0, 0,  43, 0, 0, 0,  44, 0, 0, 0,  45, 0, 0, 0,  46, 0, 0, 0,
      989     9631    2        0, 0, 0, 0,   0, 0, 0, 0,  35,36, 0, 0,  47, 0, 0, 0,  47, 0, 0, 0,
      990     9632    2       48, 0, 0, 0,  49, 0, 0, 0,  46, 0, 0, 0,  50, 0, 0, 0,  50, 0, 0, 0,
      991     9633    2       51, 0, 0, 0,  52, 0, 0, 0,  53, 0, 0, 0,  53, 0, 0, 0,   0, 0, 0, 0,
      992     9634    2       04, 0, 0, 0,  04, 0, 0, 0,   0, 0, 0, 0,   0, 0, 0, 0,  54, 0, 0, 0,
      993     9635    2       54, 0, 0, 0,  55, 0, 0, 0,  56, 0, 0, 0,  56, 0, 0, 0,   0, 0, 0, 0,
      994     9636    2   0, 0, 0, 0, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1); /* SPARES at end             */
      995     9637        /******************************************************************************/
      996     9638        /******************************************************************************/
      997     9639        /******************************************************************************/
      998     9640    2   PROCESS_MOD_OPTS: ENTRY(OPTS$);
      999     9641        /*D* NAME: PROCESS_MOD_OPTS
     1000     9642             CALL: CALL PROCESS_MOD_OPTS(OPTS$);
     1001     9643             DESCRIPTION: This entry handles options for the MODIFY command. It
     1002     9644                          detects, validates and stuffs them into OCB.
     1003     9645        */
     1004     9646        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:62   
     1005     9647    2           FIELD1_ = VECTOR(NIL);
     1006     9648    2           FIELD2_ = VECTOR(NIL);
     1007     9649    2           CON_DUP_TBL = '0'B;             /* CLEAR THE TABLE                    */
     1008     9650    2           ORG_MASK = '0'B;
     1009     9651    2           HIGHEST_SEV = 0;
     1010     9652    2           IF CMD_MASK(12)                 /* IF MODIFY                          */
     1011     9653    2            THEN
     1012     9654    3            DO;
     1013     9655    3               OPTIONS$ = OPTS$;
     1014     9656    3               OPT_START = 0;
     1015     9657    3               END;
     1016     9658    2            ELSE
     1017     9659    3            DO;
     1018     9660    3               OPTIONS$ = OUT_SPEC$;
     1019     9661    3               OPT_START = 2;
     1020     9662    3               END;
     1021     9663    2           CALL DO_ORG_OPTS;               /* Process SOME options first!        */
     1022     9664    2           CALL SET_DEFAULTS;
     1023     9665    2           CALL VPL$ERR_SEV_HANDLER(HIGHEST_SEV);
     1024     9666    3           DO OPT_IDX=OPT_START TO OPTIONS$->OUT$BLK.NSUBLKS-1;
     1025     9667    3              OPTION_CODE = OPTIONS$->OUT$BLK.SUBLK$(OPT_IDX)->OUT$BLK.CODE;
     1026     9668    3              IF OPTION_CODE = 20          /* LN                                 */
     1027     9669    3                OR OPTION_CODE = 29        /* NLN (Same as ORG=CONSEC)           */
     1028     9670    3                OR OPTION_CODE = 30        /* ORG                                */
     1029     9671    3               THEN                        /* This option (somehow) sets ORG     */
     1030     9672    3                 ;                         /* This option already processed      */
     1031     9673    3               ELSE                        /* This option doesn't affect ORG     */
     1032     9674    3                 CALL CHECK_AND_PROCESS_OPT;
     1033     9675    3              END;
     1034     9676    2           CALL RECONCILE_DEFAULTS_BEFORE_OPEN;
     1035     9677    2           CALL VPL$ERR_SEV_HANDLER(HIGHEST_SEV);
     1036     9678    2           RETURN;
     1037     9679        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:63   
     1038     9680    2   BAD_OPT: PROC(SEVERITY,ERROR);
     1039     9681        /*I* NAME: BAD_OPT
     1040     9682             PURPOSE: To report error conditions and maintain HIGHEST_SEV.
     1041     9683             CALL: CALL BAD_OPT(SEVERITY,ERROR);
     1042     9684             DESCRIPTION: This procedure reports all error conditions passed to
     1043     9685                          to it as a warning severity error. It maintains the highest
     1044     9686                          severity passed to it in HIGHEST_SEV for later error handling
     1045     9687                          by a higher level procedure.
     1046     9688        */
     1047     9689        /**/
     1048     9690        /*  PARAMETERS  */
     1049     9691        /**/
     1050     9692    3   DCL SEVERITY SBIN WORD;
     1051     9693    3   DCL ERROR UBIN WORD;
     1052     9694    3           CALL VPL$ERR_PROC(1,ERROR,'03'O,,FIELD1_,FIELD2_);
     1053     9695    3           IF SEVERITY>HIGHEST_SEV
     1054     9696    3            THEN
     1055     9697    3              HIGHEST_SEV = SEVERITY;      /* MAINTAIN HIGHEST SEVERITY          */
     1056     9698    3   END BAD_OPT;
     1057     9699        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:64   
     1058     9700    2   CHECK_AND_PROCESS_OPT: PROC;
     1059     9701        /*I* NAME: CHECK_AND_PROCESS_OPT
     1060     9702             PURPOSE: To check for bad options.  This includes duplicate,
     1061     9703                      conflicting, and illegal for this command.
     1062     9704                      If the option is OK, it is processed.
     1063     9705        */
     1064     9706    3           FIELD1_ = VECTOR(OPT_TABLE.NAME(OPTION_CODE));
     1065     9707    3           IF (OPT_TABLE.CMD_ALLOWED(OPTION_CODE) & CMD_MASK)='0'B
     1066     9708    3            THEN
     1067     9709    3              CALL BAD_OPT(3,6);
     1068     9710        /*E*   ERROR: VPC-00006
     1069     9711             MESSAGE: %U1 not allowed
     1070     9712            MESSAGE1: %U1 output option not allowed for this command
     1071     9713        */
     1072     9714    3            ELSE
     1073     9715    3              IF (OPT_TABLE.DEV_ALLOWED(OPTION_CODE) & OCB.DEV_MASK)='0'B
     1074     9716    3                AND RES# ~= 'NO  '         /* Device NO, OK any option           */
     1075     9717    3               THEN
     1076     9718    3                 CALL BAD_OPT(3,7);
     1077     9719        /*E*  ERROR: VPC-00007
     1078     9720             MESSAGE: %U1 not allowed
     1079     9721            MESSAGE1: %U1 output option not allowed for this output device
     1080     9722        */
     1081     9723    3               ELSE
     1082     9724    3                 IF (OPT_TABLE.ORG_ALLOWED(OPTION_CODE) & ORG_MASK)='0'B
     1083     9725    3                   AND ORG_MASK ~= '0'B
     1084     9726    3                  THEN
     1085     9727    4                  DO;
     1086     9728    4                     FIELD2_ = VECTOR(ORG_TBL.NAME(ORG_CODE));
     1087     9729    4                     IF CMD_MASK(2) THEN   /* IF COPYALL                         */
     1088     9730    4                        CALL BAD_OPT(1,8); /* DON'T CAUSE A FULL ABORT           */
     1089     9731    4                      ELSE
     1090     9732    4                        CALL BAD_OPT(3,8);
     1091     9733    4                     END;
     1092     9734        /*E*   ERROR: VPC-00008
     1093     9735             MESSAGE: %U1 not allowed for %U2 organization
     1094     9736        */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:65   
     1095     9737    3                  ELSE
     1096     9738    4                  DO;
     1097     9739    4                     DUP_IDX=0;
     1098     9740    5                     DO WHILE(DUP_IDX<4);
     1099     9741    5                        IF CON_DUP_TBL(CON_DUP_IDX(OPTION_CODE*4+DUP_IDX))~=0 AND
     1100     9742    5                          CON_DUP_IDX(OPTION_CODE*4+DUP_IDX)~=0
     1101     9743    5                         THEN
     1102     9744    6                         DO;
     1103     9745    6                            FIELD2_ = VECTOR(OPT_TABLE.NAME(
     1104     9746    6                              CON_DUP_TBL(CON_DUP_IDX(OPTION_CODE*4+DUP_IDX))));
     1105     9747    6                            CALL BAD_OPT(3,9);
     1106     9748        /*E*   ERROR: VPC-00009
     1107     9749             MESSAGE: Conflicting or duplicate options - %U2 and %U1
     1108     9750        */
     1109     9751    6                            DUP_IDX = 5;   /* INDICATES AN ERROR CONDITION       */
     1110     9752    6                            END;
     1111     9753    5                         ELSE
     1112     9754    6                         DO;
     1113     9755    6                            CON_DUP_TBL(CON_DUP_IDX(OPTION_CODE*4+DUP_IDX)) =
              9755                                     OPTION_CODE;
     1114     9756    6                            DUP_IDX = DUP_IDX+1;
     1115     9757    6                            END;
     1116     9758    5                        END;
     1117     9759    4                     IF DUP_IDX=4          /* NO CONFLICTING OR DUP OPTION       */
     1118     9760    4                      THEN
     1119     9761    4                        CALL PROCESS_OUTPUT_OPTION(OPTIONS$->OUT$BLK.SUBLK$(OPT_IDX));
     1120     9762    4                     END;
     1121     9763    3   END CHECK_AND_PROCESS_OPT;
     1122     9764        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:66   
     1123     9765    2   DO_ORG_OPTS: PROC;
     1124     9766        /*I* NAME: DO_ORG_OPTS
     1125     9767             CALL: CALL DO_ORG_OPTS;
     1126     9768             DESCRIPTION: DO_ORG_OPTS performs a first pass over the list of output
     1127     9769                          options and takes care of certain options that MUST be
     1128     9770                          recognized before the rest can be processed.
     1129     9771
     1130     9772                          If the option affects the output organization, it is
     1131     9773                          processed and the resulting PCL code stuffed into ORG_CODE.
     1132     9774                          It also sets ORG_MASK(ORG_CODE) to be the only bit set
     1133     9775                          ORG_MASK.
     1134     9776
     1135     9777                          The scan also sets OCB.FLAVOR.FORMATTED flag if the
     1136     9778                          output record won't look like the input record.
     1137     9779        */
     1138     9780        /**/
     1139     9781        /*  STATIC DATA  */
     1140     9782        /**/
     1141     9783    3           IF NOT CMD_MASK(12)             /* IF NOT MODIFY COMMAND              */
     1142     9784    3            THEN
     1143     9785    4            DO OPT_IDX=OPT_START TO OPTIONS$->OUT$BLK.NSUBLKS-1;
     1144     9786    4               OPTION_CODE = OPTIONS$->OUT$BLK.SUBLK$(OPT_IDX)->OUT$BLK.CODE;
     1145     9787    4               IF OPTION_CODE = 18         /* KEYS                               */
     1146     9788    4                 OR OPTION_CODE = 31       /* OCTAL                              */
     1147     9789    4                 OR OPTION_CODE = 46       /* X                                  */
     1148     9790    4                 OR OPTION_CODE = 54       /* X1                                 */
     1149     9791    4                THEN
     1150     9792    4                  OCB.FLAVOR.FORMATTED = %YES#;
     1151     9793    4               IF OPTION_CODE = 20         /* LN                                 */
     1152     9794    4                 OR OPTION_CODE = 29       /* NLN (works like ORG=CONSEC)        */
     1153     9795    4                 OR OPTION_CODE = 30       /* ORG                                */
     1154     9796    4                THEN                       /* ORG is being set                   */
     1155     9797    4                  CALL CHECK_AND_PROCESS_OPT;
     1156     9798    4                ELSE                       /* This option doesn't affect ORG     */
     1157     9799    4                  ;                        /* Process it later                   */
     1158     9800    4               END;
     1159     9801    3           IF ICB.FLAVOR.MANAGED           /* Managed input                      */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:67   
     1160     9802    3             AND (OCB.DEV_MASK & '043'O)   /* MANAGED OUTPUT                     */
     1161     9803    3             AND (CMD_MASK & '34004'O)     /* A COPY-TYPE COMMAND OR MODIFY      */
     1162     9804    3             AND NOT OCB.FLAVOR.FORMATTED  /* NO RECORD FORMATTING               */
     1163     9805    3             AND NOT (NOT(OCB.DEV_MASK & '002'O) AND ICB.FLAVOR.LTOORG)
     1164     9806                                                /* NOT(LT OUTPUT) W/LT-ONLY INPUT ORG */
     1165     9807    3            THEN
     1166     9808    3              OCB.FLAVOR.CARRY_ATTR = %YES#; /* We must carry attributes         */
     1167     9809    3           IF OCB.ORG ~= 0
     1168     9810    3            THEN
     1169     9811    4            DO;
     1170     9812    4               ORG_CODE = OCB.ORG;
     1171     9813    4               FPT_OPEN_OUT.V.ORG# = ORG_TBL.ORG_MON(ORG_CODE);
     1172     9814    4               IF NOT (ORG_TBL.OUT_DEV_ALLOWED(ORG_CODE) & OCB.DEV_MASK)
     1173     9815    4                THEN
     1174     9816    5                DO;
     1175     9817    5                   FIELD1_ = VECTOR(ORG_TBL.NAME(ORG_CODE));
     1176     9818    5                   CALL BAD_OPT(3,10);
     1177     9819        /*E*   ERROR: VPC-00010
     1178     9820             MESSAGE: %U1 organization not allowed this device type
     1179     9821        */
     1180     9822    5                   END;
     1181     9823    4               END;
     1182     9824    3            ELSE                           /* NO ORG SPECIFIED...                */
     1183     9825    3              IF OCB.FLAVOR.CARRY_ATTR
     1184     9826    3               THEN
     1185     9827    4               DO;                         /* GET ORG FROM INPUT DCB             */
     1186     9828    4                  FPT_OPEN_OUT.V.ORG# = M$EI$->F$DCB.ORG;
     1187     9829    4                  ORG_CODE = %MAX_ORG#;
     1188     9830    5                  DO WHILE(ORG_CODE > 0
     1189     9831    5                    AND ORG_TBL.ORG_MON(ORG_CODE) ~= M$EI$->F$DCB.ORG);
     1190     9832    5                     ORG_CODE = ORG_CODE-1;
     1191     9833    5                     END;
     1192     9834    4                  END;
     1193     9835    3               ELSE
     1194     9836    3                 IF OCB.DEV_MASK='004'O    /* FT default org                     */
     1195     9837    4                  THEN DO;
     1196     9838    4                     FPT_OPEN_OUT.V.ORG# = %FREE#;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:68   
     1197     9839    4                     ORG_CODE = 13;
     1198     9840    4                     END;
     1199     9841    4                  ELSE DO;
     1200     9842    4                     FPT_OPEN_OUT.V.ORG# = %CONSEC#;
     1201     9843    4                     ORG_CODE = 1;
     1202     9844    4                     END;
     1203     9845    3           ORG_MASK = '0'B;
     1204     9846    3           ORG_MASK(ORG_CODE) = '1'B;
     1205     9847    3   END DO_ORG_OPTS;
     1206     9848        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:69   
     1207     9849    2   SET_DEFAULTS: PROC;
     1208     9850        /*I* NAME: SET_DEFAULTS
     1209     9851             CALL: CALL SET_DEFAULTS;
     1210     9852             DESCRIPTION: SET_DEFAULTS stuffs default OPEN parameters for the
     1211     9853                          output DCB, and sets certain defualts in OCB.
     1212     9854
     1213     9855                          This routine is invoked after the processing of
     1214     9856                          the first-pass options (DO_ORG_OPTS), but before
     1215     9857                          the setting of individual options.
     1216     9858        */
     1217     9859        /**/
     1218     9860        /*  STATIC DATA  */
     1219     9861        /**/
     1220     9862    3   DCL FORM_DEFAULT CHAR(6) STATIC;
     1221     9863    3           IF (CMD_MASK & '34'O)           /* COPY, COPYALL, or COPYSTD          */
     1222     9864    3            THEN
     1223     9865    4            DO;
     1224     9866    4               IF ICB.FLAVOR.MANAGED
     1225     9867    4                THEN                       /* IXTNSIZE can default to input file */
     1226     9868    5                DO;
     1227     9869    5                   PTR$ = ADDR(FPARAM_BUF);
     1228     9870    5                   CALL XSF$LOCCODP(PTR$,3) ALTRET(NO_CODE_3);
     1229     9871    5                   FPT_OPEN_OUT.V.IXTNSIZE# = PTR$->CODE03.UGRANS;
     1230     9872    5                   END;
     1231     9873    4                ELSE                       /* Use a suitable, constant, default  */
     1232     9874    4                  FPT_OPEN_OUT.V.IXTNSIZE# = 2;
     1233     9875    4   NO_CODE_3:
     1234     9876    4               IF M$EI$->F$DCB.ORG = ORG_TBL.ORG_MON(ORG_CODE)
     1235     9877    4                THEN
     1236     9878    5                DO CASE(ORG_CODE);
     1237     9879    5                 CASE(2);                  /* FIXED                              */
     1238     9880    5                   FPT_OPEN_OUT.V.RECL# = M$EI$->F$DCB.RECL;
     1239     9881    5                 CASE(3);                  /* INDEXED                            */
     1240     9882    5                   FPT_OPEN_OUT.V.KEYX# = M$EI$->F$DCB.KEYX;
     1241     9883    5                   FPT_OPEN_OUT.V.KEYL# = M$EI$->F$DCB.KEYL;
     1242     9884    5                 CASE(4);                  /* RELATIVE                           */
     1243     9885    5                   FPT_OPEN_OUT.V.RECL# = M$EI$->F$DCB.RECL;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:70   
     1244     9886    5                   FPT_OPEN_OUT.V.NRECS# = M$EI$->F$DCB.NRECS;
     1245     9887    5                 END;
     1246     9888    4               END;
     1247     9889        /**/
     1248     9890        /*  TYPE should be carried across by default unless attributes in             */
     1249     9891        /*  general are being left behind.                                            */
     1250     9892        /**/
     1251     9893    3           IF NOT OCB.FLAVOR.CARRY_ATTR
     1252     9894    3            THEN                           /* Output won't look like input       */
     1253     9895    4            DO;
     1254     9896    4               OCB.TYPE = '  ';            /* TYPE shouldn't get carried         */
     1255     9897    4               FPT_OPEN_OUT.V.TYPE# = '  ';
     1256     9898    4               END;
     1257     9899        /**/
     1258     9900        /*  When COPYing INTO a file, default to not release NGAVAL.  */
     1259     9901        /**/
     1260     9902    3           IF FPT_OPEN_OUT.V.EXIST# = %OLDFILE# AND OUT_FILE_EXISTS
     1261     9903    3            THEN
     1262     9904    3              OCB.RELEASE = 2;
     1263     9905        /**/
     1264     9906        /*  Tapes should default VOL to the last volume of this set that was          */
     1265     9907        /*  accessed.                                                                 */
     1266     9908        /**/
     1267     9909    3           IF OCB.DEV_MASK & '006'O
     1268     9910    3            THEN                           /* Tapes are invloved                 */
     1269     9911    4            DO;
     1270     9912    4               CALL VPD$CHECK_VOL(OUT_SN,3,,I,1); /* Last VOL# is the default    */
     1271     9913    4               FPT_OPEN_OUT.V.VOL# = I;    /* Stuff in UBIN(9) field             */
     1272     9914    4               END;
     1273     9915        /**/
     1274     9916        /*  COMPRESSED should be carried across by default.  */
     1275     9917        /**/
     1276     9918    3           IF M$EI$ -> F$DCB.COMP
     1277     9919    3            THEN                           /* Carry COMPRESSED across            */
     1278     9920    3              FPT_OPEN_OUT.V.COMP# = %YES#;
     1279     9921        /**/
     1280     9922        /*  FORM should be carried across by default. */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:71   
     1281     9923        /**/
     1282     9924    3           IF NOT OCB.FLAVOR.CARRY_ATTR
     1283     9925    3            THEN
     1284     9926    3              GOTO NO_FORM_DEFAULT;
     1285     9927    3           PTR$ = ADDR(FPARAM_BUF);
     1286     9928    3           CALL XSF$LOCCODP(PTR$,16) ALTRET(NO_FORM_DEFAULT);
     1287     9929    3           FORM_DEFAULT = PTR$ -> CODE16.FORM;
     1288     9930    3           FPT_OPEN_OUT.FORM_ = VECTOR(FORM_DEFAULT);
     1289     9931    4           DO WHILE (%NO#);
     1290     9932    4   NO_FORM_DEFAULT: ;
     1291     9933    4              FPT_OPEN_OUT.FORM_ = VECTOR(NIL);
     1292     9934    4              END;
     1293     9935        /**/
     1294     9936        /*  We are finished.  */
     1295     9937        /**/
     1296     9938    3           RETURN;
     1297     9939    3   END SET_DEFAULTS;
     1298     9940        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:72   
     1299     9941    2   RECONCILE_DEFAULTS_BEFORE_OPEN: PROC;
     1300     9942        /*I* NAME:  RECONCILE_DEFAULTS_BEFORE_OPEN
     1301     9943             CALL:  CALL RECONCILE_DEFAULTS_BEFORE_OPEN;
     1302     9944             DESCRIPTION:  This routine sets certain defaults after all
     1303     9945                           options have been processed, but before the
     1304     9946                           output file is OPENed.
     1305     9947
     1306     9948                           The defaults typically have to be placed in the
     1307     9949                           OPEN FPT.
     1308     9950        */
     1309     9951    3           IF OCB.VFC = 3                  /* SVFC specified                     */
     1310     9952    3             AND ICB.FLAVOR.UR
     1311     9953    3             AND FPT_OPEN_OUT.V.ORG# = %UR#
     1312     9954    3            THEN
     1313     9955    4            DO;
     1314     9956    4               FPT_OPEN_OUT.V.ORG# = %CONSEC#;
     1315     9957    4               OCB.ORG=1;             /* THIS IS PCL'S INTERNAL CODE FOR CONSEC*/
     1316     9958    4               ORG_MASK = '0'B;
     1317     9959    4               ORG_MASK(1)='1'B;
     1318     9960    4               END;
     1319     9961    3           IF FPT_OPEN_OUT.V.ORG# = %CONSEC#
     1320     9962    3             OR FPT_OPEN_OUT.V.ORG# = %UR#
     1321     9963    3             OR FPT_OPEN_OUT.V.ORG# = %TERMINAL#
     1322     9964    3            THEN
     1323     9965    3              FPT_OPEN_OUT.V.ACS# = %SEQUEN#;
     1324     9966    3            ELSE
     1325     9967    3              FPT_OPEN_OUT.V.ACS# = %DIRECT#;
     1326     9968    3           IF OCB.NFA
     1327     9969    3             AND OCB.FLAVOR.CARRY_ATTR
     1328     9970    3             AND OCB.TYPE_BIT='0'B
     1329     9971    3            THEN
     1330     9972    3              FPT_OPEN_OUT.V.TYPE# = M$EI$->F$DCB.TYPE;
     1331     9973    3   END RECONCILE_DEFAULTS_BEFORE_OPEN;
     1332     9974        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:73   
     1333     9975        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:74   
     1334     9976    2   PROCESS_OUTPUT_OPTION: PROC(OPTION$);
     1335     9977        /*I* NAME: PROCESS_OUTPUT_OPTION
     1336     9978             PURPOSE: To further check and act upon specified output options
     1337     9979             CALL: CALL PROCESS_OUTPUT_OPTION(OPTION$);
     1338     9980             DESCRIPTION: OPTION$ points to the head node of the option in question.
     1339     9981                          This option is checked for validity in those cases where
     1340     9982                          further checking is required. The option is interpreted
     1341     9983                          and action is taken to see that it is honored. This
     1342     9984                          could be any of 1) altering the OPEN FPT
     1343     9985                                          2) setting some field in OCB
     1344     9986        */
     1345     9987        /**/
     1346     9988        /*  PARAMETERS  */
     1347     9989        /**/
     1348     9990    3   DCL OPTION$ PTR;                        /* POINTER TO CURRENT OPTION BLK      */
     1349     9991        /**/
     1350     9992        /*  STATIC DATA  */
     1351     9993        /**/
     1352     9994    3   DCL BLK$ PTR;
     1353     9995    3   DCL CHAR2 CHAR(2);
     1354     9996    3   DCL CHAR3 CHAR(3);
     1355     9997    3   DCL J SBIN WORD;
     1356     9998    3   DCL K SBIN WORD;
     1357     9999    3   DCL L SBIN WORD;
     1358    10000    3   DCL TWORD UBIN WORD;
     1359    10001    3   DCL T$ PTR;
     1360    10002    3   DCL DATE_TYPE UBIN STATIC;
     1361    10003    3   DCL TSTAMP# UBIN WORD STATIC;
     1362    10004    3   DCL SAV_TSTAMP# UBIN WORD;
     1363    10005    3   DCL CREATE_TSTAMP# UBIN WORD;
     1364    10006    3   DCL SAV_25TH_TSTAMP# SBIN WORD;
     1365    10007    3   DCL CREATE_25TH_TSTAMP# SBIN WORD;
     1366    10008    3   DCL NUM SBIN WORD;
     1367    10009        /**/
     1368    10010        /*  ENTRY POINTS  */
     1369    10011        /**/
     1370    10012    3   DCL VPD$PROCESS_DATE ENTRY(4) ALTRET;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:75   
     1371    10013        /**/
     1372    10014        /*  Constants  */
     1373    10015        /**/
     1374    10016    3   DCL ZERO_BYTE2 BIT(18) CONSTANT INIT('0'B);
     1375    10017    3   DCL NULL_CHR2 REDEF ZERO_BYTE2 CHAR(2);
     1376    10018        %INCLUDE XUD_UTS_M;
     1377    10100        %XUD$UTS_ENTRIES;
     1378    10132        %XUD_UTS_EQU;
     1379    10143        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:76   
     1380    10144    4           DO CASE(OPTION$->OUT$BLK.CODE);
     1381    10145    4            CASE(1,33,45);                 /* ACCESS, READ, WRITE                */
     1382    10146                                                /* An ACCESS account is involved      */
     1383    10147    4              OCB.ACCESS_FLG = %YES#;
     1384    10148    4              IF OPTION$ -> OUT$BLK.NSUBLKS > 0
     1385    10149    4               THEN                        /* Controls exist                     */
     1386    10150    4                 CALL FILL_ACCESS_TBLS;
     1387    10151    4               ELSE                        /* No controls spcified               */
     1388    10152    4                 OCB.ACCESS_REPLACE = %YES#;
     1389    10153    4            CASE(42,61,62);                /* VEHICLE, VREAD, VWRITE             */
     1390    10154                                                /* An ACSVEHICLE is specified         */
     1391    10155    4              OCB.ACSVEH_FLG = %YES#;
     1392    10156    4              IF OPTION$ -> OUT$BLK.NSUBLKS > 0
     1393    10157    4               THEN                        /* Controls are specified             */
     1394    10158    4                 CALL FILL_ACCESS_TBLS;
     1395    10159    4               ELSE                        /* No controls provided               */
     1396    10160    4                 OCB.ACSVEH_REPLACE = %YES#;
     1397    10161    4            CASE(2);                       /* NCNVRT                             */
     1398    10162    4              FPT_OPEN_OUT.V.CNVRT# = %NO#;
     1399    10163    4            CASE(3);                       /* NBIN                               */
     1400    10164    4              OCB.BIN = 1;
     1401    10165    4            CASE(4);                       /* BIN                                */
     1402    10166    4              OCB.BIN = 2;
     1403    10167    4            CASE(5);                       /* BLOCK                              */
     1404    10168    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1405    10169    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1406    10170    4                32767) ALTRET(BAD_BLKL);
     1407    10171    4              FPT_OPEN_OUT.V.BLKL# = TWORD;
     1408    10172    4              GOTO GOOD_BLKL;
     1409    10173    4   BAD_BLKL:  CALL BAD_OPT(3,65);          /* BLKL TOO LARGE                     */
     1410    10174        /*E* ERROR:   VPC-00065
     1411    10175             MESSAGE: BLKL too large
     1412    10176        */
     1413    10177    4   GOOD_BLKL: ;
     1414    10178    4            CASE(6);                       /* CRPT                               */
     1415    10179    4              CALL VPD$MNG_CRPT(OCB.CRPT,OPTION$->OUT$BLK.SUBLK$(0))
     1416    10180    5               WHENALTRETURN DO;           /*  bad  CRPT  value                  */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:77   
     1417    10181    5                  CALL BAD_OPT(3,66);
     1418    10182        /*E* ERROR:   VPC-00066
     1419    10183             MESSAGE: Invalid CRPT value on output.
     1420    10184        */
     1421    10185    5                  END;                     /*   END  ALTRETURN                   */
     1422    10186    4            CASE(7);                       /* CS                                 */
     1423    10187    4              OCB.CS.SPEC = 1;
     1424    10188    4              OCB.CS.ID.L = 0;
     1425    10189    4              OCB.CS.N = 0;
     1426    10190    4              OCB.CS.K = 1;
     1427    10191    4              J=0;
     1428    10192    5              DO WHILE(J<OPTION$->OUT$BLK.NSUBLKS);
     1429    10193    5                 IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE=4
     1430    10194    5                  THEN
     1431    10195    5                    IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0)->
     1432    10196    5                      TEXT$C.LEN<5
     1433    10197    5                     THEN
     1434    10198    5                       OCB.CS.ID = OPTION$->OUT$BLK.SUBLK$(J)->
     1435    10199    5                         OUT$BLK.SUBLK$(0)->TEXT$C;
     1436    10200    5                     ELSE
     1437    10201    5                       CALL BAD_OPT(3,25); /* CS ID GREATER THAN 4 CHARS         */
     1438    10202        /*E* ERROR:   VPC-00025
     1439    10203             MESSAGE: CS ID greater than 4 chars
     1440    10204        */
     1441    10205    5                  ELSE
     1442    10206    6                  DO;
     1443    10207    6                     CALL VPD$TEXTC_CHARBIN(TWORD,
     1444    10208    6                       OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0),
     1445    10209    6                       9999) ALTRET(BAD_CS);
     1446    10210    6                     IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE=100
     1447    10211    6                      THEN
     1448    10212    6                        OCB.CS.N = TWORD;
     1449    10213    6                      ELSE
     1450    10214    6                        OCB.CS.K = TWORD;
     1451    10215    6                     END;
     1452    10216    5                 J = J+1;
     1453    10217    5                 END;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:78   
     1454    10218    4              GOTO GOOD_CS;
     1455    10219    4   BAD_CS:    CALL BAD_OPT(3,67);          /* CS N OR K TOO LARGE                */
     1456    10220        /*E* ERROR:   VPC-00067
     1457    10221             MESSAGE: CS N or K too large
     1458    10222        */
     1459    10223    4   GOOD_CS:   OCB.CS.CURRENT = OCB.CS.N;
     1460    10224    4            CASE(8);                       /* CR                                 */
     1461    10225    4              OCB.CR_NCR = 1;
     1462    10226    4            CASE(9);                       /* COMPRESSED                         */
     1463    10227    4              OCB.COMP = 2;                /* Remember for later use             */
     1464    10228    4              FPT_OPEN_OUT.V.COMP# = %YES#; /* Take care of immediate needs      */
     1465    10229    4            CASE(10);                      /* DSP                                */
     1466    10230    4              OCB.VFC_CHAR = 'B';
     1467    10231    4              OCB.VFC_USE = 1;
     1468    10232    4            CASE(11);                      /* DENSITY                            */
     1469    10233    4              CALL VPD$TEXTC_CHARBIN(J,
     1470    10234
     1471    10235    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1472    10236    4                38000) ALTRET(BAD_DENS);
     1473    10237    4              IF  J = 38000
     1474    10238    4               THEN
     1475    10239    4                 FPT_OPEN_OUT.V.DENSITY# = %D38000# ;
     1476    10240    4               ELSE IF J = 6250
     1477    10241    4                  THEN
     1478    10242    4                    FPT_OPEN_OUT.V.DENSITY# = %D6250# ;
     1479    10243    4                  ELSE IF J = 1600
     1480    10244    4                     THEN
     1481    10245    4                       FPT_OPEN_OUT.V.DENSITY# = %D1600# ;
     1482    10246    4                     ELSE IF J = 800
     1483    10247    4                        THEN
     1484    10248    4                          FPT_OPEN_OUT.V.DENSITY# = %D800# ;
     1485    10249    4                        ELSE
     1486    10250    4   BAD_DENS:              CALL BAD_OPT(3,26);
     1487    10251        /*E* ERROR:   VPC-00026
     1488    10252             MESSAGE: Illegal DENSITY specification
     1489    10253        */
     1490    10254                                                /* ILLEGAL DENSITY SPECIFICATION      */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:79   
     1491    10255    4            CASE(12);                      /* EBCDIC                             */
     1492    10256    4              FPT_OPEN_OUT.V.EBCDIC# = %YES#;
     1493    10257    4            CASE(13);                      /* EXPIRE                             */
     1494    10258    4              CALL VPD$PROCESS_DATE(OPTION$->OUT$BLK.SUBLK$(0),
     1495    10259    4                DATE_TYPE,SAV_TSTAMP#,J)
     1496    10260    5               WHENALTRETURN DO;
     1497    10261    5                  CALL BAD_OPT(3,90);      /* Bad date value or format           */
     1498    10262        /*E* ERROR:   VPC-00090
     1499    10263             MESSAGE: Bad EXPIRATION date.
     1500    10264        */
     1501    10265    5                  END;                     /* end ALTRETURN                      */
     1502    10266    5              DO CASE(DATE_TYPE);
     1503    10267    5               CASE(1,2,4,5,6);            /* Expiration date specified          */
     1504    10268    5                 IF NOT (CMD_MASK & '00004'O) /* IF COPY,LIST,...                */
     1505    10269    5                  THEN                     /* Creation time is NOW!              */
     1506    10270    5                    CREATE_TSTAMP# = NOW_UTS;
     1507    10271    5                  ELSE                     /* (MODify)                           */
     1508    10272    6                  DO;
     1509    10273    6                     PTR$ = ADDR(FPARAM_BUF);
     1510    10274    6                     CALL XSF$LOCCODP(PTR$,4)
     1511    10275    7                      WHENALTRETURN DO;
     1512    10276    7                         CALL BAD_OPT(3,28); /* No DATES block exists            */
     1513    10277    7                         GOTO EXPIRE_FINIS;
     1514    10278        /*E* ERROR:   VPC-00028
     1515    10279             MESSAGE: You can't set expiration date for a STAR-file.
     1516    10280        */
     1517    10281    7                         END;              /* end  ALTRETURN                     */
     1518    10282    6                     CREATE_TSTAMP# = PTR$ -> CODE04.CREATION.TIME;
     1519    10283    6                     END;
     1520    10284                       /* The following line gets an expiration interval in days.     */
     1521    10285                       /* Note that the order of operations will truncate creation    */
     1522    10286                       /* time before subtracting it from expiration date.  This in-  */
     1523    10287                       /* sures that file will last for (at least) a fraction of the  */
     1524    10288                                                /* expiration day.                    */
     1525    10289    5                 CALL XUD$UTS_DIFF_25TH (SAV_25TH_TSTAMP#, SAV_TSTAMP#, 0);
     1526    10290    5                 CALL XUD$UTS_DIFF_25TH (CREATE_25TH_TSTAMP#, CREATE_TSTAMP#, 0);
     1527    10291    5                 OCB.EXPIRE = (SAV_25TH_TSTAMP#/%UTS_25TH_DAY#) - (CREATE_25TH_TSTAMP#/
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:80   
             10291                          %UTS_25TH_DAY#);
     1528    10292
     1529    10293    5                 IF OCB.EXPIRE < 1
     1530    10294    5                  THEN                     /* Error, negative elapsed time       */
     1531    10295    5   NEG_EXP:         CALL BAD_OPT(3,90);    /* Expire before it's created!        */
     1532    10296    5               CASE(3);                    /* Expire NEVER                       */
     1533    10297    5                 IF ASN#=%FILE#
     1534    10298    5                  THEN
     1535    10299    5                    OCB.EXPIRE = %NEVER#;
     1536    10300    5                  ELSE
     1537    10301    5                    CALL BAD_OPT(3,27);    /* NEVER not allowed for TAPE         */
     1538    10302        /*E* ERROR:   VPC-00027
     1539    10303             MESSAGE: NEVER not allowed for tape
     1540    10304        */
     1541    10305    5               END;                        /* END CASE                           */
     1542    10306    4   EXPIRE_FINIS: ;
     1543    10307    4              FPT_OPEN_OUT.V.EXPIRE# = OCB.EXPIRE;
     1544    10308    4            CASE(14);                      /* EXTEND                             */
     1545    10309    4              FPT_OPEN_OUT.V.XTEND# = %YES#;
     1546    10310    4            CASE(15);                      /* VOLACCESS                          */
     1547    10311    5              DO CASE(OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);
     1548    10312    5               CASE(1);
     1549    10313    5                 FPT_OPEN_OUT.V.VOLACCESS# = %ALL#;
     1550    10314    5               CASE(2);
     1551    10315    5                 FPT_OPEN_OUT.V.VOLACCESS# = %NONE#;
     1552    10316    5               CASE(3);
     1553    10317    5                 FPT_OPEN_OUT.V.VOLACCESS# = %IN#;
     1554    10318    5               END;                        /* end case                           */
     1555    10319    4            CASE(16);                      /* KEYLENGTH                          */
     1556    10320    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1557    10321    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1558    10322    4                255) ALTRET(BAD_KEYL);
     1559    10323    4              FPT_OPEN_OUT.V.KEYL# = TWORD;
     1560    10324    4              GOTO GOOD_KEYL;
     1561    10325    4   BAD_KEYL:  CALL BAD_OPT(3,69);          /* KEYL TOO LONG                      */
     1562    10326        /*E* ERROR:   VPC-00069
     1563    10327             MESSAGE: KEYL too long
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:81   
     1564    10328        */
     1565    10329    4   GOOD_KEYL: ;
     1566    10330    4            CASE(17);                      /* KEYX                               */
     1567    10331    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1568    10332    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1569    10333    4                32768) ALTRET(BAD_KEYX);
     1570    10334    4              FPT_OPEN_OUT.V.KEYX# = TWORD;
     1571    10335    4              GOTO GOOD_KEYX;
     1572    10336    4   BAD_KEYX:  CALL BAD_OPT(3,70);          /* KEYX TOO LARGE                     */
     1573    10337        /*E* ERROR:   VPC-00070
     1574    10338             MESSAGE: KEYX too large
     1575    10339        */
     1576    10340    4   GOOD_KEYX: ;
     1577    10341    4            CASE(18);                      /* KEYS                               */
     1578    10342    4              OCB.KEYS = 1;
     1579    10343    5              DO I = 0 TO OPTION$->OUT$BLK.NSUBLKS-1;
     1580    10344    6                 DO CASE(OPTION$->OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);
     1581    10345    6                  CASE(0);                 /* X                                  */
     1582    10346    6                    OCB.KEY.FORMAT.X = %YES#;
     1583    10347    6                  CASE(1);                 /* X1                                 */
     1584    10348    6                    OCB.KEY.FORMAT.X1 = %YES#;
     1585    10349    6                  CASE(2);                 /* OCT                                */
     1586    10350    6                    OCB.KEY.FORMAT.O = %YES#;
     1587    10351    6                  CASE(3);                 /* CHAR                               */
     1588    10352    6                    OCB.KEY.FORMAT.C = %YES#;
     1589    10353    6                  CASE(4);                 /* SEQ                                */
     1590    10354    6                    OCB.KEY.FORMAT.S = %YES#;
     1591    10355    6                  CASE(5);                 /* EDIT                               */
     1592    10356    6                    OCB.KEY.FORMAT.E = %YES#;
     1593    10357    6                  CASE(6);                 /* NDVBYTE                            */
     1594    10358    6                    OCB.KEY.DVBYTE = 1;    /* NO                                 */
     1595    10359    6                  CASE(7);                 /* DVBYTE                             */
     1596    10360    6                    OCB.KEY.DVBYTE = 2;    /* YES                                */
     1597    10361    6                  CASE(8);                 /* NRECSIZE                           */
     1598    10362    6                    OCB.KEY.RECSIZ = 1;    /* NO                                 */
     1599    10363    6                  CASE(9);                 /* RECSIZE                            */
     1600    10364    6                    OCB.KEY.RECSIZ = 2;    /* YES                                */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:82   
     1601    10365    6                  CASE(10);                /* NONDATA                            */
     1602    10366    6                    OCB.KEY.ONDATA = 1;    /* NO                                 */
     1603    10367    6                  CASE(11);                /* ONDATA                             */
     1604    10368    6                    OCB.KEY.ONDATA = 2;    /* YES                                */
     1605    10369    6                  END;                     /* END CASE                           */
     1606    10370    5                 END;                      /* END INDEX                          */
     1607    10371    4            CASE(19);                      /* LC                                 */
     1608    10372    4              OCB.UC_LC = 1;
     1609    10373    4            CASE(20);                      /* LN                                 */
     1610    10374    4              OCB.ORG = 4;
     1611    10375    4              OCB.LN.KEY.LEN = 3;
     1612    10376    4              OCB.LN.N = 1000;
     1613    10377    4              OCB.LN.K = 1000;
     1614    10378    4              J=0;
     1615    10379    5              DO WHILE(J<OPTION$->OUT$BLK.NSUBLKS);
     1616    10380    5                 NUM = 0;
     1617    10381    5                 K=0;
     1618    10382    5                 IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.NSUBLKS > 0
     1619    10383    5                  THEN
     1620    10384    6                  DO;
     1621    10385    6                     CALL VPD$DECI_MUNGE(
     1622    10386    6                       OPTION$->OUT$BLK.SUBLK$(J),
     1623    10387    6                       -99999999,99999999, /* Limits +-99999.999                 */
     1624    10388    6                       NUM) ALTRET(BAD_LN);
     1625    10389    6                     IF J=0
     1626    10390    6                      THEN
     1627    10391    6                        OCB.LN.N=NUM;
     1628    10392    6                      ELSE
     1629    10393    6                        OCB.LN.K=NUM;
     1630    10394    6                     END;
     1631    10395    5                 J=J+1;
     1632    10396    5                 END;
     1633    10397    4              OCB.LN.CURRENT = OCB.LN.N - OCB.LN.K;
     1634    10398    4              GOTO GOOD_LN;
     1635    10399    4   BAD_LN:    CALL BAD_OPT(3,31);          /* BAD LN START OR INCREMENT          */
     1636    10400        /*E* ERROR:   VPC-00031
     1637    10401             MESSAGE: Bad LN start or increment
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:83   
     1638    10402        */
     1639    10403    4   GOOD_LN:   ;
     1640    10404    4            CASE(21);                      /* LRDL0                              */
     1641    10405    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1642    10406    4                OPTION$->OUT$BLK.SUBLK$(0)->
     1643    10407    4                OUT$SYM.TEXTC$,
     1644    10408    4                511) ALTRET(BAD_LRDL0);
     1645    10409    4              FPT_OPEN_OUT.V.LRDL0# = TWORD;
     1646    10410    4              OCB.LRDL0 = TWORD;
     1647    10411    4              GOTO GOOD_LRDL0;
     1648    10412    4   BAD_LRDL0: CALL BAD_OPT(3,81);
     1649    10413        /*E* ERROR:   VPC-00081
     1650    10414             MESSAGE: LRDL0 > 511
     1651    10415        */
     1652    10416    4   GOOD_LRDL0: ;
     1653    10417    4            CASE(22);                      /* LSLIDE                             */
     1654    10418    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1655    10419    4                OPTION$->OUT$BLK.SUBLK$(0)->
     1656    10420    4                OUT$SYM.TEXTC$,
     1657    10421    4                511) ALTRET(BAD_LSLIDE);
     1658    10422    4              FPT_OPEN_OUT.V.LSLIDE# = TWORD;
     1659    10423    4              OCB.LSLIDE = TWORD;
     1660    10424    4              GOTO GOOD_LSLIDE;
     1661    10425    4   BAD_LSLIDE: CALL BAD_OPT(3,82);
     1662    10426        /*E* ERROR:   VPC-00082
     1663    10427             MESSAGE: LSLIDE > 511
     1664    10428        */
     1665    10429    4   GOOD_LSLIDE: ;
     1666    10430    4            CASE(23);                      /* MAXVOL                             */
     1667    10431    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1668    10432    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1669    10433    4                511) ALTRET(BAD_MAXVOL);
     1670    10434    4              FPT_OPEN_OUT.V.MAXVOL# = TWORD;
     1671    10435    4              GOTO GOOD_MAXVOL;
     1672    10436    4   BAD_MAXVOL: CALL BAD_OPT(3,71);         /* MAXVOL TOO LARGE                   */
     1673    10437        /*E* ERROR:   VPC-00071
     1674    10438             MESSAGE: MAXVOL too large
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:84   
     1675    10439        */
     1676    10440    4   GOOD_MAXVOL: ;
     1677    10441    4            CASE(24);                      /* AMR                                */
     1678    10442    4              FPT_OPEN_OUT.V.INITZ.REASSIGN# = %YES#;
     1679    10443    4            CASE(25);                      /* NB                                 */
     1680    10444    4              OCB.NB = 1;
     1681    10445    4            CASE(26);                      /* NCR                                */
     1682    10446    4              OCB.CR_NCR = 2;
     1683    10447    4            CASE(27);                      /* NCS                                */
     1684    10448    4              OCB.CS.SPEC = 2;
     1685    10449    4              OCB.CS.ID.L = 8;
     1686    10450    4              OCB.CS.ID.C = ' ';
     1687    10451    4            CASE(28);                      /* NFA                                */
     1688    10452    4              OCB.NFA = %YES#;
     1689    10453    4            CASE(29);                      /* NLN                                */
     1690    10454    4              OCB.ORG = 1;                 /* CONSECUTIVE                        */
     1691    10455    4            CASE(30);                      /* ORGANIZATION                       */
     1692    10456    4              ORG_CODE = OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     1693    10457    4              OCB.ORG = ORG_CODE;
     1694    10458    4              IF ORG_CODE = 4              /* KEYED                              */
     1695    10459    4               THEN
     1696    10460    5               DO;
     1697    10461    5                  OCB.LN.N = 1000;
     1698    10462    5                  OCB.LN.K = 1000;
     1699    10463    5                  OCB.LN.CURRENT = 0;
     1700    10464    5                  OCB.LN.KEY.LEN = 3;
     1701    10465    5                  END;
     1702    10466    4            CASE(31,46,54);                /* OCTAL AND HEX DUMPS                */
     1703    10467    5              DO SELECT(OPTION$->OUT$BLK.CODE);
     1704    10468    5                 SELECT(31);               /* OCTAL                              */
     1705    10469    5                 OCB.OCT_HEX.TYPE = 1;
     1706    10470    5                 SELECT(46);               /* X                                  */
     1707    10471    5                 OCB.OCT_HEX.TYPE = 2;
     1708    10472    5                 SELECT(54);               /* X1 DUMP                            */
     1709    10473    5                 OCB.OCT_HEX.TYPE = 3;
     1710    10474    5                 END;                      /* END SELECT                         */
     1711    10475    5              DO J=0 TO OPTION$->OUT$BLK.NSUBLKS-1;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:85   
     1712    10476    6                 DO CASE(OPTION$ -> OUT$BLK.SUBLK$(J) -> OUT$BLK.CODE);
     1713    10477    6                  CASE(1);                 /* DUPE                               */
     1714    10478    6                    OCB.OCT_HEX.DUPE = 2;
     1715    10479    6                  CASE(2);                 /* NDUPE                              */
     1716    10480    6                    OCB.OCT_HEX.DUPE = 1;
     1717    10481    6                  CASE(3);                 /* NTEXT                              */
     1718    10482    6                    OCB.OCT_HEX.TEXT = 1;
     1719    10483    6                  CASE(4);                 /* TEXT                               */
     1720    10484    6                    OCB.OCT_HEX.TEXT = 2;
     1721    10485    6                  END;
     1722    10486    5                 END;
     1723    10487    4            CASE(32);                      /* PEXTENT                            */
     1724    10488    4              CALL VPD$TEXTC_CHARBIN(FPT_OPEN_OUT.V.IXTNSIZE#,
     1725    10489    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1726    10490    4                134217727) ALTRET(BAD_IXTN);
     1727    10491    4              GOTO GOOD_IXTN;
     1728    10492    4   BAD_IXTN:  CALL BAD_OPT(3,72);          /* IXTNSIZE TOO LARGE                 */
     1729    10493        /*E* ERROR:   VPC-00072
     1730    10494             MESSAGE: IXTNSIZE too large
     1731    10495        */
     1732    10496    4   GOOD_IXTN: ;
     1733    10497    4            CASE(34);                      /* RECLENGTH                          */
     1734    10498    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1735    10499    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1736    10500    4                262143) ALTRET(BAD_RECL);
     1737    10501    4              FPT_OPEN_OUT.V.RECL# = TWORD;
     1738    10502    4              GOTO GOOD_RECL;
     1739    10503    4   BAD_RECL:  CALL BAD_OPT(3,74);          /* RECL TOO LARGE                     */
     1740    10504        /*E* ERROR:   VPC-00074
     1741    10505             MESSAGE: RECL too large
     1742    10506        */
     1743    10507    4   GOOD_RECL: ;
     1744    10508    4            CASE(35);                      /* RELEASE                            */
     1745    10509    4              OCB.RELEASE = 1;
     1746    10510    4            CASE(36);                      /* SEXTENT                            */
     1747    10511    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1748    10512    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:86   
     1749    10513    4                32000) ALTRET(BAD_SXTN);
     1750    10514    4              FPT_OPEN_OUT.V.XTNSIZE# = TWORD;
     1751    10515    4              OCB.XTNSIZE = TWORD;
     1752    10516    4              GOTO GOOD_SXTN;
     1753    10517    4   BAD_SXTN:  CALL BAD_OPT(3,73);          /* SEXTENT TOO LARGE                  */
     1754    10518        /*E* ERROR:   VPC-00073
     1755    10519             MESSAGE: XTNSIZE too large
     1756    10520        */
     1757    10521    4   GOOD_SXTN: ;
     1758    10522    4            CASE(37);                      /* SPARE                              */
     1759    10523    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1760    10524    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1761    10525    4                511) ALTRET(BAD_SPARE);
     1762    10526    4              FPT_OPEN_OUT.V.SPARE# = TWORD;
     1763    10527    4              OCB.SPARE = TWORD;
     1764    10528    4              GOTO GOOD_SPARE;
     1765    10529    4   BAD_SPARE: CALL BAD_OPT(3,75);          /* SPARE TOO LARGE                    */
     1766    10530        /*E* ERROR:   VPC-00075
     1767    10531             MESSAGE: SPARE too large
     1768    10532        */
     1769    10533    4   GOOD_SPARE: ;
     1770    10534    4            CASE(38);                      /* SSP                                */
     1771    10535    4              OCB.VFC_CHAR = 'A';
     1772    10536    4              OCB.VFC_USE = 1;
     1773    10537    4            CASE(39);                      /* TX                                 */
     1774    10538    4              OCB.TX = 1;
     1775    10539    4            CASE(40);                      /* TYPE                               */
     1776    10540    4              IF OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->TEXT$C.LEN>2
     1777    10541    4               THEN
     1778    10542    4                 CALL BAD_OPT(3,39);       /* TYPE FIELD GREATER THAN2 CHARS*/
     1779    10543        /*E* ERROR:   VPC-00039
     1780    10544             MESSAGE: TYPE greater than 2 chars
     1781    10545        */
     1782    10546    5               ELSE DO;
     1783    10547    5                  OCB.TYPE = OPTION$->OUT$BLK.SUBLK$(0)->
     1784    10548    5                    OUT$BLK.SUBLK$(0)->
     1785    10549    5                    TEXT$C.STRING;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:87   
     1786    10550    5                  FPT_OPEN_OUT.V.TYPE# = OCB.TYPE;
     1787    10551    5                  END;
     1788    10552    4            CASE(41);                      /* UC                                 */
     1789    10553    4              OCB.UC_LC = 2;
     1790    10554    4            CASE(43);                      /* VFC                                */
     1791    10555    4              OCB.VFC = 2;
     1792    10556    4            CASE(49);                      /* NVFC                               */
     1793    10557    4              OCB.VFC = 1;
     1794    10558    4            CASE(63);                      /* SVFC                               */
     1795    10559    4              OCB.VFC = 3;
     1796    10560    4            CASE(44);                      /* VOLUME                             */
     1797    10561    4              IF TOT_FILES(0) = 0          /* First output, OK for one-shot opt. */
     1798    10562    4               THEN
     1799    10563    5               DO;
     1800    10564    5                  CALL VPD$TEXTC_CHARBIN(TWORD,
     1801    10565    5                    OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1802    10566    5                    511) ALTRET(BAD_VOL);
     1803    10567    5                  FPT_OPEN_OUT.V.VOL# = TWORD;
     1804    10568    5                  GOTO GOOD_VOL;
     1805    10569    5   BAD_VOL:       CALL BAD_OPT(3,76);      /* VOL TOO LARGE                      */
     1806    10570    5                  END;
     1807    10571        /*E* ERROR:   VPC-00076
     1808    10572             MESSAGE: VOL too large
     1809    10573        */
     1810    10574    4   GOOD_VOL:  ;
     1811    10575    4            CASE(47);                      /* NRECORDS                           */
     1812    10576    4              CALL VPD$TEXTC_CHARBIN(FPT_OPEN_OUT.V.NRECS#,
     1813    10577    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1814    10578    4                BITBIN('377777777777'O)) ALTRET(BAD_NRECS);
     1815    10579    4              GOTO GOOD_NRECS;
     1816    10580    4   BAD_NRECS: CALL BAD_OPT(3,77);          /* NRECS TOO LARGE                    */
     1817    10581        /*E* ERROR:   VPC-00077
     1818    10582             MESSAGE: NRECS too large
     1819    10583        */
     1820    10584    4   GOOD_NRECS: ;
     1821    10585    4            CASE(48);                      /* FVFC                               */
     1822    10586    4              OCB.FVFC = '1'B;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:88   
     1823    10587    4            CASE(50);                      /* NRELEASE                           */
     1824    10588    4              OCB.RELEASE = 2;
     1825    10589    4            CASE(51);                      /* DIRECT                             */
     1826    10590    4              OCB.NEWKEY = 1;
     1827    10591    4            CASE(52);                      /* NSPANNED                           */
     1828    10592    4              FPT_OPEN_OUT.V.SPANNED# = %NO#;
     1829    10593    4            CASE(53);                      /* BACKUP                             */
     1830    10594    4              OCB.BACKUP = 1;
     1831    10595    4              FPT_OPEN_OUT.V.BUPM# = %YES#;
     1832    10596    4            CASE(58);                      /* NBACKUP                            */
     1833    10597    4              OCB.BACKUP = 2;
     1834    10598    4              FPT_OPEN_OUT.V.BUPM# = %NO#;
     1835    10599    4            CASE(55);                      /* NBLOCK                             */
     1836    10600    4              FPT_OPEN_OUT.V.BLOCKED# = %NO#;
     1837    10601    4            CASE(56);                      /* RECSIZE                            */
     1838    10602    5              DO J=0 TO OPTION$->OUT$BLK.NSUBLKS-1;
     1839    10603    5                 IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE ~=3 /* Not dash     */
     1840    10604    5                  THEN
     1841    10605    5                    CALL VPD$TEXTC_CHARBIN(TWORD,
     1842    10606    5                      OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0),
     1843    10607    5                      '777777777777'O) ALTRET(BAD_RECSIZE);
     1844    10608    6                 DO CASE(OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE);
     1845    10609    6                  CASE(1);                 /* minimum RECSIZE                    */
     1846    10610    6                    OCB.RECSIZE.MIN_SIZE = TWORD;
     1847    10611    6                    OCB.RECSIZE.MIN_SPEC = %YES#;
     1848    10612    6                  CASE(2);                 /* maximum RECSIZE                    */
     1849    10613    6                    OCB.RECSIZE.MAX_SIZE = TWORD;
     1850    10614    6                    OCB.RECSIZE.MAX_SPEC = %YES#;
     1851    10615    6                  CASE(3);                 /* There's a dash                     */
     1852    10616    6                    OCB.RECSIZE.MAX_SIZE = OCB.RECSIZE.MIN_SIZE;
     1853    10617    6                  END;                     /* CASE                               */
     1854    10618    5                 END;
     1855    10619    4              IF OCB.RECSIZE.MIN_SPEC AND ~OCB.RECSIZE.MAX_SPEC
     1856    10620    4                AND OCB.RECSIZE.MIN_SIZE ~= OCB.RECSIZE.MAX_SIZE
     1857    10621    4               THEN
     1858    10622    5               DO;
     1859    10623    5                  OCB.RECSIZE.MAX_SPEC = %YES#;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:89   
     1860    10624    5                  OCB.RECSIZE.MAX_SIZE = OCB.RECSIZE.MIN_SIZE;
     1861    10625    5                  END;
     1862    10626    4              IF OCB.RECSIZE.MIN_SPEC AND OCB.RECSIZE.MIN_SIZE=0
     1863    10627    4                AND ~OCB.RECSIZE.MAX_SPEC
     1864    10628    4               THEN
     1865    10629    5               DO;
     1866    10630    5                  OCB.RECSIZE.MAX_SPEC=%YES#;
     1867    10631    5                  OCB.RECSIZE.MAX_SIZE=0;
     1868    10632    5                  END;
     1869    10633    4              IF OCB.RECSIZE.MIN_SPEC AND OCB.RECSIZE.MAX_SPEC
     1870    10634    4                AND OCB.RECSIZE.MAX_SIZE < OCB.RECSIZE.MIN_SIZE
     1871    10635    4               THEN
     1872    10636    5               DO;
     1873    10637    5                  CALL BAD_OPT(3,94);
     1874    10638    5                  GOTO GOOD_RECSIZE;       /* PREVENT SECOND MESSAGE             */
     1875    10639    5                  END;
     1876    10640        /*E*   ERROR: VPC-00094
     1877    10641             MESSAGE: Minimum RECSIZE is greater than maximum RECSIZE.
     1878    10642        */
     1879    10643    4               ELSE
     1880    10644    4                 GOTO GOOD_RECSIZE;
     1881    10645    4   BAD_RECSIZE: CALL BAD_OPT(3,87);
     1882    10646        /*E*   ERROR: VPC-00087
     1883    10647             MESSAGE: RECSIZE too large
     1884    10648        */
     1885    10649    4   GOOD_RECSIZE: ;
     1886    10650    4            CASE(57);                      /* SHARE                              */
     1887    10651    4              FPT_OPEN_OUT.V.SHARE# = %ALL#;
     1888    10652    4            CASE(59);                      /* REBUILD                            */
     1889    10653    4              IF ( ~ CMD_MASK(12)          /* COPY or LIST, etc.                 */
     1890    10654    4                AND OUT_FILE_EXISTS        /* There is an existing file          */
     1891    10655    4                AND FPT_OPEN_OUT.V.EXIST# = 2) /* INTO                           */
     1892    10656    4                OR CMD_MASK(12)            /* Always allowed on MODIFY           */
     1893    10657    4               THEN
     1894    10658    4                 OCB.REBUILD = %YES#;
     1895    10659    4            CASE(60);                      /* TRANSPARENT                        */
     1896    10660    4              OCB.TRANS = 2;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:90   
     1897    10661    4            CASE(64);                      /* WRAP                               */
     1898    10662    4              IF OPTION$ -> OUT$BLK.NSUBLKS = 0
     1899    10663    4               THEN                        /* Just said WRAP                     */
     1900    10664    4                 OCB.WRAP = 2;
     1901    10665    4               ELSE                        /* He told us what type               */
     1902    10666    4                 OCB.WRAP = OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;
     1903    10667    4            CASE(65);                      /* NWRAP                              */
     1904    10668    4              OCB.WRAP = 1;
     1905    10669    4            CASE(66);                      /* WIDTH                              */
     1906    10670    4              CALL VPD$TEXTC_CHARBIN(OCB.WIDTH.SIZE,
     1907    10671    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1908    10672    4                '777777777777'O) ALTRET(BAD_WIDTH);
     1909    10673    4              OCB.WIDTH.SPEC = %YES#;
     1910    10674    5              DO WHILE (%NO#);
     1911    10675    5   BAD_WIDTH:    CALL BAD_OPT(3,64);
     1912    10676        /*E*   ERROR: VPC-00064
     1913    10677             MESSAGE: WIDTH too large
     1914    10678        */
     1915    10679    5                 END;
     1916    10680    4            CASE(67);                      /* NCOMPRESSED                        */
     1917    10681    4              OCB.COMP = 1;                /* Remember for later                 */
     1918    10682    4              FPT_OPEN_OUT.V.COMP# = %NO#; /* Take care of immediate needs       */
     1919    10683    4            CASE(68);                      /* NTRANS                             */
     1920    10684    4              OCB.TRANS = 1;
     1921    10685    4            CASE(69);                      /* HEAD                               */
     1922    10686    4              OCB.HEAD = 2;
     1923    10687    4            CASE(70);                      /* NHEAD                              */
     1924    10688    4              OCB.HEAD = 1;
     1925    10689    4            CASE(71);                      /* FORM                               */
     1926    10690    4              T$ = OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0);
     1927    10691    4              IF T$ -> TEXT$C.LEN > 6
     1928    10692    4               THEN
     1929    10693    4                 CALL BAD_OPT(3,85);
     1930    10694        /*E* ERROR:   VPC-00085
     1931    10695             MESSAGE: FORM name has more than 6 characters.
     1932    10696        */
     1933    10697    4               ELSE
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:91   
     1934    10698    5               DO;
     1935    10699    5                  OCB.FORM_FLG = %YES#;
     1936    10700    5                  OCB.FORM = T$ -> TEXT$C.STRING;
     1937    10701    5                  FPT_OPEN_OUT.FORM_ = VECTOR(OCB.FORM);
     1938    10702    5                  END;
     1939    10703    4            CASE(72);                      /* COPIES=N                           */
     1940    10704    4              CALL VPD$TEXTC_CHARBIN(TWORD,
     1941    10705    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1942    10706    4                99) ALTRET(BAD_COPIES);
     1943    10707    4              IF TWORD > 0
     1944    10708    4               THEN                        /* OK!                                */
     1945    10709    5               DO;
     1946    10710    5                  OCB.COPIES = TWORD;
     1947    10711    5                  FPT_OPEN_OUT.V.COPIES# = OCB.COPIES;
     1948    10712    5                  OCB.COPIES_FLG = '1'B;
     1949    10713    5                  END;
     1950    10714    4               ELSE
     1951    10715    5   BAD_COPIES: DO;
     1952    10716    5                  CALL BAD_OPT(3,78);
     1953    10717        /*E* ERROR:   VPC-00078
     1954    10718             MESSAGE: COPIES too large
     1955    10719        */
     1956    10720    5                  END;
     1957    10721    4            CASE(73);                      /* NPAGE                              */
     1958    10722    4              OCB.PAGE = 1;
     1959    10723    4            CASE(74);                      /*  PAGE                              */
     1960    10724    4              OCB.PAGE = 2;
     1961    10725    4            CASE(75);                      /* NLOAD                              */
     1962    10726    4              FPT_OPEN_OUT.V.LOAD# = %NO#;
     1963    10727    4            CASE(76);                      /* NSUMMARY                           */
     1964    10728    4              OCB.SUMMARY = 2;
     1965    10729    4            CASE(77);                      /* SUMMARY                            */
     1966    10730    4              OCB.SUMMARY = 1;
     1967    10731    4            CASE(78);                      /* SAVE                               */
     1968    10732    4              OCB.ERR_SAVE=1;
     1969    10733    4            CASE(80);                      /* ALTBLD                             */
     1970    10734    4              OCB.ALTBLD=1;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:92   
     1971    10735    4            CASE(81);                      /* NALTBLD                            */
     1972    10736    4              OCB.ALTBLD=2;
     1973    10737    4            CASE(82);                      /* GHSTACS                            */
     1974    10738    5              DO CASE(OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);
     1975    10739    5               CASE(1);
     1976    10740    5                 OCB.GHSTACS = %JRNLOPN#;
     1977    10741    5                 FPT_OPEN_OUT.V.GHSTACS# = %JRNLOPN#;
     1978    10742    5               CASE(2);
     1979    10743    5                 OCB.GHSTACS = %NONE#;
     1980    10744    5                 FPT_OPEN_OUT.V.GHSTACS# = %NONE#;
     1981    10745    5               CASE(ELSE);                 /* code = 4, USER ENTERED DECIMAL #   */
     1982    10746    5                 CALL CHARBIN(NUM, OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->
             10746                          TEXT$C.STRING);
     1983    10747    5                 IF NUM > 15
     1984    10748    5                  THEN
     1985    10749    5                    CALL BAD_OPT(3,1);     /* INVALID GHSTACS VALUE              */
     1986    10750        /*E* ERROR:   VPC-00001
     1987    10751             MESSAGE: GHSTACS too large
     1988    10752        */
     1989    10753    5                  ELSE
     1990    10754    6                  DO;
     1991    10755    6                     OCB.GHSTACS = NUM;
     1992    10756    6                     FPT_OPEN_OUT.V.GHSTACS# = NUM;
     1993    10757    6                     END;
     1994    10758    5               END;
     1995    10759    4            CASE(83);                      /* IOERROK                            */
     1996    10760    4              FPT_OPEN_OUT.V.IOERROK# = %YES#;
     1997    10761    4            CASE(84);                      /* NIOERROK                           */
     1998    10762    4              FPT_OPEN_OUT.V.IOERROK# = %NO#;
     1999    10763    4            CASE(85);                      /* ANSISPAN                           */
     2000    10764    4              FPT_OPEN_OUT.V.ANSISPANSEQ# = %YES#;
     2001    10765    4            CASE(86);                      /* NANSISPAN                          */
     2002    10766    4              FPT_OPEN_OUT.V.ANSISPANSEQ# = %NO#;
     2003    10767    4            CASE(%(MAX_OUT_OP#+3));        /* SPARE:  FOR PATCHING USE ONLY      */
     2004    10768    4              OCB.SPARE3 = 3;
     2005    10769    4            CASE(%(MAX_OUT_OP#+2));        /* SPARE:  FOR PATCHING USE ONLY      */
     2006    10770    4              OCB.SPARE2 = 2;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:93   
     2007    10771    4            CASE(%(MAX_OUT_OP#+1));        /* SPARE:  FOR PATCHING USE ONLY      */
     2008    10772    4              OCB.SPARE1 = 1;
     2009    10773    4            END;                           /* END CASE                           */
     2010    10774        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:94   
     2011    10775    3   FILL_ACCESS_TBLS: PROC;
     2012    10776        /*I* NAME: FILL_ACCESS_TBLS
     2013    10777             CALL: CALL FILL_ACCESS_TBLS;
     2014    10778             DESCRIPTION: This procedure fills in the ACCESS and ACSVEH fields of
     2015    10779                          the OCB for later use by the CLOSE procedure in setting
     2016    10780                          access vehicle list and account attribute list.
     2017    10781                          The format used for storage is NOT suitable for passing
     2018    10782                          to M$CLOSE:  an extra byte is present as the first entry
     2019    10783                          for each control/controlled that indicates SPEC_TYPE.
     2020    10784                          SPEC_TYPE   meaning
     2021    10785                          ---------   -------
     2022    10786                              1       complete entry as it stands, 'use this'
     2023    10787                              2       '+' add this to existing entries
     2024    10788                              3       '-' remove this from existing entries
     2025    10789                              4       remove this entire account or vehicle
     2026    10790        */
     2027    10791        /**/
     2028    10792        /*  STATIC DATA  */
     2029    10793        /**/
     2030    10794    4   DCL CNTLS(0:17) BIT(1);
     2031    10795    4   DCL SPEC_TYPE UBIN(9) STATIC;
     2032    10796    4   DCL BLOCK_OFFSET UBIN STATIC;           /* Parse block offset if sign present */
     2033    10797    4   DCL I SBIN WORD;
     2034    10798    4   DCL TMP UBIN WORD;
     2035    10799    4   DCL PTR$ PTR;
     2036    10800    4   DCL FILL$ PTR;
     2037    10801    4   DCL 1 TEXTC,
     2038    10802    4         2 LEN UBIN BYTE UNAL,
     2039    10803    4         2 STRING CHAR(40);
     2040    10804        /**/
     2041    10805        /*  BASED STRUCTURES  */
     2042    10806        /**/
     2043    10807    4   DCL 1 ACS$VEH BASED,
     2044    10808    4         2 SPEC_TYPE UBIN(9) UNAL,
     2045    10809    4         2 CNTLS BIT(18),
     2046    10810    4         2 TEXTC,
     2047    10811    4           3 LEN UBIN BYTE UNAL,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:95   
     2048    10812    4           3 STRING CHAR(ACS$VEH.TEXTC.LEN);
     2049    10813    4   DCL 1 ACC$ESS BASED,
     2050    10814    4         2 SPEC_TYPE UBIN(9) UNAL,
     2051    10815    4         2 CNTLS BIT(18),
     2052    10816    4         2 ACCT CHAR(8);
     2053    10817                                                /* Determine SPEC_TYPE                */
     2054    10818    4           IF OPTION$ -> OUT$BLK.CODE = 33 /* READ                               */
     2055    10819    4             OR OPTION$ -> OUT$BLK.CODE = 61 /* VREAD                            */
     2056    10820    4             OR OPTION$ -> OUT$BLK.CODE = 45 /* WRITE                            */
     2057    10821    4             OR OPTION$ -> OUT$BLK.CODE = 62 /* VWRITE                           */
     2058    10822    4            THEN                           /* No control bits specifiable        */
     2059    10823    4              IF OPTION$ -> OUT$BLK.NSUBLKS > 1
     2060    10824    4               THEN                        /* A + or - is present                */
     2061    10825    5               DO;
     2062    10826    5                  SPEC_TYPE = OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;
     2063    10827    5                  BLOCK_OFFSET = 1;        /* Lower parse blocks are offset by 1 */
     2064    10828    5                  END;
     2065    10829    4               ELSE                        /* No sign present                    */
     2066    10830    5               DO;
     2067    10831    5                  SPEC_TYPE = 1;
     2068    10832    5                  BLOCK_OFFSET = 0;
     2069    10833    5                  END;
     2070    10834    4            ELSE                           /* Control bits are specifiable       */
     2071    10835    4              IF OPTION$ -> OUT$BLK.NSUBLKS > 1
     2072    10836    4                AND OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.NSUBLKS = 0
     2073    10837    4               THEN                        /* A + or - is present                */
     2074    10838    5               DO;
     2075    10839    5                  SPEC_TYPE = OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;
     2076    10840    5                  BLOCK_OFFSET = 1;        /* Lower parse blocks are offset by 1 */
     2077    10841    5                  END;
     2078    10842    4               ELSE                        /* No sign present                    */
     2079    10843    5   NO_SIGN:    DO;
     2080    10844    5                  SPEC_TYPE = 1;
     2081    10845    5                  BLOCK_OFFSET = 0;
     2082    10846    5                  END;
     2083    10847                                                /* First, we have to construct a      */
     2084    10848                                                /* structure of the controls to be    */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:96   
     2085    10849                                                /* applied (to somebody)              */
     2086    10850    4           IF OPTION$ -> OUT$BLK.CODE = 33 /* READ                               */
     2087    10851    4             OR OPTION$ -> OUT$BLK.CODE = 61 /* VREAD                            */
     2088    10852    4            THEN
     2089    10853    4              CNTLS = '400000'O;           /* READ ONLY                          */
     2090    10854    4            ELSE
     2091    10855    4              IF OPTION$ -> OUT$BLK.CODE = 45 /* WRITE                           */
     2092    10856    4                OR OPTION$ -> OUT$BLK.CODE = 62 /* VWRITE                        */
     2093    10857    4               THEN
     2094    10858    4                 CNTLS = '764000'O;        /* READ,DELR,WNEW,UPD,DELF,REATTR     */
     2095    10859    4               ELSE
     2096    10860    5               DO;                         /* CNTLS SPECIFIED (MAYBE)            */
     2097    10861    5                  CNTLS = '0'B;
     2098    10862    5                  IF OPTION$ -> OUT$BLK.NSUBLKS - BLOCK_OFFSET > 1
     2099    10863    5                   THEN                    /* CNTLS WERE INDEED SPECIFIED        */
     2100    10864    6                   DO;
     2101    10865    6                      PTR$ = OPTION$ -> OUT$BLK.SUBLK$(BLOCK_OFFSET +1);
     2102    10866    7                      DO I=0 TO PTR$->OUT$BLK.NSUBLKS-1;
     2103    10867    7                         CNTLS(PTR$->OUT$BLK.SUBLK$(I)->OUT$BLK.CODE-1) = '1'B;
     2104    10868    7                         END;
     2105    10869    6                      END;
     2106    10870    5                   ELSE                    /* No controls were specified         */
     2107    10871    5                     IF SPEC_TYPE = 3      /* IF '-' specified                   */
     2108    10872    5                      THEN                 /* Remove entire account or vehicle   */
     2109    10873    5                        SPEC_TYPE = 4;
     2110    10874    5                  END;
     2111    10875                                                /* The controls to be applied now     */
     2112    10876                                                /* exist (in CNTLS)                   */
     2113    10877                                                /* PTR$ points to the people to get   */
     2114    10878                                                /* the controls                       */
     2115    10879    4           PTR$ = OPTION$->OUT$BLK.SUBLK$(BLOCK_OFFSET);
     2116    10880    5           DO I=0 TO PTR$->OUT$BLK.NSUBLKS-1;
     2117    10881    5              TEXTC.LEN = PTR$->OUT$BLK.SUBLK$(I)->OUT$SYM.COUNT;
     2118    10882    5              TEXTC.STRING = PTR$->OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT;
     2119    10883    5              IF OPTION$->OUT$BLK.CODE=42  /* ACCESS VEHICLE                     */
     2120    10884    5                OR OPTION$->OUT$BLK.CODE=61 /* VEHICLE READ                      */
     2121    10885    5                OR OPTION$->OUT$BLK.CODE=62 /* VEHICLE WRITE                     */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:97   
     2122    10886    5               THEN                        /* VEHICLE is involved                */
     2123    10887    6               DO;
     2124    10888    6                  IF SPEC_TYPE = 1
     2125    10889    6                   THEN                    /* Ignore any old controls            */
     2126    10890    6                     OCB.ACSVEH_REPLACE = '1'B;
     2127    10891    6                  IF OCB.ACSVEH.LEN + TEXTC.LEN +4 > 200
     2128    10892    6                   THEN                    /* We used OCB.ACCESS.LISTs 50 words  */
     2129    10893    7                   DO;
     2130    10894    7                      CALL BAD_OPT(3,89);
     2131    10895    7                      GOTO QUIT;
     2132    10896    7                      END;
     2133    10897        /*E*   ERROR: VPC-00089
     2134    10898             MESSAGE: Too many access vehicle controls
     2135    10899            MESSAGE1: PCL limits the total access vehicle control info in ACS,
     2136    10900        VR, and VWR to 200 bytes.
     2137    10901        */
     2138    10902    6                  FILL$ = PINCRC(ADDR(OCB.ACSVEH.LIST),OCB.ACSVEH.LEN);
     2139    10903    6                  FILL$ -> ACS$VEH.SPEC_TYPE = SPEC_TYPE;
     2140    10904    6                  FILL$ -> ACS$VEH.CNTLS = CNTLS;
     2141    10905    6                  FILL$ -> ACS$VEH.TEXTC.LEN = TEXTC.LEN;
     2142    10906    6                  FILL$ -> ACS$VEH.TEXTC.STRING = TEXTC.STRING;
     2143    10907    6                  OCB.ACSVEH.LEN = OCB.ACSVEH.LEN+TEXTC.LEN +4;
     2144    10908    6                  END;
     2145    10909    5               ELSE                        /* ACCOUNT access controls            */
     2146    10910    6               DO;
     2147    10911    6                  IF SUBSTR(TEXTC.STRING,0,1) = '.'
     2148    10912    6                   THEN
     2149    10913    7                   DO;
     2150    10914    7                      TEXTC.STRING = SUBSTR(TEXTC.STRING,1,TEXTC.LEN-1);
     2151    10915    7                      TEXTC.LEN = TEXTC.LEN-1;
     2152    10916    7                      END;
     2153    10917    6                   ELSE
     2154    10918    6                     IF SUBSTR(TEXTC.STRING,0,1)=''''
     2155    10919    6                       AND SUBSTR(TEXTC.STRING,TEXTC.LEN-1,1)=''''
     2156    10920    6                      THEN
     2157    10921    7                      DO;
     2158    10922    7                         TEXTC.STRING = SUBSTR(TEXTC.STRING,1,TEXTC.LEN-2);
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:98   
     2159    10923    7                         TEXTC.LEN = TEXTC.LEN-2;
     2160    10924    7                         END;
     2161    10925    6                      ELSE
     2162    10926    6                        CALL INDEX(TMP,'.',TEXTC.STRING)
     2163    10927    7                         WHENRETURN DO;
     2164    10928    7                            CALL BAD_OPT(3,93);
     2165    10929    7                            END;
     2166    10930        /*E*  ERROR:   VPC-00093
     2167    10931              MESSAGE: Illegal account in ACCESS list.
     2168    10932             MESSAGE1: The account specified contains an illegal character.
     2169    10933        */
     2170    10934    6                  IF SPEC_TYPE = 1
     2171    10935    6                   THEN                    /* Ignore any old controls            */
     2172    10936    6                     OCB.ACCESS_REPLACE = '1'B;
     2173    10937    6                  IF TEXTC.LEN>8
     2174    10938    6                   THEN
     2175    10939    6                     CALL BAD_OPT(3,79);
     2176    10940        /*E* ERROR:   VPC-00079
     2177    10941             MESSAGE: ACCOUNT for account access controls > 8 characters
     2178    10942        */
     2179    10943    6                   ELSE
     2180    10944    7                   DO;
     2181    10945    7                      IF OCB.ACCESS.LEN > 210
     2182    10946    7                       THEN           /* We've used OCB.ACCESS.LISTs 220 byts    */
     2183    10947    8                       DO;
     2184    10948    8                          CALL BAD_OPT(3,88);
     2185    10949    8                          GOTO QUIT;
     2186    10950    8                          END;
     2187    10951        /*E*   ERROR: VPC-00088
     2188    10952             MESSAGE: Too many account access controls
     2189    10953            MESSAGE1: PCL limits the total number of account entries in R, WR, and ACC to 20
     2190    10954        */
     2191    10955    7                      FILL$ = PINCRC(ADDR(OCB.ACCESS.LIST),OCB.ACCESS.LEN);
     2192    10956    7                      FILL$ -> ACC$ESS.SPEC_TYPE = SPEC_TYPE;
     2193    10957    7                      FILL$ -> ACC$ESS.CNTLS = CNTLS;
     2194    10958    7                      FILL$ -> ACC$ESS.ACCT = TEXTC.STRING;
     2195    10959    7                      OCB.ACCESS.LEN = OCB.ACCESS.LEN +11;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:99   
     2196    10960    7                      END;
     2197    10961    6                  END;
     2198    10962    5              END;
     2199    10963    4   QUIT:   RETURN;
     2200    10964    4   END FILL_ACCESS_TBLS;
     2201    10965    3   END PROCESS_OUTPUT_OPTION;
     2202    10966    2   END PROCESS_OPTS;
     2203    10967    1   END VPC$SETOUT;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:100  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPC$SETOUT.

   Procedure VPC$SETOUT requires 2936 words for executable code.
   Procedure VPC$SETOUT requires 96 words of local(AUTO) storage.

    No errors detected in file VPC$SETOUT.:E05TSI    .

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:101  

 Object Unit name= VPC$SETOUT                                 File name= VPC$SETOUT.:E05TOU
 UTS= JUL 30 '97 07:20:55.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none    56     70  VPC$SETOUT
   11  RoData even  UTS    629   1165  VPC$SETOUT
   12   Proc  even  none  2936   5570  VPC$SETOUT
   13  RoData even  none   207    317  VPC$SETOUT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        1  VPC$SETOUT
    12    627                  yes      Std        1  VPC$SETMOD
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:102  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       8 VPL$ERR_PROC
         yes           Std       0 VPD$GET_OUT_FLAVOR
         yes           Std       1 VPD$CLOSE_OUT
         yes           Std       2 VPD$PROCESS_CONTROLS
 yes     yes           Std       2 XSF$LOCCODP
         yes           Std       5 VPD$CHECK_VOL
 yes     yes           Std       2 VPD$FID
 yes     yes           Std       1 VPC$CALL_OPEN
         yes           Std       2 VPD$ANAL_NAME
         yes           Std       2 VPD$MAKE_WILD_OUT
         yes           Std       8 VPL$ERR_SEV_HANDLER
 yes     yes           Std       4 VPD$TEXTC_CHARBIN
 yes     yes           Std       3 XUD$UTS_DIFF_25TH
 yes     yes           Std       2 VPD$MNG_CRPT
 yes     yes           Std       4 VPD$DECI_MUNGE
 yes     yes           Std       4 VPD$PROCESS_DATE
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:103  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OUTPUT_ERR                            USER_LABELS$
     NOW_UTS                               BREAK_LOC                             BREAKS
     BREAK_MESSAGE_REPORTER                FPARAM_BUF                            FPARAM$
     FPARAM_BOUND                          CMD_MASK                              TOT_FILES
     SPEC_BUF                              OCB                                   EO_OCB
     DIN_NAME                              IN_RES                                OUT_SN
     ICB                              r    ORG_TBL                               M$EI
     M$EI$                                 M$EO                                  M$EO1
     M$ME                                  M$SI                                  M$READFILE
     M$DO                                  M$STD1                                M$SORT1
     FPT_OPEN_OUT_SAVE                     FPT_OPEN_OUT                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:104  


      137        1        /*T***********************************************************/
      138        2        /*T*                                                         */
      139        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      140        4        /*T*                                                         */
      141        5        /*T***********************************************************/
      142        6        /*F* NAME: VPC$SETOUT
      143        7             PURPOSE: To process the output specification of a PCL command.
      144        8             DESCRIPTION: This module processes PCL's output specification. It
      145        9                          validates all options, sets up OCB, and
      146       10                          opens the output file.
      147       11        */
      148       12        VPC$SETOUT: PROC(OUT_SPEC$);

     12 12 000000   000000 700200 xent  VPC$SETOUT   TSX0  ! X66_AUTO_1
        12 000001   000140 000001                    ZERO    96,1

      149       13        /*D* NAME: VPC$SETOUT
      150       14             CALL: CALL VPC$SETOUT(OUT_SPEC$);
      151       15                    where OUT_SPEC$ is a pointer to the output specification head
      152       16                    node and must be present.  If it is NIL, a default is used.
      153       17             DESCRIPTION: This procedure opens the output file if no errors are
      154       18                          encountered on processing the input specification.
      155       19                          If an output specification is present (OUT_SPEC$~=ADDR(NIL))
      156       20                          it is checked for validity, its options processed, and
      157       21                          if no errors have occured, the file is opened CREATE.
      158       22                          If no output specification is present and the command is
      159       23                          COPY, the last opened COPY output file is opened CREATE,
      160       24                          OLDFILE. If no output
      161       25                          specification is present and the command is not COPY,
      162       26                          the output file is opened CREATE, NEWFILE to the default
      163       27                          destination for that command(user's public disk srea for
      164       28                          COPYALL, COPYSTD, and COPYLIST; device ME for all other
      165       29                          commands).
      166       30        */
      167       31        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:105  
      168       32        /**/
      169       33        /*  INCLUDE FILES  */
      170       34        /**/
      171       35        %INCLUDE VP_DATA_R;
      172     7022        %INCLUDE B_ERRORS_C;
      173     8149        %INCLUDE F$DCB;
      174     8198        %INCLUDE FM$FIT;
      175     8419        /**/
      176     8420        /*  PARAMETERS  */
      177     8421        /**/
      178     8422    1   DCL OUT_SPEC$ PTR;                      /* POINTER TO OUT_SPEC SUB_TREE       */
      179     8423        /**/
      180     8424        /*  BASED STRUCTURES  */
      181     8425        /**/
      182     8426        %B$TCB;
      183     8429        %B$ALT;
      184     8437        %CODE03;
      185     8444        %CODE04;                                /* DATES in FPARAM                    */
      186     8452        %CODE16;                                /* FORM & COPIES                      */
      187     8460        %CODE18;
      188     8464        %CODE19;
      189     8467        %CODE21;
      190     8470        %PARSE$OUT(STCLASS=BASED);
      191     8515        %PARSE$SYM(STCLASS=BASED);
      192     8553        %VLP_VECTOR(FPTN=B$VECTOR,STCLASS=BASED);
      193     8568    1   DCL B$WORD UBIN BASED;
      194     8569    1   DCL 1 TEXT$C BASED,
      195     8570    1         2 LEN UBIN BYTE UNAL,
      196     8571    1         2 STRING CHAR(TEXT$C.LEN);
      197     8572    1   DCL 1 TEXT$C_ARY BASED,
      198     8573    1         2 LEN UBIN BYTE UNAL,
      199     8574    1         2 STRING(0:0) CHAR(1);
      200     8575        /**/
      201     8576        /* STATIC DATA  */
      202     8577        /**/
      203     8578    1   DCL NAME_SPEC_TYPE SBIN WORD;
      204     8579                    %FPT_FID(FPTN = FPT_FID,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:106  
      205     8580                             NAME = NAME#,
      206     8581                             ACCT = ACCT#,
      207     8582                             PASS = PASS#,
      208     8583                             SN   = OUT_SN,
      209     8584                             WSN  = WSN#,
      210     8585                             ASN  = ASN#,
      211     8586                             RES  = RES#,
      212     8587                             RESULTS = RESULTS_FID);
      213     8610        %VLR_FID(FPTN = RESULTS_FID);
      214     8629        %VLP_FPRG (STCLASS=BASED);              /* Structure of CODE17                */
      215     8650    1   DCL 1 NAME# STATIC,
      216     8651    1         2 L UBIN BYTE UNAL,
      217     8652    1         2 C CHAR(31);
      218     8653    1   DCL ACCT# CHAR(8) STATIC;
      219     8654    1   DCL PASS# CHAR(8) STATIC;
      220     8655    1   DCL PASSB# REDEF PASS# BIT(72);
      221     8656    1   DCL WSN# CHAR(8) STATIC;
      222     8657    1   DCL ASN# UBIN BYTE STATIC;
      223     8658    1   DCL RES# CHAR(4) STATIC;
      224     8659    1   DCL I SBIN WORD;
      225     8660    1   DCL J SBIN WORD;
      226     8661    1   DCL PTR$ PTR;
      227     8662    1   DCL FIELD1_ BIT(72) DALIGNED;
      228     8663    1   DCL FIELD2_ BIT(72) DALIGNED;
      229     8664    1   DCL OPT_START SBIN WORD;
      230     8665    1   DCL ERROR UBIN WORD;
      231     8666    1   DCL RECORD_SELECTION BIT(1) ALIGNED;
      232     8667    1   DCL OUT_FILE_EXISTS BIT(1);
      233     8668    1   DCL OUT_FID_GIVEN BIT(1);
      234     8669        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:107  
      235     8670        /**/
      236     8671        /*  CONSTANT  */
      237     8672        /**/
      238     8673    1   DCL CMD_ABORT_ERR(0:29) UBIN HALF UNAL CONSTANT INIT(
      239     8674    1           %E$OPER,     %E$IOERR,    %E$NORES,    %E$NOTUR,    %E$CANT,
      240     8675    1           %E$PROT,     %E$OPROT,    %E$NORING,   %E$EBCDICTAP,%E$ASCIITAP,
      241     8676    1           %E$NORSS,    %E$NONEWU,   %E$NOCFUS,   %E$NONEWFD,  %E$PSGRANS,
      242     8677    1           %E$USGRANS,  %E$ACGRANS,  %E$XCLSET,   %E$SETDOWN,  %E$MNTBRK,
      243     8678    1           %E$TAPBRK,   %E$CANTIO,   %E$VOLOUT,   0,           0,
      244     8679    1           0,           0,        0, 0, 0);/* SPARE/PATCH                        */
      245     8680        /**/
      246     8681        /* ENTRY POINTS  */
      247     8682        /**/
      248     8683    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
      249     8684        %VP_ENTRIES (OMIT=VPC$SETOUT);
      250     8892        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:108  
      251     8893    1           FPT_OPEN_OUT = FPT_OPEN_OUT_SAVE; /* Initialize the OPEN FPT          */

   8893 12 000002   000000 100400                    MLR     fill='000'O
        12 000003   000000 000350 xsym               ADSC9   FPT_OPEN_OUT_SAVE        cn=0,n=232
        12 000004   000000 000350 xsym               ADSC9   FPT_OPEN_OUT             cn=0,n=232

      252     8894    1           OUT_FID_GIVEN = %YES#;          /* Assume they gave a file name       */

   8894 12 000005   400000 236003                    LDQ     -131072,DU
        12 000006   200020 756100                    STQ     OUT_FID_GIVEN,,AUTO

      253     8895    1           IF CMD_MASK(1)                  /* IF 'COPY'...                       */

   8895 12 000007   000000 236000 xsym               LDQ     CMD_MASK
        12 000010   200000 316003                    CANQ    65536,DU
        12 000011   000016 600000 12                 TZE     s:8899

      254     8896    1            THEN
      255     8897    1              FPT_OPEN_OUT.V.DCB# = DCBNUM(M$EO);

   8897 12 000012   000000 236007 xsym               LDQ     M$EO,DL
        12 000013   000000 620006                    EAX0    0,QL
        12 000014   000044 740000 xsym               STX0    FPT_OPEN_OUT+36
        12 000015   000021 710000 12                 TRA     s:8900

      256     8898    1            ELSE
      257     8899    1              FPT_OPEN_OUT.V.DCB# = DCBNUM(M$EO1);

   8899 12 000016   000000 236007 xsym               LDQ     M$EO1,DL
        12 000017   000000 620006                    EAX0    0,QL
        12 000020   000044 740000 xsym               STX0    FPT_OPEN_OUT+36

      258     8900    1           IF OUT_SPEC$ ~= ADDR(NIL)       /* If output specifications exist     */

   8900 12 000021   200003 470500                    LDP0    @OUT_SPEC$,,AUTO
        12 000022   000000 236100                    LDQ     0,,PR0
        12 000023   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:109  
        12 000024   000140 600000 12                 TZE     s:8936

      259     8901    1            THEN
      260     8902    2            DO;                            /* AN OUTPUT SPEC IS PRESENT          */

      261     8903    2               OCB = '0'B;                 /* Clear all output specs             */

   8903 12 000025   000000 100400                    MLR     fill='000'O
        12 000026   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        12 000027   000000 001370 xsym               ADSC9   OCB                      cn=0,n=760

      262     8904    2               FPT_OPEN_OUT.V.INITZ.SCRUB# = %YES#;

   8904 12 000030   400000 236007                    LDQ     -131072,DL
        12 000031   000044 256000 xsym               ORSQ    FPT_OPEN_OUT+36

      263     8905    2               CALL PROCESS_FID;

   8905 12 000032   001163 701000 12                 TSX1    PROCESS_FID
        12 000033   000000 011000                    NOP     0

      264     8906    2               CALL GET_OUT_DEV_MASK;

   8906 12 000034   001362 701000 12                 TSX1    GET_OUT_DEV_MASK
        12 000035   000000 011000                    NOP     0

      265     8907    2               IF OCB.DEV_MASK & '001'O    /* If its a disk file                 */

   8907 12 000036   000255 236000 xsym               LDQ     OCB+173
        12 000037   777000 376003                    ANQ     -512,DU
        12 000040   001000 376003                    ANQ     512,DU
        12 000041   000060 600000 12                 TZE     s:8919

      266     8908    2                THEN
      267     8909    3                DO;

      268     8910    3                   FPT_OPEN_OUT.V.OPER.TEST# = %YES#;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:110  

   8910 12 000042   020000 236007                    LDQ     8192,DL
        12 000043   000044 256000 xsym               ORSQ    FPT_OPEN_OUT+36

      269     8911    3                   FPT_OPEN_OUT.V.FUN# = %IN#; /* TRY TO OPEN IT FOR INPUT       */

   8911 12 000044   002000 236007                    LDQ     1024,DL
        12 000045   000045 552010 xsym               STBQ    FPT_OPEN_OUT+37,'10'O

      270     8912    3                   OUT_FILE_EXISTS = %YES#;

   8912 12 000046   400000 236003                    LDQ     -131072,DU
        12 000047   200017 756100                    STQ     OUT_FILE_EXISTS,,AUTO

      271     8913    3                   CALL M$OPEN(FPT_OPEN_OUT)

   8913 12 000050   000000 630400 xsym               EPPR0   FPT_OPEN_OUT
        12 000051   450000 713400                    CLIMB   alt,open
        12 000052   410400 401760                    pmme    nvectors=18
        12 000053   000055 702000 12                 TSX2    s:8915
        12 000054   000056 710000 12                 TRA     s:8917

      272     8914    4                    WHENALTRETURN DO;

      273     8915    4                       OUT_FILE_EXISTS = %NO#;

   8915 12 000055   200017 450100                    STZ     OUT_FILE_EXISTS,,AUTO

      274     8916    4                       END;

      275     8917    3                   FPT_OPEN_OUT.V.OPER.TEST# = %NO#;

   8917 12 000056   000000 236000 13                 LDQ     0
        12 000057   000044 356000 xsym               ANSQ    FPT_OPEN_OUT+36

      276     8918    3                   END;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:111  
      277     8919    2               FPT_OPEN_OUT.V.CTG# = %NO#;

   8919 12 000060   000001 236000 13                 LDQ     1
        12 000061   000044 356000 xsym               ANSQ    FPT_OPEN_OUT+36

      278     8920    2               FPT_OPEN_OUT.V.FUN# = %CREATE#;

   8920 12 000062   003000 236007                    LDQ     1536,DL
        12 000063   000045 552010 xsym               STBQ    FPT_OPEN_OUT+37,'10'O

      279     8921    3               DO CASE(OUT_SPEC$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);

   8921 12 000064   200003 470500                    LDP0    @OUT_SPEC$,,AUTO
        12 000065   000000 471500                    LDP1    0,,PR0
        12 000066   100003 473500                    LDP3    3,,PR1
        12 000067   300000 720100                    LXL0    0,,PR3
        12 000070   000005 100003                    CMPX0   5,DU
        12 000071   000073 602010 12                 TNC     s:8921+7,X0
        12 000072   000114 710000 12                 TRA     s:8929
        12 000073   000114 710000 12                 TRA     s:8929
        12 000074   000100 710000 12                 TRA     s:8923
        12 000075   000100 710000 12                 TRA     s:8923
        12 000076   000105 710000 12                 TRA     s:8925
        12 000077   000110 710000 12                 TRA     s:8927

      280     8922    3                CASE(1,2);                 /* 'TO','ON'                          */

      281     8923    3                  FPT_OPEN_OUT.V.EXIST# = %ERROR#;

   8923 12 000100   000044 236000 xsym               LDQ     FPT_OPEN_OUT+36
        12 000101   000002 376000 13                 ANQ     2
        12 000102   000200 276007                    ORQ     128,DL
        12 000103   000044 756000 xsym               STQ     FPT_OPEN_OUT+36
        12 000104   000114 710000 12                 TRA     s:8929

      282     8924    3                CASE(3);                   /* 'OVER'                             */

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:112  
      283     8925    3                  FPT_OPEN_OUT.V.EXIST# = %NEWFILE#;

   8925 12 000105   000600 236007                    LDQ     384,DL
        12 000106   000044 256000 xsym               ORSQ    FPT_OPEN_OUT+36
        12 000107   000114 710000 12                 TRA     s:8929

      284     8926    3                CASE(4);                   /* 'INTO'                             */

      285     8927    3                  FPT_OPEN_OUT.V.EXIST# = %OLDFILE#;

   8927 12 000110   000044 236000 xsym               LDQ     FPT_OPEN_OUT+36
        12 000111   000002 376000 13                 ANQ     2
        12 000112   000400 276007                    ORQ     256,DL
        12 000113   000044 756000 xsym               STQ     FPT_OPEN_OUT+36

      286     8928    3                END;

      287     8929    2               CALL PROCESS_OPTS;

   8929 12 000114   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 000115   200023 756100                    STQ     OUT_FID_GIVEN+3,,AUTO
        12 000116   001455 701000 12                 TSX1    PROCESS_OPTS
        12 000117   000000 011000                    NOP     0

      288     8930    2               CALL NAME_AND_FPARAM;

   8930 12 000120   001007 701000 12                 TSX1    NAME_AND_FPARAM
        12 000121   000000 011000                    NOP     0

      289     8931    2               IF ~OUT_FID_GIVEN AND ~FPT_OPEN_OUT.V.INITZ.REASSIGN#

   8931 12 000122   200020 236100                    LDQ     OUT_FID_GIVEN,,AUTO
        12 000123   400000 376003                    ANQ     -131072,DU
        12 000124   400000 676003                    ERQ     -131072,DU
        12 000125   000241 600000 12                 TZE     s:8973
        12 000126   000044 236000 xsym               LDQ     FPT_OPEN_OUT+36
        12 000127   000023 736000                    QLS     19
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:113  
        12 000130   400000 376003                    ANQ     -131072,DU
        12 000131   400000 676003                    ERQ     -131072,DU
        12 000132   000241 600000 12                 TZE     s:8973

      290     8932    2                THEN
      291     8933    2                  CALL VPL$ERR_PROC(3,30,'03'O);

   8933 12 000133   000005 630400 13                 EPPR0   5
        12 000134   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 000135   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000136   000000 011000                    NOP     0

      292     8934    2               END;

   8934 12 000137   000241 710000 12                 TRA     s:8973

      293     8935    1            ELSE                           /* NO OUTPUT SPEC                     */
      294     8936    1              IF CMD_MASK(1)               /* COPY COMMAND                       */

   8936 12 000140   000000 236000 xsym               LDQ     CMD_MASK
        12 000141   200000 316003                    CANQ    65536,DU
        12 000142   000163 600000 12                 TZE     s:8949

      295     8937    1               THEN
      296     8938    2               DO;

      297     8939    2                  IF EO_OCB ='0'B          /* If last copy bombed                */

   8939 12 000143   000000 106400                    CMPC    fill='000'O
        12 000144   000000 001370 xsym               ADSC9   EO_OCB                   cn=0,n=760
        12 000145   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
        12 000146   000224 600000 12                 TZE     DEFAULT_TO_ME

      298     8940    2                   THEN
      299     8941    2                     GOTO DEFAULT_TO_ME;   /* Default to ME                      */
      300     8942    2                  FPT_OPEN_OUT.V.INITZ.SCRUB# = %NO#;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:114  
   8942 12 000147   000010 236000 13                 LDQ     8
        12 000150   000044 356000 xsym               ANSQ    FPT_OPEN_OUT+36

      301     8943    2                  OCB = EO_OCB;

   8943 12 000151   000000 100400                    MLR     fill='000'O
        12 000152   000000 001370 xsym               ADSC9   EO_OCB                   cn=0,n=760
        12 000153   000000 001370 xsym               ADSC9   OCB                      cn=0,n=760

      302     8944    2                  FPT_OPEN_OUT.V.FUN# = %CREATE#;

   8944 12 000154   003000 236007                    LDQ     1536,DL
        12 000155   000045 552010 xsym               STBQ    FPT_OPEN_OUT+37,'10'O

      303     8945    2                  FPT_OPEN_OUT.V.EXIST# = %OLDFILE#;

   8945 12 000156   000044 236000 xsym               LDQ     FPT_OPEN_OUT+36
        12 000157   000002 376000 13                 ANQ     2
        12 000160   000400 276007                    ORQ     256,DL
        12 000161   000044 756000 xsym               STQ     FPT_OPEN_OUT+36

      304     8946    2                  END;

   8946 12 000162   000241 710000 12                 TRA     s:8973

      305     8947    1               ELSE                        /* No output spec and not COPY        */
      306     8948    2               DO;

      307     8949    2                  FPT_OPEN_OUT.V.INITZ.SCRUB# = %YES#;

   8949 12 000163   400000 236007                    LDQ     -131072,DL
        12 000164   000044 256000 xsym               ORSQ    FPT_OPEN_OUT+36

      308     8950    2                  FPT_OPEN_OUT.V.FUN# = %CREATE#;

   8950 12 000165   003000 236007                    LDQ     1536,DL
        12 000166   000045 552010 xsym               STBQ    FPT_OPEN_OUT+37,'10'O
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:115  

      309     8951    2                  FPT_OPEN_OUT.V.EXIST# = %NEWFILE#;

   8951 12 000167   000600 236007                    LDQ     384,DL
        12 000170   000044 256000 xsym               ORSQ    FPT_OPEN_OUT+36

      310     8952    2                  IF CMD_MASK & '14'O      /* COPYALL AND COPYSTD DEFAULT        */

   8952 12 000171   000100 100400                    MLR     fill='000'O
        12 000172   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 000173   200130 000010                    ADSC9   @ERROR+2,,AUTO           cn=0,n=8
        12 000174   200130 237100                    LDAQ    @ERROR+2,,AUTO
        12 000175   000012 377000 13                 ANAQ    10
        12 000176   000224 600000 12                 TZE     DEFAULT_TO_ME

      311     8953    2                   THEN                    /* TO 'OVER DP'                       */
      312     8954    3                   DO;

      313     8955    3                      OCB = '0'B;

   8955 12 000177   000000 100400                    MLR     fill='000'O
        12 000200   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        12 000201   000000 001370 xsym               ADSC9   OCB                      cn=0,n=760

      314     8956    3                      OCB.FLAVOR.CARRY_ATTR = %YES#;

   8956 12 000202   400000 236003                    LDQ     -131072,DU
        12 000203   000256 256000 xsym               ORSQ    OCB+174

      315     8957    3                      CALL NAME_AND_FPARAM;

   8957 12 000204   001007 701000 12                 TSX1    NAME_AND_FPARAM
        12 000205   000000 011000                    NOP     0

      316     8958    3                      OCB = '0'B;

   8958 12 000206   000000 100400                    MLR     fill='000'O
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:116  
        12 000207   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        12 000210   000000 001370 xsym               ADSC9   OCB                      cn=0,n=760

      317     8959    3                      OCB.FLAVOR.CARRY_ATTR = %YES#;

   8959 12 000211   400000 236003                    LDQ     -131072,DU
        12 000212   000256 256000 xsym               ORSQ    OCB+174

      318     8960    3                      FPT_OPEN_OUT.V.ASN# = %FILE#;

   8960 12 000213   000001 236007                    LDQ     1,DL
        12 000214   000045 552004 xsym               STBQ    FPT_OPEN_OUT+37,'04'O

      319     8961    3                      OCB.DEV_MASK = '001'O; /* DISK file                        */

   8961 12 000215   001000 236003                    LDQ     512,DU
        12 000216   000255 756000 xsym               STQ     OCB+173

      320     8962    3                      FPT_OPEN_OUT.V.ORG# = M$EI$->F$DCB.ORG;

   8962 12 000217   000000 470400 xsym               LDP0    M$EI$
        12 000220   000032 236100                    LDQ     26,,PR0
        12 000221   000022 772000                    QRL     18
        12 000222   000046 552010 xsym               STBQ    FPT_OPEN_OUT+38,'10'O

      321     8963    3                      END;

   8963 12 000223   000241 710000 12                 TRA     s:8973

      322     8964    2                   ELSE
      323     8965    3                   DO;

      324     8966    3   DEFAULT_TO_ME:     EO_OCB.DEV_MASK = '040'O;

   8966 12 000224   040000 236003       DEFAULT_TO_* LDQ     16384,DU
        12 000225   000255 756000 xsym               STQ     EO_OCB+173

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:117  
      325     8967    3                      OCB = '0'B;

   8967 12 000226   000000 100400                    MLR     fill='000'O
        12 000227   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        12 000230   000000 001370 xsym               ADSC9   OCB                      cn=0,n=760

      326     8968    3                      FPT_OPEN_OUT.V.RES# = 'ME';

   8968 12 000231   001160 236000 11                 LDQ     CON_DUP_IDX+91
        12 000232   777777 376003                    ANQ     -1,DU
        12 000233   040040 276007                    ORQ     16416,DL
        12 000234   000050 756000 xsym               STQ     FPT_OPEN_OUT+40

      327     8969    3                      FPT_OPEN_OUT.V.ASN# = %DEVICE#;

   8969 12 000235   000003 236007                    LDQ     3,DL
        12 000236   000045 552004 xsym               STBQ    FPT_OPEN_OUT+37,'04'O

      328     8970    3                      OCB.DEV_MASK = '040'O; /* non FT device                    */

   8970 12 000237   040000 236003                    LDQ     16384,DU
        12 000240   000255 756000 xsym               STQ     OCB+173

      329     8971    3                      END;

      330     8972    2                  END;

      331     8973    1           OCB.DCBNM = FPT_OPEN_OUT.V.DCB#;

   8973 12 000241   000044 235000 xsym               LDA     FPT_OPEN_OUT+36
        12 000242   000022 771000                    ARL     18
        12 000243   000000 755000 xsym               STA     OCB

      332     8974    1           OCB.DCBPTR$ = DCBADDR(OCB.DCBNM);

   8974 12 000244   000011 470400 13                 LDP0    9
        12 000245   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:118  
        12 000246   100000 236105                    LDQ     0,AL,PR1
        12 000247   000001 756000 xsym               STQ     OCB+1

      333     8975        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:119  
      334     8976    1           IF OCB.FLAVOR.CARRY_ATTR AND ASN# = %TAPE#

   8976 12 000250   000256 234000 xsym               SZN     OCB+174
        12 000251   000321 605000 12                 TPL     s:8996
        12 000252   000060 236000 10                 LDQ     ASN#
        12 000253   777000 376003                    ANQ     -512,DU
        12 000254   002000 116003                    CMPQ    1024,DU
        12 000255   000321 601000 12                 TNZ     s:8996

      335     8977    1            THEN
      336     8978    2            DO;

      337     8979    2               IF OCB.ACCESS_FLG

   8979 12 000256   000254 234000 xsym               SZN     OCB+172
        12 000257   000264 605000 12                 TPL     s:8982

      338     8980    2                THEN
      339     8981    2                  CALL VPD$PROCESS_CONTROLS(9,FPT_OPEN_OUT.ACCESS_);

   8981 12 000260   000014 630400 13                 EPPR0   12
        12 000261   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000262   000000 701000 xent               TSX1    VPD$PROCESS_CONTROLS
        12 000263   000000 011000                    NOP     0

      340     8982    2               IF OCB.ACSVEH_FLG

   8982 12 000264   000252 234000 xsym               SZN     OCB+170
        12 000265   000272 605000 12                 TPL     s:8985

      341     8983    2                THEN
      342     8984    2                  CALL VPD$PROCESS_CONTROLS(10,FPT_OPEN_OUT.ACSVEH_);

   8984 12 000266   000016 630400 13                 EPPR0   14
        12 000267   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000270   000000 701000 xent               TSX1    VPD$PROCESS_CONTROLS
        12 000271   000000 011000                    NOP     0
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:120  

      343     8985    2               IF OCB.TYPE_BIT = '0'B      /* If no TYPE specified               */

   8985 12 000272   000043 236000 xsym               LDQ     OCB+35
        12 000273   000020 316000 13                 CANQ    16
        12 000274   000300 601000 12                 TNZ     s:8988

      344     8986    2                THEN
      345     8987    2                  FPT_OPEN_OUT.V.TYPE# = M$EI$->F$DCB.TYPE; /* Keep TYPE         */

   8987 12 000275   000000 470400 xsym               LDP0    M$EI$
        12 000276   000025 720100                    LXL0    21,,PR0
        12 000277   000047 740000 xsym               STX0    FPT_OPEN_OUT+39

      346     8988    3               IF USER_LABELS$ ~= ADDR(NIL) THEN DO;

   8988 12 000300   000000 236000 xsym               LDQ     USER_LABELS$
        12 000301   000001 116000 xsym               CMPQ    B_VECTNIL+1
        12 000302   000317 600000 12                 TZE     NOLBLS

      347     8989    3                   IF USER_LABELS$->B$WORD=0 THEN GOTO NOLBLS;
              8989                            /* No labels after all */

   8989 12 000303   000000 470400 xsym               LDP0    USER_LABELS$
        12 000304   000000 235100                    LDA     0,,PR0
        12 000305   000317 600000 12                 TZE     NOLBLS

      348     8990    3                   ADDR(FPT_OPEN_OUT.UHL_)->B$VECTOR.PTR$ = USER_LABELS$;

   8990 12 000306   000005 756000 xsym               STQ     FPT_OPEN_OUT+5

      349     8991    3                   ADDR(FPT_OPEN_OUT.UHL_)->B$VECTOR.W1.VSIZE# = USER_LABELS$->B$WORD*
              8991                            80+4-1;

   8991 12 000307   000000 236100                    LDQ     0,,PR0
        12 000310   000120 402007                    MPY     80,DL
        12 000311   000003 036007                    ADLQ    3,DL
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:121  
        12 000312   000020 736000                    QLS     16
        12 000313   000004 676000 xsym               ERQ     FPT_OPEN_OUT+4
        12 000314   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 000315   000004 656000 xsym               ERSQ    FPT_OPEN_OUT+4

      350     8992    3                   END;

   8992 12 000316   000321 710000 12                 TRA     s:8996

      351     8993    2                ELSE
      352     8994    2   NOLBLS:        FPT_OPEN_OUT.UHL_ = VECTOR(NIL);

   8994 12 000317   000022 237000 13    NOLBLS       LDAQ    18
        12 000320   000004 757000 xsym               STAQ    FPT_OPEN_OUT+4

      353     8995    2               END;

      354     8996    1           IF CMD_MASK(1)                  /* trying to be COPY                  */

   8996 12 000321   000000 236000 xsym               LDQ     CMD_MASK
        12 000322   200000 316003                    CANQ    65536,DU
        12 000323   000353 600000 12                 TZE     s:9007
        12 000324   000256 236000 xsym               LDQ     OCB+174
        12 000325   200000 316003                    CANQ    65536,DU
        12 000326   000353 601000 12                 TNZ     s:9007
        12 000327   000255 236000 xsym               LDQ     OCB+173
        12 000330   040000 316003                    CANQ    16384,DU
        12 000331   000353 600000 12                 TZE     s:9007

      355     8997    1             AND NOT OCB.FLAVOR.FORMATTED  /* and we won't muck with it          */
      356     8998    1             AND OCB.DEV_MASK.DEVICE       /* and to a device                    */
      357     8999    1            THEN
      358     9000    2            DO;                            /* See if an FPRG is specified in FIT */

      359     9001    2               I=17;                       /* VLP_FPRG is in CODE17              */

   9001 12 000332   000021 235007                    LDA     17,DL
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:122  
        12 000333   200005 755100                    STA     I,,AUTO

      360     9002    2               PTR$ = FPARAM$;

   9002 12 000334   000000 236000 xsym               LDQ     FPARAM$
        12 000335   200007 756100                    STQ     PTR$,,AUTO

      361     9003    2               CALL XSF$LOCCODP(PTR$,I) ALTRET (OPEN_IT);

   9003 12 000336   200005 630500                    EPPR0   I,,AUTO
        12 000337   200131 450500                    STP0    @ERROR+3,,AUTO
        12 000340   200007 631500                    EPPR1   PTR$,,AUTO
        12 000341   200130 451500                    STP1    @ERROR+2,,AUTO
        12 000342   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 000343   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000344   000000 701000 xent               TSX1    XSF$LOCCODP
        12 000345   000375 702000 12                 TSX2    OPEN_IT

      362     9004    2               FPT_OPEN_OUT.FPRG_ = VECTOR(PTR$->VLP_FPRG);

   9004 12 000346   000021 235000 13                 LDA     17
        12 000347   200007 236100                    LDQ     PTR$,,AUTO
        12 000350   000042 757000 xsym               STAQ    FPT_OPEN_OUT+34

      363     9005    2               FPT_OPEN_OUT.V.ORG# = %FPRG#;

   9005 12 000351   012000 236007                    LDQ     5120,DL
        12 000352   000046 552010 xsym               STBQ    FPT_OPEN_OUT+38,'10'O

      364     9006    2               END;

      365     9007    1           IF (FPT_OPEN_OUT.V.BLKL#~=0 OR FPT_OPEN_OUT.V.RECL#~=262143)

   9007 12 000353   000052 220000 xsym               LDX0    FPT_OPEN_OUT+42
        12 000354   000360 601000 12                 TNZ     s:9007+5
        12 000355   000052 721000 xsym               LXL1    FPT_OPEN_OUT+42
        12 000356   777777 101003                    CMPX1   -1,DU
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:123  
        12 000357   000375 600000 12                 TZE     OPEN_IT
        12 000360   000035 235000 xsym               LDA     OCB+29
        12 000361   000375 601000 12                 TNZ     OPEN_IT
        12 000362   000045 236000 xsym               LDQ     FPT_OPEN_OUT+37
        12 000363   000777 376007                    ANQ     511,DL
        12 000364   000003 116007                    CMPQ    3,DL
        12 000365   000375 601000 12                 TNZ     OPEN_IT
        12 000366   000050 221000 xsym               LDX1    FPT_OPEN_OUT+40
        12 000367   001161 101000 11                 CMPX1   CON_DUP_IDX+92
        12 000370   000375 601000 12                 TNZ     OPEN_IT

      366     9008    1             AND OCB.ORG=0 AND FPT_OPEN_OUT.V.ASN#=%DEVICE# AND
      367     9009    2             SUBSTR(FPT_OPEN_OUT.V.RES#,0,2)='FT' THEN DO;

      368     9010    2               FPT_OPEN_OUT.V.ORG# = %FIXED#;

   9010 12 000371   017000 236007                    LDQ     7680,DL
        12 000372   000046 552010 xsym               STBQ    FPT_OPEN_OUT+38,'10'O

      369     9011    2               OCB.ORG = 2;                /* PCL's code for FIXED               */

   9011 12 000373   000002 235007                    LDA     2,DL
        12 000374   000035 755000 xsym               STA     OCB+29

      370     9012    2               END;

   9010 12 000375                       OPEN_IT      null
      371     9013    1   OPEN_IT:;
      372     9014    1           CALL VPC$CALL_OPEN(FPT_OPEN_OUT) ALTRET(OPEN_OUT_ALT);

   9014 12 000375   000024 630400 13                 EPPR0   20
        12 000376   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000377   000000 701000 xent               TSX1    VPC$CALL_OPEN
        12 000400   000476 702000 12                 TSX2    OPEN_OUT_ALT

      373     9015    1           IF FPT_OPEN_OUT.V.EXIST# = %OLDFILE# /* INTO                          */

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:124  
   9015 12 000401   000044 236000 xsym               LDQ     FPT_OPEN_OUT+36
        12 000402   000600 376007                    ANQ     384,DL
        12 000403   000400 116007                    CMPQ    256,DL
        12 000404   000437 601000 12                 TNZ     s:9028
        12 000405   000045 236000 xsym               LDQ     FPT_OPEN_OUT+37
        12 000406   000777 376007                    ANQ     511,DL
        12 000407   000001 116007                    CMPQ    1,DL
        12 000410   000437 601000 12                 TNZ     s:9028
        12 000411   000035 235000 xsym               LDA     OCB+29
        12 000412   000437 604400 12                 TMOZ    s:9028
        12 000413   000001 470400 xsym               LDP0    OCB+1
        12 000414   000032 236100                    LDQ     26,,PR0
        12 000415   000033 772000                    QRL     27
        12 000416   200130 756100                    STQ     @ERROR+2,,AUTO
        12 000417   000035 236000 xsym               LDQ     OCB+29
        12 000420   000022 402007                    MPY     18,DL
        12 000421   000100 101406                    MRL     fill='000'O
        12 000422   000000 000001 xsym               ADSC9   ORG_TBL,Q                cn=0,n=1
        12 000423   200131 000004                    ADSC9   @ERROR+3,,AUTO           cn=0,n=4
        12 000424   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 000425   200130 116100                    CMPQ    @ERROR+2,,AUTO
        12 000426   000437 600000 12                 TZE     s:9028

      374     9016    1             AND FPT_OPEN_OUT.V.ASN# = %FILE# /* DISK                            */
      375     9017    1             AND OCB.ORG > 0               /* Specifying ORG                     */
      376     9018    1             AND ORG_TBL.ORG_MON(OCB.ORG) ~= OCB.DCBPTR$->F$DCB.ORG /* No take   */
      377     9019    1            THEN
      378     9020    2            DO;

      379     9021    2               CALL VPD$CLOSE_OUT(0);      /* Save the existing file             */

   9021 12 000427   000025 630400 13                 EPPR0   21
        12 000430   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000431   000000 701000 xent               TSX1    VPD$CLOSE_OUT
        12 000432   000000 011000                    NOP     0

      380     9022    2               CALL VPL$ERR_PROC(3,92,'03'O); /* ABORT Command                   */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:125  

   9022 12 000433   000027 630400 13                 EPPR0   23
        12 000434   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 000435   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000436   000000 011000                    NOP     0

      381     9023    2               END;

      382     9024        /*E*  ERROR: VPC-00092
      383     9025              MESSAGE: You can't change ORG when a file already EXISTS.
      384     9026         MESSAGE1: This operation is INTO an existing file, so it's ORG may not be changed.
      385     9027        */
      386     9028    1           OCB.DEV_MASK.IC = OCB.DCBPTR$->F$DCB.DDEV.IC;

   9028 12 000437   000001 470400 xsym               LDP0    OCB+1
        12 000440   000004 236100                    LDQ     4,,PR0
        12 000441   000020 736000                    QLS     16
        12 000442   000255 676000 xsym               ERQ     OCB+173
        12 000443   020000 376003                    ANQ     8192,DU
        12 000444   000255 656000 xsym               ERSQ    OCB+173

      387     9029    1           OCB.DEV_MASK.LP = OCB.DCBPTR$->F$DCB.DDEV.LP;

   9029 12 000445   000004 236100                    LDQ     4,,PR0
        12 000446   000015 736000                    QLS     13
        12 000447   000255 676000 xsym               ERQ     OCB+173
        12 000450   010000 376003                    ANQ     4096,DU
        12 000451   000255 656000 xsym               ERSQ    OCB+173

      388     9030    1           CALL VPD$GET_OUT_FLAVOR;

   9030 12 000452   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 000453   000000 701000 xent               TSX1    VPD$GET_OUT_FLAVOR
        12 000454   000000 011000                    NOP     0

      389     9031    1           CALL RECONCILE_DEFAULTS_AFTER_OPEN;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:126  
   9031 12 000455   001422 701000 12                 TSX1    RECONCILE_DEFAULTS_AFTER_OPEN
        12 000456   000000 011000                    NOP     0

      390     9032    1           IF OCB.FLAVOR.TAPE

   9032 12 000457   000256 236000 xsym               LDQ     OCB+174
        12 000460   004000 316003                    CANQ    2048,DU
        12 000461   000475 600000 12                 TZE     s:9035

      391     9033    1            THEN                           /* Tapes are invloved                 */
      392     9034    1              CALL VPD$CHECK_VOL(OUT_SN,0,OCB.DCBNM,,1); /* Check VOL transition */

   9034 12 000462   000032 236000 13                 LDQ     26
        12 000463   200134 756100                    STQ     @ERROR+6,,AUTO
        12 000464   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 000465   000033 235000 13                 LDA     27
        12 000466   200132 757100                    STAQ    @ERROR+4,,AUTO
        12 000467   000034 237000 13                 LDAQ    28
        12 000470   200130 757100                    STAQ    @ERROR+2,,AUTO
        12 000471   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 000472   000023 631400 xsym               EPPR1   B_VECTNIL+19
        12 000473   000000 701000 xent               TSX1    VPD$CHECK_VOL
        12 000474   000000 011000                    NOP     0

      393     9035    1           RETURN;

   9035 12 000475   000000 702200 xent               TSX2  ! X66_ARET

      394     9036    1   OPEN_OUT_ALT:
      395     9037    1          IF BREAKS=0 AND (OUTPUT_ERR.ERR# = %E$MNTBRK OR OUTPUT_ERR.ERR# = %E$TAPBRK)

   9037 12 000476   000000 235000 xsym  OPEN_OUT_ALT LDA     BREAKS
        12 000477   000506 601000 12                 TNZ     s:9040
        12 000500   000000 236000 xsym               LDQ     OUTPUT_ERR
        12 000501   377770 376007                    ANQ     131064,DL
        12 000502   012200 116007                    CMPQ    5248,DL
        12 000503   000375 600000 12                 TZE     OPEN_IT
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:127  
        12 000504   013160 116007                    CMPQ    5744,DL
        12 000505   000375 600000 12                 TZE     OPEN_IT

      396     9038    1            THEN
      397     9039    1              GOTO OPEN_IT;                /* CNTL-Y, GO                         */
      398     9040    1           IF NOT (CMD_MASK & '14'O)       /* IF NOT COPYSTD OR COPYALL          */

   9040 12 000506   000100 100400                    MLR     fill='000'O
        12 000507   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 000510   200130 000010                    ADSC9   @ERROR+2,,AUTO           cn=0,n=8
        12 000511   200130 237100                    LDAQ    @ERROR+2,,AUTO
        12 000512   000012 377000 13                 ANAQ    10
        12 000513   000533 601000 12                 TNZ     s:9046

      399     9041    1            THEN
      400     9042    1              CALL VPL$ERR_PROC(3,0,,OUTPUT_ERR,,,OCB.DCBNM); /* ABORT COMMAND   */

   9042 12 000514   000033 236000 13                 LDQ     27
        12 000515   200136 756100                    STQ     @ERROR+8,,AUTO
        12 000516   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 000517   000001 235000 xsym               LDA     B_VECTNIL+1
        12 000520   200134 757100                    STAQ    @ERROR+6,,AUTO
        12 000521   000036 236000 13                 LDQ     30
        12 000522   000001 235000 xsym               LDA     B_VECTNIL+1
        12 000523   200132 757100                    STAQ    @ERROR+4,,AUTO
        12 000524   000040 237000 13                 LDAQ    32
        12 000525   200130 757100                    STAQ    @ERROR+2,,AUTO
        12 000526   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 000527   000025 631400 xsym               EPPR1   B_VECTNIL+21
        12 000530   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000531   000000 011000                    NOP     0
        12 000532   000626 710000 12                 TRA     s:9056

      401     9043    1            ELSE
      402     9044    2            DO;                            /* CHECK IF THIS ERROR IS SEVERE      */

      403     9045                                                /* ENOUGH TO ABORT THE COMMAND        */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:128  
      404     9046    2               I=0;

   9046 12 000533   200005 450100                    STZ     I,,AUTO

      405     9047    3               DO WHILE(CMD_ABORT_ERR(I)~=0);

   9047 12 000534   200005 235100                    LDA     I,,AUTO
        12 000535   000001 735000                    ALS     1
        12 000536   000100 101405                    MRL     fill='000'O
        12 000537   000000 000002 11                 ADSC9   CMD_ABORT_ERR,A          cn=0,n=2
        12 000540   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 000541   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 000542   000000 116003                    CMPQ    0,DU
        12 000543   000610 600000 12                 TZE     s:9054

      406     9048    3                  IF CMD_ABORT_ERR(I) = OUTPUT_ERR.ERR#

   9048 12 000544   000000 236000 xsym               LDQ     OUTPUT_ERR
        12 000545   000003 772000                    QRL     3
        12 000546   037777 376007                    ANQ     16383,DL
        12 000547   200130 756100                    STQ     @ERROR+2,,AUTO
        12 000550   200005 235100                    LDA     I,,AUTO
        12 000551   000001 735000                    ALS     1
        12 000552   000100 101405                    MRL     fill='000'O
        12 000553   000000 000002 11                 ADSC9   CMD_ABORT_ERR,A          cn=0,n=2
        12 000554   200131 000004                    ADSC9   @ERROR+3,,AUTO           cn=0,n=4
        12 000555   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 000556   200130 116100                    CMPQ    @ERROR+2,,AUTO
        12 000557   000577 601000 12                 TNZ     s:9052

      407     9049    3                   THEN
      408     9050    3                     CALL VPL$ERR_PROC(3,0,,OUTPUT_ERR,,,OCB.DCBNM); /* ABORT CMD*/

   9050 12 000560   000033 236000 13                 LDQ     27
        12 000561   200136 756100                    STQ     @ERROR+8,,AUTO
        12 000562   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 000563   000001 235000 xsym               LDA     B_VECTNIL+1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:129  
        12 000564   200134 757100                    STAQ    @ERROR+6,,AUTO
        12 000565   000036 236000 13                 LDQ     30
        12 000566   000001 235000 xsym               LDA     B_VECTNIL+1
        12 000567   200132 757100                    STAQ    @ERROR+4,,AUTO
        12 000570   000040 237000 13                 LDAQ    32
        12 000571   200130 757100                    STAQ    @ERROR+2,,AUTO
        12 000572   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 000573   000025 631400 xsym               EPPR1   B_VECTNIL+21
        12 000574   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000575   000000 011000                    NOP     0
        12 000576   000600 710000 12                 TRA     s:9053

      409     9051    3                   ELSE
      410     9052    3                     I = I+1;

   9052 12 000577   200005 054100                    AOS     I,,AUTO

      411     9053    3                  END;

   9053 12 000600   200005 235100                    LDA     I,,AUTO
        12 000601   000001 735000                    ALS     1
        12 000602   000100 101405                    MRL     fill='000'O
        12 000603   000000 000002 11                 ADSC9   CMD_ABORT_ERR,A          cn=0,n=2
        12 000604   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 000605   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 000606   000000 116003                    CMPQ    0,DU
        12 000607   000544 601000 12                 TNZ     s:9048

      412     9054    2               CALL VPL$ERR_PROC(2,0,,OUTPUT_ERR,,,OCB.DCBNM); /* ABORT STEP     */

   9054 12 000610   000033 236000 13                 LDQ     27
        12 000611   200136 756100                    STQ     @ERROR+8,,AUTO
        12 000612   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 000613   000001 235000 xsym               LDA     B_VECTNIL+1
        12 000614   200134 757100                    STAQ    @ERROR+6,,AUTO
        12 000615   000036 236000 13                 LDQ     30
        12 000616   000001 235000 xsym               LDA     B_VECTNIL+1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:130  
        12 000617   200132 757100                    STAQ    @ERROR+4,,AUTO
        12 000620   000042 237000 13                 LDAQ    34
        12 000621   200130 757100                    STAQ    @ERROR+2,,AUTO
        12 000622   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 000623   000025 631400 xsym               EPPR1   B_VECTNIL+21
        12 000624   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000625   000000 011000                    NOP     0

      413     9055                                                /* JUST ABORT THE STEP                */
      414     9056    2               END;

   9056 12 000626   000631 710000 12                 TRA     s:9067

      415     9057        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:131  
      416     9058    1   VPC$SETMOD: ENTRY(OUT_SPEC$);

   9058 12 000627   000000 700200 xent  VPC$SETMOD   TSX0  ! X66_AUTO_1
        12 000630   000140 000001                    ZERO    96,1

      417     9059        /*D* NAME: VPC$SETMOD
      418     9060             CALL: CALL VPC$SETMOD(OUT_SPEC$);
      419     9061             DESCRIPTION: This entry point sets up for closing
      420     9062                          all selected files from the MODIFY command while
      421     9063                          processing the output fid into NAME and PASSWORD.
      422     9064                          They are placed into OCB.MOD_NAME and
      423     9065                          OCB.MOD_PASS.
      424     9066        */
      425     9067    1           OCB = '0'B;

   9067 12 000631   000000 100400                    MLR     fill='000'O
        12 000632   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        12 000633   000000 001370 xsym               ADSC9   OCB                      cn=0,n=760

      426     9068    1           OCB.DCBNM = DCBNUM(M$EI);

   9068 12 000634   000000 236007 xsym               LDQ     M$EI,DL
        12 000635   000000 756000 xsym               STQ     OCB

      427     9069    1           OCB.DCBPTR$ = DCBADDR(OCB.DCBNM);

   9069 12 000636   000011 470400 13                 LDP0    9
        12 000637   000000 471500                    LDP1    0,,PR0
        12 000640   100000 236106                    LDQ     0,QL,PR1
        12 000641   000001 756000 xsym               STQ     OCB+1

      428     9070    1           OCB.DEV_MASK = '001'O;          /* DISK file default                  */

   9070 12 000642   001000 236003                    LDQ     512,DU
        12 000643   000255 756000 xsym               STQ     OCB+173

      429     9071    1           ASN# = %FILE#;                  /* Assume FILE to modify, until M$FID */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:132  

   9071 12 000644   000060 756000 10                 STQ     ASN#

      430     9072    1           CALL VPD$GET_OUT_FLAVOR;

   9072 12 000645   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 000646   000000 701000 xent               TSX1    VPD$GET_OUT_FLAVOR
        12 000647   000000 011000                    NOP     0

      431     9073    2           DO I=0 TO OUT_SPEC$->OUT$BLK.NSUBLKS-1;

   9073 12 000650   200005 450100                    STZ     I,,AUTO
        12 000651   001000 710000 12                 TRA     s:9120+1

      432     9074    2              IF OUT_SPEC$->OUT$BLK.SUBLK$(I)->OUT$BLK.CODE=4

   9074 12 000652   200003 470500                    LDP0    @OUT_SPEC$,,AUTO
        12 000653   000000 471500                    LDP1    0,,PR0
        12 000654   200005 720100                    LXL0    I,,AUTO
        12 000655   100003 473510                    LDP3    3,X0,PR1
        12 000656   300000 721100                    LXL1    0,,PR3
        12 000657   000004 101003                    CMPX1   4,DU
        12 000660   000773 601000 12                 TNZ     s:9119

      433     9075    2               THEN
      434     9076    3               DO;                         /* A FID HAS BEEN SPECIFIED           */

      435     9077    3                  FPT_FID.TEXTFID_   = VECTOR(OUT_SPEC$->OUT$BLK.SUBLK$(I)->

   9077 12 000661   300004 236100                    LDQ     4,,PR3
        12 000662   000033 772000                    QRL     27
        12 000663   000064 737000                    LLS     52
        12 000664   000140 135007                    SBLA    96,DL
        12 000665   200130 453500                    STP3    @ERROR+2,,AUTO
        12 000666   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 000667   000044 036000 13                 ADLQ    36
        12 000670   000002 757000 10                 STAQ    FPT_FID+2
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:133  

      436     9078    3                    OUT$SYM.TEXT);
      437     9079    3                  CALL VPD$FID(FPT_FID);

   9079 12 000671   000045 630400 13                 EPPR0   37
        12 000672   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000673   000000 701000 xent               TSX1    VPD$FID
        12 000674   000000 011000                    NOP     0

      438     9080    3                  CALL GET_OUT_DEV_MASK;

   9080 12 000675   001362 701000 12                 TSX1    GET_OUT_DEV_MASK
        12 000676   000000 011000                    NOP     0

      439     9081    3                  IF ACCT#=' '

   9081 12 000677   000052 237000 10                 LDAQ    ACCT#
        12 000700   000046 117000 13                 CMPAQ   38
        12 000701   000704 601000 12                 TNZ     s:9084

      440     9082    3                   THEN
      441     9083    3                     RESULTS_FID.ACCT = '0'B;

   9083 12 000702   000050 236000 13                 LDQ     40
        12 000703   000030 356000 10                 ANSQ    RESULTS_FID

      442     9084    3                  IF RESULTS_FID.ACCT

   9084 12 000704   000030 236000 10                 LDQ     RESULTS_FID
        12 000705   200000 316003                    CANQ    65536,DU
        12 000706   000713 601000 12                 TNZ     s:9088
        12 000707   020000 316003                    CANQ    8192,DU
        12 000710   000713 601000 12                 TNZ     s:9088
        12 000711   040000 316003                    CANQ    16384,DU
        12 000712   000717 600000 12                 TZE     s:9092

      443     9085    3                    OR RESULTS_FID.WSN
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:134  
      444     9086    3                    OR RESULTS_FID.SN
      445     9087    3                   THEN
      446     9088    3                     CALL VPL$ERR_PROC(3,83,'03'O);

   9088 12 000713   000052 630400 13                 EPPR0   42
        12 000714   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 000715   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000716   000000 011000                    NOP     0

      447     9089        /*E*   ERROR: VPC-00083
      448     9090             MESSAGE: To FID may only contain NAME and/or PASSWORD
      449     9091        */
      450     9092    3                  IF RESULTS_FID.NAME

   9092 12 000717   000030 234000 10                 SZN     RESULTS_FID
        12 000720   000752 605000 12                 TPL     s:9108

      451     9093    3                   THEN                    /* Process MOD name                   */
      452     9094    4                   DO;

      453     9095    4                      IF RESULTS_FID.TYPE.NAME ~= %UMF$SIMPLE_STRING#

   9095 12 000721   000030 236000 10                 LDQ     RESULTS_FID
        12 000722   777000 316007                    CANQ    -512,DL
        12 000723   000727 600000 12                 TZE     s:9101

      454     9096    4                       THEN                /* NAME was octal or quoted           */
      455     9097    5                       DO;

      456     9098    5                          NAME_SPEC_TYPE = 1; /* Consider it a single file       */

   9098 12 000724   000001 235007                    LDA     1,DL
        12 000725   200004 755100                    STA     NAME_SPEC_TYPE,,AUTO

      457     9099    5                          GOTO ONE_FILE;

   9099 12 000726   000742 710000 12                 TRA     ONE_FILE
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:135  

      458     9100    5                          END;
      459     9101    4                      CALL VPD$ANAL_NAME(NAME#,NAME_SPEC_TYPE);

   9101 12 000727   200004 630500                    EPPR0   NAME_SPEC_TYPE,,AUTO
        12 000730   200131 450500                    STP0    @ERROR+3,,AUTO
        12 000731   000055 236000 13                 LDQ     45
        12 000732   200130 756100                    STQ     @ERROR+2,,AUTO
        12 000733   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 000734   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000735   000000 701000 xent               TSX1    VPD$ANAL_NAME
        12 000736   000000 011000                    NOP     0

      460     9102    4                      IF NAME_SPEC_TYPE = 1

   9102 12 000737   200004 235100                    LDA     NAME_SPEC_TYPE,,AUTO
        12 000740   000001 115007                    CMPA    1,DL
        12 000741   000746 601000 12                 TNZ     s:9106

      461     9103    4                       THEN                /* Single fid output                  */
      462     9104    4   ONE_FILE:             OCB.MOD_NAME = NAME#;

   9104 12 000742   000000 100400       ONE_FILE     MLR     fill='000'O
        12 000743   000042 000040 10                 ADSC9   NAME#                    cn=0,n=32
        12 000744   000231 000040 xsym               ADSC9   OCB+153                  cn=0,n=32
        12 000745   000752 710000 12                 TRA     s:9108

      463     9105    4                       ELSE                /* Wild output fid                    */
      464     9106    4                         CALL VPD$MAKE_WILD_OUT(NAME#,OCB.MOD_NAME);

   9106 12 000746   000056 630400 13                 EPPR0   46
        12 000747   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000750   000000 701000 xent               TSX1    VPD$MAKE_WILD_OUT
        12 000751   000000 011000                    NOP     0

      465     9107    4                      END;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:136  
      466     9108    3                  IF RESULTS_FID.PASS

   9108 12 000752   000030 236000 10                 LDQ     RESULTS_FID
        12 000753   100000 316003                    CANQ    32768,DU
        12 000754   000777 600000 12                 TZE     s:9120

      467     9109    4                   THEN DO;

      468     9110    4                      OCB.MOD_PASS_FLG = %YES#;

   9110 12 000755   400000 236003                    LDQ     -131072,DU
        12 000756   000243 756000 xsym               STQ     OCB+163

      469     9111    4                      IF PASSB#='0'B

   9111 12 000757   000054 237000 10                 LDAQ    PASS#
        12 000760   000060 117000 13                 CMPAQ   48
        12 000761   000767 601000 12                 TNZ     s:9115

      470     9112    4                       THEN
      471     9113    4                         OCB.MOD_PASS = ' '; /* This will remove any password    */

   9113 12 000762   000035 235000 xsym               LDA     B_VECTNIL+29
        12 000763   000035 236000 xsym               LDQ     B_VECTNIL+29
        12 000764   000241 755000 xsym               STA     OCB+161
        12 000765   000242 756000 xsym               STQ     OCB+162
        12 000766   000777 710000 12                 TRA     s:9120

      472     9114    4                       ELSE
      473     9115    4                         OCB.MOD_PASS = PASS#;

   9115 12 000767   000054 237000 10                 LDAQ    PASS#
        12 000770   000241 755000 xsym               STA     OCB+161
        12 000771   000242 756000 xsym               STQ     OCB+162

      474     9116    4                      END;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:137  
      475     9117    3                  END;

   9117 12 000772   000777 710000 12                 TRA     s:9120

      476     9118    2               ELSE
      477     9119    2                 CALL PROCESS_MOD_OPTS(OUT_SPEC$->OUT$BLK.SUBLK$(I));

   9119 12 000773   100003 634510                    EPPR4   3,X0,PR1
        12 000774   200023 454500                    STP4    OUT_FID_GIVEN+3,,AUTO
        12 000775   001457 701000 12                 TSX1    PROCESS_MOD_OPTS
        12 000776   000000 011000                    NOP     0

      478     9120    2              END;

   9120 12 000777   200005 054100                    AOS     I,,AUTO
        12 001000   200003 470500                    LDP0    @OUT_SPEC$,,AUTO
        12 001001   000000 471500                    LDP1    0,,PR0
        12 001002   100001 236100                    LDQ     1,,PR1
        12 001003   000022 772000                    QRL     18
        12 001004   200005 116100                    CMPQ    I,,AUTO
        12 001005   000652 605400 12                 TPNZ    s:9074

      479     9121    1           RETURN;

   9121 12 001006   000000 702200 xent               TSX2  ! X66_ARET

      480     9122        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:138  
      481     9123    1   NAME_AND_FPARAM: PROC;

   9123 12 001007   200022 741300       NAME_AND_FP* STX1  ! OUT_FID_GIVEN+2,,AUTO

      482     9124        /*I* NAME: NAME_AND_FPARAM
      483     9125             PURPOSE: To handle NAME and FPARAM transfer for COPY commands.
      484     9126             CALL: CALL NAME_AND_FPARAM;
      485     9127             DESCRIPTION: This procedure moves the name of the input file to the
      486     9128                          open fpt for the output file for COPYALL and COPYSTD commands
      487     9129                          when necessary. It also decides whether or not to
      488     9130                          transfer the FPARAM buffer from the input file to the
      489     9131                          output file.
      490     9132        */
      491     9133        /**/
      492     9134    2   DCL VECTR VECTOR;
      493     9135        /**/
      494     9136    2           IF (CMD_MASK & '14'O/* COPYALL or COPYSTD */)~='0'B

   9136 12 001010   000100 100400                    MLR     fill='000'O
        12 001011   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 001012   200130 000010                    ADSC9   @ERROR+2,,AUTO           cn=0,n=8
        12 001013   200130 237100                    LDAQ    @ERROR+2,,AUTO
        12 001014   000012 377000 13                 ANAQ    10
        12 001015   001024 600000 12                 TZE     s:9136+12
        12 001016   200003 470500                    LDP0    @OUT_SPEC$,,AUTO
        12 001017   000000 236100                    LDQ     0,,PR0
        12 001020   000001 116000 xsym               CMPQ    B_VECTNIL+1
        12 001021   001042 600000 12                 TZE     s:9141
        12 001022   000030 234000 10                 SZN     RESULTS_FID
        12 001023   001042 605000 12                 TPL     s:9141
        12 001024   000000 236000 xsym               LDQ     CMD_MASK
        12 001025   200000 316003                    CANQ    65536,DU
        12 001026   001044 600000 12                 TZE     s:9142
        12 001027   000045 236000 xsym               LDQ     FPT_OPEN_OUT+37
        12 001030   000777 376007                    ANQ     511,DL
        12 001031   000002 116007                    CMPQ    2,DL
        12 001032   001044 601000 12                 TNZ     s:9142
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:139  
        12 001033   000030 236000 10                 LDQ     RESULTS_FID
        12 001034   400000 376003                    ANQ     -131072,DU
        12 001035   400000 676003                    ERQ     -131072,DU
        12 001036   001044 600000 12                 TZE     s:9142
        12 001037   000017 235000 xsym               LDA     ICB+15
        12 001040   000001 115007                    CMPA    1,DL
        12 001041   001044 601000 12                 TNZ     s:9142

      495     9137    2             AND (OUT_SPEC$=ADDR(NIL) OR RESULTS_FID.NAME='0'B)
      496     9138    2             OR (CMD_MASK(1) AND FPT_OPEN_OUT.V.ASN#=%TAPE# AND ~RESULTS_FID.NAME AND
              9138                      ICB.SPEC_TYPE = 1)
      497     9139                                                /* Not output wildcarded              */
      498     9140    2            THEN
      499     9141    2              FPT_OPEN_OUT.NAME_ = VECTOR(DIN_NAME);

   9141 12 001042   000062 237000 13                 LDAQ    50
        12 001043   000006 757000 xsym               STAQ    FPT_OPEN_OUT+6

      500     9142    2           IF NOT OCB.NFA                  /* If not NFA                         */

   9142 12 001044   000025 234000 xsym               SZN     OCB+21
        12 001045   001063 604000 12                 TMI     s:9150
        12 001046   000256 234000 xsym               SZN     OCB+174
        12 001047   001063 605000 12                 TPL     s:9150

      501     9143    2             AND OCB.FLAVOR.CARRY_ATTR     /* and trying to carry attributes     */
      502     9144    3            THEN DO;

      503     9145    3               VECTR = VECTOR (NIL);       /* For flags                          */

   9145 12 001050   000022 237000 13                 LDAQ    18
        12 001051   200024 757100                    STAQ    VECTR,,AUTO

      504     9146    3               VBASE(VECTR) = FPARAM$;

   9146 12 001052   000000 236000 xsym               LDQ     FPARAM$
        12 001053   200025 756100                    STQ     OPTIONS$+1,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:140  

      505     9147    3               VBOUND(VECTR) = FPARAM_BOUND;

   9147 12 001054   000000 236000 xsym               LDQ     FPARAM_BOUND
        12 001055   000020 736000                    QLS     16
        12 001056   200024 676100                    ERQ     VECTR,,AUTO
        12 001057   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 001060   200024 656100                    ERSQ    VECTR,,AUTO

      506     9148    3               FPT_OPEN_OUT.IFPARAM_ = VECTR;

   9148 12 001061   200024 237100                    LDAQ    VECTR,,AUTO
        12 001062   000026 757000 xsym               STAQ    FPT_OPEN_OUT+22

      507     9149    3               END;

      508     9150    3           IF M$EI$->F$DCB.ORG = %VARIABLE# THEN DO; /* Damn IBM tapes!          */

   9150 12 001063   000000 470400 xsym               LDP0    M$EI$
        12 001064   000032 236100                    LDQ     26,,PR0
        12 001065   777000 376003                    ANQ     -512,DU
        12 001066   020000 116003                    CMPQ    8192,DU
        12 001067   001161 601000 12                 TNZ     s:9167

      509     9151    3               FPT_OPEN_OUT.V.CNVRT#  = M$EI$->F$DCB.CNVRT;

   9151 12 001070   000031 236100                    LDQ     25,,PR0
        12 001071   200000 376007                    ANQ     65536,DL
        12 001072   000021 736000                    QLS     17
        12 001073   000060 676000 xsym               ERQ     FPT_OPEN_OUT+48
        12 001074   140000 376003                    ANQ     49152,DU
        12 001075   000060 656000 xsym               ERSQ    FPT_OPEN_OUT+48

      510     9152    3               FPT_OPEN_OUT.V.BLKL#   = M$EI$->F$DCB.BLKL;

   9152 12 001076   000033 220100                    LDX0    27,,PR0
        12 001077   000052 740000 xsym               STX0    FPT_OPEN_OUT+42
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:141  

      511     9153    3               FPT_OPEN_OUT.V.RECL#   = M$EI$->F$DCB.RECL;

   9153 12 001100   000033 722100                    LXL2    27,,PR0
        12 001101   000052 442000 xsym               SXL2    FPT_OPEN_OUT+42

      512     9154    3               FPT_OPEN_OUT.V.EBCDIC# = M$EI$->F$DCB.EBCDIC;

   9154 12 001102   000031 236100                    LDQ     25,,PR0
        12 001103   100000 376007                    ANQ     32768,DL
        12 001104   000024 736000                    QLS     20
        12 001105   000060 676000 xsym               ERQ     FPT_OPEN_OUT+48
        12 001106   600000 376003                    ANQ     -65536,DU
        12 001107   000060 656000 xsym               ERSQ    FPT_OPEN_OUT+48

      513     9155    3               FPT_OPEN_OUT.V.BLOCKED# = M$EI$->F$DCB.BLOCKED;

   9155 12 001110   000031 236100                    LDQ     25,,PR0
        12 001111   000010 376007                    ANQ     8,DL
        12 001112   000014 736000                    QLS     12
        12 001113   000047 676000 xsym               ERQ     FPT_OPEN_OUT+39
        12 001114   140000 376007                    ANQ     49152,DL
        12 001115   000047 656000 xsym               ERSQ    FPT_OPEN_OUT+39

      514     9156    3               FPT_OPEN_OUT.V.SPANNED# = M$EI$->F$DCB.SPANNED;

   9156 12 001116   000031 236100                    LDQ     25,,PR0
        12 001117   000004 376007                    ANQ     4,DL
        12 001120   000013 736000                    QLS     11
        12 001121   000047 676000 xsym               ERQ     FPT_OPEN_OUT+39
        12 001122   030000 376007                    ANQ     12288,DL
        12 001123   000047 656000 xsym               ERSQ    FPT_OPEN_OUT+39

      515     9157    3               IF FPT_OPEN_OUT.V.SPANNED# = '0'B THEN
              9157                        /* Non-SPANNED have bogus record lengths */

   9157 12 001124   000047 236000 xsym               LDQ     FPT_OPEN_OUT+39
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:142  
        12 001125   030000 316007                    CANQ    12288,DL
        12 001126   001131 601000 12                 TNZ     s:9159

      516     9158    3                  FPT_OPEN_OUT.V.RECL# = FPT_OPEN_OUT.V.RECL# - 4; /* So fix it  */

   9158 12 001127   777774 623012                    EAX3    -4,X2
        12 001130   000052 443000 xsym               SXL3    FPT_OPEN_OUT+42

      517     9159    3               IF OCB.ORG = 0 THEN         /* NO OUTPUT ORG SPECIFIED            */

   9159 12 001131   000035 235000 xsym               LDA     OCB+29
        12 001132   001136 601000 12                 TNZ     s:9161

      518     9160    3                  FPT_OPEN_OUT.V.ORG# = M$EI$->F$DCB.ORG;

   9160 12 001133   000032 236100                    LDQ     26,,PR0
        12 001134   000022 772000                    QRL     18
        12 001135   000046 552010 xsym               STBQ    FPT_OPEN_OUT+38,'10'O

      519     9161    3               OCB.ORG = %MAX_ORG#;

   9161 12 001136   000032 236007                    LDQ     26,DL
        12 001137   000035 756000 xsym               STQ     OCB+29

      520     9162    4               DO WHILE (OCB.ORG > 0 AND

   9162 12 001140   001143 710000 12                 TRA     s:9165

      521     9163    4                 ORG_TBL.ORG_MON(OCB.ORG) ~= FPT_OPEN_OUT.V.ORG#);
      522     9164    4                  OCB.ORG = OCB.ORG - 1;

   9164 12 001141   000001 336007                    LCQ     1,DL
        12 001142   000035 056000 xsym               ASQ     OCB+29

      523     9165    4                  END;

   9165 12 001143   000035 235000 xsym               LDA     OCB+29
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:143  
        12 001144   001161 604400 12                 TMOZ    s:9167
        12 001145   000046 236000 xsym               LDQ     FPT_OPEN_OUT+38
        12 001146   000011 772000                    QRL     9
        12 001147   000777 376007                    ANQ     511,DL
        12 001150   200130 756100                    STQ     @ERROR+2,,AUTO
        12 001151   000035 236000 xsym               LDQ     OCB+29
        12 001152   000022 402007                    MPY     18,DL
        12 001153   000100 101406                    MRL     fill='000'O
        12 001154   000000 000001 xsym               ADSC9   ORG_TBL,Q                cn=0,n=1
        12 001155   200131 000004                    ADSC9   @ERROR+3,,AUTO           cn=0,n=4
        12 001156   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 001157   200130 116100                    CMPQ    @ERROR+2,,AUTO
        12 001160   001141 601000 12                 TNZ     s:9164

      524     9166    3               END;

      525     9167    2   END NAME_AND_FPARAM;

   9167 12 001161   200022 221300                    LDX1  ! OUT_FID_GIVEN+2,,AUTO
        12 001162   000001 702211                    TSX2  ! 1,X1

      526     9168        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:144  
      527     9169    1   PROCESS_FID: PROC;

   9169 12 001163   200022 741300       PROCESS_FID  STX1  ! OUT_FID_GIVEN+2,,AUTO

      528     9170        /*I* NAME: PROCESS_FID
      529     9171             PURPOSE: To parse and validate the output fid
      530     9172             CALL: CALL PROCESS_FID;
      531     9173             DESCRIPTION: The output fid is sent to M$FID to be parsed. On its
      532     9174                          successful return, the fid is checked to be sure that
      533     9175                          COPYALL and COPYSTD commands to managed disk
      534     9176                          files don't specify a filename, or that other commands
      535     9177                          to managed disk files do specify a filename. If no errors
      536     9178                          occur, the fid pieces are merged into the output file's
      537     9179                          OPEN FPT.
      538     9180        */
      539     9181        /**/
      540     9182        /*  STATIC DATA  */
      541     9183        /**/
      542     9184    2   DCL NAME_SPEC_TYPE SBIN WORD;
      543     9185    2   DCL 1 TNAME#,
      544     9186    2         2 L UBIN BYTE UNAL,
      545     9187    2         2 C CHAR(31);
      546     9188    2   DCL IDX SBIN WORD;
      547     9189        /**/
      548     9190    2           FPT_FID.TEXTFID_   = VECTOR(OUT_SPEC$->OUT$BLK.SUBLK$(1)->

   9190 12 001164   200003 470500                    LDP0    @OUT_SPEC$,,AUTO
        12 001165   000000 471500                    LDP1    0,,PR0
        12 001166   100004 473500                    LDP3    4,,PR1
        12 001167   300003 474500                    LDP4    3,,PR3
        12 001170   000100 101500                    MRL     fill='000'O
        12 001171   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        12 001172   200130 000002                    ADSC9   @ERROR+2,,AUTO           cn=0,n=2
        12 001173   200130 220100                    LDX0    @ERROR+2,,AUTO
        12 001174   000000 635010                    EAA     0,X0
        12 001175   000002 771000                    ARL     2
        12 001176   000140 135007                    SBLA    96,DL
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:145  
        12 001177   200131 454500                    STP4    @ERROR+3,,AUTO
        12 001200   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 001201   200000 036007                    ADLQ    65536,DL
        12 001202   000002 757000 10                 STAQ    FPT_FID+2

      549     9191    2             OUT$BLK.SUBLK$(0)->TEXT$C.STRING);
      550     9192    2           CALL VPD$FID(FPT_FID);

   9192 12 001203   000045 630400 13                 EPPR0   37
        12 001204   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001205   000000 701000 xent               TSX1    VPD$FID
        12 001206   000000 011000                    NOP     0

      551     9193    2           IF CMD_MASK & '14'O             /* COPYALL OR COPYSTD                 */

   9193 12 001207   000100 100400                    MLR     fill='000'O
        12 001210   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 001211   200130 000010                    ADSC9   @ERROR+2,,AUTO           cn=0,n=8
        12 001212   200130 237100                    LDAQ    @ERROR+2,,AUTO
        12 001213   000012 377000 13                 ANAQ    10
        12 001214   001270 600000 12                 TZE     s:9228

      552     9194    2            THEN                           /* ARE THE ONLY COMMANDS WHERE        */
      553     9195                                                /* ASN=FILE# FIDS WITH A BLANK        */
      554     9196                                                /* OR NONEXISTANT FILENAME ARE        */
      555     9197                                                /* REQUIRED OR TOLERATED              */
      556     9198    3            DO;

      557     9199    3               IF RESULTS_FID.NAME

   9199 12 001215   000030 234000 10                 SZN     RESULTS_FID
        12 001216   001320 605000 12                 TPL     s:9254

      558     9200    3                THEN
      559     9201    4                DO;

      560     9202    4                   IF RESULTS_FID.TYPE.NAME ~= %UMF$SIMPLE_STRING#
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:146  

   9202 12 001217   000030 236000 10                 LDQ     RESULTS_FID
        12 001220   777000 316007                    CANQ    -512,DL
        12 001221   001225 600000 12                 TZE     s:9208

      561     9203    4                    THEN                   /* NAME was octal or quoted           */
      562     9204    5                    DO;

      563     9205    5                       NAME_SPEC_TYPE = 1; /* Consider as single file            */

   9205 12 001222   000001 235007                    LDA     1,DL
        12 001223   200023 755100                    STA     NAME_SPEC_TYPE,,AUTO

      564     9206    5                       GOTO SINGLE_FILE;

   9206 12 001224   001240 710000 12                 TRA     SINGLE_FILE

      565     9207    5                       END;
      566     9208    4                   CALL VPD$ANAL_NAME(NAME#,NAME_SPEC_TYPE);

   9208 12 001225   200023 630500                    EPPR0   NAME_SPEC_TYPE,,AUTO
        12 001226   200131 450500                    STP0    @ERROR+3,,AUTO
        12 001227   000055 236000 13                 LDQ     45
        12 001230   200130 756100                    STQ     @ERROR+2,,AUTO
        12 001231   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 001232   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001233   000000 701000 xent               TSX1    VPD$ANAL_NAME
        12 001234   000000 011000                    NOP     0

      567     9209    4                   IF NAME_SPEC_TYPE = 1

   9209 12 001235   200023 235100                    LDA     NAME_SPEC_TYPE,,AUTO
        12 001236   000001 115007                    CMPA    1,DL
        12 001237   001244 601000 12                 TNZ     s:9212

      568     9210    4                    THEN
      569     9211    4   SINGLE_FILE:       CALL VPL$ERR_PROC(3,86,'03'O);
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:147  

   9211 12 001240   000065 630400 13    SINGLE_FILE  EPPR0   53
        12 001241   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 001242   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 001243   000000 011000                    NOP     0

      570     9212    4                   IF NAME_SPEC_TYPE ~= 4 AND NAME_SPEC_TYPE ~= 5

   9212 12 001244   200023 235100                    LDA     NAME_SPEC_TYPE,,AUTO
        12 001245   000004 115007                    CMPA    4,DL
        12 001246   001254 600000 12                 TZE     s:9217
        12 001247   000005 115007                    CMPA    5,DL
        12 001250   001254 600000 12                 TZE     s:9217

      571     9213    4                    THEN                   /* No wildcard for output             */
      572     9214    4                      RESULTS_FID.NAME = %NO#;

   9214 12 001251   000031 236000 xsym               LDQ     B_VECTNIL+25
        12 001252   000030 356000 10                 ANSQ    RESULTS_FID
        12 001253   001320 710000 12                 TRA     s:9254

      573     9215    4                    ELSE                   /* Make an output name                */
      574     9216    5                    DO;

      575     9217    5                       TNAME# = NAME#;

   9217 12 001254   000100 100400                    MLR     fill='000'O
        12 001255   000042 000040 10                 ADSC9   NAME#                    cn=0,n=32
        12 001256   200024 000040                    ADSC9   TNAME#,,AUTO             cn=0,n=32

      576     9218    5                       CALL VPD$MAKE_WILD_OUT(TNAME#,NAME#);

   9218 12 001257   000055 236000 13                 LDQ     45
        12 001260   200131 756100                    STQ     @ERROR+3,,AUTO
        12 001261   200024 630500                    EPPR0   TNAME#,,AUTO
        12 001262   200130 450500                    STP0    @ERROR+2,,AUTO
        12 001263   200130 630500                    EPPR0   @ERROR+2,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:148  
        12 001264   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001265   000000 701000 xent               TSX1    VPD$MAKE_WILD_OUT
        12 001266   000000 011000                    NOP     0

      577     9219    5                       END;

      578     9220    4                   END;

      579     9221    3               END;

   9221 12 001267   001320 710000 12                 TRA     s:9254

      580     9222        /*E* ERROR:   VPC-00086
      581     9223             MESSAGE: Filename not allowed
      582     9224            MESSAGE1: Filename not allowed in destination fid
      583     9225        */
      584     9226    2            ELSE                           /* Vanilla COPY, LIST, etc.           */
      585     9227    3            DO;

      586     9228    3               IF ASN#=%FILE#

   9228 12 001270   000060 236000 10                 LDQ     ASN#
        12 001271   777000 376003                    ANQ     -512,DU
        12 001272   001000 116003                    CMPQ    512,DU
        12 001273   001320 601000 12                 TNZ     s:9254

      587     9229    3                THEN                       /* FILE, NAME is required             */
      588     9230    4                DO;

      589     9231    4                   IF ~RESULTS_FID.NAME

   9231 12 001274   000030 236000 10                 LDQ     RESULTS_FID
        12 001275   400000 376003                    ANQ     -131072,DU
        12 001276   400000 676003                    ERQ     -131072,DU
        12 001277   001301 600000 12                 TZE     s:9238

      590     9232    4                    THEN                   /* NAME required but missing          */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:149  
      591     9233    4                      OUT_FID_GIVEN = %NO#;

   9233 12 001300   200020 450100                    STZ     OUT_FID_GIVEN,,AUTO

      592     9234        /*E* ERROR:   VPC-00030
      593     9235             MESSAGE: Filename needed
      594     9236            MESSAGE1: Filename needed but not available in destination fid
      595     9237        */
      596     9238    4                   IF RESULTS_FID.TYPE.NAME = %UMF$SIMPLE_STRING# /* Straight    */

   9238 12 001301   000030 236000 10                 LDQ     RESULTS_FID
        12 001302   777000 316007                    CANQ    -512,DL
        12 001303   001320 601000 12                 TNZ     s:9254

      597     9239    4                    THEN                   /* May (accidently) contain '?'       */
      598     9240    5                    DO;

      599     9241    5                       CALL INDEX(IDX,'?',NAME#.C);

   9241 12 001304   000000 124400                    SCM     mask='000'O
        12 001305   000042 200037 10                 ADSC9   NAME#                    cn=1,n=31
        12 001306   000070 000001 13                 ADSC9   56                       cn=0,n=1
        12 001307   200034 000100                    ARG     IDX,,AUTO

      600     9242    5                       IF IDX < NAME#.L

   9242 12 001310   000042 236000 10                 LDQ     NAME#
        12 001311   000033 772000                    QRL     27
        12 001312   200034 116100                    CMPQ    IDX,,AUTO
        12 001313   001320 604400 12                 TMOZ    s:9254

      601     9243    5                        THEN               /* Vanilla COPY NAME contains '?'     */
      602     9244    5                          CALL VPL$ERR_PROC(3,91,'03'O);

   9244 12 001314   000072 630400 13                 EPPR0   58
        12 001315   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 001316   000000 701000 xent               TSX1    VPL$ERR_PROC
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:150  
        12 001317   000000 011000                    NOP     0

      603     9245    5                       END;

      604     9246        /*E* ERROR:   VPC-00091
      605     9247             MESSAGE: Wildcarding not legal here
      606     9248            MESSAGE1: COPY command may not have a wildcard output name
      607     9249        */
      608     9250    4                   END;

      609     9251    3                ELSE                       /* Not a FILE                         */
      610     9252    3                  ;                        /* Don't bother checking NAME         */
      611     9253    3               END;

      612     9254    2           IF RESULTS_FID.NAME

   9254 12 001320   000030 234000 10                 SZN     RESULTS_FID
        12 001321   001324 605000 12                 TPL     s:9257

      613     9255    2            THEN
      614     9256    2              FPT_OPEN_OUT.NAME_ = VECTOR(NAME#);

   9256 12 001322   000076 237000 13                 LDAQ    62
        12 001323   000006 757000 xsym               STAQ    FPT_OPEN_OUT+6

      615     9257    2           IF RESULTS_FID.ACCT

   9257 12 001324   000030 236000 10                 LDQ     RESULTS_FID
        12 001325   200000 316003                    CANQ    65536,DU
        12 001326   001331 600000 12                 TZE     s:9260

      616     9258    2            THEN
      617     9259    2              FPT_OPEN_OUT.ACCT_ = VECTOR(ACCT#);

   9259 12 001327   000100 237000 13                 LDAQ    64
        12 001330   000024 757000 xsym               STAQ    FPT_OPEN_OUT+20

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:151  
      618     9260    2           IF RESULTS_FID.PASS

   9260 12 001331   000030 236000 10                 LDQ     RESULTS_FID
        12 001332   100000 316003                    CANQ    32768,DU
        12 001333   001336 600000 12                 TZE     s:9263

      619     9261    2            THEN
      620     9262    2              FPT_OPEN_OUT.PASS_ = VECTOR(PASS#);

   9262 12 001334   000102 237000 13                 LDAQ    66
        12 001335   000010 757000 xsym               STAQ    FPT_OPEN_OUT+8

      621     9263    2           IF RESULTS_FID.SN

   9263 12 001336   000030 236000 10                 LDQ     RESULTS_FID
        12 001337   040000 316003                    CANQ    16384,DU
        12 001340   001343 600000 12                 TZE     s:9266

      622     9264    2            THEN
      623     9265    2              FPT_OPEN_OUT.SN_ = VECTOR(OUT_SN);

   9265 12 001341   000104 237000 13                 LDAQ    68
        12 001342   000002 757000 xsym               STAQ    FPT_OPEN_OUT+2

      624     9266    2           IF RESULTS_FID.WSN

   9266 12 001343   000030 236000 10                 LDQ     RESULTS_FID
        12 001344   020000 316003                    CANQ    8192,DU
        12 001345   001350 600000 12                 TZE     s:9269

      625     9267    2            THEN
      626     9268    2              FPT_OPEN_OUT.WSN_ = VECTOR(WSN#);

   9268 12 001346   000106 237000 13                 LDAQ    70
        12 001347   000032 757000 xsym               STAQ    FPT_OPEN_OUT+26

      627     9269    2           IF RESULTS_FID.RES
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:152  

   9269 12 001350   000030 236000 10                 LDQ     RESULTS_FID
        12 001351   004000 316003                    CANQ    2048,DU
        12 001352   001355 600000 12                 TZE     s:9272

      628     9270    2            THEN
      629     9271    2              FPT_OPEN_OUT.V.RES# = RES#;

   9271 12 001353   000061 236000 10                 LDQ     RES#
        12 001354   000050 756000 xsym               STQ     FPT_OPEN_OUT+40

      630     9272    2           FPT_OPEN_OUT.V.ASN# = ASN#;

   9272 12 001355   000060 236000 10                 LDQ     ASN#
        12 001356   000033 772000                    QRL     27
        12 001357   000045 552004 xsym               STBQ    FPT_OPEN_OUT+37,'04'O

      631     9273    2           RETURN;

   9273 12 001360   200022 221300                    LDX1  ! OUT_FID_GIVEN+2,,AUTO
        12 001361   000001 702211                    TSX2  ! 1,X1

      632     9274    2   END PROCESS_FID;
      633     9275        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:153  
      634     9276    1   GET_OUT_DEV_MASK: PROC;

   9276 12 001362   200022 741300       GET_OUT_DEV* STX1  ! OUT_FID_GIVEN+2,,AUTO

      635     9277        /*I* NAME: GET_OUT_DEV_MASK
      636     9278             PURPOSE: To produce a code indicating which type device the output fid is
      637     9279             CALL: CALL GET_OUT_DEV_MASK
      638     9280             DESCRIPTION: The output file is examined to determine which device type
      639     9281                          it is. The results are placed in OCB.DEV_MASK (BIT(9))
      640     9282                          which takes on the following values:
      641     9283                            OCTAL VALUE          DEVICE TYPE
      642     9284                            -----------          -----------
      643     9285                                1             disk file
      644     9286                                2             labeled tape file
      645     9287                                4             free tape
      646     9288                               10             LP set  ***NOT YET VALID
      647     9289                               20             IC set  ***NOT YET VALID
      648     9290                               40             non-FT device
      649     9291                              100             comgroup
      650     9292        */
      651     9293        /**/
      652     9294        /*  STATIC DATA  */
      653     9295        /**/
      654     9296    2   DCL RES CHAR(2);
      655     9297    3           DO CASE(ASN#);

   9297 12 001363   000060 236000 10                 LDQ     ASN#
        12 001364   000033 772000                    QRL     27
        12 001365   000005 116007                    CMPQ    5,DL
        12 001366   001370 602006 12                 TNC     s:9297+5,QL
        12 001367   001421 710000 12                 TRA     s:9312
        12 001370   001421 710000 12                 TRA     s:9312
        12 001371   001375 710000 12                 TRA     s:9299
        12 001372   001400 710000 12                 TRA     s:9301
        12 001373   001403 710000 12                 TRA     s:9303
        12 001374   001417 710000 12                 TRA     s:9310

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:154  
      656     9298    3            CASE(%FILE#);

      657     9299    3              OCB.DEV_MASK = '001'O;

   9299 12 001375   001000 236003                    LDQ     512,DU
        12 001376   000255 756000 xsym               STQ     OCB+173
        12 001377   001421 710000 12                 TRA     s:9312

      658     9300    3            CASE(%TAPE#);

      659     9301    3              OCB.DEV_MASK = '002'O;

   9301 12 001400   002000 236003                    LDQ     1024,DU
        12 001401   000255 756000 xsym               STQ     OCB+173
        12 001402   001421 710000 12                 TRA     s:9312

      660     9302    3            CASE(%DEVICE#);

      661     9303    3              RES = SUBSTR(RES#,0,2);

   9303 12 001403   000061 220000 10                 LDX0    RES#
        12 001404   200023 740100                    STX0    RES,,AUTO

      662     9304    3              IF RES = 'MT' OR RES = 'FT'

   9304 12 001405   001162 100000 11                 CMPX0   CON_DUP_IDX+93
        12 001406   001411 600000 12                 TZE     s:9306
        12 001407   001161 100000 11                 CMPX0   CON_DUP_IDX+92
        12 001410   001414 601000 12                 TNZ     s:9308

      663     9305    3               THEN                        /* FREE TAPE                          */
      664     9306    3                 OCB.DEV_MASK = '004'O;

   9306 12 001411   004000 236003                    LDQ     2048,DU
        12 001412   000255 756000 xsym               STQ     OCB+173
        12 001413   001421 710000 12                 TRA     s:9312

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:155  
      665     9307    3               ELSE                        /* NON-FT device                      */
      666     9308    3                 OCB.DEV_MASK = '040'O;

   9308 12 001414   040000 236003                    LDQ     16384,DU
        12 001415   000255 756000 xsym               STQ     OCB+173
        12 001416   001421 710000 12                 TRA     s:9312

      667     9309    3            CASE(%COMGROUP#);

      668     9310    3              OCB.DEV_MASK = '100'O;

   9310 12 001417   100000 236003                    LDQ     32768,DU
        12 001420   000255 756000 xsym               STQ     OCB+173

      669     9311    3            END;                           /* END CASE                           */

      670     9312    2           RETURN;

   9312 12 001421   000001 702211                    TSX2  ! 1,X1

      671     9313    2   END GET_OUT_DEV_MASK;
      672     9314        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:156  
      673     9315    1   RECONCILE_DEFAULTS_AFTER_OPEN: PROC;

   9315 12 001422   200022 741300       RECONCILE_D* STX1  ! OUT_FID_GIVEN+2,,AUTO

      674     9316        /*I* NAME:  RECONCILE_DEFAULTS_AFTER_OPEN
      675     9317             CALL:  CALL RECONCILE_DEFAULTS_AFTER_OPEN;
      676     9318             DESCRIPTION:  This routine decides on certain defaults AFTER all
      677     9319                           the options have been processed and after the OPEN.
      678     9320
      679     9321                           The main idea is to take any option that still is
      680     9322                           marked 'default', and put a definitive value there.
      681     9323        */
      682     9324        /*  This routine must be called after VPD$GET_OUT_FLAVOR                      */
      683     9325        /*  If writing in X/X1/OCT dump format, certain attributes default.           */
      684     9326        /*  If writing with KEYS, these same items default depending on the           */
      685     9327        /*  length of the key for this particular record.  The code for this must     */
      686     9328        /*  reside in VPG$WRITE.                                                      */
      687     9329        /**/
      688     9330    2           IF OCB.OCT_HEX.TYPE = 0         /* Not a dump format                  */

   9330 12 001423   000036 235000 xsym               LDA     OCB+30
        12 001424   001454 600000 12                 TZE     NO_DUMP

      689     9331    2            THEN
      690     9332    2              GOTO NO_DUMP;
      691     9333    2           IF OCB.KEY.FORMAT = '0'B

   9333 12 001425   000265 236000 xsym               LDQ     OCB+181
        12 001426   777000 316003                    CANQ    -512,DU
        12 001427   001440 601000 12                 TNZ     s:9341

      692     9334    2            THEN
      693     9335    3            DO;

      694     9336    3               OCB.KEY.FORMAT.S = %YES#;

   9336 12 001430   020000 236003                    LDQ     8192,DU
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:157  
        12 001431   000265 256000 xsym               ORSQ    OCB+181

      695     9337    3               OCB.KEY.FORMAT.O = %YES#;

   9337 12 001432   100000 236003                    LDQ     32768,DU
        12 001433   000265 256000 xsym               ORSQ    OCB+181

      696     9338    3               OCB.KEY.FORMAT.C = %YES#;

   9338 12 001434   040000 236003                    LDQ     16384,DU
        12 001435   000265 256000 xsym               ORSQ    OCB+181

      697     9339    3               OCB.KEY.FORMAT.E = %YES#;

   9339 12 001436   010000 236003                    LDQ     4096,DU
        12 001437   000265 256000 xsym               ORSQ    OCB+181

      698     9340    3               END;

      699     9341    2           IF OCB.KEY.DVBYTE = 0

   9341 12 001440   000266 236000 xsym               LDQ     OCB+182
        12 001441   001444 601000 12                 TNZ     s:9344

      700     9342    2            THEN
      701     9343    2              OCB.KEY.DVBYTE = 2;          /* DO                                 */

   9343 12 001442   000002 235007                    LDA     2,DL
        12 001443   000266 755000 xsym               STA     OCB+182

      702     9344    2           IF OCB.KEY.RECSIZ = 0

   9344 12 001444   000267 235000 xsym               LDA     OCB+183
        12 001445   001450 601000 12                 TNZ     s:9347

      703     9345    2            THEN
      704     9346    2              OCB.KEY.RECSIZ = 2;          /* DO                                 */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:158  

   9346 12 001446   000002 236007                    LDQ     2,DL
        12 001447   000267 756000 xsym               STQ     OCB+183

      705     9347    2           IF OCB.KEY.ONDATA = 0

   9347 12 001450   000270 235000 xsym               LDA     OCB+184
        12 001451   001454 601000 12                 TNZ     NO_DUMP

      706     9348    2            THEN
      707     9349    2              OCB.KEY.ONDATA = 1;          /* DONT                               */

   9349 12 001452   000001 236007                    LDQ     1,DL
        12 001453   000270 756000 xsym               STQ     OCB+184

   9347 12 001454                       NO_DUMP      null
      708     9350    2   NO_DUMP: ;
      709     9351        /**/
      710     9352    2           RETURN;

   9352 12 001454   000001 702211                    TSX2  ! 1,X1

      711     9353    2   END RECONCILE_DEFAULTS_AFTER_OPEN;
      712     9354        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:159  
      713     9355    1   PROCESS_OPTS: PROC(OPTS$);

   9355 12 001455   200022 741300       PROCESS_OPTS STX1  ! OUT_FID_GIVEN+2,,AUTO
        12 001456   001460 710000 12                 TRA     s:9647

      714     9356        /*I* NAME: PROCESS_OPTS
      715     9357             PURPOSE: To accept, validate, and act upon all output options input
      716     9358             CALL: CALL PROCESS_OPTS;
      717     9359             DESCRIPTION: PROCESS_OPTS first obtains the output file organization
      718     9360                          and checks it to be sure it is allowed for the output device
      719     9361                          and that no more than one organization option was given.
      720     9362                          It then proceeds to check each option by the following tests:
      721     9363                            1) Is it allowed for this command?
      722     9364                            2) Is it allowed for this output device?
      723     9365                            3) Is it allowed for this output organization?
      724     9366                            4) Is it a conflicting or duplicate option?
      725     9367                          If it passes all these tests successfully, PROCESS_OUTPUT_OPTION
      726     9368                          is called for further handling of this option.
      727     9369                          OPT$ is unused for this proc; it is used in PROCESS_MOD_OPTS
      728     9370                          only.
      729     9371        */
      730     9372        /**/
      731     9373        /*  PARAMETERS  */
      732     9374        /**/
      733     9375    2   DCL OPTS$ PTR;
      734     9376        /**/
      735     9377        /*  STATIC DATA  */
      736     9378        /**/
      737     9379    2   DCL OPTIONS$ PTR;
      738     9380    2   DCL HIGHEST_SEV SBIN WORD;
      739     9381    2   DCL I SBIN WORD;
      740     9382    2   DCL J SBIN WORD;
      741     9383    2   DCL OPT_IDX SBIN;
      742     9384    2   DCL DUP_IDX SBIN;
      743     9385    2   DCL OPTION_CODE SBIN WORD;
      744     9386    2   DCL ORG_CODE SBIN WORD;
      745     9387    2   DCL ORG_MASK(0:35) BIT(1) UNAL;         /* For option verification by ORG     */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:160  
      746     9388    2   DCL CON_DUP_TBL(0:65) UBIN BYTE UNAL;
      747     9389        /**/
      748     9390        /*  CONSTANT DATA  */
      749     9391        /**/
      750     9392    2   DCL 1 OPT_TABLE(0:%(MAX_OUT_OP#+3)) CONSTANT, /* NOTE the extra three options */
      751     9393                                                /* these are RESERVED for patching!   */
      752     9394                                                /* do NOT use for new-in-source       */
      753     9395                                                /* expansion of PCL!                  */
      754     9396    2         2 NAME,
      755     9397    2           3 LEN UBIN BYTE UNAL INIT(0,
      756     9398                    /*K* LEN = VALUE-DEC. Indexed by the option code, LEN
      757     9399                    contains the length (in characters) of the option NAME.           */
      758     9400    2             06,06,07,06,05,
      759     9401    2             04,02,02,10,03,
      760     9402    2             07,06,06,05,09,
      761     9403    2             09,04,04,02,02,
      762     9404    2             05,06,06,03,07,
      763     9405    2             03,03,12,03,12,
      764     9406    2             05,08,04,09,07,
      765     9407    2             07,05,03,02,04,
      766     9408    2             02,10,03,06,05,
      767     9409    2             01,10,04,04,08,
      768     9410    2             06,08,06,02,08,
      769     9411    2             07,05,07,07,11,
      770     9412    2             05,06,04,04,05,
      771     9413    2             05,11,12,04,05,
      772     9414    2             04,06,05,04,05,
      773     9415    2             08,07,04,03,06,
      774     9416    2             07,07,07,08,08,
      775     9417    2             09,07,07,07)  ,               /* Spares at the END                  */
      776     9418    2           3 NAME CHAR(12) UNAL INIT(' ',
      777     9419                    /*K* NAME = VALUE-CHAR(12). Indexed by the option code, NAME
      778     9420                    contains the option name.                                         */
      779     9421    2             'ACCESS      ','NCNVRT      ','NBINARY     ','BINARY      ','BLOCK      '
              9421                      ,
      780     9422    2             'CRPT        ','CS          ','CR          ','COMPRESSED  ','DSP        '
              9422                      ,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:161  
      781     9423    2             'DENSITY     ','EBCDIC      ','EXPIRE      ','XTEND       ','VOLACCESS  '
              9423                      ,
      782     9424    2             'KEYLENGTH   ','KEYX        ','KEYS        ','LC          ','LN         '
              9424                      ,
      783     9425    2             'LRDL0       ','LSLIDE      ','MAXVOL      ','AMR         ','NBLANKS    '
              9425                      ,
      784     9426    2             'NCR         ','NCS         ','NFATTRIBUTES','NLN        ','ORGANIZATION'
              9426                      ,
      785     9427    2             'OCTAL       ','IXTNSIZE    ','READ        ','RECLENGTH   ','RELEASE    '
              9427                      ,
      786     9428    2             'XTNSIZE     ','SPARE       ','SSP         ','TX          ','TYPE       '
              9428                      ,
      787     9429    2             'UC          ','ACSVEHICLE  ','VFC         ','VOLUME      ','WRITE      '
              9429                      ,
      788     9430    2             'X           ','NUMRECORDS  ','FVFC        ','NVFC        ','NRELEASE   '
              9430                      ,
      789     9431    2             'NEWKEY      ','NSPANNED    ','BACKUP      ','X1          ','NBLOCKED   '
              9431                      ,
      790     9432    2             'RECSIZE     ','SHARE       ','NBACKUP     ','REBUILD    ','TRANSPARENT '
              9432                      ,
      791     9433    2             'VREAD       ','VWRITE      ','SVFC        ','WRAP        ','NWRAP      '
              9433                      ,
      792     9434    2             'WIDTH       ','NCOMPRESSED ','NTRANSPARENT','HEAD        ','NHEAD      '
              9434                      ,
      793     9435    2             'FORM        ','COPIES      ','NPAGE       ','PAGE        ','NLOAD      '
              9435                      ,
      794     9436    2             'NSUMMARY    ','SUMMARY     ','SAVE        ','UFA         ','ALTBLD     '
              9436                      ,
      795     9437    2             'NALTBLD     ','GHSTACS     ','IOERROK     ','NIOERROK    ',
      796     9438    2             'ANSISPAN    ','NANSISPAN   ',
      797     9439    2             'SPARE3!     ','SPARE2!     ','SPARE1!     '),
      798     9440    2         2 ORG_ALLOWED BIT(36) UNAL INIT('0'O,
      799     9441                    /*K* ORG_ALLOWED = VALUE-BIT(36). Indexed by the option code,
      800     9442                    ORG_ALLOWED masks the allowable organizations for which this
      801     9443                    option is allowed. Organizations mask as below:
      802     9444                        OCTAL VALUE       ORGANIZATION
      803     9445                        -----------       ------------
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:162  
      804     9446                        200000000000      Consecutive
      805     9447                        100000000000      Fixed
      806     9448                         40000000000      Indexed
      807     9449                         20000000000      Keyed
      808     9450                         10000000000      Relative
      809     9451                          4000000000      Undefined
      810     9452                          2000000000      Variable
      811     9453                          1000000000      Random
      812     9454                           400000000      UR
      813     9455                           200000000      IDS
      814     9456                           100000000      Restricted
      815     9457                            40000000      Irel
      816     9458                            20000000      Free
      817     9459                            10000000      Symbiont
      818     9460                             4000000      Comgroup
      819     9461                             2000000      Terminal
      820     9462                             1000000      Forms Program
      821     9463                              400000      Handler
      822     9464                              200000      DBGDCB
      823     9465                              100000      DBGCG
      824     9466                               40000      DBGSYSID
      825     9467                               20000      Screen Edit
      826     9468                               10000      X364 */
      827     9469    2           '377777777777'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9469                    '377777770000'O,
      828     9470    2           '337777770000'O,'377777770000'O,'377777770000'O,'220400000000'O,
              9470                    '377777770000'O,
      829     9471    2           '377777770000'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9471                    '377777770000'O,
      830     9472    2           '040000000000'O,'040000000000'O,'376577770000'O,'377777770000'O,
              9472                    '000000000000'O,
      831     9473    2           '060040000000'O,'060040000000'O,'377777770000'O,'377777770000'O,
              9473                    '377777770000'O,
      832     9474    2           '377777770000'O,'377777770000'O,'377777770000'O,'000000000000'O,
              9474                    '000000000000'O,
      833     9475    2           '377777770000'O,'271640000000'O,'377777770000'O,'377777770000'O,
              9475                    '260400000000'O,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:163  
      834     9476    2           '271640000000'O,'060040000000'O,'377777770000'O,'377777770000'O,
              9476                    '377777770000'O,
      835     9477    2           '377777770000'O,'377777777777'O,'377777770000'O,'377777770000'O,
              9477                    '377777770000'O,
      836     9478    2           '377777770000'O,'010000000000'O,'377777770000'O,'377777770000'O,
              9478                    '377777770000'O,
      837     9479    2           '070040000000'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9479                    '377777770000'O,
      838     9480    2           '377777770000'O,'071254000000'O,'377777770000'O,'060040000000'O,
              9480                    '377777770000'O,
      839     9481    2           '377777770000'O,'271645000000'O,'377777770000'O,'376477770000'O,
              9481                    '376477770000'O,
      840     9482    2           '377777770000'O,'220400000000'O,'376477770000'O,'376477770000'O,
              9482                    '377777770000'O,
      841     9483    2           '377777770000'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9483                    '377777770000'O,
      842     9484    2           '377777770000'O,'377777770000'O,'377777770000'O,'377777770000'O,
              9484                    '040040000000'O,
      843     9485    2           '040040000000'O,'377777770000'O,'377777770000'O,'377777770000'O,
      844     9486    2           '377000000000'O,'377000000000'O,
      845     9487    2           '333333333333'O,'222222222222'O,'111111111111'O),
      846     9488    2         2 DEV_ALLOWED BIT(18) UNAL INIT('0'O,
      847     9489                    /*K* DEV_ALLOWED = VALUE-BIT(18). Indexed by option code, DEV_ALLOWED
      848     9490                    masks the allowable devices for which this option is allowed.
      849     9491                    Devices mask as below:
      850     9492                            OCTAL VALUE          DEVICE TYPE
      851     9493                            -----------          -----------
      852     9494                                1             disk file
      853     9495                                2             labeled tape file
      854     9496                                4             free tape
      855     9497                               10             LP set  ***NOT YET VALID
      856     9498                               20             IC set  ***NOT YET VALID
      857     9499                               40             non-FT device
      858     9500                              100             comgroup                                */
      859     9501    2           '003'O,'002'O,'177'O,'177'O,'006'O,
      860     9502    2           '001'O,'177'O,'177'O,'001'O,'073'O,
      861     9503    2           '006'O,'006'O,'003'O,'002'O,'002'O,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:164  
      862     9504    2           '003'O,'003'O,'177'O,'177'O,'003'O,
      863     9505    2           '003'O,'003'O,'002'O,'177'O,'177'O,
      864     9506    2           '177'O,'177'O,'003'O,'177'O,'177'O,
      865     9507    2           '177'O,'001'O,'003'O,'007'O,'001'O,
      866     9508    2           '001'O,'003'O,'073'O,'177'O,'003'O,
      867     9509    2           '177'O,'003'O,'173'O,'006'O,'003'O,
      868     9510    2           '177'O,'003'O,'173'O,'173'O,'001'O,
      869     9511    2           '001'O,'006'O,'001'O,'177'O,'006'O,
      870     9512    2           '177'O,'001'O,'001'O,'001'O,'075'O,
      871     9513    2           '003'O,'003'O,'073'O,'177'O,'177'O,
      872     9514    2           '177'O,'001'O,'075'O,'077'O,'077'O,
      873     9515    2           '073'O,'073'O,'077'O,'077'O,'003'O,
      874     9516    2           '177'O,'177'O,'177'O,'103'O,'001'O,
      875     9517    2           '001'O,'177'O,'006'O,'006'O,'006'O,
      876     9518    2           '006'O,'333'O,'222'O,'111'O)  ,
      877     9519    2         2 CMD_ALLOWED BIT(36) UNAL INIT('0'O,
      878     9520                    /*K* CMD_ALLOWED = VALUE-BIT(36). Indexed by option code, CMD_ALLOWED
      879     9521                    masks the allowable commands for which this option is valid.
      880     9522                    Commands of interest are:
      881     9523                        OCTAL VALUE        COMMAND
      882     9524                        -----------        -------
      883     9525                        20000              COPY
      884     9526                        10000              COPYALL
      885     9527                         4000              COPYSTD
      886     9528                           40              LIST
      887     9529                           20              LISTSTD
      888     9530                            4              MODIFY                                     */
      889     9531    2           '3406400002'O, '3406000002'O, '3406000002'O, '3406000002'O, '3406000002'O,
      890     9532    2           '3406000002'O, '3406000002'O, '3400000000'O, '3406000002'O, '3406000002'O,
      891     9533    2           '3406000002'O, '3406000002'O, '3406400002'O, '3406000002'O, '3400000000'O,
      892     9534    2           '3406000002'O, '3406000002'O, '3406000002'O, '3400000000'O, '3406000002'O,
      893     9535    2           '3406400002'O, '3406400002'O, '3406000002'O, '3406000002'O, '3406000002'O,
      894     9536    2           '3400000000'O, '3406000002'O, '3400000000'O, '3406000002'O, '3406000002'O,
      895     9537    2           '3400000000'O, '3406000002'O, '3406400002'O, '3406000002'O, '3406400002'O,
      896     9538    2           '3406400002'O, '3406400002'O, '3406000002'O, '3400000000'O, '3406400002'O,
      897     9539    2           '3400000000'O, '3406400002'O, '3400000000'O, '3406000002'O, '3406400002'O,
      898     9540    2           '3400000000'O, '3406000002'O, '3400000000'O, '3400000000'O, '3406400002'O,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:165  
      899     9541    2           '3406000002'O, '3406000002'O, '3406400002'O, '3400000000'O, '3406000002'O,
      900     9542    2           '3400000000'O, '3406000002'O, '3406400002'O, '3400400000'O, '3400000000'O,
      901     9543    2           '3406400002'O, '3406400002'O, '3400000000'O, '3400000000'O, '3400000000'O,
      902     9544    2           '3406000002'O, '3400000000'O, '3400000000'O, '3400000000'O, '3400000000'O,
      903     9545    2           '3406000000'O, '3406000000'O, '3400000000'O, '3400000000'O, '3400000000'O,
      904     9546    2           '0006000000'O, '0006000000'O, '3406000000'O, '3406400000'O, '3400400000'O,
      905     9547    2           '3406000000'O, '3406000000'O,
      906     9548    2           '3400400000'O, '3406400000'O, '3406400000'O, '3406400000'O,
      907     9549    2           '3333333333'O,'2222222222'O,'1111111111'O);
      908     9550    2   DCL CON_DUP_IDX(0:%((MAX_OUT_OP#+3)*4+3)) CONSTANT UBIN BYTE UNAL INIT(0,0,0,0,
      909     9551                    /*K* CON_DUP_IDX = VALUE-DEC. Indexed by (option_code * 4) through
      910     9552                    (option_code*4 + 3), this table contains an index into CON_DUP_TBL.
      911     9553                    CON_DUP_TBL contains in each cell, either the option_code of
      912     9554                    another previously specified duplicate or conflicting option
      913     9555                    or 0 if no previous option has occured. 0 is a special index and
      914     9556                    denotes that this option does not conflict with any other option
      915     9557                    including itself. All options which conflict with each other
      916     9558                    then will have the same index. Any option may have up to 4 indices
      917     9559                    associated with it indicating membership in up to 4 conflict
      918     9560                    groups.                                                           */
      919     9561        /*     Some conflict groups are:
      920     9562               1 - NCNVRT
      921     9563               2 - NBINARY & BINARY
      922     9564               3 - BLOCK
      923     9565               4 - SUMMARY & NSUMMARY
      924     9566               5 - CS & NCS
      925     9567               6 - CR & NCR
      926     9568               7 - XTEND
      927     9569               8 - DENSITY
      928     9570               9 - EBCDIC
      929     9571              10 - EXPIRE
      930     9572              11 - XTEND
      931     9573              12 - NFATTBIBUTES
      932     9574              13 - KEYLENGTH
      933     9575              14 - KEYX
      934     9576              15 - LC & UC
      935     9577              16 - LN & NLN & ORG
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:166  
      936     9578              17 - LRDLO
      937     9579              18 - LSLIDE
      938     9580              19 - MAXVOL
      939     9581              20 - AMR
      940     9582              21 - NBLANKS
      941     9583              22 - IXTNSIZE
      942     9584              23 - RECL
      943     9585              24 - RELEASE & NRELEASE
      944     9586              25 - XTNSIZE
      945     9587              26 - SPARE
      946     9588              27 - TX
      947     9589              28 - TYPE
      948     9590              29 - VOLUME
      949     9591              30 - NUMRECORDS
      950     9592              31 - NEWKEY
      951     9593              32 - NSPANNED
      952     9594              33 - BACKUP
      953     9595              34 - DSP & SSP & VFC
      954     9596              35 - VFC & NVFC & SVFC
      955     9597              36 - FVFC & NVFC & SVFC
      956     9598              37 - OCTAL & VFC & X & X1
      957     9599              38 - OCTAL & X & FVFC & X1
      958     9600              39 - KEYS & VFC
      959     9601              40 - KEYS & FVFC
      960     9602              41 - NBLOCKED
      961     9603              42 - RECSIZE
      962     9604              43 - SHARE
      963     9605              44 - NBACKUP
      964     9606              45 - REBUILD
      965     9607              46 - TRANSPARENT & NTRANSPARENT
      966     9608              47 - WRAP & UNWRAP
      967     9609              48 - WIDTH
      968     9610              49 - COMPRESSED & NCOMPRESSED
      969     9611              50 - HEAD & NHEAD
      970     9612              51 - FORM
      971     9613              52 - COPIES
      972     9614              53 - PAGE & NPAGE
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:167  
      973     9615              54 - ALTBLD & NALTBLD
      974     9616              55 - GHSTACS
      975     9617              56 - IOERROK & NIOERROK
      976     9618        */
      977     9619    2        0, 0, 0, 0,   1, 0, 0, 0,   2, 0, 0, 0,   2, 0, 0, 0,   3, 0, 0, 0,
      978     9620    2        0, 0, 0, 0,   5, 0, 0, 0,   6, 0, 0, 0,  49,0, 0, 0,   34, 0, 0, 0,
      979     9621    2        8, 0, 0, 0,   9, 0, 0, 0,  10, 0, 0, 0,  11, 0, 0, 0,   7, 0, 0, 0,
      980     9622    2       13, 0, 0, 0,  14, 0, 0, 0,  39,40, 0, 0,  15, 0, 0, 0,  16, 0, 0, 0,
      981     9623    2       17, 0, 0, 0,  18, 0, 0, 0,  19, 0, 0, 0,  20, 0, 0, 0,  21, 0, 0, 0,
      982     9624    2        6, 0, 0, 0,   5, 0, 0, 0,  12, 0, 0, 0,  16, 0, 0, 0,  16, 0, 0, 0,
      983     9625    2       37,38, 0, 0,  22, 0, 0, 0,   0, 0, 0, 0,  23, 0, 0, 0,  24, 0, 0, 0,
      984     9626    2       25, 0, 0, 0,  26, 0, 0, 0,  34, 0, 0, 0,  27, 0, 0, 0,  28, 0, 0, 0,
      985     9627    2       15, 0, 0, 0,   0, 0, 0, 0,  34,35,37,39,  29, 0, 0, 0,   0, 0, 0, 0,
      986     9628    2       37,38, 0, 0,  30, 0, 0, 0,  36,38,40, 0,  35,36, 0, 0,  24, 0, 0, 0,
      987     9629    2       31, 0, 0, 0,  32, 0, 0, 0,  33, 0, 0, 0,  37,38, 0, 0,  41, 0, 0, 0,
      988     9630    2       42, 0, 0, 0,  43, 0, 0, 0,  44, 0, 0, 0,  45, 0, 0, 0,  46, 0, 0, 0,
      989     9631    2        0, 0, 0, 0,   0, 0, 0, 0,  35,36, 0, 0,  47, 0, 0, 0,  47, 0, 0, 0,
      990     9632    2       48, 0, 0, 0,  49, 0, 0, 0,  46, 0, 0, 0,  50, 0, 0, 0,  50, 0, 0, 0,
      991     9633    2       51, 0, 0, 0,  52, 0, 0, 0,  53, 0, 0, 0,  53, 0, 0, 0,   0, 0, 0, 0,
      992     9634    2       04, 0, 0, 0,  04, 0, 0, 0,   0, 0, 0, 0,   0, 0, 0, 0,  54, 0, 0, 0,
      993     9635    2       54, 0, 0, 0,  55, 0, 0, 0,  56, 0, 0, 0,  56, 0, 0, 0,   0, 0, 0, 0,
      994     9636    2   0, 0, 0, 0, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1); /* SPARES at end             */
      995     9637        /******************************************************************************/
      996     9638        /******************************************************************************/
      997     9639        /******************************************************************************/
      998     9640    2   PROCESS_MOD_OPTS: ENTRY(OPTS$);

   9640 12 001457   200022 741300       PROCESS_MOD* STX1  ! OUT_FID_GIVEN+2,,AUTO

      999     9641        /*D* NAME: PROCESS_MOD_OPTS
     1000     9642             CALL: CALL PROCESS_MOD_OPTS(OPTS$);
     1001     9643             DESCRIPTION: This entry handles options for the MODIFY command. It
     1002     9644                          detects, validates and stuffs them into OCB.
     1003     9645        */
     1004     9646        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:168  
     1005     9647    2           FIELD1_ = VECTOR(NIL);

   9647 12 001460   000022 237000 13                 LDAQ    18
        12 001461   200010 757100                    STAQ    FIELD1_,,AUTO

     1006     9648    2           FIELD2_ = VECTOR(NIL);

   9648 12 001462   000022 237000 13                 LDAQ    18
        12 001463   200012 757100                    STAQ    FIELD2_,,AUTO

     1007     9649    2           CON_DUP_TBL = '0'B;             /* CLEAR THE TABLE                    */

   9649 12 001464   000100 100400                    MLR     fill='000'O
        12 001465   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        12 001466   200035 000102                    ADSC9   CON_DUP_TBL,,AUTO        cn=0,n=66

     1008     9650    2           ORG_MASK = '0'B;

   9650 12 001467   200034 450100                    STZ     ORG_MASK,,AUTO

     1009     9651    2           HIGHEST_SEV = 0;

   9651 12 001470   200025 450100                    STZ     HIGHEST_SEV,,AUTO

     1010     9652    2           IF CMD_MASK(12)                 /* IF MODIFY                          */

   9652 12 001471   000000 236000 xsym               LDQ     CMD_MASK
        12 001472   000040 316003                    CANQ    32,DU
        12 001473   001501 600000 12                 TZE     s:9660

     1011     9653    2            THEN
     1012     9654    3            DO;

     1013     9655    3               OPTIONS$ = OPTS$;

   9655 12 001474   200023 470500                    LDP0    @OPTS$,,AUTO
        12 001475   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:169  
        12 001476   200024 756100                    STQ     OPTIONS$,,AUTO

     1014     9656    3               OPT_START = 0;

   9656 12 001477   200014 450100                    STZ     OPT_START,,AUTO

     1015     9657    3               END;

   9657 12 001500   001506 710000 12                 TRA     s:9663

     1016     9658    2            ELSE
     1017     9659    3            DO;

     1018     9660    3               OPTIONS$ = OUT_SPEC$;

   9660 12 001501   200003 470500                    LDP0    @OUT_SPEC$,,AUTO
        12 001502   000000 236100                    LDQ     0,,PR0
        12 001503   200024 756100                    STQ     OPTIONS$,,AUTO

     1019     9661    3               OPT_START = 2;

   9661 12 001504   000002 235007                    LDA     2,DL
        12 001505   200014 755100                    STA     OPT_START,,AUTO

     1020     9662    3               END;

     1021     9663    2           CALL DO_ORG_OPTS;               /* Process SOME options first!        */

   9663 12 001506   002043 701000 12                 TSX1    DO_ORG_OPTS
        12 001507   000000 011000                    NOP     0

     1022     9664    2           CALL SET_DEFAULTS;

   9664 12 001510   002263 701000 12                 TSX1    SET_DEFAULTS
        12 001511   000000 011000                    NOP     0

     1023     9665    2           CALL VPL$ERR_SEV_HANDLER(HIGHEST_SEV);
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:170  

   9665 12 001512   200025 630500                    EPPR0   HIGHEST_SEV,,AUTO
        12 001513   200130 450500                    STP0    @ERROR+2,,AUTO
        12 001514   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 001515   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001516   000000 701000 xent               TSX1    VPL$ERR_SEV_HANDLER
        12 001517   000000 011000                    NOP     0

     1024     9666    3           DO OPT_IDX=OPT_START TO OPTIONS$->OUT$BLK.NSUBLKS-1;

   9666 12 001520   200014 235100                    LDA     OPT_START,,AUTO
        12 001521   200030 755100                    STA     OPT_IDX,,AUTO
        12 001522   001542 710000 12                 TRA     s:9675+1

     1025     9667    3              OPTION_CODE = OPTIONS$->OUT$BLK.SUBLK$(OPT_IDX)->OUT$BLK.CODE;

   9667 12 001523   200024 470500                    LDP0    OPTIONS$,,AUTO
        12 001524   200030 720100                    LXL0    OPT_IDX,,AUTO
        12 001525   000003 471510                    LDP1    3,X0,PR0
        12 001526   100000 236100                    LDQ     0,,PR1
        12 001527   777777 376007                    ANQ     -1,DL
        12 001530   200032 756100                    STQ     OPTION_CODE,,AUTO

     1026     9668    3              IF OPTION_CODE = 20          /* LN                                 */

   9668 12 001531   000024 116007                    CMPQ    20,DL
        12 001532   001541 600000 12                 TZE     s:9675
        12 001533   000035 116007                    CMPQ    29,DL
        12 001534   001541 600000 12                 TZE     s:9675
        12 001535   000036 116007                    CMPQ    30,DL
        12 001536   001541 600000 12                 TZE     s:9675

     1027     9669    3                OR OPTION_CODE = 29        /* NLN (Same as ORG=CONSEC)           */
     1028     9670    3                OR OPTION_CODE = 30        /* ORG                                */
     1029     9671    3               THEN                        /* This option (somehow) sets ORG     */
     1030     9672    3                 ;                         /* This option already processed      */
     1031     9673    3               ELSE                        /* This option doesn't affect ORG     */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:171  
     1032     9674    3                 CALL CHECK_AND_PROCESS_OPT;

   9674 12 001537   001607 701000 12                 TSX1    CHECK_AND_PROCESS_OPT
        12 001540   000000 011000                    NOP     0

     1033     9675    3              END;

   9675 12 001541   200030 054100                    AOS     OPT_IDX,,AUTO
        12 001542   200024 470500                    LDP0    OPTIONS$,,AUTO
        12 001543   000001 236100                    LDQ     1,,PR0
        12 001544   000022 772000                    QRL     18
        12 001545   200030 116100                    CMPQ    OPT_IDX,,AUTO
        12 001546   001523 605400 12                 TPNZ    s:9667

     1034     9676    2           CALL RECONCILE_DEFAULTS_BEFORE_OPEN;

   9676 12 001547   002456 701000 12                 TSX1    RECONCILE_DEFAULTS_BEFORE_OPEN
        12 001550   000000 011000                    NOP     0

     1035     9677    2           CALL VPL$ERR_SEV_HANDLER(HIGHEST_SEV);

   9677 12 001551   200025 630500                    EPPR0   HIGHEST_SEV,,AUTO
        12 001552   200130 450500                    STP0    @ERROR+2,,AUTO
        12 001553   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 001554   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001555   000000 701000 xent               TSX1    VPL$ERR_SEV_HANDLER
        12 001556   000000 011000                    NOP     0

     1036     9678    2           RETURN;

   9678 12 001557   200022 221300                    LDX1  ! OUT_FID_GIVEN+2,,AUTO
        12 001560   000001 702211                    TSX2  ! 1,X1

     1037     9679        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:172  
     1038     9680    2   BAD_OPT: PROC(SEVERITY,ERROR);

   9680 12 001561   200124 741300       BAD_OPT      STX1  ! TEXTC+12,,AUTO

     1039     9681        /*I* NAME: BAD_OPT
     1040     9682             PURPOSE: To report error conditions and maintain HIGHEST_SEV.
     1041     9683             CALL: CALL BAD_OPT(SEVERITY,ERROR);
     1042     9684             DESCRIPTION: This procedure reports all error conditions passed to
     1043     9685                          to it as a warning severity error. It maintains the highest
     1044     9686                          severity passed to it in HIGHEST_SEV for later error handling
     1045     9687                          by a higher level procedure.
     1046     9688        */
     1047     9689        /**/
     1048     9690        /*  PARAMETERS  */
     1049     9691        /**/
     1050     9692    3   DCL SEVERITY SBIN WORD;
     1051     9693    3   DCL ERROR UBIN WORD;
     1052     9694    3           CALL VPL$ERR_PROC(1,ERROR,'03'O,,FIELD1_,FIELD2_);

   9694 12 001562   200012 630500                    EPPR0   FIELD2_,,AUTO
        12 001563   200135 450500                    STP0    @ERROR+7,,AUTO
        12 001564   200010 631500                    EPPR1   FIELD1_,,AUTO
        12 001565   200134 451500                    STP1    @ERROR+6,,AUTO
        12 001566   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 001567   000007 235000 13                 LDA     7
        12 001570   200132 757100                    STAQ    @ERROR+4,,AUTO
        12 001571   200126 236100                    LDQ     @ERROR,,AUTO
        12 001572   000032 235000 13                 LDA     26
        12 001573   200130 757100                    STAQ    @ERROR+2,,AUTO
        12 001574   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 001575   000024 631400 xsym               EPPR1   B_VECTNIL+20
        12 001576   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 001577   000000 011000                    NOP     0

     1053     9695    3           IF SEVERITY>HIGHEST_SEV

   9695 12 001600   200125 470500                    LDP0    @SEVERITY,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:173  
        12 001601   000000 236100                    LDQ     0,,PR0
        12 001602   200025 116100                    CMPQ    HIGHEST_SEV,,AUTO
        12 001603   001605 604400 12                 TMOZ    s:9698

     1054     9696    3            THEN
     1055     9697    3              HIGHEST_SEV = SEVERITY;      /* MAINTAIN HIGHEST SEVERITY          */

   9697 12 001604   200025 756100                    STQ     HIGHEST_SEV,,AUTO

     1056     9698    3   END BAD_OPT;

   9698 12 001605   200124 221300                    LDX1  ! TEXTC+12,,AUTO
        12 001606   000001 702211                    TSX2  ! 1,X1

     1057     9699        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:174  
     1058     9700    2   CHECK_AND_PROCESS_OPT: PROC;

   9700 12 001607   200060 741300       CHECK_AND_P* STX1  ! CON_DUP_TBL+19,,AUTO

     1059     9701        /*I* NAME: CHECK_AND_PROCESS_OPT
     1060     9702             PURPOSE: To check for bad options.  This includes duplicate,
     1061     9703                      conflicting, and illegal for this command.
     1062     9704                      If the option is OK, it is processed.
     1063     9705        */
     1064     9706    3           FIELD1_ = VECTOR(OPT_TABLE.NAME(OPTION_CODE));

   9706 12 001610   000110 235000 13                 LDA     72
        12 001611   200032 236100                    LDQ     OPTION_CODE,,AUTO
        12 001612   200130 755100                    STA     @ERROR+2,,AUTO
        12 001613   000112 402000 13                 MPY     74
        12 001614   000111 036000 13                 ADLQ    73
        12 001615   200130 235100                    LDA     @ERROR+2,,AUTO
        12 001616   200010 757100                    STAQ    FIELD1_,,AUTO

     1065     9707    3           IF (OPT_TABLE.CMD_ALLOWED(OPTION_CODE) & CMD_MASK)='0'B

   9707 12 001617   000100 100400                    MLR     fill='000'O
        12 001620   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 001621   200130 000010                    ADSC9   @ERROR+2,,AUTO           cn=0,n=8
        12 001622   200032 236100                    LDQ     OPTION_CODE,,AUTO
        12 001623   000027 402007                    MPY     23,DL
        12 001624   000100 100406                    MLR     fill='000'O
        12 001625   000023 600004 11                 ADSC9   OPT_TABLE+4,Q            cn=3,n=4
        12 001626   200132 000010                    ADSC9   @ERROR+4,,AUTO           cn=0,n=8
        12 001627   200132 237100                    LDAQ    @ERROR+4,,AUTO
        12 001630   200130 377100                    ANAQ    @ERROR+2,,AUTO
        12 001631   001641 601000 12                 TNZ     s:9715

     1066     9708    3            THEN
     1067     9709    3              CALL BAD_OPT(3,6);

   9709 12 001632   000113 236000 13                 LDQ     75
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:175  
        12 001633   200126 756100                    STQ     @ERROR,,AUTO
        12 001634   000005 236000 13                 LDQ     5
        12 001635   200125 756100                    STQ     @SEVERITY,,AUTO
        12 001636   001561 701000 12                 TSX1    BAD_OPT
        12 001637   000000 011000                    NOP     0
        12 001640   002041 710000 12                 TRA     s:9763

     1068     9710        /*E*   ERROR: VPC-00006
     1069     9711             MESSAGE: %U1 not allowed
     1070     9712            MESSAGE1: %U1 output option not allowed for this command
     1071     9713        */
     1072     9714    3            ELSE
     1073     9715    3              IF (OPT_TABLE.DEV_ALLOWED(OPTION_CODE) & OCB.DEV_MASK)='0'B

   9715 12 001641   000255 236000 xsym               LDQ     OCB+173
        12 001642   777000 376003                    ANQ     -512,DU
        12 001643   200130 756100                    STQ     @ERROR+2,,AUTO
        12 001644   200032 236100                    LDQ     OPTION_CODE,,AUTO
        12 001645   000027 402007                    MPY     23,DL
        12 001646   000100 100406                    MLR     fill='000'O
        12 001647   000023 200002 11                 ADSC9   OPT_TABLE+4,Q            cn=1,n=2
        12 001650   200131 000004                    ADSC9   @ERROR+3,,AUTO           cn=0,n=4
        12 001651   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 001652   200130 376100                    ANQ     @ERROR+2,,AUTO
        12 001653   001666 601000 12                 TNZ     s:9724
        12 001654   000061 236000 10                 LDQ     RES#
        12 001655   001163 116000 11                 CMPQ    CON_DUP_IDX+94
        12 001656   001666 600000 12                 TZE     s:9724

     1074     9716    3                AND RES# ~= 'NO  '         /* Device NO, OK any option           */
     1075     9717    3               THEN
     1076     9718    3                 CALL BAD_OPT(3,7);

   9718 12 001657   000114 236000 13                 LDQ     76
        12 001660   200126 756100                    STQ     @ERROR,,AUTO
        12 001661   000005 236000 13                 LDQ     5
        12 001662   200125 756100                    STQ     @SEVERITY,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:176  
        12 001663   001561 701000 12                 TSX1    BAD_OPT
        12 001664   000000 011000                    NOP     0
        12 001665   002041 710000 12                 TRA     s:9763

     1077     9719        /*E*  ERROR: VPC-00007
     1078     9720             MESSAGE: %U1 not allowed
     1079     9721            MESSAGE1: %U1 output option not allowed for this output device
     1080     9722        */
     1081     9723    3               ELSE
     1082     9724    3                 IF (OPT_TABLE.ORG_ALLOWED(OPTION_CODE) & ORG_MASK)='0'B

   9724 12 001666   200032 236100                    LDQ     OPTION_CODE,,AUTO
        12 001667   000027 402007                    MPY     23,DL
        12 001670   000100 100406                    MLR     fill='000'O
        12 001671   000022 200004 11                 ADSC9   OPT_TABLE+3,Q            cn=1,n=4
        12 001672   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 001673   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 001674   200034 376100                    ANQ     ORG_MASK,,AUTO
        12 001675   001730 601000 12                 TNZ     s:9739
        12 001676   200034 235100                    LDA     ORG_MASK,,AUTO
        12 001677   001730 600000 12                 TZE     s:9739

     1083     9725    3                   AND ORG_MASK ~= '0'B
     1084     9726    3                  THEN
     1085     9727    4                  DO;

     1086     9728    4                     FIELD2_ = VECTOR(ORG_TBL.NAME(ORG_CODE));

   9728 12 001700   000115 235000 13                 LDA     77
        12 001701   200033 236100                    LDQ     ORG_CODE,,AUTO
        12 001702   200130 755100                    STA     @ERROR+2,,AUTO
        12 001703   000117 402000 13                 MPY     79
        12 001704   000116 036000 13                 ADLQ    78
        12 001705   200130 235100                    LDA     @ERROR+2,,AUTO
        12 001706   200012 757100                    STAQ    FIELD2_,,AUTO

     1087     9729    4                     IF CMD_MASK(2) THEN   /* IF COPYALL                         */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:177  

   9729 12 001707   000000 236000 xsym               LDQ     CMD_MASK
        12 001710   100000 316003                    CANQ    32768,DU
        12 001711   001721 600000 12                 TZE     s:9732

     1088     9730    4                        CALL BAD_OPT(1,8); /* DON'T CAUSE A FULL ABORT           */

   9730 12 001712   000120 236000 13                 LDQ     80
        12 001713   200126 756100                    STQ     @ERROR,,AUTO
        12 001714   000032 236000 13                 LDQ     26
        12 001715   200125 756100                    STQ     @SEVERITY,,AUTO
        12 001716   001561 701000 12                 TSX1    BAD_OPT
        12 001717   000000 011000                    NOP     0
        12 001720   002041 710000 12                 TRA     s:9763

     1089     9731    4                      ELSE
     1090     9732    4                        CALL BAD_OPT(3,8);

   9732 12 001721   000120 236000 13                 LDQ     80
        12 001722   200126 756100                    STQ     @ERROR,,AUTO
        12 001723   000005 236000 13                 LDQ     5
        12 001724   200125 756100                    STQ     @SEVERITY,,AUTO
        12 001725   001561 701000 12                 TSX1    BAD_OPT
        12 001726   000000 011000                    NOP     0

     1091     9733    4                     END;

   9733 12 001727   002041 710000 12                 TRA     s:9763

     1092     9734        /*E*   ERROR: VPC-00008
     1093     9735             MESSAGE: %U1 not allowed for %U2 organization
     1094     9736        */
     1095     9737    3                  ELSE
     1096     9738    4                  DO;

     1097     9739    4                     DUP_IDX=0;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:178  
   9739 12 001730   200031 450100                    STZ     DUP_IDX,,AUTO

     1098     9740    5                     DO WHILE(DUP_IDX<4);

   9740 12 001731   200031 235100                    LDA     DUP_IDX,,AUTO
        12 001732   000004 115007                    CMPA    4,DL
        12 001733   002031 605000 12                 TPL     s:9759

     1099     9741    5                        IF CON_DUP_TBL(CON_DUP_IDX(OPTION_CODE*4+DUP_IDX))~=0 AND

   9741 12 001734   200032 236100                    LDQ     OPTION_CODE,,AUTO
        12 001735   000002 736000                    QLS     2
        12 001736   200031 036100                    ADLQ    DUP_IDX,,AUTO
        12 001737   000100 101406                    MRL     fill='000'O
        12 001740   001025 000001 11                 ADSC9   CON_DUP_IDX,Q            cn=0,n=1
        12 001741   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 001742   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 001743   000100 101506                    MRL     fill='000'O
        12 001744   200035 000001                    ADSC9   CON_DUP_TBL,Q,AUTO       cn=0,n=1
        12 001745   200131 000004                    ADSC9   @ERROR+3,,AUTO           cn=0,n=4
        12 001746   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 001747   000000 116003                    CMPQ    0,DU
        12 001750   002013 600000 12                 TZE     s:9755
        12 001751   200032 236100                    LDQ     OPTION_CODE,,AUTO
        12 001752   000002 736000                    QLS     2
        12 001753   200031 036100                    ADLQ    DUP_IDX,,AUTO
        12 001754   000100 101406                    MRL     fill='000'O
        12 001755   001025 000001 11                 ADSC9   CON_DUP_IDX,Q            cn=0,n=1
        12 001756   200132 000004                    ADSC9   @ERROR+4,,AUTO           cn=0,n=4
        12 001757   200132 236100                    LDQ     @ERROR+4,,AUTO
        12 001760   000000 116003                    CMPQ    0,DU
        12 001761   002013 600000 12                 TZE     s:9755

     1100     9742    5                          CON_DUP_IDX(OPTION_CODE*4+DUP_IDX)~=0
     1101     9743    5                         THEN
     1102     9744    6                         DO;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:179  
     1103     9745    6                            FIELD2_ = VECTOR(OPT_TABLE.NAME(

   9745 12 001762   200032 236100                    LDQ     OPTION_CODE,,AUTO
        12 001763   000002 736000                    QLS     2
        12 001764   200031 036100                    ADLQ    DUP_IDX,,AUTO
        12 001765   000100 101406                    MRL     fill='000'O
        12 001766   001025 000001 11                 ADSC9   CON_DUP_IDX,Q            cn=0,n=1
        12 001767   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 001770   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 001771   000100 101506                    MRL     fill='000'O
        12 001772   200035 000001                    ADSC9   CON_DUP_TBL,Q,AUTO       cn=0,n=1
        12 001773   200131 000004                    ADSC9   @ERROR+3,,AUTO           cn=0,n=4
        12 001774   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 001775   000027 402007                    MPY     23,DL
        12 001776   000110 235000 13                 LDA     72
        12 001777   000020 736000                    QLS     16
        12 002000   000111 036000 13                 ADLQ    73
        12 002001   200012 757100                    STAQ    FIELD2_,,AUTO

     1104     9746    6                              CON_DUP_TBL(CON_DUP_IDX(OPTION_CODE*4+DUP_IDX))));
     1105     9747    6                            CALL BAD_OPT(3,9);

   9747 12 002002   000014 236000 13                 LDQ     12
        12 002003   200126 756100                    STQ     @ERROR,,AUTO
        12 002004   000005 236000 13                 LDQ     5
        12 002005   200125 756100                    STQ     @SEVERITY,,AUTO
        12 002006   001561 701000 12                 TSX1    BAD_OPT
        12 002007   000000 011000                    NOP     0

     1106     9748        /*E*   ERROR: VPC-00009
     1107     9749             MESSAGE: Conflicting or duplicate options - %U2 and %U1
     1108     9750        */
     1109     9751    6                            DUP_IDX = 5;   /* INDICATES AN ERROR CONDITION       */

   9751 12 002010   000005 235007                    LDA     5,DL
        12 002011   200031 755100                    STA     DUP_IDX,,AUTO

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:180  
     1110     9752    6                            END;

   9752 12 002012   002026 710000 12                 TRA     s:9758

     1111     9753    5                         ELSE
     1112     9754    6                         DO;

     1113     9755    6                            CON_DUP_TBL(CON_DUP_IDX(OPTION_CODE*4+DUP_IDX)) =
              9755                                     OPTION_CODE;

   9755 12 002013   200032 236100                    LDQ     OPTION_CODE,,AUTO
        12 002014   000002 736000                    QLS     2
        12 002015   200031 036100                    ADLQ    DUP_IDX,,AUTO
        12 002016   000100 101406                    MRL     fill='000'O
        12 002017   001025 000001 11                 ADSC9   CON_DUP_IDX,Q            cn=0,n=1
        12 002020   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 002021   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 002022   000106 101500                    MRL     fill='000'O
        12 002023   200032 000004                    ADSC9   OPTION_CODE,,AUTO        cn=0,n=4
        12 002024   200035 000001                    ADSC9   CON_DUP_TBL,Q,AUTO       cn=0,n=1

     1114     9756    6                            DUP_IDX = DUP_IDX+1;

   9756 12 002025   200031 054100                    AOS     DUP_IDX,,AUTO

     1115     9757    6                            END;

     1116     9758    5                        END;

   9758 12 002026   200031 235100                    LDA     DUP_IDX,,AUTO
        12 002027   000004 115007                    CMPA    4,DL
        12 002030   001734 604000 12                 TMI     s:9741

     1117     9759    4                     IF DUP_IDX=4          /* NO CONFLICTING OR DUP OPTION       */

   9759 12 002031   002041 601000 12                 TNZ     s:9763

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:181  
     1118     9760    4                      THEN
     1119     9761    4                        CALL PROCESS_OUTPUT_OPTION(OPTIONS$->OUT$BLK.SUBLK$(OPT_IDX));

   9761 12 002032   200030 236100                    LDQ     OPT_IDX,,AUTO
        12 002033   000022 736000                    QLS     18
        12 002034   000003 036003                    ADLQ    3,DU
        12 002035   200024 036100                    ADLQ    OPTIONS$,,AUTO
        12 002036   200063 756100                    STQ     CON_DUP_TBL+22,,AUTO
        12 002037   002531 701000 12                 TSX1    PROCESS_OUTPUT_OPTION
        12 002040   000000 011000                    NOP     0

     1120     9762    4                     END;

     1121     9763    3   END CHECK_AND_PROCESS_OPT;

   9763 12 002041   200060 221300                    LDX1  ! CON_DUP_TBL+19,,AUTO
        12 002042   000001 702211                    TSX2  ! 1,X1

     1122     9764        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:182  
     1123     9765    2   DO_ORG_OPTS: PROC;

   9765 12 002043   200056 741300       DO_ORG_OPTS  STX1  ! CON_DUP_TBL+17,,AUTO

     1124     9766        /*I* NAME: DO_ORG_OPTS
     1125     9767             CALL: CALL DO_ORG_OPTS;
     1126     9768             DESCRIPTION: DO_ORG_OPTS performs a first pass over the list of output
     1127     9769                          options and takes care of certain options that MUST be
     1128     9770                          recognized before the rest can be processed.
     1129     9771
     1130     9772                          If the option affects the output organization, it is
     1131     9773                          processed and the resulting PCL code stuffed into ORG_CODE.
     1132     9774                          It also sets ORG_MASK(ORG_CODE) to be the only bit set
     1133     9775                          ORG_MASK.
     1134     9776
     1135     9777                          The scan also sets OCB.FLAVOR.FORMATTED flag if the
     1136     9778                          output record won't look like the input record.
     1137     9779        */
     1138     9780        /**/
     1139     9781        /*  STATIC DATA  */
     1140     9782        /**/
     1141     9783    3           IF NOT CMD_MASK(12)             /* IF NOT MODIFY COMMAND              */

   9783 12 002044   000000 236000 xsym               LDQ     CMD_MASK
        12 002045   000040 316003                    CANQ    32,DU
        12 002046   002111 601000 12                 TNZ     s:9801

     1142     9784    3            THEN
     1143     9785    4            DO OPT_IDX=OPT_START TO OPTIONS$->OUT$BLK.NSUBLKS-1;

   9785 12 002047   200014 235100                    LDA     OPT_START,,AUTO
        12 002050   200030 755100                    STA     OPT_IDX,,AUTO
        12 002051   002104 710000 12                 TRA     s:9800+1

     1144     9786    4               OPTION_CODE = OPTIONS$->OUT$BLK.SUBLK$(OPT_IDX)->OUT$BLK.CODE;

   9786 12 002052   200024 470500                    LDP0    OPTIONS$,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:183  
        12 002053   200030 720100                    LXL0    OPT_IDX,,AUTO
        12 002054   000003 471510                    LDP1    3,X0,PR0
        12 002055   100000 236100                    LDQ     0,,PR1
        12 002056   777777 376007                    ANQ     -1,DL
        12 002057   200032 756100                    STQ     OPTION_CODE,,AUTO

     1145     9787    4               IF OPTION_CODE = 18         /* KEYS                               */

   9787 12 002060   000022 116007                    CMPQ    18,DL
        12 002061   002070 600000 12                 TZE     s:9792
        12 002062   000037 116007                    CMPQ    31,DL
        12 002063   002070 600000 12                 TZE     s:9792
        12 002064   000056 116007                    CMPQ    46,DL
        12 002065   002070 600000 12                 TZE     s:9792
        12 002066   000066 116007                    CMPQ    54,DL
        12 002067   002072 601000 12                 TNZ     s:9793

     1146     9788    4                 OR OPTION_CODE = 31       /* OCTAL                              */
     1147     9789    4                 OR OPTION_CODE = 46       /* X                                  */
     1148     9790    4                 OR OPTION_CODE = 54       /* X1                                 */
     1149     9791    4                THEN
     1150     9792    4                  OCB.FLAVOR.FORMATTED = %YES#;

   9792 12 002070   200000 236003                    LDQ     65536,DU
        12 002071   000256 256000 xsym               ORSQ    OCB+174

     1151     9793    4               IF OPTION_CODE = 20         /* LN                                 */

   9793 12 002072   200032 235100                    LDA     OPTION_CODE,,AUTO
        12 002073   000024 115007                    CMPA    20,DL
        12 002074   002101 600000 12                 TZE     s:9797
        12 002075   000035 115007                    CMPA    29,DL
        12 002076   002101 600000 12                 TZE     s:9797
        12 002077   000036 115007                    CMPA    30,DL
        12 002100   002103 601000 12                 TNZ     s:9800

     1152     9794    4                 OR OPTION_CODE = 29       /* NLN (works like ORG=CONSEC)        */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:184  
     1153     9795    4                 OR OPTION_CODE = 30       /* ORG                                */
     1154     9796    4                THEN                       /* ORG is being set                   */
     1155     9797    4                  CALL CHECK_AND_PROCESS_OPT;

   9797 12 002101   001607 701000 12                 TSX1    CHECK_AND_PROCESS_OPT
        12 002102   000000 011000                    NOP     0

     1156     9798    4                ELSE                       /* This option doesn't affect ORG     */
     1157     9799    4                  ;                        /* Process it later                   */
     1158     9800    4               END;

   9800 12 002103   200030 054100                    AOS     OPT_IDX,,AUTO
        12 002104   200024 470500                    LDP0    OPTIONS$,,AUTO
        12 002105   000001 236100                    LDQ     1,,PR0
        12 002106   000022 772000                    QRL     18
        12 002107   200030 116100                    CMPQ    OPT_IDX,,AUTO
        12 002110   002052 605400 12                 TPNZ    s:9786

     1159     9801    3           IF ICB.FLAVOR.MANAGED           /* Managed input                      */

   9801 12 002111   000172 236000 xsym               LDQ     ICB+122
        12 002112   000010 316003                    CANQ    8,DU
        12 002113   002142 600000 12                 TZE     s:9809
        12 002114   000255 236000 xsym               LDQ     OCB+173
        12 002115   777000 376003                    ANQ     -512,DU
        12 002116   043000 376003                    ANQ     17920,DU
        12 002117   002142 600000 12                 TZE     s:9809
        12 002120   000100 100400                    MLR     fill='000'O
        12 002121   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 002122   200130 000010                    ADSC9   @ERROR+2,,AUTO           cn=0,n=8
        12 002123   200130 237100                    LDAQ    @ERROR+2,,AUTO
        12 002124   000122 377000 13                 ANAQ    82
        12 002125   002142 600000 12                 TZE     s:9809
        12 002126   000256 236000 xsym               LDQ     OCB+174
        12 002127   200000 316003                    CANQ    65536,DU
        12 002130   002142 601000 12                 TNZ     s:9809
        12 002131   000255 236000 xsym               LDQ     OCB+173
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:185  
        12 002132   777000 376003                    ANQ     -512,DU
        12 002133   002000 376003                    ANQ     1024,DU
        12 002134   002140 601000 12                 TNZ     s:9808
        12 002135   000172 236000 xsym               LDQ     ICB+122
        12 002136   002000 316003                    CANQ    1024,DU
        12 002137   002142 601000 12                 TNZ     s:9809

     1160     9802    3             AND (OCB.DEV_MASK & '043'O)   /* MANAGED OUTPUT                     */
     1161     9803    3             AND (CMD_MASK & '34004'O)     /* A COPY-TYPE COMMAND OR MODIFY      */
     1162     9804    3             AND NOT OCB.FLAVOR.FORMATTED  /* NO RECORD FORMATTING               */
     1163     9805    3             AND NOT (NOT(OCB.DEV_MASK & '002'O) AND ICB.FLAVOR.LTOORG)
     1164     9806                                                /* NOT(LT OUTPUT) W/LT-ONLY INPUT ORG */
     1165     9807    3            THEN
     1166     9808    3              OCB.FLAVOR.CARRY_ATTR = %YES#; /* We must carry attributes         */

   9808 12 002140   400000 236003                    LDQ     -131072,DU
        12 002141   000256 256000 xsym               ORSQ    OCB+174

     1167     9809    3           IF OCB.ORG ~= 0

   9809 12 002142   000035 235000 xsym               LDA     OCB+29
        12 002143   002203 600000 12                 TZE     s:9825

     1168     9810    3            THEN
     1169     9811    4            DO;

     1170     9812    4               ORG_CODE = OCB.ORG;

   9812 12 002144   200033 755100                    STA     ORG_CODE,,AUTO

     1171     9813    4               FPT_OPEN_OUT.V.ORG# = ORG_TBL.ORG_MON(ORG_CODE);

   9813 12 002145   200033 236100                    LDQ     ORG_CODE,,AUTO
        12 002146   000022 402007                    MPY     18,DL
        12 002147   000000 100406                    MLR     fill='000'O
        12 002150   000000 000001 xsym               ADSC9   ORG_TBL,Q                cn=0,n=1
        12 002151   000046 400001 xsym               ADSC9   FPT_OPEN_OUT+38          cn=2,n=1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:186  

     1172     9814    4               IF NOT (ORG_TBL.OUT_DEV_ALLOWED(ORG_CODE) & OCB.DEV_MASK)

   9814 12 002152   000255 236000 xsym               LDQ     OCB+173
        12 002153   777000 376003                    ANQ     -512,DU
        12 002154   200130 756100                    STQ     @ERROR+2,,AUTO
        12 002155   200033 236100                    LDQ     ORG_CODE,,AUTO
        12 002156   000022 402007                    MPY     18,DL
        12 002157   000100 100406                    MLR     fill='000'O
        12 002160   000004 000002 xsym               ADSC9   ORG_TBL+4,Q              cn=0,n=2
        12 002161   200131 000004                    ADSC9   @ERROR+3,,AUTO           cn=0,n=4
        12 002162   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 002163   200130 376100                    ANQ     @ERROR+2,,AUTO
        12 002164   002252 601000 12                 TNZ     s:9845

     1173     9815    4                THEN
     1174     9816    5                DO;

     1175     9817    5                   FIELD1_ = VECTOR(ORG_TBL.NAME(ORG_CODE));

   9817 12 002165   000115 235000 13                 LDA     77
        12 002166   200033 236100                    LDQ     ORG_CODE,,AUTO
        12 002167   200130 755100                    STA     @ERROR+2,,AUTO
        12 002170   000117 402000 13                 MPY     79
        12 002171   000116 036000 13                 ADLQ    78
        12 002172   200130 235100                    LDA     @ERROR+2,,AUTO
        12 002173   200010 757100                    STAQ    FIELD1_,,AUTO

     1176     9818    5                   CALL BAD_OPT(3,10);

   9818 12 002174   000016 236000 13                 LDQ     14
        12 002175   200126 756100                    STQ     @ERROR,,AUTO
        12 002176   000005 236000 13                 LDQ     5
        12 002177   200125 756100                    STQ     @SEVERITY,,AUTO
        12 002200   001561 701000 12                 TSX1    BAD_OPT
        12 002201   000000 011000                    NOP     0

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:187  
     1177     9819        /*E*   ERROR: VPC-00010
     1178     9820             MESSAGE: %U1 organization not allowed this device type
     1179     9821        */
     1180     9822    5                   END;

     1181     9823    4               END;

   9823 12 002202   002252 710000 12                 TRA     s:9845

     1182     9824    3            ELSE                           /* NO ORG SPECIFIED...                */
     1183     9825    3              IF OCB.FLAVOR.CARRY_ATTR

   9825 12 002203   000256 234000 xsym               SZN     OCB+174
        12 002204   002235 605000 12                 TPL     s:9836

     1184     9826    3               THEN
     1185     9827    4               DO;                         /* GET ORG FROM INPUT DCB             */

     1186     9828    4                  FPT_OPEN_OUT.V.ORG# = M$EI$->F$DCB.ORG;

   9828 12 002205   000000 470400 xsym               LDP0    M$EI$
        12 002206   000032 236100                    LDQ     26,,PR0
        12 002207   000022 772000                    QRL     18
        12 002210   000046 552010 xsym               STBQ    FPT_OPEN_OUT+38,'10'O

     1187     9829    4                  ORG_CODE = %MAX_ORG#;

   9829 12 002211   000032 236007                    LDQ     26,DL
        12 002212   200033 756100                    STQ     ORG_CODE,,AUTO

     1188     9830    5                  DO WHILE(ORG_CODE > 0

   9830 12 002213   002216 710000 12                 TRA     s:9833

     1189     9831    5                    AND ORG_TBL.ORG_MON(ORG_CODE) ~= M$EI$->F$DCB.ORG);
     1190     9832    5                     ORG_CODE = ORG_CODE-1;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:188  
   9832 12 002214   000001 336007                    LCQ     1,DL
        12 002215   200033 056100                    ASQ     ORG_CODE,,AUTO

     1191     9833    5                     END;

   9833 12 002216   200033 235100                    LDA     ORG_CODE,,AUTO
        12 002217   002234 604400 12                 TMOZ    s:9834
        12 002220   000000 470400 xsym               LDP0    M$EI$
        12 002221   000032 236100                    LDQ     26,,PR0
        12 002222   000033 772000                    QRL     27
        12 002223   200130 756100                    STQ     @ERROR+2,,AUTO
        12 002224   200033 236100                    LDQ     ORG_CODE,,AUTO
        12 002225   000022 402007                    MPY     18,DL
        12 002226   000100 101406                    MRL     fill='000'O
        12 002227   000000 000001 xsym               ADSC9   ORG_TBL,Q                cn=0,n=1
        12 002230   200131 000004                    ADSC9   @ERROR+3,,AUTO           cn=0,n=4
        12 002231   200131 236100                    LDQ     @ERROR+3,,AUTO
        12 002232   200130 116100                    CMPQ    @ERROR+2,,AUTO
        12 002233   002214 601000 12                 TNZ     s:9832

     1192     9834    4                  END;

   9834 12 002234   002252 710000 12                 TRA     s:9845

     1193     9835    3               ELSE
     1194     9836    3                 IF OCB.DEV_MASK='004'O    /* FT default org                     */

   9836 12 002235   000255 236000 xsym               LDQ     OCB+173
        12 002236   777000 376003                    ANQ     -512,DU
        12 002237   004000 116003                    CMPQ    2048,DU
        12 002240   002246 601000 12                 TNZ     s:9842

     1195     9837    4                  THEN DO;

     1196     9838    4                     FPT_OPEN_OUT.V.ORG# = %FREE#;

   9838 12 002241   023000 236007                    LDQ     9728,DL
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:189  
        12 002242   000046 552010 xsym               STBQ    FPT_OPEN_OUT+38,'10'O

     1197     9839    4                     ORG_CODE = 13;

   9839 12 002243   000015 235007                    LDA     13,DL
        12 002244   200033 755100                    STA     ORG_CODE,,AUTO

     1198     9840    4                     END;

   9840 12 002245   002252 710000 12                 TRA     s:9845

     1199     9841    4                  ELSE DO;

     1200     9842    4                     FPT_OPEN_OUT.V.ORG# = %CONSEC#;

   9842 12 002246   001000 236007                    LDQ     512,DL
        12 002247   000046 552010 xsym               STBQ    FPT_OPEN_OUT+38,'10'O

     1201     9843    4                     ORG_CODE = 1;

   9843 12 002250   000001 235007                    LDA     1,DL
        12 002251   200033 755100                    STA     ORG_CODE,,AUTO

     1202     9844    4                     END;

     1203     9845    3           ORG_MASK = '0'B;

   9845 12 002252   200034 450100                    STZ     ORG_MASK,,AUTO

     1204     9846    3           ORG_MASK(ORG_CODE) = '1'B;

   9846 12 002253   200033 235100                    LDA     ORG_CODE,,AUTO
        12 002254   002256 605000 12                 TPL     s:9846+3
        12 002255   000044 035003                    ADLA    36,DU
        12 002256   003105 060400                    CSL     bolr='003'O
        12 002257   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
        12 002260   200034 000001                    BDSC    ORG_MASK,A,AUTO          by=0,bit=0,n=1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:190  

     1205     9847    3   END DO_ORG_OPTS;

   9847 12 002261   200056 221300                    LDX1  ! CON_DUP_TBL+17,,AUTO
        12 002262   000001 702211                    TSX2  ! 1,X1

     1206     9848        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:191  
     1207     9849    2   SET_DEFAULTS: PROC;

   9849 12 002263   200056 741300       SET_DEFAULTS STX1  ! CON_DUP_TBL+17,,AUTO

     1208     9850        /*I* NAME: SET_DEFAULTS
     1209     9851             CALL: CALL SET_DEFAULTS;
     1210     9852             DESCRIPTION: SET_DEFAULTS stuffs default OPEN parameters for the
     1211     9853                          output DCB, and sets certain defualts in OCB.
     1212     9854
     1213     9855                          This routine is invoked after the processing of
     1214     9856                          the first-pass options (DO_ORG_OPTS), but before
     1215     9857                          the setting of individual options.
     1216     9858        */
     1217     9859        /**/
     1218     9860        /*  STATIC DATA  */
     1219     9861        /**/
     1220     9862    3   DCL FORM_DEFAULT CHAR(6) STATIC;
     1221     9863    3           IF (CMD_MASK & '34'O)           /* COPY, COPYALL, or COPYSTD          */

   9863 12 002264   000100 100400                    MLR     fill='000'O
        12 002265   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 002266   200130 000010                    ADSC9   @ERROR+2,,AUTO           cn=0,n=8
        12 002267   200130 237100                    LDAQ    @ERROR+2,,AUTO
        12 002270   000124 377000 13                 ANAQ    84
        12 002271   002355 600000 12                 TZE     s:9893

     1222     9864    3            THEN
     1223     9865    4            DO;

     1224     9866    4               IF ICB.FLAVOR.MANAGED

   9866 12 002272   000172 236000 xsym               LDQ     ICB+122
        12 002273   000010 316003                    CANQ    8,DU
        12 002274   002314 600000 12                 TZE     s:9874

     1225     9867    4                THEN                       /* IXTNSIZE can default to input file */
     1226     9868    5                DO;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:192  

     1227     9869    5                   PTR$ = ADDR(FPARAM_BUF);

   9869 12 002275   000126 236000 13                 LDQ     86
        12 002276   200007 756100                    STQ     PTR$,,AUTO

     1228     9870    5                   CALL XSF$LOCCODP(PTR$,3) ALTRET(NO_CODE_3);

   9870 12 002277   000005 236000 13                 LDQ     5
        12 002300   200131 756100                    STQ     @ERROR+3,,AUTO
        12 002301   200007 630500                    EPPR0   PTR$,,AUTO
        12 002302   200130 450500                    STP0    @ERROR+2,,AUTO
        12 002303   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 002304   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002305   000000 701000 xent               TSX1    XSF$LOCCODP
        12 002306   002316 702000 12                 TSX2    NO_CODE_3

     1229     9871    5                   FPT_OPEN_OUT.V.IXTNSIZE# = PTR$->CODE03.UGRANS;

   9871 12 002307   200007 470500                    LDP0    PTR$,,AUTO
        12 002310   000000 236100                    LDQ     0,,PR0
        12 002311   000032 376000 xsym               ANQ     B_VECTNIL+26
        12 002312   000055 756000 xsym               STQ     FPT_OPEN_OUT+45

     1230     9872    5                   END;

   9872 12 002313   002316 710000 12                 TRA     NO_CODE_3

     1231     9873    4                ELSE                       /* Use a suitable, constant, default  */
     1232     9874    4                  FPT_OPEN_OUT.V.IXTNSIZE# = 2;

   9874 12 002314   000002 235007                    LDA     2,DL
        12 002315   000055 755000 xsym               STA     FPT_OPEN_OUT+45

     1233     9875    4   NO_CODE_3:
     1234     9876    4               IF M$EI$->F$DCB.ORG = ORG_TBL.ORG_MON(ORG_CODE)

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:193  
   9876 12 002316   200033 236100       NO_CODE_3    LDQ     ORG_CODE,,AUTO
        12 002317   000022 402007                    MPY     18,DL
        12 002320   000100 101406                    MRL     fill='000'O
        12 002321   000000 000001 xsym               ADSC9   ORG_TBL,Q                cn=0,n=1
        12 002322   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 002323   000000 470400 xsym               LDP0    M$EI$
        12 002324   000032 236100                    LDQ     26,,PR0
        12 002325   000033 772000                    QRL     27
        12 002326   200130 116100                    CMPQ    @ERROR+2,,AUTO
        12 002327   002355 601000 12                 TNZ     s:9893

     1235     9877    4                THEN
     1236     9878    5                DO CASE(ORG_CODE);

   9878 12 002330   200033 235100                    LDA     ORG_CODE,,AUTO
        12 002331   000005 115007                    CMPA    5,DL
        12 002332   002334 602005 12                 TNC     s:9878+4,AL
        12 002333   002355 710000 12                 TRA     s:9893
        12 002334   002355 710000 12                 TRA     s:9893
        12 002335   002355 710000 12                 TRA     s:9893
        12 002336   002341 710000 12                 TRA     s:9880
        12 002337   002344 710000 12                 TRA     s:9882
        12 002340   002351 710000 12                 TRA     s:9885

     1237     9879    5                 CASE(2);                  /* FIXED                              */

     1238     9880    5                   FPT_OPEN_OUT.V.RECL# = M$EI$->F$DCB.RECL;

   9880 12 002341   000033 720100                    LXL0    27,,PR0
        12 002342   000052 440000 xsym               SXL0    FPT_OPEN_OUT+42
        12 002343   002355 710000 12                 TRA     s:9893

     1239     9881    5                 CASE(3);                  /* INDEXED                            */

     1240     9882    5                   FPT_OPEN_OUT.V.KEYX# = M$EI$->F$DCB.KEYX;

   9882 12 002344   000036 220100                    LDX0    30,,PR0
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:194  
        12 002345   000051 740000 xsym               STX0    FPT_OPEN_OUT+41

     1241     9883    5                   FPT_OPEN_OUT.V.KEYL# = M$EI$->F$DCB.KEYL;

   9883 12 002346   000036 236100                    LDQ     30,,PR0
        12 002347   000051 552010 xsym               STBQ    FPT_OPEN_OUT+41,'10'O
        12 002350   002355 710000 12                 TRA     s:9893

     1242     9884    5                 CASE(4);                  /* RELATIVE                           */

     1243     9885    5                   FPT_OPEN_OUT.V.RECL# = M$EI$->F$DCB.RECL;

   9885 12 002351   000033 720100                    LXL0    27,,PR0
        12 002352   000052 440000 xsym               SXL0    FPT_OPEN_OUT+42

     1244     9886    5                   FPT_OPEN_OUT.V.NRECS# = M$EI$->F$DCB.NRECS;

   9886 12 002353   000042 235100                    LDA     34,,PR0
        12 002354   000056 755000 xsym               STA     FPT_OPEN_OUT+46

     1245     9887    5                 END;

     1246     9888    4               END;

     1247     9889        /**/
     1248     9890        /*  TYPE should be carried across by default unless attributes in             */
     1249     9891        /*  general are being left behind.                                            */
     1250     9892        /**/
     1251     9893    3           IF NOT OCB.FLAVOR.CARRY_ATTR

   9893 12 002355   000256 234000 xsym               SZN     OCB+174
        12 002356   002364 604000 12                 TMI     s:9902

     1252     9894    3            THEN                           /* Output won't look like input       */
     1253     9895    4            DO;

     1254     9896    4               OCB.TYPE = '  ';            /* TYPE shouldn't get carried         */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:195  

   9896 12 002357   001164 236000 11                 LDQ     CON_DUP_IDX+95
        12 002360   000011 772000                    QRL     9
        12 002361   000043 552030 xsym               STBQ    OCB+35,'30'O

     1255     9897    4               FPT_OPEN_OUT.V.TYPE# = '  ';

   9897 12 002362   001164 220000 11                 LDX0    CON_DUP_IDX+95
        12 002363   000047 740000 xsym               STX0    FPT_OPEN_OUT+39

     1256     9898    4               END;

     1257     9899        /**/
     1258     9900        /*  When COPYing INTO a file, default to not release NGAVAL.  */
     1259     9901        /**/
     1260     9902    3           IF FPT_OPEN_OUT.V.EXIST# = %OLDFILE# AND OUT_FILE_EXISTS

   9902 12 002364   000044 236000 xsym               LDQ     FPT_OPEN_OUT+36
        12 002365   000600 376007                    ANQ     384,DL
        12 002366   000400 116007                    CMPQ    256,DL
        12 002367   002374 601000 12                 TNZ     s:9909
        12 002370   200017 234100                    SZN     OUT_FILE_EXISTS,,AUTO
        12 002371   002374 605000 12                 TPL     s:9909

     1261     9903    3            THEN
     1262     9904    3              OCB.RELEASE = 2;

   9904 12 002372   002000 236003                    LDQ     1024,DU
        12 002373   000043 552040 xsym               STBQ    OCB+35,'40'O

     1263     9905        /**/
     1264     9906        /*  Tapes should default VOL to the last volume of this set that was          */
     1265     9907        /*  accessed.                                                                 */
     1266     9908        /**/
     1267     9909    3           IF OCB.DEV_MASK & '006'O

   9909 12 002374   000255 236000 xsym               LDQ     OCB+173
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:196  
        12 002375   777000 376003                    ANQ     -512,DU
        12 002376   006000 376003                    ANQ     3072,DU
        12 002377   002417 600000 12                 TZE     s:9918

     1268     9910    3            THEN                           /* Tapes are invloved                 */
     1269     9911    4            DO;

     1270     9912    4               CALL VPD$CHECK_VOL(OUT_SN,3,,I,1); /* Last VOL# is the default    */

   9912 12 002400   000032 236000 13                 LDQ     26
        12 002401   200134 756100                    STQ     @ERROR+6,,AUTO
        12 002402   200026 630500                    EPPR0   I,,AUTO
        12 002403   200133 450500                    STP0    @ERROR+5,,AUTO
        12 002404   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 002405   200132 756100                    STQ     @ERROR+4,,AUTO
        12 002406   000130 237000 13                 LDAQ    88
        12 002407   200130 757100                    STAQ    @ERROR+2,,AUTO
        12 002410   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 002411   000023 631400 xsym               EPPR1   B_VECTNIL+19
        12 002412   000000 701000 xent               TSX1    VPD$CHECK_VOL
        12 002413   000000 011000                    NOP     0

     1271     9913    4               FPT_OPEN_OUT.V.VOL# = I;    /* Stuff in UBIN(9) field             */

   9913 12 002414   200026 236100                    LDQ     I,,AUTO
        12 002415   000033 736000                    QLS     27
        12 002416   000061 552040 xsym               STBQ    FPT_OPEN_OUT+49,'40'O

     1272     9914    4               END;

     1273     9915        /**/
     1274     9916        /*  COMPRESSED should be carried across by default.  */
     1275     9917        /**/
     1276     9918    3           IF M$EI$ -> F$DCB.COMP

   9918 12 002417   000000 470400 xsym               LDP0    M$EI$
        12 002420   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:197  
        12 002421   000100 316007                    CANQ    64,DL
        12 002422   002427 600000 12                 TZE     s:9924

     1277     9919    3            THEN                           /* Carry COMPRESSED across            */
     1278     9920    3              FPT_OPEN_OUT.V.COMP# = %YES#;

   9920 12 002423   000047 236000 xsym               LDQ     FPT_OPEN_OUT+39
        12 002424   000132 376000 13                 ANQ     90
        12 002425   400000 276007                    ORQ     -131072,DL
        12 002426   000047 756000 xsym               STQ     FPT_OPEN_OUT+39

     1279     9921        /**/
     1280     9922        /*  FORM should be carried across by default. */
     1281     9923        /**/
     1282     9924    3           IF NOT OCB.FLAVOR.CARRY_ATTR

   9924 12 002427   000256 234000 xsym               SZN     OCB+174
        12 002430   002452 605000 12                 TPL     NO_FORM_DEFAULT

     1283     9925    3            THEN
     1284     9926    3              GOTO NO_FORM_DEFAULT;
     1285     9927    3           PTR$ = ADDR(FPARAM_BUF);

   9927 12 002431   000126 236000 13                 LDQ     86
        12 002432   200007 756100                    STQ     PTR$,,AUTO

     1286     9928    3           CALL XSF$LOCCODP(PTR$,16) ALTRET(NO_FORM_DEFAULT);

   9928 12 002433   000134 236000 13                 LDQ     92
        12 002434   200131 756100                    STQ     @ERROR+3,,AUTO
        12 002435   200007 631500                    EPPR1   PTR$,,AUTO
        12 002436   200130 451500                    STP1    @ERROR+2,,AUTO
        12 002437   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 002440   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002441   000000 701000 xent               TSX1    XSF$LOCCODP
        12 002442   002452 702000 12                 TSX2    NO_FORM_DEFAULT

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:198  
     1287     9929    3           FORM_DEFAULT = PTR$ -> CODE16.FORM;

   9929 12 002443   200007 470500                    LDP0    PTR$,,AUTO
        12 002444   040000 100500                    MLR     fill='040'O
        12 002445   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
        12 002446   000062 000006 10                 ADSC9   FORM_DEFAULT             cn=0,n=6

     1288     9930    3           FPT_OPEN_OUT.FORM_ = VECTOR(FORM_DEFAULT);

   9930 12 002447   000136 237000 13                 LDAQ    94
        12 002450   000040 757000 xsym               STAQ    FPT_OPEN_OUT+32

     1289     9931    4           DO WHILE (%NO#);

   9931 12 002451   002454 710000 12                 TRA     s:9938

   9930 12 002452                       NO_FORM_DEF* null
     1290     9932    4   NO_FORM_DEFAULT: ;
     1291     9933    4              FPT_OPEN_OUT.FORM_ = VECTOR(NIL);

   9933 12 002452   000022 237000 13                 LDAQ    18
        12 002453   000040 757000 xsym               STAQ    FPT_OPEN_OUT+32

     1292     9934    4              END;

     1293     9935        /**/
     1294     9936        /*  We are finished.  */
     1295     9937        /**/
     1296     9938    3           RETURN;

   9938 12 002454   200056 221300                    LDX1  ! CON_DUP_TBL+17,,AUTO
        12 002455   000001 702211                    TSX2  ! 1,X1

     1297     9939    3   END SET_DEFAULTS;
     1298     9940        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:199  
     1299     9941    2   RECONCILE_DEFAULTS_BEFORE_OPEN: PROC;

   9941 12 002456   200056 741300       RECONCILE_D* STX1  ! CON_DUP_TBL+17,,AUTO

     1300     9942        /*I* NAME:  RECONCILE_DEFAULTS_BEFORE_OPEN
     1301     9943             CALL:  CALL RECONCILE_DEFAULTS_BEFORE_OPEN;
     1302     9944             DESCRIPTION:  This routine sets certain defaults after all
     1303     9945                           options have been processed, but before the
     1304     9946                           output file is OPENed.
     1305     9947
     1306     9948                           The defaults typically have to be placed in the
     1307     9949                           OPEN FPT.
     1308     9950        */
     1309     9951    3           IF OCB.VFC = 3                  /* SVFC specified                     */

   9951 12 002457   000024 236000 xsym               LDQ     OCB+20
        12 002460   600000 376003                    ANQ     -65536,DU
        12 002461   600000 116003                    CMPQ    -65536,DU
        12 002462   002501 601000 12                 TNZ     s:9961
        12 002463   000172 236000 xsym               LDQ     ICB+122
        12 002464   000002 316003                    CANQ    2,DU
        12 002465   002501 600000 12                 TZE     s:9961
        12 002466   000046 236000 xsym               LDQ     FPT_OPEN_OUT+38
        12 002467   777000 376007                    ANQ     -512,DL
        12 002470   004000 116007                    CMPQ    2048,DL
        12 002471   002501 601000 12                 TNZ     s:9961

     1310     9952    3             AND ICB.FLAVOR.UR
     1311     9953    3             AND FPT_OPEN_OUT.V.ORG# = %UR#
     1312     9954    3            THEN
     1313     9955    4            DO;

     1314     9956    4               FPT_OPEN_OUT.V.ORG# = %CONSEC#;

   9956 12 002472   001000 236007                    LDQ     512,DL
        12 002473   000046 552010 xsym               STBQ    FPT_OPEN_OUT+38,'10'O

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:200  
     1315     9957    4               OCB.ORG=1;             /* THIS IS PCL'S INTERNAL CODE FOR CONSEC*/

   9957 12 002474   000001 235007                    LDA     1,DL
        12 002475   000035 755000 xsym               STA     OCB+29

     1316     9958    4               ORG_MASK = '0'B;

   9958 12 002476   200034 450100                    STZ     ORG_MASK,,AUTO

     1317     9959    4               ORG_MASK(1)='1'B;

   9959 12 002477   200000 236003                    LDQ     65536,DU
        12 002500   200034 256100                    ORSQ    ORG_MASK,,AUTO

     1318     9960    4               END;

     1319     9961    3           IF FPT_OPEN_OUT.V.ORG# = %CONSEC#

   9961 12 002501   000046 236000 xsym               LDQ     FPT_OPEN_OUT+38
        12 002502   777000 376007                    ANQ     -512,DL
        12 002503   001000 116007                    CMPQ    512,DL
        12 002504   002511 600000 12                 TZE     s:9965
        12 002505   004000 116007                    CMPQ    2048,DL
        12 002506   002511 600000 12                 TZE     s:9965
        12 002507   010000 116007                    CMPQ    4096,DL
        12 002510   002514 601000 12                 TNZ     s:9967

     1320     9962    3             OR FPT_OPEN_OUT.V.ORG# = %UR#
     1321     9963    3             OR FPT_OPEN_OUT.V.ORG# = %TERMINAL#
     1322     9964    3            THEN
     1323     9965    3              FPT_OPEN_OUT.V.ACS# = %SEQUEN#;

   9965 12 002511   000001 236007                    LDQ     1,DL
        12 002512   000046 552004 xsym               STBQ    FPT_OPEN_OUT+38,'04'O
        12 002513   002516 710000 12                 TRA     s:9968

     1324     9966    3            ELSE
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:201  
     1325     9967    3              FPT_OPEN_OUT.V.ACS# = %DIRECT#;

   9967 12 002514   000002 236007                    LDQ     2,DL
        12 002515   000046 552004 xsym               STBQ    FPT_OPEN_OUT+38,'04'O

     1326     9968    3           IF OCB.NFA

   9968 12 002516   000025 234000 xsym               SZN     OCB+21
        12 002517   002530 605000 12                 TPL     s:9973
        12 002520   000256 234000 xsym               SZN     OCB+174
        12 002521   002530 605000 12                 TPL     s:9973
        12 002522   000043 236000 xsym               LDQ     OCB+35
        12 002523   000020 316000 13                 CANQ    16
        12 002524   002530 601000 12                 TNZ     s:9973

     1327     9969    3             AND OCB.FLAVOR.CARRY_ATTR
     1328     9970    3             AND OCB.TYPE_BIT='0'B
     1329     9971    3            THEN
     1330     9972    3              FPT_OPEN_OUT.V.TYPE# = M$EI$->F$DCB.TYPE;

   9972 12 002525   000000 470400 xsym               LDP0    M$EI$
        12 002526   000025 720100                    LXL0    21,,PR0
        12 002527   000047 740000 xsym               STX0    FPT_OPEN_OUT+39

     1331     9973    3   END RECONCILE_DEFAULTS_BEFORE_OPEN;

   9973 12 002530   000001 702211                    TSX2  ! 1,X1

     1332     9974        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:202  
     1333     9975        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:203  
     1334     9976    2   PROCESS_OUTPUT_OPTION: PROC(OPTION$);

   9976 12 002531   200062 741300       PROCESS_OUT* STX1  ! CON_DUP_TBL+21,,AUTO

     1335     9977        /*I* NAME: PROCESS_OUTPUT_OPTION
     1336     9978             PURPOSE: To further check and act upon specified output options
     1337     9979             CALL: CALL PROCESS_OUTPUT_OPTION(OPTION$);
     1338     9980             DESCRIPTION: OPTION$ points to the head node of the option in question.
     1339     9981                          This option is checked for validity in those cases where
     1340     9982                          further checking is required. The option is interpreted
     1341     9983                          and action is taken to see that it is honored. This
     1342     9984                          could be any of 1) altering the OPEN FPT
     1343     9985                                          2) setting some field in OCB
     1344     9986        */
     1345     9987        /**/
     1346     9988        /*  PARAMETERS  */
     1347     9989        /**/
     1348     9990    3   DCL OPTION$ PTR;                        /* POINTER TO CURRENT OPTION BLK      */
     1349     9991        /**/
     1350     9992        /*  STATIC DATA  */
     1351     9993        /**/
     1352     9994    3   DCL BLK$ PTR;
     1353     9995    3   DCL CHAR2 CHAR(2);
     1354     9996    3   DCL CHAR3 CHAR(3);
     1355     9997    3   DCL J SBIN WORD;
     1356     9998    3   DCL K SBIN WORD;
     1357     9999    3   DCL L SBIN WORD;
     1358    10000    3   DCL TWORD UBIN WORD;
     1359    10001    3   DCL T$ PTR;
     1360    10002    3   DCL DATE_TYPE UBIN STATIC;
     1361    10003    3   DCL TSTAMP# UBIN WORD STATIC;
     1362    10004    3   DCL SAV_TSTAMP# UBIN WORD;
     1363    10005    3   DCL CREATE_TSTAMP# UBIN WORD;
     1364    10006    3   DCL SAV_25TH_TSTAMP# SBIN WORD;
     1365    10007    3   DCL CREATE_25TH_TSTAMP# SBIN WORD;
     1366    10008    3   DCL NUM SBIN WORD;
     1367    10009        /**/
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:204  
     1368    10010        /*  ENTRY POINTS  */
     1369    10011        /**/
     1370    10012    3   DCL VPD$PROCESS_DATE ENTRY(4) ALTRET;
     1371    10013        /**/
     1372    10014        /*  Constants  */
     1373    10015        /**/
     1374    10016    3   DCL ZERO_BYTE2 BIT(18) CONSTANT INIT('0'B);
     1375    10017    3   DCL NULL_CHR2 REDEF ZERO_BYTE2 CHAR(2);
     1376    10018        %INCLUDE XUD_UTS_M;
     1377    10100        %XUD$UTS_ENTRIES;
     1378    10132        %XUD_UTS_EQU;
     1379    10143        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:205  
     1380    10144    4           DO CASE(OPTION$->OUT$BLK.CODE);

  10144 12 002532   200063 470500                    LDP0    @OPTION$,,AUTO
        12 002533   000000 471500                    LDP1    0,,PR0
        12 002534   100000 720100                    LXL0    0,,PR1
        12 002535   000132 100003                    CMPX0   90,DU
        12 002536   002540 602010 12                 TNC     s:10144+6,X0
        12 002537   005164 710000 12                 TRA     s:10773
        12 002540   005164 710000 12                 TRA     s:10773
        12 002541   002672 710000 12                 TRA     s:10147
        12 002542   002716 710000 12                 TRA     s:10162
        12 002543   002721 710000 12                 TRA     s:10164
        12 002544   002724 710000 12                 TRA     s:10166
        12 002545   002727 710000 12                 TRA     s:10168
        12 002546   002754 710000 12                 TRA     s:10179
        12 002547   002774 710000 12                 TRA     s:10187
        12 002550   003120 710000 12                 TRA     s:10225
        12 002551   003123 710000 12                 TRA     s:10227
        12 002552   003132 710000 12                 TRA     s:10230
        12 002553   003137 710000 12                 TRA     s:10233
        12 002554   003206 710000 12                 TRA     s:10256
        12 002555   003213 710000 12                 TRA     s:10258
        12 002556   003374 710000 12                 TRA     s:10309
        12 002557   003401 710000 12                 TRA     s:10311
        12 002560   003431 710000 12                 TRA     s:10320
        12 002561   003457 710000 12                 TRA     s:10331
        12 002562   003504 710000 12                 TRA     s:10342
        12 002563   003606 710000 12                 TRA     s:10372
        12 002564   003611 710000 12                 TRA     s:10374
        12 002565   003703 710000 12                 TRA     s:10405
        12 002566   003732 710000 12                 TRA     s:10418
        12 002567   003761 710000 12                 TRA     s:10431
        12 002570   004007 710000 12                 TRA     s:10442
        12 002571   004012 710000 12                 TRA     s:10444
        12 002572   004015 710000 12                 TRA     s:10446
        12 002573   004020 710000 12                 TRA     s:10448
        12 002574   004030 710000 12                 TRA     s:10452
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:206  
        12 002575   004033 710000 12                 TRA     s:10454
        12 002576   004036 710000 12                 TRA     s:10456
        12 002577   004054 710000 12                 TRA     s:10467
        12 002600   004140 710000 12                 TRA     s:10488
        12 002601   002672 710000 12                 TRA     s:10147
        12 002602   004163 710000 12                 TRA     s:10498
        12 002603   004210 710000 12                 TRA     s:10509
        12 002604   004213 710000 12                 TRA     s:10511
        12 002605   004242 710000 12                 TRA     s:10523
        12 002606   004271 710000 12                 TRA     s:10535
        12 002607   004276 710000 12                 TRA     s:10538
        12 002610   004301 710000 12                 TRA     s:10540
        12 002611   004340 710000 12                 TRA     s:10553
        12 002612   002704 710000 12                 TRA     s:10155
        12 002613   004343 710000 12                 TRA     s:10555
        12 002614   004360 710000 12                 TRA     s:10561
        12 002615   002672 710000 12                 TRA     s:10147
        12 002616   004054 710000 12                 TRA     s:10467
        12 002617   004410 710000 12                 TRA     s:10576
        12 002620   004433 710000 12                 TRA     s:10586
        12 002621   004350 710000 12                 TRA     s:10557
        12 002622   004436 710000 12                 TRA     s:10588
        12 002623   004441 710000 12                 TRA     s:10590
        12 002624   004444 710000 12                 TRA     s:10592
        12 002625   004447 710000 12                 TRA     s:10594
        12 002626   004054 710000 12                 TRA     s:10467
        12 002627   004463 710000 12                 TRA     s:10600
        12 002630   004466 710000 12                 TRA     s:10602
        12 002631   004624 710000 12                 TRA     s:10651
        12 002632   004456 710000 12                 TRA     s:10597
        12 002633   004631 710000 12                 TRA     s:10653
        12 002634   004652 710000 12                 TRA     s:10660
        12 002635   002704 710000 12                 TRA     s:10155
        12 002636   002704 710000 12                 TRA     s:10155
        12 002637   004355 710000 12                 TRA     s:10559
        12 002640   004655 710000 12                 TRA     s:10662
        12 002641   004667 710000 12                 TRA     s:10668
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:207  
        12 002642   004672 710000 12                 TRA     s:10670
        12 002643   004717 710000 12                 TRA     s:10681
        12 002644   004724 710000 12                 TRA     s:10684
        12 002645   004727 710000 12                 TRA     s:10686
        12 002646   004732 710000 12                 TRA     s:10688
        12 002647   004735 710000 12                 TRA     s:10690
        12 002650   004772 710000 12                 TRA     s:10704
        12 002651   005026 710000 12                 TRA     s:10722
        12 002652   005031 710000 12                 TRA     s:10724
        12 002653   005034 710000 12                 TRA     s:10726
        12 002654   005037 710000 12                 TRA     s:10728
        12 002655   005042 710000 12                 TRA     s:10730
        12 002656   005045 710000 12                 TRA     s:10732
        12 002657   005164 710000 12                 TRA     s:10773
        12 002660   005050 710000 12                 TRA     s:10734
        12 002661   005053 710000 12                 TRA     s:10736
        12 002662   005056 710000 12                 TRA     s:10738
        12 002663   005134 710000 12                 TRA     s:10760
        12 002664   005141 710000 12                 TRA     s:10762
        12 002665   005144 710000 12                 TRA     s:10764
        12 002666   005151 710000 12                 TRA     s:10766
        12 002667   005162 710000 12                 TRA     s:10772
        12 002670   005157 710000 12                 TRA     s:10770
        12 002671   005154 710000 12                 TRA     s:10768

     1381    10145    4            CASE(1,33,45);                 /* ACCESS, READ, WRITE                */

     1382    10146                                                /* An ACCESS account is involved      */
     1383    10147    4              OCB.ACCESS_FLG = %YES#;

  10147 12 002672   400000 236003                    LDQ     -131072,DU
        12 002673   000254 756000 xsym               STQ     OCB+172

     1384    10148    4              IF OPTION$ -> OUT$BLK.NSUBLKS > 0

  10148 12 002674   000000 471500                    LDP1    0,,PR0
        12 002675   100001 220100                    LDX0    1,,PR1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:208  
        12 002676   002702 600000 12                 TZE     s:10152

     1385    10149    4               THEN                        /* Controls exist                     */
     1386    10150    4                 CALL FILL_ACCESS_TBLS;

  10150 12 002677   005165 701000 12                 TSX1    FILL_ACCESS_TBLS
        12 002700   000000 011000                    NOP     0
        12 002701   005164 710000 12                 TRA     s:10773

     1387    10151    4               ELSE                        /* No controls spcified               */
     1388    10152    4                 OCB.ACCESS_REPLACE = %YES#;

  10152 12 002702   000253 756000 xsym               STQ     OCB+171
        12 002703   005164 710000 12                 TRA     s:10773

     1389    10153    4            CASE(42,61,62);                /* VEHICLE, VREAD, VWRITE             */

     1390    10154                                                /* An ACSVEHICLE is specified         */
     1391    10155    4              OCB.ACSVEH_FLG = %YES#;

  10155 12 002704   400000 236003                    LDQ     -131072,DU
        12 002705   000252 756000 xsym               STQ     OCB+170

     1392    10156    4              IF OPTION$ -> OUT$BLK.NSUBLKS > 0

  10156 12 002706   000000 471500                    LDP1    0,,PR0
        12 002707   100001 220100                    LDX0    1,,PR1
        12 002710   002714 600000 12                 TZE     s:10160

     1393    10157    4               THEN                        /* Controls are specified             */
     1394    10158    4                 CALL FILL_ACCESS_TBLS;

  10158 12 002711   005165 701000 12                 TSX1    FILL_ACCESS_TBLS
        12 002712   000000 011000                    NOP     0
        12 002713   005164 710000 12                 TRA     s:10773

     1395    10159    4               ELSE                        /* No controls provided               */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:209  
     1396    10160    4                 OCB.ACSVEH_REPLACE = %YES#;

  10160 12 002714   000251 756000 xsym               STQ     OCB+169
        12 002715   005164 710000 12                 TRA     s:10773

     1397    10161    4            CASE(2);                       /* NCNVRT                             */

     1398    10162    4              FPT_OPEN_OUT.V.CNVRT# = %NO#;

  10162 12 002716   000140 236000 13                 LDQ     96
        12 002717   000060 356000 xsym               ANSQ    FPT_OPEN_OUT+48
        12 002720   005164 710000 12                 TRA     s:10773

     1399    10163    4            CASE(3);                       /* NBIN                               */

     1400    10164    4              OCB.BIN = 1;

  10164 12 002721   000001 235007                    LDA     1,DL
        12 002722   000016 755000 xsym               STA     OCB+14
        12 002723   005164 710000 12                 TRA     s:10773

     1401    10165    4            CASE(4);                       /* BIN                                */

     1402    10166    4              OCB.BIN = 2;

  10166 12 002724   000002 235007                    LDA     2,DL
        12 002725   000016 755000 xsym               STA     OCB+14
        12 002726   005164 710000 12                 TRA     s:10773

     1403    10167    4            CASE(5);                       /* BLOCK                              */

     1404    10168    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10168 12 002727   100003 473500                    LDP3    3,,PR1
        12 002730   000142 236000 13                 LDQ     98
        12 002731   200132 756100                    STQ     @ERROR+4,,AUTO
        12 002732   300003 631500                    EPPR1   3,,PR3
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:210  
        12 002733   200131 451500                    STP1    @ERROR+3,,AUTO
        12 002734   200072 633500                    EPPR3   TWORD,,AUTO
        12 002735   200130 453500                    STP3    @ERROR+2,,AUTO
        12 002736   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 002737   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 002740   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 002741   002745 702000 12                 TSX2    BAD_BLKL

     1405    10169    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1406    10170    4                32767) ALTRET(BAD_BLKL);
     1407    10171    4              FPT_OPEN_OUT.V.BLKL# = TWORD;

  10171 12 002742   200072 720100                    LXL0    TWORD,,AUTO
        12 002743   000052 740000 xsym               STX0    FPT_OPEN_OUT+42

     1408    10172    4              GOTO GOOD_BLKL;

  10172 12 002744   002753 710000 12                 TRA     GOOD_BLKL

     1409    10173    4   BAD_BLKL:  CALL BAD_OPT(3,65);          /* BLKL TOO LARGE                     */

  10173 12 002745   000144 236000 13    BAD_BLKL     LDQ     100
        12 002746   200126 756100                    STQ     @ERROR,,AUTO
        12 002747   000005 236000 13                 LDQ     5
        12 002750   200125 756100                    STQ     @SEVERITY,,AUTO
        12 002751   001561 701000 12                 TSX1    BAD_OPT
        12 002752   000000 011000                    NOP     0

  10171 12 002753   005164 710000 12    GOOD_BLKL    TRA     s:10773

     1410    10174        /*E* ERROR:   VPC-00065
     1411    10175             MESSAGE: BLKL too large
     1412    10176        */
     1413    10177    4   GOOD_BLKL: ;
     1414    10178    4            CASE(6);                       /* CRPT                               */

     1415    10179    4              CALL VPD$MNG_CRPT(OCB.CRPT,OPTION$->OUT$BLK.SUBLK$(0))
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:211  

  10179 12 002754   100003 633500                    EPPR3   3,,PR1
        12 002755   200131 453500                    STP3    @ERROR+3,,AUTO
        12 002756   000145 236000 13                 LDQ     101
        12 002757   200130 756100                    STQ     @ERROR+2,,AUTO
        12 002760   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 002761   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002762   000000 701000 xent               TSX1    VPD$MNG_CRPT
        12 002763   002765 702000 12                 TSX2    s:10181
        12 002764   002773 710000 12                 TRA     s:10185

     1416    10180    5               WHENALTRETURN DO;           /*  bad  CRPT  value                  */

     1417    10181    5                  CALL BAD_OPT(3,66);

  10181 12 002765   000147 236000 13                 LDQ     103
        12 002766   200126 756100                    STQ     @ERROR,,AUTO
        12 002767   000005 236000 13                 LDQ     5
        12 002770   200125 756100                    STQ     @SEVERITY,,AUTO
        12 002771   001561 701000 12                 TSX1    BAD_OPT
        12 002772   000000 011000                    NOP     0

     1418    10182        /*E* ERROR:   VPC-00066
     1419    10183             MESSAGE: Invalid CRPT value on output.
     1420    10184        */
     1421    10185    5                  END;                     /*   END  ALTRETURN                   */

  10185 12 002773   005164 710000 12                 TRA     s:10773

     1422    10186    4            CASE(7);                       /* CS                                 */

     1423    10187    4              OCB.CS.SPEC = 1;

  10187 12 002774   000001 235007                    LDA     1,DL
        12 002775   000007 755000 xsym               STA     OCB+7

     1424    10188    4              OCB.CS.ID.L = 0;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:212  

  10188 12 002776   000000 236003                    LDQ     0,DU
        12 002777   000010 552040 xsym               STBQ    OCB+8,'40'O

     1425    10189    4              OCB.CS.N = 0;

  10189 12 003000   000013 450000 xsym               STZ     OCB+11

     1426    10190    4              OCB.CS.K = 1;

  10190 12 003001   000014 755000 xsym               STA     OCB+12

     1427    10191    4              J=0;

  10191 12 003002   200067 450100                    STZ     J,,AUTO

     1428    10192    5              DO WHILE(J<OPTION$->OUT$BLK.NSUBLKS);

  10192 12 003003   000000 471500                    LDP1    0,,PR0
        12 003004   100001 236100                    LDQ     1,,PR1
        12 003005   000022 772000                    QRL     18
        12 003006   200067 116100                    CMPQ    J,,AUTO
        12 003007   003106 604400 12                 TMOZ    s:10218

     1429    10193    5                 IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE=4

  10193 12 003010   200063 470500                    LDP0    @OPTION$,,AUTO
        12 003011   000000 471500                    LDP1    0,,PR0
        12 003012   200067 720100                    LXL0    J,,AUTO
        12 003013   100003 473510                    LDP3    3,X0,PR1
        12 003014   300000 721100                    LXL1    0,,PR3
        12 003015   000004 101003                    CMPX1   4,DU
        12 003016   003051 601000 12                 TNZ     s:10207

     1430    10194    5                  THEN
     1431    10195    5                    IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0)->

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:213  
  10195 12 003017   300003 474500                    LDP4    3,,PR3
        12 003020   000100 101500                    MRL     fill='000'O
        12 003021   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        12 003022   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 003023   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 003024   000005 116007                    CMPQ    5,DL
        12 003025   003042 605000 12                 TPL     s:10201

     1432    10196    5                      TEXT$C.LEN<5
     1433    10197    5                     THEN
     1434    10198    5                       OCB.CS.ID = OPTION$->OUT$BLK.SUBLK$(J)->

  10198 12 003026   000000 471500                    LDP1    0,,PR0
        12 003027   100003 473510                    LDP3    3,X0,PR1
        12 003030   300003 474500                    LDP4    3,,PR3
        12 003031   000100 101500                    MRL     fill='000'O
        12 003032   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        12 003033   200130 000002                    ADSC9   @ERROR+2,,AUTO           cn=0,n=2
        12 003034   200130 221100                    LDX1    @ERROR+2,,AUTO
        12 003035   000001 622011                    EAX2    1,X1
        12 003036   000000 100540                    MLR     fill='000'O
        12 003037   400000 000012                    ADSC9   0,,PR4                   cn=0,n=*X2
        12 003040   000010 000005 xsym               ADSC9   OCB+8                    cn=0,n=5
        12 003041   003077 710000 12                 TRA     s:10216

     1435    10199    5                         OUT$BLK.SUBLK$(0)->TEXT$C;
     1436    10200    5                     ELSE
     1437    10201    5                       CALL BAD_OPT(3,25); /* CS ID GREATER THAN 4 CHARS         */

  10201 12 003042   000151 236000 13                 LDQ     105
        12 003043   200126 756100                    STQ     @ERROR,,AUTO
        12 003044   000005 236000 13                 LDQ     5
        12 003045   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003046   001561 701000 12                 TSX1    BAD_OPT
        12 003047   000000 011000                    NOP     0
        12 003050   003077 710000 12                 TRA     s:10216

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:214  
     1438    10202        /*E* ERROR:   VPC-00025
     1439    10203             MESSAGE: CS ID greater than 4 chars
     1440    10204        */
     1441    10205    5                  ELSE
     1442    10206    6                  DO;

     1443    10207    6                     CALL VPD$TEXTC_CHARBIN(TWORD,

  10207 12 003051   000153 236000 13                 LDQ     107
        12 003052   200132 756100                    STQ     @ERROR+4,,AUTO
        12 003053   300003 631500                    EPPR1   3,,PR3
        12 003054   200131 451500                    STP1    @ERROR+3,,AUTO
        12 003055   200072 633500                    EPPR3   TWORD,,AUTO
        12 003056   200130 453500                    STP3    @ERROR+2,,AUTO
        12 003057   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003060   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003061   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 003062   003107 702000 12                 TSX2    BAD_CS

     1444    10208    6                       OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0),
     1445    10209    6                       9999) ALTRET(BAD_CS);
     1446    10210    6                     IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE=100

  10210 12 003063   200063 470500                    LDP0    @OPTION$,,AUTO
        12 003064   000000 471500                    LDP1    0,,PR0
        12 003065   200067 720100                    LXL0    J,,AUTO
        12 003066   100003 473510                    LDP3    3,X0,PR1
        12 003067   300000 721100                    LXL1    0,,PR3
        12 003070   000144 101003                    CMPX1   100,DU
        12 003071   003075 601000 12                 TNZ     s:10214

     1447    10211    6                      THEN
     1448    10212    6                        OCB.CS.N = TWORD;

  10212 12 003072   200072 235100                    LDA     TWORD,,AUTO
        12 003073   000013 755000 xsym               STA     OCB+11
        12 003074   003077 710000 12                 TRA     s:10216
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:215  

     1449    10213    6                      ELSE
     1450    10214    6                        OCB.CS.K = TWORD;

  10214 12 003075   200072 235100                    LDA     TWORD,,AUTO
        12 003076   000014 755000 xsym               STA     OCB+12

     1451    10215    6                     END;

     1452    10216    5                 J = J+1;

  10216 12 003077   200067 054100                    AOS     J,,AUTO

     1453    10217    5                 END;

  10217 12 003100   200063 470500                    LDP0    @OPTION$,,AUTO
        12 003101   000000 471500                    LDP1    0,,PR0
        12 003102   100001 236100                    LDQ     1,,PR1
        12 003103   000022 772000                    QRL     18
        12 003104   200067 116100                    CMPQ    J,,AUTO
        12 003105   003010 605400 12                 TPNZ    s:10193

     1454    10218    4              GOTO GOOD_CS;

  10218 12 003106   003115 710000 12                 TRA     GOOD_CS

     1455    10219    4   BAD_CS:    CALL BAD_OPT(3,67);          /* CS N OR K TOO LARGE                */

  10219 12 003107   000155 236000 13    BAD_CS       LDQ     109
        12 003110   200126 756100                    STQ     @ERROR,,AUTO
        12 003111   000005 236000 13                 LDQ     5
        12 003112   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003113   001561 701000 12                 TSX1    BAD_OPT
        12 003114   000000 011000                    NOP     0

     1456    10220        /*E* ERROR:   VPC-00067
     1457    10221             MESSAGE: CS N or K too large
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:216  
     1458    10222        */
     1459    10223    4   GOOD_CS:   OCB.CS.CURRENT = OCB.CS.N;

  10223 12 003115   000013 235000 xsym  GOOD_CS      LDA     OCB+11
        12 003116   000012 755000 xsym               STA     OCB+10
        12 003117   005164 710000 12                 TRA     s:10773

     1460    10224    4            CASE(8);                       /* CR                                 */

     1461    10225    4              OCB.CR_NCR = 1;

  10225 12 003120   000001 235007                    LDA     1,DL
        12 003121   000015 755000 xsym               STA     OCB+13
        12 003122   005164 710000 12                 TRA     s:10773

     1462    10226    4            CASE(9);                       /* COMPRESSED                         */

     1463    10227    4              OCB.COMP = 2;                /* Remember for later use             */

  10227 12 003123   000002 235007                    LDA     2,DL
        12 003124   000020 755000 xsym               STA     OCB+16

     1464    10228    4              FPT_OPEN_OUT.V.COMP# = %YES#; /* Take care of immediate needs      */

  10228 12 003125   000047 236000 xsym               LDQ     FPT_OPEN_OUT+39
        12 003126   000132 376000 13                 ANQ     90
        12 003127   400000 276007                    ORQ     -131072,DL
        12 003130   000047 756000 xsym               STQ     FPT_OPEN_OUT+39
        12 003131   005164 710000 12                 TRA     s:10773

     1465    10229    4            CASE(10);                      /* DSP                                */

     1466    10230    4              OCB.VFC_CHAR = 'B';

  10230 12 003132   102000 236003                    LDQ     33792,DU
        12 003133   000022 756000 xsym               STQ     OCB+18

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:217  
     1467    10231    4              OCB.VFC_USE = 1;

  10231 12 003134   000001 235007                    LDA     1,DL
        12 003135   000023 755000 xsym               STA     OCB+19
        12 003136   005164 710000 12                 TRA     s:10773

     1468    10232    4            CASE(11);                      /* DENSITY                            */

     1469    10233    4              CALL VPD$TEXTC_CHARBIN(J,

  10233 12 003137   100003 473500                    LDP3    3,,PR1
        12 003140   000157 236000 13                 LDQ     111
        12 003141   200132 756100                    STQ     @ERROR+4,,AUTO
        12 003142   300003 631500                    EPPR1   3,,PR3
        12 003143   200131 451500                    STP1    @ERROR+3,,AUTO
        12 003144   200067 633500                    EPPR3   J,,AUTO
        12 003145   200130 453500                    STP3    @ERROR+2,,AUTO
        12 003146   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003147   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003150   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 003151   003177 702000 12                 TSX2    BAD_DENS

     1470    10234
     1471    10235    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1472    10236    4                38000) ALTRET(BAD_DENS);
     1473    10237    4              IF  J = 38000

  10237 12 003152   200067 235100                    LDA     J,,AUTO
        12 003153   112160 115007                    CMPA    38000,DL
        12 003154   003160 601000 12                 TNZ     s:10240

     1474    10238    4               THEN
     1475    10239    4                 FPT_OPEN_OUT.V.DENSITY# = %D38000# ;

  10239 12 003155   000005 236007                    LDQ     5,DL
        12 003156   000066 552004 xsym               STBQ    FPT_OPEN_OUT+54,'04'O
        12 003157   005164 710000 12                 TRA     s:10773
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:218  

     1476    10240    4               ELSE IF J = 6250

  10240 12 003160   014152 115007                    CMPA    6250,DL
        12 003161   003165 601000 12                 TNZ     s:10243

     1477    10241    4                  THEN
     1478    10242    4                    FPT_OPEN_OUT.V.DENSITY# = %D6250# ;

  10242 12 003162   000004 236007                    LDQ     4,DL
        12 003163   000066 552004 xsym               STBQ    FPT_OPEN_OUT+54,'04'O
        12 003164   005164 710000 12                 TRA     s:10773

     1479    10243    4                  ELSE IF J = 1600

  10243 12 003165   003100 115007                    CMPA    1600,DL
        12 003166   003172 601000 12                 TNZ     s:10246

     1480    10244    4                     THEN
     1481    10245    4                       FPT_OPEN_OUT.V.DENSITY# = %D1600# ;

  10245 12 003167   000003 236007                    LDQ     3,DL
        12 003170   000066 552004 xsym               STBQ    FPT_OPEN_OUT+54,'04'O
        12 003171   005164 710000 12                 TRA     s:10773

     1482    10246    4                     ELSE IF J = 800

  10246 12 003172   001440 115007                    CMPA    800,DL
        12 003173   003177 601000 12                 TNZ     BAD_DENS

     1483    10247    4                        THEN
     1484    10248    4                          FPT_OPEN_OUT.V.DENSITY# = %D800# ;

  10248 12 003174   000002 236007                    LDQ     2,DL
        12 003175   000066 552004 xsym               STBQ    FPT_OPEN_OUT+54,'04'O
        12 003176   005164 710000 12                 TRA     s:10773

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:219  
     1485    10249    4                        ELSE
     1486    10250    4   BAD_DENS:              CALL BAD_OPT(3,26);

  10250 12 003177   000161 236000 13    BAD_DENS     LDQ     113
        12 003200   200126 756100                    STQ     @ERROR,,AUTO
        12 003201   000005 236000 13                 LDQ     5
        12 003202   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003203   001561 701000 12                 TSX1    BAD_OPT
        12 003204   000000 011000                    NOP     0
        12 003205   005164 710000 12                 TRA     s:10773

     1487    10251        /*E* ERROR:   VPC-00026
     1488    10252             MESSAGE: Illegal DENSITY specification
     1489    10253        */
     1490    10254                                                /* ILLEGAL DENSITY SPECIFICATION      */
     1491    10255    4            CASE(12);                      /* EBCDIC                             */

     1492    10256    4              FPT_OPEN_OUT.V.EBCDIC# = %YES#;

  10256 12 003206   000060 236000 xsym               LDQ     FPT_OPEN_OUT+48
        12 003207   000162 376000 13                 ANQ     114
        12 003210   400000 276003                    ORQ     -131072,DU
        12 003211   000060 756000 xsym               STQ     FPT_OPEN_OUT+48
        12 003212   005164 710000 12                 TRA     s:10773

     1493    10257    4            CASE(13);                      /* EXPIRE                             */

     1494    10258    4              CALL VPD$PROCESS_DATE(OPTION$->OUT$BLK.SUBLK$(0),

  10258 12 003213   200067 633500                    EPPR3   J,,AUTO
        12 003214   200133 453500                    STP3    @ERROR+5,,AUTO
        12 003215   200074 634500                    EPPR4   SAV_TSTAMP#,,AUTO
        12 003216   200132 454500                    STP4    @ERROR+4,,AUTO
        12 003217   000163 236000 13                 LDQ     115
        12 003220   200131 756100                    STQ     @ERROR+3,,AUTO
        12 003221   100003 635500                    EPPR5   3,,PR1
        12 003222   200130 455500                    STP5    @ERROR+2,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:220  
        12 003223   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003224   000022 631400 xsym               EPPR1   B_VECTNIL+18
        12 003225   000000 701000 xent               TSX1    VPD$PROCESS_DATE
        12 003226   003230 702000 12                 TSX2    s:10261
        12 003227   003236 710000 12                 TRA     s:10266

     1495    10259    4                DATE_TYPE,SAV_TSTAMP#,J)
     1496    10260    5               WHENALTRETURN DO;

     1497    10261    5                  CALL BAD_OPT(3,90);      /* Bad date value or format           */

  10261 12 003230   000165 236000 13                 LDQ     117
        12 003231   200126 756100                    STQ     @ERROR,,AUTO
        12 003232   000005 236000 13                 LDQ     5
        12 003233   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003234   001561 701000 12                 TSX1    BAD_OPT
        12 003235   000000 011000                    NOP     0

     1498    10262        /*E* ERROR:   VPC-00090
     1499    10263             MESSAGE: Bad EXPIRATION date.
     1500    10264        */
     1501    10265    5                  END;                     /* end ALTRETURN                      */

     1502    10266    5              DO CASE(DATE_TYPE);

  10266 12 003236   000064 235000 10                 LDA     DATE_TYPE
        12 003237   000007 115007                    CMPA    7,DL
        12 003240   003242 602005 12                 TNC     s:10266+4,AL
        12 003241   003371 710000 12                 TRA     EXPIRE_FINIS
        12 003242   003371 710000 12                 TRA     EXPIRE_FINIS
        12 003243   003251 710000 12                 TRA     s:10268
        12 003244   003251 710000 12                 TRA     s:10268
        12 003245   003354 710000 12                 TRA     s:10297
        12 003246   003251 710000 12                 TRA     s:10268
        12 003247   003251 710000 12                 TRA     s:10268
        12 003250   003251 710000 12                 TRA     s:10268

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:221  
     1503    10267    5               CASE(1,2,4,5,6);            /* Expiration date specified          */

     1504    10268    5                 IF NOT (CMD_MASK & '00004'O) /* IF COPY,LIST,...                */

  10268 12 003251   000100 100400                    MLR     fill='000'O
        12 003252   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 003253   200130 000010                    ADSC9   @ERROR+2,,AUTO           cn=0,n=8
        12 003254   200130 237100                    LDAQ    @ERROR+2,,AUTO
        12 003255   000166 377000 13                 ANAQ    118
        12 003256   003262 601000 12                 TNZ     s:10273

     1505    10269    5                  THEN                     /* Creation time is NOW!              */
     1506    10270    5                    CREATE_TSTAMP# = NOW_UTS;

  10270 12 003257   000000 235000 xsym               LDA     NOW_UTS
        12 003260   200075 755100                    STA     CREATE_TSTAMP#,,AUTO
        12 003261   003307 710000 12                 TRA     s:10289

     1507    10271    5                  ELSE                     /* (MODify)                           */
     1508    10272    6                  DO;

     1509    10273    6                     PTR$ = ADDR(FPARAM_BUF);

  10273 12 003262   000126 236000 13                 LDQ     86
        12 003263   200007 756100                    STQ     PTR$,,AUTO

     1510    10274    6                     CALL XSF$LOCCODP(PTR$,4)

  10274 12 003264   000170 236000 13                 LDQ     120
        12 003265   200131 756100                    STQ     @ERROR+3,,AUTO
        12 003266   200007 630500                    EPPR0   PTR$,,AUTO
        12 003267   200130 450500                    STP0    @ERROR+2,,AUTO
        12 003270   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003271   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 003272   000000 701000 xent               TSX1    XSF$LOCCODP
        12 003273   003275 702000 12                 TSX2    s:10276
        12 003274   003304 710000 12                 TRA     s:10282
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:222  

     1511    10275    7                      WHENALTRETURN DO;

     1512    10276    7                         CALL BAD_OPT(3,28); /* No DATES block exists            */

  10276 12 003275   000172 236000 13                 LDQ     122
        12 003276   200126 756100                    STQ     @ERROR,,AUTO
        12 003277   000005 236000 13                 LDQ     5
        12 003300   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003301   001561 701000 12                 TSX1    BAD_OPT
        12 003302   000000 011000                    NOP     0

     1513    10277    7                         GOTO EXPIRE_FINIS;

  10277 12 003303   003371 710000 12                 TRA     EXPIRE_FINIS

     1514    10278        /*E* ERROR:   VPC-00028
     1515    10279             MESSAGE: You can't set expiration date for a STAR-file.
     1516    10280        */
     1517    10281    7                         END;              /* end  ALTRETURN                     */
     1518    10282    6                     CREATE_TSTAMP# = PTR$ -> CODE04.CREATION.TIME;

  10282 12 003304   200007 470500                    LDP0    PTR$,,AUTO
        12 003305   000002 235100                    LDA     2,,PR0
        12 003306   200075 755100                    STA     CREATE_TSTAMP#,,AUTO

     1519    10283    6                     END;

     1520    10284                       /* The following line gets an expiration interval in days.     */
     1521    10285                       /* Note that the order of operations will truncate creation    */
     1522    10286                       /* time before subtracting it from expiration date.  This in-  */
     1523    10287                       /* sures that file will last for (at least) a fraction of the  */
     1524    10288                                                /* expiration day.                    */
     1525    10289    5                 CALL XUD$UTS_DIFF_25TH (SAV_25TH_TSTAMP#, SAV_TSTAMP#, 0);

  10289 12 003307   000025 236000 13                 LDQ     21
        12 003310   200132 756100                    STQ     @ERROR+4,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:223  
        12 003311   200074 630500                    EPPR0   SAV_TSTAMP#,,AUTO
        12 003312   200131 450500                    STP0    @ERROR+3,,AUTO
        12 003313   200076 631500                    EPPR1   SAV_25TH_TSTAMP#,,AUTO
        12 003314   200130 451500                    STP1    @ERROR+2,,AUTO
        12 003315   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003316   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003317   000000 701000 xent               TSX1    XUD$UTS_DIFF_25TH
        12 003320   000000 011000                    NOP     0

     1526    10290    5                 CALL XUD$UTS_DIFF_25TH (CREATE_25TH_TSTAMP#, CREATE_TSTAMP#, 0);

  10290 12 003321   000025 236000 13                 LDQ     21
        12 003322   200132 756100                    STQ     @ERROR+4,,AUTO
        12 003323   200075 630500                    EPPR0   CREATE_TSTAMP#,,AUTO
        12 003324   200131 450500                    STP0    @ERROR+3,,AUTO
        12 003325   200077 631500                    EPPR1   CREATE_25TH_TSTAMP#,,AUTO
        12 003326   200130 451500                    STP1    @ERROR+2,,AUTO
        12 003327   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003330   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003331   000000 701000 xent               TSX1    XUD$UTS_DIFF_25TH
        12 003332   000000 011000                    NOP     0

     1527    10291    5                OCB.EXPIRE = (SAV_25TH_TSTAMP#/%UTS_25TH_DAY#) - (CREATE_25TH_TSTAMP#/
             10291                          %UTS_25TH_DAY#);

  10291 12 003333   200076 236100                    LDQ     SAV_25TH_TSTAMP#,,AUTO
        12 003334   000173 506000 13                 DIV     123
        12 003335   200130 756100                    STQ     @ERROR+2,,AUTO
        12 003336   200077 236100                    LDQ     CREATE_25TH_TSTAMP#,,AUTO
        12 003337   000173 506000 13                 DIV     123
        12 003340   200131 756100                    STQ     @ERROR+3,,AUTO
        12 003341   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 003342   200131 136100                    SBLQ    @ERROR+3,,AUTO
        12 003343   000226 756000 xsym               STQ     OCB+150

     1528    10292
     1529    10293    5                 IF OCB.EXPIRE < 1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:224  

  10293 12 003344   003371 605400 12                 TPNZ    EXPIRE_FINIS

     1530    10294    5                  THEN                     /* Error, negative elapsed time       */
     1531    10295    5   NEG_EXP:         CALL BAD_OPT(3,90);    /* Expire before it's created!        */

  10295 12 003345   000165 236000 13    NEG_EXP      LDQ     117
        12 003346   200126 756100                    STQ     @ERROR,,AUTO
        12 003347   000005 236000 13                 LDQ     5
        12 003350   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003351   001561 701000 12                 TSX1    BAD_OPT
        12 003352   000000 011000                    NOP     0
        12 003353   003371 710000 12                 TRA     EXPIRE_FINIS

     1532    10296    5               CASE(3);                    /* Expire NEVER                       */

     1533    10297    5                 IF ASN#=%FILE#

  10297 12 003354   000060 236000 10                 LDQ     ASN#
        12 003355   777000 376003                    ANQ     -512,DU
        12 003356   001000 116003                    CMPQ    512,DU
        12 003357   003363 601000 12                 TNZ     s:10301

     1534    10298    5                  THEN
     1535    10299    5                    OCB.EXPIRE = %NEVER#;

  10299 12 003360   000001 335007                    LCA     1,DL
        12 003361   000226 755000 xsym               STA     OCB+150
        12 003362   003371 710000 12                 TRA     EXPIRE_FINIS

     1536    10300    5                  ELSE
     1537    10301    5                    CALL BAD_OPT(3,27);    /* NEVER not allowed for TAPE         */

  10301 12 003363   000175 236000 13                 LDQ     125
        12 003364   200126 756100                    STQ     @ERROR,,AUTO
        12 003365   000005 236000 13                 LDQ     5
        12 003366   200125 756100                    STQ     @SEVERITY,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:225  
        12 003367   001561 701000 12                 TSX1    BAD_OPT
        12 003370   000000 011000                    NOP     0

     1538    10302        /*E* ERROR:   VPC-00027
     1539    10303             MESSAGE: NEVER not allowed for tape
     1540    10304        */
     1541    10305    5               END;                        /* END CASE                           */

  10301 12 003371                       EXPIRE_FINIS null
     1542    10306    4   EXPIRE_FINIS: ;
     1543    10307    4              FPT_OPEN_OUT.V.EXPIRE# = OCB.EXPIRE;

  10307 12 003371   000226 235000 xsym               LDA     OCB+150
        12 003372   000057 755000 xsym               STA     FPT_OPEN_OUT+47
        12 003373   005164 710000 12                 TRA     s:10773

     1544    10308    4            CASE(14);                      /* EXTEND                             */

     1545    10309    4              FPT_OPEN_OUT.V.XTEND# = %YES#;

  10309 12 003374   000060 236000 xsym               LDQ     FPT_OPEN_OUT+48
        12 003375   000176 376000 13                 ANQ     126
        12 003376   020000 276003                    ORQ     8192,DU
        12 003377   000060 756000 xsym               STQ     FPT_OPEN_OUT+48
        12 003400   005164 710000 12                 TRA     s:10773

     1546    10310    4            CASE(15);                      /* VOLACCESS                          */

     1547    10311    5              DO CASE(OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);

  10311 12 003401   100003 473500                    LDP3    3,,PR1
        12 003402   300000 722100                    LXL2    0,,PR3
        12 003403   000004 102003                    CMPX2   4,DU
        12 003404   003406 602012 12                 TNC     s:10311+5,X2
        12 003405   005164 710000 12                 TRA     s:10773
        12 003406   003430 710000 12                 TRA     s:10318
        12 003407   003412 710000 12                 TRA     s:10313
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:226  
        12 003410   003417 710000 12                 TRA     s:10315
        12 003411   003424 710000 12                 TRA     s:10317

     1548    10312    5               CASE(1);

     1549    10313    5                 FPT_OPEN_OUT.V.VOLACCESS# = %ALL#;

  10313 12 003412   000063 236000 xsym               LDQ     FPT_OPEN_OUT+51
        12 003413   000177 376000 13                 ANQ     127
        12 003414   000001 276003                    ORQ     1,DU
        12 003415   000063 756000 xsym               STQ     FPT_OPEN_OUT+51
        12 003416   005164 710000 12                 TRA     s:10773

     1550    10314    5               CASE(2);

     1551    10315    5                 FPT_OPEN_OUT.V.VOLACCESS# = %NONE#;

  10315 12 003417   000063 236000 xsym               LDQ     FPT_OPEN_OUT+51
        12 003420   000177 376000 13                 ANQ     127
        12 003421   000003 276003                    ORQ     3,DU
        12 003422   000063 756000 xsym               STQ     FPT_OPEN_OUT+51
        12 003423   005164 710000 12                 TRA     s:10773

     1552    10316    5               CASE(3);

     1553    10317    5                 FPT_OPEN_OUT.V.VOLACCESS# = %IN#;

  10317 12 003424   000063 236000 xsym               LDQ     FPT_OPEN_OUT+51
        12 003425   000177 376000 13                 ANQ     127
        12 003426   000002 276003                    ORQ     2,DU
        12 003427   000063 756000 xsym               STQ     FPT_OPEN_OUT+51

     1554    10318    5               END;                        /* end case                           */

  10318 12 003430   005164 710000 12                 TRA     s:10773

     1555    10319    4            CASE(16);                      /* KEYLENGTH                          */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:227  

     1556    10320    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10320 12 003431   100003 473500                    LDP3    3,,PR1
        12 003432   000201 236000 13                 LDQ     129
        12 003433   200132 756100                    STQ     @ERROR+4,,AUTO
        12 003434   300003 631500                    EPPR1   3,,PR3
        12 003435   200131 451500                    STP1    @ERROR+3,,AUTO
        12 003436   200072 633500                    EPPR3   TWORD,,AUTO
        12 003437   200130 453500                    STP3    @ERROR+2,,AUTO
        12 003440   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003441   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003442   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 003443   003450 702000 12                 TSX2    BAD_KEYL

     1557    10321    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1558    10322    4                255) ALTRET(BAD_KEYL);
     1559    10323    4              FPT_OPEN_OUT.V.KEYL# = TWORD;

  10323 12 003444   200072 236100                    LDQ     TWORD,,AUTO
        12 003445   000011 736000                    QLS     9
        12 003446   000051 552010 xsym               STBQ    FPT_OPEN_OUT+41,'10'O

     1560    10324    4              GOTO GOOD_KEYL;

  10324 12 003447   003456 710000 12                 TRA     GOOD_KEYL

     1561    10325    4   BAD_KEYL:  CALL BAD_OPT(3,69);          /* KEYL TOO LONG                      */

  10325 12 003450   000203 236000 13    BAD_KEYL     LDQ     131
        12 003451   200126 756100                    STQ     @ERROR,,AUTO
        12 003452   000005 236000 13                 LDQ     5
        12 003453   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003454   001561 701000 12                 TSX1    BAD_OPT
        12 003455   000000 011000                    NOP     0

  10323 12 003456   005164 710000 12    GOOD_KEYL    TRA     s:10773
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:228  

     1562    10326        /*E* ERROR:   VPC-00069
     1563    10327             MESSAGE: KEYL too long
     1564    10328        */
     1565    10329    4   GOOD_KEYL: ;
     1566    10330    4            CASE(17);                      /* KEYX                               */

     1567    10331    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10331 12 003457   100003 473500                    LDP3    3,,PR1
        12 003460   000205 236000 13                 LDQ     133
        12 003461   200132 756100                    STQ     @ERROR+4,,AUTO
        12 003462   300003 631500                    EPPR1   3,,PR3
        12 003463   200131 451500                    STP1    @ERROR+3,,AUTO
        12 003464   200072 633500                    EPPR3   TWORD,,AUTO
        12 003465   200130 453500                    STP3    @ERROR+2,,AUTO
        12 003466   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003467   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003470   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 003471   003475 702000 12                 TSX2    BAD_KEYX

     1568    10332    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1569    10333    4                32768) ALTRET(BAD_KEYX);
     1570    10334    4              FPT_OPEN_OUT.V.KEYX# = TWORD;

  10334 12 003472   200072 720100                    LXL0    TWORD,,AUTO
        12 003473   000051 740000 xsym               STX0    FPT_OPEN_OUT+41

     1571    10335    4              GOTO GOOD_KEYX;

  10335 12 003474   003503 710000 12                 TRA     GOOD_KEYX

     1572    10336    4   BAD_KEYX:  CALL BAD_OPT(3,70);          /* KEYX TOO LARGE                     */

  10336 12 003475   000207 236000 13    BAD_KEYX     LDQ     135
        12 003476   200126 756100                    STQ     @ERROR,,AUTO
        12 003477   000005 236000 13                 LDQ     5
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:229  
        12 003500   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003501   001561 701000 12                 TSX1    BAD_OPT
        12 003502   000000 011000                    NOP     0

  10334 12 003503   005164 710000 12    GOOD_KEYX    TRA     s:10773

     1573    10337        /*E* ERROR:   VPC-00070
     1574    10338             MESSAGE: KEYX too large
     1575    10339        */
     1576    10340    4   GOOD_KEYX: ;
     1577    10341    4            CASE(18);                      /* KEYS                               */

     1578    10342    4              OCB.KEYS = 1;

  10342 12 003504   000001 235007                    LDA     1,DL
        12 003505   000026 755000 xsym               STA     OCB+22

     1579    10343    5              DO I = 0 TO OPTION$->OUT$BLK.NSUBLKS-1;

  10343 12 003506   200026 450100                    STZ     I,,AUTO
        12 003507   003600 710000 12                 TRA     s:10370+1

     1580    10344    6                 DO CASE(OPTION$->OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);

  10344 12 003510   200063 470500                    LDP0    @OPTION$,,AUTO
        12 003511   000000 471500                    LDP1    0,,PR0
        12 003512   200026 720100                    LXL0    I,,AUTO
        12 003513   100003 473510                    LDP3    3,X0,PR1
        12 003514   300000 721100                    LXL1    0,,PR3
        12 003515   000014 101003                    CMPX1   12,DU
        12 003516   003520 602011 12                 TNC     s:10344+8,X1
        12 003517   003577 710000 12                 TRA     s:10370
        12 003520   003534 710000 12                 TRA     s:10346
        12 003521   003537 710000 12                 TRA     s:10348
        12 003522   003542 710000 12                 TRA     s:10350
        12 003523   003545 710000 12                 TRA     s:10352
        12 003524   003550 710000 12                 TRA     s:10354
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:230  
        12 003525   003553 710000 12                 TRA     s:10356
        12 003526   003556 710000 12                 TRA     s:10358
        12 003527   003561 710000 12                 TRA     s:10360
        12 003530   003564 710000 12                 TRA     s:10362
        12 003531   003567 710000 12                 TRA     s:10364
        12 003532   003572 710000 12                 TRA     s:10366
        12 003533   003575 710000 12                 TRA     s:10368

     1581    10345    6                  CASE(0);                 /* X                                  */

     1582    10346    6                    OCB.KEY.FORMAT.X = %YES#;

  10346 12 003534   400000 236003                    LDQ     -131072,DU
        12 003535   000265 256000 xsym               ORSQ    OCB+181
        12 003536   003577 710000 12                 TRA     s:10370

     1583    10347    6                  CASE(1);                 /* X1                                 */

     1584    10348    6                    OCB.KEY.FORMAT.X1 = %YES#;

  10348 12 003537   200000 236003                    LDQ     65536,DU
        12 003540   000265 256000 xsym               ORSQ    OCB+181
        12 003541   003577 710000 12                 TRA     s:10370

     1585    10349    6                  CASE(2);                 /* OCT                                */

     1586    10350    6                    OCB.KEY.FORMAT.O = %YES#;

  10350 12 003542   100000 236003                    LDQ     32768,DU
        12 003543   000265 256000 xsym               ORSQ    OCB+181
        12 003544   003577 710000 12                 TRA     s:10370

     1587    10351    6                  CASE(3);                 /* CHAR                               */

     1588    10352    6                    OCB.KEY.FORMAT.C = %YES#;

  10352 12 003545   040000 236003                    LDQ     16384,DU
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:231  
        12 003546   000265 256000 xsym               ORSQ    OCB+181
        12 003547   003577 710000 12                 TRA     s:10370

     1589    10353    6                  CASE(4);                 /* SEQ                                */

     1590    10354    6                    OCB.KEY.FORMAT.S = %YES#;

  10354 12 003550   020000 236003                    LDQ     8192,DU
        12 003551   000265 256000 xsym               ORSQ    OCB+181
        12 003552   003577 710000 12                 TRA     s:10370

     1591    10355    6                  CASE(5);                 /* EDIT                               */

     1592    10356    6                    OCB.KEY.FORMAT.E = %YES#;

  10356 12 003553   010000 236003                    LDQ     4096,DU
        12 003554   000265 256000 xsym               ORSQ    OCB+181
        12 003555   003577 710000 12                 TRA     s:10370

     1593    10357    6                  CASE(6);                 /* NDVBYTE                            */

     1594    10358    6                    OCB.KEY.DVBYTE = 1;    /* NO                                 */

  10358 12 003556   000001 235007                    LDA     1,DL
        12 003557   000266 755000 xsym               STA     OCB+182
        12 003560   003577 710000 12                 TRA     s:10370

     1595    10359    6                  CASE(7);                 /* DVBYTE                             */

     1596    10360    6                    OCB.KEY.DVBYTE = 2;    /* YES                                */

  10360 12 003561   000002 235007                    LDA     2,DL
        12 003562   000266 755000 xsym               STA     OCB+182
        12 003563   003577 710000 12                 TRA     s:10370

     1597    10361    6                  CASE(8);                 /* NRECSIZE                           */

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:232  
     1598    10362    6                    OCB.KEY.RECSIZ = 1;    /* NO                                 */

  10362 12 003564   000001 235007                    LDA     1,DL
        12 003565   000267 755000 xsym               STA     OCB+183
        12 003566   003577 710000 12                 TRA     s:10370

     1599    10363    6                  CASE(9);                 /* RECSIZE                            */

     1600    10364    6                    OCB.KEY.RECSIZ = 2;    /* YES                                */

  10364 12 003567   000002 235007                    LDA     2,DL
        12 003570   000267 755000 xsym               STA     OCB+183
        12 003571   003577 710000 12                 TRA     s:10370

     1601    10365    6                  CASE(10);                /* NONDATA                            */

     1602    10366    6                    OCB.KEY.ONDATA = 1;    /* NO                                 */

  10366 12 003572   000001 235007                    LDA     1,DL
        12 003573   000270 755000 xsym               STA     OCB+184
        12 003574   003577 710000 12                 TRA     s:10370

     1603    10367    6                  CASE(11);                /* ONDATA                             */

     1604    10368    6                    OCB.KEY.ONDATA = 2;    /* YES                                */

  10368 12 003575   000002 235007                    LDA     2,DL
        12 003576   000270 755000 xsym               STA     OCB+184

     1605    10369    6                  END;                     /* END CASE                           */

     1606    10370    5                 END;                      /* END INDEX                          */

  10370 12 003577   200026 054100                    AOS     I,,AUTO
        12 003600   000000 471500                    LDP1    0,,PR0
        12 003601   100001 236100                    LDQ     1,,PR1
        12 003602   000022 772000                    QRL     18
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:233  
        12 003603   200026 116100                    CMPQ    I,,AUTO
        12 003604   003510 605400 12                 TPNZ    s:10344
        12 003605   005164 710000 12                 TRA     s:10773

     1607    10371    4            CASE(19);                      /* LC                                 */

     1608    10372    4              OCB.UC_LC = 1;

  10372 12 003606   000001 235007                    LDA     1,DL
        12 003607   000027 755000 xsym               STA     OCB+23
        12 003610   005164 710000 12                 TRA     s:10773

     1609    10373    4            CASE(20);                      /* LN                                 */

     1610    10374    4              OCB.ORG = 4;

  10374 12 003611   000004 235007                    LDA     4,DL
        12 003612   000035 755000 xsym               STA     OCB+29

     1611    10375    4              OCB.LN.KEY.LEN = 3;

  10375 12 003613   003000 236003                    LDQ     1536,DU
        12 003614   000030 552040 xsym               STBQ    OCB+24,'40'O

     1612    10376    4              OCB.LN.N = 1000;

  10376 12 003615   001750 235007                    LDA     1000,DL
        12 003616   000032 755000 xsym               STA     OCB+26

     1613    10377    4              OCB.LN.K = 1000;

  10377 12 003617   000033 755000 xsym               STA     OCB+27

     1614    10378    4              J=0;

  10378 12 003620   200067 450100                    STZ     J,,AUTO

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:234  
     1615    10379    5              DO WHILE(J<OPTION$->OUT$BLK.NSUBLKS);

  10379 12 003621   000000 471500                    LDP1    0,,PR0
        12 003622   100001 236100                    LDQ     1,,PR1
        12 003623   000022 772000                    QRL     18
        12 003624   200067 116100                    CMPQ    J,,AUTO
        12 003625   003670 604400 12                 TMOZ    s:10397

     1616    10380    5                 NUM = 0;

  10380 12 003626   200100 450100                    STZ     NUM,,AUTO

     1617    10381    5                 K=0;

  10381 12 003627   200070 450100                    STZ     K,,AUTO

     1618    10382    5                 IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.NSUBLKS > 0

  10382 12 003630   200063 470500                    LDP0    @OPTION$,,AUTO
        12 003631   000000 471500                    LDP1    0,,PR0
        12 003632   200067 720100                    LXL0    J,,AUTO
        12 003633   100003 473510                    LDP3    3,X0,PR1
        12 003634   300001 221100                    LDX1    1,,PR3
        12 003635   003661 600000 12                 TZE     s:10395

     1619    10383    5                  THEN
     1620    10384    6                  DO;

     1621    10385    6                     CALL VPD$DECI_MUNGE(

  10385 12 003636   200100 634500                    EPPR4   NUM,,AUTO
        12 003637   200133 454500                    STP4    @ERROR+5,,AUTO
        12 003640   000212 236000 13                 LDQ     138
        12 003641   200132 756100                    STQ     @ERROR+4,,AUTO
        12 003642   000213 236000 13                 LDQ     139
        12 003643   200131 756100                    STQ     @ERROR+3,,AUTO
        12 003644   100003 633510                    EPPR3   3,X0,PR1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:235  
        12 003645   200130 453500                    STP3    @ERROR+2,,AUTO
        12 003646   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003647   000022 631400 xsym               EPPR1   B_VECTNIL+18
        12 003650   000000 701000 xent               TSX1    VPD$DECI_MUNGE
        12 003651   003674 702000 12                 TSX2    BAD_LN

     1622    10386    6                       OPTION$->OUT$BLK.SUBLK$(J),
     1623    10387    6                       -99999999,99999999, /* Limits +-99999.999                 */
     1624    10388    6                       NUM) ALTRET(BAD_LN);
     1625    10389    6                     IF J=0

  10389 12 003652   200067 235100                    LDA     J,,AUTO
        12 003653   003657 601000 12                 TNZ     s:10393

     1626    10390    6                      THEN
     1627    10391    6                        OCB.LN.N=NUM;

  10391 12 003654   200100 236100                    LDQ     NUM,,AUTO
        12 003655   000032 756000 xsym               STQ     OCB+26
        12 003656   003661 710000 12                 TRA     s:10395

     1628    10392    6                      ELSE
     1629    10393    6                        OCB.LN.K=NUM;

  10393 12 003657   200100 236100                    LDQ     NUM,,AUTO
        12 003660   000033 756000 xsym               STQ     OCB+27

     1630    10394    6                     END;

     1631    10395    5                 J=J+1;

  10395 12 003661   200067 054100                    AOS     J,,AUTO

     1632    10396    5                 END;

  10396 12 003662   200063 470500                    LDP0    @OPTION$,,AUTO
        12 003663   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:236  
        12 003664   100001 236100                    LDQ     1,,PR1
        12 003665   000022 772000                    QRL     18
        12 003666   200067 116100                    CMPQ    J,,AUTO
        12 003667   003626 605400 12                 TPNZ    s:10380

     1633    10397    4              OCB.LN.CURRENT = OCB.LN.N - OCB.LN.K;

  10397 12 003670   000032 236000 xsym               LDQ     OCB+26
        12 003671   000033 136000 xsym               SBLQ    OCB+27
        12 003672   000031 756000 xsym               STQ     OCB+25

     1634    10398    4              GOTO GOOD_LN;

  10398 12 003673   003702 710000 12                 TRA     GOOD_LN

     1635    10399    4   BAD_LN:    CALL BAD_OPT(3,31);          /* BAD LN START OR INCREMENT          */

  10399 12 003674   000215 236000 13    BAD_LN       LDQ     141
        12 003675   200126 756100                    STQ     @ERROR,,AUTO
        12 003676   000005 236000 13                 LDQ     5
        12 003677   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003700   001561 701000 12                 TSX1    BAD_OPT
        12 003701   000000 011000                    NOP     0

  10397 12 003702   005164 710000 12    GOOD_LN      TRA     s:10773

     1636    10400        /*E* ERROR:   VPC-00031
     1637    10401             MESSAGE: Bad LN start or increment
     1638    10402        */
     1639    10403    4   GOOD_LN:   ;
     1640    10404    4            CASE(21);                      /* LRDL0                              */

     1641    10405    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10405 12 003703   100003 473500                    LDP3    3,,PR1
        12 003704   000217 236000 13                 LDQ     143
        12 003705   200132 756100                    STQ     @ERROR+4,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:237  
        12 003706   300003 631500                    EPPR1   3,,PR3
        12 003707   200131 451500                    STP1    @ERROR+3,,AUTO
        12 003710   200072 633500                    EPPR3   TWORD,,AUTO
        12 003711   200130 453500                    STP3    @ERROR+2,,AUTO
        12 003712   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003713   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003714   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 003715   003723 702000 12                 TSX2    BAD_LRDL0

     1642    10406    4                OPTION$->OUT$BLK.SUBLK$(0)->
     1643    10407    4                OUT$SYM.TEXTC$,
     1644    10408    4                511) ALTRET(BAD_LRDL0);
     1645    10409    4              FPT_OPEN_OUT.V.LRDL0# = TWORD;

  10409 12 003716   200072 720100                    LXL0    TWORD,,AUTO
        12 003717   000053 440000 xsym               SXL0    FPT_OPEN_OUT+43

     1646    10410    4              OCB.LRDL0 = TWORD;

  10410 12 003720   200072 235100                    LDA     TWORD,,AUTO
        12 003721   000222 755000 xsym               STA     OCB+146

     1647    10411    4              GOTO GOOD_LRDL0;

  10411 12 003722   003731 710000 12                 TRA     GOOD_LRDL0

     1648    10412    4   BAD_LRDL0: CALL BAD_OPT(3,81);

  10412 12 003723   000221 236000 13    BAD_LRDL0    LDQ     145
        12 003724   200126 756100                    STQ     @ERROR,,AUTO
        12 003725   000005 236000 13                 LDQ     5
        12 003726   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003727   001561 701000 12                 TSX1    BAD_OPT
        12 003730   000000 011000                    NOP     0

  10410 12 003731   005164 710000 12    GOOD_LRDL0   TRA     s:10773

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:238  
     1649    10413        /*E* ERROR:   VPC-00081
     1650    10414             MESSAGE: LRDL0 > 511
     1651    10415        */
     1652    10416    4   GOOD_LRDL0: ;
     1653    10417    4            CASE(22);                      /* LSLIDE                             */

     1654    10418    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10418 12 003732   100003 473500                    LDP3    3,,PR1
        12 003733   000217 236000 13                 LDQ     143
        12 003734   200132 756100                    STQ     @ERROR+4,,AUTO
        12 003735   300003 631500                    EPPR1   3,,PR3
        12 003736   200131 451500                    STP1    @ERROR+3,,AUTO
        12 003737   200072 633500                    EPPR3   TWORD,,AUTO
        12 003740   200130 453500                    STP3    @ERROR+2,,AUTO
        12 003741   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003742   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003743   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 003744   003752 702000 12                 TSX2    BAD_LSLIDE

     1655    10419    4                OPTION$->OUT$BLK.SUBLK$(0)->
     1656    10420    4                OUT$SYM.TEXTC$,
     1657    10421    4                511) ALTRET(BAD_LSLIDE);
     1658    10422    4              FPT_OPEN_OUT.V.LSLIDE# = TWORD;

  10422 12 003745   200072 720100                    LXL0    TWORD,,AUTO
        12 003746   000053 740000 xsym               STX0    FPT_OPEN_OUT+43

     1659    10423    4              OCB.LSLIDE = TWORD;

  10423 12 003747   200072 235100                    LDA     TWORD,,AUTO
        12 003750   000223 755000 xsym               STA     OCB+147

     1660    10424    4              GOTO GOOD_LSLIDE;

  10424 12 003751   003760 710000 12                 TRA     GOOD_LSLIDE

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:239  
     1661    10425    4   BAD_LSLIDE: CALL BAD_OPT(3,82);

  10425 12 003752   000223 236000 13    BAD_LSLIDE   LDQ     147
        12 003753   200126 756100                    STQ     @ERROR,,AUTO
        12 003754   000005 236000 13                 LDQ     5
        12 003755   200125 756100                    STQ     @SEVERITY,,AUTO
        12 003756   001561 701000 12                 TSX1    BAD_OPT
        12 003757   000000 011000                    NOP     0

  10423 12 003760   005164 710000 12    GOOD_LSLIDE  TRA     s:10773

     1662    10426        /*E* ERROR:   VPC-00082
     1663    10427             MESSAGE: LSLIDE > 511
     1664    10428        */
     1665    10429    4   GOOD_LSLIDE: ;
     1666    10430    4            CASE(23);                      /* MAXVOL                             */

     1667    10431    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10431 12 003761   100003 473500                    LDP3    3,,PR1
        12 003762   000217 236000 13                 LDQ     143
        12 003763   200132 756100                    STQ     @ERROR+4,,AUTO
        12 003764   300003 631500                    EPPR1   3,,PR3
        12 003765   200131 451500                    STP1    @ERROR+3,,AUTO
        12 003766   200072 633500                    EPPR3   TWORD,,AUTO
        12 003767   200130 453500                    STP3    @ERROR+2,,AUTO
        12 003770   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 003771   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 003772   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 003773   004000 702000 12                 TSX2    BAD_MAXVOL

     1668    10432    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1669    10433    4                511) ALTRET(BAD_MAXVOL);
     1670    10434    4              FPT_OPEN_OUT.V.MAXVOL# = TWORD;

  10434 12 003774   200072 236100                    LDQ     TWORD,,AUTO
        12 003775   000022 736000                    QLS     18
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:240  
        12 003776   000061 552020 xsym               STBQ    FPT_OPEN_OUT+49,'20'O

     1671    10435    4              GOTO GOOD_MAXVOL;

  10435 12 003777   004006 710000 12                 TRA     GOOD_MAXVOL

     1672    10436    4   BAD_MAXVOL: CALL BAD_OPT(3,71);         /* MAXVOL TOO LARGE                   */

  10436 12 004000   000225 236000 13    BAD_MAXVOL   LDQ     149
        12 004001   200126 756100                    STQ     @ERROR,,AUTO
        12 004002   000005 236000 13                 LDQ     5
        12 004003   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004004   001561 701000 12                 TSX1    BAD_OPT
        12 004005   000000 011000                    NOP     0

  10434 12 004006   005164 710000 12    GOOD_MAXVOL  TRA     s:10773

     1673    10437        /*E* ERROR:   VPC-00071
     1674    10438             MESSAGE: MAXVOL too large
     1675    10439        */
     1676    10440    4   GOOD_MAXVOL: ;
     1677    10441    4            CASE(24);                      /* AMR                                */

     1678    10442    4              FPT_OPEN_OUT.V.INITZ.REASSIGN# = %YES#;

  10442 12 004007   200000 236007                    LDQ     65536,DL
        12 004010   000044 256000 xsym               ORSQ    FPT_OPEN_OUT+36
        12 004011   005164 710000 12                 TRA     s:10773

     1679    10443    4            CASE(25);                      /* NB                                 */

     1680    10444    4              OCB.NB = 1;

  10444 12 004012   000001 235007                    LDA     1,DL
        12 004013   000034 755000 xsym               STA     OCB+28
        12 004014   005164 710000 12                 TRA     s:10773

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:241  
     1681    10445    4            CASE(26);                      /* NCR                                */

     1682    10446    4              OCB.CR_NCR = 2;

  10446 12 004015   000002 235007                    LDA     2,DL
        12 004016   000015 755000 xsym               STA     OCB+13
        12 004017   005164 710000 12                 TRA     s:10773

     1683    10447    4            CASE(27);                      /* NCS                                */

     1684    10448    4              OCB.CS.SPEC = 2;

  10448 12 004020   000002 235007                    LDA     2,DL
        12 004021   000007 755000 xsym               STA     OCB+7

     1685    10449    4              OCB.CS.ID.L = 8;

  10449 12 004022   010000 236003                    LDQ     4096,DU
        12 004023   000010 552040 xsym               STBQ    OCB+8,'40'O

     1686    10450    4              OCB.CS.ID.C = ' ';

  10450 12 004024   040000 100400                    MLR     fill='040'O
        12 004025   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 004026   000010 200004 xsym               ADSC9   OCB+8                    cn=1,n=4
        12 004027   005164 710000 12                 TRA     s:10773

     1687    10451    4            CASE(28);                      /* NFA                                */

     1688    10452    4              OCB.NFA = %YES#;

  10452 12 004030   400000 236003                    LDQ     -131072,DU
        12 004031   000025 756000 xsym               STQ     OCB+21
        12 004032   005164 710000 12                 TRA     s:10773

     1689    10453    4            CASE(29);                      /* NLN                                */

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:242  
     1690    10454    4              OCB.ORG = 1;                 /* CONSECUTIVE                        */

  10454 12 004033   000001 235007                    LDA     1,DL
        12 004034   000035 755000 xsym               STA     OCB+29
        12 004035   005164 710000 12                 TRA     s:10773

     1691    10455    4            CASE(30);                      /* ORGANIZATION                       */

     1692    10456    4              ORG_CODE = OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  10456 12 004036   100003 473500                    LDP3    3,,PR1
        12 004037   300000 236100                    LDQ     0,,PR3
        12 004040   777777 376007                    ANQ     -1,DL
        12 004041   200033 756100                    STQ     ORG_CODE,,AUTO

     1693    10457    4              OCB.ORG = ORG_CODE;

  10457 12 004042   000035 756000 xsym               STQ     OCB+29

     1694    10458    4              IF ORG_CODE = 4              /* KEYED                              */

  10458 12 004043   000004 116007                    CMPQ    4,DL
        12 004044   005164 601000 12                 TNZ     s:10773

     1695    10459    4               THEN
     1696    10460    5               DO;

     1697    10461    5                  OCB.LN.N = 1000;

  10461 12 004045   001750 235007                    LDA     1000,DL
        12 004046   000032 755000 xsym               STA     OCB+26

     1698    10462    5                  OCB.LN.K = 1000;

  10462 12 004047   000033 755000 xsym               STA     OCB+27

     1699    10463    5                  OCB.LN.CURRENT = 0;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:243  

  10463 12 004050   000031 450000 xsym               STZ     OCB+25

     1700    10464    5                  OCB.LN.KEY.LEN = 3;

  10464 12 004051   003000 236003                    LDQ     1536,DU
        12 004052   000030 552040 xsym               STBQ    OCB+24,'40'O

     1701    10465    5                  END;

  10465 12 004053   005164 710000 12                 TRA     s:10773

     1702    10466    4            CASE(31,46,54);                /* OCTAL AND HEX DUMPS                */

     1703    10467    5              DO SELECT(OPTION$->OUT$BLK.CODE);

  10467 12 004054   100000 236100                    LDQ     0,,PR1
        12 004055   777777 376007                    ANQ     -1,DL
        12 004056   000056 116007                    CMPQ    46,DL
        12 004057   004064 602000 12                 TNC     s:10467+8
        12 004060   004072 600000 12                 TZE     s:10471
        12 004061   000066 100003                    CMPX0   54,DU
        12 004062   004077 601000 12                 TNZ     s:10475
        12 004063   004075 710000 12                 TRA     s:10473
        12 004064   000037 100003                    CMPX0   31,DU
        12 004065   004077 601000 12                 TNZ     s:10475
        12 004066   004067 710000 12                 TRA     s:10469

     1704    10468    5                 SELECT(31);               /* OCTAL                              */

     1705    10469    5                 OCB.OCT_HEX.TYPE = 1;

  10469 12 004067   000001 235007                    LDA     1,DL
        12 004070   000036 755000 xsym               STA     OCB+30
        12 004071   004077 710000 12                 TRA     s:10475

     1706    10470    5                 SELECT(46);               /* X                                  */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:244  

     1707    10471    5                 OCB.OCT_HEX.TYPE = 2;

  10471 12 004072   000002 235007                    LDA     2,DL
        12 004073   000036 755000 xsym               STA     OCB+30
        12 004074   004077 710000 12                 TRA     s:10475

     1708    10472    5                 SELECT(54);               /* X1 DUMP                            */

     1709    10473    5                 OCB.OCT_HEX.TYPE = 3;

  10473 12 004075   000003 235007                    LDA     3,DL
        12 004076   000036 755000 xsym               STA     OCB+30

     1710    10474    5                 END;                      /* END SELECT                         */

     1711    10475    5              DO J=0 TO OPTION$->OUT$BLK.NSUBLKS-1;

  10475 12 004077   200067 450100                    STZ     J,,AUTO
        12 004100   004132 710000 12                 TRA     s:10486+1

     1712    10476    6                 DO CASE(OPTION$ -> OUT$BLK.SUBLK$(J) -> OUT$BLK.CODE);

  10476 12 004101   200063 470500                    LDP0    @OPTION$,,AUTO
        12 004102   000000 471500                    LDP1    0,,PR0
        12 004103   200067 720100                    LXL0    J,,AUTO
        12 004104   100003 473510                    LDP3    3,X0,PR1
        12 004105   300000 721100                    LXL1    0,,PR3
        12 004106   000005 101003                    CMPX1   5,DU
        12 004107   004111 602011 12                 TNC     s:10476+8,X1
        12 004110   004131 710000 12                 TRA     s:10486
        12 004111   004131 710000 12                 TRA     s:10486
        12 004112   004116 710000 12                 TRA     s:10478
        12 004113   004121 710000 12                 TRA     s:10480
        12 004114   004124 710000 12                 TRA     s:10482
        12 004115   004127 710000 12                 TRA     s:10484

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:245  
     1713    10477    6                  CASE(1);                 /* DUPE                               */

     1714    10478    6                    OCB.OCT_HEX.DUPE = 2;

  10478 12 004116   000002 235007                    LDA     2,DL
        12 004117   000040 755000 xsym               STA     OCB+32
        12 004120   004131 710000 12                 TRA     s:10486

     1715    10479    6                  CASE(2);                 /* NDUPE                              */

     1716    10480    6                    OCB.OCT_HEX.DUPE = 1;

  10480 12 004121   000001 235007                    LDA     1,DL
        12 004122   000040 755000 xsym               STA     OCB+32
        12 004123   004131 710000 12                 TRA     s:10486

     1717    10481    6                  CASE(3);                 /* NTEXT                              */

     1718    10482    6                    OCB.OCT_HEX.TEXT = 1;

  10482 12 004124   000001 235007                    LDA     1,DL
        12 004125   000037 755000 xsym               STA     OCB+31
        12 004126   004131 710000 12                 TRA     s:10486

     1719    10483    6                  CASE(4);                 /* TEXT                               */

     1720    10484    6                    OCB.OCT_HEX.TEXT = 2;

  10484 12 004127   000002 235007                    LDA     2,DL
        12 004130   000037 755000 xsym               STA     OCB+31

     1721    10485    6                  END;

     1722    10486    5                 END;

  10486 12 004131   200067 054100                    AOS     J,,AUTO
        12 004132   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:246  
        12 004133   100001 236100                    LDQ     1,,PR1
        12 004134   000022 772000                    QRL     18
        12 004135   200067 116100                    CMPQ    J,,AUTO
        12 004136   004101 605400 12                 TPNZ    s:10476
        12 004137   005164 710000 12                 TRA     s:10773

     1723    10487    4            CASE(32);                      /* PEXTENT                            */

     1724    10488    4              CALL VPD$TEXTC_CHARBIN(FPT_OPEN_OUT.V.IXTNSIZE#,

  10488 12 004140   100003 473500                    LDP3    3,,PR1
        12 004141   000226 236000 13                 LDQ     150
        12 004142   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004143   300003 631500                    EPPR1   3,,PR3
        12 004144   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004145   000227 236000 13                 LDQ     151
        12 004146   200130 756100                    STQ     @ERROR+2,,AUTO
        12 004147   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 004150   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 004151   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 004152   004154 702000 12                 TSX2    BAD_IXTN

     1725    10489    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1726    10490    4                134217727) ALTRET(BAD_IXTN);
     1727    10491    4              GOTO GOOD_IXTN;

  10491 12 004153   004162 710000 12                 TRA     GOOD_IXTN

     1728    10492    4   BAD_IXTN:  CALL BAD_OPT(3,72);          /* IXTNSIZE TOO LARGE                 */

  10492 12 004154   000231 236000 13    BAD_IXTN     LDQ     153
        12 004155   200126 756100                    STQ     @ERROR,,AUTO
        12 004156   000005 236000 13                 LDQ     5
        12 004157   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004160   001561 701000 12                 TSX1    BAD_OPT
        12 004161   000000 011000                    NOP     0

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:247  
  10490 12 004162   005164 710000 12    GOOD_IXTN    TRA     s:10773

     1729    10493        /*E* ERROR:   VPC-00072
     1730    10494             MESSAGE: IXTNSIZE too large
     1731    10495        */
     1732    10496    4   GOOD_IXTN: ;
     1733    10497    4            CASE(34);                      /* RECLENGTH                          */

     1734    10498    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10498 12 004163   100003 473500                    LDP3    3,,PR1
        12 004164   000233 236000 13                 LDQ     155
        12 004165   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004166   300003 631500                    EPPR1   3,,PR3
        12 004167   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004170   200072 633500                    EPPR3   TWORD,,AUTO
        12 004171   200130 453500                    STP3    @ERROR+2,,AUTO
        12 004172   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 004173   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 004174   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 004175   004201 702000 12                 TSX2    BAD_RECL

     1735    10499    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1736    10500    4                262143) ALTRET(BAD_RECL);
     1737    10501    4              FPT_OPEN_OUT.V.RECL# = TWORD;

  10501 12 004176   200072 720100                    LXL0    TWORD,,AUTO
        12 004177   000052 440000 xsym               SXL0    FPT_OPEN_OUT+42

     1738    10502    4              GOTO GOOD_RECL;

  10502 12 004200   004207 710000 12                 TRA     GOOD_RECL

     1739    10503    4   BAD_RECL:  CALL BAD_OPT(3,74);          /* RECL TOO LARGE                     */

  10503 12 004201   000235 236000 13    BAD_RECL     LDQ     157
        12 004202   200126 756100                    STQ     @ERROR,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:248  
        12 004203   000005 236000 13                 LDQ     5
        12 004204   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004205   001561 701000 12                 TSX1    BAD_OPT
        12 004206   000000 011000                    NOP     0

  10501 12 004207   005164 710000 12    GOOD_RECL    TRA     s:10773

     1740    10504        /*E* ERROR:   VPC-00074
     1741    10505             MESSAGE: RECL too large
     1742    10506        */
     1743    10507    4   GOOD_RECL: ;
     1744    10508    4            CASE(35);                      /* RELEASE                            */

     1745    10509    4              OCB.RELEASE = 1;

  10509 12 004210   001000 236003                    LDQ     512,DU
        12 004211   000043 552040 xsym               STBQ    OCB+35,'40'O
        12 004212   005164 710000 12                 TRA     s:10773

     1746    10510    4            CASE(36);                      /* SEXTENT                            */

     1747    10511    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10511 12 004213   100003 473500                    LDP3    3,,PR1
        12 004214   000237 236000 13                 LDQ     159
        12 004215   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004216   300003 631500                    EPPR1   3,,PR3
        12 004217   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004220   200072 633500                    EPPR3   TWORD,,AUTO
        12 004221   200130 453500                    STP3    @ERROR+2,,AUTO
        12 004222   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 004223   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 004224   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 004225   004233 702000 12                 TSX2    BAD_SXTN

     1748    10512    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1749    10513    4                32000) ALTRET(BAD_SXTN);
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:249  
     1750    10514    4              FPT_OPEN_OUT.V.XTNSIZE# = TWORD;

  10514 12 004226   200072 720100                    LXL0    TWORD,,AUTO
        12 004227   000054 440000 xsym               SXL0    FPT_OPEN_OUT+44

     1751    10515    4              OCB.XTNSIZE = TWORD;

  10515 12 004230   200072 235100                    LDA     TWORD,,AUTO
        12 004231   000225 755000 xsym               STA     OCB+149

     1752    10516    4              GOTO GOOD_SXTN;

  10516 12 004232   004241 710000 12                 TRA     GOOD_SXTN

     1753    10517    4   BAD_SXTN:  CALL BAD_OPT(3,73);          /* SEXTENT TOO LARGE                  */

  10517 12 004233   000241 236000 13    BAD_SXTN     LDQ     161
        12 004234   200126 756100                    STQ     @ERROR,,AUTO
        12 004235   000005 236000 13                 LDQ     5
        12 004236   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004237   001561 701000 12                 TSX1    BAD_OPT
        12 004240   000000 011000                    NOP     0

  10515 12 004241   005164 710000 12    GOOD_SXTN    TRA     s:10773

     1754    10518        /*E* ERROR:   VPC-00073
     1755    10519             MESSAGE: XTNSIZE too large
     1756    10520        */
     1757    10521    4   GOOD_SXTN: ;
     1758    10522    4            CASE(37);                      /* SPARE                              */

     1759    10523    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10523 12 004242   100003 473500                    LDP3    3,,PR1
        12 004243   000217 236000 13                 LDQ     143
        12 004244   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004245   300003 631500                    EPPR1   3,,PR3
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:250  
        12 004246   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004247   200072 633500                    EPPR3   TWORD,,AUTO
        12 004250   200130 453500                    STP3    @ERROR+2,,AUTO
        12 004251   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 004252   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 004253   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 004254   004262 702000 12                 TSX2    BAD_SPARE

     1760    10524    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1761    10525    4                511) ALTRET(BAD_SPARE);
     1762    10526    4              FPT_OPEN_OUT.V.SPARE# = TWORD;

  10526 12 004255   200072 720100                    LXL0    TWORD,,AUTO
        12 004256   000054 740000 xsym               STX0    FPT_OPEN_OUT+44

     1763    10527    4              OCB.SPARE = TWORD;

  10527 12 004257   200072 235100                    LDA     TWORD,,AUTO
        12 004260   000224 755000 xsym               STA     OCB+148

     1764    10528    4              GOTO GOOD_SPARE;

  10528 12 004261   004270 710000 12                 TRA     GOOD_SPARE

     1765    10529    4   BAD_SPARE: CALL BAD_OPT(3,75);          /* SPARE TOO LARGE                    */

  10529 12 004262   000243 236000 13    BAD_SPARE    LDQ     163
        12 004263   200126 756100                    STQ     @ERROR,,AUTO
        12 004264   000005 236000 13                 LDQ     5
        12 004265   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004266   001561 701000 12                 TSX1    BAD_OPT
        12 004267   000000 011000                    NOP     0

  10527 12 004270   005164 710000 12    GOOD_SPARE   TRA     s:10773

     1766    10530        /*E* ERROR:   VPC-00075
     1767    10531             MESSAGE: SPARE too large
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:251  
     1768    10532        */
     1769    10533    4   GOOD_SPARE: ;
     1770    10534    4            CASE(38);                      /* SSP                                */

     1771    10535    4              OCB.VFC_CHAR = 'A';

  10535 12 004271   101000 236003                    LDQ     33280,DU
        12 004272   000022 756000 xsym               STQ     OCB+18

     1772    10536    4              OCB.VFC_USE = 1;

  10536 12 004273   000001 235007                    LDA     1,DL
        12 004274   000023 755000 xsym               STA     OCB+19
        12 004275   005164 710000 12                 TRA     s:10773

     1773    10537    4            CASE(39);                      /* TX                                 */

     1774    10538    4              OCB.TX = 1;

  10538 12 004276   000001 235007                    LDA     1,DL
        12 004277   000220 755000 xsym               STA     OCB+144
        12 004300   005164 710000 12                 TRA     s:10773

     1775    10539    4            CASE(40);                      /* TYPE                               */

     1776    10540    4              IF OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->TEXT$C.LEN>2

  10540 12 004301   100003 473500                    LDP3    3,,PR1
        12 004302   300003 474500                    LDP4    3,,PR3
        12 004303   000100 101500                    MRL     fill='000'O
        12 004304   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        12 004305   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 004306   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 004307   000003 116007                    CMPQ    3,DL
        12 004310   004320 604000 12                 TMI     s:10547

     1777    10541    4               THEN
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:252  
     1778    10542    4                 CALL BAD_OPT(3,39);       /* TYPE FIELD GREATER THAN2 CHARS*/

  10542 12 004311   000245 236000 13                 LDQ     165
        12 004312   200126 756100                    STQ     @ERROR,,AUTO
        12 004313   000005 236000 13                 LDQ     5
        12 004314   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004315   001561 701000 12                 TSX1    BAD_OPT
        12 004316   000000 011000                    NOP     0
        12 004317   005164 710000 12                 TRA     s:10773

     1779    10543        /*E* ERROR:   VPC-00039
     1780    10544             MESSAGE: TYPE greater than 2 chars
     1781    10545        */
     1782    10546    5               ELSE DO;

     1783    10547    5                  OCB.TYPE = OPTION$->OUT$BLK.SUBLK$(0)->

  10547 12 004320   000000 471500                    LDP1    0,,PR0
        12 004321   100003 473500                    LDP3    3,,PR1
        12 004322   300003 474500                    LDP4    3,,PR3
        12 004323   000100 101500                    MRL     fill='000'O
        12 004324   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        12 004325   200130 000002                    ADSC9   @ERROR+2,,AUTO           cn=0,n=2
        12 004326   200130 220100                    LDX0    @ERROR+2,,AUTO
        12 004327   040000 100540                    MLR     fill='040'O
        12 004330   400000 200010                    ADSC9   0,,PR4                   cn=1,n=*X0
        12 004331   000043 200002 xsym               ADSC9   OCB+35                   cn=1,n=2

     1784    10548    5                    OUT$BLK.SUBLK$(0)->
     1785    10549    5                    TEXT$C.STRING;
     1786    10550    5                  FPT_OPEN_OUT.V.TYPE# = OCB.TYPE;

  10550 12 004332   040100 100400                    MLR     fill='040'O
        12 004333   000043 200002 xsym               ADSC9   OCB+35                   cn=1,n=2
        12 004334   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 004335   200130 220100                    LDX0    @ERROR+2,,AUTO
        12 004336   000047 740000 xsym               STX0    FPT_OPEN_OUT+39
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:253  

     1787    10551    5                  END;

  10551 12 004337   005164 710000 12                 TRA     s:10773

     1788    10552    4            CASE(41);                      /* UC                                 */

     1789    10553    4              OCB.UC_LC = 2;

  10553 12 004340   000002 235007                    LDA     2,DL
        12 004341   000027 755000 xsym               STA     OCB+23
        12 004342   005164 710000 12                 TRA     s:10773

     1790    10554    4            CASE(43);                      /* VFC                                */

     1791    10555    4              OCB.VFC = 2;

  10555 12 004343   000024 236000 xsym               LDQ     OCB+20
        12 004344   000162 376000 13                 ANQ     114
        12 004345   400000 276003                    ORQ     -131072,DU
        12 004346   000024 756000 xsym               STQ     OCB+20
        12 004347   005164 710000 12                 TRA     s:10773

     1792    10556    4            CASE(49);                      /* NVFC                               */

     1793    10557    4              OCB.VFC = 1;

  10557 12 004350   000024 236000 xsym               LDQ     OCB+20
        12 004351   000162 376000 13                 ANQ     114
        12 004352   200000 276003                    ORQ     65536,DU
        12 004353   000024 756000 xsym               STQ     OCB+20
        12 004354   005164 710000 12                 TRA     s:10773

     1794    10558    4            CASE(63);                      /* SVFC                               */

     1795    10559    4              OCB.VFC = 3;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:254  
  10559 12 004355   600000 236003                    LDQ     -65536,DU
        12 004356   000024 256000 xsym               ORSQ    OCB+20
        12 004357   005164 710000 12                 TRA     s:10773

     1796    10560    4            CASE(44);                      /* VOLUME                             */

     1797    10561    4              IF TOT_FILES(0) = 0          /* First output, OK for one-shot opt. */

  10561 12 004360   000000 235000 xsym               LDA     TOT_FILES
        12 004361   004407 601000 12                 TNZ     GOOD_VOL

     1798    10562    4               THEN
     1799    10563    5               DO;

     1800    10564    5                  CALL VPD$TEXTC_CHARBIN(TWORD,

  10564 12 004362   100003 473500                    LDP3    3,,PR1
        12 004363   000217 236000 13                 LDQ     143
        12 004364   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004365   300003 631500                    EPPR1   3,,PR3
        12 004366   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004367   200072 633500                    EPPR3   TWORD,,AUTO
        12 004370   200130 453500                    STP3    @ERROR+2,,AUTO
        12 004371   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 004372   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 004373   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 004374   004401 702000 12                 TSX2    BAD_VOL

     1801    10565    5                    OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1802    10566    5                    511) ALTRET(BAD_VOL);
     1803    10567    5                  FPT_OPEN_OUT.V.VOL# = TWORD;

  10567 12 004375   200072 236100                    LDQ     TWORD,,AUTO
        12 004376   000033 736000                    QLS     27
        12 004377   000061 552040 xsym               STBQ    FPT_OPEN_OUT+49,'40'O

     1804    10568    5                  GOTO GOOD_VOL;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:255  

  10568 12 004400   004407 710000 12                 TRA     GOOD_VOL

     1805    10569    5   BAD_VOL:       CALL BAD_OPT(3,76);      /* VOL TOO LARGE                      */

  10569 12 004401   000247 236000 13    BAD_VOL      LDQ     167
        12 004402   200126 756100                    STQ     @ERROR,,AUTO
        12 004403   000005 236000 13                 LDQ     5
        12 004404   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004405   001561 701000 12                 TSX1    BAD_OPT
        12 004406   000000 011000                    NOP     0

     1806    10570    5                  END;

  10569 12 004407   005164 710000 12    GOOD_VOL     TRA     s:10773

     1807    10571        /*E* ERROR:   VPC-00076
     1808    10572             MESSAGE: VOL too large
     1809    10573        */
     1810    10574    4   GOOD_VOL:  ;
     1811    10575    4            CASE(47);                      /* NRECORDS                           */

     1812    10576    4              CALL VPD$TEXTC_CHARBIN(FPT_OPEN_OUT.V.NRECS#,

  10576 12 004410   100003 473500                    LDP3    3,,PR1
        12 004411   000250 236000 13                 LDQ     168
        12 004412   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004413   300003 631500                    EPPR1   3,,PR3
        12 004414   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004415   000251 236000 13                 LDQ     169
        12 004416   200130 756100                    STQ     @ERROR+2,,AUTO
        12 004417   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 004420   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 004421   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 004422   004424 702000 12                 TSX2    BAD_NRECS

     1813    10577    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:256  
     1814    10578    4                BITBIN('377777777777'O)) ALTRET(BAD_NRECS);
     1815    10579    4              GOTO GOOD_NRECS;

  10579 12 004423   004432 710000 12                 TRA     GOOD_NRECS

     1816    10580    4   BAD_NRECS: CALL BAD_OPT(3,77);          /* NRECS TOO LARGE                    */

  10580 12 004424   000253 236000 13    BAD_NRECS    LDQ     171
        12 004425   200126 756100                    STQ     @ERROR,,AUTO
        12 004426   000005 236000 13                 LDQ     5
        12 004427   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004430   001561 701000 12                 TSX1    BAD_OPT
        12 004431   000000 011000                    NOP     0

  10578 12 004432   005164 710000 12    GOOD_NRECS   TRA     s:10773

     1817    10581        /*E* ERROR:   VPC-00077
     1818    10582             MESSAGE: NRECS too large
     1819    10583        */
     1820    10584    4   GOOD_NRECS: ;
     1821    10585    4            CASE(48);                      /* FVFC                               */

     1822    10586    4              OCB.FVFC = '1'B;

  10586 12 004433   100000 236003                    LDQ     32768,DU
        12 004434   000024 256000 xsym               ORSQ    OCB+20
        12 004435   005164 710000 12                 TRA     s:10773

     1823    10587    4            CASE(50);                      /* NRELEASE                           */

     1824    10588    4              OCB.RELEASE = 2;

  10588 12 004436   002000 236003                    LDQ     1024,DU
        12 004437   000043 552040 xsym               STBQ    OCB+35,'40'O
        12 004440   005164 710000 12                 TRA     s:10773

     1825    10589    4            CASE(51);                      /* DIRECT                             */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:257  

     1826    10590    4              OCB.NEWKEY = 1;

  10590 12 004441   000001 235007                    LDA     1,DL
        12 004442   000021 755000 xsym               STA     OCB+17
        12 004443   005164 710000 12                 TRA     s:10773

     1827    10591    4            CASE(52);                      /* NSPANNED                           */

     1828    10592    4              FPT_OPEN_OUT.V.SPANNED# = %NO#;

  10592 12 004444   000254 236000 13                 LDQ     172
        12 004445   000047 356000 xsym               ANSQ    FPT_OPEN_OUT+39
        12 004446   005164 710000 12                 TRA     s:10773

     1829    10593    4            CASE(53);                      /* BACKUP                             */

     1830    10594    4              OCB.BACKUP = 1;

  10594 12 004447   000001 235007                    LDA     1,DL
        12 004450   000221 755000 xsym               STA     OCB+145

     1831    10595    4              FPT_OPEN_OUT.V.BUPM# = %YES#;

  10595 12 004451   000047 236000 xsym               LDQ     FPT_OPEN_OUT+39
        12 004452   000255 376000 13                 ANQ     173
        12 004453   004000 276007                    ORQ     2048,DL
        12 004454   000047 756000 xsym               STQ     FPT_OPEN_OUT+39
        12 004455   005164 710000 12                 TRA     s:10773

     1832    10596    4            CASE(58);                      /* NBACKUP                            */

     1833    10597    4              OCB.BACKUP = 2;

  10597 12 004456   000002 235007                    LDA     2,DL
        12 004457   000221 755000 xsym               STA     OCB+145

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:258  
     1834    10598    4              FPT_OPEN_OUT.V.BUPM# = %NO#;

  10598 12 004460   000255 236000 13                 LDQ     173
        12 004461   000047 356000 xsym               ANSQ    FPT_OPEN_OUT+39
        12 004462   005164 710000 12                 TRA     s:10773

     1835    10599    4            CASE(55);                      /* NBLOCK                             */

     1836    10600    4              FPT_OPEN_OUT.V.BLOCKED# = %NO#;

  10600 12 004463   000256 236000 13                 LDQ     174
        12 004464   000047 356000 xsym               ANSQ    FPT_OPEN_OUT+39
        12 004465   005164 710000 12                 TRA     s:10773

     1837    10601    4            CASE(56);                      /* RECSIZE                            */

     1838    10602    5              DO J=0 TO OPTION$->OUT$BLK.NSUBLKS-1;

  10602 12 004466   200067 450100                    STZ     J,,AUTO
        12 004467   004542 710000 12                 TRA     s:10618+1

     1839    10603    5                 IF OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE ~=3 /* Not dash     */

  10603 12 004470   200063 470500                    LDP0    @OPTION$,,AUTO
        12 004471   000000 471500                    LDP1    0,,PR0
        12 004472   200067 720100                    LXL0    J,,AUTO
        12 004473   100003 473510                    LDP3    3,X0,PR1
        12 004474   300000 721100                    LXL1    0,,PR3
        12 004475   000003 101003                    CMPX1   3,DU
        12 004476   004511 600000 12                 TZE     s:10608

     1840    10604    5                  THEN
     1841    10605    5                    CALL VPD$TEXTC_CHARBIN(TWORD,

  10605 12 004477   000257 236000 13                 LDQ     175
        12 004500   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004501   300003 631500                    EPPR1   3,,PR3
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:259  
        12 004502   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004503   200072 633500                    EPPR3   TWORD,,AUTO
        12 004504   200130 453500                    STP3    @ERROR+2,,AUTO
        12 004505   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 004506   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 004507   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 004510   004615 702000 12                 TSX2    BAD_RECSIZE

     1842    10606    5                      OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0),
     1843    10607    5                      '777777777777'O) ALTRET(BAD_RECSIZE);
     1844    10608    6                 DO CASE(OPTION$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE);

  10608 12 004511   200063 470500                    LDP0    @OPTION$,,AUTO
        12 004512   000000 471500                    LDP1    0,,PR0
        12 004513   200067 720100                    LXL0    J,,AUTO
        12 004514   100003 473510                    LDP3    3,X0,PR1
        12 004515   300000 721100                    LXL1    0,,PR3
        12 004516   000004 101003                    CMPX1   4,DU
        12 004517   004521 602011 12                 TNC     s:10608+8,X1
        12 004520   004541 710000 12                 TRA     s:10618
        12 004521   004541 710000 12                 TRA     s:10618
        12 004522   004525 710000 12                 TRA     s:10610
        12 004523   004532 710000 12                 TRA     s:10613
        12 004524   004537 710000 12                 TRA     s:10616

     1845    10609    6                  CASE(1);                 /* minimum RECSIZE                    */

     1846    10610    6                    OCB.RECSIZE.MIN_SIZE = TWORD;

  10610 12 004525   200072 235100                    LDA     TWORD,,AUTO
        12 004526   000004 755000 xsym               STA     OCB+4

     1847    10611    6                    OCB.RECSIZE.MIN_SPEC = %YES#;

  10611 12 004527   400000 236003                    LDQ     -131072,DU
        12 004530   000003 756000 xsym               STQ     OCB+3
        12 004531   004541 710000 12                 TRA     s:10618
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:260  

     1848    10612    6                  CASE(2);                 /* maximum RECSIZE                    */

     1849    10613    6                    OCB.RECSIZE.MAX_SIZE = TWORD;

  10613 12 004532   200072 235100                    LDA     TWORD,,AUTO
        12 004533   000006 755000 xsym               STA     OCB+6

     1850    10614    6                    OCB.RECSIZE.MAX_SPEC = %YES#;

  10614 12 004534   400000 236003                    LDQ     -131072,DU
        12 004535   000005 756000 xsym               STQ     OCB+5
        12 004536   004541 710000 12                 TRA     s:10618

     1851    10615    6                  CASE(3);                 /* There's a dash                     */

     1852    10616    6                    OCB.RECSIZE.MAX_SIZE = OCB.RECSIZE.MIN_SIZE;

  10616 12 004537   000004 235000 xsym               LDA     OCB+4
        12 004540   000006 755000 xsym               STA     OCB+6

     1853    10617    6                  END;                     /* CASE                               */

     1854    10618    5                 END;

  10618 12 004541   200067 054100                    AOS     J,,AUTO
        12 004542   000000 471500                    LDP1    0,,PR0
        12 004543   100001 236100                    LDQ     1,,PR1
        12 004544   000022 772000                    QRL     18
        12 004545   200067 116100                    CMPQ    J,,AUTO
        12 004546   004470 605400 12                 TPNZ    s:10603

     1855    10619    4              IF OCB.RECSIZE.MIN_SPEC AND ~OCB.RECSIZE.MAX_SPEC

  10619 12 004547   000003 234000 xsym               SZN     OCB+3
        12 004550   004564 605000 12                 TPL     s:10626
        12 004551   000005 236000 xsym               LDQ     OCB+5
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:261  
        12 004552   400000 376003                    ANQ     -131072,DU
        12 004553   400000 676003                    ERQ     -131072,DU
        12 004554   004564 600000 12                 TZE     s:10626
        12 004555   000004 236000 xsym               LDQ     OCB+4
        12 004556   000006 116000 xsym               CMPQ    OCB+6
        12 004557   004564 600000 12                 TZE     s:10626

     1856    10620    4                AND OCB.RECSIZE.MIN_SIZE ~= OCB.RECSIZE.MAX_SIZE
     1857    10621    4               THEN
     1858    10622    5               DO;

     1859    10623    5                  OCB.RECSIZE.MAX_SPEC = %YES#;

  10623 12 004560   400000 236003                    LDQ     -131072,DU
        12 004561   000005 756000 xsym               STQ     OCB+5

     1860    10624    5                  OCB.RECSIZE.MAX_SIZE = OCB.RECSIZE.MIN_SIZE;

  10624 12 004562   000004 235000 xsym               LDA     OCB+4
        12 004563   000006 755000 xsym               STA     OCB+6

     1861    10625    5                  END;

     1862    10626    4              IF OCB.RECSIZE.MIN_SPEC AND OCB.RECSIZE.MIN_SIZE=0

  10626 12 004564   000003 234000 xsym               SZN     OCB+3
        12 004565   004577 605000 12                 TPL     s:10633
        12 004566   000004 235000 xsym               LDA     OCB+4
        12 004567   004577 601000 12                 TNZ     s:10633
        12 004570   000005 236000 xsym               LDQ     OCB+5
        12 004571   400000 376003                    ANQ     -131072,DU
        12 004572   400000 676003                    ERQ     -131072,DU
        12 004573   004577 600000 12                 TZE     s:10633

     1863    10627    4                AND ~OCB.RECSIZE.MAX_SPEC
     1864    10628    4               THEN
     1865    10629    5               DO;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:262  

     1866    10630    5                  OCB.RECSIZE.MAX_SPEC=%YES#;

  10630 12 004574   400000 236003                    LDQ     -131072,DU
        12 004575   000005 756000 xsym               STQ     OCB+5

     1867    10631    5                  OCB.RECSIZE.MAX_SIZE=0;

  10631 12 004576   000006 450000 xsym               STZ     OCB+6

     1868    10632    5                  END;

     1869    10633    4              IF OCB.RECSIZE.MIN_SPEC AND OCB.RECSIZE.MAX_SPEC

  10633 12 004577   000003 234000 xsym               SZN     OCB+3
        12 004600   004623 605000 12                 TPL     GOOD_RECSIZE
        12 004601   000005 234000 xsym               SZN     OCB+5
        12 004602   004623 605000 12                 TPL     GOOD_RECSIZE
        12 004603   000006 236000 xsym               LDQ     OCB+6
        12 004604   000004 116000 xsym               CMPQ    OCB+4
        12 004605   004623 605000 12                 TPL     GOOD_RECSIZE

     1870    10634    4                AND OCB.RECSIZE.MAX_SIZE < OCB.RECSIZE.MIN_SIZE
     1871    10635    4               THEN
     1872    10636    5               DO;

     1873    10637    5                  CALL BAD_OPT(3,94);

  10637 12 004606   000261 236000 13                 LDQ     177
        12 004607   200126 756100                    STQ     @ERROR,,AUTO
        12 004610   000005 236000 13                 LDQ     5
        12 004611   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004612   001561 701000 12                 TSX1    BAD_OPT
        12 004613   000000 011000                    NOP     0

     1874    10638    5                  GOTO GOOD_RECSIZE;       /* PREVENT SECOND MESSAGE             */

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:263  
  10638 12 004614   004623 710000 12                 TRA     GOOD_RECSIZE

     1875    10639    5                  END;
     1876    10640        /*E*   ERROR: VPC-00094
     1877    10641             MESSAGE: Minimum RECSIZE is greater than maximum RECSIZE.
     1878    10642        */
     1879    10643    4               ELSE
     1880    10644    4                 GOTO GOOD_RECSIZE;
     1881    10645    4   BAD_RECSIZE: CALL BAD_OPT(3,87);

  10645 12 004615   000263 236000 13    BAD_RECSIZE  LDQ     179
        12 004616   200126 756100                    STQ     @ERROR,,AUTO
        12 004617   000005 236000 13                 LDQ     5
        12 004620   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004621   001561 701000 12                 TSX1    BAD_OPT
        12 004622   000000 011000                    NOP     0

  10645 12 004623   005164 710000 12    GOOD_RECSIZE TRA     s:10773

     1882    10646        /*E*   ERROR: VPC-00087
     1883    10647             MESSAGE: RECSIZE too large
     1884    10648        */
     1885    10649    4   GOOD_RECSIZE: ;
     1886    10650    4            CASE(57);                      /* SHARE                              */

     1887    10651    4              FPT_OPEN_OUT.V.SHARE# = %ALL#;

  10651 12 004624   000044 236000 xsym               LDQ     FPT_OPEN_OUT+36
        12 004625   000264 376000 13                 ANQ     180
        12 004626   000010 276007                    ORQ     8,DL
        12 004627   000044 756000 xsym               STQ     FPT_OPEN_OUT+36
        12 004630   005164 710000 12                 TRA     s:10773

     1888    10652    4            CASE(59);                      /* REBUILD                            */

     1889    10653    4              IF ( ~ CMD_MASK(12)          /* COPY or LIST, etc.                 */

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:264  
  10653 12 004631   000000 236000 xsym               LDQ     CMD_MASK
        12 004632   000014 736000                    QLS     12
        12 004633   400000 376003                    ANQ     -131072,DU
        12 004634   400000 676003                    ERQ     -131072,DU
        12 004635   004644 600000 12                 TZE     s:10653+11
        12 004636   200017 234100                    SZN     OUT_FILE_EXISTS,,AUTO
        12 004637   004644 605000 12                 TPL     s:10653+11
        12 004640   000044 236000 xsym               LDQ     FPT_OPEN_OUT+36
        12 004641   000600 376007                    ANQ     384,DL
        12 004642   000400 116007                    CMPQ    256,DL
        12 004643   004647 600000 12                 TZE     s:10658
        12 004644   000000 236000 xsym               LDQ     CMD_MASK
        12 004645   000040 316003                    CANQ    32,DU
        12 004646   005164 600000 12                 TZE     s:10773

     1890    10654    4                AND OUT_FILE_EXISTS        /* There is an existing file          */
     1891    10655    4                AND FPT_OPEN_OUT.V.EXIST# = 2) /* INTO                           */
     1892    10656    4                OR CMD_MASK(12)            /* Always allowed on MODIFY           */
     1893    10657    4               THEN
     1894    10658    4                 OCB.REBUILD = %YES#;

  10658 12 004647   400000 236003                    LDQ     -131072,DU
        12 004650   000227 756000 xsym               STQ     OCB+151
        12 004651   005164 710000 12                 TRA     s:10773

     1895    10659    4            CASE(60);                      /* TRANSPARENT                        */

     1896    10660    4              OCB.TRANS = 2;

  10660 12 004652   000002 235007                    LDA     2,DL
        12 004653   000017 755000 xsym               STA     OCB+15
        12 004654   005164 710000 12                 TRA     s:10773

     1897    10661    4            CASE(64);                      /* WRAP                               */

     1898    10662    4              IF OPTION$ -> OUT$BLK.NSUBLKS = 0

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:265  
  10662 12 004655   100001 222100                    LDX2    1,,PR1
        12 004656   004662 601000 12                 TNZ     s:10666

     1899    10663    4               THEN                        /* Just said WRAP                     */
     1900    10664    4                 OCB.WRAP = 2;

  10664 12 004657   000002 235007                    LDA     2,DL
        12 004660   000260 755000 xsym               STA     OCB+176
        12 004661   005164 710000 12                 TRA     s:10773

     1901    10665    4               ELSE                        /* He told us what type               */
     1902    10666    4                 OCB.WRAP = OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;

  10666 12 004662   100003 473500                    LDP3    3,,PR1
        12 004663   300000 236100                    LDQ     0,,PR3
        12 004664   777777 376007                    ANQ     -1,DL
        12 004665   000260 756000 xsym               STQ     OCB+176
        12 004666   005164 710000 12                 TRA     s:10773

     1903    10667    4            CASE(65);                      /* NWRAP                              */

     1904    10668    4              OCB.WRAP = 1;

  10668 12 004667   000001 235007                    LDA     1,DL
        12 004670   000260 755000 xsym               STA     OCB+176
        12 004671   005164 710000 12                 TRA     s:10773

     1905    10669    4            CASE(66);                      /* WIDTH                              */

     1906    10670    4              CALL VPD$TEXTC_CHARBIN(OCB.WIDTH.SIZE,

  10670 12 004672   100003 473500                    LDP3    3,,PR1
        12 004673   000257 236000 13                 LDQ     175
        12 004674   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004675   300003 631500                    EPPR1   3,,PR3
        12 004676   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004677   000265 236000 13                 LDQ     181
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:266  
        12 004700   200130 756100                    STQ     @ERROR+2,,AUTO
        12 004701   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 004702   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 004703   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 004704   004710 702000 12                 TSX2    BAD_WIDTH

     1907    10671    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1908    10672    4                '777777777777'O) ALTRET(BAD_WIDTH);
     1909    10673    4              OCB.WIDTH.SPEC = %YES#;

  10673 12 004705   400000 236003                    LDQ     -131072,DU
        12 004706   000261 756000 xsym               STQ     OCB+177

     1910    10674    5              DO WHILE (%NO#);

  10674 12 004707   005164 710000 12                 TRA     s:10773

     1911    10675    5   BAD_WIDTH:    CALL BAD_OPT(3,64);

  10675 12 004710   000267 236000 13    BAD_WIDTH    LDQ     183
        12 004711   200126 756100                    STQ     @ERROR,,AUTO
        12 004712   000005 236000 13                 LDQ     5
        12 004713   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004714   001561 701000 12                 TSX1    BAD_OPT
        12 004715   000000 011000                    NOP     0

     1912    10676        /*E*   ERROR: VPC-00064
     1913    10677             MESSAGE: WIDTH too large
     1914    10678        */
     1915    10679    5                 END;

  10679 12 004716   005164 710000 12                 TRA     s:10773

     1916    10680    4            CASE(67);                      /* NCOMPRESSED                        */

     1917    10681    4              OCB.COMP = 1;                /* Remember for later                 */

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:267  
  10681 12 004717   000001 235007                    LDA     1,DL
        12 004720   000020 755000 xsym               STA     OCB+16

     1918    10682    4              FPT_OPEN_OUT.V.COMP# = %NO#; /* Take care of immediate needs       */

  10682 12 004721   000132 236000 13                 LDQ     90
        12 004722   000047 356000 xsym               ANSQ    FPT_OPEN_OUT+39
        12 004723   005164 710000 12                 TRA     s:10773

     1919    10683    4            CASE(68);                      /* NTRANS                             */

     1920    10684    4              OCB.TRANS = 1;

  10684 12 004724   000001 235007                    LDA     1,DL
        12 004725   000017 755000 xsym               STA     OCB+15
        12 004726   005164 710000 12                 TRA     s:10773

     1921    10685    4            CASE(69);                      /* HEAD                               */

     1922    10686    4              OCB.HEAD = 2;

  10686 12 004727   000002 235007                    LDA     2,DL
        12 004730   000263 755000 xsym               STA     OCB+179
        12 004731   005164 710000 12                 TRA     s:10773

     1923    10687    4            CASE(70);                      /* NHEAD                              */

     1924    10688    4              OCB.HEAD = 1;

  10688 12 004732   000001 235007                    LDA     1,DL
        12 004733   000263 755000 xsym               STA     OCB+179
        12 004734   005164 710000 12                 TRA     s:10773

     1925    10689    4            CASE(71);                      /* FORM                               */

     1926    10690    4              T$ = OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0);

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:268  
  10690 12 004735   100003 473500                    LDP3    3,,PR1
        12 004736   300003 236100                    LDQ     3,,PR3
        12 004737   200073 756100                    STQ     T$,,AUTO

     1927    10691    4              IF T$ -> TEXT$C.LEN > 6

  10691 12 004740   200073 474500                    LDP4    T$,,AUTO
        12 004741   000100 101500                    MRL     fill='000'O
        12 004742   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        12 004743   200130 000004                    ADSC9   @ERROR+2,,AUTO           cn=0,n=4
        12 004744   200130 236100                    LDQ     @ERROR+2,,AUTO
        12 004745   000007 116007                    CMPQ    7,DL
        12 004746   004756 604000 12                 TMI     s:10699

     1928    10692    4               THEN
     1929    10693    4                 CALL BAD_OPT(3,85);

  10693 12 004747   000271 236000 13                 LDQ     185
        12 004750   200126 756100                    STQ     @ERROR,,AUTO
        12 004751   000005 236000 13                 LDQ     5
        12 004752   200125 756100                    STQ     @SEVERITY,,AUTO
        12 004753   001561 701000 12                 TSX1    BAD_OPT
        12 004754   000000 011000                    NOP     0
        12 004755   005164 710000 12                 TRA     s:10773

     1930    10694        /*E* ERROR:   VPC-00085
     1931    10695             MESSAGE: FORM name has more than 6 characters.
     1932    10696        */
     1933    10697    4               ELSE
     1934    10698    5               DO;

     1935    10699    5                  OCB.FORM_FLG = %YES#;

  10699 12 004756   400000 236003                    LDQ     -131072,DU
        12 004757   000250 756000 xsym               STQ     OCB+168

     1936    10700    5                  OCB.FORM = T$ -> TEXT$C.STRING;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:269  

  10700 12 004760   000100 101500                    MRL     fill='000'O
        12 004761   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        12 004762   200130 000002                    ADSC9   @ERROR+2,,AUTO           cn=0,n=2
        12 004763   200130 220100                    LDX0    @ERROR+2,,AUTO
        12 004764   040000 100540                    MLR     fill='040'O
        12 004765   400000 200010                    ADSC9   0,,PR4                   cn=1,n=*X0
        12 004766   000246 000006 xsym               ADSC9   OCB+166                  cn=0,n=6

     1937    10701    5                  FPT_OPEN_OUT.FORM_ = VECTOR(OCB.FORM);

  10701 12 004767   000272 237000 13                 LDAQ    186
        12 004770   000040 757000 xsym               STAQ    FPT_OPEN_OUT+32

     1938    10702    5                  END;

  10702 12 004771   005164 710000 12                 TRA     s:10773

     1939    10703    4            CASE(72);                      /* COPIES=N                           */

     1940    10704    4              CALL VPD$TEXTC_CHARBIN(TWORD,

  10704 12 004772   100003 473500                    LDP3    3,,PR1
        12 004773   000275 236000 13                 LDQ     189
        12 004774   200132 756100                    STQ     @ERROR+4,,AUTO
        12 004775   300003 631500                    EPPR1   3,,PR3
        12 004776   200131 451500                    STP1    @ERROR+3,,AUTO
        12 004777   200072 633500                    EPPR3   TWORD,,AUTO
        12 005000   200130 453500                    STP3    @ERROR+2,,AUTO
        12 005001   200130 630500                    EPPR0   @ERROR+2,,AUTO
        12 005002   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 005003   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 005004   005017 702000 12                 TSX2    BAD_COPIES

     1941    10705    4                OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),
     1942    10706    4                99) ALTRET(BAD_COPIES);
     1943    10707    4              IF TWORD > 0
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:270  

  10707 12 005005   200072 235100                    LDA     TWORD,,AUTO
        12 005006   005017 600000 12                 TZE     BAD_COPIES

     1944    10708    4               THEN                        /* OK!                                */
     1945    10709    5               DO;

     1946    10710    5                  OCB.COPIES = TWORD;

  10710 12 005007   000033 735000                    ALS     27
        12 005010   000244 755000 xsym               STA     OCB+164

     1947    10711    5                  FPT_OPEN_OUT.V.COPIES# = OCB.COPIES;

  10711 12 005011   000244 236000 xsym               LDQ     OCB+164
        12 005012   000022 772000                    QRL     18
        12 005013   000066 552010 xsym               STBQ    FPT_OPEN_OUT+54,'10'O

     1948    10712    5                  OCB.COPIES_FLG = '1'B;

  10712 12 005014   400000 236003                    LDQ     -131072,DU
        12 005015   000245 756000 xsym               STQ     OCB+165

     1949    10713    5                  END;

  10713 12 005016   005164 710000 12                 TRA     s:10773

     1950    10714    4               ELSE
     1951    10715    5   BAD_COPIES: DO;

  10715 12 005017                       BAD_COPIES   null
     1952    10716    5                  CALL BAD_OPT(3,78);

  10716 12 005017   000277 236000 13                 LDQ     191
        12 005020   200126 756100                    STQ     @ERROR,,AUTO
        12 005021   000005 236000 13                 LDQ     5
        12 005022   200125 756100                    STQ     @SEVERITY,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:271  
        12 005023   001561 701000 12                 TSX1    BAD_OPT
        12 005024   000000 011000                    NOP     0

     1953    10717        /*E* ERROR:   VPC-00078
     1954    10718             MESSAGE: COPIES too large
     1955    10719        */
     1956    10720    5                  END;

  10720 12 005025   005164 710000 12                 TRA     s:10773

     1957    10721    4            CASE(73);                      /* NPAGE                              */

     1958    10722    4              OCB.PAGE = 1;

  10722 12 005026   000001 235007                    LDA     1,DL
        12 005027   000264 755000 xsym               STA     OCB+180
        12 005030   005164 710000 12                 TRA     s:10773

     1959    10723    4            CASE(74);                      /*  PAGE                              */

     1960    10724    4              OCB.PAGE = 2;

  10724 12 005031   000002 235007                    LDA     2,DL
        12 005032   000264 755000 xsym               STA     OCB+180
        12 005033   005164 710000 12                 TRA     s:10773

     1961    10725    4            CASE(75);                      /* NLOAD                              */

     1962    10726    4              FPT_OPEN_OUT.V.LOAD# = %NO#;

  10726 12 005034   000300 236000 13                 LDQ     192
        12 005035   000047 356000 xsym               ANSQ    FPT_OPEN_OUT+39
        12 005036   005164 710000 12                 TRA     s:10773

     1963    10727    4            CASE(76);                      /* NSUMMARY                           */

     1964    10728    4              OCB.SUMMARY = 2;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:272  

  10728 12 005037   000002 235007                    LDA     2,DL
        12 005040   000271 755000 xsym               STA     OCB+185
        12 005041   005164 710000 12                 TRA     s:10773

     1965    10729    4            CASE(77);                      /* SUMMARY                            */

     1966    10730    4              OCB.SUMMARY = 1;

  10730 12 005042   000001 235007                    LDA     1,DL
        12 005043   000271 755000 xsym               STA     OCB+185
        12 005044   005164 710000 12                 TRA     s:10773

     1967    10731    4            CASE(78);                      /* SAVE                               */

     1968    10732    4              OCB.ERR_SAVE=1;

  10732 12 005045   000001 235007                    LDA     1,DL
        12 005046   000272 755000 xsym               STA     OCB+186
        12 005047   005164 710000 12                 TRA     s:10773

     1969    10733    4            CASE(80);                      /* ALTBLD                             */

     1970    10734    4              OCB.ALTBLD=1;

  10734 12 005050   000001 235007                    LDA     1,DL
        12 005051   000230 755000 xsym               STA     OCB+152
        12 005052   005164 710000 12                 TRA     s:10773

     1971    10735    4            CASE(81);                      /* NALTBLD                            */

     1972    10736    4              OCB.ALTBLD=2;

  10736 12 005053   000002 235007                    LDA     2,DL
        12 005054   000230 755000 xsym               STA     OCB+152
        12 005055   005164 710000 12                 TRA     s:10773

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:273  
     1973    10737    4            CASE(82);                      /* GHSTACS                            */

     1974    10738    5              DO CASE(OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);

  10738 12 005056   100003 473500                    LDP3    3,,PR1
        12 005057   300000 722100                    LXL2    0,,PR3
        12 005060   000003 102003                    CMPX2   3,DU
        12 005061   005063 602012 12                 TNC     s:10738+5,X2
        12 005062   005104 710000 12                 TRA     s:10746
        12 005063   005104 710000 12                 TRA     s:10746
        12 005064   005066 710000 12                 TRA     s:10740
        12 005065   005075 710000 12                 TRA     s:10743

     1975    10739    5               CASE(1);

     1976    10740    5                 OCB.GHSTACS = %JRNLOPN#;

  10740 12 005066   000002 235007                    LDA     2,DL
        12 005067   000044 755000 xsym               STA     OCB+36

     1977    10741    5                 FPT_OPEN_OUT.V.GHSTACS# = %JRNLOPN#;

  10741 12 005070   000047 236000 xsym               LDQ     FPT_OPEN_OUT+39
        12 005071   000301 376000 13                 ANQ     193
        12 005072   000002 276007                    ORQ     2,DL
        12 005073   000047 756000 xsym               STQ     FPT_OPEN_OUT+39
        12 005074   005164 710000 12                 TRA     s:10773

     1978    10742    5               CASE(2);

     1979    10743    5                 OCB.GHSTACS = %NONE#;

  10743 12 005075   000003 235007                    LDA     3,DL
        12 005076   000044 755000 xsym               STA     OCB+36

     1980    10744    5                 FPT_OPEN_OUT.V.GHSTACS# = %NONE#;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:274  
  10744 12 005077   000047 236000 xsym               LDQ     FPT_OPEN_OUT+39
        12 005100   000301 376000 13                 ANQ     193
        12 005101   000003 276007                    ORQ     3,DL
        12 005102   000047 756000 xsym               STQ     FPT_OPEN_OUT+39
        12 005103   005164 710000 12                 TRA     s:10773

     1981    10745    5               CASE(ELSE);                 /* code = 4, USER ENTERED DECIMAL #   */

     1982    10746    5                 CALL CHARBIN(NUM, OPTION$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->
             10746                          TEXT$C.STRING);

  10746 12 005104   300003 474500                    LDP4    3,,PR3
        12 005105   000100 101500                    MRL     fill='000'O
        12 005106   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        12 005107   200130 000002                    ADSC9   @ERROR+2,,AUTO           cn=0,n=2
        12 005110   200130 220100                    LDX0    @ERROR+2,,AUTO
        12 005111   000100 305540                    DTB
        12 005112   400000 230010                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X0
        12 005113   200100 000004                    NDSC9   NUM,,AUTO                cn=0,s=lsgnf,sf=0,n=4

     1983    10747    5                 IF NUM > 15

  10747 12 005114   200100 235100                    LDA     NUM,,AUTO
        12 005115   000017 115007                    CMPA    15,DL
        12 005116   005126 604400 12                 TMOZ    s:10755

     1984    10748    5                  THEN
     1985    10749    5                    CALL BAD_OPT(3,1);     /* INVALID GHSTACS VALUE              */

  10749 12 005117   000032 236000 13                 LDQ     26
        12 005120   200126 756100                    STQ     @ERROR,,AUTO
        12 005121   000005 236000 13                 LDQ     5
        12 005122   200125 756100                    STQ     @SEVERITY,,AUTO
        12 005123   001561 701000 12                 TSX1    BAD_OPT
        12 005124   000000 011000                    NOP     0
        12 005125   005164 710000 12                 TRA     s:10773

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:275  
     1986    10750        /*E* ERROR:   VPC-00001
     1987    10751             MESSAGE: GHSTACS too large
     1988    10752        */
     1989    10753    5                  ELSE
     1990    10754    6                  DO;

     1991    10755    6                     OCB.GHSTACS = NUM;

  10755 12 005126   000044 755000 xsym               STA     OCB+36

     1992    10756    6                     FPT_OPEN_OUT.V.GHSTACS# = NUM;

  10756 12 005127   200100 236100                    LDQ     NUM,,AUTO
        12 005130   000047 676000 xsym               ERQ     FPT_OPEN_OUT+39
        12 005131   000017 376007                    ANQ     15,DL
        12 005132   000047 656000 xsym               ERSQ    FPT_OPEN_OUT+39

     1993    10757    6                     END;

     1994    10758    5               END;

  10758 12 005133   005164 710000 12                 TRA     s:10773

     1995    10759    4            CASE(83);                      /* IOERROK                            */

     1996    10760    4              FPT_OPEN_OUT.V.IOERROK# = %YES#;

  10760 12 005134   000060 236000 xsym               LDQ     FPT_OPEN_OUT+48
        12 005135   000302 376000 13                 ANQ     194
        12 005136   002000 276003                    ORQ     1024,DU
        12 005137   000060 756000 xsym               STQ     FPT_OPEN_OUT+48
        12 005140   005164 710000 12                 TRA     s:10773

     1997    10761    4            CASE(84);                      /* NIOERROK                           */

     1998    10762    4              FPT_OPEN_OUT.V.IOERROK# = %NO#;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:276  
  10762 12 005141   000302 236000 13                 LDQ     194
        12 005142   000060 356000 xsym               ANSQ    FPT_OPEN_OUT+48
        12 005143   005164 710000 12                 TRA     s:10773

     1999    10763    4            CASE(85);                      /* ANSISPAN                           */

     2000    10764    4              FPT_OPEN_OUT.V.ANSISPANSEQ# = %YES#;

  10764 12 005144   000060 236000 xsym               LDQ     FPT_OPEN_OUT+48
        12 005145   000255 376000 13                 ANQ     173
        12 005146   004000 276007                    ORQ     2048,DL
        12 005147   000060 756000 xsym               STQ     FPT_OPEN_OUT+48
        12 005150   005164 710000 12                 TRA     s:10773

     2001    10765    4            CASE(86);                      /* NANSISPAN                          */

     2002    10766    4              FPT_OPEN_OUT.V.ANSISPANSEQ# = %NO#;

  10766 12 005151   000255 236000 13                 LDQ     173
        12 005152   000060 356000 xsym               ANSQ    FPT_OPEN_OUT+48
        12 005153   005164 710000 12                 TRA     s:10773

     2003    10767    4            CASE(%(MAX_OUT_OP#+3));        /* SPARE:  FOR PATCHING USE ONLY      */

     2004    10768    4              OCB.SPARE3 = 3;

  10768 12 005154   000003 235007                    LDA     3,DL
        12 005155   000273 755000 xsym               STA     OCB+187
        12 005156   005164 710000 12                 TRA     s:10773

     2005    10769    4            CASE(%(MAX_OUT_OP#+2));        /* SPARE:  FOR PATCHING USE ONLY      */

     2006    10770    4              OCB.SPARE2 = 2;

  10770 12 005157   000002 235007                    LDA     2,DL
        12 005160   000274 755000 xsym               STA     OCB+188
        12 005161   005164 710000 12                 TRA     s:10773
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:277  

     2007    10771    4            CASE(%(MAX_OUT_OP#+1));        /* SPARE:  FOR PATCHING USE ONLY      */

     2008    10772    4              OCB.SPARE1 = 1;

  10772 12 005162   000001 235007                    LDA     1,DL
        12 005163   000275 755000 xsym               STA     OCB+189

     2009    10773    4            END;                           /* END CASE                           */

  10773 12 005164   005566 710000 12                 TRA     s:10965

     2010    10774        %EJECT;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:278  
     2011    10775    3   FILL_ACCESS_TBLS: PROC;

  10775 12 005165   200102 741300       FILL_ACCESS* STX1  ! NUM+2,,AUTO

     2012    10776        /*I* NAME: FILL_ACCESS_TBLS
     2013    10777             CALL: CALL FILL_ACCESS_TBLS;
     2014    10778             DESCRIPTION: This procedure fills in the ACCESS and ACSVEH fields of
     2015    10779                          the OCB for later use by the CLOSE procedure in setting
     2016    10780                          access vehicle list and account attribute list.
     2017    10781                          The format used for storage is NOT suitable for passing
     2018    10782                          to M$CLOSE:  an extra byte is present as the first entry
     2019    10783                          for each control/controlled that indicates SPEC_TYPE.
     2020    10784                          SPEC_TYPE   meaning
     2021    10785                          ---------   -------
     2022    10786                              1       complete entry as it stands, 'use this'
     2023    10787                              2       '+' add this to existing entries
     2024    10788                              3       '-' remove this from existing entries
     2025    10789                              4       remove this entire account or vehicle
     2026    10790        */
     2027    10791        /**/
     2028    10792        /*  STATIC DATA  */
     2029    10793        /**/
     2030    10794    4   DCL CNTLS(0:17) BIT(1);
     2031    10795    4   DCL SPEC_TYPE UBIN(9) STATIC;
     2032    10796    4   DCL BLOCK_OFFSET UBIN STATIC;           /* Parse block offset if sign present */
     2033    10797    4   DCL I SBIN WORD;
     2034    10798    4   DCL TMP UBIN WORD;
     2035    10799    4   DCL PTR$ PTR;
     2036    10800    4   DCL FILL$ PTR;
     2037    10801    4   DCL 1 TEXTC,
     2038    10802    4         2 LEN UBIN BYTE UNAL,
     2039    10803    4         2 STRING CHAR(40);
     2040    10804        /**/
     2041    10805        /*  BASED STRUCTURES  */
     2042    10806        /**/
     2043    10807    4   DCL 1 ACS$VEH BASED,
     2044    10808    4         2 SPEC_TYPE UBIN(9) UNAL,
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:279  
     2045    10809    4         2 CNTLS BIT(18),
     2046    10810    4         2 TEXTC,
     2047    10811    4           3 LEN UBIN BYTE UNAL,
     2048    10812    4           3 STRING CHAR(ACS$VEH.TEXTC.LEN);
     2049    10813    4   DCL 1 ACC$ESS BASED,
     2050    10814    4         2 SPEC_TYPE UBIN(9) UNAL,
     2051    10815    4         2 CNTLS BIT(18),
     2052    10816    4         2 ACCT CHAR(8);
     2053    10817                                                /* Determine SPEC_TYPE                */
     2054    10818    4           IF OPTION$ -> OUT$BLK.CODE = 33 /* READ                               */

  10818 12 005166   200063 470500                    LDP0    @OPTION$,,AUTO
        12 005167   000000 471500                    LDP1    0,,PR0
        12 005170   100000 720100                    LXL0    0,,PR1
        12 005171   000041 100003                    CMPX0   33,DU
        12 005172   005201 600000 12                 TZE     s:10823
        12 005173   000075 100003                    CMPX0   61,DU
        12 005174   005201 600000 12                 TZE     s:10823
        12 005175   000055 100003                    CMPX0   45,DU
        12 005176   005201 600000 12                 TZE     s:10823
        12 005177   000076 100003                    CMPX0   62,DU
        12 005200   005220 601000 12                 TNZ     s:10835

     2055    10819    4             OR OPTION$ -> OUT$BLK.CODE = 61 /* VREAD                            */
     2056    10820    4             OR OPTION$ -> OUT$BLK.CODE = 45 /* WRITE                            */
     2057    10821    4             OR OPTION$ -> OUT$BLK.CODE = 62 /* VWRITE                           */
     2058    10822    4            THEN                           /* No control bits specifiable        */
     2059    10823    4              IF OPTION$ -> OUT$BLK.NSUBLKS > 1

  10823 12 005201   100001 222100                    LDX2    1,,PR1
        12 005202   000002 102003                    CMPX2   2,DU
        12 005203   005214 602000 12                 TNC     s:10831

     2060    10824    4               THEN                        /* A + or - is present                */
     2061    10825    5               DO;

     2062    10826    5                  SPEC_TYPE = OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:280  

  10826 12 005204   100003 473500                    LDP3    3,,PR1
        12 005205   300000 236100                    LDQ     0,,PR3
        12 005206   777777 376007                    ANQ     -1,DL
        12 005207   000033 736000                    QLS     27
        12 005210   000066 756000 10                 STQ     SPEC_TYPE

     2063    10827    5                  BLOCK_OFFSET = 1;        /* Lower parse blocks are offset by 1 */

  10827 12 005211   000001 235007                    LDA     1,DL
        12 005212   000067 755000 10                 STA     BLOCK_OFFSET

     2064    10828    5                  END;

  10828 12 005213   005240 710000 12                 TRA     s:10850

     2065    10829    4               ELSE                        /* No sign present                    */
     2066    10830    5               DO;

     2067    10831    5                  SPEC_TYPE = 1;

  10831 12 005214   001000 236003                    LDQ     512,DU
        12 005215   000066 756000 10                 STQ     SPEC_TYPE

     2068    10832    5                  BLOCK_OFFSET = 0;

  10832 12 005216   000067 450000 10                 STZ     BLOCK_OFFSET

     2069    10833    5                  END;

  10833 12 005217   005240 710000 12                 TRA     s:10850

     2070    10834    4            ELSE                           /* Control bits are specifiable       */
     2071    10835    4              IF OPTION$ -> OUT$BLK.NSUBLKS > 1

  10835 12 005220   100001 222100                    LDX2    1,,PR1
        12 005221   000002 102003                    CMPX2   2,DU
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:281  
        12 005222   005235 602000 12                 TNC     NO_SIGN
        12 005223   100003 473500                    LDP3    3,,PR1
        12 005224   300001 223100                    LDX3    1,,PR3
        12 005225   005235 601000 12                 TNZ     NO_SIGN

     2072    10836    4                AND OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.NSUBLKS = 0
     2073    10837    4               THEN                        /* A + or - is present                */
     2074    10838    5               DO;

     2075    10839    5                  SPEC_TYPE = OPTION$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;

  10839 12 005226   300000 236100                    LDQ     0,,PR3
        12 005227   777777 376007                    ANQ     -1,DL
        12 005230   000033 736000                    QLS     27
        12 005231   000066 756000 10                 STQ     SPEC_TYPE

     2076    10840    5                  BLOCK_OFFSET = 1;        /* Lower parse blocks are offset by 1 */

  10840 12 005232   000001 235007                    LDA     1,DL
        12 005233   000067 755000 10                 STA     BLOCK_OFFSET

     2077    10841    5                  END;

  10841 12 005234   005240 710000 12                 TRA     s:10850

     2078    10842    4               ELSE                        /* No sign present                    */
     2079    10843    5   NO_SIGN:    DO;

  10843 12 005235                       NO_SIGN      null
     2080    10844    5                  SPEC_TYPE = 1;

  10844 12 005235   001000 236003                    LDQ     512,DU
        12 005236   000066 756000 10                 STQ     SPEC_TYPE

     2081    10845    5                  BLOCK_OFFSET = 0;

  10845 12 005237   000067 450000 10                 STZ     BLOCK_OFFSET
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:282  

     2082    10846    5                  END;

     2083    10847                                                /* First, we have to construct a      */
     2084    10848                                                /* structure of the controls to be    */
     2085    10849                                                /* applied (to somebody)              */
     2086    10850    4           IF OPTION$ -> OUT$BLK.CODE = 33 /* READ                               */

  10850 12 005240   000041 100003                    CMPX0   33,DU
        12 005241   005244 600000 12                 TZE     s:10853
        12 005242   000075 100003                    CMPX0   61,DU
        12 005243   005247 601000 12                 TNZ     s:10855

     2087    10851    4             OR OPTION$ -> OUT$BLK.CODE = 61 /* VREAD                            */
     2088    10852    4            THEN
     2089    10853    4              CNTLS = '400000'O;           /* READ ONLY                          */

  10853 12 005244   400000 223003                    LDX3    -131072,DU
        12 005245   200103 743100                    STX3    CNTLS,,AUTO
        12 005246   005317 710000 12                 TRA     s:10879

     2090    10854    4            ELSE
     2091    10855    4              IF OPTION$ -> OUT$BLK.CODE = 45 /* WRITE                           */

  10855 12 005247   000055 100003                    CMPX0   45,DU
        12 005250   005253 600000 12                 TZE     s:10858
        12 005251   000076 100003                    CMPX0   62,DU
        12 005252   005256 601000 12                 TNZ     s:10861

     2092    10856    4                OR OPTION$ -> OUT$BLK.CODE = 62 /* VWRITE                        */
     2093    10857    4               THEN
     2094    10858    4                 CNTLS = '764000'O;        /* READ,DELR,WNEW,UPD,DELF,REATTR     */

  10858 12 005253   764000 223003                    LDX3    -6144,DU
        12 005254   200103 743100                    STX3    CNTLS,,AUTO
        12 005255   005317 710000 12                 TRA     s:10879

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:283  
     2095    10859    4               ELSE
     2096    10860    5               DO;                         /* CNTLS SPECIFIED (MAYBE)            */

     2097    10861    5                  CNTLS = '0'B;

  10861 12 005256   000000 223003                    LDX3    0,DU
        12 005257   200103 743100                    STX3    CNTLS,,AUTO

     2098    10862    5                  IF OPTION$ -> OUT$BLK.NSUBLKS - BLOCK_OFFSET > 1

  10862 12 005260   100001 236100                    LDQ     1,,PR1
        12 005261   000022 772000                    QRL     18
        12 005262   000067 136000 10                 SBLQ    BLOCK_OFFSET
        12 005263   000001 116007                    CMPQ    1,DL
        12 005264   005311 604400 12                 TMOZ    s:10871

     2099    10863    5                   THEN                    /* CNTLS WERE INDEED SPECIFIED        */
     2100    10864    6                   DO;

     2101    10865    6                      PTR$ = OPTION$ -> OUT$BLK.SUBLK$(BLOCK_OFFSET +1);

  10865 12 005265   000067 724000 10                 LXL4    BLOCK_OFFSET
        12 005266   100004 236114                    LDQ     4,X4,PR1
        12 005267   200106 756100                    STQ     PTR$,,AUTO

     2102    10866    7                      DO I=0 TO PTR$->OUT$BLK.NSUBLKS-1;

  10866 12 005270   200104 450100                    STZ     I,,AUTO
        12 005271   005303 710000 12                 TRA     s:10868+1

     2103    10867    7                         CNTLS(PTR$->OUT$BLK.SUBLK$(I)->OUT$BLK.CODE-1) = '1'B;

  10867 12 005272   200106 470500                    LDP0    PTR$,,AUTO
        12 005273   200104 720100                    LXL0    I,,AUTO
        12 005274   000003 471510                    LDP1    3,X0,PR0
        12 005275   100000 236100                    LDQ     0,,PR1
        12 005276   777777 376007                    ANQ     -1,DL
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:284  
        12 005277   003106 060400                    CSL     bolr='003'O
        12 005300   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
        12 005301   200102 700001                    BDSC    NUM+2,Q,AUTO             by=3,bit=8,n=1

     2104    10868    7                         END;

  10868 12 005302   200104 054100                    AOS     I,,AUTO
        12 005303   200106 470500                    LDP0    PTR$,,AUTO
        12 005304   000001 236100                    LDQ     1,,PR0
        12 005305   000022 772000                    QRL     18
        12 005306   200104 116100                    CMPQ    I,,AUTO
        12 005307   005272 605400 12                 TPNZ    s:10867

     2105    10869    6                      END;

  10869 12 005310   005317 710000 12                 TRA     s:10879

     2106    10870    5                   ELSE                    /* No controls were specified         */
     2107    10871    5                     IF SPEC_TYPE = 3      /* IF '-' specified                   */

  10871 12 005311   000066 236000 10                 LDQ     SPEC_TYPE
        12 005312   777000 376003                    ANQ     -512,DU
        12 005313   003000 116003                    CMPQ    1536,DU
        12 005314   005317 601000 12                 TNZ     s:10879

     2108    10872    5                      THEN                 /* Remove entire account or vehicle   */
     2109    10873    5                        SPEC_TYPE = 4;

  10873 12 005315   004000 236003                    LDQ     2048,DU
        12 005316   000066 756000 10                 STQ     SPEC_TYPE

     2110    10874    5                  END;

     2111    10875                                                /* The controls to be applied now     */
     2112    10876                                                /* exist (in CNTLS)                   */
     2113    10877                                                /* PTR$ points to the people to get   */
     2114    10878                                                /* the controls                       */
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:285  
     2115    10879    4           PTR$ = OPTION$->OUT$BLK.SUBLK$(BLOCK_OFFSET);

  10879 12 005317   200063 470500                    LDP0    @OPTION$,,AUTO
        12 005320   000000 471500                    LDP1    0,,PR0
        12 005321   000067 720000 10                 LXL0    BLOCK_OFFSET
        12 005322   100003 236110                    LDQ     3,X0,PR1
        12 005323   200106 756100                    STQ     PTR$,,AUTO

     2116    10880    5           DO I=0 TO PTR$->OUT$BLK.NSUBLKS-1;

  10880 12 005324   200104 450100                    STZ     I,,AUTO
        12 005325   005557 710000 12                 TRA     s:10962+1

     2117    10881    5              TEXTC.LEN = PTR$->OUT$BLK.SUBLK$(I)->OUT$SYM.COUNT;

  10881 12 005326   200106 470500                    LDP0    PTR$,,AUTO
        12 005327   200104 720100                    LXL0    I,,AUTO
        12 005330   000003 471510                    LDP1    3,X0,PR0
        12 005331   100004 236100                    LDQ     4,,PR1
        12 005332   200110 552140                    STBQ    TEXTC,'40'O,AUTO

     2118    10882    5              TEXTC.STRING = PTR$->OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT;

  10882 12 005333   100004 236100                    LDQ     4,,PR1
        12 005334   000033 772000                    QRL     27
        12 005335   000000 621006                    EAX1    0,QL
        12 005336   040100 100540                    MLR     fill='040'O
        12 005337   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        12 005340   200110 200050                    ADSC9   TEXTC,,AUTO              cn=1,n=40

     2119    10883    5              IF OPTION$->OUT$BLK.CODE=42  /* ACCESS VEHICLE                     */

  10883 12 005341   200063 473500                    LDP3    @OPTION$,,AUTO
        12 005342   300000 474500                    LDP4    0,,PR3
        12 005343   400000 722100                    LXL2    0,,PR4
        12 005344   000052 102003                    CMPX2   42,DU
        12 005345   005352 600000 12                 TZE     s:10888
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:286  
        12 005346   000075 102003                    CMPX2   61,DU
        12 005347   005352 600000 12                 TZE     s:10888
        12 005350   000076 102003                    CMPX2   62,DU
        12 005351   005427 601000 12                 TNZ     s:10911

     2120    10884    5                OR OPTION$->OUT$BLK.CODE=61 /* VEHICLE READ                      */
     2121    10885    5                OR OPTION$->OUT$BLK.CODE=62 /* VEHICLE WRITE                     */
     2122    10886    5               THEN                        /* VEHICLE is involved                */
     2123    10887    6               DO;

     2124    10888    6                  IF SPEC_TYPE = 1

  10888 12 005352   000066 236000 10                 LDQ     SPEC_TYPE
        12 005353   777000 376003                    ANQ     -512,DU
        12 005354   001000 116003                    CMPQ    512,DU
        12 005355   005360 601000 12                 TNZ     s:10891

     2125    10889    6                   THEN                    /* Ignore any old controls            */
     2126    10890    6                     OCB.ACSVEH_REPLACE = '1'B;

  10890 12 005356   400000 236003                    LDQ     -131072,DU
        12 005357   000251 756000 xsym               STQ     OCB+169

     2127    10891    6                  IF OCB.ACSVEH.LEN + TEXTC.LEN +4 > 200

  10891 12 005360   200110 236100                    LDQ     TEXTC,,AUTO
        12 005361   000033 772000                    QRL     27
        12 005362   000045 036000 xsym               ADLQ    OCB+37
        12 005363   000305 116007                    CMPQ    197,DL
        12 005364   005374 602000 12                 TNC     s:10902

     2128    10892    6                   THEN                    /* We used OCB.ACCESS.LISTs 50 words  */
     2129    10893    7                   DO;

     2130    10894    7                      CALL BAD_OPT(3,89);

  10894 12 005365   000304 236000 13                 LDQ     196
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:287  
        12 005366   200126 756100                    STQ     @ERROR,,AUTO
        12 005367   000005 236000 13                 LDQ     5
        12 005370   200125 756100                    STQ     @SEVERITY,,AUTO
        12 005371   001561 701000 12                 TSX1    BAD_OPT
        12 005372   000000 011000                    NOP     0

     2131    10895    7                      GOTO QUIT;

  10895 12 005373   005564 710000 12                 TRA     QUIT

     2132    10896    7                      END;
     2133    10897        /*E*   ERROR: VPC-00089
     2134    10898             MESSAGE: Too many access vehicle controls
     2135    10899            MESSAGE1: PCL limits the total access vehicle control info in ACS,
     2136    10900        VR, and VWR to 200 bytes.
     2137    10901        */
     2138    10902    6                  FILL$ = PINCRC(ADDR(OCB.ACSVEH.LIST),OCB.ACSVEH.LEN);

  10902 12 005374   000045 236000 xsym               LDQ     OCB+37
        12 005375   000020 736000                    QLS     16
        12 005376   000305 036000 13                 ADLQ    197
        12 005377   200107 756100                    STQ     FILL$,,AUTO

     2139    10903    6                  FILL$ -> ACS$VEH.SPEC_TYPE = SPEC_TYPE;

  10903 12 005400   200107 471500                    LDP1    FILL$,,AUTO
        12 005401   000100 100400                    MLR     fill='000'O
        12 005402   000066 000001 10                 ADSC9   SPEC_TYPE                cn=0,n=1
        12 005403   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     2140    10904    6                  FILL$ -> ACS$VEH.CNTLS = CNTLS;

  10904 12 005404   000100 100500                    MLR     fill='000'O
        12 005405   200103 000002                    ADSC9   CNTLS,,AUTO              cn=0,n=2
        12 005406   100000 200002                    ADSC9   0,,PR1                   cn=1,n=2

     2141    10905    6                  FILL$ -> ACS$VEH.TEXTC.LEN = TEXTC.LEN;
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:288  

  10905 12 005407   000100 100500                    MLR     fill='000'O
        12 005410   200110 000001                    ADSC9   TEXTC,,AUTO              cn=0,n=1
        12 005411   100000 600001                    ADSC9   0,,PR1                   cn=3,n=1

     2142    10906    6                  FILL$ -> ACS$VEH.TEXTC.STRING = TEXTC.STRING;

  10906 12 005412   000100 101500                    MRL     fill='000'O
        12 005413   100000 600001                    ADSC9   0,,PR1                   cn=3,n=1
        12 005414   200130 000002                    ADSC9   @ERROR+2,,AUTO           cn=0,n=2
        12 005415   200130 221100                    LDX1    @ERROR+2,,AUTO
        12 005416   040140 100500                    MLR     fill='040'O
        12 005417   200110 200050                    ADSC9   TEXTC,,AUTO              cn=1,n=40
        12 005420   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1

     2143    10907    6                  OCB.ACSVEH.LEN = OCB.ACSVEH.LEN+TEXTC.LEN +4;

  10907 12 005421   200110 236100                    LDQ     TEXTC,,AUTO
        12 005422   000033 772000                    QRL     27
        12 005423   000045 036000 xsym               ADLQ    OCB+37
        12 005424   000004 036007                    ADLQ    4,DL
        12 005425   000045 756000 xsym               STQ     OCB+37

     2144    10908    6                  END;

  10908 12 005426   005556 710000 12                 TRA     s:10962

     2145    10909    5               ELSE                        /* ACCOUNT access controls            */
     2146    10910    6               DO;

     2147    10911    6                  IF SUBSTR(TEXTC.STRING,0,1) = '.'

  10911 12 005427   200110 236100                    LDQ     TEXTC,,AUTO
        12 005430   000777 376003                    ANQ     511,DU
        12 005431   000056 116003                    CMPQ    46,DU
        12 005432   005445 601000 12                 TNZ     s:10918

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:289  
     2148    10912    6                   THEN
     2149    10913    7                   DO;

     2150    10914    7                      TEXTC.STRING = SUBSTR(TEXTC.STRING,1,TEXTC.LEN-1);

  10914 12 005433   200110 236100                    LDQ     TEXTC,,AUTO
        12 005434   000033 772000                    QRL     27
        12 005435   777777 623006                    EAX3    -1,QL
        12 005436   040100 100540                    MLR     fill='040'O
        12 005437   200110 400013                    ADSC9   TEXTC,,AUTO              cn=2,n=*X3
        12 005440   200110 200050                    ADSC9   TEXTC,,AUTO              cn=1,n=40

     2151    10915    7                      TEXTC.LEN = TEXTC.LEN-1;

  10915 12 005441   200110 236100                    LDQ     TEXTC,,AUTO
        12 005442   777000 036003                    ADLQ    -512,DU
        12 005443   200110 552140                    STBQ    TEXTC,'40'O,AUTO

     2152    10916    7                      END;

  10916 12 005444   005502 710000 12                 TRA     s:10934

     2153    10917    6                   ELSE
     2154    10918    6                     IF SUBSTR(TEXTC.STRING,0,1)=''''

  10918 12 005445   200110 236100                    LDQ     TEXTC,,AUTO
        12 005446   000777 376003                    ANQ     511,DU
        12 005447   000047 116003                    CMPQ    39,DU
        12 005450   005467 601000 12                 TNZ     s:10926
        12 005451   200110 236100                    LDQ     TEXTC,,AUTO
        12 005452   000033 772000                    QRL     27
        12 005453   040000 106506                    CMPC    fill='040'O
        12 005454   200110 000001                    ADSC9   TEXTC,Q,AUTO             cn=0,n=1
        12 005455   000306 000001 13                 ADSC9   198                      cn=0,n=1
        12 005456   005467 601000 12                 TNZ     s:10926

     2155    10919    6                       AND SUBSTR(TEXTC.STRING,TEXTC.LEN-1,1)=''''
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:290  
     2156    10920    6                      THEN
     2157    10921    7                      DO;

     2158    10922    7                         TEXTC.STRING = SUBSTR(TEXTC.STRING,1,TEXTC.LEN-2);

  10922 12 005457   777776 623006                    EAX3    -2,QL
        12 005460   040100 100540                    MLR     fill='040'O
        12 005461   200110 400013                    ADSC9   TEXTC,,AUTO              cn=2,n=*X3
        12 005462   200110 200050                    ADSC9   TEXTC,,AUTO              cn=1,n=40

     2159    10923    7                         TEXTC.LEN = TEXTC.LEN-2;

  10923 12 005463   200110 236100                    LDQ     TEXTC,,AUTO
        12 005464   776000 036003                    ADLQ    -1024,DU
        12 005465   200110 552140                    STBQ    TEXTC,'40'O,AUTO

     2160    10924    7                         END;

  10924 12 005466   005502 710000 12                 TRA     s:10934

     2161    10925    6                      ELSE
     2162    10926    6                        CALL INDEX(TMP,'.',TEXTC.STRING)

  10926 12 005467   000000 124500                    SCM     mask='000'O
        12 005470   200110 200050                    ADSC9   TEXTC,,AUTO              cn=1,n=40
        12 005471   000307 000001 13                 ADSC9   199                      cn=0,n=1
        12 005472   200105 000100                    ARG     TMP,,AUTO
        12 005473   005502 606400 12                 TTN     s:10934

     2163    10927    7                         WHENRETURN DO;

     2164    10928    7                            CALL BAD_OPT(3,93);

  10928 12 005474   000311 236000 13                 LDQ     201
        12 005475   200126 756100                    STQ     @ERROR,,AUTO
        12 005476   000005 236000 13                 LDQ     5
        12 005477   200125 756100                    STQ     @SEVERITY,,AUTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:291  
        12 005500   001561 701000 12                 TSX1    BAD_OPT
        12 005501   000000 011000                    NOP     0

     2165    10929    7                            END;

     2166    10930        /*E*  ERROR:   VPC-00093
     2167    10931              MESSAGE: Illegal account in ACCESS list.
     2168    10932             MESSAGE1: The account specified contains an illegal character.
     2169    10933        */
     2170    10934    6                  IF SPEC_TYPE = 1

  10934 12 005502   000066 236000 10                 LDQ     SPEC_TYPE
        12 005503   777000 376003                    ANQ     -512,DU
        12 005504   001000 116003                    CMPQ    512,DU
        12 005505   005510 601000 12                 TNZ     s:10937

     2171    10935    6                   THEN                    /* Ignore any old controls            */
     2172    10936    6                     OCB.ACCESS_REPLACE = '1'B;

  10936 12 005506   400000 236003                    LDQ     -131072,DU
        12 005507   000253 756000 xsym               STQ     OCB+171

     2173    10937    6                  IF TEXTC.LEN>8

  10937 12 005510   200110 236100                    LDQ     TEXTC,,AUTO
        12 005511   777000 376003                    ANQ     -512,DU
        12 005512   011000 116003                    CMPQ    4608,DU
        12 005513   005523 602000 12                 TNC     s:10945

     2174    10938    6                   THEN
     2175    10939    6                     CALL BAD_OPT(3,79);

  10939 12 005514   000313 236000 13                 LDQ     203
        12 005515   200126 756100                    STQ     @ERROR,,AUTO
        12 005516   000005 236000 13                 LDQ     5
        12 005517   200125 756100                    STQ     @SEVERITY,,AUTO
        12 005520   001561 701000 12                 TSX1    BAD_OPT
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:292  
        12 005521   000000 011000                    NOP     0
        12 005522   005556 710000 12                 TRA     s:10962

     2176    10940        /*E* ERROR:   VPC-00079
     2177    10941             MESSAGE: ACCOUNT for account access controls > 8 characters
     2178    10942        */
     2179    10943    6                   ELSE
     2180    10944    7                   DO;

     2181    10945    7                      IF OCB.ACCESS.LEN > 210

  10945 12 005523   000130 235000 xsym               LDA     OCB+88
        12 005524   000323 115007                    CMPA    211,DL
        12 005525   005535 602000 12                 TNC     s:10955

     2182    10946    7                       THEN           /* We've used OCB.ACCESS.LISTs 220 byts    */
     2183    10947    8                       DO;

     2184    10948    8                          CALL BAD_OPT(3,88);

  10948 12 005526   000315 236000 13                 LDQ     205
        12 005527   200126 756100                    STQ     @ERROR,,AUTO
        12 005530   000005 236000 13                 LDQ     5
        12 005531   200125 756100                    STQ     @SEVERITY,,AUTO
        12 005532   001561 701000 12                 TSX1    BAD_OPT
        12 005533   000000 011000                    NOP     0

     2185    10949    8                          GOTO QUIT;

  10949 12 005534   005564 710000 12                 TRA     QUIT

     2186    10950    8                          END;
     2187    10951        /*E*   ERROR: VPC-00088
     2188    10952             MESSAGE: Too many account access controls
     2189    10953           MESSAGE1: PCL limits the total number of account entries in R, WR, and ACC to 20
     2190    10954        */
     2191    10955    7                      FILL$ = PINCRC(ADDR(OCB.ACCESS.LIST),OCB.ACCESS.LEN);
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:293  

  10955 12 005535   000130 236000 xsym               LDQ     OCB+88
        12 005536   000020 736000                    QLS     16
        12 005537   000316 036000 13                 ADLQ    206
        12 005540   200107 756100                    STQ     FILL$,,AUTO

     2192    10956    7                      FILL$ -> ACC$ESS.SPEC_TYPE = SPEC_TYPE;

  10956 12 005541   200107 470500                    LDP0    FILL$,,AUTO
        12 005542   000100 100400                    MLR     fill='000'O
        12 005543   000066 000001 10                 ADSC9   SPEC_TYPE                cn=0,n=1
        12 005544   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     2193    10957    7                      FILL$ -> ACC$ESS.CNTLS = CNTLS;

  10957 12 005545   000100 100500                    MLR     fill='000'O
        12 005546   200103 000002                    ADSC9   CNTLS,,AUTO              cn=0,n=2
        12 005547   000000 200002                    ADSC9   0,,PR0                   cn=1,n=2

     2194    10958    7                      FILL$ -> ACC$ESS.ACCT = TEXTC.STRING;

  10958 12 005550   040100 100500                    MLR     fill='040'O
        12 005551   200110 200010                    ADSC9   TEXTC,,AUTO              cn=1,n=8
        12 005552   000000 600010                    ADSC9   0,,PR0                   cn=3,n=8

     2195    10959    7                      OCB.ACCESS.LEN = OCB.ACCESS.LEN +11;

  10959 12 005553   000130 235000 xsym               LDA     OCB+88
        12 005554   000013 035007                    ADLA    11,DL
        12 005555   000130 755000 xsym               STA     OCB+88

     2196    10960    7                      END;

     2197    10961    6                  END;

     2198    10962    5              END;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:294  
  10962 12 005556   200104 054100                    AOS     I,,AUTO
        12 005557   200106 470500                    LDP0    PTR$,,AUTO
        12 005560   000001 236100                    LDQ     1,,PR0
        12 005561   000022 772000                    QRL     18
        12 005562   200104 116100                    CMPQ    I,,AUTO
        12 005563   005326 605400 12                 TPNZ    s:10881

     2199    10963    4   QUIT:   RETURN;

  10963 12 005564   200102 221300       QUIT         LDX1  ! NUM+2,,AUTO
        12 005565   000001 702211                    TSX2  ! 1,X1

     2200    10964    4   END FILL_ACCESS_TBLS;
     2201    10965    3   END PROCESS_OUTPUT_OPTION;

  10965 12 005566   200062 221300                    LDX1  ! CON_DUP_TBL+21,,AUTO
        12 005567   000001 702211                    TSX2  ! 1,X1
     2202    10966    2   END PROCESS_OPTS;
     2203    10967    1   END VPC$SETOUT;

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:295  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPC$SETOUT.
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:296  

 **** Variables and constants ****

  ****  Section 010  Data  VPC$SETOUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    52-0-0/c CHAR(8)     r     1 ACCT#                     60-0-0/w UBIN(9)     r     1 ASN#
    67-0-0/w UBIN        r     1 BLOCK_OFFSET              64-0-0/w UBIN        r     1 DATE_TYPE
    62-0-0/c CHAR(6)     r     1 FORM_DEFAULT               0-0-0/d STRC(864)   r     1 FPT_FID
    42-0-0/c STRC(288)   r     1 NAME#                     54-0-0/c CHAR(8)     r     1 PASS#
    54-0-0/c BIT (72)    r     1 PASSB#                    61-0-0/c CHAR(4)     r     1 RES#
    30-0-0/d STRC(324)   r     1 RESULTS_FID               66-0-0/w UBIN(9)     r     1 SPEC_TYPE
    56-0-0/c CHAR(8)     r     1 WSN#

  ****  Section 011 RoData VPC$SETOUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b UBIN(18)    r     1 CMD_ABORT_ERR(0:29)
  1025-0-0/b UBIN(9)     r     1 CON_DUP_IDX(0:359)
    17-0-0/c STRC(207)   r     1 OPT_TABLE(0:89)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   126-0-0/w PTR         r     1 @ERROR                    63-0-0/w PTR         r     1 @OPTION$
    23-0-0/w PTR         r     1 @OPTS$                     3-0-0/w PTR         r     1 @OUT_SPEC$
   125-0-0/w PTR         r     1 @SEVERITY                103-0-0/b BIT         r     1 CNTLS(0:17)
    35-0-0/b UBIN(9)     r     1 CON_DUP_TBL(0:65)
    77-0-0/w SBIN        r     1 CREATE_25TH_TSTAMP#       75-0-0/w UBIN        r     1 CREATE_TSTAMP#
    31-0-0/w SBIN        r     1 DUP_IDX                   *0-0-0/w UBIN        r     1 ERROR
    10-0-0/d BIT (72)    r     1 FIELD1_                   12-0-0/d BIT (72)    r     1 FIELD2_
   107-0-0/w PTR         r     1 FILL$                     25-0-0/w SBIN        r     1 HIGHEST_SEV
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:297  
     5-0-0/w SBIN        r     1 I                         26-0-0/w SBIN        r     1 I
   104-0-0/w SBIN        r     1 I                         34-0-0/w SBIN        r     1 IDX
    67-0-0/w SBIN        r     1 J                         70-0-0/w SBIN        r     1 K
     4-0-0/w SBIN        r     1 NAME_SPEC_TYPE            23-0-0/w SBIN        r     1 NAME_SPEC_TYPE
   100-0-0/w SBIN        r     1 NUM                       *0-0-0/w PTR         r     1 OPTION$
    24-0-0/w PTR         r     1 OPTIONS$                  32-0-0/w SBIN        r     1 OPTION_CODE
    *0-0-0/w PTR         r     1 OPTS$                     30-0-0/w SBIN        r     1 OPT_IDX
    14-0-0/w SBIN        r     1 OPT_START                 33-0-0/w SBIN        r     1 ORG_CODE
    34-0-0/b BIT         r     1 ORG_MASK(0:35)
    20-0-0/b BIT         r     1 OUT_FID_GIVEN             17-0-0/b BIT         r     1 OUT_FILE_EXISTS
    *0-0-0/w PTR         r     1 OUT_SPEC$                  7-0-0/w PTR         r     1 PTR$
   106-0-0/w PTR         r     1 PTR$                      23-0-0/c CHAR(2)     r     1 RES
    76-0-0/w SBIN        r     1 SAV_25TH_TSTAMP#          74-0-0/w UBIN        r     1 SAV_TSTAMP#
    *0-0-0/w SBIN        r     1 SEVERITY                  73-0-0/w PTR         r     1 T$
   110-0-0/c STRC(369)   r     1 TEXTC                    105-0-0/w UBIN        r     1 TMP
    24-0-0/c STRC(288)   r     1 TNAME#                    72-0-0/w UBIN        r     1 TWORD
    24-0-0/d VECT        r     1 VECTR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 BREAKS
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/b BIT         r     1 CMD_MASK(0:71)
     0-0-0/c STRC(288)   r     1 DIN_NAME                   0-0-0/d STRC(6840)  r     1 EO_OCB
     0-0-0/w PTR         r     1 FPARAM$                    0-0-0/w SBIN        r     1 FPARAM_BOUND
     0-0-0/d SBIN        r     1 FPARAM_BUF(0:1023)
     0-0-0/d STRC(2088)  r     1 FPT_OPEN_OUT               0-0-0/d STRC(2088)  r     1 FPT_OPEN_OUT_SAVE
     0-0-0/d STRC(5868)  r     1 ICB                        0-0-0/w PTR         r     1 M$EI$
     0-0-0/w UBIN        r     1 NOW_UTS                    0-0-0/d STRC(6840)  r     1 OCB
     0-0-0/c STRC(162)   r     1 ORG_TBL(0:8191)            0-0-0/w STRC        r     1 OUTPUT_ERR
     0-0-0/w STRC(1116)  r     1 OUT_SN
     0-0-0/w SBIN        r     1 TOT_FILES(0:4)
     0-0-0/w PTR         r     1 USER_LABELS$

PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:298  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(99)    r     1 ACC$ESS                    0-0-0/c ASTR        r     1 ACS$VEH
     0-0-0/d STRC(72)    r     1 B$VECTOR                   0-0-0/w UBIN        r     1 B$WORD
     0-0-0/w STRC(324)   r     1 CODE03                     0-0-0/w STRC(396)   r     1 CODE04
     0-0-0/w STRC(1404)  r     1 CODE16                     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$EI                       0-0-0N  NULL        r     1 M$EO
     0-0-0N  NULL        r     1 M$EO1                      0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/c ASTR(9)     r     1 TEXT$C
     0-0-0/d STRC(612)   r     1 VLP_FPRG


   Procedure VPC$SETOUT requires 2936 words for executable code.
   Procedure VPC$SETOUT requires 96 words of local(AUTO) storage.

    No errors detected in file VPC$SETOUT.:E05TSI    .
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:299  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:300  
          MINI XREF LISTING

ACC$ESS.ACCT IN PROCEDURE FILL_ACCESS_TBLS
     10816**DCL     10958<<ASSIGN
ACC$ESS.CNTLS IN PROCEDURE FILL_ACCESS_TBLS
     10815**DCL     10957<<ASSIGN
ACC$ESS.SPEC_TYPE IN PROCEDURE FILL_ACCESS_TBLS
     10814**DCL     10956<<ASSIGN
ACCT#
      8653**DCL      8599--DCLINIT  9081>>IF       9259--ASSIGN
ACS$VEH.CNTLS IN PROCEDURE FILL_ACCESS_TBLS
     10809**DCL     10904<<ASSIGN
ACS$VEH.SPEC_TYPE IN PROCEDURE FILL_ACCESS_TBLS
     10808**DCL     10903<<ASSIGN
ACS$VEH.TEXTC.LEN IN PROCEDURE FILL_ACCESS_TBLS
     10811**DCL     10812--IMP-SIZ 10905<<ASSIGN  10906>>ASSIGN
ACS$VEH.TEXTC.STRING IN PROCEDURE FILL_ACCESS_TBLS
     10812**DCL     10906<<ASSIGN
ASN#
      8657**DCL      8601--DCLINIT  8976>>IF       9071<<ASSIGN   9228>>IF       9272>>ASSIGN   9297>>DOCASE
     10297>>IF
B$ALT.CODE
      8431**DCL      8431--REDEF    8432--REDEF    8432--REDEF
B$ALT.ERR.ERR#
      8433**DCL      8433--REDEF
B$ALT.EVID
      8432**DCL      8432--REDEF    8432--REDEF
B$VECTOR.PTR$
      8566**DCL      8990<<ASSIGN
B$VECTOR.W1.VSIZE#
      8564**DCL      8991<<ASSIGN
B$VECTOR.W2
      8565**DCL      8566--REDEF
B$WORD
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:301  
      8568**DCL      8989>>IF       8991>>ASSIGN
BAD_BLKL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10173**LABEL   10168--CALLALT
BAD_COPIES IN PROCEDURE PROCESS_OUTPUT_OPTION
     10715**LABEL   10704--CALLALT
BAD_CS IN PROCEDURE PROCESS_OUTPUT_OPTION
     10219**LABEL   10207--CALLALT
BAD_DENS IN PROCEDURE PROCESS_OUTPUT_OPTION
     10250**LABEL   10233--CALLALT
BAD_IXTN IN PROCEDURE PROCESS_OUTPUT_OPTION
     10492**LABEL   10488--CALLALT
BAD_KEYL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10325**LABEL   10320--CALLALT
BAD_KEYX IN PROCEDURE PROCESS_OUTPUT_OPTION
     10336**LABEL   10331--CALLALT
BAD_LN IN PROCEDURE PROCESS_OUTPUT_OPTION
     10399**LABEL   10385--CALLALT
BAD_LRDL0 IN PROCEDURE PROCESS_OUTPUT_OPTION
     10412**LABEL   10405--CALLALT
BAD_LSLIDE IN PROCEDURE PROCESS_OUTPUT_OPTION
     10425**LABEL   10418--CALLALT
BAD_MAXVOL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10436**LABEL   10431--CALLALT
BAD_NRECS IN PROCEDURE PROCESS_OUTPUT_OPTION
     10580**LABEL   10576--CALLALT
BAD_OPT IN PROCEDURE PROCESS_OPTS
      9680**PROC     9709--CALL     9718--CALL     9730--CALL     9732--CALL     9747--CALL     9818--CALL
     10173--CALL    10181--CALL    10201--CALL    10219--CALL    10250--CALL    10261--CALL    10276--CALL
     10295--CALL    10301--CALL    10325--CALL    10336--CALL    10399--CALL    10412--CALL    10425--CALL
     10436--CALL    10492--CALL    10503--CALL    10517--CALL    10529--CALL    10542--CALL    10569--CALL
     10580--CALL    10637--CALL    10645--CALL    10675--CALL    10693--CALL    10716--CALL    10749--CALL
     10894--CALL    10928--CALL    10939--CALL    10948--CALL
BAD_RECL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10503**LABEL   10498--CALLALT
BAD_RECSIZE IN PROCEDURE PROCESS_OUTPUT_OPTION
     10645**LABEL   10605--CALLALT
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:302  
BAD_SPARE IN PROCEDURE PROCESS_OUTPUT_OPTION
     10529**LABEL   10523--CALLALT
BAD_SXTN IN PROCEDURE PROCESS_OUTPUT_OPTION
     10517**LABEL   10511--CALLALT
BAD_VOL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10569**LABEL   10564--CALLALT
BAD_WIDTH IN PROCEDURE PROCESS_OUTPUT_OPTION
     10675**LABEL   10670--CALLALT
BLOCK_OFFSET IN PROCEDURE FILL_ACCESS_TBLS
     10796**DCL     10827<<ASSIGN  10832<<ASSIGN  10840<<ASSIGN  10845<<ASSIGN  10862>>IF      10865>>ASSIGN
     10879>>ASSIGN
BREAKS
      5242**DCL      9037>>IF
BREAK_LOC
      5242**DCL      5242--REDEF
CHECK_AND_PROCESS_OPT IN PROCEDURE PROCESS_OPTS
      9700**PROC     9674--CALL     9797--CALL
CMD_ABORT_ERR
      8673**DCL      9047>>DOWHILE  9048>>IF
CMD_MASK
      5244**DCL      8895>>IF       8936>>IF       8952>>IF       8996>>IF       9040>>IF       9136>>IF
      9136>>IF       9193>>IF       9652>>IF       9707>>IF       9729>>IF       9783>>IF       9801>>IF
      9863>>IF      10268>>IF      10653>>IF      10653>>IF
CNTLS IN PROCEDURE FILL_ACCESS_TBLS
     10794**DCL     10853<<ASSIGN  10858<<ASSIGN  10861<<ASSIGN  10867<<ASSIGN  10904>>ASSIGN  10957>>ASSIGN
CODE03.UGRANS
      8438**DCL      9871>>ASSIGN
CODE04.CREATION.TIME
      8449**DCL     10282>>ASSIGN
CODE16.FORM
      8453**DCL      9929>>ASSIGN
CODE18.DECFIELD
      8461**DCL      8462--REDEF
CON_DUP_IDX IN PROCEDURE PROCESS_OPTS
      9550**DCL      9741>>IF       9741>>IF       9745>>ASSIGN   9755>>ASSIGN
CON_DUP_TBL IN PROCEDURE PROCESS_OPTS
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:303  
      9388**DCL      9649<<ASSIGN   9741>>IF       9745>>ASSIGN   9755<<ASSIGN
CREATE_25TH_TSTAMP# IN PROCEDURE PROCESS_OUTPUT_OPTION
     10007**DCL     10290<>CALL    10291>>ASSIGN
CREATE_TSTAMP# IN PROCEDURE PROCESS_OUTPUT_OPTION
     10005**DCL     10270<<ASSIGN  10282<<ASSIGN  10290<>CALL
DATE_TYPE IN PROCEDURE PROCESS_OUTPUT_OPTION
     10002**DCL     10258<>CALL    10266>>DOCASE
DEFAULT_TO_ME
      8966**LABEL    8941--GOTO
DEF_ICB.FID.STRING
      5840**DCL      5841--REDEF
DEV_ICB.FID.STRING
      5726**DCL      5727--REDEF
DIN_NAME
      5533**DCL      9141--ASSIGN
DO_ORG_OPTS IN PROCEDURE PROCESS_OPTS
      9765**PROC     9663--CALL
DUP_IDX IN PROCEDURE PROCESS_OPTS
      9384**DCL      9739<<ASSIGN   9740>>DOWHILE  9741>>IF       9741>>IF       9745>>ASSIGN   9751<<ASSIGN
      9755>>ASSIGN   9756<<ASSIGN   9756>>ASSIGN   9759>>IF
EI_KEY.KEY
      5938**DCL      5938--REDEF    5938--REDEF    5938--REDEF
EO_OCB
      5392**DCL      8939>>IF       8943>>ASSIGN
EO_OCB.DEV_MASK
      5472**DCL      8966<<ASSIGN
EO_OCB.TYPE
      5438**DCL      5439--REDEF
ERROR IN PROCEDURE BAD_OPT
      9693**DCL      9680--PROC     9694<>CALL
EXPIRE_FINIS IN PROCEDURE PROCESS_OUTPUT_OPTION
     10301**LABEL   10277--GOTO
F$DCB.ACTPOS
      8175**DCL      8175--REDEF
F$DCB.ARS
      8150**DCL      8150--REDEF
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:304  
F$DCB.ATTR
      8168**DCL      8169--REDEF
F$DCB.BLKL
      8165**DCL      9152>>ASSIGN
F$DCB.BLOCKED
      8164**DCL      9155>>ASSIGN
F$DCB.BORROW
      8183**DCL      8183--REDEF    8183--REDEF    8183--REDEF
F$DCB.CNVRT
      8162**DCL      9151>>ASSIGN
F$DCB.COMP
      8163**DCL      9918>>IF
F$DCB.DCBNAME.L
      8197**DCL      8197--IMP-SIZ
F$DCB.DDEV.IC
      8156**DCL      9028>>ASSIGN
F$DCB.DDEV.LP
      8156**DCL      9029>>ASSIGN
F$DCB.EBCDIC
      8162**DCL      9154>>ASSIGN
F$DCB.EOMCHAR
      8154**DCL      8154--REDEF
F$DCB.FLDID
      8178**DCL      8178--REDEF
F$DCB.FORM$
      8172**DCL      8172--REDEF
F$DCB.FSECT
      8188**DCL      8188--REDEF
F$DCB.FSN
      8165**DCL      8165--REDEF    8165--REDEF    8166--REDEF
F$DCB.HEADER$
      8171**DCL      8171--REDEF
F$DCB.IXTNSIZE
      8169**DCL      8169--REDEF
F$DCB.KEYL
      8167**DCL      9883>>ASSIGN
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:305  
F$DCB.KEYX
      8166**DCL      9882>>ASSIGN
F$DCB.LASTSTA$
      8159**DCL      8159--REDEF
F$DCB.LVL
      8184**DCL      8184--REDEF
F$DCB.NAME.C
      8159**DCL      8159--REDEF
F$DCB.NOEOF
      8180**DCL      8180--REDEF
F$DCB.NRECS
      8170**DCL      8170--REDEF    9886>>ASSIGN
F$DCB.NRECX
      8189**DCL      8189--REDEF
F$DCB.OHDR
      8181**DCL      8181--REDEF
F$DCB.ORG
      8164**DCL      8164--REDEF    8962>>ASSIGN   9015>>IF       9150>>IF       9160>>ASSIGN   9828>>ASSIGN
      9830>>DOWHILE  9876>>IF
F$DCB.PRECNO
      8187**DCL      8187--REDEF
F$DCB.RCSZ
      8192**DCL      8192--REDEF
F$DCB.RECL
      8165**DCL      9153>>ASSIGN   9880>>ASSIGN   9885>>ASSIGN
F$DCB.RES
      8160**DCL      8160--REDEF
F$DCB.SETX
      8172**DCL      8172--REDEF
F$DCB.SPANNED
      8164**DCL      9156>>ASSIGN
F$DCB.TAB$
      8171**DCL      8172--REDEF
F$DCB.TDA
      8186**DCL      8186--REDEF
F$DCB.TYPE
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:306  
      8160**DCL      8987>>ASSIGN   9972>>ASSIGN
F$DCB.WSN
      8161**DCL      8161--REDEF
FIELD1_
      8662**DCL      9647<<ASSIGN   9694<>CALL     9706<<ASSIGN   9817<<ASSIGN
FIELD2_
      8663**DCL      9648<<ASSIGN   9694<>CALL     9728<<ASSIGN   9745<<ASSIGN
FILL$ IN PROCEDURE FILL_ACCESS_TBLS
     10800**DCL     10902<<ASSIGN  10903>>ASSIGN  10904>>ASSIGN  10905>>ASSIGN  10906>>ASSIGN  10906>>ASSIGN
     10955<<ASSIGN  10956>>ASSIGN  10957>>ASSIGN  10958>>ASSIGN
FILL_ACCESS_TBLS IN PROCEDURE PROCESS_OUTPUT_OPTION
     10775**PROC    10150--CALL    10158--CALL
FORM_DEFAULT IN PROCEDURE SET_DEFAULTS
      9862**DCL      9929<<ASSIGN   9930--ASSIGN
FPARAM$
      5243**DCL      9002>>ASSIGN   9146>>ASSIGN
FPARAM_BOUND
      5244**DCL      9147>>ASSIGN
FPARAM_BUF
      5243**DCL      9869--ASSIGN   9927--ASSIGN  10273--ASSIGN
FPT_CLOSE_EI.SN_
      6779**DCL      6779--REDEF
FPT_CLOSE_EI.UTL_
      6780**DCL      6780--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6794**DCL      6794--REDEF
FPT_CLOSE_EI.V.TYPE#
      6792**DCL      6792--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6789**DCL      6789--REDEF    6791--REDEF
FPT_CLOSE_PTL.SN_
      6905**DCL      6905--REDEF
FPT_CLOSE_PTL.UTL_
      6906**DCL      6906--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6920**DCL      6920--REDEF
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:307  
FPT_CLOSE_PTL.V.TYPE#
      6918**DCL      6918--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6915**DCL      6915--REDEF    6917--REDEF
FPT_CLOSE_READ.SN_
      6821**DCL      6821--REDEF
FPT_CLOSE_READ.UTL_
      6822**DCL      6822--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6836**DCL      6836--REDEF
FPT_CLOSE_READ.V.TYPE#
      6834**DCL      6834--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6831**DCL      6831--REDEF    6833--REDEF
FPT_CLOSE_SI.SN_
      6989**DCL      6989--REDEF
FPT_CLOSE_SI.UTL_
      6990**DCL      6990--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      7004**DCL      7004--REDEF
FPT_CLOSE_SI.V.TYPE#
      7002**DCL      7002--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6999**DCL      6999--REDEF    7001--REDEF
FPT_CLOSE_STD.SN_
      6947**DCL      6947--REDEF
FPT_CLOSE_STD.UTL_
      6948**DCL      6948--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6962**DCL      6962--REDEF
FPT_CLOSE_STD.V.TYPE#
      6960**DCL      6960--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6957**DCL      6957--REDEF    6959--REDEF
FPT_CLSEI_FT.SN_
      6863**DCL      6863--REDEF
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:308  
FPT_CLSEI_FT.UTL_
      6864**DCL      6864--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6878**DCL      6878--REDEF
FPT_CLSEI_FT.V.TYPE#
      6876**DCL      6876--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6873**DCL      6873--REDEF    6875--REDEF
FPT_FID
      8598**DCL      9079<>CALL     9192<>CALL
FPT_FID.TEXTFID_
      8598**DCL      9077<<ASSIGN   9190<<ASSIGN
FPT_FID.V
      8602**DCL      8598--DCLINIT
FPT_OPEN_EI.ACSVEH_
      6434**DCL      6435--REDEF
FPT_OPEN_EI.ALTKEYS_
      6440**DCL      6441--REDEF    6441--REDEF
FPT_OPEN_EI.HDR_
      6439**DCL      6440--REDEF
FPT_OPEN_EI.TAB_
      6438**DCL      6439--REDEF
FPT_OPEN_EI.UHL_
      6432**DCL      6433--REDEF    6433--REDEF
FPT_OPEN_EI.V.FSN#
      6472**DCL      6472--REDEF    6472--REDEF
FPT_OPEN_EI.WSN_
      6438**DCL      6438--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6543**DCL      6544--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6549**DCL      6550--REDEF    6550--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6548**DCL      6549--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6547**DCL      6548--REDEF
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:309  
FPT_OPEN_EI_SAVE.UHL_
      6541**DCL      6542--REDEF    6542--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6581**DCL      6581--REDEF    6581--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6547**DCL      6547--REDEF
FPT_OPEN_OUT
      6323**DCL      8893<<ASSIGN   8913<>CALL     9014<>CALL
FPT_OPEN_OUT.ACCESS_
      6325**DCL      8981<>CALL
FPT_OPEN_OUT.ACCT_
      6327**DCL      9259<<ASSIGN
FPT_OPEN_OUT.ACSVEH_
      6325**DCL      6326--REDEF    8984<>CALL
FPT_OPEN_OUT.ALTKEYS_
      6331**DCL      6332--REDEF    6332--REDEF
FPT_OPEN_OUT.FORM_
      6331**DCL      9930<<ASSIGN   9933<<ASSIGN  10701<<ASSIGN
FPT_OPEN_OUT.FPRG_
      6332**DCL      9004<<ASSIGN
FPT_OPEN_OUT.HDR_
      6330**DCL      6331--REDEF
FPT_OPEN_OUT.IFPARAM_
      6328**DCL      9148<<ASSIGN
FPT_OPEN_OUT.NAME_
      6324**DCL      9141<<ASSIGN   9256<<ASSIGN
FPT_OPEN_OUT.PASS_
      6325**DCL      9262<<ASSIGN
FPT_OPEN_OUT.SN_
      6323**DCL      9265<<ASSIGN
FPT_OPEN_OUT.TAB_
      6329**DCL      6330--REDEF
FPT_OPEN_OUT.UHL_
      6323**DCL      6324--REDEF    6324--REDEF    8990--ASSIGN   8991--ASSIGN   8994<<ASSIGN
FPT_OPEN_OUT.V.ACS#
      6343**DCL      9965<<ASSIGN   9967<<ASSIGN
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:310  
FPT_OPEN_OUT.V.ANSISPANSEQ#
      6356**DCL     10764<<ASSIGN  10766<<ASSIGN
FPT_OPEN_OUT.V.ASN#
      6342**DCL      8960<<ASSIGN   8969<<ASSIGN   9007>>IF       9015>>IF       9136>>IF       9272<<ASSIGN
FPT_OPEN_OUT.V.BLKL#
      6349**DCL      9007>>IF       9152<<ASSIGN  10171<<ASSIGN
FPT_OPEN_OUT.V.BLOCKED#
      6344**DCL      9155<<ASSIGN  10600<<ASSIGN
FPT_OPEN_OUT.V.BUPM#
      6345**DCL     10595<<ASSIGN  10598<<ASSIGN
FPT_OPEN_OUT.V.CNVRT#
      6352**DCL      9151<<ASSIGN  10162<<ASSIGN
FPT_OPEN_OUT.V.COMP#
      6344**DCL      9920<<ASSIGN  10228<<ASSIGN  10682<<ASSIGN
FPT_OPEN_OUT.V.COPIES#
      6364**DCL     10711<<ASSIGN
FPT_OPEN_OUT.V.CTG#
      6336**DCL      8919<<ASSIGN
FPT_OPEN_OUT.V.DCB#
      6332**DCL      8897<<ASSIGN   8899<<ASSIGN   8973>>ASSIGN
FPT_OPEN_OUT.V.DENSITY#
      6364**DCL     10239<<ASSIGN  10242<<ASSIGN  10245<<ASSIGN  10248<<ASSIGN
FPT_OPEN_OUT.V.EBCDIC#
      6352**DCL      9154<<ASSIGN  10256<<ASSIGN
FPT_OPEN_OUT.V.EXIST#
      6336**DCL      8923<<ASSIGN   8925<<ASSIGN   8927<<ASSIGN   8945<<ASSIGN   8951<<ASSIGN   9015>>IF
      9902>>IF      10653>>IF
FPT_OPEN_OUT.V.EXPIRE#
      6352**DCL     10307<<ASSIGN
FPT_OPEN_OUT.V.FSN#
      6363**DCL      6363--REDEF    6363--REDEF
FPT_OPEN_OUT.V.FUN#
      6342**DCL      8911<<ASSIGN   8920<<ASSIGN   8944<<ASSIGN   8950<<ASSIGN
FPT_OPEN_OUT.V.GHSTACS#
      6347**DCL     10741<<ASSIGN  10744<<ASSIGN  10756<<ASSIGN
FPT_OPEN_OUT.V.INITZ.REASSIGN#
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:311  
      6333**DCL      8931>>IF      10442<<ASSIGN
FPT_OPEN_OUT.V.INITZ.SCRUB#
      6333**DCL      8904<<ASSIGN   8942<<ASSIGN   8949<<ASSIGN
FPT_OPEN_OUT.V.IOERROK#
      6354**DCL     10760<<ASSIGN  10762<<ASSIGN
FPT_OPEN_OUT.V.IXTNSIZE#
      6351**DCL      9871<<ASSIGN   9874<<ASSIGN  10488<>CALL
FPT_OPEN_OUT.V.KEYL#
      6348**DCL      9883<<ASSIGN  10323<<ASSIGN
FPT_OPEN_OUT.V.KEYX#
      6347**DCL      9882<<ASSIGN  10334<<ASSIGN
FPT_OPEN_OUT.V.LOAD#
      6346**DCL     10726<<ASSIGN
FPT_OPEN_OUT.V.LRDL0#
      6350**DCL     10409<<ASSIGN
FPT_OPEN_OUT.V.LSLIDE#
      6349**DCL     10422<<ASSIGN
FPT_OPEN_OUT.V.MAXVOL#
      6358**DCL     10434<<ASSIGN
FPT_OPEN_OUT.V.NRECS#
      6351**DCL      9886<<ASSIGN  10576<>CALL
FPT_OPEN_OUT.V.OPER.TEST#
      6334**DCL      8910<<ASSIGN   8917<<ASSIGN
FPT_OPEN_OUT.V.ORG#
      6343**DCL      8962<<ASSIGN   9005<<ASSIGN   9010<<ASSIGN   9160<<ASSIGN   9162>>DOWHILE  9813<<ASSIGN
      9828<<ASSIGN   9838<<ASSIGN   9842<<ASSIGN   9951>>IF       9956<<ASSIGN   9961>>IF       9961>>IF
      9961>>IF
FPT_OPEN_OUT.V.RECL#
      6349**DCL      9007>>IF       9153<<ASSIGN   9158<<ASSIGN   9158>>ASSIGN   9880<<ASSIGN   9885<<ASSIGN
     10501<<ASSIGN
FPT_OPEN_OUT.V.RES#
      6347**DCL      8968<<ASSIGN   9007>>IF       9271<<ASSIGN
FPT_OPEN_OUT.V.SHARE#
      6337**DCL     10651<<ASSIGN
FPT_OPEN_OUT.V.SPANNED#
      6345**DCL      9156<<ASSIGN   9157>>IF      10592<<ASSIGN
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:312  
FPT_OPEN_OUT.V.SPARE#
      6350**DCL     10526<<ASSIGN
FPT_OPEN_OUT.V.TYPE#
      6344**DCL      8987<<ASSIGN   9897<<ASSIGN   9972<<ASSIGN  10550<<ASSIGN
FPT_OPEN_OUT.V.VOL#
      6357**DCL      9913<<ASSIGN  10567<<ASSIGN
FPT_OPEN_OUT.V.VOLACCESS#
      6361**DCL     10313<<ASSIGN  10315<<ASSIGN  10317<<ASSIGN
FPT_OPEN_OUT.V.XTEND#
      6353**DCL     10309<<ASSIGN
FPT_OPEN_OUT.V.XTNSIZE#
      6351**DCL     10514<<ASSIGN
FPT_OPEN_OUT.WSN_
      6329**DCL      6329--REDEF    9268<<ASSIGN
FPT_OPEN_OUT_SAVE
      6214**DCL      8893>>ASSIGN
FPT_OPEN_OUT_SAVE.ACSVEH_
      6216**DCL      6217--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6222**DCL      6223--REDEF    6223--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6221**DCL      6222--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6220**DCL      6221--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6214**DCL      6215--REDEF    6215--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6254**DCL      6254--REDEF    6254--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6220**DCL      6220--REDEF
FPT_READ_STD.STATION_
      6644**DCL      6645--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6656**DCL      6656--REDEF
FPT_READ_STD.V.INDX#
      6654**DCL      6654--REDEF
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:313  
FPT_READ_UC.STATION_
      6605**DCL      6606--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6617**DCL      6617--REDEF
FPT_READ_UC.V.INDX#
      6615**DCL      6615--REDEF
FPT_WRITE_ME.STATION_
      6713**DCL      6713--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6720**DCL      6720--REDEF
FPT_WRITE_OUT.STATION_
      6744**DCL      6744--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6751**DCL      6751--REDEF
FPT_WRITE_UC.STATION_
      6682**DCL      6682--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6689**DCL      6689--REDEF
FROM_SN.SN
      5588**DCL      5589--REDEF
GETCMD.OUT$
      4795**DCL      4801--REDEF
GET_OUT_DEV_MASK
      9276**PROC     8906--CALL     9080--CALL
GOOD_BLKL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10171**LABEL   10172--GOTO
GOOD_CS IN PROCEDURE PROCESS_OUTPUT_OPTION
     10223**LABEL   10218--GOTO
GOOD_IXTN IN PROCEDURE PROCESS_OUTPUT_OPTION
     10490**LABEL   10491--GOTO
GOOD_KEYL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10323**LABEL   10324--GOTO
GOOD_KEYX IN PROCEDURE PROCESS_OUTPUT_OPTION
     10334**LABEL   10335--GOTO
GOOD_LN IN PROCEDURE PROCESS_OUTPUT_OPTION
     10397**LABEL   10398--GOTO
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:314  
GOOD_LRDL0 IN PROCEDURE PROCESS_OUTPUT_OPTION
     10410**LABEL   10411--GOTO
GOOD_LSLIDE IN PROCEDURE PROCESS_OUTPUT_OPTION
     10423**LABEL   10424--GOTO
GOOD_MAXVOL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10434**LABEL   10435--GOTO
GOOD_NRECS IN PROCEDURE PROCESS_OUTPUT_OPTION
     10578**LABEL   10579--GOTO
GOOD_RECL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10501**LABEL   10502--GOTO
GOOD_RECSIZE IN PROCEDURE PROCESS_OUTPUT_OPTION
     10645**LABEL   10638--GOTO    10644--GOTO
GOOD_SPARE IN PROCEDURE PROCESS_OUTPUT_OPTION
     10527**LABEL   10528--GOTO
GOOD_SXTN IN PROCEDURE PROCESS_OUTPUT_OPTION
     10515**LABEL   10516--GOTO
GOOD_VOL IN PROCEDURE PROCESS_OUTPUT_OPTION
     10569**LABEL   10568--GOTO
HIGHEST_SEV IN PROCEDURE PROCESS_OPTS
      9380**DCL      9651<<ASSIGN   9665<>CALL     9677<>CALL     9695>>IF       9697<<ASSIGN
I
      8659**DCL      9001<<ASSIGN   9003<>CALL     9046<<ASSIGN   9047>>DOWHILE  9048>>IF       9052<<ASSIGN
      9052>>ASSIGN   9073<<DOINDEX  9074>>IF       9077>>ASSIGN   9077>>ASSIGN   9119>>CALL
I IN PROCEDURE FILL_ACCESS_TBLS
     10797**DCL     10866<<DOINDEX 10867>>ASSIGN  10880<<DOINDEX 10881>>ASSIGN  10882>>ASSIGN  10882>>ASSIGN
I IN PROCEDURE PROCESS_OPTS
      9381**DCL      9912<>CALL     9913>>ASSIGN  10343<<DOINDEX 10344>>DOCASE
ICB.FID.STRING
      5612**DCL      5613--REDEF
ICB.FLAVOR.LTOORG
      5670**DCL      9801>>IF
ICB.FLAVOR.MANAGED
      5677**DCL      9801>>IF       9866>>IF
ICB.FLAVOR.UR
      5679**DCL      9951>>IF
ICB.SPEC_TYPE
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:315  
      5609**DCL      9136>>IF
IDX IN PROCEDURE PROCESS_FID
      9188**DCL      9241<<CALLBLT  9242>>IF
IFSFA_PARAM.EOMCHAR#
      5967**DCL      5968--REDEF
IFSFA_PARAM.SIG1
      5961**DCL      5961--REDEF
IFSFA_PARAM.SIG2
      5961**DCL      5962--REDEF
IN_RES
      5534**DCL      5534--REDEF
IN_SN.SN
      5550**DCL      5551--REDEF
J IN PROCEDURE PROCESS_OUTPUT_OPTION
      9997**DCL     10191<<ASSIGN  10192>>DOWHILE 10193>>IF      10195>>IF      10198>>ASSIGN  10198>>ASSIGN
     10207>>CALL    10210>>IF      10216<<ASSIGN  10216>>ASSIGN  10233<>CALL    10237>>IF      10240>>IF
     10243>>IF      10246>>IF      10258<>CALL    10378<<ASSIGN  10379>>DOWHILE 10382>>IF      10385>>CALL
     10389>>IF      10395<<ASSIGN  10395>>ASSIGN  10475<<DOINDEX 10476>>DOCASE  10602<<DOINDEX 10603>>IF
     10605>>CALL    10608>>DOCASE
K IN PROCEDURE PROCESS_OUTPUT_OPTION
      9998**DCL     10381<<ASSIGN
M$EI
      6003**DCL      9068>>ASSIGN
M$EI$
      6003**DCL      8962>>ASSIGN   8987>>ASSIGN   9150>>IF       9151>>ASSIGN   9152>>ASSIGN   9153>>ASSIGN
      9154>>ASSIGN   9155>>ASSIGN   9156>>ASSIGN   9160>>ASSIGN   9828>>ASSIGN   9830>>DOWHILE  9876>>IF
      9880>>ASSIGN   9882>>ASSIGN   9883>>ASSIGN   9885>>ASSIGN   9886>>ASSIGN   9918>>IF       9972>>ASSIGN
M$EO
      6003**DCL      8897>>ASSIGN
M$EO1
      6003**DCL      8899>>ASSIGN
M$OPEN
        52**DCL-ENT  8913--CALL
NAME#
      8650**DCL      8599--DCLINIT  9101<>CALL     9104>>ASSIGN   9106<>CALL     9208<>CALL     9217>>ASSIGN
      9218<>CALL     9256--ASSIGN
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:316  
NAME#.C
      8652**DCL      9241>>CALLBLT
NAME#.L
      8651**DCL      9242>>IF
NAME_AND_FPARAM
      9123**PROC     8930--CALL     8957--CALL
NAME_SPEC_TYPE
      8578**DCL      9098<<ASSIGN   9101<>CALL     9102>>IF
NAME_SPEC_TYPE IN PROCEDURE PROCESS_FID
      9184**DCL      9205<<ASSIGN   9208<>CALL     9209>>IF       9212>>IF       9212>>IF
NOLBLS
      8994**LABEL    8989--GOTO
NOW_UTS
      5241**DCL     10270>>ASSIGN
NO_CODE_3 IN PROCEDURE SET_DEFAULTS
      9876**LABEL    9870--CALLALT
NO_DUMP IN PROCEDURE RECONCILE_DEFAULTS_AFTER_OPEN
      9347**LABEL    9332--GOTO
NO_FORM_DEFAULT IN PROCEDURE SET_DEFAULTS
      9930**LABEL    9926--GOTO     9928--CALLALT
NUM IN PROCEDURE PROCESS_OUTPUT_OPTION
     10008**DCL     10380<<ASSIGN  10385<>CALL    10391>>ASSIGN  10393>>ASSIGN  10746<<CALLBLT 10747>>IF
     10755>>ASSIGN  10756>>ASSIGN
OCB
      5250**DCL      8903<<ASSIGN   8943<<ASSIGN   8955<<ASSIGN   8958<<ASSIGN   8967<<ASSIGN   9067<<ASSIGN
OCB.ACCESS.LEN
      5303**DCL     10945>>IF      10955>>ASSIGN  10959<<ASSIGN  10959>>ASSIGN
OCB.ACCESS.LIST
      5304**DCL     10955--ASSIGN
OCB.ACCESS_FLG
      5329**DCL      8979>>IF      10147<<ASSIGN
OCB.ACCESS_REPLACE
      5328**DCL     10152<<ASSIGN  10936<<ASSIGN
OCB.ACSVEH.LEN
      5300**DCL     10891>>IF      10902>>ASSIGN  10907<<ASSIGN  10907>>ASSIGN
OCB.ACSVEH.LIST
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:317  
      5301**DCL     10902--ASSIGN
OCB.ACSVEH_FLG
      5327**DCL      8982>>IF      10155<<ASSIGN
OCB.ACSVEH_REPLACE
      5326**DCL     10160<<ASSIGN  10890<<ASSIGN
OCB.ALTBLD
      5316**DCL     10734<<ASSIGN  10736<<ASSIGN
OCB.BACKUP
      5309**DCL     10594<<ASSIGN  10597<<ASSIGN
OCB.BIN
      5268**DCL     10164<<ASSIGN  10166<<ASSIGN
OCB.COMP
      5270**DCL     10227<<ASSIGN  10681<<ASSIGN
OCB.COPIES
      5322**DCL     10710<<ASSIGN  10711>>ASSIGN
OCB.COPIES_FLG
      5323**DCL     10712<<ASSIGN
OCB.CRPT
      5253**DCL     10179<>CALL
OCB.CR_NCR
      5267**DCL     10225<<ASSIGN  10446<<ASSIGN
OCB.CS.CURRENT
      5264**DCL     10223<<ASSIGN
OCB.CS.ID
      5261**DCL     10198<<ASSIGN
OCB.CS.ID.C
      5263**DCL     10450<<ASSIGN
OCB.CS.ID.L
      5262**DCL     10188<<ASSIGN  10449<<ASSIGN
OCB.CS.K
      5266**DCL     10190<<ASSIGN  10214<<ASSIGN
OCB.CS.N
      5265**DCL     10189<<ASSIGN  10212<<ASSIGN  10223>>ASSIGN
OCB.CS.SPEC
      5260**DCL     10187<<ASSIGN  10448<<ASSIGN
OCB.DCBNM
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:318  
      5251**DCL      8973<<ASSIGN   8974--ASSIGN   9034<>CALL     9042<>CALL     9050<>CALL     9054<>CALL
      9068<<ASSIGN   9069--ASSIGN
OCB.DCBPTR$
      5252**DCL      8974<<ASSIGN   9015>>IF       9028>>ASSIGN   9029>>ASSIGN   9069<<ASSIGN
OCB.DEV_MASK
      5330**DCL      8907>>IF       8961<<ASSIGN   8970<<ASSIGN   9070<<ASSIGN   9299<<ASSIGN   9301<<ASSIGN
      9306<<ASSIGN   9308<<ASSIGN   9310<<ASSIGN   9715>>IF       9801>>IF       9801>>IF       9814>>IF
      9836>>IF       9909>>IF
OCB.DEV_MASK.DEVICE
      5333**DCL      8996>>IF
OCB.DEV_MASK.IC
      5334**DCL      9028<<ASSIGN
OCB.DEV_MASK.LP
      5335**DCL      9029<<ASSIGN
OCB.ERR_SAVE
      5386**DCL     10732<<ASSIGN
OCB.EXPIRE
      5314**DCL     10291<<ASSIGN  10293>>IF      10299<<ASSIGN  10307>>ASSIGN
OCB.FLAVOR.CARRY_ATTR
      5340**DCL      8956<<ASSIGN   8959<<ASSIGN   8976>>IF       9142>>IF       9808<<ASSIGN   9825>>IF
      9893>>IF       9924>>IF       9968>>IF
OCB.FLAVOR.FORMATTED
      5341**DCL      8996>>IF       9792<<ASSIGN   9801>>IF
OCB.FLAVOR.TAPE
      5346**DCL      9032>>IF
OCB.FORM
      5324**DCL     10700<<ASSIGN  10701--ASSIGN
OCB.FORM_FLG
      5325**DCL     10699<<ASSIGN
OCB.FVFC
      5276**DCL     10586<<ASSIGN
OCB.GHSTACS
      5298**DCL     10740<<ASSIGN  10743<<ASSIGN  10755<<ASSIGN
OCB.HEAD
      5357**DCL     10686<<ASSIGN  10688<<ASSIGN
OCB.KEY.DVBYTE
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:319  
      5381**DCL      9341>>IF       9343<<ASSIGN  10358<<ASSIGN  10360<<ASSIGN
OCB.KEY.FORMAT
      5373**DCL      9333>>IF
OCB.KEY.FORMAT.C
      5377**DCL      9338<<ASSIGN  10352<<ASSIGN
OCB.KEY.FORMAT.E
      5379**DCL      9339<<ASSIGN  10356<<ASSIGN
OCB.KEY.FORMAT.O
      5376**DCL      9337<<ASSIGN  10350<<ASSIGN
OCB.KEY.FORMAT.S
      5378**DCL      9336<<ASSIGN  10354<<ASSIGN
OCB.KEY.FORMAT.X
      5374**DCL     10346<<ASSIGN
OCB.KEY.FORMAT.X1
      5375**DCL     10348<<ASSIGN
OCB.KEY.ONDATA
      5383**DCL      9347>>IF       9349<<ASSIGN  10366<<ASSIGN  10368<<ASSIGN
OCB.KEY.RECSIZ
      5382**DCL      9344>>IF       9346<<ASSIGN  10362<<ASSIGN  10364<<ASSIGN
OCB.KEYS
      5278**DCL     10342<<ASSIGN
OCB.LN.CURRENT
      5284**DCL     10397<<ASSIGN  10463<<ASSIGN
OCB.LN.K
      5286**DCL     10377<<ASSIGN  10393<<ASSIGN  10397>>ASSIGN  10462<<ASSIGN
OCB.LN.KEY.LEN
      5282**DCL     10375<<ASSIGN  10464<<ASSIGN
OCB.LN.N
      5285**DCL     10376<<ASSIGN  10391<<ASSIGN  10397>>ASSIGN  10461<<ASSIGN
OCB.LRDL0
      5310**DCL     10410<<ASSIGN
OCB.LSLIDE
      5311**DCL     10423<<ASSIGN
OCB.MOD_NAME
      5317**DCL      9104<<ASSIGN   9106<>CALL
OCB.MOD_PASS
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:320  
      5320**DCL      9113<<ASSIGN   9115<<ASSIGN
OCB.MOD_PASS_FLG
      5321**DCL      9110<<ASSIGN
OCB.NB
      5287**DCL     10444<<ASSIGN
OCB.NEWKEY
      5271**DCL     10590<<ASSIGN
OCB.NFA
      5277**DCL      9142>>IF       9968>>IF      10452<<ASSIGN
OCB.OCT_HEX.DUPE
      5292**DCL     10478<<ASSIGN  10480<<ASSIGN
OCB.OCT_HEX.TEXT
      5291**DCL     10482<<ASSIGN  10484<<ASSIGN
OCB.OCT_HEX.TYPE
      5290**DCL      9330>>IF      10469<<ASSIGN  10471<<ASSIGN  10473<<ASSIGN
OCB.ORG
      5288**DCL      9007>>IF       9011<<ASSIGN   9015>>IF       9015>>IF       9159>>IF       9161<<ASSIGN
      9162>>DOWHILE  9162>>DOWHILE  9164<<ASSIGN   9164>>ASSIGN   9809>>IF       9812>>ASSIGN   9957<<ASSIGN
     10374<<ASSIGN  10454<<ASSIGN  10457<<ASSIGN
OCB.PAGE
      5358**DCL     10722<<ASSIGN  10724<<ASSIGN
OCB.REBUILD
      5315**DCL     10658<<ASSIGN
OCB.RECSIZE.MAX_SIZE
      5258**DCL     10613<<ASSIGN  10616<<ASSIGN  10619>>IF      10624<<ASSIGN  10631<<ASSIGN  10633>>IF
OCB.RECSIZE.MAX_SPEC
      5257**DCL     10614<<ASSIGN  10619>>IF      10623<<ASSIGN  10626>>IF      10630<<ASSIGN  10633>>IF
OCB.RECSIZE.MIN_SIZE
      5256**DCL     10610<<ASSIGN  10616>>ASSIGN  10619>>IF      10624>>ASSIGN  10626>>IF      10633>>IF
OCB.RECSIZE.MIN_SPEC
      5255**DCL     10611<<ASSIGN  10619>>IF      10626>>IF      10633>>IF
OCB.RELEASE
      5295**DCL      9904<<ASSIGN  10509<<ASSIGN  10588<<ASSIGN
OCB.SPARE
      5312**DCL     10527<<ASSIGN
OCB.SPARE1
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:321  
      5389**DCL     10772<<ASSIGN
OCB.SPARE2
      5388**DCL     10770<<ASSIGN
OCB.SPARE3
      5387**DCL     10768<<ASSIGN
OCB.SUMMARY
      5385**DCL     10728<<ASSIGN  10730<<ASSIGN
OCB.TRANS
      5269**DCL     10660<<ASSIGN  10684<<ASSIGN
OCB.TX
      5308**DCL     10538<<ASSIGN
OCB.TYPE
      5296**DCL      5297--REDEF    9896<<ASSIGN  10547<<ASSIGN  10550>>ASSIGN
OCB.TYPE_BIT
      5297**DCL      8985>>IF       9968>>IF
OCB.UC_LC
      5279**DCL     10372<<ASSIGN  10553<<ASSIGN
OCB.VFC
      5275**DCL      9951>>IF      10555<<ASSIGN  10557<<ASSIGN  10559<<ASSIGN
OCB.VFC_CHAR
      5272**DCL     10230<<ASSIGN  10535<<ASSIGN
OCB.VFC_USE
      5273**DCL     10231<<ASSIGN  10536<<ASSIGN
OCB.WIDTH.SIZE
      5356**DCL     10670<>CALL
OCB.WIDTH.SPEC
      5355**DCL     10673<<ASSIGN
OCB.WRAP
      5353**DCL     10664<<ASSIGN  10666<<ASSIGN  10668<<ASSIGN
OCB.XTNSIZE
      5313**DCL     10515<<ASSIGN
OFSFA_PARAM.EOMCHAR#
      5997**DCL      5998--REDEF
OFSFA_PARAM.SIG1
      5991**DCL      5991--REDEF
OFSFA_PARAM.SIG2
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:322  
      5991**DCL      5992--REDEF
ONE_FILE
      9104**LABEL    9099--GOTO
OPEN_IT
      9010**LABEL    9003--CALLALT  9039--GOTO
OPEN_OUT_ALT
      9037**LABEL    9014--CALLALT
OPTION$ IN PROCEDURE PROCESS_OUTPUT_OPTION
      9990**DCL      9976--PROC    10144>>DOCASE  10148>>IF      10156>>IF      10168>>CALL    10179>>CALL
     10192>>DOWHILE 10193>>IF      10195>>IF      10198>>ASSIGN  10198>>ASSIGN  10207>>CALL    10210>>IF
     10233>>CALL    10258>>CALL    10311>>DOCASE  10320>>CALL    10331>>CALL    10343>>DOINDEX 10344>>DOCASE
     10379>>DOWHILE 10382>>IF      10385>>CALL    10405>>CALL    10418>>CALL    10431>>CALL    10456>>ASSIGN
     10467>>DOSELCT 10475>>DOINDEX 10476>>DOCASE  10488>>CALL    10498>>CALL    10511>>CALL    10523>>CALL
     10540>>IF      10547>>ASSIGN  10547>>ASSIGN  10564>>CALL    10576>>CALL    10602>>DOINDEX 10603>>IF
     10605>>CALL    10608>>DOCASE  10662>>IF      10666>>ASSIGN  10670>>CALL    10690>>ASSIGN  10704>>CALL
     10738>>DOCASE  10746>>CALLBLT 10746>>CALLBLT 10818>>IF      10818>>IF      10818>>IF      10818>>IF
     10823>>IF      10826>>ASSIGN  10835>>IF      10835>>IF      10839>>ASSIGN  10850>>IF      10850>>IF
     10855>>IF      10855>>IF      10862>>IF      10865>>ASSIGN  10879>>ASSIGN  10883>>IF      10883>>IF
     10883>>IF
OPTIONS$ IN PROCEDURE PROCESS_OPTS
      9379**DCL      9655<<ASSIGN   9660<<ASSIGN   9666>>DOINDEX  9667>>ASSIGN   9761>>CALL     9785>>DOINDEX
      9786>>ASSIGN
OPTION_CODE IN PROCEDURE PROCESS_OPTS
      9385**DCL      9667<<ASSIGN   9668>>IF       9668>>IF       9668>>IF       9706>>ASSIGN   9707>>IF
      9715>>IF       9724>>IF       9741>>IF       9741>>IF       9745>>ASSIGN   9755>>ASSIGN   9755>>ASSIGN
      9786<<ASSIGN   9787>>IF       9787>>IF       9787>>IF       9787>>IF       9793>>IF       9793>>IF
      9793>>IF
OPTS$ IN PROCEDURE PROCESS_OPTS
      9375**DCL      9355--PROC     9640--ENTRY    9655>>ASSIGN
OPT_IDX IN PROCEDURE PROCESS_OPTS
      9383**DCL      9666<<DOINDEX  9667>>ASSIGN   9761>>CALL     9785<<DOINDEX  9786>>ASSIGN
OPT_START
      8664**DCL      9656<<ASSIGN   9661<<ASSIGN   9666>>DOINDEX  9785>>DOINDEX
OPT_TABLE.CMD_ALLOWED IN PROCEDURE PROCESS_OPTS
      9519**DCL      9707>>IF
OPT_TABLE.DEV_ALLOWED IN PROCEDURE PROCESS_OPTS
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:323  
      9488**DCL      9715>>IF
OPT_TABLE.NAME IN PROCEDURE PROCESS_OPTS
      9396**DCL      9706--ASSIGN   9745--ASSIGN
OPT_TABLE.ORG_ALLOWED IN PROCEDURE PROCESS_OPTS
      9440**DCL      9724>>IF
ORG_CODE IN PROCEDURE PROCESS_OPTS
      9386**DCL      9728>>ASSIGN   9812<<ASSIGN   9813>>ASSIGN   9814>>IF       9817>>ASSIGN   9829<<ASSIGN
      9830>>DOWHILE  9830>>DOWHILE  9832<<ASSIGN   9832>>ASSIGN   9839<<ASSIGN   9843<<ASSIGN   9846>>ASSIGN
      9876>>IF       9878>>DOCASE  10456<<ASSIGN  10457>>ASSIGN  10458>>IF
ORG_MASK IN PROCEDURE PROCESS_OPTS
      9387**DCL      9650<<ASSIGN   9724>>IF       9724>>IF       9845<<ASSIGN   9846<<ASSIGN   9958<<ASSIGN
      9959<<ASSIGN
ORG_TBL.NAME
      5934**DCL      9728--ASSIGN   9817--ASSIGN
ORG_TBL.ORG_MON
      5934**DCL      9015>>IF       9162>>DOWHILE  9813>>ASSIGN   9830>>DOWHILE  9876>>IF
ORG_TBL.OUT_DEV_ALLOWED
      5935**DCL      9814>>IF
OUT$BLK.CODE
      8484**DCL      8921>>DOCASE   9074>>IF       9667>>ASSIGN   9786>>ASSIGN  10144>>DOCASE  10193>>IF
     10210>>IF      10311>>DOCASE  10344>>DOCASE  10456>>ASSIGN  10467>>DOSELCT 10476>>DOCASE  10603>>IF
     10608>>DOCASE  10666>>ASSIGN  10738>>DOCASE  10818>>IF      10818>>IF      10818>>IF      10818>>IF
     10826>>ASSIGN  10839>>ASSIGN  10850>>IF      10850>>IF      10855>>IF      10855>>IF      10867>>ASSIGN
     10883>>IF      10883>>IF      10883>>IF
OUT$BLK.NSUBLKS
      8488**DCL      9073>>DOINDEX  9666>>DOINDEX  9785>>DOINDEX 10148>>IF      10156>>IF      10192>>DOWHILE
     10343>>DOINDEX 10379>>DOWHILE 10382>>IF      10475>>DOINDEX 10602>>DOINDEX 10662>>IF      10823>>IF
     10835>>IF      10835>>IF      10862>>IF      10866>>DOINDEX 10880>>DOINDEX
OUT$BLK.SUBLK$
      8509**DCL      8921>>DOCASE   9074>>IF       9077>>ASSIGN   9077>>ASSIGN   9119<>CALL     9190>>ASSIGN
      9190>>ASSIGN   9190>>ASSIGN   9190>>ASSIGN   9667>>ASSIGN   9761<>CALL     9786>>ASSIGN  10168>>CALL
     10168<>CALL    10179<>CALL    10193>>IF      10195>>IF      10195>>IF      10198>>ASSIGN  10198>>ASSIGN
     10198>>ASSIGN  10198>>ASSIGN  10207>>CALL    10207<>CALL    10210>>IF      10233>>CALL    10233<>CALL
     10258<>CALL    10311>>DOCASE  10320>>CALL    10320<>CALL    10331>>CALL    10331<>CALL    10344>>DOCASE
     10382>>IF      10385<>CALL    10405>>CALL    10418>>CALL    10431>>CALL    10431<>CALL    10456>>ASSIGN
     10476>>DOCASE  10488>>CALL    10488<>CALL    10498>>CALL    10498<>CALL    10511>>CALL    10511<>CALL
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:324  
     10523>>CALL    10523<>CALL    10540>>IF      10540>>IF      10547>>ASSIGN  10547>>ASSIGN  10547>>ASSIGN
     10547>>ASSIGN  10564>>CALL    10564<>CALL    10576>>CALL    10576<>CALL    10603>>IF      10605>>CALL
     10605<>CALL    10608>>DOCASE  10666>>ASSIGN  10670>>CALL    10670<>CALL    10690>>ASSIGN  10690>>ASSIGN
     10704>>CALL    10704<>CALL    10738>>DOCASE  10746>>CALLBLT 10746>>CALLBLT 10746>>CALLBLT 10746>>CALLBLT
     10826>>ASSIGN  10835>>IF      10839>>ASSIGN  10865>>ASSIGN  10867>>ASSIGN  10879>>ASSIGN  10881>>ASSIGN
     10882>>ASSIGN  10882>>ASSIGN
OUT$SYM.COUNT
      8545**DCL      8548--IMP-SIZ  9077>>ASSIGN  10881>>ASSIGN  10882>>ASSIGN
OUT$SYM.TEXT
      8548**DCL      9077--ASSIGN  10882>>ASSIGN
OUT$SYM.TEXTC$
      8540**DCL     10405<>CALL    10418<>CALL
OUTPUT_ERR
      5172**DCL      9042<>CALL     9050<>CALL     9054<>CALL
OUTPUT_ERR.ERR#
      5202**DCL      9037>>IF       9037>>IF       9048>>IF
OUT_FID_GIVEN
      8668**DCL      8894<<ASSIGN   8931>>IF       9233<<ASSIGN
OUT_FILE_EXISTS
      8667**DCL      8912<<ASSIGN   8915<<ASSIGN   9902>>IF      10653>>IF
OUT_SN
      5563**DCL      8600--DCLINIT  9034<>CALL     9265--ASSIGN   9912<>CALL
OUT_SN.SN
      5568**DCL      5569--REDEF
OUT_SPEC$
      8422**DCL        12--PROC     8900>>IF       8921>>DOCASE   9058--ENTRY    9073>>DOINDEX  9074>>IF
      9077>>ASSIGN   9077>>ASSIGN   9119>>CALL     9136>>IF       9190>>ASSIGN   9190>>ASSIGN   9660>>ASSIGN
PASS#
      8654**DCL      8600--DCLINIT  8655--REDEF    9115>>ASSIGN   9262--ASSIGN
PASSB#
      8655**DCL      9111>>IF
PROCESS_FID
      9169**PROC     8905--CALL
PROCESS_MOD_OPTS IN PROCEDURE PROCESS_OPTS
      9640**ENTRY    9119--CALL
PROCESS_OPTS
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:325  
      9355**PROC     8929--CALL
PROCESS_OUTPUT_OPTION IN PROCEDURE PROCESS_OPTS
      9976**PROC     9761--CALL
PTR$
      8661**DCL      9002<<ASSIGN   9003<>CALL     9004>>ASSIGN   9869<<ASSIGN   9870<>CALL     9871>>ASSIGN
      9927<<ASSIGN   9928<>CALL     9929>>ASSIGN  10273<<ASSIGN  10274<>CALL    10282>>ASSIGN
PTR$ IN PROCEDURE FILL_ACCESS_TBLS
     10799**DCL     10865<<ASSIGN  10866>>DOINDEX 10867>>ASSIGN  10879<<ASSIGN  10880>>DOINDEX 10881>>ASSIGN
     10882>>ASSIGN  10882>>ASSIGN
QUIT IN PROCEDURE FILL_ACCESS_TBLS
     10963**LABEL   10895--GOTO    10949--GOTO
RECONCILE_DEFAULTS_AFTER_OPEN
      9315**PROC     9031--CALL
RECONCILE_DEFAULTS_BEFORE_OPEN IN PROCEDURE PROCESS_OPTS
      9941**PROC     9676--CALL
RES IN PROCEDURE GET_OUT_DEV_MASK
      9296**DCL      9303<<ASSIGN   9304>>IF       9304>>IF
RES#
      8658**DCL      8601--DCLINIT  9271>>ASSIGN   9303>>ASSIGN   9715>>IF
RESULTS_FID
      8621**DCL      8602--DCLINIT
RESULTS_FID.ACCT
      8621**DCL      9083<<ASSIGN   9084>>IF       9257>>IF
RESULTS_FID.NAME
      8621**DCL      9092>>IF       9136>>IF       9136>>IF       9199>>IF       9214<<ASSIGN   9231>>IF
      9254>>IF
RESULTS_FID.PASS
      8621**DCL      9108>>IF       9260>>IF
RESULTS_FID.RES
      8621**DCL      9269>>IF
RESULTS_FID.SN
      8621**DCL      9084>>IF       9263>>IF
RESULTS_FID.TYPE.NAME
      8622**DCL      9095>>IF       9202>>IF       9238>>IF
RESULTS_FID.WSN
      8621**DCL      9084>>IF       9266>>IF
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:326  
SAV_25TH_TSTAMP# IN PROCEDURE PROCESS_OUTPUT_OPTION
     10006**DCL     10289<>CALL    10291>>ASSIGN
SAV_TSTAMP# IN PROCEDURE PROCESS_OUTPUT_OPTION
     10004**DCL     10258<>CALL    10289<>CALL
SET_DEFAULTS IN PROCEDURE PROCESS_OPTS
      9849**PROC     9664--CALL
SEVERITY IN PROCEDURE BAD_OPT
      9692**DCL      9680--PROC     9695>>IF       9697>>ASSIGN
SINGLE_FILE IN PROCEDURE PROCESS_FID
      9211**LABEL    9206--GOTO
SPEC_BUF
      5246**DCL      5246--REDEF
SPEC_TYPE IN PROCEDURE FILL_ACCESS_TBLS
     10795**DCL     10826<<ASSIGN  10831<<ASSIGN  10839<<ASSIGN  10844<<ASSIGN  10871>>IF      10873<<ASSIGN
     10888>>IF      10903>>ASSIGN  10934>>IF      10956>>ASSIGN
T$ IN PROCEDURE PROCESS_OUTPUT_OPTION
     10001**DCL     10690<<ASSIGN  10691>>IF      10700>>ASSIGN  10700>>ASSIGN
TEXT$C
      8569**DCL     10198>>ASSIGN
TEXT$C.LEN
      8570**DCL      8571--IMP-SIZ  9190>>ASSIGN  10195>>IF      10198>>ASSIGN  10540>>IF      10547>>ASSIGN
     10691>>IF      10700>>ASSIGN  10746>>CALLBLT
TEXT$C.STRING
      8571**DCL      9190--ASSIGN  10547>>ASSIGN  10700>>ASSIGN  10746>>CALLBLT
TEXTC.LEN IN PROCEDURE FILL_ACCESS_TBLS
     10802**DCL     10881<<ASSIGN  10891>>IF      10905>>ASSIGN  10907>>ASSIGN  10914>>ASSIGN  10915<<ASSIGN
     10915>>ASSIGN  10918>>IF      10922>>ASSIGN  10923<<ASSIGN  10923>>ASSIGN  10937>>IF
TEXTC.STRING IN PROCEDURE FILL_ACCESS_TBLS
     10803**DCL     10882<<ASSIGN  10906>>ASSIGN  10911>>IF      10914<<ASSIGN  10914>>ASSIGN  10918>>IF
     10918>>IF      10922<<ASSIGN  10922>>ASSIGN  10926>>CALLBLT 10958>>ASSIGN
TMP IN PROCEDURE FILL_ACCESS_TBLS
     10798**DCL     10926<<CALLBLT
TNAME# IN PROCEDURE PROCESS_FID
      9185**DCL      9217<<ASSIGN   9218<>CALL
TOT_FILES
      5245**DCL     10561>>IF
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:327  
TWORD IN PROCEDURE PROCESS_OUTPUT_OPTION
     10000**DCL     10168<>CALL    10171>>ASSIGN  10207<>CALL    10212>>ASSIGN  10214>>ASSIGN  10320<>CALL
     10323>>ASSIGN  10331<>CALL    10334>>ASSIGN  10405<>CALL    10409>>ASSIGN  10410>>ASSIGN  10418<>CALL
     10422>>ASSIGN  10423>>ASSIGN  10431<>CALL    10434>>ASSIGN  10498<>CALL    10501>>ASSIGN  10511<>CALL
     10514>>ASSIGN  10515>>ASSIGN  10523<>CALL    10526>>ASSIGN  10527>>ASSIGN  10564<>CALL    10567>>ASSIGN
     10605<>CALL    10610>>ASSIGN  10613>>ASSIGN  10704<>CALL    10707>>IF      10710>>ASSIGN
USER_LABELS$
      5239**DCL      8988>>IF       8989>>IF       8990>>ASSIGN   8991>>ASSIGN
VECTR IN PROCEDURE NAME_AND_FPARAM
      9134**DCL      9145<<ASSIGN   9146<<ASSIGN   9147<<ASSIGN   9148>>ASSIGN
VLP_FPRG
      8640**DCL      9004--ASSIGN
VPC$CALL_OPEN
      8687**DCL-ENT  9014--CALL
VPD$ANAL_NAME
      8700**DCL-ENT  9101--CALL     9208--CALL
VPD$CHECK_VOL
      8706**DCL-ENT  9034--CALL     9912--CALL
VPD$CLOSE_OUT
      8709**DCL-ENT  9021--CALL
VPD$DECI_MUNGE
      8883**DCL-ENT 10385--CALL
VPD$FID
      8724**DCL-ENT  9079--CALL     9192--CALL
VPD$GET_OUT_FLAVOR
      8744**DCL-ENT  9030--CALL     9072--CALL
VPD$MAKE_WILD_OUT
      8756**DCL-ENT  9106--CALL     9218--CALL
VPD$MNG_CRPT
      8877**DCL-ENT 10179--CALL
VPD$PROCESS_CONTROLS
      8759**DCL-ENT  8981--CALL     8984--CALL
VPD$PROCESS_DATE IN PROCEDURE PROCESS_OUTPUT_OPTION
     10012**DCL-ENT 10258--CALL
VPD$TEXTC_CHARBIN
      8766**DCL-ENT 10168--CALL    10207--CALL    10233--CALL    10320--CALL    10331--CALL    10405--CALL
PL6.E3A0      #002=VPC$SETOUT File=VPC$SETOUT.:E05TSI                            WED 07/30/97 07:20 Page:328  
     10418--CALL    10431--CALL    10488--CALL    10498--CALL    10511--CALL    10523--CALL    10564--CALL
     10576--CALL    10605--CALL    10670--CALL    10704--CALL
VPL$ERR_PROC
      8866**DCL-ENT  8933--CALL     9022--CALL     9042--CALL     9050--CALL     9054--CALL     9088--CALL
      9211--CALL     9244--CALL     9694--CALL
VPL$ERR_SEV_HANDLER
      8867**DCL-ENT  9665--CALL     9677--CALL
WSN#
      8656**DCL      8600--DCLINIT  9268--ASSIGN
XSF$LOCCODP
      8683**DCL-ENT  9003--CALL     9870--CALL     9928--CALL    10274--CALL
XUD$UTS_DIFF_25TH IN PROCEDURE PROCESS_OUTPUT_OPTION
     10113**DCL-ENT 10289--CALL    10290--CALL
ZERO_BYTE2 IN PROCEDURE PROCESS_OUTPUT_OPTION
     10016**DCL     10017--REDEF
