VERSION E05

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:1    
        1        1        /*M*     Builds tables desired by TIGR MON command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X*/
        9        9        /*P*     NAME:     ITM$MON
       10       10                 PURPOSE:  ITM$MON builds and initializes the tables and data
       11       11                           locations defined by the options of the TIGR MON
       12       12                           command                       */
       13       13        ITM$MON: PROC (PTR$) ALTRET;
       14       14        /**/
       15       15    1   DCL PTR$ PTR;                           /* POINTER TO TIGR TABLE SPACE        */
       16       16        /**/
       17       17        /*  INCLUDE FILES */
       18       18        /**/
       19       19        %INCLUDE IT_SUBS_C;
       20      286        %INCLUDE IT_ERROR_C;
       21      369        %INCLUDE NI_DATA_C;
       22      482        %INCLUDE MM_DATA_R;
       23     1002        %INCLUDE HF_DATA_R;
       24     1045        %INCLUDE B_MLSMAC_C;
       25     1987        %B_MLS (FPTN=B$MLNK,STCLASS=BASED);
       26     2802        %INCLUDE B_SEGIDS_C;
       27     3341        %INCLUDE SS_SCHED_C;
       28     3574        %INCLUDE SS_SCHED_R;
       29     3617        %INCLUDE B$P;
       30     3701        %INCLUDE NI_DATA_R;
       31     4138        %INCLUDE FM_CACHE_R;
       32     4150        %INCLUDE FM_CACHE_C;
       33     4216        %INCLUDE FR$RAT;
       34     4269        %INCLUDE FR_DATA_R;
       35     4301        %FR$RAT;
       36     4341        %INCLUDE FR_SUBS;
       37     4409        %INCLUDE JG_GHOSTS_C;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:2    
       38     4499        %INCLUDE NK$LDCT;
       39     4601        %INCLUDE UM_CP6;
       40     5453        %INCLUDE P_PMDAT_R;
       41     5761        %INCLUDE KI_MACROS_C;
       42     6369        %INCLUDE K_INTERFACE_M;
       43     6778        %INCLUDE K_ADDRESS_M;
       44     7281        %INCLUDE KNN_NETWORK_M;  /*   osiroute table macro */
       45     7644        /**/
       46     7645        /**/
       47     7646        /*  BASED VARIABLES */
       48     7647        /**/
       49     7648        %INCLUDE IT$CMDWD;
       50     7656        %INCLUDE IT$MONOPT;
       51     7672        %INCLUDE IT$SPROC;
       52     7690        %INCLUDE IT$SPROCDS;
       53     7706        %INCLUDE IT$RES;
       54     7724        /**/
       55     7725        %INCLUDE B$USER;
       56     7941        %B$USERREFS;
       57     7945        /**/
       58     7946        %N$REQ;
       59     8004        %NI$REQ;
       60     8029        %NK$LDCT;
       61     8075        %FMC$CACHE;
       62     8098        %FMC$STATS;
       63     8107        %FMC$TYPTBL;
       64     8112        %KI$TCTX;
       65     8670        %KNN$OSIROUTE(FPTN=KI$OSIROUTE);
       66     8887    1   DCL KI$ROUTE$(0:0) PTR BASED(KI_ROUTE$$);
       67     8888    1   DCL KI$TCTX$(0:0) PTR BASED(KI_TCTX$$);
       68     8889    1   DCL KI$OSIROUTE$(0:0) PTR BASED(KI_OSIROUTE$$);
       69     8890        /**/
       70     8891        /*  SYMREFS  */
       71     8892        /**/
       72     8893    1   DCL B$LS$ PTR SYMREF;
       73     8894    1   DCL B$REAL$ PTR SYMREF;
       74     8895    1   DCL B$DS5$ PTR SYMREF;                  /* COMMANDS                           */
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:3    
       75     8896    1   DCL B$DS6$ PTR SYMREF;                  /* TEMP SPROC                         */
       76     8897    1   DCL B$IMX$ PTR SYMREF;
       77     8898    1   DCL S_DL$ PTR SYMREF;
       78     8899    1   DCL KI_TCTX_MAX# UBIN SYMREF;
       79     8900    1   DCL KI_TCTX$$ PTR SYMREF;
       80     8901    1   DCL KI_OSIROUTE$$ PTR SYMREF;
       81     8902    1   DCL KI_OSIMAX# UBIN SYMREF;
       82     8903    1   DCL KI_ROUTE$$ PTR SYMREF;
       83     8904    1   DCL KI_NODES UBIN SYMREF;
       84     8905    1   DCL KIS_SSN_CLIENTS UBIN SYMREF;
       85     8906    1   DCL KIS_SSN_SERVERS UBIN SYMREF;
       86     8907    1   DCL KIS_SSN_MAX UBIN SYMREF;
       87     8908    1   DCL B_MUAIS UBIN(36) SYMREF;
       88     8909    1   DCL NK_MXLOCAL UBIN WORD SYMREF;
       89     8910    1   DCL NK_MXTOTAL UBIN WORD SYMREF;
       90     8911    1   DCL NK_CUR UBIN WORD SYMREF;
       91     8912    1   DCL IT_MMDSMAX(0:0) UBIN BYTE UNAL SYMREF;
       92     8913    1   DCL IT_PATCHSP UBIN WORD SYMREF;
       93     8914    1   DCL IT_DUMPSIZE UBIN WORD SYMREF;
       94     8915        /**/
       95     8916        %VLR_SITEINFO (FPTN=B_SITEINFO,STCLASS=SYMREF);
       96     8935        %VLR_MONINFO (FPTN=B_MONINFO,STCLASS=SYMREF);
       97     8953        /**/
       98     8954        /*   ENTRY DCLS   */
       99     8955        /**/
      100     8956    1   DCL ITE$ERROR ENTRY(2);
      101     8957    1   DCL ITF$FREEZE ENTRY;
      102     8958    1   DCL ITH$RAT_INIT ENTRY(2) ALTRET;
      103     8959    1   DCL ITH$ALLOCATE ENTRY(2) ALTRET;
      104     8960        /**/
      105     8961        /*   ALUTOMTIC   */
      106     8962        /**/
      107     8963    1   DCL I SBIN;
      108     8964    1   DCL J SBIN;
      109     8965    1   DCL 1 PACKET#_TEXT,
      110     8966    1         2 COUNT UBIN(9) UNAL,
      111     8967    1         2 TEXT CHAR(7) UNAL;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:4    
      112     8968    1   DCL 1 DSEG_TEXT REDEF PACKET#_TEXT,
      113     8969    1         2 COUNT UBIN(9) UNAL,
      114     8970    1         2 TEXT CHAR(2) UNAL,
      115     8971    1         2 EXTRA CHAR(5) UNAL;
      116     8972    1   DCL REQ$ PTR;
      117     8973    1   DCL 1 REREQ$ REDEF REQ$,
      118     8974    1         2 BASE UBIN(18) UNAL,
      119     8975    1         2 * BIT(18) UNAL;
      120     8976    1   DCL CMD$ PTR;
      121     8977    1   DCL RAT$ PTR;
      122     8978        /**/
      123     8979        /*  SUBs      */
      124     8980        /**/
      125     8981        %SUB YES='1'B;
      126     8982        %SUB NO='0'B;
      127     8983        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:5    
      128     8984        /*D*     NAME:     ITM$MON
      129     8985                 PURPOSE:  To build the tables defined by the MON command
      130     8986        *
      131     8987                 INPUT:    PTR$ - parameter - pointer to next available location
      132     8988                                  in TIGR table area.
      133     8989                           Command table - built in DS5 by ITC$CHECK_MON -
      134     8990                                  contains values for MON command options.
      135     8991        *
      136     8992                 OUTPUT:   Tables built and initialized
      137     8993        *
      138     8994                 DESCRIPTION:  the command table is made up of one or more frames
      139     8995                           of the structure IT$MONOPT. Each frame has the values
      140     8996                           specified for a particular MON option. Internal
      141     8997                           routines are called to process these frames.   */
      142     8998        /**/
      143     8999    1           P_RESOURCE$ = PTR$;             /* INIT P_RESOURCE BLOCK              */
      144     9000    1           P_RESOURCE$ -> P_RESOURCE = NO;
      145     9001    1           CALL ITH$ALLOCATE(PTR$,SIZEW(P_RESOURCE)) ALTRET(ITM$MON_ERR);
      146     9002        /**/
      147     9003    1           B$DS6$ -> IT$SPROCDS.COUNT = 5;
      148     9004    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(0) = LENGTHC(':SHARED_SPECIAL');
      149     9005    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(0) = ':SHARED_SPECIAL';
      150     9006    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(0) = %P_LIB;
      151     9007    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(1) = LENGTHC('DELTA');
      152     9008    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(1) = 'DELTA';
      153     9009    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(1) = %P_DB;
      154     9010    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(2) = LENGTHC(':SHARED_SYSTEM');
      155     9011    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(2) = ':SHARED_SYSTEM';
      156     9012    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(2) = %P_LIB;
      157     9013    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(3) = LENGTHC('LOGON');
      158     9014    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(3) = 'LOGON';
      159     9015    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(3) = %P_CP;
      160     9016    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(4) = LENGTHC('IBEX');
      161     9017    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(4) = 'IBEX';
      162     9018    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(4) = %P_CP;
      163     9019    1           P_MAXPROCS = P_MAXPROCS + 5;
      164     9020    1           P_NPROCS = P_NPROCS + 5;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:6    
      165     9021        /**/
      166     9022    1           CMD$ = B$DS5$;
      167     9023        /**/
      168     9024    1           CMD$ = PINCRW(CMD$,SIZEW(IT$CMDWD));
      169     9025        /**/
      170     9026    2           DO WHILE (CMD$ -> IT$CMDWD ~= %ITS_ENDCMD);
      171     9027        /**/
      172     9028    3              DO CASE (CMD$ -> IT$MONOPT.CNTWD.TYPE);
      173     9029        /**/
      174     9030    3               CASE (%ITS_SPROC);
      175     9031    3                 CALL SPROC_OPT;
      176     9032        /**/
      177     9033    3               CASE (%ITS_USERS);
      178     9034    3                 CALL USERS_OPT  ALTRET(ITM$MON_ERR);
      179     9035        /**/
      180     9036    3               CASE (%ITS_DEVMAX);
      181     9037    3                 CALL DEVMAX_OPT;
      182     9038        /**/
      183     9039    3               CASE (%ITS_QUEUE);
      184     9040    3                 CALL QUEUE_OPT  ALTRET(ITM$MON_ERR);
      185     9041        /**/
      186     9042    3               CASE (%ITS_SPSPACE);
      187     9043    3                 CALL SPSPACE_OPT;
      188     9044        /**/
      189     9045    3               CASE (%ITS_DOLIST);
      190     9046    3                 CALL DOLIST_OPT  ALTRET(ITM$MON_ERR);
      191     9047        /**/
      192     9048    3               CASE (%ITS_ENQ);
      193     9049    3                 CALL ENQ_OPT;
      194     9050        /**/
      195     9051    3               CASE (%ITS_CFU);
      196     9052    3                 CALL CFU_OPT;
      197     9053        /**/
      198     9054    3               CASE (%ITS_STEALPGS);
      199     9055    3                 CALL STEALPGS_OPT;
      200     9056        /**/
      201     9057    3               CASE (%ITS_IOCACHE);
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:7    
      202     9058    3                 CALL IOCACHE_OPT  ALTRET(ITM$MON_ERR);
      203     9059        /**/
      204     9060    3               CASE (%ITS_PATCHSP);
      205     9061    3                 CALL PATCHSP_OPT;
      206     9062        /**/
      207     9063    3               CASE(%ITS_RES);
      208     9064    3                 CALL RES_OPT;
      209     9065        /**/
      210     9066    3               CASE(%ITS_DUMPSIZE);
      211     9067    3                 CALL DUMPSIZE_OPT;
      212     9068        /**/
      213     9069    3               CASE(%ITS_SPAUTOSPACE);
      214     9070    3                 CALL SPAUTOSPACE_OPT;
      215     9071        /**/
      216     9072    3               CASE(%ITS_CGMAP);
      217     9073    3                 CALL CGMAP_OPT;
      218     9074        /**/
      219     9075    3               CASE(%ITS_CGCXTSZ);
      220     9076    3                 CALL CGCXTSZ_OPT;
      221     9077        /**/
      222     9078    3               CASE(%ITS_NODES);
      223     9079    3                 CALL NODES_OPT ALTRET(ITM$MON_ERR);
      224     9080        /**/
      225     9081    3               CASE(%ITS_FEPRES);
      226     9082    3                 CALL FEPRES_OPT ALTRET(ITM$MON_ERR);
      227     9083        /**/
      228     9084    3               CASE(%ITS_SSN_CLIENTS);
      229     9085    3                 CALL SSN_CLIENTS_OPT;
      230     9086        /**/
      231     9087    3               CASE(%ITS_SSN_SERVERS);
      232     9088    3                 CALL SSN_SERVERS_OPT;
      233     9089        /**/
      234     9090    3               CASE(%ITS_SSN_MAX);
      235     9091    3                 CALL SSN_MAX_OPT;
      236     9092        /**/
      237     9093    3               CASE(%ITS_TCTX);
      238     9094    3                 CALL TCTX_OPT ALTRET(ITM$MON_ERR);
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:8    
      239     9095        /**/
      240     9096    3               CASE(%ITS_OSIROUTE);
      241     9097    3                 CALL OSIROUTE_OPT ALTRET(ITM$MON_ERR);
      242     9098        /**/
      243     9099    3               END;
      244     9100        /**/
      245     9101    2              CMD$ = PINCRW(CMD$,CMD$ -> IT$MONOPT.CNTWD.OFFSET);
      246     9102    2              END;
      247     9103        /**/
      248     9104    1           RETURN;
      249     9105    1   ITM$MON_ERR:
      250     9106    1      CALL ITF$FREEZE;
      251     9107    1           ALTRETURN;
      252     9108        /**/
      253     9109        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:9    
      254     9110        /**/
      255     9111    1   SPROC_OPT: PROC;
      256     9112        /**/
      257     9113    2           P_NPROCS = P_NPROCS + 1;
      258     9114    2           P_MAXPROCS = P_MAXPROCS + 1 + CMD$ -> IT$SPROC.OVERLAY;
      259     9115        /**/
      260     9116    2           B$DS6$ -> IT$SPROCDS.PROCS.NAME(B$DS6$ -> IT$SPROCDS.COUNT) =
      261     9117    2             CMD$ -> IT$SPROC.NAME;
      262     9118        /**/
      263     9119    2           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(B$DS6$ -> IT$SPROCDS.COUNT) =
      264     9120    2             CMD$ -> IT$SPROC.FLGS;
      265     9121        /**/
      266     9122    2           B$DS6$ -> IT$SPROCDS.COUNT = B$DS6$ -> IT$SPROCDS.COUNT + 1;
      267     9123        /**/
      268     9124    2           RETURN;
      269     9125    2   END;
      270     9126        /**/
      271     9127        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:10   
      272     9128        /**/
      273     9129    1   USERS_OPT: PROC  ALTRET;
      274     9130        /**/
      275     9131    2           B$USRT$ = PTR$;
      276     9132        /**/
      277     9133    2           B_MUAIS = CMD$ -> IT$MONOPT.OPTS.VAL1;
      278     9134    2         IF B_MUAIS > 511 THEN
      279     9135    3            DO;
      280     9136    3               CALL ITE$ERROR (%E$USERS2BIG);
      281     9137    3               B_MUAIS = 511;
      282     9138    3               END;
      283     9139    2           S_TUIS = B_MUAIS;               /* EVERYONE CAN RUN                   */
      284     9140        /**/
      285     9141    2           CALL ITH$ALLOCATE(PTR$,SIZEW(B$U)*(B_MUAIS+1))
      286     9142    2              ALTRET(USERS_OPT_ERR);
      287     9143        /**/
      288     9144    2           B$USRT$ -> B$USER(0) = NO;
      289     9145    2           B$USRT$ -> B$USER.US(0) = %SS_SNULL;
      290     9146        /**/
      291     9147    3           DO I = 1 TO B_MUAIS;
      292     9148    3              B$USRT$ -> B$USER(I) = NO;
      293     9149    3              B$USRT$ -> B$USER.US(I) = %SS_SNULL;
      294     9150    3              B$USRT$ -> B$USER.DL$(I) = ADDR(NIL);
      295     9151    3              B$USRT$ -> B$USER.FL(I) = I + 1;
      296     9152    3              B$USRT$ -> B$USER.BL(I)  = I - 1;
      297     9153    3              IF ((I <= JG_MING#)AND(S_NSCPU ~= 0)) THEN
      298     9154    3                 B$USRT$ -> B$USER.CPU(I) = 1; /* MASTER FOR GHOSTS              */
      299     9155    3              END;
      300     9156        /**/
      301     9157    2           B$USRT$ -> B$USER.FL(1) = 0;    /* GHOST1 IS NOT LINKED               */
      302     9158    2           B$USRT$ -> B$USER.US(1)  = 0;   /* FOOL SCHEDULAR - FIRST TIME THRU   */
      303     9159    2           B$USRT$ -> B$USER.FL(B_MUAIS) = 0;
      304     9160    2           S_HQ(%SS_SNULL) = JG_MING# + 1;
      305     9161    2           S_TQ(%SS_SNULL) = B_MUAIS;
      306     9162    2           B$USRT$ -> B$USER.BL(JG_MING#+1) = 0;
      307     9163        /**/
      308     9164    2           RETURN;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:11   
      309     9165    2   USERS_OPT_ERR:
      310     9166    2           ALTRETURN;
      311     9167    2   END;
      312     9168        /**/
      313     9169        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:12   
      314     9170        /**/
      315     9171    1   QUEUE_OPT: PROC  ALTRET;
      316     9172        /**/
      317     9173    2         DCL SIZE SBIN; /* Size of IOS packet or IOS/MBX combo */
      318     9174        /**/
      319     9175    2           N$FQ$ -> N$FQ.HD$ = PTR$;
      320     9176        /**/
      321     9177    2           NI$IOQ$ = PTR$;                 /* IOQ PACKET START PTR               */
      322     9178        /**/
      323     9179    2           CALL ITH$ALLOCATE(PTR$,SIZEW(N$REQ) * (CMD$ -> IT$MONOPT.OPTS.VAL2))
      324     9180    2              ALTRET(QUEUE_OPT_ERR);
      325     9181        /**/
      326     9182    2           P_RESOURCE.RES.NREQCT.TOTAL = CMD$ -> IT$MONOPT.OPTS.VAL2;
      327     9183    2           P_RESOURCE.RES.NREQCT.MIN = CMD$ -> IT$MONOPT.OPTS.VAL2;
      328     9184    2           NI_NUMIOQ = CMD$->IT$MONOPT.OPTS.VAL2;
      329     9185        /**/
      330     9186    2           REQ$ = N$FQ$ -> N$FQ.HD$;
      331     9187    3           DO I = 0 TO CMD$ -> IT$MONOPT.OPTS.VAL2 - 1;
      332     9188        /**/
      333     9189    3              REQ$ -> N$REQ = NO;
      334     9190    3              REQ$ -> N$REQ.FL$ = PINCRW(REQ$,SIZEW(N$REQ));
      335     9191    3              REQ$ = PINCRW(REQ$,SIZEW(N$REQ));
      336     9192    3              END;
      337     9193        /**/
      338     9194    2           REQ$ = PINCRW(REQ$,-SIZEW(N$REQ));
      339     9195    2           REQ$ -> N$REQ.FL$ = N$FQ$ -> N$FQ.HD$; /* MAKE CIRCULAR               */
      340     9196        /**/
      341     9197    3           IF HW_IMX THEN DO; /* ios packets/mbx's in B$IMX$ */
      342     9198    3               I=%(IMXMBXHI-IMXLO+1)*1024; /* Leave some pages for something else */
      343     9199    3               SIZE=%IMX_IOSMBX_SIZE;
      344     9200    3               END;
      345     9201    3            ELSE DO;
      346     9202    3               REQ$ = NI$FQ$->NI$FQ.HD$;
      347     9203    3               I = 8192; /* 8 pages of low real */
      348     9204    3               I = I - REREQ$.BASE; /* Subtract what has been used */
      349     9205    3               SIZE = SIZEW(NI$REQ);
      350     9206    3               END;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:13   
      351     9207    2            I = I / SIZE;
      352     9208        /**/
      353     9209    3           IF (I < CMD$ -> IT$MONOPT.OPTS.VAL1) THEN DO; /* BUILD MAX NUMBER     */
      354     9210    3              PACKET#_TEXT.COUNT = 7;
      355     9211    3              CALL BINCHAR(PACKET#_TEXT.TEXT,I);
      356     9212    3              CALL ITE$ERROR(%E$2MANYPACKETS,ADDR(PACKET#_TEXT));
      357     9213    3              END;
      358     9214        /**/
      359     9215    2           P_RESOURCE.RES.NIREQCT.TOTAL = I;
      360     9216    2           P_RESOURCE.RES.NIREQCT.MIN = I;
      361     9217    2           NI_NUMIOS=I;
      362     9218        /**/
      363     9219    2           IF HW_IMX THEN RETURN; /* IMX ios/mbx's are linked in ITW
      364     9220                                          because they aren't written to disk */
      365     9221        /**/
      366     9222    3           DO J = 0 TO I-1;
      367     9223    3              REQ$ -> NI$REQ = NO;
      368     9224    3              REQ$ -> NI$REQ.FL$ = PINCRW(REQ$,SIZE);
      369     9225    3              REQ$ = PINCRW(REQ$,SIZE);
      370     9226    3              END;
      371     9227        /**/
      372     9228    2           REQ$ = PINCRW(REQ$,-SIZE);
      373     9229    2           REQ$ -> NI$REQ.FL$ = NI$FQ$ -> NI$FQ.HD$; /* MAKE CIRCULAR            */
      374     9230        /**/
      375     9231    2           RETURN;
      376     9232    2   QUEUE_OPT_ERR:
      377     9233    2           ALTRETURN;
      378     9234    2   END;
      379     9235        /**/
      380     9236        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:14   
      381     9237        /**/
      382     9238    1   NODES_OPT: PROC  ALTRET;
      383     9239        /**/
      384     9240    2          B_MONINFO.NUM_NODES = CMD$->IT$MONOPT.OPTS.VAL1;
      385     9241    2          KI_NODES = B_MONINFO.NUM_NODES;
      386     9242
      387     9243        /* Allocate the ROUTE ptr array.
      388     9244        */
      389     9245    2           KI_ROUTE$$ = PTR$;
      390     9246    2           CALL ITH$ALLOCATE (PTR$,KI_NODES +1) ALTRET (NODES_OPT_ERR);
      391     9247
      392     9248    3           DO I = 0 TO KI_NODES;
      393     9249    3              KI$ROUTE$(I) = ADDR(NIL);
      394     9250    3              END;
      395     9251
      396     9252        /**/
      397     9253    2           RETURN;
      398     9254        /**/
      399     9255    2   NODES_OPT_ERR:
      400     9256    2           ALTRETURN;
      401     9257    2   END;
      402     9258        /**/
      403     9259        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:15   
      404     9260    1   FEPRES_OPT: PROC ALTRET;
      405     9261    2             FR_FEPRES# = CMD$->IT$MONOPT.OPTS.VAL1;
      406     9262
      407     9263    2             RAT$ = FR$HD$(FR_NPOOL);
      408     9264    3             DO WHILE (RAT$~=ADDR(NIL) AND RAT$->FR$RAT.LNK$ ~= ADDR(NIL));
      409     9265    3                  RAT$ = RAT$->FR$RAT.LNK$;
      410     9266    3                  END;
      411     9267
      412     9268    3             DO I = 1 TO FR_FEPRES#;
      413     9269    3                  IF RAT$ = ADDR(NIL)
      414     9270    3                  THEN
      415     9271    3                       FR$HD$(FR_NPOOL) = PTR$;
      416     9272    3                  ELSE
      417     9273    3                       RAT$->FR$RAT.LNK$ = PTR$;
      418     9274    4                  CALL ITH$RAT_INIT(PTR$,RAT$) WHENALTRETURN DO;
      419     9275    4                       ALTRETURN;
      420     9276    4                       END;
      421     9277    3                  RAT$->FR$RAT.DCTX = 0;
      422     9278    3                  RAT$->FR$RAT.RCOD = FR_FREE;
      423     9279    3                  RAT$->FR$RAT.TYP = '  ';
      424     9280    3                  RAT$->FR$RAT.FLG.DOWN = '1'B;
      425     9281    3                  END;
      426     9282    2             FR_PRM$(0)->FR$PR(FR_NPOOL)=FR_PRM$(0)->FR$PR(FR_NPOOL) + FR_FEPRES#;
      427     9283
      428     9284    2             RETURN;
      429     9285    2   END FEPRES_OPT;
      430     9286        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:16   
      431     9287        /* Initialize the OSI Session data.
      432     9288        */
      433     9289    1   SSN_CLIENTS_OPT: PROC;
      434     9290    2      KIS_SSN_CLIENTS = CMD$->IT$MONOPT.OPTS.VAL1;
      435     9291
      436     9292    2      IF KIS_SSN_CLIENTS > %MAX_SSN_CLIENTS
      437     9293    3      THEN DO;
      438     9294    3           KIS_SSN_CLIENTS = %MAX_SSN_CLIENTS;
      439     9295
      440     9296    3           CALL BINCHAR(DSEG_TEXT.TEXT, %MAX_SSN_CLIENTS);
      441     9297    3           DSEG_TEXT.COUNT = 2;
      442     9298    3           CALL ITE$ERROR(%E$SSN_CLIENTS, ADDR(DSEG_TEXT));
      443     9299    3           END;
      444     9300    2      RETURN;
      445     9301    2   END SSN_CLIENTS_OPT;
      446     9302
      447     9303
      448     9304
      449     9305    1   SSN_SERVERS_OPT: PROC;
      450     9306    2      KIS_SSN_SERVERS = CMD$->IT$MONOPT.OPTS.VAL1;
      451     9307
      452     9308    2      IF KIS_SSN_SERVERS > %MAX_SSN_SERVERS
      453     9309    3      THEN DO;
      454     9310    3           KIS_SSN_SERVERS = %MAX_SSN_SERVERS;
      455     9311
      456     9312    3           CALL BINCHAR(DSEG_TEXT.TEXT, %MAX_SSN_SERVERS);
      457     9313    3           DSEG_TEXT.COUNT = 2;
      458     9314    3           CALL ITE$ERROR(%E$SSN_SERVERS, ADDR(DSEG_TEXT));
      459     9315    3           END;
      460     9316    2      RETURN;
      461     9317    2   END SSN_SERVERS_OPT;
      462     9318
      463     9319
      464     9320
      465     9321    1   SSN_MAX_OPT: PROC;
      466     9322    2      KIS_SSN_MAX = CMD$->IT$MONOPT.OPTS.VAL1;
      467     9323
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:17   
      468     9324    2      IF KIS_SSN_MAX > %MAX_SSN_MAX
      469     9325    3      THEN DO;
      470     9326    3           KIS_SSN_MAX = %MAX_SSN_MAX;
      471     9327
      472     9328    3           CALL BINCHAR(DSEG_TEXT.TEXT, %MAX_SSN_MAX);
      473     9329    3           DSEG_TEXT.COUNT = 2;
      474     9330    3           CALL ITE$ERROR(%E$SSN_MAX, ADDR(DSEG_TEXT));
      475     9331    3           END;
      476     9332    2      RETURN;
      477     9333    2   END SSN_MAX_OPT;
      478     9334
      479     9335        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:18   
      480     9336    1   TCTX_OPT: PROC ALTRET;
      481     9337
      482     9338        /* Allocate the TCTX ptr array.
      483     9339        */
      484     9340    2          KI_TCTX_MAX# = CMD$->IT$MONOPT.OPTS.VAL1;
      485     9341    2          KI_TCTX$$ = PTR$;
      486     9342    2          CALL ITH$ALLOCATE (PTR$,KI_TCTX_MAX# +1) ALTRET(TCTX_OPT_ERR);
      487     9343
      488     9344        /* Allocate the transport ctx blocks.
      489     9345        */
      490     9346    2      KI$TCTX$(0) = ADDR(NIL);  /*entry 0 is not used */
      491     9347    3      DO I = 1 TO KI_TCTX_MAX#;
      492     9348    3           KI$TCTX$(I) = PTR$;
      493     9349    3           PTR$->KI$TCTX = '0'B;
      494     9350    3           PTR$->KI$TCTX.SRC_REF = I;
      495     9351    3           CALL ITH$ALLOCATE(PTR$,SIZEW(KI$TCTX)) ALTRET(TCTX_OPT_ERR);
      496     9352    3           END;
      497     9353
      498     9354    2      RETURN;
      499     9355
      500     9356    2   TCTX_OPT_ERR:
      501     9357    2      ALTRETURN;
      502     9358
      503     9359    2   END TCTX_OPT;
      504     9360        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:19   
      505     9361
      506     9362    1   OSIROUTE_OPT: PROC ALTRET;
      507     9363
      508     9364        /* Allocate the OSIROUTE ptr array.
      509     9365        */
      510     9366    2       KI_OSIMAX# = CMD$->IT$MONOPT.OPTS.VAL1;
      511     9367
      512     9368    2      IF KI_OSIMAX# > %MAX_OSIROUTE
      513     9369    3      THEN DO;
      514     9370    3           KI_OSIMAX# = %MAX_OSIROUTE;
      515     9371
      516     9372    3           CALL BINCHAR(DSEG_TEXT.TEXT, %MAX_OSIROUTE);
      517     9373    3           DSEG_TEXT.COUNT = 2;
      518     9374    3           CALL ITE$ERROR(%E$OSIROUTE, ADDR(DSEG_TEXT));
      519     9375    3           END;
      520     9376
      521     9377    2       KI_OSIROUTE$$ = PTR$;
      522     9378    2       CALL ITH$ALLOCATE (PTR$,KI_OSIMAX# +1) ALTRET (OSIROUTE_OPT_ERR);
      523     9379
      524     9380    3       DO I = 0 TO KI_OSIMAX#;
      525     9381    3           KI$OSIROUTE$(I) = ADDR(NIL);
      526     9382    3           END;
      527     9383
      528     9384    2      RETURN;
      529     9385
      530     9386    2   OSIROUTE_OPT_ERR:
      531     9387    2      ALTRETURN;
      532     9388
      533     9389    2   END OSIROUTE_OPT;
      534     9390        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:20   
      535     9391        /**/
      536     9392    1   SPSPACE_OPT: PROC;
      537     9393        /**/
      538     9394    2           P_MAXPROCS = P_MAXPROCS + CMD$ -> IT$MONOPT.OPTS.VAL1; /* RESERVED SLOTS */
      539     9395        /**/
      540     9396    2           RETURN;
      541     9397    2   END;
      542     9398        /**/
      543     9399        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:21   
      544     9400        /* Save requested value until tables built in wrapup */
      545     9401        /**/
      546     9402    1   SPAUTOSPACE_OPT: PROC;
      547     9403        /**/
      548     9404    2           P_AUTOSPACE = CMD$->IT$MONOPT.OPTS.VAL1;
      549     9405    2           RETURN;
      550     9406    2   END;
      551     9407        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:22   
      552     9408        /**/
      553     9409    1   DOLIST_OPT: PROC  ALTRET;
      554     9410        /**/
      555     9411    2           S_DL$ = PTR$;
      556     9412        /**/
      557     9413    2           CALL ITH$ALLOCATE(PTR$,SIZEW(B$DO) * CMD$ -> IT$MONOPT.OPTS.VAL1)
      558     9414    2              ALTRET(DOLIST_OPT_ERR);
      559     9415        /**/
      560     9416    2           P_RESOURCE.RES.DOLISTS.TOTAL = CMD$ -> IT$MONOPT.OPTS.VAL1;
      561     9417    2           P_RESOURCE.RES.DOLISTS.MIN = CMD$ -> IT$MONOPT.OPTS.VAL1;
      562     9418        /**/
      563     9419    2           REQ$ = S_DL$;
      564     9420    3           DO I = 0 TO CMD$ -> IT$MONOPT.OPTS.VAL1 - 1;
      565     9421        /**/
      566     9422    3              REQ$ -> B$DO = NO;
      567     9423    3              REQ$ -> B$DO.LNK$ = PINCRW(REQ$,SIZEW(B$DO));
      568     9424    3              REQ$ = PINCRW(REQ$,SIZEW(B$DO));
      569     9425    3              END;
      570     9426        /**/
      571     9427    2           REQ$ = PINCRW(REQ$,-SIZEW(B$DO));
      572     9428    2           REQ$ -> B$DO.LNK$ = ADDR(NIL);
      573     9429        /**/
      574     9430    2           RETURN;
      575     9431    2   DOLIST_OPT_ERR:
      576     9432    2           ALTRETURN;
      577     9433    2   END;
      578     9434        /**/
      579     9435        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:23   
      580     9436        /**/
      581     9437    1   ENQ_OPT: PROC;
      582     9438        /**/
      583     9439    2           MM_RDS(2) = CMD$ -> IT$MONOPT.OPTS.VAL1; /* RESERVED                    */
      584     9440    2           IT_MMDSMAX(2) = CMD$ -> IT$MONOPT.OPTS.VAL2; /* MAX                   */
      585     9441    3           IF (IT_MMDSMAX(2) > %M_DS3MAX) THEN DO; /* NUMBER HE SAID IS TOO BIG  */
      586     9442    3              CALL BINCHAR(DSEG_TEXT.TEXT,%M_DS3MAX);
      587     9443    3              DSEG_TEXT.COUNT = 2;
      588     9444    3              CALL ITE$ERROR(%E$ENQ2BIG,ADDR(DSEG_TEXT));
      589     9445    3              IT_MMDSMAX(2) = %M_DS3MAX;
      590     9446    3              END;
      591     9447        /**/
      592     9448    2           P_RESOURCE.RES.ENQ.TOTAL = IT_MMDSMAX(2) * 256;
      593     9449    2           P_RESOURCE.RES.ENQ.MIN = IT_MMDSMAX(2) * 256;
      594     9450        /**/
      595     9451    2           RETURN;
      596     9452    2   END;
      597     9453        /**/
      598     9454        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:24   
      599     9455        /**/
      600     9456    1   CFU_OPT: PROC;
      601     9457        /**/
      602     9458    2           MM_RDS(0) = CMD$ -> IT$MONOPT.OPTS.VAL1; /* RESERVED CFU SIZE           */
      603     9459    2           IT_MMDSMAX(0) = CMD$ -> IT$MONOPT.OPTS.VAL2; /* MAX SIZE              */
      604     9460    3           IF (IT_MMDSMAX(0) > %M_DS1MAX) THEN DO; /* NUMBER HE SAID IS TOO BIG  */
      605     9461    3              CALL BINCHAR(DSEG_TEXT.TEXT,%M_DS1MAX);
      606     9462    3              DSEG_TEXT.COUNT = 2;
      607     9463    3              CALL ITE$ERROR(%E$CFU2BIG,ADDR(DSEG_TEXT));
      608     9464    3              IT_MMDSMAX(0) = %M_DS1MAX;
      609     9465    3              END;
      610     9466        /**/
      611     9467    2           RETURN;
      612     9468    2   END;
      613     9469        /**/
      614     9470        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:25   
      615     9471        /**/
      616     9472    1   STEALPGS_OPT: PROC;
      617     9473        /**/
      618     9474    2           MM_RSVP = CMD$ -> IT$MONOPT.OPTS.VAL1;
      619     9475    2           MM_STLM = CMD$ -> IT$MONOPT.OPTS.VAL2;
      620     9476    2           RETURN;
      621     9477    2   END;
      622     9478        /**/
      623     9479        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:26   
      624     9480        /**/
      625     9481    1   DEVMAX_OPT: PROC;
      626     9482        /**/
      627     9483    2           NK_MXLOCAL = N_DCTXMAX;
      628     9484    2           NK_CUR = N_DCTXMAX;
      629     9485    3           IF (N_DCTXMAX > CMD$ -> IT$MONOPT.OPTS.VAL1) THEN DO;
      630     9486    3              CALL ITE$ERROR(%E$DEVMAX2SMALL);
      631     9487    3              END;
      632     9488        /**/
      633     9489    2           ELSE N_DCTXMAX = CMD$ -> IT$MONOPT.OPTS.VAL1;
      634     9490    2           NK_MXTOTAL = N_DCTXMAX;
      635     9491    2           IT_MMDSMAX(7) = (((N_DCTXMAX-NK_CUR)*SIZEW(NK$LDCT))/1024) + 1;
              9491                    /* MAX SIZE OF SEGMENT */
      636     9492    2           RETURN;
      637     9493    2   END;
      638     9494        /**/
      639     9495        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:27   
      640     9496        /**/
      641     9497    1   IOCACHE_OPT: PROC  ALTRET;
      642     9498        /* */
      643     9499    2          FMC_CACHEPGCNT$R.SID=%ISBSID;   /* MAKE POINTER BYPASS-CACHE          */
      644     9500    2          I=0;
      645     9501    3          DO WHILE (BITBIN(FMC_MASKTBL(I))+1 < CMD$->IT$MONOPT.OPTS.VAL1);
      646     9502    3             I=I+1;
      647     9503    3          END;
      648     9504
      649     9505    2          FMC_MASK=FMC_MASKTBL(I);
      650     9506    2          IF CMD$->IT$MONOPT.OPTS.VAL1 = 0 THEN
      651     9507    2             FMC_CACHESIZ=0;
      652     9508    2          ELSE
      653     9509    2             FMC_CACHESIZ=(BITBIN(FMC_MASK)+1)*4;
      654     9510    2          FMC_CACHESIZN=I;
      655     9511
      656     9512    2          P_RESOURCE.RES.IOCACHE.TOTAL=FMC_CACHESIZ;
      657     9513    2          P_RESOURCE.RES.IOCACHE.MIN=FMC_CACHESIZ;
      658     9514
      659     9515    2          FMC_CACHE$=PTR$;
      660     9516    2          CALL ITH$ALLOCATE(PTR$, SIZEW(FMC$CACHETBL(0))*(FMC_CACHESIZ+1))
      661     9517    2             ALTRET(ERR);
      662     9518
      663     9519    2          FMC_TYPTBL$=PTR$;
      664     9520    2          CALL ITH$ALLOCATE(PTR$, SIZEW(FMC$TYPTBL)) ALTRET(ERR);
      665     9521
      666     9522    2          FMC_STATS$=PTR$;
      667     9523    2          CALL ITH$ALLOCATE(PTR$, SIZEW(FMC$STATS)) ALTRET(ERR);
      668     9524
      669     9525    2          FMC$STATS=NO;
      670     9526    2          FMC$TYPTBL=NO;
      671     9527
      672     9528    3          DO I=0 TO FMC_CACHESIZ;
      673     9529    3             FMC$CACHETBL(I)=NO;
      674     9530    3          END;
      675     9531
      676     9532    2          RETURN;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:28   
      677     9533    2   ERR:   ALTRETURN;
      678     9534    2          END IOCACHE_OPT;
      679     9535               %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:29   
      680     9536        /**/
      681     9537    1   PATCHSP_OPT: PROC;
      682     9538        /**/
      683     9539    2           IT_PATCHSP = CMD$ -> IT$MONOPT.OPTS.VAL1;
      684     9540    2           RETURN;
      685     9541    2   END;
      686     9542        /**/
      687     9543        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:30   
      688     9544        /**/
      689     9545    1   RES_OPT: PROC;
      690     9546        /**/
      691     9547    2           FR_SUMX = CMD$ -> IT$RES.MAXRESX;
      692     9548        /**/
      693     9549    2           IF (CMD$ -> IT$RES.MMTOT ~= -1) THEN /* NONE SAID                     */
      694     9550    2              FR_MEMM(0) = CMD$ -> IT$RES.MMTOT; /* TOT RESOURCE MEMORY          */
      695     9551        /**/
      696     9552    3           DO I = 0 TO FR_SUMX;
      697     9553    3              FR_SUNM(I) = CMD$ -> IT$RES.RES.NAME(I);
      698     9554    3              FR_SUMT(I) = CMD$ -> IT$RES.RES.TOT(I);
      699     9555    3              END;
      700     9556    2           RETURN;
      701     9557    2   END;
      702     9558        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:31   
      703     9559                                                /**/
      704     9560    1   CGMAP_OPT: PROC;
      705     9561        /**/
      706     9562    2           MM_CGQMAP_PGS = CMD$->IT$MONOPT.OPTS.VAL1; /*CGQ MAP PAGES*/
      707     9563    3           IF MM_CGQMAP_PGS > %MM_CGQMAX# THEN DO; /*NUMBER SPEC'D TOO BIG*/
      708     9564    3              CALL BINCHAR(PACKET#_TEXT.TEXT,%MM_CGQMAX#);
      709     9565    3              CALL INDEX(I,' ',PACKET#_TEXT.TEXT);
      710     9566    3              PACKET#_TEXT.COUNT = I;
      711     9567    3              CALL ITE$ERROR(%E$CGMAP2BIG,ADDR(PACKET#_TEXT));
      712     9568    3              MM_CGQMAP_PGS = %MM_CGQMAX#;
      713     9569    3              END;
      714     9570        /**/
      715     9571    2           RETURN;
      716     9572    2   END;
      717     9573        /**/
      718     9574        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:32   
      719     9575        /**/
      720     9576    1   CGCXTSZ_OPT: PROC;
      721     9577        /**/
      722     9578    2           MM_CGQRES_PGS = CMD$->IT$MONOPT.OPTS.VAL1; /*CG PAGE TABLE ENTRIES*/
      723     9579    2           IF (MM_CGQRES_PGS < %MIN_CGCXTSZ) OR (MM_CGQRES_PGS > %MAX_CGCXTSZ)
      724     9580    3           THEN DO;                        /*NUMBER NOT WITHIN RANGE*/
      725     9581    3              CALL BINCHAR(PACKET#_TEXT.TEXT,%MAX_CGCXTSZ);
      726     9582    3              CALL INDEX(I,' ',PACKET#_TEXT.TEXT);
      727     9583    3              PACKET#_TEXT.COUNT = I;
      728     9584    3              CALL ITE$ERROR(%E$CGCXTSZERR,ADDR(PACKET#_TEXT));
      729     9585    3              MM_CGQRES_PGS = %MAX_CGCXTSZ;
      730     9586    3              END;
      731     9587    2           RETURN;
      732     9588        /**/
      733     9589    2   END;
      734     9590        /**/
      735     9591        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:33   
      736     9592        /**/
      737     9593    1   DUMPSIZE_OPT: PROC;
      738     9594        /**/
      739     9595    2           IT_DUMPSIZE = CMD$ -> IT$MONOPT.OPTS.VAL1;
      740     9596    2           RETURN;
      741     9597    2   END;
      742     9598        /**/
      743     9599        /**/
      744     9600    1   END;

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:34   
--  Include file information  --

   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   IT$RES.:E05TOU  cannot be made into a system file and is referenced.
   IT$SPROCDS.:E05TOU  cannot be made into a system file and is referenced.
   IT$SPROC.:E05TOU  cannot be made into a system file and is referenced.
   IT$MONOPT.:E05TOU  cannot be made into a system file and is referenced.
   IT$CMDWD.:E05TOU  cannot be made into a system file and is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   K_INTERFACE_M.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   UM_CP6.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   FM_CACHE_C.:E05TOU  is referenced.
   FM_CACHE_R.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:35   
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   IT_ERROR_C.:E05TOU  is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure ITM$MON.

   Procedure ITM$MON requires 1087 words for executable code.
   Procedure ITM$MON requires 18 words of local(AUTO) storage.

    No errors detected in file ITM$MON.:E05TSI    .

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:36   

 Object Unit name= ITM$MON                                    File name= ITM$MON.:E05TOU
 UTS= JUL 29 '97 23:06:07.72 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     14     16  ITM$MON
    1   Proc  even  none  1087   2077  ITM$MON
    2  RoData even  none    33     41  ITM$MON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  ITM$MON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 ITH$ALLOCATE
         yes           Std       0 ITF$FREEZE
         yes           Std       2 ITE$ERROR
 yes     yes           Std       2 ITH$RAT_INIT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:37   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    MM_BYP$                               MM_RSVP                               MM_STLM
     MM_RDS                                MM_CGQMAP_PGS                         MM_CGQRES_PGS
     HW_IMX                                S_TUIS                                S_HQ
     S_TQ                                  S_NSCPU                               P_NPROCS
     P_MAXPROCS                            P_AUTOSPACE                           N$DCT$$
     N$FQ$                                 NI$FQ$                                NI$IBUF$
     NI$IOQ$                               NI$RP$                                N_DCTXMAX
     NI_NUMIOQ                             NI_NUMIOS                             FMC_CACHE$
     FMC_TYPTBL$                           FMC_STATS$                            FMC_CACHESIZ
     FMC_CACHESIZN                         FMC_CACHEPGCNT$                       FMC_MASK
r    FMC_MASKTBL                           FR$HD$                                FR_PRM$
     FR_MEMM                               FR_SUMT                               FR_SUMX
     FR_SUNM                               FR_FEPRES#                            P_RESOURCE$
     P_UPTIME                              P_NSCPU                               B$USRT$
     B$DS5$                                B$DS6$                                S_DL$
     KI_TCTX_MAX#                          KI_TCTX$$                             KI_OSIROUTE$$
     KI_OSIMAX#                            KI_ROUTE$$                            KI_NODES
     KIS_SSN_CLIENTS                       KIS_SSN_SERVERS                       KIS_SSN_MAX
     B_MUAIS                               NK_MXLOCAL                            NK_MXTOTAL
     NK_CUR                                IT_MMDSMAX                            IT_PATCHSP
     IT_DUMPSIZE                           B_MONINFO                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:38   


        1        1        /*M*     Builds tables desired by TIGR MON command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X*/
        9        9        /*P*     NAME:     ITM$MON
       10       10                 PURPOSE:  ITM$MON builds and initializes the tables and data
       11       11                           locations defined by the options of the TIGR MON
       12       12                           command                       */
       13       13        ITM$MON: PROC (PTR$) ALTRET;

     13  1 000000   000000 700200 xent  ITM$MON      TSX0  ! X66_AUTO_1
         1 000001   000022 000001                    ZERO    18,1

       14       14        /**/
       15       15    1   DCL PTR$ PTR;                           /* POINTER TO TIGR TABLE SPACE        */
       16       16        /**/
       17       17        /*  INCLUDE FILES */
       18       18        /**/
       19       19        %INCLUDE IT_SUBS_C;
       20      286        %INCLUDE IT_ERROR_C;
       21      369        %INCLUDE NI_DATA_C;
       22      482        %INCLUDE MM_DATA_R;
       23     1002        %INCLUDE HF_DATA_R;
       24     1045        %INCLUDE B_MLSMAC_C;
       25     1987        %B_MLS (FPTN=B$MLNK,STCLASS=BASED);
       26     2802        %INCLUDE B_SEGIDS_C;
       27     3341        %INCLUDE SS_SCHED_C;
       28     3574        %INCLUDE SS_SCHED_R;
       29     3617        %INCLUDE B$P;
       30     3701        %INCLUDE NI_DATA_R;
       31     4138        %INCLUDE FM_CACHE_R;
       32     4150        %INCLUDE FM_CACHE_C;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:39   
       33     4216        %INCLUDE FR$RAT;
       34     4269        %INCLUDE FR_DATA_R;
       35     4301        %FR$RAT;
       36     4341        %INCLUDE FR_SUBS;
       37     4409        %INCLUDE JG_GHOSTS_C;
       38     4499        %INCLUDE NK$LDCT;
       39     4601        %INCLUDE UM_CP6;
       40     5453        %INCLUDE P_PMDAT_R;
       41     5761        %INCLUDE KI_MACROS_C;
       42     6369        %INCLUDE K_INTERFACE_M;
       43     6778        %INCLUDE K_ADDRESS_M;
       44     7281        %INCLUDE KNN_NETWORK_M;  /*   osiroute table macro */
       45     7644        /**/
       46     7645        /**/
       47     7646        /*  BASED VARIABLES */
       48     7647        /**/
       49     7648        %INCLUDE IT$CMDWD;
       50     7656        %INCLUDE IT$MONOPT;
       51     7672        %INCLUDE IT$SPROC;
       52     7690        %INCLUDE IT$SPROCDS;
       53     7706        %INCLUDE IT$RES;
       54     7724        /**/
       55     7725        %INCLUDE B$USER;
       56     7941        %B$USERREFS;
       57     7945        /**/
       58     7946        %N$REQ;
       59     8004        %NI$REQ;
       60     8029        %NK$LDCT;
       61     8075        %FMC$CACHE;
       62     8098        %FMC$STATS;
       63     8107        %FMC$TYPTBL;
       64     8112        %KI$TCTX;
       65     8670        %KNN$OSIROUTE(FPTN=KI$OSIROUTE);
       66     8887    1   DCL KI$ROUTE$(0:0) PTR BASED(KI_ROUTE$$);
       67     8888    1   DCL KI$TCTX$(0:0) PTR BASED(KI_TCTX$$);
       68     8889    1   DCL KI$OSIROUTE$(0:0) PTR BASED(KI_OSIROUTE$$);
       69     8890        /**/
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:40   
       70     8891        /*  SYMREFS  */
       71     8892        /**/
       72     8893    1   DCL B$LS$ PTR SYMREF;
       73     8894    1   DCL B$REAL$ PTR SYMREF;
       74     8895    1   DCL B$DS5$ PTR SYMREF;                  /* COMMANDS                           */
       75     8896    1   DCL B$DS6$ PTR SYMREF;                  /* TEMP SPROC                         */
       76     8897    1   DCL B$IMX$ PTR SYMREF;
       77     8898    1   DCL S_DL$ PTR SYMREF;
       78     8899    1   DCL KI_TCTX_MAX# UBIN SYMREF;
       79     8900    1   DCL KI_TCTX$$ PTR SYMREF;
       80     8901    1   DCL KI_OSIROUTE$$ PTR SYMREF;
       81     8902    1   DCL KI_OSIMAX# UBIN SYMREF;
       82     8903    1   DCL KI_ROUTE$$ PTR SYMREF;
       83     8904    1   DCL KI_NODES UBIN SYMREF;
       84     8905    1   DCL KIS_SSN_CLIENTS UBIN SYMREF;
       85     8906    1   DCL KIS_SSN_SERVERS UBIN SYMREF;
       86     8907    1   DCL KIS_SSN_MAX UBIN SYMREF;
       87     8908    1   DCL B_MUAIS UBIN(36) SYMREF;
       88     8909    1   DCL NK_MXLOCAL UBIN WORD SYMREF;
       89     8910    1   DCL NK_MXTOTAL UBIN WORD SYMREF;
       90     8911    1   DCL NK_CUR UBIN WORD SYMREF;
       91     8912    1   DCL IT_MMDSMAX(0:0) UBIN BYTE UNAL SYMREF;
       92     8913    1   DCL IT_PATCHSP UBIN WORD SYMREF;
       93     8914    1   DCL IT_DUMPSIZE UBIN WORD SYMREF;
       94     8915        /**/
       95     8916        %VLR_SITEINFO (FPTN=B_SITEINFO,STCLASS=SYMREF);
       96     8935        %VLR_MONINFO (FPTN=B_MONINFO,STCLASS=SYMREF);
       97     8953        /**/
       98     8954        /*   ENTRY DCLS   */
       99     8955        /**/
      100     8956    1   DCL ITE$ERROR ENTRY(2);
      101     8957    1   DCL ITF$FREEZE ENTRY;
      102     8958    1   DCL ITH$RAT_INIT ENTRY(2) ALTRET;
      103     8959    1   DCL ITH$ALLOCATE ENTRY(2) ALTRET;
      104     8960        /**/
      105     8961        /*   ALUTOMTIC   */
      106     8962        /**/
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:41   
      107     8963    1   DCL I SBIN;
      108     8964    1   DCL J SBIN;
      109     8965    1   DCL 1 PACKET#_TEXT,
      110     8966    1         2 COUNT UBIN(9) UNAL,
      111     8967    1         2 TEXT CHAR(7) UNAL;
      112     8968    1   DCL 1 DSEG_TEXT REDEF PACKET#_TEXT,
      113     8969    1         2 COUNT UBIN(9) UNAL,
      114     8970    1         2 TEXT CHAR(2) UNAL,
      115     8971    1         2 EXTRA CHAR(5) UNAL;
      116     8972    1   DCL REQ$ PTR;
      117     8973    1   DCL 1 REREQ$ REDEF REQ$,
      118     8974    1         2 BASE UBIN(18) UNAL,
      119     8975    1         2 * BIT(18) UNAL;
      120     8976    1   DCL CMD$ PTR;
      121     8977    1   DCL RAT$ PTR;
      122     8978        /**/
      123     8979        /*  SUBs      */
      124     8980        /**/
      125     8981        %SUB YES='1'B;
      126     8982        %SUB NO='0'B;
      127     8983        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:42   
      128     8984        /*D*     NAME:     ITM$MON
      129     8985                 PURPOSE:  To build the tables defined by the MON command
      130     8986        *
      131     8987                 INPUT:    PTR$ - parameter - pointer to next available location
      132     8988                                  in TIGR table area.
      133     8989                           Command table - built in DS5 by ITC$CHECK_MON -
      134     8990                                  contains values for MON command options.
      135     8991        *
      136     8992                 OUTPUT:   Tables built and initialized
      137     8993        *
      138     8994                 DESCRIPTION:  the command table is made up of one or more frames
      139     8995                           of the structure IT$MONOPT. Each frame has the values
      140     8996                           specified for a particular MON option. Internal
      141     8997                           routines are called to process these frames.   */
      142     8998        /**/
      143     8999    1           P_RESOURCE$ = PTR$;             /* INIT P_RESOURCE BLOCK              */

   8999  1 000002   200003 470500                    LDP0    @PTR$,,AUTO
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000000 756000 xsym               STQ     P_RESOURCE$

      144     9000    1           P_RESOURCE$ -> P_RESOURCE = NO;

   9000  1 000005   000000 471400 xsym               LDP1    P_RESOURCE$
         1 000006   000100 100400                    MLR     fill='000'O
         1 000007   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000010   100000 000374                    ADSC9   0,,PR1                   cn=0,n=252

      145     9001    1           CALL ITH$ALLOCATE(PTR$,SIZEW(P_RESOURCE)) ALTRET(ITM$MON_ERR);

   9001  1 000011   000001 236000 2                  LDQ     1
         1 000012   200003 235100                    LDA     @PTR$,,AUTO
         1 000013   200016 757100                    STAQ    SIZE+1,,AUTO
         1 000014   200016 630500                    EPPR0   SIZE+1,,AUTO
         1 000015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000016   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 000017   000266 702000 1                  TSX2    ITM$MON_ERR
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:43   

      146     9002        /**/
      147     9003    1           B$DS6$ -> IT$SPROCDS.COUNT = 5;

   9003  1 000020   000005 235007                    LDA     5,DL
         1 000021   000000 470400 xsym               LDP0    B$DS6$
         1 000022   000000 755100                    STA     0,,PR0

      148     9004    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(0) = LENGTHC(':SHARED_SPECIAL');

   9004  1 000023   000000 470400 xsym               LDP0    B$DS6$
         1 000024   017000 236003                    LDQ     7680,DU
         1 000025   000001 552140                    STBQ    1,'40'O,PR0

      149     9005    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(0) = ':SHARED_SPECIAL';

   9005  1 000026   040100 100400                    MLR     fill='040'O
         1 000027   000000 000017 0                  ADSC9   0                        cn=0,n=15
         1 000030   000001 200037                    ADSC9   1,,PR0                   cn=1,n=31

      150     9006    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(0) = %P_LIB;

   9006  1 000031   100000 220003                    LDX0    32768,DU
         1 000032   000011 740100                    STX0    9,,PR0

      151     9007    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(1) = LENGTHC('DELTA');

   9007  1 000033   005000 236003                    LDQ     2560,DU
         1 000034   000012 552140                    STBQ    10,'40'O,PR0

      152     9008    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(1) = 'DELTA';

   9008  1 000035   040100 100400                    MLR     fill='040'O
         1 000036   000004 000005 0                  ADSC9   4                        cn=0,n=5
         1 000037   000012 200037                    ADSC9   10,,PR0                  cn=1,n=31

      153     9009    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(1) = %P_DB;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:44   

   9009  1 000040   020000 221003                    LDX1    8192,DU
         1 000041   000022 741100                    STX1    18,,PR0

      154     9010    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(2) = LENGTHC(':SHARED_SYSTEM');

   9010  1 000042   016000 236003                    LDQ     7168,DU
         1 000043   000023 552140                    STBQ    19,'40'O,PR0

      155     9011    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(2) = ':SHARED_SYSTEM';

   9011  1 000044   040100 100400                    MLR     fill='040'O
         1 000045   000006 000016 0                  ADSC9   6                        cn=0,n=14
         1 000046   000023 200037                    ADSC9   19,,PR0                  cn=1,n=31

      156     9012    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(2) = %P_LIB;

   9012  1 000047   000033 740100                    STX0    27,,PR0

      157     9013    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(3) = LENGTHC('LOGON');

   9013  1 000050   005000 236003                    LDQ     2560,DU
         1 000051   000034 552140                    STBQ    28,'40'O,PR0

      158     9014    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(3) = 'LOGON';

   9014  1 000052   040100 100400                    MLR     fill='040'O
         1 000053   000012 000005 0                  ADSC9   10                       cn=0,n=5
         1 000054   000034 200037                    ADSC9   28,,PR0                  cn=1,n=31

      159     9015    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(3) = %P_CP;

   9015  1 000055   400000 222003                    LDX2    -131072,DU
         1 000056   000044 742100                    STX2    36,,PR0

      160     9016    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.COUNT(4) = LENGTHC('IBEX');

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:45   
   9016  1 000057   004000 236003                    LDQ     2048,DU
         1 000060   000045 552140                    STBQ    37,'40'O,PR0

      161     9017    1           B$DS6$ -> IT$SPROCDS.PROCS.NAME.TEXT(4) = 'IBEX';

   9017  1 000061   040100 100400                    MLR     fill='040'O
         1 000062   000014 000004 0                  ADSC9   12                       cn=0,n=4
         1 000063   000045 200037                    ADSC9   37,,PR0                  cn=1,n=31

      162     9018    1           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(4) = %P_CP;

   9018  1 000064   000055 742100                    STX2    45,,PR0

      163     9019    1           P_MAXPROCS = P_MAXPROCS + 5;

   9019  1 000065   000000 235000 xsym               LDA     P_MAXPROCS
         1 000066   000005 035007                    ADLA    5,DL
         1 000067   000000 755000 xsym               STA     P_MAXPROCS

      164     9020    1           P_NPROCS = P_NPROCS + 5;

   9020  1 000070   000000 235000 xsym               LDA     P_NPROCS
         1 000071   000005 035007                    ADLA    5,DL
         1 000072   000000 755000 xsym               STA     P_NPROCS

      165     9021        /**/
      166     9022    1           CMD$ = B$DS5$;

   9022  1 000073   000000 236000 xsym               LDQ     B$DS5$
         1 000074   200011 756100                    STQ     CMD$,,AUTO

      167     9023        /**/
      168     9024    1           CMD$ = PINCRW(CMD$,SIZEW(IT$CMDWD));

   9024  1 000075   000001 036003                    ADLQ    1,DU
         1 000076   200011 756100                    STQ     CMD$,,AUTO

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:46   
      169     9025        /**/
      170     9026    2           DO WHILE (CMD$ -> IT$CMDWD ~= %ITS_ENDCMD);

   9026  1 000077   200011 471500                    LDP1    CMD$,,AUTO
         1 000100   100000 235100                    LDA     0,,PR1
         1 000101   000145 115007                    CMPA    101,DL
         1 000102   000265 600000 1                  TZE     s:9104

      171     9027        /**/
      172     9028    3              DO CASE (CMD$ -> IT$MONOPT.CNTWD.TYPE);

   9028  1 000103   200011 470500                    LDP0    CMD$,,AUTO
         1 000104   000000 720100                    LXL0    0,,PR0
         1 000105   000777 360003                    ANX0    511,DU
         1 000106   000035 100003                    CMPX0   29,DU
         1 000107   000111 602010 1                  TNC     s:9028+6,X0
         1 000110   000252 710000 1                  TRA     s:9101
         1 000111   000252 710000 1                  TRA     s:9101
         1 000112   000154 710000 1                  TRA     s:9037
         1 000113   000157 710000 1                  TRA     s:9040
         1 000114   000151 710000 1                  TRA     s:9034
         1 000115   000162 710000 1                  TRA     s:9043
         1 000116   000165 710000 1                  TRA     s:9046
         1 000117   000170 710000 1                  TRA     s:9049
         1 000120   000173 710000 1                  TRA     s:9052
         1 000121   000176 710000 1                  TRA     s:9055
         1 000122   000252 710000 1                  TRA     s:9101
         1 000123   000252 710000 1                  TRA     s:9101
         1 000124   000146 710000 1                  TRA     s:9031
         1 000125   000201 710000 1                  TRA     s:9058
         1 000126   000204 710000 1                  TRA     s:9061
         1 000127   000207 710000 1                  TRA     s:9064
         1 000130   000252 710000 1                  TRA     s:9101
         1 000131   000212 710000 1                  TRA     s:9067
         1 000132   000252 710000 1                  TRA     s:9101
         1 000133   000215 710000 1                  TRA     s:9070
         1 000134   000252 710000 1                  TRA     s:9101
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:47   
         1 000135   000220 710000 1                  TRA     s:9073
         1 000136   000223 710000 1                  TRA     s:9076
         1 000137   000226 710000 1                  TRA     s:9079
         1 000140   000231 710000 1                  TRA     s:9082
         1 000141   000234 710000 1                  TRA     s:9085
         1 000142   000237 710000 1                  TRA     s:9088
         1 000143   000242 710000 1                  TRA     s:9091
         1 000144   000245 710000 1                  TRA     s:9094
         1 000145   000250 710000 1                  TRA     s:9097

      173     9029        /**/
      174     9030    3               CASE (%ITS_SPROC);

      175     9031    3                 CALL SPROC_OPT;

   9031  1 000146   000272 701000 1                  TSX1    SPROC_OPT
         1 000147   000000 011000                    NOP     0
         1 000150   000252 710000 1                  TRA     s:9101

      176     9032        /**/
      177     9033    3               CASE (%ITS_USERS);

      178     9034    3                 CALL USERS_OPT  ALTRET(ITM$MON_ERR);

   9034  1 000151   000326 701000 1                  TSX1    USERS_OPT
         1 000152   000266 702000 1                  TSX2    ITM$MON_ERR
         1 000153   000252 710000 1                  TRA     s:9101

      179     9035        /**/
      180     9036    3               CASE (%ITS_DEVMAX);

      181     9037    3                 CALL DEVMAX_OPT;

   9037  1 000154   001541 701000 1                  TSX1    DEVMAX_OPT
         1 000155   000000 011000                    NOP     0
         1 000156   000252 710000 1                  TRA     s:9101

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:48   
      182     9038        /**/
      183     9039    3               CASE (%ITS_QUEUE);

      184     9040    3                 CALL QUEUE_OPT  ALTRET(ITM$MON_ERR);

   9040  1 000157   000464 701000 1                  TSX1    QUEUE_OPT
         1 000160   000266 702000 1                  TSX2    ITM$MON_ERR
         1 000161   000252 710000 1                  TRA     s:9101

      185     9041        /**/
      186     9042    3               CASE (%ITS_SPSPACE);

      187     9043    3                 CALL SPSPACE_OPT;

   9043  1 000162   001325 701000 1                  TSX1    SPSPACE_OPT
         1 000163   000000 011000                    NOP     0
         1 000164   000252 710000 1                  TRA     s:9101

      188     9044        /**/
      189     9045    3               CASE (%ITS_DOLIST);

      190     9046    3                 CALL DOLIST_OPT  ALTRET(ITM$MON_ERR);

   9046  1 000165   001340 701000 1                  TSX1    DOLIST_OPT
         1 000166   000266 702000 1                  TSX2    ITM$MON_ERR
         1 000167   000252 710000 1                  TRA     s:9101

      191     9047        /**/
      192     9048    3               CASE (%ITS_ENQ);

      193     9049    3                 CALL ENQ_OPT;

   9049  1 000170   001422 701000 1                  TSX1    ENQ_OPT
         1 000171   000000 011000                    NOP     0
         1 000172   000252 710000 1                  TRA     s:9101

      194     9050        /**/
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:49   
      195     9051    3               CASE (%ITS_CFU);

      196     9052    3                 CALL CFU_OPT;

   9052  1 000173   001471 701000 1                  TSX1    CFU_OPT
         1 000174   000000 011000                    NOP     0
         1 000175   000252 710000 1                  TRA     s:9101

      197     9053        /**/
      198     9054    3               CASE (%ITS_STEALPGS);

      199     9055    3                 CALL STEALPGS_OPT;

   9055  1 000176   001532 701000 1                  TSX1    STEALPGS_OPT
         1 000177   000000 011000                    NOP     0
         1 000200   000252 710000 1                  TRA     s:9101

      200     9056        /**/
      201     9057    3               CASE (%ITS_IOCACHE);

      202     9058    3                 CALL IOCACHE_OPT  ALTRET(ITM$MON_ERR);

   9058  1 000201   001572 701000 1                  TSX1    IOCACHE_OPT
         1 000202   000266 702000 1                  TSX2    ITM$MON_ERR
         1 000203   000252 710000 1                  TRA     s:9101

      203     9059        /**/
      204     9060    3               CASE (%ITS_PATCHSP);

      205     9061    3                 CALL PATCHSP_OPT;

   9061  1 000204   001721 701000 1                  TSX1    PATCHSP_OPT
         1 000205   000000 011000                    NOP     0
         1 000206   000252 710000 1                  TRA     s:9101

      206     9062        /**/
      207     9063    3               CASE(%ITS_RES);
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:50   

      208     9064    3                 CALL RES_OPT;

   9064  1 000207   001726 701000 1                  TSX1    RES_OPT
         1 000210   000000 011000                    NOP     0
         1 000211   000252 710000 1                  TRA     s:9101

      209     9065        /**/
      210     9066    3               CASE(%ITS_DUMPSIZE);

      211     9067    3                 CALL DUMPSIZE_OPT;

   9067  1 000212   002072 701000 1                  TSX1    DUMPSIZE_OPT
         1 000213   000000 011000                    NOP     0
         1 000214   000252 710000 1                  TRA     s:9101

      212     9068        /**/
      213     9069    3               CASE(%ITS_SPAUTOSPACE);

      214     9070    3                 CALL SPAUTOSPACE_OPT;

   9070  1 000215   001333 701000 1                  TSX1    SPAUTOSPACE_OPT
         1 000216   000000 011000                    NOP     0
         1 000217   000252 710000 1                  TRA     s:9101

      215     9071        /**/
      216     9072    3               CASE(%ITS_CGMAP);

      217     9073    3                 CALL CGMAP_OPT;

   9073  1 000220   001766 701000 1                  TSX1    CGMAP_OPT
         1 000221   000000 011000                    NOP     0
         1 000222   000252 710000 1                  TRA     s:9101

      218     9074        /**/
      219     9075    3               CASE(%ITS_CGCXTSZ);

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:51   
      220     9076    3                 CALL CGCXTSZ_OPT;

   9076  1 000223   002027 701000 1                  TSX1    CGCXTSZ_OPT
         1 000224   000000 011000                    NOP     0
         1 000225   000252 710000 1                  TRA     s:9101

      221     9077        /**/
      222     9078    3               CASE(%ITS_NODES);

      223     9079    3                 CALL NODES_OPT ALTRET(ITM$MON_ERR);

   9079  1 000226   000672 701000 1                  TSX1    NODES_OPT
         1 000227   000266 702000 1                  TSX2    ITM$MON_ERR
         1 000230   000252 710000 1                  TRA     s:9101

      224     9080        /**/
      225     9081    3               CASE(%ITS_FEPRES);

      226     9082    3                 CALL FEPRES_OPT ALTRET(ITM$MON_ERR);

   9082  1 000231   000733 701000 1                  TSX1    FEPRES_OPT
         1 000232   000266 702000 1                  TSX2    ITM$MON_ERR
         1 000233   000252 710000 1                  TRA     s:9101

      227     9083        /**/
      228     9084    3               CASE(%ITS_SSN_CLIENTS);

      229     9085    3                 CALL SSN_CLIENTS_OPT;

   9085  1 000234   001034 701000 1                  TSX1    SSN_CLIENTS_OPT
         1 000235   000000 011000                    NOP     0
         1 000236   000252 710000 1                  TRA     s:9101

      230     9086        /**/
      231     9087    3               CASE(%ITS_SSN_SERVERS);

      232     9088    3                 CALL SSN_SERVERS_OPT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:52   

   9088  1 000237   001067 701000 1                  TSX1    SSN_SERVERS_OPT
         1 000240   000000 011000                    NOP     0
         1 000241   000252 710000 1                  TRA     s:9101

      233     9089        /**/
      234     9090    3               CASE(%ITS_SSN_MAX);

      235     9091    3                 CALL SSN_MAX_OPT;

   9091  1 000242   001122 701000 1                  TSX1    SSN_MAX_OPT
         1 000243   000000 011000                    NOP     0
         1 000244   000252 710000 1                  TRA     s:9101

      236     9092        /**/
      237     9093    3               CASE(%ITS_TCTX);

      238     9094    3                 CALL TCTX_OPT ALTRET(ITM$MON_ERR);

   9094  1 000245   001155 701000 1                  TSX1    TCTX_OPT
         1 000246   000266 702000 1                  TSX2    ITM$MON_ERR
         1 000247   000252 710000 1                  TRA     s:9101

      239     9095        /**/
      240     9096    3               CASE(%ITS_OSIROUTE);

      241     9097    3                 CALL OSIROUTE_OPT ALTRET(ITM$MON_ERR);

   9097  1 000250   001237 701000 1                  TSX1    OSIROUTE_OPT
         1 000251   000266 702000 1                  TSX2    ITM$MON_ERR

      242     9098        /**/
      243     9099    3               END;

      244     9100        /**/
      245     9101    2              CMD$ = PINCRW(CMD$,CMD$ -> IT$MONOPT.CNTWD.OFFSET);

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:53   
   9101  1 000252   200011 470500                    LDP0    CMD$,,AUTO
         1 000253   000000 236100                    LDQ     0,,PR0
         1 000254   000011 772000                    QRL     9
         1 000255   000777 376007                    ANQ     511,DL
         1 000256   000022 736000                    QLS     18
         1 000257   200011 036100                    ADLQ    CMD$,,AUTO
         1 000260   200011 756100                    STQ     CMD$,,AUTO

      246     9102    2              END;

   9102  1 000261   200011 470500                    LDP0    CMD$,,AUTO
         1 000262   000000 235100                    LDA     0,,PR0
         1 000263   000145 115007                    CMPA    101,DL
         1 000264   000103 601000 1                  TNZ     s:9028

      247     9103        /**/
      248     9104    1           RETURN;

   9104  1 000265   000000 702200 xent               TSX2  ! X66_ARET

      249     9105    1   ITM$MON_ERR:
      250     9106    1      CALL ITF$FREEZE;

   9106  1 000266   000002 631400 xsym  ITM$MON_ERR  EPPR1   B_VECTNIL+2
         1 000267   000000 701000 xent               TSX1    ITF$FREEZE
         1 000270   000000 011000                    NOP     0

      251     9107    1           ALTRETURN;

   9107  1 000271   000000 702200 xent               TSX2  ! X66_AALT

      252     9108        /**/
      253     9109        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:54   
      254     9110        /**/
      255     9111    1   SPROC_OPT: PROC;

   9111  1 000272   200014 741300       SPROC_OPT    STX1  ! RAT$+2,,AUTO

      256     9112        /**/
      257     9113    2           P_NPROCS = P_NPROCS + 1;

   9113  1 000273   000000 235000 xsym               LDA     P_NPROCS
         1 000274   000001 035007                    ADLA    1,DL
         1 000275   000000 755000 xsym               STA     P_NPROCS

      258     9114    2           P_MAXPROCS = P_MAXPROCS + 1 + CMD$ -> IT$SPROC.OVERLAY;

   9114  1 000276   200011 470500                    LDP0    CMD$,,AUTO
         1 000277   000011 236100                    LDQ     9,,PR0
         1 000300   777777 376007                    ANQ     -1,DL
         1 000301   000000 036000 xsym               ADLQ    P_MAXPROCS
         1 000302   000001 036007                    ADLQ    1,DL
         1 000303   000000 756000 xsym               STQ     P_MAXPROCS

      259     9115        /**/
      260     9116    2           B$DS6$ -> IT$SPROCDS.PROCS.NAME(B$DS6$ -> IT$SPROCDS.COUNT) =

   9116  1 000304   000000 471400 xsym               LDP1    B$DS6$
         1 000305   100000 236100                    LDQ     0,,PR1
         1 000306   000011 402007                    MPY     9,DL
         1 000307   000002 736000                    QLS     2
         1 000310   000106 100500                    MLR     fill='000'O
         1 000311   000001 000040                    ADSC9   1,,PR0                   cn=0,n=32
         1 000312   100001 000040                    ADSC9   1,Q,PR1                  cn=0,n=32

      261     9117    2             CMD$ -> IT$SPROC.NAME;
      262     9118        /**/
      263     9119    2           B$DS6$ -> IT$SPROCDS.PROCS.FLGS(B$DS6$ -> IT$SPROCDS.COUNT) =

   9119  1 000313   000000 471400 xsym               LDP1    B$DS6$
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:55   
         1 000314   100000 236100                    LDQ     0,,PR1
         1 000315   000011 402007                    MPY     9,DL
         1 000316   000011 220100                    LDX0    9,,PR0
         1 000317   100011 740106                    STX0    9,QL,PR1

      264     9120    2             CMD$ -> IT$SPROC.FLGS;
      265     9121        /**/
      266     9122    2           B$DS6$ -> IT$SPROCDS.COUNT = B$DS6$ -> IT$SPROCDS.COUNT + 1;

   9122  1 000320   000000 471400 xsym               LDP1    B$DS6$
         1 000321   100000 235100                    LDA     0,,PR1
         1 000322   000001 035007                    ADLA    1,DL
         1 000323   100000 755100                    STA     0,,PR1

      267     9123        /**/
      268     9124    2           RETURN;

   9124  1 000324   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 000325   000001 702211                    TSX2  ! 1,X1

      269     9125    2   END;
      270     9126        /**/
      271     9127        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:56   
      272     9128        /**/
      273     9129    1   USERS_OPT: PROC  ALTRET;

   9129  1 000326   200014 741300       USERS_OPT    STX1  ! RAT$+2,,AUTO

      274     9130        /**/
      275     9131    2           B$USRT$ = PTR$;

   9131  1 000327   200003 470500                    LDP0    @PTR$,,AUTO
         1 000330   000000 236100                    LDQ     0,,PR0
         1 000331   000000 756000 xsym               STQ     B$USRT$

      276     9132        /**/
      277     9133    2           B_MUAIS = CMD$ -> IT$MONOPT.OPTS.VAL1;

   9133  1 000332   200011 471500                    LDP1    CMD$,,AUTO
         1 000333   100001 235100                    LDA     1,,PR1
         1 000334   000000 755000 xsym               STA     B_MUAIS

      278     9134    2         IF B_MUAIS > 511 THEN

   9134  1 000335   001000 115007                    CMPA    512,DL
         1 000336   000345 602000 1                  TNC     s:9139

      279     9135    3            DO;

      280     9136    3               CALL ITE$ERROR (%E$USERS2BIG);

   9136  1 000337   000003 630400 2                  EPPR0   3
         1 000340   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000341   000000 701000 xent               TSX1    ITE$ERROR
         1 000342   000000 011000                    NOP     0

      281     9137    3               B_MUAIS = 511;

   9137  1 000343   000777 235007                    LDA     511,DL
         1 000344   000000 755000 xsym               STA     B_MUAIS
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:57   

      282     9138    3               END;

      283     9139    2           S_TUIS = B_MUAIS;               /* EVERYONE CAN RUN                   */

   9139  1 000345   000000 755000 xsym               STA     S_TUIS

      284     9140        /**/
      285     9141    2           CALL ITH$ALLOCATE(PTR$,SIZEW(B$U)*(B_MUAIS+1))

   9141  1 000346   000004 735000                    ALS     4
         1 000347   000020 035007                    ADLA    16,DL
         1 000350   200016 755100                    STA     SIZE+1,,AUTO
         1 000351   200016 630500                    EPPR0   SIZE+1,,AUTO
         1 000352   200021 450500                    STP0    SIZE+4,,AUTO
         1 000353   200003 236100                    LDQ     @PTR$,,AUTO
         1 000354   200020 756100                    STQ     SIZE+3,,AUTO
         1 000355   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 000356   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000357   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 000360   000462 702000 1                  TSX2    USERS_OPT_ERR

      286     9142    2              ALTRET(USERS_OPT_ERR);
      287     9143        /**/
      288     9144    2           B$USRT$ -> B$USER(0) = NO;

   9144  1 000361   000000 470400 xsym               LDP0    B$USRT$
         1 000362   000100 100400                    MLR     fill='000'O
         1 000363   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000364   000000 000100                    ADSC9   0,,PR0                   cn=0,n=64

      289     9145    2           B$USRT$ -> B$USER.US(0) = %SS_SNULL;

   9145  1 000365   000000 470400 xsym               LDP0    B$USRT$
         1 000366   300000 236003                    LDQ     98304,DU
         1 000367   000011 752140                    STCQ    9,'40'O,PR0

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:58   
      290     9146        /**/
      291     9147    3           DO I = 1 TO B_MUAIS;

   9147  1 000370   000001 235007                    LDA     1,DL
         1 000371   200004 755100                    STA     I,,AUTO
         1 000372   000437 710000 1                  TRA     s:9155+1

      292     9148    3              B$USRT$ -> B$USER(I) = NO;

   9148  1 000373   200004 235100                    LDA     I,,AUTO
         1 000374   000006 735000                    ALS     6
         1 000375   000000 470400 xsym               LDP0    B$USRT$
         1 000376   000105 100400                    MLR     fill='000'O
         1 000377   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000400   000000 000100                    ADSC9   0,A,PR0                  cn=0,n=64

      293     9149    3              B$USRT$ -> B$USER.US(I) = %SS_SNULL;

   9149  1 000401   200004 236100                    LDQ     I,,AUTO
         1 000402   000004 736000                    QLS     4
         1 000403   000000 470400 xsym               LDP0    B$USRT$
         1 000404   000000 620006                    EAX0    0,QL
         1 000405   000011 236106                    LDQ     9,QL,PR0
         1 000406   000004 376000 2                  ANQ     4
         1 000407   300000 276003                    ORQ     98304,DU
         1 000410   000011 756110                    STQ     9,X0,PR0

      294     9150    3              B$USRT$ -> B$USER.DL$(I) = ADDR(NIL);

   9150  1 000411   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000412   000000 470400 xsym               LDP0    B$USRT$
         1 000413   000015 756110                    STQ     13,X0,PR0

      295     9151    3              B$USRT$ -> B$USER.FL(I) = I + 1;

   9151  1 000414   200004 236100                    LDQ     I,,AUTO
         1 000415   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:59   
         1 000416   000000 470400 xsym               LDP0    B$USRT$
         1 000417   000002 756110                    STQ     2,X0,PR0

      296     9152    3              B$USRT$ -> B$USER.BL(I)  = I - 1;

   9152  1 000420   200004 235100                    LDA     I,,AUTO
         1 000421   000001 135007                    SBLA    1,DL
         1 000422   000000 470400 xsym               LDP0    B$USRT$
         1 000423   000003 755110                    STA     3,X0,PR0

      297     9153    3              IF ((I <= JG_MING#)AND(S_NSCPU ~= 0)) THEN

   9153  1 000424   200004 235100                    LDA     I,,AUTO
         1 000425   000017 115007                    CMPA    15,DL
         1 000426   000436 605400 1                  TPNZ    s:9155
         1 000427   000000 235000 xsym               LDA     S_NSCPU
         1 000430   000436 600000 1                  TZE     s:9155

      298     9154    3                 B$USRT$ -> B$USER.CPU(I) = 1; /* MASTER FOR GHOSTS              */

   9154  1 000431   000000 470400 xsym               LDP0    B$USRT$
         1 000432   000010 236110                    LDQ     8,X0,PR0
         1 000433   000005 376000 2                  ANQ     5
         1 000434   000001 276007                    ORQ     1,DL
         1 000435   000010 756110                    STQ     8,X0,PR0

      299     9155    3              END;

   9155  1 000436   200004 054100                    AOS     I,,AUTO
         1 000437   000000 236000 xsym               LDQ     B_MUAIS
         1 000440   000373 604000 1                  TMI     s:9148
         1 000441   200004 116100                    CMPQ    I,,AUTO
         1 000442   000373 605000 1                  TPL     s:9148

      300     9156        /**/
      301     9157    2           B$USRT$ -> B$USER.FL(1) = 0;    /* GHOST1 IS NOT LINKED               */

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:60   
   9157  1 000443   000000 470400 xsym               LDP0    B$USRT$
         1 000444   000022 450100                    STZ     18,,PR0

      302     9158    2           B$USRT$ -> B$USER.US(1)  = 0;   /* FOOL SCHEDULAR - FIRST TIME THRU   */

   9158  1 000445   000000 236003                    LDQ     0,DU
         1 000446   000031 752140                    STCQ    25,'40'O,PR0

      303     9159    2           B$USRT$ -> B$USER.FL(B_MUAIS) = 0;

   9159  1 000447   000000 235000 xsym               LDA     B_MUAIS
         1 000450   000004 735000                    ALS     4
         1 000451   000002 450105                    STZ     2,AL,PR0

      304     9160    2           S_HQ(%SS_SNULL) = JG_MING# + 1;

   9160  1 000452   000020 235007                    LDA     16,DL
         1 000453   000030 755000 xsym               STA     S_HQ+24

      305     9161    2           S_TQ(%SS_SNULL) = B_MUAIS;

   9161  1 000454   000000 235000 xsym               LDA     B_MUAIS
         1 000455   000030 755000 xsym               STA     S_TQ+24

      306     9162    2           B$USRT$ -> B$USER.BL(JG_MING#+1) = 0;

   9162  1 000456   000000 470400 xsym               LDP0    B$USRT$
         1 000457   000403 450100                    STZ     259,,PR0

      307     9163        /**/
      308     9164    2           RETURN;

   9164  1 000460   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 000461   000001 702211                    TSX2  ! 1,X1

      309     9165    2   USERS_OPT_ERR:
      310     9166    2           ALTRETURN;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:61   

   9166  1 000462   200014 221300       USERS_OPT_E* LDX1  ! RAT$+2,,AUTO
         1 000463   000000 702211                    TSX2  ! 0,X1

      311     9167    2   END;
      312     9168        /**/
      313     9169        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:62   
      314     9170        /**/
      315     9171    1   QUEUE_OPT: PROC  ALTRET;

   9171  1 000464   200014 741300       QUEUE_OPT    STX1  ! RAT$+2,,AUTO

      316     9172        /**/
      317     9173    2         DCL SIZE SBIN; /* Size of IOS packet or IOS/MBX combo */
      318     9174        /**/
      319     9175    2           N$FQ$ -> N$FQ.HD$ = PTR$;

   9175  1 000465   200003 470500                    LDP0    @PTR$,,AUTO
         1 000466   000000 236100                    LDQ     0,,PR0
         1 000467   000000 471400 xsym               LDP1    N$FQ$
         1 000470   100002 756100                    STQ     2,,PR1

      320     9176        /**/
      321     9177    2           NI$IOQ$ = PTR$;                 /* IOQ PACKET START PTR               */

   9177  1 000471   000000 236100                    LDQ     0,,PR0
         1 000472   000000 756000 xsym               STQ     NI$IOQ$

      322     9178        /**/
      323     9179    2           CALL ITH$ALLOCATE(PTR$,SIZEW(N$REQ) * (CMD$ -> IT$MONOPT.OPTS.VAL2))

   9179  1 000473   200011 473500                    LDP3    CMD$,,AUTO
         1 000474   300002 236100                    LDQ     2,,PR3
         1 000475   000036 402007                    MPY     30,DL
         1 000476   200016 756100                    STQ     SIZE+1,,AUTO
         1 000477   200016 634500                    EPPR4   SIZE+1,,AUTO
         1 000500   200021 454500                    STP4    SIZE+4,,AUTO
         1 000501   200003 236100                    LDQ     @PTR$,,AUTO
         1 000502   200020 756100                    STQ     SIZE+3,,AUTO
         1 000503   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 000504   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000505   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 000506   000670 702000 1                  TSX2    QUEUE_OPT_ERR

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:63   
      324     9180    2              ALTRET(QUEUE_OPT_ERR);
      325     9181        /**/
      326     9182    2           P_RESOURCE.RES.NREQCT.TOTAL = CMD$ -> IT$MONOPT.OPTS.VAL2;

   9182  1 000507   200011 470500                    LDP0    CMD$,,AUTO
         1 000510   000000 471400 xsym               LDP1    P_RESOURCE$
         1 000511   000002 235100                    LDA     2,,PR0
         1 000512   100046 755100                    STA     38,,PR1

      327     9183    2           P_RESOURCE.RES.NREQCT.MIN = CMD$ -> IT$MONOPT.OPTS.VAL2;

   9183  1 000513   000002 235100                    LDA     2,,PR0
         1 000514   100043 755100                    STA     35,,PR1

      328     9184    2           NI_NUMIOQ = CMD$->IT$MONOPT.OPTS.VAL2;

   9184  1 000515   000002 235100                    LDA     2,,PR0
         1 000516   000000 755000 xsym               STA     NI_NUMIOQ

      329     9185        /**/
      330     9186    2           REQ$ = N$FQ$ -> N$FQ.HD$;

   9186  1 000517   000000 473400 xsym               LDP3    N$FQ$
         1 000520   300002 236100                    LDQ     2,,PR3
         1 000521   200010 756100                    STQ     REQ$,,AUTO

      331     9187    3           DO I = 0 TO CMD$ -> IT$MONOPT.OPTS.VAL2 - 1;

   9187  1 000522   200004 450100                    STZ     I,,AUTO
         1 000523   000535 710000 1                  TRA     s:9192+1

      332     9188        /**/
      333     9189    3              REQ$ -> N$REQ = NO;

   9189  1 000524   200010 470500                    LDP0    REQ$,,AUTO
         1 000525   000100 100400                    MLR     fill='000'O
         1 000526   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:64   
         1 000527   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120

      334     9190    3              REQ$ -> N$REQ.FL$ = PINCRW(REQ$,SIZEW(N$REQ));

   9190  1 000530   200010 236100                    LDQ     REQ$,,AUTO
         1 000531   000036 036003                    ADLQ    30,DU
         1 000532   000000 756100                    STQ     0,,PR0

      335     9191    3              REQ$ = PINCRW(REQ$,SIZEW(N$REQ));

   9191  1 000533   200010 756100                    STQ     REQ$,,AUTO

      336     9192    3              END;

   9192  1 000534   200004 054100                    AOS     I,,AUTO
         1 000535   200011 470500                    LDP0    CMD$,,AUTO
         1 000536   200004 236100                    LDQ     I,,AUTO
         1 000537   000524 604000 1                  TMI     s:9189
         1 000540   000002 116100                    CMPQ    2,,PR0
         1 000541   000524 602000 1                  TNC     s:9189

      337     9193        /**/
      338     9194    2           REQ$ = PINCRW(REQ$,-SIZEW(N$REQ));

   9194  1 000542   200010 236100                    LDQ     REQ$,,AUTO
         1 000543   777742 036003                    ADLQ    -30,DU
         1 000544   200010 756100                    STQ     REQ$,,AUTO

      339     9195    2           REQ$ -> N$REQ.FL$ = N$FQ$ -> N$FQ.HD$; /* MAKE CIRCULAR               */

   9195  1 000545   000000 471400 xsym               LDP1    N$FQ$
         1 000546   100002 236100                    LDQ     2,,PR1
         1 000547   200010 473500                    LDP3    REQ$,,AUTO
         1 000550   300000 756100                    STQ     0,,PR3

      340     9196        /**/
      341     9197    3           IF HW_IMX THEN DO; /* ios packets/mbx's in B$IMX$ */
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:65   

   9197  1 000551   000000 234000 xsym               SZN     HW_IMX
         1 000552   000560 605000 1                  TPL     s:9202

      342     9198    3               I=%(IMXMBXHI-IMXLO+1)*1024; /* Leave some pages for something else */

   9198  1 000553   030000 235007                    LDA     12288,DL
         1 000554   200004 755100                    STA     I,,AUTO

      343     9199    3               SIZE=%IMX_IOSMBX_SIZE;

   9199  1 000555   000040 235007                    LDA     32,DL
         1 000556   200015 755100                    STA     SIZE,,AUTO

      344     9200    3               END;

   9200  1 000557   000575 710000 1                  TRA     s:9207

      345     9201    3            ELSE DO;

      346     9202    3               REQ$ = NI$FQ$->NI$FQ.HD$;

   9202  1 000560   000000 471400 xsym               LDP1    NI$FQ$
         1 000561   100002 236100                    LDQ     2,,PR1
         1 000562   200010 756100                    STQ     REQ$,,AUTO

      347     9203    3               I = 8192; /* 8 pages of low real */

   9203  1 000563   020000 235007                    LDA     8192,DL
         1 000564   200004 755100                    STA     I,,AUTO

      348     9204    3               I = I - REREQ$.BASE; /* Subtract what has been used */

   9204  1 000565   200010 235100                    LDA     REQ$,,AUTO
         1 000566   000022 771000                    ARL     18
         1 000567   200016 755100                    STA     SIZE+1,,AUTO
         1 000570   200004 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:66   
         1 000571   200016 136100                    SBLQ    SIZE+1,,AUTO
         1 000572   200004 756100                    STQ     I,,AUTO

      349     9205    3               SIZE = SIZEW(NI$REQ);

   9205  1 000573   000016 235007                    LDA     14,DL
         1 000574   200015 755100                    STA     SIZE,,AUTO

      350     9206    3               END;

      351     9207    2            I = I / SIZE;

   9207  1 000575   200004 236100                    LDQ     I,,AUTO
         1 000576   200015 506100                    DIV     SIZE,,AUTO
         1 000577   200004 756100                    STQ     I,,AUTO

      352     9208        /**/
      353     9209    3           IF (I < CMD$ -> IT$MONOPT.OPTS.VAL1) THEN DO; /* BUILD MAX NUMBER     */

   9209  1 000600   000000 116003                    CMPQ    0,DU
         1 000601   000604 604000 1                  TMI     s:9210
         1 000602   000001 116100                    CMPQ    1,,PR0
         1 000603   000623 603000 1                  TRC     s:9215

      354     9210    3              PACKET#_TEXT.COUNT = 7;

   9210  1 000604   007000 236003                    LDQ     3584,DU
         1 000605   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      355     9211    3              CALL BINCHAR(PACKET#_TEXT.TEXT,I);

   9211  1 000606   000100 301500                    BTD
         1 000607   200004 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         1 000610   200006 230007                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=7

      356     9212    3              CALL ITE$ERROR(%E$2MANYPACKETS,ADDR(PACKET#_TEXT));

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:67   
   9212  1 000611   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 000612   200016 451500                    STP1    SIZE+1,,AUTO
         1 000613   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 000614   200021 453500                    STP3    SIZE+4,,AUTO
         1 000615   000007 236000 2                  LDQ     7
         1 000616   200020 756100                    STQ     SIZE+3,,AUTO
         1 000617   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 000620   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000621   000000 701000 xent               TSX1    ITE$ERROR
         1 000622   000000 011000                    NOP     0

      357     9213    3              END;

      358     9214        /**/
      359     9215    2           P_RESOURCE.RES.NIREQCT.TOTAL = I;

   9215  1 000623   200004 235100                    LDA     I,,AUTO
         1 000624   000000 470400 xsym               LDP0    P_RESOURCE$
         1 000625   000054 755100                    STA     44,,PR0

      360     9216    2           P_RESOURCE.RES.NIREQCT.MIN = I;

   9216  1 000626   000051 755100                    STA     41,,PR0

      361     9217    2           NI_NUMIOS=I;

   9217  1 000627   000000 755000 xsym               STA     NI_NUMIOS

      362     9218        /**/
      363     9219    2           IF HW_IMX THEN RETURN; /* IMX ios/mbx's are linked in ITW

   9219  1 000630   000000 234000 xsym               SZN     HW_IMX
         1 000631   000634 605000 1                  TPL     s:9222

   9219  1 000632   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 000633   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:68   
      364     9220                                          because they aren't written to disk */
      365     9221        /**/
      366     9222    3           DO J = 0 TO I-1;

   9222  1 000634   200005 450100                    STZ     J,,AUTO
         1 000635   000653 710000 1                  TRA     s:9226+1

      367     9223    3              REQ$ -> NI$REQ = NO;

   9223  1 000636   200010 470500                    LDP0    REQ$,,AUTO
         1 000637   000100 100400                    MLR     fill='000'O
         1 000640   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000641   000000 000070                    ADSC9   0,,PR0                   cn=0,n=56

      368     9224    3              REQ$ -> NI$REQ.FL$ = PINCRW(REQ$,SIZE);

   9224  1 000642   200015 236100                    LDQ     SIZE,,AUTO
         1 000643   000022 736000                    QLS     18
         1 000644   200010 036100                    ADLQ    REQ$,,AUTO
         1 000645   000000 756100                    STQ     0,,PR0

      369     9225    3              REQ$ = PINCRW(REQ$,SIZE);

   9225  1 000646   200015 236100                    LDQ     SIZE,,AUTO
         1 000647   000022 736000                    QLS     18
         1 000650   200010 036100                    ADLQ    REQ$,,AUTO
         1 000651   200010 756100                    STQ     REQ$,,AUTO

      370     9226    3              END;

   9226  1 000652   200005 054100                    AOS     J,,AUTO
         1 000653   200005 236100                    LDQ     J,,AUTO
         1 000654   200004 116100                    CMPQ    I,,AUTO
         1 000655   000636 604000 1                  TMI     s:9223

      371     9227        /**/
      372     9228    2           REQ$ = PINCRW(REQ$,-SIZE);
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:69   

   9228  1 000656   200015 336100                    LCQ     SIZE,,AUTO
         1 000657   000022 736000                    QLS     18
         1 000660   200010 036100                    ADLQ    REQ$,,AUTO
         1 000661   200010 756100                    STQ     REQ$,,AUTO

      373     9229    2           REQ$ -> NI$REQ.FL$ = NI$FQ$ -> NI$FQ.HD$; /* MAKE CIRCULAR            */

   9229  1 000662   000000 470400 xsym               LDP0    NI$FQ$
         1 000663   000002 236100                    LDQ     2,,PR0
         1 000664   200010 471500                    LDP1    REQ$,,AUTO
         1 000665   100000 756100                    STQ     0,,PR1

      374     9230        /**/
      375     9231    2           RETURN;

   9231  1 000666   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 000667   000001 702211                    TSX2  ! 1,X1

      376     9232    2   QUEUE_OPT_ERR:
      377     9233    2           ALTRETURN;

   9233  1 000670   200014 221300       QUEUE_OPT_E* LDX1  ! RAT$+2,,AUTO
         1 000671   000000 702211                    TSX2  ! 0,X1

      378     9234    2   END;
      379     9235        /**/
      380     9236        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:70   
      381     9237        /**/
      382     9238    1   NODES_OPT: PROC  ALTRET;

   9238  1 000672   200014 741300       NODES_OPT    STX1  ! RAT$+2,,AUTO

      383     9239        /**/
      384     9240    2          B_MONINFO.NUM_NODES = CMD$->IT$MONOPT.OPTS.VAL1;

   9240  1 000673   200011 470500                    LDP0    CMD$,,AUTO
         1 000674   000001 235100                    LDA     1,,PR0
         1 000675   000014 755000 xsym               STA     B_MONINFO+12

      385     9241    2          KI_NODES = B_MONINFO.NUM_NODES;

   9241  1 000676   000000 755000 xsym               STA     KI_NODES

      386     9242
      387     9243        /* Allocate the ROUTE ptr array.
      388     9244        */
      389     9245    2           KI_ROUTE$$ = PTR$;

   9245  1 000677   200003 471500                    LDP1    @PTR$,,AUTO
         1 000700   100000 236100                    LDQ     0,,PR1
         1 000701   000000 756000 xsym               STQ     KI_ROUTE$$

      390     9246    2           CALL ITH$ALLOCATE (PTR$,KI_NODES +1) ALTRET (NODES_OPT_ERR);

   9246  1 000702   000001 035007                    ADLA    1,DL
         1 000703   200016 755100                    STA     SIZE+1,,AUTO
         1 000704   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 000705   200021 453500                    STP3    SIZE+4,,AUTO
         1 000706   200003 236100                    LDQ     @PTR$,,AUTO
         1 000707   200020 756100                    STQ     SIZE+3,,AUTO
         1 000710   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 000711   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000712   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 000713   000731 702000 1                  TSX2    NODES_OPT_ERR
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:71   

      391     9247
      392     9248    3           DO I = 0 TO KI_NODES;

   9248  1 000714   200004 450100                    STZ     I,,AUTO
         1 000715   000723 710000 1                  TRA     s:9250+1

      393     9249    3              KI$ROUTE$(I) = ADDR(NIL);

   9249  1 000716   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000717   000000 470400 xsym               LDP0    KI_ROUTE$$
         1 000720   200004 720100                    LXL0    I,,AUTO
         1 000721   000000 756110                    STQ     0,X0,PR0

      394     9250    3              END;

   9250  1 000722   200004 054100                    AOS     I,,AUTO
         1 000723   000000 236000 xsym               LDQ     KI_NODES
         1 000724   000716 604000 1                  TMI     s:9249
         1 000725   200004 116100                    CMPQ    I,,AUTO
         1 000726   000716 605000 1                  TPL     s:9249

      395     9251
      396     9252        /**/
      397     9253    2           RETURN;

   9253  1 000727   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 000730   000001 702211                    TSX2  ! 1,X1

      398     9254        /**/
      399     9255    2   NODES_OPT_ERR:
      400     9256    2           ALTRETURN;

   9256  1 000731   200014 221300       NODES_OPT_E* LDX1  ! RAT$+2,,AUTO
         1 000732   000000 702211                    TSX2  ! 0,X1

      401     9257    2   END;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:72   
      402     9258        /**/
      403     9259        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:73   
      404     9260    1   FEPRES_OPT: PROC ALTRET;

   9260  1 000733   200014 741300       FEPRES_OPT   STX1  ! RAT$+2,,AUTO

      405     9261    2             FR_FEPRES# = CMD$->IT$MONOPT.OPTS.VAL1;

   9261  1 000734   200011 470500                    LDP0    CMD$,,AUTO
         1 000735   000001 235100                    LDA     1,,PR0
         1 000736   000000 755000 xsym               STA     FR_FEPRES#

      406     9262
      407     9263    2             RAT$ = FR$HD$(FR_NPOOL);

   9263  1 000737   000002 236000 xsym               LDQ     FR$HD$+2
         1 000740   200012 756100                    STQ     RAT$,,AUTO

      408     9264    3             DO WHILE (RAT$~=ADDR(NIL) AND RAT$->FR$RAT.LNK$ ~= ADDR(NIL));

   9264  1 000741   000745 710000 1                  TRA     s:9266

      409     9265    3                  RAT$ = RAT$->FR$RAT.LNK$;

   9265  1 000742   200012 470500                    LDP0    RAT$,,AUTO
         1 000743   000000 236100                    LDQ     0,,PR0
         1 000744   200012 756100                    STQ     RAT$,,AUTO

      410     9266    3                  END;

   9266  1 000745   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000746   000753 600000 1                  TZE     s:9268
         1 000747   200012 470500                    LDP0    RAT$,,AUTO
         1 000750   000000 236100                    LDQ     0,,PR0
         1 000751   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000752   000742 601000 1                  TNZ     s:9265

      411     9267
      412     9268    3             DO I = 1 TO FR_FEPRES#;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:74   

   9268  1 000753   000001 235007                    LDA     1,DL
         1 000754   200004 755100                    STA     I,,AUTO
         1 000755   001023 710000 1                  TRA     s:9281+1

      413     9269    3                  IF RAT$ = ADDR(NIL)

   9269  1 000756   200012 236100                    LDQ     RAT$,,AUTO
         1 000757   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000760   000765 601000 1                  TNZ     s:9273

      414     9270    3                  THEN
      415     9271    3                       FR$HD$(FR_NPOOL) = PTR$;

   9271  1 000761   200003 470500                    LDP0    @PTR$,,AUTO
         1 000762   000000 236100                    LDQ     0,,PR0
         1 000763   000002 756000 xsym               STQ     FR$HD$+2
         1 000764   000771 710000 1                  TRA     s:9274

      416     9272    3                  ELSE
      417     9273    3                       RAT$->FR$RAT.LNK$ = PTR$;

   9273  1 000765   200003 470500                    LDP0    @PTR$,,AUTO
         1 000766   000000 236100                    LDQ     0,,PR0
         1 000767   200012 471500                    LDP1    RAT$,,AUTO
         1 000770   100000 756100                    STQ     0,,PR1

      418     9274    4                  CALL ITH$RAT_INIT(PTR$,RAT$) WHENALTRETURN DO;

   9274  1 000771   200012 631500                    EPPR1   RAT$,,AUTO
         1 000772   200017 451500                    STP1    SIZE+2,,AUTO
         1 000773   200003 236100                    LDQ     @PTR$,,AUTO
         1 000774   200016 756100                    STQ     SIZE+1,,AUTO
         1 000775   200016 630500                    EPPR0   SIZE+1,,AUTO
         1 000776   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000777   000000 701000 xent               TSX1    ITH$RAT_INIT
         1 001000   001002 702000 1                  TSX2    s:9275
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:75   
         1 001001   001004 710000 1                  TRA     s:9277

      419     9275    4                       ALTRETURN;

   9275  1 001002   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001003   000000 702211                    TSX2  ! 0,X1

      420     9276    4                       END;
      421     9277    3                  RAT$->FR$RAT.DCTX = 0;

   9277  1 001004   000000 220003                    LDX0    0,DU
         1 001005   200012 470500                    LDP0    RAT$,,AUTO
         1 001006   000003 440100                    SXL0    3,,PR0

      422     9278    3                  RAT$->FR$RAT.RCOD = FR_FREE;

   9278  1 001007   200012 470500                    LDP0    RAT$,,AUTO
         1 001010   000003 236100                    LDQ     3,,PR0
         1 001011   000010 376000 2                  ANQ     8
         1 001012   000140 276003                    ORQ     96,DU
         1 001013   000003 756100                    STQ     3,,PR0

      423     9279    3                  RAT$->FR$RAT.TYP = '  ';

   9279  1 001014   000015 221000 0                  LDX1    13
         1 001015   200012 470500                    LDP0    RAT$,,AUTO
         1 001016   000010 741100                    STX1    8,,PR0

      424     9280    3                  RAT$->FR$RAT.FLG.DOWN = '1'B;

   9280  1 001017   200012 470500                    LDP0    RAT$,,AUTO
         1 001020   000002 236007                    LDQ     2,DL
         1 001021   000010 256100                    ORSQ    8,,PR0

      425     9281    3                  END;

   9281  1 001022   200004 054100                    AOS     I,,AUTO
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:76   
         1 001023   000000 236000 xsym               LDQ     FR_FEPRES#
         1 001024   000756 604000 1                  TMI     s:9269
         1 001025   200004 116100                    CMPQ    I,,AUTO
         1 001026   000756 605000 1                  TPL     s:9269

      426     9282    2             FR_PRM$(0)->FR$PR(FR_NPOOL)=FR_PRM$(0)->FR$PR(FR_NPOOL) + FR_FEPRES#;

   9282  1 001027   000000 470400 xsym               LDP0    FR_PRM$
         1 001030   000002 036100                    ADLQ    2,,PR0
         1 001031   000002 756100                    STQ     2,,PR0

      427     9283
      428     9284    2             RETURN;

   9284  1 001032   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001033   000001 702211                    TSX2  ! 1,X1

      429     9285    2   END FEPRES_OPT;
      430     9286        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:77   
      431     9287        /* Initialize the OSI Session data.
      432     9288        */
      433     9289    1   SSN_CLIENTS_OPT: PROC;

   9289  1 001034   200014 741300       SSN_CLIENTS* STX1  ! RAT$+2,,AUTO

      434     9290    2      KIS_SSN_CLIENTS = CMD$->IT$MONOPT.OPTS.VAL1;

   9290  1 001035   200011 470500                    LDP0    CMD$,,AUTO
         1 001036   000001 235100                    LDA     1,,PR0
         1 001037   000000 755000 xsym               STA     KIS_SSN_CLIENTS

      435     9291
      436     9292    2      IF KIS_SSN_CLIENTS > %MAX_SSN_CLIENTS

   9292  1 001040   000063 115007                    CMPA    51,DL
         1 001041   001065 602000 1                  TNC     s:9300

      437     9293    3      THEN DO;

      438     9294    3           KIS_SSN_CLIENTS = %MAX_SSN_CLIENTS;

   9294  1 001042   000062 236007                    LDQ     50,DL
         1 001043   000000 756000 xsym               STQ     KIS_SSN_CLIENTS

      439     9295
      440     9296    3           CALL BINCHAR(DSEG_TEXT.TEXT, %MAX_SSN_CLIENTS);

   9296  1 001044   000000 235003                    LDA     0,DU
         1 001045   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001046   000100 301500                    BTD
         1 001047   200016 000010                    NDSC9   SIZE+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 001050   200006 230002                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=2

      441     9297    3           DSEG_TEXT.COUNT = 2;

   9297  1 001051   002000 236003                    LDQ     1024,DU
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:78   
         1 001052   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      442     9298    3           CALL ITE$ERROR(%E$SSN_CLIENTS, ADDR(DSEG_TEXT));

   9298  1 001053   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 001054   200016 451500                    STP1    SIZE+1,,AUTO
         1 001055   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 001056   200021 453500                    STP3    SIZE+4,,AUTO
         1 001057   000012 236000 2                  LDQ     10
         1 001060   200020 756100                    STQ     SIZE+3,,AUTO
         1 001061   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001062   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001063   000000 701000 xent               TSX1    ITE$ERROR
         1 001064   000000 011000                    NOP     0

      443     9299    3           END;

      444     9300    2      RETURN;

   9300  1 001065   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001066   000001 702211                    TSX2  ! 1,X1

      445     9301    2   END SSN_CLIENTS_OPT;
      446     9302
      447     9303
      448     9304
      449     9305    1   SSN_SERVERS_OPT: PROC;

   9305  1 001067   200014 741300       SSN_SERVERS* STX1  ! RAT$+2,,AUTO

      450     9306    2      KIS_SSN_SERVERS = CMD$->IT$MONOPT.OPTS.VAL1;

   9306  1 001070   200011 470500                    LDP0    CMD$,,AUTO
         1 001071   000001 235100                    LDA     1,,PR0
         1 001072   000000 755000 xsym               STA     KIS_SSN_SERVERS

      451     9307
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:79   
      452     9308    2      IF KIS_SSN_SERVERS > %MAX_SSN_SERVERS

   9308  1 001073   000063 115007                    CMPA    51,DL
         1 001074   001120 602000 1                  TNC     s:9316

      453     9309    3      THEN DO;

      454     9310    3           KIS_SSN_SERVERS = %MAX_SSN_SERVERS;

   9310  1 001075   000062 236007                    LDQ     50,DL
         1 001076   000000 756000 xsym               STQ     KIS_SSN_SERVERS

      455     9311
      456     9312    3           CALL BINCHAR(DSEG_TEXT.TEXT, %MAX_SSN_SERVERS);

   9312  1 001077   000000 235003                    LDA     0,DU
         1 001100   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001101   000100 301500                    BTD
         1 001102   200016 000010                    NDSC9   SIZE+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 001103   200006 230002                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=2

      457     9313    3           DSEG_TEXT.COUNT = 2;

   9313  1 001104   002000 236003                    LDQ     1024,DU
         1 001105   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      458     9314    3           CALL ITE$ERROR(%E$SSN_SERVERS, ADDR(DSEG_TEXT));

   9314  1 001106   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 001107   200016 451500                    STP1    SIZE+1,,AUTO
         1 001110   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 001111   200021 453500                    STP3    SIZE+4,,AUTO
         1 001112   000014 236000 2                  LDQ     12
         1 001113   200020 756100                    STQ     SIZE+3,,AUTO
         1 001114   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001115   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001116   000000 701000 xent               TSX1    ITE$ERROR
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:80   
         1 001117   000000 011000                    NOP     0

      459     9315    3           END;

      460     9316    2      RETURN;

   9316  1 001120   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001121   000001 702211                    TSX2  ! 1,X1

      461     9317    2   END SSN_SERVERS_OPT;
      462     9318
      463     9319
      464     9320
      465     9321    1   SSN_MAX_OPT: PROC;

   9321  1 001122   200014 741300       SSN_MAX_OPT  STX1  ! RAT$+2,,AUTO

      466     9322    2      KIS_SSN_MAX = CMD$->IT$MONOPT.OPTS.VAL1;

   9322  1 001123   200011 470500                    LDP0    CMD$,,AUTO
         1 001124   000001 235100                    LDA     1,,PR0
         1 001125   000000 755000 xsym               STA     KIS_SSN_MAX

      467     9323
      468     9324    2      IF KIS_SSN_MAX > %MAX_SSN_MAX

   9324  1 001126   000063 115007                    CMPA    51,DL
         1 001127   001153 602000 1                  TNC     s:9332

      469     9325    3      THEN DO;

      470     9326    3           KIS_SSN_MAX = %MAX_SSN_MAX;

   9326  1 001130   000062 236007                    LDQ     50,DL
         1 001131   000000 756000 xsym               STQ     KIS_SSN_MAX

      471     9327
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:81   
      472     9328    3           CALL BINCHAR(DSEG_TEXT.TEXT, %MAX_SSN_MAX);

   9328  1 001132   000000 235003                    LDA     0,DU
         1 001133   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001134   000100 301500                    BTD
         1 001135   200016 000010                    NDSC9   SIZE+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 001136   200006 230002                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=2

      473     9329    3           DSEG_TEXT.COUNT = 2;

   9329  1 001137   002000 236003                    LDQ     1024,DU
         1 001140   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      474     9330    3           CALL ITE$ERROR(%E$SSN_MAX, ADDR(DSEG_TEXT));

   9330  1 001141   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 001142   200016 451500                    STP1    SIZE+1,,AUTO
         1 001143   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 001144   200021 453500                    STP3    SIZE+4,,AUTO
         1 001145   000016 236000 2                  LDQ     14
         1 001146   200020 756100                    STQ     SIZE+3,,AUTO
         1 001147   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001150   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001151   000000 701000 xent               TSX1    ITE$ERROR
         1 001152   000000 011000                    NOP     0

      475     9331    3           END;

      476     9332    2      RETURN;

   9332  1 001153   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001154   000001 702211                    TSX2  ! 1,X1

      477     9333    2   END SSN_MAX_OPT;
      478     9334
      479     9335        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:82   
      480     9336    1   TCTX_OPT: PROC ALTRET;

   9336  1 001155   200014 741300       TCTX_OPT     STX1  ! RAT$+2,,AUTO

      481     9337
      482     9338        /* Allocate the TCTX ptr array.
      483     9339        */
      484     9340    2          KI_TCTX_MAX# = CMD$->IT$MONOPT.OPTS.VAL1;

   9340  1 001156   200011 470500                    LDP0    CMD$,,AUTO
         1 001157   000001 235100                    LDA     1,,PR0
         1 001160   000000 755000 xsym               STA     KI_TCTX_MAX#

      485     9341    2          KI_TCTX$$ = PTR$;

   9341  1 001161   200003 471500                    LDP1    @PTR$,,AUTO
         1 001162   100000 236100                    LDQ     0,,PR1
         1 001163   000000 756000 xsym               STQ     KI_TCTX$$

      486     9342    2          CALL ITH$ALLOCATE (PTR$,KI_TCTX_MAX# +1) ALTRET(TCTX_OPT_ERR);

   9342  1 001164   000001 035007                    ADLA    1,DL
         1 001165   200016 755100                    STA     SIZE+1,,AUTO
         1 001166   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 001167   200021 453500                    STP3    SIZE+4,,AUTO
         1 001170   200003 236100                    LDQ     @PTR$,,AUTO
         1 001171   200020 756100                    STQ     SIZE+3,,AUTO
         1 001172   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001173   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001174   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001175   001235 702000 1                  TSX2    TCTX_OPT_ERR

      487     9343
      488     9344        /* Allocate the transport ctx blocks.
      489     9345        */
      490     9346    2      KI$TCTX$(0) = ADDR(NIL);  /*entry 0 is not used */

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:83   
   9346  1 001176   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001177   000000 470400 xsym               LDP0    KI_TCTX$$
         1 001200   000000 756100                    STQ     0,,PR0

      491     9347    3      DO I = 1 TO KI_TCTX_MAX#;

   9347  1 001201   000001 235007                    LDA     1,DL
         1 001202   200004 755100                    STA     I,,AUTO
         1 001203   001227 710000 1                  TRA     s:9352+1

      492     9348    3           KI$TCTX$(I) = PTR$;

   9348  1 001204   200003 470500                    LDP0    @PTR$,,AUTO
         1 001205   000000 236100                    LDQ     0,,PR0
         1 001206   000000 471400 xsym               LDP1    KI_TCTX$$
         1 001207   200004 720100                    LXL0    I,,AUTO
         1 001210   100000 756110                    STQ     0,X0,PR1

      493     9349    3           PTR$->KI$TCTX = '0'B;

   9349  1 001211   000000 471500                    LDP1    0,,PR0
         1 001212   000100 100400                    MLR     fill='000'O
         1 001213   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001214   100000 000264                    ADSC9   0,,PR1                   cn=0,n=180

      494     9350    3           PTR$->KI$TCTX.SRC_REF = I;

   9350  1 001215   000000 471500                    LDP1    0,,PR0
         1 001216   100001 440100                    SXL0    1,,PR1

      495     9351    3           CALL ITH$ALLOCATE(PTR$,SIZEW(KI$TCTX)) ALTRET(TCTX_OPT_ERR);

   9351  1 001217   000020 236000 2                  LDQ     16
         1 001220   200003 235100                    LDA     @PTR$,,AUTO
         1 001221   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001222   200016 630500                    EPPR0   SIZE+1,,AUTO
         1 001223   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:84   
         1 001224   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001225   001235 702000 1                  TSX2    TCTX_OPT_ERR

      496     9352    3           END;

   9352  1 001226   200004 054100                    AOS     I,,AUTO
         1 001227   000000 236000 xsym               LDQ     KI_TCTX_MAX#
         1 001230   001204 604000 1                  TMI     s:9348
         1 001231   200004 116100                    CMPQ    I,,AUTO
         1 001232   001204 605000 1                  TPL     s:9348

      497     9353
      498     9354    2      RETURN;

   9354  1 001233   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001234   000001 702211                    TSX2  ! 1,X1

      499     9355
      500     9356    2   TCTX_OPT_ERR:
      501     9357    2      ALTRETURN;

   9357  1 001235   200014 221300       TCTX_OPT_ERR LDX1  ! RAT$+2,,AUTO
         1 001236   000000 702211                    TSX2  ! 0,X1

      502     9358
      503     9359    2   END TCTX_OPT;
      504     9360        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:85   
      505     9361
      506     9362    1   OSIROUTE_OPT: PROC ALTRET;

   9362  1 001237   200014 741300       OSIROUTE_OPT STX1  ! RAT$+2,,AUTO

      507     9363
      508     9364        /* Allocate the OSIROUTE ptr array.
      509     9365        */
      510     9366    2       KI_OSIMAX# = CMD$->IT$MONOPT.OPTS.VAL1;

   9366  1 001240   200011 470500                    LDP0    CMD$,,AUTO
         1 001241   000001 235100                    LDA     1,,PR0
         1 001242   000000 755000 xsym               STA     KI_OSIMAX#

      511     9367
      512     9368    2      IF KI_OSIMAX# > %MAX_OSIROUTE

   9368  1 001243   000063 115007                    CMPA    51,DL
         1 001244   001270 602000 1                  TNC     s:9377

      513     9369    3      THEN DO;

      514     9370    3           KI_OSIMAX# = %MAX_OSIROUTE;

   9370  1 001245   000062 236007                    LDQ     50,DL
         1 001246   000000 756000 xsym               STQ     KI_OSIMAX#

      515     9371
      516     9372    3           CALL BINCHAR(DSEG_TEXT.TEXT, %MAX_OSIROUTE);

   9372  1 001247   000000 235003                    LDA     0,DU
         1 001250   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001251   000100 301500                    BTD
         1 001252   200016 000010                    NDSC9   SIZE+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 001253   200006 230002                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=2

      517     9373    3           DSEG_TEXT.COUNT = 2;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:86   

   9373  1 001254   002000 236003                    LDQ     1024,DU
         1 001255   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      518     9374    3           CALL ITE$ERROR(%E$OSIROUTE, ADDR(DSEG_TEXT));

   9374  1 001256   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 001257   200016 451500                    STP1    SIZE+1,,AUTO
         1 001260   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 001261   200021 453500                    STP3    SIZE+4,,AUTO
         1 001262   000022 236000 2                  LDQ     18
         1 001263   200020 756100                    STQ     SIZE+3,,AUTO
         1 001264   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001265   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001266   000000 701000 xent               TSX1    ITE$ERROR
         1 001267   000000 011000                    NOP     0

      519     9375    3           END;

      520     9376
      521     9377    2       KI_OSIROUTE$$ = PTR$;

   9377  1 001270   200003 470500                    LDP0    @PTR$,,AUTO
         1 001271   000000 236100                    LDQ     0,,PR0
         1 001272   000000 756000 xsym               STQ     KI_OSIROUTE$$

      522     9378    2       CALL ITH$ALLOCATE (PTR$,KI_OSIMAX# +1) ALTRET (OSIROUTE_OPT_ERR);

   9378  1 001273   000000 235000 xsym               LDA     KI_OSIMAX#
         1 001274   000001 035007                    ADLA    1,DL
         1 001275   200016 755100                    STA     SIZE+1,,AUTO
         1 001276   200016 631500                    EPPR1   SIZE+1,,AUTO
         1 001277   200021 451500                    STP1    SIZE+4,,AUTO
         1 001300   200003 236100                    LDQ     @PTR$,,AUTO
         1 001301   200020 756100                    STQ     SIZE+3,,AUTO
         1 001302   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001303   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:87   
         1 001304   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001305   001323 702000 1                  TSX2    OSIROUTE_OPT_ERR

      523     9379
      524     9380    3       DO I = 0 TO KI_OSIMAX#;

   9380  1 001306   200004 450100                    STZ     I,,AUTO
         1 001307   001315 710000 1                  TRA     s:9382+1

      525     9381    3           KI$OSIROUTE$(I) = ADDR(NIL);

   9381  1 001310   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001311   000000 470400 xsym               LDP0    KI_OSIROUTE$$
         1 001312   200004 720100                    LXL0    I,,AUTO
         1 001313   000000 756110                    STQ     0,X0,PR0

      526     9382    3           END;

   9382  1 001314   200004 054100                    AOS     I,,AUTO
         1 001315   000000 236000 xsym               LDQ     KI_OSIMAX#
         1 001316   001310 604000 1                  TMI     s:9381
         1 001317   200004 116100                    CMPQ    I,,AUTO
         1 001320   001310 605000 1                  TPL     s:9381

      527     9383
      528     9384    2      RETURN;

   9384  1 001321   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001322   000001 702211                    TSX2  ! 1,X1

      529     9385
      530     9386    2   OSIROUTE_OPT_ERR:
      531     9387    2      ALTRETURN;

   9387  1 001323   200014 221300       OSIROUTE_OP* LDX1  ! RAT$+2,,AUTO
         1 001324   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:88   
      532     9388
      533     9389    2   END OSIROUTE_OPT;
      534     9390        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:89   
      535     9391        /**/
      536     9392    1   SPSPACE_OPT: PROC;

   9392  1 001325   200014 741300       SPSPACE_OPT  STX1  ! RAT$+2,,AUTO

      537     9393        /**/
      538     9394    2           P_MAXPROCS = P_MAXPROCS + CMD$ -> IT$MONOPT.OPTS.VAL1; /* RESERVED SLOTS */

   9394  1 001326   200011 470500                    LDP0    CMD$,,AUTO
         1 001327   000000 236000 xsym               LDQ     P_MAXPROCS
         1 001330   000001 036100                    ADLQ    1,,PR0
         1 001331   000000 756000 xsym               STQ     P_MAXPROCS

      539     9395        /**/
      540     9396    2           RETURN;

   9396  1 001332   000001 702211                    TSX2  ! 1,X1

      541     9397    2   END;
      542     9398        /**/
      543     9399        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:90   
      544     9400        /* Save requested value until tables built in wrapup */
      545     9401        /**/
      546     9402    1   SPAUTOSPACE_OPT: PROC;

   9402  1 001333   200014 741300       SPAUTOSPACE* STX1  ! RAT$+2,,AUTO

      547     9403        /**/
      548     9404    2           P_AUTOSPACE = CMD$->IT$MONOPT.OPTS.VAL1;

   9404  1 001334   200011 470500                    LDP0    CMD$,,AUTO
         1 001335   000001 235100                    LDA     1,,PR0
         1 001336   000000 755000 xsym               STA     P_AUTOSPACE

      549     9405    2           RETURN;

   9405  1 001337   000001 702211                    TSX2  ! 1,X1

      550     9406    2   END;
      551     9407        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:91   
      552     9408        /**/
      553     9409    1   DOLIST_OPT: PROC  ALTRET;

   9409  1 001340   200014 741300       DOLIST_OPT   STX1  ! RAT$+2,,AUTO

      554     9410        /**/
      555     9411    2           S_DL$ = PTR$;

   9411  1 001341   200003 470500                    LDP0    @PTR$,,AUTO
         1 001342   000000 236100                    LDQ     0,,PR0
         1 001343   000000 756000 xsym               STQ     S_DL$

      556     9412        /**/
      557     9413    2           CALL ITH$ALLOCATE(PTR$,SIZEW(B$DO) * CMD$ -> IT$MONOPT.OPTS.VAL1)

   9413  1 001344   200011 471500                    LDP1    CMD$,,AUTO
         1 001345   100001 236100                    LDQ     1,,PR1
         1 001346   000014 402007                    MPY     12,DL
         1 001347   200016 756100                    STQ     SIZE+1,,AUTO
         1 001350   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 001351   200021 453500                    STP3    SIZE+4,,AUTO
         1 001352   200003 236100                    LDQ     @PTR$,,AUTO
         1 001353   200020 756100                    STQ     SIZE+3,,AUTO
         1 001354   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001355   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001356   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001357   001420 702000 1                  TSX2    DOLIST_OPT_ERR

      558     9414    2              ALTRET(DOLIST_OPT_ERR);
      559     9415        /**/
      560     9416    2           P_RESOURCE.RES.DOLISTS.TOTAL = CMD$ -> IT$MONOPT.OPTS.VAL1;

   9416  1 001360   200011 470500                    LDP0    CMD$,,AUTO
         1 001361   000000 471400 xsym               LDP1    P_RESOURCE$
         1 001362   000001 235100                    LDA     1,,PR0
         1 001363   100076 755100                    STA     62,,PR1

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:92   
      561     9417    2           P_RESOURCE.RES.DOLISTS.MIN = CMD$ -> IT$MONOPT.OPTS.VAL1;

   9417  1 001364   000001 235100                    LDA     1,,PR0
         1 001365   100073 755100                    STA     59,,PR1

      562     9418        /**/
      563     9419    2           REQ$ = S_DL$;

   9419  1 001366   000000 236000 xsym               LDQ     S_DL$
         1 001367   200010 756100                    STQ     REQ$,,AUTO

      564     9420    3           DO I = 0 TO CMD$ -> IT$MONOPT.OPTS.VAL1 - 1;

   9420  1 001370   200004 450100                    STZ     I,,AUTO
         1 001371   001403 710000 1                  TRA     s:9425+1

      565     9421        /**/
      566     9422    3              REQ$ -> B$DO = NO;

   9422  1 001372   200010 470500                    LDP0    REQ$,,AUTO
         1 001373   000100 100400                    MLR     fill='000'O
         1 001374   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001375   000000 000054                    ADSC9   0,,PR0                   cn=0,n=44

      567     9423    3              REQ$ -> B$DO.LNK$ = PINCRW(REQ$,SIZEW(B$DO));

   9423  1 001376   200010 236100                    LDQ     REQ$,,AUTO
         1 001377   000014 036003                    ADLQ    12,DU
         1 001400   000000 756100                    STQ     0,,PR0

      568     9424    3              REQ$ = PINCRW(REQ$,SIZEW(B$DO));

   9424  1 001401   200010 756100                    STQ     REQ$,,AUTO

      569     9425    3              END;

   9425  1 001402   200004 054100                    AOS     I,,AUTO
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:93   
         1 001403   200011 470500                    LDP0    CMD$,,AUTO
         1 001404   200004 236100                    LDQ     I,,AUTO
         1 001405   001372 604000 1                  TMI     s:9422
         1 001406   000001 116100                    CMPQ    1,,PR0
         1 001407   001372 602000 1                  TNC     s:9422

      570     9426        /**/
      571     9427    2           REQ$ = PINCRW(REQ$,-SIZEW(B$DO));

   9427  1 001410   200010 236100                    LDQ     REQ$,,AUTO
         1 001411   777764 036003                    ADLQ    -12,DU
         1 001412   200010 756100                    STQ     REQ$,,AUTO

      572     9428    2           REQ$ -> B$DO.LNK$ = ADDR(NIL);

   9428  1 001413   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001414   200010 471500                    LDP1    REQ$,,AUTO
         1 001415   100000 756100                    STQ     0,,PR1

      573     9429        /**/
      574     9430    2           RETURN;

   9430  1 001416   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001417   000001 702211                    TSX2  ! 1,X1

      575     9431    2   DOLIST_OPT_ERR:
      576     9432    2           ALTRETURN;

   9432  1 001420   200014 221300       DOLIST_OPT_* LDX1  ! RAT$+2,,AUTO
         1 001421   000000 702211                    TSX2  ! 0,X1

      577     9433    2   END;
      578     9434        /**/
      579     9435        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:94   
      580     9436        /**/
      581     9437    1   ENQ_OPT: PROC;

   9437  1 001422   200014 741300       ENQ_OPT      STX1  ! RAT$+2,,AUTO

      582     9438        /**/
      583     9439    2           MM_RDS(2) = CMD$ -> IT$MONOPT.OPTS.VAL1; /* RESERVED                    */

   9439  1 001423   200011 470500                    LDP0    CMD$,,AUTO
         1 001424   000001 235100                    LDA     1,,PR0
         1 001425   000002 755000 xsym               STA     MM_RDS+2

      584     9440    2           IT_MMDSMAX(2) = CMD$ -> IT$MONOPT.OPTS.VAL2; /* MAX                   */

   9440  1 001426   000002 236100                    LDQ     2,,PR0
         1 001427   000011 736000                    QLS     9
         1 001430   000000 552010 xsym               STBQ    IT_MMDSMAX,'10'O

      585     9441    3           IF (IT_MMDSMAX(2) > %M_DS3MAX) THEN DO; /* NUMBER HE SAID IS TOO BIG  */

   9441  1 001431   000000 236000 xsym               LDQ     IT_MMDSMAX
         1 001432   777000 376007                    ANQ     -512,DL
         1 001433   031000 116007                    CMPQ    12800,DL
         1 001434   001461 602000 1                  TNC     s:9448

      586     9442    3              CALL BINCHAR(DSEG_TEXT.TEXT,%M_DS3MAX);

   9442  1 001435   000030 235007                    LDA     24,DL
         1 001436   000044 773000                    LRL     36
         1 001437   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001440   000100 301500                    BTD
         1 001441   200016 000010                    NDSC9   SIZE+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 001442   200006 230002                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=2

      587     9443    3              DSEG_TEXT.COUNT = 2;

   9443  1 001443   002000 236003                    LDQ     1024,DU
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:95   
         1 001444   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      588     9444    3              CALL ITE$ERROR(%E$ENQ2BIG,ADDR(DSEG_TEXT));

   9444  1 001445   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 001446   200016 451500                    STP1    SIZE+1,,AUTO
         1 001447   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 001450   200021 453500                    STP3    SIZE+4,,AUTO
         1 001451   000024 236000 2                  LDQ     20
         1 001452   200020 756100                    STQ     SIZE+3,,AUTO
         1 001453   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001454   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001455   000000 701000 xent               TSX1    ITE$ERROR
         1 001456   000000 011000                    NOP     0

      589     9445    3              IT_MMDSMAX(2) = %M_DS3MAX;

   9445  1 001457   030000 236007                    LDQ     12288,DL
         1 001460   000000 552010 xsym               STBQ    IT_MMDSMAX,'10'O

      590     9446    3              END;

      591     9447        /**/
      592     9448    2           P_RESOURCE.RES.ENQ.TOTAL = IT_MMDSMAX(2) * 256;

   9448  1 001461   000000 470400 xsym               LDP0    P_RESOURCE$
         1 001462   000000 236000 xsym               LDQ     IT_MMDSMAX
         1 001463   000001 772000                    QRL     1
         1 001464   377400 376007                    ANQ     130816,DL
         1 001465   000070 756100                    STQ     56,,PR0

      593     9449    2           P_RESOURCE.RES.ENQ.MIN = IT_MMDSMAX(2) * 256;

   9449  1 001466   000065 756100                    STQ     53,,PR0

      594     9450        /**/
      595     9451    2           RETURN;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:96   

   9451  1 001467   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001470   000001 702211                    TSX2  ! 1,X1

      596     9452    2   END;
      597     9453        /**/
      598     9454        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:97   
      599     9455        /**/
      600     9456    1   CFU_OPT: PROC;

   9456  1 001471   200014 741300       CFU_OPT      STX1  ! RAT$+2,,AUTO

      601     9457        /**/
      602     9458    2           MM_RDS(0) = CMD$ -> IT$MONOPT.OPTS.VAL1; /* RESERVED CFU SIZE           */

   9458  1 001472   200011 470500                    LDP0    CMD$,,AUTO
         1 001473   000001 235100                    LDA     1,,PR0
         1 001474   000000 755000 xsym               STA     MM_RDS

      603     9459    2           IT_MMDSMAX(0) = CMD$ -> IT$MONOPT.OPTS.VAL2; /* MAX SIZE              */

   9459  1 001475   000002 236100                    LDQ     2,,PR0
         1 001476   000033 736000                    QLS     27
         1 001477   000000 552040 xsym               STBQ    IT_MMDSMAX,'40'O

      604     9460    3           IF (IT_MMDSMAX(0) > %M_DS1MAX) THEN DO; /* NUMBER HE SAID IS TOO BIG  */

   9460  1 001500   000000 236000 xsym               LDQ     IT_MMDSMAX
         1 001501   777000 376003                    ANQ     -512,DU
         1 001502   063000 116003                    CMPQ    26112,DU
         1 001503   001530 602000 1                  TNC     s:9467

      605     9461    3              CALL BINCHAR(DSEG_TEXT.TEXT,%M_DS1MAX);

   9461  1 001504   000062 235007                    LDA     50,DL
         1 001505   000044 773000                    LRL     36
         1 001506   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001507   000100 301500                    BTD
         1 001510   200016 000010                    NDSC9   SIZE+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 001511   200006 230002                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=2

      606     9462    3              DSEG_TEXT.COUNT = 2;

   9462  1 001512   002000 236003                    LDQ     1024,DU
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:98   
         1 001513   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      607     9463    3              CALL ITE$ERROR(%E$CFU2BIG,ADDR(DSEG_TEXT));

   9463  1 001514   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 001515   200016 451500                    STP1    SIZE+1,,AUTO
         1 001516   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 001517   200021 453500                    STP3    SIZE+4,,AUTO
         1 001520   000026 236000 2                  LDQ     22
         1 001521   200020 756100                    STQ     SIZE+3,,AUTO
         1 001522   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001523   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001524   000000 701000 xent               TSX1    ITE$ERROR
         1 001525   000000 011000                    NOP     0

      608     9464    3              IT_MMDSMAX(0) = %M_DS1MAX;

   9464  1 001526   062000 236003                    LDQ     25600,DU
         1 001527   000000 552040 xsym               STBQ    IT_MMDSMAX,'40'O

      609     9465    3              END;

      610     9466        /**/
      611     9467    2           RETURN;

   9467  1 001530   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001531   000001 702211                    TSX2  ! 1,X1

      612     9468    2   END;
      613     9469        /**/
      614     9470        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:99   
      615     9471        /**/
      616     9472    1   STEALPGS_OPT: PROC;

   9472  1 001532   200014 741300       STEALPGS_OPT STX1  ! RAT$+2,,AUTO

      617     9473        /**/
      618     9474    2           MM_RSVP = CMD$ -> IT$MONOPT.OPTS.VAL1;

   9474  1 001533   200011 470500                    LDP0    CMD$,,AUTO
         1 001534   000001 235100                    LDA     1,,PR0
         1 001535   000000 755000 xsym               STA     MM_RSVP

      619     9475    2           MM_STLM = CMD$ -> IT$MONOPT.OPTS.VAL2;

   9475  1 001536   000002 235100                    LDA     2,,PR0
         1 001537   000000 755000 xsym               STA     MM_STLM

      620     9476    2           RETURN;

   9476  1 001540   000001 702211                    TSX2  ! 1,X1

      621     9477    2   END;
      622     9478        /**/
      623     9479        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:100  
      624     9480        /**/
      625     9481    1   DEVMAX_OPT: PROC;

   9481  1 001541   200014 741300       DEVMAX_OPT   STX1  ! RAT$+2,,AUTO

      626     9482        /**/
      627     9483    2           NK_MXLOCAL = N_DCTXMAX;

   9483  1 001542   000000 235000 xsym               LDA     N_DCTXMAX
         1 001543   000000 755000 xsym               STA     NK_MXLOCAL

      628     9484    2           NK_CUR = N_DCTXMAX;

   9484  1 001544   000000 755000 xsym               STA     NK_CUR

      629     9485    3           IF (N_DCTXMAX > CMD$ -> IT$MONOPT.OPTS.VAL1) THEN DO;

   9485  1 001545   200011 470500                    LDP0    CMD$,,AUTO
         1 001546   000001 236100                    LDQ     1,,PR0
         1 001547   001557 604000 1                  TMI     s:9489
         1 001550   000000 116000 xsym               CMPQ    N_DCTXMAX
         1 001551   001557 605000 1                  TPL     s:9489

      630     9486    3              CALL ITE$ERROR(%E$DEVMAX2SMALL);

   9486  1 001552   000030 630400 2                  EPPR0   24
         1 001553   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001554   000000 701000 xent               TSX1    ITE$ERROR
         1 001555   000000 011000                    NOP     0

      631     9487    3              END;

   9487  1 001556   001560 710000 1                  TRA     s:9490

      632     9488        /**/
      633     9489    2           ELSE N_DCTXMAX = CMD$ -> IT$MONOPT.OPTS.VAL1;

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:101  
   9489  1 001557   000000 756000 xsym               STQ     N_DCTXMAX

      634     9490    2           NK_MXTOTAL = N_DCTXMAX;

   9490  1 001560   000000 235000 xsym               LDA     N_DCTXMAX
         1 001561   000000 755000 xsym               STA     NK_MXTOTAL

      635     9491    2           IT_MMDSMAX(7) = (((N_DCTXMAX-NK_CUR)*SIZEW(NK$LDCT))/1024) + 1;
              9491                    /* MAX SIZE OF SEGMENT */

   9491  1 001562   000000 236000 xsym               LDQ     N_DCTXMAX
         1 001563   000000 136000 xsym               SBLQ    NK_CUR
         1 001564   000030 402007                    MPY     24,DL
         1 001565   002000 506007                    DIV     1024,DL
         1 001566   000001 036007                    ADLQ    1,DL
         1 001567   000001 552004 xsym               STBQ    IT_MMDSMAX+1,'04'O

      636     9492    2           RETURN;

   9492  1 001570   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001571   000001 702211                    TSX2  ! 1,X1

      637     9493    2   END;
      638     9494        /**/
      639     9495        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:102  
      640     9496        /**/
      641     9497    1   IOCACHE_OPT: PROC  ALTRET;

   9497  1 001572   200014 741300       IOCACHE_OPT  STX1  ! RAT$+2,,AUTO

      642     9498        /* */
      643     9499    2          FMC_CACHEPGCNT$R.SID=%ISBSID;   /* MAKE POINTER BYPASS-CACHE          */

   9499  1 001573   006050 236007                    LDQ     3112,DL
         1 001574   000000 752003 xsym               STCQ    FMC_CACHEPGCNT$,'03'O

      644     9500    2          I=0;

   9500  1 001575   200004 450100                    STZ     I,,AUTO

      645     9501    3          DO WHILE (BITBIN(FMC_MASKTBL(I))+1 < CMD$->IT$MONOPT.OPTS.VAL1);

   9501  1 001576   001600 710000 1                  TRA     s:9503

      646     9502    3             I=I+1;

   9502  1 001577   200004 054100                    AOS     I,,AUTO

      647     9503    3          END;

   9503  1 001600   200011 470500                    LDP0    CMD$,,AUTO
         1 001601   200004 720100                    LXL0    I,,AUTO
         1 001602   000000 236010 xsym               LDQ     FMC_MASKTBL,X0
         1 001603   000001 036007                    ADLQ    1,DL
         1 001604   000001 116100                    CMPQ    1,,PR0
         1 001605   001577 602000 1                  TNC     s:9502

      648     9504
      649     9505    2          FMC_MASK=FMC_MASKTBL(I);

   9505  1 001606   000000 236010 xsym               LDQ     FMC_MASKTBL,X0
         1 001607   000000 756000 xsym               STQ     FMC_MASK
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:103  

      650     9506    2          IF CMD$->IT$MONOPT.OPTS.VAL1 = 0 THEN

   9506  1 001610   000001 235100                    LDA     1,,PR0
         1 001611   001614 601000 1                  TNZ     s:9509

      651     9507    2             FMC_CACHESIZ=0;

   9507  1 001612   000000 450000 xsym               STZ     FMC_CACHESIZ
         1 001613   001620 710000 1                  TRA     s:9510

      652     9508    2          ELSE
      653     9509    2             FMC_CACHESIZ=(BITBIN(FMC_MASK)+1)*4;

   9509  1 001614   000000 235000 xsym               LDA     FMC_MASK
         1 001615   000002 735000                    ALS     2
         1 001616   000004 035007                    ADLA    4,DL
         1 001617   000000 755000 xsym               STA     FMC_CACHESIZ

      654     9510    2          FMC_CACHESIZN=I;

   9510  1 001620   200004 235100                    LDA     I,,AUTO
         1 001621   000000 755000 xsym               STA     FMC_CACHESIZN

      655     9511
      656     9512    2          P_RESOURCE.RES.IOCACHE.TOTAL=FMC_CACHESIZ;

   9512  1 001622   000000 235000 xsym               LDA     FMC_CACHESIZ
         1 001623   000000 471400 xsym               LDP1    P_RESOURCE$
         1 001624   100062 755100                    STA     50,,PR1

      657     9513    2          P_RESOURCE.RES.IOCACHE.MIN=FMC_CACHESIZ;

   9513  1 001625   100057 755100                    STA     47,,PR1

      658     9514
      659     9515    2          FMC_CACHE$=PTR$;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:104  

   9515  1 001626   200003 473500                    LDP3    @PTR$,,AUTO
         1 001627   300000 236100                    LDQ     0,,PR3
         1 001630   000000 756000 xsym               STQ     FMC_CACHE$

      660     9516    2          CALL ITH$ALLOCATE(PTR$, SIZEW(FMC$CACHETBL(0))*(FMC_CACHESIZ+1))

   9516  1 001631   000000 236000 xsym               LDQ     FMC_CACHESIZ
         1 001632   000006 402007                    MPY     6,DL
         1 001633   000006 036007                    ADLQ    6,DL
         1 001634   200016 756100                    STQ     SIZE+1,,AUTO
         1 001635   200016 634500                    EPPR4   SIZE+1,,AUTO
         1 001636   200021 454500                    STP4    SIZE+4,,AUTO
         1 001637   200003 236100                    LDQ     @PTR$,,AUTO
         1 001640   200020 756100                    STQ     SIZE+3,,AUTO
         1 001641   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 001642   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001643   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001644   001717 702000 1                  TSX2    ERR

      661     9517    2             ALTRET(ERR);
      662     9518
      663     9519    2          FMC_TYPTBL$=PTR$;

   9519  1 001645   200003 470500                    LDP0    @PTR$,,AUTO
         1 001646   000000 236100                    LDQ     0,,PR0
         1 001647   000000 756000 xsym               STQ     FMC_TYPTBL$

      664     9520    2          CALL ITH$ALLOCATE(PTR$, SIZEW(FMC$TYPTBL)) ALTRET(ERR);

   9520  1 001650   000032 236000 2                  LDQ     26
         1 001651   200003 235100                    LDA     @PTR$,,AUTO
         1 001652   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001653   200016 630500                    EPPR0   SIZE+1,,AUTO
         1 001654   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001655   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001656   001717 702000 1                  TSX2    ERR
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:105  

      665     9521
      666     9522    2          FMC_STATS$=PTR$;

   9522  1 001657   200003 470500                    LDP0    @PTR$,,AUTO
         1 001660   000000 236100                    LDQ     0,,PR0
         1 001661   000000 756000 xsym               STQ     FMC_STATS$

      667     9523    2          CALL ITH$ALLOCATE(PTR$, SIZEW(FMC$STATS)) ALTRET(ERR);

   9523  1 001662   000034 236000 2                  LDQ     28
         1 001663   200003 235100                    LDA     @PTR$,,AUTO
         1 001664   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001665   200016 630500                    EPPR0   SIZE+1,,AUTO
         1 001666   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001667   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001670   001717 702000 1                  TSX2    ERR

      668     9524
      669     9525    2          FMC$STATS=NO;

   9525  1 001671   000000 470400 xsym               LDP0    FMC_STATS$
         1 001672   000100 100400                    MLR     fill='000'O
         1 001673   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001674   000000 000410                    ADSC9   0,,PR0                   cn=0,n=264

      670     9526    2          FMC$TYPTBL=NO;

   9526  1 001675   000000 470400 xsym               LDP0    FMC_TYPTBL$
         1 001676   000100 100400                    MLR     fill='000'O
         1 001677   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001700   000000 000130                    ADSC9   0,,PR0                   cn=0,n=88

      671     9527
      672     9528    3          DO I=0 TO FMC_CACHESIZ;

   9528  1 001701   200004 450100                    STZ     I,,AUTO
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:106  
         1 001702   001712 710000 1                  TRA     s:9530+1

      673     9529    3             FMC$CACHETBL(I)=NO;

   9529  1 001703   200004 236100                    LDQ     I,,AUTO
         1 001704   000030 402007                    MPY     24,DL
         1 001705   000000 470400 xsym               LDP0    FMC_CACHE$
         1 001706   000106 100400                    MLR     fill='000'O
         1 001707   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001710   000000 000030                    ADSC9   0,Q,PR0                  cn=0,n=24

      674     9530    3          END;

   9530  1 001711   200004 054100                    AOS     I,,AUTO
         1 001712   200004 236100                    LDQ     I,,AUTO
         1 001713   000000 116000 xsym               CMPQ    FMC_CACHESIZ
         1 001714   001703 604400 1                  TMOZ    s:9529

      675     9531
      676     9532    2          RETURN;

   9532  1 001715   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001716   000001 702211                    TSX2  ! 1,X1

      677     9533    2   ERR:   ALTRETURN;

   9533  1 001717   200014 221300       ERR          LDX1  ! RAT$+2,,AUTO
         1 001720   000000 702211                    TSX2  ! 0,X1

      678     9534    2          END IOCACHE_OPT;
      679     9535               %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:107  
      680     9536        /**/
      681     9537    1   PATCHSP_OPT: PROC;

   9537  1 001721   200014 741300       PATCHSP_OPT  STX1  ! RAT$+2,,AUTO

      682     9538        /**/
      683     9539    2           IT_PATCHSP = CMD$ -> IT$MONOPT.OPTS.VAL1;

   9539  1 001722   200011 470500                    LDP0    CMD$,,AUTO
         1 001723   000001 235100                    LDA     1,,PR0
         1 001724   000000 755000 xsym               STA     IT_PATCHSP

      684     9540    2           RETURN;

   9540  1 001725   000001 702211                    TSX2  ! 1,X1

      685     9541    2   END;
      686     9542        /**/
      687     9543        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:108  
      688     9544        /**/
      689     9545    1   RES_OPT: PROC;

   9545  1 001726   200014 741300       RES_OPT      STX1  ! RAT$+2,,AUTO

      690     9546        /**/
      691     9547    2           FR_SUMX = CMD$ -> IT$RES.MAXRESX;

   9547  1 001727   200011 470500                    LDP0    CMD$,,AUTO
         1 001730   000001 235100                    LDA     1,,PR0
         1 001731   000000 755000 xsym               STA     FR_SUMX

      692     9548        /**/
      693     9549    2           IF (CMD$ -> IT$RES.MMTOT ~= -1) THEN /* NONE SAID                     */

   9549  1 001732   000002 235100                    LDA     2,,PR0
         1 001733   000027 115000 xsym               CMPA    B_VECTNIL+23
         1 001734   001736 600000 1                  TZE     s:9552

      694     9550    2              FR_MEMM(0) = CMD$ -> IT$RES.MMTOT; /* TOT RESOURCE MEMORY          */

   9550  1 001735   000000 755000 xsym               STA     FR_MEMM

      695     9551        /**/
      696     9552    3           DO I = 0 TO FR_SUMX;

   9552  1 001736   200004 450100                    STZ     I,,AUTO
         1 001737   001761 710000 1                  TRA     s:9555+1

      697     9553    3              FR_SUNM(I) = CMD$ -> IT$RES.RES.NAME(I);

   9553  1 001740   200004 235100                    LDA     I,,AUTO
         1 001741   000001 735000                    ALS     1
         1 001742   200004 236100                    LDQ     I,,AUTO
         1 001743   000000 620005                    EAX0    0,AL
         1 001744   000014 402007                    MPY     12,DL
         1 001745   000000 635010                    EAA     0,X0
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:109  
         1 001746   000020 731000                    ARS     16
         1 001747   200011 470500                    LDP0    CMD$,,AUTO
         1 001750   040005 100506                    MLR     fill='040'O
         1 001751   000003 000010                    ADSC9   3,Q,PR0                  cn=0,n=8
         1 001752   000000 000010 xsym               ADSC9   FR_SUNM,A                cn=0,n=8

      698     9554    3              FR_SUMT(I) = CMD$ -> IT$RES.RES.TOT(I);

   9554  1 001753   200004 236100                    LDQ     I,,AUTO
         1 001754   000003 402007                    MPY     3,DL
         1 001755   000005 235106                    LDA     5,QL,PR0
         1 001756   200004 720100                    LXL0    I,,AUTO
         1 001757   000000 755010 xsym               STA     FR_SUMT,X0

      699     9555    3              END;

   9555  1 001760   200004 054100                    AOS     I,,AUTO
         1 001761   200004 236100                    LDQ     I,,AUTO
         1 001762   000000 116000 xsym               CMPQ    FR_SUMX
         1 001763   001740 604400 1                  TMOZ    s:9553

      700     9556    2           RETURN;

   9556  1 001764   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 001765   000001 702211                    TSX2  ! 1,X1

      701     9557    2   END;
      702     9558        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:110  
      703     9559                                                /**/
      704     9560    1   CGMAP_OPT: PROC;

   9560  1 001766   200014 741300       CGMAP_OPT    STX1  ! RAT$+2,,AUTO

      705     9561        /**/
      706     9562    2           MM_CGQMAP_PGS = CMD$->IT$MONOPT.OPTS.VAL1; /*CGQ MAP PAGES*/

   9562  1 001767   200011 470500                    LDP0    CMD$,,AUTO
         1 001770   000001 235100                    LDA     1,,PR0
         1 001771   000000 755000 xsym               STA     MM_CGQMAP_PGS

      707     9563    3           IF MM_CGQMAP_PGS > %MM_CGQMAX# THEN DO; /*NUMBER SPEC'D TOO BIG*/

   9563  1 001772   000013 115007                    CMPA    11,DL
         1 001773   002025 602000 1                  TNC     s:9571

      708     9564    3              CALL BINCHAR(PACKET#_TEXT.TEXT,%MM_CGQMAX#);

   9564  1 001774   000012 236007                    LDQ     10,DL
         1 001775   000000 235003                    LDA     0,DU
         1 001776   200016 757100                    STAQ    SIZE+1,,AUTO
         1 001777   000100 301500                    BTD
         1 002000   200016 000010                    NDSC9   SIZE+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 002001   200006 230007                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=7

      709     9565    3              CALL INDEX(I,' ',PACKET#_TEXT.TEXT);

   9565  1 002002   000000 124500                    SCM     mask='000'O
         1 002003   200006 200007                    ADSC9   PACKET#_TEXT,,AUTO       cn=1,n=7
         1 002004   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 002005   200004 000100                    ARG     I,,AUTO

      710     9566    3              PACKET#_TEXT.COUNT = I;

   9566  1 002006   200004 236100                    LDQ     I,,AUTO
         1 002007   000033 736000                    QLS     27
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:111  
         1 002010   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      711     9567    3              CALL ITE$ERROR(%E$CGMAP2BIG,ADDR(PACKET#_TEXT));

   9567  1 002011   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 002012   200016 451500                    STP1    SIZE+1,,AUTO
         1 002013   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 002014   200021 453500                    STP3    SIZE+4,,AUTO
         1 002015   000036 236000 2                  LDQ     30
         1 002016   200020 756100                    STQ     SIZE+3,,AUTO
         1 002017   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 002020   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002021   000000 701000 xent               TSX1    ITE$ERROR
         1 002022   000000 011000                    NOP     0

      712     9568    3              MM_CGQMAP_PGS = %MM_CGQMAX#;

   9568  1 002023   000012 235007                    LDA     10,DL
         1 002024   000000 755000 xsym               STA     MM_CGQMAP_PGS

      713     9569    3              END;

      714     9570        /**/
      715     9571    2           RETURN;

   9571  1 002025   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 002026   000001 702211                    TSX2  ! 1,X1

      716     9572    2   END;
      717     9573        /**/
      718     9574        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:112  
      719     9575        /**/
      720     9576    1   CGCXTSZ_OPT: PROC;

   9576  1 002027   200014 741300       CGCXTSZ_OPT  STX1  ! RAT$+2,,AUTO

      721     9577        /**/
      722     9578    2           MM_CGQRES_PGS = CMD$->IT$MONOPT.OPTS.VAL1; /*CG PAGE TABLE ENTRIES*/

   9578  1 002030   200011 470500                    LDP0    CMD$,,AUTO
         1 002031   000001 235100                    LDA     1,,PR0
         1 002032   000000 755000 xsym               STA     MM_CGQRES_PGS

      723     9579    2           IF (MM_CGQRES_PGS < %MIN_CGCXTSZ) OR (MM_CGQRES_PGS > %MAX_CGCXTSZ)

   9579  1 002033   000004 115007                    CMPA    4,DL
         1 002034   002037 602000 1                  TNC     s:9581
         1 002035   000377 115007                    CMPA    255,DL
         1 002036   002070 602000 1                  TNC     s:9587

      724     9580    3           THEN DO;                        /*NUMBER NOT WITHIN RANGE*/

      725     9581    3              CALL BINCHAR(PACKET#_TEXT.TEXT,%MAX_CGCXTSZ);

   9581  1 002037   000376 236007                    LDQ     254,DL
         1 002040   000000 235003                    LDA     0,DU
         1 002041   200016 757100                    STAQ    SIZE+1,,AUTO
         1 002042   000100 301500                    BTD
         1 002043   200016 000010                    NDSC9   SIZE+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 002044   200006 230007                    NDSC9   PACKET#_TEXT,,AUTO       cn=1,s=nosgn,sf=0,n=7

      726     9582    3              CALL INDEX(I,' ',PACKET#_TEXT.TEXT);

   9582  1 002045   000000 124500                    SCM     mask='000'O
         1 002046   200006 200007                    ADSC9   PACKET#_TEXT,,AUTO       cn=1,n=7
         1 002047   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 002050   200004 000100                    ARG     I,,AUTO

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:113  
      727     9583    3              PACKET#_TEXT.COUNT = I;

   9583  1 002051   200004 236100                    LDQ     I,,AUTO
         1 002052   000033 736000                    QLS     27
         1 002053   200006 552140                    STBQ    PACKET#_TEXT,'40'O,AUTO

      728     9584    3              CALL ITE$ERROR(%E$CGCXTSZERR,ADDR(PACKET#_TEXT));

   9584  1 002054   200006 631500                    EPPR1   PACKET#_TEXT,,AUTO
         1 002055   200016 451500                    STP1    SIZE+1,,AUTO
         1 002056   200016 633500                    EPPR3   SIZE+1,,AUTO
         1 002057   200021 453500                    STP3    SIZE+4,,AUTO
         1 002060   000040 236000 2                  LDQ     32
         1 002061   200020 756100                    STQ     SIZE+3,,AUTO
         1 002062   200020 630500                    EPPR0   SIZE+3,,AUTO
         1 002063   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002064   000000 701000 xent               TSX1    ITE$ERROR
         1 002065   000000 011000                    NOP     0

      729     9585    3              MM_CGQRES_PGS = %MAX_CGCXTSZ;

   9585  1 002066   000376 235007                    LDA     254,DL
         1 002067   000000 755000 xsym               STA     MM_CGQRES_PGS

      730     9586    3              END;

      731     9587    2           RETURN;

   9587  1 002070   200014 221300                    LDX1  ! RAT$+2,,AUTO
         1 002071   000001 702211                    TSX2  ! 1,X1

      732     9588        /**/
      733     9589    2   END;
      734     9590        /**/
      735     9591        %EJECT;
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:114  
      736     9592        /**/
      737     9593    1   DUMPSIZE_OPT: PROC;

   9593  1 002072   200014 741300       DUMPSIZE_OPT STX1  ! RAT$+2,,AUTO

      738     9594        /**/
      739     9595    2           IT_DUMPSIZE = CMD$ -> IT$MONOPT.OPTS.VAL1;

   9595  1 002073   200011 470500                    LDP0    CMD$,,AUTO
         1 002074   000001 235100                    LDA     1,,PR0
         1 002075   000000 755000 xsym               STA     IT_DUMPSIZE

      740     9596    2           RETURN;

   9596  1 002076   000001 702211                    TSX2  ! 1,X1

(unnamed)
 Sect OctLoc
   0     000   072123 110101   122105 104137   123120 105103   111101 114040    :SHARED_SPECIAL
   0     004   104105 114124   101040 040040   072123 110101   122105 104137    DELTA   :SHARED_
   0     010   123131 123124   105115 040040   114117 107117   116040 040040    SYSTEM  LOGON
   0     014   111102 105130   040040 040040                                    IBEX

(unnamed)
 Sect OctLoc
   2     000   000000 000077   000000 006000   000000 000241   000002 006000    ...?............
   2     004   007777 777777   777777 777000   000000 000164   000006 006000    ...........t....
   2     010   777037 777777   000000 000252   000011 006000   000000 000253    ................
   2     014   000013 006000   000000 000251   000015 006000   000000 000055    ...............-
   2     020   000017 006000   000000 000254   000021 006000   000000 000172    ...............z
   2     024   000023 006000   000000 000173   000025 006000   000000 000150    .......{.......h
   2     030   000027 006000   000000 000026   000031 006000   000000 000102    ...............B
   2     034   000033 006000   000000 000224   000035 006000   000000 000225    ................
   2     040   000037 006000                                                    ....
      741     9597    2   END;
      742     9598        /**/
      743     9599        /**/
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:115  
      744     9600    1   END;

PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:116  
--  Include file information  --

   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   IT$RES.:E05TOU  cannot be made into a system file and is referenced.
   IT$SPROCDS.:E05TOU  cannot be made into a system file and is referenced.
   IT$SPROC.:E05TOU  cannot be made into a system file and is referenced.
   IT$MONOPT.:E05TOU  cannot be made into a system file and is referenced.
   IT$CMDWD.:E05TOU  cannot be made into a system file and is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   K_INTERFACE_M.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   UM_CP6.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   FM_CACHE_C.:E05TOU  is referenced.
   FM_CACHE_R.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:117  
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   IT_ERROR_C.:E05TOU  is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure ITM$MON.
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:118  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PTR$                     11-0-0/w PTR         r     1 CMD$
     6-0-0/c STRC(72)    r     1 DSEG_TEXT                  4-0-0/w SBIN        r     1 I
     5-0-0/w SBIN        r     1 J                          6-0-0/c STRC(72)    r     1 PACKET#_TEXT
    *0-0-0/w PTR         r     1 PTR$                      12-0-0/w PTR         r     1 RAT$
    10-0-0/w PTR         r     1 REQ$                      10-0-0/w STRC        r     1 REREQ$
    15-0-0/w SBIN        r     1 SIZE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS5$                     0-0-0/w PTR         r     1 B$DS6$
     0-0-0/w PTR         r     1 B$USRT$                    0-0-0/d STRC(540)   r     1 B_MONINFO
     0-0-0/w UBIN        r     1 B_MUAIS                    0-0-0/w PTR         r     1 FMC_CACHE$
     0-0-0/w PTR         r     1 FMC_CACHEPGCNT$            0-0-0/w STRC        r     1 FMC_CACHEPGCNT$R
     0-0-0/w SBIN        r     1 FMC_CACHESIZ               0-0-0/w SBIN        r     1 FMC_CACHESIZN
     0-0-0/b BIT         r     1 FMC_MASK
     0-0-0/b BIT         r     1 FMC_MASKTBL(0:17)
     0-0-0/w PTR         r     1 FMC_STATS$                 0-0-0/w PTR         r     1 FMC_TYPTBL$
     0-0-0/w PTR         r     1 FR$HD$(0:3)                0-0-0/w UBIN        r     1 FR_FEPRES#
     0-0-0/w SBIN        r     1 FR_MEMM(0:0)
     0-0-0/w PTR         r     1 FR_PRM$(0:0)
     0-0-0/w SBIN        r     1 FR_SUMT(0:0)
     0-0-0/w SBIN        r     1 FR_SUMX
     0-0-0/c CHAR(8)     r     1 FR_SUNM(0:0)
     0-0-0/w BIT         r     1 HW_IMX                     0-0-0/w UBIN        r     1 IT_DUMPSIZE
     0-0-0/b UBIN(9)     r     1 IT_MMDSMAX(0:0)
     0-0-0/w UBIN        r     1 IT_PATCHSP                 0-0-0/w UBIN        r     1 KIS_SSN_CLIENTS
     0-0-0/w UBIN        r     1 KIS_SSN_MAX                0-0-0/w UBIN        r     1 KIS_SSN_SERVERS
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:119  
     0-0-0/w UBIN        r     1 KI_NODES                   0-0-0/w UBIN        r     1 KI_OSIMAX#
     0-0-0/w PTR         r     1 KI_OSIROUTE$$              0-0-0/w PTR         r     1 KI_ROUTE$$
     0-0-0/w PTR         r     1 KI_TCTX$$                  0-0-0/w UBIN        r     1 KI_TCTX_MAX#
     0-0-0/w PTR         r     1 MM_BYP$                    0-0-0/w UBIN        r     1 MM_CGQMAP_PGS
     0-0-0/w UBIN        r     1 MM_CGQRES_PGS              0-0-0/w SBIN        r     1 MM_RDS(0:7)
     0-0-0/w SBIN        r     1 MM_RSVP                    0-0-0/w SBIN        r     1 MM_STLM
     0-0-0/w PTR         r     1 N$DCT$$                    0-0-0/w PTR         r     1 N$FQ$
     0-0-0/w PTR         r     1 NI$FQ$                     0-0-0/w PTR         r     1 NI$IBUF$
     0-0-0/w PTR         r     1 NI$IOQ$                    0-0-0/w PTR         r     1 NI$RP$
     0-0-0/w SBIN        r     1 NI_NUMIOQ                  0-0-0/w SBIN        r     1 NI_NUMIOS
     0-0-0/w UBIN        r     1 NK_CUR                     0-0-0/w UBIN        r     1 NK_MXLOCAL
     0-0-0/w UBIN        r     1 NK_MXTOTAL                 0-0-0/w SBIN        r     1 N_DCTXMAX
     0-0-0/w UBIN        r     1 P_AUTOSPACE                0-0-0/w UBIN        r     1 P_MAXPROCS
     0-0-0/w UBIN        r     1 P_NPROCS                   0-0-0/w PTR         r     1 P_RESOURCE$
     0-0-0/w PTR         r     1 S_DL$                      0-0-0/w SBIN        r     1 S_HQ(0:8191)
     0-0-0/w UBIN        r     1 S_NSCPU                    0-0-0/w SBIN        r     1 S_TQ(0:8191)
     0-0-0/w SBIN        r     1 S_TUIS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(396)   r     1 B$DO                       0-0-0/d STRC(576)   r     1 B$U
     0-0-0/w STRC(576)   r     1 B$USER(0:0)
     0-0-0/w STRC(216)   r     1 FMC$CACHETBL(0:0)
     0-0-0/w STRC(2376)  r     1 FMC$STATS
     0-0-0/w STRC(72)    r     1 FMC$TYPTBL(0:10)
     0-0-0/w SBIN        r     1 FR$PR(0:0)                 0-0-0/w STRC(324)   r     1 FR$RAT
     0-0-0/w UBIN        r     1 IT$CMDWD                   0-0-0/w STRC(108)   r     1 IT$MONOPT
     0-0-0/w STRC(972)   r     1 IT$RES                     0-0-0/w STRC(360)   r     1 IT$SPROC
     0-0-0/w STRC(360)   r     1 IT$SPROCDS
     0-0-0/w PTR         r     1 KI$OSIROUTE$(0:0)
     0-0-0/w PTR         r     1 KI$ROUTE$(0:0)
     0-0-0/w STRC(1620)  r     1 KI$TCTX
     0-0-0/w PTR         r     1 KI$TCTX$(0:0)
     0-0-0/w STRC(180)   r     1 N$FQ                       0-0-0/d STRC(1080)  r     1 N$REQ
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:120  
     0-0-0/w STRC(144)   r     1 NI$FQ                      0-0-0/d STRC(504)   r     1 NI$REQ
     0-0-0/d STRC(864)   r     1 NK$LDCT                    0-0-0/w STRC(2268)  r     1 P_RESOURCE


   Procedure ITM$MON requires 1087 words for executable code.
   Procedure ITM$MON requires 18 words of local(AUTO) storage.

    No errors detected in file ITM$MON.:E05TSI    .
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:121  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:122  
          MINI XREF LISTING

B$DO
      7860**DCL      9413--CALL     9422<<ASSIGN   9423--ASSIGN   9424--ASSIGN   9427--ASSIGN
B$DO.ECCINFO
      7876**DCL      7877--REDEF
B$DO.LNK$
      7861**DCL      9423<<ASSIGN   9428<<ASSIGN
B$DS5$
      8895**DCL      9022>>ASSIGN
B$DS6$
      8896**DCL      9003>>ASSIGN   9004>>ASSIGN   9005>>ASSIGN   9006>>ASSIGN   9007>>ASSIGN   9008>>ASSIGN
      9009>>ASSIGN   9010>>ASSIGN   9011>>ASSIGN   9012>>ASSIGN   9013>>ASSIGN   9014>>ASSIGN   9015>>ASSIGN
      9016>>ASSIGN   9017>>ASSIGN   9018>>ASSIGN   9116>>ASSIGN   9116>>ASSIGN   9119>>ASSIGN   9119>>ASSIGN
      9122>>ASSIGN   9122>>ASSIGN
B$U
      7741**DCL      9141--CALL
B$U.MISC
      7855**DCL      7856--REDEF
B$USER
      7900**DCL      9144<<ASSIGN   9148<<ASSIGN
B$USER.BL
      7904**DCL      9152<<ASSIGN   9162<<ASSIGN
B$USER.CPU
      7917**DCL      9154<<ASSIGN
B$USER.DL$
      7927**DCL      9150<<ASSIGN
B$USER.FL
      7903**DCL      9151<<ASSIGN   9157<<ASSIGN   9159<<ASSIGN
B$USER.MISC
      7931**DCL      7932--REDEF
B$USER.US
      7918**DCL      9145<<ASSIGN   9149<<ASSIGN   9158<<ASSIGN
B$USRT$
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:123  
      7943**DCL      9131<<ASSIGN   9144>>ASSIGN   9145>>ASSIGN   9148>>ASSIGN   9149>>ASSIGN   9150>>ASSIGN
      9151>>ASSIGN   9152>>ASSIGN   9154>>ASSIGN   9157>>ASSIGN   9158>>ASSIGN   9159>>ASSIGN   9162>>ASSIGN
B_MONINFO.NUM_NODES
      8950**DCL      9240<<ASSIGN   9241>>ASSIGN
B_MUAIS
      8908**DCL      9133<<ASSIGN   9134>>IF       9137<<ASSIGN   9139>>ASSIGN   9141>>CALL     9147>>DOINDEX
      9159>>ASSIGN   9161>>ASSIGN
CFU_OPT
      9456**PROC     9052--CALL
CGCXTSZ_OPT
      9576**PROC     9076--CALL
CGMAP_OPT
      9560**PROC     9073--CALL
CMD$
      8976**DCL      9022<<ASSIGN   9024<<ASSIGN   9024>>ASSIGN   9026>>DOWHILE  9028>>DOCASE   9101<<ASSIGN
      9101>>ASSIGN   9101>>ASSIGN   9114>>ASSIGN   9116>>ASSIGN   9119>>ASSIGN   9133>>ASSIGN   9179>>CALL
      9182>>ASSIGN   9183>>ASSIGN   9184>>ASSIGN   9187>>DOINDEX  9209>>IF       9240>>ASSIGN   9261>>ASSIGN
      9290>>ASSIGN   9306>>ASSIGN   9322>>ASSIGN   9340>>ASSIGN   9366>>ASSIGN   9394>>ASSIGN   9404>>ASSIGN
      9413>>CALL     9416>>ASSIGN   9417>>ASSIGN   9420>>DOINDEX  9439>>ASSIGN   9440>>ASSIGN   9458>>ASSIGN
      9459>>ASSIGN   9474>>ASSIGN   9475>>ASSIGN   9485>>IF       9489>>ASSIGN   9501>>DOWHILE  9506>>IF
      9539>>ASSIGN   9547>>ASSIGN   9549>>IF       9550>>ASSIGN   9553>>ASSIGN   9554>>ASSIGN   9562>>ASSIGN
      9578>>ASSIGN   9595>>ASSIGN
DEVMAX_OPT
      9481**PROC     9037--CALL
DOLIST_OPT
      9409**PROC     9046--CALL
DOLIST_OPT_ERR IN PROCEDURE DOLIST_OPT
      9432**LABEL    9413--CALLALT
DSEG_TEXT
      8968**DCL      9298--CALL     9314--CALL     9330--CALL     9374--CALL     9444--CALL     9463--CALL
DSEG_TEXT.COUNT
      8969**DCL      9297<<ASSIGN   9313<<ASSIGN   9329<<ASSIGN   9373<<ASSIGN   9443<<ASSIGN   9462<<ASSIGN
DSEG_TEXT.TEXT
      8970**DCL      9296<<CALLBLT  9312<<CALLBLT  9328<<CALLBLT  9372<<CALLBLT  9442<<CALLBLT  9461<<CALLBLT
DUMPSIZE_OPT
      9593**PROC     9067--CALL
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:124  
ENQ_OPT
      9437**PROC     9049--CALL
ERR IN PROCEDURE IOCACHE_OPT
      9533**LABEL    9516--CALLALT  9520--CALLALT  9523--CALLALT
FEPRES_OPT
      9260**PROC     9082--CALL
FMC$CACHETBL
      8077**DCL      9516--CALL     9529<<ASSIGN
FMC$STATS
      8099**DCL      9523--CALL     9525<<ASSIGN
FMC$TYPTBL
      8108**DCL      9520--CALL     9526<<ASSIGN
FMC_CACHE$
      4146**DCL      8077--IMP-PTR  9515<<ASSIGN   9529>>ASSIGN
FMC_CACHEPGCNT$
      4147**DCL      4147--IMP-PTR  4147--REDEF
FMC_CACHEPGCNT$R.SID
      4148**DCL      9499<<ASSIGN
FMC_CACHESIZ
      4146**DCL      9507<<ASSIGN   9509<<ASSIGN   9512>>ASSIGN   9513>>ASSIGN   9516>>CALL     9528>>DOINDEX
FMC_CACHESIZN
      4146**DCL      9510<<ASSIGN
FMC_MASK
      4148**DCL      9505<<ASSIGN   9509>>ASSIGN
FMC_MASKTBL
      4148**DCL      9501>>DOWHILE  9505>>ASSIGN
FMC_STATS$
      4146**DCL      8099--IMP-PTR  9522<<ASSIGN   9525>>ASSIGN
FMC_TYPTBL$
      4146**DCL      8108--IMP-PTR  9519<<ASSIGN   9526>>ASSIGN
FR$HD$
      4278**DCL      9263>>ASSIGN   9271<<ASSIGN
FR$PR
      4284**DCL      9282<<ASSIGN   9282>>ASSIGN
FR$RAT.DCTX
      4321**DCL      9277<<ASSIGN
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:125  
FR$RAT.FLG.DOWN
      4338**DCL      9280<<ASSIGN
FR$RAT.LNK$
      4304**DCL      9264>>DOWHILE  9265>>ASSIGN   9273<<ASSIGN
FR$RAT.RCOD
      4316**DCL      9278<<ASSIGN
FR$RAT.TYP
      4327**DCL      9279<<ASSIGN
FR_FEPRES#
      4298**DCL      9261<<ASSIGN   9268>>DOINDEX  9282>>ASSIGN
FR_MEMM
      4287**DCL      9550<<ASSIGN
FR_PRM$
      4285**DCL      9282>>ASSIGN   9282>>ASSIGN
FR_SUMT
      4291**DCL      9554<<ASSIGN
FR_SUMX
      4293**DCL      9547<<ASSIGN   9552>>DOINDEX
FR_SUNM
      4294**DCL      9553<<ASSIGN
HW_IMX
      1044**DCL      9197>>IF       9219>>IF
I
      8963**DCL      9147<<DOINDEX  9148>>ASSIGN   9149>>ASSIGN   9150>>ASSIGN   9151>>ASSIGN   9151>>ASSIGN
      9152>>ASSIGN   9152>>ASSIGN   9153>>IF       9154>>ASSIGN   9187<<DOINDEX  9198<<ASSIGN   9203<<ASSIGN
      9204<<ASSIGN   9204>>ASSIGN   9207<<ASSIGN   9207>>ASSIGN   9209>>IF       9211>>CALLBLT  9215>>ASSIGN
      9216>>ASSIGN   9217>>ASSIGN   9222>>DOINDEX  9248<<DOINDEX  9249>>ASSIGN   9268<<DOINDEX  9347<<DOINDEX
      9348>>ASSIGN   9350>>ASSIGN   9380<<DOINDEX  9381>>ASSIGN   9420<<DOINDEX  9500<<ASSIGN   9501>>DOWHILE
      9502<<ASSIGN   9502>>ASSIGN   9505>>ASSIGN   9510>>ASSIGN   9528<<DOINDEX  9529>>ASSIGN   9552<<DOINDEX
      9553>>ASSIGN   9553>>ASSIGN   9554>>ASSIGN   9554>>ASSIGN   9565<<CALLBLT  9566>>ASSIGN   9582<<CALLBLT
      9583>>ASSIGN
IOCACHE_OPT
      9497**PROC     9058--CALL
IT$CMDWD
      7655**DCL      9024--ASSIGN   9026>>DOWHILE
IT$MONOPT.CNTWD.OFFSET
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:126  
      7667**DCL      9101>>ASSIGN
IT$MONOPT.CNTWD.TYPE
      7668**DCL      9028>>DOCASE
IT$MONOPT.OPTS.VAL1
      7670**DCL      9133>>ASSIGN   9209>>IF       9240>>ASSIGN   9261>>ASSIGN   9290>>ASSIGN   9306>>ASSIGN
      9322>>ASSIGN   9340>>ASSIGN   9366>>ASSIGN   9394>>ASSIGN   9404>>ASSIGN   9413>>CALL     9416>>ASSIGN
      9417>>ASSIGN   9420>>DOINDEX  9439>>ASSIGN   9458>>ASSIGN   9474>>ASSIGN   9485>>IF       9489>>ASSIGN
      9501>>DOWHILE  9506>>IF       9539>>ASSIGN   9562>>ASSIGN   9578>>ASSIGN   9595>>ASSIGN
IT$MONOPT.OPTS.VAL2
      7671**DCL      9179>>CALL     9182>>ASSIGN   9183>>ASSIGN   9184>>ASSIGN   9187>>DOINDEX  9440>>ASSIGN
      9459>>ASSIGN   9475>>ASSIGN
IT$RES.MAXRESX
      7719**DCL      9547>>ASSIGN
IT$RES.MMTOT
      7720**DCL      9549>>IF       9550>>ASSIGN
IT$RES.RES.NAME
      7722**DCL      9553>>ASSIGN
IT$RES.RES.TOT
      7723**DCL      9554>>ASSIGN
IT$SPROC.FLGS
      7688**DCL      9119>>ASSIGN
IT$SPROC.NAME
      7685**DCL      9116>>ASSIGN
IT$SPROC.OVERLAY
      7689**DCL      9114>>ASSIGN
IT$SPROCDS.COUNT
      7699**DCL      9003<<ASSIGN   9116>>ASSIGN   9119>>ASSIGN   9122<<ASSIGN   9122>>ASSIGN
IT$SPROCDS.PROCS.FLGS
      7704**DCL      9006<<ASSIGN   9009<<ASSIGN   9012<<ASSIGN   9015<<ASSIGN   9018<<ASSIGN   9119<<ASSIGN
IT$SPROCDS.PROCS.NAME
      7701**DCL      9116<<ASSIGN
IT$SPROCDS.PROCS.NAME.COUNT
      7702**DCL      9004<<ASSIGN   9007<<ASSIGN   9010<<ASSIGN   9013<<ASSIGN   9016<<ASSIGN
IT$SPROCDS.PROCS.NAME.TEXT
      7703**DCL      9005<<ASSIGN   9008<<ASSIGN   9011<<ASSIGN   9014<<ASSIGN   9017<<ASSIGN
ITE$ERROR
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:127  
      8956**DCL-ENT  9136--CALL     9212--CALL     9298--CALL     9314--CALL     9330--CALL     9374--CALL
      9444--CALL     9463--CALL     9486--CALL     9567--CALL     9584--CALL
ITF$FREEZE
      8957**DCL-ENT  9106--CALL
ITH$ALLOCATE
      8959**DCL-ENT  9001--CALL     9141--CALL     9179--CALL     9246--CALL     9342--CALL     9351--CALL
      9378--CALL     9413--CALL     9516--CALL     9520--CALL     9523--CALL
ITH$RAT_INIT
      8958**DCL-ENT  9274--CALL
ITM$MON_ERR
      9106**LABEL    9001--CALLALT  9034--CALLALT  9040--CALLALT  9046--CALLALT  9058--CALLALT  9079--CALLALT
      9082--CALLALT  9094--CALLALT  9097--CALLALT
IT_DUMPSIZE
      8914**DCL      9595<<ASSIGN
IT_MMDSMAX
      8912**DCL      9440<<ASSIGN   9441>>IF       9445<<ASSIGN   9448>>ASSIGN   9449>>ASSIGN   9459<<ASSIGN
      9460>>IF       9464<<ASSIGN   9491<<ASSIGN
IT_PATCHSP
      8913**DCL      9539<<ASSIGN
J
      8964**DCL      9222<<DOINDEX
KI$OSIROUTE.LNSAP.ADDRESS_N
      8828**DCL      8829--REDEF
KI$OSIROUTE.NSAP.ADDRESS_N
      8738**DCL      8739--REDEF
KI$OSIROUTE$
      8889**DCL      9381<<ASSIGN
KI$ROUTE$
      8887**DCL      9249<<ASSIGN
KI$TCTX
      8113**DCL      9349<<ASSIGN   9351--CALL
KI$TCTX.SRC_REF
      8148**DCL      9350<<ASSIGN
KI$TCTX.SSN.DST_NSAP.ADDRESS_N
      8569**DCL      8570--REDEF
KI$TCTX.SSN.SRC_NSAP.ADDRESS_N
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:128  
      8509**DCL      8510--REDEF
KI$TCTX.SSN.TPDUSIZE
      8272**DCL      8273--REDEF
KI$TCTX$
      8888**DCL      9346<<ASSIGN   9348<<ASSIGN
KIS_SSN_CLIENTS
      8905**DCL      9290<<ASSIGN   9292>>IF       9294<<ASSIGN
KIS_SSN_MAX
      8907**DCL      9322<<ASSIGN   9324>>IF       9326<<ASSIGN
KIS_SSN_SERVERS
      8906**DCL      9306<<ASSIGN   9308>>IF       9310<<ASSIGN
KI_NODES
      8904**DCL      9241<<ASSIGN   9246>>CALL     9248>>DOINDEX
KI_OSIMAX#
      8902**DCL      9366<<ASSIGN   9368>>IF       9370<<ASSIGN   9378>>CALL     9380>>DOINDEX
KI_OSIROUTE$$
      8901**DCL      8889--IMP-PTR  9377<<ASSIGN   9381>>ASSIGN
KI_ROUTE$$
      8903**DCL      8887--IMP-PTR  9245<<ASSIGN   9249>>ASSIGN
KI_TCTX$$
      8900**DCL      8888--IMP-PTR  9341<<ASSIGN   9346>>ASSIGN   9348>>ASSIGN
KI_TCTX_MAX#
      8899**DCL      9340<<ASSIGN   9342>>CALL     9347>>DOINDEX
MM$DESC.BOUND
       953**DCL       954--REDEF
MM$DESC.FLGS
       954**DCL       954--REDEF
MM$PPUT.USER#
       942**DCL       942--REDEF
MM_BYP$
       873**DCL       873--IMP-PTR
MM_CGQMAP_PGS
       879**DCL      9562<<ASSIGN   9563>>IF       9568<<ASSIGN
MM_CGQRES_PGS
       880**DCL      9578<<ASSIGN   9579>>IF       9579>>IF       9585<<ASSIGN
MM_RDS
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:129  
       876**DCL      9439<<ASSIGN   9458<<ASSIGN
MM_RSVP
       876**DCL      9474<<ASSIGN
MM_STLM
       876**DCL      9475<<ASSIGN
N$DCT$$
      3999**DCL      4133--IMP-PTR
N$FQ.HD$
      4134**DCL      9175<<ASSIGN   9186>>ASSIGN   9195>>ASSIGN
N$FQ$
      3999**DCL      4134--IMP-PTR  9175>>ASSIGN   9186>>ASSIGN   9195>>ASSIGN
N$REQ
      7955**DCL      9179--CALL     9189<<ASSIGN   9190--ASSIGN   9191--ASSIGN   9194--ASSIGN
N$REQ.BUFADDR
      7964**DCL      7965--REDEF    7965--REDEF
N$REQ.DLA.DRELADDR
      7956**DCL      7956--REDEF
N$REQ.DVE.EOMCHAR
      7993**DCL      7994--REDEF
N$REQ.EAINFO
      7987**DCL      7987--REDEF
N$REQ.EAINFOX
      7987**DCL      7988--REDEF
N$REQ.EVNTINFO
      7988**DCL      7988--REDEF
N$REQ.FL$
      7955**DCL      9190<<ASSIGN   9195<<ASSIGN
N$REQ.STATUS
      7969**DCL      7975--REDEF
N$REQ_INIT.BUFADDR
      4018**DCL      4019--REDEF    4019--REDEF
N$REQ_INIT.DLA.DRELADDR
      4010**DCL      4010--REDEF
N$REQ_INIT.DVE.EOMCHAR
      4047**DCL      4048--REDEF
N$REQ_INIT.EAINFO
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:130  
      4041**DCL      4041--REDEF
N$REQ_INIT.EAINFOX
      4041**DCL      4042--REDEF
N$REQ_INIT.EVNTINFO
      4042**DCL      4042--REDEF
N$REQ_INIT.STATUS
      4023**DCL      4029--REDEF
NI$FQ.HD$
      4135**DCL      9202>>ASSIGN   9229>>ASSIGN
NI$FQ$
      4059**DCL      4135--IMP-PTR  9202>>ASSIGN   9229>>ASSIGN
NI$IBUF$
      4059**DCL      4135--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
      4069**DCL      4070--REDEF    4070--REDEF
NI$IMXMBX_INIT.SIZE
      4071**DCL      4071--REDEF
NI$IOQ$
      4081**DCL      9177<<ASSIGN
NI$REQ
      8013**DCL      9205--ASSIGN   9223<<ASSIGN
NI$REQ.DCW
      8015**DCL      8018--REDEF
NI$REQ.DCW.TALLY
      8016**DCL      8016--REDEF
NI$REQ.FL$
      8013**DCL      9224<<ASSIGN   9229<<ASSIGN
NI$REQ.IDCW.EXTA
      8018**DCL      8018--REDEF
NI$REQ.PCW
      8020**DCL      8024--REDEF
NI$REQ.SEEK
      8025**DCL      8026--REDEF    8027--REDEF
NI$REQ_INIT.DCW
      4093**DCL      4096--REDEF
NI$REQ_INIT.DCW.TALLY
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:131  
      4094**DCL      4094--REDEF
NI$REQ_INIT.IDCW.EXTA
      4096**DCL      4096--REDEF
NI$REQ_INIT.PCW
      4098**DCL      4102--REDEF
NI$REQ_INIT.SEEK
      4103**DCL      4104--REDEF    4105--REDEF
NI$RP$
      4107**DCL      4137--IMP-PTR
NI_MBX_INIT.DCW.CONTROL.AE
      4129**DCL      4129--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
      4125**DCL      4125--REDEF
NI_NUMIOQ
      4132**DCL      9184<<ASSIGN
NI_NUMIOS
      4132**DCL      9217<<ASSIGN
NK$LDCT
      8042**DCL      9491--ASSIGN
NK$LDCT.DDT$
      8044**DCL      8044--REDEF
NK$LDCT.IOQ$
      8043**DCL      8044--REDEF
NK$LDCT.LDCTX
      8045**DCL      8045--REDEF
NK$LDCT.LKFLG.ABORTED
      8057**DCL      8058--REDEF
NK$LDCT.RLCID.LDCTX
      8067**DCL      8067--REDEF
NK$LDCT.STA$
      8063**DCL      8064--REDEF
NK$LDCT.SYMB$
      8042**DCL      8042--REDEF    8042--REDEF    8043--REDEF
NK_CUR
      8911**DCL      9484<<ASSIGN   9491>>ASSIGN
NK_MXLOCAL
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:132  
      8909**DCL      9483<<ASSIGN
NK_MXTOTAL
      8910**DCL      9490<<ASSIGN
NODES_OPT
      9238**PROC     9079--CALL
NODES_OPT_ERR IN PROCEDURE NODES_OPT
      9256**LABEL    9246--CALLALT
N_DCTXMAX
      4107**DCL      9483>>ASSIGN   9484>>ASSIGN   9485>>IF       9489<<ASSIGN   9490>>ASSIGN   9491>>ASSIGN
OSIROUTE_OPT
      9362**PROC     9097--CALL
OSIROUTE_OPT_ERR IN PROCEDURE OSIROUTE_OPT
      9387**LABEL    9378--CALLALT
PACKET#_TEXT
      8965**DCL      8968--REDEF    9212--CALL     9567--CALL     9584--CALL
PACKET#_TEXT.COUNT
      8966**DCL      9210<<ASSIGN   9566<<ASSIGN   9583<<ASSIGN
PACKET#_TEXT.TEXT
      8967**DCL      9211<<CALLBLT  9564<<CALLBLT  9565>>CALLBLT  9581<<CALLBLT  9582>>CALLBLT
PATCHSP_OPT
      9537**PROC     9061--CALL
PTR$
        15**DCL        13--PROC     8999>>ASSIGN   9001<>CALL     9131>>ASSIGN   9141<>CALL     9175>>ASSIGN
      9177>>ASSIGN   9179<>CALL     9245>>ASSIGN   9246<>CALL     9271>>ASSIGN   9273>>ASSIGN   9274<>CALL
      9341>>ASSIGN   9342<>CALL     9348>>ASSIGN   9349>>ASSIGN   9350>>ASSIGN   9351<>CALL     9377>>ASSIGN
      9378<>CALL     9411>>ASSIGN   9413<>CALL     9515>>ASSIGN   9516<>CALL     9519>>ASSIGN   9520<>CALL
      9522>>ASSIGN   9523<>CALL
P_AUTOSPACE
      3676**DCL      9404<<ASSIGN
P_MAXPROCS
      3673**DCL      9019<<ASSIGN   9019>>ASSIGN   9114<<ASSIGN   9114>>ASSIGN   9394<<ASSIGN   9394>>ASSIGN
P_NPROCS
      3672**DCL      9020<<ASSIGN   9020>>ASSIGN   9113<<ASSIGN   9113>>ASSIGN
P_NSCPU
      5741**DCL      5742--REDEF
P_RESOURCE
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:133  
      5582**DCL      9000<<ASSIGN   9001--CALL
P_RESOURCE.RES
      5614**DCL      5681--REDEF
P_RESOURCE.RES.DOLISTS.MIN
      5671**DCL      9417<<ASSIGN
P_RESOURCE.RES.DOLISTS.TOTAL
      5674**DCL      9416<<ASSIGN
P_RESOURCE.RES.ENQ.MIN
      5658**DCL      9449<<ASSIGN
P_RESOURCE.RES.ENQ.TOTAL
      5661**DCL      9448<<ASSIGN
P_RESOURCE.RES.IOCACHE.MIN
      5645**DCL      9513<<ASSIGN
P_RESOURCE.RES.IOCACHE.TOTAL
      5648**DCL      9512<<ASSIGN
P_RESOURCE.RES.NIREQCT.MIN
      5632**DCL      9216<<ASSIGN
P_RESOURCE.RES.NIREQCT.TOTAL
      5635**DCL      9215<<ASSIGN
P_RESOURCE.RES.NREQCT.MIN
      5619**DCL      9183<<ASSIGN
P_RESOURCE.RES.NREQCT.TOTAL
      5622**DCL      9182<<ASSIGN
P_RESOURCE$
      5694**DCL      5582--IMP-PTR  8999<<ASSIGN   9000>>ASSIGN   9182>>ASSIGN   9183>>ASSIGN   9215>>ASSIGN
      9216>>ASSIGN   9416>>ASSIGN   9417>>ASSIGN   9448>>ASSIGN   9449>>ASSIGN   9512>>ASSIGN   9513>>ASSIGN
P_UPTIME
      5730**DCL      5731--REDEF
QUEUE_OPT
      9171**PROC     9040--CALL
QUEUE_OPT_ERR IN PROCEDURE QUEUE_OPT
      9233**LABEL    9179--CALLALT
RAT$
      8977**DCL      9263<<ASSIGN   9264>>DOWHILE  9264>>DOWHILE  9265<<ASSIGN   9265>>ASSIGN   9269>>IF
      9273>>ASSIGN   9274<>CALL     9277>>ASSIGN   9278>>ASSIGN   9279>>ASSIGN   9280>>ASSIGN
REQ$
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:134  
      8972**DCL      8973--REDEF    9186<<ASSIGN   9189>>ASSIGN   9190>>ASSIGN   9190>>ASSIGN   9191<<ASSIGN
      9191>>ASSIGN   9194<<ASSIGN   9194>>ASSIGN   9195>>ASSIGN   9202<<ASSIGN   9223>>ASSIGN   9224>>ASSIGN
      9224>>ASSIGN   9225<<ASSIGN   9225>>ASSIGN   9228<<ASSIGN   9228>>ASSIGN   9229>>ASSIGN   9419<<ASSIGN
      9422>>ASSIGN   9423>>ASSIGN   9423>>ASSIGN   9424<<ASSIGN   9424>>ASSIGN   9427<<ASSIGN   9427>>ASSIGN
      9428>>ASSIGN
REREQ$.BASE
      8974**DCL      9204>>ASSIGN
RES_OPT
      9545**PROC     9064--CALL
SIZE IN PROCEDURE QUEUE_OPT
      9173**DCL      9199<<ASSIGN   9205<<ASSIGN   9207>>ASSIGN   9224>>ASSIGN   9225>>ASSIGN   9228>>ASSIGN
SPAUTOSPACE_OPT
      9402**PROC     9070--CALL
SPROC_OPT
      9111**PROC     9031--CALL
SPSPACE_OPT
      9392**PROC     9043--CALL
SSN_CLIENTS_OPT
      9289**PROC     9085--CALL
SSN_MAX_OPT
      9321**PROC     9091--CALL
SSN_SERVERS_OPT
      9305**PROC     9088--CALL
STEALPGS_OPT
      9472**PROC     9055--CALL
S_DL$
      8898**DCL      9411<<ASSIGN   9419>>ASSIGN
S_HQ
      3601**DCL      9160<<ASSIGN
S_NSCPU
      3604**DCL      9153>>IF
S_TQ
      3601**DCL      9161<<ASSIGN
S_TUIS
      3600**DCL      9139<<ASSIGN
TCTX_OPT
PL6.E3A0      #001=ITM$MON File=ITM$MON.:E05TSI                                  TUE 07/29/97 23:06 Page:135  
      9336**PROC     9094--CALL
TCTX_OPT_ERR IN PROCEDURE TCTX_OPT
      9357**LABEL    9342--CALLALT  9351--CALLALT
USERS_OPT
      9129**PROC     9034--CALL
USERS_OPT_ERR IN PROCEDURE USERS_OPT
      9166**LABEL    9141--CALLALT
