VERSION E05

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6
        7        7        /*M* THC$COMMANDS - COMMAND DRIVER FOR ELAN */
        8        8        THC$COMMANDS: PROC(TOP$);
        9        9    1   DCL TOP$ PTR;
       10       10        /**/
       11       11        /* INCLUDE FILES */
       12       12        %INCLUDE CP_6;
       13       93        %INCLUDE XU_MACRO_C;
       14     3199        %INCLUDE B_ERRORS_C;
       15     4326        %INCLUDE F$DCB;
       16     4375        %INCLUDE B$JIT;
       17     4665        %INCLUDE TH_DATA_R;
       18     4743        %INCLUDE TH_SUBS_C;
       19     5125        %INCLUDE TH_PERR_C;
       20     5166        /**/
       21     5167        /* ENTRY DEFS */
       22     5168    1   DCL THM$ERRMSG ENTRY(1);
       23     5169    1   DCL THC$SPAN ENTRY(1) ALTRET;
       24     5170    1   DCL THC$SELECT ENTRY(1) ALTRET;
       25     5171    1   DCL THC$HELP ENTRY(1);
       26     5172    1   DCL THC$REPORT ENTRY(1);
       27     5173    1   DCL THC$THRESH ENTRY(1);
       28     5174    1   DCL THC$STATUS ENTRY;
       29     5175        /**/
       30     5176        /* VARIABLES */
       31     5177    1   DCL I UBIN;
       32     5178    1   DCL B$JIT$ PTR SYMREF;
       33     5179        /**/
       34     5180        /* MACRO INVOCATIONS */
       35     5181        %VLP_NAME (FPTN=TH_VLP_ERRLOGX, LEN=31, STCLASS="STATIC SYMDEF");
       36     5208        %VLP_ACCT (FPTN=TH_VLP_ACCT, STCLASS="STATIC SYMDEF");
       37     5221        %FPT_FID (FPTN=FPT_FID, ACCT=TH_VLP_ACCT, NAME=TH_VLP_ERRLOGX,
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:2    
       38     5222                  ASN=TH_OPEN_ERRLOG.V.ASN#);
       39     5245        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
       40     5246                   STCLASS=SYMREF);
       41     5355        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
       42     5400        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(TOP$)");
       43     5438        /**/
       44     5439        %EJECT;
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:3    
       45     5440    2        DO CASE(OUT$BLK.CODE);
       46     5441    2           CASE(1);                        /* MULTIPLE COMMANDS                  */
       47     5442    3              DO I = 0 TO OUT$BLK.NSUBLKS - 1;
       48     5443    3                 CALL THC$COMMANDS(OUT$BLK.SUBLK$(I));
       49     5444    3              END;                         /* DO I                               */
       50     5445    2           CASE(%END_CMD);
       51     5446    2              TH_ENDFLAG = %TRUE;
       52     5447    2           CASE(%HELP_CMD);
       53     5448    2              CALL THC$HELP(OUT$BLK.SUBLK$(0));
       54     5449    2           CASE(%REPORT_CMD);
       55     5450    2              CALL THC$REPORT(TOP$);
       56     5451    2           CASE(%SELECT_CMD);
       57     5452    2              CALL THC$SELECT(OUT$BLK.SUBLK$(0)) ALTRET(RET_LBL);
       58     5453    2           CASE(%SPAN_CMD);
       59     5454    2              CALL THC$SPAN(TOP$) ALTRET(RET_LBL);
       60     5455    2           CASE(%THRESH_CMD);
       61     5456    2              CALL THC$THRESH(TOP$);
       62     5457    2           CASE(%STATUS_CMD);
       63     5458    2              CALL THC$STATUS;
       64     5459    2           CASE(%NULL_CMD);
       65     5460    2            CASE(%USE_CMD);
       66     5461    2             IF OUT$BLK.NSUBLKS <= 0
       67     5462    3              THEN DO;
       68     5463    3                 VLP_SYSTAC.ACCT# = B$JIT.FACCN;
       69     5464    3                 TH_CHANGE_ACCOUNT = '1'B;
       70     5465    3                 END;
       71     5466    3              ELSE DO;
       72     5467    3                 IF OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > 8
       73     5468    4                  THEN DO;
       74     5469    4                       CALL THM$ERRMSG(%E$TH_BAD_ACCOUNT_NAME);
       75     5470                            /*E* ERROR : THE-E$TH_BAD_ACCOUNT_NAME-O
       76     5471                                 MESSAGE: Bad account specification
       77     5472                            */
       78     5473    4                       TH_CHANGE_ACCOUNT = '0'B;
       79     5474    4                      END;
       80     5475    4                  ELSE DO;
       81     5476    4                      VLP_SYSTAC.ACCT# = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:4    
       82     5477    4                      TH_CHANGE_ACCOUNT = '1'B;
       83     5478    4                      END;
       84     5479    3                 END;
       85     5480                                                /* DO NOTHING                         */
       86     5481    2            CASE(%FILE_CMD);
       87     5482    2                IF (OUT$BLK.NSUBLKS <= 0)
       88     5483    3                   THEN DO;
       89     5484    3                     CALL THM$ERRMSG(%E$TH_BAD_FILE_NAME);
       90     5485                          /*E*  ERROR: THE-E$TH_BAD_FILE_NAME-0
       91     5486                                MESSAGE:  Bad file name               */
       92     5487    3                     TH_CHANGE_FILE = '0'B;
       93     5488    3                   END;
       94     5489    3                   ELSE DO;
       95     5490    3                     FPT_FID.TEXTFID_ = VECTOR( OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
       96     5491    3                     CALL M$FID(FPT_FID);
       97     5492    3                     TH_CHANGE_FILE = '1'B;
       98     5493    3                   END;
       99     5494    2            CASE(%PROMPT_CMD);
      100     5495    2                IF OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 0
      101     5496    3                  THEN DO;
      102     5497    3                          TH_PRMT.VFC = BITASC('036'O);
      103     5498    3                          TH_PRMT.TEXT = ' ';
      104     5499    3                          TH_PRMT_SIZE = 1;
      105     5500    3                       END;
      106     5501    3                  ELSE DO;
      107     5502    3                         TH_PRMT.TEXT= OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      108     5503    3                         TH_PRMT.VFC = BITASC('036'O);
      109     5504    3                          TH_PRMT_SIZE = OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT+ 1;
      110     5505    3                       END;
      111     5506    2                   TH_PRMT_FLAG = '1'B;
      112     5507    2        END;                               /* DO CASE                            */
      113     5508    1   RET_LBL:
      114     5509    1        RETURN;
      115     5510    1   END THC$COMMANDS;
      116     5511        %EOD;

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:5    
--  Include file information  --

   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$COMMANDS.

   Procedure THC$COMMANDS requires 160 words for executable code.
   Procedure THC$COMMANDS requires 8 words of local(AUTO) storage.

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:6    

 Object Unit name= THC$COMMANDS                               File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:06:33.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    34     42  THC$COMMANDS
    2   Proc  even  none   160    240  THC$COMMANDS
    3  RoData even  none     5      5  THC$COMMANDS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  THC$COMMANDS

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  TH_VLP_ERRLOGX                     1     10  TH_VLP_ACCT
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:7    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 THC$THRESH
         yes           Std       1 THC$HELP
         yes           Std       1 THC$REPORT
 yes     yes           Std       1 THC$SELECT
         yes           Std       0 THC$STATUS
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       1 THC$SPAN
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_ENDFLAG                            TH_XSA_BUF_VECTOR
     VLP_SYSTAC                            TH_CHANGE_ACCOUNT                     TH_CHANGE_FILE
     TH_PRMT_FLAG                          TH_PRMT                               TH_PRMT_SIZE
     B$JIT$                                TH_OPEN_ERRLOG                        B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:8    


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6
        7        7        /*M* THC$COMMANDS - COMMAND DRIVER FOR ELAN */
        8        8        THC$COMMANDS: PROC(TOP$);

      8  2 000000   000000 700200 xent  THC$COMMANDS TSX0  ! X66_AUTO_1
         2 000001   000010 000001                    ZERO    8,1

        9        9    1   DCL TOP$ PTR;
       10       10        /**/
       11       11        /* INCLUDE FILES */
       12       12        %INCLUDE CP_6;
       13       93        %INCLUDE XU_MACRO_C;
       14     3199        %INCLUDE B_ERRORS_C;
       15     4326        %INCLUDE F$DCB;
       16     4375        %INCLUDE B$JIT;
       17     4665        %INCLUDE TH_DATA_R;
       18     4743        %INCLUDE TH_SUBS_C;
       19     5125        %INCLUDE TH_PERR_C;
       20     5166        /**/
       21     5167        /* ENTRY DEFS */
       22     5168    1   DCL THM$ERRMSG ENTRY(1);
       23     5169    1   DCL THC$SPAN ENTRY(1) ALTRET;
       24     5170    1   DCL THC$SELECT ENTRY(1) ALTRET;
       25     5171    1   DCL THC$HELP ENTRY(1);
       26     5172    1   DCL THC$REPORT ENTRY(1);
       27     5173    1   DCL THC$THRESH ENTRY(1);
       28     5174    1   DCL THC$STATUS ENTRY;
       29     5175        /**/
       30     5176        /* VARIABLES */
       31     5177    1   DCL I UBIN;
       32     5178    1   DCL B$JIT$ PTR SYMREF;
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:9    
       33     5179        /**/
       34     5180        /* MACRO INVOCATIONS */
       35     5181        %VLP_NAME (FPTN=TH_VLP_ERRLOGX, LEN=31, STCLASS="STATIC SYMDEF");
       36     5208        %VLP_ACCT (FPTN=TH_VLP_ACCT, STCLASS="STATIC SYMDEF");
       37     5221        %FPT_FID (FPTN=FPT_FID, ACCT=TH_VLP_ACCT, NAME=TH_VLP_ERRLOGX,
       38     5222                  ASN=TH_OPEN_ERRLOG.V.ASN#);
       39     5245        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
       40     5246                   STCLASS=SYMREF);
       41     5355        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
       42     5400        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(TOP$)");
       43     5438        /**/
       44     5439        %EJECT;
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:10   
       45     5440    2        DO CASE(OUT$BLK.CODE);

   5440  2 000002   200003 470500                    LDP0    @TOP$,,AUTO
         2 000003   000000 471500                    LDP1    0,,PR0
         2 000004   100000 720100                    LXL0    0,,PR1
         2 000005   000015 100003                    CMPX0   13,DU
         2 000006   000010 602010 2                  TNC     s:5440+6,X0
         2 000007   000237 710000 2                  TRA     RET_LBL
         2 000010   000237 710000 2                  TRA     RET_LBL
         2 000011   000025 710000 2                  TRA     s:5442
         2 000012   000056 710000 2                  TRA     s:5448
         2 000013   000065 710000 2                  TRA     s:5450
         2 000014   000072 710000 2                  TRA     s:5452
         2 000015   000101 710000 2                  TRA     s:5454
         2 000016   000237 710000 2                  TRA     RET_LBL
         2 000017   000106 710000 2                  TRA     s:5456
         2 000020   000113 710000 2                  TRA     s:5458
         2 000021   000117 710000 2                  TRA     s:5461
         2 000022   000203 710000 2                  TRA     s:5495
         2 000023   000053 710000 2                  TRA     s:5446
         2 000024   000154 710000 2                  TRA     s:5482

       46     5441    2           CASE(1);                        /* MULTIPLE COMMANDS                  */

       47     5442    3              DO I = 0 TO OUT$BLK.NSUBLKS - 1;

   5442  2 000025   200004 450100                    STZ     I,,AUTO
         2 000026   000043 710000 2                  TRA     s:5444+3

       48     5443    3                 CALL THC$COMMANDS(OUT$BLK.SUBLK$(I));

   5443  2 000027   200003 470500                    LDP0    @TOP$,,AUTO
         2 000030   000000 471500                    LDP1    0,,PR0
         2 000031   200004 720100                    LXL0    I,,AUTO
         2 000032   100003 633510                    EPPR3   3,X0,PR1
         2 000033   200006 453500                    STP3    I+2,,AUTO
         2 000034   200006 630500                    EPPR0   I+2,,AUTO
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:11   
         2 000035   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000036   000000 701000 2                  TSX1    s:8
         2 000037   000000 011000                    NOP     0

       49     5444    3              END;                         /* DO I                               */

   5444  2 000040   200004 235100                    LDA     I,,AUTO
         2 000041   000001 035007                    ADLA    1,DL
         2 000042   200004 755100                    STA     I,,AUTO
         2 000043   200003 470500                    LDP0    @TOP$,,AUTO
         2 000044   000000 471500                    LDP1    0,,PR0
         2 000045   100001 236100                    LDQ     1,,PR1
         2 000046   000022 772000                    QRL     18
         2 000047   200004 116100                    CMPQ    I,,AUTO
         2 000050   000052 600000 2                  TZE     s:5444+10
         2 000051   000027 603000 2                  TRC     s:5443
         2 000052   000237 710000 2                  TRA     RET_LBL

       50     5445    2           CASE(%END_CMD);

       51     5446    2              TH_ENDFLAG = %TRUE;

   5446  2 000053   400000 236003                    LDQ     -131072,DU
         2 000054   000000 756000 xsym               STQ     TH_ENDFLAG
         2 000055   000237 710000 2                  TRA     RET_LBL

       52     5447    2           CASE(%HELP_CMD);

       53     5448    2              CALL THC$HELP(OUT$BLK.SUBLK$(0));

   5448  2 000056   100003 633500                    EPPR3   3,,PR1
         2 000057   200006 453500                    STP3    I+2,,AUTO
         2 000060   200006 630500                    EPPR0   I+2,,AUTO
         2 000061   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000062   000000 701000 xent               TSX1    THC$HELP
         2 000063   000000 011000                    NOP     0
         2 000064   000237 710000 2                  TRA     RET_LBL
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:12   

       54     5449    2           CASE(%REPORT_CMD);

       55     5450    2              CALL THC$REPORT(TOP$);

   5450  2 000065   200003 630500                    EPPR0   @TOP$,,AUTO
         2 000066   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000067   000000 701000 xent               TSX1    THC$REPORT
         2 000070   000000 011000                    NOP     0
         2 000071   000237 710000 2                  TRA     RET_LBL

       56     5451    2           CASE(%SELECT_CMD);

       57     5452    2              CALL THC$SELECT(OUT$BLK.SUBLK$(0)) ALTRET(RET_LBL);

   5452  2 000072   100003 633500                    EPPR3   3,,PR1
         2 000073   200006 453500                    STP3    I+2,,AUTO
         2 000074   200006 630500                    EPPR0   I+2,,AUTO
         2 000075   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000076   000000 701000 xent               TSX1    THC$SELECT
         2 000077   000237 702000 2                  TSX2    RET_LBL
         2 000100   000237 710000 2                  TRA     RET_LBL

       58     5453    2           CASE(%SPAN_CMD);

       59     5454    2              CALL THC$SPAN(TOP$) ALTRET(RET_LBL);

   5454  2 000101   200003 630500                    EPPR0   @TOP$,,AUTO
         2 000102   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000103   000000 701000 xent               TSX1    THC$SPAN
         2 000104   000237 702000 2                  TSX2    RET_LBL
         2 000105   000237 710000 2                  TRA     RET_LBL

       60     5455    2           CASE(%THRESH_CMD);

       61     5456    2              CALL THC$THRESH(TOP$);

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:13   
   5456  2 000106   200003 630500                    EPPR0   @TOP$,,AUTO
         2 000107   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000110   000000 701000 xent               TSX1    THC$THRESH
         2 000111   000000 011000                    NOP     0
         2 000112   000237 710000 2                  TRA     RET_LBL

       62     5457    2           CASE(%STATUS_CMD);

       63     5458    2              CALL THC$STATUS;

   5458  2 000113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000114   000000 701000 xent               TSX1    THC$STATUS
         2 000115   000000 011000                    NOP     0
         2 000116   000237 710000 2                  TRA     RET_LBL

       64     5459    2           CASE(%NULL_CMD);

       65     5460    2            CASE(%USE_CMD);

       66     5461    2             IF OUT$BLK.NSUBLKS <= 0

   5461  2 000117   100001 221100                    LDX1    1,,PR1
         2 000120   000130 601000 2                  TNZ     s:5467

       67     5462    3              THEN DO;

       68     5463    3                 VLP_SYSTAC.ACCT# = B$JIT.FACCN;

   5463  2 000121   000000 473400 xsym               LDP3    B$JIT$
         2 000122   300006 237100                    LDAQ    6,,PR3
         2 000123   000000 755000 xsym               STA     VLP_SYSTAC
         2 000124   000001 756000 xsym               STQ     VLP_SYSTAC+1

       69     5464    3                 TH_CHANGE_ACCOUNT = '1'B;

   5464  2 000125   400000 236003                    LDQ     -131072,DU
         2 000126   000000 756000 xsym               STQ     TH_CHANGE_ACCOUNT
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:14   

       70     5465    3                 END;

   5465  2 000127   000237 710000 2                  TRA     RET_LBL

       71     5466    3              ELSE DO;

       72     5467    3                 IF OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > 8

   5467  2 000130   100003 473500                    LDP3    3,,PR1
         2 000131   300004 236100                    LDQ     4,,PR3
         2 000132   777000 376003                    ANQ     -512,DU
         2 000133   011000 116003                    CMPQ    4608,DU
         2 000134   000143 602000 2                  TNC     s:5476

       73     5468    4                  THEN DO;

       74     5469    4                       CALL THM$ERRMSG(%E$TH_BAD_ACCOUNT_NAME);

   5469  2 000135   000001 630400 3                  EPPR0   1
         2 000136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000137   000000 701000 xent               TSX1    THM$ERRMSG
         2 000140   000000 011000                    NOP     0

       75     5470                            /*E* ERROR : THE-E$TH_BAD_ACCOUNT_NAME-O
       76     5471                                 MESSAGE: Bad account specification
       77     5472                            */
       78     5473    4                       TH_CHANGE_ACCOUNT = '0'B;

   5473  2 000141   000000 450000 xsym               STZ     TH_CHANGE_ACCOUNT

       79     5474    4                      END;

   5474  2 000142   000237 710000 2                  TRA     RET_LBL

       80     5475    4                  ELSE DO;

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:15   
       81     5476    4                      VLP_SYSTAC.ACCT# = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   5476  2 000143   300004 236100                    LDQ     4,,PR3
         2 000144   000033 772000                    QRL     27
         2 000145   000000 622006                    EAX2    0,QL
         2 000146   040000 100540                    MLR     fill='040'O
         2 000147   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         2 000150   000000 000010 xsym               ADSC9   VLP_SYSTAC               cn=0,n=8

       82     5477    4                      TH_CHANGE_ACCOUNT = '1'B;

   5477  2 000151   400000 236003                    LDQ     -131072,DU
         2 000152   000000 756000 xsym               STQ     TH_CHANGE_ACCOUNT

       83     5478    4                      END;

       84     5479    3                 END;

   5479  2 000153   000237 710000 2                  TRA     RET_LBL

       85     5480                                                /* DO NOTHING                         */
       86     5481    2            CASE(%FILE_CMD);

       87     5482    2                IF (OUT$BLK.NSUBLKS <= 0)

   5482  2 000154   100001 221100                    LDX1    1,,PR1
         2 000155   000164 601000 2                  TNZ     s:5490

       88     5483    3                   THEN DO;

       89     5484    3                     CALL THM$ERRMSG(%E$TH_BAD_FILE_NAME);

   5484  2 000156   000003 630400 3                  EPPR0   3
         2 000157   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000160   000000 701000 xent               TSX1    THM$ERRMSG
         2 000161   000000 011000                    NOP     0

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:16   
       90     5485                          /*E*  ERROR: THE-E$TH_BAD_FILE_NAME-0
       91     5486                                MESSAGE:  Bad file name               */
       92     5487    3                     TH_CHANGE_FILE = '0'B;

   5487  2 000162   000000 450000 xsym               STZ     TH_CHANGE_FILE

       93     5488    3                   END;

   5488  2 000163   000237 710000 2                  TRA     RET_LBL

       94     5489    3                   ELSE DO;

       95     5490    3                     FPT_FID.TEXTFID_ = VECTOR( OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);

   5490  2 000164   100003 473500                    LDP3    3,,PR1
         2 000165   300004 236100                    LDQ     4,,PR3
         2 000166   000033 772000                    QRL     27
         2 000167   000064 737000                    LLS     52
         2 000170   000140 135007                    SBLA    96,DL
         2 000171   200006 453500                    STP3    I+2,,AUTO
         2 000172   200006 236100                    LDQ     I+2,,AUTO
         2 000173   000004 036000 3                  ADLQ    4
         2 000174   000014 757000 1                  STAQ    FPT_FID+2

       96     5491    3                     CALL M$FID(FPT_FID);

   5491  2 000175   000012 630400 1                  EPPR0   FPT_FID
         2 000176   020001 713400                    CLIMB   8193
         2 000177   404400 401760                    pmme    nvectors=10

       97     5492    3                     TH_CHANGE_FILE = '1'B;

   5492  2 000200   400000 236003                    LDQ     -131072,DU
         2 000201   000000 756000 xsym               STQ     TH_CHANGE_FILE

       98     5493    3                   END;

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:17   
   5493  2 000202   000237 710000 2                  TRA     RET_LBL

       99     5494    2            CASE(%PROMPT_CMD);

      100     5495    2                IF OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 0

   5495  2 000203   100003 473500                    LDP3    3,,PR1
         2 000204   300004 236100                    LDQ     4,,PR3
         2 000205   777000 316003                    CANQ    -512,DU
         2 000206   000217 601000 2                  TNZ     s:5502

      101     5496    3                  THEN DO;

      102     5497    3                          TH_PRMT.VFC = BITASC('036'O);

   5497  2 000207   036000 236003                    LDQ     15360,DU
         2 000210   000000 552040 xsym               STBQ    TH_PRMT,'40'O

      103     5498    3                          TH_PRMT.TEXT = ' ';

   5498  2 000211   040000 100400                    MLR     fill='040'O
         2 000212   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000213   000000 200036 xsym               ADSC9   TH_PRMT                  cn=1,n=30

      104     5499    3                          TH_PRMT_SIZE = 1;

   5499  2 000214   000001 235007                    LDA     1,DL
         2 000215   000000 755000 xsym               STA     TH_PRMT_SIZE

      105     5500    3                       END;

   5500  2 000216   000235 710000 2                  TRA     s:5506

      106     5501    3                  ELSE DO;

      107     5502    3                         TH_PRMT.TEXT= OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:18   
   5502  2 000217   300004 236100                    LDQ     4,,PR3
         2 000220   000033 772000                    QRL     27
         2 000221   000000 621006                    EAX1    0,QL
         2 000222   040000 100540                    MLR     fill='040'O
         2 000223   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         2 000224   000000 200036 xsym               ADSC9   TH_PRMT                  cn=1,n=30

      108     5503    3                         TH_PRMT.VFC = BITASC('036'O);

   5503  2 000225   036000 236003                    LDQ     15360,DU
         2 000226   000000 552040 xsym               STBQ    TH_PRMT,'40'O

      109     5504    3                          TH_PRMT_SIZE = OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT+ 1;

   5504  2 000227   000000 471500                    LDP1    0,,PR0
         2 000230   100003 473500                    LDP3    3,,PR1
         2 000231   300004 236100                    LDQ     4,,PR3
         2 000232   000033 772000                    QRL     27
         2 000233   000001 036007                    ADLQ    1,DL
         2 000234   000000 756000 xsym               STQ     TH_PRMT_SIZE

      110     5505    3                       END;

      111     5506    2                   TH_PRMT_FLAG = '1'B;

   5506  2 000235   400000 236003                    LDQ     -131072,DU
         2 000236   000000 756000 xsym               STQ     TH_PRMT_FLAG

      112     5507    2        END;                               /* DO CASE                            */

      113     5508    1   RET_LBL:
      114     5509    1        RETURN;

   5509  2 000237   000000 702200 xent  RET_LBL      TSX2  ! X66_ARET
      115     5510    1   END THC$COMMANDS;
      116     5511        %EOD;

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:19   
--  Include file information  --

   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$COMMANDS.
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:20   

 **** Variables and constants ****

  ****  Section 001  Data  THC$COMMANDS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/d STRC(864)   r     1 FPT_FID                   10-0-0/c STRC(72)    r     1 TH_VLP_ACCT
     0-0-0/c STRC(288)   r     1 TH_VLP_ERRLOGX

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                      4-0-0/w UBIN        r     1 I
    *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/b BIT         r     1 TH_CHANGE_ACCOUNT
     0-0-0/b BIT         r     1 TH_CHANGE_FILE             0-0-0/b BIT         r     1 TH_ENDFLAG
     0-0-0/d STRC(2088)  r     1 TH_OPEN_ERRLOG             0-0-0/c STRC(279)   r     1 TH_PRMT
     0-0-0/b BIT         r     1 TH_PRMT_FLAG               0-0-0/w UBIN        r     1 TH_PRMT_SIZE
     0-0-0/c STRC(72)    r     1 VLP_SYSTAC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM

PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:21   

   Procedure THC$COMMANDS requires 160 words for executable code.
   Procedure THC$COMMANDS requires 8 words of local(AUTO) storage.
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:22   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:23   
          MINI XREF LISTING

B$JIT.CPFLAGS1.SLEAZE
      4483**DCL      4483--REDEF
B$JIT.ERR.MID
      4390**DCL      4390--REDEF
B$JIT.FACCN
      4389**DCL      5463>>ASSIGN
B$JIT.JRESPEAK
      4551**DCL      4552--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      4660**DCL      4660--REDEF    4661--REDEF
B$JIT.PNR
      4564**DCL      4564--REDEF
B$JIT.TSLINE
      4658**DCL      4659--REDEF
B$JIT$
      5178**DCL      4384--IMP-PTR  5463>>ASSIGN
F$DCB.ACTPOS
      4352**DCL      4352--REDEF
F$DCB.ARS
      4327**DCL      4327--REDEF
F$DCB.ATTR
      4345**DCL      4346--REDEF
F$DCB.BORROW
      4360**DCL      4360--REDEF    4360--REDEF    4360--REDEF
F$DCB.DCBNAME.L
      4374**DCL      4374--IMP-SIZ
F$DCB.EOMCHAR
      4331**DCL      4331--REDEF
F$DCB.FLDID
      4355**DCL      4355--REDEF
F$DCB.FORM$
      4349**DCL      4349--REDEF
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:24   
F$DCB.FSECT
      4365**DCL      4365--REDEF
F$DCB.FSN
      4342**DCL      4342--REDEF    4342--REDEF    4343--REDEF
F$DCB.HEADER$
      4348**DCL      4348--REDEF
F$DCB.IXTNSIZE
      4346**DCL      4346--REDEF
F$DCB.LASTSTA$
      4336**DCL      4336--REDEF
F$DCB.LVL
      4361**DCL      4361--REDEF
F$DCB.NAME.C
      4336**DCL      4336--REDEF
F$DCB.NOEOF
      4357**DCL      4357--REDEF
F$DCB.NRECS
      4347**DCL      4347--REDEF
F$DCB.NRECX
      4366**DCL      4366--REDEF
F$DCB.OHDR
      4358**DCL      4358--REDEF
F$DCB.ORG
      4341**DCL      4341--REDEF
F$DCB.PRECNO
      4364**DCL      4364--REDEF
F$DCB.RCSZ
      4369**DCL      4369--REDEF
F$DCB.RES
      4337**DCL      4337--REDEF
F$DCB.SETX
      4349**DCL      4349--REDEF
F$DCB.TAB$
      4348**DCL      4349--REDEF
F$DCB.TDA
      4363**DCL      4363--REDEF
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:25   
F$DCB.WSN
      4338**DCL      4338--REDEF
FPT_FID
      5233**DCL      5491<>CALL
FPT_FID.TEXTFID_
      5233**DCL      5490<<ASSIGN
FPT_FID.V
      5237**DCL      5233--DCLINIT
I
      5177**DCL      5442<<DOINDEX  5443>>CALL
M$FID
        84**DCL-ENT  5491--CALL
OUT$BLK.CODE
      5369**DCL      5440>>DOCASE
OUT$BLK.NSUBLKS
      5373**DCL      5442>>DOINDEX  5461>>IF       5482>>IF
OUT$BLK.SUBLK$
      5394**DCL      5443<>CALL     5448<>CALL     5452<>CALL     5467>>IF       5476>>ASSIGN   5476>>ASSIGN
      5490>>ASSIGN   5490>>ASSIGN   5495>>IF       5502>>ASSIGN   5502>>ASSIGN   5504>>ASSIGN
OUT$SYM.COUNT
      5430**DCL      5433--IMP-SIZ  5467>>IF       5476>>ASSIGN   5490>>ASSIGN   5495>>IF       5502>>ASSIGN
      5504>>ASSIGN
OUT$SYM.TEXT
      5433**DCL      5476>>ASSIGN   5490--ASSIGN   5502>>ASSIGN
RET_LBL
      5509**LABEL    5452--CALLALT  5454--CALLALT
THC$COMMANDS
         8**PROC     5443--CALL
THC$HELP
      5171**DCL-ENT  5448--CALL
THC$REPORT
      5172**DCL-ENT  5450--CALL
THC$SELECT
      5170**DCL-ENT  5452--CALL
THC$SPAN
      5169**DCL-ENT  5454--CALL
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:26   
THC$STATUS
      5174**DCL-ENT  5458--CALL
THC$THRESH
      5173**DCL-ENT  5456--CALL
THM$ERRMSG
      5168**DCL-ENT  5469--CALL     5484--CALL
TH_CHANGE_ACCOUNT
      4740**DCL      5464<<ASSIGN   5473<<ASSIGN   5477<<ASSIGN
TH_CHANGE_FILE
      4740**DCL      5487<<ASSIGN   5492<<ASSIGN
TH_CONSTRAINTS.E_BY_B
      4676**DCL      4676--REDEF
TH_CONSTRAINTS.M_BY_B
      4675**DCL      4675--REDEF
TH_CONSTRAINTS.TYPES
      4673**DCL      4673--REDEF
TH_DEFAULT.E_BY_B
      4684**DCL      4684--REDEF
TH_DEFAULT.M_BY_B
      4683**DCL      4683--REDEF
TH_DEFAULT.TYPES
      4681**DCL      4681--REDEF
TH_ENDFLAG
      4697**DCL      5446<<ASSIGN
TH_OPEN_ERRLOG.ACSVEH_
      5313**DCL      5314--REDEF
TH_OPEN_ERRLOG.ALTKEYS_
      5319**DCL      5320--REDEF    5320--REDEF
TH_OPEN_ERRLOG.HDR_
      5318**DCL      5319--REDEF
TH_OPEN_ERRLOG.TAB_
      5317**DCL      5318--REDEF
TH_OPEN_ERRLOG.UHL_
      5311**DCL      5312--REDEF    5312--REDEF
TH_OPEN_ERRLOG.V.ASN#
      5330**DCL      5236--DCLINIT
PL6.E3A0      #001=THC$COMMANDS File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:06 Page:27   
TH_OPEN_ERRLOG.V.FSN#
      5351**DCL      5351--REDEF    5351--REDEF
TH_OPEN_ERRLOG.WSN_
      5317**DCL      5317--REDEF
TH_PRMT.TEXT
      4741**DCL      5498<<ASSIGN   5502<<ASSIGN
TH_PRMT.VFC
      4740**DCL      5497<<ASSIGN   5503<<ASSIGN
TH_PRMT_FLAG
      4740**DCL      5506<<ASSIGN
TH_PRMT_SIZE
      4741**DCL      5499<<ASSIGN   5504<<ASSIGN
TH_SAVE.E_BY_B
      4692**DCL      4692--REDEF
TH_SAVE.M_BY_B
      4690**DCL      4690--REDEF
TH_SAVE.TYPES
      4688**DCL      4689--REDEF
TH_VLP_ACCT
      5219**DCL      5234--DCLINIT
TH_VLP_ERRLOGX
      5206**DCL      5234--DCLINIT
TH_XSA_BUF_VECTOR
      4708**DCL      4708--REDEF
TOP$
         9**DCL         8--PROC     5361--IMP-PTR  5407--IMP-PTR  5440>>DOCASE   5442>>DOINDEX  5443>>CALL
      5448>>CALL     5450<>CALL     5452>>CALL     5454<>CALL     5456<>CALL     5461>>IF       5467>>IF
      5476>>ASSIGN   5476>>ASSIGN   5482>>IF       5490>>ASSIGN   5490>>ASSIGN   5495>>IF       5502>>ASSIGN
      5502>>ASSIGN   5504>>ASSIGN
VLP_SYSTAC.ACCT#
      4725**DCL      5463<<ASSIGN   5476<<ASSIGN

PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:28   
      117        1        /*T***********************************************************/
      118        2        /*T*                                                         */
      119        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      120        4        /*T*                                                         */
      121        5        /*T***********************************************************/
      122        6        THC$HELP: PROC(TOP$);
      123        7        /**/
      124        8        /* PARAMS */
      125        9    1   DCL TOP$ PTR;
      126       10        /**/
      127       11        /* INCLUDE FILES */
      128       12        %INCLUDE CP_6;
      129       93        %INCLUDE TH_DATA_R;
      130      171        %INCLUDE TH_SUBS_C;
      131      553        %INCLUDE TH_PERR_C;
      132      594        %INCLUDE XU_MACRO_C;
      133     3700        %INCLUDE XUH_MACRO_C;
      134     3784        /**/
      135     3785        /* ENTRY DEFS */
      136     3786    1   DCL THM$ERRMSG ENTRY(1);
      137     3787    1   DCL XUR$HELP ENTRY(1) ALTRET;
      138     3788    1   DCL XUR$MOREMSG ENTRY(1) ALTRET;
      139     3789    1   DCL XUR$ALLMSG ENTRY(1) ALTRET;
      140     3790        /**/
      141     3791        /* VARS */
      142     3792    1   DCL ERR# UBIN;
      143     3793        /**/
      144     3794        /* MACROS */
      145     3795        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      146     3840        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
      147     3878        %XUH_PARAM (PROCNAME=ELANNAME,OUTDCB1=M$DO,OUTDCB2=M$LO);
      148     3939        %VLP_NAME (FPTN=ELANNAME,NAME='ELAN');
      149     3966        /**/
      150     3967        /* DCBS */
      151     3968    1   DCL M$LO DCB;
      152     3969    1   DCL M$DO DCB;
      153     3970        /**/
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:29   
      154     3971        %EJECT;
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:30   
      155     3972    2        DO CASE(OUT$BLK.CODE);
      156     3973    2           CASE(%HELP);
      157     3974    2              XUH_PARAM.HELP$ = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$;
      158     3975    2              CALL XUR$HELP(XUH_PARAM);
      159     3976    2           CASE(%SINGL_Q);
      160     3977    2              CALL XUR$MOREMSG(XUH_PARAM) ALTRET(NO_MORE);
      161     3978    2           CASE(%DOUBL_Q);
      162     3979    2              CALL XUR$ALLMSG(XUH_PARAM) ALTRET(NO_MORE);
      163     3980    2           END;  /* DO CASE */
      164     3981    1   RET: RETURN;
      165     3982    1   NO_MORE:
      166     3983    1        CALL THM$ERRMSG(%E$TH_NO_MORE);
      167     3984        /*E* ERROR: THE-E$TH_NO_MORE-0
      168     3985             MESSAGE: No more help available.
      169     3986             DESCRIPTION: See message.        */
      170     3987    1        RETURN;
      171     3988    1   END THC$HELP;
      172     3989        %EOD;

PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:31   
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$HELP.

   Procedure THC$HELP requires 35 words for executable code.
   Procedure THC$HELP requires 6 words of local(AUTO) storage.

PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:32   

 Object Unit name= THC$HELP                                   File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:07:14.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    60     74  THC$HELP
    2   DCB   even  none     0      0  M$LO
    3   DCB   even  none     0      0  M$DO
    4   Proc  even  none    35     43  THC$HELP
    5  RoData even  none     3      3  THC$HELP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  THC$HELP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XUR$HELP
 yes     yes           Std       1 XUR$MOREMSG
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       1 XUR$ALLMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:33   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_XSA_BUF_VECTOR                     M$LO
     M$DO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:34   


      117        1        /*T***********************************************************/
      118        2        /*T*                                                         */
      119        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      120        4        /*T*                                                         */
      121        5        /*T***********************************************************/
      122        6        THC$HELP: PROC(TOP$);

      6  4 000000   000000 700200 xent  THC$HELP     TSX0  ! X66_AUTO_1
         4 000001   000006 000001                    ZERO    6,1

      123        7        /**/
      124        8        /* PARAMS */
      125        9    1   DCL TOP$ PTR;
      126       10        /**/
      127       11        /* INCLUDE FILES */
      128       12        %INCLUDE CP_6;
      129       93        %INCLUDE TH_DATA_R;
      130      171        %INCLUDE TH_SUBS_C;
      131      553        %INCLUDE TH_PERR_C;
      132      594        %INCLUDE XU_MACRO_C;
      133     3700        %INCLUDE XUH_MACRO_C;
      134     3784        /**/
      135     3785        /* ENTRY DEFS */
      136     3786    1   DCL THM$ERRMSG ENTRY(1);
      137     3787    1   DCL XUR$HELP ENTRY(1) ALTRET;
      138     3788    1   DCL XUR$MOREMSG ENTRY(1) ALTRET;
      139     3789    1   DCL XUR$ALLMSG ENTRY(1) ALTRET;
      140     3790        /**/
      141     3791        /* VARS */
      142     3792    1   DCL ERR# UBIN;
      143     3793        /**/
      144     3794        /* MACROS */
      145     3795        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      146     3840        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
      147     3878        %XUH_PARAM (PROCNAME=ELANNAME,OUTDCB1=M$DO,OUTDCB2=M$LO);
      148     3939        %VLP_NAME (FPTN=ELANNAME,NAME='ELAN');
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:35   
      149     3966        /**/
      150     3967        /* DCBS */
      151     3968    1   DCL M$LO DCB;
      152     3969    1   DCL M$DO DCB;
      153     3970        /**/
      154     3971        %EJECT;
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:36   
      155     3972    2        DO CASE(OUT$BLK.CODE);

   3972  4 000002   200003 470500                    LDP0    @TOP$,,AUTO
         4 000003   000000 471500                    LDP1    0,,PR0
         4 000004   100000 720100                    LXL0    0,,PR1
         4 000005   000004 100003                    CMPX0   4,DU
         4 000006   000010 602010 4                  TNC     s:3972+6,X0
         4 000007   000035 710000 4                  TRA     RET
         4 000010   000035 710000 4                  TRA     RET
         4 000011   000014 710000 4                  TRA     s:3974
         4 000012   000024 710000 4                  TRA     s:3977
         4 000013   000031 710000 4                  TRA     s:3979

      156     3973    2           CASE(%HELP);

      157     3974    2              XUH_PARAM.HELP$ = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$;

   3974  4 000014   100003 473500                    LDP3    3,,PR1
         4 000015   300003 236100                    LDQ     3,,PR3
         4 000016   000011 756000 1                  STQ     XUH_PARAM+9

      158     3975    2              CALL XUR$HELP(XUH_PARAM);

   3975  4 000017   000000 630400 5                  EPPR0   0
         4 000020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000021   000000 701000 xent               TSX1    XUR$HELP
         4 000022   000000 011000                    NOP     0
         4 000023   000035 710000 4                  TRA     RET

      159     3976    2           CASE(%SINGL_Q);

      160     3977    2              CALL XUR$MOREMSG(XUH_PARAM) ALTRET(NO_MORE);

   3977  4 000024   000000 630400 5                  EPPR0   0
         4 000025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000026   000000 701000 xent               TSX1    XUR$MOREMSG
         4 000027   000036 702000 4                  TSX2    NO_MORE
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:37   
         4 000030   000035 710000 4                  TRA     RET

      161     3978    2           CASE(%DOUBL_Q);

      162     3979    2              CALL XUR$ALLMSG(XUH_PARAM) ALTRET(NO_MORE);

   3979  4 000031   000000 630400 5                  EPPR0   0
         4 000032   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000033   000000 701000 xent               TSX1    XUR$ALLMSG
         4 000034   000036 702000 4                  TSX2    NO_MORE

      163     3980    2           END;  /* DO CASE */

      164     3981    1   RET: RETURN;

   3981  4 000035   000000 702200 xent  RET          TSX2  ! X66_ARET

      165     3982    1   NO_MORE:
      166     3983    1        CALL THM$ERRMSG(%E$TH_NO_MORE);

   3983  4 000036   000002 630400 5     NO_MORE      EPPR0   2
         4 000037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000040   000000 701000 xent               TSX1    THM$ERRMSG
         4 000041   000000 011000                    NOP     0

      167     3984        /*E* ERROR: THE-E$TH_NO_MORE-0
      168     3985             MESSAGE: No more help available.
      169     3986             DESCRIPTION: See message.        */
      170     3987    1        RETURN;

   3987  4 000042   000000 702200 xent               TSX2  ! X66_ARET
      171     3988    1   END THC$HELP;
      172     3989        %EOD;

PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:38   
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$HELP.
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:39   

 **** Variables and constants ****

  ****  Section 001  Data  THC$HELP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/c STRC(45)    r     1 ELANNAME                   0-0-0/d STRC(2052)  r     1 XUH_PARAM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                     *0-0-0/w PTR         r     1 TOP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure THC$HELP requires 35 words for executable code.
   Procedure THC$HELP requires 6 words of local(AUTO) storage.
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:41   
          MINI XREF LISTING

ELANNAME
      3964**DCL      3902--DCLINIT
NO_MORE
      3983**LABEL    3977--CALLALT  3979--CALLALT
OUT$BLK.CODE
      3809**DCL      3972>>DOCASE
OUT$BLK.SUBLK$
      3834**DCL      3974>>ASSIGN
OUT$SYM.COUNT
      3870**DCL      3873--IMP-SIZ
OUT$SYM.TEXTC$
      3865**DCL      3974>>ASSIGN
THM$ERRMSG
      3786**DCL-ENT  3983--CALL
TH_CONSTRAINTS.E_BY_B
       104**DCL       104--REDEF
TH_CONSTRAINTS.M_BY_B
       103**DCL       103--REDEF
TH_CONSTRAINTS.TYPES
       101**DCL       101--REDEF
TH_DEFAULT.E_BY_B
       112**DCL       112--REDEF
TH_DEFAULT.M_BY_B
       111**DCL       111--REDEF
TH_DEFAULT.TYPES
       109**DCL       109--REDEF
TH_SAVE.E_BY_B
       120**DCL       120--REDEF
TH_SAVE.M_BY_B
       118**DCL       118--REDEF
TH_SAVE.TYPES
       116**DCL       117--REDEF
PL6.E3A0      #002=THC$HELP File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:07 Page:42   
TH_XSA_BUF_VECTOR
       136**DCL       136--REDEF
TOP$
         9**DCL         6--PROC     3801--IMP-PTR  3972>>DOCASE   3974>>ASSIGN
XUH_PARAM
      3898**DCL      3975<>CALL     3977<>CALL     3979<>CALL
XUH_PARAM.HELP$
      3908**DCL      3974<<ASSIGN
XUR$ALLMSG
      3789**DCL-ENT  3979--CALL
XUR$HELP
      3787**DCL-ENT  3975--CALL
XUR$MOREMSG
      3788**DCL-ENT  3977--CALL

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:43   
      173        1        /*T***********************************************************/
      174        2        /*T*                                                         */
      175        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      176        4        /*T*                                                         */
      177        5        /*T***********************************************************/
      178        6        THC$REPORT: PROC(TOP$);
      179        7    1   DCL TOP$ PTR;
      180        8        /**/
      181        9        /* INCLUDE FILES */
      182       10        %INCLUDE CP_6;
      183       91        %INCLUDE CP_6_SUBS;
      184      631        %INCLUDE XU_MACRO_C;
      185     3737        %INCLUDE F$DCB;
      186     3786        %INCLUDE EL$TABLES;
      187     4109        %INCLUDE NI$TABLES;
      188     4325        %INCLUDE TH_SUBS_C;
      189     4707        %INCLUDE TH_DATA_R;
      190     4785        %INCLUDE EL_SUBS_C;
      191     4869        %INCLUDE ZL_MACRO_C;
      192     5519        %INCLUDE B_ERRORS_C;
      193     6646        %INCLUDE XUD_UTS_M;
      194     6728        /**/
      195     6729        /* ENTRY DEFS */
      196     6730    1   DCL X$SORT ENTRY(1) ALTRET;
      197     6731    1   DCL IOERR$COMPARE ENTRY(3);
      198     6732    1   DCL FEPERR$COMPARE ENTRY(3);
      199     6733    1   DCL THM$ERRMSG ENTRY(1);
      200     6734    1   DCL THS$SET_DEVS ENTRY(3) ALTRET;
      201     6735    1   DCL THF$DUMP ENTRY(3);
      202     6736    1   DCL THF$RAW ENTRY(1);
      203     6737    1   DCL THG$GETREC ENTRY(4) ALTRET;
      204     6738    1   DCL THG$OPENXSA ENTRY(1) ALTRET;
      205     6739    1   DCL THG$PRECORDXSA ENTRY(1) ALTRET;
      206     6740    1   DCL THG$CLOSEXSA ENTRY ALTRET;
      207     6741    1   DCL THW$WRITE ENTRY(11);
      208     6742    1   DCL THF$HWE ENTRY(1);
      209     6743    1   DCL THF$CONFIG ENTRY(1);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:44   
      210     6744    1   DCL THC$TYPENAME ENTRY(3);
      211     6745    1   DCL THF$ADD_TEXTC ENTRY(3);
      212     6746    1   DCL THF$AMS ENTRY;
      213     6747    1   DCL THF$UPR ENTRY;
      214     6748    1   DCL THF$SYS ENTRY;
      215     6749        /**/
      216     6750        /* DCBS */
      217     6751    1   DCL M$LO DCB;
      218     6752    1   DCL M$ONFILE DCB;
      219     6753    1   DCL M$ERRLOG2 DCB;
      220     6754    1   DCL M$ERRLOG3 DCB;
      221     6755    1   DCL M$ERRLOG4 DCB;
      222     6756    1   DCL M$ERRLOG5 DCB;
      223     6757        /**/
      224     6758        /**/
      225     6759        /* SUBS FOR DEVICE TYPE CHECKING */
      226     6760        %EQU DV_SC = 0;
      227     6761        %EQU DV_MPC = 6;
      228     6762        /**/
      229     6763        /* VARIABLES */
      230     6764    1   DCL START_TIME UBIN WORD;
      231     6765    1   DCL STOP_TIME UBIN WORD;
      232     6766    1   DCL ONFILE_SPECIFIED BIT(1) STATIC INIT('0'B);
      233     6767    1   DCL OUTPUT_DCB# UBIN STATIC SYMDEF INIT( DCBNUM(M$LO));
      234     6768    1   DCL TEXT$ PTR;
      235     6769    1   DCL TEXTBUF CHAR(900) STATIC INIT(' ');
      236     6770    1   DCL 1 TVEC DALIGNED,
      237     6771    1         2 BOUND UBIN(20) UNAL,
      238     6772    1         2 * BIT(16) UNAL,
      239     6773    1         2 PTR$ PTR;
      240     6774    1   DCL TEMP_BUF CHAR(132) STATIC INIT(' ');
      241     6775    1   DCL TEMP_BUF2 CHAR(900);
      242     6776    1   DCL BUF_COUNT UBIN;
      243     6777    1   DCL TH_RAW_FMT(0:0) PTR SYMREF;
      244     6778    1   DCL TH_DETAIL_FMT(0:0) PTR SYMREF;
      245     6779    1   DCL TH_EXTENDED_FMT(0:0) PTR SYMREF;
      246     6780    1   DCL TYPE UBIN WORD;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:45   
      247     6781    1   DCL DBUF CHAR(8) STATIC;
      248     6782    1   DCL TBUF CHAR(11) STATIC;
      249     6783    1   DCL LOC_UTS UBIN WORD STATIC;
      250     6784    1   DCL DUMP_HDR CHAR(0) CONSTANT INIT('%2/ TYPE = %D  TIME = %A - %A %10P');
      251     6785    1   DCL DUMP_FMT BIT(72) DALIGNED STATIC INIT(VECTOR(DUMP_HDR));
      252     6786    1   DCL SYM$ PTR;
      253     6787    1   DCL TEXT CHAR(8);
      254     6788    1   DCL CODE UBIN WORD;
      255     6789    1   DCL COMP_CODE UBIN;
      256     6790    1   DCL LEN UBIN WORD;
      257     6791    1   DCL TEXT_LEN UBIN WORD STATIC INIT(0);
      258     6792    1   DCL BUF_INDX UBIN WORD STATIC INIT(0);
      259     6793    1   DCL I UBIN;
      260     6794    1   DCL J UBIN;
      261     6795    1   DCL K SBIN;
      262     6796    1   DCL FOUND BIT(1);
      263     6797    1   DCL FOR_CLAUSE_FLG BIT(1);
      264     6798    1   DCL MEMORY_ERRORS BIT(1);
      265     6799    1   DCL NUM_IOERR_REC SBIN;
      266     6800    1   DCL NUM_FEPERR SBIN;
      267     6801    1   DCL NUM_RECS SBIN;
      268     6802    1   DCL NUM_TYPES SBIN;
      269     6803    1   DCL NUM_DEV SBIN;
      270     6804    1   DCL TYPES(0:%NTYPES) UBIN;
      271     6805    1   DCL RECORD_TYPE UBIN;
      272     6806    1   DCL TYPEB UBIN BYTE;
      273     6807    1   DCL TYPE_CNT(0:%NTYPES) UBIN;
      274     6808    1   DCL DEVNM(0:200) CHAR(8);
      275     6809    1   DCL DEV_CNT(0:200) SBIN;
      276     6810    1   DCL DEV_MOUNT(0:200) SBIN;
      277     6811    1   DCL CONNECTS(0:200) SBIN;
      278     6812    1   DCL ERRORS(0:200) SBIN;
      279     6813    1   DCL INFO$ PTR;
      280     6814        %EL$ENTRY(NAME=RECORD,STCLASS="BASED(TH_RECORD.PTR$)");
      281     6818        %EL$IOERR(STCLASS="BASED(INFO$)");
      282     6828        %EL$FEPERR(STCLASS="BASED(INFO$)");
      283     6907        %EL$MTDMT(STCLASS="BASED(INFO$)");
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:46   
      284     6910    1   DCL OLD_FEPERR_DATE UBIN WORD STATIC;
      285     6911    1   DCL OLD_IOERR_DATE UBIN WORD STATIC;
      286     6912    1   DCL NEW_FEPERR_DATE UBIN WORD STATIC;
      287     6913    1   DCL NEW_IOERR_DATE UBIN WORD STATIC;
      288     6914    1   DCL OLD_FEPERR_TIME CHAR(11) STATIC;
      289     6915    1   DCL OLD_IOERR_TIME CHAR(11) STATIC;
      290     6916    1   DCL NEW_FEPERR_TIME CHAR(11) STATIC;
      291     6917    1   DCL NEW_IOERR_TIME CHAR(11) STATIC;
      292     6918    1   DCL COUNT UBIN WORD;
      293     6919    1   DCL REPORT_CODE UBIN;
      294     6920    1   DCL ERRLOG_DATE UBIN WORD STATIC;
      295     6921    1   DCL DAY_BUF CHAR(3) STATIC;
      296     6922    1   DCL EOF_FLAG BIT(1);
      297     6923    1   DCL DATE_BUF CHAR(10) STATIC;
      298     6924    1   DCL NOTIMP CHAR(0) CONSTANT INIT('Unimplimented report%10P');
      299     6925    1   DCL FEPNOTIMP CHAR(0) CONSTANT INIT('HWE for FEPs not currently implimented%10P');
      300     6926    1   DCL IOMNOTIMP CHAR(0) CONSTANT INIT('HWE for IOMs not currently implimented%10P');
      301     6927    1   DCL MPCNOTIMP CHAR(0) CONSTANT INIT('HWE for MPCs not currently implimented%10P');
      302     6928    1   DCL TYPE_FMT CHAR(0) CONSTANT INIT(
      303     6929    1   'ERROR TYPES: %T%10P');
      304     6930    1   DCL SUM_FMT CHAR(0) CONSTANT INIT(
      305     6931    1   '%2/SYSTEM ERRORS%2/TYPE  (MNEMONIC)%38-COUNT%/----------------------------------- -
              6931        -----%10P');
      306     6932    1   DCL SUM_ENTRY CHAR(0) CONSTANT INIT(
      307     6933    1   '%T%37-%2P%6D%10P');
      308     6934    1   DCL DEV_FMT CHAR(0) CONSTANT INIT(
      309     6935    1   '%2/PERIPHERAL DEVICE ERRORS%2/DEVICE   COUNT ACTIVITY #RETRY MOUNTS%/-------- -----
              6935         -------- ------ ------%10P');
      310     6936    1   DCL DEV_HDR BIT(72) DALIGNED STATIC INIT(VECTOR(DEV_FMT));
      311     6937    1   DCL DEV_ENTRY CHAR(0) CONSTANT INIT(
      312     6938    1   '%4A%10-%2P%5D%16-%3P%8D%26-%4P%5D%33-%5P%5D%10P');
      313     6939    1   DCL SUM_TOT  CHAR(0) CONSTANT INIT(
      314     6940    1   '%2/TOTAL ERRORS: %D%10P');
      315     6941    1   DCL AMS_HDR CHAR(0) CONSTANT INIT(
      316     6942    1   'Anticipatory Maintenance Summary for %2P%T   %14.36.6U%10P');
      317     6943    1   DCL CONFIG_HDR CHAR(0) CONSTANT INIT(
      318     6944    1   'Configuration Report (%5P%T) for %2P%T   %14.36.6U%10P');
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:47   
      319     6945    1   DCL HWA_HDR CHAR(0) CONSTANT INIT(
      320     6946    1   '%2/Hardware Analysis Report (%5P%T) for %2P%T from %3P%14.36.2U to %4P%14.36.2U%2/%
              6946        10P');
      321     6947    1   DCL HWE_HDR CHAR(0) CONSTANT INIT(
      322     6948    1   'Hardware Error Report (%5P%T) for %2P%T from %3P%14.36.2U to %4P%14.36.2U%10P');
      323     6949    1   DCL IMS_HDR CHAR(0) CONSTANT INIT(
      324     6950    1   '%2/Installation Management Summary for %2P%T from %3P%14.36.2U to %4P%14.36.2U%2/%1
              6950        0P');
      325     6951    1   DCL KEYIN_HDR CHAR(0) CONSTANT INIT(
      326     6952    1   '%2/Keyin Report for %2P%T from %3P%14.36.2U to %4P%14.36.2U%2/%10P');
      327     6953    1   DCL MPR_HDR CHAR(0) CONSTANT INIT(
      328     6954    1   '%10P');                                /* MPR FORMAT                         */
      329     6955    1   DCL PPR_HDR CHAR(0) CONSTANT INIT(
      330     6956    1   '%10P');                                /* PPR FORMAT                         */
      331     6957    1   DCL RAS_HDR CHAR(0) CONSTANT INIT(
      332     6958    1   '%10P');                                /* RAS FORMAT                         */
      333     6959    1   DCL RAW_HDR CHAR(0) CONSTANT INIT(
      334     6960    1   'Error Log Listing (%5P%T) for %2P%T from %3P%14.36.2U to %4P%14.36.2U%10P');
      335     6961    1   DCL SEC_HDR CHAR(0) CONSTANT INIT(
      336     6962    1   '%10P');                                /* SEC REPORT                         */
      337     6963    1   DCL SWE_HDR CHAR(0) CONSTANT INIT(
      338     6964    1   '%10P');                                /* SWE REPORT                         */
      339     6965    1   DCL SYS_HDR CHAR(0) CONSTANT INIT(
      340     6966    1   'System Summary for %2P%T from %3P%14.36.2U to %4P%14.36.2U%10P');
      341     6967    1   DCL UPR_HDR CHAR(0) CONSTANT INIT(
      342     6968    1   'Unit Performance Report (%5P%T) for %2P%T    %14.36.6U%10P');
      343     6969    1   DCL SUM_HDR CHAR(0) CONSTANT INIT(
      344     6970    1   'Error Log Summary for %2P%T from %3P%14.36.2U to %4P%14.36.2U%10P');
      345     6971    1   DCL DETAIL_HDR CHAR(0) CONSTANT INIT(
      346     6972        'DETAIL ERROR REPORT for %2P%T %2/
      347     6973    1   REPORT PERIOD FROM %3P%14.36.2U TO %4P%14.36.2U %10P');
      348     6974    1   DCL IOERR_HDR CHAR(0) CONSTANT INIT(
      349     6975    1   '%/*** PERIPHERAL I/O DATA ERROR DETAIL REPORT ***%10P');
      350     6976    1   DCL FEPERR_HDR CHAR(0) CONSTANT INIT(
      351     6977    1   '%/*** FEPERR DETAIL REPORT ***%10P');
      352     6978    1   DCL MATCH_FMT CHAR(0) CONSTANT INIT(
      353     6979    1   'STATUS MATCH: %T%10P');
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:48   
      354     6980    1   DCL EXCLUDE_FMT CHAR(0) CONSTANT INIT(
      355     6981    1   'STATUS EXCLUDE: %T%10P');
      356     6982    1   DCL HDR_TBL(0:17) BIT(72) DALIGNED CONSTANT INIT(VECTOR(NIL),
      357     6983    1                             VECTOR(AMS_HDR),
      358     6984    1                             VECTOR(CONFIG_HDR),
      359     6985    1                             VECTOR(NOTIMP),
      360     6986    1                             VECTOR(HWE_HDR),
      361     6987    1                             VECTOR(NOTIMP),
      362     6988    1                             VECTOR(NOTIMP),
      363     6989    1                             VECTOR(NOTIMP),
      364     6990    1                             VECTOR(NOTIMP),
      365     6991    1                             VECTOR(NOTIMP),
      366     6992    1                             VECTOR(RAW_HDR),
      367     6993    1                             VECTOR(NOTIMP),
      368     6994    1                             VECTOR(NOTIMP),
      369     6995    1                             VECTOR(SYS_HDR),
      370     6996    1                             VECTOR(UPR_HDR),
      371     6997    1                             VECTOR(SUM_HDR),
      372     6998    1                             VECTOR(RAW_HDR),
      373     6999    1                             VECTOR(DETAIL_HDR));
      374     7000    1   DCL TH_OUTBUF CHAR(100) SYMREF;
      375     7001    1   DCL DATE_HDR CHAR(0) CONSTANT INIT('%2/ ***** %A %2P%A ***** %/%10P');
      376     7002    1   DCL DATE_FMT BIT(72) DALIGNED STATIC INIT(VECTOR(DATE_HDR));
      377     7003    1   DCL TIME_HDR CHAR(0) CONSTANT INIT(
      378     7004    1   'OLDEST ENTRY - %2P%8.36.1U %1P%5A   NEWEST ENTRY - %3P%8.36.1U %4P%5A%10P');
      379     7005    1   DCL TIME_FMT BIT(72) DALIGNED STATIC INIT(VECTOR(TIME_HDR));
      380     7006    1   DCL B$TCB$ PTR SYMREF;
      381     7007        /**/
      382     7008        /* MACRO INVOCATIONS */
      383     7009        %NI$DVT (NAME=DVT,STCLASS=BASED);
      384     7016        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      385     7061        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED(SYM$)");
      386     7099        %B$TCB;
      387     7102        %B$ALT;
      388     7110        %XUD$UTS_ENTRIES;
      389     7142        %XUD_UTS_EQU;
      390     7153        /**/
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:49   
      391     7154        /* FPT DEFINITIONS */
      392     7155        %FPT_OPEN(FPTN=OPEN_ERRLOG2,
      393     7156                  STCLASS="STATIC SYMDEF",
      394     7157                  ACS=SEQUEN,
      395     7158                  ASN=FILE,
      396     7159                  ORG=CONSEC,
      397     7160                  FUN=CREATE,
      398     7161                  NAME=ERRLOG2,
      399     7162                  DCB=M$ERRLOG2);
      400     7271        %FPT_CLOSE(FPTN=CLOSE_ERRLOG2,
      401     7272                   STCLASS=STATIC,
      402     7273                   DISP=SAVE,
      403     7274                   DCB=M$ERRLOG2);
      404     7316        %FPT_WRITE(FPTN=WRITE_ERRLOG2,
      405     7317                   STCLASS=STATIC,
      406     7318                   DCB=M$ERRLOG2);
      407     7349        %FPT_OPEN(FPTN=OPEN_ERRLOG3,
      408     7350                  STCLASS="STATIC SYMDEF",
      409     7351                  ACS=SEQUEN,
      410     7352                  ASN=FILE,
      411     7353                  FUN=CREATE,
      412     7354                  NAME=ERRLOG3,
      413     7355                  DCB=M$ERRLOG3,
      414     7356                  ORG=CONSEC);
      415     7465        %FPT_CLOSE(FPTN=CLOSE_ERRLOG3,
      416     7466                   STCLASS=STATIC,
      417     7467                   DISP=SAVE,
      418     7468                   DCB=M$ERRLOG3);
      419     7510        %FPT_READ(FPTN=READ_ERRLOG3,
      420     7511                  STCLASS=STATIC,
      421     7512                  DCB=M$ERRLOG3);
      422     7551        %FPT_GDS(FPTN=GET_XSA_BUF,
      423     7552                 FREE=YES,
      424     7553                 RESULTS=TH_XSA_BUF_VECTOR,
      425     7554                 SEGSIZE=1024,
      426     7555                 STCLASS=STATIC);
      427     7571        %ZL_INPUT(FPTN=INPUT_TABLE,STCLASS=STATIC,N=1);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:50   
      428     7590        %ZL_FPT(STCLASS=STATIC,FPT=OPEN_ERRLOG2);
      429     7618        %SORT_TABLE(FPTN=SORT_ERRLOG2,
      430     7619                    STCLASS=STATIC,
      431     7620                    INSIZ=1024,
      432     7621                    OUTSIZ=1024,
      433     7622                    KCE=IOERR$COMPARE,
      434     7623                    INPUT=INPUT_TABLE,
      435     7624                    OUTPUT=OPEN_ERRLOG3);
      436     7733        %FPT_TIME (FPTN=RECORD_DATE,
      437     7734                   SOURCE=UTS,
      438     7735                   DEST=EXT,
      439     7736                   DATE=TH_DATE,
      440     7737                   TIME=TH_TIME,
      441     7738                   DAY=TH_DAY,
      442     7739                   TSTAMP=TH_LASTUTS,
      443     7740                   STCLASS=CONSTANT);
      444     7759        %FPT_TIME (FPTN=EXT_DATE,
      445     7760                   STCLASS=CONSTANT,
      446     7761                   SOURCE=UTS,
      447     7762                   TSTAMP=ERRLOG_DATE,
      448     7763                   DEST=EXT,
      449     7764                   DATE=DATE_BUF,
      450     7765                   DAY=DAY_BUF);
      451     7784        %FPT_TIME (FPTN=LOC_DATE,
      452     7785                   STCLASS=CONSTANT,
      453     7786                   SOURCE=UTS,
      454     7787                   TSTAMP=LOC_UTS,
      455     7788                   DATE=DBUF,
      456     7789                   TIME=TBUF,
      457     7790                   DEST=LOCAL);
      458     7809        %FPT_OPEN (FPTN=OPEN_LO,
      459     7810                   STCLASS="SYMREF");
      460     7919        %FPT_OPEN (FPTN=SET_ONFILE,
      461     7920                   DCB=M$ONFILE,
      462     7921                   HDR=LO_HEADER,
      463     7922                   NAME=ONFILE_NAME,
      464     7923                   ACCT=ONFILE_ACCT,
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:51   
      465     7924                   PASS=ONFILE_PASS,
      466     7925                   SN=ONFILE_SN,
      467     7926                   WSN=ONFILE_WSN,
      468     7927                   FUN=CREATE,
      469     7928                   SCRUB=YES,
      470     7929                   ORG=UR);
      471     8038        %FPT_CLOSE (FPTN=CLOSE_ONFILE,
      472     8039                    STCLASS=CONSTANT,
      473     8040                    DISP=SAVE,
      474     8041                    DCB=M$ONFILE);
      475     8083        %FPT_CLOSE (FPTN=CLOSE_LO,
      476     8084                    STCLASS=CONSTANT,
      477     8085                    DISP=SAVE,
      478     8086                    DCB=M$LO);
      479     8128        %FPT_FID (NAME=ONFILE_NAME,
      480     8129                  ACCT=ONFILE_ACCT,
      481     8130                  PASS=ONFILE_PASS,
      482     8131                  WSN=ONFILE_WSN,
      483     8132                  SN=ONFILE_SN,
      484     8133                  ASN=SET_ONFILE.V.ASN#,
      485     8134                  RES=SET_ONFILE.V.RES#,
      486     8135                  RESULTS=ONFILE_RESULTS);
      487     8158        %FPT_CMDVAR(FPTN=SILENCE_SORT,
      488     8159                    NAME=VLP_NAME,
      489     8160                    VALUE=SORT_SUPPRESS,
      490     8161                    FUN=STORE,
      491     8162                    STCLASS=CONSTANT);
      492     8179        %FPT_OPEN(FPTN=OPEN_ERRLOG4,STCLASS="STATIC SYMDEF",ACS=SEQUEN,ASN=FILE,
      493     8180                  ORG=CONSEC,FUN=CREATE,NAME=ERRLOG4,DCB=M$ERRLOG4);
      494     8289        %FPT_CLOSE(FPTN=CLOSE_ERRLOG4,STCLASS=STATIC,DISP=SAVE,DCB=M$ERRLOG4);
      495     8331        %FPT_WRITE(FPTN=WRITE_ERRLOG4,STCLASS=STATIC,DCB=M$ERRLOG4);
      496     8362        %FPT_OPEN(FPTN=OPEN_ERRLOG5,STCLASS="STATIC SYMDEF",ACS=SEQUEN,FUN=CREATE,
      497     8363                  ASN=FILE,NAME=ERRLOG5,DCB=M$ERRLOG5,ORG=CONSEC);
      498     8472        %FPT_CLOSE(FPTN=CLOSE_ERRLOG5,STCLASS=STATIC,DISP=SAVE,DCB=M$ERRLOG5);
      499     8514        %FPT_READ(FPTN=READ_ERRLOG5,STCLASS=STATIC,DCB=M$ERRLOG5);
      500     8553        %ZL_INPUT(FPTN=INPUT_TBL,STCLASS=STATIC,N=1);
      501     8572        %ZL_FPT(STCLASS=STATIC,FPT=OPEN_ERRLOG4);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:52   
      502     8600        %SORT_TABLE(FPTN=SORT_ERRLOG4,STCLASS=STATIC,INSIZ=1024,OUTSIZ=1024,
      503     8601                    KCE=FEPERR$COMPARE,INPUT=INPUT_TBL,OUTPUT=OPEN_ERRLOG5);
      504     8710        %VLP_NAME(NAME='SORT$STAT',STCLASS=CONSTANT);
      505     8737        %VLP_NAME(FPTN=SORT_SUPPRESS,NAME='ERRORS',STCLASS=CONSTANT);
      506     8764        %VLP_NAME(FPTN=ERRLOG2,NAME='*ERRLOG2');
      507     8791        %VLP_NAME(FPTN=ERRLOG3,NAME='*ERRLOG3');
      508     8818        %VLP_NAME(FPTN=ERRLOG4,NAME='*ERRLOG4');
      509     8845        %VLP_NAME(FPTN=ERRLOG5,NAME='*ERRLOG5');
      510     8872        %VLP_NAME (FPTN=ONFILE_NAME,LEN=31);
      511     8899        %VLP_ACCT (FPTN=ONFILE_ACCT);
      512     8912        %VLP_PASS (FPTN=ONFILE_PASS);
      513     8925        %VLP_WSN (FPTN=ONFILE_WSN);
      514     8938        %VLP_SN (FPTN=ONFILE_SN);
      515     8951        %VLR_FID (FPTN=ONFILE_RESULTS);
      516     8970        %VLP_HDR (FPTN=LO_HEADER,
      517     8971                 STCLASS="STATIC SYMDEF",
      518     8972                 COUNT=107,
      519     8973                 HEADERHEIGHT=2,
      520     8974                 TITLE=' ',
      521     8975                 RESETPAGE=YES,
      522     8976                 LEN=106);
      523     8992        %EJECT;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:53   
      524     8993    1        ONFILE_SPECIFIED = %FALSE;
      525     8994    1        OUTPUT_DCB# = DCBNUM(M$LO);
      526     8995    1        IF DCBADDR(DCBNUM(M$LO))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_LO);
      527     8996    1        IF DCBADDR(DCBNUM(M$ONFILE))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_ONFILE);
      528     8997    1        COMP_CODE = 0;
      529     8998    1        CODE = %ALL;
      530     8999    1        TEMP_BUF = 'ALL';
      531     9000    1        LEN = 0;
      532     9001    1        BUF_INDX = 3;
      533     9002    1        FOR_CLAUSE_FLG = %FALSE;
      534     9003    1        REPORT_CODE = OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      535     9004    1        TH_NUM_REP_DEVS = 0;
      536     9005    2        DO I = 1 TO OUT$BLK.NSUBLKS - 1;
      537     9006    3           DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);
      538     9007    3              CASE(%FOR_CLAUSE);
      539     9008    3                 BUF_INDX = 0;
      540     9009    3                 TEMP_BUF = ' ';
      541     9010    4                 DO J = 0 TO OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS - 1;
      542     9011    4                    TEXT = '00000000';
      543     9012    4                    CODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0)->
              9012                             OUT$BLK.CODE;
      544     9013    4                    LEN = 2;
      545     9014    4                    COMP_CODE = CODE;
      546     9015    5                    DO CASE(CODE);
      547     9016    5                       CASE(%MTU);
      548     9017    5                          TEXT = 'MTU';
      549     9018    5                          COMP_CODE = %PERIPH;
      550     9019    5                          LEN = 3;
      551     9020    5                       CASE(%MSU);
      552     9021    5                          TEXT = 'MSU';
      553     9022    5                          COMP_CODE = %PERIPH;
      554     9023    5                          LEN = 3;
      555     9024    5                       CASE(%CRU);
      556     9025    5                          TEXT = 'CRU';
      557     9026    5                          COMP_CODE = %PERIPH;
      558     9027    5                          LEN = 3;
      559     9028    5                       CASE(%PCU);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:54   
      560     9029    5                          TEXT = 'PCU';
      561     9030    5                          COMP_CODE = %PERIPH;
      562     9031    5                          LEN = 3;
      563     9032    5                       CASE(%PRU);
      564     9033    5                          TEXT = 'PRU';
      565     9034    5                          COMP_CODE = %PERIPH;
      566     9035    5                          LEN = 3;
      567     9036    5                       CASE(%MPC1);
      568     9037    5                          TEXT = 'MPC';
      569     9038    5                          COMP_CODE = %MPC;
      570     9039    5                          LEN = 3;
      571     9040    5                       CASE(%CONSOLE);
      572     9041    5                          TEXT = 'CONSOLE';
      573     9042    5                          LEN = 7;
      574     9043    5                       CASE(%MEM);
      575     9044    5                          TEXT = 'MEM';
      576     9045    5                          LEN = 3;
      577     9046    5                       CASE(%MC);
      578     9047    5                          TEXT = 'MC';
      579     9048    5                          COMP_CODE = %PERIPH;
      580     9049    5                       CASE(%MT);
      581     9050    5                          TEXT = 'MT';
      582     9051    5                          COMP_CODE = %PERIPH;
      583     9052    5                       CASE(%SC);
      584     9053    5                          TEXT = 'SC';
      585     9054    5                          COMP_CODE = %PERIPH;
      586     9055    5                       CASE(%DP);
      587     9056    5                          TEXT = 'DP';
      588     9057    5                          COMP_CODE = %PERIPH;
      589     9058    5                       CASE(%CR);
      590     9059    5                          TEXT = 'CR';
      591     9060    5                          COMP_CODE = %PERIPH;
      592     9061    5                       CASE(%CP);
      593     9062    5                          TEXT = 'CP';
      594     9063    5                          COMP_CODE = %PERIPH;
      595     9064    5                       CASE(%LP);
      596     9065    5                          TEXT = 'LP';
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:55   
      597     9066    5                          COMP_CODE = %PERIPH;
      598     9067    5                       CASE(%AP);
      599     9068    5                          TEXT = 'AP';
      600     9069    5                          COMP_CODE = %PERIPH;
      601     9070    5                       CASE(%OD);
      602     9071    5                          TEXT = 'OD';
      603     9072    5                          COMP_CODE = %PERIPH;
      604     9073    5                       CASE(%AC);
      605     9074    5                          TEXT = 'AC';
      606     9075    5                          COMP_CODE = %MPC;
      607     9076    5                       CASE(%OPC);
      608     9077    5                          TEXT = 'OPTC';
      609     9078    5                          COMP_CODE = %MPC;
      610     9079    5                          LEN = 4;
      611     9080    5                       CASE(%UC);
      612     9081    5                          TEXT = 'UC';
      613     9082    5                          COMP_CODE = %MPC;
      614     9083    5                       CASE(%DC);
      615     9084    5                          TEXT = 'DC';
      616     9085    5                          COMP_CODE = %MPC;
      617     9086    5                       CASE(%TC);
      618     9087    5                          TEXT = 'TC';
      619     9088    5                          COMP_CODE = %MPC;
      620     9089    5                       CASE(%FEP);
      621     9090    5                          TEXT = 'FEP';
      622     9091    5                          LEN = 3;
      623     9092    5                       CASE(%IOM);
      624     9093    5                          TEXT = 'IOM';
      625     9094    5                          LEN = 3;
      626     9095    5                       CASE(%ALL);
      627     9096    5                          COMP_CODE = 0;
      628     9097    5                          TEXT = 'ALL';
      629     9098    5                          LEN = 3;
      630     9099    5                       CASE(%FNP);
      631     9100    5                          TEXT='FEP';
      632     9101    5                          LEN=3;
      633     9102    5                          CODE=%FEP;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:56   
      634     9103    5                       CASE(%TAPE);
      635     9104    5                          TEXT='MT';
      636     9105    5                          CODE=%MT;
      637     9106    5                          COMP_CODE=%PERIPH;
      638     9107    5                       CASE(%DISK);
      639     9108    5                          TEXT='DP';
      640     9109    5                          COMP_CODE=%PERIPH;
      641     9110    5                          CODE=%DP;
      642     9111    5                       CASE(%READER);
      643     9112    5                          TEXT='CR';
      644     9113    5                          COMP_CODE=%PERIPH;
      645     9114    5                          CODE=%CR;
      646     9115    5                       CASE(%PUNCH);
      647     9116    5                          TEXT='CP';
      648     9117    5                          COMP_CODE=%PERIPH;
      649     9118    5                          CODE=%CP;
      650     9119    5                       CASE(%PRINTER);
      651     9120    5                          TEXT='LP';
      652     9121    5                          COMP_CODE=%PERIPH;
      653     9122    5                          CODE=%LP;
      654     9123    5                       CASE(%URC);
      655     9124    5                          TEXT='UC';
      656     9125    5                          COMP_CODE=%MPC;
      657     9126    5                          CODE=%UC;
      658     9127    5                    END;                      /* DO CASE CODE                       */
      659     9128    4                    IF OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.NSUBLKS = 2
      660     9129    4                       THEN
      661     9130    5                       DO;
      662     9131    5                          SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(1
              9131                                   );
      663     9132    5                          CALL INSERT(TEXT,LEN,OUT$SYM.COUNT,OUT$SYM.TEXT);
      664     9133    5                          LEN = LEN + OUT$SYM.COUNT;
      665     9134    5                          TEXT_LEN = LEN;
      666     9135    5                       END;
      667     9136    4                       ELSE
      668     9137    5                       DO;
      669     9138    5                          TEXT_LEN = LEN;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:57   
      670     9139    5                          LEN = 0;
      671     9140    5                       END;
      672     9141    4                    CALL THS$SET_DEVS(CODE,TEXT,LEN) ALTRET(NO_REPORT);
      673     9142    5                    IF BUF_INDX > 0 THEN DO;
      674     9143    5                       CALL INSERT(TEMP_BUF,BUF_INDX,1,',');
      675     9144    5                       BUF_INDX = BUF_INDX + 1;
      676     9145    5                       END;  /* IF BUF_INDX > 0 */
      677     9146    4                    CALL INSERT(TEMP_BUF,BUF_INDX,TEXT_LEN,TEXT);
      678     9147    4                    BUF_INDX = BUF_INDX + TEXT_LEN;
      679     9148    4                    END;  /* DO J */
      680     9149    3                 FOR_CLAUSE_FLG = %TRUE;
      681     9150    3              CASE(%ON_CLAUSE);
      682     9151    3                 SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1);
      683     9152    3                 FPT_FID.TEXTFID_ = VECTOR(OUT$SYM.TEXT);
      684     9153    3                 CALL M$FID(FPT_FID) ALTRET(FID_ERR);
      685     9154
      686     9155    3                 SET_ONFILE.V.EXIST# = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.
              9155                          CODE;
      687     9156    3                 ONFILE_SPECIFIED = %TRUE;
      688     9157    3                 CALL M$OPEN( SET_ONFILE) ALTRET(OPN_ERR);
      689     9158    3           END;                            /* CASE                               */
      690     9159    2        END;                               /* DO I                               */
      691     9160    1     IF FOR_CLAUSE_FLG
      692     9161    1        THEN ;
      693     9162    2        ELSE DO;
      694     9163    2           TEXT = 'ALL';
      695     9164    2           CALL THS$SET_DEVS(CODE,TEXT,LEN) ALTRET(NO_REPORT);
      696     9165    2           END;
      697     9166    1        TEXT$ = ADDR(TEXTBUF);
      698     9167    1        CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF,BUF_INDX);
      699     9168    1        TVEC = VECTOR(TEXTBUF);
      700     9169    1        TVEC.BOUND = BUF_INDX;
      701     9170    1        CALL THW$WRITE(HDR_TBL(REPORT_CODE),
      702     9171    1                       VECTOR(TH_SITE_ID),
      703     9172    1                       VECTOR(TH_SITE_NAME),
      704     9173    1                       VECTOR(TH_CONSTRAINTS.START),
      705     9174    1                       VECTOR(TH_CONSTRAINTS.STOP),
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:58   
      706     9175    1                       TVEC);
      707     9176    1     IF ONFILE_SPECIFIED
      708     9177    1      THEN
      709     9178    2       DO;
      710     9179    2         TH_OUTBUF=SUBSTR(TH_OUTBUF,1);
      711     9180    2         CALL INSERT(LO_HEADER.TITL.TITLE#,0,100,TH_OUTBUF);
      712     9181    2         CALL INSERT(LO_HEADER.TITL.TITLE#,101, ,'PAGE');
      713     9182    2         LO_HEADER.TITL.L# = LENGTHC(LO_HEADER.TITL.TITLE#);
      714     9183    2         IF DCBADDR(DCBNUM(M$LO))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_LO);
      715     9184    2         OUTPUT_DCB# = DCBNUM(M$ONFILE);
      716     9185    2       END;
      717     9186    1        TH_SAVE = TH_CONSTRAINTS;
      718     9187    2        DO CASE(REPORT_CODE);
      719     9188    2           CASE(%AMS);
      720     9189    2            TH_BRKMSG = '0'B;
      721     9190    2              CALL THF$AMS;
      722     9191    2           CASE(%CONFIG);
      723     9192    2            TH_BRKMSG = '0'B;
      724     9193    2              CALL THF$CONFIG(CODE);
      725     9194    2           CASE(%HWA);
      726     9195                                                /* HWA PROCEDURE                      */
      727     9196    2           CASE(%HWE);
      728     9197    2          TH_BRKMSG = '1'B;
      729     9198    2              IF COMP_CODE = %FEP
      730     9199    2                 THEN CALL THW$WRITE(VECTOR(FEPNOTIMP));
      731     9200    2                 ELSE
      732     9201    2              IF COMP_CODE = %MPC
      733     9202    2                 THEN CALL THW$WRITE(VECTOR(MPCNOTIMP));
      734     9203    2                 ELSE
      735     9204    2              IF COMP_CODE = %IOM
      736     9205    2                 THEN CALL THW$WRITE(VECTOR(IOMNOTIMP));
      737     9206    2                 ELSE CALL THF$HWE(COMP_CODE);
      738     9207    2           CASE(%IMS);
      739     9208                                                /* IMS CODE                           */
      740     9209    2           CASE(%KEYIN);
      741     9210                                                /* KEYIN CODE                         */
      742     9211    2           CASE(%MPR);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:59   
      743     9212                                                /* MPR CODE                           */
      744     9213    2           CASE(%PPR);
      745     9214                                                /* PPR CODE                           */
      746     9215    2           CASE(%RAS);
      747     9216                                                /* RAS CODE                           */
      748     9217    2           CASE(%RAW,%DETAIL,%EXTENDED);
      749     9218    2            TH_IOERR_FLG = %FALSE;
      750     9219    2            TH_FEPERR_FLG = %FALSE;
      751     9220    2            TH_RAW_FLG = %FALSE;
      752     9221    2          TH_BRKMSG = '1'B;
      753     9222    3              IF TH_CONSTRAINTS.NTYPES > 0 THEN DO;
      754     9223    3                 TEXT$ = ADDR(TEXTBUF);
      755     9224    3                 BUF_COUNT = 0;
      756     9225    4                 DO I = 0 TO TH_CONSTRAINTS.NTYPES - 1;
      757     9226    5                    IF I > 0 THEN DO;
      758     9227    5                       CALL INSERT(TEMP_BUF2,BUF_COUNT,2,', ');
      759     9228    5                       BUF_COUNT = BUF_COUNT + 2;
      760     9229    5                       END;  /* IF I > 0 */
      761     9230    4                    CALL THC$TYPENAME(TH_CONSTRAINTS.TYPES(I),TEMP_BUF,COUNT);
      762     9231    4                    CALL INSERT(TEMP_BUF2,BUF_COUNT,COUNT,SUBSTR(TEMP_BUF,0,COUNT));
      763     9232    4                    BUF_COUNT = BUF_COUNT + COUNT;
      764     9233    4                    END;  /* DO I */
      765     9234    3                 CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF2,BUF_COUNT);
      766     9235    3                 TVEC = VECTOR(TEXTBUF);
      767     9236    3                 TVEC.BOUND = BUF_COUNT;
      768     9237    3                 IF REPORT_CODE ~= %DETAIL
      769     9238    3                 THEN
      770     9239    3                 CALL THW$WRITE(VECTOR(TYPE_FMT),TVEC);
      771     9240    3                 END;  /* IF NTYPES > 0 */
      772     9241    2              TH_LAST_REQID = 0;
      773     9242    2       IF TH_CONSTRAINTS.M_MAJ_S OR TH_CONSTRAINTS.M_SUB_S OR
      774     9243    2          TH_CONSTRAINTS.M_MED_S OR TH_CONSTRAINTS.M_BY_B_SET ~='0'B
      775     9244    2          OR TH_CONSTRAINTS.M_FEP_SET OR TH_CONSTRAINTS.M_CHAN_SET
      776     9245    3            THEN DO;
      777     9246    3            CALL THW$WRITE(VECTOR(MATCH_FMT),VECTOR(TH_LAST_MATCH));
      778     9247    3            END;
      779     9248    2       IF TH_CONSTRAINTS.E_MAJ_S OR TH_CONSTRAINTS.E_SUB_S OR
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:60   
      780     9249    2          TH_CONSTRAINTS.E_MED_S OR TH_CONSTRAINTS.E_BY_B_SET ~='0'B
      781     9250    2          OR TH_CONSTRAINTS.E_FEP_SET OR TH_CONSTRAINTS.E_CHAN_SET
      782     9251    3            THEN DO;
      783     9252    3            CALL THW$WRITE(VECTOR(EXCLUDE_FMT),VECTOR(TH_LAST_EXCLUDE));
      784     9253    3            END;
      785     9254    3            IF REPORT_CODE = %DETAIL THEN DO;/* if detail report is requested*/
      786     9255    3            OPEN_ERRLOG2.V.FUN# = %CREATE#;   /* set FPTs to create files */
      787     9256    3            OPEN_ERRLOG4.V.FUN# = %CREATE#;
      788     9257    3            OPEN_ERRLOG3.V.FUN# = %CREATE#;
      789     9258    3            OPEN_ERRLOG5.V.FUN# = %CREATE#;
      790     9259    3            CLOSE_ERRLOG2.V.DISP# = %SAVE#;
      791     9260    3            CLOSE_ERRLOG4.V.DISP# = %SAVE#;
      792     9261    3            IF DCBADDR(DCBNUM(M$ERRLOG3))->F$DCB.FCD   /* if dcb is open */
      793     9262    4            THEN DO;
      794     9263    4                CLOSE_ERRLOG3.V.DISP# = %RELEASE#;     /* set it to release */
      795     9264    4                CALL M$CLOSE(CLOSE_ERRLOG3); /* close it */
      796     9265    4                CLOSE_ERRLOG3.V.DISP# = %SAVE#;        /* reset file to save */
      797     9266    4            END;
      798     9267    4            IF DCBADDR(DCBNUM(M$ERRLOG5))->F$DCB.FCD THEN DO;
      799     9268    4                CLOSE_ERRLOG5.V.DISP# = %RELEASE#;
      800     9269    4                CALL M$CLOSE(CLOSE_ERRLOG5);
      801     9270    4                CLOSE_ERRLOG3.V.DISP# = %SAVE#;
      802     9271    4            END;
      803     9272    3            CALL THC$DETAIL; /* call procedure to handle detail report */
      804     9273    4            IF MEMORY_ERRORS THEN DO;/* if MEM errors were read in */
      805     9274    4                COMP_CODE = %MEM;/* set code to MEM */
      806     9275    4                CALL THF$HWE(COMP_CODE);/* then call procedure to handle MEM errs*/
      807     9276    4            END;  /* if memory_errors */
      808     9277    4            IF NUM_FEPERR > 0 THEN DO;  /* if feperr was read */
      809     9278    4              CALL THW$WRITE(VECTOR(FEPERR_HDR));
      810     9279    4              TH_FEPERR_FLG = %TRUE;
      811     9280    4              CALL THW$WRITE(TIME_FMT,VECTOR(OLD_FEPERR_TIME),VECTOR(OLD_FEPERR_DATE),
              9280                       VECTOR(NEW_FEPERR_DATE),VECTOR(NEW_FEPERR_TIME));
      812     9281    5              IF NOT DCBADDR(DCBNUM(M$ERRLOG5))->F$DCB.FCD THEN DO;
              9281                       /*if dcb's not open*/
      813     9282    5                 OPEN_ERRLOG5.V.FUN# = %UPDATE#;/* set it to update */
      814     9283    5                 CALL M$OPEN(OPEN_ERRLOG5);/* open dcb */
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:61   
      815     9284    5              END;
      816     9285    4              EOF_FLAG = %FALSE;/* set appropriate flags */
      817     9286    4              TH_FIRST_TIME = %TRUE;
      818     9287    4              TH_ITYPE = %TH_FEPERR;
      819     9288    4              CALL M$GDS(GET_XSA_BUF) ALTRET(PMME_ERR);/* get memory */
      820     9289    4              READ_ERRLOG5.BUF_ = TH_XSA_BUF_VECTOR;/* assign read vector */
      821     9290    5                DO WHILE(NOT EOF_FLAG);
      822     9291    5                  CALL M$READ(READ_ERRLOG5) ALTRET(ERRLOG5_EOF);
      823     9292    5                  CALL THF$RAW(TH_DETAIL_FMT);
              9292                           /* call procedure to format/process feperr records */
      824     9293    6   DO NEVER;
      825     9294    6   ERRLOG5_EOF:     IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$EOF
      826     9295    6                    THEN EOF_FLAG = %TRUE;
      827     9296    6                    ELSE CALL THM$ERRMSG;
      828     9297    6                  END;  /* do never */
      829     9298    5                END;/* do while not eof */
      830     9299    4              CALL M$CLOSE(CLOSE_ERRLOG5);/* close dcb */
      831     9300    4              IF EOF_FLAG /* if its eof */
      832     9301    4                THEN TH_EOF_FLG = %TRUE;
      833     9302    4                CALL THF$RAW(TH_DETAIL_FMT);
              9302                         /* call procedure to process last record(s)*/
      834     9303    4              IF TH_XSA_BUF.P$ ~= ADDR(NIL)/* if memory was used */
      835     9304    4              THEN CALL M$FDS(GET_XSA_BUF) ALTRET(PMME_ERR);/* release it*/
      836     9305    4            END;  /* if num_feperr > 0 */
      837     9306    4            IF NUM_IOERR_REC > 0 THEN DO; /* if ioerr was read in */
      838     9307    4            CALL THW$WRITE(VECTOR(IOERR_HDR));
      839     9308    4        CALL THW$WRITE(TIME_FMT,VECTOR(OLD_IOERR_TIME),VECTOR(OLD_IOERR_DATE),VECTOR(
              9308                 NEW_IOERR_DATE),VECTOR(NEW_IOERR_TIME));
      840     9309    4            IF NOT DCBADDR(DCBNUM(M$ERRLOG3))->F$DCB.FCD  /*if errlog3 isn't open */
      841     9310    5            THEN DO;
      842     9311    5                OPEN_ERRLOG3.V.FUN#=%UPDATE#;   /* set FPT to update file */
      843     9312    5                CALL M$OPEN(OPEN_ERRLOG3);
      844     9313    5            END;
      845     9314    4            EOF_FLAG = %FALSE;/* set appropriate flags */
      846     9315    4            TH_EOF_FLG = %FALSE;
      847     9316    4            TH_IOERR_FLG = %TRUE;  /* set ioerr flg */
      848     9317    4            TH_FEPERR_FLG = %FALSE;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:62   
      849     9318    4            TH_FIRST_TIME = %TRUE;
      850     9319    4            TH_ITYPE = %TH_IOERR;
      851     9320    4            CALL M$GDS(GET_XSA_BUF) ALTRET(PMME_ERR);  /* get memory to use */
      852     9321    4            READ_ERRLOG3.BUF_=TH_XSA_BUF_VECTOR;  /* assign FPT's vector */
      853     9322    5              DO WHILE(NOT EOF_FLAG);
      854     9323    5                CALL M$READ(READ_ERRLOG3) ALTRET(ERRLOG3_EOF);
      855     9324    5                CALL THF$RAW(TH_DETAIL_FMT);
              9324                         /* call procedure to process/format ioerr */
      856     9325    6   DO NEVER;
      857     9326    6   ERRLOG3_EOF:   IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$EOF
      858     9327    6                  THEN EOF_FLAG =%TRUE;
      859     9328    6                  ELSE CALL THM$ERRMSG;
      860     9329    6                END;   /* DO NEVER  */
      861     9330    5              END;     /* DO WHILE  */
      862     9331    4              CALL M$CLOSE(CLOSE_ERRLOG3);/* close dcb */
      863     9332    4            IF EOF_FLAG THEN TH_EOF_FLG = %TRUE;/* if its eof */
      864     9333    4              CALL THF$RAW(TH_DETAIL_FMT);/* call procedure to process last record(s)*/
      865     9334    4              IF TH_XSA_BUF.P$ ~= ADDR(NIL)    /* if memory was used */
      866     9335    4              THEN CALL M$FDS(GET_XSA_BUF) ALTRET(PMME_ERR); /* then release it */
      867     9336    4            END;    /* if num_ioerr_rec > 0 */
      868     9337    3            END;    /* if report_code = %detail */
      869     9338    3            ELSE DO;
      870     9339    3            CALL XUD$UTS_DIFF_SEC (START_TIME, TH_CONSTRAINTS.START, 0);
      871     9340    3            START_TIME = START_TIME / 86400;
      872     9341    3            CALL XUD$UTS_ADJ_25TH (START_TIME, 0, START_TIME*%UTS_25TH_DAY#);
      873     9342    3            CALL XUD$UTS_DIFF_SEC (STOP_TIME, TH_CONSTRAINTS.STOP, 0);
      874     9343    3            STOP_TIME = STOP_TIME / 86400;
      875     9344    3            CALL XUD$UTS_ADJ_25TH (STOP_TIME, 0, STOP_TIME*%UTS_25TH_DAY#);
      876     9345    3          ERRLOG_DATE = START_TIME;
      877     9346    4          DO WHILE (ERRLOG_DATE <= STOP_TIME);
      878     9347    4                 NUM_RECS = 0;
      879     9348    4                 CALL THG$OPENXSA(ERRLOG_DATE) ALTRET(NO_FILE);
      880     9349    4                 CALL M$TIME(EXT_DATE);
      881     9350    4                 IF CODE = %ALL
      882     9351    4                    THEN
      883     9352    5                    DO;
      884     9353    5                       TH_NUM_REP_DEVS = 1;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:63   
      885     9354    5                       TH_REP_DEVS(0) = ' ';
      886     9355    5                    END;
      887     9356    5                 DO I = 0 TO TH_NUM_REP_DEVS - 1;
      888     9357    5                    TH_CONSTRAINTS.DEVNM = TH_REP_DEVS(I);
      889     9358    5                    IF TH_CONSTRAINTS.DEVNM ~= ' '
      890     9359    5                    THEN TH_CHECK_DEVNM = '1'B;
      891     9360    5                    ELSE TH_CHECK_DEVNM = '0'B;
      892     9361    5                    EOF_FLAG = %FALSE;
      893     9362    5            CALL THG$PRECORDXSA(TH_CONSTRAINTS.START);
      894     9363    6                    DO WHILE(NOT EOF_FLAG);
      895     9364    6                       CALL THG$GETREC(%ERRLOG) ALTRET(EOF_LBL);
      896     9365    6                       IF (NUM_RECS = 0) AND (REPORT_CODE ~= %DETAIL)
              9365                                /*if first rec & not detail report*/
      897     9366    6                          THEN CALL THW$WRITE(DATE_FMT,VECTOR(DAY_BUF),VECTOR(DATE_BUF)
              9366                                   );
      898     9367    6                       NUM_RECS = NUM_RECS + 1;
      899     9368    7                       IF TH_CONSTRAINTS.OCTAL THEN DO;
      900     9369    7                          LOC_UTS = RECORD.UTS;
      901     9370    7                          CALL M$TIME(LOC_DATE);
      902     9371    7                          TYPE = RECORD.TYPE;
      903     9372    7                          CALL THW$WRITE(DUMP_FMT,VECTOR(TYPE),VECTOR(DBUF),VECTOR(TBUF
              9372                                   ));
      904     9373    7                          CALL THF$DUMP(TH_RECORD.PTR$);
      905     9374    7                          END;  /* IF OCTAL */
      906     9375    7                       ELSE DO;
      907     9376    7                          CALL M$TIME(RECORD_DATE);
      908     9377    7                          TH_DETAIL_FLG = %FALSE;
      909     9378    7                          IF REPORT_CODE = %RAW
      910     9379    8                          THEN DO;  /* call formattor routine with raw formats*/
      911     9380    8                               TH_RAW_FLG = %TRUE;
      912     9381    8                               CALL THF$RAW(TH_RAW_FMT);/* process raw report*/
      913     9382    8                          END;
      914     9383    7                          ELSE /* call formatter routine w/extended formats */
      915     9384    7                               CALL THF$RAW(TH_EXTENDED_FMT);
              9384                                        /* process extended report*/
      916     9385    7                          END;
      917     9386    7                       DO NEVER;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:64   
      918     9387    7              EOF_LBL:    EOF_FLAG = %TRUE;
      919     9388    7                       END;                /* DO NEVER                           */
      920     9389    6                    END;                   /* DO WHILE NOT EOF_FLG               */
      921     9390    5                 END;                      /* DO I = 0 TO TH_NUM_REP_DEVS - 1    */
      922     9391    4     NO_FILE:
      923     9392    4                 CALL XUD$UTS_ADJ_25TH (ERRLOG_DATE, ERRLOG_DATE, %UTS_25TH_DAY#);
      924     9393    4              END;                   /* DO WHILE (ERRLOG_DATE <= STOP) */
      925     9394    3              CALL THG$CLOSEXSA;
      926     9395    3              TH_LASTTYPE = -1;
      927     9396    3             END;
      928     9397    2           CASE(%SUM);
      929     9398    2            TH_BRKMSG = '0'B;
      930     9399    3              IF TH_CONSTRAINTS.NTYPES > 0 THEN DO;
      931     9400    3                 TEXT$ = ADDR(TEXTBUF);
      932     9401    3                 BUF_COUNT = 0;
      933     9402    4                 DO I = 0 TO TH_CONSTRAINTS.NTYPES - 1;
      934     9403    5                    IF I > 0 THEN DO;
      935     9404    5                       CALL INSERT(TEMP_BUF2,BUF_COUNT,2,', ');
      936     9405    5                       BUF_COUNT = BUF_COUNT + 2;
      937     9406    5                       END;  /* IF I > 0 */
      938     9407    4                    CALL THC$TYPENAME(TH_CONSTRAINTS.TYPES(I),TEMP_BUF,COUNT);
      939     9408    4                    CALL INSERT(TEMP_BUF2,BUF_COUNT,COUNT,SUBSTR(TEMP_BUF,0,COUNT));
      940     9409    4                    BUF_COUNT = BUF_COUNT + COUNT;
      941     9410    4                    END;  /* DO I */
      942     9411    3                 CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF2,BUF_COUNT);
      943     9412    3                 TVEC = VECTOR(TEXTBUF);
      944     9413    3                 TVEC.BOUND = BUF_COUNT;
      945     9414    3                 CALL THW$WRITE(VECTOR(TYPE_FMT),TVEC);
      946     9415    3                 END;  /* IF NTYPES > 0 */
      947     9416    2       IF TH_CONSTRAINTS.M_MAJ_S OR TH_CONSTRAINTS.M_SUB_S OR
      948     9417    2          TH_CONSTRAINTS.M_MED_S OR TH_CONSTRAINTS.M_BY_B_SET ~='0'B
      949     9418    2          OR TH_CONSTRAINTS.M_FEP_SET OR TH_CONSTRAINTS.M_CHAN_SET
      950     9419    3            THEN DO;
      951     9420    3            CALL THW$WRITE(VECTOR(MATCH_FMT),VECTOR(TH_LAST_MATCH));
      952     9421    3            END;
      953     9422    2       IF TH_CONSTRAINTS.E_MAJ_S OR TH_CONSTRAINTS.E_SUB_S OR
      954     9423    2          TH_CONSTRAINTS.E_MED_S OR TH_CONSTRAINTS.E_BY_B_SET ~='0'B
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:65   
      955     9424    2          OR TH_CONSTRAINTS.E_FEP_SET OR TH_CONSTRAINTS.M_CHAN_SET
      956     9425    3            THEN DO;
      957     9426    3            CALL THW$WRITE(VECTOR(EXCLUDE_FMT),VECTOR(TH_LAST_EXCLUDE));
      958     9427    3            END;
      959     9428    2              NUM_TYPES = 0;
      960     9429    2              NUM_DEV = 0;
      961     9430    2              NUM_RECS = 0;
      962     9431    3              DO J = 0 TO 200;
      963     9432    3                 DEV_CNT(J) = 0;
      964     9433    3                 CONNECTS(J) = 0;
      965     9434    3                 ERRORS(J) = 0;
      966     9435    3                 DEV_MOUNT(J) = 0;
      967     9436    3              END;  /* do j */
      968     9437    2          CALL XUD$UTS_DIFF_SEC (START_TIME, TH_CONSTRAINTS.START, 0);
      969     9438    2          START_TIME = START_TIME / 86400;
      970     9439    2          CALL XUD$UTS_ADJ_25TH (START_TIME, 0, START_TIME*%UTS_25TH_DAY#);
      971     9440    2          CALL XUD$UTS_DIFF_SEC (STOP_TIME, TH_CONSTRAINTS.STOP, 0);
      972     9441    2          STOP_TIME = STOP_TIME / 86400;
      973     9442    2          CALL XUD$UTS_ADJ_25TH (STOP_TIME, 0, STOP_TIME*%UTS_25TH_DAY#);
      974     9443    2          ERRLOG_DATE = START_TIME;
      975     9444    3          DO WHILE (ERRLOG_DATE <= STOP_TIME);
      976     9445    3                 CALL THG$OPENXSA(ERRLOG_DATE) ALTRET(NO_FILE2);
      977     9446    4                 IF CODE = %ALL THEN DO;
      978     9447    4                    TH_NUM_REP_DEVS = 1;
      979     9448    4                    TH_REP_DEVS(0) = ' ';
      980     9449    4                    END;  /* IF CODE = %ALL */
      981     9450    4                 DO J = 0 TO TH_NUM_REP_DEVS - 1;
      982     9451    4                    TH_CONSTRAINTS.DEVNM = TH_REP_DEVS(J);
      983     9452    4                    IF TH_CONSTRAINTS.DEVNM ~= ' '
      984     9453    4                    THEN TH_CHECK_DEVNM = '1'B;
      985     9454    4                    ELSE TH_CHECK_DEVNM = '0'B;
      986     9455    4                    EOF_FLAG = %FALSE;
      987     9456    4            CALL THG$PRECORDXSA(TH_CONSTRAINTS.START);
      988     9457    5                    DO WHILE(NOT EOF_FLAG);
      989     9458    5                       CALL THG$GETREC(%ERRLOG) ALTRET(EOF);
      990     9459    5                       NUM_RECS = NUM_RECS + 1;
      991     9460    5                       INFO$ = ADDR(RECORD.INFO);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:66   
      992     9461    5                       RECORD_TYPE = RECORD.TYPE;
      993     9462    6                       DO K = 1 TO NUM_TYPES;
      994     9463    7                          IF TYPES(K) = RECORD_TYPE THEN DO;
      995     9464    7                             TYPE_CNT(K) = TYPE_CNT(K) + 1;
      996     9465    7                             GOTO FOUND_TYPE;
      997     9466    7                             END;  /* IF */
      998     9467    6                          END;  /* DO K */
      999     9468    5                          NUM_TYPES = NUM_TYPES + 1;
     1000     9469    5                          TYPES(NUM_TYPES) = RECORD_TYPE;
     1001     9470    5                          TYPE_CNT(NUM_TYPES) = 1;
     1002     9471    5   FOUND_TYPE: ;
     1003     9472    6                        IF RECORD.TYPE = EL_MOUNT THEN DO;
              9472                                 /* if record's mount errors */
     1004     9473    7                             DO K = 1 TO NUM_DEV;/* go through device tbl*/
     1005     9474                                    /* if current device is found */
     1006     9475    8                               IF DEVNM(K) = EL$MTDMT.DEVNAME THEN DO;
     1007     9476    8                                  DEV_MOUNT(K) = DEV_MOUNT(K) + 1;
              9476                                           /* increment counter*/
     1008     9477    8                                  GOTO FOUND_MOUNT;
     1009     9478    8                               END; /* if devnm(k) = mount_devnm */
     1010     9479    7                             END;  /* do k */
     1011     9480    6                          NUM_DEV = NUM_DEV + 1;
     1012     9481    6                          DEVNM(NUM_DEV) = EL$MTDMT.DEVNAME;
     1013     9482    6                          DEV_MOUNT(NUM_DEV) = 1;
     1014     9483    6   FOUND_MOUNT: ;
     1015     9484    6                        END; /* if record.type = el_mount */
     1016     9485    6                       IF RECORD.TYPE = EL_IOERR THEN DO;
     1017     9486    7                          DO K = 1 TO NUM_DEV;
     1018     9487    8                             IF DEVNM(K) = EL$IOERR.DEVNM THEN DO;
     1019     9488    8                                DEV_CNT(K) = DEV_CNT(K) + EL$IOERR.COUNT;
     1020     9489    8                                CONNECTS(K) = CONNECTS(K) + EL$IOERR.CONNECTS.DEVICE;
              9489                                         /*add connects*/
     1021     9490    8                                ERRORS(K) = ERRORS(K) + EL$IOERR.ERRCT;
     1022     9491    8                                GOTO FOUND_DEVNM;
     1023     9492    8                                END;  /* IF */
     1024     9493    7                             END;  /* DO K */
     1025     9494    6                             NUM_DEV = NUM_DEV + 1;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:67   
     1026     9495    6                             DEVNM(NUM_DEV) = EL$IOERR.DEVNM;
     1027     9496    6                             DEV_CNT(NUM_DEV) = 1;/* set device counter*/
     1028     9497    6                             CONNECTS(NUM_DEV) = EL$IOERR.CONNECTS.DEVICE;
     1029     9498    6                             ERRORS(NUM_DEV) = EL$IOERR.COUNT;
     1030     9499    6   FOUND_DEVNM: ;
     1031     9500    6                          END;  /* IF RECORD.TYPE = EL_IOERR */
     1032     9501    6                       DO NEVER;
     1033     9502    6                 EOF:     EOF_FLAG = %TRUE;
     1034     9503    6                          END;  /* DO NEVER */
     1035     9504    5                       END;  /* DO WHILE NOT EOF_FLAG */
     1036     9505    4                    END;  /* DO J = 0 TO TH_NUM_REP_DEVS - 1 */
     1037     9506    3   NO_FILE2:
     1038     9507    3                 CALL XUD$UTS_ADJ_25TH(ERRLOG_DATE, ERRLOG_DATE, %UTS_25TH_DAY#);
     1039     9508    3                 END;  /* DO WHILE (ERRLOG_DATE <= STOP)  */
     1040     9509    2              CALL THG$CLOSEXSA;
     1041     9510    3              IF NUM_TYPES > 0 THEN DO;
     1042     9511    3                 CALL THW$WRITE(VECTOR(SUM_FMT));
     1043     9512    4                 DO I = 1 TO NUM_TYPES;
     1044     9513    4                    TEXT$ = ADDR(TEXTBUF);
     1045     9514    4                    TYPEB = TYPES(I);
     1046     9515    4                    CALL THC$TYPENAME(TYPEB,TEMP_BUF,COUNT);
     1047     9516    4                    CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF,COUNT);
     1048     9517    4                    TVEC = VECTOR(TEXTBUF);
     1049     9518    4                    TVEC.BOUND = COUNT;
     1050     9519    4                    CALL THW$WRITE(VECTOR(SUM_ENTRY),
     1051     9520    4                                   TVEC,
     1052     9521    4                                   VECTOR(TYPE_CNT(I)));
     1053     9522    4                    END;  /* DO I */
     1054     9523    3                 END;  /* IF NUM_TYPES > 0 */
     1055     9524    3              IF NUM_DEV > 0 THEN DO;
     1056     9525    3                 CALL THW$WRITE(DEV_HDR);
     1057     9526    4                 DO I = 1 TO NUM_DEV;
     1058     9527    4                   IF ((TH_CONSTRAINTS.NTYPES = 0)AND((DEV_CNT(I) > 0)OR(CONNECTS(I) >
              9527                            0)OR(ERRORS(I) > 0)))
     1059     9528    4                     OR (TH_CONSTRAINTS.NTYPES > 0)THEN
     1060     9529    4                    CALL THW$WRITE(VECTOR(DEV_ENTRY),VECTOR(DEVNM(I)),
     1061     9530    4                                   VECTOR(DEV_CNT(I)),VECTOR(CONNECTS(I)),
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:68   
     1062     9531    4                                   VECTOR(ERRORS(I)),VECTOR(DEV_MOUNT(I)));
     1063     9532    4                    END;  /* DO I */
     1064     9533    3                 END;  /* IF NUM_DEV > 0 */
     1065     9534    2              CALL THW$WRITE(VECTOR(SUM_TOT),VECTOR(NUM_RECS));
     1066     9535    2           CASE(%SEC);
     1067     9536                                                /* SEC CODE                           */
     1068     9537    2           CASE(%SWE);
     1069     9538                                                /* SWE CODE                           */
     1070     9539    2           CASE(%SYS);
     1071     9540    2            TH_BRKMSG = '0'B;
     1072     9541    2              CALL THF$SYS;
     1073     9542    2           CASE(%UPR);
     1074     9543    2            TH_BRKMSG = '0'B;
     1075     9544    2              CALL THF$UPR;
     1076     9545    2        END;                               /* case report code                   */
     1077     9546    1        TH_EOF_FLG = %FALSE;
     1078     9547    1        TH_FIRST_TIME = %TRUE;
     1079     9548    1        TH_IOERR_FLG = %FALSE;
     1080     9549    1        TH_FEPERR_FLG = %FALSE;
     1081     9550    1        TH_DETAIL_FLG = %TRUE;
     1082     9551    1        TH_NUM_REP_DEVS = 0;
     1083     9552    1        TH_CONSTRAINTS = TH_SAVE;
     1084     9553    1        IF DCBADDR(DCBNUM(M$LO))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_LO);
     1085     9554    1        IF DCBADDR(DCBNUM(M$ONFILE))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_ONFILE);
     1086     9555    2        DO NEVER;
     1087     9556    2   OPN_ERR:
     1088     9557    2           CALL THM$ERRMSG;
     1089     9558    2        END;                               /* do never                           */
     1090     9559    2   DO NEVER;
     1091     9560    2   PMME_ERR: CALL THM$ERRMSG;
     1092     9561    2   END;
     1093     9562    1   NO_REPORT:
     1094     9563    1        RETURN;
     1095     9564    1   FID_ERR:
     1096     9565    1        CALL THM$ERRMSG;
     1097     9566    1        RETURN;
     1098     9567        %EJECT;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:69   
     1099     9568        /* INTERNAL PROC TO PROCESS ERRLOG FILE FOR DETAIL REPORT */
     1100     9569    1   THC$DETAIL: PROC;
     1101     9570        /**/
     1102     9571    2      TH_EOF_FLG = %FALSE;
     1103     9572    2      TH_FIRST_TIME = %TRUE;
     1104     9573    2      TH_IOERR_FLG = %FALSE;
     1105     9574    2      TH_FEPERR_FLG = %FALSE;
     1106     9575    2      TH_DETAIL_FLG = %TRUE;
     1107     9576    2      OLD_FEPERR_TIME = ' ';
     1108     9577    2      NEW_FEPERR_TIME= ' ';
     1109     9578    2      OLD_IOERR_TIME = ' ';
     1110     9579    2      NEW_IOERR_TIME = ' ';
     1111     9580    2      NUM_IOERR_REC = 0;
     1112     9581    2      NUM_FEPERR = 0;
     1113     9582    2      MEMORY_ERRORS = %FALSE;
     1114     9583    2   CALL XUD$UTS_DIFF_SEC (START_TIME, TH_CONSTRAINTS.START, 0);
     1115     9584    2   START_TIME = START_TIME / 86400;
     1116     9585    2   CALL XUD$UTS_ADJ_25TH (START_TIME, 0, START_TIME*%UTS_25TH_DAY#);
     1117     9586    2   CALL XUD$UTS_DIFF_SEC (STOP_TIME, TH_CONSTRAINTS.STOP, 0);
     1118     9587    2   STOP_TIME = STOP_TIME / 86400;
     1119     9588    2   CALL XUD$UTS_ADJ_25TH (STOP_TIME, 0, STOP_TIME*%UTS_25TH_DAY#);
     1120     9589    2   ERRLOG_DATE = START_TIME;
     1121     9590    3   DO WHILE (ERRLOG_DATE <= STOP_TIME);
     1122     9591    3             NUM_RECS = 0;
     1123     9592    3     CALL THG$OPENXSA(ERRLOG_DATE) ALTRET(FILE_NO);
     1124     9593    3     CALL M$TIME(EXT_DATE);
     1125     9594    4     IF CODE = %ALL THEN DO;
     1126     9595    4        TH_NUM_REP_DEVS = 1;
     1127     9596    4        TH_REP_DEVS(0) = ' ';
     1128     9597    4     END;
     1129     9598
     1130     9599    4        DO I = 0 TO TH_NUM_REP_DEVS - 1;
     1131     9600    4          TH_CONSTRAINTS.DEVNM = TH_REP_DEVS(I);
     1132     9601    4          IF TH_CONSTRAINTS.DEVNM ~= ' '
     1133     9602    4          THEN TH_CHECK_DEVNM = '1'B;
     1134     9603    4          ELSE TH_CHECK_DEVNM = '0'B;
     1135     9604    4          EOF_FLAG = %FALSE;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:70   
     1136     9605    4          CALL THG$PRECORDXSA(TH_CONSTRAINTS.START);
     1137     9606    4          CALL M$OPEN(OPEN_ERRLOG2);
     1138     9607    4          CALL M$OPEN(OPEN_ERRLOG4);
     1139     9608    5        DO WHILE(NOT EOF_FLAG);
     1140     9609    5          CALL THG$GETREC(%ERRLOG) ALTRET(LBL_EOF);
              9609                   /* get one record from errlog file */
     1141     9610    5          CALL M$TIME(RECORD_DATE);/* get time of error occurrence */
     1142     9611    5            INFO$ = ADDR(RECORD.INFO);  /* assign EL$IOERR frame to input buffer */
     1143     9612    5            WRITE_ERRLOG4.BUF_.BOUND = TH_RECORD.BOUND;
     1144     9613    5            WRITE_ERRLOG4.BUF_.BUF$ = INFO$;
     1145     9614    5            WRITE_ERRLOG2.BUF_.BOUND = TH_RECORD.BOUND; /* assign vectors  bound */
     1146     9615    5            WRITE_ERRLOG2.BUF_.BUF$ = INFO$; /* assign vector's pointer */
     1147     9616    5              IF TH_FIRST_TIME AND (TH_ITYPE = %TH_IOERR OR TH_ITYPE = %TH_FEPERR)
              9616                       /*if first rec is ioerr or feperr */
     1148     9617    6              THEN DO;
     1149     9618    7                DO CASE(TH_ITYPE);
     1150     9619    7                   CASE(%TH_IOERR);/* if ioerr record was fetched */
     1151     9620    7                       NUM_IOERR_REC = NUM_IOERR_REC + 1;/*increment counter*/
     1152     9621    7                       CALL M$WRITE(WRITE_ERRLOG2);/* write record to file*/
     1153     9622    7                       OLD_IOERR_DATE = ERRLOG_DATE;
     1154     9623    7                       OLD_IOERR_TIME = TH_TIME;
     1155     9624    7                   CASE(%TH_FEPERR);/* if feperr record was fetched*/
     1156     9625    7                       NUM_FEPERR = NUM_FEPERR + 1;/*increment counter*/
     1157     9626    7                       CALL M$WRITE(WRITE_ERRLOG4);/* write to file*/
     1158     9627    7                       OLD_FEPERR_DATE = ERRLOG_DATE;
     1159     9628    7                       OLD_FEPERR_TIME = TH_TIME;
     1160     9629    7                END; /* do case */
     1161     9630    6                       TH_FIRST_TIME = %FALSE;
     1162     9631    6              END;   /* if th_first_time & th_itype = th_ioerr or th_feperr */
     1163     9632    6              ELSE IF TH_ITYPE = %TH_IOERR OR TH_ITYPE = %TH_FEPERR THEN DO;
              9632                       /*if it's ioerr record read */
     1164     9633    7                DO CASE(TH_ITYPE);
     1165     9634    7                   CASE(%TH_IOERR);
     1166     9635    7                       NUM_IOERR_REC = NUM_IOERR_REC + 1;
     1167     9636    7                       CALL M$WRITE(WRITE_ERRLOG2);
     1168     9637    8                         IF OLD_IOERR_TIME = ' ' THEN DO;
     1169     9638    8                           OLD_IOERR_TIME = TH_TIME;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:71   
     1170     9639    8                           OLD_IOERR_DATE = ERRLOG_DATE;
     1171     9640    8                         END;  /* if old_ioerr_time = ' '*/
     1172     9641    7                       NEW_IOERR_DATE = ERRLOG_DATE;
     1173     9642    7                       NEW_IOERR_TIME = TH_TIME;
     1174     9643    7                   CASE(%TH_FEPERR);
     1175     9644    7                       NUM_FEPERR = NUM_FEPERR + 1;
     1176     9645    7                       CALL M$WRITE(WRITE_ERRLOG4);
     1177     9646    8                         IF OLD_FEPERR_TIME = ' ' THEN DO;
     1178     9647    8                           OLD_FEPERR_TIME = TH_TIME;
     1179     9648    8                           OLD_FEPERR_DATE = ERRLOG_DATE;
     1180     9649    8                         END;  /* if old_feperr_time = ' '*/
     1181     9650    7                       NEW_FEPERR_DATE = ERRLOG_DATE;
     1182     9651    7                       NEW_FEPERR_TIME = TH_TIME;
     1183     9652    7                END; /* do case*/
     1184     9653    6              END;/* if th_itype = th_ioerr or th_feperr */
     1185     9654    6              ELSE DO;/* if ioerr/feperr records were not fetched */
     1186     9655    6                    IF (NUM_RECS = 0) AND (TH_ITYPE ~= %TH_EDAC) THEN
     1187     9656    6                     CALL THW$WRITE(DATE_FMT,VECTOR(DAY_BUF),VECTOR(DATE_BUF));
     1188     9657    6                    NUM_RECS = NUM_RECS + 1;
     1189     9658    7                    IF TH_CONSTRAINTS.OCTAL THEN DO;/* if octal flag's set*/
     1190     9659    7                       LOC_UTS = RECORD.UTS;
     1191     9660    7                       CALL M$TIME(LOC_DATE);
     1192     9661    7                       TYPE = RECORD.TYPE;
     1193     9662    7                       CALL THW$WRITE(DUMP_FMT,VECTOR(TYPE),VECTOR(DBUF),VECTOR(TBUF));
     1194     9663    7                       CALL THF$DUMP(TH_RECORD.PTR$);
     1195     9664    7                    END;
     1196     9665    6                    ELSE IF TH_ITYPE = %TH_EDAC THEN/*if MEM error record was fetched*/
     1197     9666    6                         MEMORY_ERRORS = %TRUE;/*set memory error flag*/
     1198     9667    6                    ELSE
     1199     9668    6                       CALL THF$RAW(TH_DETAIL_FMT);/* process record */
     1200     9669    6              END;/* else do */
     1201     9670    6          DO NEVER;
     1202     9671    6   LBL_EOF:      EOF_FLAG = %TRUE;
     1203     9672    6          END;   /* do never */
     1204     9673    5        END;     /* do while */
     1205     9674    4        END;     /* do i = 0 to th_num_rep_devs */
     1206     9675    3             CALL XUD$UTS_ADJ_25TH(ERRLOG_DATE, ERRLOG_DATE, %UTS_25TH_DAY#);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:72   
     1207     9676    3   FILE_NO: END; /* DO WHILE (ERRLOG_DATE <= STOP) */
     1208     9677    2        CALL M$CLOSE(CLOSE_ERRLOG2);/* close dcbs*/
     1209     9678    2        CALL M$CLOSE(CLOSE_ERRLOG4);
     1210     9679    2        OPEN_ERRLOG2.V.FUN# = %UPDATE#;/*set create fpt to update*/
     1211     9680    2        OPEN_ERRLOG4.V.FUN# = %UPDATE#;/* set create fpt to update */
     1212     9681    3          IF NUM_IOERR_REC > 0 THEN DO; /*if ioerr records are read from errlog file*/
     1213     9682    3            SORT_ERRLOG2.NREC# = NUM_IOERR_REC;/* sort fpt gets no. of records */
     1214     9683    3            CALL M$CMDVAR(SILENCE_SORT) ALTRET(SORT_ERR);
     1215     9684    3            CALL X$SORT(SORT_ERRLOG2) ALTRET(SORT_ERR); /*call sort */
     1216     9685    3          END;
     1217     9686    3          ELSE DO;/* if no ioerr records were read */
     1218     9687    3            CLOSE_ERRLOG2.V.DISP# = %RELEASE#; /* otherwise release file */
     1219     9688    3            CALL M$OPEN(OPEN_ERRLOG2)   /* open file*/
     1220     9689    4                WHENALTRETURN DO;
     1221     9690    4                   IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE
     1222     9691    4                   THEN;
     1223     9692    4                   ELSE    CALL M$MERC;
     1224     9693    4                    GOTO CHK_FEP;
     1225     9694    4                END;  /* whenaltreturn do */
     1226     9695    3            CALL M$CLOSE(CLOSE_ERRLOG2);/* and close file to release it*/
     1227     9696    3          END;
     1228     9697    3   CHK_FEP: IF NUM_FEPERR > 0 THEN DO; /* if feperr records were read */
     1229     9698    3            SORT_ERRLOG4.NREC# = NUM_FEPERR;/*sort fpt gets no. of feperr records*/
     1230     9699    3            CALL M$CMDVAR(SILENCE_SORT) ALTRET(SORT_ERR);
     1231     9700    3            CALL X$SORT(SORT_ERRLOG4) ALTRET(SORT_ERR);/* sort feperr recs*/
     1232     9701    3          END;/* if num_feperr > 0 */
     1233     9702    3          ELSE DO;/* if no feperr records were read*/
     1234     9703    3            CLOSE_ERRLOG4.V.DISP# = %RELEASE#;/* set fpt to release*/
     1235     9704    3            CALL M$OPEN(OPEN_ERRLOG4)
     1236     9705    4             WHENALTRETURN DO;
     1237     9706    4               IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE
     1238     9707    4               THEN;
     1239     9708    4               ELSE   CALL M$MERC;
     1240     9709    4                 GOTO DONE;
     1241     9710    4             END;  /* whenaltreturn do */
     1242     9711    3            CALL M$CLOSE(CLOSE_ERRLOG4);/* close dcb to release file*/
     1243     9712    3          END;  /* else do */
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:73   
     1244     9713    3   DO NEVER;
     1245     9714    3        SORT_ERR: CALL THM$ERRMSG;
     1246     9715    3      END;
     1247     9716    2   DONE:CALL THG$CLOSEXSA;
     1248     9717    2       TH_LASTTYPE = -1;
     1249     9718    2       RETURN;
     1250     9719    2   END THC$DETAIL;
     1251     9720    1   END THC$REPORT;
     1252     9721        %EOD;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:74   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   ZL_MACRO_C.:TOOLE04  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$REPORT.

   Procedure THC$REPORT requires 2050 words for executable code.
   Procedure THC$REPORT requires 1580 words of local(AUTO) storage.

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:75   

 Object Unit name= THC$REPORT                                 File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:07:32.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   DCB   even  none     0      0  M$ONFILE
    3   DCB   even  none     0      0  M$ERRLOG2
    4   DCB   even  none     0      0  M$ERRLOG3
    5   DCB   even  none     0      0  M$ERRLOG4
    6   DCB   even  none     0      0  M$ERRLOG5
    7   Data  even  none   934   1646  THC$REPORT
    8  RoData even  UTS    571   1073  THC$REPORT
    9   Proc  even  none  2050   4002  THC$REPORT
   10  RoData even  none   131    203  THC$REPORT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes            yes      Std        1  THC$REPORT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    7      1  OUTPUT_DCB#                        7    452  OPEN_ERRLOG2
    7    616  OPEN_ERRLOG3                       7   1162  OPEN_ERRLOG4
    7   1326  OPEN_ERRLOG5                       7   1612  LO_HEADER
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:76   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 IOERR$COMPARE
         yes           Std       3 FEPERR$COMPARE
         yes           Std       0 THF$AMS
         yes           Std       3 THF$DUMP
         yes           Std       1 THF$CONFIG
         yes           Std       1 THF$HWE
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
         yes           Std       0 THF$UPR
         yes           Std       1 THF$RAW
 yes     yes           Std       3 THS$SET_DEVS
         yes           Std      11 THW$WRITE
 yes     yes           Std       0 THG$CLOSEXSA
         yes           Std       0 THF$SYS
         yes           Std       3 THF$ADD_TEXTC
         yes           Std       3 THC$TYPENAME
 yes     yes           Std       1 THG$PRECORDXSA
 yes     yes           Std       4 THG$GETREC
 yes     yes           Std       1 THG$OPENXSA
 yes     yes           Std       1 X$SORT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:77   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_SAVE
     TH_BRKMSG                             TH_NUM_REP_DEVS                       TH_REP_DEVS
     TH_RECORD                             TH_ITYPE                              TH_LASTTYPE
     TH_LASTUTS                            TH_DAY                                TH_DATE
     TH_TIME                               TH_SITE_ID                            TH_SITE_NAME
     TH_LAST_MATCH                         TH_LAST_EXCLUDE                       TH_LAST_REQID
     TH_XSA_BUF_VECTOR                     TH_CHECK_DEVNM                        TH_DETAIL_FLG
     TH_RAW_FLG                            TH_IOERR_FLG                          TH_FEPERR_FLG
     TH_FIRST_TIME                         TH_EOF_FLG                            M$LO
     M$ONFILE                              M$ERRLOG2                             M$ERRLOG3
     M$ERRLOG4                             M$ERRLOG5                             TH_RAW_FMT
     TH_DETAIL_FMT                         TH_EXTENDED_FMT                       TH_OUTBUF
     B$TCB$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:78   


      173        1        /*T***********************************************************/
      174        2        /*T*                                                         */
      175        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      176        4        /*T*                                                         */
      177        5        /*T***********************************************************/
      178        6        THC$REPORT: PROC(TOP$);

      6  9 000000   000000 700200 xent  THC$REPORT   TSX0  ! X66_AUTO_1
         9 000001   003054 000001                    ZERO    1580,1

      179        7    1   DCL TOP$ PTR;
      180        8        /**/
      181        9        /* INCLUDE FILES */
      182       10        %INCLUDE CP_6;
      183       91        %INCLUDE CP_6_SUBS;
      184      631        %INCLUDE XU_MACRO_C;
      185     3737        %INCLUDE F$DCB;
      186     3786        %INCLUDE EL$TABLES;
      187     4109        %INCLUDE NI$TABLES;
      188     4325        %INCLUDE TH_SUBS_C;
      189     4707        %INCLUDE TH_DATA_R;
      190     4785        %INCLUDE EL_SUBS_C;
      191     4869        %INCLUDE ZL_MACRO_C;
      192     5519        %INCLUDE B_ERRORS_C;
      193     6646        %INCLUDE XUD_UTS_M;
      194     6728        /**/
      195     6729        /* ENTRY DEFS */
      196     6730    1   DCL X$SORT ENTRY(1) ALTRET;
      197     6731    1   DCL IOERR$COMPARE ENTRY(3);
      198     6732    1   DCL FEPERR$COMPARE ENTRY(3);
      199     6733    1   DCL THM$ERRMSG ENTRY(1);
      200     6734    1   DCL THS$SET_DEVS ENTRY(3) ALTRET;
      201     6735    1   DCL THF$DUMP ENTRY(3);
      202     6736    1   DCL THF$RAW ENTRY(1);
      203     6737    1   DCL THG$GETREC ENTRY(4) ALTRET;
      204     6738    1   DCL THG$OPENXSA ENTRY(1) ALTRET;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:79   
      205     6739    1   DCL THG$PRECORDXSA ENTRY(1) ALTRET;
      206     6740    1   DCL THG$CLOSEXSA ENTRY ALTRET;
      207     6741    1   DCL THW$WRITE ENTRY(11);
      208     6742    1   DCL THF$HWE ENTRY(1);
      209     6743    1   DCL THF$CONFIG ENTRY(1);
      210     6744    1   DCL THC$TYPENAME ENTRY(3);
      211     6745    1   DCL THF$ADD_TEXTC ENTRY(3);
      212     6746    1   DCL THF$AMS ENTRY;
      213     6747    1   DCL THF$UPR ENTRY;
      214     6748    1   DCL THF$SYS ENTRY;
      215     6749        /**/
      216     6750        /* DCBS */
      217     6751    1   DCL M$LO DCB;
      218     6752    1   DCL M$ONFILE DCB;
      219     6753    1   DCL M$ERRLOG2 DCB;
      220     6754    1   DCL M$ERRLOG3 DCB;
      221     6755    1   DCL M$ERRLOG4 DCB;
      222     6756    1   DCL M$ERRLOG5 DCB;
      223     6757        /**/
      224     6758        /**/
      225     6759        /* SUBS FOR DEVICE TYPE CHECKING */
      226     6760        %EQU DV_SC = 0;
      227     6761        %EQU DV_MPC = 6;
      228     6762        /**/
      229     6763        /* VARIABLES */
      230     6764    1   DCL START_TIME UBIN WORD;
      231     6765    1   DCL STOP_TIME UBIN WORD;
      232     6766    1   DCL ONFILE_SPECIFIED BIT(1) STATIC INIT('0'B);
      233     6767    1   DCL OUTPUT_DCB# UBIN STATIC SYMDEF INIT( DCBNUM(M$LO));
      234     6768    1   DCL TEXT$ PTR;
      235     6769    1   DCL TEXTBUF CHAR(900) STATIC INIT(' ');
      236     6770    1   DCL 1 TVEC DALIGNED,
      237     6771    1         2 BOUND UBIN(20) UNAL,
      238     6772    1         2 * BIT(16) UNAL,
      239     6773    1         2 PTR$ PTR;
      240     6774    1   DCL TEMP_BUF CHAR(132) STATIC INIT(' ');
      241     6775    1   DCL TEMP_BUF2 CHAR(900);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:80   
      242     6776    1   DCL BUF_COUNT UBIN;
      243     6777    1   DCL TH_RAW_FMT(0:0) PTR SYMREF;
      244     6778    1   DCL TH_DETAIL_FMT(0:0) PTR SYMREF;
      245     6779    1   DCL TH_EXTENDED_FMT(0:0) PTR SYMREF;
      246     6780    1   DCL TYPE UBIN WORD;
      247     6781    1   DCL DBUF CHAR(8) STATIC;
      248     6782    1   DCL TBUF CHAR(11) STATIC;
      249     6783    1   DCL LOC_UTS UBIN WORD STATIC;
      250     6784    1   DCL DUMP_HDR CHAR(0) CONSTANT INIT('%2/ TYPE = %D  TIME = %A - %A %10P');
      251     6785    1   DCL DUMP_FMT BIT(72) DALIGNED STATIC INIT(VECTOR(DUMP_HDR));
      252     6786    1   DCL SYM$ PTR;
      253     6787    1   DCL TEXT CHAR(8);
      254     6788    1   DCL CODE UBIN WORD;
      255     6789    1   DCL COMP_CODE UBIN;
      256     6790    1   DCL LEN UBIN WORD;
      257     6791    1   DCL TEXT_LEN UBIN WORD STATIC INIT(0);
      258     6792    1   DCL BUF_INDX UBIN WORD STATIC INIT(0);
      259     6793    1   DCL I UBIN;
      260     6794    1   DCL J UBIN;
      261     6795    1   DCL K SBIN;
      262     6796    1   DCL FOUND BIT(1);
      263     6797    1   DCL FOR_CLAUSE_FLG BIT(1);
      264     6798    1   DCL MEMORY_ERRORS BIT(1);
      265     6799    1   DCL NUM_IOERR_REC SBIN;
      266     6800    1   DCL NUM_FEPERR SBIN;
      267     6801    1   DCL NUM_RECS SBIN;
      268     6802    1   DCL NUM_TYPES SBIN;
      269     6803    1   DCL NUM_DEV SBIN;
      270     6804    1   DCL TYPES(0:%NTYPES) UBIN;
      271     6805    1   DCL RECORD_TYPE UBIN;
      272     6806    1   DCL TYPEB UBIN BYTE;
      273     6807    1   DCL TYPE_CNT(0:%NTYPES) UBIN;
      274     6808    1   DCL DEVNM(0:200) CHAR(8);
      275     6809    1   DCL DEV_CNT(0:200) SBIN;
      276     6810    1   DCL DEV_MOUNT(0:200) SBIN;
      277     6811    1   DCL CONNECTS(0:200) SBIN;
      278     6812    1   DCL ERRORS(0:200) SBIN;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:81   
      279     6813    1   DCL INFO$ PTR;
      280     6814        %EL$ENTRY(NAME=RECORD,STCLASS="BASED(TH_RECORD.PTR$)");
      281     6818        %EL$IOERR(STCLASS="BASED(INFO$)");
      282     6828        %EL$FEPERR(STCLASS="BASED(INFO$)");
      283     6907        %EL$MTDMT(STCLASS="BASED(INFO$)");
      284     6910    1   DCL OLD_FEPERR_DATE UBIN WORD STATIC;
      285     6911    1   DCL OLD_IOERR_DATE UBIN WORD STATIC;
      286     6912    1   DCL NEW_FEPERR_DATE UBIN WORD STATIC;
      287     6913    1   DCL NEW_IOERR_DATE UBIN WORD STATIC;
      288     6914    1   DCL OLD_FEPERR_TIME CHAR(11) STATIC;
      289     6915    1   DCL OLD_IOERR_TIME CHAR(11) STATIC;
      290     6916    1   DCL NEW_FEPERR_TIME CHAR(11) STATIC;
      291     6917    1   DCL NEW_IOERR_TIME CHAR(11) STATIC;
      292     6918    1   DCL COUNT UBIN WORD;
      293     6919    1   DCL REPORT_CODE UBIN;
      294     6920    1   DCL ERRLOG_DATE UBIN WORD STATIC;
      295     6921    1   DCL DAY_BUF CHAR(3) STATIC;
      296     6922    1   DCL EOF_FLAG BIT(1);
      297     6923    1   DCL DATE_BUF CHAR(10) STATIC;
      298     6924    1   DCL NOTIMP CHAR(0) CONSTANT INIT('Unimplimented report%10P');
      299     6925    1   DCL FEPNOTIMP CHAR(0) CONSTANT INIT('HWE for FEPs not currently implimented%10P');
      300     6926    1   DCL IOMNOTIMP CHAR(0) CONSTANT INIT('HWE for IOMs not currently implimented%10P');
      301     6927    1   DCL MPCNOTIMP CHAR(0) CONSTANT INIT('HWE for MPCs not currently implimented%10P');
      302     6928    1   DCL TYPE_FMT CHAR(0) CONSTANT INIT(
      303     6929    1   'ERROR TYPES: %T%10P');
      304     6930    1   DCL SUM_FMT CHAR(0) CONSTANT INIT(
      305     6931    1   '%2/SYSTEM ERRORS%2/TYPE (MNEMONIC)%38-COUNT%/----------------------------------- -
              6931        -----%10P');
      306     6932    1   DCL SUM_ENTRY CHAR(0) CONSTANT INIT(
      307     6933    1   '%T%37-%2P%6D%10P');
      308     6934    1   DCL DEV_FMT CHAR(0) CONSTANT INIT(
      309     6935    1   '%2/PERIPHERAL DEVICE ERRORS%2/DEVICE  COUNT ACTIVITY #RETRY MOUNTS%/-------- -----
              6935         -------- ------ ------%10P');
      310     6936    1   DCL DEV_HDR BIT(72) DALIGNED STATIC INIT(VECTOR(DEV_FMT));
      311     6937    1   DCL DEV_ENTRY CHAR(0) CONSTANT INIT(
      312     6938    1   '%4A%10-%2P%5D%16-%3P%8D%26-%4P%5D%33-%5P%5D%10P');
      313     6939    1   DCL SUM_TOT  CHAR(0) CONSTANT INIT(
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:82   
      314     6940    1   '%2/TOTAL ERRORS: %D%10P');
      315     6941    1   DCL AMS_HDR CHAR(0) CONSTANT INIT(
      316     6942    1   'Anticipatory Maintenance Summary for %2P%T   %14.36.6U%10P');
      317     6943    1   DCL CONFIG_HDR CHAR(0) CONSTANT INIT(
      318     6944    1   'Configuration Report (%5P%T) for %2P%T   %14.36.6U%10P');
      319     6945    1   DCL HWA_HDR CHAR(0) CONSTANT INIT(
      320     6946    1  '%2/Hardware Analysis Report (%5P%T) for %2P%T from %3P%14.36.2U to %4P%14.36.2U%2/%
              6946        10P');
      321     6947    1   DCL HWE_HDR CHAR(0) CONSTANT INIT(
      322     6948    1   'Hardware Error Report (%5P%T) for %2P%T from %3P%14.36.2U to %4P%14.36.2U%10P');
      323     6949    1   DCL IMS_HDR CHAR(0) CONSTANT INIT(
      324     6950    1  '%2/Installation Management Summary for %2P%T from %3P%14.36.2U to %4P%14.36.2U%2/%1
              6950        0P');
      325     6951    1   DCL KEYIN_HDR CHAR(0) CONSTANT INIT(
      326     6952    1   '%2/Keyin Report for %2P%T from %3P%14.36.2U to %4P%14.36.2U%2/%10P');
      327     6953    1   DCL MPR_HDR CHAR(0) CONSTANT INIT(
      328     6954    1   '%10P');                                /* MPR FORMAT                         */
      329     6955    1   DCL PPR_HDR CHAR(0) CONSTANT INIT(
      330     6956    1   '%10P');                                /* PPR FORMAT                         */
      331     6957    1   DCL RAS_HDR CHAR(0) CONSTANT INIT(
      332     6958    1   '%10P');                                /* RAS FORMAT                         */
      333     6959    1   DCL RAW_HDR CHAR(0) CONSTANT INIT(
      334     6960    1   'Error Log Listing (%5P%T) for %2P%T from %3P%14.36.2U to %4P%14.36.2U%10P');
      335     6961    1   DCL SEC_HDR CHAR(0) CONSTANT INIT(
      336     6962    1   '%10P');                                /* SEC REPORT                         */
      337     6963    1   DCL SWE_HDR CHAR(0) CONSTANT INIT(
      338     6964    1   '%10P');                                /* SWE REPORT                         */
      339     6965    1   DCL SYS_HDR CHAR(0) CONSTANT INIT(
      340     6966    1   'System Summary for %2P%T from %3P%14.36.2U to %4P%14.36.2U%10P');
      341     6967    1   DCL UPR_HDR CHAR(0) CONSTANT INIT(
      342     6968    1   'Unit Performance Report (%5P%T) for %2P%T    %14.36.6U%10P');
      343     6969    1   DCL SUM_HDR CHAR(0) CONSTANT INIT(
      344     6970    1   'Error Log Summary for %2P%T from %3P%14.36.2U to %4P%14.36.2U%10P');
      345     6971    1   DCL DETAIL_HDR CHAR(0) CONSTANT INIT(
      346     6972        'DETAIL ERROR REPORT for %2P%T %2/
      347     6973    1   REPORT PERIOD FROM %3P%14.36.2U TO %4P%14.36.2U %10P');
      348     6974    1   DCL IOERR_HDR CHAR(0) CONSTANT INIT(
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:83   
      349     6975    1   '%/*** PERIPHERAL I/O DATA ERROR DETAIL REPORT ***%10P');
      350     6976    1   DCL FEPERR_HDR CHAR(0) CONSTANT INIT(
      351     6977    1   '%/*** FEPERR DETAIL REPORT ***%10P');
      352     6978    1   DCL MATCH_FMT CHAR(0) CONSTANT INIT(
      353     6979    1   'STATUS MATCH: %T%10P');
      354     6980    1   DCL EXCLUDE_FMT CHAR(0) CONSTANT INIT(
      355     6981    1   'STATUS EXCLUDE: %T%10P');
      356     6982    1   DCL HDR_TBL(0:17) BIT(72) DALIGNED CONSTANT INIT(VECTOR(NIL),
      357     6983    1                             VECTOR(AMS_HDR),
      358     6984    1                             VECTOR(CONFIG_HDR),
      359     6985    1                             VECTOR(NOTIMP),
      360     6986    1                             VECTOR(HWE_HDR),
      361     6987    1                             VECTOR(NOTIMP),
      362     6988    1                             VECTOR(NOTIMP),
      363     6989    1                             VECTOR(NOTIMP),
      364     6990    1                             VECTOR(NOTIMP),
      365     6991    1                             VECTOR(NOTIMP),
      366     6992    1                             VECTOR(RAW_HDR),
      367     6993    1                             VECTOR(NOTIMP),
      368     6994    1                             VECTOR(NOTIMP),
      369     6995    1                             VECTOR(SYS_HDR),
      370     6996    1                             VECTOR(UPR_HDR),
      371     6997    1                             VECTOR(SUM_HDR),
      372     6998    1                             VECTOR(RAW_HDR),
      373     6999    1                             VECTOR(DETAIL_HDR));
      374     7000    1   DCL TH_OUTBUF CHAR(100) SYMREF;
      375     7001    1   DCL DATE_HDR CHAR(0) CONSTANT INIT('%2/ ***** %A %2P%A ***** %/%10P');
      376     7002    1   DCL DATE_FMT BIT(72) DALIGNED STATIC INIT(VECTOR(DATE_HDR));
      377     7003    1   DCL TIME_HDR CHAR(0) CONSTANT INIT(
      378     7004    1   'OLDEST ENTRY - %2P%8.36.1U %1P%5A   NEWEST ENTRY - %3P%8.36.1U %4P%5A%10P');
      379     7005    1   DCL TIME_FMT BIT(72) DALIGNED STATIC INIT(VECTOR(TIME_HDR));
      380     7006    1   DCL B$TCB$ PTR SYMREF;
      381     7007        /**/
      382     7008        /* MACRO INVOCATIONS */
      383     7009        %NI$DVT (NAME=DVT,STCLASS=BASED);
      384     7016        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      385     7061        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED(SYM$)");
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:84   
      386     7099        %B$TCB;
      387     7102        %B$ALT;
      388     7110        %XUD$UTS_ENTRIES;
      389     7142        %XUD_UTS_EQU;
      390     7153        /**/
      391     7154        /* FPT DEFINITIONS */
      392     7155        %FPT_OPEN(FPTN=OPEN_ERRLOG2,
      393     7156                  STCLASS="STATIC SYMDEF",
      394     7157                  ACS=SEQUEN,
      395     7158                  ASN=FILE,
      396     7159                  ORG=CONSEC,
      397     7160                  FUN=CREATE,
      398     7161                  NAME=ERRLOG2,
      399     7162                  DCB=M$ERRLOG2);
      400     7271        %FPT_CLOSE(FPTN=CLOSE_ERRLOG2,
      401     7272                   STCLASS=STATIC,
      402     7273                   DISP=SAVE,
      403     7274                   DCB=M$ERRLOG2);
      404     7316        %FPT_WRITE(FPTN=WRITE_ERRLOG2,
      405     7317                   STCLASS=STATIC,
      406     7318                   DCB=M$ERRLOG2);
      407     7349        %FPT_OPEN(FPTN=OPEN_ERRLOG3,
      408     7350                  STCLASS="STATIC SYMDEF",
      409     7351                  ACS=SEQUEN,
      410     7352                  ASN=FILE,
      411     7353                  FUN=CREATE,
      412     7354                  NAME=ERRLOG3,
      413     7355                  DCB=M$ERRLOG3,
      414     7356                  ORG=CONSEC);
      415     7465        %FPT_CLOSE(FPTN=CLOSE_ERRLOG3,
      416     7466                   STCLASS=STATIC,
      417     7467                   DISP=SAVE,
      418     7468                   DCB=M$ERRLOG3);
      419     7510        %FPT_READ(FPTN=READ_ERRLOG3,
      420     7511                  STCLASS=STATIC,
      421     7512                  DCB=M$ERRLOG3);
      422     7551        %FPT_GDS(FPTN=GET_XSA_BUF,
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:85   
      423     7552                 FREE=YES,
      424     7553                 RESULTS=TH_XSA_BUF_VECTOR,
      425     7554                 SEGSIZE=1024,
      426     7555                 STCLASS=STATIC);
      427     7571        %ZL_INPUT(FPTN=INPUT_TABLE,STCLASS=STATIC,N=1);
      428     7590        %ZL_FPT(STCLASS=STATIC,FPT=OPEN_ERRLOG2);
      429     7618        %SORT_TABLE(FPTN=SORT_ERRLOG2,
      430     7619                    STCLASS=STATIC,
      431     7620                    INSIZ=1024,
      432     7621                    OUTSIZ=1024,
      433     7622                    KCE=IOERR$COMPARE,
      434     7623                    INPUT=INPUT_TABLE,
      435     7624                    OUTPUT=OPEN_ERRLOG3);
      436     7733        %FPT_TIME (FPTN=RECORD_DATE,
      437     7734                   SOURCE=UTS,
      438     7735                   DEST=EXT,
      439     7736                   DATE=TH_DATE,
      440     7737                   TIME=TH_TIME,
      441     7738                   DAY=TH_DAY,
      442     7739                   TSTAMP=TH_LASTUTS,
      443     7740                   STCLASS=CONSTANT);
      444     7759        %FPT_TIME (FPTN=EXT_DATE,
      445     7760                   STCLASS=CONSTANT,
      446     7761                   SOURCE=UTS,
      447     7762                   TSTAMP=ERRLOG_DATE,
      448     7763                   DEST=EXT,
      449     7764                   DATE=DATE_BUF,
      450     7765                   DAY=DAY_BUF);
      451     7784        %FPT_TIME (FPTN=LOC_DATE,
      452     7785                   STCLASS=CONSTANT,
      453     7786                   SOURCE=UTS,
      454     7787                   TSTAMP=LOC_UTS,
      455     7788                   DATE=DBUF,
      456     7789                   TIME=TBUF,
      457     7790                   DEST=LOCAL);
      458     7809        %FPT_OPEN (FPTN=OPEN_LO,
      459     7810                   STCLASS="SYMREF");
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:86   
      460     7919        %FPT_OPEN (FPTN=SET_ONFILE,
      461     7920                   DCB=M$ONFILE,
      462     7921                   HDR=LO_HEADER,
      463     7922                   NAME=ONFILE_NAME,
      464     7923                   ACCT=ONFILE_ACCT,
      465     7924                   PASS=ONFILE_PASS,
      466     7925                   SN=ONFILE_SN,
      467     7926                   WSN=ONFILE_WSN,
      468     7927                   FUN=CREATE,
      469     7928                   SCRUB=YES,
      470     7929                   ORG=UR);
      471     8038        %FPT_CLOSE (FPTN=CLOSE_ONFILE,
      472     8039                    STCLASS=CONSTANT,
      473     8040                    DISP=SAVE,
      474     8041                    DCB=M$ONFILE);
      475     8083        %FPT_CLOSE (FPTN=CLOSE_LO,
      476     8084                    STCLASS=CONSTANT,
      477     8085                    DISP=SAVE,
      478     8086                    DCB=M$LO);
      479     8128        %FPT_FID (NAME=ONFILE_NAME,
      480     8129                  ACCT=ONFILE_ACCT,
      481     8130                  PASS=ONFILE_PASS,
      482     8131                  WSN=ONFILE_WSN,
      483     8132                  SN=ONFILE_SN,
      484     8133                  ASN=SET_ONFILE.V.ASN#,
      485     8134                  RES=SET_ONFILE.V.RES#,
      486     8135                  RESULTS=ONFILE_RESULTS);
      487     8158        %FPT_CMDVAR(FPTN=SILENCE_SORT,
      488     8159                    NAME=VLP_NAME,
      489     8160                    VALUE=SORT_SUPPRESS,
      490     8161                    FUN=STORE,
      491     8162                    STCLASS=CONSTANT);
      492     8179        %FPT_OPEN(FPTN=OPEN_ERRLOG4,STCLASS="STATIC SYMDEF",ACS=SEQUEN,ASN=FILE,
      493     8180                  ORG=CONSEC,FUN=CREATE,NAME=ERRLOG4,DCB=M$ERRLOG4);
      494     8289        %FPT_CLOSE(FPTN=CLOSE_ERRLOG4,STCLASS=STATIC,DISP=SAVE,DCB=M$ERRLOG4);
      495     8331        %FPT_WRITE(FPTN=WRITE_ERRLOG4,STCLASS=STATIC,DCB=M$ERRLOG4);
      496     8362        %FPT_OPEN(FPTN=OPEN_ERRLOG5,STCLASS="STATIC SYMDEF",ACS=SEQUEN,FUN=CREATE,
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:87   
      497     8363                  ASN=FILE,NAME=ERRLOG5,DCB=M$ERRLOG5,ORG=CONSEC);
      498     8472        %FPT_CLOSE(FPTN=CLOSE_ERRLOG5,STCLASS=STATIC,DISP=SAVE,DCB=M$ERRLOG5);
      499     8514        %FPT_READ(FPTN=READ_ERRLOG5,STCLASS=STATIC,DCB=M$ERRLOG5);
      500     8553        %ZL_INPUT(FPTN=INPUT_TBL,STCLASS=STATIC,N=1);
      501     8572        %ZL_FPT(STCLASS=STATIC,FPT=OPEN_ERRLOG4);
      502     8600        %SORT_TABLE(FPTN=SORT_ERRLOG4,STCLASS=STATIC,INSIZ=1024,OUTSIZ=1024,
      503     8601                    KCE=FEPERR$COMPARE,INPUT=INPUT_TBL,OUTPUT=OPEN_ERRLOG5);
      504     8710        %VLP_NAME(NAME='SORT$STAT',STCLASS=CONSTANT);
      505     8737        %VLP_NAME(FPTN=SORT_SUPPRESS,NAME='ERRORS',STCLASS=CONSTANT);
      506     8764        %VLP_NAME(FPTN=ERRLOG2,NAME='*ERRLOG2');
      507     8791        %VLP_NAME(FPTN=ERRLOG3,NAME='*ERRLOG3');
      508     8818        %VLP_NAME(FPTN=ERRLOG4,NAME='*ERRLOG4');
      509     8845        %VLP_NAME(FPTN=ERRLOG5,NAME='*ERRLOG5');
      510     8872        %VLP_NAME (FPTN=ONFILE_NAME,LEN=31);
      511     8899        %VLP_ACCT (FPTN=ONFILE_ACCT);
      512     8912        %VLP_PASS (FPTN=ONFILE_PASS);
      513     8925        %VLP_WSN (FPTN=ONFILE_WSN);
      514     8938        %VLP_SN (FPTN=ONFILE_SN);
      515     8951        %VLR_FID (FPTN=ONFILE_RESULTS);
      516     8970        %VLP_HDR (FPTN=LO_HEADER,
      517     8971                 STCLASS="STATIC SYMDEF",
      518     8972                 COUNT=107,
      519     8973                 HEADERHEIGHT=2,
      520     8974                 TITLE=' ',
      521     8975                 RESETPAGE=YES,
      522     8976                 LEN=106);
      523     8992        %EJECT;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:88   
      524     8993    1        ONFILE_SPECIFIED = %FALSE;

   8993  9 000002   000000 450000 7                  STZ     ONFILE_SPECIFIED

      525     8994    1        OUTPUT_DCB# = DCBNUM(M$LO);

   8994  9 000003   000000 236007 xsym               LDQ     M$LO,DL
         9 000004   000001 756000 7                  STQ     OUTPUT_DCB#

      526     8995    1        IF DCBADDR(DCBNUM(M$LO))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_LO);

   8995  9 000005   000000 236007 xsym               LDQ     M$LO,DL
         9 000006   000000 470400 10                 LDP0    0
         9 000007   000000 471500                    LDP1    0,,PR0
         9 000010   100000 473506                    LDP3    0,QL,PR1
         9 000011   300031 236100                    LDQ     25,,PR3
         9 000012   020000 316007                    CANQ    8192,DL
         9 000013   000017 600000 9                  TZE     s:8996

   8995  9 000014   000756 630400 8                  EPPR0   CLOSE_LO
         9 000015   050001 713400                    CLIMB   close
         9 000016   406000 401760                    pmme    nvectors=13

      527     8996    1        IF DCBADDR(DCBNUM(M$ONFILE))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_ONFILE);

   8996  9 000017   000000 236007 xsym               LDQ     M$ONFILE,DL
         9 000020   000000 470400 10                 LDP0    0
         9 000021   000000 471500                    LDP1    0,,PR0
         9 000022   100000 473506                    LDP3    0,QL,PR1
         9 000023   300031 236100                    LDQ     25,,PR3
         9 000024   020000 316007                    CANQ    8192,DL
         9 000025   000031 600000 9                  TZE     s:8997

   8996  9 000026   000720 630400 8                  EPPR0   CLOSE_ONFILE
         9 000027   050001 713400                    CLIMB   close
         9 000030   406000 401760                    pmme    nvectors=13

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:89   
      528     8997    1        COMP_CODE = 0;

   8997  9 000031   200361 450100                    STZ     COMP_CODE,,AUTO

      529     8998    1        CODE = %ALL;

   8998  9 000032   000016 235007                    LDA     14,DL
         9 000033   200360 755100                    STA     CODE,,AUTO

      530     8999    1        TEMP_BUF = 'ALL';

   8999  9 000034   040000 100400                    MLR     fill='040'O
         9 000035   001037 000003 8                  ADSC9   SORT_SUPPRESS+2          cn=0,n=3
         9 000036   000343 000204 7                  ADSC9   TEMP_BUF                 cn=0,n=132

      531     9000    1        LEN = 0;

   9000  9 000037   200362 450100                    STZ     LEN,,AUTO

      532     9001    1        BUF_INDX = 3;

   9001  9 000040   000003 236007                    LDQ     3,DL
         9 000041   000415 756000 7                  STQ     BUF_INDX

      533     9002    1        FOR_CLAUSE_FLG = %FALSE;

   9002  9 000042   200367 450100                    STZ     FOR_CLAUSE_FLG,,AUTO

      534     9003    1        REPORT_CODE = OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

   9003  9 000043   200003 470500                    LDP0    @TOP$,,AUTO
         9 000044   000000 471500                    LDP1    0,,PR0
         9 000045   100003 473500                    LDP3    3,,PR1
         9 000046   300000 236100                    LDQ     0,,PR3
         9 000047   777777 376007                    ANQ     -1,DL
         9 000050   203004 756100                    STQ     REPORT_CODE,,AUTO

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:90   
      535     9004    1        TH_NUM_REP_DEVS = 0;

   9004  9 000051   000000 450000 xsym               STZ     TH_NUM_REP_DEVS

      536     9005    2        DO I = 1 TO OUT$BLK.NSUBLKS - 1;

   9005  9 000052   000001 235007                    LDA     1,DL
         9 000053   200363 755100                    STA     I,,AUTO
         9 000054   000660 710000 9                  TRA     s:9159+3

      537     9006    3           DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);

   9006  9 000055   200003 470500                    LDP0    @TOP$,,AUTO
         9 000056   000000 471500                    LDP1    0,,PR0
         9 000057   200363 720100                    LXL0    I,,AUTO
         9 000060   100003 473510                    LDP3    3,X0,PR1
         9 000061   300000 721100                    LXL1    0,,PR3
         9 000062   000003 101003                    CMPX1   3,DU
         9 000063   000065 602011 9                  TNC     s:9006+8,X1
         9 000064   000655 710000 9                  TRA     s:9159
         9 000065   000655 710000 9                  TRA     s:9159
         9 000066   000070 710000 9                  TRA     s:9008
         9 000067   000617 710000 9                  TRA     s:9151

      538     9007    3              CASE(%FOR_CLAUSE);

      539     9008    3                 BUF_INDX = 0;

   9008  9 000070   000415 450000 7                  STZ     BUF_INDX

      540     9009    3                 TEMP_BUF = ' ';

   9009  9 000071   040000 100400                    MLR     fill='040'O
         9 000072   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000073   000343 000204 7                  ADSC9   TEMP_BUF                 cn=0,n=132

      541     9010    4                 DO J = 0 TO OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS - 1;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:91   

   9010  9 000074   200364 450100                    STZ     J,,AUTO
         9 000075   000603 710000 9                  TRA     s:9148+3

      542     9011    4                    TEXT = '00000000';

   9011  9 000076   001040 237000 8                  LDAQ    SORT_SUPPRESS+3
         9 000077   200356 757100                    STAQ    TEXT,,AUTO

      543     9012    4                    CODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0)->
              9012                             OUT$BLK.CODE;

   9012  9 000100   200003 470500                    LDP0    @TOP$,,AUTO
         9 000101   000000 471500                    LDP1    0,,PR0
         9 000102   200363 720100                    LXL0    I,,AUTO
         9 000103   100003 473510                    LDP3    3,X0,PR1
         9 000104   200364 721100                    LXL1    J,,AUTO
         9 000105   300003 474511                    LDP4    3,X1,PR3
         9 000106   400003 475500                    LDP5    3,,PR4
         9 000107   500000 236100                    LDQ     0,,PR5
         9 000110   777777 376007                    ANQ     -1,DL
         9 000111   200360 756100                    STQ     CODE,,AUTO

      544     9013    4                    LEN = 2;

   9013  9 000112   000002 235007                    LDA     2,DL
         9 000113   200362 755100                    STA     LEN,,AUTO

      545     9014    4                    COMP_CODE = CODE;

   9014  9 000114   200361 756100                    STQ     COMP_CODE,,AUTO

      546     9015    5                    DO CASE(CODE);

   9015  9 000115   000043 116007                    CMPQ    35,DL
         9 000116   000120 602006 9                  TNC     s:9015+3,QL
         9 000117   000515 710000 9                  TRA     s:9128
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:92   
         9 000120   000515 710000 9                  TRA     s:9128
         9 000121   000251 710000 9                  TRA     s:9044
         9 000122   000413 710000 9                  TRA     s:9093
         9 000123   000405 710000 9                  TRA     s:9090
         9 000124   000265 710000 9                  TRA     s:9050
         9 000125   000515 710000 9                  TRA     s:9128
         9 000126   000301 710000 9                  TRA     s:9056
         9 000127   000307 710000 9                  TRA     s:9059
         9 000130   000315 710000 9                  TRA     s:9062
         9 000131   000323 710000 9                  TRA     s:9065
         9 000132   000377 710000 9                  TRA     s:9087
         9 000133   000363 710000 9                  TRA     s:9081
         9 000134   000371 710000 9                  TRA     s:9084
         9 000135   000273 710000 9                  TRA     s:9053
         9 000136   000421 710000 9                  TRA     s:9096
         9 000137   000163 710000 9                  TRA     s:9017
         9 000140   000173 710000 9                  TRA     s:9021
         9 000141   000203 710000 9                  TRA     s:9025
         9 000142   000213 710000 9                  TRA     s:9029
         9 000143   000223 710000 9                  TRA     s:9033
         9 000144   000233 710000 9                  TRA     s:9037
         9 000145   000243 710000 9                  TRA     s:9041
         9 000146   000515 710000 9                  TRA     s:9128
         9 000147   000430 710000 9                  TRA     s:9100
         9 000150   000437 710000 9                  TRA     s:9104
         9 000151   000446 710000 9                  TRA     s:9108
         9 000152   000456 710000 9                  TRA     s:9112
         9 000153   000466 710000 9                  TRA     s:9116
         9 000154   000476 710000 9                  TRA     s:9120
         9 000155   000506 710000 9                  TRA     s:9124
         9 000156   000257 710000 9                  TRA     s:9047
         9 000157   000331 710000 9                  TRA     s:9068
         9 000160   000345 710000 9                  TRA     s:9074
         9 000161   000337 710000 9                  TRA     s:9071
         9 000162   000353 710000 9                  TRA     s:9077

      547     9016    5                       CASE(%MTU);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:93   

      548     9017    5                          TEXT = 'MTU';

   9017  9 000163   040100 100400                    MLR     fill='040'O
         9 000164   001042 000003 8                  ADSC9   SORT_SUPPRESS+5          cn=0,n=3
         9 000165   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      549     9018    5                          COMP_CODE = %PERIPH;

   9018  9 000166   000004 235007                    LDA     4,DL
         9 000167   200361 755100                    STA     COMP_CODE,,AUTO

      550     9019    5                          LEN = 3;

   9019  9 000170   000003 235007                    LDA     3,DL
         9 000171   200362 755100                    STA     LEN,,AUTO
         9 000172   000515 710000 9                  TRA     s:9128

      551     9020    5                       CASE(%MSU);

      552     9021    5                          TEXT = 'MSU';

   9021  9 000173   040100 100400                    MLR     fill='040'O
         9 000174   001043 000003 8                  ADSC9   SORT_SUPPRESS+6          cn=0,n=3
         9 000175   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      553     9022    5                          COMP_CODE = %PERIPH;

   9022  9 000176   000004 235007                    LDA     4,DL
         9 000177   200361 755100                    STA     COMP_CODE,,AUTO

      554     9023    5                          LEN = 3;

   9023  9 000200   000003 235007                    LDA     3,DL
         9 000201   200362 755100                    STA     LEN,,AUTO
         9 000202   000515 710000 9                  TRA     s:9128

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:94   
      555     9024    5                       CASE(%CRU);

      556     9025    5                          TEXT = 'CRU';

   9025  9 000203   040100 100400                    MLR     fill='040'O
         9 000204   001044 000003 8                  ADSC9   SORT_SUPPRESS+7          cn=0,n=3
         9 000205   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      557     9026    5                          COMP_CODE = %PERIPH;

   9026  9 000206   000004 235007                    LDA     4,DL
         9 000207   200361 755100                    STA     COMP_CODE,,AUTO

      558     9027    5                          LEN = 3;

   9027  9 000210   000003 235007                    LDA     3,DL
         9 000211   200362 755100                    STA     LEN,,AUTO
         9 000212   000515 710000 9                  TRA     s:9128

      559     9028    5                       CASE(%PCU);

      560     9029    5                          TEXT = 'PCU';

   9029  9 000213   040100 100400                    MLR     fill='040'O
         9 000214   001045 000003 8                  ADSC9   SORT_SUPPRESS+8          cn=0,n=3
         9 000215   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      561     9030    5                          COMP_CODE = %PERIPH;

   9030  9 000216   000004 235007                    LDA     4,DL
         9 000217   200361 755100                    STA     COMP_CODE,,AUTO

      562     9031    5                          LEN = 3;

   9031  9 000220   000003 235007                    LDA     3,DL
         9 000221   200362 755100                    STA     LEN,,AUTO
         9 000222   000515 710000 9                  TRA     s:9128
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:95   

      563     9032    5                       CASE(%PRU);

      564     9033    5                          TEXT = 'PRU';

   9033  9 000223   040100 100400                    MLR     fill='040'O
         9 000224   001046 000003 8                  ADSC9   SORT_SUPPRESS+9          cn=0,n=3
         9 000225   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      565     9034    5                          COMP_CODE = %PERIPH;

   9034  9 000226   000004 235007                    LDA     4,DL
         9 000227   200361 755100                    STA     COMP_CODE,,AUTO

      566     9035    5                          LEN = 3;

   9035  9 000230   000003 235007                    LDA     3,DL
         9 000231   200362 755100                    STA     LEN,,AUTO
         9 000232   000515 710000 9                  TRA     s:9128

      567     9036    5                       CASE(%MPC1);

      568     9037    5                          TEXT = 'MPC';

   9037  9 000233   040100 100400                    MLR     fill='040'O
         9 000234   001047 000003 8                  ADSC9   SORT_SUPPRESS+10         cn=0,n=3
         9 000235   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      569     9038    5                          COMP_CODE = %MPC;

   9038  9 000236   000005 235007                    LDA     5,DL
         9 000237   200361 755100                    STA     COMP_CODE,,AUTO

      570     9039    5                          LEN = 3;

   9039  9 000240   000003 235007                    LDA     3,DL
         9 000241   200362 755100                    STA     LEN,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:96   
         9 000242   000515 710000 9                  TRA     s:9128

      571     9040    5                       CASE(%CONSOLE);

      572     9041    5                          TEXT = 'CONSOLE';

   9041  9 000243   040100 100400                    MLR     fill='040'O
         9 000244   001050 000007 8                  ADSC9   SORT_SUPPRESS+11         cn=0,n=7
         9 000245   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      573     9042    5                          LEN = 7;

   9042  9 000246   000007 235007                    LDA     7,DL
         9 000247   200362 755100                    STA     LEN,,AUTO
         9 000250   000515 710000 9                  TRA     s:9128

      574     9043    5                       CASE(%MEM);

      575     9044    5                          TEXT = 'MEM';

   9044  9 000251   040100 100400                    MLR     fill='040'O
         9 000252   001052 000003 8                  ADSC9   SORT_SUPPRESS+13         cn=0,n=3
         9 000253   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      576     9045    5                          LEN = 3;

   9045  9 000254   000003 235007                    LDA     3,DL
         9 000255   200362 755100                    STA     LEN,,AUTO
         9 000256   000515 710000 9                  TRA     s:9128

      577     9046    5                       CASE(%MC);

      578     9047    5                          TEXT = 'MC';

   9047  9 000257   040100 100400                    MLR     fill='040'O
         9 000260   001053 000002 8                  ADSC9   SORT_SUPPRESS+14         cn=0,n=2
         9 000261   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:97   

      579     9048    5                          COMP_CODE = %PERIPH;

   9048  9 000262   000004 235007                    LDA     4,DL
         9 000263   200361 755100                    STA     COMP_CODE,,AUTO
         9 000264   000515 710000 9                  TRA     s:9128

      580     9049    5                       CASE(%MT);

      581     9050    5                          TEXT = 'MT';

   9050  9 000265   040100 100400                    MLR     fill='040'O
         9 000266   001042 000002 8                  ADSC9   SORT_SUPPRESS+5          cn=0,n=2
         9 000267   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      582     9051    5                          COMP_CODE = %PERIPH;

   9051  9 000270   000004 235007                    LDA     4,DL
         9 000271   200361 755100                    STA     COMP_CODE,,AUTO
         9 000272   000515 710000 9                  TRA     s:9128

      583     9052    5                       CASE(%SC);

      584     9053    5                          TEXT = 'SC';

   9053  9 000273   040100 100400                    MLR     fill='040'O
         9 000274   001054 000002 8                  ADSC9   SORT_SUPPRESS+15         cn=0,n=2
         9 000275   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      585     9054    5                          COMP_CODE = %PERIPH;

   9054  9 000276   000004 235007                    LDA     4,DL
         9 000277   200361 755100                    STA     COMP_CODE,,AUTO
         9 000300   000515 710000 9                  TRA     s:9128

      586     9055    5                       CASE(%DP);

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:98   
      587     9056    5                          TEXT = 'DP';

   9056  9 000301   040100 100400                    MLR     fill='040'O
         9 000302   001055 000002 8                  ADSC9   SORT_SUPPRESS+16         cn=0,n=2
         9 000303   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      588     9057    5                          COMP_CODE = %PERIPH;

   9057  9 000304   000004 235007                    LDA     4,DL
         9 000305   200361 755100                    STA     COMP_CODE,,AUTO
         9 000306   000515 710000 9                  TRA     s:9128

      589     9058    5                       CASE(%CR);

      590     9059    5                          TEXT = 'CR';

   9059  9 000307   040100 100400                    MLR     fill='040'O
         9 000310   001044 000002 8                  ADSC9   SORT_SUPPRESS+7          cn=0,n=2
         9 000311   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      591     9060    5                          COMP_CODE = %PERIPH;

   9060  9 000312   000004 235007                    LDA     4,DL
         9 000313   200361 755100                    STA     COMP_CODE,,AUTO
         9 000314   000515 710000 9                  TRA     s:9128

      592     9061    5                       CASE(%CP);

      593     9062    5                          TEXT = 'CP';

   9062  9 000315   040100 100400                    MLR     fill='040'O
         9 000316   001056 000002 8                  ADSC9   SORT_SUPPRESS+17         cn=0,n=2
         9 000317   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      594     9063    5                          COMP_CODE = %PERIPH;

   9063  9 000320   000004 235007                    LDA     4,DL
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:99   
         9 000321   200361 755100                    STA     COMP_CODE,,AUTO
         9 000322   000515 710000 9                  TRA     s:9128

      595     9064    5                       CASE(%LP);

      596     9065    5                          TEXT = 'LP';

   9065  9 000323   040100 100400                    MLR     fill='040'O
         9 000324   001057 000002 8                  ADSC9   SORT_SUPPRESS+18         cn=0,n=2
         9 000325   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      597     9066    5                          COMP_CODE = %PERIPH;

   9066  9 000326   000004 235007                    LDA     4,DL
         9 000327   200361 755100                    STA     COMP_CODE,,AUTO
         9 000330   000515 710000 9                  TRA     s:9128

      598     9067    5                       CASE(%AP);

      599     9068    5                          TEXT = 'AP';

   9068  9 000331   040100 100400                    MLR     fill='040'O
         9 000332   001060 000002 8                  ADSC9   SORT_SUPPRESS+19         cn=0,n=2
         9 000333   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      600     9069    5                          COMP_CODE = %PERIPH;

   9069  9 000334   000004 235007                    LDA     4,DL
         9 000335   200361 755100                    STA     COMP_CODE,,AUTO
         9 000336   000515 710000 9                  TRA     s:9128

      601     9070    5                       CASE(%OD);

      602     9071    5                          TEXT = 'OD';

   9071  9 000337   040100 100400                    MLR     fill='040'O
         9 000340   001061 000002 8                  ADSC9   SORT_SUPPRESS+20         cn=0,n=2
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:100  
         9 000341   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      603     9072    5                          COMP_CODE = %PERIPH;

   9072  9 000342   000004 235007                    LDA     4,DL
         9 000343   200361 755100                    STA     COMP_CODE,,AUTO
         9 000344   000515 710000 9                  TRA     s:9128

      604     9073    5                       CASE(%AC);

      605     9074    5                          TEXT = 'AC';

   9074  9 000345   040100 100400                    MLR     fill='040'O
         9 000346   001062 000002 8                  ADSC9   SORT_SUPPRESS+21         cn=0,n=2
         9 000347   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      606     9075    5                          COMP_CODE = %MPC;

   9075  9 000350   000005 235007                    LDA     5,DL
         9 000351   200361 755100                    STA     COMP_CODE,,AUTO
         9 000352   000515 710000 9                  TRA     s:9128

      607     9076    5                       CASE(%OPC);

      608     9077    5                          TEXT = 'OPTC';

   9077  9 000353   001063 235000 8                  LDA     SORT_SUPPRESS+22
         9 000354   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 000355   200356 757100                    STAQ    TEXT,,AUTO

      609     9078    5                          COMP_CODE = %MPC;

   9078  9 000356   000005 235007                    LDA     5,DL
         9 000357   200361 755100                    STA     COMP_CODE,,AUTO

      610     9079    5                          LEN = 4;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:101  
   9079  9 000360   000004 235007                    LDA     4,DL
         9 000361   200362 755100                    STA     LEN,,AUTO
         9 000362   000515 710000 9                  TRA     s:9128

      611     9080    5                       CASE(%UC);

      612     9081    5                          TEXT = 'UC';

   9081  9 000363   040100 100400                    MLR     fill='040'O
         9 000364   001064 000002 8                  ADSC9   SORT_SUPPRESS+23         cn=0,n=2
         9 000365   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      613     9082    5                          COMP_CODE = %MPC;

   9082  9 000366   000005 235007                    LDA     5,DL
         9 000367   200361 755100                    STA     COMP_CODE,,AUTO
         9 000370   000515 710000 9                  TRA     s:9128

      614     9083    5                       CASE(%DC);

      615     9084    5                          TEXT = 'DC';

   9084  9 000371   040100 100400                    MLR     fill='040'O
         9 000372   001065 000002 8                  ADSC9   SORT_SUPPRESS+24         cn=0,n=2
         9 000373   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      616     9085    5                          COMP_CODE = %MPC;

   9085  9 000374   000005 235007                    LDA     5,DL
         9 000375   200361 755100                    STA     COMP_CODE,,AUTO
         9 000376   000515 710000 9                  TRA     s:9128

      617     9086    5                       CASE(%TC);

      618     9087    5                          TEXT = 'TC';

   9087  9 000377   040100 100400                    MLR     fill='040'O
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:102  
         9 000400   001066 000002 8                  ADSC9   SORT_SUPPRESS+25         cn=0,n=2
         9 000401   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      619     9088    5                          COMP_CODE = %MPC;

   9088  9 000402   000005 235007                    LDA     5,DL
         9 000403   200361 755100                    STA     COMP_CODE,,AUTO
         9 000404   000515 710000 9                  TRA     s:9128

      620     9089    5                       CASE(%FEP);

      621     9090    5                          TEXT = 'FEP';

   9090  9 000405   040100 100400                    MLR     fill='040'O
         9 000406   001067 000003 8                  ADSC9   SORT_SUPPRESS+26         cn=0,n=3
         9 000407   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      622     9091    5                          LEN = 3;

   9091  9 000410   000003 235007                    LDA     3,DL
         9 000411   200362 755100                    STA     LEN,,AUTO
         9 000412   000515 710000 9                  TRA     s:9128

      623     9092    5                       CASE(%IOM);

      624     9093    5                          TEXT = 'IOM';

   9093  9 000413   040100 100400                    MLR     fill='040'O
         9 000414   001070 000003 8                  ADSC9   SORT_SUPPRESS+27         cn=0,n=3
         9 000415   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      625     9094    5                          LEN = 3;

   9094  9 000416   000003 235007                    LDA     3,DL
         9 000417   200362 755100                    STA     LEN,,AUTO
         9 000420   000515 710000 9                  TRA     s:9128

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:103  
      626     9095    5                       CASE(%ALL);

      627     9096    5                          COMP_CODE = 0;

   9096  9 000421   200361 450100                    STZ     COMP_CODE,,AUTO

      628     9097    5                          TEXT = 'ALL';

   9097  9 000422   040100 100400                    MLR     fill='040'O
         9 000423   001037 000003 8                  ADSC9   SORT_SUPPRESS+2          cn=0,n=3
         9 000424   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      629     9098    5                          LEN = 3;

   9098  9 000425   000003 235007                    LDA     3,DL
         9 000426   200362 755100                    STA     LEN,,AUTO
         9 000427   000515 710000 9                  TRA     s:9128

      630     9099    5                       CASE(%FNP);

      631     9100    5                          TEXT='FEP';

   9100  9 000430   040100 100400                    MLR     fill='040'O
         9 000431   001067 000003 8                  ADSC9   SORT_SUPPRESS+26         cn=0,n=3
         9 000432   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      632     9101    5                          LEN=3;

   9101  9 000433   000003 235007                    LDA     3,DL
         9 000434   200362 755100                    STA     LEN,,AUTO

      633     9102    5                          CODE=%FEP;

   9102  9 000435   200360 755100                    STA     CODE,,AUTO
         9 000436   000515 710000 9                  TRA     s:9128

      634     9103    5                       CASE(%TAPE);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:104  

      635     9104    5                          TEXT='MT';

   9104  9 000437   040100 100400                    MLR     fill='040'O
         9 000440   001042 000002 8                  ADSC9   SORT_SUPPRESS+5          cn=0,n=2
         9 000441   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      636     9105    5                          CODE=%MT;

   9105  9 000442   000004 235007                    LDA     4,DL
         9 000443   200360 755100                    STA     CODE,,AUTO

      637     9106    5                          COMP_CODE=%PERIPH;

   9106  9 000444   200361 755100                    STA     COMP_CODE,,AUTO
         9 000445   000515 710000 9                  TRA     s:9128

      638     9107    5                       CASE(%DISK);

      639     9108    5                          TEXT='DP';

   9108  9 000446   040100 100400                    MLR     fill='040'O
         9 000447   001055 000002 8                  ADSC9   SORT_SUPPRESS+16         cn=0,n=2
         9 000450   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      640     9109    5                          COMP_CODE=%PERIPH;

   9109  9 000451   000004 235007                    LDA     4,DL
         9 000452   200361 755100                    STA     COMP_CODE,,AUTO

      641     9110    5                          CODE=%DP;

   9110  9 000453   000006 235007                    LDA     6,DL
         9 000454   200360 755100                    STA     CODE,,AUTO
         9 000455   000515 710000 9                  TRA     s:9128

      642     9111    5                       CASE(%READER);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:105  

      643     9112    5                          TEXT='CR';

   9112  9 000456   040100 100400                    MLR     fill='040'O
         9 000457   001044 000002 8                  ADSC9   SORT_SUPPRESS+7          cn=0,n=2
         9 000460   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      644     9113    5                          COMP_CODE=%PERIPH;

   9113  9 000461   000004 235007                    LDA     4,DL
         9 000462   200361 755100                    STA     COMP_CODE,,AUTO

      645     9114    5                          CODE=%CR;

   9114  9 000463   000007 235007                    LDA     7,DL
         9 000464   200360 755100                    STA     CODE,,AUTO
         9 000465   000515 710000 9                  TRA     s:9128

      646     9115    5                       CASE(%PUNCH);

      647     9116    5                          TEXT='CP';

   9116  9 000466   040100 100400                    MLR     fill='040'O
         9 000467   001056 000002 8                  ADSC9   SORT_SUPPRESS+17         cn=0,n=2
         9 000470   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      648     9117    5                          COMP_CODE=%PERIPH;

   9117  9 000471   000004 235007                    LDA     4,DL
         9 000472   200361 755100                    STA     COMP_CODE,,AUTO

      649     9118    5                          CODE=%CP;

   9118  9 000473   000010 235007                    LDA     8,DL
         9 000474   200360 755100                    STA     CODE,,AUTO
         9 000475   000515 710000 9                  TRA     s:9128

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:106  
      650     9119    5                       CASE(%PRINTER);

      651     9120    5                          TEXT='LP';

   9120  9 000476   040100 100400                    MLR     fill='040'O
         9 000477   001057 000002 8                  ADSC9   SORT_SUPPRESS+18         cn=0,n=2
         9 000500   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      652     9121    5                          COMP_CODE=%PERIPH;

   9121  9 000501   000004 235007                    LDA     4,DL
         9 000502   200361 755100                    STA     COMP_CODE,,AUTO

      653     9122    5                          CODE=%LP;

   9122  9 000503   000011 235007                    LDA     9,DL
         9 000504   200360 755100                    STA     CODE,,AUTO
         9 000505   000515 710000 9                  TRA     s:9128

      654     9123    5                       CASE(%URC);

      655     9124    5                          TEXT='UC';

   9124  9 000506   040100 100400                    MLR     fill='040'O
         9 000507   001064 000002 8                  ADSC9   SORT_SUPPRESS+23         cn=0,n=2
         9 000510   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      656     9125    5                          COMP_CODE=%MPC;

   9125  9 000511   000005 235007                    LDA     5,DL
         9 000512   200361 755100                    STA     COMP_CODE,,AUTO

      657     9126    5                          CODE=%UC;

   9126  9 000513   000013 235007                    LDA     11,DL
         9 000514   200360 755100                    STA     CODE,,AUTO

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:107  
      658     9127    5                    END;                      /* DO CASE CODE                       */

      659     9128    4                    IF OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.NSUBLKS = 2

   9128  9 000515   000000 471500                    LDP1    0,,PR0
         9 000516   100003 473510                    LDP3    3,X0,PR1
         9 000517   300003 474511                    LDP4    3,X1,PR3
         9 000520   400001 222100                    LDX2    1,,PR4
         9 000521   000002 102003                    CMPX2   2,DU
         9 000522   000544 601000 9                  TNZ     s:9138

      660     9129    4                       THEN
      661     9130    5                       DO;

      662     9131    5                         SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(1
              9131                                   );

   9131  9 000523   400004 236100                    LDQ     4,,PR4
         9 000524   200355 756100                    STQ     SYM$,,AUTO

      663     9132    5                          CALL INSERT(TEXT,LEN,OUT$SYM.COUNT,OUT$SYM.TEXT);

   9132  9 000525   200355 475500                    LDP5    SYM$,,AUTO
         9 000526   500004 236100                    LDQ     4,,PR5
         9 000527   000033 772000                    QRL     27
         9 000530   000000 623006                    EAX3    0,QL
         9 000531   000000 624006                    EAX4    0,QL
         9 000532   200362 235100                    LDA     LEN,,AUTO
         9 000533   040145 100540                    MLR     fill='040'O
         9 000534   500004 200013                    ADSC9   4,,PR5                   cn=1,n=*X3
         9 000535   200356 000014                    ADSC9   TEXT,A,AUTO              cn=0,n=*X4

      664     9133    5                          LEN = LEN + OUT$SYM.COUNT;

   9133  9 000536   500004 236100                    LDQ     4,,PR5
         9 000537   000033 772000                    QRL     27
         9 000540   200362 036100                    ADLQ    LEN,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:108  
         9 000541   200362 756100                    STQ     LEN,,AUTO

      665     9134    5                          TEXT_LEN = LEN;

   9134  9 000542   000414 756000 7                  STQ     TEXT_LEN

      666     9135    5                       END;

   9135  9 000543   000547 710000 9                  TRA     s:9141

      667     9136    4                       ELSE
      668     9137    5                       DO;

      669     9138    5                          TEXT_LEN = LEN;

   9138  9 000544   200362 235100                    LDA     LEN,,AUTO
         9 000545   000414 755000 7                  STA     TEXT_LEN

      670     9139    5                          LEN = 0;

   9139  9 000546   200362 450100                    STZ     LEN,,AUTO

      671     9140    5                       END;

      672     9141    4                    CALL THS$SET_DEVS(CODE,TEXT,LEN) ALTRET(NO_REPORT);

   9141  9 000547   200362 631500                    EPPR1   LEN,,AUTO
         9 000550   203012 451500                    STP1    EOF_FLAG+5,,AUTO
         9 000551   200356 633500                    EPPR3   TEXT,,AUTO
         9 000552   203011 453500                    STP3    EOF_FLAG+4,,AUTO
         9 000553   200360 634500                    EPPR4   CODE,,AUTO
         9 000554   203010 454500                    STP4    EOF_FLAG+3,,AUTO
         9 000555   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 000556   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000557   000000 701000 xent               TSX1    THS$SET_DEVS
         9 000560   003175 702000 9                  TSX2    NO_REPORT

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:109  
      673     9142    5                    IF BUF_INDX > 0 THEN DO;

   9142  9 000561   000415 235000 7                  LDA     BUF_INDX
         9 000562   000571 600000 9                  TZE     s:9146

      674     9143    5                       CALL INSERT(TEMP_BUF,BUF_INDX,1,',');

   9143  9 000563   040005 100400                    MLR     fill='040'O
         9 000564   000001 000001 10                 ADSC9   1                        cn=0,n=1
         9 000565   000343 000001 7                  ADSC9   TEMP_BUF,A               cn=0,n=1

      675     9144    5                       BUF_INDX = BUF_INDX + 1;

   9144  9 000566   000415 235000 7                  LDA     BUF_INDX
         9 000567   000001 035007                    ADLA    1,DL
         9 000570   000415 755000 7                  STA     BUF_INDX

      676     9145    5                       END;  /* IF BUF_INDX > 0 */

      677     9146    4                    CALL INSERT(TEMP_BUF,BUF_INDX,TEXT_LEN,TEXT);

   9146  9 000571   000414 720000 7                  LXL0    TEXT_LEN
         9 000572   040045 100500                    MLR     fill='040'O
         9 000573   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         9 000574   000343 000010 7                  ADSC9   TEMP_BUF,A               cn=0,n=*X0

      678     9147    4                    BUF_INDX = BUF_INDX + TEXT_LEN;

   9147  9 000575   000415 236000 7                  LDQ     BUF_INDX
         9 000576   000414 036000 7                  ADLQ    TEXT_LEN
         9 000577   000415 756000 7                  STQ     BUF_INDX

      679     9148    4                    END;  /* DO J */

   9148  9 000600   200364 235100                    LDA     J,,AUTO
         9 000601   000001 035007                    ADLA    1,DL
         9 000602   200364 755100                    STA     J,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:110  
         9 000603   200003 470500                    LDP0    @TOP$,,AUTO
         9 000604   000000 471500                    LDP1    0,,PR0
         9 000605   200363 720100                    LXL0    I,,AUTO
         9 000606   100003 473510                    LDP3    3,X0,PR1
         9 000607   300001 236100                    LDQ     1,,PR3
         9 000610   000022 772000                    QRL     18
         9 000611   200364 116100                    CMPQ    J,,AUTO
         9 000612   000614 600000 9                  TZE     s:9149
         9 000613   000076 603000 9                  TRC     s:9011

      680     9149    3                 FOR_CLAUSE_FLG = %TRUE;

   9149  9 000614   400000 236003                    LDQ     -131072,DU
         9 000615   200367 756100                    STQ     FOR_CLAUSE_FLG,,AUTO
         9 000616   000655 710000 9                  TRA     s:9159

      681     9150    3              CASE(%ON_CLAUSE);

      682     9151    3                 SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1);

   9151  9 000617   300004 236100                    LDQ     4,,PR3
         9 000620   200355 756100                    STQ     SYM$,,AUTO

      683     9152    3                 FPT_FID.TEXTFID_ = VECTOR(OUT$SYM.TEXT);

   9152  9 000621   200355 474500                    LDP4    SYM$,,AUTO
         9 000622   400004 236100                    LDQ     4,,PR4
         9 000623   000033 772000                    QRL     27
         9 000624   000064 737000                    LLS     52
         9 000625   000140 135007                    SBLA    96,DL
         9 000626   200355 236100                    LDQ     SYM$,,AUTO
         9 000627   000002 036000 10                 ADLQ    2
         9 000630   001134 757000 7                  STAQ    FPT_FID+2

      684     9153    3                 CALL M$FID(FPT_FID) ALTRET(FID_ERR);

   9153  9 000631   001132 630400 7                  EPPR0   FPT_FID
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:111  
         9 000632   420001 713400                    CLIMB   alt,+8193
         9 000633   404400 401760                    pmme    nvectors=10
         9 000634   003176 702000 9                  TSX2    FID_ERR

      685     9154
      686     9155    3                 SET_ONFILE.V.EXIST# = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.
              9155                          CODE;

   9155  9 000635   200003 470500                    LDP0    @TOP$,,AUTO
         9 000636   000000 471500                    LDP1    0,,PR0
         9 000637   200363 720100                    LXL0    I,,AUTO
         9 000640   100003 473510                    LDP3    3,X0,PR1
         9 000641   300003 474500                    LDP4    3,,PR3
         9 000642   400000 236100                    LDQ     0,,PR4
         9 000643   000007 736000                    QLS     7
         9 000644   001104 676000 7                  ERQ     SET_ONFILE+36
         9 000645   000600 376007                    ANQ     384,DL
         9 000646   001104 656000 7                  ERSQ    SET_ONFILE+36

      687     9156    3                 ONFILE_SPECIFIED = %TRUE;

   9156  9 000647   400000 236003                    LDQ     -131072,DU
         9 000650   000000 756000 7                  STQ     ONFILE_SPECIFIED

      688     9157    3                 CALL M$OPEN( SET_ONFILE) ALTRET(OPN_ERR);

   9157  9 000651   001040 630400 7                  EPPR0   SET_ONFILE
         9 000652   450000 713400                    CLIMB   alt,open
         9 000653   410400 401760                    pmme    nvectors=18
         9 000654   003166 702000 9                  TSX2    OPN_ERR

      689     9158    3           END;                            /* CASE                               */

      690     9159    2        END;                               /* DO I                               */

   9159  9 000655   200363 235100                    LDA     I,,AUTO
         9 000656   000001 035007                    ADLA    1,DL
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:112  
         9 000657   200363 755100                    STA     I,,AUTO
         9 000660   200003 470500                    LDP0    @TOP$,,AUTO
         9 000661   000000 471500                    LDP1    0,,PR0
         9 000662   100001 236100                    LDQ     1,,PR1
         9 000663   000022 772000                    QRL     18
         9 000664   200363 116100                    CMPQ    I,,AUTO
         9 000665   000667 600000 9                  TZE     s:9160
         9 000666   000055 603000 9                  TRC     s:9006

      691     9160    1     IF FOR_CLAUSE_FLG

   9160  9 000667   200367 234100                    SZN     FOR_CLAUSE_FLG,,AUTO
         9 000670   000706 604000 9                  TMI     s:9166

      692     9161    1        THEN ;
      693     9162    2        ELSE DO;

      694     9163    2           TEXT = 'ALL';

   9163  9 000671   040100 100400                    MLR     fill='040'O
         9 000672   001037 000003 8                  ADSC9   SORT_SUPPRESS+2          cn=0,n=3
         9 000673   200356 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

      695     9164    2           CALL THS$SET_DEVS(CODE,TEXT,LEN) ALTRET(NO_REPORT);

   9164  9 000674   200362 631500                    EPPR1   LEN,,AUTO
         9 000675   203012 451500                    STP1    EOF_FLAG+5,,AUTO
         9 000676   200356 633500                    EPPR3   TEXT,,AUTO
         9 000677   203011 453500                    STP3    EOF_FLAG+4,,AUTO
         9 000700   200360 634500                    EPPR4   CODE,,AUTO
         9 000701   203010 454500                    STP4    EOF_FLAG+3,,AUTO
         9 000702   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 000703   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000704   000000 701000 xent               TSX1    THS$SET_DEVS
         9 000705   003175 702000 9                  TSX2    NO_REPORT

      696     9165    2           END;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:113  

      697     9166    1        TEXT$ = ADDR(TEXTBUF);

   9166  9 000706   000003 236000 10                 LDQ     3
         9 000707   200006 756100                    STQ     TEXT$,,AUTO

      698     9167    1        CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF,BUF_INDX);

   9167  9 000710   000004 236000 10                 LDQ     4
         9 000711   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 000712   000005 236000 10                 LDQ     5
         9 000713   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 000714   200006 630500                    EPPR0   TEXT$,,AUTO
         9 000715   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 000716   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 000717   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000720   000000 701000 xent               TSX1    THF$ADD_TEXTC
         9 000721   000000 011000                    NOP     0

      699     9168    1        TVEC = VECTOR(TEXTBUF);

   9168  9 000722   000006 237000 10                 LDAQ    6
         9 000723   200010 757100                    STAQ    TVEC,,AUTO

      700     9169    1        TVEC.BOUND = BUF_INDX;

   9169  9 000724   000415 236000 7                  LDQ     BUF_INDX
         9 000725   000020 736000                    QLS     16
         9 000726   200010 676100                    ERQ     TVEC,,AUTO
         9 000727   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 000730   200010 656100                    ERSQ    TVEC,,AUTO

      701     9170    1        CALL THW$WRITE(HDR_TBL(REPORT_CODE),

   9170  9 000731   200010 630500                    EPPR0   TVEC,,AUTO
         9 000732   203015 450500                    STP0    EOF_FLAG+8,,AUTO
         9 000733   000020 236000 10                 LDQ     16
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:114  
         9 000734   203014 756100                    STQ     EOF_FLAG+7,,AUTO
         9 000735   000022 237000 10                 LDAQ    18
         9 000736   203012 757100                    STAQ    EOF_FLAG+5,,AUTO
         9 000737   000024 236000 10                 LDQ     20
         9 000740   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 000741   203004 236100                    LDQ     REPORT_CODE,,AUTO
         9 000742   000023 736000                    QLS     19
         9 000743   000025 036000 10                 ADLQ    21
         9 000744   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 000745   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 000746   000024 631400 xsym               EPPR1   B_VECTNIL+20
         9 000747   000000 701000 xent               TSX1    THW$WRITE
         9 000750   000000 011000                    NOP     0

      702     9171    1                       VECTOR(TH_SITE_ID),
      703     9172    1                       VECTOR(TH_SITE_NAME),
      704     9173    1                       VECTOR(TH_CONSTRAINTS.START),
      705     9174    1                       VECTOR(TH_CONSTRAINTS.STOP),
      706     9175    1                       TVEC);
      707     9176    1     IF ONFILE_SPECIFIED

   9176  9 000751   000000 234000 7                  SZN     ONFILE_SPECIFIED
         9 000752   001002 605000 9                  TPL     s:9186

      708     9177    1      THEN
      709     9178    2       DO;

      710     9179    2         TH_OUTBUF=SUBSTR(TH_OUTBUF,1);

   9179  9 000753   040000 100400                    MLR     fill='040'O
         9 000754   000000 200143 xsym               ADSC9   TH_OUTBUF                cn=1,n=99
         9 000755   000000 000144 xsym               ADSC9   TH_OUTBUF                cn=0,n=100

      711     9180    2         CALL INSERT(LO_HEADER.TITL.TITLE#,0,100,TH_OUTBUF);

   9180  9 000756   040000 100400                    MLR     fill='040'O
         9 000757   000000 000144 xsym               ADSC9   TH_OUTBUF                cn=0,n=100
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:115  
         9 000760   001613 200144 7                  ADSC9   LO_HEADER+1              cn=1,n=100

      712     9181    2         CALL INSERT(LO_HEADER.TITL.TITLE#,101, ,'PAGE');

   9181  9 000761   040000 100400                    MLR     fill='040'O
         9 000762   001071 000004 8                  ADSC9   SORT_SUPPRESS+28         cn=0,n=4
         9 000763   001644 400005 7                  ADSC9   LO_HEADER+26             cn=2,n=5

      713     9182    2         LO_HEADER.TITL.L# = LENGTHC(LO_HEADER.TITL.TITLE#);

   9182  9 000764   152000 236003                    LDQ     54272,DU
         9 000765   001613 552040 7                  STBQ    LO_HEADER+1,'40'O

      714     9183    2         IF DCBADDR(DCBNUM(M$LO))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_LO);

   9183  9 000766   000000 236007 xsym               LDQ     M$LO,DL
         9 000767   000000 470400 10                 LDP0    0
         9 000770   000000 471500                    LDP1    0,,PR0
         9 000771   100000 473506                    LDP3    0,QL,PR1
         9 000772   300031 236100                    LDQ     25,,PR3
         9 000773   020000 316007                    CANQ    8192,DL
         9 000774   001000 600000 9                  TZE     s:9184

   9183  9 000775   000756 630400 8                  EPPR0   CLOSE_LO
         9 000776   050001 713400                    CLIMB   close
         9 000777   406000 401760                    pmme    nvectors=13

      715     9184    2         OUTPUT_DCB# = DCBNUM(M$ONFILE);

   9184  9 001000   000000 236007 xsym               LDQ     M$ONFILE,DL
         9 001001   000001 756000 7                  STQ     OUTPUT_DCB#

      716     9185    2       END;

      717     9186    1        TH_SAVE = TH_CONSTRAINTS;

   9186  9 001002   000000 100400                    MLR     fill='000'O
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:116  
         9 001003   000000 000333 xsym               ADSC9   TH_CONSTRAINTS           cn=0,n=219
         9 001004   000000 000333 xsym               ADSC9   TH_SAVE                  cn=0,n=219

      718     9187    2        DO CASE(REPORT_CODE);

   9187  9 001005   203004 235100                    LDA     REPORT_CODE,,AUTO
         9 001006   000022 115007                    CMPA    18,DL
         9 001007   001011 602005 9                  TNC     s:9187+4,AL
         9 001010   003127 710000 9                  TRA     s:9546
         9 001011   003127 710000 9                  TRA     s:9546
         9 001012   001033 710000 9                  TRA     s:9189
         9 001013   001040 710000 9                  TRA     s:9192
         9 001014   003127 710000 9                  TRA     s:9546
         9 001015   001050 710000 9                  TRA     s:9197
         9 001016   003127 710000 9                  TRA     s:9546
         9 001017   003127 710000 9                  TRA     s:9546
         9 001020   003127 710000 9                  TRA     s:9546
         9 001021   003127 710000 9                  TRA     s:9546
         9 001022   003127 710000 9                  TRA     s:9546
         9 001023   001107 710000 9                  TRA     s:9218
         9 001024   003127 710000 9                  TRA     s:9546
         9 001025   003127 710000 9                  TRA     s:9546
         9 001026   003116 710000 9                  TRA     s:9540
         9 001027   003123 710000 9                  TRA     s:9543
         9 001030   002106 710000 9                  TRA     s:9398
         9 001031   001107 710000 9                  TRA     s:9218
         9 001032   001107 710000 9                  TRA     s:9218

      719     9188    2           CASE(%AMS);

      720     9189    2            TH_BRKMSG = '0'B;

   9189  9 001033   000000 450000 xsym               STZ     TH_BRKMSG

      721     9190    2              CALL THF$AMS;

   9190  9 001034   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:117  
         9 001035   000000 701000 xent               TSX1    THF$AMS
         9 001036   000000 011000                    NOP     0
         9 001037   003127 710000 9                  TRA     s:9546

      722     9191    2           CASE(%CONFIG);

      723     9192    2            TH_BRKMSG = '0'B;

   9192  9 001040   000000 450000 xsym               STZ     TH_BRKMSG

      724     9193    2              CALL THF$CONFIG(CODE);

   9193  9 001041   200360 630500                    EPPR0   CODE,,AUTO
         9 001042   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 001043   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001045   000000 701000 xent               TSX1    THF$CONFIG
         9 001046   000000 011000                    NOP     0
         9 001047   003127 710000 9                  TRA     s:9546

      725     9194    2           CASE(%HWA);

      726     9195                                                /* HWA PROCEDURE                      */
      727     9196    2           CASE(%HWE);

      728     9197    2          TH_BRKMSG = '1'B;

   9197  9 001050   400000 236003                    LDQ     -131072,DU
         9 001051   000000 756000 xsym               STQ     TH_BRKMSG

      729     9198    2              IF COMP_CODE = %FEP

   9198  9 001052   200361 235100                    LDA     COMP_CODE,,AUTO
         9 001053   000003 115007                    CMPA    3,DL
         9 001054   001062 601000 9                  TNZ     s:9201

      730     9199    2                 THEN CALL THW$WRITE(VECTOR(FEPNOTIMP));
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:118  

   9199  9 001055   000030 630400 10                 EPPR0   24
         9 001056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001057   000000 701000 xent               TSX1    THW$WRITE
         9 001060   000000 011000                    NOP     0
         9 001061   003127 710000 9                  TRA     s:9546

      731     9200    2                 ELSE
      732     9201    2              IF COMP_CODE = %MPC

   9201  9 001062   000005 115007                    CMPA    5,DL
         9 001063   001071 601000 9                  TNZ     s:9204

      733     9202    2                 THEN CALL THW$WRITE(VECTOR(MPCNOTIMP));

   9202  9 001064   000034 630400 10                 EPPR0   28
         9 001065   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001066   000000 701000 xent               TSX1    THW$WRITE
         9 001067   000000 011000                    NOP     0
         9 001070   003127 710000 9                  TRA     s:9546

      734     9203    2                 ELSE
      735     9204    2              IF COMP_CODE = %IOM

   9204  9 001071   000002 115007                    CMPA    2,DL
         9 001072   001100 601000 9                  TNZ     s:9206

      736     9205    2                 THEN CALL THW$WRITE(VECTOR(IOMNOTIMP));

   9205  9 001073   000040 630400 10                 EPPR0   32
         9 001074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001075   000000 701000 xent               TSX1    THW$WRITE
         9 001076   000000 011000                    NOP     0
         9 001077   003127 710000 9                  TRA     s:9546

      737     9206    2                 ELSE CALL THF$HWE(COMP_CODE);

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:119  
   9206  9 001100   200361 630500                    EPPR0   COMP_CODE,,AUTO
         9 001101   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 001102   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001104   000000 701000 xent               TSX1    THF$HWE
         9 001105   000000 011000                    NOP     0
         9 001106   003127 710000 9                  TRA     s:9546

      738     9207    2           CASE(%IMS);

      739     9208                                                /* IMS CODE                           */
      740     9209    2           CASE(%KEYIN);

      741     9210                                                /* KEYIN CODE                         */
      742     9211    2           CASE(%MPR);

      743     9212                                                /* MPR CODE                           */
      744     9213    2           CASE(%PPR);

      745     9214                                                /* PPR CODE                           */
      746     9215    2           CASE(%RAS);

      747     9216                                                /* RAS CODE                           */
      748     9217    2           CASE(%RAW,%DETAIL,%EXTENDED);

      749     9218    2            TH_IOERR_FLG = %FALSE;

   9218  9 001107   000000 450000 xsym               STZ     TH_IOERR_FLG

      750     9219    2            TH_FEPERR_FLG = %FALSE;

   9219  9 001110   000000 450000 xsym               STZ     TH_FEPERR_FLG

      751     9220    2            TH_RAW_FLG = %FALSE;

   9220  9 001111   000000 450000 xsym               STZ     TH_RAW_FLG

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:120  
      752     9221    2          TH_BRKMSG = '1'B;

   9221  9 001112   400000 236003                    LDQ     -131072,DU
         9 001113   000000 756000 xsym               STQ     TH_BRKMSG

      753     9222    3              IF TH_CONSTRAINTS.NTYPES > 0 THEN DO;

   9222  9 001114   000000 235000 xsym               LDA     TH_CONSTRAINTS
         9 001115   001223 604400 9                  TMOZ    s:9241

      754     9223    3                 TEXT$ = ADDR(TEXTBUF);

   9223  9 001116   000003 236000 10                 LDQ     3
         9 001117   200006 756100                    STQ     TEXT$,,AUTO

      755     9224    3                 BUF_COUNT = 0;

   9224  9 001120   200353 450100                    STZ     BUF_COUNT,,AUTO

      756     9225    4                 DO I = 0 TO TH_CONSTRAINTS.NTYPES - 1;

   9225  9 001121   200363 450100                    STZ     I,,AUTO
         9 001122   001163 710000 9                  TRA     s:9233+3

      757     9226    5                    IF I > 0 THEN DO;

   9226  9 001123   200363 235100                    LDA     I,,AUTO
         9 001124   001134 600000 9                  TZE     s:9230

      758     9227    5                       CALL INSERT(TEMP_BUF2,BUF_COUNT,2,', ');

   9227  9 001125   200353 236100                    LDQ     BUF_COUNT,,AUTO
         9 001126   040106 100400                    MLR     fill='040'O
         9 001127   001072 000002 8                  ADSC9   SORT_SUPPRESS+29         cn=0,n=2
         9 001130   200012 000002                    ADSC9   TEMP_BUF2,Q,AUTO         cn=0,n=2

      759     9228    5                       BUF_COUNT = BUF_COUNT + 2;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:121  

   9228  9 001131   200353 236100                    LDQ     BUF_COUNT,,AUTO
         9 001132   000002 036007                    ADLQ    2,DL
         9 001133   200353 756100                    STQ     BUF_COUNT,,AUTO

      760     9229    5                       END;  /* IF I > 0 */

      761     9230    4                    CALL THC$TYPENAME(TH_CONSTRAINTS.TYPES(I),TEMP_BUF,COUNT);

   9230  9 001134   203003 630500                    EPPR0   COUNT,,AUTO
         9 001135   203012 450500                    STP0    EOF_FLAG+5,,AUTO
         9 001136   000005 236000 10                 LDQ     5
         9 001137   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 001140   200363 236100                    LDQ     I,,AUTO
         9 001141   000020 736000                    QLS     16
         9 001142   000041 036000 10                 ADLQ    33
         9 001143   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 001144   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001145   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001146   000000 701000 xent               TSX1    THC$TYPENAME
         9 001147   000000 011000                    NOP     0

      762     9231    4                    CALL INSERT(TEMP_BUF2,BUF_COUNT,COUNT,SUBSTR(TEMP_BUF,0,COUNT));

   9231  9 001150   203003 720100                    LXL0    COUNT,,AUTO
         9 001151   200353 235100                    LDA     BUF_COUNT,,AUTO
         9 001152   040145 100440                    MLR     fill='040'O
         9 001153   000343 000010 7                  ADSC9   TEMP_BUF                 cn=0,n=*X0
         9 001154   200012 000010                    ADSC9   TEMP_BUF2,A,AUTO         cn=0,n=*X0

      763     9232    4                    BUF_COUNT = BUF_COUNT + COUNT;

   9232  9 001155   200353 236100                    LDQ     BUF_COUNT,,AUTO
         9 001156   203003 036100                    ADLQ    COUNT,,AUTO
         9 001157   200353 756100                    STQ     BUF_COUNT,,AUTO

      764     9233    4                    END;  /* DO I */
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:122  

   9233  9 001160   200363 235100                    LDA     I,,AUTO
         9 001161   000001 035007                    ADLA    1,DL
         9 001162   200363 755100                    STA     I,,AUTO
         9 001163   200363 236100                    LDQ     I,,AUTO
         9 001164   001167 604000 9                  TMI     s:9234
         9 001165   000000 116000 xsym               CMPQ    TH_CONSTRAINTS
         9 001166   001123 604000 9                  TMI     s:9226

      765     9234    3                 CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF2,BUF_COUNT);

   9234  9 001167   200353 630500                    EPPR0   BUF_COUNT,,AUTO
         9 001170   203012 450500                    STP0    EOF_FLAG+5,,AUTO
         9 001171   200012 631500                    EPPR1   TEMP_BUF2,,AUTO
         9 001172   203011 451500                    STP1    EOF_FLAG+4,,AUTO
         9 001173   200006 633500                    EPPR3   TEXT$,,AUTO
         9 001174   203010 453500                    STP3    EOF_FLAG+3,,AUTO
         9 001175   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001176   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001177   000000 701000 xent               TSX1    THF$ADD_TEXTC
         9 001200   000000 011000                    NOP     0

      766     9235    3                 TVEC = VECTOR(TEXTBUF);

   9235  9 001201   000006 237000 10                 LDAQ    6
         9 001202   200010 757100                    STAQ    TVEC,,AUTO

      767     9236    3                 TVEC.BOUND = BUF_COUNT;

   9236  9 001203   200353 236100                    LDQ     BUF_COUNT,,AUTO
         9 001204   000020 736000                    QLS     16
         9 001205   200010 676100                    ERQ     TVEC,,AUTO
         9 001206   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 001207   200010 656100                    ERSQ    TVEC,,AUTO

      768     9237    3                 IF REPORT_CODE ~= %DETAIL

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:123  
   9237  9 001210   203004 236100                    LDQ     REPORT_CODE,,AUTO
         9 001211   000021 116007                    CMPQ    17,DL
         9 001212   001223 600000 9                  TZE     s:9241

      769     9238    3                 THEN
      770     9239    3                 CALL THW$WRITE(VECTOR(TYPE_FMT),TVEC);

   9239  9 001213   200010 630500                    EPPR0   TVEC,,AUTO
         9 001214   203011 450500                    STP0    EOF_FLAG+4,,AUTO
         9 001215   000044 236000 10                 LDQ     36
         9 001216   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 001217   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001220   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001221   000000 701000 xent               TSX1    THW$WRITE
         9 001222   000000 011000                    NOP     0

      771     9240    3                 END;  /* IF NTYPES > 0 */

      772     9241    2              TH_LAST_REQID = 0;

   9241  9 001223   000000 450000 xsym               STZ     TH_LAST_REQID

      773     9242    2       IF TH_CONSTRAINTS.M_MAJ_S OR TH_CONSTRAINTS.M_SUB_S OR

   9242  9 001224   000014 236000 xsym               LDQ     TH_CONSTRAINTS+12
         9 001225   004000 316003                    CANQ    2048,DU
         9 001226   001244 601000 9                  TNZ     s:9246
         9 001227   000020 316003                    CANQ    16,DU
         9 001230   001244 601000 9                  TNZ     s:9246
         9 001231   000016 234000 xsym               SZN     TH_CONSTRAINTS+14
         9 001232   001244 604000 9                  TMI     s:9246
         9 001233   000000 066400                    CMPB    filb='0'B
         9 001234   000026 010440 xsym               BDSC    TH_CONSTRAINTS+22        by=0,bit=1,n=288
         9 001235   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 001236   001244 601000 9                  TNZ     s:9246
         9 001237   000061 234000 xsym               SZN     TH_CONSTRAINTS+49
         9 001240   001244 604000 9                  TMI     s:9246
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:124  
         9 001241   000062 236000 xsym               LDQ     TH_CONSTRAINTS+50
         9 001242   400000 316007                    CANQ    -131072,DL
         9 001243   001250 600000 9                  TZE     s:9248

      774     9243    2          TH_CONSTRAINTS.M_MED_S OR TH_CONSTRAINTS.M_BY_B_SET ~='0'B
      775     9244    2          OR TH_CONSTRAINTS.M_FEP_SET OR TH_CONSTRAINTS.M_CHAN_SET
      776     9245    3            THEN DO;

      777     9246    3            CALL THW$WRITE(VECTOR(MATCH_FMT),VECTOR(TH_LAST_MATCH));

   9246  9 001244   000052 630400 10                 EPPR0   42
         9 001245   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001246   000000 701000 xent               TSX1    THW$WRITE
         9 001247   000000 011000                    NOP     0

      778     9247    3            END;

      779     9248    2       IF TH_CONSTRAINTS.E_MAJ_S OR TH_CONSTRAINTS.E_SUB_S OR

   9248  9 001250   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         9 001251   002000 316003                    CANQ    1024,DU
         9 001252   001270 601000 9                  TNZ     s:9252
         9 001253   000010 316003                    CANQ    8,DU
         9 001254   001270 601000 9                  TNZ     s:9252
         9 001255   000040 234000 xsym               SZN     TH_CONSTRAINTS+32
         9 001256   001270 604000 9                  TMI     s:9252
         9 001257   000000 066400                    CMPB    filb='0'B
         9 001260   000050 010440 xsym               BDSC    TH_CONSTRAINTS+40        by=0,bit=1,n=288
         9 001261   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 001262   001270 601000 9                  TNZ     s:9252
         9 001263   000063 236000 xsym               LDQ     TH_CONSTRAINTS+51
         9 001264   400000 316007                    CANQ    -131072,DL
         9 001265   001270 601000 9                  TNZ     s:9252
         9 001266   000065 234000 xsym               SZN     TH_CONSTRAINTS+53
         9 001267   001274 605000 9                  TPL     s:9254

      780     9249    2          TH_CONSTRAINTS.E_MED_S OR TH_CONSTRAINTS.E_BY_B_SET ~='0'B
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:125  
      781     9250    2          OR TH_CONSTRAINTS.E_FEP_SET OR TH_CONSTRAINTS.E_CHAN_SET
      782     9251    3            THEN DO;

      783     9252    3            CALL THW$WRITE(VECTOR(EXCLUDE_FMT),VECTOR(TH_LAST_EXCLUDE));

   9252  9 001270   000060 630400 10                 EPPR0   48
         9 001271   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001272   000000 701000 xent               TSX1    THW$WRITE
         9 001273   000000 011000                    NOP     0

      784     9253    3            END;

      785     9254    3            IF REPORT_CODE = %DETAIL THEN DO;/* if detail report is requested*/

   9254  9 001274   203004 235100                    LDA     REPORT_CODE,,AUTO
         9 001275   000021 115007                    CMPA    17,DL
         9 001276   001615 601000 9                  TNZ     s:9339

      786     9255    3            OPEN_ERRLOG2.V.FUN# = %CREATE#;   /* set FPTs to create files */

   9255  9 001277   003000 236007                    LDQ     1536,DL
         9 001300   000517 552010 7                  STBQ    OPEN_ERRLOG2+37,'10'O

      787     9256    3            OPEN_ERRLOG4.V.FUN# = %CREATE#;

   9256  9 001301   001227 552010 7                  STBQ    OPEN_ERRLOG4+37,'10'O

      788     9257    3            OPEN_ERRLOG3.V.FUN# = %CREATE#;

   9257  9 001302   000663 552010 7                  STBQ    OPEN_ERRLOG3+37,'10'O

      789     9258    3            OPEN_ERRLOG5.V.FUN# = %CREATE#;

   9258  9 001303   001373 552010 7                  STBQ    OPEN_ERRLOG5+37,'10'O

      790     9259    3            CLOSE_ERRLOG2.V.DISP# = %SAVE#;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:126  
   9259  9 001304   000002 236007                    LDQ     2,DL
         9 001305   000576 552004 7                  STBQ    CLOSE_ERRLOG2+26,'04'O

      791     9260    3            CLOSE_ERRLOG4.V.DISP# = %SAVE#;

   9260  9 001306   001306 552004 7                  STBQ    CLOSE_ERRLOG4+26,'04'O

      792     9261    3            IF DCBADDR(DCBNUM(M$ERRLOG3))->F$DCB.FCD   /* if dcb is open */

   9261  9 001307   000000 236007 xsym               LDQ     M$ERRLOG3,DL
         9 001310   000000 470400 10                 LDP0    0
         9 001311   000000 471500                    LDP1    0,,PR0
         9 001312   100000 473506                    LDP3    0,QL,PR1
         9 001313   300031 236100                    LDQ     25,,PR3
         9 001314   020000 316007                    CANQ    8192,DL
         9 001315   001325 600000 9                  TZE     s:9267

      793     9262    4            THEN DO;

      794     9263    4                CLOSE_ERRLOG3.V.DISP# = %RELEASE#;     /* set it to release */

   9263  9 001316   000001 236007                    LDQ     1,DL
         9 001317   000742 552004 7                  STBQ    CLOSE_ERRLOG3+26,'04'O

      795     9264    4                CALL M$CLOSE(CLOSE_ERRLOG3); /* close it */

   9264  9 001320   000710 630400 7                  EPPR0   CLOSE_ERRLOG3
         9 001321   050001 713400                    CLIMB   close
         9 001322   406000 401760                    pmme    nvectors=13

      796     9265    4                CLOSE_ERRLOG3.V.DISP# = %SAVE#;        /* reset file to save */

   9265  9 001323   000002 236007                    LDQ     2,DL
         9 001324   000742 552004 7                  STBQ    CLOSE_ERRLOG3+26,'04'O

      797     9266    4            END;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:127  
      798     9267    4            IF DCBADDR(DCBNUM(M$ERRLOG5))->F$DCB.FCD THEN DO;

   9267  9 001325   000000 236007 xsym               LDQ     M$ERRLOG5,DL
         9 001326   000000 470400 10                 LDP0    0
         9 001327   000000 471500                    LDP1    0,,PR0
         9 001330   100000 473506                    LDP3    0,QL,PR1
         9 001331   300031 236100                    LDQ     25,,PR3
         9 001332   020000 316007                    CANQ    8192,DL
         9 001333   001343 600000 9                  TZE     s:9272

      799     9268    4                CLOSE_ERRLOG5.V.DISP# = %RELEASE#;

   9268  9 001334   000001 236007                    LDQ     1,DL
         9 001335   001452 552004 7                  STBQ    CLOSE_ERRLOG5+26,'04'O

      800     9269    4                CALL M$CLOSE(CLOSE_ERRLOG5);

   9269  9 001336   001420 630400 7                  EPPR0   CLOSE_ERRLOG5
         9 001337   050001 713400                    CLIMB   close
         9 001340   406000 401760                    pmme    nvectors=13

      801     9270    4                CLOSE_ERRLOG3.V.DISP# = %SAVE#;

   9270  9 001341   000002 236007                    LDQ     2,DL
         9 001342   000742 552004 7                  STBQ    CLOSE_ERRLOG3+26,'04'O

      802     9271    4            END;

      803     9272    3            CALL THC$DETAIL; /* call procedure to handle detail report */

   9272  9 001343   003202 701000 9                  TSX1    THC$DETAIL
         9 001344   000000 011000                    NOP     0

      804     9273    4            IF MEMORY_ERRORS THEN DO;/* if MEM errors were read in */

   9273  9 001345   200370 234100                    SZN     MEMORY_ERRORS,,AUTO
         9 001346   001357 605000 9                  TPL     s:9277
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:128  

      805     9274    4                COMP_CODE = %MEM;/* set code to MEM */

   9274  9 001347   000001 235007                    LDA     1,DL
         9 001350   200361 755100                    STA     COMP_CODE,,AUTO

      806     9275    4                CALL THF$HWE(COMP_CODE);/* then call procedure to handle MEM errs*/

   9275  9 001351   200361 630500                    EPPR0   COMP_CODE,,AUTO
         9 001352   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 001353   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001354   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001355   000000 701000 xent               TSX1    THF$HWE
         9 001356   000000 011000                    NOP     0

      807     9276    4            END;  /* if memory_errors */

      808     9277    4            IF NUM_FEPERR > 0 THEN DO;  /* if feperr was read */

   9277  9 001357   200372 235100                    LDA     NUM_FEPERR,,AUTO
         9 001360   001475 604400 9                  TMOZ    s:9306

      809     9278    4              CALL THW$WRITE(VECTOR(FEPERR_HDR));

   9278  9 001361   000064 630400 10                 EPPR0   52
         9 001362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001363   000000 701000 xent               TSX1    THW$WRITE
         9 001364   000000 011000                    NOP     0

      810     9279    4              TH_FEPERR_FLG = %TRUE;

   9279  9 001365   400000 236003                    LDQ     -131072,DU
         9 001366   000000 756000 xsym               STQ     TH_FEPERR_FLG

      811     9280    4              CALL THW$WRITE(TIME_FMT,VECTOR(OLD_FEPERR_TIME),VECTOR(OLD_FEPERR_DATE),
              9280                       VECTOR(NEW_FEPERR_DATE),VECTOR(NEW_FEPERR_TIME));

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:129  
   9280  9 001367   000076 630400 10                 EPPR0   62
         9 001370   000023 631400 xsym               EPPR1   B_VECTNIL+19
         9 001371   000000 701000 xent               TSX1    THW$WRITE
         9 001372   000000 011000                    NOP     0

      812     9281    5              IF NOT DCBADDR(DCBNUM(M$ERRLOG5))->F$DCB.FCD THEN DO;
              9281                       /*if dcb's not open*/

   9281  9 001373   000000 236007 xsym               LDQ     M$ERRLOG5,DL
         9 001374   000000 470400 10                 LDP0    0
         9 001375   000000 471500                    LDP1    0,,PR0
         9 001376   100000 473506                    LDP3    0,QL,PR1
         9 001377   300031 236100                    LDQ     25,,PR3
         9 001400   020000 316007                    CANQ    8192,DL
         9 001401   001407 601000 9                  TNZ     s:9285

      813     9282    5                 OPEN_ERRLOG5.V.FUN# = %UPDATE#;/* set it to update */

   9282  9 001402   001000 236007                    LDQ     512,DL
         9 001403   001373 552010 7                  STBQ    OPEN_ERRLOG5+37,'10'O

      814     9283    5                 CALL M$OPEN(OPEN_ERRLOG5);/* open dcb */

   9283  9 001404   001326 630400 7                  EPPR0   OPEN_ERRLOG5
         9 001405   050000 713400                    CLIMB   open
         9 001406   410400 401760                    pmme    nvectors=18

      815     9284    5              END;

      816     9285    4              EOF_FLAG = %FALSE;/* set appropriate flags */

   9285  9 001407   203005 450100                    STZ     EOF_FLAG,,AUTO

      817     9286    4              TH_FIRST_TIME = %TRUE;

   9286  9 001410   400000 236003                    LDQ     -131072,DU
         9 001411   000000 756000 xsym               STQ     TH_FIRST_TIME
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:130  

      818     9287    4              TH_ITYPE = %TH_FEPERR;

   9287  9 001412   000024 235007                    LDA     20,DL
         9 001413   000000 755000 xsym               STA     TH_ITYPE

      819     9288    4              CALL M$GDS(GET_XSA_BUF) ALTRET(PMME_ERR);/* get memory */

   9288  9 001414   000764 630400 7                  EPPR0   GET_XSA_BUF
         9 001415   430001 713400                    CLIMB   alt,gds
         9 001416   400400 401760                    pmme    nvectors=2
         9 001417   003172 702000 9                  TSX2    PMME_ERR

      820     9289    4              READ_ERRLOG5.BUF_ = TH_XSA_BUF_VECTOR;/* assign read vector */

   9289  9 001420   000000 100400                    MLR     fill='000'O
         9 001421   000000 000010 xsym               ADSC9   TH_XSA_BUF_VECTOR        cn=0,n=8
         9 001422   001462 000010 7                  ADSC9   READ_ERRLOG5+4           cn=0,n=8

      821     9290    5                DO WHILE(NOT EOF_FLAG);

   9290  9 001423   001451 710000 9                  TRA     s:9298

      822     9291    5                  CALL M$READ(READ_ERRLOG5) ALTRET(ERRLOG5_EOF);

   9291  9 001424   001456 630400 7                  EPPR0   READ_ERRLOG5
         9 001425   440000 713400                    CLIMB   alt,read
         9 001426   401400 401760                    pmme    nvectors=4
         9 001427   001435 702000 9                  TSX2    ERRLOG5_EOF

      823     9292    5                  CALL THF$RAW(TH_DETAIL_FMT);
              9292                           /* call procedure to format/process feperr records */

   9292  9 001430   000103 630400 10                 EPPR0   67
         9 001431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001432   000000 701000 xent               TSX1    THF$RAW
         9 001433   000000 011000                    NOP     0
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:131  

      824     9293    6   DO NEVER;

   9293  9 001434   001451 710000 9                  TRA     s:9298

      825     9294    6   ERRLOG5_EOF:     IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$EOF

   9294  9 001435   000000 470400 xsym  ERRLOG5_EOF  LDP0    B$TCB$
         9 001436   000000 471500                    LDP1    0,,PR0
         9 001437   100102 236100                    LDQ     66,,PR1
         9 001440   377770 376007                    ANQ     131064,DL
         9 001441   000060 116007                    CMPQ    48,DL
         9 001442   001446 601000 9                  TNZ     s:9296

      826     9295    6                    THEN EOF_FLAG = %TRUE;

   9295  9 001443   400000 236003                    LDQ     -131072,DU
         9 001444   203005 756100                    STQ     EOF_FLAG,,AUTO
         9 001445   001451 710000 9                  TRA     s:9298

      827     9296    6                    ELSE CALL THM$ERRMSG;

   9296  9 001446   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001447   000000 701000 xent               TSX1    THM$ERRMSG
         9 001450   000000 011000                    NOP     0

      828     9297    6                  END;  /* do never */

      829     9298    5                END;/* do while not eof */

   9298  9 001451   203005 234100                    SZN     EOF_FLAG,,AUTO
         9 001452   001424 605000 9                  TPL     s:9291

      830     9299    4              CALL M$CLOSE(CLOSE_ERRLOG5);/* close dcb */

   9299  9 001453   001420 630400 7                  EPPR0   CLOSE_ERRLOG5
         9 001454   050001 713400                    CLIMB   close
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:132  
         9 001455   406000 401760                    pmme    nvectors=13

      831     9300    4              IF EOF_FLAG /* if its eof */

   9300  9 001456   203005 234100                    SZN     EOF_FLAG,,AUTO
         9 001457   001462 605000 9                  TPL     s:9302

      832     9301    4                THEN TH_EOF_FLG = %TRUE;

   9301  9 001460   400000 236003                    LDQ     -131072,DU
         9 001461   000000 756000 xsym               STQ     TH_EOF_FLG

      833     9302    4                CALL THF$RAW(TH_DETAIL_FMT);
              9302                         /* call procedure to process last record(s)*/

   9302  9 001462   000103 630400 10                 EPPR0   67
         9 001463   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001464   000000 701000 xent               TSX1    THF$RAW
         9 001465   000000 011000                    NOP     0

      834     9303    4              IF TH_XSA_BUF.P$ ~= ADDR(NIL)/* if memory was used */

   9303  9 001466   000001 236000 xsym               LDQ     TH_XSA_BUF_VECTOR+1
         9 001467   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 001470   001475 600000 9                  TZE     s:9306

      835     9304    4              THEN CALL M$FDS(GET_XSA_BUF) ALTRET(PMME_ERR);/* release it*/

   9304  9 001471   000764 630400 7                  EPPR0   GET_XSA_BUF
         9 001472   430002 713400                    CLIMB   alt,fds
         9 001473   400400 401760                    pmme    nvectors=2
         9 001474   003172 702000 9                  TSX2    PMME_ERR

      836     9305    4            END;  /* if num_feperr > 0 */

      837     9306    4            IF NUM_IOERR_REC > 0 THEN DO; /* if ioerr was read in */

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:133  
   9306  9 001475   200371 235100                    LDA     NUM_IOERR_REC,,AUTO
         9 001476   003127 604400 9                  TMOZ    s:9546

      838     9307    4            CALL THW$WRITE(VECTOR(IOERR_HDR));

   9307  9 001477   000106 630400 10                 EPPR0   70
         9 001500   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001501   000000 701000 xent               TSX1    THW$WRITE
         9 001502   000000 011000                    NOP     0

      839     9308    4        CALL THW$WRITE(TIME_FMT,VECTOR(OLD_IOERR_TIME),VECTOR(OLD_IOERR_DATE),VECTOR(
              9308                 NEW_IOERR_DATE),VECTOR(NEW_IOERR_TIME));

   9308  9 001503   000120 630400 10                 EPPR0   80
         9 001504   000023 631400 xsym               EPPR1   B_VECTNIL+19
         9 001505   000000 701000 xent               TSX1    THW$WRITE
         9 001506   000000 011000                    NOP     0

      840     9309    4            IF NOT DCBADDR(DCBNUM(M$ERRLOG3))->F$DCB.FCD  /*if errlog3 isn't open */

   9309  9 001507   000000 236007 xsym               LDQ     M$ERRLOG3,DL
         9 001510   000000 470400 10                 LDP0    0
         9 001511   000000 471500                    LDP1    0,,PR0
         9 001512   100000 473506                    LDP3    0,QL,PR1
         9 001513   300031 236100                    LDQ     25,,PR3
         9 001514   020000 316007                    CANQ    8192,DL
         9 001515   001523 601000 9                  TNZ     s:9314

      841     9310    5            THEN DO;

      842     9311    5                OPEN_ERRLOG3.V.FUN#=%UPDATE#;   /* set FPT to update file */

   9311  9 001516   001000 236007                    LDQ     512,DL
         9 001517   000663 552010 7                  STBQ    OPEN_ERRLOG3+37,'10'O

      843     9312    5                CALL M$OPEN(OPEN_ERRLOG3);

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:134  
   9312  9 001520   000616 630400 7                  EPPR0   OPEN_ERRLOG3
         9 001521   050000 713400                    CLIMB   open
         9 001522   410400 401760                    pmme    nvectors=18

      844     9313    5            END;

      845     9314    4            EOF_FLAG = %FALSE;/* set appropriate flags */

   9314  9 001523   203005 450100                    STZ     EOF_FLAG,,AUTO

      846     9315    4            TH_EOF_FLG = %FALSE;

   9315  9 001524   000000 450000 xsym               STZ     TH_EOF_FLG

      847     9316    4            TH_IOERR_FLG = %TRUE;  /* set ioerr flg */

   9316  9 001525   400000 236003                    LDQ     -131072,DU
         9 001526   000000 756000 xsym               STQ     TH_IOERR_FLG

      848     9317    4            TH_FEPERR_FLG = %FALSE;

   9317  9 001527   000000 450000 xsym               STZ     TH_FEPERR_FLG

      849     9318    4            TH_FIRST_TIME = %TRUE;

   9318  9 001530   000000 756000 xsym               STQ     TH_FIRST_TIME

      850     9319    4            TH_ITYPE = %TH_IOERR;

   9319  9 001531   000022 235007                    LDA     18,DL
         9 001532   000000 755000 xsym               STA     TH_ITYPE

      851     9320    4            CALL M$GDS(GET_XSA_BUF) ALTRET(PMME_ERR);  /* get memory to use */

   9320  9 001533   000764 630400 7                  EPPR0   GET_XSA_BUF
         9 001534   430001 713400                    CLIMB   alt,gds
         9 001535   400400 401760                    pmme    nvectors=2
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:135  
         9 001536   003172 702000 9                  TSX2    PMME_ERR

      852     9321    4            READ_ERRLOG3.BUF_=TH_XSA_BUF_VECTOR;  /* assign FPT's vector */

   9321  9 001537   000000 100400                    MLR     fill='000'O
         9 001540   000000 000010 xsym               ADSC9   TH_XSA_BUF_VECTOR        cn=0,n=8
         9 001541   000752 000010 7                  ADSC9   READ_ERRLOG3+4           cn=0,n=8

      853     9322    5              DO WHILE(NOT EOF_FLAG);

   9322  9 001542   001570 710000 9                  TRA     s:9330

      854     9323    5                CALL M$READ(READ_ERRLOG3) ALTRET(ERRLOG3_EOF);

   9323  9 001543   000746 630400 7                  EPPR0   READ_ERRLOG3
         9 001544   440000 713400                    CLIMB   alt,read
         9 001545   401400 401760                    pmme    nvectors=4
         9 001546   001554 702000 9                  TSX2    ERRLOG3_EOF

      855     9324    5                CALL THF$RAW(TH_DETAIL_FMT);
              9324                         /* call procedure to process/format ioerr */

   9324  9 001547   000103 630400 10                 EPPR0   67
         9 001550   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001551   000000 701000 xent               TSX1    THF$RAW
         9 001552   000000 011000                    NOP     0

      856     9325    6   DO NEVER;

   9325  9 001553   001570 710000 9                  TRA     s:9330

      857     9326    6   ERRLOG3_EOF:   IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$EOF

   9326  9 001554   000000 470400 xsym  ERRLOG3_EOF  LDP0    B$TCB$
         9 001555   000000 471500                    LDP1    0,,PR0
         9 001556   100102 236100                    LDQ     66,,PR1
         9 001557   377770 376007                    ANQ     131064,DL
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:136  
         9 001560   000060 116007                    CMPQ    48,DL
         9 001561   001565 601000 9                  TNZ     s:9328

      858     9327    6                  THEN EOF_FLAG =%TRUE;

   9327  9 001562   400000 236003                    LDQ     -131072,DU
         9 001563   203005 756100                    STQ     EOF_FLAG,,AUTO
         9 001564   001570 710000 9                  TRA     s:9330

      859     9328    6                  ELSE CALL THM$ERRMSG;

   9328  9 001565   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001566   000000 701000 xent               TSX1    THM$ERRMSG
         9 001567   000000 011000                    NOP     0

      860     9329    6                END;   /* DO NEVER  */

      861     9330    5              END;     /* DO WHILE  */

   9330  9 001570   203005 234100                    SZN     EOF_FLAG,,AUTO
         9 001571   001543 605000 9                  TPL     s:9323

      862     9331    4              CALL M$CLOSE(CLOSE_ERRLOG3);/* close dcb */

   9331  9 001572   000710 630400 7                  EPPR0   CLOSE_ERRLOG3
         9 001573   050001 713400                    CLIMB   close
         9 001574   406000 401760                    pmme    nvectors=13

      863     9332    4            IF EOF_FLAG THEN TH_EOF_FLG = %TRUE;/* if its eof */

   9332  9 001575   203005 234100                    SZN     EOF_FLAG,,AUTO
         9 001576   001601 605000 9                  TPL     s:9333

   9332  9 001577   400000 236003                    LDQ     -131072,DU
         9 001600   000000 756000 xsym               STQ     TH_EOF_FLG

      864     9333    4             CALL THF$RAW(TH_DETAIL_FMT);/* call procedure to process last record(s)*/
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:137  

   9333  9 001601   000103 630400 10                 EPPR0   67
         9 001602   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001603   000000 701000 xent               TSX1    THF$RAW
         9 001604   000000 011000                    NOP     0

      865     9334    4              IF TH_XSA_BUF.P$ ~= ADDR(NIL)    /* if memory was used */

   9334  9 001605   000001 236000 xsym               LDQ     TH_XSA_BUF_VECTOR+1
         9 001606   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 001607   003127 600000 9                  TZE     s:9546

      866     9335    4              THEN CALL M$FDS(GET_XSA_BUF) ALTRET(PMME_ERR); /* then release it */

   9335  9 001610   000764 630400 7                  EPPR0   GET_XSA_BUF
         9 001611   430002 713400                    CLIMB   alt,fds
         9 001612   400400 401760                    pmme    nvectors=2
         9 001613   003172 702000 9                  TSX2    PMME_ERR

      867     9336    4            END;    /* if num_ioerr_rec > 0 */

      868     9337    3            END;    /* if report_code = %detail */

   9337  9 001614   003127 710000 9                  TRA     s:9546

      869     9338    3            ELSE DO;

      870     9339    3            CALL XUD$UTS_DIFF_SEC (START_TIME, TH_CONSTRAINTS.START, 0);

   9339  9 001615   000125 236000 10                 LDQ     85
         9 001616   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 001617   000015 236000 10                 LDQ     13
         9 001620   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 001621   200004 630500                    EPPR0   START_TIME,,AUTO
         9 001622   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 001623   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001624   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:138  
         9 001625   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         9 001626   000000 011000                    NOP     0

      871     9340    3            START_TIME = START_TIME / 86400;

   9340  9 001627   200004 236100                    LDQ     START_TIME,,AUTO
         9 001630   000001 772000                    QRL     1
         9 001631   124300 506007                    DIV     43200,DL
         9 001632   200004 756100                    STQ     START_TIME,,AUTO

      872     9341    3            CALL XUD$UTS_ADJ_25TH (START_TIME, 0, START_TIME*%UTS_25TH_DAY#);

   9341  9 001633   000126 402000 10                 MPY     86
         9 001634   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 001635   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001636   203013 450500                    STP0    EOF_FLAG+6,,AUTO
         9 001637   000125 236000 10                 LDQ     85
         9 001640   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 001641   200004 631500                    EPPR1   START_TIME,,AUTO
         9 001642   203011 451500                    STP1    EOF_FLAG+4,,AUTO
         9 001643   203011 630500                    EPPR0   EOF_FLAG+4,,AUTO
         9 001644   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001645   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 001646   000000 011000                    NOP     0

      873     9342    3            CALL XUD$UTS_DIFF_SEC (STOP_TIME, TH_CONSTRAINTS.STOP, 0);

   9342  9 001647   000125 236000 10                 LDQ     85
         9 001650   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 001651   000017 236000 10                 LDQ     15
         9 001652   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 001653   200005 630500                    EPPR0   STOP_TIME,,AUTO
         9 001654   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 001655   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001656   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001657   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         9 001660   000000 011000                    NOP     0
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:139  

      874     9343    3            STOP_TIME = STOP_TIME / 86400;

   9343  9 001661   200005 236100                    LDQ     STOP_TIME,,AUTO
         9 001662   000001 772000                    QRL     1
         9 001663   124300 506007                    DIV     43200,DL
         9 001664   200005 756100                    STQ     STOP_TIME,,AUTO

      875     9344    3            CALL XUD$UTS_ADJ_25TH (STOP_TIME, 0, STOP_TIME*%UTS_25TH_DAY#);

   9344  9 001665   000126 402000 10                 MPY     86
         9 001666   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 001667   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 001670   203013 450500                    STP0    EOF_FLAG+6,,AUTO
         9 001671   000125 236000 10                 LDQ     85
         9 001672   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 001673   200005 631500                    EPPR1   STOP_TIME,,AUTO
         9 001674   203011 451500                    STP1    EOF_FLAG+4,,AUTO
         9 001675   203011 630500                    EPPR0   EOF_FLAG+4,,AUTO
         9 001676   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001677   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 001700   000000 011000                    NOP     0

      876     9345    3          ERRLOG_DATE = START_TIME;

   9345  9 001701   200004 235100                    LDA     START_TIME,,AUTO
         9 001702   000436 755000 7                  STA     ERRLOG_DATE

      877     9346    4          DO WHILE (ERRLOG_DATE <= STOP_TIME);

   9346  9 001703   200005 236100                    LDQ     STOP_TIME,,AUTO
         9 001704   000436 116000 7                  CMPQ    ERRLOG_DATE
         9 001705   002100 602000 9                  TNC     s:9394

      878     9347    4                 NUM_RECS = 0;

   9347  9 001706   200373 450100                    STZ     NUM_RECS,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:140  

      879     9348    4                 CALL THG$OPENXSA(ERRLOG_DATE) ALTRET(NO_FILE);

   9348  9 001707   000127 630400 10                 EPPR0   87
         9 001710   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001711   000000 701000 xent               TSX1    THG$OPENXSA
         9 001712   002071 702000 9                  TSX2    NO_FILE

      880     9349    4                 CALL M$TIME(EXT_DATE);

   9349  9 001713   000670 630400 8                  EPPR0   EXT_DATE
         9 001714   020004 713400                    CLIMB   8196
         9 001715   402000 401760                    pmme    nvectors=5

      881     9350    4                 IF CODE = %ALL

   9350  9 001716   200360 235100                    LDA     CODE,,AUTO
         9 001717   000016 115007                    CMPA    14,DL
         9 001720   001727 601000 9                  TNZ     s:9356

      882     9351    4                    THEN
      883     9352    5                    DO;

      884     9353    5                       TH_NUM_REP_DEVS = 1;

   9353  9 001721   000001 236007                    LDQ     1,DL
         9 001722   000000 756000 xsym               STQ     TH_NUM_REP_DEVS

      885     9354    5                       TH_REP_DEVS(0) = ' ';

   9354  9 001723   000035 235000 xsym               LDA     B_VECTNIL+29
         9 001724   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 001725   000000 755000 xsym               STA     TH_REP_DEVS
         9 001726   000001 756000 xsym               STQ     TH_REP_DEVS+1

      886     9355    5                    END;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:141  
      887     9356    5                 DO I = 0 TO TH_NUM_REP_DEVS - 1;

   9356  9 001727   200363 450100                    STZ     I,,AUTO
         9 001730   002066 710000 9                  TRA     s:9390+3

      888     9357    5                    TH_CONSTRAINTS.DEVNM = TH_REP_DEVS(I);

   9357  9 001731   200363 235100                    LDA     I,,AUTO
         9 001732   000003 735000                    ALS     3
         9 001733   040000 100405                    MLR     fill='040'O
         9 001734   000000 000010 xsym               ADSC9   TH_REP_DEVS,A            cn=0,n=8
         9 001735   000010 000010 xsym               ADSC9   TH_CONSTRAINTS+8         cn=0,n=8

      889     9358    5                    IF TH_CONSTRAINTS.DEVNM ~= ' '

   9358  9 001736   000010 237000 xsym               LDAQ    TH_CONSTRAINTS+8
         9 001737   000130 117000 10                 CMPAQ   88
         9 001740   001744 600000 9                  TZE     s:9360

      890     9359    5                    THEN TH_CHECK_DEVNM = '1'B;

   9359  9 001741   400000 236003                    LDQ     -131072,DU
         9 001742   000000 756000 xsym               STQ     TH_CHECK_DEVNM
         9 001743   001745 710000 9                  TRA     s:9361

      891     9360    5                    ELSE TH_CHECK_DEVNM = '0'B;

   9360  9 001744   000000 450000 xsym               STZ     TH_CHECK_DEVNM

      892     9361    5                    EOF_FLAG = %FALSE;

   9361  9 001745   203005 450100                    STZ     EOF_FLAG,,AUTO

      893     9362    5            CALL THG$PRECORDXSA(TH_CONSTRAINTS.START);

   9362  9 001746   000015 630400 10                 EPPR0   13
         9 001747   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:142  
         9 001750   000000 701000 xent               TSX1    THG$PRECORDXSA
         9 001751   000000 011000                    NOP     0

      894     9363    6                    DO WHILE(NOT EOF_FLAG);

   9363  9 001752   002061 710000 9                  TRA     s:9389

      895     9364    6                       CALL THG$GETREC(%ERRLOG) ALTRET(EOF_LBL);

   9364  9 001753   000132 630400 10                 EPPR0   90
         9 001754   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001755   000000 701000 xent               TSX1    THG$GETREC
         9 001756   002057 702000 9                  TSX2    EOF_LBL

      896     9365    6                       IF (NUM_RECS = 0) AND (REPORT_CODE ~= %DETAIL)
              9365                                /*if first rec & not detail report*/

   9365  9 001757   200373 235100                    LDA     NUM_RECS,,AUTO
         9 001760   001770 601000 9                  TNZ     s:9367
         9 001761   203004 236100                    LDQ     REPORT_CODE,,AUTO
         9 001762   000021 116007                    CMPQ    17,DL
         9 001763   001770 600000 9                  TZE     s:9367

      897     9366    6                         THEN CALL THW$WRITE(DATE_FMT,VECTOR(DAY_BUF),VECTOR(DATE_BUF)
              9366                                   );

   9366  9 001764   000140 630400 10                 EPPR0   96
         9 001765   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001766   000000 701000 xent               TSX1    THW$WRITE
         9 001767   000000 011000                    NOP     0

      898     9367    6                       NUM_RECS = NUM_RECS + 1;

   9367  9 001770   200373 054100                    AOS     NUM_RECS,,AUTO

      899     9368    7                       IF TH_CONSTRAINTS.OCTAL THEN DO;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:143  
   9368  9 001771   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         9 001772   002000 316007                    CANQ    1024,DL
         9 001773   002034 600000 9                  TZE     s:9376

      900     9369    7                          LOC_UTS = RECORD.UTS;

   9369  9 001774   000001 470400 xsym               LDP0    TH_RECORD+1
         9 001775   000000 235100                    LDA     0,,PR0
         9 001776   000001 236100                    LDQ     1,,PR0
         9 001777   000011 773000                    LRL     9
         9 002000   000411 756000 7                  STQ     LOC_UTS

      901     9370    7                          CALL M$TIME(LOC_DATE);

   9370  9 002001   000704 630400 8                  EPPR0   LOC_DATE
         9 002002   020004 713400                    CLIMB   8196
         9 002003   402000 401760                    pmme    nvectors=5

      902     9371    7                          TYPE = RECORD.TYPE;

   9371  9 002004   000001 470400 xsym               LDP0    TH_RECORD+1
         9 002005   000000 236100                    LDQ     0,,PR0
         9 002006   000033 772000                    QRL     27
         9 002007   200354 756100                    STQ     TYPE,,AUTO

      903     9372    7                         CALL THW$WRITE(DUMP_FMT,VECTOR(TYPE),VECTOR(DBUF),VECTOR(TBUF
              9372                                   ));

   9372  9 002010   777640 235007                    LDA     -96,DL
         9 002011   203010 452500                    STP2    EOF_FLAG+3,,AUTO
         9 002012   203010 236100                    LDQ     EOF_FLAG+3,,AUTO
         9 002013   000354 036003                    ADLQ    236,DU
         9 002014   203012 757100                    STAQ    EOF_FLAG+5,,AUTO
         9 002015   000150 237000 10                 LDAQ    104
         9 002016   203016 757100                    STAQ    EOF_FLAG+9,,AUTO
         9 002017   203012 631500                    EPPR1   EOF_FLAG+5,,AUTO
         9 002020   203015 451500                    STP1    EOF_FLAG+8,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:144  
         9 002021   000152 236000 10                 LDQ     106
         9 002022   203014 756100                    STQ     EOF_FLAG+7,,AUTO
         9 002023   203014 630500                    EPPR0   EOF_FLAG+7,,AUTO
         9 002024   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 002025   000000 701000 xent               TSX1    THW$WRITE
         9 002026   000000 011000                    NOP     0

      904     9373    7                          CALL THF$DUMP(TH_RECORD.PTR$);

   9373  9 002027   000153 630400 10                 EPPR0   107
         9 002030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002031   000000 701000 xent               TSX1    THF$DUMP
         9 002032   000000 011000                    NOP     0

      905     9374    7                          END;  /* IF OCTAL */

   9374  9 002033   002056 710000 9                  TRA     s:9386

      906     9375    7                       ELSE DO;

      907     9376    7                          CALL M$TIME(RECORD_DATE);

   9376  9 002034   000654 630400 8                  EPPR0   RECORD_DATE
         9 002035   020004 713400                    CLIMB   8196
         9 002036   402000 401760                    pmme    nvectors=5

      908     9377    7                          TH_DETAIL_FLG = %FALSE;

   9377  9 002037   000000 450000 xsym               STZ     TH_DETAIL_FLG

      909     9378    7                          IF REPORT_CODE = %RAW

   9378  9 002040   203004 235100                    LDA     REPORT_CODE,,AUTO
         9 002041   000012 115007                    CMPA    10,DL
         9 002042   002052 601000 9                  TNZ     s:9384

      910     9379    8                          THEN DO;  /* call formattor routine with raw formats*/
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:145  

      911     9380    8                               TH_RAW_FLG = %TRUE;

   9380  9 002043   400000 236003                    LDQ     -131072,DU
         9 002044   000000 756000 xsym               STQ     TH_RAW_FLG

      912     9381    8                               CALL THF$RAW(TH_RAW_FMT);/* process raw report*/

   9381  9 002045   000154 630400 10                 EPPR0   108
         9 002046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002047   000000 701000 xent               TSX1    THF$RAW
         9 002050   000000 011000                    NOP     0

      913     9382    8                          END;

   9382  9 002051   002056 710000 9                  TRA     s:9386

      914     9383    7                          ELSE /* call formatter routine w/extended formats */
      915     9384    7                               CALL THF$RAW(TH_EXTENDED_FMT);
              9384                                        /* process extended report*/

   9384  9 002052   000155 630400 10                 EPPR0   109
         9 002053   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002054   000000 701000 xent               TSX1    THF$RAW
         9 002055   000000 011000                    NOP     0

      916     9385    7                          END;

      917     9386    7                       DO NEVER;

   9386  9 002056   002061 710000 9                  TRA     s:9389

      918     9387    7              EOF_LBL:    EOF_FLAG = %TRUE;

   9387  9 002057   400000 236003       EOF_LBL      LDQ     -131072,DU
         9 002060   203005 756100                    STQ     EOF_FLAG,,AUTO

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:146  
      919     9388    7                       END;                /* DO NEVER                           */

      920     9389    6                    END;                   /* DO WHILE NOT EOF_FLG               */

   9389  9 002061   203005 234100                    SZN     EOF_FLAG,,AUTO
         9 002062   001753 605000 9                  TPL     s:9364

      921     9390    5                 END;                      /* DO I = 0 TO TH_NUM_REP_DEVS - 1    */

   9390  9 002063   200363 235100                    LDA     I,,AUTO
         9 002064   000001 035007                    ADLA    1,DL
         9 002065   200363 755100                    STA     I,,AUTO
         9 002066   200363 236100                    LDQ     I,,AUTO
         9 002067   000000 116000 xsym               CMPQ    TH_NUM_REP_DEVS
         9 002070   001731 602000 9                  TNC     s:9357

      922     9391    4     NO_FILE:
      923     9392    4                 CALL XUD$UTS_ADJ_25TH (ERRLOG_DATE, ERRLOG_DATE, %UTS_25TH_DAY#);

   9392  9 002071   000156 630400 10    NO_FILE      EPPR0   110
         9 002072   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002073   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 002074   000000 011000                    NOP     0

      924     9393    4              END;                   /* DO WHILE (ERRLOG_DATE <= STOP) */

   9393  9 002075   200005 236100                    LDQ     STOP_TIME,,AUTO
         9 002076   000436 116000 7                  CMPQ    ERRLOG_DATE
         9 002077   001706 603000 9                  TRC     s:9347

      925     9394    3              CALL THG$CLOSEXSA;

   9394  9 002100   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002101   000000 701000 xent               TSX1    THG$CLOSEXSA
         9 002102   000000 011000                    NOP     0

      926     9395    3              TH_LASTTYPE = -1;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:147  

   9395  9 002103   000001 335007                    LCA     1,DL
         9 002104   000000 755000 xsym               STA     TH_LASTTYPE

      927     9396    3             END;

   9396  9 002105   003127 710000 9                  TRA     s:9546

      928     9397    2           CASE(%SUM);

      929     9398    2            TH_BRKMSG = '0'B;

   9398  9 002106   000000 450000 xsym               STZ     TH_BRKMSG

      930     9399    3              IF TH_CONSTRAINTS.NTYPES > 0 THEN DO;

   9399  9 002107   000000 236000 xsym               LDQ     TH_CONSTRAINTS
         9 002110   002213 604400 9                  TMOZ    s:9416

      931     9400    3                 TEXT$ = ADDR(TEXTBUF);

   9400  9 002111   000003 236000 10                 LDQ     3
         9 002112   200006 756100                    STQ     TEXT$,,AUTO

      932     9401    3                 BUF_COUNT = 0;

   9401  9 002113   200353 450100                    STZ     BUF_COUNT,,AUTO

      933     9402    4                 DO I = 0 TO TH_CONSTRAINTS.NTYPES - 1;

   9402  9 002114   200363 450100                    STZ     I,,AUTO
         9 002115   002156 710000 9                  TRA     s:9410+3

      934     9403    5                    IF I > 0 THEN DO;

   9403  9 002116   200363 235100                    LDA     I,,AUTO
         9 002117   002127 600000 9                  TZE     s:9407
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:148  

      935     9404    5                       CALL INSERT(TEMP_BUF2,BUF_COUNT,2,', ');

   9404  9 002120   200353 236100                    LDQ     BUF_COUNT,,AUTO
         9 002121   040106 100400                    MLR     fill='040'O
         9 002122   001072 000002 8                  ADSC9   SORT_SUPPRESS+29         cn=0,n=2
         9 002123   200012 000002                    ADSC9   TEMP_BUF2,Q,AUTO         cn=0,n=2

      936     9405    5                       BUF_COUNT = BUF_COUNT + 2;

   9405  9 002124   200353 236100                    LDQ     BUF_COUNT,,AUTO
         9 002125   000002 036007                    ADLQ    2,DL
         9 002126   200353 756100                    STQ     BUF_COUNT,,AUTO

      937     9406    5                       END;  /* IF I > 0 */

      938     9407    4                    CALL THC$TYPENAME(TH_CONSTRAINTS.TYPES(I),TEMP_BUF,COUNT);

   9407  9 002127   203003 630500                    EPPR0   COUNT,,AUTO
         9 002130   203012 450500                    STP0    EOF_FLAG+5,,AUTO
         9 002131   000005 236000 10                 LDQ     5
         9 002132   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 002133   200363 236100                    LDQ     I,,AUTO
         9 002134   000020 736000                    QLS     16
         9 002135   000041 036000 10                 ADLQ    33
         9 002136   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 002137   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002140   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002141   000000 701000 xent               TSX1    THC$TYPENAME
         9 002142   000000 011000                    NOP     0

      939     9408    4                    CALL INSERT(TEMP_BUF2,BUF_COUNT,COUNT,SUBSTR(TEMP_BUF,0,COUNT));

   9408  9 002143   203003 720100                    LXL0    COUNT,,AUTO
         9 002144   200353 235100                    LDA     BUF_COUNT,,AUTO
         9 002145   040145 100440                    MLR     fill='040'O
         9 002146   000343 000010 7                  ADSC9   TEMP_BUF                 cn=0,n=*X0
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:149  
         9 002147   200012 000010                    ADSC9   TEMP_BUF2,A,AUTO         cn=0,n=*X0

      940     9409    4                    BUF_COUNT = BUF_COUNT + COUNT;

   9409  9 002150   200353 236100                    LDQ     BUF_COUNT,,AUTO
         9 002151   203003 036100                    ADLQ    COUNT,,AUTO
         9 002152   200353 756100                    STQ     BUF_COUNT,,AUTO

      941     9410    4                    END;  /* DO I */

   9410  9 002153   200363 235100                    LDA     I,,AUTO
         9 002154   000001 035007                    ADLA    1,DL
         9 002155   200363 755100                    STA     I,,AUTO
         9 002156   200363 236100                    LDQ     I,,AUTO
         9 002157   002162 604000 9                  TMI     s:9411
         9 002160   000000 116000 xsym               CMPQ    TH_CONSTRAINTS
         9 002161   002116 604000 9                  TMI     s:9403

      942     9411    3                 CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF2,BUF_COUNT);

   9411  9 002162   200353 630500                    EPPR0   BUF_COUNT,,AUTO
         9 002163   203012 450500                    STP0    EOF_FLAG+5,,AUTO
         9 002164   200012 631500                    EPPR1   TEMP_BUF2,,AUTO
         9 002165   203011 451500                    STP1    EOF_FLAG+4,,AUTO
         9 002166   200006 633500                    EPPR3   TEXT$,,AUTO
         9 002167   203010 453500                    STP3    EOF_FLAG+3,,AUTO
         9 002170   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002171   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002172   000000 701000 xent               TSX1    THF$ADD_TEXTC
         9 002173   000000 011000                    NOP     0

      943     9412    3                 TVEC = VECTOR(TEXTBUF);

   9412  9 002174   000006 237000 10                 LDAQ    6
         9 002175   200010 757100                    STAQ    TVEC,,AUTO

      944     9413    3                 TVEC.BOUND = BUF_COUNT;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:150  

   9413  9 002176   200353 236100                    LDQ     BUF_COUNT,,AUTO
         9 002177   000020 736000                    QLS     16
         9 002200   200010 676100                    ERQ     TVEC,,AUTO
         9 002201   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 002202   200010 656100                    ERSQ    TVEC,,AUTO

      945     9414    3                 CALL THW$WRITE(VECTOR(TYPE_FMT),TVEC);

   9414  9 002203   200010 630500                    EPPR0   TVEC,,AUTO
         9 002204   203011 450500                    STP0    EOF_FLAG+4,,AUTO
         9 002205   000044 236000 10                 LDQ     36
         9 002206   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 002207   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002210   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002211   000000 701000 xent               TSX1    THW$WRITE
         9 002212   000000 011000                    NOP     0

      946     9415    3                 END;  /* IF NTYPES > 0 */

      947     9416    2       IF TH_CONSTRAINTS.M_MAJ_S OR TH_CONSTRAINTS.M_SUB_S OR

   9416  9 002213   000014 236000 xsym               LDQ     TH_CONSTRAINTS+12
         9 002214   004000 316003                    CANQ    2048,DU
         9 002215   002233 601000 9                  TNZ     s:9420
         9 002216   000020 316003                    CANQ    16,DU
         9 002217   002233 601000 9                  TNZ     s:9420
         9 002220   000016 234000 xsym               SZN     TH_CONSTRAINTS+14
         9 002221   002233 604000 9                  TMI     s:9420
         9 002222   000000 066400                    CMPB    filb='0'B
         9 002223   000026 010440 xsym               BDSC    TH_CONSTRAINTS+22        by=0,bit=1,n=288
         9 002224   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 002225   002233 601000 9                  TNZ     s:9420
         9 002226   000061 234000 xsym               SZN     TH_CONSTRAINTS+49
         9 002227   002233 604000 9                  TMI     s:9420
         9 002230   000062 236000 xsym               LDQ     TH_CONSTRAINTS+50
         9 002231   400000 316007                    CANQ    -131072,DL
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:151  
         9 002232   002237 600000 9                  TZE     s:9422

      948     9417    2          TH_CONSTRAINTS.M_MED_S OR TH_CONSTRAINTS.M_BY_B_SET ~='0'B
      949     9418    2          OR TH_CONSTRAINTS.M_FEP_SET OR TH_CONSTRAINTS.M_CHAN_SET
      950     9419    3            THEN DO;

      951     9420    3            CALL THW$WRITE(VECTOR(MATCH_FMT),VECTOR(TH_LAST_MATCH));

   9420  9 002233   000052 630400 10                 EPPR0   42
         9 002234   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002235   000000 701000 xent               TSX1    THW$WRITE
         9 002236   000000 011000                    NOP     0

      952     9421    3            END;

      953     9422    2       IF TH_CONSTRAINTS.E_MAJ_S OR TH_CONSTRAINTS.E_SUB_S OR

   9422  9 002237   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         9 002240   002000 316003                    CANQ    1024,DU
         9 002241   002260 601000 9                  TNZ     s:9426
         9 002242   000010 316003                    CANQ    8,DU
         9 002243   002260 601000 9                  TNZ     s:9426
         9 002244   000040 234000 xsym               SZN     TH_CONSTRAINTS+32
         9 002245   002260 604000 9                  TMI     s:9426
         9 002246   000000 066400                    CMPB    filb='0'B
         9 002247   000050 010440 xsym               BDSC    TH_CONSTRAINTS+40        by=0,bit=1,n=288
         9 002250   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 002251   002260 601000 9                  TNZ     s:9426
         9 002252   000063 236000 xsym               LDQ     TH_CONSTRAINTS+51
         9 002253   400000 316007                    CANQ    -131072,DL
         9 002254   002260 601000 9                  TNZ     s:9426
         9 002255   000062 236000 xsym               LDQ     TH_CONSTRAINTS+50
         9 002256   400000 316007                    CANQ    -131072,DL
         9 002257   002264 600000 9                  TZE     s:9428

      954     9423    2          TH_CONSTRAINTS.E_MED_S OR TH_CONSTRAINTS.E_BY_B_SET ~='0'B
      955     9424    2          OR TH_CONSTRAINTS.E_FEP_SET OR TH_CONSTRAINTS.M_CHAN_SET
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:152  
      956     9425    3            THEN DO;

      957     9426    3            CALL THW$WRITE(VECTOR(EXCLUDE_FMT),VECTOR(TH_LAST_EXCLUDE));

   9426  9 002260   000060 630400 10                 EPPR0   48
         9 002261   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002262   000000 701000 xent               TSX1    THW$WRITE
         9 002263   000000 011000                    NOP     0

      958     9427    3            END;

      959     9428    2              NUM_TYPES = 0;

   9428  9 002264   200374 450100                    STZ     NUM_TYPES,,AUTO

      960     9429    2              NUM_DEV = 0;

   9429  9 002265   200375 450100                    STZ     NUM_DEV,,AUTO

      961     9430    2              NUM_RECS = 0;

   9430  9 002266   200373 450100                    STZ     NUM_RECS,,AUTO

      962     9431    3              DO J = 0 TO 200;

   9431  9 002267   200364 450100                    STZ     J,,AUTO

      963     9432    3                 DEV_CNT(J) = 0;

   9432  9 002270   200364 720100                    LXL0    J,,AUTO
         9 002271   201336 450110                    STZ     DEV_CNT,X0,AUTO

      964     9433    3                 CONNECTS(J) = 0;

   9433  9 002272   202160 450110                    STZ     CONNECTS,X0,AUTO

      965     9434    3                 ERRORS(J) = 0;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:153  

   9434  9 002273   202471 450110                    STZ     ERRORS,X0,AUTO

      966     9435    3                 DEV_MOUNT(J) = 0;

   9435  9 002274   201647 450110                    STZ     DEV_MOUNT,X0,AUTO

      967     9436    3              END;  /* do j */

   9436  9 002275   200364 235100                    LDA     J,,AUTO
         9 002276   000001 035007                    ADLA    1,DL
         9 002277   200364 755100                    STA     J,,AUTO
         9 002300   000311 115007                    CMPA    201,DL
         9 002301   002270 602000 9                  TNC     s:9432

      968     9437    2          CALL XUD$UTS_DIFF_SEC (START_TIME, TH_CONSTRAINTS.START, 0);

   9437  9 002302   000125 236000 10                 LDQ     85
         9 002303   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 002304   000015 236000 10                 LDQ     13
         9 002305   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 002306   200004 630500                    EPPR0   START_TIME,,AUTO
         9 002307   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 002310   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002311   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002312   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         9 002313   000000 011000                    NOP     0

      969     9438    2          START_TIME = START_TIME / 86400;

   9438  9 002314   200004 236100                    LDQ     START_TIME,,AUTO
         9 002315   000001 772000                    QRL     1
         9 002316   124300 506007                    DIV     43200,DL
         9 002317   200004 756100                    STQ     START_TIME,,AUTO

      970     9439    2          CALL XUD$UTS_ADJ_25TH (START_TIME, 0, START_TIME*%UTS_25TH_DAY#);

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:154  
   9439  9 002320   000126 402000 10                 MPY     86
         9 002321   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 002322   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002323   203013 450500                    STP0    EOF_FLAG+6,,AUTO
         9 002324   000125 236000 10                 LDQ     85
         9 002325   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 002326   200004 631500                    EPPR1   START_TIME,,AUTO
         9 002327   203011 451500                    STP1    EOF_FLAG+4,,AUTO
         9 002330   203011 630500                    EPPR0   EOF_FLAG+4,,AUTO
         9 002331   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002332   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 002333   000000 011000                    NOP     0

      971     9440    2          CALL XUD$UTS_DIFF_SEC (STOP_TIME, TH_CONSTRAINTS.STOP, 0);

   9440  9 002334   000125 236000 10                 LDQ     85
         9 002335   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 002336   000017 236000 10                 LDQ     15
         9 002337   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 002340   200005 630500                    EPPR0   STOP_TIME,,AUTO
         9 002341   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 002342   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002343   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002344   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         9 002345   000000 011000                    NOP     0

      972     9441    2          STOP_TIME = STOP_TIME / 86400;

   9441  9 002346   200005 236100                    LDQ     STOP_TIME,,AUTO
         9 002347   000001 772000                    QRL     1
         9 002350   124300 506007                    DIV     43200,DL
         9 002351   200005 756100                    STQ     STOP_TIME,,AUTO

      973     9442    2          CALL XUD$UTS_ADJ_25TH (STOP_TIME, 0, STOP_TIME*%UTS_25TH_DAY#);

   9442  9 002352   000126 402000 10                 MPY     86
         9 002353   203010 756100                    STQ     EOF_FLAG+3,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:155  
         9 002354   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002355   203013 450500                    STP0    EOF_FLAG+6,,AUTO
         9 002356   000125 236000 10                 LDQ     85
         9 002357   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 002360   200005 631500                    EPPR1   STOP_TIME,,AUTO
         9 002361   203011 451500                    STP1    EOF_FLAG+4,,AUTO
         9 002362   203011 630500                    EPPR0   EOF_FLAG+4,,AUTO
         9 002363   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002364   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 002365   000000 011000                    NOP     0

      974     9443    2          ERRLOG_DATE = START_TIME;

   9443  9 002366   200004 235100                    LDA     START_TIME,,AUTO
         9 002367   000436 755000 7                  STA     ERRLOG_DATE

      975     9444    3          DO WHILE (ERRLOG_DATE <= STOP_TIME);

   9444  9 002370   200005 236100                    LDQ     STOP_TIME,,AUTO
         9 002371   000436 116000 7                  CMPQ    ERRLOG_DATE
         9 002372   002643 602000 9                  TNC     s:9509

      976     9445    3                 CALL THG$OPENXSA(ERRLOG_DATE) ALTRET(NO_FILE2);

   9445  9 002373   000127 630400 10                 EPPR0   87
         9 002374   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002375   000000 701000 xent               TSX1    THG$OPENXSA
         9 002376   002634 702000 9                  TSX2    NO_FILE2

      977     9446    4                 IF CODE = %ALL THEN DO;

   9446  9 002377   200360 235100                    LDA     CODE,,AUTO
         9 002400   000016 115007                    CMPA    14,DL
         9 002401   002410 601000 9                  TNZ     s:9450

      978     9447    4                    TH_NUM_REP_DEVS = 1;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:156  
   9447  9 002402   000001 236007                    LDQ     1,DL
         9 002403   000000 756000 xsym               STQ     TH_NUM_REP_DEVS

      979     9448    4                    TH_REP_DEVS(0) = ' ';

   9448  9 002404   000035 235000 xsym               LDA     B_VECTNIL+29
         9 002405   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 002406   000000 755000 xsym               STA     TH_REP_DEVS
         9 002407   000001 756000 xsym               STQ     TH_REP_DEVS+1

      980     9449    4                    END;  /* IF CODE = %ALL */

      981     9450    4                 DO J = 0 TO TH_NUM_REP_DEVS - 1;

   9450  9 002410   200364 450100                    STZ     J,,AUTO
         9 002411   002631 710000 9                  TRA     s:9505+3

      982     9451    4                    TH_CONSTRAINTS.DEVNM = TH_REP_DEVS(J);

   9451  9 002412   200364 235100                    LDA     J,,AUTO
         9 002413   000003 735000                    ALS     3
         9 002414   040000 100405                    MLR     fill='040'O
         9 002415   000000 000010 xsym               ADSC9   TH_REP_DEVS,A            cn=0,n=8
         9 002416   000010 000010 xsym               ADSC9   TH_CONSTRAINTS+8         cn=0,n=8

      983     9452    4                    IF TH_CONSTRAINTS.DEVNM ~= ' '

   9452  9 002417   000010 237000 xsym               LDAQ    TH_CONSTRAINTS+8
         9 002420   000130 117000 10                 CMPAQ   88
         9 002421   002425 600000 9                  TZE     s:9454

      984     9453    4                    THEN TH_CHECK_DEVNM = '1'B;

   9453  9 002422   400000 236003                    LDQ     -131072,DU
         9 002423   000000 756000 xsym               STQ     TH_CHECK_DEVNM
         9 002424   002426 710000 9                  TRA     s:9455

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:157  
      985     9454    4                    ELSE TH_CHECK_DEVNM = '0'B;

   9454  9 002425   000000 450000 xsym               STZ     TH_CHECK_DEVNM

      986     9455    4                    EOF_FLAG = %FALSE;

   9455  9 002426   203005 450100                    STZ     EOF_FLAG,,AUTO

      987     9456    4            CALL THG$PRECORDXSA(TH_CONSTRAINTS.START);

   9456  9 002427   000015 630400 10                 EPPR0   13
         9 002430   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002431   000000 701000 xent               TSX1    THG$PRECORDXSA
         9 002432   000000 011000                    NOP     0

      988     9457    5                    DO WHILE(NOT EOF_FLAG);

   9457  9 002433   002624 710000 9                  TRA     s:9504

      989     9458    5                       CALL THG$GETREC(%ERRLOG) ALTRET(EOF);

   9458  9 002434   000132 630400 10                 EPPR0   90
         9 002435   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002436   000000 701000 xent               TSX1    THG$GETREC
         9 002437   002622 702000 9                  TSX2    EOF

      990     9459    5                       NUM_RECS = NUM_RECS + 1;

   9459  9 002440   200373 054100                    AOS     NUM_RECS,,AUTO

      991     9460    5                       INFO$ = ADDR(RECORD.INFO);

   9460  9 002441   000001 236000 xsym               LDQ     TH_RECORD+1
         9 002442   000005 036003                    ADLQ    5,DU
         9 002443   203002 756100                    STQ     INFO$,,AUTO

      992     9461    5                       RECORD_TYPE = RECORD.TYPE;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:158  

   9461  9 002444   000001 470400 xsym               LDP0    TH_RECORD+1
         9 002445   000000 236100                    LDQ     0,,PR0
         9 002446   000033 772000                    QRL     27
         9 002447   200444 756100                    STQ     RECORD_TYPE,,AUTO

      993     9462    6                       DO K = 1 TO NUM_TYPES;

   9462  9 002450   000001 235007                    LDA     1,DL
         9 002451   200365 755100                    STA     K,,AUTO
         9 002452   002464 710000 9                  TRA     s:9467+1

      994     9463    7                          IF TYPES(K) = RECORD_TYPE THEN DO;

   9463  9 002453   200365 720100                    LXL0    K,,AUTO
         9 002454   200376 236110                    LDQ     TYPES,X0,AUTO
         9 002455   200444 116100                    CMPQ    RECORD_TYPE,,AUTO
         9 002456   002463 601000 9                  TNZ     s:9467

      995     9464    7                             TYPE_CNT(K) = TYPE_CNT(K) + 1;

   9464  9 002457   200446 235110                    LDA     TYPE_CNT,X0,AUTO
         9 002460   000001 035007                    ADLA    1,DL
         9 002461   200446 755110                    STA     TYPE_CNT,X0,AUTO

      996     9465    7                             GOTO FOUND_TYPE;

   9465  9 002462   002475 710000 9                  TRA     FOUND_TYPE

      997     9466    7                             END;  /* IF */
      998     9467    6                          END;  /* DO K */

   9467  9 002463   200365 054100                    AOS     K,,AUTO
         9 002464   200365 236100                    LDQ     K,,AUTO
         9 002465   200374 116100                    CMPQ    NUM_TYPES,,AUTO
         9 002466   002453 604400 9                  TMOZ    s:9463

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:159  
      999     9468    5                          NUM_TYPES = NUM_TYPES + 1;

   9468  9 002467   200374 054100                    AOS     NUM_TYPES,,AUTO

     1000     9469    5                          TYPES(NUM_TYPES) = RECORD_TYPE;

   9469  9 002470   200374 720100                    LXL0    NUM_TYPES,,AUTO
         9 002471   200444 235100                    LDA     RECORD_TYPE,,AUTO
         9 002472   200376 755110                    STA     TYPES,X0,AUTO

     1001     9470    5                          TYPE_CNT(NUM_TYPES) = 1;

   9470  9 002473   000001 235007                    LDA     1,DL
         9 002474   200446 755110                    STA     TYPE_CNT,X0,AUTO

   9470  9 002475                       FOUND_TYPE   null
     1002     9471    5   FOUND_TYPE: ;
     1003     9472    6                        IF RECORD.TYPE = EL_MOUNT THEN DO;
              9472                                 /* if record's mount errors */

   9472  9 002475   000001 470400 xsym               LDP0    TH_RECORD+1
         9 002476   000000 236100                    LDQ     0,,PR0
         9 002477   777000 376003                    ANQ     -512,DU
         9 002500   146000 116003                    CMPQ    52224,DU
         9 002501   002536 601000 9                  TNZ     FOUND_MOUNT

     1004     9473    7                             DO K = 1 TO NUM_DEV;/* go through device tbl*/

   9473  9 002502   000001 235007                    LDA     1,DL
         9 002503   200365 755100                    STA     K,,AUTO
         9 002504   002520 710000 9                  TRA     s:9479+1

     1005     9474                                    /* if current device is found */
     1006     9475    8                               IF DEVNM(K) = EL$MTDMT.DEVNAME THEN DO;

   9475  9 002505   200365 235100                    LDA     K,,AUTO
         9 002506   000003 735000                    ALS     3
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:160  
         9 002507   203002 470500                    LDP0    INFO$,,AUTO
         9 002510   040100 106505                    CMPC    fill='040'O
         9 002511   200514 000010                    ADSC9   DEVNM,A,AUTO             cn=0,n=8
         9 002512   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         9 002513   002517 601000 9                  TNZ     s:9479

     1007     9476    8                                  DEV_MOUNT(K) = DEV_MOUNT(K) + 1;
              9476                                           /* increment counter*/

   9476  9 002514   200365 720100                    LXL0    K,,AUTO
         9 002515   201647 054110                    AOS     DEV_MOUNT,X0,AUTO

     1008     9477    8                                  GOTO FOUND_MOUNT;

   9477  9 002516   002536 710000 9                  TRA     FOUND_MOUNT

     1009     9478    8                               END; /* if devnm(k) = mount_devnm */
     1010     9479    7                             END;  /* do k */

   9479  9 002517   200365 054100                    AOS     K,,AUTO
         9 002520   200365 236100                    LDQ     K,,AUTO
         9 002521   200375 116100                    CMPQ    NUM_DEV,,AUTO
         9 002522   002505 604400 9                  TMOZ    s:9475

     1011     9480    6                          NUM_DEV = NUM_DEV + 1;

   9480  9 002523   200375 054100                    AOS     NUM_DEV,,AUTO

     1012     9481    6                          DEVNM(NUM_DEV) = EL$MTDMT.DEVNAME;

   9481  9 002524   200375 235100                    LDA     NUM_DEV,,AUTO
         9 002525   000001 735000                    ALS     1
         9 002526   000002 735000                    ALS     2
         9 002527   203002 470500                    LDP0    INFO$,,AUTO
         9 002530   040105 100500                    MLR     fill='040'O
         9 002531   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         9 002532   200514 000010                    ADSC9   DEVNM,A,AUTO             cn=0,n=8
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:161  

     1013     9482    6                          DEV_MOUNT(NUM_DEV) = 1;

   9482  9 002533   000001 235007                    LDA     1,DL
         9 002534   200375 720100                    LXL0    NUM_DEV,,AUTO
         9 002535   201647 755110                    STA     DEV_MOUNT,X0,AUTO

   9482  9 002536                       FOUND_MOUNT  null
     1014     9483    6   FOUND_MOUNT: ;
     1015     9484    6                        END; /* if record.type = el_mount */

     1016     9485    6                       IF RECORD.TYPE = EL_IOERR THEN DO;

   9485  9 002536   000001 470400 xsym               LDP0    TH_RECORD+1
         9 002537   000000 236100                    LDQ     0,,PR0
         9 002540   777000 376003                    ANQ     -512,DU
         9 002541   311000 116003                    CMPQ    102912,DU
         9 002542   002621 601000 9                  TNZ     FOUND_DEVNM

     1017     9486    7                          DO K = 1 TO NUM_DEV;

   9486  9 002543   000001 235007                    LDA     1,DL
         9 002544   200365 755100                    STA     K,,AUTO
         9 002545   002575 710000 9                  TRA     s:9493+1

     1018     9487    8                             IF DEVNM(K) = EL$IOERR.DEVNM THEN DO;

   9487  9 002546   200365 235100                    LDA     K,,AUTO
         9 002547   000003 735000                    ALS     3
         9 002550   203002 470500                    LDP0    INFO$,,AUTO
         9 002551   040100 106505                    CMPC    fill='040'O
         9 002552   200514 000010                    ADSC9   DEVNM,A,AUTO             cn=0,n=8
         9 002553   000024 000010                    ADSC9   20,,PR0                  cn=0,n=8
         9 002554   002574 601000 9                  TNZ     s:9493

     1019     9488    8                                DEV_CNT(K) = DEV_CNT(K) + EL$IOERR.COUNT;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:162  
   9488  9 002555   200365 720100                    LXL0    K,,AUTO
         9 002556   000005 236100                    LDQ     5,,PR0
         9 002557   000777 376007                    ANQ     511,DL
         9 002560   201336 036110                    ADLQ    DEV_CNT,X0,AUTO
         9 002561   201336 756110                    STQ     DEV_CNT,X0,AUTO

     1020     9489    8                                CONNECTS(K) = CONNECTS(K) + EL$IOERR.CONNECTS.DEVICE;
              9489                                         /*add connects*/

   9489  9 002562   000007 236100                    LDQ     7,,PR0
         9 002563   777777 376007                    ANQ     -1,DL
         9 002564   202160 036110                    ADLQ    CONNECTS,X0,AUTO
         9 002565   202160 756110                    STQ     CONNECTS,X0,AUTO

     1021     9490    8                                ERRORS(K) = ERRORS(K) + EL$IOERR.ERRCT;

   9490  9 002566   000005 236100                    LDQ     5,,PR0
         9 002567   000011 772000                    QRL     9
         9 002570   000777 376007                    ANQ     511,DL
         9 002571   202471 036110                    ADLQ    ERRORS,X0,AUTO
         9 002572   202471 756110                    STQ     ERRORS,X0,AUTO

     1022     9491    8                                GOTO FOUND_DEVNM;

   9491  9 002573   002621 710000 9                  TRA     FOUND_DEVNM

     1023     9492    8                                END;  /* IF */
     1024     9493    7                             END;  /* DO K */

   9493  9 002574   200365 054100                    AOS     K,,AUTO
         9 002575   200365 236100                    LDQ     K,,AUTO
         9 002576   200375 116100                    CMPQ    NUM_DEV,,AUTO
         9 002577   002546 604400 9                  TMOZ    s:9487

     1025     9494    6                             NUM_DEV = NUM_DEV + 1;

   9494  9 002600   200375 054100                    AOS     NUM_DEV,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:163  

     1026     9495    6                             DEVNM(NUM_DEV) = EL$IOERR.DEVNM;

   9495  9 002601   200375 235100                    LDA     NUM_DEV,,AUTO
         9 002602   000001 735000                    ALS     1
         9 002603   000002 735000                    ALS     2
         9 002604   203002 470500                    LDP0    INFO$,,AUTO
         9 002605   040105 100500                    MLR     fill='040'O
         9 002606   000024 000010                    ADSC9   20,,PR0                  cn=0,n=8
         9 002607   200514 000010                    ADSC9   DEVNM,A,AUTO             cn=0,n=8

     1027     9496    6                             DEV_CNT(NUM_DEV) = 1;/* set device counter*/

   9496  9 002610   000001 235007                    LDA     1,DL
         9 002611   200375 720100                    LXL0    NUM_DEV,,AUTO
         9 002612   201336 755110                    STA     DEV_CNT,X0,AUTO

     1028     9497    6                             CONNECTS(NUM_DEV) = EL$IOERR.CONNECTS.DEVICE;

   9497  9 002613   000007 236100                    LDQ     7,,PR0
         9 002614   777777 376007                    ANQ     -1,DL
         9 002615   202160 756110                    STQ     CONNECTS,X0,AUTO

     1029     9498    6                             ERRORS(NUM_DEV) = EL$IOERR.COUNT;

   9498  9 002616   000005 236100                    LDQ     5,,PR0
         9 002617   000777 376007                    ANQ     511,DL
         9 002620   202471 756110                    STQ     ERRORS,X0,AUTO

   9498  9 002621                       FOUND_DEVNM  null
     1030     9499    6   FOUND_DEVNM: ;
     1031     9500    6                          END;  /* IF RECORD.TYPE = EL_IOERR */

     1032     9501    6                       DO NEVER;

   9501  9 002621   002624 710000 9                  TRA     s:9504

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:164  
     1033     9502    6                 EOF:     EOF_FLAG = %TRUE;

   9502  9 002622   400000 236003       EOF          LDQ     -131072,DU
         9 002623   203005 756100                    STQ     EOF_FLAG,,AUTO

     1034     9503    6                          END;  /* DO NEVER */

     1035     9504    5                       END;  /* DO WHILE NOT EOF_FLAG */

   9504  9 002624   203005 234100                    SZN     EOF_FLAG,,AUTO
         9 002625   002434 605000 9                  TPL     s:9458

     1036     9505    4                    END;  /* DO J = 0 TO TH_NUM_REP_DEVS - 1 */

   9505  9 002626   200364 235100                    LDA     J,,AUTO
         9 002627   000001 035007                    ADLA    1,DL
         9 002630   200364 755100                    STA     J,,AUTO
         9 002631   200364 236100                    LDQ     J,,AUTO
         9 002632   000000 116000 xsym               CMPQ    TH_NUM_REP_DEVS
         9 002633   002412 602000 9                  TNC     s:9451

     1037     9506    3   NO_FILE2:
     1038     9507    3                 CALL XUD$UTS_ADJ_25TH(ERRLOG_DATE, ERRLOG_DATE, %UTS_25TH_DAY#);

   9507  9 002634   000156 630400 10    NO_FILE2     EPPR0   110
         9 002635   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002636   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 002637   000000 011000                    NOP     0

     1039     9508    3                 END;  /* DO WHILE (ERRLOG_DATE <= STOP)  */

   9508  9 002640   200005 236100                    LDQ     STOP_TIME,,AUTO
         9 002641   000436 116000 7                  CMPQ    ERRLOG_DATE
         9 002642   002373 603000 9                  TRC     s:9445

     1040     9509    2              CALL THG$CLOSEXSA;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:165  
   9509  9 002643   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002644   000000 701000 xent               TSX1    THG$CLOSEXSA
         9 002645   000000 011000                    NOP     0

     1041     9510    3              IF NUM_TYPES > 0 THEN DO;

   9510  9 002646   200374 235100                    LDA     NUM_TYPES,,AUTO
         9 002647   002750 604400 9                  TMOZ    s:9524

     1042     9511    3                 CALL THW$WRITE(VECTOR(SUM_FMT));

   9511  9 002650   000164 630400 10                 EPPR0   116
         9 002651   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002652   000000 701000 xent               TSX1    THW$WRITE
         9 002653   000000 011000                    NOP     0

     1043     9512    4                 DO I = 1 TO NUM_TYPES;

   9512  9 002654   000001 235007                    LDA     1,DL
         9 002655   200363 755100                    STA     I,,AUTO
         9 002656   002744 710000 9                  TRA     s:9522+3

     1044     9513    4                    TEXT$ = ADDR(TEXTBUF);

   9513  9 002657   000003 236000 10                 LDQ     3
         9 002660   200006 756100                    STQ     TEXT$,,AUTO

     1045     9514    4                    TYPEB = TYPES(I);

   9514  9 002661   200363 720100                    LXL0    I,,AUTO
         9 002662   200376 235110                    LDA     TYPES,X0,AUTO
         9 002663   000033 735000                    ALS     27
         9 002664   200445 755100                    STA     TYPEB,,AUTO

     1046     9515    4                    CALL THC$TYPENAME(TYPEB,TEMP_BUF,COUNT);

   9515  9 002665   203003 630500                    EPPR0   COUNT,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:166  
         9 002666   203012 450500                    STP0    EOF_FLAG+5,,AUTO
         9 002667   000005 236000 10                 LDQ     5
         9 002670   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 002671   200445 631500                    EPPR1   TYPEB,,AUTO
         9 002672   203010 451500                    STP1    EOF_FLAG+3,,AUTO
         9 002673   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002674   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002675   000000 701000 xent               TSX1    THC$TYPENAME
         9 002676   000000 011000                    NOP     0

     1047     9516    4                    CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF,COUNT);

   9516  9 002677   203003 630500                    EPPR0   COUNT,,AUTO
         9 002700   203012 450500                    STP0    EOF_FLAG+5,,AUTO
         9 002701   000005 236000 10                 LDQ     5
         9 002702   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 002703   200006 631500                    EPPR1   TEXT$,,AUTO
         9 002704   203010 451500                    STP1    EOF_FLAG+3,,AUTO
         9 002705   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 002706   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002707   000000 701000 xent               TSX1    THF$ADD_TEXTC
         9 002710   000000 011000                    NOP     0

     1048     9517    4                    TVEC = VECTOR(TEXTBUF);

   9517  9 002711   000006 237000 10                 LDAQ    6
         9 002712   200010 757100                    STAQ    TVEC,,AUTO

     1049     9518    4                    TVEC.BOUND = COUNT;

   9518  9 002713   203003 236100                    LDQ     COUNT,,AUTO
         9 002714   000020 736000                    QLS     16
         9 002715   200010 676100                    ERQ     TVEC,,AUTO
         9 002716   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 002717   200010 656100                    ERSQ    TVEC,,AUTO

     1050     9519    4                    CALL THW$WRITE(VECTOR(SUM_ENTRY),
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:167  

   9519  9 002720   777640 235007                    LDA     -96,DL
         9 002721   203010 452500                    STP2    EOF_FLAG+3,,AUTO
         9 002722   200363 236100                    LDQ     I,,AUTO
         9 002723   000022 736000                    QLS     18
         9 002724   000446 036003                    ADLQ    294,DU
         9 002725   203010 036100                    ADLQ    EOF_FLAG+3,,AUTO
         9 002726   203012 757100                    STAQ    EOF_FLAG+5,,AUTO
         9 002727   203012 630500                    EPPR0   EOF_FLAG+5,,AUTO
         9 002730   203016 450500                    STP0    EOF_FLAG+9,,AUTO
         9 002731   200010 631500                    EPPR1   TVEC,,AUTO
         9 002732   203015 451500                    STP1    EOF_FLAG+8,,AUTO
         9 002733   000170 236000 10                 LDQ     120
         9 002734   203014 756100                    STQ     EOF_FLAG+7,,AUTO
         9 002735   203014 630500                    EPPR0   EOF_FLAG+7,,AUTO
         9 002736   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002737   000000 701000 xent               TSX1    THW$WRITE
         9 002740   000000 011000                    NOP     0

     1051     9520    4                                   TVEC,
     1052     9521    4                                   VECTOR(TYPE_CNT(I)));
     1053     9522    4                    END;  /* DO I */

   9522  9 002741   200363 235100                    LDA     I,,AUTO
         9 002742   000001 035007                    ADLA    1,DL
         9 002743   200363 755100                    STA     I,,AUTO
         9 002744   200363 236100                    LDQ     I,,AUTO
         9 002745   002750 604000 9                  TMI     s:9524
         9 002746   200374 116100                    CMPQ    NUM_TYPES,,AUTO
         9 002747   002657 604400 9                  TMOZ    s:9513

     1054     9523    3                 END;  /* IF NUM_TYPES > 0 */

     1055     9524    3              IF NUM_DEV > 0 THEN DO;

   9524  9 002750   200375 235100                    LDA     NUM_DEV,,AUTO
         9 002751   003100 604400 9                  TMOZ    s:9534
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:168  

     1056     9525    3                 CALL THW$WRITE(DEV_HDR);

   9525  9 002752   000171 630400 10                 EPPR0   121
         9 002753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002754   000000 701000 xent               TSX1    THW$WRITE
         9 002755   000000 011000                    NOP     0

     1057     9526    4                 DO I = 1 TO NUM_DEV;

   9526  9 002756   000001 235007                    LDA     1,DL
         9 002757   200363 755100                    STA     I,,AUTO
         9 002760   003074 710000 9                  TRA     s:9532+3

     1058     9527    4                   IF ((TH_CONSTRAINTS.NTYPES = 0)AND((DEV_CNT(I) > 0)OR(CONNECTS(I) >
              9527                            0)OR(ERRORS(I) > 0)))

   9527  9 002761   000000 235000 xsym               LDA     TH_CONSTRAINTS
         9 002762   002772 601000 9                  TNZ     s:9527+9
         9 002763   200363 720100                    LXL0    I,,AUTO
         9 002764   201336 235110                    LDA     DEV_CNT,X0,AUTO
         9 002765   002774 605400 9                  TPNZ    s:9529
         9 002766   202160 235110                    LDA     CONNECTS,X0,AUTO
         9 002767   002774 605400 9                  TPNZ    s:9529
         9 002770   202471 235110                    LDA     ERRORS,X0,AUTO
         9 002771   002774 605400 9                  TPNZ    s:9529
         9 002772   000000 235000 xsym               LDA     TH_CONSTRAINTS
         9 002773   003071 604400 9                  TMOZ    s:9532

     1059     9528    4                     OR (TH_CONSTRAINTS.NTYPES > 0)THEN
     1060     9529    4                    CALL THW$WRITE(VECTOR(DEV_ENTRY),VECTOR(DEVNM(I)),

   9529  9 002774   000010 235000 10                 LDA     8
         9 002775   203010 452500                    STP2    EOF_FLAG+3,,AUTO
         9 002776   200363 236100                    LDQ     I,,AUTO
         9 002777   000023 736000                    QLS     19
         9 003000   000514 036003                    ADLQ    332,DU
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:169  
         9 003001   203010 036100                    ADLQ    EOF_FLAG+3,,AUTO
         9 003002   203012 757100                    STAQ    EOF_FLAG+5,,AUTO
         9 003003   777640 235007                    LDA     -96,DL
         9 003004   203014 452500                    STP2    EOF_FLAG+7,,AUTO
         9 003005   200363 236100                    LDQ     I,,AUTO
         9 003006   000022 736000                    QLS     18
         9 003007   001336 036003                    ADLQ    734,DU
         9 003010   203014 036100                    ADLQ    EOF_FLAG+7,,AUTO
         9 003011   203016 757100                    STAQ    EOF_FLAG+9,,AUTO
         9 003012   777640 235007                    LDA     -96,DL
         9 003013   203020 452500                    STP2    EOF_FLAG+11,,AUTO
         9 003014   200363 236100                    LDQ     I,,AUTO
         9 003015   000022 736000                    QLS     18
         9 003016   002160 036003                    ADLQ    1136,DU
         9 003017   203020 036100                    ADLQ    EOF_FLAG+11,,AUTO
         9 003020   203022 757100                    STAQ    EOF_FLAG+13,,AUTO
         9 003021   777640 235007                    LDA     -96,DL
         9 003022   203024 452500                    STP2    EOF_FLAG+15,,AUTO
         9 003023   200363 236100                    LDQ     I,,AUTO
         9 003024   000022 736000                    QLS     18
         9 003025   002471 036003                    ADLQ    1337,DU
         9 003026   203024 036100                    ADLQ    EOF_FLAG+15,,AUTO
         9 003027   203026 757100                    STAQ    EOF_FLAG+17,,AUTO
         9 003030   777640 235007                    LDA     -96,DL
         9 003031   203030 452500                    STP2    EOF_FLAG+19,,AUTO
         9 003032   200363 236100                    LDQ     I,,AUTO
         9 003033   000022 736000                    QLS     18
         9 003034   001647 036003                    ADLQ    935,DU
         9 003035   203030 036100                    ADLQ    EOF_FLAG+19,,AUTO
         9 003036   203034 757100                    STAQ    EOF_FLAG+23,,AUTO
         9 003037   203012 237100                    LDAQ    EOF_FLAG+5,,AUTO
         9 003040   203032 757100                    STAQ    EOF_FLAG+21,,AUTO
         9 003041   203016 237100                    LDAQ    EOF_FLAG+9,,AUTO
         9 003042   203036 757100                    STAQ    EOF_FLAG+25,,AUTO
         9 003043   203022 237100                    LDAQ    EOF_FLAG+13,,AUTO
         9 003044   203040 757100                    STAQ    EOF_FLAG+27,,AUTO
         9 003045   203026 237100                    LDAQ    EOF_FLAG+17,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:170  
         9 003046   203042 757100                    STAQ    EOF_FLAG+29,,AUTO
         9 003047   203034 237100                    LDAQ    EOF_FLAG+23,,AUTO
         9 003050   203044 757100                    STAQ    EOF_FLAG+31,,AUTO
         9 003051   203044 630500                    EPPR0   EOF_FLAG+31,,AUTO
         9 003052   203053 450500                    STP0    EOF_FLAG+38,,AUTO
         9 003053   203042 631500                    EPPR1   EOF_FLAG+29,,AUTO
         9 003054   203052 451500                    STP1    EOF_FLAG+37,,AUTO
         9 003055   203040 633500                    EPPR3   EOF_FLAG+27,,AUTO
         9 003056   203051 453500                    STP3    EOF_FLAG+36,,AUTO
         9 003057   203036 634500                    EPPR4   EOF_FLAG+25,,AUTO
         9 003060   203050 454500                    STP4    EOF_FLAG+35,,AUTO
         9 003061   203032 635500                    EPPR5   EOF_FLAG+21,,AUTO
         9 003062   203047 455500                    STP5    EOF_FLAG+34,,AUTO
         9 003063   000174 236000 10                 LDQ     124
         9 003064   203046 756100                    STQ     EOF_FLAG+33,,AUTO
         9 003065   203046 630500                    EPPR0   EOF_FLAG+33,,AUTO
         9 003066   000024 631400 xsym               EPPR1   B_VECTNIL+20
         9 003067   000000 701000 xent               TSX1    THW$WRITE
         9 003070   000000 011000                    NOP     0

     1061     9530    4                                   VECTOR(DEV_CNT(I)),VECTOR(CONNECTS(I)),
     1062     9531    4                                   VECTOR(ERRORS(I)),VECTOR(DEV_MOUNT(I)));
     1063     9532    4                    END;  /* DO I */

   9532  9 003071   200363 235100                    LDA     I,,AUTO
         9 003072   000001 035007                    ADLA    1,DL
         9 003073   200363 755100                    STA     I,,AUTO
         9 003074   200363 236100                    LDQ     I,,AUTO
         9 003075   003100 604000 9                  TMI     s:9534
         9 003076   200375 116100                    CMPQ    NUM_DEV,,AUTO
         9 003077   002761 604400 9                  TMOZ    s:9527

     1064     9533    3                 END;  /* IF NUM_DEV > 0 */

     1065     9534    2              CALL THW$WRITE(VECTOR(SUM_TOT),VECTOR(NUM_RECS));

   9534  9 003100   777640 235007                    LDA     -96,DL
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:171  
         9 003101   203010 452500                    STP2    EOF_FLAG+3,,AUTO
         9 003102   203010 236100                    LDQ     EOF_FLAG+3,,AUTO
         9 003103   000373 036003                    ADLQ    251,DU
         9 003104   203012 757100                    STAQ    EOF_FLAG+5,,AUTO
         9 003105   203012 630500                    EPPR0   EOF_FLAG+5,,AUTO
         9 003106   203015 450500                    STP0    EOF_FLAG+8,,AUTO
         9 003107   000200 236000 10                 LDQ     128
         9 003110   203014 756100                    STQ     EOF_FLAG+7,,AUTO
         9 003111   203014 630500                    EPPR0   EOF_FLAG+7,,AUTO
         9 003112   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003113   000000 701000 xent               TSX1    THW$WRITE
         9 003114   000000 011000                    NOP     0
         9 003115   003127 710000 9                  TRA     s:9546

     1066     9535    2           CASE(%SEC);

     1067     9536                                                /* SEC CODE                           */
     1068     9537    2           CASE(%SWE);

     1069     9538                                                /* SWE CODE                           */
     1070     9539    2           CASE(%SYS);

     1071     9540    2            TH_BRKMSG = '0'B;

   9540  9 003116   000000 450000 xsym               STZ     TH_BRKMSG

     1072     9541    2              CALL THF$SYS;

   9541  9 003117   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003120   000000 701000 xent               TSX1    THF$SYS
         9 003121   000000 011000                    NOP     0
         9 003122   003127 710000 9                  TRA     s:9546

     1073     9542    2           CASE(%UPR);

     1074     9543    2            TH_BRKMSG = '0'B;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:172  
   9543  9 003123   000000 450000 xsym               STZ     TH_BRKMSG

     1075     9544    2              CALL THF$UPR;

   9544  9 003124   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003125   000000 701000 xent               TSX1    THF$UPR
         9 003126   000000 011000                    NOP     0

     1076     9545    2        END;                               /* case report code                   */

     1077     9546    1        TH_EOF_FLG = %FALSE;

   9546  9 003127   000000 450000 xsym               STZ     TH_EOF_FLG

     1078     9547    1        TH_FIRST_TIME = %TRUE;

   9547  9 003130   400000 236003                    LDQ     -131072,DU
         9 003131   000000 756000 xsym               STQ     TH_FIRST_TIME

     1079     9548    1        TH_IOERR_FLG = %FALSE;

   9548  9 003132   000000 450000 xsym               STZ     TH_IOERR_FLG

     1080     9549    1        TH_FEPERR_FLG = %FALSE;

   9549  9 003133   000000 450000 xsym               STZ     TH_FEPERR_FLG

     1081     9550    1        TH_DETAIL_FLG = %TRUE;

   9550  9 003134   000000 756000 xsym               STQ     TH_DETAIL_FLG

     1082     9551    1        TH_NUM_REP_DEVS = 0;

   9551  9 003135   000000 450000 xsym               STZ     TH_NUM_REP_DEVS

     1083     9552    1        TH_CONSTRAINTS = TH_SAVE;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:173  
   9552  9 003136   000000 100400                    MLR     fill='000'O
         9 003137   000000 000333 xsym               ADSC9   TH_SAVE                  cn=0,n=219
         9 003140   000000 000333 xsym               ADSC9   TH_CONSTRAINTS           cn=0,n=219

     1084     9553    1        IF DCBADDR(DCBNUM(M$LO))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_LO);

   9553  9 003141   000000 236007 xsym               LDQ     M$LO,DL
         9 003142   000000 470400 10                 LDP0    0
         9 003143   000000 471500                    LDP1    0,,PR0
         9 003144   100000 473506                    LDP3    0,QL,PR1
         9 003145   300031 236100                    LDQ     25,,PR3
         9 003146   020000 316007                    CANQ    8192,DL
         9 003147   003153 600000 9                  TZE     s:9554

   9553  9 003150   000756 630400 8                  EPPR0   CLOSE_LO
         9 003151   050001 713400                    CLIMB   close
         9 003152   406000 401760                    pmme    nvectors=13

     1085     9554    1        IF DCBADDR(DCBNUM(M$ONFILE))->F$DCB.FCD THEN CALL M$CLOSE(CLOSE_ONFILE);

   9554  9 003153   000000 236007 xsym               LDQ     M$ONFILE,DL
         9 003154   000000 470400 10                 LDP0    0
         9 003155   000000 471500                    LDP1    0,,PR0
         9 003156   100000 473506                    LDP3    0,QL,PR1
         9 003157   300031 236100                    LDQ     25,,PR3
         9 003160   020000 316007                    CANQ    8192,DL
         9 003161   003165 600000 9                  TZE     s:9555

   9554  9 003162   000720 630400 8                  EPPR0   CLOSE_ONFILE
         9 003163   050001 713400                    CLIMB   close
         9 003164   406000 401760                    pmme    nvectors=13

     1086     9555    2        DO NEVER;

   9555  9 003165   003171 710000 9                  TRA     s:9559

     1087     9556    2   OPN_ERR:
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:174  
     1088     9557    2           CALL THM$ERRMSG;

   9557  9 003166   000002 631400 xsym  OPN_ERR      EPPR1   B_VECTNIL+2
         9 003167   000000 701000 xent               TSX1    THM$ERRMSG
         9 003170   000000 011000                    NOP     0

     1089     9558    2        END;                               /* do never                           */

     1090     9559    2   DO NEVER;

   9559  9 003171   003175 710000 9                  TRA     NO_REPORT

     1091     9560    2   PMME_ERR: CALL THM$ERRMSG;

   9560  9 003172   000002 631400 xsym  PMME_ERR     EPPR1   B_VECTNIL+2
         9 003173   000000 701000 xent               TSX1    THM$ERRMSG
         9 003174   000000 011000                    NOP     0

     1092     9561    2   END;

     1093     9562    1   NO_REPORT:
     1094     9563    1        RETURN;

   9563  9 003175   000000 702200 xent  NO_REPORT    TSX2  ! X66_ARET

     1095     9564    1   FID_ERR:
     1096     9565    1        CALL THM$ERRMSG;

   9565  9 003176   000002 631400 xsym  FID_ERR      EPPR1   B_VECTNIL+2
         9 003177   000000 701000 xent               TSX1    THM$ERRMSG
         9 003200   000000 011000                    NOP     0

     1097     9566    1        RETURN;

   9566  9 003201   000000 702200 xent               TSX2  ! X66_ARET

     1098     9567        %EJECT;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:175  
     1099     9568        /* INTERNAL PROC TO PROCESS ERRLOG FILE FOR DETAIL REPORT */
     1100     9569    1   THC$DETAIL: PROC;

   9569  9 003202   203006 741300       THC$DETAIL   STX1  ! EOF_FLAG+1,,AUTO

     1101     9570        /**/
     1102     9571    2      TH_EOF_FLG = %FALSE;

   9571  9 003203   000000 450000 xsym               STZ     TH_EOF_FLG

     1103     9572    2      TH_FIRST_TIME = %TRUE;

   9572  9 003204   400000 236003                    LDQ     -131072,DU
         9 003205   000000 756000 xsym               STQ     TH_FIRST_TIME

     1104     9573    2      TH_IOERR_FLG = %FALSE;

   9573  9 003206   000000 450000 xsym               STZ     TH_IOERR_FLG

     1105     9574    2      TH_FEPERR_FLG = %FALSE;

   9574  9 003207   000000 450000 xsym               STZ     TH_FEPERR_FLG

     1106     9575    2      TH_DETAIL_FLG = %TRUE;

   9575  9 003210   000000 756000 xsym               STQ     TH_DETAIL_FLG

     1107     9576    2      OLD_FEPERR_TIME = ' ';

   9576  9 003211   040000 100400                    MLR     fill='040'O
         9 003212   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003213   000422 000013 7                  ADSC9   OLD_FEPERR_TIME          cn=0,n=11

     1108     9577    2      NEW_FEPERR_TIME= ' ';

   9577  9 003214   040000 100400                    MLR     fill='040'O
         9 003215   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:176  
         9 003216   000430 000013 7                  ADSC9   NEW_FEPERR_TIME          cn=0,n=11

     1109     9578    2      OLD_IOERR_TIME = ' ';

   9578  9 003217   040000 100400                    MLR     fill='040'O
         9 003220   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003221   000425 000013 7                  ADSC9   OLD_IOERR_TIME           cn=0,n=11

     1110     9579    2      NEW_IOERR_TIME = ' ';

   9579  9 003222   040000 100400                    MLR     fill='040'O
         9 003223   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003224   000433 000013 7                  ADSC9   NEW_IOERR_TIME           cn=0,n=11

     1111     9580    2      NUM_IOERR_REC = 0;

   9580  9 003225   200371 450100                    STZ     NUM_IOERR_REC,,AUTO

     1112     9581    2      NUM_FEPERR = 0;

   9581  9 003226   200372 450100                    STZ     NUM_FEPERR,,AUTO

     1113     9582    2      MEMORY_ERRORS = %FALSE;

   9582  9 003227   200370 450100                    STZ     MEMORY_ERRORS,,AUTO

     1114     9583    2   CALL XUD$UTS_DIFF_SEC (START_TIME, TH_CONSTRAINTS.START, 0);

   9583  9 003230   000125 236000 10                 LDQ     85
         9 003231   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 003232   000015 236000 10                 LDQ     13
         9 003233   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 003234   200004 630500                    EPPR0   START_TIME,,AUTO
         9 003235   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 003236   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 003237   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003240   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:177  
         9 003241   000000 011000                    NOP     0

     1115     9584    2   START_TIME = START_TIME / 86400;

   9584  9 003242   200004 236100                    LDQ     START_TIME,,AUTO
         9 003243   000001 772000                    QRL     1
         9 003244   124300 506007                    DIV     43200,DL
         9 003245   200004 756100                    STQ     START_TIME,,AUTO

     1116     9585    2   CALL XUD$UTS_ADJ_25TH (START_TIME, 0, START_TIME*%UTS_25TH_DAY#);

   9585  9 003246   000126 402000 10                 MPY     86
         9 003247   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 003250   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 003251   203013 450500                    STP0    EOF_FLAG+6,,AUTO
         9 003252   000125 236000 10                 LDQ     85
         9 003253   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 003254   200004 631500                    EPPR1   START_TIME,,AUTO
         9 003255   203011 451500                    STP1    EOF_FLAG+4,,AUTO
         9 003256   203011 630500                    EPPR0   EOF_FLAG+4,,AUTO
         9 003257   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003260   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 003261   000000 011000                    NOP     0

     1117     9586    2   CALL XUD$UTS_DIFF_SEC (STOP_TIME, TH_CONSTRAINTS.STOP, 0);

   9586  9 003262   000125 236000 10                 LDQ     85
         9 003263   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 003264   000017 236000 10                 LDQ     15
         9 003265   203011 756100                    STQ     EOF_FLAG+4,,AUTO
         9 003266   200005 630500                    EPPR0   STOP_TIME,,AUTO
         9 003267   203010 450500                    STP0    EOF_FLAG+3,,AUTO
         9 003270   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 003271   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003272   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         9 003273   000000 011000                    NOP     0

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:178  
     1118     9587    2   STOP_TIME = STOP_TIME / 86400;

   9587  9 003274   200005 236100                    LDQ     STOP_TIME,,AUTO
         9 003275   000001 772000                    QRL     1
         9 003276   124300 506007                    DIV     43200,DL
         9 003277   200005 756100                    STQ     STOP_TIME,,AUTO

     1119     9588    2   CALL XUD$UTS_ADJ_25TH (STOP_TIME, 0, STOP_TIME*%UTS_25TH_DAY#);

   9588  9 003300   000126 402000 10                 MPY     86
         9 003301   203010 756100                    STQ     EOF_FLAG+3,,AUTO
         9 003302   203010 630500                    EPPR0   EOF_FLAG+3,,AUTO
         9 003303   203013 450500                    STP0    EOF_FLAG+6,,AUTO
         9 003304   000125 236000 10                 LDQ     85
         9 003305   203012 756100                    STQ     EOF_FLAG+5,,AUTO
         9 003306   200005 631500                    EPPR1   STOP_TIME,,AUTO
         9 003307   203011 451500                    STP1    EOF_FLAG+4,,AUTO
         9 003310   203011 630500                    EPPR0   EOF_FLAG+4,,AUTO
         9 003311   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003312   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 003313   000000 011000                    NOP     0

     1120     9589    2   ERRLOG_DATE = START_TIME;

   9589  9 003314   200004 235100                    LDA     START_TIME,,AUTO
         9 003315   000436 755000 7                  STA     ERRLOG_DATE

     1121     9590    3   DO WHILE (ERRLOG_DATE <= STOP_TIME);

   9590  9 003316   200005 236100                    LDQ     STOP_TIME,,AUTO
         9 003317   000436 116000 7                  CMPQ    ERRLOG_DATE
         9 003320   003660 602000 9                  TNC     s:9677

     1122     9591    3             NUM_RECS = 0;

   9591  9 003321   200373 450100                    STZ     NUM_RECS,,AUTO

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:179  
     1123     9592    3     CALL THG$OPENXSA(ERRLOG_DATE) ALTRET(FILE_NO);

   9592  9 003322   000127 630400 10                 EPPR0   87
         9 003323   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 003324   000000 701000 xent               TSX1    THG$OPENXSA
         9 003325   003655 702000 9                  TSX2    FILE_NO

     1124     9593    3     CALL M$TIME(EXT_DATE);

   9593  9 003326   000670 630400 8                  EPPR0   EXT_DATE
         9 003327   020004 713400                    CLIMB   8196
         9 003330   402000 401760                    pmme    nvectors=5

     1125     9594    4     IF CODE = %ALL THEN DO;

   9594  9 003331   200360 235100                    LDA     CODE,,AUTO
         9 003332   000016 115007                    CMPA    14,DL
         9 003333   003342 601000 9                  TNZ     s:9599

     1126     9595    4        TH_NUM_REP_DEVS = 1;

   9595  9 003334   000001 236007                    LDQ     1,DL
         9 003335   000000 756000 xsym               STQ     TH_NUM_REP_DEVS

     1127     9596    4        TH_REP_DEVS(0) = ' ';

   9596  9 003336   000035 235000 xsym               LDA     B_VECTNIL+29
         9 003337   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 003340   000000 755000 xsym               STA     TH_REP_DEVS
         9 003341   000001 756000 xsym               STQ     TH_REP_DEVS+1

     1128     9597    4     END;

     1129     9598
     1130     9599    4        DO I = 0 TO TH_NUM_REP_DEVS - 1;

   9599  9 003342   200363 450100                    STZ     I,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:180  
         9 003343   003646 710000 9                  TRA     s:9674+3

     1131     9600    4          TH_CONSTRAINTS.DEVNM = TH_REP_DEVS(I);

   9600  9 003344   200363 235100                    LDA     I,,AUTO
         9 003345   000003 735000                    ALS     3
         9 003346   040000 100405                    MLR     fill='040'O
         9 003347   000000 000010 xsym               ADSC9   TH_REP_DEVS,A            cn=0,n=8
         9 003350   000010 000010 xsym               ADSC9   TH_CONSTRAINTS+8         cn=0,n=8

     1132     9601    4          IF TH_CONSTRAINTS.DEVNM ~= ' '

   9601  9 003351   000010 237000 xsym               LDAQ    TH_CONSTRAINTS+8
         9 003352   000130 117000 10                 CMPAQ   88
         9 003353   003357 600000 9                  TZE     s:9603

     1133     9602    4          THEN TH_CHECK_DEVNM = '1'B;

   9602  9 003354   400000 236003                    LDQ     -131072,DU
         9 003355   000000 756000 xsym               STQ     TH_CHECK_DEVNM
         9 003356   003360 710000 9                  TRA     s:9604

     1134     9603    4          ELSE TH_CHECK_DEVNM = '0'B;

   9603  9 003357   000000 450000 xsym               STZ     TH_CHECK_DEVNM

     1135     9604    4          EOF_FLAG = %FALSE;

   9604  9 003360   203005 450100                    STZ     EOF_FLAG,,AUTO

     1136     9605    4          CALL THG$PRECORDXSA(TH_CONSTRAINTS.START);

   9605  9 003361   000015 630400 10                 EPPR0   13
         9 003362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 003363   000000 701000 xent               TSX1    THG$PRECORDXSA
         9 003364   000000 011000                    NOP     0

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:181  
     1137     9606    4          CALL M$OPEN(OPEN_ERRLOG2);

   9606  9 003365   000452 630400 7                  EPPR0   OPEN_ERRLOG2
         9 003366   050000 713400                    CLIMB   open
         9 003367   410400 401760                    pmme    nvectors=18

     1138     9607    4          CALL M$OPEN(OPEN_ERRLOG4);

   9607  9 003370   001162 630400 7                  EPPR0   OPEN_ERRLOG4
         9 003371   050000 713400                    CLIMB   open
         9 003372   410400 401760                    pmme    nvectors=18

     1139     9608    5        DO WHILE(NOT EOF_FLAG);

   9608  9 003373   003641 710000 9                  TRA     s:9673

     1140     9609    5          CALL THG$GETREC(%ERRLOG) ALTRET(LBL_EOF);
              9609                   /* get one record from errlog file */

   9609  9 003374   000132 630400 10                 EPPR0   90
         9 003375   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 003376   000000 701000 xent               TSX1    THG$GETREC
         9 003377   003637 702000 9                  TSX2    LBL_EOF

     1141     9610    5          CALL M$TIME(RECORD_DATE);/* get time of error occurrence */

   9610  9 003400   000654 630400 8                  EPPR0   RECORD_DATE
         9 003401   020004 713400                    CLIMB   8196
         9 003402   402000 401760                    pmme    nvectors=5

     1142     9611    5            INFO$ = ADDR(RECORD.INFO);  /* assign EL$IOERR frame to input buffer */

   9611  9 003403   000001 236000 xsym               LDQ     TH_RECORD+1
         9 003404   000005 036003                    ADLQ    5,DU
         9 003405   203002 756100                    STQ     INFO$,,AUTO

     1143     9612    5            WRITE_ERRLOG4.BUF_.BOUND = TH_RECORD.BOUND;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:182  

   9612  9 003406   000000 236000 xsym               LDQ     TH_RECORD
         9 003407   001316 676000 7                  ERQ     WRITE_ERRLOG4+4
         9 003410   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 003411   001316 656000 7                  ERSQ    WRITE_ERRLOG4+4

     1144     9613    5            WRITE_ERRLOG4.BUF_.BUF$ = INFO$;

   9613  9 003412   203002 236100                    LDQ     INFO$,,AUTO
         9 003413   001317 756000 7                  STQ     WRITE_ERRLOG4+5

     1145     9614    5            WRITE_ERRLOG2.BUF_.BOUND = TH_RECORD.BOUND; /* assign vectors  bound */

   9614  9 003414   000000 236000 xsym               LDQ     TH_RECORD
         9 003415   000606 676000 7                  ERQ     WRITE_ERRLOG2+4
         9 003416   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 003417   000606 656000 7                  ERSQ    WRITE_ERRLOG2+4

     1146     9615    5            WRITE_ERRLOG2.BUF_.BUF$ = INFO$; /* assign vector's pointer */

   9615  9 003420   203002 236100                    LDQ     INFO$,,AUTO
         9 003421   000607 756000 7                  STQ     WRITE_ERRLOG2+5

     1147     9616    5              IF TH_FIRST_TIME AND (TH_ITYPE = %TH_IOERR OR TH_ITYPE = %TH_FEPERR)
              9616                       /*if first rec is ioerr or feperr */

   9616  9 003422   000000 234000 xsym               SZN     TH_FIRST_TIME
         9 003423   003465 605000 9                  TPL     s:9632
         9 003424   000000 235000 xsym               LDA     TH_ITYPE
         9 003425   000022 115007                    CMPA    18,DL
         9 003426   003431 600000 9                  TZE     s:9618
         9 003427   000024 115007                    CMPA    20,DL
         9 003430   003465 601000 9                  TNZ     s:9632

     1148     9617    6              THEN DO;

     1149     9618    7                DO CASE(TH_ITYPE);
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:183  

   9618  9 003431   000022 135007                    SBLA    18,DL
         9 003432   000003 115007                    CMPA    3,DL
         9 003433   003435 602005 9                  TNC     s:9618+4,AL
         9 003434   003463 710000 9                  TRA     s:9630
         9 003435   003440 710000 9                  TRA     s:9620
         9 003436   003463 710000 9                  TRA     s:9630
         9 003437   003452 710000 9                  TRA     s:9625

     1150     9619    7                   CASE(%TH_IOERR);/* if ioerr record was fetched */

     1151     9620    7                       NUM_IOERR_REC = NUM_IOERR_REC + 1;/*increment counter*/

   9620  9 003440   200371 054100                    AOS     NUM_IOERR_REC,,AUTO

     1152     9621    7                       CALL M$WRITE(WRITE_ERRLOG2);/* write record to file*/

   9621  9 003441   000602 630400 7                  EPPR0   WRITE_ERRLOG2
         9 003442   040001 713400                    CLIMB   write
         9 003443   401400 401760                    pmme    nvectors=4

     1153     9622    7                       OLD_IOERR_DATE = ERRLOG_DATE;

   9622  9 003444   000436 235000 7                  LDA     ERRLOG_DATE
         9 003445   000417 755000 7                  STA     OLD_IOERR_DATE

     1154     9623    7                       OLD_IOERR_TIME = TH_TIME;

   9623  9 003446   040000 100400                    MLR     fill='040'O
         9 003447   000000 000013 xsym               ADSC9   TH_TIME                  cn=0,n=11
         9 003450   000425 000013 7                  ADSC9   OLD_IOERR_TIME           cn=0,n=11
         9 003451   003463 710000 9                  TRA     s:9630

     1155     9624    7                   CASE(%TH_FEPERR);/* if feperr record was fetched*/

     1156     9625    7                       NUM_FEPERR = NUM_FEPERR + 1;/*increment counter*/

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:184  
   9625  9 003452   200372 054100                    AOS     NUM_FEPERR,,AUTO

     1157     9626    7                       CALL M$WRITE(WRITE_ERRLOG4);/* write to file*/

   9626  9 003453   001312 630400 7                  EPPR0   WRITE_ERRLOG4
         9 003454   040001 713400                    CLIMB   write
         9 003455   401400 401760                    pmme    nvectors=4

     1158     9627    7                       OLD_FEPERR_DATE = ERRLOG_DATE;

   9627  9 003456   000436 235000 7                  LDA     ERRLOG_DATE
         9 003457   000416 755000 7                  STA     OLD_FEPERR_DATE

     1159     9628    7                       OLD_FEPERR_TIME = TH_TIME;

   9628  9 003460   040000 100400                    MLR     fill='040'O
         9 003461   000000 000013 xsym               ADSC9   TH_TIME                  cn=0,n=11
         9 003462   000422 000013 7                  ADSC9   OLD_FEPERR_TIME          cn=0,n=11

     1160     9629    7                END; /* do case */

     1161     9630    6                       TH_FIRST_TIME = %FALSE;

   9630  9 003463   000000 450000 xsym               STZ     TH_FIRST_TIME

     1162     9631    6              END;   /* if th_first_time & th_itype = th_ioerr or th_feperr */

   9631  9 003464   003636 710000 9                  TRA     s:9670

     1163     9632    6              ELSE IF TH_ITYPE = %TH_IOERR OR TH_ITYPE = %TH_FEPERR THEN DO;
              9632                       /*if it's ioerr record read */

   9632  9 003465   000000 235000 xsym               LDA     TH_ITYPE
         9 003466   000022 115007                    CMPA    18,DL
         9 003467   003472 600000 9                  TZE     s:9633
         9 003470   000024 115007                    CMPA    20,DL
         9 003471   003547 601000 9                  TNZ     s:9655
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:185  

     1164     9633    7                DO CASE(TH_ITYPE);

   9633  9 003472   000022 135007                    SBLA    18,DL
         9 003473   000003 115007                    CMPA    3,DL
         9 003474   003476 602005 9                  TNC     s:9633+4,AL
         9 003475   003636 710000 9                  TRA     s:9670
         9 003476   003501 710000 9                  TRA     s:9635
         9 003477   003546 710000 9                  TRA     s:9653
         9 003500   003524 710000 9                  TRA     s:9644

     1165     9634    7                   CASE(%TH_IOERR);

     1166     9635    7                       NUM_IOERR_REC = NUM_IOERR_REC + 1;

   9635  9 003501   200371 054100                    AOS     NUM_IOERR_REC,,AUTO

     1167     9636    7                       CALL M$WRITE(WRITE_ERRLOG2);

   9636  9 003502   000602 630400 7                  EPPR0   WRITE_ERRLOG2
         9 003503   040001 713400                    CLIMB   write
         9 003504   401400 401760                    pmme    nvectors=4

     1168     9637    8                         IF OLD_IOERR_TIME = ' ' THEN DO;

   9637  9 003505   040000 106400                    CMPC    fill='040'O
         9 003506   000425 000013 7                  ADSC9   OLD_IOERR_TIME           cn=0,n=11
         9 003507   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003510   003516 601000 9                  TNZ     s:9641

     1169     9638    8                           OLD_IOERR_TIME = TH_TIME;

   9638  9 003511   040000 100400                    MLR     fill='040'O
         9 003512   000000 000013 xsym               ADSC9   TH_TIME                  cn=0,n=11
         9 003513   000425 000013 7                  ADSC9   OLD_IOERR_TIME           cn=0,n=11

     1170     9639    8                           OLD_IOERR_DATE = ERRLOG_DATE;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:186  

   9639  9 003514   000436 235000 7                  LDA     ERRLOG_DATE
         9 003515   000417 755000 7                  STA     OLD_IOERR_DATE

     1171     9640    8                         END;  /* if old_ioerr_time = ' '*/

     1172     9641    7                       NEW_IOERR_DATE = ERRLOG_DATE;

   9641  9 003516   000436 235000 7                  LDA     ERRLOG_DATE
         9 003517   000421 755000 7                  STA     NEW_IOERR_DATE

     1173     9642    7                       NEW_IOERR_TIME = TH_TIME;

   9642  9 003520   040000 100400                    MLR     fill='040'O
         9 003521   000000 000013 xsym               ADSC9   TH_TIME                  cn=0,n=11
         9 003522   000433 000013 7                  ADSC9   NEW_IOERR_TIME           cn=0,n=11
         9 003523   003636 710000 9                  TRA     s:9670

     1174     9643    7                   CASE(%TH_FEPERR);

     1175     9644    7                       NUM_FEPERR = NUM_FEPERR + 1;

   9644  9 003524   200372 054100                    AOS     NUM_FEPERR,,AUTO

     1176     9645    7                       CALL M$WRITE(WRITE_ERRLOG4);

   9645  9 003525   001312 630400 7                  EPPR0   WRITE_ERRLOG4
         9 003526   040001 713400                    CLIMB   write
         9 003527   401400 401760                    pmme    nvectors=4

     1177     9646    8                         IF OLD_FEPERR_TIME = ' ' THEN DO;

   9646  9 003530   040000 106400                    CMPC    fill='040'O
         9 003531   000422 000013 7                  ADSC9   OLD_FEPERR_TIME          cn=0,n=11
         9 003532   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003533   003541 601000 9                  TNZ     s:9650

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:187  
     1178     9647    8                           OLD_FEPERR_TIME = TH_TIME;

   9647  9 003534   040000 100400                    MLR     fill='040'O
         9 003535   000000 000013 xsym               ADSC9   TH_TIME                  cn=0,n=11
         9 003536   000422 000013 7                  ADSC9   OLD_FEPERR_TIME          cn=0,n=11

     1179     9648    8                           OLD_FEPERR_DATE = ERRLOG_DATE;

   9648  9 003537   000436 235000 7                  LDA     ERRLOG_DATE
         9 003540   000416 755000 7                  STA     OLD_FEPERR_DATE

     1180     9649    8                         END;  /* if old_feperr_time = ' '*/

     1181     9650    7                       NEW_FEPERR_DATE = ERRLOG_DATE;

   9650  9 003541   000436 235000 7                  LDA     ERRLOG_DATE
         9 003542   000420 755000 7                  STA     NEW_FEPERR_DATE

     1182     9651    7                       NEW_FEPERR_TIME = TH_TIME;

   9651  9 003543   040000 100400                    MLR     fill='040'O
         9 003544   000000 000013 xsym               ADSC9   TH_TIME                  cn=0,n=11
         9 003545   000430 000013 7                  ADSC9   NEW_FEPERR_TIME          cn=0,n=11

     1183     9652    7                END; /* do case*/

     1184     9653    6              END;/* if th_itype = th_ioerr or th_feperr */

   9653  9 003546   003636 710000 9                  TRA     s:9670

     1185     9654    6              ELSE DO;/* if ioerr/feperr records were not fetched */

     1186     9655    6                    IF (NUM_RECS = 0) AND (TH_ITYPE ~= %TH_EDAC) THEN

   9655  9 003547   200373 235100                    LDA     NUM_RECS,,AUTO
         9 003550   003560 601000 9                  TNZ     s:9657
         9 003551   000000 235000 xsym               LDA     TH_ITYPE
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:188  
         9 003552   000023 115007                    CMPA    19,DL
         9 003553   003560 600000 9                  TZE     s:9657

     1187     9656    6                     CALL THW$WRITE(DATE_FMT,VECTOR(DAY_BUF),VECTOR(DATE_BUF));

   9656  9 003554   000140 630400 10                 EPPR0   96
         9 003555   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003556   000000 701000 xent               TSX1    THW$WRITE
         9 003557   000000 011000                    NOP     0

     1188     9657    6                    NUM_RECS = NUM_RECS + 1;

   9657  9 003560   200373 054100                    AOS     NUM_RECS,,AUTO

     1189     9658    7                    IF TH_CONSTRAINTS.OCTAL THEN DO;/* if octal flag's set*/

   9658  9 003561   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         9 003562   002000 316007                    CANQ    1024,DL
         9 003563   003624 600000 9                  TZE     s:9665

     1190     9659    7                       LOC_UTS = RECORD.UTS;

   9659  9 003564   000001 470400 xsym               LDP0    TH_RECORD+1
         9 003565   000000 235100                    LDA     0,,PR0
         9 003566   000001 236100                    LDQ     1,,PR0
         9 003567   000011 773000                    LRL     9
         9 003570   000411 756000 7                  STQ     LOC_UTS

     1191     9660    7                       CALL M$TIME(LOC_DATE);

   9660  9 003571   000704 630400 8                  EPPR0   LOC_DATE
         9 003572   020004 713400                    CLIMB   8196
         9 003573   402000 401760                    pmme    nvectors=5

     1192     9661    7                       TYPE = RECORD.TYPE;

   9661  9 003574   000001 470400 xsym               LDP0    TH_RECORD+1
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:189  
         9 003575   000000 236100                    LDQ     0,,PR0
         9 003576   000033 772000                    QRL     27
         9 003577   200354 756100                    STQ     TYPE,,AUTO

     1193     9662    7                      CALL THW$WRITE(DUMP_FMT,VECTOR(TYPE),VECTOR(DBUF),VECTOR(TBUF));

   9662  9 003600   777640 235007                    LDA     -96,DL
         9 003601   203010 452500                    STP2    EOF_FLAG+3,,AUTO
         9 003602   203010 236100                    LDQ     EOF_FLAG+3,,AUTO
         9 003603   000354 036003                    ADLQ    236,DU
         9 003604   203012 757100                    STAQ    EOF_FLAG+5,,AUTO
         9 003605   000150 237000 10                 LDAQ    104
         9 003606   203016 757100                    STAQ    EOF_FLAG+9,,AUTO
         9 003607   203012 631500                    EPPR1   EOF_FLAG+5,,AUTO
         9 003610   203015 451500                    STP1    EOF_FLAG+8,,AUTO
         9 003611   000152 236000 10                 LDQ     106
         9 003612   203014 756100                    STQ     EOF_FLAG+7,,AUTO
         9 003613   203014 630500                    EPPR0   EOF_FLAG+7,,AUTO
         9 003614   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 003615   000000 701000 xent               TSX1    THW$WRITE
         9 003616   000000 011000                    NOP     0

     1194     9663    7                       CALL THF$DUMP(TH_RECORD.PTR$);

   9663  9 003617   000153 630400 10                 EPPR0   107
         9 003620   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 003621   000000 701000 xent               TSX1    THF$DUMP
         9 003622   000000 011000                    NOP     0

     1195     9664    7                    END;

   9664  9 003623   003636 710000 9                  TRA     s:9670

     1196     9665    6                   ELSE IF TH_ITYPE = %TH_EDAC THEN/*if MEM error record was fetched*/

   9665  9 003624   000000 235000 xsym               LDA     TH_ITYPE
         9 003625   000023 115007                    CMPA    19,DL
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:190  
         9 003626   003632 601000 9                  TNZ     s:9668

     1197     9666    6                         MEMORY_ERRORS = %TRUE;/*set memory error flag*/

   9666  9 003627   400000 236003                    LDQ     -131072,DU
         9 003630   200370 756100                    STQ     MEMORY_ERRORS,,AUTO
         9 003631   003636 710000 9                  TRA     s:9670

     1198     9667    6                    ELSE
     1199     9668    6                       CALL THF$RAW(TH_DETAIL_FMT);/* process record */

   9668  9 003632   000103 630400 10                 EPPR0   67
         9 003633   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 003634   000000 701000 xent               TSX1    THF$RAW
         9 003635   000000 011000                    NOP     0

     1200     9669    6              END;/* else do */

     1201     9670    6          DO NEVER;

   9670  9 003636   003641 710000 9                  TRA     s:9673

     1202     9671    6   LBL_EOF:      EOF_FLAG = %TRUE;

   9671  9 003637   400000 236003       LBL_EOF      LDQ     -131072,DU
         9 003640   203005 756100                    STQ     EOF_FLAG,,AUTO

     1203     9672    6          END;   /* do never */

     1204     9673    5        END;     /* do while */

   9673  9 003641   203005 234100                    SZN     EOF_FLAG,,AUTO
         9 003642   003374 605000 9                  TPL     s:9609

     1205     9674    4        END;     /* do i = 0 to th_num_rep_devs */

   9674  9 003643   200363 235100                    LDA     I,,AUTO
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:191  
         9 003644   000001 035007                    ADLA    1,DL
         9 003645   200363 755100                    STA     I,,AUTO
         9 003646   200363 236100                    LDQ     I,,AUTO
         9 003647   000000 116000 xsym               CMPQ    TH_NUM_REP_DEVS
         9 003650   003344 602000 9                  TNC     s:9600

     1206     9675    3             CALL XUD$UTS_ADJ_25TH(ERRLOG_DATE, ERRLOG_DATE, %UTS_25TH_DAY#);

   9675  9 003651   000156 630400 10                 EPPR0   110
         9 003652   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003653   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         9 003654   000000 011000                    NOP     0

     1207     9676    3   FILE_NO: END; /* DO WHILE (ERRLOG_DATE <= STOP) */

   9676  9 003655   200005 236100       FILE_NO      LDQ     STOP_TIME,,AUTO
         9 003656   000436 116000 7                  CMPQ    ERRLOG_DATE
         9 003657   003321 603000 9                  TRC     s:9591

     1208     9677    2        CALL M$CLOSE(CLOSE_ERRLOG2);/* close dcbs*/

   9677  9 003660   000544 630400 7                  EPPR0   CLOSE_ERRLOG2
         9 003661   050001 713400                    CLIMB   close
         9 003662   406000 401760                    pmme    nvectors=13

     1209     9678    2        CALL M$CLOSE(CLOSE_ERRLOG4);

   9678  9 003663   001254 630400 7                  EPPR0   CLOSE_ERRLOG4
         9 003664   050001 713400                    CLIMB   close
         9 003665   406000 401760                    pmme    nvectors=13

     1210     9679    2        OPEN_ERRLOG2.V.FUN# = %UPDATE#;/*set create fpt to update*/

   9679  9 003666   001000 236007                    LDQ     512,DL
         9 003667   000517 552010 7                  STBQ    OPEN_ERRLOG2+37,'10'O

     1211     9680    2        OPEN_ERRLOG4.V.FUN# = %UPDATE#;/* set create fpt to update */
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:192  

   9680  9 003670   001227 552010 7                  STBQ    OPEN_ERRLOG4+37,'10'O

     1212     9681    3          IF NUM_IOERR_REC > 0 THEN DO; /*if ioerr records are read from errlog file*/

   9681  9 003671   200371 235100                    LDA     NUM_IOERR_REC,,AUTO
         9 003672   003705 604400 9                  TMOZ    s:9687

     1213     9682    3            SORT_ERRLOG2.NREC# = NUM_IOERR_REC;/* sort fpt gets no. of records */

   9682  9 003673   001011 755000 7                  STA     SORT_ERRLOG2+13

     1214     9683    3            CALL M$CMDVAR(SILENCE_SORT) ALTRET(SORT_ERR);

   9683  9 003674   001014 630400 8                  EPPR0   SILENCE_SORT
         9 003675   420025 713400                    CLIMB   alt,+8213
         9 003676   402400 401760                    pmme    nvectors=6
         9 003677   003770 702000 9                  TSX2    SORT_ERR

     1215     9684    3            CALL X$SORT(SORT_ERRLOG2) ALTRET(SORT_ERR); /*call sort */

   9684  9 003700   000201 630400 10                 EPPR0   129
         9 003701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 003702   000000 701000 xent               TSX1    X$SORT
         9 003703   003770 702000 9                  TSX2    SORT_ERR

     1216     9685    3          END;

   9685  9 003704   003730 710000 9                  TRA     CHK_FEP

     1217     9686    3          ELSE DO;/* if no ioerr records were read */

     1218     9687    3            CLOSE_ERRLOG2.V.DISP# = %RELEASE#; /* otherwise release file */

   9687  9 003705   000001 236007                    LDQ     1,DL
         9 003706   000576 552004 7                  STBQ    CLOSE_ERRLOG2+26,'04'O

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:193  
     1219     9688    3            CALL M$OPEN(OPEN_ERRLOG2)   /* open file*/

   9688  9 003707   000452 630400 7                  EPPR0   OPEN_ERRLOG2
         9 003710   450000 713400                    CLIMB   alt,open
         9 003711   410400 401760                    pmme    nvectors=18
         9 003712   003714 702000 9                  TSX2    s:9690
         9 003713   003725 710000 9                  TRA     s:9695

     1220     9689    4                WHENALTRETURN DO;

     1221     9690    4                   IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE

   9690  9 003714   000000 470400 xsym               LDP0    B$TCB$
         9 003715   000000 471500                    LDP1    0,,PR0
         9 003716   100102 236100                    LDQ     66,,PR1
         9 003717   377770 376007                    ANQ     131064,DL
         9 003720   001610 116007                    CMPQ    904,DL
         9 003721   003724 600000 9                  TZE     s:9693

     1222     9691    4                   THEN;
     1223     9692    4                   ELSE    CALL M$MERC;

   9692  9 003722   010007 713400                    CLIMB   4103
         9 003723   000000 401760                    pmme    nvectors=0

     1224     9693    4                    GOTO CHK_FEP;

   9693  9 003724   003730 710000 9                  TRA     CHK_FEP

     1225     9694    4                END;  /* whenaltreturn do */
     1226     9695    3            CALL M$CLOSE(CLOSE_ERRLOG2);/* and close file to release it*/

   9695  9 003725   000544 630400 7                  EPPR0   CLOSE_ERRLOG2
         9 003726   050001 713400                    CLIMB   close
         9 003727   406000 401760                    pmme    nvectors=13

     1227     9696    3          END;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:194  

     1228     9697    3   CHK_FEP: IF NUM_FEPERR > 0 THEN DO; /* if feperr records were read */

   9697  9 003730   200372 235100       CHK_FEP      LDA     NUM_FEPERR,,AUTO
         9 003731   003744 604400 9                  TMOZ    s:9703

     1229     9698    3            SORT_ERRLOG4.NREC# = NUM_FEPERR;/*sort fpt gets no. of feperr records*/

   9698  9 003732   001513 755000 7                  STA     SORT_ERRLOG4+13

     1230     9699    3            CALL M$CMDVAR(SILENCE_SORT) ALTRET(SORT_ERR);

   9699  9 003733   001014 630400 8                  EPPR0   SILENCE_SORT
         9 003734   420025 713400                    CLIMB   alt,+8213
         9 003735   402400 401760                    pmme    nvectors=6
         9 003736   003770 702000 9                  TSX2    SORT_ERR

     1231     9700    3            CALL X$SORT(SORT_ERRLOG4) ALTRET(SORT_ERR);/* sort feperr recs*/

   9700  9 003737   000202 630400 10                 EPPR0   130
         9 003740   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 003741   000000 701000 xent               TSX1    X$SORT
         9 003742   003770 702000 9                  TSX2    SORT_ERR

     1232     9701    3          END;/* if num_feperr > 0 */

   9701  9 003743   003767 710000 9                  TRA     s:9713

     1233     9702    3          ELSE DO;/* if no feperr records were read*/

     1234     9703    3            CLOSE_ERRLOG4.V.DISP# = %RELEASE#;/* set fpt to release*/

   9703  9 003744   000001 236007                    LDQ     1,DL
         9 003745   001306 552004 7                  STBQ    CLOSE_ERRLOG4+26,'04'O

     1235     9704    3            CALL M$OPEN(OPEN_ERRLOG4)

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:195  
   9704  9 003746   001162 630400 7                  EPPR0   OPEN_ERRLOG4
         9 003747   450000 713400                    CLIMB   alt,open
         9 003750   410400 401760                    pmme    nvectors=18
         9 003751   003753 702000 9                  TSX2    s:9706
         9 003752   003764 710000 9                  TRA     s:9711

     1236     9705    4             WHENALTRETURN DO;

     1237     9706    4               IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE

   9706  9 003753   000000 470400 xsym               LDP0    B$TCB$
         9 003754   000000 471500                    LDP1    0,,PR0
         9 003755   100102 236100                    LDQ     66,,PR1
         9 003756   377770 376007                    ANQ     131064,DL
         9 003757   001610 116007                    CMPQ    904,DL
         9 003760   003763 600000 9                  TZE     s:9709

     1238     9707    4               THEN;
     1239     9708    4               ELSE   CALL M$MERC;

   9708  9 003761   010007 713400                    CLIMB   4103
         9 003762   000000 401760                    pmme    nvectors=0

     1240     9709    4                 GOTO DONE;

   9709  9 003763   003773 710000 9                  TRA     DONE

     1241     9710    4             END;  /* whenaltreturn do */
     1242     9711    3            CALL M$CLOSE(CLOSE_ERRLOG4);/* close dcb to release file*/

   9711  9 003764   001254 630400 7                  EPPR0   CLOSE_ERRLOG4
         9 003765   050001 713400                    CLIMB   close
         9 003766   406000 401760                    pmme    nvectors=13

     1243     9712    3          END;  /* else do */

     1244     9713    3   DO NEVER;
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:196  

   9713  9 003767   003773 710000 9                  TRA     DONE

     1245     9714    3        SORT_ERR: CALL THM$ERRMSG;

   9714  9 003770   000002 631400 xsym  SORT_ERR     EPPR1   B_VECTNIL+2
         9 003771   000000 701000 xent               TSX1    THM$ERRMSG
         9 003772   000000 011000                    NOP     0

     1246     9715    3      END;

     1247     9716    2   DONE:CALL THG$CLOSEXSA;

   9716  9 003773   000002 631400 xsym  DONE         EPPR1   B_VECTNIL+2
         9 003774   000000 701000 xent               TSX1    THG$CLOSEXSA
         9 003775   000000 011000                    NOP     0

     1248     9717    2       TH_LASTTYPE = -1;

   9717  9 003776   000001 335007                    LCA     1,DL
         9 003777   000000 755000 xsym               STA     TH_LASTTYPE

     1249     9718    2       RETURN;

   9718  9 004000   203006 221300                    LDX1  ! EOF_FLAG+1,,AUTO
         9 004001   000001 702211                    TSX2  ! 1,X1
     1250     9719    2   END THC$DETAIL;
     1251     9720    1   END THC$REPORT;
     1252     9721        %EOD;

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:197  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   ZL_MACRO_C.:TOOLE04  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$REPORT.
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:198  

 **** Variables and constants ****

  ****  Section 007  Data  THC$REPORT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   415-0-0/w UBIN        r     1 BUF_INDX                 544-0-0/d STRC(1080)  r     1 CLOSE_ERRLOG2
   710-0-0/d STRC(1080)  r     1 CLOSE_ERRLOG3           1254-0-0/d STRC(1080)  r     1 CLOSE_ERRLOG4
  1420-0-0/d STRC(1080)  r     1 CLOSE_ERRLOG5            440-0-0/c CHAR(10)    r     1 DATE_BUF
   446-0-0/d BIT (72)    r     1 DATE_FMT                 437-0-0/c CHAR(3)     r     1 DAY_BUF
   404-0-0/c CHAR(8)     r     1 DBUF                     444-0-0/d BIT (72)    r     1 DEV_HDR
   412-0-0/d BIT (72)    r     1 DUMP_FMT                1542-0-0/c STRC(81)    r     1 ERRLOG2
  1545-0-0/c STRC(81)    r     1 ERRLOG3                 1550-0-0/c STRC(81)    r     1 ERRLOG4
  1553-0-0/c STRC(81)    r     1 ERRLOG5                  436-0-0/w UBIN        r     1 ERRLOG_DATE
  1132-0-0/d STRC(864)   r     1 FPT_FID                  764-0-0/d STRC(216)   r     1 GET_XSA_BUF
   772-0-0/w STRC(72)    r     1 INPUT_TABLE             1474-0-0/w STRC(72)    r     1 INPUT_TBL
   411-0-0/w UBIN        r     1 LOC_UTS                 1612-0-0/w STRC(999)   r     1 LO_HEADER
   420-0-0/w UBIN        r     1 NEW_FEPERR_DATE          430-0-0/c CHAR(11)    r     1 NEW_FEPERR_TIME
   421-0-0/w UBIN        r     1 NEW_IOERR_DATE           433-0-0/c CHAR(11)    r     1 NEW_IOERR_TIME
   416-0-0/w UBIN        r     1 OLD_FEPERR_DATE          422-0-0/c CHAR(11)    r     1 OLD_FEPERR_TIME
   417-0-0/w UBIN        r     1 OLD_IOERR_DATE           425-0-0/c CHAR(11)    r     1 OLD_IOERR_TIME
  1566-0-0/c STRC(72)    r     1 ONFILE_ACCT             1556-0-0/c STRC(288)   r     1 ONFILE_NAME
  1570-0-0/c STRC(72)    r     1 ONFILE_PASS             1600-0-0/d STRC(324)   r     1 ONFILE_RESULTS
  1574-0-0/d STRC(90)    r     1 ONFILE_SN                  0-0-0/b BIT         r     1 ONFILE_SPECIFIED
  1572-0-0/c STRC(72)    r     1 ONFILE_WSN               452-0-0/d STRC(2088)  r     1 OPEN_ERRLOG2
   616-0-0/d STRC(2088)  r     1 OPEN_ERRLOG3            1162-0-0/d STRC(2088)  r     1 OPEN_ERRLOG4
  1326-0-0/d STRC(2088)  r     1 OPEN_ERRLOG5               1-0-0/w UBIN        r     1 OUTPUT_DCB#
   746-0-0/d STRC(504)   r     1 READ_ERRLOG3            1456-0-0/d STRC(504)   r     1 READ_ERRLOG5
  1040-0-0/d STRC(2088)  r     1 SET_ONFILE               774-0-0/w STRC(1296)  r     1 SORT_ERRLOG2
  1476-0-0/w STRC(1296)  r     1 SORT_ERRLOG4             406-0-0/c CHAR(11)    r     1 TBUF
   343-0-0/c CHAR(132)   r     1 TEMP_BUF                   2-0-0/c CHAR(900)   r     1 TEXTBUF
   414-0-0/w UBIN        r     1 TEXT_LEN                 450-0-0/d BIT (72)    r     1 TIME_FMT
   602-0-0/d STRC(432)   r     1 WRITE_ERRLOG2           1312-0-0/d STRC(432)   r     1 WRITE_ERRLOG4

  ****  Section 008 RoData THC$REPORT

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:199  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   176-0-0/c CHAR(58)    r     1 AMS_HDR                  756-0-0/d STRC(1080)  r     1 CLOSE_LO
   720-0-0/d STRC(1080)  r     1 CLOSE_ONFILE             215-0-0/c CHAR(54)    r     1 CONFIG_HDR
   620-0-0/c CHAR(31)    r     1 DATE_HDR                 464-0-0/c CHAR(85)    r     1 DETAIL_HDR
   154-0-0/c CHAR(47)    r     1 DEV_ENTRY                120-0-0/c CHAR(110)   r     1 DEV_FMT
     0-0-0/c CHAR(34)    r     1 DUMP_HDR                 546-0-0/c CHAR(22)    r     1 EXCLUDE_FMT
   670-0-0/d STRC(432)   r     1 EXT_DATE                 530-0-0/c CHAR(34)    r     1 FEPERR_HDR
    17-0-0/c CHAR(42)    r     1 FEPNOTIMP                554-0-0/d BIT (72)    r     1 HDR_TBL(0:17)
   261-0-0/c CHAR(77)    r     1 HWE_HDR                  512-0-0/c CHAR(53)    r     1 IOERR_HDR
    32-0-0/c CHAR(42)    r     1 IOMNOTIMP                704-0-0/d STRC(432)   r     1 LOC_DATE
   541-0-0/c CHAR(20)    r     1 MATCH_FMT                 45-0-0/c CHAR(42)    r     1 MPCNOTIMP
    11-0-0/c CHAR(24)    r     1 NOTIMP                   357-0-0/c CHAR(73)    r     1 RAW_HDR
   654-0-0/d STRC(432)   r     1 RECORD_DATE             1014-0-0/d STRC(504)   r     1 SILENCE_SORT
  1035-0-0/c STRC(63)    r     1 SORT_SUPPRESS            114-0-0/c CHAR(16)    r     1 SUM_ENTRY
    65-0-0/c CHAR(92)    r     1 SUM_FMT                  443-0-0/c CHAR(65)    r     1 SUM_HDR
   170-0-0/c CHAR(23)    r     1 SUM_TOT                  404-0-0/c CHAR(62)    r     1 SYS_HDR
   630-0-0/c CHAR(73)    r     1 TIME_HDR                  60-0-0/c CHAR(19)    r     1 TYPE_FMT
   424-0-0/c CHAR(58)    r     1 UPR_HDR                 1032-0-0/c STRC(90)    r     1 VLP_NAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                    353-0-0/w UBIN        r     1 BUF_COUNT
   360-0-0/w UBIN        r     1 CODE                     361-0-0/w UBIN        r     1 COMP_CODE
  2160-0-0/w SBIN        r     1 CONNECTS(0:200)         3003-0-0/w UBIN        r     1 COUNT
   514-0-0/c CHAR(8)     r     1 DEVNM(0:200)            1336-0-0/w SBIN        r     1 DEV_CNT(0:200)
  1647-0-0/w SBIN        r     1 DEV_MOUNT(0:200)
  3005-0-0/b BIT         r     1 EOF_FLAG                2471-0-0/w SBIN        r     1 ERRORS(0:200)
   367-0-0/b BIT         r     1 FOR_CLAUSE_FLG           363-0-0/w UBIN        r     1 I
  3002-0-0/w PTR         r     1 INFO$                    364-0-0/w UBIN        r     1 J
   365-0-0/w SBIN        r     1 K                        362-0-0/w UBIN        r     1 LEN
   370-0-0/b BIT         r     1 MEMORY_ERRORS            375-0-0/w SBIN        r     1 NUM_DEV
   372-0-0/w SBIN        r     1 NUM_FEPERR               371-0-0/w SBIN        r     1 NUM_IOERR_REC
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:200  
   373-0-0/w SBIN        r     1 NUM_RECS                 374-0-0/w SBIN        r     1 NUM_TYPES
   444-0-0/w UBIN        r     1 RECORD_TYPE             3004-0-0/w UBIN        r     1 REPORT_CODE
     4-0-0/w UBIN        r     1 START_TIME                 5-0-0/w UBIN        r     1 STOP_TIME
   355-0-0/w PTR         r     1 SYM$                      12-0-0/c CHAR(900)   r     1 TEMP_BUF2
   356-0-0/c CHAR(8)     r     1 TEXT                       6-0-0/w PTR         r     1 TEXT$
    *0-0-0/w PTR         r     1 TOP$                      10-0-0/d STRC(72)    r     1 TVEC
   354-0-0/w UBIN        r     1 TYPE                     445-0-0/w UBIN(9)     r     1 TYPEB
   376-0-0/w UBIN        r     1 TYPES(0:37)
   446-0-0/w UBIN        r     1 TYPE_CNT(0:37)

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b BIT         r     1 TH_BRKMSG
     0-0-0/b BIT         r     1 TH_CHECK_DEVNM             0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS
     0-0-0/c CHAR(10)    r     1 TH_DATE                    0-0-0/c CHAR(3)     r     1 TH_DAY
     0-0-0/b BIT         r     1 TH_DETAIL_FLG
     0-0-0/w PTR         r     1 TH_DETAIL_FMT(0:0)
     0-0-0/b BIT         r     1 TH_EOF_FLG
     0-0-0/w PTR         r     1 TH_EXTENDED_FMT(0:0)
     0-0-0/b BIT         r     1 TH_FEPERR_FLG              0-0-0/b BIT         r     1 TH_FIRST_TIME
     0-0-0/b BIT         r     1 TH_IOERR_FLG               0-0-0/w UBIN        r     1 TH_ITYPE
     0-0-0/w SBIN        r     1 TH_LASTTYPE                0-0-0/w UBIN        r     1 TH_LASTUTS
     0-0-0/w STRC(1080)  r     1 TH_LAST_EXCLUDE            0-0-0/w STRC(1080)  r     1 TH_LAST_MATCH
     0-0-0/w UBIN        r     1 TH_LAST_REQID              0-0-0/w UBIN        r     1 TH_NUM_REP_DEVS
     0-0-0/c CHAR(100)   r     1 TH_OUTBUF                  0-0-0/b BIT         r     1 TH_RAW_FLG
     0-0-0/w PTR         r     1 TH_RAW_FMT(0:0)
     0-0-0/d STRC(72)    r     1 TH_RECORD
     0-0-0/w CHAR(8)     r     1 TH_REP_DEVS(0:511)
     0-0-0/d STRC(1971)  r     1 TH_SAVE                    0-0-0/w CHAR(6)     r     1 TH_SITE_ID
     0-0-0/w STRC(1080)  r     1 TH_SITE_NAME               0-0-0/c CHAR(11)    r     1 TH_TIME
     0-0-0/w STRC(72)    r     1 TH_XSA_BUF                 0-0-0/w BIT (72)    r     1 TH_XSA_BUF_VECTOR

  ****  BASED and DCB variables  ****

PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:201  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(1080)  r     1 EL$IOERR                   0-0-0/w STRC(252)   r     1 EL$MTDMT
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$ERRLOG2
     0-0-0N  NULL        r     1 M$ERRLOG3                  0-0-0N  NULL        r     1 M$ERRLOG4
     0-0-0N  NULL        r     1 M$ERRLOG5                  0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$ONFILE                   0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(216)   r     1 RECORD


   Procedure THC$REPORT requires 2050 words for executable code.
   Procedure THC$REPORT requires 1580 words of local(AUTO) storage.
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:202  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:203  
          MINI XREF LISTING

AMS_HDR
      6941**DCL      6983--DCLINIT
B$ALT.CODE
      7104**DCL      7104--REDEF    7105--REDEF    7105--REDEF
B$ALT.ERR.CODE
      7106**DCL      9294>>IF       9326>>IF       9690>>IF       9706>>IF
B$ALT.ERR.ERR#
      7106**DCL      7106--REDEF
B$ALT.EVID
      7105**DCL      7105--REDEF    7105--REDEF
B$TCB.ALT$
      7100**DCL      9294>>IF       9326>>IF       9690>>IF       9706>>IF
B$TCB$
      7006**DCL      9294>>IF       9326>>IF       9690>>IF       9706>>IF
BUF_COUNT
      6776**DCL      9224<<ASSIGN   9227>>CALLBLT  9228<<ASSIGN   9228>>ASSIGN   9231>>CALLBLT  9232<<ASSIGN
      9232>>ASSIGN   9234<>CALL     9236>>ASSIGN   9401<<ASSIGN   9404>>CALLBLT  9405<<ASSIGN   9405>>ASSIGN
      9408>>CALLBLT  9409<<ASSIGN   9409>>ASSIGN   9411<>CALL     9413>>ASSIGN
BUF_INDX
      6792**DCL      9001<<ASSIGN   9008<<ASSIGN   9142>>IF       9143>>CALLBLT  9144<<ASSIGN   9144>>ASSIGN
      9146>>CALLBLT  9147<<ASSIGN   9147>>ASSIGN   9167<>CALL     9169>>ASSIGN
CHK_FEP IN PROCEDURE THC$DETAIL
      9697**LABEL    9693--GOTO
CLOSE_ERRLOG2
      7297**DCL      9677<>CALL     9695<>CALL
CLOSE_ERRLOG2.SN_
      7297**DCL      7297--REDEF
CLOSE_ERRLOG2.UTL_
      7298**DCL      7298--REDEF
CLOSE_ERRLOG2.V
      7302**DCL      7297--DCLINIT
CLOSE_ERRLOG2.V.DISP#
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:204  
      7306**DCL      9259<<ASSIGN   9687<<ASSIGN
CLOSE_ERRLOG2.V.EXPIRE#
      7312**DCL      7312--REDEF
CLOSE_ERRLOG2.V.TYPE#
      7310**DCL      7310--REDEF
CLOSE_ERRLOG2.V.XTNSIZE#
      7307**DCL      7307--REDEF    7309--REDEF
CLOSE_ERRLOG3
      7491**DCL      9264<>CALL     9331<>CALL
CLOSE_ERRLOG3.SN_
      7491**DCL      7491--REDEF
CLOSE_ERRLOG3.UTL_
      7492**DCL      7492--REDEF
CLOSE_ERRLOG3.V
      7496**DCL      7491--DCLINIT
CLOSE_ERRLOG3.V.DISP#
      7500**DCL      9263<<ASSIGN   9265<<ASSIGN   9270<<ASSIGN
CLOSE_ERRLOG3.V.EXPIRE#
      7506**DCL      7506--REDEF
CLOSE_ERRLOG3.V.TYPE#
      7504**DCL      7504--REDEF
CLOSE_ERRLOG3.V.XTNSIZE#
      7501**DCL      7501--REDEF    7503--REDEF
CLOSE_ERRLOG4
      8312**DCL      9678<>CALL     9711<>CALL
CLOSE_ERRLOG4.SN_
      8312**DCL      8312--REDEF
CLOSE_ERRLOG4.UTL_
      8313**DCL      8313--REDEF
CLOSE_ERRLOG4.V
      8317**DCL      8312--DCLINIT
CLOSE_ERRLOG4.V.DISP#
      8321**DCL      9260<<ASSIGN   9703<<ASSIGN
CLOSE_ERRLOG4.V.EXPIRE#
      8327**DCL      8327--REDEF
CLOSE_ERRLOG4.V.TYPE#
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:205  
      8325**DCL      8325--REDEF
CLOSE_ERRLOG4.V.XTNSIZE#
      8322**DCL      8322--REDEF    8324--REDEF
CLOSE_ERRLOG5
      8495**DCL      9269<>CALL     9299<>CALL
CLOSE_ERRLOG5.SN_
      8495**DCL      8495--REDEF
CLOSE_ERRLOG5.UTL_
      8496**DCL      8496--REDEF
CLOSE_ERRLOG5.V
      8500**DCL      8495--DCLINIT
CLOSE_ERRLOG5.V.DISP#
      8504**DCL      9268<<ASSIGN
CLOSE_ERRLOG5.V.EXPIRE#
      8510**DCL      8510--REDEF
CLOSE_ERRLOG5.V.TYPE#
      8508**DCL      8508--REDEF
CLOSE_ERRLOG5.V.XTNSIZE#
      8505**DCL      8505--REDEF    8507--REDEF
CLOSE_LO
      8109**DCL      8995<>CALL     9183<>CALL     9553<>CALL
CLOSE_LO.SN_
      8109**DCL      8109--REDEF
CLOSE_LO.UTL_
      8110**DCL      8110--REDEF
CLOSE_LO.V
      8114**DCL      8109--DCLINIT
CLOSE_LO.V.EXPIRE#
      8124**DCL      8124--REDEF
CLOSE_LO.V.TYPE#
      8122**DCL      8122--REDEF
CLOSE_LO.V.XTNSIZE#
      8119**DCL      8119--REDEF    8121--REDEF
CLOSE_ONFILE
      8064**DCL      8996<>CALL     9554<>CALL
CLOSE_ONFILE.SN_
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:206  
      8064**DCL      8064--REDEF
CLOSE_ONFILE.UTL_
      8065**DCL      8065--REDEF
CLOSE_ONFILE.V
      8069**DCL      8064--DCLINIT
CLOSE_ONFILE.V.EXPIRE#
      8079**DCL      8079--REDEF
CLOSE_ONFILE.V.TYPE#
      8077**DCL      8077--REDEF
CLOSE_ONFILE.V.XTNSIZE#
      8074**DCL      8074--REDEF    8076--REDEF
CODE
      6788**DCL      8998<<ASSIGN   9012<<ASSIGN   9014>>ASSIGN   9015>>DOCASE   9102<<ASSIGN   9105<<ASSIGN
      9110<<ASSIGN   9114<<ASSIGN   9118<<ASSIGN   9122<<ASSIGN   9126<<ASSIGN   9141<>CALL     9164<>CALL
      9193<>CALL     9350>>IF       9446>>IF       9594>>IF
COMP_CODE
      6789**DCL      8997<<ASSIGN   9014<<ASSIGN   9018<<ASSIGN   9022<<ASSIGN   9026<<ASSIGN   9030<<ASSIGN
      9034<<ASSIGN   9038<<ASSIGN   9048<<ASSIGN   9051<<ASSIGN   9054<<ASSIGN   9057<<ASSIGN   9060<<ASSIGN
      9063<<ASSIGN   9066<<ASSIGN   9069<<ASSIGN   9072<<ASSIGN   9075<<ASSIGN   9078<<ASSIGN   9082<<ASSIGN
      9085<<ASSIGN   9088<<ASSIGN   9096<<ASSIGN   9106<<ASSIGN   9109<<ASSIGN   9113<<ASSIGN   9117<<ASSIGN
      9121<<ASSIGN   9125<<ASSIGN   9198>>IF       9201>>IF       9204>>IF       9206<>CALL     9274<<ASSIGN
      9275<>CALL
CONFIG_HDR
      6943**DCL      6984--DCLINIT
CONNECTS
      6811**DCL      9433<<ASSIGN   9489<<ASSIGN   9489>>ASSIGN   9497<<ASSIGN   9527>>IF       9529--CALL
COUNT
      6918**DCL      9230<>CALL     9231>>CALLBLT  9231>>CALLBLT  9232>>ASSIGN   9407<>CALL     9408>>CALLBLT
      9408>>CALLBLT  9409>>ASSIGN   9515<>CALL     9516<>CALL     9518>>ASSIGN
DATE_BUF
      6923**DCL      7776--DCLINIT  7777--DCLINIT  9366--CALL     9656--CALL
DATE_FMT
      7002**DCL      9366<>CALL     9656<>CALL
DATE_HDR
      7001**DCL      7002--DCLINIT
DAY_BUF
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:207  
      6921**DCL      7779--DCLINIT  9366--CALL     9656--CALL
DBUF
      6781**DCL      7801--DCLINIT  7802--DCLINIT  9372--CALL     9662--CALL
DETAIL_HDR
      6971**DCL      6999--DCLINIT
DEVNM
      6808**DCL      9475>>IF       9481<<ASSIGN   9487>>IF       9495<<ASSIGN   9529--CALL
DEV_CNT
      6809**DCL      9432<<ASSIGN   9488<<ASSIGN   9488>>ASSIGN   9496<<ASSIGN   9527>>IF       9529--CALL
DEV_ENTRY
      6937**DCL      9529--CALL
DEV_FMT
      6934**DCL      6936--DCLINIT
DEV_HDR
      6936**DCL      9525<>CALL
DEV_MOUNT
      6810**DCL      9435<<ASSIGN   9476<<ASSIGN   9476>>ASSIGN   9482<<ASSIGN   9529--CALL
DONE IN PROCEDURE THC$DETAIL
      9716**LABEL    9709--GOTO
DUMP_FMT
      6785**DCL      9372<>CALL     9662<>CALL
DUMP_HDR
      6784**DCL      6785--DCLINIT
DVT.MPC
      7012**DCL      7013--REDEF
EL$FEPERR.STATDATA.TERMID.TERM
      6894**DCL      6903--REDEF
EL$IOERR.CONNECTS.DEVICE
      6822**DCL      9489>>ASSIGN   9497>>ASSIGN
EL$IOERR.COUNT
      6822**DCL      9488>>ASSIGN   9498>>ASSIGN
EL$IOERR.DEVNM
      6824**DCL      9487>>IF       9495>>ASSIGN
EL$IOERR.ERRCT
      6821**DCL      9490>>ASSIGN
EL$IOERR.SEEK
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:208  
      6823**DCL      6824--REDEF
EL$IOERR.STATUS
      6819**DCL      6820--REDEF
EL$MTDMT.DEVNAME
      6908**DCL      9475>>IF       9481>>ASSIGN
EOF
      9502**LABEL    9458--CALLALT
EOF_FLAG
      6922**DCL      9285<<ASSIGN   9290>>DOWHILE  9295<<ASSIGN   9300>>IF       9314<<ASSIGN   9322>>DOWHILE
      9327<<ASSIGN   9332>>IF       9361<<ASSIGN   9363>>DOWHILE  9387<<ASSIGN   9455<<ASSIGN   9457>>DOWHILE
      9502<<ASSIGN   9604<<ASSIGN   9608>>DOWHILE  9671<<ASSIGN
EOF_LBL
      9387**LABEL    9364--CALLALT
ERRLOG2
      8789**DCL      7228--DCLINIT
ERRLOG3
      8816**DCL      7422--DCLINIT
ERRLOG3_EOF
      9326**LABEL    9323--CALLALT
ERRLOG4
      8843**DCL      8246--DCLINIT
ERRLOG5
      8870**DCL      8429--DCLINIT
ERRLOG5_EOF
      9294**LABEL    9291--CALLALT
ERRLOG_DATE
      6920**DCL      7780--DCLINIT  9345<<ASSIGN   9346>>DOWHILE  9348<>CALL     9392<>CALL     9392<>CALL
      9443<<ASSIGN   9444>>DOWHILE  9445<>CALL     9507<>CALL     9507<>CALL     9589<<ASSIGN   9590>>DOWHILE
      9592<>CALL     9622>>ASSIGN   9627>>ASSIGN   9639>>ASSIGN   9641>>ASSIGN   9648>>ASSIGN   9650>>ASSIGN
      9675<>CALL     9675<>CALL
ERRORS
      6812**DCL      9434<<ASSIGN   9490<<ASSIGN   9490>>ASSIGN   9498<<ASSIGN   9527>>IF       9529--CALL
EXCLUDE_FMT
      6980**DCL      9252--CALL     9426--CALL
EXT_DATE
      7776**DCL      9349<>CALL     9593<>CALL
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:209  
EXT_DATE.V
      7780**DCL      7776--DCLINIT
F$DCB.ACTPOS
      3763**DCL      3763--REDEF
F$DCB.ARS
      3738**DCL      3738--REDEF
F$DCB.ATTR
      3756**DCL      3757--REDEF
F$DCB.BORROW
      3771**DCL      3771--REDEF    3771--REDEF    3771--REDEF
F$DCB.DCBNAME.L
      3785**DCL      3785--IMP-SIZ
F$DCB.EOMCHAR
      3742**DCL      3742--REDEF
F$DCB.FCD
      3751**DCL      8995>>IF       8996>>IF       9183>>IF       9261>>IF       9267>>IF       9281>>IF
      9309>>IF       9553>>IF       9554>>IF
F$DCB.FLDID
      3766**DCL      3766--REDEF
F$DCB.FORM$
      3760**DCL      3760--REDEF
F$DCB.FSECT
      3776**DCL      3776--REDEF
F$DCB.FSN
      3753**DCL      3753--REDEF    3753--REDEF    3754--REDEF
F$DCB.HEADER$
      3759**DCL      3759--REDEF
F$DCB.IXTNSIZE
      3757**DCL      3757--REDEF
F$DCB.LASTSTA$
      3747**DCL      3747--REDEF
F$DCB.LVL
      3772**DCL      3772--REDEF
F$DCB.NAME.C
      3747**DCL      3747--REDEF
F$DCB.NOEOF
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:210  
      3768**DCL      3768--REDEF
F$DCB.NRECS
      3758**DCL      3758--REDEF
F$DCB.NRECX
      3777**DCL      3777--REDEF
F$DCB.OHDR
      3769**DCL      3769--REDEF
F$DCB.ORG
      3752**DCL      3752--REDEF
F$DCB.PRECNO
      3775**DCL      3775--REDEF
F$DCB.RCSZ
      3780**DCL      3780--REDEF
F$DCB.RES
      3748**DCL      3748--REDEF
F$DCB.SETX
      3760**DCL      3760--REDEF
F$DCB.TAB$
      3759**DCL      3760--REDEF
F$DCB.TDA
      3774**DCL      3774--REDEF
F$DCB.WSN
      3749**DCL      3749--REDEF
FEPERR$COMPARE
      6732**DCL-ENT  8698--DCLINIT
FEPERR_HDR
      6976**DCL      9278--CALL
FEPNOTIMP
      6925**DCL      9199--CALL
FID_ERR
      9565**LABEL    9153--CALLALT
FILE_NO IN PROCEDURE THC$DETAIL
      9676**LABEL    9592--CALLALT
FOR_CLAUSE_FLG
      6797**DCL      9002<<ASSIGN   9149<<ASSIGN   9160>>IF
FOUND_DEVNM
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:211  
      9498**LABEL    9491--GOTO
FOUND_MOUNT
      9482**LABEL    9477--GOTO
FOUND_TYPE
      9470**LABEL    9465--GOTO
FPT_FID
      8146**DCL      9153<>CALL
FPT_FID.TEXTFID_
      8146**DCL      9152<<ASSIGN
FPT_FID.V
      8150**DCL      8146--DCLINIT
GET_XSA_BUF
      7566**DCL      9288<>CALL     9304<>CALL     9320<>CALL     9335<>CALL
GET_XSA_BUF.V
      7566**DCL      7566--DCLINIT
HDR_TBL
      6982**DCL      9170<>CALL
HWE_HDR
      6947**DCL      6986--DCLINIT
I
      6793**DCL      9005<<DOINDEX  9006>>DOCASE   9010>>DOINDEX  9012>>ASSIGN   9128>>IF       9131>>ASSIGN
      9151>>ASSIGN   9155>>ASSIGN   9225<<DOINDEX  9226>>IF       9230>>CALL     9356<<DOINDEX  9357>>ASSIGN
      9402<<DOINDEX  9403>>IF       9407>>CALL     9512<<DOINDEX  9514>>ASSIGN   9519>>CALL     9526<<DOINDEX
      9527>>IF       9527>>IF       9527>>IF       9529>>CALL     9529>>CALL     9529>>CALL     9529>>CALL
      9529>>CALL     9599<<DOINDEX  9600>>ASSIGN
INFO$
      6813**DCL      6819--IMP-PTR  6829--IMP-PTR  6908--IMP-PTR  9460<<ASSIGN   9475>>IF       9481>>ASSIGN
      9487>>IF       9488>>ASSIGN   9489>>ASSIGN   9490>>ASSIGN   9495>>ASSIGN   9497>>ASSIGN   9498>>ASSIGN
      9611<<ASSIGN   9613>>ASSIGN   9615>>ASSIGN
INPUT_TABLE
      7584**DCL      7672--DCLINIT
INPUT_TBL
      8566**DCL      8649--DCLINIT
IOERR$COMPARE
      6731**DCL-ENT  7721--DCLINIT
IOERR_HDR
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:212  
      6974**DCL      9307--CALL
IOMNOTIMP
      6926**DCL      9205--CALL
J
      6794**DCL      9010<<DOINDEX  9012>>ASSIGN   9128>>IF       9131>>ASSIGN   9431<<DOINDEX  9432>>ASSIGN
      9433>>ASSIGN   9434>>ASSIGN   9435>>ASSIGN   9450<<DOINDEX  9451>>ASSIGN
K
      6795**DCL      9462<<DOINDEX  9463>>IF       9464>>ASSIGN   9464>>ASSIGN   9473<<DOINDEX  9475>>IF
      9476>>ASSIGN   9476>>ASSIGN   9486<<DOINDEX  9487>>IF       9488>>ASSIGN   9488>>ASSIGN   9489>>ASSIGN
      9489>>ASSIGN   9490>>ASSIGN   9490>>ASSIGN
LBL_EOF IN PROCEDURE THC$DETAIL
      9671**LABEL    9609--CALLALT
LEN
      6790**DCL      9000<<ASSIGN   9013<<ASSIGN   9019<<ASSIGN   9023<<ASSIGN   9027<<ASSIGN   9031<<ASSIGN
      9035<<ASSIGN   9039<<ASSIGN   9042<<ASSIGN   9045<<ASSIGN   9079<<ASSIGN   9091<<ASSIGN   9094<<ASSIGN
      9098<<ASSIGN   9101<<ASSIGN   9132>>CALLBLT  9133<<ASSIGN   9133>>ASSIGN   9134>>ASSIGN   9138>>ASSIGN
      9139<<ASSIGN   9141<>CALL     9164<>CALL
LOC_DATE
      7801**DCL      9370<>CALL     9660<>CALL
LOC_DATE.V
      7805**DCL      7801--DCLINIT
LOC_UTS
      6783**DCL      7805--DCLINIT  9369<<ASSIGN   9659<<ASSIGN
LO_HEADER
      8987**DCL      8001--DCLINIT
LO_HEADER.TITL.L#
      8989**DCL      9182<<ASSIGN
LO_HEADER.TITL.TITLE#
      8990**DCL      9180<<CALLBLT  9181<<CALLBLT  9182--ASSIGN
M$CLOSE
        19**DCL-ENT  8995--CALL     8996--CALL     9183--CALL     9264--CALL     9269--CALL     9299--CALL
      9331--CALL     9553--CALL     9554--CALL     9677--CALL     9678--CALL     9695--CALL     9711--CALL
M$CMDVAR
        88**DCL-ENT  9683--CALL     9699--CALL
M$ERRLOG3
      6754**DCL      9261--IF       9309--IF
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:213  
M$ERRLOG5
      6756**DCL      9267--IF       9281--IF
M$FDS
        54**DCL-ENT  9304--CALL     9335--CALL
M$FID
        82**DCL-ENT  9153--CALL
M$GDS
        54**DCL-ENT  9288--CALL     9320--CALL
M$LO
      6751**DCL      8994>>ASSIGN   8995--IF       9183--IF       9553--IF
M$MERC
        75**DCL-ENT  9692--CALL     9708--CALL
M$ONFILE
      6752**DCL      8996--IF       9184>>ASSIGN   9554--IF
M$OPEN
        19**DCL-ENT  9157--CALL     9283--CALL     9312--CALL     9606--CALL     9607--CALL     9688--CALL
      9704--CALL
M$READ
        20**DCL-ENT  9291--CALL     9323--CALL
M$TIME
        86**DCL-ENT  9349--CALL     9370--CALL     9376--CALL     9593--CALL     9610--CALL     9660--CALL
M$WRITE
        20**DCL-ENT  9621--CALL     9626--CALL     9636--CALL     9645--CALL
MATCH_FMT
      6978**DCL      9246--CALL     9420--CALL
MEMORY_ERRORS
      6798**DCL      9273>>IF       9582<<ASSIGN   9666<<ASSIGN
MPCNOTIMP
      6927**DCL      9202--CALL
NEW_FEPERR_DATE
      6912**DCL      9280--CALL     9650<<ASSIGN
NEW_FEPERR_TIME
      6916**DCL      9280--CALL     9577<<ASSIGN   9651<<ASSIGN
NEW_IOERR_DATE
      6913**DCL      9308--CALL     9641<<ASSIGN
NEW_IOERR_TIME
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:214  
      6917**DCL      9308--CALL     9579<<ASSIGN   9642<<ASSIGN
NOTIMP
      6924**DCL      6985--DCLINIT  6987--DCLINIT  6988--DCLINIT  6989--DCLINIT  6990--DCLINIT  6991--DCLINIT
      6993--DCLINIT  6994--DCLINIT
NO_FILE
      9392**LABEL    9348--CALLALT
NO_FILE2
      9507**LABEL    9445--CALLALT
NO_REPORT
      9563**LABEL    9141--CALLALT  9164--CALLALT
NUM_DEV
      6803**DCL      9429<<ASSIGN   9473>>DOINDEX  9480<<ASSIGN   9480>>ASSIGN   9481>>ASSIGN   9482>>ASSIGN
      9486>>DOINDEX  9494<<ASSIGN   9494>>ASSIGN   9495>>ASSIGN   9496>>ASSIGN   9497>>ASSIGN   9498>>ASSIGN
      9524>>IF       9526>>DOINDEX
NUM_FEPERR
      6800**DCL      9277>>IF       9581<<ASSIGN   9625<<ASSIGN   9625>>ASSIGN   9644<<ASSIGN   9644>>ASSIGN
      9697>>IF       9698>>ASSIGN
NUM_IOERR_REC
      6799**DCL      9306>>IF       9580<<ASSIGN   9620<<ASSIGN   9620>>ASSIGN   9635<<ASSIGN   9635>>ASSIGN
      9681>>IF       9682>>ASSIGN
NUM_RECS
      6801**DCL      9347<<ASSIGN   9365>>IF       9367<<ASSIGN   9367>>ASSIGN   9430<<ASSIGN   9459<<ASSIGN
      9459>>ASSIGN   9534--CALL     9591<<ASSIGN   9655>>IF       9657<<ASSIGN   9657>>ASSIGN
NUM_TYPES
      6802**DCL      9428<<ASSIGN   9462>>DOINDEX  9468<<ASSIGN   9468>>ASSIGN   9469>>ASSIGN   9470>>ASSIGN
      9510>>IF       9512>>DOINDEX
OLD_FEPERR_DATE
      6910**DCL      9280--CALL     9627<<ASSIGN   9648<<ASSIGN
OLD_FEPERR_TIME
      6914**DCL      9280--CALL     9576<<ASSIGN   9628<<ASSIGN   9646>>IF       9647<<ASSIGN
OLD_IOERR_DATE
      6911**DCL      9308--CALL     9622<<ASSIGN   9639<<ASSIGN
OLD_IOERR_TIME
      6915**DCL      9308--CALL     9578<<ASSIGN   9623<<ASSIGN   9637>>IF       9638<<ASSIGN
ONFILE_ACCT
      8910**DCL      7999--DCLINIT  8147--DCLINIT
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:215  
ONFILE_NAME
      8897**DCL      7995--DCLINIT  8147--DCLINIT
ONFILE_PASS
      8923**DCL      7996--DCLINIT  8148--DCLINIT
ONFILE_RESULTS
      8962**DCL      8150--DCLINIT
ONFILE_SN
      8949**DCL      7994--DCLINIT  8148--DCLINIT
ONFILE_SPECIFIED
      6766**DCL      8993<<ASSIGN   9156<<ASSIGN   9176>>IF
ONFILE_WSN
      8936**DCL      8000--DCLINIT  8148--DCLINIT
OPEN_ERRLOG2
      7227**DCL      7612--DCLINIT  9606<>CALL     9688<>CALL
OPEN_ERRLOG2.ACSVEH_
      7229**DCL      7230--REDEF
OPEN_ERRLOG2.ALTKEYS_
      7235**DCL      7236--REDEF    7236--REDEF
OPEN_ERRLOG2.HDR_
      7234**DCL      7235--REDEF
OPEN_ERRLOG2.TAB_
      7233**DCL      7234--REDEF
OPEN_ERRLOG2.UHL_
      7227**DCL      7228--REDEF    7228--REDEF
OPEN_ERRLOG2.V
      7236**DCL      7227--DCLINIT
OPEN_ERRLOG2.V.FSN#
      7267**DCL      7267--REDEF    7267--REDEF
OPEN_ERRLOG2.V.FUN#
      7246**DCL      9255<<ASSIGN   9679<<ASSIGN
OPEN_ERRLOG2.WSN_
      7233**DCL      7233--REDEF
OPEN_ERRLOG3
      7421**DCL      7677--DCLINIT  9312<>CALL
OPEN_ERRLOG3.ACSVEH_
      7423**DCL      7424--REDEF
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:216  
OPEN_ERRLOG3.ALTKEYS_
      7429**DCL      7430--REDEF    7430--REDEF
OPEN_ERRLOG3.HDR_
      7428**DCL      7429--REDEF
OPEN_ERRLOG3.TAB_
      7427**DCL      7428--REDEF
OPEN_ERRLOG3.UHL_
      7421**DCL      7422--REDEF    7422--REDEF
OPEN_ERRLOG3.V
      7430**DCL      7421--DCLINIT
OPEN_ERRLOG3.V.FSN#
      7461**DCL      7461--REDEF    7461--REDEF
OPEN_ERRLOG3.V.FUN#
      7440**DCL      9257<<ASSIGN   9311<<ASSIGN
OPEN_ERRLOG3.WSN_
      7427**DCL      7427--REDEF
OPEN_ERRLOG4
      8245**DCL      8594--DCLINIT  9607<>CALL     9704<>CALL
OPEN_ERRLOG4.ACSVEH_
      8247**DCL      8248--REDEF
OPEN_ERRLOG4.ALTKEYS_
      8253**DCL      8254--REDEF    8254--REDEF
OPEN_ERRLOG4.HDR_
      8252**DCL      8253--REDEF
OPEN_ERRLOG4.TAB_
      8251**DCL      8252--REDEF
OPEN_ERRLOG4.UHL_
      8245**DCL      8246--REDEF    8246--REDEF
OPEN_ERRLOG4.V
      8254**DCL      8245--DCLINIT
OPEN_ERRLOG4.V.FSN#
      8285**DCL      8285--REDEF    8285--REDEF
OPEN_ERRLOG4.V.FUN#
      8264**DCL      9256<<ASSIGN   9680<<ASSIGN
OPEN_ERRLOG4.WSN_
      8251**DCL      8251--REDEF
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:217  
OPEN_ERRLOG5
      8428**DCL      8654--DCLINIT  9283<>CALL
OPEN_ERRLOG5.ACSVEH_
      8430**DCL      8431--REDEF
OPEN_ERRLOG5.ALTKEYS_
      8436**DCL      8437--REDEF    8437--REDEF
OPEN_ERRLOG5.HDR_
      8435**DCL      8436--REDEF
OPEN_ERRLOG5.TAB_
      8434**DCL      8435--REDEF
OPEN_ERRLOG5.UHL_
      8428**DCL      8429--REDEF    8429--REDEF
OPEN_ERRLOG5.V
      8437**DCL      8428--DCLINIT
OPEN_ERRLOG5.V.FSN#
      8468**DCL      8468--REDEF    8468--REDEF
OPEN_ERRLOG5.V.FUN#
      8447**DCL      9258<<ASSIGN   9282<<ASSIGN
OPEN_ERRLOG5.WSN_
      8434**DCL      8434--REDEF
OPEN_LO.ACSVEH_
      7877**DCL      7878--REDEF
OPEN_LO.ALTKEYS_
      7883**DCL      7884--REDEF    7884--REDEF
OPEN_LO.HDR_
      7882**DCL      7883--REDEF
OPEN_LO.TAB_
      7881**DCL      7882--REDEF
OPEN_LO.UHL_
      7875**DCL      7876--REDEF    7876--REDEF
OPEN_LO.V.FSN#
      7915**DCL      7915--REDEF    7915--REDEF
OPEN_LO.WSN_
      7881**DCL      7881--REDEF
OPN_ERR
      9557**LABEL    9157--CALLALT
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:218  
OUT$BLK.CODE
      7030**DCL      9003>>ASSIGN   9006>>DOCASE   9012>>ASSIGN   9155>>ASSIGN
OUT$BLK.NSUBLKS
      7034**DCL      9005>>DOINDEX  9010>>DOINDEX  9128>>IF
OUT$BLK.SUBLK$
      7055**DCL      9003>>ASSIGN   9006>>DOCASE   9010>>DOINDEX  9012>>ASSIGN   9012>>ASSIGN   9012>>ASSIGN
      9128>>IF       9128>>IF       9131>>ASSIGN   9131>>ASSIGN   9131>>ASSIGN   9151>>ASSIGN   9151>>ASSIGN
      9155>>ASSIGN   9155>>ASSIGN
OUT$SYM.COUNT
      7091**DCL      7094--IMP-SIZ  9132>>CALLBLT  9132>>CALLBLT  9133>>ASSIGN   9152>>ASSIGN
OUT$SYM.TEXT
      7094**DCL      9132>>CALLBLT  9152--ASSIGN
OUTPUT_DCB#
      6767**DCL      8994<<ASSIGN   9184<<ASSIGN
PMME_ERR
      9560**LABEL    9288--CALLALT  9304--CALLALT  9320--CALLALT  9335--CALLALT
RAW_HDR
      6959**DCL      6992--DCLINIT  6998--DCLINIT
READ_ERRLOG3
      7529**DCL      9323<>CALL
READ_ERRLOG3.BUF_
      7531**DCL      9321<<ASSIGN
READ_ERRLOG3.STATION_
      7532**DCL      7533--REDEF
READ_ERRLOG3.V
      7533**DCL      7529--DCLINIT
READ_ERRLOG3.V.DVBYTE.REREAD#
      7544**DCL      7544--REDEF
READ_ERRLOG3.V.INDX#
      7542**DCL      7542--REDEF
READ_ERRLOG5
      8531**DCL      9291<>CALL
READ_ERRLOG5.BUF_
      8533**DCL      9289<<ASSIGN
READ_ERRLOG5.STATION_
      8534**DCL      8535--REDEF
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:219  
READ_ERRLOG5.V
      8535**DCL      8531--DCLINIT
READ_ERRLOG5.V.DVBYTE.REREAD#
      8546**DCL      8546--REDEF
READ_ERRLOG5.V.INDX#
      8544**DCL      8544--REDEF
RECORD.INFO
      6816**DCL      9460--ASSIGN   9611--ASSIGN
RECORD.TYPE
      6815**DCL      6815--REDEF    9371>>ASSIGN   9461>>ASSIGN   9472>>IF       9485>>IF       9661>>ASSIGN
RECORD.UTS
      6815**DCL      9369>>ASSIGN   9659>>ASSIGN
RECORD_DATE
      7751**DCL      9376<>CALL     9610<>CALL
RECORD_DATE.V
      7755**DCL      7751--DCLINIT
RECORD_TYPE
      6805**DCL      9461<<ASSIGN   9463>>IF       9469>>ASSIGN
REPORT_CODE
      6919**DCL      9003<<ASSIGN   9170>>CALL     9187>>DOCASE   9237>>IF       9254>>IF       9365>>IF
      9378>>IF
SET_ONFILE
      7994**DCL      9157<>CALL
SET_ONFILE.ACSVEH_
      7996**DCL      7997--REDEF
SET_ONFILE.ALTKEYS_
      8002**DCL      8003--REDEF    8003--REDEF
SET_ONFILE.HDR_
      8001**DCL      8002--REDEF
SET_ONFILE.TAB_
      8000**DCL      8001--REDEF
SET_ONFILE.UHL_
      7994**DCL      7995--REDEF    7995--REDEF
SET_ONFILE.V
      8003**DCL      7994--DCLINIT
SET_ONFILE.V.ASN#
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:220  
      8013**DCL      8149--DCLINIT
SET_ONFILE.V.EXIST#
      8007**DCL      9155<<ASSIGN
SET_ONFILE.V.FSN#
      8034**DCL      8034--REDEF    8034--REDEF
SET_ONFILE.V.RES#
      8018**DCL      8149--DCLINIT
SET_ONFILE.WSN_
      8000**DCL      8000--REDEF
SILENCE_SORT
      8173**DCL      9683<>CALL     9699<>CALL
SILENCE_SORT.V
      8175**DCL      8173--DCLINIT
SORT_ERR IN PROCEDURE THC$DETAIL
      9714**LABEL    9683--CALLALT  9684--CALLALT  9699--CALLALT  9700--CALLALT
SORT_ERRLOG2
      7635**DCL      9684<>CALL
SORT_ERRLOG2.NREC#
      7692**DCL      9682<<ASSIGN
SORT_ERRLOG4
      8612**DCL      9700<>CALL
SORT_ERRLOG4.NREC#
      8669**DCL      9698<<ASSIGN
SORT_SUPPRESS
      8762**DCL      8174--DCLINIT
START_TIME
      6764**DCL      9339<>CALL     9340<<ASSIGN   9340>>ASSIGN   9341<>CALL     9341>>CALL     9345>>ASSIGN
      9437<>CALL     9438<<ASSIGN   9438>>ASSIGN   9439<>CALL     9439>>CALL     9443>>ASSIGN   9583<>CALL
      9584<<ASSIGN   9584>>ASSIGN   9585<>CALL     9585>>CALL     9589>>ASSIGN
STOP_TIME
      6765**DCL      9342<>CALL     9343<<ASSIGN   9343>>ASSIGN   9344<>CALL     9344>>CALL     9346>>DOWHILE
      9440<>CALL     9441<<ASSIGN   9441>>ASSIGN   9442<>CALL     9442>>CALL     9444>>DOWHILE  9586<>CALL
      9587<<ASSIGN   9587>>ASSIGN   9588<>CALL     9588>>CALL     9590>>DOWHILE
SUM_ENTRY
      6932**DCL      9519--CALL
SUM_FMT
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:221  
      6930**DCL      9511--CALL
SUM_HDR
      6969**DCL      6997--DCLINIT
SUM_TOT
      6939**DCL      9534--CALL
SYM$
      6786**DCL      7068--IMP-PTR  9131<<ASSIGN   9132>>CALLBLT  9132>>CALLBLT  9132>>CALLBLT  9133>>ASSIGN
      9151<<ASSIGN   9152>>ASSIGN   9152>>ASSIGN
SYS_HDR
      6965**DCL      6995--DCLINIT
TBUF
      6782**DCL      7803--DCLINIT  7804--DCLINIT  9372--CALL     9662--CALL
TEMP_BUF
      6774**DCL      8999<<ASSIGN   9009<<ASSIGN   9143<<CALLBLT  9146<<CALLBLT  9167<>CALL     9230<>CALL
      9231>>CALLBLT  9407<>CALL     9408>>CALLBLT  9515<>CALL     9516<>CALL
TEMP_BUF2
      6775**DCL      9227<<CALLBLT  9231<<CALLBLT  9234<>CALL     9404<<CALLBLT  9408<<CALLBLT  9411<>CALL
TEXT
      6787**DCL      9011<<ASSIGN   9017<<ASSIGN   9021<<ASSIGN   9025<<ASSIGN   9029<<ASSIGN   9033<<ASSIGN
      9037<<ASSIGN   9041<<ASSIGN   9044<<ASSIGN   9047<<ASSIGN   9050<<ASSIGN   9053<<ASSIGN   9056<<ASSIGN
      9059<<ASSIGN   9062<<ASSIGN   9065<<ASSIGN   9068<<ASSIGN   9071<<ASSIGN   9074<<ASSIGN   9077<<ASSIGN
      9081<<ASSIGN   9084<<ASSIGN   9087<<ASSIGN   9090<<ASSIGN   9093<<ASSIGN   9097<<ASSIGN   9100<<ASSIGN
      9104<<ASSIGN   9108<<ASSIGN   9112<<ASSIGN   9116<<ASSIGN   9120<<ASSIGN   9124<<ASSIGN   9132<<CALLBLT
      9141<>CALL     9146>>CALLBLT  9163<<ASSIGN   9164<>CALL
TEXT$
      6768**DCL      9166<<ASSIGN   9167<>CALL     9223<<ASSIGN   9234<>CALL     9400<<ASSIGN   9411<>CALL
      9513<<ASSIGN   9516<>CALL
TEXTBUF
      6769**DCL      9166--ASSIGN   9168--ASSIGN   9223--ASSIGN   9235--ASSIGN   9400--ASSIGN   9412--ASSIGN
      9513--ASSIGN   9517--ASSIGN
TEXT_LEN
      6791**DCL      9134<<ASSIGN   9138<<ASSIGN   9146>>CALLBLT  9147>>ASSIGN
THC$DETAIL
      9569**PROC     9272--CALL
THC$TYPENAME
      6744**DCL-ENT  9230--CALL     9407--CALL     9515--CALL
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:222  
THF$ADD_TEXTC
      6745**DCL-ENT  9167--CALL     9234--CALL     9411--CALL     9516--CALL
THF$AMS
      6746**DCL-ENT  9190--CALL
THF$CONFIG
      6743**DCL-ENT  9193--CALL
THF$DUMP
      6735**DCL-ENT  9373--CALL     9663--CALL
THF$HWE
      6742**DCL-ENT  9206--CALL     9275--CALL
THF$RAW
      6736**DCL-ENT  9292--CALL     9302--CALL     9324--CALL     9333--CALL     9381--CALL     9384--CALL
      9668--CALL
THF$SYS
      6748**DCL-ENT  9541--CALL
THF$UPR
      6747**DCL-ENT  9544--CALL
THG$CLOSEXSA
      6740**DCL-ENT  9394--CALL     9509--CALL     9716--CALL
THG$GETREC
      6737**DCL-ENT  9364--CALL     9458--CALL     9609--CALL
THG$OPENXSA
      6738**DCL-ENT  9348--CALL     9445--CALL     9592--CALL
THG$PRECORDXSA
      6739**DCL-ENT  9362--CALL     9456--CALL     9605--CALL
THM$ERRMSG
      6733**DCL-ENT  9296--CALL     9328--CALL     9557--CALL     9560--CALL     9565--CALL     9714--CALL
THS$SET_DEVS
      6734**DCL-ENT  9141--CALL     9164--CALL
THW$WRITE
      6741**DCL-ENT  9170--CALL     9199--CALL     9202--CALL     9205--CALL     9239--CALL     9246--CALL
      9252--CALL     9278--CALL     9280--CALL     9307--CALL     9308--CALL     9366--CALL     9372--CALL
      9414--CALL     9420--CALL     9426--CALL     9511--CALL     9519--CALL     9525--CALL     9529--CALL
      9534--CALL     9656--CALL     9662--CALL
TH_BRKMSG
      4739**DCL      9189<<ASSIGN   9192<<ASSIGN   9197<<ASSIGN   9221<<ASSIGN   9398<<ASSIGN   9540<<ASSIGN
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:223  
      9543<<ASSIGN
TH_CHECK_DEVNM
      4753**DCL      9359<<ASSIGN   9360<<ASSIGN   9453<<ASSIGN   9454<<ASSIGN   9602<<ASSIGN   9603<<ASSIGN
TH_CONSTRAINTS
      4715**DCL      9186>>ASSIGN   9552<<ASSIGN
TH_CONSTRAINTS.DEVNM
      4715**DCL      9357<<ASSIGN   9358>>IF       9451<<ASSIGN   9452>>IF       9600<<ASSIGN   9601>>IF
TH_CONSTRAINTS.E_BY_B
      4718**DCL      4718--REDEF
TH_CONSTRAINTS.E_BY_B_SET
      4719**DCL      9248>>IF       9422>>IF
TH_CONSTRAINTS.E_CHAN_SET
      4720**DCL      9248>>IF
TH_CONSTRAINTS.E_FEP_SET
      4720**DCL      9248>>IF       9422>>IF
TH_CONSTRAINTS.E_MAJ_S
      4718**DCL      9248>>IF       9422>>IF
TH_CONSTRAINTS.E_MED_S
      4718**DCL      9248>>IF       9422>>IF
TH_CONSTRAINTS.E_SUB_S
      4718**DCL      9248>>IF       9422>>IF
TH_CONSTRAINTS.M_BY_B
      4717**DCL      4717--REDEF
TH_CONSTRAINTS.M_BY_B_SET
      4717**DCL      9242>>IF       9416>>IF
TH_CONSTRAINTS.M_CHAN_SET
      4719**DCL      9242>>IF       9416>>IF       9422>>IF
TH_CONSTRAINTS.M_FEP_SET
      4719**DCL      9242>>IF       9416>>IF
TH_CONSTRAINTS.M_MAJ_S
      4716**DCL      9242>>IF       9416>>IF
TH_CONSTRAINTS.M_MED_S
      4717**DCL      9242>>IF       9416>>IF
TH_CONSTRAINTS.M_SUB_S
      4716**DCL      9242>>IF       9416>>IF
TH_CONSTRAINTS.NTYPES
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:224  
      4715**DCL      9222>>IF       9225>>DOINDEX  9399>>IF       9402>>DOINDEX  9527>>IF       9527>>IF
TH_CONSTRAINTS.OCTAL
      4722**DCL      9368>>IF       9658>>IF
TH_CONSTRAINTS.START
      4716**DCL      9170--CALL     9339<>CALL     9362<>CALL     9437<>CALL     9456<>CALL     9583<>CALL
      9605<>CALL
TH_CONSTRAINTS.STOP
      4716**DCL      9170--CALL     9342<>CALL     9440<>CALL     9586<>CALL
TH_CONSTRAINTS.TYPES
      4715**DCL      4715--REDEF    9230<>CALL     9407<>CALL
TH_DATE
      4746**DCL      7751--DCLINIT  7752--DCLINIT
TH_DAY
      4746**DCL      7754--DCLINIT
TH_DEFAULT.E_BY_B
      4726**DCL      4726--REDEF
TH_DEFAULT.M_BY_B
      4725**DCL      4725--REDEF
TH_DEFAULT.TYPES
      4723**DCL      4723--REDEF
TH_DETAIL_FLG
      4754**DCL      9377<<ASSIGN   9550<<ASSIGN   9575<<ASSIGN
TH_DETAIL_FMT
      6778**DCL      9292<>CALL     9302<>CALL     9324<>CALL     9333<>CALL     9668<>CALL
TH_EOF_FLG
      4755**DCL      9301<<ASSIGN   9315<<ASSIGN   9332<<ASSIGN   9546<<ASSIGN   9571<<ASSIGN
TH_EXTENDED_FMT
      6779**DCL      9384<>CALL
TH_FEPERR_FLG
      4754**DCL      9219<<ASSIGN   9279<<ASSIGN   9317<<ASSIGN   9549<<ASSIGN   9574<<ASSIGN
TH_FIRST_TIME
      4754**DCL      9286<<ASSIGN   9318<<ASSIGN   9547<<ASSIGN   9572<<ASSIGN   9616>>IF       9630<<ASSIGN
TH_IOERR_FLG
      4754**DCL      9218<<ASSIGN   9316<<ASSIGN   9548<<ASSIGN   9573<<ASSIGN
TH_ITYPE
      4745**DCL      9287<<ASSIGN   9319<<ASSIGN   9616>>IF       9616>>IF       9618>>DOCASE   9632>>IF
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:225  
      9632>>IF       9633>>DOCASE   9655>>IF       9665>>IF
TH_LASTTYPE
      4745**DCL      9395<<ASSIGN   9717<<ASSIGN
TH_LASTUTS
      4745**DCL      7755--DCLINIT
TH_LAST_EXCLUDE
      4748**DCL      9252--CALL     9426--CALL
TH_LAST_MATCH
      4747**DCL      9246--CALL     9420--CALL
TH_LAST_REQID
      4749**DCL      9241<<ASSIGN
TH_NUM_REP_DEVS
      4740**DCL      9004<<ASSIGN   9353<<ASSIGN   9356>>DOINDEX  9447<<ASSIGN   9450>>DOINDEX  9551<<ASSIGN
      9595<<ASSIGN   9599>>DOINDEX
TH_OUTBUF
      7000**DCL      9179<<ASSIGN   9179>>ASSIGN   9180>>CALLBLT
TH_RAW_FLG
      4754**DCL      9220<<ASSIGN   9380<<ASSIGN
TH_RAW_FMT
      6777**DCL      9381<>CALL
TH_RECORD.BOUND
      4743**DCL      9612>>ASSIGN   9614>>ASSIGN
TH_RECORD.PTR$
      4743**DCL      6815--IMP-PTR  9369>>ASSIGN   9371>>ASSIGN   9373<>CALL     9460>>ASSIGN   9461>>ASSIGN
      9472>>IF       9485>>IF       9611>>ASSIGN   9659>>ASSIGN   9661>>ASSIGN   9663<>CALL
TH_REP_DEVS
      4741**DCL      9354<<ASSIGN   9357>>ASSIGN   9448<<ASSIGN   9451>>ASSIGN   9596<<ASSIGN   9600>>ASSIGN
TH_SAVE
      4730**DCL      9186<<ASSIGN   9552>>ASSIGN
TH_SAVE.E_BY_B
      4734**DCL      4734--REDEF
TH_SAVE.M_BY_B
      4732**DCL      4732--REDEF
TH_SAVE.TYPES
      4730**DCL      4731--REDEF
TH_SITE_ID
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:226  
      4746**DCL      9170--CALL
TH_SITE_NAME
      4747**DCL      9170--CALL
TH_TIME
      4746**DCL      7753--DCLINIT  7754--DCLINIT  9623>>ASSIGN   9628>>ASSIGN   9638>>ASSIGN   9642>>ASSIGN
      9647>>ASSIGN   9651>>ASSIGN
TH_XSA_BUF.P$
      4751**DCL      9303>>IF       9334>>IF
TH_XSA_BUF_VECTOR
      4750**DCL      4750--REDEF    7566--DCLINIT  9289>>ASSIGN   9321>>ASSIGN
TIME_FMT
      7005**DCL      9280<>CALL     9308<>CALL
TIME_HDR
      7003**DCL      7005--DCLINIT
TOP$
         7**DCL         6--PROC     7022--IMP-PTR  9003>>ASSIGN   9005>>DOINDEX  9006>>DOCASE   9010>>DOINDEX
      9012>>ASSIGN   9128>>IF       9131>>ASSIGN   9151>>ASSIGN   9155>>ASSIGN
TVEC
      6770**DCL      9168<<ASSIGN   9170<>CALL     9235<<ASSIGN   9239<>CALL     9412<<ASSIGN   9414<>CALL
      9517<<ASSIGN   9519<>CALL
TVEC.BOUND
      6771**DCL      9169<<ASSIGN   9236<<ASSIGN   9413<<ASSIGN   9518<<ASSIGN
TYPE
      6780**DCL      9371<<ASSIGN   9372--CALL     9661<<ASSIGN   9662--CALL
TYPEB
      6806**DCL      9514<<ASSIGN   9515<>CALL
TYPES
      6804**DCL      9463>>IF       9469<<ASSIGN   9514>>ASSIGN
TYPE_CNT
      6807**DCL      9464<<ASSIGN   9464>>ASSIGN   9470<<ASSIGN   9519--CALL
TYPE_FMT
      6928**DCL      9239--CALL     9414--CALL
UPR_HDR
      6967**DCL      6996--DCLINIT
VLP_NAME
      8735**DCL      8173--DCLINIT
PL6.E3A0      #003=THC$REPORT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:07 Page:227  
WRITE_ERRLOG2
      7335**DCL      9621<>CALL     9636<>CALL
WRITE_ERRLOG2.BUF_.BOUND
      7335**DCL      9614<<ASSIGN
WRITE_ERRLOG2.BUF_.BUF$
      7337**DCL      9615<<ASSIGN
WRITE_ERRLOG2.STATION_
      7337**DCL      7337--REDEF
WRITE_ERRLOG2.V
      7338**DCL      7335--DCLINIT
WRITE_ERRLOG2.V.DVBYTE.VFC#
      7344**DCL      7344--REDEF
WRITE_ERRLOG4
      8348**DCL      9626<>CALL     9645<>CALL
WRITE_ERRLOG4.BUF_.BOUND
      8348**DCL      9612<<ASSIGN
WRITE_ERRLOG4.BUF_.BUF$
      8350**DCL      9613<<ASSIGN
WRITE_ERRLOG4.STATION_
      8350**DCL      8350--REDEF
WRITE_ERRLOG4.V
      8351**DCL      8348--DCLINIT
WRITE_ERRLOG4.V.DVBYTE.VFC#
      8357**DCL      8357--REDEF
X$SORT
      6730**DCL-ENT  9684--CALL     9700--CALL
XUD$UTS_ADJ_25TH
      7135**DCL-ENT  9341--CALL     9344--CALL     9392--CALL     9439--CALL     9442--CALL     9507--CALL
      9585--CALL     9588--CALL     9675--CALL
XUD$UTS_DIFF_SEC
      7117**DCL-ENT  9339--CALL     9342--CALL     9437--CALL     9440--CALL     9583--CALL     9586--CALL

PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:228  
     1253        1        /*T***********************************************************/
     1254        2        /*T*                                                         */
     1255        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1256        4        /*T*                                                         */
     1257        5        /*T***********************************************************/
     1258        6        /* IOERR$COMPARE IS A USER_CODE ROUTINE TO COMPARE KEYS FOR IOERR   */
     1259        7        IOERR$COMPARE: PROC(RECORD1,RECORD2,RESULT);
     1260        8        %INCLUDE EL$TABLES;
     1261      331        %INCLUDE CP_6;
     1262      412    1   DCL RESULT SBIN;
     1263      413        %EL$IOERR(NAME=RECORD1,STCLASS=" ");
     1264      423        %EL$IOERR(NAME=RECORD2,STCLASS=" ");
     1265      433    1   DCL 1 REC1 AUTO,
     1266      434    1         2 DENSE1 UBIN(4) UNAL,
     1267      435    1         2 DENSE2 UBIN(4) UNAL;
     1268      436    1   DCL 1 REC1_RDF REDEF REC1 UBIN(8) UNAL;
     1269      437    1   DCL 1 REC2 AUTO,
     1270      438    1         2 DENSE1 UBIN(4) UNAL,
     1271      439    1         2 DENSE2 UBIN(4) UNAL;
     1272      440    1   DCL 1 REC2_RDF REDEF REC2 UBIN(8) UNAL;
     1273      441        /**/
     1274      442    1   REC1_RDF = RECORD1.EXTST(2);
     1275      443    1   REC2_RDF = RECORD2.EXTST(2);
     1276      444    1   RESULT = 0;
     1277      445
     1278      446    1   IF RECORD1.DEVNM < RECORD2.DEVNM THEN RESULT = 1;
     1279      447    1   ELSE IF RECORD1.DEVNM > RECORD2.DEVNM THEN RESULT = 2;
     1280      448    1   ELSE
     1281      449    1      IF RECORD1.IOCHAN < RECORD2.IOCHAN THEN RESULT = 1;
     1282      450    1      ELSE IF RECORD1.IOCHAN > RECORD2.IOCHAN THEN RESULT = 2;
     1283      451    1      ELSE
     1284      452    1         IF RECORD1.XSTATUS.MAJOR < RECORD2.XSTATUS.MAJOR THEN RESULT = 1;
     1285      453    1         ELSE IF RECORD1.XSTATUS.MAJOR > RECORD2.XSTATUS.MAJOR THEN RESULT = 2;
     1286      454    1         ELSE
     1287      455    1            IF BITBIN(RECORD1.XSTATUS.MINOR) < BITBIN(RECORD2.XSTATUS.MINOR)
     1288      456    1            THEN RESULT = 1;
     1289      457    1            ELSE IF BITBIN(RECORD1.XSTATUS.MINOR) > BITBIN(RECORD2.XSTATUS.MINOR)
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:229  
     1290      458    1            THEN RESULT = 2;
     1291      459    1            ELSE
     1292      460    1               IF RECORD1.MODEL < RECORD2.MODEL THEN RESULT = 1;
     1293      461    1               ELSE IF RECORD1.MODEL > RECORD2.MODEL THEN RESULT = 2;
     1294      462    1               ELSE
     1295      463    1                  IF REC1.DENSE1 < REC2.DENSE1 THEN RESULT = 1;
     1296      464    1                  ELSE IF REC1.DENSE1 > REC2.DENSE1 THEN RESULT = 2;
     1297      465    1                  ELSE
     1298      466    1                     IF RECORD1.IDCW < RECORD2.IDCW THEN RESULT = 1;
     1299      467    1                     ELSE IF RECORD1.IDCW > RECORD2.IDCW THEN RESULT = 2;
     1300      468    1   END IOERR$COMPARE;
     1301      469        %EOD;

PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:230  
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IOERR$COMPARE.

   Procedure IOERR$COMPARE requires 124 words for executable code.
   Procedure IOERR$COMPARE requires 10 words of local(AUTO) storage.

PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:231  

 Object Unit name= IOERR$COMPARE                              File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:10:20.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   124    174  IOERR$COMPARE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  IOERR$COMPARE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:232  


     1253        1        /*T***********************************************************/
     1254        2        /*T*                                                         */
     1255        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1256        4        /*T*                                                         */
     1257        5        /*T***********************************************************/
     1258        6        /* IOERR$COMPARE IS A USER_CODE ROUTINE TO COMPARE KEYS FOR IOERR   */
     1259        7        IOERR$COMPARE: PROC(RECORD1,RECORD2,RESULT);

      7  1 000000   000000 700200 xent  IOERR$COMPA* TSX0  ! X66_AUTO_3
         1 000001   000012 000003                    ZERO    10,3

     1260        8        %INCLUDE EL$TABLES;
     1261      331        %INCLUDE CP_6;
     1262      412    1   DCL RESULT SBIN;
     1263      413        %EL$IOERR(NAME=RECORD1,STCLASS=" ");
     1264      423        %EL$IOERR(NAME=RECORD2,STCLASS=" ");
     1265      433    1   DCL 1 REC1 AUTO,
     1266      434    1         2 DENSE1 UBIN(4) UNAL,
     1267      435    1         2 DENSE2 UBIN(4) UNAL;
     1268      436    1   DCL 1 REC1_RDF REDEF REC1 UBIN(8) UNAL;
     1269      437    1   DCL 1 REC2 AUTO,
     1270      438    1         2 DENSE1 UBIN(4) UNAL,
     1271      439    1         2 DENSE2 UBIN(4) UNAL;
     1272      440    1   DCL 1 REC2_RDF REDEF REC2 UBIN(8) UNAL;
     1273      441        /**/
     1274      442    1   REC1_RDF = RECORD1.EXTST(2);

    442  1 000002   200003 470500                    LDP0    @RECORD1,,AUTO
         1 000003   000013 236100                    LDQ     11,,PR0
         1 000004   000020 736000                    QLS     16
         1 000005   200006 676100                    ERQ     REC1,,AUTO
         1 000006   776000 376003                    ANQ     -1024,DU
         1 000007   200006 656100                    ERSQ    REC1,,AUTO

     1275      443    1   REC2_RDF = RECORD2.EXTST(2);

PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:233  
    443  1 000010   200004 471500                    LDP1    @RECORD2,,AUTO
         1 000011   100013 236100                    LDQ     11,,PR1
         1 000012   000020 736000                    QLS     16
         1 000013   200007 676100                    ERQ     REC2,,AUTO
         1 000014   776000 376003                    ANQ     -1024,DU
         1 000015   200007 656100                    ERSQ    REC2,,AUTO

     1276      444    1   RESULT = 0;

    444  1 000016   200005 473500                    LDP3    @RESULT,,AUTO
         1 000017   300000 450100                    STZ     0,,PR3

     1277      445
     1278      446    1   IF RECORD1.DEVNM < RECORD2.DEVNM THEN RESULT = 1;

    446  1 000020   040100 106500                    CMPC    fill='040'O
         1 000021   000024 000010                    ADSC9   20,,PR0                  cn=0,n=8
         1 000022   100024 000010                    ADSC9   20,,PR1                  cn=0,n=8
         1 000023   000027 603000 1                  TRC     s:447

    446  1 000024   000001 235007                    LDA     1,DL
         1 000025   300000 755100                    STA     0,,PR3
         1 000026   000173 710000 1                  TRA     s:468

     1279      447    1   ELSE IF RECORD1.DEVNM > RECORD2.DEVNM THEN RESULT = 2;

    447  1 000027   000034 602000 1                  TNC     s:449
         1 000030   000034 600000 1                  TZE     s:449

    447  1 000031   000002 235007                    LDA     2,DL
         1 000032   300000 755100                    STA     0,,PR3
         1 000033   000173 710000 1                  TRA     s:468

     1280      448    1   ELSE
     1281      449    1      IF RECORD1.IOCHAN < RECORD2.IOCHAN THEN RESULT = 1;

    449  1 000034   000005 220100                    LDX0    5,,PR0
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:234  
         1 000035   100005 100100                    CMPX0   5,,PR1
         1 000036   000042 603000 1                  TRC     s:450

    449  1 000037   000001 235007                    LDA     1,DL
         1 000040   300000 755100                    STA     0,,PR3
         1 000041   000173 710000 1                  TRA     s:468

     1282      450    1      ELSE IF RECORD1.IOCHAN > RECORD2.IOCHAN THEN RESULT = 2;

    450  1 000042   100005 221100                    LDX1    5,,PR1
         1 000043   000005 101100                    CMPX1   5,,PR0
         1 000044   000050 603000 1                  TRC     s:452

    450  1 000045   000002 235007                    LDA     2,DL
         1 000046   300000 755100                    STA     0,,PR3
         1 000047   000173 710000 1                  TRA     s:468

     1283      451    1      ELSE
     1284      452    1         IF RECORD1.XSTATUS.MAJOR < RECORD2.XSTATUS.MAJOR THEN RESULT = 1;

    452  1 000050   100001 236100                    LDQ     1,,PR1
         1 000051   000036 772000                    QRL     30
         1 000052   200010 756100                    STQ     REC2+1,,AUTO
         1 000053   000001 236100                    LDQ     1,,PR0
         1 000054   000036 772000                    QRL     30
         1 000055   200010 116100                    CMPQ    REC2+1,,AUTO
         1 000056   000062 605000 1                  TPL     s:453

    452  1 000057   000001 235007                    LDA     1,DL
         1 000060   300000 755100                    STA     0,,PR3
         1 000061   000173 710000 1                  TRA     s:468

     1285      453    1         ELSE IF RECORD1.XSTATUS.MAJOR > RECORD2.XSTATUS.MAJOR THEN RESULT = 2;

    453  1 000062   200010 756100                    STQ     REC2+1,,AUTO
         1 000063   100001 236100                    LDQ     1,,PR1
         1 000064   000036 772000                    QRL     30
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:235  
         1 000065   200010 116100                    CMPQ    REC2+1,,AUTO
         1 000066   000072 605000 1                  TPL     s:455

    453  1 000067   000002 235007                    LDA     2,DL
         1 000070   300000 755100                    STA     0,,PR3
         1 000071   000173 710000 1                  TRA     s:468

     1286      454    1         ELSE
     1287      455    1            IF BITBIN(RECORD1.XSTATUS.MINOR) < BITBIN(RECORD2.XSTATUS.MINOR)

    455  1 000072   000001 236100                    LDQ     1,,PR0
         1 000073   000030 772000                    QRL     24
         1 000074   000077 376007                    ANQ     63,DL
         1 000075   200010 756100                    STQ     REC2+1,,AUTO
         1 000076   100001 236100                    LDQ     1,,PR1
         1 000077   000030 772000                    QRL     24
         1 000100   000077 376007                    ANQ     63,DL
         1 000101   200010 116100                    CMPQ    REC2+1,,AUTO
         1 000102   000107 602000 1                  TNC     s:457
         1 000103   000107 600000 1                  TZE     s:457

     1288      456    1            THEN RESULT = 1;

    456  1 000104   000001 235007                    LDA     1,DL
         1 000105   300000 755100                    STA     0,,PR3
         1 000106   000173 710000 1                  TRA     s:468

     1289      457    1            ELSE IF BITBIN(RECORD1.XSTATUS.MINOR) > BITBIN(RECORD2.XSTATUS.MINOR)

    457  1 000107   000001 236100                    LDQ     1,,PR0
         1 000110   000030 772000                    QRL     24
         1 000111   000077 376007                    ANQ     63,DL
         1 000112   200010 756100                    STQ     REC2+1,,AUTO
         1 000113   100001 236100                    LDQ     1,,PR1
         1 000114   000030 772000                    QRL     24
         1 000115   000077 376007                    ANQ     63,DL
         1 000116   200010 116100                    CMPQ    REC2+1,,AUTO
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:236  
         1 000117   000123 603000 1                  TRC     s:460

     1290      458    1            THEN RESULT = 2;

    458  1 000120   000002 235007                    LDA     2,DL
         1 000121   300000 755100                    STA     0,,PR3
         1 000122   000173 710000 1                  TRA     s:468

     1291      459    1            ELSE
     1292      460    1               IF RECORD1.MODEL < RECORD2.MODEL THEN RESULT = 1;

    460  1 000123   040100 106500                    CMPC    fill='040'O
         1 000124   000030 000010                    ADSC9   24,,PR0                  cn=0,n=8
         1 000125   100030 000010                    ADSC9   24,,PR1                  cn=0,n=8
         1 000126   000132 603000 1                  TRC     s:461

    460  1 000127   000001 235007                    LDA     1,DL
         1 000130   300000 755100                    STA     0,,PR3
         1 000131   000173 710000 1                  TRA     s:468

     1293      461    1               ELSE IF RECORD1.MODEL > RECORD2.MODEL THEN RESULT = 2;

    461  1 000132   000137 602000 1                  TNC     s:463
         1 000133   000137 600000 1                  TZE     s:463

    461  1 000134   000002 235007                    LDA     2,DL
         1 000135   300000 755100                    STA     0,,PR3
         1 000136   000173 710000 1                  TRA     s:468

     1294      462    1               ELSE
     1295      463    1                  IF REC1.DENSE1 < REC2.DENSE1 THEN RESULT = 1;

    463  1 000137   200007 236100                    LDQ     REC2,,AUTO
         1 000140   000040 772000                    QRL     32
         1 000141   200010 756100                    STQ     REC2+1,,AUTO
         1 000142   200006 236100                    LDQ     REC1,,AUTO
         1 000143   000040 772000                    QRL     32
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:237  
         1 000144   200010 116100                    CMPQ    REC2+1,,AUTO
         1 000145   000151 605000 1                  TPL     s:464

    463  1 000146   000001 235007                    LDA     1,DL
         1 000147   300000 755100                    STA     0,,PR3
         1 000150   000173 710000 1                  TRA     s:468

     1296      464    1                  ELSE IF REC1.DENSE1 > REC2.DENSE1 THEN RESULT = 2;

    464  1 000151   200010 756100                    STQ     REC2+1,,AUTO
         1 000152   200007 236100                    LDQ     REC2,,AUTO
         1 000153   000040 772000                    QRL     32
         1 000154   200010 116100                    CMPQ    REC2+1,,AUTO
         1 000155   000161 605000 1                  TPL     s:466

    464  1 000156   000002 235007                    LDA     2,DL
         1 000157   300000 755100                    STA     0,,PR3
         1 000160   000173 710000 1                  TRA     s:468

     1297      465    1                  ELSE
     1298      466    1                     IF RECORD1.IDCW < RECORD2.IDCW THEN RESULT = 1;

    466  1 000161   000010 236100                    LDQ     8,,PR0
         1 000162   100010 116100                    CMPQ    8,,PR1
         1 000163   000167 603000 1                  TRC     s:467

    466  1 000164   000001 235007                    LDA     1,DL
         1 000165   300000 755100                    STA     0,,PR3
         1 000166   000173 710000 1                  TRA     s:468

     1299      467    1                     ELSE IF RECORD1.IDCW > RECORD2.IDCW THEN RESULT = 2;

    467  1 000167   000173 602000 1                  TNC     s:468
         1 000170   000173 600000 1                  TZE     s:468

    467  1 000171   000002 235007                    LDA     2,DL
         1 000172   300000 755100                    STA     0,,PR3
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:238  

     1300      468    1   END IOERR$COMPARE;

    468  1 000173   000000 702200 xent               TSX2  ! X66_ARET
     1301      469        %EOD;

PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:239  
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IOERR$COMPARE.
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:240  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @RECORD1                   4-0-0/w PTR         r     1 @RECORD2
     5-0-0/w PTR         r     1 @RESULT                    6-0-0/b STRC(8)     r     1 REC1
     6-0-0/b UBIN(8)     r     1 REC1_RDF                   7-0-0/b STRC(8)     r     1 REC2
     7-0-0/b UBIN(8)     r     1 REC2_RDF                  *0-0-0/w STRC(1080)  r     1 RECORD1
    *0-0-0/w STRC(1080)  r     1 RECORD2                   *0-0-0/w SBIN        r     1 RESULT


   Procedure IOERR$COMPARE requires 124 words for executable code.
   Procedure IOERR$COMPARE requires 10 words of local(AUTO) storage.
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:241  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:242  
          MINI XREF LISTING

REC1
       433**DCL       436--REDEF
REC1.DENSE1
       434**DCL       463>>IF        464>>IF
REC1_RDF
       436**DCL       442<<ASSIGN
REC2
       437**DCL       440--REDEF
REC2.DENSE1
       438**DCL       463>>IF        464>>IF
REC2_RDF
       440**DCL       443<<ASSIGN
RECORD1
       414**DCL         7--PROC
RECORD1.DEVNM
       419**DCL       446>>IF        447>>IF
RECORD1.EXTST
       418**DCL       442>>ASSIGN
RECORD1.IDCW
       418**DCL       466>>IF        467>>IF
RECORD1.IOCHAN
       416**DCL       449>>IF        450>>IF
RECORD1.MODEL
       420**DCL       460>>IF        461>>IF
RECORD1.SEEK
       418**DCL       419--REDEF
RECORD1.STATUS
       414**DCL       415--REDEF
RECORD1.XSTATUS.MAJOR
       415**DCL       452>>IF        453>>IF
RECORD1.XSTATUS.MINOR
       415**DCL       455>>IF        457>>IF
PL6.E3A0      #004=IOERR$COMPARE File=THC$COMMANDS.:E05TSI                       WED 07/30/97 06:10 Page:243  
RECORD2
       424**DCL         7--PROC
RECORD2.DEVNM
       429**DCL       446>>IF        447>>IF
RECORD2.EXTST
       428**DCL       443>>ASSIGN
RECORD2.IDCW
       428**DCL       466>>IF        467>>IF
RECORD2.IOCHAN
       426**DCL       449>>IF        450>>IF
RECORD2.MODEL
       430**DCL       460>>IF        461>>IF
RECORD2.SEEK
       428**DCL       429--REDEF
RECORD2.STATUS
       424**DCL       425--REDEF
RECORD2.XSTATUS.MAJOR
       425**DCL       452>>IF        453>>IF
RECORD2.XSTATUS.MINOR
       425**DCL       455>>IF        457>>IF
RESULT
       412**DCL         7--PROC      444<<ASSIGN    446<<ASSIGN    447<<ASSIGN    449<<ASSIGN    450<<ASSIGN
       452<<ASSIGN    453<<ASSIGN    456<<ASSIGN    458<<ASSIGN    460<<ASSIGN    461<<ASSIGN    463<<ASSIGN
       464<<ASSIGN    466<<ASSIGN    467<<ASSIGN

PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:244  
     1302        1        /*T***********************************************************/
     1303        2        /*T*                                                         */
     1304        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1305        4        /*T*                                                         */
     1306        5        /*T***********************************************************/
     1307        6        /* FEPERR$COMPARE IS A USR_CODE ROUTINE TO COMPARE KEYS FOR FEPERR */
     1308        7        FEPERR$COMPARE: PROC(RECD1,RECD2,RES);
     1309        8        %INCLUDE EL$TABLES;
     1310      331        %INCLUDE CP_6;
     1311      412    1   DCL RES SBIN;
     1312      413        %EL$FEPERR(NAME=RECD1,STCLASS=" ");
     1313      492        %EL$FEPERR(NAME=RECD2,STCLASS=" ");
     1314      571        /**/
     1315      572    1   RES = 0;
     1316      573
     1317      574    1   IF RECD1.STATDATA.NODE < RECD2.STATDATA.NODE THEN RES = 1;
     1318      575    1   ELSE IF RECD1.STATDATA.NODE > RECD2.STATDATA.NODE THEN RES = 2;
     1319      576    1   ELSE
     1320      577    1      IF RECD1.STATDATA.TERMID.TERM.CHANNEL < RECD2.STATDATA.TERMID.TERM.CHANNEL
     1321      578    1      THEN RES = 1;
     1322      579    1      ELSE IF RECD1.STATDATA.TERMID.TERM.CHANNEL > RECD2.STATDATA.TERMID.TERM.CHANNEL
     1323      580    1      THEN RES = 2;
     1324      581    1      ELSE
     1325      582    1            IF RECD1.STATDATA.ERRCODE.FCG < RECD2.STATDATA.ERRCODE.FCG THEN RES = 1;
     1326      583    1            ELSE IF RECD1.STATDATA.ERRCODE.FCG > RECD2.STATDATA.ERRCODE.FCG THEN RES =
               583                     2;
     1327      584    1            ELSE
     1328      585    1               IF RECD1.STATDATA.ERRCODE.ERR# < RECD2.STATDATA.ERRCODE.ERR#
     1329      586    1               THEN RES = 1;
     1330      587    1               ELSE IF RECD1.STATDATA.ERRCODE.ERR# > RECD2.STATDATA.ERRCODE.ERR#
     1331      588    1               THEN RES = 2;
     1332      589    1               ELSE
     1333      590    1                  IF RECD1.STATDATA.ERRCODE.SEV < RECD2.STATDATA.ERRCODE.SEV
     1334      591    1                  THEN RES = 1;
     1335      592    1                  ELSE IF RECD1.STATDATA.ERRCODE.SEV > RECD2.STATDATA.ERRCODE.SEV
     1336      593    1                  THEN RES = 2;
     1337      594    1   END FEPERR$COMPARE;
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:245  
     1338      595        %EOD;

PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:246  
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FEPERR$COMPARE.

   Procedure FEPERR$COMPARE requires 87 words for executable code.
   Procedure FEPERR$COMPARE requires 8 words of local(AUTO) storage.

PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:247  

 Object Unit name= FEPERR$COMPARE                             File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:10:36.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none    87    127  FEPERR$COMPARE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  FEPERR$COMPARE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:248  


     1302        1        /*T***********************************************************/
     1303        2        /*T*                                                         */
     1304        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1305        4        /*T*                                                         */
     1306        5        /*T***********************************************************/
     1307        6        /* FEPERR$COMPARE IS A USR_CODE ROUTINE TO COMPARE KEYS FOR FEPERR */
     1308        7        FEPERR$COMPARE: PROC(RECD1,RECD2,RES);

      7  1 000000   000000 700200 xent  FEPERR$COMP* TSX0  ! X66_AUTO_3
         1 000001   000010 000003                    ZERO    8,3

     1309        8        %INCLUDE EL$TABLES;
     1310      331        %INCLUDE CP_6;
     1311      412    1   DCL RES SBIN;
     1312      413        %EL$FEPERR(NAME=RECD1,STCLASS=" ");
     1313      492        %EL$FEPERR(NAME=RECD2,STCLASS=" ");
     1314      571        /**/
     1315      572    1   RES = 0;

    572  1 000002   200005 470500                    LDP0    @RES,,AUTO
         1 000003   000000 450100                    STZ     0,,PR0

     1316      573
     1317      574    1   IF RECD1.STATDATA.NODE < RECD2.STATDATA.NODE THEN RES = 1;

    574  1 000004   200004 471500                    LDP1    @RECD2,,AUTO
         1 000005   100000 236100                    LDQ     0,,PR1
         1 000006   000024 772000                    QRL     20
         1 000007   200006 756100                    STQ     @RES+1,,AUTO
         1 000010   200003 473500                    LDP3    @RECD1,,AUTO
         1 000011   300000 236100                    LDQ     0,,PR3
         1 000012   000024 772000                    QRL     20
         1 000013   200006 116100                    CMPQ    @RES+1,,AUTO
         1 000014   000020 605000 1                  TPL     s:575

    574  1 000015   000001 235007                    LDA     1,DL
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:249  
         1 000016   000000 755100                    STA     0,,PR0
         1 000017   000126 710000 1                  TRA     s:594

     1318      575    1   ELSE IF RECD1.STATDATA.NODE > RECD2.STATDATA.NODE THEN RES = 2;

    575  1 000020   200006 756100                    STQ     @RES+1,,AUTO
         1 000021   100000 236100                    LDQ     0,,PR1
         1 000022   000024 772000                    QRL     20
         1 000023   200006 116100                    CMPQ    @RES+1,,AUTO
         1 000024   000030 605000 1                  TPL     s:577

    575  1 000025   000002 235007                    LDA     2,DL
         1 000026   000000 755100                    STA     0,,PR0
         1 000027   000126 710000 1                  TRA     s:594

     1319      576    1   ELSE
     1320      577    1      IF RECD1.STATDATA.TERMID.TERM.CHANNEL < RECD2.STATDATA.TERMID.TERM.CHANNEL

    577  1 000030   000100 106500                    CMPC    fill='000'O
         1 000031   300005 400002                    ADSC9   5,,PR3                   cn=2,n=2
         1 000032   100005 400002                    ADSC9   5,,PR1                   cn=2,n=2
         1 000033   000037 603000 1                  TRC     s:579

     1321      578    1      THEN RES = 1;

    578  1 000034   000001 235007                    LDA     1,DL
         1 000035   000000 755100                    STA     0,,PR0
         1 000036   000126 710000 1                  TRA     s:594

     1322      579    1      ELSE IF RECD1.STATDATA.TERMID.TERM.CHANNEL > RECD2.STATDATA.TERMID.TERM.CHANNEL

    579  1 000037   000044 602000 1                  TNC     s:582
         1 000040   000044 600000 1                  TZE     s:582

     1323      580    1      THEN RES = 2;

    580  1 000041   000002 235007                    LDA     2,DL
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:250  
         1 000042   000000 755100                    STA     0,,PR0
         1 000043   000126 710000 1                  TRA     s:594

     1324      581    1      ELSE
     1325      582    1            IF RECD1.STATDATA.ERRCODE.FCG < RECD2.STATDATA.ERRCODE.FCG THEN RES = 1;

    582  1 000044   000100 106500                    CMPC    fill='000'O
         1 000045   300001 020002                    ADSC6   1,,PR3                   cn=0,n=2
         1 000046   100001 020002                    ADSC6   1,,PR1                   cn=0,n=2
         1 000047   000053 603000 1                  TRC     s:583

    582  1 000050   000001 235007                    LDA     1,DL
         1 000051   000000 755100                    STA     0,,PR0
         1 000052   000126 710000 1                  TRA     s:594

     1326      583    1            ELSE IF RECD1.STATDATA.ERRCODE.FCG > RECD2.STATDATA.ERRCODE.FCG THEN RES =
               583                     2;

    583  1 000053   000060 602000 1                  TNC     s:585
         1 000054   000060 600000 1                  TZE     s:585

    583  1 000055   000002 235007                    LDA     2,DL
         1 000056   000000 755100                    STA     0,,PR0
         1 000057   000126 710000 1                  TRA     s:594

     1327      584    1            ELSE
     1328      585    1               IF RECD1.STATDATA.ERRCODE.ERR# < RECD2.STATDATA.ERRCODE.ERR#

    585  1 000060   100001 236100                    LDQ     1,,PR1
         1 000061   000003 772000                    QRL     3
         1 000062   037777 376007                    ANQ     16383,DL
         1 000063   200006 756100                    STQ     @RES+1,,AUTO
         1 000064   300001 236100                    LDQ     1,,PR3
         1 000065   000003 772000                    QRL     3
         1 000066   037777 376007                    ANQ     16383,DL
         1 000067   200006 116100                    CMPQ    @RES+1,,AUTO
         1 000070   000074 605000 1                  TPL     s:587
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:251  

     1329      586    1               THEN RES = 1;

    586  1 000071   000001 235007                    LDA     1,DL
         1 000072   000000 755100                    STA     0,,PR0
         1 000073   000126 710000 1                  TRA     s:594

     1330      587    1               ELSE IF RECD1.STATDATA.ERRCODE.ERR# > RECD2.STATDATA.ERRCODE.ERR#

    587  1 000074   200006 756100                    STQ     @RES+1,,AUTO
         1 000075   100001 236100                    LDQ     1,,PR1
         1 000076   000003 772000                    QRL     3
         1 000077   037777 376007                    ANQ     16383,DL
         1 000100   200006 116100                    CMPQ    @RES+1,,AUTO
         1 000101   000105 605000 1                  TPL     s:590

     1331      588    1               THEN RES = 2;

    588  1 000102   000002 235007                    LDA     2,DL
         1 000103   000000 755100                    STA     0,,PR0
         1 000104   000126 710000 1                  TRA     s:594

     1332      589    1               ELSE
     1333      590    1                  IF RECD1.STATDATA.ERRCODE.SEV < RECD2.STATDATA.ERRCODE.SEV

    590  1 000105   100001 236100                    LDQ     1,,PR1
         1 000106   000007 376007                    ANQ     7,DL
         1 000107   200006 756100                    STQ     @RES+1,,AUTO
         1 000110   300001 236100                    LDQ     1,,PR3
         1 000111   000007 376007                    ANQ     7,DL
         1 000112   200006 116100                    CMPQ    @RES+1,,AUTO
         1 000113   000117 605000 1                  TPL     s:592

     1334      591    1                  THEN RES = 1;

    591  1 000114   000001 235007                    LDA     1,DL
         1 000115   000000 755100                    STA     0,,PR0
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:252  
         1 000116   000126 710000 1                  TRA     s:594

     1335      592    1                  ELSE IF RECD1.STATDATA.ERRCODE.SEV > RECD2.STATDATA.ERRCODE.SEV

    592  1 000117   200006 756100                    STQ     @RES+1,,AUTO
         1 000120   100001 236100                    LDQ     1,,PR1
         1 000121   000007 376007                    ANQ     7,DL
         1 000122   200006 116100                    CMPQ    @RES+1,,AUTO
         1 000123   000126 605000 1                  TPL     s:594

     1336      593    1                  THEN RES = 2;

    593  1 000124   000002 235007                    LDA     2,DL
         1 000125   000000 755100                    STA     0,,PR0

     1337      594    1   END FEPERR$COMPARE;

    594  1 000126   000000 702200 xent               TSX2  ! X66_ARET
     1338      595        %EOD;

PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:253  
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FEPERR$COMPARE.
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:254  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @RECD1                     4-0-0/w PTR         r     1 @RECD2
     5-0-0/w PTR         r     1 @RES                      *0-0-0/w STRC(1224)  r     1 RECD1
    *0-0-0/w STRC(1224)  r     1 RECD2                     *0-0-0/w SBIN        r     1 RES


   Procedure FEPERR$COMPARE requires 87 words for executable code.
   Procedure FEPERR$COMPARE requires 8 words of local(AUTO) storage.
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:255  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=FEPERR$COMPARE File=THC$COMMANDS.:E05TSI                      WED 07/30/97 06:10 Page:256  
          MINI XREF LISTING

RECD1
       414**DCL         7--PROC
RECD1.STATDATA.ERRCODE.ERR#
       457**DCL       585>>IF        587>>IF
RECD1.STATDATA.ERRCODE.FCG
       443**DCL       582>>IF        583>>IF
RECD1.STATDATA.ERRCODE.SEV
       457**DCL       590>>IF        592>>IF
RECD1.STATDATA.NODE
       414**DCL       574>>IF        575>>IF
RECD1.STATDATA.TERMID.TERM
       479**DCL       488--REDEF
RECD1.STATDATA.TERMID.TERM.CHANNEL
       481**DCL       577>>IF        579>>IF
RECD2
       493**DCL         7--PROC
RECD2.STATDATA.ERRCODE.ERR#
       536**DCL       585>>IF        587>>IF
RECD2.STATDATA.ERRCODE.FCG
       522**DCL       582>>IF        583>>IF
RECD2.STATDATA.ERRCODE.SEV
       536**DCL       590>>IF        592>>IF
RECD2.STATDATA.NODE
       493**DCL       574>>IF        575>>IF
RECD2.STATDATA.TERMID.TERM
       558**DCL       567--REDEF
RECD2.STATDATA.TERMID.TERM.CHANNEL
       560**DCL       577>>IF        579>>IF
RES
       412**DCL         7--PROC      572<<ASSIGN    574<<ASSIGN    575<<ASSIGN    578<<ASSIGN    580<<ASSIGN
       582<<ASSIGN    583<<ASSIGN    586<<ASSIGN    588<<ASSIGN    591<<ASSIGN    593<<ASSIGN

PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:257  
     1339        1        /*T***********************************************************/
     1340        2        /*T*                                                         */
     1341        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1342        4        /*T*                                                         */
     1343        5        /*T***********************************************************/
     1344        6        THC$TYPENAME: PROC(TYPE,TEXT,COUNT);
     1345        7        /**/
     1346        8        %INCLUDE TH_SUBS_C;
     1347      390        %INCLUDE CP_6;
     1348      471        %INCLUDE EL_SUBS_C;
     1349      555        /**/
     1350      556    1   DCL TYPE CHAR(1);
     1351      557    1   DCL TEXT CHAR(63);
     1352      558    1   DCL COUNT UBIN WORD;
     1353      559        %EQU CMPSTRT =       'COMPONENT STARTUP  (CMPSTRT)';
     1354      560        %EQU MOUNT =         'VOLUME MOUNT  (MOUNT)';
     1355      561        %EQU DSMT =          'VOLUME DISMOUNT  (DSMT)';
     1356      562        %EQU TIMESTAMP =     'TIMESTAMP  (TIMESTAMP)';
     1357      563        %EQU OPER =          'OPERATER INPUT  (OPER)';
     1358      564        %EQU REX =           'RESOURCE EXHAUSTED   (REX)';
     1359      565        %EQU FWLOAD =        'FIRMWARE LOAD  (FWLOAD)';
     1360      566        %EQU DIAG =          'DIAGNOSTIC OPEN  (DIAG)';
     1361      567        %EQU SYSCON =        'SYSCON ACTIVITY  (SYSCON)';
     1362      568        %EQU SYSID =         'SITEINFO  (SYSID)';
     1363      569        %EQU MPCSTAT =       'MPC STATISTICS  (MPCSTAT)';
     1364      570        %EQU ANLZ =          'ANLZ TEXT  (ANLZ)';
     1365      571        %EQU ZAP =           'OPERATOR INITIATED ZAP  (ZAP)';
     1366      572        %EQU DEVSTAT =       'MPC DEVICE STATISTICS  (DEVSTAT)';
     1367      573        %EQU CHANTRAN =      'CHANNEL TRANSITION (CHANTRAN)';
     1368      574        %EQU MSOSSAYS =      'MSOS REQUEST TO CP6 (MSOSSAYS)';
     1369      575        %EQU CP6SAYS =       'CP6 RESPONSE TO MSOS (CP6SAYS)';
     1370      576        %EQU IOERR =         'I/O ERROR  (IOERR)';
     1371      577        %EQU EDAC =          'MOS MEMORY ERRORS  (EDAC)';
     1372      578        %EQU FEPERR =        'FEP ERRORS  (FEPERR)';
     1373      579        %EQU PROCERR =       'PROCESSOR ERRORS  (PROCERR)';
     1374      580        %EQU SPURINT =       'SPURIOUS INTERRUPT  (SPURINT)';
     1375      581        %EQU FEPFLT =        'FEP FAULT  (FEPFLT)';
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:258  
     1376      582        %EQU SCREECH =       'SYSTEM RECOVERY  (SCREECH)';
     1377      583        %EQU FI =            'FILE INCONSISTENCY  (FI)';
     1378      584        %EQU OSFI =          'SYMB FILE INCONSISTENCY  (OSFI)';
     1379      585        %EQU FEPEVENT =      'FEP EVENT  (FEPEVENT)';
     1380      586        %EQU GABRT =         'GHOST ABORT  (GABRT)';
     1381      587        %EQU SUA =           'SINGLE USER ABORT  (SUA)';
     1382      588        %EQU SNAP =          'SNAP  (SNAP)';
     1383      589        %EQU CGERR =         'COMGROUP ERROR  (CGERR)';
     1384      590        %EQU FEPDUMP =      'FEP DUMP   (FEPDUMP)';
     1385      591        %EQU LOST =          'LOST ERRORS  (LOST)';
     1386      592        %EQU CHNGAARD =      'BOOTINFO CHANGE (CHNGAARD)';
     1387      593        %EQU MIRROR =        'MIRRORED DISC STATE CHANGE (MIRROR)';
     1388      594    1   DCL TYPEVEC(0:%NTYPES) UBIN BYTE UNAL CONSTANT INIT(0,%EL_CMPSTRT,%EL_MOUNT,%EL_DSMT
               594            ,%EL_TIMESTAMP,%EL_OPER,
     1389      595    1                          %EL_REX,%EL_FWLOAD,%EL_DIAG,%EL_SYSCON,%EL_SYSID,%EL_MPCSTAT,
               595                                   %EL_ANLZ,%EL_ZAP,
     1390      596    1                          %EL_DEVSTAT,%EL_CHANTRAN,%EL_MSOSSAYS,%EL_CP6SAYS,%EL_IOERR,%
               596                                   EL_EDAC,%EL_FEPERR,
     1391      597    1                          %EL_PROCERR,%EL_SPURINT,%EL_FEPFLT,%EL_SCREECH,%EL_FI,%
               597                                   EL_OSFI,%EL_FEPCRASH,
     1392      598    1                          %EL_GABRT,%EL_SUA,%EL_SNAP,%EL_CGERR,%EL_FEPDUMP,%EL_LOST,%
               598                                   EL_CHNGAARD,
     1393      599    1                          %EL_DEVSTAT, %EL_DEVSTAT, %EL_MIRROR);
     1394      600    1   DCL CHARVEC REDEF TYPEVEC CHAR(%(NTYPES+1));
     1395      601    1   DCL 1 TBL(0:%NTYPES) CONSTANT ALIGNED,
     1396      602    1         2 TEXT CHAR(40) INIT(' ',%CMPSTRT,
     1397      603    1                                %MOUNT,
     1398      604    1                                %DSMT,
     1399      605    1                                %TIMESTAMP,
     1400      606    1                                %OPER,
     1401      607    1                                %REX,
     1402      608    1                                %FWLOAD,
     1403      609    1                                %DIAG,
     1404      610    1                                %SYSCON,
     1405      611    1                                %SYSID,
     1406      612    1                                %MPCSTAT,
     1407      613    1                                %ANLZ,
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:259  
     1408      614    1                                %ZAP,
     1409      615    1                                %DEVSTAT,
     1410      616    1                                %CHANTRAN,
     1411      617    1                                %MSOSSAYS,
     1412      618    1                                %CP6SAYS,
     1413      619    1                                %IOERR,
     1414      620    1                                %EDAC,
     1415      621    1                                %FEPERR,
     1416      622    1                                %PROCERR,
     1417      623    1                                %SPURINT,
     1418      624    1                                %FEPFLT,
     1419      625    1                                %SCREECH,
     1420      626    1                                %FI,
     1421      627    1                                %OSFI,
     1422      628    1                                %FEPEVENT,
     1423      629    1                                %GABRT,
     1424      630    1                                %SUA,
     1425      631    1                                %SNAP,
     1426      632    1                                %CGERR,
     1427      633    1                                %FEPDUMP,
     1428      634    1                                %LOST,
     1429      635    1                                %CHNGAARD,
     1430      636    1                                %DEVSTAT,
     1431      637    1                                %DEVSTAT,
     1432      638    1                                %MIRROR),
     1433      639    1         2 COUNT UBIN INIT(0,SIZEC(%CMPSTRT),
     1434      640    1                                SIZEC(%MOUNT),
     1435      641    1                                SIZEC(%DSMT),
     1436      642    1                                SIZEC(%TIMESTAMP),
     1437      643    1                                SIZEC(%OPER),
     1438      644    1                                SIZEC(%REX),
     1439      645    1                                SIZEC(%FWLOAD),
     1440      646    1                                SIZEC(%DIAG),
     1441      647    1                                SIZEC(%SYSCON),
     1442      648    1                                SIZEC(%SYSID),
     1443      649    1                                SIZEC(%MPCSTAT),
     1444      650    1                                SIZEC(%ANLZ),
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:260  
     1445      651    1                                SIZEC(%ZAP),
     1446      652    1                                SIZEC(%DEVSTAT),
     1447      653    1                                SIZEC(%CHANTRAN),
     1448      654    1                                SIZEC(%MSOSSAYS),
     1449      655    1                                SIZEC(%CP6SAYS),
     1450      656    1                                SIZEC(%IOERR),
     1451      657    1                                SIZEC(%EDAC),
     1452      658    1                                SIZEC(%FEPERR),
     1453      659    1                                SIZEC(%PROCERR),
     1454      660    1                                SIZEC(%SPURINT),
     1455      661    1                                SIZEC(%FEPFLT),
     1456      662    1                                SIZEC(%SCREECH),
     1457      663    1                                SIZEC(%FI),
     1458      664    1                                SIZEC(%OSFI),
     1459      665    1                                SIZEC(%FEPEVENT),
     1460      666    1                                SIZEC(%GABRT),
     1461      667    1                                SIZEC(%SUA),
     1462      668    1                                SIZEC(%SNAP),
     1463      669    1                                SIZEC(%CGERR),
     1464      670    1                                SIZEC(%FEPDUMP),
     1465      671    1                                SIZEC(%LOST),
     1466      672    1                                SIZEC(%CHNGAARD),
     1467      673    1                                SIZEC(%DEVSTAT),
     1468      674    1                                SIZEC(%DEVSTAT),
     1469      675    1                                SIZEC(%MIRROR));
     1470      676    1   DCL INDX SBIN;
     1471      677        /**/
     1472      678    1         CALL INDEX(INDX,TYPE,CHARVEC);
     1473      679    2        IF INDX <= %TH_LASTITYPE THEN DO;
     1474      680    2           TEXT = TBL.TEXT(INDX);
     1475      681    2           COUNT = TBL.COUNT(INDX);
     1476      682    2           RETURN;
     1477      683    2           END;  /* IF */
     1478      684    1        CALL BINCHAR(SUBSTR(TEXT,0,3),ASCBIN(TYPE));
     1479      685    1        COUNT = 3;
     1480      686    1        RETURN;
     1481      687    1   END THC$TYPENAME;
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:261  
     1482      688        %EOD;

PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:262  
--  Include file information  --

   EL_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$TYPENAME.

   Procedure THC$TYPENAME requires 36 words for executable code.
   Procedure THC$TYPENAME requires 12 words of local(AUTO) storage.

PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:263  

 Object Unit name= THC$TYPENAME                               File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:10:50.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    428    654  THC$TYPENAME
    2   Proc  even  none    36     44  THC$TYPENAME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        3  THC$TYPENAME

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:264  


     1339        1        /*T***********************************************************/
     1340        2        /*T*                                                         */
     1341        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1342        4        /*T*                                                         */
     1343        5        /*T***********************************************************/
     1344        6        THC$TYPENAME: PROC(TYPE,TEXT,COUNT);

      6  2 000000   000000 700200 xent  THC$TYPENAME TSX0  ! X66_AUTO_3
         2 000001   000014 000003                    ZERO    12,3

     1345        7        /**/
     1346        8        %INCLUDE TH_SUBS_C;
     1347      390        %INCLUDE CP_6;
     1348      471        %INCLUDE EL_SUBS_C;
     1349      555        /**/
     1350      556    1   DCL TYPE CHAR(1);
     1351      557    1   DCL TEXT CHAR(63);
     1352      558    1   DCL COUNT UBIN WORD;
     1353      559        %EQU CMPSTRT =       'COMPONENT STARTUP  (CMPSTRT)';
     1354      560        %EQU MOUNT =         'VOLUME MOUNT  (MOUNT)';
     1355      561        %EQU DSMT =          'VOLUME DISMOUNT  (DSMT)';
     1356      562        %EQU TIMESTAMP =     'TIMESTAMP  (TIMESTAMP)';
     1357      563        %EQU OPER =          'OPERATER INPUT  (OPER)';
     1358      564        %EQU REX =           'RESOURCE EXHAUSTED   (REX)';
     1359      565        %EQU FWLOAD =        'FIRMWARE LOAD  (FWLOAD)';
     1360      566        %EQU DIAG =          'DIAGNOSTIC OPEN  (DIAG)';
     1361      567        %EQU SYSCON =        'SYSCON ACTIVITY  (SYSCON)';
     1362      568        %EQU SYSID =         'SITEINFO  (SYSID)';
     1363      569        %EQU MPCSTAT =       'MPC STATISTICS  (MPCSTAT)';
     1364      570        %EQU ANLZ =          'ANLZ TEXT  (ANLZ)';
     1365      571        %EQU ZAP =           'OPERATOR INITIATED ZAP  (ZAP)';
     1366      572        %EQU DEVSTAT =       'MPC DEVICE STATISTICS  (DEVSTAT)';
     1367      573        %EQU CHANTRAN =      'CHANNEL TRANSITION (CHANTRAN)';
     1368      574        %EQU MSOSSAYS =      'MSOS REQUEST TO CP6 (MSOSSAYS)';
     1369      575        %EQU CP6SAYS =       'CP6 RESPONSE TO MSOS (CP6SAYS)';
     1370      576        %EQU IOERR =         'I/O ERROR  (IOERR)';
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:265  
     1371      577        %EQU EDAC =          'MOS MEMORY ERRORS  (EDAC)';
     1372      578        %EQU FEPERR =        'FEP ERRORS  (FEPERR)';
     1373      579        %EQU PROCERR =       'PROCESSOR ERRORS  (PROCERR)';
     1374      580        %EQU SPURINT =       'SPURIOUS INTERRUPT  (SPURINT)';
     1375      581        %EQU FEPFLT =        'FEP FAULT  (FEPFLT)';
     1376      582        %EQU SCREECH =       'SYSTEM RECOVERY  (SCREECH)';
     1377      583        %EQU FI =            'FILE INCONSISTENCY  (FI)';
     1378      584        %EQU OSFI =          'SYMB FILE INCONSISTENCY  (OSFI)';
     1379      585        %EQU FEPEVENT =      'FEP EVENT  (FEPEVENT)';
     1380      586        %EQU GABRT =         'GHOST ABORT  (GABRT)';
     1381      587        %EQU SUA =           'SINGLE USER ABORT  (SUA)';
     1382      588        %EQU SNAP =          'SNAP  (SNAP)';
     1383      589        %EQU CGERR =         'COMGROUP ERROR  (CGERR)';
     1384      590        %EQU FEPDUMP =      'FEP DUMP   (FEPDUMP)';
     1385      591        %EQU LOST =          'LOST ERRORS  (LOST)';
     1386      592        %EQU CHNGAARD =      'BOOTINFO CHANGE (CHNGAARD)';
     1387      593        %EQU MIRROR =        'MIRRORED DISC STATE CHANGE (MIRROR)';
     1388      594    1  DCL TYPEVEC(0:%NTYPES) UBIN BYTE UNAL CONSTANT INIT(0,%EL_CMPSTRT,%EL_MOUNT,%EL_DSMT
               594            ,%EL_TIMESTAMP,%EL_OPER,
     1389      595    1                         %EL_REX,%EL_FWLOAD,%EL_DIAG,%EL_SYSCON,%EL_SYSID,%EL_MPCSTAT,
               595                                   %EL_ANLZ,%EL_ZAP,
     1390      596    1                         %EL_DEVSTAT,%EL_CHANTRAN,%EL_MSOSSAYS,%EL_CP6SAYS,%EL_IOERR,%
               596                                   EL_EDAC,%EL_FEPERR,
     1391      597    1                          %EL_PROCERR,%EL_SPURINT,%EL_FEPFLT,%EL_SCREECH,%EL_FI,%
               597                                   EL_OSFI,%EL_FEPCRASH,
     1392      598    1                          %EL_GABRT,%EL_SUA,%EL_SNAP,%EL_CGERR,%EL_FEPDUMP,%EL_LOST,%
               598                                   EL_CHNGAARD,
     1393      599    1                          %EL_DEVSTAT, %EL_DEVSTAT, %EL_MIRROR);
     1394      600    1   DCL CHARVEC REDEF TYPEVEC CHAR(%(NTYPES+1));
     1395      601    1   DCL 1 TBL(0:%NTYPES) CONSTANT ALIGNED,
     1396      602    1         2 TEXT CHAR(40) INIT(' ',%CMPSTRT,
     1397      603    1                                %MOUNT,
     1398      604    1                                %DSMT,
     1399      605    1                                %TIMESTAMP,
     1400      606    1                                %OPER,
     1401      607    1                                %REX,
     1402      608    1                                %FWLOAD,
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:266  
     1403      609    1                                %DIAG,
     1404      610    1                                %SYSCON,
     1405      611    1                                %SYSID,
     1406      612    1                                %MPCSTAT,
     1407      613    1                                %ANLZ,
     1408      614    1                                %ZAP,
     1409      615    1                                %DEVSTAT,
     1410      616    1                                %CHANTRAN,
     1411      617    1                                %MSOSSAYS,
     1412      618    1                                %CP6SAYS,
     1413      619    1                                %IOERR,
     1414      620    1                                %EDAC,
     1415      621    1                                %FEPERR,
     1416      622    1                                %PROCERR,
     1417      623    1                                %SPURINT,
     1418      624    1                                %FEPFLT,
     1419      625    1                                %SCREECH,
     1420      626    1                                %FI,
     1421      627    1                                %OSFI,
     1422      628    1                                %FEPEVENT,
     1423      629    1                                %GABRT,
     1424      630    1                                %SUA,
     1425      631    1                                %SNAP,
     1426      632    1                                %CGERR,
     1427      633    1                                %FEPDUMP,
     1428      634    1                                %LOST,
     1429      635    1                                %CHNGAARD,
     1430      636    1                                %DEVSTAT,
     1431      637    1                                %DEVSTAT,
     1432      638    1                                %MIRROR),
     1433      639    1         2 COUNT UBIN INIT(0,SIZEC(%CMPSTRT),
     1434      640    1                                SIZEC(%MOUNT),
     1435      641    1                                SIZEC(%DSMT),
     1436      642    1                                SIZEC(%TIMESTAMP),
     1437      643    1                                SIZEC(%OPER),
     1438      644    1                                SIZEC(%REX),
     1439      645    1                                SIZEC(%FWLOAD),
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:267  
     1440      646    1                                SIZEC(%DIAG),
     1441      647    1                                SIZEC(%SYSCON),
     1442      648    1                                SIZEC(%SYSID),
     1443      649    1                                SIZEC(%MPCSTAT),
     1444      650    1                                SIZEC(%ANLZ),
     1445      651    1                                SIZEC(%ZAP),
     1446      652    1                                SIZEC(%DEVSTAT),
     1447      653    1                                SIZEC(%CHANTRAN),
     1448      654    1                                SIZEC(%MSOSSAYS),
     1449      655    1                                SIZEC(%CP6SAYS),
     1450      656    1                                SIZEC(%IOERR),
     1451      657    1                                SIZEC(%EDAC),
     1452      658    1                                SIZEC(%FEPERR),
     1453      659    1                                SIZEC(%PROCERR),
     1454      660    1                                SIZEC(%SPURINT),
     1455      661    1                                SIZEC(%FEPFLT),
     1456      662    1                                SIZEC(%SCREECH),
     1457      663    1                                SIZEC(%FI),
     1458      664    1                                SIZEC(%OSFI),
     1459      665    1                                SIZEC(%FEPEVENT),
     1460      666    1                                SIZEC(%GABRT),
     1461      667    1                                SIZEC(%SUA),
     1462      668    1                                SIZEC(%SNAP),
     1463      669    1                                SIZEC(%CGERR),
     1464      670    1                                SIZEC(%FEPDUMP),
     1465      671    1                                SIZEC(%LOST),
     1466      672    1                                SIZEC(%CHNGAARD),
     1467      673    1                                SIZEC(%DEVSTAT),
     1468      674    1                                SIZEC(%DEVSTAT),
     1469      675    1                                SIZEC(%MIRROR));
     1470      676    1   DCL INDX SBIN;
     1471      677        /**/
     1472      678    1         CALL INDEX(INDX,TYPE,CHARVEC);

    678  2 000002   200003 470500                    LDP0    @TYPE,,AUTO
         2 000003   000100 124400                    SCM     mask='000'O
         2 000004   000000 000046 1                  ADSC9   TYPEVEC                  cn=0,n=38
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:268  
         2 000005   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000006   200006 000100                    ARG     INDX,,AUTO

     1473      679    2        IF INDX <= %TH_LASTITYPE THEN DO;

    679  2 000007   200006 235100                    LDA     INDX,,AUTO
         2 000010   000045 115007                    CMPA    37,DL
         2 000011   000026 605400 2                  TPNZ    s:684

     1474      680    2           TEXT = TBL.TEXT(INDX);

    680  2 000012   200006 236100                    LDQ     INDX,,AUTO
         2 000013   000054 402007                    MPY     44,DL
         2 000014   200004 471500                    LDP1    @TEXT,,AUTO
         2 000015   040100 100406                    MLR     fill='040'O
         2 000016   000012 000050 1                  ADSC9   TBL,Q                    cn=0,n=40
         2 000017   100000 000077                    ADSC9   0,,PR1                   cn=0,n=63

     1475      681    2           COUNT = TBL.COUNT(INDX);

    681  2 000020   200006 236100                    LDQ     INDX,,AUTO
         2 000021   000013 402007                    MPY     11,DL
         2 000022   200005 473500                    LDP3    @COUNT,,AUTO
         2 000023   000024 235006 1                  LDA     TBL+10,QL
         2 000024   300000 755100                    STA     0,,PR3

     1476      682    2           RETURN;

    682  2 000025   000000 702200 xent               TSX2  ! X66_ARET

     1477      683    2           END;  /* IF */
     1478      684    1        CALL BINCHAR(SUBSTR(TEXT,0,3),ASCBIN(TYPE));

    684  2 000026   000100 101500                    MRL     fill='000'O
         2 000027   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000030   200010 000004                    ADSC9   INDX+2,,AUTO             cn=0,n=4
         2 000031   200010 236100                    LDQ     INDX+2,,AUTO
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:269  
         2 000032   000000 235003                    LDA     0,DU
         2 000033   200012 757100                    STAQ    INDX+4,,AUTO
         2 000034   200004 471500                    LDP1    @TEXT,,AUTO
         2 000035   000100 301500                    BTD
         2 000036   200012 000010                    NDSC9   INDX+4,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 000037   100000 030003                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=3

     1479      685    1        COUNT = 3;

    685  2 000040   000003 236007                    LDQ     3,DL
         2 000041   200005 473500                    LDP3    @COUNT,,AUTO
         2 000042   300000 756100                    STQ     0,,PR3

     1480      686    1        RETURN;

    686  2 000043   000000 702200 xent               TSX2  ! X66_ARET
     1481      687    1   END THC$TYPENAME;
     1482      688        %EOD;

PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:270  
--  Include file information  --

   EL_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$TYPENAME.
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:271  

 **** Variables and constants ****

  ****  Section 001 RoData THC$TYPENAME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(38)    r     1 CHARVEC                   12-0-0/w STRC(396)   r     1 TBL(0:37)
     0-0-0/b UBIN(9)     r     1 TYPEVEC(0:37)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @COUNT                     4-0-0/w PTR         r     1 @TEXT
     3-0-0/w PTR         r     1 @TYPE                     *0-0-0/w UBIN        r     1 COUNT
     6-0-0/w SBIN        r     1 INDX                      *0-0-0/c CHAR(63)    r     1 TEXT
    *0-0-0/c CHAR        r     1 TYPE


   Procedure THC$TYPENAME requires 36 words for executable code.
   Procedure THC$TYPENAME requires 12 words of local(AUTO) storage.
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:272  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=THC$TYPENAME File=THC$COMMANDS.:E05TSI                        WED 07/30/97 06:10 Page:273  
          MINI XREF LISTING

CHARVEC
       600**DCL       678>>CALLBLT
COUNT
       558**DCL         6--PROC      681<<ASSIGN    685<<ASSIGN
INDX
       676**DCL       678<<CALLBLT   679>>IF        680>>ASSIGN    681>>ASSIGN
TBL.COUNT
       639**DCL       681>>ASSIGN
TBL.TEXT
       602**DCL       680>>ASSIGN
TEXT
       557**DCL         6--PROC      680<<ASSIGN    684<<CALLBLT
TYPE
       556**DCL         6--PROC      678>>CALLBLT   684>>CALLBLT
TYPEVEC
       594**DCL       600--REDEF

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:274  
     1483        1        /*T***********************************************************/
     1484        2        /*T*                                                         */
     1485        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1486        4        /*T*                                                         */
     1487        5        /*T***********************************************************/
     1488        6        THC$SELECT: PROC(TOP$) ALTRET;
     1489        7        /**/
     1490        8        /* PARAMS */
     1491        9    1   DCL TOP$ PTR;
     1492       10        /**/
     1493       11        /* INCLUDE FILES */
     1494       12        %INCLUDE CP_6;
     1495       93        %INCLUDE XU_MACRO_C;
     1496     3199        %INCLUDE TH_SUBS_C;
     1497     3581        %INCLUDE TH_DATA_R;
     1498     3659        %INCLUDE TH_PERR_C;
     1499     3700        %INCLUDE EL_SUBS_C;
     1500     3784        /**/
     1501     3785        /* ENTRY DEFS */
     1502     3786    1   DCL THM$ERRMSG ENTRY(1);
     1503     3787        /**/
     1504     3788        /* VARIABLES */
     1505     3789    1   DCL I SBIN;
     1506     3790    1   DCL J SBIN;
     1507     3791    1   DCL K SBIN;
     1508     3792    1   DCL SAVE_INDEX SBIN;
     1509     3793    1   DCL TEMP1 UBIN;
     1510     3794    1   DCL TEMP2 UBIN;
     1511     3795    1   DCL RECOV_TYPES (0:3) UBIN STATIC INIT(EL_SCREECH,EL_SUA,EL_SNAP,0);
     1512     3796    1   DCL TEXTBASE CHAR(P_PCB.NCHARS) BASED(P_PCB.TEXT$);
     1513     3797    1   DCL FOUND BIT(1);
     1514     3798    1   DCL BIT_SPEC BIT(1);
     1515     3799    1   DCL BYTE_SPEC UBIN;
     1516     3800    1   DCL FIRST_BIT UBIN;
     1517     3801    1   DCL LAST_BIT UBIN;
     1518     3802    1   DCL INDX UBIN;
     1519     3803    1   DCL VALUE UBIN;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:275  
     1520     3804    1   DCL TEMP$ PTR;
     1521     3805    1   DCL MATCH_DEL BIT(1);
     1522     3806    1   DCL EXCLUDE_DEL BIT(1);
     1523     3807    1   DCL MAJOR UBIN(6) UNAL;
     1524     3808    1   DCL SUB CHAR(3);
     1525     3809    1   DCL SUBB(0:2) REDEF SUB CHAR(1);
     1526     3810    1   DCL SUB_BIN UBIN;
     1527     3811    1   DCL 1 SUB_BIT,
     1528     3812    1         2 ONE BIT(3),
     1529     3813    1         2 TWO BIT(3);
     1530     3814    1   DCL SUBB_BIT REDEF SUB_BIT BIT(6);
     1531     3815    1   DCL FI_ERR UBIN(9) UNAL;
     1532     3816    1   DCL MEDIA CHAR(6);
     1533     3817    1   DCL TEMP CHAR(8);
     1534     3818    1   DCL TEMPP(0:7) REDEF TEMP CHAR(1);
     1535     3819    1   DCL FEP_CODE CHAR(3);
     1536     3820    1   DCL FEP_CHAN CHAR(4);
     1537     3821    1   DCL FEP_CHAN_N CHAR(4);
     1538     3822    1   DCL MATCH_ADD BIT(1);
     1539     3823    1   DCL EXCLUDE_ADD BIT(1);
     1540     3824    1   DCL DEL_TEST CHAR(3);
     1541     3825    1   DCL JJ UBIN;
     1542     3826    1   DCL JCNT UBIN;
     1543     3827    1   DCL C_TEST CHAR(119) ;
     1544     3828        /**/
     1545     3829        /* MACRO INVOCATIONS */
     1546     3830        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     1547     3875        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED");
     1548     3913        %P$PCB (NAME=P_PCB,STCLASS=SYMREF);
     1549     4114        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
     1550     4115                   STCLASS=SYMREF);
     1551     4224        %VLP_NAME (FPTN=TH_VLP_ERRLOG,
     1552     4225                   STCLASS=SYMREF,
     1553     4226                   LEN=15);
     1554     4253        /**/
     1555     4254        %EJECT;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:276  
     1556     4255    2        DO CASE(OUT$BLK.CODE);
     1557     4256    2           CASE(%ERROR,%SELECT);
     1558     4257    2              I = 0;
     1559     4258    3              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE ~= %PLUS THEN DO;
     1560     4259    3                 TH_CONSTRAINTS.NTYPES = 0;
     1561     4260    3                 TH_RECOV = %FALSE;
     1562     4261    3                 END;  /* IF */
     1563     4262    2                 ELSE I = 1;
     1564     4263    3              DO I = I TO OUT$BLK.NSUBLKS - 1;
     1565     4264    3                 IF OUT$BLK.SUBLK$(I)->OUT$BLK.CODE=0
     1566     4265    3                    THEN CALL CHARBIN(VALUE,OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT);
     1567     4266    3                    ELSE VALUE = OUT$BLK.SUBLK$(I)->OUT$BLK.CODE;
     1568     4267    3                 RECOV_TYPES(3) = VALUE;
     1569     4268    3                 TEMP1 = 3;
     1570     4269    3                 TEMP2 = 3;
     1571     4270    4                 IF VALUE = %TH_RECOV THEN DO;
     1572     4271    4                    TH_RECOV = %TRUE;
     1573     4272    4                    TEMP1 = 0;
     1574     4273    4                    TEMP2 = 2;
     1575     4274    4                    END;
     1576     4275    3          FOUND = '0'B;
     1577     4276    4                 DO K = TEMP1 TO TEMP2;
     1578     4277    4                    VALUE = RECOV_TYPES(K);
     1579     4278    5                    DO J = 0 TO TH_CONSTRAINTS.NTYPES - 1;
     1580     4279    5                       IF TH_CONSTRAINTS.TYPES(J) = VALUE
     1581     4280    5                          THEN FOUND = '1'B;
     1582     4281    5                    END;                      /* DO J = 1 TO NTYPES                 */
     1583     4282    4                    IF NOT FOUND
     1584     4283    5                       THEN DO;
     1585     4284    5                         TH_CONSTRAINTS.TYPES(TH_CONSTRAINTS.NTYPES) = VALUE;
     1586     4285    5                         TH_CONSTRAINTS.NTYPES = TH_CONSTRAINTS.NTYPES + 1;
     1587     4286    5                       END;                   /* IF NOT FOUND                       */
     1588     4287    4                    END;  /* DO K */
     1589     4288    3              END;                         /* DO I = 0 TO OUT$BLK.NSUBLKS-1      */
     1590     4289    2            CASE (%MATCH);
     1591     4290                                               /* PROCESS MATCH COMMAND           */
     1592     4291    2              MATCH_DEL = %NO;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:277  
     1593     4292    2            MATCH_ADD = %NO;
     1594     4293    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %DELETEE
     1595     4294    3                 THEN DO;
     1596     4295    3                      MATCH_DEL = %YES;
     1597     4296    3                      J = 1;
     1598     4297    3                      END;
     1599     4298    2                 ELSE
     1600     4299    2                      IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %ADDD
     1601     4300    3                           THEN DO;
     1602     4301    3                                J = 1;
     1603     4302    3                                MATCH_ADD = %YES;
     1604     4303    3                                END;
     1605     4304    3                           ELSE DO;
     1606     4305    3                                J = 0;
     1607     4306    3                                TH_CONSTRAINTS.M_BY_B_SET = %NO;
     1608     4307    3                                TH_CONSTRAINTS.M_MAJ_S = %NO;
     1609     4308    3                                TH_CONSTRAINTS.M_SUB_S = %NO;
     1610     4309    3                                TH_CONSTRAINTS.M_MED_S = %NO;
     1611     4310    3                                TH_CONSTRAINTS.M_FEP_SET = %NO;
     1612     4311    3                                TH_CONSTRAINTS.M_CHAN_SET = %NO;
     1613     4312    3                                TH_CONSTRAINTS.M_COD_SET = %NO;
     1614     4313    3                                TH_CONSTRAINTS.M_REA_SET = %NO;
     1615     4314    3                                TH_CONSTRAINTS.M_ACT_SET = %NO;
     1616     4315    3                                END;
     1617     4316    3              DO I = J TO OUT$BLK.NSUBLKS - 1;
     1618     4317    3                 TEMP$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);
     1619     4318    4                 DO CASE(TEMP$->OUT$BLK.CODE);
     1620     4319    4                    CASE(%MAJ);
     1621     4320    4                      IF TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 2
     1622     4321    5                        THEN DO;
     1623     4322    5                           SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1624     4323    5                           CALL CHARBIN(SUB_BIN,SUBB(0));
     1625     4324    5                           VALUE = SUB_BIN * 8;
     1626     4325    5                           CALL CHARBIN(SUB_BIN,SUBB(1));
     1627     4326    5                           VALUE = VALUE + SUB_BIN;
     1628     4327    5                           MAJOR = VALUE;
     1629     4328    5                           END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:278  
     1630     4329    5                        ELSE DO;
     1631     4330    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)
     1632     4331    5                                        ->OUT$SYM.TEXT);
     1633     4332    5                           MAJOR = VALUE;
     1634     4333    5                           END;
     1635     4334    4                      IF MATCH_DEL
     1636     4335    4                        THEN
     1637     4336    4                           IF ((TH_CONSTRAINTS.M_MAJ_S) & (MAJOR=TH_CONSTRAINTS.M_MAJ))
     1638     4337    4                             THEN TH_CONSTRAINTS.M_MAJ_S = %NO;
     1639     4338    5                             ELSE DO;
     1640     4339    5                                  CALL THM$ERRMSG(%E$TH_BAD_MAJ);
     1641     4340    5                                  ALTRETURN;
     1642     4341    5                                  END;
     1643     4342    5                        ELSE DO;
     1644     4343    5                             TH_CONSTRAINTS.M_MAJ_S = %YES;
     1645     4344    5                             TH_CONSTRAINTS.M_MAJ = MAJOR;
     1646     4345    5                             END;
     1647     4346    4                      DEL_TEST = 'MAJ';
     1648     4347    4                    CASE(%SUB);
     1649     4348    4                     IF TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 2
     1650     4349    5                      THEN DO;
     1651     4350    5                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1652     4351    5                      CALL CHARBIN(SUB_BIN,SUBB(0));
     1653     4352    5                      SUB_BIT.ONE = BINBIT(SUB_BIN,3);
     1654     4353    5                      CALL CHARBIN(SUB_BIN,SUBB(1));
     1655     4354    5                      SUB_BIT.TWO = BINBIT(SUB_BIN,3);
     1656     4355    5                      END;
     1657     4356    5                      ELSE DO;
     1658     4357    5                           SUB_BIN = 0;
     1659     4358    5                           SUB_BIT.ONE = BINBIT(SUB_BIN,3);
     1660     4359    5                           CALL CHARBIN(SUB_BIN,TEMP$->OUT$BLK.SUBLK$(0)
     1661     4360    5                                        ->OUT$SYM.TEXT);
     1662     4361    5                           SUB_BIT.TWO = BINBIT(SUB_BIN,3);
     1663     4362    5                           END;
     1664     4363    4                      IF MATCH_DEL
     1665     4364    4                        THEN
     1666     4365    4                           IF ((TH_CONSTRAINTS.M_SUB_S)&(SUBB_BIT=TH_CONSTRAINTS.M_SUB)
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:279  
              4365                                    )
     1667     4366    4                             THEN TH_CONSTRAINTS.M_SUB_S = %NO;
     1668     4367    5                             ELSE DO;
     1669     4368    5                                  CALL THM$ERRMSG(%E$TH_BAD_SUB);
     1670     4369    5                                  ALTRETURN;
     1671     4370    5                                  END;
     1672     4371    5                        ELSE DO;
     1673     4372    5                           TH_CONSTRAINTS.M_SUB_S = %YES;
     1674     4373    5                           TH_CONSTRAINTS.M_SUB = SUBB_BIT;
     1675     4374    5                           END;
     1676     4375    4                      DEL_TEST = 'SUB';
     1677     4376    4                    CASE(%COD);
     1678     4377    4                      VALUE = 0;
     1679     4378    4                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1680     4379    5                      DO K = 0 TO TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;
     1681     4380    5                         VALUE = VALUE * 10;
     1682     4381    5                         CALL CHARBIN(SUB_BIN,SUBB(K));
     1683     4382    5                         VALUE = VALUE + SUB_BIN;
     1684     4383    5                      END;
     1685     4384    4                      FI_ERR = VALUE;
     1686     4385    4                      IF MATCH_DEL
     1687     4386    4                         THEN
     1688     4387    4                           IF ((TH_CONSTRAINTS.M_COD_SET) &
     1689     4388    4                               (FI_ERR = TH_CONSTRAINTS.M_COD))
     1690     4389    4                               THEN TH_CONSTRAINTS.M_COD_SET = %NO;
     1691     4390    5                               ELSE DO;
     1692     4391    5                                 CALL THM$ERRMSG(%E$TH_BAD_COD);
     1693     4392    5                                 ALTRETURN;
     1694     4393    5                               END;
     1695     4394    5                         ELSE DO;
     1696     4395    5                           TH_CONSTRAINTS.M_COD_SET = %YES;
     1697     4396    5                           TH_CONSTRAINTS.M_COD = FI_ERR;
     1698     4397    5                         END;
     1699     4398    4                         DEL_TEST = 'COD';
     1700     4399    4                    CASE(%REA);
     1701     4400    4                      VALUE = 0;
     1702     4401    4                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:280  
     1703     4402    5                      DO K = 0 TO TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;
     1704     4403    5                         VALUE = VALUE * 10;
     1705     4404    5                         CALL CHARBIN(SUB_BIN,SUBB(K));
     1706     4405    5                         VALUE = VALUE + SUB_BIN;
     1707     4406    5                      END;
     1708     4407    4                      FI_ERR = VALUE;
     1709     4408    4                      IF MATCH_DEL
     1710     4409    4                         THEN
     1711     4410    4                           IF ((TH_CONSTRAINTS.M_REA_SET) &
     1712     4411    4                               (FI_ERR = TH_CONSTRAINTS.M_REA))
     1713     4412    4                               THEN TH_CONSTRAINTS.M_REA_SET = %NO;
     1714     4413    5                               ELSE DO;
     1715     4414    5                                 CALL THM$ERRMSG(%E$TH_BAD_REA);
     1716     4415    5                                 ALTRETURN;
     1717     4416    5                               END;
     1718     4417    5                         ELSE DO;
     1719     4418    5                           TH_CONSTRAINTS.M_REA_SET = %YES;
     1720     4419    5                           TH_CONSTRAINTS.M_REA = FI_ERR;
     1721     4420    5                         END;
     1722     4421    4                         DEL_TEST = 'REA';
     1723     4422    4                    CASE(%ACT);
     1724     4423    4                      CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1725     4424    4                      FI_ERR = VALUE;
     1726     4425    4                      IF MATCH_DEL
     1727     4426    4                         THEN
     1728     4427    4                           IF ((TH_CONSTRAINTS.M_ACT_SET) &
     1729     4428    4                               (FI_ERR = TH_CONSTRAINTS.M_ACT))
     1730     4429    4                               THEN TH_CONSTRAINTS.M_ACT_SET = %NO;
     1731     4430    5                               ELSE DO;
     1732     4431    5                                 CALL THM$ERRMSG(%E$TH_BAD_ACT);
     1733     4432    5                                 ALTRETURN;
     1734     4433    5                               END;
     1735     4434    5                         ELSE DO;
     1736     4435    5                           TH_CONSTRAINTS.M_ACT_SET = %YES;
     1737     4436    5                           TH_CONSTRAINTS.M_ACT = FI_ERR;
     1738     4437    5                         END;
     1739     4438    4                         DEL_TEST = 'ACT';
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:281  
     1740     4439    4                    CASE(%MED);
     1741     4440    4                      MEDIA = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1742     4441    4                      IF (MATCH_DEL)
     1743     4442    4                        THEN
     1744     4443    4                           IF ((TH_CONSTRAINTS.M_MED_S)&(MEDIA=TH_CONSTRAINTS.M_MED))
     1745     4444    4                             THEN TH_CONSTRAINTS.M_MED_S = %NO;
     1746     4445    5                             ELSE DO;
     1747     4446    5                                CALL THM$ERRMSG(%E$TH_BAD_MED);
     1748     4447    5                                ALTRETURN;
     1749     4448    5                                END;
     1750     4449    5                        ELSE DO;
     1751     4450    5                           TH_CONSTRAINTS.M_MED_S = %YES;
     1752     4451    5                           TH_CONSTRAINTS.M_MED = MEDIA;
     1753     4452    5                           END;
     1754     4453    4                      DEL_TEST = 'MED';
     1755     4454    4                    CASE(%BY_B);
     1756     4455    4                      CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1757     4456    4                      IF VALUE > 25
     1758     4457    5                        THEN DO;
     1759     4458    5                           CALL THM$ERRMSG(%E$TH_BAD_BYTE);
     1760     4459    5                           ALTRETURN;
     1761     4460    5                           END;
     1762     4461    4                      BYTE_SPEC = VALUE;
     1763     4462    5                      DO CASE(TEMP$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE);
     1764     4463    5                         CASE(%BIT);
     1765     4464    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(1)
     1766     4465    5                                        ->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1767     4466    5                           IF VALUE > 7
     1768     4467    6                             THEN DO;
     1769     4468    6                                CALL THM$ERRMSG(%E$TH_BAD_BIT);
     1770     4469    6                                ALTRETURN;
     1771     4470    6                                END;
     1772     4471    5                           FIRST_BIT = VALUE;
     1773     4472    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(1)
     1774     4473    5                                        ->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);
     1775     4474    5                           IF (VALUE = 0 OR VALUE = 1)
     1776     4475    5                             THEN ;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:282  
     1777     4476    6                             ELSE DO;
     1778     4477    6                                CALL THM$ERRMSG(%E$TH_BAD_BIT);
     1779     4478    6                                ALTRETURN;
     1780     4479    6                                END;
     1781     4480    5                           BIT_SPEC = BINBIT(VALUE,1);
     1782     4481    5                           INDX = (BYTE_SPEC) * 8 + FIRST_BIT;
     1783     4482    5                           IF MATCH_DEL
     1784     4483    5                              THEN
     1785     4484    5                                IF ((TH_CONSTRAINTS.M_BY_B_SET(INDX)) &
     1786     4485    5                                    (TH_CONSTRAINTS.M_BY_B_VEC(INDX)=BIT_SPEC))
     1787     4486    5                                   THEN
     1788     4487    5                                     TH_CONSTRAINTS.M_BY_B_SET(INDX)=%NO;
     1789     4488    6                                   ELSE DO;
     1790     4489    6                                     CALL THM$ERRMSG(%E$TH_BAD_BIT);
     1791     4490    6                                     ALTRETURN;
     1792     4491    6                                     END;
     1793     4492    6                              ELSE DO;
     1794     4493    6                                TH_CONSTRAINTS.M_BY_B_SET(INDX) = %YES;
     1795     4494    6                                TH_CONSTRAINTS.M_BY_B_VEC(INDX) = BIT_SPEC;
     1796     4495    6                                END;
     1797     4496    5                         CASE(%BIT_STR);
     1798     4497    5                           TEMP = TEMP$->OUT$BLK.SUBLK$(1)->
     1799     4498    5                                  OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1800     4499    6                        DO K = 0 TO 7;
     1801     4500    6                        CALL CHARBIN(VALUE,TEMPP(K));
     1802     4501    6                             IF (VALUE = 0 OR VALUE = 1)
     1803     4502    6                                THEN;
     1804     4503    7                                ELSE DO;
     1805     4504    7                                     CALL THM$ERRMSG(%E$TH_BAD_BIT);
     1806     4505    7                                     ALTRETURN;
     1807     4506    7                                     END;
     1808     4507    6                             BIT_SPEC = BINBIT(VALUE,1);
     1809     4508    6                        INDX = (BYTE_SPEC) * 8 + K;
     1810     4509    6                             IF MATCH_DEL
     1811     4510    6                                THEN
     1812     4511    6                                  IF ((TH_CONSTRAINTS.M_BY_B_SET(INDX)) &
     1813     4512    6                                     (TH_CONSTRAINTS.M_BY_B_VEC(INDX)=BIT_SPEC))
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:283  
     1814     4513    6                                     THEN
     1815     4514    6                                       TH_CONSTRAINTS.M_BY_B_SET(INDX)=%NO;
     1816     4515    7                                     ELSE DO;
     1817     4516    7                                       CALL THM$ERRMSG(%E$TH_BAD_BIT);
     1818     4517    7                                       ALTRETURN;
     1819     4518    7                                       END;
     1820     4519    7                                ELSE DO;
     1821     4520    7                                     TH_CONSTRAINTS.M_BY_B_SET(INDX)=%YES;
     1822     4521    7                                     TH_CONSTRAINTS.M_BY_B_VEC(INDX)=BIT_SPEC;
     1823     4522    7                                     END;
     1824     4523    6                           END;
     1825     4524    5                      END;                /* DO CASE */
     1826     4525    4                      DEL_TEST = 'BYT';
     1827     4526    4                    CASE(%FEP_CODE);
     1828     4527    4                      FEP_CODE = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1829     4528    4                      IF MATCH_DEL
     1830     4529    4                        THEN
     1831     4530    4                           IF ((TH_CONSTRAINTS.M_FEP_SET) &
     1832     4531    4                               (TH_CONSTRAINTS.M_FEP = FEP_CODE))
     1833     4532    4                             THEN TH_CONSTRAINTS.M_FEP_SET = %NO;
     1834     4533    5                             ELSE DO;
     1835     4534    5                                CALL THM$ERRMSG(%E$TH_BAD_FEP);
     1836     4535    5                                ALTRETURN;
     1837     4536    5                             END;
     1838     4537    5                        ELSE DO;
     1839     4538    5                           TH_CONSTRAINTS.M_FEP_SET = %YES;
     1840     4539    5                           TH_CONSTRAINTS.M_FEP = FEP_CODE;
     1841     4540    5                           TH_CONSTRAINTS.M_FEP_N = TEMP$->OUT$BLK.SUBLK$(0)
     1842     4541    5                                                    ->OUT$SYM.COUNT;
     1843     4542    5                           END;
     1844     4543    4                        DEL_TEST = 'FCG';
     1845     4544    4                    CASE(%FEP_CHAN);
     1846     4545    4                      FEP_CHAN = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1847     4546    4                      J = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
     1848     4547    5                      DO CASE (J);
     1849     4548    5                        CASE(1);
     1850     4549    5                           CALL CONCAT(FEP_CHAN_N,'000',SUBSTR(FEP_CHAN,0,1));
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:284  
     1851     4550    5                        CASE(2);
     1852     4551    5                           CALL CONCAT(FEP_CHAN_N,'00',SUBSTR(FEP_CHAN,0,2));
     1853     4552    5                        CASE(3);
     1854     4553    5                           CALL CONCAT(FEP_CHAN_N,'0',SUBSTR(FEP_CHAN,0,3));
     1855     4554    5                        CASE(4);
     1856     4555    5                           FEP_CHAN_N = FEP_CHAN;
     1857     4556    5                        CASE (ELSE);
     1858     4557    5                           CALL THM$ERRMSG(%E$TH_BAD_CHAN);
     1859     4558    5                           ALTRETURN;
     1860     4559    5                      END;
     1861     4560    4          IF MATCH_DEL THEN
     1862     4561    5            DO;
     1863     4562    5                IF TH_CONSTRAINTS.M_CHAN_SET
     1864     4563    5                  THEN
     1865     4564    6                  DO;
     1866     4565    6                    FOUND='0'B;
     1867     4566    7                    DO K = 0 TO TH_M_CHAN_TOTAL-1;
     1868     4567    7                      IF FEP_CHAN_N = TH_M_CHAN.TEXT(K)
     1869     4568    7                        THEN
     1870     4569    8                          DO;
     1871     4570    8                            FOUND='1'B;
     1872     4571    8                            TH_M_CHAN.FLAG(K) = '0'B;
     1873     4572    8                            GOTO FOUND_CHANNEL;
     1874     4573    8                          END;
     1875     4574    7                    END;
     1876     4575    6   FOUND_CHANNEL:   IF FOUND
     1877     4576    6                      THEN
     1878     4577    7                        DO;
     1879     4578    7                          JJ = 0;
     1880     4579    8                          DO K = 0 TO TH_M_CHAN_TOTAL-1;
     1881     4580    8                            IF TH_M_CHAN.FLAG(K) = '1'B
     1882     4581    8                                THEN  JJ = JJ + 1;
     1883     4582    8                          END;
     1884     4583    7                          IF JJ = 0
     1885     4584    7                            THEN
     1886     4585    7                                TH_CONSTRAINTS.M_CHAN_SET = '0'B;
     1887     4586    7                        END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:285  
     1888     4587    6                        ELSE
     1889     4588    6                            GOTO WRONG;
     1890     4589    6                  END;
     1891     4590    5                  ELSE
     1892     4591    6                    DO;
     1893     4592    6   WRONG:             CALL THM$ERRMSG(%E$TH_BAD_CHAN);
     1894     4593    6                      ALTRETURN;
     1895     4594    6                    END;
     1896     4595    5            END; /* IF MATCH_DEL */
     1897     4596    4            ELSE
     1898     4597    4                IF MATCH_ADD
     1899     4598    4                  THEN
     1900     4599    5                    DO;
     1901     4600    5                      TH_CONSTRAINTS.M_CHAN_SET = '1'B;
     1902     4601    5                      TH_M_CHAN.TEXT(TH_M_CHAN_TOTAL) = FEP_CHAN_N;
     1903     4602    5                      TH_M_CHAN.FLAG(TH_M_CHAN_TOTAL) = '1'B;
     1904     4603    5                      TH_M_CHAN_TOTAL = TH_M_CHAN_TOTAL + 1;
     1905     4604    5                    END;
     1906     4605    4                    ELSE
     1907     4606    5                      DO;
     1908     4607    5                        TH_CONSTRAINTS.M_CHAN_SET = '1'B;
     1909     4608    5                        TH_M_CHAN.TEXT(0) = FEP_CHAN_N;
     1910     4609    5                        TH_M_CHAN.FLAG(0) = '1'B;
     1911     4610    5                        TH_M_CHAN_TOTAL = 1;
     1912     4611    5                      END;
     1913     4612    4                        DEL_TEST = 'CHA';
     1914     4613    4                 END;                     /* OF CASE   */
     1915     4614    3             IF MATCH_DEL
     1916     4615    4               THEN DO;
     1917     4616    4                 CALL INDEX(JJ,DEL_TEST,TH_LAST_MATCH.TEXT);
     1918     4617    4                 JCNT = JJ;
     1919     4618    4       NEXT_COMMA:  FOUND = '0'B;
     1920     4619    4                 SAVE_INDEX = 0;
     1921     4620    5                 DO WHILE NOT FOUND;
     1922     4621    6                   DO WHILE(SUBSTR(TH_LAST_MATCH.TEXT,JCNT,1) ~= ',');
     1923     4622    6                      IF JCNT > TH_LAST_MATCH.COUNT
     1924     4623    6                        THEN GOTO DEL_END_M;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:286  
     1925     4624    6                        IF(SUBSTR(TH_LAST_MATCH.TEXT,JCNT,1) = '=')
     1926     4625    7                        THEN DO;
     1927     4626    7                          SAVE_INDEX = JCNT - 5;
     1928     4627    7                          IF(SUBSTR(TH_LAST_MATCH.TEXT,JCNT+1,4) = FEP_CHAN)
     1929     4628    8                          THEN DO;JCNT = JCNT + 5;
     1930     4629    8                                  FOUND = '1'B;
     1931     4630    8                          END;
     1932     4631    7                          ELSE
     1933     4632    7                            JCNT = JCNT + 1;
     1934     4633    7                        END;
     1935     4634    6                      ELSE
     1936     4635    6                      JCNT = JCNT + 1;
     1937     4636    6                   END; /* do while ~= ','*/
     1938     4637    5                   IF NOT FOUND THEN
     1939     4638    5                     JCNT = JCNT + 1;
     1940     4639    5                 END;
     1941     4640    4                 IF DEL_TEST = 'BYT' AND TEMP$->OUT$BLK.SUBLK$(1)
     1942     4641    4                      ->OUT$BLK.CODE = %BIT
     1943     4642    5                      THEN DO;
     1944     4643    5                           JCNT = JCNT + 1;
     1945     4644    5                           GOTO NEXT_COMMA;
     1946     4645    5                      END;
     1947     4646    4       DEL_END_M:
     1948     4647    4                 C_TEST = ' ';
     1949     4648    4                 IF SAVE_INDEX = 0 THEN
     1950     4649    4                 CALL CONCAT(C_TEST,SUBSTR(TH_LAST_MATCH.TEXT,JCNT+1));
     1951     4650    4                 ELSE CALL CONCAT(C_TEST,SUBSTR(TH_LAST_MATCH.TEXT,0,SAVE_INDEX),
     1952     4651    4                                  SUBSTR(TH_LAST_MATCH.TEXT,JCNT+1));
     1953     4652    4                 TH_LAST_MATCH.TEXT = C_TEST;
     1954     4653    4                 IF JCNT > TH_LAST_MATCH.COUNT
     1955     4654    4                    THEN
     1956     4655    4                      TH_LAST_MATCH.COUNT=TH_LAST_MATCH.COUNT-(JCNT-JJ);
     1957     4656    4                    ELSE
     1958     4657    4                     TH_LAST_MATCH.COUNT = TH_LAST_MATCH.COUNT - (JCNT+1) + SAVE_INDEX;
     1959     4658    4                 END;
     1960     4659    3            END;                          /* DO I = J   */
     1961     4660    2             IF MATCH_DEL
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:287  
     1962     4661    2                 THEN ;
     1963     4662    3                 ELSE DO;
     1964     4663    3            CALL INDEX(INDX,' ',TEXTBASE);
     1965     4664    4            DO WHILE(SUBSTR(TEXTBASE,INDX,1) = ' ');
     1966     4665    4                 INDX = INDX + 1;
     1967     4666    4            END;    /* OF WHILE */
     1968     4667    3             IF MATCH_ADD
     1969     4668    4               THEN DO;
     1970     4669    4                 CALL INDEX(JJ,' ',SUBSTR(TEXTBASE,INDX,P_PCB.NCHARS-INDX));
     1971     4670    5                 DO WHILE (SUBSTR(TEXTBASE,JJ,1) = ' ');
     1972     4671    5                   JJ = JJ + 1;
     1973     4672    5                 END;
     1974     4673    4                 JJ = JJ + INDX;
     1975     4674    4                 JJ = P_PCB.NCHARS - JJ;
     1976     4675    4                 TH_LAST_MATCH.COUNT = TH_LAST_MATCH.COUNT + JJ + 1;
     1977     4676    4                 CALL INSERT(TH_LAST_MATCH.TEXT,,,SUBSTR(TH_LAST_MATCH.TEXT,
     1978     4677    4                             0,TH_LAST_MATCH.COUNT-JJ-1),',',SUBSTR(TEXTBASE,
     1979     4678    4                             P_PCB.NCHARS-JJ,JJ));
     1980     4679    4               END;
     1981     4680    4               ELSE DO;
     1982     4681    4            TH_LAST_MATCH.COUNT = P_PCB.NCHARS-INDX;
     1983     4682    4            TH_LAST_MATCH.TEXT = SUBSTR(TEXTBASE,INDX,P_PCB.NCHARS-INDX);
     1984     4683    4            END;
     1985     4684    3       END;
     1986     4685    2            CASE (%EXCLUDE);
     1987     4686                                               /* PROCESS EXCLUDE COMMAND         */
     1988     4687    2              EXCLUDE_DEL = %NO;
     1989     4688    2            EXCLUDE_ADD = %NO;
     1990     4689    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %DELETEE
     1991     4690    3                 THEN DO;
     1992     4691    3                      EXCLUDE_DEL = %YES;
     1993     4692    3                      J = 1;
     1994     4693    3                      END;
     1995     4694    2                 ELSE
     1996     4695    2                      IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %ADDD
     1997     4696    3                           THEN DO;
     1998     4697    3                                J = 1;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:288  
     1999     4698    3                                EXCLUDE_ADD = %YES;
     2000     4699    3                                END;
     2001     4700    3                           ELSE DO;
     2002     4701    3                                J = 0;
     2003     4702    3                                TH_CONSTRAINTS.E_BY_B_SET = %NO;
     2004     4703    3                                TH_CONSTRAINTS.E_MAJ_S = %NO;
     2005     4704    3                                TH_CONSTRAINTS.E_SUB_S = %NO;
     2006     4705    3                                TH_CONSTRAINTS.E_MED_S = %NO;
     2007     4706    3                                TH_CONSTRAINTS.E_FEP_SET = %NO;
     2008     4707    3                                TH_CONSTRAINTS.E_CHAN_SET = %NO;
     2009     4708    3                                TH_CONSTRAINTS.E_COD_SET = %NO;
     2010     4709    3                                TH_CONSTRAINTS.E_REA_SET = %NO;
     2011     4710    3                                TH_CONSTRAINTS.E_ACT_SET = %NO;
     2012     4711    3                                END;
     2013     4712    3              DO I = J TO OUT$BLK.NSUBLKS - 1;
     2014     4713    3                 TEMP$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);
     2015     4714    4                 DO CASE(TEMP$->OUT$BLK.CODE);
     2016     4715    4                    CASE(%MAJ);
     2017     4716    4                      IF TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 2
     2018     4717    5                        THEN DO;
     2019     4718    5                           SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2020     4719    5                           CALL CHARBIN(SUB_BIN,SUBB(0));
     2021     4720    5                           VALUE = SUB_BIN * 8;
     2022     4721    5                           CALL CHARBIN(SUB_BIN,SUBB(1));
     2023     4722    5                           VALUE = VALUE + SUB_BIN;
     2024     4723    5                           MAJOR = VALUE;
     2025     4724    5                           END;
     2026     4725    5                        ELSE DO;
     2027     4726    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)
     2028     4727    5                                        ->OUT$SYM.TEXT);
     2029     4728    5                           MAJOR = VALUE;
     2030     4729    5                           END;
     2031     4730    4                      IF EXCLUDE_DEL
     2032     4731    4                        THEN
     2033     4732    4                           IF ((TH_CONSTRAINTS.E_MAJ_S) & (MAJOR=TH_CONSTRAINTS.E_MAJ))
     2034     4733    4                             THEN TH_CONSTRAINTS.E_MAJ_S = %NO;
     2035     4734    5                             ELSE DO;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:289  
     2036     4735    5                                  CALL THM$ERRMSG(%E$TH_BAD_MAJ);
     2037     4736    5                                  ALTRETURN;
     2038     4737    5                                  END;
     2039     4738    5                        ELSE DO;
     2040     4739    5                             TH_CONSTRAINTS.E_MAJ_S = %YES;
     2041     4740    5                             TH_CONSTRAINTS.E_MAJ = MAJOR;
     2042     4741    5                             END;
     2043     4742    4                      DEL_TEST = 'MAJ';
     2044     4743    4                    CASE(%SUB);
     2045     4744    4                     IF TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 2
     2046     4745    5                      THEN DO;
     2047     4746    5                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2048     4747    5                      CALL CHARBIN(SUB_BIN,SUBB(0));
     2049     4748    5                      SUB_BIT.ONE = BINBIT(SUB_BIN,3);
     2050     4749    5                      CALL CHARBIN(SUB_BIN,SUBB(1));
     2051     4750    5                      SUB_BIT.TWO = BINBIT(SUB_BIN,3);
     2052     4751    5                      END;
     2053     4752    5                      ELSE DO;
     2054     4753    5                           SUB_BIN = 0;
     2055     4754    5                           SUB_BIT.ONE = BINBIT(SUB_BIN,3);
     2056     4755    5                           CALL CHARBIN(SUB_BIN,TEMP$->OUT$BLK.SUBLK$(0)
     2057     4756    5                                        ->OUT$SYM.TEXT);
     2058     4757    5                           SUB_BIT.TWO = BINBIT(SUB_BIN,3);
     2059     4758    5                           END;
     2060     4759    4                      IF EXCLUDE_DEL
     2061     4760    4                        THEN
     2062     4761    4                           IF ((TH_CONSTRAINTS.E_SUB_S)&(SUBB_BIT=TH_CONSTRAINTS.E_SUB)
              4761                                    )
     2063     4762    4                             THEN TH_CONSTRAINTS.E_SUB_S = %NO;
     2064     4763    5                             ELSE DO;
     2065     4764    5                                  CALL THM$ERRMSG(%E$TH_BAD_SUB);
     2066     4765    5                                  ALTRETURN;
     2067     4766    5                                  END;
     2068     4767    5                        ELSE DO;
     2069     4768    5                           TH_CONSTRAINTS.E_SUB_S = %YES;
     2070     4769    5                           TH_CONSTRAINTS.E_SUB = SUBB_BIT;
     2071     4770    5                           END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:290  
     2072     4771    4                      DEL_TEST = 'SUB';
     2073     4772    4                    CASE(%COD);
     2074     4773    4                      VALUE = 0;
     2075     4774    4                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2076     4775    5                      DO K = 0 TO TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;
     2077     4776    5                         VALUE = VALUE * 10;
     2078     4777    5                         CALL CHARBIN(SUB_BIN,SUBB(K));
     2079     4778    5                         VALUE = VALUE + SUB_BIN;
     2080     4779    5                      END;
     2081     4780    4                      FI_ERR = VALUE;
     2082     4781    4                      IF EXCLUDE_DEL
     2083     4782    4                         THEN
     2084     4783    4                           IF ((TH_CONSTRAINTS.E_COD_SET) &
     2085     4784    4                               (FI_ERR = TH_CONSTRAINTS.E_COD))
     2086     4785    4                               THEN TH_CONSTRAINTS.E_COD_SET = %NO;
     2087     4786    5                               ELSE DO;
     2088     4787    5                                 CALL THM$ERRMSG(%E$TH_BAD_COD);
     2089     4788    5                                 ALTRETURN;
     2090     4789    5                               END;
     2091     4790    5                         ELSE DO;
     2092     4791    5                           TH_CONSTRAINTS.E_COD_SET = %YES;
     2093     4792    5                           TH_CONSTRAINTS.E_COD = FI_ERR;
     2094     4793    5                         END;
     2095     4794    4                         DEL_TEST = 'COD';
     2096     4795    4                    CASE(%REA);
     2097     4796    4                      VALUE = 0;
     2098     4797    4                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2099     4798    5                      DO K = 0 TO TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;
     2100     4799    5                         VALUE = VALUE * 10;
     2101     4800    5                         CALL CHARBIN(SUB_BIN,SUBB(K));
     2102     4801    5                         VALUE = VALUE + SUB_BIN;
     2103     4802    5                      END;
     2104     4803    4                      FI_ERR = VALUE;
     2105     4804    4                      IF EXCLUDE_DEL
     2106     4805    4                         THEN
     2107     4806    4                           IF ((TH_CONSTRAINTS.E_REA_SET) &
     2108     4807    4                               (FI_ERR = TH_CONSTRAINTS.E_REA))
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:291  
     2109     4808    4                               THEN TH_CONSTRAINTS.E_REA_SET = %NO;
     2110     4809    5                               ELSE DO;
     2111     4810    5                                 CALL THM$ERRMSG(%E$TH_BAD_REA);
     2112     4811    5                                 ALTRETURN;
     2113     4812    5                               END;
     2114     4813    5                         ELSE DO;
     2115     4814    5                           TH_CONSTRAINTS.E_REA_SET = %YES;
     2116     4815    5                           TH_CONSTRAINTS.E_REA = FI_ERR;
     2117     4816    5                         END;
     2118     4817    4                         DEL_TEST = 'REA';
     2119     4818    4                    CASE(%ACT);
     2120     4819    4                      CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     2121     4820    4                      FI_ERR = VALUE;
     2122     4821    4                      IF EXCLUDE_DEL
     2123     4822    4                         THEN
     2124     4823    4                           IF ((TH_CONSTRAINTS.E_ACT_SET) &
     2125     4824    4                               (FI_ERR = TH_CONSTRAINTS.E_ACT))
     2126     4825    4                               THEN TH_CONSTRAINTS.E_ACT_SET = %NO;
     2127     4826    5                               ELSE DO;
     2128     4827    5                                 CALL THM$ERRMSG(%E$TH_BAD_ACT);
     2129     4828    5                                 ALTRETURN;
     2130     4829    5                               END;
     2131     4830    5                         ELSE DO;
     2132     4831    5                           TH_CONSTRAINTS.E_ACT_SET = %YES;
     2133     4832    5                           TH_CONSTRAINTS.E_ACT = FI_ERR;
     2134     4833    5                         END;
     2135     4834    4                         DEL_TEST = 'ACT';
     2136     4835    4                    CASE(%MED);
     2137     4836    4                      MEDIA = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2138     4837    4                      IF (EXCLUDE_DEL)
     2139     4838    4                        THEN
     2140     4839    4                           IF ((TH_CONSTRAINTS.E_MED_S)&(MEDIA=TH_CONSTRAINTS.E_MED))
     2141     4840    4                             THEN TH_CONSTRAINTS.E_MED_S = %NO;
     2142     4841    5                             ELSE DO;
     2143     4842    5                                CALL THM$ERRMSG(%E$TH_BAD_MED);
     2144     4843    5                                ALTRETURN;
     2145     4844    5                                END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:292  
     2146     4845    5                        ELSE DO;
     2147     4846    5                           TH_CONSTRAINTS.E_MED_S = %YES;
     2148     4847    5                           TH_CONSTRAINTS.E_MED = MEDIA;
     2149     4848    5                           END;
     2150     4849    4                      DEL_TEST = 'MED';
     2151     4850    4                    CASE(%BY_B);
     2152     4851    4                      CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     2153     4852    4                      IF VALUE > 25
     2154     4853    5                        THEN DO;
     2155     4854    5                           CALL THM$ERRMSG(%E$TH_BAD_BYTE);
     2156     4855    5                           ALTRETURN;
     2157     4856    5                           END;
     2158     4857    4                      BYTE_SPEC = VALUE;
     2159     4858    5                      DO CASE(TEMP$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE);
     2160     4859    5                         CASE(%BIT);
     2161     4860    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(1)
     2162     4861    5                                        ->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     2163     4862    5                           IF VALUE > 7
     2164     4863    6                             THEN DO;
     2165     4864    6                                CALL THM$ERRMSG(%E$TH_BAD_BIT);
     2166     4865    6                                ALTRETURN;
     2167     4866    6                                END;
     2168     4867    5                           FIRST_BIT = VALUE;
     2169     4868    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(1)
     2170     4869    5                                        ->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);
     2171     4870    5                           IF (VALUE = 0 OR VALUE = 1)
     2172     4871    5                             THEN;
     2173     4872    6                             ELSE DO;
     2174     4873    6                                CALL THM$ERRMSG(%E$TH_BAD_BIT);
     2175     4874    6                                ALTRETURN;
     2176     4875    6                                END;
     2177     4876    5                           BIT_SPEC = BINBIT(VALUE,1);
     2178     4877    5                           INDX = (BYTE_SPEC) * 8 + FIRST_BIT;
     2179     4878    5                           IF EXCLUDE_DEL
     2180     4879    5                              THEN
     2181     4880    5                                IF ((TH_CONSTRAINTS.E_BY_B_SET(INDX)) &
     2182     4881    5                                    (TH_CONSTRAINTS.E_BY_B_VEC(INDX)=BIT_SPEC))
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:293  
     2183     4882    5                                   THEN
     2184     4883    5                                     TH_CONSTRAINTS.E_BY_B_SET(INDX)=%NO;
     2185     4884    6                                   ELSE DO;
     2186     4885    6                                     CALL THM$ERRMSG(%E$TH_BAD_BIT);
     2187     4886    6                                     ALTRETURN;
     2188     4887    6                                     END;
     2189     4888    6                              ELSE DO;
     2190     4889    6                                TH_CONSTRAINTS.E_BY_B_SET(INDX) = %YES;
     2191     4890    6                                TH_CONSTRAINTS.E_BY_B_VEC(INDX) = BIT_SPEC;
     2192     4891    6                                END;
     2193     4892    5                         CASE(%BIT_STR);
     2194     4893    5                           TEMP = TEMP$->OUT$BLK.SUBLK$(1)->
     2195     4894    5                                  OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2196     4895    6                        DO K = 0 TO 7;
     2197     4896    6                        CALL CHARBIN(VALUE,TEMPP(K));
     2198     4897    6                             IF (VALUE = 0 OR VALUE = 1)
     2199     4898    6                                THEN;
     2200     4899    7                                ELSE DO;
     2201     4900    7                                     CALL THM$ERRMSG(%E$TH_BAD_BIT);
     2202     4901    7                                     ALTRETURN;
     2203     4902    7                                     END;
     2204     4903    6                             BIT_SPEC = BINBIT(VALUE,1);
     2205     4904    6                        INDX = (BYTE_SPEC) * 8 + K;
     2206     4905    6                             IF EXCLUDE_DEL
     2207     4906    6                                THEN
     2208     4907    6                                  IF ((TH_CONSTRAINTS.E_BY_B_SET(INDX)) &
     2209     4908    6                                     (TH_CONSTRAINTS.E_BY_B_VEC(INDX)=BIT_SPEC))
     2210     4909    6                                     THEN
     2211     4910    6                                       TH_CONSTRAINTS.E_BY_B_SET(INDX)=%NO;
     2212     4911    7                                     ELSE DO;
     2213     4912    7                                       CALL THM$ERRMSG(%E$TH_BAD_BIT);
     2214     4913    7                                       ALTRETURN;
     2215     4914    7                                       END;
     2216     4915    7                                ELSE DO;
     2217     4916    7                                     TH_CONSTRAINTS.E_BY_B_SET(INDX)=%YES;
     2218     4917    7                                     TH_CONSTRAINTS.E_BY_B_VEC(INDX)=BIT_SPEC;
     2219     4918    7                                     END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:294  
     2220     4919    6                           END;
     2221     4920    5                      END;                /* DO CASE */
     2222     4921    4                      DEL_TEST = 'BYT';
     2223     4922    4                    CASE(%FEP_CODE);
     2224     4923    4                      FEP_CODE = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2225     4924    4                      IF EXCLUDE_DEL
     2226     4925    4                        THEN
     2227     4926    4                           IF ((TH_CONSTRAINTS.E_FEP_SET) &
     2228     4927    4                               (TH_CONSTRAINTS.E_FEP = FEP_CODE))
     2229     4928    4                             THEN TH_CONSTRAINTS.E_FEP_SET = %NO;
     2230     4929    5                             ELSE DO;
     2231     4930    5                                CALL THM$ERRMSG(%E$TH_BAD_FEP);
     2232     4931    5                                ALTRETURN;
     2233     4932    5                             END;
     2234     4933    5                        ELSE DO;
     2235     4934    5                           TH_CONSTRAINTS.E_FEP_SET = %YES;
     2236     4935    5                           TH_CONSTRAINTS.E_FEP = FEP_CODE;
     2237     4936    5                           TH_CONSTRAINTS.E_FEP_N = TEMP$->OUT$BLK.SUBLK$(0)
     2238     4937    5                                                    ->OUT$SYM.COUNT;
     2239     4938    5                           END;
     2240     4939    4                      DEL_TEST = 'FCG';
     2241     4940    4                    CASE(%FEP_CHAN);
     2242     4941    4                      FEP_CHAN = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2243     4942    4                      J = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
     2244     4943    5                      DO CASE (J);
     2245     4944    5                        CASE(1);
     2246     4945    5                           CALL CONCAT(FEP_CHAN_N,'000',SUBSTR(FEP_CHAN,0,1));
     2247     4946    5                        CASE(2);
     2248     4947    5                           CALL CONCAT(FEP_CHAN_N,'00',SUBSTR(FEP_CHAN,0,2));
     2249     4948    5                        CASE(3);
     2250     4949    5                           CALL CONCAT(FEP_CHAN_N,'0',SUBSTR(FEP_CHAN,0,3));
     2251     4950    5                        CASE(4);
     2252     4951    5                           FEP_CHAN_N = FEP_CHAN;
     2253     4952    5                        CASE (ELSE);
     2254     4953    5                           CALL THM$ERRMSG(%E$TH_BAD_CHAN);
     2255     4954    5                           ALTRETURN;
     2256     4955    5                      END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:295  
     2257     4956    4                      IF EXCLUDE_DEL
     2258     4957    4                        THEN
     2259     4958    4                           IF ((TH_CONSTRAINTS.E_CHAN_SET) &
     2260     4959    4                               (TH_CONSTRAINTS.E_CHAN = FEP_CHAN_N))
     2261     4960    4                             THEN TH_CONSTRAINTS.E_CHAN_SET= %NO;
     2262     4961    5                             ELSE DO;
     2263     4962    5                                CALL THM$ERRMSG(%E$TH_BAD_CHAN);
     2264     4963    5                                ALTRETURN;
     2265     4964    5                             END;
     2266     4965    5                        ELSE DO;
     2267     4966    5                           TH_CONSTRAINTS.E_CHAN_SET= %YES;
     2268     4967    5                           TH_CONSTRAINTS.E_CHAN = FEP_CHAN_N;
     2269     4968    5                              END;
     2270     4969    4                      DEL_TEST = 'CHA';
     2271     4970    4                 END;                     /* OF CASE   */
     2272     4971    3             IF EXCLUDE_DEL
     2273     4972    4               THEN DO;
     2274     4973    4                 CALL INDEX(JJ,DEL_TEST,TH_LAST_EXCLUDE.TEXT);
     2275     4974    4                 JCNT = JJ;
     2276     4975    4       NEXT_COMMA_E:
     2277     4976    5                 DO WHILE (SUBSTR(TH_LAST_EXCLUDE.TEXT,JCNT,1) ~= ',');
     2278     4977    5                      IF JCNT > TH_LAST_EXCLUDE.COUNT
     2279     4978    5                        THEN GOTO DEL_END_E;
     2280     4979    5                      JCNT = JCNT + 1;
     2281     4980    5                 END;
     2282     4981    4                 IF DEL_TEST = 'BYT' AND TEMP$->OUT$BLK.SUBLK$(1)
     2283     4982    4                      ->OUT$BLK.CODE = %BIT
     2284     4983    5                      THEN DO;
     2285     4984    5                           JCNT = JCNT + 1;
     2286     4985    5                           GOTO NEXT_COMMA_E;
     2287     4986    5                      END;
     2288     4987    4       DEL_END_E:
     2289     4988    4                 C_TEST = ' ';
     2290     4989    4                 CALL CONCAT(C_TEST,SUBSTR(TH_LAST_EXCLUDE.TEXT,
     2291     4990    4                             0,JJ),SUBSTR(TH_LAST_EXCLUDE.TEXT,JCNT+1));
     2292     4991    4                 TH_LAST_EXCLUDE.TEXT = C_TEST;
     2293     4992    4                 IF JCNT > TH_LAST_EXCLUDE.COUNT
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:296  
     2294     4993    4                    THEN
     2295     4994    4                      TH_LAST_EXCLUDE.COUNT=TH_LAST_EXCLUDE.COUNT-(JCNT-JJ);
     2296     4995    4                    ELSE
     2297     4996    4                      TH_LAST_EXCLUDE.COUNT = TH_LAST_EXCLUDE.COUNT - (JCNT-JJ+1);
     2298     4997    4                 END;
     2299     4998    3            END;                          /* DO I = J   */
     2300     4999    2             IF EXCLUDE_DEL
     2301     5000    2                 THEN ;
     2302     5001    3                 ELSE DO;
     2303     5002    3            CALL INDEX(INDX,' ',TEXTBASE);
     2304     5003    4            DO WHILE(SUBSTR(TEXTBASE,INDX,1) = ' ');
     2305     5004    4                 INDX = INDX + 1;
     2306     5005    4            END;    /* OF WHILE */
     2307     5006    3             IF EXCLUDE_ADD
     2308     5007    4               THEN DO;
     2309     5008    4                 CALL INDEX(JJ,' ',SUBSTR(TEXTBASE,INDX,P_PCB.NCHARS-INDX));
     2310     5009    5                 DO WHILE (SUBSTR(TEXTBASE,JJ,1) = ' ');
     2311     5010    5                   JJ = JJ + 1;
     2312     5011    5                 END;
     2313     5012    4                 JJ = JJ + INDX;
     2314     5013    4                 JJ = P_PCB.NCHARS - JJ;
     2315     5014    4                 TH_LAST_EXCLUDE.COUNT = TH_LAST_EXCLUDE.COUNT + JJ + 1;
     2316     5015    4                 CALL INSERT(TH_LAST_EXCLUDE.TEXT,,,SUBSTR(TH_LAST_EXCLUDE.TEXT,
     2317     5016    4                             0,TH_LAST_EXCLUDE.COUNT-JJ-1),',',SUBSTR(TEXTBASE,
     2318     5017    4                             P_PCB.NCHARS-JJ,JJ));
     2319     5018    4               END;
     2320     5019    4               ELSE DO;
     2321     5020    4            TH_LAST_EXCLUDE.COUNT = P_PCB.NCHARS-INDX;
     2322     5021    4            TH_LAST_EXCLUDE.TEXT = SUBSTR(TEXTBASE,INDX,P_PCB.NCHARS-INDX);
     2323     5022    4            END;
     2324     5023    3            END;
     2325     5024                 /*E* ERROR:  THE-E$TH_BAD_MAJ-0
     2326     5025                      MESSAGE: Bad major specification
     2327     5026                 */
     2328     5027                 /*E* ERROR:  THE-E$TH_BAD_SUB-0
     2329     5028                      MESSAGE:  Bad minor(sub) specification
     2330     5029                 */
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:297  
     2331     5030                 /*E* ERROR:  THE-E$TH_BAD_MED-0
     2332     5031                      MESSAGE:  Bad media-id specification
     2333     5032                 */
     2334     5033
     2335     5034                      /*E* ERROR: THE-E$TH_BAD_FEP-0
     2336     5035                           MESSAGE: Bad FEP error code specification
     2337     5036                      */
     2338     5037                   /*E* ERROR: THE-E$TH_BAD_BYTE-0
     2339     5038                        MESSAGE: Bad byte specification
     2340     5039                        MESSAGE1: Byte spec must be in the range 0-25
     2341     5040                   */
     2342     5041                   /*E* ERROR: THE-E$TH_BAD_BIT-0
     2343     5042                        MESSAGE: Bad bit specification
     2344     5043                        MESSAGE1: Bit spec must be in the range 0-7
     2345     5044                   */
     2346     5045                   /*E* ERROR: THE-E$TH_BAD_RANGE-0
     2347     5046                        MESSAGE: Bad range spec : HI < LO
     2348     5047                   */
     2349     5048                   /*E* ERROR: THE-E$TH_BAD_CHAN-0
     2350     5049                        MESSAGE: Bad FEP channel specification
     2351     5050                   */
     2352     5051                   /*E* ERROR: THE-E$TH_BAD_COD-0
     2353     5052                        MESSAGE: Bad I/O error code specification
     2354     5053                   */
     2355     5054                   /*E* ERROR: THE-E$TH_BAD_REA-0
     2356     5055                        MESSAGE: Bad Reason specification
     2357     5056                   */
     2358     5057                   /*E* ERROR: THE-E$TH_BAD_ACT-0
     2359     5058                        MESSAGE: Bad Action specification
     2360     5059                   */
     2361     5060    2           CASE(%OCTAL);
     2362     5061    2              TH_CONSTRAINTS.OCTAL = %YES;
     2363     5062    2           CASE(%CROSS);
     2364     5063    2              TH_CONSTRAINTS.CROSS = %YES;
     2365     5064    2           CASE(%RESET);
     2366     5065    3              IF OUT$BLK.NSUBLKS = 0 THEN DO;
     2367     5066    3                 TH_CONSTRAINTS = TH_DEFAULT; /* ALL RESET                  */
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:298  
     2368     5067    3                 TH_RECOV = %FALSE;
     2369     5068    3                 VLP_SYSTAC.ACCT# = ':SYSTAC';
     2370     5069    3                 TH_OPEN_ERRLOG.ACCT_ = VECTOR(VLP_SYSTAC);
     2371     5070    3                 TH_OPEN_ERRLOG.NAME_ = VECTOR(TH_VLP_ERRLOG);
     2372     5071    3                 TH_CHANGE_ACCOUNT = '1'B;
     2373     5072    3                TH_LAST_MATCH.TEXT = ' ';
     2374     5073    3                TH_LAST_EXCLUDE.TEXT = ' ';
     2375     5074    3                TH_LAST_EXCLUDE.COUNT = 0;
     2376     5075    3                TH_LAST_MATCH.COUNT = 0;
     2377     5076    3                 END;  /* IF */
     2378     5077    2                 ELSE
     2379     5078    3                 DO I = 0 TO OUT$BLK.NSUBLKS - 1;
     2380     5079    4                    DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);
     2381     5080    4                       CASE(%ERROR,%SELECT);
     2382     5081    4                          TH_CONSTRAINTS.NTYPES = 0;
     2383     5082    4                          TH_RECOV = %FALSE;
     2384     5083    4                      CASE(%MATCH);
     2385     5084    4                           TH_CONSTRAINTS.M_BY_B_SET = %NO;
     2386     5085    4                         TH_CONSTRAINTS.M_MAJ_S = %NO;
     2387     5086    4                         TH_CONSTRAINTS.M_SUB_S = %NO;
     2388     5087    4                         TH_CONSTRAINTS.M_MED_S = %NO;
     2389     5088    4                         TH_CONSTRAINTS.M_FEP_SET = %NO;
     2390     5089    4                         TH_CONSTRAINTS.M_CHAN_SET = %NO;
     2391     5090    4                TH_M_CHAN_TOTAL = 0;
     2392     5091    4                TH_LAST_MATCH.TEXT = ' ';
     2393     5092    4                TH_LAST_MATCH.COUNT = 0;
     2394     5093    4                      CASE(%EXCLUDE);
     2395     5094    4                           TH_CONSTRAINTS.E_BY_B_SET = %NO;
     2396     5095    4                         TH_CONSTRAINTS.E_MAJ_S = %NO;
     2397     5096    4                         TH_CONSTRAINTS.E_SUB_S = %NO;
     2398     5097    4                         TH_CONSTRAINTS.E_MED_S = %NO;
     2399     5098    4                         TH_CONSTRAINTS.E_FEP_SET = %NO;
     2400     5099    4                         TH_CONSTRAINTS.E_CHAN_SET = %NO;
     2401     5100    4                TH_LAST_EXCLUDE.TEXT = ' ';
     2402     5101    4                TH_LAST_EXCLUDE.COUNT = 0;
     2403     5102    4                       CASE(%OCTAL);
     2404     5103    4                          TH_CONSTRAINTS.OCTAL = %NO;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:299  
     2405     5104    4                       CASE(%CROSS);
     2406     5105    4                          TH_CONSTRAINTS.CROSS = %NO;
     2407     5106    4                       CASE(%SPAN);
     2408     5107    4                          TH_CONSTRAINTS.START = TH_DEFAULT.START;
     2409     5108    4                          TH_CONSTRAINTS.STOP = TH_DEFAULT.STOP;
     2410     5109    4          CASE(%USE);
     2411     5110    4            VLP_SYSTAC.ACCT# = ':SYSTAC';
     2412     5111    4            TH_CHANGE_ACCOUNT = '1'B;
     2413     5112    4          CASE(%FILE);
     2414     5113    4            TH_OPEN_ERRLOG.ACCT_ = VECTOR(VLP_SYSTAC);
     2415     5114    4            TH_OPEN_ERRLOG.NAME_ = VECTOR(TH_VLP_ERRLOG);
     2416     5115    4            TH_CHANGE_ACCOUNT = '1'B;
     2417     5116    4            TH_CONSTRAINTS.START = TH_DEFAULT.START;
     2418     5117    4            TH_CONSTRAINTS.STOP = TH_DEFAULT.STOP;
     2419     5118    4                    END;                   /* CASE OUT$BLK.CODE                  */
     2420     5119    3                 END;                      /* DO I = 0 TO OUT$BLK.NSUBLKS - 1    */
     2421     5120    2        END;                               /* CASE OUT$BLK.CODE                  */
     2422     5121    1   END THC$SELECT;
     2423     5122        %EOD;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:300  
--  Include file information  --

   EL_SUBS_C.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$SELECT.

   Procedure THC$SELECT requires 2132 words for executable code.
   Procedure THC$SELECT requires 70 words of local(AUTO) storage.

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:301  

 Object Unit name= THC$SELECT                                 File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:11:04.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     4      4  THC$SELECT
    2  RoData even  UTS     12     14  THC$SELECT
    3   Proc  even  none  2132   4124  THC$SELECT
    4  RoData even  none    41     51  THC$SELECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  THC$SELECT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 THM$ERRMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_INDEX
                       nStd      0 X66_ARET
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:302  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_DEFAULT
     TH_LAST_MATCH                         TH_LAST_EXCLUDE                       TH_RECOV
     TH_XSA_BUF_VECTOR                     VLP_SYSTAC                            TH_CHANGE_ACCOUNT
     TH_M_CHAN                             TH_M_CHAN_TOTAL                       P_PCB
     TH_OPEN_ERRLOG                        TH_VLP_ERRLOG                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:303  


     1483        1        /*T***********************************************************/
     1484        2        /*T*                                                         */
     1485        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1486        4        /*T*                                                         */
     1487        5        /*T***********************************************************/
     1488        6        THC$SELECT: PROC(TOP$) ALTRET;

      6  3 000000   000000 700200 xent  THC$SELECT   TSX0  ! X66_AUTO_1
         3 000001   000106 000001                    ZERO    70,1

     1489        7        /**/
     1490        8        /* PARAMS */
     1491        9    1   DCL TOP$ PTR;
     1492       10        /**/
     1493       11        /* INCLUDE FILES */
     1494       12        %INCLUDE CP_6;
     1495       93        %INCLUDE XU_MACRO_C;
     1496     3199        %INCLUDE TH_SUBS_C;
     1497     3581        %INCLUDE TH_DATA_R;
     1498     3659        %INCLUDE TH_PERR_C;
     1499     3700        %INCLUDE EL_SUBS_C;
     1500     3784        /**/
     1501     3785        /* ENTRY DEFS */
     1502     3786    1   DCL THM$ERRMSG ENTRY(1);
     1503     3787        /**/
     1504     3788        /* VARIABLES */
     1505     3789    1   DCL I SBIN;
     1506     3790    1   DCL J SBIN;
     1507     3791    1   DCL K SBIN;
     1508     3792    1   DCL SAVE_INDEX SBIN;
     1509     3793    1   DCL TEMP1 UBIN;
     1510     3794    1   DCL TEMP2 UBIN;
     1511     3795    1   DCL RECOV_TYPES (0:3) UBIN STATIC INIT(EL_SCREECH,EL_SUA,EL_SNAP,0);
     1512     3796    1   DCL TEXTBASE CHAR(P_PCB.NCHARS) BASED(P_PCB.TEXT$);
     1513     3797    1   DCL FOUND BIT(1);
     1514     3798    1   DCL BIT_SPEC BIT(1);
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:304  
     1515     3799    1   DCL BYTE_SPEC UBIN;
     1516     3800    1   DCL FIRST_BIT UBIN;
     1517     3801    1   DCL LAST_BIT UBIN;
     1518     3802    1   DCL INDX UBIN;
     1519     3803    1   DCL VALUE UBIN;
     1520     3804    1   DCL TEMP$ PTR;
     1521     3805    1   DCL MATCH_DEL BIT(1);
     1522     3806    1   DCL EXCLUDE_DEL BIT(1);
     1523     3807    1   DCL MAJOR UBIN(6) UNAL;
     1524     3808    1   DCL SUB CHAR(3);
     1525     3809    1   DCL SUBB(0:2) REDEF SUB CHAR(1);
     1526     3810    1   DCL SUB_BIN UBIN;
     1527     3811    1   DCL 1 SUB_BIT,
     1528     3812    1         2 ONE BIT(3),
     1529     3813    1         2 TWO BIT(3);
     1530     3814    1   DCL SUBB_BIT REDEF SUB_BIT BIT(6);
     1531     3815    1   DCL FI_ERR UBIN(9) UNAL;
     1532     3816    1   DCL MEDIA CHAR(6);
     1533     3817    1   DCL TEMP CHAR(8);
     1534     3818    1   DCL TEMPP(0:7) REDEF TEMP CHAR(1);
     1535     3819    1   DCL FEP_CODE CHAR(3);
     1536     3820    1   DCL FEP_CHAN CHAR(4);
     1537     3821    1   DCL FEP_CHAN_N CHAR(4);
     1538     3822    1   DCL MATCH_ADD BIT(1);
     1539     3823    1   DCL EXCLUDE_ADD BIT(1);
     1540     3824    1   DCL DEL_TEST CHAR(3);
     1541     3825    1   DCL JJ UBIN;
     1542     3826    1   DCL JCNT UBIN;
     1543     3827    1   DCL C_TEST CHAR(119) ;
     1544     3828        /**/
     1545     3829        /* MACRO INVOCATIONS */
     1546     3830        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     1547     3875        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED");
     1548     3913        %P$PCB (NAME=P_PCB,STCLASS=SYMREF);
     1549     4114        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
     1550     4115                   STCLASS=SYMREF);
     1551     4224        %VLP_NAME (FPTN=TH_VLP_ERRLOG,
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:305  
     1552     4225                   STCLASS=SYMREF,
     1553     4226                   LEN=15);
     1554     4253        /**/
     1555     4254        %EJECT;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:306  
     1556     4255    2        DO CASE(OUT$BLK.CODE);

   4255  3 000002   200003 470500                    LDP0    @TOP$,,AUTO
         3 000003   000000 471500                    LDP1    0,,PR0
         3 000004   100000 720100                    LXL0    0,,PR1
         3 000005   000011 100003                    CMPX0   9,DU
         3 000006   000010 602010 3                  TNC     s:4255+6,X0
         3 000007   004123 710000 3                  TRA     s:5121
         3 000010   004123 710000 3                  TRA     s:5121
         3 000011   000021 710000 3                  TRA     s:4257
         3 000012   000144 710000 3                  TRA     s:4291
         3 000013   002114 710000 3                  TRA     s:4687
         3 000014   003726 710000 3                  TRA     s:5061
         3 000015   003731 710000 3                  TRA     s:5063
         3 000016   003734 710000 3                  TRA     s:5065
         3 000017   004123 710000 3                  TRA     s:5121
         3 000020   000021 710000 3                  TRA     s:4257

     1557     4256    2           CASE(%ERROR,%SELECT);

     1558     4257    2              I = 0;

   4257  3 000021   200004 450100                    STZ     I,,AUTO

     1559     4258    3              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE ~= %PLUS THEN DO;

   4258  3 000022   100003 473500                    LDP3    3,,PR1
         3 000023   300000 721100                    LXL1    0,,PR3
         3 000024   000142 101003                    CMPX1   98,DU
         3 000025   000031 600000 3                  TZE     s:4262

     1560     4259    3                 TH_CONSTRAINTS.NTYPES = 0;

   4259  3 000026   000000 450000 xsym               STZ     TH_CONSTRAINTS

     1561     4260    3                 TH_RECOV = %FALSE;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:307  
   4260  3 000027   000000 450000 xsym               STZ     TH_RECOV

     1562     4261    3                 END;  /* IF */

   4261  3 000030   000033 710000 3                  TRA     s:4263

     1563     4262    2                 ELSE I = 1;

   4262  3 000031   000001 235007                    LDA     1,DL
         3 000032   200004 755100                    STA     I,,AUTO

     1564     4263    3              DO I = I TO OUT$BLK.NSUBLKS - 1;

   4263  3 000033   000135 710000 3                  TRA     s:4288+1

     1565     4264    3                 IF OUT$BLK.SUBLK$(I)->OUT$BLK.CODE=0

   4264  3 000034   200003 470500                    LDP0    @TOP$,,AUTO
         3 000035   000000 471500                    LDP1    0,,PR0
         3 000036   200004 720100                    LXL0    I,,AUTO
         3 000037   100003 473510                    LDP3    3,X0,PR1
         3 000040   300000 721100                    LXL1    0,,PR3
         3 000041   000053 601000 3                  TNZ     s:4266

     1566     4265    3                    THEN CALL CHARBIN(VALUE,OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT);

   4265  3 000042   300004 236100                    LDQ     4,,PR3
         3 000043   000033 772000                    QRL     27
         3 000044   000000 622006                    EAX2    0,QL
         3 000045   000100 305540                    DTB
         3 000046   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         3 000047   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 000050   200105 235100                    LDA     C_TEST+32,,AUTO
         3 000051   200020 755100                    STA     VALUE,,AUTO
         3 000052   000056 710000 3                  TRA     s:4267

     1567     4266    3                    ELSE VALUE = OUT$BLK.SUBLK$(I)->OUT$BLK.CODE;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:308  

   4266  3 000053   300000 236100                    LDQ     0,,PR3
         3 000054   777777 376007                    ANQ     -1,DL
         3 000055   200020 756100                    STQ     VALUE,,AUTO

     1568     4267    3                 RECOV_TYPES(3) = VALUE;

   4267  3 000056   200020 235100                    LDA     VALUE,,AUTO
         3 000057   000003 755000 1                  STA     RECOV_TYPES+3

     1569     4268    3                 TEMP1 = 3;

   4268  3 000060   000003 236007                    LDQ     3,DL
         3 000061   200010 756100                    STQ     TEMP1,,AUTO

     1570     4269    3                 TEMP2 = 3;

   4269  3 000062   200011 756100                    STQ     TEMP2,,AUTO

     1571     4270    4                 IF VALUE = %TH_RECOV THEN DO;

   4270  3 000063   000143 115007                    CMPA    99,DL
         3 000064   000072 601000 3                  TNZ     s:4275

     1572     4271    4                    TH_RECOV = %TRUE;

   4271  3 000065   400000 236003                    LDQ     -131072,DU
         3 000066   000000 756000 xsym               STQ     TH_RECOV

     1573     4272    4                    TEMP1 = 0;

   4272  3 000067   200010 450100                    STZ     TEMP1,,AUTO

     1574     4273    4                    TEMP2 = 2;

   4273  3 000070   000002 235007                    LDA     2,DL
         3 000071   200011 755100                    STA     TEMP2,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:309  

     1575     4274    4                    END;

     1576     4275    3          FOUND = '0'B;

   4275  3 000072   200012 450100                    STZ     FOUND,,AUTO

     1577     4276    4                 DO K = TEMP1 TO TEMP2;

   4276  3 000073   200010 235100                    LDA     TEMP1,,AUTO
         3 000074   200006 755100                    STA     K,,AUTO
         3 000075   000130 710000 3                  TRA     s:4287+1

     1578     4277    4                    VALUE = RECOV_TYPES(K);

   4277  3 000076   200006 720100                    LXL0    K,,AUTO
         3 000077   000000 235010 1                  LDA     RECOV_TYPES,X0
         3 000100   200020 755100                    STA     VALUE,,AUTO

     1579     4278    5                    DO J = 0 TO TH_CONSTRAINTS.NTYPES - 1;

   4278  3 000101   200005 450100                    STZ     J,,AUTO
         3 000102   000115 710000 3                  TRA     s:4281+1

     1580     4279    5                       IF TH_CONSTRAINTS.TYPES(J) = VALUE

   4279  3 000103   200005 235100                    LDA     J,,AUTO
         3 000104   000100 101405                    MRL     fill='000'O
         3 000105   000001 000001 xsym               ADSC9   TH_CONSTRAINTS+1,A       cn=0,n=1
         3 000106   200104 000004                    ADSC9   C_TEST+31,,AUTO          cn=0,n=4
         3 000107   200104 236100                    LDQ     C_TEST+31,,AUTO
         3 000110   200020 116100                    CMPQ    VALUE,,AUTO
         3 000111   000114 601000 3                  TNZ     s:4281

     1581     4280    5                          THEN FOUND = '1'B;

   4280  3 000112   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:310  
         3 000113   200012 756100                    STQ     FOUND,,AUTO

     1582     4281    5                    END;                      /* DO J = 1 TO NTYPES                 */

   4281  3 000114   200005 054100                    AOS     J,,AUTO
         3 000115   200005 236100                    LDQ     J,,AUTO
         3 000116   000000 116000 xsym               CMPQ    TH_CONSTRAINTS
         3 000117   000103 604000 3                  TMI     s:4279

     1583     4282    4                    IF NOT FOUND

   4282  3 000120   200012 234100                    SZN     FOUND,,AUTO
         3 000121   000127 604000 3                  TMI     s:4287

     1584     4283    5                       THEN DO;

     1585     4284    5                         TH_CONSTRAINTS.TYPES(TH_CONSTRAINTS.NTYPES) = VALUE;

   4284  3 000122   000000 235000 xsym               LDA     TH_CONSTRAINTS
         3 000123   000005 101500                    MRL     fill='000'O
         3 000124   200020 000004                    ADSC9   VALUE,,AUTO              cn=0,n=4
         3 000125   000001 000001 xsym               ADSC9   TH_CONSTRAINTS+1,A       cn=0,n=1

     1586     4285    5                         TH_CONSTRAINTS.NTYPES = TH_CONSTRAINTS.NTYPES + 1;

   4285  3 000126   000000 054000 xsym               AOS     TH_CONSTRAINTS

     1587     4286    5                       END;                   /* IF NOT FOUND                       */

     1588     4287    4                    END;  /* DO K */

   4287  3 000127   200006 054100                    AOS     K,,AUTO
         3 000130   200011 236100                    LDQ     TEMP2,,AUTO
         3 000131   000076 604000 3                  TMI     s:4277
         3 000132   200006 116100                    CMPQ    K,,AUTO
         3 000133   000076 605000 3                  TPL     s:4277

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:311  
     1589     4288    3              END;                         /* DO I = 0 TO OUT$BLK.NSUBLKS-1      */

   4288  3 000134   200004 054100                    AOS     I,,AUTO
         3 000135   200003 470500                    LDP0    @TOP$,,AUTO
         3 000136   000000 471500                    LDP1    0,,PR0
         3 000137   100001 236100                    LDQ     1,,PR1
         3 000140   000022 772000                    QRL     18
         3 000141   200004 116100                    CMPQ    I,,AUTO
         3 000142   000034 605400 3                  TPNZ    s:4264
         3 000143   004123 710000 3                  TRA     s:5121

     1590     4289    2            CASE (%MATCH);

     1591     4290                                               /* PROCESS MATCH COMMAND           */
     1592     4291    2              MATCH_DEL = %NO;

   4291  3 000144   200022 450100                    STZ     MATCH_DEL,,AUTO

     1593     4292    2            MATCH_ADD = %NO;

   4292  3 000145   200040 450100                    STZ     MATCH_ADD,,AUTO

     1594     4293    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %DELETEE

   4293  3 000146   100003 473500                    LDP3    3,,PR1
         3 000147   300000 721100                    LXL1    0,,PR3
         3 000150   000026 101003                    CMPX1   22,DU
         3 000151   000157 601000 3                  TNZ     s:4299

     1595     4294    3                 THEN DO;

     1596     4295    3                      MATCH_DEL = %YES;

   4295  3 000152   400000 236003                    LDQ     -131072,DU
         3 000153   200022 756100                    STQ     MATCH_DEL,,AUTO

     1597     4296    3                      J = 1;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:312  

   4296  3 000154   000001 235007                    LDA     1,DL
         3 000155   200005 755100                    STA     J,,AUTO

     1598     4297    3                      END;

   4297  3 000156   000211 710000 3                  TRA     s:4316

     1599     4298    2                 ELSE
     1600     4299    2                      IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %ADDD

   4299  3 000157   000013 101003                    CMPX1   11,DU
         3 000160   000166 601000 3                  TNZ     s:4305

     1601     4300    3                           THEN DO;

     1602     4301    3                                J = 1;

   4301  3 000161   000001 235007                    LDA     1,DL
         3 000162   200005 755100                    STA     J,,AUTO

     1603     4302    3                                MATCH_ADD = %YES;

   4302  3 000163   400000 236003                    LDQ     -131072,DU
         3 000164   200040 756100                    STQ     MATCH_ADD,,AUTO

     1604     4303    3                                END;

   4303  3 000165   000211 710000 3                  TRA     s:4316

     1605     4304    3                           ELSE DO;

     1606     4305    3                                J = 0;

   4305  3 000166   200005 450100                    STZ     J,,AUTO

     1607     4306    3                                TH_CONSTRAINTS.M_BY_B_SET = %NO;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:313  

   4306  3 000167   003000 060400                    CSL     bolr='003'O
         3 000170   000002 000011 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=9
         3 000171   000026 010440 xsym               BDSC    TH_CONSTRAINTS+22        by=0,bit=1,n=288

     1608     4307    3                                TH_CONSTRAINTS.M_MAJ_S = %NO;

   4307  3 000172   000000 236000 4                  LDQ     0
         3 000173   000014 356000 xsym               ANSQ    TH_CONSTRAINTS+12

     1609     4308    3                                TH_CONSTRAINTS.M_SUB_S = %NO;

   4308  3 000174   000001 236000 4                  LDQ     1
         3 000175   000014 356000 xsym               ANSQ    TH_CONSTRAINTS+12

     1610     4309    3                                TH_CONSTRAINTS.M_MED_S = %NO;

   4309  3 000176   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 000177   000016 356000 xsym               ANSQ    TH_CONSTRAINTS+14

     1611     4310    3                                TH_CONSTRAINTS.M_FEP_SET = %NO;

   4310  3 000200   000061 356000 xsym               ANSQ    TH_CONSTRAINTS+49

     1612     4311    3                                TH_CONSTRAINTS.M_CHAN_SET = %NO;

   4311  3 000201   000002 236000 4                  LDQ     2
         3 000202   000062 356000 xsym               ANSQ    TH_CONSTRAINTS+50

     1613     4312    3                                TH_CONSTRAINTS.M_COD_SET = %NO;

   4312  3 000203   000003 236000 4                  LDQ     3
         3 000204   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53

     1614     4313    3                                TH_CONSTRAINTS.M_REA_SET = %NO;

   4313  3 000205   000004 236000 4                  LDQ     4
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:314  
         3 000206   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53

     1615     4314    3                                TH_CONSTRAINTS.M_ACT_SET = %NO;

   4314  3 000207   000005 236000 4                  LDQ     5
         3 000210   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53

     1616     4315    3                                END;

     1617     4316    3              DO I = J TO OUT$BLK.NSUBLKS - 1;

   4316  3 000211   200005 235100                    LDA     J,,AUTO
         3 000212   200004 755100                    STA     I,,AUTO
         3 000213   001754 710000 3                  TRA     s:4659+1

     1618     4317    3                 TEMP$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);

   4317  3 000214   200003 470500                    LDP0    @TOP$,,AUTO
         3 000215   000000 471500                    LDP1    0,,PR0
         3 000216   200004 720100                    LXL0    I,,AUTO
         3 000217   100003 473510                    LDP3    3,X0,PR1
         3 000220   300003 236100                    LDQ     3,,PR3
         3 000221   200021 756100                    STQ     TEMP$,,AUTO

     1619     4318    4                 DO CASE(TEMP$->OUT$BLK.CODE);

   4318  3 000222   200021 474500                    LDP4    TEMP$,,AUTO
         3 000223   400000 721100                    LXL1    0,,PR4
         3 000224   000012 101003                    CMPX1   10,DU
         3 000225   000227 602011 3                  TNC     s:4318+5,X1
         3 000226   001565 710000 3                  TRA     s:4614
         3 000227   001565 710000 3                  TRA     s:4614
         3 000230   000241 710000 3                  TRA     s:4320
         3 000231   000345 710000 3                  TRA     s:4348
         3 000232   000763 710000 3                  TRA     s:4440
         3 000233   001032 710000 3                  TRA     s:4455
         3 000234   001275 710000 3                  TRA     s:4527
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:315  
         3 000235   001352 710000 3                  TRA     s:4545
         3 000236   000471 710000 3                  TRA     s:4377
         3 000237   000575 710000 3                  TRA     s:4400
         3 000240   000701 710000 3                  TRA     s:4423

     1620     4319    4                    CASE(%MAJ);

     1621     4320    4                      IF TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 2

   4320  3 000241   400003 475500                    LDP5    3,,PR4
         3 000242   500004 236100                    LDQ     4,,PR5
         3 000243   777000 376003                    ANQ     -512,DU
         3 000244   002000 116003                    CMPQ    1024,DU
         3 000245   000273 601000 3                  TNZ     s:4330

     1622     4321    5                        THEN DO;

     1623     4322    5                           SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4322  3 000246   500004 236100                    LDQ     4,,PR5
         3 000247   000033 772000                    QRL     27
         3 000250   000000 622006                    EAX2    0,QL
         3 000251   040100 100540                    MLR     fill='040'O
         3 000252   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 000253   200025 000003                    ADSC9   SUB,,AUTO                cn=0,n=3

     1624     4323    5                           CALL CHARBIN(SUB_BIN,SUBB(0));

   4323  3 000254   000100 305500                    DTB
         3 000255   200025 030001                    NDSC9   SUB,,AUTO                cn=0,s=nosgn,sf=0,n=1
         3 000256   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     1625     4324    5                           VALUE = SUB_BIN * 8;

   4324  3 000257   200026 235100                    LDA     SUB_BIN,,AUTO
         3 000260   000003 735000                    ALS     3
         3 000261   200020 755100                    STA     VALUE,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:316  

     1626     4325    5                           CALL CHARBIN(SUB_BIN,SUBB(1));

   4325  3 000262   000100 305500                    DTB
         3 000263   200025 230001                    NDSC9   SUB,,AUTO                cn=1,s=nosgn,sf=0,n=1
         3 000264   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     1627     4326    5                           VALUE = VALUE + SUB_BIN;

   4326  3 000265   200020 236100                    LDQ     VALUE,,AUTO
         3 000266   200026 036100                    ADLQ    SUB_BIN,,AUTO
         3 000267   200020 756100                    STQ     VALUE,,AUTO

     1628     4327    5                           MAJOR = VALUE;

   4327  3 000270   000036 736000                    QLS     30
         3 000271   200024 756100                    STQ     MAJOR,,AUTO

     1629     4328    5                           END;

   4328  3 000272   000305 710000 3                  TRA     s:4334

     1630     4329    5                        ELSE DO;

     1631     4330    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)

   4330  3 000273   500004 236100                    LDQ     4,,PR5
         3 000274   000033 772000                    QRL     27
         3 000275   000000 622006                    EAX2    0,QL
         3 000276   000100 305540                    DTB
         3 000277   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 000300   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 000301   200105 235100                    LDA     C_TEST+32,,AUTO
         3 000302   200020 755100                    STA     VALUE,,AUTO

     1632     4331    5                                        ->OUT$SYM.TEXT);
     1633     4332    5                           MAJOR = VALUE;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:317  

   4332  3 000303   000036 735000                    ALS     30
         3 000304   200024 755100                    STA     MAJOR,,AUTO

     1634     4333    5                           END;

     1635     4334    4                      IF MATCH_DEL

   4334  3 000305   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 000306   000334 605000 3                  TPL     s:4343

     1636     4335    4                        THEN
     1637     4336    4                          IF ((TH_CONSTRAINTS.M_MAJ_S) & (MAJOR=TH_CONSTRAINTS.M_MAJ))

   4336  3 000307   400000 221003                    LDX1    -131072,DU
         3 000310   200024 236100                    LDQ     MAJOR,,AUTO
         3 000311   000014 676000 xsym               ERQ     TH_CONSTRAINTS+12
         3 000312   770000 376003                    ANQ     -4096,DU
         3 000313   000315 600000 3                  TZE     s:4336+6
         3 000314   000000 221003                    LDX1    0,DU
         3 000315   000014 236000 xsym               LDQ     TH_CONSTRAINTS+12
         3 000316   000006 736000                    QLS     6
         3 000317   400000 376003                    ANQ     -131072,DU
         3 000320   200104 756100                    STQ     C_TEST+31,,AUTO
         3 000321   000000 636011                    EAQ     0,X1
         3 000322   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 000323   000327 600000 3                  TZE     s:4339

     1638     4337    4                             THEN TH_CONSTRAINTS.M_MAJ_S = %NO;

   4337  3 000324   000000 236000 4                  LDQ     0
         3 000325   000014 356000 xsym               ANSQ    TH_CONSTRAINTS+12
         3 000326   000340 710000 3                  TRA     s:4346

     1639     4338    5                             ELSE DO;

     1640     4339    5                                  CALL THM$ERRMSG(%E$TH_BAD_MAJ);
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:318  

   4339  3 000327   000007 630400 4                  EPPR0   7
         3 000330   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000331   000000 701000 xent               TSX1    THM$ERRMSG
         3 000332   000000 011000                    NOP     0

     1641     4340    5                                  ALTRETURN;

   4340  3 000333   000000 702200 xent               TSX2  ! X66_AALT

     1642     4341    5                                  END;
     1643     4342    5                        ELSE DO;

     1644     4343    5                             TH_CONSTRAINTS.M_MAJ_S = %YES;

   4343  3 000334   004000 236003                    LDQ     2048,DU
         3 000335   000014 256000 xsym               ORSQ    TH_CONSTRAINTS+12

     1645     4344    5                             TH_CONSTRAINTS.M_MAJ = MAJOR;

   4344  3 000336   200024 236100                    LDQ     MAJOR,,AUTO
         3 000337   000014 752040 xsym               STCQ    TH_CONSTRAINTS+12,'40'O

     1646     4345    5                             END;

     1647     4346    4                      DEL_TEST = 'MAJ';

   4346  3 000340   000000 236000 2                  LDQ     0
         3 000341   000010 376000 4                  ANQ     8
         3 000342   000040 276007                    ORQ     32,DL
         3 000343   200042 756100                    STQ     DEL_TEST,,AUTO
         3 000344   001565 710000 3                  TRA     s:4614

     1648     4347    4                    CASE(%SUB);

     1649     4348    4                     IF TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 2

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:319  
   4348  3 000345   400003 475500                    LDP5    3,,PR4
         3 000346   500004 236100                    LDQ     4,,PR5
         3 000347   777000 376003                    ANQ     -512,DU
         3 000350   002000 116003                    CMPQ    1024,DU
         3 000351   000402 601000 3                  TNZ     s:4357

     1650     4349    5                      THEN DO;

     1651     4350    5                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4350  3 000352   500004 236100                    LDQ     4,,PR5
         3 000353   000033 772000                    QRL     27
         3 000354   000000 622006                    EAX2    0,QL
         3 000355   040100 100540                    MLR     fill='040'O
         3 000356   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 000357   200025 000003                    ADSC9   SUB,,AUTO                cn=0,n=3

     1652     4351    5                      CALL CHARBIN(SUB_BIN,SUBB(0));

   4351  3 000360   000100 305500                    DTB
         3 000361   200025 030001                    NDSC9   SUB,,AUTO                cn=0,s=nosgn,sf=0,n=1
         3 000362   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     1653     4352    5                      SUB_BIT.ONE = BINBIT(SUB_BIN,3);

   4352  3 000363   200026 236100                    LDQ     SUB_BIN,,AUTO
         3 000364   000041 736000                    QLS     33
         3 000365   200027 676100                    ERQ     SUB_BIT,,AUTO
         3 000366   700000 376003                    ANQ     -32768,DU
         3 000367   200027 656100                    ERSQ    SUB_BIT,,AUTO

     1654     4353    5                      CALL CHARBIN(SUB_BIN,SUBB(1));

   4353  3 000370   000100 305500                    DTB
         3 000371   200025 230001                    NDSC9   SUB,,AUTO                cn=1,s=nosgn,sf=0,n=1
         3 000372   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:320  
     1655     4354    5                      SUB_BIT.TWO = BINBIT(SUB_BIN,3);

   4354  3 000373   200026 236100                    LDQ     SUB_BIN,,AUTO
         3 000374   000041 736000                    QLS     33
         3 000375   000003 772000                    QRL     3
         3 000376   200027 676100                    ERQ     SUB_BIT,,AUTO
         3 000377   070000 376003                    ANQ     28672,DU
         3 000400   200027 656100                    ERSQ    SUB_BIT,,AUTO

     1656     4355    5                      END;

   4355  3 000401   000426 710000 3                  TRA     s:4363

     1657     4356    5                      ELSE DO;

     1658     4357    5                           SUB_BIN = 0;

   4357  3 000402   200026 450100                    STZ     SUB_BIN,,AUTO

     1659     4358    5                           SUB_BIT.ONE = BINBIT(SUB_BIN,3);

   4358  3 000403   200026 236100                    LDQ     SUB_BIN,,AUTO
         3 000404   000041 736000                    QLS     33
         3 000405   200027 676100                    ERQ     SUB_BIT,,AUTO
         3 000406   700000 376003                    ANQ     -32768,DU
         3 000407   200027 656100                    ERSQ    SUB_BIT,,AUTO

     1660     4359    5                           CALL CHARBIN(SUB_BIN,TEMP$->OUT$BLK.SUBLK$(0)

   4359  3 000410   500004 236100                    LDQ     4,,PR5
         3 000411   000033 772000                    QRL     27
         3 000412   000000 622006                    EAX2    0,QL
         3 000413   000100 305540                    DTB
         3 000414   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 000415   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 000416   200105 235100                    LDA     C_TEST+32,,AUTO
         3 000417   200026 755100                    STA     SUB_BIN,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:321  

     1661     4360    5                                        ->OUT$SYM.TEXT);
     1662     4361    5                           SUB_BIT.TWO = BINBIT(SUB_BIN,3);

   4361  3 000420   200026 236100                    LDQ     SUB_BIN,,AUTO
         3 000421   000041 736000                    QLS     33
         3 000422   000003 772000                    QRL     3
         3 000423   200027 676100                    ERQ     SUB_BIT,,AUTO
         3 000424   070000 376003                    ANQ     28672,DU
         3 000425   200027 656100                    ERSQ    SUB_BIT,,AUTO

     1663     4362    5                           END;

     1664     4363    4                      IF MATCH_DEL

   4363  3 000426   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 000427   000455 605000 3                  TPL     s:4372

     1665     4364    4                        THEN
     1666     4365    4                          IF ((TH_CONSTRAINTS.M_SUB_S)&(SUBB_BIT=TH_CONSTRAINTS.M_SUB)
              4365                                    )

   4365  3 000430   400000 221003                    LDX1    -131072,DU
         3 000431   000000 066500                    CMPB    filb='0'B
         3 000432   200027 000006                    BDSC    SUB_BIT,,AUTO            by=0,bit=0,n=6
         3 000433   000014 070006 xsym               BDSC    TH_CONSTRAINTS+12        by=0,bit=7,n=6
         3 000434   000436 600000 3                  TZE     s:4365+6
         3 000435   000000 221003                    LDX1    0,DU
         3 000436   000014 236000 xsym               LDQ     TH_CONSTRAINTS+12
         3 000437   000015 736000                    QLS     13
         3 000440   400000 376003                    ANQ     -131072,DU
         3 000441   200104 756100                    STQ     C_TEST+31,,AUTO
         3 000442   000000 636011                    EAQ     0,X1
         3 000443   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 000444   000450 600000 3                  TZE     s:4368

     1667     4366    4                             THEN TH_CONSTRAINTS.M_SUB_S = %NO;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:322  

   4366  3 000445   000001 236000 4                  LDQ     1
         3 000446   000014 356000 xsym               ANSQ    TH_CONSTRAINTS+12
         3 000447   000464 710000 3                  TRA     s:4375

     1668     4367    5                             ELSE DO;

     1669     4368    5                                  CALL THM$ERRMSG(%E$TH_BAD_SUB);

   4368  3 000450   000012 630400 4                  EPPR0   10
         3 000451   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000452   000000 701000 xent               TSX1    THM$ERRMSG
         3 000453   000000 011000                    NOP     0

     1670     4369    5                                  ALTRETURN;

   4369  3 000454   000000 702200 xent               TSX2  ! X66_AALT

     1671     4370    5                                  END;
     1672     4371    5                        ELSE DO;

     1673     4372    5                           TH_CONSTRAINTS.M_SUB_S = %YES;

   4372  3 000455   000020 236003                    LDQ     16,DU
         3 000456   000014 256000 xsym               ORSQ    TH_CONSTRAINTS+12

     1674     4373    5                           TH_CONSTRAINTS.M_SUB = SUBB_BIT;

   4373  3 000457   200027 236100                    LDQ     SUB_BIT,,AUTO
         3 000460   000007 772000                    QRL     7
         3 000461   000014 676000 xsym               ERQ     TH_CONSTRAINTS+12
         3 000462   003740 376003                    ANQ     2016,DU
         3 000463   000014 656000 xsym               ERSQ    TH_CONSTRAINTS+12

     1675     4374    5                           END;

     1676     4375    4                      DEL_TEST = 'SUB';
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:323  

   4375  3 000464   000001 236000 2                  LDQ     1
         3 000465   000010 376000 4                  ANQ     8
         3 000466   000040 276007                    ORQ     32,DL
         3 000467   200042 756100                    STQ     DEL_TEST,,AUTO
         3 000470   001565 710000 3                  TRA     s:4614

     1677     4376    4                    CASE(%COD);

     1678     4377    4                      VALUE = 0;

   4377  3 000471   200020 450100                    STZ     VALUE,,AUTO

     1679     4378    4                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4378  3 000472   400003 475500                    LDP5    3,,PR4
         3 000473   500004 236100                    LDQ     4,,PR5
         3 000474   000033 772000                    QRL     27
         3 000475   000000 622006                    EAX2    0,QL
         3 000476   040100 100540                    MLR     fill='040'O
         3 000477   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 000500   200025 000003                    ADSC9   SUB,,AUTO                cn=0,n=3

     1680     4379    5                      DO K = 0 TO TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;

   4379  3 000501   200006 450100                    STZ     K,,AUTO
         3 000502   000515 710000 3                  TRA     s:4383+1

     1681     4380    5                         VALUE = VALUE * 10;

   4380  3 000503   200020 236100                    LDQ     VALUE,,AUTO
         3 000504   000012 402007                    MPY     10,DL
         3 000505   200020 756100                    STQ     VALUE,,AUTO

     1682     4381    5                         CALL CHARBIN(SUB_BIN,SUBB(K));

   4381  3 000506   200006 235100                    LDA     K,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:324  
         3 000507   000100 305505                    DTB
         3 000510   200025 030001                    NDSC9   SUB,A,AUTO               cn=0,s=nosgn,sf=0,n=1
         3 000511   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     1683     4382    5                         VALUE = VALUE + SUB_BIN;

   4382  3 000512   200026 036100                    ADLQ    SUB_BIN,,AUTO
         3 000513   200020 756100                    STQ     VALUE,,AUTO

     1684     4383    5                      END;

   4383  3 000514   200006 054100                    AOS     K,,AUTO
         3 000515   200021 470500                    LDP0    TEMP$,,AUTO
         3 000516   000003 471500                    LDP1    3,,PR0
         3 000517   100004 236100                    LDQ     4,,PR1
         3 000520   000033 772000                    QRL     27
         3 000521   200006 116100                    CMPQ    K,,AUTO
         3 000522   000503 605400 3                  TPNZ    s:4380

     1685     4384    4                      FI_ERR = VALUE;

   4384  3 000523   200020 235100                    LDA     VALUE,,AUTO
         3 000524   000033 735000                    ALS     27
         3 000525   200030 755100                    STA     FI_ERR,,AUTO

     1686     4385    4                      IF MATCH_DEL

   4385  3 000526   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 000527   000561 605000 3                  TPL     s:4395

     1687     4386    4                         THEN
     1688     4387    4                           IF ((TH_CONSTRAINTS.M_COD_SET) &

   4387  3 000530   400000 220003                    LDX0    -131072,DU
         3 000531   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         3 000532   000032 772000                    QRL     26
         3 000533   000777 376007                    ANQ     511,DL
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:325  
         3 000534   200104 756100                    STQ     C_TEST+31,,AUTO
         3 000535   200030 236100                    LDQ     FI_ERR,,AUTO
         3 000536   000033 772000                    QRL     27
         3 000537   200104 116100                    CMPQ    C_TEST+31,,AUTO
         3 000540   000542 600000 3                  TZE     s:4387+10
         3 000541   000000 220003                    LDX0    0,DU
         3 000542   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         3 000543   000012 736000                    QLS     10
         3 000544   400000 376003                    ANQ     -131072,DU
         3 000545   200105 756100                    STQ     C_TEST+32,,AUTO
         3 000546   000000 636010                    EAQ     0,X0
         3 000547   200105 376100                    ANQ     C_TEST+32,,AUTO
         3 000550   000554 600000 3                  TZE     s:4391

     1689     4388    4                               (FI_ERR = TH_CONSTRAINTS.M_COD))
     1690     4389    4                               THEN TH_CONSTRAINTS.M_COD_SET = %NO;

   4389  3 000551   000003 236000 4                  LDQ     3
         3 000552   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53
         3 000553   000570 710000 3                  TRA     s:4398

     1691     4390    5                               ELSE DO;

     1692     4391    5                                 CALL THM$ERRMSG(%E$TH_BAD_COD);

   4391  3 000554   000014 630400 4                  EPPR0   12
         3 000555   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000556   000000 701000 xent               TSX1    THM$ERRMSG
         3 000557   000000 011000                    NOP     0

     1693     4392    5                                 ALTRETURN;

   4392  3 000560   000000 702200 xent               TSX2  ! X66_AALT

     1694     4393    5                               END;
     1695     4394    5                         ELSE DO;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:326  
     1696     4395    5                           TH_CONSTRAINTS.M_COD_SET = %YES;

   4395  3 000561   000200 236003                    LDQ     128,DU
         3 000562   000065 256000 xsym               ORSQ    TH_CONSTRAINTS+53

     1697     4396    5                           TH_CONSTRAINTS.M_COD = FI_ERR;

   4396  3 000563   200030 236100                    LDQ     FI_ERR,,AUTO
         3 000564   000001 772000                    QRL     1
         3 000565   000065 676000 xsym               ERQ     TH_CONSTRAINTS+53
         3 000566   377400 376003                    ANQ     130816,DU
         3 000567   000065 656000 xsym               ERSQ    TH_CONSTRAINTS+53

     1698     4397    5                         END;

     1699     4398    4                         DEL_TEST = 'COD';

   4398  3 000570   000002 236000 2                  LDQ     2
         3 000571   000010 376000 4                  ANQ     8
         3 000572   000040 276007                    ORQ     32,DL
         3 000573   200042 756100                    STQ     DEL_TEST,,AUTO
         3 000574   001565 710000 3                  TRA     s:4614

     1700     4399    4                    CASE(%REA);

     1701     4400    4                      VALUE = 0;

   4400  3 000575   200020 450100                    STZ     VALUE,,AUTO

     1702     4401    4                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4401  3 000576   400003 475500                    LDP5    3,,PR4
         3 000577   500004 236100                    LDQ     4,,PR5
         3 000600   000033 772000                    QRL     27
         3 000601   000000 622006                    EAX2    0,QL
         3 000602   040100 100540                    MLR     fill='040'O
         3 000603   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:327  
         3 000604   200025 000003                    ADSC9   SUB,,AUTO                cn=0,n=3

     1703     4402    5                      DO K = 0 TO TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;

   4402  3 000605   200006 450100                    STZ     K,,AUTO
         3 000606   000621 710000 3                  TRA     s:4406+1

     1704     4403    5                         VALUE = VALUE * 10;

   4403  3 000607   200020 236100                    LDQ     VALUE,,AUTO
         3 000610   000012 402007                    MPY     10,DL
         3 000611   200020 756100                    STQ     VALUE,,AUTO

     1705     4404    5                         CALL CHARBIN(SUB_BIN,SUBB(K));

   4404  3 000612   200006 235100                    LDA     K,,AUTO
         3 000613   000100 305505                    DTB
         3 000614   200025 030001                    NDSC9   SUB,A,AUTO               cn=0,s=nosgn,sf=0,n=1
         3 000615   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     1706     4405    5                         VALUE = VALUE + SUB_BIN;

   4405  3 000616   200026 036100                    ADLQ    SUB_BIN,,AUTO
         3 000617   200020 756100                    STQ     VALUE,,AUTO

     1707     4406    5                      END;

   4406  3 000620   200006 054100                    AOS     K,,AUTO
         3 000621   200021 470500                    LDP0    TEMP$,,AUTO
         3 000622   000003 471500                    LDP1    3,,PR0
         3 000623   100004 236100                    LDQ     4,,PR1
         3 000624   000033 772000                    QRL     27
         3 000625   200006 116100                    CMPQ    K,,AUTO
         3 000626   000607 605400 3                  TPNZ    s:4403

     1708     4407    4                      FI_ERR = VALUE;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:328  
   4407  3 000627   200020 235100                    LDA     VALUE,,AUTO
         3 000630   000033 735000                    ALS     27
         3 000631   200030 755100                    STA     FI_ERR,,AUTO

     1709     4408    4                      IF MATCH_DEL

   4408  3 000632   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 000633   000665 605000 3                  TPL     s:4418

     1710     4409    4                         THEN
     1711     4410    4                           IF ((TH_CONSTRAINTS.M_REA_SET) &

   4410  3 000634   400000 220003                    LDX0    -131072,DU
         3 000635   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         3 000636   000020 772000                    QRL     16
         3 000637   000777 376007                    ANQ     511,DL
         3 000640   200104 756100                    STQ     C_TEST+31,,AUTO
         3 000641   200030 236100                    LDQ     FI_ERR,,AUTO
         3 000642   000033 772000                    QRL     27
         3 000643   200104 116100                    CMPQ    C_TEST+31,,AUTO
         3 000644   000646 600000 3                  TZE     s:4410+10
         3 000645   000000 220003                    LDX0    0,DU
         3 000646   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         3 000647   000024 736000                    QLS     20
         3 000650   400000 376003                    ANQ     -131072,DU
         3 000651   200105 756100                    STQ     C_TEST+32,,AUTO
         3 000652   000000 636010                    EAQ     0,X0
         3 000653   200105 376100                    ANQ     C_TEST+32,,AUTO
         3 000654   000660 600000 3                  TZE     s:4414

     1712     4411    4                               (FI_ERR = TH_CONSTRAINTS.M_REA))
     1713     4412    4                               THEN TH_CONSTRAINTS.M_REA_SET = %NO;

   4412  3 000655   000004 236000 4                  LDQ     4
         3 000656   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53
         3 000657   000674 710000 3                  TRA     s:4421

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:329  
     1714     4413    5                               ELSE DO;

     1715     4414    5                                 CALL THM$ERRMSG(%E$TH_BAD_REA);

   4414  3 000660   000016 630400 4                  EPPR0   14
         3 000661   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000662   000000 701000 xent               TSX1    THM$ERRMSG
         3 000663   000000 011000                    NOP     0

     1716     4415    5                                 ALTRETURN;

   4415  3 000664   000000 702200 xent               TSX2  ! X66_AALT

     1717     4416    5                               END;
     1718     4417    5                         ELSE DO;

     1719     4418    5                           TH_CONSTRAINTS.M_REA_SET = %YES;

   4418  3 000665   100000 236007                    LDQ     32768,DL
         3 000666   000065 256000 xsym               ORSQ    TH_CONSTRAINTS+53

     1720     4419    5                           TH_CONSTRAINTS.M_REA = FI_ERR;

   4419  3 000667   200030 236100                    LDQ     FI_ERR,,AUTO
         3 000670   000013 772000                    QRL     11
         3 000671   000065 676000 xsym               ERQ     TH_CONSTRAINTS+53
         3 000672   000017 376000 4                  ANQ     15
         3 000673   000065 656000 xsym               ERSQ    TH_CONSTRAINTS+53

     1721     4420    5                         END;

     1722     4421    4                         DEL_TEST = 'REA';

   4421  3 000674   000003 236000 2                  LDQ     3
         3 000675   000010 376000 4                  ANQ     8
         3 000676   000040 276007                    ORQ     32,DL
         3 000677   200042 756100                    STQ     DEL_TEST,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:330  
         3 000700   001565 710000 3                  TRA     s:4614

     1723     4422    4                    CASE(%ACT);

     1724     4423    4                      CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

   4423  3 000701   400003 475500                    LDP5    3,,PR4
         3 000702   500004 236100                    LDQ     4,,PR5
         3 000703   000033 772000                    QRL     27
         3 000704   000000 622006                    EAX2    0,QL
         3 000705   000100 305540                    DTB
         3 000706   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 000707   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 000710   200105 235100                    LDA     C_TEST+32,,AUTO
         3 000711   200020 755100                    STA     VALUE,,AUTO

     1725     4424    4                      FI_ERR = VALUE;

   4424  3 000712   000033 735000                    ALS     27
         3 000713   200030 755100                    STA     FI_ERR,,AUTO

     1726     4425    4                      IF MATCH_DEL

   4425  3 000714   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 000715   000747 605000 3                  TPL     s:4435

     1727     4426    4                         THEN
     1728     4427    4                           IF ((TH_CONSTRAINTS.M_ACT_SET) &

   4427  3 000716   400000 221003                    LDX1    -131072,DU
         3 000717   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         3 000720   000006 772000                    QRL     6
         3 000721   000777 376007                    ANQ     511,DL
         3 000722   200104 756100                    STQ     C_TEST+31,,AUTO
         3 000723   200030 236100                    LDQ     FI_ERR,,AUTO
         3 000724   000033 772000                    QRL     27
         3 000725   200104 116100                    CMPQ    C_TEST+31,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:331  
         3 000726   000730 600000 3                  TZE     s:4427+10
         3 000727   000000 221003                    LDX1    0,DU
         3 000730   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         3 000731   000036 736000                    QLS     30
         3 000732   400000 376003                    ANQ     -131072,DU
         3 000733   200105 756100                    STQ     C_TEST+32,,AUTO
         3 000734   000000 636011                    EAQ     0,X1
         3 000735   200105 376100                    ANQ     C_TEST+32,,AUTO
         3 000736   000742 600000 3                  TZE     s:4431

     1729     4428    4                               (FI_ERR = TH_CONSTRAINTS.M_ACT))
     1730     4429    4                               THEN TH_CONSTRAINTS.M_ACT_SET = %NO;

   4429  3 000737   000005 236000 4                  LDQ     5
         3 000740   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53
         3 000741   000756 710000 3                  TRA     s:4438

     1731     4430    5                               ELSE DO;

     1732     4431    5                                 CALL THM$ERRMSG(%E$TH_BAD_ACT);

   4431  3 000742   000021 630400 4                  EPPR0   17
         3 000743   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000744   000000 701000 xent               TSX1    THM$ERRMSG
         3 000745   000000 011000                    NOP     0

     1733     4432    5                                 ALTRETURN;

   4432  3 000746   000000 702200 xent               TSX2  ! X66_AALT

     1734     4433    5                               END;
     1735     4434    5                         ELSE DO;

     1736     4435    5                           TH_CONSTRAINTS.M_ACT_SET = %YES;

   4435  3 000747   000040 236007                    LDQ     32,DL
         3 000750   000065 256000 xsym               ORSQ    TH_CONSTRAINTS+53
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:332  

     1737     4436    5                           TH_CONSTRAINTS.M_ACT = FI_ERR;

   4436  3 000751   200030 236100                    LDQ     FI_ERR,,AUTO
         3 000752   000025 772000                    QRL     21
         3 000753   000065 676000 xsym               ERQ     TH_CONSTRAINTS+53
         3 000754   077700 376007                    ANQ     32704,DL
         3 000755   000065 656000 xsym               ERSQ    TH_CONSTRAINTS+53

     1738     4437    5                         END;

     1739     4438    4                         DEL_TEST = 'ACT';

   4438  3 000756   000004 236000 2                  LDQ     4
         3 000757   000010 376000 4                  ANQ     8
         3 000760   000040 276007                    ORQ     32,DL
         3 000761   200042 756100                    STQ     DEL_TEST,,AUTO
         3 000762   001565 710000 3                  TRA     s:4614

     1740     4439    4                    CASE(%MED);

     1741     4440    4                      MEDIA = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4440  3 000763   400003 475500                    LDP5    3,,PR4
         3 000764   500004 236100                    LDQ     4,,PR5
         3 000765   000033 772000                    QRL     27
         3 000766   000000 622006                    EAX2    0,QL
         3 000767   040100 100540                    MLR     fill='040'O
         3 000770   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 000771   200031 000006                    ADSC9   MEDIA,,AUTO              cn=0,n=6

     1742     4441    4                      IF (MATCH_DEL)

   4441  3 000772   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 000773   001020 605000 3                  TPL     s:4450

     1743     4442    4                        THEN
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:333  
     1744     4443    4                           IF ((TH_CONSTRAINTS.M_MED_S)&(MEDIA=TH_CONSTRAINTS.M_MED))

   4443  3 000774   400000 223003                    LDX3    -131072,DU
         3 000775   040000 106500                    CMPC    fill='040'O
         3 000776   200031 000006                    ADSC9   MEDIA,,AUTO              cn=0,n=6
         3 000777   000014 400006 xsym               ADSC9   TH_CONSTRAINTS+12        cn=2,n=6
         3 001000   001002 600000 3                  TZE     s:4443+6
         3 001001   000000 223003                    LDX3    0,DU
         3 001002   000016 236000 xsym               LDQ     TH_CONSTRAINTS+14
         3 001003   400000 376003                    ANQ     -131072,DU
         3 001004   200104 756100                    STQ     C_TEST+31,,AUTO
         3 001005   000000 636013                    EAQ     0,X3
         3 001006   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 001007   001013 600000 3                  TZE     s:4446

     1745     4444    4                             THEN TH_CONSTRAINTS.M_MED_S = %NO;

   4444  3 001010   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 001011   000016 356000 xsym               ANSQ    TH_CONSTRAINTS+14
         3 001012   001025 710000 3                  TRA     s:4453

     1746     4445    5                             ELSE DO;

     1747     4446    5                                CALL THM$ERRMSG(%E$TH_BAD_MED);

   4446  3 001013   000023 630400 4                  EPPR0   19
         3 001014   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001015   000000 701000 xent               TSX1    THM$ERRMSG
         3 001016   000000 011000                    NOP     0

     1748     4447    5                                ALTRETURN;

   4447  3 001017   000000 702200 xent               TSX2  ! X66_AALT

     1749     4448    5                                END;
     1750     4449    5                        ELSE DO;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:334  
     1751     4450    5                           TH_CONSTRAINTS.M_MED_S = %YES;

   4450  3 001020   400000 236003                    LDQ     -131072,DU
         3 001021   000016 256000 xsym               ORSQ    TH_CONSTRAINTS+14

     1752     4451    5                           TH_CONSTRAINTS.M_MED = MEDIA;

   4451  3 001022   040000 100500                    MLR     fill='040'O
         3 001023   200031 000006                    ADSC9   MEDIA,,AUTO              cn=0,n=6
         3 001024   000014 400006 xsym               ADSC9   TH_CONSTRAINTS+12        cn=2,n=6

     1753     4452    5                           END;

     1754     4453    4                      DEL_TEST = 'MED';

   4453  3 001025   000005 236000 2                  LDQ     5
         3 001026   000010 376000 4                  ANQ     8
         3 001027   000040 276007                    ORQ     32,DL
         3 001030   200042 756100                    STQ     DEL_TEST,,AUTO
         3 001031   001565 710000 3                  TRA     s:4614

     1755     4454    4                    CASE(%BY_B);

     1756     4455    4                      CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

   4455  3 001032   400003 475500                    LDP5    3,,PR4
         3 001033   500004 236100                    LDQ     4,,PR5
         3 001034   000033 772000                    QRL     27
         3 001035   000000 622006                    EAX2    0,QL
         3 001036   000100 305540                    DTB
         3 001037   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 001040   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 001041   200105 235100                    LDA     C_TEST+32,,AUTO
         3 001042   200020 755100                    STA     VALUE,,AUTO

     1757     4456    4                      IF VALUE > 25

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:335  
   4456  3 001043   000032 115007                    CMPA    26,DL
         3 001044   001052 602000 3                  TNC     s:4461

     1758     4457    5                        THEN DO;

     1759     4458    5                           CALL THM$ERRMSG(%E$TH_BAD_BYTE);

   4458  3 001045   000025 630400 4                  EPPR0   21
         3 001046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001047   000000 701000 xent               TSX1    THM$ERRMSG
         3 001050   000000 011000                    NOP     0

     1760     4459    5                           ALTRETURN;

   4459  3 001051   000000 702200 xent               TSX2  ! X66_AALT

     1761     4460    5                           END;
     1762     4461    4                      BYTE_SPEC = VALUE;

   4461  3 001052   200014 755100                    STA     BYTE_SPEC,,AUTO

     1763     4462    5                      DO CASE(TEMP$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE);

   4462  3 001053   400004 471500                    LDP1    4,,PR4
         3 001054   100000 721100                    LXL1    0,,PR1
         3 001055   000003 101003                    CMPX1   3,DU
         3 001056   001060 602011 3                  TNC     s:4462+5,X1
         3 001057   001270 710000 3                  TRA     s:4525
         3 001060   001270 710000 3                  TRA     s:4525
         3 001061   001063 710000 3                  TRA     s:4464
         3 001062   001173 710000 3                  TRA     s:4497

     1764     4463    5                         CASE(%BIT);

     1765     4464    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(1)

   4464  3 001063   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:336  
         3 001064   300004 236100                    LDQ     4,,PR3
         3 001065   000033 772000                    QRL     27
         3 001066   000000 622006                    EAX2    0,QL
         3 001067   000100 305540                    DTB
         3 001070   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         3 001071   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 001072   200105 236100                    LDQ     C_TEST+32,,AUTO
         3 001073   200020 756100                    STQ     VALUE,,AUTO

     1766     4465    5                                        ->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1767     4466    5                           IF VALUE > 7

   4466  3 001074   000010 116007                    CMPQ    8,DL
         3 001075   001103 602000 3                  TNC     s:4471

     1768     4467    6                             THEN DO;

     1769     4468    6                                CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4468  3 001076   000027 630400 4                  EPPR0   23
         3 001077   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001100   000000 701000 xent               TSX1    THM$ERRMSG
         3 001101   000000 011000                    NOP     0

     1770     4469    6                                ALTRETURN;

   4469  3 001102   000000 702200 xent               TSX2  ! X66_AALT

     1771     4470    6                                END;
     1772     4471    5                           FIRST_BIT = VALUE;

   4471  3 001103   200015 756100                    STQ     FIRST_BIT,,AUTO

     1773     4472    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(1)

   4472  3 001104   400004 471500                    LDP1    4,,PR4
         3 001105   100004 473500                    LDP3    4,,PR1
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:337  
         3 001106   300004 236100                    LDQ     4,,PR3
         3 001107   000033 772000                    QRL     27
         3 001110   000000 621006                    EAX1    0,QL
         3 001111   000100 305540                    DTB
         3 001112   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         3 001113   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 001114   200105 236100                    LDQ     C_TEST+32,,AUTO
         3 001115   200020 756100                    STQ     VALUE,,AUTO

     1774     4473    5                                        ->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);
     1775     4474    5                           IF (VALUE = 0 OR VALUE = 1)

   4474  3 001116   001126 600000 3                  TZE     s:4480
         3 001117   000001 116007                    CMPQ    1,DL
         3 001120   001126 600000 3                  TZE     s:4480

     1776     4475    5                             THEN ;
     1777     4476    6                             ELSE DO;

     1778     4477    6                                CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4477  3 001121   000027 630400 4                  EPPR0   23
         3 001122   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001123   000000 701000 xent               TSX1    THM$ERRMSG
         3 001124   000000 011000                    NOP     0

     1779     4478    6                                ALTRETURN;

   4478  3 001125   000000 702200 xent               TSX2  ! X66_AALT

     1780     4479    6                                END;
     1781     4480    5                           BIT_SPEC = BINBIT(VALUE,1);

   4480  3 001126   000043 736000                    QLS     35
         3 001127   200013 756100                    STQ     BIT_SPEC,,AUTO

     1782     4481    5                           INDX = (BYTE_SPEC) * 8 + FIRST_BIT;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:338  

   4481  3 001130   200014 236100                    LDQ     BYTE_SPEC,,AUTO
         3 001131   000003 736000                    QLS     3
         3 001132   200015 036100                    ADLQ    FIRST_BIT,,AUTO
         3 001133   200017 756100                    STQ     INDX,,AUTO

     1783     4482    5                           IF MATCH_DEL

   4482  3 001134   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 001135   001164 605000 3                  TPL     s:4493

     1784     4483    5                              THEN
     1785     4484    5                                IF ((TH_CONSTRAINTS.M_BY_B_SET(INDX)) &

   4484  3 001136   400000 221003                    LDX1    -131072,DU
         3 001137   000100 066406                    CMPB    filb='0'B
         3 001140   000016 010001 xsym               BDSC    TH_CONSTRAINTS+14,Q      by=0,bit=1,n=1
         3 001141   200013 000001                    BDSC    BIT_SPEC,,AUTO           by=0,bit=0,n=1
         3 001142   001144 600000 3                  TZE     s:4484+6
         3 001143   000000 221003                    LDX1    0,DU
         3 001144   003100 060406                    CSL     bolr='003'O
         3 001145   000026 010001 xsym               BDSC    TH_CONSTRAINTS+22,Q      by=0,bit=1,n=1
         3 001146   200104 000044                    BDSC    C_TEST+31,,AUTO          by=0,bit=0,n=36
         3 001147   000000 636011                    EAQ     0,X1
         3 001150   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 001151   001157 600000 3                  TZE     s:4489

     1786     4485    5                                    (TH_CONSTRAINTS.M_BY_B_VEC(INDX)=BIT_SPEC))
     1787     4486    5                                   THEN
     1788     4487    5                                     TH_CONSTRAINTS.M_BY_B_SET(INDX)=%NO;

   4487  3 001152   200017 236100                    LDQ     INDX,,AUTO
         3 001153   003006 060400                    CSL     bolr='003'O
         3 001154   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 001155   000026 010001 xsym               BDSC    TH_CONSTRAINTS+22,Q      by=0,bit=1,n=1
         3 001156   001270 710000 3                  TRA     s:4525

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:339  
     1789     4488    6                                   ELSE DO;

     1790     4489    6                                     CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4489  3 001157   000027 630400 4                  EPPR0   23
         3 001160   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001161   000000 701000 xent               TSX1    THM$ERRMSG
         3 001162   000000 011000                    NOP     0

     1791     4490    6                                     ALTRETURN;

   4490  3 001163   000000 702200 xent               TSX2  ! X66_AALT

     1792     4491    6                                     END;
     1793     4492    6                              ELSE DO;

     1794     4493    6                                TH_CONSTRAINTS.M_BY_B_SET(INDX) = %YES;

   4493  3 001164   003006 060400                    CSL     bolr='003'O
         3 001165   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         3 001166   000026 010001 xsym               BDSC    TH_CONSTRAINTS+22,Q      by=0,bit=1,n=1

     1795     4494    6                                TH_CONSTRAINTS.M_BY_B_VEC(INDX) = BIT_SPEC;

   4494  3 001167   003006 060500                    CSL     bolr='003'O
         3 001170   200013 000001                    BDSC    BIT_SPEC,,AUTO           by=0,bit=0,n=1
         3 001171   000016 010001 xsym               BDSC    TH_CONSTRAINTS+14,Q      by=0,bit=1,n=1

     1796     4495    6                                END;

   4495  3 001172   001270 710000 3                  TRA     s:4525

     1797     4496    5                         CASE(%BIT_STR);

     1798     4497    5                           TEMP = TEMP$->OUT$BLK.SUBLK$(1)->

   4497  3 001173   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:340  
         3 001174   300004 236100                    LDQ     4,,PR3
         3 001175   000033 772000                    QRL     27
         3 001176   000000 622006                    EAX2    0,QL
         3 001177   040100 100540                    MLR     fill='040'O
         3 001200   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         3 001201   200033 000010                    ADSC9   TEMP,,AUTO               cn=0,n=8

     1799     4498    5                                  OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1800     4499    6                        DO K = 0 TO 7;

   4499  3 001202   200006 450100                    STZ     K,,AUTO

     1801     4500    6                        CALL CHARBIN(VALUE,TEMPP(K));

   4500  3 001203   200006 235100                    LDA     K,,AUTO
         3 001204   000100 305505                    DTB
         3 001205   200033 030001                    NDSC9   TEMP,A,AUTO              cn=0,s=nosgn,sf=0,n=1
         3 001206   200020 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4

     1802     4501    6                             IF (VALUE = 0 OR VALUE = 1)

   4501  3 001207   200020 236100                    LDQ     VALUE,,AUTO
         3 001210   001220 600000 3                  TZE     s:4507
         3 001211   000001 116007                    CMPQ    1,DL
         3 001212   001220 600000 3                  TZE     s:4507

     1803     4502    6                                THEN;
     1804     4503    7                                ELSE DO;

     1805     4504    7                                     CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4504  3 001213   000027 630400 4                  EPPR0   23
         3 001214   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001215   000000 701000 xent               TSX1    THM$ERRMSG
         3 001216   000000 011000                    NOP     0

     1806     4505    7                                     ALTRETURN;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:341  

   4505  3 001217   000000 702200 xent               TSX2  ! X66_AALT

     1807     4506    7                                     END;
     1808     4507    6                             BIT_SPEC = BINBIT(VALUE,1);

   4507  3 001220   000043 736000                    QLS     35
         3 001221   200013 756100                    STQ     BIT_SPEC,,AUTO

     1809     4508    6                        INDX = (BYTE_SPEC) * 8 + K;

   4508  3 001222   200014 236100                    LDQ     BYTE_SPEC,,AUTO
         3 001223   000003 736000                    QLS     3
         3 001224   200006 036100                    ADLQ    K,,AUTO
         3 001225   200017 756100                    STQ     INDX,,AUTO

     1810     4509    6                             IF MATCH_DEL

   4509  3 001226   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 001227   001256 605000 3                  TPL     s:4520

     1811     4510    6                                THEN
     1812     4511    6                                  IF ((TH_CONSTRAINTS.M_BY_B_SET(INDX)) &

   4511  3 001230   400000 220003                    LDX0    -131072,DU
         3 001231   000100 066406                    CMPB    filb='0'B
         3 001232   000016 010001 xsym               BDSC    TH_CONSTRAINTS+14,Q      by=0,bit=1,n=1
         3 001233   200013 000001                    BDSC    BIT_SPEC,,AUTO           by=0,bit=0,n=1
         3 001234   001236 600000 3                  TZE     s:4511+6
         3 001235   000000 220003                    LDX0    0,DU
         3 001236   003100 060406                    CSL     bolr='003'O
         3 001237   000026 010001 xsym               BDSC    TH_CONSTRAINTS+22,Q      by=0,bit=1,n=1
         3 001240   200104 000044                    BDSC    C_TEST+31,,AUTO          by=0,bit=0,n=36
         3 001241   000000 636010                    EAQ     0,X0
         3 001242   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 001243   001251 600000 3                  TZE     s:4516

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:342  
     1813     4512    6                                     (TH_CONSTRAINTS.M_BY_B_VEC(INDX)=BIT_SPEC))
     1814     4513    6                                     THEN
     1815     4514    6                                       TH_CONSTRAINTS.M_BY_B_SET(INDX)=%NO;

   4514  3 001244   200017 236100                    LDQ     INDX,,AUTO
         3 001245   003006 060400                    CSL     bolr='003'O
         3 001246   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 001247   000026 010001 xsym               BDSC    TH_CONSTRAINTS+22,Q      by=0,bit=1,n=1
         3 001250   001264 710000 3                  TRA     s:4523

     1816     4515    7                                     ELSE DO;

     1817     4516    7                                       CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4516  3 001251   000027 630400 4                  EPPR0   23
         3 001252   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001253   000000 701000 xent               TSX1    THM$ERRMSG
         3 001254   000000 011000                    NOP     0

     1818     4517    7                                       ALTRETURN;

   4517  3 001255   000000 702200 xent               TSX2  ! X66_AALT

     1819     4518    7                                       END;
     1820     4519    7                                ELSE DO;

     1821     4520    7                                     TH_CONSTRAINTS.M_BY_B_SET(INDX)=%YES;

   4520  3 001256   003006 060400                    CSL     bolr='003'O
         3 001257   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         3 001260   000026 010001 xsym               BDSC    TH_CONSTRAINTS+22,Q      by=0,bit=1,n=1

     1822     4521    7                                     TH_CONSTRAINTS.M_BY_B_VEC(INDX)=BIT_SPEC;

   4521  3 001261   003006 060500                    CSL     bolr='003'O
         3 001262   200013 000001                    BDSC    BIT_SPEC,,AUTO           by=0,bit=0,n=1
         3 001263   000016 010001 xsym               BDSC    TH_CONSTRAINTS+14,Q      by=0,bit=1,n=1
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:343  

     1823     4522    7                                     END;

     1824     4523    6                           END;

   4523  3 001264   200006 054100                    AOS     K,,AUTO
         3 001265   200006 235100                    LDA     K,,AUTO
         3 001266   000007 115007                    CMPA    7,DL
         3 001267   001203 604400 3                  TMOZ    s:4500

     1825     4524    5                      END;                /* DO CASE */

     1826     4525    4                      DEL_TEST = 'BYT';

   4525  3 001270   000006 236000 2                  LDQ     6
         3 001271   000010 376000 4                  ANQ     8
         3 001272   000040 276007                    ORQ     32,DL
         3 001273   200042 756100                    STQ     DEL_TEST,,AUTO
         3 001274   001565 710000 3                  TRA     s:4614

     1827     4526    4                    CASE(%FEP_CODE);

     1828     4527    4                      FEP_CODE = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4527  3 001275   400003 475500                    LDP5    3,,PR4
         3 001276   500004 236100                    LDQ     4,,PR5
         3 001277   000033 772000                    QRL     27
         3 001300   000000 622006                    EAX2    0,QL
         3 001301   040100 100540                    MLR     fill='040'O
         3 001302   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 001303   200035 000003                    ADSC9   FEP_CODE,,AUTO           cn=0,n=3

     1829     4528    4                      IF MATCH_DEL

   4528  3 001304   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 001305   001332 605000 3                  TPL     s:4538

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:344  
     1830     4529    4                        THEN
     1831     4530    4                           IF ((TH_CONSTRAINTS.M_FEP_SET) &

   4530  3 001306   400000 223003                    LDX3    -131072,DU
         3 001307   040100 106400                    CMPC    fill='040'O
         3 001310   000060 200003 xsym               ADSC9   TH_CONSTRAINTS+48        cn=1,n=3
         3 001311   200035 000003                    ADSC9   FEP_CODE,,AUTO           cn=0,n=3
         3 001312   001314 600000 3                  TZE     s:4530+6
         3 001313   000000 223003                    LDX3    0,DU
         3 001314   000061 236000 xsym               LDQ     TH_CONSTRAINTS+49
         3 001315   400000 376003                    ANQ     -131072,DU
         3 001316   200104 756100                    STQ     C_TEST+31,,AUTO
         3 001317   000000 636013                    EAQ     0,X3
         3 001320   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 001321   001325 600000 3                  TZE     s:4534

     1832     4531    4                               (TH_CONSTRAINTS.M_FEP = FEP_CODE))
     1833     4532    4                             THEN TH_CONSTRAINTS.M_FEP_SET = %NO;

   4532  3 001322   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 001323   000061 356000 xsym               ANSQ    TH_CONSTRAINTS+49
         3 001324   001345 710000 3                  TRA     s:4543

     1834     4533    5                             ELSE DO;

     1835     4534    5                                CALL THM$ERRMSG(%E$TH_BAD_FEP);

   4534  3 001325   000031 630400 4                  EPPR0   25
         3 001326   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001327   000000 701000 xent               TSX1    THM$ERRMSG
         3 001330   000000 011000                    NOP     0

     1836     4535    5                                ALTRETURN;

   4535  3 001331   000000 702200 xent               TSX2  ! X66_AALT

     1837     4536    5                             END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:345  
     1838     4537    5                        ELSE DO;

     1839     4538    5                           TH_CONSTRAINTS.M_FEP_SET = %YES;

   4538  3 001332   400000 236003                    LDQ     -131072,DU
         3 001333   000061 256000 xsym               ORSQ    TH_CONSTRAINTS+49

     1840     4539    5                           TH_CONSTRAINTS.M_FEP = FEP_CODE;

   4539  3 001334   200035 236100                    LDQ     FEP_CODE,,AUTO
         3 001335   000011 772000                    QRL     9
         3 001336   000060 552034 xsym               STBQ    TH_CONSTRAINTS+48,'34'O

     1841     4540    5                           TH_CONSTRAINTS.M_FEP_N = TEMP$->OUT$BLK.SUBLK$(0)

   4540  3 001337   400003 471500                    LDP1    3,,PR4
         3 001340   100004 236100                    LDQ     4,,PR1
         3 001341   000001 772000                    QRL     1
         3 001342   000061 676000 xsym               ERQ     TH_CONSTRAINTS+49
         3 001343   377400 376003                    ANQ     130816,DU
         3 001344   000061 656000 xsym               ERSQ    TH_CONSTRAINTS+49

     1842     4541    5                                                    ->OUT$SYM.COUNT;
     1843     4542    5                           END;

     1844     4543    4                        DEL_TEST = 'FCG';

   4543  3 001345   000007 236000 2                  LDQ     7
         3 001346   000010 376000 4                  ANQ     8
         3 001347   000040 276007                    ORQ     32,DL
         3 001350   200042 756100                    STQ     DEL_TEST,,AUTO
         3 001351   001565 710000 3                  TRA     s:4614

     1845     4544    4                    CASE(%FEP_CHAN);

     1846     4545    4                      FEP_CHAN = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:346  
   4545  3 001352   400003 475500                    LDP5    3,,PR4
         3 001353   500004 236100                    LDQ     4,,PR5
         3 001354   000033 772000                    QRL     27
         3 001355   000000 622006                    EAX2    0,QL
         3 001356   040100 100540                    MLR     fill='040'O
         3 001357   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 001360   200036 000004                    ADSC9   FEP_CHAN,,AUTO           cn=0,n=4

     1847     4546    4                      J = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;

   4546  3 001361   200005 756100                    STQ     J,,AUTO

     1848     4547    5                      DO CASE (J);

   4547  3 001362   000005 116007                    CMPQ    5,DL
         3 001363   001365 602006 3                  TNC     s:4547+3,QL
         3 001364   001420 710000 3                  TRA     s:4557
         3 001365   001420 710000 3                  TRA     s:4557
         3 001366   001372 710000 3                  TRA     s:4549
         3 001367   001402 710000 3                  TRA     s:4551
         3 001370   001407 710000 3                  TRA     s:4553
         3 001371   001415 710000 3                  TRA     s:4555

     1849     4548    5                        CASE(1);

     1850     4549    5                           CALL CONCAT(FEP_CHAN_N,'000',SUBSTR(FEP_CHAN,0,1));

   4549  3 001372   000010 236000 2                  LDQ     8
         3 001373   000010 376000 4                  ANQ     8
         3 001374   000040 276007                    ORQ     32,DL
         3 001375   200037 756100                    STQ     FEP_CHAN_N,,AUTO
         3 001376   200036 236100                    LDQ     FEP_CHAN,,AUTO
         3 001377   000033 772000                    QRL     27
         3 001400   200037 552104                    STBQ    FEP_CHAN_N,'04'O,AUTO
         3 001401   001425 710000 3                  TRA     s:4560

     1851     4550    5                        CASE(2);
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:347  

     1852     4551    5                           CALL CONCAT(FEP_CHAN_N,'00',SUBSTR(FEP_CHAN,0,2));

   4551  3 001402   000010 223000 2                  LDX3    8
         3 001403   200037 743100                    STX3    FEP_CHAN_N,,AUTO
         3 001404   200036 224100                    LDX4    FEP_CHAN,,AUTO
         3 001405   200037 444100                    SXL4    FEP_CHAN_N,,AUTO
         3 001406   001425 710000 3                  TRA     s:4560

     1853     4552    5                        CASE(3);

     1854     4553    5                           CALL CONCAT(FEP_CHAN_N,'0',SUBSTR(FEP_CHAN,0,3));

   4553  3 001407   060000 236003                    LDQ     24576,DU
         3 001410   200037 756100                    STQ     FEP_CHAN_N,,AUTO
         3 001411   200036 236100                    LDQ     FEP_CHAN,,AUTO
         3 001412   000011 772000                    QRL     9
         3 001413   200037 552134                    STBQ    FEP_CHAN_N,'34'O,AUTO
         3 001414   001425 710000 3                  TRA     s:4560

     1855     4554    5                        CASE(4);

     1856     4555    5                           FEP_CHAN_N = FEP_CHAN;

   4555  3 001415   200036 236100                    LDQ     FEP_CHAN,,AUTO
         3 001416   200037 756100                    STQ     FEP_CHAN_N,,AUTO
         3 001417   001425 710000 3                  TRA     s:4560

     1857     4556    5                        CASE (ELSE);

     1858     4557    5                           CALL THM$ERRMSG(%E$TH_BAD_CHAN);

   4557  3 001420   000033 630400 4                  EPPR0   27
         3 001421   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001422   000000 701000 xent               TSX1    THM$ERRMSG
         3 001423   000000 011000                    NOP     0

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:348  
     1859     4558    5                           ALTRETURN;

   4558  3 001424   000000 702200 xent               TSX2  ! X66_AALT

     1860     4559    5                      END;

     1861     4560    4          IF MATCH_DEL THEN

   4560  3 001425   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 001426   001523 605000 3                  TPL     s:4597

     1862     4561    5            DO;

     1863     4562    5                IF TH_CONSTRAINTS.M_CHAN_SET

   4562  3 001427   000062 236000 xsym               LDQ     TH_CONSTRAINTS+50
         3 001430   400000 316007                    CANQ    -131072,DL
         3 001431   001516 600000 3                  TZE     WRONG

     1864     4563    5                  THEN
     1865     4564    6                  DO;

     1866     4565    6                    FOUND='0'B;

   4565  3 001432   200012 450100                    STZ     FOUND,,AUTO

     1867     4566    7                    DO K = 0 TO TH_M_CHAN_TOTAL-1;

   4566  3 001433   200006 450100                    STZ     K,,AUTO
         3 001434   001457 710000 3                  TRA     s:4574+1

     1868     4567    7                      IF FEP_CHAN_N = TH_M_CHAN.TEXT(K)

   4567  3 001435   200006 236100                    LDQ     K,,AUTO
         3 001436   000005 402007                    MPY     5,DL
         3 001437   040006 106500                    CMPC    fill='040'O
         3 001440   200037 000004                    ADSC9   FEP_CHAN_N,,AUTO         cn=0,n=4
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:349  
         3 001441   000000 000004 xsym               ADSC9   TH_M_CHAN,Q              cn=0,n=4
         3 001442   001456 601000 3                  TNZ     s:4574

     1869     4568    7                        THEN
     1870     4569    8                          DO;

     1871     4570    8                            FOUND='1'B;

   4570  3 001443   400000 236003                    LDQ     -131072,DU
         3 001444   200012 756100                    STQ     FOUND,,AUTO

     1872     4571    8                            TH_M_CHAN.FLAG(K) = '0'B;

   4571  3 001445   200006 236100                    LDQ     K,,AUTO
         3 001446   000055 402007                    MPY     45,DL
         3 001447   000000 116003                    CMPQ    0,DU
         3 001450   001452 605000 3                  TPL     s:4571+5
         3 001451   000044 036003                    ADLQ    36,DU
         3 001452   003006 060400                    CSL     bolr='003'O
         3 001453   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 001454   000001 000001 xsym               BDSC    TH_M_CHAN+1,Q            by=0,bit=0,n=1

     1873     4572    8                            GOTO FOUND_CHANNEL;

   4572  3 001455   001463 710000 3                  TRA     FOUND_CHANNEL

     1874     4573    8                          END;
     1875     4574    7                    END;

   4574  3 001456   200006 054100                    AOS     K,,AUTO
         3 001457   000000 236000 xsym               LDQ     TH_M_CHAN_TOTAL
         3 001460   000037 772000                    QRL     31
         3 001461   200006 116100                    CMPQ    K,,AUTO
         3 001462   001435 605400 3                  TPNZ    s:4567

     1876     4575    6   FOUND_CHANNEL:   IF FOUND

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:350  
   4575  3 001463   200012 234100       FOUND_CHANN* SZN     FOUND,,AUTO
         3 001464   001516 605000 3                  TPL     WRONG

     1877     4576    6                      THEN
     1878     4577    7                        DO;

     1879     4578    7                          JJ = 0;

   4578  3 001465   200043 450100                    STZ     JJ,,AUTO

     1880     4579    8                          DO K = 0 TO TH_M_CHAN_TOTAL-1;

   4579  3 001466   200006 450100                    STZ     K,,AUTO
         3 001467   001505 710000 3                  TRA     s:4582+1

     1881     4580    8                            IF TH_M_CHAN.FLAG(K) = '1'B

   4580  3 001470   200006 236100                    LDQ     K,,AUTO
         3 001471   000055 402007                    MPY     45,DL
         3 001472   000000 116003                    CMPQ    0,DU
         3 001473   001475 605000 3                  TPL     s:4580+5
         3 001474   000044 036003                    ADLQ    36,DU
         3 001475   000000 066406                    CMPB    filb='0'B
         3 001476   000001 000001 xsym               BDSC    TH_M_CHAN+1,Q            by=0,bit=0,n=1
         3 001477   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001500   001504 600000 3                  TZE     s:4582

     1882     4581    8                                THEN  JJ = JJ + 1;

   4581  3 001501   200043 235100                    LDA     JJ,,AUTO
         3 001502   000001 035007                    ADLA    1,DL
         3 001503   200043 755100                    STA     JJ,,AUTO

     1883     4582    8                          END;

   4582  3 001504   200006 054100                    AOS     K,,AUTO
         3 001505   000000 236000 xsym               LDQ     TH_M_CHAN_TOTAL
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:351  
         3 001506   000037 772000                    QRL     31
         3 001507   200006 116100                    CMPQ    K,,AUTO
         3 001510   001470 605400 3                  TPNZ    s:4580

     1884     4583    7                          IF JJ = 0

   4583  3 001511   200043 235100                    LDA     JJ,,AUTO
         3 001512   001561 601000 3                  TNZ     s:4612

     1885     4584    7                            THEN
     1886     4585    7                                TH_CONSTRAINTS.M_CHAN_SET = '0'B;

   4585  3 001513   000002 236000 4                  LDQ     2
         3 001514   000062 356000 xsym               ANSQ    TH_CONSTRAINTS+50

     1887     4586    7                        END;

   4586  3 001515   001561 710000 3                  TRA     s:4612

     1888     4587    6                        ELSE
     1889     4588    6                            GOTO WRONG;
     1890     4589    6                  END;
     1891     4590    5                  ELSE
     1892     4591    6                    DO;

     1893     4592    6   WRONG:             CALL THM$ERRMSG(%E$TH_BAD_CHAN);

   4592  3 001516   000033 630400 4     WRONG        EPPR0   27
         3 001517   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001520   000000 701000 xent               TSX1    THM$ERRMSG
         3 001521   000000 011000                    NOP     0

     1894     4593    6                      ALTRETURN;

   4593  3 001522   000000 702200 xent               TSX2  ! X66_AALT

     1895     4594    6                    END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:352  
     1896     4595    5            END; /* IF MATCH_DEL */
     1897     4596    4            ELSE
     1898     4597    4                IF MATCH_ADD

   4597  3 001523   200040 234100                    SZN     MATCH_ADD,,AUTO
         3 001524   001551 605000 3                  TPL     s:4607

     1899     4598    4                  THEN
     1900     4599    5                    DO;

     1901     4600    5                      TH_CONSTRAINTS.M_CHAN_SET = '1'B;

   4600  3 001525   400000 236007                    LDQ     -131072,DL
         3 001526   000062 256000 xsym               ORSQ    TH_CONSTRAINTS+50

     1902     4601    5                      TH_M_CHAN.TEXT(TH_M_CHAN_TOTAL) = FEP_CHAN_N;

   4601  3 001527   000000 236000 xsym               LDQ     TH_M_CHAN_TOTAL
         3 001530   000037 772000                    QRL     31
         3 001531   000005 402007                    MPY     5,DL
         3 001532   040006 100500                    MLR     fill='040'O
         3 001533   200037 000004                    ADSC9   FEP_CHAN_N,,AUTO         cn=0,n=4
         3 001534   000000 000004 xsym               ADSC9   TH_M_CHAN,Q              cn=0,n=4

     1903     4602    5                      TH_M_CHAN.FLAG(TH_M_CHAN_TOTAL) = '1'B;

   4602  3 001535   000000 236000 xsym               LDQ     TH_M_CHAN_TOTAL
         3 001536   000037 772000                    QRL     31
         3 001537   000055 402007                    MPY     45,DL
         3 001540   003006 060400                    CSL     bolr='003'O
         3 001541   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         3 001542   000001 000001 xsym               BDSC    TH_M_CHAN+1,Q            by=0,bit=0,n=1

     1904     4603    5                      TH_M_CHAN_TOTAL = TH_M_CHAN_TOTAL + 1;

   4603  3 001543   000000 236000 xsym               LDQ     TH_M_CHAN_TOTAL
         3 001544   000037 772000                    QRL     31
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:353  
         3 001545   000001 036007                    ADLQ    1,DL
         3 001546   000037 736000                    QLS     31
         3 001547   000000 756000 xsym               STQ     TH_M_CHAN_TOTAL

     1905     4604    5                    END;

   4604  3 001550   001561 710000 3                  TRA     s:4612

     1906     4605    4                    ELSE
     1907     4606    5                      DO;

     1908     4607    5                        TH_CONSTRAINTS.M_CHAN_SET = '1'B;

   4607  3 001551   400000 236007                    LDQ     -131072,DL
         3 001552   000062 256000 xsym               ORSQ    TH_CONSTRAINTS+50

     1909     4608    5                        TH_M_CHAN.TEXT(0) = FEP_CHAN_N;

   4608  3 001553   200037 236100                    LDQ     FEP_CHAN_N,,AUTO
         3 001554   000000 756000 xsym               STQ     TH_M_CHAN

     1910     4609    5                        TH_M_CHAN.FLAG(0) = '1'B;

   4609  3 001555   400000 236003                    LDQ     -131072,DU
         3 001556   000001 256000 xsym               ORSQ    TH_M_CHAN+1

     1911     4610    5                        TH_M_CHAN_TOTAL = 1;

   4610  3 001557   020000 236003                    LDQ     8192,DU
         3 001560   000000 756000 xsym               STQ     TH_M_CHAN_TOTAL

     1912     4611    5                      END;

     1913     4612    4                        DEL_TEST = 'CHA';

   4612  3 001561   000011 236000 2                  LDQ     9
         3 001562   000010 376000 4                  ANQ     8
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:354  
         3 001563   000040 276007                    ORQ     32,DL
         3 001564   200042 756100                    STQ     DEL_TEST,,AUTO

     1914     4613    4                 END;                     /* OF CASE   */

     1915     4614    3             IF MATCH_DEL

   4614  3 001565   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 001566   001753 605000 3                  TPL     s:4659

     1916     4615    4               THEN DO;

     1917     4616    4                 CALL INDEX(JJ,DEL_TEST,TH_LAST_MATCH.TEXT);

   4616  3 001567   200043 631500                    EPPR1   JJ,,AUTO
         3 001570   200042 633500                    EPPR3   DEL_TEST,,AUTO
         3 001571   000003 223003                    LDX3    3,DU
         3 001572   000000 630400 xsym               EPPR0   TH_LAST_MATCH
         3 001573   000001 220003                    LDX0    1,DU
         3 001574   000000 500510                    A9BD    0,X0,PR0
         3 001575   000167 220003                    LDX0    119,DU
         3 001576   000000 236003                    LDQ     0,DU
         3 001577   000000 701000 xent               TSX1    X66_INDEX
         3 001600   000000 011000                    NOP     0

     1918     4617    4                 JCNT = JJ;

   4617  3 001601   200043 235100                    LDA     JJ,,AUTO
         3 001602   200044 755100                    STA     JCNT,,AUTO

     1919     4618    4       NEXT_COMMA:  FOUND = '0'B;

   4618  3 001603   200012 450100       NEXT_COMMA   STZ     FOUND,,AUTO

     1920     4619    4                 SAVE_INDEX = 0;

   4619  3 001604   200007 450100                    STZ     SAVE_INDEX,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:355  

     1921     4620    5                 DO WHILE NOT FOUND;

   4620  3 001605   001652 710000 3                  TRA     s:4639

     1922     4621    6                   DO WHILE(SUBSTR(TH_LAST_MATCH.TEXT,JCNT,1) ~= ',');

   4621  3 001606   001641 710000 3                  TRA     s:4636

     1923     4622    6                      IF JCNT > TH_LAST_MATCH.COUNT

   4622  3 001607   000000 236000 xsym               LDQ     TH_LAST_MATCH
         3 001610   000033 772000                    QRL     27
         3 001611   200044 116100                    CMPQ    JCNT,,AUTO
         3 001612   001671 602000 3                  TNC     DEL_END_M

     1924     4623    6                        THEN GOTO DEL_END_M;
     1925     4624    6                        IF(SUBSTR(TH_LAST_MATCH.TEXT,JCNT,1) = '=')

   4624  3 001613   200044 235100                    LDA     JCNT,,AUTO
         3 001614   040000 106405                    CMPC    fill='040'O
         3 001615   000000 200001 xsym               ADSC9   TH_LAST_MATCH,A          cn=1,n=1
         3 001616   000034 000001 4                  ADSC9   28                       cn=0,n=1
         3 001617   001637 601000 3                  TNZ     s:4635

     1926     4625    7                        THEN DO;

     1927     4626    7                          SAVE_INDEX = JCNT - 5;

   4626  3 001620   000005 135007                    SBLA    5,DL
         3 001621   200007 755100                    STA     SAVE_INDEX,,AUTO

     1928     4627    7                          IF(SUBSTR(TH_LAST_MATCH.TEXT,JCNT+1,4) = FEP_CHAN)

   4627  3 001622   200044 235100                    LDA     JCNT,,AUTO
         3 001623   040100 106405                    CMPC    fill='040'O
         3 001624   000000 400004 xsym               ADSC9   TH_LAST_MATCH,A          cn=2,n=4
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:356  
         3 001625   200036 000004                    ADSC9   FEP_CHAN,,AUTO           cn=0,n=4
         3 001626   001634 601000 3                  TNZ     s:4632

     1929     4628    8                          THEN DO;JCNT = JCNT + 5;

   4628  3 001627   000005 035007                    ADLA    5,DL
         3 001630   200044 755100                    STA     JCNT,,AUTO

     1930     4629    8                                  FOUND = '1'B;

   4629  3 001631   400000 236003                    LDQ     -131072,DU
         3 001632   200012 756100                    STQ     FOUND,,AUTO

     1931     4630    8                          END;

   4630  3 001633   001641 710000 3                  TRA     s:4636

     1932     4631    7                          ELSE
     1933     4632    7                            JCNT = JCNT + 1;

   4632  3 001634   000001 035007                    ADLA    1,DL
         3 001635   200044 755100                    STA     JCNT,,AUTO

     1934     4633    7                        END;

   4633  3 001636   001641 710000 3                  TRA     s:4636

     1935     4634    6                      ELSE
     1936     4635    6                      JCNT = JCNT + 1;

   4635  3 001637   000001 035007                    ADLA    1,DL
         3 001640   200044 755100                    STA     JCNT,,AUTO

     1937     4636    6                   END; /* do while ~= ','*/

   4636  3 001641   200044 235100                    LDA     JCNT,,AUTO
         3 001642   040000 106405                    CMPC    fill='040'O
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:357  
         3 001643   000000 200001 xsym               ADSC9   TH_LAST_MATCH,A          cn=1,n=1
         3 001644   000035 000001 4                  ADSC9   29                       cn=0,n=1
         3 001645   001607 601000 3                  TNZ     s:4622

     1938     4637    5                   IF NOT FOUND THEN

   4637  3 001646   200012 234100                    SZN     FOUND,,AUTO
         3 001647   001652 604000 3                  TMI     s:4639

     1939     4638    5                     JCNT = JCNT + 1;

   4638  3 001650   000001 035007                    ADLA    1,DL
         3 001651   200044 755100                    STA     JCNT,,AUTO

     1940     4639    5                 END;

   4639  3 001652   200012 234100                    SZN     FOUND,,AUTO
         3 001653   001606 605000 3                  TPL     s:4621

     1941     4640    4                 IF DEL_TEST = 'BYT' AND TEMP$->OUT$BLK.SUBLK$(1)

   4640  3 001654   200042 236100                    LDQ     DEL_TEST,,AUTO
         3 001655   000006 676000 2                  ERQ     6
         3 001656   000010 376000 4                  ANQ     8
         3 001657   001671 601000 3                  TNZ     DEL_END_M
         3 001660   200021 470500                    LDP0    TEMP$,,AUTO
         3 001661   000004 471500                    LDP1    4,,PR0
         3 001662   100000 720100                    LXL0    0,,PR1
         3 001663   000001 100003                    CMPX0   1,DU
         3 001664   001671 601000 3                  TNZ     DEL_END_M

     1942     4641    4                      ->OUT$BLK.CODE = %BIT
     1943     4642    5                      THEN DO;

     1944     4643    5                           JCNT = JCNT + 1;

   4643  3 001665   200044 235100                    LDA     JCNT,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:358  
         3 001666   000001 035007                    ADLA    1,DL
         3 001667   200044 755100                    STA     JCNT,,AUTO

     1945     4644    5                           GOTO NEXT_COMMA;

   4644  3 001670   001603 710000 3                  TRA     NEXT_COMMA

     1946     4645    5                      END;
     1947     4646    4       DEL_END_M:
     1948     4647    4                 C_TEST = ' ';

   4647  3 001671   040100 100400       DEL_END_M    MLR     fill='040'O
         3 001672   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001673   200045 000167                    ADSC9   C_TEST,,AUTO             cn=0,n=119

     1949     4648    4                 IF SAVE_INDEX = 0 THEN

   4648  3 001674   200007 235100                    LDA     SAVE_INDEX,,AUTO
         3 001675   001706 601000 3                  TNZ     s:4650

     1950     4649    4                 CALL CONCAT(C_TEST,SUBSTR(TH_LAST_MATCH.TEXT,JCNT+1));

   4649  3 001676   200044 720100                    LXL0    JCNT,,AUTO
         3 001677   777611 620010                    EAX0    -119,X0
         3 001700   777777 660003                    ERX0    -1,DU
         3 001701   200044 236100                    LDQ     JCNT,,AUTO
         3 001702   040100 100446                    MLR     fill='040'O
         3 001703   000000 400010 xsym               ADSC9   TH_LAST_MATCH,Q          cn=2,n=*X0
         3 001704   200045 000167                    ADSC9   C_TEST,,AUTO             cn=0,n=119
         3 001705   001726 710000 3                  TRA     s:4652

     1951     4650    4                 ELSE CALL CONCAT(C_TEST,SUBSTR(TH_LAST_MATCH.TEXT,0,SAVE_INDEX),

   4650  3 001706   000000 620005                    EAX0    0,AL
         3 001707   040100 100440                    MLR     fill='040'O
         3 001710   000000 200010 xsym               ADSC9   TH_LAST_MATCH            cn=1,n=*X0
         3 001711   200045 000167                    ADSC9   C_TEST,,AUTO             cn=0,n=119
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:359  
         3 001712   200007 236100                    LDQ     SAVE_INDEX,,AUTO
         3 001713   000167 116007                    CMPQ    119,DL
         3 001714   001726 605000 3                  TPL     s:4652
         3 001715   200044 720100                    LXL0    JCNT,,AUTO
         3 001716   777611 620010                    EAX0    -119,X0
         3 001717   777777 660003                    ERX0    -1,DU
         3 001720   777610 621006                    EAX1    -120,QL
         3 001721   777777 661003                    ERX1    -1,DU
         3 001722   200044 235100                    LDA     JCNT,,AUTO
         3 001723   040146 100445                    MLR     fill='040'O
         3 001724   000000 400010 xsym               ADSC9   TH_LAST_MATCH,A          cn=2,n=*X0
         3 001725   200045 000011                    ADSC9   C_TEST,Q,AUTO            cn=0,n=*X1

     1952     4651    4                                  SUBSTR(TH_LAST_MATCH.TEXT,JCNT+1));
     1953     4652    4                 TH_LAST_MATCH.TEXT = C_TEST;

   4652  3 001726   040000 100500                    MLR     fill='040'O
         3 001727   200045 000167                    ADSC9   C_TEST,,AUTO             cn=0,n=119
         3 001730   000000 200167 xsym               ADSC9   TH_LAST_MATCH            cn=1,n=119

     1954     4653    4                 IF JCNT > TH_LAST_MATCH.COUNT

   4653  3 001731   000000 236000 xsym               LDQ     TH_LAST_MATCH
         3 001732   000033 772000                    QRL     27
         3 001733   200044 116100                    CMPQ    JCNT,,AUTO
         3 001734   001746 603000 3                  TRC     s:4657

     1955     4654    4                    THEN
     1956     4655    4                      TH_LAST_MATCH.COUNT=TH_LAST_MATCH.COUNT-(JCNT-JJ);

   4655  3 001735   200044 236100                    LDQ     JCNT,,AUTO
         3 001736   200043 136100                    SBLQ    JJ,,AUTO
         3 001737   200104 756100                    STQ     C_TEST+31,,AUTO
         3 001740   000000 236000 xsym               LDQ     TH_LAST_MATCH
         3 001741   000033 772000                    QRL     27
         3 001742   200104 136100                    SBLQ    C_TEST+31,,AUTO
         3 001743   000033 736000                    QLS     27
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:360  
         3 001744   000000 552040 xsym               STBQ    TH_LAST_MATCH,'40'O
         3 001745   001753 710000 3                  TRA     s:4659

     1957     4656    4                    ELSE
     1958     4657    4                    TH_LAST_MATCH.COUNT = TH_LAST_MATCH.COUNT - (JCNT+1) + SAVE_INDEX;

   4657  3 001746   200044 136100                    SBLQ    JCNT,,AUTO
         3 001747   200007 036100                    ADLQ    SAVE_INDEX,,AUTO
         3 001750   000001 136007                    SBLQ    1,DL
         3 001751   000033 736000                    QLS     27
         3 001752   000000 552040 xsym               STBQ    TH_LAST_MATCH,'40'O

     1959     4658    4                 END;

     1960     4659    3            END;                          /* DO I = J   */

   4659  3 001753   200004 054100                    AOS     I,,AUTO
         3 001754   200003 470500                    LDP0    @TOP$,,AUTO
         3 001755   000000 471500                    LDP1    0,,PR0
         3 001756   100001 236100                    LDQ     1,,PR1
         3 001757   000022 772000                    QRL     18
         3 001760   200004 116100                    CMPQ    I,,AUTO
         3 001761   000214 605400 3                  TPNZ    s:4317

     1961     4660    2             IF MATCH_DEL

   4660  3 001762   200022 234100                    SZN     MATCH_DEL,,AUTO
         3 001763   004123 604000 3                  TMI     s:5121

     1962     4661    2                 THEN ;
     1963     4662    3                 ELSE DO;

     1964     4663    3            CALL INDEX(INDX,' ',TEXTBASE);

   4663  3 001764   000000 473400 xsym               LDP3    P_PCB
         3 001765   000011 720000 xsym               LXL0    P_PCB+9
         3 001766   000000 124540                    SCM     mask='000'O
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:361  
         3 001767   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         3 001770   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001771   200017 000100                    ARG     INDX,,AUTO

     1965     4664    4            DO WHILE(SUBSTR(TEXTBASE,INDX,1) = ' ');

   4664  3 001772   001776 710000 3                  TRA     s:4666

     1966     4665    4                 INDX = INDX + 1;

   4665  3 001773   200017 235100                    LDA     INDX,,AUTO
         3 001774   000001 035007                    ADLA    1,DL
         3 001775   200017 755100                    STA     INDX,,AUTO

     1967     4666    4            END;    /* OF WHILE */

   4666  3 001776   000000 470400 xsym               LDP0    P_PCB
         3 001777   200017 235100                    LDA     INDX,,AUTO
         3 002000   040000 106505                    CMPC    fill='040'O
         3 002001   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         3 002002   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 002003   001773 600000 3                  TZE     s:4665

     1968     4667    3             IF MATCH_ADD

   4667  3 002004   200040 234100                    SZN     MATCH_ADD,,AUTO
         3 002005   002101 605000 3                  TPL     s:4681

     1969     4668    4               THEN DO;

     1970     4669    4                 CALL INDEX(JJ,' ',SUBSTR(TEXTBASE,INDX,P_PCB.NCHARS-INDX));

   4669  3 002006   000011 236000 xsym               LDQ     P_PCB+9
         3 002007   200017 136100                    SBLQ    INDX,,AUTO
         3 002010   000000 620006                    EAX0    0,QL
         3 002011   000000 124545                    SCM     mask='000'O
         3 002012   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:362  
         3 002013   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 002014   200043 000100                    ARG     JJ,,AUTO

     1971     4670    5                 DO WHILE (SUBSTR(TEXTBASE,JJ,1) = ' ');

   4670  3 002015   002021 710000 3                  TRA     s:4672

     1972     4671    5                   JJ = JJ + 1;

   4671  3 002016   200043 235100                    LDA     JJ,,AUTO
         3 002017   000001 035007                    ADLA    1,DL
         3 002020   200043 755100                    STA     JJ,,AUTO

     1973     4672    5                 END;

   4672  3 002021   000000 470400 xsym               LDP0    P_PCB
         3 002022   200043 235100                    LDA     JJ,,AUTO
         3 002023   040000 106505                    CMPC    fill='040'O
         3 002024   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         3 002025   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 002026   002016 600000 3                  TZE     s:4671

     1974     4673    4                 JJ = JJ + INDX;

   4673  3 002027   200043 236100                    LDQ     JJ,,AUTO
         3 002030   200017 036100                    ADLQ    INDX,,AUTO
         3 002031   200043 756100                    STQ     JJ,,AUTO

     1975     4674    4                 JJ = P_PCB.NCHARS - JJ;

   4674  3 002032   000011 236000 xsym               LDQ     P_PCB+9
         3 002033   200043 136100                    SBLQ    JJ,,AUTO
         3 002034   200043 756100                    STQ     JJ,,AUTO

     1976     4675    4                 TH_LAST_MATCH.COUNT = TH_LAST_MATCH.COUNT + JJ + 1;

   4675  3 002035   000000 236000 xsym               LDQ     TH_LAST_MATCH
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:363  
         3 002036   000033 772000                    QRL     27
         3 002037   200043 036100                    ADLQ    JJ,,AUTO
         3 002040   000001 036007                    ADLQ    1,DL
         3 002041   000033 736000                    QLS     27
         3 002042   000000 552040 xsym               STBQ    TH_LAST_MATCH,'40'O

     1977     4676    4                 CALL INSERT(TH_LAST_MATCH.TEXT,,,SUBSTR(TH_LAST_MATCH.TEXT,

   4676  3 002043   000000 236000 xsym               LDQ     TH_LAST_MATCH
         3 002044   000033 772000                    QRL     27
         3 002045   200043 136100                    SBLQ    JJ,,AUTO
         3 002046   200104 756100                    STQ     C_TEST+31,,AUTO
         3 002047   000011 236000 xsym               LDQ     P_PCB+9
         3 002050   200043 136100                    SBLQ    JJ,,AUTO
         3 002051   200104 720100                    LXL0    C_TEST+31,,AUTO
         3 002052   777777 621010                    EAX1    -1,X0
         3 002053   040000 100440                    MLR     fill='040'O
         3 002054   000000 200011 xsym               ADSC9   TH_LAST_MATCH            cn=1,n=*X1
         3 002055   000000 200167 xsym               ADSC9   TH_LAST_MATCH            cn=1,n=119
         3 002056   200105 756100                    STQ     C_TEST+32,,AUTO
         3 002057   200104 236100                    LDQ     C_TEST+31,,AUTO
         3 002060   000170 116007                    CMPQ    120,DL
         3 002061   002100 605000 3                  TPL     s:4679
         3 002062   777607 622006                    EAX2    -121,QL
         3 002063   777777 662003                    ERX2    -1,DU
         3 002064   040046 100400                    MLR     fill='040'O
         3 002065   000035 000001 4                  ADSC9   29                       cn=0,n=1
         3 002066   000000 000012 xsym               ADSC9   TH_LAST_MATCH,Q          cn=0,n=*X2
         3 002067   000167 116007                    CMPQ    119,DL
         3 002070   002100 605000 3                  TPL     s:4679
         3 002071   777610 623006                    EAX3    -120,QL
         3 002072   777777 663003                    ERX3    -1,DU
         3 002073   200043 724100                    LXL4    JJ,,AUTO
         3 002074   200105 235100                    LDA     C_TEST+32,,AUTO
         3 002075   040046 100545                    MLR     fill='040'O
         3 002076   000000 000014                    ADSC9   0,A,PR0                  cn=0,n=*X4
         3 002077   000000 200013 xsym               ADSC9   TH_LAST_MATCH,Q          cn=1,n=*X3
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:364  

     1978     4677    4                             0,TH_LAST_MATCH.COUNT-JJ-1),',',SUBSTR(TEXTBASE,
     1979     4678    4                             P_PCB.NCHARS-JJ,JJ));
     1980     4679    4               END;

   4679  3 002100   004123 710000 3                  TRA     s:5121

     1981     4680    4               ELSE DO;

     1982     4681    4            TH_LAST_MATCH.COUNT = P_PCB.NCHARS-INDX;

   4681  3 002101   000011 236000 xsym               LDQ     P_PCB+9
         3 002102   200017 136100                    SBLQ    INDX,,AUTO
         3 002103   000033 736000                    QLS     27
         3 002104   000000 552040 xsym               STBQ    TH_LAST_MATCH,'40'O

     1983     4682    4            TH_LAST_MATCH.TEXT = SUBSTR(TEXTBASE,INDX,P_PCB.NCHARS-INDX);

   4682  3 002105   000011 236000 xsym               LDQ     P_PCB+9
         3 002106   200017 136100                    SBLQ    INDX,,AUTO
         3 002107   000000 620006                    EAX0    0,QL
         3 002110   040000 100545                    MLR     fill='040'O
         3 002111   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         3 002112   000000 200167 xsym               ADSC9   TH_LAST_MATCH            cn=1,n=119

     1984     4683    4            END;

     1985     4684    3       END;

   4684  3 002113   004123 710000 3                  TRA     s:5121

     1986     4685    2            CASE (%EXCLUDE);

     1987     4686                                               /* PROCESS EXCLUDE COMMAND         */
     1988     4687    2              EXCLUDE_DEL = %NO;

   4687  3 002114   200023 450100                    STZ     EXCLUDE_DEL,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:365  

     1989     4688    2            EXCLUDE_ADD = %NO;

   4688  3 002115   200041 450100                    STZ     EXCLUDE_ADD,,AUTO

     1990     4689    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %DELETEE

   4689  3 002116   100003 473500                    LDP3    3,,PR1
         3 002117   300000 721100                    LXL1    0,,PR3
         3 002120   000026 101003                    CMPX1   22,DU
         3 002121   002127 601000 3                  TNZ     s:4695

     1991     4690    3                 THEN DO;

     1992     4691    3                      EXCLUDE_DEL = %YES;

   4691  3 002122   400000 236003                    LDQ     -131072,DU
         3 002123   200023 756100                    STQ     EXCLUDE_DEL,,AUTO

     1993     4692    3                      J = 1;

   4692  3 002124   000001 235007                    LDA     1,DL
         3 002125   200005 755100                    STA     J,,AUTO

     1994     4693    3                      END;

   4693  3 002126   002162 710000 3                  TRA     s:4712

     1995     4694    2                 ELSE
     1996     4695    2                      IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %ADDD

   4695  3 002127   000013 101003                    CMPX1   11,DU
         3 002130   002136 601000 3                  TNZ     s:4701

     1997     4696    3                           THEN DO;

     1998     4697    3                                J = 1;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:366  

   4697  3 002131   000001 235007                    LDA     1,DL
         3 002132   200005 755100                    STA     J,,AUTO

     1999     4698    3                                EXCLUDE_ADD = %YES;

   4698  3 002133   400000 236003                    LDQ     -131072,DU
         3 002134   200041 756100                    STQ     EXCLUDE_ADD,,AUTO

     2000     4699    3                                END;

   4699  3 002135   002162 710000 3                  TRA     s:4712

     2001     4700    3                           ELSE DO;

     2002     4701    3                                J = 0;

   4701  3 002136   200005 450100                    STZ     J,,AUTO

     2003     4702    3                                TH_CONSTRAINTS.E_BY_B_SET = %NO;

   4702  3 002137   003000 060400                    CSL     bolr='003'O
         3 002140   000002 000011 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=9
         3 002141   000050 010440 xsym               BDSC    TH_CONSTRAINTS+40        by=0,bit=1,n=288

     2004     4703    3                                TH_CONSTRAINTS.E_MAJ_S = %NO;

   4703  3 002142   000036 236000 4                  LDQ     30
         3 002143   000036 356000 xsym               ANSQ    TH_CONSTRAINTS+30

     2005     4704    3                                TH_CONSTRAINTS.E_SUB_S = %NO;

   4704  3 002144   000037 236000 4                  LDQ     31
         3 002145   000036 356000 xsym               ANSQ    TH_CONSTRAINTS+30

     2006     4705    3                                TH_CONSTRAINTS.E_MED_S = %NO;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:367  
   4705  3 002146   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 002147   000040 356000 xsym               ANSQ    TH_CONSTRAINTS+32

     2007     4706    3                                TH_CONSTRAINTS.E_FEP_SET = %NO;

   4706  3 002150   000002 236000 4                  LDQ     2
         3 002151   000063 356000 xsym               ANSQ    TH_CONSTRAINTS+51

     2008     4707    3                                TH_CONSTRAINTS.E_CHAN_SET = %NO;

   4707  3 002152   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 002153   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53

     2009     4708    3                                TH_CONSTRAINTS.E_COD_SET = %NO;

   4708  3 002154   000040 236000 4                  LDQ     32
         3 002155   000066 356000 xsym               ANSQ    TH_CONSTRAINTS+54

     2010     4709    3                                TH_CONSTRAINTS.E_REA_SET = %NO;

   4709  3 002156   000037 236000 4                  LDQ     31
         3 002157   000066 356000 xsym               ANSQ    TH_CONSTRAINTS+54

     2011     4710    3                                TH_CONSTRAINTS.E_ACT_SET = %NO;

   4710  3 002160   000041 236000 4                  LDQ     33
         3 002161   000066 356000 xsym               ANSQ    TH_CONSTRAINTS+54

     2012     4711    3                                END;

     2013     4712    3              DO I = J TO OUT$BLK.NSUBLKS - 1;

   4712  3 002162   200005 235100                    LDA     J,,AUTO
         3 002163   200004 755100                    STA     I,,AUTO
         3 002164   003566 710000 3                  TRA     s:4998+1

     2014     4713    3                 TEMP$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:368  

   4713  3 002165   200003 470500                    LDP0    @TOP$,,AUTO
         3 002166   000000 471500                    LDP1    0,,PR0
         3 002167   200004 720100                    LXL0    I,,AUTO
         3 002170   100003 473510                    LDP3    3,X0,PR1
         3 002171   300003 236100                    LDQ     3,,PR3
         3 002172   200021 756100                    STQ     TEMP$,,AUTO

     2015     4714    4                 DO CASE(TEMP$->OUT$BLK.CODE);

   4714  3 002173   200021 474500                    LDP4    TEMP$,,AUTO
         3 002174   400000 721100                    LXL1    0,,PR4
         3 002175   000012 101003                    CMPX1   10,DU
         3 002176   002200 602011 3                  TNC     s:4714+5,X1
         3 002177   003442 710000 3                  TRA     s:4971
         3 002200   003442 710000 3                  TRA     s:4971
         3 002201   002212 710000 3                  TRA     s:4716
         3 002202   002325 710000 3                  TRA     s:4744
         3 002203   002742 710000 3                  TRA     s:4836
         3 002204   003011 710000 3                  TRA     s:4851
         3 002205   003254 710000 3                  TRA     s:4923
         3 002206   003332 710000 3                  TRA     s:4941
         3 002207   002451 710000 3                  TRA     s:4773
         3 002210   002554 710000 3                  TRA     s:4796
         3 002211   002660 710000 3                  TRA     s:4819

     2016     4715    4                    CASE(%MAJ);

     2017     4716    4                      IF TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 2

   4716  3 002212   400003 475500                    LDP5    3,,PR4
         3 002213   500004 236100                    LDQ     4,,PR5
         3 002214   777000 376003                    ANQ     -512,DU
         3 002215   002000 116003                    CMPQ    1024,DU
         3 002216   002244 601000 3                  TNZ     s:4726

     2018     4717    5                        THEN DO;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:369  

     2019     4718    5                           SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4718  3 002217   500004 236100                    LDQ     4,,PR5
         3 002220   000033 772000                    QRL     27
         3 002221   000000 622006                    EAX2    0,QL
         3 002222   040100 100540                    MLR     fill='040'O
         3 002223   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 002224   200025 000003                    ADSC9   SUB,,AUTO                cn=0,n=3

     2020     4719    5                           CALL CHARBIN(SUB_BIN,SUBB(0));

   4719  3 002225   000100 305500                    DTB
         3 002226   200025 030001                    NDSC9   SUB,,AUTO                cn=0,s=nosgn,sf=0,n=1
         3 002227   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     2021     4720    5                           VALUE = SUB_BIN * 8;

   4720  3 002230   200026 235100                    LDA     SUB_BIN,,AUTO
         3 002231   000003 735000                    ALS     3
         3 002232   200020 755100                    STA     VALUE,,AUTO

     2022     4721    5                           CALL CHARBIN(SUB_BIN,SUBB(1));

   4721  3 002233   000100 305500                    DTB
         3 002234   200025 230001                    NDSC9   SUB,,AUTO                cn=1,s=nosgn,sf=0,n=1
         3 002235   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     2023     4722    5                           VALUE = VALUE + SUB_BIN;

   4722  3 002236   200020 236100                    LDQ     VALUE,,AUTO
         3 002237   200026 036100                    ADLQ    SUB_BIN,,AUTO
         3 002240   200020 756100                    STQ     VALUE,,AUTO

     2024     4723    5                           MAJOR = VALUE;

   4723  3 002241   000036 736000                    QLS     30
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:370  
         3 002242   200024 756100                    STQ     MAJOR,,AUTO

     2025     4724    5                           END;

   4724  3 002243   002256 710000 3                  TRA     s:4730

     2026     4725    5                        ELSE DO;

     2027     4726    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)

   4726  3 002244   500004 236100                    LDQ     4,,PR5
         3 002245   000033 772000                    QRL     27
         3 002246   000000 622006                    EAX2    0,QL
         3 002247   000100 305540                    DTB
         3 002250   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 002251   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 002252   200105 235100                    LDA     C_TEST+32,,AUTO
         3 002253   200020 755100                    STA     VALUE,,AUTO

     2028     4727    5                                        ->OUT$SYM.TEXT);
     2029     4728    5                           MAJOR = VALUE;

   4728  3 002254   000036 735000                    ALS     30
         3 002255   200024 755100                    STA     MAJOR,,AUTO

     2030     4729    5                           END;

     2031     4730    4                      IF EXCLUDE_DEL

   4730  3 002256   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 002257   002311 605000 3                  TPL     s:4739

     2032     4731    4                        THEN
     2033     4732    4                          IF ((TH_CONSTRAINTS.E_MAJ_S) & (MAJOR=TH_CONSTRAINTS.E_MAJ))

   4732  3 002260   400000 221003                    LDX1    -131072,DU
         3 002261   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:371  
         3 002262   000035 772000                    QRL     29
         3 002263   000077 376007                    ANQ     63,DL
         3 002264   200104 756100                    STQ     C_TEST+31,,AUTO
         3 002265   200024 236100                    LDQ     MAJOR,,AUTO
         3 002266   000036 772000                    QRL     30
         3 002267   200104 116100                    CMPQ    C_TEST+31,,AUTO
         3 002270   002272 600000 3                  TZE     s:4732+10
         3 002271   000000 221003                    LDX1    0,DU
         3 002272   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         3 002273   000007 736000                    QLS     7
         3 002274   400000 376003                    ANQ     -131072,DU
         3 002275   200105 756100                    STQ     C_TEST+32,,AUTO
         3 002276   000000 636011                    EAQ     0,X1
         3 002277   200105 376100                    ANQ     C_TEST+32,,AUTO
         3 002300   002304 600000 3                  TZE     s:4735

     2034     4733    4                             THEN TH_CONSTRAINTS.E_MAJ_S = %NO;

   4733  3 002301   000036 236000 4                  LDQ     30
         3 002302   000036 356000 xsym               ANSQ    TH_CONSTRAINTS+30
         3 002303   002320 710000 3                  TRA     s:4742

     2035     4734    5                             ELSE DO;

     2036     4735    5                                  CALL THM$ERRMSG(%E$TH_BAD_MAJ);

   4735  3 002304   000007 630400 4                  EPPR0   7
         3 002305   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002306   000000 701000 xent               TSX1    THM$ERRMSG
         3 002307   000000 011000                    NOP     0

     2037     4736    5                                  ALTRETURN;

   4736  3 002310   000000 702200 xent               TSX2  ! X66_AALT

     2038     4737    5                                  END;
     2039     4738    5                        ELSE DO;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:372  

     2040     4739    5                             TH_CONSTRAINTS.E_MAJ_S = %YES;

   4739  3 002311   002000 236003                    LDQ     1024,DU
         3 002312   000036 256000 xsym               ORSQ    TH_CONSTRAINTS+30

     2041     4740    5                             TH_CONSTRAINTS.E_MAJ = MAJOR;

   4740  3 002313   200024 236100                    LDQ     MAJOR,,AUTO
         3 002314   000001 772000                    QRL     1
         3 002315   000036 676000 xsym               ERQ     TH_CONSTRAINTS+30
         3 002316   374000 376003                    ANQ     129024,DU
         3 002317   000036 656000 xsym               ERSQ    TH_CONSTRAINTS+30

     2042     4741    5                             END;

     2043     4742    4                      DEL_TEST = 'MAJ';

   4742  3 002320   000000 236000 2                  LDQ     0
         3 002321   000010 376000 4                  ANQ     8
         3 002322   000040 276007                    ORQ     32,DL
         3 002323   200042 756100                    STQ     DEL_TEST,,AUTO
         3 002324   003442 710000 3                  TRA     s:4971

     2044     4743    4                    CASE(%SUB);

     2045     4744    4                     IF TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT = 2

   4744  3 002325   400003 475500                    LDP5    3,,PR4
         3 002326   500004 236100                    LDQ     4,,PR5
         3 002327   777000 376003                    ANQ     -512,DU
         3 002330   002000 116003                    CMPQ    1024,DU
         3 002331   002362 601000 3                  TNZ     s:4753

     2046     4745    5                      THEN DO;

     2047     4746    5                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:373  

   4746  3 002332   500004 236100                    LDQ     4,,PR5
         3 002333   000033 772000                    QRL     27
         3 002334   000000 622006                    EAX2    0,QL
         3 002335   040100 100540                    MLR     fill='040'O
         3 002336   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 002337   200025 000003                    ADSC9   SUB,,AUTO                cn=0,n=3

     2048     4747    5                      CALL CHARBIN(SUB_BIN,SUBB(0));

   4747  3 002340   000100 305500                    DTB
         3 002341   200025 030001                    NDSC9   SUB,,AUTO                cn=0,s=nosgn,sf=0,n=1
         3 002342   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     2049     4748    5                      SUB_BIT.ONE = BINBIT(SUB_BIN,3);

   4748  3 002343   200026 236100                    LDQ     SUB_BIN,,AUTO
         3 002344   000041 736000                    QLS     33
         3 002345   200027 676100                    ERQ     SUB_BIT,,AUTO
         3 002346   700000 376003                    ANQ     -32768,DU
         3 002347   200027 656100                    ERSQ    SUB_BIT,,AUTO

     2050     4749    5                      CALL CHARBIN(SUB_BIN,SUBB(1));

   4749  3 002350   000100 305500                    DTB
         3 002351   200025 230001                    NDSC9   SUB,,AUTO                cn=1,s=nosgn,sf=0,n=1
         3 002352   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     2051     4750    5                      SUB_BIT.TWO = BINBIT(SUB_BIN,3);

   4750  3 002353   200026 236100                    LDQ     SUB_BIN,,AUTO
         3 002354   000041 736000                    QLS     33
         3 002355   000003 772000                    QRL     3
         3 002356   200027 676100                    ERQ     SUB_BIT,,AUTO
         3 002357   070000 376003                    ANQ     28672,DU
         3 002360   200027 656100                    ERSQ    SUB_BIT,,AUTO

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:374  
     2052     4751    5                      END;

   4751  3 002361   002406 710000 3                  TRA     s:4759

     2053     4752    5                      ELSE DO;

     2054     4753    5                           SUB_BIN = 0;

   4753  3 002362   200026 450100                    STZ     SUB_BIN,,AUTO

     2055     4754    5                           SUB_BIT.ONE = BINBIT(SUB_BIN,3);

   4754  3 002363   200026 236100                    LDQ     SUB_BIN,,AUTO
         3 002364   000041 736000                    QLS     33
         3 002365   200027 676100                    ERQ     SUB_BIT,,AUTO
         3 002366   700000 376003                    ANQ     -32768,DU
         3 002367   200027 656100                    ERSQ    SUB_BIT,,AUTO

     2056     4755    5                           CALL CHARBIN(SUB_BIN,TEMP$->OUT$BLK.SUBLK$(0)

   4755  3 002370   500004 236100                    LDQ     4,,PR5
         3 002371   000033 772000                    QRL     27
         3 002372   000000 622006                    EAX2    0,QL
         3 002373   000100 305540                    DTB
         3 002374   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 002375   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 002376   200105 235100                    LDA     C_TEST+32,,AUTO
         3 002377   200026 755100                    STA     SUB_BIN,,AUTO

     2057     4756    5                                        ->OUT$SYM.TEXT);
     2058     4757    5                           SUB_BIT.TWO = BINBIT(SUB_BIN,3);

   4757  3 002400   200026 236100                    LDQ     SUB_BIN,,AUTO
         3 002401   000041 736000                    QLS     33
         3 002402   000003 772000                    QRL     3
         3 002403   200027 676100                    ERQ     SUB_BIT,,AUTO
         3 002404   070000 376003                    ANQ     28672,DU
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:375  
         3 002405   200027 656100                    ERSQ    SUB_BIT,,AUTO

     2059     4758    5                           END;

     2060     4759    4                      IF EXCLUDE_DEL

   4759  3 002406   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 002407   002435 605000 3                  TPL     s:4768

     2061     4760    4                        THEN
     2062     4761    4                          IF ((TH_CONSTRAINTS.E_SUB_S)&(SUBB_BIT=TH_CONSTRAINTS.E_SUB)
              4761                                    )

   4761  3 002410   400000 221003                    LDX1    -131072,DU
         3 002411   000000 066500                    CMPB    filb='0'B
         3 002412   200027 000006                    BDSC    SUB_BIT,,AUTO            by=0,bit=0,n=6
         3 002413   000036 100006 xsym               BDSC    TH_CONSTRAINTS+30        by=0,bit=8,n=6
         3 002414   002416 600000 3                  TZE     s:4761+6
         3 002415   000000 221003                    LDX1    0,DU
         3 002416   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         3 002417   000016 736000                    QLS     14
         3 002420   400000 376003                    ANQ     -131072,DU
         3 002421   200104 756100                    STQ     C_TEST+31,,AUTO
         3 002422   000000 636011                    EAQ     0,X1
         3 002423   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 002424   002430 600000 3                  TZE     s:4764

     2063     4762    4                             THEN TH_CONSTRAINTS.E_SUB_S = %NO;

   4762  3 002425   000037 236000 4                  LDQ     31
         3 002426   000036 356000 xsym               ANSQ    TH_CONSTRAINTS+30
         3 002427   002444 710000 3                  TRA     s:4771

     2064     4763    5                             ELSE DO;

     2065     4764    5                                  CALL THM$ERRMSG(%E$TH_BAD_SUB);

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:376  
   4764  3 002430   000012 630400 4                  EPPR0   10
         3 002431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002432   000000 701000 xent               TSX1    THM$ERRMSG
         3 002433   000000 011000                    NOP     0

     2066     4765    5                                  ALTRETURN;

   4765  3 002434   000000 702200 xent               TSX2  ! X66_AALT

     2067     4766    5                                  END;
     2068     4767    5                        ELSE DO;

     2069     4768    5                           TH_CONSTRAINTS.E_SUB_S = %YES;

   4768  3 002435   000010 236003                    LDQ     8,DU
         3 002436   000036 256000 xsym               ORSQ    TH_CONSTRAINTS+30

     2070     4769    5                           TH_CONSTRAINTS.E_SUB = SUBB_BIT;

   4769  3 002437   200027 236100                    LDQ     SUB_BIT,,AUTO
         3 002440   000010 772000                    QRL     8
         3 002441   000036 676000 xsym               ERQ     TH_CONSTRAINTS+30
         3 002442   001760 376003                    ANQ     1008,DU
         3 002443   000036 656000 xsym               ERSQ    TH_CONSTRAINTS+30

     2071     4770    5                           END;

     2072     4771    4                      DEL_TEST = 'SUB';

   4771  3 002444   000001 236000 2                  LDQ     1
         3 002445   000010 376000 4                  ANQ     8
         3 002446   000040 276007                    ORQ     32,DL
         3 002447   200042 756100                    STQ     DEL_TEST,,AUTO
         3 002450   003442 710000 3                  TRA     s:4971

     2073     4772    4                    CASE(%COD);

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:377  
     2074     4773    4                      VALUE = 0;

   4773  3 002451   200020 450100                    STZ     VALUE,,AUTO

     2075     4774    4                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4774  3 002452   400003 475500                    LDP5    3,,PR4
         3 002453   500004 236100                    LDQ     4,,PR5
         3 002454   000033 772000                    QRL     27
         3 002455   000000 622006                    EAX2    0,QL
         3 002456   040100 100540                    MLR     fill='040'O
         3 002457   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 002460   200025 000003                    ADSC9   SUB,,AUTO                cn=0,n=3

     2076     4775    5                      DO K = 0 TO TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;

   4775  3 002461   200006 450100                    STZ     K,,AUTO
         3 002462   002475 710000 3                  TRA     s:4779+1

     2077     4776    5                         VALUE = VALUE * 10;

   4776  3 002463   200020 236100                    LDQ     VALUE,,AUTO
         3 002464   000012 402007                    MPY     10,DL
         3 002465   200020 756100                    STQ     VALUE,,AUTO

     2078     4777    5                         CALL CHARBIN(SUB_BIN,SUBB(K));

   4777  3 002466   200006 235100                    LDA     K,,AUTO
         3 002467   000100 305505                    DTB
         3 002470   200025 030001                    NDSC9   SUB,A,AUTO               cn=0,s=nosgn,sf=0,n=1
         3 002471   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     2079     4778    5                         VALUE = VALUE + SUB_BIN;

   4778  3 002472   200026 036100                    ADLQ    SUB_BIN,,AUTO
         3 002473   200020 756100                    STQ     VALUE,,AUTO

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:378  
     2080     4779    5                      END;

   4779  3 002474   200006 054100                    AOS     K,,AUTO
         3 002475   200021 470500                    LDP0    TEMP$,,AUTO
         3 002476   000003 471500                    LDP1    3,,PR0
         3 002477   100004 236100                    LDQ     4,,PR1
         3 002500   000033 772000                    QRL     27
         3 002501   200006 116100                    CMPQ    K,,AUTO
         3 002502   002463 605400 3                  TPNZ    s:4776

     2081     4780    4                      FI_ERR = VALUE;

   4780  3 002503   200020 235100                    LDA     VALUE,,AUTO
         3 002504   000033 735000                    ALS     27
         3 002505   200030 755100                    STA     FI_ERR,,AUTO

     2082     4781    4                      IF EXCLUDE_DEL

   4781  3 002506   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 002507   002542 605000 3                  TPL     s:4791

     2083     4782    4                         THEN
     2084     4783    4                           IF ((TH_CONSTRAINTS.E_COD_SET) &

   4783  3 002510   400000 220003                    LDX0    -131072,DU
         3 002511   000065 235000 xsym               LDA     TH_CONSTRAINTS+53
         3 002512   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         3 002513   000040 773000                    LRL     32
         3 002514   000777 376007                    ANQ     511,DL
         3 002515   200104 756100                    STQ     C_TEST+31,,AUTO
         3 002516   200030 236100                    LDQ     FI_ERR,,AUTO
         3 002517   000033 772000                    QRL     27
         3 002520   200104 116100                    CMPQ    C_TEST+31,,AUTO
         3 002521   002523 600000 3                  TZE     s:4783+11
         3 002522   000000 220003                    LDX0    0,DU
         3 002523   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         3 002524   000004 736000                    QLS     4
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:379  
         3 002525   400000 376003                    ANQ     -131072,DU
         3 002526   200105 756100                    STQ     C_TEST+32,,AUTO
         3 002527   000000 636010                    EAQ     0,X0
         3 002530   200105 376100                    ANQ     C_TEST+32,,AUTO
         3 002531   002535 600000 3                  TZE     s:4787

     2085     4784    4                               (FI_ERR = TH_CONSTRAINTS.E_COD))
     2086     4785    4                               THEN TH_CONSTRAINTS.E_COD_SET = %NO;

   4785  3 002532   000040 236000 4                  LDQ     32
         3 002533   000066 356000 xsym               ANSQ    TH_CONSTRAINTS+54
         3 002534   002547 710000 3                  TRA     s:4794

     2087     4786    5                               ELSE DO;

     2088     4787    5                                 CALL THM$ERRMSG(%E$TH_BAD_COD);

   4787  3 002535   000014 630400 4                  EPPR0   12
         3 002536   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002537   000000 701000 xent               TSX1    THM$ERRMSG
         3 002540   000000 011000                    NOP     0

     2089     4788    5                                 ALTRETURN;

   4788  3 002541   000000 702200 xent               TSX2  ! X66_AALT

     2090     4789    5                               END;
     2091     4790    5                         ELSE DO;

     2092     4791    5                           TH_CONSTRAINTS.E_COD_SET = %YES;

   4791  3 002542   020000 236003                    LDQ     8192,DU
         3 002543   000066 256000 xsym               ORSQ    TH_CONSTRAINTS+54

     2093     4792    5                           TH_CONSTRAINTS.E_COD = FI_ERR;

   4792  3 002544   003000 060500                    CSL     bolr='003'O
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:380  
         3 002545   200030 000011                    BDSC    FI_ERR,,AUTO             by=0,bit=0,n=9
         3 002546   000065 640011 xsym               BDSC    TH_CONSTRAINTS+53        by=3,bit=4,n=9

     2094     4793    5                         END;

     2095     4794    4                         DEL_TEST = 'COD';

   4794  3 002547   000002 236000 2                  LDQ     2
         3 002550   000010 376000 4                  ANQ     8
         3 002551   000040 276007                    ORQ     32,DL
         3 002552   200042 756100                    STQ     DEL_TEST,,AUTO
         3 002553   003442 710000 3                  TRA     s:4971

     2096     4795    4                    CASE(%REA);

     2097     4796    4                      VALUE = 0;

   4796  3 002554   200020 450100                    STZ     VALUE,,AUTO

     2098     4797    4                      SUB = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4797  3 002555   400003 475500                    LDP5    3,,PR4
         3 002556   500004 236100                    LDQ     4,,PR5
         3 002557   000033 772000                    QRL     27
         3 002560   000000 622006                    EAX2    0,QL
         3 002561   040100 100540                    MLR     fill='040'O
         3 002562   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 002563   200025 000003                    ADSC9   SUB,,AUTO                cn=0,n=3

     2099     4798    5                      DO K = 0 TO TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;

   4798  3 002564   200006 450100                    STZ     K,,AUTO
         3 002565   002600 710000 3                  TRA     s:4802+1

     2100     4799    5                         VALUE = VALUE * 10;

   4799  3 002566   200020 236100                    LDQ     VALUE,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:381  
         3 002567   000012 402007                    MPY     10,DL
         3 002570   200020 756100                    STQ     VALUE,,AUTO

     2101     4800    5                         CALL CHARBIN(SUB_BIN,SUBB(K));

   4800  3 002571   200006 235100                    LDA     K,,AUTO
         3 002572   000100 305505                    DTB
         3 002573   200025 030001                    NDSC9   SUB,A,AUTO               cn=0,s=nosgn,sf=0,n=1
         3 002574   200026 000004                    NDSC9   SUB_BIN,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     2102     4801    5                         VALUE = VALUE + SUB_BIN;

   4801  3 002575   200026 036100                    ADLQ    SUB_BIN,,AUTO
         3 002576   200020 756100                    STQ     VALUE,,AUTO

     2103     4802    5                      END;

   4802  3 002577   200006 054100                    AOS     K,,AUTO
         3 002600   200021 470500                    LDP0    TEMP$,,AUTO
         3 002601   000003 471500                    LDP1    3,,PR0
         3 002602   100004 236100                    LDQ     4,,PR1
         3 002603   000033 772000                    QRL     27
         3 002604   200006 116100                    CMPQ    K,,AUTO
         3 002605   002566 605400 3                  TPNZ    s:4799

     2104     4803    4                      FI_ERR = VALUE;

   4803  3 002606   200020 235100                    LDA     VALUE,,AUTO
         3 002607   000033 735000                    ALS     27
         3 002610   200030 755100                    STA     FI_ERR,,AUTO

     2105     4804    4                      IF EXCLUDE_DEL

   4804  3 002611   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 002612   002644 605000 3                  TPL     s:4814

     2106     4805    4                         THEN
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:382  
     2107     4806    4                           IF ((TH_CONSTRAINTS.E_REA_SET) &

   4806  3 002613   400000 220003                    LDX0    -131072,DU
         3 002614   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         3 002615   000026 772000                    QRL     22
         3 002616   000777 376007                    ANQ     511,DL
         3 002617   200104 756100                    STQ     C_TEST+31,,AUTO
         3 002620   200030 236100                    LDQ     FI_ERR,,AUTO
         3 002621   000033 772000                    QRL     27
         3 002622   200104 116100                    CMPQ    C_TEST+31,,AUTO
         3 002623   002625 600000 3                  TZE     s:4806+10
         3 002624   000000 220003                    LDX0    0,DU
         3 002625   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         3 002626   000016 736000                    QLS     14
         3 002627   400000 376003                    ANQ     -131072,DU
         3 002630   200105 756100                    STQ     C_TEST+32,,AUTO
         3 002631   000000 636010                    EAQ     0,X0
         3 002632   200105 376100                    ANQ     C_TEST+32,,AUTO
         3 002633   002637 600000 3                  TZE     s:4810

     2108     4807    4                               (FI_ERR = TH_CONSTRAINTS.E_REA))
     2109     4808    4                               THEN TH_CONSTRAINTS.E_REA_SET = %NO;

   4808  3 002634   000037 236000 4                  LDQ     31
         3 002635   000066 356000 xsym               ANSQ    TH_CONSTRAINTS+54
         3 002636   002653 710000 3                  TRA     s:4817

     2110     4809    5                               ELSE DO;

     2111     4810    5                                 CALL THM$ERRMSG(%E$TH_BAD_REA);

   4810  3 002637   000016 630400 4                  EPPR0   14
         3 002640   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002641   000000 701000 xent               TSX1    THM$ERRMSG
         3 002642   000000 011000                    NOP     0

     2112     4811    5                                 ALTRETURN;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:383  

   4811  3 002643   000000 702200 xent               TSX2  ! X66_AALT

     2113     4812    5                               END;
     2114     4813    5                         ELSE DO;

     2115     4814    5                           TH_CONSTRAINTS.E_REA_SET = %YES;

   4814  3 002644   000010 236003                    LDQ     8,DU
         3 002645   000066 256000 xsym               ORSQ    TH_CONSTRAINTS+54

     2116     4815    5                           TH_CONSTRAINTS.E_REA = FI_ERR;

   4815  3 002646   200030 236100                    LDQ     FI_ERR,,AUTO
         3 002647   000005 772000                    QRL     5
         3 002650   000066 676000 xsym               ERQ     TH_CONSTRAINTS+54
         3 002651   017760 376003                    ANQ     8176,DU
         3 002652   000066 656000 xsym               ERSQ    TH_CONSTRAINTS+54

     2117     4816    5                         END;

     2118     4817    4                         DEL_TEST = 'REA';

   4817  3 002653   000003 236000 2                  LDQ     3
         3 002654   000010 376000 4                  ANQ     8
         3 002655   000040 276007                    ORQ     32,DL
         3 002656   200042 756100                    STQ     DEL_TEST,,AUTO
         3 002657   003442 710000 3                  TRA     s:4971

     2119     4818    4                    CASE(%ACT);

     2120     4819    4                      CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

   4819  3 002660   400003 475500                    LDP5    3,,PR4
         3 002661   500004 236100                    LDQ     4,,PR5
         3 002662   000033 772000                    QRL     27
         3 002663   000000 622006                    EAX2    0,QL
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:384  
         3 002664   000100 305540                    DTB
         3 002665   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 002666   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 002667   200105 235100                    LDA     C_TEST+32,,AUTO
         3 002670   200020 755100                    STA     VALUE,,AUTO

     2121     4820    4                      FI_ERR = VALUE;

   4820  3 002671   000033 735000                    ALS     27
         3 002672   200030 755100                    STA     FI_ERR,,AUTO

     2122     4821    4                      IF EXCLUDE_DEL

   4821  3 002673   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 002674   002726 605000 3                  TPL     s:4831

     2123     4822    4                         THEN
     2124     4823    4                           IF ((TH_CONSTRAINTS.E_ACT_SET) &

   4823  3 002675   400000 221003                    LDX1    -131072,DU
         3 002676   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         3 002677   000014 772000                    QRL     12
         3 002700   000777 376007                    ANQ     511,DL
         3 002701   200104 756100                    STQ     C_TEST+31,,AUTO
         3 002702   200030 236100                    LDQ     FI_ERR,,AUTO
         3 002703   000033 772000                    QRL     27
         3 002704   200104 116100                    CMPQ    C_TEST+31,,AUTO
         3 002705   002707 600000 3                  TZE     s:4823+10
         3 002706   000000 221003                    LDX1    0,DU
         3 002707   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         3 002710   000030 736000                    QLS     24
         3 002711   400000 376003                    ANQ     -131072,DU
         3 002712   200105 756100                    STQ     C_TEST+32,,AUTO
         3 002713   000000 636011                    EAQ     0,X1
         3 002714   200105 376100                    ANQ     C_TEST+32,,AUTO
         3 002715   002721 600000 3                  TZE     s:4827

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:385  
     2125     4824    4                               (FI_ERR = TH_CONSTRAINTS.E_ACT))
     2126     4825    4                               THEN TH_CONSTRAINTS.E_ACT_SET = %NO;

   4825  3 002716   000041 236000 4                  LDQ     33
         3 002717   000066 356000 xsym               ANSQ    TH_CONSTRAINTS+54
         3 002720   002735 710000 3                  TRA     s:4834

     2127     4826    5                               ELSE DO;

     2128     4827    5                                 CALL THM$ERRMSG(%E$TH_BAD_ACT);

   4827  3 002721   000021 630400 4                  EPPR0   17
         3 002722   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002723   000000 701000 xent               TSX1    THM$ERRMSG
         3 002724   000000 011000                    NOP     0

     2129     4828    5                                 ALTRETURN;

   4828  3 002725   000000 702200 xent               TSX2  ! X66_AALT

     2130     4829    5                               END;
     2131     4830    5                         ELSE DO;

     2132     4831    5                           TH_CONSTRAINTS.E_ACT_SET = %YES;

   4831  3 002726   004000 236007                    LDQ     2048,DL
         3 002727   000066 256000 xsym               ORSQ    TH_CONSTRAINTS+54

     2133     4832    5                           TH_CONSTRAINTS.E_ACT = FI_ERR;

   4832  3 002730   200030 236100                    LDQ     FI_ERR,,AUTO
         3 002731   000017 772000                    QRL     15
         3 002732   000066 676000 xsym               ERQ     TH_CONSTRAINTS+54
         3 002733   000042 376000 4                  ANQ     34
         3 002734   000066 656000 xsym               ERSQ    TH_CONSTRAINTS+54

     2134     4833    5                         END;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:386  

     2135     4834    4                         DEL_TEST = 'ACT';

   4834  3 002735   000004 236000 2                  LDQ     4
         3 002736   000010 376000 4                  ANQ     8
         3 002737   000040 276007                    ORQ     32,DL
         3 002740   200042 756100                    STQ     DEL_TEST,,AUTO
         3 002741   003442 710000 3                  TRA     s:4971

     2136     4835    4                    CASE(%MED);

     2137     4836    4                      MEDIA = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4836  3 002742   400003 475500                    LDP5    3,,PR4
         3 002743   500004 236100                    LDQ     4,,PR5
         3 002744   000033 772000                    QRL     27
         3 002745   000000 622006                    EAX2    0,QL
         3 002746   040100 100540                    MLR     fill='040'O
         3 002747   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 002750   200031 000006                    ADSC9   MEDIA,,AUTO              cn=0,n=6

     2138     4837    4                      IF (EXCLUDE_DEL)

   4837  3 002751   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 002752   002777 605000 3                  TPL     s:4846

     2139     4838    4                        THEN
     2140     4839    4                           IF ((TH_CONSTRAINTS.E_MED_S)&(MEDIA=TH_CONSTRAINTS.E_MED))

   4839  3 002753   400000 223003                    LDX3    -131072,DU
         3 002754   040000 106500                    CMPC    fill='040'O
         3 002755   200031 000006                    ADSC9   MEDIA,,AUTO              cn=0,n=6
         3 002756   000036 400006 xsym               ADSC9   TH_CONSTRAINTS+30        cn=2,n=6
         3 002757   002761 600000 3                  TZE     s:4839+6
         3 002760   000000 223003                    LDX3    0,DU
         3 002761   000040 236000 xsym               LDQ     TH_CONSTRAINTS+32
         3 002762   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:387  
         3 002763   200104 756100                    STQ     C_TEST+31,,AUTO
         3 002764   000000 636013                    EAQ     0,X3
         3 002765   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 002766   002772 600000 3                  TZE     s:4842

     2141     4840    4                             THEN TH_CONSTRAINTS.E_MED_S = %NO;

   4840  3 002767   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 002770   000040 356000 xsym               ANSQ    TH_CONSTRAINTS+32
         3 002771   003004 710000 3                  TRA     s:4849

     2142     4841    5                             ELSE DO;

     2143     4842    5                                CALL THM$ERRMSG(%E$TH_BAD_MED);

   4842  3 002772   000023 630400 4                  EPPR0   19
         3 002773   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002774   000000 701000 xent               TSX1    THM$ERRMSG
         3 002775   000000 011000                    NOP     0

     2144     4843    5                                ALTRETURN;

   4843  3 002776   000000 702200 xent               TSX2  ! X66_AALT

     2145     4844    5                                END;
     2146     4845    5                        ELSE DO;

     2147     4846    5                           TH_CONSTRAINTS.E_MED_S = %YES;

   4846  3 002777   400000 236003                    LDQ     -131072,DU
         3 003000   000040 256000 xsym               ORSQ    TH_CONSTRAINTS+32

     2148     4847    5                           TH_CONSTRAINTS.E_MED = MEDIA;

   4847  3 003001   040000 100500                    MLR     fill='040'O
         3 003002   200031 000006                    ADSC9   MEDIA,,AUTO              cn=0,n=6
         3 003003   000036 400006 xsym               ADSC9   TH_CONSTRAINTS+30        cn=2,n=6
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:388  

     2149     4848    5                           END;

     2150     4849    4                      DEL_TEST = 'MED';

   4849  3 003004   000005 236000 2                  LDQ     5
         3 003005   000010 376000 4                  ANQ     8
         3 003006   000040 276007                    ORQ     32,DL
         3 003007   200042 756100                    STQ     DEL_TEST,,AUTO
         3 003010   003442 710000 3                  TRA     s:4971

     2151     4850    4                    CASE(%BY_B);

     2152     4851    4                      CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

   4851  3 003011   400003 475500                    LDP5    3,,PR4
         3 003012   500004 236100                    LDQ     4,,PR5
         3 003013   000033 772000                    QRL     27
         3 003014   000000 622006                    EAX2    0,QL
         3 003015   000100 305540                    DTB
         3 003016   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         3 003017   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 003020   200105 235100                    LDA     C_TEST+32,,AUTO
         3 003021   200020 755100                    STA     VALUE,,AUTO

     2153     4852    4                      IF VALUE > 25

   4852  3 003022   000032 115007                    CMPA    26,DL
         3 003023   003031 602000 3                  TNC     s:4857

     2154     4853    5                        THEN DO;

     2155     4854    5                           CALL THM$ERRMSG(%E$TH_BAD_BYTE);

   4854  3 003024   000025 630400 4                  EPPR0   21
         3 003025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003026   000000 701000 xent               TSX1    THM$ERRMSG
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:389  
         3 003027   000000 011000                    NOP     0

     2156     4855    5                           ALTRETURN;

   4855  3 003030   000000 702200 xent               TSX2  ! X66_AALT

     2157     4856    5                           END;
     2158     4857    4                      BYTE_SPEC = VALUE;

   4857  3 003031   200014 755100                    STA     BYTE_SPEC,,AUTO

     2159     4858    5                      DO CASE(TEMP$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE);

   4858  3 003032   400004 471500                    LDP1    4,,PR4
         3 003033   100000 721100                    LXL1    0,,PR1
         3 003034   000003 101003                    CMPX1   3,DU
         3 003035   003037 602011 3                  TNC     s:4858+5,X1
         3 003036   003247 710000 3                  TRA     s:4921
         3 003037   003247 710000 3                  TRA     s:4921
         3 003040   003042 710000 3                  TRA     s:4860
         3 003041   003152 710000 3                  TRA     s:4893

     2160     4859    5                         CASE(%BIT);

     2161     4860    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(1)

   4860  3 003042   100003 473500                    LDP3    3,,PR1
         3 003043   300004 236100                    LDQ     4,,PR3
         3 003044   000033 772000                    QRL     27
         3 003045   000000 622006                    EAX2    0,QL
         3 003046   000100 305540                    DTB
         3 003047   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         3 003050   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 003051   200105 236100                    LDQ     C_TEST+32,,AUTO
         3 003052   200020 756100                    STQ     VALUE,,AUTO

     2162     4861    5                                        ->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:390  
     2163     4862    5                           IF VALUE > 7

   4862  3 003053   000010 116007                    CMPQ    8,DL
         3 003054   003062 602000 3                  TNC     s:4867

     2164     4863    6                             THEN DO;

     2165     4864    6                                CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4864  3 003055   000027 630400 4                  EPPR0   23
         3 003056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003057   000000 701000 xent               TSX1    THM$ERRMSG
         3 003060   000000 011000                    NOP     0

     2166     4865    6                                ALTRETURN;

   4865  3 003061   000000 702200 xent               TSX2  ! X66_AALT

     2167     4866    6                                END;
     2168     4867    5                           FIRST_BIT = VALUE;

   4867  3 003062   200015 756100                    STQ     FIRST_BIT,,AUTO

     2169     4868    5                           CALL CHARBIN(VALUE,TEMP$->OUT$BLK.SUBLK$(1)

   4868  3 003063   400004 471500                    LDP1    4,,PR4
         3 003064   100004 473500                    LDP3    4,,PR1
         3 003065   300004 236100                    LDQ     4,,PR3
         3 003066   000033 772000                    QRL     27
         3 003067   000000 621006                    EAX1    0,QL
         3 003070   000100 305540                    DTB
         3 003071   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         3 003072   200104 000010                    NDSC9   C_TEST+31,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         3 003073   200105 236100                    LDQ     C_TEST+32,,AUTO
         3 003074   200020 756100                    STQ     VALUE,,AUTO

     2170     4869    5                                        ->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:391  
     2171     4870    5                           IF (VALUE = 0 OR VALUE = 1)

   4870  3 003075   003105 600000 3                  TZE     s:4876
         3 003076   000001 116007                    CMPQ    1,DL
         3 003077   003105 600000 3                  TZE     s:4876

     2172     4871    5                             THEN;
     2173     4872    6                             ELSE DO;

     2174     4873    6                                CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4873  3 003100   000027 630400 4                  EPPR0   23
         3 003101   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003102   000000 701000 xent               TSX1    THM$ERRMSG
         3 003103   000000 011000                    NOP     0

     2175     4874    6                                ALTRETURN;

   4874  3 003104   000000 702200 xent               TSX2  ! X66_AALT

     2176     4875    6                                END;
     2177     4876    5                           BIT_SPEC = BINBIT(VALUE,1);

   4876  3 003105   000043 736000                    QLS     35
         3 003106   200013 756100                    STQ     BIT_SPEC,,AUTO

     2178     4877    5                           INDX = (BYTE_SPEC) * 8 + FIRST_BIT;

   4877  3 003107   200014 236100                    LDQ     BYTE_SPEC,,AUTO
         3 003110   000003 736000                    QLS     3
         3 003111   200015 036100                    ADLQ    FIRST_BIT,,AUTO
         3 003112   200017 756100                    STQ     INDX,,AUTO

     2179     4878    5                           IF EXCLUDE_DEL

   4878  3 003113   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 003114   003143 605000 3                  TPL     s:4889
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:392  

     2180     4879    5                              THEN
     2181     4880    5                                IF ((TH_CONSTRAINTS.E_BY_B_SET(INDX)) &

   4880  3 003115   400000 221003                    LDX1    -131072,DU
         3 003116   000100 066406                    CMPB    filb='0'B
         3 003117   000040 010001 xsym               BDSC    TH_CONSTRAINTS+32,Q      by=0,bit=1,n=1
         3 003120   200013 000001                    BDSC    BIT_SPEC,,AUTO           by=0,bit=0,n=1
         3 003121   003123 600000 3                  TZE     s:4880+6
         3 003122   000000 221003                    LDX1    0,DU
         3 003123   003100 060406                    CSL     bolr='003'O
         3 003124   000050 010001 xsym               BDSC    TH_CONSTRAINTS+40,Q      by=0,bit=1,n=1
         3 003125   200104 000044                    BDSC    C_TEST+31,,AUTO          by=0,bit=0,n=36
         3 003126   000000 636011                    EAQ     0,X1
         3 003127   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 003130   003136 600000 3                  TZE     s:4885

     2182     4881    5                                    (TH_CONSTRAINTS.E_BY_B_VEC(INDX)=BIT_SPEC))
     2183     4882    5                                   THEN
     2184     4883    5                                     TH_CONSTRAINTS.E_BY_B_SET(INDX)=%NO;

   4883  3 003131   200017 236100                    LDQ     INDX,,AUTO
         3 003132   003006 060400                    CSL     bolr='003'O
         3 003133   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 003134   000050 010001 xsym               BDSC    TH_CONSTRAINTS+40,Q      by=0,bit=1,n=1
         3 003135   003247 710000 3                  TRA     s:4921

     2185     4884    6                                   ELSE DO;

     2186     4885    6                                     CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4885  3 003136   000027 630400 4                  EPPR0   23
         3 003137   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003140   000000 701000 xent               TSX1    THM$ERRMSG
         3 003141   000000 011000                    NOP     0

     2187     4886    6                                     ALTRETURN;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:393  

   4886  3 003142   000000 702200 xent               TSX2  ! X66_AALT

     2188     4887    6                                     END;
     2189     4888    6                              ELSE DO;

     2190     4889    6                                TH_CONSTRAINTS.E_BY_B_SET(INDX) = %YES;

   4889  3 003143   003006 060400                    CSL     bolr='003'O
         3 003144   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         3 003145   000050 010001 xsym               BDSC    TH_CONSTRAINTS+40,Q      by=0,bit=1,n=1

     2191     4890    6                                TH_CONSTRAINTS.E_BY_B_VEC(INDX) = BIT_SPEC;

   4890  3 003146   003006 060500                    CSL     bolr='003'O
         3 003147   200013 000001                    BDSC    BIT_SPEC,,AUTO           by=0,bit=0,n=1
         3 003150   000040 010001 xsym               BDSC    TH_CONSTRAINTS+32,Q      by=0,bit=1,n=1

     2192     4891    6                                END;

   4891  3 003151   003247 710000 3                  TRA     s:4921

     2193     4892    5                         CASE(%BIT_STR);

     2194     4893    5                           TEMP = TEMP$->OUT$BLK.SUBLK$(1)->

   4893  3 003152   100003 473500                    LDP3    3,,PR1
         3 003153   300004 236100                    LDQ     4,,PR3
         3 003154   000033 772000                    QRL     27
         3 003155   000000 622006                    EAX2    0,QL
         3 003156   040100 100540                    MLR     fill='040'O
         3 003157   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         3 003160   200033 000010                    ADSC9   TEMP,,AUTO               cn=0,n=8

     2195     4894    5                                  OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2196     4895    6                        DO K = 0 TO 7;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:394  
   4895  3 003161   200006 450100                    STZ     K,,AUTO

     2197     4896    6                        CALL CHARBIN(VALUE,TEMPP(K));

   4896  3 003162   200006 235100                    LDA     K,,AUTO
         3 003163   000100 305505                    DTB
         3 003164   200033 030001                    NDSC9   TEMP,A,AUTO              cn=0,s=nosgn,sf=0,n=1
         3 003165   200020 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4

     2198     4897    6                             IF (VALUE = 0 OR VALUE = 1)

   4897  3 003166   200020 236100                    LDQ     VALUE,,AUTO
         3 003167   003177 600000 3                  TZE     s:4903
         3 003170   000001 116007                    CMPQ    1,DL
         3 003171   003177 600000 3                  TZE     s:4903

     2199     4898    6                                THEN;
     2200     4899    7                                ELSE DO;

     2201     4900    7                                     CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4900  3 003172   000027 630400 4                  EPPR0   23
         3 003173   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003174   000000 701000 xent               TSX1    THM$ERRMSG
         3 003175   000000 011000                    NOP     0

     2202     4901    7                                     ALTRETURN;

   4901  3 003176   000000 702200 xent               TSX2  ! X66_AALT

     2203     4902    7                                     END;
     2204     4903    6                             BIT_SPEC = BINBIT(VALUE,1);

   4903  3 003177   000043 736000                    QLS     35
         3 003200   200013 756100                    STQ     BIT_SPEC,,AUTO

     2205     4904    6                        INDX = (BYTE_SPEC) * 8 + K;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:395  

   4904  3 003201   200014 236100                    LDQ     BYTE_SPEC,,AUTO
         3 003202   000003 736000                    QLS     3
         3 003203   200006 036100                    ADLQ    K,,AUTO
         3 003204   200017 756100                    STQ     INDX,,AUTO

     2206     4905    6                             IF EXCLUDE_DEL

   4905  3 003205   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 003206   003235 605000 3                  TPL     s:4916

     2207     4906    6                                THEN
     2208     4907    6                                  IF ((TH_CONSTRAINTS.E_BY_B_SET(INDX)) &

   4907  3 003207   400000 220003                    LDX0    -131072,DU
         3 003210   000100 066406                    CMPB    filb='0'B
         3 003211   000040 010001 xsym               BDSC    TH_CONSTRAINTS+32,Q      by=0,bit=1,n=1
         3 003212   200013 000001                    BDSC    BIT_SPEC,,AUTO           by=0,bit=0,n=1
         3 003213   003215 600000 3                  TZE     s:4907+6
         3 003214   000000 220003                    LDX0    0,DU
         3 003215   003100 060406                    CSL     bolr='003'O
         3 003216   000050 010001 xsym               BDSC    TH_CONSTRAINTS+40,Q      by=0,bit=1,n=1
         3 003217   200104 000044                    BDSC    C_TEST+31,,AUTO          by=0,bit=0,n=36
         3 003220   000000 636010                    EAQ     0,X0
         3 003221   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 003222   003230 600000 3                  TZE     s:4912

     2209     4908    6                                     (TH_CONSTRAINTS.E_BY_B_VEC(INDX)=BIT_SPEC))
     2210     4909    6                                     THEN
     2211     4910    6                                       TH_CONSTRAINTS.E_BY_B_SET(INDX)=%NO;

   4910  3 003223   200017 236100                    LDQ     INDX,,AUTO
         3 003224   003006 060400                    CSL     bolr='003'O
         3 003225   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         3 003226   000050 010001 xsym               BDSC    TH_CONSTRAINTS+40,Q      by=0,bit=1,n=1
         3 003227   003243 710000 3                  TRA     s:4919

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:396  
     2212     4911    7                                     ELSE DO;

     2213     4912    7                                       CALL THM$ERRMSG(%E$TH_BAD_BIT);

   4912  3 003230   000027 630400 4                  EPPR0   23
         3 003231   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003232   000000 701000 xent               TSX1    THM$ERRMSG
         3 003233   000000 011000                    NOP     0

     2214     4913    7                                       ALTRETURN;

   4913  3 003234   000000 702200 xent               TSX2  ! X66_AALT

     2215     4914    7                                       END;
     2216     4915    7                                ELSE DO;

     2217     4916    7                                     TH_CONSTRAINTS.E_BY_B_SET(INDX)=%YES;

   4916  3 003235   003006 060400                    CSL     bolr='003'O
         3 003236   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         3 003237   000050 010001 xsym               BDSC    TH_CONSTRAINTS+40,Q      by=0,bit=1,n=1

     2218     4917    7                                     TH_CONSTRAINTS.E_BY_B_VEC(INDX)=BIT_SPEC;

   4917  3 003240   003006 060500                    CSL     bolr='003'O
         3 003241   200013 000001                    BDSC    BIT_SPEC,,AUTO           by=0,bit=0,n=1
         3 003242   000040 010001 xsym               BDSC    TH_CONSTRAINTS+32,Q      by=0,bit=1,n=1

     2219     4918    7                                     END;

     2220     4919    6                           END;

   4919  3 003243   200006 054100                    AOS     K,,AUTO
         3 003244   200006 235100                    LDA     K,,AUTO
         3 003245   000007 115007                    CMPA    7,DL
         3 003246   003162 604400 3                  TMOZ    s:4896

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:397  
     2221     4920    5                      END;                /* DO CASE */

     2222     4921    4                      DEL_TEST = 'BYT';

   4921  3 003247   000006 236000 2                  LDQ     6
         3 003250   000010 376000 4                  ANQ     8
         3 003251   000040 276007                    ORQ     32,DL
         3 003252   200042 756100                    STQ     DEL_TEST,,AUTO
         3 003253   003442 710000 3                  TRA     s:4971

     2223     4922    4                    CASE(%FEP_CODE);

     2224     4923    4                      FEP_CODE = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4923  3 003254   400003 475500                    LDP5    3,,PR4
         3 003255   500004 236100                    LDQ     4,,PR5
         3 003256   000033 772000                    QRL     27
         3 003257   000000 622006                    EAX2    0,QL
         3 003260   040100 100540                    MLR     fill='040'O
         3 003261   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 003262   200035 000003                    ADSC9   FEP_CODE,,AUTO           cn=0,n=3

     2225     4924    4                      IF EXCLUDE_DEL

   4924  3 003263   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 003264   003312 605000 3                  TPL     s:4934

     2226     4925    4                        THEN
     2227     4926    4                           IF ((TH_CONSTRAINTS.E_FEP_SET) &

   4926  3 003265   400000 223003                    LDX3    -131072,DU
         3 003266   040100 106400                    CMPC    fill='040'O
         3 003267   000062 600003 xsym               ADSC9   TH_CONSTRAINTS+50        cn=3,n=3
         3 003270   200035 000003                    ADSC9   FEP_CODE,,AUTO           cn=0,n=3
         3 003271   003273 600000 3                  TZE     s:4926+6
         3 003272   000000 223003                    LDX3    0,DU
         3 003273   000063 236000 xsym               LDQ     TH_CONSTRAINTS+51
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:398  
         3 003274   000022 736000                    QLS     18
         3 003275   400000 376003                    ANQ     -131072,DU
         3 003276   200104 756100                    STQ     C_TEST+31,,AUTO
         3 003277   000000 636013                    EAQ     0,X3
         3 003300   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 003301   003305 600000 3                  TZE     s:4930

     2228     4927    4                               (TH_CONSTRAINTS.E_FEP = FEP_CODE))
     2229     4928    4                             THEN TH_CONSTRAINTS.E_FEP_SET = %NO;

   4928  3 003302   000002 236000 4                  LDQ     2
         3 003303   000063 356000 xsym               ANSQ    TH_CONSTRAINTS+51
         3 003304   003325 710000 3                  TRA     s:4939

     2230     4929    5                             ELSE DO;

     2231     4930    5                                CALL THM$ERRMSG(%E$TH_BAD_FEP);

   4930  3 003305   000031 630400 4                  EPPR0   25
         3 003306   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003307   000000 701000 xent               TSX1    THM$ERRMSG
         3 003310   000000 011000                    NOP     0

     2232     4931    5                                ALTRETURN;

   4931  3 003311   000000 702200 xent               TSX2  ! X66_AALT

     2233     4932    5                             END;
     2234     4933    5                        ELSE DO;

     2235     4934    5                           TH_CONSTRAINTS.E_FEP_SET = %YES;

   4934  3 003312   400000 236007                    LDQ     -131072,DL
         3 003313   000063 256000 xsym               ORSQ    TH_CONSTRAINTS+51

     2236     4935    5                           TH_CONSTRAINTS.E_FEP = FEP_CODE;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:399  
   4935  3 003314   040000 100500                    MLR     fill='040'O
         3 003315   200035 000003                    ADSC9   FEP_CODE,,AUTO           cn=0,n=3
         3 003316   000062 600003 xsym               ADSC9   TH_CONSTRAINTS+50        cn=3,n=3

     2237     4936    5                           TH_CONSTRAINTS.E_FEP_N = TEMP$->OUT$BLK.SUBLK$(0)

   4936  3 003317   400003 471500                    LDP1    3,,PR4
         3 003320   100004 236100                    LDQ     4,,PR1
         3 003321   000023 772000                    QRL     19
         3 003322   000063 676000 xsym               ERQ     TH_CONSTRAINTS+51
         3 003323   377400 376007                    ANQ     130816,DL
         3 003324   000063 656000 xsym               ERSQ    TH_CONSTRAINTS+51

     2238     4937    5                                                    ->OUT$SYM.COUNT;
     2239     4938    5                           END;

     2240     4939    4                      DEL_TEST = 'FCG';

   4939  3 003325   000007 236000 2                  LDQ     7
         3 003326   000010 376000 4                  ANQ     8
         3 003327   000040 276007                    ORQ     32,DL
         3 003330   200042 756100                    STQ     DEL_TEST,,AUTO
         3 003331   003442 710000 3                  TRA     s:4971

     2241     4940    4                    CASE(%FEP_CHAN);

     2242     4941    4                      FEP_CHAN = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   4941  3 003332   400003 475500                    LDP5    3,,PR4
         3 003333   500004 236100                    LDQ     4,,PR5
         3 003334   000033 772000                    QRL     27
         3 003335   000000 622006                    EAX2    0,QL
         3 003336   040100 100540                    MLR     fill='040'O
         3 003337   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         3 003340   200036 000004                    ADSC9   FEP_CHAN,,AUTO           cn=0,n=4

     2243     4942    4                      J = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:400  

   4942  3 003341   200005 756100                    STQ     J,,AUTO

     2244     4943    5                      DO CASE (J);

   4943  3 003342   000005 116007                    CMPQ    5,DL
         3 003343   003345 602006 3                  TNC     s:4943+3,QL
         3 003344   003400 710000 3                  TRA     s:4953
         3 003345   003400 710000 3                  TRA     s:4953
         3 003346   003352 710000 3                  TRA     s:4945
         3 003347   003362 710000 3                  TRA     s:4947
         3 003350   003367 710000 3                  TRA     s:4949
         3 003351   003375 710000 3                  TRA     s:4951

     2245     4944    5                        CASE(1);

     2246     4945    5                           CALL CONCAT(FEP_CHAN_N,'000',SUBSTR(FEP_CHAN,0,1));

   4945  3 003352   000010 236000 2                  LDQ     8
         3 003353   000010 376000 4                  ANQ     8
         3 003354   000040 276007                    ORQ     32,DL
         3 003355   200037 756100                    STQ     FEP_CHAN_N,,AUTO
         3 003356   200036 236100                    LDQ     FEP_CHAN,,AUTO
         3 003357   000033 772000                    QRL     27
         3 003360   200037 552104                    STBQ    FEP_CHAN_N,'04'O,AUTO
         3 003361   003405 710000 3                  TRA     s:4956

     2247     4946    5                        CASE(2);

     2248     4947    5                           CALL CONCAT(FEP_CHAN_N,'00',SUBSTR(FEP_CHAN,0,2));

   4947  3 003362   000010 223000 2                  LDX3    8
         3 003363   200037 743100                    STX3    FEP_CHAN_N,,AUTO
         3 003364   200036 224100                    LDX4    FEP_CHAN,,AUTO
         3 003365   200037 444100                    SXL4    FEP_CHAN_N,,AUTO
         3 003366   003405 710000 3                  TRA     s:4956

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:401  
     2249     4948    5                        CASE(3);

     2250     4949    5                           CALL CONCAT(FEP_CHAN_N,'0',SUBSTR(FEP_CHAN,0,3));

   4949  3 003367   060000 236003                    LDQ     24576,DU
         3 003370   200037 756100                    STQ     FEP_CHAN_N,,AUTO
         3 003371   200036 236100                    LDQ     FEP_CHAN,,AUTO
         3 003372   000011 772000                    QRL     9
         3 003373   200037 552134                    STBQ    FEP_CHAN_N,'34'O,AUTO
         3 003374   003405 710000 3                  TRA     s:4956

     2251     4950    5                        CASE(4);

     2252     4951    5                           FEP_CHAN_N = FEP_CHAN;

   4951  3 003375   200036 236100                    LDQ     FEP_CHAN,,AUTO
         3 003376   200037 756100                    STQ     FEP_CHAN_N,,AUTO
         3 003377   003405 710000 3                  TRA     s:4956

     2253     4952    5                        CASE (ELSE);

     2254     4953    5                           CALL THM$ERRMSG(%E$TH_BAD_CHAN);

   4953  3 003400   000033 630400 4                  EPPR0   27
         3 003401   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003402   000000 701000 xent               TSX1    THM$ERRMSG
         3 003403   000000 011000                    NOP     0

     2255     4954    5                           ALTRETURN;

   4954  3 003404   000000 702200 xent               TSX2  ! X66_AALT

     2256     4955    5                      END;

     2257     4956    4                      IF EXCLUDE_DEL

   4956  3 003405   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:402  
         3 003406   003432 605000 3                  TPL     s:4966

     2258     4957    4                        THEN
     2259     4958    4                           IF ((TH_CONSTRAINTS.E_CHAN_SET) &

   4958  3 003407   400000 220003                    LDX0    -131072,DU
         3 003410   000064 236000 xsym               LDQ     TH_CONSTRAINTS+52
         3 003411   200037 116100                    CMPQ    FEP_CHAN_N,,AUTO
         3 003412   003414 600000 3                  TZE     s:4958+5
         3 003413   000000 220003                    LDX0    0,DU
         3 003414   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         3 003415   400000 376003                    ANQ     -131072,DU
         3 003416   200104 756100                    STQ     C_TEST+31,,AUTO
         3 003417   000000 636010                    EAQ     0,X0
         3 003420   200104 376100                    ANQ     C_TEST+31,,AUTO
         3 003421   003425 600000 3                  TZE     s:4962

     2260     4959    4                               (TH_CONSTRAINTS.E_CHAN = FEP_CHAN_N))
     2261     4960    4                             THEN TH_CONSTRAINTS.E_CHAN_SET= %NO;

   4960  3 003422   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 003423   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53
         3 003424   003436 710000 3                  TRA     s:4969

     2262     4961    5                             ELSE DO;

     2263     4962    5                                CALL THM$ERRMSG(%E$TH_BAD_CHAN);

   4962  3 003425   000033 630400 4                  EPPR0   27
         3 003426   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003427   000000 701000 xent               TSX1    THM$ERRMSG
         3 003430   000000 011000                    NOP     0

     2264     4963    5                                ALTRETURN;

   4963  3 003431   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:403  
     2265     4964    5                             END;
     2266     4965    5                        ELSE DO;

     2267     4966    5                           TH_CONSTRAINTS.E_CHAN_SET= %YES;

   4966  3 003432   400000 236003                    LDQ     -131072,DU
         3 003433   000065 256000 xsym               ORSQ    TH_CONSTRAINTS+53

     2268     4967    5                           TH_CONSTRAINTS.E_CHAN = FEP_CHAN_N;

   4967  3 003434   200037 236100                    LDQ     FEP_CHAN_N,,AUTO
         3 003435   000064 756000 xsym               STQ     TH_CONSTRAINTS+52

     2269     4968    5                              END;

     2270     4969    4                      DEL_TEST = 'CHA';

   4969  3 003436   000011 236000 2                  LDQ     9
         3 003437   000010 376000 4                  ANQ     8
         3 003440   000040 276007                    ORQ     32,DL
         3 003441   200042 756100                    STQ     DEL_TEST,,AUTO

     2271     4970    4                 END;                     /* OF CASE   */

     2272     4971    3             IF EXCLUDE_DEL

   4971  3 003442   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 003443   003565 605000 3                  TPL     s:4998

     2273     4972    4               THEN DO;

     2274     4973    4                 CALL INDEX(JJ,DEL_TEST,TH_LAST_EXCLUDE.TEXT);

   4973  3 003444   200043 631500                    EPPR1   JJ,,AUTO
         3 003445   200042 633500                    EPPR3   DEL_TEST,,AUTO
         3 003446   000003 223003                    LDX3    3,DU
         3 003447   000000 630400 xsym               EPPR0   TH_LAST_EXCLUDE
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:404  
         3 003450   000001 220003                    LDX0    1,DU
         3 003451   000000 500510                    A9BD    0,X0,PR0
         3 003452   000167 220003                    LDX0    119,DU
         3 003453   000000 236003                    LDQ     0,DU
         3 003454   000000 701000 xent               TSX1    X66_INDEX
         3 003455   000000 011000                    NOP     0

     2275     4974    4                 JCNT = JJ;

   4974  3 003456   200043 235100                    LDA     JJ,,AUTO
         3 003457   200044 755100                    STA     JCNT,,AUTO

     2276     4975    4       NEXT_COMMA_E:
     2277     4976    5                 DO WHILE (SUBSTR(TH_LAST_EXCLUDE.TEXT,JCNT,1) ~= ',');

   4976  3 003460   003470 710000 3     NEXT_COMMA_E TRA     s:4980

     2278     4977    5                      IF JCNT > TH_LAST_EXCLUDE.COUNT

   4977  3 003461   000000 236000 xsym               LDQ     TH_LAST_EXCLUDE
         3 003462   000033 772000                    QRL     27
         3 003463   200044 116100                    CMPQ    JCNT,,AUTO
         3 003464   003511 602000 3                  TNC     DEL_END_E

     2279     4978    5                        THEN GOTO DEL_END_E;
     2280     4979    5                      JCNT = JCNT + 1;

   4979  3 003465   200044 235100                    LDA     JCNT,,AUTO
         3 003466   000001 035007                    ADLA    1,DL
         3 003467   200044 755100                    STA     JCNT,,AUTO

     2281     4980    5                 END;

   4980  3 003470   200044 235100                    LDA     JCNT,,AUTO
         3 003471   040000 106405                    CMPC    fill='040'O
         3 003472   000000 200001 xsym               ADSC9   TH_LAST_EXCLUDE,A        cn=1,n=1
         3 003473   000035 000001 4                  ADSC9   29                       cn=0,n=1
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:405  
         3 003474   003461 601000 3                  TNZ     s:4977

     2282     4981    4                 IF DEL_TEST = 'BYT' AND TEMP$->OUT$BLK.SUBLK$(1)

   4981  3 003475   200042 236100                    LDQ     DEL_TEST,,AUTO
         3 003476   000006 676000 2                  ERQ     6
         3 003477   000010 376000 4                  ANQ     8
         3 003500   003511 601000 3                  TNZ     DEL_END_E
         3 003501   200021 470500                    LDP0    TEMP$,,AUTO
         3 003502   000004 471500                    LDP1    4,,PR0
         3 003503   100000 720100                    LXL0    0,,PR1
         3 003504   000001 100003                    CMPX0   1,DU
         3 003505   003511 601000 3                  TNZ     DEL_END_E

     2283     4982    4                      ->OUT$BLK.CODE = %BIT
     2284     4983    5                      THEN DO;

     2285     4984    5                           JCNT = JCNT + 1;

   4984  3 003506   000001 035007                    ADLA    1,DL
         3 003507   200044 755100                    STA     JCNT,,AUTO

     2286     4985    5                           GOTO NEXT_COMMA_E;

   4985  3 003510   003460 710000 3                  TRA     NEXT_COMMA_E

     2287     4986    5                      END;
     2288     4987    4       DEL_END_E:
     2289     4988    4                 C_TEST = ' ';

   4988  3 003511   040100 100400       DEL_END_E    MLR     fill='040'O
         3 003512   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 003513   200045 000167                    ADSC9   C_TEST,,AUTO             cn=0,n=119

     2290     4989    4                 CALL CONCAT(C_TEST,SUBSTR(TH_LAST_EXCLUDE.TEXT,

   4989  3 003514   200043 720100                    LXL0    JJ,,AUTO
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:406  
         3 003515   040100 100440                    MLR     fill='040'O
         3 003516   000000 200010 xsym               ADSC9   TH_LAST_EXCLUDE          cn=1,n=*X0
         3 003517   200045 000167                    ADSC9   C_TEST,,AUTO             cn=0,n=119
         3 003520   200043 236100                    LDQ     JJ,,AUTO
         3 003521   000167 116007                    CMPQ    119,DL
         3 003522   003534 603000 3                  TRC     s:4991
         3 003523   200044 721100                    LXL1    JCNT,,AUTO
         3 003524   777611 621011                    EAX1    -119,X1
         3 003525   777777 661003                    ERX1    -1,DU
         3 003526   777610 622006                    EAX2    -120,QL
         3 003527   777777 662003                    ERX2    -1,DU
         3 003530   200044 235100                    LDA     JCNT,,AUTO
         3 003531   040146 100445                    MLR     fill='040'O
         3 003532   000000 400011 xsym               ADSC9   TH_LAST_EXCLUDE,A        cn=2,n=*X1
         3 003533   200045 000012                    ADSC9   C_TEST,Q,AUTO            cn=0,n=*X2

     2291     4990    4                             0,JJ),SUBSTR(TH_LAST_EXCLUDE.TEXT,JCNT+1));
     2292     4991    4                 TH_LAST_EXCLUDE.TEXT = C_TEST;

   4991  3 003534   040000 100500                    MLR     fill='040'O
         3 003535   200045 000167                    ADSC9   C_TEST,,AUTO             cn=0,n=119
         3 003536   000000 200167 xsym               ADSC9   TH_LAST_EXCLUDE          cn=1,n=119

     2293     4992    4                 IF JCNT > TH_LAST_EXCLUDE.COUNT

   4992  3 003537   000000 236000 xsym               LDQ     TH_LAST_EXCLUDE
         3 003540   000033 772000                    QRL     27
         3 003541   200044 116100                    CMPQ    JCNT,,AUTO
         3 003542   003554 603000 3                  TRC     s:4996

     2294     4993    4                    THEN
     2295     4994    4                      TH_LAST_EXCLUDE.COUNT=TH_LAST_EXCLUDE.COUNT-(JCNT-JJ);

   4994  3 003543   200044 236100                    LDQ     JCNT,,AUTO
         3 003544   200043 136100                    SBLQ    JJ,,AUTO
         3 003545   200104 756100                    STQ     C_TEST+31,,AUTO
         3 003546   000000 236000 xsym               LDQ     TH_LAST_EXCLUDE
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:407  
         3 003547   000033 772000                    QRL     27
         3 003550   200104 136100                    SBLQ    C_TEST+31,,AUTO
         3 003551   000033 736000                    QLS     27
         3 003552   000000 552040 xsym               STBQ    TH_LAST_EXCLUDE,'40'O
         3 003553   003565 710000 3                  TRA     s:4998

     2296     4995    4                    ELSE
     2297     4996    4                      TH_LAST_EXCLUDE.COUNT = TH_LAST_EXCLUDE.COUNT - (JCNT-JJ+1);

   4996  3 003554   200044 236100                    LDQ     JCNT,,AUTO
         3 003555   200043 136100                    SBLQ    JJ,,AUTO
         3 003556   200104 756100                    STQ     C_TEST+31,,AUTO
         3 003557   000000 236000 xsym               LDQ     TH_LAST_EXCLUDE
         3 003560   000033 772000                    QRL     27
         3 003561   200104 136100                    SBLQ    C_TEST+31,,AUTO
         3 003562   000001 136007                    SBLQ    1,DL
         3 003563   000033 736000                    QLS     27
         3 003564   000000 552040 xsym               STBQ    TH_LAST_EXCLUDE,'40'O

     2298     4997    4                 END;

     2299     4998    3            END;                          /* DO I = J   */

   4998  3 003565   200004 054100                    AOS     I,,AUTO
         3 003566   200003 470500                    LDP0    @TOP$,,AUTO
         3 003567   000000 471500                    LDP1    0,,PR0
         3 003570   100001 236100                    LDQ     1,,PR1
         3 003571   000022 772000                    QRL     18
         3 003572   200004 116100                    CMPQ    I,,AUTO
         3 003573   002165 605400 3                  TPNZ    s:4713

     2300     4999    2             IF EXCLUDE_DEL

   4999  3 003574   200023 234100                    SZN     EXCLUDE_DEL,,AUTO
         3 003575   004123 604000 3                  TMI     s:5121

     2301     5000    2                 THEN ;
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:408  
     2302     5001    3                 ELSE DO;

     2303     5002    3            CALL INDEX(INDX,' ',TEXTBASE);

   5002  3 003576   000000 473400 xsym               LDP3    P_PCB
         3 003577   000011 720000 xsym               LXL0    P_PCB+9
         3 003600   000000 124540                    SCM     mask='000'O
         3 003601   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         3 003602   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 003603   200017 000100                    ARG     INDX,,AUTO

     2304     5003    4            DO WHILE(SUBSTR(TEXTBASE,INDX,1) = ' ');

   5003  3 003604   003610 710000 3                  TRA     s:5005

     2305     5004    4                 INDX = INDX + 1;

   5004  3 003605   200017 235100                    LDA     INDX,,AUTO
         3 003606   000001 035007                    ADLA    1,DL
         3 003607   200017 755100                    STA     INDX,,AUTO

     2306     5005    4            END;    /* OF WHILE */

   5005  3 003610   000000 470400 xsym               LDP0    P_PCB
         3 003611   200017 235100                    LDA     INDX,,AUTO
         3 003612   040000 106505                    CMPC    fill='040'O
         3 003613   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         3 003614   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 003615   003605 600000 3                  TZE     s:5004

     2307     5006    3             IF EXCLUDE_ADD

   5006  3 003616   200041 234100                    SZN     EXCLUDE_ADD,,AUTO
         3 003617   003713 605000 3                  TPL     s:5020

     2308     5007    4               THEN DO;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:409  
     2309     5008    4                 CALL INDEX(JJ,' ',SUBSTR(TEXTBASE,INDX,P_PCB.NCHARS-INDX));

   5008  3 003620   000011 236000 xsym               LDQ     P_PCB+9
         3 003621   200017 136100                    SBLQ    INDX,,AUTO
         3 003622   000000 620006                    EAX0    0,QL
         3 003623   000000 124545                    SCM     mask='000'O
         3 003624   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         3 003625   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 003626   200043 000100                    ARG     JJ,,AUTO

     2310     5009    5                 DO WHILE (SUBSTR(TEXTBASE,JJ,1) = ' ');

   5009  3 003627   003633 710000 3                  TRA     s:5011

     2311     5010    5                   JJ = JJ + 1;

   5010  3 003630   200043 235100                    LDA     JJ,,AUTO
         3 003631   000001 035007                    ADLA    1,DL
         3 003632   200043 755100                    STA     JJ,,AUTO

     2312     5011    5                 END;

   5011  3 003633   000000 470400 xsym               LDP0    P_PCB
         3 003634   200043 235100                    LDA     JJ,,AUTO
         3 003635   040000 106505                    CMPC    fill='040'O
         3 003636   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         3 003637   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 003640   003630 600000 3                  TZE     s:5010

     2313     5012    4                 JJ = JJ + INDX;

   5012  3 003641   200043 236100                    LDQ     JJ,,AUTO
         3 003642   200017 036100                    ADLQ    INDX,,AUTO
         3 003643   200043 756100                    STQ     JJ,,AUTO

     2314     5013    4                 JJ = P_PCB.NCHARS - JJ;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:410  
   5013  3 003644   000011 236000 xsym               LDQ     P_PCB+9
         3 003645   200043 136100                    SBLQ    JJ,,AUTO
         3 003646   200043 756100                    STQ     JJ,,AUTO

     2315     5014    4                 TH_LAST_EXCLUDE.COUNT = TH_LAST_EXCLUDE.COUNT + JJ + 1;

   5014  3 003647   000000 236000 xsym               LDQ     TH_LAST_EXCLUDE
         3 003650   000033 772000                    QRL     27
         3 003651   200043 036100                    ADLQ    JJ,,AUTO
         3 003652   000001 036007                    ADLQ    1,DL
         3 003653   000033 736000                    QLS     27
         3 003654   000000 552040 xsym               STBQ    TH_LAST_EXCLUDE,'40'O

     2316     5015    4                 CALL INSERT(TH_LAST_EXCLUDE.TEXT,,,SUBSTR(TH_LAST_EXCLUDE.TEXT,

   5015  3 003655   000000 236000 xsym               LDQ     TH_LAST_EXCLUDE
         3 003656   000033 772000                    QRL     27
         3 003657   200043 136100                    SBLQ    JJ,,AUTO
         3 003660   200104 756100                    STQ     C_TEST+31,,AUTO
         3 003661   000011 236000 xsym               LDQ     P_PCB+9
         3 003662   200043 136100                    SBLQ    JJ,,AUTO
         3 003663   200104 720100                    LXL0    C_TEST+31,,AUTO
         3 003664   777777 621010                    EAX1    -1,X0
         3 003665   040000 100440                    MLR     fill='040'O
         3 003666   000000 200011 xsym               ADSC9   TH_LAST_EXCLUDE          cn=1,n=*X1
         3 003667   000000 200167 xsym               ADSC9   TH_LAST_EXCLUDE          cn=1,n=119
         3 003670   200105 756100                    STQ     C_TEST+32,,AUTO
         3 003671   200104 236100                    LDQ     C_TEST+31,,AUTO
         3 003672   000170 116007                    CMPQ    120,DL
         3 003673   003712 605000 3                  TPL     s:5018
         3 003674   777607 622006                    EAX2    -121,QL
         3 003675   777777 662003                    ERX2    -1,DU
         3 003676   040046 100400                    MLR     fill='040'O
         3 003677   000035 000001 4                  ADSC9   29                       cn=0,n=1
         3 003700   000000 000012 xsym               ADSC9   TH_LAST_EXCLUDE,Q        cn=0,n=*X2
         3 003701   000167 116007                    CMPQ    119,DL
         3 003702   003712 605000 3                  TPL     s:5018
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:411  
         3 003703   777610 623006                    EAX3    -120,QL
         3 003704   777777 663003                    ERX3    -1,DU
         3 003705   200043 724100                    LXL4    JJ,,AUTO
         3 003706   200105 235100                    LDA     C_TEST+32,,AUTO
         3 003707   040046 100545                    MLR     fill='040'O
         3 003710   000000 000014                    ADSC9   0,A,PR0                  cn=0,n=*X4
         3 003711   000000 200013 xsym               ADSC9   TH_LAST_EXCLUDE,Q        cn=1,n=*X3

     2317     5016    4                             0,TH_LAST_EXCLUDE.COUNT-JJ-1),',',SUBSTR(TEXTBASE,
     2318     5017    4                             P_PCB.NCHARS-JJ,JJ));
     2319     5018    4               END;

   5018  3 003712   004123 710000 3                  TRA     s:5121

     2320     5019    4               ELSE DO;

     2321     5020    4            TH_LAST_EXCLUDE.COUNT = P_PCB.NCHARS-INDX;

   5020  3 003713   000011 236000 xsym               LDQ     P_PCB+9
         3 003714   200017 136100                    SBLQ    INDX,,AUTO
         3 003715   000033 736000                    QLS     27
         3 003716   000000 552040 xsym               STBQ    TH_LAST_EXCLUDE,'40'O

     2322     5021    4            TH_LAST_EXCLUDE.TEXT = SUBSTR(TEXTBASE,INDX,P_PCB.NCHARS-INDX);

   5021  3 003717   000011 236000 xsym               LDQ     P_PCB+9
         3 003720   200017 136100                    SBLQ    INDX,,AUTO
         3 003721   000000 620006                    EAX0    0,QL
         3 003722   040000 100545                    MLR     fill='040'O
         3 003723   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         3 003724   000000 200167 xsym               ADSC9   TH_LAST_EXCLUDE          cn=1,n=119

     2323     5022    4            END;

     2324     5023    3            END;

   5023  3 003725   004123 710000 3                  TRA     s:5121
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:412  

     2325     5024                 /*E* ERROR:  THE-E$TH_BAD_MAJ-0
     2326     5025                      MESSAGE: Bad major specification
     2327     5026                 */
     2328     5027                 /*E* ERROR:  THE-E$TH_BAD_SUB-0
     2329     5028                      MESSAGE:  Bad minor(sub) specification
     2330     5029                 */
     2331     5030                 /*E* ERROR:  THE-E$TH_BAD_MED-0
     2332     5031                      MESSAGE:  Bad media-id specification
     2333     5032                 */
     2334     5033
     2335     5034                      /*E* ERROR: THE-E$TH_BAD_FEP-0
     2336     5035                           MESSAGE: Bad FEP error code specification
     2337     5036                      */
     2338     5037                   /*E* ERROR: THE-E$TH_BAD_BYTE-0
     2339     5038                        MESSAGE: Bad byte specification
     2340     5039                        MESSAGE1: Byte spec must be in the range 0-25
     2341     5040                   */
     2342     5041                   /*E* ERROR: THE-E$TH_BAD_BIT-0
     2343     5042                        MESSAGE: Bad bit specification
     2344     5043                        MESSAGE1: Bit spec must be in the range 0-7
     2345     5044                   */
     2346     5045                   /*E* ERROR: THE-E$TH_BAD_RANGE-0
     2347     5046                        MESSAGE: Bad range spec : HI < LO
     2348     5047                   */
     2349     5048                   /*E* ERROR: THE-E$TH_BAD_CHAN-0
     2350     5049                        MESSAGE: Bad FEP channel specification
     2351     5050                   */
     2352     5051                   /*E* ERROR: THE-E$TH_BAD_COD-0
     2353     5052                        MESSAGE: Bad I/O error code specification
     2354     5053                   */
     2355     5054                   /*E* ERROR: THE-E$TH_BAD_REA-0
     2356     5055                        MESSAGE: Bad Reason specification
     2357     5056                   */
     2358     5057                   /*E* ERROR: THE-E$TH_BAD_ACT-0
     2359     5058                        MESSAGE: Bad Action specification
     2360     5059                   */
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:413  
     2361     5060    2           CASE(%OCTAL);

     2362     5061    2              TH_CONSTRAINTS.OCTAL = %YES;

   5061  3 003726   002000 236007                    LDQ     1024,DL
         3 003727   000066 256000 xsym               ORSQ    TH_CONSTRAINTS+54
         3 003730   004123 710000 3                  TRA     s:5121

     2363     5062    2           CASE(%CROSS);

     2364     5063    2              TH_CONSTRAINTS.CROSS = %YES;

   5063  3 003731   001000 236007                    LDQ     512,DL
         3 003732   000066 256000 xsym               ORSQ    TH_CONSTRAINTS+54
         3 003733   004123 710000 3                  TRA     s:5121

     2365     5064    2           CASE(%RESET);

     2366     5065    3              IF OUT$BLK.NSUBLKS = 0 THEN DO;

   5065  3 003734   100001 221100                    LDX1    1,,PR1
         3 003735   003765 601000 3                  TNZ     s:5078

     2367     5066    3                 TH_CONSTRAINTS = TH_DEFAULT; /* ALL RESET                  */

   5066  3 003736   000000 100400                    MLR     fill='000'O
         3 003737   000000 000333 xsym               ADSC9   TH_DEFAULT               cn=0,n=219
         3 003740   000000 000333 xsym               ADSC9   TH_CONSTRAINTS           cn=0,n=219

     2368     5067    3                 TH_RECOV = %FALSE;

   5067  3 003741   000000 450000 xsym               STZ     TH_RECOV

     2369     5068    3                 VLP_SYSTAC.ACCT# = ':SYSTAC';

   5068  3 003742   040000 100400                    MLR     fill='040'O
         3 003743   000012 000007 2                  ADSC9   10                       cn=0,n=7
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:414  
         3 003744   000000 000010 xsym               ADSC9   VLP_SYSTAC               cn=0,n=8

     2370     5069    3                 TH_OPEN_ERRLOG.ACCT_ = VECTOR(VLP_SYSTAC);

   5069  3 003745   000044 237000 4                  LDAQ    36
         3 003746   000024 757000 xsym               STAQ    TH_OPEN_ERRLOG+20

     2371     5070    3                 TH_OPEN_ERRLOG.NAME_ = VECTOR(TH_VLP_ERRLOG);

   5070  3 003747   000046 237000 4                  LDAQ    38
         3 003750   000006 757000 xsym               STAQ    TH_OPEN_ERRLOG+6

     2372     5071    3                 TH_CHANGE_ACCOUNT = '1'B;

   5071  3 003751   400000 236003                    LDQ     -131072,DU
         3 003752   000000 756000 xsym               STQ     TH_CHANGE_ACCOUNT

     2373     5072    3                TH_LAST_MATCH.TEXT = ' ';

   5072  3 003753   040000 100400                    MLR     fill='040'O
         3 003754   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 003755   000000 200167 xsym               ADSC9   TH_LAST_MATCH            cn=1,n=119

     2374     5073    3                TH_LAST_EXCLUDE.TEXT = ' ';

   5073  3 003756   040000 100400                    MLR     fill='040'O
         3 003757   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 003760   000000 200167 xsym               ADSC9   TH_LAST_EXCLUDE          cn=1,n=119

     2375     5074    3                TH_LAST_EXCLUDE.COUNT = 0;

   5074  3 003761   000000 236003                    LDQ     0,DU
         3 003762   000000 552040 xsym               STBQ    TH_LAST_EXCLUDE,'40'O

     2376     5075    3                TH_LAST_MATCH.COUNT = 0;

   5075  3 003763   000000 552040 xsym               STBQ    TH_LAST_MATCH,'40'O
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:415  

     2377     5076    3                 END;  /* IF */

   5076  3 003764   004123 710000 3                  TRA     s:5121

     2378     5077    2                 ELSE
     2379     5078    3                 DO I = 0 TO OUT$BLK.NSUBLKS - 1;

   5078  3 003765   200004 450100                    STZ     I,,AUTO
         3 003766   004116 710000 3                  TRA     s:5119+1

     2380     5079    4                    DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);

   5079  3 003767   200003 470500                    LDP0    @TOP$,,AUTO
         3 003770   000000 471500                    LDP1    0,,PR0
         3 003771   200004 720100                    LXL0    I,,AUTO
         3 003772   100003 473510                    LDP3    3,X0,PR1
         3 003773   300000 721100                    LXL1    0,,PR3
         3 003774   000012 101003                    CMPX1   10,DU
         3 003775   003777 602011 3                  TNC     s:5079+8,X1
         3 003776   004115 710000 3                  TRA     s:5119
         3 003777   004115 710000 3                  TRA     s:5119
         3 004000   004011 710000 3                  TRA     s:5081
         3 004001   004014 710000 3                  TRA     s:5084
         3 004002   004037 710000 3                  TRA     s:5094
         3 004003   004062 710000 3                  TRA     s:5103
         3 004004   004065 710000 3                  TRA     s:5105
         3 004005   004070 710000 3                  TRA     s:5107
         3 004006   004075 710000 3                  TRA     s:5110
         3 004007   004011 710000 3                  TRA     s:5081
         3 004010   004103 710000 3                  TRA     s:5113

     2381     5080    4                       CASE(%ERROR,%SELECT);

     2382     5081    4                          TH_CONSTRAINTS.NTYPES = 0;

   5081  3 004011   000000 450000 xsym               STZ     TH_CONSTRAINTS
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:416  

     2383     5082    4                          TH_RECOV = %FALSE;

   5082  3 004012   000000 450000 xsym               STZ     TH_RECOV
         3 004013   004115 710000 3                  TRA     s:5119

     2384     5083    4                      CASE(%MATCH);

     2385     5084    4                           TH_CONSTRAINTS.M_BY_B_SET = %NO;

   5084  3 004014   003000 060400                    CSL     bolr='003'O
         3 004015   000002 000011 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=9
         3 004016   000026 010440 xsym               BDSC    TH_CONSTRAINTS+22        by=0,bit=1,n=288

     2386     5085    4                         TH_CONSTRAINTS.M_MAJ_S = %NO;

   5085  3 004017   000000 236000 4                  LDQ     0
         3 004020   000014 356000 xsym               ANSQ    TH_CONSTRAINTS+12

     2387     5086    4                         TH_CONSTRAINTS.M_SUB_S = %NO;

   5086  3 004021   000001 236000 4                  LDQ     1
         3 004022   000014 356000 xsym               ANSQ    TH_CONSTRAINTS+12

     2388     5087    4                         TH_CONSTRAINTS.M_MED_S = %NO;

   5087  3 004023   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 004024   000016 356000 xsym               ANSQ    TH_CONSTRAINTS+14

     2389     5088    4                         TH_CONSTRAINTS.M_FEP_SET = %NO;

   5088  3 004025   000061 356000 xsym               ANSQ    TH_CONSTRAINTS+49

     2390     5089    4                         TH_CONSTRAINTS.M_CHAN_SET = %NO;

   5089  3 004026   000002 236000 4                  LDQ     2
         3 004027   000062 356000 xsym               ANSQ    TH_CONSTRAINTS+50
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:417  

     2391     5090    4                TH_M_CHAN_TOTAL = 0;

   5090  3 004030   000000 450000 xsym               STZ     TH_M_CHAN_TOTAL

     2392     5091    4                TH_LAST_MATCH.TEXT = ' ';

   5091  3 004031   040000 100400                    MLR     fill='040'O
         3 004032   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 004033   000000 200167 xsym               ADSC9   TH_LAST_MATCH            cn=1,n=119

     2393     5092    4                TH_LAST_MATCH.COUNT = 0;

   5092  3 004034   000000 236003                    LDQ     0,DU
         3 004035   000000 552040 xsym               STBQ    TH_LAST_MATCH,'40'O
         3 004036   004115 710000 3                  TRA     s:5119

     2394     5093    4                      CASE(%EXCLUDE);

     2395     5094    4                           TH_CONSTRAINTS.E_BY_B_SET = %NO;

   5094  3 004037   003000 060400                    CSL     bolr='003'O
         3 004040   000002 000011 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=9
         3 004041   000050 010440 xsym               BDSC    TH_CONSTRAINTS+40        by=0,bit=1,n=288

     2396     5095    4                         TH_CONSTRAINTS.E_MAJ_S = %NO;

   5095  3 004042   000036 236000 4                  LDQ     30
         3 004043   000036 356000 xsym               ANSQ    TH_CONSTRAINTS+30

     2397     5096    4                         TH_CONSTRAINTS.E_SUB_S = %NO;

   5096  3 004044   000037 236000 4                  LDQ     31
         3 004045   000036 356000 xsym               ANSQ    TH_CONSTRAINTS+30

     2398     5097    4                         TH_CONSTRAINTS.E_MED_S = %NO;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:418  
   5097  3 004046   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 004047   000040 356000 xsym               ANSQ    TH_CONSTRAINTS+32

     2399     5098    4                         TH_CONSTRAINTS.E_FEP_SET = %NO;

   5098  3 004050   000002 236000 4                  LDQ     2
         3 004051   000063 356000 xsym               ANSQ    TH_CONSTRAINTS+51

     2400     5099    4                         TH_CONSTRAINTS.E_CHAN_SET = %NO;

   5099  3 004052   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 004053   000065 356000 xsym               ANSQ    TH_CONSTRAINTS+53

     2401     5100    4                TH_LAST_EXCLUDE.TEXT = ' ';

   5100  3 004054   040000 100400                    MLR     fill='040'O
         3 004055   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 004056   000000 200167 xsym               ADSC9   TH_LAST_EXCLUDE          cn=1,n=119

     2402     5101    4                TH_LAST_EXCLUDE.COUNT = 0;

   5101  3 004057   000000 236003                    LDQ     0,DU
         3 004060   000000 552040 xsym               STBQ    TH_LAST_EXCLUDE,'40'O
         3 004061   004115 710000 3                  TRA     s:5119

     2403     5102    4                       CASE(%OCTAL);

     2404     5103    4                          TH_CONSTRAINTS.OCTAL = %NO;

   5103  3 004062   000043 236000 4                  LDQ     35
         3 004063   000066 356000 xsym               ANSQ    TH_CONSTRAINTS+54
         3 004064   004115 710000 3                  TRA     s:5119

     2405     5104    4                       CASE(%CROSS);

     2406     5105    4                          TH_CONSTRAINTS.CROSS = %NO;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:419  
   5105  3 004065   000050 236000 4                  LDQ     40
         3 004066   000066 356000 xsym               ANSQ    TH_CONSTRAINTS+54
         3 004067   004115 710000 3                  TRA     s:5119

     2407     5106    4                       CASE(%SPAN);

     2408     5107    4                          TH_CONSTRAINTS.START = TH_DEFAULT.START;

   5107  3 004070   000012 235000 xsym               LDA     TH_DEFAULT+10
         3 004071   000012 755000 xsym               STA     TH_CONSTRAINTS+10

     2409     5108    4                          TH_CONSTRAINTS.STOP = TH_DEFAULT.STOP;

   5108  3 004072   000013 236000 xsym               LDQ     TH_DEFAULT+11
         3 004073   000013 756000 xsym               STQ     TH_CONSTRAINTS+11
         3 004074   004115 710000 3                  TRA     s:5119

     2410     5109    4          CASE(%USE);

     2411     5110    4            VLP_SYSTAC.ACCT# = ':SYSTAC';

   5110  3 004075   040000 100400                    MLR     fill='040'O
         3 004076   000012 000007 2                  ADSC9   10                       cn=0,n=7
         3 004077   000000 000010 xsym               ADSC9   VLP_SYSTAC               cn=0,n=8

     2412     5111    4            TH_CHANGE_ACCOUNT = '1'B;

   5111  3 004100   400000 236003                    LDQ     -131072,DU
         3 004101   000000 756000 xsym               STQ     TH_CHANGE_ACCOUNT
         3 004102   004115 710000 3                  TRA     s:5119

     2413     5112    4          CASE(%FILE);

     2414     5113    4            TH_OPEN_ERRLOG.ACCT_ = VECTOR(VLP_SYSTAC);

   5113  3 004103   000044 237000 4                  LDAQ    36
         3 004104   000024 757000 xsym               STAQ    TH_OPEN_ERRLOG+20
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:420  

     2415     5114    4            TH_OPEN_ERRLOG.NAME_ = VECTOR(TH_VLP_ERRLOG);

   5114  3 004105   000046 237000 4                  LDAQ    38
         3 004106   000006 757000 xsym               STAQ    TH_OPEN_ERRLOG+6

     2416     5115    4            TH_CHANGE_ACCOUNT = '1'B;

   5115  3 004107   400000 236003                    LDQ     -131072,DU
         3 004110   000000 756000 xsym               STQ     TH_CHANGE_ACCOUNT

     2417     5116    4            TH_CONSTRAINTS.START = TH_DEFAULT.START;

   5116  3 004111   000012 235000 xsym               LDA     TH_DEFAULT+10
         3 004112   000012 755000 xsym               STA     TH_CONSTRAINTS+10

     2418     5117    4            TH_CONSTRAINTS.STOP = TH_DEFAULT.STOP;

   5117  3 004113   000013 235000 xsym               LDA     TH_DEFAULT+11
         3 004114   000013 755000 xsym               STA     TH_CONSTRAINTS+11

     2419     5118    4                    END;                   /* CASE OUT$BLK.CODE                  */

     2420     5119    3                 END;                      /* DO I = 0 TO OUT$BLK.NSUBLKS - 1    */

   5119  3 004115   200004 054100                    AOS     I,,AUTO
         3 004116   000000 471500                    LDP1    0,,PR0
         3 004117   100001 236100                    LDQ     1,,PR1
         3 004120   000022 772000                    QRL     18
         3 004121   200004 116100                    CMPQ    I,,AUTO
         3 004122   003767 605400 3                  TPNZ    s:5079

     2421     5120    2        END;                               /* CASE OUT$BLK.CODE                  */

     2422     5121    1   END THC$SELECT;

   5121  3 004123   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:421  
     2423     5122        %EOD;

PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:422  
--  Include file information  --

   EL_SUBS_C.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$SELECT.
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:423  

 **** Variables and constants ****

  ****  Section 001  Data  THC$SELECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 RECOV_TYPES(0:3)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                     13-0-0/b BIT         r     1 BIT_SPEC
    14-0-0/w UBIN        r     1 BYTE_SPEC                 45-0-0/c CHAR(119)   r     1 C_TEST
    42-0-0/c CHAR(3)     r     1 DEL_TEST                  41-0-0/b BIT         r     1 EXCLUDE_ADD
    23-0-0/b BIT         r     1 EXCLUDE_DEL               36-0-0/c CHAR(4)     r     1 FEP_CHAN
    37-0-0/c CHAR(4)     r     1 FEP_CHAN_N                35-0-0/c CHAR(3)     r     1 FEP_CODE
    15-0-0/w UBIN        r     1 FIRST_BIT                 30-0-0/b UBIN(9)     r     1 FI_ERR
    12-0-0/b BIT         r     1 FOUND                      4-0-0/w SBIN        r     1 I
    17-0-0/w UBIN        r     1 INDX                       5-0-0/w SBIN        r     1 J
    44-0-0/w UBIN        r     1 JCNT                      43-0-0/w UBIN        r     1 JJ
     6-0-0/w SBIN        r     1 K                         24-0-0/b UBIN(6)     r     1 MAJOR
    40-0-0/b BIT         r     1 MATCH_ADD                 22-0-0/b BIT         r     1 MATCH_DEL
    31-0-0/c CHAR(6)     r     1 MEDIA                      7-0-0/w SBIN        r     1 SAVE_INDEX
    25-0-0/c CHAR(3)     r     1 SUB                       25-0-0/c CHAR        r     1 SUBB(0:2)
    27-0-0/b BIT (6)     r     1 SUBB_BIT                  26-0-0/w UBIN        r     1 SUB_BIN
    27-0-0/b STRC(6)     r     1 SUB_BIT                   33-0-0/c CHAR(8)     r     1 TEMP
    21-0-0/w PTR         r     1 TEMP$                     10-0-0/w UBIN        r     1 TEMP1
    11-0-0/w UBIN        r     1 TEMP2                     33-0-0/c CHAR        r     1 TEMPP(0:7)
    *0-0-0/w PTR         r     1 TOP$                      20-0-0/w UBIN        r     1 VALUE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:424  

     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/b BIT         r     1 TH_CHANGE_ACCOUNT
     0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS             0-0-0/d STRC(1971)  r     1 TH_DEFAULT
     0-0-0/w STRC(1080)  r     1 TH_LAST_EXCLUDE            0-0-0/w STRC(1080)  r     1 TH_LAST_MATCH
     0-0-0/c STRC(37)    r     1 TH_M_CHAN(0:9)
     0-0-0/w UBIN(5)     r     1 TH_M_CHAN_TOTAL            0-0-0/d STRC(2088)  r     1 TH_OPEN_ERRLOG
     0-0-0/b BIT         r     1 TH_RECOV                   0-0-0/c STRC(144)   r     1 TH_VLP_ERRLOG
     0-0-0/c STRC(72)    r     1 VLP_SYSTAC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/c ACHR        r     1 TEXTBASE


   Procedure THC$SELECT requires 2132 words for executable code.
   Procedure THC$SELECT requires 70 words of local(AUTO) storage.
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:425  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:426  
          MINI XREF LISTING

BIT_SPEC
      3798**DCL      4480<<ASSIGN   4484>>IF       4494>>ASSIGN   4507<<ASSIGN   4511>>IF       4521>>ASSIGN
      4876<<ASSIGN   4880>>IF       4890>>ASSIGN   4903<<ASSIGN   4907>>IF       4917>>ASSIGN
BYTE_SPEC
      3799**DCL      4461<<ASSIGN   4481>>ASSIGN   4508>>ASSIGN   4857<<ASSIGN   4877>>ASSIGN   4904>>ASSIGN
C_TEST
      3827**DCL      4647<<ASSIGN   4649<<CALLBLT  4650<<CALLBLT  4652>>ASSIGN   4988<<ASSIGN   4989<<CALLBLT
      4991>>ASSIGN
DEL_END_E
      4988**LABEL    4978--GOTO
DEL_END_M
      4647**LABEL    4623--GOTO
DEL_TEST
      3824**DCL      4346<<ASSIGN   4375<<ASSIGN   4398<<ASSIGN   4421<<ASSIGN   4438<<ASSIGN   4453<<ASSIGN
      4525<<ASSIGN   4543<<ASSIGN   4612<<ASSIGN   4616>>CALLBLT  4640>>IF       4742<<ASSIGN   4771<<ASSIGN
      4794<<ASSIGN   4817<<ASSIGN   4834<<ASSIGN   4849<<ASSIGN   4921<<ASSIGN   4939<<ASSIGN   4969<<ASSIGN
      4973>>CALLBLT  4981>>IF
EXCLUDE_ADD
      3823**DCL      4688<<ASSIGN   4698<<ASSIGN   5006>>IF
EXCLUDE_DEL
      3806**DCL      4687<<ASSIGN   4691<<ASSIGN   4730>>IF       4759>>IF       4781>>IF       4804>>IF
      4821>>IF       4837>>IF       4878>>IF       4905>>IF       4924>>IF       4956>>IF       4971>>IF
      4999>>IF
FEP_CHAN
      3820**DCL      4545<<ASSIGN   4549>>CALLBLT  4551>>CALLBLT  4553>>CALLBLT  4555>>ASSIGN   4627>>IF
      4941<<ASSIGN   4945>>CALLBLT  4947>>CALLBLT  4949>>CALLBLT  4951>>ASSIGN
FEP_CHAN_N
      3821**DCL      4549<<CALLBLT  4551<<CALLBLT  4553<<CALLBLT  4555<<ASSIGN   4567>>IF       4601>>ASSIGN
      4608>>ASSIGN   4945<<CALLBLT  4947<<CALLBLT  4949<<CALLBLT  4951<<ASSIGN   4958>>IF       4967>>ASSIGN
FEP_CODE
      3819**DCL      4527<<ASSIGN   4530>>IF       4539>>ASSIGN   4923<<ASSIGN   4926>>IF       4935>>ASSIGN
FIRST_BIT
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:427  
      3800**DCL      4471<<ASSIGN   4481>>ASSIGN   4867<<ASSIGN   4877>>ASSIGN
FI_ERR
      3815**DCL      4384<<ASSIGN   4387>>IF       4396>>ASSIGN   4407<<ASSIGN   4410>>IF       4419>>ASSIGN
      4424<<ASSIGN   4427>>IF       4436>>ASSIGN   4780<<ASSIGN   4783>>IF       4792>>ASSIGN   4803<<ASSIGN
      4806>>IF       4815>>ASSIGN   4820<<ASSIGN   4823>>IF       4832>>ASSIGN
FOUND
      3797**DCL      4275<<ASSIGN   4280<<ASSIGN   4282>>IF       4565<<ASSIGN   4570<<ASSIGN   4575>>IF
      4618<<ASSIGN   4620>>DOWHILE  4629<<ASSIGN   4637>>IF
FOUND_CHANNEL
      4575**LABEL    4572--GOTO
I
      3789**DCL      4257<<ASSIGN   4262<<ASSIGN   4263<<DOINDEX  4263>>DOINDEX  4264>>IF       4265>>CALLBLT
      4265>>CALLBLT  4266>>ASSIGN   4316<<DOINDEX  4317>>ASSIGN   4712<<DOINDEX  4713>>ASSIGN   5078<<DOINDEX
      5079>>DOCASE
INDX
      3802**DCL      4481<<ASSIGN   4484>>IF       4484>>IF       4487>>ASSIGN   4493>>ASSIGN   4494>>ASSIGN
      4508<<ASSIGN   4511>>IF       4511>>IF       4514>>ASSIGN   4520>>ASSIGN   4521>>ASSIGN   4663<<CALLBLT
      4664>>DOWHILE  4665<<ASSIGN   4665>>ASSIGN   4669>>CALLBLT  4669>>CALLBLT  4673>>ASSIGN   4681>>ASSIGN
      4682>>ASSIGN   4682>>ASSIGN   4877<<ASSIGN   4880>>IF       4880>>IF       4883>>ASSIGN   4889>>ASSIGN
      4890>>ASSIGN   4904<<ASSIGN   4907>>IF       4907>>IF       4910>>ASSIGN   4916>>ASSIGN   4917>>ASSIGN
      5002<<CALLBLT  5003>>DOWHILE  5004<<ASSIGN   5004>>ASSIGN   5008>>CALLBLT  5008>>CALLBLT  5012>>ASSIGN
      5020>>ASSIGN   5021>>ASSIGN   5021>>ASSIGN
J
      3790**DCL      4278<<DOINDEX  4279>>IF       4296<<ASSIGN   4301<<ASSIGN   4305<<ASSIGN   4316>>DOINDEX
      4546<<ASSIGN   4547>>DOCASE   4692<<ASSIGN   4697<<ASSIGN   4701<<ASSIGN   4712>>DOINDEX  4942<<ASSIGN
      4943>>DOCASE
JCNT
      3826**DCL      4617<<ASSIGN   4621>>DOWHILE  4622>>IF       4624>>IF       4626>>ASSIGN   4627>>IF
      4628<<ASSIGN   4628>>ASSIGN   4632<<ASSIGN   4632>>ASSIGN   4635<<ASSIGN   4635>>ASSIGN   4638<<ASSIGN
      4638>>ASSIGN   4643<<ASSIGN   4643>>ASSIGN   4649>>CALLBLT  4650>>CALLBLT  4653>>IF       4655>>ASSIGN
      4657>>ASSIGN   4974<<ASSIGN   4976>>DOWHILE  4977>>IF       4979<<ASSIGN   4979>>ASSIGN   4984<<ASSIGN
      4984>>ASSIGN   4989>>CALLBLT  4992>>IF       4994>>ASSIGN   4996>>ASSIGN
JJ
      3825**DCL      4578<<ASSIGN   4581<<ASSIGN   4581>>ASSIGN   4583>>IF       4616<<CALLBLT  4617>>ASSIGN
      4655>>ASSIGN   4669<<CALLBLT  4670>>DOWHILE  4671<<ASSIGN   4671>>ASSIGN   4673<<ASSIGN   4673>>ASSIGN
      4674<<ASSIGN   4674>>ASSIGN   4675>>ASSIGN   4676>>CALLBLT  4676>>CALLBLT  4676>>CALLBLT  4973<<CALLBLT
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:428  
      4974>>ASSIGN   4989>>CALLBLT  4994>>ASSIGN   4996>>ASSIGN   5008<<CALLBLT  5009>>DOWHILE  5010<<ASSIGN
      5010>>ASSIGN   5012<<ASSIGN   5012>>ASSIGN   5013<<ASSIGN   5013>>ASSIGN   5014>>ASSIGN   5015>>CALLBLT
      5015>>CALLBLT  5015>>CALLBLT
K
      3791**DCL      4276<<DOINDEX  4277>>ASSIGN   4379<<DOINDEX  4381>>CALLBLT  4402<<DOINDEX  4404>>CALLBLT
      4499<<DOINDEX  4500>>CALLBLT  4508>>ASSIGN   4566<<DOINDEX  4567>>IF       4571>>ASSIGN   4579<<DOINDEX
      4580>>IF       4775<<DOINDEX  4777>>CALLBLT  4798<<DOINDEX  4800>>CALLBLT  4895<<DOINDEX  4896>>CALLBLT
      4904>>ASSIGN
MAJOR
      3807**DCL      4327<<ASSIGN   4332<<ASSIGN   4336>>IF       4344>>ASSIGN   4723<<ASSIGN   4728<<ASSIGN
      4732>>IF       4740>>ASSIGN
MATCH_ADD
      3822**DCL      4292<<ASSIGN   4302<<ASSIGN   4597>>IF       4667>>IF
MATCH_DEL
      3805**DCL      4291<<ASSIGN   4295<<ASSIGN   4334>>IF       4363>>IF       4385>>IF       4408>>IF
      4425>>IF       4441>>IF       4482>>IF       4509>>IF       4528>>IF       4560>>IF       4614>>IF
      4660>>IF
MEDIA
      3816**DCL      4440<<ASSIGN   4443>>IF       4451>>ASSIGN   4836<<ASSIGN   4839>>IF       4847>>ASSIGN
NEXT_COMMA
      4618**LABEL    4644--GOTO
NEXT_COMMA_E
      4976**LABEL    4985--GOTO
OUT$BLK.CODE
      3844**DCL      4255>>DOCASE   4258>>IF       4264>>IF       4266>>ASSIGN   4293>>IF       4299>>IF
      4318>>DOCASE   4462>>DOCASE   4640>>IF       4689>>IF       4695>>IF       4714>>DOCASE   4858>>DOCASE
      4981>>IF       5079>>DOCASE
OUT$BLK.NSUBLKS
      3848**DCL      4263>>DOINDEX  4316>>DOINDEX  4712>>DOINDEX  5065>>IF       5078>>DOINDEX
OUT$BLK.SUBLK$
      3869**DCL      4258>>IF       4264>>IF       4265>>CALLBLT  4265>>CALLBLT  4266>>ASSIGN   4293>>IF
      4299>>IF       4317>>ASSIGN   4317>>ASSIGN   4320>>IF       4322>>ASSIGN   4322>>ASSIGN   4330>>CALLBLT
      4330>>CALLBLT  4348>>IF       4350>>ASSIGN   4350>>ASSIGN   4359>>CALLBLT  4359>>CALLBLT  4378>>ASSIGN
      4378>>ASSIGN   4379>>DOINDEX  4401>>ASSIGN   4401>>ASSIGN   4402>>DOINDEX  4423>>CALLBLT  4423>>CALLBLT
      4440>>ASSIGN   4440>>ASSIGN   4455>>CALLBLT  4455>>CALLBLT  4462>>DOCASE   4464>>CALLBLT  4464>>CALLBLT
      4464>>CALLBLT  4464>>CALLBLT  4472>>CALLBLT  4472>>CALLBLT  4472>>CALLBLT  4472>>CALLBLT  4497>>ASSIGN
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:429  
      4497>>ASSIGN   4497>>ASSIGN   4497>>ASSIGN   4527>>ASSIGN   4527>>ASSIGN   4540>>ASSIGN   4545>>ASSIGN
      4545>>ASSIGN   4546>>ASSIGN   4640>>IF       4689>>IF       4695>>IF       4713>>ASSIGN   4713>>ASSIGN
      4716>>IF       4718>>ASSIGN   4718>>ASSIGN   4726>>CALLBLT  4726>>CALLBLT  4744>>IF       4746>>ASSIGN
      4746>>ASSIGN   4755>>CALLBLT  4755>>CALLBLT  4774>>ASSIGN   4774>>ASSIGN   4775>>DOINDEX  4797>>ASSIGN
      4797>>ASSIGN   4798>>DOINDEX  4819>>CALLBLT  4819>>CALLBLT  4836>>ASSIGN   4836>>ASSIGN   4851>>CALLBLT
      4851>>CALLBLT  4858>>DOCASE   4860>>CALLBLT  4860>>CALLBLT  4860>>CALLBLT  4860>>CALLBLT  4868>>CALLBLT
      4868>>CALLBLT  4868>>CALLBLT  4868>>CALLBLT  4893>>ASSIGN   4893>>ASSIGN   4893>>ASSIGN   4893>>ASSIGN
      4923>>ASSIGN   4923>>ASSIGN   4936>>ASSIGN   4941>>ASSIGN   4941>>ASSIGN   4942>>ASSIGN   4981>>IF
      5079>>DOCASE
OUT$SYM.COUNT
      3905**DCL      3908--IMP-SIZ  4265>>CALLBLT  4320>>IF       4322>>ASSIGN   4330>>CALLBLT  4348>>IF
      4350>>ASSIGN   4359>>CALLBLT  4378>>ASSIGN   4379>>DOINDEX  4401>>ASSIGN   4402>>DOINDEX  4423>>CALLBLT
      4440>>ASSIGN   4455>>CALLBLT  4464>>CALLBLT  4472>>CALLBLT  4497>>ASSIGN   4527>>ASSIGN   4540>>ASSIGN
      4545>>ASSIGN   4546>>ASSIGN   4716>>IF       4718>>ASSIGN   4726>>CALLBLT  4744>>IF       4746>>ASSIGN
      4755>>CALLBLT  4774>>ASSIGN   4775>>DOINDEX  4797>>ASSIGN   4798>>DOINDEX  4819>>CALLBLT  4836>>ASSIGN
      4851>>CALLBLT  4860>>CALLBLT  4868>>CALLBLT  4893>>ASSIGN   4923>>ASSIGN   4936>>ASSIGN   4941>>ASSIGN
      4942>>ASSIGN
OUT$SYM.TEXT
      3908**DCL      4265>>CALLBLT  4322>>ASSIGN   4330>>CALLBLT  4350>>ASSIGN   4359>>CALLBLT  4378>>ASSIGN
      4401>>ASSIGN   4423>>CALLBLT  4440>>ASSIGN   4455>>CALLBLT  4464>>CALLBLT  4472>>CALLBLT  4497>>ASSIGN
      4527>>ASSIGN   4545>>ASSIGN   4718>>ASSIGN   4726>>CALLBLT  4746>>ASSIGN   4755>>CALLBLT  4774>>ASSIGN
      4797>>ASSIGN   4819>>CALLBLT  4836>>ASSIGN   4851>>CALLBLT  4860>>CALLBLT  4868>>CALLBLT  4893>>ASSIGN
      4923>>ASSIGN   4941>>ASSIGN
P_PCB.NCHARS
      4079**DCL      3796--IMP-SIZ  4663>>CALLBLT  4664>>DOWHILE  4669>>CALLBLT  4669>>CALLBLT  4670>>DOWHILE
      4674>>ASSIGN   4676>>CALLBLT  4676>>CALLBLT  4681>>ASSIGN   4682>>ASSIGN   4682>>ASSIGN   5002>>CALLBLT
      5003>>DOWHILE  5008>>CALLBLT  5008>>CALLBLT  5009>>DOWHILE  5013>>ASSIGN   5015>>CALLBLT  5015>>CALLBLT
      5020>>ASSIGN   5021>>ASSIGN   5021>>ASSIGN
P_PCB.TEXT$
      3933**DCL      3796--IMP-PTR  4663>>CALLBLT  4664>>DOWHILE  4669>>CALLBLT  4670>>DOWHILE  4676>>CALLBLT
      4682>>ASSIGN   5002>>CALLBLT  5003>>DOWHILE  5008>>CALLBLT  5009>>DOWHILE  5015>>CALLBLT  5021>>ASSIGN
RECOV_TYPES
      3795**DCL      4267<<ASSIGN   4277>>ASSIGN
SAVE_INDEX
      3792**DCL      4619<<ASSIGN   4626<<ASSIGN   4648>>IF       4650>>CALLBLT  4657>>ASSIGN
SUB
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:430  
      3808**DCL      3809--REDEF    4322<<ASSIGN   4350<<ASSIGN   4378<<ASSIGN   4401<<ASSIGN   4718<<ASSIGN
      4746<<ASSIGN   4774<<ASSIGN   4797<<ASSIGN
SUBB
      3809**DCL      4323>>CALLBLT  4325>>CALLBLT  4351>>CALLBLT  4353>>CALLBLT  4381>>CALLBLT  4404>>CALLBLT
      4719>>CALLBLT  4721>>CALLBLT  4747>>CALLBLT  4749>>CALLBLT  4777>>CALLBLT  4800>>CALLBLT
SUBB_BIT
      3814**DCL      4365>>IF       4373>>ASSIGN   4761>>IF       4769>>ASSIGN
SUB_BIN
      3810**DCL      4323<<CALLBLT  4324>>ASSIGN   4325<<CALLBLT  4326>>ASSIGN   4351<<CALLBLT  4352>>ASSIGN
      4353<<CALLBLT  4354>>ASSIGN   4357<<ASSIGN   4358>>ASSIGN   4359<<CALLBLT  4361>>ASSIGN   4381<<CALLBLT
      4382>>ASSIGN   4404<<CALLBLT  4405>>ASSIGN   4719<<CALLBLT  4720>>ASSIGN   4721<<CALLBLT  4722>>ASSIGN
      4747<<CALLBLT  4748>>ASSIGN   4749<<CALLBLT  4750>>ASSIGN   4753<<ASSIGN   4754>>ASSIGN   4755<<CALLBLT
      4757>>ASSIGN   4777<<CALLBLT  4778>>ASSIGN   4800<<CALLBLT  4801>>ASSIGN
SUB_BIT
      3811**DCL      3814--REDEF
SUB_BIT.ONE
      3812**DCL      4352<<ASSIGN   4358<<ASSIGN   4748<<ASSIGN   4754<<ASSIGN
SUB_BIT.TWO
      3813**DCL      4354<<ASSIGN   4361<<ASSIGN   4750<<ASSIGN   4757<<ASSIGN
TEMP
      3817**DCL      3818--REDEF    4497<<ASSIGN   4893<<ASSIGN
TEMP$
      3804**DCL      4317<<ASSIGN   4318>>DOCASE   4320>>IF       4322>>ASSIGN   4322>>ASSIGN   4330>>CALLBLT
      4330>>CALLBLT  4348>>IF       4350>>ASSIGN   4350>>ASSIGN   4359>>CALLBLT  4359>>CALLBLT  4378>>ASSIGN
      4378>>ASSIGN   4379>>DOINDEX  4401>>ASSIGN   4401>>ASSIGN   4402>>DOINDEX  4423>>CALLBLT  4423>>CALLBLT
      4440>>ASSIGN   4440>>ASSIGN   4455>>CALLBLT  4455>>CALLBLT  4462>>DOCASE   4464>>CALLBLT  4464>>CALLBLT
      4472>>CALLBLT  4472>>CALLBLT  4497>>ASSIGN   4497>>ASSIGN   4527>>ASSIGN   4527>>ASSIGN   4540>>ASSIGN
      4545>>ASSIGN   4545>>ASSIGN   4546>>ASSIGN   4640>>IF       4713<<ASSIGN   4714>>DOCASE   4716>>IF
      4718>>ASSIGN   4718>>ASSIGN   4726>>CALLBLT  4726>>CALLBLT  4744>>IF       4746>>ASSIGN   4746>>ASSIGN
      4755>>CALLBLT  4755>>CALLBLT  4774>>ASSIGN   4774>>ASSIGN   4775>>DOINDEX  4797>>ASSIGN   4797>>ASSIGN
      4798>>DOINDEX  4819>>CALLBLT  4819>>CALLBLT  4836>>ASSIGN   4836>>ASSIGN   4851>>CALLBLT  4851>>CALLBLT
      4858>>DOCASE   4860>>CALLBLT  4860>>CALLBLT  4868>>CALLBLT  4868>>CALLBLT  4893>>ASSIGN   4893>>ASSIGN
      4923>>ASSIGN   4923>>ASSIGN   4936>>ASSIGN   4941>>ASSIGN   4941>>ASSIGN   4942>>ASSIGN   4981>>IF
TEMP1
      3793**DCL      4268<<ASSIGN   4272<<ASSIGN   4276>>DOINDEX
TEMP2
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:431  
      3794**DCL      4269<<ASSIGN   4273<<ASSIGN   4276>>DOINDEX
TEMPP
      3818**DCL      4500>>CALLBLT  4896>>CALLBLT
TEXTBASE
      3796**DCL      4663>>CALLBLT  4664>>DOWHILE  4669>>CALLBLT  4670>>DOWHILE  4676>>CALLBLT  4682>>ASSIGN
      5002>>CALLBLT  5003>>DOWHILE  5008>>CALLBLT  5009>>DOWHILE  5015>>CALLBLT  5021>>ASSIGN
THM$ERRMSG
      3786**DCL-ENT  4339--CALL     4368--CALL     4391--CALL     4414--CALL     4431--CALL     4446--CALL
      4458--CALL     4468--CALL     4477--CALL     4489--CALL     4504--CALL     4516--CALL     4534--CALL
      4557--CALL     4592--CALL     4735--CALL     4764--CALL     4787--CALL     4810--CALL     4827--CALL
      4842--CALL     4854--CALL     4864--CALL     4873--CALL     4885--CALL     4900--CALL     4912--CALL
      4930--CALL     4953--CALL     4962--CALL
TH_CHANGE_ACCOUNT
      3656**DCL      5071<<ASSIGN   5111<<ASSIGN   5115<<ASSIGN
TH_CONSTRAINTS
      3589**DCL      5066<<ASSIGN
TH_CONSTRAINTS.CROSS
      3596**DCL      5063<<ASSIGN   5105<<ASSIGN
TH_CONSTRAINTS.E_ACT
      3596**DCL      4823>>IF       4832<<ASSIGN
TH_CONSTRAINTS.E_ACT_SET
      3596**DCL      4710<<ASSIGN   4823>>IF       4825<<ASSIGN   4831<<ASSIGN
TH_CONSTRAINTS.E_BY_B
      3592**DCL      3592--REDEF
TH_CONSTRAINTS.E_BY_B_SET
      3593**DCL      4702<<ASSIGN   4880>>IF       4883<<ASSIGN   4889<<ASSIGN   4907>>IF       4910<<ASSIGN
      4916<<ASSIGN   5094<<ASSIGN
TH_CONSTRAINTS.E_BY_B_VEC
      3592**DCL      4880>>IF       4890<<ASSIGN   4907>>IF       4917<<ASSIGN
TH_CONSTRAINTS.E_CHAN
      3594**DCL      4958>>IF       4967<<ASSIGN
TH_CONSTRAINTS.E_CHAN_SET
      3594**DCL      4707<<ASSIGN   4958>>IF       4960<<ASSIGN   4966<<ASSIGN   5099<<ASSIGN
TH_CONSTRAINTS.E_COD
      3595**DCL      4783>>IF       4792<<ASSIGN
TH_CONSTRAINTS.E_COD_SET
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:432  
      3595**DCL      4708<<ASSIGN   4783>>IF       4785<<ASSIGN   4791<<ASSIGN
TH_CONSTRAINTS.E_FEP
      3594**DCL      4926>>IF       4935<<ASSIGN
TH_CONSTRAINTS.E_FEP_N
      3594**DCL      4936<<ASSIGN
TH_CONSTRAINTS.E_FEP_SET
      3594**DCL      4706<<ASSIGN   4926>>IF       4928<<ASSIGN   4934<<ASSIGN   5098<<ASSIGN
TH_CONSTRAINTS.E_MAJ
      3591**DCL      4732>>IF       4740<<ASSIGN
TH_CONSTRAINTS.E_MAJ_S
      3592**DCL      4703<<ASSIGN   4732>>IF       4733<<ASSIGN   4739<<ASSIGN   5095<<ASSIGN
TH_CONSTRAINTS.E_MED
      3592**DCL      4839>>IF       4847<<ASSIGN
TH_CONSTRAINTS.E_MED_S
      3592**DCL      4705<<ASSIGN   4839>>IF       4840<<ASSIGN   4846<<ASSIGN   5097<<ASSIGN
TH_CONSTRAINTS.E_REA
      3595**DCL      4806>>IF       4815<<ASSIGN
TH_CONSTRAINTS.E_REA_SET
      3596**DCL      4709<<ASSIGN   4806>>IF       4808<<ASSIGN   4814<<ASSIGN
TH_CONSTRAINTS.E_SUB
      3592**DCL      4761>>IF       4769<<ASSIGN
TH_CONSTRAINTS.E_SUB_S
      3592**DCL      4704<<ASSIGN   4761>>IF       4762<<ASSIGN   4768<<ASSIGN   5096<<ASSIGN
TH_CONSTRAINTS.M_ACT
      3595**DCL      4427>>IF       4436<<ASSIGN
TH_CONSTRAINTS.M_ACT_SET
      3595**DCL      4314<<ASSIGN   4427>>IF       4429<<ASSIGN   4435<<ASSIGN
TH_CONSTRAINTS.M_BY_B
      3591**DCL      3591--REDEF
TH_CONSTRAINTS.M_BY_B_SET
      3591**DCL      4306<<ASSIGN   4484>>IF       4487<<ASSIGN   4493<<ASSIGN   4511>>IF       4514<<ASSIGN
      4520<<ASSIGN   5084<<ASSIGN
TH_CONSTRAINTS.M_BY_B_VEC
      3591**DCL      4484>>IF       4494<<ASSIGN   4511>>IF       4521<<ASSIGN
TH_CONSTRAINTS.M_CHAN_SET
      3593**DCL      4311<<ASSIGN   4562>>IF       4585<<ASSIGN   4600<<ASSIGN   4607<<ASSIGN   5089<<ASSIGN
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:433  
TH_CONSTRAINTS.M_COD
      3594**DCL      4387>>IF       4396<<ASSIGN
TH_CONSTRAINTS.M_COD_SET
      3594**DCL      4312<<ASSIGN   4387>>IF       4389<<ASSIGN   4395<<ASSIGN
TH_CONSTRAINTS.M_FEP
      3593**DCL      4530>>IF       4539<<ASSIGN
TH_CONSTRAINTS.M_FEP_N
      3593**DCL      4540<<ASSIGN
TH_CONSTRAINTS.M_FEP_SET
      3593**DCL      4310<<ASSIGN   4530>>IF       4532<<ASSIGN   4538<<ASSIGN   5088<<ASSIGN
TH_CONSTRAINTS.M_MAJ
      3590**DCL      4336>>IF       4344<<ASSIGN
TH_CONSTRAINTS.M_MAJ_S
      3590**DCL      4307<<ASSIGN   4336>>IF       4337<<ASSIGN   4343<<ASSIGN   5085<<ASSIGN
TH_CONSTRAINTS.M_MED
      3590**DCL      4443>>IF       4451<<ASSIGN
TH_CONSTRAINTS.M_MED_S
      3591**DCL      4309<<ASSIGN   4443>>IF       4444<<ASSIGN   4450<<ASSIGN   5087<<ASSIGN
TH_CONSTRAINTS.M_REA
      3595**DCL      4410>>IF       4419<<ASSIGN
TH_CONSTRAINTS.M_REA_SET
      3595**DCL      4313<<ASSIGN   4410>>IF       4412<<ASSIGN   4418<<ASSIGN
TH_CONSTRAINTS.M_SUB
      3590**DCL      4365>>IF       4373<<ASSIGN
TH_CONSTRAINTS.M_SUB_S
      3590**DCL      4308<<ASSIGN   4365>>IF       4366<<ASSIGN   4372<<ASSIGN   5086<<ASSIGN
TH_CONSTRAINTS.NTYPES
      3589**DCL      4259<<ASSIGN   4278>>DOINDEX  4284>>ASSIGN   4285<<ASSIGN   4285>>ASSIGN   5081<<ASSIGN
TH_CONSTRAINTS.OCTAL
      3596**DCL      5061<<ASSIGN   5103<<ASSIGN
TH_CONSTRAINTS.START
      3590**DCL      5107<<ASSIGN   5116<<ASSIGN
TH_CONSTRAINTS.STOP
      3590**DCL      5108<<ASSIGN   5117<<ASSIGN
TH_CONSTRAINTS.TYPES
      3589**DCL      3589--REDEF    4279>>IF       4284<<ASSIGN
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:434  
TH_DEFAULT
      3596**DCL      5066>>ASSIGN
TH_DEFAULT.E_BY_B
      3600**DCL      3600--REDEF
TH_DEFAULT.M_BY_B
      3599**DCL      3599--REDEF
TH_DEFAULT.START
      3597**DCL      5107>>ASSIGN   5116>>ASSIGN
TH_DEFAULT.STOP
      3598**DCL      5108>>ASSIGN   5117>>ASSIGN
TH_DEFAULT.TYPES
      3597**DCL      3597--REDEF
TH_LAST_EXCLUDE.COUNT
      3622**DCL      4977>>IF       4992>>IF       4994<<ASSIGN   4994>>ASSIGN   4996<<ASSIGN   4996>>ASSIGN
      5014<<ASSIGN   5014>>ASSIGN   5015>>CALLBLT  5020<<ASSIGN   5074<<ASSIGN   5101<<ASSIGN
TH_LAST_EXCLUDE.TEXT
      3622**DCL      4973>>CALLBLT  4976>>DOWHILE  4989>>CALLBLT  4989>>CALLBLT  4991<<ASSIGN   5015<<CALLBLT
      5015>>CALLBLT  5021<<ASSIGN   5073<<ASSIGN   5100<<ASSIGN
TH_LAST_MATCH.COUNT
      3622**DCL      4622>>IF       4653>>IF       4655<<ASSIGN   4655>>ASSIGN   4657<<ASSIGN   4657>>ASSIGN
      4675<<ASSIGN   4675>>ASSIGN   4676>>CALLBLT  4681<<ASSIGN   5075<<ASSIGN   5092<<ASSIGN
TH_LAST_MATCH.TEXT
      3622**DCL      4616>>CALLBLT  4621>>DOWHILE  4624>>IF       4627>>IF       4649>>CALLBLT  4650>>CALLBLT
      4650>>CALLBLT  4652<<ASSIGN   4676<<CALLBLT  4676>>CALLBLT  4682<<ASSIGN   5072<<ASSIGN   5091<<ASSIGN
TH_M_CHAN.FLAG
      3657**DCL      4571<<ASSIGN   4580>>IF       4602<<ASSIGN   4609<<ASSIGN
TH_M_CHAN.TEXT
      3657**DCL      4567>>IF       4601<<ASSIGN   4608<<ASSIGN
TH_M_CHAN_TOTAL
      3657**DCL      4566>>DOINDEX  4579>>DOINDEX  4601>>ASSIGN   4602>>ASSIGN   4603<<ASSIGN   4603>>ASSIGN
      4610<<ASSIGN   5090<<ASSIGN
TH_OPEN_ERRLOG.ACCT_
      4184**DCL      5069<<ASSIGN   5113<<ASSIGN
TH_OPEN_ERRLOG.ACSVEH_
      4182**DCL      4183--REDEF
TH_OPEN_ERRLOG.ALTKEYS_
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:435  
      4188**DCL      4189--REDEF    4189--REDEF
TH_OPEN_ERRLOG.HDR_
      4187**DCL      4188--REDEF
TH_OPEN_ERRLOG.NAME_
      4181**DCL      5070<<ASSIGN   5114<<ASSIGN
TH_OPEN_ERRLOG.TAB_
      4186**DCL      4187--REDEF
TH_OPEN_ERRLOG.UHL_
      4180**DCL      4181--REDEF    4181--REDEF
TH_OPEN_ERRLOG.V.FSN#
      4220**DCL      4220--REDEF    4220--REDEF
TH_OPEN_ERRLOG.WSN_
      4186**DCL      4186--REDEF
TH_RECOV
      3623**DCL      4260<<ASSIGN   4271<<ASSIGN   5067<<ASSIGN   5082<<ASSIGN
TH_SAVE.E_BY_B
      3608**DCL      3608--REDEF
TH_SAVE.M_BY_B
      3606**DCL      3606--REDEF
TH_SAVE.TYPES
      3604**DCL      3605--REDEF
TH_VLP_ERRLOG
      4251**DCL      5070--ASSIGN   5114--ASSIGN
TH_XSA_BUF_VECTOR
      3624**DCL      3624--REDEF
TOP$
         9**DCL         6--PROC     3836--IMP-PTR  4255>>DOCASE   4258>>IF       4263>>DOINDEX  4264>>IF
      4265>>CALLBLT  4265>>CALLBLT  4266>>ASSIGN   4293>>IF       4299>>IF       4316>>DOINDEX  4317>>ASSIGN
      4689>>IF       4695>>IF       4712>>DOINDEX  4713>>ASSIGN   5065>>IF       5078>>DOINDEX  5079>>DOCASE
VALUE
      3803**DCL      4265<<CALLBLT  4266<<ASSIGN   4267>>ASSIGN   4270>>IF       4277<<ASSIGN   4279>>IF
      4284>>ASSIGN   4324<<ASSIGN   4326<<ASSIGN   4326>>ASSIGN   4327>>ASSIGN   4330<<CALLBLT  4332>>ASSIGN
      4377<<ASSIGN   4380<<ASSIGN   4380>>ASSIGN   4382<<ASSIGN   4382>>ASSIGN   4384>>ASSIGN   4400<<ASSIGN
      4403<<ASSIGN   4403>>ASSIGN   4405<<ASSIGN   4405>>ASSIGN   4407>>ASSIGN   4423<<CALLBLT  4424>>ASSIGN
      4455<<CALLBLT  4456>>IF       4461>>ASSIGN   4464<<CALLBLT  4466>>IF       4471>>ASSIGN   4472<<CALLBLT
      4474>>IF       4474>>IF       4480>>ASSIGN   4500<<CALLBLT  4501>>IF       4501>>IF       4507>>ASSIGN
PL6.E3A0      #007=THC$SELECT File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:11 Page:436  
      4720<<ASSIGN   4722<<ASSIGN   4722>>ASSIGN   4723>>ASSIGN   4726<<CALLBLT  4728>>ASSIGN   4773<<ASSIGN
      4776<<ASSIGN   4776>>ASSIGN   4778<<ASSIGN   4778>>ASSIGN   4780>>ASSIGN   4796<<ASSIGN   4799<<ASSIGN
      4799>>ASSIGN   4801<<ASSIGN   4801>>ASSIGN   4803>>ASSIGN   4819<<CALLBLT  4820>>ASSIGN   4851<<CALLBLT
      4852>>IF       4857>>ASSIGN   4860<<CALLBLT  4862>>IF       4867>>ASSIGN   4868<<CALLBLT  4870>>IF
      4870>>IF       4876>>ASSIGN   4896<<CALLBLT  4897>>IF       4897>>IF       4903>>ASSIGN
VLP_SYSTAC
      3641**DCL      5069--ASSIGN   5113--ASSIGN
VLP_SYSTAC.ACCT#
      3641**DCL      5068<<ASSIGN   5110<<ASSIGN
WRONG
      4592**LABEL    4588--GOTO

PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:437  
     2424        1        /*T***********************************************************/
     2425        2        /*T*                                                         */
     2426        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2427        4        /*T*                                                         */
     2428        5        /*T***********************************************************/
     2429        6        THC$SPAN: PROC(TOP$) ALTRET;
     2430        7        /**/
     2431        8        /* PARAMS */
     2432        9    1   DCL TOP$ PTR;
     2433       10        /**/
     2434       11        /* INCLUDE FILES */
     2435       12        %INCLUDE CP_6;
     2436       93        %INCLUDE XU_MACRO_C;
     2437     3199        %INCLUDE TH_SUBS_C;
     2438     3581        %INCLUDE TH_DATA_R;
     2439     3659        %INCLUDE TH_PERR_C;
     2440     3700        %INCLUDE XUD_UTS_M;
     2441     3782        /**/
     2442     3783        /* VARS */
     2443     3784    1   DCL I UBIN;
     2444     3785    1   DCL VALUE UBIN;
     2445     3786    1   DCL STOP UBIN WORD ;
     2446     3787    1   DCL TEMP UBIN WORD STATIC;
     2447     3788    1   DCL START UBIN WORD;
     2448     3789    1   DCL TBUF CHAR(5) STATIC;
     2449     3790    1   DCL DBUF CHAR(8) STATIC;
     2450     3791        /**/
     2451     3792        /* ENTRY DEFS */
     2452     3793    1   DCL THC$CVTUTS ENTRY(3) ALTRET;
     2453     3794    1   DCL THM$ERRMSG ENTRY(1);
     2454     3795        /**/
     2455     3796        /* FPT DEFS */
     2456     3797        %FPT_TIME (FPTN=CUR_TIME,
     2457     3798                   SOURCE=CLOCK,
     2458     3799                   DEST=UTS,
     2459     3800                   TSTAMP=TEMP);
     2460     3819        /**/
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:438  
     2461     3820        /* MACRO INVOCATIONS */
     2462     3821        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2463     3866        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED");
     2464     3904        %XUD$UTS_ENTRIES;
     2465     3936        %XUD_UTS_EQU;
     2466     3947        %EJECT;
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:439  
     2467     3948    1           START = TH_CONSTRAINTS.START;
     2468     3949    1           STOP = TH_CONSTRAINTS.STOP;
     2469     3950    2            DO CASE(OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);
     2470     3951    2              CASE (%TIME_X);
     2471     3952    2                 CALL M$TIME (CUR_TIME);
     2472     3953    2                 CALL CHARBIN(I,OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->
     2473     3954    2                                OUT$SYM.TEXT);
     2474     3955    3                 DO CASE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE);
     2475     3956    3                    CASE (%DAYS);
     2476     3957    3                      CALL XUD$UTS_ADJ_25TH (START, TH_DEFAULT.START, -(I*%
              3957                               UTS_25TH_DAY#));
     2477     3958    3                       STOP = TH_DEFAULT.STOP;
     2478     3959    3                    CASE (%WEEKS);
     2479     3960    3                      CALL XUD$UTS_ADJ_25TH (START, TH_DEFAULT.START, -(I*7*%
              3960                               UTS_25TH_DAY#));
     2480     3961    3                       STOP = TH_DEFAULT.STOP;
     2481     3962    3                    CASE (%MONTHS);
     2482     3963    3                      CALL XUD$UTS_ADJ_25TH (START, TH_DEFAULT.START, -(I*30*%
              3963                               UTS_25TH_DAY#));
     2483     3964    3                       STOP = TH_DEFAULT.STOP;
     2484     3965    3                    CASE (%YEAR);
     2485     3966    3                      CALL XUD$UTS_ADJ_25TH (START, TH_DEFAULT.START, -(I*365*%
              3966                               UTS_25TH_DAY#));
     2486     3967    3                       STOP = TH_DEFAULT.STOP;
     2487     3968    3                   CASE (%MINUTES);
     2488     3969    3                      CALL XUD$UTS_ADJ_25TH (START, TEMP, -(I*%UTS_25TH_MIN#));
     2489     3970    3                       STOP = TEMP;
     2490     3971    3                   CASE (%HOURS);
     2491     3972    3                      CALL XUD$UTS_ADJ_25TH (START, TEMP, -(I*%UTS_25TH_HOUR#));
     2492     3973    3                       STOP = TEMP;
     2493     3974    3                 END;                     /* OF DO CASE TIME_X */
     2494     3975    2              CASE (%TIME_N);
     2495     3976    3                 DO I = 0 TO OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS - 1;
     2496     3977    4                   DO CASE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(I)->
     2497     3978    4                            OUT$BLK.CODE);
     2498     3979    4                      CASE(%START);
     2499     3980    4                           CALL THC$CVTUTS(OUT$BLK.SUBLK$(0)->
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:440  
     2500     3981    4                             OUT$BLK.SUBLK$(I),-1,VALUE) ALTRET(ERR_LBL);
     2501     3982    4                           START = VALUE;
     2502     3983    4                      CASE(%STOP);
     2503     3984    4                           CALL THC$CVTUTS(OUT$BLK.SUBLK$(0)->
     2504     3985    4                             OUT$BLK.SUBLK$(I),1,VALUE) ALTRET(ERR_LBL);
     2505     3986    4                           STOP = VALUE;
     2506     3987    4                   END;              /* CASE CODE */
     2507     3988    3                 END;                /* DO I                  */
     2508     3989    2             CASE (%TODAY);
     2509     3990    3                DO;
     2510     3991    3                  START = TH_DEFAULT.START;
     2511     3992    3                  STOP  = TH_DEFAULT.STOP;
     2512     3993    3                END;
     2513     3994    2         END;                        /* OF DO CASE TIME_X OR TIME_N */
     2514     3995    1           IF STOP < START
     2515     3996    1              THEN                         /* BAD TIME CONSTRAINTS               */
     2516     3997    2              DO;
     2517     3998    2                 CALL THM$ERRMSG(%E$TH_BAD_TIME_RANGE);
     2518     3999    2                 ALTRETURN;
     2519     4000    2              END;                         /* IF BAD TIME RANGE                  */
     2520     4001    1           TH_CONSTRAINTS.START = START;
     2521     4002    1           TH_CONSTRAINTS.STOP = STOP;
     2522     4003    1           RETURN;
     2523     4004                /*E* ERROR: THE-E$TH_BAD_TIME_RANGE-0
     2524     4005                     MESSAGE:  Bad time span : START > STOP
     2525     4006                */
     2526     4007    1     ERR_LBL:
     2527     4008    1        CALL THM$ERRMSG(%E$TH_BADTIME);
     2528     4009    1        ALTRETURN;
     2529     4010             /*E* ERROR: THE-E$TH_BADTIME-0
     2530     4011                  MESSAGE: Illegal format for time or date
     2531     4012             */
     2532     4013    1   END THC$SPAN;
     2533     4014        %EOD;

PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:441  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$SPAN.

   Procedure THC$SPAN requires 220 words for executable code.
   Procedure THC$SPAN requires 12 words of local(AUTO) storage.

PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:442  

 Object Unit name= THC$SPAN                                   File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:12:58.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    18     22  THC$SPAN
    2   Proc  even  none   220    334  THC$SPAN
    3  RoData even  none    12     14  THC$SPAN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  THC$SPAN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
 yes     yes           Std       3 THC$CVTUTS
         yes           Std       1 THM$ERRMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:443  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_DEFAULT
     TH_XSA_BUF_VECTOR                     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:444  


     2424        1        /*T***********************************************************/
     2425        2        /*T*                                                         */
     2426        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2427        4        /*T*                                                         */
     2428        5        /*T***********************************************************/
     2429        6        THC$SPAN: PROC(TOP$) ALTRET;

      6  2 000000   000000 700200 xent  THC$SPAN     TSX0  ! X66_AUTO_1
         2 000001   000014 000001                    ZERO    12,1

     2430        7        /**/
     2431        8        /* PARAMS */
     2432        9    1   DCL TOP$ PTR;
     2433       10        /**/
     2434       11        /* INCLUDE FILES */
     2435       12        %INCLUDE CP_6;
     2436       93        %INCLUDE XU_MACRO_C;
     2437     3199        %INCLUDE TH_SUBS_C;
     2438     3581        %INCLUDE TH_DATA_R;
     2439     3659        %INCLUDE TH_PERR_C;
     2440     3700        %INCLUDE XUD_UTS_M;
     2441     3782        /**/
     2442     3783        /* VARS */
     2443     3784    1   DCL I UBIN;
     2444     3785    1   DCL VALUE UBIN;
     2445     3786    1   DCL STOP UBIN WORD ;
     2446     3787    1   DCL TEMP UBIN WORD STATIC;
     2447     3788    1   DCL START UBIN WORD;
     2448     3789    1   DCL TBUF CHAR(5) STATIC;
     2449     3790    1   DCL DBUF CHAR(8) STATIC;
     2450     3791        /**/
     2451     3792        /* ENTRY DEFS */
     2452     3793    1   DCL THC$CVTUTS ENTRY(3) ALTRET;
     2453     3794    1   DCL THM$ERRMSG ENTRY(1);
     2454     3795        /**/
     2455     3796        /* FPT DEFS */
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:445  
     2456     3797        %FPT_TIME (FPTN=CUR_TIME,
     2457     3798                   SOURCE=CLOCK,
     2458     3799                   DEST=UTS,
     2459     3800                   TSTAMP=TEMP);
     2460     3819        /**/
     2461     3820        /* MACRO INVOCATIONS */
     2462     3821        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2463     3866        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED");
     2464     3904        %XUD$UTS_ENTRIES;
     2465     3936        %XUD_UTS_EQU;
     2466     3947        %EJECT;
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:446  
     2467     3948    1           START = TH_CONSTRAINTS.START;

   3948  2 000002   000012 235000 xsym               LDA     TH_CONSTRAINTS+10
         2 000003   200007 755100                    STA     START,,AUTO

     2468     3949    1           STOP = TH_CONSTRAINTS.STOP;

   3949  2 000004   000013 236000 xsym               LDQ     TH_CONSTRAINTS+11
         2 000005   200006 756100                    STQ     STOP,,AUTO

     2469     3950    2            DO CASE(OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);

   3950  2 000006   200003 470500                    LDP0    @TOP$,,AUTO
         2 000007   000000 471500                    LDP1    0,,PR0
         2 000010   100003 473500                    LDP3    3,,PR1
         2 000011   300000 720100                    LXL0    0,,PR3
         2 000012   000004 100003                    CMPX0   4,DU
         2 000013   000015 602010 2                  TNC     s:3950+7,X0
         2 000014   000313 710000 2                  TRA     s:3995
         2 000015   000313 710000 2                  TRA     s:3995
         2 000016   000224 710000 2                  TRA     s:3976
         2 000017   000021 710000 2                  TRA     s:3952
         2 000020   000307 710000 2                  TRA     s:3991

     2470     3951    2              CASE (%TIME_X);

     2471     3952    2                 CALL M$TIME (CUR_TIME);

   3952  2 000021   000006 630400 1                  EPPR0   CUR_TIME
         2 000022   020004 713400                    CLIMB   8196
         2 000023   402000 401760                    pmme    nvectors=5

     2472     3953    2                 CALL CHARBIN(I,OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->

   3953  2 000024   200003 470500                    LDP0    @TOP$,,AUTO
         2 000025   000000 471500                    LDP1    0,,PR0
         2 000026   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:447  
         2 000027   300003 474500                    LDP4    3,,PR3
         2 000030   400004 236100                    LDQ     4,,PR4
         2 000031   000033 772000                    QRL     27
         2 000032   000000 620006                    EAX0    0,QL
         2 000033   000100 305540                    DTB
         2 000034   400004 230010                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X0
         2 000035   200010 000010                    NDSC9   START+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 000036   200011 235100                    LDA     START+2,,AUTO
         2 000037   200004 755100                    STA     I,,AUTO

     2473     3954    2                                OUT$SYM.TEXT);
     2474     3955    3                 DO CASE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE);

   3955  2 000040   000000 471500                    LDP1    0,,PR0
         2 000041   100003 473500                    LDP3    3,,PR1
         2 000042   300004 474500                    LDP4    4,,PR3
         2 000043   400000 720100                    LXL0    0,,PR4
         2 000044   000007 100003                    CMPX0   7,DU
         2 000045   000047 602010 2                  TNC     s:3955+7,X0
         2 000046   000313 710000 2                  TRA     s:3995
         2 000047   000223 710000 2                  TRA     s:3974
         2 000050   000056 710000 2                  TRA     s:3957
         2 000051   000077 710000 2                  TRA     s:3960
         2 000052   000120 710000 2                  TRA     s:3963
         2 000053   000141 710000 2                  TRA     s:3966
         2 000054   000162 710000 2                  TRA     s:3969
         2 000055   000203 710000 2                  TRA     s:3972

     2475     3956    3                    CASE (%DAYS);

     2476     3957    3                      CALL XUD$UTS_ADJ_25TH (START, TH_DEFAULT.START, -(I*%
              3957                               UTS_25TH_DAY#));

   3957  2 000056   000000 236003                    LDQ     0,DU
         2 000057   200004 136100                    SBLQ    I,,AUTO
         2 000060   000000 402000 3                  MPY     0
         2 000061   200010 756100                    STQ     START+1,,AUTO
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:448  
         2 000062   200010 631500                    EPPR1   START+1,,AUTO
         2 000063   200013 451500                    STP1    START+4,,AUTO
         2 000064   000001 236000 3                  LDQ     1
         2 000065   200012 756100                    STQ     START+3,,AUTO
         2 000066   200007 633500                    EPPR3   START,,AUTO
         2 000067   200011 453500                    STP3    START+2,,AUTO
         2 000070   200011 630500                    EPPR0   START+2,,AUTO
         2 000071   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000072   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         2 000073   000000 011000                    NOP     0

     2477     3958    3                       STOP = TH_DEFAULT.STOP;

   3958  2 000074   000013 235000 xsym               LDA     TH_DEFAULT+11
         2 000075   200006 755100                    STA     STOP,,AUTO
         2 000076   000313 710000 2                  TRA     s:3995

     2478     3959    3                    CASE (%WEEKS);

     2479     3960    3                      CALL XUD$UTS_ADJ_25TH (START, TH_DEFAULT.START, -(I*7*%
              3960                               UTS_25TH_DAY#));

   3960  2 000077   000000 236003                    LDQ     0,DU
         2 000100   200004 136100                    SBLQ    I,,AUTO
         2 000101   000002 402000 3                  MPY     2
         2 000102   200010 756100                    STQ     START+1,,AUTO
         2 000103   200010 631500                    EPPR1   START+1,,AUTO
         2 000104   200013 451500                    STP1    START+4,,AUTO
         2 000105   000001 236000 3                  LDQ     1
         2 000106   200012 756100                    STQ     START+3,,AUTO
         2 000107   200007 633500                    EPPR3   START,,AUTO
         2 000110   200011 453500                    STP3    START+2,,AUTO
         2 000111   200011 630500                    EPPR0   START+2,,AUTO
         2 000112   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000113   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         2 000114   000000 011000                    NOP     0

PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:449  
     2480     3961    3                       STOP = TH_DEFAULT.STOP;

   3961  2 000115   000013 235000 xsym               LDA     TH_DEFAULT+11
         2 000116   200006 755100                    STA     STOP,,AUTO
         2 000117   000313 710000 2                  TRA     s:3995

     2481     3962    3                    CASE (%MONTHS);

     2482     3963    3                      CALL XUD$UTS_ADJ_25TH (START, TH_DEFAULT.START, -(I*30*%
              3963                               UTS_25TH_DAY#));

   3963  2 000120   000000 236003                    LDQ     0,DU
         2 000121   200004 136100                    SBLQ    I,,AUTO
         2 000122   000003 402000 3                  MPY     3
         2 000123   200010 756100                    STQ     START+1,,AUTO
         2 000124   200010 631500                    EPPR1   START+1,,AUTO
         2 000125   200013 451500                    STP1    START+4,,AUTO
         2 000126   000001 236000 3                  LDQ     1
         2 000127   200012 756100                    STQ     START+3,,AUTO
         2 000130   200007 633500                    EPPR3   START,,AUTO
         2 000131   200011 453500                    STP3    START+2,,AUTO
         2 000132   200011 630500                    EPPR0   START+2,,AUTO
         2 000133   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000134   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         2 000135   000000 011000                    NOP     0

     2483     3964    3                       STOP = TH_DEFAULT.STOP;

   3964  2 000136   000013 235000 xsym               LDA     TH_DEFAULT+11
         2 000137   200006 755100                    STA     STOP,,AUTO
         2 000140   000313 710000 2                  TRA     s:3995

     2484     3965    3                    CASE (%YEAR);

     2485     3966    3                      CALL XUD$UTS_ADJ_25TH (START, TH_DEFAULT.START, -(I*365*%
              3966                               UTS_25TH_DAY#));

PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:450  
   3966  2 000141   000000 236003                    LDQ     0,DU
         2 000142   200004 136100                    SBLQ    I,,AUTO
         2 000143   000004 402000 3                  MPY     4
         2 000144   200010 756100                    STQ     START+1,,AUTO
         2 000145   200010 631500                    EPPR1   START+1,,AUTO
         2 000146   200013 451500                    STP1    START+4,,AUTO
         2 000147   000001 236000 3                  LDQ     1
         2 000150   200012 756100                    STQ     START+3,,AUTO
         2 000151   200007 633500                    EPPR3   START,,AUTO
         2 000152   200011 453500                    STP3    START+2,,AUTO
         2 000153   200011 630500                    EPPR0   START+2,,AUTO
         2 000154   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000155   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         2 000156   000000 011000                    NOP     0

     2486     3967    3                       STOP = TH_DEFAULT.STOP;

   3967  2 000157   000013 235000 xsym               LDA     TH_DEFAULT+11
         2 000160   200006 755100                    STA     STOP,,AUTO
         2 000161   000313 710000 2                  TRA     s:3995

     2487     3968    3                   CASE (%MINUTES);

     2488     3969    3                      CALL XUD$UTS_ADJ_25TH (START, TEMP, -(I*%UTS_25TH_MIN#));

   3969  2 000162   000000 236003                    LDQ     0,DU
         2 000163   200004 136100                    SBLQ    I,,AUTO
         2 000164   002734 402007                    MPY     1500,DL
         2 000165   200010 756100                    STQ     START+1,,AUTO
         2 000166   200010 631500                    EPPR1   START+1,,AUTO
         2 000167   200013 451500                    STP1    START+4,,AUTO
         2 000170   000005 236000 3                  LDQ     5
         2 000171   200012 756100                    STQ     START+3,,AUTO
         2 000172   200007 633500                    EPPR3   START,,AUTO
         2 000173   200011 453500                    STP3    START+2,,AUTO
         2 000174   200011 630500                    EPPR0   START+2,,AUTO
         2 000175   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:451  
         2 000176   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         2 000177   000000 011000                    NOP     0

     2489     3970    3                       STOP = TEMP;

   3970  2 000200   000000 235000 1                  LDA     TEMP
         2 000201   200006 755100                    STA     STOP,,AUTO
         2 000202   000313 710000 2                  TRA     s:3995

     2490     3971    3                   CASE (%HOURS);

     2491     3972    3                      CALL XUD$UTS_ADJ_25TH (START, TEMP, -(I*%UTS_25TH_HOUR#));

   3972  2 000203   000000 236003                    LDQ     0,DU
         2 000204   200004 136100                    SBLQ    I,,AUTO
         2 000205   257620 402007                    MPY     90000,DL
         2 000206   200010 756100                    STQ     START+1,,AUTO
         2 000207   200010 631500                    EPPR1   START+1,,AUTO
         2 000210   200013 451500                    STP1    START+4,,AUTO
         2 000211   000005 236000 3                  LDQ     5
         2 000212   200012 756100                    STQ     START+3,,AUTO
         2 000213   200007 633500                    EPPR3   START,,AUTO
         2 000214   200011 453500                    STP3    START+2,,AUTO
         2 000215   200011 630500                    EPPR0   START+2,,AUTO
         2 000216   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000217   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         2 000220   000000 011000                    NOP     0

     2492     3973    3                       STOP = TEMP;

   3973  2 000221   000000 235000 1                  LDA     TEMP
         2 000222   200006 755100                    STA     STOP,,AUTO

     2493     3974    3                 END;                     /* OF DO CASE TIME_X */

   3974  2 000223   000313 710000 2                  TRA     s:3995

PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:452  
     2494     3975    2              CASE (%TIME_N);

     2495     3976    3                 DO I = 0 TO OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS - 1;

   3976  2 000224   200004 450100                    STZ     I,,AUTO
         2 000225   000276 710000 2                  TRA     s:3988+3

     2496     3977    4                   DO CASE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(I)->

   3977  2 000226   200003 470500                    LDP0    @TOP$,,AUTO
         2 000227   000000 471500                    LDP1    0,,PR0
         2 000230   100003 473500                    LDP3    3,,PR1
         2 000231   200004 720100                    LXL0    I,,AUTO
         2 000232   300003 474510                    LDP4    3,X0,PR3
         2 000233   400000 721100                    LXL1    0,,PR4
         2 000234   000003 101003                    CMPX1   3,DU
         2 000235   000237 602011 2                  TNC     s:3977+9,X1
         2 000236   000273 710000 2                  TRA     s:3988
         2 000237   000273 710000 2                  TRA     s:3988
         2 000240   000242 710000 2                  TRA     s:3980
         2 000241   000257 710000 2                  TRA     s:3984

     2497     3978    4                            OUT$BLK.CODE);
     2498     3979    4                      CASE(%START);

     2499     3980    4                           CALL THC$CVTUTS(OUT$BLK.SUBLK$(0)->

   3980  2 000242   200005 635500                    EPPR5   VALUE,,AUTO
         2 000243   200012 455500                    STP5    START+3,,AUTO
         2 000244   000006 236000 3                  LDQ     6
         2 000245   200011 756100                    STQ     START+2,,AUTO
         2 000246   300003 631510                    EPPR1   3,X0,PR3
         2 000247   200010 451500                    STP1    START+1,,AUTO
         2 000250   200010 630500                    EPPR0   START+1,,AUTO
         2 000251   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000252   000000 701000 xent               TSX1    THC$CVTUTS
         2 000253   000327 702000 2                  TSX2    ERR_LBL
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:453  

     2500     3981    4                             OUT$BLK.SUBLK$(I),-1,VALUE) ALTRET(ERR_LBL);
     2501     3982    4                           START = VALUE;

   3982  2 000254   200005 235100                    LDA     VALUE,,AUTO
         2 000255   200007 755100                    STA     START,,AUTO
         2 000256   000273 710000 2                  TRA     s:3988

     2502     3983    4                      CASE(%STOP);

     2503     3984    4                           CALL THC$CVTUTS(OUT$BLK.SUBLK$(0)->

   3984  2 000257   200005 635500                    EPPR5   VALUE,,AUTO
         2 000260   200012 455500                    STP5    START+3,,AUTO
         2 000261   000007 236000 3                  LDQ     7
         2 000262   200011 756100                    STQ     START+2,,AUTO
         2 000263   300003 631510                    EPPR1   3,X0,PR3
         2 000264   200010 451500                    STP1    START+1,,AUTO
         2 000265   200010 630500                    EPPR0   START+1,,AUTO
         2 000266   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000267   000000 701000 xent               TSX1    THC$CVTUTS
         2 000270   000327 702000 2                  TSX2    ERR_LBL

     2504     3985    4                             OUT$BLK.SUBLK$(I),1,VALUE) ALTRET(ERR_LBL);
     2505     3986    4                           STOP = VALUE;

   3986  2 000271   200005 235100                    LDA     VALUE,,AUTO
         2 000272   200006 755100                    STA     STOP,,AUTO

     2506     3987    4                   END;              /* CASE CODE */

     2507     3988    3                 END;                /* DO I                  */

   3988  2 000273   200004 235100                    LDA     I,,AUTO
         2 000274   000001 035007                    ADLA    1,DL
         2 000275   200004 755100                    STA     I,,AUTO
         2 000276   200003 470500                    LDP0    @TOP$,,AUTO
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:454  
         2 000277   000000 471500                    LDP1    0,,PR0
         2 000300   100003 473500                    LDP3    3,,PR1
         2 000301   300001 236100                    LDQ     1,,PR3
         2 000302   000022 772000                    QRL     18
         2 000303   200004 116100                    CMPQ    I,,AUTO
         2 000304   000306 600000 2                  TZE     s:3988+11
         2 000305   000226 603000 2                  TRC     s:3977
         2 000306   000313 710000 2                  TRA     s:3995

     2508     3989    2             CASE (%TODAY);

     2509     3990    3                DO;

     2510     3991    3                  START = TH_DEFAULT.START;

   3991  2 000307   000012 235000 xsym               LDA     TH_DEFAULT+10
         2 000310   200007 755100                    STA     START,,AUTO

     2511     3992    3                  STOP  = TH_DEFAULT.STOP;

   3992  2 000311   000013 235000 xsym               LDA     TH_DEFAULT+11
         2 000312   200006 755100                    STA     STOP,,AUTO

     2512     3993    3                END;

     2513     3994    2         END;                        /* OF DO CASE TIME_X OR TIME_N */

     2514     3995    1           IF STOP < START

   3995  2 000313   200006 236100                    LDQ     STOP,,AUTO
         2 000314   200007 116100                    CMPQ    START,,AUTO
         2 000315   000323 603000 2                  TRC     s:4001

     2515     3996    1              THEN                         /* BAD TIME CONSTRAINTS               */
     2516     3997    2              DO;

     2517     3998    2                 CALL THM$ERRMSG(%E$TH_BAD_TIME_RANGE);
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:455  

   3998  2 000316   000011 630400 3                  EPPR0   9
         2 000317   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000320   000000 701000 xent               TSX1    THM$ERRMSG
         2 000321   000000 011000                    NOP     0

     2518     3999    2                 ALTRETURN;

   3999  2 000322   000000 702200 xent               TSX2  ! X66_AALT

     2519     4000    2              END;                         /* IF BAD TIME RANGE                  */
     2520     4001    1           TH_CONSTRAINTS.START = START;

   4001  2 000323   200007 235100                    LDA     START,,AUTO
         2 000324   000012 755000 xsym               STA     TH_CONSTRAINTS+10

     2521     4002    1           TH_CONSTRAINTS.STOP = STOP;

   4002  2 000325   000013 756000 xsym               STQ     TH_CONSTRAINTS+11

     2522     4003    1           RETURN;

   4003  2 000326   000000 702200 xent               TSX2  ! X66_ARET

     2523     4004                /*E* ERROR: THE-E$TH_BAD_TIME_RANGE-0
     2524     4005                     MESSAGE:  Bad time span : START > STOP
     2525     4006                */
     2526     4007    1     ERR_LBL:
     2527     4008    1        CALL THM$ERRMSG(%E$TH_BADTIME);

   4008  2 000327   000013 630400 3     ERR_LBL      EPPR0   11
         2 000330   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000331   000000 701000 xent               TSX1    THM$ERRMSG
         2 000332   000000 011000                    NOP     0

     2528     4009    1        ALTRETURN;

PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:456  
   4009  2 000333   000000 702200 xent               TSX2  ! X66_AALT
     2529     4010             /*E* ERROR: THE-E$TH_BADTIME-0
     2530     4011                  MESSAGE: Illegal format for time or date
     2531     4012             */
     2532     4013    1   END THC$SPAN;
     2533     4014        %EOD;

PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:457  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$SPAN.
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:458  

 **** Variables and constants ****

  ****  Section 001  Data  THC$SPAN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/d STRC(432)   r     1 CUR_TIME                   0-0-0/w UBIN        r     1 TEMP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                      4-0-0/w UBIN        r     1 I
     7-0-0/w UBIN        r     1 START                      6-0-0/w UBIN        r     1 STOP
    *0-0-0/w PTR         r     1 TOP$                       5-0-0/w UBIN        r     1 VALUE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS             0-0-0/d STRC(1971)  r     1 TH_DEFAULT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure THC$SPAN requires 220 words for executable code.
   Procedure THC$SPAN requires 12 words of local(AUTO) storage.
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:459  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:460  
          MINI XREF LISTING

CUR_TIME
      3811**DCL      3952<>CALL
CUR_TIME.V
      3815**DCL      3811--DCLINIT
ERR_LBL
      4008**LABEL    3980--CALLALT  3984--CALLALT
I
      3784**DCL      3953<<CALLBLT  3957>>CALL     3960>>CALL     3963>>CALL     3966>>CALL     3969>>CALL
      3972>>CALL     3976<<DOINDEX  3977>>DOCASE   3980>>CALL     3984>>CALL
M$TIME
        88**DCL-ENT  3952--CALL
OUT$BLK.CODE
      3835**DCL      3950>>DOCASE   3955>>DOCASE   3977>>DOCASE
OUT$BLK.NSUBLKS
      3839**DCL      3976>>DOINDEX
OUT$BLK.SUBLK$
      3860**DCL      3950>>DOCASE   3953>>CALLBLT  3953>>CALLBLT  3953>>CALLBLT  3953>>CALLBLT  3955>>DOCASE
      3955>>DOCASE   3976>>DOINDEX  3977>>DOCASE   3977>>DOCASE   3980>>CALL     3980<>CALL     3984>>CALL
      3984<>CALL
OUT$SYM.COUNT
      3896**DCL      3899--IMP-SIZ  3953>>CALLBLT
OUT$SYM.TEXT
      3899**DCL      3953>>CALLBLT
START
      3788**DCL      3948<<ASSIGN   3957<>CALL     3960<>CALL     3963<>CALL     3966<>CALL     3969<>CALL
      3972<>CALL     3982<<ASSIGN   3991<<ASSIGN   3995>>IF       4001>>ASSIGN
STOP
      3786**DCL      3949<<ASSIGN   3958<<ASSIGN   3961<<ASSIGN   3964<<ASSIGN   3967<<ASSIGN   3970<<ASSIGN
      3973<<ASSIGN   3986<<ASSIGN   3992<<ASSIGN   3995>>IF       4002>>ASSIGN
TEMP
      3787**DCL      3815--DCLINIT  3969<>CALL     3970>>ASSIGN   3972<>CALL     3973>>ASSIGN
THC$CVTUTS
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:461  
      3793**DCL-ENT  3980--CALL     3984--CALL
THM$ERRMSG
      3794**DCL-ENT  3998--CALL     4008--CALL
TH_CONSTRAINTS.E_BY_B
      3592**DCL      3592--REDEF
TH_CONSTRAINTS.M_BY_B
      3591**DCL      3591--REDEF
TH_CONSTRAINTS.START
      3590**DCL      3948>>ASSIGN   4001<<ASSIGN
TH_CONSTRAINTS.STOP
      3590**DCL      3949>>ASSIGN   4002<<ASSIGN
TH_CONSTRAINTS.TYPES
      3589**DCL      3589--REDEF
TH_DEFAULT.E_BY_B
      3600**DCL      3600--REDEF
TH_DEFAULT.M_BY_B
      3599**DCL      3599--REDEF
TH_DEFAULT.START
      3597**DCL      3957<>CALL     3960<>CALL     3963<>CALL     3966<>CALL     3991>>ASSIGN
TH_DEFAULT.STOP
      3598**DCL      3958>>ASSIGN   3961>>ASSIGN   3964>>ASSIGN   3967>>ASSIGN   3992>>ASSIGN
TH_DEFAULT.TYPES
      3597**DCL      3597--REDEF
TH_SAVE.E_BY_B
      3608**DCL      3608--REDEF
TH_SAVE.M_BY_B
      3606**DCL      3606--REDEF
TH_SAVE.TYPES
      3604**DCL      3605--REDEF
TH_XSA_BUF_VECTOR
      3624**DCL      3624--REDEF
TOP$
         9**DCL         6--PROC     3827--IMP-PTR  3950>>DOCASE   3953>>CALLBLT  3953>>CALLBLT  3955>>DOCASE
      3976>>DOINDEX  3977>>DOCASE   3980>>CALL     3984>>CALL
VALUE
      3785**DCL      3980<>CALL     3982>>ASSIGN   3984<>CALL     3986>>ASSIGN
PL6.E3A0      #008=THC$SPAN File=THC$COMMANDS.:E05TSI                            WED 07/30/97 06:12 Page:462  
XUD$UTS_ADJ_25TH
      3929**DCL-ENT  3957--CALL     3960--CALL     3963--CALL     3966--CALL     3969--CALL     3972--CALL

PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:463  
     2534        1        /*M* THC$CVTUTS - CONVERTS TEXT INPUT TO TIME CONSTRAINT FOR ELAN */
     2535        2        /*T***********************************************************/
     2536        3        /*T*                                                         */
     2537        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2538        5        /*T*                                                         */
     2539        6        /*T***********************************************************/
     2540        7        THC$CVTUTS: PROC(TOP$,DAYFLG,UTS) ALTRET;
     2541        8        /**/
     2542        9        /* PARAMS */
     2543       10    1   DCL TOP$ PTR;
     2544       11    1   DCL DAYFLG SBIN;
     2545       12    1   DCL UTS UBIN;
     2546       13        /**/
     2547       14        /* INCLUDE FILES */
     2548       15        %INCLUDE CP_6;
     2549       96        %INCLUDE XU_MACRO_C;
     2550     3202        %INCLUDE TH_PERR_C;
     2551     3243        %INCLUDE TH_DATA_R;
     2552     3321        %INCLUDE TH_SUBS_C;
     2553     3703        /**/
     2554     3704        /* VARS */
     2555     3705    1   DCL I UBIN;
     2556     3706    1   DCL 1 TBUF STATIC,
     2557     3707    1         2 HH CHAR(2),
     2558     3708    1         2 * CHAR(1),
     2559     3709    1         2 MM CHAR(2),
     2560     3710    1         2 * CHAR(1),
     2561     3711    1         2 SS CHAR(2),
     2562     3712    1         2 * CHAR(1),
     2563     3713    1         2 SM CHAR(2);
     2564     3714    1   DCL 1 DBUF STATIC,
     2565     3715    1         2 MM CHAR(2),
     2566     3716    1         2 * CHAR(1),
     2567     3717    1         2 DD CHAR(2),
     2568     3718    1         2 * CHAR(1),
     2569     3719    1         2 YY CHAR(2);
     2570     3720    1   DCL TIMECHARS CHAR(4);
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:464  
     2571     3721    1   DCL 1 TIMECHAR REDEF TIMECHARS,
     2572     3722    1         2 HH CHAR(2),
     2573     3723    1         2 MM CHAR(2);
     2574     3724    1   DCL SYM$ PTR;
     2575     3725        /**/
     2576     3726        /* FPT DEFINITIONS */
     2577     3727        %FPT_TIME (FPTN=FPT_GETTIME,
     2578     3728                   DATE=DBUF,
     2579     3729                   TIME=TBUF,
     2580     3730                   SOURCE=CLOCK,
     2581     3731                   DEST=LOCAL);
     2582     3750        %FPT_TIME (FPTN=FPT_GETUTS,
     2583     3751                   DATE=DBUF,
     2584     3752                   TIME=TBUF,
     2585     3753                   SOURCE=LOCAL,
     2586     3754                   DEST=UTS);
     2587     3773        /**/
     2588     3774        /* MACRO INVOCATIONS */
     2589     3775        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2590     3820        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED(SYM$)");
     2591     3858        /**/
     2592     3859        %EJECT;
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:465  
     2593     3860    1           CALL M$TIME(FPT_GETTIME);
     2594     3861    1           IF DAYFLG > 0
     2595     3862    1              THEN                         /* DEFAULT TIME = 23:59               */
     2596     3863    2              DO;
     2597     3864    2                 TBUF.HH = '23';
     2598     3865    2                 TBUF.MM = '59';
     2599     3866    2                 TBUF.SS = '59';
     2600     3867    2                 TBUF.SM = '99';
     2601     3868    2              END;
     2602     3869    1              ELSE                         /* DEFAULT TIME = 00:00               */
     2603     3870    2              DO;
     2604     3871    2                 TBUF.HH = '00';
     2605     3872    2                 TBUF.MM = '00';
     2606     3873    2                 TBUF.SS = '00';
     2607     3874    2                 TBUF.SM = '00';
     2608     3875    2              END;
     2609     3876    2           DO I = 0 TO OUT$BLK.NSUBLKS - 1;
     2610     3877    3              DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);
     2611     3878    3                 CASE(%DATE$);
     2612     3879    3                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0),DBUF.MM)
              3879                             ALTRET(BAD_TIME);
     2613     3880    3                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1),DBUF.DD)
              3880                             ALTRET(BAD_TIME);
     2614     3881    3                    IF OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS = 3 THEN
     2615     3882    3                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(2),DBUF.YY)
              3882                             ALTRET(BAD_TIME);
     2616     3883    3                 CASE(%TIME$);
     2617     3884    3             IF OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS = 1
     2618     3885    3               THEN
     2619     3886    4                 DO;
     2620     3887    4                    SYM$=OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);
     2621     3888    4                   IF OUT$SYM.COUNT ~= 4
     2622     3889    4                      THEN
     2623     3890    4                         ALTRETURN;
     2624     3891    4                    TIMECHARS = OUT$SYM.TEXT;
     2625     3892    4                    TBUF.HH = TIMECHAR.HH;
     2626     3893    4                    TBUF.MM = TIMECHAR.MM;
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:466  
     2627     3894    4                 END;
     2628     3895    3                ELSE
     2629     3896    4                  DO;
     2630     3897    4                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0),TBUF.HH)
              3897                             ALTRET(BAD_TIME);
     2631     3898    4                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1),TBUF.MM)
              3898                             ALTRET(BAD_TIME);
     2632     3899    4                  END;
     2633     3900    3              END;                         /* CASE CODE                          */
     2634     3901    2           END;                            /* DO I                               */
     2635     3902    1           FPT_GETUTS.TSTAMP_ = VECTOR(UTS);
     2636     3903    1           CALL M$TIME(FPT_GETUTS) ALTRET(BAD_TIME);
     2637     3904    1           RETURN;
     2638     3905    1   BAD_TIME:
     2639     3906    1           ALTRETURN;
     2640     3907        %EJECT;
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:467  
     2641     3908    1   FILL_FIELD: PROC(SYM$,FIELD) ALTRET;
     2642     3909        /**/
     2643     3910        /* PARAMS */
     2644     3911    2   DCL SYM$ PTR;
     2645     3912    2   DCL FIELD CHAR(2);
     2646     3913    2   DCL RFIELD(0:1) REDEF FIELD CHAR(1);
     2647     3914        /**/
     2648     3915        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED(SYM$)");
     2649     3953        /**/
     2650     3954    2        IF OUT$SYM.COUNT = 2
     2651     3955    2           THEN FIELD = OUT$SYM.TEXT;
     2652     3956    2           ELSE
     2653     3957    2        IF OUT$SYM.COUNT = 1
     2654     3958    2           THEN
     2655     3959    3           DO;
     2656     3960    3              RFIELD(0) = '0';
     2657     3961    3              RFIELD(1) = OUT$SYM.TEXT;
     2658     3962    3           END;
     2659     3963    2           ELSE                            /* ERROR                              */
     2660     3964    3           DO;
     2661     3965    3              ALTRETURN;
     2662     3966    3           END;                            /* IF                                 */
     2663     3967    2        RETURN;
     2664     3968    2   END FILL_FIELD;
     2665     3969    1   END THC$CVTUTS;
     2666     3970        %EOD;

PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:468  
--  Include file information  --

   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$CVTUTS.

   Procedure THC$CVTUTS requires 161 words for executable code.
   Procedure THC$CVTUTS requires 14 words of local(AUTO) storage.

PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:469  

 Object Unit name= THC$CVTUTS                                 File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:13:26.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    30     36  THC$CVTUTS
    2  RoData even  UTS      4      4  THC$CVTUTS
    3   Proc  even  none   161    241  THC$CVTUTS
    4  RoData even  none     6      6  THC$CVTUTS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        3  THC$CVTUTS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_XSA_BUF_VECTOR
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:470  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:471  


     2534        1        /*M* THC$CVTUTS - CONVERTS TEXT INPUT TO TIME CONSTRAINT FOR ELAN */
     2535        2        /*T***********************************************************/
     2536        3        /*T*                                                         */
     2537        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2538        5        /*T*                                                         */
     2539        6        /*T***********************************************************/
     2540        7        THC$CVTUTS: PROC(TOP$,DAYFLG,UTS) ALTRET;

      7  3 000000   000000 700200 xent  THC$CVTUTS   TSX0  ! X66_AUTO_3
         3 000001   000016 000003                    ZERO    14,3

     2541        8        /**/
     2542        9        /* PARAMS */
     2543       10    1   DCL TOP$ PTR;
     2544       11    1   DCL DAYFLG SBIN;
     2545       12    1   DCL UTS UBIN;
     2546       13        /**/
     2547       14        /* INCLUDE FILES */
     2548       15        %INCLUDE CP_6;
     2549       96        %INCLUDE XU_MACRO_C;
     2550     3202        %INCLUDE TH_PERR_C;
     2551     3243        %INCLUDE TH_DATA_R;
     2552     3321        %INCLUDE TH_SUBS_C;
     2553     3703        /**/
     2554     3704        /* VARS */
     2555     3705    1   DCL I UBIN;
     2556     3706    1   DCL 1 TBUF STATIC,
     2557     3707    1         2 HH CHAR(2),
     2558     3708    1         2 * CHAR(1),
     2559     3709    1         2 MM CHAR(2),
     2560     3710    1         2 * CHAR(1),
     2561     3711    1         2 SS CHAR(2),
     2562     3712    1         2 * CHAR(1),
     2563     3713    1         2 SM CHAR(2);
     2564     3714    1   DCL 1 DBUF STATIC,
     2565     3715    1         2 MM CHAR(2),
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:472  
     2566     3716    1         2 * CHAR(1),
     2567     3717    1         2 DD CHAR(2),
     2568     3718    1         2 * CHAR(1),
     2569     3719    1         2 YY CHAR(2);
     2570     3720    1   DCL TIMECHARS CHAR(4);
     2571     3721    1   DCL 1 TIMECHAR REDEF TIMECHARS,
     2572     3722    1         2 HH CHAR(2),
     2573     3723    1         2 MM CHAR(2);
     2574     3724    1   DCL SYM$ PTR;
     2575     3725        /**/
     2576     3726        /* FPT DEFINITIONS */
     2577     3727        %FPT_TIME (FPTN=FPT_GETTIME,
     2578     3728                   DATE=DBUF,
     2579     3729                   TIME=TBUF,
     2580     3730                   SOURCE=CLOCK,
     2581     3731                   DEST=LOCAL);
     2582     3750        %FPT_TIME (FPTN=FPT_GETUTS,
     2583     3751                   DATE=DBUF,
     2584     3752                   TIME=TBUF,
     2585     3753                   SOURCE=LOCAL,
     2586     3754                   DEST=UTS);
     2587     3773        /**/
     2588     3774        /* MACRO INVOCATIONS */
     2589     3775        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2590     3820        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED(SYM$)");
     2591     3858        /**/
     2592     3859        %EJECT;
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:473  
     2593     3860    1           CALL M$TIME(FPT_GETTIME);

   3860  3 000002   000006 630400 1                  EPPR0   FPT_GETTIME
         3 000003   020004 713400                    CLIMB   8196
         3 000004   402000 401760                    pmme    nvectors=5

     2594     3861    1           IF DAYFLG > 0

   3861  3 000005   200004 470500                    LDP0    @DAYFLG,,AUTO
         3 000006   000000 235100                    LDA     0,,PR0
         3 000007   000023 604400 3                  TMOZ    s:3871

     2595     3862    1              THEN                         /* DEFAULT TIME = 23:59               */
     2596     3863    2              DO;

     2597     3864    2                 TBUF.HH = '23';

   3864  3 000010   000000 220000 2                  LDX0    0
         3 000011   000000 740000 1                  STX0    TBUF

     2598     3865    2                 TBUF.MM = '59';

   3865  3 000012   040000 100400                    MLR     fill='040'O
         3 000013   000001 000002 2                  ADSC9   1                        cn=0,n=2
         3 000014   000000 600002 1                  ADSC9   TBUF                     cn=3,n=2

     2599     3866    2                 TBUF.SS = '59';

   3866  3 000015   000001 221000 2                  LDX1    1
         3 000016   000001 441000 1                  SXL1    TBUF+1

     2600     3867    2                 TBUF.SM = '99';

   3867  3 000017   000002 236000 2                  LDQ     2
         3 000020   000011 772000                    QRL     9
         3 000021   000002 552030 1                  STBQ    TBUF+2,'30'O

PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:474  
     2601     3868    2              END;

   3868  3 000022   000034 710000 3                  TRA     s:3876

     2602     3869    1              ELSE                         /* DEFAULT TIME = 00:00               */
     2603     3870    2              DO;

     2604     3871    2                 TBUF.HH = '00';

   3871  3 000023   000003 220000 2                  LDX0    3
         3 000024   000000 740000 1                  STX0    TBUF

     2605     3872    2                 TBUF.MM = '00';

   3872  3 000025   040000 100400                    MLR     fill='040'O
         3 000026   000003 000002 2                  ADSC9   3                        cn=0,n=2
         3 000027   000000 600002 1                  ADSC9   TBUF                     cn=3,n=2

     2606     3873    2                 TBUF.SS = '00';

   3873  3 000030   000001 440000 1                  SXL0    TBUF+1

     2607     3874    2                 TBUF.SM = '00';

   3874  3 000031   000003 236000 2                  LDQ     3
         3 000032   000011 772000                    QRL     9
         3 000033   000002 552030 1                  STBQ    TBUF+2,'30'O

     2608     3875    2              END;

     2609     3876    2           DO I = 0 TO OUT$BLK.NSUBLKS - 1;

   3876  3 000034   200006 450100                    STZ     I,,AUTO
         3 000035   000161 710000 3                  TRA     s:3901+3

     2610     3877    3              DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);

PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:475  
   3877  3 000036   200003 470500                    LDP0    @TOP$,,AUTO
         3 000037   000000 471500                    LDP1    0,,PR0
         3 000040   200006 720100                    LXL0    I,,AUTO
         3 000041   100003 473510                    LDP3    3,X0,PR1
         3 000042   300000 721100                    LXL1    0,,PR3
         3 000043   000003 101003                    CMPX1   3,DU
         3 000044   000046 602011 3                  TNC     s:3877+8,X1
         3 000045   000156 710000 3                  TRA     s:3901
         3 000046   000156 710000 3                  TRA     s:3901
         3 000047   000051 710000 3                  TRA     s:3879
         3 000050   000107 710000 3                  TRA     s:3884

     2611     3878    3                 CASE(%DATE$);

     2612     3879    3                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0),DBUF.MM)
              3879                             ALTRET(BAD_TIME);

   3879  3 000051   000000 236000 4                  LDQ     0
         3 000052   200014 756100                    STQ     @SYM$+1,,AUTO
         3 000053   300003 631500                    EPPR1   3,,PR3
         3 000054   200013 451500                    STP1    SYM$+3,,AUTO
         3 000055   000201 701000 3                  TSX1    FILL_FIELD
         3 000056   000200 702000 3                  TSX2    BAD_TIME

     2613     3880    3                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1),DBUF.DD)
              3880                             ALTRET(BAD_TIME);

   3880  3 000057   200003 470500                    LDP0    @TOP$,,AUTO
         3 000060   000000 471500                    LDP1    0,,PR0
         3 000061   200006 720100                    LXL0    I,,AUTO
         3 000062   100003 473510                    LDP3    3,X0,PR1
         3 000063   000001 236000 4                  LDQ     1
         3 000064   200014 756100                    STQ     @SYM$+1,,AUTO
         3 000065   300004 631500                    EPPR1   4,,PR3
         3 000066   200013 451500                    STP1    SYM$+3,,AUTO
         3 000067   000201 701000 3                  TSX1    FILL_FIELD
         3 000070   000200 702000 3                  TSX2    BAD_TIME
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:476  

     2614     3881    3                    IF OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS = 3 THEN

   3881  3 000071   200003 470500                    LDP0    @TOP$,,AUTO
         3 000072   000000 471500                    LDP1    0,,PR0
         3 000073   200006 720100                    LXL0    I,,AUTO
         3 000074   100003 473510                    LDP3    3,X0,PR1
         3 000075   300001 221100                    LDX1    1,,PR3
         3 000076   000003 101003                    CMPX1   3,DU
         3 000077   000156 601000 3                  TNZ     s:3901

     2615     3882    3                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(2),DBUF.YY)
              3882                             ALTRET(BAD_TIME);

   3882  3 000100   000002 236000 4                  LDQ     2
         3 000101   200014 756100                    STQ     @SYM$+1,,AUTO
         3 000102   300005 631500                    EPPR1   5,,PR3
         3 000103   200013 451500                    STP1    SYM$+3,,AUTO
         3 000104   000201 701000 3                  TSX1    FILL_FIELD
         3 000105   000200 702000 3                  TSX2    BAD_TIME
         3 000106   000156 710000 3                  TRA     s:3901

     2616     3883    3                 CASE(%TIME$);

     2617     3884    3             IF OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS = 1

   3884  3 000107   300001 222100                    LDX2    1,,PR3
         3 000110   000001 102003                    CMPX2   1,DU
         3 000111   000136 601000 3                  TNZ     s:3897

     2618     3885    3               THEN
     2619     3886    4                 DO;

     2620     3887    4                    SYM$=OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);

   3887  3 000112   300003 236100                    LDQ     3,,PR3
         3 000113   200010 756100                    STQ     SYM$,,AUTO
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:477  

     2621     3888    4                   IF OUT$SYM.COUNT ~= 4

   3888  3 000114   200010 474500                    LDP4    SYM$,,AUTO
         3 000115   400004 236100                    LDQ     4,,PR4
         3 000116   777000 376003                    ANQ     -512,DU
         3 000117   004000 116003                    CMPQ    2048,DU
         3 000120   000122 600000 3                  TZE     s:3891

     2622     3889    4                      THEN
     2623     3890    4                         ALTRETURN;

   3890  3 000121   000000 702200 xent               TSX2  ! X66_AALT

     2624     3891    4                    TIMECHARS = OUT$SYM.TEXT;

   3891  3 000122   400004 236100                    LDQ     4,,PR4
         3 000123   000033 772000                    QRL     27
         3 000124   000000 623006                    EAX3    0,QL
         3 000125   040100 100540                    MLR     fill='040'O
         3 000126   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         3 000127   200007 000004                    ADSC9   TIMECHARS,,AUTO          cn=0,n=4

     2625     3892    4                    TBUF.HH = TIMECHAR.HH;

   3892  3 000130   200007 224100                    LDX4    TIMECHARS,,AUTO
         3 000131   000000 744000 1                  STX4    TBUF

     2626     3893    4                    TBUF.MM = TIMECHAR.MM;

   3893  3 000132   040000 100500                    MLR     fill='040'O
         3 000133   200007 400002                    ADSC9   TIMECHARS,,AUTO          cn=2,n=2
         3 000134   000000 600002 1                  ADSC9   TBUF                     cn=3,n=2

     2627     3894    4                 END;

   3894  3 000135   000156 710000 3                  TRA     s:3901
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:478  

     2628     3895    3                ELSE
     2629     3896    4                  DO;

     2630     3897    4                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0),TBUF.HH)
              3897                             ALTRET(BAD_TIME);

   3897  3 000136   000003 236000 4                  LDQ     3
         3 000137   200014 756100                    STQ     @SYM$+1,,AUTO
         3 000140   300003 631500                    EPPR1   3,,PR3
         3 000141   200013 451500                    STP1    SYM$+3,,AUTO
         3 000142   000201 701000 3                  TSX1    FILL_FIELD
         3 000143   000200 702000 3                  TSX2    BAD_TIME

     2631     3898    4                    CALL FILL_FIELD(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1),TBUF.MM)
              3898                             ALTRET(BAD_TIME);

   3898  3 000144   200003 470500                    LDP0    @TOP$,,AUTO
         3 000145   000000 471500                    LDP1    0,,PR0
         3 000146   200006 720100                    LXL0    I,,AUTO
         3 000147   100003 473510                    LDP3    3,X0,PR1
         3 000150   000004 236000 4                  LDQ     4
         3 000151   200014 756100                    STQ     @SYM$+1,,AUTO
         3 000152   300004 631500                    EPPR1   4,,PR3
         3 000153   200013 451500                    STP1    SYM$+3,,AUTO
         3 000154   000201 701000 3                  TSX1    FILL_FIELD
         3 000155   000200 702000 3                  TSX2    BAD_TIME

     2632     3899    4                  END;

     2633     3900    3              END;                         /* CASE CODE                          */

     2634     3901    2           END;                            /* DO I                               */

   3901  3 000156   200006 235100                    LDA     I,,AUTO
         3 000157   000001 035007                    ADLA    1,DL
         3 000160   200006 755100                    STA     I,,AUTO
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:479  
         3 000161   200003 470500                    LDP0    @TOP$,,AUTO
         3 000162   000000 471500                    LDP1    0,,PR0
         3 000163   100001 236100                    LDQ     1,,PR1
         3 000164   000022 772000                    QRL     18
         3 000165   200006 116100                    CMPQ    I,,AUTO
         3 000166   000170 600000 3                  TZE     s:3902
         3 000167   000036 603000 3                  TRC     s:3877

     2635     3902    1           FPT_GETUTS.TSTAMP_ = VECTOR(UTS);

   3902  3 000170   777640 235007                    LDA     -96,DL
         3 000171   200005 236100                    LDQ     @UTS,,AUTO
         3 000172   000032 757000 1                  STAQ    FPT_GETUTS+8

     2636     3903    1           CALL M$TIME(FPT_GETUTS) ALTRET(BAD_TIME);

   3903  3 000173   000022 630400 1                  EPPR0   FPT_GETUTS
         3 000174   420004 713400                    CLIMB   alt,+8196
         3 000175   402000 401760                    pmme    nvectors=5
         3 000176   000200 702000 3                  TSX2    BAD_TIME

     2637     3904    1           RETURN;

   3904  3 000177   000000 702200 xent               TSX2  ! X66_ARET

     2638     3905    1   BAD_TIME:
     2639     3906    1           ALTRETURN;

   3906  3 000200   000000 702200 xent  BAD_TIME     TSX2  ! X66_AALT

     2640     3907        %EJECT;
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:480  
     2641     3908    1   FILL_FIELD: PROC(SYM$,FIELD) ALTRET;

   3908  3 000201   200012 741300       FILL_FIELD   STX1  ! SYM$+2,,AUTO

     2642     3909        /**/
     2643     3910        /* PARAMS */
     2644     3911    2   DCL SYM$ PTR;
     2645     3912    2   DCL FIELD CHAR(2);
     2646     3913    2   DCL RFIELD(0:1) REDEF FIELD CHAR(1);
     2647     3914        /**/
     2648     3915        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED(SYM$)");
     2649     3953        /**/
     2650     3954    2        IF OUT$SYM.COUNT = 2

   3954  3 000202   200013 470500                    LDP0    @SYM$,,AUTO
         3 000203   000000 471500                    LDP1    0,,PR0
         3 000204   100004 236100                    LDQ     4,,PR1
         3 000205   777000 376003                    ANQ     -512,DU
         3 000206   002000 116003                    CMPQ    1024,DU
         3 000207   000220 601000 3                  TNZ     s:3957

     2651     3955    2           THEN FIELD = OUT$SYM.TEXT;

   3955  3 000210   100004 236100                    LDQ     4,,PR1
         3 000211   000033 772000                    QRL     27
         3 000212   000000 620006                    EAX0    0,QL
         3 000213   200014 473500                    LDP3    @FIELD,,AUTO
         3 000214   040100 100540                    MLR     fill='040'O
         3 000215   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         3 000216   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         3 000217   000237 710000 3                  TRA     s:3967

     2652     3956    2           ELSE
     2653     3957    2        IF OUT$SYM.COUNT = 1

   3957  3 000220   001000 116003                    CMPQ    512,DU
         3 000221   000236 601000 3                  TNZ     s:3965
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:481  

     2654     3958    2           THEN
     2655     3959    3           DO;

     2656     3960    3              RFIELD(0) = '0';

   3960  3 000222   200014 473500                    LDP3    @FIELD,,AUTO
         3 000223   040100 100400                    MLR     fill='040'O
         3 000224   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 000225   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

     2657     3961    3              RFIELD(1) = OUT$SYM.TEXT;

   3961  3 000226   000000 471500                    LDP1    0,,PR0
         3 000227   100004 236100                    LDQ     4,,PR1
         3 000230   000033 772000                    QRL     27
         3 000231   000000 620006                    EAX0    0,QL
         3 000232   040100 100540                    MLR     fill='040'O
         3 000233   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         3 000234   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1

     2658     3962    3           END;

   3962  3 000235   000237 710000 3                  TRA     s:3967

     2659     3963    2           ELSE                            /* ERROR                              */
     2660     3964    3           DO;

     2661     3965    3              ALTRETURN;

   3965  3 000236   000000 702211                    TSX2  ! 0,X1

     2662     3966    3           END;                            /* IF                                 */
     2663     3967    2        RETURN;

   3967  3 000237   200012 221300                    LDX1  ! SYM$+2,,AUTO
         3 000240   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:482  
     2664     3968    2   END FILL_FIELD;
     2665     3969    1   END THC$CVTUTS;
     2666     3970        %EOD;

PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:483  
--  Include file information  --

   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$CVTUTS.
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:484  

 **** Variables and constants ****

  ****  Section 001  Data  THC$CVTUTS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/c STRC(72)    r     1 DBUF                       6-0-0/d STRC(432)   r     1 FPT_GETTIME
    22-0-0/d STRC(432)   r     1 FPT_GETUTS                 0-0-0/c STRC(99)    r     1 TBUF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DAYFLG                   14-0-0/w PTR         r     1 @FIELD
    13-0-0/w PTR         r     1 @SYM$                      3-0-0/w PTR         r     1 @TOP$
     5-0-0/w PTR         r     1 @UTS                      *0-0-0/w SBIN        r     1 DAYFLG
    *0-0-0/c CHAR(2)     r     1 FIELD                      6-0-0/w UBIN        r     1 I
    *0-0-0/c CHAR        r     1 RFIELD(0:1)               10-0-0/w PTR         r     1 SYM$
    *0-0-0/w PTR         r     1 SYM$                       7-0-0/c STRC        r     1 TIMECHAR
     7-0-0/c CHAR(4)     r     1 TIMECHARS                 *0-0-0/w PTR         r     1 TOP$
    *0-0-0/w UBIN        r     1 UTS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure THC$CVTUTS requires 161 words for executable code.
   Procedure THC$CVTUTS requires 14 words of local(AUTO) storage.
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:485  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:486  
          MINI XREF LISTING

BAD_TIME
      3906**LABEL    3879--CALLALT  3880--CALLALT  3882--CALLALT  3897--CALLALT  3898--CALLALT  3903--CALLALT
DAYFLG
        11**DCL         7--PROC     3861>>IF
DBUF
      3714**DCL      3742--DCLINIT  3743--DCLINIT  3765--DCLINIT  3766--DCLINIT
DBUF.DD
      3717**DCL      3880<>CALL
DBUF.MM
      3715**DCL      3879<>CALL
DBUF.YY
      3719**DCL      3882<>CALL
FIELD IN PROCEDURE FILL_FIELD
      3912**DCL      3908--PROC     3913--REDEF    3955<<ASSIGN
FILL_FIELD
      3908**PROC     3879--CALL     3880--CALL     3882--CALL     3897--CALL     3898--CALL
FPT_GETTIME
      3742**DCL      3860<>CALL
FPT_GETTIME.V
      3746**DCL      3742--DCLINIT
FPT_GETUTS
      3765**DCL      3903<>CALL
FPT_GETUTS.TSTAMP_
      3768**DCL      3902<<ASSIGN
FPT_GETUTS.V
      3769**DCL      3765--DCLINIT
I
      3705**DCL      3876<<DOINDEX  3877>>DOCASE   3879>>CALL     3880>>CALL     3881>>IF       3882>>CALL
      3884>>IF       3887>>ASSIGN   3897>>CALL     3898>>CALL
M$TIME
        91**DCL-ENT  3860--CALL     3903--CALL
OUT$BLK.CODE
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:487  
      3789**DCL      3877>>DOCASE
OUT$BLK.NSUBLKS
      3793**DCL      3876>>DOINDEX  3881>>IF       3884>>IF
OUT$BLK.SUBLK$
      3814**DCL      3877>>DOCASE   3879>>CALL     3879<>CALL     3880>>CALL     3880<>CALL     3881>>IF
      3882>>CALL     3882<>CALL     3884>>IF       3887>>ASSIGN   3887>>ASSIGN   3897>>CALL     3897<>CALL
      3898>>CALL     3898<>CALL
OUT$SYM.COUNT
      3850**DCL      3853--IMP-SIZ  3888>>IF       3891>>ASSIGN
OUT$SYM.TEXT
      3853**DCL      3891>>ASSIGN
OUT$SYM.COUNT IN PROCEDURE FILL_FIELD
      3945**DCL      3948--IMP-SIZ  3954>>IF       3955>>ASSIGN   3957>>IF       3961>>ASSIGN
OUT$SYM.TEXT IN PROCEDURE FILL_FIELD
      3948**DCL      3955>>ASSIGN   3961>>ASSIGN
RFIELD IN PROCEDURE FILL_FIELD
      3913**DCL      3960<<ASSIGN   3961<<ASSIGN
SYM$
      3724**DCL      3827--IMP-PTR  3887<<ASSIGN   3888>>IF       3891>>ASSIGN   3891>>ASSIGN
SYM$ IN PROCEDURE FILL_FIELD
      3911**DCL      3908--PROC     3922--IMP-PTR  3954>>IF       3955>>ASSIGN   3955>>ASSIGN   3957>>IF
      3961>>ASSIGN   3961>>ASSIGN
TBUF
      3706**DCL      3744--DCLINIT  3745--DCLINIT  3767--DCLINIT  3768--DCLINIT
TBUF.HH
      3707**DCL      3864<<ASSIGN   3871<<ASSIGN   3892<<ASSIGN   3897<>CALL
TBUF.MM
      3709**DCL      3865<<ASSIGN   3872<<ASSIGN   3893<<ASSIGN   3898<>CALL
TBUF.SM
      3713**DCL      3867<<ASSIGN   3874<<ASSIGN
TBUF.SS
      3711**DCL      3866<<ASSIGN   3873<<ASSIGN
TH_CONSTRAINTS.E_BY_B
      3254**DCL      3254--REDEF
TH_CONSTRAINTS.M_BY_B
      3253**DCL      3253--REDEF
PL6.E3A0      #009=THC$CVTUTS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:488  
TH_CONSTRAINTS.TYPES
      3251**DCL      3251--REDEF
TH_DEFAULT.E_BY_B
      3262**DCL      3262--REDEF
TH_DEFAULT.M_BY_B
      3261**DCL      3261--REDEF
TH_DEFAULT.TYPES
      3259**DCL      3259--REDEF
TH_SAVE.E_BY_B
      3270**DCL      3270--REDEF
TH_SAVE.M_BY_B
      3268**DCL      3268--REDEF
TH_SAVE.TYPES
      3266**DCL      3267--REDEF
TH_XSA_BUF_VECTOR
      3286**DCL      3286--REDEF
TIMECHAR.HH
      3722**DCL      3892>>ASSIGN
TIMECHAR.MM
      3723**DCL      3893>>ASSIGN
TIMECHARS
      3720**DCL      3721--REDEF    3891<<ASSIGN
TOP$
        10**DCL         7--PROC     3781--IMP-PTR  3876>>DOINDEX  3877>>DOCASE   3879>>CALL     3880>>CALL
      3881>>IF       3882>>CALL     3884>>IF       3887>>ASSIGN   3897>>CALL     3898>>CALL
UTS
        12**DCL         7--PROC     3902--ASSIGN

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:489  
     2667        1        /*M* PROCEDURE TO HANDLE THRESH COMMANDS FOR ELAN */
     2668        2        /*T***********************************************************/
     2669        3        /*T*                                                         */
     2670        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2671        5        /*T*                                                         */
     2672        6        /*T***********************************************************/
     2673        7        THC$THRESH: PROC(TOP$);
     2674        8        /**/
     2675        9        /* PARAMS */
     2676       10    1   DCL TOP$ PTR;
     2677       11        /**/
     2678       12        /* INCLUDE FILES */
     2679       13        %INCLUDE CP_6;
     2680       94        %INCLUDE B$JIT;
     2681      384        %INCLUDE F$DCB;
     2682      433        %INCLUDE XU_MACRO_C;
     2683     3539        %INCLUDE TH$HIST;
     2684     3634        %INCLUDE TH_DATA_R;
     2685     3712        %INCLUDE TH_SUBS_C;
     2686     4094        %INCLUDE TH_PERR_C;
     2687     4135        /**/
     2688     4136    1   DCL B$JIT$ PTR SYMREF;
     2689     4137        /* ENTRY DEFS */
     2690     4138    1   DCL THG$GETREC ENTRY(4) ALTRET;
     2691     4139    1   DCL THS$SET_DEVS ENTRY(3) ALTRET;
     2692     4140    1   DCL THM$ERRMSG ENTRY(1);
     2693     4141    1   DCL THW$WRITE ENTRY(11);
     2694     4142        /**/
     2695     4143        /* DCBS */
     2696     4144    1   DCL M$DEVHIST DCB;
     2697     4145        /**/
     2698     4146        /* VARS */
     2699     4147    1   DCL M$DEVHIST$ PTR;
     2700     4148    1   DCL ONE CHAR(8) STATIC INIT('1       '); /* USED FOR GETREC CALLS             */
     2701     4149    1   DCL THRESH_KEY BIT(18) STATIC INIT('001001'O);
     2702     4150    1   DCL SYM$ PTR;
     2703     4151    1   DCL I UBIN;
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:490  
     2704     4152    1   DCL J UBIN;
     2705     4153    1   DCL ATTEN_FLG BIT(1) STATIC INIT('0'B);
     2706     4154    1   DCL ALERT_FLG BIT(1) STATIC INIT('0'B);
     2707     4155    1   DCL CODE UBIN;
     2708     4156    1   DCL TEXT CHAR(8);
     2709     4157    1   DCL LEN UBIN WORD;
     2710     4158    1   DCL ATTEN UBIN;
     2711     4159    1   DCL ALERT UBIN;
     2712     4160    1   DCL TEMP SBIN WORD;
     2713     4161    1   DCL TH$THRESH$ PTR;
     2714     4162    1   DCL DISPTHRESH CHAR(0) CONSTANT INIT(
     2715     4163    1   'Thresh for %4A: Atten = %2P%5A, Alert = %3P%5A%10P');
     2716     4164    1   DCL ATTEN_BUF CHAR(5);
     2717     4165    1   DCL ALERT_BUF CHAR(5);
     2718     4166    1   DCL BUF1 CHAR(2);
     2719     4167    1   DCL BUF2 CHAR(2);
     2720     4168        /**/
     2721     4169        /* MACRO INVOCATIONS */
     2722     4170        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2723     4215        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED(SYM$)");
     2724     4253        %TH$THRESH (NAME=TH$THRESH,NUMDEV#=511);
     2725     4259        %TH$THRESH (NAME=TH_THRESH,STCLASS=AUTO,NUMDEV#=511);
     2726     4265        /**/
     2727     4266        /* FPT DEFINITIONS */
     2728     4267        %FPT_OPEN (FPTN=OPEN_DEVHIST,
     2729     4268                   STCLASS=CONSTANT,
     2730     4269                   DCB=M$DEVHIST,
     2731     4270                   NAME=DEVHIST,
     2732     4271                   ACCT=DEVHIST_ACCT,
     2733     4272                   ASN=FILE,
     2734     4273                   ACS=DIRECT,
     2735     4274                   ORG=KEYED,
     2736     4275                   FUN=UPDATE);
     2737     4384        %FPT_WRITE (FPTN=WRITE_DEVHIST,
     2738     4385                    DCB=M$DEVHIST,
     2739     4386                    KEY=THRESH_KEY);
     2740     4417        %FPT_CLOSE (FPTN=CLOSE_DEVHIST,
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:491  
     2741     4418                    STCLASS=CONSTANT,
     2742     4419                    DCB=M$DEVHIST,
     2743     4420                    DISP=SAVE);
     2744     4462        %VLP_NAME (FPTN=DEVHIST,
     2745     4463                   STCLASS=CONSTANT,
     2746     4464                   NAME=':DEVHIST');
     2747     4491        %VLP_ACCT (FPTN=SYSTAC,
     2748     4492                   STCLASS=CONSTANT,
     2749     4493                   ACCT=':SYSTAC');
     2750     4506        /**/
     2751     4507        %EJECT;
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:492  
     2752     4508    1        ATTEN_FLG = %FALSE;
     2753     4509    1        ALERT_FLG = %FALSE;
     2754     4510    1        CODE = %ALL;
     2755     4511    1        TH_NUM_REP_DEVS = 0;
     2756     4512    2        DO I = 0 TO OUT$BLK.NSUBLKS - 1;
     2757     4513    3           DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);
     2758     4514    3              CASE(%FOR_CLAUSE);
     2759     4515    4                 DO J = 0 TO OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS - 1;
     2760     4516    4                    TEXT = '00000000';
     2761     4517    4                    CODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0)->
              4517                             OUT$BLK.CODE;
     2762     4518    4                    LEN = 2;
     2763     4519    5                    DO CASE(CODE);
     2764     4520    5                       CASE(%MTU);
     2765     4521    5                          TEXT = 'MTU';
     2766     4522    5                          LEN = 3;
     2767     4523    5                       CASE(%MSU);
     2768     4524    5                          TEXT = 'MSU';
     2769     4525    5                          LEN = 3;
     2770     4526    5                       CASE(%CRU);
     2771     4527    5                          TEXT = 'CRU';
     2772     4528    5                          LEN = 3;
     2773     4529    5                       CASE(%PCU);
     2774     4530    5                          TEXT = 'PCU';
     2775     4531    5                          LEN = 3;
     2776     4532    5                       CASE(%PRU);
     2777     4533    5                          TEXT = 'PRU';
     2778     4534    5                          LEN = 3;
     2779     4535    5                       CASE(%MPC1);
     2780     4536    5                          TEXT = 'MPC';
     2781     4537    5                          LEN = 3;
     2782     4538    5                       CASE(%CONSOLE);
     2783     4539    5                          TEXT = 'CONSOLE';
     2784     4540    5                          LEN = 7;
     2785     4541    5                       CASE(%MEM);
     2786     4542    5                          TEXT = 'MEM';
     2787     4543    5                          LEN = 3;
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:493  
     2788     4544    5                       CASE(%MC);
     2789     4545    5                          TEXT = 'MC';
     2790     4546    5                       CASE(%MT);
     2791     4547    5                          TEXT = 'MT';
     2792     4548    5                       CASE(%SC);
     2793     4549    5                          TEXT = 'SC';
     2794     4550    5                       CASE(%DP);
     2795     4551    5                          TEXT = 'DP';
     2796     4552    5                       CASE(%CR);
     2797     4553    5                          TEXT = 'CR';
     2798     4554    5                       CASE(%CP);
     2799     4555    5                          TEXT = 'CP';
     2800     4556    5                       CASE(%LP);
     2801     4557    5                          TEXT = 'LP';
     2802     4558    5                       CASE(%UC);
     2803     4559    5                          TEXT = 'UC';
     2804     4560    5                       CASE(%DC);
     2805     4561    5                          TEXT = 'DC';
     2806     4562    5                       CASE(%TC);
     2807     4563    5                          TEXT = 'TC';
     2808     4564    5                       CASE(%FEP);
     2809     4565    5                          TEXT = 'FEP';
     2810     4566    5                          LEN = 3;
     2811     4567    5                       CASE(%IOM);
     2812     4568    5                          TEXT = 'IOM';
     2813     4569    5                          LEN = 3;
     2814     4570    5                       CASE(%ALL);
     2815     4571    5                          TEXT = 'ALL';
     2816     4572    5                          LEN = 3;
     2817     4573    5                    END;                      /* DO CASE CODE                       */
     2818     4574    4                    IF OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.NSUBLKS = 2
     2819     4575    4                       THEN
     2820     4576    5                       DO;
     2821     4577    5                          SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(1
              4577                                   );
     2822     4578    5                          CALL INSERT(TEXT,LEN,OUT$SYM.COUNT,OUT$SYM.TEXT);
     2823     4579    5                          LEN = LEN + OUT$SYM.COUNT;
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:494  
     2824     4580    5                       END;
     2825     4581    4                       ELSE
     2826     4582    5                       DO;
     2827     4583    5                          LEN = 0;
     2828     4584    5                       END;
     2829     4585    4                    CALL THS$SET_DEVS(CODE,TEXT,LEN) ALTRET(RET);
     2830     4586    4                    END;  /* DO J */
     2831     4587    3              CASE(%ATTEN);
     2832     4588    3                 ATTEN_FLG = %TRUE;
     2833     4589    3                 ATTEN = 0;
     2834     4590    3                 SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);
     2835     4591    3                 CALL CHARBIN(TEMP,OUT$SYM.TEXT);
     2836     4592    3                 ATTEN = TEMP * 100;
     2837     4593    3                 IF OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS = 2
     2838     4594    3                    THEN                   /* FRACTIONAL PART IS THERE           */
     2839     4595    4                    DO;
     2840     4596    4                       SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1);
     2841     4597    5                       IF OUT$SYM.COUNT = 1 THEN DO;
     2842     4598    5                          OUT$SYM.COUNT = 2;
     2843     4599    5                          CALL INSERT(OUT$SYM.TEXT,1,1,'0');
     2844     4600    5                          END;  /* IF COUNT = 1 */
     2845     4601    4                       CALL CHARBIN(TEMP,OUT$SYM.TEXT);
     2846     4602    4                       ATTEN = ATTEN + TEMP;
     2847     4603    4                    END;                   /* IF NSUBLKS = 2                     */
     2848     4604    3              CASE(%ALERT);
     2849     4605    3                 ALERT_FLG = %TRUE;
     2850     4606    3                 ALERT = 0;
     2851     4607    3                 SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);
     2852     4608    3                 CALL CHARBIN(TEMP,OUT$SYM.TEXT);
     2853     4609    3                 ALERT = TEMP * 100;
     2854     4610    3                 IF OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS = 2
     2855     4611    3                    THEN                   /* FRACTIONAL PART IS THERE           */
     2856     4612    4                    DO;
     2857     4613    4                       SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1);
     2858     4614    5                       IF OUT$SYM.COUNT = 1 THEN DO;
     2859     4615    5                          OUT$SYM.COUNT = 2;
     2860     4616    5                          CALL INSERT(OUT$SYM.TEXT,1,1,'0');
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:495  
     2861     4617    5                          END;  /* IF COUNT = 1 */
     2862     4618    4                       CALL CHARBIN(TEMP,OUT$SYM.TEXT);
     2863     4619    4                       ALERT = ALERT + TEMP;
     2864     4620    4                    END;                   /* IF NSUBLKS = 2                     */
     2865     4621    3           END;                            /* DO CASE(CODE)                      */
     2866     4622    2        END;                               /* DO I                               */
     2867     4623
     2868     4624    1        CALL THG$GETREC(%DEVHIST,ONE);
     2869     4625    1        TH_THRESH = TH_RECORD.PTR$->TH$THRESH;
     2870     4626
     2871     4627    2        DO I = 0 TO TH_NUM_REP_DEVS - 1;
     2872     4628    3           DO J = 0 TO TH_NUM_DEVS - 1;
     2873     4629    3              IF TH_REP_DEVS(I) = TH_THRESH.DEVNAME(J)
     2874     4630    3                 THEN
     2875     4631    4                 DO;
     2876     4632    5                    IF NOT(ATTEN_FLG OR ALERT_FLG) THEN DO;  /* DISPLAY */
     2877     4633    5                       TEMP = TH_THRESH.ATTEN(J)/100;
     2878     4634    5                       CALL BINCHAR(BUF1,TEMP);
     2879     4635    5                       TEMP = MOD(TH_THRESH.ATTEN(J),100);
     2880     4636    5                       CALL BINCHAR(BUF2,TEMP);
     2881     4637    5                       CALL INSERT(ATTEN_BUF,0,5,BUF1,'.',BUF2);
     2882     4638    5                       TEMP = TH_THRESH.ALERT(J)/100;
     2883     4639    5                       CALL BINCHAR(BUF1,TEMP);
     2884     4640    5                       TEMP = MOD(TH_THRESH.ALERT(J),100);
     2885     4641    5                       CALL BINCHAR(BUF2,TEMP);
     2886     4642    5                       CALL INSERT(ALERT_BUF,0,5,BUF1,'.',BUF2);
     2887     4643    5                       CALL THW$WRITE(VECTOR(DISPTHRESH),
     2888     4644    5                                      VECTOR(TH_THRESH.DEVNAME(J)),
     2889     4645    5                                      VECTOR(ATTEN_BUF),
     2890     4646    5                                      VECTOR(ALERT_BUF));
     2891     4647    5                       END;  /* IF DISPLAY */
     2892     4648    5                    ELSE DO;
     2893     4649    5                       IF ATTEN_FLG
     2894     4650    5                          THEN TH_THRESH.ATTEN(J) = ATTEN;
     2895     4651    5                       IF ALERT_FLG
     2896     4652    5                          THEN TH_THRESH.ALERT(J) = ALERT;
     2897     4653    5                       END;  /* ELSE */
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:496  
     2898     4654    4                 END;                      /* IF                                 */
     2899     4655    3           END;                            /* DO J                               */
     2900     4656    2        END;  /* DO I */
     2901     4657    1        IF NOT(ATTEN_FLG OR ALERT_FLG) THEN RETURN;
     2902     4658    1        M$DEVHIST$ = DCBADDR(DCBNUM(M$DEVHIST));
     2903     4659    1        WRITE_DEVHIST.KEY_ = VECTOR(THRESH_KEY);
     2904     4660    1        WRITE_DEVHIST.BUF_ = VECTOR(TH_THRESH);
     2905     4661    1        WRITE_DEVHIST.BUF_.BOUND = M$DEVHIST$->F$DCB.ARS - 1;
     2906     4662
     2907     4663                                                /* WRITE RECORD BACK OUT              */
     2908     4664    1        IF DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.FCD
     2909     4665    1           THEN CALL M$CLOSE(CLOSE_DEVHIST);
     2910     4666    1        CALL M$OPEN(OPEN_DEVHIST) ALTRET(BAG_IT);
     2911     4667    1        CALL M$WRITE(WRITE_DEVHIST) ALTRET(BAG_IT);
     2912     4668    1        CALL M$CLOSE(CLOSE_DEVHIST) ALTRET(BAG_IT);
     2913     4669    1   RET: RETURN;
     2914     4670    1   BAG_IT:
     2915     4671    1        CALL THM$ERRMSG(%E$TH_CANTSETTHRESH);
     2916     4672        /*E* ERROR: THE-E$TH_CANTSETTHRESH-0
     2917     4673             MESSAGE: You are not allowed to change thresholds.
     2918     4674             MESSAGE1: You do not have the priviliges needed to write to *DEVHIST.  */
     2919     4675    1        RETURN;
     2920     4676    1   END THC$THRESH;
     2921     4677        %EOD;

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:497  
--  Include file information  --

   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TH$HIST.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$THRESH.

   Procedure THC$THRESH requires 494 words for executable code.
   Procedure THC$THRESH requires 2092 words of local(AUTO) storage.

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:498  

 Object Unit name= THC$THRESH                                 File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:13:59.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DEVHIST
    2   Data  even  none    18     22  THC$THRESH
    3  RoData even  UTS    129    201  THC$THRESH
    4   Proc  even  none   494    756  THC$THRESH
    5  RoData even  none    13     15  THC$THRESH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  THC$THRESH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 THS$SET_DEVS
         yes           Std      11 THW$WRITE
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       4 THG$GETREC
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:499  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_NUM_REP_DEVS                       TH_REP_DEVS
     TH_NUM_DEVS                           TH_RECORD                             TH_XSA_BUF_VECTOR
     DEVHIST_ACCT                          B$JIT$                                M$DEVHIST
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:500  


     2667        1        /*M* PROCEDURE TO HANDLE THRESH COMMANDS FOR ELAN */
     2668        2        /*T***********************************************************/
     2669        3        /*T*                                                         */
     2670        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2671        5        /*T*                                                         */
     2672        6        /*T***********************************************************/
     2673        7        THC$THRESH: PROC(TOP$);

      7  4 000000   000000 700200 xent  THC$THRESH   TSX0  ! X66_AUTO_1
         4 000001   004054 000001                    ZERO    2092,1

     2674        8        /**/
     2675        9        /* PARAMS */
     2676       10    1   DCL TOP$ PTR;
     2677       11        /**/
     2678       12        /* INCLUDE FILES */
     2679       13        %INCLUDE CP_6;
     2680       94        %INCLUDE B$JIT;
     2681      384        %INCLUDE F$DCB;
     2682      433        %INCLUDE XU_MACRO_C;
     2683     3539        %INCLUDE TH$HIST;
     2684     3634        %INCLUDE TH_DATA_R;
     2685     3712        %INCLUDE TH_SUBS_C;
     2686     4094        %INCLUDE TH_PERR_C;
     2687     4135        /**/
     2688     4136    1   DCL B$JIT$ PTR SYMREF;
     2689     4137        /* ENTRY DEFS */
     2690     4138    1   DCL THG$GETREC ENTRY(4) ALTRET;
     2691     4139    1   DCL THS$SET_DEVS ENTRY(3) ALTRET;
     2692     4140    1   DCL THM$ERRMSG ENTRY(1);
     2693     4141    1   DCL THW$WRITE ENTRY(11);
     2694     4142        /**/
     2695     4143        /* DCBS */
     2696     4144    1   DCL M$DEVHIST DCB;
     2697     4145        /**/
     2698     4146        /* VARS */
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:501  
     2699     4147    1   DCL M$DEVHIST$ PTR;
     2700     4148    1   DCL ONE CHAR(8) STATIC INIT('1       '); /* USED FOR GETREC CALLS             */
     2701     4149    1   DCL THRESH_KEY BIT(18) STATIC INIT('001001'O);
     2702     4150    1   DCL SYM$ PTR;
     2703     4151    1   DCL I UBIN;
     2704     4152    1   DCL J UBIN;
     2705     4153    1   DCL ATTEN_FLG BIT(1) STATIC INIT('0'B);
     2706     4154    1   DCL ALERT_FLG BIT(1) STATIC INIT('0'B);
     2707     4155    1   DCL CODE UBIN;
     2708     4156    1   DCL TEXT CHAR(8);
     2709     4157    1   DCL LEN UBIN WORD;
     2710     4158    1   DCL ATTEN UBIN;
     2711     4159    1   DCL ALERT UBIN;
     2712     4160    1   DCL TEMP SBIN WORD;
     2713     4161    1   DCL TH$THRESH$ PTR;
     2714     4162    1   DCL DISPTHRESH CHAR(0) CONSTANT INIT(
     2715     4163    1   'Thresh for %4A: Atten = %2P%5A, Alert = %3P%5A%10P');
     2716     4164    1   DCL ATTEN_BUF CHAR(5);
     2717     4165    1   DCL ALERT_BUF CHAR(5);
     2718     4166    1   DCL BUF1 CHAR(2);
     2719     4167    1   DCL BUF2 CHAR(2);
     2720     4168        /**/
     2721     4169        /* MACRO INVOCATIONS */
     2722     4170        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2723     4215        %PARSE$SYM (NAME=OUT$SYM,STCLASS="BASED(SYM$)");
     2724     4253        %TH$THRESH (NAME=TH$THRESH,NUMDEV#=511);
     2725     4259        %TH$THRESH (NAME=TH_THRESH,STCLASS=AUTO,NUMDEV#=511);
     2726     4265        /**/
     2727     4266        /* FPT DEFINITIONS */
     2728     4267        %FPT_OPEN (FPTN=OPEN_DEVHIST,
     2729     4268                   STCLASS=CONSTANT,
     2730     4269                   DCB=M$DEVHIST,
     2731     4270                   NAME=DEVHIST,
     2732     4271                   ACCT=DEVHIST_ACCT,
     2733     4272                   ASN=FILE,
     2734     4273                   ACS=DIRECT,
     2735     4274                   ORG=KEYED,
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:502  
     2736     4275                   FUN=UPDATE);
     2737     4384        %FPT_WRITE (FPTN=WRITE_DEVHIST,
     2738     4385                    DCB=M$DEVHIST,
     2739     4386                    KEY=THRESH_KEY);
     2740     4417        %FPT_CLOSE (FPTN=CLOSE_DEVHIST,
     2741     4418                    STCLASS=CONSTANT,
     2742     4419                    DCB=M$DEVHIST,
     2743     4420                    DISP=SAVE);
     2744     4462        %VLP_NAME (FPTN=DEVHIST,
     2745     4463                   STCLASS=CONSTANT,
     2746     4464                   NAME=':DEVHIST');
     2747     4491        %VLP_ACCT (FPTN=SYSTAC,
     2748     4492                   STCLASS=CONSTANT,
     2749     4493                   ACCT=':SYSTAC');
     2750     4506        /**/
     2751     4507        %EJECT;
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:503  
     2752     4508    1        ATTEN_FLG = %FALSE;

   4508  4 000002   000003 450000 2                  STZ     ATTEN_FLG

     2753     4509    1        ALERT_FLG = %FALSE;

   4509  4 000003   000004 450000 2                  STZ     ALERT_FLG

     2754     4510    1        CODE = %ALL;

   4510  4 000004   000016 235007                    LDA     14,DL
         4 000005   200010 755100                    STA     CODE,,AUTO

     2755     4511    1        TH_NUM_REP_DEVS = 0;

   4511  4 000006   000000 450000 xsym               STZ     TH_NUM_REP_DEVS

     2756     4512    2        DO I = 0 TO OUT$BLK.NSUBLKS - 1;

   4512  4 000007   200006 450100                    STZ     I,,AUTO
         4 000010   000462 710000 4                  TRA     s:4622+3

     2757     4513    3           DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);

   4513  4 000011   200003 470500                    LDP0    @TOP$,,AUTO
         4 000012   000000 471500                    LDP1    0,,PR0
         4 000013   200006 720100                    LXL0    I,,AUTO
         4 000014   100003 473510                    LDP3    3,X0,PR1
         4 000015   300000 721100                    LXL1    0,,PR3
         4 000016   000004 101003                    CMPX1   4,DU
         4 000017   000021 602011 4                  TNC     s:4513+8,X1
         4 000020   000457 710000 4                  TRA     s:4622
         4 000021   000457 710000 4                  TRA     s:4622
         4 000022   000025 710000 4                  TRA     s:4515
         4 000023   000336 710000 4                  TRA     s:4588
         4 000024   000407 710000 4                  TRA     s:4605

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:504  
     2758     4514    3              CASE(%FOR_CLAUSE);

     2759     4515    4                 DO J = 0 TO OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS - 1;

   4515  4 000025   200007 450100                    STZ     J,,AUTO
         4 000026   000324 710000 4                  TRA     s:4586+3

     2760     4516    4                    TEXT = '00000000';

   4516  4 000027   040100 100400                    MLR     fill='040'O
         4 000030   000153 000010 3                  ADSC9   DEVHIST+5                cn=0,n=8
         4 000031   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2761     4517    4                    CODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0)->
              4517                             OUT$BLK.CODE;

   4517  4 000032   200003 470500                    LDP0    @TOP$,,AUTO
         4 000033   000000 471500                    LDP1    0,,PR0
         4 000034   200006 720100                    LXL0    I,,AUTO
         4 000035   100003 473510                    LDP3    3,X0,PR1
         4 000036   200007 721100                    LXL1    J,,AUTO
         4 000037   300003 474511                    LDP4    3,X1,PR3
         4 000040   400003 475500                    LDP5    3,,PR4
         4 000041   500000 236100                    LDQ     0,,PR5
         4 000042   777777 376007                    ANQ     -1,DL
         4 000043   200010 756100                    STQ     CODE,,AUTO

     2762     4518    4                    LEN = 2;

   4518  4 000044   000002 235007                    LDA     2,DL
         4 000045   200013 755100                    STA     LEN,,AUTO

     2763     4519    5                    DO CASE(CODE);

   4519  4 000046   000037 116007                    CMPQ    31,DL
         4 000047   000051 602006 4                  TNC     s:4519+3,QL
         4 000050   000261 710000 4                  TRA     s:4574
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:505  
         4 000051   000261 710000 4                  TRA     s:4574
         4 000052   000162 710000 4                  TRA     s:4542
         4 000053   000246 710000 4                  TRA     s:4568
         4 000054   000240 710000 4                  TRA     s:4565
         4 000055   000174 710000 4                  TRA     s:4547
         4 000056   000261 710000 4                  TRA     s:4574
         4 000057   000204 710000 4                  TRA     s:4551
         4 000060   000210 710000 4                  TRA     s:4553
         4 000061   000214 710000 4                  TRA     s:4555
         4 000062   000220 710000 4                  TRA     s:4557
         4 000063   000234 710000 4                  TRA     s:4563
         4 000064   000224 710000 4                  TRA     s:4559
         4 000065   000230 710000 4                  TRA     s:4561
         4 000066   000200 710000 4                  TRA     s:4549
         4 000067   000254 710000 4                  TRA     s:4571
         4 000070   000110 710000 4                  TRA     s:4521
         4 000071   000116 710000 4                  TRA     s:4524
         4 000072   000124 710000 4                  TRA     s:4527
         4 000073   000132 710000 4                  TRA     s:4530
         4 000074   000140 710000 4                  TRA     s:4533
         4 000075   000146 710000 4                  TRA     s:4536
         4 000076   000154 710000 4                  TRA     s:4539
         4 000077   000261 710000 4                  TRA     s:4574
         4 000100   000261 710000 4                  TRA     s:4574
         4 000101   000261 710000 4                  TRA     s:4574
         4 000102   000261 710000 4                  TRA     s:4574
         4 000103   000261 710000 4                  TRA     s:4574
         4 000104   000261 710000 4                  TRA     s:4574
         4 000105   000261 710000 4                  TRA     s:4574
         4 000106   000261 710000 4                  TRA     s:4574
         4 000107   000170 710000 4                  TRA     s:4545

     2764     4520    5                       CASE(%MTU);

     2765     4521    5                          TEXT = 'MTU';

   4521  4 000110   040100 100400                    MLR     fill='040'O
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:506  
         4 000111   000155 000003 3                  ADSC9   DEVHIST+7                cn=0,n=3
         4 000112   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2766     4522    5                          LEN = 3;

   4522  4 000113   000003 235007                    LDA     3,DL
         4 000114   200013 755100                    STA     LEN,,AUTO
         4 000115   000261 710000 4                  TRA     s:4574

     2767     4523    5                       CASE(%MSU);

     2768     4524    5                          TEXT = 'MSU';

   4524  4 000116   040100 100400                    MLR     fill='040'O
         4 000117   000156 000003 3                  ADSC9   DEVHIST+8                cn=0,n=3
         4 000120   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2769     4525    5                          LEN = 3;

   4525  4 000121   000003 235007                    LDA     3,DL
         4 000122   200013 755100                    STA     LEN,,AUTO
         4 000123   000261 710000 4                  TRA     s:4574

     2770     4526    5                       CASE(%CRU);

     2771     4527    5                          TEXT = 'CRU';

   4527  4 000124   040100 100400                    MLR     fill='040'O
         4 000125   000157 000003 3                  ADSC9   DEVHIST+9                cn=0,n=3
         4 000126   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2772     4528    5                          LEN = 3;

   4528  4 000127   000003 235007                    LDA     3,DL
         4 000130   200013 755100                    STA     LEN,,AUTO
         4 000131   000261 710000 4                  TRA     s:4574

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:507  
     2773     4529    5                       CASE(%PCU);

     2774     4530    5                          TEXT = 'PCU';

   4530  4 000132   040100 100400                    MLR     fill='040'O
         4 000133   000160 000003 3                  ADSC9   DEVHIST+10               cn=0,n=3
         4 000134   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2775     4531    5                          LEN = 3;

   4531  4 000135   000003 235007                    LDA     3,DL
         4 000136   200013 755100                    STA     LEN,,AUTO
         4 000137   000261 710000 4                  TRA     s:4574

     2776     4532    5                       CASE(%PRU);

     2777     4533    5                          TEXT = 'PRU';

   4533  4 000140   040100 100400                    MLR     fill='040'O
         4 000141   000161 000003 3                  ADSC9   DEVHIST+11               cn=0,n=3
         4 000142   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2778     4534    5                          LEN = 3;

   4534  4 000143   000003 235007                    LDA     3,DL
         4 000144   200013 755100                    STA     LEN,,AUTO
         4 000145   000261 710000 4                  TRA     s:4574

     2779     4535    5                       CASE(%MPC1);

     2780     4536    5                          TEXT = 'MPC';

   4536  4 000146   040100 100400                    MLR     fill='040'O
         4 000147   000162 000003 3                  ADSC9   DEVHIST+12               cn=0,n=3
         4 000150   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2781     4537    5                          LEN = 3;
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:508  

   4537  4 000151   000003 235007                    LDA     3,DL
         4 000152   200013 755100                    STA     LEN,,AUTO
         4 000153   000261 710000 4                  TRA     s:4574

     2782     4538    5                       CASE(%CONSOLE);

     2783     4539    5                          TEXT = 'CONSOLE';

   4539  4 000154   040100 100400                    MLR     fill='040'O
         4 000155   000163 000007 3                  ADSC9   DEVHIST+13               cn=0,n=7
         4 000156   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2784     4540    5                          LEN = 7;

   4540  4 000157   000007 235007                    LDA     7,DL
         4 000160   200013 755100                    STA     LEN,,AUTO
         4 000161   000261 710000 4                  TRA     s:4574

     2785     4541    5                       CASE(%MEM);

     2786     4542    5                          TEXT = 'MEM';

   4542  4 000162   040100 100400                    MLR     fill='040'O
         4 000163   000165 000003 3                  ADSC9   DEVHIST+15               cn=0,n=3
         4 000164   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2787     4543    5                          LEN = 3;

   4543  4 000165   000003 235007                    LDA     3,DL
         4 000166   200013 755100                    STA     LEN,,AUTO
         4 000167   000261 710000 4                  TRA     s:4574

     2788     4544    5                       CASE(%MC);

     2789     4545    5                          TEXT = 'MC';

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:509  
   4545  4 000170   040100 100400                    MLR     fill='040'O
         4 000171   000166 000002 3                  ADSC9   DEVHIST+16               cn=0,n=2
         4 000172   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000173   000261 710000 4                  TRA     s:4574

     2790     4546    5                       CASE(%MT);

     2791     4547    5                          TEXT = 'MT';

   4547  4 000174   040100 100400                    MLR     fill='040'O
         4 000175   000155 000002 3                  ADSC9   DEVHIST+7                cn=0,n=2
         4 000176   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000177   000261 710000 4                  TRA     s:4574

     2792     4548    5                       CASE(%SC);

     2793     4549    5                          TEXT = 'SC';

   4549  4 000200   040100 100400                    MLR     fill='040'O
         4 000201   000167 000002 3                  ADSC9   DEVHIST+17               cn=0,n=2
         4 000202   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000203   000261 710000 4                  TRA     s:4574

     2794     4550    5                       CASE(%DP);

     2795     4551    5                          TEXT = 'DP';

   4551  4 000204   040100 100400                    MLR     fill='040'O
         4 000205   000170 000002 3                  ADSC9   DEVHIST+18               cn=0,n=2
         4 000206   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000207   000261 710000 4                  TRA     s:4574

     2796     4552    5                       CASE(%CR);

     2797     4553    5                          TEXT = 'CR';

   4553  4 000210   040100 100400                    MLR     fill='040'O
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:510  
         4 000211   000157 000002 3                  ADSC9   DEVHIST+9                cn=0,n=2
         4 000212   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000213   000261 710000 4                  TRA     s:4574

     2798     4554    5                       CASE(%CP);

     2799     4555    5                          TEXT = 'CP';

   4555  4 000214   040100 100400                    MLR     fill='040'O
         4 000215   000171 000002 3                  ADSC9   DEVHIST+19               cn=0,n=2
         4 000216   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000217   000261 710000 4                  TRA     s:4574

     2800     4556    5                       CASE(%LP);

     2801     4557    5                          TEXT = 'LP';

   4557  4 000220   040100 100400                    MLR     fill='040'O
         4 000221   000172 000002 3                  ADSC9   DEVHIST+20               cn=0,n=2
         4 000222   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000223   000261 710000 4                  TRA     s:4574

     2802     4558    5                       CASE(%UC);

     2803     4559    5                          TEXT = 'UC';

   4559  4 000224   040100 100400                    MLR     fill='040'O
         4 000225   000173 000002 3                  ADSC9   DEVHIST+21               cn=0,n=2
         4 000226   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000227   000261 710000 4                  TRA     s:4574

     2804     4560    5                       CASE(%DC);

     2805     4561    5                          TEXT = 'DC';

   4561  4 000230   040100 100400                    MLR     fill='040'O
         4 000231   000174 000002 3                  ADSC9   DEVHIST+22               cn=0,n=2
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:511  
         4 000232   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000233   000261 710000 4                  TRA     s:4574

     2806     4562    5                       CASE(%TC);

     2807     4563    5                          TEXT = 'TC';

   4563  4 000234   040100 100400                    MLR     fill='040'O
         4 000235   000175 000002 3                  ADSC9   DEVHIST+23               cn=0,n=2
         4 000236   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
         4 000237   000261 710000 4                  TRA     s:4574

     2808     4564    5                       CASE(%FEP);

     2809     4565    5                          TEXT = 'FEP';

   4565  4 000240   040100 100400                    MLR     fill='040'O
         4 000241   000176 000003 3                  ADSC9   DEVHIST+24               cn=0,n=3
         4 000242   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2810     4566    5                          LEN = 3;

   4566  4 000243   000003 235007                    LDA     3,DL
         4 000244   200013 755100                    STA     LEN,,AUTO
         4 000245   000261 710000 4                  TRA     s:4574

     2811     4567    5                       CASE(%IOM);

     2812     4568    5                          TEXT = 'IOM';

   4568  4 000246   040100 100400                    MLR     fill='040'O
         4 000247   000177 000003 3                  ADSC9   DEVHIST+25               cn=0,n=3
         4 000250   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2813     4569    5                          LEN = 3;

   4569  4 000251   000003 235007                    LDA     3,DL
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:512  
         4 000252   200013 755100                    STA     LEN,,AUTO
         4 000253   000261 710000 4                  TRA     s:4574

     2814     4570    5                       CASE(%ALL);

     2815     4571    5                          TEXT = 'ALL';

   4571  4 000254   040100 100400                    MLR     fill='040'O
         4 000255   000200 000003 3                  ADSC9   DEVHIST+26               cn=0,n=3
         4 000256   200011 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8

     2816     4572    5                          LEN = 3;

   4572  4 000257   000003 235007                    LDA     3,DL
         4 000260   200013 755100                    STA     LEN,,AUTO

     2817     4573    5                    END;                      /* DO CASE CODE                       */

     2818     4574    4                    IF OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.NSUBLKS = 2

   4574  4 000261   000000 471500                    LDP1    0,,PR0
         4 000262   100003 473510                    LDP3    3,X0,PR1
         4 000263   300003 474511                    LDP4    3,X1,PR3
         4 000264   400001 222100                    LDX2    1,,PR4
         4 000265   000002 102003                    CMPX2   2,DU
         4 000266   000306 601000 4                  TNZ     s:4583

     2819     4575    4                       THEN
     2820     4576    5                       DO;

     2821     4577    5                         SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(1
              4577                                   );

   4577  4 000267   400004 236100                    LDQ     4,,PR4
         4 000270   200005 756100                    STQ     SYM$,,AUTO

     2822     4578    5                          CALL INSERT(TEXT,LEN,OUT$SYM.COUNT,OUT$SYM.TEXT);
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:513  

   4578  4 000271   200005 475500                    LDP5    SYM$,,AUTO
         4 000272   500004 236100                    LDQ     4,,PR5
         4 000273   000033 772000                    QRL     27
         4 000274   000000 623006                    EAX3    0,QL
         4 000275   000000 624006                    EAX4    0,QL
         4 000276   040145 100540                    MLR     fill='040'O
         4 000277   500004 200013                    ADSC9   4,,PR5                   cn=1,n=*X3
         4 000300   200011 000014                    ADSC9   TEXT,A,AUTO              cn=0,n=*X4

     2823     4579    5                          LEN = LEN + OUT$SYM.COUNT;

   4579  4 000301   500004 236100                    LDQ     4,,PR5
         4 000302   000033 772000                    QRL     27
         4 000303   200013 036100                    ADLQ    LEN,,AUTO
         4 000304   200013 756100                    STQ     LEN,,AUTO

     2824     4580    5                       END;

   4580  4 000305   000307 710000 4                  TRA     s:4585

     2825     4581    4                       ELSE
     2826     4582    5                       DO;

     2827     4583    5                          LEN = 0;

   4583  4 000306   200013 450100                    STZ     LEN,,AUTO

     2828     4584    5                       END;

     2829     4585    4                    CALL THS$SET_DEVS(CODE,TEXT,LEN) ALTRET(RET);

   4585  4 000307   200013 631500                    EPPR1   LEN,,AUTO
         4 000310   204030 451500                    STP1    TH_THRESH+2050,,AUTO
         4 000311   200011 633500                    EPPR3   TEXT,,AUTO
         4 000312   204027 453500                    STP3    TH_THRESH+2049,,AUTO
         4 000313   200010 634500                    EPPR4   CODE,,AUTO
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:514  
         4 000314   204026 454500                    STP4    TH_THRESH+2048,,AUTO
         4 000315   204026 630500                    EPPR0   TH_THRESH+2048,,AUTO
         4 000316   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000317   000000 701000 xent               TSX1    THS$SET_DEVS
         4 000320   000750 702000 4                  TSX2    RET

     2830     4586    4                    END;  /* DO J */

   4586  4 000321   200007 235100                    LDA     J,,AUTO
         4 000322   000001 035007                    ADLA    1,DL
         4 000323   200007 755100                    STA     J,,AUTO
         4 000324   200003 470500                    LDP0    @TOP$,,AUTO
         4 000325   000000 471500                    LDP1    0,,PR0
         4 000326   200006 720100                    LXL0    I,,AUTO
         4 000327   100003 473510                    LDP3    3,X0,PR1
         4 000330   300001 236100                    LDQ     1,,PR3
         4 000331   000022 772000                    QRL     18
         4 000332   200007 116100                    CMPQ    J,,AUTO
         4 000333   000335 600000 4                  TZE     s:4586+12
         4 000334   000027 603000 4                  TRC     s:4516
         4 000335   000457 710000 4                  TRA     s:4622

     2831     4587    3              CASE(%ATTEN);

     2832     4588    3                 ATTEN_FLG = %TRUE;

   4588  4 000336   400000 236003                    LDQ     -131072,DU
         4 000337   000003 756000 2                  STQ     ATTEN_FLG

     2833     4589    3                 ATTEN = 0;

   4589  4 000340   200014 450100                    STZ     ATTEN,,AUTO

     2834     4590    3                 SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);

   4590  4 000341   300003 236100                    LDQ     3,,PR3
         4 000342   200005 756100                    STQ     SYM$,,AUTO
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:515  

     2835     4591    3                 CALL CHARBIN(TEMP,OUT$SYM.TEXT);

   4591  4 000343   200005 474500                    LDP4    SYM$,,AUTO
         4 000344   400004 236100                    LDQ     4,,PR4
         4 000345   000033 772000                    QRL     27
         4 000346   000000 622006                    EAX2    0,QL
         4 000347   000100 305540                    DTB
         4 000350   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 000351   200016 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4

     2836     4592    3                 ATTEN = TEMP * 100;

   4592  4 000352   200016 236100                    LDQ     TEMP,,AUTO
         4 000353   000144 402007                    MPY     100,DL
         4 000354   200014 756100                    STQ     ATTEN,,AUTO

     2837     4593    3                 IF OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS = 2

   4593  4 000355   300001 223100                    LDX3    1,,PR3
         4 000356   000002 103003                    CMPX3   2,DU
         4 000357   000457 601000 4                  TNZ     s:4622

     2838     4594    3                    THEN                   /* FRACTIONAL PART IS THERE           */
     2839     4595    4                    DO;

     2840     4596    4                       SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1);

   4596  4 000360   300004 236100                    LDQ     4,,PR3
         4 000361   200005 756100                    STQ     SYM$,,AUTO

     2841     4597    5                       IF OUT$SYM.COUNT = 1 THEN DO;

   4597  4 000362   200005 474500                    LDP4    SYM$,,AUTO
         4 000363   400004 236100                    LDQ     4,,PR4
         4 000364   777000 376003                    ANQ     -512,DU
         4 000365   001000 116003                    CMPQ    512,DU
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:516  
         4 000366   000375 601000 4                  TNZ     s:4601

     2842     4598    5                          OUT$SYM.COUNT = 2;

   4598  4 000367   002000 236003                    LDQ     1024,DU
         4 000370   400004 552140                    STBQ    4,'40'O,PR4

     2843     4599    5                          CALL INSERT(OUT$SYM.TEXT,1,1,'0');

   4599  4 000371   400004 236100                    LDQ     4,,PR4
         4 000372   000033 772000                    QRL     27
         4 000373   060000 236007                    LDQ     24576,DL
         4 000374   400004 552110                    STBQ    4,'10'O,PR4

     2844     4600    5                          END;  /* IF COUNT = 1 */

     2845     4601    4                       CALL CHARBIN(TEMP,OUT$SYM.TEXT);

   4601  4 000375   400004 236100                    LDQ     4,,PR4
         4 000376   000033 772000                    QRL     27
         4 000377   000000 621006                    EAX1    0,QL
         4 000400   000100 305540                    DTB
         4 000401   400004 230011                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
         4 000402   200016 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4

     2846     4602    4                       ATTEN = ATTEN + TEMP;

   4602  4 000403   200014 236100                    LDQ     ATTEN,,AUTO
         4 000404   200016 036100                    ADLQ    TEMP,,AUTO
         4 000405   200014 756100                    STQ     ATTEN,,AUTO

     2847     4603    4                    END;                   /* IF NSUBLKS = 2                     */

   4603  4 000406   000457 710000 4                  TRA     s:4622

     2848     4604    3              CASE(%ALERT);

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:517  
     2849     4605    3                 ALERT_FLG = %TRUE;

   4605  4 000407   400000 236003                    LDQ     -131072,DU
         4 000410   000004 756000 2                  STQ     ALERT_FLG

     2850     4606    3                 ALERT = 0;

   4606  4 000411   200015 450100                    STZ     ALERT,,AUTO

     2851     4607    3                 SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0);

   4607  4 000412   300003 236100                    LDQ     3,,PR3
         4 000413   200005 756100                    STQ     SYM$,,AUTO

     2852     4608    3                 CALL CHARBIN(TEMP,OUT$SYM.TEXT);

   4608  4 000414   200005 474500                    LDP4    SYM$,,AUTO
         4 000415   400004 236100                    LDQ     4,,PR4
         4 000416   000033 772000                    QRL     27
         4 000417   000000 622006                    EAX2    0,QL
         4 000420   000100 305540                    DTB
         4 000421   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 000422   200016 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4

     2853     4609    3                 ALERT = TEMP * 100;

   4609  4 000423   200016 236100                    LDQ     TEMP,,AUTO
         4 000424   000144 402007                    MPY     100,DL
         4 000425   200015 756100                    STQ     ALERT,,AUTO

     2854     4610    3                 IF OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS = 2

   4610  4 000426   300001 223100                    LDX3    1,,PR3
         4 000427   000002 103003                    CMPX3   2,DU
         4 000430   000457 601000 4                  TNZ     s:4622

     2855     4611    3                    THEN                   /* FRACTIONAL PART IS THERE           */
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:518  
     2856     4612    4                    DO;

     2857     4613    4                       SYM$ = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(1);

   4613  4 000431   300004 236100                    LDQ     4,,PR3
         4 000432   200005 756100                    STQ     SYM$,,AUTO

     2858     4614    5                       IF OUT$SYM.COUNT = 1 THEN DO;

   4614  4 000433   200005 474500                    LDP4    SYM$,,AUTO
         4 000434   400004 236100                    LDQ     4,,PR4
         4 000435   777000 376003                    ANQ     -512,DU
         4 000436   001000 116003                    CMPQ    512,DU
         4 000437   000446 601000 4                  TNZ     s:4618

     2859     4615    5                          OUT$SYM.COUNT = 2;

   4615  4 000440   002000 236003                    LDQ     1024,DU
         4 000441   400004 552140                    STBQ    4,'40'O,PR4

     2860     4616    5                          CALL INSERT(OUT$SYM.TEXT,1,1,'0');

   4616  4 000442   400004 236100                    LDQ     4,,PR4
         4 000443   000033 772000                    QRL     27
         4 000444   060000 236007                    LDQ     24576,DL
         4 000445   400004 552110                    STBQ    4,'10'O,PR4

     2861     4617    5                          END;  /* IF COUNT = 1 */

     2862     4618    4                       CALL CHARBIN(TEMP,OUT$SYM.TEXT);

   4618  4 000446   400004 236100                    LDQ     4,,PR4
         4 000447   000033 772000                    QRL     27
         4 000450   000000 621006                    EAX1    0,QL
         4 000451   000100 305540                    DTB
         4 000452   400004 230011                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
         4 000453   200016 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:519  

     2863     4619    4                       ALERT = ALERT + TEMP;

   4619  4 000454   200015 236100                    LDQ     ALERT,,AUTO
         4 000455   200016 036100                    ADLQ    TEMP,,AUTO
         4 000456   200015 756100                    STQ     ALERT,,AUTO

     2864     4620    4                    END;                   /* IF NSUBLKS = 2                     */

     2865     4621    3           END;                            /* DO CASE(CODE)                      */

     2866     4622    2        END;                               /* DO I                               */

   4622  4 000457   200006 235100                    LDA     I,,AUTO
         4 000460   000001 035007                    ADLA    1,DL
         4 000461   200006 755100                    STA     I,,AUTO
         4 000462   200003 470500                    LDP0    @TOP$,,AUTO
         4 000463   000000 471500                    LDP1    0,,PR0
         4 000464   100001 236100                    LDQ     1,,PR1
         4 000465   000022 772000                    QRL     18
         4 000466   200006 116100                    CMPQ    I,,AUTO
         4 000467   000471 600000 4                  TZE     s:4624
         4 000470   000011 603000 4                  TRC     s:4513

     2867     4623
     2868     4624    1        CALL THG$GETREC(%DEVHIST,ONE);

   4624  4 000471   000000 630400 5                  EPPR0   0
         4 000472   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000473   000000 701000 xent               TSX1    THG$GETREC
         4 000474   000000 011000                    NOP     0

     2869     4625    1        TH_THRESH = TH_RECORD.PTR$->TH$THRESH;

   4625  4 000475   000001 470400 xsym               LDP0    TH_RECORD+1
         4 000476   020000 220003                    LDX0    8192,DU
         4 000477   000140 100540                    MLR     fill='000'O
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:520  
         4 000500   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 000501   200026 000010                    ADSC9   TH_THRESH,,AUTO          cn=0,n=*X0

     2870     4626
     2871     4627    2        DO I = 0 TO TH_NUM_REP_DEVS - 1;

   4627  4 000502   200006 450100                    STZ     I,,AUTO
         4 000503   000671 710000 4                  TRA     s:4656+3

     2872     4628    3           DO J = 0 TO TH_NUM_DEVS - 1;

   4628  4 000504   200007 450100                    STZ     J,,AUTO
         4 000505   000663 710000 4                  TRA     s:4655+3

     2873     4629    3              IF TH_REP_DEVS(I) = TH_THRESH.DEVNAME(J)

   4629  4 000506   200006 235100                    LDA     I,,AUTO
         4 000507   000003 735000                    ALS     3
         4 000510   200007 236100                    LDQ     J,,AUTO
         4 000511   000004 736000                    QLS     4
         4 000512   040106 106405                    CMPC    fill='040'O
         4 000513   000000 000010 xsym               ADSC9   TH_REP_DEVS,A            cn=0,n=8
         4 000514   200026 000010                    ADSC9   TH_THRESH,Q,AUTO         cn=0,n=8
         4 000515   000660 601000 4                  TNZ     s:4655

     2874     4630    3                 THEN
     2875     4631    4                 DO;

     2876     4632    5                    IF NOT(ATTEN_FLG OR ALERT_FLG) THEN DO;  /* DISPLAY */

   4632  4 000516   000003 234000 2                  SZN     ATTEN_FLG
         4 000517   000644 604000 4                  TMI     s:4649
         4 000520   000004 234000 2                  SZN     ALERT_FLG
         4 000521   000644 604000 4                  TMI     s:4649

     2877     4633    5                       TEMP = TH_THRESH.ATTEN(J)/100;

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:521  
   4633  4 000522   200007 235100                    LDA     J,,AUTO
         4 000523   000002 735000                    ALS     2
         4 000524   200030 236105                    LDQ     TH_THRESH+2,AL,AUTO
         4 000525   000144 506007                    DIV     100,DL
         4 000526   200016 756100                    STQ     TEMP,,AUTO

     2878     4634    5                       CALL BINCHAR(BUF1,TEMP);

   4634  4 000527   000100 301500                    BTD
         4 000530   200016 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         4 000531   200024 030002                    NDSC9   BUF1,,AUTO               cn=0,s=nosgn,sf=0,n=2

     2879     4635    5                       TEMP = MOD(TH_THRESH.ATTEN(J),100);

   4635  4 000532   200007 235100                    LDA     J,,AUTO
         4 000533   000002 735000                    ALS     2
         4 000534   200030 236105                    LDQ     TH_THRESH+2,AL,AUTO
         4 000535   000144 506007                    DIV     100,DL
         4 000536   200016 755100                    STA     TEMP,,AUTO

     2880     4636    5                       CALL BINCHAR(BUF2,TEMP);

   4636  4 000537   000100 301500                    BTD
         4 000540   200016 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         4 000541   200025 030002                    NDSC9   BUF2,,AUTO               cn=0,s=nosgn,sf=0,n=2

     2881     4637    5                       CALL INSERT(ATTEN_BUF,0,5,BUF1,'.',BUF2);

   4637  4 000542   200024 220100                    LDX0    BUF1,,AUTO
         4 000543   200020 740100                    STX0    ATTEN_BUF,,AUTO
         4 000544   056000 236007                    LDQ     23552,DL
         4 000545   200020 552110                    STBQ    ATTEN_BUF,'10'O,AUTO
         4 000546   040100 100500                    MLR     fill='040'O
         4 000547   200025 000002                    ADSC9   BUF2,,AUTO               cn=0,n=2
         4 000550   200020 600002                    ADSC9   ATTEN_BUF,,AUTO          cn=3,n=2

     2882     4638    5                       TEMP = TH_THRESH.ALERT(J)/100;
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:522  

   4638  4 000551   200007 235100                    LDA     J,,AUTO
         4 000552   000002 735000                    ALS     2
         4 000553   200031 236105                    LDQ     TH_THRESH+3,AL,AUTO
         4 000554   000144 506007                    DIV     100,DL
         4 000555   200016 756100                    STQ     TEMP,,AUTO

     2883     4639    5                       CALL BINCHAR(BUF1,TEMP);

   4639  4 000556   000100 301500                    BTD
         4 000557   200016 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         4 000560   200024 030002                    NDSC9   BUF1,,AUTO               cn=0,s=nosgn,sf=0,n=2

     2884     4640    5                       TEMP = MOD(TH_THRESH.ALERT(J),100);

   4640  4 000561   200007 235100                    LDA     J,,AUTO
         4 000562   000002 735000                    ALS     2
         4 000563   200031 236105                    LDQ     TH_THRESH+3,AL,AUTO
         4 000564   000144 506007                    DIV     100,DL
         4 000565   200016 755100                    STA     TEMP,,AUTO

     2885     4641    5                       CALL BINCHAR(BUF2,TEMP);

   4641  4 000566   000100 301500                    BTD
         4 000567   200016 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         4 000570   200025 030002                    NDSC9   BUF2,,AUTO               cn=0,s=nosgn,sf=0,n=2

     2886     4642    5                       CALL INSERT(ALERT_BUF,0,5,BUF1,'.',BUF2);

   4642  4 000571   200024 220100                    LDX0    BUF1,,AUTO
         4 000572   200022 740100                    STX0    ALERT_BUF,,AUTO
         4 000573   056000 236007                    LDQ     23552,DL
         4 000574   200022 552110                    STBQ    ALERT_BUF,'10'O,AUTO
         4 000575   040100 100500                    MLR     fill='040'O
         4 000576   200025 000002                    ADSC9   BUF2,,AUTO               cn=0,n=2
         4 000577   200022 600002                    ADSC9   ALERT_BUF,,AUTO          cn=3,n=2

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:523  
     2887     4643    5                       CALL THW$WRITE(VECTOR(DISPTHRESH),

   4643  4 000600   000004 235000 5                  LDA     4
         4 000601   204026 452500                    STP2    TH_THRESH+2048,,AUTO
         4 000602   200007 236100                    LDQ     J,,AUTO
         4 000603   000024 736000                    QLS     20
         4 000604   000026 036003                    ADLQ    22,DU
         4 000605   204026 036100                    ADLQ    TH_THRESH+2048,,AUTO
         4 000606   204030 757100                    STAQ    TH_THRESH+2050,,AUTO
         4 000607   000005 235000 5                  LDA     5
         4 000610   204032 452500                    STP2    TH_THRESH+2052,,AUTO
         4 000611   204032 236100                    LDQ     TH_THRESH+2052,,AUTO
         4 000612   000020 036003                    ADLQ    16,DU
         4 000613   204034 757100                    STAQ    TH_THRESH+2054,,AUTO
         4 000614   000005 235000 5                  LDA     5
         4 000615   204036 452500                    STP2    TH_THRESH+2056,,AUTO
         4 000616   204036 236100                    LDQ     TH_THRESH+2056,,AUTO
         4 000617   000022 036003                    ADLQ    18,DU
         4 000620   204042 757100                    STAQ    TH_THRESH+2060,,AUTO
         4 000621   204030 237100                    LDAQ    TH_THRESH+2050,,AUTO
         4 000622   204040 757100                    STAQ    TH_THRESH+2058,,AUTO
         4 000623   204034 237100                    LDAQ    TH_THRESH+2054,,AUTO
         4 000624   204044 757100                    STAQ    TH_THRESH+2062,,AUTO
         4 000625   204042 237100                    LDAQ    TH_THRESH+2060,,AUTO
         4 000626   204046 757100                    STAQ    TH_THRESH+2064,,AUTO
         4 000627   204046 630500                    EPPR0   TH_THRESH+2064,,AUTO
         4 000630   204053 450500                    STP0    TH_THRESH+2069,,AUTO
         4 000631   204044 631500                    EPPR1   TH_THRESH+2062,,AUTO
         4 000632   204052 451500                    STP1    TH_THRESH+2068,,AUTO
         4 000633   204040 633500                    EPPR3   TH_THRESH+2058,,AUTO
         4 000634   204051 453500                    STP3    TH_THRESH+2067,,AUTO
         4 000635   000006 236000 5                  LDQ     6
         4 000636   204050 756100                    STQ     TH_THRESH+2066,,AUTO
         4 000637   204050 630500                    EPPR0   TH_THRESH+2066,,AUTO
         4 000640   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000641   000000 701000 xent               TSX1    THW$WRITE
         4 000642   000000 011000                    NOP     0
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:524  

     2888     4644    5                                      VECTOR(TH_THRESH.DEVNAME(J)),
     2889     4645    5                                      VECTOR(ATTEN_BUF),
     2890     4646    5                                      VECTOR(ALERT_BUF));
     2891     4647    5                       END;  /* IF DISPLAY */

   4647  4 000643   000660 710000 4                  TRA     s:4655

     2892     4648    5                    ELSE DO;

     2893     4649    5                       IF ATTEN_FLG

   4649  4 000644   000003 234000 2                  SZN     ATTEN_FLG
         4 000645   000652 605000 4                  TPL     s:4651

     2894     4650    5                          THEN TH_THRESH.ATTEN(J) = ATTEN;

   4650  4 000646   200007 235100                    LDA     J,,AUTO
         4 000647   000002 735000                    ALS     2
         4 000650   200014 236100                    LDQ     ATTEN,,AUTO
         4 000651   200030 756105                    STQ     TH_THRESH+2,AL,AUTO

     2895     4651    5                       IF ALERT_FLG

   4651  4 000652   000004 234000 2                  SZN     ALERT_FLG
         4 000653   000660 605000 4                  TPL     s:4655

     2896     4652    5                          THEN TH_THRESH.ALERT(J) = ALERT;

   4652  4 000654   200007 235100                    LDA     J,,AUTO
         4 000655   000002 735000                    ALS     2
         4 000656   200015 236100                    LDQ     ALERT,,AUTO
         4 000657   200031 756105                    STQ     TH_THRESH+3,AL,AUTO

     2897     4653    5                       END;  /* ELSE */

     2898     4654    4                 END;                      /* IF                                 */
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:525  

     2899     4655    3           END;                            /* DO J                               */

   4655  4 000660   200007 235100                    LDA     J,,AUTO
         4 000661   000001 035007                    ADLA    1,DL
         4 000662   200007 755100                    STA     J,,AUTO
         4 000663   200007 236100                    LDQ     J,,AUTO
         4 000664   000000 116000 xsym               CMPQ    TH_NUM_DEVS
         4 000665   000506 602000 4                  TNC     s:4629

     2900     4656    2        END;  /* DO I */

   4656  4 000666   200006 235100                    LDA     I,,AUTO
         4 000667   000001 035007                    ADLA    1,DL
         4 000670   200006 755100                    STA     I,,AUTO
         4 000671   200006 236100                    LDQ     I,,AUTO
         4 000672   000000 116000 xsym               CMPQ    TH_NUM_REP_DEVS
         4 000673   000504 602000 4                  TNC     s:4628

     2901     4657    1        IF NOT(ATTEN_FLG OR ALERT_FLG) THEN RETURN;

   4657  4 000674   000003 234000 2                  SZN     ATTEN_FLG
         4 000675   000701 604000 4                  TMI     s:4658
         4 000676   000004 234000 2                  SZN     ALERT_FLG
         4 000677   000701 604000 4                  TMI     s:4658

   4657  4 000700   000000 702200 xent               TSX2  ! X66_ARET

     2902     4658    1        M$DEVHIST$ = DCBADDR(DCBNUM(M$DEVHIST));

   4658  4 000701   000000 236007 xsym               LDQ     M$DEVHIST,DL
         4 000702   000007 470400 5                  LDP0    7
         4 000703   000000 471500                    LDP1    0,,PR0
         4 000704   100000 236106                    LDQ     0,QL,PR1
         4 000705   200004 756100                    STQ     M$DEVHIST$,,AUTO

     2903     4659    1        WRITE_DEVHIST.KEY_ = VECTOR(THRESH_KEY);
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:526  

   4659  4 000706   000010 237000 5                  LDAQ    8
         4 000707   000010 757000 2                  STAQ    WRITE_DEVHIST+2

     2904     4660    1        WRITE_DEVHIST.BUF_ = VECTOR(TH_THRESH);

   4660  4 000710   000012 235000 5                  LDA     10
         4 000711   204026 452500                    STP2    TH_THRESH+2048,,AUTO
         4 000712   204026 236100                    LDQ     TH_THRESH+2048,,AUTO
         4 000713   000026 036003                    ADLQ    22,DU
         4 000714   000012 757000 2                  STAQ    WRITE_DEVHIST+4

     2905     4661    1        WRITE_DEVHIST.BUF_.BOUND = M$DEVHIST$->F$DCB.ARS - 1;

   4661  4 000715   200004 473500                    LDP3    M$DEVHIST$,,AUTO
         4 000716   300000 236100                    LDQ     0,,PR3
         4 000717   000001 136007                    SBLQ    1,DL
         4 000720   000020 736000                    QLS     16
         4 000721   000012 676000 2                  ERQ     WRITE_DEVHIST+4
         4 000722   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000723   000012 656000 2                  ERSQ    WRITE_DEVHIST+4

     2906     4662
     2907     4663                                                /* WRITE RECORD BACK OUT              */
     2908     4664    1        IF DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.FCD

   4664  4 000724   000000 236007 xsym               LDQ     M$DEVHIST,DL
         4 000725   100000 474506                    LDP4    0,QL,PR1
         4 000726   400031 236100                    LDQ     25,,PR4
         4 000727   020000 316007                    CANQ    8192,DL
         4 000730   000734 600000 4                  TZE     s:4666

     2909     4665    1           THEN CALL M$CLOSE(CLOSE_DEVHIST);

   4665  4 000731   000110 630400 3                  EPPR0   CLOSE_DEVHIST
         4 000732   050001 713400                    CLIMB   close
         4 000733   406000 401760                    pmme    nvectors=13
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:527  

     2910     4666    1        CALL M$OPEN(OPEN_DEVHIST) ALTRET(BAG_IT);

   4666  4 000734   000016 630400 3                  EPPR0   OPEN_DEVHIST
         4 000735   450000 713400                    CLIMB   alt,open
         4 000736   410400 401760                    pmme    nvectors=18
         4 000737   000751 702000 4                  TSX2    BAG_IT

     2911     4667    1        CALL M$WRITE(WRITE_DEVHIST) ALTRET(BAG_IT);

   4667  4 000740   000006 630400 2                  EPPR0   WRITE_DEVHIST
         4 000741   440001 713400                    CLIMB   alt,write
         4 000742   401400 401760                    pmme    nvectors=4
         4 000743   000751 702000 4                  TSX2    BAG_IT

     2912     4668    1        CALL M$CLOSE(CLOSE_DEVHIST) ALTRET(BAG_IT);

   4668  4 000744   000110 630400 3                  EPPR0   CLOSE_DEVHIST
         4 000745   450001 713400                    CLIMB   alt,close
         4 000746   406000 401760                    pmme    nvectors=13
         4 000747   000751 702000 4                  TSX2    BAG_IT

     2913     4669    1   RET: RETURN;

   4669  4 000750   000000 702200 xent  RET          TSX2  ! X66_ARET

     2914     4670    1   BAG_IT:
     2915     4671    1        CALL THM$ERRMSG(%E$TH_CANTSETTHRESH);

   4671  4 000751   000014 630400 5     BAG_IT       EPPR0   12
         4 000752   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000753   000000 701000 xent               TSX1    THM$ERRMSG
         4 000754   000000 011000                    NOP     0

     2916     4672        /*E* ERROR: THE-E$TH_CANTSETTHRESH-0
     2917     4673             MESSAGE: You are not allowed to change thresholds.
     2918     4674             MESSAGE1: You do not have the priviliges needed to write to *DEVHIST.  */
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:528  
     2919     4675    1        RETURN;

   4675  4 000755   000000 702200 xent               TSX2  ! X66_ARET
     2920     4676    1   END THC$THRESH;
     2921     4677        %EOD;

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:529  
--  Include file information  --

   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TH$HIST.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$THRESH.
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:530  

 **** Variables and constants ****

  ****  Section 002  Data  THC$THRESH

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/b BIT         r     1 ALERT_FLG                  3-0-0/b BIT         r     1 ATTEN_FLG
     0-0-0/c CHAR(8)     r     1 ONE                        2-0-0/b BIT (18)    r     1 THRESH_KEY
     6-0-0/d STRC(432)   r     1 WRITE_DEVHIST

  ****  Section 003 RoData THC$THRESH

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   110-0-0/d STRC(1080)  r     1 CLOSE_DEVHIST            146-0-0/c STRC(81)    r     1 DEVHIST
     0-0-0/c CHAR(50)    r     1 DISPTHRESH                16-0-0/d STRC(2088)  r     1 OPEN_DEVHIST

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                     15-0-0/w UBIN        r     1 ALERT
    22-0-0/c CHAR(5)     r     1 ALERT_BUF                 14-0-0/w UBIN        r     1 ATTEN
    20-0-0/c CHAR(5)     r     1 ATTEN_BUF                 24-0-0/c CHAR(2)     r     1 BUF1
    25-0-0/c CHAR(2)     r     1 BUF2                      10-0-0/w UBIN        r     1 CODE
     6-0-0/w UBIN        r     1 I                          7-0-0/w UBIN        r     1 J
    13-0-0/w UBIN        r     1 LEN                        4-0-0/w PTR         r     1 M$DEVHIST$
     5-0-0/w PTR         r     1 SYM$                      16-0-0/w SBIN        r     1 TEMP
    11-0-0/c CHAR(8)     r     1 TEXT
    26-0-0/w STRC(144)   r     1 TH_THRESH(0:511)
    *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:531  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/c STRC(72)    r     1 DEVHIST_ACCT
     0-0-0/w UBIN        r     1 TH_NUM_DEVS                0-0-0/w UBIN        r     1 TH_NUM_REP_DEVS
     0-0-0/d STRC(72)    r     1 TH_RECORD
     0-0-0/w CHAR(8)     r     1 TH_REP_DEVS(0:511)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DEVHIST
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 TH$THRESH(0:511)


   Procedure THC$THRESH requires 494 words for executable code.
   Procedure THC$THRESH requires 2092 words of local(AUTO) storage.
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:532  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:533  
          MINI XREF LISTING

ALERT
      4159**DCL      4606<<ASSIGN   4609<<ASSIGN   4619<<ASSIGN   4619>>ASSIGN   4652>>ASSIGN
ALERT_BUF
      4165**DCL      4642<<CALLBLT  4643--CALL
ALERT_FLG
      4154**DCL      4509<<ASSIGN   4605<<ASSIGN   4632>>IF       4651>>IF       4657>>IF
ATTEN
      4158**DCL      4589<<ASSIGN   4592<<ASSIGN   4602<<ASSIGN   4602>>ASSIGN   4650>>ASSIGN
ATTEN_BUF
      4164**DCL      4637<<CALLBLT  4643--CALL
ATTEN_FLG
      4153**DCL      4508<<ASSIGN   4588<<ASSIGN   4632>>IF       4649>>IF       4657>>IF
B$JIT.CPFLAGS1.SLEAZE
       202**DCL       202--REDEF
B$JIT.ERR.MID
       109**DCL       109--REDEF
B$JIT.JRESPEAK
       270**DCL       271--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       379**DCL       379--REDEF     380--REDEF
B$JIT.PNR
       283**DCL       283--REDEF
B$JIT.TSLINE
       377**DCL       378--REDEF
B$JIT$
      4136**DCL       103--IMP-PTR
BAG_IT
      4671**LABEL    4666--CALLALT  4667--CALLALT  4668--CALLALT
BUF1
      4166**DCL      4634<<CALLBLT  4637>>CALLBLT  4639<<CALLBLT  4642>>CALLBLT
BUF2
      4167**DCL      4636<<CALLBLT  4637>>CALLBLT  4641<<CALLBLT  4642>>CALLBLT
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:534  
CLOSE_DEVHIST
      4443**DCL      4665<>CALL     4668<>CALL
CLOSE_DEVHIST.SN_
      4443**DCL      4443--REDEF
CLOSE_DEVHIST.UTL_
      4444**DCL      4444--REDEF
CLOSE_DEVHIST.V
      4448**DCL      4443--DCLINIT
CLOSE_DEVHIST.V.EXPIRE#
      4458**DCL      4458--REDEF
CLOSE_DEVHIST.V.TYPE#
      4456**DCL      4456--REDEF
CLOSE_DEVHIST.V.XTNSIZE#
      4453**DCL      4453--REDEF    4455--REDEF
CODE
      4155**DCL      4510<<ASSIGN   4517<<ASSIGN   4519>>DOCASE   4585<>CALL
DEVHIST
      4489**DCL      4341--DCLINIT
DEVHIST_ACCT
      3707**DCL      4345--DCLINIT
DISPTHRESH
      4162**DCL      4643--CALL
F$DCB.ACTPOS
       410**DCL       410--REDEF
F$DCB.ARS
       385**DCL       385--REDEF    4661>>ASSIGN
F$DCB.ATTR
       403**DCL       404--REDEF
F$DCB.BORROW
       418**DCL       418--REDEF     418--REDEF     418--REDEF
F$DCB.DCBNAME.L
       432**DCL       432--IMP-SIZ
F$DCB.EOMCHAR
       389**DCL       389--REDEF
F$DCB.FCD
       398**DCL      4664>>IF
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:535  
F$DCB.FLDID
       413**DCL       413--REDEF
F$DCB.FORM$
       407**DCL       407--REDEF
F$DCB.FSECT
       423**DCL       423--REDEF
F$DCB.FSN
       400**DCL       400--REDEF     400--REDEF     401--REDEF
F$DCB.HEADER$
       406**DCL       406--REDEF
F$DCB.IXTNSIZE
       404**DCL       404--REDEF
F$DCB.LASTSTA$
       394**DCL       394--REDEF
F$DCB.LVL
       419**DCL       419--REDEF
F$DCB.NAME.C
       394**DCL       394--REDEF
F$DCB.NOEOF
       415**DCL       415--REDEF
F$DCB.NRECS
       405**DCL       405--REDEF
F$DCB.NRECX
       424**DCL       424--REDEF
F$DCB.OHDR
       416**DCL       416--REDEF
F$DCB.ORG
       399**DCL       399--REDEF
F$DCB.PRECNO
       422**DCL       422--REDEF
F$DCB.RCSZ
       427**DCL       427--REDEF
F$DCB.RES
       395**DCL       395--REDEF
F$DCB.SETX
       407**DCL       407--REDEF
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:536  
F$DCB.TAB$
       406**DCL       407--REDEF
F$DCB.TDA
       421**DCL       421--REDEF
F$DCB.WSN
       396**DCL       396--REDEF
I
      4151**DCL      4512<<DOINDEX  4513>>DOCASE   4515>>DOINDEX  4517>>ASSIGN   4574>>IF       4577>>ASSIGN
      4590>>ASSIGN   4593>>IF       4596>>ASSIGN   4607>>ASSIGN   4610>>IF       4613>>ASSIGN   4627<<DOINDEX
      4629>>IF
J
      4152**DCL      4515<<DOINDEX  4517>>ASSIGN   4574>>IF       4577>>ASSIGN   4628<<DOINDEX  4629>>IF
      4633>>ASSIGN   4635>>ASSIGN   4638>>ASSIGN   4640>>ASSIGN   4643>>CALL     4650>>ASSIGN   4652>>ASSIGN
LEN
      4157**DCL      4518<<ASSIGN   4522<<ASSIGN   4525<<ASSIGN   4528<<ASSIGN   4531<<ASSIGN   4534<<ASSIGN
      4537<<ASSIGN   4540<<ASSIGN   4543<<ASSIGN   4566<<ASSIGN   4569<<ASSIGN   4572<<ASSIGN   4578>>CALLBLT
      4579<<ASSIGN   4579>>ASSIGN   4583<<ASSIGN   4585<>CALL
M$CLOSE
        22**DCL-ENT  4665--CALL     4668--CALL
M$DEVHIST
      4144**DCL      4658--ASSIGN   4664--IF
M$DEVHIST$
      4147**DCL      4658<<ASSIGN   4661>>ASSIGN
M$OPEN
        22**DCL-ENT  4666--CALL
M$WRITE
        23**DCL-ENT  4667--CALL
ONE
      4148**DCL      4624<>CALL
OPEN_DEVHIST
      4340**DCL      4666<>CALL
OPEN_DEVHIST.ACSVEH_
      4342**DCL      4343--REDEF
OPEN_DEVHIST.ALTKEYS_
      4348**DCL      4349--REDEF    4349--REDEF
OPEN_DEVHIST.HDR_
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:537  
      4347**DCL      4348--REDEF
OPEN_DEVHIST.TAB_
      4346**DCL      4347--REDEF
OPEN_DEVHIST.UHL_
      4340**DCL      4341--REDEF    4341--REDEF
OPEN_DEVHIST.V
      4349**DCL      4340--DCLINIT
OPEN_DEVHIST.V.FSN#
      4380**DCL      4380--REDEF    4380--REDEF
OPEN_DEVHIST.WSN_
      4346**DCL      4346--REDEF
OUT$BLK.CODE
      4184**DCL      4513>>DOCASE   4517>>ASSIGN
OUT$BLK.NSUBLKS
      4188**DCL      4512>>DOINDEX  4515>>DOINDEX  4574>>IF       4593>>IF       4610>>IF
OUT$BLK.SUBLK$
      4209**DCL      4513>>DOCASE   4515>>DOINDEX  4517>>ASSIGN   4517>>ASSIGN   4517>>ASSIGN   4574>>IF
      4574>>IF       4577>>ASSIGN   4577>>ASSIGN   4577>>ASSIGN   4590>>ASSIGN   4590>>ASSIGN   4593>>IF
      4596>>ASSIGN   4596>>ASSIGN   4607>>ASSIGN   4607>>ASSIGN   4610>>IF       4613>>ASSIGN   4613>>ASSIGN
OUT$SYM.COUNT
      4245**DCL      4248--IMP-SIZ  4578>>CALLBLT  4578>>CALLBLT  4579>>ASSIGN   4591>>CALLBLT  4597>>IF
      4598<<ASSIGN   4599>>CALLBLT  4601>>CALLBLT  4608>>CALLBLT  4614>>IF       4615<<ASSIGN   4616>>CALLBLT
      4618>>CALLBLT
OUT$SYM.TEXT
      4248**DCL      4578>>CALLBLT  4591>>CALLBLT  4599<<CALLBLT  4601>>CALLBLT  4608>>CALLBLT  4616<<CALLBLT
      4618>>CALLBLT
RET
      4669**LABEL    4585--CALLALT
SYM$
      4150**DCL      4222--IMP-PTR  4577<<ASSIGN   4578>>CALLBLT  4578>>CALLBLT  4578>>CALLBLT  4579>>ASSIGN
      4590<<ASSIGN   4591>>CALLBLT  4591>>CALLBLT  4596<<ASSIGN   4597>>IF       4598>>ASSIGN   4599>>CALLBLT
      4599>>CALLBLT  4601>>CALLBLT  4601>>CALLBLT  4607<<ASSIGN   4608>>CALLBLT  4608>>CALLBLT  4613<<ASSIGN
      4614>>IF       4615>>ASSIGN   4616>>CALLBLT  4616>>CALLBLT  4618>>CALLBLT  4618>>CALLBLT
TEMP
      4160**DCL      4591<<CALLBLT  4592>>ASSIGN   4601<<CALLBLT  4602>>ASSIGN   4608<<CALLBLT  4609>>ASSIGN
      4618<<CALLBLT  4619>>ASSIGN   4633<<ASSIGN   4634>>CALLBLT  4635<<ASSIGN   4636>>CALLBLT  4638<<ASSIGN
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:538  
      4639>>CALLBLT  4640<<ASSIGN   4641>>CALLBLT
TEXT
      4156**DCL      4516<<ASSIGN   4521<<ASSIGN   4524<<ASSIGN   4527<<ASSIGN   4530<<ASSIGN   4533<<ASSIGN
      4536<<ASSIGN   4539<<ASSIGN   4542<<ASSIGN   4545<<ASSIGN   4547<<ASSIGN   4549<<ASSIGN   4551<<ASSIGN
      4553<<ASSIGN   4555<<ASSIGN   4557<<ASSIGN   4559<<ASSIGN   4561<<ASSIGN   4563<<ASSIGN   4565<<ASSIGN
      4568<<ASSIGN   4571<<ASSIGN   4578<<CALLBLT  4585<>CALL
TH$THRESH
      4254**DCL      4625>>ASSIGN
THG$GETREC
      4138**DCL-ENT  4624--CALL
THM$ERRMSG
      4140**DCL-ENT  4671--CALL
THRESH_KEY
      4149**DCL      4403--DCLINIT  4659--ASSIGN
THS$SET_DEVS
      4139**DCL-ENT  4585--CALL
THW$WRITE
      4141**DCL-ENT  4643--CALL
TH_CONSTRAINTS.E_BY_B
      3645**DCL      3645--REDEF
TH_CONSTRAINTS.M_BY_B
      3644**DCL      3644--REDEF
TH_CONSTRAINTS.TYPES
      3642**DCL      3642--REDEF
TH_DEFAULT.E_BY_B
      3653**DCL      3653--REDEF
TH_DEFAULT.M_BY_B
      3652**DCL      3652--REDEF
TH_DEFAULT.TYPES
      3650**DCL      3650--REDEF
TH_NUM_DEVS
      3669**DCL      4628>>DOINDEX
TH_NUM_REP_DEVS
      3667**DCL      4511<<ASSIGN   4627>>DOINDEX
TH_RECORD.PTR$
      3670**DCL      4625>>ASSIGN
PL6.E3A0      #010=THC$THRESH File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:13 Page:539  
TH_REP_DEVS
      3668**DCL      4629>>IF
TH_SAVE.E_BY_B
      3661**DCL      3661--REDEF
TH_SAVE.M_BY_B
      3659**DCL      3659--REDEF
TH_SAVE.TYPES
      3657**DCL      3658--REDEF
TH_THRESH
      4260**DCL      4625<<ASSIGN   4660--ASSIGN
TH_THRESH.ALERT
      4263**DCL      4638>>ASSIGN   4640>>ASSIGN   4652<<ASSIGN
TH_THRESH.ATTEN
      4262**DCL      4633>>ASSIGN   4635>>ASSIGN   4650<<ASSIGN
TH_THRESH.DEVNAME
      4261**DCL      4629>>IF       4643--CALL
TH_XSA_BUF_VECTOR
      3677**DCL      3677--REDEF
TOP$
        10**DCL         7--PROC     4176--IMP-PTR  4512>>DOINDEX  4513>>DOCASE   4515>>DOINDEX  4517>>ASSIGN
      4574>>IF       4577>>ASSIGN   4590>>ASSIGN   4593>>IF       4596>>ASSIGN   4607>>ASSIGN   4610>>IF
      4613>>ASSIGN
WRITE_DEVHIST
      4403**DCL      4667<>CALL
WRITE_DEVHIST.BUF_
      4403**DCL      4660<<ASSIGN
WRITE_DEVHIST.BUF_.BOUND
      4403**DCL      4661<<ASSIGN
WRITE_DEVHIST.KEY_
      4403**DCL      4659<<ASSIGN
WRITE_DEVHIST.STATION_
      4405**DCL      4405--REDEF
WRITE_DEVHIST.V
      4406**DCL      4403--DCLINIT
WRITE_DEVHIST.V.DVBYTE.VFC#
      4412**DCL      4412--REDEF

PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:540  
     2922        1        /*M* THC$STATUS - HANDLES STATUS COMMANDS FOR ELAN */
     2923        2        /*T***********************************************************/
     2924        3        /*T*                                                         */
     2925        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2926        5        /*T*                                                         */
     2927        6        /*T***********************************************************/
     2928        7        THC$STATUS: PROC;
     2929        8        /**/
     2930        9        %INCLUDE CP_6;
     2931       90        %INCLUDE TH_DATA_R;
     2932      168        /**/
     2933      169        /* ENTRY DCLS */
     2934      170    1   DCL THW$WRITE ENTRY(11);
     2935      171    1   DCL THF$ADD_TEXTC ENTRY(3);
     2936      172    1   DCL THC$TYPENAME ENTRY(3);
     2937      173        /**/
     2938      174        /* VARS */
     2939      175    1   DCL TEXTBUF CHAR(900) STATIC INIT(' ');
     2940      176    1   DCL TEMP_BUF2 CHAR(900);
     2941      177    1   DCL BUF_COUNT UBIN;
     2942      178    1   DCL TEMP_BUF CHAR(63);
     2943      179    1   DCL TEXT$ PTR;
     2944      180    1   DCL 1 TVEC DALIGNED,
     2945      181    1         2 BOUND UBIN(20) UNAL,
     2946      182    1         2 * BIT(16) UNAL,
     2947      183    1         2 PTR$ PTR;
     2948      184    1   DCL I UBIN;
     2949      185    1   DCL COUNT UBIN;
     2950      186    1   DCL TEMPTYPE UBIN BYTE;
     2951      187    1   DCL TYPE_FMT CHAR(0) CONSTANT INIT(
     2952      188    1   'ERROR TYPES: %T%10P');
     2953      189    1   DCL TIME_FMT CHAR(0) CONSTANT INIT(
     2954      190    1   'SPAN: %14.36.2U TO %2P%14.36.2U%10P');
     2955      191    1   DCL MATCH_FMT CHAR(0) CONSTANT INIT(
     2956      192    1   'STATUS MATCH: %T%10P');
     2957      193    1   DCL EXCLUDE_FMT CHAR(0) CONSTANT INIT(
     2958      194    1   'STATUS EXCLUDE: %T%10P');
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:541  
     2959      195    1   DCL OCTAL_FMT CHAR(0) CONSTANT INIT(
     2960      196    1   'OCTAL DISPLAY%10P');
     2961      197    1   DCL CROSS_FMT CHAR(0) CONSTANT INIT(
     2962      198    1   'CROSSBAR DISPLAY%10P');
     2963      199        /**/
     2964      200        %EJECT;
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:542  
     2965      201    1        CALL THW$WRITE(VECTOR(TIME_FMT),
     2966      202    1                       VECTOR(TH_CONSTRAINTS.START),
     2967      203    1                       VECTOR(TH_CONSTRAINTS.STOP));
     2968      204    2              IF TH_CONSTRAINTS.NTYPES > 0 THEN DO;
     2969      205    2                 TEXT$ = ADDR(TEXTBUF);
     2970      206    2                 BUF_COUNT = 0;
     2971      207    3                 DO I = 0 TO TH_CONSTRAINTS.NTYPES - 1;
     2972      208    4                    IF I > 0 THEN DO;
     2973      209    4                       CALL INSERT(TEMP_BUF2,BUF_COUNT,2,', ');
     2974      210    4                       BUF_COUNT = BUF_COUNT + 2;
     2975      211    4                       END;  /* IF I > 0 */
     2976      212    3                    TEMPTYPE = TH_CONSTRAINTS.TYPES(I);
     2977      213    3                    CALL THC$TYPENAME(TEMPTYPE,TEMP_BUF,COUNT);
     2978      214    3                    CALL INSERT(TEMP_BUF2,BUF_COUNT,COUNT,SUBSTR(TEMP_BUF,0,COUNT));
     2979      215    3                    BUF_COUNT = BUF_COUNT + COUNT;
     2980      216    3                    END;  /* DO I */
     2981      217    2                 CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF2,BUF_COUNT);
     2982      218    2                 TVEC = VECTOR(TEXTBUF);
     2983      219    2                 TVEC.BOUND = BUF_COUNT;
     2984      220    2                 CALL THW$WRITE(VECTOR(TYPE_FMT),TVEC);
     2985      221    2                 END;  /* IF NTYPES > 0 */
     2986      222    1       IF TH_CONSTRAINTS.M_MAJ_S OR TH_CONSTRAINTS.M_SUB_S OR
     2987      223    1          TH_CONSTRAINTS.M_MED_S OR TH_CONSTRAINTS.M_BY_B_SET ~='0'B
     2988      224    1          OR TH_CONSTRAINTS.M_FEP_SET OR TH_CONSTRAINTS.M_CHAN_SET
     2989      225    2            THEN DO;
     2990      226    2            CALL THW$WRITE(VECTOR(MATCH_FMT),VECTOR(TH_LAST_MATCH));
     2991      227    2            END;
     2992      228    1       IF TH_CONSTRAINTS.E_MAJ_S OR TH_CONSTRAINTS.E_SUB_S OR
     2993      229    1          TH_CONSTRAINTS.E_MED_S OR TH_CONSTRAINTS.E_BY_B_SET ~='0'B
     2994      230    1          OR TH_CONSTRAINTS.E_FEP_SET OR TH_CONSTRAINTS.E_CHAN_SET
     2995      231    2            THEN DO;
     2996      232    2            CALL THW$WRITE(VECTOR(EXCLUDE_FMT),VECTOR(TH_LAST_EXCLUDE));
     2997      233    2            END;
     2998      234    2        IF TH_CONSTRAINTS.OCTAL THEN DO;
     2999      235    2           CALL THW$WRITE(VECTOR(OCTAL_FMT));
     3000      236    2           END;
     3001      237    2        IF TH_CONSTRAINTS.CROSS THEN DO;
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:543  
     3002      238    2           CALL THW$WRITE(VECTOR(CROSS_FMT));
     3003      239    2           END;
     3004      240    1   END THC$STATUS;

PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:544  
--  Include file information  --

   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$STATUS.

   Procedure THC$STATUS requires 130 words for executable code.
   Procedure THC$STATUS requires 256 words of local(AUTO) storage.

    No errors detected in file THC$COMMANDS.:E05TSI    .

PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:545  

 Object Unit name= THC$STATUS                                 File name= THC$COMMANDS.:E05TOU
 UTS= JUL 30 '97 06:15:03.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   225    341  THC$STATUS
    2  RoData even  UTS     36     44  THC$STATUS
    3   Proc  even  none   130    202  THC$STATUS
    4  RoData even  none    35     43  THC$STATUS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  THC$STATUS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      11 THW$WRITE
         yes           Std       3 THC$TYPENAME
         yes           Std       3 THF$ADD_TEXTC
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:546  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_LAST_MATCH
     TH_LAST_EXCLUDE                       TH_XSA_BUF_VECTOR                     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:547  


     2922        1        /*M* THC$STATUS - HANDLES STATUS COMMANDS FOR ELAN */
     2923        2        /*T***********************************************************/
     2924        3        /*T*                                                         */
     2925        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2926        5        /*T*                                                         */
     2927        6        /*T***********************************************************/
     2928        7        THC$STATUS: PROC;

      7  3 000000   000000 700200 xent  THC$STATUS   TSX0  ! X66_AUTO_0
         3 000001   000400 000000                    ZERO    256,0

     2929        8        /**/
     2930        9        %INCLUDE CP_6;
     2931       90        %INCLUDE TH_DATA_R;
     2932      168        /**/
     2933      169        /* ENTRY DCLS */
     2934      170    1   DCL THW$WRITE ENTRY(11);
     2935      171    1   DCL THF$ADD_TEXTC ENTRY(3);
     2936      172    1   DCL THC$TYPENAME ENTRY(3);
     2937      173        /**/
     2938      174        /* VARS */
     2939      175    1   DCL TEXTBUF CHAR(900) STATIC INIT(' ');
     2940      176    1   DCL TEMP_BUF2 CHAR(900);
     2941      177    1   DCL BUF_COUNT UBIN;
     2942      178    1   DCL TEMP_BUF CHAR(63);
     2943      179    1   DCL TEXT$ PTR;
     2944      180    1   DCL 1 TVEC DALIGNED,
     2945      181    1         2 BOUND UBIN(20) UNAL,
     2946      182    1         2 * BIT(16) UNAL,
     2947      183    1         2 PTR$ PTR;
     2948      184    1   DCL I UBIN;
     2949      185    1   DCL COUNT UBIN;
     2950      186    1   DCL TEMPTYPE UBIN BYTE;
     2951      187    1   DCL TYPE_FMT CHAR(0) CONSTANT INIT(
     2952      188    1   'ERROR TYPES: %T%10P');
     2953      189    1   DCL TIME_FMT CHAR(0) CONSTANT INIT(
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:548  
     2954      190    1   'SPAN: %14.36.2U TO %2P%14.36.2U%10P');
     2955      191    1   DCL MATCH_FMT CHAR(0) CONSTANT INIT(
     2956      192    1   'STATUS MATCH: %T%10P');
     2957      193    1   DCL EXCLUDE_FMT CHAR(0) CONSTANT INIT(
     2958      194    1   'STATUS EXCLUDE: %T%10P');
     2959      195    1   DCL OCTAL_FMT CHAR(0) CONSTANT INIT(
     2960      196    1   'OCTAL DISPLAY%10P');
     2961      197    1   DCL CROSS_FMT CHAR(0) CONSTANT INIT(
     2962      198    1   'CROSSBAR DISPLAY%10P');
     2963      199        /**/
     2964      200        %EJECT;
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:549  
     2965      201    1        CALL THW$WRITE(VECTOR(TIME_FMT),

    201  3 000002   000006 630400 4                  EPPR0   6
         3 000003   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000004   000000 701000 xent               TSX1    THW$WRITE
         3 000005   000000 011000                    NOP     0

     2966      202    1                       VECTOR(TH_CONSTRAINTS.START),
     2967      203    1                       VECTOR(TH_CONSTRAINTS.STOP));
     2968      204    2              IF TH_CONSTRAINTS.NTYPES > 0 THEN DO;

    204  3 000006   000000 235000 xsym               LDA     TH_CONSTRAINTS
         3 000007   000113 604400 3                  TMOZ    s:222

     2969      205    2                 TEXT$ = ADDR(TEXTBUF);

    205  3 000010   000011 236000 4                  LDQ     9
         3 000011   200365 756100                    STQ     TEXT$,,AUTO

     2970      206    2                 BUF_COUNT = 0;

    206  3 000012   200344 450100                    STZ     BUF_COUNT,,AUTO

     2971      207    3                 DO I = 0 TO TH_CONSTRAINTS.NTYPES - 1;

    207  3 000013   200370 450100                    STZ     I,,AUTO
         3 000014   000056 710000 3                  TRA     s:216+3

     2972      208    4                    IF I > 0 THEN DO;

    208  3 000015   200370 235100                    LDA     I,,AUTO
         3 000016   000026 600000 3                  TZE     s:212

     2973      209    4                       CALL INSERT(TEMP_BUF2,BUF_COUNT,2,', ');

    209  3 000017   200344 236100                    LDQ     BUF_COUNT,,AUTO
         3 000020   040106 100400                    MLR     fill='040'O
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:550  
         3 000021   000043 000002 2                  ADSC9   CROSS_FMT+5              cn=0,n=2
         3 000022   200003 000002                    ADSC9   TEMP_BUF2,Q,AUTO         cn=0,n=2

     2974      210    4                       BUF_COUNT = BUF_COUNT + 2;

    210  3 000023   200344 236100                    LDQ     BUF_COUNT,,AUTO
         3 000024   000002 036007                    ADLQ    2,DL
         3 000025   200344 756100                    STQ     BUF_COUNT,,AUTO

     2975      211    4                       END;  /* IF I > 0 */

     2976      212    3                    TEMPTYPE = TH_CONSTRAINTS.TYPES(I);

    212  3 000026   000100 100405                    MLR     fill='000'O
         3 000027   000001 000001 xsym               ADSC9   TH_CONSTRAINTS+1,A       cn=0,n=1
         3 000030   200372 000001                    ADSC9   TEMPTYPE,,AUTO           cn=0,n=1

     2977      213    3                    CALL THC$TYPENAME(TEMPTYPE,TEMP_BUF,COUNT);

    213  3 000031   200371 630500                    EPPR0   COUNT,,AUTO
         3 000032   200376 450500                    STP0    TEMPTYPE+4,,AUTO
         3 000033   200345 631500                    EPPR1   TEMP_BUF,,AUTO
         3 000034   200375 451500                    STP1    TEMPTYPE+3,,AUTO
         3 000035   200372 633500                    EPPR3   TEMPTYPE,,AUTO
         3 000036   200374 453500                    STP3    TEMPTYPE+2,,AUTO
         3 000037   200374 630500                    EPPR0   TEMPTYPE+2,,AUTO
         3 000040   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000041   000000 701000 xent               TSX1    THC$TYPENAME
         3 000042   000000 011000                    NOP     0

     2978      214    3                    CALL INSERT(TEMP_BUF2,BUF_COUNT,COUNT,SUBSTR(TEMP_BUF,0,COUNT));

    214  3 000043   200371 720100                    LXL0    COUNT,,AUTO
         3 000044   200344 235100                    LDA     BUF_COUNT,,AUTO
         3 000045   040145 100540                    MLR     fill='040'O
         3 000046   200345 000010                    ADSC9   TEMP_BUF,,AUTO           cn=0,n=*X0
         3 000047   200003 000010                    ADSC9   TEMP_BUF2,A,AUTO         cn=0,n=*X0
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:551  

     2979      215    3                    BUF_COUNT = BUF_COUNT + COUNT;

    215  3 000050   200344 236100                    LDQ     BUF_COUNT,,AUTO
         3 000051   200371 036100                    ADLQ    COUNT,,AUTO
         3 000052   200344 756100                    STQ     BUF_COUNT,,AUTO

     2980      216    3                    END;  /* DO I */

    216  3 000053   200370 235100                    LDA     I,,AUTO
         3 000054   000001 035007                    ADLA    1,DL
         3 000055   200370 755100                    STA     I,,AUTO
         3 000056   200370 236100                    LDQ     I,,AUTO
         3 000057   000062 604000 3                  TMI     s:217
         3 000060   000000 116000 xsym               CMPQ    TH_CONSTRAINTS
         3 000061   000015 604000 3                  TMI     s:208

     2981      217    2                 CALL THF$ADD_TEXTC(TEXT$,TEMP_BUF2,BUF_COUNT);

    217  3 000062   200344 630500                    EPPR0   BUF_COUNT,,AUTO
         3 000063   200376 450500                    STP0    TEMPTYPE+4,,AUTO
         3 000064   200003 631500                    EPPR1   TEMP_BUF2,,AUTO
         3 000065   200375 451500                    STP1    TEMPTYPE+3,,AUTO
         3 000066   200365 633500                    EPPR3   TEXT$,,AUTO
         3 000067   200374 453500                    STP3    TEMPTYPE+2,,AUTO
         3 000070   200374 630500                    EPPR0   TEMPTYPE+2,,AUTO
         3 000071   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000072   000000 701000 xent               TSX1    THF$ADD_TEXTC
         3 000073   000000 011000                    NOP     0

     2982      218    2                 TVEC = VECTOR(TEXTBUF);

    218  3 000074   000012 237000 4                  LDAQ    10
         3 000075   200366 757100                    STAQ    TVEC,,AUTO

     2983      219    2                 TVEC.BOUND = BUF_COUNT;

PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:552  
    219  3 000076   200344 236100                    LDQ     BUF_COUNT,,AUTO
         3 000077   000020 736000                    QLS     16
         3 000100   200366 676100                    ERQ     TVEC,,AUTO
         3 000101   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000102   200366 656100                    ERSQ    TVEC,,AUTO

     2984      220    2                 CALL THW$WRITE(VECTOR(TYPE_FMT),TVEC);

    220  3 000103   200366 630500                    EPPR0   TVEC,,AUTO
         3 000104   200375 450500                    STP0    TEMPTYPE+3,,AUTO
         3 000105   000016 236000 4                  LDQ     14
         3 000106   200374 756100                    STQ     TEMPTYPE+2,,AUTO
         3 000107   200374 630500                    EPPR0   TEMPTYPE+2,,AUTO
         3 000110   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000111   000000 701000 xent               TSX1    THW$WRITE
         3 000112   000000 011000                    NOP     0

     2985      221    2                 END;  /* IF NTYPES > 0 */

     2986      222    1       IF TH_CONSTRAINTS.M_MAJ_S OR TH_CONSTRAINTS.M_SUB_S OR

    222  3 000113   000014 236000 xsym               LDQ     TH_CONSTRAINTS+12
         3 000114   004000 316003                    CANQ    2048,DU
         3 000115   000133 601000 3                  TNZ     s:226
         3 000116   000020 316003                    CANQ    16,DU
         3 000117   000133 601000 3                  TNZ     s:226
         3 000120   000016 234000 xsym               SZN     TH_CONSTRAINTS+14
         3 000121   000133 604000 3                  TMI     s:226
         3 000122   000000 066400                    CMPB    filb='0'B
         3 000123   000026 010440 xsym               BDSC    TH_CONSTRAINTS+22        by=0,bit=1,n=288
         3 000124   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000125   000133 601000 3                  TNZ     s:226
         3 000126   000061 234000 xsym               SZN     TH_CONSTRAINTS+49
         3 000127   000133 604000 3                  TMI     s:226
         3 000130   000062 236000 xsym               LDQ     TH_CONSTRAINTS+50
         3 000131   400000 316007                    CANQ    -131072,DL
         3 000132   000137 600000 3                  TZE     s:228
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:553  

     2987      223    1          TH_CONSTRAINTS.M_MED_S OR TH_CONSTRAINTS.M_BY_B_SET ~='0'B
     2988      224    1          OR TH_CONSTRAINTS.M_FEP_SET OR TH_CONSTRAINTS.M_CHAN_SET
     2989      225    2            THEN DO;

     2990      226    2            CALL THW$WRITE(VECTOR(MATCH_FMT),VECTOR(TH_LAST_MATCH));

    226  3 000133   000024 630400 4                  EPPR0   20
         3 000134   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000135   000000 701000 xent               TSX1    THW$WRITE
         3 000136   000000 011000                    NOP     0

     2991      227    2            END;

     2992      228    1       IF TH_CONSTRAINTS.E_MAJ_S OR TH_CONSTRAINTS.E_SUB_S OR

    228  3 000137   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         3 000140   002000 316003                    CANQ    1024,DU
         3 000141   000157 601000 3                  TNZ     s:232
         3 000142   000010 316003                    CANQ    8,DU
         3 000143   000157 601000 3                  TNZ     s:232
         3 000144   000040 234000 xsym               SZN     TH_CONSTRAINTS+32
         3 000145   000157 604000 3                  TMI     s:232
         3 000146   000000 066400                    CMPB    filb='0'B
         3 000147   000050 010440 xsym               BDSC    TH_CONSTRAINTS+40        by=0,bit=1,n=288
         3 000150   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000151   000157 601000 3                  TNZ     s:232
         3 000152   000063 236000 xsym               LDQ     TH_CONSTRAINTS+51
         3 000153   400000 316007                    CANQ    -131072,DL
         3 000154   000157 601000 3                  TNZ     s:232
         3 000155   000065 234000 xsym               SZN     TH_CONSTRAINTS+53
         3 000156   000163 605000 3                  TPL     s:234

     2993      229    1          TH_CONSTRAINTS.E_MED_S OR TH_CONSTRAINTS.E_BY_B_SET ~='0'B
     2994      230    1          OR TH_CONSTRAINTS.E_FEP_SET OR TH_CONSTRAINTS.E_CHAN_SET
     2995      231    2            THEN DO;

PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:554  
     2996      232    2            CALL THW$WRITE(VECTOR(EXCLUDE_FMT),VECTOR(TH_LAST_EXCLUDE));

    232  3 000157   000032 630400 4                  EPPR0   26
         3 000160   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000161   000000 701000 xent               TSX1    THW$WRITE
         3 000162   000000 011000                    NOP     0

     2997      233    2            END;

     2998      234    2        IF TH_CONSTRAINTS.OCTAL THEN DO;

    234  3 000163   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         3 000164   002000 316007                    CANQ    1024,DL
         3 000165   000172 600000 3                  TZE     s:237

     2999      235    2           CALL THW$WRITE(VECTOR(OCTAL_FMT));

    235  3 000166   000036 630400 4                  EPPR0   30
         3 000167   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000170   000000 701000 xent               TSX1    THW$WRITE
         3 000171   000000 011000                    NOP     0

     3000      236    2           END;

     3001      237    2        IF TH_CONSTRAINTS.CROSS THEN DO;

    237  3 000172   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         3 000173   001000 316007                    CANQ    512,DL
         3 000174   000201 600000 3                  TZE     s:240

     3002      238    2           CALL THW$WRITE(VECTOR(CROSS_FMT));

    238  3 000175   000042 630400 4                  EPPR0   34
         3 000176   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000177   000000 701000 xent               TSX1    THW$WRITE
         3 000200   000000 011000                    NOP     0

PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:555  
     3003      239    2           END;

     3004      240    1   END THC$STATUS;

    240  3 000201   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:556  
--  Include file information  --

   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THC$STATUS.
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:557  

 **** Variables and constants ****

  ****  Section 001  Data  THC$STATUS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(900)   r     1 TEXTBUF

  ****  Section 002 RoData THC$STATUS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/c CHAR(20)    r     1 CROSS_FMT                 23-0-0/c CHAR(22)    r     1 EXCLUDE_FMT
    16-0-0/c CHAR(20)    r     1 MATCH_FMT                 31-0-0/c CHAR(17)    r     1 OCTAL_FMT
     5-0-0/c CHAR(35)    r     1 TIME_FMT                   0-0-0/c CHAR(19)    r     1 TYPE_FMT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   344-0-0/w UBIN        r     1 BUF_COUNT                371-0-0/w UBIN        r     1 COUNT
   370-0-0/w UBIN        r     1 I                        372-0-0/w UBIN(9)     r     1 TEMPTYPE
   345-0-0/c CHAR(63)    r     1 TEMP_BUF                   3-0-0/c CHAR(900)   r     1 TEMP_BUF2
   365-0-0/w PTR         r     1 TEXT$                    366-0-0/d STRC(72)    r     1 TVEC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS             0-0-0/w STRC(1080)  r     1 TH_LAST_EXCLUDE
     0-0-0/w STRC(1080)  r     1 TH_LAST_MATCH

PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:558  

   Procedure THC$STATUS requires 130 words for executable code.
   Procedure THC$STATUS requires 256 words of local(AUTO) storage.

    No errors detected in file THC$COMMANDS.:E05TSI    .
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:559  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:560  
          MINI XREF LISTING

BUF_COUNT
       177**DCL       206<<ASSIGN    209>>CALLBLT   210<<ASSIGN    210>>ASSIGN    214>>CALLBLT   215<<ASSIGN
       215>>ASSIGN    217<>CALL      219>>ASSIGN
COUNT
       185**DCL       213<>CALL      214>>CALLBLT   214>>CALLBLT   215>>ASSIGN
CROSS_FMT
       197**DCL       238--CALL
EXCLUDE_FMT
       193**DCL       232--CALL
I
       184**DCL       207<<DOINDEX   208>>IF        212>>ASSIGN
MATCH_FMT
       191**DCL       226--CALL
OCTAL_FMT
       195**DCL       235--CALL
TEMPTYPE
       186**DCL       212<<ASSIGN    213<>CALL
TEMP_BUF
       178**DCL       213<>CALL      214>>CALLBLT
TEMP_BUF2
       176**DCL       209<<CALLBLT   214<<CALLBLT   217<>CALL
TEXT$
       179**DCL       205<<ASSIGN    217<>CALL
TEXTBUF
       175**DCL       205--ASSIGN    218--ASSIGN
THC$TYPENAME
       172**DCL-ENT   213--CALL
THF$ADD_TEXTC
       171**DCL-ENT   217--CALL
THW$WRITE
       170**DCL-ENT   201--CALL      220--CALL      226--CALL      232--CALL      235--CALL      238--CALL
TH_CONSTRAINTS.CROSS
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:561  
       105**DCL       237>>IF
TH_CONSTRAINTS.E_BY_B
       101**DCL       101--REDEF
TH_CONSTRAINTS.E_BY_B_SET
       102**DCL       228>>IF
TH_CONSTRAINTS.E_CHAN_SET
       103**DCL       228>>IF
TH_CONSTRAINTS.E_FEP_SET
       103**DCL       228>>IF
TH_CONSTRAINTS.E_MAJ_S
       101**DCL       228>>IF
TH_CONSTRAINTS.E_MED_S
       101**DCL       228>>IF
TH_CONSTRAINTS.E_SUB_S
       101**DCL       228>>IF
TH_CONSTRAINTS.M_BY_B
       100**DCL       100--REDEF
TH_CONSTRAINTS.M_BY_B_SET
       100**DCL       222>>IF
TH_CONSTRAINTS.M_CHAN_SET
       102**DCL       222>>IF
TH_CONSTRAINTS.M_FEP_SET
       102**DCL       222>>IF
TH_CONSTRAINTS.M_MAJ_S
        99**DCL       222>>IF
TH_CONSTRAINTS.M_MED_S
       100**DCL       222>>IF
TH_CONSTRAINTS.M_SUB_S
        99**DCL       222>>IF
TH_CONSTRAINTS.NTYPES
        98**DCL       204>>IF        207>>DOINDEX
TH_CONSTRAINTS.OCTAL
       105**DCL       234>>IF
TH_CONSTRAINTS.START
        99**DCL       201--CALL
TH_CONSTRAINTS.STOP
PL6.E3A0      #011=THC$STATUS File=THC$COMMANDS.:E05TSI                          WED 07/30/97 06:15 Page:562  
        99**DCL       201--CALL
TH_CONSTRAINTS.TYPES
        98**DCL        98--REDEF     212>>ASSIGN
TH_DEFAULT.E_BY_B
       109**DCL       109--REDEF
TH_DEFAULT.M_BY_B
       108**DCL       108--REDEF
TH_DEFAULT.TYPES
       106**DCL       106--REDEF
TH_LAST_EXCLUDE
       131**DCL       232--CALL
TH_LAST_MATCH
       130**DCL       226--CALL
TH_SAVE.E_BY_B
       117**DCL       117--REDEF
TH_SAVE.M_BY_B
       115**DCL       115--REDEF
TH_SAVE.TYPES
       113**DCL       114--REDEF
TH_XSA_BUF_VECTOR
       133**DCL       133--REDEF
TIME_FMT
       189**DCL       201--CALL
TVEC
       180**DCL       218<<ASSIGN    220<>CALL
TVEC.BOUND
       181**DCL       219<<ASSIGN
TYPE_FMT
       187**DCL       220--CALL
