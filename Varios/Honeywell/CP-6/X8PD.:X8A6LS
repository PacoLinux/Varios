VERSION A06

PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:1    
        1        1        /*M*  X8PD$PICTURE_DEEDIT -- Picture clause de-editor               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        X8PD$PICTURE_DEEDIT: PROC( SEND_DATA, REC_FLD, DSC, CURRENCY_SIGN );
        8        8
        9        9        /*P*
       10       10
       11       11               NAME: X8PD$PICTURE_DEEDIT
       12       12            PURPOSE: X8PD$PICTURE_DEEDIT DE-EDITS THE SENDING FEILD AND CALLS X9MV
       13       13                     WHICH PERFORMS THE NUMERIC MOVE TO THE RECEVING FEILD.
       14       14
       15       15        */
       16       16            %INCLUDE X8A_LIBCOM;
       17      236            %INCLUDE X8A_ERRCOM;
       18      325
       19      326    1       DCL X9MV                 ENTRY(4) ALTRET;
       20      327    1       DCL X8ER$ERROR           ENTRY(3);
       21      328    1       DCL ERR_ARROW      CHAR(80);
       22      329    1       DCL REC_FLD        CHAR(63);
       23      330    1       DCL SEND_DATA      CHAR(63) ;
       24      331    1       DCL CURRENCY_SIGN  CHAR(1) ALIGNED;
       25      332    1       DCL 1 DSC          ALIGNED,
       26      333    1             2 SEND_DSC      UBIN(36) UNAL,
       27      334    1             2 *             UBIN(24) UNAL,
       28      335    1             2 EDIT_LEN      UBIN(12) UNAL,
       29      336    1             2 REC_DSC       UBIN(36) UNAL,
       30      337    1             2 DSC2          REDEF REC_DSC,
       31      338    1               3 REC_PTR_NO  UBIN(3) UNAL,
       32      339    1               3 *           UBIN(18) UNAL,
       33      340    1               3 REC_TYPE    UBIN(1)  UNAL,
       34      341    1               3 REC_STYPE   UBIN(2)  UNAL,
       35      342    1               3 REC_SF      SBIN(6)  UNAL,
       36      343    1               3 REC_LEN     UBIN(6)  UNAL;
       37      344    1       DCL DSC1_TEMP         UBIN(36);
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:2    
       38      345    1       DCL 1 DSC1           REDEF DSC1_TEMP,
       39      346    1             2 SEND_PTR_NO  UBIN(3)  UNAL,
       40      347    1             2 *            UBIN(18) UNAL,
       41      348    1             2 SEND_TYPE    UBIN(1)  UNAL,
       42      349    1             2 SEND_STYPE   UBIN(2)  UNAL,
       43      350    1             2 SEND_SF      SBIN(6)  UNAL,
       44      351    1             2 SEND_LEN     UBIN(6)  UNAL;
       45      352    1       DCL TEMP             CHAR(80);
       46      353    1       DCL TEMP_NDX         UBIN WORD ;
       47      354    1       DCL EDIT_NDX         UBIN WORD ;
       48      355    1       DCL TEMP_SIGN        CHAR(1);
       49      356    1       DCL DIGIT            CHAR(1);
       50      357            %EJECT;
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:3    
       51      358    1       EDIT_NDX = 0;
       52      359    1       TEMP_NDX = 0;
       53      360    1       TEMP_SIGN = %BLANC;
       54      361
       55      362        /*
       56      363                      DE-EDITING THE SENDING FIELD
       57      364               THE SENFDING FIELD IS SCANNED ONE CHARACTER AT A TIME --
       58      365               MOVING THE NUMERIC ITEMS(DIGITS AND SIGN) TO A TEMP WHILE
       59      366               SKIPPING THE EDIT CHARATERS.  IF A FIELD CONTAINS A SIGN (+,-,CR,DB),
       60      367               IT IS PASSED AS TRAILING SIGN -- OTHERWISE AS NO SIGN.
       61      368
       62      369        */
       63      370    2       DO WHILE (EDIT_NDX <= DSC.EDIT_LEN - 1);
       64      371    2         DIGIT = SUBSTR ( SEND_DATA, EDIT_NDX , 1 ) ;
       65      372    2         EDIT_NDX = EDIT_NDX + 1 ;
       66      373    2         IF DIGIT ~= CURRENCY_SIGN THEN  /*  currency sign is skipped */
       67      374    3           DO CASE ( ASCBIN ( DIGIT ) );
       68      375    3             CASE (%BIN_COMMA, %BIN_$, %BIN_DECIMAL, %BIN_SLASH,
       69      376    3                    %BIN_ASTK, %BIN_BLANK);
       70      377
       71      378    3             CASE (%C);
       72      379    3               IF SUBSTR ( SEND_DATA, EDIT_NDX, 1 ) = 'R' THEN
       73      380    4                 DO;
       74      381    4                   TEMP_SIGN = %MINUS_SIGN;
       75      382    4                   EDIT_NDX = EDIT_NDX + 1;
       76      383    4                 END;
       77      384    3               ELSE
       78      385    4                 DO;
       79      386    4                   CALL ERROR;
       80      387    4                   RETURN;
       81      388    4                 END;
       82      389
       83      390    3             CASE(%D);
       84      391    3               IF SUBSTR ( SEND_DATA, EDIT_NDX, 1 ) = 'B' THEN
       85      392    4                 DO;
       86      393    4                   TEMP_SIGN = %MINUS_SIGN;
       87      394    4                   EDIT_NDX = EDIT_NDX + 1;
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:4    
       88      395    4                 END;
       89      396    3               ELSE
       90      397    4                 DO;
       91      398    4                   CALL ERROR;
       92      399    4                   RETURN;
       93      400    4                 END;
       94      401
       95      402    3             CASE(%BIN_PLUS);
       96      403    3               TEMP_SIGN = %PLUS_SIGN;
       97      404
       98      405    3             CASE(%BIN_NEG);
       99      406    3               TEMP_SIGN = %MINUS_SIGN;
      100      407
      101      408    3             CASE(%BIN_0, %BIN_1, %BIN_2, %BIN_3, %BIN_4, %BIN_5,
      102      409    3                  %BIN_6, %BIN_7, %BIN_8, %BIN_9);
      103      410    3               SUBSTR(TEMP, TEMP_NDX, 1) = SUBSTR(SEND_DATA, EDIT_NDX - 1, 1);
      104      411    3               TEMP_NDX = TEMP_NDX + 1 ;
      105      412
      106      413    3             CASE(ELSE);
      107      414    3               CALL ERROR;
      108      415    3               RETURN;
      109      416    3           END;  /* CASE */
      110      417    2       END;  /* WHILE */
      111      418
      112      419    1       DSC1_TEMP = DSC.SEND_DSC;
      113      420
      114      421    1        IF TEMP_SIGN = %BLANC THEN
      115      422    1            DSC1.SEND_STYPE = 3;      /* NO SIGN */
      116      423    1        ELSE
      117      424    2          DO;
      118      425    2            DSC1.SEND_STYPE = 2;         /* TRAILING SIGN */
      119      426    2            SUBSTR(TEMP, TEMP_NDX, 1) = TEMP_SIGN;
      120      427    2            TEMP_NDX = TEMP_NDX + 1;
      121      428    2          END;
      122      429
      123      430    1       DSC1.SEND_LEN = TEMP_NDX;
      124      431    1       CALL X9MV( DSC1, DSC.DSC2, ADDR(REC_FLD), ADDR(TEMP))
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:5    
      125      432    1       WHENALTRETURN
      126      433    2         DO;
      127      434    2           CALL X8ER$ERROR( %OVERFLOW_TRUNCATION );
      128      435    2         END;
      129      436
      130      437    1     ERROR: PROC;
      131      438
      132      439    2       TEMP = SUBSTR (SEND_DATA,0,EDIT_NDX);
      133      440    2       CALL X8ER$ERROR ( %SPECIAL_MSG, TEMP );
      134      441    2       ERR_ARROW = ' ';
      135      442    2       SUBSTR ( ERR_ARROW, EDIT_NDX - 1,1 ) = '^' ;
      136      443    2       CALL X8ER$ERROR (%SPECIAL_MSG, ERR_ARROW );
      137      444    2       CALL X8ER$ERROR ( %ILLEGAL_CHAR );
      138      445    2     END ERROR; /* proc */
      139      446
      140      447    1   END X8PD$PICTURE_DEEDIT;   /* proc */
      141      448        %EJECT;
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:6    

PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:7    
--  Include file information  --

   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure X8PD$PICTURE_DEEDIT.

   Procedure X8PD$PICTURE_DEEDIT requires 188 words for executable code.
   Procedure X8PD$PICTURE_DEEDIT requires 118 words of local(AUTO) storage.

    No errors detected in file X8PD.:X8A6TSI    .

PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:8    

 Object Unit name= X8PD$PICTURE_DEEDIT                        File name= X8PD.:X8A6TOU
 UTS= AUG 09 '97 10:50:35.96 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none    20     24  LIBCOM
    1  LblCom even  none     1      1  DEC_OR_COMMA
    2  LblCom even  none    20     24  IN_TEMP
    3  LblCom even  none     1      1  OVRCHR
    4  LblCom even  none     1      1  SELECT_TIME
    5  LblCom even  none     1      1  NO_ADVANCE_OFFSET
    6  LblCom even  none    18     22  DSPLY_SAVE
    7  LblCom even  none     3      3  D_DATE
    8  LblCom even  none     3      3  D_TIME
    9  LblCom even  none     1      1  D_DAY
   10  LblCom even  none     2      2  C_DATE
   11  LblCom even  none     2      2  C_TIME
   12  LblCom even  none     2      2  C_DAY
   13  LblCom even  none     1      1  RTHOLD2
   14  LblCom even  none     1      1  LTHOLD2
   15  LblCom even  none     1      1  NDX2
   16  LblCom even  none     1      1  IN_LEN
   17   Proc  even  none   188    274  X8PD$PICTURE_DEEDIT
   18  RoData even  none    14     16  X8PD$PICTURE_DEEDIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    17      0   yes            yes      Std        4  X8PD$PICTURE_DEEDIT
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:9    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 X9MV
         yes           Std       3 X8ER$ERROR
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:10   


        1        1        /*M*  X8PD$PICTURE_DEEDIT -- Picture clause de-editor               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        X8PD$PICTURE_DEEDIT: PROC( SEND_DATA, REC_FLD, DSC, CURRENCY_SIGN );

      7 17 000000   000000 700200 xent  X8PD$PICTUR* TSX0  ! X66_AUTO_4
        17 000001   000166 000004                    ZERO    118,4

        8        8
        9        9        /*P*
       10       10
       11       11               NAME: X8PD$PICTURE_DEEDIT
       12       12            PURPOSE: X8PD$PICTURE_DEEDIT DE-EDITS THE SENDING FEILD AND CALLS X9MV
       13       13                     WHICH PERFORMS THE NUMERIC MOVE TO THE RECEVING FEILD.
       14       14
       15       15        */
       16       16            %INCLUDE X8A_LIBCOM;
       17      236            %INCLUDE X8A_ERRCOM;
       18      325
       19      326    1       DCL X9MV                 ENTRY(4) ALTRET;
       20      327    1       DCL X8ER$ERROR           ENTRY(3);
       21      328    1       DCL ERR_ARROW      CHAR(80);
       22      329    1       DCL REC_FLD        CHAR(63);
       23      330    1       DCL SEND_DATA      CHAR(63) ;
       24      331    1       DCL CURRENCY_SIGN  CHAR(1) ALIGNED;
       25      332    1       DCL 1 DSC          ALIGNED,
       26      333    1             2 SEND_DSC      UBIN(36) UNAL,
       27      334    1             2 *             UBIN(24) UNAL,
       28      335    1             2 EDIT_LEN      UBIN(12) UNAL,
       29      336    1             2 REC_DSC       UBIN(36) UNAL,
       30      337    1             2 DSC2          REDEF REC_DSC,
       31      338    1               3 REC_PTR_NO  UBIN(3) UNAL,
       32      339    1               3 *           UBIN(18) UNAL,
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:11   
       33      340    1               3 REC_TYPE    UBIN(1)  UNAL,
       34      341    1               3 REC_STYPE   UBIN(2)  UNAL,
       35      342    1               3 REC_SF      SBIN(6)  UNAL,
       36      343    1               3 REC_LEN     UBIN(6)  UNAL;
       37      344    1       DCL DSC1_TEMP         UBIN(36);
       38      345    1       DCL 1 DSC1           REDEF DSC1_TEMP,
       39      346    1             2 SEND_PTR_NO  UBIN(3)  UNAL,
       40      347    1             2 *            UBIN(18) UNAL,
       41      348    1             2 SEND_TYPE    UBIN(1)  UNAL,
       42      349    1             2 SEND_STYPE   UBIN(2)  UNAL,
       43      350    1             2 SEND_SF      SBIN(6)  UNAL,
       44      351    1             2 SEND_LEN     UBIN(6)  UNAL;
       45      352    1       DCL TEMP             CHAR(80);
       46      353    1       DCL TEMP_NDX         UBIN WORD ;
       47      354    1       DCL EDIT_NDX         UBIN WORD ;
       48      355    1       DCL TEMP_SIGN        CHAR(1);
       49      356    1       DCL DIGIT            CHAR(1);
       50      357            %EJECT;
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:12   
       51      358    1       EDIT_NDX = 0;

    358 17 000002   200152 450100                    STZ     EDIT_NDX,,AUTO

       52      359    1       TEMP_NDX = 0;

    359 17 000003   200151 450100                    STZ     TEMP_NDX,,AUTO

       53      360    1       TEMP_SIGN = %BLANC;

    360 17 000004   040000 236003                    LDQ     16384,DU
        17 000005   200153 756100                    STQ     TEMP_SIGN,,AUTO

       54      361
       55      362        /*
       56      363                      DE-EDITING THE SENDING FIELD
       57      364               THE SENFDING FIELD IS SCANNED ONE CHARACTER AT A TIME --
       58      365               MOVING THE NUMERIC ITEMS(DIGITS AND SIGN) TO A TEMP WHILE
       59      366               SKIPPING THE EDIT CHARATERS.  IF A FIELD CONTAINS A SIGN (+,-,CR,DB),
       60      367               IT IS PASSED AS TRAILING SIGN -- OTHERWISE AS NO SIGN.
       61      368
       62      369        */
       63      370    2       DO WHILE (EDIT_NDX <= DSC.EDIT_LEN - 1);

    370 17 000006   000146 710000 17                 TRA     s:417

       64      371    2         DIGIT = SUBSTR ( SEND_DATA, EDIT_NDX , 1 ) ;

    371 17 000007   200003 470500                    LDP0    @SEND_DATA,,AUTO
        17 000010   200152 235100                    LDA     EDIT_NDX,,AUTO
        17 000011   040100 100505                    MLR     fill='040'O
        17 000012   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        17 000013   200154 000001                    ADSC9   DIGIT,,AUTO              cn=0,n=1

       65      372    2         EDIT_NDX = EDIT_NDX + 1 ;

    372 17 000014   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:13   
        17 000015   200152 755100                    STA     EDIT_NDX,,AUTO

       66      373    2         IF DIGIT ~= CURRENCY_SIGN THEN  /*  currency sign is skipped */

    373 17 000016   200006 471500                    LDP1    @CURRENCY_SIGN,,AUTO
        17 000017   200154 236100                    LDQ     DIGIT,,AUTO
        17 000020   100000 676100                    ERQ     0,,PR1
        17 000021   777000 376003                    ANQ     -512,DU
        17 000022   000146 600000 17                 TZE     s:417

       67      374    3           DO CASE ( ASCBIN ( DIGIT ) );

    374 17 000023   200154 236100                    LDQ     DIGIT,,AUTO
        17 000024   000033 772000                    QRL     27
        17 000025   000040 136007                    SBLQ    32,DL
        17 000026   000045 116007                    CMPQ    37,DL
        17 000027   000031 602006 17                 TNC     s:374+6,QL
        17 000030   000143 710000 17                 TRA     s:414
        17 000031   000146 710000 17                 TRA     s:417
        17 000032   000143 710000 17                 TRA     s:414
        17 000033   000143 710000 17                 TRA     s:414
        17 000034   000143 710000 17                 TRA     s:414
        17 000035   000146 710000 17                 TRA     s:417
        17 000036   000143 710000 17                 TRA     s:414
        17 000037   000143 710000 17                 TRA     s:414
        17 000040   000143 710000 17                 TRA     s:414
        17 000041   000143 710000 17                 TRA     s:414
        17 000042   000143 710000 17                 TRA     s:414
        17 000043   000146 710000 17                 TRA     s:417
        17 000044   000126 710000 17                 TRA     s:403
        17 000045   000146 710000 17                 TRA     s:417
        17 000046   000131 710000 17                 TRA     s:406
        17 000047   000146 710000 17                 TRA     s:417
        17 000050   000146 710000 17                 TRA     s:417
        17 000051   000134 710000 17                 TRA     s:410
        17 000052   000134 710000 17                 TRA     s:410
        17 000053   000134 710000 17                 TRA     s:410
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:14   
        17 000054   000134 710000 17                 TRA     s:410
        17 000055   000134 710000 17                 TRA     s:410
        17 000056   000134 710000 17                 TRA     s:410
        17 000057   000134 710000 17                 TRA     s:410
        17 000060   000134 710000 17                 TRA     s:410
        17 000061   000134 710000 17                 TRA     s:410
        17 000062   000134 710000 17                 TRA     s:410
        17 000063   000143 710000 17                 TRA     s:414
        17 000064   000143 710000 17                 TRA     s:414
        17 000065   000143 710000 17                 TRA     s:414
        17 000066   000143 710000 17                 TRA     s:414
        17 000067   000143 710000 17                 TRA     s:414
        17 000070   000143 710000 17                 TRA     s:414
        17 000071   000143 710000 17                 TRA     s:414
        17 000072   000143 710000 17                 TRA     s:414
        17 000073   000143 710000 17                 TRA     s:414
        17 000074   000076 710000 17                 TRA     s:379
        17 000075   000112 710000 17                 TRA     s:391

       68      375    3             CASE (%BIN_COMMA, %BIN_$, %BIN_DECIMAL, %BIN_SLASH,

       69      376    3                    %BIN_ASTK, %BIN_BLANK);
       70      377
       71      378    3             CASE (%C);

       72      379    3               IF SUBSTR ( SEND_DATA, EDIT_NDX, 1 ) = 'R' THEN

    379 17 000076   040000 106505                    CMPC    fill='040'O
        17 000077   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        17 000100   000000 000001 18                 ADSC9   0                        cn=0,n=1
        17 000101   000107 601000 17                 TNZ     s:386

       73      380    4                 DO;

       74      381    4                   TEMP_SIGN = %MINUS_SIGN;

    381 17 000102   055000 236003                    LDQ     23040,DU
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:15   
        17 000103   200153 756100                    STQ     TEMP_SIGN,,AUTO

       75      382    4                   EDIT_NDX = EDIT_NDX + 1;

    382 17 000104   000001 035007                    ADLA    1,DL
        17 000105   200152 755100                    STA     EDIT_NDX,,AUTO

       76      383    4                 END;

    383 17 000106   000146 710000 17                 TRA     s:417

       77      384    3               ELSE
       78      385    4                 DO;

       79      386    4                   CALL ERROR;

    386 17 000107   000230 701000 17                 TSX1    ERROR
        17 000110   000000 011000                    NOP     0

       80      387    4                   RETURN;

    387 17 000111   000000 702200 xent               TSX2  ! X66_ARET

       81      388    4                 END;
       82      389
       83      390    3             CASE(%D);

       84      391    3               IF SUBSTR ( SEND_DATA, EDIT_NDX, 1 ) = 'B' THEN

    391 17 000112   040000 106505                    CMPC    fill='040'O
        17 000113   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        17 000114   000001 000001 18                 ADSC9   1                        cn=0,n=1
        17 000115   000123 601000 17                 TNZ     s:398

       85      392    4                 DO;

       86      393    4                   TEMP_SIGN = %MINUS_SIGN;
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:16   

    393 17 000116   055000 236003                    LDQ     23040,DU
        17 000117   200153 756100                    STQ     TEMP_SIGN,,AUTO

       87      394    4                   EDIT_NDX = EDIT_NDX + 1;

    394 17 000120   000001 035007                    ADLA    1,DL
        17 000121   200152 755100                    STA     EDIT_NDX,,AUTO

       88      395    4                 END;

    395 17 000122   000146 710000 17                 TRA     s:417

       89      396    3               ELSE
       90      397    4                 DO;

       91      398    4                   CALL ERROR;

    398 17 000123   000230 701000 17                 TSX1    ERROR
        17 000124   000000 011000                    NOP     0

       92      399    4                   RETURN;

    399 17 000125   000000 702200 xent               TSX2  ! X66_ARET

       93      400    4                 END;
       94      401
       95      402    3             CASE(%BIN_PLUS);

       96      403    3               TEMP_SIGN = %PLUS_SIGN;

    403 17 000126   053000 236003                    LDQ     22016,DU
        17 000127   200153 756100                    STQ     TEMP_SIGN,,AUTO
        17 000130   000146 710000 17                 TRA     s:417

       97      404
       98      405    3             CASE(%BIN_NEG);
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:17   

       99      406    3               TEMP_SIGN = %MINUS_SIGN;

    406 17 000131   055000 236003                    LDQ     23040,DU
        17 000132   200153 756100                    STQ     TEMP_SIGN,,AUTO
        17 000133   000146 710000 17                 TRA     s:417

      100      407
      101      408    3             CASE(%BIN_0, %BIN_1, %BIN_2, %BIN_3, %BIN_4, %BIN_5,

      102      409    3                  %BIN_6, %BIN_7, %BIN_8, %BIN_9);
      103      410    3               SUBSTR(TEMP, TEMP_NDX, 1) = SUBSTR(SEND_DATA, EDIT_NDX - 1, 1);

    410 17 000134   200151 236100                    LDQ     TEMP_NDX,,AUTO
        17 000135   040106 100505                    MLR     fill='040'O
        17 000136   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
        17 000137   200125 000001                    ADSC9   TEMP,Q,AUTO              cn=0,n=1

      104      411    3               TEMP_NDX = TEMP_NDX + 1 ;

    411 17 000140   000001 036007                    ADLQ    1,DL
        17 000141   200151 756100                    STQ     TEMP_NDX,,AUTO
        17 000142   000146 710000 17                 TRA     s:417

      105      412
      106      413    3             CASE(ELSE);

      107      414    3               CALL ERROR;

    414 17 000143   000230 701000 17                 TSX1    ERROR
        17 000144   000000 011000                    NOP     0

      108      415    3               RETURN;

    415 17 000145   000000 702200 xent               TSX2  ! X66_ARET

      109      416    3           END;  /* CASE */
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:18   

      110      417    2       END;  /* WHILE */

    417 17 000146   200005 470500                    LDP0    @DSC,,AUTO
        17 000147   000001 236100                    LDQ     1,,PR0
        17 000150   007777 376007                    ANQ     4095,DL
        17 000151   200152 116100                    CMPQ    EDIT_NDX,,AUTO
        17 000152   000154 600000 17                 TZE     s:419
        17 000153   000007 603000 17                 TRC     s:371

      111      418
      112      419    1       DSC1_TEMP = DSC.SEND_DSC;

    419 17 000154   000000 235100                    LDA     0,,PR0
        17 000155   200124 755100                    STA     DSC1_TEMP,,AUTO

      113      420
      114      421    1        IF TEMP_SIGN = %BLANC THEN

    421 17 000156   200153 236100                    LDQ     TEMP_SIGN,,AUTO
        17 000157   777000 376003                    ANQ     -512,DU
        17 000160   040000 116003                    CMPQ    16384,DU
        17 000161   000165 601000 17                 TNZ     s:425

      115      422    1            DSC1.SEND_STYPE = 3;      /* NO SIGN */

    422 17 000162   030000 236007                    LDQ     12288,DL
        17 000163   200124 256100                    ORSQ    DSC1_TEMP,,AUTO
        17 000164   000177 710000 17                 TRA     s:430

      116      423    1        ELSE
      117      424    2          DO;

      118      425    2            DSC1.SEND_STYPE = 2;         /* TRAILING SIGN */

    425 17 000165   200124 236100                    LDQ     DSC1_TEMP,,AUTO
        17 000166   000002 376000 18                 ANQ     2
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:19   
        17 000167   020000 276007                    ORQ     8192,DL
        17 000170   200124 756100                    STQ     DSC1_TEMP,,AUTO

      119      426    2            SUBSTR(TEMP, TEMP_NDX, 1) = TEMP_SIGN;

    426 17 000171   200151 235100                    LDA     TEMP_NDX,,AUTO
        17 000172   040105 100500                    MLR     fill='040'O
        17 000173   200153 000001                    ADSC9   TEMP_SIGN,,AUTO          cn=0,n=1
        17 000174   200125 000001                    ADSC9   TEMP,A,AUTO              cn=0,n=1

      120      427    2            TEMP_NDX = TEMP_NDX + 1;

    427 17 000175   000001 035007                    ADLA    1,DL
        17 000176   200151 755100                    STA     TEMP_NDX,,AUTO

      121      428    2          END;

      122      429
      123      430    1       DSC1.SEND_LEN = TEMP_NDX;

    430 17 000177   200151 236100                    LDQ     TEMP_NDX,,AUTO
        17 000200   200124 752101                    STCQ    DSC1_TEMP,'01'O,AUTO

      124      431    1       CALL X9MV( DSC1, DSC.DSC2, ADDR(REC_FLD), ADDR(TEMP))

    431 17 000201   200004 236100                    LDQ     @REC_FLD,,AUTO
        17 000202   200160 756100                    STQ     DIGIT+4,,AUTO
        17 000203   200125 631500                    EPPR1   TEMP,,AUTO
        17 000204   200161 451500                    STP1    DIGIT+5,,AUTO
        17 000205   200161 633500                    EPPR3   DIGIT+5,,AUTO
        17 000206   200165 453500                    STP3    DIGIT+9,,AUTO
        17 000207   200160 634500                    EPPR4   DIGIT+4,,AUTO
        17 000210   200164 454500                    STP4    DIGIT+8,,AUTO
        17 000211   200005 236100                    LDQ     @DSC,,AUTO
        17 000212   000002 036003                    ADLQ    2,DU
        17 000213   200163 756100                    STQ     DIGIT+7,,AUTO
        17 000214   200124 635500                    EPPR5   DSC1_TEMP,,AUTO
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:20   
        17 000215   200162 455500                    STP5    DIGIT+6,,AUTO
        17 000216   200162 630500                    EPPR0   DIGIT+6,,AUTO
        17 000217   000003 631400 18                 EPPR1   3
        17 000220   000000 701000 xent               TSX1    X9MV
        17 000221   000223 702000 17                 TSX2    s:434
        17 000222   000227 710000 17                 TRA     s:435

      125      432    1       WHENALTRETURN
      126      433    2         DO;

      127      434    2           CALL X8ER$ERROR( %OVERFLOW_TRUNCATION );

    434 17 000223   000006 630400 18                 EPPR0   6
        17 000224   000004 631400 18                 EPPR1   4
        17 000225   000000 701000 xent               TSX1    X8ER$ERROR
        17 000226   000000 011000                    NOP     0

      128      435    2         END;

    435 17 000227   000273 710000 17                 TRA     s:447

      129      436
      130      437    1     ERROR: PROC;

    437 17 000230   200156 741300       ERROR        STX1  ! DIGIT+2,,AUTO

      131      438
      132      439    2       TEMP = SUBSTR (SEND_DATA,0,EDIT_NDX);

    439 17 000231   200003 470500                    LDP0    @SEND_DATA,,AUTO
        17 000232   200152 720100                    LXL0    EDIT_NDX,,AUTO
        17 000233   040100 100540                    MLR     fill='040'O
        17 000234   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        17 000235   200125 000120                    ADSC9   TEMP,,AUTO               cn=0,n=80

      133      440    2       CALL X8ER$ERROR ( %SPECIAL_MSG, TEMP );

PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:21   
    440 17 000236   200125 631500                    EPPR1   TEMP,,AUTO
        17 000237   200161 451500                    STP1    DIGIT+5,,AUTO
        17 000240   000011 236000 18                 LDQ     9
        17 000241   200160 756100                    STQ     DIGIT+4,,AUTO
        17 000242   200160 630500                    EPPR0   DIGIT+4,,AUTO
        17 000243   000007 631400 18                 EPPR1   7
        17 000244   000000 701000 xent               TSX1    X8ER$ERROR
        17 000245   000000 011000                    NOP     0

      134      441    2       ERR_ARROW = ' ';

    441 17 000246   040100 100400                    MLR     fill='040'O
        17 000247   000012 000001 18                 ADSC9   10                       cn=0,n=1
        17 000250   200100 000120                    ADSC9   ERR_ARROW,,AUTO          cn=0,n=80

      135      442    2       SUBSTR ( ERR_ARROW, EDIT_NDX - 1,1 ) = '^' ;

    442 17 000251   200152 235100                    LDA     EDIT_NDX,,AUTO
        17 000252   040105 100400                    MLR     fill='040'O
        17 000253   000013 000001 18                 ADSC9   11                       cn=0,n=1
        17 000254   200077 600001                    ADSC9   SPECIAL_ERR_MSG+19,A,AUTO cn=3,n=1

      136      443    2       CALL X8ER$ERROR (%SPECIAL_MSG, ERR_ARROW );

    443 17 000255   200100 630500                    EPPR0   ERR_ARROW,,AUTO
        17 000256   200161 450500                    STP0    DIGIT+5,,AUTO
        17 000257   000011 236000 18                 LDQ     9
        17 000260   200160 756100                    STQ     DIGIT+4,,AUTO
        17 000261   200160 630500                    EPPR0   DIGIT+4,,AUTO
        17 000262   000007 631400 18                 EPPR1   7
        17 000263   000000 701000 xent               TSX1    X8ER$ERROR
        17 000264   000000 011000                    NOP     0

      137      444    2       CALL X8ER$ERROR ( %ILLEGAL_CHAR );

    444 17 000265   000015 630400 18                 EPPR0   13
        17 000266   000004 631400 18                 EPPR1   4
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:22   
        17 000267   000000 701000 xent               TSX1    X8ER$ERROR
        17 000270   000000 011000                    NOP     0

      138      445    2     END ERROR; /* proc */

    445 17 000271   200156 221300                    LDX1  ! DIGIT+2,,AUTO
        17 000272   000001 702211                    TSX2  ! 1,X1

      139      446
      140      447    1   END X8PD$PICTURE_DEEDIT;   /* proc */

    447 17 000273   000000 702200 xent               TSX2  ! X66_ARET
      141      448        %EJECT;
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:23   

PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:24   
--  Include file information  --

   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure X8PD$PICTURE_DEEDIT.
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:25   

 **** Variables and constants ****

  ****  Section 000 LblCom LIBCOM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(720)         1 LIBCOM

  ****  Section 001 LblCom DEC_OR_COMMA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 DEC_OR_COMMA

  ****  Section 002 LblCom IN_TEMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)          1 IN_TEMP

  ****  Section 003 LblCom OVRCHR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 OVRCHR

  ****  Section 004 LblCom SELECT_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 SELECT_TIME

PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:26   
  ****  Section 005 LblCom NO_ADVANCE_OFFSET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 NO_ADVANCE_OFFSET

  ****  Section 006 LblCom DSPLY_SAVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(72)          1 DSPLY_SAVE

  ****  Section 007 LblCom D_DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(10)          1 D_DATE

  ****  Section 008 LblCom D_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(11)          1 D_TIME

  ****  Section 009 LblCom D_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(3)           1 D_DAY

  ****  Section 010 LblCom C_DATE

PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:27   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)           1 C_DATE

  ****  Section 011 LblCom C_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)           1 C_TIME

  ****  Section 012 LblCom C_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(5)           1 C_DAY

  ****  Section 013 LblCom RTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 RTHOLD2

  ****  Section 014 LblCom LTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 LTHOLD2

  ****  Section 015 LblCom NDX2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=X8PD$PICTURE_DEEDIT File=X8PD.:X8A6TSI                        SAT 08/09/97 10:50 Page:28   

     0-0-0/w SBIN              1 NDX2

  ****  Section 016 LblCom IN_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 IN_LEN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @CURRENCY_SIGN             5-0-0/w PTR         r     1 @DSC
     4-0-0/w PTR         r     1 @REC_FLD                   3-0-0/w PTR         r     1 @SEND_DATA
    *0-0-0/w CHAR        r     1 CURRENCY_SIGN            154-0-0/c CHAR        r     1 DIGIT
    *0-0-0/w STRC(108)   r     1 DSC                      124-0-0/w STRC        r     1 DSC1
   124-0-0/w UBIN        r     1 DSC1_TEMP                152-0-0/w UBIN        r     1 EDIT_NDX
   100-0-0/c CHAR(80)    r     1 ERR_ARROW                  7-0-0/w SBIN              1 LT
    10-0-0/c CHAR(65)          1 LTHOLD                    52-0-0/w SBIN              1 NDX
    53-0-0/w SBIN              1 NDX3                      *0-0-0/c CHAR(63)    r     1 REC_FLD
    31-0-0/c CHAR(65)          1 RTHOLD                    *0-0-0/c CHAR(63)    r     1 SEND_DATA
    54-0-0/c CHAR(80)          1 SPECIAL_ERR_MSG          125-0-0/c CHAR(80)    r     1 TEMP
   151-0-0/w UBIN        r     1 TEMP_NDX                 153-0-0/c CHAR        r     1 TEMP_SIGN


   Procedure X8PD$PICTURE_DEEDIT requires 188 words for executable code.
   Procedure X8PD$PICTURE_DEEDIT requires 118 words of local(AUTO) storage.

    No errors detected in file X8PD.:X8A6TSI    .
