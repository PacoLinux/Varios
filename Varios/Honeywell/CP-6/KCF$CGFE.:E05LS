VERSION E05

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:1    
        1        1        /*M* KCF$CGFE Comgroup frontend management routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8
        9        9
       10       10        /*V* NAME:         KC
       11       11             PURPOSE:      To provide comgroup management
       12       12             DESCRIPTION:
       13       13
       14       14                 For a definition and functional overview of
       15       15            the comgroup feature of CP-6, refer to the *F* in
       16       16            KC_CP6_C.
       17       17
       18       18
       19       19
       20       20
       21       21
       22       22                 The functional code group KC contains various
       23       23            functions.  These are:
       24       24                      o device management         (KCD KCL KCF)
       25       25                      o user I/O interface        (KCI)
       26       26                      o AU interface              (KCA)
       27       27                      o clock routines            (KCC)
       28       28                      o COMGROUP PMMEs            (KCP)
       29       29                      o Open, close and terminal
       30       30                        connect                   (KCO)
       31       31
       32       32                 Refer also to the *V* for functional code group
       33       33            KQ.
       34       34                 The following diagram illustrates the structure
       35       35            of I/O within a comgroup, in terms of functional code groups.
       36       36
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:2    
       37       37
       38       38            USER SIDE         COMGROUP MGMT          DEVICE SIDE
       39       39             (DCBs)                                  (TERMINALs)
       40       40                          ---------------------
       41       41                          |                   |
       42       42                          |                   |
       43       43                          |                   |
       44       44                          |                   |
       45       45                          |                   |
       46       46                          | K      K        K |              K
       47       47                          | Q      Q        Q |              I
       48       48         F   F   K   N    | R      M        G |   K      K   A
       49       49         M - S - C - I -  | / --->    <---  / | - C ---> C - /     (FEP)
       50       50         F   E   I   O    | K      K        K |   D  |   F   K
       51       51                          | Q      Q        Q |      |       I
       52       52                          | W      D        P |      |       S
       53       53                          |                   |      |
       54       54                          |                   |      |
       55       55                          |                   |      |   K   N
       56       56                          |                   |      --> C - I     (LOCAL)
       57       57                          |                   |          L   O
       58       58                          |                   |
       59       59                          |                   |
       60       60                          ---------------------
       61       61        */
       62       62
       63       63        /*P* NAME:         KCF$CGFE
       64       64             PURPOSE:      To manage FEP-connected comgroup devices
       65       65             DESCRIPTION:  KCF interfaces between the FEP circular
       66       66                           queue (i.e. I/O) routines in KI, and
       67       67                           KCD.  See the individual *F* commentary. */
       68       68
       69       69        /*F* NAME:         KCF$FEIN
       70       70             PURPOSE:      To receive FEP messages on behalf of
       71       71                           comgroup terminals
       72       72             DESCRIPTION:  Called from KIA$ISCAN when a message
       73       73                           for a comgroup terminal is found in
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:3    
       74       74                           the host's FEP input circular queue.
       75       75
       76       76                           We do various things based on the
       77       77                           function code of the message. */
       78       78        KCF$FEIN: PROC (NK$LDCT,K$RWPARM) ALTRET;
       79       79
       80       80
       81       81
       82       82
       83       83
       84       84        /* INCLUDES */
       85       85        %INCLUDE JG_GHOSTS_C;
       86      175        %INCLUDE NK$LDCT;
       87      277        %INCLUDE KI$MHDR;
       88      418        %INCLUDE HF_LOCK_C;
       89      432        %INCLUDE KC_DATA_R;
       90      445        %INCLUDE KC_SUBS_C;
       91      461        %INCLUDE KC_ERRORS_C;
       92      508        %INCLUDE KI_ERRORS_C;
       93      593        %INCLUDE KC_CP6;
       94     1153        %INCLUDE KQ_MAC_C;
       95     3703        %INCLUDE KC$CP6V_C;
       96     3823        %INCLUDE UE_CP6;
       97     4514        %INCLUDE KQ_SUBS_C;
       98     4814        %INCLUDE KI_SUBS_C;
       99     4950        %INCLUDE KV$VDO;
      100     5965        %INCLUDE K_DATA_R;
      101     6676        %INCLUDE K_SUBS_C;
      102     6709        %INCLUDE NK_SUBS;
      103     6734        %INCLUDE OC$MESSHD_C;
      104     6755        %INCLUDE OC_SUBS_C;
      105     7486        %INCLUDE B_STRINGS_C;
      106     7615        %INCLUDE B$USER;
      107     7831        %INCLUDE SS_SCHED_C;
      108     8064    1   DCL SSR$RUE ENTRY(4);
      109     8065        %INCLUDE FOM_SUBS_C;
      110     8128        %INCLUDE F_MACROS_C;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:4    
      111     8139        %INCLUDE KL_MACRO_C;
      112    11491        %INCLUDE KL_AFCN_C;
      113    11592
      114    11593
      115    11594        /* Equate macros invocations */
      116    11595        %KV_VDO_E;
      117    11631        %KV_VDOVLP_E;
      118    11645        %KV_VDOMRKTYP_E;
      119    11651        %KV_DATMOD_E;
      120    11657        %KV_EVTTYP_E;
      121    11661
      122    11662
      123    11663        /* PARAMETERS */
      124    11664
      125    11665        %NK$LDCT (STCLASS="");
      126    11711        %K$RWPARM (STCLASS="",NAME=K$RWPARM);
      127    12027
      128    12028
      129    12029
      130    12030
      131    12031        /* BASED STRUCTURES */
      132    12032
      133    12033        %KI$QMHDR;
      134    12082        %KV$VDO (STCLASS="BASED(K$RWPARM.UHDR$)");
      135    12109        %KV$VDO_EVT(STCLASS="BASED(K$RWPARM.UHDR$)");
      136    12151        %KV$VDO_RQSDAT (STCLASS="BASED(K$RWPARM.UHDR$)");
      137    12199        %KV$VDO_BLKDAT (STCLASS="BASED(K$RWPARM.UHDR$)");
      138    12242        %OC$MESSHD (NAME=MESS$HD,STCLASS=BASED,DELIM=";");
      139    12256        %KL_FEPST(STCLASS="");
      140    12291        %KQ_CG (STCLASS=BASED);
      141    13030        %KQ_STA (STCLASS=BASED) ;
      142    13369
      143    13370
      144    13371
      145    13372
      146    13373        /* AUTO */
      147    13374
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:5    
      148    13375        %B$COMIO (NAME=COMIOEV,STCLASS=AUTO,PARONLY=1);
      149    13384        %K$RWPARM (NAME=OPARM);
      150    13700    1   DCL INFO UBIN WORD;
      151    13701    1   DCL RDSOUT REDEF INFO SBIN WORD;
      152    13702    1   DCL PUTERR REDEF INFO UBIN WORD;
      153    13703    1   DCL MINRD UBIN HALF ;
      154    13704    1   DCL TSTATE CHAR(4);
      155    13705    1   DCL FEX UBIN WORD;
      156    13706    1   DCL FCN REDEF FEX UBIN;
      157    13707    1   DCL OP$ PTR;
      158    13708    1   DCL ERROR BIT(36);
      159    13709
      160    13710
      161    13711
      162    13712
      163    13713        /* REFS */
      164    13714
      165    13715    1   DCL FOM$SYMBIN    ENTRY(3) ALTRET;
      166    13716    1   DCL KCD$CLDQ      ENTRY(1);
      167    13717    1   DCL KCD$DSCTRM    ENTRY(2);
      168    13718    1   DCL KCF$FERDS     ENTRY(1) ALTRET;
      169    13719    1   DCL KCF$INCMP     ENTRY(2) ALTRET;
      170    13720    1   DCL KIA$FCNO      ENTRY(3) ALTRET;
      171    13721    1   DCL KIA$MSG       ENTRY(1) ALTRET;
      172    13722    1   DCL KIS$SESSION   ENTRY(3) ALTRET;
      173    13723    1   DCL KIQ$FEABT     ENTRY(2);
      174    13724    1   DCL KQG$CANCEL    ENTRY(1) ALTRET;
      175    13725    1   DCL KQG$COMP      ENTRY(2) ALTRET;
      176    13726    1   DCL KQG$DONE      ENTRY(2) ALTRET;
      177    13727    1   DCL KQG$DONEG     ENTRY(2) ALTRET;
      178    13728    1   DCL KQG$GET       ENTRY(2) ALTRET;
      179    13729    1   DCL KQG$SETDSI    ENTRY(1) ALTRET;
      180    13730    1   DCL KQG$SGFLUSH   ENTRY(1) ALTRET;
      181    13731    1   DCL KQP$DONE      ENTRY(2) ALTRET;
      182    13732    1   DCL KQP$EVNT      ENTRY(2) ALTRET;
      183    13733    1   DCL KQP$PUT       ENTRY(2) ALTRET;
      184    13734    1   DCL KQP$TERR      ENTRY(2) ALTRET;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:6    
      185    13735    1   DCL KUB$WRITE ENTRY(3) ALTRET;
      186    13736    1   DCL KUW$WRITE     ENTRY(3) ALTRET;
      187    13737    1   DCL SSV$EVENT     ENTRY(7);
      188    13738        %K$RWPARM (NAME=KC_CRWP,STCLASS=SYMREF);
      189    14054        %JG_GHOSTS (STCLASS=SYMREF);
      190    14092    1   DCL KIA_NODAT BIT(36) SYMREF;
      191    14093    1   DCL B$USRT$ PTR SYMREF;
      192    14094
      193    14095
      194    14096
      195    14097
      196    14098        /* Constants */
      197    14099        %SUB FCG#='1303'O;
      198    14100        %SUB MID#='06'O;
      199    14101        %ERRCODE (NAME=ERR_NODAT,COD#=%E$NODAT);
      200    14105        %ERRCODE (NAME=ERR_BADMSGTYP,COD#=%E$BADMSGTYP);
      201    14109        %ERRCODE (NAME=ERR_BADSTA,COD#=%E$BADSTA);
      202    14113        %ERRCODE (NAME=ERR_QFUL,COD#=%E$QFUL);
      203    14117        /* SUBS */
      204    14118
      205    14119        %EQU_CG;
      206    14167        %EJECT;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:7    
      207    14168
      208    14169
      209    14170    2           DO CASE (KV$VDO.FNC);
      210    14171
      211    14172    2             CASE (%KV_VDO_FNC_OPNSSN_RQS);
      212    14173
      213    14174
      214    14175
      215    14176    2             CASE(%KV_VDO_FNC_EVT);       /* Control-Y         */
      216    14177    2               IF KV$VDO_EVT.TYP = %KV_EVTTYP_MNTATN
      217    14178    2               THEN
      218    14179    2                INFO=%CG_TBRK_EC#;
      219    14180    2               ELSE
      220    14181    2                INFO=%CG_TBRK_BRK#;
      221    14182    2               CALL KIA$FCNO (LDCT,%KV_VDO_FNC_MRK,K$RWPARM) ALTRET (GETOUT);
      222    14183    2               CALL KQP$EVNT (LDCT,INFO);
      223    14184    2               CALL KCF$FERDS (LDCT);
      224    14185
      225    14186
      226    14187    2             CASE(%KV_VDO_FNC_RQSSTT);     /* Escape-Q          */
      227    14188    2               OPARM = KC_CRWP;
      228    14189    2               OPARM.MSGSZ = LENGTHC(TSTATE);
      229    14190    2               OPARM.MSG$ = ADDR(TSTATE);
      230    14191    2               IF LDCT.LKFLG.ACTIVE THEN TSTATE = '*GO*';
      231    14192    2               ELSE TSTATE = 'STOP';
      232    14193    2               CALL KIA$FCNO (LDCT,%KV_VDO_FNC_STT,OPARM) ALTRET(GETOUT);
      233    14194
      234    14195
      235    14196    2             CASE(%KV_VDO_FNC_DSC_RQS);     /* Disconnect        */
      236    14197    2               CALL KCD$DSCTRM (LDCT,K$RWPARM);
      237    14198
      238    14199
      239    14200    2             CASE(%KV_VDO_FNC_DAT,%KV_VDO_FNC_PRM_RSP);       /* Read complete     */
      240    14201                                              /* Return params     */
      241    14202    2               IF LDCT.DFLG.PPND THEN GOTO GETOUT;
      242    14203    3                 DO INHIBIT;
      243    14204    3                 LDCT.DFLG.RRR=K$RWPARM.DVE.DVBYTE.RRR;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:8    
      244    14205    3                 LDCT.DFLG.PPND='1'B;
      245    14206    3                 END;
      246    14207    2               LDCT.IPFEI# = K$RWPARM.IP$->KI$QMHDR.FEI#;
      247    14208    2               LDCT.IP$ = K$RWPARM.IP$;
      248    14209    2               K$RWPARM.IP$->KI$QMHDR.OFFSET = POFFC(K$RWPARM.UHDR$,K$RWPARM.IP$);
      249    14210    2               K$RWPARM.IP$->KI$QMHDR.SIZE = K$RWPARM.UHDRSZ;
      250    14211    2               CALL KQP$PUT (LDCT,K$RWPARM) ALTRET (PUTALT);
      251    14212    2   PUTEND:     ;
      252    14213    2               LDCT.IP$ = ADDR(NIL);
      253    14214    2               IF K$RWPARM.MRKTYP~=0 THEN CALL KCF$INCMP (LDCT,K$RWPARM);
      254    14215    2               ELSE
      255    14216    3                 DO INHIBIT;
      256    14217    3   RDTAKEN:      ;
      257    14218    3                 LDCT.DFLG.PPND='0'B;
      258    14219    3                 LDCT.IP$ = ADDR(NIL);
      259    14220    3                 END;
      260    14221    2   UPTHR:      ;
      261    14222    3                 DO INHIBIT;
      262    14223    3                 RDSOUT=LDCT.RDSOUT;
      263    14224    3                 IF RDSOUT~=0 THEN RDSOUT=RDSOUT-1;
      264    14225    3                 LDCT.RDSOUT=RDSOUT;
      265    14226    3                 IF (LDCT.STA$ = ADDR(NIL)) OR (LDCT.STA$->KQ_STA.MINRD = 0)
      266    14227    3                 THEN MINRD = LDCT.CG$->KQ_CG.AUCTL.MINRD; /* CG DEFAULTS */
      267    14228    3                 ELSE MINRD = LDCT.STA$->KQ_STA.MINRD; /*STATION SPECIFIC*/
      268    14229    3                 IF RDSOUT <= MINRD
      269    14230    3                 THEN CALL KCF$FERDS (LDCT);
      270    14231    3                 END;
      271    14232    2               GOTO CSEND;
      272    14233    2   PUTALT:     ;
      273    14234    2               PUTERR = K$RWPARM.ERR;
      274    14235    2               K$RWPARM.ERR = 0;
      275    14236    3                 DO CASE (PUTERR);
      276    14237    3                   CASE (KQPE_ILTR#);
      277    14238    3                     GOTO UPTHR;
      278    14239    3                   CASE (KQPE_BADMTYP#);
      279    14240    3                     ERROR = ERR_BADMSGTYP;
      280    14241    3   SEND_ERRMRK:      ;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:9    
      281    14242    3                     IF LDCT.DFLG.RRR
      282    14243    4                     THEN DO;
      283    14244    4                       OPARM = K_RWPARM_CON;
      284    14245    4                       OPARM.MSG_ERRCODE = ERROR;
      285    14246    4                       OPARM.MRKTYP = K$RWPARM.MRKTYP;
      286    14247    4                       OPARM.MARKER = K$RWPARM.MARKER;
      287    14248    4                       CALL KIA$FCNO(LDCT,%KV_VDO_FNC_MRK,OPARM) ALTRET(PUTOUT);
      288    14249    4                       END;
      289    14250    3                     GOTO RDTAKEN;
      290    14251    3                   CASE (KQPE_NOSTA#);
      291    14252    3                     ERROR = ERR_BADSTA;
      292    14253    3                     GOTO SEND_ERRMRK;
      293    14254    3                   CASE (KQPE_QFUL#);
      294    14255    3                     ERROR = ERR_QFUL;
      295    14256                             /*E* ERROR: KCF-E$QFUL-4
      296    14257                                  MESSAGE: The comgroup is full
      297    14258                                  MESSAGE1: No additional space exists in the comgroup
      298    14259                                            to store the message being written.
      299    14260                             */
      300    14261    3                     GOTO SEND_ERRMRK;
      301    14262    3                   CASE (KQPE_DISC#,KQPE_NODATA#,ELSE);
      302    14263                          /* these error codes are presently not used 5/86 */
      303    14264    3                     GOTO PUTOUT;
      304    14265    3                   CASE (KQPE_NOMBLK#);
      305    14266    3   PUTOUT:           ;
      306    14267    4                       DO INHIBIT;
      307    14268    4                       LDCT.DFLG.PPND='0'B;
      308    14269    4                       LDCT.IP$ = ADDR(NIL);
      309    14270    4                       END;
      310    14271    3                     K$RWPARM.ERR = %K$DEFER_IO;
      311    14272    3                     ALTRETURN;
      312    14273    3                   CASE (KQPE_NOBUF#);
      313    14274    3                     K$RWPARM.ERR = %K$WAIT_READ;
      314    14275    3                     ALTRETURN;
      315    14276    3                 END;
      316    14277
      317    14278
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:10   
      318    14279    2             CASE(%KV_VDO_FNC_BLKDAT);     /* Data blocked      */
      319    14280    2               IF LDCT.DFLG.INPUT THEN CALL KCF$FERDS(LDCT);
      320    14281
      321    14282
      322    14283    2             CASE(%KV_VDO_FNC_RQSDAT);     /* Data request      */
      323    14284    2               IF LDCT.LKFLG.ACTIVE
      324    14285    3               THEN DO;
      325    14286    3                 IF NK$LDCT.TH.MAXNMBBYT > 0 AND NK$LDCT.TH.MAXNMBRCR > 0
      326    14287    4                 THEN DO;
      327    14288    4                   IF LDCT.DFLG.SYMBIONT
      328    14289    4                   THEN
      329    14290    4                    CALL FOM$SYMBIN (LDCT,K$RWPARM,FOMI_FNC_RQSDAT#);
      330    14291    5                   ELSE DO;
      331    14292    5                     OPARM=K_RWPARM_CON;
      332    14293    5                     OPARM.EOFNONE=KV$VDO_RQSDAT.EOFNO_DAT;
      333    14294    5                     OPARM.MSGTYP=K$RWPARM.MSGTYP;
      334    14295    5                     OPARM.MSGID = K$RWPARM.MSGID;
      335    14296    6                     CALL KQG$GET (LDCT,OPARM) WHENALTRETURN DO;
      336    14297    7                         DO CASE (OPARM.ERR);
      337    14298    7                           CASE (KQGE_BADMTYP#);
      338    14299    7                             ERROR = ERR_BADMSGTYP;
      339    14300                                     /*E* ERROR: KCF-E$BADMSGTYP-4
      340    14301                                          MESSAGE: The specified message type is invalid
      341    14302                                      */
      342    14303    7   SEND_ERRDAT:              ;
      343    14304    7                             LDCT.LKFLG.OBLK = '1'B;
      344    14305    7                             OPARM = K_RWPARM_CON;
      345    14306    7                             OPARM.MSG_ERRCODE = ERROR;
      346    14307    7                             OPARM.MRKTYP = K$RWPARM.MRKTYP;
      347    14308    7                             OPARM.MARKER = K$RWPARM.MARKER;
      348    14309    7                             CALL KIA$FCNO(LDCT,%KV_VDO_FNC_DAT,OPARM) ALTRET(PUTOUT);
      349    14310    7                           CASE (KQGE_NOSTA#);
      350    14311    7                             ERROR = ERR_BADSTA;
      351    14312                                     /*E* ERROR: KCF-E$BADSTA-4
      352    14313                                          MESSAGE: The specified station is illegal
      353    14314                                      */
      354    14315    7                             GOTO SEND_ERRDAT;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:11   
      355    14316    7                           CASE (KQGE_QFUL#);
      356    14317    7                             GOTO CSEND;
      357    14318    7                           CASE (KQGE_EOF#);
      358    14319    7                             LDCT.LKFLG.OBLK = '1'B;
      359    14320    7                             ERROR = ERR_NODAT;
      360    14321                                     /*E* ERROR: KCF-E$NODAT-4
      361    14322                                          MESSAGE: No data is available
      362    14323                                      MESSAGE1: No data with the requested MSGTYP or STATION
      363    14324                                                    is currently available.
      364    14325                                      */
      365    14326    7                             GOTO SEND_ERRDAT;
      366    14327    7                           CASE (ELSE);
      367    14328    7                             LDCT.LKFLG.OBLK = '1'B;
      368    14329    7                             GOTO GETOUT;
      369    14330    7                         END;
      370    14331    6                       END;
      371    14332    5                     END;
      372    14333    4                   END;
      373    14334    4                 ELSE DO;
      374    14335    4                   CALL KQG$CANCEL (LDCT) ALTRET(GETOUT);
      375    14336    4                   K$RWPARM = K_RWPARM_CON;
      376    14337    4                   LDCT.LKFLG.OBLK = '1'B;
      377    14338    4                   CALL KIA$FCNO(LDCT,%KV_VDO_FNC_BLKDAT,K$RWPARM) ALTRET(GETOUT);
      378    14339    4                   CALL KIA$FCNO(LDCT,%KV_VDO_FNC_MRK,K$RWPARM) ALTRET(GETOUT);
      379    14340    4                   END;
      380    14341    3                 END;
      381    14342
      382    14343
      383    14344    2             CASE(%KV_VDO_FNC_MRK);        /* Output complete   */
      384    14345    2               IF LDCT.DFLG.SYMBIONT
      385    14346    2               THEN
      386    14347    2                CALL FOM$SYMBIN (LDCT,K$RWPARM,FOMI_FNC_MRK#);
      387    14348    2               ELSE
      388    14349    2                IF LDCT.LKFLG.WTMRK             /* Waiting marker */
      389    14350    3                THEN DO;
      390    14351                       %LOCK (G=NK$LDCT.LOCK);
      391    14354    3                  IF (B$USRT$->B$USER.FLG(LDCT.USER)&%U_SCIO)
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:12   
      392    14355    3                  AND B$USRT$->B$USER.MISC$(LDCT.USER) = ADDR(LDCT)
      393    14356    3                  THEN
      394    14357    3                   CALL SSR$RUE (%SS_CIC,LDCT.USER);
      395    14358    3                  LDCT.LKFLG.WTMRK = '0'B;
      396    14359                       %UNLOCK (G=NK$LDCT.LOCK);
      397    14362    3                  RETURN;
      398    14363    3                  END;
      399    14364    2                ELSE
      400    14365    2                 CALL KQG$COMP (LDCT,K$RWPARM);
      401    14366
      402    14367
      403    14368
      404    14369    2             CASE(ELSE);                   /* Eh? Reboot FEP    */
      405    14370    2   BDFCN:      ;
      406    14371    2               FEX=LDCT.RLCID.NODE;
      407    14372    2               KL_FEPST.FEP = FEX;
      408    14373    2               KL_FEPST.FCN = IGA_CRASHFEP_BF;
      409    14374    2               CALL KUB$WRITE(KL_FEPST, LENGTHC(KL_FEPST), 'HLPADMIN');
      410    14375    2   GETOUT:     ;
      411    14376    2               K$RWPARM.ERR = %K$DEFER_IO;
      412    14377    2               ALTRETURN;
      413    14378    2           END;
      414    14379    1   CSEND:;
      415    14380    1         IF K$RWPARM.ERR = %K$DEFER_IO OR K$RWPARM.ERR = %K$WAIT_READ
      416    14381    1         THEN
      417    14382    1          ALTRETURN;
      418    14383    1         RETURN;
      419    14384
      420    14385        %EJECT;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:13   
      421    14386    1   END KCF$FEIN;
      422    14387
      423    14388
      424    14389        %EOD;

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:14   
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   F_MACROS_C.:E05TOU  is referenced.
   FOM_SUBS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KV$VDO.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
   UE_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KC_SUBS_C.:E05TOU  is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KI$MHDR.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$FEIN.

   Procedure KCF$FEIN requires 473 words for executable code.
   Procedure KCF$FEIN requires 62 words of local(AUTO) storage.

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:15   

 Object Unit name= KCF$FEIN                                   File name= KCF$CGFE.:E05TOU
 UTS= JUL 30 '97 00:12:27.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      9     11  KCF$FEIN
    1   Proc  even  none   473    731  KCF$FEIN
    2  RoData even  none    13     15  KCF$FEIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  KCF$FEIN
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:16   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 KIA$FCNO
 yes     yes           Std       2 KQP$EVNT
 yes     yes           Std       2 KCF$INCMP
 yes     yes           Std       2 KQG$GET
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       1 KCF$FERDS
         yes           Std       2 KCD$DSCTRM
 yes     yes           Std       2 KQP$PUT
 yes     yes           Std       1 KQG$CANCEL
 yes     yes           Std       3 FOM$SYMBIN
         yes           Std       1 HFC$LOCK
         yes           Std       4 SSR$RUE
 yes     yes           Std       2 KQG$COMP
 yes     yes           Std       3 KUB$WRITE
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    K_RWPARM_CON                          KC_CRWP                               B$USRT$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:17   


        1        1        /*M* KCF$CGFE Comgroup frontend management routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8
        9        9
       10       10        /*V* NAME:         KC
       11       11             PURPOSE:      To provide comgroup management
       12       12             DESCRIPTION:
       13       13
       14       14                 For a definition and functional overview of
       15       15            the comgroup feature of CP-6, refer to the *F* in
       16       16            KC_CP6_C.
       17       17
       18       18
       19       19
       20       20
       21       21
       22       22                 The functional code group KC contains various
       23       23            functions.  These are:
       24       24                      o device management         (KCD KCL KCF)
       25       25                      o user I/O interface        (KCI)
       26       26                      o AU interface              (KCA)
       27       27                      o clock routines            (KCC)
       28       28                      o COMGROUP PMMEs            (KCP)
       29       29                      o Open, close and terminal
       30       30                        connect                   (KCO)
       31       31
       32       32                 Refer also to the *V* for functional code group
       33       33            KQ.
       34       34                 The following diagram illustrates the structure
       35       35            of I/O within a comgroup, in terms of functional code groups.
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:18   
       36       36
       37       37
       38       38            USER SIDE         COMGROUP MGMT          DEVICE SIDE
       39       39             (DCBs)                                  (TERMINALs)
       40       40                          ---------------------
       41       41                          |                   |
       42       42                          |                   |
       43       43                          |                   |
       44       44                          |                   |
       45       45                          |                   |
       46       46                          | K      K        K |              K
       47       47                          | Q      Q        Q |              I
       48       48         F   F   K   N    | R      M        G |   K      K   A
       49       49         M - S - C - I -  | / --->    <---  / | - C ---> C - /     (FEP)
       50       50         F   E   I   O    | K      K        K |   D  |   F   K
       51       51                          | Q      Q        Q |      |       I
       52       52                          | W      D        P |      |       S
       53       53                          |                   |      |
       54       54                          |                   |      |
       55       55                          |                   |      |   K   N
       56       56                          |                   |      --> C - I     (LOCAL)
       57       57                          |                   |          L   O
       58       58                          |                   |
       59       59                          |                   |
       60       60                          ---------------------
       61       61        */
       62       62
       63       63        /*P* NAME:         KCF$CGFE
       64       64             PURPOSE:      To manage FEP-connected comgroup devices
       65       65             DESCRIPTION:  KCF interfaces between the FEP circular
       66       66                           queue (i.e. I/O) routines in KI, and
       67       67                           KCD.  See the individual *F* commentary. */
       68       68
       69       69        /*F* NAME:         KCF$FEIN
       70       70             PURPOSE:      To receive FEP messages on behalf of
       71       71                           comgroup terminals
       72       72             DESCRIPTION:  Called from KIA$ISCAN when a message
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:19   
       73       73                           for a comgroup terminal is found in
       74       74                           the host's FEP input circular queue.
       75       75
       76       76                           We do various things based on the
       77       77                           function code of the message. */
       78       78        KCF$FEIN: PROC (NK$LDCT,K$RWPARM) ALTRET;

     78  1 000000   000000 700200 xent  KCF$FEIN     TSX0  ! X66_AUTO_2
         1 000001   000076 000002                    ZERO    62,2

       79       79
       80       80
       81       81
       82       82
       83       83
       84       84        /* INCLUDES */
       85       85        %INCLUDE JG_GHOSTS_C;
       86      175        %INCLUDE NK$LDCT;
       87      277        %INCLUDE KI$MHDR;
       88      418        %INCLUDE HF_LOCK_C;
       89      432        %INCLUDE KC_DATA_R;
       90      445        %INCLUDE KC_SUBS_C;
       91      461        %INCLUDE KC_ERRORS_C;
       92      508        %INCLUDE KI_ERRORS_C;
       93      593        %INCLUDE KC_CP6;
       94     1153        %INCLUDE KQ_MAC_C;
       95     3703        %INCLUDE KC$CP6V_C;
       96     3823        %INCLUDE UE_CP6;
       97     4514        %INCLUDE KQ_SUBS_C;
       98     4814        %INCLUDE KI_SUBS_C;
       99     4950        %INCLUDE KV$VDO;
      100     5965        %INCLUDE K_DATA_R;
      101     6676        %INCLUDE K_SUBS_C;
      102     6709        %INCLUDE NK_SUBS;
      103     6734        %INCLUDE OC$MESSHD_C;
      104     6755        %INCLUDE OC_SUBS_C;
      105     7486        %INCLUDE B_STRINGS_C;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:20   
      106     7615        %INCLUDE B$USER;
      107     7831        %INCLUDE SS_SCHED_C;
      108     8064    1   DCL SSR$RUE ENTRY(4);
      109     8065        %INCLUDE FOM_SUBS_C;
      110     8128        %INCLUDE F_MACROS_C;
      111     8139        %INCLUDE KL_MACRO_C;
      112    11491        %INCLUDE KL_AFCN_C;
      113    11592
      114    11593
      115    11594        /* Equate macros invocations */
      116    11595        %KV_VDO_E;
      117    11631        %KV_VDOVLP_E;
      118    11645        %KV_VDOMRKTYP_E;
      119    11651        %KV_DATMOD_E;
      120    11657        %KV_EVTTYP_E;
      121    11661
      122    11662
      123    11663        /* PARAMETERS */
      124    11664
      125    11665        %NK$LDCT (STCLASS="");
      126    11711        %K$RWPARM (STCLASS="",NAME=K$RWPARM);
      127    12027
      128    12028
      129    12029
      130    12030
      131    12031        /* BASED STRUCTURES */
      132    12032
      133    12033        %KI$QMHDR;
      134    12082        %KV$VDO (STCLASS="BASED(K$RWPARM.UHDR$)");
      135    12109        %KV$VDO_EVT(STCLASS="BASED(K$RWPARM.UHDR$)");
      136    12151        %KV$VDO_RQSDAT (STCLASS="BASED(K$RWPARM.UHDR$)");
      137    12199        %KV$VDO_BLKDAT (STCLASS="BASED(K$RWPARM.UHDR$)");
      138    12242        %OC$MESSHD (NAME=MESS$HD,STCLASS=BASED,DELIM=";");
      139    12256        %KL_FEPST(STCLASS="");
      140    12291        %KQ_CG (STCLASS=BASED);
      141    13030        %KQ_STA (STCLASS=BASED) ;
      142    13369
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:21   
      143    13370
      144    13371
      145    13372
      146    13373        /* AUTO */
      147    13374
      148    13375        %B$COMIO (NAME=COMIOEV,STCLASS=AUTO,PARONLY=1);
      149    13384        %K$RWPARM (NAME=OPARM);
      150    13700    1   DCL INFO UBIN WORD;
      151    13701    1   DCL RDSOUT REDEF INFO SBIN WORD;
      152    13702    1   DCL PUTERR REDEF INFO UBIN WORD;
      153    13703    1   DCL MINRD UBIN HALF ;
      154    13704    1   DCL TSTATE CHAR(4);
      155    13705    1   DCL FEX UBIN WORD;
      156    13706    1   DCL FCN REDEF FEX UBIN;
      157    13707    1   DCL OP$ PTR;
      158    13708    1   DCL ERROR BIT(36);
      159    13709
      160    13710
      161    13711
      162    13712
      163    13713        /* REFS */
      164    13714
      165    13715    1   DCL FOM$SYMBIN    ENTRY(3) ALTRET;
      166    13716    1   DCL KCD$CLDQ      ENTRY(1);
      167    13717    1   DCL KCD$DSCTRM    ENTRY(2);
      168    13718    1   DCL KCF$FERDS     ENTRY(1) ALTRET;
      169    13719    1   DCL KCF$INCMP     ENTRY(2) ALTRET;
      170    13720    1   DCL KIA$FCNO      ENTRY(3) ALTRET;
      171    13721    1   DCL KIA$MSG       ENTRY(1) ALTRET;
      172    13722    1   DCL KIS$SESSION   ENTRY(3) ALTRET;
      173    13723    1   DCL KIQ$FEABT     ENTRY(2);
      174    13724    1   DCL KQG$CANCEL    ENTRY(1) ALTRET;
      175    13725    1   DCL KQG$COMP      ENTRY(2) ALTRET;
      176    13726    1   DCL KQG$DONE      ENTRY(2) ALTRET;
      177    13727    1   DCL KQG$DONEG     ENTRY(2) ALTRET;
      178    13728    1   DCL KQG$GET       ENTRY(2) ALTRET;
      179    13729    1   DCL KQG$SETDSI    ENTRY(1) ALTRET;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:22   
      180    13730    1   DCL KQG$SGFLUSH   ENTRY(1) ALTRET;
      181    13731    1   DCL KQP$DONE      ENTRY(2) ALTRET;
      182    13732    1   DCL KQP$EVNT      ENTRY(2) ALTRET;
      183    13733    1   DCL KQP$PUT       ENTRY(2) ALTRET;
      184    13734    1   DCL KQP$TERR      ENTRY(2) ALTRET;
      185    13735    1   DCL KUB$WRITE ENTRY(3) ALTRET;
      186    13736    1   DCL KUW$WRITE     ENTRY(3) ALTRET;
      187    13737    1   DCL SSV$EVENT     ENTRY(7);
      188    13738        %K$RWPARM (NAME=KC_CRWP,STCLASS=SYMREF);
      189    14054        %JG_GHOSTS (STCLASS=SYMREF);
      190    14092    1   DCL KIA_NODAT BIT(36) SYMREF;
      191    14093    1   DCL B$USRT$ PTR SYMREF;
      192    14094
      193    14095
      194    14096
      195    14097
      196    14098        /* Constants */
      197    14099        %SUB FCG#='1303'O;
      198    14100        %SUB MID#='06'O;
      199    14101        %ERRCODE (NAME=ERR_NODAT,COD#=%E$NODAT);
      200    14105        %ERRCODE (NAME=ERR_BADMSGTYP,COD#=%E$BADMSGTYP);
      201    14109        %ERRCODE (NAME=ERR_BADSTA,COD#=%E$BADSTA);
      202    14113        %ERRCODE (NAME=ERR_QFUL,COD#=%E$QFUL);
      203    14117        /* SUBS */
      204    14118
      205    14119        %EQU_CG;
      206    14167        %EJECT;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:23   
      207    14168
      208    14169
      209    14170    2           DO CASE (KV$VDO.FNC);

  14170  1 000002   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000003   000014 471500                    LDP1    12,,PR0
         1 000004   000100 101500                    MRL     fill='000'O
         1 000005   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000006   200072 000002                    ADSC9   ERROR+1,,AUTO            cn=0,n=2
         1 000007   200072 220100                    LDX0    ERROR+1,,AUTO
         1 000010   000040 100003                    CMPX0   32,DU
         1 000011   000013 602010 1                  TNC     s:14170+9,X0
         1 000012   000673 710000 1                  TRA     BDFCN
         1 000013   000673 710000 1                  TRA     BDFCN
         1 000014   000673 710000 1                  TRA     BDFCN
         1 000015   000374 710000 1                  TRA     s:14280
         1 000016   000673 710000 1                  TRA     BDFCN
         1 000017   000673 710000 1                  TRA     BDFCN
         1 000020   000154 710000 1                  TRA     s:14202
         1 000021   000673 710000 1                  TRA     BDFCN
         1 000022   000673 710000 1                  TRA     BDFCN
         1 000023   000673 710000 1                  TRA     BDFCN
         1 000024   000673 710000 1                  TRA     BDFCN
         1 000025   000147 710000 1                  TRA     s:14197
         1 000026   000673 710000 1                  TRA     BDFCN
         1 000027   000673 710000 1                  TRA     BDFCN
         1 000030   000053 710000 1                  TRA     s:14177
         1 000031   000673 710000 1                  TRA     BDFCN
         1 000032   000673 710000 1                  TRA     BDFCN
         1 000033   000721 710000 1                  TRA     CSEND
         1 000034   000673 710000 1                  TRA     BDFCN
         1 000035   000154 710000 1                  TRA     s:14202
         1 000036   000673 710000 1                  TRA     BDFCN
         1 000037   000673 710000 1                  TRA     BDFCN
         1 000040   000673 710000 1                  TRA     BDFCN
         1 000041   000405 710000 1                  TRA     s:14284
         1 000042   000673 710000 1                  TRA     BDFCN
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:24   
         1 000043   000115 710000 1                  TRA     s:14188
         1 000044   000673 710000 1                  TRA     BDFCN
         1 000045   000673 710000 1                  TRA     BDFCN
         1 000046   000673 710000 1                  TRA     BDFCN
         1 000047   000673 710000 1                  TRA     BDFCN
         1 000050   000673 710000 1                  TRA     BDFCN
         1 000051   000673 710000 1                  TRA     BDFCN
         1 000052   000575 710000 1                  TRA     s:14345

      210    14171
      211    14172    2             CASE (%KV_VDO_FNC_OPNSSN_RQS);

      212    14173
      213    14174
      214    14175
      215    14176    2             CASE(%KV_VDO_FNC_EVT);       /* Control-Y         */

      216    14177    2               IF KV$VDO_EVT.TYP = %KV_EVTTYP_MNTATN

  14177  1 000053   000014 471500                    LDP1    12,,PR0
         1 000054   000100 101500                    MRL     fill='000'O
         1 000055   100000 600001                    ADSC9   0,,PR1                   cn=3,n=1
         1 000056   200072 000004                    ADSC9   ERROR+1,,AUTO            cn=0,n=4
         1 000057   200072 236100                    LDQ     ERROR+1,,AUTO
         1 000060   000002 116007                    CMPQ    2,DL
         1 000061   000065 601000 1                  TNZ     s:14181

      217    14178    2               THEN
      218    14179    2                INFO=%CG_TBRK_EC#;

  14179  1 000062   000002 235007                    LDA     2,DL
         1 000063   200064 755100                    STA     INFO,,AUTO
         1 000064   000067 710000 1                  TRA     s:14182

      219    14180    2               ELSE
      220    14181    2                INFO=%CG_TBRK_BRK#;

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:25   
  14181  1 000065   000001 235007                    LDA     1,DL
         1 000066   200064 755100                    STA     INFO,,AUTO

      221    14182    2               CALL KIA$FCNO (LDCT,%KV_VDO_FNC_MRK,K$RWPARM) ALTRET (GETOUT);

  14182  1 000067   200004 236100                    LDQ     @K$RWPARM,,AUTO
         1 000070   200074 756100                    STQ     ERROR+3,,AUTO
         1 000071   000001 236000 2                  LDQ     1
         1 000072   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000073   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000074   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000075   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000076   000000 701000 xent               TSX1    KIA$FCNO
         1 000077   000715 702000 1                  TSX2    GETOUT

      222    14183    2               CALL KQP$EVNT (LDCT,INFO);

  14183  1 000100   200064 630500                    EPPR0   INFO,,AUTO
         1 000101   200073 450500                    STP0    ERROR+2,,AUTO
         1 000102   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000103   200072 756100                    STQ     ERROR+1,,AUTO
         1 000104   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000105   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000106   000000 701000 xent               TSX1    KQP$EVNT
         1 000107   000000 011000                    NOP     0

      223    14184    2               CALL KCF$FERDS (LDCT);

  14184  1 000110   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000111   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000112   000000 701000 xent               TSX1    KCF$FERDS
         1 000113   000000 011000                    NOP     0
         1 000114   000721 710000 1                  TRA     CSEND

      224    14185
      225    14186
      226    14187    2             CASE(%KV_VDO_FNC_RQSSTT);     /* Escape-Q          */
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:26   

      227    14188    2               OPARM = KC_CRWP;

  14188  1 000115   000100 100400                    MLR     fill='000'O
         1 000116   000000 000234 xsym               ADSC9   KC_CRWP                  cn=0,n=156
         1 000117   200014 000234                    ADSC9   OPARM,,AUTO              cn=0,n=156

      228    14189    2               OPARM.MSGSZ = LENGTHC(TSTATE);

  14189  1 000120   000004 235007                    LDA     4,DL
         1 000121   200015 755100                    STA     OPARM+1,,AUTO

      229    14190    2               OPARM.MSG$ = ADDR(TSTATE);

  14190  1 000122   200066 631500                    EPPR1   TSTATE,,AUTO
         1 000123   200014 451500                    STP1    OPARM,,AUTO

      230    14191    2               IF LDCT.LKFLG.ACTIVE THEN TSTATE = '*GO*';

  14191  1 000124   200003 473500                    LDP3    @NK$LDCT,,AUTO
         1 000125   300011 236100                    LDQ     9,,PR3
         1 000126   000040 316003                    CANQ    32,DU
         1 000127   000133 600000 1                  TZE     s:14192

  14191  1 000130   000004 236000 0                  LDQ     ERR_QFUL+1
         1 000131   200066 756100                    STQ     TSTATE,,AUTO
         1 000132   000135 710000 1                  TRA     s:14193

      231    14192    2               ELSE TSTATE = 'STOP';

  14192  1 000133   000005 236000 0                  LDQ     ERR_QFUL+2
         1 000134   200066 756100                    STQ     TSTATE,,AUTO

      232    14193    2               CALL KIA$FCNO (LDCT,%KV_VDO_FNC_STT,OPARM) ALTRET(GETOUT);

  14193  1 000135   200014 634500                    EPPR4   OPARM,,AUTO
         1 000136   200074 454500                    STP4    ERROR+3,,AUTO
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:27   
         1 000137   000003 236000 2                  LDQ     3
         1 000140   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000141   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000142   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000143   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000144   000000 701000 xent               TSX1    KIA$FCNO
         1 000145   000715 702000 1                  TSX2    GETOUT
         1 000146   000721 710000 1                  TRA     CSEND

      233    14194
      234    14195
      235    14196    2             CASE(%KV_VDO_FNC_DSC_RQS);     /* Disconnect        */

      236    14197    2               CALL KCD$DSCTRM (LDCT,K$RWPARM);

  14197  1 000147   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000150   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000151   000000 701000 xent               TSX1    KCD$DSCTRM
         1 000152   000000 011000                    NOP     0
         1 000153   000721 710000 1                  TRA     CSEND

      237    14198
      238    14199
      239    14200    2             CASE(%KV_VDO_FNC_DAT,%KV_VDO_FNC_PRM_RSP);       /* Read complete     */

      240    14201                                              /* Return params     */
      241    14202    2               IF LDCT.DFLG.PPND THEN GOTO GETOUT;

  14202  1 000154   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000155   100006 236100                    LDQ     6,,PR1
         1 000156   000040 316007                    CANQ    32,DL
         1 000157   000715 601000 1                  TNZ     GETOUT

      242    14203    3                 DO INHIBIT;

      243    14204    3                 LDCT.DFLG.RRR=K$RWPARM.DVE.DVBYTE.RRR;

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:28   
  14204  1 000160   000010 236300                    LDQ   ! 8,,PR0
         1 000161   000025 772200                    QRL   ! 21
         1 000162   100006 676300                    ERQ   ! 6,,PR1
         1 000163   001000 376207                    ANQ   ! 512,DL
         1 000164   100006 656300                    ERSQ  ! 6,,PR1

      244    14205    3                 LDCT.DFLG.PPND='1'B;

  14205  1 000165   000040 236207                    LDQ   ! 32,DL
         1 000166   100006 256300                    ORSQ  ! 6,,PR1

      245    14206    3                 END;

      246    14207    2               LDCT.IPFEI# = K$RWPARM.IP$->KI$QMHDR.FEI#;

  14207  1 000167   000012 473500                    LDP3    10,,PR0
         1 000170   300000 236100                    LDQ     0,,PR3
         1 000171   377000 376003                    ANQ     130560,DU
         1 000172   000022 772000                    QRL     18
         1 000173   100014 552110                    STBQ    12,'10'O,PR1

      247    14208    2               LDCT.IP$ = K$RWPARM.IP$;

  14208  1 000174   000012 236100                    LDQ     10,,PR0
         1 000175   100013 756100                    STQ     11,,PR1

      248    14209    2               K$RWPARM.IP$->KI$QMHDR.OFFSET = POFFC(K$RWPARM.UHDR$,K$RWPARM.IP$);

  14209  1 000176   000012 473500                    LDP3    10,,PR0
         1 000177   000012 236100                    LDQ     10,,PR0
         1 000200   000020 772000                    QRL     16
         1 000201   200072 756100                    STQ     ERROR+1,,AUTO
         1 000202   000014 236100                    LDQ     12,,PR0
         1 000203   000020 772000                    QRL     16
         1 000204   200072 136100                    SBLQ    ERROR+1,,AUTO
         1 000205   000000 620006                    EAX0    0,QL
         1 000206   300001 740100                    STX0    1,,PR3
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:29   

      249    14210    2               K$RWPARM.IP$->KI$QMHDR.SIZE = K$RWPARM.UHDRSZ;

  14210  1 000207   000012 473500                    LDP3    10,,PR0
         1 000210   000015 720100                    LXL0    13,,PR0
         1 000211   300001 440100                    SXL0    1,,PR3

      250    14211    2               CALL KQP$PUT (LDCT,K$RWPARM) ALTRET (PUTALT);

  14211  1 000212   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000213   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000214   000000 701000 xent               TSX1    KQP$PUT
         1 000215   000275 702000 1                  TSX2    PUTALT

  14210  1 000216                       PUTEND       null
      251    14212    2   PUTEND:     ;
      252    14213    2               LDCT.IP$ = ADDR(NIL);

  14213  1 000216   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000217   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000220   000013 756100                    STQ     11,,PR0

      253    14214    2               IF K$RWPARM.MRKTYP~=0 THEN CALL KCF$INCMP (LDCT,K$RWPARM);

  14214  1 000221   200004 471500                    LDP1    @K$RWPARM,,AUTO
         1 000222   100040 236100                    LDQ     32,,PR1
         1 000223   777000 316007                    CANQ    -512,DL
         1 000224   000232 600000 1                  TZE     RDTAKEN

  14214  1 000225   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000226   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000227   000000 701000 xent               TSX1    KCF$INCMP
         1 000230   000000 011000                    NOP     0
         1 000231   000237 710000 1                  TRA     UPTHR

      254    14215    2               ELSE
      255    14216    3                 DO INHIBIT;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:30   

      256    14217    3   RDTAKEN:      ;

  14217  1 000232                       RDTAKEN      null
      257    14218    3                 LDCT.DFLG.PPND='0'B;

  14218  1 000232   200003 470700                    LDP0  ! @NK$LDCT,,AUTO
         1 000233   000004 236200 2                  LDQ   ! 4
         1 000234   000006 356300                    ANSQ  ! 6,,PR0

      258    14219    3                 LDCT.IP$ = ADDR(NIL);

  14219  1 000235   000001 236200 xsym               LDQ   ! B_VECTNIL+1
         1 000236   000013 756300                    STQ   ! 11,,PR0

      259    14220    3                 END;

  14214  1 000237                       UPTHR        null
      260    14221    2   UPTHR:      ;
      261    14222    3                 DO INHIBIT;

      262    14223    3                 RDSOUT=LDCT.RDSOUT;

  14223  1 000237   200003 470700                    LDP0  ! @NK$LDCT,,AUTO
         1 000240   000007 236300                    LDQ   ! 7,,PR0
         1 000241   000036 772200                    QRL   ! 30
         1 000242   200064 756300                    STQ   ! INFO,,AUTO

      263    14224    3                 IF RDSOUT~=0 THEN RDSOUT=RDSOUT-1;

  14224  1 000243   000246 600200 1                  TZE   ! s:14225

  14224  1 000244   000001 336207                    LCQ   ! 1,DL
         1 000245   200064 056300                    ASQ   ! INFO,,AUTO

      264    14225    3                 LDCT.RDSOUT=RDSOUT;

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:31   
  14225  1 000246   200064 236300                    LDQ   ! INFO,,AUTO
         1 000247   000036 736200                    QLS   ! 30
         1 000250   000007 752340                    STCQ  ! 7,'40'O,PR0

      265    14226    3                 IF (LDCT.STA$ = ADDR(NIL)) OR (LDCT.STA$->KQ_STA.MINRD = 0)

  14226  1 000251   000012 236300                    LDQ   ! 10,,PR0
         1 000252   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000253   000257 600200 1                  TZE   ! s:14227
         1 000254   000012 471700                    LDP1  ! 10,,PR0
         1 000255   100032 220300                    LDX0  ! 26,,PR1
         1 000256   000263 601200 1                  TNZ   ! s:14228

      266    14227    3                 THEN MINRD = LDCT.CG$->KQ_CG.AUCTL.MINRD; /* CG DEFAULTS */

  14227  1 000257   000027 471700                    LDP1  ! 23,,PR0
         1 000260   100140 220300                    LDX0  ! 96,,PR1
         1 000261   200065 740300                    STX0  ! MINRD,,AUTO
         1 000262   000264 710200 1                  TRA   ! s:14229

      267    14228    3                 ELSE MINRD = LDCT.STA$->KQ_STA.MINRD; /*STATION SPECIFIC*/

  14228  1 000263   200065 740300                    STX0  ! MINRD,,AUTO

      268    14229    3                 IF RDSOUT <= MINRD

  14229  1 000264   200065 236300                    LDQ   ! MINRD,,AUTO
         1 000265   000022 772200                    QRL   ! 18
         1 000266   200064 116300                    CMPQ  ! INFO,,AUTO
         1 000267   000274 604200 1                  TMI   ! s:14232

      269    14230    3                 THEN CALL KCF$FERDS (LDCT);

  14230  1 000270   200003 630700                    EPPR0 ! @NK$LDCT,,AUTO
         1 000271   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000272   000000 701200 xent               TSX1  ! KCF$FERDS
         1 000273   000000 011200                    NOP   ! 0
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:32   

      270    14231    3                 END;

      271    14232    2               GOTO CSEND;

  14232  1 000274   000721 710000 1                  TRA     CSEND

  14227  1 000275                       PUTALT       null
      272    14233    2   PUTALT:     ;
      273    14234    2               PUTERR = K$RWPARM.ERR;

  14234  1 000275   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000276   000013 235100                    LDA     11,,PR0
         1 000277   200064 755100                    STA     INFO,,AUTO

      274    14235    2               K$RWPARM.ERR = 0;

  14235  1 000300   000013 450100                    STZ     11,,PR0

      275    14236    3                 DO CASE (PUTERR);

  14236  1 000301   200064 235100                    LDA     INFO,,AUTO
         1 000302   000011 115007                    CMPA    9,DL
         1 000303   000305 602005 1                  TNC     s:14236+4,AL
         1 000304   000357 710000 1                  TRA     s:14264
         1 000305   000357 710000 1                  TRA     s:14264
         1 000306   000360 710000 1                  TRA     PUTOUT
         1 000307   000371 710000 1                  TRA     s:14274
         1 000310   000317 710000 1                  TRA     s:14240
         1 000311   000351 710000 1                  TRA     s:14252
         1 000312   000354 710000 1                  TRA     s:14255
         1 000313   000357 710000 1                  TRA     s:14264
         1 000314   000357 710000 1                  TRA     s:14264
         1 000315   000316 710000 1                  TRA     s:14238

      276    14237    3                   CASE (KQPE_ILTR#);

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:33   
      277    14238    3                     GOTO UPTHR;

  14238  1 000316   000237 710000 1                  TRA     UPTHR

      278    14239    3                   CASE (KQPE_BADMTYP#);

      279    14240    3                     ERROR = ERR_BADMSGTYP;

  14240  1 000317   000001 236000 0                  LDQ     ERR_BADMSGTYP
         1 000320   200071 756100                    STQ     ERROR,,AUTO

  14240  1 000321                       SEND_ERRMRK  null
      280    14241    3   SEND_ERRMRK:      ;
      281    14242    3                     IF LDCT.DFLG.RRR

  14242  1 000321   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000322   000006 236100                    LDQ     6,,PR0
         1 000323   001000 316007                    CANQ    512,DL
         1 000324   000350 600000 1                  TZE     s:14250

      282    14243    4                     THEN DO;

      283    14244    4                       OPARM = K_RWPARM_CON;

  14244  1 000325   000100 100400                    MLR     fill='000'O
         1 000326   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000327   200014 000234                    ADSC9   OPARM,,AUTO              cn=0,n=156

      284    14245    4                       OPARM.MSG_ERRCODE = ERROR;

  14245  1 000330   200071 236100                    LDQ     ERROR,,AUTO
         1 000331   200053 756100                    STQ     OPARM+31,,AUTO

      285    14246    4                       OPARM.MRKTYP = K$RWPARM.MRKTYP;

  14246  1 000332   200004 471500                    LDP1    @K$RWPARM,,AUTO
         1 000333   100040 236100                    LDQ     32,,PR1
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:34   
         1 000334   200054 552110                    STBQ    OPARM+32,'10'O,AUTO

      286    14247    4                       OPARM.MARKER = K$RWPARM.MARKER;

  14247  1 000335   100007 236100                    LDQ     7,,PR1
         1 000336   200023 756100                    STQ     OPARM+7,,AUTO

      287    14248    4                       CALL KIA$FCNO(LDCT,%KV_VDO_FNC_MRK,OPARM) ALTRET(PUTOUT);

  14248  1 000337   200014 633500                    EPPR3   OPARM,,AUTO
         1 000340   200074 453500                    STP3    ERROR+3,,AUTO
         1 000341   000001 236000 2                  LDQ     1
         1 000342   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000343   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000344   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000345   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000346   000000 701000 xent               TSX1    KIA$FCNO
         1 000347   000360 702000 1                  TSX2    PUTOUT

      288    14249    4                       END;

      289    14250    3                     GOTO RDTAKEN;

  14250  1 000350   000232 710000 1                  TRA     RDTAKEN

      290    14251    3                   CASE (KQPE_NOSTA#);

      291    14252    3                     ERROR = ERR_BADSTA;

  14252  1 000351   000002 236000 0                  LDQ     ERR_BADSTA
         1 000352   200071 756100                    STQ     ERROR,,AUTO

      292    14253    3                     GOTO SEND_ERRMRK;

  14253  1 000353   000321 710000 1                  TRA     SEND_ERRMRK

      293    14254    3                   CASE (KQPE_QFUL#);
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:35   

      294    14255    3                     ERROR = ERR_QFUL;

  14255  1 000354   000003 236000 0                  LDQ     ERR_QFUL
         1 000355   200071 756100                    STQ     ERROR,,AUTO

      295    14256                             /*E* ERROR: KCF-E$QFUL-4
      296    14257                                  MESSAGE: The comgroup is full
      297    14258                                  MESSAGE1: No additional space exists in the comgroup
      298    14259                                            to store the message being written.
      299    14260                             */
      300    14261    3                     GOTO SEND_ERRMRK;

  14261  1 000356   000321 710000 1                  TRA     SEND_ERRMRK

      301    14262    3                   CASE (KQPE_DISC#,KQPE_NODATA#,ELSE);

      302    14263                          /* these error codes are presently not used 5/86 */
      303    14264    3                     GOTO PUTOUT;

  14264  1 000357   000360 710000 1                  TRA     PUTOUT

      304    14265    3                   CASE (KQPE_NOMBLK#);

  14261  1 000360                       PUTOUT       null
      305    14266    3   PUTOUT:           ;
      306    14267    4                       DO INHIBIT;

      307    14268    4                       LDCT.DFLG.PPND='0'B;

  14268  1 000360   200003 470700                    LDP0  ! @NK$LDCT,,AUTO
         1 000361   000004 236200 2                  LDQ   ! 4
         1 000362   000006 356300                    ANSQ  ! 6,,PR0

      308    14269    4                       LDCT.IP$ = ADDR(NIL);

  14269  1 000363   000001 236200 xsym               LDQ   ! B_VECTNIL+1
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:36   
         1 000364   000013 756300                    STQ   ! 11,,PR0

      309    14270    4                       END;

      310    14271    3                     K$RWPARM.ERR = %K$DEFER_IO;

  14271  1 000365   000003 235007                    LDA     3,DL
         1 000366   200004 471500                    LDP1    @K$RWPARM,,AUTO
         1 000367   100013 755100                    STA     11,,PR1

      311    14272    3                     ALTRETURN;

  14272  1 000370   000000 702200 xent               TSX2  ! X66_AALT

      312    14273    3                   CASE (KQPE_NOBUF#);

      313    14274    3                     K$RWPARM.ERR = %K$WAIT_READ;

  14274  1 000371   000006 236007                    LDQ     6,DL
         1 000372   000013 756100                    STQ     11,,PR0

      314    14275    3                     ALTRETURN;

  14275  1 000373   000000 702200 xent               TSX2  ! X66_AALT

      315    14276    3                 END;

      316    14277
      317    14278
      318    14279    2             CASE(%KV_VDO_FNC_BLKDAT);     /* Data blocked      */

      319    14280    2               IF LDCT.DFLG.INPUT THEN CALL KCF$FERDS(LDCT);

  14280  1 000374   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000375   100006 236100                    LDQ     6,,PR1
         1 000376   400000 316007                    CANQ    -131072,DL
         1 000377   000721 600000 1                  TZE     CSEND
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:37   

  14280  1 000400   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000401   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000402   000000 701000 xent               TSX1    KCF$FERDS
         1 000403   000000 011000                    NOP     0
         1 000404   000721 710000 1                  TRA     CSEND

      320    14281
      321    14282
      322    14283    2             CASE(%KV_VDO_FNC_RQSDAT);     /* Data request      */

      323    14284    2               IF LDCT.LKFLG.ACTIVE

  14284  1 000405   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000406   100011 236100                    LDQ     9,,PR1
         1 000407   000040 316003                    CANQ    32,DU
         1 000410   000721 600000 1                  TZE     CSEND

      324    14285    3               THEN DO;

      325    14286    3                 IF NK$LDCT.TH.MAXNMBBYT > 0 AND NK$LDCT.TH.MAXNMBRCR > 0

  14286  1 000411   100017 721100                    LXL1    15,,PR1
         1 000412   000537 604400 1                  TMOZ    s:14335
         1 000413   100016 722100                    LXL2    14,,PR1
         1 000414   000537 604400 1                  TMOZ    s:14335

      326    14287    4                 THEN DO;

      327    14288    4                   IF LDCT.DFLG.SYMBIONT

  14288  1 000415   100006 236100                    LDQ     6,,PR1
         1 000416   020000 316007                    CANQ    8192,DL
         1 000417   000432 600000 1                  TZE     s:14292

      328    14289    4                   THEN
      329    14290    4                    CALL FOM$SYMBIN (LDCT,K$RWPARM,FOMI_FNC_RQSDAT#);
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:38   

  14290  1 000420   000005 236000 2                  LDQ     5
         1 000421   200074 756100                    STQ     ERROR+3,,AUTO
         1 000422   200004 236100                    LDQ     @K$RWPARM,,AUTO
         1 000423   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000424   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000425   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000426   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000427   000000 701000 xent               TSX1    FOM$SYMBIN
         1 000430   000000 011000                    NOP     0
         1 000431   000721 710000 1                  TRA     CSEND

      330    14291    5                   ELSE DO;

      331    14292    5                     OPARM=K_RWPARM_CON;

  14292  1 000432   000100 100400                    MLR     fill='000'O
         1 000433   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000434   200014 000234                    ADSC9   OPARM,,AUTO              cn=0,n=156

      332    14293    5                     OPARM.EOFNONE=KV$VDO_RQSDAT.EOFNO_DAT;

  14293  1 000435   000014 473500                    LDP3    12,,PR0
         1 000436   003100 060500                    CSL     bolr='003'O
         1 000437   300002 060001                    BDSC    2,,PR3                   by=0,bit=6,n=1
         1 000440   200024 400001                    BDSC    OPARM+8,,AUTO            by=2,bit=0,n=1

      333    14294    5                     OPARM.MSGTYP=K$RWPARM.MSGTYP;

  14294  1 000441   000004 237100                    LDAQ    4,,PR0
         1 000442   200020 757100                    STAQ    OPARM+4,,AUTO

      334    14295    5                     OPARM.MSGID = K$RWPARM.MSGID;

  14295  1 000443   000011 235100                    LDA     9,,PR0
         1 000444   200025 755100                    STA     OPARM+9,,AUTO

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:39   
      335    14296    6                     CALL KQG$GET (LDCT,OPARM) WHENALTRETURN DO;

  14296  1 000445   200014 633500                    EPPR3   OPARM,,AUTO
         1 000446   200073 453500                    STP3    ERROR+2,,AUTO
         1 000447   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000450   200072 756100                    STQ     ERROR+1,,AUTO
         1 000451   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000452   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000453   000000 701000 xent               TSX1    KQG$GET
         1 000454   000456 702000 1                  TSX2    s:14297
         1 000455   000536 710000 1                  TRA     s:14333

      336    14297    7                         DO CASE (OPARM.ERR);

  14297  1 000456   200027 235100                    LDA     OPARM+11,,AUTO
         1 000457   000005 115007                    CMPA    5,DL
         1 000460   000462 602005 1                  TNC     s:14297+4,AL
         1 000461   000532 710000 1                  TRA     s:14328
         1 000462   000532 710000 1                  TRA     s:14328
         1 000463   000523 710000 1                  TRA     s:14317
         1 000464   000467 710000 1                  TRA     s:14299
         1 000465   000520 710000 1                  TRA     s:14311
         1 000466   000524 710000 1                  TRA     s:14319

      337    14298    7                           CASE (KQGE_BADMTYP#);

      338    14299    7                             ERROR = ERR_BADMSGTYP;

  14299  1 000467   000001 236000 0                  LDQ     ERR_BADMSGTYP
         1 000470   200071 756100                    STQ     ERROR,,AUTO

  14299  1 000471                       SEND_ERRDAT  null
      339    14300                                     /*E* ERROR: KCF-E$BADMSGTYP-4
      340    14301                                          MESSAGE: The specified message type is invalid
      341    14302                                      */
      342    14303    7   SEND_ERRDAT:              ;
      343    14304    7                             LDCT.LKFLG.OBLK = '1'B;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:40   

  14304  1 000471   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000472   200000 236003                    LDQ     65536,DU
         1 000473   000011 256100                    ORSQ    9,,PR0

      344    14305    7                             OPARM = K_RWPARM_CON;

  14305  1 000474   000100 100400                    MLR     fill='000'O
         1 000475   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000476   200014 000234                    ADSC9   OPARM,,AUTO              cn=0,n=156

      345    14306    7                             OPARM.MSG_ERRCODE = ERROR;

  14306  1 000477   200071 236100                    LDQ     ERROR,,AUTO
         1 000500   200053 756100                    STQ     OPARM+31,,AUTO

      346    14307    7                             OPARM.MRKTYP = K$RWPARM.MRKTYP;

  14307  1 000501   200004 471500                    LDP1    @K$RWPARM,,AUTO
         1 000502   100040 236100                    LDQ     32,,PR1
         1 000503   200054 552110                    STBQ    OPARM+32,'10'O,AUTO

      347    14308    7                             OPARM.MARKER = K$RWPARM.MARKER;

  14308  1 000504   100007 236100                    LDQ     7,,PR1
         1 000505   200023 756100                    STQ     OPARM+7,,AUTO

      348    14309    7                             CALL KIA$FCNO(LDCT,%KV_VDO_FNC_DAT,OPARM) ALTRET(PUTOUT);

  14309  1 000506   200014 633500                    EPPR3   OPARM,,AUTO
         1 000507   200074 453500                    STP3    ERROR+3,,AUTO
         1 000510   000006 236000 2                  LDQ     6
         1 000511   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000512   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000513   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000514   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000515   000000 701000 xent               TSX1    KIA$FCNO
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:41   
         1 000516   000360 702000 1                  TSX2    PUTOUT
         1 000517   000536 710000 1                  TRA     s:14333

      349    14310    7                           CASE (KQGE_NOSTA#);

      350    14311    7                             ERROR = ERR_BADSTA;

  14311  1 000520   000002 236000 0                  LDQ     ERR_BADSTA
         1 000521   200071 756100                    STQ     ERROR,,AUTO

      351    14312                                     /*E* ERROR: KCF-E$BADSTA-4
      352    14313                                          MESSAGE: The specified station is illegal
      353    14314                                      */
      354    14315    7                             GOTO SEND_ERRDAT;

  14315  1 000522   000471 710000 1                  TRA     SEND_ERRDAT

      355    14316    7                           CASE (KQGE_QFUL#);

      356    14317    7                             GOTO CSEND;

  14317  1 000523   000721 710000 1                  TRA     CSEND

      357    14318    7                           CASE (KQGE_EOF#);

      358    14319    7                             LDCT.LKFLG.OBLK = '1'B;

  14319  1 000524   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000525   200000 236003                    LDQ     65536,DU
         1 000526   000011 256100                    ORSQ    9,,PR0

      359    14320    7                             ERROR = ERR_NODAT;

  14320  1 000527   000000 236000 0                  LDQ     ERR_NODAT
         1 000530   200071 756100                    STQ     ERROR,,AUTO

      360    14321                                     /*E* ERROR: KCF-E$NODAT-4
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:42   
      361    14322                                          MESSAGE: No data is available
      362    14323                                     MESSAGE1: No data with the requested MSGTYP or STATION
      363    14324                                                    is currently available.
      364    14325                                      */
      365    14326    7                             GOTO SEND_ERRDAT;

  14326  1 000531   000471 710000 1                  TRA     SEND_ERRDAT

      366    14327    7                           CASE (ELSE);

      367    14328    7                             LDCT.LKFLG.OBLK = '1'B;

  14328  1 000532   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000533   200000 236003                    LDQ     65536,DU
         1 000534   000011 256100                    ORSQ    9,,PR0

      368    14329    7                             GOTO GETOUT;

  14329  1 000535   000715 710000 1                  TRA     GETOUT

      369    14330    7                         END;

      370    14331    6                       END;
      371    14332    5                     END;

      372    14333    4                   END;

  14333  1 000536   000721 710000 1                  TRA     CSEND

      373    14334    4                 ELSE DO;

      374    14335    4                   CALL KQG$CANCEL (LDCT) ALTRET(GETOUT);

  14335  1 000537   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000540   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000541   000000 701000 xent               TSX1    KQG$CANCEL
         1 000542   000715 702000 1                  TSX2    GETOUT
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:43   

      375    14336    4                   K$RWPARM = K_RWPARM_CON;

  14336  1 000543   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000544   000100 100400                    MLR     fill='000'O
         1 000545   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000546   000000 000234                    ADSC9   0,,PR0                   cn=0,n=156

      376    14337    4                   LDCT.LKFLG.OBLK = '1'B;

  14337  1 000547   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000550   200000 236003                    LDQ     65536,DU
         1 000551   100011 256100                    ORSQ    9,,PR1

      377    14338    4                   CALL KIA$FCNO(LDCT,%KV_VDO_FNC_BLKDAT,K$RWPARM) ALTRET(GETOUT);

  14338  1 000552   200004 236100                    LDQ     @K$RWPARM,,AUTO
         1 000553   200074 756100                    STQ     ERROR+3,,AUTO
         1 000554   000005 236000 2                  LDQ     5
         1 000555   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000556   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000557   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000560   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000561   000000 701000 xent               TSX1    KIA$FCNO
         1 000562   000715 702000 1                  TSX2    GETOUT

      378    14339    4                   CALL KIA$FCNO(LDCT,%KV_VDO_FNC_MRK,K$RWPARM) ALTRET(GETOUT);

  14339  1 000563   200004 236100                    LDQ     @K$RWPARM,,AUTO
         1 000564   200074 756100                    STQ     ERROR+3,,AUTO
         1 000565   000001 236000 2                  LDQ     1
         1 000566   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000567   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000570   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000571   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000572   000000 701000 xent               TSX1    KIA$FCNO
         1 000573   000715 702000 1                  TSX2    GETOUT
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:44   

      379    14340    4                   END;

      380    14341    3                 END;

  14341  1 000574   000721 710000 1                  TRA     CSEND

      381    14342
      382    14343
      383    14344    2             CASE(%KV_VDO_FNC_MRK);        /* Output complete   */

      384    14345    2               IF LDCT.DFLG.SYMBIONT

  14345  1 000575   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000576   100006 236100                    LDQ     6,,PR1
         1 000577   020000 316007                    CANQ    8192,DL
         1 000600   000613 600000 1                  TZE     s:14349

      385    14346    2               THEN
      386    14347    2                CALL FOM$SYMBIN (LDCT,K$RWPARM,FOMI_FNC_MRK#);

  14347  1 000601   000007 236000 2                  LDQ     7
         1 000602   200074 756100                    STQ     ERROR+3,,AUTO
         1 000603   200004 236100                    LDQ     @K$RWPARM,,AUTO
         1 000604   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000605   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000606   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000607   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000610   000000 701000 xent               TSX1    FOM$SYMBIN
         1 000611   000000 011000                    NOP     0
         1 000612   000721 710000 1                  TRA     CSEND

      387    14348    2               ELSE
      388    14349    2                IF LDCT.LKFLG.WTMRK             /* Waiting marker */

  14349  1 000613   100011 236100                    LDQ     9,,PR1
         1 000614   020000 316003                    CANQ    8192,DU
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:45   
         1 000615   000666 600000 1                  TZE     s:14365

      389    14350    3                THEN DO;

      390    14351                       %LOCK (G=NK$LDCT.LOCK);

  14352  1 000616   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000617   000020 036003                    ADLQ    16,DU
         1 000620   200072 756100                    STQ     ERROR+1,,AUTO
         1 000621   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000622   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000623   000000 701000 xent               TSX1    HFC$LOCK
         1 000624   000000 011000                    NOP     0

      391    14354    3                  IF (B$USRT$->B$USER.FLG(LDCT.USER)&%U_SCIO)

  14354  1 000625   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000626   000007 236100                    LDQ     7,,PR0
         1 000627   000016 772000                    QRL     14
         1 000630   017760 376007                    ANQ     8176,DL
         1 000631   000000 471400 xsym               LDP1    B$USRT$
         1 000632   100000 236106                    LDQ     0,QL,PR1
         1 000633   000006 376000 0                  ANQ     ERR_QFUL+3
         1 000634   000653 600000 1                  TZE     s:14358
         1 000635   000007 236100                    LDQ     7,,PR0
         1 000636   000016 772000                    QRL     14
         1 000637   017760 376007                    ANQ     8176,DL
         1 000640   100017 236106                    LDQ     15,QL,PR1
         1 000641   200003 116100                    CMPQ    @NK$LDCT,,AUTO
         1 000642   000653 601000 1                  TNZ     s:14358

      392    14355    3                  AND B$USRT$->B$USER.MISC$(LDCT.USER) = ADDR(LDCT)
      393    14356    3                  THEN
      394    14357    3                   CALL SSR$RUE (%SS_CIC,LDCT.USER);

  14357  1 000643   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000644   000010 036000 2                  ADLQ    8
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:46   
         1 000645   000006 235000 2                  LDA     6
         1 000646   200072 757100                    STAQ    ERROR+1,,AUTO
         1 000647   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000650   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000651   000000 701000 xent               TSX1    SSR$RUE
         1 000652   000000 011000                    NOP     0

      395    14358    3                  LDCT.LKFLG.WTMRK = '0'B;

  14358  1 000653   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000654   000011 236000 2                  LDQ     9
         1 000655   000011 356100                    ANSQ    9,,PR0

      396    14359                       %UNLOCK (G=NK$LDCT.LOCK);

  14360  1 000656   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000657   000020 036003                    ADLQ    16,DU
         1 000660   200072 756100                    STQ     ERROR+1,,AUTO
         1 000661   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000662   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000663   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000664   000000 011000                    NOP     0

      397    14362    3                  RETURN;

  14362  1 000665   000000 702200 xent               TSX2  ! X66_ARET

      398    14363    3                  END;
      399    14364    2                ELSE
      400    14365    2                 CALL KQG$COMP (LDCT,K$RWPARM);

  14365  1 000666   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000667   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000670   000000 701000 xent               TSX1    KQG$COMP
         1 000671   000000 011000                    NOP     0
         1 000672   000721 710000 1                  TRA     CSEND

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:47   
      401    14366
      402    14367
      403    14368
      404    14369    2             CASE(ELSE);                   /* Eh? Reboot FEP    */

  14365  1 000673                       BDFCN        null
      405    14370    2   BDFCN:      ;
      406    14371    2               FEX=LDCT.RLCID.NODE;

  14371  1 000673   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000674   100015 236100                    LDQ     13,,PR1
         1 000675   000033 772000                    QRL     27
         1 000676   200067 756100                    STQ     FEX,,AUTO

      407    14372    2               KL_FEPST.FEP = FEX;

  14372  1 000677   000022 736000                    QLS     18
         1 000700   200005 552120                    STBQ    KL_FEPST,'20'O,AUTO

      408    14373    2               KL_FEPST.FCN = IGA_CRASHFEP_BF;

  14373  1 000701   120000 236003                    LDQ     40960,DU
         1 000702   200005 552140                    STBQ    KL_FEPST,'40'O,AUTO

      409    14374    2               CALL KUB$WRITE(KL_FEPST, LENGTHC(KL_FEPST), 'HLPADMIN');

  14374  1 000703   000013 236000 2                  LDQ     11
         1 000704   200074 756100                    STQ     ERROR+3,,AUTO
         1 000705   000014 236000 2                  LDQ     12
         1 000706   200073 756100                    STQ     ERROR+2,,AUTO
         1 000707   200005 633500                    EPPR3   KL_FEPST,,AUTO
         1 000710   200072 453500                    STP3    ERROR+1,,AUTO
         1 000711   200072 630500                    EPPR0   ERROR+1,,AUTO
         1 000712   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000713   000000 701000 xent               TSX1    KUB$WRITE
         1 000714   000000 011000                    NOP     0

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:48   
  14373  1 000715                       GETOUT       null
      410    14375    2   GETOUT:     ;
      411    14376    2               K$RWPARM.ERR = %K$DEFER_IO;

  14376  1 000715   000003 235007                    LDA     3,DL
         1 000716   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000717   000013 755100                    STA     11,,PR0

      412    14377    2               ALTRETURN;

  14377  1 000720   000000 702200 xent               TSX2  ! X66_AALT

      413    14378    2           END;

  14376  1 000721                       CSEND        null
      414    14379    1   CSEND:;
      415    14380    1         IF K$RWPARM.ERR = %K$DEFER_IO OR K$RWPARM.ERR = %K$WAIT_READ

  14380  1 000721   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000722   000013 235100                    LDA     11,,PR0
         1 000723   000003 115007                    CMPA    3,DL
         1 000724   000727 600000 1                  TZE     s:14382
         1 000725   000006 115007                    CMPA    6,DL
         1 000726   000730 601000 1                  TNZ     s:14383

      416    14381    1         THEN
      417    14382    1          ALTRETURN;

  14382  1 000727   000000 702200 xent               TSX2  ! X66_AALT

      418    14383    1         RETURN;

  14383  1 000730   000000 702200 xent               TSX2  ! X66_ARET

ERR_NODAT
 Sect OctLoc
   0     000   130306 021002                                                    X...
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:49   

ERR_BADMSGTYP
 Sect OctLoc
   0     001   130306 015772                                                    X...

ERR_BADSTA
 Sect OctLoc
   0     002   130306 016002                                                    X...

ERR_QFUL
 Sect OctLoc
   0     003   130306 016012                                                    X...

(unnamed)
 Sect OctLoc
   0     004   052107 117052   123124 117120   000000 002000   110114 120101    *GO*STOP....HLPA
   0     010   104115 111116                                                    DMIN

(unnamed)
 Sect OctLoc
   2     000   000000 000037   000000 006000   000000 000035   000002 006000    ................
   2     004   777777 777737   000004 006000   000007 006000   000003 006000    ................
   2     010   000007 200000   757777 777777   000000 000016   000007 006000    ................
   2     014   000012 006000                                                    ....
      419    14384
      420    14385        %EJECT;
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:50   
      421    14386    1   END KCF$FEIN;
      422    14387
      423    14388
      424    14389        %EOD;

PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:51   
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   F_MACROS_C.:E05TOU  is referenced.
   FOM_SUBS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KV$VDO.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
   UE_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KC_SUBS_C.:E05TOU  is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KI$MHDR.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$FEIN.
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:52   

 **** Variables and constants ****

  ****  Section 000 RoData KCF$FEIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b STRC        r     1 ERR_BADMSGTYP              2-0-0/b STRC        r     1 ERR_BADSTA
     0-0-0/b STRC        r     1 ERR_NODAT                  3-0-0/b STRC        r     1 ERR_QFUL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @K$RWPARM                  3-0-0/w PTR         r     1 @NK$LDCT
    71-0-0/b BIT         r     1 ERROR                     67-0-0/w UBIN        r     1 FEX
    64-0-0/w UBIN        r     1 INFO                      *0-0-0/d STRC(1404)  r     1 K$RWPARM
     5-0-0/w STRC(126)   r     1 KL_FEPST                  65-0-0/w UBIN(18)    r     1 MINRD
    *0-0-0/d STRC(864)   r     1 NK$LDCT                   14-0-0/d STRC(1404)  r     1 OPARM
    64-0-0/w UBIN        r     1 PUTERR                    64-0-0/w SBIN        r     1 RDSOUT
    66-0-0/c CHAR(4)     r     1 TSTATE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$USRT$                    0-0-0/d STRC(1404)  r     1 KC_CRWP
     0-0-0/d STRC(1404)  r     1 K_RWPARM_CON

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 B$USER(0:0)                0-0-0/w STRC(144)   r     1 KI$QMHDR
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:53   
     0-0-0/d STRC(6516)  r     1 KQ_CG                      0-0-0/d STRC(1296)  r     1 KQ_STA
     0-0-0/h STRC(18)    r     1 KV$VDO                     0-0-0/h STRC        r     1 KV$VDO_EVT
     0-0-0/h STRC(90)    r     1 KV$VDO_RQSDAT


   Procedure KCF$FEIN requires 473 words for executable code.
   Procedure KCF$FEIN requires 62 words of local(AUTO) storage.
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:54   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:55   
          MINI XREF LISTING

B$DO.ECCINFO
      7766**DCL      7767--REDEF
B$U.MISC
      7745**DCL      7746--REDEF
B$USER.FLG
      7791**DCL     14354>>IF
B$USER.MISC
      7821**DCL      7822--REDEF
B$USER.MISC$
      7822**DCL     14354>>IF
B$USRT$
     14093**DCL     14354>>IF      14354>>IF
COMIOEV.ARS
     13381**DCL     13381--REDEF
CSEND
     14376**LABEL   14232--GOTO    14317--GOTO
ERROR
     13708**DCL     14240<<ASSIGN  14245>>ASSIGN  14252<<ASSIGN  14255<<ASSIGN  14299<<ASSIGN  14306>>ASSIGN
     14311<<ASSIGN  14320<<ASSIGN
ERR_BADMSGTYP
     14106**DCL     14240>>ASSIGN  14299>>ASSIGN
ERR_BADSTA
     14110**DCL     14252>>ASSIGN  14311>>ASSIGN
ERR_NODAT
     14102**DCL     14320>>ASSIGN
ERR_QFUL
     14114**DCL     14255>>ASSIGN
FEX
     13705**DCL     13706--REDEF   14371<<ASSIGN  14372>>ASSIGN
FOM$SYMBIN
     13715**DCL-ENT 14290--CALL    14347--CALL
GETOUT
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:56   
     14373**LABEL   14182--CALLALT 14193--CALLALT 14202--GOTO    14329--GOTO    14335--CALLALT 14338--CALLALT
     14339--CALLALT
HFC$LOCK
       431**DCL-ENT 14352--CALL
HFC$UNLOCK
       431**DCL-ENT 14360--CALL
INFO
     13700**DCL     13701--REDEF   13702--REDEF   14179<<ASSIGN  14181<<ASSIGN  14183<>CALL
K$RWPARM
     11732**DCL        78--PROC    14182<>CALL    14197<>CALL    14211<>CALL    14214<>CALL    14290<>CALL
     14336<<ASSIGN  14338<>CALL    14339<>CALL    14347<>CALL    14365<>CALL
K$RWPARM.BLKREC
     11758**DCL     11783--REDEF
K$RWPARM.BLKREC.BLKU#
     11759**DCL     11761--REDEF
K$RWPARM.BLKREC.RECU#
     11771**DCL     11773--REDEF
K$RWPARM.DVE.DVBYTE.RRR
     11802**DCL     14204>>ASSIGN
K$RWPARM.DVE.DVBYTE.VFC
     11798**DCL     11799--REDEF
K$RWPARM.DVE.EOMCHAR
     11806**DCL     11810--REDEF
K$RWPARM.ERR
     11870**DCL     11875--REDEF   14234>>ASSIGN  14235<<ASSIGN  14271<<ASSIGN  14274<<ASSIGN  14376<<ASSIGN
     14380>>IF      14380>>IF
K$RWPARM.FC
     11834**DCL     11835--REDEF
K$RWPARM.FLDID
     12016**DCL     12017--REDEF
K$RWPARM.FPT$
     11897**DCL     11904--REDEF
K$RWPARM.IP$
     11862**DCL     14207>>ASSIGN  14208>>ASSIGN  14209>>ASSIGN  14209>>ASSIGN  14210>>ASSIGN
K$RWPARM.KEYTYPE
     12023**DCL     12024--REDEF
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:57   
K$RWPARM.MARKER
     11783**DCL     14247>>ASSIGN  14308>>ASSIGN
K$RWPARM.MRKTYP
     12008**DCL     14214>>IF      14246>>ASSIGN  14307>>ASSIGN
K$RWPARM.MSG$
     11733**DCL     11739--REDEF
K$RWPARM.MSGID
     11845**DCL     11850--REDEF   14295>>ASSIGN
K$RWPARM.MSGIDXT
     11858**DCL     11862--REDEF
K$RWPARM.MSGTYP
     11749**DCL     14294>>ASSIGN
K$RWPARM.ORG
     11994**DCL     11995--REDEF
K$RWPARM.THDRSZ
     11938**DCL     11942--REDEF
K$RWPARM.UHDR$
     11883**DCL     12102--IMP-PTR 12142--IMP-PTR 12184--IMP-PTR 12232--IMP-PTR 14170>>DOCASE  14177>>IF
     14209>>ASSIGN  14293>>ASSIGN
K$RWPARM.UHDRSZ
     11888**DCL     14210>>ASSIGN
K$RWPARM.VDOFLGS
     11996**DCL     12007--REDEF
KCD$DSCTRM
     13717**DCL-ENT 14197--CALL
KCF$FERDS
     13718**DCL-ENT 14184--CALL    14230--CALL    14280--CALL
KCF$INCMP
     13719**DCL-ENT 14214--CALL
KC_CRWP
     13759**DCL     14188>>ASSIGN
KC_CRWP.BLKREC
     13785**DCL     13810--REDEF
KC_CRWP.BLKREC.BLKU#
     13786**DCL     13788--REDEF
KC_CRWP.BLKREC.RECU#
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:58   
     13798**DCL     13800--REDEF
KC_CRWP.DVE.DVBYTE.VFC
     13825**DCL     13826--REDEF
KC_CRWP.DVE.EOMCHAR
     13833**DCL     13837--REDEF
KC_CRWP.ERR
     13897**DCL     13902--REDEF
KC_CRWP.FC
     13861**DCL     13862--REDEF
KC_CRWP.FLDID
     14043**DCL     14044--REDEF
KC_CRWP.FPT$
     13924**DCL     13931--REDEF
KC_CRWP.KEYTYPE
     14050**DCL     14051--REDEF
KC_CRWP.MSG$
     13760**DCL     13766--REDEF
KC_CRWP.MSGID
     13872**DCL     13877--REDEF
KC_CRWP.MSGIDXT
     13885**DCL     13889--REDEF
KC_CRWP.ORG
     14021**DCL     14022--REDEF
KC_CRWP.THDRSZ
     13965**DCL     13969--REDEF
KC_CRWP.VDOFLGS
     14023**DCL     14034--REDEF
KI$QMHDR.FEI#
     12036**DCL     14207>>ASSIGN
KI$QMHDR.FPTSZ
     12069**DCL     12070--REDEF
KI$QMHDR.MSGSZ
     12075**DCL     12076--REDEF
KI$QMHDR.OFFSET
     12063**DCL     14209<<ASSIGN
KI$QMHDR.SIZE
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:59   
     12064**DCL     14210<<ASSIGN
KI$QMHDR.UID
     12065**DCL     12066--REDEF
KIA$FCNO
     13720**DCL-ENT 14182--CALL    14193--CALL    14248--CALL    14309--CALL    14338--CALL    14339--CALL
KL_FEPST
     12269**DCL     14374<>CALL    14374--CALL
KL_FEPST.FCN
     12270**DCL     14373<<ASSIGN
KL_FEPST.FEP
     12272**DCL     14372<<ASSIGN
KQG$CANCEL
     13724**DCL-ENT 14335--CALL
KQG$COMP
     13725**DCL-ENT 14365--CALL
KQG$GET
     13728**DCL-ENT 14296--CALL
KQP$EVNT
     13732**DCL-ENT 14183--CALL
KQP$PUT
     13733**DCL-ENT 14211--CALL
KQ_CG.AUCTL.DVBYTE.REREAD
     12749**DCL     12750--REDEF
KQ_CG.AUCTL.MINRD
     12755**DCL     14227>>ASSIGN
KQ_STA.ACTTYC
     13096**DCL     13100--REDEF
KQ_STA.DCBLNK$
     13103**DCL     13106--REDEF   13110--REDEF
KQ_STA.EVCNT
     13189**DCL     13192--REDEF
KQ_STA.EVNT
     13155**DCL     13159--REDEF   13162--REDEF
KQ_STA.MINRD
     13287**DCL     14226>>IF      14228>>ASSIGN
KQ_STA.OPNBLKED
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:60   
     13216**DCL     13219--REDEF
KQ_STA.OPNREJ
     13222**DCL     13224--REDEF
KQ_STA.SUCCREAD
     13145**DCL     13149--REDEF
KQ_STA.TCOUNT
     13274**DCL     13280--REDEF
KQ_STA.VGOT$
     13259**DCL     13263--REDEF   13267--REDEF
KUB$WRITE
     13735**DCL-ENT 14374--CALL
KV$VDO.FNC
     12106**DCL     14170>>DOCASE
KV$VDO_EVT.TYP
     12149**DCL     14177>>IF
KV$VDO_RQSDAT.EOFNO_DAT
     12195**DCL     14293>>ASSIGN
K_RWPARM_CON
      6380**DCL     14244>>ASSIGN  14292>>ASSIGN  14305>>ASSIGN  14336>>ASSIGN
K_RWPARM_CON.BLKREC
      6406**DCL      6431--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      6407**DCL      6409--REDEF
K_RWPARM_CON.BLKREC.RECU#
      6419**DCL      6421--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      6446**DCL      6447--REDEF
K_RWPARM_CON.DVE.EOMCHAR
      6454**DCL      6458--REDEF
K_RWPARM_CON.ERR
      6518**DCL      6523--REDEF
K_RWPARM_CON.FC
      6482**DCL      6483--REDEF
K_RWPARM_CON.FLDID
      6664**DCL      6665--REDEF
K_RWPARM_CON.FPT$
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:61   
      6545**DCL      6552--REDEF
K_RWPARM_CON.KEYTYPE
      6671**DCL      6672--REDEF
K_RWPARM_CON.MSG$
      6381**DCL      6387--REDEF
K_RWPARM_CON.MSGID
      6493**DCL      6498--REDEF
K_RWPARM_CON.MSGIDXT
      6506**DCL      6510--REDEF
K_RWPARM_CON.ORG
      6642**DCL      6643--REDEF
K_RWPARM_CON.THDRSZ
      6586**DCL      6590--REDEF
K_RWPARM_CON.VDOFLGS
      6644**DCL      6655--REDEF
MESS$HD.FLAGS
     12250**DCL     12251--REDEF
MESS$HD.MSGID
     12246**DCL     12247--REDEF
MESS$HD.WSN
     12253**DCL     12254--REDEF
MINRD
     13703**DCL     14227<<ASSIGN  14228<<ASSIGN  14229>>IF
NK$LDCT
     11678**DCL        78--PROC    14182<>CALL    14183<>CALL    14184<>CALL    14193<>CALL    14197<>CALL
     14211<>CALL    14214<>CALL    14230<>CALL    14248<>CALL    14280<>CALL    14290<>CALL    14296<>CALL
     14309<>CALL    14335<>CALL    14338<>CALL    14339<>CALL    14347<>CALL    14354--IF      14365<>CALL
NK$LDCT.CG$
     11709**DCL     14227>>ASSIGN
NK$LDCT.DDT$
     11680**DCL     11680--REDEF
NK$LDCT.DFLG.INPUT
     11682**DCL     14280>>IF
NK$LDCT.DFLG.PPND
     11686**DCL     14202>>IF      14205<<ASSIGN  14218<<ASSIGN  14268<<ASSIGN
NK$LDCT.DFLG.RRR
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:62   
     11684**DCL     14204<<ASSIGN  14242>>IF
NK$LDCT.DFLG.SYMBIONT
     11683**DCL     14288>>IF      14345>>IF
NK$LDCT.IOQ$
     11679**DCL     11680--REDEF
NK$LDCT.IP$
     11700**DCL     14208<<ASSIGN  14213<<ASSIGN  14219<<ASSIGN  14269<<ASSIGN
NK$LDCT.IPFEI#
     11701**DCL     14207<<ASSIGN
NK$LDCT.LDCTX
     11681**DCL     11681--REDEF
NK$LDCT.LKFLG.ABORTED
     11693**DCL     11694--REDEF
NK$LDCT.LKFLG.ACTIVE
     11697**DCL     14191>>IF      14284>>IF
NK$LDCT.LKFLG.OBLK
     11693**DCL     14304<<ASSIGN  14319<<ASSIGN  14328<<ASSIGN  14337<<ASSIGN
NK$LDCT.LKFLG.WTMRK
     11694**DCL     14349>>IF      14358<<ASSIGN
NK$LDCT.LOCK
     11706**DCL     14352<>CALL    14360<>CALL
NK$LDCT.RDSOUT
     11687**DCL     14223>>ASSIGN  14225<<ASSIGN
NK$LDCT.RLCID.LDCTX
     11703**DCL     11703--REDEF
NK$LDCT.RLCID.NODE
     11702**DCL     14371>>ASSIGN
NK$LDCT.STA$
     11699**DCL     11700--REDEF   14226>>IF      14226>>IF      14228>>ASSIGN
NK$LDCT.SYMB$
     11678**DCL     11678--REDEF   11678--REDEF   11679--REDEF
NK$LDCT.TH.MAXNMBBYT
     11705**DCL     14286>>IF
NK$LDCT.TH.MAXNMBRCR
     11704**DCL     14286>>IF
NK$LDCT.USER
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:63   
     11688**DCL     14354>>IF      14354>>IF      14357<>CALL
OPARM
     13405**DCL     14188<<ASSIGN  14193<>CALL    14244<<ASSIGN  14248<>CALL    14292<<ASSIGN  14296<>CALL
     14305<<ASSIGN  14309<>CALL
OPARM.BLKREC
     13431**DCL     13456--REDEF
OPARM.BLKREC.BLKU#
     13432**DCL     13434--REDEF
OPARM.BLKREC.RECU#
     13444**DCL     13446--REDEF
OPARM.DVE.DVBYTE.VFC
     13471**DCL     13472--REDEF
OPARM.DVE.EOMCHAR
     13479**DCL     13483--REDEF
OPARM.EOFNONE
     13487**DCL     14293<<ASSIGN
OPARM.ERR
     13543**DCL     13548--REDEF   14297>>DOCASE
OPARM.FC
     13507**DCL     13508--REDEF
OPARM.FLDID
     13689**DCL     13690--REDEF
OPARM.FPT$
     13570**DCL     13577--REDEF
OPARM.KEYTYPE
     13696**DCL     13697--REDEF
OPARM.MARKER
     13456**DCL     14247<<ASSIGN  14308<<ASSIGN
OPARM.MRKTYP
     13681**DCL     14246<<ASSIGN  14307<<ASSIGN
OPARM.MSG$
     13406**DCL     13412--REDEF   14190<<ASSIGN
OPARM.MSGID
     13518**DCL     13523--REDEF   14295<<ASSIGN
OPARM.MSGIDXT
     13531**DCL     13535--REDEF
PL6.E3A0      #001=KCF$FEIN File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:12 Page:64   
OPARM.MSGSZ
     13413**DCL     14189<<ASSIGN
OPARM.MSGTYP
     13422**DCL     14294<<ASSIGN
OPARM.MSG_ERRCODE
     13666**DCL     14245<<ASSIGN  14306<<ASSIGN
OPARM.ORG
     13667**DCL     13668--REDEF
OPARM.THDRSZ
     13611**DCL     13615--REDEF
OPARM.VDOFLGS
     13669**DCL     13680--REDEF
PUTALT
     14227**LABEL   14211--CALLALT
PUTERR
     13702**DCL     14234<<ASSIGN  14236>>DOCASE
PUTOUT
     14261**LABEL   14248--CALLALT 14264--GOTO    14309--CALLALT
RDSOUT
     13701**DCL     14223<<ASSIGN  14224>>IF      14224<<ASSIGN  14224>>ASSIGN  14225>>ASSIGN  14229>>IF
RDTAKEN
     14217**LABEL   14250--GOTO
SEND_ERRDAT
     14299**LABEL   14315--GOTO    14326--GOTO
SEND_ERRMRK
     14240**LABEL   14253--GOTO    14261--GOTO
SSR$RUE
      8064**DCL-ENT 14357--CALL
TSTATE
     13704**DCL     14189--ASSIGN  14190--ASSIGN  14191<<ASSIGN  14192<<ASSIGN
UPTHR
     14214**LABEL   14238--GOTO

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:65   
      425        1        /*T***********************************************************/
      426        2        /*T*                                                         */
      427        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      428        4        /*T*                                                         */
      429        5        /*T***********************************************************/
      430        6
      431        7        /*F* NAME:         KCF$FEWRT
      432        8             PURPOSE:      To write a message to a FEP-connected
      433        9                           comgroup device
      434       10             DESCRIPTION:  Called from KCD$WRITE for FEP-connected
      435       11                           devices.  We handle the various possible
      436       12                           errors passed thru from KQG$GET.  If
      437       13                           everything is OK, we write the data.
      438       14                           This can either mean putting it directly
      439       15                           in the circular queue, or doing a
      440       16                           write-crossing-coupler.  This latter
      441       17                           is implemented by VGETting the buffer
      442       18                           into the FEP's working space, and then
      443       19                           sending a msg thru the circular queue
      444       20                           specifying the buffer address.  We
      445       21                           then set K$RWPARM.ERR to DLTR (DONE later)
      446       22                           thus telling KQG$GET that we'll call
      447       23                           KQG$DONE later, and ALTRET to KCD$WRITE
      448       24                           to tell him to just exit without calling
      449       25                           KQG$DONE.  Eventually the FEP sends us
      450       26                           a message saying he's grabbed all the
      451       27                           data, at which point we call MMS$VREL
      452       28                           to de-map the buffer, and call KQG$DONE
      453       29                           (this happens in KCF$FEIN @ KX_WCCD).
      454       30        */
      455       31
      456       32        KCF$FEWRT: PROC (NK$LDCT,K$RWPARM) ALTRET;
      457       33
      458       34
      459       35
      460       36
      461       37
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:66   
      462       38        /* INCLUDES */
      463       39
      464       40
      465       41        %INCLUDE NK$LDCT;
      466      143        %INCLUDE KQ_MAC_C;
      467     2693        %INCLUDE KC_CP6;
      468     3253        %INCLUDE KC$CP6V_C;
      469     3373        %INCLUDE KC_DATA_R;
      470     3386        %INCLUDE HF_LOCK_C;
      471     3400        %INCLUDE N_FC_C;
      472     3437        %INCLUDE CP_6_SUBS;
      473     3977        %INCLUDE KC_SUBS_C;
      474     3993        %INCLUDE KC_ERRORS_C;
      475     4040        %INCLUDE KI_ERRORS_C;
      476     4125        %INCLUDE NK_SUBS;
      477     4150        %INCLUDE NK_VFC_C;
      478     4224        %INCLUDE KI_SUBS_C;
      479     4360        %INCLUDE KQ_SUBS_C;
      480     4660        %INCLUDE K_DATA_R;
      481     5371        %INCLUDE K_SUBS_C;
      482     5404        %INCLUDE KV$VDO;
      483     6419        %INCLUDE F_MACROS_C;
      484     6430
      485     6431        /* Equate macros */
      486     6432        %KV_VDO_E;
      487     6468        %KV_VDOVLP_E;
      488     6482        %KV_DATMOD_E;
      489     6488        %KV_DATCTRCHRTYP_E;
      490     6494
      491     6495
      492     6496
      493     6497
      494     6498        /* PARAMETERS */
      495     6499
      496     6500        %NK$LDCT (STCLASS="");
      497     6546        %K$RWPARM (STCLASS="",NAME=K$RWPARM);
      498     6862
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:67   
      499     6863
      500     6864
      501     6865
      502     6866        /* BASED STRUCTURES */
      503     6867
      504     6868        %KQ_CG (STCLASS=BASED);
      505     7607        %KQ_STA (STCLASS=BASED);
      506     7946        %KV_VDOMRKTYP_E;
      507     7952        %KV$VDO_BLKDAT;
      508     7995        %KV$VDO_DAT;
      509     8040        %KV$VDOVLP_CG_MSGTYP;
      510     8092        %KV$VDOVLP_CG_STA;
      511     8143        %KV$VDOVLP_DAT2;
      512     8193        %KV$VDOVLP_MRK (LAST=",");
      513     8246    1         2 BLKREC BIT(36) UNAL;
      514     8247    1   DCL DUMMY UBIN BASED;
      515     8248    1   DCL 1 B$$MYMID BASED ALIGNED,
      516     8249    1         2 JUNK UBIN(4) UNAL,
      517     8250    1         2 P1 UBIN(8) UNAL,
      518     8251    1         2 P2 UBIN(8) UNAL,
      519     8252    1         2 P3 UBIN(8) UNAL,
      520     8253    1         2 P4 UBIN(8) UNAL;
      521     8254    1   DCL 1 B$$FEPMID BASED ALIGNED,
      522     8255    1         2 *  BIT(1)  UNAL,
      523     8256    1         2 P1 UBIN(8) UNAL,
      524     8257    1         2 *  BIT(1)  UNAL,
      525     8258    1         2 P2 UBIN(8) UNAL,
      526     8259    1         2 *  BIT(1)  UNAL,
      527     8260    1         2 P3 UBIN(8) UNAL,
      528     8261    1         2 *  BIT(1)  UNAL,
      529     8262    1         2 P4 UBIN(8) UNAL;
      530     8263    1   DCL VCHRC CHAR(MSIZ) BASED;
      531     8264
      532     8265
      533     8266
      534     8267
      535     8268        /* AUTO */
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:68   
      536     8269
      537     8270    1   DCL MSIZ UBIN WORD;
      538     8271    1   DCL 1 MZ REDEF MSIZ,
      539     8272    1         2 T UBIN(28) UNAL,
      540     8273    1         2 B UBIN(8) UNAL;
      541     8274    1   DCL BUF$ PTR;
      542     8275    1   DCL 1 BF REDEF BUF$,
      543     8276    1         2 T4 UBIN(4) UNAL,
      544     8277    1         2 M8 UBIN(8) UNAL,
      545     8278    1         2 B8 UBIN(8) UNAL,
      546     8279    1         2 REST BIT(16);
      547     8280    1   DCL ERROR BIT(36);
      548     8281    1   DCL OP$ PTR;
      549     8282    1   DCL OD$ PTR;
      550     8283    1   DCL MAXRD UBIN HALF ;
      551     8284    1   DCL TCUR SBIN;
      552     8285    1   DCL FEX UBIN WORD;
      553     8286        %K$RWPARM (NAME=K$RWPARM_AUTO,STCLASS="");
      554     8602
      555     8603
      556     8604
      557     8605
      558     8606        /**/
      559     8607        /*  CONSTANT  */
      560     8608        /**/
      561     8609        %SUB FCG#='1303'O;
      562     8610        %SUB MID#='06'O;
      563     8611        %ERRCODE (NAME=ERR_BADSTA,COD#=%E$BADSTA);
      564     8615        %ERRCODE (NAME=ERR_BADMSGTYP,COD#=%E$BADMSGTYP);
      565     8619        %ERRCODE (NAME=ERR_NODAT,COD#=%E$NODAT);
      566     8623
      567     8624
      568     8625
      569     8626
      570     8627        /* REFS */
      571     8628
      572     8629    1   DCL HFF$TRAPALT   ENTRY    ALTRET;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:69   
      573     8630    1   DCL KCF$QFL       ENTRY(1) ALTRET;
      574     8631    1   DCL KIA$FCNO      ENTRY(3) ALTRET;
      575     8632    1   DCL KQX$LDASR     ENTRY(1);
      576     8633    1   DCL KIS$SESSION ENTRY(3) ALTRET;
      577     8634    1   DCL KIA$WRITE ENTRY (2) ALTRET;
      578     8635    1   DCL KIA$VDO ENTRY(3);
      579     8636
      580     8637        /* Symref's */
      581     8638        %EJECT;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:70   
      582     8639
      583     8640
      584     8641    1         IF LDCT.LKFLG.ACTIVE='0'B THEN GOTO INAC;
      585     8642    1         FEX=LDCT.RLCID.NODE;
      586     8643    1         IF K$RWPARM.ERR~=0 THEN
      587     8644    2           DO;
      588     8645    3             DO CASE (K$RWPARM.ERR);
      589     8646    3               CASE (KQGE_NOSTA#);
      590     8647    3                 ERROR = ERR_BADSTA;
      591     8648    3   SEND_ERRDAT:  ;
      592     8649    3                 K$RWPARM_AUTO = K_RWPARM_CON;
      593     8650    3                 K$RWPARM_AUTO.MSG_ERRCODE = ERROR;
      594     8651                      %LOCK (G=NK$LDCT.LOCK);
      595     8654        /*N* Looks like we should set OBLK here for FPRGs, but not sure.
      596     8655             Do we ever get here?
      597     8656        */
      598     8657    4                 IF LDCT.RESCOD = NK_CGFPRG THEN DO;
      599     8658    4                   K$RWPARM.ERR = KQGE_NGET#;
      600     8659    4                   LDCT.LKFLG.OBLK = '1'B;
      601     8660    4                   END;
      602     8661    3                 TCUR = LDCT.TH.MAXNMBBYT;
      603     8662    3                 LDCT.TH.MAXNMBBYT = -3;
      604     8663    3                 CALL KIA$FCNO(LDCT,%KV_VDO_FNC_DAT,K$RWPARM_AUTO) ALTRET(QFUL);
      605     8664                      %UNLOCK (G=NK$LDCT.LOCK);
      606     8667    3               CASE (KQGE_BADMTYP#);
      607     8668    3                 ERROR = ERR_BADMSGTYP;
      608     8669    3                 GOTO SEND_ERRDAT;
      609     8670    3               CASE (KQGE_EOF#);
      610     8671    3                 ERROR = ERR_NODAT;
      611     8672    3                 GOTO SEND_ERRDAT;
      612     8673    3               CASE (KQGE_QFUL#);
      613     8674    3                 GOTO INAC;
      614     8675    3               CASE (ELSE);
      615     8676    3                 GOTO ERROK;
      616     8677    3             END;
      617     8678    2           RETURN;
      618     8679    2           END;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:71   
      619     8680    1   ERROK:;
      620     8681    1         K$RWPARM.ERR = 0;
      621     8682              %LOCK (G=NK$LDCT.LOCK);
      622     8685    1         IF K$RWPARM.DVE.DVBYTE.RRR
      623     8686    1         THEN
      624     8687    1          K$RWPARM.MRKTYP = %KV_VDOMRKTYP_ENDACK;
      625     8688    1         CALL KIA$WRITE (LDCT,K$RWPARM)
      626     8689    2         WHENALTRETURN DO;
      627     8690
      628     8691    2           IF K$RWPARM.ERR = %K$NO_THROT
      629     8692    3           THEN DO;
      630     8693                  %UNLOCK (G=NK$LDCT.LOCK);
      631     8696    3   INAC:     ;
      632     8697    3             K$RWPARM.ERR = KQGE_SZ2BIG#;
      633     8698    3             ALTRETURN;
      634     8699    3             END;
      635     8700    3           ELSE DO;
      636     8701    3             IF LDCT.LKFLG.QNFL
      637     8702    4             THEN DO;
      638     8703    4               LDCT.LKFLG.QNFL = '0'B;
      639     8704                    %UNLOCK (G=NK$LDCT.LOCK);
      640     8707    4               GOTO ERROK;
      641     8708    4               END;
      642     8709    3             LDCT.QFL.WRT = '1'B;
      643     8710    3             K$RWPARM.ERR = KQGE_PCW#;
      644     8711    3             CALL KCF$QFL (LDCT) ALTRET (WRDSC);
      645     8712    3             ALTRETURN;
      646     8713
      647     8714    3             END;
      648     8715    2           END;
      649     8716    1         IF K$RWPARM.ERR = 0 AND NK$LDCT.TH.MAXNMBRCR = 0
      650     8717    2         THEN DO;
      651     8718    3           IF LDCT.RESCOD = NK_CGFPRG THEN DO;
      652     8719    3             K$RWPARM.ERR = KQGE_NGET#;
      653     8720    3             LDCT.LKFLG.OBLK = '1'B;
      654     8721    3             END;
      655     8722    2           END;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:72   
      656     8723    1         IF LDCT.LKFLG.INTOGGLE AND K$RWPARM.DVE.VFC = %VFC_SPR THEN
      657     8724                 /* M$PROFILE or M$STRMATTR */
      658     8725    2           DO;
      659     8726    2           LDCT.LKFLG.INTOGGLE = '0'B;
      660     8727    2           LDCT.DFLG.INPUT = ~LDCT.DFLG.INPUT;
      661     8728                %UNLOCK (G=NK$LDCT.LOCK);
      662     8731    2           CALL KCF$FERDS (LDCT);
      663     8732    2           END;
      664     8733    1         ELSE
      665     8734               %UNLOCK (G=NK$LDCT.LOCK);
      666     8737    1         RETURN;
      667     8738
      668     8739    1   QFUL: ;
      669     8740        /* Check to see if the error was a trap on the buffer */
      670     8741    1         IF K$RWPARM.ERR = %K$BAD_BUFFER
      671     8742    2         THEN DO;
      672     8743    2           CALL FIXCURT;
      673     8744                %UNLOCK (G=NK$LDCT.LOCK);
      674     8747    2           RETURN;
      675     8748    2           END;
      676     8749
      677     8750        /* Must be queue full */
      678     8751    1         CALL FIXCUR;
      679     8752    1         LDCT.QFL.WRT='1'B;
      680     8753    1         CALL KCF$QFL (LDCT) ALTRET (WRDSC);
      681     8754    1         K$RWPARM.ERR=KQGE_PCW#;
      682     8755    1         ALTRETURN;
      683     8756    1   WRDSC:;
      684     8757    1         K$RWPARM.ERR=KQGE_DISC#;
      685     8758    1   ALTRT:;
      686     8759    1         ALTRETURN;
      687     8760
      688     8761
      689     8762    1   FIXCURT: PROC;
      690     8763
      691     8764    2         K$RWPARM.ERR=0;
      692     8765    2         K$RWPARM.TYC=%TYC_MTRAP|%TYC_EGV;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:73   
      693     8766
      694     8767    2   FIXCUR: ENTRY;
      695     8768
      696     8769    2         LDCT.TH.MAXNMBBYT=TCUR;
      697     8770    2         RETURN;
      698     8771    2   END FIXCURT;
      699     8772        %EJECT;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:74   
      700     8773        /*F* NAME:         KCF$INCMP
      701     8774             PURPOSE:      To tell the FEP that a message has been
      702     8775                           successfully received.
      703     8776             DESCRIPTION:  When we read data directly from the
      704     8777                           circular queue, the FEP can ask for RRR,
      705     8778                           that is, to be notified when we successfully
      706     8779                           receive the data.  Thus this routine is
      707     8780                           called from KCD$RDGO after it stuffs an
      708     8781                           ICQ msg into the comgroup, from KCF$FEIN
      709     8782                           when it does the same, and from KCD$INCMP
      710     8783                           for msgs whose recept acknowlege was delayed
      711     8784                           by the comgroup.
      712     8785
      713     8786                           We send the receipt-acknowlege message to the
      714     8787                           device.*/
      715     8788    1   KCF$INCMP: ENTRY (LDCT,K$RWPARM) ALTRET;
      716     8789
      717     8790    1         K$RWPARM_AUTO = K_RWPARM_CON;
      718     8791    1         K$RWPARM_AUTO.MSGID = K$RWPARM.MSGID;
      719     8792    1         K$RWPARM_AUTO.MRKTYP = K$RWPARM.MRKTYP;
      720     8793    1         K$RWPARM_AUTO.MARKER = K$RWPARM.MARKER;
      721     8794    1         GOTO INCMP;
      722     8795
      723     8796        /*F* NAME:         KCF$INCMPL
      724     8797             PURPOSE:      Same as KCF$INCMP
      725     8798             DESCRIPTION:  Called from KCF$QNF when the OCQ is no longer
      726     8799                           full, and a previous call to KCF$INCMP was
      727     8800                           delayed by a full OCQ.  We send the message. */
      728     8801    1   KCF$INCMPL: ENTRY (LDCT) ALTRET;
      729     8802
      730     8803    1         K$RWPARM_AUTO = K_RWPARM_CON;
      731     8804    1         K$RWPARM_AUTO.MSGID = LDCT.MSGID;
      732     8805    1   INCMP:;
      733     8806    1         K$RWPARM_AUTO.MSGIDXT='0'B;
      734     8807              %LOCK (G=NK$LDCT.LOCK);
      735     8810    1         CALL KIA$FCNO (LDCT,%KV_VDO_FNC_MRK,K$RWPARM_AUTO) ALTRET (QFLI);
      736     8811              %UNLOCK (G=NK$LDCT.LOCK);
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:75   
      737     8814    1   POUT: ;
      738     8815    2           DO INHIBIT;
      739     8816    2           LDCT.DFLG.PPND='0'B;
      740     8817    2           LDCT.IP$ = ADDR(NIL);
      741     8818    2           END;
      742     8819    1         RETURN;
      743     8820
      744     8821    1   QFLI: ;
      745     8822    1         LDCT.MSGID=K$RWPARM_AUTO.MSGID;
      746     8823    1         LDCT.QFL.INCMP='1'B;
      747     8824    1         CALL KCF$QFL (LDCT) ALTRET (POUT);
      748     8825    1         RETURN;
      749     8826
      750     8827        /*F* NAME:         KCF$FERDS
      751     8828             PURPOSE:      To issue delayed reads to the FEP
      752     8829                           for comgroup devices
      753     8830             DESCRIPTION:  We perpetually read comgroup devices.
      754     8831                           This routine sends a new read message
      755     8832                           to the FEP whenever appropriate. */
      756     8833    1   KCF$FERDS: ENTRY (LDCT) ALTRET;
      757     8834
      758     8835    1         IF LDCT.LKFLG.ACTIVE='0'B THEN RETURN;
      759     8836    1         K$RWPARM_AUTO = K_RWPARM_CON;
      760     8837    1         MSIZ=LDCT.CG$->KQ_CG.AUCTL.TRMRDSIZ;
      761     8838    1         CALL KQX$LDASR (LDCT.CG$->DUMMY);
      762     8839    1         K$RWPARM_AUTO.MAXRCRBYTSIZ=MSIZ;
      763     8840        /*N* FOR NOW */
      764     8841    1         K$RWPARM_AUTO.MAXNMBBYT = 32000;
      765     8842    1         K$RWPARM_AUTO.DVE.DVBYTE = LDCT.STA$->KQ_STA.DVBYTE;
      766     8843    1         K$RWPARM_AUTO.STR=KIDM_CP;
      767     8844    1         IF (LDCT.STA$ = ADDR(NIL)) OR (LDCT.STA$->KQ_STA.MAXRD = 0)
      768     8845    1         THEN MAXRD = LDCT.CG$->KQ_CG.AUCTL.MAXRD; /* CG DEFAULTS */
      769     8846    1         ELSE MAXRD = LDCT.STA$->KQ_STA.MAXRD; /*STATION SPECIFICS*/
      770     8847              %LOCK (G=NK$LDCT.LOCK);
      771     8850    1         IF NOT LDCT.DFLG.INPUT THEN
      772     8851    1          K$RWPARM_AUTO.MAXNMBRCR=0;
      773     8852    2         ELSE DO;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:76   
      774     8853    2           IF (LDCT.RDSOUT >0) THEN
      775     8854    2            K$RWPARM_AUTO.VDOFLGS.INCNMBRCR = '1'B;
      776     8855    2           K$RWPARM_AUTO.MAXNMBRCR = MAXRD - LDCT.RDSOUT;
      777     8856    2           END;
      778     8857    1         CALL KIA$FCNO (LDCT,%KV_VDO_FNC_RQSDAT,K$RWPARM_AUTO) ALTRET (QFULR);
      779     8858    1         LDCT.RDSOUT=LDCT.RDSOUT + K$RWPARM_AUTO.MAXNMBRCR;
      780     8859              %UNLOCK (G=NK$LDCT.LOCK);
      781     8862    1         RETURN;
      782     8863
      783     8864    1   QFULR:;
      784     8865    1         LDCT.QFL.RD='1'B;
      785     8866    1         CALL KCF$QFL (LDCT);
      786     8867    1         RETURN;
      787     8868
      788     8869    1   END;
      789     8870
      790     8871
      791     8872        %EOD;

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:77   
--  Include file information  --

   F_MACROS_C.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KC_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$FEWRT.

   Procedure KCF$FEWRT requires 393 words for executable code.
   Procedure KCF$FEWRT requires 60 words of local(AUTO) storage.

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:78   

 Object Unit name= KCF$FEWRT                                  File name= KCF$CGFE.:E05TOU
 UTS= JUL 30 '97 00:13:19.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      4      4  KCF$FEWRT
    1   Proc  even  none   393    611  KCF$FEWRT
    2  RoData even  none     8     10  KCF$FEWRT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  KCF$FEWRT
     1    346          yes     yes      Std        2  KCF$INCMP
     1    363          yes     yes      Std        1  KCF$INCMPL
     1    443          yes     yes      Std        1  KCF$FERDS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       2 KIA$WRITE
         yes           Std       1 KQX$LDASR
 yes     yes           Std       3 KIA$FCNO
 yes     yes           Std       1 KCF$QFL
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:79   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    K_RWPARM_CON                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:80   


      425        1        /*T***********************************************************/
      426        2        /*T*                                                         */
      427        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      428        4        /*T*                                                         */
      429        5        /*T***********************************************************/
      430        6
      431        7        /*F* NAME:         KCF$FEWRT
      432        8             PURPOSE:      To write a message to a FEP-connected
      433        9                           comgroup device
      434       10             DESCRIPTION:  Called from KCD$WRITE for FEP-connected
      435       11                           devices.  We handle the various possible
      436       12                           errors passed thru from KQG$GET.  If
      437       13                           everything is OK, we write the data.
      438       14                           This can either mean putting it directly
      439       15                           in the circular queue, or doing a
      440       16                           write-crossing-coupler.  This latter
      441       17                           is implemented by VGETting the buffer
      442       18                           into the FEP's working space, and then
      443       19                           sending a msg thru the circular queue
      444       20                           specifying the buffer address.  We
      445       21                           then set K$RWPARM.ERR to DLTR (DONE later)
      446       22                           thus telling KQG$GET that we'll call
      447       23                           KQG$DONE later, and ALTRET to KCD$WRITE
      448       24                           to tell him to just exit without calling
      449       25                           KQG$DONE.  Eventually the FEP sends us
      450       26                           a message saying he's grabbed all the
      451       27                           data, at which point we call MMS$VREL
      452       28                           to de-map the buffer, and call KQG$DONE
      453       29                           (this happens in KCF$FEIN @ KX_WCCD).
      454       30        */
      455       31
      456       32        KCF$FEWRT: PROC (NK$LDCT,K$RWPARM) ALTRET;

     32  1 000000   000000 700200 xent  KCF$FEWRT    TSX0  ! X66_AUTO_2
         1 000001   000074 000002                    ZERO    60,2

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:81   
      457       33
      458       34
      459       35
      460       36
      461       37
      462       38        /* INCLUDES */
      463       39
      464       40
      465       41        %INCLUDE NK$LDCT;
      466      143        %INCLUDE KQ_MAC_C;
      467     2693        %INCLUDE KC_CP6;
      468     3253        %INCLUDE KC$CP6V_C;
      469     3373        %INCLUDE KC_DATA_R;
      470     3386        %INCLUDE HF_LOCK_C;
      471     3400        %INCLUDE N_FC_C;
      472     3437        %INCLUDE CP_6_SUBS;
      473     3977        %INCLUDE KC_SUBS_C;
      474     3993        %INCLUDE KC_ERRORS_C;
      475     4040        %INCLUDE KI_ERRORS_C;
      476     4125        %INCLUDE NK_SUBS;
      477     4150        %INCLUDE NK_VFC_C;
      478     4224        %INCLUDE KI_SUBS_C;
      479     4360        %INCLUDE KQ_SUBS_C;
      480     4660        %INCLUDE K_DATA_R;
      481     5371        %INCLUDE K_SUBS_C;
      482     5404        %INCLUDE KV$VDO;
      483     6419        %INCLUDE F_MACROS_C;
      484     6430
      485     6431        /* Equate macros */
      486     6432        %KV_VDO_E;
      487     6468        %KV_VDOVLP_E;
      488     6482        %KV_DATMOD_E;
      489     6488        %KV_DATCTRCHRTYP_E;
      490     6494
      491     6495
      492     6496
      493     6497
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:82   
      494     6498        /* PARAMETERS */
      495     6499
      496     6500        %NK$LDCT (STCLASS="");
      497     6546        %K$RWPARM (STCLASS="",NAME=K$RWPARM);
      498     6862
      499     6863
      500     6864
      501     6865
      502     6866        /* BASED STRUCTURES */
      503     6867
      504     6868        %KQ_CG (STCLASS=BASED);
      505     7607        %KQ_STA (STCLASS=BASED);
      506     7946        %KV_VDOMRKTYP_E;
      507     7952        %KV$VDO_BLKDAT;
      508     7995        %KV$VDO_DAT;
      509     8040        %KV$VDOVLP_CG_MSGTYP;
      510     8092        %KV$VDOVLP_CG_STA;
      511     8143        %KV$VDOVLP_DAT2;
      512     8193        %KV$VDOVLP_MRK (LAST=",");
      513     8246    1         2 BLKREC BIT(36) UNAL;
      514     8247    1   DCL DUMMY UBIN BASED;
      515     8248    1   DCL 1 B$$MYMID BASED ALIGNED,
      516     8249    1         2 JUNK UBIN(4) UNAL,
      517     8250    1         2 P1 UBIN(8) UNAL,
      518     8251    1         2 P2 UBIN(8) UNAL,
      519     8252    1         2 P3 UBIN(8) UNAL,
      520     8253    1         2 P4 UBIN(8) UNAL;
      521     8254    1   DCL 1 B$$FEPMID BASED ALIGNED,
      522     8255    1         2 *  BIT(1)  UNAL,
      523     8256    1         2 P1 UBIN(8) UNAL,
      524     8257    1         2 *  BIT(1)  UNAL,
      525     8258    1         2 P2 UBIN(8) UNAL,
      526     8259    1         2 *  BIT(1)  UNAL,
      527     8260    1         2 P3 UBIN(8) UNAL,
      528     8261    1         2 *  BIT(1)  UNAL,
      529     8262    1         2 P4 UBIN(8) UNAL;
      530     8263    1   DCL VCHRC CHAR(MSIZ) BASED;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:83   
      531     8264
      532     8265
      533     8266
      534     8267
      535     8268        /* AUTO */
      536     8269
      537     8270    1   DCL MSIZ UBIN WORD;
      538     8271    1   DCL 1 MZ REDEF MSIZ,
      539     8272    1         2 T UBIN(28) UNAL,
      540     8273    1         2 B UBIN(8) UNAL;
      541     8274    1   DCL BUF$ PTR;
      542     8275    1   DCL 1 BF REDEF BUF$,
      543     8276    1         2 T4 UBIN(4) UNAL,
      544     8277    1         2 M8 UBIN(8) UNAL,
      545     8278    1         2 B8 UBIN(8) UNAL,
      546     8279    1         2 REST BIT(16);
      547     8280    1   DCL ERROR BIT(36);
      548     8281    1   DCL OP$ PTR;
      549     8282    1   DCL OD$ PTR;
      550     8283    1   DCL MAXRD UBIN HALF ;
      551     8284    1   DCL TCUR SBIN;
      552     8285    1   DCL FEX UBIN WORD;
      553     8286        %K$RWPARM (NAME=K$RWPARM_AUTO,STCLASS="");
      554     8602
      555     8603
      556     8604
      557     8605
      558     8606        /**/
      559     8607        /*  CONSTANT  */
      560     8608        /**/
      561     8609        %SUB FCG#='1303'O;
      562     8610        %SUB MID#='06'O;
      563     8611        %ERRCODE (NAME=ERR_BADSTA,COD#=%E$BADSTA);
      564     8615        %ERRCODE (NAME=ERR_BADMSGTYP,COD#=%E$BADMSGTYP);
      565     8619        %ERRCODE (NAME=ERR_NODAT,COD#=%E$NODAT);
      566     8623
      567     8624
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:84   
      568     8625
      569     8626
      570     8627        /* REFS */
      571     8628
      572     8629    1   DCL HFF$TRAPALT   ENTRY    ALTRET;
      573     8630    1   DCL KCF$QFL       ENTRY(1) ALTRET;
      574     8631    1   DCL KIA$FCNO      ENTRY(3) ALTRET;
      575     8632    1   DCL KQX$LDASR     ENTRY(1);
      576     8633    1   DCL KIS$SESSION ENTRY(3) ALTRET;
      577     8634    1   DCL KIA$WRITE ENTRY (2) ALTRET;
      578     8635    1   DCL KIA$VDO ENTRY(3);
      579     8636
      580     8637        /* Symref's */
      581     8638        %EJECT;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:85   
      582     8639
      583     8640
      584     8641    1         IF LDCT.LKFLG.ACTIVE='0'B THEN GOTO INAC;

   8641  1 000002   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000003   000011 236100                    LDQ     9,,PR0
         1 000004   000040 316003                    CANQ    32,DU
         1 000005   000153 600000 1                  TZE     INAC

      585     8642    1         FEX=LDCT.RLCID.NODE;

   8642  1 000006   000015 236100                    LDQ     13,,PR0
         1 000007   000033 772000                    QRL     27
         1 000010   200014 756100                    STQ     FEX,,AUTO

      586     8643    1         IF K$RWPARM.ERR~=0 THEN

   8643  1 000011   200004 471500                    LDP1    @K$RWPARM,,AUTO
         1 000012   100013 235100                    LDA     11,,PR1
         1 000013   000114 600000 1                  TZE     ERROK

      587     8644    2           DO;

      588     8645    3             DO CASE (K$RWPARM.ERR);

   8645  1 000014   000005 115007                    CMPA    5,DL
         1 000015   000017 602005 1                  TNC     s:8645+3,AL
         1 000016   000112 710000 1                  TRA     s:8676
         1 000017   000112 710000 1                  TRA     s:8676
         1 000020   000111 710000 1                  TRA     s:8674
         1 000021   000103 710000 1                  TRA     s:8668
         1 000022   000024 710000 1                  TRA     s:8647
         1 000023   000106 710000 1                  TRA     s:8671

      589     8646    3               CASE (KQGE_NOSTA#);

      590     8647    3                 ERROR = ERR_BADSTA;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:86   

   8647  1 000024   000000 236000 0                  LDQ     ERR_BADSTA
         1 000025   200007 756100                    STQ     ERROR,,AUTO

   8647  1 000026                       SEND_ERRDAT  null
      591     8648    3   SEND_ERRDAT:  ;
      592     8649    3                 K$RWPARM_AUTO = K_RWPARM_CON;

   8649  1 000026   000100 100400                    MLR     fill='000'O
         1 000027   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000030   200016 000234                    ADSC9   K$RWPARM_AUTO,,AUTO      cn=0,n=156

      593     8650    3                 K$RWPARM_AUTO.MSG_ERRCODE = ERROR;

   8650  1 000031   200007 236100                    LDQ     ERROR,,AUTO
         1 000032   200055 756100                    STQ     K$RWPARM_AUTO+31,,AUTO

      594     8651                      %LOCK (G=NK$LDCT.LOCK);

   8652  1 000033   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000034   000020 036003                    ADLQ    16,DU
         1 000035   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000036   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000040   000000 701000 xent               TSX1    HFC$LOCK
         1 000041   000000 011000                    NOP     0

      595     8654        /*N* Looks like we should set OBLK here for FPRGs, but not sure.
      596     8655             Do we ever get here?
      597     8656        */
      598     8657    4                 IF LDCT.RESCOD = NK_CGFPRG THEN DO;

   8657  1 000042   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000043   000006 236100                    LDQ     6,,PR0
         1 000044   000017 376007                    ANQ     15,DL
         1 000045   000011 116007                    CMPQ    9,DL
         1 000046   000054 601000 1                  TNZ     s:8661
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:87   

      599     8658    4                   K$RWPARM.ERR = KQGE_NGET#;

   8658  1 000047   000012 235007                    LDA     10,DL
         1 000050   200004 471500                    LDP1    @K$RWPARM,,AUTO
         1 000051   100013 755100                    STA     11,,PR1

      600     8659    4                   LDCT.LKFLG.OBLK = '1'B;

   8659  1 000052   200000 236003                    LDQ     65536,DU
         1 000053   000011 256100                    ORSQ    9,,PR0

      601     8660    4                   END;

      602     8661    3                 TCUR = LDCT.TH.MAXNMBBYT;

   8661  1 000054   000017 236100                    LDQ     15,,PR0
         1 000055   000022 736000                    QLS     18
         1 000056   000022 732000                    QRS     18
         1 000057   200013 756100                    STQ     TCUR,,AUTO

      603     8662    3                 LDCT.TH.MAXNMBBYT = -3;

   8662  1 000060   777775 220003                    LDX0    -3,DU
         1 000061   000017 440100                    SXL0    15,,PR0

      604     8663    3                 CALL KIA$FCNO(LDCT,%KV_VDO_FNC_DAT,K$RWPARM_AUTO) ALTRET(QFUL);

   8663  1 000062   200016 631500                    EPPR1   K$RWPARM_AUTO,,AUTO
         1 000063   200072 451500                    STP1    K$RWPARM_AUTO+44,,AUTO
         1 000064   000000 236000 2                  LDQ     0
         1 000065   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000066   200070 757100                    STAQ    K$RWPARM_AUTO+42,,AUTO
         1 000067   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000070   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000071   000000 701000 xent               TSX1    KIA$FCNO
         1 000072   000272 702000 1                  TSX2    QFUL
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:88   

      605     8664                      %UNLOCK (G=NK$LDCT.LOCK);

   8665  1 000073   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000074   000020 036003                    ADLQ    16,DU
         1 000075   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000076   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000077   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000100   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000101   000000 011000                    NOP     0
         1 000102   000113 710000 1                  TRA     s:8678

      606     8667    3               CASE (KQGE_BADMTYP#);

      607     8668    3                 ERROR = ERR_BADMSGTYP;

   8668  1 000103   000001 236000 0                  LDQ     ERR_BADMSGTYP
         1 000104   200007 756100                    STQ     ERROR,,AUTO

      608     8669    3                 GOTO SEND_ERRDAT;

   8669  1 000105   000026 710000 1                  TRA     SEND_ERRDAT

      609     8670    3               CASE (KQGE_EOF#);

      610     8671    3                 ERROR = ERR_NODAT;

   8671  1 000106   000002 236000 0                  LDQ     ERR_NODAT
         1 000107   200007 756100                    STQ     ERROR,,AUTO

      611     8672    3                 GOTO SEND_ERRDAT;

   8672  1 000110   000026 710000 1                  TRA     SEND_ERRDAT

      612     8673    3               CASE (KQGE_QFUL#);

      613     8674    3                 GOTO INAC;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:89   

   8674  1 000111   000153 710000 1                  TRA     INAC

      614     8675    3               CASE (ELSE);

      615     8676    3                 GOTO ERROK;

   8676  1 000112   000114 710000 1                  TRA     ERROK

      616     8677    3             END;

      617     8678    2           RETURN;

   8678  1 000113   000000 702200 xent               TSX2  ! X66_ARET

   8678  1 000114                       ERROK        null
      618     8679    2           END;
      619     8680    1   ERROK:;
      620     8681    1         K$RWPARM.ERR = 0;

   8681  1 000114   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000115   000013 450100                    STZ     11,,PR0

      621     8682              %LOCK (G=NK$LDCT.LOCK);

   8683  1 000116   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000117   000020 036003                    ADLQ    16,DU
         1 000120   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000121   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000122   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000123   000000 701000 xent               TSX1    HFC$LOCK
         1 000124   000000 011000                    NOP     0

      622     8685    1         IF K$RWPARM.DVE.DVBYTE.RRR

   8685  1 000125   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000126   000010 236100                    LDQ     8,,PR0
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:90   
         1 000127   010000 316003                    CANQ    4096,DU
         1 000130   000133 600000 1                  TZE     s:8688

      623     8686    1         THEN
      624     8687    1          K$RWPARM.MRKTYP = %KV_VDOMRKTYP_ENDACK;

   8687  1 000131   001000 236007                    LDQ     512,DL
         1 000132   000040 552110                    STBQ    32,'10'O,PR0

      625     8688    1         CALL KIA$WRITE (LDCT,K$RWPARM)

   8688  1 000133   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000134   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000135   000000 701000 xent               TSX1    KIA$WRITE
         1 000136   000140 702000 1                  TSX2    s:8691
         1 000137   000206 710000 1                  TRA     s:8716

      626     8689    2         WHENALTRETURN DO;

      627     8690
      628     8691    2           IF K$RWPARM.ERR = %K$NO_THROT

   8691  1 000140   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000141   000013 235100                    LDA     11,,PR0
         1 000142   000004 115007                    CMPA    4,DL
         1 000143   000157 601000 1                  TNZ     s:8701

      629     8692    3           THEN DO;

      630     8693                  %UNLOCK (G=NK$LDCT.LOCK);

   8694  1 000144   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000145   000020 036003                    ADLQ    16,DU
         1 000146   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000147   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000151   000000 701000 xent               TSX1    HFC$UNLOCK
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:91   
         1 000152   000000 011000                    NOP     0

   8694  1 000153                       INAC         null
      631     8696    3   INAC:     ;
      632     8697    3             K$RWPARM.ERR = KQGE_SZ2BIG#;

   8697  1 000153   000007 235007                    LDA     7,DL
         1 000154   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000155   000013 755100                    STA     11,,PR0

      633     8698    3             ALTRETURN;

   8698  1 000156   000000 702200 xent               TSX2  ! X66_AALT

      634     8699    3             END;
      635     8700    3           ELSE DO;

      636     8701    3             IF LDCT.LKFLG.QNFL

   8701  1 000157   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000160   100011 236100                    LDQ     9,,PR1
         1 000161   040000 316003                    CANQ    16384,DU
         1 000162   000175 600000 1                  TZE     s:8709

      637     8702    4             THEN DO;

      638     8703    4               LDCT.LKFLG.QNFL = '0'B;

   8703  1 000163   000001 236000 2                  LDQ     1
         1 000164   100011 356100                    ANSQ    9,,PR1

      639     8704                    %UNLOCK (G=NK$LDCT.LOCK);

   8705  1 000165   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000166   000020 036003                    ADLQ    16,DU
         1 000167   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000170   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:92   
         1 000171   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000172   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000173   000000 011000                    NOP     0

      640     8707    4               GOTO ERROK;

   8707  1 000174   000114 710000 1                  TRA     ERROK

      641     8708    4               END;
      642     8709    3             LDCT.QFL.WRT = '1'B;

   8709  1 000175   000400 236007                    LDQ     256,DL
         1 000176   100010 256100                    ORSQ    8,,PR1

      643     8710    3             K$RWPARM.ERR = KQGE_PCW#;

   8710  1 000177   000010 235007                    LDA     8,DL
         1 000200   000013 755100                    STA     11,,PR0

      644     8711    3             CALL KCF$QFL (LDCT) ALTRET (WRDSC);

   8711  1 000201   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000202   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000203   000000 701000 xent               TSX1    KCF$QFL
         1 000204   000325 702000 1                  TSX2    WRDSC

      645     8712    3             ALTRETURN;

   8712  1 000205   000000 702200 xent               TSX2  ! X66_AALT

      646     8713
      647     8714    3             END;
      648     8715    2           END;
      649     8716    1         IF K$RWPARM.ERR = 0 AND NK$LDCT.TH.MAXNMBRCR = 0

   8716  1 000206   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000207   000013 235100                    LDA     11,,PR0
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:93   
         1 000210   000224 601000 1                  TNZ     s:8723
         1 000211   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000212   100016 720100                    LXL0    14,,PR1
         1 000213   000224 601000 1                  TNZ     s:8723

      650     8717    2         THEN DO;

      651     8718    3           IF LDCT.RESCOD = NK_CGFPRG THEN DO;

   8718  1 000214   100006 236100                    LDQ     6,,PR1
         1 000215   000017 376007                    ANQ     15,DL
         1 000216   000011 116007                    CMPQ    9,DL
         1 000217   000224 601000 1                  TNZ     s:8723

      652     8719    3             K$RWPARM.ERR = KQGE_NGET#;

   8719  1 000220   000012 235007                    LDA     10,DL
         1 000221   000013 755100                    STA     11,,PR0

      653     8720    3             LDCT.LKFLG.OBLK = '1'B;

   8720  1 000222   200000 236003                    LDQ     65536,DU
         1 000223   100011 256100                    ORSQ    9,,PR1

      654     8721    3             END;

      655     8722    2           END;

      656     8723    1         IF LDCT.LKFLG.INTOGGLE AND K$RWPARM.DVE.VFC = %VFC_SPR THEN

   8723  1 000224   200003 471500                    LDP1    @NK$LDCT,,AUTO
         1 000225   100011 236100                    LDQ     9,,PR1
         1 000226   000020 316003                    CANQ    16,DU
         1 000227   000262 600000 1                  TZE     s:8735
         1 000230   000010 236100                    LDQ     8,,PR0
         1 000231   000777 376003                    ANQ     511,DU
         1 000232   000025 116003                    CMPQ    21,DU
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:94   
         1 000233   000262 601000 1                  TNZ     s:8735

      657     8724                 /* M$PROFILE or M$STRMATTR */
      658     8725    2           DO;

      659     8726    2           LDCT.LKFLG.INTOGGLE = '0'B;

   8726  1 000234   000002 236000 2                  LDQ     2
         1 000235   100011 356100                    ANSQ    9,,PR1

      660     8727    2           LDCT.DFLG.INPUT = ~LDCT.DFLG.INPUT;

   8727  1 000236   100006 236100                    LDQ     6,,PR1
         1 000237   000022 736000                    QLS     18
         1 000240   400000 376003                    ANQ     -131072,DU
         1 000241   400000 676003                    ERQ     -131072,DU
         1 000242   000022 772000                    QRL     18
         1 000243   100006 676100                    ERQ     6,,PR1
         1 000244   400000 376007                    ANQ     -131072,DL
         1 000245   100006 656100                    ERSQ    6,,PR1

      661     8728                %UNLOCK (G=NK$LDCT.LOCK);

   8729  1 000246   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000247   000020 036003                    ADLQ    16,DU
         1 000250   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000251   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000252   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000253   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000254   000000 011000                    NOP     0

      662     8731    2           CALL KCF$FERDS (LDCT);

   8731  1 000255   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000256   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000257   000443 701000 1                  TSX1    s:8833
         1 000260   000000 011000                    NOP     0
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:95   

      663     8732    2           END;

   8732  1 000261   000271 710000 1                  TRA     s:8737

      664     8733    1         ELSE
      665     8734               %UNLOCK (G=NK$LDCT.LOCK);

   8735  1 000262   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000263   000020 036003                    ADLQ    16,DU
         1 000264   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000265   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000266   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000267   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000270   000000 011000                    NOP     0

      666     8737    1         RETURN;

   8737  1 000271   000000 702200 xent               TSX2  ! X66_ARET

   8732  1 000272                       QFUL         null
      667     8738
      668     8739    1   QFUL: ;
      669     8740        /* Check to see if the error was a trap on the buffer */
      670     8741    1         IF K$RWPARM.ERR = %K$BAD_BUFFER

   8741  1 000272   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000273   000013 235100                    LDA     11,,PR0
         1 000274   000002 115007                    CMPA    2,DL
         1 000275   000310 601000 1                  TNZ     s:8751

      671     8742    2         THEN DO;

      672     8743    2           CALL FIXCURT;

   8743  1 000276   000331 701000 1                  TSX1    FIXCURT
         1 000277   000000 011000                    NOP     0
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:96   

      673     8744                %UNLOCK (G=NK$LDCT.LOCK);

   8745  1 000300   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000301   000020 036003                    ADLQ    16,DU
         1 000302   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000303   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000304   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000305   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000306   000000 011000                    NOP     0

      674     8747    2           RETURN;

   8747  1 000307   000000 702200 xent               TSX2  ! X66_ARET

      675     8748    2           END;
      676     8749
      677     8750        /* Must be queue full */
      678     8751    1         CALL FIXCUR;

   8751  1 000310   000340 701000 1                  TSX1    FIXCUR
         1 000311   000000 011000                    NOP     0

      679     8752    1         LDCT.QFL.WRT='1'B;

   8752  1 000312   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000313   000400 236007                    LDQ     256,DL
         1 000314   000010 256100                    ORSQ    8,,PR0

      680     8753    1         CALL KCF$QFL (LDCT) ALTRET (WRDSC);

   8753  1 000315   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000316   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000317   000000 701000 xent               TSX1    KCF$QFL
         1 000320   000325 702000 1                  TSX2    WRDSC

      681     8754    1         K$RWPARM.ERR=KQGE_PCW#;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:97   

   8754  1 000321   000010 235007                    LDA     8,DL
         1 000322   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000323   000013 755100                    STA     11,,PR0

      682     8755    1         ALTRETURN;

   8755  1 000324   000000 702200 xent               TSX2  ! X66_AALT

   8754  1 000325                       WRDSC        null
      683     8756    1   WRDSC:;
      684     8757    1         K$RWPARM.ERR=KQGE_DISC#;

   8757  1 000325   000006 235007                    LDA     6,DL
         1 000326   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000327   000013 755100                    STA     11,,PR0

   8757  1 000330                       ALTRT        null
      685     8758    1   ALTRT:;
      686     8759    1         ALTRETURN;

   8759  1 000330   000000 702200 xent               TSX2  ! X66_AALT

      687     8760
      688     8761
      689     8762    1   FIXCURT: PROC;

   8762  1 000331   200066 741300       FIXCURT      STX1  ! K$RWPARM_AUTO+40,,AUTO

      690     8763
      691     8764    2         K$RWPARM.ERR=0;

   8764  1 000332   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000333   000013 450100                    STZ     11,,PR0

      692     8765    2         K$RWPARM.TYC=%TYC_MTRAP|%TYC_EGV;

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:98   
   8765  1 000334   000003 236000 0                  LDQ     ERR_NODAT+1
         1 000335   000030 276000 xsym               ORQ     B_VECTNIL+24
         1 000336   000006 756100                    STQ     6,,PR0
         1 000337   000341 710000 1                  TRA     s:8769

      693     8766
      694     8767    2   FIXCUR: ENTRY;

   8767  1 000340   200066 741300       FIXCUR       STX1  ! K$RWPARM_AUTO+40,,AUTO

      695     8768
      696     8769    2         LDCT.TH.MAXNMBBYT=TCUR;

   8769  1 000341   200013 720100                    LXL0    TCUR,,AUTO
         1 000342   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000343   000017 440100                    SXL0    15,,PR0

      697     8770    2         RETURN;

   8770  1 000344   200066 221300                    LDX1  ! K$RWPARM_AUTO+40,,AUTO
         1 000345   000001 702211                    TSX2  ! 1,X1

      698     8771    2   END FIXCURT;
      699     8772        %EJECT;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:99   
      700     8773        /*F* NAME:         KCF$INCMP
      701     8774             PURPOSE:      To tell the FEP that a message has been
      702     8775                           successfully received.
      703     8776             DESCRIPTION:  When we read data directly from the
      704     8777                           circular queue, the FEP can ask for RRR,
      705     8778                           that is, to be notified when we successfully
      706     8779                           receive the data.  Thus this routine is
      707     8780                           called from KCD$RDGO after it stuffs an
      708     8781                           ICQ msg into the comgroup, from KCF$FEIN
      709     8782                           when it does the same, and from KCD$INCMP
      710     8783                           for msgs whose recept acknowlege was delayed
      711     8784                           by the comgroup.
      712     8785
      713     8786                           We send the receipt-acknowlege message to the
      714     8787                           device.*/
      715     8788    1   KCF$INCMP: ENTRY (LDCT,K$RWPARM) ALTRET;

   8788  1 000346   000000 700200 xent  KCF$INCMP    TSX0  ! X66_AUTO_2
         1 000347   000074 000002                    ZERO    60,2

      716     8789
      717     8790    1         K$RWPARM_AUTO = K_RWPARM_CON;

   8790  1 000350   000100 100400                    MLR     fill='000'O
         1 000351   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000352   200016 000234                    ADSC9   K$RWPARM_AUTO,,AUTO      cn=0,n=156

      718     8791    1         K$RWPARM_AUTO.MSGID = K$RWPARM.MSGID;

   8791  1 000353   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000354   000011 235100                    LDA     9,,PR0
         1 000355   200027 755100                    STA     K$RWPARM_AUTO+9,,AUTO

      719     8792    1         K$RWPARM_AUTO.MRKTYP = K$RWPARM.MRKTYP;

   8792  1 000356   000040 236100                    LDQ     32,,PR0
         1 000357   200056 552110                    STBQ    K$RWPARM_AUTO+32,'10'O,AUTO
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:100  

      720     8793    1         K$RWPARM_AUTO.MARKER = K$RWPARM.MARKER;

   8793  1 000360   000007 236100                    LDQ     7,,PR0
         1 000361   200025 756100                    STQ     K$RWPARM_AUTO+7,,AUTO

      721     8794    1         GOTO INCMP;

   8794  1 000362   000373 710000 1                  TRA     INCMP

      722     8795
      723     8796        /*F* NAME:         KCF$INCMPL
      724     8797             PURPOSE:      Same as KCF$INCMP
      725     8798             DESCRIPTION:  Called from KCF$QNF when the OCQ is no longer
      726     8799                           full, and a previous call to KCF$INCMP was
      727     8800                           delayed by a full OCQ.  We send the message. */
      728     8801    1   KCF$INCMPL: ENTRY (LDCT) ALTRET;

   8801  1 000363   000000 700200 xent  KCF$INCMPL   TSX0  ! X66_AUTO_2
         1 000364   000074 000002                    ZERO    60,2

      729     8802
      730     8803    1         K$RWPARM_AUTO = K_RWPARM_CON;

   8803  1 000365   000100 100400                    MLR     fill='000'O
         1 000366   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000367   200016 000234                    ADSC9   K$RWPARM_AUTO,,AUTO      cn=0,n=156

      731     8804    1         K$RWPARM_AUTO.MSGID = LDCT.MSGID;

   8804  1 000370   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000371   000000 235100                    LDA     0,,PR0
         1 000372   200027 755100                    STA     K$RWPARM_AUTO+9,,AUTO

   8804  1 000373                       INCMP        null
      732     8805    1   INCMP:;
      733     8806    1         K$RWPARM_AUTO.MSGIDXT='0'B;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:101  

   8806  1 000373   200030 450100                    STZ     K$RWPARM_AUTO+10,,AUTO

      734     8807              %LOCK (G=NK$LDCT.LOCK);

   8808  1 000374   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000375   000020 036003                    ADLQ    16,DU
         1 000376   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000377   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000400   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000401   000000 701000 xent               TSX1    HFC$LOCK
         1 000402   000000 011000                    NOP     0

      735     8810    1         CALL KIA$FCNO (LDCT,%KV_VDO_FNC_MRK,K$RWPARM_AUTO) ALTRET (QFLI);

   8810  1 000403   200016 630500                    EPPR0   K$RWPARM_AUTO,,AUTO
         1 000404   200072 450500                    STP0    K$RWPARM_AUTO+44,,AUTO
         1 000405   000004 236000 2                  LDQ     4
         1 000406   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000407   200070 757100                    STAQ    K$RWPARM_AUTO+42,,AUTO
         1 000410   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000411   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000412   000000 701000 xent               TSX1    KIA$FCNO
         1 000413   000431 702000 1                  TSX2    QFLI

      736     8811              %UNLOCK (G=NK$LDCT.LOCK);

   8812  1 000414   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000415   000020 036003                    ADLQ    16,DU
         1 000416   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000417   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000421   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000422   000000 011000                    NOP     0

   8806  1 000423                       POUT         null
      737     8814    1   POUT: ;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:102  
      738     8815    2           DO INHIBIT;

      739     8816    2           LDCT.DFLG.PPND='0'B;

   8816  1 000423   200003 470700                    LDP0  ! @NK$LDCT,,AUTO
         1 000424   000005 236200 2                  LDQ   ! 5
         1 000425   000006 356300                    ANSQ  ! 6,,PR0

      740     8817    2           LDCT.IP$ = ADDR(NIL);

   8817  1 000426   000001 236200 xsym               LDQ   ! B_VECTNIL+1
         1 000427   000013 756300                    STQ   ! 11,,PR0

      741     8818    2           END;

      742     8819    1         RETURN;

   8819  1 000430   000000 702200 xent               TSX2  ! X66_ARET

   8816  1 000431                       QFLI         null
      743     8820
      744     8821    1   QFLI: ;
      745     8822    1         LDCT.MSGID=K$RWPARM_AUTO.MSGID;

   8822  1 000431   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000432   200027 235100                    LDA     K$RWPARM_AUTO+9,,AUTO
         1 000433   000000 755100                    STA     0,,PR0

      746     8823    1         LDCT.QFL.INCMP='1'B;

   8823  1 000434   000100 236007                    LDQ     64,DL
         1 000435   000010 256100                    ORSQ    8,,PR0

      747     8824    1         CALL KCF$QFL (LDCT) ALTRET (POUT);

   8824  1 000436   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000437   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:103  
         1 000440   000000 701000 xent               TSX1    KCF$QFL
         1 000441   000423 702000 1                  TSX2    POUT

      748     8825    1         RETURN;

   8825  1 000442   000000 702200 xent               TSX2  ! X66_ARET

      749     8826
      750     8827        /*F* NAME:         KCF$FERDS
      751     8828             PURPOSE:      To issue delayed reads to the FEP
      752     8829                           for comgroup devices
      753     8830             DESCRIPTION:  We perpetually read comgroup devices.
      754     8831                           This routine sends a new read message
      755     8832                           to the FEP whenever appropriate. */
      756     8833    1   KCF$FERDS: ENTRY (LDCT) ALTRET;

   8833  1 000443   000000 700200 xent  KCF$FERDS    TSX0  ! X66_AUTO_2
         1 000444   000074 000002                    ZERO    60,2

      757     8834
      758     8835    1         IF LDCT.LKFLG.ACTIVE='0'B THEN RETURN;

   8835  1 000445   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000446   000011 236100                    LDQ     9,,PR0
         1 000447   000040 316003                    CANQ    32,DU
         1 000450   000452 601000 1                  TNZ     s:8836

   8835  1 000451   000000 702200 xent               TSX2  ! X66_ARET

      759     8836    1         K$RWPARM_AUTO = K_RWPARM_CON;

   8836  1 000452   000100 100400                    MLR     fill='000'O
         1 000453   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000454   200016 000234                    ADSC9   K$RWPARM_AUTO,,AUTO      cn=0,n=156

      760     8837    1         MSIZ=LDCT.CG$->KQ_CG.AUCTL.TRMRDSIZ;

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:104  
   8837  1 000455   000027 471500                    LDP1    23,,PR0
         1 000456   100136 236100                    LDQ     94,,PR1
         1 000457   777777 376007                    ANQ     -1,DL
         1 000460   200005 756100                    STQ     MSIZ,,AUTO

      761     8838    1         CALL KQX$LDASR (LDCT.CG$->DUMMY);

   8838  1 000461   200070 451500                    STP1    K$RWPARM_AUTO+42,,AUTO
         1 000462   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000463   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000464   000000 701000 xent               TSX1    KQX$LDASR
         1 000465   000000 011000                    NOP     0

      762     8839    1         K$RWPARM_AUTO.MAXRCRBYTSIZ=MSIZ;

   8839  1 000466   200005 720100                    LXL0    MSIZ,,AUTO
         1 000467   200060 740100                    STX0    K$RWPARM_AUTO+34,,AUTO

      763     8840        /*N* FOR NOW */
      764     8841    1         K$RWPARM_AUTO.MAXNMBBYT = 32000;

   8841  1 000470   076400 221003                    LDX1    32000,DU
         1 000471   200057 441100                    SXL1    K$RWPARM_AUTO+33,,AUTO

      765     8842    1         K$RWPARM_AUTO.DVE.DVBYTE = LDCT.STA$->KQ_STA.DVBYTE;

   8842  1 000472   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000473   000012 471500                    LDP1    10,,PR0
         1 000474   100023 236100                    LDQ     19,,PR1
         1 000475   000011 736000                    QLS     9
         1 000476   200026 552140                    STBQ    K$RWPARM_AUTO+8,'40'O,AUTO

      766     8843    1         K$RWPARM_AUTO.STR=KIDM_CP;

   8843  1 000477   000001 236007                    LDQ     1,DL
         1 000500   200056 552104                    STBQ    K$RWPARM_AUTO+32,'04'O,AUTO

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:105  
      767     8844    1         IF (LDCT.STA$ = ADDR(NIL)) OR (LDCT.STA$->KQ_STA.MAXRD = 0)

   8844  1 000501   000012 236100                    LDQ     10,,PR0
         1 000502   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000503   000507 600000 1                  TZE     s:8845
         1 000504   000012 471500                    LDP1    10,,PR0
         1 000505   100032 722100                    LXL2    26,,PR1
         1 000506   000513 601000 1                  TNZ     s:8846

      768     8845    1         THEN MAXRD = LDCT.CG$->KQ_CG.AUCTL.MAXRD; /* CG DEFAULTS */

   8845  1 000507   000027 471500                    LDP1    23,,PR0
         1 000510   100140 722100                    LXL2    96,,PR1
         1 000511   200012 742100                    STX2    MAXRD,,AUTO
         1 000512   000514 710000 1                  TRA     s:8848

      769     8846    1         ELSE MAXRD = LDCT.STA$->KQ_STA.MAXRD; /*STATION SPECIFICS*/

   8846  1 000513   200012 742100                    STX2    MAXRD,,AUTO

      770     8847              %LOCK (G=NK$LDCT.LOCK);

   8848  1 000514   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000515   000020 036003                    ADLQ    16,DU
         1 000516   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000517   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000520   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000521   000000 701000 xent               TSX1    HFC$LOCK
         1 000522   000000 011000                    NOP     0

      771     8850    1         IF NOT LDCT.DFLG.INPUT THEN

   8850  1 000523   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000524   000006 236100                    LDQ     6,,PR0
         1 000525   400000 316007                    CANQ    -131072,DL
         1 000526   000532 601000 1                  TNZ     s:8853

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:106  
      772     8851    1          K$RWPARM_AUTO.MAXNMBRCR=0;

   8851  1 000527   000000 220003                    LDX0    0,DU
         1 000530   200057 740100                    STX0    K$RWPARM_AUTO+33,,AUTO
         1 000531   000547 710000 1                  TRA     s:8857

      773     8852    2         ELSE DO;

      774     8853    2           IF (LDCT.RDSOUT >0) THEN

   8853  1 000532   000007 236100                    LDQ     7,,PR0
         1 000533   770000 316003                    CANQ    -4096,DU
         1 000534   000537 600000 1                  TZE     s:8855

      775     8854    2            K$RWPARM_AUTO.VDOFLGS.INCNMBRCR = '1'B;

   8854  1 000535   000004 236003                    LDQ     4,DU
         1 000536   200056 256100                    ORSQ    K$RWPARM_AUTO+32,,AUTO

      776     8855    2           K$RWPARM_AUTO.MAXNMBRCR = MAXRD - LDCT.RDSOUT;

   8855  1 000537   000007 236100                    LDQ     7,,PR0
         1 000540   000036 772000                    QRL     30
         1 000541   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000542   200012 236100                    LDQ     MAXRD,,AUTO
         1 000543   000022 772000                    QRL     18
         1 000544   200070 136100                    SBLQ    K$RWPARM_AUTO+42,,AUTO
         1 000545   000000 620006                    EAX0    0,QL
         1 000546   200057 740100                    STX0    K$RWPARM_AUTO+33,,AUTO

      777     8856    2           END;

      778     8857    1         CALL KIA$FCNO (LDCT,%KV_VDO_FNC_RQSDAT,K$RWPARM_AUTO) ALTRET (QFULR);

   8857  1 000547   200016 631500                    EPPR1   K$RWPARM_AUTO,,AUTO
         1 000550   200072 451500                    STP1    K$RWPARM_AUTO+44,,AUTO
         1 000551   000007 236000 2                  LDQ     7
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:107  
         1 000552   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000553   200070 757100                    STAQ    K$RWPARM_AUTO+42,,AUTO
         1 000554   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000555   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000556   000000 701000 xent               TSX1    KIA$FCNO
         1 000557   000601 702000 1                  TSX2    QFULR

      779     8858    1         LDCT.RDSOUT=LDCT.RDSOUT + K$RWPARM_AUTO.MAXNMBRCR;

   8858  1 000560   200057 235100                    LDA     K$RWPARM_AUTO+33,,AUTO
         1 000561   000022 771000                    ARL     18
         1 000562   200070 755100                    STA     K$RWPARM_AUTO+42,,AUTO
         1 000563   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000564   000007 236100                    LDQ     7,,PR0
         1 000565   000036 772000                    QRL     30
         1 000566   200070 036100                    ADLQ    K$RWPARM_AUTO+42,,AUTO
         1 000567   000036 736000                    QLS     30
         1 000570   000007 752140                    STCQ    7,'40'O,PR0

      780     8859              %UNLOCK (G=NK$LDCT.LOCK);

   8860  1 000571   200003 236100                    LDQ     @NK$LDCT,,AUTO
         1 000572   000020 036003                    ADLQ    16,DU
         1 000573   200070 756100                    STQ     K$RWPARM_AUTO+42,,AUTO
         1 000574   200070 630500                    EPPR0   K$RWPARM_AUTO+42,,AUTO
         1 000575   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000576   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000577   000000 011000                    NOP     0

      781     8862    1         RETURN;

   8862  1 000600   000000 702200 xent               TSX2  ! X66_ARET

   8858  1 000601                       QFULR        null
      782     8863
      783     8864    1   QFULR:;
      784     8865    1         LDCT.QFL.RD='1'B;
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:108  

   8865  1 000601   200003 470500                    LDP0    @NK$LDCT,,AUTO
         1 000602   000200 236007                    LDQ     128,DL
         1 000603   000010 256100                    ORSQ    8,,PR0

      785     8866    1         CALL KCF$QFL (LDCT);

   8866  1 000604   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000605   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000606   000000 701000 xent               TSX1    KCF$QFL
         1 000607   000000 011000                    NOP     0

      786     8867    1         RETURN;

   8867  1 000610   000000 702200 xent               TSX2  ! X66_ARET

ERR_BADSTA
 Sect OctLoc
   0     000   130306 016002                                                    X...

ERR_BADMSGTYP
 Sect OctLoc
   0     001   130306 015772                                                    X...

ERR_NODAT
 Sect OctLoc
   0     002   130306 021002                                                    X...

(unnamed)
 Sect OctLoc
   0     003   000100 000000                                                    .@..

(unnamed)
 Sect OctLoc
   2     000   000007 006000   737777 777777   777757 777777   000000 000037    ................
   2     004   000003 006000   777777 777737   000000 000026   000006 006000    ................
      787     8868
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:109  
      788     8869    1   END;
      789     8870
      790     8871
      791     8872        %EOD;

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:110  
--  Include file information  --

   F_MACROS_C.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KC_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$FEWRT.
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:111  

 **** Variables and constants ****

  ****  Section 000 RoData KCF$FEWRT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b STRC        r     1 ERR_BADMSGTYP              0-0-0/b STRC        r     1 ERR_BADSTA
     2-0-0/b STRC        r     1 ERR_NODAT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @K$RWPARM                  3-0-0/w PTR         r     1 @NK$LDCT
     7-0-0/b BIT         r     1 ERROR                     14-0-0/w UBIN        r     1 FEX
    *0-0-0/d STRC(1404)  r     1 K$RWPARM                  16-0-0/d STRC(1404)  r     1 K$RWPARM_AUTO
    12-0-0/w UBIN(18)    r     1 MAXRD                      5-0-0/w UBIN        r     1 MSIZ
    *0-0-0/d STRC(864)   r     1 NK$LDCT                   13-0-0/w SBIN        r     1 TCUR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1404)  r     1 K_RWPARM_CON

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 DUMMY                      0-0-0/d STRC(6516)  r     1 KQ_CG
     0-0-0/d STRC(1296)  r     1 KQ_STA

PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:112  

   Procedure KCF$FEWRT requires 393 words for executable code.
   Procedure KCF$FEWRT requires 60 words of local(AUTO) storage.
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:113  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:114  
          MINI XREF LISTING

BUF$
      8274**DCL      8275--REDEF
DUMMY
      8247**DCL      8838<>CALL
ERROK
      8678**LABEL    8676--GOTO     8707--GOTO
ERROR
      8280**DCL      8647<<ASSIGN   8650>>ASSIGN   8668<<ASSIGN   8671<<ASSIGN
ERR_BADMSGTYP
      8616**DCL      8668>>ASSIGN
ERR_BADSTA
      8612**DCL      8647>>ASSIGN
ERR_NODAT
      8620**DCL      8671>>ASSIGN
FEX
      8285**DCL      8642<<ASSIGN
FIXCUR IN PROCEDURE FIXCURT
      8767**ENTRY    8751--CALL
FIXCURT
      8762**PROC     8743--CALL
HFC$LOCK
      3399**DCL-ENT  8652--CALL     8683--CALL     8808--CALL     8848--CALL
HFC$UNLOCK
      3399**DCL-ENT  8665--CALL     8694--CALL     8705--CALL     8729--CALL     8735--CALL     8745--CALL
      8812--CALL     8860--CALL
INAC
      8694**LABEL    8641--GOTO     8674--GOTO
INCMP
      8804**LABEL    8794--GOTO
K$RWPARM
      6567**DCL        32--PROC     8688<>CALL     8788--ENTRY
K$RWPARM.BLKREC
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:115  
      6593**DCL      6618--REDEF
K$RWPARM.BLKREC.BLKU#
      6594**DCL      6596--REDEF
K$RWPARM.BLKREC.RECU#
      6606**DCL      6608--REDEF
K$RWPARM.DVE.DVBYTE.RRR
      6637**DCL      8685>>IF
K$RWPARM.DVE.DVBYTE.VFC
      6633**DCL      6634--REDEF
K$RWPARM.DVE.EOMCHAR
      6641**DCL      6645--REDEF
K$RWPARM.DVE.VFC
      6645**DCL      8723>>IF
K$RWPARM.ERR
      6705**DCL      6710--REDEF    8643>>IF       8645>>DOCASE   8658<<ASSIGN   8681<<ASSIGN   8691>>IF
      8697<<ASSIGN   8710<<ASSIGN   8716>>IF       8719<<ASSIGN   8741>>IF       8754<<ASSIGN   8757<<ASSIGN
      8764<<ASSIGN
K$RWPARM.FC
      6669**DCL      6670--REDEF
K$RWPARM.FLDID
      6851**DCL      6852--REDEF
K$RWPARM.FPT$
      6732**DCL      6739--REDEF
K$RWPARM.KEYTYPE
      6858**DCL      6859--REDEF
K$RWPARM.MARKER
      6618**DCL      8793>>ASSIGN
K$RWPARM.MRKTYP
      6843**DCL      8687<<ASSIGN   8792>>ASSIGN
K$RWPARM.MSG$
      6568**DCL      6574--REDEF
K$RWPARM.MSGID
      6680**DCL      6685--REDEF    8791>>ASSIGN
K$RWPARM.MSGIDXT
      6693**DCL      6697--REDEF
K$RWPARM.ORG
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:116  
      6829**DCL      6830--REDEF
K$RWPARM.THDRSZ
      6773**DCL      6777--REDEF
K$RWPARM.TYC
      6589**DCL      8765<<ASSIGN
K$RWPARM.VDOFLGS
      6831**DCL      6842--REDEF
K$RWPARM_AUTO
      8307**DCL      8649<<ASSIGN   8663<>CALL     8790<<ASSIGN   8803<<ASSIGN   8810<>CALL     8836<<ASSIGN
      8857<>CALL
K$RWPARM_AUTO.BLKREC
      8333**DCL      8358--REDEF
K$RWPARM_AUTO.BLKREC.BLKU#
      8334**DCL      8336--REDEF
K$RWPARM_AUTO.BLKREC.RECU#
      8346**DCL      8348--REDEF
K$RWPARM_AUTO.DVE.DVBYTE
      8365**DCL      8842<<ASSIGN
K$RWPARM_AUTO.DVE.DVBYTE.VFC
      8373**DCL      8374--REDEF
K$RWPARM_AUTO.DVE.EOMCHAR
      8381**DCL      8385--REDEF
K$RWPARM_AUTO.ERR
      8445**DCL      8450--REDEF
K$RWPARM_AUTO.FC
      8409**DCL      8410--REDEF
K$RWPARM_AUTO.FLDID
      8591**DCL      8592--REDEF
K$RWPARM_AUTO.FPT$
      8472**DCL      8479--REDEF
K$RWPARM_AUTO.KEYTYPE
      8598**DCL      8599--REDEF
K$RWPARM_AUTO.MARKER
      8358**DCL      8793<<ASSIGN
K$RWPARM_AUTO.MAXNMBBYT
      8586**DCL      8841<<ASSIGN
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:117  
K$RWPARM_AUTO.MAXNMBRCR
      8585**DCL      8851<<ASSIGN   8855<<ASSIGN   8858>>ASSIGN
K$RWPARM_AUTO.MAXRCRBYTSIZ
      8587**DCL      8839<<ASSIGN
K$RWPARM_AUTO.MRKTYP
      8583**DCL      8792<<ASSIGN
K$RWPARM_AUTO.MSG$
      8308**DCL      8314--REDEF
K$RWPARM_AUTO.MSGID
      8420**DCL      8425--REDEF    8791<<ASSIGN   8804<<ASSIGN   8822>>ASSIGN
K$RWPARM_AUTO.MSGIDXT
      8433**DCL      8437--REDEF    8806<<ASSIGN
K$RWPARM_AUTO.MSG_ERRCODE
      8568**DCL      8650<<ASSIGN
K$RWPARM_AUTO.ORG
      8569**DCL      8570--REDEF
K$RWPARM_AUTO.STR
      8584**DCL      8843<<ASSIGN
K$RWPARM_AUTO.THDRSZ
      8513**DCL      8517--REDEF
K$RWPARM_AUTO.VDOFLGS
      8571**DCL      8582--REDEF
K$RWPARM_AUTO.VDOFLGS.INCNMBRCR
      8580**DCL      8854<<ASSIGN
KCF$FERDS
      8833**ENTRY    8731--CALL
KCF$QFL
      8630**DCL-ENT  8711--CALL     8753--CALL     8824--CALL     8866--CALL
KIA$FCNO
      8631**DCL-ENT  8663--CALL     8810--CALL     8857--CALL
KIA$WRITE
      8634**DCL-ENT  8688--CALL
KQX$LDASR
      8632**DCL-ENT  8838--CALL
KQ_CG.AUCTL.DVBYTE.REREAD
      7326**DCL      7327--REDEF
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:118  
KQ_CG.AUCTL.MAXRD
      7332**DCL      8845>>ASSIGN
KQ_CG.AUCTL.TRMRDSIZ
      7331**DCL      8837>>ASSIGN
KQ_STA.ACTTYC
      7673**DCL      7677--REDEF
KQ_STA.DCBLNK$
      7680**DCL      7683--REDEF    7687--REDEF
KQ_STA.DVBYTE
      7772**DCL      8842>>ASSIGN
KQ_STA.EVCNT
      7766**DCL      7769--REDEF
KQ_STA.EVNT
      7732**DCL      7736--REDEF    7739--REDEF
KQ_STA.MAXRD
      7868**DCL      8844>>IF       8846>>ASSIGN
KQ_STA.OPNBLKED
      7793**DCL      7796--REDEF
KQ_STA.OPNREJ
      7799**DCL      7801--REDEF
KQ_STA.SUCCREAD
      7722**DCL      7726--REDEF
KQ_STA.TCOUNT
      7851**DCL      7857--REDEF
KQ_STA.VGOT$
      7836**DCL      7840--REDEF    7844--REDEF
K_RWPARM_CON
      5075**DCL      8649>>ASSIGN   8790>>ASSIGN   8803>>ASSIGN   8836>>ASSIGN
K_RWPARM_CON.BLKREC
      5101**DCL      5126--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      5102**DCL      5104--REDEF
K_RWPARM_CON.BLKREC.RECU#
      5114**DCL      5116--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      5141**DCL      5142--REDEF
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:119  
K_RWPARM_CON.DVE.EOMCHAR
      5149**DCL      5153--REDEF
K_RWPARM_CON.ERR
      5213**DCL      5218--REDEF
K_RWPARM_CON.FC
      5177**DCL      5178--REDEF
K_RWPARM_CON.FLDID
      5359**DCL      5360--REDEF
K_RWPARM_CON.FPT$
      5240**DCL      5247--REDEF
K_RWPARM_CON.KEYTYPE
      5366**DCL      5367--REDEF
K_RWPARM_CON.MSG$
      5076**DCL      5082--REDEF
K_RWPARM_CON.MSGID
      5188**DCL      5193--REDEF
K_RWPARM_CON.MSGIDXT
      5201**DCL      5205--REDEF
K_RWPARM_CON.ORG
      5337**DCL      5338--REDEF
K_RWPARM_CON.THDRSZ
      5281**DCL      5285--REDEF
K_RWPARM_CON.VDOFLGS
      5339**DCL      5350--REDEF
MAXRD
      8283**DCL      8845<<ASSIGN   8846<<ASSIGN   8855>>ASSIGN
MSIZ
      8270**DCL      8263--IMP-SIZ  8271--REDEF    8837<<ASSIGN   8839>>ASSIGN
NK$LDCT
      6513**DCL        32--PROC     8663<>CALL     8688<>CALL     8711<>CALL     8731<>CALL     8753<>CALL
      8788--ENTRY    8801--ENTRY    8810<>CALL     8824<>CALL     8833--ENTRY    8857<>CALL     8866<>CALL
NK$LDCT.CG$
      6544**DCL      8837>>ASSIGN   8838>>CALL     8845>>ASSIGN
NK$LDCT.DDT$
      6515**DCL      6515--REDEF
NK$LDCT.DFLG.INPUT
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:120  
      6517**DCL      8727<<ASSIGN   8727>>ASSIGN   8850>>IF
NK$LDCT.DFLG.PPND
      6521**DCL      8816<<ASSIGN
NK$LDCT.IOQ$
      6514**DCL      6515--REDEF
NK$LDCT.IP$
      6535**DCL      8817<<ASSIGN
NK$LDCT.LDCTX
      6516**DCL      6516--REDEF
NK$LDCT.LKFLG.ABORTED
      6528**DCL      6529--REDEF
NK$LDCT.LKFLG.ACTIVE
      6532**DCL      8641>>IF       8835>>IF
NK$LDCT.LKFLG.INTOGGLE
      6532**DCL      8723>>IF       8726<<ASSIGN
NK$LDCT.LKFLG.OBLK
      6528**DCL      8659<<ASSIGN   8720<<ASSIGN
NK$LDCT.LKFLG.QNFL
      6529**DCL      8701>>IF       8703<<ASSIGN
NK$LDCT.LOCK
      6541**DCL      8652<>CALL     8665<>CALL     8683<>CALL     8694<>CALL     8705<>CALL     8729<>CALL
      8735<>CALL     8745<>CALL     8808<>CALL     8812<>CALL     8848<>CALL     8860<>CALL
NK$LDCT.MSGID
      6513**DCL      8804>>ASSIGN   8822<<ASSIGN
NK$LDCT.QFL.INCMP
      6526**DCL      8823<<ASSIGN
NK$LDCT.QFL.RD
      6525**DCL      8865<<ASSIGN
NK$LDCT.QFL.WRT
      6525**DCL      8709<<ASSIGN   8752<<ASSIGN
NK$LDCT.RDSOUT
      6522**DCL      8853>>IF       8855>>ASSIGN   8858<<ASSIGN   8858>>ASSIGN
NK$LDCT.RESCOD
      6521**DCL      8657>>IF       8718>>IF
NK$LDCT.RLCID.LDCTX
      6538**DCL      6538--REDEF
PL6.E3A0      #002=KCF$FEWRT File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:13 Page:121  
NK$LDCT.RLCID.NODE
      6537**DCL      8642>>ASSIGN
NK$LDCT.STA$
      6534**DCL      6535--REDEF    8842>>ASSIGN   8844>>IF       8844>>IF       8846>>ASSIGN
NK$LDCT.SYMB$
      6513**DCL      6513--REDEF    6513--REDEF    6514--REDEF
NK$LDCT.TH.MAXNMBBYT
      6540**DCL      8661>>ASSIGN   8662<<ASSIGN   8769<<ASSIGN
NK$LDCT.TH.MAXNMBRCR
      6539**DCL      8716>>IF
POUT
      8806**LABEL    8824--CALLALT
QFLI
      8816**LABEL    8810--CALLALT
QFUL
      8732**LABEL    8663--CALLALT
QFULR
      8858**LABEL    8857--CALLALT
SEND_ERRDAT
      8647**LABEL    8669--GOTO     8672--GOTO
TCUR
      8284**DCL      8661<<ASSIGN   8769>>ASSIGN
WRDSC
      8754**LABEL    8711--CALLALT  8753--CALLALT

PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:122  
      792        1        /*T***********************************************************/
      793        2        /*T*                                                         */
      794        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      795        4        /*T*                                                         */
      796        5        /*T***********************************************************/
      797        6        /*F* NAME:         KCF$CHKLDTKL
      798        7             PURPOSE:      To validate a device
      799        8             DESCRIPTION:  Called from various places.  Ensures that
      800        9                           the device is active and is still on the
      801       10                           passed comgroup as the passed station name. */
      802       11        KCF$CKLDTKL: PROC (NK$LDCT,CG$,STATION) ALTRET;
      803       12
      804       13
      805       14        /* INCLUDES */
      806       15
      807       16        %INCLUDE NK$LDCT;
      808      118        %INCLUDE HF_LOCK_C;
      809      132        %INCLUDE NK_SUBS;
      810      157        %INCLUDE K_DATA_R;
      811      868
      812      869
      813      870
      814      871
      815      872        /* PARAMETERS */
      816      873
      817      874        %NK$LDCT (STCLASS="");
      818      920    1   DCL CG$ PTR;
      819      921    1   DCL STATION CHAR(8);
      820      922
      821      923
      822      924
      823      925
      824      926        /* AUTO */
      825      927
      826      928    1   DCL FEX UBIN WORD;
      827      929
      828      930
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:123  
      829      931
      830      932
      831      933        /* REFS */
      832      934
      833      935    1   DCL SSS$CACHE     ENTRY;
      834      936    1   DCL SSS$CACHEBP   ENTRY;
      835      937
      836      938
      837      939
      838      940    1         CALL CHK ALTRET (AOUT);
      839      941    1         RETURN;
      840      942
      841      943        /*F* NAME:         KCF$QFL
      842      944             PURPOSE:      To 'block' an LDCT for output circular queue full
      843      945             DESCRIPTION:  Called when somebody wants to write something
      844      946                           thru the OCQ but it's full.  Puts the LDCT on
      845      947                           a chain of guys waiting for same.  KCF$QNF will
      846      948                           run this chain and give each guy another shot
      847      949                           at sending his message when the queue empties. */
      848      950    1   KCF$QFL: ENTRY (LDCT) ALTRET;
      849      951
      850      952    1         IF LDCT.DFLG.FEDN THEN GOTO AOUT;
      851      953    1         IF LDCT.LKFLG.QFL='0'B THEN
      852      954    2           DO;
      853      955    2           LDCT.LKFLG.QFL='1'B;
      854      956    2           END;
      855      957    1   ROUT: ;
      856      958              %UNLOCK (G=NK$LDCT.LOCK);
      857      961    1         RETURN;
      858      962    1   AOUT: ;
      859      963              %UNLOCK (G=NK$LDCT.LOCK);
      860      966    1         ALTRETURN;
      861      967
      862      968
      863      969    1   CHK:  PROC ALTRET;
      864      970
      865      971              %LOCK (G=NK$LDCT.LOCK);
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:124  
      866      974    2         IF LDCT.LKFLG.ACTIVE='0'B
      867      975    2         OR LDCT.CG$~=CG$
      868      976    2         OR LDCT.DEVNM~=STATION
      869      977    2         THEN ALTRETURN;
      870      978    2         RETURN;
      871      979    2   END;
      872      980
      873      981    1   END;
      874      982
      875      983
      876      984        %EOD;

PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:125  
--  Include file information  --

   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NK_SUBS.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$CKLDTKL.

   Procedure KCF$CKLDTKL requires 57 words for executable code.
   Procedure KCF$CKLDTKL requires 12 words of local(AUTO) storage.

PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:126  

 Object Unit name= KCF$CKLDTKL                                File name= KCF$CGFE.:E05TOU
 UTS= JUL 30 '97 00:13:56.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    57     71  KCF$CKLDTKL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        3  KCF$CKLDTKL
     0      5          yes     yes      Std        1  KCF$QFL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$UNLOCK
         yes           Std       1 HFC$LOCK
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:127  


      792        1        /*T***********************************************************/
      793        2        /*T*                                                         */
      794        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      795        4        /*T*                                                         */
      796        5        /*T***********************************************************/
      797        6        /*F* NAME:         KCF$CHKLDTKL
      798        7             PURPOSE:      To validate a device
      799        8             DESCRIPTION:  Called from various places.  Ensures that
      800        9                           the device is active and is still on the
      801       10                           passed comgroup as the passed station name. */
      802       11        KCF$CKLDTKL: PROC (NK$LDCT,CG$,STATION) ALTRET;

     11  0 000000   000000 700200 xent  KCF$CKLDTKL  TSX0  ! X66_AUTO_3
         0 000001   000014 000003                    ZERO    12,3

      803       12
      804       13
      805       14        /* INCLUDES */
      806       15
      807       16        %INCLUDE NK$LDCT;
      808      118        %INCLUDE HF_LOCK_C;
      809      132        %INCLUDE NK_SUBS;
      810      157        %INCLUDE K_DATA_R;
      811      868
      812      869
      813      870
      814      871
      815      872        /* PARAMETERS */
      816      873
      817      874        %NK$LDCT (STCLASS="");
      818      920    1   DCL CG$ PTR;
      819      921    1   DCL STATION CHAR(8);
      820      922
      821      923
      822      924
      823      925
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:128  
      824      926        /* AUTO */
      825      927
      826      928    1   DCL FEX UBIN WORD;
      827      929
      828      930
      829      931
      830      932
      831      933        /* REFS */
      832      934
      833      935    1   DCL SSS$CACHE     ENTRY;
      834      936    1   DCL SSS$CACHEBP   ENTRY;
      835      937
      836      938
      837      939
      838      940    1         CALL CHK ALTRET (AOUT);

    940  0 000002   000040 701000 0                  TSX1    CHK
         0 000003   000030 702000 0                  TSX2    AOUT

      839      941    1         RETURN;

    941  0 000004   000000 702200 xent               TSX2  ! X66_ARET

      840      942
      841      943        /*F* NAME:         KCF$QFL
      842      944             PURPOSE:      To 'block' an LDCT for output circular queue full
      843      945             DESCRIPTION:  Called when somebody wants to write something
      844      946                           thru the OCQ but it's full.  Puts the LDCT on
      845      947                           a chain of guys waiting for same.  KCF$QNF will
      846      948                           run this chain and give each guy another shot
      847      949                           at sending his message when the queue empties. */
      848      950    1   KCF$QFL: ENTRY (LDCT) ALTRET;

    950  0 000005   000000 700200 xent  KCF$QFL      TSX0  ! X66_AUTO_3
         0 000006   000014 000003                    ZERO    12,3

      849      951
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:129  
      850      952    1         IF LDCT.DFLG.FEDN THEN GOTO AOUT;

    952  0 000007   200003 470500                    LDP0    @NK$LDCT,,AUTO
         0 000010   000006 236100                    LDQ     6,,PR0
         0 000011   000020 316007                    CANQ    16,DL
         0 000012   000030 601000 0                  TNZ     AOUT

      851      953    1         IF LDCT.LKFLG.QFL='0'B THEN

    953  0 000013   000011 236100                    LDQ     9,,PR0
         0 000014   000100 316003                    CANQ    64,DU
         0 000015   000020 601000 0                  TNZ     ROUT

      852      954    2           DO;

      853      955    2           LDCT.LKFLG.QFL='1'B;

    955  0 000016   000100 236003                    LDQ     64,DU
         0 000017   000011 256100                    ORSQ    9,,PR0

      854      956    2           END;

    953  0 000020                       ROUT         null
      855      957    1   ROUT: ;
      856      958              %UNLOCK (G=NK$LDCT.LOCK);

    959  0 000020   200003 236100                    LDQ     @NK$LDCT,,AUTO
         0 000021   000020 036003                    ADLQ    16,DU
         0 000022   200012 756100                    STQ     @STATION+5,,AUTO
         0 000023   200012 630500                    EPPR0   @STATION+5,,AUTO
         0 000024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000025   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000026   000000 011000                    NOP     0

      857      961    1         RETURN;

    961  0 000027   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:130  

    953  0 000030                       AOUT         null
      858      962    1   AOUT: ;
      859      963              %UNLOCK (G=NK$LDCT.LOCK);

    964  0 000030   200003 236100                    LDQ     @NK$LDCT,,AUTO
         0 000031   000020 036003                    ADLQ    16,DU
         0 000032   200012 756100                    STQ     @STATION+5,,AUTO
         0 000033   200012 630500                    EPPR0   @STATION+5,,AUTO
         0 000034   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000035   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000036   000000 011000                    NOP     0

      860      966    1         ALTRETURN;

    966  0 000037   000000 702200 xent               TSX2  ! X66_AALT

      861      967
      862      968
      863      969    1   CHK:  PROC ALTRET;

    969  0 000040   200010 741300       CHK          STX1  ! @STATION+3,,AUTO

      864      970
      865      971              %LOCK (G=NK$LDCT.LOCK);

    972  0 000041   200003 236100                    LDQ     @NK$LDCT,,AUTO
         0 000042   000020 036003                    ADLQ    16,DU
         0 000043   200012 756100                    STQ     @STATION+5,,AUTO
         0 000044   200012 630500                    EPPR0   @STATION+5,,AUTO
         0 000045   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000046   000000 701000 xent               TSX1    HFC$LOCK
         0 000047   000000 011000                    NOP     0

      866      974    2         IF LDCT.LKFLG.ACTIVE='0'B

    974  0 000050   200003 470500                    LDP0    @NK$LDCT,,AUTO
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:131  
         0 000051   000011 236100                    LDQ     9,,PR0
         0 000052   000040 316003                    CANQ    32,DU
         0 000053   000065 600000 0                  TZE     s:977
         0 000054   200004 471500                    LDP1    @CG$,,AUTO
         0 000055   000027 236100                    LDQ     23,,PR0
         0 000056   100000 116100                    CMPQ    0,,PR1
         0 000057   000065 601000 0                  TNZ     s:977
         0 000060   200005 473500                    LDP3    @STATION,,AUTO
         0 000061   040100 106500                    CMPC    fill='040'O
         0 000062   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         0 000063   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         0 000064   000067 600000 0                  TZE     s:978

      867      975    2         OR LDCT.CG$~=CG$
      868      976    2         OR LDCT.DEVNM~=STATION
      869      977    2         THEN ALTRETURN;

    977  0 000065   200010 221300                    LDX1  ! @STATION+3,,AUTO
         0 000066   000000 702211                    TSX2  ! 0,X1

      870      978    2         RETURN;

    978  0 000067   200010 221300                    LDX1  ! @STATION+3,,AUTO
         0 000070   000001 702211                    TSX2  ! 1,X1
      871      979    2   END;
      872      980
      873      981    1   END;
      874      982
      875      983
      876      984        %EOD;

PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:132  
--  Include file information  --

   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NK_SUBS.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$CKLDTKL.
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:133  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CG$                       3-0-0/w PTR         r     1 @NK$LDCT
     5-0-0/w PTR         r     1 @STATION                  *0-0-0/w PTR         r     1 CG$
    *0-0-0/d STRC(864)   r     1 NK$LDCT                   *0-0-0/c CHAR(8)     r     1 STATION


   Procedure KCF$CKLDTKL requires 57 words for executable code.
   Procedure KCF$CKLDTKL requires 12 words of local(AUTO) storage.
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:134  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:135  
          MINI XREF LISTING

AOUT
       953**LABEL     940--CALLALT   952--GOTO
CG$
       920**DCL        11--PROC      974>>IF
CHK
       969**PROC      940--CALL
HFC$LOCK
       131**DCL-ENT   972--CALL
HFC$UNLOCK
       131**DCL-ENT   959--CALL      964--CALL
K_RWPARM_CON.BLKREC
       598**DCL       623--REDEF
K_RWPARM_CON.BLKREC.BLKU#
       599**DCL       601--REDEF
K_RWPARM_CON.BLKREC.RECU#
       611**DCL       613--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
       638**DCL       639--REDEF
K_RWPARM_CON.DVE.EOMCHAR
       646**DCL       650--REDEF
K_RWPARM_CON.ERR
       710**DCL       715--REDEF
K_RWPARM_CON.FC
       674**DCL       675--REDEF
K_RWPARM_CON.FLDID
       856**DCL       857--REDEF
K_RWPARM_CON.FPT$
       737**DCL       744--REDEF
K_RWPARM_CON.KEYTYPE
       863**DCL       864--REDEF
K_RWPARM_CON.MSG$
       573**DCL       579--REDEF
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:136  
K_RWPARM_CON.MSGID
       685**DCL       690--REDEF
K_RWPARM_CON.MSGIDXT
       698**DCL       702--REDEF
K_RWPARM_CON.ORG
       834**DCL       835--REDEF
K_RWPARM_CON.THDRSZ
       778**DCL       782--REDEF
K_RWPARM_CON.VDOFLGS
       836**DCL       847--REDEF
NK$LDCT
       887**DCL        11--PROC      950--ENTRY
NK$LDCT.CG$
       918**DCL       974>>IF
NK$LDCT.DDT$
       889**DCL       889--REDEF
NK$LDCT.DEVNM
       889**DCL       974>>IF
NK$LDCT.DFLG.FEDN
       895**DCL       952>>IF
NK$LDCT.IOQ$
       888**DCL       889--REDEF
NK$LDCT.LDCTX
       890**DCL       890--REDEF
NK$LDCT.LKFLG.ABORTED
       902**DCL       903--REDEF
NK$LDCT.LKFLG.ACTIVE
       906**DCL       974>>IF
NK$LDCT.LKFLG.QFL
       906**DCL       953>>IF        955<<ASSIGN
NK$LDCT.LOCK
       915**DCL       959<>CALL      964<>CALL      972<>CALL
NK$LDCT.RLCID.LDCTX
       912**DCL       912--REDEF
NK$LDCT.STA$
       908**DCL       909--REDEF
PL6.E3A0      #003=KCF$CKLDTKL File=KCF$CGFE.:E05TSI                             WED 07/30/97 00:13 Page:137  
NK$LDCT.SYMB$
       887**DCL       887--REDEF     887--REDEF     888--REDEF
STATION
       921**DCL        11--PROC      974>>IF

PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:138  
      877        1        /*T***********************************************************/
      878        2        /*T*                                                         */
      879        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      880        4        /*T*                                                         */
      881        5        /*T***********************************************************/
      882        6
      883        7        /*F* NAME:         KCF$QNF
      884        8             PURPOSE:      To process the output circular queue becoming
      885        9                           no longer full.
      886       10             DESCRIPTION:  Called from KIA$ISCAN when the OCQ is deemed
      887       11                           to have some space.  We run the chain of LDCTs
      888       12                           'blocked' for the OCQ, calling some routine
      889       13                           based on the 'block' code in each. */
      890       14
      891       15        KCF$QNF: PROC (NK$LDCT);
      892       16
      893       17
      894       18
      895       19
      896       20
      897       21        /* INCLUDES */
      898       22
      899       23        %INCLUDE NK$LDCT;
      900      125        %INCLUDE K_DATA_R;
      901      836        %INCLUDE NK_SUBS;
      902      861        %INCLUDE KV$VDO;
      903     1876        %INCLUDE FOM_SUBS_C;
      904     1939        %KV_VDO_ALL_E;
      905     2018
      906     2019
      907     2020
      908     2021
      909     2022        /* PARAMETERS */
      910     2023
      911     2024
      912     2025        %NK$LDCT (STCLASS="");
      913     2071
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:139  
      914     2072
      915     2073
      916     2074
      917     2075        /* AUTO */
      918     2076
      919     2077    1   DCL ROUTINE EPTR;
      920     2078    1   DCL FOM$SYMBIN     ENTRY(3) ALTRET;
      921     2079    1   DCL KCD$CLDQ      ENTRY(1);
      922     2080    1   DCL KCD$PREL      ENTRY(1);
      923     2081    1   DCL KCD$RELTRM    ENTRY(1);
      924     2082    1   DCL KCF$FERDS     ENTRY(1) ALTRET;
      925     2083    1   DCL KCF$INCMPL    ENTRY(1) ALTRET;
      926     2084    1   DCL KQG$PCW       ENTRY(1) ALTRET;
      927     2085    1   DCL KQP$PCG       ENTRY(1) ALTRET;
      928     2086    1   DCL SSS$CACHE     ENTRY;
      929     2087    1   DCL SSS$CACHEBP   ENTRY;
      930     2088
      931     2089
      932     2090    1         IF NK$LDCT.QFL='0'B THEN
      933     2091    2           DO;
      934     2092    2           NK$LDCT.LKFLG.QNFL = '1'B;
      935     2093    2           RETURN;
      936     2094    2           END;
      937     2095    1         NK$LDCT.LKFLG.QFL = '0'B;
      938     2096    1         ROUTINE=ENTADDR(NIL);
      939     2097    1         IF NK$LDCT.DFLG.SYMBIONT AND NK$LDCT.QFL.WRT
      940     2098    2         THEN DO;
      941     2099    2           CALL FOM$SYMBIN (NK$LDCT,,FOMI_FNC_RQSDAT#);
      942     2100    2           NK$LDCT.QFL.WRT = '0'B;
      943     2101    2           END;
      944     2102    1         IF NK$LDCT.QFL.RLS THEN
      945     2103    2           DO;
      946     2104    2           NK$LDCT.QFL='0'B;
      947     2105    2           NK$LDCT.LKFLG.QFL='0'B;
      948     2106    2           ROUTINE=ENTADDR(KCD$PREL);
      949     2107    2           END;
      950     2108    1         ELSE IF NK$LDCT.QFL.RLT THEN
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:140  
      951     2109    2            DO;
      952     2110    2            NK$LDCT.QFL.RLT='0'B;
      953     2111    2            ROUTINE=ENTADDR(KCD$RELTRM);
      954     2112    2            END;
      955     2113    1          ELSE IF NK$LDCT.QFL.CLDQ THEN
      956     2114    2             DO;
      957     2115    2             NK$LDCT.QFL.CLDQ='0'B;
      958     2116    2             ROUTINE=ENTADDR(KCD$CLDQ);
      959     2117    2             END;
      960     2118    1           ELSE IF NK$LDCT.QFL.WRT THEN
      961     2119    2              DO;
      962     2120    2              NK$LDCT.QFL.WRT='0'B;
      963     2121    2              ROUTINE=ENTADDR(KQG$PCW);
      964     2122    2              END;
      965     2123    1            ELSE IF NK$LDCT.QFL.RD THEN
      966     2124    2               DO;
      967     2125    2               NK$LDCT.QFL.RD='0'B;
      968     2126    2               ROUTINE=ENTADDR(KCF$FERDS);
      969     2127    2               END;
      970     2128    1             ELSE IF NK$LDCT.QFL.RDGO THEN
      971     2129    2                DO;
      972     2130    2                NK$LDCT.QFL.RDGO='0'B;
      973     2131    2                ROUTINE=ENTADDR(KQP$PCG);
      974     2132    2                END;
      975     2133    1              ELSE IF NK$LDCT.QFL.INCMP THEN
      976     2134    2                 DO;
      977     2135    2                 NK$LDCT.QFL.INCMP='0'B;
      978     2136    2                 ROUTINE=ENTADDR(KCF$INCMPL);
      979     2137    2                 END;
      980     2138    1         IF ROUTINE~=ENTADDR(NIL) THEN CALL ROUTINE (NK$LDCT);
      981     2139    1         RETURN;
      982     2140
      983     2141    1   END;
      984     2142
      985     2143
      986     2144        %EOD;

PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:141  
--  Include file information  --

   FOM_SUBS_C.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$QNF.

   Procedure KCF$QNF requires 91 words for executable code.
   Procedure KCF$QNF requires 10 words of local(AUTO) storage.

PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:142  

 Object Unit name= KCF$QNF                                    File name= KCF$CGFE.:E05TOU
 UTS= JUL 30 '97 00:14:04.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    91    133  KCF$QNF
    1  RoData even  none     9     11  KCF$QNF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  KCF$QNF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 FOM$SYMBIN
         yes           Std       1 KCD$RELTRM
         yes           Std       1 KCD$CLDQ
 yes     yes           Std       1 KQG$PCW
 yes     yes           Std       1 KCF$INCMPL
 yes     yes           Std       1 KCF$FERDS
         yes           Std       1 KCD$PREL
 yes     yes           Std       1 KQP$PCG
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:143  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:144  


      877        1        /*T***********************************************************/
      878        2        /*T*                                                         */
      879        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      880        4        /*T*                                                         */
      881        5        /*T***********************************************************/
      882        6
      883        7        /*F* NAME:         KCF$QNF
      884        8             PURPOSE:      To process the output circular queue becoming
      885        9                           no longer full.
      886       10             DESCRIPTION:  Called from KIA$ISCAN when the OCQ is deemed
      887       11                           to have some space.  We run the chain of LDCTs
      888       12                           'blocked' for the OCQ, calling some routine
      889       13                           based on the 'block' code in each. */
      890       14
      891       15        KCF$QNF: PROC (NK$LDCT);

     15  0 000000   000000 700200 xent  KCF$QNF      TSX0  ! X66_AUTO_1
         0 000001   000012 000001                    ZERO    10,1

      892       16
      893       17
      894       18
      895       19
      896       20
      897       21        /* INCLUDES */
      898       22
      899       23        %INCLUDE NK$LDCT;
      900      125        %INCLUDE K_DATA_R;
      901      836        %INCLUDE NK_SUBS;
      902      861        %INCLUDE KV$VDO;
      903     1876        %INCLUDE FOM_SUBS_C;
      904     1939        %KV_VDO_ALL_E;
      905     2018
      906     2019
      907     2020
      908     2021
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:145  
      909     2022        /* PARAMETERS */
      910     2023
      911     2024
      912     2025        %NK$LDCT (STCLASS="");
      913     2071
      914     2072
      915     2073
      916     2074
      917     2075        /* AUTO */
      918     2076
      919     2077    1   DCL ROUTINE EPTR;
      920     2078    1   DCL FOM$SYMBIN     ENTRY(3) ALTRET;
      921     2079    1   DCL KCD$CLDQ      ENTRY(1);
      922     2080    1   DCL KCD$PREL      ENTRY(1);
      923     2081    1   DCL KCD$RELTRM    ENTRY(1);
      924     2082    1   DCL KCF$FERDS     ENTRY(1) ALTRET;
      925     2083    1   DCL KCF$INCMPL    ENTRY(1) ALTRET;
      926     2084    1   DCL KQG$PCW       ENTRY(1) ALTRET;
      927     2085    1   DCL KQP$PCG       ENTRY(1) ALTRET;
      928     2086    1   DCL SSS$CACHE     ENTRY;
      929     2087    1   DCL SSS$CACHEBP   ENTRY;
      930     2088
      931     2089
      932     2090    1         IF NK$LDCT.QFL='0'B THEN

   2090  0 000002   200003 470500                    LDP0    @NK$LDCT,,AUTO
         0 000003   000010 236100                    LDQ     8,,PR0
         0 000004   000774 316007                    CANQ    508,DL
         0 000005   000011 601000 0                  TNZ     s:2095

      933     2091    2           DO;

      934     2092    2           NK$LDCT.LKFLG.QNFL = '1'B;

   2092  0 000006   040000 236003                    LDQ     16384,DU
         0 000007   000011 256100                    ORSQ    9,,PR0

PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:146  
      935     2093    2           RETURN;

   2093  0 000010   000000 702200 xent               TSX2  ! X66_ARET

      936     2094    2           END;
      937     2095    1         NK$LDCT.LKFLG.QFL = '0'B;

   2095  0 000011   000000 236000 1                  LDQ     0
         0 000012   000011 356100                    ANSQ    9,,PR0

      938     2096    1         ROUTINE=ENTADDR(NIL);

   2096  0 000013   000002 236000 xsym               LDQ     B_VECTNIL+2
         0 000014   200004 756100                    STQ     ROUTINE,,AUTO

      939     2097    1         IF NK$LDCT.DFLG.SYMBIONT AND NK$LDCT.QFL.WRT

   2097  0 000015   000006 236100                    LDQ     6,,PR0
         0 000016   020000 316007                    CANQ    8192,DL
         0 000017   000037 600000 0                  TZE     s:2102
         0 000020   000010 236100                    LDQ     8,,PR0
         0 000021   000400 316007                    CANQ    256,DL
         0 000022   000037 600000 0                  TZE     s:2102

      940     2098    2         THEN DO;

      941     2099    2           CALL FOM$SYMBIN (NK$LDCT,,FOMI_FNC_RQSDAT#);

   2099  0 000023   000001 236000 1                  LDQ     1
         0 000024   200010 756100                    STQ     ROUTINE+4,,AUTO
         0 000025   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000026   200003 235100                    LDA     @NK$LDCT,,AUTO
         0 000027   200006 757100                    STAQ    ROUTINE+2,,AUTO
         0 000030   200006 630500                    EPPR0   ROUTINE+2,,AUTO
         0 000031   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000032   000000 701000 xent               TSX1    FOM$SYMBIN
         0 000033   000000 011000                    NOP     0
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:147  

      942     2100    2           NK$LDCT.QFL.WRT = '0'B;

   2100  0 000034   200003 470500                    LDP0    @NK$LDCT,,AUTO
         0 000035   000002 236000 1                  LDQ     2
         0 000036   000010 356100                    ANSQ    8,,PR0

      943     2101    2           END;

      944     2102    1         IF NK$LDCT.QFL.RLS THEN

   2102  0 000037   000010 236100                    LDQ     8,,PR0
         0 000040   000040 316007                    CANQ    32,DL
         0 000041   000051 600000 0                  TZE     s:2108

      945     2103    2           DO;

      946     2104    2           NK$LDCT.QFL='0'B;

   2104  0 000042   000003 236000 1                  LDQ     3
         0 000043   000010 356100                    ANSQ    8,,PR0

      947     2105    2           NK$LDCT.LKFLG.QFL='0'B;

   2105  0 000044   000000 236000 1                  LDQ     0
         0 000045   000011 356100                    ANSQ    9,,PR0

      948     2106    2           ROUTINE=ENTADDR(KCD$PREL);

   2106  0 000046   000000 636000 xent               EAQ     KCD$PREL
         0 000047   200004 756100                    STQ     ROUTINE,,AUTO

      949     2107    2           END;

   2107  0 000050   000122 710000 0                  TRA     s:2138

      950     2108    1         ELSE IF NK$LDCT.QFL.RLT THEN
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:148  

   2108  0 000051   000010 316007                    CANQ    8,DL
         0 000052   000060 600000 0                  TZE     s:2113

      951     2109    2            DO;

      952     2110    2            NK$LDCT.QFL.RLT='0'B;

   2110  0 000053   000004 236000 1                  LDQ     4
         0 000054   000010 356100                    ANSQ    8,,PR0

      953     2111    2            ROUTINE=ENTADDR(KCD$RELTRM);

   2111  0 000055   000000 636000 xent               EAQ     KCD$RELTRM
         0 000056   200004 756100                    STQ     ROUTINE,,AUTO

      954     2112    2            END;

   2112  0 000057   000122 710000 0                  TRA     s:2138

      955     2113    1          ELSE IF NK$LDCT.QFL.CLDQ THEN

   2113  0 000060   000004 316007                    CANQ    4,DL
         0 000061   000067 600000 0                  TZE     s:2118

      956     2114    2             DO;

      957     2115    2             NK$LDCT.QFL.CLDQ='0'B;

   2115  0 000062   000005 236000 1                  LDQ     5
         0 000063   000010 356100                    ANSQ    8,,PR0

      958     2116    2             ROUTINE=ENTADDR(KCD$CLDQ);

   2116  0 000064   000000 636000 xent               EAQ     KCD$CLDQ
         0 000065   200004 756100                    STQ     ROUTINE,,AUTO

PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:149  
      959     2117    2             END;

   2117  0 000066   000122 710000 0                  TRA     s:2138

      960     2118    1           ELSE IF NK$LDCT.QFL.WRT THEN

   2118  0 000067   000400 316007                    CANQ    256,DL
         0 000070   000076 600000 0                  TZE     s:2123

      961     2119    2              DO;

      962     2120    2              NK$LDCT.QFL.WRT='0'B;

   2120  0 000071   000002 236000 1                  LDQ     2
         0 000072   000010 356100                    ANSQ    8,,PR0

      963     2121    2              ROUTINE=ENTADDR(KQG$PCW);

   2121  0 000073   000000 636000 xent               EAQ     KQG$PCW
         0 000074   200004 756100                    STQ     ROUTINE,,AUTO

      964     2122    2              END;

   2122  0 000075   000122 710000 0                  TRA     s:2138

      965     2123    1            ELSE IF NK$LDCT.QFL.RD THEN

   2123  0 000076   000200 316007                    CANQ    128,DL
         0 000077   000105 600000 0                  TZE     s:2128

      966     2124    2               DO;

      967     2125    2               NK$LDCT.QFL.RD='0'B;

   2125  0 000100   000006 236000 1                  LDQ     6
         0 000101   000010 356100                    ANSQ    8,,PR0

PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:150  
      968     2126    2               ROUTINE=ENTADDR(KCF$FERDS);

   2126  0 000102   000000 636000 xent               EAQ     KCF$FERDS
         0 000103   200004 756100                    STQ     ROUTINE,,AUTO

      969     2127    2               END;

   2127  0 000104   000122 710000 0                  TRA     s:2138

      970     2128    1             ELSE IF NK$LDCT.QFL.RDGO THEN

   2128  0 000105   000020 316007                    CANQ    16,DL
         0 000106   000114 600000 0                  TZE     s:2133

      971     2129    2                DO;

      972     2130    2                NK$LDCT.QFL.RDGO='0'B;

   2130  0 000107   000007 236000 1                  LDQ     7
         0 000110   000010 356100                    ANSQ    8,,PR0

      973     2131    2                ROUTINE=ENTADDR(KQP$PCG);

   2131  0 000111   000000 636000 xent               EAQ     KQP$PCG
         0 000112   200004 756100                    STQ     ROUTINE,,AUTO

      974     2132    2                END;

   2132  0 000113   000122 710000 0                  TRA     s:2138

      975     2133    1              ELSE IF NK$LDCT.QFL.INCMP THEN

   2133  0 000114   000100 316007                    CANQ    64,DL
         0 000115   000122 600000 0                  TZE     s:2138

      976     2134    2                 DO;

PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:151  
      977     2135    2                 NK$LDCT.QFL.INCMP='0'B;

   2135  0 000116   000010 236000 1                  LDQ     8
         0 000117   000010 356100                    ANSQ    8,,PR0

      978     2136    2                 ROUTINE=ENTADDR(KCF$INCMPL);

   2136  0 000120   000000 636000 xent               EAQ     KCF$INCMPL
         0 000121   200004 756100                    STQ     ROUTINE,,AUTO

      979     2137    2                 END;

      980     2138    1         IF ROUTINE~=ENTADDR(NIL) THEN CALL ROUTINE (NK$LDCT);

   2138  0 000122   200004 236100                    LDQ     ROUTINE,,AUTO
         0 000123   000002 116000 xsym               CMPQ    B_VECTNIL+2
         0 000124   000132 600000 0                  TZE     s:2139

   2138  0 000125   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         0 000126   200004 220100                    LDX0    ROUTINE,,AUTO
         0 000127   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000130   000000 701010                    TSX1    0,X0
         0 000131   000000 011000                    NOP     0

      981     2139    1         RETURN;

   2139  0 000132   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   777677 777777   000004 006000   777777 777377   777777 777003    ................
   1     004   777777 777767   777777 777773   777777 777577   777777 777757    ................
   1     010   777777 777677                                                    ....
      982     2140
      983     2141    1   END;
      984     2142
      985     2143
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:152  
      986     2144        %EOD;

PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:153  
--  Include file information  --

   FOM_SUBS_C.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$QNF.
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:154  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @NK$LDCT                  *0-0-0/d STRC(864)   r     1 NK$LDCT
     4-0-0/w EPTR        r     1 ROUTINE


   Procedure KCF$QNF requires 91 words for executable code.
   Procedure KCF$QNF requires 10 words of local(AUTO) storage.
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:155  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:156  
          MINI XREF LISTING

FOM$SYMBIN
      2078**DCL-ENT  2099--CALL
KCD$CLDQ
      2079**DCL-ENT  2116--ASSIGN
KCD$PREL
      2080**DCL-ENT  2106--ASSIGN
KCD$RELTRM
      2081**DCL-ENT  2111--ASSIGN
KCF$FERDS
      2082**DCL-ENT  2126--ASSIGN
KCF$INCMPL
      2083**DCL-ENT  2136--ASSIGN
KQG$PCW
      2084**DCL-ENT  2121--ASSIGN
KQP$PCG
      2085**DCL-ENT  2131--ASSIGN
K_RWPARM_CON.BLKREC
       566**DCL       591--REDEF
K_RWPARM_CON.BLKREC.BLKU#
       567**DCL       569--REDEF
K_RWPARM_CON.BLKREC.RECU#
       579**DCL       581--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
       606**DCL       607--REDEF
K_RWPARM_CON.DVE.EOMCHAR
       614**DCL       618--REDEF
K_RWPARM_CON.ERR
       678**DCL       683--REDEF
K_RWPARM_CON.FC
       642**DCL       643--REDEF
K_RWPARM_CON.FLDID
       824**DCL       825--REDEF
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:157  
K_RWPARM_CON.FPT$
       705**DCL       712--REDEF
K_RWPARM_CON.KEYTYPE
       831**DCL       832--REDEF
K_RWPARM_CON.MSG$
       541**DCL       547--REDEF
K_RWPARM_CON.MSGID
       653**DCL       658--REDEF
K_RWPARM_CON.MSGIDXT
       666**DCL       670--REDEF
K_RWPARM_CON.ORG
       802**DCL       803--REDEF
K_RWPARM_CON.THDRSZ
       746**DCL       750--REDEF
K_RWPARM_CON.VDOFLGS
       804**DCL       815--REDEF
NK$LDCT
      2038**DCL        15--PROC     2099<>CALL     2138<>CALL
NK$LDCT.DDT$
      2040**DCL      2040--REDEF
NK$LDCT.DFLG.SYMBIONT
      2043**DCL      2097>>IF
NK$LDCT.IOQ$
      2039**DCL      2040--REDEF
NK$LDCT.LDCTX
      2041**DCL      2041--REDEF
NK$LDCT.LKFLG.ABORTED
      2053**DCL      2054--REDEF
NK$LDCT.LKFLG.QFL
      2057**DCL      2095<<ASSIGN   2105<<ASSIGN
NK$LDCT.LKFLG.QNFL
      2054**DCL      2092<<ASSIGN
NK$LDCT.QFL
      2050**DCL      2090>>IF       2104<<ASSIGN
NK$LDCT.QFL.CLDQ
      2052**DCL      2113>>IF       2115<<ASSIGN
PL6.E3A0      #004=KCF$QNF File=KCF$CGFE.:E05TSI                                 WED 07/30/97 00:14 Page:158  
NK$LDCT.QFL.INCMP
      2051**DCL      2133>>IF       2135<<ASSIGN
NK$LDCT.QFL.RD
      2050**DCL      2123>>IF       2125<<ASSIGN
NK$LDCT.QFL.RDGO
      2051**DCL      2128>>IF       2130<<ASSIGN
NK$LDCT.QFL.RLS
      2051**DCL      2102>>IF
NK$LDCT.QFL.RLT
      2052**DCL      2108>>IF       2110<<ASSIGN
NK$LDCT.QFL.WRT
      2050**DCL      2097>>IF       2100<<ASSIGN   2118>>IF       2120<<ASSIGN
NK$LDCT.RLCID.LDCTX
      2063**DCL      2063--REDEF
NK$LDCT.STA$
      2059**DCL      2060--REDEF
NK$LDCT.SYMB$
      2038**DCL      2038--REDEF    2038--REDEF    2039--REDEF
ROUTINE
      2077**DCL      2096<<ASSIGN   2106<<ASSIGN   2111<<ASSIGN   2116<<ASSIGN   2121<<ASSIGN   2126<<ASSIGN
      2131<<ASSIGN   2136<<ASSIGN   2138>>IF       2138>>CALL

PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:159  
      987        1        /*T***********************************************************/
      988        2        /*T*                                                         */
      989        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      990        4        /*T*                                                         */
      991        5        /*T***********************************************************/
      992        6
      993        7        /*F* NAME:         KCF$NOCG
      994        8             PURPOSE:      To 'talk' to comgroup devices that are
      995        9                           in limbo.
      996       10             DESCRIPTION:  Called from KIA$ISCAN when certain types
      997       11                           of messages are received from LDCTs with
      998       12                           RESCOD = NOCG or TRMPTH.  The latter is
      999       13                           the special RESCOD used for TERMINALs
     1000       14                           (e.g. RBTs).  This routine provides a
     1001       15                           limited amount of communication with
     1002       16                           such devices, for example, ESC-Q
     1003       17                           responses, and disconnecting them if
     1004       18                           they send control-Y. */
     1005       19
     1006       20        KCF$NOCG: PROC (NK$LDCT,K$RWPARM) ALTRET;
     1007       21
     1008       22
     1009       23
     1010       24
     1011       25
     1012       26        /* INCLUDES */
     1013       27
     1014       28        %INCLUDE NK$LDCT;
     1015      130        %INCLUDE KV$VDO;
     1016     1145        %INCLUDE KC_CP6;
     1017     1705        %INCLUDE K_DATA_R;
     1018     2416        %INCLUDE NK_SUBS;
     1019     2441
     1020     2442
     1021     2443        /* Equates */
     1022     2444        %KV_VDO_ALL_E;
     1023     2523
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:160  
     1024     2524
     1025     2525
     1026     2526
     1027     2527        /* Constant */
     1028     2528    1   DCL TSTATE CHAR(4) CONSTANT INIT('NOCG');
     1029     2529
     1030     2530
     1031     2531        /* PARAMETERS */
     1032     2532
     1033     2533        %NK$LDCT (STCLASS="");
     1034     2579        %K$RWPARM (NAME=K$RWPARM);
     1035     2895
     1036     2896
     1037     2897
     1038     2898
     1039     2899        /* BASED STRUCTURES */
     1040     2900
     1041     2901        %KV$VDO (STCLASS="BASED(K$RWPARM.UHDR$)");
     1042     2928        %KV$VDO_EVT (STCLASS="BASED(K$RWPARM.UHDR$)");
     1043     2970
     1044     2971
     1045     2972
     1046     2973
     1047     2974        /* Auto */
     1048     2975
     1049     2976        %K$RWPARM (NAME=S_RWPARM,STCLASS=SYMREF);
     1050     3292
     1051     3293
     1052     3294
     1053     3295
     1054     3296        /* REFS */
     1055     3297
     1056     3298    1   DCL KCF$RLNCG     ENTRY(1);
     1057     3299    1   DCL KIA$MSG       ENTRY(1) ALTRET;
     1058     3300    1   DCL KIA$FCNO      ENTRY(3) ALTRET;
     1059     3301    1   DCL KIA$DSC       ENTRY(3) ALTRET;
     1060     3302
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:161  
     1061     3303
     1062     3304
     1063     3305
     1064     3306        /* SUBS */
     1065     3307
     1066     3308        %EQU_CG;
     1067     3356
     1068     3357
     1069     3358    1         CALL KIA$MSG(K$RWPARM);
     1070     3359
     1071     3360    2           DO CASE (KV$VDO.FNC);
     1072     3361    2             CASE (%KV_VDO_FNC_EVT);
     1073     3362    2               IF KV$VDO_EVT.TYP = %KV_EVTTYP_MNTATN
     1074     3363    3               THEN DO;
     1075     3364    3                 S_RWPARM = K_RWPARM_CON;
     1076     3365    3                 CALL KCF$RLNCG(NK$LDCT);
     1077     3366    3                 END;
     1078     3367    3               ELSE DO;
     1079     3368    3                 LDCT.BKPND=%CG_TBRK_BRK#;
     1080     3369    3                 CALL KIA$FCNO (LDCT,%KV_VDO_FNC_MRK,K$RWPARM) ALTRET (GETOUT);
     1081     3370    3                 END;
     1082     3371    2             CASE (%KV_VDO_FNC_RQSSTT);
     1083     3372    2               S_RWPARM = K_RWPARM_CON;
     1084     3373    2               S_RWPARM.MSGSZ = LENGTHC(TSTATE);
     1085     3374    2               S_RWPARM.MSG$ = ADDR(TSTATE);
     1086     3375    2               CALL KIA$FCNO(LDCT,%KV_VDO_FNC_STT,S_RWPARM) ALTRET(GETOUT);
     1087     3376    2             CASE (%KV_VDO_FNC_DSC_RQS);
     1088     3377    2               CALL KCF$RLNCG (LDCT);
     1089     3378    2           END;
     1090     3379    1         RETURN;
     1091     3380    1   GETOUT:;
     1092     3381    1         ALTRETURN;
     1093     3382
     1094     3383    1   END;
     1095     3384
     1096     3385
     1097     3386        %EOD;
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:162  

PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:163  
--  Include file information  --

   NK_SUBS.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC_CP6.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$NOCG.

   Procedure KCF$NOCG requires 81 words for executable code.
   Procedure KCF$NOCG requires 10 words of local(AUTO) storage.

PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:164  

 Object Unit name= KCF$NOCG                                   File name= KCF$CGFE.:E05TOU
 UTS= JUL 30 '97 00:14:14.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  KCF$NOCG
    1   Proc  even  none    81    121  KCF$NOCG
    2  RoData even  none     6      6  KCF$NOCG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  KCF$NOCG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KIA$MSG
         yes           Std       1 KCF$RLNCG
 yes     yes           Std       3 KIA$FCNO
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:165  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    K_RWPARM_CON                          S_RWPARM                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:166  


      987        1        /*T***********************************************************/
      988        2        /*T*                                                         */
      989        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      990        4        /*T*                                                         */
      991        5        /*T***********************************************************/
      992        6
      993        7        /*F* NAME:         KCF$NOCG
      994        8             PURPOSE:      To 'talk' to comgroup devices that are
      995        9                           in limbo.
      996       10             DESCRIPTION:  Called from KIA$ISCAN when certain types
      997       11                           of messages are received from LDCTs with
      998       12                           RESCOD = NOCG or TRMPTH.  The latter is
      999       13                           the special RESCOD used for TERMINALs
     1000       14                           (e.g. RBTs).  This routine provides a
     1001       15                           limited amount of communication with
     1002       16                           such devices, for example, ESC-Q
     1003       17                           responses, and disconnecting them if
     1004       18                           they send control-Y. */
     1005       19
     1006       20        KCF$NOCG: PROC (NK$LDCT,K$RWPARM) ALTRET;

     20  1 000000   000000 700200 xent  KCF$NOCG     TSX0  ! X66_AUTO_2
         1 000001   000012 000002                    ZERO    10,2

     1007       21
     1008       22
     1009       23
     1010       24
     1011       25
     1012       26        /* INCLUDES */
     1013       27
     1014       28        %INCLUDE NK$LDCT;
     1015      130        %INCLUDE KV$VDO;
     1016     1145        %INCLUDE KC_CP6;
     1017     1705        %INCLUDE K_DATA_R;
     1018     2416        %INCLUDE NK_SUBS;
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:167  
     1019     2441
     1020     2442
     1021     2443        /* Equates */
     1022     2444        %KV_VDO_ALL_E;
     1023     2523
     1024     2524
     1025     2525
     1026     2526
     1027     2527        /* Constant */
     1028     2528    1   DCL TSTATE CHAR(4) CONSTANT INIT('NOCG');
     1029     2529
     1030     2530
     1031     2531        /* PARAMETERS */
     1032     2532
     1033     2533        %NK$LDCT (STCLASS="");
     1034     2579        %K$RWPARM (NAME=K$RWPARM);
     1035     2895
     1036     2896
     1037     2897
     1038     2898
     1039     2899        /* BASED STRUCTURES */
     1040     2900
     1041     2901        %KV$VDO (STCLASS="BASED(K$RWPARM.UHDR$)");
     1042     2928        %KV$VDO_EVT (STCLASS="BASED(K$RWPARM.UHDR$)");
     1043     2970
     1044     2971
     1045     2972
     1046     2973
     1047     2974        /* Auto */
     1048     2975
     1049     2976        %K$RWPARM (NAME=S_RWPARM,STCLASS=SYMREF);
     1050     3292
     1051     3293
     1052     3294
     1053     3295
     1054     3296        /* REFS */
     1055     3297
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:168  
     1056     3298    1   DCL KCF$RLNCG     ENTRY(1);
     1057     3299    1   DCL KIA$MSG       ENTRY(1) ALTRET;
     1058     3300    1   DCL KIA$FCNO      ENTRY(3) ALTRET;
     1059     3301    1   DCL KIA$DSC       ENTRY(3) ALTRET;
     1060     3302
     1061     3303
     1062     3304
     1063     3305
     1064     3306        /* SUBS */
     1065     3307
     1066     3308        %EQU_CG;
     1067     3356
     1068     3357
     1069     3358    1         CALL KIA$MSG(K$RWPARM);

   3358  1 000002   200004 630500                    EPPR0   @K$RWPARM,,AUTO
         1 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000004   000000 701000 xent               TSX1    KIA$MSG
         1 000005   000000 011000                    NOP     0

     1070     3359
     1071     3360    2           DO CASE (KV$VDO.FNC);

   3360  1 000006   200004 470500                    LDP0    @K$RWPARM,,AUTO
         1 000007   000014 471500                    LDP1    12,,PR0
         1 000010   000100 101500                    MRL     fill='000'O
         1 000011   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000012   200006 000004                    ADSC9   @K$RWPARM+2,,AUTO        cn=0,n=4
         1 000013   200006 236100                    LDQ     @K$RWPARM+2,,AUTO
         1 000014   000012 136007                    SBLQ    10,DL
         1 000015   000017 116007                    CMPQ    15,DL
         1 000016   000020 602006 1                  TNC     s:3360+10,QL
         1 000017   000117 710000 1                  TRA     s:3379
         1 000020   000113 710000 1                  TRA     s:3377
         1 000021   000117 710000 1                  TRA     s:3379
         1 000022   000117 710000 1                  TRA     s:3379
         1 000023   000037 710000 1                  TRA     s:3362
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:169  
         1 000024   000117 710000 1                  TRA     s:3379
         1 000025   000117 710000 1                  TRA     s:3379
         1 000026   000117 710000 1                  TRA     s:3379
         1 000027   000117 710000 1                  TRA     s:3379
         1 000030   000117 710000 1                  TRA     s:3379
         1 000031   000117 710000 1                  TRA     s:3379
         1 000032   000117 710000 1                  TRA     s:3379
         1 000033   000117 710000 1                  TRA     s:3379
         1 000034   000117 710000 1                  TRA     s:3379
         1 000035   000117 710000 1                  TRA     s:3379
         1 000036   000072 710000 1                  TRA     s:3372

     1072     3361    2             CASE (%KV_VDO_FNC_EVT);

     1073     3362    2               IF KV$VDO_EVT.TYP = %KV_EVTTYP_MNTATN

   3362  1 000037   000100 101500                    MRL     fill='000'O
         1 000040   100000 600001                    ADSC9   0,,PR1                   cn=3,n=1
         1 000041   200006 000004                    ADSC9   @K$RWPARM+2,,AUTO        cn=0,n=4
         1 000042   200006 236100                    LDQ     @K$RWPARM+2,,AUTO
         1 000043   000002 116007                    CMPQ    2,DL
         1 000044   000055 601000 1                  TNZ     s:3368

     1074     3363    3               THEN DO;

     1075     3364    3                 S_RWPARM = K_RWPARM_CON;

   3364  1 000045   000000 100400                    MLR     fill='000'O
         1 000046   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000047   000000 000234 xsym               ADSC9   S_RWPARM                 cn=0,n=156

     1076     3365    3                 CALL KCF$RLNCG(NK$LDCT);

   3365  1 000050   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000051   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000052   000000 701000 xent               TSX1    KCF$RLNCG
         1 000053   000000 011000                    NOP     0
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:170  

     1077     3366    3                 END;

   3366  1 000054   000117 710000 1                  TRA     s:3379

     1078     3367    3               ELSE DO;

     1079     3368    3                 LDCT.BKPND=%CG_TBRK_BRK#;

   3368  1 000055   200003 473500                    LDP3    @NK$LDCT,,AUTO
         1 000056   001000 236003                    LDQ     512,DU
         1 000057   300014 552140                    STBQ    12,'40'O,PR3

     1080     3369    3                 CALL KIA$FCNO (LDCT,%KV_VDO_FNC_MRK,K$RWPARM) ALTRET (GETOUT);

   3369  1 000060   200004 236100                    LDQ     @K$RWPARM,,AUTO
         1 000061   200010 756100                    STQ     @K$RWPARM+4,,AUTO
         1 000062   000001 236000 2                  LDQ     1
         1 000063   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000064   200006 757100                    STAQ    @K$RWPARM+2,,AUTO
         1 000065   200006 630500                    EPPR0   @K$RWPARM+2,,AUTO
         1 000066   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000067   000000 701000 xent               TSX1    KIA$FCNO
         1 000070   000120 702000 1                  TSX2    GETOUT

     1081     3370    3                 END;

   3370  1 000071   000117 710000 1                  TRA     s:3379

     1082     3371    2             CASE (%KV_VDO_FNC_RQSSTT);

     1083     3372    2               S_RWPARM = K_RWPARM_CON;

   3372  1 000072   000000 100400                    MLR     fill='000'O
         1 000073   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000074   000000 000234 xsym               ADSC9   S_RWPARM                 cn=0,n=156

PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:171  
     1084     3373    2               S_RWPARM.MSGSZ = LENGTHC(TSTATE);

   3373  1 000075   000004 235007                    LDA     4,DL
         1 000076   000001 755000 xsym               STA     S_RWPARM+1

     1085     3374    2               S_RWPARM.MSG$ = ADDR(TSTATE);

   3374  1 000077   000002 236000 2                  LDQ     2
         1 000100   000000 756000 xsym               STQ     S_RWPARM

     1086     3375    2               CALL KIA$FCNO(LDCT,%KV_VDO_FNC_STT,S_RWPARM) ALTRET(GETOUT);

   3375  1 000101   000004 236000 2                  LDQ     4
         1 000102   200010 756100                    STQ     @K$RWPARM+4,,AUTO
         1 000103   000005 236000 2                  LDQ     5
         1 000104   200003 235100                    LDA     @NK$LDCT,,AUTO
         1 000105   200006 757100                    STAQ    @K$RWPARM+2,,AUTO
         1 000106   200006 630500                    EPPR0   @K$RWPARM+2,,AUTO
         1 000107   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000110   000000 701000 xent               TSX1    KIA$FCNO
         1 000111   000120 702000 1                  TSX2    GETOUT
         1 000112   000117 710000 1                  TRA     s:3379

     1087     3376    2             CASE (%KV_VDO_FNC_DSC_RQS);

     1088     3377    2               CALL KCF$RLNCG (LDCT);

   3377  1 000113   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         1 000114   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000115   000000 701000 xent               TSX1    KCF$RLNCG
         1 000116   000000 011000                    NOP     0

     1089     3378    2           END;

     1090     3379    1         RETURN;

   3379  1 000117   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:172  

   3376  1 000120                       GETOUT       null
     1091     3380    1   GETOUT:;
     1092     3381    1         ALTRETURN;

   3381  1 000120   000000 702200 xent               TSX2  ! X66_AALT

TSTATE
 Sect OctLoc
   0     000   116117 103107                                                    NOCG

(unnamed)
 Sect OctLoc
   2     000   000000 000037   000000 006000   000000 006000   000000 000035    ................
   2     004   000000 006000   000003 006000                                    ........
     1093     3382
     1094     3383    1   END;
     1095     3384
     1096     3385
     1097     3386        %EOD;

PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:173  
--  Include file information  --

   NK_SUBS.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC_CP6.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$NOCG.
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:174  

 **** Variables and constants ****

  ****  Section 000 RoData KCF$NOCG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)     r     1 TSTATE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @K$RWPARM                  3-0-0/w PTR         r     1 @NK$LDCT
    *0-0-0/d STRC(1404)  r     1 K$RWPARM                  *0-0-0/d STRC(864)   r     1 NK$LDCT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1404)  r     1 K_RWPARM_CON               0-0-0/d STRC(1404)  r     1 S_RWPARM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/h STRC(18)    r     1 KV$VDO                     0-0-0/h STRC        r     1 KV$VDO_EVT


   Procedure KCF$NOCG requires 81 words for executable code.
   Procedure KCF$NOCG requires 10 words of local(AUTO) storage.
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:175  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:176  
          MINI XREF LISTING

GETOUT
      3376**LABEL    3369--CALLALT  3375--CALLALT
K$RWPARM
      2600**DCL        20--PROC     3358<>CALL     3369<>CALL
K$RWPARM.BLKREC
      2626**DCL      2651--REDEF
K$RWPARM.BLKREC.BLKU#
      2627**DCL      2629--REDEF
K$RWPARM.BLKREC.RECU#
      2639**DCL      2641--REDEF
K$RWPARM.DVE.DVBYTE.VFC
      2666**DCL      2667--REDEF
K$RWPARM.DVE.EOMCHAR
      2674**DCL      2678--REDEF
K$RWPARM.ERR
      2738**DCL      2743--REDEF
K$RWPARM.FC
      2702**DCL      2703--REDEF
K$RWPARM.FLDID
      2884**DCL      2885--REDEF
K$RWPARM.FPT$
      2765**DCL      2772--REDEF
K$RWPARM.KEYTYPE
      2891**DCL      2892--REDEF
K$RWPARM.MSG$
      2601**DCL      2607--REDEF
K$RWPARM.MSGID
      2713**DCL      2718--REDEF
K$RWPARM.MSGIDXT
      2726**DCL      2730--REDEF
K$RWPARM.ORG
      2862**DCL      2863--REDEF
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:177  
K$RWPARM.THDRSZ
      2806**DCL      2810--REDEF
K$RWPARM.UHDR$
      2751**DCL      2921--IMP-PTR  2961--IMP-PTR  3360>>DOCASE   3362>>IF
K$RWPARM.VDOFLGS
      2864**DCL      2875--REDEF
KCF$RLNCG
      3298**DCL-ENT  3365--CALL     3377--CALL
KIA$FCNO
      3300**DCL-ENT  3369--CALL     3375--CALL
KIA$MSG
      3299**DCL-ENT  3358--CALL
KV$VDO.FNC
      2925**DCL      3360>>DOCASE
KV$VDO_EVT.TYP
      2968**DCL      3362>>IF
K_RWPARM_CON
      2120**DCL      3364>>ASSIGN   3372>>ASSIGN
K_RWPARM_CON.BLKREC
      2146**DCL      2171--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      2147**DCL      2149--REDEF
K_RWPARM_CON.BLKREC.RECU#
      2159**DCL      2161--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      2186**DCL      2187--REDEF
K_RWPARM_CON.DVE.EOMCHAR
      2194**DCL      2198--REDEF
K_RWPARM_CON.ERR
      2258**DCL      2263--REDEF
K_RWPARM_CON.FC
      2222**DCL      2223--REDEF
K_RWPARM_CON.FLDID
      2404**DCL      2405--REDEF
K_RWPARM_CON.FPT$
      2285**DCL      2292--REDEF
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:178  
K_RWPARM_CON.KEYTYPE
      2411**DCL      2412--REDEF
K_RWPARM_CON.MSG$
      2121**DCL      2127--REDEF
K_RWPARM_CON.MSGID
      2233**DCL      2238--REDEF
K_RWPARM_CON.MSGIDXT
      2246**DCL      2250--REDEF
K_RWPARM_CON.ORG
      2382**DCL      2383--REDEF
K_RWPARM_CON.THDRSZ
      2326**DCL      2330--REDEF
K_RWPARM_CON.VDOFLGS
      2384**DCL      2395--REDEF
NK$LDCT
      2546**DCL        20--PROC     3365<>CALL     3369<>CALL     3375<>CALL     3377<>CALL
NK$LDCT.BKPND
      2568**DCL      3368<<ASSIGN
NK$LDCT.DDT$
      2548**DCL      2548--REDEF
NK$LDCT.IOQ$
      2547**DCL      2548--REDEF
NK$LDCT.LDCTX
      2549**DCL      2549--REDEF
NK$LDCT.LKFLG.ABORTED
      2561**DCL      2562--REDEF
NK$LDCT.RLCID.LDCTX
      2571**DCL      2571--REDEF
NK$LDCT.STA$
      2567**DCL      2568--REDEF
NK$LDCT.SYMB$
      2546**DCL      2546--REDEF    2546--REDEF    2547--REDEF
S_RWPARM
      2997**DCL      3364<<ASSIGN   3372<<ASSIGN   3375<>CALL
S_RWPARM.BLKREC
      3023**DCL      3048--REDEF
PL6.E3A0      #005=KCF$NOCG File=KCF$CGFE.:E05TSI                                WED 07/30/97 00:14 Page:179  
S_RWPARM.BLKREC.BLKU#
      3024**DCL      3026--REDEF
S_RWPARM.BLKREC.RECU#
      3036**DCL      3038--REDEF
S_RWPARM.DVE.DVBYTE.VFC
      3063**DCL      3064--REDEF
S_RWPARM.DVE.EOMCHAR
      3071**DCL      3075--REDEF
S_RWPARM.ERR
      3135**DCL      3140--REDEF
S_RWPARM.FC
      3099**DCL      3100--REDEF
S_RWPARM.FLDID
      3281**DCL      3282--REDEF
S_RWPARM.FPT$
      3162**DCL      3169--REDEF
S_RWPARM.KEYTYPE
      3288**DCL      3289--REDEF
S_RWPARM.MSG$
      2998**DCL      3004--REDEF    3374<<ASSIGN
S_RWPARM.MSGID
      3110**DCL      3115--REDEF
S_RWPARM.MSGIDXT
      3123**DCL      3127--REDEF
S_RWPARM.MSGSZ
      3005**DCL      3373<<ASSIGN
S_RWPARM.ORG
      3259**DCL      3260--REDEF
S_RWPARM.THDRSZ
      3203**DCL      3207--REDEF
S_RWPARM.VDOFLGS
      3261**DCL      3272--REDEF
TSTATE
      2528**DCL      3373--ASSIGN   3374--ASSIGN

PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:180  
     1098        1        /*T***********************************************************/
     1099        2        /*T*                                                         */
     1100        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1101        4        /*T*                                                         */
     1102        5        /*T***********************************************************/
     1103        6
     1104        7        /*F* NAME:         KCF$RLNCG
     1105        8             PURPOSE:      To remove a device from limbo when it disconnects
     1106        9             DESCRIPTION:  Called from KCF$NOCG when KX_DISC is received.
     1107       10                           Unlinks the LDCT from the NOCG chain, and
     1108       11                           calls KCD$PREL to complete the disconnect. */
     1109       12
     1110       13        KCF$RLNCG: PROC (NK$LDCT);
     1111       14
     1112       15
     1113       16
     1114       17
     1115       18
     1116       19        /* INCLUDES */
     1117       20
     1118       21        %INCLUDE NK$LDCT;
     1119      123        %INCLUDE KC_DATA_R;
     1120      136        %INCLUDE NK_SUBS;
     1121      161
     1122      162
     1123      163
     1124      164
     1125      165        /* PARAMETERS */
     1126      166
     1127      167        %NK$LDCT (STCLASS="");
     1128      213
     1129      214
     1130      215
     1131      216
     1132      217        /* BASED STRUCTURES */
     1133      218        %NK$LDCT (NAME=VLDCT);
     1134      264
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:181  
     1135      265
     1136      266
     1137      267
     1138      268        /* AUTO */
     1139      269
     1140      270    1   DCL TDCT$ PTR;
     1141      271    1   DCL PDCT$ PTR;
     1142      272    1   DCL ENT UBIN WORD;
     1143      273
     1144      274
     1145      275
     1146      276
     1147      277        /* REFS */
     1148      278
     1149      279    1   DCL KCD$PREL      ENTRY(1);
     1150      280
     1151      281
     1152      282    1         ENT=0;
     1153      283    2           DO INHIBIT;
     1154      284    2           IF LDCT.DFLG.OLDSC THEN RETURN;
     1155      285    2           LDCT.DFLG.OLDSC='1'B;
     1156      286    2           GOTO UNCH;
     1157      287    2           END;
     1158      288
     1159      289        /*F* NAME:         KCF$EXHUME
     1160      290             PURPOSE:      To remove an LDCT from the NOCG chain.
     1161      291             DESCRIPTION:  Called from KLM$EXHUME when ELF is connecting
     1162      292                           a limboed device to its comgroup.
     1163      293                           Removes the LDCT from the chain. */
     1164      294    1   KCF$EXHUME: ENTRY (LDCT);
     1165      295
     1166      296    2           DO INHIBIT;
     1167      297    2           ENT=1;
     1168      298    2   UNCH:   ;
     1169      299    2           PDCT$=ADDR(NIL);
     1170      300    2           TDCT$=KC_NOCG$;
     1171      301    3             DO WHILE (TDCT$~=ADDR(NIL));
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:182  
     1172      302    3             IF TDCT$=ADDR(LDCT) THEN
     1173      303    4               DO;
     1174      304    4               IF PDCT$=ADDR(NIL) THEN KC_NOCG$=LDCT.LNK$;
     1175      305    4               ELSE PDCT$->VLDCT.LNK$=LDCT.LNK$;
     1176      306    4               GOTO RLEM;
     1177      307    4               END;
     1178      308    3             PDCT$=TDCT$;
     1179      309    3             TDCT$=TDCT$->VLDCT.LNK$;
     1180      310    3             END;
     1181      311    2           END;
     1182      312    1         RETURN;
     1183      313    1   RLEM: ;
     1184      314    1         IF ENT=0 THEN CALL KCD$PREL (LDCT);
     1185      315    1         RETURN;
     1186      316
     1187      317    1   END;
     1188      318
     1189      319

PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:183  
--  Include file information  --

   NK_SUBS.:E05TOU  is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$RLNCG.

   Procedure KCF$RLNCG requires 50 words for executable code.
   Procedure KCF$RLNCG requires 8 words of local(AUTO) storage.

    No errors detected in file KCF$CGFE.:E05TSI    .

PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:184  

 Object Unit name= KCF$RLNCG                                  File name= KCF$CGFE.:E05TOU
 UTS= JUL 30 '97 00:14:25.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    50     62  KCF$RLNCG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  KCF$RLNCG
     0     14                  yes      Std        1  KCF$EXHUME

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KCD$PREL
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KC_NOCG$                              B_VECTNIL
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:185  


     1098        1        /*T***********************************************************/
     1099        2        /*T*                                                         */
     1100        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1101        4        /*T*                                                         */
     1102        5        /*T***********************************************************/
     1103        6
     1104        7        /*F* NAME:         KCF$RLNCG
     1105        8             PURPOSE:      To remove a device from limbo when it disconnects
     1106        9             DESCRIPTION:  Called from KCF$NOCG when KX_DISC is received.
     1107       10                           Unlinks the LDCT from the NOCG chain, and
     1108       11                           calls KCD$PREL to complete the disconnect. */
     1109       12
     1110       13        KCF$RLNCG: PROC (NK$LDCT);

     13  0 000000   000000 700200 xent  KCF$RLNCG    TSX0  ! X66_AUTO_1
         0 000001   000010 000001                    ZERO    8,1

     1111       14
     1112       15
     1113       16
     1114       17
     1115       18
     1116       19        /* INCLUDES */
     1117       20
     1118       21        %INCLUDE NK$LDCT;
     1119      123        %INCLUDE KC_DATA_R;
     1120      136        %INCLUDE NK_SUBS;
     1121      161
     1122      162
     1123      163
     1124      164
     1125      165        /* PARAMETERS */
     1126      166
     1127      167        %NK$LDCT (STCLASS="");
     1128      213
     1129      214
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:186  
     1130      215
     1131      216
     1132      217        /* BASED STRUCTURES */
     1133      218        %NK$LDCT (NAME=VLDCT);
     1134      264
     1135      265
     1136      266
     1137      267
     1138      268        /* AUTO */
     1139      269
     1140      270    1   DCL TDCT$ PTR;
     1141      271    1   DCL PDCT$ PTR;
     1142      272    1   DCL ENT UBIN WORD;
     1143      273
     1144      274
     1145      275
     1146      276
     1147      277        /* REFS */
     1148      278
     1149      279    1   DCL KCD$PREL      ENTRY(1);
     1150      280
     1151      281
     1152      282    1         ENT=0;

    282  0 000002   200006 450100                    STZ     ENT,,AUTO

     1153      283    2           DO INHIBIT;

     1154      284    2           IF LDCT.DFLG.OLDSC THEN RETURN;

    284  0 000003   200003 470700                    LDP0  ! @NK$LDCT,,AUTO
         0 000004   000006 236300                    LDQ   ! 6,,PR0
         0 000005   010000 316207                    CANQ  ! 4096,DL
         0 000006   000010 600200 0                  TZE   ! s:285

    284  0 000007   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:187  
     1155      285    2           LDCT.DFLG.OLDSC='1'B;

    285  0 000010   010000 236207                    LDQ   ! 4096,DL
         0 000011   000006 256300                    ORSQ  ! 6,,PR0

     1156      286    2           GOTO UNCH;

    286  0 000012   000020 710200 0                  TRA   ! UNCH

     1157      287    2           END;

    287  0 000013   000016 710000 0                  TRA     s:297

     1158      288
     1159      289        /*F* NAME:         KCF$EXHUME
     1160      290             PURPOSE:      To remove an LDCT from the NOCG chain.
     1161      291             DESCRIPTION:  Called from KLM$EXHUME when ELF is connecting
     1162      292                           a limboed device to its comgroup.
     1163      293                           Removes the LDCT from the chain. */
     1164      294    1   KCF$EXHUME: ENTRY (LDCT);

    294  0 000014   000000 700200 xent  KCF$EXHUME   TSX0  ! X66_AUTO_1
         0 000015   000010 000001                    ZERO    8,1

     1165      295
     1166      296    2           DO INHIBIT;

     1167      297    2           ENT=1;

    297  0 000016   000001 235207                    LDA   ! 1,DL
         0 000017   200006 755300                    STA   ! ENT,,AUTO

    297  0 000020                       UNCH         null
     1168      298    2   UNCH:   ;
     1169      299    2           PDCT$=ADDR(NIL);

    299  0 000020   000001 236200 xsym               LDQ   ! B_VECTNIL+1
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:188  
         0 000021   200005 756300                    STQ   ! PDCT$,,AUTO

     1170      300    2           TDCT$=KC_NOCG$;

    300  0 000022   000000 236200 xsym               LDQ   ! KC_NOCG$
         0 000023   200004 756300                    STQ   ! TDCT$,,AUTO

     1171      301    3             DO WHILE (TDCT$~=ADDR(NIL));

    301  0 000024   000050 710200 0                  TRA   ! s:310

     1172      302    3             IF TDCT$=ADDR(LDCT) THEN

    302  0 000025   200004 236300                    LDQ   ! TDCT$,,AUTO
         0 000026   200003 116300                    CMPQ  ! @NK$LDCT,,AUTO
         0 000027   000044 601200 0                  TNZ   ! s:308

     1173      303    4               DO;

     1174      304    4               IF PDCT$=ADDR(NIL) THEN KC_NOCG$=LDCT.LNK$;

    304  0 000030   200005 236300                    LDQ   ! PDCT$,,AUTO
         0 000031   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         0 000032   000037 601200 0                  TNZ   ! s:305

    304  0 000033   200003 470700                    LDP0  ! @NK$LDCT,,AUTO
         0 000034   000004 236300                    LDQ   ! 4,,PR0
         0 000035   000000 756200 xsym               STQ   ! KC_NOCG$
         0 000036   000043 710200 0                  TRA   ! s:306

     1175      305    4               ELSE PDCT$->VLDCT.LNK$=LDCT.LNK$;

    305  0 000037   200003 470700                    LDP0  ! @NK$LDCT,,AUTO
         0 000040   000004 236300                    LDQ   ! 4,,PR0
         0 000041   200005 471700                    LDP1  ! PDCT$,,AUTO
         0 000042   100004 756300                    STQ   ! 4,,PR1

PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:189  
     1176      306    4               GOTO RLEM;

    306  0 000043   000053 710200 0                  TRA   ! RLEM

     1177      307    4               END;
     1178      308    3             PDCT$=TDCT$;

    308  0 000044   200005 756300                    STQ   ! PDCT$,,AUTO

     1179      309    3             TDCT$=TDCT$->VLDCT.LNK$;

    309  0 000045   200004 470700                    LDP0  ! TDCT$,,AUTO
         0 000046   000004 236300                    LDQ   ! 4,,PR0
         0 000047   200004 756300                    STQ   ! TDCT$,,AUTO

     1180      310    3             END;

    310  0 000050   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         0 000051   000025 601200 0                  TNZ   ! s:302

     1181      311    2           END;

     1182      312    1         RETURN;

    312  0 000052   000000 702200 xent               TSX2  ! X66_ARET

    304  0 000053                       RLEM         null
     1183      313    1   RLEM: ;
     1184      314    1         IF ENT=0 THEN CALL KCD$PREL (LDCT);

    314  0 000053   200006 235100                    LDA     ENT,,AUTO
         0 000054   000061 601000 0                  TNZ     s:315

    314  0 000055   200003 630500                    EPPR0   @NK$LDCT,,AUTO
         0 000056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000057   000000 701000 xent               TSX1    KCD$PREL
         0 000060   000000 011000                    NOP     0
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:190  

     1185      315    1         RETURN;

    315  0 000061   000000 702200 xent               TSX2  ! X66_ARET
     1186      316
     1187      317    1   END;
     1188      318
     1189      319

PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:191  
--  Include file information  --

   NK_SUBS.:E05TOU  is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure KCF$RLNCG.
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:192  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @NK$LDCT                   6-0-0/w UBIN        r     1 ENT
    *0-0-0/d STRC(864)   r     1 NK$LDCT                    5-0-0/w PTR         r     1 PDCT$
     4-0-0/w PTR         r     1 TDCT$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KC_NOCG$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(864)   r     1 VLDCT


   Procedure KCF$RLNCG requires 50 words for executable code.
   Procedure KCF$RLNCG requires 8 words of local(AUTO) storage.

    No errors detected in file KCF$CGFE.:E05TSI    .
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:193  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:194  
          MINI XREF LISTING

ENT
       272**DCL       282<<ASSIGN    297<<ASSIGN    314>>IF
KCD$PREL
       279**DCL-ENT   314--CALL
KC_NOCG$
       134**DCL       300>>ASSIGN    304<<ASSIGN
NK$LDCT
       180**DCL        13--PROC      294--ENTRY     302--IF        314<>CALL
NK$LDCT.DDT$
       182**DCL       182--REDEF
NK$LDCT.DFLG.OLDSC
       185**DCL       284>>IF        285<<ASSIGN
NK$LDCT.IOQ$
       181**DCL       182--REDEF
NK$LDCT.LDCTX
       183**DCL       183--REDEF
NK$LDCT.LKFLG.ABORTED
       195**DCL       196--REDEF
NK$LDCT.LNK$
       182**DCL       304>>ASSIGN    305>>ASSIGN
NK$LDCT.RLCID.LDCTX
       205**DCL       205--REDEF
NK$LDCT.STA$
       201**DCL       202--REDEF
NK$LDCT.SYMB$
       180**DCL       180--REDEF     180--REDEF     181--REDEF
PDCT$
       271**DCL       299<<ASSIGN    304>>IF        305>>ASSIGN    308<<ASSIGN
RLEM
       304**LABEL     306--GOTO
TDCT$
       270**DCL       300<<ASSIGN    301>>DOWHILE   302>>IF        308>>ASSIGN    309<<ASSIGN    309>>ASSIGN
PL6.E3A0      #006=KCF$RLNCG File=KCF$CGFE.:E05TSI                               WED 07/30/97 00:14 Page:195  
UNCH
       297**LABEL     286--GOTO
VLDCT.DDT$
       233**DCL       233--REDEF
VLDCT.IOQ$
       232**DCL       233--REDEF
VLDCT.LDCTX
       234**DCL       234--REDEF
VLDCT.LKFLG.ABORTED
       246**DCL       247--REDEF
VLDCT.LNK$
       233**DCL       305<<ASSIGN    309>>ASSIGN
VLDCT.RLCID.LDCTX
       256**DCL       256--REDEF
VLDCT.STA$
       252**DCL       253--REDEF
VLDCT.SYMB$
       231**DCL       231--REDEF     231--REDEF     232--REDEF
