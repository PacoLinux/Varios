VERSION E05

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:1    
        1        1        /*M* LIMIT cmd */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DFC  */
        8        8        /*P*   NAME:   CPJ$IBEX
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of selected IBEX commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPJ$IBEX:
       16       16          PROC(P$PCB) ALTRET;
       17       17                   %INCLUDE CP_6;
       18       98                   %INCLUDE B$JIT;
       19      388                   %INCLUDE B_STRINGS_C;
       20      517                   %INCLUDE B_MACROS_C;
       21      628                   %INCLUDE CP_MACROS_C;
       22     1380                   %INCLUDE XU_MACRO_C;
       23     4486                   %INCLUDE CP_SUBS_C;
       24     5403                   %INCLUDE CP_PERR_C;
       25     5741                   %INCLUDE CP_6_SUBS;
       26     6281                   %INCLUDE B_ERRORS_C;
       27     7408                   %INCLUDE CP_DATA_R;
       28     9971                   %INCLUDE AS_SUPER_C;
       29    10406               /***** Ptr variable declarations *****/
       30    10407    1   DCL TEMP$ PTR;                                   /*Temp. Pointer*/
       31    10408    1   DCL TEMP1$ PTR;                                  /*Temp. Pointer*/
       32    10409    1   DCL I SBIN;                                      /*Used for indexing*/
       33    10410    1   DCL J SBIN;
       34    10411    1   DCL CC_MAX SBIN;                                 /*Temp. Location*/
       35    10412    1   DCL CC_MAXCORE SBIN;                             /*Core limit*/
       36    10413    1   DCL CC_REMLO SBIN;                               /*Lo limit*/
       37    10414    1   DCL CC_REMCPO SBIN;                              /*Po limit*/
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:2    
       38    10415    1   DCL CC_REMDO SBIN;                               /*Do limit*/
       39    10416    1   DCL CC_MAXTMPDP SBIN;                            /*Tmpdp limit*/
       40    10417    1   DCL CC_PRDPRM SBIN;                              /*Prdprm limit*/
       41    10418    1   DCL CC_FBUL SBIN;                                /*Fpool limit*/
       42    10419    1   DCL CC_MRT SBIN;                                 /*Time limit*/
       43    10420    1   DCL TEMP_MAX SBIN;                               /*Temp. Location*/
       44    10421    1   DCL BLK$ PTR;                                    /*Parse output block ptr*/
       45    10422    1   DCL IN$ PTR;                                     /*Input buffer ptr*/
       46    10423    1   DCL OUT$ PTR;                                    /*Output buffer ptr*/
       47    10424    1   DCL DEST$ PTR;                                   /*Output buffer ptr*/
       48    10425    1   DCL TAB_VAL UBIN WORD;                           /*Tab value for printing*/
       49    10426    1   DCL VAL_B UBIN;                                  /*Batch value*/
       50    10427    1   DCL VAL_G UBIN;                                  /*Ghost value*/
       51    10428    1   DCL VAL_O UBIN;                                  /*On-line value*/
       52    10429    1   DCL VAL_CUR SBIN;                                /*Current jit value*/
       53    10430    1   DCL STEPFLAG BIT(1) UNAL;                        /*Step presence flag*/
       54    10431    1   DCL STEP_CALC BIT(1) UNAL;                       /*Perform step CALC.*/
       55    10432    1   DCL ABORTFLAG BIT(1) UNAL;                       /*Abort presence flag*/
       56    10433    1   DCL MAXSVLIM CONSTANT CHAR(23) INIT('Maximum Service Limits:');
       57    10434    1   DCL BOG CONSTANT CHAR(47) INIT('Batch       On-Line         Ghost       Current');
       58    10435    1   DCL LIMBUFF CHAR(11);                            /*Limit buffer*/
       59    10436    1   DCL 1 C_LO CONSTANT,
       60    10437    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_LO.TEXT)),
       61    10438    1          2 TEXT CHAR(2) UNAL INIT('LO');
       62    10439    1   DCL 1 C_PO CONSTANT,
       63    10440    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_PO.TEXT)),
       64    10441    1          2 TEXT CHAR(2) UNAL INIT('PO');
       65    10442    1   DCL 1 C_DO CONSTANT,
       66    10443    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_DO.TEXT)),
       67    10444    1          2 TEXT CHAR(2) UNAL INIT('DO');
       68    10445    1   DCL 1 C_TDIS CONSTANT,
       69    10446    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_TDIS.TEXT)),
       70    10447    1          2 TEXT CHAR(4) UNAL INIT('TDis');
       71    10448    1   DCL 1 C_PDIS CONSTANT,
       72    10449    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_PDIS.TEXT)),
       73    10450    1          2 TEXT CHAR(4) UNAL INIT('PDis');
       74    10451    1   DCL 1 C_FPOOLS CONSTANT,
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:3    
       75    10452    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_FPOOLS.TEXT)),
       76    10453    1          2 TEXT CHAR(6) UNAL INIT('FPools');
       77    10454    1   DCL 1 C_TIME CONSTANT,
       78    10455    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_TIME.TEXT)),
       79    10456    1          2 TEXT CHAR(4) UNAL INIT('Time');
       80    10457    1   DCL 1 C_MEMORY CONSTANT,
       81    10458    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_MEMORY.TEXT)),
       82    10459    1          2 TEXT CHAR(6) UNAL INIT('Memory');
       83    10460    1   DCL INBUFF CHAR(50);                             /*Input buffer*/
       84    10461    1   DCL OUTBUFF CHAR(120);
       85    10462    1   DCL 1 TXT_TIME,                /* time in format hhhhh:mm:ss  */
       86    10463    1          2 HR  CHAR(5),
       87    10464    1          2 *   CHAR(1),
       88    10465    1          2 MIN CHAR(2),
       89    10466    1          2 *   CHAR(1),
       90    10467    1          2 SEC CHAR(2);
       91    10468    1   DCL TXT_TIME_R REDEF TXT_TIME CHAR(11);
       92    10469              /***** External procedure (entry) declarations *****/
       93    10470    1   DCL CPA$BYE ENTRY(1) ALTRET;
       94    10471    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;                  /*Open *S file*/
       95    10472    1   DCL CPC$WRITEMSGE ENTRY(6);
       96    10473    1   DCL CPJ$ESTLIM ENTRY(3);                         /*Establish limits*/
       97    10474    1   DCL CPE$RZEROS ENTRY(3);
       98    10475    1   DCL CPJ$READ_S ENTRY(3) ALTRET;                  /*Read *S*/
       99    10476    1   DCL CPJ$WRITE_S ENTRY(3) ALTRET;                 /*Write *S*/
      100    10477    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;                /*Build print image*/
      101    10478    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;                 /*List buff contents*/
      102    10479    1   DCL CPC$RDUSERS ENTRY(2) ALTRET;
      103    10480          /***** Error codes *****/
      104    10481        %ERR_CODE (NAME=E_RESCOREMIN,MID#=CPJ$IBEXMID,CODE#=E$RESCOREMIN,STCLASS=CONSTANT);
      105    10501        %ERR_CODE (NAME=E_CANTOPN,MID#=CPJ$IBEXMID,CODE#=E$CANTOPN,STCLASS=CONSTANT);
      106    10521        %ERR_CODE (NAME=E_LIMMAX,MID#=CPJ$IBEXMID,CODE#=E$LIMMAX,STCLASS=CONSTANT);
      107    10541        %ERR_CODE (NAME=E_LIMEXCMAX,MID#=CPJ$IBEXMID,CODE#=E$LIMEXCMAX,STCLASS=CONSTANT);
      108    10561          /***** Based Structures *****/
      109    10562        %B$TCB (STCLASS="BASED(B$TCB$)");
      110    10565        %B$EXCFR;
      111    10583        %PARSE$OUT (NAME=P$B);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:4    
      112    10628        %P$PCB(NAME=P$PCB,STCLASS="");
      113    10829        %PARSE$SYM(NAME=P$S);
      114    10867        %SEG$2(NAME=SEG$2);
      115    10927        %CP_LIMREC(NAME=CP$LIMREC,STCLASS=BASED);
      116    10965        %CP_LIMREC(NAME=CP_LIMREC,STCLASS=AUTO);
      117    11003        %FPT_OPEN(FPTN=FPT$OPEN,STCLASS=BASED);
      118    11112        %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      119    11154        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED);
      120    11185        %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      121    11204        %AS_USERS(STR_NAME=AS$USERS,STCLASS=BASED);
      122    11382        %TEXTC(NAME=TEXT$C);
      123    11387                   %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:5    
      124    11388        /***********************************************************************/
      125    11389        /*F*   NAME:   CPJ$LIMIT
      126    11390               PURPOSE: The LIMIT command is utilized to set user limits for
      127    11391                       a job step,multiple job steps or for
      128    11392                       the entire job or session. Also, it will display limits.
      129    11393               REFERENCE: Programmers Reference Manual
      130    11394        */
      131    11395        /*D*   NAME:   CPJ$LIMIT
      132    11396               CALL    CALL CPJ$STEP(P$PCB)
      133    11397               INTERFACE: CPC$GETDCB,CPC$RELDCB,CPC$OPEN_S,CPJ$READ_S
      134    11398                          CPJ$WRITE_S,CPJ$ESTLIM
      135    11399               INPUT:  parse control block
      136    11400                       *S  USER MAX. - maximum specifiable for any limit
      137    11401                           CUR. MAX - current maximum in existence
      138    11402                           CUMUL. - cumulative value for the job
      139    11403               OUTPUT: JIT - set to limit values for subsequent step(s)
      140    11404                       *S  CUR. MAX - set to LIMIT command value
      141    11405                           STEP_MAX - set to LIMIT (STEP) command value
      142    11406                           CUMUL - updated to reflect amount used on prev. step(s)
      143    11407               DESCRIPTION: If a LIMIT cc is specified, the cc value cannot exceed
      144    11408                       USER_MAX-CUMUL in the *S. USER_MAX is established by
      145    11409                       a RES cc value or by LOGON from :USERS. If a step limit is
      146    11410                       specified, the cc value cannot exceed CUR_MAX-CUMUL in the
      147    11411                       *S. CUR_MAX can be established by a RES/ORES cc value, by LOGON
      148    11412                       from :USERS, or a previously estab. value from a LIMIT cc.
      149    11413                       The limits are established in the JIT as well as the *S.
      150    11414                       Step limits are established for the next job only, after which
      151    11415                       they revert back to the previously established limits
      152    11416                       found in CUR_MAX, less the amount used for the
      153    11417                       step. If no sub-blocks are found, service limits are displayed.
      154    11418        */
      155    11419        /**********************************************************************/
      156    11420    1   CPJ$LIMIT: ENTRY(P$PCB) ALTRET;
      157    11421        /**/
      158    11422        /**/
      159    11423    1     BLK$=P$PCB.OUT$;
      160    11424        /*
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:6    
      161    11425          **** No options after command indicates limits are to be displayed
      162    11426        */
      163    11427    1     IF BLK$->P$B.NSUBLKS=0
      164    11428    1        THEN
      165    11429    2           DO;
      166    11430    2              IN$=ADDR(INBUFF);
      167    11431    2              OUTBUFF=' ';
      168    11432    2              OUT$=ADDR(OUTBUFF);
      169    11433    2              DEST$=OUT$;
      170    11434    2              TAB_VAL=3;
      171    11435    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUT$;
      172    11436        /* ****      Output service limit header         */
      173    11437    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXSVLIM),SIZEC(MAXSVLIM),
      174    11438    2                   TAB_VAL) ALTRET(LIMIT85);
      175    11439    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUT$);
      176    11440    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(LIMIT85);
      177    11441        /* ****      Output bog header                   */
      178    11442    2              DEST$=PINCRC(OUT$,20);
      179    11443    2              OUTBUFF=' ';
      180    11444    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(BOG),SIZEC(BOG))
      181    11445    2                   ALTRET(LIMIT85);
      182    11446    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUT$);
      183    11447    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(LIMIT85);
      184    11448        /* ****      Obtain limit info. From :USERS      */
      185    11449    2              CALL CPC$RDUSERS (M$IBEX1_NUM,%IN#) ALTRET(LIMIT80);
      186    11450    2              DEST$=OUT$;
      187    11451    2              TAB_VAL=6;
      188    11452        /* ****      Insert lo into image                */
      189    11453    2              INBUFF=C_LO.TEXT;
      190    11454    2              VAL_CUR = B$JIT.REMLO;
      191    11455    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MLO(0),
      192    11456    2                   SEG$2.USERS$ -> AS$USERS.MLO(1),
      193    11457    2                   SEG$2.USERS$ -> AS$USERS.MLO(2),
      194    11458    2                   VAL_CUR) ALTRET(LIMIT85);
      195    11459        /* ****      Insert do into image                */
      196    11460    2              INBUFF=C_DO.TEXT;
      197    11461    2              VAL_CUR = B$JIT.REMDO;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:7    
      198    11462    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MDO(0),
      199    11463    2                   SEG$2.USERS$ -> AS$USERS.MDO(1),
      200    11464    2                   SEG$2.USERS$ -> AS$USERS.MDO(2),
      201    11465    2                   VAL_CUR) ALTRET(LIMIT85);
      202    11466        /* ****      Insert po into image                */
      203    11467    2              INBUFF=C_PO.TEXT;
      204    11468    2              VAL_CUR = B$JIT.REMCPO;
      205    11469    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MPO(0),
      206    11470    2                   SEG$2.USERS$ -> AS$USERS.MPO(1),
      207    11471    2                   SEG$2.USERS$ -> AS$USERS.MPO(2),
      208    11472    2                   VAL_CUR) ALTRET(LIMIT85);
      209    11473        /* ****      Insert pdis into image              */
      210    11474    2              INBUFF=C_PDIS.TEXT;
      211    11475    2              VAL_CUR = B$JIT.PRDPRM;
      212    11476    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MPDIS(0),
      213    11477    2                   SEG$2.USERS$ -> AS$USERS.MPDIS(1),
      214    11478    2                   SEG$2.USERS$ -> AS$USERS.MPDIS(2),
      215    11479    2                   VAL_CUR) ALTRET(LIMIT85);
      216    11480        /* ****      Insert tdis into image              */
      217    11481    2              INBUFF=C_TDIS.TEXT;
      218    11482    2              VAL_CUR = B$JIT.MAXTMPDP - B$JIT.CURTMPDP;
      219    11483    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MTDIS(0),
      220    11484    2                   SEG$2.USERS$ -> AS$USERS.MTDIS(1),
      221    11485    2                   SEG$2.USERS$ -> AS$USERS.MTDIS(2),
      222    11486    2                   VAL_CUR) ALTRET(LIMIT85);
      223    11487        /* ****      Insert fpools into image            */
      224    11488    2              INBUFF=C_FPOOLS.TEXT;
      225    11489    2              VAL_CUR = B$JIT.FBUL;
      226    11490    2              VAL_B = SEG$2.USERS$ -> AS$USERS.MFPOOLS(0);
      227    11491    2              VAL_G = SEG$2.USERS$ -> AS$USERS.MFPOOLS(1);
      228    11492    2              VAL_O = SEG$2.USERS$ -> AS$USERS.MFPOOLS(2);
      229    11493    2              CALL DISP_LIMITS(VAL_B,VAL_G,VAL_O,VAL_CUR) ALTRET(LIMIT85);
      230    11494        /* ****      Insert prio into image              */
      231    11495    2              INBUFF='Prio';
      232    11496    2              VAL_CUR = B$JIT.DEFPRI;
      233    11497    2              VAL_B = SEG$2.USERS$ -> AS$USERS.MMPRIO(0);
      234    11498    2              VAL_G = SEG$2.USERS$ -> AS$USERS.MMPRIO(1);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:8    
      235    11499    2              VAL_O = SEG$2.USERS$ -> AS$USERS.MMPRIO(2);
      236    11500    2              CALL DISP_LIMITS(VAL_B,VAL_G,VAL_O,VAL_CUR) ALTRET(LIMIT85);
      237    11501        /* ****     Insert time into image               */
      238    11502    2              DEST$ = OUT$;
      239    11503    2              INBUFF = C_TIME.TEXT;                /*Insert name*/
      240    11504    2              CALL CPB$BLDIMAGE(OUT$,DEST$,IN$,5,TAB_VAL)
      241    11505    2                   ALTRET(LIMIT85);
      242    11506    2              VAL_CUR = SEG$2.USERS$ -> AS$USERS.MTIME(0);
      243    11507    2              CALL CNVRT_TIME(VAL_CUR);
      244    11508    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(TXT_TIME),LENGTHC(TXT_TIME),
      245    11509    2                   TAB_VAL) ALTRET(LIMIT85);
      246    11510    2              VAL_CUR = SEG$2.USERS$ -> AS$USERS.MTIME(2);
      247    11511    2              CALL CNVRT_TIME(VAL_CUR);
      248    11512    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(TXT_TIME),LENGTHC(TXT_TIME),
      249    11513    2                   TAB_VAL) ALTRET(LIMIT85);
      250    11514    2              VAL_CUR = SEG$2.USERS$ -> AS$USERS.MTIME(1);
      251    11515    2              CALL CNVRT_TIME(VAL_CUR);
      252    11516    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(TXT_TIME),LENGTHC(TXT_TIME),
      253    11517    2                   TAB_VAL) ALTRET(LIMIT85);
      254    11518    2              VAL_CUR = B$JIT.MRT;
      255    11519    2              CALL CNVRT_TIME(VAL_CUR);
      256    11520    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(TXT_TIME),LENGTHC(TXT_TIME),
      257    11521    2                   TAB_VAL) ALTRET(LIMIT85);
      258    11522    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = POFFC(DEST$,OUT$);
      259    11523    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(LIMIT85);
      260    11524    2              RETURN;
      261    11525    2           END;
      262    11526        /*
      263    11527          ****  Obtain limit info. From *S file
      264    11528        */
      265    11529    1     CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(LIMIT55);
      266    11530    1     CALL CPJ$READ_S(M$IBEX1_NUM,VECTOR(K_LIMIT),VECTOR(CP_LIMREC)) ALTRET(LIMIT80);
      267    11531        /*
      268    11532          ****  Do special scan to determine presence/absence of abort and
      269    11533          ****  Step keywords. Needed when processing the other options.
      270    11534        */
      271    11535    1     STEPFLAG=%NO#;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:9    
      272    11536    1     ABORTFLAG=%NO#;
      273    11537    1     I=0;
      274    11538    2   LIMIT5: DO WHILE (I<BLK$->P$B.NSUBLKS);
      275    11539    2        TEMP$=BLK$->P$B.SUBLK$(I);
      276    11540    3   LIMIT10: DO CASE(TEMP$->P$B.CODE);
      277    11541    3         CASE(LIM_STEP);
      278    11542    3           STEPFLAG=%YES#;
      279    11543    3         CASE(LIM_ABORT);
      280    11544    3           ABORTFLAG=%YES#;
      281    11545    3         END LIMIT10;
      282    11546    2        I=I+1;
      283    11547    2     END LIMIT5;
      284    11548        /*
      285    11549          ****  Now process the remaining options specified on limit command
      286    11550          ****  Establish validity of all options before storing cc value into the
      287    11551          ****  Jit and *S.
      288    11552        */
      289    11553    1     I=0;
      290    11554    2   LIMIT15: DO WHILE (I<BLK$->P$B.NSUBLKS);
      291    11555    2        TEMP$=BLK$->P$B.SUBLK$(I);
      292    11556    2        STEP_CALC=%NO#;
      293    11557    3   LIMIT20: DO CASE(TEMP$->P$B.CODE);
      294    11558                                               /**/
      295    11559    3         CASE(LIM_LO);
      296    11560    3           IF CP_LIMREC.STEP_MAX.REMLO~=0
      297    11561    3              THEN
      298    11562    3                 STEP_CALC=%YES#;
      299    11563    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_LO,STEP_CALC);
      300    11564    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);
      301    11565        /*
      302    11566          ****        Check if value spec'd is less than what is available
      303    11567        */
      304    11568    3           IF STEPFLAG = %YES#
      305    11569    3              THEN
      306    11570    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.REMLO;
      307    11571    3              ELSE
      308    11572    3                 TEMP_MAX = CP_LIMREC.USER_MAX.REMLO - CP_LIMREC.CUMUL.REMLO;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:10   
      309    11573    3           CALL ABRT_CHK(C_LO,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);
      310    11574    3           CC_REMLO=CC_MAX;                   /*Save until all options proc*/
      311    11575                                                         /**/
      312    11576    3         CASE(LIM_PO);
      313    11577    3           IF CP_LIMREC.STEP_MAX.REMCPO~=0
      314    11578    3              THEN
      315    11579    3                 STEP_CALC=%YES#;
      316    11580    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_PO,STEP_CALC);
      317    11581    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);
      318    11582        /*
      319    11583          ****        Check if value spec'd is less than what is available
      320    11584        */
      321    11585    3           IF STEPFLAG = %YES#
      322    11586    3              THEN
      323    11587    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.REMCPO;
      324    11588    3              ELSE
      325    11589    3                 TEMP_MAX = CP_LIMREC.USER_MAX.REMCPO - CP_LIMREC.CUMUL.REMCPO;
      326    11590    3           CALL ABRT_CHK(C_PO,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);
      327    11591    3           CC_REMCPO=CC_MAX;
      328    11592                                                         /**/
      329    11593    3         CASE(LIM_DO);
      330    11594    3           IF CP_LIMREC.STEP_MAX.REMDO~=0
      331    11595    3              THEN
      332    11596    3                 STEP_CALC=%YES#;
      333    11597    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_DO,STEP_CALC);
      334    11598    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);
      335    11599        /*
      336    11600          ****        Check if value spec'd is less than what is available
      337    11601        */
      338    11602    3           IF STEPFLAG = %YES#
      339    11603    3              THEN
      340    11604    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.REMDO;
      341    11605    3              ELSE
      342    11606    3                 TEMP_MAX = CP_LIMREC.USER_MAX.REMDO - CP_LIMREC.CUMUL.REMDO;
      343    11607    3           CALL ABRT_CHK(C_DO,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);
      344    11608    3           CC_REMDO=CC_MAX;
      345    11609                                                         /**/
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:11   
      346    11610    3         CASE(LIM_MEM);
      347    11611    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);
      348    11612    3           TEMP_MAX = B$JIT.RESCORE;  /* Max set by !RES */
      349    11613    3           CALL ABRT_CHK(C_MEMORY,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);
      350    11614    3           IF (CC_MAX < B$JIT.CURRCORE)
      351    11615    3              THEN
      352    11616    4                 DO;
      353    11617    4                    CALL CPC$WRITEMSGE(E_RESCOREMIN,,,,,%YES#);
      354    11618    4                    CC_MAX = B$JIT.CURRCORE;
      355    11619    4                 END;
      356    11620        /**/
      357    11621        /*E*    ERROR: CPJ-E$RESCOREMIN-0
      358    11622                MESSAGE: Value for MEM is too small - current value used.
      359    11623                DESCRIPTION: VALUE LESS
      360    11624        THEN CURRCORE IN JIT. */
      361    11625        /**/
      362    11626    3           CC_MAXCORE=CC_MAX;
      363    11627                                                         /**/
      364    11628    3         CASE(LIM_TDIS);
      365    11629    3           IF CP_LIMREC.STEP_MAX.MAXTMPDP~=0
      366    11630    3              THEN
      367    11631    3                 STEP_CALC=%YES#;
      368    11632    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_TDIS,STEP_CALC);
      369    11633    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);
      370    11634    3           CC_MAX = CC_MAX - B$JIT.CURTMPDP ;
      371    11635        /*
      372    11636          ****        Check if value spec'd is less than what is available
      373    11637        */
      374    11638    3           TEMP_MAX = CP_LIMREC.USER_MAX.MAXTMPDP - B$JIT.CURTMPDP ;
      375    11639    3           CALL ABRT_CHK(C_TDIS,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);
      376    11640    3           CC_MAXTMPDP=CC_MAX;
      377    11641                                                         /**/
      378    11642    3         CASE(LIM_PDIS);
      379    11643    3           IF CP_LIMREC.STEP_MAX.PRDPRM~=0
      380    11644    3              THEN
      381    11645    3                 STEP_CALC=%YES#;
      382    11646    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_PDIS,STEP_CALC);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:12   
      383    11647    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);
      384    11648        /*
      385    11649          ****        Check if value spec'd is less than what is available
      386    11650        */
      387    11651    3           IF STEPFLAG
      388    11652    3              THEN
      389    11653    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.PRDPRM;
      390    11654    3              ELSE
      391    11655    3                 TEMP_MAX = CP_LIMREC.USER_MAX.PRDPRM - CP_LIMREC.CUMUL.PRDPRM;
      392    11656    3           CALL ABRT_CHK(C_PDIS,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);
      393    11657    3           CC_PRDPRM=CC_MAX;
      394    11658                                                         /**/
      395    11659    3         CASE(LIM_FPOOLS);
      396    11660    3           IF CP_LIMREC.STEP_MAX.FBUL~=0
      397    11661    3              THEN
      398    11662    3                 STEP_CALC=%YES#;
      399    11663    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_FPOOLS,STEP_CALC);
      400    11664    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);
      401    11665    3           IF STEPFLAG = %YES#
      402    11666    3              THEN
      403    11667    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.FBUL;
      404    11668    3              ELSE
      405    11669    3                 TEMP_MAX = CP_LIMREC.USER_MAX.FBUL;
      406    11670    3           CALL ABRT_CHK(C_FPOOLS,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);
      407    11671    3           CC_FBUL=CC_MAX;
      408    11672                                                         /**/
      409    11673    3         CASE(LIM_TIME);
      410    11674    3           IF CP_LIMREC.STEP_MAX.MRT~=0
      411    11675    3              THEN
      412    11676    3                 STEP_CALC=%YES#;
      413    11677    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_TIME,STEP_CALC);
      414    11678    3           CC_MAX=0;
      415    11679    4           DO J=0 TO TEMP$->P$B.NSUBLKS-1;
      416    11680    4              TEMP1$=TEMP$->P$B.SUBLK$(J);
      417    11681    4              CALL CHARBIN(TEMP_MAX,TEMP1$->P$S.TEXT);
      418    11682    5              DO CASE(TEMP1$->P$B.CODE);
      419    11683    5               CASE(LIM_HOURS);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:13   
      420    11684    5                 CC_MAX=CC_MAX + (TEMP_MAX * 3600);
      421    11685    5               CASE(LIM_MINUTS);
      422    11686    5                 CC_MAX=CC_MAX + (TEMP_MAX * 60);
      423    11687    5               CASE(LIM_SECNDS);
      424    11688    5                 CC_MAX=CC_MAX + TEMP_MAX;
      425    11689    5               END;
      426    11690    4           END;
      427    11691    3           CC_MAX=CC_MAX * 100;               /*Cnvrt to 1/100 SECS.*/
      428    11692        /*
      429    11693          ****        Check if value spec'd is less than what is available
      430    11694        */
      431    11695    3           IF STEPFLAG = %YES#
      432    11696    3              THEN
      433    11697    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.MRT;
      434    11698    3              ELSE
      435    11699    3                 TEMP_MAX = CP_LIMREC.USER_MAX.MRT - CP_LIMREC.CUMUL.MRT;
      436    11700    3           CALL ABRT_CHK(C_TIME,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);
      437    11701    3           CC_MRT=CC_MAX;
      438    11702                                                         /**/
      439    11703    3         END LIMIT20;
      440    11704    2        I=I+1;
      441    11705    2     END LIMIT15;
      442    11706        /*
      443    11707          ****  Values for limits specified are valid so establish in jit and *S
      444    11708        */
      445    11709    1     I=0;
      446    11710    2   LIMIT25: DO WHILE (I<BLK$->P$B.NSUBLKS);
      447    11711    2        TEMP$=BLK$->P$B.SUBLK$(I);
      448    11712    3   LIMIT30: DO CASE(TEMP$->P$B.CODE);
      449    11713                                                         /**/
      450    11714    3         CASE(LIM_LO);
      451    11715    3           B$JIT.REMLO=CC_REMLO;              /*Value to jit*/
      452    11716        /*
      453    11717          ****        Value to *S
      454    11718        */
      455    11719    3           IF STEPFLAG=%YES#
      456    11720    3              THEN
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:14   
      457    11721    3                 CP_LIMREC.STEP_MAX.REMLO=CC_REMLO;
      458    11722
      459    11723    3              ELSE
      460    11724    3                 CP_LIMREC.CUR_MAX.REMLO=CC_REMLO;
      461    11725                                                         /**/
      462    11726    3         CASE(LIM_PO);
      463    11727    3           B$JIT.REMCPO=CC_REMCPO;
      464    11728    3           IF STEPFLAG=%YES#
      465    11729    3              THEN
      466    11730    3                 CP_LIMREC.STEP_MAX.REMCPO=CC_REMCPO;
      467    11731
      468    11732    3              ELSE
      469    11733    3                 CP_LIMREC.CUR_MAX.REMCPO=CC_REMCPO;
      470    11734                                                         /**/
      471    11735    3         CASE(LIM_DO);
      472    11736    3           B$JIT.REMDO=CC_REMDO;
      473    11737    3           IF STEPFLAG=%YES#
      474    11738    3              THEN
      475    11739    3                 CP_LIMREC.STEP_MAX.REMDO=CC_REMDO;
      476    11740
      477    11741    3              ELSE
      478    11742    3                 CP_LIMREC.CUR_MAX.REMDO=CC_REMDO;
      479    11743                                                         /**/
      480    11744    3         CASE(LIM_MEM);
      481    11745    3           B$JIT.MAXCORE=CC_MAXCORE;
      482    11746    3           IF STEPFLAG=%YES#
      483    11747    3              THEN
      484    11748    3                 CP_LIMREC.STEP_MAX.MAXCORE=CC_MAXCORE;
      485    11749
      486    11750    3              ELSE
      487    11751    3                 CP_LIMREC.CUR_MAX.MAXCORE=CC_MAXCORE;
      488    11752                                                         /**/
      489    11753    3         CASE(LIM_TDIS);
      490    11754        /*
      491    11755          ****  B$JIT.MAXTMPDP doesn't get ticked down so must take B$JIT.CURTMPDP
      492    11756          ****  Into consideration when setting the limit.
      493    11757        */
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:15   
      494    11758    3           B$JIT.MAXTMPDP=CC_MAXTMPDP+B$JIT.CURTMPDP;
      495    11759    3           CP_LIMREC.CUMUL.MAXTMPDP = B$JIT.CURTMPDP ;
      496    11760    3           IF STEPFLAG=%YES#
      497    11761    3              THEN
      498    11762    3                 CP_LIMREC.STEP_MAX.MAXTMPDP=CC_MAXTMPDP ;
      499    11763
      500    11764    3              ELSE
      501    11765    3                 CP_LIMREC.CUR_MAX.MAXTMPDP=CC_MAXTMPDP ;
      502    11766                                                         /**/
      503    11767    3         CASE(LIM_PDIS);
      504    11768    3           B$JIT.PRDPRM=CC_PRDPRM;
      505    11769    3           IF STEPFLAG=%YES#
      506    11770    3              THEN
      507    11771    3                 CP_LIMREC.STEP_MAX.PRDPRM=CC_PRDPRM;
      508    11772
      509    11773    3              ELSE
      510    11774    3                 CP_LIMREC.CUR_MAX.PRDPRM=CC_PRDPRM;
      511    11775                                                         /**/
      512    11776    3         CASE(LIM_FPOOLS);
      513    11777    3           B$JIT.FBUL=CC_FBUL;
      514    11778    3           IF STEPFLAG=%YES#
      515    11779    3              THEN
      516    11780    3                 CP_LIMREC.STEP_MAX.FBUL=CC_FBUL;
      517    11781
      518    11782    3              ELSE
      519    11783    3                 CP_LIMREC.CUR_MAX.FBUL=CC_FBUL;
      520    11784                                                         /**/
      521    11785    3         CASE(LIM_TIME);
      522    11786    3           B$JIT.MRT=CC_MRT;
      523    11787    3           IF STEPFLAG=%YES#
      524    11788    3              THEN
      525    11789    3                 CP_LIMREC.STEP_MAX.MRT=CC_MRT;
      526    11790
      527    11791    3              ELSE
      528    11792    3                 CP_LIMREC.CUR_MAX.MRT=CC_MRT;
      529    11793                                                         /**/
      530    11794    3         END LIMIT30;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:16   
      531    11795    2        I=I+1;
      532    11796    2     END LIMIT25;
      533    11797        /*
      534    11798          **** Write out the new limit to *S
      535    11799        */
      536    11800    1     CALL CPJ$WRITE_S(M$IBEX1_NUM,VECTOR(K_LIMIT),VECTOR(CP_LIMREC))  ALTRET(LIMIT80);
      537    11801                                                /*Init. Close dcb*/
      538    11802    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX1_NUM;
      539    11803    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;
      540    11804    1     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(LIMIT65);
      541    11805        /*
      542    11806          **** Set jit flag if this was a step limit
      543    11807        */
      544    11808    1     IF STEPFLAG = %YES#
      545    11809    1        THEN
      546    11810    1           B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STEPLMT#;
      547    11811    1     RETURN;
      548    11812                   %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:17   
      549    11813    1   LIMIT45:;
      550    11814        /*
      551    11815          ****  Write out *S which has been updated to reflect previous job step(s)
      552    11816          ****  For the limits processed.
      553    11817        */
      554    11818    1     CALL CPJ$WRITE_S(M$IBEX1_NUM,VECTOR(K_LIMIT),VECTOR(CP_LIMREC)) ALTRET(LIMIT80);
      555    11819    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# =  M$IBEX1_NUM;
      556    11820    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP# = %SAVE#;
      557    11821    1     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(LIMIT47);
      558    11822    1   LIMIT47:;
      559    11823    1     CALL CPA$BYE ALTRET(LIMIT65);
      560    11824    1   LIMIT55:;
      561    11825        /*E*       ERROR: CPJ-E$CANTOPN-E
      562    11826                   MESSAGE: Unable to open %FN file
      563    11827                   DESCRIPTION: IBEX was unable to open the specified file.
      564    11828        */
      565    11829    1     CALL CPC$WRITEMSGE(E_CANTOPN,M$IBEX1_NUM,,,,%YES#);
      566    11830    1     GOTO LIMIT80;
      567    11831    1   LIMIT65:;
      568    11832    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
      569    11833    1     ALTRETURN;
      570    11834    1   LIMIT80:;
      571    11835    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX1_NUM;
      572    11836    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;
      573    11837    1     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(LIMIT85); /*Close the dcb*/
      574    11838    1   LIMIT85:;
      575    11839    1     ALTRETURN;
      576    11840                   %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:18   
      577    11841        /**********************************************************************/
      578    11842        /*I*   NAME:   ABRT_CHK
      579    11843               PURPOSE:  Determine if the LIMIT command should be aborted and output
      580    11844                         the appropriate message.
      581    11845               INTERFACE: CPC$WRITEMSGE,CPE$RZEROS
      582    11846               INPUT:  C_NAME - limit name
      583    11847                       TEMP_MAX - value specified for limit
      584    11848                       CC_MAX   - value specified on control command
      585    11849                       ABORTFLAG - abort flag set/reset
      586    11850               OUTPUT: Information or error message output to user
      587    11851                       CC_MAX - set to max. available if ABORTFLAG reset
      588    11852               DESCRIPTION: If batch and the abort flag is set the command is aborted,
      589    11853                         otherwise command processing is continued after outputting the
      590    11854                         appropriate message . In the latter case, a user is
      591    11855                         given the maximum available to him.
      592    11856        */
      593    11857        /**********************************************************************/
      594    11858    1   ABRT_CHK: PROC(C_NAME,TEMP_MAX,CC_MAX) ALTRET;
      595    11859    2   DCL 1 C_NAME,                                     /* Limit name */
      596    11860    2          2 COUNT UBIN(9) UNAL,
      597    11861    2          2 TEXT CHAR(6) UNAL;
      598    11862    2   DCL 1 C_VAL,
      599    11863    2          2 COUNT UBIN(9) UNAL,
      600    11864    2          2 TEXT CHAR(11) UNAL;
      601    11865    2   DCL TEMP UBIN WORD;                               /* Temp cell */
      602    11866    2   DCL TEMP_MAX SBIN;                               /*Max. Value*/
      603    11867    2   DCL CC_MAX SBIN;                                 /*Cc max value*/
      604    11868        /**/
      605    11869        /**/
      606    11870    2     IF CC_MAX <= TEMP_MAX
      607    11871    2        THEN
      608    11872    2           RETURN;
      609    11873        /*
      610    11874          **** If limit is time, must convert to hh:mm:ss
      611    11875        */
      612    11876    2     IF ADDR(C_NAME) -> TEXT$C.TEXT = 'Time'
      613    11877    2        THEN
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:19   
      614    11878    3           DO;
      615    11879    3              CALL CNVRT_TIME(TEMP_MAX);
      616    11880    3              C_VAL.COUNT = LENGTHC(TXT_TIME_R);
      617    11881    3              C_VAL.TEXT = TXT_TIME_R;
      618    11882    3           END;
      619    11883
      620    11884    2        ELSE
      621    11885    3           DO;
      622    11886    3              CALL BINCHAR(C_VAL.TEXT,TEMP_MAX);
      623    11887    3              CALL CPE$RZEROS(C_VAL.TEXT,SIZEC(C_VAL.TEXT),TEMP);
      624    11888    3              C_VAL.COUNT = TEMP;
      625    11889    3           END;
      626    11890    2     IF ABORTFLAG=%NO# OR B$JIT.MODE~=%M_BATCH#
      627    11891    2        THEN
      628    11892    3           DO;
      629    11893        /*E*          ERROR: CPJ-E$LIMMAX-E
      630    11894                      MESSAGE: Current maximum for %U1 is %U2
      631    11895                      DESCRIPTION: The limit specified on the LIMIT command exceeds
      632    11896                                the amount remaining.
      633    11897        */
      634    11898    3              CALL CPC$WRITEMSGE(E_LIMMAX,,C_NAME,C_VAL,,%YES#);
      635    11899        /*
      636    11900          ****           Set maximum to what is available to the user
      637    11901        */
      638    11902    3              CC_MAX=TEMP_MAX;
      639    11903    3              RETURN;
      640    11904    3           END;
      641    11905
      642    11906    2        ELSE
      643    11907    3           DO;
      644    11908        /*E*          ERROR: CPJ-E$LIMEXCMAX-E
      645    11909                      MESSAGE: Limit exceeded, current maximum for %U1 is %U2
      646    11910                      DESCRIPTION: The limit specified on the LIMIT command exceeds
      647    11911                                the amount remaining.
      648    11912        */
      649    11913    3              CALL CPC$WRITEMSGE(E_LIMEXCMAX,,C_NAME,C_VAL,,%YES#);
      650    11914    3              ALTRETURN;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:20   
      651    11915    3           END;
      652    11916    2   END ABRT_CHK;
      653    11917                  %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:21   
      654    11918        /*********************************************************************/
      655    11919        /*I*   NAME:   DISP_LIMITS
      656    11920               PURPOSE: Insert limit values into an image and output
      657    11921               INTERFACE: CPB$BLDIMAGE - build image
      658    11922                       CPE$LISTOUT - output image
      659    11923               INPUT:  VAL_B - Value for batch
      660    11924                       VAL_G - value for ghost
      661    11925                       VAL_O - value for on-line
      662    11926                       VAL_CUR - current value from JIT
      663    11927               OUTPUT: image created and output to listing device
      664    11928               DESCRIPTION: The service limit values obtained from the :USER
      665    11929                       record and from the JIT are stored into an image and
      666    11930                       output to the listing device.
      667    11931        */
      668    11932    1   DISP_LIMITS: PROC(VAL_B,VAL_G,VAL_O,VAL_CUR) ALTRET;
      669    11933    2   DCL MAXBUFF CHAR(11);                            /*Max. Value*/
      670    11934    2   DCL VAL_B UBIN;
      671    11935    2   DCL VAL_G UBIN;
      672    11936    2   DCL VAL_O UBIN;
      673    11937    2   DCL VAL_CUR UBIN;
      674    11938        /**/
      675    11939        /**/
      676    11940    2     DEST$=OUT$;
      677    11941        /* ****    Insert limit name                     */
      678    11942    2     CALL CPB$BLDIMAGE(OUT$,DEST$,IN$,11,TAB_VAL) ALTRET(DISP_LIMITS50);
      679    11943        /* ****    Insert batch value                    */
      680    11944    2     DEST$=PINCRC(DEST$,3);
      681    11945    2     CALL BINCHAR(MAXBUFF,VAL_B);
      682    11946    2     CALL CPE$RZEROS(MAXBUFF,SIZEC(MAXBUFF));
      683    11947    2     CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXBUFF),11,TAB_VAL)
      684    11948    2          ALTRET(DISP_LIMITS50);
      685    11949        /* ****    Insert on-line value                  */
      686    11950    2     DEST$=PINCRC(DEST$,3);
      687    11951    2     CALL BINCHAR(MAXBUFF,VAL_O);
      688    11952    2     CALL CPE$RZEROS(MAXBUFF,SIZEC(MAXBUFF));
      689    11953    2     CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXBUFF),11,TAB_VAL)
      690    11954    2          ALTRET(DISP_LIMITS50);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:22   
      691    11955        /* ****     insert ghost value                    */
      692    11956    2     DEST$=PINCRC(DEST$,3);
      693    11957    2     CALL BINCHAR(MAXBUFF,VAL_G);
      694    11958    2     CALL CPE$RZEROS(MAXBUFF,SIZEC(MAXBUFF));
      695    11959    2     CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXBUFF),11,TAB_VAL)
      696    11960    2          ALTRET(DISP_LIMITS50);
      697    11961    2     DEST$=PINCRC(DEST$,3);
      698    11962        /* ****    Insert current value from jit         */
      699    11963    2     CALL BINCHAR(MAXBUFF,VAL_CUR);
      700    11964    2     CALL CPE$RZEROS(MAXBUFF,SIZEC(MAXBUFF));
      701    11965    2     CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXBUFF),SIZEC(MAXBUFF))
      702    11966    2          ALTRET(DISP_LIMITS50);
      703    11967    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUT$);
      704    11968    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISP_LIMITS50);
      705    11969    2     RETURN;
      706    11970    2   DISP_LIMITS50:;
      707    11971    2     ALTRETURN;
      708    11972    2   END DISP_LIMITS;
      709    11973                   %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:23   
      710    11974        /***********************************************************************/
      711    11975        /*I*   NAME:   CNVRT_TIME
      712    11976               PURPOSE: Value for time converted to hhhhh:mm:ss
      713    11977               INTERFACE:
      714    11978               INPUT:  VAL_TIME - time value  (in centi-seconds)
      715    11979               OUTPUT: TXT_TIME (global) - time value converted to hhhhh:mm:ss
      716    11980               DESCRIPTION: The value passed for time is converted to
      717    11981                       hhhhh:mm:ss format.
      718    11982        */
      719    11983        /**********************************************************************/
      720    11984    1   CNVRT_TIME: PROC(VAL_TIME);
      721    11985    2   DCL VAL_TIME SBIN;
      722    11986    2   DCL SECS SBIN;        /* TOTAL NUMBER OF SECS IN VAL_TIME */
      723    11987    2   DCL MINS SBIN;        /* TOTAL NUMBER OF MINS IN VAL_TIME */
      724    11988    2   DCL HRS SBIN;         /* TOTAL NUMBER OF HOURS IN VAL_TIME */
      725    11989        /**/
      726    11990    2     TXT_TIME_R = '*****:**:**';
      727    11991    2     DEST$=PINCRC(DEST$,3);
      728    11992    2     SECS = VAL_TIME / 100;
      729    11993    2     MINS = SECS / 60;
      730    11994    2     HRS = MINS / 60;
      731    11995    2     CALL BINCHAR (TXT_TIME.SEC, MOD (SECS, 60));
      732    11996    2     CALL BINCHAR (TXT_TIME.MIN, MOD (MINS, 60));
      733    11997    2     CALL BINCHAR (TXT_TIME.HR, HRS);
      734    11998    2     IF (HRS = 0) THEN TXT_TIME.HR = '   00';   /* Blank out leading zeros */
      735    11999    2     ELSE IF (HRS <= 9) THEN SUBSTR(TXT_TIME.HR, 0, 4) = '    ';
      736    12000    2     ELSE IF (HRS <= 99) THEN SUBSTR(TXT_TIME.HR, 0, 3) = '   ';
      737    12001    2     ELSE IF (HRS <= 999) THEN SUBSTR(TXT_TIME.HR, 0, 2) = '  ';
      738    12002    2     ELSE IF (HRS <= 9999) THEN SUBSTR(TXT_TIME.HR, 0, 1) = ' ';
      739    12003    2     RETURN;
      740    12004    2   END CNVRT_TIME;
      741    12005    1   END CPJ$IBEX;

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:24   
--  Include file information  --

   AS_SUPER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPJ$IBEX.

   Procedure CPJ$IBEX requires 1362 words for executable code.
   Procedure CPJ$IBEX requires 128 words of local(AUTO) storage.

    No errors detected in file CPJ$IBEX.:E05TSI    .

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:25   

 Object Unit name= CPJ$IBEX                                   File name= CPJ$IBEX.:E05TOU
 UTS= JUL 29 '97 11:52:31.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     44     54  CPJ$IBEX
    2   Proc  even  none  1362   2522  CPJ$IBEX
    3  RoData even  none    37     45  CPJ$IBEX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  CPJ$IBEX
     2      3          yes     yes      Std        1  CPJ$LIMIT
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:26   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       5 CPB$BLDIMAGE
 yes     yes           Std       3 CPJ$WRITE_S
 yes     yes           Std       1 CPE$LISTOUT
 yes     yes           Std       2 CPC$RDUSERS
 yes     yes           Std       1 CPC$OPEN_S
 yes     yes           Std       3 CPJ$READ_S
         yes           Std       6 CPC$WRITEMSGE
         yes           Std       3 CPJ$ESTLIM
 yes     yes           Std       1 CPA$BYE
         yes           Std       3 CPE$RZEROS
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    SEG2$                            r    B$JIT$
r    B$TCB$                                M$IBEX1_NUM                           K_LIMIT
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:27   


        1        1        /*M* LIMIT cmd */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DFC  */
        8        8        /*P*   NAME:   CPJ$IBEX
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of selected IBEX commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPJ$IBEX:
       16       16          PROC(P$PCB) ALTRET;

     16  2 000000   000000 700200 xent  CPJ$IBEX     TSX0  ! X66_AUTO_1
         2 000001   000200 000001                    ZERO    128,1
         2 000002   000005 710000 2                  TRA     s:11423

       17       17                   %INCLUDE CP_6;
       18       98                   %INCLUDE B$JIT;
       19      388                   %INCLUDE B_STRINGS_C;
       20      517                   %INCLUDE B_MACROS_C;
       21      628                   %INCLUDE CP_MACROS_C;
       22     1380                   %INCLUDE XU_MACRO_C;
       23     4486                   %INCLUDE CP_SUBS_C;
       24     5403                   %INCLUDE CP_PERR_C;
       25     5741                   %INCLUDE CP_6_SUBS;
       26     6281                   %INCLUDE B_ERRORS_C;
       27     7408                   %INCLUDE CP_DATA_R;
       28     9971                   %INCLUDE AS_SUPER_C;
       29    10406               /***** Ptr variable declarations *****/
       30    10407    1   DCL TEMP$ PTR;                                   /*Temp. Pointer*/
       31    10408    1   DCL TEMP1$ PTR;                                  /*Temp. Pointer*/
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:28   
       32    10409    1   DCL I SBIN;                                      /*Used for indexing*/
       33    10410    1   DCL J SBIN;
       34    10411    1   DCL CC_MAX SBIN;                                 /*Temp. Location*/
       35    10412    1   DCL CC_MAXCORE SBIN;                             /*Core limit*/
       36    10413    1   DCL CC_REMLO SBIN;                               /*Lo limit*/
       37    10414    1   DCL CC_REMCPO SBIN;                              /*Po limit*/
       38    10415    1   DCL CC_REMDO SBIN;                               /*Do limit*/
       39    10416    1   DCL CC_MAXTMPDP SBIN;                            /*Tmpdp limit*/
       40    10417    1   DCL CC_PRDPRM SBIN;                              /*Prdprm limit*/
       41    10418    1   DCL CC_FBUL SBIN;                                /*Fpool limit*/
       42    10419    1   DCL CC_MRT SBIN;                                 /*Time limit*/
       43    10420    1   DCL TEMP_MAX SBIN;                               /*Temp. Location*/
       44    10421    1   DCL BLK$ PTR;                                    /*Parse output block ptr*/
       45    10422    1   DCL IN$ PTR;                                     /*Input buffer ptr*/
       46    10423    1   DCL OUT$ PTR;                                    /*Output buffer ptr*/
       47    10424    1   DCL DEST$ PTR;                                   /*Output buffer ptr*/
       48    10425    1   DCL TAB_VAL UBIN WORD;                           /*Tab value for printing*/
       49    10426    1   DCL VAL_B UBIN;                                  /*Batch value*/
       50    10427    1   DCL VAL_G UBIN;                                  /*Ghost value*/
       51    10428    1   DCL VAL_O UBIN;                                  /*On-line value*/
       52    10429    1   DCL VAL_CUR SBIN;                                /*Current jit value*/
       53    10430    1   DCL STEPFLAG BIT(1) UNAL;                        /*Step presence flag*/
       54    10431    1   DCL STEP_CALC BIT(1) UNAL;                       /*Perform step CALC.*/
       55    10432    1   DCL ABORTFLAG BIT(1) UNAL;                       /*Abort presence flag*/
       56    10433    1   DCL MAXSVLIM CONSTANT CHAR(23) INIT('Maximum Service Limits:');
       57    10434    1   DCL BOG CONSTANT CHAR(47) INIT('Batch       On-Line         Ghost       Current');
       58    10435    1   DCL LIMBUFF CHAR(11);                            /*Limit buffer*/
       59    10436    1   DCL 1 C_LO CONSTANT,
       60    10437    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_LO.TEXT)),
       61    10438    1          2 TEXT CHAR(2) UNAL INIT('LO');
       62    10439    1   DCL 1 C_PO CONSTANT,
       63    10440    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_PO.TEXT)),
       64    10441    1          2 TEXT CHAR(2) UNAL INIT('PO');
       65    10442    1   DCL 1 C_DO CONSTANT,
       66    10443    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_DO.TEXT)),
       67    10444    1          2 TEXT CHAR(2) UNAL INIT('DO');
       68    10445    1   DCL 1 C_TDIS CONSTANT,
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:29   
       69    10446    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_TDIS.TEXT)),
       70    10447    1          2 TEXT CHAR(4) UNAL INIT('TDis');
       71    10448    1   DCL 1 C_PDIS CONSTANT,
       72    10449    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_PDIS.TEXT)),
       73    10450    1          2 TEXT CHAR(4) UNAL INIT('PDis');
       74    10451    1   DCL 1 C_FPOOLS CONSTANT,
       75    10452    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_FPOOLS.TEXT)),
       76    10453    1          2 TEXT CHAR(6) UNAL INIT('FPools');
       77    10454    1   DCL 1 C_TIME CONSTANT,
       78    10455    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_TIME.TEXT)),
       79    10456    1          2 TEXT CHAR(4) UNAL INIT('Time');
       80    10457    1   DCL 1 C_MEMORY CONSTANT,
       81    10458    1          2 COUNT UBIN(9) UNAL INIT(LENGTHC(C_MEMORY.TEXT)),
       82    10459    1          2 TEXT CHAR(6) UNAL INIT('Memory');
       83    10460    1   DCL INBUFF CHAR(50);                             /*Input buffer*/
       84    10461    1   DCL OUTBUFF CHAR(120);
       85    10462    1   DCL 1 TXT_TIME,                /* time in format hhhhh:mm:ss  */
       86    10463    1          2 HR  CHAR(5),
       87    10464    1          2 *   CHAR(1),
       88    10465    1          2 MIN CHAR(2),
       89    10466    1          2 *   CHAR(1),
       90    10467    1          2 SEC CHAR(2);
       91    10468    1   DCL TXT_TIME_R REDEF TXT_TIME CHAR(11);
       92    10469              /***** External procedure (entry) declarations *****/
       93    10470    1   DCL CPA$BYE ENTRY(1) ALTRET;
       94    10471    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;                  /*Open *S file*/
       95    10472    1   DCL CPC$WRITEMSGE ENTRY(6);
       96    10473    1   DCL CPJ$ESTLIM ENTRY(3);                         /*Establish limits*/
       97    10474    1   DCL CPE$RZEROS ENTRY(3);
       98    10475    1   DCL CPJ$READ_S ENTRY(3) ALTRET;                  /*Read *S*/
       99    10476    1   DCL CPJ$WRITE_S ENTRY(3) ALTRET;                 /*Write *S*/
      100    10477    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;                /*Build print image*/
      101    10478    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;                 /*List buff contents*/
      102    10479    1   DCL CPC$RDUSERS ENTRY(2) ALTRET;
      103    10480          /***** Error codes *****/
      104    10481        %ERR_CODE (NAME=E_RESCOREMIN,MID#=CPJ$IBEXMID,CODE#=E$RESCOREMIN,STCLASS=CONSTANT);
      105    10501        %ERR_CODE (NAME=E_CANTOPN,MID#=CPJ$IBEXMID,CODE#=E$CANTOPN,STCLASS=CONSTANT);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:30   
      106    10521        %ERR_CODE (NAME=E_LIMMAX,MID#=CPJ$IBEXMID,CODE#=E$LIMMAX,STCLASS=CONSTANT);
      107    10541        %ERR_CODE (NAME=E_LIMEXCMAX,MID#=CPJ$IBEXMID,CODE#=E$LIMEXCMAX,STCLASS=CONSTANT);
      108    10561          /***** Based Structures *****/
      109    10562        %B$TCB (STCLASS="BASED(B$TCB$)");
      110    10565        %B$EXCFR;
      111    10583        %PARSE$OUT (NAME=P$B);
      112    10628        %P$PCB(NAME=P$PCB,STCLASS="");
      113    10829        %PARSE$SYM(NAME=P$S);
      114    10867        %SEG$2(NAME=SEG$2);
      115    10927        %CP_LIMREC(NAME=CP$LIMREC,STCLASS=BASED);
      116    10965        %CP_LIMREC(NAME=CP_LIMREC,STCLASS=AUTO);
      117    11003        %FPT_OPEN(FPTN=FPT$OPEN,STCLASS=BASED);
      118    11112        %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      119    11154        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED);
      120    11185        %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      121    11204        %AS_USERS(STR_NAME=AS$USERS,STCLASS=BASED);
      122    11382        %TEXTC(NAME=TEXT$C);
      123    11387                   %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:31   
      124    11388        /***********************************************************************/
      125    11389        /*F*   NAME:   CPJ$LIMIT
      126    11390               PURPOSE: The LIMIT command is utilized to set user limits for
      127    11391                       a job step,multiple job steps or for
      128    11392                       the entire job or session. Also, it will display limits.
      129    11393               REFERENCE: Programmers Reference Manual
      130    11394        */
      131    11395        /*D*   NAME:   CPJ$LIMIT
      132    11396               CALL    CALL CPJ$STEP(P$PCB)
      133    11397               INTERFACE: CPC$GETDCB,CPC$RELDCB,CPC$OPEN_S,CPJ$READ_S
      134    11398                          CPJ$WRITE_S,CPJ$ESTLIM
      135    11399               INPUT:  parse control block
      136    11400                       *S  USER MAX. - maximum specifiable for any limit
      137    11401                           CUR. MAX - current maximum in existence
      138    11402                           CUMUL. - cumulative value for the job
      139    11403               OUTPUT: JIT - set to limit values for subsequent step(s)
      140    11404                       *S  CUR. MAX - set to LIMIT command value
      141    11405                           STEP_MAX - set to LIMIT (STEP) command value
      142    11406                           CUMUL - updated to reflect amount used on prev. step(s)
      143    11407               DESCRIPTION: If a LIMIT cc is specified, the cc value cannot exceed
      144    11408                       USER_MAX-CUMUL in the *S. USER_MAX is established by
      145    11409                       a RES cc value or by LOGON from :USERS. If a step limit is
      146    11410                       specified, the cc value cannot exceed CUR_MAX-CUMUL in the
      147    11411                       *S. CUR_MAX can be established by a RES/ORES cc value, by LOGON
      148    11412                       from :USERS, or a previously estab. value from a LIMIT cc.
      149    11413                       The limits are established in the JIT as well as the *S.
      150    11414                       Step limits are established for the next job only, after which
      151    11415                       they revert back to the previously established limits
      152    11416                       found in CUR_MAX, less the amount used for the
      153    11417                       step. If no sub-blocks are found, service limits are displayed.
      154    11418        */
      155    11419        /**********************************************************************/
      156    11420    1   CPJ$LIMIT: ENTRY(P$PCB) ALTRET;

  11420  2 000003   000000 700200 xent  CPJ$LIMIT    TSX0  ! X66_AUTO_1
         2 000004   000200 000001                    ZERO    128,1

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:32   
      157    11421        /**/
      158    11422        /**/
      159    11423    1     BLK$=P$PCB.OUT$;

  11423  2 000005   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000006   000003 236100                    LDQ     3,,PR0
         2 000007   200022 756100                    STQ     BLK$,,AUTO

      160    11424        /*
      161    11425          **** No options after command indicates limits are to be displayed
      162    11426        */
      163    11427    1     IF BLK$->P$B.NSUBLKS=0

  11427  2 000010   200022 471500                    LDP1    BLK$,,AUTO
         2 000011   100001 220100                    LDX0    1,,PR1
         2 000012   000610 601000 2                  TNZ     s:11529

      164    11428    1        THEN
      165    11429    2           DO;

      166    11430    2              IN$=ADDR(INBUFF);

  11430  2 000013   200041 633500                    EPPR3   INBUFF,,AUTO
         2 000014   200023 453500                    STP3    IN$,,AUTO

      167    11431    2              OUTBUFF=' ';

  11431  2 000015   040100 100400                    MLR     fill='040'O
         2 000016   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000017   200056 000170                    ADSC9   OUTBUFF,,AUTO            cn=0,n=120

      168    11432    2              OUT$=ADDR(OUTBUFF);

  11432  2 000020   200056 634500                    EPPR4   OUTBUFF,,AUTO
         2 000021   200024 454500                    STP4    OUT$,,AUTO

      169    11433    2              DEST$=OUT$;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:33   

  11433  2 000022   200024 236100                    LDQ     OUT$,,AUTO
         2 000023   200025 756100                    STQ     DEST$,,AUTO

      170    11434    2              TAB_VAL=3;

  11434  2 000024   000003 235007                    LDA     3,DL
         2 000025   200026 755100                    STA     TAB_VAL,,AUTO

      171    11435    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUT$;

  11435  2 000026   000000 475400 xsym               LDP5    SEG2$
         2 000027   500165 476500                    LDP6    117,,PR5
         2 000030   600005 756100                    STQ     5,,PR6

      172    11436        /* ****      Output service limit header         */
      173    11437    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXSVLIM),SIZEC(MAXSVLIM),

  11437  2 000031   000000 236000 3                  LDQ     0
         2 000032   200170 756100                    STQ     HRS+2,,AUTO
         2 000033   200026 633500                    EPPR3   TAB_VAL,,AUTO
         2 000034   200175 453500                    STP3    HRS+7,,AUTO
         2 000035   000002 236000 3                  LDQ     2
         2 000036   200174 756100                    STQ     HRS+6,,AUTO
         2 000037   200170 634500                    EPPR4   HRS+2,,AUTO
         2 000040   200173 454500                    STP4    HRS+5,,AUTO
         2 000041   200025 636500                    EPPR6   DEST$,,AUTO
         2 000042   200172 456500                    STP6    HRS+4,,AUTO
         2 000043   200024 637500                    EPPR7   OUT$,,AUTO
         2 000044   200171 457500                    STP7    HRS+3,,AUTO
         2 000045   200171 630500                    EPPR0   HRS+3,,AUTO
         2 000046   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000047   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000050   002024 702000 2                  TSX2    LIMIT85

      174    11438    2                   TAB_VAL) ALTRET(LIMIT85);
      175    11439    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUT$);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:34   

  11439  2 000051   000000 470400 xsym               LDP0    SEG2$
         2 000052   000165 471500                    LDP1    117,,PR0
         2 000053   200024 236100                    LDQ     OUT$,,AUTO
         2 000054   000020 772000                    QRL     16
         2 000055   200170 756100                    STQ     HRS+2,,AUTO
         2 000056   200025 236100                    LDQ     DEST$,,AUTO
         2 000057   000020 772000                    QRL     16
         2 000060   200170 136100                    SBLQ    HRS+2,,AUTO
         2 000061   000020 736000                    QLS     16
         2 000062   100004 676100                    ERQ     4,,PR1
         2 000063   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000064   100004 656100                    ERSQ    4,,PR1

      176    11440    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(LIMIT85);

  11440  2 000065   000000 236000 xsym               LDQ     SEG2$
         2 000066   000165 036003                    ADLQ    117,DU
         2 000067   200170 756100                    STQ     HRS+2,,AUTO
         2 000070   200170 630500                    EPPR0   HRS+2,,AUTO
         2 000071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000072   000000 701000 xent               TSX1    CPE$LISTOUT
         2 000073   002024 702000 2                  TSX2    LIMIT85

      177    11441        /* ****      Output bog header                   */
      178    11442    2              DEST$=PINCRC(OUT$,20);

  11442  2 000074   200024 236100                    LDQ     OUT$,,AUTO
         2 000075   000005 036003                    ADLQ    5,DU
         2 000076   200025 756100                    STQ     DEST$,,AUTO

      179    11443    2              OUTBUFF=' ';

  11443  2 000077   040100 100400                    MLR     fill='040'O
         2 000100   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000101   200056 000170                    ADSC9   OUTBUFF,,AUTO            cn=0,n=120

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:35   
      180    11444    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(BOG),SIZEC(BOG))

  11444  2 000102   000003 236000 3                  LDQ     3
         2 000103   200170 756100                    STQ     HRS+2,,AUTO
         2 000104   000005 236000 3                  LDQ     5
         2 000105   200175 756100                    STQ     HRS+7,,AUTO
         2 000106   200170 630500                    EPPR0   HRS+2,,AUTO
         2 000107   200174 450500                    STP0    HRS+6,,AUTO
         2 000110   200025 631500                    EPPR1   DEST$,,AUTO
         2 000111   200173 451500                    STP1    HRS+5,,AUTO
         2 000112   200024 633500                    EPPR3   OUT$,,AUTO
         2 000113   200172 453500                    STP3    HRS+4,,AUTO
         2 000114   200172 630500                    EPPR0   HRS+4,,AUTO
         2 000115   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000116   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000117   002024 702000 2                  TSX2    LIMIT85

      181    11445    2                   ALTRET(LIMIT85);
      182    11446    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUT$);

  11446  2 000120   000000 470400 xsym               LDP0    SEG2$
         2 000121   000165 471500                    LDP1    117,,PR0
         2 000122   200024 236100                    LDQ     OUT$,,AUTO
         2 000123   000020 772000                    QRL     16
         2 000124   200170 756100                    STQ     HRS+2,,AUTO
         2 000125   200025 236100                    LDQ     DEST$,,AUTO
         2 000126   000020 772000                    QRL     16
         2 000127   200170 136100                    SBLQ    HRS+2,,AUTO
         2 000130   000020 736000                    QLS     16
         2 000131   100004 676100                    ERQ     4,,PR1
         2 000132   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000133   100004 656100                    ERSQ    4,,PR1

      183    11447    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(LIMIT85);

  11447  2 000134   000000 236000 xsym               LDQ     SEG2$
         2 000135   000165 036003                    ADLQ    117,DU
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:36   
         2 000136   200170 756100                    STQ     HRS+2,,AUTO
         2 000137   200170 630500                    EPPR0   HRS+2,,AUTO
         2 000140   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000141   000000 701000 xent               TSX1    CPE$LISTOUT
         2 000142   002024 702000 2                  TSX2    LIMIT85

      184    11448        /* ****      Obtain limit info. From :USERS      */
      185    11449    2              CALL CPC$RDUSERS (M$IBEX1_NUM,%IN#) ALTRET(LIMIT80);

  11449  2 000143   000006 630400 3                  EPPR0   6
         2 000144   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000145   000000 701000 xent               TSX1    CPC$RDUSERS
         2 000146   002010 702000 2                  TSX2    LIMIT80

      186    11450    2              DEST$=OUT$;

  11450  2 000147   200024 236100                    LDQ     OUT$,,AUTO
         2 000150   200025 756100                    STQ     DEST$,,AUTO

      187    11451    2              TAB_VAL=6;

  11451  2 000151   000006 235007                    LDA     6,DL
         2 000152   200026 755100                    STA     TAB_VAL,,AUTO

      188    11452        /* ****      Insert lo into image                */
      189    11453    2              INBUFF=C_LO.TEXT;

  11453  2 000153   040100 100400                    MLR     fill='040'O
         2 000154   000022 200002 1                  ADSC9   C_LO                     cn=1,n=2
         2 000155   200041 000062                    ADSC9   INBUFF,,AUTO             cn=0,n=50

      190    11454    2              VAL_CUR = B$JIT.REMLO;

  11454  2 000156   000000 470400 xsym               LDP0    B$JIT$
         2 000157   000361 235100                    LDA     241,,PR0
         2 000160   200032 755100                    STA     VAL_CUR,,AUTO

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:37   
      191    11455    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MLO(0),

  11455  2 000161   000000 471400 xsym               LDP1    SEG2$
         2 000162   100152 473500                    LDP3    106,,PR1
         2 000163   200032 634500                    EPPR4   VAL_CUR,,AUTO
         2 000164   200156 454500                    STP4    @VAL_O+1,,AUTO
         2 000165   300040 635500                    EPPR5   32,,PR3
         2 000166   200155 455500                    STP5    @VAL_G+1,,AUTO
         2 000167   300037 636500                    EPPR6   31,,PR3
         2 000170   200154 456500                    STP6    @VAL_B+1,,AUTO
         2 000171   300036 637500                    EPPR7   30,,PR3
         2 000172   200153 457500                    STP7    CP_LIMREC+28,,AUTO
         2 000173   002154 701000 2                  TSX1    DISP_LIMITS
         2 000174   002024 702000 2                  TSX2    LIMIT85

      192    11456    2                   SEG$2.USERS$ -> AS$USERS.MLO(1),
      193    11457    2                   SEG$2.USERS$ -> AS$USERS.MLO(2),
      194    11458    2                   VAL_CUR) ALTRET(LIMIT85);
      195    11459        /* ****      Insert do into image                */
      196    11460    2              INBUFF=C_DO.TEXT;

  11460  2 000175   040100 100400                    MLR     fill='040'O
         2 000176   000024 200002 1                  ADSC9   C_DO                     cn=1,n=2
         2 000177   200041 000062                    ADSC9   INBUFF,,AUTO             cn=0,n=50

      197    11461    2              VAL_CUR = B$JIT.REMDO;

  11461  2 000200   000000 470400 xsym               LDP0    B$JIT$
         2 000201   000362 235100                    LDA     242,,PR0
         2 000202   200032 755100                    STA     VAL_CUR,,AUTO

      198    11462    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MDO(0),

  11462  2 000203   000000 471400 xsym               LDP1    SEG2$
         2 000204   100152 473500                    LDP3    106,,PR1
         2 000205   200032 634500                    EPPR4   VAL_CUR,,AUTO
         2 000206   200156 454500                    STP4    @VAL_O+1,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:38   
         2 000207   300050 635500                    EPPR5   40,,PR3
         2 000210   200155 455500                    STP5    @VAL_G+1,,AUTO
         2 000211   300047 636500                    EPPR6   39,,PR3
         2 000212   200154 456500                    STP6    @VAL_B+1,,AUTO
         2 000213   300046 637500                    EPPR7   38,,PR3
         2 000214   200153 457500                    STP7    CP_LIMREC+28,,AUTO
         2 000215   002154 701000 2                  TSX1    DISP_LIMITS
         2 000216   002024 702000 2                  TSX2    LIMIT85

      199    11463    2                   SEG$2.USERS$ -> AS$USERS.MDO(1),
      200    11464    2                   SEG$2.USERS$ -> AS$USERS.MDO(2),
      201    11465    2                   VAL_CUR) ALTRET(LIMIT85);
      202    11466        /* ****      Insert po into image                */
      203    11467    2              INBUFF=C_PO.TEXT;

  11467  2 000217   040100 100400                    MLR     fill='040'O
         2 000220   000023 200002 1                  ADSC9   C_PO                     cn=1,n=2
         2 000221   200041 000062                    ADSC9   INBUFF,,AUTO             cn=0,n=50

      204    11468    2              VAL_CUR = B$JIT.REMCPO;

  11468  2 000222   000000 470400 xsym               LDP0    B$JIT$
         2 000223   000360 235100                    LDA     240,,PR0
         2 000224   200032 755100                    STA     VAL_CUR,,AUTO

      205    11469    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MPO(0),

  11469  2 000225   000000 471400 xsym               LDP1    SEG2$
         2 000226   100152 473500                    LDP3    106,,PR1
         2 000227   200032 634500                    EPPR4   VAL_CUR,,AUTO
         2 000230   200156 454500                    STP4    @VAL_O+1,,AUTO
         2 000231   300060 635500                    EPPR5   48,,PR3
         2 000232   200155 455500                    STP5    @VAL_G+1,,AUTO
         2 000233   300057 636500                    EPPR6   47,,PR3
         2 000234   200154 456500                    STP6    @VAL_B+1,,AUTO
         2 000235   300056 637500                    EPPR7   46,,PR3
         2 000236   200153 457500                    STP7    CP_LIMREC+28,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:39   
         2 000237   002154 701000 2                  TSX1    DISP_LIMITS
         2 000240   002024 702000 2                  TSX2    LIMIT85

      206    11470    2                   SEG$2.USERS$ -> AS$USERS.MPO(1),
      207    11471    2                   SEG$2.USERS$ -> AS$USERS.MPO(2),
      208    11472    2                   VAL_CUR) ALTRET(LIMIT85);
      209    11473        /* ****      Insert pdis into image              */
      210    11474    2              INBUFF=C_PDIS.TEXT;

  11474  2 000241   040100 100400                    MLR     fill='040'O
         2 000242   000027 200004 1                  ADSC9   C_PDIS                   cn=1,n=4
         2 000243   200041 000062                    ADSC9   INBUFF,,AUTO             cn=0,n=50

      211    11475    2              VAL_CUR = B$JIT.PRDPRM;

  11475  2 000244   000000 470400 xsym               LDP0    B$JIT$
         2 000245   000242 235100                    LDA     162,,PR0
         2 000246   200032 755100                    STA     VAL_CUR,,AUTO

      212    11476    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MPDIS(0),

  11476  2 000247   000000 471400 xsym               LDP1    SEG2$
         2 000250   100152 473500                    LDP3    106,,PR1
         2 000251   200032 634500                    EPPR4   VAL_CUR,,AUTO
         2 000252   200156 454500                    STP4    @VAL_O+1,,AUTO
         2 000253   300070 635500                    EPPR5   56,,PR3
         2 000254   200155 455500                    STP5    @VAL_G+1,,AUTO
         2 000255   300067 636500                    EPPR6   55,,PR3
         2 000256   200154 456500                    STP6    @VAL_B+1,,AUTO
         2 000257   300066 637500                    EPPR7   54,,PR3
         2 000260   200153 457500                    STP7    CP_LIMREC+28,,AUTO
         2 000261   002154 701000 2                  TSX1    DISP_LIMITS
         2 000262   002024 702000 2                  TSX2    LIMIT85

      213    11477    2                   SEG$2.USERS$ -> AS$USERS.MPDIS(1),
      214    11478    2                   SEG$2.USERS$ -> AS$USERS.MPDIS(2),
      215    11479    2                   VAL_CUR) ALTRET(LIMIT85);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:40   
      216    11480        /* ****      Insert tdis into image              */
      217    11481    2              INBUFF=C_TDIS.TEXT;

  11481  2 000263   040100 100400                    MLR     fill='040'O
         2 000264   000025 200004 1                  ADSC9   C_TDIS                   cn=1,n=4
         2 000265   200041 000062                    ADSC9   INBUFF,,AUTO             cn=0,n=50

      218    11482    2              VAL_CUR = B$JIT.MAXTMPDP - B$JIT.CURTMPDP;

  11482  2 000266   000000 470400 xsym               LDP0    B$JIT$
         2 000267   000241 236100                    LDQ     161,,PR0
         2 000270   000240 136100                    SBLQ    160,,PR0
         2 000271   200032 756100                    STQ     VAL_CUR,,AUTO

      219    11483    2              CALL DISP_LIMITS(SEG$2.USERS$ -> AS$USERS.MTDIS(0),

  11483  2 000272   000000 471400 xsym               LDP1    SEG2$
         2 000273   100152 473500                    LDP3    106,,PR1
         2 000274   200032 634500                    EPPR4   VAL_CUR,,AUTO
         2 000275   200156 454500                    STP4    @VAL_O+1,,AUTO
         2 000276   300100 635500                    EPPR5   64,,PR3
         2 000277   200155 455500                    STP5    @VAL_G+1,,AUTO
         2 000300   300077 636500                    EPPR6   63,,PR3
         2 000301   200154 456500                    STP6    @VAL_B+1,,AUTO
         2 000302   300076 637500                    EPPR7   62,,PR3
         2 000303   200153 457500                    STP7    CP_LIMREC+28,,AUTO
         2 000304   002154 701000 2                  TSX1    DISP_LIMITS
         2 000305   002024 702000 2                  TSX2    LIMIT85

      220    11484    2                   SEG$2.USERS$ -> AS$USERS.MTDIS(1),
      221    11485    2                   SEG$2.USERS$ -> AS$USERS.MTDIS(2),
      222    11486    2                   VAL_CUR) ALTRET(LIMIT85);
      223    11487        /* ****      Insert fpools into image            */
      224    11488    2              INBUFF=C_FPOOLS.TEXT;

  11488  2 000306   040100 100400                    MLR     fill='040'O
         2 000307   000031 200006 1                  ADSC9   C_FPOOLS                 cn=1,n=6
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:41   
         2 000310   200041 000062                    ADSC9   INBUFF,,AUTO             cn=0,n=50

      225    11489    2              VAL_CUR = B$JIT.FBUL;

  11489  2 000311   000000 470400 xsym               LDP0    B$JIT$
         2 000312   000205 236100                    LDQ     133,,PR0
         2 000313   777777 376007                    ANQ     -1,DL
         2 000314   200032 756100                    STQ     VAL_CUR,,AUTO

      226    11490    2              VAL_B = SEG$2.USERS$ -> AS$USERS.MFPOOLS(0);

  11490  2 000315   000000 471400 xsym               LDP1    SEG2$
         2 000316   100152 473500                    LDP3    106,,PR1
         2 000317   300106 236100                    LDQ     70,,PR3
         2 000320   000033 772000                    QRL     27
         2 000321   200027 756100                    STQ     VAL_B,,AUTO

      227    11491    2              VAL_G = SEG$2.USERS$ -> AS$USERS.MFPOOLS(1);

  11491  2 000322   300106 236100                    LDQ     70,,PR3
         2 000323   000022 772000                    QRL     18
         2 000324   000777 376007                    ANQ     511,DL
         2 000325   200030 756100                    STQ     VAL_G,,AUTO

      228    11492    2              VAL_O = SEG$2.USERS$ -> AS$USERS.MFPOOLS(2);

  11492  2 000326   300106 236100                    LDQ     70,,PR3
         2 000327   000011 772000                    QRL     9
         2 000330   000777 376007                    ANQ     511,DL
         2 000331   200031 756100                    STQ     VAL_O,,AUTO

      229    11493    2              CALL DISP_LIMITS(VAL_B,VAL_G,VAL_O,VAL_CUR) ALTRET(LIMIT85);

  11493  2 000332   200032 634500                    EPPR4   VAL_CUR,,AUTO
         2 000333   200156 454500                    STP4    @VAL_O+1,,AUTO
         2 000334   200031 633500                    EPPR3   VAL_O,,AUTO
         2 000335   200155 453500                    STP3    @VAL_G+1,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:42   
         2 000336   200030 635500                    EPPR5   VAL_G,,AUTO
         2 000337   200154 455500                    STP5    @VAL_B+1,,AUTO
         2 000340   200027 636500                    EPPR6   VAL_B,,AUTO
         2 000341   200153 456500                    STP6    CP_LIMREC+28,,AUTO
         2 000342   002154 701000 2                  TSX1    DISP_LIMITS
         2 000343   002024 702000 2                  TSX2    LIMIT85

      230    11494        /* ****      Insert prio into image              */
      231    11495    2              INBUFF='Prio';

  11495  2 000344   040100 100400                    MLR     fill='040'O
         2 000345   000043 000004 1                  ADSC9   E_LIMEXCMAX+1            cn=0,n=4
         2 000346   200041 000062                    ADSC9   INBUFF,,AUTO             cn=0,n=50

      232    11496    2              VAL_CUR = B$JIT.DEFPRI;

  11496  2 000347   000000 470400 xsym               LDP0    B$JIT$
         2 000350   000153 236100                    LDQ     107,,PR0
         2 000351   000033 772000                    QRL     27
         2 000352   200032 756100                    STQ     VAL_CUR,,AUTO

      233    11497    2              VAL_B = SEG$2.USERS$ -> AS$USERS.MMPRIO(0);

  11497  2 000353   000000 471400 xsym               LDP1    SEG2$
         2 000354   100152 473500                    LDP3    106,,PR1
         2 000355   300110 236100                    LDQ     72,,PR3
         2 000356   000033 772000                    QRL     27
         2 000357   200027 756100                    STQ     VAL_B,,AUTO

      234    11498    2              VAL_G = SEG$2.USERS$ -> AS$USERS.MMPRIO(1);

  11498  2 000360   300110 236100                    LDQ     72,,PR3
         2 000361   000022 772000                    QRL     18
         2 000362   000777 376007                    ANQ     511,DL
         2 000363   200030 756100                    STQ     VAL_G,,AUTO

      235    11499    2              VAL_O = SEG$2.USERS$ -> AS$USERS.MMPRIO(2);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:43   

  11499  2 000364   300110 236100                    LDQ     72,,PR3
         2 000365   000011 772000                    QRL     9
         2 000366   000777 376007                    ANQ     511,DL
         2 000367   200031 756100                    STQ     VAL_O,,AUTO

      236    11500    2              CALL DISP_LIMITS(VAL_B,VAL_G,VAL_O,VAL_CUR) ALTRET(LIMIT85);

  11500  2 000370   200032 634500                    EPPR4   VAL_CUR,,AUTO
         2 000371   200156 454500                    STP4    @VAL_O+1,,AUTO
         2 000372   200031 633500                    EPPR3   VAL_O,,AUTO
         2 000373   200155 453500                    STP3    @VAL_G+1,,AUTO
         2 000374   200030 635500                    EPPR5   VAL_G,,AUTO
         2 000375   200154 455500                    STP5    @VAL_B+1,,AUTO
         2 000376   200027 636500                    EPPR6   VAL_B,,AUTO
         2 000377   200153 456500                    STP6    CP_LIMREC+28,,AUTO
         2 000400   002154 701000 2                  TSX1    DISP_LIMITS
         2 000401   002024 702000 2                  TSX2    LIMIT85

      237    11501        /* ****     Insert time into image               */
      238    11502    2              DEST$ = OUT$;

  11502  2 000402   200024 236100                    LDQ     OUT$,,AUTO
         2 000403   200025 756100                    STQ     DEST$,,AUTO

      239    11503    2              INBUFF = C_TIME.TEXT;                /*Insert name*/

  11503  2 000404   040100 100400                    MLR     fill='040'O
         2 000405   000033 200004 1                  ADSC9   C_TIME                   cn=1,n=4
         2 000406   200041 000062                    ADSC9   INBUFF,,AUTO             cn=0,n=50

      240    11504    2              CALL CPB$BLDIMAGE(OUT$,DEST$,IN$,5,TAB_VAL)

  11504  2 000407   200026 630500                    EPPR0   TAB_VAL,,AUTO
         2 000410   200174 450500                    STP0    HRS+6,,AUTO
         2 000411   000010 236000 3                  LDQ     8
         2 000412   200173 756100                    STQ     HRS+5,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:44   
         2 000413   200023 631500                    EPPR1   IN$,,AUTO
         2 000414   200172 451500                    STP1    HRS+4,,AUTO
         2 000415   200025 633500                    EPPR3   DEST$,,AUTO
         2 000416   200171 453500                    STP3    HRS+3,,AUTO
         2 000417   200024 634500                    EPPR4   OUT$,,AUTO
         2 000420   200170 454500                    STP4    HRS+2,,AUTO
         2 000421   200170 630500                    EPPR0   HRS+2,,AUTO
         2 000422   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000423   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000424   002024 702000 2                  TSX2    LIMIT85

      241    11505    2                   ALTRET(LIMIT85);
      242    11506    2              VAL_CUR = SEG$2.USERS$ -> AS$USERS.MTIME(0);

  11506  2 000425   000000 470400 xsym               LDP0    SEG2$
         2 000426   000152 471500                    LDP1    106,,PR0
         2 000427   100251 235100                    LDA     169,,PR1
         2 000430   200032 755100                    STA     VAL_CUR,,AUTO

      243    11507    2              CALL CNVRT_TIME(VAL_CUR);

  11507  2 000431   200032 633500                    EPPR3   VAL_CUR,,AUTO
         2 000432   200163 453500                    STP3    TEMP+2,,AUTO
         2 000433   002432 701000 2                  TSX1    CNVRT_TIME
         2 000434   000000 011000                    NOP     0

      244    11508    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(TXT_TIME),LENGTHC(TXT_TIME),

  11508  2 000435   200114 630500                    EPPR0   TXT_TIME,,AUTO
         2 000436   200170 450500                    STP0    HRS+2,,AUTO
         2 000437   200026 631500                    EPPR1   TAB_VAL,,AUTO
         2 000440   200175 451500                    STP1    HRS+7,,AUTO
         2 000441   000011 236000 3                  LDQ     9
         2 000442   200174 756100                    STQ     HRS+6,,AUTO
         2 000443   200170 633500                    EPPR3   HRS+2,,AUTO
         2 000444   200173 453500                    STP3    HRS+5,,AUTO
         2 000445   200025 634500                    EPPR4   DEST$,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:45   
         2 000446   200172 454500                    STP4    HRS+4,,AUTO
         2 000447   200024 635500                    EPPR5   OUT$,,AUTO
         2 000450   200171 455500                    STP5    HRS+3,,AUTO
         2 000451   200171 630500                    EPPR0   HRS+3,,AUTO
         2 000452   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000453   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000454   002024 702000 2                  TSX2    LIMIT85

      245    11509    2                   TAB_VAL) ALTRET(LIMIT85);
      246    11510    2              VAL_CUR = SEG$2.USERS$ -> AS$USERS.MTIME(2);

  11510  2 000455   000000 470400 xsym               LDP0    SEG2$
         2 000456   000152 471500                    LDP1    106,,PR0
         2 000457   100253 235100                    LDA     171,,PR1
         2 000460   200032 755100                    STA     VAL_CUR,,AUTO

      247    11511    2              CALL CNVRT_TIME(VAL_CUR);

  11511  2 000461   200032 633500                    EPPR3   VAL_CUR,,AUTO
         2 000462   200163 453500                    STP3    TEMP+2,,AUTO
         2 000463   002432 701000 2                  TSX1    CNVRT_TIME
         2 000464   000000 011000                    NOP     0

      248    11512    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(TXT_TIME),LENGTHC(TXT_TIME),

  11512  2 000465   200114 630500                    EPPR0   TXT_TIME,,AUTO
         2 000466   200170 450500                    STP0    HRS+2,,AUTO
         2 000467   200026 631500                    EPPR1   TAB_VAL,,AUTO
         2 000470   200175 451500                    STP1    HRS+7,,AUTO
         2 000471   000011 236000 3                  LDQ     9
         2 000472   200174 756100                    STQ     HRS+6,,AUTO
         2 000473   200170 633500                    EPPR3   HRS+2,,AUTO
         2 000474   200173 453500                    STP3    HRS+5,,AUTO
         2 000475   200025 634500                    EPPR4   DEST$,,AUTO
         2 000476   200172 454500                    STP4    HRS+4,,AUTO
         2 000477   200024 635500                    EPPR5   OUT$,,AUTO
         2 000500   200171 455500                    STP5    HRS+3,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:46   
         2 000501   200171 630500                    EPPR0   HRS+3,,AUTO
         2 000502   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000503   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000504   002024 702000 2                  TSX2    LIMIT85

      249    11513    2                   TAB_VAL) ALTRET(LIMIT85);
      250    11514    2              VAL_CUR = SEG$2.USERS$ -> AS$USERS.MTIME(1);

  11514  2 000505   000000 470400 xsym               LDP0    SEG2$
         2 000506   000152 471500                    LDP1    106,,PR0
         2 000507   100252 235100                    LDA     170,,PR1
         2 000510   200032 755100                    STA     VAL_CUR,,AUTO

      251    11515    2              CALL CNVRT_TIME(VAL_CUR);

  11515  2 000511   200032 633500                    EPPR3   VAL_CUR,,AUTO
         2 000512   200163 453500                    STP3    TEMP+2,,AUTO
         2 000513   002432 701000 2                  TSX1    CNVRT_TIME
         2 000514   000000 011000                    NOP     0

      252    11516    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(TXT_TIME),LENGTHC(TXT_TIME),

  11516  2 000515   200114 630500                    EPPR0   TXT_TIME,,AUTO
         2 000516   200170 450500                    STP0    HRS+2,,AUTO
         2 000517   200026 631500                    EPPR1   TAB_VAL,,AUTO
         2 000520   200175 451500                    STP1    HRS+7,,AUTO
         2 000521   000011 236000 3                  LDQ     9
         2 000522   200174 756100                    STQ     HRS+6,,AUTO
         2 000523   200170 633500                    EPPR3   HRS+2,,AUTO
         2 000524   200173 453500                    STP3    HRS+5,,AUTO
         2 000525   200025 634500                    EPPR4   DEST$,,AUTO
         2 000526   200172 454500                    STP4    HRS+4,,AUTO
         2 000527   200024 635500                    EPPR5   OUT$,,AUTO
         2 000530   200171 455500                    STP5    HRS+3,,AUTO
         2 000531   200171 630500                    EPPR0   HRS+3,,AUTO
         2 000532   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000533   000000 701000 xent               TSX1    CPB$BLDIMAGE
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:47   
         2 000534   002024 702000 2                  TSX2    LIMIT85

      253    11517    2                   TAB_VAL) ALTRET(LIMIT85);
      254    11518    2              VAL_CUR = B$JIT.MRT;

  11518  2 000535   000000 470400 xsym               LDP0    B$JIT$
         2 000536   000276 235100                    LDA     190,,PR0
         2 000537   200032 755100                    STA     VAL_CUR,,AUTO

      255    11519    2              CALL CNVRT_TIME(VAL_CUR);

  11519  2 000540   200032 631500                    EPPR1   VAL_CUR,,AUTO
         2 000541   200163 451500                    STP1    TEMP+2,,AUTO
         2 000542   002432 701000 2                  TSX1    CNVRT_TIME
         2 000543   000000 011000                    NOP     0

      256    11520    2              CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(TXT_TIME),LENGTHC(TXT_TIME),

  11520  2 000544   200114 630500                    EPPR0   TXT_TIME,,AUTO
         2 000545   200170 450500                    STP0    HRS+2,,AUTO
         2 000546   200026 631500                    EPPR1   TAB_VAL,,AUTO
         2 000547   200175 451500                    STP1    HRS+7,,AUTO
         2 000550   000011 236000 3                  LDQ     9
         2 000551   200174 756100                    STQ     HRS+6,,AUTO
         2 000552   200170 633500                    EPPR3   HRS+2,,AUTO
         2 000553   200173 453500                    STP3    HRS+5,,AUTO
         2 000554   200025 634500                    EPPR4   DEST$,,AUTO
         2 000555   200172 454500                    STP4    HRS+4,,AUTO
         2 000556   200024 635500                    EPPR5   OUT$,,AUTO
         2 000557   200171 455500                    STP5    HRS+3,,AUTO
         2 000560   200171 630500                    EPPR0   HRS+3,,AUTO
         2 000561   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000562   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000563   002024 702000 2                  TSX2    LIMIT85

      257    11521    2                   TAB_VAL) ALTRET(LIMIT85);
      258    11522    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = POFFC(DEST$,OUT$);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:48   

  11522  2 000564   000000 470400 xsym               LDP0    SEG2$
         2 000565   000165 471500                    LDP1    117,,PR0
         2 000566   200024 236100                    LDQ     OUT$,,AUTO
         2 000567   000020 772000                    QRL     16
         2 000570   200170 756100                    STQ     HRS+2,,AUTO
         2 000571   200025 236100                    LDQ     DEST$,,AUTO
         2 000572   000020 772000                    QRL     16
         2 000573   200170 136100                    SBLQ    HRS+2,,AUTO
         2 000574   000020 736000                    QLS     16
         2 000575   100004 676100                    ERQ     4,,PR1
         2 000576   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000577   100004 656100                    ERSQ    4,,PR1

      259    11523    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(LIMIT85);

  11523  2 000600   000000 236000 xsym               LDQ     SEG2$
         2 000601   000165 036003                    ADLQ    117,DU
         2 000602   200170 756100                    STQ     HRS+2,,AUTO
         2 000603   200170 630500                    EPPR0   HRS+2,,AUTO
         2 000604   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000605   000000 701000 xent               TSX1    CPE$LISTOUT
         2 000606   002024 702000 2                  TSX2    LIMIT85

      260    11524    2              RETURN;

  11524  2 000607   000000 702200 xent               TSX2  ! X66_ARET

      261    11525    2           END;
      262    11526        /*
      263    11527          ****  Obtain limit info. From *S file
      264    11528        */
      265    11529    1     CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(LIMIT55);

  11529  2 000610   000006 630400 3                  EPPR0   6
         2 000611   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000612   000000 701000 xent               TSX1    CPC$OPEN_S
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:49   
         2 000613   001765 702000 2                  TSX2    LIMIT55

      266    11530    1     CALL CPJ$READ_S(M$IBEX1_NUM,VECTOR(K_LIMIT),VECTOR(CP_LIMREC)) ALTRET(LIMIT80);

  11530  2 000614   000014 235000 3                  LDA     12
         2 000615   200170 452500                    STP2    HRS+2,,AUTO
         2 000616   200170 236100                    LDQ     HRS+2,,AUTO
         2 000617   000117 036003                    ADLQ    79,DU
         2 000620   200172 757100                    STAQ    HRS+4,,AUTO
         2 000621   200172 630500                    EPPR0   HRS+4,,AUTO
         2 000622   200176 450500                    STP0    HRS+8,,AUTO
         2 000623   000016 237000 3                  LDAQ    14
         2 000624   200174 757100                    STAQ    HRS+6,,AUTO
         2 000625   200174 630500                    EPPR0   HRS+6,,AUTO
         2 000626   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000627   000000 701000 xent               TSX1    CPJ$READ_S
         2 000630   002010 702000 2                  TSX2    LIMIT80

      267    11531        /*
      268    11532          ****  Do special scan to determine presence/absence of abort and
      269    11533          ****  Step keywords. Needed when processing the other options.
      270    11534        */
      271    11535    1     STEPFLAG=%NO#;

  11535  2 000631   200033 450100                    STZ     STEPFLAG,,AUTO

      272    11536    1     ABORTFLAG=%NO#;

  11536  2 000632   200035 450100                    STZ     ABORTFLAG,,AUTO

      273    11537    1     I=0;

  11537  2 000633   200006 450100                    STZ     I,,AUTO

      274    11538    2   LIMIT5: DO WHILE (I<BLK$->P$B.NSUBLKS);

  11538  2 000634   200022 470500       LIMIT5       LDP0    BLK$,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:50   
         2 000635   000001 236100                    LDQ     1,,PR0
         2 000636   000022 772000                    QRL     18
         2 000637   200006 116100                    CMPQ    I,,AUTO
         2 000640   000700 604400 2                  TMOZ    s:11553

      275    11539    2        TEMP$=BLK$->P$B.SUBLK$(I);

  11539  2 000641   200022 470500                    LDP0    BLK$,,AUTO
         2 000642   200006 720100                    LXL0    I,,AUTO
         2 000643   000003 236110                    LDQ     3,X0,PR0
         2 000644   200004 756100                    STQ     TEMP$,,AUTO

      276    11540    3   LIMIT10: DO CASE(TEMP$->P$B.CODE);

  11540  2 000645   200004 471500       LIMIT10      LDP1    TEMP$,,AUTO
         2 000646   100000 721100                    LXL1    0,,PR1
         2 000647   000014 101003                    CMPX1   12,DU
         2 000650   000652 602011 2                  TNC     LIMIT10+5,X1
         2 000651   000673 710000 2                  TRA     s:11546
         2 000652   000673 710000 2                  TRA     s:11546
         2 000653   000671 710000 2                  TRA     s:11544
         2 000654   000673 710000 2                  TRA     s:11546
         2 000655   000673 710000 2                  TRA     s:11546
         2 000656   000673 710000 2                  TRA     s:11546
         2 000657   000673 710000 2                  TRA     s:11546
         2 000660   000673 710000 2                  TRA     s:11546
         2 000661   000673 710000 2                  TRA     s:11546
         2 000662   000673 710000 2                  TRA     s:11546
         2 000663   000673 710000 2                  TRA     s:11546
         2 000664   000673 710000 2                  TRA     s:11546
         2 000665   000666 710000 2                  TRA     s:11542

      277    11541    3         CASE(LIM_STEP);

      278    11542    3           STEPFLAG=%YES#;

  11542  2 000666   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:51   
         2 000667   200033 756100                    STQ     STEPFLAG,,AUTO
         2 000670   000673 710000 2                  TRA     s:11546

      279    11543    3         CASE(LIM_ABORT);

      280    11544    3           ABORTFLAG=%YES#;

  11544  2 000671   400000 236003                    LDQ     -131072,DU
         2 000672   200035 756100                    STQ     ABORTFLAG,,AUTO

      281    11545    3         END LIMIT10;

      282    11546    2        I=I+1;

  11546  2 000673   200006 054100                    AOS     I,,AUTO

      283    11547    2     END LIMIT5;

  11547  2 000674   000001 236100                    LDQ     1,,PR0
         2 000675   000022 772000                    QRL     18
         2 000676   200006 116100                    CMPQ    I,,AUTO
         2 000677   000641 605400 2                  TPNZ    s:11539

      284    11548        /*
      285    11549          ****  Now process the remaining options specified on limit command
      286    11550          ****  Establish validity of all options before storing cc value into the
      287    11551          ****  Jit and *S.
      288    11552        */
      289    11553    1     I=0;

  11553  2 000700   200006 450100                    STZ     I,,AUTO

      290    11554    2   LIMIT15: DO WHILE (I<BLK$->P$B.NSUBLKS);

  11554  2 000701   200006 116100       LIMIT15      CMPQ    I,,AUTO
         2 000702   001516 604400 2                  TMOZ    s:11709

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:52   
      291    11555    2        TEMP$=BLK$->P$B.SUBLK$(I);

  11555  2 000703   200022 470500                    LDP0    BLK$,,AUTO
         2 000704   200006 720100                    LXL0    I,,AUTO
         2 000705   000003 236110                    LDQ     3,X0,PR0
         2 000706   200004 756100                    STQ     TEMP$,,AUTO

      292    11556    2        STEP_CALC=%NO#;

  11556  2 000707   200034 450100                    STZ     STEP_CALC,,AUTO

      293    11557    3   LIMIT20: DO CASE(TEMP$->P$B.CODE);

  11557  2 000710   200004 471500       LIMIT20      LDP1    TEMP$,,AUTO
         2 000711   100000 721100                    LXL1    0,,PR1
         2 000712   000016 101003                    CMPX1   14,DU
         2 000713   000715 602011 2                  TNC     LIMIT20+5,X1
         2 000714   001510 710000 2                  TRA     s:11704
         2 000715   001510 710000 2                  TRA     s:11704
         2 000716   001510 710000 2                  TRA     s:11704
         2 000717   001053 710000 2                  TRA     s:11594
         2 000720   001314 710000 2                  TRA     s:11660
         2 000721   001510 710000 2                  TRA     s:11704
         2 000722   000733 710000 2                  TRA     s:11560
         2 000723   001123 710000 2                  TRA     s:11611
         2 000724   001510 710000 2                  TRA     s:11704
         2 000725   001244 710000 2                  TRA     s:11643
         2 000726   001003 710000 2                  TRA     s:11577
         2 000727   001510 710000 2                  TRA     s:11704
         2 000730   001510 710000 2                  TRA     s:11704
         2 000731   001175 710000 2                  TRA     s:11629
         2 000732   001367 710000 2                  TRA     s:11674

      294    11558                                               /**/
      295    11559    3         CASE(LIM_LO);

      296    11560    3           IF CP_LIMREC.STEP_MAX.REMLO~=0
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:53   

  11560  2 000733   200136 235100                    LDA     CP_LIMREC+15,,AUTO
         2 000734   000737 600000 2                  TZE     s:11563

      297    11561    3              THEN
      298    11562    3                 STEP_CALC=%YES#;

  11562  2 000735   400000 236003                    LDQ     -131072,DU
         2 000736   200034 756100                    STQ     STEP_CALC,,AUTO

      299    11563    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_LO,STEP_CALC);

  11563  2 000737   200034 633500                    EPPR3   STEP_CALC,,AUTO
         2 000740   200172 453500                    STP3    HRS+4,,AUTO
         2 000741   000010 236000 3                  LDQ     8
         2 000742   200171 756100                    STQ     HRS+3,,AUTO
         2 000743   200117 634500                    EPPR4   CP_LIMREC,,AUTO
         2 000744   200170 454500                    STP4    HRS+2,,AUTO
         2 000745   200170 630500                    EPPR0   HRS+2,,AUTO
         2 000746   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000747   000000 701000 xent               TSX1    CPJ$ESTLIM
         2 000750   000000 011000                    NOP     0

      300    11564    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);

  11564  2 000751   200004 470500                    LDP0    TEMP$,,AUTO
         2 000752   000004 236100                    LDQ     4,,PR0
         2 000753   000033 772000                    QRL     27
         2 000754   000000 620006                    EAX0    0,QL
         2 000755   000100 305540                    DTB
         2 000756   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         2 000757   200010 000004                    NDSC9   CC_MAX,,AUTO             cn=0,s=lsgnf,sf=0,n=4

      301    11565        /*
      302    11566          ****        Check if value spec'd is less than what is available
      303    11567        */
      304    11568    3           IF STEPFLAG = %YES#
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:54   

  11568  2 000760   200033 234100                    SZN     STEPFLAG,,AUTO
         2 000761   000765 605000 2                  TPL     s:11572

      305    11569    3              THEN
      306    11570    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.REMLO;

  11570  2 000762   200127 235100                    LDA     CP_LIMREC+8,,AUTO
         2 000763   200021 755100                    STA     TEMP_MAX,,AUTO
         2 000764   000770 710000 2                  TRA     s:11573

      307    11571    3              ELSE
      308    11572    3                 TEMP_MAX = CP_LIMREC.USER_MAX.REMLO - CP_LIMREC.CUMUL.REMLO;

  11572  2 000765   200120 236100                    LDQ     CP_LIMREC+1,,AUTO
         2 000766   200144 136100                    SBLQ    CP_LIMREC+21,,AUTO
         2 000767   200021 756100                    STQ     TEMP_MAX,,AUTO

      309    11573    3           CALL ABRT_CHK(C_LO,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);

  11573  2 000770   200010 631500                    EPPR1   CC_MAX,,AUTO
         2 000771   200155 451500                    STP1    @VAL_G+1,,AUTO
         2 000772   200021 633500                    EPPR3   TEMP_MAX,,AUTO
         2 000773   200154 453500                    STP3    @VAL_B+1,,AUTO
         2 000774   000015 236000 3                  LDQ     13
         2 000775   200153 756100                    STQ     CP_LIMREC+28,,AUTO
         2 000776   002025 701000 2                  TSX1    ABRT_CHK
         2 000777   001731 702000 2                  TSX2    LIMIT45

      310    11574    3           CC_REMLO=CC_MAX;                   /*Save until all options proc*/

  11574  2 001000   200010 235100                    LDA     CC_MAX,,AUTO
         2 001001   200012 755100                    STA     CC_REMLO,,AUTO
         2 001002   001510 710000 2                  TRA     s:11704

      311    11575                                                         /**/
      312    11576    3         CASE(LIM_PO);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:55   

      313    11577    3           IF CP_LIMREC.STEP_MAX.REMCPO~=0

  11577  2 001003   200137 235100                    LDA     CP_LIMREC+16,,AUTO
         2 001004   001007 600000 2                  TZE     s:11580

      314    11578    3              THEN
      315    11579    3                 STEP_CALC=%YES#;

  11579  2 001005   400000 236003                    LDQ     -131072,DU
         2 001006   200034 756100                    STQ     STEP_CALC,,AUTO

      316    11580    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_PO,STEP_CALC);

  11580  2 001007   200034 633500                    EPPR3   STEP_CALC,,AUTO
         2 001010   200172 453500                    STP3    HRS+4,,AUTO
         2 001011   000020 236000 3                  LDQ     16
         2 001012   200171 756100                    STQ     HRS+3,,AUTO
         2 001013   200117 634500                    EPPR4   CP_LIMREC,,AUTO
         2 001014   200170 454500                    STP4    HRS+2,,AUTO
         2 001015   200170 630500                    EPPR0   HRS+2,,AUTO
         2 001016   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001017   000000 701000 xent               TSX1    CPJ$ESTLIM
         2 001020   000000 011000                    NOP     0

      317    11581    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);

  11581  2 001021   200004 470500                    LDP0    TEMP$,,AUTO
         2 001022   000004 236100                    LDQ     4,,PR0
         2 001023   000033 772000                    QRL     27
         2 001024   000000 620006                    EAX0    0,QL
         2 001025   000100 305540                    DTB
         2 001026   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         2 001027   200010 000004                    NDSC9   CC_MAX,,AUTO             cn=0,s=lsgnf,sf=0,n=4

      318    11582        /*
      319    11583          ****        Check if value spec'd is less than what is available
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:56   
      320    11584        */
      321    11585    3           IF STEPFLAG = %YES#

  11585  2 001030   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001031   001035 605000 2                  TPL     s:11589

      322    11586    3              THEN
      323    11587    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.REMCPO;

  11587  2 001032   200130 235100                    LDA     CP_LIMREC+9,,AUTO
         2 001033   200021 755100                    STA     TEMP_MAX,,AUTO
         2 001034   001040 710000 2                  TRA     s:11590

      324    11588    3              ELSE
      325    11589    3                 TEMP_MAX = CP_LIMREC.USER_MAX.REMCPO - CP_LIMREC.CUMUL.REMCPO;

  11589  2 001035   200121 236100                    LDQ     CP_LIMREC+2,,AUTO
         2 001036   200145 136100                    SBLQ    CP_LIMREC+22,,AUTO
         2 001037   200021 756100                    STQ     TEMP_MAX,,AUTO

      326    11590    3           CALL ABRT_CHK(C_PO,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);

  11590  2 001040   200010 631500                    EPPR1   CC_MAX,,AUTO
         2 001041   200155 451500                    STP1    @VAL_G+1,,AUTO
         2 001042   200021 633500                    EPPR3   TEMP_MAX,,AUTO
         2 001043   200154 453500                    STP3    @VAL_B+1,,AUTO
         2 001044   000021 236000 3                  LDQ     17
         2 001045   200153 756100                    STQ     CP_LIMREC+28,,AUTO
         2 001046   002025 701000 2                  TSX1    ABRT_CHK
         2 001047   001731 702000 2                  TSX2    LIMIT45

      327    11591    3           CC_REMCPO=CC_MAX;

  11591  2 001050   200010 235100                    LDA     CC_MAX,,AUTO
         2 001051   200013 755100                    STA     CC_REMCPO,,AUTO
         2 001052   001510 710000 2                  TRA     s:11704

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:57   
      328    11592                                                         /**/
      329    11593    3         CASE(LIM_DO);

      330    11594    3           IF CP_LIMREC.STEP_MAX.REMDO~=0

  11594  2 001053   200140 235100                    LDA     CP_LIMREC+17,,AUTO
         2 001054   001057 600000 2                  TZE     s:11597

      331    11595    3              THEN
      332    11596    3                 STEP_CALC=%YES#;

  11596  2 001055   400000 236003                    LDQ     -131072,DU
         2 001056   200034 756100                    STQ     STEP_CALC,,AUTO

      333    11597    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_DO,STEP_CALC);

  11597  2 001057   200034 633500                    EPPR3   STEP_CALC,,AUTO
         2 001060   200172 453500                    STP3    HRS+4,,AUTO
         2 001061   000007 236000 3                  LDQ     7
         2 001062   200171 756100                    STQ     HRS+3,,AUTO
         2 001063   200117 634500                    EPPR4   CP_LIMREC,,AUTO
         2 001064   200170 454500                    STP4    HRS+2,,AUTO
         2 001065   200170 630500                    EPPR0   HRS+2,,AUTO
         2 001066   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001067   000000 701000 xent               TSX1    CPJ$ESTLIM
         2 001070   000000 011000                    NOP     0

      334    11598    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);

  11598  2 001071   200004 470500                    LDP0    TEMP$,,AUTO
         2 001072   000004 236100                    LDQ     4,,PR0
         2 001073   000033 772000                    QRL     27
         2 001074   000000 620006                    EAX0    0,QL
         2 001075   000100 305540                    DTB
         2 001076   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         2 001077   200010 000004                    NDSC9   CC_MAX,,AUTO             cn=0,s=lsgnf,sf=0,n=4

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:58   
      335    11599        /*
      336    11600          ****        Check if value spec'd is less than what is available
      337    11601        */
      338    11602    3           IF STEPFLAG = %YES#

  11602  2 001100   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001101   001105 605000 2                  TPL     s:11606

      339    11603    3              THEN
      340    11604    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.REMDO;

  11604  2 001102   200131 235100                    LDA     CP_LIMREC+10,,AUTO
         2 001103   200021 755100                    STA     TEMP_MAX,,AUTO
         2 001104   001110 710000 2                  TRA     s:11607

      341    11605    3              ELSE
      342    11606    3                 TEMP_MAX = CP_LIMREC.USER_MAX.REMDO - CP_LIMREC.CUMUL.REMDO;

  11606  2 001105   200122 236100                    LDQ     CP_LIMREC+3,,AUTO
         2 001106   200146 136100                    SBLQ    CP_LIMREC+23,,AUTO
         2 001107   200021 756100                    STQ     TEMP_MAX,,AUTO

      343    11607    3           CALL ABRT_CHK(C_DO,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);

  11607  2 001110   200010 631500                    EPPR1   CC_MAX,,AUTO
         2 001111   200155 451500                    STP1    @VAL_G+1,,AUTO
         2 001112   200021 633500                    EPPR3   TEMP_MAX,,AUTO
         2 001113   200154 453500                    STP3    @VAL_B+1,,AUTO
         2 001114   000022 236000 3                  LDQ     18
         2 001115   200153 756100                    STQ     CP_LIMREC+28,,AUTO
         2 001116   002025 701000 2                  TSX1    ABRT_CHK
         2 001117   001731 702000 2                  TSX2    LIMIT45

      344    11608    3           CC_REMDO=CC_MAX;

  11608  2 001120   200010 235100                    LDA     CC_MAX,,AUTO
         2 001121   200014 755100                    STA     CC_REMDO,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:59   
         2 001122   001510 710000 2                  TRA     s:11704

      345    11609                                                         /**/
      346    11610    3         CASE(LIM_MEM);

      347    11611    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);

  11611  2 001123   100004 236100                    LDQ     4,,PR1
         2 001124   000033 772000                    QRL     27
         2 001125   000000 622006                    EAX2    0,QL
         2 001126   000100 305540                    DTB
         2 001127   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
         2 001130   200010 000004                    NDSC9   CC_MAX,,AUTO             cn=0,s=lsgnf,sf=0,n=4

      348    11612    3           TEMP_MAX = B$JIT.RESCORE;  /* Max set by !RES */

  11612  2 001131   000000 473400 xsym               LDP3    B$JIT$
         2 001132   300336 235100                    LDA     222,,PR3
         2 001133   200021 755100                    STA     TEMP_MAX,,AUTO

      349    11613    3           CALL ABRT_CHK(C_MEMORY,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);

  11613  2 001134   200010 634500                    EPPR4   CC_MAX,,AUTO
         2 001135   200155 454500                    STP4    @VAL_G+1,,AUTO
         2 001136   200021 635500                    EPPR5   TEMP_MAX,,AUTO
         2 001137   200154 455500                    STP5    @VAL_B+1,,AUTO
         2 001140   000023 236000 3                  LDQ     19
         2 001141   200153 756100                    STQ     CP_LIMREC+28,,AUTO
         2 001142   002025 701000 2                  TSX1    ABRT_CHK
         2 001143   001731 702000 2                  TSX2    LIMIT45

      350    11614    3           IF (CC_MAX < B$JIT.CURRCORE)

  11614  2 001144   000000 470400 xsym               LDP0    B$JIT$
         2 001145   000210 236100                    LDQ     136,,PR0
         2 001146   777777 376007                    ANQ     -1,DL
         2 001147   200010 116100                    CMPQ    CC_MAX,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:60   
         2 001150   001172 604400 2                  TMOZ    s:11626

      351    11615    3              THEN
      352    11616    4                 DO;

      353    11617    4                    CALL CPC$WRITEMSGE(E_RESCOREMIN,,,,,%YES#);

  11617  2 001151   000024 236000 3                  LDQ     20
         2 001152   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001153   200174 757100                    STAQ    HRS+6,,AUTO
         2 001154   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001155   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001156   200172 757100                    STAQ    HRS+4,,AUTO
         2 001157   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001160   000025 235000 3                  LDA     21
         2 001161   200170 757100                    STAQ    HRS+2,,AUTO
         2 001162   200170 630500                    EPPR0   HRS+2,,AUTO
         2 001163   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001164   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 001165   000000 011000                    NOP     0

      354    11618    4                    CC_MAX = B$JIT.CURRCORE;

  11618  2 001166   000000 470400 xsym               LDP0    B$JIT$
         2 001167   000210 236100                    LDQ     136,,PR0
         2 001170   777777 376007                    ANQ     -1,DL
         2 001171   200010 756100                    STQ     CC_MAX,,AUTO

      355    11619    4                 END;

      356    11620        /**/
      357    11621        /*E*    ERROR: CPJ-E$RESCOREMIN-0
      358    11622                MESSAGE: Value for MEM is too small - current value used.
      359    11623                DESCRIPTION: VALUE LESS
      360    11624        THEN CURRCORE IN JIT. */
      361    11625        /**/
      362    11626    3           CC_MAXCORE=CC_MAX;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:61   

  11626  2 001172   200010 235100                    LDA     CC_MAX,,AUTO
         2 001173   200011 755100                    STA     CC_MAXCORE,,AUTO
         2 001174   001510 710000 2                  TRA     s:11704

      363    11627                                                         /**/
      364    11628    3         CASE(LIM_TDIS);

      365    11629    3           IF CP_LIMREC.STEP_MAX.MAXTMPDP~=0

  11629  2 001175   200142 235100                    LDA     CP_LIMREC+19,,AUTO
         2 001176   001201 600000 2                  TZE     s:11632

      366    11630    3              THEN
      367    11631    3                 STEP_CALC=%YES#;

  11631  2 001177   400000 236003                    LDQ     -131072,DU
         2 001200   200034 756100                    STQ     STEP_CALC,,AUTO

      368    11632    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_TDIS,STEP_CALC);

  11632  2 001201   200034 633500                    EPPR3   STEP_CALC,,AUTO
         2 001202   200172 453500                    STP3    HRS+4,,AUTO
         2 001203   000027 236000 3                  LDQ     23
         2 001204   200171 756100                    STQ     HRS+3,,AUTO
         2 001205   200117 634500                    EPPR4   CP_LIMREC,,AUTO
         2 001206   200170 454500                    STP4    HRS+2,,AUTO
         2 001207   200170 630500                    EPPR0   HRS+2,,AUTO
         2 001210   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001211   000000 701000 xent               TSX1    CPJ$ESTLIM
         2 001212   000000 011000                    NOP     0

      369    11633    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);

  11633  2 001213   200004 470500                    LDP0    TEMP$,,AUTO
         2 001214   000004 236100                    LDQ     4,,PR0
         2 001215   000033 772000                    QRL     27
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:62   
         2 001216   000000 620006                    EAX0    0,QL
         2 001217   000100 305540                    DTB
         2 001220   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         2 001221   200010 000004                    NDSC9   CC_MAX,,AUTO             cn=0,s=lsgnf,sf=0,n=4

      370    11634    3           CC_MAX = CC_MAX - B$JIT.CURTMPDP ;

  11634  2 001222   000000 471400 xsym               LDP1    B$JIT$
         2 001223   200010 236100                    LDQ     CC_MAX,,AUTO
         2 001224   100240 136100                    SBLQ    160,,PR1
         2 001225   200010 756100                    STQ     CC_MAX,,AUTO

      371    11635        /*
      372    11636          ****        Check if value spec'd is less than what is available
      373    11637        */
      374    11638    3           TEMP_MAX = CP_LIMREC.USER_MAX.MAXTMPDP - B$JIT.CURTMPDP ;

  11638  2 001226   200124 236100                    LDQ     CP_LIMREC+5,,AUTO
         2 001227   100240 136100                    SBLQ    160,,PR1
         2 001230   200021 756100                    STQ     TEMP_MAX,,AUTO

      375    11639    3           CALL ABRT_CHK(C_TDIS,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);

  11639  2 001231   200010 633500                    EPPR3   CC_MAX,,AUTO
         2 001232   200155 453500                    STP3    @VAL_G+1,,AUTO
         2 001233   200021 634500                    EPPR4   TEMP_MAX,,AUTO
         2 001234   200154 454500                    STP4    @VAL_B+1,,AUTO
         2 001235   000030 236000 3                  LDQ     24
         2 001236   200153 756100                    STQ     CP_LIMREC+28,,AUTO
         2 001237   002025 701000 2                  TSX1    ABRT_CHK
         2 001240   001731 702000 2                  TSX2    LIMIT45

      376    11640    3           CC_MAXTMPDP=CC_MAX;

  11640  2 001241   200010 235100                    LDA     CC_MAX,,AUTO
         2 001242   200015 755100                    STA     CC_MAXTMPDP,,AUTO
         2 001243   001510 710000 2                  TRA     s:11704
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:63   

      377    11641                                                         /**/
      378    11642    3         CASE(LIM_PDIS);

      379    11643    3           IF CP_LIMREC.STEP_MAX.PRDPRM~=0

  11643  2 001244   200141 235100                    LDA     CP_LIMREC+18,,AUTO
         2 001245   001250 600000 2                  TZE     s:11646

      380    11644    3              THEN
      381    11645    3                 STEP_CALC=%YES#;

  11645  2 001246   400000 236003                    LDQ     -131072,DU
         2 001247   200034 756100                    STQ     STEP_CALC,,AUTO

      382    11646    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_PDIS,STEP_CALC);

  11646  2 001250   200034 633500                    EPPR3   STEP_CALC,,AUTO
         2 001251   200172 453500                    STP3    HRS+4,,AUTO
         2 001252   000031 236000 3                  LDQ     25
         2 001253   200171 756100                    STQ     HRS+3,,AUTO
         2 001254   200117 634500                    EPPR4   CP_LIMREC,,AUTO
         2 001255   200170 454500                    STP4    HRS+2,,AUTO
         2 001256   200170 630500                    EPPR0   HRS+2,,AUTO
         2 001257   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001260   000000 701000 xent               TSX1    CPJ$ESTLIM
         2 001261   000000 011000                    NOP     0

      383    11647    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);

  11647  2 001262   200004 470500                    LDP0    TEMP$,,AUTO
         2 001263   000004 236100                    LDQ     4,,PR0
         2 001264   000033 772000                    QRL     27
         2 001265   000000 620006                    EAX0    0,QL
         2 001266   000100 305540                    DTB
         2 001267   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         2 001270   200010 000004                    NDSC9   CC_MAX,,AUTO             cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:64   

      384    11648        /*
      385    11649          ****        Check if value spec'd is less than what is available
      386    11650        */
      387    11651    3           IF STEPFLAG

  11651  2 001271   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001272   001276 605000 2                  TPL     s:11655

      388    11652    3              THEN
      389    11653    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.PRDPRM;

  11653  2 001273   200132 235100                    LDA     CP_LIMREC+11,,AUTO
         2 001274   200021 755100                    STA     TEMP_MAX,,AUTO
         2 001275   001301 710000 2                  TRA     s:11656

      390    11654    3              ELSE
      391    11655    3                 TEMP_MAX = CP_LIMREC.USER_MAX.PRDPRM - CP_LIMREC.CUMUL.PRDPRM;

  11655  2 001276   200123 236100                    LDQ     CP_LIMREC+4,,AUTO
         2 001277   200150 136100                    SBLQ    CP_LIMREC+25,,AUTO
         2 001300   200021 756100                    STQ     TEMP_MAX,,AUTO

      392    11656    3           CALL ABRT_CHK(C_PDIS,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);

  11656  2 001301   200010 631500                    EPPR1   CC_MAX,,AUTO
         2 001302   200155 451500                    STP1    @VAL_G+1,,AUTO
         2 001303   200021 633500                    EPPR3   TEMP_MAX,,AUTO
         2 001304   200154 453500                    STP3    @VAL_B+1,,AUTO
         2 001305   000032 236000 3                  LDQ     26
         2 001306   200153 756100                    STQ     CP_LIMREC+28,,AUTO
         2 001307   002025 701000 2                  TSX1    ABRT_CHK
         2 001310   001731 702000 2                  TSX2    LIMIT45

      393    11657    3           CC_PRDPRM=CC_MAX;

  11657  2 001311   200010 235100                    LDA     CC_MAX,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:65   
         2 001312   200016 755100                    STA     CC_PRDPRM,,AUTO
         2 001313   001510 710000 2                  TRA     s:11704

      394    11658                                                         /**/
      395    11659    3         CASE(LIM_FPOOLS);

      396    11660    3           IF CP_LIMREC.STEP_MAX.FBUL~=0

  11660  2 001314   200135 722100                    LXL2    CP_LIMREC+14,,AUTO
         2 001315   001320 600000 2                  TZE     s:11663

      397    11661    3              THEN
      398    11662    3                 STEP_CALC=%YES#;

  11662  2 001316   400000 236003                    LDQ     -131072,DU
         2 001317   200034 756100                    STQ     STEP_CALC,,AUTO

      399    11663    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_FPOOLS,STEP_CALC);

  11663  2 001320   200034 633500                    EPPR3   STEP_CALC,,AUTO
         2 001321   200172 453500                    STP3    HRS+4,,AUTO
         2 001322   000033 236000 3                  LDQ     27
         2 001323   200171 756100                    STQ     HRS+3,,AUTO
         2 001324   200117 634500                    EPPR4   CP_LIMREC,,AUTO
         2 001325   200170 454500                    STP4    HRS+2,,AUTO
         2 001326   200170 630500                    EPPR0   HRS+2,,AUTO
         2 001327   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001330   000000 701000 xent               TSX1    CPJ$ESTLIM
         2 001331   000000 011000                    NOP     0

      400    11664    3           CALL CHARBIN(CC_MAX,TEMP$->P$S.TEXT);

  11664  2 001332   200004 470500                    LDP0    TEMP$,,AUTO
         2 001333   000004 236100                    LDQ     4,,PR0
         2 001334   000033 772000                    QRL     27
         2 001335   000000 620006                    EAX0    0,QL
         2 001336   000100 305540                    DTB
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:66   
         2 001337   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         2 001340   200010 000004                    NDSC9   CC_MAX,,AUTO             cn=0,s=lsgnf,sf=0,n=4

      401    11665    3           IF STEPFLAG = %YES#

  11665  2 001341   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001342   001350 605000 2                  TPL     s:11669

      402    11666    3              THEN
      403    11667    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.FBUL;

  11667  2 001343   200126 236100                    LDQ     CP_LIMREC+7,,AUTO
         2 001344   000022 736000                    QLS     18
         2 001345   000022 732000                    QRS     18
         2 001346   200021 756100                    STQ     TEMP_MAX,,AUTO
         2 001347   001354 710000 2                  TRA     s:11670

      404    11668    3              ELSE
      405    11669    3                 TEMP_MAX = CP_LIMREC.USER_MAX.FBUL;

  11669  2 001350   200117 236100                    LDQ     CP_LIMREC,,AUTO
         2 001351   000022 736000                    QLS     18
         2 001352   000022 732000                    QRS     18
         2 001353   200021 756100                    STQ     TEMP_MAX,,AUTO

      406    11670    3           CALL ABRT_CHK(C_FPOOLS,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);

  11670  2 001354   200010 631500                    EPPR1   CC_MAX,,AUTO
         2 001355   200155 451500                    STP1    @VAL_G+1,,AUTO
         2 001356   200021 633500                    EPPR3   TEMP_MAX,,AUTO
         2 001357   200154 453500                    STP3    @VAL_B+1,,AUTO
         2 001360   000034 236000 3                  LDQ     28
         2 001361   200153 756100                    STQ     CP_LIMREC+28,,AUTO
         2 001362   002025 701000 2                  TSX1    ABRT_CHK
         2 001363   001731 702000 2                  TSX2    LIMIT45

      407    11671    3           CC_FBUL=CC_MAX;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:67   

  11671  2 001364   200010 235100                    LDA     CC_MAX,,AUTO
         2 001365   200017 755100                    STA     CC_FBUL,,AUTO
         2 001366   001510 710000 2                  TRA     s:11704

      408    11672                                                         /**/
      409    11673    3         CASE(LIM_TIME);

      410    11674    3           IF CP_LIMREC.STEP_MAX.MRT~=0

  11674  2 001367   200143 235100                    LDA     CP_LIMREC+20,,AUTO
         2 001370   001373 600000 2                  TZE     s:11677

      411    11675    3              THEN
      412    11676    3                 STEP_CALC=%YES#;

  11676  2 001371   400000 236003                    LDQ     -131072,DU
         2 001372   200034 756100                    STQ     STEP_CALC,,AUTO

      413    11677    3           CALL CPJ$ESTLIM(CP_LIMREC,LIM_TIME,STEP_CALC);

  11677  2 001373   200034 633500                    EPPR3   STEP_CALC,,AUTO
         2 001374   200172 453500                    STP3    HRS+4,,AUTO
         2 001375   000036 236000 3                  LDQ     30
         2 001376   200171 756100                    STQ     HRS+3,,AUTO
         2 001377   200117 634500                    EPPR4   CP_LIMREC,,AUTO
         2 001400   200170 454500                    STP4    HRS+2,,AUTO
         2 001401   200170 630500                    EPPR0   HRS+2,,AUTO
         2 001402   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001403   000000 701000 xent               TSX1    CPJ$ESTLIM
         2 001404   000000 011000                    NOP     0

      414    11678    3           CC_MAX=0;

  11678  2 001405   200010 450100                    STZ     CC_MAX,,AUTO

      415    11679    4           DO J=0 TO TEMP$->P$B.NSUBLKS-1;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:68   

  11679  2 001406   200007 450100                    STZ     J,,AUTO
         2 001407   001456 710000 2                  TRA     s:11690+1

      416    11680    4              TEMP1$=TEMP$->P$B.SUBLK$(J);

  11680  2 001410   200004 470500                    LDP0    TEMP$,,AUTO
         2 001411   200007 720100                    LXL0    J,,AUTO
         2 001412   000003 236110                    LDQ     3,X0,PR0
         2 001413   200005 756100                    STQ     TEMP1$,,AUTO

      417    11681    4              CALL CHARBIN(TEMP_MAX,TEMP1$->P$S.TEXT);

  11681  2 001414   200005 471500                    LDP1    TEMP1$,,AUTO
         2 001415   100004 236100                    LDQ     4,,PR1
         2 001416   000033 772000                    QRL     27
         2 001417   000000 621006                    EAX1    0,QL
         2 001420   000100 305540                    DTB
         2 001421   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         2 001422   200021 000004                    NDSC9   TEMP_MAX,,AUTO           cn=0,s=lsgnf,sf=0,n=4

      418    11682    5              DO CASE(TEMP1$->P$B.CODE);

  11682  2 001423   100000 236100                    LDQ     0,,PR1
         2 001424   777777 376007                    ANQ     -1,DL
         2 001425   000004 136007                    SBLQ    4,DL
         2 001426   000007 116007                    CMPQ    7,DL
         2 001427   001431 602006 2                  TNC     s:11682+6,QL
         2 001430   001455 710000 2                  TRA     s:11690
         2 001431   001440 710000 2                  TRA     s:11684
         2 001432   001455 710000 2                  TRA     s:11690
         2 001433   001455 710000 2                  TRA     s:11690
         2 001434   001445 710000 2                  TRA     s:11686
         2 001435   001455 710000 2                  TRA     s:11690
         2 001436   001455 710000 2                  TRA     s:11690
         2 001437   001452 710000 2                  TRA     s:11688

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:69   
      419    11683    5               CASE(LIM_HOURS);

      420    11684    5                 CC_MAX=CC_MAX + (TEMP_MAX * 3600);

  11684  2 001440   200021 236100                    LDQ     TEMP_MAX,,AUTO
         2 001441   007020 402007                    MPY     3600,DL
         2 001442   200010 036100                    ADLQ    CC_MAX,,AUTO
         2 001443   200010 756100                    STQ     CC_MAX,,AUTO
         2 001444   001455 710000 2                  TRA     s:11690

      421    11685    5               CASE(LIM_MINUTS);

      422    11686    5                 CC_MAX=CC_MAX + (TEMP_MAX * 60);

  11686  2 001445   200021 236100                    LDQ     TEMP_MAX,,AUTO
         2 001446   000074 402007                    MPY     60,DL
         2 001447   200010 036100                    ADLQ    CC_MAX,,AUTO
         2 001450   200010 756100                    STQ     CC_MAX,,AUTO
         2 001451   001455 710000 2                  TRA     s:11690

      423    11687    5               CASE(LIM_SECNDS);

      424    11688    5                 CC_MAX=CC_MAX + TEMP_MAX;

  11688  2 001452   200010 236100                    LDQ     CC_MAX,,AUTO
         2 001453   200021 036100                    ADLQ    TEMP_MAX,,AUTO
         2 001454   200010 756100                    STQ     CC_MAX,,AUTO

      425    11689    5               END;

      426    11690    4           END;

  11690  2 001455   200007 054100                    AOS     J,,AUTO
         2 001456   200004 470500                    LDP0    TEMP$,,AUTO
         2 001457   000001 236100                    LDQ     1,,PR0
         2 001460   000022 772000                    QRL     18
         2 001461   200007 116100                    CMPQ    J,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:70   
         2 001462   001410 605400 2                  TPNZ    s:11680

      427    11691    3           CC_MAX=CC_MAX * 100;               /*Cnvrt to 1/100 SECS.*/

  11691  2 001463   200010 236100                    LDQ     CC_MAX,,AUTO
         2 001464   000144 402007                    MPY     100,DL
         2 001465   200010 756100                    STQ     CC_MAX,,AUTO

      428    11692        /*
      429    11693          ****        Check if value spec'd is less than what is available
      430    11694        */
      431    11695    3           IF STEPFLAG = %YES#

  11695  2 001466   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001467   001473 605000 2                  TPL     s:11699

      432    11696    3              THEN
      433    11697    3                 TEMP_MAX = CP_LIMREC.CUR_MAX.MRT;

  11697  2 001470   200134 235100                    LDA     CP_LIMREC+13,,AUTO
         2 001471   200021 755100                    STA     TEMP_MAX,,AUTO
         2 001472   001476 710000 2                  TRA     s:11700

      434    11698    3              ELSE
      435    11699    3                 TEMP_MAX = CP_LIMREC.USER_MAX.MRT - CP_LIMREC.CUMUL.MRT;

  11699  2 001473   200125 236100                    LDQ     CP_LIMREC+6,,AUTO
         2 001474   200151 136100                    SBLQ    CP_LIMREC+26,,AUTO
         2 001475   200021 756100                    STQ     TEMP_MAX,,AUTO

      436    11700    3           CALL ABRT_CHK(C_TIME,TEMP_MAX,CC_MAX) ALTRET(LIMIT45);

  11700  2 001476   200010 631500                    EPPR1   CC_MAX,,AUTO
         2 001477   200155 451500                    STP1    @VAL_G+1,,AUTO
         2 001500   200021 633500                    EPPR3   TEMP_MAX,,AUTO
         2 001501   200154 453500                    STP3    @VAL_B+1,,AUTO
         2 001502   000037 236000 3                  LDQ     31
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:71   
         2 001503   200153 756100                    STQ     CP_LIMREC+28,,AUTO
         2 001504   002025 701000 2                  TSX1    ABRT_CHK
         2 001505   001731 702000 2                  TSX2    LIMIT45

      437    11701    3           CC_MRT=CC_MAX;

  11701  2 001506   200010 235100                    LDA     CC_MAX,,AUTO
         2 001507   200020 755100                    STA     CC_MRT,,AUTO

      438    11702                                                         /**/
      439    11703    3         END LIMIT20;

      440    11704    2        I=I+1;

  11704  2 001510   200006 054100                    AOS     I,,AUTO

      441    11705    2     END LIMIT15;

  11705  2 001511   200022 470500                    LDP0    BLK$,,AUTO
         2 001512   000001 236100                    LDQ     1,,PR0
         2 001513   000022 772000                    QRL     18
         2 001514   200006 116100                    CMPQ    I,,AUTO
         2 001515   000703 605400 2                  TPNZ    s:11555

      442    11706        /*
      443    11707          ****  Values for limits specified are valid so establish in jit and *S
      444    11708        */
      445    11709    1     I=0;

  11709  2 001516   200006 450100                    STZ     I,,AUTO

      446    11710    2   LIMIT25: DO WHILE (I<BLK$->P$B.NSUBLKS);

  11710  2 001517   200006 116100       LIMIT25      CMPQ    I,,AUTO
         2 001520   001671 604400 2                  TMOZ    s:11800

      447    11711    2        TEMP$=BLK$->P$B.SUBLK$(I);
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:72   

  11711  2 001521   200022 470500                    LDP0    BLK$,,AUTO
         2 001522   200006 720100                    LXL0    I,,AUTO
         2 001523   000003 236110                    LDQ     3,X0,PR0
         2 001524   200004 756100                    STQ     TEMP$,,AUTO

      448    11712    3   LIMIT30: DO CASE(TEMP$->P$B.CODE);

  11712  2 001525   200004 471500       LIMIT30      LDP1    TEMP$,,AUTO
         2 001526   100000 721100                    LXL1    0,,PR1
         2 001527   000016 101003                    CMPX1   14,DU
         2 001530   001532 602011 2                  TNC     LIMIT30+5,X1
         2 001531   001664 710000 2                  TRA     s:11795
         2 001532   001664 710000 2                  TRA     s:11795
         2 001533   001664 710000 2                  TRA     s:11795
         2 001534   001572 710000 2                  TRA     s:11736
         2 001535   001643 710000 2                  TRA     s:11777
         2 001536   001664 710000 2                  TRA     s:11795
         2 001537   001550 710000 2                  TRA     s:11715
         2 001540   001603 710000 2                  TRA     s:11745
         2 001541   001664 710000 2                  TRA     s:11795
         2 001542   001632 710000 2                  TRA     s:11768
         2 001543   001561 710000 2                  TRA     s:11727
         2 001544   001664 710000 2                  TRA     s:11795
         2 001545   001664 710000 2                  TRA     s:11795
         2 001546   001614 710000 2                  TRA     s:11758
         2 001547   001654 710000 2                  TRA     s:11786

      449    11713                                                         /**/
      450    11714    3         CASE(LIM_LO);

      451    11715    3           B$JIT.REMLO=CC_REMLO;              /*Value to jit*/

  11715  2 001550   000000 473400 xsym               LDP3    B$JIT$
         2 001551   200012 235100                    LDA     CC_REMLO,,AUTO
         2 001552   300361 755100                    STA     241,,PR3

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:73   
      452    11716        /*
      453    11717          ****        Value to *S
      454    11718        */
      455    11719    3           IF STEPFLAG=%YES#

  11719  2 001553   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001554   001557 605000 2                  TPL     s:11724

      456    11720    3              THEN
      457    11721    3                 CP_LIMREC.STEP_MAX.REMLO=CC_REMLO;

  11721  2 001555   200136 755100                    STA     CP_LIMREC+15,,AUTO
         2 001556   001664 710000 2                  TRA     s:11795

      458    11722
      459    11723    3              ELSE
      460    11724    3                 CP_LIMREC.CUR_MAX.REMLO=CC_REMLO;

  11724  2 001557   200127 755100                    STA     CP_LIMREC+8,,AUTO
         2 001560   001664 710000 2                  TRA     s:11795

      461    11725                                                         /**/
      462    11726    3         CASE(LIM_PO);

      463    11727    3           B$JIT.REMCPO=CC_REMCPO;

  11727  2 001561   000000 473400 xsym               LDP3    B$JIT$
         2 001562   200013 235100                    LDA     CC_REMCPO,,AUTO
         2 001563   300360 755100                    STA     240,,PR3

      464    11728    3           IF STEPFLAG=%YES#

  11728  2 001564   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001565   001570 605000 2                  TPL     s:11733

      465    11729    3              THEN
      466    11730    3                 CP_LIMREC.STEP_MAX.REMCPO=CC_REMCPO;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:74   

  11730  2 001566   200137 755100                    STA     CP_LIMREC+16,,AUTO
         2 001567   001664 710000 2                  TRA     s:11795

      467    11731
      468    11732    3              ELSE
      469    11733    3                 CP_LIMREC.CUR_MAX.REMCPO=CC_REMCPO;

  11733  2 001570   200130 755100                    STA     CP_LIMREC+9,,AUTO
         2 001571   001664 710000 2                  TRA     s:11795

      470    11734                                                         /**/
      471    11735    3         CASE(LIM_DO);

      472    11736    3           B$JIT.REMDO=CC_REMDO;

  11736  2 001572   000000 473400 xsym               LDP3    B$JIT$
         2 001573   200014 235100                    LDA     CC_REMDO,,AUTO
         2 001574   300362 755100                    STA     242,,PR3

      473    11737    3           IF STEPFLAG=%YES#

  11737  2 001575   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001576   001601 605000 2                  TPL     s:11742

      474    11738    3              THEN
      475    11739    3                 CP_LIMREC.STEP_MAX.REMDO=CC_REMDO;

  11739  2 001577   200140 755100                    STA     CP_LIMREC+17,,AUTO
         2 001600   001664 710000 2                  TRA     s:11795

      476    11740
      477    11741    3              ELSE
      478    11742    3                 CP_LIMREC.CUR_MAX.REMDO=CC_REMDO;

  11742  2 001601   200131 755100                    STA     CP_LIMREC+10,,AUTO
         2 001602   001664 710000 2                  TRA     s:11795
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:75   

      479    11743                                                         /**/
      480    11744    3         CASE(LIM_MEM);

      481    11745    3           B$JIT.MAXCORE=CC_MAXCORE;

  11745  2 001603   200011 722100                    LXL2    CC_MAXCORE,,AUTO
         2 001604   000000 473400 xsym               LDP3    B$JIT$
         2 001605   300210 742100                    STX2    136,,PR3

      482    11746    3           IF STEPFLAG=%YES#

  11746  2 001606   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001607   001612 605000 2                  TPL     s:11751

      483    11747    3              THEN
      484    11748    3                 CP_LIMREC.STEP_MAX.MAXCORE=CC_MAXCORE;

  11748  2 001610   200135 742100                    STX2    CP_LIMREC+14,,AUTO
         2 001611   001664 710000 2                  TRA     s:11795

      485    11749
      486    11750    3              ELSE
      487    11751    3                 CP_LIMREC.CUR_MAX.MAXCORE=CC_MAXCORE;

  11751  2 001612   200126 742100                    STX2    CP_LIMREC+7,,AUTO
         2 001613   001664 710000 2                  TRA     s:11795

      488    11752                                                         /**/
      489    11753    3         CASE(LIM_TDIS);

      490    11754        /*
      491    11755          ****  B$JIT.MAXTMPDP doesn't get ticked down so must take B$JIT.CURTMPDP
      492    11756          ****  Into consideration when setting the limit.
      493    11757        */
      494    11758    3           B$JIT.MAXTMPDP=CC_MAXTMPDP+B$JIT.CURTMPDP;

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:76   
  11758  2 001614   000000 473400 xsym               LDP3    B$JIT$
         2 001615   200015 236100                    LDQ     CC_MAXTMPDP,,AUTO
         2 001616   300240 036100                    ADLQ    160,,PR3
         2 001617   300241 756100                    STQ     161,,PR3

      495    11759    3           CP_LIMREC.CUMUL.MAXTMPDP = B$JIT.CURTMPDP ;

  11759  2 001620   300240 235100                    LDA     160,,PR3
         2 001621   200147 755100                    STA     CP_LIMREC+24,,AUTO

      496    11760    3           IF STEPFLAG=%YES#

  11760  2 001622   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001623   001627 605000 2                  TPL     s:11765

      497    11761    3              THEN
      498    11762    3                 CP_LIMREC.STEP_MAX.MAXTMPDP=CC_MAXTMPDP ;

  11762  2 001624   200015 235100                    LDA     CC_MAXTMPDP,,AUTO
         2 001625   200142 755100                    STA     CP_LIMREC+19,,AUTO
         2 001626   001664 710000 2                  TRA     s:11795

      499    11763
      500    11764    3              ELSE
      501    11765    3                 CP_LIMREC.CUR_MAX.MAXTMPDP=CC_MAXTMPDP ;

  11765  2 001627   200015 235100                    LDA     CC_MAXTMPDP,,AUTO
         2 001630   200133 755100                    STA     CP_LIMREC+12,,AUTO
         2 001631   001664 710000 2                  TRA     s:11795

      502    11766                                                         /**/
      503    11767    3         CASE(LIM_PDIS);

      504    11768    3           B$JIT.PRDPRM=CC_PRDPRM;

  11768  2 001632   000000 473400 xsym               LDP3    B$JIT$
         2 001633   200016 235100                    LDA     CC_PRDPRM,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:77   
         2 001634   300242 755100                    STA     162,,PR3

      505    11769    3           IF STEPFLAG=%YES#

  11769  2 001635   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001636   001641 605000 2                  TPL     s:11774

      506    11770    3              THEN
      507    11771    3                 CP_LIMREC.STEP_MAX.PRDPRM=CC_PRDPRM;

  11771  2 001637   200141 755100                    STA     CP_LIMREC+18,,AUTO
         2 001640   001664 710000 2                  TRA     s:11795

      508    11772
      509    11773    3              ELSE
      510    11774    3                 CP_LIMREC.CUR_MAX.PRDPRM=CC_PRDPRM;

  11774  2 001641   200132 755100                    STA     CP_LIMREC+11,,AUTO
         2 001642   001664 710000 2                  TRA     s:11795

      511    11775                                                         /**/
      512    11776    3         CASE(LIM_FPOOLS);

      513    11777    3           B$JIT.FBUL=CC_FBUL;

  11777  2 001643   200017 722100                    LXL2    CC_FBUL,,AUTO
         2 001644   000000 473400 xsym               LDP3    B$JIT$
         2 001645   300205 442100                    SXL2    133,,PR3

      514    11778    3           IF STEPFLAG=%YES#

  11778  2 001646   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001647   001652 605000 2                  TPL     s:11783

      515    11779    3              THEN
      516    11780    3                 CP_LIMREC.STEP_MAX.FBUL=CC_FBUL;

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:78   
  11780  2 001650   200135 442100                    SXL2    CP_LIMREC+14,,AUTO
         2 001651   001664 710000 2                  TRA     s:11795

      517    11781
      518    11782    3              ELSE
      519    11783    3                 CP_LIMREC.CUR_MAX.FBUL=CC_FBUL;

  11783  2 001652   200126 442100                    SXL2    CP_LIMREC+7,,AUTO
         2 001653   001664 710000 2                  TRA     s:11795

      520    11784                                                         /**/
      521    11785    3         CASE(LIM_TIME);

      522    11786    3           B$JIT.MRT=CC_MRT;

  11786  2 001654   000000 473400 xsym               LDP3    B$JIT$
         2 001655   200020 235100                    LDA     CC_MRT,,AUTO
         2 001656   300276 755100                    STA     190,,PR3

      523    11787    3           IF STEPFLAG=%YES#

  11787  2 001657   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001660   001663 605000 2                  TPL     s:11792

      524    11788    3              THEN
      525    11789    3                 CP_LIMREC.STEP_MAX.MRT=CC_MRT;

  11789  2 001661   200143 755100                    STA     CP_LIMREC+20,,AUTO
         2 001662   001664 710000 2                  TRA     s:11795

      526    11790
      527    11791    3              ELSE
      528    11792    3                 CP_LIMREC.CUR_MAX.MRT=CC_MRT;

  11792  2 001663   200134 755100                    STA     CP_LIMREC+13,,AUTO

      529    11793                                                         /**/
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:79   
      530    11794    3         END LIMIT30;

      531    11795    2        I=I+1;

  11795  2 001664   200006 054100                    AOS     I,,AUTO

      532    11796    2     END LIMIT25;

  11796  2 001665   000001 236100                    LDQ     1,,PR0
         2 001666   000022 772000                    QRL     18
         2 001667   200006 116100                    CMPQ    I,,AUTO
         2 001670   001521 605400 2                  TPNZ    s:11711

      533    11797        /*
      534    11798          **** Write out the new limit to *S
      535    11799        */
      536    11800    1     CALL CPJ$WRITE_S(M$IBEX1_NUM,VECTOR(K_LIMIT),VECTOR(CP_LIMREC))  ALTRET(LIMIT80);

  11800  2 001671   000014 235000 3                  LDA     12
         2 001672   200170 452500                    STP2    HRS+2,,AUTO
         2 001673   200170 236100                    LDQ     HRS+2,,AUTO
         2 001674   000117 036003                    ADLQ    79,DU
         2 001675   200172 757100                    STAQ    HRS+4,,AUTO
         2 001676   200172 631500                    EPPR1   HRS+4,,AUTO
         2 001677   200176 451500                    STP1    HRS+8,,AUTO
         2 001700   000016 237000 3                  LDAQ    14
         2 001701   200174 757100                    STAQ    HRS+6,,AUTO
         2 001702   200174 630500                    EPPR0   HRS+6,,AUTO
         2 001703   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001704   000000 701000 xent               TSX1    CPJ$WRITE_S
         2 001705   002010 702000 2                  TSX2    LIMIT80

      537    11801                                                /*Init. Close dcb*/
      538    11802    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX1_NUM;

  11802  2 001706   000000 470400 xsym               LDP0    SEG2$
         2 001707   000163 471500                    LDP1    115,,PR0
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:80   
         2 001710   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001711   100032 740100                    STX0    26,,PR1

      539    11803    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;

  11803  2 001712   000163 471500                    LDP1    115,,PR0
         2 001713   000002 236007                    LDQ     2,DL
         2 001714   100032 552104                    STBQ    26,'04'O,PR1

      540    11804    1     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(LIMIT65);

  11804  2 001715   000163 471500                    LDP1    115,,PR0
         2 001716   100000 630500                    EPPR0   0,,PR1
         2 001717   450001 713400                    CLIMB   alt,close
         2 001720   406000 401760                    pmme    nvectors=13
         2 001721   002002 702000 2                  TSX2    LIMIT65

      541    11805        /*
      542    11806          **** Set jit flag if this was a step limit
      543    11807        */
      544    11808    1     IF STEPFLAG = %YES#

  11808  2 001722   200033 234100                    SZN     STEPFLAG,,AUTO
         2 001723   001730 605000 2                  TPL     s:11811

      545    11809    1        THEN
      546    11810    1           B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STEPLMT#;

  11810  2 001724   000000 470400 xsym               LDP0    B$JIT$
         2 001725   000143 236100                    LDQ     99,,PR0
         2 001726   000044 276000 1                  ORQ     E_LIMEXCMAX+2
         2 001727   000143 756100                    STQ     99,,PR0

      547    11811    1     RETURN;

  11811  2 001730   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:81   
  11808  2 001731                       LIMIT45      null
      548    11812                   %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:82   
      549    11813    1   LIMIT45:;
      550    11814        /*
      551    11815          ****  Write out *S which has been updated to reflect previous job step(s)
      552    11816          ****  For the limits processed.
      553    11817        */
      554    11818    1     CALL CPJ$WRITE_S(M$IBEX1_NUM,VECTOR(K_LIMIT),VECTOR(CP_LIMREC)) ALTRET(LIMIT80);

  11818  2 001731   000014 235000 3                  LDA     12
         2 001732   200170 452500                    STP2    HRS+2,,AUTO
         2 001733   200170 236100                    LDQ     HRS+2,,AUTO
         2 001734   000117 036003                    ADLQ    79,DU
         2 001735   200172 757100                    STAQ    HRS+4,,AUTO
         2 001736   200172 630500                    EPPR0   HRS+4,,AUTO
         2 001737   200176 450500                    STP0    HRS+8,,AUTO
         2 001740   000016 237000 3                  LDAQ    14
         2 001741   200174 757100                    STAQ    HRS+6,,AUTO
         2 001742   200174 630500                    EPPR0   HRS+6,,AUTO
         2 001743   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001744   000000 701000 xent               TSX1    CPJ$WRITE_S
         2 001745   002010 702000 2                  TSX2    LIMIT80

      555    11819    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# =  M$IBEX1_NUM;

  11819  2 001746   000000 470400 xsym               LDP0    SEG2$
         2 001747   000163 471500                    LDP1    115,,PR0
         2 001750   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001751   100032 740100                    STX0    26,,PR1

      556    11820    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP# = %SAVE#;

  11820  2 001752   000163 471500                    LDP1    115,,PR0
         2 001753   000002 236007                    LDQ     2,DL
         2 001754   100032 552104                    STBQ    26,'04'O,PR1

      557    11821    1     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(LIMIT47);

  11821  2 001755   000163 471500                    LDP1    115,,PR0
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:83   
         2 001756   100000 630500                    EPPR0   0,,PR1
         2 001757   450001 713400                    CLIMB   alt,close
         2 001760   406000 401760                    pmme    nvectors=13
         2 001761   001762 702000 2                  TSX2    LIMIT47

  11820  2 001762                       LIMIT47      null
      558    11822    1   LIMIT47:;
      559    11823    1     CALL CPA$BYE ALTRET(LIMIT65);

  11823  2 001762   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001763   000000 701000 xent               TSX1    CPA$BYE
         2 001764   002002 702000 2                  TSX2    LIMIT65

  11820  2 001765                       LIMIT55      null
      560    11824    1   LIMIT55:;
      561    11825        /*E*       ERROR: CPJ-E$CANTOPN-E
      562    11826                   MESSAGE: Unable to open %FN file
      563    11827                   DESCRIPTION: IBEX was unable to open the specified file.
      564    11828        */
      565    11829    1     CALL CPC$WRITEMSGE(E_CANTOPN,M$IBEX1_NUM,,,,%YES#);

  11829  2 001765   000024 236000 3                  LDQ     20
         2 001766   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001767   200174 757100                    STAQ    HRS+6,,AUTO
         2 001770   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001771   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001772   200172 757100                    STAQ    HRS+4,,AUTO
         2 001773   000040 237000 3                  LDAQ    32
         2 001774   200170 757100                    STAQ    HRS+2,,AUTO
         2 001775   200170 630500                    EPPR0   HRS+2,,AUTO
         2 001776   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001777   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 002000   000000 011000                    NOP     0

      566    11830    1     GOTO LIMIT80;

  11830  2 002001   002010 710000 2                  TRA     LIMIT80
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:84   

  11820  2 002002                       LIMIT65      null
      567    11831    1   LIMIT65:;
      568    11832    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  11832  2 002002   000000 470400 xsym               LDP0    B$TCB$
         2 002003   000000 471500                    LDP1    0,,PR0
         2 002004   100102 236100                    LDQ     66,,PR1
         2 002005   000000 473400 xsym               LDP3    B$JIT$
         2 002006   300144 756100                    STQ     100,,PR3

      569    11833    1     ALTRETURN;

  11833  2 002007   000000 702200 xent               TSX2  ! X66_AALT

  11832  2 002010                       LIMIT80      null
      570    11834    1   LIMIT80:;
      571    11835    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX1_NUM;

  11835  2 002010   000000 470400 xsym               LDP0    SEG2$
         2 002011   000163 471500                    LDP1    115,,PR0
         2 002012   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002013   100032 740100                    STX0    26,,PR1

      572    11836    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;

  11836  2 002014   000163 471500                    LDP1    115,,PR0
         2 002015   000002 236007                    LDQ     2,DL
         2 002016   100032 552104                    STBQ    26,'04'O,PR1

      573    11837    1     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(LIMIT85); /*Close the dcb*/

  11837  2 002017   000163 471500                    LDP1    115,,PR0
         2 002020   100000 630500                    EPPR0   0,,PR1
         2 002021   450001 713400                    CLIMB   alt,close
         2 002022   406000 401760                    pmme    nvectors=13
         2 002023   002024 702000 2                  TSX2    LIMIT85
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:85   

  11836  2 002024                       LIMIT85      null
      574    11838    1   LIMIT85:;
      575    11839    1     ALTRETURN;

  11839  2 002024   000000 702200 xent               TSX2  ! X66_AALT

      576    11840                   %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:86   
      577    11841        /**********************************************************************/
      578    11842        /*I*   NAME:   ABRT_CHK
      579    11843               PURPOSE:  Determine if the LIMIT command should be aborted and output
      580    11844                         the appropriate message.
      581    11845               INTERFACE: CPC$WRITEMSGE,CPE$RZEROS
      582    11846               INPUT:  C_NAME - limit name
      583    11847                       TEMP_MAX - value specified for limit
      584    11848                       CC_MAX   - value specified on control command
      585    11849                       ABORTFLAG - abort flag set/reset
      586    11850               OUTPUT: Information or error message output to user
      587    11851                       CC_MAX - set to max. available if ABORTFLAG reset
      588    11852               DESCRIPTION: If batch and the abort flag is set the command is aborted,
      589    11853                         otherwise command processing is continued after outputting the
      590    11854                         appropriate message . In the latter case, a user is
      591    11855                         given the maximum available to him.
      592    11856        */
      593    11857        /**********************************************************************/
      594    11858    1   ABRT_CHK: PROC(C_NAME,TEMP_MAX,CC_MAX) ALTRET;

  11858  2 002025   200152 741300       ABRT_CHK     STX1  ! CP_LIMREC+27,,AUTO

      595    11859    2   DCL 1 C_NAME,                                     /* Limit name */
      596    11860    2          2 COUNT UBIN(9) UNAL,
      597    11861    2          2 TEXT CHAR(6) UNAL;
      598    11862    2   DCL 1 C_VAL,
      599    11863    2          2 COUNT UBIN(9) UNAL,
      600    11864    2          2 TEXT CHAR(11) UNAL;
      601    11865    2   DCL TEMP UBIN WORD;                               /* Temp cell */
      602    11866    2   DCL TEMP_MAX SBIN;                               /*Max. Value*/
      603    11867    2   DCL CC_MAX SBIN;                                 /*Cc max value*/
      604    11868        /**/
      605    11869        /**/
      606    11870    2     IF CC_MAX <= TEMP_MAX

  11870  2 002026   200155 470500                    LDP0    @CC_MAX,,AUTO
         2 002027   200154 471500                    LDP1    @TEMP_MAX,,AUTO
         2 002030   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:87   
         2 002031   100000 116100                    CMPQ    0,,PR1
         2 002032   002034 605400 2                  TPNZ    s:11876

      607    11871    2        THEN
      608    11872    2           RETURN;

  11872  2 002033   000001 702211                    TSX2  ! 1,X1

      609    11873        /*
      610    11874          **** If limit is time, must convert to hh:mm:ss
      611    11875        */
      612    11876    2     IF ADDR(C_NAME) -> TEXT$C.TEXT = 'Time'

  11876  2 002034   200153 473500                    LDP3    @C_NAME,,AUTO
         2 002035   000100 101500                    MRL     fill='000'O
         2 002036   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 002037   200170 000002                    ADSC9   HRS+2,,AUTO              cn=0,n=2
         2 002040   200170 220100                    LDX0    HRS+2,,AUTO
         2 002041   040000 106540                    CMPC    fill='040'O
         2 002042   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         2 002043   000045 000004 1                  ADSC9   E_LIMEXCMAX+3            cn=0,n=4
         2 002044   002057 601000 2                  TNZ     s:11886

      613    11877    2        THEN
      614    11878    3           DO;

      615    11879    3              CALL CNVRT_TIME(TEMP_MAX);

  11879  2 002045   200154 236100                    LDQ     @TEMP_MAX,,AUTO
         2 002046   200163 756100                    STQ     TEMP+2,,AUTO
         2 002047   002432 701000 2                  TSX1    CNVRT_TIME
         2 002050   000000 011000                    NOP     0

      616    11880    3              C_VAL.COUNT = LENGTHC(TXT_TIME_R);

  11880  2 002051   013000 236003                    LDQ     5632,DU
         2 002052   200156 552140                    STBQ    C_VAL,'40'O,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:88   

      617    11881    3              C_VAL.TEXT = TXT_TIME_R;

  11881  2 002053   040100 100500                    MLR     fill='040'O
         2 002054   200114 000013                    ADSC9   TXT_TIME,,AUTO           cn=0,n=11
         2 002055   200156 200013                    ADSC9   C_VAL,,AUTO              cn=1,n=11

      618    11882    3           END;

  11882  2 002056   002101 710000 2                  TRA     s:11890

      619    11883
      620    11884    2        ELSE
      621    11885    3           DO;

      622    11886    3              CALL BINCHAR(C_VAL.TEXT,TEMP_MAX);

  11886  2 002057   000100 301500                    BTD
         2 002060   100000 000004                    NDSC9   0,,PR1                   cn=0,s=lsgnf,sf=0,n=4
         2 002061   200156 230013                    NDSC9   C_VAL,,AUTO              cn=1,s=nosgn,sf=0,n=11

      623    11887    3              CALL CPE$RZEROS(C_VAL.TEXT,SIZEC(C_VAL.TEXT),TEMP);

  11887  2 002062   200161 634500                    EPPR4   TEMP,,AUTO
         2 002063   200172 454500                    STP4    HRS+4,,AUTO
         2 002064   000011 236000 3                  LDQ     9
         2 002065   200171 756100                    STQ     HRS+3,,AUTO
         2 002066   200173 452500                    STP2    HRS+5,,AUTO
         2 002067   200173 236100                    LDQ     HRS+5,,AUTO
         2 002070   000042 036000 3                  ADLQ    34
         2 002071   200170 756100                    STQ     HRS+2,,AUTO
         2 002072   200170 630500                    EPPR0   HRS+2,,AUTO
         2 002073   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002074   000000 701000 xent               TSX1    CPE$RZEROS
         2 002075   000000 011000                    NOP     0

      624    11888    3              C_VAL.COUNT = TEMP;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:89   

  11888  2 002076   200161 236100                    LDQ     TEMP,,AUTO
         2 002077   000033 736000                    QLS     27
         2 002100   200156 552140                    STBQ    C_VAL,'40'O,AUTO

      625    11889    3           END;

      626    11890    2     IF ABORTFLAG=%NO# OR B$JIT.MODE~=%M_BATCH#

  11890  2 002101   200035 234100                    SZN     ABORTFLAG,,AUTO
         2 002102   002110 605000 2                  TPL     s:11898
         2 002103   000000 470400 xsym               LDP0    B$JIT$
         2 002104   000000 236100                    LDQ     0,,PR0
         2 002105   740000 376003                    ANQ     -16384,DU
         2 002106   040000 116003                    CMPQ    16384,DU
         2 002107   002134 600000 2                  TZE     s:11913

      627    11891    2        THEN
      628    11892    3           DO;

      629    11893        /*E*          ERROR: CPJ-E$LIMMAX-E
      630    11894                      MESSAGE: Current maximum for %U1 is %U2
      631    11895                      DESCRIPTION: The limit specified on the LIMIT command exceeds
      632    11896                                the amount remaining.
      633    11897        */
      634    11898    3              CALL CPC$WRITEMSGE(E_LIMMAX,,C_NAME,C_VAL,,%YES#);

  11898  2 002110   000024 236000 3                  LDQ     20
         2 002111   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002112   200174 757100                    STAQ    HRS+6,,AUTO
         2 002113   200156 630500                    EPPR0   C_VAL,,AUTO
         2 002114   200173 450500                    STP0    HRS+5,,AUTO
         2 002115   200153 236100                    LDQ     @C_NAME,,AUTO
         2 002116   200172 756100                    STQ     HRS+4,,AUTO
         2 002117   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002120   000043 235000 3                  LDA     35
         2 002121   200170 757100                    STAQ    HRS+2,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:90   
         2 002122   200170 630500                    EPPR0   HRS+2,,AUTO
         2 002123   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 002124   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 002125   000000 011000                    NOP     0

      635    11899        /*
      636    11900          ****           Set maximum to what is available to the user
      637    11901        */
      638    11902    3              CC_MAX=TEMP_MAX;

  11902  2 002126   200154 470500                    LDP0    @TEMP_MAX,,AUTO
         2 002127   200155 471500                    LDP1    @CC_MAX,,AUTO
         2 002130   000000 235100                    LDA     0,,PR0
         2 002131   100000 755100                    STA     0,,PR1

      639    11903    3              RETURN;

  11903  2 002132   200152 221300                    LDX1  ! CP_LIMREC+27,,AUTO
         2 002133   000001 702211                    TSX2  ! 1,X1

      640    11904    3           END;
      641    11905
      642    11906    2        ELSE
      643    11907    3           DO;

      644    11908        /*E*          ERROR: CPJ-E$LIMEXCMAX-E
      645    11909                      MESSAGE: Limit exceeded, current maximum for %U1 is %U2
      646    11910                      DESCRIPTION: The limit specified on the LIMIT command exceeds
      647    11911                                the amount remaining.
      648    11912        */
      649    11913    3              CALL CPC$WRITEMSGE(E_LIMEXCMAX,,C_NAME,C_VAL,,%YES#);

  11913  2 002134   000024 236000 3                  LDQ     20
         2 002135   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002136   200174 757100                    STAQ    HRS+6,,AUTO
         2 002137   200156 631500                    EPPR1   C_VAL,,AUTO
         2 002140   200173 451500                    STP1    HRS+5,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:91   
         2 002141   200153 236100                    LDQ     @C_NAME,,AUTO
         2 002142   200172 756100                    STQ     HRS+4,,AUTO
         2 002143   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002144   000044 235000 3                  LDA     36
         2 002145   200170 757100                    STAQ    HRS+2,,AUTO
         2 002146   200170 630500                    EPPR0   HRS+2,,AUTO
         2 002147   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 002150   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 002151   000000 011000                    NOP     0

      650    11914    3              ALTRETURN;

  11914  2 002152   200152 221300                    LDX1  ! CP_LIMREC+27,,AUTO
         2 002153   000000 702211                    TSX2  ! 0,X1

      651    11915    3           END;
      652    11916    2   END ABRT_CHK;
      653    11917                  %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:92   
      654    11918        /*********************************************************************/
      655    11919        /*I*   NAME:   DISP_LIMITS
      656    11920               PURPOSE: Insert limit values into an image and output
      657    11921               INTERFACE: CPB$BLDIMAGE - build image
      658    11922                       CPE$LISTOUT - output image
      659    11923               INPUT:  VAL_B - Value for batch
      660    11924                       VAL_G - value for ghost
      661    11925                       VAL_O - value for on-line
      662    11926                       VAL_CUR - current value from JIT
      663    11927               OUTPUT: image created and output to listing device
      664    11928               DESCRIPTION: The service limit values obtained from the :USER
      665    11929                       record and from the JIT are stored into an image and
      666    11930                       output to the listing device.
      667    11931        */
      668    11932    1   DISP_LIMITS: PROC(VAL_B,VAL_G,VAL_O,VAL_CUR) ALTRET;

  11932  2 002154   200152 741300       DISP_LIMITS  STX1  ! CP_LIMREC+27,,AUTO

      669    11933    2   DCL MAXBUFF CHAR(11);                            /*Max. Value*/
      670    11934    2   DCL VAL_B UBIN;
      671    11935    2   DCL VAL_G UBIN;
      672    11936    2   DCL VAL_O UBIN;
      673    11937    2   DCL VAL_CUR UBIN;
      674    11938        /**/
      675    11939        /**/
      676    11940    2     DEST$=OUT$;

  11940  2 002155   200024 236100                    LDQ     OUT$,,AUTO
         2 002156   200025 756100                    STQ     DEST$,,AUTO

      677    11941        /* ****    Insert limit name                     */
      678    11942    2     CALL CPB$BLDIMAGE(OUT$,DEST$,IN$,11,TAB_VAL) ALTRET(DISP_LIMITS50);

  11942  2 002157   200026 630500                    EPPR0   TAB_VAL,,AUTO
         2 002160   200174 450500                    STP0    HRS+6,,AUTO
         2 002161   000011 236000 3                  LDQ     9
         2 002162   200173 756100                    STQ     HRS+5,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:93   
         2 002163   200023 631500                    EPPR1   IN$,,AUTO
         2 002164   200172 451500                    STP1    HRS+4,,AUTO
         2 002165   200025 633500                    EPPR3   DEST$,,AUTO
         2 002166   200171 453500                    STP3    HRS+3,,AUTO
         2 002167   200024 634500                    EPPR4   OUT$,,AUTO
         2 002170   200170 454500                    STP4    HRS+2,,AUTO
         2 002171   200170 630500                    EPPR0   HRS+2,,AUTO
         2 002172   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002173   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002174   002430 702000 2                  TSX2    DISP_LIMITS50

      679    11943        /* ****    Insert batch value                    */
      680    11944    2     DEST$=PINCRC(DEST$,3);

  11944  2 002175   200025 236100                    LDQ     DEST$,,AUTO
         2 002176   600000 036007                    ADLQ    -65536,DL
         2 002177   200025 756100                    STQ     DEST$,,AUTO

      681    11945    2     CALL BINCHAR(MAXBUFF,VAL_B);

  11945  2 002200   200153 470500                    LDP0    @VAL_B,,AUTO
         2 002201   000000 235100                    LDA     0,,PR0
         2 002202   000044 773000                    LRL     36
         2 002203   200170 757100                    STAQ    HRS+2,,AUTO
         2 002204   000100 301500                    BTD
         2 002205   200170 000010                    NDSC9   HRS+2,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         2 002206   200157 030013                    NDSC9   MAXBUFF,,AUTO            cn=0,s=nosgn,sf=0,n=11

      682    11946    2     CALL CPE$RZEROS(MAXBUFF,SIZEC(MAXBUFF));

  11946  2 002207   000011 236000 3                  LDQ     9
         2 002210   200171 756100                    STQ     HRS+3,,AUTO
         2 002211   200157 631500                    EPPR1   MAXBUFF,,AUTO
         2 002212   200170 451500                    STP1    HRS+2,,AUTO
         2 002213   200170 630500                    EPPR0   HRS+2,,AUTO
         2 002214   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002215   000000 701000 xent               TSX1    CPE$RZEROS
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:94   
         2 002216   000000 011000                    NOP     0

      683    11947    2     CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXBUFF),11,TAB_VAL)

  11947  2 002217   200157 630500                    EPPR0   MAXBUFF,,AUTO
         2 002220   200170 450500                    STP0    HRS+2,,AUTO
         2 002221   200026 631500                    EPPR1   TAB_VAL,,AUTO
         2 002222   200175 451500                    STP1    HRS+7,,AUTO
         2 002223   000011 236000 3                  LDQ     9
         2 002224   200174 756100                    STQ     HRS+6,,AUTO
         2 002225   200170 633500                    EPPR3   HRS+2,,AUTO
         2 002226   200173 453500                    STP3    HRS+5,,AUTO
         2 002227   200025 634500                    EPPR4   DEST$,,AUTO
         2 002230   200172 454500                    STP4    HRS+4,,AUTO
         2 002231   200024 635500                    EPPR5   OUT$,,AUTO
         2 002232   200171 455500                    STP5    HRS+3,,AUTO
         2 002233   200171 630500                    EPPR0   HRS+3,,AUTO
         2 002234   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002235   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002236   002430 702000 2                  TSX2    DISP_LIMITS50

      684    11948    2          ALTRET(DISP_LIMITS50);
      685    11949        /* ****    Insert on-line value                  */
      686    11950    2     DEST$=PINCRC(DEST$,3);

  11950  2 002237   200025 236100                    LDQ     DEST$,,AUTO
         2 002240   600000 036007                    ADLQ    -65536,DL
         2 002241   200025 756100                    STQ     DEST$,,AUTO

      687    11951    2     CALL BINCHAR(MAXBUFF,VAL_O);

  11951  2 002242   200155 470500                    LDP0    @VAL_O,,AUTO
         2 002243   000000 235100                    LDA     0,,PR0
         2 002244   000044 773000                    LRL     36
         2 002245   200170 757100                    STAQ    HRS+2,,AUTO
         2 002246   000100 301500                    BTD
         2 002247   200170 000010                    NDSC9   HRS+2,,AUTO              cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:95   
         2 002250   200157 030013                    NDSC9   MAXBUFF,,AUTO            cn=0,s=nosgn,sf=0,n=11

      688    11952    2     CALL CPE$RZEROS(MAXBUFF,SIZEC(MAXBUFF));

  11952  2 002251   000011 236000 3                  LDQ     9
         2 002252   200171 756100                    STQ     HRS+3,,AUTO
         2 002253   200157 631500                    EPPR1   MAXBUFF,,AUTO
         2 002254   200170 451500                    STP1    HRS+2,,AUTO
         2 002255   200170 630500                    EPPR0   HRS+2,,AUTO
         2 002256   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002257   000000 701000 xent               TSX1    CPE$RZEROS
         2 002260   000000 011000                    NOP     0

      689    11953    2     CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXBUFF),11,TAB_VAL)

  11953  2 002261   200157 630500                    EPPR0   MAXBUFF,,AUTO
         2 002262   200170 450500                    STP0    HRS+2,,AUTO
         2 002263   200026 631500                    EPPR1   TAB_VAL,,AUTO
         2 002264   200175 451500                    STP1    HRS+7,,AUTO
         2 002265   000011 236000 3                  LDQ     9
         2 002266   200174 756100                    STQ     HRS+6,,AUTO
         2 002267   200170 633500                    EPPR3   HRS+2,,AUTO
         2 002270   200173 453500                    STP3    HRS+5,,AUTO
         2 002271   200025 634500                    EPPR4   DEST$,,AUTO
         2 002272   200172 454500                    STP4    HRS+4,,AUTO
         2 002273   200024 635500                    EPPR5   OUT$,,AUTO
         2 002274   200171 455500                    STP5    HRS+3,,AUTO
         2 002275   200171 630500                    EPPR0   HRS+3,,AUTO
         2 002276   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002277   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002300   002430 702000 2                  TSX2    DISP_LIMITS50

      690    11954    2          ALTRET(DISP_LIMITS50);
      691    11955        /* ****     insert ghost value                    */
      692    11956    2     DEST$=PINCRC(DEST$,3);

  11956  2 002301   200025 236100                    LDQ     DEST$,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:96   
         2 002302   600000 036007                    ADLQ    -65536,DL
         2 002303   200025 756100                    STQ     DEST$,,AUTO

      693    11957    2     CALL BINCHAR(MAXBUFF,VAL_G);

  11957  2 002304   200154 470500                    LDP0    @VAL_G,,AUTO
         2 002305   000000 235100                    LDA     0,,PR0
         2 002306   000044 773000                    LRL     36
         2 002307   200170 757100                    STAQ    HRS+2,,AUTO
         2 002310   000100 301500                    BTD
         2 002311   200170 000010                    NDSC9   HRS+2,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         2 002312   200157 030013                    NDSC9   MAXBUFF,,AUTO            cn=0,s=nosgn,sf=0,n=11

      694    11958    2     CALL CPE$RZEROS(MAXBUFF,SIZEC(MAXBUFF));

  11958  2 002313   000011 236000 3                  LDQ     9
         2 002314   200171 756100                    STQ     HRS+3,,AUTO
         2 002315   200157 631500                    EPPR1   MAXBUFF,,AUTO
         2 002316   200170 451500                    STP1    HRS+2,,AUTO
         2 002317   200170 630500                    EPPR0   HRS+2,,AUTO
         2 002320   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002321   000000 701000 xent               TSX1    CPE$RZEROS
         2 002322   000000 011000                    NOP     0

      695    11959    2     CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXBUFF),11,TAB_VAL)

  11959  2 002323   200157 630500                    EPPR0   MAXBUFF,,AUTO
         2 002324   200170 450500                    STP0    HRS+2,,AUTO
         2 002325   200026 631500                    EPPR1   TAB_VAL,,AUTO
         2 002326   200175 451500                    STP1    HRS+7,,AUTO
         2 002327   000011 236000 3                  LDQ     9
         2 002330   200174 756100                    STQ     HRS+6,,AUTO
         2 002331   200170 633500                    EPPR3   HRS+2,,AUTO
         2 002332   200173 453500                    STP3    HRS+5,,AUTO
         2 002333   200025 634500                    EPPR4   DEST$,,AUTO
         2 002334   200172 454500                    STP4    HRS+4,,AUTO
         2 002335   200024 635500                    EPPR5   OUT$,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:97   
         2 002336   200171 455500                    STP5    HRS+3,,AUTO
         2 002337   200171 630500                    EPPR0   HRS+3,,AUTO
         2 002340   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002341   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002342   002430 702000 2                  TSX2    DISP_LIMITS50

      696    11960    2          ALTRET(DISP_LIMITS50);
      697    11961    2     DEST$=PINCRC(DEST$,3);

  11961  2 002343   200025 236100                    LDQ     DEST$,,AUTO
         2 002344   600000 036007                    ADLQ    -65536,DL
         2 002345   200025 756100                    STQ     DEST$,,AUTO

      698    11962        /* ****    Insert current value from jit         */
      699    11963    2     CALL BINCHAR(MAXBUFF,VAL_CUR);

  11963  2 002346   200156 470500                    LDP0    @VAL_CUR,,AUTO
         2 002347   000000 235100                    LDA     0,,PR0
         2 002350   000044 773000                    LRL     36
         2 002351   200170 757100                    STAQ    HRS+2,,AUTO
         2 002352   000100 301500                    BTD
         2 002353   200170 000010                    NDSC9   HRS+2,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         2 002354   200157 030013                    NDSC9   MAXBUFF,,AUTO            cn=0,s=nosgn,sf=0,n=11

      700    11964    2     CALL CPE$RZEROS(MAXBUFF,SIZEC(MAXBUFF));

  11964  2 002355   000011 236000 3                  LDQ     9
         2 002356   200171 756100                    STQ     HRS+3,,AUTO
         2 002357   200157 631500                    EPPR1   MAXBUFF,,AUTO
         2 002360   200170 451500                    STP1    HRS+2,,AUTO
         2 002361   200170 630500                    EPPR0   HRS+2,,AUTO
         2 002362   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002363   000000 701000 xent               TSX1    CPE$RZEROS
         2 002364   000000 011000                    NOP     0

      701    11965    2     CALL CPB$BLDIMAGE(OUT$,DEST$,ADDR(MAXBUFF),SIZEC(MAXBUFF))

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:98   
  11965  2 002365   200157 630500                    EPPR0   MAXBUFF,,AUTO
         2 002366   200170 450500                    STP0    HRS+2,,AUTO
         2 002367   000011 236000 3                  LDQ     9
         2 002370   200175 756100                    STQ     HRS+7,,AUTO
         2 002371   200170 631500                    EPPR1   HRS+2,,AUTO
         2 002372   200174 451500                    STP1    HRS+6,,AUTO
         2 002373   200025 633500                    EPPR3   DEST$,,AUTO
         2 002374   200173 453500                    STP3    HRS+5,,AUTO
         2 002375   200024 634500                    EPPR4   OUT$,,AUTO
         2 002376   200172 454500                    STP4    HRS+4,,AUTO
         2 002377   200172 630500                    EPPR0   HRS+4,,AUTO
         2 002400   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002401   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002402   002430 702000 2                  TSX2    DISP_LIMITS50

      702    11966    2          ALTRET(DISP_LIMITS50);
      703    11967    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUT$);

  11967  2 002403   000000 470400 xsym               LDP0    SEG2$
         2 002404   000165 471500                    LDP1    117,,PR0
         2 002405   200024 236100                    LDQ     OUT$,,AUTO
         2 002406   000020 772000                    QRL     16
         2 002407   200170 756100                    STQ     HRS+2,,AUTO
         2 002410   200025 236100                    LDQ     DEST$,,AUTO
         2 002411   000020 772000                    QRL     16
         2 002412   200170 136100                    SBLQ    HRS+2,,AUTO
         2 002413   000020 736000                    QLS     16
         2 002414   100004 676100                    ERQ     4,,PR1
         2 002415   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002416   100004 656100                    ERSQ    4,,PR1

      704    11968    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISP_LIMITS50);

  11968  2 002417   000000 236000 xsym               LDQ     SEG2$
         2 002420   000165 036003                    ADLQ    117,DU
         2 002421   200170 756100                    STQ     HRS+2,,AUTO
         2 002422   200170 630500                    EPPR0   HRS+2,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:99   
         2 002423   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002424   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002425   002430 702000 2                  TSX2    DISP_LIMITS50

      705    11969    2     RETURN;

  11969  2 002426   200152 221300                    LDX1  ! CP_LIMREC+27,,AUTO
         2 002427   000001 702211                    TSX2  ! 1,X1

  11967  2 002430                       DISP_LIMITS* null
      706    11970    2   DISP_LIMITS50:;
      707    11971    2     ALTRETURN;

  11971  2 002430   200152 221300                    LDX1  ! CP_LIMREC+27,,AUTO
         2 002431   000000 702211                    TSX2  ! 0,X1

      708    11972    2   END DISP_LIMITS;
      709    11973                   %EJECT;
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:100  
      710    11974        /***********************************************************************/
      711    11975        /*I*   NAME:   CNVRT_TIME
      712    11976               PURPOSE: Value for time converted to hhhhh:mm:ss
      713    11977               INTERFACE:
      714    11978               INPUT:  VAL_TIME - time value  (in centi-seconds)
      715    11979               OUTPUT: TXT_TIME (global) - time value converted to hhhhh:mm:ss
      716    11980               DESCRIPTION: The value passed for time is converted to
      717    11981                       hhhhh:mm:ss format.
      718    11982        */
      719    11983        /**********************************************************************/
      720    11984    1   CNVRT_TIME: PROC(VAL_TIME);

  11984  2 002432   200162 741300       CNVRT_TIME   STX1  ! TEMP+1,,AUTO

      721    11985    2   DCL VAL_TIME SBIN;
      722    11986    2   DCL SECS SBIN;        /* TOTAL NUMBER OF SECS IN VAL_TIME */
      723    11987    2   DCL MINS SBIN;        /* TOTAL NUMBER OF MINS IN VAL_TIME */
      724    11988    2   DCL HRS SBIN;         /* TOTAL NUMBER OF HOURS IN VAL_TIME */
      725    11989        /**/
      726    11990    2     TXT_TIME_R = '*****:**:**';

  11990  2 002433   040100 100400                    MLR     fill='040'O
         2 002434   000046 000013 1                  ADSC9   E_LIMEXCMAX+4            cn=0,n=11
         2 002435   200114 000013                    ADSC9   TXT_TIME,,AUTO           cn=0,n=11

      727    11991    2     DEST$=PINCRC(DEST$,3);

  11991  2 002436   200025 236100                    LDQ     DEST$,,AUTO
         2 002437   600000 036007                    ADLQ    -65536,DL
         2 002440   200025 756100                    STQ     DEST$,,AUTO

      728    11992    2     SECS = VAL_TIME / 100;

  11992  2 002441   200163 470500                    LDP0    @VAL_TIME,,AUTO
         2 002442   000000 236100                    LDQ     0,,PR0
         2 002443   000144 506007                    DIV     100,DL
         2 002444   200164 756100                    STQ     SECS,,AUTO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:101  

      729    11993    2     MINS = SECS / 60;

  11993  2 002445   000074 506007                    DIV     60,DL
         2 002446   200165 756100                    STQ     MINS,,AUTO

      730    11994    2     HRS = MINS / 60;

  11994  2 002447   000074 506007                    DIV     60,DL
         2 002450   200166 756100                    STQ     HRS,,AUTO

      731    11995    2     CALL BINCHAR (TXT_TIME.SEC, MOD (SECS, 60));

  11995  2 002451   200164 236100                    LDQ     SECS,,AUTO
         2 002452   000074 506007                    DIV     60,DL
         2 002453   200170 755100                    STA     HRS+2,,AUTO
         2 002454   000100 301500                    BTD
         2 002455   200170 000004                    NDSC9   HRS+2,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         2 002456   200116 230002                    NDSC9   TXT_TIME+2,,AUTO         cn=1,s=nosgn,sf=0,n=2

      732    11996    2     CALL BINCHAR (TXT_TIME.MIN, MOD (MINS, 60));

  11996  2 002457   200165 236100                    LDQ     MINS,,AUTO
         2 002460   000074 506007                    DIV     60,DL
         2 002461   200170 755100                    STA     HRS+2,,AUTO
         2 002462   000100 301500                    BTD
         2 002463   200170 000004                    NDSC9   HRS+2,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         2 002464   200115 430002                    NDSC9   TXT_TIME+1,,AUTO         cn=2,s=nosgn,sf=0,n=2

      733    11997    2     CALL BINCHAR (TXT_TIME.HR, HRS);

  11997  2 002465   000100 301500                    BTD
         2 002466   200166 000004                    NDSC9   HRS,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 002467   200114 030005                    NDSC9   TXT_TIME,,AUTO           cn=0,s=nosgn,sf=0,n=5

      734    11998    2     IF (HRS = 0) THEN TXT_TIME.HR = '   00';   /* Blank out leading zeros */

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:102  
  11998  2 002470   200166 235100                    LDA     HRS,,AUTO
         2 002471   002476 601000 2                  TNZ     s:11999

  11998  2 002472   040100 100400                    MLR     fill='040'O
         2 002473   000051 000005 1                  ADSC9   E_LIMEXCMAX+7            cn=0,n=5
         2 002474   200114 000005                    ADSC9   TXT_TIME,,AUTO           cn=0,n=5
         2 002475   002521 710000 2                  TRA     s:12003

      735    11999    2     ELSE IF (HRS <= 9) THEN SUBSTR(TXT_TIME.HR, 0, 4) = '    ';

  11999  2 002476   000011 115007                    CMPA    9,DL
         2 002477   002503 605400 2                  TPNZ    s:12000

  11999  2 002500   000053 236000 1                  LDQ     E_LIMEXCMAX+9
         2 002501   200114 756100                    STQ     TXT_TIME,,AUTO
         2 002502   002521 710000 2                  TRA     s:12003

      736    12000    2     ELSE IF (HRS <= 99) THEN SUBSTR(TXT_TIME.HR, 0, 3) = '   ';

  12000  2 002503   000143 115007                    CMPA    99,DL
         2 002504   002510 605400 2                  TPNZ    s:12001

  12000  2 002505   000051 236000 1                  LDQ     E_LIMEXCMAX+7
         2 002506   200114 552170                    STBQ    TXT_TIME,'70'O,AUTO
         2 002507   002521 710000 2                  TRA     s:12003

      737    12001    2     ELSE IF (HRS <= 999) THEN SUBSTR(TXT_TIME.HR, 0, 2) = '  ';

  12001  2 002510   001747 115007                    CMPA    999,DL
         2 002511   002515 605400 2                  TPNZ    s:12002

  12001  2 002512   000051 220000 1                  LDX0    E_LIMEXCMAX+7
         2 002513   200114 740100                    STX0    TXT_TIME,,AUTO
         2 002514   002521 710000 2                  TRA     s:12003

      738    12002    2     ELSE IF (HRS <= 9999) THEN SUBSTR(TXT_TIME.HR, 0, 1) = ' ';

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:103  
  12002  2 002515   023417 115007                    CMPA    9999,DL
         2 002516   002521 605400 2                  TPNZ    s:12003

  12002  2 002517   040000 236003                    LDQ     16384,DU
         2 002520   200114 552140                    STBQ    TXT_TIME,'40'O,AUTO

      739    12003    2     RETURN;

  12003  2 002521   000001 702211                    TSX2  ! 1,X1
      740    12004    2   END CNVRT_TIME;
      741    12005    1   END CPJ$IBEX;

PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:104  
--  Include file information  --

   AS_SUPER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPJ$IBEX.
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:105  

 **** Variables and constants ****

  ****  Section 001 RoData CPJ$IBEX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/c CHAR(47)    r     1 BOG                       24-0-0/c STRC(27)    r     1 C_DO
    31-0-0/c STRC(63)    r     1 C_FPOOLS                  22-0-0/c STRC(27)    r     1 C_LO
    35-0-0/c STRC(63)    r     1 C_MEMORY                  27-0-0/c STRC(45)    r     1 C_PDIS
    23-0-0/c STRC(27)    r     1 C_PO                      25-0-0/c STRC(45)    r     1 C_TDIS
    33-0-0/c STRC(45)    r     1 C_TIME                    40-0-0/w STRC        r     1 E_CANTOPN
    42-0-0/w STRC        r     1 E_LIMEXCMAX               41-0-0/w STRC        r     1 E_LIMMAX
    37-0-0/w STRC        r     1 E_RESCOREMIN               0-0-0/c CHAR(23)    r     1 MAXSVLIM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   155-0-0/w PTR         r     1 @CC_MAX                  153-0-0/w PTR         r     1 @C_NAME
     3-0-0/w PTR         r     1 @P$PCB                   154-0-0/w PTR         r     1 @TEMP_MAX
   153-0-0/w PTR         r     1 @VAL_B                   156-0-0/w PTR         r     1 @VAL_CUR
   154-0-0/w PTR         r     1 @VAL_G                   155-0-0/w PTR         r     1 @VAL_O
   163-0-0/w PTR         r     1 @VAL_TIME                 35-0-0/b BIT         r     1 ABORTFLAG
    22-0-0/w PTR         r     1 BLK$                      17-0-0/w SBIN        r     1 CC_FBUL
    10-0-0/w SBIN        r     1 CC_MAX                    *0-0-0/w SBIN        r     1 CC_MAX
    11-0-0/w SBIN        r     1 CC_MAXCORE                15-0-0/w SBIN        r     1 CC_MAXTMPDP
    20-0-0/w SBIN        r     1 CC_MRT                    16-0-0/w SBIN        r     1 CC_PRDPRM
    13-0-0/w SBIN        r     1 CC_REMCPO                 14-0-0/w SBIN        r     1 CC_REMDO
    12-0-0/w SBIN        r     1 CC_REMLO                 117-0-0/w STRC(972)   r     1 CP_LIMREC
    *0-0-0/c STRC(63)    r     1 C_NAME                   156-0-0/c STRC(108)   r     1 C_VAL
    25-0-0/w PTR         r     1 DEST$                    166-0-0/w SBIN        r     1 HRS
     6-0-0/w SBIN        r     1 I                         23-0-0/w PTR         r     1 IN$
    41-0-0/c CHAR(50)    r     1 INBUFF                     7-0-0/w SBIN        r     1 J
   157-0-0/c CHAR(11)    r     1 MAXBUFF                  165-0-0/w SBIN        r     1 MINS
    24-0-0/w PTR         r     1 OUT$                      56-0-0/c CHAR(120)   r     1 OUTBUFF
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:106  
    *0-0-0/w STRC(504)   r     1 P$PCB                    164-0-0/w SBIN        r     1 SECS
    33-0-0/b BIT         r     1 STEPFLAG                  34-0-0/b BIT         r     1 STEP_CALC
    26-0-0/w UBIN        r     1 TAB_VAL                  161-0-0/w UBIN        r     1 TEMP
     4-0-0/w PTR         r     1 TEMP$                      5-0-0/w PTR         r     1 TEMP1$
    21-0-0/w SBIN        r     1 TEMP_MAX                  *0-0-0/w SBIN        r     1 TEMP_MAX
   114-0-0/c STRC(99)    r     1 TXT_TIME                 114-0-0/c CHAR(11)    r     1 TXT_TIME_R
    27-0-0/w UBIN        r     1 VAL_B                     *0-0-0/w UBIN        r     1 VAL_B
    32-0-0/w SBIN        r     1 VAL_CUR                   *0-0-0/w UBIN        r     1 VAL_CUR
    30-0-0/w UBIN        r     1 VAL_G                     *0-0-0/w UBIN        r     1 VAL_G
    31-0-0/w UBIN        r     1 VAL_O                     *0-0-0/w UBIN        r     1 VAL_O
    *0-0-0/w SBIN        r     1 VAL_TIME

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c STRC(54)    r     1 K_LIMIT                    0-0-0/w UBIN        r     1 M$IBEX1_NUM
     0-0-0/w PTR         r     1 SEG2$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(18576) r     1 AS$USERS                   0-0-0/w STRC(2448)  r     1 B$EXCFR
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d STRC(1080)  r     1 FPT$CLOSE                  0-0-0/d STRC(432)   r     1 FPT$WRITE
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S
     0-0-0/w STRC(6264)  r     1 SEG$2                      0-0-0/c ASTR(9)     r     1 TEXT$C


   Procedure CPJ$IBEX requires 1362 words for executable code.
   Procedure CPJ$IBEX requires 128 words of local(AUTO) storage.
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:107  

    No errors detected in file CPJ$IBEX.:E05TSI    .
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:108  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:109  
          MINI XREF LISTING

ABORTFLAG
     10432**DCL     11536<<ASSIGN  11544<<ASSIGN  11890>>IF
ABRT_CHK
     11858**PROC    11573--CALL    11590--CALL    11607--CALL    11613--CALL    11639--CALL    11656--CALL
     11670--CALL    11700--CALL
AS$USERS.BANNER_PERM
     11332**DCL     11333--REDEF
AS$USERS.BUDGET.MACCT
     11237**DCL     11241--REDEF
AS$USERS.BUDGET.MAX_PROJECTS
     11250**DCL     11253--REDEF
AS$USERS.BUDGET.PACCUM
     11233**DCL     11235--REDEF
AS$USERS.BUDGET.PMAXC
     11228**DCL     11230--REDEF
AS$USERS.MDO
     11268**DCL     11462<>CALL    11462<>CALL    11462<>CALL
AS$USERS.MFPOOLS
     11276**DCL     11490>>ASSIGN  11491>>ASSIGN  11492>>ASSIGN
AS$USERS.MLO
     11266**DCL     11455<>CALL    11455<>CALL    11455<>CALL
AS$USERS.MMPRIO
     11278**DCL     11497>>ASSIGN  11498>>ASSIGN  11499>>ASSIGN
AS$USERS.MPDIS
     11272**DCL     11476<>CALL    11476<>CALL    11476<>CALL
AS$USERS.MPO
     11270**DCL     11469<>CALL    11469<>CALL    11469<>CALL
AS$USERS.MTDIS
     11274**DCL     11483<>CALL    11483<>CALL    11483<>CALL
AS$USERS.MTIME
     11313**DCL     11506>>ASSIGN  11510>>ASSIGN  11514>>ASSIGN
AS$USERS.SETUP_CHRA.TXT
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:110  
     11348**DCL     11349--REDEF   11350--REDEF
B$EXCFR.ASL
     10566**DCL     10566--REDEF
B$EXCFR.ERR
     10580**DCL     11832>>ASSIGN
B$EXCFR.ERR.ERR#
     10580**DCL     10580--REDEF
B$EXCFR.EVID
     10579**DCL     10579--REDEF   10580--REDEF
B$EXCFR.IR
     10567**DCL     10567--REDEF
B$EXCFR.PREVSZ
     10566**DCL     10566--REDEF
B$EXCFR.SUBC
     10578**DCL     10578--REDEF   10579--REDEF   10579--REDEF
B$JIT.CPFLAGS1
       201**DCL     11810<<ASSIGN  11810>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       206**DCL       206--REDEF
B$JIT.CURRCORE
       274**DCL     11614>>IF      11618>>ASSIGN
B$JIT.CURTMPDP
       281**DCL     11482>>ASSIGN  11634>>ASSIGN  11638>>ASSIGN  11758>>ASSIGN  11759>>ASSIGN
B$JIT.DEFPRI
       260**DCL     11496>>ASSIGN
B$JIT.ERR.MID
       113**DCL       113--REDEF
B$JIT.FBUL
       272**DCL     11489>>ASSIGN  11777<<ASSIGN
B$JIT.JRESPEAK
       274**DCL       275--REDEF
B$JIT.MAXCORE
       273**DCL     11745<<ASSIGN
B$JIT.MAXTMPDP
       281**DCL     11482>>ASSIGN  11758<<ASSIGN
B$JIT.MODE
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:111  
       107**DCL     11890>>IF
B$JIT.MRT
       286**DCL     11518>>ASSIGN  11786<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
       383**DCL       383--REDEF     384--REDEF
B$JIT.PNR
       287**DCL       287--REDEF
B$JIT.PRDPRM
       281**DCL     11475>>ASSIGN  11768<<ASSIGN
B$JIT.REMCPO
       385**DCL     11468>>ASSIGN  11727<<ASSIGN
B$JIT.REMDO
       385**DCL     11461>>ASSIGN  11736<<ASSIGN
B$JIT.REMLO
       385**DCL     11454>>ASSIGN  11715<<ASSIGN
B$JIT.RESCORE
       381**DCL     11612>>ASSIGN
B$JIT.TSLINE
       381**DCL       382--REDEF
B$JIT.USRERR
       248**DCL     11832<<ASSIGN
B$JIT$
      9904**DCL       107--IMP-PTR 11454>>ASSIGN  11461>>ASSIGN  11468>>ASSIGN  11475>>ASSIGN  11482>>ASSIGN
     11482>>ASSIGN  11489>>ASSIGN  11496>>ASSIGN  11518>>ASSIGN  11612>>ASSIGN  11614>>IF      11618>>ASSIGN
     11634>>ASSIGN  11638>>ASSIGN  11715>>ASSIGN  11727>>ASSIGN  11736>>ASSIGN  11745>>ASSIGN  11758>>ASSIGN
     11758>>ASSIGN  11759>>ASSIGN  11768>>ASSIGN  11777>>ASSIGN  11786>>ASSIGN  11810>>ASSIGN  11810>>ASSIGN
     11832>>ASSIGN  11890>>IF
B$TCB.ALT$
     10563**DCL     11832>>ASSIGN
B$TCB$
      9906**DCL     10563--IMP-PTR 11832>>ASSIGN
BLK$
     10421**DCL     10589--IMP-PTR 10836--IMP-PTR 11423<<ASSIGN  11427>>IF      11538>>DOWHILE 11539>>ASSIGN
     11554>>DOWHILE 11555>>ASSIGN  11710>>DOWHILE 11711>>ASSIGN
BOG
     10434**DCL     11444--CALL    11444--CALL
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:112  
CAMR_REC.ACSVEH_
      8943**DCL      8944--REDEF
CAMR_REC.ALTKEYS_
      8949**DCL      8950--REDEF    8950--REDEF
CAMR_REC.HDR_
      8948**DCL      8949--REDEF
CAMR_REC.TAB_
      8947**DCL      8948--REDEF
CAMR_REC.UHL_
      8941**DCL      8942--REDEF    8942--REDEF
CAMR_REC.V.FSN#
      8981**DCL      8981--REDEF    8981--REDEF
CAMR_REC.WSN_
      8947**DCL      8947--REDEF
CC_FBUL
     10418**DCL     11671<<ASSIGN  11777>>ASSIGN  11780>>ASSIGN  11783>>ASSIGN
CC_MAX
     10411**DCL     11564<<CALLBLT 11573<>CALL    11574>>ASSIGN  11581<<CALLBLT 11590<>CALL    11591>>ASSIGN
     11598<<CALLBLT 11607<>CALL    11608>>ASSIGN  11611<<CALLBLT 11613<>CALL    11614>>IF      11618<<ASSIGN
     11626>>ASSIGN  11633<<CALLBLT 11634<<ASSIGN  11634>>ASSIGN  11639<>CALL    11640>>ASSIGN  11647<<CALLBLT
     11656<>CALL    11657>>ASSIGN  11664<<CALLBLT 11670<>CALL    11671>>ASSIGN  11678<<ASSIGN  11684<<ASSIGN
     11684>>ASSIGN  11686<<ASSIGN  11686>>ASSIGN  11688<<ASSIGN  11688>>ASSIGN  11691<<ASSIGN  11691>>ASSIGN
     11700<>CALL    11701>>ASSIGN
CC_MAX IN PROCEDURE ABRT_CHK
     11867**DCL     11858--PROC    11870>>IF      11902<<ASSIGN
CC_MAXCORE
     10412**DCL     11626<<ASSIGN  11745>>ASSIGN  11748>>ASSIGN  11751>>ASSIGN
CC_MAXTMPDP
     10416**DCL     11640<<ASSIGN  11758>>ASSIGN  11762>>ASSIGN  11765>>ASSIGN
CC_MRT
     10419**DCL     11701<<ASSIGN  11786>>ASSIGN  11789>>ASSIGN  11792>>ASSIGN
CC_PRDPRM
     10417**DCL     11657<<ASSIGN  11768>>ASSIGN  11771>>ASSIGN  11774>>ASSIGN
CC_REMCPO
     10414**DCL     11591<<ASSIGN  11727>>ASSIGN  11730>>ASSIGN  11733>>ASSIGN
CC_REMDO
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:113  
     10415**DCL     11608<<ASSIGN  11736>>ASSIGN  11739>>ASSIGN  11742>>ASSIGN
CC_REMLO
     10413**DCL     11574<<ASSIGN  11715>>ASSIGN  11721>>ASSIGN  11724>>ASSIGN
CFPT_CLOSE.SN_
      7785**DCL      7785--REDEF
CFPT_CLOSE.UTL_
      7786**DCL      7786--REDEF
CFPT_CLOSE.V.EXPIRE#
      7800**DCL      7800--REDEF
CFPT_CLOSE.V.TYPE#
      7798**DCL      7798--REDEF
CFPT_CLOSE.V.XTNSIZE#
      7795**DCL      7795--REDEF    7797--REDEF
CFPT_OPEN.ACSVEH_
      7720**DCL      7721--REDEF
CFPT_OPEN.ALTKEYS_
      7726**DCL      7727--REDEF    7727--REDEF
CFPT_OPEN.HDR_
      7725**DCL      7726--REDEF
CFPT_OPEN.TAB_
      7724**DCL      7725--REDEF
CFPT_OPEN.UHL_
      7718**DCL      7719--REDEF    7719--REDEF
CFPT_OPEN.V.FSN#
      7758**DCL      7758--REDEF    7758--REDEF
CFPT_OPEN.WSN_
      7724**DCL      7724--REDEF
CFPT_READ.STATION_
      7824**DCL      7825--REDEF
CFPT_READ.V.DVBYTE.REREAD#
      7836**DCL      7836--REDEF
CFPT_READ.V.INDX#
      7834**DCL      7834--REDEF
CFPT_READUC.STATION_
      8194**DCL      8195--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:114  
      8206**DCL      8206--REDEF
CFPT_READUC.V.INDX#
      8204**DCL      8204--REDEF
CFPT_TRTN.V.IR#
      8430**DCL      8431--REDEF
CFPT_WRITE.STATION_
      7862**DCL      7862--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      7869**DCL      7869--REDEF
CFPT_WRITEUC.STATION_
      8162**DCL      8162--REDEF
CFPT_WRITEUC.V.DVBYTE.VFC#
      8169**DCL      8169--REDEF
CFPT_XXX.V.STEPCC#
      9142**DCL      9142--REDEF
CGETCMD.OUT$
      9163**DCL      9169--REDEF
CNVRT_TIME
     11984**PROC    11507--CALL    11511--CALL    11515--CALL    11519--CALL    11879--CALL
CPA$BYE
     10470**DCL-ENT 11823--CALL
CPB$BLDIMAGE
     10477**DCL-ENT 11437--CALL    11444--CALL    11504--CALL    11508--CALL    11512--CALL    11516--CALL
     11520--CALL    11942--CALL    11947--CALL    11953--CALL    11959--CALL    11965--CALL
CPC$OPEN_S
     10471**DCL-ENT 11529--CALL
CPC$RDUSERS
     10479**DCL-ENT 11449--CALL
CPC$WRITEMSGE
     10472**DCL-ENT 11617--CALL    11829--CALL    11898--CALL    11913--CALL
CPE$LISTOUT
     10478**DCL-ENT 11440--CALL    11447--CALL    11523--CALL    11968--CALL
CPE$RZEROS
     10474**DCL-ENT 11887--CALL    11946--CALL    11952--CALL    11958--CALL    11964--CALL
CPJ$ESTLIM
     10473**DCL-ENT 11563--CALL    11580--CALL    11597--CALL    11632--CALL    11646--CALL    11663--CALL
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:115  
     11677--CALL
CPJ$READ_S
     10475**DCL-ENT 11530--CALL
CPJ$WRITE_S
     10476**DCL-ENT 11800--CALL    11818--CALL
CP_LIMREC
     10966**DCL     11530--CALL    11563<>CALL    11580<>CALL    11597<>CALL    11632<>CALL    11646<>CALL
     11663<>CALL    11677<>CALL    11800--CALL    11818--CALL
CP_LIMREC.CUMUL.MAXTMPDP
     10999**DCL     11759<<ASSIGN
CP_LIMREC.CUMUL.MRT
     11001**DCL     11699>>ASSIGN
CP_LIMREC.CUMUL.PRDPRM
     11000**DCL     11655>>ASSIGN
CP_LIMREC.CUMUL.REMCPO
     10997**DCL     11589>>ASSIGN
CP_LIMREC.CUMUL.REMDO
     10998**DCL     11606>>ASSIGN
CP_LIMREC.CUMUL.REMLO
     10996**DCL     11572>>ASSIGN
CP_LIMREC.CUR_MAX.FBUL
     10979**DCL     11667>>ASSIGN  11783<<ASSIGN
CP_LIMREC.CUR_MAX.MAXCORE
     10978**DCL     11751<<ASSIGN
CP_LIMREC.CUR_MAX.MAXTMPDP
     10984**DCL     11765<<ASSIGN
CP_LIMREC.CUR_MAX.MRT
     10985**DCL     11697>>ASSIGN  11792<<ASSIGN
CP_LIMREC.CUR_MAX.PRDPRM
     10983**DCL     11653>>ASSIGN  11774<<ASSIGN
CP_LIMREC.CUR_MAX.REMCPO
     10981**DCL     11587>>ASSIGN  11733<<ASSIGN
CP_LIMREC.CUR_MAX.REMDO
     10982**DCL     11604>>ASSIGN  11742<<ASSIGN
CP_LIMREC.CUR_MAX.REMLO
     10980**DCL     11570>>ASSIGN  11724<<ASSIGN
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:116  
CP_LIMREC.STEP_MAX.FBUL
     10988**DCL     11660>>IF      11780<<ASSIGN
CP_LIMREC.STEP_MAX.MAXCORE
     10987**DCL     11748<<ASSIGN
CP_LIMREC.STEP_MAX.MAXTMPDP
     10993**DCL     11629>>IF      11762<<ASSIGN
CP_LIMREC.STEP_MAX.MRT
     10994**DCL     11674>>IF      11789<<ASSIGN
CP_LIMREC.STEP_MAX.PRDPRM
     10992**DCL     11643>>IF      11771<<ASSIGN
CP_LIMREC.STEP_MAX.REMCPO
     10990**DCL     11577>>IF      11730<<ASSIGN
CP_LIMREC.STEP_MAX.REMDO
     10991**DCL     11594>>IF      11739<<ASSIGN
CP_LIMREC.STEP_MAX.REMLO
     10989**DCL     11560>>IF      11721<<ASSIGN
CP_LIMREC.USER_MAX.FBUL
     10969**DCL     11669>>ASSIGN
CP_LIMREC.USER_MAX.MAXTMPDP
     10974**DCL     11638>>ASSIGN
CP_LIMREC.USER_MAX.MRT
     10975**DCL     11699>>ASSIGN
CP_LIMREC.USER_MAX.PRDPRM
     10973**DCL     11655>>ASSIGN
CP_LIMREC.USER_MAX.REMCPO
     10971**DCL     11589>>ASSIGN
CP_LIMREC.USER_MAX.REMDO
     10972**DCL     11606>>ASSIGN
CP_LIMREC.USER_MAX.REMLO
     10970**DCL     11572>>ASSIGN
CVLP_TRMCTL.BREAKCOUNT
      8754**DCL      8755--REDEF
CVLP_WINDOW.FWINDOW#
      8850**DCL      8850--REDEF    8851--REDEF
C_DO
     10442**DCL     11607<>CALL
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:117  
C_DO.TEXT
     10444**DCL     10443--DCLINIT 11460>>ASSIGN
C_FPOOLS
     10451**DCL     11670<>CALL
C_FPOOLS.TEXT
     10453**DCL     10452--DCLINIT 11488>>ASSIGN
C_LO
     10436**DCL     11573<>CALL
C_LO.TEXT
     10438**DCL     10437--DCLINIT 11453>>ASSIGN
C_MEMORY
     10457**DCL     11613<>CALL
C_MEMORY.TEXT
     10459**DCL     10458--DCLINIT
C_NAME IN PROCEDURE ABRT_CHK
     11859**DCL     11858--PROC    11876--IF      11876--IF      11898<>CALL    11913<>CALL
C_PDIS
     10448**DCL     11656<>CALL
C_PDIS.TEXT
     10450**DCL     10449--DCLINIT 11474>>ASSIGN
C_PO
     10439**DCL     11590<>CALL
C_PO.TEXT
     10441**DCL     10440--DCLINIT 11467>>ASSIGN
C_TDIS
     10445**DCL     11639<>CALL
C_TDIS.TEXT
     10447**DCL     10446--DCLINIT 11481>>ASSIGN
C_TIME
     10454**DCL     11700<>CALL
C_TIME.TEXT
     10456**DCL     10455--DCLINIT 11503>>ASSIGN
C_VAL IN PROCEDURE ABRT_CHK
     11862**DCL     11898<>CALL    11913<>CALL
C_VAL.COUNT IN PROCEDURE ABRT_CHK
     11863**DCL     11880<<ASSIGN  11888<<ASSIGN
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:118  
C_VAL.TEXT IN PROCEDURE ABRT_CHK
     11864**DCL     11881<<ASSIGN  11886<<CALLBLT 11887<>CALL    11887--CALL
DEST$
     10424**DCL     11433<<ASSIGN  11437<>CALL    11439>>ASSIGN  11442<<ASSIGN  11444<>CALL    11446>>ASSIGN
     11450<<ASSIGN  11502<<ASSIGN  11504<>CALL    11508<>CALL    11512<>CALL    11516<>CALL    11520<>CALL
     11522>>ASSIGN  11940<<ASSIGN  11942<>CALL    11944<<ASSIGN  11944>>ASSIGN  11947<>CALL    11950<<ASSIGN
     11950>>ASSIGN  11953<>CALL    11956<<ASSIGN  11956>>ASSIGN  11959<>CALL    11961<<ASSIGN  11961>>ASSIGN
     11965<>CALL    11967>>ASSIGN  11991<<ASSIGN  11991>>ASSIGN
DISP_LIMITS
     11932**PROC    11455--CALL    11462--CALL    11469--CALL    11476--CALL    11483--CALL    11493--CALL
     11500--CALL
DISP_LIMITS50 IN PROCEDURE DISP_LIMITS
     11967**LABEL   11942--CALLALT 11947--CALLALT 11953--CALLALT 11959--CALLALT 11965--CALLALT 11968--CALLALT
E_CANTOPN
     10514**DCL     11829<>CALL
E_LIMEXCMAX
     10554**DCL     11913<>CALL
E_LIMMAX
     10534**DCL     11898<>CALL
E_RESCOREMIN
     10494**DCL     11617<>CALL
FPT$CLOSE
     11135**DCL     11804<>CALL    11821<>CALL    11837<>CALL
FPT$CLOSE.SN_
     11135**DCL     11135--REDEF
FPT$CLOSE.UTL_
     11136**DCL     11136--REDEF
FPT$CLOSE.V.DCB#
     11141**DCL     11802<<ASSIGN  11819<<ASSIGN  11835<<ASSIGN
FPT$CLOSE.V.DISP#
     11144**DCL     11803<<ASSIGN  11820<<ASSIGN  11836<<ASSIGN
FPT$CLOSE.V.EXPIRE#
     11150**DCL     11150--REDEF
FPT$CLOSE.V.TYPE#
     11148**DCL     11148--REDEF
FPT$CLOSE.V.XTNSIZE#
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:119  
     11145**DCL     11145--REDEF   11147--REDEF
FPT$OPEN.ACSVEH_
     11070**DCL     11071--REDEF
FPT$OPEN.ALTKEYS_
     11076**DCL     11077--REDEF   11077--REDEF
FPT$OPEN.HDR_
     11075**DCL     11076--REDEF
FPT$OPEN.TAB_
     11074**DCL     11075--REDEF
FPT$OPEN.UHL_
     11068**DCL     11069--REDEF   11069--REDEF
FPT$OPEN.V.FSN#
     11108**DCL     11108--REDEF   11108--REDEF
FPT$OPEN.WSN_
     11074**DCL     11074--REDEF
FPT$WRITE.BUF_.BOUND
     11171**DCL     11439<<ASSIGN  11446<<ASSIGN  11522<<ASSIGN  11967<<ASSIGN
FPT$WRITE.BUF_.BUF$
     11173**DCL     11435<<ASSIGN
FPT$WRITE.STATION_
     11173**DCL     11173--REDEF
FPT$WRITE.V.DVBYTE.VFC#
     11180**DCL     11180--REDEF
HRS IN PROCEDURE CNVRT_TIME
     11988**DCL     11994<<ASSIGN  11997>>CALLBLT 11998>>IF      11999>>IF      12000>>IF      12001>>IF
     12002>>IF
I
     10409**DCL     11537<<ASSIGN  11538>>DOWHILE 11539>>ASSIGN  11546<<ASSIGN  11546>>ASSIGN  11553<<ASSIGN
     11554>>DOWHILE 11555>>ASSIGN  11704<<ASSIGN  11704>>ASSIGN  11709<<ASSIGN  11710>>DOWHILE 11711>>ASSIGN
     11795<<ASSIGN  11795>>ASSIGN
IN$
     10422**DCL     11430<<ASSIGN  11504<>CALL    11942<>CALL
INBUFF
     10460**DCL     11430--ASSIGN  11453<<ASSIGN  11460<<ASSIGN  11467<<ASSIGN  11474<<ASSIGN  11481<<ASSIGN
     11488<<ASSIGN  11495<<ASSIGN  11503<<ASSIGN
J
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:120  
     10410**DCL     11679<<DOINDEX 11680>>ASSIGN
K_LIMIT
      9944**DCL     11530--CALL    11800--CALL    11818--CALL
LIMIT45
     11808**LABEL   11573--CALLALT 11590--CALLALT 11607--CALLALT 11613--CALLALT 11639--CALLALT 11656--CALLALT
     11670--CALLALT 11700--CALLALT
LIMIT47
     11820**LABEL   11821--CALLALT
LIMIT55
     11820**LABEL   11529--CALLALT
LIMIT65
     11820**LABEL   11804--CALLALT 11823--CALLALT
LIMIT80
     11832**LABEL   11449--CALLALT 11530--CALLALT 11800--CALLALT 11818--CALLALT 11830--GOTO
LIMIT85
     11836**LABEL   11437--CALLALT 11440--CALLALT 11444--CALLALT 11447--CALLALT 11455--CALLALT 11462--CALLALT
     11469--CALLALT 11476--CALLALT 11483--CALLALT 11493--CALLALT 11500--CALLALT 11504--CALLALT 11508--CALLALT
     11512--CALLALT 11516--CALLALT 11520--CALLALT 11523--CALLALT 11837--CALLALT
M$CLOSE
        26**DCL-ENT 11804--CALL    11821--CALL    11837--CALL
M$IBEX1_NUM
      9910**DCL     11449<>CALL    11529<>CALL    11530<>CALL    11800<>CALL    11802>>ASSIGN  11818<>CALL
     11819>>ASSIGN  11829<>CALL    11835>>ASSIGN
MAXBUFF IN PROCEDURE DISP_LIMITS
     11933**DCL     11945<<CALLBLT 11946<>CALL    11946--CALL    11947--CALL    11951<<CALLBLT 11952<>CALL
     11952--CALL    11953--CALL    11957<<CALLBLT 11958<>CALL    11958--CALL    11959--CALL    11963<<CALLBLT
     11964<>CALL    11964--CALL    11965--CALL    11965--CALL
MAXSVLIM
     10433**DCL     11437--CALL    11437--CALL
MINS IN PROCEDURE CNVRT_TIME
     11987**DCL     11993<<ASSIGN  11994>>ASSIGN  11996>>CALLBLT
OUT$
     10423**DCL     11432<<ASSIGN  11433>>ASSIGN  11435>>ASSIGN  11437<>CALL    11439>>ASSIGN  11442>>ASSIGN
     11444<>CALL    11446>>ASSIGN  11450>>ASSIGN  11502>>ASSIGN  11504<>CALL    11508<>CALL    11512<>CALL
     11516<>CALL    11520<>CALL    11522>>ASSIGN  11940>>ASSIGN  11942<>CALL    11947<>CALL    11953<>CALL
     11959<>CALL    11965<>CALL    11967>>ASSIGN
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:121  
OUTBUFF
     10461**DCL     11431<<ASSIGN  11432--ASSIGN  11443<<ASSIGN
P$B.CODE
     10597**DCL     11540>>DOCASE  11557>>DOCASE  11682>>DOCASE  11712>>DOCASE
P$B.NSUBLKS
     10601**DCL     11427>>IF      11538>>DOWHILE 11554>>DOWHILE 11679>>DOINDEX 11710>>DOWHILE
P$B.SUBLK$
     10622**DCL     11539>>ASSIGN  11555>>ASSIGN  11680>>ASSIGN  11711>>ASSIGN
P$PCB
     10647**DCL        15--PROC    11420--ENTRY
P$PCB.OUT$
     10660**DCL     11423>>ASSIGN
P$S.COUNT
     10859**DCL     10862--IMP-SIZ 11564>>CALLBLT 11581>>CALLBLT 11598>>CALLBLT 11611>>CALLBLT 11633>>CALLBLT
     11647>>CALLBLT 11664>>CALLBLT 11681>>CALLBLT
P$S.TEXT
     10862**DCL     11564>>CALLBLT 11581>>CALLBLT 11598>>CALLBLT 11611>>CALLBLT 11633>>CALLBLT 11647>>CALLBLT
     11664>>CALLBLT 11681>>CALLBLT
SECS IN PROCEDURE CNVRT_TIME
     11986**DCL     11992<<ASSIGN  11993>>ASSIGN  11995>>CALLBLT
SEG$2.FPT_CLOSE$
     10906**DCL     11802>>ASSIGN  11803>>ASSIGN  11804>>CALL    11819>>ASSIGN  11820>>ASSIGN  11821>>CALL
     11835>>ASSIGN  11836>>ASSIGN  11837>>CALL
SEG$2.FPT_WRITE$
     10908**DCL     11435>>ASSIGN  11439>>ASSIGN  11440<>CALL    11446>>ASSIGN  11447<>CALL    11522>>ASSIGN
     11523<>CALL    11967>>ASSIGN  11968<>CALL
SEG$2.USERS$
     10897**DCL     11455>>CALL    11455>>CALL    11455>>CALL    11462>>CALL    11462>>CALL    11462>>CALL
     11469>>CALL    11469>>CALL    11469>>CALL    11476>>CALL    11476>>CALL    11476>>CALL    11483>>CALL
     11483>>CALL    11483>>CALL    11490>>ASSIGN  11491>>ASSIGN  11492>>ASSIGN  11497>>ASSIGN  11498>>ASSIGN
     11499>>ASSIGN  11506>>ASSIGN  11510>>ASSIGN  11514>>ASSIGN
SEG2$
      9897**DCL     10868--IMP-PTR 11435>>ASSIGN  11439>>ASSIGN  11440>>CALL    11446>>ASSIGN  11447>>CALL
     11455>>CALL    11455>>CALL    11455>>CALL    11462>>CALL    11462>>CALL    11462>>CALL    11469>>CALL
     11469>>CALL    11469>>CALL    11476>>CALL    11476>>CALL    11476>>CALL    11483>>CALL    11483>>CALL
     11483>>CALL    11490>>ASSIGN  11491>>ASSIGN  11492>>ASSIGN  11497>>ASSIGN  11498>>ASSIGN  11499>>ASSIGN
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:122  
     11506>>ASSIGN  11510>>ASSIGN  11514>>ASSIGN  11522>>ASSIGN  11523>>CALL    11802>>ASSIGN  11803>>ASSIGN
     11804>>CALL    11819>>ASSIGN  11820>>ASSIGN  11821>>CALL    11835>>ASSIGN  11836>>ASSIGN  11837>>CALL
     11967>>ASSIGN  11968>>CALL
STEPFLAG
     10430**DCL     11535<<ASSIGN  11542<<ASSIGN  11568>>IF      11585>>IF      11602>>IF      11651>>IF
     11665>>IF      11695>>IF      11719>>IF      11728>>IF      11737>>IF      11746>>IF      11760>>IF
     11769>>IF      11778>>IF      11787>>IF      11808>>IF
STEP_CALC
     10431**DCL     11556<<ASSIGN  11562<<ASSIGN  11563<>CALL    11579<<ASSIGN  11580<>CALL    11596<<ASSIGN
     11597<>CALL    11631<<ASSIGN  11632<>CALL    11645<<ASSIGN  11646<>CALL    11662<<ASSIGN  11663<>CALL
     11676<<ASSIGN  11677<>CALL
TAB_VAL
     10425**DCL     11434<<ASSIGN  11437<>CALL    11451<<ASSIGN  11504<>CALL    11508<>CALL    11512<>CALL
     11516<>CALL    11520<>CALL    11942<>CALL    11947<>CALL    11953<>CALL    11959<>CALL
TEMP IN PROCEDURE ABRT_CHK
     11865**DCL     11887<>CALL    11888>>ASSIGN
TEMP$
     10407**DCL     11539<<ASSIGN  11540>>DOCASE  11555<<ASSIGN  11557>>DOCASE  11564>>CALLBLT 11564>>CALLBLT
     11581>>CALLBLT 11581>>CALLBLT 11598>>CALLBLT 11598>>CALLBLT 11611>>CALLBLT 11611>>CALLBLT 11633>>CALLBLT
     11633>>CALLBLT 11647>>CALLBLT 11647>>CALLBLT 11664>>CALLBLT 11664>>CALLBLT 11679>>DOINDEX 11680>>ASSIGN
     11711<<ASSIGN  11712>>DOCASE
TEMP1$
     10408**DCL     11680<<ASSIGN  11681>>CALLBLT 11681>>CALLBLT 11682>>DOCASE
TEMP_MAX
     10420**DCL     11570<<ASSIGN  11572<<ASSIGN  11573<>CALL    11587<<ASSIGN  11589<<ASSIGN  11590<>CALL
     11604<<ASSIGN  11606<<ASSIGN  11607<>CALL    11612<<ASSIGN  11613<>CALL    11638<<ASSIGN  11639<>CALL
     11653<<ASSIGN  11655<<ASSIGN  11656<>CALL    11667<<ASSIGN  11669<<ASSIGN  11670<>CALL    11681<<CALLBLT
     11684>>ASSIGN  11686>>ASSIGN  11688>>ASSIGN  11697<<ASSIGN  11699<<ASSIGN  11700<>CALL
TEMP_MAX IN PROCEDURE ABRT_CHK
     11866**DCL     11858--PROC    11870>>IF      11879<>CALL    11886>>CALLBLT 11902>>ASSIGN
TEXT$C.SIZ
     11384**DCL     11385--IMP-SIZ 11876>>IF
TEXT$C.TEXT
     11385**DCL     11876>>IF
TXT_TIME
     10462**DCL     10468--REDEF   11508--CALL    11508--CALL    11512--CALL    11512--CALL    11516--CALL
PL6.E3A0      #001=CPJ$IBEX File=CPJ$IBEX.:E05TSI                                TUE 07/29/97 11:52 Page:123  
     11516--CALL    11520--CALL    11520--CALL
TXT_TIME.HR
     10463**DCL     11997<<CALLBLT 11998<<ASSIGN  11999<<ASSIGN  12000<<ASSIGN  12001<<ASSIGN  12002<<ASSIGN
TXT_TIME.MIN
     10465**DCL     11996<<CALLBLT
TXT_TIME.SEC
     10467**DCL     11995<<CALLBLT
TXT_TIME_R
     10468**DCL     11880--ASSIGN  11881>>ASSIGN  11990<<ASSIGN
VAL_B
     10426**DCL     11490<<ASSIGN  11493<>CALL    11497<<ASSIGN  11500<>CALL
VAL_B IN PROCEDURE DISP_LIMITS
     11934**DCL     11932--PROC    11945>>CALLBLT
VAL_CUR
     10429**DCL     11454<<ASSIGN  11455<>CALL    11461<<ASSIGN  11462<>CALL    11468<<ASSIGN  11469<>CALL
     11475<<ASSIGN  11476<>CALL    11482<<ASSIGN  11483<>CALL    11489<<ASSIGN  11493<>CALL    11496<<ASSIGN
     11500<>CALL    11506<<ASSIGN  11507<>CALL    11510<<ASSIGN  11511<>CALL    11514<<ASSIGN  11515<>CALL
     11518<<ASSIGN  11519<>CALL
VAL_CUR IN PROCEDURE DISP_LIMITS
     11937**DCL     11932--PROC    11963>>CALLBLT
VAL_G
     10427**DCL     11491<<ASSIGN  11493<>CALL    11498<<ASSIGN  11500<>CALL
VAL_G IN PROCEDURE DISP_LIMITS
     11935**DCL     11932--PROC    11957>>CALLBLT
VAL_O
     10428**DCL     11492<<ASSIGN  11493<>CALL    11499<<ASSIGN  11500<>CALL
VAL_O IN PROCEDURE DISP_LIMITS
     11936**DCL     11932--PROC    11951>>CALLBLT
VAL_TIME IN PROCEDURE CNVRT_TIME
     11985**DCL     11984--PROC    11992>>ASSIGN
