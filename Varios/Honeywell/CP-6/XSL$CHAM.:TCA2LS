VERSION A02

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:1    
        1        1        /*M* XSL$CHAM logon as a different user.           */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,PLM=6,IND=4,SDI=2,CTI=8,DCI=4,CSU=2,ECU=2,ENI=4,
        8        8              THI=0,DTI=0,IAD=0                              */
        9        9                                                              /**/
       10       10        XSL$CHAM: PROC(FPT, BUF) ALTRET;
       11       11                                                              /**/
       12       12        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:2    
       13       13        /*********************************************************************/
       14       14        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       15       15        /*********************************************************************/
       16       16                                                              /**/
       17       17              %INCLUDE AS_SUPER_C ;
       18      452              %INCLUDE KL_SUPER_C ;
       19     3354              %INCLUDE B$JIT ;
       20     3644    1   DCL B$JIT$ PTR SYMREF READONLY;
       21     3645              %INCLUDE B$TABLES_C;
       22     3753              %INCLUDE CP_6 ;
       23     3834              %INCLUDE CP_6_SUBS ;
       24     4374              %INCLUDE CP_MACROS_C;
       25     5126              %INCLUDE ES_SUBS_E;
       26     5152              %INCLUDE ES_TABLES_M;
       27     5546        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:3    
       28     5547        /*********************************************************************/
       29     5548        /*   PARAMETER       PARAMETER       PARAMETER       PARAMETER       */
       30     5549        /*********************************************************************/
       31     5550              %INCLUDE XSL_CHAM_M;
       32     5575        %XSL_CHAM (NAME=FPT, STCLASS=PARAM);
       33     5591
       34     5592    1   DCL BUF CHAR(FPT.L);
       35     5593        %AS_USERS (STR_NAME = AS_USERS REDEF BUF, STCLASS =) ;
       36     5771        %KL_DREC (NAME=AS_HLP REDEF BUF, STCLASS=, LAST=";");
       37     5884        %CP_LIMREC (NAME=CP_LIMREC REDEF BUF, STCLASS=);
       38     5922
       39     5923        /*********************************************************************/
       40     5924        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
       41     5925        /*********************************************************************/
       42     5926                                                              /**/
       43     5927                                                              /*   :USERS RECORD.   */
       44     5928    1   DCL ARS UBIN ;
       45     5929    1   DCL DCB$ PTR ;
       46     5930    1   DCL KEY$ PTR ;
       47     5931    1   DCL I UBIN ;
       48     5932    1   DCL UMAX SBIN ;                                 /*   MAXIMUM CHARGES.   */
       49     5933    1   DCL UACCUM UBIN ;                               /*   ACCUMULATED CHARGES.   */
       50     5934    1   DCL UBKACC BIT(1) ;                             /*   BANKRUPTCY ACCESS.   */
       51     5935    1   DCL TEMP_BIT BIT (1) ALIGNED;
       52     5936    1   DCL LOGRSN SBIN;
       53     5937    1   DCL PLAINPW CHAR(8);
       54     5938    1   DCL RE_BUDGET SBIN ;
       55     5939    1   DCL MODE UBIN WORD ;
       56     5940    1   DCL AL_DCB1# SBIN;
       57     5941              %F$DCB( DCBN = F$DCB ) ;
       58     5998    1   DCL 1 ERR_CODE AUTO ,
       59     5999    1         2 FCG_MID UBIN(18) UNAL ,
       60     6000    1         2 CODE UBIN(15) UNAL ,
       61     6001    1         2 SEV UBIN(3) UNAL ;
       62     6002        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:4    
       63     6003        /*********************************************************************/
       64     6004        /*   ENTRIES         ENTRIES         ENTRIES         ENTRIES         */
       65     6005        /*********************************************************************/
       66     6006                                                              /**/
       67     6007    1   DCL ASZ$SCRAMBLE ENTRY(1);
       68     6008    1   DCL AZA$LOGOFF ENTRY(2) ALTRET OPTIONAL;
       69     6009        /*********************************************************************/
       70     6010        /*   FPTS            FPTS            FPTS            FPTS            */
       71     6011        /*********************************************************************/
       72     6012                                                              /**/
       73     6013              %FPT_YC( FPTN=RESET_BANNER ,
       74     6014                       STCLASS=CONSTANT ,
       75     6015                       NOERR = YES,
       76     6016                       CMD = LET_BANNER_RESET );
       77     6033                                                              /**/
       78     6034    1   DCL LET_BANNER_RESET CONSTANT CHAR(0) INIT('LET BANNER RESET');
       79     6035        /*********************************************************************/
       80     6036        /*   SYS DEFAULTS    SYS DEFAULTS    SYS DEFAULTS    SYS DEFAULTS    */
       81     6037        /*********************************************************************/
       82     6038                                                              /**/
       83     6039    1   DCL SYS_UMAX SBIN WORD CONSTANT INIT(50000) ;
       84     6040                                                              /**/
       85     6041    1   DCL SCRAMBLED_BITS(0:1) CONSTANT BIT(36)
       86     6042    1     INIT ('615502466037'O, '060222751600'O);
       87     6043    1   DCL SCRAMBLED_BLANKS REDEF SCRAMBLED_BITS CHAR(8);
       88     6044        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:5    
       89     6045        /*********************************************************************/
       90     6046        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
       91     6047        /*********************************************************************/
       92     6048                                                              /**/
       93     6049    1   SET_USER_ID: ENTRY(FPT, BUF) ALTRET;
       94     6050                                                     /**/
       95     6051    1         FPT.RESPONSE = 2;
       96     6052    1         PLAINPW = ' scrmbld';
       97     6053    2         IF NOT FPT.FLAGS.SCRAMBLED AND FPT.PSWB THEN DO;
       98     6054    2             PLAINPW = FPT.PASS;
       99     6055    2             CALL ASZ$SCRAMBLE (FPT.PASS);
      100     6056    2             FPT.FLAGS.SCRAMBLED = '1'B;
      101     6057    2             END;
      102     6058    1         IF NOT B$JIT.PRIV.PRC.JIT OR FPT.L = 0 THEN ALTRETURN;
      103     6059    1         MODE = B$JIT.MODE;
      104     6060    1         LOGRSN = %ES_NO_SUCH_USER#;
      105     6061
      106     6062                                                      /* READ IN A :USERS RECORD. */
      107     6063                                                   /* SET UP M$USERS DCB FOR READ. */
      108     6064    1         CALL OPEN_HLP ALTRET (OPEN_USERS_ERR);
      109     6065    2         CALL READ_USERS (FPT) WHENRETURN DO;
      110     6066    2             IF AS_HLP.ATYP ~= %KLAT_TS# THEN EXIT;
      111     6067    2             LOGRSN = %ES_LOG_ALL#;
      112     6068    3             IF FPT.FLAGS.CHECKPW THEN DO;
      113     6069    3                 IF AS_HLP.PASSWORD = FPT.PASS THEN EXIT;
      114     6070    3                 IF NOT FPT.PSWB AND AS_HLP.PASSWORD = SCRAMBLED_BLANKS THEN EXIT;
      115     6071    3                 LOGRSN = %ES_BAD_PW#;
      116     6072    3                 END;
      117     6073    2             END;
      118     6074
      119     6075    1         CALL CLOSE_USERS;
      120     6076    2         IF LOGRSN ~= %ES_LOG_ALL# THEN DO;
      121     6077    2             IF FPT.PSWB OR FPT.FLAGS.BADPW THEN EXIT;
      122     6078    2             FPT.RESPONSE = 1;
      123     6079    2             ALTRETURN;
      124     6080    2             END;
      125     6081
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:6    
      126     6082    2         IF LOGRSN ~= %ES_NO_SUCH_USER# THEN DO;
      127     6083    2             CALL OPEN_USERS ALTRET(OPEN_USERS_ERR);
      128     6084    2             CALL READ_USERS (FPT) ALTRET(READ_USERS_ERR) ;
      129     6085    2             END;
      130     6086
      131     6087    2         IF LOGRSN = %ES_BAD_PW# THEN DO;
      132     6088    2             AS_USERS.BAD_LOGON_CNT = AS_USERS.BAD_LOGON_CNT + 1;
      133     6089    2             CALL WRITE_USERS;
      134     6090    2             CALL CLOSE_USERS;
      135     6091    2             END;
      136     6092    1         CALL SECLOG;
      137     6093    2         IF LOGRSN ~= %ES_LOG_ALL# THEN DO;
      138     6094    2             FPT.RESPONSE = 2;
      139     6095    2             ALTRETURN;
      140     6096    2             END;
      141     6097
      142     6098    2         IF FPT.FLAGS.DO_ACCOUNTING THEN DO;
      143     6099    2             IF ENTADDR(AZA$LOGOFF) = ENTADDR(NIL) THEN ALTRETURN;
      144     6100    2             CALL AZA$LOGOFF;
      145     6101    2             END;
      146     6102
      147     6103    1         FPT.RESPONSE = 0;                             /* EVERYTHING MATCHES. */
      148     6104
      149     6105    1         CALL BUDGET ALTRET(BUDGET_ERR) ;
      150     6106    1         IF NOT FPT.FLAGS.STUFF_JIT THEN RETURN;
      151     6107                                                              /*   RECORD EXISTS.  */
      152     6108                        /*                                    */
      153     6109                        /*      CHECK BUDGET.                 */
      154     6110                        /*                                    */
      155     6111    1   USER_OK: ;
      156     6112                                                              /**/
      157     6113
      158     6114    1         B$JIT.ACCN = FPT.ACCN;
      159     6115    1         B$JIT.UNAME = FPT.USER;
      160     6116
      161     6117    1         B$JIT.PRIV.JOB = AS_USERS.PRIV(MODE-1) & %(~(PR_FMEFT#|PR_FMBLK#)) ;
      162     6118                                                             /*  SHUT OFF EFT AND BLK */
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:7    
      163     6119    1         B$JIT.PRIV.ACTIVE = B$JIT.PRIV.JOB;
      164     6120    1         B$JIT.PRIV.AUTH = B$JIT.PRIV.JOB;
      165     6121                                                              /* Set PROC. PRIV. */
      166     6122    1         B$JIT.PRIOB = AS_USERS.PRIOB(MODE-1) ;
      167     6123    1         B$JIT.QUAN = AS_USERS.QUAN(MODE-1) * 1000;
      168     6124    1         IF AS_USERS.MAXENQ(MODE-1)>0 THEN B$JIT.MAXENQ = AS_USERS.MAXENQ(MODE-1);
      169     6125                                                        /* Set misc. stuff. */
      170     6126                                                             /**/
      171     6127                                                      /* Set BLIND ACCOUNTING */
      172     6128    1         B$JIT.BLINDACCTNG = AS_USERS.BUDGET.BLINDACCTNG;
      173     6129                                                             /*  MOVE HOME PACK SET.  */
      174     6130    1         B$JIT.HPSN = AS_USERS.HPSN ;
      175     6131    1         B$JIT.FPSN = ' ';
      176     6132    1         B$JIT.FACCN = B$JIT.ACCN;
      177     6133        /*    CALL CPROC ; */
      178     6134    1         B$JIT.BILL = AS_USERS.BILL( MODE-1 ) ;
      179     6135                                                              /* CHECK FOR LAST CPROC */
      180     6136    1         IF AS_USERS.LASTCPROC.NAME.CNT(MODE-1) > 0 THEN
      181     6137    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_LASTCPEXISTS#;
      182     6138                                                     /* Set limits in the JIT         */
      183     6139    1         B$JIT.REMLO = AS_USERS.DLO(MODE-1);
      184     6140    1         IF (AS_USERS.MLO(MODE-1) = 0) /*IF LO=0 ->DONT ALLOW LO OUTPUT*/
      185     6141    1         THEN B$JIT.NOLOEVER = '1'B;
      186     6142    1         ELSE B$JIT.NOLOEVER = '0'B;
      187     6143    1         B$JIT.REMDO = AS_USERS.DDO(MODE-1);
      188     6144    1         IF (AS_USERS.MDO(MODE-1) = 0) /*IF DO=0 ->DONT ALLOW DO OUTPUT*/
      189     6145    1         THEN B$JIT.NODOEVER = '1'B;
      190     6146    1         ELSE B$JIT.NODOEVER = '0'B;
      191     6147    1         B$JIT.REMCPO = AS_USERS.DPO(MODE-1);
      192     6148    1         IF (AS_USERS.MPO(MODE-1) = 0) /*IF PO=0 ->DONT ALLOW PO OUTPUT*/
      193     6149    1         THEN B$JIT.NOPOEVER = '1'B;
      194     6150    1         ELSE B$JIT.NOPOEVER = '0'B;
      195     6151    1         B$JIT.MAXTMPDP = AS_USERS.DTDIS(MODE-1);
      196     6152    1         B$JIT.FBUL = MAXIMUM( AS_USERS.DFPOOLS(MODE-1), 5 );
      197     6153    1         B$JIT.DEFEXP = AS_USERS.DEXP;
      198     6154    1         B$JIT.MAXEXP = AS_USERS.MEXP;
      199     6155    1         B$JIT.PRDPRM = AS_USERS.DPDIS(MODE-1);
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:8    
      200     6156    1         B$JIT.DEFPRI = AS_USERS.DMPRIO( MODE-1 ) ;
      201     6157    1         B$JIT.MAXPRI = AS_USERS.MMPRIO( MODE-1 ) ;
      202     6158    1         B$JIT.LOCK = AS_USERS.KEY;
      203     6159    1         IF AS_USERS.STEPACCNT
      204     6160    1         THEN
      205     6161    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STEPACCT# ;
      206     6162                                                              /* SET *S ACCOUNTING */
      207     6163    1         IF AS_USERS.FLAGS.STARSACC THEN
      208     6164    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STARSACC# ;
      209     6165    1         B$JIT.LANG = AS_USERS.NAT_LANG ;
      210     6166    1         B$JIT.OUTPRIO = AS_USERS.OUTPUTPRIO ;
      211     6167    1         B$JIT.MRT = AS_USERS.DTIME(MODE-1);
      212     6168        /* To do MEM without crashing the system, LOGON uses M$RACST.
      213     6169           We can't do that here, since we already have some allocated.
      214     6170           The equivalent of !ORES is needed, but that won't workin Batch,
      215     6171           so, just don't change the memory at all. */
      216     6172    1         AS_USERS.DMEM(MODE-1) = B$JIT.RESCORE;
      217     6173    1         AS_USERS.MMEM(MODE-1) = B$JIT.RESCORE;
      218     6174    1         B$JIT.MAXCORE = AS_USERS.DMEM(MODE-1);
      219     6175    1         B$JIT.RESCORE = B$JIT.MAXCORE ;
      220     6176    2         DO CASE(AS_USERS.RESL.OMAX(0));
      221     6177    2           CASE(0);
      222     6178    2             B$JIT.OLTA = '00'B;
      223     6179    2           CASE(1);
      224     6180    2             B$JIT.OLTA = '10'B;
      225     6181    2           CASE(ELSE);
      226     6182    2             B$JIT.OLTA = '11'B;
      227     6183    2           END;
      228     6184                                                             /**/
      229     6185        /*    CALL CLRES; */
      230     6186    1         CALL GETTIME(B$JIT.LOGONTIME);
      231     6187    1         CALL SET_LAST_LOGON_TIME;
      232     6188    1         CALL WRITE_USERS ALTRET(READ_USERS_ERR);
      233     6189    1         CALL CLOSE_USERS;
      234     6190
      235     6191                                                              /* SET UP LIMIT
      236     6192                                                                 RECORD FOR '*S' */
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:9    
      237     6193    1   DO_STARS: ;
      238     6194    1         CALL OPEN_STAR_S ALTRET ( CLOSE_S_ERR ) ;
      239     6195    1         CP_LIMREC = '0'B ;
      240     6196    1         CP_LIMREC.USER_MAX.MAXCORE = AS_USERS.MMEM(MODE-1) ;
      241     6197    1         CP_LIMREC.CUR_MAX.MAXCORE = B$JIT.MAXCORE ;
      242     6198    1         CP_LIMREC.USER_MAX.REMLO = AS_USERS.MLO(MODE-1) ;
      243     6199    1         CP_LIMREC.CUR_MAX.REMLO = B$JIT.REMLO ;
      244     6200    1         CP_LIMREC.USER_MAX.REMCPO = AS_USERS.MPO(MODE-1) ;
      245     6201    1         CP_LIMREC.CUR_MAX.REMCPO = B$JIT.REMCPO ;
      246     6202    1         CP_LIMREC.USER_MAX.REMDO = AS_USERS.MDO(MODE-1) ;
      247     6203    1         CP_LIMREC.CUR_MAX.REMDO = B$JIT.REMDO ;
      248     6204    1         CP_LIMREC.USER_MAX.MAXTMPDP = AS_USERS.MTDIS(MODE-1) ;
      249     6205    1         CP_LIMREC.CUR_MAX.MAXTMPDP = B$JIT.MAXTMPDP ;
      250     6206    1         CP_LIMREC.USER_MAX.PRDPRM = AS_USERS.MPDIS(MODE-1) ;
      251     6207    1         CP_LIMREC.CUR_MAX.PRDPRM = B$JIT.PRDPRM ;
      252     6208    1         CP_LIMREC.USER_MAX.FBUL = AS_USERS.MFPOOLS(MODE-1) ;
      253     6209    1         CP_LIMREC.CUR_MAX.FBUL = B$JIT.FBUL ;
      254     6210    1         CP_LIMREC.USER_MAX.MRT = B$JIT.MRT ;
      255     6211    1         CP_LIMREC.CUR_MAX.MRT = B$JIT.MRT ;
      256     6212
      257     6213                                                              /* OUTPUT RECORD */
      258     6214    1         CALL WRITE_STAR_S ALTRET( CLOSE_S_ERR ) ;
      259     6215                   /* Call the routine to put the bannertext record into
      260     6216                      *S file.
      261     6217                   */
      262     6218    1         CALL M$YC( RESET_BANNER);
      263     6219                                                              /**/
      264     6220    1         CALL CLOSE_USERS ALTRET ( CLOSE_S_ERR ) ;
      265     6221    1   CLOSE_S_ERR: ;
      266     6222    1         RETURN;
      267     6223                                                              /**/
      268     6224    1   READ_USERS_ERR: ;
      269     6225    1   OPEN_USERS_ERR: ;
      270     6226    1   BUDGET_ERR: ;
      271     6227                                                              /**/
      272     6228    1         CALL CLOSE_USERS;
      273     6229    1         FPT.RESPONSE = 2;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:10   
      274     6230    1         ALTRETURN;
      275     6231                                                              /**/
      276     6232                                                              /**/
      277     6233                                                              /**/
      278     6234        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:11   
      279     6235    1   BUDGET: PROC ALTRET ;
      280     6236                                                              /**/
      281     6237                    /*******************************/
      282     6238                    /*                             */
      283     6239                    /*          BUDGET             */
      284     6240                    /*                             */
      285     6241                    /*******************************/
      286     6242        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:12   
      287     6243        /*********************************************************************/
      288     6244        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      289     6245        /*********************************************************************/
      290     6246                                                              /**/
      291     6247                                                              /*   :USERS RECORD.   */
      292     6248    2   DCL TEMP SBIN ;
      293     6249    2   DCL BUDLIM BIT(1) ;
      294     6250    2   DCL MASTER_ACCT(0:20) CHAR(1);
      295     6251    2   DCL MASTER_ACCN REDEF MASTER_ACCT CHAR(21);
      296     6252        %VLP_NAME (FPTN=NONE_NAME, NAME='NONE', STCLASS=CONSTANT);
      297     6279    2   DCL NO_MACCOUNT REDEF NONE_NAME CHAR(5);
      298     6280        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:13   
      299     6281        /*********************************************************************/
      300     6282        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      301     6283        /*********************************************************************/
      302     6284                                                              /**/
      303     6285    2         B$JIT.BUDLIM = 0;
      304     6286    2         UMAX = BITBIN('377777777777'O);
      305     6287    2         BUDLIM = AS_USERS.BUDGET.BUDLIM;
      306     6288    2         IF AS_USERS.BUDGET.ICHARGES  AND  AS_USERS.BUDGET.MAXC > -1
      307     6289    3         THEN DO;
      308     6290    3             TEMP = AS_USERS.BUDGET.MAXC - AS_USERS.BUDGET.ACCUM;
      309     6291    3             IF NOT AS_USERS.BUDGET.BKACC  AND  TEMP <= 0
      310     6292    4             THEN DO;
      311     6293    4                 FPT.RESPONSE = 3;
      312     6294    4                 ALTRETURN;
      313     6295    4                 END;
      314     6296    3             IF BUDLIM THEN UMAX = MINIMUM( UMAX, TEMP );
      315     6297    3             END;
      316     6298                                                      /*
      317     6299                                                         Do any project accounting
      318     6300                                                      */
      319     6301    2         MASTER_ACCT = AS_USERS.BUDGET.MACCT;
      320     6302    3         DO WHILE( AS_USERS.BUDGET.PCHARGES  AND  MASTER_ACCN ~= NO_MACCOUNT );
      321     6303    3             CALL READ_USERS( MASTER_ACCT ) ALTRET(READ_USERS_ERR);
      322     6304    4             IF AS_USERS.BUDGET.PMAXC > -1 THEN DO;
      323     6305    4                 TEMP = AS_USERS.BUDGET.PMAXC - AS_USERS.BUDGET.PACCUM;
      324     6306    5                 IF NOT AS_USERS.BUDGET.BKACC AND TEMP <= 0 THEN DO;
      325     6307    5                     FPT.RESPONSE = 3;
      326     6308    5                     ALTRETURN;
      327     6309    5                     END;
      328     6310    4                 IF BUDLIM THEN UMAX = MINIMUM( UMAX, TEMP );
      329     6311    4                 END;
      330     6312    3             MASTER_ACCT = AS_USERS.BUDGET.MACCT;
      331     6313    3             END;
      332     6314    2         IF BUDLIM THEN B$JIT.BUDLIM = MAXIMUM( 1, UMAX );
      333     6315    2         CALL REREAD_USERS (FPT) ALTRET(READ_USERS_ERR);
      334     6316    2         RETURN;
      335     6317
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:14   
      336     6318    2   READ_USERS_ERR:
      337     6319                                                              /**/
      338     6320                                                              /**/
      339     6321    2         FPT.RESPONSE = 3;
      340     6322    2         ALTRETURN ;
      341     6323    2   END   BUDGET ;
      342     6324        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:15   
      343     6325                                                              /**/
      344     6326    1   SECLOG: PROC;
      345     6327                                                              /**/
      346     6328        /* Log a logon attempt, of whatever outcome */
      347     6329        %INCLUDE EL_SUBS_C;
      348     6413        %ES$SECLOG (NAME=ES$SECLOG,STCLASS=AUTO);
      349     6690        %FPT_WRSYSLOG (FPTN=CWRSYSLOG, SIZE="SIZEW(ES$SECLOG)", TYPE=EL_SYS_ACCESS,
      350     6691              FILENUM=EL_SEC, STCLASS=CONSTANT);
      351     6706        %FPT_WRSYSLOG (STCLASS=AUTO);
      352     6721    2   DCL SAVEPRIV BIT(36);
      353     6722
      354     6723    2         ES$SECLOG = '0'B;
      355     6724    2         ES$SECLOG.MODE = MODE;
      356     6725    2         ES$SECLOG.SYSID = B$JIT.SYSID;
      357     6726    2         ES$SECLOG.USER = B$JIT.USER;
      358     6727    2         ES$SECLOG.ACCN = FPT.ACCN;
      359     6728    2         ES$SECLOG.UNAME = FPT.USER;
      360     6729    2         ES$SECLOG.REASON = LOGRSN;
      361     6730    2         IF LOGRSN = %ES_LOG_ALL# THEN ES$SECLOG.GRANTED = '1'B;
      362     6731    3         IF LOGRSN = %ES_BAD_PW# THEN DO;
      363     6732    3             ES$SECLOG.PASSWORD = PLAINPW;
      364     6733    3             ES$SECLOG.PRIV = AS_USERS.PRIV(%M_INT#-1);
      365     6734    3             ES$SECLOG.PPRIV = AS_USERS.PPRIV(%M_INT#-1);
      366     6735    3             END;
      367     6736
      368     6737    2         FPT_WRSYSLOG = CWRSYSLOG;
      369     6738    2         FPT_WRSYSLOG.ENTRY_ = VECTOR (ES$SECLOG);
      370     6739    2         SAVEPRIV = B$JIT.PRIV.ACTIVE;
      371     6740    2         B$JIT.PRIV.ACTIVE.SYSLOG = '1'B;
      372     6741    2         CALL M$WRSYSLOG (FPT_WRSYSLOG);
      373     6742    2         B$JIT.PRIV.ACTIVE = SAVEPRIV;
      374     6743    2         RETURN;
      375     6744    2   END SECLOG;
      376     6745        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:16   
      377     6746                                                              /**/
      378     6747    1   SET_LAST_LOGON_TIME: PROC;
      379     6748                                                              /**/
      380     6749        /* Set fields in :USERS record */
      381     6750    2         AS_USERS.LAST_LOGON_TIME = BINBIT(B$JIT.LOGONTIME,36);
      382     6751    2         AS_USERS.BAD_LOGON_CNT = 0;
      383     6752    2         AS_USERS.LOGINS.LAST_LOGON_TIME(MODE-1) = B$JIT.LOGONTIME;
      384     6753    2         AS_USERS.LOGINS.BAD_LOGON_CNT(MODE-1) = 0;
      385     6754
      386     6755    2         RETURN;
      387     6756
      388     6757    2   END   SET_LAST_LOGON_TIME;
      389     6758        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:17   
      390     6759    1   READ_USERS: PROC (USERS_KEY ) ALTRET ;
      391     6760                  /***********************************************************/
      392     6761                  /*                                                         */
      393     6762                  /*      NAME:     ALA$READ_USERS                           */
      394     6763                  /*                                                         */
      395     6764                  /*      CALL:     CALL ALA$READ_USERS (USERS_KEY, RW$USERS) */
      396     6765                  /*                                                         */
      397     6766                  /*      INPUT:    USERS_KEY  is the KEY to the :USERS      */
      398     6767                  /*                           record to be read.            */
      399     6768                  /*                RW$USERS   is the buffer to read the     */
      400     6769                  /*                           the USERS record into.        */
      401     6770                  /*                                                         */
      402     6771                  /*      OUTPUT:   Nothing is passed.                       */
      403     6772                  /*                                                         */
      404     6773                  /*      DESCRIPTION:  ALA$READ_USERS is the routine to     */
      405     6774                  /*                read a users record from :USERS.         */
      406     6775                  /*                                                         */
      407     6776                  /*      ENTRIES:                                           */
      408     6777                  /*                ALA$READ_USERS (USERS_KEY, RW$USERS)     */
      409     6778                  /*                ALA$OPEN_USERS                           */
      410     6779                  /*                ALA$CLOSE_USERS                          */
      411     6780                  /*                                                         */
      412     6781                  /***********************************************************/
      413     6782                                                                                      /**/
      414     6783        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:18   
      415     6784        /*********************************************************************/
      416     6785        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
      417     6786        /*********************************************************************/
      418     6787                                                                                      /**/
      419     6788    2   DCL 1 FILE_ACCT CONSTANT SYMDEF,
      420     6789    2         2 TEXT CHAR(8) INIT(':SYS') ;
      421     6790                                                                                      /**/
      422     6791        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:19   
      423     6792        /*********************************************************************/
      424     6793        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
      425     6794        /*********************************************************************/
      426     6795                                                                                      /**/
      427     6796    2   DCL 1 USERS_KEY ,
      428     6797    2         2 CNT UBIN(9) UNAL ,
      429     6798    2         2 TEXT CHAR(20) UNAL ;
      430     6799                                                                                      /**/
      431     6800        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:20   
      432     6801        /*********************************************************************/
      433     6802        /*   FPTS            FPTS            FPTS            FPTS            */
      434     6803        /*********************************************************************/
      435     6804                                                                                      /**/
      436     6805              %FPT_OPEN (FPTN=OPEN_USERS_FPT ,
      437     6806                          STCLASS = CONSTANT ,
      438     6807                          NAME = USERS_NAME ,
      439     6808                          ACCT = FILE_ACCT ,
      440     6809                          ASN  = FILE ,
      441     6810                          ACS = DIRECT ,
      442     6811                          ORG = KEYED ,
      443     6812                          FUN = UPDATE ,
      444     6813                          SHARE = ALL) ;
      445     6922              %VLP_NAME (FPTN=USERS_NAME ,
      446     6923                         STCLASS=CONSTANT ,
      447     6924                         NAME=':USERS' );
      448     6951              %VLP_NAME (FPTN=HLP_NAME ,
      449     6952                         STCLASS=CONSTANT ,
      450     6953                         NAME=':HLP' );
      451     6980              %VLP_NAME (FPTN=STAR_S_NAME ,
      452     6981                         STCLASS=CONSTANT ,
      453     6982                         NAME='*S' );
      454     7009              %VLP_NAME (FPTN=LIMIT_KEY ,
      455     7010                         STCLASS=CONSTANT ,
      456     7011                         NAME='LIMIT' );
      457     7038              %FPT_OPEN ( FPTN=OPEN$USERS_FPT ,
      458     7039                          SCRUB = YES ,
      459     7040                          STCLASS = AUTO ) ;
      460     7149              %FPT_CLOSE (FPTN = CLOSE_USERS_FPT ,
      461     7150                          STCLASS = CONSTANT ,
      462     7151                          DISP = SAVE) ;
      463     7193              %FPT_CLOSE (FPTN = CLOSE$USERS_FPT ,
      464     7194                          STCLASS = AUTO ) ;
      465     7236              %FPT_READ  (FPTN = READ_USERS_FPT ,
      466     7237                          STCLASS = CONSTANT ,
      467     7238                          KEYS = YES) ;
      468     7277              %FPT_READ  (FPTN = FPT$READ ,
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:21   
      469     7278                          STCLASS = AUTO ) ;
      470     7317              %FPT_WRITE ( FPTN = WRITE_USERS_FPT,
      471     7318                            STCLASS = CONSTANT ) ;
      472     7349              %FPT_WRITE ( FPTN = WRITE$USERS_FPT,
      473     7350                            STCLASS = AUTO ) ;
      474     7381              %FPT_GETDCB ( FPTN = FPT_GETUSERS ,
      475     7382                            STCLASS = CONSTANT ) ;
      476     7397              %FPT_GETDCB ( FPTN = FPT$GETUSERS ,
      477     7398                            STCLASS = AUTO ) ;
      478     7413              %FPT_RELDCB ( FPTN = FPT_RELUSERS ,
      479     7414                            STCLASS = CONSTANT ) ;
      480     7428              %FPT_RELDCB ( FPTN = FPT$RELUSERS ,
      481     7429                            STCLASS = AUTO ) ;
      482     7443              %FPT_ENQ ( FPTN = FPT_ENQ_USERS ,
      483     7444                            SHARE = NONE ,
      484     7445                            STCLASS = CONSTANT ) ;
      485     7463              %FPT_ENQ ( FPTN = FPT$ENQ_USERS ,
      486     7464                            STCLASS = AUTO ) ;
      487     7482    2   DCL 1 VEC BASED DALIGNED,2 * PTR, 2 P$ PTR;
      488     7483
      489     7484    2   DCL SAVEPRIV BIT(36);
      490     7485                                                                                      /**/
      491     7486        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:22   
      492     7487        /********************************************************************/
      493     7488        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      494     7489        /*********************************************************************/
      495     7490                                                              /**/
      496     7491                                                              /*
      497     7492                                                                    ***** Init. Enq fpt
      498     7493                                                              */
      499     7494    2         FPT$ENQ_USERS = FPT_ENQ_USERS;
      500     7495    2         ADDR(FPT$ENQ_USERS) -> VEC.P$ = ADDR(FPT$ENQ_USERS.V);
      501     7496    2         FPT$ENQ_USERS.V.DCB# = AL_DCB1#;
      502     7497    2         FPT$ENQ_USERS.RNAME_ = VECTOR(USERS_KEY);
      503     7498    2         CALL M$ENQ(FPT$ENQ_USERS) ALTRET(READ_ERR);
      504     7499
      505     7500    2   REREAD_USERS: ENTRY (USERS_KEY) ALTRET;
      506     7501                                                              /*
      507     7502                                                                   SET BUF$ IN READ FPT
      508     7503                                                              */
      509     7504    2         FPT$READ = READ_USERS_FPT ;
      510     7505    2         FPT$READ.BUF_ = VECTOR(AS_USERS) ;
      511     7506    2         FPT$READ.KEY_ = VECTOR(USERS_KEY) ;
      512     7507    2         FPT$READ.V.DCB# = AL_DCB1# ;
      513     7508    2         ADDR(FPT$READ) -> VEC.P$ = ADDR(FPT$READ.V) ;
      514     7509    2         CALL M$READ (FPT$READ) ALTRET(READ_ERR) ;
      515     7510    2         RETURN ;
      516     7511    2   READ_ERR:
      517     7512    2         ALTRETURN ;
      518     7513                                                              /**/
      519     7514    2   OPEN_USERS:
      520     7515    2         ENTRY     ALTRET ;
      521     7516                                                              /**/
      522     7517    2         OPEN$USERS_FPT = OPEN_USERS_FPT ;
      523     7518    2         GOTO OPEN_IT;
      524     7519
      525     7520    2   OPEN_HLP:
      526     7521    2         ENTRY     ALTRET ;
      527     7522                                                              /**/
      528     7523    2         OPEN$USERS_FPT = OPEN_USERS_FPT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:23   
      529     7524    2         OPEN$USERS_FPT.NAME_ = VECTOR(HLP_NAME);
      530     7525    2         GOTO OPEN_IT;
      531     7526
      532     7527    2   OPEN_STAR_S:
      533     7528    2         ENTRY     ALTRET ;
      534     7529                                                              /**/
      535     7530    2         OPEN$USERS_FPT = OPEN_USERS_FPT ;
      536     7531    2         OPEN$USERS_FPT.NAME_ = VECTOR(STAR_S_NAME);
      537     7532
      538     7533    2   OPEN_IT: ;
      539     7534
      540     7535    2         FPT$GETUSERS = FPT_GETUSERS ;
      541     7536    2         ADDR(FPT$GETUSERS) -> VEC.P$ = ADDR(FPT$GETUSERS.V) ;
      542     7537    2         FPT$GETUSERS.DCBNUM_ = VECTOR(AL_DCB1#);
      543     7538    2         CALL M$GETDCB( FPT$GETUSERS ) ALTRET( NODCB ) ;
      544     7539                                                              /**/
      545     7540    2         OPEN$USERS_FPT.V.DCB# = AL_DCB1# ;
      546     7541    2         ADDR(OPEN$USERS_FPT) -> VEC.P$ = ADDR(OPEN$USERS_FPT.V) ;
      547     7542    2         SAVEPRIV = B$JIT.PRIV.ACTIVE;
      548     7543    2         B$JIT.PRIV.ACTIVE = B$JIT.PRIV.ACTIVE | %(PR_FMSEC#|PR_FMBLK#);
      549     7544    2         CALL M$OPEN (OPEN$USERS_FPT) ALTRET(OPEN_ERR) ;
      550     7545    2         B$JIT.PRIV.ACTIVE = SAVEPRIV;
      551     7546    2         RETURN ;
      552     7547    2   OPEN_ERR: ;
      553     7548    2         B$JIT.PRIV.ACTIVE = SAVEPRIV;
      554     7549    2         GOTO CLOSE_ERR;
      555     7550    2   NODCB: ;
      556     7551    2         CALL M$XXX;
      557     7552                                                              /**/
      558     7553    2   WRITE_STAR_S:
      559     7554    2         ENTRY ALTRET ;
      560     7555    2         WRITE$USERS_FPT = WRITE_USERS_FPT ;
      561     7556    2         WRITE$USERS_FPT.BUF_ = VECTOR(CP_LIMREC);
      562     7557    2         WRITE$USERS_FPT.KEY_ = VECTOR(LIMIT_KEY);
      563     7558    2         GOTO WRITE_IT;
      564     7559
      565     7560    2   WRITE_USERS:
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:24   
      566     7561    2         ENTRY ALTRET ;
      567     7562    2         WRITE$USERS_FPT = WRITE_USERS_FPT ;
      568     7563    2         WRITE$USERS_FPT.BUF_ = VECTOR(AS_USERS);
      569     7564    2         WRITE$USERS_FPT.KEY_ = VECTOR(FPT);
      570     7565
      571     7566    2   WRITE_IT: ;
      572     7567    2         ADDR(WRITE$USERS_FPT) -> VEC.P$ = ADDR(WRITE$USERS_FPT.V) ;
      573     7568    2         WRITE$USERS_FPT.V.DCB# = AL_DCB1# ;
      574     7569    2         CALL M$WRITE (WRITE$USERS_FPT) ALTRET(WRITE_ERR) ;
      575     7570    2         RETURN ;
      576     7571    2   WRITE_ERR:
      577     7572    2         ALTRETURN ;
      578     7573                                                              /**/
      579     7574    2   CLOSE_USERS:
      580     7575    2         ENTRY     ALTRET ;
      581     7576    2         CLOSE$USERS_FPT = CLOSE_USERS_FPT ;
      582     7577    2         CLOSE$USERS_FPT.V.DCB# = AL_DCB1# ;
      583     7578    2         ADDR(CLOSE$USERS_FPT) -> VEC.P$ = ADDR( CLOSE$USERS_FPT.V ) ;
      584     7579    2         CALL M$CLOSE (CLOSE$USERS_FPT) ALTRET (CLOSE_ERR) ;
      585     7580                                                              /**/
      586     7581    2   CLOSE_ERR: ;
      587     7582    2         FPT$RELUSERS = FPT_RELUSERS ;
      588     7583    2         FPT$RELUSERS.V.DCB# = AL_DCB1# ;
      589     7584    2         ADDR(FPT$RELUSERS) -> VEC.P$ = ADDR( FPT$RELUSERS.V ) ;
      590     7585    2         CALL M$RELDCB( FPT$RELUSERS ) ALTRET( NODCB2 ) ;
      591     7586    2   NODCB2: ALTRETURN ;  /* In case call to OPEN - CLOSE callers never care */
      592     7587                                                              /**/
      593     7588    2   END   READ_USERS ;
      594     7589
      595     7590    1   GETTIME: PROC (TIME) ALTRET;
      596     7591
      597     7592    2   DCL TIME UBIN;
      598     7593
      599     7594              %FPT_TIME ( FPTN = FPT_TIME ,
      600     7595                          STCLASS = CONSTANT ) ;
      601     7614              %FPT_TIME ( FPTN = FPT$TIME ,
      602     7615                          STCLASS = AUTO ) ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:25   
      603     7634        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:26   
      604     7635        /*********************************************************************/
      605     7636        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      606     7637        /*********************************************************************/
      607     7638                                                              /**/
      608     7639    2         FPT$TIME = FPT_TIME ;
      609     7640    2         FPT$TIME.TSTAMP_ = VECTOR( TIME ) ;
      610     7641    2         FPT$TIME.V_    = VECTOR( FPT$TIME.V     ) ;
      611     7642                                                              /*   GET THE TIME.   */
      612     7643    2         CALL M$TIME( FPT$TIME )  ALTRET( TIME_ERR ) ;
      613     7644                                                              /**/
      614     7645    2   TIME_ERR: ;
      615     7646    2         RETURN ;
      616     7647                                                              /**/
      617     7648    2   END   GETTIME ;
      618     7649    1   END XSL$CHAM;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:27   
--  Include file information  --

   EL_SUBS_C.:LIBRARY  is referenced.
   XSL_CHAM_M.:TCA2TOU  is referenced.
   ES_TABLES_M.:LIBRARY  is referenced.
   ES_SUBS_E.:LIBRARY  is referenced.
   CP_MACROS_C.:LIBRARY  is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$TABLES_C.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   KL_SUPER_C.:LIBRARY  is referenced.
   AS_SUPER_C.:LIBRARY  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure XSL$CHAM.

   Procedure XSL$CHAM requires 720 words for executable code.
   Procedure XSL$CHAM requires 172 words of local(AUTO) storage.

    No errors detected in file XSL$CHAM.:TCA2TSI    .

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:28   

 Object Unit name= XSL$CHAM                                   File name= XSL$CHAM.:TCA2TOU
 UTS= NOV 16 '97 14:27:35.76 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    190    276  XSL$CHAM
    2   Proc  even  none   720   1320  XSL$CHAM
    3  RoData even  none    16     20  XSL$CHAM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  XSL$CHAM
     2      3          yes     yes      Std        2  SET_USER_ID

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     32  FILE_ACCT
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:29   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
         yes           Std       1 ASZ$SCRAMBLE
 yes     yes    yes    Std       2 AZA$LOGOFF
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    B$JIT$                                M$UC                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:30   


        1        1        /*M* XSL$CHAM logon as a different user.           */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,PLM=6,IND=4,SDI=2,CTI=8,DCI=4,CSU=2,ECU=2,ENI=4,
        8        8              THI=0,DTI=0,IAD=0                              */
        9        9                                                              /**/
       10       10        XSL$CHAM: PROC(FPT, BUF) ALTRET;

     10  2 000000   000000 700200 xent  XSL$CHAM     TSX0  ! X66_AUTO_2
         2 000001   000254 000002                    ZERO    172,2
         2 000002   000005 710000 2                  TRA     s:6051

       11       11                                                              /**/
       12       12        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:31   
       13       13        /*********************************************************************/
       14       14        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       15       15        /*********************************************************************/
       16       16                                                              /**/
       17       17              %INCLUDE AS_SUPER_C ;
       18      452              %INCLUDE KL_SUPER_C ;
       19     3354              %INCLUDE B$JIT ;
       20     3644    1   DCL B$JIT$ PTR SYMREF READONLY;
       21     3645              %INCLUDE B$TABLES_C;
       22     3753              %INCLUDE CP_6 ;
       23     3834              %INCLUDE CP_6_SUBS ;
       24     4374              %INCLUDE CP_MACROS_C;
       25     5126              %INCLUDE ES_SUBS_E;
       26     5152              %INCLUDE ES_TABLES_M;
       27     5546        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:32   
       28     5547        /*********************************************************************/
       29     5548        /*   PARAMETER       PARAMETER       PARAMETER       PARAMETER       */
       30     5549        /*********************************************************************/
       31     5550              %INCLUDE XSL_CHAM_M;
       32     5575        %XSL_CHAM (NAME=FPT, STCLASS=PARAM);
       33     5591
       34     5592    1   DCL BUF CHAR(FPT.L);
       35     5593        %AS_USERS (STR_NAME = AS_USERS REDEF BUF, STCLASS =) ;
       36     5771        %KL_DREC (NAME=AS_HLP REDEF BUF, STCLASS=, LAST=";");
       37     5884        %CP_LIMREC (NAME=CP_LIMREC REDEF BUF, STCLASS=);
       38     5922
       39     5923        /*********************************************************************/
       40     5924        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
       41     5925        /*********************************************************************/
       42     5926                                                              /**/
       43     5927                                                              /*   :USERS RECORD.   */
       44     5928    1   DCL ARS UBIN ;
       45     5929    1   DCL DCB$ PTR ;
       46     5930    1   DCL KEY$ PTR ;
       47     5931    1   DCL I UBIN ;
       48     5932    1   DCL UMAX SBIN ;                                 /*   MAXIMUM CHARGES.   */
       49     5933    1   DCL UACCUM UBIN ;                               /*   ACCUMULATED CHARGES.   */
       50     5934    1   DCL UBKACC BIT(1) ;                             /*   BANKRUPTCY ACCESS.   */
       51     5935    1   DCL TEMP_BIT BIT (1) ALIGNED;
       52     5936    1   DCL LOGRSN SBIN;
       53     5937    1   DCL PLAINPW CHAR(8);
       54     5938    1   DCL RE_BUDGET SBIN ;
       55     5939    1   DCL MODE UBIN WORD ;
       56     5940    1   DCL AL_DCB1# SBIN;
       57     5941              %F$DCB( DCBN = F$DCB ) ;
       58     5998    1   DCL 1 ERR_CODE AUTO ,
       59     5999    1         2 FCG_MID UBIN(18) UNAL ,
       60     6000    1         2 CODE UBIN(15) UNAL ,
       61     6001    1         2 SEV UBIN(3) UNAL ;
       62     6002        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:33   
       63     6003        /*********************************************************************/
       64     6004        /*   ENTRIES         ENTRIES         ENTRIES         ENTRIES         */
       65     6005        /*********************************************************************/
       66     6006                                                              /**/
       67     6007    1   DCL ASZ$SCRAMBLE ENTRY(1);
       68     6008    1   DCL AZA$LOGOFF ENTRY(2) ALTRET OPTIONAL;
       69     6009        /*********************************************************************/
       70     6010        /*   FPTS            FPTS            FPTS            FPTS            */
       71     6011        /*********************************************************************/
       72     6012                                                              /**/
       73     6013              %FPT_YC( FPTN=RESET_BANNER ,
       74     6014                       STCLASS=CONSTANT ,
       75     6015                       NOERR = YES,
       76     6016                       CMD = LET_BANNER_RESET );
       77     6033                                                              /**/
       78     6034    1   DCL LET_BANNER_RESET CONSTANT CHAR(0) INIT('LET BANNER RESET');
       79     6035        /*********************************************************************/
       80     6036        /*   SYS DEFAULTS    SYS DEFAULTS    SYS DEFAULTS    SYS DEFAULTS    */
       81     6037        /*********************************************************************/
       82     6038                                                              /**/
       83     6039    1   DCL SYS_UMAX SBIN WORD CONSTANT INIT(50000) ;
       84     6040                                                              /**/
       85     6041    1   DCL SCRAMBLED_BITS(0:1) CONSTANT BIT(36)
       86     6042    1     INIT ('615502466037'O, '060222751600'O);
       87     6043    1   DCL SCRAMBLED_BLANKS REDEF SCRAMBLED_BITS CHAR(8);
       88     6044        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:34   
       89     6045        /*********************************************************************/
       90     6046        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
       91     6047        /*********************************************************************/
       92     6048                                                              /**/
       93     6049    1   SET_USER_ID: ENTRY(FPT, BUF) ALTRET;

   6049  2 000003   000000 700200 xent  SET_USER_ID  TSX0  ! X66_AUTO_2
         2 000004   000254 000002                    ZERO    172,2

       94     6050                                                     /**/
       95     6051    1         FPT.RESPONSE = 2;

   6051  2 000005   000002 220003                    LDX0    2,DU
         2 000006   200003 470500                    LDP0    @FPT,,AUTO
         2 000007   000005 440100                    SXL0    5,,PR0

       96     6052    1         PLAINPW = ' scrmbld';

   6052  2 000010   000270 237000 1                  LDAQ    FPT_TIME+12
         2 000011   200016 757100                    STAQ    PLAINPW,,AUTO

       97     6053    2         IF NOT FPT.FLAGS.SCRAMBLED AND FPT.PSWB THEN DO;

   6053  2 000012   000005 236100                    LDQ     5,,PR0
         2 000013   000100 316003                    CANQ    64,DU
         2 000014   000036 601000 2                  TNZ     s:6058
         2 000015   000000 106500                    CMPC    fill='000'O
         2 000016   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         2 000017   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         2 000020   000036 600000 2                  TZE     s:6058

       98     6054    2             PLAINPW = FPT.PASS;

   6054  2 000021   040100 100500                    MLR     fill='040'O
         2 000022   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         2 000023   200016 000010                    ADSC9   PLAINPW,,AUTO            cn=0,n=8

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:35   
       99     6055    2             CALL ASZ$SCRAMBLE (FPT.PASS);

   6055  2 000024   200003 236100                    LDQ     @FPT,,AUTO
         2 000025   000006 036003                    ADLQ    6,DU
         2 000026   200252 756100                    STQ     SAVEPRIV+2,,AUTO
         2 000027   200252 630500                    EPPR0   SAVEPRIV+2,,AUTO
         2 000030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000031   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         2 000032   000000 011000                    NOP     0

      100     6056    2             FPT.FLAGS.SCRAMBLED = '1'B;

   6056  2 000033   200003 470500                    LDP0    @FPT,,AUTO
         2 000034   000100 236003                    LDQ     64,DU
         2 000035   000005 256100                    ORSQ    5,,PR0

      101     6057    2             END;

      102     6058    1         IF NOT B$JIT.PRIV.PRC.JIT OR FPT.L = 0 THEN ALTRETURN;

   6058  2 000036   000000 471400 xsym               LDP1    B$JIT$
         2 000037   100016 236100                    LDQ     14,,PR1
         2 000040   000040 316007                    CANQ    32,DL
         2 000041   000045 600000 2                  TZE     s:6058+7
         2 000042   000000 236100                    LDQ     0,,PR0
         2 000043   777000 316003                    CANQ    -512,DU
         2 000044   000046 601000 2                  TNZ     s:6059

   6058  2 000045   000000 702200 xent               TSX2  ! X66_AALT

      103     6059    1         MODE = B$JIT.MODE;

   6059  2 000046   100000 236100                    LDQ     0,,PR1
         2 000047   000040 772000                    QRL     32
         2 000050   200021 756100                    STQ     MODE,,AUTO

      104     6060    1         LOGRSN = %ES_NO_SUCH_USER#;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:36   

   6060  2 000051   000003 235007                    LDA     3,DL
         2 000052   200015 755100                    STA     LOGRSN,,AUTO

      105     6061
      106     6062                                                      /* READ IN A :USERS RECORD. */
      107     6063                                                   /* SET UP M$USERS DCB FOR READ. */
      108     6064    1         CALL OPEN_HLP ALTRET (OPEN_USERS_ERR);

   6064  2 000053   001121 701000 2                  TSX1    OPEN_HLP
         2 000054   000565 702000 2                  TSX2    READ_USERS_ERR

      109     6065    2         CALL READ_USERS (FPT) WHENRETURN DO;

   6065  2 000055   200003 236100                    LDQ     @FPT,,AUTO
         2 000056   200037 756100                    STQ     MASTER_ACCT+8,,AUTO
         2 000057   001046 701000 2                  TSX1    READ_USERS
         2 000060   000112 702000 2                  TSX2    s:6075

      110     6066    2             IF AS_HLP.ATYP ~= %KLAT_TS# THEN EXIT;

   6066  2 000061   200004 470500                    LDP0    @BUF,,AUTO
         2 000062   000000 236100                    LDQ     0,,PR0
         2 000063   777000 376003                    ANQ     -512,DU
         2 000064   001000 116003                    CMPQ    512,DU
         2 000065   000112 601000 2                  TNZ     s:6075

      111     6067    2             LOGRSN = %ES_LOG_ALL#;

   6067  2 000066   000001 235007                    LDA     1,DL
         2 000067   200015 755100                    STA     LOGRSN,,AUTO

      112     6068    3             IF FPT.FLAGS.CHECKPW THEN DO;

   6068  2 000070   200003 471500                    LDP1    @FPT,,AUTO
         2 000071   100005 236100                    LDQ     5,,PR1
         2 000072   000010 316003                    CANQ    8,DU
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:37   
         2 000073   000112 600000 2                  TZE     s:6075

      113     6069    3                 IF AS_HLP.PASSWORD = FPT.PASS THEN EXIT;

   6069  2 000074   040100 106500                    CMPC    fill='040'O
         2 000075   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         2 000076   100006 000010                    ADSC9   6,,PR1                   cn=0,n=8
         2 000077   000112 600000 2                  TZE     s:6075

      114     6070    3                 IF NOT FPT.PSWB AND AS_HLP.PASSWORD = SCRAMBLED_BLANKS THEN EXIT;

   6070  2 000100   000000 106500                    CMPC    fill='000'O
         2 000101   100006 000010                    ADSC9   6,,PR1                   cn=0,n=8
         2 000102   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         2 000103   000110 601000 2                  TNZ     s:6071
         2 000104   040000 106500                    CMPC    fill='040'O
         2 000105   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         2 000106   000015 000010 1                  ADSC9   SCRAMBLED_BITS           cn=0,n=8
         2 000107   000112 600000 2                  TZE     s:6075

      115     6071    3                 LOGRSN = %ES_BAD_PW#;

   6071  2 000110   000002 235007                    LDA     2,DL
         2 000111   200015 755100                    STA     LOGRSN,,AUTO

      116     6072    3                 END;

      117     6073    2             END;

      118     6074
      119     6075    1         CALL CLOSE_USERS;

   6075  2 000112   001245 701000 2                  TSX1    CLOSE_USERS
         2 000113   000000 011000                    NOP     0

      120     6076    2         IF LOGRSN ~= %ES_LOG_ALL# THEN DO;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:38   
   6076  2 000114   200015 235100                    LDA     LOGRSN,,AUTO
         2 000115   000001 115007                    CMPA    1,DL
         2 000116   000132 600000 2                  TZE     s:6082

      121     6077    2             IF FPT.PSWB OR FPT.FLAGS.BADPW THEN EXIT;

   6077  2 000117   200003 470500                    LDP0    @FPT,,AUTO
         2 000120   000000 106500                    CMPC    fill='000'O
         2 000121   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         2 000122   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         2 000123   000132 601000 2                  TNZ     s:6082
         2 000124   000005 236100                    LDQ     5,,PR0
         2 000125   000020 316003                    CANQ    16,DU
         2 000126   000132 601000 2                  TNZ     s:6082

      122     6078    2             FPT.RESPONSE = 1;

   6078  2 000127   000001 220003                    LDX0    1,DU
         2 000130   000005 440100                    SXL0    5,,PR0

      123     6079    2             ALTRETURN;

   6079  2 000131   000000 702200 xent               TSX2  ! X66_AALT

      124     6080    2             END;
      125     6081
      126     6082    2         IF LOGRSN ~= %ES_NO_SUCH_USER# THEN DO;

   6082  2 000132   000003 115007                    CMPA    3,DL
         2 000133   000142 600000 2                  TZE     s:6087

      127     6083    2             CALL OPEN_USERS ALTRET(OPEN_USERS_ERR);

   6083  2 000134   001114 701000 2                  TSX1    OPEN_USERS
         2 000135   000565 702000 2                  TSX2    READ_USERS_ERR

      128     6084    2             CALL READ_USERS (FPT) ALTRET(READ_USERS_ERR) ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:39   

   6084  2 000136   200003 236100                    LDQ     @FPT,,AUTO
         2 000137   200037 756100                    STQ     MASTER_ACCT+8,,AUTO
         2 000140   001046 701000 2                  TSX1    READ_USERS
         2 000141   000565 702000 2                  TSX2    READ_USERS_ERR

      129     6085    2             END;

      130     6086
      131     6087    2         IF LOGRSN = %ES_BAD_PW# THEN DO;

   6087  2 000142   200015 235100                    LDA     LOGRSN,,AUTO
         2 000143   000002 115007                    CMPA    2,DL
         2 000144   000155 601000 2                  TNZ     s:6092

      132     6088    2             AS_USERS.BAD_LOGON_CNT = AS_USERS.BAD_LOGON_CNT + 1;

   6088  2 000145   200004 470500                    LDP0    @BUF,,AUTO
         2 000146   000763 220100                    LDX0    499,,PR0
         2 000147   000001 621010                    EAX1    1,X0
         2 000150   000763 741100                    STX1    499,,PR0

      133     6089    2             CALL WRITE_USERS;

   6089  2 000151   001217 701000 2                  TSX1    WRITE_USERS
         2 000152   000000 011000                    NOP     0

      134     6090    2             CALL CLOSE_USERS;

   6090  2 000153   001245 701000 2                  TSX1    CLOSE_USERS
         2 000154   000000 011000                    NOP     0

      135     6091    2             END;

      136     6092    1         CALL SECLOG;

   6092  2 000155   000733 701000 2                  TSX1    SECLOG
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:40   
         2 000156   000000 011000                    NOP     0

      137     6093    2         IF LOGRSN ~= %ES_LOG_ALL# THEN DO;

   6093  2 000157   200015 235100                    LDA     LOGRSN,,AUTO
         2 000160   000001 115007                    CMPA    1,DL
         2 000161   000166 600000 2                  TZE     s:6098

      138     6094    2             FPT.RESPONSE = 2;

   6094  2 000162   000002 220003                    LDX0    2,DU
         2 000163   200003 470500                    LDP0    @FPT,,AUTO
         2 000164   000005 440100                    SXL0    5,,PR0

      139     6095    2             ALTRETURN;

   6095  2 000165   000000 702200 xent               TSX2  ! X66_AALT

      140     6096    2             END;
      141     6097
      142     6098    2         IF FPT.FLAGS.DO_ACCOUNTING THEN DO;

   6098  2 000166   200003 470500                    LDP0    @FPT,,AUTO
         2 000167   000005 236100                    LDQ     5,,PR0
         2 000170   000400 316003                    CANQ    256,DU
         2 000171   000201 600000 2                  TZE     s:6103

      143     6099    2             IF ENTADDR(AZA$LOGOFF) = ENTADDR(NIL) THEN ALTRETURN;

   6099  2 000172   000000 636000 xent               EAQ     AZA$LOGOFF
         2 000173   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 000174   000176 601000 2                  TNZ     s:6100

   6099  2 000175   000000 702200 xent               TSX2  ! X66_AALT

      144     6100    2             CALL AZA$LOGOFF;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:41   
   6100  2 000176   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000177   000000 701000 xent               TSX1    AZA$LOGOFF
         2 000200   000000 011000                    NOP     0

      145     6101    2             END;

      146     6102
      147     6103    1         FPT.RESPONSE = 0;                             /* EVERYTHING MATCHES. */

   6103  2 000201   000000 220003                    LDX0    0,DU
         2 000202   200003 470500                    LDP0    @FPT,,AUTO
         2 000203   000005 440100                    SXL0    5,,PR0

      148     6104
      149     6105    1         CALL BUDGET ALTRET(BUDGET_ERR) ;

   6105  2 000204   000573 701000 2                  TSX1    BUDGET
         2 000205   000565 702000 2                  TSX2    READ_USERS_ERR

      150     6106    1         IF NOT FPT.FLAGS.STUFF_JIT THEN RETURN;

   6106  2 000206   200003 470500                    LDP0    @FPT,,AUTO
         2 000207   000005 236100                    LDQ     5,,PR0
         2 000210   000200 316003                    CANQ    128,DU
         2 000211   000213 601000 2                  TNZ     USER_OK

   6106  2 000212   000000 702200 xent               TSX2  ! X66_ARET

   6106  2 000213                       USER_OK      null
      151     6107                                                              /*   RECORD EXISTS.  */
      152     6108                        /*                                    */
      153     6109                        /*      CHECK BUDGET.                 */
      154     6110                        /*                                    */
      155     6111    1   USER_OK: ;
      156     6112                                                              /**/
      157     6113
      158     6114    1         B$JIT.ACCN = FPT.ACCN;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:42   

   6114  2 000213   000000 471400 xsym               LDP1    B$JIT$
         2 000214   040100 100500                    MLR     fill='040'O
         2 000215   000000 200010                    ADSC9   0,,PR0                   cn=1,n=8
         2 000216   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

      159     6115    1         B$JIT.UNAME = FPT.USER;

   6115  2 000217   040100 100500                    MLR     fill='040'O
         2 000220   000002 200014                    ADSC9   2,,PR0                   cn=1,n=12
         2 000221   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12

      160     6116
      161     6117    1         B$JIT.PRIV.JOB = AS_USERS.PRIV(MODE-1) & %(~(PR_FMEFT#|PR_FMBLK#)) ;

   6117  2 000222   200004 473500                    LDP3    @BUF,,AUTO
         2 000223   200021 720100                    LXL0    MODE,,AUTO
         2 000224   300224 236110                    LDQ     148,X0,PR3
         2 000225   000272 376000 1                  ANQ     FPT_TIME+14
         2 000226   100015 756100                    STQ     13,,PR1

      162     6118                                                             /*  SHUT OFF EFT AND BLK */
      163     6119    1         B$JIT.PRIV.ACTIVE = B$JIT.PRIV.JOB;

   6119  2 000227   100013 756100                    STQ     11,,PR1

      164     6120    1         B$JIT.PRIV.AUTH = B$JIT.PRIV.JOB;

   6120  2 000230   100014 756100                    STQ     12,,PR1

      165     6121                                                              /* Set PROC. PRIV. */
      166     6122    1         B$JIT.PRIOB = AS_USERS.PRIOB(MODE-1) ;

   6122  2 000231   200021 235100                    LDA     MODE,,AUTO
         2 000232   000100 100505                    MLR     fill='000'O
         2 000233   300240 600001                    ADSC9   160,A,PR3                cn=3,n=1
         2 000234   100260 400001                    ADSC9   176,,PR1                 cn=2,n=1
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:43   

      167     6123    1         B$JIT.QUAN = AS_USERS.QUAN(MODE-1) * 1000;

   6123  2 000235   000001 735000                    ALS     1
         2 000236   000100 100505                    MLR     fill='000'O
         2 000237   300234 400002                    ADSC9   156,A,PR3                cn=2,n=2
         2 000240   200252 000004                    ADSC9   SAVEPRIV+2,,AUTO         cn=0,n=4
         2 000241   200252 236100                    LDQ     SAVEPRIV+2,,AUTO
         2 000242   000022 732000                    QRS     18
         2 000243   001750 402007                    MPY     1000,DL
         2 000244   000000 621006                    EAX1    0,QL
         2 000245   100260 741100                    STX1    176,,PR1

      168     6124    1         IF AS_USERS.MAXENQ(MODE-1)>0 THEN B$JIT.MAXENQ = AS_USERS.MAXENQ(MODE-1);

   6124  2 000246   200021 235100                    LDA     MODE,,AUTO
         2 000247   000001 735000                    ALS     1
         2 000250   000100 101505                    MRL     fill='000'O
         2 000251   300774 400002                    ADSC9   508,A,PR3                cn=2,n=2
         2 000252   200252 000004                    ADSC9   SAVEPRIV+2,,AUTO         cn=0,n=4
         2 000253   200252 236100                    LDQ     SAVEPRIV+2,,AUTO
         2 000254   000000 116003                    CMPQ    0,DU
         2 000255   000261 600000 2                  TZE     s:6128

   6124  2 000256   000100 100505                    MLR     fill='000'O
         2 000257   300774 400002                    ADSC9   508,A,PR3                cn=2,n=2
         2 000260   100363 000002                    ADSC9   243,,PR1                 cn=0,n=2

      169     6125                                                        /* Set misc. stuff. */
      170     6126                                                             /**/
      171     6127                                                      /* Set BLIND ACCOUNTING */
      172     6128    1         B$JIT.BLINDACCTNG = AS_USERS.BUDGET.BLINDACCTNG;

   6128  2 000261   300017 236100                    LDQ     15,,PR3
         2 000262   000005 772000                    QRL     5
         2 000263   100153 676100                    ERQ     107,,PR1
         2 000264   400000 376007                    ANQ     -131072,DL
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:44   
         2 000265   100153 656100                    ERSQ    107,,PR1

      173     6129                                                             /*  MOVE HOME PACK SET.  */
      174     6130    1         B$JIT.HPSN = AS_USERS.HPSN ;

   6130  2 000266   040100 100500                    MLR     fill='040'O
         2 000267   300123 000006                    ADSC9   83,,PR3                  cn=0,n=6
         2 000270   100234 000006                    ADSC9   156,,PR1                 cn=0,n=6

      175     6131    1         B$JIT.FPSN = ' ';

   6131  2 000271   040100 100400                    MLR     fill='040'O
         2 000272   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000273   100021 000006                    ADSC9   17,,PR1                  cn=0,n=6

      176     6132    1         B$JIT.FACCN = B$JIT.ACCN;

   6132  2 000274   040100 100500                    MLR     fill='040'O
         2 000275   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         2 000276   100006 000010                    ADSC9   6,,PR1                   cn=0,n=8

      177     6133        /*    CALL CPROC ; */
      178     6134    1         B$JIT.BILL = AS_USERS.BILL( MODE-1 ) ;

   6134  2 000277   200021 236100                    LDQ     MODE,,AUTO
         2 000300   000006 402007                    MPY     6,DL
         2 000301   040100 100506                    MLR     fill='040'O
         2 000302   300016 400006                    ADSC9   14,Q,PR3                 cn=2,n=6
         2 000303   100151 400006                    ADSC9   105,,PR1                 cn=2,n=6

      179     6135                                                              /* CHECK FOR LAST CPROC */
      180     6136    1         IF AS_USERS.LASTCPROC.NAME.CNT(MODE-1) > 0 THEN

   6136  2 000304   200021 235100                    LDA     MODE,,AUTO
         2 000305   000003 735000                    ALS     3
         2 000306   300155 236105                    LDQ     109,AL,PR3
         2 000307   777000 316003                    CANQ    -512,DU
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:45   
         2 000310   000314 600000 2                  TZE     s:6139

      181     6137    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_LASTCPEXISTS#;

   6137  2 000311   100143 236100                    LDQ     99,,PR1
         2 000312   000026 276000 xsym               ORQ     B_VECTNIL+22
         2 000313   100143 756100                    STQ     99,,PR1

      182     6138                                                     /* Set limits in the JIT         */
      183     6139    1         B$JIT.REMLO = AS_USERS.DLO(MODE-1);

   6139  2 000314   300041 235110                    LDA     33,X0,PR3
         2 000315   100361 755100                    STA     241,,PR1

      184     6140    1         IF (AS_USERS.MLO(MODE-1) = 0) /*IF LO=0 ->DONT ALLOW LO OUTPUT*/

   6140  2 000316   300035 235110                    LDA     29,X0,PR3
         2 000317   000323 601000 2                  TNZ     s:6142

      185     6141    1         THEN B$JIT.NOLOEVER = '1'B;

   6141  2 000320   000100 236003                    LDQ     64,DU
         2 000321   100325 256100                    ORSQ    213,,PR1
         2 000322   000325 710000 2                  TRA     s:6143

      186     6142    1         ELSE B$JIT.NOLOEVER = '0'B;

   6142  2 000323   000000 236000 3                  LDQ     0
         2 000324   100325 356100                    ANSQ    213,,PR1

      187     6143    1         B$JIT.REMDO = AS_USERS.DDO(MODE-1);

   6143  2 000325   300051 235110                    LDA     41,X0,PR3
         2 000326   100362 755100                    STA     242,,PR1

      188     6144    1         IF (AS_USERS.MDO(MODE-1) = 0) /*IF DO=0 ->DONT ALLOW DO OUTPUT*/

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:46   
   6144  2 000327   300045 235110                    LDA     37,X0,PR3
         2 000330   000334 601000 2                  TNZ     s:6146

      189     6145    1         THEN B$JIT.NODOEVER = '1'B;

   6145  2 000331   000040 236003                    LDQ     32,DU
         2 000332   100325 256100                    ORSQ    213,,PR1
         2 000333   000336 710000 2                  TRA     s:6147

      190     6146    1         ELSE B$JIT.NODOEVER = '0'B;

   6146  2 000334   000001 236000 3                  LDQ     1
         2 000335   100325 356100                    ANSQ    213,,PR1

      191     6147    1         B$JIT.REMCPO = AS_USERS.DPO(MODE-1);

   6147  2 000336   300061 235110                    LDA     49,X0,PR3
         2 000337   100360 755100                    STA     240,,PR1

      192     6148    1         IF (AS_USERS.MPO(MODE-1) = 0) /*IF PO=0 ->DONT ALLOW PO OUTPUT*/

   6148  2 000340   300055 235110                    LDA     45,X0,PR3
         2 000341   000345 601000 2                  TNZ     s:6150

      193     6149    1         THEN B$JIT.NOPOEVER = '1'B;

   6149  2 000342   000020 236003                    LDQ     16,DU
         2 000343   100325 256100                    ORSQ    213,,PR1
         2 000344   000347 710000 2                  TRA     s:6151

      194     6150    1         ELSE B$JIT.NOPOEVER = '0'B;

   6150  2 000345   000002 236000 3                  LDQ     2
         2 000346   100325 356100                    ANSQ    213,,PR1

      195     6151    1         B$JIT.MAXTMPDP = AS_USERS.DTDIS(MODE-1);

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:47   
   6151  2 000347   300101 235110                    LDA     65,X0,PR3
         2 000350   100241 755100                    STA     161,,PR1

      196     6152    1         B$JIT.FBUL = MAXIMUM( AS_USERS.DFPOOLS(MODE-1), 5 );

   6152  2 000351   200021 236100                    LDQ     MODE,,AUTO
         2 000352   000100 101506                    MRL     fill='000'O
         2 000353   300106 600001                    ADSC9   70,Q,PR3                 cn=3,n=1
         2 000354   200252 000004                    ADSC9   SAVEPRIV+2,,AUTO         cn=0,n=4
         2 000355   200252 236100                    LDQ     SAVEPRIV+2,,AUTO
         2 000356   000005 116007                    CMPQ    5,DL
         2 000357   000361 603000 2                  TRC     s:6152+8
         2 000360   000005 236007                    LDQ     5,DL
         2 000361   000000 622006                    EAX2    0,QL
         2 000362   100205 442100                    SXL2    133,,PR1

      197     6153    1         B$JIT.DEFEXP = AS_USERS.DEXP;

   6153  2 000363   300243 723100                    LXL3    163,,PR3
         2 000364   100221 743100                    STX3    145,,PR1

      198     6154    1         B$JIT.MAXEXP = AS_USERS.MEXP;

   6154  2 000365   300242 724100                    LXL4    162,,PR3
         2 000366   100221 444100                    SXL4    145,,PR1

      199     6155    1         B$JIT.PRDPRM = AS_USERS.DPDIS(MODE-1);

   6155  2 000367   300071 235110                    LDA     57,X0,PR3
         2 000370   100242 755100                    STA     162,,PR1

      200     6156    1         B$JIT.DEFPRI = AS_USERS.DMPRIO( MODE-1 ) ;

   6156  2 000371   200021 236100                    LDQ     MODE,,AUTO
         2 000372   000100 100506                    MLR     fill='000'O
         2 000373   300110 600001                    ADSC9   72,Q,PR3                 cn=3,n=1
         2 000374   100153 000001                    ADSC9   107,,PR1                 cn=0,n=1
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:48   

      201     6157    1         B$JIT.MAXPRI = AS_USERS.MMPRIO( MODE-1 ) ;

   6157  2 000375   000100 100506                    MLR     fill='000'O
         2 000376   300107 600001                    ADSC9   71,Q,PR3                 cn=3,n=1
         2 000377   100153 200001                    ADSC9   107,,PR1                 cn=1,n=1

      202     6158    1         B$JIT.LOCK = AS_USERS.KEY;

   6158  2 000400   000100 100500                    MLR     fill='000'O
         2 000401   300026 000010                    ADSC9   22,,PR3                  cn=0,n=8
         2 000402   100154 000010                    ADSC9   108,,PR1                 cn=0,n=8

      203     6159    1         IF AS_USERS.STEPACCNT

   6159  2 000403   300005 236100                    LDQ     5,,PR3
         2 000404   000400 316003                    CANQ    256,DU
         2 000405   000411 600000 2                  TZE     s:6163

      204     6160    1         THEN
      205     6161    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STEPACCT# ;

   6161  2 000406   100143 236100                    LDQ     99,,PR1
         2 000407   000273 276000 1                  ORQ     FPT_TIME+15
         2 000410   100143 756100                    STQ     99,,PR1

      206     6162                                                              /* SET *S ACCOUNTING */
      207     6163    1         IF AS_USERS.FLAGS.STARSACC THEN

   6163  2 000411   300244 236100                    LDQ     164,,PR3
         2 000412   010000 316003                    CANQ    4096,DU
         2 000413   000417 600000 2                  TZE     s:6165

      208     6164    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STARSACC# ;

   6164  2 000414   100143 236100                    LDQ     99,,PR1
         2 000415   000274 276000 1                  ORQ     FPT_TIME+16
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:49   
         2 000416   100143 756100                    STQ     99,,PR1

      209     6165    1         B$JIT.LANG = AS_USERS.NAT_LANG ;

   6165  2 000417   300005 236100                    LDQ     5,,PR3
         2 000420   000033 772000                    QRL     27
         2 000421   100145 552104                    STBQ    101,'04'O,PR1

      210     6166    1         B$JIT.OUTPRIO = AS_USERS.OUTPUTPRIO ;

   6166  2 000422   300035 236100                    LDQ     29,,PR3
         2 000423   000011 736000                    QLS     9
         2 000424   100022 552110                    STBQ    18,'10'O,PR1

      211     6167    1         B$JIT.MRT = AS_USERS.DTIME(MODE-1);

   6167  2 000425   300254 235110                    LDA     172,X0,PR3
         2 000426   100276 755100                    STA     190,,PR1

      212     6168        /* To do MEM without crashing the system, LOGON uses M$RACST.
      213     6169           We can't do that here, since we already have some allocated.
      214     6170           The equivalent of !ORES is needed, but that won't workin Batch,
      215     6171           so, just don't change the memory at all. */
      216     6172    1         AS_USERS.DMEM(MODE-1) = B$JIT.RESCORE;

   6172  2 000427   200021 236100                    LDQ     MODE,,AUTO
         2 000430   000001 736000                    QLS     1
         2 000431   000106 101500                    MRL     fill='000'O
         2 000432   100336 000004                    ADSC9   222,,PR1                 cn=0,n=4
         2 000433   300262 400002                    ADSC9   178,Q,PR3                cn=2,n=2

      217     6173    1         AS_USERS.MMEM(MODE-1) = B$JIT.RESCORE;

   6173  2 000434   000106 101500                    MRL     fill='000'O
         2 000435   100336 000004                    ADSC9   222,,PR1                 cn=0,n=4
         2 000436   300260 400002                    ADSC9   176,Q,PR3                cn=2,n=2

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:50   
      218     6174    1         B$JIT.MAXCORE = AS_USERS.DMEM(MODE-1);

   6174  2 000437   000100 100506                    MLR     fill='000'O
         2 000440   300262 400002                    ADSC9   178,Q,PR3                cn=2,n=2
         2 000441   100210 000002                    ADSC9   136,,PR1                 cn=0,n=2

      219     6175    1         B$JIT.RESCORE = B$JIT.MAXCORE ;

   6175  2 000442   100210 236100                    LDQ     136,,PR1
         2 000443   000022 772000                    QRL     18
         2 000444   100336 756100                    STQ     222,,PR1

      220     6176    2         DO CASE(AS_USERS.RESL.OMAX(0));

   6176  2 000445   300327 221100                    LDX1    215,,PR3
         2 000446   000002 101003                    CMPX1   2,DU
         2 000447   000451 602011 2                  TNC     s:6176+4,X1
         2 000450   000463 710000 2                  TRA     s:6182
         2 000451   000453 710000 2                  TRA     s:6178
         2 000452   000456 710000 2                  TRA     s:6180

      221     6177    2           CASE(0);

      222     6178    2             B$JIT.OLTA = '00'B;

   6178  2 000453   000003 236000 3                  LDQ     3
         2 000454   100333 356100                    ANSQ    219,,PR1
         2 000455   000465 710000 2                  TRA     s:6186

      223     6179    2           CASE(1);

      224     6180    2             B$JIT.OLTA = '10'B;

   6180  2 000456   100333 236100                    LDQ     219,,PR1
         2 000457   000003 376000 3                  ANQ     3
         2 000460   400000 276007                    ORQ     -131072,DL
         2 000461   100333 756100                    STQ     219,,PR1
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:51   
         2 000462   000465 710000 2                  TRA     s:6186

      225     6181    2           CASE(ELSE);

      226     6182    2             B$JIT.OLTA = '11'B;

   6182  2 000463   600000 236007                    LDQ     -65536,DL
         2 000464   100333 256100                    ORSQ    219,,PR1

      227     6183    2           END;

      228     6184                                                             /**/
      229     6185        /*    CALL CLRES; */
      230     6186    1         CALL GETTIME(B$JIT.LOGONTIME);

   6186  2 000465   000000 236000 xsym               LDQ     B$JIT$
         2 000466   000150 036003                    ADLQ    104,DU
         2 000467   200025 756100                    STQ     AL_DCB1#+3,,AUTO
         2 000470   001276 701000 2                  TSX1    GETTIME
         2 000471   000000 011000                    NOP     0

      231     6187    1         CALL SET_LAST_LOGON_TIME;

   6187  2 000472   001025 701000 2                  TSX1    SET_LAST_LOGON_TIME
         2 000473   000000 011000                    NOP     0

      232     6188    1         CALL WRITE_USERS ALTRET(READ_USERS_ERR);

   6188  2 000474   001217 701000 2                  TSX1    WRITE_USERS
         2 000475   000565 702000 2                  TSX2    READ_USERS_ERR

      233     6189    1         CALL CLOSE_USERS;

   6189  2 000476   001245 701000 2                  TSX1    CLOSE_USERS
         2 000477   000000 011000                    NOP     0

   6186  2 000500                       DO_STARS     null
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:52   
      234     6190
      235     6191                                                              /* SET UP LIMIT
      236     6192                                                                 RECORD FOR '*S' */
      237     6193    1   DO_STARS: ;
      238     6194    1         CALL OPEN_STAR_S ALTRET ( CLOSE_S_ERR ) ;

   6194  2 000500   001130 701000 2                  TSX1    OPEN_STAR_S
         2 000501   000564 702000 2                  TSX2    CLOSE_S_ERR

      239     6195    1         CP_LIMREC = '0'B ;

   6195  2 000502   200004 470500                    LDP0    @BUF,,AUTO
         2 000503   000100 100400                    MLR     fill='000'O
         2 000504   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000505   000000 000154                    ADSC9   0,,PR0                   cn=0,n=108

      240     6196    1         CP_LIMREC.USER_MAX.MAXCORE = AS_USERS.MMEM(MODE-1) ;

   6196  2 000506   200021 235100                    LDA     MODE,,AUTO
         2 000507   000001 735000                    ALS     1
         2 000510   000100 100505                    MLR     fill='000'O
         2 000511   000260 400002                    ADSC9   176,A,PR0                cn=2,n=2
         2 000512   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      241     6197    1         CP_LIMREC.CUR_MAX.MAXCORE = B$JIT.MAXCORE ;

   6197  2 000513   000000 471400 xsym               LDP1    B$JIT$
         2 000514   100210 220100                    LDX0    136,,PR1
         2 000515   000007 740100                    STX0    7,,PR0

      242     6198    1         CP_LIMREC.USER_MAX.REMLO = AS_USERS.MLO(MODE-1) ;

   6198  2 000516   200021 721100                    LXL1    MODE,,AUTO
         2 000517   000035 235111                    LDA     29,X1,PR0
         2 000520   000001 755100                    STA     1,,PR0

      243     6199    1         CP_LIMREC.CUR_MAX.REMLO = B$JIT.REMLO ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:53   

   6199  2 000521   100361 235100                    LDA     241,,PR1
         2 000522   000010 755100                    STA     8,,PR0

      244     6200    1         CP_LIMREC.USER_MAX.REMCPO = AS_USERS.MPO(MODE-1) ;

   6200  2 000523   000055 235111                    LDA     45,X1,PR0
         2 000524   000002 755100                    STA     2,,PR0

      245     6201    1         CP_LIMREC.CUR_MAX.REMCPO = B$JIT.REMCPO ;

   6201  2 000525   100360 235100                    LDA     240,,PR1
         2 000526   000011 755100                    STA     9,,PR0

      246     6202    1         CP_LIMREC.USER_MAX.REMDO = AS_USERS.MDO(MODE-1) ;

   6202  2 000527   000045 235111                    LDA     37,X1,PR0
         2 000530   000003 755100                    STA     3,,PR0

      247     6203    1         CP_LIMREC.CUR_MAX.REMDO = B$JIT.REMDO ;

   6203  2 000531   100362 235100                    LDA     242,,PR1
         2 000532   000012 755100                    STA     10,,PR0

      248     6204    1         CP_LIMREC.USER_MAX.MAXTMPDP = AS_USERS.MTDIS(MODE-1) ;

   6204  2 000533   000075 235111                    LDA     61,X1,PR0
         2 000534   000005 755100                    STA     5,,PR0

      249     6205    1         CP_LIMREC.CUR_MAX.MAXTMPDP = B$JIT.MAXTMPDP ;

   6205  2 000535   100241 235100                    LDA     161,,PR1
         2 000536   000014 755100                    STA     12,,PR0

      250     6206    1         CP_LIMREC.USER_MAX.PRDPRM = AS_USERS.MPDIS(MODE-1) ;

   6206  2 000537   000065 235111                    LDA     53,X1,PR0
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:54   
         2 000540   000004 755100                    STA     4,,PR0

      251     6207    1         CP_LIMREC.CUR_MAX.PRDPRM = B$JIT.PRDPRM ;

   6207  2 000541   100242 235100                    LDA     162,,PR1
         2 000542   000013 755100                    STA     11,,PR0

      252     6208    1         CP_LIMREC.USER_MAX.FBUL = AS_USERS.MFPOOLS(MODE-1) ;

   6208  2 000543   200021 236100                    LDQ     MODE,,AUTO
         2 000544   000100 101506                    MRL     fill='000'O
         2 000545   000105 600001                    ADSC9   69,Q,PR0                 cn=3,n=1
         2 000546   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2

      253     6209    1         CP_LIMREC.CUR_MAX.FBUL = B$JIT.FBUL ;

   6209  2 000547   100205 722100                    LXL2    133,,PR1
         2 000550   000007 442100                    SXL2    7,,PR0

      254     6210    1         CP_LIMREC.USER_MAX.MRT = B$JIT.MRT ;

   6210  2 000551   100276 235100                    LDA     190,,PR1
         2 000552   000006 755100                    STA     6,,PR0

      255     6211    1         CP_LIMREC.CUR_MAX.MRT = B$JIT.MRT ;

   6211  2 000553   100276 235100                    LDA     190,,PR1
         2 000554   000015 755100                    STA     13,,PR0

      256     6212
      257     6213                                                              /* OUTPUT RECORD */
      258     6214    1         CALL WRITE_STAR_S ALTRET( CLOSE_S_ERR ) ;

   6214  2 000555   001205 701000 2                  TSX1    WRITE_STAR_S
         2 000556   000564 702000 2                  TSX2    CLOSE_S_ERR

      259     6215                   /* Call the routine to put the bannertext record into
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:55   
      260     6216                      *S file.
      261     6217                   */
      262     6218    1         CALL M$YC( RESET_BANNER);

   6218  2 000557   000000 630400 1                  EPPR0   RESET_BANNER
         2 000560   000011 713400                    CLIMB   9
         2 000561   401000 401760                    pmme    nvectors=3

      263     6219                                                              /**/
      264     6220    1         CALL CLOSE_USERS ALTRET ( CLOSE_S_ERR ) ;

   6220  2 000562   001245 701000 2                  TSX1    CLOSE_USERS
         2 000563   000564 702000 2                  TSX2    CLOSE_S_ERR

   6211  2 000564                       CLOSE_S_ERR  null
      265     6221    1   CLOSE_S_ERR: ;
      266     6222    1         RETURN;

   6222  2 000564   000000 702200 xent               TSX2  ! X66_ARET

   6211  2 000565                       READ_USERS_* null
   6211  2 000565                       OPEN_USERS_* null
   6211  2 000565                       BUDGET_ERR   null
      267     6223                                                              /**/
      268     6224    1   READ_USERS_ERR: ;
      269     6225    1   OPEN_USERS_ERR: ;
      270     6226    1   BUDGET_ERR: ;
      271     6227                                                              /**/
      272     6228    1         CALL CLOSE_USERS;

   6228  2 000565   001245 701000 2                  TSX1    CLOSE_USERS
         2 000566   000000 011000                    NOP     0

      273     6229    1         FPT.RESPONSE = 2;

   6229  2 000567   000002 220003                    LDX0    2,DU
         2 000570   200003 470500                    LDP0    @FPT,,AUTO
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:56   
         2 000571   000005 440100                    SXL0    5,,PR0

      274     6230    1         ALTRETURN;

   6230  2 000572   000000 702200 xent               TSX2  ! X66_AALT

      275     6231                                                              /**/
      276     6232                                                              /**/
      277     6233                                                              /**/
      278     6234        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:57   
      279     6235    1   BUDGET: PROC ALTRET ;

   6235  2 000573   200024 741300       BUDGET       STX1  ! AL_DCB1#+2,,AUTO

      280     6236                                                              /**/
      281     6237                    /*******************************/
      282     6238                    /*                             */
      283     6239                    /*          BUDGET             */
      284     6240                    /*                             */
      285     6241                    /*******************************/
      286     6242        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:58   
      287     6243        /*********************************************************************/
      288     6244        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      289     6245        /*********************************************************************/
      290     6246                                                              /**/
      291     6247                                                              /*   :USERS RECORD.   */
      292     6248    2   DCL TEMP SBIN ;
      293     6249    2   DCL BUDLIM BIT(1) ;
      294     6250    2   DCL MASTER_ACCT(0:20) CHAR(1);
      295     6251    2   DCL MASTER_ACCN REDEF MASTER_ACCT CHAR(21);
      296     6252        %VLP_NAME (FPTN=NONE_NAME, NAME='NONE', STCLASS=CONSTANT);
      297     6279    2   DCL NO_MACCOUNT REDEF NONE_NAME CHAR(5);
      298     6280        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:59   
      299     6281        /*********************************************************************/
      300     6282        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      301     6283        /*********************************************************************/
      302     6284                                                              /**/
      303     6285    2         B$JIT.BUDLIM = 0;

   6285  2 000574   000000 470400 xsym               LDP0    B$JIT$
         2 000575   000147 450100                    STZ     103,,PR0

      304     6286    2         UMAX = BITBIN('377777777777'O);

   6286  2 000576   000031 235000 xsym               LDA     B_VECTNIL+25
         2 000577   200011 755100                    STA     UMAX,,AUTO

      305     6287    2         BUDLIM = AS_USERS.BUDGET.BUDLIM;

   6287  2 000600   200004 471500                    LDP1    @BUF,,AUTO
         2 000601   100017 236100                    LDQ     15,,PR1
         2 000602   000012 736000                    QLS     10
         2 000603   400000 376003                    ANQ     -131072,DU
         2 000604   200026 756100                    STQ     BUDLIM,,AUTO

      306     6288    2         IF AS_USERS.BUDGET.ICHARGES  AND  AS_USERS.BUDGET.MAXC > -1

   6288  2 000605   100017 236100                    LDQ     15,,PR1
         2 000606   000040 316003                    CANQ    32,DU
         2 000607   000636 600000 2                  TZE     s:6301
         2 000610   100006 235100                    LDA     6,,PR1
         2 000611   000636 604000 2                  TMI     s:6301

      307     6289    3         THEN DO;

      308     6290    3             TEMP = AS_USERS.BUDGET.MAXC - AS_USERS.BUDGET.ACCUM;

   6290  2 000612   100006 236100                    LDQ     6,,PR1
         2 000613   100007 136100                    SBLQ    7,,PR1
         2 000614   200025 756100                    STQ     TEMP,,AUTO
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:60   

      309     6291    3             IF NOT AS_USERS.BUDGET.BKACC  AND  TEMP <= 0

   6291  2 000615   100017 236100                    LDQ     15,,PR1
         2 000616   000400 316003                    CANQ    256,DU
         2 000617   000627 601000 2                  TNZ     s:6296
         2 000620   200025 235100                    LDA     TEMP,,AUTO
         2 000621   000627 605400 2                  TPNZ    s:6296

      310     6292    4             THEN DO;

      311     6293    4                 FPT.RESPONSE = 3;

   6293  2 000622   000003 220003                    LDX0    3,DU
         2 000623   200003 473500                    LDP3    @FPT,,AUTO
         2 000624   300005 440100                    SXL0    5,,PR3

      312     6294    4                 ALTRETURN;

   6294  2 000625   200024 221300                    LDX1  ! AL_DCB1#+2,,AUTO
         2 000626   000000 702211                    TSX2  ! 0,X1

      313     6295    4                 END;
      314     6296    3             IF BUDLIM THEN UMAX = MINIMUM( UMAX, TEMP );

   6296  2 000627   200026 234100                    SZN     BUDLIM,,AUTO
         2 000630   000636 605000 2                  TPL     s:6301

   6296  2 000631   200025 236100                    LDQ     TEMP,,AUTO
         2 000632   200011 116100                    CMPQ    UMAX,,AUTO
         2 000633   000635 604400 2                  TMOZ    s:6296+6
         2 000634   200011 236100                    LDQ     UMAX,,AUTO
         2 000635   200011 756100                    STQ     UMAX,,AUTO

      315     6297    3             END;

      316     6298                                                      /*
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:61   
      317     6299                                                         Do any project accounting
      318     6300                                                      */
      319     6301    2         MASTER_ACCT = AS_USERS.BUDGET.MACCT;

   6301  2 000636   000100 100500                    MLR     fill='000'O
         2 000637   100012 000025                    ADSC9   10,,PR1                  cn=0,n=21
         2 000640   200027 000025                    ADSC9   MASTER_ACCT,,AUTO        cn=0,n=21

      320     6302    3         DO WHILE( AS_USERS.BUDGET.PCHARGES  AND  MASTER_ACCN ~= NO_MACCOUNT );

   6302  2 000641   000700 710000 2                  TRA     s:6313

      321     6303    3             CALL READ_USERS( MASTER_ACCT ) ALTRET(READ_USERS_ERR);

   6303  2 000642   200027 630500                    EPPR0   MASTER_ACCT,,AUTO
         2 000643   200037 450500                    STP0    MASTER_ACCT+8,,AUTO
         2 000644   001046 701000 2                  TSX1    READ_USERS
         2 000645   000726 702000 2                  TSX2    READ_USERS_ERR

      322     6304    4             IF AS_USERS.BUDGET.PMAXC > -1 THEN DO;

   6304  2 000646   200004 470500                    LDP0    @BUF,,AUTO
         2 000647   000010 235100                    LDA     8,,PR0
         2 000650   000675 604000 2                  TMI     s:6312

      323     6305    4                 TEMP = AS_USERS.BUDGET.PMAXC - AS_USERS.BUDGET.PACCUM;

   6305  2 000651   000010 236100                    LDQ     8,,PR0
         2 000652   000011 136100                    SBLQ    9,,PR0
         2 000653   200025 756100                    STQ     TEMP,,AUTO

      324     6306    5                 IF NOT AS_USERS.BUDGET.BKACC AND TEMP <= 0 THEN DO;

   6306  2 000654   000017 236100                    LDQ     15,,PR0
         2 000655   000400 316003                    CANQ    256,DU
         2 000656   000666 601000 2                  TNZ     s:6310
         2 000657   200025 235100                    LDA     TEMP,,AUTO
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:62   
         2 000660   000666 605400 2                  TPNZ    s:6310

      325     6307    5                     FPT.RESPONSE = 3;

   6307  2 000661   000003 220003                    LDX0    3,DU
         2 000662   200003 471500                    LDP1    @FPT,,AUTO
         2 000663   100005 440100                    SXL0    5,,PR1

      326     6308    5                     ALTRETURN;

   6308  2 000664   200024 221300                    LDX1  ! AL_DCB1#+2,,AUTO
         2 000665   000000 702211                    TSX2  ! 0,X1

      327     6309    5                     END;
      328     6310    4                 IF BUDLIM THEN UMAX = MINIMUM( UMAX, TEMP );

   6310  2 000666   200026 234100                    SZN     BUDLIM,,AUTO
         2 000667   000675 605000 2                  TPL     s:6312

   6310  2 000670   200025 236100                    LDQ     TEMP,,AUTO
         2 000671   200011 116100                    CMPQ    UMAX,,AUTO
         2 000672   000674 604400 2                  TMOZ    s:6310+6
         2 000673   200011 236100                    LDQ     UMAX,,AUTO
         2 000674   200011 756100                    STQ     UMAX,,AUTO

      329     6311    4                 END;

      330     6312    3             MASTER_ACCT = AS_USERS.BUDGET.MACCT;

   6312  2 000675   000100 100500                    MLR     fill='000'O
         2 000676   000012 000025                    ADSC9   10,,PR0                  cn=0,n=21
         2 000677   200027 000025                    ADSC9   MASTER_ACCT,,AUTO        cn=0,n=21

      331     6313    3             END;

   6313  2 000700   200004 470500                    LDP0    @BUF,,AUTO
         2 000701   000017 236100                    LDQ     15,,PR0
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:63   
         2 000702   000100 316003                    CANQ    64,DU
         2 000703   000710 600000 2                  TZE     s:6314
         2 000704   040000 106500                    CMPC    fill='040'O
         2 000705   200027 000025                    ADSC9   MASTER_ACCT,,AUTO        cn=0,n=21
         2 000706   000017 000005 1                  ADSC9   NONE_NAME                cn=0,n=5
         2 000707   000642 601000 2                  TNZ     s:6303

      332     6314    2         IF BUDLIM THEN B$JIT.BUDLIM = MAXIMUM( 1, UMAX );

   6314  2 000710   200026 234100                    SZN     BUDLIM,,AUTO
         2 000711   000720 605000 2                  TPL     s:6315

   6314  2 000712   200011 236100                    LDQ     UMAX,,AUTO
         2 000713   000001 116007                    CMPQ    1,DL
         2 000714   000716 605000 2                  TPL     s:6314+6
         2 000715   000001 236007                    LDQ     1,DL
         2 000716   000000 471400 xsym               LDP1    B$JIT$
         2 000717   100147 756100                    STQ     103,,PR1

      333     6315    2         CALL REREAD_USERS (FPT) ALTRET(READ_USERS_ERR);

   6315  2 000720   200003 236100                    LDQ     @FPT,,AUTO
         2 000721   200037 756100                    STQ     MASTER_ACCT+8,,AUTO
         2 000722   001066 701000 2                  TSX1    REREAD_USERS
         2 000723   000726 702000 2                  TSX2    READ_USERS_ERR

      334     6316    2         RETURN;

   6316  2 000724   200024 221300                    LDX1  ! AL_DCB1#+2,,AUTO
         2 000725   000001 702211                    TSX2  ! 1,X1

      335     6317
      336     6318    2   READ_USERS_ERR:
      337     6319                                                              /**/
      338     6320                                                              /**/
      339     6321    2         FPT.RESPONSE = 3;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:64   
   6321  2 000726   000003 220003       READ_USERS_* LDX0    3,DU
         2 000727   200003 470500                    LDP0    @FPT,,AUTO
         2 000730   000005 440100                    SXL0    5,,PR0

      340     6322    2         ALTRETURN ;

   6322  2 000731   200024 221300                    LDX1  ! AL_DCB1#+2,,AUTO
         2 000732   000000 702211                    TSX2  ! 0,X1

      341     6323    2   END   BUDGET ;
      342     6324        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:65   
      343     6325                                                              /**/
      344     6326    1   SECLOG: PROC;

   6326  2 000733   200024 741300       SECLOG       STX1  ! AL_DCB1#+2,,AUTO

      345     6327                                                              /**/
      346     6328        /* Log a logon attempt, of whatever outcome */
      347     6329        %INCLUDE EL_SUBS_C;
      348     6413        %ES$SECLOG (NAME=ES$SECLOG,STCLASS=AUTO);
      349     6690        %FPT_WRSYSLOG (FPTN=CWRSYSLOG, SIZE="SIZEW(ES$SECLOG)", TYPE=EL_SYS_ACCESS,
      350     6691              FILENUM=EL_SEC, STCLASS=CONSTANT);
      351     6706        %FPT_WRSYSLOG (STCLASS=AUTO);
      352     6721    2   DCL SAVEPRIV BIT(36);
      353     6722
      354     6723    2         ES$SECLOG = '0'B;

   6723  2 000734   000100 100400                    MLR     fill='000'O
         2 000735   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000736   200025 000304                    ADSC9   ES$SECLOG,,AUTO          cn=0,n=196

      355     6724    2         ES$SECLOG.MODE = MODE;

   6724  2 000737   200021 236100                    LDQ     MODE,,AUTO
         2 000740   000040 736000                    QLS     32
         2 000741   200026 676100                    ERQ     BUDLIM,,AUTO
         2 000742   740000 376003                    ANQ     -16384,DU
         2 000743   200026 656100                    ERSQ    BUDLIM,,AUTO

      356     6725    2         ES$SECLOG.SYSID = B$JIT.SYSID;

   6725  2 000744   000000 470400 xsym               LDP0    B$JIT$
         2 000745   000000 720100                    LXL0    0,,PR0
         2 000746   200026 440100                    SXL0    BUDLIM,,AUTO

      357     6726    2         ES$SECLOG.USER = B$JIT.USER;

   6726  2 000747   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:66   
         2 000750   200026 552120                    STBQ    BUDLIM,'20'O,AUTO

      358     6727    2         ES$SECLOG.ACCN = FPT.ACCN;

   6727  2 000751   200003 471500                    LDP1    @FPT,,AUTO
         2 000752   040100 100500                    MLR     fill='040'O
         2 000753   100000 200010                    ADSC9   0,,PR1                   cn=1,n=8
         2 000754   200027 000010                    ADSC9   MASTER_ACCT,,AUTO        cn=0,n=8

      359     6728    2         ES$SECLOG.UNAME = FPT.USER;

   6728  2 000755   040100 100500                    MLR     fill='040'O
         2 000756   100002 200014                    ADSC9   2,,PR1                   cn=1,n=12
         2 000757   200031 000014                    ADSC9   MASTER_ACCT+2,,AUTO      cn=0,n=12

      360     6729    2         ES$SECLOG.REASON = LOGRSN;

   6729  2 000760   200015 236100                    LDQ     LOGRSN,,AUTO
         2 000761   000033 736000                    QLS     27
         2 000762   200025 552140                    STBQ    ES$SECLOG,'40'O,AUTO

      361     6730    2         IF LOGRSN = %ES_LOG_ALL# THEN ES$SECLOG.GRANTED = '1'B;

   6730  2 000763   200015 235100                    LDA     LOGRSN,,AUTO
         2 000764   000001 115007                    CMPA    1,DL
         2 000765   000770 601000 2                  TNZ     s:6731

   6730  2 000766   000400 236003                    LDQ     256,DU
         2 000767   200025 256100                    ORSQ    ES$SECLOG,,AUTO

      362     6731    3         IF LOGRSN = %ES_BAD_PW# THEN DO;

   6731  2 000770   000002 115007                    CMPA    2,DL
         2 000771   001001 601000 2                  TNZ     s:6737

      363     6732    3             ES$SECLOG.PASSWORD = PLAINPW;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:67   
   6732  2 000772   200016 237100                    LDAQ    PLAINPW,,AUTO
         2 000773   200034 757100                    STAQ    MASTER_ACCT+5,,AUTO

      364     6733    3             ES$SECLOG.PRIV = AS_USERS.PRIV(%M_INT#-1);

   6733  2 000774   200004 473500                    LDP3    @BUF,,AUTO
         2 000775   300227 236100                    LDQ     151,,PR3
         2 000776   200041 756100                    STQ     OPEN$USERS_FPT+1,,AUTO

      365     6734    3             ES$SECLOG.PPRIV = AS_USERS.PPRIV(%M_INT#-1);

   6734  2 000777   300233 236100                    LDQ     155,,PR3
         2 001000   200042 756100                    STQ     OPEN$USERS_FPT+2,,AUTO

      366     6735    3             END;

      367     6736
      368     6737    2         FPT_WRSYSLOG = CWRSYSLOG;

   6737  2 001001   000100 100400                    MLR     fill='000'O
         2 001002   000022 000040 1                  ADSC9   CWRSYSLOG                cn=0,n=32
         2 001003   200106 000040                    ADSC9   FPT_WRSYSLOG,,AUTO       cn=0,n=32

      369     6738    2         FPT_WRSYSLOG.ENTRY_ = VECTOR (ES$SECLOG);

   6738  2 001004   000004 235000 3                  LDA     4
         2 001005   200252 452500                    STP2    SAVEPRIV+2,,AUTO
         2 001006   200252 236100                    LDQ     SAVEPRIV+2,,AUTO
         2 001007   000025 036003                    ADLQ    21,DU
         2 001010   200110 757100                    STAQ    FPT_WRSYSLOG+2,,AUTO

      370     6739    2         SAVEPRIV = B$JIT.PRIV.ACTIVE;

   6739  2 001011   000013 236100                    LDQ     11,,PR0
         2 001012   200116 756100                    STQ     SAVEPRIV,,AUTO

      371     6740    2         B$JIT.PRIV.ACTIVE.SYSLOG = '1'B;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:68   

   6740  2 001013   100000 236007                    LDQ     32768,DL
         2 001014   000013 256100                    ORSQ    11,,PR0

      372     6741    2         CALL M$WRSYSLOG (FPT_WRSYSLOG);

   6741  2 001015   200106 630500                    EPPR0   FPT_WRSYSLOG,,AUTO
         2 001016   070001 713400                    CLIMB   28673
         2 001017   400400 401760                    pmme    nvectors=2

      373     6742    2         B$JIT.PRIV.ACTIVE = SAVEPRIV;

   6742  2 001020   200116 236100                    LDQ     SAVEPRIV,,AUTO
         2 001021   000000 470400 xsym               LDP0    B$JIT$
         2 001022   000013 756100                    STQ     11,,PR0

      374     6743    2         RETURN;

   6743  2 001023   200024 221300                    LDX1  ! AL_DCB1#+2,,AUTO
         2 001024   000001 702211                    TSX2  ! 1,X1

      375     6744    2   END SECLOG;
      376     6745        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:69   
      377     6746                                                              /**/
      378     6747    1   SET_LAST_LOGON_TIME: PROC;

   6747  2 001025   200024 741300       SET_LAST_LO* STX1  ! AL_DCB1#+2,,AUTO

      379     6748                                                              /**/
      380     6749        /* Set fields in :USERS record */
      381     6750    2         AS_USERS.LAST_LOGON_TIME = BINBIT(B$JIT.LOGONTIME,36);

   6750  2 001026   000000 470400 xsym               LDP0    B$JIT$
         2 001027   000150 236100                    LDQ     104,,PR0
         2 001030   200004 471500                    LDP1    @BUF,,AUTO
         2 001031   100762 756100                    STQ     498,,PR1

      382     6751    2         AS_USERS.BAD_LOGON_CNT = 0;

   6751  2 001032   000000 220003                    LDX0    0,DU
         2 001033   100763 740100                    STX0    499,,PR1

      383     6752    2         AS_USERS.LOGINS.LAST_LOGON_TIME(MODE-1) = B$JIT.LOGONTIME;

   6752  2 001034   200021 235100                    LDA     MODE,,AUTO
         2 001035   000001 735000                    ALS     1
         2 001036   000000 622005                    EAX2    0,AL
         2 001037   000150 235100                    LDA     104,,PR0
         2 001040   100762 755112                    STA     498,X2,PR1

      384     6753    2         AS_USERS.LOGINS.BAD_LOGON_CNT(MODE-1) = 0;

   6753  2 001041   200021 235100                    LDA     MODE,,AUTO
         2 001042   000001 735000                    ALS     1
         2 001043   100763 450105                    STZ     499,AL,PR1

      385     6754
      386     6755    2         RETURN;

   6755  2 001044   200024 221300                    LDX1  ! AL_DCB1#+2,,AUTO
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:70   
         2 001045   000001 702211                    TSX2  ! 1,X1

      387     6756
      388     6757    2   END   SET_LAST_LOGON_TIME;
      389     6758        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:71   
      390     6759    1   READ_USERS: PROC (USERS_KEY ) ALTRET ;

   6759  2 001046   200036 741300       READ_USERS   STX1  ! MASTER_ACCT+7,,AUTO

      391     6760                  /***********************************************************/
      392     6761                  /*                                                         */
      393     6762                  /*      NAME:     ALA$READ_USERS                           */
      394     6763                  /*                                                         */
      395     6764                  /*      CALL:     CALL ALA$READ_USERS (USERS_KEY, RW$USERS) */
      396     6765                  /*                                                         */
      397     6766                  /*      INPUT:    USERS_KEY  is the KEY to the :USERS      */
      398     6767                  /*                           record to be read.            */
      399     6768                  /*                RW$USERS   is the buffer to read the     */
      400     6769                  /*                           the USERS record into.        */
      401     6770                  /*                                                         */
      402     6771                  /*      OUTPUT:   Nothing is passed.                       */
      403     6772                  /*                                                         */
      404     6773                  /*      DESCRIPTION:  ALA$READ_USERS is the routine to     */
      405     6774                  /*                read a users record from :USERS.         */
      406     6775                  /*                                                         */
      407     6776                  /*      ENTRIES:                                           */
      408     6777                  /*                ALA$READ_USERS (USERS_KEY, RW$USERS)     */
      409     6778                  /*                ALA$OPEN_USERS                           */
      410     6779                  /*                ALA$CLOSE_USERS                          */
      411     6780                  /*                                                         */
      412     6781                  /***********************************************************/
      413     6782                                                                                      /**/
      414     6783        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:72   
      415     6784        /*********************************************************************/
      416     6785        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
      417     6786        /*********************************************************************/
      418     6787                                                                                      /**/
      419     6788    2   DCL 1 FILE_ACCT CONSTANT SYMDEF,
      420     6789    2         2 TEXT CHAR(8) INIT(':SYS') ;
      421     6790                                                                                      /**/
      422     6791        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:73   
      423     6792        /*********************************************************************/
      424     6793        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
      425     6794        /*********************************************************************/
      426     6795                                                                                      /**/
      427     6796    2   DCL 1 USERS_KEY ,
      428     6797    2         2 CNT UBIN(9) UNAL ,
      429     6798    2         2 TEXT CHAR(20) UNAL ;
      430     6799                                                                                      /**/
      431     6800        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:74   
      432     6801        /*********************************************************************/
      433     6802        /*   FPTS            FPTS            FPTS            FPTS            */
      434     6803        /*********************************************************************/
      435     6804                                                                                      /**/
      436     6805              %FPT_OPEN (FPTN=OPEN_USERS_FPT ,
      437     6806                          STCLASS = CONSTANT ,
      438     6807                          NAME = USERS_NAME ,
      439     6808                          ACCT = FILE_ACCT ,
      440     6809                          ASN  = FILE ,
      441     6810                          ACS = DIRECT ,
      442     6811                          ORG = KEYED ,
      443     6812                          FUN = UPDATE ,
      444     6813                          SHARE = ALL) ;
      445     6922              %VLP_NAME (FPTN=USERS_NAME ,
      446     6923                         STCLASS=CONSTANT ,
      447     6924                         NAME=':USERS' );
      448     6951              %VLP_NAME (FPTN=HLP_NAME ,
      449     6952                         STCLASS=CONSTANT ,
      450     6953                         NAME=':HLP' );
      451     6980              %VLP_NAME (FPTN=STAR_S_NAME ,
      452     6981                         STCLASS=CONSTANT ,
      453     6982                         NAME='*S' );
      454     7009              %VLP_NAME (FPTN=LIMIT_KEY ,
      455     7010                         STCLASS=CONSTANT ,
      456     7011                         NAME='LIMIT' );
      457     7038              %FPT_OPEN ( FPTN=OPEN$USERS_FPT ,
      458     7039                          SCRUB = YES ,
      459     7040                          STCLASS = AUTO ) ;
      460     7149              %FPT_CLOSE (FPTN = CLOSE_USERS_FPT ,
      461     7150                          STCLASS = CONSTANT ,
      462     7151                          DISP = SAVE) ;
      463     7193              %FPT_CLOSE (FPTN = CLOSE$USERS_FPT ,
      464     7194                          STCLASS = AUTO ) ;
      465     7236              %FPT_READ  (FPTN = READ_USERS_FPT ,
      466     7237                          STCLASS = CONSTANT ,
      467     7238                          KEYS = YES) ;
      468     7277              %FPT_READ  (FPTN = FPT$READ ,
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:75   
      469     7278                          STCLASS = AUTO ) ;
      470     7317              %FPT_WRITE ( FPTN = WRITE_USERS_FPT,
      471     7318                            STCLASS = CONSTANT ) ;
      472     7349              %FPT_WRITE ( FPTN = WRITE$USERS_FPT,
      473     7350                            STCLASS = AUTO ) ;
      474     7381              %FPT_GETDCB ( FPTN = FPT_GETUSERS ,
      475     7382                            STCLASS = CONSTANT ) ;
      476     7397              %FPT_GETDCB ( FPTN = FPT$GETUSERS ,
      477     7398                            STCLASS = AUTO ) ;
      478     7413              %FPT_RELDCB ( FPTN = FPT_RELUSERS ,
      479     7414                            STCLASS = CONSTANT ) ;
      480     7428              %FPT_RELDCB ( FPTN = FPT$RELUSERS ,
      481     7429                            STCLASS = AUTO ) ;
      482     7443              %FPT_ENQ ( FPTN = FPT_ENQ_USERS ,
      483     7444                            SHARE = NONE ,
      484     7445                            STCLASS = CONSTANT ) ;
      485     7463              %FPT_ENQ ( FPTN = FPT$ENQ_USERS ,
      486     7464                            STCLASS = AUTO ) ;
      487     7482    2   DCL 1 VEC BASED DALIGNED,2 * PTR, 2 P$ PTR;
      488     7483
      489     7484    2   DCL SAVEPRIV BIT(36);
      490     7485                                                                                      /**/
      491     7486        %EJECT;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:76   
      492     7487        /********************************************************************/
      493     7488        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      494     7489        /*********************************************************************/
      495     7490                                                              /**/
      496     7491                                                              /*
      497     7492                                                                    ***** Init. Enq fpt
      498     7493                                                              */
      499     7494    2         FPT$ENQ_USERS = FPT_ENQ_USERS;

   7494  2 001047   000100 100400                    MLR     fill='000'O
         2 001050   000242 000050 1                  ADSC9   FPT_ENQ_USERS            cn=0,n=40
         2 001051   200236 000050                    ADSC9   FPT$ENQ_USERS,,AUTO      cn=0,n=40

      500     7495    2         ADDR(FPT$ENQ_USERS) -> VEC.P$ = ADDR(FPT$ENQ_USERS.V);

   7495  2 001052   200244 630500                    EPPR0   FPT$ENQ_USERS+6,,AUTO
         2 001053   200237 450500                    STP0    FPT$ENQ_USERS+1,,AUTO

      501     7496    2         FPT$ENQ_USERS.V.DCB# = AL_DCB1#;

   7496  2 001054   200022 720100                    LXL0    AL_DCB1#,,AUTO
         2 001055   200244 740100                    STX0    FPT$ENQ_USERS+6,,AUTO

      502     7497    2         FPT$ENQ_USERS.RNAME_ = VECTOR(USERS_KEY);

   7497  2 001056   000005 235000 3                  LDA     5
         2 001057   200037 236100                    LDQ     @USERS_KEY,,AUTO
         2 001060   200240 757100                    STAQ    FPT$ENQ_USERS+2,,AUTO

      503     7498    2         CALL M$ENQ(FPT$ENQ_USERS) ALTRET(READ_ERR);

   7498  2 001061   200236 630500                    EPPR0   FPT$ENQ_USERS,,AUTO
         2 001062   420002 713400                    CLIMB   alt,+8194
         2 001063   401000 401760                    pmme    nvectors=3
         2 001064   001112 702000 2                  TSX2    READ_ERR
         2 001065   001067 710000 2                  TRA     s:7504

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:77   
      504     7499
      505     7500    2   REREAD_USERS: ENTRY (USERS_KEY) ALTRET;

   7500  2 001066   200036 741300       REREAD_USERS STX1  ! MASTER_ACCT+7,,AUTO

      506     7501                                                              /*
      507     7502                                                                   SET BUF$ IN READ FPT
      508     7503                                                              */
      509     7504    2         FPT$READ = READ_USERS_FPT ;

   7504  2 001067   000100 100400                    MLR     fill='000'O
         2 001070   000174 000070 1                  ADSC9   READ_USERS_FPT           cn=0,n=56
         2 001071   200170 000070                    ADSC9   FPT$READ,,AUTO           cn=0,n=56

      510     7505    2         FPT$READ.BUF_ = VECTOR(AS_USERS) ;

   7505  2 001072   000006 235000 3                  LDA     6
         2 001073   200004 236100                    LDQ     @BUF,,AUTO
         2 001074   200174 757100                    STAQ    FPT$READ+4,,AUTO

      511     7506    2         FPT$READ.KEY_ = VECTOR(USERS_KEY) ;

   7506  2 001075   000005 235000 3                  LDA     5
         2 001076   200037 236100                    LDQ     @USERS_KEY,,AUTO
         2 001077   200172 757100                    STAQ    FPT$READ+2,,AUTO

      512     7507    2         FPT$READ.V.DCB# = AL_DCB1# ;

   7507  2 001100   200022 720100                    LXL0    AL_DCB1#,,AUTO
         2 001101   200200 740100                    STX0    FPT$READ+8,,AUTO

      513     7508    2         ADDR(FPT$READ) -> VEC.P$ = ADDR(FPT$READ.V) ;

   7508  2 001102   200200 630500                    EPPR0   FPT$READ+8,,AUTO
         2 001103   200171 450500                    STP0    FPT$READ+1,,AUTO

      514     7509    2         CALL M$READ (FPT$READ) ALTRET(READ_ERR) ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:78   

   7509  2 001104   200170 630500                    EPPR0   FPT$READ,,AUTO
         2 001105   440000 713400                    CLIMB   alt,read
         2 001106   401400 401760                    pmme    nvectors=4
         2 001107   001112 702000 2                  TSX2    READ_ERR

      515     7510    2         RETURN ;

   7510  2 001110   200036 221300                    LDX1  ! MASTER_ACCT+7,,AUTO
         2 001111   000001 702211                    TSX2  ! 1,X1

      516     7511    2   READ_ERR:
      517     7512    2         ALTRETURN ;

   7512  2 001112   200036 221300       READ_ERR     LDX1  ! MASTER_ACCT+7,,AUTO
         2 001113   000000 702211                    TSX2  ! 0,X1

      518     7513                                                              /**/
      519     7514    2   OPEN_USERS:
      520     7515    2         ENTRY     ALTRET ;

   7515  2 001114   200036 741300       OPEN_USERS   STX1  ! MASTER_ACCT+7,,AUTO

      521     7516                                                              /**/
      522     7517    2         OPEN$USERS_FPT = OPEN_USERS_FPT ;

   7517  2 001115   000100 100400                    MLR     fill='000'O
         2 001116   000034 000350 1                  ADSC9   OPEN_USERS_FPT           cn=0,n=232
         2 001117   200040 000350                    ADSC9   OPEN$USERS_FPT,,AUTO     cn=0,n=232

      523     7518    2         GOTO OPEN_IT;

   7518  2 001120   001136 710000 2                  TRA     OPEN_IT

      524     7519
      525     7520    2   OPEN_HLP:
      526     7521    2         ENTRY     ALTRET ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:79   

   7521  2 001121   200036 741300       OPEN_HLP     STX1  ! MASTER_ACCT+7,,AUTO

      527     7522                                                              /**/
      528     7523    2         OPEN$USERS_FPT = OPEN_USERS_FPT ;

   7523  2 001122   000100 100400                    MLR     fill='000'O
         2 001123   000034 000350 1                  ADSC9   OPEN_USERS_FPT           cn=0,n=232
         2 001124   200040 000350                    ADSC9   OPEN$USERS_FPT,,AUTO     cn=0,n=232

      529     7524    2         OPEN$USERS_FPT.NAME_ = VECTOR(HLP_NAME);

   7524  2 001125   000010 237000 3                  LDAQ    8
         2 001126   200046 757100                    STAQ    OPEN$USERS_FPT+6,,AUTO

      530     7525    2         GOTO OPEN_IT;

   7525  2 001127   001136 710000 2                  TRA     OPEN_IT

      531     7526
      532     7527    2   OPEN_STAR_S:
      533     7528    2         ENTRY     ALTRET ;

   7528  2 001130   200036 741300       OPEN_STAR_S  STX1  ! MASTER_ACCT+7,,AUTO

      534     7529                                                              /**/
      535     7530    2         OPEN$USERS_FPT = OPEN_USERS_FPT ;

   7530  2 001131   000100 100400                    MLR     fill='000'O
         2 001132   000034 000350 1                  ADSC9   OPEN_USERS_FPT           cn=0,n=232
         2 001133   200040 000350                    ADSC9   OPEN$USERS_FPT,,AUTO     cn=0,n=232

      536     7531    2         OPEN$USERS_FPT.NAME_ = VECTOR(STAR_S_NAME);

   7531  2 001134   000012 237000 3                  LDAQ    10
         2 001135   200046 757100                    STAQ    OPEN$USERS_FPT+6,,AUTO

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:80   
   7531  2 001136                       OPEN_IT      null
      537     7532
      538     7533    2   OPEN_IT: ;
      539     7534
      540     7535    2         FPT$GETUSERS = FPT_GETUSERS ;

   7535  2 001136   000100 100400                    MLR     fill='000'O
         2 001137   000226 000040 1                  ADSC9   FPT_GETUSERS             cn=0,n=32
         2 001140   200222 000040                    ADSC9   FPT$GETUSERS,,AUTO       cn=0,n=32

      541     7536    2         ADDR(FPT$GETUSERS) -> VEC.P$ = ADDR(FPT$GETUSERS.V) ;

   7536  2 001141   200230 630500                    EPPR0   FPT$GETUSERS+6,,AUTO
         2 001142   200223 450500                    STP0    FPT$GETUSERS+1,,AUTO

      542     7537    2         FPT$GETUSERS.DCBNUM_ = VECTOR(AL_DCB1#);

   7537  2 001143   777640 235007                    LDA     -96,DL
         2 001144   200252 452500                    STP2    SAVEPRIV+2,,AUTO
         2 001145   200252 236100                    LDQ     SAVEPRIV+2,,AUTO
         2 001146   000022 036003                    ADLQ    18,DU
         2 001147   200226 757100                    STAQ    FPT$GETUSERS+4,,AUTO

      543     7538    2         CALL M$GETDCB( FPT$GETUSERS ) ALTRET( NODCB ) ;

   7538  2 001150   200222 630500                    EPPR0   FPT$GETUSERS,,AUTO
         2 001151   460002 713400                    CLIMB   alt,+24578
         2 001152   401000 401760                    pmme    nvectors=3
         2 001153   001202 702000 2                  TSX2    NODCB

      544     7539                                                              /**/
      545     7540    2         OPEN$USERS_FPT.V.DCB# = AL_DCB1# ;

   7540  2 001154   200022 720100                    LXL0    AL_DCB1#,,AUTO
         2 001155   200104 740100                    STX0    OPEN$USERS_FPT+36,,AUTO

      546     7541    2         ADDR(OPEN$USERS_FPT) -> VEC.P$ = ADDR(OPEN$USERS_FPT.V) ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:81   

   7541  2 001156   200104 630500                    EPPR0   OPEN$USERS_FPT+36,,AUTO
         2 001157   200041 450500                    STP0    OPEN$USERS_FPT+1,,AUTO

      547     7542    2         SAVEPRIV = B$JIT.PRIV.ACTIVE;

   7542  2 001160   000000 471400 xsym               LDP1    B$JIT$
         2 001161   100013 236100                    LDQ     11,,PR1
         2 001162   200250 756100                    STQ     SAVEPRIV,,AUTO

      548     7543    2         B$JIT.PRIV.ACTIVE = B$JIT.PRIV.ACTIVE | %(PR_FMSEC#|PR_FMBLK#);

   7543  2 001163   000275 276000 1                  ORQ     FPT_TIME+17
         2 001164   100013 756100                    STQ     11,,PR1

      549     7544    2         CALL M$OPEN (OPEN$USERS_FPT) ALTRET(OPEN_ERR) ;

   7544  2 001165   200040 630500                    EPPR0   OPEN$USERS_FPT,,AUTO
         2 001166   450000 713400                    CLIMB   alt,open
         2 001167   410400 401760                    pmme    nvectors=18
         2 001170   001176 702000 2                  TSX2    OPEN_ERR

      550     7545    2         B$JIT.PRIV.ACTIVE = SAVEPRIV;

   7545  2 001171   200250 236100                    LDQ     SAVEPRIV,,AUTO
         2 001172   000000 470400 xsym               LDP0    B$JIT$
         2 001173   000013 756100                    STQ     11,,PR0

      551     7546    2         RETURN ;

   7546  2 001174   200036 221300                    LDX1  ! MASTER_ACCT+7,,AUTO
         2 001175   000001 702211                    TSX2  ! 1,X1

   7545  2 001176                       OPEN_ERR     null
      552     7547    2   OPEN_ERR: ;
      553     7548    2         B$JIT.PRIV.ACTIVE = SAVEPRIV;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:82   
   7548  2 001176   200250 236100                    LDQ     SAVEPRIV,,AUTO
         2 001177   000000 470400 xsym               LDP0    B$JIT$
         2 001200   000013 756100                    STQ     11,,PR0

      554     7549    2         GOTO CLOSE_ERR;

   7549  2 001201   001261 710000 2                  TRA     CLOSE_ERR

   7548  2 001202                       NODCB        null
      555     7550    2   NODCB: ;
      556     7551    2         CALL M$XXX;

   7551  2 001202   000003 713400                    CLIMB   3
         2 001203   000000 401760                    pmme    nvectors=0
         2 001204   001206 710000 2                  TRA     s:7555

      557     7552                                                              /**/
      558     7553    2   WRITE_STAR_S:
      559     7554    2         ENTRY ALTRET ;

   7554  2 001205   200036 741300       WRITE_STAR_S STX1  ! MASTER_ACCT+7,,AUTO

      560     7555    2         WRITE$USERS_FPT = WRITE_USERS_FPT ;

   7555  2 001206   000100 100400                    MLR     fill='000'O
         2 001207   000212 000060 1                  ADSC9   WRITE_USERS_FPT          cn=0,n=48
         2 001210   200206 000060                    ADSC9   WRITE$USERS_FPT,,AUTO    cn=0,n=48

      561     7556    2         WRITE$USERS_FPT.BUF_ = VECTOR(CP_LIMREC);

   7556  2 001211   000007 235000 3                  LDA     7
         2 001212   200004 236100                    LDQ     @BUF,,AUTO
         2 001213   200212 757100                    STAQ    WRITE$USERS_FPT+4,,AUTO

      562     7557    2         WRITE$USERS_FPT.KEY_ = VECTOR(LIMIT_KEY);

   7557  2 001214   000014 237000 3                  LDAQ    12
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:83   
         2 001215   200210 757100                    STAQ    WRITE$USERS_FPT+2,,AUTO

      563     7558    2         GOTO WRITE_IT;

   7558  2 001216   001231 710000 2                  TRA     WRITE_IT

      564     7559
      565     7560    2   WRITE_USERS:
      566     7561    2         ENTRY ALTRET ;

   7561  2 001217   200036 741300       WRITE_USERS  STX1  ! MASTER_ACCT+7,,AUTO

      567     7562    2         WRITE$USERS_FPT = WRITE_USERS_FPT ;

   7562  2 001220   000100 100400                    MLR     fill='000'O
         2 001221   000212 000060 1                  ADSC9   WRITE_USERS_FPT          cn=0,n=48
         2 001222   200206 000060                    ADSC9   WRITE$USERS_FPT,,AUTO    cn=0,n=48

      568     7563    2         WRITE$USERS_FPT.BUF_ = VECTOR(AS_USERS);

   7563  2 001223   000006 235000 3                  LDA     6
         2 001224   200004 236100                    LDQ     @BUF,,AUTO
         2 001225   200212 757100                    STAQ    WRITE$USERS_FPT+4,,AUTO

      569     7564    2         WRITE$USERS_FPT.KEY_ = VECTOR(FPT);

   7564  2 001226   000016 235000 3                  LDA     14
         2 001227   200003 236100                    LDQ     @FPT,,AUTO
         2 001230   200210 757100                    STAQ    WRITE$USERS_FPT+2,,AUTO

   7564  2 001231                       WRITE_IT     null
      570     7565
      571     7566    2   WRITE_IT: ;
      572     7567    2         ADDR(WRITE$USERS_FPT) -> VEC.P$ = ADDR(WRITE$USERS_FPT.V) ;

   7567  2 001231   200216 630500                    EPPR0   WRITE$USERS_FPT+8,,AUTO
         2 001232   200207 450500                    STP0    WRITE$USERS_FPT+1,,AUTO
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:84   

      573     7568    2         WRITE$USERS_FPT.V.DCB# = AL_DCB1# ;

   7568  2 001233   200022 720100                    LXL0    AL_DCB1#,,AUTO
         2 001234   200216 740100                    STX0    WRITE$USERS_FPT+8,,AUTO

      574     7569    2         CALL M$WRITE (WRITE$USERS_FPT) ALTRET(WRITE_ERR) ;

   7569  2 001235   200206 630500                    EPPR0   WRITE$USERS_FPT,,AUTO
         2 001236   440001 713400                    CLIMB   alt,write
         2 001237   401400 401760                    pmme    nvectors=4
         2 001240   001243 702000 2                  TSX2    WRITE_ERR

      575     7570    2         RETURN ;

   7570  2 001241   200036 221300                    LDX1  ! MASTER_ACCT+7,,AUTO
         2 001242   000001 702211                    TSX2  ! 1,X1

      576     7571    2   WRITE_ERR:
      577     7572    2         ALTRETURN ;

   7572  2 001243   200036 221300       WRITE_ERR    LDX1  ! MASTER_ACCT+7,,AUTO
         2 001244   000000 702211                    TSX2  ! 0,X1

      578     7573                                                              /**/
      579     7574    2   CLOSE_USERS:
      580     7575    2         ENTRY     ALTRET ;

   7575  2 001245   200036 741300       CLOSE_USERS  STX1  ! MASTER_ACCT+7,,AUTO

      581     7576    2         CLOSE$USERS_FPT = CLOSE_USERS_FPT ;

   7576  2 001246   000100 100400                    MLR     fill='000'O
         2 001247   000136 000170 1                  ADSC9   CLOSE_USERS_FPT          cn=0,n=120
         2 001250   200132 000170                    ADSC9   CLOSE$USERS_FPT,,AUTO    cn=0,n=120

      582     7577    2         CLOSE$USERS_FPT.V.DCB# = AL_DCB1# ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:85   

   7577  2 001251   200022 720100                    LXL0    AL_DCB1#,,AUTO
         2 001252   200164 740100                    STX0    CLOSE$USERS_FPT+26,,AUTO

      583     7578    2         ADDR(CLOSE$USERS_FPT) -> VEC.P$ = ADDR( CLOSE$USERS_FPT.V ) ;

   7578  2 001253   200164 630500                    EPPR0   CLOSE$USERS_FPT+26,,AUTO
         2 001254   200133 450500                    STP0    CLOSE$USERS_FPT+1,,AUTO

      584     7579    2         CALL M$CLOSE (CLOSE$USERS_FPT) ALTRET (CLOSE_ERR) ;

   7579  2 001255   200132 630500                    EPPR0   CLOSE$USERS_FPT,,AUTO
         2 001256   450001 713400                    CLIMB   alt,close
         2 001257   406000 401760                    pmme    nvectors=13
         2 001260   001261 702000 2                  TSX2    CLOSE_ERR

   7578  2 001261                       CLOSE_ERR    null
      585     7580                                                              /**/
      586     7581    2   CLOSE_ERR: ;
      587     7582    2         FPT$RELUSERS = FPT_RELUSERS ;

   7582  2 001261   000100 100400                    MLR     fill='000'O
         2 001262   000236 000020 1                  ADSC9   FPT_RELUSERS             cn=0,n=16
         2 001263   200232 000020                    ADSC9   FPT$RELUSERS,,AUTO       cn=0,n=16

      588     7583    2         FPT$RELUSERS.V.DCB# = AL_DCB1# ;

   7583  2 001264   200022 720100                    LXL0    AL_DCB1#,,AUTO
         2 001265   200234 740100                    STX0    FPT$RELUSERS+2,,AUTO

      589     7584    2         ADDR(FPT$RELUSERS) -> VEC.P$ = ADDR( FPT$RELUSERS.V ) ;

   7584  2 001266   200234 630500                    EPPR0   FPT$RELUSERS+2,,AUTO
         2 001267   200233 450500                    STP0    FPT$RELUSERS+1,,AUTO

      590     7585    2         CALL M$RELDCB( FPT$RELUSERS ) ALTRET( NODCB2 ) ;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:86   
   7585  2 001270   200232 630500                    EPPR0   FPT$RELUSERS,,AUTO
         2 001271   460003 713400                    CLIMB   alt,+24579
         2 001272   400000 401760                    pmme    nvectors=1
         2 001273   001274 702000 2                  TSX2    NODCB2

      591     7586    2   NODCB2: ALTRETURN ;  /* In case call to OPEN - CLOSE callers never care */

   7586  2 001274   200036 221300       NODCB2       LDX1  ! MASTER_ACCT+7,,AUTO
         2 001275   000000 702211                    TSX2  ! 0,X1

      592     7587                                                              /**/
      593     7588    2   END   READ_USERS ;
      594     7589
      595     7590    1   GETTIME: PROC (TIME) ALTRET;

   7590  2 001276   200024 741300       GETTIME      STX1  ! AL_DCB1#+2,,AUTO

      596     7591
      597     7592    2   DCL TIME UBIN;
      598     7593
      599     7594              %FPT_TIME ( FPTN = FPT_TIME ,
      600     7595                          STCLASS = CONSTANT ) ;
      601     7614              %FPT_TIME ( FPTN = FPT$TIME ,
      602     7615                          STCLASS = AUTO ) ;
      603     7634        %EJECT ;
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:87   
      604     7635        /*********************************************************************/
      605     7636        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      606     7637        /*********************************************************************/
      607     7638                                                              /**/
      608     7639    2         FPT$TIME = FPT_TIME ;

   7639  2 001277   000100 100400                    MLR     fill='000'O
         2 001300   000254 000060 1                  ADSC9   FPT_TIME                 cn=0,n=48
         2 001301   200026 000060                    ADSC9   FPT$TIME,,AUTO           cn=0,n=48

      609     7640    2         FPT$TIME.TSTAMP_ = VECTOR( TIME ) ;

   7640  2 001302   777640 235007                    LDA     -96,DL
         2 001303   200025 236100                    LDQ     @TIME,,AUTO
         2 001304   200036 757100                    STAQ    MASTER_ACCT+7,,AUTO

      610     7641    2         FPT$TIME.V_    = VECTOR( FPT$TIME.V     ) ;

   7641  2 001305   000017 235000 3                  LDA     15
         2 001306   200252 452500                    STP2    SAVEPRIV+2,,AUTO
         2 001307   200252 236100                    LDQ     SAVEPRIV+2,,AUTO
         2 001310   000040 036003                    ADLQ    32,DU
         2 001311   200026 757100                    STAQ    FPT$TIME,,AUTO

      611     7642                                                              /*   GET THE TIME.   */
      612     7643    2         CALL M$TIME( FPT$TIME )  ALTRET( TIME_ERR ) ;

   7643  2 001312   200026 630500                    EPPR0   FPT$TIME,,AUTO
         2 001313   420004 713400                    CLIMB   alt,+8196
         2 001314   402000 401760                    pmme    nvectors=5
         2 001315   001316 702000 2                  TSX2    TIME_ERR

   7641  2 001316                       TIME_ERR     null
      613     7644                                                              /**/
      614     7645    2   TIME_ERR: ;
      615     7646    2         RETURN ;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:88   
   7646  2 001316   200024 221300                    LDX1  ! AL_DCB1#+2,,AUTO
         2 001317   000001 702211                    TSX2  ! 1,X1

RESET_BANNER
 Sect OctLoc
   1     000   000003 777640   000010 006000   000001 777640   000006 006000    ................
   1     004   000000 177640   000000 006014   200000 000000   0***** ******    ................

LET_BANNER_RESET
 Sect OctLoc
   1     010   114105 124040   102101 116116   105122 040122   105123 105124    LET BANNER RESET

(unnamed)
 Sect OctLoc
   1     014   000000 141520                                                    ..a.

SCRAMBLED_BITS
 Sect OctLoc
   1     015   615502 466037   060222 751600                                    ....0...

NONE_NAME
 Sect OctLoc
   1     017   004116 117116   105*** ******                                    .NONE...

CWRSYSLOG
 Sect OctLoc
   1     022   000003 777640   000026 006000   000000 177640   000000 006014    ................
   1     026   000000 0000**   000000 000770   000000 000061   000000 000003    ...........1....

FILE_ACCT
 Sect OctLoc
   1     032   072123 131123   040040 040040                                    :SYS

OPEN_USERS_FPT
 Sect OctLoc
   1     034   000025 777640   000100 006000   000000 177640   000000 006014    .....@..........
   1     040   000000 177640   000000 006014   000001 577640   000126 006000    .............V..
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:89   
   1     044   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     060*  000001 777640   000032 006000   000000 177640   000000 006014    ................
   1     064   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     100*  000000 000052   000000 001001   252525 002002   000040 252520    ...*......... ..
   1     104   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     110   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     114   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     120   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     124   000000 000000   ****** ******                                    ........

USERS_NAME
 Sect OctLoc
   1     126   006072 125123   105122 123***                                    .:USERS.

HLP_NAME
 Sect OctLoc
   1     130   004072 110114   120*** ******                                    .:HLP...

STAR_S_NAME
 Sect OctLoc
   1     132   002052 123***                                                    .*S.

LIMIT_KEY
 Sect OctLoc
   1     133   005114 111115   111124 ******                                    .LIMIT..

CLOSE_USERS_FPT
 Sect OctLoc
   1     136   000003 777640   000170 006000   000000 177640   000000 006014    .....x..........
   1     142   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     166*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     172   000220 000000   000000 000000                                    ........

READ_USERS_FPT
 Sect OctLoc
   1     174   000005 777640   000204 006000   000000 177640   000000 006014    ................
   1     200   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:90   
   1     204   000000 600000   000000 000000   000000 000000   000000 000000    ................
   1     210   000000 000000   000000 000000                                    ........

WRITE_USERS_FPT
 Sect OctLoc
   1     212   000003 777640   000222 006000   000000 177640   000000 006014    ................
   1     216   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     222   000000 400400   000000 000000   000000 000000   000000 000000    ................

FPT_GETUSERS
 Sect OctLoc
   1     226   000001 777640   000234 006000   000000 177640   000000 006014    ................
   1     232   000000 177640   000000 006014   000000 000000   000000 000000    ................

FPT_RELUSERS
 Sect OctLoc
   1     236   000001 777640   000240 006000   000000 000000   000000 000000    ................

FPT_ENQ_USERS
 Sect OctLoc
   1     242   000003 777640   000250 006000   000000 177640   000000 006014    ................
   1     246   000000 177640   000000 006014   000000 540000   777777 777777    ................
   1     252   000000 000000   000000 000000                                    ........

FPT_TIME
 Sect OctLoc
   1     254   000001 777640   000266 006000   000000 177640   000000 006014    ................
   1     260   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     264   000000 177640   000000 006014   000001 000000   ****** ******    ................

(unnamed)
 Sect OctLoc
   1     270   040163 143162   155142 154144   177777 777777   000000 000400     scrmbld........
   1     274   000020 000000   300000 000000                                    ........

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:91   
   3     000   777677 777777   777737 777777   777757 777777   777777 177777    ................
   3     004   000060 777640   000005 177640   001003 777640   000032 777640    .0..............
   3     010   000001 177640   000130 006000   000000 577640   000132 006000    .....X.......Z..
   3     014   000001 377640   000133 006000   000007 777640   000001 777640    .....[..........
      616     7647                                                              /**/
      617     7648    2   END   GETTIME ;
      618     7649    1   END XSL$CHAM;

PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:92   
--  Include file information  --

   EL_SUBS_C.:LIBRARY  is referenced.
   XSL_CHAM_M.:TCA2TOU  is referenced.
   ES_TABLES_M.:LIBRARY  is referenced.
   ES_SUBS_E.:LIBRARY  is referenced.
   CP_MACROS_C.:LIBRARY  is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$TABLES_C.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   KL_SUPER_C.:LIBRARY  is referenced.
   AS_SUPER_C.:LIBRARY  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure XSL$CHAM.
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:93   

 **** Variables and constants ****

  ****  Section 001 RoData XSL$CHAM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   136-0-0/d STRC(1080)  r     1 CLOSE_USERS_FPT           22-0-0/d STRC(288)   r     1 CWRSYSLOG
    32-0-0/c STRC(72)    r     1 FILE_ACCT                242-0-0/d STRC(360)   r     1 FPT_ENQ_USERS
   226-0-0/d STRC(288)   r     1 FPT_GETUSERS             236-0-0/d STRC(144)   r     1 FPT_RELUSERS
   254-0-0/d STRC(432)   r     1 FPT_TIME                 130-0-0/c STRC(45)    r     1 HLP_NAME
    10-0-0/c CHAR(16)    r     1 LET_BANNER_RESET         133-0-0/c STRC(54)    r     1 LIMIT_KEY
    17-0-0/c STRC(45)    r     1 NONE_NAME                 17-0-0/c CHAR(5)     r     1 NO_MACCOUNT
    34-0-0/d STRC(2088)  r     1 OPEN_USERS_FPT           174-0-0/d STRC(504)   r     1 READ_USERS_FPT
     0-0-0/d STRC(288)   r     1 RESET_BANNER
    15-0-0/b BIT         r     1 SCRAMBLED_BITS(0:1)
    15-0-0/c CHAR(8)     r     1 SCRAMBLED_BLANKS         132-0-0/c STRC(27)    r     1 STAR_S_NAME
   126-0-0/c STRC(63)    r     1 USERS_NAME               212-0-0/d STRC(432)   r     1 WRITE_USERS_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF                       3-0-0/w PTR         r     1 @FPT
    25-0-0/w PTR         r     1 @TIME                     37-0-0/w PTR         r     1 @USERS_KEY
    22-0-0/w SBIN        r     1 AL_DCB1#                  *0-0-0/w STRC(576)   r     1 AS_HLP
    *0-0-0/w STRC(18576) r     1 AS_USERS                  26-0-0/b BIT         r     1 BUDLIM
    *0-0-0/w ACHR        r     1 BUF                      132-0-0/d STRC(1080)  r     1 CLOSE$USERS_FPT
    *0-0-0/w STRC(972)   r     1 CP_LIMREC                 25-0-0/w STRC(1764)  r     1 ES$SECLOG
    *0-0-0/w STRC(288)   r     1 FPT                      236-0-0/d STRC(360)   r     1 FPT$ENQ_USERS
   222-0-0/d STRC(288)   r     1 FPT$GETUSERS             170-0-0/d STRC(504)   r     1 FPT$READ
   232-0-0/d STRC(144)   r     1 FPT$RELUSERS              26-0-0/d STRC(432)   r     1 FPT$TIME
   106-0-0/d STRC(288)   r     1 FPT_WRSYSLOG              15-0-0/w SBIN        r     1 LOGRSN
    27-0-0/c CHAR(21)    r     1 MASTER_ACCN
    27-0-0/c CHAR        r     1 MASTER_ACCT(0:20)
    21-0-0/w UBIN        r     1 MODE                      40-0-0/d STRC(2088)  r     1 OPEN$USERS_FPT
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:94   
    16-0-0/c CHAR(8)     r     1 PLAINPW                  116-0-0/b BIT         r     1 SAVEPRIV
   250-0-0/b BIT         r     1 SAVEPRIV                  25-0-0/w SBIN        r     1 TEMP
    *0-0-0/w UBIN        r     1 TIME                      11-0-0/w SBIN        r     1 UMAX
    *0-0-0/c STRC(189)   r     1 USERS_KEY                206-0-0/d STRC(432)   r     1 WRITE$USERS_FPT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(72)    r     1 VEC


   Procedure XSL$CHAM requires 720 words for executable code.
   Procedure XSL$CHAM requires 172 words of local(AUTO) storage.

    No errors detected in file XSL$CHAM.:TCA2TSI    .
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:95   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:96   
          MINI XREF LISTING

AL_DCB1#
      5940**DCL      7496>>ASSIGN   7507>>ASSIGN   7537--ASSIGN   7540>>ASSIGN   7568>>ASSIGN   7577>>ASSIGN
      7583>>ASSIGN
ASZ$SCRAMBLE
      6007**DCL-ENT  6055--CALL
AS_HLP.ATYP
      5789**DCL      6066>>IF
AS_HLP.PASSWORD
      5842**DCL      5846--REDEF    6069>>IF       6070>>IF
AS_HLP.RENAME
      5865**DCL      5866--REDEF
AS_USERS
      5606**DCL      7505--ASSIGN   7563--ASSIGN
AS_USERS.BAD_LOGON_CNT
      5748**DCL      6088<<ASSIGN   6088>>ASSIGN   6751<<ASSIGN
AS_USERS.BANNER_PERM
      5721**DCL      5722--REDEF
AS_USERS.BILL
      5645**DCL      6134>>ASSIGN
AS_USERS.BUDGET.ACCUM
      5616**DCL      6290>>ASSIGN
AS_USERS.BUDGET.BKACC
      5633**DCL      6291>>IF       6306>>IF
AS_USERS.BUDGET.BLINDACCTNG
      5637**DCL      6128>>ASSIGN
AS_USERS.BUDGET.BUDLIM
      5634**DCL      6287>>ASSIGN
AS_USERS.BUDGET.ICHARGES
      5636**DCL      6288>>IF
AS_USERS.BUDGET.MACCT
      5626**DCL      5630--REDEF    6301>>ASSIGN   6312>>ASSIGN
AS_USERS.BUDGET.MAXC
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:97   
      5615**DCL      6288>>IF       6290>>ASSIGN
AS_USERS.BUDGET.MAX_PROJECTS
      5639**DCL      5642--REDEF
AS_USERS.BUDGET.PACCUM
      5622**DCL      5624--REDEF    6305>>ASSIGN
AS_USERS.BUDGET.PCHARGES
      5635**DCL      6302>>DOWHILE
AS_USERS.BUDGET.PMAXC
      5617**DCL      5619--REDEF    6304>>IF       6305>>ASSIGN
AS_USERS.DDO
      5658**DCL      6143>>ASSIGN
AS_USERS.DEXP
      5695**DCL      6153>>ASSIGN
AS_USERS.DFPOOLS
      5666**DCL      6152>>ASSIGN
AS_USERS.DLO
      5656**DCL      6139>>ASSIGN
AS_USERS.DMEM
      5706**DCL      6172<<ASSIGN   6174>>ASSIGN
AS_USERS.DMPRIO
      5668**DCL      6156>>ASSIGN
AS_USERS.DPDIS
      5662**DCL      6155>>ASSIGN
AS_USERS.DPO
      5660**DCL      6147>>ASSIGN
AS_USERS.DTDIS
      5664**DCL      6151>>ASSIGN
AS_USERS.DTIME
      5703**DCL      6167>>ASSIGN
AS_USERS.FLAGS.STARSACC
      5698**DCL      6163>>IF
AS_USERS.HPSN
      5671**DCL      6130>>ASSIGN
AS_USERS.KEY
      5646**DCL      6158>>ASSIGN
AS_USERS.LASTCPROC.NAME.CNT
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:98   
      5681**DCL      6136>>IF
AS_USERS.LAST_LOGON_TIME
      5746**DCL      6750<<ASSIGN
AS_USERS.LOGINS.BAD_LOGON_CNT
      5756**DCL      6753<<ASSIGN
AS_USERS.LOGINS.LAST_LOGON_TIME
      5754**DCL      6752<<ASSIGN
AS_USERS.MAXENQ
      5761**DCL      6124>>IF       6124>>ASSIGN
AS_USERS.MDO
      5657**DCL      6144>>IF       6202>>ASSIGN
AS_USERS.MEXP
      5694**DCL      6154>>ASSIGN
AS_USERS.MFPOOLS
      5665**DCL      6208>>ASSIGN
AS_USERS.MLO
      5655**DCL      6140>>IF       6198>>ASSIGN
AS_USERS.MMEM
      5705**DCL      6173<<ASSIGN   6196>>ASSIGN
AS_USERS.MMPRIO
      5667**DCL      6157>>ASSIGN
AS_USERS.MPDIS
      5661**DCL      6206>>ASSIGN
AS_USERS.MPO
      5659**DCL      6148>>IF       6200>>ASSIGN
AS_USERS.MTDIS
      5663**DCL      6204>>ASSIGN
AS_USERS.NAT_LANG
      5609**DCL      6165>>ASSIGN
AS_USERS.OUTPUTPRIO
      5648**DCL      6166>>ASSIGN
AS_USERS.PPRIV
      5685**DCL      6734>>ASSIGN
AS_USERS.PRIOB
      5693**DCL      6122>>ASSIGN
AS_USERS.PRIV
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:99   
      5684**DCL      6117>>ASSIGN   6733>>ASSIGN
AS_USERS.QUAN
      5691**DCL      6123>>ASSIGN
AS_USERS.RESL.OMAX
      5718**DCL      6176>>DOCASE
AS_USERS.SETUP_CHRA.TXT
      5737**DCL      5738--REDEF    5739--REDEF
AS_USERS.STEPACCNT
      5610**DCL      6159>>IF
AZA$LOGOFF
      6008**DCL-ENT  6099--IF       6100--CALL
B$JIT.ACCN
      3368**DCL      6114<<ASSIGN   6132>>ASSIGN
B$JIT.BILL
      3516**DCL      6134<<ASSIGN
B$JIT.BLINDACCTNG
      3516**DCL      6128<<ASSIGN
B$JIT.BUDLIM
      3505**DCL      6285<<ASSIGN   6314<<ASSIGN
B$JIT.CPFLAGS1
      3457**DCL      6137<<ASSIGN   6137>>ASSIGN   6161<<ASSIGN   6161>>ASSIGN   6164<<ASSIGN   6164>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      3462**DCL      3462--REDEF
B$JIT.DEFEXP
      3536**DCL      6153<<ASSIGN
B$JIT.DEFPRI
      3516**DCL      6156<<ASSIGN
B$JIT.ERR.MID
      3369**DCL      3369--REDEF
B$JIT.FACCN
      3368**DCL      6132<<ASSIGN
B$JIT.FBUL
      3528**DCL      6152<<ASSIGN   6209>>ASSIGN
B$JIT.FPSN
      3449**DCL      6131<<ASSIGN
B$JIT.HPSN
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:100  
      3536**DCL      6130<<ASSIGN
B$JIT.JRESPEAK
      3530**DCL      3531--REDEF
B$JIT.LANG
      3504**DCL      6165<<ASSIGN
B$JIT.LOCK
      3517**DCL      6158<<ASSIGN
B$JIT.LOGONTIME
      3505**DCL      6186<>CALL     6750>>ASSIGN   6752>>ASSIGN
B$JIT.MAXCORE
      3529**DCL      6174<<ASSIGN   6175>>ASSIGN   6197>>ASSIGN
B$JIT.MAXENQ
      3641**DCL      6124<<ASSIGN
B$JIT.MAXEXP
      3536**DCL      6154<<ASSIGN
B$JIT.MAXPRI
      3516**DCL      6157<<ASSIGN
B$JIT.MAXTMPDP
      3537**DCL      6151<<ASSIGN   6205>>ASSIGN
B$JIT.MODE
      3363**DCL      6059>>ASSIGN
B$JIT.MRT
      3542**DCL      6167<<ASSIGN   6210>>ASSIGN   6211>>ASSIGN
B$JIT.NODOEVER
      3635**DCL      6145<<ASSIGN   6146<<ASSIGN
B$JIT.NOLOEVER
      3635**DCL      6141<<ASSIGN   6142<<ASSIGN
B$JIT.NOPOEVER
      3635**DCL      6149<<ASSIGN   6150<<ASSIGN
B$JIT.OLTA
      3636**DCL      6178<<ASSIGN   6180<<ASSIGN   6182<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
      3639**DCL      3639--REDEF    3640--REDEF
B$JIT.OUTPRIO
      3449**DCL      6166<<ASSIGN
B$JIT.PNR
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:101  
      3543**DCL      3543--REDEF
B$JIT.PRDPRM
      3537**DCL      6155<<ASSIGN   6207>>ASSIGN
B$JIT.PRIOB
      3541**DCL      6122<<ASSIGN
B$JIT.PRIV.ACTIVE
      3369**DCL      6119<<ASSIGN   6739>>ASSIGN   6742<<ASSIGN   7542>>ASSIGN   7543<<ASSIGN   7543>>ASSIGN
      7545<<ASSIGN   7548<<ASSIGN
B$JIT.PRIV.ACTIVE.SYSLOG
      3372**DCL      6740<<ASSIGN
B$JIT.PRIV.AUTH
      3409**DCL      6120<<ASSIGN
B$JIT.PRIV.JOB
      3412**DCL      6117<<ASSIGN   6119>>ASSIGN   6120>>ASSIGN
B$JIT.PRIV.PRC.JIT
      3420**DCL      6058>>IF
B$JIT.QUAN
      3541**DCL      6123<<ASSIGN
B$JIT.REMCPO
      3641**DCL      6147<<ASSIGN   6201>>ASSIGN
B$JIT.REMDO
      3641**DCL      6143<<ASSIGN   6203>>ASSIGN
B$JIT.REMLO
      3641**DCL      6139<<ASSIGN   6199>>ASSIGN
B$JIT.RESCORE
      3637**DCL      6172>>ASSIGN   6173>>ASSIGN   6175<<ASSIGN
B$JIT.SYSID
      3368**DCL      6725>>ASSIGN
B$JIT.TSLINE
      3637**DCL      3638--REDEF
B$JIT.UNAME
      3368**DCL      6115<<ASSIGN
B$JIT.USER
      3368**DCL      6726>>ASSIGN
B$JIT$
      3644**DCL      3363--IMP-PTR  6058>>IF       6059>>ASSIGN   6114>>ASSIGN   6115>>ASSIGN   6117>>ASSIGN
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:102  
      6119>>ASSIGN   6119>>ASSIGN   6120>>ASSIGN   6120>>ASSIGN   6122>>ASSIGN   6123>>ASSIGN   6124>>ASSIGN
      6128>>ASSIGN   6130>>ASSIGN   6131>>ASSIGN   6132>>ASSIGN   6132>>ASSIGN   6134>>ASSIGN   6137>>ASSIGN
      6137>>ASSIGN   6139>>ASSIGN   6141>>ASSIGN   6142>>ASSIGN   6143>>ASSIGN   6145>>ASSIGN   6146>>ASSIGN
      6147>>ASSIGN   6149>>ASSIGN   6150>>ASSIGN   6151>>ASSIGN   6152>>ASSIGN   6153>>ASSIGN   6154>>ASSIGN
      6155>>ASSIGN   6156>>ASSIGN   6157>>ASSIGN   6158>>ASSIGN   6161>>ASSIGN   6161>>ASSIGN   6164>>ASSIGN
      6164>>ASSIGN   6165>>ASSIGN   6166>>ASSIGN   6167>>ASSIGN   6172>>ASSIGN   6173>>ASSIGN   6174>>ASSIGN
      6175>>ASSIGN   6175>>ASSIGN   6178>>ASSIGN   6180>>ASSIGN   6182>>ASSIGN   6186>>CALL     6197>>ASSIGN
      6199>>ASSIGN   6201>>ASSIGN   6203>>ASSIGN   6205>>ASSIGN   6207>>ASSIGN   6209>>ASSIGN   6210>>ASSIGN
      6211>>ASSIGN   6285>>ASSIGN   6314>>ASSIGN   6725>>ASSIGN   6726>>ASSIGN   6739>>ASSIGN   6740>>ASSIGN
      6742>>ASSIGN   6750>>ASSIGN   6752>>ASSIGN   7542>>ASSIGN   7543>>ASSIGN   7543>>ASSIGN   7545>>ASSIGN
      7548>>ASSIGN
BUDGET
      6235**PROC     6105--CALL
BUDGET_ERR
      6211**LABEL    6105--CALLALT
BUDLIM IN PROCEDURE BUDGET
      6249**DCL      6287<<ASSIGN   6296>>IF       6310>>IF       6314>>IF
BUF
      5592**DCL        10--PROC     5606--REDEF    5784--REDEF    5885--REDEF    6049--ENTRY
CLOSE$USERS_FPT IN PROCEDURE READ_USERS
      7217**DCL      7576<<ASSIGN   7578--ASSIGN   7579<>CALL
CLOSE$USERS_FPT.SN_ IN PROCEDURE READ_USERS
      7217**DCL      7217--REDEF
CLOSE$USERS_FPT.UTL_ IN PROCEDURE READ_USERS
      7218**DCL      7218--REDEF
CLOSE$USERS_FPT.V IN PROCEDURE READ_USERS
      7222**DCL      7578--ASSIGN
CLOSE$USERS_FPT.V.DCB# IN PROCEDURE READ_USERS
      7223**DCL      7577<<ASSIGN
CLOSE$USERS_FPT.V.EXPIRE# IN PROCEDURE READ_USERS
      7232**DCL      7232--REDEF
CLOSE$USERS_FPT.V.TYPE# IN PROCEDURE READ_USERS
      7230**DCL      7230--REDEF
CLOSE$USERS_FPT.V.XTNSIZE# IN PROCEDURE READ_USERS
      7227**DCL      7227--REDEF    7229--REDEF
CLOSE_ERR IN PROCEDURE READ_USERS
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:103  
      7578**LABEL    7549--GOTO     7579--CALLALT
CLOSE_S_ERR
      6211**LABEL    6194--CALLALT  6214--CALLALT  6220--CALLALT
CLOSE_USERS IN PROCEDURE READ_USERS
      7575**ENTRY    6075--CALL     6090--CALL     6189--CALL     6220--CALL     6228--CALL
CLOSE_USERS_FPT IN PROCEDURE READ_USERS
      7174**DCL      7576>>ASSIGN
CLOSE_USERS_FPT.SN_ IN PROCEDURE READ_USERS
      7174**DCL      7174--REDEF
CLOSE_USERS_FPT.UTL_ IN PROCEDURE READ_USERS
      7175**DCL      7175--REDEF
CLOSE_USERS_FPT.V IN PROCEDURE READ_USERS
      7179**DCL      7174--DCLINIT
CLOSE_USERS_FPT.V.EXPIRE# IN PROCEDURE READ_USERS
      7189**DCL      7189--REDEF
CLOSE_USERS_FPT.V.TYPE# IN PROCEDURE READ_USERS
      7187**DCL      7187--REDEF
CLOSE_USERS_FPT.V.XTNSIZE# IN PROCEDURE READ_USERS
      7184**DCL      7184--REDEF    7186--REDEF
CP_LIMREC
      5885**DCL      6195<<ASSIGN   7556--ASSIGN
CP_LIMREC.CUR_MAX.FBUL
      5898**DCL      6209<<ASSIGN
CP_LIMREC.CUR_MAX.MAXCORE
      5897**DCL      6197<<ASSIGN
CP_LIMREC.CUR_MAX.MAXTMPDP
      5903**DCL      6205<<ASSIGN
CP_LIMREC.CUR_MAX.MRT
      5904**DCL      6211<<ASSIGN
CP_LIMREC.CUR_MAX.PRDPRM
      5902**DCL      6207<<ASSIGN
CP_LIMREC.CUR_MAX.REMCPO
      5900**DCL      6201<<ASSIGN
CP_LIMREC.CUR_MAX.REMDO
      5901**DCL      6203<<ASSIGN
CP_LIMREC.CUR_MAX.REMLO
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:104  
      5899**DCL      6199<<ASSIGN
CP_LIMREC.USER_MAX.FBUL
      5888**DCL      6208<<ASSIGN
CP_LIMREC.USER_MAX.MAXCORE
      5887**DCL      6196<<ASSIGN
CP_LIMREC.USER_MAX.MAXTMPDP
      5893**DCL      6204<<ASSIGN
CP_LIMREC.USER_MAX.MRT
      5894**DCL      6210<<ASSIGN
CP_LIMREC.USER_MAX.PRDPRM
      5892**DCL      6206<<ASSIGN
CP_LIMREC.USER_MAX.REMCPO
      5890**DCL      6200<<ASSIGN
CP_LIMREC.USER_MAX.REMDO
      5891**DCL      6202<<ASSIGN
CP_LIMREC.USER_MAX.REMLO
      5889**DCL      6198<<ASSIGN
CWRSYSLOG IN PROCEDURE SECLOG
      6702**DCL      6737>>ASSIGN
CWRSYSLOG.V IN PROCEDURE SECLOG
      6702**DCL      6702--DCLINIT
ES$SECLOG IN PROCEDURE SECLOG
      6427**DCL      6704--DCLINIT  6723<<ASSIGN   6738--ASSIGN
ES$SECLOG.ACCN IN PROCEDURE SECLOG
      6460**DCL      6727<<ASSIGN
ES$SECLOG.FACCN IN PROCEDURE SECLOG
      6468**DCL      6472--REDEF
ES$SECLOG.FILE IN PROCEDURE SECLOG
      6628**DCL      6659--REDEF
ES$SECLOG.GRANTED IN PROCEDURE SECLOG
      6434**DCL      6730<<ASSIGN
ES$SECLOG.LOGON IN PROCEDURE SECLOG
      6517**DCL      6529--REDEF
ES$SECLOG.MODE IN PROCEDURE SECLOG
      6438**DCL      6724<<ASSIGN
ES$SECLOG.PASSWORD IN PROCEDURE SECLOG
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:105  
      6472**DCL      6732<<ASSIGN
ES$SECLOG.PPRIV IN PROCEDURE SECLOG
      6503**DCL      6734<<ASSIGN
ES$SECLOG.PRIV IN PROCEDURE SECLOG
      6496**DCL      6733<<ASSIGN
ES$SECLOG.REASON IN PROCEDURE SECLOG
      6429**DCL      6729<<ASSIGN
ES$SECLOG.SYSID IN PROCEDURE SECLOG
      6457**DCL      6725<<ASSIGN
ES$SECLOG.UNAME IN PROCEDURE SECLOG
      6464**DCL      6728<<ASSIGN
ES$SECLOG.USER IN PROCEDURE SECLOG
      6453**DCL      6726<<ASSIGN
F$DCB.ACTPOS
      5974**DCL      5974--REDEF
F$DCB.ARS#
      5948**DCL      5948--REDEF
F$DCB.ATTR
      5967**DCL      5968--REDEF
F$DCB.BORROW
      5982**DCL      5982--REDEF    5982--REDEF    5982--REDEF
F$DCB.DCBNAME.L
      5996**DCL      5996--IMP-SIZ
F$DCB.EOMCHAR#
      5952**DCL      5952--REDEF
F$DCB.FLDID
      5977**DCL      5977--REDEF
F$DCB.FORM$
      5971**DCL      5971--REDEF
F$DCB.FSECT
      5987**DCL      5987--REDEF
F$DCB.FSN#
      5964**DCL      5964--REDEF    5964--REDEF    5965--REDEF
F$DCB.HEADER$
      5970**DCL      5970--REDEF
F$DCB.IXTNSIZE#
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:106  
      5968**DCL      5968--REDEF
F$DCB.LASTSTA$
      5957**DCL      5957--REDEF
F$DCB.LVL
      5983**DCL      5983--REDEF
F$DCB.NAME#.C
      5958**DCL      5958--REDEF
F$DCB.NOEOF
      5980**DCL      5980--REDEF
F$DCB.NRECS#
      5969**DCL      5969--REDEF
F$DCB.NRECX
      5988**DCL      5988--REDEF
F$DCB.OHDR
      5980**DCL      5980--REDEF
F$DCB.ORG#
      5963**DCL      5963--REDEF
F$DCB.PRECNO
      5986**DCL      5986--REDEF
F$DCB.RCSZ
      5992**DCL      5992--REDEF
F$DCB.RES#
      5959**DCL      5959--REDEF
F$DCB.SETX
      5971**DCL      5971--REDEF
F$DCB.TAB$
      5971**DCL      5971--REDEF
F$DCB.TDA
      5985**DCL      5986--REDEF
F$DCB.WSN#
      5959**DCL      5959--REDEF
FILE_ACCT IN PROCEDURE READ_USERS
      6788**DCL      6883--DCLINIT
FPT
      5584**DCL        10--PROC     6049--ENTRY    6065<>CALL     6084<>CALL     6315<>CALL     7564--ASSIGN
FPT.ACCN
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:107  
      5584**DCL      6114>>ASSIGN   6727>>ASSIGN
FPT.FLAGS.BADPW
      5587**DCL      6077>>IF
FPT.FLAGS.CHECKPW
      5587**DCL      6068>>IF
FPT.FLAGS.DO_ACCOUNTING
      5585**DCL      6098>>IF
FPT.FLAGS.SCRAMBLED
      5586**DCL      6053>>IF       6056<<ASSIGN
FPT.FLAGS.STUFF_JIT
      5585**DCL      6106>>IF
FPT.L
      5584**DCL      5592--IMP-SIZ  6058>>IF
FPT.PASS
      5588**DCL      5588--REDEF    6054>>ASSIGN   6055<>CALL     6069>>IF
FPT.PSWB
      5588**DCL      6053>>IF       6070>>IF       6077>>IF
FPT.RESPONSE
      5588**DCL      6051<<ASSIGN   6078<<ASSIGN   6094<<ASSIGN   6103<<ASSIGN   6229<<ASSIGN   6293<<ASSIGN
      6307<<ASSIGN   6321<<ASSIGN
FPT.USER
      5585**DCL      6115>>ASSIGN   6728>>ASSIGN
FPT$ENQ_USERS IN PROCEDURE READ_USERS
      7475**DCL      7494<<ASSIGN   7495--ASSIGN   7498<>CALL
FPT$ENQ_USERS.RNAME_ IN PROCEDURE READ_USERS
      7475**DCL      7497<<ASSIGN
FPT$ENQ_USERS.V IN PROCEDURE READ_USERS
      7476**DCL      7495--ASSIGN
FPT$ENQ_USERS.V.DCB# IN PROCEDURE READ_USERS
      7476**DCL      7496<<ASSIGN
FPT$GETUSERS IN PROCEDURE READ_USERS
      7409**DCL      7535<<ASSIGN   7536--ASSIGN   7538<>CALL
FPT$GETUSERS.DCBNUM_ IN PROCEDURE READ_USERS
      7409**DCL      7537<<ASSIGN
FPT$GETUSERS.V IN PROCEDURE READ_USERS
      7410**DCL      7536--ASSIGN
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:108  
FPT$READ IN PROCEDURE READ_USERS
      7295**DCL      7504<<ASSIGN   7508--ASSIGN   7509<>CALL
FPT$READ.BUF_ IN PROCEDURE READ_USERS
      7297**DCL      7505<<ASSIGN
FPT$READ.KEY_ IN PROCEDURE READ_USERS
      7295**DCL      7506<<ASSIGN
FPT$READ.STATION_ IN PROCEDURE READ_USERS
      7298**DCL      7299--REDEF
FPT$READ.V IN PROCEDURE READ_USERS
      7299**DCL      7508--ASSIGN
FPT$READ.V.DCB# IN PROCEDURE READ_USERS
      7299**DCL      7507<<ASSIGN
FPT$READ.V.DVBYTE.REREAD# IN PROCEDURE READ_USERS
      7310**DCL      7310--REDEF
FPT$READ.V.INDX# IN PROCEDURE READ_USERS
      7308**DCL      7308--REDEF
FPT$RELUSERS IN PROCEDURE READ_USERS
      7440**DCL      7582<<ASSIGN   7584--ASSIGN   7585<>CALL
FPT$RELUSERS.V IN PROCEDURE READ_USERS
      7440**DCL      7584--ASSIGN
FPT$RELUSERS.V.DCB# IN PROCEDURE READ_USERS
      7440**DCL      7583<<ASSIGN
FPT$TIME IN PROCEDURE GETTIME
      7626**DCL      7639<<ASSIGN   7643<>CALL
FPT$TIME.TSTAMP_ IN PROCEDURE GETTIME
      7629**DCL      7640<<ASSIGN
FPT$TIME.V IN PROCEDURE GETTIME
      7630**DCL      7641--ASSIGN
FPT$TIME.V_ IN PROCEDURE GETTIME
      7626**DCL      7641<<ASSIGN
FPT_ENQ_USERS IN PROCEDURE READ_USERS
      7456**DCL      7494>>ASSIGN
FPT_ENQ_USERS.V IN PROCEDURE READ_USERS
      7457**DCL      7456--DCLINIT
FPT_GETUSERS IN PROCEDURE READ_USERS
      7393**DCL      7535>>ASSIGN
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:109  
FPT_GETUSERS.V IN PROCEDURE READ_USERS
      7394**DCL      7393--DCLINIT
FPT_RELUSERS IN PROCEDURE READ_USERS
      7425**DCL      7582>>ASSIGN
FPT_RELUSERS.V IN PROCEDURE READ_USERS
      7425**DCL      7425--DCLINIT
FPT_TIME IN PROCEDURE GETTIME
      7606**DCL      7639>>ASSIGN
FPT_TIME.V IN PROCEDURE GETTIME
      7610**DCL      7606--DCLINIT
FPT_WRSYSLOG IN PROCEDURE SECLOG
      6717**DCL      6737<<ASSIGN   6741<>CALL
FPT_WRSYSLOG.ENTRY_ IN PROCEDURE SECLOG
      6717**DCL      6738<<ASSIGN
GETTIME
      7590**PROC     6186--CALL
HLP_NAME IN PROCEDURE READ_USERS
      6978**DCL      7524--ASSIGN
LET_BANNER_RESET
      6034**DCL      6029--DCLINIT
LIMIT_KEY IN PROCEDURE READ_USERS
      7036**DCL      7557--ASSIGN
LOGRSN
      5936**DCL      6060<<ASSIGN   6067<<ASSIGN   6071<<ASSIGN   6076>>IF       6082>>IF       6087>>IF
      6093>>IF       6729>>ASSIGN   6730>>IF       6731>>IF
M$CLOSE
      3762**DCL-ENT  7579--CALL
M$ENQ
      3828**DCL-ENT  7498--CALL
M$GETDCB
      3768**DCL-ENT  7538--CALL
M$OPEN
      3762**DCL-ENT  7544--CALL
M$READ
      3763**DCL-ENT  7509--CALL
M$RELDCB
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:110  
      3768**DCL-ENT  7585--CALL
M$TIME
      3829**DCL-ENT  7643--CALL
M$WRITE
      3763**DCL-ENT  7569--CALL
M$WRSYSLOG
      3811**DCL-ENT  6741--CALL
M$XXX
      3774**DCL-ENT  7551--CALL
M$YC
      3776**DCL-ENT  6218--CALL
MASTER_ACCN IN PROCEDURE BUDGET
      6251**DCL      6302>>DOWHILE
MASTER_ACCT IN PROCEDURE BUDGET
      6250**DCL      6251--REDEF    6301<<ASSIGN   6303<>CALL     6312<<ASSIGN
MODE
      5939**DCL      6059<<ASSIGN   6117>>ASSIGN   6122>>ASSIGN   6123>>ASSIGN   6124>>IF       6124>>ASSIGN
      6134>>ASSIGN   6136>>IF       6139>>ASSIGN   6140>>IF       6143>>ASSIGN   6144>>IF       6147>>ASSIGN
      6148>>IF       6151>>ASSIGN   6152>>ASSIGN   6155>>ASSIGN   6156>>ASSIGN   6157>>ASSIGN   6167>>ASSIGN
      6172>>ASSIGN   6173>>ASSIGN   6174>>ASSIGN   6196>>ASSIGN   6198>>ASSIGN   6200>>ASSIGN   6202>>ASSIGN
      6204>>ASSIGN   6206>>ASSIGN   6208>>ASSIGN   6724>>ASSIGN   6752>>ASSIGN   6753>>ASSIGN
NODCB IN PROCEDURE READ_USERS
      7548**LABEL    7538--CALLALT
NODCB2 IN PROCEDURE READ_USERS
      7586**LABEL    7585--CALLALT
NONE_NAME IN PROCEDURE BUDGET
      6277**DCL      6279--REDEF
NO_MACCOUNT IN PROCEDURE BUDGET
      6279**DCL      6302>>DOWHILE
OPEN$USERS_FPT IN PROCEDURE READ_USERS
      7105**DCL      7517<<ASSIGN   7523<<ASSIGN   7530<<ASSIGN   7541--ASSIGN   7544<>CALL
OPEN$USERS_FPT.ACSVEH_ IN PROCEDURE READ_USERS
      7107**DCL      7108--REDEF
OPEN$USERS_FPT.ALTKEYS_ IN PROCEDURE READ_USERS
      7113**DCL      7114--REDEF    7114--REDEF
OPEN$USERS_FPT.HDR_ IN PROCEDURE READ_USERS
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:111  
      7112**DCL      7113--REDEF
OPEN$USERS_FPT.NAME_ IN PROCEDURE READ_USERS
      7106**DCL      7524<<ASSIGN   7531<<ASSIGN
OPEN$USERS_FPT.TAB_ IN PROCEDURE READ_USERS
      7111**DCL      7112--REDEF
OPEN$USERS_FPT.UHL_ IN PROCEDURE READ_USERS
      7105**DCL      7106--REDEF    7106--REDEF
OPEN$USERS_FPT.V IN PROCEDURE READ_USERS
      7114**DCL      7541--ASSIGN
OPEN$USERS_FPT.V.DCB# IN PROCEDURE READ_USERS
      7114**DCL      7540<<ASSIGN
OPEN$USERS_FPT.V.FSN# IN PROCEDURE READ_USERS
      7145**DCL      7145--REDEF    7145--REDEF
OPEN$USERS_FPT.WSN_ IN PROCEDURE READ_USERS
      7111**DCL      7111--REDEF
OPEN_ERR IN PROCEDURE READ_USERS
      7545**LABEL    7544--CALLALT
OPEN_HLP IN PROCEDURE READ_USERS
      7521**ENTRY    6064--CALL
OPEN_IT IN PROCEDURE READ_USERS
      7531**LABEL    7518--GOTO     7525--GOTO
OPEN_STAR_S IN PROCEDURE READ_USERS
      7528**ENTRY    6194--CALL
OPEN_USERS IN PROCEDURE READ_USERS
      7515**ENTRY    6083--CALL
OPEN_USERS_ERR
      6211**LABEL    6064--CALLALT  6083--CALLALT
OPEN_USERS_FPT IN PROCEDURE READ_USERS
      6878**DCL      7517>>ASSIGN   7523>>ASSIGN   7530>>ASSIGN
OPEN_USERS_FPT.ACSVEH_ IN PROCEDURE READ_USERS
      6880**DCL      6881--REDEF
OPEN_USERS_FPT.ALTKEYS_ IN PROCEDURE READ_USERS
      6886**DCL      6887--REDEF    6887--REDEF
OPEN_USERS_FPT.HDR_ IN PROCEDURE READ_USERS
      6885**DCL      6886--REDEF
OPEN_USERS_FPT.TAB_ IN PROCEDURE READ_USERS
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:112  
      6884**DCL      6885--REDEF
OPEN_USERS_FPT.UHL_ IN PROCEDURE READ_USERS
      6878**DCL      6879--REDEF    6879--REDEF
OPEN_USERS_FPT.V IN PROCEDURE READ_USERS
      6887**DCL      6878--DCLINIT
OPEN_USERS_FPT.V.FSN# IN PROCEDURE READ_USERS
      6918**DCL      6918--REDEF    6918--REDEF
OPEN_USERS_FPT.WSN_ IN PROCEDURE READ_USERS
      6884**DCL      6884--REDEF
PLAINPW
      5937**DCL      6052<<ASSIGN   6054<<ASSIGN   6732>>ASSIGN
READ_ERR IN PROCEDURE READ_USERS
      7512**LABEL    7498--CALLALT  7509--CALLALT
READ_USERS
      6759**PROC     6065--CALL     6084--CALL     6303--CALL
READ_USERS_ERR
      6211**LABEL    6084--CALLALT  6188--CALLALT
READ_USERS_ERR IN PROCEDURE BUDGET
      6321**LABEL    6303--CALLALT  6315--CALLALT
READ_USERS_FPT IN PROCEDURE READ_USERS
      7255**DCL      7504>>ASSIGN
READ_USERS_FPT.STATION_ IN PROCEDURE READ_USERS
      7258**DCL      7259--REDEF
READ_USERS_FPT.V IN PROCEDURE READ_USERS
      7259**DCL      7255--DCLINIT
READ_USERS_FPT.V.DVBYTE.REREAD# IN PROCEDURE READ_USERS
      7270**DCL      7270--REDEF
READ_USERS_FPT.V.INDX# IN PROCEDURE READ_USERS
      7268**DCL      7268--REDEF
REREAD_USERS IN PROCEDURE READ_USERS
      7500**ENTRY    6315--CALL
RESET_BANNER
      6029**DCL      6218<>CALL
RESET_BANNER.V
      6030**DCL      6029--DCLINIT
SAVEPRIV IN PROCEDURE READ_USERS
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:113  
      7484**DCL      7542<<ASSIGN   7545>>ASSIGN   7548>>ASSIGN
SAVEPRIV IN PROCEDURE SECLOG
      6721**DCL      6739<<ASSIGN   6742>>ASSIGN
SCRAMBLED_BITS
      6041**DCL      6043--REDEF
SCRAMBLED_BLANKS
      6043**DCL      6070>>IF
SECLOG
      6326**PROC     6092--CALL
SET_LAST_LOGON_TIME
      6747**PROC     6187--CALL
STAR_S_NAME IN PROCEDURE READ_USERS
      7007**DCL      7531--ASSIGN
TEMP IN PROCEDURE BUDGET
      6248**DCL      6290<<ASSIGN   6291>>IF       6296>>ASSIGN   6305<<ASSIGN   6306>>IF       6310>>ASSIGN
TIME IN PROCEDURE GETTIME
      7592**DCL      7590--PROC     7640--ASSIGN
TIME_ERR IN PROCEDURE GETTIME
      7641**LABEL    7643--CALLALT
UMAX
      5932**DCL      6286<<ASSIGN   6296<<ASSIGN   6296>>ASSIGN   6310<<ASSIGN   6310>>ASSIGN   6314>>ASSIGN
USERS_KEY IN PROCEDURE READ_USERS
      6796**DCL      6759--PROC     7497--ASSIGN   7500--ENTRY    7506--ASSIGN
USERS_NAME IN PROCEDURE READ_USERS
      6949**DCL      6879--DCLINIT
VEC.P$ IN PROCEDURE READ_USERS
      7482**DCL      7495<<ASSIGN   7508<<ASSIGN   7536<<ASSIGN   7541<<ASSIGN   7567<<ASSIGN   7578<<ASSIGN
      7584<<ASSIGN
WRITE$USERS_FPT IN PROCEDURE READ_USERS
      7367**DCL      7555<<ASSIGN   7562<<ASSIGN   7567--ASSIGN   7569<>CALL
WRITE$USERS_FPT.BUF_ IN PROCEDURE READ_USERS
      7367**DCL      7556<<ASSIGN   7563<<ASSIGN
WRITE$USERS_FPT.KEY_ IN PROCEDURE READ_USERS
      7367**DCL      7557<<ASSIGN   7564<<ASSIGN
WRITE$USERS_FPT.STATION_ IN PROCEDURE READ_USERS
      7369**DCL      7369--REDEF
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:114  
WRITE$USERS_FPT.V IN PROCEDURE READ_USERS
      7370**DCL      7567--ASSIGN
WRITE$USERS_FPT.V.DCB# IN PROCEDURE READ_USERS
      7370**DCL      7568<<ASSIGN
WRITE$USERS_FPT.V.DVBYTE.VFC# IN PROCEDURE READ_USERS
      7376**DCL      7376--REDEF
WRITE_ERR IN PROCEDURE READ_USERS
      7572**LABEL    7569--CALLALT
WRITE_IT IN PROCEDURE READ_USERS
      7564**LABEL    7558--GOTO
WRITE_STAR_S IN PROCEDURE READ_USERS
      7554**ENTRY    6214--CALL
WRITE_USERS IN PROCEDURE READ_USERS
      7561**ENTRY    6089--CALL     6188--CALL
WRITE_USERS_FPT IN PROCEDURE READ_USERS
      7335**DCL      7555>>ASSIGN   7562>>ASSIGN
WRITE_USERS_FPT.STATION_ IN PROCEDURE READ_USERS
      7337**DCL      7337--REDEF
WRITE_USERS_FPT.V IN PROCEDURE READ_USERS
      7338**DCL      7335--DCLINIT
WRITE_USERS_FPT.V.DVBYTE.VFC# IN PROCEDURE READ_USERS
      7344**DCL      7344--REDEF
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:115  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:116  
              MINI UREF LISTING

ARS    5928**DCL
B_POINTER    3695**DCL-ENT
DCB$    5929**DCL
DO_STARS    6186**LABEL
ERR_CODE    5998**DCL
I    5931**DCL
KEY$    5930**DCL
M$ACCT    3779**DCL-ENT
M$ACTIVATE    3782**DCL-ENT
M$ALIB    3775**DCL-ENT
M$ASUSER    3777**DCL-ENT
M$ATTACH    3784**DCL-ENT
M$BADPP    3802**DCL-ENT
M$CGCTL    3783**DCL-ENT
M$CGINFO    3783**DCL-ENT
M$CHECK    3764**DCL-ENT
M$CHGUNIT    3822**DCL-ENT
M$CLRSTK    3820**DCL-ENT
M$CMDVAR    3831**DCL-ENT
M$CONFIG    3792**DCL-ENT
M$CORRES    3767**DCL-ENT
M$CPEXIT    3776**DCL-ENT
M$CVM    3800**DCL-ENT
M$CVOL    3765**DCL-ENT
M$DCLFLD    3792**DCL-ENT
M$DEACTIVATE    3782**DCL-ENT
M$DELREC    3764**DCL-ENT
M$DEQ    3829**DCL-ENT
M$DETACH    3784**DCL-ENT
M$DEVICE    3766**DCL-ENT
M$DISPLAY    3829**DCL-ENT
M$DISPRES    3769**DCL-ENT
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:117  
M$DLIB    3775**DCL-ENT
M$DRIBBLE    3792**DCL-ENT
M$DRTN    3820**DCL-ENT
M$DSUSER    3777**DCL-ENT
M$EOM    3787**DCL-ENT
M$ERASE    3793**DCL-ENT
M$ERR    3774**DCL-ENT
M$ERRMSG    3825**DCL-ENT
M$EVENT    3817**DCL-ENT
M$EXHUME    3826**DCL-ENT
M$EXIT    3774**DCL-ENT
M$EXTEND    3766**DCL-ENT
M$FDP    3798**DCL-ENT
M$FDS    3797**DCL-ENT
M$FEBOOT    3790**DCL-ENT
M$FECTL    3791**DCL-ENT
M$FEDUMP    3790**DCL-ENT
M$FID    3825**DCL-ENT
M$FINDPROC    3779**DCL-ENT
M$FSUSER    3777**DCL-ENT
M$FVP    3799**DCL-ENT
M$FWCG    3783**DCL-ENT
M$GBPL    3803**DCL-ENT
M$GDDL    3799**DCL-ENT
M$GDP    3798**DCL-ENT
M$GDS    3797**DCL-ENT
M$GETMOUSE    3808**DCL-ENT
M$GETPM    3809**DCL-ENT
M$GJOB    3827**DCL-ENT
M$GLINEATTR    3787**DCL-ENT
M$GOODPP    3802**DCL-ENT
M$GPLATEN    3795**DCL-ENT
M$GPROMPT    3794**DCL-ENT
M$GTRMATTR    3788**DCL-ENT
M$GTRMCTL    3786**DCL-ENT
M$GTRMTAB    3789**DCL-ENT
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:118  
M$GVP    3798**DCL-ENT
M$HELP    3825**DCL-ENT
M$INT    3817**DCL-ENT
M$INTRTN    3778**DCL-ENT
M$IOQ    3813**DCL-ENT
M$JOBSTATS    3827**DCL-ENT
M$KEYIN    3767**DCL-ENT
M$LDEV    3762**DCL-ENT
M$LDTRC    3775**DCL-ENT
M$LIMIT    3768**DCL-ENT
M$LINES    3767**DCL-ENT
M$LINK    3774**DCL-ENT
M$MADMUCK    3770**DCL-ENT
M$MAKUSER    3801**DCL-ENT
M$MBS    3769**DCL-ENT
M$MDFFLD    3793**DCL-ENT
M$MERC    3818**DCL-ENT
M$MERCS    3819**DCL-ENT
M$MIRROR    3813**DCL-ENT
M$MONINFO    3830**DCL-ENT
M$MPL    3803**DCL-ENT
M$NODEINFO    3794**DCL-ENT
M$NXTUSR    3828**DCL-ENT
M$OCMSG    3826**DCL-ENT
M$OLAY    3774**DCL-ENT
M$PAS    3803**DCL-ENT
M$PATHCON    3826**DCL-ENT
M$PDS    3797**DCL-ENT
M$PFIL    3764**DCL-ENT
M$PLATEN    3788**DCL-ENT
M$PRECORD    3766**DCL-ENT
M$PROCNAME    3779**DCL-ENT
M$PROFILE    3790**DCL-ENT
M$PROMPT    3786**DCL-ENT
M$RACST    3770**DCL-ENT
M$RDSYSLOG    3811**DCL-ENT
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:119  
M$RELRES    3769**DCL-ENT
M$RELSTARF    3771**DCL-ENT
M$REM    3771**DCL-ENT
M$RENV    3818**DCL-ENT
M$REQUIRE    3770**DCL-ENT
M$RETRY    3819**DCL-ENT
M$RETRYS    3819**DCL-ENT
M$REW    3765**DCL-ENT
M$RLSFLD    3793**DCL-ENT
M$RPRIV    3821**DCL-ENT
M$RSPP    3800**DCL-ENT
M$RSWITCH    3822**DCL-ENT
M$RUE    3828**DCL-ENT
M$SAD    3801**DCL-ENT
M$SAVE    3777**DCL-ENT
M$SCON    3778**DCL-ENT
M$SCREECH    3776**DCL-ENT
M$SENV    3818**DCL-ENT
M$SETFMA    3762**DCL-ENT
M$SETFP    3791**DCL-ENT
M$SINPUT    3789**DCL-ENT
M$SLCFLD    3794**DCL-ENT
M$SMOUSE    3808**DCL-ENT
M$SMPRT    3800**DCL-ENT
M$SPRIV    3821**DCL-ENT
M$SSC    3801**DCL-ENT
M$SSWITCH    3821**DCL-ENT
M$STATE    3830**DCL-ENT
M$STD    3802**DCL-ENT
M$STIMER    3816**DCL-ENT
M$STLPP    3799**DCL-ENT
M$STRAP    3816**DCL-ENT
M$STRMATTR    3788**DCL-ENT
M$STRMCTL    3786**DCL-ENT
M$STRMTAB    3789**DCL-ENT
M$SYMBIO    3827**DCL-ENT
PL6.E3A0      #001=XSL$CHAM File=XSL$CHAM.:TCA2TSI                               SUN 11/16/97 14:27 Page:120  
M$SYSCON    3813**DCL-ENT
M$SYSID    3831**DCL-ENT
M$TDCLOSE    3812**DCL-ENT
M$TDIO    3812**DCL-ENT
M$TDOPEN    3811**DCL-ENT
M$TDREQCPU    3812**DCL-ENT
M$TEMPWROC    3806**DCL-ENT
M$TRAP    3816**DCL-ENT
M$TRMISC    3791**DCL-ENT
M$TRMPRG    3787**DCL-ENT
M$TRTN    3820**DCL-ENT
M$TRUNC    3763**DCL-ENT
M$TTIMER    3816**DCL-ENT
M$UC    3786**DCL
M$UMPL    3803**DCL-ENT
M$UNFID    3825**DCL-ENT
M$UNLATCH    3782**DCL-ENT
M$UNSHARE    3779**DCL-ENT
M$USRFIELD    3822**DCL-ENT
M$VIRTUAL    3797**DCL-ENT
M$WAIT    3820**DCL-ENT
M$WEOF    3765**DCL-ENT
M$XCON    3817**DCL-ENT
M$XCONRTN    3778**DCL-ENT
M$XEQTIME    3830**DCL-ENT
M$XFLUSH    3771**DCL-ENT
M$XMOUSE    3808**DCL-ENT
RE_BUDGET    5938**DCL
SET_USER_ID    6049**ENTRY
SYS_UMAX    6039**DCL
TEMP_BIT    5935**DCL
UACCUM    5933**DCL
UBKACC    5934**DCL
USER_OK    6106**LABEL
XSL$CHAM      10**PROC
