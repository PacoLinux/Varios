VERSION E05

PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:1    
        1        1        /*M* VXD$FLST - processes a file list     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=6,IND=4,CSU=2,EXM=0,ECU=2,MOC,DCI=4,CRT=4,CTI=8    */
        8        8        /*F*  NAME:       VXD$FLST
        9        9              PURPOSE:    Process a file list
       10       10              DESCRIPTION:
       11       11              Processes a file list structure produced by X$PARSE, building a
       12       12              linked list of VX$LST elements ( a VX$LST element is generated for
       13       13              each file in the list) and returns a pointer to the start of the list.
       14       14        */
       15       15
       16       16        VXD$FLST:
       17       17              PROC( FIRST_P$, LAST_P$, OB_P$, TYPE, SUB_TYPE, FILE$ );
       18       18        /*
       19       19                          Include files
       20       20        */
       21       21        %INCLUDE VX_INC_C;
       22    16215        %VX$LST;

             16228    1   /*******************************************************************************
             16229    1   *                                                                              *
             16230    1   *                          VX$LST                                                 *
             16231    1   *                                                                              *
             16232    1   *******************************************************************************/

             16237    1   DCL 1 VX$LST                          ALIGNED BASED,
             16238    1         2 LINK$        PTR,               /* Link to next item                  */
             16239    1         2 TYPE         UBIN( 18) UNAL,    /* Type                               */
             16240    1         2 SUB_TYPE     UBIN( 18) UNAL,    /* Sub-type                           */
             16241    1         2 OBJECT_NAME$ PTR,               /* Pointer to object unit name        */
             16242    1         2 PRIOR$ REDEF OBJECT_NAME$ PTR,  /* Pointer to prior element in list   */
             16243    1         2 SC_HEAD$     PTR,               /* Head pointer to section link list  */
             16244    1         2 LIBSRCH$ REDEF SC_HEAD$ PTR,    /* Pointer to account list for library*/
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:2    
             16245    1         2 SC_TAIL$     PTR,               /* Tail pointer to section link list  */
             16246    1         2 LIB REDEF SC_TAIL$,             /* Used only by UNSAT library files   */
             16247    1           3 USED UBIN HALF UNAL,          /* 1 => library file used, 0=>not used*/
             16248    1           3 NEEDED UBIN HALF UNAL,   /* 1 => library file needed, 0=>not needed*/
             16249    1         2 P,
             16250    1           3 NAME_       ALIGNED,
             16251    1             4 BOUND      UBIN(20)  UNAL,
             16252    1             4 FLAGSV     UBIN(11)  UNAL,
             16253    1             4 *          BIT(5)    UNAL,
             16254    1             4 NAME$      PTR,
             16255    1           3 ACCT_       ALIGNED,
             16256    1             4 BOUND      UBIN(20)  UNAL,
             16257    1             4 FLAGSV     UBIN(11)  UNAL,
             16258    1             4 *          BIT(5)    UNAL,
             16259    1             4 ACCT$      PTR,
             16260    1           3 PASS_       ALIGNED,
             16261    1             4 BOUND      UBIN(20)  UNAL,
             16262    1             4 FLAGSV     UBIN(11)  UNAL,
             16263    1             4 *          BIT(5)    UNAL,
             16264    1             4 PASS$      PTR,
             16265    1           3 SN_         ALIGNED,
             16266    1             4 BOUND      UBIN(20)  UNAL,
             16267    1             4 FLAGSV     UBIN(11)  UNAL,
             16268    1             4 *          BIT(5)    UNAL,
             16269    1             4 SN$        PTR,
             16270    1           3 WSN_        ALIGNED,
             16271    1             4 BOUND      UBIN(20)  UNAL,
             16272    1             4 FLAGSV     UBIN(11)  UNAL,
             16273    1             4 *          BIT(5)    UNAL,
             16274    1             4 WSN$       PTR,
             16275    1           3 B           ALIGNED,
             16276    1             4 RES        BIT(1)    UNAL,
             16277    1             4 ASN        BIT(1)    UNAL,
             16278    1             4 ACCT       BIT(1)    UNAL,
             16279    1             4 *          BIT(33)   UNAL,
             16280    1           3 RES         CHAR(4)   ALIGNED,
             16281    1           3 ASN         UBIN(36)  ALIGNED;
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:3    
       23    16284        %VX$WORD;

             16296    1   /*******************************************************************************
             16297    1   *                                                                              *
             16298    1   *                          VX$WORD                                                 *
             16299    1   *                                                                              *
             16300    1   *******************************************************************************/

             16305    1   DCL VX$WORD_A(0:0)       UBIN(36) ALIGNED    BASED PTR;
             16306    1   DCL VX$HALF_A(0:0)       UBIN(18) HALIGNED   BASED PTR;
             16307    1   DCL VX$BYTE_A(0:0)       UBIN( 9) CALIGNED   BASED PTR;
             16308    1   DCL VX$CHAR_A(0:0)       CHAR( 1) UNAL       BASED PTR;
             16309        /**/
             16310    1   DCL VX$WORD_SBIN_A(0:0)  SBIN WORD ALIGNED   BASED     PTR;
             16311    1   DCL VX$HALF_SBIN_A(0:0)  SBIN HALF HALIGNED  BASED     PTR;
             16312    1   DCL VX$BYTE_SBIN_A(0:0)  SBIN HALF CALIGNED  BASED     PTR;
             16313    1   DCL VX$BIT_A(0:0)        BIT(36)   ALIGNED   BASED     PTR;
       24    16316        %PARSE$OUT( NAME=O$B, STCLASS="BASED");
       25    16361        %P;

             16369    1   /*******************************************************************************
             16370    1   *                                                                              *
             16371    1   *                          PARAMETERS                                              *
             16372    1   *                                                                              *
             16373    1   *******************************************************************************/

       26    16377    1   DCL FIRST_P$        PTR       ALIGNED;
       27    16378    1   DCL LAST_P$         PTR       ALIGNED;
       28    16379    1   DCL OB_P$           PTR       ALIGNED;
       29    16380    1   DCL TYPE            UBIN(36)  ALIGNED;
       30    16381    1   DCL SUB_TYPE        UBIN(36)  ALIGNED;
       31    16382    1   DCL FILE$           PTR       ALIGNED;
       32    16383        %PTR;

             16391    1   /*******************************************************************************
             16392    1   *                                                                              *
             16393    1   *                          PTR                                                 *
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:4    
             16394    1   *                                                                              *
             16395    1   *******************************************************************************/

       33    16399    1   DCL LAST$           PTR       ALIGNED   AUTO;
       34    16400    1   DCL OB$             PTR       ALIGNED   AUTO;
       35    16401    1   DCL WHERE$          PTR       ALIGNED   AUTO;
       36    16402        %E;

             16410    1   /*******************************************************************************
             16411    1   *                                                                              *
             16412    1   *                          ENTRY                                                 *
             16413    1   *                                                                              *
             16414    1   *******************************************************************************/

       37    16418    1   DCL VXS$LST         ENTRY(6)  ALTRET;
       38    16419        %U;

             16427    1   /*******************************************************************************
             16428    1   *                                                                              *
             16429    1   *                          UBIN                                                 *
             16430    1   *                                                                              *
             16431    1   *******************************************************************************/

       39    16435    1   DCL I               UBIN(36)  ALIGNED   AUTO;
       40    16436    1   DCL STOP       UBIN(36)       ALIGNED   AUTO;
       41    16437        %EJECT;
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:5    
       42    16438        %BANNER(ARG=Begin  VXD$FLST);

             16446    1   /*******************************************************************************
             16447    1   *                                                                              *
             16448    1   *                          Begin  VXD$FLST                                         *
             16449    1   *                                                                              *
             16450    1   *******************************************************************************/

       43    16454    1         OB$   = OB_P$;
       44    16455                                            /* PARSE$OUT only allows for 511 sub-blocks,
       45    16456                                               so we have to use the word that precedes
       46    16457                                               it (which is the number of words for the
       47    16458                                               entire block) if we want to allow more
       48    16459                                               than 511 files in a file list.        */
       49    16460    1         STOP = PINCRW(OB$,-1)->VX$WORD_A(0) - SIZEW(O$B) - 1;
       50    16461    1         IF VX_IN_OVERLAY THEN
       51    16462    1             VX_NUM_UNIQUE_BREFS = VX_NUM_UNIQUE_BREFS + STOP + 1;
       52    16463    2         DO I = 0 TO STOP;
       53    16464    2             CALL VXS$LST( WHERE$, OB$->O$B.SUBLK$(I) -> O$B.SUBLK$(0) -> O$B.SUBLK$(0)
             16464                      ,
       54    16465    2                     TYPE, SUB_TYPE, FILE$, 0 );
       55    16466    2             IF I = 0 THEN FIRST_P$ = WHERE$;
       56    16467    2             ELSE LAST$ -> VX$LST.LINK$ = WHERE$;
       57    16468    2             LAST$ = WHERE$;
       58    16469    2            END;
       59    16470    1         LAST_P$ = LAST$;
       60    16471    1         VX_LAST_OU$ = LAST$;
       61    16472    1   END VXD$FLST;
       62    16473        %EOD;

PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:6    
--  Include file information  --

   F_DCB_D.:E05TOU  is referenced.
   VX_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VX_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   VX_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VX_MACRO_C.:E05TOU  is referenced.
   VX_PERR_C.:E05TOU  is referenced.
   VX_SUBS_C.:E05TOU  is referenced.
   VX_SWITCH_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VX_INC_C.:E05TOU  is referenced.
      No diagnostics issued in procedure VXD$FLST.

   Procedure VXD$FLST requires 55 words for executable code.
   Procedure VXD$FLST requires 20 words of local(AUTO) storage.

PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:7    

 Object Unit name= VXD$FLST                                   File name= VXD$FLST.:E05TOU
 UTS= JUL 30 '97 08:06:48.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none    96    140  VX_CONST_DCB
    2   Proc  even  none    55     67  VXD$FLST
    3  RoData even  none     1      1  VXD$FLST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        6  VXD$FLST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       6 VXS$LST
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:8    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VX_OU_HEAD                            VX_LAST_OU$
     VX_NUM_UNIQUE_BREFS                   VX_IN_OVERLAY                         VX_ERRORS
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:9    


        1        1        /*M* VXD$FLST - processes a file list     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=6,IND=4,CSU=2,EXM=0,ECU=2,MOC,DCI=4,CRT=4,CTI=8    */
        8        8        /*F*  NAME:       VXD$FLST
        9        9              PURPOSE:    Process a file list
       10       10              DESCRIPTION:
       11       11              Processes a file list structure produced by X$PARSE, building a
       12       12              linked list of VX$LST elements ( a VX$LST element is generated for
       13       13              each file in the list) and returns a pointer to the start of the list.
       14       14        */
       15       15
       16       16        VXD$FLST:
       17       17              PROC( FIRST_P$, LAST_P$, OB_P$, TYPE, SUB_TYPE, FILE$ );

     17  2 000000   000000 700200 xent  VXD$FLST     TSX0  ! X66_AUTO_N
         2 000001   000024 000006                    ZERO    20,6

       18       18        /*
       19       19                          Include files
       20       20        */
       21       21        %INCLUDE VX_INC_C;
       22    16215        %VX$LST;

             16228    1   /*******************************************************************************
             16229    1   *                                                                              *
             16230    1   *                          VX$LST                                                 *
             16231    1   *                                                                              *
             16232    1   *******************************************************************************/

             16237    1   DCL 1 VX$LST                          ALIGNED BASED,
             16238    1         2 LINK$        PTR,               /* Link to next item                  */
             16239    1         2 TYPE         UBIN( 18) UNAL,    /* Type                               */
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:10   
             16240    1         2 SUB_TYPE     UBIN( 18) UNAL,    /* Sub-type                           */
             16241    1         2 OBJECT_NAME$ PTR,               /* Pointer to object unit name        */
             16242    1         2 PRIOR$ REDEF OBJECT_NAME$ PTR,  /* Pointer to prior element in list   */
             16243    1         2 SC_HEAD$     PTR,               /* Head pointer to section link list  */
             16244    1         2 LIBSRCH$ REDEF SC_HEAD$ PTR,    /* Pointer to account list for library*/
             16245    1         2 SC_TAIL$     PTR,               /* Tail pointer to section link list  */
             16246    1         2 LIB REDEF SC_TAIL$,             /* Used only by UNSAT library files   */
             16247    1           3 USED UBIN HALF UNAL,          /* 1 => library file used, 0=>not used*/
             16248    1           3 NEEDED UBIN HALF UNAL,   /* 1 => library file needed, 0=>not needed*/
             16249    1         2 P,
             16250    1           3 NAME_       ALIGNED,
             16251    1             4 BOUND      UBIN(20)  UNAL,
             16252    1             4 FLAGSV     UBIN(11)  UNAL,
             16253    1             4 *          BIT(5)    UNAL,
             16254    1             4 NAME$      PTR,
             16255    1           3 ACCT_       ALIGNED,
             16256    1             4 BOUND      UBIN(20)  UNAL,
             16257    1             4 FLAGSV     UBIN(11)  UNAL,
             16258    1             4 *          BIT(5)    UNAL,
             16259    1             4 ACCT$      PTR,
             16260    1           3 PASS_       ALIGNED,
             16261    1             4 BOUND      UBIN(20)  UNAL,
             16262    1             4 FLAGSV     UBIN(11)  UNAL,
             16263    1             4 *          BIT(5)    UNAL,
             16264    1             4 PASS$      PTR,
             16265    1           3 SN_         ALIGNED,
             16266    1             4 BOUND      UBIN(20)  UNAL,
             16267    1             4 FLAGSV     UBIN(11)  UNAL,
             16268    1             4 *          BIT(5)    UNAL,
             16269    1             4 SN$        PTR,
             16270    1           3 WSN_        ALIGNED,
             16271    1             4 BOUND      UBIN(20)  UNAL,
             16272    1             4 FLAGSV     UBIN(11)  UNAL,
             16273    1             4 *          BIT(5)    UNAL,
             16274    1             4 WSN$       PTR,
             16275    1           3 B           ALIGNED,
             16276    1             4 RES        BIT(1)    UNAL,
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:11   
             16277    1             4 ASN        BIT(1)    UNAL,
             16278    1             4 ACCT       BIT(1)    UNAL,
             16279    1             4 *          BIT(33)   UNAL,
             16280    1           3 RES         CHAR(4)   ALIGNED,
             16281    1           3 ASN         UBIN(36)  ALIGNED;
       23    16284        %VX$WORD;

             16296    1   /*******************************************************************************
             16297    1   *                                                                              *
             16298    1   *                          VX$WORD                                                *
             16299    1   *                                                                              *
             16300    1   *******************************************************************************/

             16305    1   DCL VX$WORD_A(0:0)       UBIN(36) ALIGNED    BASED PTR;
             16306    1   DCL VX$HALF_A(0:0)       UBIN(18) HALIGNED   BASED PTR;
             16307    1   DCL VX$BYTE_A(0:0)       UBIN( 9) CALIGNED   BASED PTR;
             16308    1   DCL VX$CHAR_A(0:0)       CHAR( 1) UNAL       BASED PTR;
             16309        /**/
             16310    1   DCL VX$WORD_SBIN_A(0:0)  SBIN WORD ALIGNED   BASED     PTR;
             16311    1   DCL VX$HALF_SBIN_A(0:0)  SBIN HALF HALIGNED  BASED     PTR;
             16312    1   DCL VX$BYTE_SBIN_A(0:0)  SBIN HALF CALIGNED  BASED     PTR;
             16313    1   DCL VX$BIT_A(0:0)        BIT(36)   ALIGNED   BASED     PTR;
       24    16316        %PARSE$OUT( NAME=O$B, STCLASS="BASED");
       25    16361        %P;

             16369    1   /*******************************************************************************
             16370    1   *                                                                              *
             16371    1   *                          PARAMETERS                                             *
             16372    1   *                                                                              *
             16373    1   *******************************************************************************/

       26    16377    1   DCL FIRST_P$        PTR       ALIGNED;
       27    16378    1   DCL LAST_P$         PTR       ALIGNED;
       28    16379    1   DCL OB_P$           PTR       ALIGNED;
       29    16380    1   DCL TYPE            UBIN(36)  ALIGNED;
       30    16381    1   DCL SUB_TYPE        UBIN(36)  ALIGNED;
       31    16382    1   DCL FILE$           PTR       ALIGNED;
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:12   
       32    16383        %PTR;

             16391    1   /*******************************************************************************
             16392    1   *                                                                              *
             16393    1   *                          PTR                                                 *
             16394    1   *                                                                              *
             16395    1   *******************************************************************************/

       33    16399    1   DCL LAST$           PTR       ALIGNED   AUTO;
       34    16400    1   DCL OB$             PTR       ALIGNED   AUTO;
       35    16401    1   DCL WHERE$          PTR       ALIGNED   AUTO;
       36    16402        %E;

             16410    1   /*******************************************************************************
             16411    1   *                                                                              *
             16412    1   *                          ENTRY                                                 *
             16413    1   *                                                                              *
             16414    1   *******************************************************************************/

       37    16418    1   DCL VXS$LST         ENTRY(6)  ALTRET;
       38    16419        %U;

             16427    1   /*******************************************************************************
             16428    1   *                                                                              *
             16429    1   *                          UBIN                                                 *
             16430    1   *                                                                              *
             16431    1   *******************************************************************************/

       39    16435    1   DCL I               UBIN(36)  ALIGNED   AUTO;
       40    16436    1   DCL STOP       UBIN(36)       ALIGNED   AUTO;
       41    16437        %EJECT;
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:13   
       42    16438        %BANNER(ARG=Begin  VXD$FLST);

             16446    1   /*******************************************************************************
             16447    1   *                                                                              *
             16448    1   *                          Begin  VXD$FLST                                        *
             16449    1   *                                                                              *
             16450    1   *******************************************************************************/

       43    16454    1         OB$   = OB_P$;

  16454  2 000002   200005 470500                    LDP0    @OB_P$,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   200012 756100                    STQ     OB$,,AUTO

       44    16455                                            /* PARSE$OUT only allows for 511 sub-blocks,
       45    16456                                               so we have to use the word that precedes
       46    16457                                               it (which is the number of words for the
       47    16458                                               entire block) if we want to allow more
       48    16459                                               than 511 files in a file list.        */
       49    16460    1         STOP = PINCRW(OB$,-1)->VX$WORD_A(0) - SIZEW(O$B) - 1;

  16460  2 000005   200012 471500                    LDP1    OB$,,AUTO
         2 000006   177777 235100                    LDA     -1,,PR1
         2 000007   000005 135007                    SBLA    5,DL
         2 000010   200015 755100                    STA     STOP,,AUTO

       50    16461    1         IF VX_IN_OVERLAY THEN

  16461  2 000011   000000 234000 xsym               SZN     VX_IN_OVERLAY
         2 000012   000017 605000 2                  TPL     s:16463

       51    16462    1             VX_NUM_UNIQUE_BREFS = VX_NUM_UNIQUE_BREFS + STOP + 1;

  16462  2 000013   000000 236000 xsym               LDQ     VX_NUM_UNIQUE_BREFS
         2 000014   200015 036100                    ADLQ    STOP,,AUTO
         2 000015   000001 036007                    ADLQ    1,DL
         2 000016   000000 756000 xsym               STQ     VX_NUM_UNIQUE_BREFS
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:14   

       52    16463    2         DO I = 0 TO STOP;

  16463  2 000017   200014 450100                    STZ     I,,AUTO
         2 000020   000057 710000 2                  TRA     s:16469+2

       53    16464    2            CALL VXS$LST( WHERE$, OB$->O$B.SUBLK$(I) -> O$B.SUBLK$(0) -> O$B.SUBLK$(0)
             16464                      ,

  16464  2 000021   200012 470500                    LDP0    OB$,,AUTO
         2 000022   200014 720100                    LXL0    I,,AUTO
         2 000023   000003 471510                    LDP1    3,X0,PR0
         2 000024   100003 473500                    LDP3    3,,PR1
         2 000025   000000 236000 3                  LDQ     0
         2 000026   200010 235100                    LDA     @FILE$,,AUTO
         2 000027   200022 757100                    STAQ    STOP+5,,AUTO
         2 000030   200006 237100                    LDAQ    @TYPE,,AUTO
         2 000031   200020 757100                    STAQ    STOP+3,,AUTO
         2 000032   300003 631500                    EPPR1   3,,PR3
         2 000033   200017 451500                    STP1    STOP+2,,AUTO
         2 000034   200013 633500                    EPPR3   WHERE$,,AUTO
         2 000035   200016 453500                    STP3    STOP+1,,AUTO
         2 000036   200016 630500                    EPPR0   STOP+1,,AUTO
         2 000037   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000040   000000 701000 xent               TSX1    VXS$LST
         2 000041   000000 011000                    NOP     0

       54    16465    2                     TYPE, SUB_TYPE, FILE$, 0 );
       55    16466    2             IF I = 0 THEN FIRST_P$ = WHERE$;

  16466  2 000042   200014 235100                    LDA     I,,AUTO
         2 000043   000050 601000 2                  TNZ     s:16467

  16466  2 000044   200013 236100                    LDQ     WHERE$,,AUTO
         2 000045   200003 470500                    LDP0    @FIRST_P$,,AUTO
         2 000046   000000 756100                    STQ     0,,PR0
         2 000047   000053 710000 2                  TRA     s:16468
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:15   

       56    16467    2             ELSE LAST$ -> VX$LST.LINK$ = WHERE$;

  16467  2 000050   200013 236100                    LDQ     WHERE$,,AUTO
         2 000051   200011 470500                    LDP0    LAST$,,AUTO
         2 000052   000000 756100                    STQ     0,,PR0

       57    16468    2             LAST$ = WHERE$;

  16468  2 000053   200013 236100                    LDQ     WHERE$,,AUTO
         2 000054   200011 756100                    STQ     LAST$,,AUTO

       58    16469    2            END;

  16469  2 000055   000001 035007                    ADLA    1,DL
         2 000056   200014 755100                    STA     I,,AUTO
         2 000057   200015 236100                    LDQ     STOP,,AUTO
         2 000060   200014 116100                    CMPQ    I,,AUTO
         2 000061   000021 603000 2                  TRC     s:16464

       59    16470    1         LAST_P$ = LAST$;

  16470  2 000062   200011 236100                    LDQ     LAST$,,AUTO
         2 000063   200004 470500                    LDP0    @LAST_P$,,AUTO
         2 000064   000000 756100                    STQ     0,,PR0

       60    16471    1         VX_LAST_OU$ = LAST$;

  16471  2 000065   000000 756000 xsym               STQ     VX_LAST_OU$

       61    16472    1   END VXD$FLST;

  16472  2 000066   000000 702200 xent               TSX2  ! X66_ARET
       62    16473        %EOD;

PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:16   
--  Include file information  --

   F_DCB_D.:E05TOU  is referenced.
   VX_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VX_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   VX_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VX_MACRO_C.:E05TOU  is referenced.
   VX_PERR_C.:E05TOU  is referenced.
   VX_SUBS_C.:E05TOU  is referenced.
   VX_SWITCH_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VX_INC_C.:E05TOU  is referenced.
      No diagnostics issued in procedure VXD$FLST.
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:17   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w PTR         r     1 @FILE$                     3-0-0/w PTR         r     1 @FIRST_P$
     4-0-0/w PTR         r     1 @LAST_P$                   5-0-0/w PTR         r     1 @OB_P$
     7-0-0/w PTR         r     1 @SUB_TYPE                  6-0-0/w PTR         r     1 @TYPE
    *0-0-0/w PTR         r     1 FILE$                     *0-0-0/w PTR         r     1 FIRST_P$
    14-0-0/w UBIN        r     1 I                         11-0-0/w PTR         r     1 LAST$
    *0-0-0/w PTR         r     1 LAST_P$                   12-0-0/w PTR         r     1 OB$
    *0-0-0/w PTR         r     1 OB_P$                     15-0-0/w UBIN        r     1 STOP
    *0-0-0/w UBIN        r     1 SUB_TYPE                  *0-0-0/w UBIN        r     1 TYPE
    13-0-0/w PTR         r     1 WHERE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 VX_IN_OVERLAY              0-0-0/w PTR         r     1 VX_LAST_OU$
     0-0-0/w UBIN        r     1 VX_NUM_UNIQUE_BREFS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 O$B                        0-0-0/w STRC(648)   r     1 VX$LST
     0-0-0/w UBIN        r     1 VX$WORD_A(0:0)


   Procedure VXD$FLST requires 55 words for executable code.
   Procedure VXD$FLST requires 20 words of local(AUTO) storage.
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:18   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:19   
          MINI XREF LISTING

FILE$
     16382**DCL        16--PROC    16464<>CALL
FIRST_P$
     16377**DCL        16--PROC    16466<<ASSIGN
I
     16435**DCL     16463<<DOINDEX 16464>>CALL    16466>>IF
LAST$
     16399**DCL     16467>>ASSIGN  16468<<ASSIGN  16470>>ASSIGN  16471>>ASSIGN
LAST_P$
     16378**DCL        16--PROC    16470<<ASSIGN
O$B
     16322**DCL     16460--ASSIGN
O$B.SUBLK$
     16355**DCL     16464>>CALL    16464>>CALL    16464<>CALL
OB$
     16400**DCL     16454<<ASSIGN  16460>>ASSIGN  16464>>CALL
OB_P$
     16379**DCL        16--PROC    16454>>ASSIGN
STOP
     16436**DCL     16460<<ASSIGN  16462>>ASSIGN  16463>>DOINDEX
SUB_TYPE
     16381**DCL        16--PROC    16464<>CALL
TYPE
     16380**DCL        16--PROC    16464<>CALL
VX$LST.LINK$
     16238**DCL     16467<<ASSIGN
VX$LST.OBJECT_NAME$
     16241**DCL     16242--REDEF
VX$LST.SC_HEAD$
     16243**DCL     16244--REDEF
VX$LST.SC_TAIL$
     16245**DCL     16246--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:20   
VX$WORD_A
     16305**DCL     16460>>ASSIGN
VXS$LST
     16418**DCL-ENT 16464--CALL
VX_BIAS.A
     15065**DCL     15066--REDEF
VX_CBUF.CHARS_A
     14999**DCL     15000--REDEF
VX_CONST_DCB.ACTPOS
     16181**DCL     16181--REDEF
VX_CONST_DCB.ARS#
     16140**DCL     16140--REDEF
VX_CONST_DCB.ATTR#
     16170**DCL     16170--REDEF   16172--REDEF
VX_CONST_DCB.BORROW
     16192**DCL     16192--REDEF   16192--REDEF   16192--REDEF
VX_CONST_DCB.EOMCHAR#
     16147**DCL     16148--REDEF
VX_CONST_DCB.FLDID
     16184**DCL     16185--REDEF
VX_CONST_DCB.FORM$
     16176**DCL     16176--REDEF
VX_CONST_DCB.FSECT
     16199**DCL     16199--REDEF
VX_CONST_DCB.FSN#
     16166**DCL     16166--REDEF   16166--REDEF   16167--REDEF
VX_CONST_DCB.HEADER$
     16175**DCL     16176--REDEF
VX_CONST_DCB.IXTNSIZE#
     16172**DCL     16173--REDEF
VX_CONST_DCB.LASTSTA$
     16156**DCL     16156--REDEF
VX_CONST_DCB.LVL
     16193**DCL     16193--REDEF
VX_CONST_DCB.NAME#.C
     16156**DCL     16157--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:21   
VX_CONST_DCB.NOEOF
     16188**DCL     16188--REDEF
VX_CONST_DCB.NRECS#
     16173**DCL     16173--REDEF
VX_CONST_DCB.NRECX
     16200**DCL     16200--REDEF
VX_CONST_DCB.OHDR
     16189**DCL     16189--REDEF
VX_CONST_DCB.ORG#
     16164**DCL     16165--REDEF
VX_CONST_DCB.PRECNO
     16197**DCL     16197--REDEF
VX_CONST_DCB.RCSZ
     16205**DCL     16205--REDEF
VX_CONST_DCB.RES#
     16158**DCL     16158--REDEF
VX_CONST_DCB.SETX
     16177**DCL     16177--REDEF
VX_CONST_DCB.TAB$
     16176**DCL     16176--REDEF
VX_CONST_DCB.TDA
     16196**DCL     16197--REDEF
VX_CONST_DCB.WSN#
     16158**DCL     16159--REDEF
VX_EBUF.CHARS_A
     15588**DCL     15589--REDEF
VX_EFIELD1.CHARS
     15597**DCL     15598--REDEF
VX_EFIELD2.CHARS
     15601**DCL     15602--REDEF
VX_EFIELD3.CHARS
     15605**DCL     15606--REDEF
VX_EI_KEY_BUF.KEY
     15981**DCL     15982--REDEF
VX_ERRORS
     15042**DCL     15053--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:22   
VX_ERRORS.CONFLICT_A
     15048**DCL     15049--REDEF
VX_ERRORS.UNSAT_A
     15044**DCL     15045--REDEF
VX_IMAGE_DATA.CPAGE#_A
     14179**DCL     14180--REDEF
VX_IMAGE_DATA.NODE_A$
     14191**DCL     14192--REDEF
VX_IMAGE_DATA.START_A$
     14183**DCL     14184--REDEF
VX_IMAGE_DATA.STOP_A$
     14187**DCL     14188--REDEF
VX_IMAGE_DS3.CPAGE#_A
     14248**DCL     14249--REDEF
VX_IMAGE_DS3.NODE_A$
     14260**DCL     14261--REDEF
VX_IMAGE_DS3.START_A$
     14252**DCL     14253--REDEF
VX_IMAGE_DS3.STOP_A$
     14256**DCL     14257--REDEF
VX_IMAGE_DS4.CPAGE#_A
     14271**DCL     14272--REDEF
VX_IMAGE_DS4.NODE_A$
     14283**DCL     14284--REDEF
VX_IMAGE_DS4.START_A$
     14275**DCL     14276--REDEF
VX_IMAGE_DS4.STOP_A$
     14279**DCL     14280--REDEF
VX_IMAGE_DS5.CPAGE#_A
     14294**DCL     14295--REDEF
VX_IMAGE_DS5.NODE_A$
     14306**DCL     14307--REDEF
VX_IMAGE_DS5.START_A$
     14298**DCL     14299--REDEF
VX_IMAGE_DS5.STOP_A$
     14302**DCL     14303--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:23   
VX_IMAGE_DS6.CPAGE#_A
     14317**DCL     14318--REDEF
VX_IMAGE_DS6.NODE_A$
     14329**DCL     14330--REDEF
VX_IMAGE_DS6.START_A$
     14321**DCL     14322--REDEF
VX_IMAGE_DS6.STOP_A$
     14325**DCL     14326--REDEF
VX_IMAGE_DS7.CPAGE#_A
     14340**DCL     14341--REDEF
VX_IMAGE_DS7.NODE_A$
     14352**DCL     14353--REDEF
VX_IMAGE_DS7.START_A$
     14344**DCL     14345--REDEF
VX_IMAGE_DS7.STOP_A$
     14348**DCL     14349--REDEF
VX_IMAGE_DS8.CPAGE#_A
     14363**DCL     14364--REDEF
VX_IMAGE_DS8.NODE_A$
     14375**DCL     14376--REDEF
VX_IMAGE_DS8.START_A$
     14367**DCL     14368--REDEF
VX_IMAGE_DS8.STOP_A$
     14371**DCL     14372--REDEF
VX_IMAGE_PROC.CPAGE#_A
     14202**DCL     14203--REDEF
VX_IMAGE_PROC.NODE_A$
     14214**DCL     14215--REDEF
VX_IMAGE_PROC.START_A$
     14206**DCL     14207--REDEF
VX_IMAGE_PROC.STOP_A$
     14210**DCL     14211--REDEF
VX_IMAGE_ROS.CPAGE#_A
     14225**DCL     14226--REDEF
VX_IMAGE_ROS.NODE_A$
     14237**DCL     14238--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:24   
VX_IMAGE_ROS.START_A$
     14229**DCL     14230--REDEF
VX_IMAGE_ROS.STOP_A$
     14233**DCL     14234--REDEF
VX_IN_OVERLAY
     15027**DCL     16461>>IF
VX_LAST_OU$
     14979**DCL     16471<<ASSIGN
VX_M_VECTOR.F
     14030**DCL     14034--REDEF
VX_M_VECTOR_DP.F
     14065**DCL     14069--REDEF
VX_NUM_UNIQUE_BREFS
     15026**DCL     16462<<ASSIGN  16462>>ASSIGN
VX_O.ACCTN_A$
     15194**DCL     15195--REDEF
VX_O.DCB_MATCH_A$
     15203**DCL     15204--REDEF
VX_O.DCB_MATCH_HIT_A
     15209**DCL     15210--REDEF
VX_O.FIDN_A$
     15188**DCL     15189--REDEF
VX_O.FID_A$
     15180**DCL     15181--REDEF
VX_O.INCLUDE_A$
     15200**DCL     15201--REDEF
VX_O.MAP_A
     15174**DCL     15175--REDEF
VX_O.NODCB_A
     15231**DCL     15232--REDEF
VX_O.NUM_A
     15119**DCL     15121--REDEF
VX_O.OPT_A
     15219**DCL     15220--REDEF
VX_O.PRIV_A
     15135**DCL     15137--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:25   
VX_O.SIN_A
     15088**DCL     15089--REDEF
VX_O.TCB_A
     15215**DCL     15216--REDEF
VX_OD.ACCTN_A$
     15392**DCL     15393--REDEF
VX_OD.DCB_MATCH_A$
     15401**DCL     15402--REDEF
VX_OD.FIDN_A$
     15386**DCL     15387--REDEF
VX_OD.FID_A$
     15378**DCL     15379--REDEF
VX_OD.INCLUDE_A$
     15398**DCL     15399--REDEF
VX_OD.MAP_A
     15372**DCL     15373--REDEF
VX_OD.NODCB_A
     15416**DCL     15417--REDEF
VX_OD.NUM_A
     15319**DCL     15320--REDEF
VX_OD.PRIV_A
     15334**DCL     15335--REDEF
VX_OD.SIN_A
     15288**DCL     15289--REDEF
VX_OD.VECTOR_A$
     15407**DCL     15408--REDEF
VX_OL.MAX_A
     15263**DCL     15265--REDEF
VX_OL.MIN_A
     15248**DCL     15249--REDEF
VX_ON.ACCTN_A$
     15537**DCL     15539--REDEF
VX_ON.DCB_MATCH_A$
     15548**DCL     15550--REDEF
VX_ON.FIDN_A$
     15530**DCL     15532--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:26   
VX_ON.FID_A$
     15521**DCL     15523--REDEF
VX_ON.INCLUDE_A$
     15544**DCL     15546--REDEF
VX_ON.MAP_A
     15514**DCL     15516--REDEF
VX_ON.NODCB_A$
     15564**DCL     15565--REDEF
VX_ON.NUM_A
     15459**DCL     15461--REDEF
VX_ON.PRIV_A
     15475**DCL     15477--REDEF
VX_ON.SIN_A
     15427**DCL     15429--REDEF
VX_ON.VECTOR_A$
     15555**DCL     15556--REDEF
VX_OUHEAD.VERSION
     14874**DCL     14876--REDEF
VX_OU_HEAD
     14817**DCL     14856--REDEF
VX_OU_HEAD.REC_A
     14829**DCL     14832--REDEF
VX_O_KEY_BUF.FORM0
     14078**DCL     14081--REDEF   14088--REDEF
VX_O_KEY_BUF_L.FORM0
     14101**DCL     14104--REDEF   14111--REDEF
VX_PASS2_REF.OU.L_START
     15767**DCL     15772--REDEF
VX_PASS2_REF.OU.L_STOP
     15773**DCL     15778--REDEF
VX_PASS2_REF.OU.MAX
     15761**DCL     15766--REDEF
VX_PASS2_REF.OU.SIZE
     15779**DCL     15784--REDEF
VX_PASS2_REF.SAT.COUNT
     15806**DCL     15812--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:27   
VX_PASS2_REF.SAT.ENT_SIZE
     15813**DCL     15819--REDEF
VX_PASS2_REF.SAT.L_START
     15792**DCL     15798--REDEF
VX_PASS2_REF.SAT.L_STOP
     15799**DCL     15805--REDEF
VX_PASS2_REF.SAT.MAX
     15786**DCL     15791--REDEF
VX_PASS2_REF.UNSAT.L_START
     15854**DCL     15859--REDEF
VX_PASS2_REF.UNSAT.L_STOP
     15860**DCL     15865--REDEF
VX_PASS2_REF.UNSAT.L_WHERE
     15866**DCL     15871--REDEF
VX_PASS2_REF.UNSAT.MAX
     15848**DCL     15853--REDEF
VX_PASS2_REF.UNSAT.PAGE#
     15878**DCL     15883--REDEF
VX_PASS2_REF.UNSAT.SIZE
     15872**DCL     15877--REDEF
VX_PHRASE.PHRASE
     15280**DCL     15282--REDEF
VX_PROGRAM_BIAS.A
     15058**DCL     15059--REDEF
VX_R_KEY_BUF.FORM0
     14127**DCL     14131--REDEF   14137--REDEF
VX_SD.A
     13755**DCL     13756--REDEF
VX_SPC.B$.MINE
     15949**DCL     15955--REDEF
VX_SPC.B$.NAME
     15928**DCL     15934--REDEF
VX_SPC.B$.SKIP
     15942**DCL     15948--REDEF
VX_SPC.B$.VALUE
     15935**DCL     15941--REDEF
PL6.E3A0      #001=VXD$FLST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:06 Page:28   
VX_SPC.SEG.NAME
     15897**DCL     15903--REDEF
VX_SPC.SEG.VALUE
     15904**DCL     15910--REDEF
VX_TSX0_OVERLAY.H
     15672**DCL     15675--REDEF
WHERE$
     16401**DCL     16464<>CALL    16466>>ASSIGN  16467>>ASSIGN  16468>>ASSIGN

PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:29   
       63        1        /*M* VXD$ALST - processes an account list */
       64        2        /*T***********************************************************/
       65        3        /*T*                                                         */
       66        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       67        5        /*T*                                                         */
       68        6        /*T***********************************************************/
       69        7        /*X* DMR,PLM=6,IND=4,CSU=2,EXM=0,ECU=2,MOC,DCI=4,CRT=4,CTI=8    */
       70        8        /*F*  NAME:       VXD$ALST
       71        9              PURPOSE:    Process an account list
       72       10              DESCRIPTION:
       73       11              Processes an account list structure produced by X$PARSE, building a
       74       12              linked list of VX$ACCT elements ( a VX$ACCT element is generated for
       75       13              each account in the list) and returns a pointer to the start of the list.
       76       14        */
       77       15
       78       16        VXD$ALST:
       79       17              PROC( FIRST_P$, OB_P$, TYPE );
       80       18        /*
       81       19                          Include files
       82       20        */
       83       21        %INCLUDE VX_SWITCH_C;
       84       29        %INCLUDE VX_SUBS_C;
       85      247        %INCLUDE VX_MACRO_C;
       86     1384        %INCLUDE XU_MACRO_C;
       87     4490        %VX$ACCT;

              4503        /*******************************************************************************
              4504        *                                                                              *
              4505        *                          VX$ACCT                                                 *
              4506        *                                                                              *
              4507        *******************************************************************************/

              4512    1   DCL 1 VX$ACCT ALIGNED BASED,
              4513    1         2 LINK$ PTR,
              4514    1         2 ACCT_,
              4515    1           3 * UBIN WORD,
              4516    1           3 ACCT$ PTR,
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:30   
              4517    1         2 SN_,
              4518    1           3 * UBIN WORD,
              4519    1           3 SN$ PTR;
       88     4522        %PARSE$OUT( NAME=O$B, STCLASS="BASED");
       89     4567        %P;

              4575    1   /*******************************************************************************
              4576    1   *                                                                              *
              4577    1   *                          PARAMETERS                                              *
              4578    1   *                                                                              *
              4579    1   *******************************************************************************/

       90     4583    1   DCL FIRST_P$        PTR       ALIGNED;
       91     4584    1   DCL OB_P$           PTR       ALIGNED;
       92     4585    1   DCL TYPE            UBIN(36)  ALIGNED;
       93     4586        %PTR;

              4594    1   /*******************************************************************************
              4595    1   *                                                                              *
              4596    1   *                          PTR                                                 *
              4597    1   *                                                                              *
              4598    1   *******************************************************************************/

       94     4602    1   DCL LAST$           PTR       ALIGNED   AUTO;
       95     4603    1   DCL OB$             PTR       ALIGNED   AUTO;
       96     4604    1   DCL WHERE$          PTR       ALIGNED   AUTO;
       97     4605        %E;

              4613    1   /*******************************************************************************
              4614    1   *                                                                              *
              4615    1   *                          ENTRY                                                 *
              4616    1   *                                                                              *
              4617    1   *******************************************************************************/

       98     4621    1   DCL VXS$ACCT        ENTRY(3);
       99     4622        %U;

PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:31   
              4630    1   /*******************************************************************************
              4631    1   *                                                                              *
              4632    1   *                          UBIN                                                 *
              4633    1   *                                                                              *
              4634    1   *******************************************************************************/

      100     4638    1   DCL I               UBIN(36)  ALIGNED   AUTO;
      101     4639    1   DCL STOP       UBIN(36)       ALIGNED   AUTO;
      102     4640        %EJECT;
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:32   
      103     4641        %BANNER(ARG=Begin  VXD$ALST);

              4649    1   /*******************************************************************************
              4650    1   *                                                                              *
              4651    1   *                          Begin  VXD$ALST                                         *
              4652    1   *                                                                              *
              4653    1   *******************************************************************************/

      104     4657    1         OB$   = OB_P$;
      105     4658    1         STOP  = OB$ -> O$B.NSUBLKS - 1;
      106     4659    2         DO I = 0 TO STOP;
      107     4660    2             CALL VXS$ACCT( WHERE$, OB$->O$B.SUBLK$(I) -> O$B.SUBLK$(0) -> O$B.SUBLK$(0
              4660                      ), TYPE );
      108     4661    2             IF I = 0 THEN FIRST_P$ = WHERE$;
      109     4662    2             ELSE LAST$ -> VX$ACCT.LINK$ = WHERE$;
      110     4663    2             LAST$ = WHERE$;
      111     4664    2            END;
      112     4665    1   END VXD$ALST;

PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:33   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   VX_MACRO_C.:E05TOU  is referenced.
   VX_SUBS_C.:E05TOU  is referenced.
   VX_SWITCH_C.:E05TOU  is referenced.
      No diagnostics issued in procedure VXD$ALST.

   Procedure VXD$ALST requires 43 words for executable code.
   Procedure VXD$ALST requires 16 words of local(AUTO) storage.

    No errors detected in file VXD$FLST.:E05TSI    .

PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:34   

 Object Unit name= VXD$ALST                                   File name= VXD$FLST.:E05TOU
 UTS= JUL 30 '97 08:07:31.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    43     53  VXD$ALST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        3  VXD$ALST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 VXS$ACCT
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:35   


       63        1        /*M* VXD$ALST - processes an account list */
       64        2        /*T***********************************************************/
       65        3        /*T*                                                         */
       66        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       67        5        /*T*                                                         */
       68        6        /*T***********************************************************/
       69        7        /*X* DMR,PLM=6,IND=4,CSU=2,EXM=0,ECU=2,MOC,DCI=4,CRT=4,CTI=8    */
       70        8        /*F*  NAME:       VXD$ALST
       71        9              PURPOSE:    Process an account list
       72       10              DESCRIPTION:
       73       11              Processes an account list structure produced by X$PARSE, building a
       74       12              linked list of VX$ACCT elements ( a VX$ACCT element is generated for
       75       13              each account in the list) and returns a pointer to the start of the list.
       76       14        */
       77       15
       78       16        VXD$ALST:
       79       17              PROC( FIRST_P$, OB_P$, TYPE );

     17  0 000000   000000 700200 xent  VXD$ALST     TSX0  ! X66_AUTO_3
         0 000001   000020 000003                    ZERO    16,3

       80       18        /*
       81       19                          Include files
       82       20        */
       83       21        %INCLUDE VX_SWITCH_C;
       84       29        %INCLUDE VX_SUBS_C;
       85      247        %INCLUDE VX_MACRO_C;
       86     1384        %INCLUDE XU_MACRO_C;
       87     4490        %VX$ACCT;

              4503        /*******************************************************************************
              4504        *                                                                              *
              4505        *                          VX$ACCT                                                *
              4506        *                                                                              *
              4507        *******************************************************************************/

PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:36   
              4512    1   DCL 1 VX$ACCT ALIGNED BASED,
              4513    1         2 LINK$ PTR,
              4514    1         2 ACCT_,
              4515    1           3 * UBIN WORD,
              4516    1           3 ACCT$ PTR,
              4517    1         2 SN_,
              4518    1           3 * UBIN WORD,
              4519    1           3 SN$ PTR;
       88     4522        %PARSE$OUT( NAME=O$B, STCLASS="BASED");
       89     4567        %P;

              4575    1   /*******************************************************************************
              4576    1   *                                                                              *
              4577    1   *                          PARAMETERS                                             *
              4578    1   *                                                                              *
              4579    1   *******************************************************************************/

       90     4583    1   DCL FIRST_P$        PTR       ALIGNED;
       91     4584    1   DCL OB_P$           PTR       ALIGNED;
       92     4585    1   DCL TYPE            UBIN(36)  ALIGNED;
       93     4586        %PTR;

              4594    1   /*******************************************************************************
              4595    1   *                                                                              *
              4596    1   *                          PTR                                                 *
              4597    1   *                                                                              *
              4598    1   *******************************************************************************/

       94     4602    1   DCL LAST$           PTR       ALIGNED   AUTO;
       95     4603    1   DCL OB$             PTR       ALIGNED   AUTO;
       96     4604    1   DCL WHERE$          PTR       ALIGNED   AUTO;
       97     4605        %E;

              4613    1   /*******************************************************************************
              4614    1   *                                                                              *
              4615    1   *                          ENTRY                                                 *
              4616    1   *                                                                              *
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:37   
              4617    1   *******************************************************************************/

       98     4621    1   DCL VXS$ACCT        ENTRY(3);
       99     4622        %U;

              4630    1   /*******************************************************************************
              4631    1   *                                                                              *
              4632    1   *                          UBIN                                                 *
              4633    1   *                                                                              *
              4634    1   *******************************************************************************/

      100     4638    1   DCL I               UBIN(36)  ALIGNED   AUTO;
      101     4639    1   DCL STOP       UBIN(36)       ALIGNED   AUTO;
      102     4640        %EJECT;
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:38   
      103     4641        %BANNER(ARG=Begin  VXD$ALST);

              4649    1   /*******************************************************************************
              4650    1   *                                                                              *
              4651    1   *                          Begin  VXD$ALST                                        *
              4652    1   *                                                                              *
              4653    1   *******************************************************************************/

      104     4657    1         OB$   = OB_P$;

   4657  0 000002   200004 470500                    LDP0    @OB_P$,,AUTO
         0 000003   000000 236100                    LDQ     0,,PR0
         0 000004   200007 756100                    STQ     OB$,,AUTO

      105     4658    1         STOP  = OB$ -> O$B.NSUBLKS - 1;

   4658  0 000005   200007 471500                    LDP1    OB$,,AUTO
         0 000006   100001 236100                    LDQ     1,,PR1
         0 000007   000022 772000                    QRL     18
         0 000010   000001 136007                    SBLQ    1,DL
         0 000011   200012 756100                    STQ     STOP,,AUTO

      106     4659    2         DO I = 0 TO STOP;

   4659  0 000012   200011 450100                    STZ     I,,AUTO
         0 000013   000047 710000 0                  TRA     s:4664+2

      107     4660    2            CALL VXS$ACCT( WHERE$, OB$->O$B.SUBLK$(I) -> O$B.SUBLK$(0) -> O$B.SUBLK$(0
              4660                      ), TYPE );

   4660  0 000014   200007 470500                    LDP0    OB$,,AUTO
         0 000015   200011 720100                    LXL0    I,,AUTO
         0 000016   000003 471510                    LDP1    3,X0,PR0
         0 000017   100003 473500                    LDP3    3,,PR1
         0 000020   200005 236100                    LDQ     @TYPE,,AUTO
         0 000021   200016 756100                    STQ     STOP+4,,AUTO
         0 000022   300003 631500                    EPPR1   3,,PR3
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:39   
         0 000023   200015 451500                    STP1    STOP+3,,AUTO
         0 000024   200010 633500                    EPPR3   WHERE$,,AUTO
         0 000025   200014 453500                    STP3    STOP+2,,AUTO
         0 000026   200014 630500                    EPPR0   STOP+2,,AUTO
         0 000027   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000030   000000 701000 xent               TSX1    VXS$ACCT
         0 000031   000000 011000                    NOP     0

      108     4661    2             IF I = 0 THEN FIRST_P$ = WHERE$;

   4661  0 000032   200011 235100                    LDA     I,,AUTO
         0 000033   000040 601000 0                  TNZ     s:4662

   4661  0 000034   200010 236100                    LDQ     WHERE$,,AUTO
         0 000035   200003 470500                    LDP0    @FIRST_P$,,AUTO
         0 000036   000000 756100                    STQ     0,,PR0
         0 000037   000043 710000 0                  TRA     s:4663

      109     4662    2             ELSE LAST$ -> VX$ACCT.LINK$ = WHERE$;

   4662  0 000040   200010 236100                    LDQ     WHERE$,,AUTO
         0 000041   200006 470500                    LDP0    LAST$,,AUTO
         0 000042   000000 756100                    STQ     0,,PR0

      110     4663    2             LAST$ = WHERE$;

   4663  0 000043   200010 236100                    LDQ     WHERE$,,AUTO
         0 000044   200006 756100                    STQ     LAST$,,AUTO

      111     4664    2            END;

   4664  0 000045   000001 035007                    ADLA    1,DL
         0 000046   200011 755100                    STA     I,,AUTO
         0 000047   200012 236100                    LDQ     STOP,,AUTO
         0 000050   200011 116100                    CMPQ    I,,AUTO
         0 000051   000014 603000 0                  TRC     s:4660

PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:40   
      112     4665    1   END VXD$ALST;

   4665  0 000052   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:41   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   VX_MACRO_C.:E05TOU  is referenced.
   VX_SUBS_C.:E05TOU  is referenced.
   VX_SWITCH_C.:E05TOU  is referenced.
      No diagnostics issued in procedure VXD$ALST.
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:42   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FIRST_P$                  4-0-0/w PTR         r     1 @OB_P$
     5-0-0/w PTR         r     1 @TYPE                     *0-0-0/w PTR         r     1 FIRST_P$
    11-0-0/w UBIN        r     1 I                          6-0-0/w PTR         r     1 LAST$
     7-0-0/w PTR         r     1 OB$                       *0-0-0/w PTR         r     1 OB_P$
    12-0-0/w UBIN        r     1 STOP                      *0-0-0/w UBIN        r     1 TYPE
    10-0-0/w PTR         r     1 WHERE$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 O$B                        0-0-0/w STRC(180)   r     1 VX$ACCT


   Procedure VXD$ALST requires 43 words for executable code.
   Procedure VXD$ALST requires 16 words of local(AUTO) storage.

    No errors detected in file VXD$FLST.:E05TSI    .
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:43   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VXD$ALST File=VXD$FLST.:E05TSI                                WED 07/30/97 08:07 Page:44   
          MINI XREF LISTING

FIRST_P$
      4583**DCL        16--PROC     4661<<ASSIGN
I
      4638**DCL      4659<<DOINDEX  4660>>CALL     4661>>IF
LAST$
      4602**DCL      4662>>ASSIGN   4663<<ASSIGN
O$B.NSUBLKS
      4540**DCL      4658>>ASSIGN
O$B.SUBLK$
      4561**DCL      4660>>CALL     4660>>CALL     4660<>CALL
OB$
      4603**DCL      4657<<ASSIGN   4658>>ASSIGN   4660>>CALL
OB_P$
      4584**DCL        16--PROC     4657>>ASSIGN
STOP
      4639**DCL      4658<<ASSIGN   4659>>DOINDEX
TYPE
      4585**DCL        16--PROC     4660<>CALL
VX$ACCT.LINK$
      4513**DCL      4662<<ASSIGN
VXS$ACCT
      4621**DCL-ENT  4660--CALL
WHERE$
      4604**DCL      4660<>CALL     4661>>ASSIGN   4662>>ASSIGN   4663>>ASSIGN
