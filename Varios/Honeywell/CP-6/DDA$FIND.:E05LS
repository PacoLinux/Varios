VERSION E05

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:1    
        1        1        /*M* DDA$FIND  - FIND/STORE DO ROUTINE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        DDA$FIND: PROC ALTRET;
        9        9    1   DCL 1 VALUE,
       10       10    1         2 SIZE UBIN WORD,
       11       11    1         2 OPS(0:15) UBIN WORD;
       12       12    1   DCL 1 TVALUE,
       13       13    1         2 SIZE UBIN WORD,
       14       14    1         2 OPS(0:15) UBIN WORD;
       15       15    1   DCL ADDRESS UBIN;
       16       16    1   DCL SEG UBIN;
       17       17    1   DCL DESC# UBIN;
       18       18    1   DCL NOT_IS BIT(1);
       19       19    1   DCL VALUE_O UBIN;
       20       20    1   DCL VALUE_B REDEF VALUE_O BIT(36);
       21       21    1   DCL MAX_ADDRESS UBIN;
       22       22    1   DCL DO$ PTR;
       23       23    1   DCL OUTPUT$ PTR;
       24       24    1   DCL NODE UBIN;
       25       25    1   DCL TEMP_F UBIN;
       26       26    1   DCL TEMP_FB REDEF TEMP_F BIT(36);
       27       27    1   DCL TEMP_S UBIN;
       28       28    1   DCL TEMP_SB REDEF TEMP_S BIT(36);
       29       29    1   DCL TEMP_NV UBIN;
       30       30    1   DCL TEMP_NVB REDEF TEMP_NV BIT(36);
       31       31    1   DCL MASK_S SBIN;
       32       32    1   DCL MASK_SB REDEF MASK_S BIT(36);
       33       33    1   DCL MASK_F SBIN;
       34       34    1   DCL MASK_FB REDEF MASK_F BIT(36);
       35       35    1   DCL DO_SUB BIT(1);
       36       36    1   DCL DO_FIND BIT(1);
       37       37    1   DCL DO_STORE BIT(1);
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:2    
       38       38    1   DCL FOUND_SOME BIT(1);
       39       39    1   DCL NOMORE BIT(1);
       40       40    1   DCL DISP_FMT UBIN;
       41       41    1   DCL TEMP_V UBIN;
       42       42    1   DCL TEMP_VB REDEF TEMP_V BIT(36);
       43       43    1   DCL CHAR2 CHAR(2) BASED;
       44       44    1   DCL CHAR4 CHAR(4) BASED;
       45       45    1   DCL TEMP SBIN;
       46       46        %INCLUDE XUH_MACRO_C;
       47      130        %INCLUDE DD_SD_M;
       48     1466        %S_D;
       49     2784        %INCLUDE DD_SUBS_C;
       50     3055        %INCLUDE DD_ERR_C;
       51     3452        %INCLUDE DD$DITEM;
       12+    3555             %LIST;
       13+    3556    1        DCL SDD$ PTR;
       14+    3557    1        DCL ZITEM$ PTR;
       15+    3558    1        DCL SDD_L6$ PTR;
       16+    3559    1        DCL ZITEM_L6$ PTR;
       52     4133        %INCLUDE DD$BASED;
       53     5436        %FIND$CMD (STCLASS="BASED(DO$)");
       54     5462        %INCLUDE B$OBJECT_C;
       55     8892        %B$RECORDSUBS;
       56     8920    1   DCL DDA$DISPFMT ENTRY(6) ALTRET;
       57     8921    1   DCL DDA$DISPADR ENTRY(7) ALTRET;
       58     8922    1   DCL DDE$ERROR ENTRY;
       59     8923    1   DCL DDK$EVAL ENTRY(6) ALTRET;
       60     8924    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
       61     8925    1   DCL DUU$GETMVAL ENTRY(6) ALTRET;
       62     8926    1   DCL DUL$GETMVAL ENTRY(5) ALTRET;
       63     8927    1   DCL DDQ$WRITE ENTRY(2);
       64     8928    1   DCL DDQ$WRITELM ENTRY(5) ALTRET;
       65     8929    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
       66     8930    1   DCL DDK$PUTMVAL ENTRY(5) ALTRET;
       67     8931    1   DCL DUU$PUTMVAL ENTRY(6) ALTRET;
       68     8932    1   DCL DDB$BREAK ENTRY ALTRET;
       69     8933                                                /**/
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:3    
       70     8934                                                /* Find only code */
       71     8935    1        VALUE.SIZE = 1;
       72     8936    1        DO_FIND = '1'B;
       73     8937    1        DO_STORE = '0'B;
       74     8938    1        FOUND_SOME = '0'B;
       75     8939    1        NOMORE = '0'B;
       76     8940    1        DO_SUB = '0'B;
       77     8941    1        S_D.DESC$ = S_D.D$;
       78     8942    1        DO$ = S_D.DO$;
       79     8943    1        OUTPUT$ = ADDR( S_D.OUTPUT );
       80     8944    1        CALL IORVALUE (TEMP_F, FIND$CMD.INSTR, FIND$CMD.IGNPR, FIND$CMD.AWDX) ALTRET(
              8944                 ERR); /* Get find value */
       81     8945    1        IF FIND$CMD.INSTR THEN DISP_FMT = %INST_FMT;
       82     8946    1        ELSE DISP_FMT = %OCT_FMT;
       83     8947    1        IF FIND$CMD.FROMFIRST
       84     8948    2        THEN DO;
       85     8949    2             CALL SETUP_FROM ALTRET(ERR1);
       86     8950    2             IF FIND$CMD.SUBS THEN CALL IORVALUE (TEMP_S, FIND$CMD.SUBSINSTR, FIND$CMD.
              8950                      SUBSIGNPR, FIND$CMD.SUBSAWDX) ALTRET(ERR);
       87     8951    2           END;
       88     8952    2        ELSE DO;
       89     8953    2             IF FIND$CMD.SUBS THEN CALL IORVALUE (TEMP_S, FIND$CMD.SUBSINSTR, FIND$CMD.
              8953                      SUBSIGNPR, FIND$CMD.SUBSAWDX) ALTRET(ERR);
       90     8954    2             CALL SETUP_FROM ALTRET(ERR1);
       91     8955    2           END;
       92     8956        /* Setup for find.  ADDRESS,SEG,DESC#,NOT_IS point to first word in
       93     8957          the from range. TEMP_F is the masked find value, TEMP_S is the
       94     8958          masked sub value. MASK_F is the find mask, MASK_S is the sub mask.
       95     8959          DO_SUB is set if subsition is to be made, DO_FIND is set if the
       96     8960          find check is to be made (reset if this is a store command). */
       97     8961                                                /**/
       98     8962    1        IF FIND$CMD.SUBS THEN DO_SUB = '1'B;
       99     8963    1        IF FIND$CMD.UNDER
      100     8964    2        THEN DO;
      101     8965    2             MASK_F = FIND$CMD.UNDER_V;
      102     8966    2             S_D.FIND.MASK_F = MASK_F;
      103     8967    2           END;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:4    
      104     8968    1        ELSE MASK_F = S_D.FIND.MASK_F;
      105     8969    1        IF FIND$CMD.SUBSUNDER THEN MASK_S = FIND$CMD.SUBSUNDER_V;
      106     8970    1        ELSE MASK_S = -1;
      107     8971    1        TEMP_FB = TEMP_FB & MASK_FB;
      108     8972    1        TEMP_SB = TEMP_SB & MASK_SB;
      109     8973                                                /**/
      110     8974                                                /* Main line for find/store */
      111     8975                                                /* Store code enters here */
      112     8976                                                /**/
      113     8977    1   MAINLINE:
      114     8978    1        IF S_D.RUM
      115     8979    1        THEN S_D.FIND_RUM = '1'B;
      116     8980    1        IF S_D.ANLZ_FILE AND DO_SUB
      117     8981    2        THEN DO;
      118     8982    2             S_D.ERROR = E@CANTPUTINANLZ;  /* E@CANTPUTINANLZ */
      119     8983    2             ALTRETURN;
      120     8984    2           END;
      121     8985    1        NODE = 0;
      122     8986    1        IF S_D.RUM AND S_D.OVERLAID THEN CALL DDS$IC2NODE (ADDRESS, NODE) ALTRET(ERR);
      123     8987    1        IF MASK_F ~= -1 AND FIND$CMD.CMD = C_FIND AND NOT FIND$CMD.UNDER
      124     8988    2        THEN DO;
      125     8989    2             S_D.OUTPUT = '$FMASK = ';
      126     8990    2             S_D.D$ = PINCRC(OUTPUT$, 9);
      127     8991    2             S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));
      128     8992    2             CALL DDA$DISPFMT(%OCT_FMT, 36, MASK_F) ALTRET(ERR1);
      129     8993    2             CALL DDQ$WRITE (OUTPUT$, POFFC(S_D.D$, OUTPUT$));
      130     8994    2           END;
      131     8995                                                /**/
      132     8996                                                /* Do loop for cell selection */
      133     8997                                                /**/
      134     8998    2        DO ADDRESS = ADDRESS TO MAX_ADDRESS;
      135     8999    2             IF S_D.BREAK
      136     9000    3             THEN DO;
      137     9001    3                  S_D.OUTPUT = 'Next cell was ';
      138     9002    3                  S_D.D$ = PINCRC(OUTPUT$, 14);
      139     9003    3                  S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));
      140     9004    3                  CALL DDA$DISPADR( ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT,, 36) ALTRET(
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:5    
              9004                           ERR1);
      141     9005    3                  CALL DDQ$WRITE( OUTPUT$, POFFC(S_D.D$, OUTPUT$));
      142     9006    3                  CALL DDB$BREAK;
      143     9007    3                  RETURN;
      144     9008    3                END;
      145     9009                                                /**/
      146     9010                                                /* Get value */
      147     9011                                                /**/
      148     9012    2             IF S_D.ANLZ_FILE THEN CALL DUL$GETMVAL (VALUE.OPS(0), ADDRESS, SEG, DESC#,
              9012                      NOT_IS) ALTRET(ERR);
      149     9013    3             ELSE IF S_D.RUM THEN DO;
      150     9014    3   MORE:               CALL DUU$GETMVAL (VALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS)
      151     9015    4                       WHENALTRETURN DO;
      152     9016    4                            IF NOT S_D.OVERLAID THEN GOTO ERR;
      153     9017    4                            CALL DDS$IC2NODE (ADDRESS, NODE) ALTRET (ERR);
      154     9018    4                            IF NOMORE THEN GOTO ERR;
      155     9019    4                            IF NODE = S_D.NODE THEN NOMORE = '1'B;
      156     9020    4                            GOTO MORE;
      157     9021    4                          END;
      158     9022    3                     END;
      159     9023    2                  ELSE CALL DDK$GETMVAL (VALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS)
              9023                           ALTRET(ERR);
      160     9024                                                /**/
      161     9025                                                /* If find command, check for match */
      162     9026                                                /**/
      163     9027    2             IF DO_FIND
      164     9028    3             THEN DO;
      165     9029    3                  VALUE_O = VALUE.OPS(0);
      166     9030    3                  TEMP_VB = VALUE_B & MASK_FB;
      167     9031    3                  IF FIND$CMD.NOTFLAG
      168     9032    3                  THEN IF TEMP_V = TEMP_F THEN GOTO NO_MATCH;
      169     9033    3                       ELSE ;
      170     9034    3                  ELSE IF TEMP_V ~= TEMP_F THEN GOTO NO_MATCH;
      171     9035    3                END;
      172     9036    2             FOUND_SOME = '1'B;
      173     9037                                                /**/
      174     9038                                                /* If store, or find and sub specified
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:6    
      175     9039                                                   make the substitution */
      176     9040                                                /**/
      177     9041    2             IF DO_SUB
      178     9042    3             THEN DO;
      179     9043    3                  VALUE_O = VALUE.OPS(0);
      180     9044    3                  TEMP_NVB = (VALUE_B & ~MASK_SB) | TEMP_SB;
      181     9045    3                  IF S_D.RUM
      182     9046    4                  THEN DO;
      183     9047    4                       TVALUE.SIZE = 1;
      184     9048    4                       TVALUE.OPS(0) = TEMP_NV;
      185     9049    4                       CALL DUU$PUTMVAL (TVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS)
              9049                                ALTRET(ERR);
      186     9050    4                     END;
      187     9051    3                  ELSE CALL DDK$PUTMVAL (TEMP_NV, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
              9051                           ERR);
      188     9052    3                END;
      189     9053    2             IF DO_FIND OR DO_STORE
      190     9054    3             THEN DO;                      /* Report the find */
      191     9055    3                  S_D.OUTPUT = ' ';
      192     9056    3                  S_D.D$ = OUTPUT$;
      193     9057    3                  S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));
      194     9058    3                  CALL DDA$DISPADR( ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT,, 36) ALTRET(
              9058                           ERR1);
      195     9059    3                  S_D.D$->CHAR2 = '/ ';
      196     9060    3                  S_D.D$ = PINCRC(S_D.D$, 2);
      197     9061    3                  CALL DDA$DISPFMT(DISP_FMT, 36, VALUE.OPS(0)) ALTRET(ERR1);
      198     9062    3                  IF DO_SUB
      199     9063    4                  THEN DO;
      200     9064    4                       S_D.D$->CHAR4 = ' <- ';
      201     9065    4                       S_D.D$ = PINCRC(S_D.D$, 4);
      202     9066    4                       CALL DDA$DISPFMT(DISP_FMT, 36, TEMP_NV) ALTRET(ERR1);
      203     9067    4                     END;
      204     9068    3                  IF DO_FIND
      205     9069    3                  THEN CALL DDQ$WRITE (OUTPUT$, POFFC(S_D.D$, OUTPUT$));
      206     9070    3                  IF S_D.RUM AND NOT S_D.RUM_TEST AND DO_SUB
      207     9071    4                  THEN DO;
      208     9072    4                       S_D.OUTPUT = ' ';
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:7    
      209     9073    4                       S_D.D$ = OUTPUT$;
      210     9074    4                       S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));
      211     9075    4                       CALL DDA$DISPADR( ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT, '1'B,
              9075                                36) ALTRET(ERR1);
      212     9076    4                       S_D.D$->CHAR2 = '/ ';
      213     9077    4                       S_D.D$ = PINCRC(S_D.D$, 2);
      214     9078    4                       CALL DDA$DISPFMT(DISP_FMT, 36, VALUE.OPS(0), , '1'B) ALTRET(ERR1
              9078                                );
      215     9079    4                       IF DO_SUB
      216     9080    5                       THEN DO;
      217     9081    5                            S_D.D$->CHAR4 = ' <- ';
      218     9082    5                            S_D.D$ = PINCRC(S_D.D$, 4);
      219     9083    5                            CALL DDA$DISPFMT(DISP_FMT, 36, TEMP_NV, , '1'B) ALTRET(ERR1
              9083                                     );
      220     9084    5                          END;
      221     9085    4                       TEMP = POFFC(S_D.D$, OUTPUT$);
      222     9086    4                       CALL DDQ$WRITELM (%TYPRUM, 0, NODE, OUTPUT$, TEMP) ALTRET(ERR2);
      223     9087    4                     END;
      224     9088    3                END;
      225     9089    2   NO_MATCH:
      226     9090    2           END;                            /* End do address to MAX_ADDRESS */
      227     9091    1        IF NOT FOUND_SOME
      228     9092    2        THEN DO;
      229     9093    2             S_D.OUTPUT = 'None';
      230     9094    2             CALL DDQ$WRITE(OUTPUT$, 4);
      231     9095    2           END;
      232     9096    1        S_D.FIND_RUM = '0'B;
      233     9097    1        RETURN;
      234     9098    1   ERR2:
      235     9099    1        S_D.ERROR = E@DELBUG;              /* E@DELBUG */
      236     9100    1        CALL DDE$ERROR;
      237     9101    1        GOTO ERR1;
      238     9102    1   ERR:
      239     9103    1        IF DO_FIND
      240     9104    2        THEN DO;
      241     9105    2             S_D.OUTPUT = 'FIND terminated at ';
      242     9106    2             S_D.D$ = PINCRC(OUTPUT$, SIZEC('FIND terminated at '));
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:8    
      243     9107    2           END;
      244     9108    2        ELSE DO;
      245     9109    2             S_D.OUTPUT = 'STORE terminated at ';
      246     9110    2             S_D.D$ = PINCRC(OUTPUT$, SIZEC('STORE terminated at '));
      247     9111    2           END;
      248     9112    1        S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));
      249     9113    1        CALL DDA$DISPADR( ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT,, 36);
      250     9114    1        CALL DDQ$WRITE(OUTPUT$, POFFC(S_D.D$, OUTPUT$));
      251     9115    1        IF S_D.FIND_RUM
      252     9116    2        THEN DO;
      253     9117    2             S_D.FIND_RUM = '0'B;
      254     9118    2             RETURN;
      255     9119    2           END;
      256     9120    1   ERR1:
      257     9121    1        ALTRETURN;
      258     9122        %EJECT;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:9    
      259     9123                                                /**/
      260     9124                                           /* Set up range, common for find and store.
      261     9125                                              If range was specified, store it in S_D,
      262     9126                                              if not, get it from S_D. */
      263     9127                                                /**/
      264     9128    1   SETUP_FROM: PROC ALTRET;
      265     9129    2        IF FIND$CMD.FROM
      266     9130    3        THEN DO;
      267     9131    3             CALL DDK$EVAL( ADDRESS, SEG, DESC#, NOT_IS) ALTRET(ERR);
      268     9132                                                /* Save the new from info in S_D. */
      269     9133    3             S_D.FIND.ADDRESS = ADDRESS;
      270     9134    3             S_D.FIND.SEG = SEG;
      271     9135    3             S_D.FIND.DESC# = DESC#;
      272     9136    3             S_D.FIND.NUM = FIND$CMD.NUM;
      273     9137    3             S_D.FIND.NOT_IS = NOT_IS;
      274     9138    3             MAX_ADDRESS = ADDRESS + FIND$CMD.NUM -1;
      275     9139    3           END;
      276     9140    3        ELSE DO;
      277     9141                                                /* Get values from S_D */
      278     9142    3             ADDRESS=S_D.FIND.ADDRESS;
      279     9143    3             SEG = S_D.FIND.SEG;
      280     9144    3             DESC# = S_D.FIND.DESC#;
      281     9145    3             NOT_IS = S_D.FIND.NOT_IS;
      282     9146    3             MAX_ADDRESS = ADDRESS + S_D.FIND.NUM - 1;
      283     9147    3           END;
      284     9148    2        RETURN;
      285     9149    2   ERR: ALTRETURN;
      286     9150    2   END SETUP_FROM;
      287     9151        %EJECT;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:10   
      288     9152    1   IORVALUE: PROC(RVALUE, IFLAG, ZFLAG, XFLAG) ALTRET;
      289     9153    2   DCL RVALUE UBIN;
      290     9154    2   DCL IFLAG BIT(1) UNAL;
      291     9155    2   DCL ZFLAG BIT(1) UNAL;
      292     9156    2   DCL XFLAG BIT(1) UNAL;
      293     9157        /*D* NAME: IORVALUE */
      294     9158        /*D* The routine IOVALUE  constructs a 36-bit value from a data
      295     9159             descriptor optionally preceded  by an instruction template
      296     9160             as specified by IFLAG.   This input information is at S_D.D$,
      297     9161             and upon normal return S_D.D$ points to the next word following
      298     9162             the data descriptor.  ALTRET  is taken if the address data
      299     9163             descriptor cant be evaluated.
      300     9164                                                     */
      301     9165    2   DCL VALUE UBIN;
      302     9166    2   DCL 1 OVALUE REDEF VALUE,
      303     9167    2         2 * UBIN(3) UNAL,
      304     9168    2         2 OFFSET SBIN(15) UNAL,
      305     9169    2         2 * UBIN(11) UNAL,
      306     9170    2         2 BIT29 BIT(1) UNAL,
      307     9171    2         2 * UBIN(6) UNAL;
      308     9172    2   DCL 1 YVALUE REDEF VALUE,
      309     9173    2         2 Y UBIN(18) UNAL,
      310     9174    2         2 * UBIN(18) UNAL;
      311     9175    2   DCL UBIN36 UBIN BASED;
      312     9176    2   DCL ADDRESS UBIN;
      313     9177    2   DCL NOT_IS BIT(1);
      314     9178    2   DCL DUM UBIN;
      315     9179    2   DCL DUM2 UBIN;
      316     9180                                                /**/
      317     9181    2        IF IFLAG
      318     9182    3        THEN DO;
      319     9183    3             VALUE = S_D.DESC$ -> UBIN36;
      320     9184    3             S_D.DESC$ = PINCRW(S_D.DESC$, 1);
      321     9185    3           END;
      322     9186    2        CALL DDK$EVAL(ADDRESS, DUM, DUM2, NOT_IS) ALTRET(ARET);
      323     9187    2        IF NOT_IS
      324     9188    3        THEN DO;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:11   
      325     9189    3             S_D.ERROR = E@BADVALEXP;      /* E@BADVALEXP */
      326     9190    3             ALTRETURN;
      327     9191    3           END;
      328     9192    2        IF IFLAG
      329     9193    2        THEN IF ( OVALUE.BIT29 AND NOT ZFLAG ) OR XFLAG
      330     9194    2             THEN OVALUE.OFFSET = ADDRESS;
      331     9195    2             ELSE YVALUE.Y = ADDRESS;
      332     9196    2        ELSE VALUE = ADDRESS;
      333     9197    2        RVALUE = VALUE;
      334     9198    2        RETURN;
      335     9199    2   ARET:
      336     9200    2        ALTRETURN;
      337     9201    2   END IORVALUE;
      338     9202        %EJECT;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:12   
      339     9203    1   DDA$STORE: ENTRY ALTRET;
      340     9204        /*P* NAME: DDA$STORE
      341     9205             PURPOSE: DO ROUTINE FROM STORE COMMAND */
      342     9206                                                /**/
      343     9207    1        DO_FIND = '0'B;
      344     9208    1        DO_SUB = '1'B;
      345     9209    1        DO_STORE = '1'B;
      346     9210    1        DO$ = S_D.DO$;
      347     9211    1        S_D.DESC$ = S_D.D$;
      348     9212    1        OUTPUT$ = ADDR( S_D.OUTPUT );
      349     9213    1        CALL IORVALUE (TEMP_S, FIND$CMD.INSTR, FIND$CMD.IGNPR, FIND$CMD.AWDX);
      350     9214    1        IF FIND$CMD.INSTR
      351     9215    1        THEN DISP_FMT = %INST_FMT;
      352     9216    1        ELSE DISP_FMT = %OCT_FMT;
      353     9217    1        FOUND_SOME = '1'B;
      354     9218    1        IF FIND$CMD.UNDER THEN MASK_S = FIND$CMD.UNDER_V;
      355     9219    1        ELSE MASK_S = -1;
      356     9220    1        TEMP_SB = TEMP_SB & MASK_SB;
      357     9221    1        CALL SETUP_FROM ALTRET(ERR1);
      358     9222    1        GOTO MAINLINE;
      359     9223    1   END DDA$FIND;

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:13   
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$FIND.

   Procedure DDA$FIND requires 811 words for executable code.
   Procedure DDA$FIND requires 82 words of local(AUTO) storage.

    No errors detected in file DDA$FIND.:E05TSI    .

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:14   

 Object Unit name= DDA$FIND                                   File name= DDA$FIND.:E05TOU
 UTS= JUL 29 '97 13:28:02.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     20     24  DDA$FIND
    1   Proc  even  none   811   1453  DDA$FIND
    2  RoData even  none    19     23  DDA$FIND

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  DDA$FIND
     1   1370          yes     yes      Std        0  DDA$STORE
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:15   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDS$IC2NODE
 yes     yes           Std       6 DUU$PUTMVAL
 yes     yes           Std       5 DDK$GETMVAL
         yes           Std       2 DDQ$WRITE
 yes     yes           Std       7 DDA$DISPADR
 yes     yes           Std       6 DUU$GETMVAL
 yes     yes           Std       6 DDA$DISPFMT
 yes     yes           Std       0 DDB$BREAK
 yes     yes           Std       5 DUL$GETMVAL
 yes     yes           Std       5 DDK$PUTMVAL
 yes     yes           Std       5 DDQ$WRITELM
         yes           Std       0 DDE$ERROR
 yes     yes           Std       6 DDK$EVAL
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:16   


        1        1        /*M* DDA$FIND  - FIND/STORE DO ROUTINE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        DDA$FIND: PROC ALTRET;

      8  1 000000   000000 700200 xent  DDA$FIND     TSX0  ! X66_AUTO_0
         1 000001   000122 000000                    ZERO    82,0

        9        9    1   DCL 1 VALUE,
       10       10    1         2 SIZE UBIN WORD,
       11       11    1         2 OPS(0:15) UBIN WORD;
       12       12    1   DCL 1 TVALUE,
       13       13    1         2 SIZE UBIN WORD,
       14       14    1         2 OPS(0:15) UBIN WORD;
       15       15    1   DCL ADDRESS UBIN;
       16       16    1   DCL SEG UBIN;
       17       17    1   DCL DESC# UBIN;
       18       18    1   DCL NOT_IS BIT(1);
       19       19    1   DCL VALUE_O UBIN;
       20       20    1   DCL VALUE_B REDEF VALUE_O BIT(36);
       21       21    1   DCL MAX_ADDRESS UBIN;
       22       22    1   DCL DO$ PTR;
       23       23    1   DCL OUTPUT$ PTR;
       24       24    1   DCL NODE UBIN;
       25       25    1   DCL TEMP_F UBIN;
       26       26    1   DCL TEMP_FB REDEF TEMP_F BIT(36);
       27       27    1   DCL TEMP_S UBIN;
       28       28    1   DCL TEMP_SB REDEF TEMP_S BIT(36);
       29       29    1   DCL TEMP_NV UBIN;
       30       30    1   DCL TEMP_NVB REDEF TEMP_NV BIT(36);
       31       31    1   DCL MASK_S SBIN;
       32       32    1   DCL MASK_SB REDEF MASK_S BIT(36);
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:17   
       33       33    1   DCL MASK_F SBIN;
       34       34    1   DCL MASK_FB REDEF MASK_F BIT(36);
       35       35    1   DCL DO_SUB BIT(1);
       36       36    1   DCL DO_FIND BIT(1);
       37       37    1   DCL DO_STORE BIT(1);
       38       38    1   DCL FOUND_SOME BIT(1);
       39       39    1   DCL NOMORE BIT(1);
       40       40    1   DCL DISP_FMT UBIN;
       41       41    1   DCL TEMP_V UBIN;
       42       42    1   DCL TEMP_VB REDEF TEMP_V BIT(36);
       43       43    1   DCL CHAR2 CHAR(2) BASED;
       44       44    1   DCL CHAR4 CHAR(4) BASED;
       45       45    1   DCL TEMP SBIN;
       46       46        %INCLUDE XUH_MACRO_C;
       47      130        %INCLUDE DD_SD_M;
       48     1466        %S_D;
       49     2784        %INCLUDE DD_SUBS_C;
       50     3055        %INCLUDE DD_ERR_C;
       51     3452        %INCLUDE DD$DITEM;
       12+    3555             %LIST;
       13+    3556    1        DCL SDD$ PTR;
       14+    3557    1        DCL ZITEM$ PTR;
       15+    3558    1        DCL SDD_L6$ PTR;
       16+    3559    1        DCL ZITEM_L6$ PTR;
       52     4133        %INCLUDE DD$BASED;
       53     5436        %FIND$CMD (STCLASS="BASED(DO$)");
       54     5462        %INCLUDE B$OBJECT_C;
       55     8892        %B$RECORDSUBS;
       56     8920    1   DCL DDA$DISPFMT ENTRY(6) ALTRET;
       57     8921    1   DCL DDA$DISPADR ENTRY(7) ALTRET;
       58     8922    1   DCL DDE$ERROR ENTRY;
       59     8923    1   DCL DDK$EVAL ENTRY(6) ALTRET;
       60     8924    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
       61     8925    1   DCL DUU$GETMVAL ENTRY(6) ALTRET;
       62     8926    1   DCL DUL$GETMVAL ENTRY(5) ALTRET;
       63     8927    1   DCL DDQ$WRITE ENTRY(2);
       64     8928    1   DCL DDQ$WRITELM ENTRY(5) ALTRET;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:18   
       65     8929    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
       66     8930    1   DCL DDK$PUTMVAL ENTRY(5) ALTRET;
       67     8931    1   DCL DUU$PUTMVAL ENTRY(6) ALTRET;
       68     8932    1   DCL DDB$BREAK ENTRY ALTRET;
       69     8933                                                /**/
       70     8934                                                /* Find only code */
       71     8935    1        VALUE.SIZE = 1;

   8935  1 000002   000001 235007                    LDA     1,DL
         1 000003   200003 755100                    STA     VALUE,,AUTO

       72     8936    1        DO_FIND = '1'B;

   8936  1 000004   400000 236003                    LDQ     -131072,DU
         1 000005   200064 756100                    STQ     DO_FIND,,AUTO

       73     8937    1        DO_STORE = '0'B;

   8937  1 000006   200065 450100                    STZ     DO_STORE,,AUTO

       74     8938    1        FOUND_SOME = '0'B;

   8938  1 000007   200066 450100                    STZ     FOUND_SOME,,AUTO

       75     8939    1        NOMORE = '0'B;

   8939  1 000010   200067 450100                    STZ     NOMORE,,AUTO

       76     8940    1        DO_SUB = '0'B;

   8940  1 000011   200063 450100                    STZ     DO_SUB,,AUTO

       77     8941    1        S_D.DESC$ = S_D.D$;

   8941  1 000012   000000 470400 xsym               LDP0    S_D$
         1 000013   000044 236100                    LDQ     36,,PR0
         1 000014   000041 756100                    STQ     33,,PR0
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:19   

       78     8942    1        DO$ = S_D.DO$;

   8942  1 000015   000031 236100                    LDQ     25,,PR0
         1 000016   200053 756100                    STQ     DO$,,AUTO

       79     8943    1        OUTPUT$ = ADDR( S_D.OUTPUT );

   8943  1 000017   000000 236000 xsym               LDQ     S_D$
         1 000020   005335 036003                    ADLQ    2781,DU
         1 000021   200054 756100                    STQ     OUTPUT$,,AUTO

       80     8944    1        CALL IORVALUE (TEMP_F, FIND$CMD.INSTR, FIND$CMD.IGNPR, FIND$CMD.AWDX) ALTRET(
              8944                 ERR); /* Get find value */

   8944  1 000022   200053 236100                    LDQ     DO$,,AUTO
         1 000023   000000 036000 2                  ADLQ    0
         1 000024   200104 756100                    STQ     @ZFLAG+1,,AUTO
         1 000025   200053 236100                    LDQ     DO$,,AUTO
         1 000026   000001 036000 2                  ADLQ    1
         1 000027   200103 756100                    STQ     @IFLAG+1,,AUTO
         1 000030   200053 236100                    LDQ     DO$,,AUTO
         1 000031   000001 036003                    ADLQ    1,DU
         1 000032   200102 756100                    STQ     @RVALUE+1,,AUTO
         1 000033   200056 631500                    EPPR1   TEMP_F,,AUTO
         1 000034   200101 451500                    STP1    TEMP+7,,AUTO
         1 000035   001264 701000 1                  TSX1    IORVALUE
         1 000036   001104 702000 1                  TSX2    ERR

       81     8945    1        IF FIND$CMD.INSTR THEN DISP_FMT = %INST_FMT;

   8945  1 000037   200053 470500                    LDP0    DO$,,AUTO
         1 000040   000001 234100                    SZN     1,,PR0
         1 000041   000045 605000 1                  TPL     s:8946

   8945  1 000042   000006 235007                    LDA     6,DL
         1 000043   200070 755100                    STA     DISP_FMT,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:20   
         1 000044   000047 710000 1                  TRA     s:8947

       82     8946    1        ELSE DISP_FMT = %OCT_FMT;

   8946  1 000045   000001 235007                    LDA     1,DL
         1 000046   200070 755100                    STA     DISP_FMT,,AUTO

       83     8947    1        IF FIND$CMD.FROMFIRST

   8947  1 000047   000001 236100                    LDQ     1,,PR0
         1 000050   002000 316003                    CANQ    1024,DU
         1 000051   000076 600000 1                  TZE     s:8953

       84     8948    2        THEN DO;

       85     8949    2             CALL SETUP_FROM ALTRET(ERR1);

   8949  1 000052   001177 701000 1                  TSX1    SETUP_FROM
         1 000053   001176 702000 1                  TSX2    ERR1

       86     8950    2            IF FIND$CMD.SUBS THEN CALL IORVALUE (TEMP_S, FIND$CMD.SUBSINSTR, FIND$CMD.
              8950                      SUBSIGNPR, FIND$CMD.SUBSAWDX) ALTRET(ERR);

   8950  1 000054   200053 470500                    LDP0    DO$,,AUTO
         1 000055   000001 236100                    LDQ     1,,PR0
         1 000056   040000 316003                    CANQ    16384,DU
         1 000057   000117 600000 1                  TZE     s:8962

   8950  1 000060   200053 236100                    LDQ     DO$,,AUTO
         1 000061   000002 036000 2                  ADLQ    2
         1 000062   200104 756100                    STQ     @ZFLAG+1,,AUTO
         1 000063   200053 236100                    LDQ     DO$,,AUTO
         1 000064   000003 036000 2                  ADLQ    3
         1 000065   200103 756100                    STQ     @IFLAG+1,,AUTO
         1 000066   200053 236100                    LDQ     DO$,,AUTO
         1 000067   000004 036000 2                  ADLQ    4
         1 000070   200102 756100                    STQ     @RVALUE+1,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:21   
         1 000071   200057 631500                    EPPR1   TEMP_S,,AUTO
         1 000072   200101 451500                    STP1    TEMP+7,,AUTO
         1 000073   001264 701000 1                  TSX1    IORVALUE
         1 000074   001104 702000 1                  TSX2    ERR

       87     8951    2           END;

   8951  1 000075   000117 710000 1                  TRA     s:8962

       88     8952    2        ELSE DO;

       89     8953    2            IF FIND$CMD.SUBS THEN CALL IORVALUE (TEMP_S, FIND$CMD.SUBSINSTR, FIND$CMD.
              8953                      SUBSIGNPR, FIND$CMD.SUBSAWDX) ALTRET(ERR);

   8953  1 000076   040000 316003                    CANQ    16384,DU
         1 000077   000115 600000 1                  TZE     s:8954

   8953  1 000100   200053 236100                    LDQ     DO$,,AUTO
         1 000101   000002 036000 2                  ADLQ    2
         1 000102   200104 756100                    STQ     @ZFLAG+1,,AUTO
         1 000103   200053 236100                    LDQ     DO$,,AUTO
         1 000104   000003 036000 2                  ADLQ    3
         1 000105   200103 756100                    STQ     @IFLAG+1,,AUTO
         1 000106   200053 236100                    LDQ     DO$,,AUTO
         1 000107   000004 036000 2                  ADLQ    4
         1 000110   200102 756100                    STQ     @RVALUE+1,,AUTO
         1 000111   200057 631500                    EPPR1   TEMP_S,,AUTO
         1 000112   200101 451500                    STP1    TEMP+7,,AUTO
         1 000113   001264 701000 1                  TSX1    IORVALUE
         1 000114   001104 702000 1                  TSX2    ERR

       90     8954    2             CALL SETUP_FROM ALTRET(ERR1);

   8954  1 000115   001177 701000 1                  TSX1    SETUP_FROM
         1 000116   001176 702000 1                  TSX2    ERR1

       91     8955    2           END;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:22   

       92     8956        /* Setup for find.  ADDRESS,SEG,DESC#,NOT_IS point to first word in
       93     8957          the from range. TEMP_F is the masked find value, TEMP_S is the
       94     8958          masked sub value. MASK_F is the find mask, MASK_S is the sub mask.
       95     8959          DO_SUB is set if subsition is to be made, DO_FIND is set if the
       96     8960          find check is to be made (reset if this is a store command). */
       97     8961                                                /**/
       98     8962    1        IF FIND$CMD.SUBS THEN DO_SUB = '1'B;

   8962  1 000117   200053 470500                    LDP0    DO$,,AUTO
         1 000120   000001 236100                    LDQ     1,,PR0
         1 000121   040000 316003                    CANQ    16384,DU
         1 000122   000125 600000 1                  TZE     s:8963

   8962  1 000123   400000 236003                    LDQ     -131072,DU
         1 000124   200063 756100                    STQ     DO_SUB,,AUTO

       99     8963    1        IF FIND$CMD.UNDER

   8963  1 000125   000001 236100                    LDQ     1,,PR0
         1 000126   100000 316003                    CANQ    32768,DU
         1 000127   000135 600000 1                  TZE     s:8968

      100     8964    2        THEN DO;

      101     8965    2             MASK_F = FIND$CMD.UNDER_V;

   8965  1 000130   000003 235100                    LDA     3,,PR0
         1 000131   200062 755100                    STA     MASK_F,,AUTO

      102     8966    2             S_D.FIND.MASK_F = MASK_F;

   8966  1 000132   000000 471400 xsym               LDP1    S_D$
         1 000133   105211 755100                    STA     2697,,PR1

      103     8967    2           END;

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:23   
   8967  1 000134   000140 710000 1                  TRA     s:8969

      104     8968    1        ELSE MASK_F = S_D.FIND.MASK_F;

   8968  1 000135   000000 471400 xsym               LDP1    S_D$
         1 000136   105211 235100                    LDA     2697,,PR1
         1 000137   200062 755100                    STA     MASK_F,,AUTO

      105     8969    1        IF FIND$CMD.SUBSUNDER THEN MASK_S = FIND$CMD.SUBSUNDER_V;

   8969  1 000140   000001 236100                    LDQ     1,,PR0
         1 000141   020000 316003                    CANQ    8192,DU
         1 000142   000146 600000 1                  TZE     s:8970

   8969  1 000143   000004 235100                    LDA     4,,PR0
         1 000144   200061 755100                    STA     MASK_S,,AUTO
         1 000145   000150 710000 1                  TRA     s:8971

      106     8970    1        ELSE MASK_S = -1;

   8970  1 000146   000001 335007                    LCA     1,DL
         1 000147   200061 755100                    STA     MASK_S,,AUTO

      107     8971    1        TEMP_FB = TEMP_FB & MASK_FB;

   8971  1 000150   200056 236100                    LDQ     TEMP_F,,AUTO
         1 000151   200062 376100                    ANQ     MASK_F,,AUTO
         1 000152   200056 756100                    STQ     TEMP_F,,AUTO

      108     8972    1        TEMP_SB = TEMP_SB & MASK_SB;

   8972  1 000153   200057 236100                    LDQ     TEMP_S,,AUTO
         1 000154   200061 376100                    ANQ     MASK_S,,AUTO
         1 000155   200057 756100                    STQ     TEMP_S,,AUTO

      109     8973                                                /**/
      110     8974                                                /* Main line for find/store */
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:24   
      111     8975                                                /* Store code enters here */
      112     8976                                                /**/
      113     8977    1   MAINLINE:
      114     8978    1        IF S_D.RUM

   8978  1 000156   000000 470400 xsym  MAINLINE     LDP0    S_D$
         1 000157   004755 234100                    SZN     2541,,PR0
         1 000160   000163 605000 1                  TPL     s:8980

      115     8979    1        THEN S_D.FIND_RUM = '1'B;

   8979  1 000161   400000 236003                    LDQ     -131072,DU
         1 000162   000073 756100                    STQ     59,,PR0

      116     8980    1        IF S_D.ANLZ_FILE AND DO_SUB

   8980  1 000163   005052 234100                    SZN     2602,,PR0
         1 000164   000172 605000 1                  TPL     s:8985
         1 000165   200063 234100                    SZN     DO_SUB,,AUTO
         1 000166   000172 605000 1                  TPL     s:8985

      117     8981    2        THEN DO;

      118     8982    2             S_D.ERROR = E@CANTPUTINANLZ;  /* E@CANTPUTINANLZ */

   8982  1 000167   000233 235007                    LDA     155,DL
         1 000170   000013 755100                    STA     11,,PR0

      119     8983    2             ALTRETURN;

   8983  1 000171   000000 702200 xent               TSX2  ! X66_AALT

      120     8984    2           END;
      121     8985    1        NODE = 0;

   8985  1 000172   200055 450100                    STZ     NODE,,AUTO

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:25   
      122     8986    1        IF S_D.RUM AND S_D.OVERLAID THEN CALL DDS$IC2NODE (ADDRESS, NODE) ALTRET(ERR);

   8986  1 000173   004755 234100                    SZN     2541,,PR0
         1 000174   000207 605000 1                  TPL     s:8987
         1 000175   004764 234100                    SZN     2548,,PR0
         1 000176   000207 605000 1                  TPL     s:8987

   8986  1 000177   200055 631500                    EPPR1   NODE,,AUTO
         1 000200   200113 451500                    STP1    DUM2+2,,AUTO
         1 000201   200045 633500                    EPPR3   ADDRESS,,AUTO
         1 000202   200112 453500                    STP3    DUM2+1,,AUTO
         1 000203   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000204   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000205   000000 701000 xent               TSX1    DDS$IC2NODE
         1 000206   001104 702000 1                  TSX2    ERR

      123     8987    1        IF MASK_F ~= -1 AND FIND$CMD.CMD = C_FIND AND NOT FIND$CMD.UNDER

   8987  1 000207   200062 235100                    LDA     MASK_F,,AUTO
         1 000210   000027 115000 xsym               CMPA    B_VECTNIL+23
         1 000211   000264 600000 1                  TZE     s:8998
         1 000212   200053 470500                    LDP0    DO$,,AUTO
         1 000213   000000 236100                    LDQ     0,,PR0
         1 000214   777000 376003                    ANQ     -512,DU
         1 000215   012000 116003                    CMPQ    5120,DU
         1 000216   000264 601000 1                  TNZ     s:8998
         1 000217   000001 236100                    LDQ     1,,PR0
         1 000220   100000 316003                    CANQ    32768,DU
         1 000221   000264 601000 1                  TNZ     s:8998

      124     8988    2        THEN DO;

      125     8989    2             S_D.OUTPUT = '$FMASK = ';

   8989  1 000222   000000 471400 xsym               LDP1    S_D$
         1 000223   040100 100400                    MLR     fill='040'O
         1 000224   000000 000011 0                  ADSC9   0                        cn=0,n=9
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:26   
         1 000225   105335 004000                    ADSC9   2781,,PR1                cn=0,n=2048

      126     8990    2             S_D.D$ = PINCRC(OUTPUT$, 9);

   8990  1 000226   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000227   000005 036000 2                  ADLQ    5
         1 000230   100044 756100                    STQ     36,,PR1

      127     8991    2             S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));

   8991  1 000231   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000232   001000 036003                    ADLQ    512,DU
         1 000233   100042 756100                    STQ     34,,PR1

      128     8992    2             CALL DDA$DISPFMT(%OCT_FMT, 36, MASK_F) ALTRET(ERR1);

   8992  1 000234   200062 633500                    EPPR3   MASK_F,,AUTO
         1 000235   200114 453500                    STP3    DUM2+3,,AUTO
         1 000236   000010 237000 2                  LDAQ    8
         1 000237   200112 757100                    STAQ    DUM2+1,,AUTO
         1 000240   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000241   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000242   000000 701000 xent               TSX1    DDA$DISPFMT
         1 000243   001176 702000 1                  TSX2    ERR1

      129     8993    2             CALL DDQ$WRITE (OUTPUT$, POFFC(S_D.D$, OUTPUT$));

   8993  1 000244   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000245   000020 772000                    QRL     16
         1 000246   200112 756100                    STQ     DUM2+1,,AUTO
         1 000247   000000 470400 xsym               LDP0    S_D$
         1 000250   000044 236100                    LDQ     36,,PR0
         1 000251   000020 772000                    QRL     16
         1 000252   200112 136100                    SBLQ    DUM2+1,,AUTO
         1 000253   200113 756100                    STQ     DUM2+2,,AUTO
         1 000254   200113 631500                    EPPR1   DUM2+2,,AUTO
         1 000255   200115 451500                    STP1    DUM2+4,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:27   
         1 000256   200054 633500                    EPPR3   OUTPUT$,,AUTO
         1 000257   200114 453500                    STP3    DUM2+3,,AUTO
         1 000260   200114 630500                    EPPR0   DUM2+3,,AUTO
         1 000261   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000262   000000 701000 xent               TSX1    DDQ$WRITE
         1 000263   000000 011000                    NOP     0

      130     8994    2           END;

      131     8995                                                /**/
      132     8996                                                /* Do loop for cell selection */
      133     8997                                                /**/
      134     8998    2        DO ADDRESS = ADDRESS TO MAX_ADDRESS;

   8998  1 000264   001051 710000 1                  TRA     NO_MATCH+3

      135     8999    2             IF S_D.BREAK

   8999  1 000265   000000 470400 xsym               LDP0    S_D$
         1 000266   000026 234100                    SZN     22,,PR0
         1 000267   000346 605000 1                  TPL     s:9012

      136     9000    3             THEN DO;

      137     9001    3                  S_D.OUTPUT = 'Next cell was ';

   9001  1 000270   040100 100400                    MLR     fill='040'O
         1 000271   000003 000016 0                  ADSC9   3                        cn=0,n=14
         1 000272   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      138     9002    3                  S_D.D$ = PINCRC(OUTPUT$, 14);

   9002  1 000273   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000274   000007 036000 2                  ADLQ    7
         1 000275   000044 756100                    STQ     36,,PR0

      139     9003    3                  S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:28   

   9003  1 000276   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000277   001000 036003                    ADLQ    512,DU
         1 000300   000042 756100                    STQ     34,,PR0

      140     9004    3                 CALL DDA$DISPADR( ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT,, 36) ALTRET(
              9004                           ERR1);

   9004  1 000301   000011 236000 2                  LDQ     9
         1 000302   200120 756100                    STQ     DUM2+7,,AUTO
         1 000303   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000304   000012 235000 2                  LDA     10
         1 000305   200116 757100                    STAQ    DUM2+5,,AUTO
         1 000306   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 000307   200115 451500                    STP1    DUM2+4,,AUTO
         1 000310   200047 633500                    EPPR3   DESC#,,AUTO
         1 000311   200114 453500                    STP3    DUM2+3,,AUTO
         1 000312   200046 634500                    EPPR4   SEG,,AUTO
         1 000313   200113 454500                    STP4    DUM2+2,,AUTO
         1 000314   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 000315   200112 455500                    STP5    DUM2+1,,AUTO
         1 000316   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000317   000025 631400 xsym               EPPR1   B_VECTNIL+21
         1 000320   000000 701000 xent               TSX1    DDA$DISPADR
         1 000321   001176 702000 1                  TSX2    ERR1

      141     9005    3                  CALL DDQ$WRITE( OUTPUT$, POFFC(S_D.D$, OUTPUT$));

   9005  1 000322   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000323   000020 772000                    QRL     16
         1 000324   200112 756100                    STQ     DUM2+1,,AUTO
         1 000325   000000 470400 xsym               LDP0    S_D$
         1 000326   000044 236100                    LDQ     36,,PR0
         1 000327   000020 772000                    QRL     16
         1 000330   200112 136100                    SBLQ    DUM2+1,,AUTO
         1 000331   200113 756100                    STQ     DUM2+2,,AUTO
         1 000332   200113 631500                    EPPR1   DUM2+2,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:29   
         1 000333   200115 451500                    STP1    DUM2+4,,AUTO
         1 000334   200054 633500                    EPPR3   OUTPUT$,,AUTO
         1 000335   200114 453500                    STP3    DUM2+3,,AUTO
         1 000336   200114 630500                    EPPR0   DUM2+3,,AUTO
         1 000337   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000340   000000 701000 xent               TSX1    DDQ$WRITE
         1 000341   000000 011000                    NOP     0

      142     9006    3                  CALL DDB$BREAK;

   9006  1 000342   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000343   000000 701000 xent               TSX1    DDB$BREAK
         1 000344   000000 011000                    NOP     0

      143     9007    3                  RETURN;

   9007  1 000345   000000 702200 xent               TSX2  ! X66_ARET

      144     9008    3                END;
      145     9009                                                /**/
      146     9010                                                /* Get value */
      147     9011                                                /**/
      148     9012    2            IF S_D.ANLZ_FILE THEN CALL DUL$GETMVAL (VALUE.OPS(0), ADDRESS, SEG, DESC#,
              9012                      NOT_IS) ALTRET(ERR);

   9012  1 000346   005052 234100                    SZN     2602,,PR0
         1 000347   000367 605000 1                  TPL     s:9013

   9012  1 000350   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 000351   200116 451500                    STP1    DUM2+5,,AUTO
         1 000352   200047 633500                    EPPR3   DESC#,,AUTO
         1 000353   200115 453500                    STP3    DUM2+4,,AUTO
         1 000354   200046 634500                    EPPR4   SEG,,AUTO
         1 000355   200114 454500                    STP4    DUM2+3,,AUTO
         1 000356   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 000357   200113 455500                    STP5    DUM2+2,,AUTO
         1 000360   200004 636500                    EPPR6   VALUE+1,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:30   
         1 000361   200112 456500                    STP6    DUM2+1,,AUTO
         1 000362   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000363   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000364   000000 701000 xent               TSX1    DUL$GETMVAL
         1 000365   001104 702000 1                  TSX2    ERR
         1 000366   000455 710000 1                  TRA     s:9027

      149     9013    3             ELSE IF S_D.RUM THEN DO;

   9013  1 000367   004755 234100                    SZN     2541,,PR0
         1 000370   000437 605000 1                  TPL     s:9023

      150     9014    3   MORE:               CALL DUU$GETMVAL (VALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS)

   9014  1 000371   200050 630500       MORE         EPPR0   NOT_IS,,AUTO
         1 000372   200117 450500                    STP0    DUM2+6,,AUTO
         1 000373   200047 631500                    EPPR1   DESC#,,AUTO
         1 000374   200116 451500                    STP1    DUM2+5,,AUTO
         1 000375   200046 633500                    EPPR3   SEG,,AUTO
         1 000376   200115 453500                    STP3    DUM2+4,,AUTO
         1 000377   200045 634500                    EPPR4   ADDRESS,,AUTO
         1 000400   200114 454500                    STP4    DUM2+3,,AUTO
         1 000401   200055 635500                    EPPR5   NODE,,AUTO
         1 000402   200113 455500                    STP5    DUM2+2,,AUTO
         1 000403   200003 636500                    EPPR6   VALUE,,AUTO
         1 000404   200112 456500                    STP6    DUM2+1,,AUTO
         1 000405   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000406   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000407   000000 701000 xent               TSX1    DUU$GETMVAL
         1 000410   000412 702000 1                  TSX2    s:9016
         1 000411   000436 710000 1                  TRA     s:9022

      151     9015    4                       WHENALTRETURN DO;

      152     9016    4                            IF NOT S_D.OVERLAID THEN GOTO ERR;

   9016  1 000412   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:31   
         1 000413   004764 234100                    SZN     2548,,PR0
         1 000414   001104 605000 1                  TPL     ERR

      153     9017    4                            CALL DDS$IC2NODE (ADDRESS, NODE) ALTRET (ERR);

   9017  1 000415   200055 631500                    EPPR1   NODE,,AUTO
         1 000416   200113 451500                    STP1    DUM2+2,,AUTO
         1 000417   200045 633500                    EPPR3   ADDRESS,,AUTO
         1 000420   200112 453500                    STP3    DUM2+1,,AUTO
         1 000421   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000422   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000423   000000 701000 xent               TSX1    DDS$IC2NODE
         1 000424   001104 702000 1                  TSX2    ERR

      154     9018    4                            IF NOMORE THEN GOTO ERR;

   9018  1 000425   200067 234100                    SZN     NOMORE,,AUTO
         1 000426   001104 604000 1                  TMI     ERR

      155     9019    4                            IF NODE = S_D.NODE THEN NOMORE = '1'B;

   9019  1 000427   000000 470400 xsym               LDP0    S_D$
         1 000430   200055 236100                    LDQ     NODE,,AUTO
         1 000431   004706 116100                    CMPQ    2502,,PR0
         1 000432   000435 601000 1                  TNZ     s:9020

   9019  1 000433   400000 236003                    LDQ     -131072,DU
         1 000434   200067 756100                    STQ     NOMORE,,AUTO

      156     9020    4                            GOTO MORE;

   9020  1 000435   000371 710000 1                  TRA     MORE

      157     9021    4                          END;
      158     9022    3                     END;

   9022  1 000436   000455 710000 1                  TRA     s:9027
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:32   

      159     9023    2                  ELSE CALL DDK$GETMVAL (VALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS)
              9023                           ALTRET(ERR);

   9023  1 000437   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 000440   200116 451500                    STP1    DUM2+5,,AUTO
         1 000441   200047 633500                    EPPR3   DESC#,,AUTO
         1 000442   200115 453500                    STP3    DUM2+4,,AUTO
         1 000443   200046 634500                    EPPR4   SEG,,AUTO
         1 000444   200114 454500                    STP4    DUM2+3,,AUTO
         1 000445   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 000446   200113 455500                    STP5    DUM2+2,,AUTO
         1 000447   200004 636500                    EPPR6   VALUE+1,,AUTO
         1 000450   200112 456500                    STP6    DUM2+1,,AUTO
         1 000451   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000452   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000453   000000 701000 xent               TSX1    DDK$GETMVAL
         1 000454   001104 702000 1                  TSX2    ERR

      160     9024                                                /**/
      161     9025                                                /* If find command, check for match */
      162     9026                                                /**/
      163     9027    2             IF DO_FIND

   9027  1 000455   200064 234100                    SZN     DO_FIND,,AUTO
         1 000456   000476 605000 1                  TPL     s:9036

      164     9028    3             THEN DO;

      165     9029    3                  VALUE_O = VALUE.OPS(0);

   9029  1 000457   200004 235100                    LDA     VALUE+1,,AUTO
         1 000460   200051 755100                    STA     VALUE_O,,AUTO

      166     9030    3                  TEMP_VB = VALUE_B & MASK_FB;

   9030  1 000461   200051 236100                    LDQ     VALUE_O,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:33   
         1 000462   200062 376100                    ANQ     MASK_F,,AUTO
         1 000463   200071 756100                    STQ     TEMP_V,,AUTO

      167     9031    3                  IF FIND$CMD.NOTFLAG

   9031  1 000464   200053 470500                    LDP0    DO$,,AUTO
         1 000465   000001 430100                    FSZN    1,,PR0
         1 000466   000473 605000 1                  TPL     s:9034

      168     9032    3                  THEN IF TEMP_V = TEMP_F THEN GOTO NO_MATCH;

   9032  1 000467   200071 236100                    LDQ     TEMP_V,,AUTO
         1 000470   200056 116100                    CMPQ    TEMP_F,,AUTO
         1 000471   001046 600000 1                  TZE     NO_MATCH
         1 000472   000476 710000 1                  TRA     s:9036

      169     9033    3                       ELSE ;
      170     9034    3                  ELSE IF TEMP_V ~= TEMP_F THEN GOTO NO_MATCH;

   9034  1 000473   200071 236100                    LDQ     TEMP_V,,AUTO
         1 000474   200056 116100                    CMPQ    TEMP_F,,AUTO
         1 000475   001046 601000 1                  TNZ     NO_MATCH

      171     9035    3                END;

      172     9036    2             FOUND_SOME = '1'B;

   9036  1 000476   400000 236003                    LDQ     -131072,DU
         1 000477   200066 756100                    STQ     FOUND_SOME,,AUTO

      173     9037                                                /**/
      174     9038                                                /* If store, or find and sub specified
      175     9039                                                   make the substitution */
      176     9040                                                /**/
      177     9041    2             IF DO_SUB

   9041  1 000500   200063 234100                    SZN     DO_SUB,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:34   
         1 000501   000557 605000 1                  TPL     s:9053

      178     9042    3             THEN DO;

      179     9043    3                  VALUE_O = VALUE.OPS(0);

   9043  1 000502   200004 235100                    LDA     VALUE+1,,AUTO
         1 000503   200051 755100                    STA     VALUE_O,,AUTO

      180     9044    3                  TEMP_NVB = (VALUE_B & ~MASK_SB) | TEMP_SB;

   9044  1 000504   200061 236100                    LDQ     MASK_S,,AUTO
         1 000505   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000506   200051 376100                    ANQ     VALUE_O,,AUTO
         1 000507   200057 276100                    ORQ     TEMP_S,,AUTO
         1 000510   200060 756100                    STQ     TEMP_NV,,AUTO

      181     9045    3                  IF S_D.RUM

   9045  1 000511   000000 470400 xsym               LDP0    S_D$
         1 000512   004755 234100                    SZN     2541,,PR0
         1 000513   000541 605000 1                  TPL     s:9051

      182     9046    4                  THEN DO;

      183     9047    4                       TVALUE.SIZE = 1;

   9047  1 000514   000001 235007                    LDA     1,DL
         1 000515   200024 755100                    STA     TVALUE,,AUTO

      184     9048    4                       TVALUE.OPS(0) = TEMP_NV;

   9048  1 000516   200060 235100                    LDA     TEMP_NV,,AUTO
         1 000517   200025 755100                    STA     TVALUE+1,,AUTO

      185     9049    4                       CALL DUU$PUTMVAL (TVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS)
              9049                                ALTRET(ERR);
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:35   

   9049  1 000520   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 000521   200117 451500                    STP1    DUM2+6,,AUTO
         1 000522   200047 633500                    EPPR3   DESC#,,AUTO
         1 000523   200116 453500                    STP3    DUM2+5,,AUTO
         1 000524   200046 634500                    EPPR4   SEG,,AUTO
         1 000525   200115 454500                    STP4    DUM2+4,,AUTO
         1 000526   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 000527   200114 455500                    STP5    DUM2+3,,AUTO
         1 000530   200055 636500                    EPPR6   NODE,,AUTO
         1 000531   200113 456500                    STP6    DUM2+2,,AUTO
         1 000532   200024 637500                    EPPR7   TVALUE,,AUTO
         1 000533   200112 457500                    STP7    DUM2+1,,AUTO
         1 000534   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000535   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000536   000000 701000 xent               TSX1    DUU$PUTMVAL
         1 000537   001104 702000 1                  TSX2    ERR

      186     9050    4                     END;

   9050  1 000540   000557 710000 1                  TRA     s:9053

      187     9051    3                  ELSE CALL DDK$PUTMVAL (TEMP_NV, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
              9051                           ERR);

   9051  1 000541   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 000542   200116 451500                    STP1    DUM2+5,,AUTO
         1 000543   200047 633500                    EPPR3   DESC#,,AUTO
         1 000544   200115 453500                    STP3    DUM2+4,,AUTO
         1 000545   200046 634500                    EPPR4   SEG,,AUTO
         1 000546   200114 454500                    STP4    DUM2+3,,AUTO
         1 000547   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 000550   200113 455500                    STP5    DUM2+2,,AUTO
         1 000551   200060 636500                    EPPR6   TEMP_NV,,AUTO
         1 000552   200112 456500                    STP6    DUM2+1,,AUTO
         1 000553   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000554   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:36   
         1 000555   000000 701000 xent               TSX1    DDK$PUTMVAL
         1 000556   001104 702000 1                  TSX2    ERR

      188     9052    3                END;

      189     9053    2             IF DO_FIND OR DO_STORE

   9053  1 000557   200064 234100                    SZN     DO_FIND,,AUTO
         1 000560   000563 604000 1                  TMI     s:9055
         1 000561   200065 234100                    SZN     DO_STORE,,AUTO
         1 000562   001046 605000 1                  TPL     NO_MATCH

      190     9054    3             THEN DO;                      /* Report the find */

      191     9055    3                  S_D.OUTPUT = ' ';

   9055  1 000563   000000 470400 xsym               LDP0    S_D$
         1 000564   040100 100400                    MLR     fill='040'O
         1 000565   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000566   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      192     9056    3                  S_D.D$ = OUTPUT$;

   9056  1 000567   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000570   000044 756100                    STQ     36,,PR0

      193     9057    3                  S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));

   9057  1 000571   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000572   001000 036003                    ADLQ    512,DU
         1 000573   000042 756100                    STQ     34,,PR0

      194     9058    3                 CALL DDA$DISPADR( ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT,, 36) ALTRET(
              9058                           ERR1);

   9058  1 000574   000011 236000 2                  LDQ     9
         1 000575   200120 756100                    STQ     DUM2+7,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:37   
         1 000576   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000577   000012 235000 2                  LDA     10
         1 000600   200116 757100                    STAQ    DUM2+5,,AUTO
         1 000601   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 000602   200115 451500                    STP1    DUM2+4,,AUTO
         1 000603   200047 633500                    EPPR3   DESC#,,AUTO
         1 000604   200114 453500                    STP3    DUM2+3,,AUTO
         1 000605   200046 634500                    EPPR4   SEG,,AUTO
         1 000606   200113 454500                    STP4    DUM2+2,,AUTO
         1 000607   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 000610   200112 455500                    STP5    DUM2+1,,AUTO
         1 000611   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000612   000025 631400 xsym               EPPR1   B_VECTNIL+21
         1 000613   000000 701000 xent               TSX1    DDA$DISPADR
         1 000614   001176 702000 1                  TSX2    ERR1

      195     9059    3                  S_D.D$->CHAR2 = '/ ';

   9059  1 000615   000000 470400 xsym               LDP0    S_D$
         1 000616   000044 471500                    LDP1    36,,PR0
         1 000617   040100 100400                    MLR     fill='040'O
         1 000620   000007 000002 0                  ADSC9   7                        cn=0,n=2
         1 000621   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      196     9060    3                  S_D.D$ = PINCRC(S_D.D$, 2);

   9060  1 000622   000044 236100                    LDQ     36,,PR0
         1 000623   400000 036007                    ADLQ    -131072,DL
         1 000624   000044 756100                    STQ     36,,PR0

      197     9061    3                  CALL DDA$DISPFMT(DISP_FMT, 36, VALUE.OPS(0)) ALTRET(ERR1);

   9061  1 000625   200004 631500                    EPPR1   VALUE+1,,AUTO
         1 000626   200114 451500                    STP1    DUM2+3,,AUTO
         1 000627   000011 236000 2                  LDQ     9
         1 000630   200113 756100                    STQ     DUM2+2,,AUTO
         1 000631   200070 633500                    EPPR3   DISP_FMT,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:38   
         1 000632   200112 453500                    STP3    DUM2+1,,AUTO
         1 000633   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000634   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000635   000000 701000 xent               TSX1    DDA$DISPFMT
         1 000636   001176 702000 1                  TSX2    ERR1

      198     9062    3                  IF DO_SUB

   9062  1 000637   200063 234100                    SZN     DO_SUB,,AUTO
         1 000640   000663 605000 1                  TPL     s:9068

      199     9063    4                  THEN DO;

      200     9064    4                       S_D.D$->CHAR4 = ' <- ';

   9064  1 000641   000000 470400 xsym               LDP0    S_D$
         1 000642   000044 471500                    LDP1    36,,PR0
         1 000643   040100 100400                    MLR     fill='040'O
         1 000644   000010 000004 0                  ADSC9   8                        cn=0,n=4
         1 000645   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

      201     9065    4                       S_D.D$ = PINCRC(S_D.D$, 4);

   9065  1 000646   000044 236100                    LDQ     36,,PR0
         1 000647   000001 036003                    ADLQ    1,DU
         1 000650   000044 756100                    STQ     36,,PR0

      202     9066    4                       CALL DDA$DISPFMT(DISP_FMT, 36, TEMP_NV) ALTRET(ERR1);

   9066  1 000651   200060 631500                    EPPR1   TEMP_NV,,AUTO
         1 000652   200114 451500                    STP1    DUM2+3,,AUTO
         1 000653   000011 236000 2                  LDQ     9
         1 000654   200113 756100                    STQ     DUM2+2,,AUTO
         1 000655   200070 633500                    EPPR3   DISP_FMT,,AUTO
         1 000656   200112 453500                    STP3    DUM2+1,,AUTO
         1 000657   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000660   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:39   
         1 000661   000000 701000 xent               TSX1    DDA$DISPFMT
         1 000662   001176 702000 1                  TSX2    ERR1

      203     9067    4                     END;

      204     9068    3                  IF DO_FIND

   9068  1 000663   200064 234100                    SZN     DO_FIND,,AUTO
         1 000664   000705 605000 1                  TPL     s:9070

      205     9069    3                  THEN CALL DDQ$WRITE (OUTPUT$, POFFC(S_D.D$, OUTPUT$));

   9069  1 000665   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000666   000020 772000                    QRL     16
         1 000667   200112 756100                    STQ     DUM2+1,,AUTO
         1 000670   000000 470400 xsym               LDP0    S_D$
         1 000671   000044 236100                    LDQ     36,,PR0
         1 000672   000020 772000                    QRL     16
         1 000673   200112 136100                    SBLQ    DUM2+1,,AUTO
         1 000674   200113 756100                    STQ     DUM2+2,,AUTO
         1 000675   200113 631500                    EPPR1   DUM2+2,,AUTO
         1 000676   200115 451500                    STP1    DUM2+4,,AUTO
         1 000677   200054 633500                    EPPR3   OUTPUT$,,AUTO
         1 000700   200114 453500                    STP3    DUM2+3,,AUTO
         1 000701   200114 630500                    EPPR0   DUM2+3,,AUTO
         1 000702   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000703   000000 701000 xent               TSX1    DDQ$WRITE
         1 000704   000000 011000                    NOP     0

      206     9070    3                  IF S_D.RUM AND NOT S_D.RUM_TEST AND DO_SUB

   9070  1 000705   000000 470400 xsym               LDP0    S_D$
         1 000706   004755 234100                    SZN     2541,,PR0
         1 000707   001046 605000 1                  TPL     NO_MATCH
         1 000710   005004 234100                    SZN     2564,,PR0
         1 000711   001046 604000 1                  TMI     NO_MATCH
         1 000712   200063 234100                    SZN     DO_SUB,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:40   
         1 000713   001046 605000 1                  TPL     NO_MATCH

      207     9071    4                  THEN DO;

      208     9072    4                       S_D.OUTPUT = ' ';

   9072  1 000714   040100 100400                    MLR     fill='040'O
         1 000715   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000716   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      209     9073    4                       S_D.D$ = OUTPUT$;

   9073  1 000717   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000720   000044 756100                    STQ     36,,PR0

      210     9074    4                       S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));

   9074  1 000721   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 000722   001000 036003                    ADLQ    512,DU
         1 000723   000042 756100                    STQ     34,,PR0

      211     9075    4                       CALL DDA$DISPADR( ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT, '1'B,
              9075                                36) ALTRET(ERR1);

   9075  1 000724   000011 236000 2                  LDQ     9
         1 000725   200120 756100                    STQ     DUM2+7,,AUTO
         1 000726   000014 237000 2                  LDAQ    12
         1 000727   200116 757100                    STAQ    DUM2+5,,AUTO
         1 000730   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 000731   200115 451500                    STP1    DUM2+4,,AUTO
         1 000732   200047 633500                    EPPR3   DESC#,,AUTO
         1 000733   200114 453500                    STP3    DUM2+3,,AUTO
         1 000734   200046 634500                    EPPR4   SEG,,AUTO
         1 000735   200113 454500                    STP4    DUM2+2,,AUTO
         1 000736   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 000737   200112 455500                    STP5    DUM2+1,,AUTO
         1 000740   200112 630500                    EPPR0   DUM2+1,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:41   
         1 000741   000025 631400 xsym               EPPR1   B_VECTNIL+21
         1 000742   000000 701000 xent               TSX1    DDA$DISPADR
         1 000743   001176 702000 1                  TSX2    ERR1

      212     9076    4                       S_D.D$->CHAR2 = '/ ';

   9076  1 000744   000000 470400 xsym               LDP0    S_D$
         1 000745   000044 471500                    LDP1    36,,PR0
         1 000746   040100 100400                    MLR     fill='040'O
         1 000747   000007 000002 0                  ADSC9   7                        cn=0,n=2
         1 000750   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      213     9077    4                       S_D.D$ = PINCRC(S_D.D$, 2);

   9077  1 000751   000044 236100                    LDQ     36,,PR0
         1 000752   400000 036007                    ADLQ    -131072,DL
         1 000753   000044 756100                    STQ     36,,PR0

      214     9078    4                      CALL DDA$DISPFMT(DISP_FMT, 36, VALUE.OPS(0), , '1'B) ALTRET(ERR1
              9078                                );

   9078  1 000754   000015 236000 2                  LDQ     13
         1 000755   200116 756100                    STQ     DUM2+5,,AUTO
         1 000756   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000757   200115 756100                    STQ     DUM2+4,,AUTO
         1 000760   200004 631500                    EPPR1   VALUE+1,,AUTO
         1 000761   200114 451500                    STP1    DUM2+3,,AUTO
         1 000762   000011 236000 2                  LDQ     9
         1 000763   200113 756100                    STQ     DUM2+2,,AUTO
         1 000764   200070 633500                    EPPR3   DISP_FMT,,AUTO
         1 000765   200112 453500                    STP3    DUM2+1,,AUTO
         1 000766   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 000767   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000770   000000 701000 xent               TSX1    DDA$DISPFMT
         1 000771   001176 702000 1                  TSX2    ERR1

      215     9079    4                       IF DO_SUB
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:42   

   9079  1 000772   200063 234100                    SZN     DO_SUB,,AUTO
         1 000773   001022 605000 1                  TPL     s:9085

      216     9080    5                       THEN DO;

      217     9081    5                            S_D.D$->CHAR4 = ' <- ';

   9081  1 000774   000000 470400 xsym               LDP0    S_D$
         1 000775   000044 471500                    LDP1    36,,PR0
         1 000776   040100 100400                    MLR     fill='040'O
         1 000777   000010 000004 0                  ADSC9   8                        cn=0,n=4
         1 001000   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

      218     9082    5                            S_D.D$ = PINCRC(S_D.D$, 4);

   9082  1 001001   000044 236100                    LDQ     36,,PR0
         1 001002   000001 036003                    ADLQ    1,DU
         1 001003   000044 756100                    STQ     36,,PR0

      219     9083    5                           CALL DDA$DISPFMT(DISP_FMT, 36, TEMP_NV, , '1'B) ALTRET(ERR1
              9083                                     );

   9083  1 001004   000015 236000 2                  LDQ     13
         1 001005   200116 756100                    STQ     DUM2+5,,AUTO
         1 001006   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001007   200115 756100                    STQ     DUM2+4,,AUTO
         1 001010   200060 631500                    EPPR1   TEMP_NV,,AUTO
         1 001011   200114 451500                    STP1    DUM2+3,,AUTO
         1 001012   000011 236000 2                  LDQ     9
         1 001013   200113 756100                    STQ     DUM2+2,,AUTO
         1 001014   200070 633500                    EPPR3   DISP_FMT,,AUTO
         1 001015   200112 453500                    STP3    DUM2+1,,AUTO
         1 001016   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 001017   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001020   000000 701000 xent               TSX1    DDA$DISPFMT
         1 001021   001176 702000 1                  TSX2    ERR1
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:43   

      220     9084    5                          END;

      221     9085    4                       TEMP = POFFC(S_D.D$, OUTPUT$);

   9085  1 001022   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 001023   000020 772000                    QRL     16
         1 001024   200112 756100                    STQ     DUM2+1,,AUTO
         1 001025   000000 470400 xsym               LDP0    S_D$
         1 001026   000044 236100                    LDQ     36,,PR0
         1 001027   000020 772000                    QRL     16
         1 001030   200112 136100                    SBLQ    DUM2+1,,AUTO
         1 001031   200072 756100                    STQ     TEMP,,AUTO

      222     9086    4                      CALL DDQ$WRITELM (%TYPRUM, 0, NODE, OUTPUT$, TEMP) ALTRET(ERR2);

   9086  1 001032   200072 631500                    EPPR1   TEMP,,AUTO
         1 001033   200116 451500                    STP1    DUM2+5,,AUTO
         1 001034   200054 633500                    EPPR3   OUTPUT$,,AUTO
         1 001035   200115 453500                    STP3    DUM2+4,,AUTO
         1 001036   200055 634500                    EPPR4   NODE,,AUTO
         1 001037   200114 454500                    STP4    DUM2+3,,AUTO
         1 001040   000020 237000 2                  LDAQ    16
         1 001041   200112 757100                    STAQ    DUM2+1,,AUTO
         1 001042   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 001043   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001044   000000 701000 xent               TSX1    DDQ$WRITELM
         1 001045   001075 702000 1                  TSX2    ERR2

      223     9087    4                     END;

      224     9088    3                END;

      225     9089    2   NO_MATCH:
      226     9090    2           END;                            /* End do address to MAX_ADDRESS */

   9090  1 001046   200045 235100       NO_MATCH     LDA     ADDRESS,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:44   
         1 001047   000001 035007                    ADLA    1,DL
         1 001050   200045 755100                    STA     ADDRESS,,AUTO
         1 001051   200052 236100                    LDQ     MAX_ADDRESS,,AUTO
         1 001052   200045 116100                    CMPQ    ADDRESS,,AUTO
         1 001053   000265 603000 1                  TRC     s:8999

      227     9091    1        IF NOT FOUND_SOME

   9091  1 001054   200066 234100                    SZN     FOUND_SOME,,AUTO
         1 001055   001072 604000 1                  TMI     s:9096

      228     9092    2        THEN DO;

      229     9093    2             S_D.OUTPUT = 'None';

   9093  1 001056   000000 470400 xsym               LDP0    S_D$
         1 001057   040100 100400                    MLR     fill='040'O
         1 001060   000011 000004 0                  ADSC9   9                        cn=0,n=4
         1 001061   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      230     9094    2             CALL DDQ$WRITE(OUTPUT$, 4);

   9094  1 001062   000017 236000 2                  LDQ     15
         1 001063   200113 756100                    STQ     DUM2+2,,AUTO
         1 001064   200054 631500                    EPPR1   OUTPUT$,,AUTO
         1 001065   200112 451500                    STP1    DUM2+1,,AUTO
         1 001066   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 001067   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001070   000000 701000 xent               TSX1    DDQ$WRITE
         1 001071   000000 011000                    NOP     0

      231     9095    2           END;

      232     9096    1        S_D.FIND_RUM = '0'B;

   9096  1 001072   000000 470400 xsym               LDP0    S_D$
         1 001073   000073 450100                    STZ     59,,PR0
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:45   

      233     9097    1        RETURN;

   9097  1 001074   000000 702200 xent               TSX2  ! X66_ARET

      234     9098    1   ERR2:
      235     9099    1        S_D.ERROR = E@DELBUG;              /* E@DELBUG */

   9099  1 001075   000766 235007       ERR2         LDA     502,DL
         1 001076   000000 470400 xsym               LDP0    S_D$
         1 001077   000013 755100                    STA     11,,PR0

      236     9100    1        CALL DDE$ERROR;

   9100  1 001100   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001101   000000 701000 xent               TSX1    DDE$ERROR
         1 001102   000000 011000                    NOP     0

      237     9101    1        GOTO ERR1;

   9101  1 001103   001176 710000 1                  TRA     ERR1

      238     9102    1   ERR:
      239     9103    1        IF DO_FIND

   9103  1 001104   200064 234100       ERR          SZN     DO_FIND,,AUTO
         1 001105   001116 605000 1                  TPL     s:9109

      240     9104    2        THEN DO;

      241     9105    2             S_D.OUTPUT = 'FIND terminated at ';

   9105  1 001106   000000 470400 xsym               LDP0    S_D$
         1 001107   040100 100400                    MLR     fill='040'O
         1 001110   000012 000023 0                  ADSC9   10                       cn=0,n=19
         1 001111   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:46   
      242     9106    2             S_D.D$ = PINCRC(OUTPUT$, SIZEC('FIND terminated at '));

   9106  1 001112   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 001113   000022 036000 2                  ADLQ    18
         1 001114   000044 756100                    STQ     36,,PR0

      243     9107    2           END;

   9107  1 001115   001125 710000 1                  TRA     s:9112

      244     9108    2        ELSE DO;

      245     9109    2             S_D.OUTPUT = 'STORE terminated at ';

   9109  1 001116   000000 470400 xsym               LDP0    S_D$
         1 001117   040100 100400                    MLR     fill='040'O
         1 001120   000017 000024 0                  ADSC9   15                       cn=0,n=20
         1 001121   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      246     9110    2             S_D.D$ = PINCRC(OUTPUT$, SIZEC('STORE terminated at '));

   9110  1 001122   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 001123   000005 036003                    ADLQ    5,DU
         1 001124   000044 756100                    STQ     36,,PR0

      247     9111    2           END;

      248     9112    1        S_D.DESCL$ = PINCRC(OUTPUT$, SIZEC(S_D.OUTPUT));

   9112  1 001125   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 001126   001000 036003                    ADLQ    512,DU
         1 001127   000042 756100                    STQ     34,,PR0

      249     9113    1        CALL DDA$DISPADR( ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT,, 36);

   9113  1 001130   000011 236000 2                  LDQ     9
         1 001131   200120 756100                    STQ     DUM2+7,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:47   
         1 001132   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001133   000012 235000 2                  LDA     10
         1 001134   200116 757100                    STAQ    DUM2+5,,AUTO
         1 001135   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 001136   200115 451500                    STP1    DUM2+4,,AUTO
         1 001137   200047 633500                    EPPR3   DESC#,,AUTO
         1 001140   200114 453500                    STP3    DUM2+3,,AUTO
         1 001141   200046 634500                    EPPR4   SEG,,AUTO
         1 001142   200113 454500                    STP4    DUM2+2,,AUTO
         1 001143   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 001144   200112 455500                    STP5    DUM2+1,,AUTO
         1 001145   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 001146   000025 631400 xsym               EPPR1   B_VECTNIL+21
         1 001147   000000 701000 xent               TSX1    DDA$DISPADR
         1 001150   000000 011000                    NOP     0

      250     9114    1        CALL DDQ$WRITE(OUTPUT$, POFFC(S_D.D$, OUTPUT$));

   9114  1 001151   200054 236100                    LDQ     OUTPUT$,,AUTO
         1 001152   000020 772000                    QRL     16
         1 001153   200112 756100                    STQ     DUM2+1,,AUTO
         1 001154   000000 470400 xsym               LDP0    S_D$
         1 001155   000044 236100                    LDQ     36,,PR0
         1 001156   000020 772000                    QRL     16
         1 001157   200112 136100                    SBLQ    DUM2+1,,AUTO
         1 001160   200113 756100                    STQ     DUM2+2,,AUTO
         1 001161   200113 631500                    EPPR1   DUM2+2,,AUTO
         1 001162   200115 451500                    STP1    DUM2+4,,AUTO
         1 001163   200054 633500                    EPPR3   OUTPUT$,,AUTO
         1 001164   200114 453500                    STP3    DUM2+3,,AUTO
         1 001165   200114 630500                    EPPR0   DUM2+3,,AUTO
         1 001166   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001167   000000 701000 xent               TSX1    DDQ$WRITE
         1 001170   000000 011000                    NOP     0

      251     9115    1        IF S_D.FIND_RUM

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:48   
   9115  1 001171   000000 470400 xsym               LDP0    S_D$
         1 001172   000073 234100                    SZN     59,,PR0
         1 001173   001176 605000 1                  TPL     ERR1

      252     9116    2        THEN DO;

      253     9117    2             S_D.FIND_RUM = '0'B;

   9117  1 001174   000073 450100                    STZ     59,,PR0

      254     9118    2             RETURN;

   9118  1 001175   000000 702200 xent               TSX2  ! X66_ARET

      255     9119    2           END;
      256     9120    1   ERR1:
      257     9121    1        ALTRETURN;

   9121  1 001176   000000 702200 xent  ERR1         TSX2  ! X66_AALT

      258     9122        %EJECT;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:49   
      259     9123                                                /**/
      260     9124                                           /* Set up range, common for find and store.
      261     9125                                              If range was specified, store it in S_D,
      262     9126                                              if not, get it from S_D. */
      263     9127                                                /**/
      264     9128    1   SETUP_FROM: PROC ALTRET;

   9128  1 001177   200100 741300       SETUP_FROM   STX1  ! TEMP+6,,AUTO

      265     9129    2        IF FIND$CMD.FROM

   9129  1 001200   200053 470500                    LDP0    DO$,,AUTO
         1 001201   000001 236100                    LDQ     1,,PR0
         1 001202   200000 316003                    CANQ    65536,DU
         1 001203   001242 600000 1                  TZE     s:9142

      266     9130    3        THEN DO;

      267     9131    3             CALL DDK$EVAL( ADDRESS, SEG, DESC#, NOT_IS) ALTRET(ERR);

   9131  1 001204   200050 631500                    EPPR1   NOT_IS,,AUTO
         1 001205   200115 451500                    STP1    DUM2+4,,AUTO
         1 001206   200047 633500                    EPPR3   DESC#,,AUTO
         1 001207   200114 453500                    STP3    DUM2+3,,AUTO
         1 001210   200046 634500                    EPPR4   SEG,,AUTO
         1 001211   200113 454500                    STP4    DUM2+2,,AUTO
         1 001212   200045 635500                    EPPR5   ADDRESS,,AUTO
         1 001213   200112 455500                    STP5    DUM2+1,,AUTO
         1 001214   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 001215   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001216   000000 701000 xent               TSX1    DDK$EVAL
         1 001217   001262 702000 1                  TSX2    ERR

      268     9132                                                /* Save the new from info in S_D. */
      269     9133    3             S_D.FIND.ADDRESS = ADDRESS;

   9133  1 001220   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:50   
         1 001221   200045 235100                    LDA     ADDRESS,,AUTO
         1 001222   005205 755100                    STA     2693,,PR0

      270     9134    3             S_D.FIND.SEG = SEG;

   9134  1 001223   200046 236100                    LDQ     SEG,,AUTO
         1 001224   005204 756100                    STQ     2692,,PR0

      271     9135    3             S_D.FIND.DESC# = DESC#;

   9135  1 001225   200047 235100                    LDA     DESC#,,AUTO
         1 001226   005206 755100                    STA     2694,,PR0

      272     9136    3             S_D.FIND.NUM = FIND$CMD.NUM;

   9136  1 001227   200053 471500                    LDP1    DO$,,AUTO
         1 001230   100002 235100                    LDA     2,,PR1
         1 001231   005207 755100                    STA     2695,,PR0

      273     9137    3             S_D.FIND.NOT_IS = NOT_IS;

   9137  1 001232   200050 236100                    LDQ     NOT_IS,,AUTO
         1 001233   400000 376003                    ANQ     -131072,DU
         1 001234   005210 756100                    STQ     2696,,PR0

      274     9138    3             MAX_ADDRESS = ADDRESS + FIND$CMD.NUM -1;

   9138  1 001235   200045 236100                    LDQ     ADDRESS,,AUTO
         1 001236   100002 036100                    ADLQ    2,,PR1
         1 001237   000001 136007                    SBLQ    1,DL
         1 001240   200052 756100                    STQ     MAX_ADDRESS,,AUTO

      275     9139    3           END;

   9139  1 001241   001260 710000 1                  TRA     s:9148

      276     9140    3        ELSE DO;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:51   

      277     9141                                                /* Get values from S_D */
      278     9142    3             ADDRESS=S_D.FIND.ADDRESS;

   9142  1 001242   000000 471400 xsym               LDP1    S_D$
         1 001243   105205 235100                    LDA     2693,,PR1
         1 001244   200045 755100                    STA     ADDRESS,,AUTO

      279     9143    3             SEG = S_D.FIND.SEG;

   9143  1 001245   105204 235100                    LDA     2692,,PR1
         1 001246   200046 755100                    STA     SEG,,AUTO

      280     9144    3             DESC# = S_D.FIND.DESC#;

   9144  1 001247   105206 235100                    LDA     2694,,PR1
         1 001250   200047 755100                    STA     DESC#,,AUTO

      281     9145    3             NOT_IS = S_D.FIND.NOT_IS;

   9145  1 001251   105210 236100                    LDQ     2696,,PR1
         1 001252   400000 376003                    ANQ     -131072,DU
         1 001253   200050 756100                    STQ     NOT_IS,,AUTO

      282     9146    3             MAX_ADDRESS = ADDRESS + S_D.FIND.NUM - 1;

   9146  1 001254   200045 236100                    LDQ     ADDRESS,,AUTO
         1 001255   105207 036100                    ADLQ    2695,,PR1
         1 001256   000001 136007                    SBLQ    1,DL
         1 001257   200052 756100                    STQ     MAX_ADDRESS,,AUTO

      283     9147    3           END;

      284     9148    2        RETURN;

   9148  1 001260   200100 221300                    LDX1  ! TEMP+6,,AUTO
         1 001261   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:52   

      285     9149    2   ERR: ALTRETURN;

   9149  1 001262   200100 221300       ERR          LDX1  ! TEMP+6,,AUTO
         1 001263   000000 702211                    TSX2  ! 0,X1

      286     9150    2   END SETUP_FROM;
      287     9151        %EJECT;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:53   
      288     9152    1   IORVALUE: PROC(RVALUE, IFLAG, ZFLAG, XFLAG) ALTRET;

   9152  1 001264   200100 741300       IORVALUE     STX1  ! TEMP+6,,AUTO

      289     9153    2   DCL RVALUE UBIN;
      290     9154    2   DCL IFLAG BIT(1) UNAL;
      291     9155    2   DCL ZFLAG BIT(1) UNAL;
      292     9156    2   DCL XFLAG BIT(1) UNAL;
      293     9157        /*D* NAME: IORVALUE */
      294     9158        /*D* The routine IOVALUE  constructs a 36-bit value from a data
      295     9159             descriptor optionally preceded  by an instruction template
      296     9160             as specified by IFLAG.   This input information is at S_D.D$,
      297     9161             and upon normal return S_D.D$ points to the next word following
      298     9162             the data descriptor.  ALTRET  is taken if the address data
      299     9163             descriptor cant be evaluated.
      300     9164                                                     */
      301     9165    2   DCL VALUE UBIN;
      302     9166    2   DCL 1 OVALUE REDEF VALUE,
      303     9167    2         2 * UBIN(3) UNAL,
      304     9168    2         2 OFFSET SBIN(15) UNAL,
      305     9169    2         2 * UBIN(11) UNAL,
      306     9170    2         2 BIT29 BIT(1) UNAL,
      307     9171    2         2 * UBIN(6) UNAL;
      308     9172    2   DCL 1 YVALUE REDEF VALUE,
      309     9173    2         2 Y UBIN(18) UNAL,
      310     9174    2         2 * UBIN(18) UNAL;
      311     9175    2   DCL UBIN36 UBIN BASED;
      312     9176    2   DCL ADDRESS UBIN;
      313     9177    2   DCL NOT_IS BIT(1);
      314     9178    2   DCL DUM UBIN;
      315     9179    2   DCL DUM2 UBIN;
      316     9180                                                /**/
      317     9181    2        IF IFLAG

   9181  1 001265   200102 470500                    LDP0    @IFLAG,,AUTO
         1 001266   000000 066500                    CMPB    filb='0'B
         1 001267   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:54   
         1 001270   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 001271   001301 600000 1                  TZE     s:9186

      318     9182    3        THEN DO;

      319     9183    3             VALUE = S_D.DESC$ -> UBIN36;

   9183  1 001272   000000 471400 xsym               LDP1    S_D$
         1 001273   100041 473500                    LDP3    33,,PR1
         1 001274   300000 235100                    LDA     0,,PR3
         1 001275   200105 755100                    STA     VALUE,,AUTO

      320     9184    3             S_D.DESC$ = PINCRW(S_D.DESC$, 1);

   9184  1 001276   100041 236100                    LDQ     33,,PR1
         1 001277   000001 036003                    ADLQ    1,DU
         1 001300   100041 756100                    STQ     33,,PR1

      321     9185    3           END;

      322     9186    2        CALL DDK$EVAL(ADDRESS, DUM, DUM2, NOT_IS) ALTRET(ARET);

   9186  1 001301   200107 631500                    EPPR1   NOT_IS,,AUTO
         1 001302   200115 451500                    STP1    DUM2+4,,AUTO
         1 001303   200111 633500                    EPPR3   DUM2,,AUTO
         1 001304   200114 453500                    STP3    DUM2+3,,AUTO
         1 001305   200110 634500                    EPPR4   DUM,,AUTO
         1 001306   200113 454500                    STP4    DUM2+2,,AUTO
         1 001307   200106 635500                    EPPR5   ADDRESS,,AUTO
         1 001310   200112 455500                    STP5    DUM2+1,,AUTO
         1 001311   200112 630500                    EPPR0   DUM2+1,,AUTO
         1 001312   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001313   000000 701000 xent               TSX1    DDK$EVAL
         1 001314   001366 702000 1                  TSX2    ARET

      323     9187    2        IF NOT_IS

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:55   
   9187  1 001315   200107 234100                    SZN     NOT_IS,,AUTO
         1 001316   001324 605000 1                  TPL     s:9192

      324     9188    3        THEN DO;

      325     9189    3             S_D.ERROR = E@BADVALEXP;      /* E@BADVALEXP */

   9189  1 001317   000126 235007                    LDA     86,DL
         1 001320   000000 470400 xsym               LDP0    S_D$
         1 001321   000013 755100                    STA     11,,PR0

      326     9190    3             ALTRETURN;

   9190  1 001322   200100 221300                    LDX1  ! TEMP+6,,AUTO
         1 001323   000000 702211                    TSX2  ! 0,X1

      327     9191    3           END;
      328     9192    2        IF IFLAG

   9192  1 001324   200102 470500                    LDP0    @IFLAG,,AUTO
         1 001325   000000 066500                    CMPB    filb='0'B
         1 001326   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 001327   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 001330   001357 600000 1                  TZE     s:9196

      329     9193    2        THEN IF ( OVALUE.BIT29 AND NOT ZFLAG ) OR XFLAG

   9193  1 001331   200105 236100                    LDQ     VALUE,,AUTO
         1 001332   000100 316007                    CANQ    64,DL
         1 001333   001341 600000 1                  TZE     s:9193+8
         1 001334   200103 471500                    LDP1    @ZFLAG,,AUTO
         1 001335   000000 066500                    CMPB    filb='0'B
         1 001336   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         1 001337   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 001340   001346 600000 1                  TZE     s:9194
         1 001341   200104 471500                    LDP1    @XFLAG,,AUTO
         1 001342   000000 066500                    CMPB    filb='0'B
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:56   
         1 001343   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         1 001344   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 001345   001354 600000 1                  TZE     s:9195

      330     9194    2             THEN OVALUE.OFFSET = ADDRESS;

   9194  1 001346   200106 236100                    LDQ     ADDRESS,,AUTO
         1 001347   000022 736000                    QLS     18
         1 001350   200105 676100                    ERQ     VALUE,,AUTO
         1 001351   077777 376003                    ANQ     32767,DU
         1 001352   200105 656100                    ERSQ    VALUE,,AUTO
         1 001353   001361 710000 1                  TRA     s:9197

      331     9195    2             ELSE YVALUE.Y = ADDRESS;

   9195  1 001354   200106 720100                    LXL0    ADDRESS,,AUTO
         1 001355   200105 740100                    STX0    VALUE,,AUTO
         1 001356   001361 710000 1                  TRA     s:9197

      332     9196    2        ELSE VALUE = ADDRESS;

   9196  1 001357   200106 235100                    LDA     ADDRESS,,AUTO
         1 001360   200105 755100                    STA     VALUE,,AUTO

      333     9197    2        RVALUE = VALUE;

   9197  1 001361   200101 471500                    LDP1    @RVALUE,,AUTO
         1 001362   200105 235100                    LDA     VALUE,,AUTO
         1 001363   100000 755100                    STA     0,,PR1

      334     9198    2        RETURN;

   9198  1 001364   200100 221300                    LDX1  ! TEMP+6,,AUTO
         1 001365   000001 702211                    TSX2  ! 1,X1

      335     9199    2   ARET:
      336     9200    2        ALTRETURN;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:57   

   9200  1 001366   200100 221300       ARET         LDX1  ! TEMP+6,,AUTO
         1 001367   000000 702211                    TSX2  ! 0,X1

      337     9201    2   END IORVALUE;
      338     9202        %EJECT;
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:58   
      339     9203    1   DDA$STORE: ENTRY ALTRET;

   9203  1 001370   000000 700200 xent  DDA$STORE    TSX0  ! X66_AUTO_0
         1 001371   000122 000000                    ZERO    82,0

      340     9204        /*P* NAME: DDA$STORE
      341     9205             PURPOSE: DO ROUTINE FROM STORE COMMAND */
      342     9206                                                /**/
      343     9207    1        DO_FIND = '0'B;

   9207  1 001372   200064 450100                    STZ     DO_FIND,,AUTO

      344     9208    1        DO_SUB = '1'B;

   9208  1 001373   400000 236003                    LDQ     -131072,DU
         1 001374   200063 756100                    STQ     DO_SUB,,AUTO

      345     9209    1        DO_STORE = '1'B;

   9209  1 001375   200065 756100                    STQ     DO_STORE,,AUTO

      346     9210    1        DO$ = S_D.DO$;

   9210  1 001376   000000 470400 xsym               LDP0    S_D$
         1 001377   000031 236100                    LDQ     25,,PR0
         1 001400   200053 756100                    STQ     DO$,,AUTO

      347     9211    1        S_D.DESC$ = S_D.D$;

   9211  1 001401   000044 236100                    LDQ     36,,PR0
         1 001402   000041 756100                    STQ     33,,PR0

      348     9212    1        OUTPUT$ = ADDR( S_D.OUTPUT );

   9212  1 001403   000000 236000 xsym               LDQ     S_D$
         1 001404   005335 036003                    ADLQ    2781,DU
         1 001405   200054 756100                    STQ     OUTPUT$,,AUTO
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:59   

      349     9213    1        CALL IORVALUE (TEMP_S, FIND$CMD.INSTR, FIND$CMD.IGNPR, FIND$CMD.AWDX);

   9213  1 001406   200053 236100                    LDQ     DO$,,AUTO
         1 001407   000000 036000 2                  ADLQ    0
         1 001410   200104 756100                    STQ     @ZFLAG+1,,AUTO
         1 001411   200053 236100                    LDQ     DO$,,AUTO
         1 001412   000001 036000 2                  ADLQ    1
         1 001413   200103 756100                    STQ     @IFLAG+1,,AUTO
         1 001414   200053 236100                    LDQ     DO$,,AUTO
         1 001415   000001 036003                    ADLQ    1,DU
         1 001416   200102 756100                    STQ     @RVALUE+1,,AUTO
         1 001417   200057 631500                    EPPR1   TEMP_S,,AUTO
         1 001420   200101 451500                    STP1    TEMP+7,,AUTO
         1 001421   001264 701000 1                  TSX1    IORVALUE
         1 001422   000000 011000                    NOP     0

      350     9214    1        IF FIND$CMD.INSTR

   9214  1 001423   200053 470500                    LDP0    DO$,,AUTO
         1 001424   000001 234100                    SZN     1,,PR0
         1 001425   001431 605000 1                  TPL     s:9216

      351     9215    1        THEN DISP_FMT = %INST_FMT;

   9215  1 001426   000006 235007                    LDA     6,DL
         1 001427   200070 755100                    STA     DISP_FMT,,AUTO
         1 001430   001433 710000 1                  TRA     s:9217

      352     9216    1        ELSE DISP_FMT = %OCT_FMT;

   9216  1 001431   000001 235007                    LDA     1,DL
         1 001432   200070 755100                    STA     DISP_FMT,,AUTO

      353     9217    1        FOUND_SOME = '1'B;

   9217  1 001433   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:60   
         1 001434   200066 756100                    STQ     FOUND_SOME,,AUTO

      354     9218    1        IF FIND$CMD.UNDER THEN MASK_S = FIND$CMD.UNDER_V;

   9218  1 001435   000001 236100                    LDQ     1,,PR0
         1 001436   100000 316003                    CANQ    32768,DU
         1 001437   001443 600000 1                  TZE     s:9219

   9218  1 001440   000003 235100                    LDA     3,,PR0
         1 001441   200061 755100                    STA     MASK_S,,AUTO
         1 001442   001445 710000 1                  TRA     s:9220

      355     9219    1        ELSE MASK_S = -1;

   9219  1 001443   000001 335007                    LCA     1,DL
         1 001444   200061 755100                    STA     MASK_S,,AUTO

      356     9220    1        TEMP_SB = TEMP_SB & MASK_SB;

   9220  1 001445   200057 236100                    LDQ     TEMP_S,,AUTO
         1 001446   200061 376100                    ANQ     MASK_S,,AUTO
         1 001447   200057 756100                    STQ     TEMP_S,,AUTO

      357     9221    1        CALL SETUP_FROM ALTRET(ERR1);

   9221  1 001450   001177 701000 1                  TSX1    SETUP_FROM
         1 001451   001176 702000 1                  TSX2    ERR1

      358     9222    1        GOTO MAINLINE;

   9222  1 001452   000156 710000 1                  TRA     MAINLINE

(unnamed)
 Sect OctLoc
   0     000   044106 115101   123113 040075   040040 040040   116145 170164    $FMASK =    Next
   0     004   040143 145154   154040 167141   163040 040040   057040 040040     cell was   /
   0     010   040074 055040   116157 156145   106111 116104   040164 145162     <- NoneFIND ter
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:61   
   0     014   155151 156141   164145 144040   141164 040040   123124 117122    minated at  STOR
   0     020   105040 164145   162155 151156   141164 145144   040141 164040    E terminated at

(unnamed)
 Sect OctLoc
   2     000   000001 220000   000001 200000   000001 230000   000001 210000    ................
   2     004   000001 050000   000002 200000   000000 000044   000003 400000    ..(........$....
   2     010   000003 006000   000006 006000   000013 006000   000000 000000    ................
   2     014   000013 006000   000030 006000   000000 000024   000006 006000    ................
   2     020   000016 006000   000002 006000   000004 600000                    ............
      359     9223    1   END DDA$FIND;

PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:62   
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$FIND.

   Procedure DDA$FIND requires 811 words for executable code.
   Procedure DDA$FIND requires 82 words of local(AUTO) storage.

    No errors detected in file DDA$FIND.:E05TSI    .
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:63   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:64   
          MINI XREF LISTING

ADDRESS
        15**DCL      8986<>CALL     8998<<DOINDEX  8998>>DOINDEX  9004<>CALL     9012<>CALL     9014<>CALL
      9017<>CALL     9023<>CALL     9049<>CALL     9051<>CALL     9058<>CALL     9075<>CALL     9113<>CALL
      9131<>CALL     9133>>ASSIGN   9138>>ASSIGN   9142<<ASSIGN   9146>>ASSIGN
ADDRESS IN PROCEDURE IORVALUE
      9176**DCL      9186<>CALL     9194>>ASSIGN   9195>>ASSIGN   9196>>ASSIGN
ARET IN PROCEDURE IORVALUE
      9200**LABEL    9186--CALLALT
CHAR2
        43**DCL      9059<<ASSIGN   9076<<ASSIGN
CHAR4
        44**DCL      9064<<ASSIGN   9081<<ASSIGN
DDA$DISPADR
      8921**DCL-ENT  9004--CALL     9058--CALL     9075--CALL     9113--CALL
DDA$DISPFMT
      8920**DCL-ENT  8992--CALL     9061--CALL     9066--CALL     9078--CALL     9083--CALL
DDB$BREAK
      8932**DCL-ENT  9006--CALL
DDE$ERROR
      8922**DCL-ENT  9100--CALL
DDK$EVAL
      8923**DCL-ENT  9131--CALL     9186--CALL
DDK$GETMVAL
      8924**DCL-ENT  9023--CALL
DDK$PUTMVAL
      8930**DCL-ENT  9051--CALL
DDQ$WRITE
      8927**DCL-ENT  8993--CALL     9005--CALL     9069--CALL     9094--CALL     9114--CALL
DDQ$WRITELM
      8928**DCL-ENT  9086--CALL
DDS$IC2NODE
      8929**DCL-ENT  8986--CALL     9017--CALL
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:65   
DESC#
        17**DCL      9004<>CALL     9012<>CALL     9014<>CALL     9023<>CALL     9049<>CALL     9051<>CALL
      9058<>CALL     9075<>CALL     9113<>CALL     9131<>CALL     9135>>ASSIGN   9144<<ASSIGN
DISP_FMT
        40**DCL      8945<<ASSIGN   8946<<ASSIGN   9061<>CALL     9066<>CALL     9078<>CALL     9083<>CALL
      9215<<ASSIGN   9216<<ASSIGN
DO$
        22**DCL      5437--IMP-PTR  8942<<ASSIGN   8944>>CALL     8944>>CALL     8944>>CALL     8945>>IF
      8947>>IF       8950>>IF       8950>>CALL     8950>>CALL     8950>>CALL     8953>>IF       8953>>CALL
      8953>>CALL     8953>>CALL     8962>>IF       8963>>IF       8965>>ASSIGN   8969>>IF       8969>>ASSIGN
      8987>>IF       8987>>IF       9031>>IF       9129>>IF       9136>>ASSIGN   9138>>ASSIGN   9210<<ASSIGN
      9213>>CALL     9213>>CALL     9213>>CALL     9214>>IF       9218>>IF       9218>>ASSIGN
DO_FIND
        36**DCL      8936<<ASSIGN   9027>>IF       9053>>IF       9068>>IF       9103>>IF       9207<<ASSIGN
DO_STORE
        37**DCL      8937<<ASSIGN   9053>>IF       9209<<ASSIGN
DO_SUB
        35**DCL      8940<<ASSIGN   8962<<ASSIGN   8980>>IF       9041>>IF       9062>>IF       9070>>IF
      9079>>IF       9208<<ASSIGN
DUL$GETMVAL
      8926**DCL-ENT  9012--CALL
DUM IN PROCEDURE IORVALUE
      9178**DCL      9186<>CALL
DUM2 IN PROCEDURE IORVALUE
      9179**DCL      9186<>CALL
DUU$GETMVAL
      8925**DCL-ENT  9014--CALL
DUU$PUTMVAL
      8931**DCL-ENT  9049--CALL
ERR
      9103**LABEL    8944--CALLALT  8950--CALLALT  8953--CALLALT  8986--CALLALT  9012--CALLALT  9016--GOTO
      9017--CALLALT  9018--GOTO     9023--CALLALT  9049--CALLALT  9051--CALLALT
ERR IN PROCEDURE SETUP_FROM
      9149**LABEL    9131--CALLALT
ERR1
      9121**LABEL    8949--CALLALT  8954--CALLALT  8992--CALLALT  9004--CALLALT  9058--CALLALT  9061--CALLALT
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:66   
      9066--CALLALT  9075--CALLALT  9078--CALLALT  9083--CALLALT  9101--GOTO     9221--CALLALT
ERR2
      9099**LABEL    9086--CALLALT
FIND$CMD.AWDX
      5452**DCL      8944<>CALL     9213<>CALL
FIND$CMD.CMD
      5438**DCL      8987>>IF
FIND$CMD.FROM
      5442**DCL      9129>>IF
FIND$CMD.FROMFIRST
      5448**DCL      8947>>IF
FIND$CMD.IGNPR
      5450**DCL      8944<>CALL     9213<>CALL
FIND$CMD.INSTR
      5441**DCL      8944<>CALL     8945>>IF       9213<>CALL     9214>>IF
FIND$CMD.NOTFLAG
      5449**DCL      9031>>IF
FIND$CMD.NUM
      5458**DCL      9136>>ASSIGN   9138>>ASSIGN
FIND$CMD.SUBS
      5444**DCL      8950>>IF       8953>>IF       8962>>IF
FIND$CMD.SUBSAWDX
      5453**DCL      8950<>CALL     8953<>CALL
FIND$CMD.SUBSIGNPR
      5451**DCL      8950<>CALL     8953<>CALL
FIND$CMD.SUBSINSTR
      5446**DCL      8950<>CALL     8953<>CALL
FIND$CMD.SUBSUNDER
      5445**DCL      8969>>IF
FIND$CMD.SUBSUNDER_V
      5460**DCL      8969>>ASSIGN
FIND$CMD.UNDER
      5443**DCL      8963>>IF       8987>>IF       9218>>IF
FIND$CMD.UNDER_V
      5459**DCL      8965>>ASSIGN   9218>>ASSIGN
FOUND_SOME
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:67   
        38**DCL      8938<<ASSIGN   9036<<ASSIGN   9091>>IF       9217<<ASSIGN
IFLAG IN PROCEDURE IORVALUE
      9154**DCL      9152--PROC     9181>>IF       9192>>IF
IORVALUE
      9152**PROC     8944--CALL     8950--CALL     8953--CALL     9213--CALL
MAINLINE
      8978**LABEL    9222--GOTO
MASK_F
        33**DCL        34--REDEF    8965<<ASSIGN   8966>>ASSIGN   8968<<ASSIGN   8987>>IF       8992<>CALL
MASK_FB
        34**DCL      8971>>ASSIGN   9030>>ASSIGN
MASK_S
        31**DCL        32--REDEF    8969<<ASSIGN   8970<<ASSIGN   9218<<ASSIGN   9219<<ASSIGN
MASK_SB
        32**DCL      8972>>ASSIGN   9044>>ASSIGN   9220>>ASSIGN
MAX_ADDRESS
        21**DCL      8998>>DOINDEX  9138<<ASSIGN   9146<<ASSIGN
MORE
      9014**LABEL    9020--GOTO
NODE
        24**DCL      8985<<ASSIGN   8986<>CALL     9014<>CALL     9017<>CALL     9019>>IF       9049<>CALL
      9086<>CALL
NOMORE
        39**DCL      8939<<ASSIGN   9018>>IF       9019<<ASSIGN
NOT_IS
        18**DCL      9004<>CALL     9012<>CALL     9014<>CALL     9023<>CALL     9049<>CALL     9051<>CALL
      9058<>CALL     9075<>CALL     9113<>CALL     9131<>CALL     9137>>ASSIGN   9145<<ASSIGN
NOT_IS IN PROCEDURE IORVALUE
      9177**DCL      9186<>CALL     9187>>IF
NO_MATCH
      9090**LABEL    9032--GOTO     9034--GOTO
OUTPUT$
        23**DCL      8943<<ASSIGN   8990>>ASSIGN   8991>>ASSIGN   8993<>CALL     8993>>CALL     9002>>ASSIGN
      9003>>ASSIGN   9005<>CALL     9005>>CALL     9056>>ASSIGN   9057>>ASSIGN   9069<>CALL     9069>>CALL
      9073>>ASSIGN   9074>>ASSIGN   9085>>ASSIGN   9086<>CALL     9094<>CALL     9106>>ASSIGN   9110>>ASSIGN
      9112>>ASSIGN   9114<>CALL     9114>>CALL     9212<<ASSIGN
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:68   
OVALUE.BIT29 IN PROCEDURE IORVALUE
      9170**DCL      9193>>IF
OVALUE.OFFSET IN PROCEDURE IORVALUE
      9168**DCL      9194<<ASSIGN
RVALUE IN PROCEDURE IORVALUE
      9153**DCL      9152--PROC     9197<<ASSIGN
SEG
        16**DCL      9004<>CALL     9012<>CALL     9014<>CALL     9023<>CALL     9049<>CALL     9051<>CALL
      9058<>CALL     9075<>CALL     9113<>CALL     9131<>CALL     9134>>ASSIGN   9143<<ASSIGN
SETUP_FROM
      9128**PROC     8949--CALL     8954--CALL     9221--CALL
S_D.ANLZ_FILE
      2182**DCL      8980>>IF       9012>>IF
S_D.BREAK
      1515**DCL      8999>>IF
S_D.CURRENT_CHANNEL
      2418**DCL      2420--REDEF
S_D.D$
      1556**DCL      8941>>ASSIGN   8990<<ASSIGN   8993>>CALL     9002<<ASSIGN   9005>>CALL     9056<<ASSIGN
      9059>>ASSIGN   9060<<ASSIGN   9060>>ASSIGN   9064>>ASSIGN   9065<<ASSIGN   9065>>ASSIGN   9069>>CALL
      9073<<ASSIGN   9076>>ASSIGN   9077<<ASSIGN   9077>>ASSIGN   9081>>ASSIGN   9082<<ASSIGN   9082>>ASSIGN
      9085>>ASSIGN   9106<<ASSIGN   9110<<ASSIGN   9114>>CALL     9211>>ASSIGN
S_D.DEBUGA
      1570**DCL      1572--REDEF
S_D.DESC$
      1550**DCL      8941<<ASSIGN   9183>>ASSIGN   9184<<ASSIGN   9184>>ASSIGN   9211<<ASSIGN
S_D.DESCL$
      1552**DCL      8991<<ASSIGN   9003<<ASSIGN   9057<<ASSIGN   9074<<ASSIGN   9112<<ASSIGN
S_D.DO$
      1521**DCL      8942>>ASSIGN   9210>>ASSIGN
S_D.EIS
      2528**DCL      2557--REDEF
S_D.ERROR
      1499**DCL      8982<<ASSIGN   9099<<ASSIGN   9189<<ASSIGN
S_D.FIND.ADDRESS
      2277**DCL      9133<<ASSIGN   9142>>ASSIGN
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:69   
S_D.FIND.DESC#
      2278**DCL      9135<<ASSIGN   9144>>ASSIGN
S_D.FIND.MASK_F
      2281**DCL      8966<<ASSIGN   8968>>ASSIGN
S_D.FIND.NOT_IS
      2280**DCL      9137<<ASSIGN   9145>>ASSIGN
S_D.FIND.NUM
      2279**DCL      9136<<ASSIGN   9146>>ASSIGN
S_D.FIND.SEG
      2276**DCL      9134<<ASSIGN   9143>>ASSIGN
S_D.FIND_RUM
      1604**DCL      8979<<ASSIGN   9096<<ASSIGN   9115>>IF       9117<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      2461**DCL      2462--REDEF    2476--REDEF
S_D.JDE
      2075**DCL      2076--REDEF
S_D.L$.VALUE
      1628**DCL      1634--REDEF    1642--REDEF    1645--REDEF    1648--REDEF    1651--REDEF
S_D.L$.VALUE.L
      1629**DCL      1630--REDEF    1631--REDEF
S_D.L6_MESSAGE_BUF
      2482**DCL      2484--REDEF
S_D.NODE
      2027**DCL      9019>>IF
S_D.OUTPUT
      2448**DCL      2450--REDEF    8943--ASSIGN   8989<<ASSIGN   8991--ASSIGN   9001<<ASSIGN   9003--ASSIGN
      9055<<ASSIGN   9057--ASSIGN   9072<<ASSIGN   9074--ASSIGN   9093<<ASSIGN   9105<<ASSIGN   9109<<ASSIGN
      9112--ASSIGN   9212--ASSIGN
S_D.OVERLAID
      2132**DCL      8986>>IF       9016>>IF
S_D.REMOTE_MSG.FNCC
      2467**DCL      2468--REDEF
S_D.REMOTE_MSG.STXC
      2463**DCL      2464--REDEF
S_D.REMOTE_MSG.SUBFNCC
      2471**DCL      2472--REDEF
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:70   
S_D.RUM
      2116**DCL      8978>>IF       8986>>IF       9013>>IF       9045>>IF       9070>>IF
S_D.RUM_TEST
      2164**DCL      9070>>IF
S_D.SV
      1527**DCL      1548--REDEF
S_D$
      2779**DCL      1475--IMP-PTR  8941>>ASSIGN   8941>>ASSIGN   8942>>ASSIGN   8943>>ASSIGN   8966>>ASSIGN
      8968>>ASSIGN   8978>>IF       8979>>ASSIGN   8980>>IF       8982>>ASSIGN   8986>>IF       8986>>IF
      8989>>ASSIGN   8990>>ASSIGN   8991>>ASSIGN   8993>>CALL     8999>>IF       9001>>ASSIGN   9002>>ASSIGN
      9003>>ASSIGN   9005>>CALL     9012>>IF       9013>>IF       9016>>IF       9019>>IF       9045>>IF
      9055>>ASSIGN   9056>>ASSIGN   9057>>ASSIGN   9059>>ASSIGN   9060>>ASSIGN   9060>>ASSIGN   9064>>ASSIGN
      9065>>ASSIGN   9065>>ASSIGN   9069>>CALL     9070>>IF       9070>>IF       9072>>ASSIGN   9073>>ASSIGN
      9074>>ASSIGN   9076>>ASSIGN   9077>>ASSIGN   9077>>ASSIGN   9081>>ASSIGN   9082>>ASSIGN   9082>>ASSIGN
      9085>>ASSIGN   9093>>ASSIGN   9096>>ASSIGN   9099>>ASSIGN   9105>>ASSIGN   9106>>ASSIGN   9109>>ASSIGN
      9110>>ASSIGN   9112>>ASSIGN   9114>>CALL     9115>>IF       9117>>ASSIGN   9133>>ASSIGN   9134>>ASSIGN
      9135>>ASSIGN   9136>>ASSIGN   9137>>ASSIGN   9142>>ASSIGN   9143>>ASSIGN   9144>>ASSIGN   9145>>ASSIGN
      9146>>ASSIGN   9183>>ASSIGN   9184>>ASSIGN   9184>>ASSIGN   9189>>ASSIGN   9210>>ASSIGN   9211>>ASSIGN
      9211>>ASSIGN   9212>>ASSIGN
TEMP
        45**DCL      9085<<ASSIGN   9086<>CALL
TEMP_F
        25**DCL        26--REDEF    8944<>CALL     9032>>IF       9034>>IF
TEMP_FB
        26**DCL      8971<<ASSIGN   8971>>ASSIGN
TEMP_NV
        29**DCL        30--REDEF    9048>>ASSIGN   9051<>CALL     9066<>CALL     9083<>CALL
TEMP_NVB
        30**DCL      9044<<ASSIGN
TEMP_S
        27**DCL        28--REDEF    8950<>CALL     8953<>CALL     9213<>CALL
TEMP_SB
        28**DCL      8972<<ASSIGN   8972>>ASSIGN   9044>>ASSIGN   9220<<ASSIGN   9220>>ASSIGN
TEMP_V
        41**DCL        42--REDEF    9032>>IF       9034>>IF
TEMP_VB
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:71   
        42**DCL      9030<<ASSIGN
TVALUE
        12**DCL      9049<>CALL
TVALUE.OPS
        14**DCL      9048<<ASSIGN
TVALUE.SIZE
        13**DCL      9047<<ASSIGN
UBIN36 IN PROCEDURE IORVALUE
      9175**DCL      9183>>ASSIGN
VALUE
         9**DCL      9014<>CALL
VALUE.OPS
        11**DCL      9012<>CALL     9023<>CALL     9029>>ASSIGN   9043>>ASSIGN   9061<>CALL     9078<>CALL
VALUE.SIZE
        10**DCL      8935<<ASSIGN
VALUE IN PROCEDURE IORVALUE
      9165**DCL      9166--REDEF    9172--REDEF    9183<<ASSIGN   9196<<ASSIGN   9197>>ASSIGN
VALUE_B
        20**DCL      9030>>ASSIGN   9044>>ASSIGN
VALUE_O
        19**DCL        20--REDEF    9029<<ASSIGN   9043<<ASSIGN
XFLAG IN PROCEDURE IORVALUE
      9156**DCL      9152--PROC     9193>>IF
YVALUE.Y IN PROCEDURE IORVALUE
      9173**DCL      9195<<ASSIGN
ZFLAG IN PROCEDURE IORVALUE
      9155**DCL      9152--PROC     9193>>IF
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:72   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$FIND File=DDA$FIND.:E05TSI                                TUE 07/29/97 13:28 Page:73   
              MINI UREF LISTING

DDA$FIND       8**PROC
DDA$STORE    9203**ENTRY
SDD$    3556**DCL
SDD_L6$    3558**DCL
ZITEM$    3557**DCL
ZITEM_L6$    3559**DCL
