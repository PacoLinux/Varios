VERSION E05

PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:1    
        1        1                    /*M*     FXP$PIG - PACKSET INSTALLATION GHOST */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=0,ENU=0,DCI=3,NSO,
        8        8        IAD=3,CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9        FXP$PIG: PROC MAIN ALTRET;
       10       10        %INCLUDE CP_6;
       11       91        %FPT_EXIT(STCLASS=CONSTANT,STEPCC=4);
       12      106    1   DCL FXP$MAIN ENTRY(1)ALTRET;
       13      107    1   DCL M$DP$ PTR SYMREF;
       14      108    1   DCL F$CFU$ BIT(36)CONSTANT SYMDEF INIT('000000006021'O);
       15      109    1   DCL M$DP DCB;
       16      110    1      M$DP$=DCBADDR(DCBNUM(M$DP));
       17      111    1      CALL FXP$MAIN ALTRET(RETALT);
       18      112    1      RETURN;
       19      113    1   RETALT: CALL M$EXIT(FPT_EXIT);
       20      114    1   END;
       21      115        %EOD;

PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:2    
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXP$PIG.

   Procedure FXP$PIG requires 15 words for executable code.
   Procedure FXP$PIG requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:3    

 Object Unit name= FXP$PIG                                    File name= FXP$PIG.:E05TOU
 UTS= SEP 04 '97 08:42:13.40 THU                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      7      7  FXP$PIG
    2   DCB   even  none     0      0  M$DP
    3   Proc  even  none    15     17  FXP$PIG
    4  RoData even  none     1      1  FXP$PIG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Main       0  FXP$PIG

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      6  F$CFU$

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FXP$MAIN
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET
PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:4    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DP$                                 M$DP
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:5    


        1        1                    /*M*     FXP$PIG - PACKSET INSTALLATION GHOST */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=0,ENU=0,DCI=3,NSO,
        8        8        IAD=3,CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9        FXP$PIG: PROC MAIN ALTRET;

      9  3 000000   000000 700200 xent  FXP$PIG      TSX0  ! X66_MAUTO
         3 000001   000004 000000                    ZERO    4,0

       10       10        %INCLUDE CP_6;
       11       91        %FPT_EXIT(STCLASS=CONSTANT,STEPCC=4);
       12      106    1   DCL FXP$MAIN ENTRY(1)ALTRET;
       13      107    1   DCL M$DP$ PTR SYMREF;
       14      108    1   DCL F$CFU$ BIT(36)CONSTANT SYMDEF INIT('000000006021'O);
       15      109    1   DCL M$DP DCB;
       16      110    1      M$DP$=DCBADDR(DCBNUM(M$DP));

    110  3 000002   000000 236007 xsym               LDQ     M$DP,DL
         3 000003   000000 470400 4                  LDP0    0
         3 000004   000000 471500                    LDP1    0,,PR0
         3 000005   100000 236106                    LDQ     0,QL,PR1
         3 000006   000000 756000 xsym               STQ     M$DP$

       17      111    1      CALL FXP$MAIN ALTRET(RETALT);

    111  3 000007   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000010   000000 701000 xent               TSX1    FXP$MAIN
         3 000011   000013 702000 3                  TSX2    RETALT

       18      112    1      RETURN;

    112  3 000012   000000 702200 xent               TSX2  ! X66_MARET
PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:6    

       19      113    1   RETALT: CALL M$EXIT(FPT_EXIT);

    113  3 000013   000000 630400 1     RETALT       EPPR0   FPT_EXIT
         3 000014   000001 713400                    CLIMB   exit
         3 000015   400400 401760                    pmme    nvectors=2

       20      114    1   END;

    114  3 000016   000000 702200 xent               TSX2  ! X66_MARET
       21      115        %EOD;

PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:7    
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXP$PIG.
PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:8    

 **** Variables and constants ****

  ****  Section 001 RoData FXP$PIG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(216)   r     1 FPT_EXIT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 M$DP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$DP


   Procedure FXP$PIG requires 15 words for executable code.
   Procedure FXP$PIG requires 4 words of local(AUTO) storage.
PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:9    
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FXP$PIG File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:42 Page:10   
          MINI XREF LISTING

FPT_EXIT
       102**DCL       113<>CALL
FPT_EXIT.V
       102**DCL       102--DCLINIT
FPT_EXIT.V.STEPCC#
       103**DCL       103--REDEF
FXP$MAIN
       106**DCL-ENT   111--CALL
M$DP
       109**DCL       110--ASSIGN
M$DP$
       107**DCL       110<<ASSIGN
M$EXIT
        31**DCL-ENT   113--CALL
RETALT
       113**LABEL     111--CALLALT

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:11   
       22        1        /*T***********************************************************/
       23        2        /*T*                                                         */
       24        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       25        4        /*T*                                                         */
       26        5        /*T***********************************************************/
       27        6        FXP$MAIN: PROC(PARM) ALTRET;
       28        7    1   DCL 1 PARM ALIGNED,
       29        8    1         2 U UBIN,
       30        9    1         2 P$ PTR;
       31       10                    /* INCLUDES */
       32       11        %INCLUDE XU_MACRO_C;
       33     3117        %INCLUDE XUH_MACRO_C;
       34     3201        %XUH_PARAM(NAME=XUH,OUTDCB1=M$LO);
       35     3262        %INCLUDE XU_SUBS_C;
       36     3354 S      %INCLUDE B$JIT_C;
       37     3355        %B$JIT0;
       38     3444        %U$JIT1;
       39     3518        %M$JIT2X;
       40     3521        %F$JIT3;
       41     3526        %S$JIT4X;
       42     3529        %J$JIT5X;
       43     3532        %A$JIT6X;
       44     3535    1   DCL B$JIT$ PTR SYMREF;
       45     3536        %INCLUDE CP_6;
       46     3617        %B$TCB(STCLASS="BASED(B$TCB$)");
       47     3620        %B$ALT;
       48     3628    1   DCL B$TCB$ PTR SYMREF;
       49     3629        %SUB B$ALT=B$TCB.ALT$->B$ALT;
       50     3630        %INCLUDE CP_6_SUBS;
       51     4170        %INCLUDE FM$MACROS;
       52     4545        %FM$SET(BASED="BASED(F$CFU$)");
       53     4550        %FM$DEV(BASED="BASED(F$CFU$)");
       54     4556        %FM$VOL(BASED="BASED(F$CFU$)");
       55     4562        %INCLUDE FX_PERR_C;
       56     4621        %INCLUDE FX$CAT;
       57     4638        %FM$CFUX;
       58     4643        %FM$SETU(BASED="BASED(P$)");
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:12   
       59     4646        %FM$GRAN;
       60     4650        %INCLUDE B_ERRORS_C;
       61     5777        %INCLUDE JG_GHOSTS_C;
       62     5867        %INCLUDE OC_MESSHD_C;
       63     5920        %INCLUDE OC_SUBS_C;
       64     6651        %MACRO F$DCB#(BASED=);
       65     6652        %INCLUDE F$DCB;
       66     6701        %MEND;
       67     6702        %F$DCB#(BASED="BASED(M$DP$)");
       68     6752        %INCLUDE XU_PERR_C;
       69     6943        %VLP_SN(FPTN=OPNSN,SN=' ');
       70     6956        %VLP_ACCT;
       71     6969        %FPT_OPEN(FPTN=OPNDP,
       72     6970                 PFMT=VECTOR,
       73     6971                 DCB=M$DP,
       74     6972                 RES='DP',
       75     6973                 ASN=DEVICE,
       76     6974                 SN=OPNSN,
       77     6975                 ACCT=VLP_ACCT,
       78     6976                 FUN=IN);
       79     7085        %FPT_CLOSE(FPTN=CLSDP,DCB=M$DP);
       80     7127        %FPT_CLOSE(FPTN=CLOSE1,DISP=SAVE);
       81     7169        %FPT_READ(FPTN=READCAT,BUF=CSTAT,KEY=CATKEY,KEYS=YES,DCB=M$CAT);
       82     7208        %FPT_WRITE(FPTN=WRITECAT,BUF=CSTAT,KEY=CATKEY,DCB=M$CAT);
       83     7239    1   DCL CATKEY CONSTANT BIT(18)INIT('001000'O);
       84     7240        %FPT_MERC(FPTN=MERCER,STCLASS=CONSTANT,JERR=FLAG);
       85     7253        %FPT_ERRMSG(FPTN=EFPT,CODE=FLAG,BUF=LBUF,FIELD1=TCXT,RESULTS=EVLR);
       86     7280        %VLR_ERRMSG(FPTN=EVLR);
       87     7302        %FPT_WRITE(FPTN=OCMSG,DCB=M$SI,BUF=WROC,WAIT=NO);
       88     7333        %FPT_WRITE(FPTN=WRAVR,DCB=M$SI,BUF=AVR.MSG,STATION=PIGST,WAIT=NO);
       89     7364        %VLP_STATION (FPTN=PIGST,STCLASS=CONSTANT,STATION='PIG');
       90     7391        %FPT_MADMUCK(FPTN=MADM,ACCT=VLP_ACCT,SN=OPNSN);
       91     7407        %FPT_READ(FPTN=READVID,
       92     7408                 DCB=M$DP,
       93     7409                 BUF=VIDBUF,
       94     7410                 KEYS=YES,
       95     7411                 KEY=GRANULE);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:13   
       96     7450        %SUB WRITEVID=READVID;
       97     7451        %SUB READGP=READVID;
       98     7452        %SUB WRITEGP=READVID;
       99     7453        %SUB WRITEPAD=READVID;
      100     7454        %FPT_INT(UENTRY=FXP$INT);
      101     7468        %FPT_OPEN(FPTN=OPNXTA,DCB=M$DP,ASN=FILE,ACCT=VLP_ACCT,
      102     7469           FUN=IN,SN=OPNSN,NXTA=YES,TEST=YES);
      103     7578        %FPT_OPEN(FPTN=OPNFIL,DCB=M$DP,ASN=FILE,SN=OPNSN,ACCT=VLP_ACCT,
      104     7579          NAME=VLP_NAME,ACS=BLOCK);
      105     7688        %VLP_NAME;
      106     7715        %FPT_PRIV(FPTN=PRIVFPT);
      107     7730        %FPT_PRIV(FPTN=PPRIVFPT,AUTH=YES,STCLASS=CONSTANT,
      108     7731           PRIV="%(PR_FMSEC#|PR_FMDIAG#|PR_FMBLK#|PR_SPCLMM#|PR_SYSLOG#)");
      109     7746        %FPT_PRIV(FPTN=DIAGFPT,PRIV=%PR_FMDIAG#);
      110     7761        %FPT_XCON(UENTRY=FXP$XCON,STCLASS=CONSTANT);
      111     7775        %FPT_TRAP(ERRORS=FXP$TRAP,MEMORY=TRAP);
      112     7798        %FPT_LDEV(STREAMNAME='LP01');
      113     7823        %FPT_CORRES(FPTN=CORR,DCB1=M$DO);
      114     7837        %FPT_WAIT(FPTN=WAIT1,UNITS=1,STCLASS=CONSTANT);
      115     7851        %SUB FCG#='0630'O;
      116     7852        %SUB MID#='20'O;
      117     7853        %ERRCODE(NAME=FXP$E$VOLDOWN,COD#=E$VOLDOWN,SEV#=7);
      118     7857        %ERRCODE(NAME=FXP$E$NOVOL,COD#=E$NOVOL,SEV#=7);
      119     7861        %ERRCODE(NAME=FXP$E$2RECON,COD#=E$2RECON,SEV#=7);
      120     7865        %ERRCODE(NAME=FXP$E$DUPVSN,COD#=E$DUPVSN,SEV#=7);
      121     7869        %ERRCODE(NAME=FMN$E$NOTAUTH,COD#="%(E$NOTAUTH)",MON#='1'B,
      122     7870                 SEV#=7,FCG#='0615'O,MID#='16'O);
      123     7874        %ERRCODE(NAME=FMN$E$XCLSET,COD#="%(E$XCLSET)",MON#='1'B,
      124     7875                 SEV#=7,FCG#='0615'O,MID#='16'O);
      125     7879        %ERRCODE(NAME=FXP$E$NEEDSCR,COD#=E$NEEDSCR,SEV#=7);
      126     7883        %ERRCODE(NAME=FXP$E$PROJCMD,COD#=E$PROJCMD,SEV#=7);
      127     7887        %ERRCODE(NAME=FXP$E$PROJPSN,COD#=E$PROJPSN,SEV#=7);
      128     7891        %ERRCODE(NAME=FXP$E$PROJDFT,COD#=E$PROJDFT,SEV#=7);
      129     7895        %ERRCODE(NAME=FXP$E$DEFER,COD#=E$DEFER,SEV#=7);
      130     7899        %ERRCODE(NAME=FXP$E$NLIST,COD#=E$NLIST,SEV#=7);
      131     7903        %ERRCODE(NAME=FXP$E$BIGSECT,COD#=E$BIGSECT,SEV#=7);
      132     7907        %FPT_SAD(FPTN=SETSAD,MONSID='6004'O,USERSID='6021'O,STCLASS="CONSTANT SYMDEF");
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:14   
      133     7922        %FPT_TIME(FPTN=TIMEFPT,DEST=UTS,TSTAMP=TIMEUTS,STCLASS=CONSTANT);
      134     7941        %FPT_TIME(FPTN=TIME_TEXT,STCLASS=CONSTANT,DEST=EXT,SOURCE=UTS,
      135     7942              TSTAMP=TIMEUTS,TIME=TIMETEXT.T,DATE=TIMETEXT.D);
      136     7961    1   DCL TIMES(0:4)CHAR(16)CONSTANT INIT(
      137     7962    1    'Mounted','Dismounted','Accounted','Modified','Created');
      138     7963    1   DCL TIME$(0:4)PTR CONSTANT INIT(
      139     7964    1   ADDR(CODE04.ACCESS),ADDR(CODE04.SVMODIFY),ADDR(CODE04.GAC.TIME),
      140     7965    1   ADDR(CODE04.UPD),ADDR(CODE04.CREATION));
      141     7966        %INCLUDE FX_SUBS_C;
      142     8002        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:15   
      143     8003                    /* STATIC DATA */
      144     8004    1   DCL TEXT(0:255) CHAR(1) STATIC INIT(' '*256);
      145     8005    1   DCL TCXT REDEF TEXT CHAR(256);
      146     8006    1   DCL 1 GBUF REDEF TEXT,
      147     8007    1         2 CODE UBIN(18)UNAL,
      148     8008    1         2 CADDR BIT(18),
      149     8009    1         2 PSN(0:16)CHAR(6),
      150     8010    1         2 * CHAR(150);
      151     8011    1   DCL 1 AVR REDEF TEXT,
      152     8012    1         2 MSG CHAR(10),
      153     8013    1         2 * CHAR(246);
      154     8014    1   DCL SELACCT CHAR(8)STATIC;
      155     8015    1   DCL USW BIT(1)STATIC SYMDEF; /* AND FOLLOWING */
      156     8016    1   DCL 1 WORK_ STATIC DALIGNED,
      157     8017    1         2 SIZE UBIN(18) UNAL,
      158     8018    1         2 FIRST$ PTR INIT(ADDR(NIL));
      159     8019        %FPT_PROMPT(STCLASS=CONSTANT SYMDEF,VFC=YES,PROMPT=PRTXT);
      160     8047    1   DCL PRTXT CONSTANT CHAR(0)INIT('p*');
      161     8048        %P_PCB(R=FXN$CMD,U$=FXP$POPTS);
      162     8247        %FPT_READ(DCB=M$SI,BUF=TEXT);
      163     8286        %FPT_WRITE(FPTN=LOFPT,DCB=M$LO,BUF=TEXT);
      164     8317        %PARSE$OUT;
      165     8362        %PARSE$SYM;
      166     8400        %FPT_GDS(FPTN=WORKFPT,RESULTS=WORK_,SEGSIZE=1024);
      167     8416                    /* ENTRIES */
      168     8417    1   DCL X$PARSE ENTRY(1) ALTRET;
      169     8418    1   DCL X$HELP ENTRY(1) ALTRET;
      170     8419    1   DCL FGG$DONE ENTRY ALTRET;
      171     8420    1   DCL FGG$QUIT ENTRY ALTRET;
      172     8421    1   DCL FXD$PMME ENTRY(1) ALTRET OPTIONAL;
      173     8422    1   DCL FXF$FIX ENTRY(1);
      174     8423    1   DCL FXH$GPSUM ENTRY ALTRET;
      175     8424    1   DCL FXH$RECON ENTRY(1)ALTRET;
      176     8425    1   DCL FXH$RECONT ENTRY ALTRET;
      177     8426    1   DCL FXH$COUNT ENTRY ALTRET;
      178     8427    1   DCL FXP$POPTS ENTRY(1);
      179     8428    1   DCL FXU$PROJAD ENTRY(1) ALTRET;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:16   
      180     8429    1   DCL FXU$PROJAC ENTRY(1) ALTRET;
      181     8430    1   DCL FXU$PROJNA ENTRY(1) ALTRET;
      182     8431    1   DCL FXU$PROJGR ENTRY(1) ALTRET;
      183     8432    1   DCL FXU$PROJDA ENTRY(1) ALTRET;
      184     8433    1   DCL FXU$PROJWR ENTRY ALTRET;
      185     8434    1   DCL FXU$PROTCHK ENTRY(1)ALTRET;
      186     8435    1   DCL FXU$GINIT ENTRY ALTRET;
      187     8436    1   DCL FXU$CATMNT ENTRY(1)ALTRET;
      188     8437    1   DCL FXU$CATADM ENTRY(1)ALTRET;
      189     8438    1   DCL FXU$CATL ENTRY(1)ALTRET;
      190     8439    1   DCL FXU$TRACKER ENTRY(1);
      191     8440    1   DCL FXP$TRAP ENTRY ASYNC;
      192     8441    1   DCL FXP$INT ENTRY ASYNC;
      193     8442    1   DCL FXP$XCON ENTRY ASYNC;
      194     8443    1   DCL FXN$CMD UBIN SYMREF;
      195     8444    1   DCL M$SI DCB;
      196     8445    1   DCL M$LO DCB;
      197     8446    1   DCL M$DO DCB;
      198     8447    1   DCL M$DP DCB;
      199     8448    1   DCL M$CAT DCB;
      200     8449    1   DCL CHAR1 BASED(BLK$) CHAR(1);
      201     8450    1   DCL CHAR4 BASED CHAR(4);
      202     8451    1   DCL BASED_UBIN BASED UBIN ALIGNED;
      203     8452                    /* SCRATCH STORAGE */
      204     8453    1   DCL SYSSIZE UBIN STATIC SYMDEF INIT(0);
      205     8454    1   DCL BLK$ PTR STATIC SYMDEF;
      206     8455    1   DCL ERRCODE STATIC SYMDEF BIT(36);
      207     8456    1   DCL GAC SBIN SYMREF;
      208     8457    1   DCL TIMEUTS STATIC UBIN;
      209     8458    1   DCL I UBIN STATIC;
      210     8459    1   DCL I0 UBIN STATIC;
      211     8460    1   DCL 1 RCNSN SYMREF,2 * CHAR(10);
      212     8461    1   DCL TRAPX BIT(72) STATIC SYMDEF INIT('0'B);
      213     8462    1   DCL TRAPCNT SBIN STATIC SYMDEF INIT(4);
      214     8463    1   DCL P$ PTR STATIC;
      215     8464    1   DCL J UBIN STATIC;
      216     8465    1   DCL LIST_ATTR STATIC BIT(1)INIT('0'B);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:17   
      217     8466    1   DCL ZAP BIT(1)INIT('0'B)STATIC;
      218     8467    1   DCL 1 FLAG STATIC SYMDEF,
      219     8468    1         2 FCG BIT(12) INIT('0'B),
      220     8469    1         2 MID BIT(6) INIT('0'B),
      221     8470    1         2 MON BIT(1) INIT('0'B),
      222     8471    1         2 CODE UBIN(14)UNAL INIT(0),
      223     8472    1         2 SEV UBIN(3)UNAL INIT(0);
      224     8473    1   DCL DPERX BIT(72) STATIC SYMDEF INIT('0'B);
      225     8474    1   DCL XCONWIND BIT(72) SYMREF;
      226     8475    1   DCL SAVUNW BIT(72);
      227     8476    1   DCL NUMSNS UBIN STATIC;
      228     8477    1   DCL X9 UBIN;
      229     8478    1   DCL GRANULE SBIN INIT(0)STATIC;
      230     8479    1   DCL CODE UBIN;
      231     8480    1   DCL USER_NAME CHAR(12) STATIC SYMDEF;
      232     8481    1   DCL USER_ACCN CHAR(8) STATIC SYMDEF;
      233     8482    1   DCL M$DP$ PTR SYMREF;
      234     8483    1   DCL MODE STATIC UBIN INIT(1); /* ZERO => GHOST */
      235     8484    1   DCL M$LO$ PTR STATIC SYMDEF;
      236     8485    1   DCL M$SI$ PTR STATIC SYMDEF;
      237     8486    1   DCL WIDTH UBIN STATIC;
      238     8487    1   DCL BREAK STATIC SYMDEF UBIN INIT(0);
      239     8488    1   DCL BANNERSZ STATIC UBIN INIT(150);
      240     8489    1   DCL F$CFU$ PTR SYMREF READONLY;
      241     8490        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:18   
      242     8491                    /* PROJAD DATA */
      243     8492        %INCLUDE AS_SUPER_C;
      244     8927    1   DCL PROJADCU(0:15) UBIN(9)UNAL CONSTANT INIT(
      245     8928                    /* PERMITTED COMMANDS IN PROJAD MODE */
      246     8929    1   %E$END,%E$XIT,%E$QUIT,%E$CREATE,%E$MODIFY,%E$LIST,%E$DELETE,%E$ATTR,
      247     8930    1   %E$MADLIST,%E$MAKEME,%E$HCMD,%E$QSTNMRK*0);
      248     8931    1   DCL PROJADC REDEF PROJADCU CHAR(16);
      249     8932    1   DCL 1 PROJAD STATIC SYMDEF,
      250     8933    1         2 L UBIN(9)UNAL INIT(0), /* KEY LENGTH */
      251     8934    1         2 ACCT CHAR(8),
      252     8935    1         2 NAME CHAR(12),
      253     8936    1         2 PSN CHAR(6);
      254     8937        %P$PCB(STCLASS=BASED);
      255     9138        %FPT_DEQ(DCB=M$PROJ,STCLASS=CONSTANT,FPTN=DEQPROJ);
      256     9155    1   DCL M$PROJ DCB;
      257     9156        %SUPER_TO_PIG(NAME=S_TO_P,STCLASS="BASED(BLK$)");
      258     9188        %PIG_TO_SUPER(NAME=P_TO_S,STCLASS="BASED(BLK$)");
      259     9199        %VLP_STATION(FPTN=ST,STCLASS=BASED);
      260     9226        %FPT_WRITE(FPTN=WRSUPER,DCB=M$SI);
      261     9257        %FPT_WRITE(FPTN=DEFERFPT,DCB=M$PIGCG,STATION=DEFERST);
      262     9288        %VLP_STATION(FPTN=DEFERST,STCLASS=STATIC,ANYDCB=YES,EOFNONE=YES);
      263     9315    1   DCL M$PIGCG DCB;
      264     9316        %FPT_OPEN (FPTN=RELPIGFIL, DELETE=YES, DCB=M$PIGCG, ASN=FILE);
      265     9425        %FPT_CLOSE (FPTN=RELPIGCG, DISP=RELEASE, DCB=M$PIGCG, STCLASS=CONSTANT);
      266     9467        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:19   
      267     9468        %FM$GRAN(FM$GRAN=GPBUF,BASED="STATIC SYMDEF",
      268     9469        HASH="* INIT(BITBIN('525252525'O))",
      269     9470        GMOD="* INIT(1)",
      270     9471        NAVX="* INIT(5)",
      271     9472        FCEX="* INIT(5)",
      272     9473        AVAIL="* INIT(1019)",
      273     9474        HDR="* INIT('1'B)",
      274     9475        LVL="* INIT(FMGTGP)",
      275     9476        ORG="* INIT(0)",
      276     9477        ENDLVL="* INIT('0'B)",
      277     9478        X="* INIT('0'B)",
      278     9479        KEYCNT="* INIT(0)",
      279     9480        BLINK="* INIT(0)",
      280     9481        FLINK="* INIT(0)");
      281     9485        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:20   
      282     9486        %FM$GRAN(FM$GRAN=MADBUF,BASED=STATIC,
      283     9487        HASH="* INIT(BITBIN('142142142'O))",
      284     9488        GMOD="* INIT(3)",
      285     9489        NAVX="* INIT(SIZEW(MADBUF))",
      286     9490        FCEX="* INIT(5)",
      287     9491        AVAIL="* INIT(949)",
      288     9492        HDR="* INIT('1'B)",
      289     9493        LVL="* INIT(FMGTMAD)",
      290     9494        ORG="* INIT(0)",
      291     9495        ENDLVL="* INIT('0'B)",
      292     9496        X="* INIT('0'B)",
      293     9497        KEYCNT="* INIT(0)",
      294     9498        BLINK="* INIT(0)",
      295     9499        FLINK="* INIT(0)UBIN,2 K(0:69) INIT(BITBIN('430000000000'O),0*0)");
      296     9503        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:21   
      297     9504        %FM$GRAN(FM$GRAN=PADBUF,BASED=STATIC,
      298     9505        HASH="* INIT(BITBIN('274274274'O))",
      299     9506        GMOD="* INIT(2)",
      300     9507        HDR="* INIT('1'B)",
      301     9508        LVL="* INIT(FMGTPAD)",
      302     9509        ORG="* INIT(0)",
      303     9510        ENDLVL="* INIT('0'B)",
      304     9511        X="* INIT('0'B)",
      305     9512        KEYCNT="* INIT(0)",
      306     9513        BLINK="* INIT(0)",
      307     9514        FLINK="* INIT(0)");
      308     9518    1   DCL ITEMXMASK BIT(36)INIT('000000001777'O)CONSTANT;
      309     9519        %FM_FITCODE(NAME=FIT00,CODE=3,NAW=4,STCLASS=STATIC);
      310     9522        %FM_FITCODE(NAME=FIT04,CODE=4,NDW=11,NAW=11,ITEMX=4,STCLASS=STATIC);
      311     9525    1   DCL 1 FIT14 STATIC,
      312     9526    1         2 * UBIN(5)UNAL INIT(14),
      313     9527    1         2 NAW UBIN(11)INIT(8)UNAL,
      314     9528    1         2 NDW UBIN(10)INIT(8)UNAL,
      315     9529    1         2 * UBIN(10)INIT(15)UNAL;
      316     9530    1   DCL 1 FIT09 STATIC,
      317     9531    1         2 * UBIN(5) UNAL INIT(9),
      318     9532    1         2 NAW UBIN(11) UNAL INIT(0),
      319     9533    1         2 NDW UBIN(10) UNAL INIT(0),
      320     9534    1         2 ITEMX UBIN(10)INIT(143)UNAL;
      321     9535        %CODE04(BASED=STATIC,UBIN="INIT(0)UBIN",CHAR="INIT(' ')CHAR",MODIFY=UPD);
      322     9543        %CODE14(BASED=STATIC,MAX=24,
      323     9544        WCDATA="WCDATA INIT('0'B)",
      324     9545        LIST="LIST INIT('0'B)",
      325     9546        WRCMP="WRCMP INIT('0'B)",
      326     9547        OWNERF="OWNERF INIT('1'B)",
      327     9548        BUPF="BUPF INIT('1'B)",
      328     9549        BUPM="BUPM INIT('0'B)",
      329     9550        NOACUP="NOACUP INIT('0'B)",
      330     9551        NPUR="NPUR INIT('0'B)",
      331     9552        NOSTOW="NOSTOW INIT('0'B)",
      332     9553           MERGEAC="MERGEAC INIT('0'B)",
      333     9554        GACSHELF="GACSHELF INIT('0'B)",
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:22   
      334     9555        NEWFD="NEWFD INIT('0'B)",
      335     9556        X="X INIT('0'B)",
      336     9557        DFLTALL="DFLTALL INIT(%FFLG_READ#)",
      337     9558        CGMEM="CGMEM INIT(0)",
      338     9559        MGRANS="MGRANS INIT(1000)",
      339     9560        CGRANS="CGRANS INIT(0)",
      340     9561        CHAR="INIT(' '*0)CHAR");
      341     9571    1   DCL 1 CODE09(0:199) UNAL STATIC,
      342     9572    1         2 FFLG BIT(18),
      343     9573    1         2 ACCT CHAR(8);
      344     9574    1   DCL 1 FITMOVER BASED,2 * CHAR(FITSIZE);
      345     9575    1   DCL DEFAULT_BUILD(0:722)UBIN;
      346     9576    1   DCL FITSIZE UBIN STATIC INIT(112);
      347     9577        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:23   
      348     9578        %LIST;
      349     9579        %FM$VID(FM$VID=VIDBUF,BASED="STATIC SYMDEF");
              9580    1   DCL 1 FM$VID BASED ALIGNED,2 ID CHAR(4),2 INSTID BIT(36),2 VSN UBIN,2 PSN CHAR(6),2
              9580            VOLCNT UBIN HALF UNAL,2 SYSSIZE UBIN,2 SYSDIRDA
              9581    1   UBIN WORD,2 INITTIME UBIN,2 SECTSTRT(0:25)UBIN,2 MIRROR ALIGNED,3 C CHAR(8)CALIGNED,
              9581            3 UTS UBIN ALIGNED,3 STATE(0:1)UBIN(6)UNAL,3 *
              9582    1   BIT(24),2 *(0:153)UBIN,2 DGT(0:63),3 FGRAN UBIN(18)UNAL,3 LGRAN UBIN(18)UNAL,2 DTT(0
              9582            :63)UBIN(18),2 DT(0:63)REDEF DTT,3 CYL UBIN(10)
              9583    1   UNAL,3 HD UBIN(8)UNAL,3 * BIT(18),2 SNLIST(0:175),3 VSN,4 S UBIN BYTE UNAL,4 N UBIN(
              9583            27)UNAL,3 SIZE UBIN,3 TYPE CHAR(8);
      350     9585    1   DCL WBUF(0:1023) REDEF VIDBUF UBIN;
      351     9586        %FM$FIT(FM$FIT=FIT,BASED=REDEF VIDBUF,N=1023);
              9587    1   DCL 1 FM$FIT BASED ALIGNED,2 CODES(0:N),3 CODE UBIN(5)UNAL,3 * BIT(1),3 NAW UBIN(10)
              9587            UNAL,3 NDW UBIN(10)UNAL,3 ITEMX UBIN(10)UNAL;
      352     9589        %SUB NUMPSNS=CSTAT.NUM/*NUMPSNS*/;
      353     9590        %FX$STAT(FX$STAT=CSTAT,BASED="STATIC SYMDEF",PSN="PSN INIT('SYS',' '*0)",
      354     9591           MAX=510,
      355     9592           UBIN="INIT(0*0)UBIN");
              9593    1   DCL 1 FX$STAT BASED ALIGNED,2 NUM UBIN,2 DEFMOUNT UBIN,2 SETS(0:MAX),3 PSN CHAR(6),3
              9593            DISP UBIN BYTE UNAL,3 SETX UBIN BYTE UNAL;
      356     9595        %FM$VID(FM$VID=VID1,BASED=REDEF CSTAT);
              9596    1   DCL 1 FM$VID BASED ALIGNED,2 ID CHAR(4),2 INSTID BIT(36),2 VSN UBIN,2 PSN CHAR(6),2
              9596            VOLCNT UBIN HALF UNAL,2 SYSSIZE UBIN,2 SYSDIRDA
              9597    1   UBIN WORD,2 INITTIME UBIN,2 SECTSTRT(0:25)UBIN,2 MIRROR ALIGNED,3 C CHAR(8)CALIGNED,
              9597            3 UTS UBIN ALIGNED,3 STATE(0:1)UBIN(6)UNAL,3 *
              9598    1   BIT(24),2 *(0:153)UBIN,2 DGT(0:63),3 FGRAN UBIN(18)UNAL,3 LGRAN UBIN(18)UNAL,2 DTT(0
              9598            :63)UBIN(18),2 DT(0:63)REDEF DTT,3 CYL UBIN(10)
              9599    1   UNAL,3 HD UBIN(8)UNAL,3 * BIT(18),2 SNLIST(0:175),3 VSN,4 S UBIN BYTE UNAL,4 N UBIN(
              9599            27)UNAL,3 SIZE UBIN,3 TYPE CHAR(8);
      357     9601        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:24   
      358     9602    1   DCL ERRVEC(0:19)BIT(72)CONSTANT INIT(
      359     9603    1   VECTOR(ERRDUBDEF),VECTOR(ERRSYN),VECTOR(LBUF),VECTOR(LBUF),
      360     9604    1   VECTOR(TCXT),VECTOR(ERRSI),VECTOR(UNCMD),VECTOR(VALMSG),
      361     9605    1   VECTOR(LISTH1),VECTOR(LISTH2),VECTOR(LBUF),'0'B*0);
      362     9606    1   DCL UNCMD CONSTANT CHAR(0)INIT(
      363     9607    1   ' **** Pigs don''t know how to do that.');
      364     9608    1   DCL NONEMSG CONSTANT CHAR(0) INIT(
      365     9609    1   ' ** None found.');
      366     9610    1   DCL ERRDUBDEF CONSTANT CHAR(0) INIT(
      367     9611    1   ' Reconstruct for information purposes only.');
      368     9612    1   DCL 1 ERRSYN STATIC,
      369     9613    1         2 * CHAR(0)INIT(' **** Syntax error after '),
      370     9614    1         2 T CHAR(21);
      371     9615    1   DCL 1 VALMSG STATIC,2 * CHAR(0) INIT(
      372     9616    1   ' **** Too many values or a bad one after '),
      373     9617    1         2 T CHAR(21);
      374     9618    1   DCL 1 LISTH1 STATIC,
      375     9619    1         2 * CHAR(0) INIT('DP#'),
      376     9620    1         2 PSN CHAR(6),
      377     9621    1         2 * CHAR(0) INIT(
      378     9622    1           '                  ACCESS');
      379     9623    1   DCL LISTH2 CONSTANT CHAR(0) INIT(
      380     9624    1   'ACCOUNT   #GRANULES USED   ReadDelrecWnewUpdateScratchNolistFitmodExecCreate');
      381     9625        %OC_MESSHD_D(NAME=WROC,NPARMS=8,D='DP010000');
              9626    1   DCL 1 NAME STCLASS,
              9627    1            2 CADDR BIT(18) INIT(ATR) UNAL,
              9628    1            2 MSG# UBIN HALF INIT(MSG) UNAL,
              9629    1            2 MSGID UBIN HALF UNAL,
              9630    1            2 SYSID REDEF MSGID SBIN HALF UNAL,
              9631    1            2 NPARAMS UBIN BYTE INIT(NPARMS) UNAL,
              9632    1            2 FCN UBIN BYTE UNAL INIT(FUNC),
              9633    1            2 FLAGS BIT(9) UNAL INIT(FLGS),
              9634    1            2 PFB REDEF FLAGS UBIN BYTE UNAL,
              9635    1            2 * UBIN(27) UNAL,
              9636    1            2 DEVNM CHAR(8) INIT(D) UNAL DELIM
      382     9638    1         2 *(0:7)UBIN BYTE UNAL INIT(4,6,2,1,1,6,64,0),
      383     9639    1         2 VSN SBIN,
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:25   
      384     9640    1         2 PSN CHAR(6),
      385     9641    1         2 N UBIN HALF UNAL,
      386     9642    1         2 VOL UBIN BYTE UNAL,
      387     9643    1         2 SECT CHAR(1),
      388     9644    1         2 DPSN CHAR(6);
      389     9645    1   DCL LBUFC CHAR(120)INIT('Pig XXX Here')STATIC;
      390     9646    1   DCL 1 LBUF REDEF LBUFC,
      391     9647    1         2 ACCT CHAR(9),
      392     9648    1         2 * CHAR(1),
      393     9649    1         2 CGRANS CHAR(5),
      394     9650    1         2 * CHAR(4),
      395     9651    1         2 MGRANS CHAR(5),
      396     9652    1         2 * CHAR(3),
      397     9653    1         2 REST CHAR(93);
      398     9654    1   DCL 1 DBUF REDEF LBUFC,
      399     9655    1         2 * CHAR(2),
      400     9656    1         2 DEV CHAR(2),
      401     9657    1         2 * CHAR(116);
      402     9658    1   DCL 1 TIMETEXT REDEF LBUFC,
      403     9659    1         2 * CHAR(10),
      404     9660    1         2 TYP CHAR(12),
      405     9661    1         2 T CHAR(12),
      406     9662    1         2 D CHAR(10),
      407     9663    1         2 B CHAR(76);
      408     9664    1   DCL 1 LBUF0 CONSTANT CHAR(0) INIT(
      409     9665    1           '-DEFAULT-     0 of 00000');
      410     9666    1   DCL FFLGS(0:15)BIT(36) CONSTANT INIT(
      411     9667    1   %FFLG_READ#,%FFLG_DELR#,%FFLG_WNEW#,
      412     9668    1   %FFLG_UPD#,%FFLG_DELF#,%FFLG_NOLIST#,
      413     9669    1   %FFLG_REATTR#,%FFLG_EXEC#,%FFLG_CREATE#,%FFLG_WRITE#,'0'B*0);
      414     9670    1   DCL FFLGC(0:15) CONSTANT CHAR(8)INIT(
      415     9671    1         'Read','Delr','Wnew','Upd','Scratch','Nolist',
      416     9672    1         'Fitmod','Exec','Create','Write','None'*0);
      417     9673    1   DCL ERRSI CONSTANT CHAR(0) INIT(
      418     9674    1   ' **** COMMAND ABORTED');
      419     9675    1   DCL B_VERSION CHAR(1) SYMREF;
      420     9676    1   DCL 1 B$VERSIONB BASED,
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:26   
      421     9677    1         2 C_ UBIN BYTE CALIGNED,
      422     9678    1         2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
      423     9679        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:27   
      424     9680    1      CALL M$PROMPT(FPT_PROMPT);
      425     9681    1      USER_NAME=B$JIT.UNAME;
      426     9682    1      USER_ACCN=B$JIT.ACCN;
      427     9683    1      IF WORK_.FIRST$=ADDR(NIL) THEN CALL M$GDS(WORKFPT);
      428     9684    1      CALL M$INT(FPT_INT);
      429     9685    1      CALL M$TRAP(FPT_TRAP);
      430     9686    1      CALL M$XCON(FPT_XCON);
      431     9687    1      CALL M$RPRIV(PPRIVFPT);
      432     9688    1      CALL CONCAT (LBUFC,'Pig ',ADDR(B_VERSION)->B$VERSIONB.T_,' here  ');
      433     9689    1      IF NOT B$JIT.PPRIV.PADMIN OR B$JIT.USER=JG_PIG# THEN CALL SET_PRIV;
      434     9690    2      ELSE DO;
      435     9691    2         PROJAD.NAME=B$JIT.UNAME;
      436     9692    2         PROJAD.ACCT=B$JIT.ACCN;
      437     9693    2         CALL FXU$PROJAD;
      438     9694    2         IF PROJAD.L=0 THEN CALL SET_PRIV;
      439     9695    3         ELSE DO;
      440     9696    3            IF PROJAD.L<20 THEN ERRSYN.T='No Packset';
      441     9697    3            ELSE CALL CONCAT(ERRSYN.T,'Set #',PROJAD.PSN);
      442     9698    3            CALL INDEX2(I,'  ',LBUFC);
      443     9699    3            CALL INSERT(LBUFC,I,80,' - Project Administrator Mode - ',ERRSYN.T);
      444     9700    3            END;
      445     9701    2         END;
      446     9702    1      OCMSG.BUF_.BOUND=SIZEV(WROC)+64;
      447     9703    1      M$LO$=DCBADDR(DCBNUM(M$LO));
      448     9704    1      DEFAULT_BUILD=ADDR(PADBUF)->FITMOVER;
      449     9705    1      M$SI$=DCBADDR(DCBNUM(M$SI));
      450     9706    1      P_PCB.TEXT$=PINCRC(WORK_.FIRST$,1);
      451     9707    1      IF B$JIT.USER=JG_PIG# THEN GOTO NEXT;
      452     9708    1      CALL ERROR(3);
      453     9709    1   NEXT:;
      454     9710    1      CALL CLOSE(DCBNUM(M$CAT));
      455     9711    1      ERRCODE=FLAG; /* SAVE ERRCODE FOR ? COMMAND */
      456     9712    1      CALL M$RPRIV(PRIVFPT)ALTRET(NOALT);
      457     9713    1      CALL M$SAD(SETSAD)ALTRET(NOALT);
      458     9714    1      CALL M$RPRIV(DIAGFPT)ALTRET(NOALT);
      459     9715    1      IF PROJAD.L~=0 THEN CALL M$DEQ(DEQPROJ)ALTRET(NOALT);
      460     9716    2      IF BLK$~=WORK_.FIRST$ AND MODE=0 THEN DO;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:28   
      461     9717    2         WRSUPER.STATION_=VECTOR(M$SI$->F$DCB.LASTSTA$->ST);
      462     9718    2         WRSUPER.BUF_.BUF$=BLK$;
      463     9719    2         WRSUPER.BUF_.BOUND=P_TO_S.COUNT+SIZEV(P_TO_S)-SIZEC(P_TO_S.TEXT);
      464     9720    2         IF M$SI$->F$DCB.LASTSTA$->ST.STATION#='PIG' THEN CALL UNDEFER1;
      465     9721    2         ELSE CALL M$WRITE(WRSUPER)ALTRET(NOALT);
      466     9722    2         PROJAD.L=0;
      467     9723    2         CALL SET_PRIV;
      468     9724    2         END;
      469     9725    1      FLAG=ERRCODE;
      470     9726    2      DO WHILE(WROC.MSG#=PREZAP_MSG#);
      471     9727    2         CALL M$WAIT(WAIT1);
      472     9728    2         END;
      473     9729    2      IF B$JIT.USER=JG_PIG# AND MODE~=0 THEN DO;
      474     9730    2         CALL CATREAD;
      475     9731    2         BLK$=WORK_.FIRST$;
      476     9732    2         OUT$SYM.COUNT=79;
      477     9733    2         OUT$SYM='0'B;
      478     9734    2         OUT$BLK.NSUBLKS=3;
      479     9735    2         OUT$BLK.SUBLK$(0)=BLK$;
      480     9736    2         OUT$BLK.SUBLK$(1)=PINCRW(BLK$,SIZEW(OUT$BLK)+2);
      481     9737    2         OUT$BLK.SUBLK$(2)=PINCRW(BLK$,2*SIZEW(OUT$BLK)+4);
      482     9738    2         OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT=6;
      483     9739    2         OUT$BLK.SUBLK$(2)->OUT$SYM.COUNT=6;
      484     9740    2         CALL M$EVENT(FPT_INT);
      485     9741    2         CALL FXU$GINIT;
      486     9742    2         I=FM$CFUX.DSETH; /* FIRST AVR EVERYTHING */
      487     9743    3         DO WHILE(I~=0); /* SO THAT WHEN COLD BOOT AVRS COME, */
      488     9744    4            IF FM$DEV.SPIN(I) THEN DO; /* SET STATUS IS RIGHT EVEN ON 1ST VOL */
      489     9745    4               FM$DEV.AVR(I)='1'B;
      490     9746    5               CALL M$OPEN(OPNDP)WHENRETURN DO;
      491     9747    5                  CALL M$CLOSE(CLSDP);
      492     9748    5                  END;
      493     9749    4               END;
      494     9750    3            IF FM$DEV.SECTL(I)~=0 THEN I=FM$DEV.SECTL(I);
      495     9751    3            ELSE I=FM$DEV.DEVL(FM$VOL.DCTX(I));
      496     9752    3            END;
      497     9753    2         MODE=0;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:29   
      498     9754    2         GBUF.CODE=0;
      499     9755    2         IF CSTAT.SETS.SETX(0)~=0 THEN GBUF.CADDR='0'B;
      500     9756    3         ELSE DO;
      501     9757    3            GBUF.CADDR=M_DISK;
      502     9758    3            GBUF.PSN(0)='*INIT*';
      503     9759    3            NUMPSNS=0;
      504     9760    3            I=FM$CFUX.DSETH; /* SEND AVRS FOR EVERYTHING THATS UP */
      505     9761    4            DO WHILE(I~=0);
      506     9762    5               IF FM$DEV.SPIN(I) THEN DO;
      507     9763    5                  FM$DEV.AVR(I)='1'B;
      508     9764    5                  CALL M$WRITE(WRAVR)ALTRET(WAIT4KEYIN);
      509     9765    5                  END;
      510     9766    4               IF FM$DEV.SECTL(I)~=0 THEN I=FM$DEV.SECTL(I);
      511     9767    4               ELSE I=FM$DEV.DEVL(FM$VOL.DCTX(I));
      512     9768    4               END;
      513     9769    3            END;
      514     9770    3         DO I=1 TO NUMPSNS;
      515     9771                    /* FOR RECOVERY, JUST DO THE MOUNT KEYINS AGAIN */
      516     9772    3            IF NOT BINBIT(CSTAT.SETS.SETX(I),1) THEN GBUF.CADDR=M_DISK;
      517     9773    3            ELSE GBUF.CADDR='0'B;
      518     9774    3            CSTAT.SETS.SETX(I)=0;
      519     9775    3            GBUF.CODE=CSTAT.SETS.DISP(I);
      520     9776    3            GBUF.PSN(0)=CSTAT.SETS.PSN(I);
      521     9777                    /* MOUNT THE MOUNTED ONES, BUT NO MESSAGES */
      522     9778    3            CALL M$WRITE(WRAVR)ALTRET(WAIT4KEYIN);
      523     9779    3            END;
      524     9780    2         CSTAT.SETS.SETX(0)=1;
      525     9781    2         CALL CATWRITE;
      526     9782    2         GOTO CONTINUE;
      527     9783    2   WAIT4KEYIN: CALL M$WAIT(WAIT1);
      528     9784    2         CALL M$RETRY;
      529     9785    2         END;
      530     9786    1      BLK$=WORK_.FIRST$;
      531     9787    1      CHAR1=' ';
      532     9788    1      USW='0'B;
      533     9789    1   CONTINUE:;
      534     9790    2      IF NOT FPT_READ.V.WAIT# THEN DO;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:30   
      535     9791    2         XCONWIND=SAVUNW;
      536     9792    2         DPERX=SAVUNW;
      537     9793    2         RETURN;
      538     9794    2         END;
      539     9795    1      IF MODE=0 THEN IF M$LO$->F$DCB.CFU$->F$DCB.NRECS>BANNERSZ+150
      540     9796    2        OR FPT_READ.V.EVENT#~=0 AND WROC.MSG#=PIGERR_MSG# THEN DO;
      541     9797    2         CALL M$LDEV(FPT_LDEV) ALTRET(NOALT);
      542     9798    2         BANNERSZ=M$LO$->F$DCB.CFU$->F$DCB.NRECS;
      543     9799    2         END;
      544     9800    2      IF FPT_READ.V.EVENT#~=0 THEN DO;
      545     9801    2         CALL CATREAD;
      546     9802    2         WROC.CADDR=M_DISK;
      547     9803    2         CODE=%E$MOUNT;
      548     9804    3         DO I=1 TO NUMPSNS; /* MOUNT A SET THAT NEEDED RECON, TOO */
      549     9805    3            IF CSTAT.SETS.SETX(I)=2 THEN GOTO MOUNT1;
      550     9806    3            END;
      551     9807    2         FPT_READ.V.EVENT#=0;
      552     9808    2         CALL M$CHECK(FPT_READ)ALTRET(SIERR);
      553     9809    2         END;
      554     9810    2      ELSE DO;
      555     9811    2         TCXT=' ';
      556     9812    2         CALL M$READ(FPT_READ)ALTRET(SIERR);
      557     9813    2         END;
      558     9814        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:31   
      559     9815    1   FXP$TWO: ENTRY ALTRET;
      560     9816    1      SAVUNW=DPERX;
      561     9817    1      REMEMBER DPERR1 IN DPERX;
      562     9818    1      IF MODE=0 THEN XCONWIND=DPERX;
      563     9819    1      IF TCXT~='?' THEN EFPT.V.DCB#=DCBNUM(M$DP);
      564     9820    2      IF MODE~=0 THEN DO;
      565     9821    2         IF NOT M$SI$->F$DCB.DDEV.IC OR NOT M$LO$->F$DCB.DDEV.IC
      566     9822    2         THEN CALL ERROR(4);
      567     9823    3         IF TCXT='?' AND P_PCB.HI_CHAR<P_PCB.NCHARS THEN DO;
      568     9824    3   MENU:    P_PCB.NXT='1'B;
      569     9825    3            CALL INSERT(P_PCB.TEXT$->CHAR4,P_PCB.HI_CHAR,1,BINASC(0));
      570     9826    3            CALL X$PARSE(P_PCB);
      571     9827    3            P_PCB.NCHARS=0;
      572     9828    3            P_PCB.NXT='0'B;
      573     9829    3            GOTO NEXT;
      574     9830    3            END;
      575     9831    2         I=0;
      576     9832    3         DO WHILE (I<256);
      577     9833    4            IF CHAR1~=' ' OR SUBSTR(TCXT,I,1)~=' ' OR USW THEN DO;
      578     9834    4               BLK$=PINCRC(BLK$,1);
      579     9835    4               IF POFFW(BLK$,WORK_.FIRST$)>WORK_.SIZE
      580     9836    4               THEN CALL M$GDS(WORKFPT) ALTRET(NOCORE);
      581     9837    4               CHAR1=SUBSTR(TCXT,I,1);
      582     9838    4               IF CHAR1='''' THEN USW=~USW;
      583     9839    4               END;
      584     9840    3            I=I+1;
      585     9841    3            END;
      586     9842    2         IF BLK$=WORK_.FIRST$ THEN GOTO CONTINUE;
      587     9843    2         IF CHAR1=' ' THEN BLK$=PINCRC(BLK$,-1);
      588     9844    3         IF CHAR1=';' THEN DO;
      589     9845    3            IF BLK$=P_PCB.TEXT$ THEN BLK$=WORK_.FIRST$;
      590     9846    3            CHAR1=' ';
      591     9847    3            GOTO CONTINUE;
      592     9848    3            END;
      593     9849    2         P_PCB.NCHARS=POFFC(BLK$,WORK_.FIRST$);
      594     9850    2   NEWPARSE:;
      595     9851    2         P_PCB.WORK$=PINCRC(P_PCB.TEXT$,P_PCB.NCHARS);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:32   
      596     9852    2         P_PCB.WORK$=PALIGNW(P_PCB.WORK$);
      597     9853    2         P_PCB.WKSZ=WORK_.SIZE-POFFW(P_PCB.WORK$,WORK_.FIRST$);
      598     9854    2         USW='0'B;
      599     9855    2         CALL X$PARSE(P_PCB) ALTRET(PARSERR);
      600     9856    2         BLK$=P_PCB.OUT$;
      601     9857    2         END;
      602     9858        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:33   
      603     9859    2      ELSE IF M$SI$->F$DCB.LASTSTA$->ST.MSGTYP#=' ' THEN DO;
      604     9860    2         CALL CLOSE (DCBNUM(M$PROJ));
      605     9861    2         BLK$=WORK_.FIRST$;
      606     9862    2         OUT$BLK.CODE=GBUF.CODE;
      607     9863    2         OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT=GBUF.PSN(0);
      608     9864    2         OUT$BLK.SUBLK$(2)->OUT$BLK.CODE=GBUF.CODE;
      609     9865    2         OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0;
      610     9866    2         WROC.CADDR=GBUF.CADDR;
      611     9867    3         DO CASE(GBUF.CODE);
      612     9868    3         CASE(%SETPUB#,%SETPRIV#,%SETXCL#);
      613     9869    3            OUT$BLK.CODE=%E$MOUNT;
      614     9870    3            OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=%E$PSN;
      615     9871    3         CASE(%SETDSMT#,%SETDSMTF#,%SETDSMTX#);
      616     9872    3            OUT$BLK.CODE=%E$DISMOUNT;
      617     9873    3            OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=%E$PSN;
      618     9874    3         CASE(1);
      619     9875    3            OUT$BLK.CODE=%E$DISPLAY;
      620     9876    3         CASE(2);
      621     9877    3            OUT$BLK.CODE=%E$DISPLAY;
      622     9878    3            IF OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT=' '
      623     9879    3            THEN OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT='SETS';
      624     9880    3            ELSE OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=%E$PSN;
      625     9881    3         CASE(KEY_SETDSMTZ#);
      626     9882    3            ZAP='1'B;
      627     9883    3            I=FM$CFUX.SETH;
      628     9884    4            DO WHILE(I~=0);
      629     9885    4               GBUF.CODE=%SETDSMTX#;
      630     9886    4               GBUF.PSN(0)=FM$SET.PSN(I);
      631     9887    4               IF NOT FM$SET.XCL(I) AND GBUF.PSN(0)~='SYS'
      632     9888    4                 OR FM$SET.SYSID(I)=JG_PIG# THEN CALL M$WRITE(WRAVR);
      633     9889    4               I=FM$SET.SETL(I);
      634     9890    4               END;
      635     9891    3            NUMPSNS=0;
      636     9892    3            CSTAT.SETS.SETX(0)=0; /* Come up as if from DISK BOOT */
      637     9893    3            CALL CATWRITE;
      638     9894    3            GBUF.CADDR='0'B;
      639     9895    3            LBUFC='** ZAP **';
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:34   
      640     9896    3            CALL ERROR(10);
      641     9897    3            GOTO NEXT;
      642     9898    3         CASE(0);
      643     9899    3            OUT$BLK.CODE=%E$AVR;
      644     9900    3         CASE(ELSE);
      645     9901    3            GOTO NEXT;
      646     9902    3         END;
      647     9903    2         WIDTH=64;
      648     9904    2         CALL CATREAD;
      649     9905    2         END;
      650     9906        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:35   
      651     9907    2      ELSE DO;
      652     9908                    /* WE HAVE SUPER INPUT */
      653     9909    2         BLK$=PINCRW(BLK$,20);
      654     9910    2         CALL CATREAD;
      655     9911    3         IF FPT_READ.BUF_.BUF$=ADDR(TCXT) THEN DO;
      656     9912    3            IF LENGTHC(ADDR(TCXT)->S_TO_P)>SIZEC(TCXT)
      657     9913    3            THEN ADDR(TCXT)->S_TO_P.ATTR.COUNT=SIZEC(TCXT);
      658     9914    3            S_TO_P.ATTR.COUNT=ADDR(TCXT)->S_TO_P.ATTR.COUNT;
      659     9915    3            S_TO_P=ADDR(TCXT)->S_TO_P;
      660     9916    3            END;
      661     9917    2         ELSE FPT_READ.BUF_=VECTOR(TCXT);
      662     9918    2         P_PCB.NCHARS=LENGTHC(S_TO_P)-POFFC(ADDR(S_TO_P.PROJECT),ADDR(S_TO_P));;
      663     9919    3         DO I=0 TO NUMPSNS;
      664     9920    3            IF S_TO_P.PACKSET=CSTAT.SETS.PSN(I) AND BINBIT(CSTAT.SETS.SETX(I),1)
      665     9921    3              AND CSTAT.SETS.DISP(I)~=%SETXCL# THEN GOTO SETSUP;
      666     9922    3            END;
      667     9923    2         CALL DEFER ALTRET(DPERR1); /* ALTRETS UNLESS VALIDATEATTR */
      668     9924    2   SETSUP: ;
      669     9925    2         USER_ACCN=S_TO_P.SUPER.ACCT;
      670     9926    2         USER_NAME=S_TO_P.SUPER.UNAME;
      671     9927    3         IF S_TO_P.PROJ THEN DO;
      672     9928    3            PROJAD.NAME=S_TO_P.PROJECT.UNAME;
      673     9929    3            PROJAD.ACCT=S_TO_P.PROJECT.ACCT;
      674     9930    3            CALL FXU$PROJAD ALTRET(DPERR1);
      675     9931    3            BLK$=PINCRW(WORK_.FIRST$,20);
      676     9932    3            END;
      677     9933    2         S_TO_P.PROJECT.UNAME=S_TO_P.PACKSET;
      678     9934    2         S_TO_P.PACKSET='     .';
      679     9935    2         S_TO_P.ATTR.COUNT=ASCBIN(' ')*513;
      680     9936    3         DO CASE(S_TO_P.TYPE);
      681     9937    3         CASE(%CREATE_ACCT);
      682     9938    3            S_TO_P.PROJECT.ACCT='CREATE #';
      683     9939    3         CASE(%MODIFY_ACCT);
      684     9940    3            S_TO_P.PROJECT.ACCT='MODIFY #';
      685     9941    3         CASE(%LIST_ACCT);
      686     9942    3            S_TO_P.PROJECT.ACCT='LIST   #';
      687     9943    3         CASE(%VALIDATE_ATTR);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:36   
      688     9944    3            S_TO_P.PROJECT_TEXT='CREATE #_';
      689     9945    3            S_TO_P.ACCT=':';
      690     9946    3         CASE(%DELETE_ACCT);
      691     9947    3            S_TO_P.PROJECT.ACCT='DELETE #';
      692     9948    3         END;
      693     9949    2         P_PCB.TEXT$=ADDR(S_TO_P.PROJECT);
      694     9950    2         WIDTH=S_TO_P.WIDTH;
      695     9951    2         GOTO NEWPARSE;
      696     9952    2         END;
      697     9953        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:37   
      698     9954                    /* INITIALIZE A FEW THINGS */
      699     9955    1      REMEMBER RESTART IN TRAPX;
      700     9956    1      TRAPCNT=0;
      701     9957    1   RESTART:;
      702     9958    1      NUMSNS=0;
      703     9959    1      X9=0;
      704     9960    1      FITSIZE=SIZEC(DEFAULT_BUILD);
      705     9961    1      ADDR(PADBUF)->FITMOVER=DEFAULT_BUILD;
      706     9962    1      BREAK=0;
      707     9963    1      OPNDP.V.FUN#=%IN#;
      708     9964    1      VLP_ACCT.ACCT#=BINASC(0);
      709     9965    1      SELACCT='?';
      710     9966    1      LBUFC=NONEMSG;
      711     9967    1      CODE=0;
      712     9968    1      GAC=0;
      713     9969    1      OPNDP.FPARAM_=BITVECT(READVID.BUF_);
      714     9970    1      OPNDP.IFPARAM_=VECTOR(NIL);
      715     9971    1      OPNSN.SN#(0)=' ';
      716     9972    1      VLP_NAME='0'B;
      717     9973    1      IF OUT$BLK.NSUBLKS>1
      718     9974    1      THEN IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=%E$PSN
      719     9975    1      THEN OPNSN.SN#(0)=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
      720     9976    1      CLSDP.V.DISP#=%SCRATCH#;
      721     9977    1      WROC.MSG#=PIGERR_MSG#;
      722     9978    1      I0=2;
      723     9979    1      GRANULE=0;
      724     9980    1      MADM.V='0'B;
      725     9981    1      I=2;
      726     9982    1      CODE=OUT$BLK.CODE;
      727     9983    1      IF CODE=0 THEN CODE=OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      728     9984    2      IF PROJAD.L~=0 THEN DO;
      729     9985    2         CALL INDEX1(J,BINASC(CODE),PROJADC)ALTRET(CMDERR);
      730     9986                    /*E*      ERROR: FXP-E$PROJCMD-E
      731     9987                    *         MESSAGE:Not a project administrator command.
      732     9988                    */
      733     9989    2         PRIVFPT.V.PRIV#=%PR_FMDIAG#;
      734     9990    2         CALL M$SPRIV(PRIVFPT);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:38   
      735     9991    2         PRIVFPT.V.PRIV#='0'B;
      736     9992    2         DIAGFPT.V.PRIV#='0'B;
      737     9993    2         END;
      738     9994    2      DO CASE(CODE-%E$PIGH);
      739     9995    2      CASE(%(E$END-E$PIGH),%(E$XIT-E$PIGH),%(E$QUIT-E$PIGH));
      740     9996                    /*E*     ERROR: FXP-E$END-0
      741     9997                    *        MESSAGE:End - exits from PIG.
      742     9998                    */
      743     9999                    /*E*     ERROR: FXP-E$XIT-0
      744    10000                    *        MESSAGE:eXit - exits from PIG.
      745    10001                    */
      746    10002                    /*E*     ERROR: FXP-E$QUIT-0
      747    10003                    *        MESSAGE:Quit - exits from PIG.
      748    10004                    */
      749    10005    2         CALL CLOSE(DCBNUM(M$LO));
      750    10006    2         IF BANNERSZ=0 THEN ALTRETURN;
      751    10007    2         RETURN;
      752    10008        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:39   
      753    10009    2      CASE(%(E$AVR-E$PIGH));
      754    10010    2         CODE=0;
      755    10011    2         X9=20;
      756    10012    2         IF GBUF.PSN(0)~='*INIT*'
      757    10013    2         THEN
      758    10014    2   AVR0: CALL M$WAIT(WAIT1);
      759    10015    2         CALL M$OPEN(OPNDP)ALTRET(AVRERR);
      760    10016    2         X9=F$DCB.SETX;
      761    10017    2         IF FM$DEV.SPIN(X9) THEN CALL M$READ(READVID)ALTRET(NOALT);
      762    10018    2         WROC.DEVNM=F$DCB.PASS;
      763    10019    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);
      764    10020    3         IF FM$DEV.DCTX(X9)=X9 THEN DO;
      765    10021    3            VIDBUF.VOLCNT=0; /* ONLY FIX A PARTIAL VSN RECORD */
      766    10022    3            CALL FXU$CATMNT;
      767    10023    3            IF FM$DEV.SECTL(X9)=0 OR NOT FM$DEV.SPIN(X9) THEN GOTO DISP0;
      768    10024    3            ELSE GOTO NEXT;
      769    10025    3            END;
      770    10026    2         J=FM$VOL.SETX(X9);
      771    10027    2         IF J=0 THEN GOTO DISP0;
      772    10028    3         DO I=0 TO NUMPSNS;
      773    10029    3            IF CSTAT.SETS.PSN(I)=FM$SET.PSN(J)
      774    10030    3              OR CSTAT.SETS.PSN(I)=FM$SET.REALPSN(J)
      775    10031    3            THEN IF CSTAT.SETS.SETX(I)=0 THEN GOTO MOUNT1;
      776    10032    3            ELSE GOTO DISP0;
      777    10033    3            END;
      778    10034    2         OPNSN.SN#(0)=FM$SET.PSN(J);
      779    10035    2         CALL FXU$CATMNT ALTRET(MOUNT1);
      780    10036    2         IF CSTAT.DEFMOUNT~=0 AND VIDBUF.PSN~='CP-6''S' THEN GOTO MOUNT00;
      781    10037    2         GOTO DISP0;
      782    10038    2   AVRERR:;
      783    10039    2         X9=X9-1;
      784    10040    2         IF B$ALT.ERR.CODE=%E$XCLSET AND X9~=0 THEN GOTO AVR0;
      785    10041    2         IF B$ALT.ERR.CODE~=%E$SETDOWN THEN GOTO DPERR;
      786    10042        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:40   
      787    10043    2      CASE(%(E$DISPLAY-E$PIGH));
      788    10044                    /*E*     ERROR: FXP-E$DISPLAY-0
      789    10045                    *        MESSAGE:Display [option]
      790    10046                    *        where option is either SETS, DP#set, or device-name
      791    10047                    */
      792    10048    2         CALL M$SAD(SETSAD)ALTRET(DPERR);
      793    10049    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);
      794    10050    2         IF OUT$BLK.NSUBLKS~=0 THEN OPNSN.SN#(0)=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
      795    10051    3         IF OPNSN.SN#(0)~=' ' THEN DO;
      796    10052    3            IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0 AND OPNSN.SN#(0)='SETS'
      797    10053    3            THEN GOTO DISPS;
      798    10054    3            CODE=0;/* ONLY ONE THING THIS TIME */
      799    10055    3            X9=FM$CFUX.SETH;
      800    10056    3            P_PCB.HI_CHAR=OUT$BLK.SUBLK$(1)->OUT$BLK.CPOS;
      801    10057    4            DO WHILE(X9~=0 AND FM$SET.PSN(X9)~=OPNSN.SN#(0));
      802    10058    4               X9=FM$SET.SETL(X9);
      803    10059    4               END;
      804    10060    3            IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE~=0 THEN GOTO DISPS0;
      805    10061    3            IF SUBSTR(OPNSN.SN#(0),0,2)='DP'
      806    10062    3              AND SUBSTR(OPNSN.SN#(0),2,1)>='0'
      807    10063    3              AND SUBSTR(OPNSN.SN#(0),2,1)<='9'
      808    10064    3              AND SUBSTR(OPNSN.SN#(0),3,1)>='0'
      809    10065    3              AND SUBSTR(OPNSN.SN#(0),3,1)<='9'
      810    10066    4            THEN DO;
      811    10067    4               CALL INSERT(WROC.DEVNM,2,2,SUBSTR(OPNSN.SN#(0),2,2));
      812    10068    4               CALL CONCAT(OPNSN.SN#(0),BINASC(0),SUBSTR(WROC.DEVNM,0,4));
      813    10069    4               END;
      814    10070    3            ELSE IF MODE~=0 THEN GOTO PARSERR;
      815    10071    4            ELSE DO;
      816    10072    4               WROC.MSG#=%PIG_DEVERR_MSG#;
      817    10073    4               WROC.PSN=SUBSTR(OPNSN.SN#(0),0,4);
      818    10074    4               CALL ERROR(10);
      819    10075    4               GOTO NEXT;
      820    10076    4               END;
      821    10077    3            CALL M$OPEN(OPNDP)ALTRET(NOALT);
      822    10078    3            IF SUBSTR(OPNSN.SN#(0),0,2)=%CONCAT(BINASC(0),BINASC(0))
      823    10079    3            THEN SUBSTR(OPNSN.SN#(0),0,2)='@@';
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:41   
      824    10080                    /* Only display one line for a reconstruct avr message */
      825    10081    3            X9=F$DCB.SETX;
      826    10082    3            GOTO DISP0;
      827    10083    3            END;
      828    10084    2         X9=FM$CFUX.DSETH;
      829    10085    3         DO WHILE (X9~=0);
      830    10086    3            CALL CONCAT(OPNSN.SN#(0),BINASC(0),BINASC(0),ADDR(X9)->CHAR4);
      831    10087    3            CALL M$OPEN(OPNDP)ALTRET(NOALT);
      832    10088    3            WROC.DEVNM=F$DCB.PASS;
      833    10089    3   DISP0:   ;
      834    10090    3            CALL CLOSE(DCBNUM(M$DP));
      835    10091    3            REMEMBER DISP0 IN TRAPX;
      836    10092    3            WROC.MSG#=DISK_MSG#;
      837    10093    3            LBUFC='DPNN is not a CP6 pack';
      838    10094    3            DBUF.DEV=SUBSTR(WROC.DEVNM,2,2);
      839    10095    4            IF FM$DEV.SPIN(X9) AND X9~=0 THEN DO;
      840    10096    4   DISP1:      ;
      841    10097    4               WROC.VSN=FM$VOL.VSN(X9);
      842    10098    4               WROC.N=0;
      843    10099    4               WROC.PSN=' ';
      844    10100    4               IF FM$DEV.DCTX(X9)=X9 AND FM$DEV.SECTL(X9)~=0
      845    10101    4                 AND NOT FM$DEV.MIRROR(X9)
      846    10102    4               THEN X9=FM$DEV.SECTL(X9);
      847    10103    4               IF FM$DEV.DCTX(X9)=X9 THEN I=0;
      848    10104    4               ELSE I=FM$VOL.SETX(X9);
      849    10105    5               IF I~=0 THEN DO;
      850    10106    5                  WROC.VOL=FM$VOL.VOL#(X9);
      851    10107    6                  IF FM$SET.REALPSN(I)=' ' THEN DO;
      852    10108    6                     WROC.PSN=FM$SET.PSN(I);
      853    10109    6                     WROC.DPSN=' ';
      854    10110    6                     END;
      855    10111    6                  ELSE DO;
      856    10112    6                     WROC.PSN=FM$SET.REALPSN(I);
      857    10113    6                     WROC.DPSN=FM$SET.PSN(I);
      858    10114    6                     END;
      859    10115    5                  WROC.N=FM$SET.SYSID(I);
      860    10116    5                  IF NOT FM$SET.XCL(I)
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:42   
      861    10117    5                  THEN IF FM$SET.NONEWU(I) THEN WROC.N=3;
      862    10118    5                  ELSE WROC.N=2;
      863    10119    5                  END;
      864    10120    5               IF WROC.VSN~=0 THEN DO;
      865    10121    5                  I=4;
      866    10122    5                  J=WROC.VSN;
      867    10123    5                  CALL ADDPARNUM(%M#VSN);
      868    10124    6                  IF FM$VOL.SECT#(X9)~=0 THEN DO;
      869    10125    6                     CALL INSERT(LBUFC,I,1,BINASC(FM$VOL.SECT#(X9)+ASCBIN('@')));
      870    10126    6                     WROC.SECT=SUBSTR(LBUFC,I,1);
      871    10127    6                     I=I+1;
      872    10128    6                     END;
      873    10129    5                  ELSE WROC.SECT=' ';
      874    10130    5                  IF FM$DEV.MIRROR(X9) THEN WROC.N=4;
      875    10131    6                  IF WROC.PSN~=' ' THEN DO;
      876    10132    6                     J=WROC.VOL;
      877    10133    6                     CALL ADDPARNUM(%MVOL#);
      878    10134    6                     CALL ADDPARAM(%M#PSN);
      879    10135    6                     CALL ADDPART(6,WROC.PSN);
      880    10136    7                     IF WROC.DPSN~=' ' THEN DO;
      881    10137    7                        CALL ADDPART(2,' (');
      882    10138    7                        CALL ADDPART(6,WROC.DPSN);
      883    10139    7                        CALL ADDPART(1,')');
      884    10140    7                        END;
      885    10141    6                     IF WROC.PSN='CP-6''S' AND WROC.N=0 THEN WROC.N=1;
      886    10142    6                     END;
      887    10143    6                  DO CASE(WROC.N);
      888    10144    6                  CASE(2);
      889    10145    6                     CALL ADDPARAM(%MSHARED);
      890    10146    6                  CASE(3);
      891    10147    6                     CALL ADDPARAM(%MLOCKED);
      892    10148    6                  CASE(1);
      893    10149    6                     J=666;
      894    10150    6                     CALL ADDPARNUM(%MRESERVD);
      895    10151    6                     SUBSTR(LBUFC,I-3,2)='CP';
      896    10152    6                  CASE(4);
      897    10153    6                     J=FM$DEV.MRRDCTX(X9);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:43   
      898    10154    7                     IF J=0 THEN DO; /* Waiting */
      899    10155    7                        WROC.SECT='w';
      900    10156    7                        CALL ADDPARAM(%MMRRWAIT);
      901    10157    7                        END;
      902    10158    7                     ELSE DO;
      903    10159    7                        IF FM$DEV.MRRDCTX(X9)<0 THEN J=-FM$DEV.MRRDCTX(X9);
      904    10160    7                        J=FM$DEV.NN(J);
      905    10161    7                        SUBSTR(WROC.PSN,0,2)='DP';
      906    10162    7                        CALL BINCHAR(SUBSTR(WROC.PSN,2,2),J);
      907    10163    8                        IF FM$DEV.MRRDCTX(X9)>0 THEN DO;
      908    10164    8                           WROC.SECT='m';
      909    10165    8                           CALL ADDPARAM(%MMIRROR);
      910    10166    8                           END;
      911    10167    8                        ELSE DO;
      912    10168    8                           WROC.SECT='r';
      913    10169    8                           CALL ADDPARAM(%MMRRRSTR);
      914    10170    8                           END;
      915    10171    7                        CALL ADDPART(2,SUBSTR(WROC.PSN,2,2));
      916    10172    7                        END;
      917    10173    6                  CASE(0);
      918    10174    6                     CALL ADDPARAM(%MAVAIL);
      919    10175    6                  CASE(ELSE);
      920    10176    6                     J=WROC.N;
      921    10177    6                     CALL ADDPARNUM(%MUSER);
      922    10178    6                  END;
      923    10179    5                  END;
      924    10180    4               END;
      925    10181    4            ELSE DO;
      926    10182    4               I=7;
      927    10183    4               CALL ADDPARAM(%MEMPTY);
      928    10184    4               WROC.N=4;
      929    10185    4               WROC.VSN=0;
      930    10186                    /* IF NOT SPINNING BUT STILL IN USE.. */
      931    10187    4               IF X9~=0 AND FM$DEV.SECTL(X9)~=0
      932    10188    4               THEN IF OPNSN.SN#(0)=' ' THEN WROC.MSG#=DPERR_MSG#;
      933    10189    4               ELSE GOTO DISP1;
      934    10190    4               END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:44   
      935    10191    3            IF CODE=0 OR WROC.VSN~=0 OR WROC.N~=4 THEN
      936    10192    3            CALL ERROR(10);
      937    10193    3            IF CODE=0 AND OPNSN.SN#(0)>=' ' OR X9=0 THEN GOTO NEXT;
      938    10194    3            IF FM$VOL.SECTL(X9)~=0 THEN X9=FM$VOL.SECTL(X9);
      939    10195    3            ELSE IF CODE~=0 THEN X9=FM$DEV.DEVL(FM$VOL.DCTX(X9));
      940    10196    3            ELSE GOTO NEXT;
      941    10197    3            TRAPCNT=0;
      942    10198    3            END;
      943    10199        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:45   
      944    10200    2   DISPS:;     /* DISPLAY SET STATUS(ES) */
      945    10201    2         X9=FM$CFUX.SETH;
      946    10202    3         DO WHILE(X9~=0);
      947    10203    3   DISPS0:  ;
      948    10204    3            REMEMBER DISPS0 IN TRAPX;
      949    10205    3            LBUFC='Set #';
      950    10206    3            WROC.MSG#=PKSET_MSG#;
      951    10207    3            I=5;
      952    10208    4            IF X9=0 THEN DO;
      953    10209    4               WROC.PSN=OPNSN.SN#(0);
      954    10210    4               WROC.N=0;
      955    10211    4               END;
      956    10212    4            ELSE DO;
      957    10213    4               WROC.PSN=FM$SET.PSN(X9);
      958    10214    4               WROC.N=FM$SET.SYSID(X9);
      959    10215    4               END;
      960    10216    3            CALL ADDPART(6,WROC.PSN);
      961    10217    4            IF FM$SET.SET(X9) AND X9~=0 THEN DO;
      962    10218    5               IF FM$SET.XCL(X9) THEN DO;
      963    10219    5                  IF WROC.N=0 THEN CALL ADDPARAM(%MAVAIL);
      964    10220    6                  ELSE DO;
      965    10221    6                     J=WROC.N;
      966    10222    6                     CALL ADDPARNUM(%MUSER);
      967    10223    6                     WROC.VSN=WROC.N;
      968    10224    6                     END;
      969    10225    5                  END;
      970    10226    5               ELSE DO;/* IF FM$SET.XCL=0 */
      971    10227    6                  IF FM$SET.NONEWU(X9) THEN DO;
      972    10228    6                     CALL ADDPARAM(%MLOCKED);
      973    10229    6                     WROC.N=3;
      974    10230    6                     END;
      975    10231    6                  ELSE DO;
      976    10232    6                     CALL ADDPARAM(%MSHARED);
      977    10233    6                     WROC.N=2;
      978    10234    6                     END;
      979    10235    6                  IF NOT FM$SET.ONEU(X9) THEN DO;
      980    10236    6                     WROC.VSN=-1;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:46   
      981    10237    6                     GRANULE=I+1;
      982    10238    6                     IF CODE=0 THEN WROC.N=WROC.N+3;
      983    10239    6                     P$=PINCRW(F$CFU$,FM$SET.USERLIST(X9));
      984    10240    7                     DO WHILE(P$~=F$CFU$);
      985    10241    7                        WROC.VSN=WROC.VSN+FM$SETU.NUM;
      986    10242    8                        IF CODE=0 THEN DO NUMSNS=0 TO FM$SETU.NUM-1;
      987    10243    8                           J=FM$SETU.SYSID(NUMSNS);
      988    10244    8                           IF J~=JG_PIG# THEN CALL ADDPARNUM(%MNUM);
      989    10245    8                           END;
      990    10246    7                        P$=PINCRW(F$CFU$,FM$SETU.LINKX);
      991    10247    7                        END;
      992    10248    6                     J=WROC.VSN;
      993    10249    7                     IF CODE~=0 THEN DO;
      994    10250    7                        CALL ADDPARNUM(%MNUM);
      995    10251    7                        CALL ADDPARAM(%MUSERS);
      996    10252    7                        END;
      997    10253    6                     END;
      998    10254    5                  ELSE WROC.VSN=0;
      999    10255    5                  END;
     1000    10256    4               END;
     1001    10257    4            ELSE DO;/* IF NOT FM$SET.SET */
     1002    10258    4               J=WROC.N;
     1003    10259    4               IF (FM$SET.PSN(X9)='CP-6''S' OR FM$SET.REALPSN(X9)='CP-6''S')
     1004    10260    4                 AND J=0 THEN J=1;
     1005    10261    4               WROC.N=4;
     1006    10262    4               WROC.VSN=J;
     1007    10263    4               IF J~=0 THEN CALL ADDPARNUM(%MRESERVD);
     1008    10264    4               ELSE CALL ADDPARAM(%MNOTSET);
     1009    10265    4               END;
     1010    10266    3            IF CODE=0 OR WROC.VSN>1 OR WROC.N~=4 THEN CALL ERROR(10);
     1011    10267    3            IF CODE=0 THEN GOTO NEXT;
     1012    10268    3            X9=FM$SET.SETL(X9);
     1013    10269    3            TRAPCNT=0;
     1014    10270    3            END;
     1015    10271        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:47   
     1016    10272    2      CASE(%(E$SCRATCH-E$PIGH));
     1017    10273                    /*E*     ERROR: FXP-E$SCRATCH-0
     1018    10274                    *        MESSAGE:SCRatch vsn,...,vsn
     1019    10275                    *        or SCRatch device-name AS vsn [(size,...,size)]
     1020    10276                    *        or SCRatch vsn [(size,...,size)]
     1021    10277                    *        or SCRatch DP#set
     1022    10278                    */
     1023    10279    2         J=0;
     1024    10280    2         VID1='0'B;
     1025    10281    2         VID1.PSN=OPNSN.SN#(0);
     1026    10282    2         IF VID1.PSN=' ' THEN I=1;
     1027    10283    3         DO WHILE(I<OUT$BLK.NSUBLKS);
     1028    10284    3            P$=OUT$BLK.SUBLK$(I);
     1029    10285    3            IF P$->OUT$BLK.CODE=3 THEN J=50; /* GOT SECT LIST */
     1030    10286    4            ELSE IF P$->OUT$BLK.CODE=1 THEN DO; /* GOT 'DP' NN 'AS' VSN */
     1031    10287    4               CALL CONCAT(OPNSN.SN#(0),BINASC(4),'DP',
     1032    10288    4                 OUT$BLK.SUBLK$(I+1)->OUT$SYM.TEXT,'0');
     1033    10289    4               I=I+2; /* SKIP NN AND 'AS' */
     1034    10290    4               END;
     1035    10291    3            ELSE IF P$->OUT$BLK.NDTYPE=%PL6SYM# THEN VID1.SNLIST.VSN.S(J-1)=
     1036    10292    3              ASCBIN(P$->OUT$SYM.TEXT)-ASCBIN('@'); /* GOT SECT# */
     1037    10293    4            ELSE DO; /* MUST BE A NUMBER */
     1038    10294    4               CALL CHARBIN(VIDBUF.VSN,P$->OUT$SYM.TEXT);
     1039    10295    4               IF VIDBUF.VSN=0 OR J=48 THEN GOTO TOOMANY;
     1040    10296    4               IF J<50 THEN VID1.SNLIST.VSN.N(J)=VIDBUF.VSN;
     1041    10297    5               ELSE DO;
     1042    10298    5                  IF J=76 OR VIDBUF.VSN<7 OR VIDBUF.VSN>262143 THEN GOTO TOOMANY;
     1043    10299    5                  VID1.SECTSTRT(J-49)=VID1.SECTSTRT(J-50)+VIDBUF.VSN;
     1044    10300    5                  VID1.SECTSTRT(J-48)=VID1.SECTSTRT(J-49);
     1045    10301    5                  VID1.SNLIST.SIZE(J-49)=I;
     1046    10302    5                  END;
     1047    10303    4               J=J+1;
     1048    10304    4               END;
     1049    10305    3            I=I+1;
     1050    10306    3            END;
     1051    10307    2         I=0;
     1052    10308    2         NUMSNS=1;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:48   
     1053    10309    3         DO WHILE (I<NUMSNS);
     1054    10310    4            IF OPNSN.SN#(0)<=' ' AND SUBSTR(OPNSN.SN#(0),4,1)=' ' THEN DO;
     1055    10311    4               OPNSN.SN#(0)=ADDR(VID1.SNLIST(I))->CHAR4;
     1056    10312    5               IF SUBSTR(OPNSN.SN#(0),0,1)>BINASC(1) AND GRANULE=0 THEN DO;
     1057    10313                    /* Read the "bottom" vid if we're doing a single section.  That'll
     1058    10314                       make sure the sectionlist and defective track info is ok. */
     1059    10315    5                  OPNDP.V.FUN#=%IN#;
     1060    10316    5                  SUBSTR(OPNSN.SN#(0),0,1)=BINASC(0);
     1061    10317    5                  CALL M$OPEN(OPNDP)ALTRET(VOLERR);
     1062    10318    5                  CALL M$READ(READVID)ALTRET(DPERR);
     1063    10319    5                  VIDBUF.SNLIST=VID1.SNLIST;
     1064    10320    5                  VID1=VIDBUF;
     1065    10321    5                  CALL CLOSE(DCBNUM(M$DP));
     1066    10322    5                  SUBSTR(OPNSN.SN#(0),0,1)=BINASC(VID1.SNLIST.VSN.S(I));
     1067    10323    5                  END;
     1068    10324    4               END;
     1069    10325    3            OPNDP.V.FUN#=%UPDATE#;
     1070    10326    3            IF GRANULE=0 THEN CALL M$OPEN(OPNDP)ALTRET(VOLERR);
     1071    10327    3            IF NOT F$DCB.OWNER AND OPNSN.SN#(0)~='SYS' THEN GOTO NOTOWNER;
     1072    10328    3            CALL M$READ(READVID)ALTRET(DPERR);
     1073    10329    3            IF GRANULE=0 THEN
     1074    10330    3            CALL FXU$PROTCHK(VIDBUF)ALTRET(DPCLOSE);
     1075    10331    4            IF NOT VID1.SNLIST.VSN(0) THEN DO; /* SCRATCHING A SET */
     1076    10332    4               IF BINBIT(VIDBUF.VOLCNT-1,18)&'7777'O THEN GOTO ALRDYSCRCH;
     1077    10333    4               VID1.SNLIST=VIDBUF.SNLIST;
     1078    10334    4               VID1.SNLIST(VIDBUF.VOLCNT)='0'B;
     1079    10335    4               END;
     1080    10336    4            ELSE DO;
     1081    10337    4               VIDBUF.VSN=VID1.SNLIST.VSN.N(I);
     1082    10338    4               IF GRANULE>0 OR VID1.SNLIST.VSN.S(I)<2 THEN EXIT;
     1083    10339    4               VIDBUF=VID1;
     1084    10340    4               VID1.SECTSTRT='0'B;
     1085    10341    4               END;
     1086    10342    4            IF VID1.SECTSTRT THEN IF GRANULE=0 THEN DO;
     1087    10343    4               J=0;
     1088    10344    5               DO WHILE(VID1.SECTSTRT(J)<=VID1.SECTSTRT(J+1));
     1089    10345    6                  DO I=0 TO 62;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:49   
     1090    10346    6                     IF VID1.SECTSTRT(J)+2>=VIDBUF.DGT.FGRAN(I)
     1091    10347    6                       AND VID1.SECTSTRT(J)<=VIDBUF.DGT.LGRAN(I)
     1092    10348    6                       AND VIDBUF.DTT(I)~=262143 AND VID1.SECTSTRT(J)~=0
     1093    10349    6                     THEN VID1.SECTSTRT(J)=VIDBUF.DGT.LGRAN(I)+1;
     1094    10350    6                     END;
     1095    10351    5                  I=0; /* RESTORE I */
     1096    10352    6                  IF VID1.SECTSTRT(J)>F$DCB.IXTNSIZE THEN DO;
     1097    10353    6                     I=VID1.SNLIST.SIZE(J);
     1098    10354    6                     CALL CLOSE(DCBNUM(M$DP));
     1099    10355    6                     GOTO TOOMANY;
     1100    10356    6                     END;
     1101    10357    5                  IF VID1.SECTSTRT(J)=VID1.SECTSTRT(J+1)
     1102    10358    5                  THEN VID1.SECTSTRT(J+1)=F$DCB.IXTNSIZE;
     1103    10359    5                  VID1.SNLIST.SIZE(J)=VID1.SECTSTRT(J+1)-VID1.SECTSTRT(J);
     1104    10360    5                  IF VID1.SNLIST.SIZE(J)>262143 THEN GOTO BIGSECT;
     1105    10361    5                  J=J+1;
     1106    10362    5                  END;
     1107    10363    4               VIDBUF.SECTSTRT=VID1.SECTSTRT;
     1108    10364    4               VID1.DTT=VIDBUF.DTT;
     1109    10365    4               VID1.DGT=VIDBUF.DGT;
     1110    10366    4               VID1.VSN=VIDBUF.VSN;
     1111    10367    4               END;
     1112    10368    3            ELSE VIDBUF=VID1;
     1113    10369    4            ELSE DO;
     1114    10370    4               IF SUBSTR(OPNSN.SN#(0),0,1)=BINASC(0) THEN VIDBUF.SECTSTRT='0'B;
     1115    10371    4               ELSE IF SUBSTR(OPNSN.SN#(0),0,1) > ' ' AND VIDBUF.SECTSTRT(1) = 0
     1116    10372    4                 AND VID1.SNLIST.SIZE(I) < 262144 THEN EXIT;
     1117    10373    4               IF VIDBUF.SECTSTRT(1)<262144 AND (VIDBUF.SECTSTRT(1)>0
     1118    10374    4                 OR F$DCB.IXTNSIZE<262144) THEN EXIT;
     1119    10375    4   BIGSECT:    ;
     1120    10376                    /*E*     ERROR: FXP-E$BIGSECT-E
     1121    10377                    *        MESSAGE:Volume section size exceeds 262143 granules.
     1122    10378                    *        MESSAGE1:CP-6 File management requires that any disk volume
     1123    10379                    *        section granule number be represented in 18 bit fields.
     1124    10380                    *        Therefore, on devices comprising more than 262143
     1125    10381                    *        pages of storage, smaller sections must be specified.
     1126    10382                    */
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:50   
     1127    10383    4               FLAG=FXP$E$BIGSECT;
     1128    10384    4               GOTO DPERR1;
     1129    10385    4               END;
     1130    10386    3            VIDBUF.VOLCNT=0;
     1131    10387    3            VIDBUF.SYSSIZE=0;
     1132    10388    3            VIDBUF.ID='CP6';
     1133    10389    3            CALL M$WRITE(WRITEVID)ALTRET(DPERR);
     1134    10390    3            GRANULE=GRANULE+VID1.SNLIST.SIZE(I);
     1135    10391    3            IF VID1.SNLIST(I+1) THEN NUMSNS=NUMSNS+1;
     1136    10392    3   ALRDYSCRCH:;
     1137    10393    3            IF GRANULE=0 THEN CALL CLOSE(DCBNUM(M$DP));
     1138    10394    3            I=I+1;
     1139    10395    3            END;
     1140    10396    2         CALL CLOSE(DCBNUM(M$DP));
     1141    10397    2         IF B$JIT.NEXTCC ~= %CC_FROMUC# THEN /* delay for STAR 42926 */
     1142    10398    2         CALL M$WAIT(WAIT1);
     1143    10399        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:51   
     1144    10400    2      CASE(%(E$CREATE-E$PIGH),%(E$MODIFY-E$PIGH));
     1145    10401                    /*E*     ERROR: FXP-E$CREATE-0
     1146    10402                    *        MESSAGE:CReate DP#set.acct options
     1147    10403                    *        Type Help OPtions for options. Default from PADFIT.
     1148    10404                    */
     1149    10405                    /*E*     ERROR: FXP-E$MODIFY-0
     1150    10406                    *        MESSAGE:Modify DP#set.acct options
     1151    10407                    *        Type Help OPtions for options. Default from FDFIT.
     1152    10408                    */
     1153    10409                    /*E*     ERROR: FXP-E$OPTIONS-0
     1154    10410                    *        MESSAGE:Options are separated by commas
     1155    10411                    *        [NO] Checkwrite - controls writes of directories
     1156    10412                    *        [NO] Acup - controls maintenance of access dates
     1157    10413                    *        [NO] [Default] Backup - controls auto backup mode
     1158    10414                    *        Granlim = n - limits total granules in acct
     1159    10415                    *        CGmem = n - limits total CG pages in memory
     1160    10416                    *        [NOt] PRotected - controls multi-user-authorization access
     1161    10417                    *        [NO] PUrge - controls automatic file purge
     1162    10418                    *        [NO] STow - controls stowability of files
     1163    10419                    *        [NO] Datacheckwrite - controls all writes
     1164    10420                    *        [NO] Merge - makes file override merge instead
     1165    10421                   *        Owner = (account/name...) - permits access modification to users
     1166    10422                    *        NONE = (acct...) - no access even to the filenames
     1167    10423                    *        WRITE = (acct...) - default creator access, files override
     1168    10424                    *        Nolist = (acct...) - default nolist, but files may override
     1169    10425                    *        list = (acct...) - other default accesses, files override
     1170    10426                    *        ...list elements follow...separate by blanks or not at all
     1171    10427                    *        Create - create new files
     1172    10428                    *        Delrec - delete records
     1173    10429                    *        DELF - delete file, change name, password, access control
     1174    10430                    *        Execute - access depends on access vehicle
     1175    10431                    *        Fitmod - change all but name, password, access control
     1176    10432                    *        Read - read records, position
     1177    10433                    *        REATtr - same as Fitmod
     1178    10434                    *        Scratch - same as DELF
     1179    10435                    *        Update - replace existing records
     1180    10436                    *        Wnew - add new records
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:52   
     1181    10437                    */
     1182    10438    2         IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0 THEN GOTO MADLIST;
     1183    10439    3         IF OPNSN.SN#(0)='_' AND MODE=0 THEN DO;
     1184    10440                    /* Super "check syntax" request, just send back a response */
     1185    10441    3            CALL ERROR(10);
     1186    10442    3            GOTO NEXT;
     1187    10443    3            END;
     1188    10444    2         SELACCT=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;
     1189    10445    2   ACCTNXT: LBUFC=VLP_ACCT.ACCT#;
     1190    10446    2         VLP_ACCT.ACCT#=BINASC(0);
     1191    10447    2         FLAG='0'B;
     1192    10448    2         FIT.CODES.CODE(0)=0;
     1193    10449    2         IF PROJAD.L=0 THEN CALL M$OPEN(OPNDP)ALTRET(NOALT);
     1194    10450    2         ELSE VIDBUF=CSTAT;
     1195    10451    2         IF F$DCB.IASN=%FMDIAG# THEN CALL M$SPRIV(PRIVFPT);
     1196    10452    2         VLP_ACCT.ACCT#=LBUFC;
     1197    10453    2         IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0 THEN I=2;
     1198    10454    3         ELSE DO;
     1199    10455    3            CALL NXTACCT ALTRET(NEXT);
     1200    10456    3            I=3;
     1201    10457    3            END;
     1202    10458    2         IF BREAK~=0 THEN GOTO CMDABORT;
     1203    10459    2         IF CODE=%E$MODIFY THEN /* MODIFY WHAT'S THERE */
     1204    10460    2   OPNACCT:
     1205    10461    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1206    10462    2         CALL MOVEFIT;
     1207    10463    3         IF CODE=%E$CREATE THEN DO;
     1208    10464    3            IF FLAG THEN GOTO DPERR;
     1209    10465    3            FIT14.NDW=SIZEW(CODE14)-SIZEW(CODE14.OWNER)+SIZEW(CODE14.OWNER(0));
     1210    10466    3            CODE14.OWNER.ACCT(0)=' ';
     1211    10467    3            END;
     1212    10468    2         X9=0;
     1213    10469    3         DO WHILE (I<OUT$BLK.NSUBLKS);
     1214    10470    3            CALL GET_OPTIONS ALTRET(TOOMANY);
     1215    10471    3            I=I+1;
     1216    10472    3            END;
     1217    10473    2         FLAG='0'B;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:53   
     1218    10474    3         IF PROJAD.L~=0 THEN DO;
     1219    10475    3            I=CODE14.MGRANS;
     1220    10476    3            CALL FXU$PROJGR(I) ALTRET(DPERR1);
     1221    10477    3            END;
     1222    10478    2         OPNDP.IFPARAM_=OPNDP.FPARAM_;
     1223    10479    2         VBASE(OPNDP.IFPARAM_)=ADDR(FIT00);
     1224    10480    2         OPNDP.V.FUN#=%UPDATE#;
     1225    10481    2         CALL M$OPEN(OPNDP)ALTRET(NOALT);
     1226    10482    3         IF FLAG.CODE=%E$PSGRANS AND PROJAD.L=0 THEN DO;
     1227    10483    3            CALL M$READ(READVID)ALTRET(DPERR);
     1228    10484    3            IF F$DCB.OWNER THEN CALL RECONST ALTRET(DPERR1);
     1229    10485    3            CALL CLOSE(DCBNUM(M$DP));
     1230    10486    3            FLAG='0'B;
     1231    10487    3            CALL M$OPEN(OPNDP)ALTRET(NOALT);
     1232    10488    3            END;
     1233    10489    2         OPNDP.IFPARAM_=VECTOR(NIL);
     1234    10490    2         IF FLAG THEN GOTO DPERR;
     1235    10491    2         CALL M$RPRIV(PRIVFPT)ALTRET(NOALT);
     1236    10492    2         CALL FXU$TRACKER(P_PCB);
     1237    10493    2         IF PROJAD.L~=0 THEN CALL FXU$PROJWR ALTRET(DPERR1);
     1238    10494    2         GOTO LISTNXT;
     1239    10495        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:54   
     1240    10496    2      CASE(%(E$LIST-E$PIGH));
     1241    10497                    /*E*     ERROR: FXP-E$LIST-0
     1242    10498                    *        MESSAGE:List {DP#set[.acct]|.acct}
     1243    10499                    */
     1244    10500    2         IF OPNSN.SN#(0)=' ' THEN GOTO MADLIST;
     1245    10501    2   LISTNXTM:;
     1246    10502    2         CALL M$OPEN(OPNDP)ALTRET(NOALT);
     1247    10503    2   LISTNXT0: IF F$DCB.IASN=%FMDIAG# OR B$JIT.PPRIV.PIGD
     1248    10504    2         THEN CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);
     1249    10505    2         LISTH1.PSN=OPNSN.SN#(0);
     1250    10506    3         IF OUT$BLK.NSUBLKS>2 THEN DO;
     1251    10507    3            SELACCT=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;
     1252    10508    3            CALL NXTACCT ALTRET(LISTGP);
     1253    10509    3            END;
     1254    10510    2   LISTNXT:;
     1255    10511    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1256    10512    2         IF PROJAD.L~=0 AND F$DCB.ACCT=BINASC(0) THEN VIDBUF=CSTAT;
     1257    10513    2         CALL MOVEFIT;
     1258    10514    2   LISTNXT1:;
     1259    10515    2         LBUFC=LBUF0;
     1260    10516    2         IF CODE14.CGRANS>99999 THEN LBUF.CGRANS='*****';
     1261    10517    2         ELSE CALL BINCHAR(LBUF.CGRANS,CODE14.CGRANS);
     1262    10518    2         CALL EDITSTR(LBUF.CGRANS,0,4,'001000100'B,LBUF.CGRANS);
     1263    10519    3         IF CODE14.CGRANS<0 THEN DO;
     1264    10520    3            CALL INDEX1R(J,' ',LBUFC,15);
     1265    10521    3            CALL INSERT(LBUFC,J,1,'-');
     1266    10522    3            END;
     1267    10523    2         IF CODE14.MGRANS>99999 THEN LBUF.MGRANS='*****';
     1268    10524    2         ELSE CALL BINCHAR(LBUF.MGRANS,CODE14.MGRANS);
     1269    10525    2         CALL EDITSTR(LBUF.MGRANS,0,4,'001000100'B,LBUF.MGRANS);
     1270    10526    2         I=POFFC(ADDR(LBUF.REST),ADDR(LBUF));
     1271    10527    2         I0=I;
     1272    10528    2         FLAG=CODE14.DFLTALL;
     1273    10529    2         CALL ACCTLTXT;
     1274    10530    2         CALL INSERT(TCXT,0,30,SUBSTR(TCXT,2,NUMSNS-2),'=?');
     1275    10531    2         CALL ADDPART(30,TCXT);
     1276    10532    3         IF CODE=%E$LIST THEN DO;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:55   
     1277    10533    3            IF F$DCB.ACCT=BINASC(0) THEN CALL ERROR(8);
     1278    10534    3            CODE=CODE+1;
     1279    10535    3            CALL ERROR(9);
     1280    10536    3            END;
     1281    10537    3         IF VLP_ACCT.ACCT#=BINASC(0) THEN DO;
     1282    10538    3            IF CODE14.ACCESS.NEWFD THEN CALL ADDPARAM(%NONEWM);
     1283    10539    3            IF CODE14.ACCESS.GACSHELF THEN CALL ADDPARAM(%MGACSHELF);
     1284    10540    3            END;
     1285    10541    3         ELSE DO;
     1286    10542    3            LBUF.ACCT=F$DCB.ACCT;
     1287    10543    3            J=CODE14.CGRANS;
     1288    10544    3            IF CODE14.CGRANS>99999 THEN CALL ADDPARNUM(%CGRM);
     1289    10545    3            END;
     1290    10546    2         J=CODE14.MGRANS;
     1291    10547    2         IF J>99999 THEN CALL ADDPARNUM(%MGRM);
     1292    10548    2         IF NOT CODE14.ACCESS.OWNERF THEN CALL ADDPARAM(%PROTM);
     1293    10549    2         IF NOT CODE14.ACCESS.BUPF THEN CALL ADDPARAM(%NBUPM);
     1294    10550    2         ELSE IF CODE14.ACCESS.BUPM THEN CALL ADDPARAM(%DBUPM);
     1295    10551    2         IF CODE14.ACCESS.NOACUP THEN CALL ADDPARAM(%NOACM);
     1296    10552    2         IF CODE14.ACCESS.NPUR THEN CALL ADDPARAM(%NPURM);
     1297    10553    2         IF CODE14.ACCESS.NOSTOW THEN CALL ADDPARAM(%NSTOW);
     1298    10554    2         IF CODE14.ACCESS.WRCMP THEN CALL ADDPARAM(%MWRCMP);
     1299    10555    2         IF CODE14.ACCESS.WCDATA THEN CALL ADDPARAM(%MWCDATA);
     1300    10556    2         IF CODE14.ACCESS.MERGEAC THEN CALL ADDPARAM(%MMERGE);
     1301    10557    2         J=CODE14.CGMEM*%CGMEMSIZ;
     1302    10558    2         IF J~=0 THEN CALL ADDPARNUM(%CGMM);
     1303    10559    2         TIMEUTS=FIT09.NDW*4/10-1;
     1304    10560    3         IF CODE14.ACCESS.LIST THEN DO X9=0 TO TIMEUTS;
     1305    10561    3            FLAG=CODE09.FFLG(X9);
     1306    10562    3            CALL ACCTLTXT;
     1307    10563    4            IF X9<TIMEUTS AND CODE09.FFLG(X9)=CODE09.FFLG(X9+1) THEN DO;
     1308    10564    4               CALL INSERT(TCXT,NUMSNS,30,'=(',CODE09.ACCT(X9));
     1309    10565    5               DO WHILE(X9<TIMEUTS
     1310    10566    5                 AND CODE09.FFLG(X9)=CODE09.FFLG(X9+1));
     1311    10567    5                  X9=X9+1;
     1312    10568    5                  CALL ADDPART(30,TCXT);
     1313    10569    5                  CALL INSERT(TCXT,2,30,CODE09.ACCT(X9));
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:56   
     1314    10570    5                  END;
     1315    10571    4               CALL INDEX1(NUMSNS,' ',TCXT,2);
     1316    10572    4               CALL INSERT(TCXT,NUMSNS,1,')');
     1317    10573    4               CALL ADDPART(30,TCXT);
     1318    10574    4               END;
     1319    10575    4            ELSE DO;
     1320    10576    4               CALL INSERT(TCXT,NUMSNS,9,'=',CODE09.ACCT(X9));
     1321    10577    4               CALL ADDPART(NUMSNS+9,TCXT);
     1322    10578    4               END;
     1323    10579    3            END;
     1324    10580    2         TIMEUTS=FIT14.NDW/SIZEW(CODE14.OWNER(0));
     1325    10581    3         IF TIMEUTS~=0 AND CODE14.OWNER.ACCT(0)~=' ' THEN DO;
     1326    10582    3            CALL INSERT(TCXT,0,30,', Owner=(',CODE14.OWNER.ACCT(0));
     1327    10583    3            X9=0;
     1328    10584    3            GOTO LISTO1;
     1329    10585    3   LISTO0:  CALL ADDPART(30,TCXT);
     1330    10586    3            CALL INSERT(TCXT,0,30,', ',CODE14.OWNER.ACCT(X9));
     1331    10587    3   LISTO1:  CALL ADDPART(30,TCXT);
     1332    10588    3            CALL INSERT(TCXT,0,30,'/',CODE14.OWNER.NAME(X9));
     1333    10589    3            X9=X9+1;
     1334    10590    3            IF X9<TIMEUTS THEN GOTO LISTO0;
     1335    10591    3            CALL INDEX1(X9,' ',TCXT);
     1336    10592    3            CALL INSERT(TCXT,X9,1,')');
     1337    10593    3            CALL ADDPART(30,TCXT);
     1338    10594    3            END;
     1339    10595    2         CALL ERROR(10);
     1340    10596    3         IF LIST_ATTR THEN DO X9=0 TO 4;
     1341    10597    3            LBUFC=' ';
     1342    10598    3            TIMETEXT.TYP=TIMES(X9);
     1343    10599    3            TIMEUTS=TIME$(X9)->BASED_UBIN;
     1344    10600    3            CALL M$TIME(TIME_TEXT);
     1345    10601    4            IF TIMEUTS~=0 THEN DO;
     1346    10602    5               IF X9=4 AND CODE04.CREATOR.ACCT>' ' THEN DO;
     1347    10603    5                  CALL INSERT(TIMETEXT.B,0,30,' by ',CODE04.CREATOR.ACCT);
     1348    10604    5                  CALL INDEX1(I,' ',TIMETEXT.B,4);
     1349    10605    5                  CALL INSERT(TIMETEXT.B,I,13,'/',CODE04.CREATOR.NAME);
     1350    10606    5                  END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:57   
     1351    10607    4               CALL ERROR(10);
     1352    10608    4               END;
     1353    10609    3            END;
     1354    10610    2         IF CODE=%E$DEFAULT OR MODE=0 THEN GOTO NEXT;
     1355    10611    2         IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0 THEN GOTO MADLIST;
     1356    10612    2         IF CODE~=%E$LIST+1 THEN GOTO ACCTNXT;
     1357    10613    2         CALL NXTACCT ALTRET(LISTGP);
     1358    10614    2         IF BREAK=0 THEN GOTO LISTNXT;
     1359    10615    2   LISTGP:;
     1360    10616    2         IF OUT$BLK.NSUBLKS>2 OR PROJAD.L~=0 THEN GOTO NEXT;
     1361    10617    2         BREAK=0;
     1362    10618    2         OPNDP.FPARAM_=VECTOR(NIL);
     1363    10619    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);
     1364    10620    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1365    10621    2         CALL FXH$GPSUM;
     1366    10622    2         CALL M$CLOSE(CLSDP)ALTRET(NEXT);
     1367    10623        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:58   
     1368    10624    2      CASE(%(E$DELETE-E$PIGH));
     1369    10625                    /*E*     ERROR: FXP-E$DELETE-0
     1370    10626                   *        MESSAGE:DELETE DP#set.acct - deletes one account (? not honored)
     1371    10627                    */
     1372    10628    2         IF OPNSN.SN#(0)=' ' THEN GOTO MADLIST;
     1373    10629    2         VLP_ACCT.ACCT#=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;
     1374    10630    2         CALL M$OPEN(OPNDP)ALTRET(DEL1);
     1375    10631    2         CALL MOVEFIT;
     1376    10632    2   DEL1: ;
     1377    10633    2         IF PROJAD.L~=0 THEN CALL FXU$PROJDA(VLP_ACCT)ALTRET(DPERR1);
     1378    10634    2         IF CODE14.CGRANS~=0 THEN CALL FXU$PROTCHK(CODE14.CGRANS)ALTRET(CMDABORT);
     1379    10635    2         OPNDP.V.DELETE#='1'B;
     1380    10636    2         FLAG='0'B;
     1381    10637    2         CALL M$OPEN(OPNDP)ALTRET(NOALT);
     1382    10638    2         OPNDP.V.DELETE#='0'B;
     1383    10639    2         IF NOT FLAG THEN CALL FXU$TRACKER(P_PCB);
     1384    10640    2         IF PROJAD.L~=0 AND (FLAG.CODE=0
     1385    10641    2           OR FLAG.CODE=%E$NOKEY) THEN CALL FXU$PROJWR;
     1386    10642    2         IF FLAG THEN GOTO DPERR;
     1387    10643        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:59   
     1388    10644    2      CASE(%(E$ATTR-E$PIGH));
     1389    10645                    /*E*     ERROR: FXP-E$ATTR-0
     1390    10646                    *        MESSAGE:eATtr [={ON|OFF|YES|NO}] - controls listing of dates
     1391    10647                    */
     1392    10648    2         IF OUT$BLK.NSUBLKS=0 THEN LIST_ATTR='1'B;
     1393    10649    2         ELSE IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE<3 THEN LIST_ATTR='0'B;
     1394    10650    2         ELSE LIST_ATTR='1'B;
     1395    10651        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:60   
     1396    10652    2      CASE(%(E$BUILD-E$PIGH));
     1397    10653                    /*E*     ERROR: FXP-E$BUILD-0
     1398    10654                    *        MESSAGE:Build DP#set From vsn,...,vsn options
     1399    10655                    *        Type Help OPtions for options and add:
     1400    10656                    *        [NO] Newfds - controls automatic creation of new accounts
     1401    10657                    *        [NO] SHelftime - specifies shelf time's separate accountability
     1402    10658                    */
     1403    10659    2         OPNSN.SN#(1)=OPNSN.SN#(0);
     1404    10660    2         OPNDP.FPARAM_=VECTOR(NIL);
     1405    10661    3         DO WHILE (I<OUT$BLK.NSUBLKS);
     1406    10662    4            IF OUT$BLK.SUBLK$(I)->OUT$BLK.NDTYPE=%DEC# THEN DO;
     1407    10663    4               GOTO GETVSN; /* SUBROUTINE CALL */
     1408    10664    4   GETVSNBRET: ;
     1409    10665    4               NUMSNS=NUMSNS+1;
     1410    10666    4               CALL CLOSE(DCBNUM(M$DP));
     1411    10667    4               END;
     1412    10668    4            ELSE DO WHILE (I<OUT$BLK.NSUBLKS);
     1413    10669    4               CALL GET_OPTIONS ALTRET(TOOMANY);
     1414    10670    4               I=I+1;
     1415    10671    4               END;
     1416    10672    3            I=I+1;
     1417    10673    3            END;
     1418    10674    2         OPNSN.SN#(0)=OPNSN.SN#(1);
     1419    10675    3         IF B$JIT.PRIV.ACTIVE.SPCLMM AND NUMSNS=0 THEN DO;
     1420    10676    3            I=FM$CFUX.SETH;
     1421    10677    4            DO WHILE(I~=0);
     1422    10678    4               IF FM$SET.PSN(I)=OPNSN.SN#(1)
     1423    10679    4                 AND FM$SET.DCTX(I)~=0
     1424    10680    4                 AND NOT FM$SET.SET(I)
     1425    10681    5               THEN DO;
     1426    10682    5                  J=FM$DEV.VSN(FM$SET.DCTX(I));
     1427    10683    5                  OPNSN.SN#(0)=ADDR(J)->CHAR4;
     1428    10684    5                  END;
     1429    10685    4               I=FM$SET.SETL(I);
     1430    10686    4               END;
     1431    10687    3            END;
     1432    10688    2         I=NUMSNS;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:61   
     1433    10689    2         IF NUMSNS=0 THEN GOTO CROPEN;
     1434    10690    3         DO WHILE (I~=0);
     1435    10691    3            I=I-1;
     1436    10692    3            OPNSN.SN#(0)=ADDR(VID1.SNLIST.VSN(I))->CHAR4;
     1437    10693    3   CROPEN:  ;
     1438    10694    3            OPNDP.V.FUN#=%UPDATE#;
     1439    10695    3            CALL M$OPEN(OPNDP)ALTRET(VOLERR);
     1440    10696    3            CALL M$READ(READVID)ALTRET(DPERR);
     1441    10697    4            IF NUMSNS=0 THEN DO;
     1442    10698    4               IF NOT F$DCB.OWNER THEN GOTO NOTOWNER;
     1443    10699    4               CALL FXU$PROTCHK(VIDBUF)ALTRET(DPCLOSE);
     1444    10700    4               OPNSN.SN#(1)=VIDBUF.PSN;
     1445    10701    4               VID1.SNLIST=VIDBUF.SNLIST;
     1446    10702    4               NUMSNS=VIDBUF.VOLCNT;
     1447    10703    4               I=NUMSNS;
     1448    10704    4               CLSDP.V.DISP#=%SETDSMT#;
     1449    10705    4               CALL M$CLOSE(CLSDP)ALTRET(DPERR);
     1450    10706    4               END;
     1451    10707    4            ELSE DO;
     1452    10708    4               VIDBUF.VOLCNT=NUMSNS;
     1453    10709    4               VIDBUF.SNLIST=VID1.SNLIST;
     1454    10710    4               VIDBUF.PSN=OPNSN.SN#(1);
     1455    10711    4               CALL M$WRITE(WRITEVID)ALTRET(DPERR);
     1456    10712    4               END;
     1457    10713    4            IF I=0 THEN DO;
     1458    10714    4               GRANULE=GRANULE+1;
     1459    10715    4               VIDBUF=GPBUF;
     1460    10716    4               CALL M$WRITE(WRITEGP)ALTRET(DPERR);
     1461    10717    4               FIT09.ITEMX=4+SIZEW(CODE04)+FIT14.NDW;
     1462    10718    4               PADBUF.FCEX=FIT09.ITEMX+FIT09.NDW+SIZEW(FM$GRAN);
     1463    10719    4               IF FIT09.NDW~=0 THEN CODE14.ACCESS.LIST='1'B;
     1464    10720    4               PADBUF.NAVX=PADBUF.FCEX+70;
     1465    10721    4               PADBUF.AVAIL=1024-PADBUF.NAVX;
     1466    10722    4               GRANULE=GRANULE+1;
     1467    10723    4               FITSIZE=PADBUF.FCEX*4;
     1468    10724    4               CODE04.CREATOR.NAME=B$JIT.UNAME;
     1469    10725    4               CODE04.CREATOR.ACCT=B$JIT.ACCN;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:62   
     1470    10726    4               CALL M$TIME(TIMEFPT);
     1471    10727    4               CODE04.CREATION.TIME=TIMEUTS;
     1472    10728    4               VIDBUF=ADDR(PADBUF)->FITMOVER;
     1473    10729    4               WBUF(PADBUF.FCEX)=MADBUF.K(0);
     1474    10730    4               FITSIZE=FIT09.NDW*4;
     1475    10731    4               ADDR(WBUF(FIT09.ITEMX+SIZEW(FM$GRAN)))->FITMOVER=CODE09;
     1476    10732    4               CALL M$WRITE(WRITEPAD)ALTRET(DPERR);
     1477    10733    4               VIDBUF=MADBUF;
     1478    10734    4               GRANULE=GRANULE+1;
     1479    10735    4               CALL M$WRITE(READVID)ALTRET(DPERR);
     1480    10736    4               GRANULE=0;
     1481    10737    4               END;
     1482    10738    3            CALL CLOSE(DCBNUM(M$DP));
     1483    10739    3            END;
     1484    10740    2         GOTO EXTXIT;
     1485    10741        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:63   
     1486    10742    2   GETVSN:;    /* SUBROUTINE THAT COLLECTS ONE VSN INTO SNLIST(NUMSNS) */
     1487    10743    2         CALL CHARBIN(J,OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT);
     1488    10744    2         VID1.SNLIST.VSN(NUMSNS)=BINBIT(J,36);
     1489    10745    2         IF I<OUT$BLK.NSUBLKS-1
     1490    10746    3         THEN IF OUT$BLK.SUBLK$(I+1)->OUT$BLK.NDTYPE=%PL6SYM# THEN DO;
     1491    10747    3            VID1.SNLIST.VSN.S(NUMSNS)=
     1492    10748    3              ASCBIN(OUT$BLK.SUBLK$(I+1)->OUT$SYM.TEXT)-ASCBIN('@');
     1493    10749    3            I=I+1;
     1494    10750    3            END;
     1495    10751    3         DO J=0 TO NUMSNS-1;
     1496    10752    3            IF VID1.SNLIST.VSN(J)=VID1.SNLIST.VSN(NUMSNS) THEN GOTO DUPERR;
     1497    10753    3            END;
     1498    10754                    /*E*     ERROR: FXP-E$DUPVSN-E
     1499    10755                    *        MESSAGE: Volume% %U1% is already part of set% #%SN%
     1500    10756                    */
     1501    10757    2         OPNSN.SN#(0)=ADDR(VID1.SNLIST.VSN(NUMSNS))->CHAR4;
     1502    10758    2         CALL M$OPEN(OPNDP)ALTRET(VOLERR);
     1503    10759    2         VID1.SNLIST.SIZE(NUMSNS)=F$DCB.IXTNSIZE;
     1504    10760    2         VID1.SNLIST.TYPE(NUMSNS)=F$DCB.ACCT;
     1505    10761    2         CALL M$READ(READVID)ALTRET(DPERR);
     1506    10762    2         IF VIDBUF.SECTSTRT(1)~=0 AND VIDBUF.SECTSTRT(1)<F$DCB.IXTNSIZE
     1507    10763    3           AND VID1.SNLIST.VSN.S(NUMSNS)=0 THEN DO;
     1508    10764    3            FLAG=FXP$E$NEEDSCR;
     1509    10765    3            GOTO DPERR1;
     1510    10766                    /*E*     ERROR: FXP-E$NEEDSCR-E
     1511    10767                    *        MESSAGE:Volume% %U1% must be used a section at a time.
     1512    10768                    */
     1513    10769    3            END;
     1514    10770    2         CALL FXU$PROTCHK(VIDBUF)ALTRET(DPCLOSE);
     1515    10771    2         IF CODE=%E$BUILD THEN GOTO GETVSNBRET;
     1516    10772    2         GOTO GETVSNERET;
     1517    10773        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:64   
     1518    10774    2      CASE(%(E$EXTND-E$PIGH));
     1519    10775                    /*E*     ERROR: FXP-E$EXTND-0
     1520    10776                    *        MESSAGE:EXtend DP#set With vsn,...,vsn
     1521    10777                    */
     1522    10778    2         OPNDP.V.FUN#=%UPDATE#;
     1523    10779    2         OPNDP.FPARAM_=VECTOR(NIL);
     1524    10780    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1525    10781    2         CALL M$READ(READVID)ALTRET(DPERR);
     1526    10782    2         VID1=VIDBUF;
     1527    10783    2         NUMSNS=VIDBUF.VOLCNT;
     1528    10784    2         OPNSN.SN#(1)=OPNSN.SN#(0);
     1529    10785    2         IF NOT F$DCB.OWNER AND OPNSN.SN#(0)~='SYS' THEN GOTO NOTOWNER;
     1530    10786    2         CLSDP.V.DISP#=%SETDSMT#;
     1531    10787    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);
     1532    10788    3         DO WHILE (I<OUT$BLK.NSUBLKS);
     1533    10789    3            GOTO GETVSN;
     1534    10790    3   GETVSNERET:;
     1535    10791    3            CALL CLOSE(DCBNUM(M$DP));
     1536    10792    3            NUMSNS=NUMSNS+1;
     1537    10793    3            I=I+1;
     1538    10794    3            END;
     1539    10795    2         I=NUMSNS;
     1540    10796    3         DO WHILE (I~=0);
     1541    10797    3            I=I-1;
     1542    10798    3            IF GRANULE>0 THEN OPNSN.SN#(0)=OPNSN.SN#(1);
     1543    10799    3            ELSE OPNSN.SN#(0)=ADDR(VID1.SNLIST.VSN(I))->CHAR4;
     1544    10800    4            CALL M$OPEN(OPNDP) WHENALTRETURN DO;
     1545    10801    4               IF B$ALT.ERR.CODE~=%E$XCLSET OR GRANULE>0 THEN GOTO VOLERR;
     1546    10802    4               OPNSN.SN#(0)=OPNSN.SN#(1);
     1547    10803    4               CALL M$OPEN(OPNDP) ALTRET(VOLERR);
     1548    10804    4               END;
     1549    10805    3            CALL M$READ(READVID)ALTRET(DPERR);
     1550    10806    3            VIDBUF.PSN=VID1.PSN;
     1551    10807    3            VIDBUF.SNLIST=VID1.SNLIST;
     1552    10808    3            VIDBUF.VOLCNT=NUMSNS;
     1553    10809    3            CALL M$WRITE(WRITEVID) ALTRET(DPERR);
     1554    10810    3            CALL CLOSE(DCBNUM(M$DP));
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:65   
     1555    10811    3            IF OPNSN.SN#(0)=OPNSN.SN#(1)
     1556    10812    3            THEN GRANULE=GRANULE+VID1.SNLIST.SIZE(VID1.VOLCNT-1-I);
     1557    10813    3            END;
     1558    10814    2   EXTXIT:;
     1559    10815    2         IF NOT F$DCB.OWNER THEN GOTO NEXT;
     1560    10816    2         I=F$DCB.SETX;
     1561    10817    3         IF B$JIT.PRIV.ACTIVE.SPCLMM THEN DO;
     1562    10818    3            IF FM$DEV.DCTX(I)=I THEN I=FM$DEV.SECTL(I);
     1563    10819    3            I=FM$VOL.SETX(I);
     1564    10820    3            OPNSN.SN#(0)=FM$SET.PSN(I);
     1565    10821    3            END;
     1566    10822    2         ELSE OPNSN.SN#(0)=OPNSN.SN#(1);
     1567    10823    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1568    10824    2         IF F$DCB.SETX=I AND F$DCB.OWNER THEN CALL RECONST ALTRET(DPERR1);
     1569    10825    2         CALL M$CLOSE(CLSDP)ALTRET(NEXT);
     1570    10826        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:66   
     1571    10827    2      CASE(%(E$MOUNT-E$PIGH));
     1572    10828                    /*E*     ERROR: FXP-E$MOUNT-0
     1573    10829                    *        MESSAGE:Mount DP#set [{PUblic|SHared|EXclusive}]
     1574    10830                    */
     1575    10831    2         CALL CATREAD;
     1576    10832    3         DO I=0 TO NUMPSNS;
     1577    10833    3            IF CSTAT.SETS.PSN(I)=OPNSN.SN#(0) THEN GOTO MOUNT0;
     1578    10834    3            END;
     1579    10835    2   MOUNT00:;
     1580    10836    2         NUMPSNS=NUMPSNS+1;
     1581    10837    2         CSTAT.SETS(I)='0'B;
     1582    10838    2         CSTAT.SETS.PSN(I)=OPNSN.SN#(0);
     1583    10839    2   MOUNT0: CSTAT.SETS.DISP(I)=%SETXCL#;
     1584    10840    2         IF CODE~=%E$MOUNT THEN CSTAT.SETS.DISP(I)=CSTAT.DEFMOUNT;
     1585    10841    2         ELSE IF OUT$BLK.NSUBLKS>=3 THEN CSTAT.SETS.DISP(I)=
     1586    10842    2           OUT$BLK.SUBLK$(2)->OUT$BLK.CODE;
     1587    10843    2   MOUNT1: ;
     1588    10844    2         OPNSN.SN#(0)=CSTAT.SETS.PSN(I);
     1589    10845    2         IF MODE~=0 THEN
     1590    10846    3         IF CSTAT.SETS.DISP(I)=%SETXCL# AND I~=0 THEN DO;
     1591    10847    3            CSTAT.SETS(I)=CSTAT.SETS(CSTAT.NUM);
     1592    10848    3            I=CSTAT.NUM;
     1593    10849    3            CSTAT.NUM=I-1;
     1594    10850    3            CSTAT.SETS.DISP(I)=%SETXCL#;
     1595    10851    3            END;
     1596    10852    2         IF CSTAT.SETS.SETX(I)~=2 THEN CSTAT.SETS.SETX(I)=0;
     1597    10853    2         IF MODE=0 THEN CALL CATWRITE;
     1598    10854    2         OPNDP.FPARAM_=VECTOR(NIL);
     1599    10855    2         OPNDP.V.FUN#=%UPDATE#;
     1600    10856    3         IF B$JIT.MODE=%M_BATCH# THEN DO;
     1601    10857    3            VLP_ACCT=BINBIT(-1,36);
     1602    10858    3            CALL M$OPEN(OPNXTA)ALTRET(NOALT);
     1603    10859    3            IF FLAG.CODE~=%E$ADEOF THEN GOTO DPERR;
     1604    10860    3            END;
     1605    10861    2         CALL M$OPEN(OPNDP)ALTRET(MNTERR);
     1606    10862    2         IF NOT F$DCB.OWNER AND CSTAT.SETS.DISP(I)=%SETXCL# THEN GOTO NOTOWNER;
     1607    10863    2         IF MODE=0 AND WROC.CADDR
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:67   
     1608    10864    2         THEN IF FM$SET.GACSHELF(F$DCB.SETX)
     1609    10865    2           AND CSTAT.SETS.DISP(I)~=%SETXCL# THEN GAC=1;
     1610    10866    2         FLAG='0'B;
     1611    10867    2         CALL CLOSE(DCBNUM(M$DP))ALTRET(NOALT);
     1612    10868    2         IF (FLAG.CODE=%E$PSGRANS OR GAC~=0)
     1613    10869    2           AND F$DCB.OWNER THEN CALL RECONST ALTRET(MNTRECERR);
     1614    10870    2         ELSE CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1615    10871    2         CLSDP.V.DISP#=CSTAT.SETS.DISP(I);
     1616    10872    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);
     1617    10873    2         CSTAT.SETS.SETX(I)=1;
     1618    10874    2         IF MODE=0 THEN CALL CATWRITE;
     1619    10875    2         IF CLSDP.V.DISP#~=%SETXCL# AND MODE=0 THEN CALL UNDEFER;
     1620    10876    2         IF CODE=0 THEN GOTO DISP0;
     1621    10877    2         X9=F$DCB.SETX;
     1622    10878    2         CODE=0;
     1623    10879    2         GOTO DISPS0;
     1624    10880                    /**/
     1625    10881    2   MNTERR:;
     1626    10882    2         IF CODE=0 THEN GOTO DISP0;
     1627    10883    2         GOTO DPERR;
     1628    10884    2   MNTRECERR:;
     1629    10885    2         IF FLAG=FXP$E$2RECON THEN GOTO DISP0;
     1630    10886    2         GOTO DPERR1;
     1631    10887        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:68   
     1632    10888    2      CASE(%(E$DISMOUNT-E$PIGH));
     1633    10889                    /*E*     ERROR: FXP-E$DISMOUNT-0
     1634    10890                    *        MESSAGE:DISMount DP#set [{Fast|Now}]
     1635    10891                    */
     1636    10892    2         OPNDP.FPARAM_=VECTOR(NIL);
     1637    10893    3         IF MODE=0 THEN DO;
     1638    10894    3            CALL CATREAD;
     1639    10895    4            DO I=1 TO NUMPSNS;
     1640    10896    5               IF CSTAT.SETS.PSN(I)=OPNSN.SN#(0) THEN DO;
     1641    10897    5                  CSTAT.SETS(I)=CSTAT.SETS(NUMPSNS);
     1642    10898    5                  NUMPSNS=NUMPSNS-1;
     1643    10899    5                  CALL CATWRITE;
     1644    10900    5                  END;
     1645    10901    4               END;
     1646    10902    3            END;
     1647    10903    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1648    10904    2         CLSDP.V.DISP#=%SETDSMT#;
     1649    10905    2         IF OUT$BLK.NSUBLKS>2 THEN CLSDP.V.DISP#=
     1650    10906    2           OUT$BLK.SUBLK$(2)->OUT$BLK.CODE;
     1651    10907    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);
     1652    10908    2         CODE=0;
     1653    10909    2         X9=F$DCB.SETX;
     1654    10910    3         IF MODE=0 THEN DO;
     1655    10911    3            CALL M$WAIT(WAIT1);
     1656    10912    3            GOTO DISPS0;
     1657    10913    3            END;
     1658    10914        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:69   
     1659    10915    2      CASE(%(E$DEFAULT-E$PIGH));
     1660    10916                    /*E*     ERROR: FXP-E$DEFAULT-0
     1661    10917                    *        MESSAGE:DEFault Build options - sets options for Build command
     1662    10918                  *        DEFault DP#set [options] - modifies/lists PADFIT, type Help Build
     1663    10919                  *        DEFault Mount [{NONE|PUbl|SHared}] - default for uncataloged sets
     1664    10920                    */
     1665    10921    2         SELACCT=' ';
     1666    10922    2         X9=OUT$BLK.SUBLK$(1)->OUT$BLK.CODE;
     1667    10923    3         IF X9=%E$PSN THEN DO;
     1668    10924    3            CALL M$OPEN(OPNDP)ALTRET(NOALT);
     1669    10925    3            IF OUT$BLK.NSUBLKS=2 THEN GOTO LISTNXT0;
     1670    10926    3            GOTO OPNACCT;
     1671    10927    3            END;
     1672    10928    3         ELSE IF X9=%E$MOUNT THEN DO;
     1673    10929    3            I=0;
     1674    10930    3            CALL CATREAD;
     1675    10931    4            IF OUT$BLK.NSUBLKS>=3 THEN DO;
     1676    10932    4               CSTAT.DEFMOUNT=OUT$BLK.SUBLK$(2)->OUT$BLK.CODE;
     1677    10933    4               IF CSTAT.DEFMOUNT>10 THEN CSTAT.DEFMOUNT=0;
     1678    10934    4               CALL CATWRITE;
     1679    10935    4               END;
     1680    10936    4            ELSE DO CASE(CSTAT.DEFMOUNT);
     1681    10937    4            CASE(0);
     1682    10938    4               CALL ADDPART(4,'NONE');
     1683    10939    4            CASE(%SETXCL#);
     1684    10940    4               CALL ADDPART(9,'EXCLUSIVE');
     1685    10941    4            CASE(%SETPRIV#);
     1686    10942    4               CALL ADDPART(6,'SHARED');
     1687    10943    4            CASE(%SETPUB#);
     1688    10944    4               CALL ADDPART(6,'PUBLIC');
     1689    10945    4            END;
     1690    10946    3            IF I~=0 THEN CALL ERROR(10);
     1691    10947    3            END;
     1692    10948    3         ELSE DO;
     1693    10949    3            X9=0;
     1694    10950    4            DO WHILE (I<OUT$BLK.NSUBLKS);
     1695    10951    4               CALL GET_OPTIONS ALTRET(TOOMANY);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:70   
     1696    10952    4               I=I+1;
     1697    10953    4               END;
     1698    10954    3            CODE14.ACCESS.LIST=(FIT09.NDW~=0);
     1699    10955    3            FITSIZE=SIZEC(DEFAULT_BUILD);
     1700    10956    3            DEFAULT_BUILD=ADDR(PADBUF)->FITMOVER;
     1701    10957    3            GOTO LISTNXT1;
     1702    10958    3            END;
     1703    10959        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:71   
     1704    10960    2      CASE(%(E$RECON-E$PIGH),%(E$ACCOUNT-E$PIGH));
     1705    10961    2         IF CODE=%E$ACCOUNT THEN GAC=-1;
     1706    10962                    /*E*     ERROR: FXP-E$RECON-0
     1707    10963                    *        MESSAGE:REConstruct DP#set - rebuild free-space list
     1708    10964                    */
     1709    10965                    /*E*     ERROR: FXP-E$ACCOUNT-0
     1710    10966                    *        MESSAGE:ACcount DP#set - reconstruct with granule accounting
     1711    10967                    */
     1712    10968    2         OPNDP.FPARAM_=VECTOR(NIL);
     1713    10969    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);
     1714    10970    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1715    10971    2         IF NOT F$DCB.OWNER OR DIAGFPT.V.PRIV# THEN CALL ERROR(0);
     1716    10972    3         ELSE DO;
     1717    10973    3            CALL CLOSE(DCBNUM(M$DP));
     1718    10974    3            OPNDP.V.FUN#=%UPDATE#;
     1719    10975    3            CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1720    10976    3            END;
     1721    10977    2         CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);
     1722    10978    2         CALL RECONST ALTRET(DPERR1);
     1723    10979    2         CALL M$CLOSE(CLSDP)ALTRET(NEXT);
     1724    10980        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:72   
     1725    10981    2      CASE(%(E$COUNT-E$PIGH));
     1726    10982                    /*E*     ERROR: FXP-E$COUNT-0
     1727    10983                    *        MESSAGE:COunt DP#set - displays directory info
     1728    10984                    */
     1729    10985    2         OPNDP.FPARAM_=VECTOR(NIL);
     1730    10986    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);
     1731    10987    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1732    10988    2         CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);
     1733    10989    2         CALL FXH$COUNT;
     1734    10990    2         IF ERRCODE~='0'B THEN CALL RECONERE ALTRET(DPERR1);
     1735    10991    2         CALL M$CLOSE(CLSDP)ALTRET(NEXT);
     1736    10992        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:73   
     1737    10993    2      CASE(%(E$MADLIST-E$PIGH));
     1738    10994                    /*E*     ERROR: FXP-E$MADLIST-0
     1739    10995                    *        MESSAGE:MADList {DP#set|.acct} - lists MAD entries
     1740    10996                    */
     1741    10997    2   MADLIST:;
     1742    10998    3         IF PROJAD.L~=0 AND PROJAD.PSN=' ' THEN DO;
     1743    10999    3            FLAG=FXP$E$PROJPSN;
     1744    11000    3            GOTO DPERR1;
     1745    11001                    /*E*      ERROR: FXP-E$PROJPSN
     1746    11002                    *         MESSAGE:For a multi-set project, a setname is needed.
     1747    11003                    */
     1748    11004    3            END;
     1749    11005    2         IF B$JIT.PPRIV.PIGD THEN CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);
     1750    11006    2         I=0;
     1751    11007    3         DO WHILE('1'B);
     1752    11008    3            OPNSN.SN#(0)=' ';
     1753    11009    4            IF OUT$BLK.NSUBLKS~=0 THEN DO;
     1754    11010    4               IF OUT$BLK.SUBLK$(1)->OUT$SYM.CODE~=0
     1755    11011    4               THEN OPNSN.SN#(0)=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
     1756    11012    4               ELSE IF SELACCT='?' THEN SELACCT=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
     1757    11013    4               END;
     1758    11014    3            CALL NXTACCT ALTRET(MADLX);
     1759    11015    3            IF BREAK~=0 THEN GOTO MADLX;
     1760    11016    3            FLAG='0'B;
     1761    11017    4            IF OPNSN.SN#(0)~=' ' OR F$DCB.PSN=' 'THEN DO;
     1762    11018    4               OPNSN.SN#(0)=' ';
     1763    11019    4               MADM.V.READ#='1'B;
     1764    11020    4               CALL M$MADMUCK(MADM)ALTRET(NOALT);
     1765    11021    4               END;
     1766    11022    3            ELSE IF PROJAD.L=0 THEN OPNSN.SN#(0)=F$DCB.PSN;
     1767    11023    3            ELSE OPNSN.SN#(0)=PROJAD.PSN;
     1768    11024    3            IF CODE~=%E$MADLIST THEN IF FLAG THEN GOTO MADD1;
     1769    11025    3            ELSE IF CODE=%E$MODIFY THEN GOTO ACCTNXT;
     1770    11026    3            ELSE GOTO LISTNXTM;
     1771    11027    4            IF SELACCT=' ' THEN DO;
     1772    11028    4               IF FLAG THEN GOTO MADD1;
     1773    11029    4               CALL ADDPART(8,VLP_ACCT.ACCT#);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:74   
     1774    11030    4               CALL ADDPARAM(%M#PSN);
     1775    11031    4               CALL ADDPART(6,OPNSN.SN#(0));
     1776    11032    4               GOTO MADLX;
     1777    11033    4               END;
     1778    11034    4            ELSE DO;
     1779    11035    5               IF I+15>=WIDTH THEN DO;
     1780    11036    5                  CALL ERROR(10);
     1781    11037    5                  I=0;
     1782    11038    5                  END;
     1783    11039    4               CALL INSERT(LBUFC,I,,'#',OPNSN.SN#(0),'.',VLP_ACCT.ACCT#);
     1784    11040    4               I=I+17;
     1785    11041    4               END;
     1786    11042    3            END;
     1787    11043    2   MADLX: IF (CODE<%E$MODIFY OR CODE>%E$LIST+1 OR LBUFC=NONEMSG)
     1788    11044                    /* Nothing to say if MODIFY found something,
     1789    11045                       or break hit before anything happened. */
     1790    11046    2           AND (I~=0 OR BREAK=0)
     1791    11047    2         THEN CALL ERROR(10);
     1792    11048    2         IF BREAK~=0 THEN GOTO CMDABORT;
     1793    11049        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:75   
     1794    11050    2      CASE(%(E$MADADD-E$PIGH));
     1795    11051                    /*E*     ERROR: FXP-E$MADADD-0
     1796    11052                    *        MESSAGE:MADAdd DP#set [.acct] - add MAD entries
     1797    11053                    */
     1798    11054    2         MADM.V.WRITE#='1'B;
     1799    11055    2         GOTO MADDA;
     1800    11056    2      CASE(%(E$MADDEL-E$PIGH));
     1801    11057                    /*E*     ERROR: FXP-E$MADDEL-0
     1802    11058                    *        MESSAGE:MADDelete {DP#set [.acct]|.acct} - delete MAD entries
     1803    11059                    */
     1804    11060    2         MADM.V.DELETE#='1'B;
     1805    11061    2         OPNSN.SN#(0)=' ';
     1806    11062    2   MADDA:;
     1807    11063    2         I=0;
     1808    11064    2         IF OUT$BLK.NSUBLKS>=3 THEN SELACCT=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;
     1809    11065    2         CODE=OUT$BLK.SUBLK$(1)->OUT$SYM.CODE;
     1810    11066    2         IF CODE=0 THEN SELACCT=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
     1811    11067    3         IF MADM.V.DELETE# AND CODE=0 AND SELACCT='?' THEN DO;/*THE WHOLE THING*/
     1812    11068    3            CALL FXU$PROTCHK(0) ALTRET(CMDABORT);
     1813    11069    3            GRANULE=3;
     1814    11070    3            OPNSN.SN#(0)='SYS';
     1815    11071    3            OPNDP.V.FUN#=%UPDATE#;
     1816    11072    3            CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1817    11073    3            VIDBUF=MADBUF;
     1818    11074    3            CALL M$WRITE(READVID)ALTRET(DPERR);
     1819    11075    3            CALL CLOSE(DCBNUM(M$DP));
     1820    11076    3            GOTO NEXT;
     1821    11077    3            END;
     1822    11078    3         DO WHILE('1'B);
     1823    11079    3            CALL NXTACCT ALTRET(MADLX);
     1824    11080    3            IF BREAK~=0 THEN GOTO MADLX;
     1825    11081    3            IF SELACCT=' ' AND CODE~=0
     1826    11082    3            THEN IF F$DCB.ACCT~=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT THEN GOTO MADLX;
     1827    11083    4            IF CODE=0 OR F$DCB.PSN=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT THEN DO;
     1828    11084    4               CALL M$MADMUCK(MADM)ALTRET(MADD1);
     1829    11085    4               IF SELACCT=' ' THEN GOTO NEXT;
     1830    11086    5               IF I+7>=WIDTH THEN DO;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:76   
     1831    11087    5                  CALL ERROR(10);
     1832    11088    5                  I=0;
     1833    11089    5                  END;
     1834    11090    4               CALL INSERT(LBUFC,I,,VLP_ACCT.ACCT#);
     1835    11091    4               I=I+9;
     1836    11092    4               END;
     1837    11093    3            END;
     1838    11094    2   MADD1:;
     1839    11095    2         FLAG=B$ALT.ERR;
     1840    11096    2         IF FLAG.CODE=%E$NOKEY THEN GOTO MADLX;
     1841    11097    2         FLAG.SEV=7;
     1842    11098    2         IF I~=0 THEN CALL ERROR(10);
     1843    11099    2         GOTO DPERR1;
     1844    11100        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:77   
     1845    11101    2      CASE(%(E$CATALOG-E$PIGH),%(E$CATDEL-E$PIGH),%(E$CATMOD-E$PIGH));
     1846    11102    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);
     1847    11103    2         CALL FXU$CATADM(CODE)ALTRET(CATERR);
     1848    11104    2      CASE(%(E$CATLIST-E$PIGH));
     1849    11105    2         IF B$JIT.PPRIV.PIGD THEN CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);
     1850    11106    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);
     1851    11107    2         I=0;
     1852    11108    2         I0=0;
     1853    11109    2         CALL FXU$CATL ALTRET(CATERR);
     1854    11110    2         CALL ERROR(10);
     1855    11111    2         GOTO NEXT;
     1856    11112    2   CATERR: FLAG=ERRCODE;
     1857    11113    2         FLAG.SEV=7;
     1858    11114    2         EFPT.V.DCB#=DCBNUM(M$CAT);
     1859    11115    2         GOTO DPERR1;
     1860    11116        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:78   
     1861    11117    2      CASE(%(E$FIX-E$PIGH));
     1862    11118                    /*E*     ERROR: FXP-E$FIX-0
     1863    11119                    *        MESSAGE:FIX is not yet implemented.
     1864    11120                    */
     1865    11121    2         VLP_ACCT.ACCT#=' ';
     1866    11122    2         OPNDP.FPARAM_=VECTOR(NIL);
     1867    11123    3         IF NOT B$JIT.PRIV.AUTH.FMDIAG THEN DO;
     1868    11124    3            FLAG=FMN$E$NOTAUTH;
     1869    11125    3            GOTO DPERR1;
     1870    11126    3            END;
     1871    11127    3         IF OPNSN.SN#(0)=' ' THEN DO;
     1872    11128    3            IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE~=0
     1873    11129    3            THEN CALL CONCAT(OPNSN.SN#(0),BINASC(4),'DP',
     1874    11130    3              OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT);
     1875    11131    4            ELSE DO;
     1876    11132    4               CALL CHARBIN(ADDR(OPNSN.SN#(0))->BASED_UBIN,
     1877    11133    4                 OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);
     1878    11134    4               IF OUT$BLK.NSUBLKS=3 THEN CALL INSERT(OPNSN.SN#(0),0,1,
     1879    11135    4                 BINASC(ASCBIN(OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT)-ASCBIN('@')));
     1880    11136    4               END;
     1881    11137    3            CODE=4; /* ALWAYS VID */
     1882    11138    3            END;
     1883    11139    3         ELSE DO WHILE(I<OUT$BLK.NSUBLKS);
     1884    11140    4            IF OUT$BLK.SUBLK$(I)->OUT$BLK.CODE=%E$FIX THEN DO;
     1885    11141    4               VLP_NAME.L#=OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
     1886    11142    4               VLP_NAME.NAME#=OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1887    11143    4               END;
     1888    11144    3            ELSE CODE=OUT$BLK.SUBLK$(I)->OUT$BLK.CODE;
     1889    11145    3            IF OUT$BLK.SUBLK$(I)->OUT$BLK.CODE=0
     1890    11146    3            THEN VLP_ACCT.ACCT#=OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT;
     1891    11147    3            I=I+1;
     1892    11148    3            END;
     1893    11149    3         IF B$JIT.PRIV.JOB.FMDIAG THEN DO;
     1894    11150    3            OPNFIL.V.FUN#=%UPDATE#;
     1895    11151    3            OPNDP.V.FUN#=%UPDATE#;
     1896    11152    3            CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);
     1897    11153    3            END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:79   
     1898    11154    2         ELSE OPNFIL.V.FUN#=%IN#;
     1899    11155    3         DO CASE(CODE);
     1900    11156    3         CASE(1,2,3,4);
     1901    11157    3            CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1902    11158    3            IF CODE=4 THEN CODE=0;
     1903    11159    3         CASE(ELSE);
     1904    11160    3            FLAG='0'B;
     1905    11161    3            CALL M$OPEN(OPNFIL)ALTRET(NOALT);
     1906    11162    3            IF FLAG AND VLP_NAME THEN GOTO DPERR;
     1907    11163    3            IF NOT FLAG THEN CODE=0;
     1908    11164    4            ELSE DO;
     1909    11165    4               CODE=F$DCB.BFR.DA(1);
     1910    11166    4               CALL M$OPEN(OPNDP)ALTRET(DPERR);
     1911    11167    4               END;
     1912    11168    3         END;
     1913    11169    2         ERRCODE='0'B;
     1914    11170    2         CALL FXF$FIX(CODE);
     1915    11171    2         CLSDP.V.DISP#=0;
     1916    11172    2         CALL M$CLOSE(CLSDP)ALTRET(NOALT);
     1917    11173    2         CALL SET_PRIV;
     1918    11174    2         IF ERRCODE OR BREAK~=0 THEN CALL RECONERE ALTRET(DPERR1);
     1919    11175        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:80   
     1920    11176    2      CASE(%(E$MAKEME-E$PIGH));
     1921    11177    2         PROJAD.L=0;
     1922    11178    2         FLAG='0'B;
     1923    11179    2         CALL M$RPRIV(PPRIVFPT);
     1924    11180    3         IF OUT$BLK.NSUBLKS~=0 THEN DO;
     1925    11181    3            PROJAD.ACCT=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
     1926    11182    3            PROJAD.NAME=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;
     1927    11183    3            CALL FXU$PROJAD;
     1928    11184    3            END;
     1929    11185    2         IF PROJAD.L=0 THEN CALL SET_PRIV;
     1930    11186    2         IF FLAG THEN GOTO DPERR1;
     1931    11187    3         IF PROJAD.L~=0 THEN DO;
     1932    11188    3            IF PROJAD.L<20 THEN ERRSYN.T='No Packset';
     1933    11189    3            ELSE CALL CONCAT(ERRSYN.T,'Set #',PROJAD.PSN);
     1934    11190    3            CALL CONCAT(LBUFC,'Project Administrator Mode - ',ERRSYN.T);
     1935    11191    3            CALL ERROR(10);
     1936    11192    3            END;
     1937    11193           %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:81   
     1938    11194    2      CASE(%(E$HCMD-E$PIGH));
     1939    11195    2         FLAG='0'B;
     1940    11196    2         XUH.HELP$=ADDR(OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT);
     1941    11197    2         I=OUT$BLK.SUBLK$(1)->OUT$SYM.CPOS;
     1942    11198    2         CALL X$HELP(XUH)ALTRET(HELP_ERR);
     1943    11199    2         GOTO NEXT;
     1944    11200    2   HELP_ERR:;
     1945    11201    2         FLAG=XUH.ERR;
     1946    11202    2         P_PCB.ERROR=FLAG;
     1947    11203    2         EFPT.V.DCB#=XUH.ERR_DCB#;
     1948    11204    2         FLAG.SEV=7;
     1949    11205    2         IF FLAG.CODE~=%E$SYNERR THEN GOTO DPERR1;
     1950    11206    2         P_PCB.HI_CHAR=XUH.CHARPOS+I;
     1951    11207    2         GOTO PARSERR;
     1952    11208    2      CASE(%(E$QSTNMRK-E$PIGH));
     1953    11209    3         IF FLAG THEN DO;
     1954    11210                    /*E*     ERROR: FXP-E$PIGH-0
     1955    11211                    *        MESSAGE:Type Help command - commands are ACcount, ATtr, Build,
     1956    11212                    *        CATalog, CATDelete, CATList, CATModify, COunt, CReate, DEFault,
     1957    11213                   *        DELETE, DISMount, Display, End, eXit, EXtend, FIX, List, MADAdd,
     1958    11214              *        MADDelete, MADList, Modify, Mount, Quit, REConstruct, AND SCRatch.
     1959    11215              *        Abbreviation is indicated by upper case. DP#set may be spelled
     1960    11216              *        without DP.  A vsn is a volume serial number, up to 8 decimal
     1961    11217              *        digits, optionally followed by a single upper-case letter to
     1962    11218              *        designate which section of a partitioned volume to use (see the
     1963    11219              *        SCRatch cmd). Most references to acct may contain any number of ?'s
     1964    11220              *        and be followed by >, as in PCL.
     1965    11221              */
     1966    11222    3            TCXT=BINASC(0);
     1967    11223    3            IF FLAG.FCG='0630'O AND FLAG.CODE>=%E$PIGH
     1968    11224    3            THEN EFPT.V.INCLCODE#='0'B;
     1969    11225    3            EFPT.V.OUTDCB1#=DCBNUM(M$DO);
     1970    11226    3            FLAG.SEV=FLAG.SEV+1;
     1971    11227    3            CALL M$ERRMSG(EFPT)ALTRET(HELP1);
     1972    11228    3            FLAG=EVLR.CODEUSED;
     1973    11229    3   HELP1:   EFPT.V.OUTDCB1#=0;
     1974    11230    3            EFPT.V.INCLCODE#='1'B;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:82   
     1975    11231    3            END;
     1976    11232    3         ELSE IF XUH.ERR='0'B THEN DO;
     1977    11233    3            IF TCXT='??' THEN XUH.ALL#='1'B;
     1978    11234    3            XUH.MORE#='1'B;
     1979    11235    3            CALL X$HELP(XUH) ALTRET(HELP_ERR);
     1980    11236    3            END;
     1981    11237    2      END;
     1982    11238    1      GOTO NEXT;
     1983    11239        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:83   
     1984    11240    1   FXP$RVID: ENTRY(PARM)ALTRET;
     1985    11241    1      IF PARM.U~=0 THEN OPNSN.SN#(0)=ADDR(PARM)->CHAR4;
     1986    11242    1      ELSE OPNSN.SN#(0)=PARM.P$->OUT$SYM.TEXT;
     1987    11243    1      CALL M$OPEN(OPNDP)ALTRET(RVIDALT);
     1988    11244    1      CALL M$READ(READVID)ALTRET(RVIDALT);
     1989    11245    2      CALL M$CLOSE(CLSDP) WHENALTRETURN DO;
     1990    11246    2         CALL CLOSE(DCBNUM(M$DP));
     1991    11247    2         END;
     1992    11248    1      RETURN;
     1993    11249    2   RVIDALT: CALL M$CLOSE(CLSDP) WHENALTRETURN DO;
     1994    11250    2         CALL CLOSE(DCBNUM(M$DP));
     1995    11251    2         END;
     1996    11252    1      ALTRETURN;
     1997    11253        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:84   
     1998    11254    1   FXP$PRINT: ENTRY(PARM) ALTRET;
     1999    11255    1      IF ADDR(PARM)=ADDR(NIL) THEN CALL ERROR(10);
     2000    11256    1      ELSE CALL ERROR(PARM.U);
     2001    11257    1      LBUFC=' ';
     2002    11258    1      I=I0;
     2003    11259    1      RETURN;
     2004    11260    1   FXP$PART: ENTRY(PARM) ALTRET;
     2005    11261    1      CALL ADDPART(PARM.U,PARM.P$->BASED_UBIN);
     2006    11262    1      RETURN;
     2007    11263    1   FXP$PARM: ENTRY(PARM) ALTRET;
     2008    11264    1      CALL ADDPARAM(PARM.U);
     2009    11265    1      RETURN;
     2010    11266    1   FXP$PARN: ENTRY(PARM) ALTRET;
     2011    11267    1      ADDR(J)->BASED_UBIN=ADDR(PARM.P$)->BASED_UBIN;
     2012    11268    1      CALL ADDPARNUM(PARM.U);
     2013    11269    1      RETURN;
     2014    11270        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:85   
     2015    11271                    /*F*      NAME: FXP$PROJAT
     2016    11272              *         PURPOSE: Merge the PROJECT attributes into the packset attributes.
     2017    11273              The parameter is the parse PCB.
     2018    11274              */
     2019    11275    1   FXP$PROJAT: ENTRY(PARM) ALTRET;
     2020    11276    1      BLK$=ADDR(PARM)->P$PCB.OUT$;
     2021    11277    1      ADDR(PARM)->P$PCB.OUT$=P_PCB.TEXT$; /* OPTIONS NEEDS TEXT$ */
     2022    11278    2      IF ADDR(PARM)->P$PCB.ERROR THEN DO;
     2023    11279    2   ERRPCB: FLAG=FXP$E$PROJDFT;
     2024    11280                    /*E*      ERROR: FXP-E$PROJDFT
     2025    11281                    *         MESSAGE:Error In Project Default Attributes.
     2026    11282                    */
     2027    11283    2   ERRRET: P_PCB.TEXT$=ADDR(PARM)->P$PCB.OUT$;
     2028    11284    2         ALTRETURN;
     2029    11285    2         END;
     2030    11286    1      OPNSN.SN#(0)=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
     2031    11287    1      PRIVFPT.V.PRIV#=%PR_FMDIAG#;
     2032    11288    1      CALL M$SPRIV(PRIVFPT);
     2033    11289    1      OPNDP.FPARAM_=BITVECT(READVID.BUF_);
     2034    11290    1      OPNDP.IFPARAM_=VECTOR(NIL);
     2035    11291    1      VLP_ACCT.ACCT#=BINASC(0);
     2036    11292    1      CALL M$OPEN(OPNDP)ALTRET(ERRALT);
     2037    11293    1      CALL MOVEFIT;
     2038    11294    1      I=3;
     2039    11295    1      X9=0;
     2040    11296    1      P_PCB.TEXT$=ADDR(PARM)->P$PCB.TEXT$;
     2041    11297    2      DO WHILE(I<OUT$BLK.NSUBLKS);
     2042    11298    2         CALL GET_OPTIONS ALTRET(ERRPCB);
     2043    11299    2         I=I+1;
     2044    11300    2         END;
     2045    11301    1      P_PCB.TEXT$=ADDR(PARM)->P$PCB.OUT$;
     2046    11302    1      FLAG='0'B;
     2047    11303    1      CODE14.ACCESS.LIST=(FIT09.NDW~=0);
     2048    11304    1      FITSIZE=SIZEC(DEFAULT_BUILD);
     2049    11305    1      CSTAT=ADDR(FIT00)->FITMOVER;
     2050    11306    1      RETURN;
     2051    11307    1   ERRALT: FLAG=B$ALT.ERR;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:86   
     2052    11308    1      FLAG.SEV=7;
     2053    11309    1      GOTO ERRRET;
     2054    11310        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:87   
     2055    11311        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:88   
     2056    11312    1   PARSERR: I=P_PCB.ERROR.CODE;
     2057    11313    2      IF I=%E$SMALLWORK OR I=%E$WKOVERFLOW THEN DO;
     2058    11314    2         CALL M$GDS(WORKFPT) ALTRET(NOCORE);
     2059    11315    2         GOTO NEWPARSE;
     2060    11316    2         END;
     2061    11317    1      P_PCB.ERROR.CODE=1;
     2062    11318    1   VALERR:;
     2063    11319    1      IF P_PCB.HI_CHAR<9 OR P_PCB.NCHARS<17 THEN I=0;
     2064    11320    1      ELSE I=P_PCB.HI_CHAR-9;
     2065    11321    1      CALL CONCAT(ERRSYN.T,SUBSTR(P_PCB.TEXT$->CHAR4,I,P_PCB.HI_CHAR-I),
     2066    11322    1        ' at ',SUBSTR(P_PCB.TEXT$->CHAR4,P_PCB.HI_CHAR,P_PCB.NCHARS-P_PCB.HI_CHAR));
     2067    11323    1      IF P_PCB.HI_CHAR=0 THEN I=6;
     2068    11324    1      ELSE I=P_PCB.ERROR.CODE;
     2069    11325    1      VALMSG.T=ERRSYN.T;
     2070    11326    1      CALL ERROR(I);
     2071    11327    1      IF I=1
     2072    11328    1      THEN IF SUBSTR(P_PCB.TEXT$->CHAR4,P_PCB.HI_CHAR,P_PCB.NCHARS-P_PCB.HI_CHAR)=
     2073    11329    1        '?' THEN GOTO MENU;
     2074    11330    1      ELSE P_PCB.NCHARS=P_PCB.NCHARS+1;
     2075    11331    1      GOTO NEXT;
     2076    11332        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:89   
     2077    11333    1   ERROR: PROC(I)ALTRET;
     2078    11334    2   DCL I SBIN;
     2079    11335    2   DCL AX UBIN;
     2080    11336    2   DCL WILD_XC REDEF AX CHAR(4);
     2081    11337    2   DCL AXP UBIN;
     2082    11338    2   DCL AXP$ REDEF AXP PTR;
     2083    11339    2   DCL BX UBIN;
     2084    11340    2   DCL BXB REDEF BX BIT(36);
     2085    11341    2   DCL BXP UBIN;
     2086    11342    2   DCL CHARS CHAR(120)BASED;
     2087    11343    2      CORR.V.DCB2#=DCBNUM(M$SI);
     2088    11344    2      IF M$SI$->F$DCB.DDEV.IC THEN CALL M$CORRES(CORR)ALTRET(NO_EKO);
     2089    11345    2      CORR.V.DCB2#=DCBNUM(M$LO);
     2090    11346    2      CALL M$CORRES(CORR)ALTRET(NO_EKO);
     2091    11347    3      DO CASE(I);
     2092    11348    3      CASE(1,2,5,6,7); /*ERROR MESSAGES*/
     2093    11349    3         LOFPT.BUF_=ERRVEC(4);
     2094    11350    3         LOFPT.V.DCB#=DCBNUM(M$DO);
     2095    11351    3         IF TCXT~=' ' AND P_PCB.NCHARS~=0
     2096    11352    3         THEN TCXT=SUBSTR(P_PCB.TEXT$->CHARS,0,P_PCB.NCHARS);
     2097    11353    4         DO WHILE(SUBSTR(TCXT,LOFPT.BUF_.BOUND,1)=' ');
     2098    11354    4            LOFPT.BUF_.BOUND=LOFPT.BUF_.BOUND-1;
     2099    11355    4            END;
     2100    11356    3         IF TCXT~=' ' THEN CALL M$WRITE(LOFPT);
     2101    11357    3         TCXT=' ';
     2102    11358    3      END;
     2103    11359    2   NO_EKO:;
     2104    11360    2      LOFPT.BUF_=ERRVEC(I);
     2105    11361    3      DO WHILE (SUBSTR(LOFPT.BUF_.BUF$->CHARS,LOFPT.BUF_.BOUND,1)=' '
     2106    11362    3        AND LOFPT.BUF_.BOUND>0);
     2107    11363    3         LOFPT.BUF_.BOUND=LOFPT.BUF_.BOUND-1;
     2108    11364    3         END;
     2109    11365    2      LOFPT.V.DCB#=DCBNUM(M$LO);
     2110    11366    3      CALL M$WRITE(LOFPT) WHENALTRETURN DO;
     2111    11367    3         IF MODE~=0 THEN CALL M$MERC;
     2112    11368    3         END;
     2113    11369    2      IF MODE~=0 THEN WIDTH=M$LO$->F$DCB.WIDTH;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:90   
     2114    11370    2      IF WIDTH>=109 OR WIDTH=0 THEN WIDTH=108;
     2115    11371    3      IF MODE~=0 THEN DO CASE(I);
     2116    11372    3      CASE(ELSE);
     2117    11373    3         RETURN;
     2118    11374    3      CASE(1,2,5,6,7); /*ERROR MESSAGES*/
     2119    11375    3         BANNERSZ=0; /* SET STEPCC FLAG */
     2120    11376    3         CORR.V.DCB2#=DCBNUM(M$LO);
     2121    11377    3         CALL M$CORRES(CORR)ALTRET(NO_DO);
     2122    11378    3         LOFPT.V.DCB#=DCBNUM(M$DO);
     2123    11379    3         CALL M$WRITE(LOFPT);
     2124    11380    3   NO_DO:;
     2125    11381    3         RETURN;
     2126    11382    3      END;
     2127    11383    3      IF BLK$~=WORK_.FIRST$ THEN DO;
     2128    11384    3         BLK$=PINCRW(WORK_.FIRST$,20);
     2129    11385    3         IF P_TO_S.COUNT>4000 THEN P_TO_S.COUNT=0;
     2130    11386    3         AX=LOFPT.BUF_.BOUND+1;
     2131    11387    3         CALL CONCAT(ADDR(P_TO_S.TEXT(P_TO_S.COUNT))->CHARS,BINASC(AX),
     2132    11388    3           SUBSTR(LOFPT.BUF_.BUF$->CHARS,0,AX));
     2133    11389    3         P_TO_S.COUNT=P_TO_S.COUNT+AX+1;
     2134    11390    3         IF I<8 THEN IF FLAG THEN P_TO_S.ERR=BITBIN(FLAG);
     2135    11391    3         ELSE P_TO_S.ERR=I;
     2136    11392    3         ELSE P_TO_S.ERR=0;
     2137    11393    3         RETURN;
     2138    11394    3         END;
     2139    11395    3      IF I=2 THEN DO;
     2140    11396    3         IF WROC.CADDR='0'B THEN WROC.CADDR=M_DISK;
     2141    11397    3         WROC.N=CODE;
     2142    11398    3         WROC.PSN=OPNSN.SN#(0);
     2143    11399    3         END;
     2144    11400    2      ELSE IF I~=10 THEN WROC.CADDR='0'B;
     2145    11401    3      IF WROC.CADDR THEN DO;
     2146    11402    4         IF WROC.MSG#=PKSET_MSG# THEN DO;
     2147    11403    4            LBUFC=SUBSTR(LBUFC,GRANULE);
     2148    11404    4            GRANULE=I0;
     2149    11405    4            WIDTH=I0+50;
     2150    11406    4            END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:91   
     2151    11407    3         CALL M$WRITE(OCMSG);
     2152    11408    3         END;
     2153    11409    3      IF ZAP THEN DO;
     2154    11410    3         X9=FM$CFUX.SETH;
     2155    11411    4         DO WHILE(X9~=0);
     2156    11412    4            IF FM$SET.SET(X9) AND FM$SET.PSN(X9)~='SYS' THEN RETURN;
     2157    11413    4            X9=FM$SET.SETL(X9);
     2158    11414    4            END;
     2159    11415    3         WROC.MSG#=PREZAP_MSG#;
     2160    11416    3         WROC.CADDR=M_DISK;
     2161    11417    3         CALL M$WRITE(OCMSG);
     2162    11418    3         END;
     2163    11419    2      RETURN;
     2164    11420        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:92   
     2165    11421    2   CATREAD: ENTRY ALTRET;
     2166    11422    2      CALL M$READ(READCAT)ALTRET(AARGH);
     2167    11423    2   AARGH:;
     2168    11424    2      NUMPSNS=(DCBADDR(READCAT.V.DCB#)->F$DCB.ARS
     2169    11425    2        -POFFC(ADDR(CSTAT.SETS(1)),ADDR(CSTAT)))/SIZEC(CSTAT.SETS(0));
     2170    11426    2      IF NUMPSNS>510 THEN NUMPSNS=0;
     2171    11427    2      RETURN;
     2172    11428    2   CATWRITE: ENTRY ALTRET;
     2173    11429    2      WRITECAT.BUF_.BOUND=POFFC(ADDR(CSTAT.SETS(NUMPSNS+1)),ADDR(CSTAT))-1;
     2174    11430    2      CALL M$WRITE(WRITECAT)ALTRET(RETALT);
     2175    11431    2      RETURN;
     2176    11432    2   CLOSE:ENTRY(I) ALTRET;
     2177    11433    2      CLOSE1.V.DCB#=I;
     2178    11434    3      CALL M$CLOSE(CLOSE1) WHENRETURN DO;
     2179    11435    3         RETURN;
     2180    11436    3         END;
     2181    11437    2      IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(AX);
     2182    11438    2   RETALT: ALTRETURN;
     2183    11439                    /**/
     2184    11440        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:93   
     2185    11441    2   NXTACCT: ENTRY ALTRET;
     2186    11442    2      CALL INDEX1(AX,'?',SELACCT);
     2187    11443    2      IF VLP_ACCT.ACCT#=BINASC(0)
     2188    11444    2      THEN CALL CONCAT(VLP_ACCT.ACCT#,SUBSTR(SELACCT,0,AX),BINASC(0));
     2189    11445    3      IF AX=8 THEN IF USW OR MADM.V.DELETE# AND SELACCT~=' ' AND CODE~=0 THEN DO;
     2190    11446    3         ADDR(SUBSTR(VLP_ACCT.ACCT#,4))->BASED_UBIN =
     2191    11447    3           ADDR(SUBSTR(VLP_ACCT.ACCT#,4))->BASED_UBIN-1;
     2192    11448    3         SELACCT='??';
     2193    11449    3         END;
     2194    11450    2      ELSE GOTO NOSEL;
     2195    11451    3      DO WHILE('1'B);
     2196    11452    4         IF PROJAD.L=0 THEN DO;
     2197    11453    4            CALL M$OPEN(OPNXTA)ALTRET(NXTA1);
     2198    11454    4   NXTA1:   ;
     2199    11455    4            IF F$DCB.ACCT=' ' THEN ALTRETURN;
     2200    11456    5            IF F$DCB.ACCT=VLP_ACCT.ACCT# THEN DO;
     2201    11457    5               FLAG=B$ALT.ERR;
     2202    11458    5               GOTO ACCTERR;
     2203    11459    5               END;
     2204    11460    4            VLP_ACCT.ACCT#=F$DCB.ACCT;
     2205    11461    4            END;
     2206    11462    3         ELSE IF CODE=%E$CREATE THEN GOTO NOSEL;
     2207    11463    3         ELSE CALL FXU$PROJNA(VLP_ACCT)ALTRET(RETALT);
     2208    11464    3         IF BREAK~=0 THEN RETURN;
     2209    11465        %LIST;
     2210    11466              %WILD_COMPARE(WILD_CHARS=SELACCT,
     2211    11467              COMPARE_CHARS=VLP_ACCT.ACCT#,
     2212    11468              WILD_X=AX,
     2213    11469              WILD_XP=AXP,
     2214    11470              COMPARE_X=BX,
     2215    11471              COMPARE_XP=BXP,
     2216    11472              NO_MATCH=GOTO NOMATCH);
             11473        %LSET LISTDIR='0'B;
             11490    3           WILD_XC=SELACCT;
             11491    4           IF (BINBIT(AX,36)&'737737737777'O)='101114114040'O THEN DO;
             11492    4              AX=3;
             11493    4              AXP=2;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:94   
             11494    4              END;
             11504    4           ELSE DO;
             11505    4              AX=0;
             11506    4              AXP=SIZEC(SELACCT);
             11507    4              END;
             11508    3           BX=0;
             11509    3           BXP=0;
             11513    4           DO WHILE(AX<SIZEC(SELACCT) AND SUBSTR(SELACCT,AX,1)~=' '
             11514    4             OR BX<SIZEC(VLP_ACCT.ACCT#) AND SUBSTR(VLP_ACCT.ACCT#,BX,1)~=' ');
             11515    5              IF AX<SIZEC(SELACCT) AND SUBSTR(SELACCT,AX,1)='?' THEN DO;
             11516    5                 AXP=AX;
             11517    5                 END;
             11518    5              ELSE DO;
             11519    5                 IF AX=AXP+1 THEN BXP=BX;
             11520    5                 IF AX>=SIZEC(SELACCT)
             11521    5                   OR BX>=SIZEC(VLP_ACCT.ACCT#)
             11522    5                   OR SUBSTR(SELACCT,AX,1) ~=
             11523    6                   SUBSTR(VLP_ACCT.ACCT#,BX,1) THEN DO;
             11524    6                    IF AXP=SIZEC(SELACCT) OR BXP=SIZEC(VLP_ACCT.ACCT#)
             11525    6                    THEN GOTO NOMATCH;
             11526    6                    AX=AXP;
             11530    6                    BX=BXP;
             11531    6                    END;
             11535    5                 BX=BX+1;
             11536    5                 END;
             11537    4              IF AX<SIZEC(SELACCT) THEN AX=AX+1;
             11538    4   END;
     2217    11543    3         IF B$ALT.ERR.CODE=%E$NOKEY AND PROJAD.L=0
     2218    11544    3           AND (CODE~=%E$MADLIST OR OPNSN.SN#(0)~=' ') THEN GOTO NOMATCH;
     2219    11545    3         IF USW THEN SELACCT='??'; /* AND ALL THE REST */
     2220    11546    3         ELSE IF SELACCT='??' THEN SELACCT=' ';
     2221    11547    3         RETURN;
     2222    11548    3   NOMATCH: IF AXP=8 THEN ALTRETURN;
     2223    11549    3         END;
     2224    11550    2   NOSEL: VLP_ACCT.ACCT#=SELACCT;
     2225    11551    2      IF SELACCT=' ' THEN ALTRETURN;
     2226    11552    2      SELACCT=' ';
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:95   
     2227    11553    2      OPNXTA.V.SETDCB#='1'B;
     2228    11554    2      CALL M$OPEN(OPNXTA)ALTRET(NOSEL1);
     2229    11555    2   NOSEL1: OPNXTA.V.SETDCB#='0'B;
     2230    11556    2      IF PROJAD.L~=0 THEN CALL FXU$PROJAC(CODE)ALTRET(ACCTERR);
     2231    11557    2      RETURN;
     2232    11558                    /**/
     2233    11559    2   ACCTERR: FLAG.SEV=7;
     2234    11560    2      UNWIND TO DPERX;
     2235    11561        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:96   
     2236    11562    2   ACCTLTXT: ENTRY ALTRET; /* MAKE TEXT FROM FFLG (IN FLAG) */
     2237    11563    2      TCXT=',';
     2238    11564    2      NUMSNS=2;
     2239    11565    2      J=SIZEW(FFLGS);
     2240    11566    3      DO WHILE(J>0);
     2241    11567    3         J=J-1;
     2242    11568    4         IF FLAG=FFLGS(J) THEN DO;
     2243    11569    4            CALL INSERT(TCXT,2,8,FFLGC(J));
     2244    11570    4            CALL INDEX1(NUMSNS,' ',TCXT,2);
     2245    11571    4            RETURN;
     2246    11572    4            END;
     2247    11573    4         IF FLAG&FFLGS(J) AND J<9 THEN DO;
     2248    11574    4            CALL INSERT(TCXT,NUMSNS,1,SUBSTR(FFLGC(J),0,1));
     2249    11575    4            NUMSNS=NUMSNS+1;
     2250    11576    4            END;
     2251    11577    3         END;
     2252    11578    2      IF SUBSTR(TCXT,2,2)='CR' THEN CALL INSERT(TCXT,2,2,'RC');
     2253    11579    2      IF SUBSTR(TCXT,2,2)='WR' THEN CALL INSERT(TCXT,2,2,'RW');
     2254    11580    2      RETURN;
     2255    11581        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:97   
     2256    11582    2   MOVEFIT: ENTRY ALTRET; /* MOVE FIT FROM VIDBUF TO PADBUF */
     2257    11583    2      FIT04='0'B; /* TURN OFF CODE04 */
     2258    11584    3      DO AX=1 TO FIT.CODES.CODE(0);
     2259    11585    3         BXB=FIT.CODES(AX)&~ITEMXMASK;
     2260    11586    3         FITSIZE=FIT.CODES.NDW(AX)*4;
     2261    11587    3         AXP$=ADDR(WBUF(FIT.CODES.ITEMX(AX)));
     2262    11588    4         DO CASE(FIT.CODES.CODE(AX));
     2263    11589    4         CASE(4);
     2264    11590    4            CODE04=AXP$->FITMOVER;
     2265    11591    4            IF CODE04.ACCESS=CODE04.CREATION THEN CODE04.ACCESS='0'B;
     2266    11592    4            IF CODE04.SVMODIFY=CODE04.CREATION THEN CODE04.SVMODIFY='0'B;
     2267    11593    4         CASE(9);
     2268    11594    4            FIT09=BXB|FIT09&ITEMXMASK;
     2269    11595    4            ADDR(CODE09)->FITMOVER=AXP$->FITMOVER;
     2270    11596    4         CASE(14);
     2271    11597    4            FIT14=BXB|FIT14&ITEMXMASK;
     2272    11598    4            CODE14=AXP$->FITMOVER;
     2273    11599    4         END;
     2274    11600    3         END;
     2275    11601    2      RETURN;
     2276    11602        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:98   
     2277    11603    2   SET_PRIV: ENTRY ALTRET; /* SET PRIVS FROM THE USER AUTHORIZAITON */
     2278    11604    2      CALL M$SPRIV(PPRIVFPT);
     2279    11605    2      PRIVFPT.V.PRIV#=PPRIVFPT.V.PRIV#;
     2280    11606    2      IF B$JIT.PPRIV.PIGC THEN CALL M$SPRIV(PRIVFPT);
     2281    11607    2      IF NOT B$JIT.PRIV.ACTIVE.FMDIAG THEN PRIVFPT.V.PRIV#=%PR_SPCLMM#;
     2282    11608    2      ELSE PRIVFPT.V.PRIV#=%(PR_SPCLMM#|PR_FMBLK#);
     2283    11609    2      IF B$JIT.PPRIV.PIGD THEN CALL M$SPRIV(PRIVFPT);
     2284    11610    2      PRIVFPT.V.PRIV#=%(PR_FMSEC#|PR_FMBLK#)&~B$JIT.PRIV.ACTIVE;
     2285    11611    2      IF B$JIT.PRIV.ACTIVE.FMDIAG OR NOT B$JIT.PPRIV.PIGD
     2286    11612    2      THEN DIAGFPT.V.PRIV#='0'B;
     2287    11613    2      ELSE DIAGFPT.V.PRIV#=%PR_FMDIAG#;
     2288    11614    2      PROJAD.L=0;
     2289    11615    2      RETURN;
     2290    11616    2   END;
     2291    11617        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:99   
     2292    11618                    /*I*      NAME: DEFER
     2293    11619                    *         ENTRY:UNDEFER,UNDEFER1
     2294    11620                   *         DESCRIPTION: Puts a SUPER request for an unmounted set in PIGCG
     2295    11621                    *         (DEFER) or takes one out for a newly mounted one (UNDEFER).
     2296    11622                    */
     2297    11623    1   DEFER: PROC ALTRET;
     2298    11624    2      IF S_TO_P.TYPE=%VALIDATE_ATTR THEN RETURN;
     2299    11625    2      IF S_TO_P.TYPE=%LIST_ACCT THEN FLAG=FXP$E$NLIST;
     2300    11626                    /*E*      ERROR:FXP-E$NLIST
     2301    11627                    *         MESSAGE: Packset not currently shared.
     2302    11628                    */
     2303    11629    3      ELSE DO;
     2304    11630    3         DEFERFPT.BUF_.BUF$=BLK$;
     2305    11631    3         DEFERFPT.BUF_.BOUND=M$SI$->F$DCB.ARS-1;
     2306    11632    3         DEFERST.MSGTYP#=S_TO_P.PACKSET;
     2307    11633    3         CALL M$WRITE(DEFERFPT)ALTRET(DEFERERR);
     2308    11634    3         FLAG=FXP$E$DEFER;
     2309    11635                    /*E*      ERROR:FXP-E$DEFER
     2310    11636                    *         MESSAGE:Set not shared - Request deferred.
     2311    11637                    */
     2312    11638    3         CODE=%E$PIGH; /* NO ABORTED MESSAGE */
     2313    11639    3         END;
     2314    11640    2      ALTRETURN;
     2315    11641    2   DEFERERR: FLAG=B$ALT.ERR;
     2316    11642    3      IF FLAG.CODE=%E$CGNOCLS THEN DO;
     2317    11643    4         IF NOT DCBADDR(DCBNUM(M$PIGCG))->F$DCB.FCD THEN DO;
     2318    11644    4            RELPIGFIL.V.ASN#=%FILE#;
     2319    11645    4            CALL M$OPEN (RELPIGFIL) ALTRET(DEFERERR1);
     2320    11646    4            RELPIGFIL.V.ASN#=%COMGROUP#;
     2321    11647    4            CALL M$OPEN (RELPIGFIL) ALTRET(DEFERERR1);
     2322    11648    4            END;
     2323    11649    3         ELSE CALL M$CLOSE (RELPIGCG) ALTRET(DEFERERR1);
     2324    11650    3         CALL M$RETRY;
     2325    11651    3         END;
     2326    11652    2   DEFERERR1:;
     2327    11653    2      EFPT.V.DCB#=DCBNUM(M$PIGCG);
     2328    11654    2      FLAG.SEV=7;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:100  
     2329    11655    2      ALTRETURN;
     2330    11656                    /**/
     2331    11657    2   UNDEFER1: ENTRY ALTRET;
     2332    11658    3      DO I=0 TO NUMPSNS;
     2333    11659    3         IF CSTAT.SETS.SETX(I)=3 THEN GOTO UNDEFER0;
     2334    11660    3         END;
     2335    11661    2      RETURN;
     2336    11662    2   UNDEFER: ENTRY ALTRET;
     2337    11663    2   UNDEFER0:;
     2338    11664    2      DEFERST.MSGTYP#=CSTAT.SETS.PSN(I);
     2339    11665    2      DEFERFPT.BUF_.BUF$=PINCRW(WORK_.FIRST$,20);
     2340    11666    2      DEFERFPT.BUF_.BOUND=4*1004-1;
     2341    11667    2      CALL M$READ(DEFERFPT)ALTRET(NOMORE);
     2342    11668    2      WRSUPER.STATION_=DEFERFPT.STATION_;
     2343    11669    2      DEFERFPT.BUF_.BOUND=DCBADDR(DCBNUM(M$PIGCG))->F$DCB.ARS-1;
     2344    11670    2      WRSUPER.BUF_=DEFERFPT.BUF_;
     2345    11671    2      CALL M$WRITE(WRSUPER) ALTRET(NOMORE);
     2346    11672    3      IF CSTAT.SETS.SETX(I)=1 THEN DO;
     2347    11673    3         CSTAT.SETS.SETX(I)=3;
     2348    11674    3         CALL CATWRITE;
     2349    11675    3         END;
     2350    11676    2      RETURN;
     2351    11677                    /**/
     2352    11678    2   NOMORE:;
     2353    11679    2      IF B$ALT.DCB#=DCBNUM(M$SI) THEN CALL M$WRITE(DEFERFPT)ALTRET(NOMORE);
     2354    11680    3      IF CSTAT.SETS.SETX(I)=3 THEN DO;
     2355    11681    3         CSTAT.SETS.SETX(I)=1;
     2356    11682    3         CALL CATWRITE;
     2357    11683    3         END;
     2358    11684    2      RETURN;
     2359    11685    2   END;
     2360    11686        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:101  
     2361    11687                    /**/
     2362    11688    1   CMDERR: FLAG=FXP$E$PROJCMD;
     2363    11689    1      GOTO DPERR1;
     2364    11690    1   DUPERR: FLAG=FXP$E$DUPVSN;
     2365    11691    1      GOTO DPERR1;
     2366    11692    1   VOLERR: IF OPNSN.SN#(0)<' '
     2367    11693    2      THEN IF B$ALT.ERR.CODE=%E$XCLSET AND TRAPCNT=0 THEN DO;
     2368    11694    2         TRAPCNT=TRAPCNT+1;
     2369    11695    2         CALL M$WAIT(WAIT1);
     2370    11696    2         CALL M$RETRY;
     2371    11697    2         END;
     2372    11698    1   DPERR: ;
     2373    11699    1      IF ENTADDR(FXD$PMME)=ENTADDR(NIL) THEN FLAG=B$ALT.ERR;
     2374    11700    1      ELSE CALL FXD$PMME(FLAG);
     2375    11701    1      FLAG.SEV=7;
     2376    11702    1   DPERR1:;
     2377    11703    1      J=ADDR(OPNSN.SN#(0))->BASED_UBIN;
     2378    11704    2      IF FLAG.CODE=%E$SETDOWN THEN DO;
     2379    11705    2         IF OPNSN.SN#(0)>' ' THEN J=F$DCB.CSEED;
     2380    11706    2         IF J=0 THEN FLAG=FXP$E$NOVOL;
     2381    11707                    /*E*     ERROR: FXP-E$NOVOL-C
     2382    11708                     *        MESSAGE: No volumes of set #%SN are up.
     2383    11709                     */
     2384    11710    2         ELSE FLAG=FXP$E$VOLDOWN;
     2385    11711                    /*E*     ERROR: FXP-E$VOLDOWN-C
     2386    11712                     *        MESSAGE: Diskpack volume %U1 is not up.
     2387    11713                     */
     2388    11714    2         END;
     2389    11715    1      X9=I;
     2390    11716    1      I=0;
     2391    11717    1      IF J<99999999 THEN CALL INSERT(TCXT,20,1,' ');
     2392    11718    1      ELSE CALL INSERT(TCXT,20,1,BINASC(ASCBIN(ADDR(J)->CHAR1)+ASCBIN('@')));
     2393    11719    1      CALL INSERT(ADDR(J)->CHAR4,0,1,BINASC(0));
     2394    11720    1      CALL ADDPARNUM(%MNUM);
     2395    11721    1      CALL INSERT(TCXT,0,20,BINASC(J-1),SUBSTR(LBUFC,2,J-2),
     2396    11722    1        SUBSTR(TCXT,20,1));
     2397    11723    1      IF OPNSN.SN#(0)<' ' AND SUBSTR(OPNSN.SN#(0),4,1)~=' '
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:102  
     2398    11724    1      THEN TCXT=OPNSN.SN#(0);
     2399    11725    1      I=X9;
     2400    11726    1      FLAG.SEV=FLAG.SEV+1;
     2401    11727    1      IF BREAK~=0 THEN GOTO DPCLOSE;
     2402    11728    1      LBUFC=' ';
     2403    11729    1      CALL M$ERRMSG(EFPT)ALTRET(HERE3);
     2404    11730    1   HERE3:;
     2405    11731    1      WROC.MSG#=PIGERR_MSG#;
     2406    11732    2      IF FLAG.CODE=E$VOLDOWN AND (CODE=%E$EXTND OR CODE=%E$BUILD) THEN DO;
     2407    11733    2         IF OPNSN.SN#(0)~=ADDR(TRAPCNT)->CHAR4 THEN CALL ERROR(2);
     2408    11734    2         ADDR(TRAPCNT)->CHAR4=OPNSN.SN#(0);
     2409    11735    2         CALL M$WAIT(WAIT1);
     2410    11736    2         IF BREAK=0 THEN CALL M$RETRY;
     2411    11737    2         END;
     2412    11738    1      ELSE CALL ERROR(2);
     2413    11739    1      IF FLAG.CODE=%E$ACGRANS THEN GOTO LISTNXT;
     2414    11740                    /**/
     2415    11741    1   DPCLOSE:;
     2416    11742    1      CLSDP.V.DISP#=%SCRATCH#;
     2417    11743    2      CALL M$CLOSE(CLSDP) WHENALTRETURN DO;
     2418    11744    2         IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(X9);
     2419    11745    2         END;
     2420    11746                    /**/
     2421    11747    1   CMDABORT:;
     2422    11748    1      IF CODE~=%E$PIGH THEN CALL ERROR(5);
     2423    11749    1      GOTO NEXT;
     2424    11750                    /**/
     2425    11751    1   NOTOWNER:;
     2426    11752    1      FLAG=FMN$E$XCLSET;
     2427    11753    1      GOTO DPERR1;
     2428    11754                    /**/
     2429    11755    1   TOOMANY:;
     2430    11756    1      P_PCB.ERROR.CODE=7;
     2431    11757    1      P_PCB.HI_CHAR=OUT$BLK.SUBLK$(I)->OUT$BLK.CPOS;
     2432    11758    1      GOTO VALERR;
     2433    11759                    /**/
     2434    11760    1   NOCORE: TCXT=' ';
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:103  
     2435    11761                    /**/
     2436    11762    1   SIERR:;
     2437    11763    2      IF MODE=0 AND FPT_READ.BUF_.BUF$=ADDR(TCXT) THEN DO;
     2438    11764    2         FPT_READ.BUF_.BUF$=PINCRW(WORK_.FIRST$,20);
     2439    11765    2         FPT_READ.BUF_.BOUND=1004*4-1;
     2440    11766    2         CALL M$RETRY;
     2441    11767    2         END;
     2442    11768    1      FLAG=B$ALT.ERR;
     2443    11769    1      FLAG.SEV=0;
     2444    11770    1      EFPT.V.DCB#=DCBNUM(M$SI);
     2445    11771    1      CALL M$ERRMSG(EFPT)ALTRET(HERE7);
     2446    11772    1   HERE7:;
     2447    11773    1      IF TCXT~=' ' AND (NOT M$SI$->F$DCB.DDEV.IC
     2448    11774    1        OR NOT M$LO$->F$DCB.DDEV.IC) THEN CALL ERROR(4);
     2449    11775    1      P_PCB.NCHARS=0;
     2450    11776    1      CALL ERROR(2);
     2451    11777    1      IF MODE=0 THEN GOTO NEXT;
     2452    11778    1      CALL CLOSE(DCBNUM(M$LO));
     2453    11779    1      ALTRETURN;
     2454    11780    1   NOALT:;
     2455    11781    1      IF ENTADDR(FXD$PMME)=ENTADDR(NIL) THEN FLAG=B$ALT.ERR;
     2456    11782    1      ELSE CALL FXD$PMME(FLAG);
     2457    11783    1      FLAG.SEV=0;
     2458    11784    1      CALL M$MERC(MERCER);
     2459    11785        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:104  
     2460    11786    1   ADDPART: PROC(L,TEXT) ALTRET;
     2461    11787    2   DCL L UBIN;
     2462    11788    2   DCL P$ PTR;
     2463    11789    2   DCL TEXT CHAR(L);
     2464    11790    2   DCL 1 THING BASED(P$),
     2465    11791    2         2 L UBIN BYTE UNAL,
     2466    11792    2         2 T CHAR(J);
     2467    11793    2   DCL FX_MSG$(0:0)SYMREF PTR;
     2468    11794    2   DCL V BASED(P$)CHAR(12);
     2469    11795                    /**/
     2470    11796    2      J=L;
     2471    11797    2      P$=PINCRC(ADDR(TEXT),-1);
     2472    11798    2      GOTO ADDPARM;
     2473    11799                    /**/
     2474    11800    2   ADDPARNUM: ENTRY(L) ALTRET;
     2475    11801    2      P$=FX_MSG$(L);
     2476    11802    2      P$=PINCRC(ADDR(THING),THING.L-11);
     2477    11803    2      CALL BINCHAR(V,J);
     2478    11804    2      CALL EDITCHAR(V,0,11,'001001011'B,V);
     2479    11805    2      CALL INDEX1R(J,' ',V);
     2480    11806    2      J=J+1;
     2481    11807    2      CALL INSERT(V,0,,SUBSTR(V,J,12-J));
     2482    11808    2   ADDPARAM:ENTRY(L) ALTRET;
     2483    11809    2   ADDPAREQ:ENTRY(L) ALTRET;
     2484    11810    2      P$=FX_MSG$(L);
     2485    11811                    /**/
     2486    11812    2      J=THING.L;
     2487    11813    2   ADDPARM:;
     2488    11814    3      DO WHILE (SUBSTR(THING.T,J-1,1)=' ');
     2489    11815    3         J=J-1;
     2490    11816    3         END;
     2491    11817    3      IF I+J>WIDTH THEN DO;
     2492    11818    3         IF MODE~=0 THEN CALL ERROR(10); /* STAR 42856 MAKE CALL CONDITIONAL */
     2493    11819    3         LBUFC=' ';
     2494    11820    3         I=I0;
     2495    11821    4         IF SUBSTR(THING.T,0,2)=', ' THEN DO;
     2496    11822    4            J=J-2;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:105  
     2497    11823    4            P$=PINCRC(P$,2);
     2498    11824    4            END;
     2499    11825    3         END;
     2500    11826    2      CALL INSERT(LBUFC,I,,THING.T);
     2501    11827    2      I=I+J;
     2502    11828    2      RETURN;
     2503    11829        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:106  
     2504    11830    2   RECONST: ENTRY ALTRET;
     2505    11831    2      CALL CONCAT(LBUFC,'Reconstruct initiated for DP#',OPNSN.SN#(0));
     2506    11832    3      IF MODE=0 THEN DO;
     2507    11833                    /* PREPARE TO MAKE THE RECON INTERRUPTIBLE SO PIG DOESNT
     2508    11834                    GO AWAY */
     2509    11835    3         WROC.MSG#=HGPR_MSG#;
     2510    11836    3         WROC.VSN=GAC;
     2511    11837    3         IF CSTAT.SETS.SETX(I)~=2 THEN CALL ERROR(2);
     2512    11838    3         ELSE CALL ERROR(3);
     2513    11839    4         IF NOT FPT_READ.V.WAIT# THEN DO;
     2514    11840    4            FLAG=FXP$E$2RECON;
     2515    11841                    /*E*     ERROR: FXP-E$2RECON-C
     2516    11842                    *        MESSAGE: Only one reconstruct at a time, please
     2517    11843                    */
     2518    11844    4            CSTAT.SETS.SETX(I)=2;/* SET RECON WAIT FLAG */
     2519    11845    4            CALL CATWRITE;
     2520    11846    4            ALTRETURN;
     2521    11847    4            END;
     2522    11848    3         FPT_READ.V.WAIT#=%NO#;
     2523    11849    4         IF FPT_READ.V.EVENT#=0 THEN DO;
     2524    11850    5            IF CODE~=0 THEN DO;
     2525    11851    5               FPT_READ.V.EVENT#=1;
     2526    11852    5               TCXT=' '; /* START THE NEXT COMGROUP READ */
     2527    11853    5               CALL M$READ(FPT_READ);
     2528    11854    5               END;
     2529    11855    5            ELSE DO;
     2530    11856    5               GBUF.CODE=1; /* MAKE A DISK DPNN KEYIN */
     2531    11857    5               CALL CONCAT(GBUF.PSN(0),BINASC(0),BINASC(0),ADDR(X9)->CHAR4);
     2532    11858    5               BREAK=1;
     2533    11859    5               END;
     2534    11860    4            END;
     2535    11861    3         END;
     2536    11862    2      ELSE CALL ERROR(10);
     2537    11863    2      CALL FXH$RECON ALTRET(RECONERR);
     2538    11864    2   RECONXIT: FPT_READ.V.WAIT#=%YES#;
     2539    11865    2      IF GAC~=0 THEN CALL FGG$DONE;
     2540    11866    2      RETURN;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:107  
     2541    11867    2   RECONERR0: ERRCODE=B$ALT.ERR;
     2542    11868    2      FPT_READ.V.EVENT#=0;
     2543    11869    2   RECONERE: ENTRY ALTRET;
     2544    11870    3   RECONERR: IF BREAK~=0 AND MODE=0 THEN DO;
     2545    11871                    /* A COMGROUP READ HAS COMPLETED */
     2546    11872    3         BREAK=0;
     2547    11873    3         CALL CLOSE(DCBNUM(M$DP));
     2548    11874    3         X9=BITBIN(ERRCODE);
     2549    11875    3         CALL FXP$TWO; /* PROCESS THE REQUEST */
     2550    11876    3         ERRCODE=BINBIT(X9,36);
     2551    11877    3         WROC.CADDR=M_DISK;
     2552    11878    3         OPNSN=RCNSN; /* RESTORE SET NAME */
     2553    11879    3         CALL CATREAD; /* ABORT THE RECON IF REQUEST WAS DISMOUNT */
     2554    11880    4         DO I=0 TO CSTAT.NUM; /*ALSO RESTORE CSTAT INDEX(I)*/
     2555    11881    5            IF OPNSN.SN#(0)=CSTAT.SETS.PSN(I) THEN DO;
     2556    11882    5               OPNDP.V.FUN#=%UPDATE#;
     2557    11883    5               CALL M$OPEN(OPNDP)ALTRET(RECONERR0);
     2558    11884    5               TCXT=' ';
     2559    11885    5               CODE=%E$MOUNT; /* MAKE A NICE MESSAGE WHEN RECON'S DONE */
     2560    11886    5               FPT_READ.V.EVENT#=1; /* LET'S HEAR WHEN THIS READ'S DONE */
     2561    11887    5               CALL M$READ(FPT_READ); /* START ANOTHER READ */
     2562    11888    5               CALL FXH$RECONT ALTRET(RECONERR);
     2563    11889    5               GOTO RECONXIT;
     2564    11890    5               END;
     2565    11891    4            END;
     2566    11892                    /*NOT THERE ANYMORE, FLICK IT IN */
     2567    11893    3         BREAK=1; /* NO ERROR MESSAGE */
     2568    11894    3         FPT_READ.V.EVENT#=0;
     2569    11895    3         END;
     2570    11896    2      FPT_READ.V.WAIT#=%YES#;
     2571    11897    2      FLAG=ERRCODE;
     2572    11898    2      FLAG.SEV=7;
     2573    11899    2      IF GAC~=0 THEN CALL FGG$QUIT;
     2574    11900    2      ALTRETURN;
     2575    11901    2   END ADDPART;
     2576    11902        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:108  
     2577    11903    1   GET_OPTIONS: PROC ALTRET;
     2578    11904    2   DCL FFLGS(0:19) CONSTANT BIT(36) INIT(
     2579    11905        %EQU REMACN='0000004'O;
     2580    11906        %EQU REMPRM='0000002'O;
     2581    11907    2        %NO#,%REMACN,%REMPRM,%NO#,%FFLG_WRITE#,
     2582    11908    2        %FFLG_WNEW#,%FFLG_REATTR#*2,%FFLG_READ#,
     2583    11909    2        %FFLG_DELF#*2,%FFLG_DELR#,%FFLG_NOLIST#,
     2584    11910    2        %FFLG_EXEC#,%FFLG_UPD#,%FFLG_CREATE#,'0'B*0);
     2585    11911    2   DCL K SBIN;
     2586    11912    2      J=0;
     2587    11913    2      FLAG='0'B;
     2588    11914    2   NXTOPT:;
     2589    11915    2      P$=OUT$BLK.SUBLK$(I);
     2590    11916    3      DO CASE(P$->OUT$BLK.CODE);
     2591    11917                    /* MACRO TO KEEP THESE CASE STMTS AND THE NODES ALIGNED */
     2592    11918                    /* JUST KEEP THEM BOTH IN THE SAME ORDER */
     2593    11919        %SET CASE=0;
     2594    11920        %MACRO CASE(C=);
     2595    11921        %SET CASE=CASE+1;
     2596    11922        %LSET LISTEXP='1'B;
     2597    11923        %LSET LISTSUB='1'B;
     2598    11924           CASE(%CASE); %CHARTEXT('/*') C %CHARTEXT('*/')
     2599    11925        %MEND;
     2600    11926        %SET LISTDIR='0'B;
             11931    3      CASE(1); /* NOT... */
     2602    11933    3         FLAG='1'B;
     2603    11934    3         I=I+1;
     2604    11935    3         GOTO NXTOPT;
             11940    3      CASE(2); /* NEWFDS */
     2606    11942    3         CODE14.ACCESS.NEWFD=~FLAG;
             11947    3      CASE(3); /* CGMEM */
     2608    11949    3         I=I+1;
     2609    11950    3         CALL CHARBIN(J,OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT);
     2610    11951    3         J=(J+%CGMEMSIZ-1)/%CGMEMSIZ;
     2611    11952    3         CODE14.CGMEM=J;
     2612    11953    3         IF CODE14.CGMEM~=J THEN ALTRETURN;
             11958    3      CASE(4); /* CHECKWRITE */
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:109  
     2614    11960    3         CODE14.ACCESS.WRCMP=~FLAG;
             11965    3      CASE(5); /* PROTECTED FILES */
     2616    11967    3         CODE14.ACCESS.OWNERF=FLAG;
             11972    3      CASE(6); /* GRAN LIMIT */
     2618    11974    3         I=I+1;
     2619    11975    3         CALL CHARBIN(J,OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT);
     2620    11976    3         CODE14.MGRANS=J;
     2621    11977    3         IF CODE14.MGRANS~=J THEN ALTRETURN;
             11982    3      CASE(7); /* DEFAULT BACKUP */
     2623    11984    3         I=I+1; /* SKIP BACKUP (MUST BE THERE) */
     2624    11985    3         CODE14.ACCESS.BUPM=~FLAG;
     2625    11986    3         CODE14.ACCESS.BUPF=~FLAG;
             11991    3      CASE(8); /* BACKUP */
     2627    11993    3         CODE14.ACCESS.BUPF=~FLAG;
     2628    11994    3         CODE14.ACCESS.BUPM='0'B;
             11999    3      CASE(9); /* PURGE */
     2630    12001    3         CODE14.ACCESS.NPUR=FLAG;
             12006    3      CASE(10); /* ACUP */
     2632    12008    3         CODE14.ACCESS.NOACUP=FLAG;
             12013    3      CASE(11); /* STOW */
     2634    12015    3         CODE14.ACCESS.NOSTOW=FLAG;
             12020    3      CASE(12); /* SHELFTIME */
     2636    12022    3         CODE14.ACCESS.GACSHELF=~FLAG;
             12027    3      CASE(13); /* DATA CHECKWRITE */
     2638    12029    3         CODE14.ACCESS.WCDATA=~FLAG;
             12034    3      CASE(14); /* MERGEACCESS */
     2640    12036    3         CODE14.ACCESS.MERGEAC=~FLAG;
     2641    12037    3      CASE(20); /* OWNER */
     2642    12038    4         DO J=0 TO P$->OUT$BLK.NSUBLKS-1 BY 2;
     2643    12039    4            IF J=2*SIZEW(CODE14.OWNER)/SIZEW(CODE14.OWNER(0)) THEN GOTO RETALT;
     2644    12040    4            CODE14.OWNER.ACCT(J/2)=P$->OUT$BLK.SUBLK$(J)->OUT$SYM.TEXT;
     2645    12041    4            CODE14.OWNER.NAME(J/2)=P$->OUT$BLK.SUBLK$(J+1)->OUT$SYM.TEXT;
     2646    12042    4            END;
     2647    12043    3         FIT14.NDW=SIZEW(CODE14)-SIZEW(CODE14.OWNER)+J*SIZEW(CODE14.OWNER(0))/2;
     2648    12044    3         FIT14.NAW=FIT14.NDW;
     2649    12045    3      CASE(0); /* ACCESS CONTROL */
     2650    12046    4         DO WHILE(P$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE~=0);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:110  
     2651    12047    4            IF X9=0 AND P$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE<4
     2652    12048    4            THEN X9=FIT09.NDW*4/10;
     2653    12049    4            FLAG=FLAG|FFLGS(P$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE);
     2654    12050    4            J=J+1;
     2655    12051    4            END;
     2656    12052    3         IF J>1 AND FLAG&%FFLG_READ#
     2657    12053    3           AND NOT FLAG&%(~FFLG_READ#&~FFLG_DELR#&~FFLG_WNEW#)
     2658    12054    3           AND (FLAG&%(FFLG_DELR#|FFLG_WNEW#))~=%(FFLG_DELR#|FFLG_WNEW#)
     2659    12055    3           AND P$->OUT$BLK.SUBLK$(J-1)->OUT$BLK.CPOS=
     2660    12056    3           P$->OUT$BLK.SUBLK$(J-2)->OUT$BLK.CPOS+1
     2661    12057    3           AND (P$->OUT$BLK.SUBLK$(J-1)->OUT$BLK.CODE=11
     2662    12058    3           OR P$->OUT$BLK.SUBLK$(J-2)->OUT$BLK.CODE=5)
     2663    12059    3         THEN IF FLAG&%FFLG_WNEW# THEN FLAG=%FFLG_WRITE#;
     2664    12060    3         ELSE FLAG=%FFLG_READ#;
     2665    12061    4         DO WHILE(J<P$->OUT$BLK.NSUBLKS);
     2666    12062    4            IF X9=SIZEW(CODE09)/SIZEW(CODE09(0)) THEN GOTO RETALT;
     2667    12063    4            CODE09.ACCT(X9)=P$->OUT$BLK.SUBLK$(J)->OUT$SYM.TEXT;
     2668    12064    4            CODE09.FFLG(X9)=FLAG;
     2669    12065    4            IF CODE09.ACCT(X9)='ALL' OR CODE09.ACCT(X9)='?'
     2670    12066    4            THEN IF NOT FLAG&%REMPRM THEN CODE14.DFLTALL=FLAG;
     2671    12067    4            ELSE CODE14.DFLTALL=CODE14.DFLTALL&(~FLAG);
     2672    12068    5            ELSE DO;
     2673    12069    6               DO K=0 TO X9-1;
     2674    12070    7                  IF CODE09.ACCT(K)=CODE09.ACCT(X9) THEN DO;
     2675    12071    7                     X9=X9-1;
     2676    12072    7                     IF NOT FLAG&%REMPRM THEN CODE09.FFLG(K)=FLAG;
     2677    12073    7                     ELSE CODE09.FFLG(K)=CODE09.FFLG(K)&(~FLAG);
     2678    12074    8                     IF FLAG&%REMACN THEN DO;
     2679    12075    8                        CODE09(K)=CODE09(K+1);
     2680    12076    8                        CODE09(K+1)=CODE09(X9+1);
     2681    12077    8                        IF K=X9 THEN X9=X9-2;
     2682    12078    8                        X9=X9+1;
     2683    12079    8                        END;
     2684    12080    7                     END;
     2685    12081    6                  END;
     2686    12082    5               X9=X9+1;
     2687    12083    5               END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:111  
     2688    12084    4            J=J+1;
     2689    12085    4            END;
     2690    12086    3         FIT09.NDW=(X9*10+3)/4;
     2691    12087    3         FIT09.NAW=FIT09.NDW;
     2692    12088    3      END;
     2693    12089    2      RETURN;
     2694    12090    2   RETALT:;
     2695    12091    2      OUT$BLK.SUBLK$(I)=P$->OUT$BLK.SUBLK$(J);
     2696    12092    2      ALTRETURN;
     2697    12093    2   END;
     2698    12094    1   END;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:112  
--  Include file information  --

   AS_SUPER_C.:E05TOU  is referenced.
   FX_SUBS_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   FX$CAT.:E05TOU  is referenced.
   FX_PERR_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXP$MAIN.

   Procedure FXP$MAIN requires 6972 words for executable code.
   Procedure FXP$MAIN requires 766 words of local(AUTO) storage.

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:113  

 Object Unit name= FXP$MAIN                                   File name= FXP$PIG.:E05TOU
 UTS= SEP 04 '97 08:42:17.56 THU                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none  3552   6740  FXP$MAIN
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS    410    632  FXP$MAIN
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  M$LO
    5   DCB   even  none     0      0  M$DO
    6   DCB   even  none     0      0  M$DP
    7   DCB   even  none     0      0  M$CAT
    8   DCB   even  none     0      0  M$PROJ
    9   DCB   even  none     0      0  M$PIGCG
   10   Proc  even  none  6972  15474  FXP$MAIN
   11  RoData even  none   118    166  FXP$MAIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes    yes     yes      Std        1  FXP$MAIN
    10    715          yes     yes      Std        0  FXP$TWO
    10  11260          yes     yes      Std        1  FXP$RVID
    10  11340          yes     yes      Std        1  FXP$PRINT
    10  11363          yes     yes      Std        1  FXP$PART
    10  11375          yes     yes      Std        1  FXP$PARM
    10  11404          yes     yes      Std        1  FXP$PARN
    10  11416          yes     yes      Std        1  FXP$PROJAT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:114  

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2     52  SETSAD                             0   1010  USW
    2    140  FPT_PROMPT                         0   1014  P_PCB
    0   1072  SYSSIZE                            0   1073  BLK$
    0   1074  ERRCODE                            0   1100  TRAPX
    0   1102  TRAPCNT                            0   1107  FLAG
    0   1110  DPERX                              0   1114  USER_NAME
    0   1117  USER_ACCN                          0   1122  M$LO$
    0   1123  M$SI$                              0   1125  BREAK
    0   1127  PROJAD                             0   1270  GPBUF
    0   2621  VIDBUF                             0   4621  CSTAT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 FXP$INT
         yes          Async      0 FXP$XCON
 yes     yes           Std       0 FXU$PROJWR
 yes     yes           Std       0 FXH$GPSUM
 yes     yes           Std       1 FXU$CATL
 yes     yes           Std       0 FXH$COUNT
 yes     yes           Std       1 FXU$PROJDA
         yes           Std       1 FXP$POPTS
         yes           Std       1 FXF$FIX
 yes     yes           Std       1 FXU$PROJAD
 yes     yes           Std       1 FXU$PROJGR
         yes           Std       1 FXU$TRACKER
 yes     yes           Std       0 FXU$GINIT
 yes     yes           Std       1 X$HELP
         yes          Async      0 FXP$TRAP
 yes     yes           Std       1 FXU$CATMNT
 yes     yes           Std       1 FXU$PROTCHK
 yes     yes           Std       1 X$PARSE
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:115  
 yes     yes    yes    Std       1 FXD$PMME
 yes     yes           Std       1 FXU$CATADM
 yes     yes           Std       1 FXU$PROJNA
 yes     yes           Std       1 FXU$PROJAC
 yes     yes           Std       0 FGG$DONE
 yes     yes           Std       0 FGG$QUIT
 yes     yes           Std       0 FXH$RECONT
 yes     yes           Std       1 FXH$RECON
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       nStd      0 X66_AUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                M$UC                                  B$TCB$
     FXN$CMD                               M$SI                                  M$LO
     M$DO                                  M$DP                                  M$CAT
     GAC                                   RCNSN                                 XCONWIND
     M$DP$                            r    F$CFU$                                M$PROJ
     M$PIGCG                               B_VERSION                             FX_MSG$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:116  


       22        1        /*T***********************************************************/
       23        2        /*T*                                                         */
       24        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       25        4        /*T*                                                         */
       26        5        /*T***********************************************************/
       27        6        FXP$MAIN: PROC(PARM) ALTRET;

      6 10 000000   000000 700200 xent  FXP$MAIN     TSX0  ! X66_AUTO_1
        10 000001   001376 000001                    ZERO    766,1

       28        7    1   DCL 1 PARM ALIGNED,
       29        8    1         2 U UBIN,
       30        9    1         2 P$ PTR;
       31       10                    /* INCLUDES */
       32       11        %INCLUDE XU_MACRO_C;
       33     3117        %INCLUDE XUH_MACRO_C;
       34     3201        %XUH_PARAM(NAME=XUH,OUTDCB1=M$LO);
       35     3262        %INCLUDE XU_SUBS_C;
       36     3354 S      %INCLUDE B$JIT_C;
       37     3355        %B$JIT0;
       38     3444        %U$JIT1;
       39     3518        %M$JIT2X;
       40     3521        %F$JIT3;
       41     3526        %S$JIT4X;
       42     3529        %J$JIT5X;
       43     3532        %A$JIT6X;
       44     3535    1   DCL B$JIT$ PTR SYMREF;
       45     3536        %INCLUDE CP_6;
       46     3617        %B$TCB(STCLASS="BASED(B$TCB$)");
       47     3620        %B$ALT;
       48     3628    1   DCL B$TCB$ PTR SYMREF;
       49     3629        %SUB B$ALT=B$TCB.ALT$->B$ALT;
       50     3630        %INCLUDE CP_6_SUBS;
       51     4170        %INCLUDE FM$MACROS;
       52     4545        %FM$SET(BASED="BASED(F$CFU$)");
       53     4550        %FM$DEV(BASED="BASED(F$CFU$)");
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:117  
       54     4556        %FM$VOL(BASED="BASED(F$CFU$)");
       55     4562        %INCLUDE FX_PERR_C;
       56     4621        %INCLUDE FX$CAT;
       57     4638        %FM$CFUX;
       58     4643        %FM$SETU(BASED="BASED(P$)");
       59     4646        %FM$GRAN;
       60     4650        %INCLUDE B_ERRORS_C;
       61     5777        %INCLUDE JG_GHOSTS_C;
       62     5867        %INCLUDE OC_MESSHD_C;
       63     5920        %INCLUDE OC_SUBS_C;
       64     6651        %MACRO F$DCB#(BASED=);
       65     6652        %INCLUDE F$DCB;
       66     6701        %MEND;
       67     6702        %F$DCB#(BASED="BASED(M$DP$)");
       68     6752        %INCLUDE XU_PERR_C;
       69     6943        %VLP_SN(FPTN=OPNSN,SN=' ');
       70     6956        %VLP_ACCT;
       71     6969        %FPT_OPEN(FPTN=OPNDP,
       72     6970                 PFMT=VECTOR,
       73     6971                 DCB=M$DP,
       74     6972                 RES='DP',
       75     6973                 ASN=DEVICE,
       76     6974                 SN=OPNSN,
       77     6975                 ACCT=VLP_ACCT,
       78     6976                 FUN=IN);
       79     7085        %FPT_CLOSE(FPTN=CLSDP,DCB=M$DP);
       80     7127        %FPT_CLOSE(FPTN=CLOSE1,DISP=SAVE);
       81     7169        %FPT_READ(FPTN=READCAT,BUF=CSTAT,KEY=CATKEY,KEYS=YES,DCB=M$CAT);
       82     7208        %FPT_WRITE(FPTN=WRITECAT,BUF=CSTAT,KEY=CATKEY,DCB=M$CAT);
       83     7239    1   DCL CATKEY CONSTANT BIT(18)INIT('001000'O);
       84     7240        %FPT_MERC(FPTN=MERCER,STCLASS=CONSTANT,JERR=FLAG);
       85     7253        %FPT_ERRMSG(FPTN=EFPT,CODE=FLAG,BUF=LBUF,FIELD1=TCXT,RESULTS=EVLR);
       86     7280        %VLR_ERRMSG(FPTN=EVLR);
       87     7302        %FPT_WRITE(FPTN=OCMSG,DCB=M$SI,BUF=WROC,WAIT=NO);
       88     7333        %FPT_WRITE(FPTN=WRAVR,DCB=M$SI,BUF=AVR.MSG,STATION=PIGST,WAIT=NO);
       89     7364        %VLP_STATION (FPTN=PIGST,STCLASS=CONSTANT,STATION='PIG');
       90     7391        %FPT_MADMUCK(FPTN=MADM,ACCT=VLP_ACCT,SN=OPNSN);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:118  
       91     7407        %FPT_READ(FPTN=READVID,
       92     7408                 DCB=M$DP,
       93     7409                 BUF=VIDBUF,
       94     7410                 KEYS=YES,
       95     7411                 KEY=GRANULE);
       96     7450        %SUB WRITEVID=READVID;
       97     7451        %SUB READGP=READVID;
       98     7452        %SUB WRITEGP=READVID;
       99     7453        %SUB WRITEPAD=READVID;
      100     7454        %FPT_INT(UENTRY=FXP$INT);
      101     7468        %FPT_OPEN(FPTN=OPNXTA,DCB=M$DP,ASN=FILE,ACCT=VLP_ACCT,
      102     7469           FUN=IN,SN=OPNSN,NXTA=YES,TEST=YES);
      103     7578        %FPT_OPEN(FPTN=OPNFIL,DCB=M$DP,ASN=FILE,SN=OPNSN,ACCT=VLP_ACCT,
      104     7579          NAME=VLP_NAME,ACS=BLOCK);
      105     7688        %VLP_NAME;
      106     7715        %FPT_PRIV(FPTN=PRIVFPT);
      107     7730        %FPT_PRIV(FPTN=PPRIVFPT,AUTH=YES,STCLASS=CONSTANT,
      108     7731           PRIV="%(PR_FMSEC#|PR_FMDIAG#|PR_FMBLK#|PR_SPCLMM#|PR_SYSLOG#)");
      109     7746        %FPT_PRIV(FPTN=DIAGFPT,PRIV=%PR_FMDIAG#);
      110     7761        %FPT_XCON(UENTRY=FXP$XCON,STCLASS=CONSTANT);
      111     7775        %FPT_TRAP(ERRORS=FXP$TRAP,MEMORY=TRAP);
      112     7798        %FPT_LDEV(STREAMNAME='LP01');
      113     7823        %FPT_CORRES(FPTN=CORR,DCB1=M$DO);
      114     7837        %FPT_WAIT(FPTN=WAIT1,UNITS=1,STCLASS=CONSTANT);
      115     7851        %SUB FCG#='0630'O;
      116     7852        %SUB MID#='20'O;
      117     7853        %ERRCODE(NAME=FXP$E$VOLDOWN,COD#=E$VOLDOWN,SEV#=7);
      118     7857        %ERRCODE(NAME=FXP$E$NOVOL,COD#=E$NOVOL,SEV#=7);
      119     7861        %ERRCODE(NAME=FXP$E$2RECON,COD#=E$2RECON,SEV#=7);
      120     7865        %ERRCODE(NAME=FXP$E$DUPVSN,COD#=E$DUPVSN,SEV#=7);
      121     7869        %ERRCODE(NAME=FMN$E$NOTAUTH,COD#="%(E$NOTAUTH)",MON#='1'B,
      122     7870                 SEV#=7,FCG#='0615'O,MID#='16'O);
      123     7874        %ERRCODE(NAME=FMN$E$XCLSET,COD#="%(E$XCLSET)",MON#='1'B,
      124     7875                 SEV#=7,FCG#='0615'O,MID#='16'O);
      125     7879        %ERRCODE(NAME=FXP$E$NEEDSCR,COD#=E$NEEDSCR,SEV#=7);
      126     7883        %ERRCODE(NAME=FXP$E$PROJCMD,COD#=E$PROJCMD,SEV#=7);
      127     7887        %ERRCODE(NAME=FXP$E$PROJPSN,COD#=E$PROJPSN,SEV#=7);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:119  
      128     7891        %ERRCODE(NAME=FXP$E$PROJDFT,COD#=E$PROJDFT,SEV#=7);
      129     7895        %ERRCODE(NAME=FXP$E$DEFER,COD#=E$DEFER,SEV#=7);
      130     7899        %ERRCODE(NAME=FXP$E$NLIST,COD#=E$NLIST,SEV#=7);
      131     7903        %ERRCODE(NAME=FXP$E$BIGSECT,COD#=E$BIGSECT,SEV#=7);
      132     7907        %FPT_SAD(FPTN=SETSAD,MONSID='6004'O,USERSID='6021'O,STCLASS="CONSTANT SYMDEF");
      133     7922        %FPT_TIME(FPTN=TIMEFPT,DEST=UTS,TSTAMP=TIMEUTS,STCLASS=CONSTANT);
      134     7941        %FPT_TIME(FPTN=TIME_TEXT,STCLASS=CONSTANT,DEST=EXT,SOURCE=UTS,
      135     7942              TSTAMP=TIMEUTS,TIME=TIMETEXT.T,DATE=TIMETEXT.D);
      136     7961    1   DCL TIMES(0:4)CHAR(16)CONSTANT INIT(
      137     7962    1    'Mounted','Dismounted','Accounted','Modified','Created');
      138     7963    1   DCL TIME$(0:4)PTR CONSTANT INIT(
      139     7964    1   ADDR(CODE04.ACCESS),ADDR(CODE04.SVMODIFY),ADDR(CODE04.GAC.TIME),
      140     7965    1   ADDR(CODE04.UPD),ADDR(CODE04.CREATION));
      141     7966        %INCLUDE FX_SUBS_C;
      142     8002        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:120  
      143     8003                    /* STATIC DATA */
      144     8004    1   DCL TEXT(0:255) CHAR(1) STATIC INIT(' '*256);
      145     8005    1   DCL TCXT REDEF TEXT CHAR(256);
      146     8006    1   DCL 1 GBUF REDEF TEXT,
      147     8007    1         2 CODE UBIN(18)UNAL,
      148     8008    1         2 CADDR BIT(18),
      149     8009    1         2 PSN(0:16)CHAR(6),
      150     8010    1         2 * CHAR(150);
      151     8011    1   DCL 1 AVR REDEF TEXT,
      152     8012    1         2 MSG CHAR(10),
      153     8013    1         2 * CHAR(246);
      154     8014    1   DCL SELACCT CHAR(8)STATIC;
      155     8015    1   DCL USW BIT(1)STATIC SYMDEF; /* AND FOLLOWING */
      156     8016    1   DCL 1 WORK_ STATIC DALIGNED,
      157     8017    1         2 SIZE UBIN(18) UNAL,
      158     8018    1         2 FIRST$ PTR INIT(ADDR(NIL));
      159     8019        %FPT_PROMPT(STCLASS=CONSTANT SYMDEF,VFC=YES,PROMPT=PRTXT);
      160     8047    1   DCL PRTXT CONSTANT CHAR(0)INIT('p*');
      161     8048        %P_PCB(R=FXN$CMD,U$=FXP$POPTS);
      162     8247        %FPT_READ(DCB=M$SI,BUF=TEXT);
      163     8286        %FPT_WRITE(FPTN=LOFPT,DCB=M$LO,BUF=TEXT);
      164     8317        %PARSE$OUT;
      165     8362        %PARSE$SYM;
      166     8400        %FPT_GDS(FPTN=WORKFPT,RESULTS=WORK_,SEGSIZE=1024);
      167     8416                    /* ENTRIES */
      168     8417    1   DCL X$PARSE ENTRY(1) ALTRET;
      169     8418    1   DCL X$HELP ENTRY(1) ALTRET;
      170     8419    1   DCL FGG$DONE ENTRY ALTRET;
      171     8420    1   DCL FGG$QUIT ENTRY ALTRET;
      172     8421    1   DCL FXD$PMME ENTRY(1) ALTRET OPTIONAL;
      173     8422    1   DCL FXF$FIX ENTRY(1);
      174     8423    1   DCL FXH$GPSUM ENTRY ALTRET;
      175     8424    1   DCL FXH$RECON ENTRY(1)ALTRET;
      176     8425    1   DCL FXH$RECONT ENTRY ALTRET;
      177     8426    1   DCL FXH$COUNT ENTRY ALTRET;
      178     8427    1   DCL FXP$POPTS ENTRY(1);
      179     8428    1   DCL FXU$PROJAD ENTRY(1) ALTRET;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:121  
      180     8429    1   DCL FXU$PROJAC ENTRY(1) ALTRET;
      181     8430    1   DCL FXU$PROJNA ENTRY(1) ALTRET;
      182     8431    1   DCL FXU$PROJGR ENTRY(1) ALTRET;
      183     8432    1   DCL FXU$PROJDA ENTRY(1) ALTRET;
      184     8433    1   DCL FXU$PROJWR ENTRY ALTRET;
      185     8434    1   DCL FXU$PROTCHK ENTRY(1)ALTRET;
      186     8435    1   DCL FXU$GINIT ENTRY ALTRET;
      187     8436    1   DCL FXU$CATMNT ENTRY(1)ALTRET;
      188     8437    1   DCL FXU$CATADM ENTRY(1)ALTRET;
      189     8438    1   DCL FXU$CATL ENTRY(1)ALTRET;
      190     8439    1   DCL FXU$TRACKER ENTRY(1);
      191     8440    1   DCL FXP$TRAP ENTRY ASYNC;
      192     8441    1   DCL FXP$INT ENTRY ASYNC;
      193     8442    1   DCL FXP$XCON ENTRY ASYNC;
      194     8443    1   DCL FXN$CMD UBIN SYMREF;
      195     8444    1   DCL M$SI DCB;
      196     8445    1   DCL M$LO DCB;
      197     8446    1   DCL M$DO DCB;
      198     8447    1   DCL M$DP DCB;
      199     8448    1   DCL M$CAT DCB;
      200     8449    1   DCL CHAR1 BASED(BLK$) CHAR(1);
      201     8450    1   DCL CHAR4 BASED CHAR(4);
      202     8451    1   DCL BASED_UBIN BASED UBIN ALIGNED;
      203     8452                    /* SCRATCH STORAGE */
      204     8453    1   DCL SYSSIZE UBIN STATIC SYMDEF INIT(0);
      205     8454    1   DCL BLK$ PTR STATIC SYMDEF;
      206     8455    1   DCL ERRCODE STATIC SYMDEF BIT(36);
      207     8456    1   DCL GAC SBIN SYMREF;
      208     8457    1   DCL TIMEUTS STATIC UBIN;
      209     8458    1   DCL I UBIN STATIC;
      210     8459    1   DCL I0 UBIN STATIC;
      211     8460    1   DCL 1 RCNSN SYMREF,2 * CHAR(10);
      212     8461    1   DCL TRAPX BIT(72) STATIC SYMDEF INIT('0'B);
      213     8462    1   DCL TRAPCNT SBIN STATIC SYMDEF INIT(4);
      214     8463    1   DCL P$ PTR STATIC;
      215     8464    1   DCL J UBIN STATIC;
      216     8465    1   DCL LIST_ATTR STATIC BIT(1)INIT('0'B);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:122  
      217     8466    1   DCL ZAP BIT(1)INIT('0'B)STATIC;
      218     8467    1   DCL 1 FLAG STATIC SYMDEF,
      219     8468    1         2 FCG BIT(12) INIT('0'B),
      220     8469    1         2 MID BIT(6) INIT('0'B),
      221     8470    1         2 MON BIT(1) INIT('0'B),
      222     8471    1         2 CODE UBIN(14)UNAL INIT(0),
      223     8472    1         2 SEV UBIN(3)UNAL INIT(0);
      224     8473    1   DCL DPERX BIT(72) STATIC SYMDEF INIT('0'B);
      225     8474    1   DCL XCONWIND BIT(72) SYMREF;
      226     8475    1   DCL SAVUNW BIT(72);
      227     8476    1   DCL NUMSNS UBIN STATIC;
      228     8477    1   DCL X9 UBIN;
      229     8478    1   DCL GRANULE SBIN INIT(0)STATIC;
      230     8479    1   DCL CODE UBIN;
      231     8480    1   DCL USER_NAME CHAR(12) STATIC SYMDEF;
      232     8481    1   DCL USER_ACCN CHAR(8) STATIC SYMDEF;
      233     8482    1   DCL M$DP$ PTR SYMREF;
      234     8483    1   DCL MODE STATIC UBIN INIT(1); /* ZERO => GHOST */
      235     8484    1   DCL M$LO$ PTR STATIC SYMDEF;
      236     8485    1   DCL M$SI$ PTR STATIC SYMDEF;
      237     8486    1   DCL WIDTH UBIN STATIC;
      238     8487    1   DCL BREAK STATIC SYMDEF UBIN INIT(0);
      239     8488    1   DCL BANNERSZ STATIC UBIN INIT(150);
      240     8489    1   DCL F$CFU$ PTR SYMREF READONLY;
      241     8490        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:123  
      242     8491                    /* PROJAD DATA */
      243     8492        %INCLUDE AS_SUPER_C;
      244     8927    1   DCL PROJADCU(0:15) UBIN(9)UNAL CONSTANT INIT(
      245     8928                    /* PERMITTED COMMANDS IN PROJAD MODE */
      246     8929    1   %E$END,%E$XIT,%E$QUIT,%E$CREATE,%E$MODIFY,%E$LIST,%E$DELETE,%E$ATTR,
      247     8930    1   %E$MADLIST,%E$MAKEME,%E$HCMD,%E$QSTNMRK*0);
      248     8931    1   DCL PROJADC REDEF PROJADCU CHAR(16);
      249     8932    1   DCL 1 PROJAD STATIC SYMDEF,
      250     8933    1         2 L UBIN(9)UNAL INIT(0), /* KEY LENGTH */
      251     8934    1         2 ACCT CHAR(8),
      252     8935    1         2 NAME CHAR(12),
      253     8936    1         2 PSN CHAR(6);
      254     8937        %P$PCB(STCLASS=BASED);
      255     9138        %FPT_DEQ(DCB=M$PROJ,STCLASS=CONSTANT,FPTN=DEQPROJ);
      256     9155    1   DCL M$PROJ DCB;
      257     9156        %SUPER_TO_PIG(NAME=S_TO_P,STCLASS="BASED(BLK$)");
      258     9188        %PIG_TO_SUPER(NAME=P_TO_S,STCLASS="BASED(BLK$)");
      259     9199        %VLP_STATION(FPTN=ST,STCLASS=BASED);
      260     9226        %FPT_WRITE(FPTN=WRSUPER,DCB=M$SI);
      261     9257        %FPT_WRITE(FPTN=DEFERFPT,DCB=M$PIGCG,STATION=DEFERST);
      262     9288        %VLP_STATION(FPTN=DEFERST,STCLASS=STATIC,ANYDCB=YES,EOFNONE=YES);
      263     9315    1   DCL M$PIGCG DCB;
      264     9316        %FPT_OPEN (FPTN=RELPIGFIL, DELETE=YES, DCB=M$PIGCG, ASN=FILE);
      265     9425        %FPT_CLOSE (FPTN=RELPIGCG, DISP=RELEASE, DCB=M$PIGCG, STCLASS=CONSTANT);
      266     9467        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:124  
      267     9468        %FM$GRAN(FM$GRAN=GPBUF,BASED="STATIC SYMDEF",
      268     9469        HASH="* INIT(BITBIN('525252525'O))",
      269     9470        GMOD="* INIT(1)",
      270     9471        NAVX="* INIT(5)",
      271     9472        FCEX="* INIT(5)",
      272     9473        AVAIL="* INIT(1019)",
      273     9474        HDR="* INIT('1'B)",
      274     9475        LVL="* INIT(FMGTGP)",
      275     9476        ORG="* INIT(0)",
      276     9477        ENDLVL="* INIT('0'B)",
      277     9478        X="* INIT('0'B)",
      278     9479        KEYCNT="* INIT(0)",
      279     9480        BLINK="* INIT(0)",
      280     9481        FLINK="* INIT(0)");
      281     9485        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:125  
      282     9486        %FM$GRAN(FM$GRAN=MADBUF,BASED=STATIC,
      283     9487        HASH="* INIT(BITBIN('142142142'O))",
      284     9488        GMOD="* INIT(3)",
      285     9489        NAVX="* INIT(SIZEW(MADBUF))",
      286     9490        FCEX="* INIT(5)",
      287     9491        AVAIL="* INIT(949)",
      288     9492        HDR="* INIT('1'B)",
      289     9493        LVL="* INIT(FMGTMAD)",
      290     9494        ORG="* INIT(0)",
      291     9495        ENDLVL="* INIT('0'B)",
      292     9496        X="* INIT('0'B)",
      293     9497        KEYCNT="* INIT(0)",
      294     9498        BLINK="* INIT(0)",
      295     9499        FLINK="* INIT(0)UBIN,2 K(0:69) INIT(BITBIN('430000000000'O),0*0)");
      296     9503        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:126  
      297     9504        %FM$GRAN(FM$GRAN=PADBUF,BASED=STATIC,
      298     9505        HASH="* INIT(BITBIN('274274274'O))",
      299     9506        GMOD="* INIT(2)",
      300     9507        HDR="* INIT('1'B)",
      301     9508        LVL="* INIT(FMGTPAD)",
      302     9509        ORG="* INIT(0)",
      303     9510        ENDLVL="* INIT('0'B)",
      304     9511        X="* INIT('0'B)",
      305     9512        KEYCNT="* INIT(0)",
      306     9513        BLINK="* INIT(0)",
      307     9514        FLINK="* INIT(0)");
      308     9518    1   DCL ITEMXMASK BIT(36)INIT('000000001777'O)CONSTANT;
      309     9519        %FM_FITCODE(NAME=FIT00,CODE=3,NAW=4,STCLASS=STATIC);
      310     9522        %FM_FITCODE(NAME=FIT04,CODE=4,NDW=11,NAW=11,ITEMX=4,STCLASS=STATIC);
      311     9525    1   DCL 1 FIT14 STATIC,
      312     9526    1         2 * UBIN(5)UNAL INIT(14),
      313     9527    1         2 NAW UBIN(11)INIT(8)UNAL,
      314     9528    1         2 NDW UBIN(10)INIT(8)UNAL,
      315     9529    1         2 * UBIN(10)INIT(15)UNAL;
      316     9530    1   DCL 1 FIT09 STATIC,
      317     9531    1         2 * UBIN(5) UNAL INIT(9),
      318     9532    1         2 NAW UBIN(11) UNAL INIT(0),
      319     9533    1         2 NDW UBIN(10) UNAL INIT(0),
      320     9534    1         2 ITEMX UBIN(10)INIT(143)UNAL;
      321     9535        %CODE04(BASED=STATIC,UBIN="INIT(0)UBIN",CHAR="INIT(' ')CHAR",MODIFY=UPD);
      322     9543        %CODE14(BASED=STATIC,MAX=24,
      323     9544        WCDATA="WCDATA INIT('0'B)",
      324     9545        LIST="LIST INIT('0'B)",
      325     9546        WRCMP="WRCMP INIT('0'B)",
      326     9547        OWNERF="OWNERF INIT('1'B)",
      327     9548        BUPF="BUPF INIT('1'B)",
      328     9549        BUPM="BUPM INIT('0'B)",
      329     9550        NOACUP="NOACUP INIT('0'B)",
      330     9551        NPUR="NPUR INIT('0'B)",
      331     9552        NOSTOW="NOSTOW INIT('0'B)",
      332     9553           MERGEAC="MERGEAC INIT('0'B)",
      333     9554        GACSHELF="GACSHELF INIT('0'B)",
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:127  
      334     9555        NEWFD="NEWFD INIT('0'B)",
      335     9556        X="X INIT('0'B)",
      336     9557        DFLTALL="DFLTALL INIT(%FFLG_READ#)",
      337     9558        CGMEM="CGMEM INIT(0)",
      338     9559        MGRANS="MGRANS INIT(1000)",
      339     9560        CGRANS="CGRANS INIT(0)",
      340     9561        CHAR="INIT(' '*0)CHAR");
      341     9571    1   DCL 1 CODE09(0:199) UNAL STATIC,
      342     9572    1         2 FFLG BIT(18),
      343     9573    1         2 ACCT CHAR(8);
      344     9574    1   DCL 1 FITMOVER BASED,2 * CHAR(FITSIZE);
      345     9575    1   DCL DEFAULT_BUILD(0:722)UBIN;
      346     9576    1   DCL FITSIZE UBIN STATIC INIT(112);
      347     9577        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:128  
      348     9578        %LIST;
      349     9579        %FM$VID(FM$VID=VIDBUF,BASED="STATIC SYMDEF");
              9580    1   DCL 1 FM$VID BASED ALIGNED,2 ID CHAR(4),2 INSTID BIT(36),2 VSN UBIN,2 PSN CHAR(6),2
              9580            VOLCNT UBIN HALF UNAL,2 SYSSIZE UBIN,2 SYSDIRDA
              9581    1  UBIN WORD,2 INITTIME UBIN,2 SECTSTRT(0:25)UBIN,2 MIRROR ALIGNED,3 C CHAR(8)CALIGNED,
              9581            3 UTS UBIN ALIGNED,3 STATE(0:1)UBIN(6)UNAL,3 *
              9582    1  BIT(24),2 *(0:153)UBIN,2 DGT(0:63),3 FGRAN UBIN(18)UNAL,3 LGRAN UBIN(18)UNAL,2 DTT(0
              9582            :63)UBIN(18),2 DT(0:63)REDEF DTT,3 CYL UBIN(10)
              9583    1  UNAL,3 HD UBIN(8)UNAL,3 * BIT(18),2 SNLIST(0:175),3 VSN,4 S UBIN BYTE UNAL,4 N UBIN(
              9583            27)UNAL,3 SIZE UBIN,3 TYPE CHAR(8);
      350     9585    1   DCL WBUF(0:1023) REDEF VIDBUF UBIN;
      351     9586        %FM$FIT(FM$FIT=FIT,BASED=REDEF VIDBUF,N=1023);
              9587    1  DCL 1 FM$FIT BASED ALIGNED,2 CODES(0:N),3 CODE UBIN(5)UNAL,3 * BIT(1),3 NAW UBIN(10)
              9587            UNAL,3 NDW UBIN(10)UNAL,3 ITEMX UBIN(10)UNAL;
      352     9589        %SUB NUMPSNS=CSTAT.NUM/*NUMPSNS*/;
      353     9590        %FX$STAT(FX$STAT=CSTAT,BASED="STATIC SYMDEF",PSN="PSN INIT('SYS',' '*0)",
      354     9591           MAX=510,
      355     9592           UBIN="INIT(0*0)UBIN");
              9593    1  DCL 1 FX$STAT BASED ALIGNED,2 NUM UBIN,2 DEFMOUNT UBIN,2 SETS(0:MAX),3 PSN CHAR(6),3
              9593            DISP UBIN BYTE UNAL,3 SETX UBIN BYTE UNAL;
      356     9595        %FM$VID(FM$VID=VID1,BASED=REDEF CSTAT);
              9596    1   DCL 1 FM$VID BASED ALIGNED,2 ID CHAR(4),2 INSTID BIT(36),2 VSN UBIN,2 PSN CHAR(6),2
              9596            VOLCNT UBIN HALF UNAL,2 SYSSIZE UBIN,2 SYSDIRDA
              9597    1  UBIN WORD,2 INITTIME UBIN,2 SECTSTRT(0:25)UBIN,2 MIRROR ALIGNED,3 C CHAR(8)CALIGNED,
              9597            3 UTS UBIN ALIGNED,3 STATE(0:1)UBIN(6)UNAL,3 *
              9598    1  BIT(24),2 *(0:153)UBIN,2 DGT(0:63),3 FGRAN UBIN(18)UNAL,3 LGRAN UBIN(18)UNAL,2 DTT(0
              9598            :63)UBIN(18),2 DT(0:63)REDEF DTT,3 CYL UBIN(10)
              9599    1  UNAL,3 HD UBIN(8)UNAL,3 * BIT(18),2 SNLIST(0:175),3 VSN,4 S UBIN BYTE UNAL,4 N UBIN(
              9599            27)UNAL,3 SIZE UBIN,3 TYPE CHAR(8);
      357     9601        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:129  
      358     9602    1   DCL ERRVEC(0:19)BIT(72)CONSTANT INIT(
      359     9603    1   VECTOR(ERRDUBDEF),VECTOR(ERRSYN),VECTOR(LBUF),VECTOR(LBUF),
      360     9604    1   VECTOR(TCXT),VECTOR(ERRSI),VECTOR(UNCMD),VECTOR(VALMSG),
      361     9605    1   VECTOR(LISTH1),VECTOR(LISTH2),VECTOR(LBUF),'0'B*0);
      362     9606    1   DCL UNCMD CONSTANT CHAR(0)INIT(
      363     9607    1   ' **** Pigs don''t know how to do that.');
      364     9608    1   DCL NONEMSG CONSTANT CHAR(0) INIT(
      365     9609    1   ' ** None found.');
      366     9610    1   DCL ERRDUBDEF CONSTANT CHAR(0) INIT(
      367     9611    1   ' Reconstruct for information purposes only.');
      368     9612    1   DCL 1 ERRSYN STATIC,
      369     9613    1         2 * CHAR(0)INIT(' **** Syntax error after '),
      370     9614    1         2 T CHAR(21);
      371     9615    1   DCL 1 VALMSG STATIC,2 * CHAR(0) INIT(
      372     9616    1   ' **** Too many values or a bad one after '),
      373     9617    1         2 T CHAR(21);
      374     9618    1   DCL 1 LISTH1 STATIC,
      375     9619    1         2 * CHAR(0) INIT('DP#'),
      376     9620    1         2 PSN CHAR(6),
      377     9621    1         2 * CHAR(0) INIT(
      378     9622    1           '                  ACCESS');
      379     9623    1   DCL LISTH2 CONSTANT CHAR(0) INIT(
      380     9624    1   'ACCOUNT   #GRANULES USED   ReadDelrecWnewUpdateScratchNolistFitmodExecCreate');
      381     9625        %OC_MESSHD_D(NAME=WROC,NPARMS=8,D='DP010000');
              9626    1   DCL 1 NAME STCLASS,
              9627    1            2 CADDR BIT(18) INIT(ATR) UNAL,
              9628    1            2 MSG# UBIN HALF INIT(MSG) UNAL,
              9629    1            2 MSGID UBIN HALF UNAL,
              9630    1            2 SYSID REDEF MSGID SBIN HALF UNAL,
              9631    1            2 NPARAMS UBIN BYTE INIT(NPARMS) UNAL,
              9632    1            2 FCN UBIN BYTE UNAL INIT(FUNC),
              9633    1            2 FLAGS BIT(9) UNAL INIT(FLGS),
              9634    1            2 PFB REDEF FLAGS UBIN BYTE UNAL,
              9635    1            2 * UBIN(27) UNAL,
              9636    1            2 DEVNM CHAR(8) INIT(D) UNAL DELIM
      382     9638    1         2 *(0:7)UBIN BYTE UNAL INIT(4,6,2,1,1,6,64,0),
      383     9639    1         2 VSN SBIN,
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:130  
      384     9640    1         2 PSN CHAR(6),
      385     9641    1         2 N UBIN HALF UNAL,
      386     9642    1         2 VOL UBIN BYTE UNAL,
      387     9643    1         2 SECT CHAR(1),
      388     9644    1         2 DPSN CHAR(6);
      389     9645    1   DCL LBUFC CHAR(120)INIT('Pig XXX Here')STATIC;
      390     9646    1   DCL 1 LBUF REDEF LBUFC,
      391     9647    1         2 ACCT CHAR(9),
      392     9648    1         2 * CHAR(1),
      393     9649    1         2 CGRANS CHAR(5),
      394     9650    1         2 * CHAR(4),
      395     9651    1         2 MGRANS CHAR(5),
      396     9652    1         2 * CHAR(3),
      397     9653    1         2 REST CHAR(93);
      398     9654    1   DCL 1 DBUF REDEF LBUFC,
      399     9655    1         2 * CHAR(2),
      400     9656    1         2 DEV CHAR(2),
      401     9657    1         2 * CHAR(116);
      402     9658    1   DCL 1 TIMETEXT REDEF LBUFC,
      403     9659    1         2 * CHAR(10),
      404     9660    1         2 TYP CHAR(12),
      405     9661    1         2 T CHAR(12),
      406     9662    1         2 D CHAR(10),
      407     9663    1         2 B CHAR(76);
      408     9664    1   DCL 1 LBUF0 CONSTANT CHAR(0) INIT(
      409     9665    1           '-DEFAULT-     0 of 00000');
      410     9666    1   DCL FFLGS(0:15)BIT(36) CONSTANT INIT(
      411     9667    1   %FFLG_READ#,%FFLG_DELR#,%FFLG_WNEW#,
      412     9668    1   %FFLG_UPD#,%FFLG_DELF#,%FFLG_NOLIST#,
      413     9669    1   %FFLG_REATTR#,%FFLG_EXEC#,%FFLG_CREATE#,%FFLG_WRITE#,'0'B*0);
      414     9670    1   DCL FFLGC(0:15) CONSTANT CHAR(8)INIT(
      415     9671    1         'Read','Delr','Wnew','Upd','Scratch','Nolist',
      416     9672    1         'Fitmod','Exec','Create','Write','None'*0);
      417     9673    1   DCL ERRSI CONSTANT CHAR(0) INIT(
      418     9674    1   ' **** COMMAND ABORTED');
      419     9675    1   DCL B_VERSION CHAR(1) SYMREF;
      420     9676    1   DCL 1 B$VERSIONB BASED,
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:131  
      421     9677    1         2 C_ UBIN BYTE CALIGNED,
      422     9678    1         2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
      423     9679        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:132  
      424     9680    1      CALL M$PROMPT(FPT_PROMPT);

   9680 10 000002   000140 630400 2                  EPPR0   FPT_PROMPT
        10 000003   160002 713400                    CLIMB   57346
        10 000004   401000 401760                    pmme    nvectors=3

      425     9681    1      USER_NAME=B$JIT.UNAME;

   9681 10 000005   000000 470400 xsym               LDP0    B$JIT$
        10 000006   040000 100500                    MLR     fill='040'O
        10 000007   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 000010   001114 000014 0                  ADSC9   USER_NAME                cn=0,n=12

      426     9682    1      USER_ACCN=B$JIT.ACCN;

   9682 10 000011   040000 100500                    MLR     fill='040'O
        10 000012   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 000013   001117 000010 0                  ADSC9   USER_ACCN                cn=0,n=8

      427     9683    1      IF WORK_.FIRST$=ADDR(NIL) THEN CALL M$GDS(WORKFPT);

   9683 10 000014   001013 236000 0                  LDQ     WORK_+1
        10 000015   000001 116000 xsym               CMPQ    B_VECTNIL+1
        10 000016   000022 601000 10                 TNZ     s:9684

   9683 10 000017   001064 630400 0                  EPPR0   WORKFPT
        10 000020   030001 713400                    CLIMB   gds
        10 000021   400400 401760                    pmme    nvectors=2

      428     9684    1      CALL M$INT(FPT_INT);

   9684 10 000022   000434 630400 0                  EPPR0   FPT_INT
        10 000023   010002 713400                    CLIMB   4098
        10 000024   400000 401760                    pmme    nvectors=1

      429     9685    1      CALL M$TRAP(FPT_TRAP);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:133  
   9685 10 000025   000644 630400 0                  EPPR0   FPT_TRAP
        10 000026   010004 713400                    CLIMB   4100
        10 000027   400400 401760                    pmme    nvectors=2

      430     9686    1      CALL M$XCON(FPT_XCON);

   9686 10 000030   000020 630400 2                  EPPR0   FPT_XCON
        10 000031   010003 713400                    CLIMB   4099
        10 000032   400400 401760                    pmme    nvectors=2

      431     9687    1      CALL M$RPRIV(PPRIVFPT);

   9687 10 000033   000014 630400 2                  EPPR0   PPRIVFPT
        10 000034   020013 713400                    CLIMB   8203
        10 000035   400000 401760                    pmme    nvectors=1

      432     9688    1      CALL CONCAT (LBUFC,'Pig ',ADDR(B_VERSION)->B$VERSIONB.T_,' here  ');

   9688 10 000036   000000 236000 xsym               LDQ     B_VERSION
        10 000037   000033 772000                    QRL     27
        10 000040   000000 620006                    EAX0    0,QL
        10 000041   000473 236000 2                  LDQ     FFLGS+20
        10 000042   006702 756000 0                  STQ     LBUFC
        10 000043   040000 100440                    MLR     fill='040'O
        10 000044   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
        10 000045   006703 000164 0                  ADSC9   LBUFC+1                  cn=0,n=116
        10 000046   000000 636010                    EAQ     0,X0
        10 000047   000022 772000                    QRL     18
        10 000050   000164 116007                    CMPQ    116,DL
        10 000051   000062 603000 10                 TRC     s:9689
        10 000052   201346 740100                    STX0    BXP+1,,AUTO
        10 000053   777613 620010                    EAX0    -117,X0
        10 000054   777777 660003                    ERX0    -1,DU
        10 000055   201346 235100                    LDA     BXP+1,,AUTO
        10 000056   000022 771000                    ARL     18
        10 000057   040045 100400                    MLR     fill='040'O
        10 000060   000474 000007 2                  ADSC9   FFLGS+21                 cn=0,n=7
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:134  
        10 000061   006703 000010 0                  ADSC9   LBUFC+1,A                cn=0,n=*X0

      433     9689    1      IF NOT B$JIT.PPRIV.PADMIN OR B$JIT.USER=JG_PIG# THEN CALL SET_PRIV;

   9689 10 000062   000000 470400 xsym               LDP0    B$JIT$
        10 000063   000020 236100                    LDQ     16,,PR0
        10 000064   000010 316003                    CANQ    8,DU
        10 000065   000072 600000 10                 TZE     s:9689+8
        10 000066   000000 236100                    LDQ     0,,PR0
        10 000067   000777 376003                    ANQ     511,DU
        10 000070   000007 116003                    CMPQ    7,DU
        10 000071   000075 601000 10                 TNZ     s:9691

   9689 10 000072   013176 701000 10                 TSX1    SET_PRIV
        10 000073   000000 011000                    NOP     0
        10 000074   000150 710000 10                 TRA     s:9702

      434     9690    2      ELSE DO;

      435     9691    2         PROJAD.NAME=B$JIT.UNAME;

   9691 10 000075   040000 100500                    MLR     fill='040'O
        10 000076   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 000077   001131 200014 0                  ADSC9   PROJAD+2                 cn=1,n=12

      436     9692    2         PROJAD.ACCT=B$JIT.ACCN;

   9692 10 000100   040000 100500                    MLR     fill='040'O
        10 000101   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 000102   001127 200010 0                  ADSC9   PROJAD                   cn=1,n=8

      437     9693    2         CALL FXU$PROJAD;

   9693 10 000103   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000104   000000 701000 xent               TSX1    FXU$PROJAD
        10 000105   000000 011000                    NOP     0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:135  
      438     9694    2         IF PROJAD.L=0 THEN CALL SET_PRIV;

   9694 10 000106   001127 236000 0                  LDQ     PROJAD
        10 000107   777000 316003                    CANQ    -512,DU
        10 000110   000114 601000 10                 TNZ     s:9696

   9694 10 000111   013176 701000 10                 TSX1    SET_PRIV
        10 000112   000000 011000                    NOP     0
        10 000113   000150 710000 10                 TRA     s:9702

      439     9695    3         ELSE DO;

      440     9696    3            IF PROJAD.L<20 THEN ERRSYN.T='No Packset';

   9696 10 000114   001127 236000 0                  LDQ     PROJAD
        10 000115   777000 376003                    ANQ     -512,DU
        10 000116   024000 116003                    CMPQ    10240,DU
        10 000117   000124 603000 10                 TRC     s:9697

   9696 10 000120   040000 100400                    MLR     fill='040'O
        10 000121   000476 000012 2                  ADSC9   FFLGS+23                 cn=0,n=10
        10 000122   006627 200025 0                  ADSC9   ERRSYN+6                 cn=1,n=21
        10 000123   000132 710000 10                 TRA     s:9698

      441     9697    3            ELSE CALL CONCAT(ERRSYN.T,'Set #',PROJAD.PSN);

   9697 10 000124   040000 100400                    MLR     fill='040'O
        10 000125   000501 000005 2                  ADSC9   FFLGS+26                 cn=0,n=5
        10 000126   006627 200005 0                  ADSC9   ERRSYN+6                 cn=1,n=5
        10 000127   040000 100400                    MLR     fill='040'O
        10 000130   001134 200006 0                  ADSC9   PROJAD+5                 cn=1,n=6
        10 000131   006630 400020 0                  ADSC9   ERRSYN+7                 cn=2,n=16

      442     9698    3            CALL INDEX2(I,'  ',LBUFC);

   9698 10 000132   000000 120400                    SCD
        10 000133   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:136  
        10 000134   000503 000002 2                  ADSC9   FFLGS+28                 cn=0,n=2
        10 000135   001076 000000 0                  ARG     I
        10 000136   000140 607000 10                 TTF     s:9699
        10 000137   001076 054000 0                  AOS     I

      443     9699    3            CALL INSERT(LBUFC,I,80,' - Project Administrator Mode - ',ERRSYN.T);

   9699 10 000140   001076 235000 0                  LDA     I
        10 000141   040005 100400                    MLR     fill='040'O
        10 000142   000504 000040 2                  ADSC9   FFLGS+29                 cn=0,n=32
        10 000143   006702 000040 0                  ADSC9   LBUFC,A                  cn=0,n=32
        10 000144   001076 235000 0                  LDA     I
        10 000145   040005 100400                    MLR     fill='040'O
        10 000146   006627 200025 0                  ADSC9   ERRSYN+6                 cn=1,n=21
        10 000147   006712 000060 0                  ADSC9   LBUFC+8,A                cn=0,n=48

      444     9700    3            END;

      445     9701    2         END;

      446     9702    1      OCMSG.BUF_.BOUND=SIZEV(WROC)+64;

   9702 10 000150   000362 236000 0                  LDQ     OCMSG+4
        10 000151   177777 376007                    ANQ     65535,DL
        10 000152   000000 276000 11                 ORQ     0
        10 000153   000362 756000 0                  STQ     OCMSG+4

      447     9703    1      M$LO$=DCBADDR(DCBNUM(M$LO));

   9703 10 000154   000000 236007 xsym               LDQ     M$LO,DL
        10 000155   000001 470400 11                 LDP0    1
        10 000156   000000 471500                    LDP1    0,,PR0
        10 000157   100000 236106                    LDQ     0,QL,PR1
        10 000160   001122 756000 0                  STQ     M$LO$

      448     9704    1      DEFAULT_BUILD=ADDR(PADBUF)->FITMOVER;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:137  
   9704 10 000161   002620 720000 0                  LXL0    FITSIZE
        10 000162   000100 100440                    MLR     fill='000'O
        10 000163   001410 000010 0                  ADSC9   PADBUF                   cn=0,n=*X0
        10 000164   200010 005514                    ADSC9   DEFAULT_BUILD,,AUTO      cn=0,n=2892

      449     9705    1      M$SI$=DCBADDR(DCBNUM(M$SI));

   9705 10 000165   000000 236007 xsym               LDQ     M$SI,DL
        10 000166   100000 236106                    LDQ     0,QL,PR1
        10 000167   001123 756000 0                  STQ     M$SI$

      450     9706    1      P_PCB.TEXT$=PINCRC(WORK_.FIRST$,1);

   9706 10 000170   001013 236000 0                  LDQ     WORK_+1
        10 000171   200000 036007                    ADLQ    65536,DL
        10 000172   001014 756000 0                  STQ     P_PCB

      451     9707    1      IF B$JIT.USER=JG_PIG# THEN GOTO NEXT;

   9707 10 000173   000000 473400 xsym               LDP3    B$JIT$
        10 000174   300000 236100                    LDQ     0,,PR3
        10 000175   000777 376003                    ANQ     511,DU
        10 000176   000007 116003                    CMPQ    7,DU
        10 000177   000204 600000 10                 TZE     NEXT

      452     9708    1      CALL ERROR(3);

   9708 10 000200   000002 236000 11                 LDQ     2
        10 000201   201341 756100                    STQ     P$+2,,AUTO
        10 000202   011704 701000 10                 TSX1    ERROR
        10 000203   000000 011000                    NOP     0

   9707 10 000204                       NEXT         null
      453     9709    1   NEXT:;
      454     9710    1      CALL CLOSE(DCBNUM(M$CAT));

   9710 10 000204   000000 236007 xsym               LDQ     M$CAT,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:138  
        10 000205   201351 756100                    STQ     BXP+4,,AUTO
        10 000206   201351 630500                    EPPR0   BXP+4,,AUTO
        10 000207   201341 450500                    STP0    P$+2,,AUTO
        10 000210   012416 701000 10                 TSX1    CLOSE
        10 000211   000000 011000                    NOP     0

      455     9711    1      ERRCODE=FLAG; /* SAVE ERRCODE FOR ? COMMAND */

   9711 10 000212   001107 236000 0                  LDQ     FLAG
        10 000213   001074 756000 0                  STQ     ERRCODE

      456     9712    1      CALL M$RPRIV(PRIVFPT)ALTRET(NOALT);

   9712 10 000214   000634 630400 0                  EPPR0   PRIVFPT
        10 000215   420013 713400                    CLIMB   alt,+8203
        10 000216   400000 401760                    pmme    nvectors=1
        10 000217   014123 702000 10                 TSX2    NOALT

      457     9713    1      CALL M$SAD(SETSAD)ALTRET(NOALT);

   9713 10 000220   000052 630400 2                  EPPR0   SETSAD
        10 000221   430015 713400                    CLIMB   alt,+12301
        10 000222   400000 401760                    pmme    nvectors=1
        10 000223   014123 702000 10                 TSX2    NOALT

      458     9714    1      CALL M$RPRIV(DIAGFPT)ALTRET(NOALT);

   9714 10 000224   000640 630400 0                  EPPR0   DIAGFPT
        10 000225   420013 713400                    CLIMB   alt,+8203
        10 000226   400000 401760                    pmme    nvectors=1
        10 000227   014123 702000 10                 TSX2    NOALT

      459     9715    1      IF PROJAD.L~=0 THEN CALL M$DEQ(DEQPROJ)ALTRET(NOALT);

   9715 10 000230   001127 236000 0                  LDQ     PROJAD
        10 000231   777000 316003                    CANQ    -512,DU
        10 000232   000237 600000 10                 TZE     s:9716
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:139  

   9715 10 000233   000160 630400 2                  EPPR0   DEQPROJ
        10 000234   420003 713400                    CLIMB   alt,+8195
        10 000235   401000 401760                    pmme    nvectors=3
        10 000236   014123 702000 10                 TSX2    NOALT

      460     9716    2      IF BLK$~=WORK_.FIRST$ AND MODE=0 THEN DO;

   9716 10 000237   001073 236000 0                  LDQ     BLK$
        10 000240   001013 116000 0                  CMPQ    WORK_+1
        10 000241   000304 600000 10                 TZE     s:9725
        10 000242   001121 235000 0                  LDA     MODE
        10 000243   000304 601000 10                 TNZ     s:9725

      461     9717    2         WRSUPER.STATION_=VECTOR(M$SI$->F$DCB.LASTSTA$->ST);

   9717 10 000244   001123 470400 0                  LDP0    M$SI$
        10 000245   000007 471500                    LDP1    7,,PR0
        10 000246   000003 235000 11                 LDA     3
        10 000247   201346 451500                    STP1    BXP+1,,AUTO
        10 000250   201346 236100                    LDQ     BXP+1,,AUTO
        10 000251   001144 757000 0                  STAQ    WRSUPER+6

      462     9718    2         WRSUPER.BUF_.BUF$=BLK$;

   9718 10 000252   001073 236000 0                  LDQ     BLK$
        10 000253   001143 756000 0                  STQ     WRSUPER+5

      463     9719    2         WRSUPER.BUF_.BOUND=P_TO_S.COUNT+SIZEV(P_TO_S)-SIZEC(P_TO_S.TEXT);

   9719 10 000254   001073 471400 0                  LDP1    BLK$
        10 000255   100001 236100                    LDQ     1,,PR1
        10 000256   000022 772000                    QRL     18
        10 000257   000006 036007                    ADLQ    6,DL
        10 000260   000020 736000                    QLS     16
        10 000261   001142 676000 0                  ERQ     WRSUPER+4
        10 000262   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:140  
        10 000263   001142 656000 0                  ERSQ    WRSUPER+4

      464     9720    2         IF M$SI$->F$DCB.LASTSTA$->ST.STATION#='PIG' THEN CALL UNDEFER1;

   9720 10 000264   000007 473500                    LDP3    7,,PR0
        10 000265   040000 106500                    CMPC    fill='040'O
        10 000266   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
        10 000267   000514 000003 2                  ADSC9   FFLGS+37                 cn=0,n=3
        10 000270   000274 601000 10                 TNZ     s:9721

   9720 10 000271   013370 701000 10                 TSX1    UNDEFER1
        10 000272   000000 011000                    NOP     0
        10 000273   000300 710000 10                 TRA     s:9722

      465     9721    2         ELSE CALL M$WRITE(WRSUPER)ALTRET(NOALT);

   9721 10 000274   001136 630400 0                  EPPR0   WRSUPER
        10 000275   440001 713400                    CLIMB   alt,write
        10 000276   401400 401760                    pmme    nvectors=4
        10 000277   014123 702000 10                 TSX2    NOALT

      466     9722    2         PROJAD.L=0;

   9722 10 000300   000000 236003                    LDQ     0,DU
        10 000301   001127 552040 0                  STBQ    PROJAD,'40'O

      467     9723    2         CALL SET_PRIV;

   9723 10 000302   013176 701000 10                 TSX1    SET_PRIV
        10 000303   000000 011000                    NOP     0

      468     9724    2         END;

      469     9725    1      FLAG=ERRCODE;

   9725 10 000304   001074 236000 0                  LDQ     ERRCODE
        10 000305   001107 756000 0                  STQ     FLAG
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:141  

      470     9726    2      DO WHILE(WROC.MSG#=PREZAP_MSG#);

   9726 10 000306   006666 720000 0                  LXL0    WROC
        10 000307   001777 100003                    CMPX0   1023,DU
        10 000310   000317 601000 10                 TNZ     s:9729

      471     9727    2         CALL M$WAIT(WAIT1);

   9727 10 000311   000026 630400 2                  EPPR0   WAIT1
        10 000312   020006 713400                    CLIMB   8198
        10 000313   400400 401760                    pmme    nvectors=2

      472     9728    2         END;

   9728 10 000314   006666 720000 0                  LXL0    WROC
        10 000315   001777 100003                    CMPX0   1023,DU
        10 000316   000311 600000 10                 TZE     s:9727

      473     9729    2      IF B$JIT.USER=JG_PIG# AND MODE~=0 THEN DO;

   9729 10 000317   000000 470400 xsym               LDP0    B$JIT$
        10 000320   000000 236100                    LDQ     0,,PR0
        10 000321   000777 376003                    ANQ     511,DU
        10 000322   000007 116003                    CMPQ    7,DU
        10 000323   000602 601000 10                 TNZ     s:9786
        10 000324   001121 235000 0                  LDA     MODE
        10 000325   000602 600000 10                 TZE     s:9786

      474     9730    2         CALL CATREAD;

   9730 10 000326   012341 701000 10                 TSX1    CATREAD
        10 000327   000000 011000                    NOP     0

      475     9731    2         BLK$=WORK_.FIRST$;

   9731 10 000330   001013 236000 0                  LDQ     WORK_+1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:142  
        10 000331   001073 756000 0                  STQ     BLK$

      476     9732    2         OUT$SYM.COUNT=79;

   9732 10 000332   001073 470400 0                  LDP0    BLK$
        10 000333   117000 236003                    LDQ     40448,DU
        10 000334   000004 552140                    STBQ    4,'40'O,PR0

      477     9733    2         OUT$SYM='0'B;

   9733 10 000335   001073 470400 0                  LDP0    BLK$
        10 000336   000004 236100                    LDQ     4,,PR0
        10 000337   000033 772000                    QRL     27
        10 000340   000021 620006                    EAX0    17,QL
        10 000341   000140 100400                    MLR     fill='000'O
        10 000342   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        10 000343   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      478     9734    2         OUT$BLK.NSUBLKS=3;

   9734 10 000344   000003 220003                    LDX0    3,DU
        10 000345   001073 470400 0                  LDP0    BLK$
        10 000346   000001 740100                    STX0    1,,PR0

      479     9735    2         OUT$BLK.SUBLK$(0)=BLK$;

   9735 10 000347   001073 236000 0                  LDQ     BLK$
        10 000350   001073 470400 0                  LDP0    BLK$
        10 000351   000003 756100                    STQ     3,,PR0

      480     9736    2         OUT$BLK.SUBLK$(1)=PINCRW(BLK$,SIZEW(OUT$BLK)+2);

   9736 10 000352   001073 236000 0                  LDQ     BLK$
        10 000353   000006 036003                    ADLQ    6,DU
        10 000354   001073 470400 0                  LDP0    BLK$
        10 000355   000004 756100                    STQ     4,,PR0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:143  
      481     9737    2         OUT$BLK.SUBLK$(2)=PINCRW(BLK$,2*SIZEW(OUT$BLK)+4);

   9737 10 000356   001073 236000 0                  LDQ     BLK$
        10 000357   000014 036003                    ADLQ    12,DU
        10 000360   001073 470400 0                  LDP0    BLK$
        10 000361   000005 756100                    STQ     5,,PR0

      482     9738    2         OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT=6;

   9738 10 000362   001073 470400 0                  LDP0    BLK$
        10 000363   000004 471500                    LDP1    4,,PR0
        10 000364   006000 236003                    LDQ     3072,DU
        10 000365   100004 552140                    STBQ    4,'40'O,PR1

      483     9739    2         OUT$BLK.SUBLK$(2)->OUT$SYM.COUNT=6;

   9739 10 000366   001073 470400 0                  LDP0    BLK$
        10 000367   000005 471500                    LDP1    5,,PR0
        10 000370   100004 552140                    STBQ    4,'40'O,PR1

      484     9740    2         CALL M$EVENT(FPT_INT);

   9740 10 000371   000434 630400 0                  EPPR0   FPT_INT
        10 000372   010001 713400                    CLIMB   4097
        10 000373   400000 401760                    pmme    nvectors=1

      485     9741    2         CALL FXU$GINIT;

   9741 10 000374   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000375   000000 701000 xent               TSX1    FXU$GINIT
        10 000376   000000 011000                    NOP     0

      486     9742    2         I=FM$CFUX.DSETH; /* FIRST AVR EVERYTHING */

   9742 10 000377   000000 470400 xsym               LDP0    F$CFU$
        10 000400   000005 236100                    LDQ     5,,PR0
        10 000401   777777 376007                    ANQ     -1,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:144  
        10 000402   001076 756000 0                  STQ     I

      487     9743    3         DO WHILE(I~=0); /* SO THAT WHEN COLD BOOT AVRS COME, */

   9743 10 000403   000443 600000 10                 TZE     s:9753

      488     9744    4            IF FM$DEV.SPIN(I) THEN DO; /* SET STATUS IS RIGHT EVEN ON 1ST VOL */

   9744 10 000404   001076 235000 0                  LDA     I
        10 000405   000003 735000                    ALS     3
        10 000406   000000 470400 xsym               LDP0    F$CFU$
        10 000407   000002 236105                    LDQ     2,AL,PR0
        10 000410   004000 316003                    CANQ    2048,DU
        10 000411   000423 600000 10                 TZE     s:9750

      489     9745    4               FM$DEV.AVR(I)='1'B;

   9745 10 000412   010000 236003                    LDQ     4096,DU
        10 000413   000002 256105                    ORSQ    2,AL,PR0

      490     9746    5               CALL M$OPEN(OPNDP)WHENRETURN DO;

   9746 10 000414   000100 630400 0                  EPPR0   OPNDP
        10 000415   450000 713400                    CLIMB   alt,open
        10 000416   410400 401760                    pmme    nvectors=18
        10 000417   000423 702000 10                 TSX2    s:9750

      491     9747    5                  CALL M$CLOSE(CLSDP);

   9747 10 000420   000172 630400 0                  EPPR0   CLSDP
        10 000421   050001 713400                    CLIMB   close
        10 000422   406000 401760                    pmme    nvectors=13

      492     9748    5                  END;

      493     9749    4               END;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:145  
      494     9750    3            IF FM$DEV.SECTL(I)~=0 THEN I=FM$DEV.SECTL(I);

   9750 10 000423   001076 235000 0                  LDA     I
        10 000424   000003 735000                    ALS     3
        10 000425   000000 470400 xsym               LDP0    F$CFU$
        10 000426   000005 720105                    LXL0    5,AL,PR0
        10 000427   000434 600000 10                 TZE     s:9751

   9750 10 000430   000005 236105                    LDQ     5,AL,PR0
        10 000431   777777 376007                    ANQ     -1,DL
        10 000432   001076 756000 0                  STQ     I
        10 000433   000442 710000 10                 TRA     s:9752

      495     9751    3            ELSE I=FM$DEV.DEVL(FM$VOL.DCTX(I));

   9751 10 000434   000000 236105                    LDQ     0,AL,PR0
        10 000435   000017 772000                    QRL     15
        10 000436   000004 376000 11                 ANQ     4
        10 000437   000005 236106                    LDQ     5,QL,PR0
        10 000440   000022 772000                    QRL     18
        10 000441   001076 756000 0                  STQ     I

      496     9752    3            END;

   9752 10 000442   000404 601000 10                 TNZ     s:9744

      497     9753    2         MODE=0;

   9753 10 000443   001121 450000 0                  STZ     MODE

      498     9754    2         GBUF.CODE=0;

   9754 10 000444   000000 220003                    LDX0    0,DU
        10 000445   000706 740000 0                  STX0    TEXT

      499     9755    2         IF CSTAT.SETS.SETX(0)~=0 THEN GBUF.CADDR='0'B;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:146  
   9755 10 000446   004624 236000 0                  LDQ     CSTAT+3
        10 000447   000777 316007                    CANQ    511,DL
        10 000450   000454 600000 10                 TZE     s:9757

   9755 10 000451   000000 221003                    LDX1    0,DU
        10 000452   000706 441000 0                  SXL1    TEXT
        10 000453   000522 710000 10                 TRA     s:9770

      500     9756    3         ELSE DO;

      501     9757    3            GBUF.CADDR=M_DISK;

   9757 10 000454   100000 221003                    LDX1    32768,DU
        10 000455   000706 441000 0                  SXL1    TEXT

      502     9758    3            GBUF.PSN(0)='*INIT*';

   9758 10 000456   040000 100400                    MLR     fill='040'O
        10 000457   000515 000006 2                  ADSC9   FFLGS+38                 cn=0,n=6
        10 000460   000707 000006 0                  ADSC9   TEXT+1                   cn=0,n=6

      503     9759    3            NUMPSNS=0;

   9759 10 000461   004621 450000 0                  STZ     CSTAT

      504     9760    3            I=FM$CFUX.DSETH; /* SEND AVRS FOR EVERYTHING THATS UP */

   9760 10 000462   000005 236100                    LDQ     5,,PR0
        10 000463   777777 376007                    ANQ     -1,DL
        10 000464   001076 756000 0                  STQ     I

      505     9761    4            DO WHILE(I~=0);

   9761 10 000465   000522 600000 10                 TZE     s:9770

      506     9762    5               IF FM$DEV.SPIN(I) THEN DO;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:147  
   9762 10 000466   001076 235000 0                  LDA     I
        10 000467   000003 735000                    ALS     3
        10 000470   000000 470400 xsym               LDP0    F$CFU$
        10 000471   000002 236105                    LDQ     2,AL,PR0
        10 000472   004000 316003                    CANQ    2048,DU
        10 000473   000502 600000 10                 TZE     s:9766

      507     9763    5                  FM$DEV.AVR(I)='1'B;

   9763 10 000474   010000 236003                    LDQ     4096,DU
        10 000475   000002 256105                    ORSQ    2,AL,PR0

      508     9764    5                  CALL M$WRITE(WRAVR)ALTRET(WAIT4KEYIN);

   9764 10 000476   000372 630400 0                  EPPR0   WRAVR
        10 000477   440001 713400                    CLIMB   alt,write
        10 000500   401400 401760                    pmme    nvectors=4
        10 000501   000575 702000 10                 TSX2    WAIT4KEYIN

      509     9765    5                  END;

      510     9766    4               IF FM$DEV.SECTL(I)~=0 THEN I=FM$DEV.SECTL(I);

   9766 10 000502   001076 235000 0                  LDA     I
        10 000503   000003 735000                    ALS     3
        10 000504   000000 470400 xsym               LDP0    F$CFU$
        10 000505   000005 720105                    LXL0    5,AL,PR0
        10 000506   000513 600000 10                 TZE     s:9767

   9766 10 000507   000005 236105                    LDQ     5,AL,PR0
        10 000510   777777 376007                    ANQ     -1,DL
        10 000511   001076 756000 0                  STQ     I
        10 000512   000521 710000 10                 TRA     s:9768

      511     9767    4               ELSE I=FM$DEV.DEVL(FM$VOL.DCTX(I));

   9767 10 000513   000000 236105                    LDQ     0,AL,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:148  
        10 000514   000017 772000                    QRL     15
        10 000515   000004 376000 11                 ANQ     4
        10 000516   000005 236106                    LDQ     5,QL,PR0
        10 000517   000022 772000                    QRL     18
        10 000520   001076 756000 0                  STQ     I

      512     9768    4               END;

   9768 10 000521   000466 601000 10                 TNZ     s:9762

      513     9769    3            END;

      514     9770    3         DO I=1 TO NUMPSNS;

   9770 10 000522   000001 235007                    LDA     1,DL
        10 000523   001076 755000 0                  STA     I
        10 000524   000565 710000 10                 TRA     s:9779+3

      515     9771                    /* FOR RECOVERY, JUST DO THE MOUNT KEYINS AGAIN */
      516     9772    3            IF NOT BINBIT(CSTAT.SETS.SETX(I),1) THEN GBUF.CADDR=M_DISK;

   9772 10 000525   001076 235000 0                  LDA     I
        10 000526   000001 735000                    ALS     1
        10 000527   004624 236005 0                  LDQ     CSTAT+3,AL
        10 000530   000777 376007                    ANQ     511,DL
        10 000531   000043 736000                    QLS     35
        10 000532   000536 601000 10                 TNZ     s:9773

   9772 10 000533   100000 220003                    LDX0    32768,DU
        10 000534   000706 440000 0                  SXL0    TEXT
        10 000535   000540 710000 10                 TRA     s:9774

      517     9773    3            ELSE GBUF.CADDR='0'B;

   9773 10 000536   000000 220003                    LDX0    0,DU
        10 000537   000706 440000 0                  SXL0    TEXT

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:149  
      518     9774    3            CSTAT.SETS.SETX(I)=0;

   9774 10 000540   000005 236000 11                 LDQ     5
        10 000541   004624 356005 0                  ANSQ    CSTAT+3,AL

      519     9775    3            GBUF.CODE=CSTAT.SETS.DISP(I);

   9775 10 000542   001076 235000 0                  LDA     I
        10 000543   000001 735000                    ALS     1
        10 000544   004624 236005 0                  LDQ     CSTAT+3,AL
        10 000545   000011 772000                    QRL     9
        10 000546   000777 376007                    ANQ     511,DL
        10 000547   000000 620006                    EAX0    0,QL
        10 000550   000706 740000 0                  STX0    TEXT

      520     9776    3            GBUF.PSN(0)=CSTAT.SETS.PSN(I);

   9776 10 000551   001076 236000 0                  LDQ     I
        10 000552   000003 736000                    QLS     3
        10 000553   040000 100406                    MLR     fill='040'O
        10 000554   004623 000006 0                  ADSC9   CSTAT+2,Q                cn=0,n=6
        10 000555   000707 000006 0                  ADSC9   TEXT+1                   cn=0,n=6

      521     9777                    /* MOUNT THE MOUNTED ONES, BUT NO MESSAGES */
      522     9778    3            CALL M$WRITE(WRAVR)ALTRET(WAIT4KEYIN);

   9778 10 000556   000372 630400 0                  EPPR0   WRAVR
        10 000557   440001 713400                    CLIMB   alt,write
        10 000560   401400 401760                    pmme    nvectors=4
        10 000561   000575 702000 10                 TSX2    WAIT4KEYIN

      523     9779    3            END;

   9779 10 000562   001076 235000 0                  LDA     I
        10 000563   000001 035007                    ADLA    1,DL
        10 000564   001076 755000 0                  STA     I
        10 000565   004621 236000 0                  LDQ     CSTAT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:150  
        10 000566   001076 116000 0                  CMPQ    I
        10 000567   000525 603000 10                 TRC     s:9772

      524     9780    2         CSTAT.SETS.SETX(0)=1;

   9780 10 000570   000001 236007                    LDQ     1,DL
        10 000571   004624 552004 0                  STBQ    CSTAT+3,'04'O

      525     9781    2         CALL CATWRITE;

   9781 10 000572   012372 701000 10                 TSX1    CATWRITE
        10 000573   000000 011000                    NOP     0

      526     9782    2         GOTO CONTINUE;

   9782 10 000574   000611 710000 10                 TRA     CONTINUE

      527     9783    2   WAIT4KEYIN: CALL M$WAIT(WAIT1);

   9783 10 000575   000026 630400 2     WAIT4KEYIN   EPPR0   WAIT1
        10 000576   020006 713400                    CLIMB   8198
        10 000577   400400 401760                    pmme    nvectors=2

      528     9784    2         CALL M$RETRY;

   9784 10 000600   010010 713400                    CLIMB   4104
        10 000601   000000 401760                    pmme    nvectors=0

      529     9785    2         END;

      530     9786    1      BLK$=WORK_.FIRST$;

   9786 10 000602   001013 236000 0                  LDQ     WORK_+1
        10 000603   001073 756000 0                  STQ     BLK$

      531     9787    1      CHAR1=' ';

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:151  
   9787 10 000604   001073 470400 0                  LDP0    BLK$
        10 000605   040100 100400                    MLR     fill='040'O
        10 000606   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 000607   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      532     9788    1      USW='0'B;

   9788 10 000610   001010 450000 0                  STZ     USW

   9788 10 000611                       CONTINUE     null
      533     9789    1   CONTINUE:;
      534     9790    2      IF NOT FPT_READ.V.WAIT# THEN DO;

   9790 10 000611   001042 236000 0                  LDQ     FPT_READ+8
        10 000612   400000 316007                    CANQ    -131072,DL
        10 000613   000622 601000 10                 TNZ     s:9795

      535     9791    2         XCONWIND=SAVUNW;

   9791 10 000614   200004 237100                    LDAQ    SAVUNW,,AUTO
        10 000615   000000 755000 xsym               STA     XCONWIND
        10 000616   000001 756000 xsym               STQ     XCONWIND+1

      536     9792    2         DPERX=SAVUNW;

   9792 10 000617   200004 237100                    LDAQ    SAVUNW,,AUTO
        10 000620   001110 757000 0                  STAQ    DPERX

      537     9793    2         RETURN;

   9793 10 000621   000000 702200 xent               TSX2  ! X66_ARET

      538     9794    2         END;
      539     9795    1      IF MODE=0 THEN IF M$LO$->F$DCB.CFU$->F$DCB.NRECS>BANNERSZ+150

   9795 10 000622   001121 235000 0                  LDA     MODE
        10 000623   000650 601000 10                 TNZ     s:9800
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:152  

   9795 10 000624   001122 470400 0                  LDP0    M$LO$
        10 000625   000066 471500                    LDP1    54,,PR0
        10 000626   001126 236000 0                  LDQ     BANNERSZ
        10 000627   000226 036007                    ADLQ    150,DL
        10 000630   000633 604000 10                 TMI     s:9795+9
        10 000631   100042 116100                    CMPQ    34,,PR1
        10 000632   000640 604000 10                 TMI     s:9797
        10 000633   001043 235000 0                  LDA     FPT_READ+9
        10 000634   000650 600000 10                 TZE     s:9800
        10 000635   006666 720000 0                  LXL0    WROC
        10 000636   000455 100003                    CMPX0   301,DU
        10 000637   000650 601000 10                 TNZ     s:9800

      540     9796    2        OR FPT_READ.V.EVENT#~=0 AND WROC.MSG#=PIGERR_MSG# THEN DO;

      541     9797    2         CALL M$LDEV(FPT_LDEV) ALTRET(NOALT);

   9797 10 000640   000656 630400 0                  EPPR0   FPT_LDEV
        10 000641   460004 713400                    CLIMB   alt,+24580
        10 000642   403000 401760                    pmme    nvectors=7
        10 000643   014123 702000 10                 TSX2    NOALT

      542     9798    2         BANNERSZ=M$LO$->F$DCB.CFU$->F$DCB.NRECS;

   9798 10 000644   001122 470400 0                  LDP0    M$LO$
        10 000645   000066 471500                    LDP1    54,,PR0
        10 000646   100042 235100                    LDA     34,,PR1
        10 000647   001126 755000 0                  STA     BANNERSZ

      543     9799    2         END;

      544     9800    2      IF FPT_READ.V.EVENT#~=0 THEN DO;

   9800 10 000650   001043 235000 0                  LDA     FPT_READ+9
        10 000651   000705 600000 10                 TZE     s:9811

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:153  
      545     9801    2         CALL CATREAD;

   9801 10 000652   012341 701000 10                 TSX1    CATREAD
        10 000653   000000 011000                    NOP     0

      546     9802    2         WROC.CADDR=M_DISK;

   9802 10 000654   100000 220003                    LDX0    32768,DU
        10 000655   006666 740000 0                  STX0    WROC

      547     9803    2         CODE=%E$MOUNT;

   9803 10 000656   000155 235007                    LDA     109,DL
        10 000657   200007 755100                    STA     CODE,,AUTO

      548     9804    3         DO I=1 TO NUMPSNS; /* MOUNT A SET THAT NEEDED RECON, TOO */

   9804 10 000660   000001 236007                    LDQ     1,DL
        10 000661   001076 756000 0                  STQ     I
        10 000662   000674 710000 10                 TRA     s:9806+3

      549     9805    3            IF CSTAT.SETS.SETX(I)=2 THEN GOTO MOUNT1;

   9805 10 000663   001076 235000 0                  LDA     I
        10 000664   000001 735000                    ALS     1
        10 000665   004624 236005 0                  LDQ     CSTAT+3,AL
        10 000666   000777 376007                    ANQ     511,DL
        10 000667   000002 116007                    CMPQ    2,DL
        10 000670   007147 600000 10                 TZE     MOUNT1

      550     9806    3            END;

   9806 10 000671   001076 235000 0                  LDA     I
        10 000672   000001 035007                    ADLA    1,DL
        10 000673   001076 755000 0                  STA     I
        10 000674   004621 236000 0                  LDQ     CSTAT
        10 000675   001076 116000 0                  CMPQ    I
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:154  
        10 000676   000663 603000 10                 TRC     s:9805

      551     9807    2         FPT_READ.V.EVENT#=0;

   9807 10 000677   001043 450000 0                  STZ     FPT_READ+9

      552     9808    2         CALL M$CHECK(FPT_READ)ALTRET(SIERR);

   9808 10 000700   001032 630400 0                  EPPR0   FPT_READ
        10 000701   450002 713400                    CLIMB   alt,+20482
        10 000702   400000 401760                    pmme    nvectors=1
        10 000703   014032 702000 10                 TSX2    SIERR

      553     9809    2         END;

   9809 10 000704   000714 710000 10                 TRA     s:9813

      554     9810    2      ELSE DO;

      555     9811    2         TCXT=' ';

   9811 10 000705   040000 100400                    MLR     fill='040'O
        10 000706   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 000707   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256

      556     9812    2         CALL M$READ(FPT_READ)ALTRET(SIERR);

   9812 10 000710   001032 630400 0                  EPPR0   FPT_READ
        10 000711   440000 713400                    CLIMB   alt,read
        10 000712   401400 401760                    pmme    nvectors=4
        10 000713   014032 702000 10                 TSX2    SIERR

      557     9813    2         END;

   9813 10 000714   000717 710000 10                 TRA     s:9816

      558     9814        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:155  
      559     9815    1   FXP$TWO: ENTRY ALTRET;

   9815 10 000715   000000 700200 xent  FXP$TWO      TSX0  ! X66_AUTO_1
        10 000716   001376 000001                    ZERO    766,1

      560     9816    1      SAVUNW=DPERX;

   9816 10 000717   001110 237000 0                  LDAQ    DPERX
        10 000720   200004 757100                    STAQ    SAVUNW,,AUTO

      561     9817    1      REMEMBER DPERR1 IN DPERX;

   9817 10 000721   013567 635000 10                 EAA     DPERR1
        10 000722   001110 452400 0                  STP2    DPERX
        10 000723   001111 755000 0                  STA     DPERX+1

      562     9818    1      IF MODE=0 THEN XCONWIND=DPERX;

   9818 10 000724   001121 235000 0                  LDA     MODE
        10 000725   000731 601000 10                 TNZ     s:9819

   9818 10 000726   001110 237000 0                  LDAQ    DPERX
        10 000727   000000 755000 xsym               STA     XCONWIND
        10 000730   000001 756000 xsym               STQ     XCONWIND+1

      563     9819    1      IF TCXT~='?' THEN EFPT.V.DCB#=DCBNUM(M$DP);

   9819 10 000731   040000 106400                    CMPC    fill='040'O
        10 000732   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256
        10 000733   000006 000001 11                 ADSC9   6                        cn=0,n=1
        10 000734   000740 600000 10                 TZE     s:9820

   9819 10 000735   000000 236007 xsym               LDQ     M$DP,DL
        10 000736   000000 620006                    EAX0    0,QL
        10 000737   000346 740000 0                  STX0    EFPT+22

      564     9820    2      IF MODE~=0 THEN DO;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:156  

   9820 10 000740   001121 235000 0                  LDA     MODE
        10 000741   001163 600000 10                 TZE     s:9859

      565     9821    2         IF NOT M$SI$->F$DCB.DDEV.IC OR NOT M$LO$->F$DCB.DDEV.IC

   9821 10 000742   001123 470400 0                  LDP0    M$SI$
        10 000743   000004 236100                    LDQ     4,,PR0
        10 000744   100000 316007                    CANQ    32768,DL
        10 000745   000752 600000 10                 TZE     s:9822
        10 000746   001122 471400 0                  LDP1    M$LO$
        10 000747   100004 236100                    LDQ     4,,PR1
        10 000750   100000 316007                    CANQ    32768,DL
        10 000751   000756 601000 10                 TNZ     s:9823

      566     9822    2         THEN CALL ERROR(4);

   9822 10 000752   000007 236000 11                 LDQ     7
        10 000753   201341 756100                    STQ     P$+2,,AUTO
        10 000754   011704 701000 10                 TSX1    ERROR
        10 000755   000000 011000                    NOP     0

      567     9823    3         IF TCXT='?' AND P_PCB.HI_CHAR<P_PCB.NCHARS THEN DO;

   9823 10 000756   040000 106400                    CMPC    fill='040'O
        10 000757   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256
        10 000760   000006 000001 11                 ADSC9   6                        cn=0,n=1
        10 000761   001004 601000 10                 TNZ     s:9831
        10 000762   001026 236000 0                  LDQ     P_PCB+10
        10 000763   001025 116000 0                  CMPQ    P_PCB+9
        10 000764   001004 603000 10                 TRC     s:9831

      568     9824    3   MENU:    P_PCB.NXT='1'B;

   9824 10 000765   040000 236007       MENU         LDQ     16384,DL
        10 000766   001021 256000 0                  ORSQ    P_PCB+5

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:157  
      569     9825    3            CALL INSERT(P_PCB.TEXT$->CHAR4,P_PCB.HI_CHAR,1,BINASC(0));

   9825 10 000767   001014 470400 0                  LDP0    P_PCB
        10 000770   001026 235000 0                  LDA     P_PCB+10
        10 000771   040105 100400                    MLR     fill='040'O
        10 000772   000010 000001 11                 ADSC9   8                        cn=0,n=1
        10 000773   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

      570     9826    3            CALL X$PARSE(P_PCB);

   9826 10 000774   000011 630400 11                 EPPR0   9
        10 000775   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 000776   000000 701000 xent               TSX1    X$PARSE
        10 000777   000000 011000                    NOP     0

      571     9827    3            P_PCB.NCHARS=0;

   9827 10 001000   001025 450000 0                  STZ     P_PCB+9

      572     9828    3            P_PCB.NXT='0'B;

   9828 10 001001   000012 236000 11                 LDQ     10
        10 001002   001021 356000 0                  ANSQ    P_PCB+5

      573     9829    3            GOTO NEXT;

   9829 10 001003   000204 710000 10                 TRA     NEXT

      574     9830    3            END;
      575     9831    2         I=0;

   9831 10 001004   001076 450000 0                  STZ     I

      576     9832    3         DO WHILE (I<256);

   9832 10 001005   001076 235000 0                  LDA     I
        10 001006   000400 115007                    CMPA    256,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:158  
        10 001007   001071 603000 10                 TRC     s:9842

      577     9833    4            IF CHAR1~=' ' OR SUBSTR(TCXT,I,1)~=' ' OR USW THEN DO;

   9833 10 001010   001073 470400 0                  LDP0    BLK$
        10 001011   040000 106500                    CMPC    fill='040'O
        10 001012   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        10 001013   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 001014   001024 601000 10                 TNZ     s:9834
        10 001015   001076 235000 0                  LDA     I
        10 001016   040000 106405                    CMPC    fill='040'O
        10 001017   000706 000001 0                  ADSC9   TEXT,A                   cn=0,n=1
        10 001020   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 001021   001024 601000 10                 TNZ     s:9834
        10 001022   001010 234000 0                  SZN     USW
        10 001023   001064 605000 10                 TPL     s:9840

      578     9834    4               BLK$=PINCRC(BLK$,1);

   9834 10 001024   001073 236000 0                  LDQ     BLK$
        10 001025   200000 036007                    ADLQ    65536,DL
        10 001026   001073 756000 0                  STQ     BLK$

      579     9835    4               IF POFFW(BLK$,WORK_.FIRST$)>WORK_.SIZE

   9835 10 001027   001013 235000 0                  LDA     WORK_+1
        10 001030   000022 771000                    ARL     18
        10 001031   201346 755100                    STA     BXP+1,,AUTO
        10 001032   001073 236000 0                  LDQ     BLK$
        10 001033   000022 772000                    QRL     18
        10 001034   201346 136100                    SBLQ    BXP+1,,AUTO
        10 001035   201347 756100                    STQ     BXP+2,,AUTO
        10 001036   001012 236000 0                  LDQ     WORK_
        10 001037   000022 772000                    QRL     18
        10 001040   201347 116100                    CMPQ    BXP+2,,AUTO
        10 001041   001046 605000 10                 TPL     s:9837

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:159  
      580     9836    4               THEN CALL M$GDS(WORKFPT) ALTRET(NOCORE);

   9836 10 001042   001064 630400 0                  EPPR0   WORKFPT
        10 001043   430001 713400                    CLIMB   alt,gds
        10 001044   400400 401760                    pmme    nvectors=2
        10 001045   014027 702000 10                 TSX2    NOCORE

      581     9837    4               CHAR1=SUBSTR(TCXT,I,1);

   9837 10 001046   001076 235000 0                  LDA     I
        10 001047   001073 470400 0                  LDP0    BLK$
        10 001050   040100 100405                    MLR     fill='040'O
        10 001051   000706 000001 0                  ADSC9   TEXT,A                   cn=0,n=1
        10 001052   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      582     9838    4               IF CHAR1='''' THEN USW=~USW;

   9838 10 001053   001073 470400 0                  LDP0    BLK$
        10 001054   040000 106500                    CMPC    fill='040'O
        10 001055   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        10 001056   000013 000001 11                 ADSC9   11                       cn=0,n=1
        10 001057   001064 601000 10                 TNZ     s:9840

   9838 10 001060   001010 236000 0                  LDQ     USW
        10 001061   400000 376003                    ANQ     -131072,DU
        10 001062   400000 676003                    ERQ     -131072,DU
        10 001063   001010 756000 0                  STQ     USW

      583     9839    4               END;

      584     9840    3            I=I+1;

   9840 10 001064   001076 235000 0                  LDA     I
        10 001065   000001 035007                    ADLA    1,DL
        10 001066   001076 755000 0                  STA     I

      585     9841    3            END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:160  

   9841 10 001067   000400 115007                    CMPA    256,DL
        10 001070   001010 602000 10                 TNC     s:9833

      586     9842    2         IF BLK$=WORK_.FIRST$ THEN GOTO CONTINUE;

   9842 10 001071   001073 236000 0                  LDQ     BLK$
        10 001072   001013 116000 0                  CMPQ    WORK_+1
        10 001073   000611 600000 10                 TZE     CONTINUE

      587     9843    2         IF CHAR1=' ' THEN BLK$=PINCRC(BLK$,-1);

   9843 10 001074   001073 470400 0                  LDP0    BLK$
        10 001075   040000 106500                    CMPC    fill='040'O
        10 001076   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        10 001077   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 001100   001103 601000 10                 TNZ     s:9844

   9843 10 001101   000034 036000 xsym               ADLQ    B_VECTNIL+28
        10 001102   001073 756000 0                  STQ     BLK$

      588     9844    3         IF CHAR1=';' THEN DO;

   9844 10 001103   001073 470400 0                  LDP0    BLK$
        10 001104   040000 106500                    CMPC    fill='040'O
        10 001105   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        10 001106   000014 000001 11                 ADSC9   12                       cn=0,n=1
        10 001107   001121 601000 10                 TNZ     s:9849

      589     9845    3            IF BLK$=P_PCB.TEXT$ THEN BLK$=WORK_.FIRST$;

   9845 10 001110   001014 116000 0                  CMPQ    P_PCB
        10 001111   001114 601000 10                 TNZ     s:9846

   9845 10 001112   001013 236000 0                  LDQ     WORK_+1
        10 001113   001073 756000 0                  STQ     BLK$

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:161  
      590     9846    3            CHAR1=' ';

   9846 10 001114   001073 470400 0                  LDP0    BLK$
        10 001115   040100 100400                    MLR     fill='040'O
        10 001116   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 001117   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      591     9847    3            GOTO CONTINUE;

   9847 10 001120   000611 710000 10                 TRA     CONTINUE

      592     9848    3            END;
      593     9849    2         P_PCB.NCHARS=POFFC(BLK$,WORK_.FIRST$);

   9849 10 001121   001013 236000 0                  LDQ     WORK_+1
        10 001122   000020 772000                    QRL     16
        10 001123   201346 756100                    STQ     BXP+1,,AUTO
        10 001124   001073 236000 0                  LDQ     BLK$
        10 001125   000020 772000                    QRL     16
        10 001126   201346 136100                    SBLQ    BXP+1,,AUTO
        10 001127   001025 756000 0                  STQ     P_PCB+9

   9849 10 001130                       NEWPARSE     null
      594     9850    2   NEWPARSE:;
      595     9851    2         P_PCB.WORK$=PINCRC(P_PCB.TEXT$,P_PCB.NCHARS);

   9851 10 001130   001025 236000 0                  LDQ     P_PCB+9
        10 001131   000020 736000                    QLS     16
        10 001132   001014 036000 0                  ADLQ    P_PCB
        10 001133   001016 756000 0                  STQ     P_PCB+2

      596     9852    2         P_PCB.WORK$=PALIGNW(P_PCB.WORK$);

   9852 10 001134   770000 036007                    ADLQ    -4096,DL
        10 001135   000015 376000 11                 ANQ     13
        10 001136   001016 756000 0                  STQ     P_PCB+2

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:162  
      597     9853    2         P_PCB.WKSZ=WORK_.SIZE-POFFW(P_PCB.WORK$,WORK_.FIRST$);

   9853 10 001137   001013 235000 0                  LDA     WORK_+1
        10 001140   000022 771000                    ARL     18
        10 001141   201346 755100                    STA     BXP+1,,AUTO
        10 001142   001016 236000 0                  LDQ     P_PCB+2
        10 001143   000022 772000                    QRL     18
        10 001144   201346 136100                    SBLQ    BXP+1,,AUTO
        10 001145   201347 756100                    STQ     BXP+2,,AUTO
        10 001146   001012 236000 0                  LDQ     WORK_
        10 001147   000022 772000                    QRL     18
        10 001150   201347 136100                    SBLQ    BXP+2,,AUTO
        10 001151   000000 620006                    EAX0    0,QL
        10 001152   001021 740000 0                  STX0    P_PCB+5

      598     9854    2         USW='0'B;

   9854 10 001153   001010 450000 0                  STZ     USW

      599     9855    2         CALL X$PARSE(P_PCB) ALTRET(PARSERR);

   9855 10 001154   000011 630400 11                 EPPR0   9
        10 001155   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 001156   000000 701000 xent               TSX1    X$PARSE
        10 001157   011553 702000 10                 TSX2    PARSERR

      600     9856    2         BLK$=P_PCB.OUT$;

   9856 10 001160   001017 236000 0                  LDQ     P_PCB+3
        10 001161   001073 756000 0                  STQ     BLK$

      601     9857    2         END;

   9857 10 001162   001642 710000 10                 TRA     s:9955

      602     9858        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:163  
      603     9859    2      ELSE IF M$SI$->F$DCB.LASTSTA$->ST.MSGTYP#=' ' THEN DO;

   9859 10 001163   001123 470400 0                  LDP0    M$SI$
        10 001164   000007 471500                    LDP1    7,,PR0
        10 001165   040000 106500                    CMPC    fill='040'O
        10 001166   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
        10 001167   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 001170   001415 601000 10                 TNZ     s:9909

      604     9860    2         CALL CLOSE (DCBNUM(M$PROJ));

   9860 10 001171   000000 236007 xsym               LDQ     M$PROJ,DL
        10 001172   201352 756100                    STQ     BXP+5,,AUTO
        10 001173   201352 631500                    EPPR1   BXP+5,,AUTO
        10 001174   201341 451500                    STP1    P$+2,,AUTO
        10 001175   012416 701000 10                 TSX1    CLOSE
        10 001176   000000 011000                    NOP     0

      605     9861    2         BLK$=WORK_.FIRST$;

   9861 10 001177   001013 236000 0                  LDQ     WORK_+1
        10 001200   001073 756000 0                  STQ     BLK$

      606     9862    2         OUT$BLK.CODE=GBUF.CODE;

   9862 10 001201   000706 220000 0                  LDX0    TEXT
        10 001202   001073 470400 0                  LDP0    BLK$
        10 001203   000000 440100                    SXL0    0,,PR0

      607     9863    2         OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT=GBUF.PSN(0);

   9863 10 001204   001073 470400 0                  LDP0    BLK$
        10 001205   000004 471500                    LDP1    4,,PR0
        10 001206   100004 236100                    LDQ     4,,PR1
        10 001207   000033 772000                    QRL     27
        10 001210   000000 620006                    EAX0    0,QL
        10 001211   040140 100400                    MLR     fill='040'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:164  
        10 001212   000707 000006 0                  ADSC9   TEXT+1                   cn=0,n=6
        10 001213   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0

      608     9864    2         OUT$BLK.SUBLK$(2)->OUT$BLK.CODE=GBUF.CODE;

   9864 10 001214   001073 470400 0                  LDP0    BLK$
        10 001215   000005 471500                    LDP1    5,,PR0
        10 001216   000706 220000 0                  LDX0    TEXT
        10 001217   100000 440100                    SXL0    0,,PR1

      609     9865    2         OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0;

   9865 10 001220   001073 470400 0                  LDP0    BLK$
        10 001221   000004 471500                    LDP1    4,,PR0
        10 001222   000000 220003                    LDX0    0,DU
        10 001223   100000 440100                    SXL0    0,,PR1

      610     9866    2         WROC.CADDR=GBUF.CADDR;

   9866 10 001224   000706 721000 0                  LXL1    TEXT
        10 001225   006666 741000 0                  STX1    WROC

      611     9867    3         DO CASE(GBUF.CODE);

   9867 10 001226   000706 222000 0                  LDX2    TEXT
        10 001227   000017 102003                    CMPX2   15,DU
        10 001230   001232 602012 10                 TNC     s:9867+4,X2
        10 001231   001407 710000 10                 TRA     s:9901
        10 001232   001403 710000 10                 TRA     s:9899
        10 001233   001271 710000 10                 TRA     s:9875
        10 001234   001275 710000 10                 TRA     s:9877
        10 001235   001407 710000 10                 TRA     s:9901
        10 001236   001407 710000 10                 TRA     s:9901
        10 001237   001407 710000 10                 TRA     s:9901
        10 001240   001407 710000 10                 TRA     s:9901
        10 001241   001407 710000 10                 TRA     s:9901
        10 001242   001251 710000 10                 TRA     s:9869
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:165  
        10 001243   001251 710000 10                 TRA     s:9869
        10 001244   001251 710000 10                 TRA     s:9869
        10 001245   001261 710000 10                 TRA     s:9872
        10 001246   001261 710000 10                 TRA     s:9872
        10 001247   001261 710000 10                 TRA     s:9872
        10 001250   001320 710000 10                 TRA     s:9882

      612     9868    3         CASE(%SETPUB#,%SETPRIV#,%SETXCL#);

      613     9869    3            OUT$BLK.CODE=%E$MOUNT;

   9869 10 001251   000155 223003                    LDX3    109,DU
        10 001252   001073 470400 0                  LDP0    BLK$
        10 001253   000000 443100                    SXL3    0,,PR0

      614     9870    3            OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=%E$PSN;

   9870 10 001254   001073 470400 0                  LDP0    BLK$
        10 001255   000004 471500                    LDP1    4,,PR0
        10 001256   000106 221003                    LDX1    70,DU
        10 001257   100000 441100                    SXL1    0,,PR1
        10 001260   001410 710000 10                 TRA     s:9903

      615     9871    3         CASE(%SETDSMT#,%SETDSMTF#,%SETDSMTX#);

      616     9872    3            OUT$BLK.CODE=%E$DISMOUNT;

   9872 10 001261   000156 223003                    LDX3    110,DU
        10 001262   001073 470400 0                  LDP0    BLK$
        10 001263   000000 443100                    SXL3    0,,PR0

      617     9873    3            OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=%E$PSN;

   9873 10 001264   001073 470400 0                  LDP0    BLK$
        10 001265   000004 471500                    LDP1    4,,PR0
        10 001266   000106 221003                    LDX1    70,DU
        10 001267   100000 441100                    SXL1    0,,PR1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:166  
        10 001270   001410 710000 10                 TRA     s:9903

      618     9874    3         CASE(1);

      619     9875    3            OUT$BLK.CODE=%E$DISPLAY;

   9875 10 001271   000161 223003                    LDX3    113,DU
        10 001272   001073 470400 0                  LDP0    BLK$
        10 001273   000000 443100                    SXL3    0,,PR0
        10 001274   001410 710000 10                 TRA     s:9903

      620     9876    3         CASE(2);

      621     9877    3            OUT$BLK.CODE=%E$DISPLAY;

   9877 10 001275   000161 223003                    LDX3    113,DU
        10 001276   001073 470400 0                  LDP0    BLK$
        10 001277   000000 443100                    SXL3    0,,PR0

      622     9878    3            IF OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT=' '

   9878 10 001300   001073 470400 0                  LDP0    BLK$
        10 001301   000004 471500                    LDP1    4,,PR0
        10 001302   100004 236100                    LDQ     4,,PR1
        10 001303   000033 772000                    QRL     27
        10 001304   000000 621006                    EAX1    0,QL
        10 001305   040000 106540                    CMPC    fill='040'O
        10 001306   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 001307   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 001310   001315 601000 10                 TNZ     s:9880

      623     9879    3            THEN OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT='SETS';

   9879 10 001311   040140 100400                    MLR     fill='040'O
        10 001312   000517 000004 2                  ADSC9   FFLGS+40                 cn=0,n=4
        10 001313   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 001314   001410 710000 10                 TRA     s:9903
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:167  

      624     9880    3            ELSE OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=%E$PSN;

   9880 10 001315   000106 222003                    LDX2    70,DU
        10 001316   100000 442100                    SXL2    0,,PR1
        10 001317   001410 710000 10                 TRA     s:9903

      625     9881    3         CASE(KEY_SETDSMTZ#);

      626     9882    3            ZAP='1'B;

   9882 10 001320   400000 236003                    LDQ     -131072,DU
        10 001321   001106 756000 0                  STQ     ZAP

      627     9883    3            I=FM$CFUX.SETH;

   9883 10 001322   000000 470400 xsym               LDP0    F$CFU$
        10 001323   000005 236100                    LDQ     5,,PR0
        10 001324   000022 772000                    QRL     18
        10 001325   001076 756000 0                  STQ     I

      628     9884    4            DO WHILE(I~=0);

   9884 10 001326   001364 600000 10                 TZE     s:9891

      629     9885    4               GBUF.CODE=%SETDSMTX#;

   9885 10 001327   000015 220003                    LDX0    13,DU
        10 001330   000706 740000 0                  STX0    TEXT

      630     9886    4               GBUF.PSN(0)=FM$SET.PSN(I);

   9886 10 001331   001076 235000 0                  LDA     I
        10 001332   000005 735000                    ALS     5
        10 001333   000000 470400 xsym               LDP0    F$CFU$
        10 001334   040000 100505                    MLR     fill='040'O
        10 001335   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:168  
        10 001336   000707 000006 0                  ADSC9   TEXT+1                   cn=0,n=6

      631     9887    4               IF NOT FM$SET.XCL(I) AND GBUF.PSN(0)~='SYS'

   9887 10 001337   001076 236000 0                  LDQ     I
        10 001340   000003 736000                    QLS     3
        10 001341   000002 234106                    SZN     2,QL,PR0
        10 001342   001347 604000 10                 TMI     s:9887+8
        10 001343   040000 106400                    CMPC    fill='040'O
        10 001344   000707 000006 0                  ADSC9   TEXT+1                   cn=0,n=6
        10 001345   000520 000003 2                  ADSC9   FFLGS+41                 cn=0,n=3
        10 001346   001352 601000 10                 TNZ     s:9888
        10 001347   000002 721106                    LXL1    2,QL,PR0
        10 001350   000007 101003                    CMPX1   7,DU
        10 001351   001355 601000 10                 TNZ     s:9889

      632     9888    4                 OR FM$SET.SYSID(I)=JG_PIG# THEN CALL M$WRITE(WRAVR);

   9888 10 001352   000372 630400 0                  EPPR0   WRAVR
        10 001353   040001 713400                    CLIMB   write
        10 001354   401400 401760                    pmme    nvectors=4

      633     9889    4               I=FM$SET.SETL(I);

   9889 10 001355   001076 235000 0                  LDA     I
        10 001356   000003 735000                    ALS     3
        10 001357   000000 470400 xsym               LDP0    F$CFU$
        10 001360   000005 236105                    LDQ     5,AL,PR0
        10 001361   000022 772000                    QRL     18
        10 001362   001076 756000 0                  STQ     I

      634     9890    4               END;

   9890 10 001363   001327 601000 10                 TNZ     s:9885

      635     9891    3            NUMPSNS=0;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:169  
   9891 10 001364   004621 450000 0                  STZ     CSTAT

      636     9892    3            CSTAT.SETS.SETX(0)=0; /* Come up as if from DISK BOOT */

   9892 10 001365   000000 236003                    LDQ     0,DU
        10 001366   004624 552004 0                  STBQ    CSTAT+3,'04'O

      637     9893    3            CALL CATWRITE;

   9893 10 001367   012372 701000 10                 TSX1    CATWRITE
        10 001370   000000 011000                    NOP     0

      638     9894    3            GBUF.CADDR='0'B;

   9894 10 001371   000000 220003                    LDX0    0,DU
        10 001372   000706 440000 0                  SXL0    TEXT

      639     9895    3            LBUFC='** ZAP **';

   9895 10 001373   040000 100400                    MLR     fill='040'O
        10 001374   000521 000011 2                  ADSC9   FFLGS+42                 cn=0,n=9
        10 001375   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

      640     9896    3            CALL ERROR(10);

   9896 10 001376   000016 236000 11                 LDQ     14
        10 001377   201341 756100                    STQ     P$+2,,AUTO
        10 001400   011704 701000 10                 TSX1    ERROR
        10 001401   000000 011000                    NOP     0

      641     9897    3            GOTO NEXT;

   9897 10 001402   000204 710000 10                 TRA     NEXT

      642     9898    3         CASE(0);

      643     9899    3            OUT$BLK.CODE=%E$AVR;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:170  

   9899 10 001403   000202 223003                    LDX3    130,DU
        10 001404   001073 470400 0                  LDP0    BLK$
        10 001405   000000 443100                    SXL3    0,,PR0
        10 001406   001410 710000 10                 TRA     s:9903

      644     9900    3         CASE(ELSE);

      645     9901    3            GOTO NEXT;

   9901 10 001407   000204 710000 10                 TRA     NEXT

      646     9902    3         END;

      647     9903    2         WIDTH=64;

   9903 10 001410   000100 235007                    LDA     64,DL
        10 001411   001124 755000 0                  STA     WIDTH

      648     9904    2         CALL CATREAD;

   9904 10 001412   012341 701000 10                 TSX1    CATREAD
        10 001413   000000 011000                    NOP     0

      649     9905    2         END;

   9905 10 001414   001642 710000 10                 TRA     s:9955

      650     9906        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:171  
      651     9907    2      ELSE DO;

      652     9908                    /* WE HAVE SUPER INPUT */
      653     9909    2         BLK$=PINCRW(BLK$,20);

   9909 10 001415   001073 236000 0                  LDQ     BLK$
        10 001416   000024 036003                    ADLQ    20,DU
        10 001417   001073 756000 0                  STQ     BLK$

      654     9910    2         CALL CATREAD;

   9910 10 001420   012341 701000 10                 TSX1    CATREAD
        10 001421   000000 011000                    NOP     0

      655     9911    3         IF FPT_READ.BUF_.BUF$=ADDR(TCXT) THEN DO;

   9911 10 001422   000017 236000 11                 LDQ     15
        10 001423   001037 116000 0                  CMPQ    FPT_READ+5
        10 001424   001447 601000 10                 TNZ     s:9917

      656     9912    3            IF LENGTHC(ADDR(TCXT)->S_TO_P)>SIZEC(TCXT)

   9912 10 001425   000724 236000 0                  LDQ     TEXT+14
        10 001426   000022 772000                    QRL     18
        10 001427   000307 116007                    CMPQ    199,DL
        10 001430   001433 602000 10                 TNC     s:9914

      657     9913    3            THEN ADDR(TCXT)->S_TO_P.ATTR.COUNT=SIZEC(TCXT);

   9913 10 001431   000400 220003                    LDX0    256,DU
        10 001432   000724 740000 0                  STX0    TEXT+14

      658     9914    3            S_TO_P.ATTR.COUNT=ADDR(TCXT)->S_TO_P.ATTR.COUNT;

   9914 10 001433   000724 220000 0                  LDX0    TEXT+14
        10 001434   001073 470400 0                  LDP0    BLK$
        10 001435   000016 740100                    STX0    14,,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:172  

      659     9915    3            S_TO_P=ADDR(TCXT)->S_TO_P;

   9915 10 001436   001073 470400 0                  LDP0    BLK$
        10 001437   000016 220100                    LDX0    14,,PR0
        10 001440   000072 621010                    EAX1    58,X0
        10 001441   000724 222000 0                  LDX2    TEXT+14
        10 001442   000072 623012                    EAX3    58,X2
        10 001443   000140 100440                    MLR     fill='000'O
        10 001444   000706 000013 0                  ADSC9   TEXT                     cn=0,n=*X3
        10 001445   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

      660     9916    3            END;

   9916 10 001446   001451 710000 10                 TRA     s:9918

      661     9917    2         ELSE FPT_READ.BUF_=VECTOR(TCXT);

   9917 10 001447   000020 237000 11                 LDAQ    16
        10 001450   001036 757000 0                  STAQ    FPT_READ+4

      662     9918    2         P_PCB.NCHARS=LENGTHC(S_TO_P)-POFFC(ADDR(S_TO_P.PROJECT),ADDR(S_TO_P));;

   9918 10 001451   001073 470400 0                  LDP0    BLK$
        10 001452   000016 220100                    LDX0    14,,PR0
        10 001453   000072 621010                    EAX1    58,X0
        10 001454   001073 236000 0                  LDQ     BLK$
        10 001455   000020 772000                    QRL     16
        10 001456   201346 756100                    STQ     BXP+1,,AUTO
        10 001457   001073 236000 0                  LDQ     BLK$
        10 001460   000022 036000 11                 ADLQ    18
        10 001461   000020 772000                    QRL     16
        10 001462   201346 136100                    SBLQ    BXP+1,,AUTO
        10 001463   201347 756100                    STQ     BXP+2,,AUTO
        10 001464   000000 636011                    EAQ     0,X1
        10 001465   000022 772000                    QRL     18
        10 001466   201347 136100                    SBLQ    BXP+2,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:173  
        10 001467   001025 756000 0                  STQ     P_PCB+9

      663     9919    3         DO I=0 TO NUMPSNS;

   9919 10 001470   001076 450000 0                  STZ     I
        10 001471   001520 710000 10                 TRA     s:9922+3

      664     9920    3            IF S_TO_P.PACKSET=CSTAT.SETS.PSN(I) AND BINBIT(CSTAT.SETS.SETX(I),1)

   9920 10 001472   001076 235000 0                  LDA     I
        10 001473   000003 735000                    ALS     3
        10 001474   001073 470400 0                  LDP0    BLK$
        10 001475   040005 106500                    CMPC    fill='040'O
        10 001476   000012 400006                    ADSC9   10,,PR0                  cn=2,n=6
        10 001477   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6
        10 001500   001515 601000 10                 TNZ     s:9922
        10 001501   001076 236000 0                  LDQ     I
        10 001502   000001 736000                    QLS     1
        10 001503   004624 236006 0                  LDQ     CSTAT+3,QL
        10 001504   000777 376007                    ANQ     511,DL
        10 001505   000043 736000                    QLS     35
        10 001506   001515 600000 10                 TZE     s:9922
        10 001507   001076 236000 0                  LDQ     I
        10 001510   000001 736000                    QLS     1
        10 001511   004624 236006 0                  LDQ     CSTAT+3,QL
        10 001512   777000 376007                    ANQ     -512,DL
        10 001513   012000 116007                    CMPQ    5120,DL
        10 001514   001525 601000 10                 TNZ     SETSUP

      665     9921    3              AND CSTAT.SETS.DISP(I)~=%SETXCL# THEN GOTO SETSUP;
      666     9922    3            END;

   9922 10 001515   001076 236000 0                  LDQ     I
        10 001516   000001 036007                    ADLQ    1,DL
        10 001517   001076 756000 0                  STQ     I
        10 001520   004621 236000 0                  LDQ     CSTAT
        10 001521   001076 116000 0                  CMPQ    I
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:174  
        10 001522   001472 603000 10                 TRC     s:9920

      667     9923    2         CALL DEFER ALTRET(DPERR1); /* ALTRETS UNLESS VALIDATEATTR */

   9923 10 001523   013255 701000 10                 TSX1    DEFER
        10 001524   013567 702000 10                 TSX2    DPERR1

   9923 10 001525                       SETSUP       null
      668     9924    2   SETSUP: ;
      669     9925    2         USER_ACCN=S_TO_P.SUPER.ACCT;

   9925 10 001525   001073 470400 0                  LDP0    BLK$
        10 001526   040000 100500                    MLR     fill='040'O
        10 001527   000000 400010                    ADSC9   0,,PR0                   cn=2,n=8
        10 001530   001117 000010 0                  ADSC9   USER_ACCN                cn=0,n=8

      670     9926    2         USER_NAME=S_TO_P.SUPER.UNAME;

   9926 10 001531   040000 100500                    MLR     fill='040'O
        10 001532   000002 400014                    ADSC9   2,,PR0                   cn=2,n=12
        10 001533   001114 000014 0                  ADSC9   USER_NAME                cn=0,n=12

      671     9927    3         IF S_TO_P.PROJ THEN DO;

   9927 10 001534   000000 236100                    LDQ     0,,PR0
        10 001535   000400 316003                    CANQ    256,DU
        10 001536   001553 600000 10                 TZE     s:9933

      672     9928    3            PROJAD.NAME=S_TO_P.PROJECT.UNAME;

   9928 10 001537   040000 100500                    MLR     fill='040'O
        10 001540   000007 400014                    ADSC9   7,,PR0                   cn=2,n=12
        10 001541   001131 200014 0                  ADSC9   PROJAD+2                 cn=1,n=12

      673     9929    3            PROJAD.ACCT=S_TO_P.PROJECT.ACCT;

   9929 10 001542   040000 100500                    MLR     fill='040'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:175  
        10 001543   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8
        10 001544   001127 200010 0                  ADSC9   PROJAD                   cn=1,n=8

      674     9930    3            CALL FXU$PROJAD ALTRET(DPERR1);

   9930 10 001545   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 001546   000000 701000 xent               TSX1    FXU$PROJAD
        10 001547   013567 702000 10                 TSX2    DPERR1

      675     9931    3            BLK$=PINCRW(WORK_.FIRST$,20);

   9931 10 001550   001013 236000 0                  LDQ     WORK_+1
        10 001551   000024 036003                    ADLQ    20,DU
        10 001552   001073 756000 0                  STQ     BLK$

      676     9932    3            END;

      677     9933    2         S_TO_P.PROJECT.UNAME=S_TO_P.PACKSET;

   9933 10 001553   001073 470400 0                  LDP0    BLK$
        10 001554   040100 100500                    MLR     fill='040'O
        10 001555   000012 400006                    ADSC9   10,,PR0                  cn=2,n=6
        10 001556   000007 400014                    ADSC9   7,,PR0                   cn=2,n=12

      678     9934    2         S_TO_P.PACKSET='     .';

   9934 10 001557   001073 470400 0                  LDP0    BLK$
        10 001560   040100 100400                    MLR     fill='040'O
        10 001561   000524 000006 2                  ADSC9   FFLGS+45                 cn=0,n=6
        10 001562   000012 400006                    ADSC9   10,,PR0                  cn=2,n=6

      679     9935    2         S_TO_P.ATTR.COUNT=ASCBIN(' ')*513;

   9935 10 001563   040040 220003                    LDX0    16416,DU
        10 001564   001073 470400 0                  LDP0    BLK$
        10 001565   000016 740100                    STX0    14,,PR0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:176  
      680     9936    3         DO CASE(S_TO_P.TYPE);

   9936 10 001566   001073 470400 0                  LDP0    BLK$
        10 001567   000000 236100                    LDQ     0,,PR0
        10 001570   000033 772000                    QRL     27
        10 001571   000005 116007                    CMPQ    5,DL
        10 001572   001574 602006 10                 TNC     s:9936+6,QL
        10 001573   001631 710000 10                 TRA     s:9949
        10 001574   001601 710000 10                 TRA     s:9938
        10 001575   001605 710000 10                 TRA     s:9940
        10 001576   001611 710000 10                 TRA     s:9942
        10 001577   001615 710000 10                 TRA     s:9944
        10 001600   001626 710000 10                 TRA     s:9947

      681     9937    3         CASE(%CREATE_ACCT);

      682     9938    3            S_TO_P.PROJECT.ACCT='CREATE #';

   9938 10 001601   040100 100400                    MLR     fill='040'O
        10 001602   000526 000010 2                  ADSC9   FFLGS+47                 cn=0,n=8
        10 001603   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8
        10 001604   001631 710000 10                 TRA     s:9949

      683     9939    3         CASE(%MODIFY_ACCT);

      684     9940    3            S_TO_P.PROJECT.ACCT='MODIFY #';

   9940 10 001605   040100 100400                    MLR     fill='040'O
        10 001606   000530 000010 2                  ADSC9   FFLGS+49                 cn=0,n=8
        10 001607   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8
        10 001610   001631 710000 10                 TRA     s:9949

      685     9941    3         CASE(%LIST_ACCT);

      686     9942    3            S_TO_P.PROJECT.ACCT='LIST   #';

   9942 10 001611   040100 100400                    MLR     fill='040'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:177  
        10 001612   000532 000010 2                  ADSC9   FFLGS+51                 cn=0,n=8
        10 001613   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8
        10 001614   001631 710000 10                 TRA     s:9949

      687     9943    3         CASE(%VALIDATE_ATTR);

      688     9944    3            S_TO_P.PROJECT_TEXT='CREATE #_';

   9944 10 001615   040100 100400                    MLR     fill='040'O
        10 001616   000534 000011 2                  ADSC9   FFLGS+53                 cn=0,n=9
        10 001617   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20

      689     9945    3            S_TO_P.ACCT=':';

   9945 10 001620   001073 470400 0                  LDP0    BLK$
        10 001621   000023 235000 11                 LDA     19
        10 001622   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 001623   000014 755100                    STA     12,,PR0
        10 001624   000015 756100                    STQ     13,,PR0
        10 001625   001631 710000 10                 TRA     s:9949

      690     9946    3         CASE(%DELETE_ACCT);

      691     9947    3            S_TO_P.PROJECT.ACCT='DELETE #';

   9947 10 001626   040100 100400                    MLR     fill='040'O
        10 001627   000537 000010 2                  ADSC9   FFLGS+56                 cn=0,n=8
        10 001630   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8

      692     9948    3         END;

      693     9949    2         P_PCB.TEXT$=ADDR(S_TO_P.PROJECT);

   9949 10 001631   001073 236000 0                  LDQ     BLK$
        10 001632   000022 036000 11                 ADLQ    18
        10 001633   001014 756000 0                  STQ     P_PCB

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:178  
      694     9950    2         WIDTH=S_TO_P.WIDTH;

   9950 10 001634   001073 470400 0                  LDP0    BLK$
        10 001635   000000 236100                    LDQ     0,,PR0
        10 001636   000022 772000                    QRL     18
        10 001637   000377 376007                    ANQ     255,DL
        10 001640   001124 756000 0                  STQ     WIDTH

      695     9951    2         GOTO NEWPARSE;

   9951 10 001641   001130 710000 10                 TRA     NEWPARSE

      696     9952    2         END;
      697     9953        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:179  
      698     9954                    /* INITIALIZE A FEW THINGS */
      699     9955    1      REMEMBER RESTART IN TRAPX;

   9955 10 001642   001646 635000 10                 EAA     RESTART
        10 001643   001100 452400 0                  STP2    TRAPX
        10 001644   001101 755000 0                  STA     TRAPX+1

      700     9956    1      TRAPCNT=0;

   9956 10 001645   001102 450000 0                  STZ     TRAPCNT

   9956 10 001646                       RESTART      null
      701     9957    1   RESTART:;
      702     9958    1      NUMSNS=0;

   9958 10 001646   001112 450000 0                  STZ     NUMSNS

      703     9959    1      X9=0;

   9959 10 001647   200006 450100                    STZ     X9,,AUTO

      704     9960    1      FITSIZE=SIZEC(DEFAULT_BUILD);

   9960 10 001650   005514 235007                    LDA     2892,DL
        10 001651   002620 755000 0                  STA     FITSIZE

      705     9961    1      ADDR(PADBUF)->FITMOVER=DEFAULT_BUILD;

   9961 10 001652   000000 620005                    EAX0    0,AL
        10 001653   000040 100500                    MLR     fill='000'O
        10 001654   200010 005514                    ADSC9   DEFAULT_BUILD,,AUTO      cn=0,n=2892
        10 001655   001410 000010 0                  ADSC9   PADBUF                   cn=0,n=*X0

      706     9962    1      BREAK=0;

   9962 10 001656   001125 450000 0                  STZ     BREAK

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:180  
      707     9963    1      OPNDP.V.FUN#=%IN#;

   9963 10 001657   002000 236007                    LDQ     1024,DL
        10 001660   000145 552010 0                  STBQ    OPNDP+37,'10'O

      708     9964    1      VLP_ACCT.ACCT#=BINASC(0);

   9964 10 001661   000010 235000 11                 LDA     8
        10 001662   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 001663   000076 757000 0                  STAQ    VLP_ACCT

      709     9965    1      SELACCT='?';

   9965 10 001664   000006 235000 11                 LDA     6
        10 001665   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 001666   001006 757000 0                  STAQ    SELACCT

      710     9966    1      LBUFC=NONEMSG;

   9966 10 001667   040000 100400                    MLR     fill='040'O
        10 001670   000311 000017 2                  ADSC9   NONEMSG                  cn=0,n=15
        10 001671   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

      711     9967    1      CODE=0;

   9967 10 001672   200007 450100                    STZ     CODE,,AUTO

      712     9968    1      GAC=0;

   9968 10 001673   000000 450000 xsym               STZ     GAC

      713     9969    1      OPNDP.FPARAM_=BITVECT(READVID.BUF_);

   9969 10 001674   000422 237000 0                  LDAQ    READVID+4
        10 001675   000130 757000 0                  STAQ    OPNDP+24

      714     9970    1      OPNDP.IFPARAM_=VECTOR(NIL);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:181  

   9970 10 001676   000024 237000 11                 LDAQ    20
        10 001677   000126 757000 0                  STAQ    OPNDP+22

      715     9971    1      OPNSN.SN#(0)=' ';

   9971 10 001700   040000 100400                    MLR     fill='040'O
        10 001701   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 001702   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

      716     9972    1      VLP_NAME='0'B;

   9972 10 001703   000000 100400                    MLR     fill='000'O
        10 001704   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        10 001705   000624 000040 0                  ADSC9   VLP_NAME                 cn=0,n=32

      717     9973    1      IF OUT$BLK.NSUBLKS>1

   9973 10 001706   001073 470400 0                  LDP0    BLK$
        10 001707   000001 220100                    LDX0    1,,PR0
        10 001710   000002 100003                    CMPX0   2,DU
        10 001711   001724 602000 10                 TNC     s:9976

      718     9974    1      THEN IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=%E$PSN

   9974 10 001712   000004 471500                    LDP1    4,,PR0
        10 001713   100000 721100                    LXL1    0,,PR1
        10 001714   000106 101003                    CMPX1   70,DU
        10 001715   001724 601000 10                 TNZ     s:9976

      719     9975    1      THEN OPNSN.SN#(0)=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

   9975 10 001716   100004 236100                    LDQ     4,,PR1
        10 001717   000033 772000                    QRL     27
        10 001720   000000 622006                    EAX2    0,QL
        10 001721   040000 100540                    MLR     fill='040'O
        10 001722   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:182  
        10 001723   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

      720     9976    1      CLSDP.V.DISP#=%SCRATCH#;

   9976 10 001724   000001 236007                    LDQ     1,DL
        10 001725   000224 552004 0                  STBQ    CLSDP+26,'04'O

      721     9977    1      WROC.MSG#=PIGERR_MSG#;

   9977 10 001726   000455 220003                    LDX0    301,DU
        10 001727   006666 440000 0                  SXL0    WROC

      722     9978    1      I0=2;

   9978 10 001730   000002 235007                    LDA     2,DL
        10 001731   001077 755000 0                  STA     I0

      723     9979    1      GRANULE=0;

   9979 10 001732   001113 450000 0                  STZ     GRANULE

      724     9980    1      MADM.V='0'B;

   9980 10 001733   000000 235003                    LDA     0,DU
        10 001734   000000 236003                    LDQ     0,DU
        10 001735   000414 757000 0                  STAQ    MADM+6

      725     9981    1      I=2;

   9981 10 001736   000002 235007                    LDA     2,DL
        10 001737   001076 755000 0                  STA     I

      726     9982    1      CODE=OUT$BLK.CODE;

   9982 10 001740   000000 236100                    LDQ     0,,PR0
        10 001741   777777 376007                    ANQ     -1,DL
        10 001742   200007 756100                    STQ     CODE,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:183  

      727     9983    1      IF CODE=0 THEN CODE=OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

   9983 10 001743   001750 601000 10                 TNZ     s:9984

   9983 10 001744   000003 471500                    LDP1    3,,PR0
        10 001745   100000 236100                    LDQ     0,,PR1
        10 001746   777777 376007                    ANQ     -1,DL
        10 001747   200007 756100                    STQ     CODE,,AUTO

      728     9984    2      IF PROJAD.L~=0 THEN DO;

   9984 10 001750   001127 236000 0                  LDQ     PROJAD
        10 001751   777000 316003                    CANQ    -512,DU
        10 001752   001773 600000 10                 TZE     s:9994

      729     9985    2         CALL INDEX1(J,BINASC(CODE),PROJADC)ALTRET(CMDERR);

   9985 10 001753   200007 236100                    LDQ     CODE,,AUTO
        10 001754   000033 736000                    QLS     27
        10 001755   000010 276000 11                 ORQ     8
        10 001756   201346 756100                    STQ     BXP+1,,AUTO
        10 001757   000100 124400                    SCM     mask='000'O
        10 001760   000153 000020 2                  ADSC9   PROJADCU                 cn=0,n=16
        10 001761   201346 000001                    ADSC9   BXP+1,,AUTO              cn=0,n=1
        10 001762   001104 000000 0                  ARG     J
        10 001763   013521 606400 10                 TTN     CMDERR

      730     9986                    /*E*      ERROR: FXP-E$PROJCMD-E
      731     9987                    *         MESSAGE:Not a project administrator command.
      732     9988                    */
      733     9989    2         PRIVFPT.V.PRIV#=%PR_FMDIAG#;

   9989 10 001764   000541 236000 2                  LDQ     FFLGS+58
        10 001765   000636 756000 0                  STQ     PRIVFPT+2

      734     9990    2         CALL M$SPRIV(PRIVFPT);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:184  

   9990 10 001766   000634 630400 0                  EPPR0   PRIVFPT
        10 001767   020012 713400                    CLIMB   8202
        10 001770   400000 401760                    pmme    nvectors=1

      735     9991    2         PRIVFPT.V.PRIV#='0'B;

   9991 10 001771   000636 450000 0                  STZ     PRIVFPT+2

      736     9992    2         DIAGFPT.V.PRIV#='0'B;

   9992 10 001772   000642 450000 0                  STZ     DIAGFPT+2

      737     9993    2         END;

      738     9994    2      DO CASE(CODE-%E$PIGH);

   9994 10 001773   200007 235100                    LDA     CODE,,AUTO
        10 001774   000144 135007                    SBLA    100,DL
        10 001775   000037 115007                    CMPA    31,DL
        10 001776   002000 602005 10                 TNC     s:9994+5,AL
        10 001777   011257 710000 10                 TRA     s:11238
        10 002000   011257 710000 10                 TRA     s:11238
        10 002001   005767 710000 10                 TRA     s:10648
        10 002002   002037 710000 10                 TRA     s:10005
        10 002003   002037 710000 10                 TRA     s:10005
        10 002004   002037 710000 10                 TRA     s:10005
        10 002005   006006 710000 10                 TRA     s:10659
        10 002006   006560 710000 10                 TRA     s:10778
        10 002007   004400 710000 10                 TRA     s:10438
        10 002010   004400 710000 10                 TRA     s:10438
        10 002011   007053 710000 10                 TRA     s:10831
        10 002012   007414 710000 10                 TRA     s:10892
        10 002013   007512 710000 10                 TRA     s:10921
        10 002014   005671 710000 10                 TRA     s:10628
        10 002015   002236 710000 10                 TRA     s:10048
        10 002016   004656 710000 10                 TRA     s:10500
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:185  
        10 002017   007703 710000 10                 TRA     s:10961
        10 002020   003522 710000 10                 TRA     s:10279
        10 002021   010016 710000 10                 TRA     MADLIST
        10 002022   010272 710000 10                 TRA     s:11054
        10 002023   010275 710000 10                 TRA     s:11060
        10 002024   010513 710000 10                 TRA     s:11102
        10 002025   010513 710000 10                 TRA     s:11102
        10 002026   010513 710000 10                 TRA     s:11102
        10 002027   010526 710000 10                 TRA     s:11105
        10 002030   007764 710000 10                 TRA     s:10985
        10 002031   007703 710000 10                 TRA     s:10961
        10 002032   010564 710000 10                 TRA     s:11121
        10 002033   011046 710000 10                 TRA     s:11177
        10 002034   011143 710000 10                 TRA     s:11195
        10 002035   011177 710000 10                 TRA     s:11209
        10 002036   002051 710000 10                 TRA     s:10010

      739     9995    2      CASE(%(E$END-E$PIGH),%(E$XIT-E$PIGH),%(E$QUIT-E$PIGH));

      740     9996                    /*E*     ERROR: FXP-E$END-0
      741     9997                    *        MESSAGE:End - exits from PIG.
      742     9998                    */
      743     9999                    /*E*     ERROR: FXP-E$XIT-0
      744    10000                    *        MESSAGE:eXit - exits from PIG.
      745    10001                    */
      746    10002                    /*E*     ERROR: FXP-E$QUIT-0
      747    10003                    *        MESSAGE:Quit - exits from PIG.
      748    10004                    */
      749    10005    2         CALL CLOSE(DCBNUM(M$LO));

  10005 10 002037   000000 236007 xsym               LDQ     M$LO,DL
        10 002040   201353 756100                    STQ     BXP+6,,AUTO
        10 002041   201353 630500                    EPPR0   BXP+6,,AUTO
        10 002042   201341 450500                    STP0    P$+2,,AUTO
        10 002043   012416 701000 10                 TSX1    CLOSE
        10 002044   000000 011000                    NOP     0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:186  
      750    10006    2         IF BANNERSZ=0 THEN ALTRETURN;

  10006 10 002045   001126 235000 0                  LDA     BANNERSZ
        10 002046   002050 601000 10                 TNZ     s:10007

  10006 10 002047   000000 702200 xent               TSX2  ! X66_AALT

      751    10007    2         RETURN;

  10007 10 002050   000000 702200 xent               TSX2  ! X66_ARET

      752    10008        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:187  
      753    10009    2      CASE(%(E$AVR-E$PIGH));

      754    10010    2         CODE=0;

  10010 10 002051   200007 450100                    STZ     CODE,,AUTO

      755    10011    2         X9=20;

  10011 10 002052   000024 235007                    LDA     20,DL
        10 002053   200006 755100                    STA     X9,,AUTO

      756    10012    2         IF GBUF.PSN(0)~='*INIT*'

  10012 10 002054   040000 106400                    CMPC    fill='040'O
        10 002055   000707 000006 0                  ADSC9   TEXT+1                   cn=0,n=6
        10 002056   000515 000006 2                  ADSC9   FFLGS+38                 cn=0,n=6
        10 002057   002063 600000 10                 TZE     s:10015

      757    10013    2         THEN
      758    10014    2   AVR0: CALL M$WAIT(WAIT1);

  10014 10 002060   000026 630400 2     AVR0         EPPR0   WAIT1
        10 002061   020006 713400                    CLIMB   8198
        10 002062   400400 401760                    pmme    nvectors=2

      759    10015    2         CALL M$OPEN(OPNDP)ALTRET(AVRERR);

  10015 10 002063   000100 630400 0                  EPPR0   OPNDP
        10 002064   450000 713400                    CLIMB   alt,open
        10 002065   410400 401760                    pmme    nvectors=18
        10 002066   002220 702000 10                 TSX2    AVRERR

      760    10016    2         X9=F$DCB.SETX;

  10016 10 002067   000000 470400 xsym               LDP0    M$DP$
        10 002070   000051 236100                    LDQ     41,,PR0
        10 002071   777777 376007                    ANQ     -1,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:188  
        10 002072   200006 756100                    STQ     X9,,AUTO

      761    10017    2         IF FM$DEV.SPIN(X9) THEN CALL M$READ(READVID)ALTRET(NOALT);

  10017 10 002073   200006 235100                    LDA     X9,,AUTO
        10 002074   000003 735000                    ALS     3
        10 002075   000000 471400 xsym               LDP1    F$CFU$
        10 002076   100002 236105                    LDQ     2,AL,PR1
        10 002077   004000 316003                    CANQ    2048,DU
        10 002100   002105 600000 10                 TZE     s:10018

  10017 10 002101   000416 630400 0                  EPPR0   READVID
        10 002102   440000 713400                    CLIMB   alt,read
        10 002103   401400 401760                    pmme    nvectors=4
        10 002104   014123 702000 10                 TSX2    NOALT

      762    10018    2         WROC.DEVNM=F$DCB.PASS;

  10018 10 002105   000000 470400 xsym               LDP0    M$DP$
        10 002106   000022 237100                    LDAQ    18,,PR0
        10 002107   006671 755000 0                  STA     WROC+3
        10 002110   006672 756000 0                  STQ     WROC+4

      763    10019    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);

  10019 10 002111   000172 630400 0                  EPPR0   CLSDP
        10 002112   450001 713400                    CLIMB   alt,close
        10 002113   406000 401760                    pmme    nvectors=13
        10 002114   013551 702000 10                 TSX2    DPERR

      764    10020    3         IF FM$DEV.DCTX(X9)=X9 THEN DO;

  10020 10 002115   200006 235100                    LDA     X9,,AUTO
        10 002116   000003 735000                    ALS     3
        10 002117   000000 470400 xsym               LDP0    F$CFU$
        10 002120   000000 236105                    LDQ     0,AL,PR0
        10 002121   000022 772000                    QRL     18
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:189  
        10 002122   200006 116100                    CMPQ    X9,,AUTO
        10 002123   002142 601000 10                 TNZ     s:10026

      765    10021    3            VIDBUF.VOLCNT=0; /* ONLY FIX A PARTIAL VSN RECORD */

  10021 10 002124   000000 220003                    LDX0    0,DU
        10 002125   002625 440000 0                  SXL0    VIDBUF+4

      766    10022    3            CALL FXU$CATMNT;

  10022 10 002126   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 002127   000000 701000 xent               TSX1    FXU$CATMNT
        10 002130   000000 011000                    NOP     0

      767    10023    3            IF FM$DEV.SECTL(X9)=0 OR NOT FM$DEV.SPIN(X9) THEN GOTO DISP0;

  10023 10 002131   200006 235100                    LDA     X9,,AUTO
        10 002132   000003 735000                    ALS     3
        10 002133   000000 470400 xsym               LDP0    F$CFU$
        10 002134   000005 720105                    LXL0    5,AL,PR0
        10 002135   002441 600000 10                 TZE     DISP0
        10 002136   000002 236105                    LDQ     2,AL,PR0
        10 002137   004000 316003                    CANQ    2048,DU
        10 002140   002441 600000 10                 TZE     DISP0

      768    10024    3            ELSE GOTO NEXT;

  10024 10 002141   000204 710000 10                 TRA     NEXT

      769    10025    3            END;
      770    10026    2         J=FM$VOL.SETX(X9);

  10026 10 002142   000000 236105                    LDQ     0,AL,PR0
        10 002143   777777 376007                    ANQ     -1,DL
        10 002144   001104 756000 0                  STQ     J

      771    10027    2         IF J=0 THEN GOTO DISP0;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:190  

  10027 10 002145   002441 600000 10                 TZE     DISP0

      772    10028    3         DO I=0 TO NUMPSNS;

  10028 10 002146   001076 450000 0                  STZ     I
        10 002147   002176 710000 10                 TRA     s:10033+3

      773    10029    3            IF CSTAT.SETS.PSN(I)=FM$SET.PSN(J)

  10029 10 002150   001076 235000 0                  LDA     I
        10 002151   000003 735000                    ALS     3
        10 002152   001104 236000 0                  LDQ     J
        10 002153   000005 736000                    QLS     5
        10 002154   000000 470400 xsym               LDP0    F$CFU$
        10 002155   040106 106405                    CMPC    fill='040'O
        10 002156   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6
        10 002157   000000 400006                    ADSC9   0,Q,PR0                  cn=2,n=6
        10 002160   002165 600000 10                 TZE     s:10031
        10 002161   040106 106405                    CMPC    fill='040'O
        10 002162   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6
        10 002163   000005 400006                    ADSC9   5,Q,PR0                  cn=2,n=6
        10 002164   002173 601000 10                 TNZ     s:10033

      774    10030    3              OR CSTAT.SETS.PSN(I)=FM$SET.REALPSN(J)
      775    10031    3            THEN IF CSTAT.SETS.SETX(I)=0 THEN GOTO MOUNT1;

  10031 10 002165   001076 235000 0                  LDA     I
        10 002166   000001 735000                    ALS     1
        10 002167   004624 236005 0                  LDQ     CSTAT+3,AL
        10 002170   000777 316007                    CANQ    511,DL
        10 002171   007147 600000 10                 TZE     MOUNT1

      776    10032    3            ELSE GOTO DISP0;

  10032 10 002172   002441 710000 10                 TRA     DISP0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:191  
      777    10033    3            END;

  10033 10 002173   001076 235000 0                  LDA     I
        10 002174   000001 035007                    ADLA    1,DL
        10 002175   001076 755000 0                  STA     I
        10 002176   004621 236000 0                  LDQ     CSTAT
        10 002177   001076 116000 0                  CMPQ    I
        10 002200   002150 603000 10                 TRC     s:10029

      778    10034    2         OPNSN.SN#(0)=FM$SET.PSN(J);

  10034 10 002201   001104 235000 0                  LDA     J
        10 002202   000005 735000                    ALS     5
        10 002203   040000 100505                    MLR     fill='040'O
        10 002204   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6
        10 002205   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

      779    10035    2         CALL FXU$CATMNT ALTRET(MOUNT1);

  10035 10 002206   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 002207   000000 701000 xent               TSX1    FXU$CATMNT
        10 002210   007147 702000 10                 TSX2    MOUNT1

      780    10036    2         IF CSTAT.DEFMOUNT~=0 AND VIDBUF.PSN~='CP-6''S' THEN GOTO MOUNT00;

  10036 10 002211   004622 235000 0                  LDA     CSTAT+1
        10 002212   002217 600000 10                 TZE     s:10037
        10 002213   040000 106400                    CMPC    fill='040'O
        10 002214   002624 000006 0                  ADSC9   VIDBUF+3                 cn=0,n=6
        10 002215   000542 000006 2                  ADSC9   FFLGS+59                 cn=0,n=6
        10 002216   007073 601000 10                 TNZ     MOUNT00

      781    10037    2         GOTO DISP0;

  10037 10 002217   002441 710000 10                 TRA     DISP0

  10036 10 002220                       AVRERR       null
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:192  
      782    10038    2   AVRERR:;
      783    10039    2         X9=X9-1;

  10039 10 002220   200006 235100                    LDA     X9,,AUTO
        10 002221   000001 135007                    SBLA    1,DL
        10 002222   200006 755100                    STA     X9,,AUTO

      784    10040    2         IF B$ALT.ERR.CODE=%E$XCLSET AND X9~=0 THEN GOTO AVR0;

  10040 10 002223   000000 470400 xsym               LDP0    B$TCB$
        10 002224   000000 471500                    LDP1    0,,PR0
        10 002225   100102 236100                    LDQ     66,,PR1
        10 002226   377770 376007                    ANQ     131064,DL
        10 002227   002170 116007                    CMPQ    1144,DL
        10 002230   002233 601000 10                 TNZ     s:10041
        10 002231   000000 115003                    CMPA    0,DU
        10 002232   002060 601000 10                 TNZ     AVR0

      785    10041    2         IF B$ALT.ERR.CODE~=%E$SETDOWN THEN GOTO DPERR;

  10041 10 002233   002200 116007                    CMPQ    1152,DL
        10 002234   013551 601000 10                 TNZ     DPERR
        10 002235   011257 710000 10                 TRA     s:11238

      786    10042        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:193  
      787    10043    2      CASE(%(E$DISPLAY-E$PIGH));

      788    10044                    /*E*     ERROR: FXP-E$DISPLAY-0
      789    10045                    *        MESSAGE:Display [option]
      790    10046                    *        where option is either SETS, DP#set, or device-name
      791    10047                    */
      792    10048    2         CALL M$SAD(SETSAD)ALTRET(DPERR);

  10048 10 002236   000052 630400 2                  EPPR0   SETSAD
        10 002237   430015 713400                    CLIMB   alt,+12301
        10 002240   400000 401760                    pmme    nvectors=1
        10 002241   013551 702000 10                 TSX2    DPERR

      793    10049    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);

  10049 10 002242   000640 630400 0                  EPPR0   DIAGFPT
        10 002243   420012 713400                    CLIMB   alt,+8202
        10 002244   400000 401760                    pmme    nvectors=1
        10 002245   014123 702000 10                 TSX2    NOALT

      794    10050    2         IF OUT$BLK.NSUBLKS~=0 THEN OPNSN.SN#(0)=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  10050 10 002246   001073 470400 0                  LDP0    BLK$
        10 002247   000001 220100                    LDX0    1,,PR0
        10 002250   002260 600000 10                 TZE     s:10051

  10050 10 002251   000004 471500                    LDP1    4,,PR0
        10 002252   100004 236100                    LDQ     4,,PR1
        10 002253   000033 772000                    QRL     27
        10 002254   000000 621006                    EAX1    0,QL
        10 002255   040000 100540                    MLR     fill='040'O
        10 002256   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 002257   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

      795    10051    3         IF OPNSN.SN#(0)~=' ' THEN DO;

  10051 10 002260   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:194  
        10 002261   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 002262   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 002263   002416 600000 10                 TZE     s:10084

      796    10052    3            IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0 AND OPNSN.SN#(0)='SETS'

  10052 10 002264   000004 471500                    LDP1    4,,PR0
        10 002265   100000 720100                    LXL0    0,,PR1
        10 002266   002273 601000 10                 TNZ     s:10054
        10 002267   040000 106400                    CMPC    fill='040'O
        10 002270   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 002271   000517 000004 2                  ADSC9   FFLGS+40                 cn=0,n=4
        10 002272   003176 600000 10                 TZE     DISPS

      797    10053    3            THEN GOTO DISPS;
      798    10054    3            CODE=0;/* ONLY ONE THING THIS TIME */

  10054 10 002273   200007 450100                    STZ     CODE,,AUTO

      799    10055    3            X9=FM$CFUX.SETH;

  10055 10 002274   000000 471400 xsym               LDP1    F$CFU$
        10 002275   100005 236100                    LDQ     5,,PR1
        10 002276   000022 772000                    QRL     18
        10 002277   200006 756100                    STQ     X9,,AUTO

      800    10056    3            P_PCB.HI_CHAR=OUT$BLK.SUBLK$(1)->OUT$BLK.CPOS;

  10056 10 002300   000004 473500                    LDP3    4,,PR0
        10 002301   300002 235100                    LDA     2,,PR3
        10 002302   001026 755000 0                  STA     P_PCB+10

      801    10057    4            DO WHILE(X9~=0 AND FM$SET.PSN(X9)~=OPNSN.SN#(0));

  10057 10 002303   002312 710000 10                 TRA     s:10059

      802    10058    4               X9=FM$SET.SETL(X9);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:195  

  10058 10 002304   200006 235100                    LDA     X9,,AUTO
        10 002305   000003 735000                    ALS     3
        10 002306   000000 470400 xsym               LDP0    F$CFU$
        10 002307   000005 236105                    LDQ     5,AL,PR0
        10 002310   000022 772000                    QRL     18
        10 002311   200006 756100                    STQ     X9,,AUTO

      803    10059    4               END;

  10059 10 002312   000000 116003                    CMPQ    0,DU
        10 002313   002323 600000 10                 TZE     s:10060
        10 002314   200006 235100                    LDA     X9,,AUTO
        10 002315   000005 735000                    ALS     5
        10 002316   000000 470400 xsym               LDP0    F$CFU$
        10 002317   040000 106505                    CMPC    fill='040'O
        10 002320   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6
        10 002321   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 002322   002304 601000 10                 TNZ     s:10058

      804    10060    3            IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE~=0 THEN GOTO DISPS0;

  10060 10 002323   001073 470400 0                  LDP0    BLK$
        10 002324   000004 471500                    LDP1    4,,PR0
        10 002325   100000 720100                    LXL0    0,,PR1
        10 002326   003203 601000 10                 TNZ     DISPS0

      805    10061    3            IF SUBSTR(OPNSN.SN#(0),0,2)='DP'

  10061 10 002327   000073 221000 0                  LDX1    OPNSN+1
        10 002330   000544 101000 2                  CMPX1   FFLGS+61
        10 002331   002364 601000 10                 TNZ     s:10070
        10 002332   000073 236000 0                  LDQ     OPNSN+1
        10 002333   777000 376007                    ANQ     -512,DL
        10 002334   060000 116007                    CMPQ    24576,DL
        10 002335   002364 602000 10                 TNC     s:10070
        10 002336   000073 236000 0                  LDQ     OPNSN+1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:196  
        10 002337   777000 376007                    ANQ     -512,DL
        10 002340   071000 116007                    CMPQ    29184,DL
        10 002341   002343 600000 10                 TZE     s:10061+12
        10 002342   002364 603000 10                 TRC     s:10070
        10 002343   000073 236000 0                  LDQ     OPNSN+1
        10 002344   000777 376007                    ANQ     511,DL
        10 002345   000060 116007                    CMPQ    48,DL
        10 002346   002364 602000 10                 TNC     s:10070
        10 002347   000073 236000 0                  LDQ     OPNSN+1
        10 002350   000777 376007                    ANQ     511,DL
        10 002351   000071 116007                    CMPQ    57,DL
        10 002352   002354 600000 10                 TZE     s:10067
        10 002353   002364 603000 10                 TRC     s:10070

      806    10062    3              AND SUBSTR(OPNSN.SN#(0),2,1)>='0'
      807    10063    3              AND SUBSTR(OPNSN.SN#(0),2,1)<='9'
      808    10064    3              AND SUBSTR(OPNSN.SN#(0),3,1)>='0'
      809    10065    3              AND SUBSTR(OPNSN.SN#(0),3,1)<='9'
      810    10066    4            THEN DO;

      811    10067    4               CALL INSERT(WROC.DEVNM,2,2,SUBSTR(OPNSN.SN#(0),2,2));

  10067 10 002354   000073 722000 0                  LXL2    OPNSN+1
        10 002355   006671 442000 0                  SXL2    WROC+3

      812    10068    4               CALL CONCAT(OPNSN.SN#(0),BINASC(0),SUBSTR(WROC.DEVNM,0,4));

  10068 10 002356   000000 236003                    LDQ     0,DU
        10 002357   000073 552040 0                  STBQ    OPNSN+1,'40'O
        10 002360   040000 100400                    MLR     fill='040'O
        10 002361   006671 000004 0                  ADSC9   WROC+3                   cn=0,n=4
        10 002362   000073 200005 0                  ADSC9   OPNSN+1                  cn=1,n=5

      813    10069    4               END;

  10069 10 002363   002400 710000 10                 TRA     s:10077

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:197  
      814    10070    3            ELSE IF MODE~=0 THEN GOTO PARSERR;

  10070 10 002364   001121 235000 0                  LDA     MODE
        10 002365   011553 601000 10                 TNZ     PARSERR

      815    10071    4            ELSE DO;

      816    10072    4               WROC.MSG#=%PIG_DEVERR_MSG#;

  10072 10 002366   000461 222003                    LDX2    305,DU
        10 002367   006666 442000 0                  SXL2    WROC

      817    10073    4               WROC.PSN=SUBSTR(OPNSN.SN#(0),0,4);

  10073 10 002370   040000 100400                    MLR     fill='040'O
        10 002371   000073 000004 0                  ADSC9   OPNSN+1                  cn=0,n=4
        10 002372   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6

      818    10074    4               CALL ERROR(10);

  10074 10 002373   000016 236000 11                 LDQ     14
        10 002374   201341 756100                    STQ     P$+2,,AUTO
        10 002375   011704 701000 10                 TSX1    ERROR
        10 002376   000000 011000                    NOP     0

      819    10075    4               GOTO NEXT;

  10075 10 002377   000204 710000 10                 TRA     NEXT

      820    10076    4               END;
      821    10077    3            CALL M$OPEN(OPNDP)ALTRET(NOALT);

  10077 10 002400   000100 630400 0                  EPPR0   OPNDP
        10 002401   450000 713400                    CLIMB   alt,open
        10 002402   410400 401760                    pmme    nvectors=18
        10 002403   014123 702000 10                 TSX2    NOALT

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:198  
      822    10078    3            IF SUBSTR(OPNSN.SN#(0),0,2)=%CONCAT(BINASC(0),BINASC(0))

  10078 10 002404   000073 220000 0                  LDX0    OPNSN+1
        10 002405   000545 100000 2                  CMPX0   FFLGS+62
        10 002406   002411 601000 10                 TNZ     s:10081

      823    10079    3            THEN SUBSTR(OPNSN.SN#(0),0,2)='@@';

  10079 10 002407   000546 221000 2                  LDX1    FFLGS+63
        10 002410   000073 741000 0                  STX1    OPNSN+1

      824    10080                    /* Only display one line for a reconstruct avr message */
      825    10081    3            X9=F$DCB.SETX;

  10081 10 002411   000000 470400 xsym               LDP0    M$DP$
        10 002412   000051 236100                    LDQ     41,,PR0
        10 002413   777777 376007                    ANQ     -1,DL
        10 002414   200006 756100                    STQ     X9,,AUTO

      826    10082    3            GOTO DISP0;

  10082 10 002415   002441 710000 10                 TRA     DISP0

      827    10083    3            END;
      828    10084    2         X9=FM$CFUX.DSETH;

  10084 10 002416   000000 471400 xsym               LDP1    F$CFU$
        10 002417   100005 236100                    LDQ     5,,PR1
        10 002420   777777 376007                    ANQ     -1,DL
        10 002421   200006 756100                    STQ     X9,,AUTO

      829    10085    3         DO WHILE (X9~=0);

  10085 10 002422   003176 600000 10                 TZE     DISPS

      830    10086    3            CALL CONCAT(OPNSN.SN#(0),BINASC(0),BINASC(0),ADDR(X9)->CHAR4);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:199  
  10086 10 002423   000000 236003                    LDQ     0,DU
        10 002424   000073 552040 0                  STBQ    OPNSN+1,'40'O
        10 002425   000073 552020 0                  STBQ    OPNSN+1,'20'O
        10 002426   040000 100500                    MLR     fill='040'O
        10 002427   200006 000004                    ADSC9   X9,,AUTO                 cn=0,n=4
        10 002430   000073 400004 0                  ADSC9   OPNSN+1                  cn=2,n=4

      831    10087    3            CALL M$OPEN(OPNDP)ALTRET(NOALT);

  10087 10 002431   000100 630400 0                  EPPR0   OPNDP
        10 002432   450000 713400                    CLIMB   alt,open
        10 002433   410400 401760                    pmme    nvectors=18
        10 002434   014123 702000 10                 TSX2    NOALT

      832    10088    3            WROC.DEVNM=F$DCB.PASS;

  10088 10 002435   000000 470400 xsym               LDP0    M$DP$
        10 002436   000022 237100                    LDAQ    18,,PR0
        10 002437   006671 755000 0                  STA     WROC+3
        10 002440   006672 756000 0                  STQ     WROC+4

  10088 10 002441                       DISP0        null
      833    10089    3   DISP0:   ;
      834    10090    3            CALL CLOSE(DCBNUM(M$DP));

  10090 10 002441   000000 236007 xsym               LDQ     M$DP,DL
        10 002442   201354 756100                    STQ     BXP+7,,AUTO
        10 002443   201354 630500                    EPPR0   BXP+7,,AUTO
        10 002444   201341 450500                    STP0    P$+2,,AUTO
        10 002445   012416 701000 10                 TSX1    CLOSE
        10 002446   000000 011000                    NOP     0

      835    10091    3            REMEMBER DISP0 IN TRAPX;

  10091 10 002447   002441 635000 10                 EAA     DISP0
        10 002450   001100 452400 0                  STP2    TRAPX
        10 002451   001101 755000 0                  STA     TRAPX+1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:200  

      836    10092    3            WROC.MSG#=DISK_MSG#;

  10092 10 002452   000454 220003                    LDX0    300,DU
        10 002453   006666 440000 0                  SXL0    WROC

      837    10093    3            LBUFC='DPNN is not a CP6 pack';

  10093 10 002454   040000 100400                    MLR     fill='040'O
        10 002455   000547 000026 2                  ADSC9   FFLGS+64                 cn=0,n=22
        10 002456   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

      838    10094    3            DBUF.DEV=SUBSTR(WROC.DEVNM,2,2);

  10094 10 002457   006671 721000 0                  LXL1    WROC+3
        10 002460   006702 441000 0                  SXL1    LBUFC

      839    10095    4            IF FM$DEV.SPIN(X9) AND X9~=0 THEN DO;

  10095 10 002461   200006 236100                    LDQ     X9,,AUTO
        10 002462   000003 736000                    QLS     3
        10 002463   000000 470400 xsym               LDP0    F$CFU$
        10 002464   000002 236106                    LDQ     2,QL,PR0
        10 002465   004000 316003                    CANQ    2048,DU
        10 002466   003077 600000 10                 TZE     s:10182
        10 002467   200006 236100                    LDQ     X9,,AUTO
        10 002470   003077 600000 10                 TZE     s:10182

  10093 10 002471                       DISP1        null
      840    10096    4   DISP1:      ;
      841    10097    4               WROC.VSN=FM$VOL.VSN(X9);

  10097 10 002471   200006 235100                    LDA     X9,,AUTO
        10 002472   000003 735000                    ALS     3
        10 002473   000000 470400 xsym               LDP0    F$CFU$
        10 002474   000001 236105                    LDQ     1,AL,PR0
        10 002475   000032 376000 xsym               ANQ     B_VECTNIL+26
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:201  
        10 002476   006675 756000 0                  STQ     WROC+7

      842    10098    4               WROC.N=0;

  10098 10 002477   000000 220003                    LDX0    0,DU
        10 002500   006677 440000 0                  SXL0    WROC+9

      843    10099    4               WROC.PSN=' ';

  10099 10 002501   040000 100400                    MLR     fill='040'O
        10 002502   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 002503   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6

      844    10100    4               IF FM$DEV.DCTX(X9)=X9 AND FM$DEV.SECTL(X9)~=0

  10100 10 002504   000000 236105                    LDQ     0,AL,PR0
        10 002505   000022 772000                    QRL     18
        10 002506   200006 116100                    CMPQ    X9,,AUTO
        10 002507   002520 601000 10                 TNZ     s:10103
        10 002510   000005 721105                    LXL1    5,AL,PR0
        10 002511   002520 600000 10                 TZE     s:10103
        10 002512   000002 236105                    LDQ     2,AL,PR0
        10 002513   002000 316003                    CANQ    1024,DU
        10 002514   002520 601000 10                 TNZ     s:10103

      845    10101    4                 AND NOT FM$DEV.MIRROR(X9)
      846    10102    4               THEN X9=FM$DEV.SECTL(X9);

  10102 10 002515   000005 236105                    LDQ     5,AL,PR0
        10 002516   777777 376007                    ANQ     -1,DL
        10 002517   200006 756100                    STQ     X9,,AUTO

      847    10103    4               IF FM$DEV.DCTX(X9)=X9 THEN I=0;

  10103 10 002520   200006 235100                    LDA     X9,,AUTO
        10 002521   000003 735000                    ALS     3
        10 002522   000000 236105                    LDQ     0,AL,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:202  
        10 002523   000022 772000                    QRL     18
        10 002524   200006 116100                    CMPQ    X9,,AUTO
        10 002525   002530 601000 10                 TNZ     s:10104

  10103 10 002526   001076 450000 0                  STZ     I
        10 002527   002533 710000 10                 TRA     s:10105

      848    10104    4               ELSE I=FM$VOL.SETX(X9);

  10104 10 002530   000000 236105                    LDQ     0,AL,PR0
        10 002531   777777 376007                    ANQ     -1,DL
        10 002532   001076 756000 0                  STQ     I

      849    10105    5               IF I~=0 THEN DO;

  10105 10 002533   001076 236000 0                  LDQ     I
        10 002534   002600 600000 10                 TZE     s:10120

      850    10106    5                  WROC.VOL=FM$VOL.VOL#(X9);

  10106 10 002535   000003 236105                    LDQ     3,AL,PR0
        10 002536   006700 552040 0                  STBQ    WROC+10,'40'O

      851    10107    6                  IF FM$SET.REALPSN(I)=' ' THEN DO;

  10107 10 002537   001076 236000 0                  LDQ     I
        10 002540   000005 736000                    QLS     5
        10 002541   040000 106506                    CMPC    fill='040'O
        10 002542   000005 400006                    ADSC9   5,Q,PR0                  cn=2,n=6
        10 002543   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 002544   002554 601000 10                 TNZ     s:10112

      852    10108    6                     WROC.PSN=FM$SET.PSN(I);

  10108 10 002545   040000 100506                    MLR     fill='040'O
        10 002546   000000 400006                    ADSC9   0,Q,PR0                  cn=2,n=6
        10 002547   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:203  

      853    10109    6                     WROC.DPSN=' ';

  10109 10 002550   040000 100400                    MLR     fill='040'O
        10 002551   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 002552   006700 400006 0                  ADSC9   WROC+10                  cn=2,n=6

      854    10110    6                     END;

  10110 10 002553   002562 710000 10                 TRA     s:10115

      855    10111    6                  ELSE DO;

      856    10112    6                     WROC.PSN=FM$SET.REALPSN(I);

  10112 10 002554   040000 100506                    MLR     fill='040'O
        10 002555   000005 400006                    ADSC9   5,Q,PR0                  cn=2,n=6
        10 002556   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6

      857    10113    6                     WROC.DPSN=FM$SET.PSN(I);

  10113 10 002557   040000 100506                    MLR     fill='040'O
        10 002560   000000 400006                    ADSC9   0,Q,PR0                  cn=2,n=6
        10 002561   006700 400006 0                  ADSC9   WROC+10                  cn=2,n=6

      858    10114    6                     END;

      859    10115    5                  WROC.N=FM$SET.SYSID(I);

  10115 10 002562   001076 235000 0                  LDA     I
        10 002563   000003 735000                    ALS     3
        10 002564   000002 721105                    LXL1    2,AL,PR0
        10 002565   006677 441000 0                  SXL1    WROC+9

      860    10116    5                  IF NOT FM$SET.XCL(I)

  10116 10 002566   000002 234105                    SZN     2,AL,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:204  
        10 002567   002600 604000 10                 TMI     s:10120

      861    10117    5                  THEN IF FM$SET.NONEWU(I) THEN WROC.N=3;

  10117 10 002570   000002 236105                    LDQ     2,AL,PR0
        10 002571   040000 316003                    CANQ    16384,DU
        10 002572   002576 600000 10                 TZE     s:10118

  10117 10 002573   000003 222003                    LDX2    3,DU
        10 002574   006677 442000 0                  SXL2    WROC+9
        10 002575   002600 710000 10                 TRA     s:10120

      862    10118    5                  ELSE WROC.N=2;

  10118 10 002576   000002 222003                    LDX2    2,DU
        10 002577   006677 442000 0                  SXL2    WROC+9

      863    10119    5                  END;

      864    10120    5               IF WROC.VSN~=0 THEN DO;

  10120 10 002600   006675 235000 0                  LDA     WROC+7
        10 002601   003125 600000 10                 TZE     s:10191

      865    10121    5                  I=4;

  10121 10 002602   000004 236007                    LDQ     4,DL
        10 002603   001076 756000 0                  STQ     I

      866    10122    5                  J=WROC.VSN;

  10122 10 002604   001104 755000 0                  STA     J

      867    10123    5                  CALL ADDPARNUM(%M#VSN);

  10123 10 002605   000027 236000 11                 LDQ     23
        10 002606   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:205  
        10 002607   014155 701000 10                 TSX1    ADDPARNUM
        10 002610   000000 011000                    NOP     0

      868    10124    6                  IF FM$VOL.SECT#(X9)~=0 THEN DO;

  10124 10 002611   200006 235100                    LDA     X9,,AUTO
        10 002612   000003 735000                    ALS     3
        10 002613   000000 470400 xsym               LDP0    F$CFU$
        10 002614   000001 236105                    LDQ     1,AL,PR0
        10 002615   777000 316003                    CANQ    -512,DU
        10 002616   002640 600000 10                 TZE     s:10129

      869    10125    6                     CALL INSERT(LBUFC,I,1,BINASC(FM$VOL.SECT#(X9)+ASCBIN('@')));

  10125 10 002617   000001 236105                    LDQ     1,AL,PR0
        10 002620   000033 772000                    QRL     27
        10 002621   000100 036007                    ADLQ    64,DL
        10 002622   000033 736000                    QLS     27
        10 002623   000010 276000 11                 ORQ     8
        10 002624   201346 756100                    STQ     BXP+1,,AUTO
        10 002625   001076 235000 0                  LDA     I
        10 002626   040005 100500                    MLR     fill='040'O
        10 002627   201346 000004                    ADSC9   BXP+1,,AUTO              cn=0,n=4
        10 002630   006702 000001 0                  ADSC9   LBUFC,A                  cn=0,n=1

      870    10126    6                     WROC.SECT=SUBSTR(LBUFC,I,1);

  10126 10 002631   001076 235000 0                  LDA     I
        10 002632   040000 100405                    MLR     fill='040'O
        10 002633   006702 000001 0                  ADSC9   LBUFC,A                  cn=0,n=1
        10 002634   006700 200001 0                  ADSC9   WROC+10                  cn=1,n=1

      871    10127    6                     I=I+1;

  10127 10 002635   000001 035007                    ADLA    1,DL
        10 002636   001076 755000 0                  STA     I

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:206  
      872    10128    6                     END;

  10128 10 002637   002642 710000 10                 TRA     s:10130

      873    10129    5                  ELSE WROC.SECT=' ';

  10129 10 002640   000040 236003                    LDQ     32,DU
        10 002641   006700 552020 0                  STBQ    WROC+10,'20'O

      874    10130    5                  IF FM$DEV.MIRROR(X9) THEN WROC.N=4;

  10130 10 002642   200006 235100                    LDA     X9,,AUTO
        10 002643   000003 735000                    ALS     3
        10 002644   000002 236105                    LDQ     2,AL,PR0
        10 002645   002000 316003                    CANQ    1024,DU
        10 002646   002651 600000 10                 TZE     s:10131

  10130 10 002647   000004 220003                    LDX0    4,DU
        10 002650   006677 440000 0                  SXL0    WROC+9

      875    10131    6                  IF WROC.PSN~=' ' THEN DO;

  10131 10 002651   040000 106400                    CMPC    fill='040'O
        10 002652   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6
        10 002653   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 002654   002734 600000 10                 TZE     s:10143

      876    10132    6                     J=WROC.VOL;

  10132 10 002655   006700 236000 0                  LDQ     WROC+10
        10 002656   000033 772000                    QRL     27
        10 002657   001104 756000 0                  STQ     J

      877    10133    6                     CALL ADDPARNUM(%MVOL#);

  10133 10 002660   000031 236000 11                 LDQ     25
        10 002661   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:207  
        10 002662   014155 701000 10                 TSX1    ADDPARNUM
        10 002663   000000 011000                    NOP     0

      878    10134    6                     CALL ADDPARAM(%M#PSN);

  10134 10 002664   000033 236000 11                 LDQ     27
        10 002665   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 002666   014226 701000 10                 TSX1    ADDPARAM
        10 002667   000000 011000                    NOP     0

      879    10135    6                     CALL ADDPART(6,WROC.PSN);

  10135 10 002670   000034 236000 11                 LDQ     28
        10 002671   201336 756100                    STQ     K+1,,AUTO
        10 002672   000035 236000 11                 LDQ     29
        10 002673   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 002674   014145 701000 10                 TSX1    ADDPART
        10 002675   000000 011000                    NOP     0

      880    10136    7                     IF WROC.DPSN~=' ' THEN DO;

  10136 10 002676   040000 106400                    CMPC    fill='040'O
        10 002677   006700 400006 0                  ADSC9   WROC+10                  cn=2,n=6
        10 002700   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 002701   002724 600000 10                 TZE     s:10141

      881    10137    7                        CALL ADDPART(2,' (');

  10137 10 002702   000036 236000 11                 LDQ     30
        10 002703   201336 756100                    STQ     K+1,,AUTO
        10 002704   000037 236000 11                 LDQ     31
        10 002705   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 002706   014145 701000 10                 TSX1    ADDPART
        10 002707   000000 011000                    NOP     0

      882    10138    7                        CALL ADDPART(6,WROC.DPSN);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:208  
  10138 10 002710   000040 236000 11                 LDQ     32
        10 002711   201336 756100                    STQ     K+1,,AUTO
        10 002712   000035 236000 11                 LDQ     29
        10 002713   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 002714   014145 701000 10                 TSX1    ADDPART
        10 002715   000000 011000                    NOP     0

      883    10139    7                        CALL ADDPART(1,')');

  10139 10 002716   000042 236000 11                 LDQ     34
        10 002717   201336 756100                    STQ     K+1,,AUTO
        10 002720   000043 236000 11                 LDQ     35
        10 002721   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 002722   014145 701000 10                 TSX1    ADDPART
        10 002723   000000 011000                    NOP     0

      884    10140    7                        END;

      885    10141    6                     IF WROC.PSN='CP-6''S' AND WROC.N=0 THEN WROC.N=1;

  10141 10 002724   040000 106400                    CMPC    fill='040'O
        10 002725   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6
        10 002726   000542 000006 2                  ADSC9   FFLGS+59                 cn=0,n=6
        10 002727   002734 601000 10                 TNZ     s:10143
        10 002730   006677 720000 0                  LXL0    WROC+9
        10 002731   002734 601000 10                 TNZ     s:10143

  10141 10 002732   000001 221003                    LDX1    1,DU
        10 002733   006677 441000 0                  SXL1    WROC+9

      886    10142    6                     END;

      887    10143    6                  DO CASE(WROC.N);

  10143 10 002734   006677 720000 0                  LXL0    WROC+9
        10 002735   000005 100003                    CMPX0   5,DU
        10 002736   002740 602010 10                 TNC     s:10143+4,X0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:209  
        10 002737   003067 710000 10                 TRA     s:10176
        10 002740   003062 710000 10                 TRA     s:10174
        10 002741   002757 710000 10                 TRA     s:10149
        10 002742   002745 710000 10                 TRA     s:10145
        10 002743   002752 710000 10                 TRA     s:10147
        10 002744   002772 710000 10                 TRA     s:10153

      888    10144    6                  CASE(2);

      889    10145    6                     CALL ADDPARAM(%MSHARED);

  10145 10 002745   000045 236000 11                 LDQ     37
        10 002746   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 002747   014226 701000 10                 TSX1    ADDPARAM
        10 002750   000000 011000                    NOP     0
        10 002751   003125 710000 10                 TRA     s:10191

      890    10146    6                  CASE(3);

      891    10147    6                     CALL ADDPARAM(%MLOCKED);

  10147 10 002752   000047 236000 11                 LDQ     39
        10 002753   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 002754   014226 701000 10                 TSX1    ADDPARAM
        10 002755   000000 011000                    NOP     0
        10 002756   003125 710000 10                 TRA     s:10191

      892    10148    6                  CASE(1);

      893    10149    6                     J=666;

  10149 10 002757   001232 235007                    LDA     666,DL
        10 002760   001104 755000 0                  STA     J

      894    10150    6                     CALL ADDPARNUM(%MRESERVD);

  10150 10 002761   000051 236000 11                 LDQ     41
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:210  
        10 002762   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 002763   014155 701000 10                 TSX1    ADDPARNUM
        10 002764   000000 011000                    NOP     0

      895    10151    6                     SUBSTR(LBUFC,I-3,2)='CP';

  10151 10 002765   001076 235000 0                  LDA     I
        10 002766   040005 100400                    MLR     fill='040'O
        10 002767   000542 000002 2                  ADSC9   FFLGS+59                 cn=0,n=2
        10 002770   006701 200002 0                  ADSC9   WROC+11,A                cn=1,n=2
        10 002771   003125 710000 10                 TRA     s:10191

      896    10152    6                  CASE(4);

      897    10153    6                     J=FM$DEV.MRRDCTX(X9);

  10153 10 002772   200006 235100                    LDA     X9,,AUTO
        10 002773   000003 735000                    ALS     3
        10 002774   000000 470400 xsym               LDP0    F$CFU$
        10 002775   000006 235105                    LDA     6,AL,PR0
        10 002776   001104 755000 0                  STA     J

      898    10154    7                     IF J=0 THEN DO; /* Waiting */

  10154 10 002777   003007 601000 10                 TNZ     s:10159

      899    10155    7                        WROC.SECT='w';

  10155 10 003000   000167 236003                    LDQ     119,DU
        10 003001   006700 552020 0                  STBQ    WROC+10,'20'O

      900    10156    7                        CALL ADDPARAM(%MMRRWAIT);

  10156 10 003002   000053 236000 11                 LDQ     43
        10 003003   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003004   014226 701000 10                 TSX1    ADDPARAM
        10 003005   000000 011000                    NOP     0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:211  

      901    10157    7                        END;

  10157 10 003006   003125 710000 10                 TRA     s:10191

      902    10158    7                     ELSE DO;

      903    10159    7                        IF FM$DEV.MRRDCTX(X9)<0 THEN J=-FM$DEV.MRRDCTX(X9);

  10159 10 003007   200006 236100                    LDQ     X9,,AUTO
        10 003010   000003 736000                    QLS     3
        10 003011   000006 235106                    LDA     6,QL,PR0
        10 003012   003016 605000 10                 TPL     s:10160

  10159 10 003013   000006 235106                    LDA     6,QL,PR0
        10 003014   000000 531000                    NEG     0
        10 003015   001104 755000 0                  STA     J

      904    10160    7                        J=FM$DEV.NN(J);

  10160 10 003016   001104 235000 0                  LDA     J
        10 003017   000003 735000                    ALS     3
        10 003020   000000 236105                    LDQ     0,AL,PR0
        10 003021   777777 376007                    ANQ     -1,DL
        10 003022   001104 756000 0                  STQ     J

      905    10161    7                        SUBSTR(WROC.PSN,0,2)='DP';

  10161 10 003023   000544 221000 2                  LDX1    FFLGS+61
        10 003024   006676 741000 0                  STX1    WROC+8

      906    10162    7                        CALL BINCHAR(SUBSTR(WROC.PSN,2,2),J);

  10162 10 003025   000000 235003                    LDA     0,DU
        10 003026   201346 757100                    STAQ    BXP+1,,AUTO
        10 003027   000000 301500                    BTD
        10 003030   201346 000010                    NDSC9   BXP+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:212  
        10 003031   006676 430002 0                  NDSC9   WROC+8                   cn=2,s=nosgn,sf=0,n=2

      907    10163    8                        IF FM$DEV.MRRDCTX(X9)>0 THEN DO;

  10163 10 003032   200006 236100                    LDQ     X9,,AUTO
        10 003033   000003 736000                    QLS     3
        10 003034   000006 235106                    LDA     6,QL,PR0
        10 003035   003045 604400 10                 TMOZ    s:10168

      908    10164    8                           WROC.SECT='m';

  10164 10 003036   000155 236003                    LDQ     109,DU
        10 003037   006700 552020 0                  STBQ    WROC+10,'20'O

      909    10165    8                           CALL ADDPARAM(%MMIRROR);

  10165 10 003040   000055 236000 11                 LDQ     45
        10 003041   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003042   014226 701000 10                 TSX1    ADDPARAM
        10 003043   000000 011000                    NOP     0

      910    10166    8                           END;

  10166 10 003044   003053 710000 10                 TRA     s:10171

      911    10167    8                        ELSE DO;

      912    10168    8                           WROC.SECT='r';

  10168 10 003045   000162 236003                    LDQ     114,DU
        10 003046   006700 552020 0                  STBQ    WROC+10,'20'O

      913    10169    8                           CALL ADDPARAM(%MMRRRSTR);

  10169 10 003047   000057 236000 11                 LDQ     47
        10 003050   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003051   014226 701000 10                 TSX1    ADDPARAM
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:213  
        10 003052   000000 011000                    NOP     0

      914    10170    8                           END;

      915    10171    7                        CALL ADDPART(2,SUBSTR(WROC.PSN,2,2));

  10171 10 003053   000060 236000 11                 LDQ     48
        10 003054   201336 756100                    STQ     K+1,,AUTO
        10 003055   000037 236000 11                 LDQ     31
        10 003056   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003057   014145 701000 10                 TSX1    ADDPART
        10 003060   000000 011000                    NOP     0

      916    10172    7                        END;

  10172 10 003061   003125 710000 10                 TRA     s:10191

      917    10173    6                  CASE(0);

      918    10174    6                     CALL ADDPARAM(%MAVAIL);

  10174 10 003062   000062 236000 11                 LDQ     50
        10 003063   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003064   014226 701000 10                 TSX1    ADDPARAM
        10 003065   000000 011000                    NOP     0
        10 003066   003125 710000 10                 TRA     s:10191

      919    10175    6                  CASE(ELSE);

      920    10176    6                     J=WROC.N;

  10176 10 003067   006677 236000 0                  LDQ     WROC+9
        10 003070   777777 376007                    ANQ     -1,DL
        10 003071   001104 756000 0                  STQ     J

      921    10177    6                     CALL ADDPARNUM(%MUSER);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:214  
  10177 10 003072   000064 236000 11                 LDQ     52
        10 003073   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003074   014155 701000 10                 TSX1    ADDPARNUM
        10 003075   000000 011000                    NOP     0

      922    10178    6                  END;

      923    10179    5                  END;

      924    10180    4               END;

  10180 10 003076   003125 710000 10                 TRA     s:10191

      925    10181    4            ELSE DO;

      926    10182    4               I=7;

  10182 10 003077   000007 236007                    LDQ     7,DL
        10 003100   001076 756000 0                  STQ     I

      927    10183    4               CALL ADDPARAM(%MEMPTY);

  10183 10 003101   000066 236000 11                 LDQ     54
        10 003102   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003103   014226 701000 10                 TSX1    ADDPARAM
        10 003104   000000 011000                    NOP     0

      928    10184    4               WROC.N=4;

  10184 10 003105   000004 220003                    LDX0    4,DU
        10 003106   006677 440000 0                  SXL0    WROC+9

      929    10185    4               WROC.VSN=0;

  10185 10 003107   006675 450000 0                  STZ     WROC+7

      930    10186                    /* IF NOT SPINNING BUT STILL IN USE.. */
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:215  
      931    10187    4               IF X9~=0 AND FM$DEV.SECTL(X9)~=0

  10187 10 003110   200006 235100                    LDA     X9,,AUTO
        10 003111   003125 600000 10                 TZE     s:10191
        10 003112   000003 735000                    ALS     3
        10 003113   000000 470400 xsym               LDP0    F$CFU$
        10 003114   000005 721105                    LXL1    5,AL,PR0
        10 003115   003125 600000 10                 TZE     s:10191

      932    10188    4               THEN IF OPNSN.SN#(0)=' ' THEN WROC.MSG#=DPERR_MSG#;

  10188 10 003116   040000 106400                    CMPC    fill='040'O
        10 003117   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 003120   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 003121   002471 601000 10                 TNZ     DISP1

  10188 10 003122   000457 222003                    LDX2    303,DU
        10 003123   006666 442000 0                  SXL2    WROC
        10 003124   003125 710000 10                 TRA     s:10191

      933    10189    4               ELSE GOTO DISP1;
      934    10190    4               END;
      935    10191    3            IF CODE=0 OR WROC.VSN~=0 OR WROC.N~=4 THEN

  10191 10 003125   200007 235100                    LDA     CODE,,AUTO
        10 003126   003134 600000 10                 TZE     s:10192
        10 003127   006675 236000 0                  LDQ     WROC+7
        10 003130   003134 601000 10                 TNZ     s:10192
        10 003131   006677 720000 0                  LXL0    WROC+9
        10 003132   000004 100003                    CMPX0   4,DU
        10 003133   003140 600000 10                 TZE     s:10193

      936    10192    3            CALL ERROR(10);

  10192 10 003134   000016 236000 11                 LDQ     14
        10 003135   201341 756100                    STQ     P$+2,,AUTO
        10 003136   011704 701000 10                 TSX1    ERROR
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:216  
        10 003137   000000 011000                    NOP     0

      937    10193    3            IF CODE=0 AND OPNSN.SN#(0)>=' ' OR X9=0 THEN GOTO NEXT;

  10193 10 003140   200007 235100                    LDA     CODE,,AUTO
        10 003141   003146 601000 10                 TNZ     s:10193+6
        10 003142   040000 106400                    CMPC    fill='040'O
        10 003143   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 003144   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 003145   000204 603000 10                 TRC     NEXT
        10 003146   200006 236100                    LDQ     X9,,AUTO
        10 003147   000204 600000 10                 TZE     NEXT

      938    10194    3            IF FM$VOL.SECTL(X9)~=0 THEN X9=FM$VOL.SECTL(X9);

  10194 10 003150   200006 235100                    LDA     X9,,AUTO
        10 003151   000003 735000                    ALS     3
        10 003152   000000 470400 xsym               LDP0    F$CFU$
        10 003153   000005 720105                    LXL0    5,AL,PR0
        10 003154   003161 600000 10                 TZE     s:10195

  10194 10 003155   000005 236105                    LDQ     5,AL,PR0
        10 003156   777777 376007                    ANQ     -1,DL
        10 003157   200006 756100                    STQ     X9,,AUTO
        10 003160   003174 710000 10                 TRA     s:10197

      939    10195    3            ELSE IF CODE~=0 THEN X9=FM$DEV.DEVL(FM$VOL.DCTX(X9));

  10195 10 003161   200007 235100                    LDA     CODE,,AUTO
        10 003162   000204 600000 10                 TZE     NEXT

  10195 10 003163   200006 235100                    LDA     X9,,AUTO
        10 003164   000003 735000                    ALS     3
        10 003165   000000 236105                    LDQ     0,AL,PR0
        10 003166   000017 772000                    QRL     15
        10 003167   000004 376000 11                 ANQ     4
        10 003170   000005 236106                    LDQ     5,QL,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:217  
        10 003171   000022 772000                    QRL     18
        10 003172   200006 756100                    STQ     X9,,AUTO
        10 003173   003174 710000 10                 TRA     s:10197

      940    10196    3            ELSE GOTO NEXT;
      941    10197    3            TRAPCNT=0;

  10197 10 003174   001102 450000 0                  STZ     TRAPCNT

      942    10198    3            END;

  10198 10 003175   002423 601000 10                 TNZ     s:10086

  10194 10 003176                       DISPS        null
      943    10199        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:218  
      944    10200    2   DISPS:;     /* DISPLAY SET STATUS(ES) */
      945    10201    2         X9=FM$CFUX.SETH;

  10201 10 003176   000000 470400 xsym               LDP0    F$CFU$
        10 003177   000005 236100                    LDQ     5,,PR0
        10 003200   000022 772000                    QRL     18
        10 003201   200006 756100                    STQ     X9,,AUTO

      946    10202    3         DO WHILE(X9~=0);

  10202 10 003202   011257 600000 10                 TZE     s:11238

  10197 10 003203                       DISPS0       null
      947    10203    3   DISPS0:  ;
      948    10204    3            REMEMBER DISPS0 IN TRAPX;

  10204 10 003203   003203 635000 10                 EAA     DISPS0
        10 003204   001100 452400 0                  STP2    TRAPX
        10 003205   001101 755000 0                  STA     TRAPX+1

      949    10205    3            LBUFC='Set #';

  10205 10 003206   040000 100400                    MLR     fill='040'O
        10 003207   000501 000005 2                  ADSC9   FFLGS+26                 cn=0,n=5
        10 003210   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

      950    10206    3            WROC.MSG#=PKSET_MSG#;

  10206 10 003211   000456 220003                    LDX0    302,DU
        10 003212   006666 440000 0                  SXL0    WROC

      951    10207    3            I=5;

  10207 10 003213   000005 236007                    LDQ     5,DL
        10 003214   001076 756000 0                  STQ     I

      952    10208    4            IF X9=0 THEN DO;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:219  

  10208 10 003215   200006 235100                    LDA     X9,,AUTO
        10 003216   003225 601000 10                 TNZ     s:10213

      953    10209    4               WROC.PSN=OPNSN.SN#(0);

  10209 10 003217   040000 100400                    MLR     fill='040'O
        10 003220   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 003221   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6

      954    10210    4               WROC.N=0;

  10210 10 003222   000000 221003                    LDX1    0,DU
        10 003223   006677 441000 0                  SXL1    WROC+9

      955    10211    4               END;

  10211 10 003224   003236 710000 10                 TRA     s:10216

      956    10212    4            ELSE DO;

      957    10213    4               WROC.PSN=FM$SET.PSN(X9);

  10213 10 003225   000005 735000                    ALS     5
        10 003226   000000 470400 xsym               LDP0    F$CFU$
        10 003227   040000 100505                    MLR     fill='040'O
        10 003230   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6
        10 003231   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6

      958    10214    4               WROC.N=FM$SET.SYSID(X9);

  10214 10 003232   200006 235100                    LDA     X9,,AUTO
        10 003233   000003 735000                    ALS     3
        10 003234   000002 721105                    LXL1    2,AL,PR0
        10 003235   006677 441000 0                  SXL1    WROC+9

      959    10215    4               END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:220  

      960    10216    3            CALL ADDPART(6,WROC.PSN);

  10216 10 003236   000034 236000 11                 LDQ     28
        10 003237   201336 756100                    STQ     K+1,,AUTO
        10 003240   000035 236000 11                 LDQ     29
        10 003241   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003242   014145 701000 10                 TSX1    ADDPART
        10 003243   000000 011000                    NOP     0

      961    10217    4            IF FM$SET.SET(X9) AND X9~=0 THEN DO;

  10217 10 003244   200006 235100                    LDA     X9,,AUTO
        10 003245   000003 735000                    ALS     3
        10 003246   000000 470400 xsym               LDP0    F$CFU$
        10 003247   000002 236105                    LDQ     2,AL,PR0
        10 003250   200000 316003                    CANQ    65536,DU
        10 003251   003434 600000 10                 TZE     s:10258
        10 003252   200006 235100                    LDA     X9,,AUTO
        10 003253   003434 600000 10                 TZE     s:10258

      962    10218    5               IF FM$SET.XCL(X9) THEN DO;

  10218 10 003254   000003 735000                    ALS     3
        10 003255   000002 234105                    SZN     2,AL,PR0
        10 003256   003301 605000 10                 TPL     s:10227

      963    10219    5                  IF WROC.N=0 THEN CALL ADDPARAM(%MAVAIL);

  10219 10 003257   006677 720000 0                  LXL0    WROC+9
        10 003260   003266 601000 10                 TNZ     s:10221

  10219 10 003261   000062 236000 11                 LDQ     50
        10 003262   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003263   014226 701000 10                 TSX1    ADDPARAM
        10 003264   000000 011000                    NOP     0
        10 003265   003473 710000 10                 TRA     s:10266
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:221  

      964    10220    6                  ELSE DO;

      965    10221    6                     J=WROC.N;

  10221 10 003266   006677 236000 0                  LDQ     WROC+9
        10 003267   777777 376007                    ANQ     -1,DL
        10 003270   001104 756000 0                  STQ     J

      966    10222    6                     CALL ADDPARNUM(%MUSER);

  10222 10 003271   000064 236000 11                 LDQ     52
        10 003272   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003273   014155 701000 10                 TSX1    ADDPARNUM
        10 003274   000000 011000                    NOP     0

      967    10223    6                     WROC.VSN=WROC.N;

  10223 10 003275   006677 236000 0                  LDQ     WROC+9
        10 003276   777777 376007                    ANQ     -1,DL
        10 003277   006675 756000 0                  STQ     WROC+7

      968    10224    6                     END;

      969    10225    5                  END;

  10225 10 003300   003473 710000 10                 TRA     s:10266

      970    10226    5               ELSE DO;/* IF FM$SET.XCL=0 */

      971    10227    6                  IF FM$SET.NONEWU(X9) THEN DO;

  10227 10 003301   000002 236105                    LDQ     2,AL,PR0
        10 003302   040000 316003                    CANQ    16384,DU
        10 003303   003313 600000 10                 TZE     s:10232

      972    10228    6                     CALL ADDPARAM(%MLOCKED);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:222  

  10228 10 003304   000047 236000 11                 LDQ     39
        10 003305   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003306   014226 701000 10                 TSX1    ADDPARAM
        10 003307   000000 011000                    NOP     0

      973    10229    6                     WROC.N=3;

  10229 10 003310   000003 220003                    LDX0    3,DU
        10 003311   006677 440000 0                  SXL0    WROC+9

      974    10230    6                     END;

  10230 10 003312   003321 710000 10                 TRA     s:10235

      975    10231    6                  ELSE DO;

      976    10232    6                     CALL ADDPARAM(%MSHARED);

  10232 10 003313   000045 236000 11                 LDQ     37
        10 003314   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003315   014226 701000 10                 TSX1    ADDPARAM
        10 003316   000000 011000                    NOP     0

      977    10233    6                     WROC.N=2;

  10233 10 003317   000002 220003                    LDX0    2,DU
        10 003320   006677 440000 0                  SXL0    WROC+9

      978    10234    6                     END;

      979    10235    6                  IF NOT FM$SET.ONEU(X9) THEN DO;

  10235 10 003321   200006 235100                    LDA     X9,,AUTO
        10 003322   000003 735000                    ALS     3
        10 003323   000000 470400 xsym               LDP0    F$CFU$
        10 003324   000002 236105                    LDQ     2,AL,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:223  
        10 003325   000001 316003                    CANQ    1,DU
        10 003326   003432 601000 10                 TNZ     s:10254

      980    10236    6                     WROC.VSN=-1;

  10236 10 003327   000001 335007                    LCA     1,DL
        10 003330   006675 755000 0                  STA     WROC+7

      981    10237    6                     GRANULE=I+1;

  10237 10 003331   001076 236000 0                  LDQ     I
        10 003332   000001 036007                    ADLQ    1,DL
        10 003333   001113 756000 0                  STQ     GRANULE

      982    10238    6                     IF CODE=0 THEN WROC.N=WROC.N+3;

  10238 10 003334   200007 235100                    LDA     CODE,,AUTO
        10 003335   003340 601000 10                 TNZ     s:10239

  10238 10 003336   000003 621010                    EAX1    3,X0
        10 003337   006677 441000 0                  SXL1    WROC+9

      983    10239    6                     P$=PINCRW(F$CFU$,FM$SET.USERLIST(X9));

  10239 10 003340   200006 235100                    LDA     X9,,AUTO
        10 003341   000003 735000                    ALS     3
        10 003342   000002 720105                    LXL0    2,AL,PR0
        10 003343   000000 636010                    EAQ     0,X0
        10 003344   000000 036000 xsym               ADLQ    F$CFU$
        10 003345   001103 756000 0                  STQ     P$

      984    10240    7                     DO WHILE(P$~=F$CFU$);

  10240 10 003346   000000 116000 xsym               CMPQ    F$CFU$
        10 003347   003415 600000 10                 TZE     s:10248

      985    10241    7                        WROC.VSN=WROC.VSN+FM$SETU.NUM;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:224  

  10241 10 003350   001103 470400 0                  LDP0    P$
        10 003351   000000 236100                    LDQ     0,,PR0
        10 003352   000022 772000                    QRL     18
        10 003353   006675 036000 0                  ADLQ    WROC+7
        10 003354   006675 756000 0                  STQ     WROC+7

      986    10242    8                        IF CODE=0 THEN DO NUMSNS=0 TO FM$SETU.NUM-1;

  10242 10 003355   200007 235100                    LDA     CODE,,AUTO
        10 003356   003407 601000 10                 TNZ     s:10246

  10242 10 003357   001112 450000 0                  STZ     NUMSNS
        10 003360   003401 710000 10                 TRA     s:10245+3

      987    10243    8                           J=FM$SETU.SYSID(NUMSNS);

  10243 10 003361   001112 235000 0                  LDA     NUMSNS
        10 003362   000001 735000                    ALS     1
        10 003363   001103 470400 0                  LDP0    P$
        10 003364   000000 101505                    MRL     fill='000'O
        10 003365   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2
        10 003366   001104 000004 0                  ADSC9   J                        cn=0,n=4

      988    10244    8                           IF J~=JG_PIG# THEN CALL ADDPARNUM(%MNUM);

  10244 10 003367   001104 236000 0                  LDQ     J
        10 003370   000007 116007                    CMPQ    7,DL
        10 003371   003376 600000 10                 TZE     s:10245

  10244 10 003372   000070 236000 11                 LDQ     56
        10 003373   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003374   014155 701000 10                 TSX1    ADDPARNUM
        10 003375   000000 011000                    NOP     0

      989    10245    8                           END;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:225  
  10245 10 003376   001112 235000 0                  LDA     NUMSNS
        10 003377   000001 035007                    ADLA    1,DL
        10 003400   001112 755000 0                  STA     NUMSNS
        10 003401   001103 470400 0                  LDP0    P$
        10 003402   000000 236100                    LDQ     0,,PR0
        10 003403   000022 772000                    QRL     18
        10 003404   001112 116000 0                  CMPQ    NUMSNS
        10 003405   003407 600000 10                 TZE     s:10246
        10 003406   003361 603000 10                 TRC     s:10243

      990    10246    7                        P$=PINCRW(F$CFU$,FM$SETU.LINKX);

  10246 10 003407   000000 720100                    LXL0    0,,PR0
        10 003410   000000 636010                    EAQ     0,X0
        10 003411   000000 036000 xsym               ADLQ    F$CFU$
        10 003412   001103 756000 0                  STQ     P$

      991    10247    7                        END;

  10247 10 003413   000000 116000 xsym               CMPQ    F$CFU$
        10 003414   003350 601000 10                 TNZ     s:10241

      992    10248    6                     J=WROC.VSN;

  10248 10 003415   006675 235000 0                  LDA     WROC+7
        10 003416   001104 755000 0                  STA     J

      993    10249    7                     IF CODE~=0 THEN DO;

  10249 10 003417   200007 235100                    LDA     CODE,,AUTO
        10 003420   003473 600000 10                 TZE     s:10266

      994    10250    7                        CALL ADDPARNUM(%MNUM);

  10250 10 003421   000070 236000 11                 LDQ     56
        10 003422   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003423   014155 701000 10                 TSX1    ADDPARNUM
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:226  
        10 003424   000000 011000                    NOP     0

      995    10251    7                        CALL ADDPARAM(%MUSERS);

  10251 10 003425   000071 236000 11                 LDQ     57
        10 003426   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003427   014226 701000 10                 TSX1    ADDPARAM
        10 003430   000000 011000                    NOP     0

      996    10252    7                        END;

      997    10253    6                     END;

  10253 10 003431   003473 710000 10                 TRA     s:10266

      998    10254    5                  ELSE WROC.VSN=0;

  10254 10 003432   006675 450000 0                  STZ     WROC+7

      999    10255    5                  END;

     1000    10256    4               END;

  10256 10 003433   003473 710000 10                 TRA     s:10266

     1001    10257    4            ELSE DO;/* IF NOT FM$SET.SET */

     1002    10258    4               J=WROC.N;

  10258 10 003434   006677 236000 0                  LDQ     WROC+9
        10 003435   777777 376007                    ANQ     -1,DL
        10 003436   001104 756000 0                  STQ     J

     1003    10259    4               IF (FM$SET.PSN(X9)='CP-6''S' OR FM$SET.REALPSN(X9)='CP-6''S')

  10259 10 003437   200006 235100                    LDA     X9,,AUTO
        10 003440   000005 735000                    ALS     5
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:227  
        10 003441   040000 106505                    CMPC    fill='040'O
        10 003442   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6
        10 003443   000542 000006 2                  ADSC9   FFLGS+59                 cn=0,n=6
        10 003444   003451 600000 10                 TZE     s:10259+10
        10 003445   040000 106505                    CMPC    fill='040'O
        10 003446   000005 400006                    ADSC9   5,A,PR0                  cn=2,n=6
        10 003447   000542 000006 2                  ADSC9   FFLGS+59                 cn=0,n=6
        10 003450   003455 601000 10                 TNZ     s:10261
        10 003451   000000 116003                    CMPQ    0,DU
        10 003452   003455 601000 10                 TNZ     s:10261

     1004    10260    4                 AND J=0 THEN J=1;

  10260 10 003453   000001 235007                    LDA     1,DL
        10 003454   001104 755000 0                  STA     J

     1005    10261    4               WROC.N=4;

  10261 10 003455   000004 220003                    LDX0    4,DU
        10 003456   006677 440000 0                  SXL0    WROC+9

     1006    10262    4               WROC.VSN=J;

  10262 10 003457   001104 235000 0                  LDA     J
        10 003460   006675 755000 0                  STA     WROC+7

     1007    10263    4               IF J~=0 THEN CALL ADDPARNUM(%MRESERVD);

  10263 10 003461   003467 600000 10                 TZE     s:10264

  10263 10 003462   000051 236000 11                 LDQ     41
        10 003463   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003464   014155 701000 10                 TSX1    ADDPARNUM
        10 003465   000000 011000                    NOP     0
        10 003466   003473 710000 10                 TRA     s:10266

     1008    10264    4               ELSE CALL ADDPARAM(%MNOTSET);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:228  

  10264 10 003467   000072 236000 11                 LDQ     58
        10 003470   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 003471   014226 701000 10                 TSX1    ADDPARAM
        10 003472   000000 011000                    NOP     0

     1009    10265    4               END;

     1010    10266    3            IF CODE=0 OR WROC.VSN>1 OR WROC.N~=4 THEN CALL ERROR(10);

  10266 10 003473   200007 235100                    LDA     CODE,,AUTO
        10 003474   003503 600000 10                 TZE     s:10266+8
        10 003475   006675 236000 0                  LDQ     WROC+7
        10 003476   000001 116007                    CMPQ    1,DL
        10 003477   003503 605400 10                 TPNZ    s:10266+8
        10 003500   006677 720000 0                  LXL0    WROC+9
        10 003501   000004 100003                    CMPX0   4,DU
        10 003502   003507 600000 10                 TZE     s:10267

  10266 10 003503   000016 236000 11                 LDQ     14
        10 003504   201341 756100                    STQ     P$+2,,AUTO
        10 003505   011704 701000 10                 TSX1    ERROR
        10 003506   000000 011000                    NOP     0

     1011    10267    3            IF CODE=0 THEN GOTO NEXT;

  10267 10 003507   200007 235100                    LDA     CODE,,AUTO
        10 003510   000204 600000 10                 TZE     NEXT

     1012    10268    3            X9=FM$SET.SETL(X9);

  10268 10 003511   200006 236100                    LDQ     X9,,AUTO
        10 003512   000003 736000                    QLS     3
        10 003513   000000 470400 xsym               LDP0    F$CFU$
        10 003514   000005 236106                    LDQ     5,QL,PR0
        10 003515   000022 772000                    QRL     18
        10 003516   200006 756100                    STQ     X9,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:229  

     1013    10269    3            TRAPCNT=0;

  10269 10 003517   001102 450000 0                  STZ     TRAPCNT

     1014    10270    3            END;

  10270 10 003520   003203 601000 10                 TNZ     DISPS0
        10 003521   011257 710000 10                 TRA     s:11238

     1015    10271        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:230  
     1016    10272    2      CASE(%(E$SCRATCH-E$PIGH));

     1017    10273                    /*E*     ERROR: FXP-E$SCRATCH-0
     1018    10274                    *        MESSAGE:SCRatch vsn,...,vsn
     1019    10275                    *        or SCRatch device-name AS vsn [(size,...,size)]
     1020    10276                    *        or SCRatch vsn [(size,...,size)]
     1021    10277                    *        or SCRatch DP#set
     1022    10278                    */
     1023    10279    2         J=0;

  10279 10 003522   001104 450000 0                  STZ     J

     1024    10280    2         VID1='0'B;

  10280 10 003523   010000 220003                    LDX0    4096,DU
        10 003524   000040 100400                    MLR     fill='000'O
        10 003525   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        10 003526   004621 000010 0                  ADSC9   CSTAT                    cn=0,n=*X0

     1025    10281    2         VID1.PSN=OPNSN.SN#(0);

  10281 10 003527   040000 100400                    MLR     fill='040'O
        10 003530   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 003531   004624 000006 0                  ADSC9   CSTAT+3                  cn=0,n=6

     1026    10282    2         IF VID1.PSN=' ' THEN I=1;

  10282 10 003532   040000 106400                    CMPC    fill='040'O
        10 003533   004624 000006 0                  ADSC9   CSTAT+3                  cn=0,n=6
        10 003534   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 003535   003540 601000 10                 TNZ     s:10283

  10282 10 003536   000001 236007                    LDQ     1,DL
        10 003537   001076 756000 0                  STQ     I

     1027    10283    3         DO WHILE(I<OUT$BLK.NSUBLKS);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:231  
  10283 10 003540   001073 470400 0                  LDP0    BLK$
        10 003541   000001 236100                    LDQ     1,,PR0
        10 003542   000022 772000                    QRL     18
        10 003543   001076 116000 0                  CMPQ    I
        10 003544   003722 602000 10                 TNC     s:10307
        10 003545   003722 600000 10                 TZE     s:10307

     1028    10284    3            P$=OUT$BLK.SUBLK$(I);

  10284 10 003546   001073 470400 0                  LDP0    BLK$
        10 003547   001076 720000 0                  LXL0    I
        10 003550   000003 236110                    LDQ     3,X0,PR0
        10 003551   001103 756000 0                  STQ     P$

     1029    10285    3            IF P$->OUT$BLK.CODE=3 THEN J=50; /* GOT SECT LIST */

  10285 10 003552   001103 471400 0                  LDP1    P$
        10 003553   100000 721100                    LXL1    0,,PR1
        10 003554   000003 101003                    CMPX1   3,DU
        10 003555   003561 601000 10                 TNZ     s:10286

  10285 10 003556   000062 235007                    LDA     50,DL
        10 003557   001104 755000 0                  STA     J
        10 003560   003711 710000 10                 TRA     s:10305

     1030    10286    4            ELSE IF P$->OUT$BLK.CODE=1 THEN DO; /* GOT 'DP' NN 'AS' VSN */

  10286 10 003561   000001 101003                    CMPX1   1,DU
        10 003562   003617 601000 10                 TNZ     s:10291

     1031    10287    4               CALL CONCAT(OPNSN.SN#(0),BINASC(4),'DP',

  10287 10 003563   000004 473510                    LDP3    4,X0,PR0
        10 003564   300004 236100                    LDQ     4,,PR3
        10 003565   000033 772000                    QRL     27
        10 003566   000000 622006                    EAX2    0,QL
        10 003567   004000 236003                    LDQ     2048,DU
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:232  
        10 003570   000073 552040 0                  STBQ    OPNSN+1,'40'O
        10 003571   000544 236000 2                  LDQ     FFLGS+61
        10 003572   000011 772000                    QRL     9
        10 003573   000073 552030 0                  STBQ    OPNSN+1,'30'O
        10 003574   040000 100540                    MLR     fill='040'O
        10 003575   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
        10 003576   000073 600003 0                  ADSC9   OPNSN+1                  cn=3,n=3
        10 003577   000000 636012                    EAQ     0,X2
        10 003600   000022 772000                    QRL     18
        10 003601   000003 116007                    CMPQ    3,DL
        10 003602   003613 603000 10                 TRC     s:10289
        10 003603   201346 742100                    STX2    BXP+1,,AUTO
        10 003604   777774 622012                    EAX2    -4,X2
        10 003605   777777 662003                    ERX2    -1,DU
        10 003606   201346 235100                    LDA     BXP+1,,AUTO
        10 003607   000022 771000                    ARL     18
        10 003610   040045 100400                    MLR     fill='040'O
        10 003611   000073 000001 11                 ADSC9   59                       cn=0,n=1
        10 003612   000073 600012 0                  ADSC9   OPNSN+1,A                cn=3,n=*X2

     1032    10288    4                 OUT$BLK.SUBLK$(I+1)->OUT$SYM.TEXT,'0');
     1033    10289    4               I=I+2; /* SKIP NN AND 'AS' */

  10289 10 003613   001076 235000 0                  LDA     I
        10 003614   000002 035007                    ADLA    2,DL
        10 003615   001076 755000 0                  STA     I

     1034    10290    4               END;

  10290 10 003616   003711 710000 10                 TRA     s:10305

     1035    10291    3            ELSE IF P$->OUT$BLK.NDTYPE=%PL6SYM# THEN VID1.SNLIST.VSN.S(J-1)=

  10291 10 003617   100000 236100                    LDQ     0,,PR1
        10 003620   000077 376003                    ANQ     63,DU
        10 003621   000030 116003                    CMPQ    24,DU
        10 003622   003640 601000 10                 TNZ     s:10294
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:233  

  10291 10 003623   001104 235000 0                  LDA     J
        10 003624   000002 735000                    ALS     2
        10 003625   100004 236100                    LDQ     4,,PR1
        10 003626   000033 772000                    QRL     27
        10 003627   100004 236100                    LDQ     4,,PR1
        10 003630   000022 772000                    QRL     18
        10 003631   000777 376007                    ANQ     511,DL
        10 003632   000100 136007                    SBLQ    64,DL
        10 003633   000033 736000                    QLS     27
        10 003634   005315 676005 0                  ERQ     CSTAT+316,AL
        10 003635   777000 376003                    ANQ     -512,DU
        10 003636   005315 656005 0                  ERSQ    CSTAT+316,AL
        10 003637   003711 710000 10                 TRA     s:10305

     1036    10292    3              ASCBIN(P$->OUT$SYM.TEXT)-ASCBIN('@'); /* GOT SECT# */
     1037    10293    4            ELSE DO; /* MUST BE A NUMBER */

     1038    10294    4               CALL CHARBIN(VIDBUF.VSN,P$->OUT$SYM.TEXT);

  10294 10 003640   100004 236100                    LDQ     4,,PR1
        10 003641   000033 772000                    QRL     27
        10 003642   000000 622006                    EAX2    0,QL
        10 003643   000100 305540                    DTB
        10 003644   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
        10 003645   201346 000010                    NDSC9   BXP+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
        10 003646   201347 235100                    LDA     BXP+2,,AUTO
        10 003647   002623 755000 0                  STA     VIDBUF+2

     1039    10295    4               IF VIDBUF.VSN=0 OR J=48 THEN GOTO TOOMANY;

  10295 10 003650   014015 600000 10                 TZE     TOOMANY
        10 003651   001104 236000 0                  LDQ     J
        10 003652   000060 116007                    CMPQ    48,DL
        10 003653   014015 600000 10                 TZE     TOOMANY

     1040    10296    4               IF J<50 THEN VID1.SNLIST.VSN.N(J)=VIDBUF.VSN;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:234  

  10296 10 003654   000062 116007                    CMPQ    50,DL
        10 003655   003665 603000 10                 TRC     s:10298

  10296 10 003656   001104 235000 0                  LDA     J
        10 003657   000002 735000                    ALS     2
        10 003660   002623 236000 0                  LDQ     VIDBUF+2
        10 003661   005321 676005 0                  ERQ     CSTAT+320,AL
        10 003662   000032 376000 xsym               ANQ     B_VECTNIL+26
        10 003663   005321 656005 0                  ERSQ    CSTAT+320,AL
        10 003664   003706 710000 10                 TRA     s:10303

     1041    10297    5               ELSE DO;

     1042    10298    5                  IF J=76 OR VIDBUF.VSN<7 OR VIDBUF.VSN>262143 THEN GOTO TOOMANY;

  10298 10 003665   000114 116007                    CMPQ    76,DL
        10 003666   014015 600000 10                 TZE     TOOMANY
        10 003667   000007 115007                    CMPA    7,DL
        10 003670   014015 602000 10                 TNC     TOOMANY
        10 003671   000001 115003                    CMPA    1,DU
        10 003672   014015 603000 10                 TRC     TOOMANY

     1043    10299    5                  VID1.SECTSTRT(J-49)=VID1.SECTSTRT(J-50)+VIDBUF.VSN;

  10299 10 003673   004547 236006 0                  LDQ     VIDBUF+982,QL
        10 003674   002623 036000 0                  ADLQ    VIDBUF+2
        10 003675   001104 721000 0                  LXL1    J
        10 003676   004550 756011 0                  STQ     VIDBUF+983,X1

     1044    10300    5                  VID1.SECTSTRT(J-48)=VID1.SECTSTRT(J-49);

  10300 10 003677   001104 720000 0                  LXL0    J
        10 003700   004550 235010 0                  LDA     VIDBUF+983,X0
        10 003701   004551 755010 0                  STA     VIDBUF+984,X0

     1045    10301    5                  VID1.SNLIST.SIZE(J-49)=I;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:235  

  10301 10 003702   001104 235000 0                  LDA     J
        10 003703   000002 735000                    ALS     2
        10 003704   001076 236000 0                  LDQ     I
        10 003705   005016 756005 0                  STQ     CSTAT+125,AL

     1046    10302    5                  END;

     1047    10303    4               J=J+1;

  10303 10 003706   001104 235000 0                  LDA     J
        10 003707   000001 035007                    ADLA    1,DL
        10 003710   001104 755000 0                  STA     J

     1048    10304    4               END;

     1049    10305    3            I=I+1;

  10305 10 003711   001076 235000 0                  LDA     I
        10 003712   000001 035007                    ADLA    1,DL
        10 003713   001076 755000 0                  STA     I

     1050    10306    3            END;

  10306 10 003714   001073 470400 0                  LDP0    BLK$
        10 003715   000001 236100                    LDQ     1,,PR0
        10 003716   000022 772000                    QRL     18
        10 003717   001076 116000 0                  CMPQ    I
        10 003720   003722 600000 10                 TZE     s:10307
        10 003721   003546 603000 10                 TRC     s:10284

     1051    10307    2         I=0;

  10307 10 003722   001076 450000 0                  STZ     I

     1052    10308    2         NUMSNS=1;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:236  
  10308 10 003723   000001 235007                    LDA     1,DL
        10 003724   001112 755000 0                  STA     NUMSNS

     1053    10309    3         DO WHILE (I<NUMSNS);

  10309 10 003725   001076 236000 0                  LDQ     I
        10 003726   001112 116000 0                  CMPQ    NUMSNS
        10 003727   004361 603000 10                 TRC     s:10396

     1054    10310    4            IF OPNSN.SN#(0)<=' ' AND SUBSTR(OPNSN.SN#(0),4,1)=' ' THEN DO;

  10310 10 003730   040000 106400                    CMPC    fill='040'O
        10 003731   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 003732   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 003733   004011 602000 10                 TNC     s:10325
        10 003734   000074 236000 0                  LDQ     OPNSN+2
        10 003735   777000 376003                    ANQ     -512,DU
        10 003736   040000 116003                    CMPQ    16384,DU
        10 003737   004011 601000 10                 TNZ     s:10325

     1055    10311    4               OPNSN.SN#(0)=ADDR(VID1.SNLIST(I))->CHAR4;

  10311 10 003740   001076 235000 0                  LDA     I
        10 003741   000004 735000                    ALS     4
        10 003742   040000 100405                    MLR     fill='040'O
        10 003743   005321 000004 0                  ADSC9   CSTAT+320,A              cn=0,n=4
        10 003744   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1056    10312    5               IF SUBSTR(OPNSN.SN#(0),0,1)>BINASC(1) AND GRANULE=0 THEN DO;

  10312 10 003745   000073 236000 0                  LDQ     OPNSN+1
        10 003746   777000 376003                    ANQ     -512,DU
        10 003747   001000 116003                    CMPQ    512,DU
        10 003750   004011 602000 10                 TNC     s:10325
        10 003751   004011 600000 10                 TZE     s:10325
        10 003752   001113 236000 0                  LDQ     GRANULE
        10 003753   004011 601000 10                 TNZ     s:10325
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:237  

     1057    10313                    /* Read the "bottom" vid if we're doing a single section.  That'll
     1058    10314                       make sure the sectionlist and defective track info is ok. */
     1059    10315    5                  OPNDP.V.FUN#=%IN#;

  10315 10 003754   002000 236007                    LDQ     1024,DL
        10 003755   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1060    10316    5                  SUBSTR(OPNSN.SN#(0),0,1)=BINASC(0);

  10316 10 003756   000000 236003                    LDQ     0,DU
        10 003757   000073 552040 0                  STBQ    OPNSN+1,'40'O

     1061    10317    5                  CALL M$OPEN(OPNDP)ALTRET(VOLERR);

  10317 10 003760   000100 630400 0                  EPPR0   OPNDP
        10 003761   450000 713400                    CLIMB   alt,open
        10 003762   410400 401760                    pmme    nvectors=18
        10 003763   013527 702000 10                 TSX2    VOLERR

     1062    10318    5                  CALL M$READ(READVID)ALTRET(DPERR);

  10318 10 003764   000416 630400 0                  EPPR0   READVID
        10 003765   440000 713400                    CLIMB   alt,read
        10 003766   401400 401760                    pmme    nvectors=4
        10 003767   013551 702000 10                 TSX2    DPERR

     1063    10319    5                  VIDBUF.SNLIST=VID1.SNLIST;

  10319 10 003770   000000 100400                    MLR     fill='000'O
        10 003771   005321 005400 0                  ADSC9   CSTAT+320                cn=0,n=2816
        10 003772   003321 005400 0                  ADSC9   VIDBUF+320               cn=0,n=2816

     1064    10320    5                  VID1=VIDBUF;

  10320 10 003773   010000 220003                    LDX0    4096,DU
        10 003774   000040 100440                    MLR     fill='000'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:238  
        10 003775   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0
        10 003776   004621 000010 0                  ADSC9   CSTAT                    cn=0,n=*X0

     1065    10321    5                  CALL CLOSE(DCBNUM(M$DP));

  10321 10 003777   000000 236007 xsym               LDQ     M$DP,DL
        10 004000   201355 756100                    STQ     BXP+8,,AUTO
        10 004001   201355 630500                    EPPR0   BXP+8,,AUTO
        10 004002   201341 450500                    STP0    P$+2,,AUTO
        10 004003   012416 701000 10                 TSX1    CLOSE
        10 004004   000000 011000                    NOP     0

     1066    10322    5                  SUBSTR(OPNSN.SN#(0),0,1)=BINASC(VID1.SNLIST.VSN.S(I));

  10322 10 004005   001076 235000 0                  LDA     I
        10 004006   000002 735000                    ALS     2
        10 004007   005321 236005 0                  LDQ     CSTAT+320,AL
        10 004010   000073 552040 0                  STBQ    OPNSN+1,'40'O

     1067    10323    5                  END;

     1068    10324    4               END;

     1069    10325    3            OPNDP.V.FUN#=%UPDATE#;

  10325 10 004011   001000 236007                    LDQ     512,DL
        10 004012   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1070    10326    3            IF GRANULE=0 THEN CALL M$OPEN(OPNDP)ALTRET(VOLERR);

  10326 10 004013   001113 235000 0                  LDA     GRANULE
        10 004014   004021 601000 10                 TNZ     s:10327

  10326 10 004015   000100 630400 0                  EPPR0   OPNDP
        10 004016   450000 713400                    CLIMB   alt,open
        10 004017   410400 401760                    pmme    nvectors=18
        10 004020   013527 702000 10                 TSX2    VOLERR
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:239  

     1071    10327    3            IF NOT F$DCB.OWNER AND OPNSN.SN#(0)~='SYS' THEN GOTO NOTOWNER;

  10327 10 004021   000000 470400 xsym               LDP0    M$DP$
        10 004022   000064 236100                    LDQ     52,,PR0
        10 004023   040000 316007                    CANQ    16384,DL
        10 004024   004031 601000 10                 TNZ     s:10328
        10 004025   040000 106400                    CMPC    fill='040'O
        10 004026   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 004027   000520 000003 2                  ADSC9   FFLGS+41                 cn=0,n=3
        10 004030   014012 601000 10                 TNZ     NOTOWNER

     1072    10328    3            CALL M$READ(READVID)ALTRET(DPERR);

  10328 10 004031   000416 630400 0                  EPPR0   READVID
        10 004032   440000 713400                    CLIMB   alt,read
        10 004033   401400 401760                    pmme    nvectors=4
        10 004034   013551 702000 10                 TSX2    DPERR

     1073    10329    3            IF GRANULE=0 THEN

  10329 10 004035   001113 235000 0                  LDA     GRANULE
        10 004036   004043 601000 10                 TNZ     s:10331

     1074    10330    3            CALL FXU$PROTCHK(VIDBUF)ALTRET(DPCLOSE);

  10330 10 004037   000074 630400 11                 EPPR0   60
        10 004040   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 004041   000000 701000 xent               TSX1    FXU$PROTCHK
        10 004042   013762 702000 10                 TSX2    DPCLOSE

     1075    10331    4            IF NOT VID1.SNLIST.VSN(0) THEN DO; /* SCRATCHING A SET */

  10331 10 004043   005321 235000 0                  LDA     CSTAT+320
        10 004044   004070 601000 10                 TNZ     s:10337

     1076    10332    4               IF BINBIT(VIDBUF.VOLCNT-1,18)&'7777'O THEN GOTO ALRDYSCRCH;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:240  

  10332 10 004045   002625 236000 0                  LDQ     VIDBUF+4
        10 004046   777777 376007                    ANQ     -1,DL
        10 004047   000001 136007                    SBLQ    1,DL
        10 004050   000022 736000                    QLS     18
        10 004051   000022 772000                    QRL     18
        10 004052   000000 620006                    EAX0    0,QL
        10 004053   777700 360003                    ANX0    -64,DU
        10 004054   004343 601000 10                 TNZ     ALRDYSCRCH

     1077    10333    4               VID1.SNLIST=VIDBUF.SNLIST;

  10333 10 004055   000000 100400                    MLR     fill='000'O
        10 004056   003321 005400 0                  ADSC9   VIDBUF+320               cn=0,n=2816
        10 004057   005321 005400 0                  ADSC9   CSTAT+320                cn=0,n=2816

     1078    10334    4               VID1.SNLIST(VIDBUF.VOLCNT)='0'B;

  10334 10 004060   002625 236000 0                  LDQ     VIDBUF+4
        10 004061   000001 736000                    QLS     1
        10 004062   000075 376000 11                 ANQ     61
        10 004063   000003 736000                    QLS     3
        10 004064   000006 100400                    MLR     fill='000'O
        10 004065   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        10 004066   005321 000020 0                  ADSC9   CSTAT+320,Q              cn=0,n=16

     1079    10335    4               END;

  10335 10 004067   004114 710000 10                 TRA     s:10342

     1080    10336    4            ELSE DO;

     1081    10337    4               VIDBUF.VSN=VID1.SNLIST.VSN.N(I);

  10337 10 004070   001076 236000 0                  LDQ     I
        10 004071   000002 736000                    QLS     2
        10 004072   005321 236006 0                  LDQ     CSTAT+320,QL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:241  
        10 004073   000032 376000 xsym               ANQ     B_VECTNIL+26
        10 004074   002623 756000 0                  STQ     VIDBUF+2

     1082    10338    4               IF GRANULE>0 OR VID1.SNLIST.VSN.S(I)<2 THEN EXIT;

  10338 10 004075   001113 235000 0                  LDA     GRANULE
        10 004076   004114 605400 10                 TPNZ    s:10342
        10 004077   001076 235000 0                  LDA     I
        10 004100   000002 735000                    ALS     2
        10 004101   005321 236005 0                  LDQ     CSTAT+320,AL
        10 004102   777000 376003                    ANQ     -512,DU
        10 004103   002000 116003                    CMPQ    1024,DU
        10 004104   004114 602000 10                 TNC     s:10342

     1083    10339    4               VIDBUF=VID1;

  10339 10 004105   010000 220003                    LDX0    4096,DU
        10 004106   000040 100440                    MLR     fill='000'O
        10 004107   004621 000010 0                  ADSC9   CSTAT                    cn=0,n=*X0
        10 004110   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0

     1084    10340    4               VID1.SECTSTRT='0'B;

  10340 10 004111   000000 100400                    MLR     fill='000'O
        10 004112   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        10 004113   004631 000150 0                  ADSC9   CSTAT+8                  cn=0,n=104

     1085    10341    4               END;

     1086    10342    4            IF VID1.SECTSTRT THEN IF GRANULE=0 THEN DO;

  10342 10 004114   000000 106400                    CMPC    fill='000'O
        10 004115   004631 000150 0                  ADSC9   CSTAT+8                  cn=0,n=104
        10 004116   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
        10 004117   004252 600000 10                 TZE     s:10370

  10342 10 004120   001113 235000 0                  LDA     GRANULE
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:242  
        10 004121   004245 601000 10                 TNZ     s:10368

     1087    10343    4               J=0;

  10343 10 004122   001104 450000 0                  STZ     J

     1088    10344    5               DO WHILE(VID1.SECTSTRT(J)<=VID1.SECTSTRT(J+1));

  10344 10 004123   001104 720000 0                  LXL0    J
        10 004124   004632 236010 0                  LDQ     CSTAT+9,X0
        10 004125   004631 116010 0                  CMPQ    CSTAT+8,X0
        10 004126   004231 602000 10                 TNC     s:10363

     1089    10345    6                  DO I=0 TO 62;

  10345 10 004127   001076 450000 0                  STZ     I

     1090    10346    6                     IF VID1.SECTSTRT(J)+2>=VIDBUF.DGT.FGRAN(I)

  10346 10 004130   001076 720000 0                  LXL0    I
        10 004131   003121 236010 0                  LDQ     VIDBUF+192,X0
        10 004132   000022 772000                    QRL     18
        10 004133   201346 756100                    STQ     BXP+1,,AUTO
        10 004134   001104 721000 0                  LXL1    J
        10 004135   004631 236011 0                  LDQ     CSTAT+8,X1
        10 004136   000002 036007                    ADLQ    2,DL
        10 004137   201346 116100                    CMPQ    BXP+1,,AUTO
        10 004140   004154 602000 10                 TNC     s:10350
        10 004141   003121 236010 0                  LDQ     VIDBUF+192,X0
        10 004142   777777 376007                    ANQ     -1,DL
        10 004143   004631 116011 0                  CMPQ    CSTAT+8,X1
        10 004144   004154 602000 10                 TNC     s:10350
        10 004145   003221 222010 0                  LDX2    VIDBUF+256,X0
        10 004146   777777 102003                    CMPX2   -1,DU
        10 004147   004154 600000 10                 TZE     s:10350
        10 004150   004631 235011 0                  LDA     CSTAT+8,X1
        10 004151   004154 600000 10                 TZE     s:10350
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:243  

     1091    10347    6                       AND VID1.SECTSTRT(J)<=VIDBUF.DGT.LGRAN(I)
     1092    10348    6                       AND VIDBUF.DTT(I)~=262143 AND VID1.SECTSTRT(J)~=0
     1093    10349    6                     THEN VID1.SECTSTRT(J)=VIDBUF.DGT.LGRAN(I)+1;

  10349 10 004152   000001 036007                    ADLQ    1,DL
        10 004153   004631 756011 0                  STQ     CSTAT+8,X1

     1094    10350    6                     END;

  10350 10 004154   001076 235000 0                  LDA     I
        10 004155   000001 035007                    ADLA    1,DL
        10 004156   001076 755000 0                  STA     I
        10 004157   000077 115007                    CMPA    63,DL
        10 004160   004130 602000 10                 TNC     s:10346

     1095    10351    5                  I=0; /* RESTORE I */

  10351 10 004161   001076 450000 0                  STZ     I

     1096    10352    6                  IF VID1.SECTSTRT(J)>F$DCB.IXTNSIZE THEN DO;

  10352 10 004162   000000 470400 xsym               LDP0    M$DP$
        10 004163   001104 720000 0                  LXL0    J
        10 004164   004631 236010 0                  LDQ     CSTAT+8,X0
        10 004165   004170 604000 10                 TMI     s:10353
        10 004166   000041 116100                    CMPQ    33,,PR0
        10 004167   004203 604400 10                 TMOZ    s:10357

     1097    10353    6                     I=VID1.SNLIST.SIZE(J);

  10353 10 004170   001104 235000 0                  LDA     J
        10 004171   000002 735000                    ALS     2
        10 004172   005322 235005 0                  LDA     CSTAT+321,AL
        10 004173   001076 755000 0                  STA     I

     1098    10354    6                     CALL CLOSE(DCBNUM(M$DP));
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:244  

  10354 10 004174   000000 236007 xsym               LDQ     M$DP,DL
        10 004175   201356 756100                    STQ     BXP+9,,AUTO
        10 004176   201356 631500                    EPPR1   BXP+9,,AUTO
        10 004177   201341 451500                    STP1    P$+2,,AUTO
        10 004200   012416 701000 10                 TSX1    CLOSE
        10 004201   000000 011000                    NOP     0

     1099    10355    6                     GOTO TOOMANY;

  10355 10 004202   014015 710000 10                 TRA     TOOMANY

     1100    10356    6                     END;
     1101    10357    5                  IF VID1.SECTSTRT(J)=VID1.SECTSTRT(J+1)

  10357 10 004203   004632 116010 0                  CMPQ    CSTAT+9,X0
        10 004204   004207 601000 10                 TNZ     s:10359

     1102    10358    5                  THEN VID1.SECTSTRT(J+1)=F$DCB.IXTNSIZE;

  10358 10 004205   000041 235100                    LDA     33,,PR0
        10 004206   004632 755010 0                  STA     CSTAT+9,X0

     1103    10359    5                  VID1.SNLIST.SIZE(J)=VID1.SECTSTRT(J+1)-VID1.SECTSTRT(J);

  10359 10 004207   001104 235000 0                  LDA     J
        10 004210   000002 735000                    ALS     2
        10 004211   001104 720000 0                  LXL0    J
        10 004212   004632 236010 0                  LDQ     CSTAT+9,X0
        10 004213   004631 136010 0                  SBLQ    CSTAT+8,X0
        10 004214   005322 756005 0                  STQ     CSTAT+321,AL

     1104    10360    5                  IF VID1.SNLIST.SIZE(J)>262143 THEN GOTO BIGSECT;

  10360 10 004215   001104 235000 0                  LDA     J
        10 004216   000002 735000                    ALS     2
        10 004217   005322 235005 0                  LDA     CSTAT+321,AL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:245  
        10 004220   000001 115003                    CMPA    1,DU
        10 004221   004307 603000 10                 TRC     BIGSECT

     1105    10361    5                  J=J+1;

  10361 10 004222   001104 235000 0                  LDA     J
        10 004223   000001 035007                    ADLA    1,DL
        10 004224   001104 755000 0                  STA     J

     1106    10362    5                  END;

  10362 10 004225   001104 720000 0                  LXL0    J
        10 004226   004632 236010 0                  LDQ     CSTAT+9,X0
        10 004227   004631 116005 0                  CMPQ    CSTAT+8,AL
        10 004230   004127 603000 10                 TRC     s:10345

     1107    10363    4               VIDBUF.SECTSTRT=VID1.SECTSTRT;

  10363 10 004231   000000 100400                    MLR     fill='000'O
        10 004232   004631 000150 0                  ADSC9   CSTAT+8                  cn=0,n=104
        10 004233   002631 000150 0                  ADSC9   VIDBUF+8                 cn=0,n=104

     1108    10364    4               VID1.DTT=VIDBUF.DTT;

  10364 10 004234   000000 100400                    MLR     fill='000'O
        10 004235   003221 000376 0                  ADSC9   VIDBUF+256               cn=0,n=254
        10 004236   005221 000376 0                  ADSC9   CSTAT+256                cn=0,n=254

     1109    10365    4               VID1.DGT=VIDBUF.DGT;

  10365 10 004237   000000 100400                    MLR     fill='000'O
        10 004240   003121 000400 0                  ADSC9   VIDBUF+192               cn=0,n=256
        10 004241   005121 000400 0                  ADSC9   CSTAT+192                cn=0,n=256

     1110    10366    4               VID1.VSN=VIDBUF.VSN;

  10366 10 004242   002623 235000 0                  LDA     VIDBUF+2
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:246  
        10 004243   004623 755000 0                  STA     CSTAT+2

     1111    10367    4               END;

  10367 10 004244   004312 710000 10                 TRA     s:10386

     1112    10368    3            ELSE VIDBUF=VID1;

  10368 10 004245   010000 220003                    LDX0    4096,DU
        10 004246   000040 100440                    MLR     fill='000'O
        10 004247   004621 000010 0                  ADSC9   CSTAT                    cn=0,n=*X0
        10 004250   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0
        10 004251   004312 710000 10                 TRA     s:10386

     1113    10369    4            ELSE DO;

     1114    10370    4               IF SUBSTR(OPNSN.SN#(0),0,1)=BINASC(0) THEN VIDBUF.SECTSTRT='0'B;

  10370 10 004252   000073 236000 0                  LDQ     OPNSN+1
        10 004253   777000 376003                    ANQ     -512,DU
        10 004254   000000 116003                    CMPQ    0,DU
        10 004255   004262 601000 10                 TNZ     s:10371

  10370 10 004256   000000 100400                    MLR     fill='000'O
        10 004257   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        10 004260   002631 000150 0                  ADSC9   VIDBUF+8                 cn=0,n=104
        10 004261   004276 710000 10                 TRA     s:10373

     1115    10371    4               ELSE IF SUBSTR(OPNSN.SN#(0),0,1) > ' ' AND VIDBUF.SECTSTRT(1) = 0

  10371 10 004262   000073 236000 0                  LDQ     OPNSN+1
        10 004263   777000 376003                    ANQ     -512,DU
        10 004264   040000 116003                    CMPQ    16384,DU
        10 004265   004276 602000 10                 TNC     s:10373
        10 004266   004276 600000 10                 TZE     s:10373
        10 004267   002632 235000 0                  LDA     VIDBUF+9
        10 004270   004276 601000 10                 TNZ     s:10373
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:247  
        10 004271   001076 236000 0                  LDQ     I
        10 004272   000002 736000                    QLS     2
        10 004273   005322 235006 0                  LDA     CSTAT+321,QL
        10 004274   000001 115003                    CMPA    1,DU
        10 004275   004312 602000 10                 TNC     s:10386

     1116    10372    4                 AND VID1.SNLIST.SIZE(I) < 262144 THEN EXIT;
     1117    10373    4               IF VIDBUF.SECTSTRT(1)<262144 AND (VIDBUF.SECTSTRT(1)>0

  10373 10 004276   002632 235000 0                  LDA     VIDBUF+9
        10 004277   000001 115003                    CMPA    1,DU
        10 004300   004307 603000 10                 TRC     BIGSECT
        10 004301   000000 115003                    CMPA    0,DU
        10 004302   004312 601000 10                 TNZ     s:10386
        10 004303   000000 470400 xsym               LDP0    M$DP$
        10 004304   000041 235100                    LDA     33,,PR0
        10 004305   000001 115003                    CMPA    1,DU
        10 004306   004312 604000 10                 TMI     s:10386

  10373 10 004307                       BIGSECT      null
     1118    10374    4                 OR F$DCB.IXTNSIZE<262144) THEN EXIT;
     1119    10375    4   BIGSECT:    ;
     1120    10376                    /*E*     ERROR: FXP-E$BIGSECT-E
     1121    10377                    *        MESSAGE:Volume section size exceeds 262143 granules.
     1122    10378                    *        MESSAGE1:CP-6 File management requires that any disk volume
     1123    10379                    *        section granule number be represented in 18 bit fields.
     1124    10380                    *        Therefore, on devices comprising more than 262143
     1125    10381                    *        pages of storage, smaller sections must be specified.
     1126    10382                    */
     1127    10383    4               FLAG=FXP$E$BIGSECT;

  10383 10 004307   000050 236000 2                  LDQ     FXP$E$BIGSECT
        10 004310   001107 756000 0                  STQ     FLAG

     1128    10384    4               GOTO DPERR1;

  10384 10 004311   013567 710000 10                 TRA     DPERR1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:248  

     1129    10385    4               END;
     1130    10386    3            VIDBUF.VOLCNT=0;

  10386 10 004312   000000 220003                    LDX0    0,DU
        10 004313   002625 440000 0                  SXL0    VIDBUF+4

     1131    10387    3            VIDBUF.SYSSIZE=0;

  10387 10 004314   002626 450000 0                  STZ     VIDBUF+5

     1132    10388    3            VIDBUF.ID='CP6';

  10388 10 004315   000556 236000 2                  LDQ     FFLGS+71
        10 004316   000005 376000 11                 ANQ     5
        10 004317   000040 276007                    ORQ     32,DL
        10 004320   002621 756000 0                  STQ     VIDBUF

     1133    10389    3            CALL M$WRITE(WRITEVID)ALTRET(DPERR);

  10389 10 004321   000416 630400 0                  EPPR0   READVID
        10 004322   440001 713400                    CLIMB   alt,write
        10 004323   401400 401760                    pmme    nvectors=4
        10 004324   013551 702000 10                 TSX2    DPERR

     1134    10390    3            GRANULE=GRANULE+VID1.SNLIST.SIZE(I);

  10390 10 004325   001076 235000 0                  LDA     I
        10 004326   000002 735000                    ALS     2
        10 004327   001113 236000 0                  LDQ     GRANULE
        10 004330   005322 036005 0                  ADLQ    CSTAT+321,AL
        10 004331   001113 756000 0                  STQ     GRANULE

     1135    10391    3            IF VID1.SNLIST(I+1) THEN NUMSNS=NUMSNS+1;

  10391 10 004332   001076 235000 0                  LDA     I
        10 004333   000004 735000                    ALS     4
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:249  
        10 004334   000000 106405                    CMPC    fill='000'O
        10 004335   005325 000020 0                  ADSC9   CSTAT+324,A              cn=0,n=16
        10 004336   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
        10 004337   004343 600000 10                 TZE     ALRDYSCRCH

  10391 10 004340   001112 235000 0                  LDA     NUMSNS
        10 004341   000001 035007                    ADLA    1,DL
        10 004342   001112 755000 0                  STA     NUMSNS

  10391 10 004343                       ALRDYSCRCH   null
     1136    10392    3   ALRDYSCRCH:;
     1137    10393    3            IF GRANULE=0 THEN CALL CLOSE(DCBNUM(M$DP));

  10393 10 004343   001113 235000 0                  LDA     GRANULE
        10 004344   004353 601000 10                 TNZ     s:10394

  10393 10 004345   000000 236007 xsym               LDQ     M$DP,DL
        10 004346   201357 756100                    STQ     BXP+10,,AUTO
        10 004347   201357 630500                    EPPR0   BXP+10,,AUTO
        10 004350   201341 450500                    STP0    P$+2,,AUTO
        10 004351   012416 701000 10                 TSX1    CLOSE
        10 004352   000000 011000                    NOP     0

     1138    10394    3            I=I+1;

  10394 10 004353   001076 235000 0                  LDA     I
        10 004354   000001 035007                    ADLA    1,DL
        10 004355   001076 755000 0                  STA     I

     1139    10395    3            END;

  10395 10 004356   001076 236000 0                  LDQ     I
        10 004357   001112 116000 0                  CMPQ    NUMSNS
        10 004360   003730 602000 10                 TNC     s:10310

     1140    10396    2         CALL CLOSE(DCBNUM(M$DP));

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:250  
  10396 10 004361   000000 236007 xsym               LDQ     M$DP,DL
        10 004362   201360 756100                    STQ     BXP+11,,AUTO
        10 004363   201360 630500                    EPPR0   BXP+11,,AUTO
        10 004364   201341 450500                    STP0    P$+2,,AUTO
        10 004365   012416 701000 10                 TSX1    CLOSE
        10 004366   000000 011000                    NOP     0

     1141    10397    2         IF B$JIT.NEXTCC ~= %CC_FROMUC# THEN /* delay for STAR 42926 */

  10397 10 004367   000000 470400 xsym               LDP0    B$JIT$
        10 004370   000151 236100                    LDQ     105,,PR0
        10 004371   000777 376003                    ANQ     511,DU
        10 004372   000003 116003                    CMPQ    3,DU
        10 004373   011257 600000 10                 TZE     s:11238

     1142    10398    2         CALL M$WAIT(WAIT1);

  10398 10 004374   000026 630400 2                  EPPR0   WAIT1
        10 004375   020006 713400                    CLIMB   8198
        10 004376   400400 401760                    pmme    nvectors=2
        10 004377   011257 710000 10                 TRA     s:11238

     1143    10399        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:251  
     1144    10400    2      CASE(%(E$CREATE-E$PIGH),%(E$MODIFY-E$PIGH));

     1145    10401                    /*E*     ERROR: FXP-E$CREATE-0
     1146    10402                    *        MESSAGE:CReate DP#set.acct options
     1147    10403                    *        Type Help OPtions for options. Default from PADFIT.
     1148    10404                    */
     1149    10405                    /*E*     ERROR: FXP-E$MODIFY-0
     1150    10406                    *        MESSAGE:Modify DP#set.acct options
     1151    10407                    *        Type Help OPtions for options. Default from FDFIT.
     1152    10408                    */
     1153    10409                    /*E*     ERROR: FXP-E$OPTIONS-0
     1154    10410                    *        MESSAGE:Options are separated by commas
     1155    10411                    *        [NO] Checkwrite - controls writes of directories
     1156    10412                    *        [NO] Acup - controls maintenance of access dates
     1157    10413                    *        [NO] [Default] Backup - controls auto backup mode
     1158    10414                    *        Granlim = n - limits total granules in acct
     1159    10415                    *        CGmem = n - limits total CG pages in memory
     1160    10416                    *        [NOt] PRotected - controls multi-user-authorization access
     1161    10417                    *        [NO] PUrge - controls automatic file purge
     1162    10418                    *        [NO] STow - controls stowability of files
     1163    10419                    *        [NO] Datacheckwrite - controls all writes
     1164    10420                    *        [NO] Merge - makes file override merge instead
     1165    10421                   *       Owner = (account/name...) - permits access modification to users
     1166    10422                    *        NONE = (acct...) - no access even to the filenames
     1167    10423                    *        WRITE = (acct...) - default creator access, files override
     1168    10424                    *        Nolist = (acct...) - default nolist, but files may override
     1169    10425                    *        list = (acct...) - other default accesses, files override
     1170    10426                    *        ...list elements follow...separate by blanks or not at all
     1171    10427                    *        Create - create new files
     1172    10428                    *        Delrec - delete records
     1173    10429                    *        DELF - delete file, change name, password, access control
     1174    10430                    *        Execute - access depends on access vehicle
     1175    10431                    *        Fitmod - change all but name, password, access control
     1176    10432                    *        Read - read records, position
     1177    10433                    *        REATtr - same as Fitmod
     1178    10434                    *        Scratch - same as DELF
     1179    10435                    *        Update - replace existing records
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:252  
     1180    10436                    *        Wnew - add new records
     1181    10437                    */
     1182    10438    2         IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0 THEN GOTO MADLIST;

  10438 10 004400   001073 470400 0                  LDP0    BLK$
        10 004401   000004 471500                    LDP1    4,,PR0
        10 004402   100000 720100                    LXL0    0,,PR1
        10 004403   010016 600000 10                 TZE     MADLIST

     1183    10439    3         IF OPNSN.SN#(0)='_' AND MODE=0 THEN DO;

  10439 10 004404   040000 106400                    CMPC    fill='040'O
        10 004405   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 004406   000076 000001 11                 ADSC9   62                       cn=0,n=1
        10 004407   004417 601000 10                 TNZ     s:10444
        10 004410   001121 236000 0                  LDQ     MODE
        10 004411   004417 601000 10                 TNZ     s:10444

     1184    10440                    /* Super "check syntax" request, just send back a response */
     1185    10441    3            CALL ERROR(10);

  10441 10 004412   000016 236000 11                 LDQ     14
        10 004413   201341 756100                    STQ     P$+2,,AUTO
        10 004414   011704 701000 10                 TSX1    ERROR
        10 004415   000000 011000                    NOP     0

     1186    10442    3            GOTO NEXT;

  10442 10 004416   000204 710000 10                 TRA     NEXT

     1187    10443    3            END;
     1188    10444    2         SELACCT=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;

  10444 10 004417   000005 473500                    LDP3    5,,PR0
        10 004420   300004 236100                    LDQ     4,,PR3
        10 004421   000033 772000                    QRL     27
        10 004422   000000 621006                    EAX1    0,QL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:253  
        10 004423   040000 100540                    MLR     fill='040'O
        10 004424   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
        10 004425   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8

     1189    10445    2   ACCTNXT: LBUFC=VLP_ACCT.ACCT#;

  10445 10 004426   040000 100400       ACCTNXT      MLR     fill='040'O
        10 004427   000076 000010 0                  ADSC9   VLP_ACCT                 cn=0,n=8
        10 004430   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

     1190    10446    2         VLP_ACCT.ACCT#=BINASC(0);

  10446 10 004431   000010 235000 11                 LDA     8
        10 004432   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 004433   000076 757000 0                  STAQ    VLP_ACCT

     1191    10447    2         FLAG='0'B;

  10447 10 004434   001107 450000 0                  STZ     FLAG

     1192    10448    2         FIT.CODES.CODE(0)=0;

  10448 10 004435   000077 236000 11                 LDQ     63
        10 004436   002621 356000 0                  ANSQ    VIDBUF

     1193    10449    2         IF PROJAD.L=0 THEN CALL M$OPEN(OPNDP)ALTRET(NOALT);

  10449 10 004437   001127 236000 0                  LDQ     PROJAD
        10 004440   777000 316003                    CANQ    -512,DU
        10 004441   004447 601000 10                 TNZ     s:10450

  10449 10 004442   000100 630400 0                  EPPR0   OPNDP
        10 004443   450000 713400                    CLIMB   alt,open
        10 004444   410400 401760                    pmme    nvectors=18
        10 004445   014123 702000 10                 TSX2    NOALT
        10 004446   004453 710000 10                 TRA     s:10451

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:254  
     1194    10450    2         ELSE VIDBUF=CSTAT;

  10450 10 004447   010000 220003                    LDX0    4096,DU
        10 004450   000040 100440                    MLR     fill='000'O
        10 004451   004621 000010 0                  ADSC9   CSTAT                    cn=0,n=*X0
        10 004452   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0

     1195    10451    2         IF F$DCB.IASN=%FMDIAG# THEN CALL M$SPRIV(PRIVFPT);

  10451 10 004453   000000 470400 xsym               LDP0    M$DP$
        10 004454   000103 236100                    LDQ     67,,PR0
        10 004455   000777 376007                    ANQ     511,DL
        10 004456   000007 116007                    CMPQ    7,DL
        10 004457   004463 601000 10                 TNZ     s:10452

  10451 10 004460   000634 630400 0                  EPPR0   PRIVFPT
        10 004461   020012 713400                    CLIMB   8202
        10 004462   400000 401760                    pmme    nvectors=1

     1196    10452    2         VLP_ACCT.ACCT#=LBUFC;

  10452 10 004463   006702 237000 0                  LDAQ    LBUFC
        10 004464   000076 757000 0                  STAQ    VLP_ACCT

     1197    10453    2         IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0 THEN I=2;

  10453 10 004465   001073 470400 0                  LDP0    BLK$
        10 004466   000004 471500                    LDP1    4,,PR0
        10 004467   100000 720100                    LXL0    0,,PR1
        10 004470   004474 601000 10                 TNZ     s:10455

  10453 10 004471   000002 235007                    LDA     2,DL
        10 004472   001076 755000 0                  STA     I
        10 004473   004500 710000 10                 TRA     s:10458

     1198    10454    3         ELSE DO;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:255  
     1199    10455    3            CALL NXTACCT ALTRET(NEXT);

  10455 10 004474   012443 701000 10                 TSX1    NXTACCT
        10 004475   000204 702000 10                 TSX2    NEXT

     1200    10456    3            I=3;

  10456 10 004476   000003 235007                    LDA     3,DL
        10 004477   001076 755000 0                  STA     I

     1201    10457    3            END;

     1202    10458    2         IF BREAK~=0 THEN GOTO CMDABORT;

  10458 10 004500   001125 236000 0                  LDQ     BREAK
        10 004501   014002 601000 10                 TNZ     CMDABORT

     1203    10459    2         IF CODE=%E$MODIFY THEN /* MODIFY WHAT'S THERE */

  10459 10 004502   200007 235100                    LDA     CODE,,AUTO
        10 004503   000154 115007                    CMPA    108,DL
        10 004504   004511 601000 10                 TNZ     s:10462

     1204    10460    2   OPNACCT:
     1205    10461    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10461 10 004505   000100 630400 0     OPNACCT      EPPR0   OPNDP
        10 004506   450000 713400                    CLIMB   alt,open
        10 004507   410400 401760                    pmme    nvectors=18
        10 004510   013551 702000 10                 TSX2    DPERR

     1206    10462    2         CALL MOVEFIT;

  10462 10 004511   013064 701000 10                 TSX1    MOVEFIT
        10 004512   000000 011000                    NOP     0

     1207    10463    3         IF CODE=%E$CREATE THEN DO;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:256  

  10463 10 004513   200007 235100                    LDA     CODE,,AUTO
        10 004514   000153 115007                    CMPA    107,DL
        10 004515   004530 601000 10                 TNZ     s:10468

     1208    10464    3            IF FLAG THEN GOTO DPERR;

  10464 10 004516   001107 236000 0                  LDQ     FLAG
        10 004517   013551 601000 10                 TNZ     DPERR

     1209    10465    3            FIT14.NDW=SIZEW(CODE14)-SIZEW(CODE14.OWNER)+SIZEW(CODE14.OWNER(0));

  10465 10 004520   001417 236000 0                  LDQ     FIT14
        10 004521   000100 376000 11                 ANQ     64
        10 004522   020000 276007                    ORQ     8192,DL
        10 004523   001417 756000 0                  STQ     FIT14

     1210    10466    3            CODE14.OWNER.ACCT(0)=' ';

  10466 10 004524   000035 235000 xsym               LDA     B_VECTNIL+29
        10 004525   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 004526   001437 755000 0                  STA     CODE14+3
        10 004527   001440 756000 0                  STQ     CODE14+4

     1211    10467    3            END;

     1212    10468    2         X9=0;

  10468 10 004530   200006 450100                    STZ     X9,,AUTO

     1213    10469    3         DO WHILE (I<OUT$BLK.NSUBLKS);

  10469 10 004531   001073 470400 0                  LDP0    BLK$
        10 004532   000001 236100                    LDQ     1,,PR0
        10 004533   000022 772000                    QRL     18
        10 004534   001076 116000 0                  CMPQ    I
        10 004535   004552 602000 10                 TNC     s:10473
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:257  
        10 004536   004552 600000 10                 TZE     s:10473

     1214    10470    3            CALL GET_OPTIONS ALTRET(TOOMANY);

  10470 10 004537   014573 701000 10                 TSX1    GET_OPTIONS
        10 004540   014015 702000 10                 TSX2    TOOMANY

     1215    10471    3            I=I+1;

  10471 10 004541   001076 235000 0                  LDA     I
        10 004542   000001 035007                    ADLA    1,DL
        10 004543   001076 755000 0                  STA     I

     1216    10472    3            END;

  10472 10 004544   001073 470400 0                  LDP0    BLK$
        10 004545   000001 236100                    LDQ     1,,PR0
        10 004546   000022 772000                    QRL     18
        10 004547   001076 116000 0                  CMPQ    I
        10 004550   004552 600000 10                 TZE     s:10473
        10 004551   004537 603000 10                 TRC     s:10470

     1217    10473    2         FLAG='0'B;

  10473 10 004552   001107 450000 0                  STZ     FLAG

     1218    10474    3         IF PROJAD.L~=0 THEN DO;

  10474 10 004553   001127 236000 0                  LDQ     PROJAD
        10 004554   777000 316003                    CANQ    -512,DU
        10 004555   004565 600000 10                 TZE     s:10478

     1219    10475    3            I=CODE14.MGRANS;

  10475 10 004556   001435 236000 0                  LDQ     CODE14+1
        10 004557   000032 376000 xsym               ANQ     B_VECTNIL+26
        10 004560   001076 756000 0                  STQ     I
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:258  

     1220    10476    3            CALL FXU$PROJGR(I) ALTRET(DPERR1);

  10476 10 004561   000101 630400 11                 EPPR0   65
        10 004562   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 004563   000000 701000 xent               TSX1    FXU$PROJGR
        10 004564   013567 702000 10                 TSX2    DPERR1

     1221    10477    3            END;

     1222    10478    2         OPNDP.IFPARAM_=OPNDP.FPARAM_;

  10478 10 004565   000130 237000 0                  LDAQ    OPNDP+24
        10 004566   000126 757000 0                  STAQ    OPNDP+22

     1223    10479    2         VBASE(OPNDP.IFPARAM_)=ADDR(FIT00);

  10479 10 004567   000102 236000 11                 LDQ     66
        10 004570   000127 756000 0                  STQ     OPNDP+23

     1224    10480    2         OPNDP.V.FUN#=%UPDATE#;

  10480 10 004571   001000 236007                    LDQ     512,DL
        10 004572   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1225    10481    2         CALL M$OPEN(OPNDP)ALTRET(NOALT);

  10481 10 004573   000100 630400 0                  EPPR0   OPNDP
        10 004574   450000 713400                    CLIMB   alt,open
        10 004575   410400 401760                    pmme    nvectors=18
        10 004576   014123 702000 10                 TSX2    NOALT

     1226    10482    3         IF FLAG.CODE=%E$PSGRANS AND PROJAD.L=0 THEN DO;

  10482 10 004577   001107 236000 0                  LDQ     FLAG
        10 004600   377770 376007                    ANQ     131064,DL
        10 004601   002140 116007                    CMPQ    1120,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:259  
        10 004602   004633 601000 10                 TNZ     s:10489
        10 004603   001127 236000 0                  LDQ     PROJAD
        10 004604   777000 316003                    CANQ    -512,DU
        10 004605   004633 601000 10                 TNZ     s:10489

     1227    10483    3            CALL M$READ(READVID)ALTRET(DPERR);

  10483 10 004606   000416 630400 0                  EPPR0   READVID
        10 004607   440000 713400                    CLIMB   alt,read
        10 004610   401400 401760                    pmme    nvectors=4
        10 004611   013551 702000 10                 TSX2    DPERR

     1228    10484    3            IF F$DCB.OWNER THEN CALL RECONST ALTRET(DPERR1);

  10484 10 004612   000000 470400 xsym               LDP0    M$DP$
        10 004613   000064 236100                    LDQ     52,,PR0
        10 004614   040000 316007                    CANQ    16384,DL
        10 004615   004620 600000 10                 TZE     s:10485

  10484 10 004616   014324 701000 10                 TSX1    RECONST
        10 004617   013567 702000 10                 TSX2    DPERR1

     1229    10485    3            CALL CLOSE(DCBNUM(M$DP));

  10485 10 004620   000000 236007 xsym               LDQ     M$DP,DL
        10 004621   201361 756100                    STQ     BXP+12,,AUTO
        10 004622   201361 630500                    EPPR0   BXP+12,,AUTO
        10 004623   201341 450500                    STP0    P$+2,,AUTO
        10 004624   012416 701000 10                 TSX1    CLOSE
        10 004625   000000 011000                    NOP     0

     1230    10486    3            FLAG='0'B;

  10486 10 004626   001107 450000 0                  STZ     FLAG

     1231    10487    3            CALL M$OPEN(OPNDP)ALTRET(NOALT);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:260  
  10487 10 004627   000100 630400 0                  EPPR0   OPNDP
        10 004630   450000 713400                    CLIMB   alt,open
        10 004631   410400 401760                    pmme    nvectors=18
        10 004632   014123 702000 10                 TSX2    NOALT

     1232    10488    3            END;

     1233    10489    2         OPNDP.IFPARAM_=VECTOR(NIL);

  10489 10 004633   000024 237000 11                 LDAQ    20
        10 004634   000126 757000 0                  STAQ    OPNDP+22

     1234    10490    2         IF FLAG THEN GOTO DPERR;

  10490 10 004635   001107 235000 0                  LDA     FLAG
        10 004636   013551 601000 10                 TNZ     DPERR

     1235    10491    2         CALL M$RPRIV(PRIVFPT)ALTRET(NOALT);

  10491 10 004637   000634 630400 0                  EPPR0   PRIVFPT
        10 004640   420013 713400                    CLIMB   alt,+8203
        10 004641   400000 401760                    pmme    nvectors=1
        10 004642   014123 702000 10                 TSX2    NOALT

     1236    10492    2         CALL FXU$TRACKER(P_PCB);

  10492 10 004643   000011 630400 11                 EPPR0   9
        10 004644   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 004645   000000 701000 xent               TSX1    FXU$TRACKER
        10 004646   000000 011000                    NOP     0

     1237    10493    2         IF PROJAD.L~=0 THEN CALL FXU$PROJWR ALTRET(DPERR1);

  10493 10 004647   001127 236000 0                  LDQ     PROJAD
        10 004650   777000 316003                    CANQ    -512,DU
        10 004651   004655 600000 10                 TZE     s:10494

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:261  
  10493 10 004652   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 004653   000000 701000 xent               TSX1    FXU$PROJWR
        10 004654   013567 702000 10                 TSX2    DPERR1

     1238    10494    2         GOTO LISTNXT;

  10494 10 004655   004723 710000 10                 TRA     LISTNXT

     1239    10495        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:262  
     1240    10496    2      CASE(%(E$LIST-E$PIGH));

     1241    10497                    /*E*     ERROR: FXP-E$LIST-0
     1242    10498                    *        MESSAGE:List {DP#set[.acct]|.acct}
     1243    10499                    */
     1244    10500    2         IF OPNSN.SN#(0)=' ' THEN GOTO MADLIST;

  10500 10 004656   040000 106400                    CMPC    fill='040'O
        10 004657   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 004660   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 004661   010016 600000 10                 TZE     MADLIST

  10500 10 004662                       LISTNXTM     null
     1245    10501    2   LISTNXTM:;
     1246    10502    2         CALL M$OPEN(OPNDP)ALTRET(NOALT);

  10502 10 004662   000100 630400 0                  EPPR0   OPNDP
        10 004663   450000 713400                    CLIMB   alt,open
        10 004664   410400 401760                    pmme    nvectors=18
        10 004665   014123 702000 10                 TSX2    NOALT

     1247    10503    2   LISTNXT0: IF F$DCB.IASN=%FMDIAG# OR B$JIT.PPRIV.PIGD

  10503 10 004666   000000 470400 xsym  LISTNXT0     LDP0    M$DP$
        10 004667   000103 236100                    LDQ     67,,PR0
        10 004670   000777 376007                    ANQ     511,DL
        10 004671   000007 116007                    CMPQ    7,DL
        10 004672   004677 600000 10                 TZE     s:10504
        10 004673   000000 471400 xsym               LDP1    B$JIT$
        10 004674   100020 236100                    LDQ     16,,PR1
        10 004675   010000 316003                    CANQ    4096,DU
        10 004676   004703 600000 10                 TZE     s:10505

     1248    10504    2         THEN CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);

  10504 10 004677   000634 630400 0                  EPPR0   PRIVFPT
        10 004700   420012 713400                    CLIMB   alt,+8202
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:263  
        10 004701   400000 401760                    pmme    nvectors=1
        10 004702   014123 702000 10                 TSX2    NOALT

     1249    10505    2         LISTH1.PSN=OPNSN.SN#(0);

  10505 10 004703   040000 100400                    MLR     fill='040'O
        10 004704   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 004705   006655 600006 0                  ADSC9   LISTH1                   cn=3,n=6

     1250    10506    3         IF OUT$BLK.NSUBLKS>2 THEN DO;

  10506 10 004706   001073 470400 0                  LDP0    BLK$
        10 004707   000001 220100                    LDX0    1,,PR0
        10 004710   000003 100003                    CMPX0   3,DU
        10 004711   004723 602000 10                 TNC     LISTNXT

     1251    10507    3            SELACCT=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;

  10507 10 004712   000005 471500                    LDP1    5,,PR0
        10 004713   100004 236100                    LDQ     4,,PR1
        10 004714   000033 772000                    QRL     27
        10 004715   000000 621006                    EAX1    0,QL
        10 004716   040000 100540                    MLR     fill='040'O
        10 004717   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 004720   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8

     1252    10508    3            CALL NXTACCT ALTRET(LISTGP);

  10508 10 004721   012443 701000 10                 TSX1    NXTACCT
        10 004722   005637 702000 10                 TSX2    LISTGP

     1253    10509    3            END;

  10506 10 004723                       LISTNXT      null
     1254    10510    2   LISTNXT:;
     1255    10511    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:264  
  10511 10 004723   000100 630400 0                  EPPR0   OPNDP
        10 004724   450000 713400                    CLIMB   alt,open
        10 004725   410400 401760                    pmme    nvectors=18
        10 004726   013551 702000 10                 TSX2    DPERR

     1256    10512    2         IF PROJAD.L~=0 AND F$DCB.ACCT=BINASC(0) THEN VIDBUF=CSTAT;

  10512 10 004727   001127 236000 0                  LDQ     PROJAD
        10 004730   777000 316003                    CANQ    -512,DU
        10 004731   004742 600000 10                 TZE     s:10513
        10 004732   000000 470400 xsym               LDP0    M$DP$
        10 004733   000020 237100                    LDAQ    16,,PR0
        10 004734   000104 117000 11                 CMPAQ   68
        10 004735   004742 601000 10                 TNZ     s:10513

  10512 10 004736   010000 220003                    LDX0    4096,DU
        10 004737   000040 100440                    MLR     fill='000'O
        10 004740   004621 000010 0                  ADSC9   CSTAT                    cn=0,n=*X0
        10 004741   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0

     1257    10513    2         CALL MOVEFIT;

  10513 10 004742   013064 701000 10                 TSX1    MOVEFIT
        10 004743   000000 011000                    NOP     0

  10512 10 004744                       LISTNXT1     null
     1258    10514    2   LISTNXT1:;
     1259    10515    2         LBUFC=LBUF0;

  10515 10 004744   040000 100400                    MLR     fill='040'O
        10 004745   000353 000030 2                  ADSC9   LBUF0                    cn=0,n=24
        10 004746   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

     1260    10516    2         IF CODE14.CGRANS>99999 THEN LBUF.CGRANS='*****';

  10516 10 004747   001436 235000 0                  LDA     CODE14+2
        10 004750   303237 115007                    CMPA    99999,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:265  
        10 004751   004756 604400 10                 TMOZ    s:10517

  10516 10 004752   040000 100400                    MLR     fill='040'O
        10 004753   000557 000005 2                  ADSC9   FFLGS+72                 cn=0,n=5
        10 004754   006704 400005 0                  ADSC9   LBUFC+2                  cn=2,n=5
        10 004755   004761 710000 10                 TRA     s:10518

     1261    10517    2         ELSE CALL BINCHAR(LBUF.CGRANS,CODE14.CGRANS);

  10517 10 004756   000000 301400                    BTD
        10 004757   001436 000004 0                  NDSC9   CODE14+2                 cn=0,s=lsgnf,sf=0,n=4
        10 004760   006704 430005 0                  NDSC9   LBUFC+2                  cn=2,s=nosgn,sf=0,n=5

     1262    10518    2         CALL EDITSTR(LBUF.CGRANS,0,4,'001000100'B,LBUF.CGRANS);

  10518 10 004761   000000 020400                    MVE
        10 004762   006704 400005 0                  ADSC9   LBUFC+2                  cn=2,n=5
        10 004763   000106 000001 11                 ADSC9   70                       cn=0,n=1
        10 004764   006704 400004 0                  ADSC9   LBUFC+2                  cn=2,n=4

     1263    10519    3         IF CODE14.CGRANS<0 THEN DO;

  10519 10 004765   000000 115003                    CMPA    0,DU
        10 004766   005002 605000 10                 TPL     s:10523

     1264    10520    3            CALL INDEX1R(J,' ',LBUFC,15);

  10520 10 004767   000000 125400                    SCMR    mask='000'O
        10 004770   006702 000017 0                  ADSC9   LBUFC                    cn=0,n=15
        10 004771   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 004772   001104 000000 0                  ARG     J
        10 004773   004776 606400 10                 TTN     s:10521
        10 004774   000016 236007                    LDQ     14,DL
        10 004775   001104 156000 0                  SSQ     J

     1265    10521    3            CALL INSERT(LBUFC,J,1,'-');

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:266  
  10521 10 004776   001104 236000 0                  LDQ     J
        10 004777   040006 100400                    MLR     fill='040'O
        10 005000   000107 000001 11                 ADSC9   71                       cn=0,n=1
        10 005001   006702 000001 0                  ADSC9   LBUFC,Q                  cn=0,n=1

     1266    10522    3            END;

     1267    10523    2         IF CODE14.MGRANS>99999 THEN LBUF.MGRANS='*****';

  10523 10 005002   001435 236000 0                  LDQ     CODE14+1
        10 005003   000032 376000 xsym               ANQ     B_VECTNIL+26
        10 005004   303240 116007                    CMPQ    100000,DL
        10 005005   005012 602000 10                 TNC     s:10524

  10523 10 005006   040000 100400                    MLR     fill='040'O
        10 005007   000557 000005 2                  ADSC9   FFLGS+72                 cn=0,n=5
        10 005010   006706 600005 0                  ADSC9   LBUFC+4                  cn=3,n=5
        10 005011   005017 710000 10                 TRA     s:10525

     1268    10524    2         ELSE CALL BINCHAR(LBUF.MGRANS,CODE14.MGRANS);

  10524 10 005012   000000 235003                    LDA     0,DU
        10 005013   201346 757100                    STAQ    BXP+1,,AUTO
        10 005014   000000 301500                    BTD
        10 005015   201346 000010                    NDSC9   BXP+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
        10 005016   006706 630005 0                  NDSC9   LBUFC+4                  cn=3,s=nosgn,sf=0,n=5

     1269    10525    2         CALL EDITSTR(LBUF.MGRANS,0,4,'001000100'B,LBUF.MGRANS);

  10525 10 005017   000000 020400                    MVE
        10 005020   006706 600005 0                  ADSC9   LBUFC+4                  cn=3,n=5
        10 005021   000106 000001 11                 ADSC9   70                       cn=0,n=1
        10 005022   006706 600004 0                  ADSC9   LBUFC+4                  cn=3,n=4

     1270    10526    2         I=POFFC(ADDR(LBUF.REST),ADDR(LBUF));

  10526 10 005023   000110 236000 11                 LDQ     72
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:267  
        10 005024   000020 772000                    QRL     16
        10 005025   201346 756100                    STQ     BXP+1,,AUTO
        10 005026   000111 236000 11                 LDQ     73
        10 005027   000020 772000                    QRL     16
        10 005030   201346 136100                    SBLQ    BXP+1,,AUTO
        10 005031   001076 756000 0                  STQ     I

     1271    10527    2         I0=I;

  10527 10 005032   001077 756000 0                  STQ     I0

     1272    10528    2         FLAG=CODE14.DFLTALL;

  10528 10 005033   001434 236000 0                  LDQ     CODE14
        10 005034   000022 736000                    QLS     18
        10 005035   001107 756000 0                  STQ     FLAG

     1273    10529    2         CALL ACCTLTXT;

  10529 10 005036   012774 701000 10                 TSX1    ACCTLTXT
        10 005037   000000 011000                    NOP     0

     1274    10530    2         CALL INSERT(TCXT,0,30,SUBSTR(TCXT,2,NUMSNS-2),'=?');

  10530 10 005040   001112 720000 0                  LXL0    NUMSNS
        10 005041   777776 621010                    EAX1    -2,X0
        10 005042   040000 100440                    MLR     fill='040'O
        10 005043   000706 400011 0                  ADSC9   TEXT                     cn=2,n=*X1
        10 005044   000706 000036 0                  ADSC9   TEXT                     cn=0,n=30
        10 005045   001112 236000 0                  LDQ     NUMSNS
        10 005046   000040 116007                    CMPQ    32,DL
        10 005047   005055 603000 10                 TRC     s:10531
        10 005050   777737 622006                    EAX2    -33,QL
        10 005051   777777 662003                    ERX2    -1,DU
        10 005052   040046 100400                    MLR     fill='040'O
        10 005053   000561 000002 2                  ADSC9   FFLGS+74                 cn=0,n=2
        10 005054   000705 400012 0                  ADSC9   CORR+3,Q                 cn=2,n=*X2
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:268  

     1275    10531    2         CALL ADDPART(30,TCXT);

  10531 10 005055   000017 236000 11                 LDQ     15
        10 005056   201336 756100                    STQ     K+1,,AUTO
        10 005057   000057 236000 11                 LDQ     47
        10 005060   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005061   014145 701000 10                 TSX1    ADDPART
        10 005062   000000 011000                    NOP     0

     1276    10532    3         IF CODE=%E$LIST THEN DO;

  10532 10 005063   200007 235100                    LDA     CODE,,AUTO
        10 005064   000162 115007                    CMPA    114,DL
        10 005065   005105 601000 10                 TNZ     s:10537

     1277    10533    3            IF F$DCB.ACCT=BINASC(0) THEN CALL ERROR(8);

  10533 10 005066   000000 470400 xsym               LDP0    M$DP$
        10 005067   000020 237100                    LDAQ    16,,PR0
        10 005070   000104 117000 11                 CMPAQ   68
        10 005071   005076 601000 10                 TNZ     s:10534

  10533 10 005072   000072 236000 11                 LDQ     58
        10 005073   201341 756100                    STQ     P$+2,,AUTO
        10 005074   011704 701000 10                 TSX1    ERROR
        10 005075   000000 011000                    NOP     0

     1278    10534    3            CODE=CODE+1;

  10534 10 005076   200007 235100                    LDA     CODE,,AUTO
        10 005077   000001 035007                    ADLA    1,DL
        10 005100   200007 755100                    STA     CODE,,AUTO

     1279    10535    3            CALL ERROR(9);

  10535 10 005101   000112 236000 11                 LDQ     74
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:269  
        10 005102   201341 756100                    STQ     P$+2,,AUTO
        10 005103   011704 701000 10                 TSX1    ERROR
        10 005104   000000 011000                    NOP     0

     1280    10536    3            END;

     1281    10537    3         IF VLP_ACCT.ACCT#=BINASC(0) THEN DO;

  10537 10 005105   000076 237000 0                  LDAQ    VLP_ACCT
        10 005106   000104 117000 11                 CMPAQ   68
        10 005107   005127 601000 10                 TNZ     s:10542

     1282    10538    3            IF CODE14.ACCESS.NEWFD THEN CALL ADDPARAM(%NONEWM);

  10538 10 005110   001434 236000 0                  LDQ     CODE14
        10 005111   000001 316003                    CANQ    1,DU
        10 005112   005117 600000 10                 TZE     s:10539

  10538 10 005113   000113 236000 11                 LDQ     75
        10 005114   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005115   014226 701000 10                 TSX1    ADDPARAM
        10 005116   000000 011000                    NOP     0

     1283    10539    3            IF CODE14.ACCESS.GACSHELF THEN CALL ADDPARAM(%MGACSHELF);

  10539 10 005117   001434 236000 0                  LDQ     CODE14
        10 005120   000002 316003                    CANQ    2,DU
        10 005121   005143 600000 10                 TZE     s:10546

  10539 10 005122   000115 236000 11                 LDQ     77
        10 005123   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005124   014226 701000 10                 TSX1    ADDPARAM
        10 005125   000000 011000                    NOP     0

     1284    10540    3            END;

  10540 10 005126   005143 710000 10                 TRA     s:10546
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:270  

     1285    10541    3         ELSE DO;

     1286    10542    3            LBUF.ACCT=F$DCB.ACCT;

  10542 10 005127   000000 470400 xsym               LDP0    M$DP$
        10 005130   040000 100500                    MLR     fill='040'O
        10 005131   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
        10 005132   006702 000011 0                  ADSC9   LBUFC                    cn=0,n=9

     1287    10543    3            J=CODE14.CGRANS;

  10543 10 005133   001436 235000 0                  LDA     CODE14+2
        10 005134   001104 755000 0                  STA     J

     1288    10544    3            IF CODE14.CGRANS>99999 THEN CALL ADDPARNUM(%CGRM);

  10544 10 005135   303237 115007                    CMPA    99999,DL
        10 005136   005143 604400 10                 TMOZ    s:10546

  10544 10 005137   000117 236000 11                 LDQ     79
        10 005140   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005141   014155 701000 10                 TSX1    ADDPARNUM
        10 005142   000000 011000                    NOP     0

     1289    10545    3            END;

     1290    10546    2         J=CODE14.MGRANS;

  10546 10 005143   001435 236000 0                  LDQ     CODE14+1
        10 005144   000032 376000 xsym               ANQ     B_VECTNIL+26
        10 005145   001104 756000 0                  STQ     J

     1291    10547    2         IF J>99999 THEN CALL ADDPARNUM(%MGRM);

  10547 10 005146   303240 116007                    CMPQ    100000,DL
        10 005147   005154 602000 10                 TNC     s:10548
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:271  

  10547 10 005150   000121 236000 11                 LDQ     81
        10 005151   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005152   014155 701000 10                 TSX1    ADDPARNUM
        10 005153   000000 011000                    NOP     0

     1292    10548    2         IF NOT CODE14.ACCESS.OWNERF THEN CALL ADDPARAM(%PROTM);

  10548 10 005154   001434 236000 0                  LDQ     CODE14
        10 005155   004000 316003                    CANQ    2048,DU
        10 005156   005163 601000 10                 TNZ     s:10549

  10548 10 005157   000002 236000 11                 LDQ     2
        10 005160   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005161   014226 701000 10                 TSX1    ADDPARAM
        10 005162   000000 011000                    NOP     0

     1293    10549    2         IF NOT CODE14.ACCESS.BUPF THEN CALL ADDPARAM(%NBUPM);

  10549 10 005163   001434 236000 0                  LDQ     CODE14
        10 005164   040000 316003                    CANQ    16384,DU
        10 005165   005173 601000 10                 TNZ     s:10550

  10549 10 005166   000007 236000 11                 LDQ     7
        10 005167   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005170   014226 701000 10                 TSX1    ADDPARAM
        10 005171   000000 011000                    NOP     0
        10 005172   005201 710000 10                 TRA     s:10551

     1294    10550    2         ELSE IF CODE14.ACCESS.BUPM THEN CALL ADDPARAM(%DBUPM);

  10550 10 005173   020000 316003                    CANQ    8192,DU
        10 005174   005201 600000 10                 TZE     s:10551

  10550 10 005175   000122 236000 11                 LDQ     82
        10 005176   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005177   014226 701000 10                 TSX1    ADDPARAM
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:272  
        10 005200   000000 011000                    NOP     0

     1295    10551    2         IF CODE14.ACCESS.NOACUP THEN CALL ADDPARAM(%NOACM);

  10551 10 005201   001434 236000 0                  LDQ     CODE14
        10 005202   002000 316003                    CANQ    1024,DU
        10 005203   005210 600000 10                 TZE     s:10552

  10551 10 005204   000112 236000 11                 LDQ     74
        10 005205   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005206   014226 701000 10                 TSX1    ADDPARAM
        10 005207   000000 011000                    NOP     0

     1296    10552    2         IF CODE14.ACCESS.NPUR THEN CALL ADDPARAM(%NPURM);

  10552 10 005210   001434 236000 0                  LDQ     CODE14
        10 005211   010000 316003                    CANQ    4096,DU
        10 005212   005217 600000 10                 TZE     s:10553

  10552 10 005213   000035 236000 11                 LDQ     29
        10 005214   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005215   014226 701000 10                 TSX1    ADDPARAM
        10 005216   000000 011000                    NOP     0

     1297    10553    2         IF CODE14.ACCESS.NOSTOW THEN CALL ADDPARAM(%NSTOW);

  10553 10 005217   001434 430000 0                  FSZN    CODE14
        10 005220   005225 605000 10                 TPL     s:10554

  10553 10 005221   000124 236000 11                 LDQ     84
        10 005222   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005223   014226 701000 10                 TSX1    ADDPARAM
        10 005224   000000 011000                    NOP     0

     1298    10554    2         IF CODE14.ACCESS.WRCMP THEN CALL ADDPARAM(%MWRCMP);

  10554 10 005225   001434 236000 0                  LDQ     CODE14
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:273  
        10 005226   100000 316003                    CANQ    32768,DU
        10 005227   005234 600000 10                 TZE     s:10555

  10554 10 005230   000043 236000 11                 LDQ     35
        10 005231   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005232   014226 701000 10                 TSX1    ADDPARAM
        10 005233   000000 011000                    NOP     0

     1299    10555    2         IF CODE14.ACCESS.WCDATA THEN CALL ADDPARAM(%MWCDATA);

  10555 10 005234   001434 234000 0                  SZN     CODE14
        10 005235   005242 605000 10                 TPL     s:10556

  10555 10 005236   000037 236000 11                 LDQ     31
        10 005237   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005240   014226 701000 10                 TSX1    ADDPARAM
        10 005241   000000 011000                    NOP     0

     1300    10556    2         IF CODE14.ACCESS.MERGEAC THEN CALL ADDPARAM(%MMERGE);

  10556 10 005242   001434 236000 0                  LDQ     CODE14
        10 005243   000400 316003                    CANQ    256,DU
        10 005244   005251 600000 10                 TZE     s:10557

  10556 10 005245   000016 236000 11                 LDQ     14
        10 005246   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005247   014226 701000 10                 TSX1    ADDPARAM
        10 005250   000000 011000                    NOP     0

     1301    10557    2         J=CODE14.CGMEM*%CGMEMSIZ;

  10557 10 005251   001435 236000 0                  LDQ     CODE14+1
        10 005252   000030 772000                    QRL     24
        10 005253   007770 376007                    ANQ     4088,DL
        10 005254   001104 756000 0                  STQ     J

     1302    10558    2         IF J~=0 THEN CALL ADDPARNUM(%CGMM);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:274  

  10558 10 005255   005262 600000 10                 TZE     s:10559

  10558 10 005256   000125 236000 11                 LDQ     85
        10 005257   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005260   014155 701000 10                 TSX1    ADDPARNUM
        10 005261   000000 011000                    NOP     0

     1303    10559    2         TIMEUTS=FIT09.NDW*4/10-1;

  10559 10 005262   001420 236000 0                  LDQ     FIT09
        10 005263   000010 772000                    QRL     8
        10 005264   007774 376007                    ANQ     4092,DL
        10 005265   000012 506007                    DIV     10,DL
        10 005266   000001 136007                    SBLQ    1,DL
        10 005267   001075 756000 0                  STQ     TIMEUTS

     1304    10560    3         IF CODE14.ACCESS.LIST THEN DO X9=0 TO TIMEUTS;

  10560 10 005270   001434 236000 0                  LDQ     CODE14
        10 005271   200000 316003                    CANQ    65536,DU
        10 005272   005424 600000 10                 TZE     s:10580

  10560 10 005273   200006 450100                    STZ     X9,,AUTO
        10 005274   005421 710000 10                 TRA     s:10579+3

     1305    10561    3            FLAG=CODE09.FFLG(X9);

  10561 10 005275   200006 236100                    LDQ     X9,,AUTO
        10 005276   000012 402007                    MPY     10,DL
        10 005277   000000 100406                    MLR     fill='000'O
        10 005300   001634 000002 0                  ADSC9   CODE09,Q                 cn=0,n=2
        10 005301   001107 000004 0                  ADSC9   FLAG                     cn=0,n=4

     1306    10562    3            CALL ACCTLTXT;

  10562 10 005302   012774 701000 10                 TSX1    ACCTLTXT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:275  
        10 005303   000000 011000                    NOP     0

     1307    10563    4            IF X9<TIMEUTS AND CODE09.FFLG(X9)=CODE09.FFLG(X9+1) THEN DO;

  10563 10 005304   200006 236100                    LDQ     X9,,AUTO
        10 005305   001075 116000 0                  CMPQ    TIMEUTS
        10 005306   005373 603000 10                 TRC     s:10576
        10 005307   000012 402007                    MPY     10,DL
        10 005310   000006 106406                    CMPC    fill='000'O
        10 005311   001634 000002 0                  ADSC9   CODE09,Q                 cn=0,n=2
        10 005312   001636 400002 0                  ADSC9   CODE09+2,Q               cn=2,n=2
        10 005313   005373 601000 10                 TNZ     s:10576

     1308    10564    4               CALL INSERT(TCXT,NUMSNS,30,'=(',CODE09.ACCT(X9));

  10564 10 005314   001112 235000 0                  LDA     NUMSNS
        10 005315   040005 100400                    MLR     fill='040'O
        10 005316   000562 000002 2                  ADSC9   FFLGS+75                 cn=0,n=2
        10 005317   000706 000002 0                  ADSC9   TEXT,A                   cn=0,n=2
        10 005320   040005 100406                    MLR     fill='040'O
        10 005321   001634 400010 0                  ADSC9   CODE09,Q                 cn=2,n=8
        10 005322   000706 400034 0                  ADSC9   TEXT,A                   cn=2,n=28

     1309    10565    5               DO WHILE(X9<TIMEUTS

  10565 10 005323   005342 710000 10                 TRA     s:10570

     1310    10566    5                 AND CODE09.FFLG(X9)=CODE09.FFLG(X9+1));
     1311    10567    5                  X9=X9+1;

  10567 10 005324   200006 235100                    LDA     X9,,AUTO
        10 005325   000001 035007                    ADLA    1,DL
        10 005326   200006 755100                    STA     X9,,AUTO

     1312    10568    5                  CALL ADDPART(30,TCXT);

  10568 10 005327   000017 236000 11                 LDQ     15
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:276  
        10 005330   201336 756100                    STQ     K+1,,AUTO
        10 005331   000057 236000 11                 LDQ     47
        10 005332   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005333   014145 701000 10                 TSX1    ADDPART
        10 005334   000000 011000                    NOP     0

     1313    10569    5                  CALL INSERT(TCXT,2,30,CODE09.ACCT(X9));

  10569 10 005335   200006 236100                    LDQ     X9,,AUTO
        10 005336   000012 402007                    MPY     10,DL
        10 005337   040000 100406                    MLR     fill='040'O
        10 005340   001634 400010 0                  ADSC9   CODE09,Q                 cn=2,n=8
        10 005341   000706 400036 0                  ADSC9   TEXT                     cn=2,n=30

     1314    10570    5                  END;

  10570 10 005342   200006 236100                    LDQ     X9,,AUTO
        10 005343   001075 116000 0                  CMPQ    TIMEUTS
        10 005344   005352 603000 10                 TRC     s:10571
        10 005345   000012 402007                    MPY     10,DL
        10 005346   000006 106406                    CMPC    fill='000'O
        10 005347   001634 000002 0                  ADSC9   CODE09,Q                 cn=0,n=2
        10 005350   001636 400002 0                  ADSC9   CODE09+2,Q               cn=2,n=2
        10 005351   005324 600000 10                 TZE     s:10567

     1315    10571    4               CALL INDEX1(NUMSNS,' ',TCXT,2);

  10571 10 005352   000000 124400                    SCM     mask='000'O
        10 005353   000706 400376 0                  ADSC9   TEXT                     cn=2,n=254
        10 005354   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 005355   001112 000000 0                  ARG     NUMSNS
        10 005356   001112 235000 0                  LDA     NUMSNS
        10 005357   000002 035007                    ADLA    2,DL
        10 005360   001112 755000 0                  STA     NUMSNS

     1316    10572    4               CALL INSERT(TCXT,NUMSNS,1,')');

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:277  
  10572 10 005361   040005 100400                    MLR     fill='040'O
        10 005362   000041 000001 11                 ADSC9   33                       cn=0,n=1
        10 005363   000706 000001 0                  ADSC9   TEXT,A                   cn=0,n=1

     1317    10573    4               CALL ADDPART(30,TCXT);

  10573 10 005364   000017 236000 11                 LDQ     15
        10 005365   201336 756100                    STQ     K+1,,AUTO
        10 005366   000057 236000 11                 LDQ     47
        10 005367   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005370   014145 701000 10                 TSX1    ADDPART
        10 005371   000000 011000                    NOP     0

     1318    10574    4               END;

  10574 10 005372   005416 710000 10                 TRA     s:10579

     1319    10575    4            ELSE DO;

     1320    10576    4               CALL INSERT(TCXT,NUMSNS,9,'=',CODE09.ACCT(X9));

  10576 10 005373   001112 235000 0                  LDA     NUMSNS
        10 005374   040005 100400                    MLR     fill='040'O
        10 005375   000126 000001 11                 ADSC9   86                       cn=0,n=1
        10 005376   000706 000001 0                  ADSC9   TEXT,A                   cn=0,n=1
        10 005377   200006 236100                    LDQ     X9,,AUTO
        10 005400   000012 402007                    MPY     10,DL
        10 005401   001112 235000 0                  LDA     NUMSNS
        10 005402   040005 100406                    MLR     fill='040'O
        10 005403   001634 400010 0                  ADSC9   CODE09,Q                 cn=2,n=8
        10 005404   000706 200010 0                  ADSC9   TEXT,A                   cn=1,n=8

     1321    10577    4               CALL ADDPART(NUMSNS+9,TCXT);

  10577 10 005405   001112 235000 0                  LDA     NUMSNS
        10 005406   000011 035007                    ADLA    9,DL
        10 005407   201362 755100                    STA     BXP+13,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:278  
        10 005410   000017 236000 11                 LDQ     15
        10 005411   201336 756100                    STQ     K+1,,AUTO
        10 005412   201362 630500                    EPPR0   BXP+13,,AUTO
        10 005413   201335 450500                    STP0    DEFAULT_BUILD+725,,AUTO
        10 005414   014145 701000 10                 TSX1    ADDPART
        10 005415   000000 011000                    NOP     0

     1322    10578    4               END;

     1323    10579    3            END;

  10579 10 005416   200006 235100                    LDA     X9,,AUTO
        10 005417   000001 035007                    ADLA    1,DL
        10 005420   200006 755100                    STA     X9,,AUTO
        10 005421   001075 236000 0                  LDQ     TIMEUTS
        10 005422   200006 116100                    CMPQ    X9,,AUTO
        10 005423   005275 603000 10                 TRC     s:10561

     1324    10580    2         TIMEUTS=FIT14.NDW/SIZEW(CODE14.OWNER(0));

  10580 10 005424   001417 236000 0                  LDQ     FIT14
        10 005425   000012 772000                    QRL     10
        10 005426   001777 376007                    ANQ     1023,DL
        10 005427   000005 506007                    DIV     5,DL
        10 005430   001075 756000 0                  STQ     TIMEUTS

     1325    10581    3         IF TIMEUTS~=0 AND CODE14.OWNER.ACCT(0)~=' ' THEN DO;

  10581 10 005431   000000 116003                    CMPQ    0,DU
        10 005432   005525 600000 10                 TZE     s:10595
        10 005433   040000 106400                    CMPC    fill='040'O
        10 005434   001437 000010 0                  ADSC9   CODE14+3                 cn=0,n=8
        10 005435   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 005436   005525 600000 10                 TZE     s:10595

     1326    10582    3            CALL INSERT(TCXT,0,30,', Owner=(',CODE14.OWNER.ACCT(0));

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:279  
  10582 10 005437   040000 100400                    MLR     fill='040'O
        10 005440   000563 000011 2                  ADSC9   FFLGS+76                 cn=0,n=9
        10 005441   000706 000011 0                  ADSC9   TEXT                     cn=0,n=9
        10 005442   040000 100400                    MLR     fill='040'O
        10 005443   001437 000010 0                  ADSC9   CODE14+3                 cn=0,n=8
        10 005444   000710 200025 0                  ADSC9   TEXT+2                   cn=1,n=21

     1327    10583    3            X9=0;

  10583 10 005445   200006 450100                    STZ     X9,,AUTO

     1328    10584    3            GOTO LISTO1;

  10584 10 005446   005464 710000 10                 TRA     LISTO1

     1329    10585    3   LISTO0:  CALL ADDPART(30,TCXT);

  10585 10 005447   000017 236000 11    LISTO0       LDQ     15
        10 005450   201336 756100                    STQ     K+1,,AUTO
        10 005451   000057 236000 11                 LDQ     47
        10 005452   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005453   014145 701000 10                 TSX1    ADDPART
        10 005454   000000 011000                    NOP     0

     1330    10586    3            CALL INSERT(TCXT,0,30,', ',CODE14.OWNER.ACCT(X9));

  10586 10 005455   000563 220000 2                  LDX0    FFLGS+76
        10 005456   000706 740000 0                  STX0    TEXT
        10 005457   200006 236100                    LDQ     X9,,AUTO
        10 005460   000024 402007                    MPY     20,DL
        10 005461   040000 100406                    MLR     fill='040'O
        10 005462   001437 000010 0                  ADSC9   CODE14+3,Q               cn=0,n=8
        10 005463   000706 400034 0                  ADSC9   TEXT                     cn=2,n=28

     1331    10587    3   LISTO1:  CALL ADDPART(30,TCXT);

  10587 10 005464   000017 236000 11    LISTO1       LDQ     15
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:280  
        10 005465   201336 756100                    STQ     K+1,,AUTO
        10 005466   000057 236000 11                 LDQ     47
        10 005467   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005470   014145 701000 10                 TSX1    ADDPART
        10 005471   000000 011000                    NOP     0

     1332    10588    3            CALL INSERT(TCXT,0,30,'/',CODE14.OWNER.NAME(X9));

  10588 10 005472   057000 236003                    LDQ     24064,DU
        10 005473   000706 552040 0                  STBQ    TEXT,'40'O
        10 005474   200006 236100                    LDQ     X9,,AUTO
        10 005475   000024 402007                    MPY     20,DL
        10 005476   040000 100406                    MLR     fill='040'O
        10 005477   001441 000014 0                  ADSC9   CODE14+5,Q               cn=0,n=12
        10 005500   000706 200035 0                  ADSC9   TEXT                     cn=1,n=29

     1333    10589    3            X9=X9+1;

  10589 10 005501   200006 235100                    LDA     X9,,AUTO
        10 005502   000001 035007                    ADLA    1,DL
        10 005503   200006 755100                    STA     X9,,AUTO

     1334    10590    3            IF X9<TIMEUTS THEN GOTO LISTO0;

  10590 10 005504   200006 236100                    LDQ     X9,,AUTO
        10 005505   001075 116000 0                  CMPQ    TIMEUTS
        10 005506   005447 602000 10                 TNC     LISTO0

     1335    10591    3            CALL INDEX1(X9,' ',TCXT);

  10591 10 005507   000000 124400                    SCM     mask='000'O
        10 005510   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256
        10 005511   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 005512   200006 000100                    ARG     X9,,AUTO

     1336    10592    3            CALL INSERT(TCXT,X9,1,')');

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:281  
  10592 10 005513   200006 235100                    LDA     X9,,AUTO
        10 005514   040005 100400                    MLR     fill='040'O
        10 005515   000041 000001 11                 ADSC9   33                       cn=0,n=1
        10 005516   000706 000001 0                  ADSC9   TEXT,A                   cn=0,n=1

     1337    10593    3            CALL ADDPART(30,TCXT);

  10593 10 005517   000017 236000 11                 LDQ     15
        10 005520   201336 756100                    STQ     K+1,,AUTO
        10 005521   000057 236000 11                 LDQ     47
        10 005522   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 005523   014145 701000 10                 TSX1    ADDPART
        10 005524   000000 011000                    NOP     0

     1338    10594    3            END;

     1339    10595    2         CALL ERROR(10);

  10595 10 005525   000016 236000 11                 LDQ     14
        10 005526   201341 756100                    STQ     P$+2,,AUTO
        10 005527   011704 701000 10                 TSX1    ERROR
        10 005530   000000 011000                    NOP     0

     1340    10596    3         IF LIST_ATTR THEN DO X9=0 TO 4;

  10596 10 005531   001105 234000 0                  SZN     LIST_ATTR
        10 005532   005620 605000 10                 TPL     s:10610

  10596 10 005533   200006 450100                    STZ     X9,,AUTO

     1341    10597    3            LBUFC=' ';

  10597 10 005534   040000 100400                    MLR     fill='040'O
        10 005535   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 005536   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

     1342    10598    3            TIMETEXT.TYP=TIMES(X9);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:282  

  10598 10 005537   200006 235100                    LDA     X9,,AUTO
        10 005540   000004 735000                    ALS     4
        10 005541   040000 100405                    MLR     fill='040'O
        10 005542   000106 000014 2                  ADSC9   TIMES,A                  cn=0,n=12
        10 005543   006704 400014 0                  ADSC9   LBUFC+2                  cn=2,n=12

     1343    10599    3            TIMEUTS=TIME$(X9)->BASED_UBIN;

  10599 10 005544   200006 720100                    LXL0    X9,,AUTO
        10 005545   000132 470410 2                  LDP0    TIME$,X0
        10 005546   000000 235100                    LDA     0,,PR0
        10 005547   001075 755000 0                  STA     TIMEUTS

     1344    10600    3            CALL M$TIME(TIME_TEXT);

  10600 10 005550   000072 630400 2                  EPPR0   TIME_TEXT
        10 005551   020004 713400                    CLIMB   8196
        10 005552   402000 401760                    pmme    nvectors=5

     1345    10601    4            IF TIMEUTS~=0 THEN DO;

  10601 10 005553   001075 235000 0                  LDA     TIMEUTS
        10 005554   005613 600000 10                 TZE     s:10609

     1346    10602    5               IF X9=4 AND CODE04.CREATOR.ACCT>' ' THEN DO;

  10602 10 005555   200006 236100                    LDQ     X9,,AUTO
        10 005556   000004 116007                    CMPQ    4,DL
        10 005557   005607 601000 10                 TNZ     s:10607
        10 005560   000035 235000 xsym               LDA     B_VECTNIL+29
        10 005561   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 005562   001424 117000 0                  CMPAQ   CODE04+3
        10 005563   005607 603000 10                 TRC     s:10607

     1347    10603    5                  CALL INSERT(TIMETEXT.B,0,30,' by ',CODE04.CREATOR.ACCT);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:283  
  10603 10 005564   000566 236000 2                  LDQ     FFLGS+79
        10 005565   006715 756000 0                  STQ     LBUFC+11
        10 005566   040000 100400                    MLR     fill='040'O
        10 005567   001424 000010 0                  ADSC9   CODE04+3                 cn=0,n=8
        10 005570   006716 000032 0                  ADSC9   LBUFC+12                 cn=0,n=26

     1348    10604    5                  CALL INDEX1(I,' ',TIMETEXT.B,4);

  10604 10 005571   000000 124400                    SCM     mask='000'O
        10 005572   006716 000110 0                  ADSC9   LBUFC+12                 cn=0,n=72
        10 005573   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 005574   001076 000000 0                  ARG     I
        10 005575   001076 235000 0                  LDA     I
        10 005576   000004 035007                    ADLA    4,DL
        10 005577   001076 755000 0                  STA     I

     1349    10605    5                  CALL INSERT(TIMETEXT.B,I,13,'/',CODE04.CREATOR.NAME);

  10605 10 005600   040005 100400                    MLR     fill='040'O
        10 005601   000127 000001 11                 ADSC9   87                       cn=0,n=1
        10 005602   006715 000001 0                  ADSC9   LBUFC+11,A               cn=0,n=1
        10 005603   001076 235000 0                  LDA     I
        10 005604   040005 100400                    MLR     fill='040'O
        10 005605   001426 000014 0                  ADSC9   CODE04+5                 cn=0,n=12
        10 005606   006715 200014 0                  ADSC9   LBUFC+11,A               cn=1,n=12

     1350    10606    5                  END;

     1351    10607    4               CALL ERROR(10);

  10607 10 005607   000016 236000 11                 LDQ     14
        10 005610   201341 756100                    STQ     P$+2,,AUTO
        10 005611   011704 701000 10                 TSX1    ERROR
        10 005612   000000 011000                    NOP     0

     1352    10608    4               END;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:284  
     1353    10609    3            END;

  10609 10 005613   200006 235100                    LDA     X9,,AUTO
        10 005614   000001 035007                    ADLA    1,DL
        10 005615   200006 755100                    STA     X9,,AUTO
        10 005616   000005 115007                    CMPA    5,DL
        10 005617   005534 602000 10                 TNC     s:10597

     1354    10610    2         IF CODE=%E$DEFAULT OR MODE=0 THEN GOTO NEXT;

  10610 10 005620   200007 235100                    LDA     CODE,,AUTO
        10 005621   000157 115007                    CMPA    111,DL
        10 005622   000204 600000 10                 TZE     NEXT
        10 005623   001121 236000 0                  LDQ     MODE
        10 005624   000204 600000 10                 TZE     NEXT

     1355    10611    2         IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE=0 THEN GOTO MADLIST;

  10611 10 005625   001073 470400 0                  LDP0    BLK$
        10 005626   000004 471500                    LDP1    4,,PR0
        10 005627   100000 720100                    LXL0    0,,PR1
        10 005630   010016 600000 10                 TZE     MADLIST

     1356    10612    2         IF CODE~=%E$LIST+1 THEN GOTO ACCTNXT;

  10612 10 005631   000163 115007                    CMPA    115,DL
        10 005632   004426 601000 10                 TNZ     ACCTNXT

     1357    10613    2         CALL NXTACCT ALTRET(LISTGP);

  10613 10 005633   012443 701000 10                 TSX1    NXTACCT
        10 005634   005637 702000 10                 TSX2    LISTGP

     1358    10614    2         IF BREAK=0 THEN GOTO LISTNXT;

  10614 10 005635   001125 235000 0                  LDA     BREAK
        10 005636   004723 600000 10                 TZE     LISTNXT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:285  

  10614 10 005637                       LISTGP       null
     1359    10615    2   LISTGP:;
     1360    10616    2         IF OUT$BLK.NSUBLKS>2 OR PROJAD.L~=0 THEN GOTO NEXT;

  10616 10 005637   001073 470400 0                  LDP0    BLK$
        10 005640   000001 220100                    LDX0    1,,PR0
        10 005641   000003 100003                    CMPX0   3,DU
        10 005642   000204 603000 10                 TRC     NEXT
        10 005643   001127 236000 0                  LDQ     PROJAD
        10 005644   777000 316003                    CANQ    -512,DU
        10 005645   000204 601000 10                 TNZ     NEXT

     1361    10617    2         BREAK=0;

  10617 10 005646   001125 450000 0                  STZ     BREAK

     1362    10618    2         OPNDP.FPARAM_=VECTOR(NIL);

  10618 10 005647   000024 237000 11                 LDAQ    20
        10 005650   000130 757000 0                  STAQ    OPNDP+24

     1363    10619    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);

  10619 10 005651   000640 630400 0                  EPPR0   DIAGFPT
        10 005652   420012 713400                    CLIMB   alt,+8202
        10 005653   400000 401760                    pmme    nvectors=1
        10 005654   014123 702000 10                 TSX2    NOALT

     1364    10620    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10620 10 005655   000100 630400 0                  EPPR0   OPNDP
        10 005656   450000 713400                    CLIMB   alt,open
        10 005657   410400 401760                    pmme    nvectors=18
        10 005660   013551 702000 10                 TSX2    DPERR

     1365    10621    2         CALL FXH$GPSUM;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:286  

  10621 10 005661   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 005662   000000 701000 xent               TSX1    FXH$GPSUM
        10 005663   000000 011000                    NOP     0

     1366    10622    2         CALL M$CLOSE(CLSDP)ALTRET(NEXT);

  10622 10 005664   000172 630400 0                  EPPR0   CLSDP
        10 005665   450001 713400                    CLIMB   alt,close
        10 005666   406000 401760                    pmme    nvectors=13
        10 005667   000204 702000 10                 TSX2    NEXT
        10 005670   011257 710000 10                 TRA     s:11238

     1367    10623        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:287  
     1368    10624    2      CASE(%(E$DELETE-E$PIGH));

     1369    10625                    /*E*     ERROR: FXP-E$DELETE-0
     1370    10626                   *       MESSAGE:DELETE DP#set.acct - deletes one account (? not honored)
     1371    10627                    */
     1372    10628    2         IF OPNSN.SN#(0)=' ' THEN GOTO MADLIST;

  10628 10 005671   040000 106400                    CMPC    fill='040'O
        10 005672   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 005673   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 005674   010016 600000 10                 TZE     MADLIST

     1373    10629    2         VLP_ACCT.ACCT#=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;

  10629 10 005675   001073 470400 0                  LDP0    BLK$
        10 005676   000005 471500                    LDP1    5,,PR0
        10 005677   100004 236100                    LDQ     4,,PR1
        10 005700   000033 772000                    QRL     27
        10 005701   000000 620006                    EAX0    0,QL
        10 005702   040000 100540                    MLR     fill='040'O
        10 005703   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        10 005704   000076 000010 0                  ADSC9   VLP_ACCT                 cn=0,n=8

     1374    10630    2         CALL M$OPEN(OPNDP)ALTRET(DEL1);

  10630 10 005705   000100 630400 0                  EPPR0   OPNDP
        10 005706   450000 713400                    CLIMB   alt,open
        10 005707   410400 401760                    pmme    nvectors=18
        10 005710   005713 702000 10                 TSX2    DEL1

     1375    10631    2         CALL MOVEFIT;

  10631 10 005711   013064 701000 10                 TSX1    MOVEFIT
        10 005712   000000 011000                    NOP     0

  10629 10 005713                       DEL1         null
     1376    10632    2   DEL1: ;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:288  
     1377    10633    2         IF PROJAD.L~=0 THEN CALL FXU$PROJDA(VLP_ACCT)ALTRET(DPERR1);

  10633 10 005713   001127 236000 0                  LDQ     PROJAD
        10 005714   777000 316003                    CANQ    -512,DU
        10 005715   005722 600000 10                 TZE     s:10634

  10633 10 005716   000130 630400 11                 EPPR0   88
        10 005717   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 005720   000000 701000 xent               TSX1    FXU$PROJDA
        10 005721   013567 702000 10                 TSX2    DPERR1

     1378    10634    2         IF CODE14.CGRANS~=0 THEN CALL FXU$PROTCHK(CODE14.CGRANS)ALTRET(CMDABORT);

  10634 10 005722   001436 235000 0                  LDA     CODE14+2
        10 005723   005730 600000 10                 TZE     s:10635

  10634 10 005724   000131 630400 11                 EPPR0   89
        10 005725   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 005726   000000 701000 xent               TSX1    FXU$PROTCHK
        10 005727   014002 702000 10                 TSX2    CMDABORT

     1379    10635    2         OPNDP.V.DELETE#='1'B;

  10635 10 005730   040000 236007                    LDQ     16384,DL
        10 005731   000144 256000 0                  ORSQ    OPNDP+36

     1380    10636    2         FLAG='0'B;

  10636 10 005732   001107 450000 0                  STZ     FLAG

     1381    10637    2         CALL M$OPEN(OPNDP)ALTRET(NOALT);

  10637 10 005733   000100 630400 0                  EPPR0   OPNDP
        10 005734   450000 713400                    CLIMB   alt,open
        10 005735   410400 401760                    pmme    nvectors=18
        10 005736   014123 702000 10                 TSX2    NOALT

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:289  
     1382    10638    2         OPNDP.V.DELETE#='0'B;

  10638 10 005737   000012 236000 11                 LDQ     10
        10 005740   000144 356000 0                  ANSQ    OPNDP+36

     1383    10639    2         IF NOT FLAG THEN CALL FXU$TRACKER(P_PCB);

  10639 10 005741   001107 235000 0                  LDA     FLAG
        10 005742   005747 601000 10                 TNZ     s:10640

  10639 10 005743   000011 630400 11                 EPPR0   9
        10 005744   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 005745   000000 701000 xent               TSX1    FXU$TRACKER
        10 005746   000000 011000                    NOP     0

     1384    10640    2         IF PROJAD.L~=0 AND (FLAG.CODE=0

  10640 10 005747   001127 236000 0                  LDQ     PROJAD
        10 005750   777000 316003                    CANQ    -512,DU
        10 005751   005764 600000 10                 TZE     s:10642
        10 005752   001107 236000 0                  LDQ     FLAG
        10 005753   377770 316007                    CANQ    131064,DL
        10 005754   005761 600000 10                 TZE     s:10641
        10 005755   001107 236000 0                  LDQ     FLAG
        10 005756   377770 376007                    ANQ     131064,DL
        10 005757   001020 116007                    CMPQ    528,DL
        10 005760   005764 601000 10                 TNZ     s:10642

     1385    10641    2           OR FLAG.CODE=%E$NOKEY) THEN CALL FXU$PROJWR;

  10641 10 005761   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 005762   000000 701000 xent               TSX1    FXU$PROJWR
        10 005763   000000 011000                    NOP     0

     1386    10642    2         IF FLAG THEN GOTO DPERR;

  10642 10 005764   001107 235000 0                  LDA     FLAG
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:290  
        10 005765   013551 601000 10                 TNZ     DPERR
        10 005766   011257 710000 10                 TRA     s:11238

     1387    10643        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:291  
     1388    10644    2      CASE(%(E$ATTR-E$PIGH));

     1389    10645                    /*E*     ERROR: FXP-E$ATTR-0
     1390    10646                    *        MESSAGE:eATtr [={ON|OFF|YES|NO}] - controls listing of dates
     1391    10647                    */
     1392    10648    2         IF OUT$BLK.NSUBLKS=0 THEN LIST_ATTR='1'B;

  10648 10 005767   001073 470400 0                  LDP0    BLK$
        10 005770   000001 220100                    LDX0    1,,PR0
        10 005771   005775 601000 10                 TNZ     s:10649

  10648 10 005772   400000 236003                    LDQ     -131072,DU
        10 005773   001105 756000 0                  STQ     LIST_ATTR
        10 005774   011257 710000 10                 TRA     s:11238

     1393    10649    2         ELSE IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE<3 THEN LIST_ATTR='0'B;

  10649 10 005775   000004 471500                    LDP1    4,,PR0
        10 005776   100000 721100                    LXL1    0,,PR1
        10 005777   000003 101003                    CMPX1   3,DU
        10 006000   006003 603000 10                 TRC     s:10650

  10649 10 006001   001105 450000 0                  STZ     LIST_ATTR
        10 006002   011257 710000 10                 TRA     s:11238

     1394    10650    2         ELSE LIST_ATTR='1'B;

  10650 10 006003   400000 236003                    LDQ     -131072,DU
        10 006004   001105 756000 0                  STQ     LIST_ATTR
        10 006005   011257 710000 10                 TRA     s:11238

     1395    10651        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:292  
     1396    10652    2      CASE(%(E$BUILD-E$PIGH));

     1397    10653                    /*E*     ERROR: FXP-E$BUILD-0
     1398    10654                    *        MESSAGE:Build DP#set From vsn,...,vsn options
     1399    10655                    *        Type Help OPtions for options and add:
     1400    10656                    *        [NO] Newfds - controls automatic creation of new accounts
     1401    10657                    *       [NO] SHelftime - specifies shelf time's separate accountability
     1402    10658                    */
     1403    10659    2         OPNSN.SN#(1)=OPNSN.SN#(0);

  10659 10 006006   040000 100400                    MLR     fill='040'O
        10 006007   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 006010   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6

     1404    10660    2         OPNDP.FPARAM_=VECTOR(NIL);

  10660 10 006011   000024 237000 11                 LDAQ    20
        10 006012   000130 757000 0                  STAQ    OPNDP+24

     1405    10661    3         DO WHILE (I<OUT$BLK.NSUBLKS);

  10661 10 006013   001073 470400 0                  LDP0    BLK$
        10 006014   000001 236100                    LDQ     1,,PR0
        10 006015   000022 772000                    QRL     18
        10 006016   001076 116000 0                  CMPQ    I
        10 006017   006074 602000 10                 TNC     s:10674
        10 006020   006074 600000 10                 TZE     s:10674

     1406    10662    4            IF OUT$BLK.SUBLK$(I)->OUT$BLK.NDTYPE=%DEC# THEN DO;

  10662 10 006021   001073 470400 0                  LDP0    BLK$
        10 006022   001076 720000 0                  LXL0    I
        10 006023   000003 471510                    LDP1    3,X0,PR0
        10 006024   100000 236100                    LDQ     0,,PR1
        10 006025   000077 376003                    ANQ     63,DU
        10 006026   000022 116003                    CMPQ    18,DU
        10 006027   006043 601000 10                 TNZ     s:10668
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:293  

     1407    10663    4               GOTO GETVSN; /* SUBROUTINE CALL */

  10663 10 006030   006411 710000 10                 TRA     GETVSN

  10662 10 006031                       GETVSNBRET   null
     1408    10664    4   GETVSNBRET: ;
     1409    10665    4               NUMSNS=NUMSNS+1;

  10665 10 006031   001112 235000 0                  LDA     NUMSNS
        10 006032   000001 035007                    ADLA    1,DL
        10 006033   001112 755000 0                  STA     NUMSNS

     1410    10666    4               CALL CLOSE(DCBNUM(M$DP));

  10666 10 006034   000000 236007 xsym               LDQ     M$DP,DL
        10 006035   201363 756100                    STQ     BXP+14,,AUTO
        10 006036   201363 630500                    EPPR0   BXP+14,,AUTO
        10 006037   201341 450500                    STP0    P$+2,,AUTO
        10 006040   012416 701000 10                 TSX1    CLOSE
        10 006041   000000 011000                    NOP     0

     1411    10667    4               END;

  10667 10 006042   006063 710000 10                 TRA     s:10672

     1412    10668    4            ELSE DO WHILE (I<OUT$BLK.NSUBLKS);

  10668 10 006043   000001 236100                    LDQ     1,,PR0
        10 006044   000022 772000                    QRL     18
        10 006045   001076 116000 0                  CMPQ    I
        10 006046   006063 602000 10                 TNC     s:10672
        10 006047   006063 600000 10                 TZE     s:10672

     1413    10669    4               CALL GET_OPTIONS ALTRET(TOOMANY);

  10669 10 006050   014573 701000 10                 TSX1    GET_OPTIONS
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:294  
        10 006051   014015 702000 10                 TSX2    TOOMANY

     1414    10670    4               I=I+1;

  10670 10 006052   001076 235000 0                  LDA     I
        10 006053   000001 035007                    ADLA    1,DL
        10 006054   001076 755000 0                  STA     I

     1415    10671    4               END;

  10671 10 006055   001073 470400 0                  LDP0    BLK$
        10 006056   000001 236100                    LDQ     1,,PR0
        10 006057   000022 772000                    QRL     18
        10 006060   001076 116000 0                  CMPQ    I
        10 006061   006063 600000 10                 TZE     s:10672
        10 006062   006050 603000 10                 TRC     s:10669

     1416    10672    3            I=I+1;

  10672 10 006063   001076 235000 0                  LDA     I
        10 006064   000001 035007                    ADLA    1,DL
        10 006065   001076 755000 0                  STA     I

     1417    10673    3            END;

  10673 10 006066   001073 470400 0                  LDP0    BLK$
        10 006067   000001 236100                    LDQ     1,,PR0
        10 006070   000022 772000                    QRL     18
        10 006071   001076 116000 0                  CMPQ    I
        10 006072   006074 600000 10                 TZE     s:10674
        10 006073   006021 603000 10                 TRC     s:10662

     1418    10674    2         OPNSN.SN#(0)=OPNSN.SN#(1);

  10674 10 006074   040000 100400                    MLR     fill='040'O
        10 006075   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6
        10 006076   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:295  

     1419    10675    3         IF B$JIT.PRIV.ACTIVE.SPCLMM AND NUMSNS=0 THEN DO;

  10675 10 006077   000000 471400 xsym               LDP1    B$JIT$
        10 006100   100013 236100                    LDQ     11,,PR1
        10 006101   000001 316007                    CANQ    1,DL
        10 006102   006150 600000 10                 TZE     s:10688
        10 006103   001112 235000 0                  LDA     NUMSNS
        10 006104   006150 601000 10                 TNZ     s:10688

     1420    10676    3            I=FM$CFUX.SETH;

  10676 10 006105   000000 473400 xsym               LDP3    F$CFU$
        10 006106   300005 236100                    LDQ     5,,PR3
        10 006107   000022 772000                    QRL     18
        10 006110   001076 756000 0                  STQ     I

     1421    10677    4            DO WHILE(I~=0);

  10677 10 006111   006150 600000 10                 TZE     s:10688

     1422    10678    4               IF FM$SET.PSN(I)=OPNSN.SN#(1)

  10678 10 006112   001076 235000 0                  LDA     I
        10 006113   000005 735000                    ALS     5
        10 006114   000000 470400 xsym               LDP0    F$CFU$
        10 006115   040000 106505                    CMPC    fill='040'O
        10 006116   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6
        10 006117   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6
        10 006120   006142 601000 10                 TNZ     s:10685
        10 006121   001076 236000 0                  LDQ     I
        10 006122   000003 736000                    QLS     3
        10 006123   000000 220106                    LDX0    0,QL,PR0
        10 006124   006142 600000 10                 TZE     s:10685
        10 006125   000002 236106                    LDQ     2,QL,PR0
        10 006126   200000 316003                    CANQ    65536,DU
        10 006127   006142 601000 10                 TNZ     s:10685
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:296  

     1423    10679    4                 AND FM$SET.DCTX(I)~=0
     1424    10680    4                 AND NOT FM$SET.SET(I)
     1425    10681    5               THEN DO;

     1426    10682    5                  J=FM$DEV.VSN(FM$SET.DCTX(I));

  10682 10 006130   001076 236000 0                  LDQ     I
        10 006131   000003 736000                    QLS     3
        10 006132   000000 236106                    LDQ     0,QL,PR0
        10 006133   000017 772000                    QRL     15
        10 006134   000004 376000 11                 ANQ     4
        10 006135   000001 235106                    LDA     1,QL,PR0
        10 006136   001104 755000 0                  STA     J

     1427    10683    5                  OPNSN.SN#(0)=ADDR(J)->CHAR4;

  10683 10 006137   040000 100400                    MLR     fill='040'O
        10 006140   001104 000004 0                  ADSC9   J                        cn=0,n=4
        10 006141   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1428    10684    5                  END;

     1429    10685    4               I=FM$SET.SETL(I);

  10685 10 006142   001076 235000 0                  LDA     I
        10 006143   000003 735000                    ALS     3
        10 006144   000005 236105                    LDQ     5,AL,PR0
        10 006145   000022 772000                    QRL     18
        10 006146   001076 756000 0                  STQ     I

     1430    10686    4               END;

  10686 10 006147   006112 601000 10                 TNZ     s:10678

     1431    10687    3            END;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:297  
     1432    10688    2         I=NUMSNS;

  10688 10 006150   001112 235000 0                  LDA     NUMSNS
        10 006151   001076 755000 0                  STA     I

     1433    10689    2         IF NUMSNS=0 THEN GOTO CROPEN;

  10689 10 006152   006163 600000 10                 TZE     CROPEN

     1434    10690    3         DO WHILE (I~=0);

  10690 10 006153   006410 600000 10                 TZE     s:10740

     1435    10691    3            I=I-1;

  10691 10 006154   001076 235000 0                  LDA     I
        10 006155   000001 135007                    SBLA    1,DL
        10 006156   001076 755000 0                  STA     I

     1436    10692    3            OPNSN.SN#(0)=ADDR(VID1.SNLIST.VSN(I))->CHAR4;

  10692 10 006157   000004 735000                    ALS     4
        10 006160   040000 100405                    MLR     fill='040'O
        10 006161   005321 000004 0                  ADSC9   CSTAT+320,A              cn=0,n=4
        10 006162   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

  10692 10 006163                       CROPEN       null
     1437    10693    3   CROPEN:  ;
     1438    10694    3            OPNDP.V.FUN#=%UPDATE#;

  10694 10 006163   001000 236007                    LDQ     512,DL
        10 006164   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1439    10695    3            CALL M$OPEN(OPNDP)ALTRET(VOLERR);

  10695 10 006165   000100 630400 0                  EPPR0   OPNDP
        10 006166   450000 713400                    CLIMB   alt,open
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:298  
        10 006167   410400 401760                    pmme    nvectors=18
        10 006170   013527 702000 10                 TSX2    VOLERR

     1440    10696    3            CALL M$READ(READVID)ALTRET(DPERR);

  10696 10 006171   000416 630400 0                  EPPR0   READVID
        10 006172   440000 713400                    CLIMB   alt,read
        10 006173   401400 401760                    pmme    nvectors=4
        10 006174   013551 702000 10                 TSX2    DPERR

     1441    10697    4            IF NUMSNS=0 THEN DO;

  10697 10 006175   001112 235000 0                  LDA     NUMSNS
        10 006176   006230 601000 10                 TNZ     s:10708

     1442    10698    4               IF NOT F$DCB.OWNER THEN GOTO NOTOWNER;

  10698 10 006177   000000 470400 xsym               LDP0    M$DP$
        10 006200   000064 236100                    LDQ     52,,PR0
        10 006201   040000 316007                    CANQ    16384,DL
        10 006202   014012 600000 10                 TZE     NOTOWNER

     1443    10699    4               CALL FXU$PROTCHK(VIDBUF)ALTRET(DPCLOSE);

  10699 10 006203   000074 630400 11                 EPPR0   60
        10 006204   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 006205   000000 701000 xent               TSX1    FXU$PROTCHK
        10 006206   013762 702000 10                 TSX2    DPCLOSE

     1444    10700    4               OPNSN.SN#(1)=VIDBUF.PSN;

  10700 10 006207   040000 100400                    MLR     fill='040'O
        10 006210   002624 000006 0                  ADSC9   VIDBUF+3                 cn=0,n=6
        10 006211   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6

     1445    10701    4               VID1.SNLIST=VIDBUF.SNLIST;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:299  
  10701 10 006212   000000 100400                    MLR     fill='000'O
        10 006213   003321 005400 0                  ADSC9   VIDBUF+320               cn=0,n=2816
        10 006214   005321 005400 0                  ADSC9   CSTAT+320                cn=0,n=2816

     1446    10702    4               NUMSNS=VIDBUF.VOLCNT;

  10702 10 006215   002625 236000 0                  LDQ     VIDBUF+4
        10 006216   777777 376007                    ANQ     -1,DL
        10 006217   001112 756000 0                  STQ     NUMSNS

     1447    10703    4               I=NUMSNS;

  10703 10 006220   001076 756000 0                  STQ     I

     1448    10704    4               CLSDP.V.DISP#=%SETDSMT#;

  10704 10 006221   000013 236007                    LDQ     11,DL
        10 006222   000224 552004 0                  STBQ    CLSDP+26,'04'O

     1449    10705    4               CALL M$CLOSE(CLSDP)ALTRET(DPERR);

  10705 10 006223   000172 630400 0                  EPPR0   CLSDP
        10 006224   450001 713400                    CLIMB   alt,close
        10 006225   406000 401760                    pmme    nvectors=13
        10 006226   013551 702000 10                 TSX2    DPERR

     1450    10706    4               END;

  10706 10 006227   006244 710000 10                 TRA     s:10713

     1451    10707    4            ELSE DO;

     1452    10708    4               VIDBUF.VOLCNT=NUMSNS;

  10708 10 006230   000000 620005                    EAX0    0,AL
        10 006231   002625 440000 0                  SXL0    VIDBUF+4

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:300  
     1453    10709    4               VIDBUF.SNLIST=VID1.SNLIST;

  10709 10 006232   000000 100400                    MLR     fill='000'O
        10 006233   005321 005400 0                  ADSC9   CSTAT+320                cn=0,n=2816
        10 006234   003321 005400 0                  ADSC9   VIDBUF+320               cn=0,n=2816

     1454    10710    4               VIDBUF.PSN=OPNSN.SN#(1);

  10710 10 006235   040000 100400                    MLR     fill='040'O
        10 006236   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6
        10 006237   002624 000006 0                  ADSC9   VIDBUF+3                 cn=0,n=6

     1455    10711    4               CALL M$WRITE(WRITEVID)ALTRET(DPERR);

  10711 10 006240   000416 630400 0                  EPPR0   READVID
        10 006241   440001 713400                    CLIMB   alt,write
        10 006242   401400 401760                    pmme    nvectors=4
        10 006243   013551 702000 10                 TSX2    DPERR

     1456    10712    4               END;

     1457    10713    4            IF I=0 THEN DO;

  10713 10 006244   001076 235000 0                  LDA     I
        10 006245   006400 601000 10                 TNZ     s:10738

     1458    10714    4               GRANULE=GRANULE+1;

  10714 10 006246   001113 054000 0                  AOS     GRANULE

     1459    10715    4               VIDBUF=GPBUF;

  10715 10 006247   010000 220003                    LDX0    4096,DU
        10 006250   000040 100400                    MLR     fill='000'O
        10 006251   001270 000024 0                  ADSC9   GPBUF                    cn=0,n=20
        10 006252   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:301  
     1460    10716    4               CALL M$WRITE(WRITEGP)ALTRET(DPERR);

  10716 10 006253   000416 630400 0                  EPPR0   READVID
        10 006254   440001 713400                    CLIMB   alt,write
        10 006255   401400 401760                    pmme    nvectors=4
        10 006256   013551 702000 10                 TSX2    DPERR

     1461    10717    4               FIT09.ITEMX=4+SIZEW(CODE04)+FIT14.NDW;

  10717 10 006257   001417 236000 0                  LDQ     FIT14
        10 006260   000012 772000                    QRL     10
        10 006261   001777 376007                    ANQ     1023,DL
        10 006262   000017 036007                    ADLQ    15,DL
        10 006263   001420 676000 0                  ERQ     FIT09
        10 006264   001777 376007                    ANQ     1023,DL
        10 006265   001420 656000 0                  ERSQ    FIT09

     1462    10718    4               PADBUF.FCEX=FIT09.ITEMX+FIT09.NDW+SIZEW(FM$GRAN);

  10718 10 006266   001420 236000 0                  LDQ     FIT09
        10 006267   000012 772000                    QRL     10
        10 006270   001777 376007                    ANQ     1023,DL
        10 006271   201346 756100                    STQ     BXP+1,,AUTO
        10 006272   001420 236000 0                  LDQ     FIT09
        10 006273   001777 376007                    ANQ     1023,DL
        10 006274   201346 036100                    ADLQ    BXP+1,,AUTO
        10 006275   000005 620006                    EAX0    5,QL
        10 006276   001412 740000 0                  STX0    PADBUF+2

     1463    10719    4               IF FIT09.NDW~=0 THEN CODE14.ACCESS.LIST='1'B;

  10719 10 006277   001420 236000 0                  LDQ     FIT09
        10 006300   000132 316000 11                 CANQ    90
        10 006301   006304 600000 10                 TZE     s:10720

  10719 10 006302   200000 236003                    LDQ     65536,DU
        10 006303   001434 256000 0                  ORSQ    CODE14
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:302  

     1464    10720    4               PADBUF.NAVX=PADBUF.FCEX+70;

  10720 10 006304   000106 621010                    EAX1    70,X0
        10 006305   001411 741000 0                  STX1    PADBUF+1

     1465    10721    4               PADBUF.AVAIL=1024-PADBUF.NAVX;

  10721 10 006306   001411 236000 0                  LDQ     PADBUF+1
        10 006307   000022 772000                    QRL     18
        10 006310   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 006311   002001 036007                    ADLQ    1025,DL
        10 006312   001411 676000 0                  ERQ     PADBUF+1
        10 006313   001777 376007                    ANQ     1023,DL
        10 006314   001411 656000 0                  ERSQ    PADBUF+1

     1466    10722    4               GRANULE=GRANULE+1;

  10722 10 006315   001113 054000 0                  AOS     GRANULE

     1467    10723    4               FITSIZE=PADBUF.FCEX*4;

  10723 10 006316   001412 235000 0                  LDA     PADBUF+2
        10 006317   777777 375003                    ANA     -1,DU
        10 006320   000020 771000                    ARL     16
        10 006321   002620 755000 0                  STA     FITSIZE

     1468    10724    4               CODE04.CREATOR.NAME=B$JIT.UNAME;

  10724 10 006322   000000 470400 xsym               LDP0    B$JIT$
        10 006323   040000 100500                    MLR     fill='040'O
        10 006324   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 006325   001426 000014 0                  ADSC9   CODE04+5                 cn=0,n=12

     1469    10725    4               CODE04.CREATOR.ACCT=B$JIT.ACCN;

  10725 10 006326   040000 100500                    MLR     fill='040'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:303  
        10 006327   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 006330   001424 000010 0                  ADSC9   CODE04+3                 cn=0,n=8

     1470    10726    4               CALL M$TIME(TIMEFPT);

  10726 10 006331   000056 630400 2                  EPPR0   TIMEFPT
        10 006332   020004 713400                    CLIMB   8196
        10 006333   402000 401760                    pmme    nvectors=5

     1471    10727    4               CODE04.CREATION.TIME=TIMEUTS;

  10727 10 006334   001075 235000 0                  LDA     TIMEUTS
        10 006335   001423 755000 0                  STA     CODE04+2

     1472    10728    4               VIDBUF=ADDR(PADBUF)->FITMOVER;

  10728 10 006336   002620 720000 0                  LXL0    FITSIZE
        10 006337   010000 221003                    LDX1    4096,DU
        10 006340   000040 100440                    MLR     fill='000'O
        10 006341   001410 000010 0                  ADSC9   PADBUF                   cn=0,n=*X0
        10 006342   002621 000011 0                  ADSC9   VIDBUF                   cn=0,n=*X1

     1473    10729    4               WBUF(PADBUF.FCEX)=MADBUF.K(0);

  10729 10 006343   001302 236000 0                  LDQ     MADBUF+5
        10 006344   001412 222000 0                  LDX2    PADBUF+2
        10 006345   002621 756012 0                  STQ     VIDBUF,X2

     1474    10730    4               FITSIZE=FIT09.NDW*4;

  10730 10 006346   001420 236000 0                  LDQ     FIT09
        10 006347   000010 772000                    QRL     8
        10 006350   007774 376007                    ANQ     4092,DL
        10 006351   002620 756000 0                  STQ     FITSIZE

     1475    10731    4               ADDR(WBUF(FIT09.ITEMX+SIZEW(FM$GRAN)))->FITMOVER=CODE09;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:304  
  10731 10 006352   001420 720000 0                  LXL0    FIT09
        10 006353   001777 360003                    ANX0    1023,DU
        10 006354   000000 635010                    EAA     0,X0
        10 006355   000020 771000                    ARL     16
        10 006356   000000 622006                    EAX2    0,QL
        10 006357   000045 100400                    MLR     fill='000'O
        10 006360   001634 003720 0                  ADSC9   CODE09                   cn=0,n=2000
        10 006361   002626 000012 0                  ADSC9   VIDBUF+5,A               cn=0,n=*X2

     1476    10732    4               CALL M$WRITE(WRITEPAD)ALTRET(DPERR);

  10732 10 006362   000416 630400 0                  EPPR0   READVID
        10 006363   440001 713400                    CLIMB   alt,write
        10 006364   401400 401760                    pmme    nvectors=4
        10 006365   013551 702000 10                 TSX2    DPERR

     1477    10733    4               VIDBUF=MADBUF;

  10733 10 006366   010000 220003                    LDX0    4096,DU
        10 006367   000040 100400                    MLR     fill='000'O
        10 006370   001275 000454 0                  ADSC9   MADBUF                   cn=0,n=300
        10 006371   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0

     1478    10734    4               GRANULE=GRANULE+1;

  10734 10 006372   001113 054000 0                  AOS     GRANULE

     1479    10735    4               CALL M$WRITE(READVID)ALTRET(DPERR);

  10735 10 006373   000416 630400 0                  EPPR0   READVID
        10 006374   440001 713400                    CLIMB   alt,write
        10 006375   401400 401760                    pmme    nvectors=4
        10 006376   013551 702000 10                 TSX2    DPERR

     1480    10736    4               GRANULE=0;

  10736 10 006377   001113 450000 0                  STZ     GRANULE
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:305  

     1481    10737    4               END;

     1482    10738    3            CALL CLOSE(DCBNUM(M$DP));

  10738 10 006400   000000 236007 xsym               LDQ     M$DP,DL
        10 006401   201364 756100                    STQ     BXP+15,,AUTO
        10 006402   201364 630500                    EPPR0   BXP+15,,AUTO
        10 006403   201341 450500                    STP0    P$+2,,AUTO
        10 006404   012416 701000 10                 TSX1    CLOSE
        10 006405   000000 011000                    NOP     0

     1483    10739    3            END;

  10739 10 006406   001076 235000 0                  LDA     I
        10 006407   006154 601000 10                 TNZ     s:10691

     1484    10740    2         GOTO EXTXIT;

  10740 10 006410   006765 710000 10                 TRA     EXTXIT

  10738 10 006411                       GETVSN       null
     1485    10741        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:306  
     1486    10742    2   GETVSN:;    /* SUBROUTINE THAT COLLECTS ONE VSN INTO SNLIST(NUMSNS) */
     1487    10743    2         CALL CHARBIN(J,OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT);

  10743 10 006411   001073 470400 0                  LDP0    BLK$
        10 006412   001076 720000 0                  LXL0    I
        10 006413   000003 471510                    LDP1    3,X0,PR0
        10 006414   100004 236100                    LDQ     4,,PR1
        10 006415   000033 772000                    QRL     27
        10 006416   000000 621006                    EAX1    0,QL
        10 006417   000100 305540                    DTB
        10 006420   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
        10 006421   201346 000010                    NDSC9   BXP+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
        10 006422   201347 235100                    LDA     BXP+2,,AUTO
        10 006423   001104 755000 0                  STA     J

     1488    10744    2         VID1.SNLIST.VSN(NUMSNS)=BINBIT(J,36);

  10744 10 006424   001112 236000 0                  LDQ     NUMSNS
        10 006425   000002 736000                    QLS     2
        10 006426   000000 621006                    EAX1    0,QL
        10 006427   001104 236000 0                  LDQ     J
        10 006430   005321 756011 0                  STQ     CSTAT+320,X1

     1489    10745    2         IF I<OUT$BLK.NSUBLKS-1

  10745 10 006431   001073 470400 0                  LDP0    BLK$
        10 006432   000001 236100                    LDQ     1,,PR0
        10 006433   000022 772000                    QRL     18
        10 006434   000001 136007                    SBLQ    1,DL
        10 006435   006464 604000 10                 TMI     s:10751
        10 006436   001076 116000 0                  CMPQ    I
        10 006437   006464 602000 10                 TNC     s:10751
        10 006440   006464 600000 10                 TZE     s:10751

     1490    10746    3         THEN IF OUT$BLK.SUBLK$(I+1)->OUT$BLK.NDTYPE=%PL6SYM# THEN DO;

  10746 10 006441   001076 720000 0                  LXL0    I
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:307  
        10 006442   000004 471510                    LDP1    4,X0,PR0
        10 006443   100000 236100                    LDQ     0,,PR1
        10 006444   000077 376003                    ANQ     63,DU
        10 006445   000030 116003                    CMPQ    24,DU
        10 006446   006464 601000 10                 TNZ     s:10751

     1491    10747    3            VID1.SNLIST.VSN.S(NUMSNS)=

  10747 10 006447   100004 236100                    LDQ     4,,PR1
        10 006450   000033 772000                    QRL     27
        10 006451   100004 236100                    LDQ     4,,PR1
        10 006452   000022 772000                    QRL     18
        10 006453   000777 376007                    ANQ     511,DL
        10 006454   000100 136007                    SBLQ    64,DL
        10 006455   000033 736000                    QLS     27
        10 006456   005321 676011 0                  ERQ     CSTAT+320,X1
        10 006457   777000 376003                    ANQ     -512,DU
        10 006460   005321 656011 0                  ERSQ    CSTAT+320,X1

     1492    10748    3              ASCBIN(OUT$BLK.SUBLK$(I+1)->OUT$SYM.TEXT)-ASCBIN('@');
     1493    10749    3            I=I+1;

  10749 10 006461   001076 235000 0                  LDA     I
        10 006462   000001 035007                    ADLA    1,DL
        10 006463   001076 755000 0                  STA     I

     1494    10750    3            END;

     1495    10751    3         DO J=0 TO NUMSNS-1;

  10751 10 006464   001104 450000 0                  STZ     J
        10 006465   006500 710000 10                 TRA     s:10753+3

     1496    10752    3            IF VID1.SNLIST.VSN(J)=VID1.SNLIST.VSN(NUMSNS) THEN GOTO DUPERR;

  10752 10 006466   001112 235000 0                  LDA     NUMSNS
        10 006467   000002 735000                    ALS     2
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:308  
        10 006470   001104 236000 0                  LDQ     J
        10 006471   000002 736000                    QLS     2
        10 006472   005321 236006 0                  LDQ     CSTAT+320,QL
        10 006473   005321 116005 0                  CMPQ    CSTAT+320,AL
        10 006474   013524 600000 10                 TZE     DUPERR

     1497    10753    3            END;

  10753 10 006475   001104 236000 0                  LDQ     J
        10 006476   000001 036007                    ADLQ    1,DL
        10 006477   001104 756000 0                  STQ     J
        10 006500   001104 236000 0                  LDQ     J
        10 006501   001112 116000 0                  CMPQ    NUMSNS
        10 006502   006466 602000 10                 TNC     s:10752

     1498    10754                    /*E*     ERROR: FXP-E$DUPVSN-E
     1499    10755                    *        MESSAGE: Volume% %U1% is already part of set% #%SN%
     1500    10756                    */
     1501    10757    2         OPNSN.SN#(0)=ADDR(VID1.SNLIST.VSN(NUMSNS))->CHAR4;

  10757 10 006503   001112 235000 0                  LDA     NUMSNS
        10 006504   000004 735000                    ALS     4
        10 006505   040000 100405                    MLR     fill='040'O
        10 006506   005321 000004 0                  ADSC9   CSTAT+320,A              cn=0,n=4
        10 006507   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1502    10758    2         CALL M$OPEN(OPNDP)ALTRET(VOLERR);

  10758 10 006510   000100 630400 0                  EPPR0   OPNDP
        10 006511   450000 713400                    CLIMB   alt,open
        10 006512   410400 401760                    pmme    nvectors=18
        10 006513   013527 702000 10                 TSX2    VOLERR

     1503    10759    2         VID1.SNLIST.SIZE(NUMSNS)=F$DCB.IXTNSIZE;

  10759 10 006514   001112 235000 0                  LDA     NUMSNS
        10 006515   000002 735000                    ALS     2
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:309  
        10 006516   000000 470400 xsym               LDP0    M$DP$
        10 006517   000000 620005                    EAX0    0,AL
        10 006520   000041 235100                    LDA     33,,PR0
        10 006521   005322 755010 0                  STA     CSTAT+321,X0

     1504    10760    2         VID1.SNLIST.TYPE(NUMSNS)=F$DCB.ACCT;

  10760 10 006522   000020 237100                    LDAQ    16,,PR0
        10 006523   005323 755010 0                  STA     CSTAT+322,X0
        10 006524   005324 756010 0                  STQ     CSTAT+323,X0

     1505    10761    2         CALL M$READ(READVID)ALTRET(DPERR);

  10761 10 006525   000416 630400 0                  EPPR0   READVID
        10 006526   440000 713400                    CLIMB   alt,read
        10 006527   401400 401760                    pmme    nvectors=4
        10 006530   013551 702000 10                 TSX2    DPERR

     1506    10762    2         IF VIDBUF.SECTSTRT(1)~=0 AND VIDBUF.SECTSTRT(1)<F$DCB.IXTNSIZE

  10762 10 006531   002632 235000 0                  LDA     VIDBUF+9
        10 006532   006550 600000 10                 TZE     s:10770
        10 006533   000000 470400 xsym               LDP0    M$DP$
        10 006534   002632 236000 0                  LDQ     VIDBUF+9
        10 006535   006550 604000 10                 TMI     s:10770
        10 006536   000041 116100                    CMPQ    33,,PR0
        10 006537   006550 605000 10                 TPL     s:10770
        10 006540   001112 235000 0                  LDA     NUMSNS
        10 006541   000002 735000                    ALS     2
        10 006542   005321 236005 0                  LDQ     CSTAT+320,AL
        10 006543   777000 316003                    CANQ    -512,DU
        10 006544   006550 601000 10                 TNZ     s:10770

     1507    10763    3           AND VID1.SNLIST.VSN.S(NUMSNS)=0 THEN DO;

     1508    10764    3            FLAG=FXP$E$NEEDSCR;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:310  
  10764 10 006545   000042 236000 2                  LDQ     FXP$E$NEEDSCR
        10 006546   001107 756000 0                  STQ     FLAG

     1509    10765    3            GOTO DPERR1;

  10765 10 006547   013567 710000 10                 TRA     DPERR1

     1510    10766                    /*E*     ERROR: FXP-E$NEEDSCR-E
     1511    10767                    *        MESSAGE:Volume% %U1% must be used a section at a time.
     1512    10768                    */
     1513    10769    3            END;
     1514    10770    2         CALL FXU$PROTCHK(VIDBUF)ALTRET(DPCLOSE);

  10770 10 006550   000074 630400 11                 EPPR0   60
        10 006551   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 006552   000000 701000 xent               TSX1    FXU$PROTCHK
        10 006553   013762 702000 10                 TSX2    DPCLOSE

     1515    10771    2         IF CODE=%E$BUILD THEN GOTO GETVSNBRET;

  10771 10 006554   200007 235100                    LDA     CODE,,AUTO
        10 006555   000151 115007                    CMPA    105,DL
        10 006556   006031 600000 10                 TZE     GETVSNBRET

     1516    10772    2         GOTO GETVSNERET;

  10772 10 006557   006633 710000 10                 TRA     GETVSNERET

     1517    10773        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:311  
     1518    10774    2      CASE(%(E$EXTND-E$PIGH));

     1519    10775                    /*E*     ERROR: FXP-E$EXTND-0
     1520    10776                    *        MESSAGE:EXtend DP#set With vsn,...,vsn
     1521    10777                    */
     1522    10778    2         OPNDP.V.FUN#=%UPDATE#;

  10778 10 006560   001000 236007                    LDQ     512,DL
        10 006561   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1523    10779    2         OPNDP.FPARAM_=VECTOR(NIL);

  10779 10 006562   000024 237000 11                 LDAQ    20
        10 006563   000130 757000 0                  STAQ    OPNDP+24

     1524    10780    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10780 10 006564   000100 630400 0                  EPPR0   OPNDP
        10 006565   450000 713400                    CLIMB   alt,open
        10 006566   410400 401760                    pmme    nvectors=18
        10 006567   013551 702000 10                 TSX2    DPERR

     1525    10781    2         CALL M$READ(READVID)ALTRET(DPERR);

  10781 10 006570   000416 630400 0                  EPPR0   READVID
        10 006571   440000 713400                    CLIMB   alt,read
        10 006572   401400 401760                    pmme    nvectors=4
        10 006573   013551 702000 10                 TSX2    DPERR

     1526    10782    2         VID1=VIDBUF;

  10782 10 006574   010000 220003                    LDX0    4096,DU
        10 006575   000040 100440                    MLR     fill='000'O
        10 006576   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0
        10 006577   004621 000010 0                  ADSC9   CSTAT                    cn=0,n=*X0

     1527    10783    2         NUMSNS=VIDBUF.VOLCNT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:312  

  10783 10 006600   002625 236000 0                  LDQ     VIDBUF+4
        10 006601   777777 376007                    ANQ     -1,DL
        10 006602   001112 756000 0                  STQ     NUMSNS

     1528    10784    2         OPNSN.SN#(1)=OPNSN.SN#(0);

  10784 10 006603   040000 100400                    MLR     fill='040'O
        10 006604   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 006605   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6

     1529    10785    2         IF NOT F$DCB.OWNER AND OPNSN.SN#(0)~='SYS' THEN GOTO NOTOWNER;

  10785 10 006606   000000 470400 xsym               LDP0    M$DP$
        10 006607   000064 236100                    LDQ     52,,PR0
        10 006610   040000 316007                    CANQ    16384,DL
        10 006611   006616 601000 10                 TNZ     s:10786
        10 006612   040000 106400                    CMPC    fill='040'O
        10 006613   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 006614   000520 000003 2                  ADSC9   FFLGS+41                 cn=0,n=3
        10 006615   014012 601000 10                 TNZ     NOTOWNER

     1530    10786    2         CLSDP.V.DISP#=%SETDSMT#;

  10786 10 006616   000013 236007                    LDQ     11,DL
        10 006617   000224 552004 0                  STBQ    CLSDP+26,'04'O

     1531    10787    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);

  10787 10 006620   000172 630400 0                  EPPR0   CLSDP
        10 006621   450001 713400                    CLIMB   alt,close
        10 006622   406000 401760                    pmme    nvectors=13
        10 006623   013551 702000 10                 TSX2    DPERR

     1532    10788    3         DO WHILE (I<OUT$BLK.NSUBLKS);

  10788 10 006624   001073 470400 0                  LDP0    BLK$
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:313  
        10 006625   000001 236100                    LDQ     1,,PR0
        10 006626   000022 772000                    QRL     18
        10 006627   001076 116000 0                  CMPQ    I
        10 006630   006655 602000 10                 TNC     s:10795
        10 006631   006655 600000 10                 TZE     s:10795

     1533    10789    3            GOTO GETVSN;

  10789 10 006632   006411 710000 10                 TRA     GETVSN

  10788 10 006633                       GETVSNERET   null
     1534    10790    3   GETVSNERET:;
     1535    10791    3            CALL CLOSE(DCBNUM(M$DP));

  10791 10 006633   000000 236007 xsym               LDQ     M$DP,DL
        10 006634   201365 756100                    STQ     BXP+16,,AUTO
        10 006635   201365 630500                    EPPR0   BXP+16,,AUTO
        10 006636   201341 450500                    STP0    P$+2,,AUTO
        10 006637   012416 701000 10                 TSX1    CLOSE
        10 006640   000000 011000                    NOP     0

     1536    10792    3            NUMSNS=NUMSNS+1;

  10792 10 006641   001112 235000 0                  LDA     NUMSNS
        10 006642   000001 035007                    ADLA    1,DL
        10 006643   001112 755000 0                  STA     NUMSNS

     1537    10793    3            I=I+1;

  10793 10 006644   001076 236000 0                  LDQ     I
        10 006645   000001 036007                    ADLQ    1,DL
        10 006646   001076 756000 0                  STQ     I

     1538    10794    3            END;

  10794 10 006647   001073 470400 0                  LDP0    BLK$
        10 006650   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:314  
        10 006651   000022 772000                    QRL     18
        10 006652   001076 116000 0                  CMPQ    I
        10 006653   006655 600000 10                 TZE     s:10795
        10 006654   006632 603000 10                 TRC     s:10789

     1539    10795    2         I=NUMSNS;

  10795 10 006655   001112 235000 0                  LDA     NUMSNS
        10 006656   001076 755000 0                  STA     I

     1540    10796    3         DO WHILE (I~=0);

  10796 10 006657   006765 600000 10                 TZE     EXTXIT

     1541    10797    3            I=I-1;

  10797 10 006660   001076 235000 0                  LDA     I
        10 006661   000001 135007                    SBLA    1,DL
        10 006662   001076 755000 0                  STA     I

     1542    10798    3            IF GRANULE>0 THEN OPNSN.SN#(0)=OPNSN.SN#(1);

  10798 10 006663   001113 236000 0                  LDQ     GRANULE
        10 006664   006671 604400 10                 TMOZ    s:10799

  10798 10 006665   040000 100400                    MLR     fill='040'O
        10 006666   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6
        10 006667   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 006670   006675 710000 10                 TRA     s:10800

     1543    10799    3            ELSE OPNSN.SN#(0)=ADDR(VID1.SNLIST.VSN(I))->CHAR4;

  10799 10 006671   000004 735000                    ALS     4
        10 006672   040000 100405                    MLR     fill='040'O
        10 006673   005321 000004 0                  ADSC9   CSTAT+320,A              cn=0,n=4
        10 006674   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:315  
     1544    10800    4            CALL M$OPEN(OPNDP) WHENALTRETURN DO;

  10800 10 006675   000100 630400 0                  EPPR0   OPNDP
        10 006676   450000 713400                    CLIMB   alt,open
        10 006677   410400 401760                    pmme    nvectors=18
        10 006700   006702 702000 10                 TSX2    s:10801
        10 006701   006721 710000 10                 TRA     s:10805

     1545    10801    4               IF B$ALT.ERR.CODE~=%E$XCLSET OR GRANULE>0 THEN GOTO VOLERR;

  10801 10 006702   000000 470400 xsym               LDP0    B$TCB$
        10 006703   000000 471500                    LDP1    0,,PR0
        10 006704   100102 236100                    LDQ     66,,PR1
        10 006705   377770 376007                    ANQ     131064,DL
        10 006706   002170 116007                    CMPQ    1144,DL
        10 006707   013527 601000 10                 TNZ     VOLERR
        10 006710   001113 235000 0                  LDA     GRANULE
        10 006711   013527 605400 10                 TPNZ    VOLERR

     1546    10802    4               OPNSN.SN#(0)=OPNSN.SN#(1);

  10802 10 006712   040000 100400                    MLR     fill='040'O
        10 006713   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6
        10 006714   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1547    10803    4               CALL M$OPEN(OPNDP) ALTRET(VOLERR);

  10803 10 006715   000100 630400 0                  EPPR0   OPNDP
        10 006716   450000 713400                    CLIMB   alt,open
        10 006717   410400 401760                    pmme    nvectors=18
        10 006720   013527 702000 10                 TSX2    VOLERR

     1548    10804    4               END;

     1549    10805    3            CALL M$READ(READVID)ALTRET(DPERR);

  10805 10 006721   000416 630400 0                  EPPR0   READVID
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:316  
        10 006722   440000 713400                    CLIMB   alt,read
        10 006723   401400 401760                    pmme    nvectors=4
        10 006724   013551 702000 10                 TSX2    DPERR

     1550    10806    3            VIDBUF.PSN=VID1.PSN;

  10806 10 006725   040000 100400                    MLR     fill='040'O
        10 006726   004624 000006 0                  ADSC9   CSTAT+3                  cn=0,n=6
        10 006727   002624 000006 0                  ADSC9   VIDBUF+3                 cn=0,n=6

     1551    10807    3            VIDBUF.SNLIST=VID1.SNLIST;

  10807 10 006730   000000 100400                    MLR     fill='000'O
        10 006731   005321 005400 0                  ADSC9   CSTAT+320                cn=0,n=2816
        10 006732   003321 005400 0                  ADSC9   VIDBUF+320               cn=0,n=2816

     1552    10808    3            VIDBUF.VOLCNT=NUMSNS;

  10808 10 006733   001112 720000 0                  LXL0    NUMSNS
        10 006734   002625 440000 0                  SXL0    VIDBUF+4

     1553    10809    3            CALL M$WRITE(WRITEVID) ALTRET(DPERR);

  10809 10 006735   000416 630400 0                  EPPR0   READVID
        10 006736   440001 713400                    CLIMB   alt,write
        10 006737   401400 401760                    pmme    nvectors=4
        10 006740   013551 702000 10                 TSX2    DPERR

     1554    10810    3            CALL CLOSE(DCBNUM(M$DP));

  10810 10 006741   000000 236007 xsym               LDQ     M$DP,DL
        10 006742   201366 756100                    STQ     BXP+17,,AUTO
        10 006743   201366 630500                    EPPR0   BXP+17,,AUTO
        10 006744   201341 450500                    STP0    P$+2,,AUTO
        10 006745   012416 701000 10                 TSX1    CLOSE
        10 006746   000000 011000                    NOP     0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:317  
     1555    10811    3            IF OPNSN.SN#(0)=OPNSN.SN#(1)

  10811 10 006747   040000 106400                    CMPC    fill='040'O
        10 006750   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 006751   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6
        10 006752   006763 601000 10                 TNZ     s:10813

     1556    10812    3            THEN GRANULE=GRANULE+VID1.SNLIST.SIZE(VID1.VOLCNT-1-I);

  10812 10 006753   004625 236000 0                  LDQ     CSTAT+4
        10 006754   777777 376007                    ANQ     -1,DL
        10 006755   001076 136000 0                  SBLQ    I
        10 006756   000002 736000                    QLS     2
        10 006757   000000 620006                    EAX0    0,QL
        10 006760   001113 236000 0                  LDQ     GRANULE
        10 006761   005316 036010 0                  ADLQ    CSTAT+317,X0
        10 006762   001113 756000 0                  STQ     GRANULE

     1557    10813    3            END;

  10813 10 006763   001076 235000 0                  LDA     I
        10 006764   006660 601000 10                 TNZ     s:10797

  10811 10 006765                       EXTXIT       null
     1558    10814    2   EXTXIT:;
     1559    10815    2         IF NOT F$DCB.OWNER THEN GOTO NEXT;

  10815 10 006765   000000 470400 xsym               LDP0    M$DP$
        10 006766   000064 236100                    LDQ     52,,PR0
        10 006767   040000 316007                    CANQ    16384,DL
        10 006770   000204 600000 10                 TZE     NEXT

     1560    10816    2         I=F$DCB.SETX;

  10816 10 006771   000051 236100                    LDQ     41,,PR0
        10 006772   777777 376007                    ANQ     -1,DL
        10 006773   001076 756000 0                  STQ     I
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:318  

     1561    10817    3         IF B$JIT.PRIV.ACTIVE.SPCLMM THEN DO;

  10817 10 006774   000000 471400 xsym               LDP1    B$JIT$
        10 006775   100013 236100                    LDQ     11,,PR1
        10 006776   000001 316007                    CANQ    1,DL
        10 006777   007025 600000 10                 TZE     s:10822

     1562    10818    3            IF FM$DEV.DCTX(I)=I THEN I=FM$DEV.SECTL(I);

  10818 10 007000   001076 235000 0                  LDA     I
        10 007001   000003 735000                    ALS     3
        10 007002   000000 473400 xsym               LDP3    F$CFU$
        10 007003   300000 236105                    LDQ     0,AL,PR3
        10 007004   000022 772000                    QRL     18
        10 007005   001076 116000 0                  CMPQ    I
        10 007006   007012 601000 10                 TNZ     s:10819

  10818 10 007007   300005 236105                    LDQ     5,AL,PR3
        10 007010   777777 376007                    ANQ     -1,DL
        10 007011   001076 756000 0                  STQ     I

     1563    10819    3            I=FM$VOL.SETX(I);

  10819 10 007012   001076 235000 0                  LDA     I
        10 007013   000003 735000                    ALS     3
        10 007014   300000 236105                    LDQ     0,AL,PR3
        10 007015   777777 376007                    ANQ     -1,DL
        10 007016   001076 756000 0                  STQ     I

     1564    10820    3            OPNSN.SN#(0)=FM$SET.PSN(I);

  10820 10 007017   001076 235000 0                  LDA     I
        10 007020   000005 735000                    ALS     5
        10 007021   040000 100505                    MLR     fill='040'O
        10 007022   300000 400006                    ADSC9   0,A,PR3                  cn=2,n=6
        10 007023   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:319  

     1565    10821    3            END;

  10821 10 007024   007030 710000 10                 TRA     s:10823

     1566    10822    2         ELSE OPNSN.SN#(0)=OPNSN.SN#(1);

  10822 10 007025   040000 100400                    MLR     fill='040'O
        10 007026   000074 400006 0                  ADSC9   OPNSN+2                  cn=2,n=6
        10 007027   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1567    10823    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10823 10 007030   000100 630400 0                  EPPR0   OPNDP
        10 007031   450000 713400                    CLIMB   alt,open
        10 007032   410400 401760                    pmme    nvectors=18
        10 007033   013551 702000 10                 TSX2    DPERR

     1568    10824    2         IF F$DCB.SETX=I AND F$DCB.OWNER THEN CALL RECONST ALTRET(DPERR1);

  10824 10 007034   000000 470400 xsym               LDP0    M$DP$
        10 007035   000051 236100                    LDQ     41,,PR0
        10 007036   777777 376007                    ANQ     -1,DL
        10 007037   001076 116000 0                  CMPQ    I
        10 007040   007046 601000 10                 TNZ     s:10825
        10 007041   000064 236100                    LDQ     52,,PR0
        10 007042   040000 316007                    CANQ    16384,DL
        10 007043   007046 600000 10                 TZE     s:10825

  10824 10 007044   014324 701000 10                 TSX1    RECONST
        10 007045   013567 702000 10                 TSX2    DPERR1

     1569    10825    2         CALL M$CLOSE(CLSDP)ALTRET(NEXT);

  10825 10 007046   000172 630400 0                  EPPR0   CLSDP
        10 007047   450001 713400                    CLIMB   alt,close
        10 007050   406000 401760                    pmme    nvectors=13
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:320  
        10 007051   000204 702000 10                 TSX2    NEXT
        10 007052   011257 710000 10                 TRA     s:11238

     1570    10826        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:321  
     1571    10827    2      CASE(%(E$MOUNT-E$PIGH));

     1572    10828                    /*E*     ERROR: FXP-E$MOUNT-0
     1573    10829                    *        MESSAGE:Mount DP#set [{PUblic|SHared|EXclusive}]
     1574    10830                    */
     1575    10831    2         CALL CATREAD;

  10831 10 007053   012341 701000 10                 TSX1    CATREAD
        10 007054   000000 011000                    NOP     0

     1576    10832    3         DO I=0 TO NUMPSNS;

  10832 10 007055   001076 450000 0                  STZ     I
        10 007056   007070 710000 10                 TRA     s:10834+3

     1577    10833    3            IF CSTAT.SETS.PSN(I)=OPNSN.SN#(0) THEN GOTO MOUNT0;

  10833 10 007057   001076 235000 0                  LDA     I
        10 007060   000003 735000                    ALS     3
        10 007061   040000 106405                    CMPC    fill='040'O
        10 007062   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6
        10 007063   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 007064   007110 600000 10                 TZE     MOUNT0

     1578    10834    3            END;

  10834 10 007065   001076 236000 0                  LDQ     I
        10 007066   000001 036007                    ADLQ    1,DL
        10 007067   001076 756000 0                  STQ     I
        10 007070   004621 236000 0                  LDQ     CSTAT
        10 007071   001076 116000 0                  CMPQ    I
        10 007072   007057 603000 10                 TRC     s:10833

  10832 10 007073                       MOUNT00      null
     1579    10835    2   MOUNT00:;
     1580    10836    2         NUMPSNS=NUMPSNS+1;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:322  
  10836 10 007073   004621 235000 0                  LDA     CSTAT
        10 007074   000001 035007                    ADLA    1,DL
        10 007075   004621 755000 0                  STA     CSTAT

     1581    10837    2         CSTAT.SETS(I)='0'B;

  10837 10 007076   001076 236000 0                  LDQ     I
        10 007077   000001 736000                    QLS     1
        10 007100   004623 450006 0                  STZ     CSTAT+2,QL
        10 007101   004624 450006 0                  STZ     CSTAT+3,QL

     1582    10838    2         CSTAT.SETS.PSN(I)=OPNSN.SN#(0);

  10838 10 007102   001076 235000 0                  LDA     I
        10 007103   000001 735000                    ALS     1
        10 007104   000002 735000                    ALS     2
        10 007105   040005 100400                    MLR     fill='040'O
        10 007106   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 007107   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6

     1583    10839    2   MOUNT0: CSTAT.SETS.DISP(I)=%SETXCL#;

  10839 10 007110   001076 235000 0     MOUNT0       LDA     I
        10 007111   000001 735000                    ALS     1
        10 007112   004624 236005 0                  LDQ     CSTAT+3,AL
        10 007113   000133 376000 11                 ANQ     91
        10 007114   012000 276007                    ORQ     5120,DL
        10 007115   004624 756005 0                  STQ     CSTAT+3,AL

     1584    10840    2         IF CODE~=%E$MOUNT THEN CSTAT.SETS.DISP(I)=CSTAT.DEFMOUNT;

  10840 10 007116   200007 235100                    LDA     CODE,,AUTO
        10 007117   000155 115007                    CMPA    109,DL
        10 007120   007132 600000 10                 TZE     s:10841

  10840 10 007121   001076 236000 0                  LDQ     I
        10 007122   000001 736000                    QLS     1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:323  
        10 007123   000000 620006                    EAX0    0,QL
        10 007124   004622 236000 0                  LDQ     CSTAT+1
        10 007125   000011 736000                    QLS     9
        10 007126   004624 676010 0                  ERQ     CSTAT+3,X0
        10 007127   777000 376007                    ANQ     -512,DL
        10 007130   004624 656010 0                  ERSQ    CSTAT+3,X0
        10 007131   007147 710000 10                 TRA     MOUNT1

     1585    10841    2         ELSE IF OUT$BLK.NSUBLKS>=3 THEN CSTAT.SETS.DISP(I)=

  10841 10 007132   001073 470400 0                  LDP0    BLK$
        10 007133   000001 220100                    LDX0    1,,PR0
        10 007134   000003 100003                    CMPX0   3,DU
        10 007135   007147 602000 10                 TNC     MOUNT1

  10841 10 007136   001076 236000 0                  LDQ     I
        10 007137   000001 736000                    QLS     1
        10 007140   000005 471500                    LDP1    5,,PR0
        10 007141   000000 621006                    EAX1    0,QL
        10 007142   100000 236100                    LDQ     0,,PR1
        10 007143   000011 736000                    QLS     9
        10 007144   004624 676011 0                  ERQ     CSTAT+3,X1
        10 007145   777000 376007                    ANQ     -512,DL
        10 007146   004624 656011 0                  ERSQ    CSTAT+3,X1

  10840 10 007147                       MOUNT1       null
     1586    10842    2           OUT$BLK.SUBLK$(2)->OUT$BLK.CODE;
     1587    10843    2   MOUNT1: ;
     1588    10844    2         OPNSN.SN#(0)=CSTAT.SETS.PSN(I);

  10844 10 007147   001076 235000 0                  LDA     I
        10 007150   000003 735000                    ALS     3
        10 007151   040000 100405                    MLR     fill='040'O
        10 007152   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6
        10 007153   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1589    10845    2         IF MODE~=0 THEN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:324  

  10845 10 007154   001121 236000 0                  LDQ     MODE
        10 007155   007210 600000 10                 TZE     s:10852

     1590    10846    3         IF CSTAT.SETS.DISP(I)=%SETXCL# AND I~=0 THEN DO;

  10846 10 007156   001076 235000 0                  LDA     I
        10 007157   000001 735000                    ALS     1
        10 007160   004624 236005 0                  LDQ     CSTAT+3,AL
        10 007161   777000 376007                    ANQ     -512,DL
        10 007162   012000 116007                    CMPQ    5120,DL
        10 007163   007210 601000 10                 TNZ     s:10852
        10 007164   001076 235000 0                  LDA     I
        10 007165   007210 600000 10                 TZE     s:10852

     1591    10847    3            CSTAT.SETS(I)=CSTAT.SETS(CSTAT.NUM);

  10847 10 007166   000001 735000                    ALS     1
        10 007167   004621 236000 0                  LDQ     CSTAT
        10 007170   000003 736000                    QLS     3
        10 007171   000002 735000                    ALS     2
        10 007172   000005 100406                    MLR     fill='000'O
        10 007173   004623 000010 0                  ADSC9   CSTAT+2,Q                cn=0,n=8
        10 007174   004623 000010 0                  ADSC9   CSTAT+2,A                cn=0,n=8

     1592    10848    3            I=CSTAT.NUM;

  10848 10 007175   004621 235000 0                  LDA     CSTAT
        10 007176   001076 755000 0                  STA     I

     1593    10849    3            CSTAT.NUM=I-1;

  10849 10 007177   000001 135007                    SBLA    1,DL
        10 007200   004621 755000 0                  STA     CSTAT

     1594    10850    3            CSTAT.SETS.DISP(I)=%SETXCL#;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:325  
  10850 10 007201   001076 236000 0                  LDQ     I
        10 007202   000001 736000                    QLS     1
        10 007203   000000 620006                    EAX0    0,QL
        10 007204   004624 236006 0                  LDQ     CSTAT+3,QL
        10 007205   000133 376000 11                 ANQ     91
        10 007206   012000 276007                    ORQ     5120,DL
        10 007207   004624 756010 0                  STQ     CSTAT+3,X0

     1595    10851    3            END;

     1596    10852    2         IF CSTAT.SETS.SETX(I)~=2 THEN CSTAT.SETS.SETX(I)=0;

  10852 10 007210   001076 235000 0                  LDA     I
        10 007211   000001 735000                    ALS     1
        10 007212   004624 236005 0                  LDQ     CSTAT+3,AL
        10 007213   000777 376007                    ANQ     511,DL
        10 007214   000002 116007                    CMPQ    2,DL
        10 007215   007220 600000 10                 TZE     s:10853

  10852 10 007216   000005 236000 11                 LDQ     5
        10 007217   004624 356005 0                  ANSQ    CSTAT+3,AL

     1597    10853    2         IF MODE=0 THEN CALL CATWRITE;

  10853 10 007220   001121 235000 0                  LDA     MODE
        10 007221   007224 601000 10                 TNZ     s:10854

  10853 10 007222   012372 701000 10                 TSX1    CATWRITE
        10 007223   000000 011000                    NOP     0

     1598    10854    2         OPNDP.FPARAM_=VECTOR(NIL);

  10854 10 007224   000024 237000 11                 LDAQ    20
        10 007225   000130 757000 0                  STAQ    OPNDP+24

     1599    10855    2         OPNDP.V.FUN#=%UPDATE#;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:326  
  10855 10 007226   001000 236007                    LDQ     512,DL
        10 007227   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1600    10856    3         IF B$JIT.MODE=%M_BATCH# THEN DO;

  10856 10 007230   000000 470400 xsym               LDP0    B$JIT$
        10 007231   000000 236100                    LDQ     0,,PR0
        10 007232   740000 376003                    ANQ     -16384,DU
        10 007233   040000 116003                    CMPQ    16384,DU
        10 007234   007251 601000 10                 TNZ     s:10861

     1601    10857    3            VLP_ACCT=BINBIT(-1,36);

  10857 10 007235   000001 336007                    LCQ     1,DL
        10 007236   000044 737000                    LLS     36
        10 007237   000000 236003                    LDQ     0,DU
        10 007240   000076 757000 0                  STAQ    VLP_ACCT

     1602    10858    3            CALL M$OPEN(OPNXTA)ALTRET(NOALT);

  10858 10 007241   000440 630400 0                  EPPR0   OPNXTA
        10 007242   450000 713400                    CLIMB   alt,open
        10 007243   410400 401760                    pmme    nvectors=18
        10 007244   014123 702000 10                 TSX2    NOALT

     1603    10859    3            IF FLAG.CODE~=%E$ADEOF THEN GOTO DPERR;

  10859 10 007245   001107 236000 0                  LDQ     FLAG
        10 007246   377770 376007                    ANQ     131064,DL
        10 007247   001750 116007                    CMPQ    1000,DL
        10 007250   013551 601000 10                 TNZ     DPERR

     1604    10860    3            END;

     1605    10861    2         CALL M$OPEN(OPNDP)ALTRET(MNTERR);

  10861 10 007251   000100 630400 0                  EPPR0   OPNDP
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:327  
        10 007252   450000 713400                    CLIMB   alt,open
        10 007253   410400 401760                    pmme    nvectors=18
        10 007254   007405 702000 10                 TSX2    MNTERR

     1606    10862    2         IF NOT F$DCB.OWNER AND CSTAT.SETS.DISP(I)=%SETXCL# THEN GOTO NOTOWNER;

  10862 10 007255   000000 470400 xsym               LDP0    M$DP$
        10 007256   000064 236100                    LDQ     52,,PR0
        10 007257   040000 316007                    CANQ    16384,DL
        10 007260   007267 601000 10                 TNZ     s:10863
        10 007261   001076 235000 0                  LDA     I
        10 007262   000001 735000                    ALS     1
        10 007263   004624 236005 0                  LDQ     CSTAT+3,AL
        10 007264   777000 376007                    ANQ     -512,DL
        10 007265   012000 116007                    CMPQ    5120,DL
        10 007266   014012 600000 10                 TZE     NOTOWNER

     1607    10863    2         IF MODE=0 AND WROC.CADDR

  10863 10 007267   001121 235000 0                  LDA     MODE
        10 007270   007312 601000 10                 TNZ     s:10866
        10 007271   006666 220000 0                  LDX0    WROC
        10 007272   007312 600000 10                 TZE     s:10866

     1608    10864    2         THEN IF FM$SET.GACSHELF(F$DCB.SETX)

  10864 10 007273   000051 236100                    LDQ     41,,PR0
        10 007274   000003 736000                    QLS     3
        10 007275   000004 376000 11                 ANQ     4
        10 007276   000000 471400 xsym               LDP1    F$CFU$
        10 007277   100002 236106                    LDQ     2,QL,PR1
        10 007300   000002 316003                    CANQ    2,DU
        10 007301   007312 600000 10                 TZE     s:10866
        10 007302   001076 236000 0                  LDQ     I
        10 007303   000001 736000                    QLS     1
        10 007304   004624 236006 0                  LDQ     CSTAT+3,QL
        10 007305   777000 376007                    ANQ     -512,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:328  
        10 007306   012000 116007                    CMPQ    5120,DL
        10 007307   007312 600000 10                 TZE     s:10866

     1609    10865    2           AND CSTAT.SETS.DISP(I)~=%SETXCL# THEN GAC=1;

  10865 10 007310   000001 236007                    LDQ     1,DL
        10 007311   000000 756000 xsym               STQ     GAC

     1610    10866    2         FLAG='0'B;

  10866 10 007312   001107 450000 0                  STZ     FLAG

     1611    10867    2         CALL CLOSE(DCBNUM(M$DP))ALTRET(NOALT);

  10867 10 007313   000000 236007 xsym               LDQ     M$DP,DL
        10 007314   201367 756100                    STQ     BXP+18,,AUTO
        10 007315   201367 631500                    EPPR1   BXP+18,,AUTO
        10 007316   201341 451500                    STP1    P$+2,,AUTO
        10 007317   012416 701000 10                 TSX1    CLOSE
        10 007320   014123 702000 10                 TSX2    NOALT

     1612    10868    2         IF (FLAG.CODE=%E$PSGRANS OR GAC~=0)

  10868 10 007321   001107 236000 0                  LDQ     FLAG
        10 007322   377770 376007                    ANQ     131064,DL
        10 007323   002140 116007                    CMPQ    1120,DL
        10 007324   007327 600000 10                 TZE     s:10868+6
        10 007325   000000 235000 xsym               LDA     GAC
        10 007326   007336 600000 10                 TZE     s:10870
        10 007327   000000 470400 xsym               LDP0    M$DP$
        10 007330   000064 236100                    LDQ     52,,PR0
        10 007331   040000 316007                    CANQ    16384,DL
        10 007332   007336 600000 10                 TZE     s:10870

     1613    10869    2           AND F$DCB.OWNER THEN CALL RECONST ALTRET(MNTRECERR);

  10869 10 007333   014324 701000 10                 TSX1    RECONST
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:329  
        10 007334   007410 702000 10                 TSX2    MNTRECERR
        10 007335   007342 710000 10                 TRA     s:10871

     1614    10870    2         ELSE CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10870 10 007336   000100 630400 0                  EPPR0   OPNDP
        10 007337   450000 713400                    CLIMB   alt,open
        10 007340   410400 401760                    pmme    nvectors=18
        10 007341   013551 702000 10                 TSX2    DPERR

     1615    10871    2         CLSDP.V.DISP#=CSTAT.SETS.DISP(I);

  10871 10 007342   001076 235000 0                  LDA     I
        10 007343   000001 735000                    ALS     1
        10 007344   004624 236005 0                  LDQ     CSTAT+3,AL
        10 007345   000011 772000                    QRL     9
        10 007346   000224 552004 0                  STBQ    CLSDP+26,'04'O

     1616    10872    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);

  10872 10 007347   000172 630400 0                  EPPR0   CLSDP
        10 007350   450001 713400                    CLIMB   alt,close
        10 007351   406000 401760                    pmme    nvectors=13
        10 007352   013551 702000 10                 TSX2    DPERR

     1617    10873    2         CSTAT.SETS.SETX(I)=1;

  10873 10 007353   001076 235000 0                  LDA     I
        10 007354   000001 735000                    ALS     1
        10 007355   004624 236005 0                  LDQ     CSTAT+3,AL
        10 007356   000005 376000 11                 ANQ     5
        10 007357   000001 276007                    ORQ     1,DL
        10 007360   004624 756005 0                  STQ     CSTAT+3,AL

     1618    10874    2         IF MODE=0 THEN CALL CATWRITE;

  10874 10 007361   001121 235000 0                  LDA     MODE
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:330  
        10 007362   007365 601000 10                 TNZ     s:10875

  10874 10 007363   012372 701000 10                 TSX1    CATWRITE
        10 007364   000000 011000                    NOP     0

     1619    10875    2         IF CLSDP.V.DISP#~=%SETXCL# AND MODE=0 THEN CALL UNDEFER;

  10875 10 007365   000224 236000 0                  LDQ     CLSDP+26
        10 007366   000777 376007                    ANQ     511,DL
        10 007367   000012 116007                    CMPQ    10,DL
        10 007370   007375 600000 10                 TZE     s:10876
        10 007371   001121 235000 0                  LDA     MODE
        10 007372   007375 601000 10                 TNZ     s:10876

  10875 10 007373   013411 701000 10                 TSX1    UNDEFER
        10 007374   000000 011000                    NOP     0

     1620    10876    2         IF CODE=0 THEN GOTO DISP0;

  10876 10 007375   200007 235100                    LDA     CODE,,AUTO
        10 007376   002441 600000 10                 TZE     DISP0

     1621    10877    2         X9=F$DCB.SETX;

  10877 10 007377   000000 470400 xsym               LDP0    M$DP$
        10 007400   000051 236100                    LDQ     41,,PR0
        10 007401   777777 376007                    ANQ     -1,DL
        10 007402   200006 756100                    STQ     X9,,AUTO

     1622    10878    2         CODE=0;

  10878 10 007403   200007 450100                    STZ     CODE,,AUTO

     1623    10879    2         GOTO DISPS0;

  10879 10 007404   003203 710000 10                 TRA     DISPS0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:331  
  10878 10 007405                       MNTERR       null
     1624    10880                    /**/
     1625    10881    2   MNTERR:;
     1626    10882    2         IF CODE=0 THEN GOTO DISP0;

  10882 10 007405   200007 235100                    LDA     CODE,,AUTO
        10 007406   002441 600000 10                 TZE     DISP0

     1627    10883    2         GOTO DPERR;

  10883 10 007407   013551 710000 10                 TRA     DPERR

  10882 10 007410                       MNTRECERR    null
     1628    10884    2   MNTRECERR:;
     1629    10885    2         IF FLAG=FXP$E$2RECON THEN GOTO DISP0;

  10885 10 007410   001107 236000 0                  LDQ     FLAG
        10 007411   000036 116000 2                  CMPQ    FXP$E$2RECON
        10 007412   002441 600000 10                 TZE     DISP0

     1630    10886    2         GOTO DPERR1;

  10886 10 007413   013567 710000 10                 TRA     DPERR1

     1631    10887        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:332  
     1632    10888    2      CASE(%(E$DISMOUNT-E$PIGH));

     1633    10889                    /*E*     ERROR: FXP-E$DISMOUNT-0
     1634    10890                    *        MESSAGE:DISMount DP#set [{Fast|Now}]
     1635    10891                    */
     1636    10892    2         OPNDP.FPARAM_=VECTOR(NIL);

  10892 10 007414   000024 237000 11                 LDAQ    20
        10 007415   000130 757000 0                  STAQ    OPNDP+24

     1637    10893    3         IF MODE=0 THEN DO;

  10893 10 007416   001121 235000 0                  LDA     MODE
        10 007417   007456 601000 10                 TNZ     s:10903

     1638    10894    3            CALL CATREAD;

  10894 10 007420   012341 701000 10                 TSX1    CATREAD
        10 007421   000000 011000                    NOP     0

     1639    10895    4            DO I=1 TO NUMPSNS;

  10895 10 007422   000001 235007                    LDA     1,DL
        10 007423   001076 755000 0                  STA     I
        10 007424   007453 710000 10                 TRA     s:10901+3

     1640    10896    5               IF CSTAT.SETS.PSN(I)=OPNSN.SN#(0) THEN DO;

  10896 10 007425   001076 235000 0                  LDA     I
        10 007426   000003 735000                    ALS     3
        10 007427   040000 106405                    CMPC    fill='040'O
        10 007430   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6
        10 007431   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 007432   007450 601000 10                 TNZ     s:10901

     1641    10897    5                  CSTAT.SETS(I)=CSTAT.SETS(NUMPSNS);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:333  
  10897 10 007433   001076 236000 0                  LDQ     I
        10 007434   000001 736000                    QLS     1
        10 007435   004621 235000 0                  LDA     CSTAT
        10 007436   000003 735000                    ALS     3
        10 007437   000002 736000                    QLS     2
        10 007440   000006 100405                    MLR     fill='000'O
        10 007441   004623 000010 0                  ADSC9   CSTAT+2,A                cn=0,n=8
        10 007442   004623 000010 0                  ADSC9   CSTAT+2,Q                cn=0,n=8

     1642    10898    5                  NUMPSNS=NUMPSNS-1;

  10898 10 007443   004621 235000 0                  LDA     CSTAT
        10 007444   000001 135007                    SBLA    1,DL
        10 007445   004621 755000 0                  STA     CSTAT

     1643    10899    5                  CALL CATWRITE;

  10899 10 007446   012372 701000 10                 TSX1    CATWRITE
        10 007447   000000 011000                    NOP     0

     1644    10900    5                  END;

     1645    10901    4               END;

  10901 10 007450   001076 235000 0                  LDA     I
        10 007451   000001 035007                    ADLA    1,DL
        10 007452   001076 755000 0                  STA     I
        10 007453   004621 236000 0                  LDQ     CSTAT
        10 007454   001076 116000 0                  CMPQ    I
        10 007455   007425 603000 10                 TRC     s:10896

     1646    10902    3            END;

     1647    10903    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10903 10 007456   000100 630400 0                  EPPR0   OPNDP
        10 007457   450000 713400                    CLIMB   alt,open
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:334  
        10 007460   410400 401760                    pmme    nvectors=18
        10 007461   013551 702000 10                 TSX2    DPERR

     1648    10904    2         CLSDP.V.DISP#=%SETDSMT#;

  10904 10 007462   000013 236007                    LDQ     11,DL
        10 007463   000224 552004 0                  STBQ    CLSDP+26,'04'O

     1649    10905    2         IF OUT$BLK.NSUBLKS>2 THEN CLSDP.V.DISP#=

  10905 10 007464   001073 470400 0                  LDP0    BLK$
        10 007465   000001 220100                    LDX0    1,,PR0
        10 007466   000003 100003                    CMPX0   3,DU
        10 007467   007473 602000 10                 TNC     s:10907

  10905 10 007470   000005 471500                    LDP1    5,,PR0
        10 007471   100000 236100                    LDQ     0,,PR1
        10 007472   000224 552004 0                  STBQ    CLSDP+26,'04'O

     1650    10906    2           OUT$BLK.SUBLK$(2)->OUT$BLK.CODE;
     1651    10907    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);

  10907 10 007473   000172 630400 0                  EPPR0   CLSDP
        10 007474   450001 713400                    CLIMB   alt,close
        10 007475   406000 401760                    pmme    nvectors=13
        10 007476   013551 702000 10                 TSX2    DPERR

     1652    10908    2         CODE=0;

  10908 10 007477   200007 450100                    STZ     CODE,,AUTO

     1653    10909    2         X9=F$DCB.SETX;

  10909 10 007500   000000 470400 xsym               LDP0    M$DP$
        10 007501   000051 236100                    LDQ     41,,PR0
        10 007502   777777 376007                    ANQ     -1,DL
        10 007503   200006 756100                    STQ     X9,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:335  

     1654    10910    3         IF MODE=0 THEN DO;

  10910 10 007504   001121 235000 0                  LDA     MODE
        10 007505   011257 601000 10                 TNZ     s:11238

     1655    10911    3            CALL M$WAIT(WAIT1);

  10911 10 007506   000026 630400 2                  EPPR0   WAIT1
        10 007507   020006 713400                    CLIMB   8198
        10 007510   400400 401760                    pmme    nvectors=2

     1656    10912    3            GOTO DISPS0;

  10912 10 007511   003203 710000 10                 TRA     DISPS0

     1657    10913    3            END;
     1658    10914        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:336  
     1659    10915    2      CASE(%(E$DEFAULT-E$PIGH));

     1660    10916                    /*E*     ERROR: FXP-E$DEFAULT-0
     1661    10917                    *        MESSAGE:DEFault Build options - sets options for Build command
     1662    10918                  *       DEFault DP#set [options] - modifies/lists PADFIT, type Help Build
     1663    10919                  *       DEFault Mount [{NONE|PUbl|SHared}] - default for uncataloged sets
     1664    10920                    */
     1665    10921    2         SELACCT=' ';

  10921 10 007512   000035 235000 xsym               LDA     B_VECTNIL+29
        10 007513   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 007514   001006 757000 0                  STAQ    SELACCT

     1666    10922    2         X9=OUT$BLK.SUBLK$(1)->OUT$BLK.CODE;

  10922 10 007515   001073 470400 0                  LDP0    BLK$
        10 007516   000004 471500                    LDP1    4,,PR0
        10 007517   100000 236100                    LDQ     0,,PR1
        10 007520   777777 376007                    ANQ     -1,DL
        10 007521   200006 756100                    STQ     X9,,AUTO

     1667    10923    3         IF X9=%E$PSN THEN DO;

  10923 10 007522   000106 116007                    CMPQ    70,DL
        10 007523   007535 601000 10                 TNZ     s:10928

     1668    10924    3            CALL M$OPEN(OPNDP)ALTRET(NOALT);

  10924 10 007524   000100 630400 0                  EPPR0   OPNDP
        10 007525   450000 713400                    CLIMB   alt,open
        10 007526   410400 401760                    pmme    nvectors=18
        10 007527   014123 702000 10                 TSX2    NOALT

     1669    10925    3            IF OUT$BLK.NSUBLKS=2 THEN GOTO LISTNXT0;

  10925 10 007530   001073 470400 0                  LDP0    BLK$
        10 007531   000001 220100                    LDX0    1,,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:337  
        10 007532   000002 100003                    CMPX0   2,DU
        10 007533   004666 600000 10                 TZE     LISTNXT0

     1670    10926    3            GOTO OPNACCT;

  10926 10 007534   004505 710000 10                 TRA     OPNACCT

     1671    10927    3            END;
     1672    10928    3         ELSE IF X9=%E$MOUNT THEN DO;

  10928 10 007535   000155 116007                    CMPQ    109,DL
        10 007536   007641 601000 10                 TNZ     s:10949

     1673    10929    3            I=0;

  10929 10 007537   001076 450000 0                  STZ     I

     1674    10930    3            CALL CATREAD;

  10930 10 007540   012341 701000 10                 TSX1    CATREAD
        10 007541   000000 011000                    NOP     0

     1675    10931    4            IF OUT$BLK.NSUBLKS>=3 THEN DO;

  10931 10 007542   001073 470400 0                  LDP0    BLK$
        10 007543   000001 220100                    LDX0    1,,PR0
        10 007544   000003 100003                    CMPX0   3,DU
        10 007545   007560 602000 10                 TNC     s:10936

     1676    10932    4               CSTAT.DEFMOUNT=OUT$BLK.SUBLK$(2)->OUT$BLK.CODE;

  10932 10 007546   000005 471500                    LDP1    5,,PR0
        10 007547   100000 236100                    LDQ     0,,PR1
        10 007550   777777 376007                    ANQ     -1,DL
        10 007551   004622 756000 0                  STQ     CSTAT+1

     1677    10933    4               IF CSTAT.DEFMOUNT>10 THEN CSTAT.DEFMOUNT=0;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:338  

  10933 10 007552   000013 116007                    CMPQ    11,DL
        10 007553   007555 602000 10                 TNC     s:10934

  10933 10 007554   004622 450000 0                  STZ     CSTAT+1

     1678    10934    4               CALL CATWRITE;

  10934 10 007555   012372 701000 10                 TSX1    CATWRITE
        10 007556   000000 011000                    NOP     0

     1679    10935    4               END;

  10935 10 007557   007632 710000 10                 TRA     s:10946

     1680    10936    4            ELSE DO CASE(CSTAT.DEFMOUNT);

  10936 10 007560   004622 235000 0                  LDA     CSTAT+1
        10 007561   000013 115007                    CMPA    11,DL
        10 007562   007564 602005 10                 TNC     s:10936+4,AL
        10 007563   007632 710000 10                 TRA     s:10946
        10 007564   007577 710000 10                 TRA     s:10938
        10 007565   007632 710000 10                 TRA     s:10946
        10 007566   007632 710000 10                 TRA     s:10946
        10 007567   007632 710000 10                 TRA     s:10946
        10 007570   007632 710000 10                 TRA     s:10946
        10 007571   007632 710000 10                 TRA     s:10946
        10 007572   007632 710000 10                 TRA     s:10946
        10 007573   007632 710000 10                 TRA     s:10946
        10 007574   007624 710000 10                 TRA     s:10944
        10 007575   007615 710000 10                 TRA     s:10942
        10 007576   007606 710000 10                 TRA     s:10940

     1681    10937    4            CASE(0);

     1682    10938    4               CALL ADDPART(4,'NONE');

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:339  
  10938 10 007577   000134 236000 11                 LDQ     92
        10 007600   201336 756100                    STQ     K+1,,AUTO
        10 007601   000007 236000 11                 LDQ     7
        10 007602   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 007603   014145 701000 10                 TSX1    ADDPART
        10 007604   000000 011000                    NOP     0
        10 007605   007632 710000 10                 TRA     s:10946

     1683    10939    4            CASE(%SETXCL#);

     1684    10940    4               CALL ADDPART(9,'EXCLUSIVE');

  10940 10 007606   000135 236000 11                 LDQ     93
        10 007607   201336 756100                    STQ     K+1,,AUTO
        10 007610   000112 236000 11                 LDQ     74
        10 007611   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 007612   014145 701000 10                 TSX1    ADDPART
        10 007613   000000 011000                    NOP     0
        10 007614   007632 710000 10                 TRA     s:10946

     1685    10941    4            CASE(%SETPRIV#);

     1686    10942    4               CALL ADDPART(6,'SHARED');

  10942 10 007615   000136 236000 11                 LDQ     94
        10 007616   201336 756100                    STQ     K+1,,AUTO
        10 007617   000035 236000 11                 LDQ     29
        10 007620   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 007621   014145 701000 10                 TSX1    ADDPART
        10 007622   000000 011000                    NOP     0
        10 007623   007632 710000 10                 TRA     s:10946

     1687    10943    4            CASE(%SETPUB#);

     1688    10944    4               CALL ADDPART(6,'PUBLIC');

  10944 10 007624   000137 236000 11                 LDQ     95
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:340  
        10 007625   201336 756100                    STQ     K+1,,AUTO
        10 007626   000035 236000 11                 LDQ     29
        10 007627   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 007630   014145 701000 10                 TSX1    ADDPART
        10 007631   000000 011000                    NOP     0

     1689    10945    4            END;

     1690    10946    3            IF I~=0 THEN CALL ERROR(10);

  10946 10 007632   001076 235000 0                  LDA     I
        10 007633   011257 600000 10                 TZE     s:11238

  10946 10 007634   000016 236000 11                 LDQ     14
        10 007635   201341 756100                    STQ     P$+2,,AUTO
        10 007636   011704 701000 10                 TSX1    ERROR
        10 007637   000000 011000                    NOP     0

     1691    10947    3            END;

  10947 10 007640   011257 710000 10                 TRA     s:11238

     1692    10948    3         ELSE DO;

     1693    10949    3            X9=0;

  10949 10 007641   200006 450100                    STZ     X9,,AUTO

     1694    10950    4            DO WHILE (I<OUT$BLK.NSUBLKS);

  10950 10 007642   000001 236100                    LDQ     1,,PR0
        10 007643   000022 772000                    QRL     18
        10 007644   001076 116000 0                  CMPQ    I
        10 007645   007662 602000 10                 TNC     s:10954
        10 007646   007662 600000 10                 TZE     s:10954

     1695    10951    4               CALL GET_OPTIONS ALTRET(TOOMANY);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:341  

  10951 10 007647   014573 701000 10                 TSX1    GET_OPTIONS
        10 007650   014015 702000 10                 TSX2    TOOMANY

     1696    10952    4               I=I+1;

  10952 10 007651   001076 235000 0                  LDA     I
        10 007652   000001 035007                    ADLA    1,DL
        10 007653   001076 755000 0                  STA     I

     1697    10953    4               END;

  10953 10 007654   001073 470400 0                  LDP0    BLK$
        10 007655   000001 236100                    LDQ     1,,PR0
        10 007656   000022 772000                    QRL     18
        10 007657   001076 116000 0                  CMPQ    I
        10 007660   007662 600000 10                 TZE     s:10954
        10 007661   007647 603000 10                 TRC     s:10951

     1698    10954    3            CODE14.ACCESS.LIST=(FIT09.NDW~=0);

  10954 10 007662   400000 220003                    LDX0    -131072,DU
        10 007663   001420 236000 0                  LDQ     FIT09
        10 007664   000132 316000 11                 CANQ    90
        10 007665   007667 601000 10                 TNZ     s:10954+5
        10 007666   000000 220003                    LDX0    0,DU
        10 007667   000000 636010                    EAQ     0,X0
        10 007670   000001 772000                    QRL     1
        10 007671   001434 676000 0                  ERQ     CODE14
        10 007672   200000 376003                    ANQ     65536,DU
        10 007673   001434 656000 0                  ERSQ    CODE14

     1699    10955    3            FITSIZE=SIZEC(DEFAULT_BUILD);

  10955 10 007674   005514 235007                    LDA     2892,DL
        10 007675   002620 755000 0                  STA     FITSIZE

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:342  
     1700    10956    3            DEFAULT_BUILD=ADDR(PADBUF)->FITMOVER;

  10956 10 007676   000000 620005                    EAX0    0,AL
        10 007677   000100 100440                    MLR     fill='000'O
        10 007700   001410 000010 0                  ADSC9   PADBUF                   cn=0,n=*X0
        10 007701   200010 005514                    ADSC9   DEFAULT_BUILD,,AUTO      cn=0,n=2892

     1701    10957    3            GOTO LISTNXT1;

  10957 10 007702   004744 710000 10                 TRA     LISTNXT1

     1702    10958    3            END;
     1703    10959        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:343  
     1704    10960    2      CASE(%(E$RECON-E$PIGH),%(E$ACCOUNT-E$PIGH));

     1705    10961    2         IF CODE=%E$ACCOUNT THEN GAC=-1;

  10961 10 007703   200007 236100                    LDQ     CODE,,AUTO
        10 007704   000175 116007                    CMPQ    125,DL
        10 007705   007710 601000 10                 TNZ     s:10968

  10961 10 007706   000001 335007                    LCA     1,DL
        10 007707   000000 755000 xsym               STA     GAC

     1706    10962                    /*E*     ERROR: FXP-E$RECON-0
     1707    10963                    *        MESSAGE:REConstruct DP#set - rebuild free-space list
     1708    10964                    */
     1709    10965                    /*E*     ERROR: FXP-E$ACCOUNT-0
     1710    10966                    *        MESSAGE:ACcount DP#set - reconstruct with granule accounting
     1711    10967                    */
     1712    10968    2         OPNDP.FPARAM_=VECTOR(NIL);

  10968 10 007710   000024 237000 11                 LDAQ    20
        10 007711   000130 757000 0                  STAQ    OPNDP+24

     1713    10969    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);

  10969 10 007712   000640 630400 0                  EPPR0   DIAGFPT
        10 007713   420012 713400                    CLIMB   alt,+8202
        10 007714   400000 401760                    pmme    nvectors=1
        10 007715   014123 702000 10                 TSX2    NOALT

     1714    10970    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10970 10 007716   000100 630400 0                  EPPR0   OPNDP
        10 007717   450000 713400                    CLIMB   alt,open
        10 007720   410400 401760                    pmme    nvectors=18
        10 007721   013551 702000 10                 TSX2    DPERR

     1715    10971    2         IF NOT F$DCB.OWNER OR DIAGFPT.V.PRIV# THEN CALL ERROR(0);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:344  

  10971 10 007722   000000 470400 xsym               LDP0    M$DP$
        10 007723   000064 236100                    LDQ     52,,PR0
        10 007724   040000 316007                    CANQ    16384,DL
        10 007725   007730 600000 10                 TZE     s:10971+6
        10 007726   000642 235000 0                  LDA     DIAGFPT+2
        10 007727   007735 600000 10                 TZE     s:10973

  10971 10 007730   000113 236000 11                 LDQ     75
        10 007731   201341 756100                    STQ     P$+2,,AUTO
        10 007732   011704 701000 10                 TSX1    ERROR
        10 007733   000000 011000                    NOP     0
        10 007734   007751 710000 10                 TRA     s:10977

     1716    10972    3         ELSE DO;

     1717    10973    3            CALL CLOSE(DCBNUM(M$DP));

  10973 10 007735   000000 236007 xsym               LDQ     M$DP,DL
        10 007736   201370 756100                    STQ     BXP+19,,AUTO
        10 007737   201370 631500                    EPPR1   BXP+19,,AUTO
        10 007740   201341 451500                    STP1    P$+2,,AUTO
        10 007741   012416 701000 10                 TSX1    CLOSE
        10 007742   000000 011000                    NOP     0

     1718    10974    3            OPNDP.V.FUN#=%UPDATE#;

  10974 10 007743   001000 236007                    LDQ     512,DL
        10 007744   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1719    10975    3            CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10975 10 007745   000100 630400 0                  EPPR0   OPNDP
        10 007746   450000 713400                    CLIMB   alt,open
        10 007747   410400 401760                    pmme    nvectors=18
        10 007750   013551 702000 10                 TSX2    DPERR

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:345  
     1720    10976    3            END;

     1721    10977    2         CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);

  10977 10 007751   000634 630400 0                  EPPR0   PRIVFPT
        10 007752   420012 713400                    CLIMB   alt,+8202
        10 007753   400000 401760                    pmme    nvectors=1
        10 007754   014123 702000 10                 TSX2    NOALT

     1722    10978    2         CALL RECONST ALTRET(DPERR1);

  10978 10 007755   014324 701000 10                 TSX1    RECONST
        10 007756   013567 702000 10                 TSX2    DPERR1

     1723    10979    2         CALL M$CLOSE(CLSDP)ALTRET(NEXT);

  10979 10 007757   000172 630400 0                  EPPR0   CLSDP
        10 007760   450001 713400                    CLIMB   alt,close
        10 007761   406000 401760                    pmme    nvectors=13
        10 007762   000204 702000 10                 TSX2    NEXT
        10 007763   011257 710000 10                 TRA     s:11238

     1724    10980        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:346  
     1725    10981    2      CASE(%(E$COUNT-E$PIGH));

     1726    10982                    /*E*     ERROR: FXP-E$COUNT-0
     1727    10983                    *        MESSAGE:COunt DP#set - displays directory info
     1728    10984                    */
     1729    10985    2         OPNDP.FPARAM_=VECTOR(NIL);

  10985 10 007764   000024 237000 11                 LDAQ    20
        10 007765   000130 757000 0                  STAQ    OPNDP+24

     1730    10986    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);

  10986 10 007766   000640 630400 0                  EPPR0   DIAGFPT
        10 007767   420012 713400                    CLIMB   alt,+8202
        10 007770   400000 401760                    pmme    nvectors=1
        10 007771   014123 702000 10                 TSX2    NOALT

     1731    10987    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

  10987 10 007772   000100 630400 0                  EPPR0   OPNDP
        10 007773   450000 713400                    CLIMB   alt,open
        10 007774   410400 401760                    pmme    nvectors=18
        10 007775   013551 702000 10                 TSX2    DPERR

     1732    10988    2         CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);

  10988 10 007776   000634 630400 0                  EPPR0   PRIVFPT
        10 007777   420012 713400                    CLIMB   alt,+8202
        10 010000   400000 401760                    pmme    nvectors=1
        10 010001   014123 702000 10                 TSX2    NOALT

     1733    10989    2         CALL FXH$COUNT;

  10989 10 010002   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 010003   000000 701000 xent               TSX1    FXH$COUNT
        10 010004   000000 011000                    NOP     0

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:347  
     1734    10990    2         IF ERRCODE~='0'B THEN CALL RECONERE ALTRET(DPERR1);

  10990 10 010005   001074 235000 0                  LDA     ERRCODE
        10 010006   010011 600000 10                 TZE     s:10991

  10990 10 010007   014457 701000 10                 TSX1    RECONERE
        10 010010   013567 702000 10                 TSX2    DPERR1

     1735    10991    2         CALL M$CLOSE(CLSDP)ALTRET(NEXT);

  10991 10 010011   000172 630400 0                  EPPR0   CLSDP
        10 010012   450001 713400                    CLIMB   alt,close
        10 010013   406000 401760                    pmme    nvectors=13
        10 010014   000204 702000 10                 TSX2    NEXT
        10 010015   011257 710000 10                 TRA     s:11238

     1736    10992        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:348  
     1737    10993    2      CASE(%(E$MADLIST-E$PIGH));

  10991 10 010016                       MADLIST      null
     1738    10994                    /*E*     ERROR: FXP-E$MADLIST-0
     1739    10995                    *        MESSAGE:MADList {DP#set|.acct} - lists MAD entries
     1740    10996                    */
     1741    10997    2   MADLIST:;
     1742    10998    3         IF PROJAD.L~=0 AND PROJAD.PSN=' ' THEN DO;

  10998 10 010016   001127 236000 0                  LDQ     PROJAD
        10 010017   777000 316003                    CANQ    -512,DU
        10 010020   010030 600000 10                 TZE     s:11005
        10 010021   040000 106400                    CMPC    fill='040'O
        10 010022   001134 200006 0                  ADSC9   PROJAD+5                 cn=1,n=6
        10 010023   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 010024   010030 601000 10                 TNZ     s:11005

     1743    10999    3            FLAG=FXP$E$PROJPSN;

  10999 10 010025   000044 236000 2                  LDQ     FXP$E$PROJPSN
        10 010026   001107 756000 0                  STQ     FLAG

     1744    11000    3            GOTO DPERR1;

  11000 10 010027   013567 710000 10                 TRA     DPERR1

     1745    11001                    /*E*      ERROR: FXP-E$PROJPSN
     1746    11002                    *         MESSAGE:For a multi-set project, a setname is needed.
     1747    11003                    */
     1748    11004    3            END;
     1749    11005    2         IF B$JIT.PPRIV.PIGD THEN CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);

  11005 10 010030   000000 470400 xsym               LDP0    B$JIT$
        10 010031   000020 236100                    LDQ     16,,PR0
        10 010032   010000 316003                    CANQ    4096,DU
        10 010033   010040 600000 10                 TZE     s:11006

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:349  
  11005 10 010034   000634 630400 0                  EPPR0   PRIVFPT
        10 010035   420012 713400                    CLIMB   alt,+8202
        10 010036   400000 401760                    pmme    nvectors=1
        10 010037   014123 702000 10                 TSX2    NOALT

     1750    11006    2         I=0;

  11006 10 010040   001076 450000 0                  STZ     I

     1751    11007    3         DO WHILE('1'B);

     1752    11008    3            OPNSN.SN#(0)=' ';

  11008 10 010041   040000 100400                    MLR     fill='040'O
        10 010042   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 010043   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1753    11009    4            IF OUT$BLK.NSUBLKS~=0 THEN DO;

  11009 10 010044   001073 470400 0                  LDP0    BLK$
        10 010045   000001 220100                    LDX0    1,,PR0
        10 010046   010072 600000 10                 TZE     s:11014

     1754    11010    4               IF OUT$BLK.SUBLK$(1)->OUT$SYM.CODE~=0

  11010 10 010047   000004 471500                    LDP1    4,,PR0
        10 010050   100000 721100                    LXL1    0,,PR1
        10 010051   010061 600000 10                 TZE     s:11012

     1755    11011    4               THEN OPNSN.SN#(0)=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  11011 10 010052   100004 236100                    LDQ     4,,PR1
        10 010053   000033 772000                    QRL     27
        10 010054   000000 622006                    EAX2    0,QL
        10 010055   040000 100540                    MLR     fill='040'O
        10 010056   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        10 010057   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:350  
        10 010060   010072 710000 10                 TRA     s:11014

     1756    11012    4               ELSE IF SELACCT='?' THEN SELACCT=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  11012 10 010061   001006 237000 0                  LDAQ    SELACCT
        10 010062   000140 117000 11                 CMPAQ   96
        10 010063   010072 601000 10                 TNZ     s:11014

  11012 10 010064   100004 236100                    LDQ     4,,PR1
        10 010065   000033 772000                    QRL     27
        10 010066   000000 622006                    EAX2    0,QL
        10 010067   040000 100540                    MLR     fill='040'O
        10 010070   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        10 010071   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8

     1757    11013    4               END;

     1758    11014    3            CALL NXTACCT ALTRET(MADLX);

  11014 10 010072   012443 701000 10                 TSX1    NXTACCT
        10 010073   010246 702000 10                 TSX2    MADLX

     1759    11015    3            IF BREAK~=0 THEN GOTO MADLX;

  11015 10 010074   001125 235000 0                  LDA     BREAK
        10 010075   010246 601000 10                 TNZ     MADLX

     1760    11016    3            FLAG='0'B;

  11016 10 010076   001107 450000 0                  STZ     FLAG

     1761    11017    4            IF OPNSN.SN#(0)~=' ' OR F$DCB.PSN=' 'THEN DO;

  11017 10 010077   040000 106400                    CMPC    fill='040'O
        10 010100   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 010101   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 010102   010110 601000 10                 TNZ     s:11018
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:351  
        10 010103   000000 470400 xsym               LDP0    M$DP$
        10 010104   040000 106500                    CMPC    fill='040'O
        10 010105   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
        10 010106   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 010107   010122 601000 10                 TNZ     s:11022

     1762    11018    4               OPNSN.SN#(0)=' ';

  11018 10 010110   040000 100400                    MLR     fill='040'O
        10 010111   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 010112   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1763    11019    4               MADM.V.READ#='1'B;

  11019 10 010113   400000 236007                    LDQ     -131072,DL
        10 010114   000414 256000 0                  ORSQ    MADM+6

     1764    11020    4               CALL M$MADMUCK(MADM)ALTRET(NOALT);

  11020 10 010115   000406 630400 0                  EPPR0   MADM
        10 010116   460005 713400                    CLIMB   alt,+24581
        10 010117   401000 401760                    pmme    nvectors=3
        10 010120   014123 702000 10                 TSX2    NOALT

     1765    11021    4               END;

  11021 10 010121   010134 710000 10                 TRA     s:11024

     1766    11022    3            ELSE IF PROJAD.L=0 THEN OPNSN.SN#(0)=F$DCB.PSN;

  11022 10 010122   001127 236000 0                  LDQ     PROJAD
        10 010123   777000 316003                    CANQ    -512,DU
        10 010124   010131 601000 10                 TNZ     s:11023

  11022 10 010125   040000 100500                    MLR     fill='040'O
        10 010126   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
        10 010127   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:352  
        10 010130   010134 710000 10                 TRA     s:11024

     1767    11023    3            ELSE OPNSN.SN#(0)=PROJAD.PSN;

  11023 10 010131   040000 100400                    MLR     fill='040'O
        10 010132   001134 200006 0                  ADSC9   PROJAD+5                 cn=1,n=6
        10 010133   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1768    11024    3            IF CODE~=%E$MADLIST THEN IF FLAG THEN GOTO MADD1;

  11024 10 010134   200007 235100                    LDA     CODE,,AUTO
        10 010135   000165 115007                    CMPA    117,DL
        10 010136   010144 600000 10                 TZE     s:11027

  11024 10 010137   001107 236000 0                  LDQ     FLAG
        10 010140   010472 601000 10                 TNZ     MADD1

     1769    11025    3            ELSE IF CODE=%E$MODIFY THEN GOTO ACCTNXT;

  11025 10 010141   000154 115007                    CMPA    108,DL
        10 010142   004426 600000 10                 TZE     ACCTNXT

     1770    11026    3            ELSE GOTO LISTNXTM;

  11026 10 010143   004662 710000 10                 TRA     LISTNXTM

     1771    11027    4            IF SELACCT=' ' THEN DO;

  11027 10 010144   001006 237000 0                  LDAQ    SELACCT
        10 010145   000142 117000 11                 CMPAQ   98
        10 010146   010172 601000 10                 TNZ     s:11035

     1772    11028    4               IF FLAG THEN GOTO MADD1;

  11028 10 010147   001107 235000 0                  LDA     FLAG
        10 010150   010472 601000 10                 TNZ     MADD1

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:353  
     1773    11029    4               CALL ADDPART(8,VLP_ACCT.ACCT#);

  11029 10 010151   000130 236000 11                 LDQ     88
        10 010152   201336 756100                    STQ     K+1,,AUTO
        10 010153   000072 236000 11                 LDQ     58
        10 010154   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 010155   014145 701000 10                 TSX1    ADDPART
        10 010156   000000 011000                    NOP     0

     1774    11030    4               CALL ADDPARAM(%M#PSN);

  11030 10 010157   000033 236000 11                 LDQ     27
        10 010160   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 010161   014226 701000 10                 TSX1    ADDPARAM
        10 010162   000000 011000                    NOP     0

     1775    11031    4               CALL ADDPART(6,OPNSN.SN#(0));

  11031 10 010163   000144 236000 11                 LDQ     100
        10 010164   201336 756100                    STQ     K+1,,AUTO
        10 010165   000035 236000 11                 LDQ     29
        10 010166   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 010167   014145 701000 10                 TSX1    ADDPART
        10 010170   000000 011000                    NOP     0

     1776    11032    4               GOTO MADLX;

  11032 10 010171   010246 710000 10                 TRA     MADLX

     1777    11033    4               END;
     1778    11034    4            ELSE DO;

     1779    11035    5               IF I+15>=WIDTH THEN DO;

  11035 10 010172   001076 236000 0                  LDQ     I
        10 010173   000017 036007                    ADLQ    15,DL
        10 010174   001124 116000 0                  CMPQ    WIDTH
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:354  
        10 010175   010203 602000 10                 TNC     s:11039

     1780    11036    5                  CALL ERROR(10);

  11036 10 010176   000016 236000 11                 LDQ     14
        10 010177   201341 756100                    STQ     P$+2,,AUTO
        10 010200   011704 701000 10                 TSX1    ERROR
        10 010201   000000 011000                    NOP     0

     1781    11037    5                  I=0;

  11037 10 010202   001076 450000 0                  STZ     I

     1782    11038    5                  END;

     1783    11039    4               CALL INSERT(LBUFC,I,,'#',OPNSN.SN#(0),'.',VLP_ACCT.ACCT#);

  11039 10 010203   001076 720000 0                  LXL0    I
        10 010204   777607 620010                    EAX0    -121,X0
        10 010205   777777 660003                    ERX0    -1,DU
        10 010206   001076 235000 0                  LDA     I
        10 010207   040045 100400                    MLR     fill='040'O
        10 010210   000145 000001 11                 ADSC9   101                      cn=0,n=1
        10 010211   006702 000010 0                  ADSC9   LBUFC,A                  cn=0,n=*X0
        10 010212   001076 236000 0                  LDQ     I
        10 010213   000167 116007                    CMPQ    119,DL
        10 010214   010242 603000 10                 TRC     s:11040
        10 010215   777610 620006                    EAX0    -120,QL
        10 010216   777777 660003                    ERX0    -1,DU
        10 010217   040046 100400                    MLR     fill='040'O
        10 010220   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 010221   006702 200010 0                  ADSC9   LBUFC,Q                  cn=1,n=*X0
        10 010222   001076 236000 0                  LDQ     I
        10 010223   000161 116007                    CMPQ    113,DL
        10 010224   010242 603000 10                 TRC     s:11040
        10 010225   777616 620006                    EAX0    -114,QL
        10 010226   777777 660003                    ERX0    -1,DU
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:355  
        10 010227   040046 100400                    MLR     fill='040'O
        10 010230   000146 000001 11                 ADSC9   102                      cn=0,n=1
        10 010231   006703 600010 0                  ADSC9   LBUFC+1,Q                cn=3,n=*X0
        10 010232   001076 236000 0                  LDQ     I
        10 010233   000160 116007                    CMPQ    112,DL
        10 010234   010242 603000 10                 TRC     s:11040
        10 010235   777617 620006                    EAX0    -113,QL
        10 010236   777777 660003                    ERX0    -1,DU
        10 010237   040046 100400                    MLR     fill='040'O
        10 010240   000076 000010 0                  ADSC9   VLP_ACCT                 cn=0,n=8
        10 010241   006704 000010 0                  ADSC9   LBUFC+2,Q                cn=0,n=*X0

     1784    11040    4               I=I+17;

  11040 10 010242   001076 235000 0                  LDA     I
        10 010243   000021 035007                    ADLA    17,DL
        10 010244   001076 755000 0                  STA     I

     1785    11041    4               END;

     1786    11042    3            END;

  11042 10 010245   010041 710000 10                 TRA     s:11008

     1787    11043    2   MADLX: IF (CODE<%E$MODIFY OR CODE>%E$LIST+1 OR LBUFC=NONEMSG)

  11043 10 010246   200007 235100       MADLX        LDA     CODE,,AUTO
        10 010247   000154 115007                    CMPA    108,DL
        10 010250   010257 602000 10                 TNC     MADLX+9
        10 010251   000164 115007                    CMPA    116,DL
        10 010252   010257 603000 10                 TRC     MADLX+9
        10 010253   040000 106400                    CMPC    fill='040'O
        10 010254   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120
        10 010255   000311 000017 2                  ADSC9   NONEMSG                  cn=0,n=15
        10 010256   010267 601000 10                 TNZ     s:11048
        10 010257   001076 236000 0                  LDQ     I
        10 010260   010263 601000 10                 TNZ     s:11047
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:356  
        10 010261   001125 235000 0                  LDA     BREAK
        10 010262   010267 601000 10                 TNZ     s:11048

     1788    11044                    /* Nothing to say if MODIFY found something,
     1789    11045                       or break hit before anything happened. */
     1790    11046    2           AND (I~=0 OR BREAK=0)
     1791    11047    2         THEN CALL ERROR(10);

  11047 10 010263   000016 236000 11                 LDQ     14
        10 010264   201341 756100                    STQ     P$+2,,AUTO
        10 010265   011704 701000 10                 TSX1    ERROR
        10 010266   000000 011000                    NOP     0

     1792    11048    2         IF BREAK~=0 THEN GOTO CMDABORT;

  11048 10 010267   001125 235000 0                  LDA     BREAK
        10 010270   014002 601000 10                 TNZ     CMDABORT
        10 010271   011257 710000 10                 TRA     s:11238

     1793    11049        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:357  
     1794    11050    2      CASE(%(E$MADADD-E$PIGH));

     1795    11051                    /*E*     ERROR: FXP-E$MADADD-0
     1796    11052                    *        MESSAGE:MADAdd DP#set [.acct] - add MAD entries
     1797    11053                    */
     1798    11054    2         MADM.V.WRITE#='1'B;

  11054 10 010272   200000 236007                    LDQ     65536,DL
        10 010273   000414 256000 0                  ORSQ    MADM+6

     1799    11055    2         GOTO MADDA;

  11055 10 010274   010302 710000 10                 TRA     MADDA

     1800    11056    2      CASE(%(E$MADDEL-E$PIGH));

     1801    11057                    /*E*     ERROR: FXP-E$MADDEL-0
     1802    11058                    *        MESSAGE:MADDelete {DP#set [.acct]|.acct} - delete MAD entries
     1803    11059                    */
     1804    11060    2         MADM.V.DELETE#='1'B;

  11060 10 010275   100000 236007                    LDQ     32768,DL
        10 010276   000414 256000 0                  ORSQ    MADM+6

     1805    11061    2         OPNSN.SN#(0)=' ';

  11061 10 010277   040000 100400                    MLR     fill='040'O
        10 010300   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 010301   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

  11061 10 010302                       MADDA        null
     1806    11062    2   MADDA:;
     1807    11063    2         I=0;

  11063 10 010302   001076 450000 0                  STZ     I

     1808    11064    2         IF OUT$BLK.NSUBLKS>=3 THEN SELACCT=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:358  

  11064 10 010303   001073 470400 0                  LDP0    BLK$
        10 010304   000001 220100                    LDX0    1,,PR0
        10 010305   000003 100003                    CMPX0   3,DU
        10 010306   010316 602000 10                 TNC     s:11065

  11064 10 010307   000005 471500                    LDP1    5,,PR0
        10 010310   100004 236100                    LDQ     4,,PR1
        10 010311   000033 772000                    QRL     27
        10 010312   000000 621006                    EAX1    0,QL
        10 010313   040000 100540                    MLR     fill='040'O
        10 010314   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 010315   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8

     1809    11065    2         CODE=OUT$BLK.SUBLK$(1)->OUT$SYM.CODE;

  11065 10 010316   000004 471500                    LDP1    4,,PR0
        10 010317   100000 236100                    LDQ     0,,PR1
        10 010320   777777 376007                    ANQ     -1,DL
        10 010321   200007 756100                    STQ     CODE,,AUTO

     1810    11066    2         IF CODE=0 THEN SELACCT=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  11066 10 010322   010332 601000 10                 TNZ     s:11067

  11066 10 010323   000004 471500                    LDP1    4,,PR0
        10 010324   100004 236100                    LDQ     4,,PR1
        10 010325   000033 772000                    QRL     27
        10 010326   000000 620006                    EAX0    0,QL
        10 010327   040000 100540                    MLR     fill='040'O
        10 010330   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        10 010331   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8

     1811    11067    3         IF MADM.V.DELETE# AND CODE=0 AND SELACCT='?' THEN DO;/*THE WHOLE THING*/

  11067 10 010332   000414 236000 0                  LDQ     MADM+6
        10 010333   100000 316007                    CANQ    32768,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:359  
        10 010334   010400 600000 10                 TZE     s:11079
        10 010335   200007 235100                    LDA     CODE,,AUTO
        10 010336   010400 601000 10                 TNZ     s:11079
        10 010337   001006 237000 0                  LDAQ    SELACCT
        10 010340   000140 117000 11                 CMPAQ   96
        10 010341   010400 601000 10                 TNZ     s:11079

     1812    11068    3            CALL FXU$PROTCHK(0) ALTRET(CMDABORT);

  11068 10 010342   000113 630400 11                 EPPR0   75
        10 010343   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 010344   000000 701000 xent               TSX1    FXU$PROTCHK
        10 010345   014002 702000 10                 TSX2    CMDABORT

     1813    11069    3            GRANULE=3;

  11069 10 010346   000003 235007                    LDA     3,DL
        10 010347   001113 755000 0                  STA     GRANULE

     1814    11070    3            OPNSN.SN#(0)='SYS';

  11070 10 010350   040000 100400                    MLR     fill='040'O
        10 010351   000520 000003 2                  ADSC9   FFLGS+41                 cn=0,n=3
        10 010352   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1815    11071    3            OPNDP.V.FUN#=%UPDATE#;

  11071 10 010353   001000 236007                    LDQ     512,DL
        10 010354   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1816    11072    3            CALL M$OPEN(OPNDP)ALTRET(DPERR);

  11072 10 010355   000100 630400 0                  EPPR0   OPNDP
        10 010356   450000 713400                    CLIMB   alt,open
        10 010357   410400 401760                    pmme    nvectors=18
        10 010360   013551 702000 10                 TSX2    DPERR

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:360  
     1817    11073    3            VIDBUF=MADBUF;

  11073 10 010361   010000 220003                    LDX0    4096,DU
        10 010362   000040 100400                    MLR     fill='000'O
        10 010363   001275 000454 0                  ADSC9   MADBUF                   cn=0,n=300
        10 010364   002621 000010 0                  ADSC9   VIDBUF                   cn=0,n=*X0

     1818    11074    3            CALL M$WRITE(READVID)ALTRET(DPERR);

  11074 10 010365   000416 630400 0                  EPPR0   READVID
        10 010366   440001 713400                    CLIMB   alt,write
        10 010367   401400 401760                    pmme    nvectors=4
        10 010370   013551 702000 10                 TSX2    DPERR

     1819    11075    3            CALL CLOSE(DCBNUM(M$DP));

  11075 10 010371   000000 236007 xsym               LDQ     M$DP,DL
        10 010372   201371 756100                    STQ     BXP+20,,AUTO
        10 010373   201371 630500                    EPPR0   BXP+20,,AUTO
        10 010374   201341 450500                    STP0    P$+2,,AUTO
        10 010375   012416 701000 10                 TSX1    CLOSE
        10 010376   000000 011000                    NOP     0

     1820    11076    3            GOTO NEXT;

  11076 10 010377   000204 710000 10                 TRA     NEXT

     1821    11077    3            END;
     1822    11078    3         DO WHILE('1'B);

     1823    11079    3            CALL NXTACCT ALTRET(MADLX);

  11079 10 010400   012443 701000 10                 TSX1    NXTACCT
        10 010401   010246 702000 10                 TSX2    MADLX

     1824    11080    3            IF BREAK~=0 THEN GOTO MADLX;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:361  
  11080 10 010402   001125 235000 0                  LDA     BREAK
        10 010403   010246 601000 10                 TNZ     MADLX

     1825    11081    3            IF SELACCT=' ' AND CODE~=0

  11081 10 010404   001006 237000 0                  LDAQ    SELACCT
        10 010405   000142 117000 11                 CMPAQ   98
        10 010406   010423 601000 10                 TNZ     s:11083
        10 010407   200007 235100                    LDA     CODE,,AUTO
        10 010410   010423 600000 10                 TZE     s:11083

     1826    11082    3            THEN IF F$DCB.ACCT~=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT THEN GOTO MADLX;

  11082 10 010411   001073 470400 0                  LDP0    BLK$
        10 010412   000005 471500                    LDP1    5,,PR0
        10 010413   100004 236100                    LDQ     4,,PR1
        10 010414   000033 772000                    QRL     27
        10 010415   000000 473400 xsym               LDP3    M$DP$
        10 010416   000000 620006                    EAX0    0,QL
        10 010417   040140 106500                    CMPC    fill='040'O
        10 010420   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8
        10 010421   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        10 010422   010246 601000 10                 TNZ     MADLX

     1827    11083    4            IF CODE=0 OR F$DCB.PSN=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT THEN DO;

  11083 10 010423   200007 235100                    LDA     CODE,,AUTO
        10 010424   010437 600000 10                 TZE     s:11084
        10 010425   001073 470400 0                  LDP0    BLK$
        10 010426   000004 471500                    LDP1    4,,PR0
        10 010427   100004 236100                    LDQ     4,,PR1
        10 010430   000033 772000                    QRL     27
        10 010431   000000 473400 xsym               LDP3    M$DP$
        10 010432   000000 620006                    EAX0    0,QL
        10 010433   040140 106500                    CMPC    fill='040'O
        10 010434   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
        10 010435   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:362  
        10 010436   010400 601000 10                 TNZ     s:11079

     1828    11084    4               CALL M$MADMUCK(MADM)ALTRET(MADD1);

  11084 10 010437   000406 630400 0                  EPPR0   MADM
        10 010440   460005 713400                    CLIMB   alt,+24581
        10 010441   401000 401760                    pmme    nvectors=3
        10 010442   010472 702000 10                 TSX2    MADD1

     1829    11085    4               IF SELACCT=' ' THEN GOTO NEXT;

  11085 10 010443   001006 237000 0                  LDAQ    SELACCT
        10 010444   000142 117000 11                 CMPAQ   98
        10 010445   000204 600000 10                 TZE     NEXT

     1830    11086    5               IF I+7>=WIDTH THEN DO;

  11086 10 010446   001076 236000 0                  LDQ     I
        10 010447   000007 036007                    ADLQ    7,DL
        10 010450   001124 116000 0                  CMPQ    WIDTH
        10 010451   010457 602000 10                 TNC     s:11090

     1831    11087    5                  CALL ERROR(10);

  11087 10 010452   000016 236000 11                 LDQ     14
        10 010453   201341 756100                    STQ     P$+2,,AUTO
        10 010454   011704 701000 10                 TSX1    ERROR
        10 010455   000000 011000                    NOP     0

     1832    11088    5                  I=0;

  11088 10 010456   001076 450000 0                  STZ     I

     1833    11089    5                  END;

     1834    11090    4               CALL INSERT(LBUFC,I,,VLP_ACCT.ACCT#);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:363  
  11090 10 010457   001076 720000 0                  LXL0    I
        10 010460   777607 620010                    EAX0    -121,X0
        10 010461   777777 660003                    ERX0    -1,DU
        10 010462   001076 235000 0                  LDA     I
        10 010463   040045 100400                    MLR     fill='040'O
        10 010464   000076 000010 0                  ADSC9   VLP_ACCT                 cn=0,n=8
        10 010465   006702 000010 0                  ADSC9   LBUFC,A                  cn=0,n=*X0

     1835    11091    4               I=I+9;

  11091 10 010466   001076 235000 0                  LDA     I
        10 010467   000011 035007                    ADLA    9,DL
        10 010470   001076 755000 0                  STA     I

     1836    11092    4               END;

     1837    11093    3            END;

  11093 10 010471   010400 710000 10                 TRA     s:11079

  11089 10 010472                       MADD1        null
     1838    11094    2   MADD1:;
     1839    11095    2         FLAG=B$ALT.ERR;

  11095 10 010472   000000 470400 xsym               LDP0    B$TCB$
        10 010473   000000 471500                    LDP1    0,,PR0
        10 010474   100102 236100                    LDQ     66,,PR1
        10 010475   001107 756000 0                  STQ     FLAG

     1840    11096    2         IF FLAG.CODE=%E$NOKEY THEN GOTO MADLX;

  11096 10 010476   001107 236000 0                  LDQ     FLAG
        10 010477   377770 376007                    ANQ     131064,DL
        10 010500   001020 116007                    CMPQ    528,DL
        10 010501   010246 600000 10                 TZE     MADLX

     1841    11097    2         FLAG.SEV=7;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:364  

  11097 10 010502   000007 236007                    LDQ     7,DL
        10 010503   001107 256000 0                  ORSQ    FLAG

     1842    11098    2         IF I~=0 THEN CALL ERROR(10);

  11098 10 010504   001076 235000 0                  LDA     I
        10 010505   010512 600000 10                 TZE     s:11099

  11098 10 010506   000016 236000 11                 LDQ     14
        10 010507   201341 756100                    STQ     P$+2,,AUTO
        10 010510   011704 701000 10                 TSX1    ERROR
        10 010511   000000 011000                    NOP     0

     1843    11099    2         GOTO DPERR1;

  11099 10 010512   013567 710000 10                 TRA     DPERR1

     1844    11100        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:365  
     1845    11101    2      CASE(%(E$CATALOG-E$PIGH),%(E$CATDEL-E$PIGH),%(E$CATMOD-E$PIGH));

     1846    11102    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);

  11102 10 010513   000640 630400 0                  EPPR0   DIAGFPT
        10 010514   420012 713400                    CLIMB   alt,+8202
        10 010515   400000 401760                    pmme    nvectors=1
        10 010516   014123 702000 10                 TSX2    NOALT

     1847    11103    2         CALL FXU$CATADM(CODE)ALTRET(CATERR);

  11103 10 010517   200007 630500                    EPPR0   CODE,,AUTO
        10 010520   201346 450500                    STP0    BXP+1,,AUTO
        10 010521   201346 630500                    EPPR0   BXP+1,,AUTO
        10 010522   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 010523   000000 701000 xent               TSX1    FXU$CATADM
        10 010524   010554 702000 10                 TSX2    CATERR
        10 010525   011257 710000 10                 TRA     s:11238

     1848    11104    2      CASE(%(E$CATLIST-E$PIGH));

     1849    11105    2         IF B$JIT.PPRIV.PIGD THEN CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);

  11105 10 010526   000000 470400 xsym               LDP0    B$JIT$
        10 010527   000020 236100                    LDQ     16,,PR0
        10 010530   010000 316003                    CANQ    4096,DU
        10 010531   010536 600000 10                 TZE     s:11106

  11105 10 010532   000634 630400 0                  EPPR0   PRIVFPT
        10 010533   420012 713400                    CLIMB   alt,+8202
        10 010534   400000 401760                    pmme    nvectors=1
        10 010535   014123 702000 10                 TSX2    NOALT

     1850    11106    2         CALL M$SPRIV(DIAGFPT)ALTRET(NOALT);

  11106 10 010536   000640 630400 0                  EPPR0   DIAGFPT
        10 010537   420012 713400                    CLIMB   alt,+8202
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:366  
        10 010540   400000 401760                    pmme    nvectors=1
        10 010541   014123 702000 10                 TSX2    NOALT

     1851    11107    2         I=0;

  11107 10 010542   001076 450000 0                  STZ     I

     1852    11108    2         I0=0;

  11108 10 010543   001077 450000 0                  STZ     I0

     1853    11109    2         CALL FXU$CATL ALTRET(CATERR);

  11109 10 010544   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 010545   000000 701000 xent               TSX1    FXU$CATL
        10 010546   010554 702000 10                 TSX2    CATERR

     1854    11110    2         CALL ERROR(10);

  11110 10 010547   000016 236000 11                 LDQ     14
        10 010550   201341 756100                    STQ     P$+2,,AUTO
        10 010551   011704 701000 10                 TSX1    ERROR
        10 010552   000000 011000                    NOP     0

     1855    11111    2         GOTO NEXT;

  11111 10 010553   000204 710000 10                 TRA     NEXT

     1856    11112    2   CATERR: FLAG=ERRCODE;

  11112 10 010554   001074 236000 0     CATERR       LDQ     ERRCODE
        10 010555   001107 756000 0                  STQ     FLAG

     1857    11113    2         FLAG.SEV=7;

  11113 10 010556   000007 236007                    LDQ     7,DL
        10 010557   001107 256000 0                  ORSQ    FLAG
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:367  

     1858    11114    2         EFPT.V.DCB#=DCBNUM(M$CAT);

  11114 10 010560   000000 236007 xsym               LDQ     M$CAT,DL
        10 010561   000000 620006                    EAX0    0,QL
        10 010562   000346 740000 0                  STX0    EFPT+22

     1859    11115    2         GOTO DPERR1;

  11115 10 010563   013567 710000 10                 TRA     DPERR1

     1860    11116        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:368  
     1861    11117    2      CASE(%(E$FIX-E$PIGH));

     1862    11118                    /*E*     ERROR: FXP-E$FIX-0
     1863    11119                    *        MESSAGE:FIX is not yet implemented.
     1864    11120                    */
     1865    11121    2         VLP_ACCT.ACCT#=' ';

  11121 10 010564   000035 235000 xsym               LDA     B_VECTNIL+29
        10 010565   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 010566   000076 757000 0                  STAQ    VLP_ACCT

     1866    11122    2         OPNDP.FPARAM_=VECTOR(NIL);

  11122 10 010567   000024 237000 11                 LDAQ    20
        10 010570   000130 757000 0                  STAQ    OPNDP+24

     1867    11123    3         IF NOT B$JIT.PRIV.AUTH.FMDIAG THEN DO;

  11123 10 010571   000000 470400 xsym               LDP0    B$JIT$
        10 010572   000014 236100                    LDQ     12,,PR0
        10 010573   040000 316003                    CANQ    16384,DU
        10 010574   010600 601000 10                 TNZ     s:11127

     1868    11124    3            FLAG=FMN$E$NOTAUTH;

  11124 10 010575   000040 236000 2                  LDQ     FMN$E$NOTAUTH
        10 010576   001107 756000 0                  STQ     FLAG

     1869    11125    3            GOTO DPERR1;

  11125 10 010577   013567 710000 10                 TRA     DPERR1

     1870    11126    3            END;
     1871    11127    3         IF OPNSN.SN#(0)=' ' THEN DO;

  11127 10 010600   040000 106400                    CMPC    fill='040'O
        10 010601   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:369  
        10 010602   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 010603   010655 601000 10                 TNZ     s:11139

     1872    11128    3            IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE~=0

  11128 10 010604   001073 471400 0                  LDP1    BLK$
        10 010605   100004 473500                    LDP3    4,,PR1
        10 010606   300000 720100                    LXL0    0,,PR3
        10 010607   010625 600000 10                 TZE     s:11132

     1873    11129    3            THEN CALL CONCAT(OPNSN.SN#(0),BINASC(4),'DP',

  11129 10 010610   100005 474500                    LDP4    5,,PR1
        10 010611   400004 236100                    LDQ     4,,PR4
        10 010612   000033 772000                    QRL     27
        10 010613   000000 621006                    EAX1    0,QL
        10 010614   004000 236003                    LDQ     2048,DU
        10 010615   000073 552040 0                  STBQ    OPNSN+1,'40'O
        10 010616   000544 236000 2                  LDQ     FFLGS+61
        10 010617   000011 772000                    QRL     9
        10 010620   000073 552030 0                  STBQ    OPNSN+1,'30'O
        10 010621   040000 100540                    MLR     fill='040'O
        10 010622   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
        10 010623   000073 600003 0                  ADSC9   OPNSN+1                  cn=3,n=3
        10 010624   010652 710000 10                 TRA     s:11137

     1874    11130    3              OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT);
     1875    11131    4            ELSE DO;

     1876    11132    4               CALL CHARBIN(ADDR(OPNSN.SN#(0))->BASED_UBIN,

  11132 10 010625   300004 236100                    LDQ     4,,PR3
        10 010626   000033 772000                    QRL     27
        10 010627   000000 621006                    EAX1    0,QL
        10 010630   000100 305540                    DTB
        10 010631   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
        10 010632   201346 000010                    NDSC9   BXP+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:370  
        10 010633   201347 236100                    LDQ     BXP+2,,AUTO
        10 010634   000073 756000 0                  STQ     OPNSN+1

     1877    11133    4                 OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);
     1878    11134    4               IF OUT$BLK.NSUBLKS=3 THEN CALL INSERT(OPNSN.SN#(0),0,1,

  11134 10 010635   100001 220100                    LDX0    1,,PR1
        10 010636   000003 100003                    CMPX0   3,DU
        10 010637   010652 601000 10                 TNZ     s:11137

  11134 10 010640   100005 473500                    LDP3    5,,PR1
        10 010641   300004 236100                    LDQ     4,,PR3
        10 010642   000033 772000                    QRL     27
        10 010643   300004 236100                    LDQ     4,,PR3
        10 010644   000022 772000                    QRL     18
        10 010645   000777 376007                    ANQ     511,DL
        10 010646   000100 136007                    SBLQ    64,DL
        10 010647   000033 736000                    QLS     27
        10 010650   000010 276000 11                 ORQ     8
        10 010651   000073 552040 0                  STBQ    OPNSN+1,'40'O

     1879    11135    4                 BINASC(ASCBIN(OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT)-ASCBIN('@')));
     1880    11136    4               END;

     1881    11137    3            CODE=4; /* ALWAYS VID */

  11137 10 010652   000004 235007                    LDA     4,DL
        10 010653   200007 755100                    STA     CODE,,AUTO

     1882    11138    3            END;

  11138 10 010654   010731 710000 10                 TRA     s:11149

     1883    11139    3         ELSE DO WHILE(I<OUT$BLK.NSUBLKS);

  11139 10 010655   001073 471400 0                  LDP1    BLK$
        10 010656   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:371  
        10 010657   000022 772000                    QRL     18
        10 010660   001076 116000 0                  CMPQ    I
        10 010661   010731 602000 10                 TNC     s:11149
        10 010662   010731 600000 10                 TZE     s:11149

     1884    11140    4            IF OUT$BLK.SUBLK$(I)->OUT$BLK.CODE=%E$FIX THEN DO;

  11140 10 010663   001073 470400 0                  LDP0    BLK$
        10 010664   001076 720000 0                  LXL0    I
        10 010665   000003 471510                    LDP1    3,X0,PR0
        10 010666   100000 721100                    LXL1    0,,PR1
        10 010667   000176 101003                    CMPX1   126,DU
        10 010670   010705 601000 10                 TNZ     s:11144

     1885    11141    4               VLP_NAME.L#=OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;

  11141 10 010671   100003 473500                    LDP3    3,,PR1
        10 010672   300004 236100                    LDQ     4,,PR3
        10 010673   000624 552040 0                  STBQ    VLP_NAME,'40'O

     1886    11142    4               VLP_NAME.NAME#=OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11142 10 010674   000003 471510                    LDP1    3,X0,PR0
        10 010675   100003 473500                    LDP3    3,,PR1
        10 010676   300004 236100                    LDQ     4,,PR3
        10 010677   000033 772000                    QRL     27
        10 010700   000000 621006                    EAX1    0,QL
        10 010701   040000 100540                    MLR     fill='040'O
        10 010702   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
        10 010703   000624 200037 0                  ADSC9   VLP_NAME                 cn=1,n=31

     1887    11143    4               END;

  11143 10 010704   010710 710000 10                 TRA     s:11145

     1888    11144    3            ELSE CODE=OUT$BLK.SUBLK$(I)->OUT$BLK.CODE;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:372  
  11144 10 010705   100000 236100                    LDQ     0,,PR1
        10 010706   777777 376007                    ANQ     -1,DL
        10 010707   200007 756100                    STQ     CODE,,AUTO

     1889    11145    3            IF OUT$BLK.SUBLK$(I)->OUT$BLK.CODE=0

  11145 10 010710   000003 471510                    LDP1    3,X0,PR0
        10 010711   100000 721100                    LXL1    0,,PR1
        10 010712   010721 601000 10                 TNZ     s:11147

     1890    11146    3            THEN VLP_ACCT.ACCT#=OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT;

  11146 10 010713   100004 236100                    LDQ     4,,PR1
        10 010714   000033 772000                    QRL     27
        10 010715   000000 622006                    EAX2    0,QL
        10 010716   040000 100540                    MLR     fill='040'O
        10 010717   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        10 010720   000076 000010 0                  ADSC9   VLP_ACCT                 cn=0,n=8

     1891    11147    3            I=I+1;

  11147 10 010721   001076 235000 0                  LDA     I
        10 010722   000001 035007                    ADLA    1,DL
        10 010723   001076 755000 0                  STA     I

     1892    11148    3            END;

  11148 10 010724   000001 236100                    LDQ     1,,PR0
        10 010725   000022 772000                    QRL     18
        10 010726   001076 116000 0                  CMPQ    I
        10 010727   010731 600000 10                 TZE     s:11149
        10 010730   010663 603000 10                 TRC     s:11140

     1893    11149    3         IF B$JIT.PRIV.JOB.FMDIAG THEN DO;

  11149 10 010731   000000 470400 xsym               LDP0    B$JIT$
        10 010732   000015 236100                    LDQ     13,,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:373  
        10 010733   040000 316003                    CANQ    16384,DU
        10 010734   010745 600000 10                 TZE     s:11154

     1894    11150    3            OPNFIL.V.FUN#=%UPDATE#;

  11150 10 010735   001000 236007                    LDQ     512,DL
        10 010736   000577 552010 0                  STBQ    OPNFIL+37,'10'O

     1895    11151    3            OPNDP.V.FUN#=%UPDATE#;

  11151 10 010737   000145 552010 0                  STBQ    OPNDP+37,'10'O

     1896    11152    3            CALL M$SPRIV(PRIVFPT)ALTRET(NOALT);

  11152 10 010740   000634 630400 0                  EPPR0   PRIVFPT
        10 010741   420012 713400                    CLIMB   alt,+8202
        10 010742   400000 401760                    pmme    nvectors=1
        10 010743   014123 702000 10                 TSX2    NOALT

     1897    11153    3            END;

  11153 10 010744   010747 710000 10                 TRA     s:11155

     1898    11154    2         ELSE OPNFIL.V.FUN#=%IN#;

  11154 10 010745   002000 236007                    LDQ     1024,DL
        10 010746   000577 552010 0                  STBQ    OPNFIL+37,'10'O

     1899    11155    3         DO CASE(CODE);

  11155 10 010747   200007 235100                    LDA     CODE,,AUTO
        10 010750   000005 115007                    CMPA    5,DL
        10 010751   010753 602005 10                 TNC     s:11155+4,AL
        10 010752   010771 710000 10                 TRA     s:11160
        10 010753   010771 710000 10                 TRA     s:11160
        10 010754   010760 710000 10                 TRA     s:11157
        10 010755   010760 710000 10                 TRA     s:11157
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:374  
        10 010756   010760 710000 10                 TRA     s:11157
        10 010757   010760 710000 10                 TRA     s:11157

     1900    11156    3         CASE(1,2,3,4);

     1901    11157    3            CALL M$OPEN(OPNDP)ALTRET(DPERR);

  11157 10 010760   000100 630400 0                  EPPR0   OPNDP
        10 010761   450000 713400                    CLIMB   alt,open
        10 010762   410400 401760                    pmme    nvectors=18
        10 010763   013551 702000 10                 TSX2    DPERR

     1902    11158    3            IF CODE=4 THEN CODE=0;

  11158 10 010764   200007 235100                    LDA     CODE,,AUTO
        10 010765   000004 115007                    CMPA    4,DL
        10 010766   011020 601000 10                 TNZ     s:11169

  11158 10 010767   200007 450100                    STZ     CODE,,AUTO
        10 010770   011020 710000 10                 TRA     s:11169

     1903    11159    3         CASE(ELSE);

     1904    11160    3            FLAG='0'B;

  11160 10 010771   001107 450000 0                  STZ     FLAG

     1905    11161    3            CALL M$OPEN(OPNFIL)ALTRET(NOALT);

  11161 10 010772   000532 630400 0                  EPPR0   OPNFIL
        10 010773   450000 713400                    CLIMB   alt,open
        10 010774   410400 401760                    pmme    nvectors=18
        10 010775   014123 702000 10                 TSX2    NOALT

     1906    11162    3            IF FLAG AND VLP_NAME THEN GOTO DPERR;

  11162 10 010776   001107 235000 0                  LDA     FLAG
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:375  
        10 010777   011004 600000 10                 TZE     s:11163
        10 011000   000000 106400                    CMPC    fill='000'O
        10 011001   000624 000040 0                  ADSC9   VLP_NAME                 cn=0,n=32
        10 011002   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
        10 011003   013551 601000 10                 TNZ     DPERR

     1907    11163    3            IF NOT FLAG THEN CODE=0;

  11163 10 011004   000000 115003                    CMPA    0,DU
        10 011005   011010 601000 10                 TNZ     s:11165

  11163 10 011006   200007 450100                    STZ     CODE,,AUTO
        10 011007   011020 710000 10                 TRA     s:11169

     1908    11164    4            ELSE DO;

     1909    11165    4               CODE=F$DCB.BFR.DA(1);

  11165 10 011010   000000 470400 xsym               LDP0    M$DP$
        10 011011   000116 236100                    LDQ     78,,PR0
        10 011012   000032 376000 xsym               ANQ     B_VECTNIL+26
        10 011013   200007 756100                    STQ     CODE,,AUTO

     1910    11166    4               CALL M$OPEN(OPNDP)ALTRET(DPERR);

  11166 10 011014   000100 630400 0                  EPPR0   OPNDP
        10 011015   450000 713400                    CLIMB   alt,open
        10 011016   410400 401760                    pmme    nvectors=18
        10 011017   013551 702000 10                 TSX2    DPERR

     1911    11167    4               END;

     1912    11168    3         END;

     1913    11169    2         ERRCODE='0'B;

  11169 10 011020   001074 450000 0                  STZ     ERRCODE
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:376  

     1914    11170    2         CALL FXF$FIX(CODE);

  11170 10 011021   200007 630500                    EPPR0   CODE,,AUTO
        10 011022   201346 450500                    STP0    BXP+1,,AUTO
        10 011023   201346 630500                    EPPR0   BXP+1,,AUTO
        10 011024   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 011025   000000 701000 xent               TSX1    FXF$FIX
        10 011026   000000 011000                    NOP     0

     1915    11171    2         CLSDP.V.DISP#=0;

  11171 10 011027   000000 236003                    LDQ     0,DU
        10 011030   000224 552004 0                  STBQ    CLSDP+26,'04'O

     1916    11172    2         CALL M$CLOSE(CLSDP)ALTRET(NOALT);

  11172 10 011031   000172 630400 0                  EPPR0   CLSDP
        10 011032   450001 713400                    CLIMB   alt,close
        10 011033   406000 401760                    pmme    nvectors=13
        10 011034   014123 702000 10                 TSX2    NOALT

     1917    11173    2         CALL SET_PRIV;

  11173 10 011035   013176 701000 10                 TSX1    SET_PRIV
        10 011036   000000 011000                    NOP     0

     1918    11174    2         IF ERRCODE OR BREAK~=0 THEN CALL RECONERE ALTRET(DPERR1);

  11174 10 011037   001074 235000 0                  LDA     ERRCODE
        10 011040   011043 601000 10                 TNZ     s:11174+4
        10 011041   001125 236000 0                  LDQ     BREAK
        10 011042   011257 600000 10                 TZE     s:11238

  11174 10 011043   014457 701000 10                 TSX1    RECONERE
        10 011044   013567 702000 10                 TSX2    DPERR1
        10 011045   011257 710000 10                 TRA     s:11238
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:377  

     1919    11175        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:378  
     1920    11176    2      CASE(%(E$MAKEME-E$PIGH));

     1921    11177    2         PROJAD.L=0;

  11177 10 011046   000000 236003                    LDQ     0,DU
        10 011047   001127 552040 0                  STBQ    PROJAD,'40'O

     1922    11178    2         FLAG='0'B;

  11178 10 011050   001107 450000 0                  STZ     FLAG

     1923    11179    2         CALL M$RPRIV(PPRIVFPT);

  11179 10 011051   000014 630400 2                  EPPR0   PPRIVFPT
        10 011052   020013 713400                    CLIMB   8203
        10 011053   400000 401760                    pmme    nvectors=1

     1924    11180    3         IF OUT$BLK.NSUBLKS~=0 THEN DO;

  11180 10 011054   001073 470400 0                  LDP0    BLK$
        10 011055   000001 220100                    LDX0    1,,PR0
        10 011056   011100 600000 10                 TZE     s:11185

     1925    11181    3            PROJAD.ACCT=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  11181 10 011057   000004 471500                    LDP1    4,,PR0
        10 011060   100004 236100                    LDQ     4,,PR1
        10 011061   000033 772000                    QRL     27
        10 011062   000000 621006                    EAX1    0,QL
        10 011063   040000 100540                    MLR     fill='040'O
        10 011064   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 011065   001127 200010 0                  ADSC9   PROJAD                   cn=1,n=8

     1926    11182    3            PROJAD.NAME=OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT;

  11182 10 011066   000005 471500                    LDP1    5,,PR0
        10 011067   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:379  
        10 011070   000033 772000                    QRL     27
        10 011071   000000 620006                    EAX0    0,QL
        10 011072   040000 100540                    MLR     fill='040'O
        10 011073   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        10 011074   001131 200014 0                  ADSC9   PROJAD+2                 cn=1,n=12

     1927    11183    3            CALL FXU$PROJAD;

  11183 10 011075   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 011076   000000 701000 xent               TSX1    FXU$PROJAD
        10 011077   000000 011000                    NOP     0

     1928    11184    3            END;

     1929    11185    2         IF PROJAD.L=0 THEN CALL SET_PRIV;

  11185 10 011100   001127 236000 0                  LDQ     PROJAD
        10 011101   777000 316003                    CANQ    -512,DU
        10 011102   011105 601000 10                 TNZ     s:11186

  11185 10 011103   013176 701000 10                 TSX1    SET_PRIV
        10 011104   000000 011000                    NOP     0

     1930    11186    2         IF FLAG THEN GOTO DPERR1;

  11186 10 011105   001107 235000 0                  LDA     FLAG
        10 011106   013567 601000 10                 TNZ     DPERR1

     1931    11187    3         IF PROJAD.L~=0 THEN DO;

  11187 10 011107   001127 236000 0                  LDQ     PROJAD
        10 011110   777000 316003                    CANQ    -512,DU
        10 011111   011257 600000 10                 TZE     s:11238

     1932    11188    3            IF PROJAD.L<20 THEN ERRSYN.T='No Packset';

  11188 10 011112   001127 236000 0                  LDQ     PROJAD
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:380  
        10 011113   777000 376003                    ANQ     -512,DU
        10 011114   024000 116003                    CMPQ    10240,DU
        10 011115   011122 603000 10                 TRC     s:11189

  11188 10 011116   040000 100400                    MLR     fill='040'O
        10 011117   000476 000012 2                  ADSC9   FFLGS+23                 cn=0,n=10
        10 011120   006627 200025 0                  ADSC9   ERRSYN+6                 cn=1,n=21
        10 011121   011130 710000 10                 TRA     s:11190

     1933    11189    3            ELSE CALL CONCAT(ERRSYN.T,'Set #',PROJAD.PSN);

  11189 10 011122   040000 100400                    MLR     fill='040'O
        10 011123   000501 000005 2                  ADSC9   FFLGS+26                 cn=0,n=5
        10 011124   006627 200005 0                  ADSC9   ERRSYN+6                 cn=1,n=5
        10 011125   040000 100400                    MLR     fill='040'O
        10 011126   001134 200006 0                  ADSC9   PROJAD+5                 cn=1,n=6
        10 011127   006630 400020 0                  ADSC9   ERRSYN+7                 cn=2,n=16

     1934    11190    3            CALL CONCAT(LBUFC,'Project Administrator Mode - ',ERRSYN.T);

  11190 10 011130   040000 100400                    MLR     fill='040'O
        10 011131   000577 000035 2                  ADSC9   FFLGS+88                 cn=0,n=29
        10 011132   006702 000035 0                  ADSC9   LBUFC                    cn=0,n=29
        10 011133   040000 100400                    MLR     fill='040'O
        10 011134   006627 200025 0                  ADSC9   ERRSYN+6                 cn=1,n=21
        10 011135   006711 200133 0                  ADSC9   LBUFC+7                  cn=1,n=91

     1935    11191    3            CALL ERROR(10);

  11191 10 011136   000016 236000 11                 LDQ     14
        10 011137   201341 756100                    STQ     P$+2,,AUTO
        10 011140   011704 701000 10                 TSX1    ERROR
        10 011141   000000 011000                    NOP     0

     1936    11192    3            END;

  11192 10 011142   011257 710000 10                 TRA     s:11238
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:381  

     1937    11193           %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:382  
     1938    11194    2      CASE(%(E$HCMD-E$PIGH));

     1939    11195    2         FLAG='0'B;

  11195 10 011143   001107 450000 0                  STZ     FLAG

     1940    11196    2         XUH.HELP$=ADDR(OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT);

  11196 10 011144   001073 470400 0                  LDP0    BLK$
        10 011145   000004 471500                    LDP1    4,,PR0
        10 011146   100004 633500                    EPPR3   4,,PR1
        10 011147   000011 453400 0                  STP3    XUH+9

     1941    11197    2         I=OUT$BLK.SUBLK$(1)->OUT$SYM.CPOS;

  11197 10 011150   000004 471500                    LDP1    4,,PR0
        10 011151   100002 235100                    LDA     2,,PR1
        10 011152   001076 755000 0                  STA     I

     1942    11198    2         CALL X$HELP(XUH)ALTRET(HELP_ERR);

  11198 10 011153   000147 630400 11                 EPPR0   103
        10 011154   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 011155   000000 701000 xent               TSX1    X$HELP
        10 011156   011160 702000 10                 TSX2    HELP_ERR

     1943    11199    2         GOTO NEXT;

  11199 10 011157   000204 710000 10                 TRA     NEXT

  11197 10 011160                       HELP_ERR     null
     1944    11200    2   HELP_ERR:;
     1945    11201    2         FLAG=XUH.ERR;

  11201 10 011160   000013 236000 0                  LDQ     XUH+11
        10 011161   001107 756000 0                  STQ     FLAG

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:383  
     1946    11202    2         P_PCB.ERROR=FLAG;

  11202 10 011162   001022 756000 0                  STQ     P_PCB+6

     1947    11203    2         EFPT.V.DCB#=XUH.ERR_DCB#;

  11203 10 011163   000014 720000 0                  LXL0    XUH+12
        10 011164   000346 740000 0                  STX0    EFPT+22

     1948    11204    2         FLAG.SEV=7;

  11204 10 011165   000007 236007                    LDQ     7,DL
        10 011166   001107 256000 0                  ORSQ    FLAG

     1949    11205    2         IF FLAG.CODE~=%E$SYNERR THEN GOTO DPERR1;

  11205 10 011167   001107 236000 0                  LDQ     FLAG
        10 011170   377770 376007                    ANQ     131064,DL
        10 011171   000010 116007                    CMPQ    8,DL
        10 011172   013567 601000 10                 TNZ     DPERR1

     1950    11206    2         P_PCB.HI_CHAR=XUH.CHARPOS+I;

  11206 10 011173   000015 236000 0                  LDQ     XUH+13
        10 011174   001076 036000 0                  ADLQ    I
        10 011175   001026 756000 0                  STQ     P_PCB+10

     1951    11207    2         GOTO PARSERR;

  11207 10 011176   011553 710000 10                 TRA     PARSERR

     1952    11208    2      CASE(%(E$QSTNMRK-E$PIGH));

     1953    11209    3         IF FLAG THEN DO;

  11209 10 011177   001107 236000 0                  LDQ     FLAG
        10 011200   011241 600000 10                 TZE     s:11232
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:384  

     1954    11210                    /*E*     ERROR: FXP-E$PIGH-0
     1955    11211                    *        MESSAGE:Type Help command - commands are ACcount, ATtr, Build,
     1956    11212                    *       CATalog, CATDelete, CATList, CATModify, COunt, CReate, DEFault,
     1957    11213                   *       DELETE, DISMount, Display, End, eXit, EXtend, FIX, List, MADAdd,
     1958    11214              *        MADDelete, MADList, Modify, Mount, Quit, REConstruct, AND SCRatch.
     1959    11215              *        Abbreviation is indicated by upper case. DP#set may be spelled
     1960    11216              *        without DP.  A vsn is a volume serial number, up to 8 decimal
     1961    11217              *        digits, optionally followed by a single upper-case letter to
     1962    11218              *        designate which section of a partitioned volume to use (see the
     1963    11219              *        SCRatch cmd). Most references to acct may contain any number of ?'s
     1964    11220              *        and be followed by >, as in PCL.
     1965    11221              */
     1966    11222    3            TCXT=BINASC(0);

  11222 10 011201   040000 100400                    MLR     fill='040'O
        10 011202   000010 000001 11                 ADSC9   8                        cn=0,n=1
        10 011203   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256

     1967    11223    3            IF FLAG.FCG='0630'O AND FLAG.CODE>=%E$PIGH

  11223 10 011204   777700 376003                    ANQ     -64,DU
        10 011205   063000 116003                    CMPQ    26112,DU
        10 011206   011215 601000 10                 TNZ     s:11225
        10 011207   001107 236000 0                  LDQ     FLAG
        10 011210   377770 376007                    ANQ     131064,DL
        10 011211   001440 116007                    CMPQ    800,DL
        10 011212   011215 602000 10                 TNC     s:11225

     1968    11224    3            THEN EFPT.V.INCLCODE#='0'B;

  11224 10 011213   000150 236000 11                 LDQ     104
        10 011214   000350 356000 0                  ANSQ    EFPT+24

     1969    11225    3            EFPT.V.OUTDCB1#=DCBNUM(M$DO);

  11225 10 011215   000000 236007 xsym               LDQ     M$DO,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:385  
        10 011216   000000 620006                    EAX0    0,QL
        10 011217   000346 440000 0                  SXL0    EFPT+22

     1970    11226    3            FLAG.SEV=FLAG.SEV+1;

  11226 10 011220   001107 236000 0                  LDQ     FLAG
        10 011221   000007 376007                    ANQ     7,DL
        10 011222   000001 036007                    ADLQ    1,DL
        10 011223   001107 676000 0                  ERQ     FLAG
        10 011224   000007 376007                    ANQ     7,DL
        10 011225   001107 656000 0                  ERSQ    FLAG

     1971    11227    3            CALL M$ERRMSG(EFPT)ALTRET(HELP1);

  11227 10 011226   000320 630400 0                  EPPR0   EFPT
        10 011227   420000 713400                    CLIMB   alt,+8192
        10 011230   405000 401760                    pmme    nvectors=11
        10 011231   011234 702000 10                 TSX2    HELP1

     1972    11228    3            FLAG=EVLR.CODEUSED;

  11228 10 011232   000355 236000 0                  LDQ     EVLR+3
        10 011233   001107 756000 0                  STQ     FLAG

     1973    11229    3   HELP1:   EFPT.V.OUTDCB1#=0;

  11229 10 011234   000000 220003       HELP1        LDX0    0,DU
        10 011235   000346 440000 0                  SXL0    EFPT+22

     1974    11230    3            EFPT.V.INCLCODE#='1'B;

  11230 10 011236   004000 236003                    LDQ     2048,DU
        10 011237   000350 256000 0                  ORSQ    EFPT+24

     1975    11231    3            END;

  11231 10 011240   011257 710000 10                 TRA     s:11238
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:386  

     1976    11232    3         ELSE IF XUH.ERR='0'B THEN DO;

  11232 10 011241   000013 235000 0                  LDA     XUH+11
        10 011242   011257 601000 10                 TNZ     s:11238

     1977    11233    3            IF TCXT='??' THEN XUH.ALL#='1'B;

  11233 10 011243   040000 106400                    CMPC    fill='040'O
        10 011244   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256
        10 011245   000607 000002 2                  ADSC9   FFLGS+96                 cn=0,n=2
        10 011246   011251 601000 10                 TNZ     s:11234

  11233 10 011247   000400 236003                    LDQ     256,DU
        10 011250   000012 256000 0                  ORSQ    XUH+10

     1978    11234    3            XUH.MORE#='1'B;

  11234 10 011251   000200 236003                    LDQ     128,DU
        10 011252   000012 256000 0                  ORSQ    XUH+10

     1979    11235    3            CALL X$HELP(XUH) ALTRET(HELP_ERR);

  11235 10 011253   000147 630400 11                 EPPR0   103
        10 011254   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 011255   000000 701000 xent               TSX1    X$HELP
        10 011256   011160 702000 10                 TSX2    HELP_ERR

     1980    11236    3            END;

     1981    11237    2      END;

     1982    11238    1      GOTO NEXT;

  11238 10 011257   000204 710000 10                 TRA     NEXT

     1983    11239        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:387  
     1984    11240    1   FXP$RVID: ENTRY(PARM)ALTRET;

  11240 10 011260   000000 700200 xent  FXP$RVID     TSX0  ! X66_AUTO_1
        10 011261   001376 000001                    ZERO    766,1

     1985    11241    1      IF PARM.U~=0 THEN OPNSN.SN#(0)=ADDR(PARM)->CHAR4;

  11241 10 011262   200003 470500                    LDP0    @PARM,,AUTO
        10 011263   000000 235100                    LDA     0,,PR0
        10 011264   011271 600000 10                 TZE     s:11242

  11241 10 011265   040000 100500                    MLR     fill='040'O
        10 011266   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        10 011267   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 011270   011300 710000 10                 TRA     s:11243

     1986    11242    1      ELSE OPNSN.SN#(0)=PARM.P$->OUT$SYM.TEXT;

  11242 10 011271   000001 471500                    LDP1    1,,PR0
        10 011272   100004 236100                    LDQ     4,,PR1
        10 011273   000033 772000                    QRL     27
        10 011274   000000 620006                    EAX0    0,QL
        10 011275   040000 100540                    MLR     fill='040'O
        10 011276   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        10 011277   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     1987    11243    1      CALL M$OPEN(OPNDP)ALTRET(RVIDALT);

  11243 10 011300   000100 630400 0                  EPPR0   OPNDP
        10 011301   450000 713400                    CLIMB   alt,open
        10 011302   410400 401760                    pmme    nvectors=18
        10 011303   011324 702000 10                 TSX2    RVIDALT

     1988    11244    1      CALL M$READ(READVID)ALTRET(RVIDALT);

  11244 10 011304   000416 630400 0                  EPPR0   READVID
        10 011305   440000 713400                    CLIMB   alt,read
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:388  
        10 011306   401400 401760                    pmme    nvectors=4
        10 011307   011324 702000 10                 TSX2    RVIDALT

     1989    11245    2      CALL M$CLOSE(CLSDP) WHENALTRETURN DO;

  11245 10 011310   000172 630400 0                  EPPR0   CLSDP
        10 011311   450001 713400                    CLIMB   alt,close
        10 011312   406000 401760                    pmme    nvectors=13
        10 011313   011315 702000 10                 TSX2    s:11246
        10 011314   011323 710000 10                 TRA     s:11248

     1990    11246    2         CALL CLOSE(DCBNUM(M$DP));

  11246 10 011315   000000 236007 xsym               LDQ     M$DP,DL
        10 011316   201372 756100                    STQ     BXP+21,,AUTO
        10 011317   201372 630500                    EPPR0   BXP+21,,AUTO
        10 011320   201341 450500                    STP0    P$+2,,AUTO
        10 011321   012416 701000 10                 TSX1    CLOSE
        10 011322   000000 011000                    NOP     0

     1991    11247    2         END;

     1992    11248    1      RETURN;

  11248 10 011323   000000 702200 xent               TSX2  ! X66_ARET

     1993    11249    2   RVIDALT: CALL M$CLOSE(CLSDP) WHENALTRETURN DO;

  11249 10 011324   000172 630400 0     RVIDALT      EPPR0   CLSDP
        10 011325   450001 713400                    CLIMB   alt,close
        10 011326   406000 401760                    pmme    nvectors=13
        10 011327   011331 702000 10                 TSX2    s:11250
        10 011330   011337 710000 10                 TRA     s:11252

     1994    11250    2         CALL CLOSE(DCBNUM(M$DP));

  11250 10 011331   000000 236007 xsym               LDQ     M$DP,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:389  
        10 011332   201373 756100                    STQ     BXP+22,,AUTO
        10 011333   201373 630500                    EPPR0   BXP+22,,AUTO
        10 011334   201341 450500                    STP0    P$+2,,AUTO
        10 011335   012416 701000 10                 TSX1    CLOSE
        10 011336   000000 011000                    NOP     0

     1995    11251    2         END;

     1996    11252    1      ALTRETURN;

  11252 10 011337   000000 702200 xent               TSX2  ! X66_AALT

     1997    11253        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:390  
     1998    11254    1   FXP$PRINT: ENTRY(PARM) ALTRET;

  11254 10 011340   000000 700200 xent  FXP$PRINT    TSX0  ! X66_AUTO_1
        10 011341   001376 000001                    ZERO    766,1

     1999    11255    1      IF ADDR(PARM)=ADDR(NIL) THEN CALL ERROR(10);

  11255 10 011342   200003 236100                    LDQ     @PARM,,AUTO
        10 011343   000001 116000 xsym               CMPQ    B_VECTNIL+1
        10 011344   011352 601000 10                 TNZ     s:11256

  11255 10 011345   000016 236000 11                 LDQ     14
        10 011346   201341 756100                    STQ     P$+2,,AUTO
        10 011347   011704 701000 10                 TSX1    ERROR
        10 011350   000000 011000                    NOP     0
        10 011351   011355 710000 10                 TRA     s:11257

     2000    11256    1      ELSE CALL ERROR(PARM.U);

  11256 10 011352   201341 756100                    STQ     P$+2,,AUTO
        10 011353   011704 701000 10                 TSX1    ERROR
        10 011354   000000 011000                    NOP     0

     2001    11257    1      LBUFC=' ';

  11257 10 011355   040000 100400                    MLR     fill='040'O
        10 011356   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 011357   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

     2002    11258    1      I=I0;

  11258 10 011360   001077 235000 0                  LDA     I0
        10 011361   001076 755000 0                  STA     I

     2003    11259    1      RETURN;

  11259 10 011362   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:391  

     2004    11260    1   FXP$PART: ENTRY(PARM) ALTRET;

  11260 10 011363   000000 700200 xent  FXP$PART     TSX0  ! X66_AUTO_1
        10 011364   001376 000001                    ZERO    766,1

     2005    11261    1      CALL ADDPART(PARM.U,PARM.P$->BASED_UBIN);

  11261 10 011365   200003 470500                    LDP0    @PARM,,AUTO
        10 011366   000001 471500                    LDP1    1,,PR0
        10 011367   201336 451500                    STP1    K+1,,AUTO
        10 011370   200003 236100                    LDQ     @PARM,,AUTO
        10 011371   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 011372   014145 701000 10                 TSX1    ADDPART
        10 011373   000000 011000                    NOP     0

     2006    11262    1      RETURN;

  11262 10 011374   000000 702200 xent               TSX2  ! X66_ARET

     2007    11263    1   FXP$PARM: ENTRY(PARM) ALTRET;

  11263 10 011375   000000 700200 xent  FXP$PARM     TSX0  ! X66_AUTO_1
        10 011376   001376 000001                    ZERO    766,1

     2008    11264    1      CALL ADDPARAM(PARM.U);

  11264 10 011377   200003 236100                    LDQ     @PARM,,AUTO
        10 011400   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 011401   014226 701000 10                 TSX1    ADDPARAM
        10 011402   000000 011000                    NOP     0

     2009    11265    1      RETURN;

  11265 10 011403   000000 702200 xent               TSX2  ! X66_ARET

     2010    11266    1   FXP$PARN: ENTRY(PARM) ALTRET;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:392  

  11266 10 011404   000000 700200 xent  FXP$PARN     TSX0  ! X66_AUTO_1
        10 011405   001376 000001                    ZERO    766,1

     2011    11267    1      ADDR(J)->BASED_UBIN=ADDR(PARM.P$)->BASED_UBIN;

  11267 10 011406   200003 470500                    LDP0    @PARM,,AUTO
        10 011407   000001 235100                    LDA     1,,PR0
        10 011410   001104 755000 0                  STA     J

     2012    11268    1      CALL ADDPARNUM(PARM.U);

  11268 10 011411   200003 236100                    LDQ     @PARM,,AUTO
        10 011412   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 011413   014155 701000 10                 TSX1    ADDPARNUM
        10 011414   000000 011000                    NOP     0

     2013    11269    1      RETURN;

  11269 10 011415   000000 702200 xent               TSX2  ! X66_ARET

     2014    11270        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:393  
     2015    11271                    /*F*      NAME: FXP$PROJAT
     2016    11272              *         PURPOSE: Merge the PROJECT attributes into the packset attributes.
     2017    11273              The parameter is the parse PCB.
     2018    11274              */
     2019    11275    1   FXP$PROJAT: ENTRY(PARM) ALTRET;

  11275 10 011416   000000 700200 xent  FXP$PROJAT   TSX0  ! X66_AUTO_1
        10 011417   001376 000001                    ZERO    766,1

     2020    11276    1      BLK$=ADDR(PARM)->P$PCB.OUT$;

  11276 10 011420   200003 470500                    LDP0    @PARM,,AUTO
        10 011421   000003 236100                    LDQ     3,,PR0
        10 011422   001073 756000 0                  STQ     BLK$

     2021    11277    1      ADDR(PARM)->P$PCB.OUT$=P_PCB.TEXT$; /* OPTIONS NEEDS TEXT$ */

  11277 10 011423   001014 236000 0                  LDQ     P_PCB
        10 011424   000003 756100                    STQ     3,,PR0

     2022    11278    2      IF ADDR(PARM)->P$PCB.ERROR THEN DO;

  11278 10 011425   000006 235100                    LDA     6,,PR0
        10 011426   011435 600000 10                 TZE     s:11286

     2023    11279    2   ERRPCB: FLAG=FXP$E$PROJDFT;

  11279 10 011427   000045 236000 2     ERRPCB       LDQ     FXP$E$PROJDFT
        10 011430   001107 756000 0                  STQ     FLAG

     2024    11280                    /*E*      ERROR: FXP-E$PROJDFT
     2025    11281                    *         MESSAGE:Error In Project Default Attributes.
     2026    11282                    */
     2027    11283    2   ERRRET: P_PCB.TEXT$=ADDR(PARM)->P$PCB.OUT$;

  11283 10 011431   200003 470500       ERRRET       LDP0    @PARM,,AUTO
        10 011432   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:394  
        10 011433   001014 756000 0                  STQ     P_PCB

     2028    11284    2         ALTRETURN;

  11284 10 011434   000000 702200 xent               TSX2  ! X66_AALT

     2029    11285    2         END;
     2030    11286    1      OPNSN.SN#(0)=OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  11286 10 011435   001073 471400 0                  LDP1    BLK$
        10 011436   100004 473500                    LDP3    4,,PR1
        10 011437   300004 236100                    LDQ     4,,PR3
        10 011440   000033 772000                    QRL     27
        10 011441   000000 620006                    EAX0    0,QL
        10 011442   040000 100540                    MLR     fill='040'O
        10 011443   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
        10 011444   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6

     2031    11287    1      PRIVFPT.V.PRIV#=%PR_FMDIAG#;

  11287 10 011445   000541 236000 2                  LDQ     FFLGS+58
        10 011446   000636 756000 0                  STQ     PRIVFPT+2

     2032    11288    1      CALL M$SPRIV(PRIVFPT);

  11288 10 011447   000634 630400 0                  EPPR0   PRIVFPT
        10 011450   020012 713400                    CLIMB   8202
        10 011451   400000 401760                    pmme    nvectors=1

     2033    11289    1      OPNDP.FPARAM_=BITVECT(READVID.BUF_);

  11289 10 011452   000422 237000 0                  LDAQ    READVID+4
        10 011453   000130 757000 0                  STAQ    OPNDP+24

     2034    11290    1      OPNDP.IFPARAM_=VECTOR(NIL);

  11290 10 011454   000024 237000 11                 LDAQ    20
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:395  
        10 011455   000126 757000 0                  STAQ    OPNDP+22

     2035    11291    1      VLP_ACCT.ACCT#=BINASC(0);

  11291 10 011456   000010 235000 11                 LDA     8
        10 011457   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 011460   000076 757000 0                  STAQ    VLP_ACCT

     2036    11292    1      CALL M$OPEN(OPNDP)ALTRET(ERRALT);

  11292 10 011461   000100 630400 0                  EPPR0   OPNDP
        10 011462   450000 713400                    CLIMB   alt,open
        10 011463   410400 401760                    pmme    nvectors=18
        10 011464   011544 702000 10                 TSX2    ERRALT

     2037    11293    1      CALL MOVEFIT;

  11293 10 011465   013064 701000 10                 TSX1    MOVEFIT
        10 011466   000000 011000                    NOP     0

     2038    11294    1      I=3;

  11294 10 011467   000003 235007                    LDA     3,DL
        10 011470   001076 755000 0                  STA     I

     2039    11295    1      X9=0;

  11295 10 011471   200006 450100                    STZ     X9,,AUTO

     2040    11296    1      P_PCB.TEXT$=ADDR(PARM)->P$PCB.TEXT$;

  11296 10 011472   200003 470500                    LDP0    @PARM,,AUTO
        10 011473   000000 236100                    LDQ     0,,PR0
        10 011474   001014 756000 0                  STQ     P_PCB

     2041    11297    2      DO WHILE(I<OUT$BLK.NSUBLKS);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:396  
  11297 10 011475   001073 471400 0                  LDP1    BLK$
        10 011476   100001 236100                    LDQ     1,,PR1
        10 011477   000022 772000                    QRL     18
        10 011500   001076 116000 0                  CMPQ    I
        10 011501   011516 602000 10                 TNC     s:11301
        10 011502   011516 600000 10                 TZE     s:11301

     2042    11298    2         CALL GET_OPTIONS ALTRET(ERRPCB);

  11298 10 011503   014573 701000 10                 TSX1    GET_OPTIONS
        10 011504   011427 702000 10                 TSX2    ERRPCB

     2043    11299    2         I=I+1;

  11299 10 011505   001076 235000 0                  LDA     I
        10 011506   000001 035007                    ADLA    1,DL
        10 011507   001076 755000 0                  STA     I

     2044    11300    2         END;

  11300 10 011510   001073 470400 0                  LDP0    BLK$
        10 011511   000001 236100                    LDQ     1,,PR0
        10 011512   000022 772000                    QRL     18
        10 011513   001076 116000 0                  CMPQ    I
        10 011514   011516 600000 10                 TZE     s:11301
        10 011515   011503 603000 10                 TRC     s:11298

     2045    11301    1      P_PCB.TEXT$=ADDR(PARM)->P$PCB.OUT$;

  11301 10 011516   200003 470500                    LDP0    @PARM,,AUTO
        10 011517   000003 236100                    LDQ     3,,PR0
        10 011520   001014 756000 0                  STQ     P_PCB

     2046    11302    1      FLAG='0'B;

  11302 10 011521   001107 450000 0                  STZ     FLAG

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:397  
     2047    11303    1      CODE14.ACCESS.LIST=(FIT09.NDW~=0);

  11303 10 011522   400000 220003                    LDX0    -131072,DU
        10 011523   001420 236000 0                  LDQ     FIT09
        10 011524   000132 316000 11                 CANQ    90
        10 011525   011527 601000 10                 TNZ     s:11303+5
        10 011526   000000 220003                    LDX0    0,DU
        10 011527   000000 636010                    EAQ     0,X0
        10 011530   000001 772000                    QRL     1
        10 011531   001434 676000 0                  ERQ     CODE14
        10 011532   200000 376003                    ANQ     65536,DU
        10 011533   001434 656000 0                  ERSQ    CODE14

     2048    11304    1      FITSIZE=SIZEC(DEFAULT_BUILD);

  11304 10 011534   005514 236007                    LDQ     2892,DL
        10 011535   002620 756000 0                  STQ     FITSIZE

     2049    11305    1      CSTAT=ADDR(FIT00)->FITMOVER;

  11305 10 011536   000000 620006                    EAX0    0,QL
        10 011537   010000 221003                    LDX1    4096,DU
        10 011540   000040 100440                    MLR     fill='000'O
        10 011541   001415 000010 0                  ADSC9   FIT00                    cn=0,n=*X0
        10 011542   004621 000011 0                  ADSC9   CSTAT                    cn=0,n=*X1

     2050    11306    1      RETURN;

  11306 10 011543   000000 702200 xent               TSX2  ! X66_ARET

     2051    11307    1   ERRALT: FLAG=B$ALT.ERR;

  11307 10 011544   000000 470400 xsym  ERRALT       LDP0    B$TCB$
        10 011545   000000 471500                    LDP1    0,,PR0
        10 011546   100102 236100                    LDQ     66,,PR1
        10 011547   001107 756000 0                  STQ     FLAG

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:398  
     2052    11308    1      FLAG.SEV=7;

  11308 10 011550   000007 236007                    LDQ     7,DL
        10 011551   001107 256000 0                  ORSQ    FLAG

     2053    11309    1      GOTO ERRRET;

  11309 10 011552   011431 710000 10                 TRA     ERRRET

     2054    11310        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:399  
     2055    11311        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:400  
     2056    11312    1   PARSERR: I=P_PCB.ERROR.CODE;

  11312 10 011553   001022 236000 0     PARSERR      LDQ     P_PCB+6
        10 011554   000003 772000                    QRL     3
        10 011555   037777 376007                    ANQ     16383,DL
        10 011556   001076 756000 0                  STQ     I

     2057    11313    2      IF I=%E$SMALLWORK OR I=%E$WKOVERFLOW THEN DO;

  11313 10 011557   000005 116007                    CMPQ    5,DL
        10 011560   011563 600000 10                 TZE     s:11314
        10 011561   000004 116007                    CMPQ    4,DL
        10 011562   011570 601000 10                 TNZ     s:11317

     2058    11314    2         CALL M$GDS(WORKFPT) ALTRET(NOCORE);

  11314 10 011563   001064 630400 0                  EPPR0   WORKFPT
        10 011564   430001 713400                    CLIMB   alt,gds
        10 011565   400400 401760                    pmme    nvectors=2
        10 011566   014027 702000 10                 TSX2    NOCORE

     2059    11315    2         GOTO NEWPARSE;

  11315 10 011567   001130 710000 10                 TRA     NEWPARSE

     2060    11316    2         END;
     2061    11317    1      P_PCB.ERROR.CODE=1;

  11317 10 011570   001022 236000 0                  LDQ     P_PCB+6
        10 011571   000151 376000 11                 ANQ     105
        10 011572   000010 276007                    ORQ     8,DL
        10 011573   001022 756000 0                  STQ     P_PCB+6

  11317 10 011574                       VALERR       null
     2062    11318    1   VALERR:;
     2063    11319    1      IF P_PCB.HI_CHAR<9 OR P_PCB.NCHARS<17 THEN I=0;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:401  
  11319 10 011574   001026 235000 0                  LDA     P_PCB+10
        10 011575   000011 115007                    CMPA    9,DL
        10 011576   011602 602000 10                 TNC     s:11319
        10 011577   001025 236000 0                  LDQ     P_PCB+9
        10 011600   000021 116007                    CMPQ    17,DL
        10 011601   011604 603000 10                 TRC     s:11320

  11319 10 011602   001076 450000 0                  STZ     I
        10 011603   011606 710000 10                 TRA     s:11321

     2064    11320    1      ELSE I=P_PCB.HI_CHAR-9;

  11320 10 011604   000011 135007                    SBLA    9,DL
        10 011605   001076 755000 0                  STA     I

     2065    11321    1      CALL CONCAT(ERRSYN.T,SUBSTR(P_PCB.TEXT$->CHAR4,I,P_PCB.HI_CHAR-I),

  11321 10 011606   001026 236000 0                  LDQ     P_PCB+10
        10 011607   001076 136000 0                  SBLQ    I
        10 011610   201346 756100                    STQ     BXP+1,,AUTO
        10 011611   001025 236000 0                  LDQ     P_PCB+9
        10 011612   001026 136000 0                  SBLQ    P_PCB+10
        10 011613   001014 470400 0                  LDP0    P_PCB
        10 011614   201346 720100                    LXL0    BXP+1,,AUTO
        10 011615   001076 235000 0                  LDA     I
        10 011616   040000 100545                    MLR     fill='040'O
        10 011617   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        10 011620   006627 200025 0                  ADSC9   ERRSYN+6                 cn=1,n=21
        10 011621   201347 756100                    STQ     BXP+2,,AUTO
        10 011622   201346 236100                    LDQ     BXP+1,,AUTO
        10 011623   000025 116007                    CMPQ    21,DL
        10 011624   011644 605000 10                 TPL     s:11323
        10 011625   777752 621006                    EAX1    -22,QL
        10 011626   777777 661003                    ERX1    -1,DU
        10 011627   040046 100400                    MLR     fill='040'O
        10 011630   000610 000004 2                  ADSC9   FFLGS+97                 cn=0,n=4
        10 011631   006627 200011 0                  ADSC9   ERRSYN+6,Q               cn=1,n=*X1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:402  
        10 011632   000021 116007                    CMPQ    17,DL
        10 011633   011644 605000 10                 TPL     s:11323
        10 011634   777756 622006                    EAX2    -18,QL
        10 011635   777777 662003                    ERX2    -1,DU
        10 011636   001014 470400 0                  LDP0    P_PCB
        10 011637   201347 723100                    LXL3    BXP+2,,AUTO
        10 011640   001026 235000 0                  LDA     P_PCB+10
        10 011641   040046 100545                    MLR     fill='040'O
        10 011642   000000 000013                    ADSC9   0,A,PR0                  cn=0,n=*X3
        10 011643   006630 200012 0                  ADSC9   ERRSYN+7,Q               cn=1,n=*X2

     2066    11322    1        ' at ',SUBSTR(P_PCB.TEXT$->CHAR4,P_PCB.HI_CHAR,P_PCB.NCHARS-P_PCB.HI_CHAR));
     2067    11323    1      IF P_PCB.HI_CHAR=0 THEN I=6;

  11323 10 011644   001026 235000 0                  LDA     P_PCB+10
        10 011645   011651 601000 10                 TNZ     s:11324

  11323 10 011646   000006 236007                    LDQ     6,DL
        10 011647   001076 756000 0                  STQ     I
        10 011650   011655 710000 10                 TRA     s:11325

     2068    11324    1      ELSE I=P_PCB.ERROR.CODE;

  11324 10 011651   001022 236000 0                  LDQ     P_PCB+6
        10 011652   000003 772000                    QRL     3
        10 011653   037777 376007                    ANQ     16383,DL
        10 011654   001076 756000 0                  STQ     I

     2069    11325    1      VALMSG.T=ERRSYN.T;

  11325 10 011655   040000 100400                    MLR     fill='040'O
        10 011656   006627 200025 0                  ADSC9   ERRSYN+6                 cn=1,n=21
        10 011657   006647 200025 0                  ADSC9   VALMSG+10                cn=1,n=21

     2070    11326    1      CALL ERROR(I);

  11326 10 011660   000101 236000 11                 LDQ     65
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:403  
        10 011661   201341 756100                    STQ     P$+2,,AUTO
        10 011662   011704 701000 10                 TSX1    ERROR
        10 011663   000000 011000                    NOP     0

     2071    11327    1      IF I=1

  11327 10 011664   001076 235000 0                  LDA     I
        10 011665   000001 115007                    CMPA    1,DL
        10 011666   011703 601000 10                 TNZ     s:11331

     2072    11328    1      THEN IF SUBSTR(P_PCB.TEXT$->CHAR4,P_PCB.HI_CHAR,P_PCB.NCHARS-P_PCB.HI_CHAR)=

  11328 10 011667   001025 236000 0                  LDQ     P_PCB+9
        10 011670   001026 136000 0                  SBLQ    P_PCB+10
        10 011671   001014 470400 0                  LDP0    P_PCB
        10 011672   000000 620006                    EAX0    0,QL
        10 011673   001026 236000 0                  LDQ     P_PCB+10
        10 011674   040000 106546                    CMPC    fill='040'O
        10 011675   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        10 011676   000006 000001 11                 ADSC9   6                        cn=0,n=1
        10 011677   000765 600000 10                 TZE     MENU

     2073    11329    1        '?' THEN GOTO MENU;
     2074    11330    1      ELSE P_PCB.NCHARS=P_PCB.NCHARS+1;

  11330 10 011700   001025 235000 0                  LDA     P_PCB+9
        10 011701   000001 035007                    ADLA    1,DL
        10 011702   001025 755000 0                  STA     P_PCB+9

     2075    11331    1      GOTO NEXT;

  11331 10 011703   000204 710000 10                 TRA     NEXT

     2076    11332        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:404  
     2077    11333    1   ERROR: PROC(I)ALTRET;

  11333 10 011704   201340 741300       ERROR        STX1  ! P$+1,,AUTO

     2078    11334    2   DCL I SBIN;
     2079    11335    2   DCL AX UBIN;
     2080    11336    2   DCL WILD_XC REDEF AX CHAR(4);
     2081    11337    2   DCL AXP UBIN;
     2082    11338    2   DCL AXP$ REDEF AXP PTR;
     2083    11339    2   DCL BX UBIN;
     2084    11340    2   DCL BXB REDEF BX BIT(36);
     2085    11341    2   DCL BXP UBIN;
     2086    11342    2   DCL CHARS CHAR(120)BASED;
     2087    11343    2      CORR.V.DCB2#=DCBNUM(M$SI);

  11343 10 011705   000000 236007 xsym               LDQ     M$SI,DL
        10 011706   000000 620006                    EAX0    0,QL
        10 011707   000704 440000 0                  SXL0    CORR+2

     2088    11344    2      IF M$SI$->F$DCB.DDEV.IC THEN CALL M$CORRES(CORR)ALTRET(NO_EKO);

  11344 10 011710   001123 470400 0                  LDP0    M$SI$
        10 011711   000004 236100                    LDQ     4,,PR0
        10 011712   100000 316007                    CANQ    32768,DL
        10 011713   011720 600000 10                 TZE     s:11345

  11344 10 011714   000702 630400 0                  EPPR0   CORR
        10 011715   460000 713400                    CLIMB   alt,+24576
        10 011716   400000 401760                    pmme    nvectors=1
        10 011717   012015 702000 10                 TSX2    NO_EKO

     2089    11345    2      CORR.V.DCB2#=DCBNUM(M$LO);

  11345 10 011720   000000 236007 xsym               LDQ     M$LO,DL
        10 011721   000000 620006                    EAX0    0,QL
        10 011722   000704 440000 0                  SXL0    CORR+2

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:405  
     2090    11346    2      CALL M$CORRES(CORR)ALTRET(NO_EKO);

  11346 10 011723   000702 630400 0                  EPPR0   CORR
        10 011724   460000 713400                    CLIMB   alt,+24576
        10 011725   400000 401760                    pmme    nvectors=1
        10 011726   012015 702000 10                 TSX2    NO_EKO

     2091    11347    3      DO CASE(I);

  11347 10 011727   201341 470500                    LDP0    @I,,AUTO
        10 011730   000000 235100                    LDA     0,,PR0
        10 011731   000010 115007                    CMPA    8,DL
        10 011732   011734 602005 10                 TNC     s:11347+5,AL
        10 011733   012015 710000 10                 TRA     NO_EKO
        10 011734   012015 710000 10                 TRA     NO_EKO
        10 011735   011744 710000 10                 TRA     s:11349
        10 011736   011744 710000 10                 TRA     s:11349
        10 011737   012015 710000 10                 TRA     NO_EKO
        10 011740   012015 710000 10                 TRA     NO_EKO
        10 011741   011744 710000 10                 TRA     s:11349
        10 011742   011744 710000 10                 TRA     s:11349
        10 011743   011744 710000 10                 TRA     s:11349

     2092    11348    3      CASE(1,2,5,6,7); /*ERROR MESSAGES*/

     2093    11349    3         LOFPT.BUF_=ERRVEC(4);

  11349 10 011744   000000 100400                    MLR     fill='000'O
        10 011745   000237 000010 2                  ADSC9   ERRVEC+8                 cn=0,n=8
        10 011746   001054 000010 0                  ADSC9   LOFPT+4                  cn=0,n=8

     2094    11350    3         LOFPT.V.DCB#=DCBNUM(M$DO);

  11350 10 011747   000000 236007 xsym               LDQ     M$DO,DL
        10 011750   000000 620006                    EAX0    0,QL
        10 011751   001060 740000 0                  STX0    LOFPT+8

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:406  
     2095    11351    3         IF TCXT~=' ' AND P_PCB.NCHARS~=0

  11351 10 011752   040000 106400                    CMPC    fill='040'O
        10 011753   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256
        10 011754   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 011755   011765 600000 10                 TZE     s:11353
        10 011756   001025 235000 0                  LDA     P_PCB+9
        10 011757   011765 600000 10                 TZE     s:11353

     2096    11352    3         THEN TCXT=SUBSTR(P_PCB.TEXT$->CHARS,0,P_PCB.NCHARS);

  11352 10 011760   001014 471400 0                  LDP1    P_PCB
        10 011761   000000 621005                    EAX1    0,AL
        10 011762   040000 100540                    MLR     fill='040'O
        10 011763   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        10 011764   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256

     2097    11353    4         DO WHILE(SUBSTR(TCXT,LOFPT.BUF_.BOUND,1)=' ');

  11353 10 011765   011775 710000 10                 TRA     s:11355

     2098    11354    4            LOFPT.BUF_.BOUND=LOFPT.BUF_.BOUND-1;

  11354 10 011766   001054 236000 0                  LDQ     LOFPT+4
        10 011767   000020 772000                    QRL     16
        10 011770   000001 136007                    SBLQ    1,DL
        10 011771   000020 736000                    QLS     16
        10 011772   001054 676000 0                  ERQ     LOFPT+4
        10 011773   000034 376000 xsym               ANQ     B_VECTNIL+28
        10 011774   001054 656000 0                  ERSQ    LOFPT+4

     2099    11355    4            END;

  11355 10 011775   001054 236000 0                  LDQ     LOFPT+4
        10 011776   000020 772000                    QRL     16
        10 011777   040000 106406                    CMPC    fill='040'O
        10 012000   000706 000001 0                  ADSC9   TEXT,Q                   cn=0,n=1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:407  
        10 012001   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 012002   011766 600000 10                 TZE     s:11354

     2100    11356    3         IF TCXT~=' ' THEN CALL M$WRITE(LOFPT);

  11356 10 012003   040000 106400                    CMPC    fill='040'O
        10 012004   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256
        10 012005   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 012006   012012 600000 10                 TZE     s:11357

  11356 10 012007   001050 630400 0                  EPPR0   LOFPT
        10 012010   040001 713400                    CLIMB   write
        10 012011   401400 401760                    pmme    nvectors=4

     2101    11357    3         TCXT=' ';

  11357 10 012012   040000 100400                    MLR     fill='040'O
        10 012013   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 012014   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256

     2102    11358    3      END;

  11356 10 012015                       NO_EKO       null
     2103    11359    2   NO_EKO:;
     2104    11360    2      LOFPT.BUF_=ERRVEC(I);

  11360 10 012015   201341 470500                    LDP0    @I,,AUTO
        10 012016   000000 235100                    LDA     0,,PR0
        10 012017   000003 735000                    ALS     3
        10 012020   000000 100405                    MLR     fill='000'O
        10 012021   000227 000010 2                  ADSC9   ERRVEC,A                 cn=0,n=8
        10 012022   001054 000010 0                  ADSC9   LOFPT+4                  cn=0,n=8

     2105    11361    3      DO WHILE (SUBSTR(LOFPT.BUF_.BUF$->CHARS,LOFPT.BUF_.BOUND,1)=' '

  11361 10 012023   012033 710000 10                 TRA     s:11364

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:408  
     2106    11362    3        AND LOFPT.BUF_.BOUND>0);
     2107    11363    3         LOFPT.BUF_.BOUND=LOFPT.BUF_.BOUND-1;

  11363 10 012024   001054 236000 0                  LDQ     LOFPT+4
        10 012025   000020 772000                    QRL     16
        10 012026   000001 136007                    SBLQ    1,DL
        10 012027   000020 736000                    QLS     16
        10 012030   001054 676000 0                  ERQ     LOFPT+4
        10 012031   000034 376000 xsym               ANQ     B_VECTNIL+28
        10 012032   001054 656000 0                  ERSQ    LOFPT+4

     2108    11364    3         END;

  11364 10 012033   001054 236000 0                  LDQ     LOFPT+4
        10 012034   000020 772000                    QRL     16
        10 012035   001055 470400 0                  LDP0    LOFPT+5
        10 012036   040000 106506                    CMPC    fill='040'O
        10 012037   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
        10 012040   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 012041   012045 601000 10                 TNZ     s:11365
        10 012042   001054 236000 0                  LDQ     LOFPT+4
        10 012043   000034 316000 xsym               CANQ    B_VECTNIL+28
        10 012044   012024 601000 10                 TNZ     s:11363

     2109    11365    2      LOFPT.V.DCB#=DCBNUM(M$LO);

  11365 10 012045   000000 236007 xsym               LDQ     M$LO,DL
        10 012046   000000 620006                    EAX0    0,QL
        10 012047   001060 740000 0                  STX0    LOFPT+8

     2110    11366    3      CALL M$WRITE(LOFPT) WHENALTRETURN DO;

  11366 10 012050   001050 630400 0                  EPPR0   LOFPT
        10 012051   440001 713400                    CLIMB   alt,write
        10 012052   401400 401760                    pmme    nvectors=4
        10 012053   012055 702000 10                 TSX2    s:11367
        10 012054   012061 710000 10                 TRA     s:11369
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:409  

     2111    11367    3         IF MODE~=0 THEN CALL M$MERC;

  11367 10 012055   001121 235000 0                  LDA     MODE
        10 012056   012061 600000 10                 TZE     s:11369

  11367 10 012057   010007 713400                    CLIMB   4103
        10 012060   000000 401760                    pmme    nvectors=0

     2112    11368    3         END;

     2113    11369    2      IF MODE~=0 THEN WIDTH=M$LO$->F$DCB.WIDTH;

  11369 10 012061   001121 235000 0                  LDA     MODE
        10 012062   012067 600000 10                 TZE     s:11370

  11369 10 012063   001122 470400 0                  LDP0    M$LO$
        10 012064   000004 236100                    LDQ     4,,PR0
        10 012065   000777 376007                    ANQ     511,DL
        10 012066   001124 756000 0                  STQ     WIDTH

     2114    11370    2      IF WIDTH>=109 OR WIDTH=0 THEN WIDTH=108;

  11370 10 012067   001124 236000 0                  LDQ     WIDTH
        10 012070   000155 116007                    CMPQ    109,DL
        10 012071   012074 603000 10                 TRC     s:11370+5
        10 012072   000000 116003                    CMPQ    0,DU
        10 012073   012076 601000 10                 TNZ     s:11371

  11370 10 012074   000154 235007                    LDA     108,DL
        10 012075   001124 755000 0                  STA     WIDTH

     2115    11371    3      IF MODE~=0 THEN DO CASE(I);

  11371 10 012076   001121 235000 0                  LDA     MODE
        10 012077   012137 600000 10                 TZE     s:11383

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:410  
  11371 10 012100   201341 470500                    LDP0    @I,,AUTO
        10 012101   000000 235100                    LDA     0,,PR0
        10 012102   000010 115007                    CMPA    8,DL
        10 012103   012105 602005 10                 TNC     s:11371+7,AL
        10 012104   012115 710000 10                 TRA     s:11373
        10 012105   012115 710000 10                 TRA     s:11373
        10 012106   012117 710000 10                 TRA     s:11375
        10 012107   012117 710000 10                 TRA     s:11375
        10 012110   012115 710000 10                 TRA     s:11373
        10 012111   012115 710000 10                 TRA     s:11373
        10 012112   012117 710000 10                 TRA     s:11375
        10 012113   012117 710000 10                 TRA     s:11375
        10 012114   012117 710000 10                 TRA     s:11375

     2116    11372    3      CASE(ELSE);

     2117    11373    3         RETURN;

  11373 10 012115   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012116   000001 702211                    TSX2  ! 1,X1

     2118    11374    3      CASE(1,2,5,6,7); /*ERROR MESSAGES*/

     2119    11375    3         BANNERSZ=0; /* SET STEPCC FLAG */

  11375 10 012117   001126 450000 0                  STZ     BANNERSZ

     2120    11376    3         CORR.V.DCB2#=DCBNUM(M$LO);

  11376 10 012120   000000 236007 xsym               LDQ     M$LO,DL
        10 012121   000000 620006                    EAX0    0,QL
        10 012122   000704 440000 0                  SXL0    CORR+2

     2121    11377    3         CALL M$CORRES(CORR)ALTRET(NO_DO);

  11377 10 012123   000702 630400 0                  EPPR0   CORR
        10 012124   460000 713400                    CLIMB   alt,+24576
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:411  
        10 012125   400000 401760                    pmme    nvectors=1
        10 012126   012135 702000 10                 TSX2    NO_DO

     2122    11378    3         LOFPT.V.DCB#=DCBNUM(M$DO);

  11378 10 012127   000000 236007 xsym               LDQ     M$DO,DL
        10 012130   000000 620006                    EAX0    0,QL
        10 012131   001060 740000 0                  STX0    LOFPT+8

     2123    11379    3         CALL M$WRITE(LOFPT);

  11379 10 012132   001050 630400 0                  EPPR0   LOFPT
        10 012133   040001 713400                    CLIMB   write
        10 012134   401400 401760                    pmme    nvectors=4

  11378 10 012135                       NO_DO        null
     2124    11380    3   NO_DO:;
     2125    11381    3         RETURN;

  11381 10 012135   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012136   000001 702211                    TSX2  ! 1,X1

     2126    11382    3      END;

     2127    11383    3      IF BLK$~=WORK_.FIRST$ THEN DO;

  11383 10 012137   001073 236000 0                  LDQ     BLK$
        10 012140   001013 116000 0                  CMPQ    WORK_+1
        10 012141   012230 600000 10                 TZE     s:11395

     2128    11384    3         BLK$=PINCRW(WORK_.FIRST$,20);

  11384 10 012142   001013 236000 0                  LDQ     WORK_+1
        10 012143   000024 036003                    ADLQ    20,DU
        10 012144   001073 756000 0                  STQ     BLK$

     2129    11385    3         IF P_TO_S.COUNT>4000 THEN P_TO_S.COUNT=0;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:412  

  11385 10 012145   001073 470400 0                  LDP0    BLK$
        10 012146   000001 220100                    LDX0    1,,PR0
        10 012147   007641 100003                    CMPX0   4001,DU
        10 012150   012153 602000 10                 TNC     s:11386

  11385 10 012151   000000 221003                    LDX1    0,DU
        10 012152   000001 741100                    STX1    1,,PR0

     2130    11386    3         AX=LOFPT.BUF_.BOUND+1;

  11386 10 012153   001054 236000 0                  LDQ     LOFPT+4
        10 012154   000020 772000                    QRL     16
        10 012155   000001 036007                    ADLQ    1,DL
        10 012156   201342 756100                    STQ     AX,,AUTO

     2131    11387    3         CALL CONCAT(ADDR(P_TO_S.TEXT(P_TO_S.COUNT))->CHARS,BINASC(AX),

  11387 10 012157   001073 470400 0                  LDP0    BLK$
        10 012160   000001 236100                    LDQ     1,,PR0
        10 012161   000022 772000                    QRL     18
        10 012162   201346 756100                    STQ     BXP+1,,AUTO
        10 012163   201342 236100                    LDQ     AX,,AUTO
        10 012164   000033 736000                    QLS     27
        10 012165   000010 276000 11                 ORQ     8
        10 012166   201347 756100                    STQ     BXP+2,,AUTO
        10 012167   201346 235100                    LDA     BXP+1,,AUTO
        10 012170   040105 100500                    MLR     fill='040'O
        10 012171   201347 000004                    ADSC9   BXP+2,,AUTO              cn=0,n=4
        10 012172   000001 400001                    ADSC9   1,A,PR0                  cn=2,n=1
        10 012173   001055 470400 0                  LDP0    LOFPT+5
        10 012174   201342 720100                    LXL0    AX,,AUTO
        10 012175   001073 471400 0                  LDP1    BLK$
        10 012176   040105 100540                    MLR     fill='040'O
        10 012177   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        10 012200   100001 600167                    ADSC9   1,A,PR1                  cn=3,n=119

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:413  
     2132    11388    3           SUBSTR(LOFPT.BUF_.BUF$->CHARS,0,AX));
     2133    11389    3         P_TO_S.COUNT=P_TO_S.COUNT+AX+1;

  11389 10 012201   001073 470400 0                  LDP0    BLK$
        10 012202   000001 236100                    LDQ     1,,PR0
        10 012203   000022 772000                    QRL     18
        10 012204   201342 036100                    ADLQ    AX,,AUTO
        10 012205   000001 620006                    EAX0    1,QL
        10 012206   000001 740100                    STX0    1,,PR0

     2134    11390    3         IF I<8 THEN IF FLAG THEN P_TO_S.ERR=BITBIN(FLAG);

  11390 10 012207   201341 470500                    LDP0    @I,,AUTO
        10 012210   000000 235100                    LDA     0,,PR0
        10 012211   000010 115007                    CMPA    8,DL
        10 012212   012224 605000 10                 TPL     s:11392

  11390 10 012213   001107 236000 0                  LDQ     FLAG
        10 012214   012221 600000 10                 TZE     s:11391

  11390 10 012215   001073 471400 0                  LDP1    BLK$
        10 012216   001107 235000 0                  LDA     FLAG
        10 012217   100000 755100                    STA     0,,PR1
        10 012220   012226 710000 10                 TRA     s:11393

     2135    11391    3         ELSE P_TO_S.ERR=I;

  11391 10 012221   001073 471400 0                  LDP1    BLK$
        10 012222   100000 755100                    STA     0,,PR1
        10 012223   012226 710000 10                 TRA     s:11393

     2136    11392    3         ELSE P_TO_S.ERR=0;

  11392 10 012224   001073 471400 0                  LDP1    BLK$
        10 012225   100000 450100                    STZ     0,,PR1

     2137    11393    3         RETURN;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:414  

  11393 10 012226   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012227   000001 702211                    TSX2  ! 1,X1

     2138    11394    3         END;
     2139    11395    3      IF I=2 THEN DO;

  11395 10 012230   201341 470500                    LDP0    @I,,AUTO
        10 012231   000000 235100                    LDA     0,,PR0
        10 012232   000002 115007                    CMPA    2,DL
        10 012233   012246 601000 10                 TNZ     s:11400

     2140    11396    3         IF WROC.CADDR='0'B THEN WROC.CADDR=M_DISK;

  11396 10 012234   006666 220000 0                  LDX0    WROC
        10 012235   012240 601000 10                 TNZ     s:11397

  11396 10 012236   100000 221003                    LDX1    32768,DU
        10 012237   006666 741000 0                  STX1    WROC

     2141    11397    3         WROC.N=CODE;

  11397 10 012240   200007 720100                    LXL0    CODE,,AUTO
        10 012241   006677 440000 0                  SXL0    WROC+9

     2142    11398    3         WROC.PSN=OPNSN.SN#(0);

  11398 10 012242   040000 100400                    MLR     fill='040'O
        10 012243   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 012244   006676 000006 0                  ADSC9   WROC+8                   cn=0,n=6

     2143    11399    3         END;

  11399 10 012245   012252 710000 10                 TRA     s:11401

     2144    11400    2      ELSE IF I~=10 THEN WROC.CADDR='0'B;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:415  
  11400 10 012246   000012 115007                    CMPA    10,DL
        10 012247   012252 600000 10                 TZE     s:11401

  11400 10 012250   000000 220003                    LDX0    0,DU
        10 012251   006666 740000 0                  STX0    WROC

     2145    11401    3      IF WROC.CADDR THEN DO;

  11401 10 012252   006666 220000 0                  LDX0    WROC
        10 012253   012275 600000 10                 TZE     s:11409

     2146    11402    4         IF WROC.MSG#=PKSET_MSG# THEN DO;

  11402 10 012254   006666 721000 0                  LXL1    WROC
        10 012255   000456 101003                    CMPX1   302,DU
        10 012256   012272 601000 10                 TNZ     s:11407

     2147    11403    4            LBUFC=SUBSTR(LBUFC,GRANULE);

  11403 10 012257   001113 722000 0                  LXL2    GRANULE
        10 012260   777607 622012                    EAX2    -121,X2
        10 012261   777777 662003                    ERX2    -1,DU
        10 012262   001113 235000 0                  LDA     GRANULE
        10 012263   040000 100445                    MLR     fill='040'O
        10 012264   006702 000012 0                  ADSC9   LBUFC,A                  cn=0,n=*X2
        10 012265   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

     2148    11404    4            GRANULE=I0;

  11404 10 012266   001077 235000 0                  LDA     I0
        10 012267   001113 755000 0                  STA     GRANULE

     2149    11405    4            WIDTH=I0+50;

  11405 10 012270   000062 035007                    ADLA    50,DL
        10 012271   001124 755000 0                  STA     WIDTH

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:416  
     2150    11406    4            END;

     2151    11407    3         CALL M$WRITE(OCMSG);

  11407 10 012272   000356 630400 0                  EPPR0   OCMSG
        10 012273   040001 713400                    CLIMB   write
        10 012274   401400 401760                    pmme    nvectors=4

     2152    11408    3         END;

     2153    11409    3      IF ZAP THEN DO;

  11409 10 012275   001106 234000 0                  SZN     ZAP
        10 012276   012337 605000 10                 TPL     s:11419

     2154    11410    3         X9=FM$CFUX.SETH;

  11410 10 012277   000000 470400 xsym               LDP0    F$CFU$
        10 012300   000005 236100                    LDQ     5,,PR0
        10 012301   000022 772000                    QRL     18
        10 012302   200006 756100                    STQ     X9,,AUTO

     2155    11411    4         DO WHILE(X9~=0);

  11411 10 012303   012330 600000 10                 TZE     s:11415

     2156    11412    4            IF FM$SET.SET(X9) AND FM$SET.PSN(X9)~='SYS' THEN RETURN;

  11412 10 012304   200006 235100                    LDA     X9,,AUTO
        10 012305   000003 735000                    ALS     3
        10 012306   000000 470400 xsym               LDP0    F$CFU$
        10 012307   000002 236105                    LDQ     2,AL,PR0
        10 012310   200000 316003                    CANQ    65536,DU
        10 012311   012322 600000 10                 TZE     s:11413
        10 012312   200006 235100                    LDA     X9,,AUTO
        10 012313   000005 735000                    ALS     5
        10 012314   040000 106505                    CMPC    fill='040'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:417  
        10 012315   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6
        10 012316   000520 000003 2                  ADSC9   FFLGS+41                 cn=0,n=3
        10 012317   012322 600000 10                 TZE     s:11413

  11412 10 012320   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012321   000001 702211                    TSX2  ! 1,X1

     2157    11413    4            X9=FM$SET.SETL(X9);

  11413 10 012322   200006 235100                    LDA     X9,,AUTO
        10 012323   000003 735000                    ALS     3
        10 012324   000005 236105                    LDQ     5,AL,PR0
        10 012325   000022 772000                    QRL     18
        10 012326   200006 756100                    STQ     X9,,AUTO

     2158    11414    4            END;

  11414 10 012327   012304 601000 10                 TNZ     s:11412

     2159    11415    3         WROC.MSG#=PREZAP_MSG#;

  11415 10 012330   001777 220003                    LDX0    1023,DU
        10 012331   006666 440000 0                  SXL0    WROC

     2160    11416    3         WROC.CADDR=M_DISK;

  11416 10 012332   100000 221003                    LDX1    32768,DU
        10 012333   006666 741000 0                  STX1    WROC

     2161    11417    3         CALL M$WRITE(OCMSG);

  11417 10 012334   000356 630400 0                  EPPR0   OCMSG
        10 012335   040001 713400                    CLIMB   write
        10 012336   401400 401760                    pmme    nvectors=4

     2162    11418    3         END;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:418  
     2163    11419    2      RETURN;

  11419 10 012337   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012340   000001 702211                    TSX2  ! 1,X1

     2164    11420        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:419  
     2165    11421    2   CATREAD: ENTRY ALTRET;

  11421 10 012341   201340 741300       CATREAD      STX1  ! P$+1,,AUTO

     2166    11422    2      CALL M$READ(READCAT)ALTRET(AARGH);

  11422 10 012342   000266 630400 0                  EPPR0   READCAT
        10 012343   440000 713400                    CLIMB   alt,read
        10 012344   401400 401760                    pmme    nvectors=4
        10 012345   012346 702000 10                 TSX2    AARGH

  11415 10 012346                       AARGH        null
     2167    11423    2   AARGH:;
     2168    11424    2      NUMPSNS=(DCBADDR(READCAT.V.DCB#)->F$DCB.ARS

  11424 10 012346   000001 470400 11                 LDP0    1
        10 012347   000000 471500                    LDP1    0,,PR0
        10 012350   000276 220000 0                  LDX0    READCAT+8
        10 012351   100000 473510                    LDP3    0,X0,PR1
        10 012352   000152 236000 11                 LDQ     106
        10 012353   000020 772000                    QRL     16
        10 012354   201346 756100                    STQ     BXP+1,,AUTO
        10 012355   000153 236000 11                 LDQ     107
        10 012356   000020 772000                    QRL     16
        10 012357   201346 136100                    SBLQ    BXP+1,,AUTO
        10 012360   201347 756100                    STQ     BXP+2,,AUTO
        10 012361   300000 236100                    LDQ     0,,PR3
        10 012362   201347 136100                    SBLQ    BXP+2,,AUTO
        10 012363   000010 506007                    DIV     8,DL
        10 012364   004621 756000 0                  STQ     CSTAT

     2169    11425    2        -POFFC(ADDR(CSTAT.SETS(1)),ADDR(CSTAT)))/SIZEC(CSTAT.SETS(0));
     2170    11426    2      IF NUMPSNS>510 THEN NUMPSNS=0;

  11426 10 012365   000777 116007                    CMPQ    511,DL
        10 012366   012370 602000 10                 TNC     s:11427

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:420  
  11426 10 012367   004621 450000 0                  STZ     CSTAT

     2171    11427    2      RETURN;

  11427 10 012370   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012371   000001 702211                    TSX2  ! 1,X1

     2172    11428    2   CATWRITE: ENTRY ALTRET;

  11428 10 012372   201340 741300       CATWRITE     STX1  ! P$+1,,AUTO

     2173    11429    2      WRITECAT.BUF_.BOUND=POFFC(ADDR(CSTAT.SETS(NUMPSNS+1)),ADDR(CSTAT))-1;

  11429 10 012373   000152 236000 11                 LDQ     106
        10 012374   000020 772000                    QRL     16
        10 012375   201346 756100                    STQ     BXP+1,,AUTO
        10 012376   004621 236000 0                  LDQ     CSTAT
        10 012377   000023 736000                    QLS     19
        10 012400   000153 036000 11                 ADLQ    107
        10 012401   000020 772000                    QRL     16
        10 012402   201346 136100                    SBLQ    BXP+1,,AUTO
        10 012403   000001 136007                    SBLQ    1,DL
        10 012404   000020 736000                    QLS     16
        10 012405   000310 676000 0                  ERQ     WRITECAT+4
        10 012406   000034 376000 xsym               ANQ     B_VECTNIL+28
        10 012407   000310 656000 0                  ERSQ    WRITECAT+4

     2174    11430    2      CALL M$WRITE(WRITECAT)ALTRET(RETALT);

  11430 10 012410   000304 630400 0                  EPPR0   WRITECAT
        10 012411   440001 713400                    CLIMB   alt,write
        10 012412   401400 401760                    pmme    nvectors=4
        10 012413   012441 702000 10                 TSX2    RETALT

     2175    11431    2      RETURN;

  11431 10 012414   201340 221300                    LDX1  ! P$+1,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:421  
        10 012415   000001 702211                    TSX2  ! 1,X1

     2176    11432    2   CLOSE:ENTRY(I) ALTRET;

  11432 10 012416   201340 741300       CLOSE        STX1  ! P$+1,,AUTO

     2177    11433    2      CLOSE1.V.DCB#=I;

  11433 10 012417   201341 470500                    LDP0    @I,,AUTO
        10 012420   000000 720100                    LXL0    0,,PR0
        10 012421   000262 740000 0                  STX0    CLOSE1+26

     2178    11434    3      CALL M$CLOSE(CLOSE1) WHENRETURN DO;

  11434 10 012422   000230 630400 0                  EPPR0   CLOSE1
        10 012423   450001 713400                    CLIMB   alt,close
        10 012424   406000 401760                    pmme    nvectors=13
        10 012425   012430 702000 10                 TSX2    s:11437

     2179    11435    3         RETURN;

  11435 10 012426   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012427   000001 702211                    TSX2  ! 1,X1

     2180    11436    3         END;
     2181    11437    2      IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(AX);

  11437 10 012430   000000 636000 xent               EAQ     FXD$PMME
        10 012431   000002 116000 xsym               CMPQ    B_VECTNIL+2
        10 012432   012441 600000 10                 TZE     RETALT

  11437 10 012433   201342 630500                    EPPR0   AX,,AUTO
        10 012434   201346 450500                    STP0    BXP+1,,AUTO
        10 012435   201346 630500                    EPPR0   BXP+1,,AUTO
        10 012436   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 012437   000000 701000 xent               TSX1    FXD$PMME
        10 012440   000000 011000                    NOP     0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:422  

     2182    11438    2   RETALT: ALTRETURN;

  11438 10 012441   201340 221300       RETALT       LDX1  ! P$+1,,AUTO
        10 012442   000000 702211                    TSX2  ! 0,X1

     2183    11439                    /**/
     2184    11440        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:423  
     2185    11441    2   NXTACCT: ENTRY ALTRET;

  11441 10 012443   201340 741300       NXTACCT      STX1  ! P$+1,,AUTO

     2186    11442    2      CALL INDEX1(AX,'?',SELACCT);

  11442 10 012444   000000 124400                    SCM     mask='000'O
        10 012445   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8
        10 012446   000006 000001 11                 ADSC9   6                        cn=0,n=1
        10 012447   201342 000100                    ARG     AX,,AUTO

     2187    11443    2      IF VLP_ACCT.ACCT#=BINASC(0)

  11443 10 012450   000076 237000 0                  LDAQ    VLP_ACCT
        10 012451   000104 117000 11                 CMPAQ   68
        10 012452   012467 601000 10                 TNZ     s:11445

     2188    11444    2      THEN CALL CONCAT(VLP_ACCT.ACCT#,SUBSTR(SELACCT,0,AX),BINASC(0));

  11444 10 012453   201342 720100                    LXL0    AX,,AUTO
        10 012454   040000 100440                    MLR     fill='040'O
        10 012455   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=*X0
        10 012456   000076 000010 0                  ADSC9   VLP_ACCT                 cn=0,n=8
        10 012457   201342 236100                    LDQ     AX,,AUTO
        10 012460   000010 116007                    CMPQ    8,DL
        10 012461   012467 603000 10                 TRC     s:11445
        10 012462   777767 622006                    EAX2    -9,QL
        10 012463   777777 662003                    ERX2    -1,DU
        10 012464   040046 100400                    MLR     fill='040'O
        10 012465   000010 000001 11                 ADSC9   8                        cn=0,n=1
        10 012466   000076 000012 0                  ADSC9   VLP_ACCT,Q               cn=0,n=*X2

     2189    11445    3      IF AX=8 THEN IF USW OR MADM.V.DELETE# AND SELACCT~=' ' AND CODE~=0 THEN DO;

  11445 10 012467   201342 235100                    LDA     AX,,AUTO
        10 012470   000010 115007                    CMPA    8,DL
        10 012471   012513 601000 10                 TNZ     s:11452
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:424  

  11445 10 012472   001010 234000 0                  SZN     USW
        10 012473   012504 604000 10                 TMI     s:11446
        10 012474   000414 236000 0                  LDQ     MADM+6
        10 012475   100000 316007                    CANQ    32768,DL
        10 012476   012732 600000 10                 TZE     NOSEL
        10 012477   001006 237000 0                  LDAQ    SELACCT
        10 012500   000142 117000 11                 CMPAQ   98
        10 012501   012732 600000 10                 TZE     NOSEL
        10 012502   200007 235100                    LDA     CODE,,AUTO
        10 012503   012732 600000 10                 TZE     NOSEL

     2190    11446    3         ADDR(SUBSTR(VLP_ACCT.ACCT#,4))->BASED_UBIN =

  11446 10 012504   000077 235000 0                  LDA     VLP_ACCT+1
        10 012505   000001 135007                    SBLA    1,DL
        10 012506   000077 755000 0                  STA     VLP_ACCT+1

     2191    11447    3           ADDR(SUBSTR(VLP_ACCT.ACCT#,4))->BASED_UBIN-1;
     2192    11448    3         SELACCT='??';

  11448 10 012507   040000 100400                    MLR     fill='040'O
        10 012510   000607 000002 2                  ADSC9   FFLGS+96                 cn=0,n=2
        10 012511   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8

     2193    11449    3         END;

  11449 10 012512   012513 710000 10                 TRA     s:11452

     2194    11450    2      ELSE GOTO NOSEL;
     2195    11451    3      DO WHILE('1'B);

     2196    11452    4         IF PROJAD.L=0 THEN DO;

  11452 10 012513   001127 236000 0                  LDQ     PROJAD
        10 012514   777000 316003                    CANQ    -512,DU
        10 012515   012543 601000 10                 TNZ     s:11462
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:425  

     2197    11453    4            CALL M$OPEN(OPNXTA)ALTRET(NXTA1);

  11453 10 012516   000440 630400 0                  EPPR0   OPNXTA
        10 012517   450000 713400                    CLIMB   alt,open
        10 012520   410400 401760                    pmme    nvectors=18
        10 012521   012522 702000 10                 TSX2    NXTA1

  11453 10 012522                       NXTA1        null
     2198    11454    4   NXTA1:   ;
     2199    11455    4            IF F$DCB.ACCT=' ' THEN ALTRETURN;

  11455 10 012522   000000 470400 xsym               LDP0    M$DP$
        10 012523   000020 237100                    LDAQ    16,,PR0
        10 012524   000142 117000 11                 CMPAQ   98
        10 012525   012530 601000 10                 TNZ     s:11456

  11455 10 012526   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012527   000000 702211                    TSX2  ! 0,X1

     2200    11456    5            IF F$DCB.ACCT=VLP_ACCT.ACCT# THEN DO;

  11456 10 012530   000020 237100                    LDAQ    16,,PR0
        10 012531   000076 117000 0                  CMPAQ   VLP_ACCT
        10 012532   012540 601000 10                 TNZ     s:11460

     2201    11457    5               FLAG=B$ALT.ERR;

  11457 10 012533   000000 471400 xsym               LDP1    B$TCB$
        10 012534   100000 473500                    LDP3    0,,PR1
        10 012535   300102 236100                    LDQ     66,,PR3
        10 012536   001107 756000 0                  STQ     FLAG

     2202    11458    5               GOTO ACCTERR;

  11458 10 012537   012767 710000 10                 TRA     ACCTERR

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:426  
     2203    11459    5               END;
     2204    11460    4            VLP_ACCT.ACCT#=F$DCB.ACCT;

  11460 10 012540   000020 237100                    LDAQ    16,,PR0
        10 012541   000076 757000 0                  STAQ    VLP_ACCT

     2205    11461    4            END;

  11461 10 012542   012552 710000 10                 TRA     s:11464

     2206    11462    3         ELSE IF CODE=%E$CREATE THEN GOTO NOSEL;

  11462 10 012543   200007 235100                    LDA     CODE,,AUTO
        10 012544   000153 115007                    CMPA    107,DL
        10 012545   012732 600000 10                 TZE     NOSEL

     2207    11463    3         ELSE CALL FXU$PROJNA(VLP_ACCT)ALTRET(RETALT);

  11463 10 012546   000130 630400 11                 EPPR0   88
        10 012547   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 012550   000000 701000 xent               TSX1    FXU$PROJNA
        10 012551   012441 702000 10                 TSX2    RETALT

     2208    11464    3         IF BREAK~=0 THEN RETURN;

  11464 10 012552   001125 235000 0                  LDA     BREAK
        10 012553   012556 600000 10                 TZE     s:11490

  11464 10 012554   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012555   000001 702211                    TSX2  ! 1,X1

     2209    11465        %LIST;
     2210    11466              %WILD_COMPARE(WILD_CHARS=SELACCT,
     2211    11467              COMPARE_CHARS=VLP_ACCT.ACCT#,
     2212    11468              WILD_X=AX,
     2213    11469              WILD_XP=AXP,
     2214    11470              COMPARE_X=BX,
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:427  
     2215    11471              COMPARE_XP=BXP,
     2216    11472              NO_MATCH=GOTO NOMATCH);
             11473        %LSET LISTDIR='0'B;
             11490    3           WILD_XC=SELACCT;

  11490 10 012556   001006 236000 0                  LDQ     SELACCT
        10 012557   201342 756100                    STQ     AX,,AUTO

             11491    4           IF (BINBIT(AX,36)&'737737737777'O)='101114114040'O THEN DO;

  11491 10 012560   201342 236100                    LDQ     AX,,AUTO
        10 012561   000611 376000 2                  ANQ     FFLGS+98
        10 012562   000612 116000 2                  CMPQ    FFLGS+99
        10 012563   012571 601000 10                 TNZ     s:11505

             11492    4              AX=3;

  11492 10 012564   000003 236007                    LDQ     3,DL
        10 012565   201342 756100                    STQ     AX,,AUTO

             11493    4              AXP=2;

  11493 10 012566   000002 235007                    LDA     2,DL
        10 012567   201343 755100                    STA     AXP,,AUTO

             11494    4              END;

  11494 10 012570   012574 710000 10                 TRA     s:11508

             11504    4           ELSE DO;

             11505    4              AX=0;

  11505 10 012571   201342 450100                    STZ     AX,,AUTO

             11506    4              AXP=SIZEC(SELACCT);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:428  
  11506 10 012572   000010 236007                    LDQ     8,DL
        10 012573   201343 756100                    STQ     AXP,,AUTO

             11507    4              END;

             11508    3           BX=0;

  11508 10 012574   201344 450100                    STZ     BX,,AUTO

             11509    3           BXP=0;

  11509 10 012575   201345 450100                    STZ     BXP,,AUTO

             11513    4           DO WHILE(AX<SIZEC(SELACCT) AND SUBSTR(SELACCT,AX,1)~=' '

  11513 10 012576   012650 710000 10                 TRA     s:11538

             11514    4             OR BX<SIZEC(VLP_ACCT.ACCT#) AND SUBSTR(VLP_ACCT.ACCT#,BX,1)~=' ');
             11515    5              IF AX<SIZEC(SELACCT) AND SUBSTR(SELACCT,AX,1)='?' THEN DO;

  11515 10 012577   201342 235100                    LDA     AX,,AUTO
        10 012600   000010 115007                    CMPA    8,DL
        10 012601   012610 603000 10                 TRC     s:11519
        10 012602   040000 106405                    CMPC    fill='040'O
        10 012603   001006 000001 0                  ADSC9   SELACCT,A                cn=0,n=1
        10 012604   000006 000001 11                 ADSC9   6                        cn=0,n=1
        10 012605   012610 601000 10                 TNZ     s:11519

             11516    5                 AXP=AX;

  11516 10 012606   201343 755100                    STA     AXP,,AUTO

             11517    5                 END;

  11517 10 012607   012644 710000 10                 TRA     s:11537

             11518    5              ELSE DO;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:429  

             11519    5                 IF AX=AXP+1 THEN BXP=BX;

  11519 10 012610   201343 236100                    LDQ     AXP,,AUTO
        10 012611   000001 036007                    ADLQ    1,DL
        10 012612   201342 116100                    CMPQ    AX,,AUTO
        10 012613   012616 601000 10                 TNZ     s:11520

  11519 10 012614   201344 235100                    LDA     BX,,AUTO
        10 012615   201345 755100                    STA     BXP,,AUTO

             11520    5                 IF AX>=SIZEC(SELACCT)

  11520 10 012616   201342 235100                    LDA     AX,,AUTO
        10 012617   000010 115007                    CMPA    8,DL
        10 012620   012632 603000 10                 TRC     s:11524
        10 012621   201344 235100                    LDA     BX,,AUTO
        10 012622   000010 115007                    CMPA    8,DL
        10 012623   012632 603000 10                 TRC     s:11524
        10 012624   201342 235100                    LDA     AX,,AUTO
        10 012625   201344 236100                    LDQ     BX,,AUTO
        10 012626   040006 106405                    CMPC    fill='040'O
        10 012627   001006 000001 0                  ADSC9   SELACCT,A                cn=0,n=1
        10 012630   000076 000001 0                  ADSC9   VLP_ACCT,Q               cn=0,n=1
        10 012631   012642 600000 10                 TZE     s:11535

             11521    5                   OR BX>=SIZEC(VLP_ACCT.ACCT#)
             11522    5                   OR SUBSTR(SELACCT,AX,1) ~=
             11523    6                   SUBSTR(VLP_ACCT.ACCT#,BX,1) THEN DO;

             11524    6                    IF AXP=SIZEC(SELACCT) OR BXP=SIZEC(VLP_ACCT.ACCT#)

  11524 10 012632   201343 235100                    LDA     AXP,,AUTO
        10 012633   000010 115007                    CMPA    8,DL
        10 012634   012725 600000 10                 TZE     NOMATCH
        10 012635   201345 236100                    LDQ     BXP,,AUTO
        10 012636   000010 116007                    CMPQ    8,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:430  
        10 012637   012725 600000 10                 TZE     NOMATCH

             11525    6                    THEN GOTO NOMATCH;
             11526    6                    AX=AXP;

  11526 10 012640   201342 755100                    STA     AX,,AUTO

             11530    6                    BX=BXP;

  11530 10 012641   201344 756100                    STQ     BX,,AUTO

             11531    6                    END;

             11535    5                 BX=BX+1;

  11535 10 012642   000001 036007                    ADLQ    1,DL
        10 012643   201344 756100                    STQ     BX,,AUTO

             11536    5                 END;

             11537    4              IF AX<SIZEC(SELACCT) THEN AX=AX+1;

  11537 10 012644   000010 115007                    CMPA    8,DL
        10 012645   012650 603000 10                 TRC     s:11538

  11537 10 012646   000001 035007                    ADLA    1,DL
        10 012647   201342 755100                    STA     AX,,AUTO

             11538    4   END;

  11538 10 012650   201342 235100                    LDA     AX,,AUTO
        10 012651   000010 115007                    CMPA    8,DL
        10 012652   012657 603000 10                 TRC     s:11538+7
        10 012653   040000 106405                    CMPC    fill='040'O
        10 012654   001006 000001 0                  ADSC9   SELACCT,A                cn=0,n=1
        10 012655   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 012656   012577 601000 10                 TNZ     s:11515
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:431  
        10 012657   201344 236100                    LDQ     BX,,AUTO
        10 012660   000010 116007                    CMPQ    8,DL
        10 012661   012666 603000 10                 TRC     s:11543
        10 012662   040000 106406                    CMPC    fill='040'O
        10 012663   000076 000001 0                  ADSC9   VLP_ACCT,Q               cn=0,n=1
        10 012664   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 012665   012577 601000 10                 TNZ     s:11515

     2217    11543    3         IF B$ALT.ERR.CODE=%E$NOKEY AND PROJAD.L=0

  11543 10 012666   000000 470400 xsym               LDP0    B$TCB$
        10 012667   000000 471500                    LDP1    0,,PR0
        10 012670   100102 236100                    LDQ     66,,PR1
        10 012671   377770 376007                    ANQ     131064,DL
        10 012672   001020 116007                    CMPQ    528,DL
        10 012673   012706 601000 10                 TNZ     s:11545
        10 012674   001127 236000 0                  LDQ     PROJAD
        10 012675   777000 316003                    CANQ    -512,DU
        10 012676   012706 601000 10                 TNZ     s:11545
        10 012677   200007 235100                    LDA     CODE,,AUTO
        10 012700   000165 115007                    CMPA    117,DL
        10 012701   012725 601000 10                 TNZ     NOMATCH
        10 012702   040000 106400                    CMPC    fill='040'O
        10 012703   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 012704   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 012705   012725 601000 10                 TNZ     NOMATCH

     2218    11544    3           AND (CODE~=%E$MADLIST OR OPNSN.SN#(0)~=' ') THEN GOTO NOMATCH;
     2219    11545    3         IF USW THEN SELACCT='??'; /* AND ALL THE REST */

  11545 10 012706   001010 234000 0                  SZN     USW
        10 012707   012714 605000 10                 TPL     s:11546

  11545 10 012710   040000 100400                    MLR     fill='040'O
        10 012711   000607 000002 2                  ADSC9   FFLGS+96                 cn=0,n=2
        10 012712   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8
        10 012713   012723 710000 10                 TRA     s:11547
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:432  

     2220    11546    3         ELSE IF SELACCT='??' THEN SELACCT=' ';

  11546 10 012714   040000 106400                    CMPC    fill='040'O
        10 012715   001006 000010 0                  ADSC9   SELACCT                  cn=0,n=8
        10 012716   000607 000002 2                  ADSC9   FFLGS+96                 cn=0,n=2
        10 012717   012723 601000 10                 TNZ     s:11547

  11546 10 012720   000035 235000 xsym               LDA     B_VECTNIL+29
        10 012721   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 012722   001006 757000 0                  STAQ    SELACCT

     2221    11547    3         RETURN;

  11547 10 012723   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012724   000001 702211                    TSX2  ! 1,X1

     2222    11548    3   NOMATCH: IF AXP=8 THEN ALTRETURN;

  11548 10 012725   201343 235100       NOMATCH      LDA     AXP,,AUTO
        10 012726   000010 115007                    CMPA    8,DL
        10 012727   012513 601000 10                 TNZ     s:11452

  11548 10 012730   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012731   000000 702211                    TSX2  ! 0,X1

     2223    11549    3         END;

     2224    11550    2   NOSEL: VLP_ACCT.ACCT#=SELACCT;

  11550 10 012732   001006 237000 0     NOSEL        LDAQ    SELACCT
        10 012733   000076 757000 0                  STAQ    VLP_ACCT

     2225    11551    2      IF SELACCT=' ' THEN ALTRETURN;

  11551 10 012734   001006 237000 0                  LDAQ    SELACCT
        10 012735   000142 117000 11                 CMPAQ   98
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:433  
        10 012736   012741 601000 10                 TNZ     s:11552

  11551 10 012737   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012740   000000 702211                    TSX2  ! 0,X1

     2226    11552    2      SELACCT=' ';

  11552 10 012741   000035 235000 xsym               LDA     B_VECTNIL+29
        10 012742   000035 236000 xsym               LDQ     B_VECTNIL+29
        10 012743   001006 757000 0                  STAQ    SELACCT

     2227    11553    2      OPNXTA.V.SETDCB#='1'B;

  11553 10 012744   100000 236007                    LDQ     32768,DL
        10 012745   000504 256000 0                  ORSQ    OPNXTA+36

     2228    11554    2      CALL M$OPEN(OPNXTA)ALTRET(NOSEL1);

  11554 10 012746   000440 630400 0                  EPPR0   OPNXTA
        10 012747   450000 713400                    CLIMB   alt,open
        10 012750   410400 401760                    pmme    nvectors=18
        10 012751   012752 702000 10                 TSX2    NOSEL1

     2229    11555    2   NOSEL1: OPNXTA.V.SETDCB#='0'B;

  11555 10 012752   000154 236000 11    NOSEL1       LDQ     108
        10 012753   000504 356000 0                  ANSQ    OPNXTA+36

     2230    11556    2      IF PROJAD.L~=0 THEN CALL FXU$PROJAC(CODE)ALTRET(ACCTERR);

  11556 10 012754   001127 236000 0                  LDQ     PROJAD
        10 012755   777000 316003                    CANQ    -512,DU
        10 012756   012765 600000 10                 TZE     s:11557

  11556 10 012757   200007 630500                    EPPR0   CODE,,AUTO
        10 012760   201346 450500                    STP0    BXP+1,,AUTO
        10 012761   201346 630500                    EPPR0   BXP+1,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:434  
        10 012762   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 012763   000000 701000 xent               TSX1    FXU$PROJAC
        10 012764   012767 702000 10                 TSX2    ACCTERR

     2231    11557    2      RETURN;

  11557 10 012765   201340 221300                    LDX1  ! P$+1,,AUTO
        10 012766   000001 702211                    TSX2  ! 1,X1

     2232    11558                    /**/
     2233    11559    2   ACCTERR: FLAG.SEV=7;

  11559 10 012767   000007 236007       ACCTERR      LDQ     7,DL
        10 012770   001107 256000 0                  ORSQ    FLAG

     2234    11560    2      UNWIND TO DPERX;

  11560 10 012771   001110 237200 0                  LDAQ  ! DPERX
        10 012772   000000 700200 xent               TSX0  ! X66_AUNWIND
        10 012773   000000 000200                    ZERO    0,128

     2235    11561        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:435  
     2236    11562    2   ACCTLTXT: ENTRY ALTRET; /* MAKE TEXT FROM FFLG (IN FLAG) */

  11562 10 012774   201340 741300       ACCTLTXT     STX1  ! P$+1,,AUTO

     2237    11563    2      TCXT=',';

  11563 10 012775   040000 100400                    MLR     fill='040'O
        10 012776   000155 000001 11                 ADSC9   109                      cn=0,n=1
        10 012777   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256

     2238    11564    2      NUMSNS=2;

  11564 10 013000   000002 235007                    LDA     2,DL
        10 013001   001112 755000 0                  STA     NUMSNS

     2239    11565    2      J=SIZEW(FFLGS);

  11565 10 013002   000020 236007                    LDQ     16,DL
        10 013003   001104 756000 0                  STQ     J

     2240    11566    3      DO WHILE(J>0);

  11566 10 013004   013050 600000 10                 TZE     s:11578

     2241    11567    3         J=J-1;

  11567 10 013005   001104 235000 0                  LDA     J
        10 013006   000001 135007                    SBLA    1,DL
        10 013007   001104 755000 0                  STA     J

     2242    11568    4         IF FLAG=FFLGS(J) THEN DO;

  11568 10 013010   001107 236000 0                  LDQ     FLAG
        10 013011   000361 116005 2                  CMPQ    FFLGS,AL
        10 013012   013031 601000 10                 TNZ     s:11573

     2243    11569    4            CALL INSERT(TCXT,2,8,FFLGC(J));
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:436  

  11569 10 013013   001104 235000 0                  LDA     J
        10 013014   000003 735000                    ALS     3
        10 013015   040000 100405                    MLR     fill='040'O
        10 013016   000401 000010 2                  ADSC9   FFLGC,A                  cn=0,n=8
        10 013017   000706 400010 0                  ADSC9   TEXT                     cn=2,n=8

     2244    11570    4            CALL INDEX1(NUMSNS,' ',TCXT,2);

  11570 10 013020   000000 124400                    SCM     mask='000'O
        10 013021   000706 400376 0                  ADSC9   TEXT                     cn=2,n=254
        10 013022   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 013023   001112 000000 0                  ARG     NUMSNS
        10 013024   001112 235000 0                  LDA     NUMSNS
        10 013025   000002 035007                    ADLA    2,DL
        10 013026   001112 755000 0                  STA     NUMSNS

     2245    11571    4            RETURN;

  11571 10 013027   201340 221300                    LDX1  ! P$+1,,AUTO
        10 013030   000001 702211                    TSX2  ! 1,X1

     2246    11572    4            END;
     2247    11573    4         IF FLAG&FFLGS(J) AND J<9 THEN DO;

  11573 10 013031   001104 720000 0                  LXL0    J
        10 013032   000361 376010 2                  ANQ     FFLGS,X0
        10 013033   013046 600000 10                 TZE     s:11577
        10 013034   001104 235000 0                  LDA     J
        10 013035   000011 115007                    CMPA    9,DL
        10 013036   013046 603000 10                 TRC     s:11577

     2248    11574    4            CALL INSERT(TCXT,NUMSNS,1,SUBSTR(FFLGC(J),0,1));

  11574 10 013037   000003 735000                    ALS     3
        10 013040   001112 236000 0                  LDQ     NUMSNS
        10 013041   040006 100405                    MLR     fill='040'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:437  
        10 013042   000401 000001 2                  ADSC9   FFLGC,A                  cn=0,n=1
        10 013043   000706 000001 0                  ADSC9   TEXT,Q                   cn=0,n=1

     2249    11575    4            NUMSNS=NUMSNS+1;

  11575 10 013044   000001 036007                    ADLQ    1,DL
        10 013045   001112 756000 0                  STQ     NUMSNS

     2250    11576    4            END;

     2251    11577    3         END;

  11577 10 013046   001104 235000 0                  LDA     J
        10 013047   013005 601000 10                 TNZ     s:11567

     2252    11578    2      IF SUBSTR(TCXT,2,2)='CR' THEN CALL INSERT(TCXT,2,2,'RC');

  11578 10 013050   000706 720000 0                  LXL0    TEXT
        10 013051   000526 100000 2                  CMPX0   FFLGS+47
        10 013052   013055 601000 10                 TNZ     s:11579

  11578 10 013053   000613 221000 2                  LDX1    FFLGS+100
        10 013054   000706 441000 0                  SXL1    TEXT

     2253    11579    2      IF SUBSTR(TCXT,2,2)='WR' THEN CALL INSERT(TCXT,2,2,'RW');

  11579 10 013055   000706 720000 0                  LXL0    TEXT
        10 013056   000614 100000 2                  CMPX0   FFLGS+101
        10 013057   013062 601000 10                 TNZ     s:11580

  11579 10 013060   000615 221000 2                  LDX1    FFLGS+102
        10 013061   000706 441000 0                  SXL1    TEXT

     2254    11580    2      RETURN;

  11580 10 013062   201340 221300                    LDX1  ! P$+1,,AUTO
        10 013063   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:438  

     2255    11581        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:439  
     2256    11582    2   MOVEFIT: ENTRY ALTRET; /* MOVE FIT FROM VIDBUF TO PADBUF */

  11582 10 013064   201340 741300       MOVEFIT      STX1  ! P$+1,,AUTO

     2257    11583    2      FIT04='0'B; /* TURN OFF CODE04 */

  11583 10 013065   001416 450000 0                  STZ     FIT04

     2258    11584    3      DO AX=1 TO FIT.CODES.CODE(0);

  11584 10 013066   000001 235007                    LDA     1,DL
        10 013067   201342 755100                    STA     AX,,AUTO
        10 013070   013170 710000 10                 TRA     s:11600+3

     2259    11585    3         BXB=FIT.CODES(AX)&~ITEMXMASK;

  11585 10 013071   000226 236000 2                  LDQ     ITEMXMASK
        10 013072   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 013073   201342 720100                    LXL0    AX,,AUTO
        10 013074   002621 376010 0                  ANQ     VIDBUF,X0
        10 013075   201344 756100                    STQ     BX,,AUTO

     2260    11586    3         FITSIZE=FIT.CODES.NDW(AX)*4;

  11586 10 013076   002621 236010 0                  LDQ     VIDBUF,X0
        10 013077   000010 772000                    QRL     8
        10 013100   007774 376007                    ANQ     4092,DL
        10 013101   002620 756000 0                  STQ     FITSIZE

     2261    11587    3         AXP$=ADDR(WBUF(FIT.CODES.ITEMX(AX)));

  11587 10 013102   002621 721010 0                  LXL1    VIDBUF,X0
        10 013103   001777 361003                    ANX1    1023,DU
        10 013104   002621 630411 0                  EPPR0   VIDBUF,X1
        10 013105   201343 450500                    STP0    AXP,,AUTO

     2262    11588    4         DO CASE(FIT.CODES.CODE(AX));
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:440  

  11588 10 013106   002621 236010 0                  LDQ     VIDBUF,X0
        10 013107   000037 772000                    QRL     31
        10 013110   000004 136007                    SBLQ    4,DL
        10 013111   000013 116007                    CMPQ    11,DL
        10 013112   013114 602006 10                 TNC     s:11588+6,QL
        10 013113   013165 710000 10                 TRA     s:11600
        10 013114   013127 710000 10                 TRA     s:11590
        10 013115   013165 710000 10                 TRA     s:11600
        10 013116   013165 710000 10                 TRA     s:11600
        10 013117   013165 710000 10                 TRA     s:11600
        10 013120   013165 710000 10                 TRA     s:11600
        10 013121   013144 710000 10                 TRA     s:11594
        10 013122   013165 710000 10                 TRA     s:11600
        10 013123   013165 710000 10                 TRA     s:11600
        10 013124   013165 710000 10                 TRA     s:11600
        10 013125   013165 710000 10                 TRA     s:11600
        10 013126   013155 710000 10                 TRA     s:11597

     2263    11589    4         CASE(4);

     2264    11590    4            CODE04=AXP$->FITMOVER;

  11590 10 013127   002620 722000 0                  LXL2    FITSIZE
        10 013130   000000 100540                    MLR     fill='000'O
        10 013131   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
        10 013132   001421 000054 0                  ADSC9   CODE04                   cn=0,n=44

     2265    11591    4            IF CODE04.ACCESS=CODE04.CREATION THEN CODE04.ACCESS='0'B;

  11591 10 013133   001421 236000 0                  LDQ     CODE04
        10 013134   001423 116000 0                  CMPQ    CODE04+2
        10 013135   013137 601000 10                 TNZ     s:11592

  11591 10 013136   001421 450000 0                  STZ     CODE04

     2266    11592    4            IF CODE04.SVMODIFY=CODE04.CREATION THEN CODE04.SVMODIFY='0'B;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:441  

  11592 10 013137   001431 236000 0                  LDQ     CODE04+8
        10 013140   001423 116000 0                  CMPQ    CODE04+2
        10 013141   013165 601000 10                 TNZ     s:11600

  11592 10 013142   001431 450000 0                  STZ     CODE04+8
        10 013143   013165 710000 10                 TRA     s:11600

     2267    11593    4         CASE(9);

     2268    11594    4            FIT09=BXB|FIT09&ITEMXMASK;

  11594 10 013144   001420 236000 0                  LDQ     FIT09
        10 013145   000226 376000 2                  ANQ     ITEMXMASK
        10 013146   201344 276100                    ORQ     BX,,AUTO
        10 013147   001420 756000 0                  STQ     FIT09

     2269    11595    4            ADDR(CODE09)->FITMOVER=AXP$->FITMOVER;

  11595 10 013150   002620 722000 0                  LXL2    FITSIZE
        10 013151   000040 100540                    MLR     fill='000'O
        10 013152   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
        10 013153   001634 000012 0                  ADSC9   CODE09                   cn=0,n=*X2
        10 013154   013165 710000 10                 TRA     s:11600

     2270    11596    4         CASE(14);

     2271    11597    4            FIT14=BXB|FIT14&ITEMXMASK;

  11597 10 013155   001417 236000 0                  LDQ     FIT14
        10 013156   000226 376000 2                  ANQ     ITEMXMASK
        10 013157   201344 276100                    ORQ     BX,,AUTO
        10 013160   001417 756000 0                  STQ     FIT14

     2272    11598    4            CODE14=AXP$->FITMOVER;

  11598 10 013161   002620 722000 0                  LXL2    FITSIZE
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:442  
        10 013162   000000 100540                    MLR     fill='000'O
        10 013163   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
        10 013164   001434 001000 0                  ADSC9   CODE14                   cn=0,n=512

     2273    11599    4         END;

     2274    11600    3         END;

  11600 10 013165   201342 235100                    LDA     AX,,AUTO
        10 013166   000001 035007                    ADLA    1,DL
        10 013167   201342 755100                    STA     AX,,AUTO
        10 013170   002621 236000 0                  LDQ     VIDBUF
        10 013171   000037 772000                    QRL     31
        10 013172   201342 116100                    CMPQ    AX,,AUTO
        10 013173   013071 603000 10                 TRC     s:11585

     2275    11601    2      RETURN;

  11601 10 013174   201340 221300                    LDX1  ! P$+1,,AUTO
        10 013175   000001 702211                    TSX2  ! 1,X1

     2276    11602        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:443  
     2277    11603    2   SET_PRIV: ENTRY ALTRET; /* SET PRIVS FROM THE USER AUTHORIZAITON */

  11603 10 013176   201340 741300       SET_PRIV     STX1  ! P$+1,,AUTO

     2278    11604    2      CALL M$SPRIV(PPRIVFPT);

  11604 10 013177   000014 630400 2                  EPPR0   PPRIVFPT
        10 013200   020012 713400                    CLIMB   8202
        10 013201   400000 401760                    pmme    nvectors=1

     2279    11605    2      PRIVFPT.V.PRIV#=PPRIVFPT.V.PRIV#;

  11605 10 013202   000016 236000 2                  LDQ     PPRIVFPT+2
        10 013203   000636 756000 0                  STQ     PRIVFPT+2

     2280    11606    2      IF B$JIT.PPRIV.PIGC THEN CALL M$SPRIV(PRIVFPT);

  11606 10 013204   000000 470400 xsym               LDP0    B$JIT$
        10 013205   000020 236100                    LDQ     16,,PR0
        10 013206   004000 316003                    CANQ    2048,DU
        10 013207   013213 600000 10                 TZE     s:11607

  11606 10 013210   000634 630400 0                  EPPR0   PRIVFPT
        10 013211   020012 713400                    CLIMB   8202
        10 013212   400000 401760                    pmme    nvectors=1

     2281    11607    2      IF NOT B$JIT.PRIV.ACTIVE.FMDIAG THEN PRIVFPT.V.PRIV#=%PR_SPCLMM#;

  11607 10 013213   000000 470400 xsym               LDP0    B$JIT$
        10 013214   000013 236100                    LDQ     11,,PR0
        10 013215   040000 316003                    CANQ    16384,DU
        10 013216   013222 601000 10                 TNZ     s:11608

  11607 10 013217   000003 236000 xsym               LDQ     B_VECTNIL+3
        10 013220   000636 756000 0                  STQ     PRIVFPT+2
        10 013221   013224 710000 10                 TRA     s:11609

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:444  
     2282    11608    2      ELSE PRIVFPT.V.PRIV#=%(PR_SPCLMM#|PR_FMBLK#);

  11608 10 013222   000616 236000 2                  LDQ     FFLGS+103
        10 013223   000636 756000 0                  STQ     PRIVFPT+2

     2283    11609    2      IF B$JIT.PPRIV.PIGD THEN CALL M$SPRIV(PRIVFPT);

  11609 10 013224   000020 236100                    LDQ     16,,PR0
        10 013225   010000 316003                    CANQ    4096,DU
        10 013226   013232 600000 10                 TZE     s:11610

  11609 10 013227   000634 630400 0                  EPPR0   PRIVFPT
        10 013230   020012 713400                    CLIMB   8202
        10 013231   400000 401760                    pmme    nvectors=1

     2284    11610    2      PRIVFPT.V.PRIV#=%(PR_FMSEC#|PR_FMBLK#)&~B$JIT.PRIV.ACTIVE;

  11610 10 013232   000000 470400 xsym               LDP0    B$JIT$
        10 013233   000013 236100                    LDQ     11,,PR0
        10 013234   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 013235   000617 376000 2                  ANQ     FFLGS+104
        10 013236   000636 756000 0                  STQ     PRIVFPT+2

     2285    11611    2      IF B$JIT.PRIV.ACTIVE.FMDIAG OR NOT B$JIT.PPRIV.PIGD

  11611 10 013237   000013 236100                    LDQ     11,,PR0
        10 013240   040000 316003                    CANQ    16384,DU
        10 013241   013245 601000 10                 TNZ     s:11612
        10 013242   000020 236100                    LDQ     16,,PR0
        10 013243   010000 316003                    CANQ    4096,DU
        10 013244   013247 601000 10                 TNZ     s:11613

     2286    11612    2      THEN DIAGFPT.V.PRIV#='0'B;

  11612 10 013245   000642 450000 0                  STZ     DIAGFPT+2
        10 013246   013251 710000 10                 TRA     s:11614

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:445  
     2287    11613    2      ELSE DIAGFPT.V.PRIV#=%PR_FMDIAG#;

  11613 10 013247   000541 236000 2                  LDQ     FFLGS+58
        10 013250   000642 756000 0                  STQ     DIAGFPT+2

     2288    11614    2      PROJAD.L=0;

  11614 10 013251   000000 236003                    LDQ     0,DU
        10 013252   001127 552040 0                  STBQ    PROJAD,'40'O

     2289    11615    2      RETURN;

  11615 10 013253   201340 221300                    LDX1  ! P$+1,,AUTO
        10 013254   000001 702211                    TSX2  ! 1,X1

     2290    11616    2   END;
     2291    11617        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:446  
     2292    11618                    /*I*      NAME: DEFER
     2293    11619                    *         ENTRY:UNDEFER,UNDEFER1
     2294    11620                   *        DESCRIPTION: Puts a SUPER request for an unmounted set in PIGCG
     2295    11621                    *         (DEFER) or takes one out for a newly mounted one (UNDEFER).
     2296    11622                    */
     2297    11623    1   DEFER: PROC ALTRET;

  11623 10 013255   201334 741300       DEFER        STX1  ! DEFAULT_BUILD+724,,AUTO

     2298    11624    2      IF S_TO_P.TYPE=%VALIDATE_ATTR THEN RETURN;

  11624 10 013256   001073 470400 0                  LDP0    BLK$
        10 013257   000000 236100                    LDQ     0,,PR0
        10 013260   777000 376003                    ANQ     -512,DU
        10 013261   003000 116003                    CMPQ    1536,DU
        10 013262   013264 601000 10                 TNZ     s:11625

  11624 10 013263   000001 702211                    TSX2  ! 1,X1

     2299    11625    2      IF S_TO_P.TYPE=%LIST_ACCT THEN FLAG=FXP$E$NLIST;

  11625 10 013264   002000 116003                    CMPQ    1024,DU
        10 013265   013271 601000 10                 TNZ     s:11630

  11625 10 013266   000047 236000 2                  LDQ     FXP$E$NLIST
        10 013267   001107 756000 0                  STQ     FLAG
        10 013270   013315 710000 10                 TRA     s:11640

     2300    11626                    /*E*      ERROR:FXP-E$NLIST
     2301    11627                    *         MESSAGE: Packset not currently shared.
     2302    11628                    */
     2303    11629    3      ELSE DO;

     2304    11630    3         DEFERFPT.BUF_.BUF$=BLK$;

  11630 10 013271   001073 236000 0                  LDQ     BLK$
        10 013272   001157 756000 0                  STQ     DEFERFPT+5
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:447  

     2305    11631    3         DEFERFPT.BUF_.BOUND=M$SI$->F$DCB.ARS-1;

  11631 10 013273   001123 471400 0                  LDP1    M$SI$
        10 013274   100000 236100                    LDQ     0,,PR1
        10 013275   000001 136007                    SBLQ    1,DL
        10 013276   000020 736000                    QLS     16
        10 013277   001156 676000 0                  ERQ     DEFERFPT+4
        10 013300   000034 376000 xsym               ANQ     B_VECTNIL+28
        10 013301   001156 656000 0                  ERSQ    DEFERFPT+4

     2306    11632    3         DEFERST.MSGTYP#=S_TO_P.PACKSET;

  11632 10 013302   040000 100500                    MLR     fill='040'O
        10 013303   000012 400006                    ADSC9   10,,PR0                  cn=2,n=6
        10 013304   001170 000010 0                  ADSC9   DEFERST+2                cn=0,n=8

     2307    11633    3         CALL M$WRITE(DEFERFPT)ALTRET(DEFERERR);

  11633 10 013305   001152 630400 0                  EPPR0   DEFERFPT
        10 013306   440001 713400                    CLIMB   alt,write
        10 013307   401400 401760                    pmme    nvectors=4
        10 013310   013317 702000 10                 TSX2    DEFERERR

     2308    11634    3         FLAG=FXP$E$DEFER;

  11634 10 013311   000046 236000 2                  LDQ     FXP$E$DEFER
        10 013312   001107 756000 0                  STQ     FLAG

     2309    11635                    /*E*      ERROR:FXP-E$DEFER
     2310    11636                    *         MESSAGE:Set not shared - Request deferred.
     2311    11637                    */
     2312    11638    3         CODE=%E$PIGH; /* NO ABORTED MESSAGE */

  11638 10 013313   000144 235007                    LDA     100,DL
        10 013314   200007 755100                    STA     CODE,,AUTO

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:448  
     2313    11639    3         END;

     2314    11640    2      ALTRETURN;

  11640 10 013315   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 013316   000000 702211                    TSX2  ! 0,X1

     2315    11641    2   DEFERERR: FLAG=B$ALT.ERR;

  11641 10 013317   000000 470400 xsym  DEFERERR     LDP0    B$TCB$
        10 013320   000000 471500                    LDP1    0,,PR0
        10 013321   100102 236100                    LDQ     66,,PR1
        10 013322   001107 756000 0                  STQ     FLAG

     2316    11642    3      IF FLAG.CODE=%E$CGNOCLS THEN DO;

  11642 10 013323   001107 236000 0                  LDQ     FLAG
        10 013324   377770 376007                    ANQ     131064,DL
        10 013325   015660 116007                    CMPQ    7088,DL
        10 013326   013361 601000 10                 TNZ     DEFERERR1

     2317    11643    4         IF NOT DCBADDR(DCBNUM(M$PIGCG))->F$DCB.FCD THEN DO;

  11643 10 013327   000000 236007 xsym               LDQ     M$PIGCG,DL
        10 013330   000001 471400 11                 LDP1    1
        10 013331   100000 473500                    LDP3    0,,PR1
        10 013332   300000 474506                    LDP4    0,QL,PR3
        10 013333   400031 236100                    LDQ     25,,PR4
        10 013334   020000 316007                    CANQ    8192,DL
        10 013335   013353 601000 10                 TNZ     s:11649

     2318    11644    4            RELPIGFIL.V.ASN#=%FILE#;

  11644 10 013336   000001 236007                    LDQ     1,DL
        10 013337   001243 552004 0                  STBQ    RELPIGFIL+37,'04'O

     2319    11645    4            CALL M$OPEN (RELPIGFIL) ALTRET(DEFERERR1);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:449  

  11645 10 013340   001176 630400 0                  EPPR0   RELPIGFIL
        10 013341   450000 713400                    CLIMB   alt,open
        10 013342   410400 401760                    pmme    nvectors=18
        10 013343   013361 702000 10                 TSX2    DEFERERR1

     2320    11646    4            RELPIGFIL.V.ASN#=%COMGROUP#;

  11646 10 013344   000004 236007                    LDQ     4,DL
        10 013345   001243 552004 0                  STBQ    RELPIGFIL+37,'04'O

     2321    11647    4            CALL M$OPEN (RELPIGFIL) ALTRET(DEFERERR1);

  11647 10 013346   001176 630400 0                  EPPR0   RELPIGFIL
        10 013347   450000 713400                    CLIMB   alt,open
        10 013350   410400 401760                    pmme    nvectors=18
        10 013351   013361 702000 10                 TSX2    DEFERERR1

     2322    11648    4            END;

  11648 10 013352   013357 710000 10                 TRA     s:11650

     2323    11649    3         ELSE CALL M$CLOSE (RELPIGCG) ALTRET(DEFERERR1);

  11649 10 013353   000170 630400 2                  EPPR0   RELPIGCG
        10 013354   450001 713400                    CLIMB   alt,close
        10 013355   406000 401760                    pmme    nvectors=13
        10 013356   013361 702000 10                 TSX2    DEFERERR1

     2324    11650    3         CALL M$RETRY;

  11650 10 013357   010010 713400                    CLIMB   4104
        10 013360   000000 401760                    pmme    nvectors=0

     2325    11651    3         END;

  11647 10 013361                       DEFERERR1    null
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:450  
     2326    11652    2   DEFERERR1:;
     2327    11653    2      EFPT.V.DCB#=DCBNUM(M$PIGCG);

  11653 10 013361   000000 236007 xsym               LDQ     M$PIGCG,DL
        10 013362   000000 620006                    EAX0    0,QL
        10 013363   000346 740000 0                  STX0    EFPT+22

     2328    11654    2      FLAG.SEV=7;

  11654 10 013364   000007 236007                    LDQ     7,DL
        10 013365   001107 256000 0                  ORSQ    FLAG

     2329    11655    2      ALTRETURN;

  11655 10 013366   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 013367   000000 702211                    TSX2  ! 0,X1

     2330    11656                    /**/
     2331    11657    2   UNDEFER1: ENTRY ALTRET;

  11657 10 013370   201334 741300       UNDEFER1     STX1  ! DEFAULT_BUILD+724,,AUTO

     2332    11658    3      DO I=0 TO NUMPSNS;

  11658 10 013371   001076 450000 0                  STZ     I
        10 013372   013404 710000 10                 TRA     s:11660+3

     2333    11659    3         IF CSTAT.SETS.SETX(I)=3 THEN GOTO UNDEFER0;

  11659 10 013373   001076 235000 0                  LDA     I
        10 013374   000001 735000                    ALS     1
        10 013375   004624 236005 0                  LDQ     CSTAT+3,AL
        10 013376   000777 376007                    ANQ     511,DL
        10 013377   000003 116007                    CMPQ    3,DL
        10 013400   013412 600000 10                 TZE     UNDEFER0

     2334    11660    3         END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:451  

  11660 10 013401   001076 235000 0                  LDA     I
        10 013402   000001 035007                    ADLA    1,DL
        10 013403   001076 755000 0                  STA     I
        10 013404   004621 236000 0                  LDQ     CSTAT
        10 013405   001076 116000 0                  CMPQ    I
        10 013406   013373 603000 10                 TRC     s:11659

     2335    11661    2      RETURN;

  11661 10 013407   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 013410   000001 702211                    TSX2  ! 1,X1

     2336    11662    2   UNDEFER: ENTRY ALTRET;

  11662 10 013411   201334 741300       UNDEFER      STX1  ! DEFAULT_BUILD+724,,AUTO

  11658 10 013412                       UNDEFER0     null
     2337    11663    2   UNDEFER0:;
     2338    11664    2      DEFERST.MSGTYP#=CSTAT.SETS.PSN(I);

  11664 10 013412   001076 235000 0                  LDA     I
        10 013413   000003 735000                    ALS     3
        10 013414   040000 100405                    MLR     fill='040'O
        10 013415   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6
        10 013416   001170 000010 0                  ADSC9   DEFERST+2                cn=0,n=8

     2339    11665    2      DEFERFPT.BUF_.BUF$=PINCRW(WORK_.FIRST$,20);

  11665 10 013417   001013 236000 0                  LDQ     WORK_+1
        10 013420   000024 036003                    ADLQ    20,DU
        10 013421   001157 756000 0                  STQ     DEFERFPT+5

     2340    11666    2      DEFERFPT.BUF_.BOUND=4*1004-1;

  11666 10 013422   001156 236000 0                  LDQ     DEFERFPT+4
        10 013423   177777 376007                    ANQ     65535,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:452  
        10 013424   000156 276000 11                 ORQ     110
        10 013425   001156 756000 0                  STQ     DEFERFPT+4

     2341    11667    2      CALL M$READ(DEFERFPT)ALTRET(NOMORE);

  11667 10 013426   001152 630400 0                  EPPR0   DEFERFPT
        10 013427   440000 713400                    CLIMB   alt,read
        10 013430   401400 401760                    pmme    nvectors=4
        10 013431   013472 702000 10                 TSX2    NOMORE

     2342    11668    2      WRSUPER.STATION_=DEFERFPT.STATION_;

  11668 10 013432   001160 237000 0                  LDAQ    DEFERFPT+6
        10 013433   001144 757000 0                  STAQ    WRSUPER+6

     2343    11669    2      DEFERFPT.BUF_.BOUND=DCBADDR(DCBNUM(M$PIGCG))->F$DCB.ARS-1;

  11669 10 013434   000000 236007 xsym               LDQ     M$PIGCG,DL
        10 013435   000001 470400 11                 LDP0    1
        10 013436   000000 471500                    LDP1    0,,PR0
        10 013437   100000 473506                    LDP3    0,QL,PR1
        10 013440   300000 236100                    LDQ     0,,PR3
        10 013441   000001 136007                    SBLQ    1,DL
        10 013442   000020 736000                    QLS     16
        10 013443   001156 676000 0                  ERQ     DEFERFPT+4
        10 013444   000034 376000 xsym               ANQ     B_VECTNIL+28
        10 013445   001156 656000 0                  ERSQ    DEFERFPT+4

     2344    11670    2      WRSUPER.BUF_=DEFERFPT.BUF_;

  11670 10 013446   001156 237000 0                  LDAQ    DEFERFPT+4
        10 013447   001142 757000 0                  STAQ    WRSUPER+4

     2345    11671    2      CALL M$WRITE(WRSUPER) ALTRET(NOMORE);

  11671 10 013450   001136 630400 0                  EPPR0   WRSUPER
        10 013451   440001 713400                    CLIMB   alt,write
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:453  
        10 013452   401400 401760                    pmme    nvectors=4
        10 013453   013472 702000 10                 TSX2    NOMORE

     2346    11672    3      IF CSTAT.SETS.SETX(I)=1 THEN DO;

  11672 10 013454   001076 235000 0                  LDA     I
        10 013455   000001 735000                    ALS     1
        10 013456   004624 236005 0                  LDQ     CSTAT+3,AL
        10 013457   000777 376007                    ANQ     511,DL
        10 013460   000001 116007                    CMPQ    1,DL
        10 013461   013470 601000 10                 TNZ     s:11676

     2347    11673    3         CSTAT.SETS.SETX(I)=3;

  11673 10 013462   004624 236005 0                  LDQ     CSTAT+3,AL
        10 013463   000005 376000 11                 ANQ     5
        10 013464   000003 276007                    ORQ     3,DL
        10 013465   004624 756005 0                  STQ     CSTAT+3,AL

     2348    11674    3         CALL CATWRITE;

  11674 10 013466   012372 701000 10                 TSX1    CATWRITE
        10 013467   000000 011000                    NOP     0

     2349    11675    3         END;

     2350    11676    2      RETURN;

  11676 10 013470   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 013471   000001 702211                    TSX2  ! 1,X1

  11672 10 013472                       NOMORE       null
     2351    11677                    /**/
     2352    11678    2   NOMORE:;
     2353    11679    2      IF B$ALT.DCB#=DCBNUM(M$SI) THEN CALL M$WRITE(DEFERFPT)ALTRET(NOMORE);

  11679 10 013472   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:454  
        10 013473   000000 471500                    LDP1    0,,PR0
        10 013474   000000 236007 xsym               LDQ     M$SI,DL
        10 013475   100101 116100                    CMPQ    65,,PR1
        10 013476   013503 601000 10                 TNZ     s:11680

  11679 10 013477   001152 630400 0                  EPPR0   DEFERFPT
        10 013500   440001 713400                    CLIMB   alt,write
        10 013501   401400 401760                    pmme    nvectors=4
        10 013502   013472 702000 10                 TSX2    NOMORE

     2354    11680    3      IF CSTAT.SETS.SETX(I)=3 THEN DO;

  11680 10 013503   001076 235000 0                  LDA     I
        10 013504   000001 735000                    ALS     1
        10 013505   004624 236005 0                  LDQ     CSTAT+3,AL
        10 013506   000777 376007                    ANQ     511,DL
        10 013507   000003 116007                    CMPQ    3,DL
        10 013510   013517 601000 10                 TNZ     s:11684

     2355    11681    3         CSTAT.SETS.SETX(I)=1;

  11681 10 013511   004624 236005 0                  LDQ     CSTAT+3,AL
        10 013512   000005 376000 11                 ANQ     5
        10 013513   000001 276007                    ORQ     1,DL
        10 013514   004624 756005 0                  STQ     CSTAT+3,AL

     2356    11682    3         CALL CATWRITE;

  11682 10 013515   012372 701000 10                 TSX1    CATWRITE
        10 013516   000000 011000                    NOP     0

     2357    11683    3         END;

     2358    11684    2      RETURN;

  11684 10 013517   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 013520   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:455  

     2359    11685    2   END;
     2360    11686        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:456  
     2361    11687                    /**/
     2362    11688    1   CMDERR: FLAG=FXP$E$PROJCMD;

  11688 10 013521   000043 236000 2     CMDERR       LDQ     FXP$E$PROJCMD
        10 013522   001107 756000 0                  STQ     FLAG

     2363    11689    1      GOTO DPERR1;

  11689 10 013523   013567 710000 10                 TRA     DPERR1

     2364    11690    1   DUPERR: FLAG=FXP$E$DUPVSN;

  11690 10 013524   000037 236000 2     DUPERR       LDQ     FXP$E$DUPVSN
        10 013525   001107 756000 0                  STQ     FLAG

     2365    11691    1      GOTO DPERR1;

  11691 10 013526   013567 710000 10                 TRA     DPERR1

     2366    11692    1   VOLERR: IF OPNSN.SN#(0)<' '

  11692 10 013527   040000 106400       VOLERR       CMPC    fill='040'O
        10 013530   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 013531   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 013532   013551 603000 10                 TRC     DPERR

     2367    11693    2      THEN IF B$ALT.ERR.CODE=%E$XCLSET AND TRAPCNT=0 THEN DO;

  11693 10 013533   000000 470400 xsym               LDP0    B$TCB$
        10 013534   000000 471500                    LDP1    0,,PR0
        10 013535   100102 236100                    LDQ     66,,PR1
        10 013536   377770 376007                    ANQ     131064,DL
        10 013537   002170 116007                    CMPQ    1144,DL
        10 013540   013551 601000 10                 TNZ     DPERR
        10 013541   001102 235000 0                  LDA     TRAPCNT
        10 013542   013551 601000 10                 TNZ     DPERR

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:457  
     2368    11694    2         TRAPCNT=TRAPCNT+1;

  11694 10 013543   001102 054000 0                  AOS     TRAPCNT

     2369    11695    2         CALL M$WAIT(WAIT1);

  11695 10 013544   000026 630400 2                  EPPR0   WAIT1
        10 013545   020006 713400                    CLIMB   8198
        10 013546   400400 401760                    pmme    nvectors=2

     2370    11696    2         CALL M$RETRY;

  11696 10 013547   010010 713400                    CLIMB   4104
        10 013550   000000 401760                    pmme    nvectors=0

     2371    11697    2         END;

  11692 10 013551                       DPERR        null
     2372    11698    1   DPERR: ;
     2373    11699    1      IF ENTADDR(FXD$PMME)=ENTADDR(NIL) THEN FLAG=B$ALT.ERR;

  11699 10 013551   000000 636000 xent               EAQ     FXD$PMME
        10 013552   000002 116000 xsym               CMPQ    B_VECTNIL+2
        10 013553   013561 601000 10                 TNZ     s:11700

  11699 10 013554   000000 470400 xsym               LDP0    B$TCB$
        10 013555   000000 471500                    LDP1    0,,PR0
        10 013556   100102 236100                    LDQ     66,,PR1
        10 013557   001107 756000 0                  STQ     FLAG
        10 013560   013565 710000 10                 TRA     s:11701

     2374    11700    1      ELSE CALL FXD$PMME(FLAG);

  11700 10 013561   000157 630400 11                 EPPR0   111
        10 013562   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 013563   000000 701000 xent               TSX1    FXD$PMME
        10 013564   000000 011000                    NOP     0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:458  

     2375    11701    1      FLAG.SEV=7;

  11701 10 013565   000007 236007                    LDQ     7,DL
        10 013566   001107 256000 0                  ORSQ    FLAG

  11701 10 013567                       DPERR1       null
     2376    11702    1   DPERR1:;
     2377    11703    1      J=ADDR(OPNSN.SN#(0))->BASED_UBIN;

  11703 10 013567   000073 235000 0                  LDA     OPNSN+1
        10 013570   001104 755000 0                  STA     J

     2378    11704    2      IF FLAG.CODE=%E$SETDOWN THEN DO;

  11704 10 013571   001107 236000 0                  LDQ     FLAG
        10 013572   377770 376007                    ANQ     131064,DL
        10 013573   002200 116007                    CMPQ    1152,DL
        10 013574   013613 601000 10                 TNZ     s:11715

     2379    11705    2         IF OPNSN.SN#(0)>' ' THEN J=F$DCB.CSEED;

  11705 10 013575   040000 106400                    CMPC    fill='040'O
        10 013576   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 013577   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 013600   013604 603000 10                 TRC     s:11706

  11705 10 013601   000000 470400 xsym               LDP0    M$DP$
        10 013602   000072 235100                    LDA     58,,PR0
        10 013603   001104 755000 0                  STA     J

     2380    11706    2         IF J=0 THEN FLAG=FXP$E$NOVOL;

  11706 10 013604   000000 115003                    CMPA    0,DU
        10 013605   013611 601000 10                 TNZ     s:11710

  11706 10 013606   000035 236000 2                  LDQ     FXP$E$NOVOL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:459  
        10 013607   001107 756000 0                  STQ     FLAG
        10 013610   013613 710000 10                 TRA     s:11715

     2381    11707                    /*E*     ERROR: FXP-E$NOVOL-C
     2382    11708                     *        MESSAGE: No volumes of set #%SN are up.
     2383    11709                     */
     2384    11710    2         ELSE FLAG=FXP$E$VOLDOWN;

  11710 10 013611   000034 236000 2                  LDQ     FXP$E$VOLDOWN
        10 013612   001107 756000 0                  STQ     FLAG

     2385    11711                    /*E*     ERROR: FXP-E$VOLDOWN-C
     2386    11712                     *        MESSAGE: Diskpack volume %U1 is not up.
     2387    11713                     */
     2388    11714    2         END;

     2389    11715    1      X9=I;

  11715 10 013613   001076 236000 0                  LDQ     I
        10 013614   200006 756100                    STQ     X9,,AUTO

     2390    11716    1      I=0;

  11716 10 013615   001076 450000 0                  STZ     I

     2391    11717    1      IF J<99999999 THEN CALL INSERT(TCXT,20,1,' ');

  11717 10 013616   000160 115000 11                 CMPA    112
        10 013617   013623 603000 10                 TRC     s:11718

  11717 10 013620   040000 236003                    LDQ     16384,DU
        10 013621   000713 552040 0                  STBQ    TEXT+5,'40'O
        10 013622   013631 710000 10                 TRA     s:11719

     2392    11718    1      ELSE CALL INSERT(TCXT,20,1,BINASC(ASCBIN(ADDR(J)->CHAR1)+ASCBIN('@')));

  11718 10 013623   001104 236000 0                  LDQ     J
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:460  
        10 013624   000033 772000                    QRL     27
        10 013625   000100 036007                    ADLQ    64,DL
        10 013626   000033 736000                    QLS     27
        10 013627   000010 276000 11                 ORQ     8
        10 013630   000713 552040 0                  STBQ    TEXT+5,'40'O

     2393    11719    1      CALL INSERT(ADDR(J)->CHAR4,0,1,BINASC(0));

  11719 10 013631   000000 236003                    LDQ     0,DU
        10 013632   001104 552040 0                  STBQ    J,'40'O

     2394    11720    1      CALL ADDPARNUM(%MNUM);

  11720 10 013633   000070 236000 11                 LDQ     56
        10 013634   201335 756100                    STQ     DEFAULT_BUILD+725,,AUTO
        10 013635   014155 701000 10                 TSX1    ADDPARNUM
        10 013636   000000 011000                    NOP     0

     2395    11721    1      CALL INSERT(TCXT,0,20,BINASC(J-1),SUBSTR(LBUFC,2,J-2),

  11721 10 013637   001104 236000 0                  LDQ     J
        10 013640   000001 136007                    SBLQ    1,DL
        10 013641   000033 736000                    QLS     27
        10 013642   000010 276000 11                 ORQ     8
        10 013643   000706 552040 0                  STBQ    TEXT,'40'O
        10 013644   001104 720000 0                  LXL0    J
        10 013645   777776 621010                    EAX1    -2,X0
        10 013646   040000 100440                    MLR     fill='040'O
        10 013647   006702 400011 0                  ADSC9   LBUFC                    cn=2,n=*X1
        10 013650   000706 200023 0                  ADSC9   TEXT                     cn=1,n=19
        10 013651   001104 236000 0                  LDQ     J
        10 013652   000025 116007                    CMPQ    21,DL
        10 013653   013661 603000 10                 TRC     s:11723
        10 013654   777752 622006                    EAX2    -22,QL
        10 013655   777777 662003                    ERX2    -1,DU
        10 013656   040046 100400                    MLR     fill='040'O
        10 013657   000713 000001 0                  ADSC9   TEXT+5                   cn=0,n=1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:461  
        10 013660   000705 600012 0                  ADSC9   CORR+3,Q                 cn=3,n=*X2

     2396    11722    1        SUBSTR(TCXT,20,1));
     2397    11723    1      IF OPNSN.SN#(0)<' ' AND SUBSTR(OPNSN.SN#(0),4,1)~=' '

  11723 10 013661   040000 106400                    CMPC    fill='040'O
        10 013662   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 013663   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 013664   013674 603000 10                 TRC     s:11725
        10 013665   000074 236000 0                  LDQ     OPNSN+2
        10 013666   777000 376003                    ANQ     -512,DU
        10 013667   040000 116003                    CMPQ    16384,DU
        10 013670   013674 600000 10                 TZE     s:11725

     2398    11724    1      THEN TCXT=OPNSN.SN#(0);

  11724 10 013671   040000 100400                    MLR     fill='040'O
        10 013672   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 013673   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256

     2399    11725    1      I=X9;

  11725 10 013674   200006 235100                    LDA     X9,,AUTO
        10 013675   001076 755000 0                  STA     I

     2400    11726    1      FLAG.SEV=FLAG.SEV+1;

  11726 10 013676   001107 236000 0                  LDQ     FLAG
        10 013677   000007 376007                    ANQ     7,DL
        10 013700   000001 036007                    ADLQ    1,DL
        10 013701   001107 676000 0                  ERQ     FLAG
        10 013702   000007 376007                    ANQ     7,DL
        10 013703   001107 656000 0                  ERSQ    FLAG

     2401    11727    1      IF BREAK~=0 THEN GOTO DPCLOSE;

  11727 10 013704   001125 236000 0                  LDQ     BREAK
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:462  
        10 013705   013762 601000 10                 TNZ     DPCLOSE

     2402    11728    1      LBUFC=' ';

  11728 10 013706   040000 100400                    MLR     fill='040'O
        10 013707   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 013710   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

     2403    11729    1      CALL M$ERRMSG(EFPT)ALTRET(HERE3);

  11729 10 013711   000320 630400 0                  EPPR0   EFPT
        10 013712   420000 713400                    CLIMB   alt,+8192
        10 013713   405000 401760                    pmme    nvectors=11
        10 013714   013715 702000 10                 TSX2    HERE3

  11728 10 013715                       HERE3        null
     2404    11730    1   HERE3:;
     2405    11731    1      WROC.MSG#=PIGERR_MSG#;

  11731 10 013715   000455 220003                    LDX0    301,DU
        10 013716   006666 440000 0                  SXL0    WROC

     2406    11732    2      IF FLAG.CODE=E$VOLDOWN AND (CODE=%E$EXTND OR CODE=%E$BUILD) THEN DO;

  11732 10 013717   001107 236000 0                  LDQ     FLAG
        10 013720   377770 376007                    ANQ     131064,DL
        10 013721   000150 116007                    CMPQ    104,DL
        10 013722   013752 601000 10                 TNZ     s:11738
        10 013723   200007 235100                    LDA     CODE,,AUTO
        10 013724   000152 115007                    CMPA    106,DL
        10 013725   013730 600000 10                 TZE     s:11733
        10 013726   000151 115007                    CMPA    105,DL
        10 013727   013752 601000 10                 TNZ     s:11738

     2407    11733    2         IF OPNSN.SN#(0)~=ADDR(TRAPCNT)->CHAR4 THEN CALL ERROR(2);

  11733 10 013730   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:463  
        10 013731   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 013732   001102 000004 0                  ADSC9   TRAPCNT                  cn=0,n=4
        10 013733   013740 600000 10                 TZE     s:11734

  11733 10 013734   000037 236000 11                 LDQ     31
        10 013735   201341 756100                    STQ     P$+2,,AUTO
        10 013736   011704 701000 10                 TSX1    ERROR
        10 013737   000000 011000                    NOP     0

     2408    11734    2         ADDR(TRAPCNT)->CHAR4=OPNSN.SN#(0);

  11734 10 013740   000073 236000 0                  LDQ     OPNSN+1
        10 013741   001102 756000 0                  STQ     TRAPCNT

     2409    11735    2         CALL M$WAIT(WAIT1);

  11735 10 013742   000026 630400 2                  EPPR0   WAIT1
        10 013743   020006 713400                    CLIMB   8198
        10 013744   400400 401760                    pmme    nvectors=2

     2410    11736    2         IF BREAK=0 THEN CALL M$RETRY;

  11736 10 013745   001125 235000 0                  LDA     BREAK
        10 013746   013756 601000 10                 TNZ     s:11739

  11736 10 013747   010010 713400                    CLIMB   4104
        10 013750   000000 401760                    pmme    nvectors=0

     2411    11737    2         END;

  11737 10 013751   013756 710000 10                 TRA     s:11739

     2412    11738    1      ELSE CALL ERROR(2);

  11738 10 013752   000037 236000 11                 LDQ     31
        10 013753   201341 756100                    STQ     P$+2,,AUTO
        10 013754   011704 701000 10                 TSX1    ERROR
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:464  
        10 013755   000000 011000                    NOP     0

     2413    11739    1      IF FLAG.CODE=%E$ACGRANS THEN GOTO LISTNXT;

  11739 10 013756   001107 236000 0                  LDQ     FLAG
        10 013757   377770 376007                    ANQ     131064,DL
        10 013760   002160 116007                    CMPQ    1136,DL
        10 013761   004723 600000 10                 TZE     LISTNXT

  11739 10 013762                       DPCLOSE      null
     2414    11740                    /**/
     2415    11741    1   DPCLOSE:;
     2416    11742    1      CLSDP.V.DISP#=%SCRATCH#;

  11742 10 013762   000001 236007                    LDQ     1,DL
        10 013763   000224 552004 0                  STBQ    CLSDP+26,'04'O

     2417    11743    2      CALL M$CLOSE(CLSDP) WHENALTRETURN DO;

  11743 10 013764   000172 630400 0                  EPPR0   CLSDP
        10 013765   450001 713400                    CLIMB   alt,close
        10 013766   406000 401760                    pmme    nvectors=13
        10 013767   013771 702000 10                 TSX2    s:11744
        10 013770   014002 710000 10                 TRA     CMDABORT

     2418    11744    2         IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(X9);

  11744 10 013771   000000 636000 xent               EAQ     FXD$PMME
        10 013772   000002 116000 xsym               CMPQ    B_VECTNIL+2
        10 013773   014002 600000 10                 TZE     CMDABORT

  11744 10 013774   200006 630500                    EPPR0   X9,,AUTO
        10 013775   201346 450500                    STP0    BXP+1,,AUTO
        10 013776   201346 630500                    EPPR0   BXP+1,,AUTO
        10 013777   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 014000   000000 701000 xent               TSX1    FXD$PMME
        10 014001   000000 011000                    NOP     0
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:465  

     2419    11745    2         END;

  11742 10 014002                       CMDABORT     null
     2420    11746                    /**/
     2421    11747    1   CMDABORT:;
     2422    11748    1      IF CODE~=%E$PIGH THEN CALL ERROR(5);

  11748 10 014002   200007 235100                    LDA     CODE,,AUTO
        10 014003   000144 115007                    CMPA    100,DL
        10 014004   014011 600000 10                 TZE     s:11749

  11748 10 014005   000122 236000 11                 LDQ     82
        10 014006   201341 756100                    STQ     P$+2,,AUTO
        10 014007   011704 701000 10                 TSX1    ERROR
        10 014010   000000 011000                    NOP     0

     2423    11749    1      GOTO NEXT;

  11749 10 014011   000204 710000 10                 TRA     NEXT

  11748 10 014012                       NOTOWNER     null
     2424    11750                    /**/
     2425    11751    1   NOTOWNER:;
     2426    11752    1      FLAG=FMN$E$XCLSET;

  11752 10 014012   000041 236000 2                  LDQ     FMN$E$XCLSET
        10 014013   001107 756000 0                  STQ     FLAG

     2427    11753    1      GOTO DPERR1;

  11753 10 014014   013567 710000 10                 TRA     DPERR1

  11752 10 014015                       TOOMANY      null
     2428    11754                    /**/
     2429    11755    1   TOOMANY:;
     2430    11756    1      P_PCB.ERROR.CODE=7;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:466  

  11756 10 014015   001022 236000 0                  LDQ     P_PCB+6
        10 014016   000151 376000 11                 ANQ     105
        10 014017   000070 276007                    ORQ     56,DL
        10 014020   001022 756000 0                  STQ     P_PCB+6

     2431    11757    1      P_PCB.HI_CHAR=OUT$BLK.SUBLK$(I)->OUT$BLK.CPOS;

  11757 10 014021   001073 470400 0                  LDP0    BLK$
        10 014022   001076 720000 0                  LXL0    I
        10 014023   000003 471510                    LDP1    3,X0,PR0
        10 014024   100002 235100                    LDA     2,,PR1
        10 014025   001026 755000 0                  STA     P_PCB+10

     2432    11758    1      GOTO VALERR;

  11758 10 014026   011574 710000 10                 TRA     VALERR

     2433    11759                    /**/
     2434    11760    1   NOCORE: TCXT=' ';

  11760 10 014027   040000 100400       NOCORE       MLR     fill='040'O
        10 014030   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 014031   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256

  11757 10 014032                       SIERR        null
     2435    11761                    /**/
     2436    11762    1   SIERR:;
     2437    11763    2      IF MODE=0 AND FPT_READ.BUF_.BUF$=ADDR(TCXT) THEN DO;

  11763 10 014032   001121 235000 0                  LDA     MODE
        10 014033   014050 601000 10                 TNZ     s:11768
        10 014034   000017 236000 11                 LDQ     15
        10 014035   001037 116000 0                  CMPQ    FPT_READ+5
        10 014036   014050 601000 10                 TNZ     s:11768

     2438    11764    2         FPT_READ.BUF_.BUF$=PINCRW(WORK_.FIRST$,20);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:467  

  11764 10 014037   001013 236000 0                  LDQ     WORK_+1
        10 014040   000024 036003                    ADLQ    20,DU
        10 014041   001037 756000 0                  STQ     FPT_READ+5

     2439    11765    2         FPT_READ.BUF_.BOUND=1004*4-1;

  11765 10 014042   001036 236000 0                  LDQ     FPT_READ+4
        10 014043   177777 376007                    ANQ     65535,DL
        10 014044   000156 276000 11                 ORQ     110
        10 014045   001036 756000 0                  STQ     FPT_READ+4

     2440    11766    2         CALL M$RETRY;

  11766 10 014046   010010 713400                    CLIMB   4104
        10 014047   000000 401760                    pmme    nvectors=0

     2441    11767    2         END;

     2442    11768    1      FLAG=B$ALT.ERR;

  11768 10 014050   000000 470400 xsym               LDP0    B$TCB$
        10 014051   000000 471500                    LDP1    0,,PR0
        10 014052   100102 236100                    LDQ     66,,PR1
        10 014053   001107 756000 0                  STQ     FLAG

     2443    11769    1      FLAG.SEV=0;

  11769 10 014054   000161 236000 11                 LDQ     113
        10 014055   001107 356000 0                  ANSQ    FLAG

     2444    11770    1      EFPT.V.DCB#=DCBNUM(M$SI);

  11770 10 014056   000000 236007 xsym               LDQ     M$SI,DL
        10 014057   000000 620006                    EAX0    0,QL
        10 014060   000346 740000 0                  STX0    EFPT+22

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:468  
     2445    11771    1      CALL M$ERRMSG(EFPT)ALTRET(HERE7);

  11771 10 014061   000320 630400 0                  EPPR0   EFPT
        10 014062   420000 713400                    CLIMB   alt,+8192
        10 014063   405000 401760                    pmme    nvectors=11
        10 014064   014065 702000 10                 TSX2    HERE7

  11770 10 014065                       HERE7        null
     2446    11772    1   HERE7:;
     2447    11773    1      IF TCXT~=' ' AND (NOT M$SI$->F$DCB.DDEV.IC

  11773 10 014065   040000 106400                    CMPC    fill='040'O
        10 014066   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256
        10 014067   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 014070   014105 600000 10                 TZE     s:11775
        10 014071   001123 470400 0                  LDP0    M$SI$
        10 014072   000004 236100                    LDQ     4,,PR0
        10 014073   100000 316007                    CANQ    32768,DL
        10 014074   014101 600000 10                 TZE     s:11774
        10 014075   001122 471400 0                  LDP1    M$LO$
        10 014076   100004 236100                    LDQ     4,,PR1
        10 014077   100000 316007                    CANQ    32768,DL
        10 014100   014105 601000 10                 TNZ     s:11775

     2448    11774    1        OR NOT M$LO$->F$DCB.DDEV.IC) THEN CALL ERROR(4);

  11774 10 014101   000007 236000 11                 LDQ     7
        10 014102   201341 756100                    STQ     P$+2,,AUTO
        10 014103   011704 701000 10                 TSX1    ERROR
        10 014104   000000 011000                    NOP     0

     2449    11775    1      P_PCB.NCHARS=0;

  11775 10 014105   001025 450000 0                  STZ     P_PCB+9

     2450    11776    1      CALL ERROR(2);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:469  
  11776 10 014106   000037 236000 11                 LDQ     31
        10 014107   201341 756100                    STQ     P$+2,,AUTO
        10 014110   011704 701000 10                 TSX1    ERROR
        10 014111   000000 011000                    NOP     0

     2451    11777    1      IF MODE=0 THEN GOTO NEXT;

  11777 10 014112   001121 235000 0                  LDA     MODE
        10 014113   000204 600000 10                 TZE     NEXT

     2452    11778    1      CALL CLOSE(DCBNUM(M$LO));

  11778 10 014114   000000 236007 xsym               LDQ     M$LO,DL
        10 014115   201374 756100                    STQ     BXP+23,,AUTO
        10 014116   201374 630500                    EPPR0   BXP+23,,AUTO
        10 014117   201341 450500                    STP0    P$+2,,AUTO
        10 014120   012416 701000 10                 TSX1    CLOSE
        10 014121   000000 011000                    NOP     0

     2453    11779    1      ALTRETURN;

  11779 10 014122   000000 702200 xent               TSX2  ! X66_AALT

  11777 10 014123                       NOALT        null
     2454    11780    1   NOALT:;
     2455    11781    1      IF ENTADDR(FXD$PMME)=ENTADDR(NIL) THEN FLAG=B$ALT.ERR;

  11781 10 014123   000000 636000 xent               EAQ     FXD$PMME
        10 014124   000002 116000 xsym               CMPQ    B_VECTNIL+2
        10 014125   014133 601000 10                 TNZ     s:11782

  11781 10 014126   000000 470400 xsym               LDP0    B$TCB$
        10 014127   000000 471500                    LDP1    0,,PR0
        10 014130   100102 236100                    LDQ     66,,PR1
        10 014131   001107 756000 0                  STQ     FLAG
        10 014132   014137 710000 10                 TRA     s:11783

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:470  
     2456    11782    1      ELSE CALL FXD$PMME(FLAG);

  11782 10 014133   000157 630400 11                 EPPR0   111
        10 014134   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 014135   000000 701000 xent               TSX1    FXD$PMME
        10 014136   000000 011000                    NOP     0

     2457    11783    1      FLAG.SEV=0;

  11783 10 014137   000161 236000 11                 LDQ     113
        10 014140   001107 356000 0                  ANSQ    FLAG

     2458    11784    1      CALL M$MERC(MERCER);

  11784 10 014141   000002 630400 2                  EPPR0   MERCER
        10 014142   010007 713400                    CLIMB   4103
        10 014143   400000 401760                    pmme    nvectors=1
        10 014144   015473 710000 10                 TRA     s:12094

     2459    11785        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:471  
     2460    11786    1   ADDPART: PROC(L,TEXT) ALTRET;

  11786 10 014145   201334 741300       ADDPART      STX1  ! DEFAULT_BUILD+724,,AUTO

     2461    11787    2   DCL L UBIN;
     2462    11788    2   DCL P$ PTR;
     2463    11789    2   DCL TEXT CHAR(L);
     2464    11790    2   DCL 1 THING BASED(P$),
     2465    11791    2         2 L UBIN BYTE UNAL,
     2466    11792    2         2 T CHAR(J);
     2467    11793    2   DCL FX_MSG$(0:0)SYMREF PTR;
     2468    11794    2   DCL V BASED(P$)CHAR(12);
     2469    11795                    /**/
     2470    11796    2      J=L;

  11796 10 014146   201335 470500                    LDP0    @L,,AUTO
        10 014147   000000 235100                    LDA     0,,PR0
        10 014150   001104 755000 0                  STA     J

     2471    11797    2      P$=PINCRC(ADDR(TEXT),-1);

  11797 10 014151   201336 236100                    LDQ     @TEXT,,AUTO
        10 014152   000034 036000 xsym               ADLQ    B_VECTNIL+28
        10 014153   201337 756100                    STQ     P$,,AUTO

     2472    11798    2      GOTO ADDPARM;

  11798 10 014154   014241 710000 10                 TRA     ADDPARM

     2473    11799                    /**/
     2474    11800    2   ADDPARNUM: ENTRY(L) ALTRET;

  11800 10 014155   201334 741300       ADDPARNUM    STX1  ! DEFAULT_BUILD+724,,AUTO

     2475    11801    2      P$=FX_MSG$(L);

  11801 10 014156   201335 470500                    LDP0    @L,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:472  
        10 014157   000000 720100                    LXL0    0,,PR0
        10 014160   000000 236010 xsym               LDQ     FX_MSG$,X0
        10 014161   201337 756100                    STQ     P$,,AUTO

     2476    11802    2      P$=PINCRC(ADDR(THING),THING.L-11);

  11802 10 014162   201337 471500                    LDP1    P$,,AUTO
        10 014163   000100 101500                    MRL     fill='000'O
        10 014164   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        10 014165   201346 000004                    ADSC9   BXP+1,,AUTO              cn=0,n=4
        10 014166   201346 236100                    LDQ     BXP+1,,AUTO
        10 014167   000020 736000                    QLS     16
        10 014170   000162 136000 11                 SBLQ    114
        10 014171   201337 036100                    ADLQ    P$,,AUTO
        10 014172   201337 756100                    STQ     P$,,AUTO

     2477    11803    2      CALL BINCHAR(V,J);

  11803 10 014173   001104 235000 0                  LDA     J
        10 014174   000044 773000                    LRL     36
        10 014175   201346 757100                    STAQ    BXP+1,,AUTO
        10 014176   201337 471500                    LDP1    P$,,AUTO
        10 014177   000100 301500                    BTD
        10 014200   201346 000010                    NDSC9   BXP+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
        10 014201   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12

     2478    11804    2      CALL EDITCHAR(V,0,11,'001001011'B,V);

  11804 10 014202   100000 024500                    MVNE
        10 014203   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12
        10 014204   000163 000001 11                 ADSC9   115                      cn=0,n=1
        10 014205   100000 000013                    ADSC9   0,,PR1                   cn=0,n=11

     2479    11805    2      CALL INDEX1R(J,' ',V);

  11805 10 014206   000000 125500                    SCMR    mask='000'O
        10 014207   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:473  
        10 014210   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 014211   001104 000000 0                  ARG     J
        10 014212   014215 606400 10                 TTN     s:11806
        10 014213   000013 236007                    LDQ     11,DL
        10 014214   001104 156000 0                  SSQ     J

     2480    11806    2      J=J+1;

  11806 10 014215   001104 235000 0                  LDA     J
        10 014216   000001 035007                    ADLA    1,DL
        10 014217   001104 755000 0                  STA     J

     2481    11807    2      CALL INSERT(V,0,,SUBSTR(V,J,12-J));

  11807 10 014220   777763 620005                    EAX0    -13,AL
        10 014221   777777 660003                    ERX0    -1,DU
        10 014222   040100 100545                    MLR     fill='040'O
        10 014223   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
        10 014224   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
        10 014225   014227 710000 10                 TRA     ADDPARAM+1

     2482    11808    2   ADDPARAM:ENTRY(L) ALTRET;

  11808 10 014226   201334 741300       ADDPARAM     STX1  ! DEFAULT_BUILD+724,,AUTO
        10 014227   014231 710000 10                 TRA     s:11810

     2483    11809    2   ADDPAREQ:ENTRY(L) ALTRET;

  11809 10 014230   201334 741300       ADDPAREQ     STX1  ! DEFAULT_BUILD+724,,AUTO

     2484    11810    2      P$=FX_MSG$(L);

  11810 10 014231   201335 470500                    LDP0    @L,,AUTO
        10 014232   000000 720100                    LXL0    0,,PR0
        10 014233   000000 236010 xsym               LDQ     FX_MSG$,X0
        10 014234   201337 756100                    STQ     P$,,AUTO

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:474  
     2485    11811                    /**/
     2486    11812    2      J=THING.L;

  11812 10 014235   201337 471500                    LDP1    P$,,AUTO
        10 014236   000000 101500                    MRL     fill='000'O
        10 014237   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        10 014240   001104 000004 0                  ADSC9   J                        cn=0,n=4

  11812 10 014241                       ADDPARM      null
     2487    11813    2   ADDPARM:;
     2488    11814    3      DO WHILE (SUBSTR(THING.T,J-1,1)=' ');

  11814 10 014241   014245 710000 10                 TRA     s:11816

     2489    11815    3         J=J-1;

  11815 10 014242   001104 235000 0                  LDA     J
        10 014243   000001 135007                    SBLA    1,DL
        10 014244   001104 755000 0                  STA     J

     2490    11816    3         END;

  11816 10 014245   201337 470500                    LDP0    P$,,AUTO
        10 014246   001104 235000 0                  LDA     J
        10 014247   040000 106505                    CMPC    fill='040'O
        10 014250   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        10 014251   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 014252   014242 600000 10                 TZE     s:11815

     2491    11817    3      IF I+J>WIDTH THEN DO;

  11817 10 014253   001076 236000 0                  LDQ     I
        10 014254   001104 036000 0                  ADLQ    J
        10 014255   001124 116000 0                  CMPQ    WIDTH
        10 014256   014306 602000 10                 TNC     s:11826
        10 014257   014306 600000 10                 TZE     s:11826

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:475  
     2492    11818    3         IF MODE~=0 THEN CALL ERROR(10); /* STAR 42856 MAKE CALL CONDITIONAL */

  11818 10 014260   001121 236000 0                  LDQ     MODE
        10 014261   014266 600000 10                 TZE     s:11819

  11818 10 014262   000016 236000 11                 LDQ     14
        10 014263   201341 756100                    STQ     @I,,AUTO
        10 014264   011704 701000 10                 TSX1    ERROR
        10 014265   000000 011000                    NOP     0

     2493    11819    3         LBUFC=' ';

  11819 10 014266   040000 100400                    MLR     fill='040'O
        10 014267   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 014270   006702 000170 0                  ADSC9   LBUFC                    cn=0,n=120

     2494    11820    3         I=I0;

  11820 10 014271   001077 235000 0                  LDA     I0
        10 014272   001076 755000 0                  STA     I

     2495    11821    4         IF SUBSTR(THING.T,0,2)=', ' THEN DO;

  11821 10 014273   201337 470500                    LDP0    P$,,AUTO
        10 014274   040000 106500                    CMPC    fill='040'O
        10 014275   000000 200002                    ADSC9   0,,PR0                   cn=1,n=2
        10 014276   000563 000002 2                  ADSC9   FFLGS+76                 cn=0,n=2
        10 014277   014306 601000 10                 TNZ     s:11826

     2496    11822    4            J=J-2;

  11822 10 014300   001104 236000 0                  LDQ     J
        10 014301   000002 136007                    SBLQ    2,DL
        10 014302   001104 756000 0                  STQ     J

     2497    11823    4            P$=PINCRC(P$,2);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:476  
  11823 10 014303   201337 236100                    LDQ     P$,,AUTO
        10 014304   400000 036007                    ADLQ    -131072,DL
        10 014305   201337 756100                    STQ     P$,,AUTO

     2498    11824    4            END;

     2499    11825    3         END;

     2500    11826    2      CALL INSERT(LBUFC,I,,THING.T);

  11826 10 014306   001076 720000 0                  LXL0    I
        10 014307   777607 620010                    EAX0    -121,X0
        10 014310   777777 660003                    ERX0    -1,DU
        10 014311   201337 470500                    LDP0    P$,,AUTO
        10 014312   001104 721000 0                  LXL1    J
        10 014313   001076 235000 0                  LDA     I
        10 014314   040045 100540                    MLR     fill='040'O
        10 014315   000000 200011                    ADSC9   0,,PR0                   cn=1,n=*X1
        10 014316   006702 000010 0                  ADSC9   LBUFC,A                  cn=0,n=*X0

     2501    11827    2      I=I+J;

  11827 10 014317   001076 236000 0                  LDQ     I
        10 014320   001104 036000 0                  ADLQ    J
        10 014321   001076 756000 0                  STQ     I

     2502    11828    2      RETURN;

  11828 10 014322   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 014323   000001 702211                    TSX2  ! 1,X1

     2503    11829        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:477  
     2504    11830    2   RECONST: ENTRY ALTRET;

  11830 10 014324   201334 741300       RECONST      STX1  ! DEFAULT_BUILD+724,,AUTO

     2505    11831    2      CALL CONCAT(LBUFC,'Reconstruct initiated for DP#',OPNSN.SN#(0));

  11831 10 014325   040000 100400                    MLR     fill='040'O
        10 014326   000620 000035 2                  ADSC9   FFLGS+105                cn=0,n=29
        10 014327   006702 000035 0                  ADSC9   LBUFC                    cn=0,n=29
        10 014330   040000 100400                    MLR     fill='040'O
        10 014331   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 014332   006711 200133 0                  ADSC9   LBUFC+7                  cn=1,n=91

     2506    11832    3      IF MODE=0 THEN DO;

  11832 10 014333   001121 235000 0                  LDA     MODE
        10 014334   014431 601000 10                 TNZ     s:11862

     2507    11833                    /* PREPARE TO MAKE THE RECON INTERRUPTIBLE SO PIG DOESNT
     2508    11834                    GO AWAY */
     2509    11835    3         WROC.MSG#=HGPR_MSG#;

  11835 10 014335   000460 220003                    LDX0    304,DU
        10 014336   006666 440000 0                  SXL0    WROC

     2510    11836    3         WROC.VSN=GAC;

  11836 10 014337   000000 236000 xsym               LDQ     GAC
        10 014340   006675 756000 0                  STQ     WROC+7

     2511    11837    3         IF CSTAT.SETS.SETX(I)~=2 THEN CALL ERROR(2);

  11837 10 014341   001076 235000 0                  LDA     I
        10 014342   000001 735000                    ALS     1
        10 014343   004624 236005 0                  LDQ     CSTAT+3,AL
        10 014344   000777 376007                    ANQ     511,DL
        10 014345   000002 116007                    CMPQ    2,DL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:478  
        10 014346   014354 600000 10                 TZE     s:11838

  11837 10 014347   000037 236000 11                 LDQ     31
        10 014350   201341 756100                    STQ     @I,,AUTO
        10 014351   011704 701000 10                 TSX1    ERROR
        10 014352   000000 011000                    NOP     0
        10 014353   014360 710000 10                 TRA     s:11839

     2512    11838    3         ELSE CALL ERROR(3);

  11838 10 014354   000002 236000 11                 LDQ     2
        10 014355   201341 756100                    STQ     @I,,AUTO
        10 014356   011704 701000 10                 TSX1    ERROR
        10 014357   000000 011000                    NOP     0

     2513    11839    4         IF NOT FPT_READ.V.WAIT# THEN DO;

  11839 10 014360   001042 236000 0                  LDQ     FPT_READ+8
        10 014361   400000 316007                    CANQ    -131072,DL
        10 014362   014377 601000 10                 TNZ     s:11848

     2514    11840    4            FLAG=FXP$E$2RECON;

  11840 10 014363   000036 236000 2                  LDQ     FXP$E$2RECON
        10 014364   001107 756000 0                  STQ     FLAG

     2515    11841                    /*E*     ERROR: FXP-E$2RECON-C
     2516    11842                    *        MESSAGE: Only one reconstruct at a time, please
     2517    11843                    */
     2518    11844    4            CSTAT.SETS.SETX(I)=2;/* SET RECON WAIT FLAG */

  11844 10 014365   001076 235000 0                  LDA     I
        10 014366   000001 735000                    ALS     1
        10 014367   004624 236005 0                  LDQ     CSTAT+3,AL
        10 014370   000005 376000 11                 ANQ     5
        10 014371   000002 276007                    ORQ     2,DL
        10 014372   004624 756005 0                  STQ     CSTAT+3,AL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:479  

     2519    11845    4            CALL CATWRITE;

  11845 10 014373   012372 701000 10                 TSX1    CATWRITE
        10 014374   000000 011000                    NOP     0

     2520    11846    4            ALTRETURN;

  11846 10 014375   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 014376   000000 702211                    TSX2  ! 0,X1

     2521    11847    4            END;
     2522    11848    3         FPT_READ.V.WAIT#=%NO#;

  11848 10 014377   000164 236000 11                 LDQ     116
        10 014400   001042 356000 0                  ANSQ    FPT_READ+8

     2523    11849    4         IF FPT_READ.V.EVENT#=0 THEN DO;

  11849 10 014401   001043 235000 0                  LDA     FPT_READ+9
        10 014402   014435 601000 10                 TNZ     s:11863

     2524    11850    5            IF CODE~=0 THEN DO;

  11850 10 014403   200007 235100                    LDA     CODE,,AUTO
        10 014404   014416 600000 10                 TZE     s:11856

     2525    11851    5               FPT_READ.V.EVENT#=1;

  11851 10 014405   000001 235007                    LDA     1,DL
        10 014406   001043 755000 0                  STA     FPT_READ+9

     2526    11852    5               TCXT=' '; /* START THE NEXT COMGROUP READ */

  11852 10 014407   040000 100400                    MLR     fill='040'O
        10 014410   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 014411   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:480  

     2527    11853    5               CALL M$READ(FPT_READ);

  11853 10 014412   001032 630400 0                  EPPR0   FPT_READ
        10 014413   040000 713400                    CLIMB   read
        10 014414   401400 401760                    pmme    nvectors=4

     2528    11854    5               END;

  11854 10 014415   014435 710000 10                 TRA     s:11863

     2529    11855    5            ELSE DO;

     2530    11856    5               GBUF.CODE=1; /* MAKE A DISK DPNN KEYIN */

  11856 10 014416   000001 220003                    LDX0    1,DU
        10 014417   000706 740000 0                  STX0    TEXT

     2531    11857    5               CALL CONCAT(GBUF.PSN(0),BINASC(0),BINASC(0),ADDR(X9)->CHAR4);

  11857 10 014420   000000 236003                    LDQ     0,DU
        10 014421   000707 552040 0                  STBQ    TEXT+1,'40'O
        10 014422   000707 552020 0                  STBQ    TEXT+1,'20'O
        10 014423   040000 100500                    MLR     fill='040'O
        10 014424   200006 000004                    ADSC9   X9,,AUTO                 cn=0,n=4
        10 014425   000707 400004 0                  ADSC9   TEXT+1                   cn=2,n=4

     2532    11858    5               BREAK=1;

  11858 10 014426   000001 235007                    LDA     1,DL
        10 014427   001125 755000 0                  STA     BREAK

     2533    11859    5               END;

     2534    11860    4            END;

     2535    11861    3         END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:481  

  11861 10 014430   014435 710000 10                 TRA     s:11863

     2536    11862    2      ELSE CALL ERROR(10);

  11862 10 014431   000016 236000 11                 LDQ     14
        10 014432   201341 756100                    STQ     @I,,AUTO
        10 014433   011704 701000 10                 TSX1    ERROR
        10 014434   000000 011000                    NOP     0

     2537    11863    2      CALL FXH$RECON ALTRET(RECONERR);

  11863 10 014435   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 014436   000000 701000 xent               TSX1    FXH$RECON
        10 014437   014460 702000 10                 TSX2    RECONERR

     2538    11864    2   RECONXIT: FPT_READ.V.WAIT#=%YES#;

  11864 10 014440   400000 236007       RECONXIT     LDQ     -131072,DL
        10 014441   001042 256000 0                  ORSQ    FPT_READ+8

     2539    11865    2      IF GAC~=0 THEN CALL FGG$DONE;

  11865 10 014442   000000 235000 xsym               LDA     GAC
        10 014443   014447 600000 10                 TZE     s:11866

  11865 10 014444   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 014445   000000 701000 xent               TSX1    FGG$DONE
        10 014446   000000 011000                    NOP     0

     2540    11866    2      RETURN;

  11866 10 014447   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 014450   000001 702211                    TSX2  ! 1,X1

     2541    11867    2   RECONERR0: ERRCODE=B$ALT.ERR;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:482  
  11867 10 014451   000000 470400 xsym  RECONERR0    LDP0    B$TCB$
        10 014452   000000 471500                    LDP1    0,,PR0
        10 014453   100102 236100                    LDQ     66,,PR1
        10 014454   001074 756000 0                  STQ     ERRCODE

     2542    11868    2      FPT_READ.V.EVENT#=0;

  11868 10 014455   001043 450000 0                  STZ     FPT_READ+9
        10 014456   014460 710000 10                 TRA     RECONERR

     2543    11869    2   RECONERE: ENTRY ALTRET;

  11869 10 014457   201334 741300       RECONERE     STX1  ! DEFAULT_BUILD+724,,AUTO

     2544    11870    3   RECONERR: IF BREAK~=0 AND MODE=0 THEN DO;

  11870 10 014460   001125 235000 0     RECONERR     LDA     BREAK
        10 014461   014556 600000 10                 TZE     s:11896
        10 014462   001121 236000 0                  LDQ     MODE
        10 014463   014556 601000 10                 TNZ     s:11896

     2545    11871                    /* A COMGROUP READ HAS COMPLETED */
     2546    11872    3         BREAK=0;

  11872 10 014464   001125 450000 0                  STZ     BREAK

     2547    11873    3         CALL CLOSE(DCBNUM(M$DP));

  11873 10 014465   000000 236007 xsym               LDQ     M$DP,DL
        10 014466   201375 756100                    STQ     BXP+24,,AUTO
        10 014467   201375 630500                    EPPR0   BXP+24,,AUTO
        10 014470   201341 450500                    STP0    @I,,AUTO
        10 014471   012416 701000 10                 TSX1    CLOSE
        10 014472   000000 011000                    NOP     0

     2548    11874    3         X9=BITBIN(ERRCODE);

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:483  
  11874 10 014473   001074 235000 0                  LDA     ERRCODE
        10 014474   200006 755100                    STA     X9,,AUTO

     2549    11875    3         CALL FXP$TWO; /* PROCESS THE REQUEST */

  11875 10 014475   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 014476   000715 701000 10                 TSX1    s:9815
        10 014477   000000 011000                    NOP     0

     2550    11876    3         ERRCODE=BINBIT(X9,36);

  11876 10 014500   200006 236100                    LDQ     X9,,AUTO
        10 014501   001074 756000 0                  STQ     ERRCODE

     2551    11877    3         WROC.CADDR=M_DISK;

  11877 10 014502   100000 220003                    LDX0    32768,DU
        10 014503   006666 740000 0                  STX0    WROC

     2552    11878    3         OPNSN=RCNSN; /* RESTORE SET NAME */

  11878 10 014504   000000 100400                    MLR     fill='000'O
        10 014505   000000 000012 xsym               ADSC9   RCNSN                    cn=0,n=10
        10 014506   000072 000012 0                  ADSC9   OPNSN                    cn=0,n=10

     2553    11879    3         CALL CATREAD; /* ABORT THE RECON IF REQUEST WAS DISMOUNT */

  11879 10 014507   012341 701000 10                 TSX1    CATREAD
        10 014510   000000 011000                    NOP     0

     2554    11880    4         DO I=0 TO CSTAT.NUM; /*ALSO RESTORE CSTAT INDEX(I)*/

  11880 10 014511   001076 450000 0                  STZ     I
        10 014512   014550 710000 10                 TRA     s:11891+3

     2555    11881    5            IF OPNSN.SN#(0)=CSTAT.SETS.PSN(I) THEN DO;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:484  
  11881 10 014513   001076 235000 0                  LDA     I
        10 014514   000003 735000                    ALS     3
        10 014515   040005 106400                    CMPC    fill='040'O
        10 014516   000073 000006 0                  ADSC9   OPNSN+1                  cn=0,n=6
        10 014517   004623 000006 0                  ADSC9   CSTAT+2,A                cn=0,n=6
        10 014520   014545 601000 10                 TNZ     s:11891

     2556    11882    5               OPNDP.V.FUN#=%UPDATE#;

  11882 10 014521   001000 236007                    LDQ     512,DL
        10 014522   000145 552010 0                  STBQ    OPNDP+37,'10'O

     2557    11883    5               CALL M$OPEN(OPNDP)ALTRET(RECONERR0);

  11883 10 014523   000100 630400 0                  EPPR0   OPNDP
        10 014524   450000 713400                    CLIMB   alt,open
        10 014525   410400 401760                    pmme    nvectors=18
        10 014526   014451 702000 10                 TSX2    RECONERR0

     2558    11884    5               TCXT=' ';

  11884 10 014527   040000 100400                    MLR     fill='040'O
        10 014530   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 014531   000706 000400 0                  ADSC9   TEXT                     cn=0,n=256

     2559    11885    5               CODE=%E$MOUNT; /* MAKE A NICE MESSAGE WHEN RECON'S DONE */

  11885 10 014532   000155 235007                    LDA     109,DL
        10 014533   200007 755100                    STA     CODE,,AUTO

     2560    11886    5               FPT_READ.V.EVENT#=1; /* LET'S HEAR WHEN THIS READ'S DONE */

  11886 10 014534   000001 236007                    LDQ     1,DL
        10 014535   001043 756000 0                  STQ     FPT_READ+9

     2561    11887    5               CALL M$READ(FPT_READ); /* START ANOTHER READ */

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:485  
  11887 10 014536   001032 630400 0                  EPPR0   FPT_READ
        10 014537   040000 713400                    CLIMB   read
        10 014540   401400 401760                    pmme    nvectors=4

     2562    11888    5               CALL FXH$RECONT ALTRET(RECONERR);

  11888 10 014541   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 014542   000000 701000 xent               TSX1    FXH$RECONT
        10 014543   014460 702000 10                 TSX2    RECONERR

     2563    11889    5               GOTO RECONXIT;

  11889 10 014544   014440 710000 10                 TRA     RECONXIT

     2564    11890    5               END;
     2565    11891    4            END;

  11891 10 014545   001076 236000 0                  LDQ     I
        10 014546   000001 036007                    ADLQ    1,DL
        10 014547   001076 756000 0                  STQ     I
        10 014550   004621 236000 0                  LDQ     CSTAT
        10 014551   001076 116000 0                  CMPQ    I
        10 014552   014513 603000 10                 TRC     s:11881

     2566    11892                    /*NOT THERE ANYMORE, FLICK IT IN */
     2567    11893    3         BREAK=1; /* NO ERROR MESSAGE */

  11893 10 014553   000001 235007                    LDA     1,DL
        10 014554   001125 755000 0                  STA     BREAK

     2568    11894    3         FPT_READ.V.EVENT#=0;

  11894 10 014555   001043 450000 0                  STZ     FPT_READ+9

     2569    11895    3         END;

     2570    11896    2      FPT_READ.V.WAIT#=%YES#;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:486  

  11896 10 014556   400000 236007                    LDQ     -131072,DL
        10 014557   001042 256000 0                  ORSQ    FPT_READ+8

     2571    11897    2      FLAG=ERRCODE;

  11897 10 014560   001074 236000 0                  LDQ     ERRCODE
        10 014561   001107 756000 0                  STQ     FLAG

     2572    11898    2      FLAG.SEV=7;

  11898 10 014562   000007 236007                    LDQ     7,DL
        10 014563   001107 256000 0                  ORSQ    FLAG

     2573    11899    2      IF GAC~=0 THEN CALL FGG$QUIT;

  11899 10 014564   000000 235000 xsym               LDA     GAC
        10 014565   014571 600000 10                 TZE     s:11900

  11899 10 014566   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 014567   000000 701000 xent               TSX1    FGG$QUIT
        10 014570   000000 011000                    NOP     0

     2574    11900    2      ALTRETURN;

  11900 10 014571   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 014572   000000 702211                    TSX2  ! 0,X1

     2575    11901    2   END ADDPART;
     2576    11902        %EJECT;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:487  
     2577    11903    1   GET_OPTIONS: PROC ALTRET;

  11903 10 014573   201334 741300       GET_OPTIONS  STX1  ! DEFAULT_BUILD+724,,AUTO

     2578    11904    2   DCL FFLGS(0:19) CONSTANT BIT(36) INIT(
     2579    11905        %EQU REMACN='0000004'O;
     2580    11906        %EQU REMPRM='0000002'O;
     2581    11907    2        %NO#,%REMACN,%REMPRM,%NO#,%FFLG_WRITE#,
     2582    11908    2        %FFLG_WNEW#,%FFLG_REATTR#*2,%FFLG_READ#,
     2583    11909    2        %FFLG_DELF#*2,%FFLG_DELR#,%FFLG_NOLIST#,
     2584    11910    2        %FFLG_EXEC#,%FFLG_UPD#,%FFLG_CREATE#,'0'B*0);
     2585    11911    2   DCL K SBIN;
     2586    11912    2      J=0;

  11912 10 014574   001104 450000 0                  STZ     J

     2587    11913    2      FLAG='0'B;

  11913 10 014575   001107 450000 0                  STZ     FLAG

  11913 10 014576                       NXTOPT       null
     2588    11914    2   NXTOPT:;
     2589    11915    2      P$=OUT$BLK.SUBLK$(I);

  11915 10 014576   001073 470400 0                  LDP0    BLK$
        10 014577   001076 720000 0                  LXL0    I
        10 014600   000003 236110                    LDQ     3,X0,PR0
        10 014601   001103 756000 0                  STQ     P$

     2590    11916    3      DO CASE(P$->OUT$BLK.CODE);

  11916 10 014602   001103 471400 0                  LDP1    P$
        10 014603   100000 721100                    LXL1    0,,PR1
        10 014604   000025 101003                    CMPX1   21,DU
        10 014605   014607 602011 10                 TNC     s:11916+5,X1
        10 014606   015461 710000 10                 TRA     s:12089
        10 014607   015136 710000 10                 TRA     s:12046
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:488  
        10 014610   014634 710000 10                 TRA     s:11933
        10 014611   014642 710000 10                 TRA     s:11942
        10 014612   014651 710000 10                 TRA     s:11949
        10 014613   014703 710000 10                 TRA     s:11960
        10 014614   014712 710000 10                 TRA     s:11967
        10 014615   014720 710000 10                 TRA     s:11974
        10 014616   014746 710000 10                 TRA     s:11984
        10 014617   014766 710000 10                 TRA     s:11993
        10 014620   014777 710000 10                 TRA     s:12001
        10 014621   015005 710000 10                 TRA     s:12008
        10 014622   015013 710000 10                 TRA     s:12015
        10 014623   015021 710000 10                 TRA     s:12022
        10 014624   015030 710000 10                 TRA     s:12029
        10 014625   015036 710000 10                 TRA     s:12036
        10 014626   015461 710000 10                 TRA     s:12089
        10 014627   015461 710000 10                 TRA     s:12089
        10 014630   015461 710000 10                 TRA     s:12089
        10 014631   015461 710000 10                 TRA     s:12089
        10 014632   015461 710000 10                 TRA     s:12089
        10 014633   015045 710000 10                 TRA     s:12038

     2591    11917                    /* MACRO TO KEEP THESE CASE STMTS AND THE NODES ALIGNED */
     2592    11918                    /* JUST KEEP THEM BOTH IN THE SAME ORDER */
     2593    11919        %SET CASE=0;
     2594    11920        %MACRO CASE(C=);
     2595    11921        %SET CASE=CASE+1;
     2596    11922        %LSET LISTEXP='1'B;
     2597    11923        %LSET LISTSUB='1'B;
     2598    11924           CASE(%CASE); %CHARTEXT('/*') C %CHARTEXT('*/')
     2599    11925        %MEND;
     2600    11926        %SET LISTDIR='0'B;
             11931    3      CASE(1); /* NOT... */

     2602    11933    3         FLAG='1'B;

  11933 10 014634   400000 236003                    LDQ     -131072,DU
        10 014635   001107 756000 0                  STQ     FLAG
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:489  

     2603    11934    3         I=I+1;

  11934 10 014636   001076 235000 0                  LDA     I
        10 014637   000001 035007                    ADLA    1,DL
        10 014640   001076 755000 0                  STA     I

     2604    11935    3         GOTO NXTOPT;

  11935 10 014641   014576 710000 10                 TRA     NXTOPT

             11940    3      CASE(2); /* NEWFDS */

     2606    11942    3         CODE14.ACCESS.NEWFD=~FLAG;

  11942 10 014642   001107 236000 0                  LDQ     FLAG
        10 014643   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 014644   000021 772000                    QRL     17
        10 014645   001434 676000 0                  ERQ     CODE14
        10 014646   000001 376003                    ANQ     1,DU
        10 014647   001434 656000 0                  ERSQ    CODE14
        10 014650   015461 710000 10                 TRA     s:12089

             11947    3      CASE(3); /* CGMEM */

     2608    11949    3         I=I+1;

  11949 10 014651   001076 235000 0                  LDA     I
        10 014652   000001 035007                    ADLA    1,DL
        10 014653   001076 755000 0                  STA     I

     2609    11950    3         CALL CHARBIN(J,OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT);

  11950 10 014654   000003 473505                    LDP3    3,AL,PR0
        10 014655   001076 720000 0                  LXL0    I
        10 014656   000003 474510                    LDP4    3,X0,PR0
        10 014657   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:490  
        10 014660   000033 772000                    QRL     27
        10 014661   000000 621006                    EAX1    0,QL
        10 014662   000100 305540                    DTB
        10 014663   400004 230011                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
        10 014664   201346 000010                    NDSC9   BXP+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
        10 014665   201347 235100                    LDA     BXP+2,,AUTO
        10 014666   001104 755000 0                  STA     J

     2610    11951    3         J=(J+%CGMEMSIZ-1)/%CGMEMSIZ;

  11951 10 014667   001104 236000 0                  LDQ     J
        10 014670   000007 036007                    ADLQ    7,DL
        10 014671   000003 772000                    QRL     3
        10 014672   001104 756000 0                  STQ     J

     2611    11952    3         CODE14.CGMEM=J;

  11952 10 014673   000033 736000                    QLS     27
        10 014674   001435 552040 0                  STBQ    CODE14+1,'40'O

     2612    11953    3         IF CODE14.CGMEM~=J THEN ALTRETURN;

  11953 10 014675   001435 236000 0                  LDQ     CODE14+1
        10 014676   000033 772000                    QRL     27
        10 014677   001104 116000 0                  CMPQ    J
        10 014700   015461 600000 10                 TZE     s:12089

  11953 10 014701   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 014702   000000 702211                    TSX2  ! 0,X1

             11958    3      CASE(4); /* CHECKWRITE */

     2614    11960    3         CODE14.ACCESS.WRCMP=~FLAG;

  11960 10 014703   001107 236000 0                  LDQ     FLAG
        10 014704   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 014705   000002 772000                    QRL     2
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:491  
        10 014706   001434 676000 0                  ERQ     CODE14
        10 014707   100000 376003                    ANQ     32768,DU
        10 014710   001434 656000 0                  ERSQ    CODE14
        10 014711   015461 710000 10                 TRA     s:12089

             11965    3      CASE(5); /* PROTECTED FILES */

     2616    11967    3         CODE14.ACCESS.OWNERF=FLAG;

  11967 10 014712   001107 236000 0                  LDQ     FLAG
        10 014713   000006 772000                    QRL     6
        10 014714   001434 676000 0                  ERQ     CODE14
        10 014715   004000 376003                    ANQ     2048,DU
        10 014716   001434 656000 0                  ERSQ    CODE14
        10 014717   015461 710000 10                 TRA     s:12089

             11972    3      CASE(6); /* GRAN LIMIT */

     2618    11974    3         I=I+1;

  11974 10 014720   001076 235000 0                  LDA     I
        10 014721   000001 035007                    ADLA    1,DL
        10 014722   001076 755000 0                  STA     I

     2619    11975    3         CALL CHARBIN(J,OUT$BLK.SUBLK$(I)->OUT$SYM.TEXT);

  11975 10 014723   000003 473505                    LDP3    3,AL,PR0
        10 014724   001076 720000 0                  LXL0    I
        10 014725   000003 474510                    LDP4    3,X0,PR0
        10 014726   300004 236100                    LDQ     4,,PR3
        10 014727   000033 772000                    QRL     27
        10 014730   000000 621006                    EAX1    0,QL
        10 014731   000100 305540                    DTB
        10 014732   400004 230011                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
        10 014733   201346 000010                    NDSC9   BXP+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
        10 014734   201347 235100                    LDA     BXP+2,,AUTO
        10 014735   001104 755000 0                  STA     J
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:492  

     2620    11976    3         CODE14.MGRANS=J;

  11976 10 014736   001104 236000 0                  LDQ     J
        10 014737   001435 552034 0                  STBQ    CODE14+1,'34'O

     2621    11977    3         IF CODE14.MGRANS~=J THEN ALTRETURN;

  11977 10 014740   001435 236000 0                  LDQ     CODE14+1
        10 014741   000032 376000 xsym               ANQ     B_VECTNIL+26
        10 014742   001104 116000 0                  CMPQ    J
        10 014743   015461 600000 10                 TZE     s:12089

  11977 10 014744   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 014745   000000 702211                    TSX2  ! 0,X1

             11982    3      CASE(7); /* DEFAULT BACKUP */

     2623    11984    3         I=I+1; /* SKIP BACKUP (MUST BE THERE) */

  11984 10 014746   001076 235000 0                  LDA     I
        10 014747   000001 035007                    ADLA    1,DL
        10 014750   001076 755000 0                  STA     I

     2624    11985    3         CODE14.ACCESS.BUPM=~FLAG;

  11985 10 014751   001107 236000 0                  LDQ     FLAG
        10 014752   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 014753   000004 772000                    QRL     4
        10 014754   001434 676000 0                  ERQ     CODE14
        10 014755   020000 376003                    ANQ     8192,DU
        10 014756   001434 656000 0                  ERSQ    CODE14

     2625    11986    3         CODE14.ACCESS.BUPF=~FLAG;

  11986 10 014757   001107 236000 0                  LDQ     FLAG
        10 014760   000027 676000 xsym               ERQ     B_VECTNIL+23
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:493  
        10 014761   000003 772000                    QRL     3
        10 014762   001434 676000 0                  ERQ     CODE14
        10 014763   040000 376003                    ANQ     16384,DU
        10 014764   001434 656000 0                  ERSQ    CODE14
        10 014765   015461 710000 10                 TRA     s:12089

             11991    3      CASE(8); /* BACKUP */

     2627    11993    3         CODE14.ACCESS.BUPF=~FLAG;

  11993 10 014766   001107 236000 0                  LDQ     FLAG
        10 014767   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 014770   000003 772000                    QRL     3
        10 014771   001434 676000 0                  ERQ     CODE14
        10 014772   040000 376003                    ANQ     16384,DU
        10 014773   001434 656000 0                  ERSQ    CODE14

     2628    11994    3         CODE14.ACCESS.BUPM='0'B;

  11994 10 014774   000165 236000 11                 LDQ     117
        10 014775   001434 356000 0                  ANSQ    CODE14
        10 014776   015461 710000 10                 TRA     s:12089

             11999    3      CASE(9); /* PURGE */

     2630    12001    3         CODE14.ACCESS.NPUR=FLAG;

  12001 10 014777   001107 236000 0                  LDQ     FLAG
        10 015000   000005 772000                    QRL     5
        10 015001   001434 676000 0                  ERQ     CODE14
        10 015002   010000 376003                    ANQ     4096,DU
        10 015003   001434 656000 0                  ERSQ    CODE14
        10 015004   015461 710000 10                 TRA     s:12089

             12006    3      CASE(10); /* ACUP */

     2632    12008    3         CODE14.ACCESS.NOACUP=FLAG;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:494  

  12008 10 015005   001107 236000 0                  LDQ     FLAG
        10 015006   000007 772000                    QRL     7
        10 015007   001434 676000 0                  ERQ     CODE14
        10 015010   002000 376003                    ANQ     1024,DU
        10 015011   001434 656000 0                  ERSQ    CODE14
        10 015012   015461 710000 10                 TRA     s:12089

             12013    3      CASE(11); /* STOW */

     2634    12015    3         CODE14.ACCESS.NOSTOW=FLAG;

  12015 10 015013   001107 236000 0                  LDQ     FLAG
        10 015014   000010 772000                    QRL     8
        10 015015   001434 676000 0                  ERQ     CODE14
        10 015016   001000 376003                    ANQ     512,DU
        10 015017   001434 656000 0                  ERSQ    CODE14
        10 015020   015461 710000 10                 TRA     s:12089

             12020    3      CASE(12); /* SHELFTIME */

     2636    12022    3         CODE14.ACCESS.GACSHELF=~FLAG;

  12022 10 015021   001107 236000 0                  LDQ     FLAG
        10 015022   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 015023   000020 772000                    QRL     16
        10 015024   001434 676000 0                  ERQ     CODE14
        10 015025   000002 376003                    ANQ     2,DU
        10 015026   001434 656000 0                  ERSQ    CODE14
        10 015027   015461 710000 10                 TRA     s:12089

             12027    3      CASE(13); /* DATA CHECKWRITE */

     2638    12029    3         CODE14.ACCESS.WCDATA=~FLAG;

  12029 10 015030   001107 236000 0                  LDQ     FLAG
        10 015031   000027 676000 xsym               ERQ     B_VECTNIL+23
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:495  
        10 015032   001434 676000 0                  ERQ     CODE14
        10 015033   400000 376003                    ANQ     -131072,DU
        10 015034   001434 656000 0                  ERSQ    CODE14
        10 015035   015461 710000 10                 TRA     s:12089

             12034    3      CASE(14); /* MERGEACCESS */

     2640    12036    3         CODE14.ACCESS.MERGEAC=~FLAG;

  12036 10 015036   001107 236000 0                  LDQ     FLAG
        10 015037   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 015040   000011 772000                    QRL     9
        10 015041   001434 676000 0                  ERQ     CODE14
        10 015042   000400 376003                    ANQ     256,DU
        10 015043   001434 656000 0                  ERSQ    CODE14
        10 015044   015461 710000 10                 TRA     s:12089

     2641    12037    3      CASE(20); /* OWNER */

     2642    12038    4         DO J=0 TO P$->OUT$BLK.NSUBLKS-1 BY 2;

  12038 10 015045   001104 450000 0                  STZ     J
        10 015046   015111 710000 10                 TRA     s:12042+3

     2643    12039    4            IF J=2*SIZEW(CODE14.OWNER)/SIZEW(CODE14.OWNER(0)) THEN GOTO RETALT;

  12039 10 015047   001104 235000 0                  LDA     J
        10 015050   000062 115007                    CMPA    50,DL
        10 015051   015463 600000 10                 TZE     RETALT

     2644    12040    4            CODE14.OWNER.ACCT(J/2)=P$->OUT$BLK.SUBLK$(J)->OUT$SYM.TEXT;

  12040 10 015052   001104 236000 0                  LDQ     J
        10 015053   000001 772000                    QRL     1
        10 015054   000005 402007                    MPY     5,DL
        10 015055   001103 470400 0                  LDP0    P$
        10 015056   001104 720000 0                  LXL0    J
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:496  
        10 015057   000003 471510                    LDP1    3,X0,PR0
        10 015060   000000 621006                    EAX1    0,QL
        10 015061   100004 236100                    LDQ     4,,PR1
        10 015062   000033 772000                    QRL     27
        10 015063   000000 635011                    EAA     0,X1
        10 015064   000020 771000                    ARL     16
        10 015065   000000 621006                    EAX1    0,QL
        10 015066   040005 100540                    MLR     fill='040'O
        10 015067   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 015070   001437 000010 0                  ADSC9   CODE14+3,A               cn=0,n=8

     2645    12041    4            CODE14.OWNER.NAME(J/2)=P$->OUT$BLK.SUBLK$(J+1)->OUT$SYM.TEXT;

  12041 10 015071   001104 236000 0                  LDQ     J
        10 015072   000001 772000                    QRL     1
        10 015073   001104 720000 0                  LXL0    J
        10 015074   000004 471510                    LDP1    4,X0,PR0
        10 015075   201346 756100                    STQ     BXP+1,,AUTO
        10 015076   100004 236100                    LDQ     4,,PR1
        10 015077   000033 772000                    QRL     27
        10 015100   000000 621006                    EAX1    0,QL
        10 015101   201346 236100                    LDQ     BXP+1,,AUTO
        10 015102   000024 402007                    MPY     20,DL
        10 015103   040006 100540                    MLR     fill='040'O
        10 015104   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 015105   001441 000014 0                  ADSC9   CODE14+5,Q               cn=0,n=12

     2646    12042    4            END;

  12042 10 015106   001104 235000 0                  LDA     J
        10 015107   000002 035007                    ADLA    2,DL
        10 015110   001104 755000 0                  STA     J
        10 015111   001103 470400 0                  LDP0    P$
        10 015112   000001 236100                    LDQ     1,,PR0
        10 015113   000022 772000                    QRL     18
        10 015114   001104 116000 0                  CMPQ    J
        10 015115   015117 600000 10                 TZE     s:12043
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:497  
        10 015116   015047 603000 10                 TRC     s:12039

     2647    12043    3         FIT14.NDW=SIZEW(CODE14)-SIZEW(CODE14.OWNER)+J*SIZEW(CODE14.OWNER(0))/2;

  12043 10 015117   001104 236000 0                  LDQ     J
        10 015120   000005 402007                    MPY     5,DL
        10 015121   000001 772000                    QRL     1
        10 015122   000003 036007                    ADLQ    3,DL
        10 015123   000012 736000                    QLS     10
        10 015124   001417 676000 0                  ERQ     FIT14
        10 015125   000132 376000 11                 ANQ     90
        10 015126   001417 656000 0                  ERSQ    FIT14

     2648    12044    3         FIT14.NAW=FIT14.NDW;

  12044 10 015127   001417 236000 0                  LDQ     FIT14
        10 015130   000132 376000 11                 ANQ     90
        10 015131   000012 736000                    QLS     10
        10 015132   001417 676000 0                  ERQ     FIT14
        10 015133   017774 376003                    ANQ     8188,DU
        10 015134   001417 656000 0                  ERSQ    FIT14
        10 015135   015461 710000 10                 TRA     s:12089

     2649    12045    3      CASE(0); /* ACCESS CONTROL */

     2650    12046    4         DO WHILE(P$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE~=0);

  12046 10 015136   001104 722000 0                  LXL2    J
        10 015137   100003 473512                    LDP3    3,X2,PR1
        10 015140   300000 723100                    LXL3    0,,PR3
        10 015141   015174 600000 10                 TZE     s:12052

     2651    12047    4            IF X9=0 AND P$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE<4

  12047 10 015142   200006 235100                    LDA     X9,,AUTO
        10 015143   015157 601000 10                 TNZ     s:12049
        10 015144   001103 470400 0                  LDP0    P$
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:498  
        10 015145   001104 720000 0                  LXL0    J
        10 015146   000003 471510                    LDP1    3,X0,PR0
        10 015147   100000 721100                    LXL1    0,,PR1
        10 015150   000004 101003                    CMPX1   4,DU
        10 015151   015157 603000 10                 TRC     s:12049

     2652    12048    4            THEN X9=FIT09.NDW*4/10;

  12048 10 015152   001420 236000 0                  LDQ     FIT09
        10 015153   000010 772000                    QRL     8
        10 015154   007774 376007                    ANQ     4092,DL
        10 015155   000012 506007                    DIV     10,DL
        10 015156   200006 756100                    STQ     X9,,AUTO

     2653    12049    4            FLAG=FLAG|FFLGS(P$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE);

  12049 10 015157   001103 470400 0                  LDP0    P$
        10 015160   001104 720000 0                  LXL0    J
        10 015161   000003 471510                    LDP1    3,X0,PR0
        10 015162   100000 721100                    LXL1    0,,PR1
        10 015163   001107 236000 0                  LDQ     FLAG
        10 015164   000447 276011 2                  ORQ     FFLGS,X1
        10 015165   001107 756000 0                  STQ     FLAG

     2654    12050    4            J=J+1;

  12050 10 015166   001104 235000 0                  LDA     J
        10 015167   000001 035007                    ADLA    1,DL
        10 015170   001104 755000 0                  STA     J

     2655    12051    4            END;

  12051 10 015171   000003 471505                    LDP1    3,AL,PR0
        10 015172   100000 720100                    LXL0    0,,PR1
        10 015173   015142 601000 10                 TNZ     s:12047

     2656    12052    3         IF J>1 AND FLAG&%FFLG_READ#
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:499  

  12052 10 015174   001104 235000 0                  LDA     J
        10 015175   000002 115007                    CMPA    2,DL
        10 015176   015240 602000 10                 TNC     s:12061
        10 015177   001107 236000 0                  LDQ     FLAG
        10 015200   400000 376003                    ANQ     -131072,DU
        10 015201   015240 600000 10                 TZE     s:12061
        10 015202   001107 236000 0                  LDQ     FLAG
        10 015203   077777 376003                    ANQ     32767,DU
        10 015204   015240 601000 10                 TNZ     s:12061
        10 015205   001107 236000 0                  LDQ     FLAG
        10 015206   300000 376003                    ANQ     98304,DU
        10 015207   300000 116003                    CMPQ    98304,DU
        10 015210   015240 600000 10                 TZE     s:12061
        10 015211   001103 470400 0                  LDP0    P$
        10 015212   000002 471505                    LDP1    2,AL,PR0
        10 015213   001104 720000 0                  LXL0    J
        10 015214   000001 473510                    LDP3    1,X0,PR0
        10 015215   300002 236100                    LDQ     2,,PR3
        10 015216   000001 036007                    ADLQ    1,DL
        10 015217   100002 116100                    CMPQ    2,,PR1
        10 015220   015240 601000 10                 TNZ     s:12061
        10 015221   000002 471510                    LDP1    2,X0,PR0
        10 015222   100000 721100                    LXL1    0,,PR1
        10 015223   000013 101003                    CMPX1   11,DU
        10 015224   015230 600000 10                 TZE     s:12059
        10 015225   300000 722100                    LXL2    0,,PR3
        10 015226   000005 102003                    CMPX2   5,DU
        10 015227   015240 601000 10                 TNZ     s:12061

     2657    12053    3           AND NOT FLAG&%(~FFLG_READ#&~FFLG_DELR#&~FFLG_WNEW#)
     2658    12054    3           AND (FLAG&%(FFLG_DELR#|FFLG_WNEW#))~=%(FFLG_DELR#|FFLG_WNEW#)
     2659    12055    3           AND P$->OUT$BLK.SUBLK$(J-1)->OUT$BLK.CPOS=
     2660    12056    3           P$->OUT$BLK.SUBLK$(J-2)->OUT$BLK.CPOS+1
     2661    12057    3           AND (P$->OUT$BLK.SUBLK$(J-1)->OUT$BLK.CODE=11
     2662    12058    3           OR P$->OUT$BLK.SUBLK$(J-2)->OUT$BLK.CODE=5)
     2663    12059    3         THEN IF FLAG&%FFLG_WNEW# THEN FLAG=%FFLG_WRITE#;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:500  

  12059 10 015230   001107 236000 0                  LDQ     FLAG
        10 015231   100000 376003                    ANQ     32768,DU
        10 015232   015236 600000 10                 TZE     s:12060

  12059 10 015233   765000 236003                    LDQ     -5632,DU
        10 015234   001107 756000 0                  STQ     FLAG
        10 015235   015240 710000 10                 TRA     s:12061

     2664    12060    3         ELSE FLAG=%FFLG_READ#;

  12060 10 015236   400000 236003                    LDQ     -131072,DU
        10 015237   001107 756000 0                  STQ     FLAG

     2665    12061    4         DO WHILE(J<P$->OUT$BLK.NSUBLKS);

  12061 10 015240   001103 470400 0                  LDP0    P$
        10 015241   000001 236100                    LDQ     1,,PR0
        10 015242   000022 772000                    QRL     18
        10 015243   001104 116000 0                  CMPQ    J
        10 015244   015443 602000 10                 TNC     s:12086
        10 015245   015443 600000 10                 TZE     s:12086

     2666    12062    4            IF X9=SIZEW(CODE09)/SIZEW(CODE09(0)) THEN GOTO RETALT;

  12062 10 015246   200006 235100                    LDA     X9,,AUTO
        10 015247   000246 115007                    CMPA    166,DL
        10 015250   015463 600000 10                 TZE     RETALT

     2667    12063    4            CODE09.ACCT(X9)=P$->OUT$BLK.SUBLK$(J)->OUT$SYM.TEXT;

  12063 10 015251   001103 470400 0                  LDP0    P$
        10 015252   001104 720000 0                  LXL0    J
        10 015253   000003 471510                    LDP1    3,X0,PR0
        10 015254   100004 236100                    LDQ     4,,PR1
        10 015255   000033 772000                    QRL     27
        10 015256   000000 621006                    EAX1    0,QL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:501  
        10 015257   200006 236100                    LDQ     X9,,AUTO
        10 015260   000012 402007                    MPY     10,DL
        10 015261   040006 100540                    MLR     fill='040'O
        10 015262   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 015263   001634 400010 0                  ADSC9   CODE09,Q                 cn=2,n=8

     2668    12064    4            CODE09.FFLG(X9)=FLAG;

  12064 10 015264   000006 100400                    MLR     fill='000'O
        10 015265   001107 000002 0                  ADSC9   FLAG                     cn=0,n=2
        10 015266   001634 000002 0                  ADSC9   CODE09,Q                 cn=0,n=2

     2669    12065    4            IF CODE09.ACCT(X9)='ALL' OR CODE09.ACCT(X9)='?'

  12065 10 015267   040000 106406                    CMPC    fill='040'O
        10 015270   001634 400010 0                  ADSC9   CODE09,Q                 cn=2,n=8
        10 015271   000612 000003 2                  ADSC9   FFLGS+99                 cn=0,n=3
        10 015272   015277 600000 10                 TZE     s:12066
        10 015273   040000 106406                    CMPC    fill='040'O
        10 015274   001634 400010 0                  ADSC9   CODE09,Q                 cn=2,n=8
        10 015275   000006 000001 11                 ADSC9   6                        cn=0,n=1
        10 015276   015317 601000 10                 TNZ     s:12069

     2670    12066    4            THEN IF NOT FLAG&%REMPRM THEN CODE14.DFLTALL=FLAG;

  12066 10 015277   000630 236000 2                  LDQ     FFLGS+113
        10 015300   001107 376000 0                  ANQ     FLAG
        10 015301   015305 601000 10                 TNZ     s:12067

  12066 10 015302   001107 220000 0                  LDX0    FLAG
        10 015303   001434 440000 0                  SXL0    CODE14
        10 015304   015432 710000 10                 TRA     s:12084

     2671    12067    4            ELSE CODE14.DFLTALL=CODE14.DFLTALL&(~FLAG);

  12067 10 015305   001107 236000 0                  LDQ     FLAG
        10 015306   000027 676000 xsym               ERQ     B_VECTNIL+23
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:502  
        10 015307   201346 756100                    STQ     BXP+1,,AUTO
        10 015310   001434 236000 0                  LDQ     CODE14
        10 015311   000022 736000                    QLS     18
        10 015312   201346 376100                    ANQ     BXP+1,,AUTO
        10 015313   000022 772000                    QRL     18
        10 015314   000000 620006                    EAX0    0,QL
        10 015315   001434 440000 0                  SXL0    CODE14
        10 015316   015432 710000 10                 TRA     s:12084

     2672    12068    5            ELSE DO;

     2673    12069    6               DO K=0 TO X9-1;

  12069 10 015317   201335 450100                    STZ     K,,AUTO
        10 015320   015423 710000 10                 TRA     s:12081+1

     2674    12070    7                  IF CODE09.ACCT(K)=CODE09.ACCT(X9) THEN DO;

  12070 10 015321   201335 236100                    LDQ     K,,AUTO
        10 015322   000012 402007                    MPY     10,DL
        10 015323   201346 756100                    STQ     BXP+1,,AUTO
        10 015324   200006 236100                    LDQ     X9,,AUTO
        10 015325   000012 402007                    MPY     10,DL
        10 015326   201346 235100                    LDA     BXP+1,,AUTO
        10 015327   040006 106405                    CMPC    fill='040'O
        10 015330   001634 400010 0                  ADSC9   CODE09,A                 cn=2,n=8
        10 015331   001634 400010 0                  ADSC9   CODE09,Q                 cn=2,n=8
        10 015332   015422 601000 10                 TNZ     s:12081

     2675    12071    7                     X9=X9-1;

  12071 10 015333   200006 235100                    LDA     X9,,AUTO
        10 015334   000001 135007                    SBLA    1,DL
        10 015335   200006 755100                    STA     X9,,AUTO

     2676    12072    7                     IF NOT FLAG&%REMPRM THEN CODE09.FFLG(K)=FLAG;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:503  
  12072 10 015336   000630 236000 2                  LDQ     FFLGS+113
        10 015337   001107 376000 0                  ANQ     FLAG
        10 015340   015347 601000 10                 TNZ     s:12073

  12072 10 015341   201335 236100                    LDQ     K,,AUTO
        10 015342   000012 402007                    MPY     10,DL
        10 015343   000006 100400                    MLR     fill='000'O
        10 015344   001107 000002 0                  ADSC9   FLAG                     cn=0,n=2
        10 015345   001634 000002 0                  ADSC9   CODE09,Q                 cn=0,n=2
        10 015346   015367 710000 10                 TRA     s:12074

     2677    12073    7                     ELSE CODE09.FFLG(K)=CODE09.FFLG(K)&(~FLAG);

  12073 10 015347   001107 236000 0                  LDQ     FLAG
        10 015350   000027 676000 xsym               ERQ     B_VECTNIL+23
        10 015351   201346 756100                    STQ     BXP+1,,AUTO
        10 015352   201335 236100                    LDQ     K,,AUTO
        10 015353   000012 402007                    MPY     10,DL
        10 015354   000100 100406                    MLR     fill='000'O
        10 015355   001634 000002 0                  ADSC9   CODE09,Q                 cn=0,n=2
        10 015356   201347 000004                    ADSC9   BXP+2,,AUTO              cn=0,n=4
        10 015357   201347 236100                    LDQ     BXP+2,,AUTO
        10 015360   201346 376100                    ANQ     BXP+1,,AUTO
        10 015361   201350 756100                    STQ     BXP+3,,AUTO
        10 015362   201335 236100                    LDQ     K,,AUTO
        10 015363   000012 402007                    MPY     10,DL
        10 015364   000006 100500                    MLR     fill='000'O
        10 015365   201350 000004                    ADSC9   BXP+3,,AUTO              cn=0,n=4
        10 015366   001634 000002 0                  ADSC9   CODE09,Q                 cn=0,n=2

     2678    12074    8                     IF FLAG&%REMACN THEN DO;

  12074 10 015367   000631 236000 2                  LDQ     FFLGS+114
        10 015370   001107 376000 0                  ANQ     FLAG
        10 015371   015422 600000 10                 TZE     s:12081

     2679    12075    8                        CODE09(K)=CODE09(K+1);
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:504  

  12075 10 015372   201335 236100                    LDQ     K,,AUTO
        10 015373   000012 402007                    MPY     10,DL
        10 015374   000006 100406                    MLR     fill='000'O
        10 015375   001636 400012 0                  ADSC9   CODE09+2,Q               cn=2,n=10
        10 015376   001634 000012 0                  ADSC9   CODE09,Q                 cn=0,n=10

     2680    12076    8                        CODE09(K+1)=CODE09(X9+1);

  12076 10 015377   200006 236100                    LDQ     X9,,AUTO
        10 015400   000012 402007                    MPY     10,DL
        10 015401   201346 756100                    STQ     BXP+1,,AUTO
        10 015402   201335 236100                    LDQ     K,,AUTO
        10 015403   000012 402007                    MPY     10,DL
        10 015404   201346 235100                    LDA     BXP+1,,AUTO
        10 015405   000006 100405                    MLR     fill='000'O
        10 015406   001636 400012 0                  ADSC9   CODE09+2,A               cn=2,n=10
        10 015407   001636 400012 0                  ADSC9   CODE09+2,Q               cn=2,n=10

     2681    12077    8                        IF K=X9 THEN X9=X9-2;

  12077 10 015410   201335 236100                    LDQ     K,,AUTO
        10 015411   015417 604000 10                 TMI     s:12078
        10 015412   200006 116100                    CMPQ    X9,,AUTO
        10 015413   015417 601000 10                 TNZ     s:12078

  12077 10 015414   200006 235100                    LDA     X9,,AUTO
        10 015415   000002 135007                    SBLA    2,DL
        10 015416   200006 755100                    STA     X9,,AUTO

     2682    12078    8                        X9=X9+1;

  12078 10 015417   200006 235100                    LDA     X9,,AUTO
        10 015420   000001 035007                    ADLA    1,DL
        10 015421   200006 755100                    STA     X9,,AUTO

     2683    12079    8                        END;
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:505  

     2684    12080    7                     END;

     2685    12081    6                  END;

  12081 10 015422   201335 054100                    AOS     K,,AUTO
        10 015423   201335 236100                    LDQ     K,,AUTO
        10 015424   015321 604000 10                 TMI     s:12070
        10 015425   200006 116100                    CMPQ    X9,,AUTO
        10 015426   015321 602000 10                 TNC     s:12070

     2686    12082    5               X9=X9+1;

  12082 10 015427   200006 235100                    LDA     X9,,AUTO
        10 015430   000001 035007                    ADLA    1,DL
        10 015431   200006 755100                    STA     X9,,AUTO

     2687    12083    5               END;

     2688    12084    4            J=J+1;

  12084 10 015432   001104 235000 0                  LDA     J
        10 015433   000001 035007                    ADLA    1,DL
        10 015434   001104 755000 0                  STA     J

     2689    12085    4            END;

  12085 10 015435   001103 470400 0                  LDP0    P$
        10 015436   000001 236100                    LDQ     1,,PR0
        10 015437   000022 772000                    QRL     18
        10 015440   001104 116000 0                  CMPQ    J
        10 015441   015443 600000 10                 TZE     s:12086
        10 015442   015246 603000 10                 TRC     s:12062

     2690    12086    3         FIT09.NDW=(X9*10+3)/4;

  12086 10 015443   200006 236100                    LDQ     X9,,AUTO
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:506  
        10 015444   000012 402007                    MPY     10,DL
        10 015445   000003 036007                    ADLQ    3,DL
        10 015446   000002 772000                    QRL     2
        10 015447   000012 736000                    QLS     10
        10 015450   001420 676000 0                  ERQ     FIT09
        10 015451   000132 376000 11                 ANQ     90
        10 015452   001420 656000 0                  ERSQ    FIT09

     2691    12087    3         FIT09.NAW=FIT09.NDW;

  12087 10 015453   001420 236000 0                  LDQ     FIT09
        10 015454   000132 376000 11                 ANQ     90
        10 015455   000012 736000                    QLS     10
        10 015456   001420 676000 0                  ERQ     FIT09
        10 015457   017774 376003                    ANQ     8188,DU
        10 015460   001420 656000 0                  ERSQ    FIT09

     2692    12088    3      END;

     2693    12089    2      RETURN;

  12089 10 015461   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 015462   000001 702211                    TSX2  ! 1,X1

  12086 10 015463                       RETALT       null
     2694    12090    2   RETALT:;
     2695    12091    2      OUT$BLK.SUBLK$(I)=P$->OUT$BLK.SUBLK$(J);

  12091 10 015463   001103 470400 0                  LDP0    P$
        10 015464   001104 720000 0                  LXL0    J
        10 015465   000003 236110                    LDQ     3,X0,PR0
        10 015466   001073 471400 0                  LDP1    BLK$
        10 015467   001076 721000 0                  LXL1    I
        10 015470   100003 756111                    STQ     3,X1,PR1

     2696    12092    2      ALTRETURN;

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:507  
  12092 10 015471   201334 221300                    LDX1  ! DEFAULT_BUILD+724,,AUTO
        10 015472   000000 702211                    TSX2  ! 0,X1

     2697    12093    2   END;
     2698    12094    1   END;

  12094 10 015473   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:508  
--  Include file information  --

   AS_SUPER_C.:E05TOU  is referenced.
   FX_SUBS_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   FX$CAT.:E05TOU  is referenced.
   FX_PERR_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXP$MAIN.
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:509  

 **** Variables and constants ****

  ****  Section 000  Data  FXP$MAIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   706-0-0/c STRC(2304)  r     1 AVR                     1126-0-0/w UBIN        r     1 BANNERSZ
  1073-0-0/w PTR         r     1 BLK$                    1125-0-0/w UBIN        r     1 BREAK
   230-0-0/d STRC(1080)  r     1 CLOSE1                   172-0-0/d STRC(1080)  r     1 CLSDP
  1421-0-0/w STRC(396)   r     1 CODE04                  1634-0-0/c STRC(90)    r     1 CODE09(0:199)
  1434-0-0/w STRC(4608)  r     1 CODE14                   702-0-0/d STRC(144)   r     1 CORR
  4621-0-0/w STRC(36864) r     1 CSTAT                   6702-0-0/c STRC(1080)  r     1 DBUF
  1152-0-0/d STRC(432)   r     1 DEFERFPT                1166-0-0/w STRC(288)   r     1 DEFERST
   640-0-0/d STRC(144)   r     1 DIAGFPT                 1110-0-0/b BIT (72)    r     1 DPERX
   320-0-0/d STRC(936)   r     1 EFPT                    1074-0-0/b BIT         r     1 ERRCODE
  6621-0-0/c STRC(414)   r     1 ERRSYN                   352-0-0/d STRC(144)   r     1 EVLR
  2621-0-0/w STRC(36864) r     1 FIT                     1415-0-0/b STRC        r     1 FIT00
  1416-0-0/b STRC        r     1 FIT04                   1420-0-0/b STRC        r     1 FIT09
  1417-0-0/b STRC        r     1 FIT14                   2620-0-0/w UBIN        r     1 FITSIZE
  1107-0-0/b STRC        r     1 FLAG                     434-0-0/d STRC(144)   r     1 FPT_INT
   656-0-0/d STRC(720)   r     1 FPT_LDEV                1032-0-0/d STRC(504)   r     1 FPT_READ
   644-0-0/d STRC(360)   r     1 FPT_TRAP                 706-0-0/c STRC(2304)  r     1 GBUF
  1270-0-0/w STRC(180)   r     1 GPBUF                   1113-0-0/w SBIN        r     1 GRANULE
  1076-0-0/w UBIN        r     1 I                       1077-0-0/w UBIN        r     1 I0
  1104-0-0/w UBIN        r     1 J                       6702-0-0/c STRC(1080)  r     1 LBUF
  6702-0-0/c CHAR(120)   r     1 LBUFC                   6655-0-0/c STRC(297)   r     1 LISTH1
  1105-0-0/b BIT         r     1 LIST_ATTR               1050-0-0/d STRC(432)   r     1 LOFPT
  1122-0-0/w PTR         r     1 M$LO$                   1123-0-0/w PTR         r     1 M$SI$
  1275-0-0/w STRC(2700)  r     1 MADBUF                   406-0-0/d STRC(288)   r     1 MADM
  1121-0-0/w UBIN        r     1 MODE                    1112-0-0/w UBIN        r     1 NUMSNS
   356-0-0/d STRC(432)   r     1 OCMSG                    100-0-0/d STRC(2088)  r     1 OPNDP
   532-0-0/d STRC(2088)  r     1 OPNFIL                    72-0-0/d STRC(90)    r     1 OPNSN
   440-0-0/d STRC(2088)  r     1 OPNXTA                  1103-0-0/w PTR         r     1 P$
  1410-0-0/w STRC(180)   r     1 PADBUF                   634-0-0/d STRC(144)   r     1 PRIVFPT
  1127-0-0/c STRC(243)   r     1 PROJAD                  1014-0-0/w STRC(504)   r     1 P_PCB
   266-0-0/d STRC(504)   r     1 READCAT                  416-0-0/d STRC(504)   r     1 READVID
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:510  
  1176-0-0/d STRC(2088)  r     1 RELPIGFIL               1006-0-0/c CHAR(8)     r     1 SELACCT
   706-0-0/c CHAR(256)   r     1 TCXT                     706-0-0/c CHAR        r     1 TEXT(0:255)
  6702-0-0/c STRC(1080)  r     1 TIMETEXT                1075-0-0/w UBIN        r     1 TIMEUTS
  1102-0-0/w SBIN        r     1 TRAPCNT                 1100-0-0/b BIT (72)    r     1 TRAPX
  1117-0-0/c CHAR(8)     r     1 USER_ACCN               1114-0-0/c CHAR(12)    r     1 USER_NAME
  1010-0-0/b BIT         r     1 USW                     6635-0-0/c STRC(558)   r     1 VALMSG
  4621-0-0/w STRC(36864) r     1 VID1                    2621-0-0/w STRC(36864) r     1 VIDBUF
    76-0-0/c STRC(72)    r     1 VLP_ACCT                 624-0-0/c STRC(288)   r     1 VLP_NAME
  2621-0-0/w UBIN        r     1 WBUF(0:1023)            1124-0-0/w UBIN        r     1 WIDTH
  1064-0-0/d STRC(216)   r     1 WORKFPT                 1012-0-0/d STRC(72)    r     1 WORK_
   372-0-0/d STRC(432)   r     1 WRAVR                    304-0-0/d STRC(432)   r     1 WRITECAT
  6666-0-0/w STRC(432)   r     1 WROC                    1136-0-0/d STRC(432)   r     1 WRSUPER
     0-0-0/d STRC(2052)  r     1 XUH                     1106-0-0/b BIT         r     1 ZAP

  ****  Section 002 RoData FXP$MAIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT (18)    r     1 CATKEY                   160-0-0/d STRC(288)   r     1 DEQPROJ
   315-0-0/c CHAR(43)    r     1 ERRDUBDEF                441-0-0/c CHAR(21)    r     1 ERRSI
   227-0-0/b BIT (72)    r     1 ERRVEC(0:19)             401-0-0/c CHAR(8)     r     1 FFLGC(0:15)
   361-0-0/b BIT         r     1 FFLGS(0:15)              447-0-0/b BIT         r     1 FFLGS(0:19)
    40-0-0/b STRC        r     1 FMN$E$NOTAUTH             41-0-0/b STRC        r     1 FMN$E$XCLSET
   140-0-0/d STRC(360)   r     1 FPT_PROMPT                20-0-0/d STRC(216)   r     1 FPT_XCON
    36-0-0/b STRC        r     1 FXP$E$2RECON              50-0-0/b STRC        r     1 FXP$E$BIGSECT
    46-0-0/b STRC        r     1 FXP$E$DEFER               37-0-0/b STRC        r     1 FXP$E$DUPVSN
    42-0-0/b STRC        r     1 FXP$E$NEEDSCR             47-0-0/b STRC        r     1 FXP$E$NLIST
    35-0-0/b STRC        r     1 FXP$E$NOVOL               43-0-0/b STRC        r     1 FXP$E$PROJCMD
    45-0-0/b STRC        r     1 FXP$E$PROJDFT             44-0-0/b STRC        r     1 FXP$E$PROJPSN
    34-0-0/b STRC        r     1 FXP$E$VOLDOWN            226-0-0/b BIT         r     1 ITEMXMASK
   353-0-0/c CHAR(24)    r     1 LBUF0                    330-0-0/c CHAR(76)    r     1 LISTH2
     2-0-0/d STRC(72)    r     1 MERCER                   311-0-0/c CHAR(15)    r     1 NONEMSG
     4-0-0/w STRC(288)   r     1 PIGST                     14-0-0/d STRC(144)   r     1 PPRIVFPT
   153-0-0/c CHAR(16)    r     1 PROJADC
   153-0-0/b UBIN(9)     r     1 PROJADCU(0:15)
   152-0-0/c CHAR(2)     r     1 PRTXT                    170-0-0/d STRC(1080)  r     1 RELPIGCG
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:511  
    52-0-0/d STRC(144)   r     1 SETSAD                   132-0-0/w PTR         r     1 TIME$(0:4)
    56-0-0/d STRC(432)   r     1 TIMEFPT                  106-0-0/c CHAR(16)    r     1 TIMES(0:4)
    72-0-0/d STRC(432)   r     1 TIME_TEXT                277-0-0/c CHAR(37)    r     1 UNCMD
    26-0-0/d STRC(216)   r     1 WAIT1

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1341-0-0/w PTR         r     1 @I                      1335-0-0/w PTR         r     1 @L
     3-0-0/w PTR         r     1 @PARM                   1336-0-0/w PTR         r     1 @TEXT
  1342-0-0/w UBIN        r     1 AX                      1343-0-0/w UBIN        r     1 AXP
  1343-0-0/w PTR         r     1 AXP$                    1344-0-0/w UBIN        r     1 BX
  1344-0-0/w BIT         r     1 BXB                     1345-0-0/w UBIN        r     1 BXP
     7-0-0/w UBIN        r     1 CODE
    10-0-0/w UBIN        r     1 DEFAULT_BUILD(0:722)
    *0-0-0/w SBIN        r     1 I                       1335-0-0/w SBIN        r     1 K
    *0-0-0/w UBIN        r     1 L                       1337-0-0/w PTR         r     1 P$
    *0-0-0/w STRC(72)    r     1 PARM                       4-0-0/b BIT (72)    r     1 SAVUNW
    *0-0-0/c ACHR        r     1 TEXT                    1342-0-0/w CHAR(4)     r     1 WILD_XC
     6-0-0/w UBIN        r     1 X9

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c CHAR        r     1 B_VERSION                  0-0-0/w PTR         r     1 F$CFU$
     0-0-0/w UBIN        r     1 FXN$CMD
     0-0-0/w PTR         r     1 FX_MSG$(0:0)
     0-0-0/w SBIN        r     1 GAC                        0-0-0/w PTR         r     1 M$DP$
     0-0-0/c STRC(90)    r     1 RCNSN                      0-0-0/b BIT (72)    r     1 XCONWIND

  ****  BASED and DCB variables  ****

PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:512  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ASTR(9)     r     1 B$VERSIONB
     0-0-0/w UBIN        r     1 BASED_UBIN                 0-0-0/c CHAR        r     1 CHAR1
     0-0-0/c CHAR(4)     r     1 CHAR4                      0-0-0/c CHAR(120)   r     1 CHARS
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/c ASTR(0)     r     1 FITMOVER
     0-0-0/w STRC(288)   r     1 FM$CFUX                    0-0-0/w STRC(288)   r     1 FM$DEV(0:0)
     0-0-0/w STRC(180)   r     1 FM$GRAN                    0-0-0/w STRC(288)   r     1 FM$SET(0:0)
     0-0-0/w STRC(288)   r     1 FM$SETU                    0-0-0/w STRC(288)   r     1 FM$VOL(0:0)
     0-0-0N  NULL        r     1 M$CAT                      0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$DP                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$PIGCG                    0-0-0N  NULL        r     1 M$PROJ
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(504)   r     1 P$PCB                      0-0-0/w STRC(63)    r     1 P_TO_S
     0-0-0/w STRC(288)   r     1 ST                         0-0-0/w ASTR(522)   r     1 S_TO_P
     0-0-0/c ASTR(9)     r     1 THING                      0-0-0/c CHAR(12)    r     1 V


   Procedure FXP$MAIN requires 6972 words for executable code.
   Procedure FXP$MAIN requires 766 words of local(AUTO) storage.
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:513  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:514  
          MINI XREF LISTING

AARGH IN PROCEDURE ERROR
     11415**LABEL   11422--CALLALT
ACCTERR IN PROCEDURE ERROR
     11559**LABEL   11458--GOTO    11556--CALLALT
ACCTLTXT IN PROCEDURE ERROR
     11562**ENTRY   10529--CALL    10562--CALL
ACCTNXT
     10445**LABEL   10612--GOTO    11025--GOTO
ADDPARAM IN PROCEDURE ADDPART
     11808**ENTRY   10134--CALL    10145--CALL    10147--CALL    10156--CALL    10165--CALL    10169--CALL
     10174--CALL    10183--CALL    10219--CALL    10228--CALL    10232--CALL    10251--CALL    10264--CALL
     10538--CALL    10539--CALL    10548--CALL    10549--CALL    10550--CALL    10551--CALL    10552--CALL
     10553--CALL    10554--CALL    10555--CALL    10556--CALL    11030--CALL    11264--CALL
ADDPARM IN PROCEDURE ADDPART
     11812**LABEL   11798--GOTO
ADDPARNUM IN PROCEDURE ADDPART
     11800**ENTRY   10123--CALL    10133--CALL    10150--CALL    10177--CALL    10222--CALL    10244--CALL
     10250--CALL    10263--CALL    10544--CALL    10547--CALL    10558--CALL    11268--CALL    11720--CALL
ADDPART
     11786**PROC    10135--CALL    10137--CALL    10138--CALL    10139--CALL    10171--CALL    10216--CALL
     10531--CALL    10568--CALL    10573--CALL    10577--CALL    10585--CALL    10587--CALL    10593--CALL
     10938--CALL    10940--CALL    10942--CALL    10944--CALL    11029--CALL    11031--CALL    11261--CALL
ALRDYSCRCH
     10391**LABEL   10332--GOTO
AVR.MSG
      8012**DCL      7351--DCLINIT  7352--DCLINIT
AVR0
     10014**LABEL   10040--GOTO
AVRERR
     10036**LABEL   10015--CALLALT
AX IN PROCEDURE ERROR
     11335**DCL     11336--REDEF   11386<<ASSIGN  11387>>CALLBLT 11387>>CALLBLT 11389>>ASSIGN  11437<>CALL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:515  
     11442<<CALLBLT 11444>>CALLBLT 11445>>IF      11491>>IF      11492<<ASSIGN  11505<<ASSIGN  11513>>DOWHILE
     11513>>DOWHILE 11515>>IF      11515>>IF      11516>>ASSIGN  11519>>IF      11520>>IF      11520>>IF
     11526<<ASSIGN  11537>>IF      11537<<ASSIGN  11537>>ASSIGN  11584<<DOINDEX 11585>>ASSIGN  11586>>ASSIGN
     11587>>ASSIGN  11588>>DOCASE
AXP IN PROCEDURE ERROR
     11337**DCL     11338--REDEF   11493<<ASSIGN  11506<<ASSIGN  11516<<ASSIGN  11519>>IF      11524>>IF
     11526>>ASSIGN  11548>>IF
AXP$ IN PROCEDURE ERROR
     11338**DCL     11587<<ASSIGN  11590>>ASSIGN  11595>>ASSIGN  11598>>ASSIGN
B$ALT.CODE
      3622**DCL      3622--REDEF    3623--REDEF    3623--REDEF
B$ALT.DCB#
      3623**DCL     11679>>IF
B$ALT.ERR
      3623**DCL     11095>>ASSIGN  11307>>ASSIGN  11457>>ASSIGN  11641>>ASSIGN  11699>>ASSIGN  11768>>ASSIGN
     11781>>ASSIGN  11867>>ASSIGN
B$ALT.ERR.CODE
      3624**DCL     10040>>IF      10041>>IF      10801>>IF      11543>>IF      11693>>IF
B$ALT.ERR.ERR#
      3624**DCL      3624--REDEF
B$ALT.EVID
      3623**DCL      3623--REDEF    3623--REDEF
B$JIT.ACCN
      3361**DCL      9682>>ASSIGN   9692>>ASSIGN  10725>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      3455**DCL      3455--REDEF
B$JIT.ERR.MID
      3362**DCL      3362--REDEF
B$JIT.MODE
      3356**DCL     10856>>IF
B$JIT.NEXTCC
      3503**DCL     10397>>IF
B$JIT.PPRIV.PADMIN
      3419**DCL      9689>>IF
B$JIT.PPRIV.PIGC
      3418**DCL     11606>>IF
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:516  
B$JIT.PPRIV.PIGD
      3418**DCL     10503>>IF      11005>>IF      11105>>IF      11609>>IF      11611>>IF
B$JIT.PRIV.ACTIVE
      3362**DCL     11610>>ASSIGN
B$JIT.PRIV.ACTIVE.FMDIAG
      3363**DCL     11607>>IF      11611>>IF
B$JIT.PRIV.ACTIVE.SPCLMM
      3366**DCL     10675>>IF      10817>>IF
B$JIT.PRIV.AUTH.FMDIAG
      3402**DCL     11123>>IF
B$JIT.PRIV.JOB.FMDIAG
      3406**DCL     11149>>IF
B$JIT.UNAME
      3361**DCL      9681>>ASSIGN   9691>>ASSIGN  10724>>ASSIGN
B$JIT.USER
      3361**DCL      9689>>IF       9707>>IF       9729>>IF
B$JIT$
      3535**DCL      3356--IMP-PTR  9681>>ASSIGN   9682>>ASSIGN   9689>>IF       9689>>IF       9691>>ASSIGN
      9692>>ASSIGN   9707>>IF       9729>>IF      10397>>IF      10503>>IF      10675>>IF      10724>>ASSIGN
     10725>>ASSIGN  10817>>IF      10856>>IF      11005>>IF      11105>>IF      11123>>IF      11149>>IF
     11606>>IF      11607>>IF      11609>>IF      11610>>ASSIGN  11611>>IF      11611>>IF
B$TCB.ALT$
      3618**DCL     10040>>IF      10041>>IF      10801>>IF      11095>>ASSIGN  11307>>ASSIGN  11457>>ASSIGN
     11543>>IF      11641>>ASSIGN  11679>>IF      11693>>IF      11699>>ASSIGN  11768>>ASSIGN  11781>>ASSIGN
     11867>>ASSIGN
B$TCB$
      3628**DCL      3618--IMP-PTR 10040>>IF      10041>>IF      10801>>IF      11095>>ASSIGN  11307>>ASSIGN
     11457>>ASSIGN  11543>>IF      11641>>ASSIGN  11679>>IF      11693>>IF      11699>>ASSIGN  11768>>ASSIGN
     11781>>ASSIGN  11867>>ASSIGN
B$VERSIONB.C_
      9677**DCL      9678--IMP-SIZ  9688>>CALLBLT
B$VERSIONB.T_
      9678**DCL      9688>>CALLBLT
BANNERSZ
      8488**DCL      9795>>IF       9798<<ASSIGN  10006>>IF      11375<<ASSIGN
BASED_UBIN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:517  
      8451**DCL     10599>>ASSIGN  11132<<CALLBLT 11261<>CALL    11267<<ASSIGN  11267>>ASSIGN  11446<<ASSIGN
     11446>>ASSIGN  11703>>ASSIGN
BIGSECT
     10373**LABEL   10360--GOTO
BLK$
      8454**DCL      8323--IMP-PTR  8369--IMP-PTR  8449--IMP-PTR  9157--IMP-PTR  9189--IMP-PTR  9716>>IF
      9718>>ASSIGN   9719>>ASSIGN   9731<<ASSIGN   9732>>ASSIGN   9733>>ASSIGN   9733>>ASSIGN   9734>>ASSIGN
      9735>>ASSIGN   9735>>ASSIGN   9736>>ASSIGN   9736>>ASSIGN   9737>>ASSIGN   9737>>ASSIGN   9738>>ASSIGN
      9739>>ASSIGN   9786<<ASSIGN   9787>>ASSIGN   9833>>IF       9834<<ASSIGN   9834>>ASSIGN   9835>>IF
      9837>>ASSIGN   9838>>IF       9842>>IF       9843>>IF       9843<<ASSIGN   9843>>ASSIGN   9844>>IF
      9845>>IF       9845<<ASSIGN   9846>>ASSIGN   9849>>ASSIGN   9856<<ASSIGN   9861<<ASSIGN   9862>>ASSIGN
      9863>>ASSIGN   9863>>ASSIGN   9864>>ASSIGN   9865>>ASSIGN   9869>>ASSIGN   9870>>ASSIGN   9872>>ASSIGN
      9873>>ASSIGN   9875>>ASSIGN   9877>>ASSIGN   9878>>IF       9878>>IF       9879>>ASSIGN   9879>>ASSIGN
      9880>>ASSIGN   9899>>ASSIGN   9909<<ASSIGN   9909>>ASSIGN   9914>>ASSIGN   9915>>ASSIGN   9915>>ASSIGN
      9918>>ASSIGN   9918>>ASSIGN   9918>>ASSIGN   9918>>ASSIGN   9920>>IF       9925>>ASSIGN   9926>>ASSIGN
      9927>>IF       9928>>ASSIGN   9929>>ASSIGN   9931<<ASSIGN   9933>>ASSIGN   9933>>ASSIGN   9934>>ASSIGN
      9935>>ASSIGN   9936>>DOCASE   9938>>ASSIGN   9940>>ASSIGN   9942>>ASSIGN   9944>>ASSIGN   9945>>ASSIGN
      9947>>ASSIGN   9949>>ASSIGN   9950>>ASSIGN   9973>>IF       9974>>IF       9975>>ASSIGN   9975>>ASSIGN
      9982>>ASSIGN   9983>>ASSIGN  10050>>IF      10050>>ASSIGN  10050>>ASSIGN  10052>>IF      10056>>ASSIGN
     10060>>IF      10283>>DOWHILE 10284>>ASSIGN  10287>>CALLBLT 10287>>CALLBLT 10438>>IF      10444>>ASSIGN
     10444>>ASSIGN  10453>>IF      10469>>DOWHILE 10506>>IF      10507>>ASSIGN  10507>>ASSIGN  10611>>IF
     10616>>IF      10629>>ASSIGN  10629>>ASSIGN  10648>>IF      10649>>IF      10661>>DOWHILE 10662>>IF
     10668>>DOWHILE 10743>>CALLBLT 10743>>CALLBLT 10745>>IF      10746>>IF      10747>>ASSIGN  10747>>ASSIGN
     10788>>DOWHILE 10841>>IF      10841>>ASSIGN  10905>>IF      10905>>ASSIGN  10922>>ASSIGN  10925>>IF
     10931>>IF      10932>>ASSIGN  10950>>DOWHILE 11009>>IF      11010>>IF      11011>>ASSIGN  11011>>ASSIGN
     11012>>ASSIGN  11012>>ASSIGN  11064>>IF      11064>>ASSIGN  11064>>ASSIGN  11065>>ASSIGN  11066>>ASSIGN
     11066>>ASSIGN  11082>>IF      11082>>IF      11083>>IF      11083>>IF      11128>>IF      11129>>CALLBLT
     11129>>CALLBLT 11132>>CALLBLT 11132>>CALLBLT 11134>>IF      11134>>CALLBLT 11134>>CALLBLT 11139>>DOWHILE
     11140>>IF      11141>>ASSIGN  11142>>ASSIGN  11142>>ASSIGN  11144>>ASSIGN  11145>>IF      11146>>ASSIGN
     11146>>ASSIGN  11180>>IF      11181>>ASSIGN  11181>>ASSIGN  11182>>ASSIGN  11182>>ASSIGN  11196>>ASSIGN
     11197>>ASSIGN  11276<<ASSIGN  11286>>ASSIGN  11286>>ASSIGN  11297>>DOWHILE 11383>>IF      11384<<ASSIGN
     11385>>IF      11385>>ASSIGN  11387>>CALLBLT 11387>>CALLBLT 11389>>ASSIGN  11389>>ASSIGN  11390>>ASSIGN
     11391>>ASSIGN  11392>>ASSIGN  11624>>IF      11625>>IF      11630>>ASSIGN  11632>>ASSIGN  11757>>ASSIGN
     11915>>ASSIGN  11950>>CALLBLT 11950>>CALLBLT 11975>>CALLBLT 11975>>CALLBLT 12091>>ASSIGN
BREAK
      8487**DCL      9962<<ASSIGN  10458>>IF      10614>>IF      10617<<ASSIGN  11015>>IF      11043>>IF
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:518  
     11048>>IF      11080>>IF      11174>>IF      11464>>IF      11727>>IF      11736>>IF      11858<<ASSIGN
     11870>>IF      11872<<ASSIGN  11893<<ASSIGN
BX IN PROCEDURE ERROR
     11339**DCL     11340--REDEF   11508<<ASSIGN  11513>>DOWHILE 11513>>DOWHILE 11519>>ASSIGN  11520>>IF
     11520>>IF      11530<<ASSIGN  11535<<ASSIGN  11535>>ASSIGN
BXB IN PROCEDURE ERROR
     11340**DCL     11585<<ASSIGN  11594>>ASSIGN  11597>>ASSIGN
BXP IN PROCEDURE ERROR
     11341**DCL     11509<<ASSIGN  11519<<ASSIGN  11524>>IF      11530>>ASSIGN
B_VERSION
      9675**DCL      9688--CALLBLT  9688--CALLBLT
CATERR
     11112**LABEL   11103--CALLALT 11109--CALLALT
CATKEY
      7239**DCL      7186--DCLINIT  7187--DCLINIT  7225--DCLINIT
CATREAD IN PROCEDURE ERROR
     11421**ENTRY    9730--CALL     9801--CALL     9904--CALL     9910--CALL    10831--CALL    10894--CALL
     10930--CALL    11879--CALL
CATWRITE IN PROCEDURE ERROR
     11428**ENTRY    9781--CALL     9893--CALL    10853--CALL    10874--CALL    10899--CALL    10934--CALL
     11674--CALL    11682--CALL    11845--CALL
CHAR1
      8449**DCL      9787<<ASSIGN   9833>>IF       9837<<ASSIGN   9838>>IF       9843>>IF       9844>>IF
      9846<<ASSIGN  11718>>CALLBLT
CHAR4
      8450**DCL      9825<<CALLBLT 10086>>CALLBLT 10311>>ASSIGN  10683>>ASSIGN  10692>>ASSIGN  10757>>ASSIGN
     10799>>ASSIGN  11241>>ASSIGN  11321>>CALLBLT 11321>>CALLBLT 11328>>IF      11719<<CALLBLT 11733>>IF
     11734<<ASSIGN  11857>>CALLBLT
CHARS IN PROCEDURE ERROR
     11342**DCL     11352>>ASSIGN  11361>>DOWHILE 11387<<CALLBLT 11387>>CALLBLT
CLOSE IN PROCEDURE ERROR
     11432**ENTRY    9710--CALL     9860--CALL    10005--CALL    10090--CALL    10321--CALL    10354--CALL
     10393--CALL    10396--CALL    10485--CALL    10666--CALL    10738--CALL    10791--CALL    10810--CALL
     10867--CALL    10973--CALL    11075--CALL    11246--CALL    11250--CALL    11778--CALL    11873--CALL
CLOSE1
      7150**DCL     11434<>CALL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:519  
CLOSE1.SN_
      7150**DCL      7150--REDEF
CLOSE1.UTL_
      7151**DCL      7151--REDEF
CLOSE1.V
      7155**DCL      7150--DCLINIT
CLOSE1.V.DCB#
      7156**DCL     11433<<ASSIGN
CLOSE1.V.EXPIRE#
      7165**DCL      7165--REDEF
CLOSE1.V.TYPE#
      7163**DCL      7163--REDEF
CLOSE1.V.XTNSIZE#
      7160**DCL      7160--REDEF    7162--REDEF
CLSDP
      7108**DCL      9747<>CALL    10019<>CALL    10622<>CALL    10705<>CALL    10787<>CALL    10825<>CALL
     10872<>CALL    10907<>CALL    10979<>CALL    10991<>CALL    11172<>CALL    11245<>CALL    11249<>CALL
     11743<>CALL
CLSDP.SN_
      7108**DCL      7108--REDEF
CLSDP.UTL_
      7109**DCL      7109--REDEF
CLSDP.V
      7113**DCL      7108--DCLINIT
CLSDP.V.DISP#
      7117**DCL      9976<<ASSIGN  10704<<ASSIGN  10786<<ASSIGN  10871<<ASSIGN  10875>>IF      10904<<ASSIGN
     10905<<ASSIGN  11171<<ASSIGN  11742<<ASSIGN
CLSDP.V.EXPIRE#
      7123**DCL      7123--REDEF
CLSDP.V.TYPE#
      7121**DCL      7121--REDEF
CLSDP.V.XTNSIZE#
      7118**DCL      7118--REDEF    7120--REDEF
CMDABORT
     11742**LABEL   10458--GOTO    10634--CALLALT 11048--GOTO    11068--CALLALT
CMDERR
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:520  
     11688**LABEL    9985--CALLALT
CODE
      8479**DCL      9803<<ASSIGN   9967<<ASSIGN   9982<<ASSIGN   9983>>IF       9983<<ASSIGN   9985>>CALLBLT
      9994>>DOCASE  10010<<ASSIGN  10054<<ASSIGN  10191>>IF      10193>>IF      10195>>IF      10238>>IF
     10242>>IF      10249>>IF      10266>>IF      10267>>IF      10459>>IF      10463>>IF      10532>>IF
     10534<<ASSIGN  10534>>ASSIGN  10610>>IF      10612>>IF      10771>>IF      10840>>IF      10876>>IF
     10878<<ASSIGN  10882>>IF      10908<<ASSIGN  10961>>IF      11024>>IF      11025>>IF      11043>>IF
     11043>>IF      11065<<ASSIGN  11066>>IF      11067>>IF      11081>>IF      11083>>IF      11103<>CALL
     11137<<ASSIGN  11144<<ASSIGN  11155>>DOCASE  11158>>IF      11158<<ASSIGN  11163<<ASSIGN  11165<<ASSIGN
     11170<>CALL    11397>>ASSIGN  11445>>IF      11462>>IF      11543>>IF      11556<>CALL    11638<<ASSIGN
     11732>>IF      11732>>IF      11748>>IF      11850>>IF      11885<<ASSIGN
CODE04
      9538**DCL     10717--ASSIGN  11590<<ASSIGN
CODE04.ACCESS
      9540**DCL      7964--DCLINIT 11591>>IF      11591<<ASSIGN
CODE04.CREATION
      9540**DCL      7965--DCLINIT 11591>>IF      11592>>IF
CODE04.CREATION.TIME
      9540**DCL     10727<<ASSIGN
CODE04.CREATOR.ACCT
      9540**DCL     10602>>IF      10603>>CALLBLT 10725<<ASSIGN
CODE04.CREATOR.NAME
      9540**DCL     10605>>CALLBLT 10724<<ASSIGN
CODE04.GAC.TIME
      9541**DCL      7964--DCLINIT
CODE04.SVMODIFY
      9541**DCL      7964--DCLINIT 11592>>IF      11592<<ASSIGN
CODE04.UPD
      9540**DCL      7965--DCLINIT
CODE09
      9571**DCL     10731>>ASSIGN  11595--ASSIGN  12062--IF      12062--IF      12075<<ASSIGN  12075>>ASSIGN
     12076<<ASSIGN  12076>>ASSIGN
CODE09.ACCT
      9573**DCL     10564>>CALLBLT 10569>>CALLBLT 10576>>CALLBLT 12063<<ASSIGN  12065>>IF      12065>>IF
     12070>>IF      12070>>IF
CODE09.FFLG
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:521  
      9572**DCL     10561>>ASSIGN  10563>>IF      10563>>IF      10565>>DOWHILE 10565>>DOWHILE 12064<<ASSIGN
     12072<<ASSIGN  12073<<ASSIGN  12073>>ASSIGN
CODE14
      9564**DCL     10465--ASSIGN  11598<<ASSIGN  12043--ASSIGN
CODE14.ACCESS.BUPF
      9566**DCL     10549>>IF      11986<<ASSIGN  11993<<ASSIGN
CODE14.ACCESS.BUPM
      9566**DCL     10550>>IF      11985<<ASSIGN  11994<<ASSIGN
CODE14.ACCESS.GACSHELF
      9567**DCL     10539>>IF      12022<<ASSIGN
CODE14.ACCESS.LIST
      9566**DCL     10560>>IF      10719<<ASSIGN  10954<<ASSIGN  11303<<ASSIGN
CODE14.ACCESS.MERGEAC
      9567**DCL     10556>>IF      12036<<ASSIGN
CODE14.ACCESS.NEWFD
      9567**DCL     10538>>IF      11942<<ASSIGN
CODE14.ACCESS.NOACUP
      9566**DCL     10551>>IF      12008<<ASSIGN
CODE14.ACCESS.NOSTOW
      9566**DCL     10553>>IF      12015<<ASSIGN
CODE14.ACCESS.NPUR
      9566**DCL     10552>>IF      12001<<ASSIGN
CODE14.ACCESS.OWNERF
      9566**DCL     10548>>IF      11967<<ASSIGN
CODE14.ACCESS.WCDATA
      9566**DCL     10555>>IF      12029<<ASSIGN
CODE14.ACCESS.WRCMP
      9566**DCL     10554>>IF      11960<<ASSIGN
CODE14.CGMEM
      9567**DCL     10557>>ASSIGN  11952<<ASSIGN  11953>>IF
CODE14.CGRANS
      9569**DCL     10516>>IF      10517>>CALLBLT 10519>>IF      10543>>ASSIGN  10544>>IF      10634>>IF
     10634<>CALL
CODE14.DFLTALL
      9567**DCL     10528>>ASSIGN  12066<<ASSIGN  12067<<ASSIGN  12067>>ASSIGN
CODE14.MGRANS
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:522  
      9569**DCL     10475>>ASSIGN  10523>>IF      10524>>CALLBLT 10546>>ASSIGN  11976<<ASSIGN  11977>>IF
CODE14.OWNER
      9569**DCL     10465--ASSIGN  10465--ASSIGN  10580--ASSIGN  12039--IF      12039--IF      12043--ASSIGN
     12043--ASSIGN
CODE14.OWNER.ACCT
      9569**DCL     10466<<ASSIGN  10581>>IF      10582>>CALLBLT 10586>>CALLBLT 12040<<ASSIGN
CODE14.OWNER.NAME
      9569**DCL     10588>>CALLBLT 12041<<ASSIGN
CONTINUE
      9788**LABEL    9782--GOTO     9842--GOTO     9847--GOTO
CORR
      7834**DCL     11344<>CALL    11346<>CALL    11377<>CALL
CORR.V
      7834**DCL      7834--DCLINIT
CORR.V.DCB2#
      7835**DCL     11343<<ASSIGN  11345<<ASSIGN  11376<<ASSIGN
CROPEN
     10692**LABEL   10689--GOTO
CSTAT
      9593**DCL      7188--DCLINIT  7189--DCLINIT  7226--DCLINIT  7227--DCLINIT  9596--REDEF   10450>>ASSIGN
     10512>>ASSIGN  11305<<ASSIGN  11424--ASSIGN  11429--ASSIGN
CSTAT.DEFMOUNT
      9593**DCL     10036>>IF      10840>>ASSIGN  10932<<ASSIGN  10933>>IF      10933<<ASSIGN  10936>>DOCASE
CSTAT.NUM
      9593**DCL      9759<<ASSIGN   9770>>DOINDEX  9804>>DOINDEX  9891<<ASSIGN   9919>>DOINDEX 10028>>DOINDEX
     10832>>DOINDEX 10836<<ASSIGN  10836>>ASSIGN  10847>>ASSIGN  10848>>ASSIGN  10849<<ASSIGN  10895>>DOINDEX
     10897>>ASSIGN  10898<<ASSIGN  10898>>ASSIGN  11424<<ASSIGN  11426>>IF      11426<<ASSIGN  11429>>ASSIGN
     11658>>DOINDEX 11880>>DOINDEX
CSTAT.SETS
      9593**DCL     10837<<ASSIGN  10847<<ASSIGN  10847>>ASSIGN  10897<<ASSIGN  10897>>ASSIGN  11424--ASSIGN
     11424--ASSIGN  11429--ASSIGN
CSTAT.SETS.DISP
      9593**DCL      9775>>ASSIGN   9920>>IF      10839<<ASSIGN  10840<<ASSIGN  10841<<ASSIGN  10846>>IF
     10850<<ASSIGN  10862>>IF      10864>>IF      10871>>ASSIGN
CSTAT.SETS.PSN
      9593**DCL      9776>>ASSIGN   9920>>IF      10029>>IF      10029>>IF      10833>>IF      10838<<ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:523  
     10844>>ASSIGN  10896>>IF      11664>>ASSIGN  11881>>IF
CSTAT.SETS.SETX
      9593**DCL      9755>>IF       9772>>IF       9774<<ASSIGN   9780<<ASSIGN   9805>>IF       9892<<ASSIGN
      9920>>IF      10031>>IF      10852>>IF      10852<<ASSIGN  10873<<ASSIGN  11659>>IF      11672>>IF
     11673<<ASSIGN  11680>>IF      11681<<ASSIGN  11837>>IF      11844<<ASSIGN
DBUF.DEV
      9656**DCL     10094<<ASSIGN
DEFAULT_BUILD
      9575**DCL      9704<<ASSIGN   9960--ASSIGN   9961>>ASSIGN  10955--ASSIGN  10956<<ASSIGN  11304--ASSIGN
DEFER
     11623**PROC     9923--CALL
DEFERERR IN PROCEDURE DEFER
     11641**LABEL   11633--CALLALT
DEFERERR1 IN PROCEDURE DEFER
     11647**LABEL   11645--CALLALT 11647--CALLALT 11649--CALLALT
DEFERFPT
      9274**DCL     11633<>CALL    11667<>CALL    11679<>CALL
DEFERFPT.BUF_
      9274**DCL     11670>>ASSIGN
DEFERFPT.BUF_.BOUND
      9274**DCL     11631<<ASSIGN  11666<<ASSIGN  11669<<ASSIGN
DEFERFPT.BUF_.BUF$
      9276**DCL     11630<<ASSIGN  11665<<ASSIGN
DEFERFPT.STATION_
      9276**DCL      9276--REDEF   11668>>ASSIGN
DEFERFPT.V
      9277**DCL      9274--DCLINIT
DEFERFPT.V.DVBYTE.VFC#
      9283**DCL      9283--REDEF
DEFERST
      9300**DCL      9276--DCLINIT
DEFERST.MSGIDXT
      9310**DCL      9313--REDEF
DEFERST.MSGTYP#
      9304**DCL     11632<<ASSIGN  11664<<ASSIGN
DEL1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:524  
     10629**LABEL   10630--CALLALT
DEQPROJ
      9149**DCL      9715<>CALL
DEQPROJ.V
      9150**DCL      9149--DCLINIT
DIAGFPT
      7757**DCL      9714<>CALL    10049<>CALL    10619<>CALL    10969<>CALL    10986<>CALL    11102<>CALL
     11106<>CALL
DIAGFPT.V
      7757**DCL      7757--DCLINIT
DIAGFPT.V.PRIV#
      7757**DCL      9992<<ASSIGN  10971>>IF      11612<<ASSIGN  11613<<ASSIGN
DISP0
     10088**LABEL   10023--GOTO    10027--GOTO    10032--GOTO    10037--GOTO    10082--GOTO    10091--REMEMBR
     10876--GOTO    10882--GOTO    10885--GOTO
DISP1
     10093**LABEL   10189--GOTO
DISPS
     10194**LABEL   10053--GOTO
DISPS0
     10197**LABEL   10060--GOTO    10204--REMEMBR 10879--GOTO    10912--GOTO
DPCLOSE
     11739**LABEL   10330--CALLALT 10699--CALLALT 10770--CALLALT 11727--GOTO
DPERR
     11692**LABEL   10019--CALLALT 10041--GOTO    10048--CALLALT 10318--CALLALT 10328--CALLALT 10389--CALLALT
     10461--CALLALT 10464--GOTO    10483--CALLALT 10490--GOTO    10511--CALLALT 10620--CALLALT 10642--GOTO
     10696--CALLALT 10705--CALLALT 10711--CALLALT 10716--CALLALT 10732--CALLALT 10735--CALLALT 10761--CALLALT
     10780--CALLALT 10781--CALLALT 10787--CALLALT 10805--CALLALT 10809--CALLALT 10823--CALLALT 10859--GOTO
     10870--CALLALT 10872--CALLALT 10883--GOTO    10903--CALLALT 10907--CALLALT 10970--CALLALT 10975--CALLALT
     10987--CALLALT 11072--CALLALT 11074--CALLALT 11157--CALLALT 11162--GOTO    11166--CALLALT
DPERR1
     11701**LABEL    9817--REMEMBR  9923--CALLALT  9930--CALLALT 10384--GOTO    10476--CALLALT 10484--CALLALT
     10493--CALLALT 10633--CALLALT 10765--GOTO    10824--CALLALT 10886--GOTO    10978--CALLALT 10990--CALLALT
     11000--GOTO    11099--GOTO    11115--GOTO    11125--GOTO    11174--CALLALT 11186--GOTO    11205--GOTO
     11689--GOTO    11691--GOTO    11753--GOTO
DPERX
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:525  
      8473**DCL      9792<<ASSIGN   9816>>ASSIGN   9817<<REMEMBR  9818>>ASSIGN  11560>>UNWIND
DUPERR
     11690**LABEL   10752--GOTO
EFPT
      7264**DCL     11227<>CALL    11729<>CALL    11771<>CALL
EFPT.V
      7268**DCL      7264--DCLINIT
EFPT.V.DCB#
      7268**DCL      9819<<ASSIGN  11114<<ASSIGN  11203<<ASSIGN  11653<<ASSIGN  11770<<ASSIGN
EFPT.V.INCLCODE#
      7273**DCL     11224<<ASSIGN  11230<<ASSIGN
EFPT.V.OUTDCB1#
      7269**DCL     11225<<ASSIGN  11229<<ASSIGN
ERRALT
     11307**LABEL   11292--CALLALT
ERRCODE
      8455**DCL      9711<<ASSIGN   9725>>ASSIGN  10990>>IF      11112>>ASSIGN  11169<<ASSIGN  11174>>IF
     11867<<ASSIGN  11874>>ASSIGN  11876<<ASSIGN  11897>>ASSIGN
ERRDUBDEF
      9610**DCL      9603--DCLINIT
ERROR
     11333**PROC     9708--CALL     9822--CALL     9896--CALL    10074--CALL    10192--CALL    10266--CALL
     10441--CALL    10533--CALL    10535--CALL    10595--CALL    10607--CALL    10946--CALL    10971--CALL
     11036--CALL    11047--CALL    11087--CALL    11098--CALL    11110--CALL    11191--CALL    11255--CALL
     11256--CALL    11326--CALL    11733--CALL    11738--CALL    11748--CALL    11774--CALL    11776--CALL
     11818--CALL    11837--CALL    11838--CALL    11862--CALL
ERRPCB
     11279**LABEL   11298--CALLALT
ERRRET
     11283**LABEL   11309--GOTO
ERRSI
      9673**DCL      9604--DCLINIT
ERRSYN
      9612**DCL      9603--DCLINIT
ERRSYN.T
      9614**DCL      9696<<ASSIGN   9697<<CALLBLT  9699>>CALLBLT 11188<<ASSIGN  11189<<CALLBLT 11190>>CALLBLT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:526  
     11321<<CALLBLT 11325>>ASSIGN
ERRVEC
      9602**DCL     11349>>ASSIGN  11360>>ASSIGN
EVLR
      7291**DCL      7268--DCLINIT
EVLR.CODEUSED
      7299**DCL     11228>>ASSIGN
EXTXIT
     10811**LABEL   10740--GOTO
F$CFU$
      8489**DCL      4546--IMP-PTR  4551--IMP-PTR  4557--IMP-PTR  4639--IMP-PTR  9742>>ASSIGN   9744>>IF
      9745>>ASSIGN   9750>>IF       9750>>ASSIGN   9751>>ASSIGN   9751>>ASSIGN   9760>>ASSIGN   9762>>IF
      9763>>ASSIGN   9766>>IF       9766>>ASSIGN   9767>>ASSIGN   9767>>ASSIGN   9883>>ASSIGN   9886>>ASSIGN
      9887>>IF       9887>>IF       9889>>ASSIGN  10017>>IF      10020>>IF      10023>>IF      10023>>IF
     10026>>ASSIGN  10029>>IF      10029>>IF      10034>>ASSIGN  10055>>ASSIGN  10057>>DOWHILE 10058>>ASSIGN
     10084>>ASSIGN  10095>>IF      10097>>ASSIGN  10100>>IF      10100>>IF      10100>>IF      10102>>ASSIGN
     10103>>IF      10104>>ASSIGN  10106>>ASSIGN  10107>>IF      10108>>ASSIGN  10112>>ASSIGN  10113>>ASSIGN
     10115>>ASSIGN  10116>>IF      10117>>IF      10124>>IF      10125>>CALLBLT 10130>>IF      10153>>ASSIGN
     10159>>IF      10159>>ASSIGN  10160>>ASSIGN  10163>>IF      10187>>IF      10194>>IF      10194>>ASSIGN
     10195>>ASSIGN  10195>>ASSIGN  10201>>ASSIGN  10213>>ASSIGN  10214>>ASSIGN  10217>>IF      10218>>IF
     10227>>IF      10235>>IF      10239>>ASSIGN  10239>>ASSIGN  10240>>DOWHILE 10246>>ASSIGN  10259>>IF
     10259>>IF      10268>>ASSIGN  10676>>ASSIGN  10678>>IF      10678>>IF      10678>>IF      10682>>ASSIGN
     10682>>ASSIGN  10685>>ASSIGN  10818>>IF      10818>>ASSIGN  10819>>ASSIGN  10820>>ASSIGN  10864>>IF
     11410>>ASSIGN  11412>>IF      11412>>IF      11413>>ASSIGN
F$DCB.ACCT
      6713**DCL     10512>>IF      10533>>IF      10542>>ASSIGN  10760>>ASSIGN  11082>>IF      11455>>IF
     11456>>IF      11460>>ASSIGN
F$DCB.ACTPOS
      6728**DCL      6728--REDEF
F$DCB.ARS
      6703**DCL      6703--REDEF   11424>>ASSIGN  11631>>ASSIGN  11669>>ASSIGN
F$DCB.ATTR
      6721**DCL      6722--REDEF
F$DCB.BFR.DA
      6748**DCL     11165>>ASSIGN
F$DCB.BORROW
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:527  
      6736**DCL      6736--REDEF    6736--REDEF    6736--REDEF
F$DCB.CFU$
      6737**DCL      9795>>IF       9798>>ASSIGN
F$DCB.CSEED
      6740**DCL     11705>>ASSIGN
F$DCB.DCBNAME.L
      6750**DCL      6750--IMP-SIZ
F$DCB.DDEV.IC
      6709**DCL      9821>>IF       9821>>IF      11344>>IF      11773>>IF      11773>>IF
F$DCB.EOMCHAR
      6707**DCL      6707--REDEF
F$DCB.FCD
      6716**DCL     11643>>IF
F$DCB.FLDID
      6731**DCL      6731--REDEF
F$DCB.FORM$
      6725**DCL      6725--REDEF
F$DCB.FSECT
      6741**DCL      6741--REDEF
F$DCB.FSN
      6718**DCL      6718--REDEF    6718--REDEF    6719--REDEF
F$DCB.HEADER$
      6724**DCL      6724--REDEF
F$DCB.IASN
      6744**DCL     10451>>IF      10503>>IF
F$DCB.IXTNSIZE
      6722**DCL      6722--REDEF   10352>>IF      10358>>ASSIGN  10373>>IF      10759>>ASSIGN  10762>>IF
F$DCB.LASTSTA$
      6712**DCL      6712--REDEF    9717>>ASSIGN   9720>>IF       9859>>IF
F$DCB.LVL
      6737**DCL      6737--REDEF
F$DCB.NAME.C
      6712**DCL      6712--REDEF
F$DCB.NOEOF
      6733**DCL      6733--REDEF
F$DCB.NRECS
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:528  
      6723**DCL      6723--REDEF    9795>>IF       9798>>ASSIGN
F$DCB.NRECX
      6742**DCL      6742--REDEF
F$DCB.OHDR
      6734**DCL      6734--REDEF
F$DCB.ORG
      6717**DCL      6717--REDEF
F$DCB.OWNER
      6734**DCL     10327>>IF      10484>>IF      10698>>IF      10785>>IF      10815>>IF      10824>>IF
     10862>>IF      10868>>IF      10971>>IF
F$DCB.PASS
      6713**DCL     10018>>ASSIGN  10088>>ASSIGN
F$DCB.PRECNO
      6740**DCL      6740--REDEF
F$DCB.PSN
      6713**DCL     11017>>IF      11022>>ASSIGN  11083>>IF
F$DCB.RCSZ
      6745**DCL      6745--REDEF
F$DCB.RES
      6713**DCL      6713--REDEF
F$DCB.SETX
      6725**DCL      6725--REDEF   10016>>ASSIGN  10081>>ASSIGN  10816>>ASSIGN  10824>>IF      10864>>IF
     10877>>ASSIGN  10909>>ASSIGN
F$DCB.TAB$
      6724**DCL      6725--REDEF
F$DCB.TDA
      6739**DCL      6739--REDEF
F$DCB.WIDTH
      6710**DCL     11369>>ASSIGN
F$DCB.WSN
      6714**DCL      6714--REDEF
FFLGC
      9670**DCL     11569>>CALLBLT 11574>>CALLBLT
FFLGS
      9666**DCL     11565--ASSIGN  11568>>IF      11573>>IF
FFLGS IN PROCEDURE GET_OPTIONS
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:529  
     11904**DCL     12049>>ASSIGN
FGG$DONE
      8419**DCL-ENT 11865--CALL
FGG$QUIT
      8420**DCL-ENT 11899--CALL
FIT.CODES
      9587**DCL     11585>>ASSIGN
FIT.CODES.CODE
      9587**DCL     10448<<ASSIGN  11584>>DOINDEX 11588>>DOCASE
FIT.CODES.ITEMX
      9587**DCL     11587>>ASSIGN
FIT.CODES.NDW
      9587**DCL     11586>>ASSIGN
FIT00
      9520**DCL     10479--ASSIGN  11305--ASSIGN
FIT04
      9523**DCL     11583<<ASSIGN
FIT09
      9530**DCL     11594<<ASSIGN  11594>>ASSIGN
FIT09.ITEMX
      9534**DCL     10717<<ASSIGN  10718>>ASSIGN  10731>>ASSIGN
FIT09.NAW
      9532**DCL     12087<<ASSIGN
FIT09.NDW
      9533**DCL     10559>>ASSIGN  10718>>ASSIGN  10719>>IF      10730>>ASSIGN  10954>>ASSIGN  11303>>ASSIGN
     12048>>ASSIGN  12086<<ASSIGN  12087>>ASSIGN
FIT14
      9525**DCL     11597<<ASSIGN  11597>>ASSIGN
FIT14.NAW
      9527**DCL     12044<<ASSIGN
FIT14.NDW
      9528**DCL     10465<<ASSIGN  10580>>ASSIGN  10717>>ASSIGN  12043<<ASSIGN  12044>>ASSIGN
FITMOVER
      9574**DCL      9704>>ASSIGN   9961<<ASSIGN  10728>>ASSIGN  10731<<ASSIGN  10956>>ASSIGN  11305>>ASSIGN
     11590>>ASSIGN  11595<<ASSIGN  11595>>ASSIGN  11598>>ASSIGN
FITSIZE
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:530  
      9576**DCL      9574--IMP-SIZ  9704>>ASSIGN   9960<<ASSIGN   9961>>ASSIGN  10723<<ASSIGN  10728>>ASSIGN
     10730<<ASSIGN  10731>>ASSIGN  10955<<ASSIGN  10956>>ASSIGN  11304<<ASSIGN  11305>>ASSIGN  11586<<ASSIGN
     11590>>ASSIGN  11595>>ASSIGN  11595>>ASSIGN  11598>>ASSIGN
FLAG
      8467**DCL      7251--DCLINIT  7264--DCLINIT  9711>>ASSIGN   9725<<ASSIGN  10383<<ASSIGN  10447<<ASSIGN
     10464>>IF      10473<<ASSIGN  10486<<ASSIGN  10490>>IF      10528<<ASSIGN  10561<<ASSIGN  10636<<ASSIGN
     10639>>IF      10642>>IF      10764<<ASSIGN  10866<<ASSIGN  10885>>IF      10999<<ASSIGN  11016<<ASSIGN
     11024>>IF      11028>>IF      11095<<ASSIGN  11112<<ASSIGN  11124<<ASSIGN  11160<<ASSIGN  11162>>IF
     11163>>IF      11178<<ASSIGN  11186>>IF      11195<<ASSIGN  11201<<ASSIGN  11202>>ASSIGN  11209>>IF
     11228<<ASSIGN  11279<<ASSIGN  11302<<ASSIGN  11307<<ASSIGN  11390>>IF      11390>>ASSIGN  11457<<ASSIGN
     11568>>IF      11573>>IF      11625<<ASSIGN  11634<<ASSIGN  11641<<ASSIGN  11688<<ASSIGN  11690<<ASSIGN
     11699<<ASSIGN  11700<>CALL    11706<<ASSIGN  11710<<ASSIGN  11752<<ASSIGN  11768<<ASSIGN  11781<<ASSIGN
     11782<>CALL    11840<<ASSIGN  11897<<ASSIGN  11913<<ASSIGN  11933<<ASSIGN  11942>>ASSIGN  11960>>ASSIGN
     11967>>ASSIGN  11985>>ASSIGN  11986>>ASSIGN  11993>>ASSIGN  12001>>ASSIGN  12008>>ASSIGN  12015>>ASSIGN
     12022>>ASSIGN  12029>>ASSIGN  12036>>ASSIGN  12049<<ASSIGN  12049>>ASSIGN  12052>>IF      12052>>IF
     12052>>IF      12059>>IF      12059<<ASSIGN  12060<<ASSIGN  12064>>ASSIGN  12066>>IF      12066>>ASSIGN
     12067>>ASSIGN  12072>>IF      12072>>ASSIGN  12073>>ASSIGN  12074>>IF
FLAG.CODE
      8471**DCL     10482>>IF      10640>>IF      10640>>IF      10859>>IF      10868>>IF      11096>>IF
     11205>>IF      11223>>IF      11642>>IF      11704>>IF      11732>>IF      11739>>IF
FLAG.FCG
      8468**DCL     11223>>IF
FLAG.SEV
      8472**DCL     11097<<ASSIGN  11113<<ASSIGN  11204<<ASSIGN  11226<<ASSIGN  11226>>ASSIGN  11308<<ASSIGN
     11559<<ASSIGN  11654<<ASSIGN  11701<<ASSIGN  11726<<ASSIGN  11726>>ASSIGN  11769<<ASSIGN  11783<<ASSIGN
     11898<<ASSIGN
FM$CFUX.DSETH
      4640**DCL      9742>>ASSIGN   9760>>ASSIGN  10084>>ASSIGN
FM$CFUX.SETH
      4640**DCL      9883>>ASSIGN  10055>>ASSIGN  10201>>ASSIGN  10676>>ASSIGN  11410>>ASSIGN
FM$DEV.AVR
      4552**DCL      9745<<ASSIGN   9763<<ASSIGN
FM$DEV.DCTX
      4551**DCL     10020>>IF      10100>>IF      10103>>IF      10818>>IF
FM$DEV.DEVL
      4553**DCL      9751>>ASSIGN   9767>>ASSIGN  10195>>ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:531  
FM$DEV.MIRROR
      4552**DCL     10100>>IF      10130>>IF
FM$DEV.MRRDCTX
      4554**DCL     10153>>ASSIGN  10159>>IF      10159>>ASSIGN  10163>>IF
FM$DEV.NN
      4551**DCL     10160>>ASSIGN
FM$DEV.SECTL
      4553**DCL      9750>>IF       9750>>ASSIGN   9766>>IF       9766>>ASSIGN  10023>>IF      10100>>IF
     10102>>ASSIGN  10187>>IF      10818>>ASSIGN
FM$DEV.SPIN
      4552**DCL      9744>>IF       9762>>IF      10017>>IF      10023>>IF      10095>>IF
FM$DEV.USERLIST
      4552**DCL      4553--REDEF
FM$DEV.VSN
      4551**DCL     10682>>ASSIGN
FM$GRAN
      4647**DCL     10718--ASSIGN  10731--ASSIGN
FM$SET.DCTX
      4546**DCL     10678>>IF      10682>>ASSIGN
FM$SET.GACSHELF
      4547**DCL     10864>>IF
FM$SET.NONEWU
      4546**DCL     10117>>IF      10227>>IF
FM$SET.ONEU
      4547**DCL     10235>>IF
FM$SET.PSN
      4546**DCL      9886>>ASSIGN  10029>>IF      10034>>ASSIGN  10057>>DOWHILE 10108>>ASSIGN  10113>>ASSIGN
     10213>>ASSIGN  10259>>IF      10678>>IF      10820>>ASSIGN  11412>>IF
FM$SET.REALPSN
      4548**DCL     10029>>IF      10107>>IF      10112>>ASSIGN  10259>>IF
FM$SET.SET
      4546**DCL     10217>>IF      10678>>IF      11412>>IF
FM$SET.SETL
      4548**DCL      9889>>ASSIGN  10058>>ASSIGN  10268>>ASSIGN  10685>>ASSIGN  11413>>ASSIGN
FM$SET.SYSID
      4547**DCL      9887>>IF      10115>>ASSIGN  10214>>ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:532  
FM$SET.USERLIST
      4547**DCL      4547--REDEF   10239>>ASSIGN
FM$SET.XCL
      4546**DCL      9887>>IF      10116>>IF      10218>>IF
FM$SETU.LINKX
      4644**DCL     10246>>ASSIGN
FM$SETU.NUM
      4644**DCL     10241>>ASSIGN  10242>>DOINDEX
FM$SETU.SYSID
      4644**DCL     10243>>ASSIGN
FM$VOL.DCTX
      4557**DCL      9751>>ASSIGN   9767>>ASSIGN  10195>>ASSIGN
FM$VOL.SECT#
      4557**DCL     10124>>IF      10125>>CALLBLT
FM$VOL.SECTL
      4559**DCL     10194>>IF      10194>>ASSIGN
FM$VOL.SETX
      4557**DCL     10026>>ASSIGN  10104>>ASSIGN  10819>>ASSIGN
FM$VOL.USERLIST
      4558**DCL      4559--REDEF
FM$VOL.VOL#
      4559**DCL     10106>>ASSIGN
FM$VOL.VSN
      4557**DCL     10097>>ASSIGN
FMN$E$NOTAUTH
      7871**DCL     11124>>ASSIGN
FMN$E$XCLSET
      7876**DCL     11752>>ASSIGN
FPT_INT
      7465**DCL      9684<>CALL     9740<>CALL
FPT_INT.V
      7465**DCL      7465--DCLINIT
FPT_LDEV
      7810**DCL      9797<>CALL
FPT_LDEV.V
      7812**DCL      7810--DCLINIT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:533  
FPT_PROMPT
      8035**DCL      9680<>CALL
FPT_PROMPT.V
      8043**DCL      8037--DCLINIT
FPT_READ
      8264**DCL      9808<>CALL     9812<>CALL    11853<>CALL    11887<>CALL
FPT_READ.BUF_
      8266**DCL      9917<<ASSIGN
FPT_READ.BUF_.BOUND
      8266**DCL     11765<<ASSIGN
FPT_READ.BUF_.BUF$
      8267**DCL      9911>>IF      11763>>IF      11764<<ASSIGN
FPT_READ.STATION_
      8267**DCL      8268--REDEF
FPT_READ.V
      8268**DCL      8264--DCLINIT
FPT_READ.V.DVBYTE.REREAD#
      8279**DCL      8279--REDEF
FPT_READ.V.EVENT#
      8277**DCL      9795>>IF       9800>>IF       9807<<ASSIGN  11849>>IF      11851<<ASSIGN  11868<<ASSIGN
     11886<<ASSIGN  11894<<ASSIGN
FPT_READ.V.INDX#
      8277**DCL      8277--REDEF
FPT_READ.V.WAIT#
      8268**DCL      9790>>IF      11839>>IF      11848<<ASSIGN  11864<<ASSIGN  11896<<ASSIGN
FPT_TRAP
      7786**DCL      9685<>CALL
FPT_TRAP.V
      7786**DCL      7786--DCLINIT
FPT_XCON
      7772**DCL      9686<>CALL
FPT_XCON.V
      7773**DCL      7772--DCLINIT
FXD$PMME
      8421**DCL-ENT 11437--IF      11437--CALL    11699--IF      11700--CALL    11744--IF      11744--CALL
     11781--IF      11782--CALL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:534  
FXF$FIX
      8422**DCL-ENT 11170--CALL
FXH$COUNT
      8426**DCL-ENT 10989--CALL
FXH$GPSUM
      8423**DCL-ENT 10621--CALL
FXH$RECON
      8424**DCL-ENT 11863--CALL
FXH$RECONT
      8425**DCL-ENT 11888--CALL
FXN$CMD
      8443**DCL      8071--DCLINIT
FXP$E$2RECON
      7862**DCL     10885>>IF      11840>>ASSIGN
FXP$E$BIGSECT
      7904**DCL     10383>>ASSIGN
FXP$E$DEFER
      7896**DCL     11634>>ASSIGN
FXP$E$DUPVSN
      7866**DCL     11690>>ASSIGN
FXP$E$NEEDSCR
      7880**DCL     10764>>ASSIGN
FXP$E$NLIST
      7900**DCL     11625>>ASSIGN
FXP$E$NOVOL
      7858**DCL     11706>>ASSIGN
FXP$E$PROJCMD
      7884**DCL     11688>>ASSIGN
FXP$E$PROJDFT
      7892**DCL     11279>>ASSIGN
FXP$E$PROJPSN
      7888**DCL     10999>>ASSIGN
FXP$E$VOLDOWN
      7854**DCL     11710>>ASSIGN
FXP$INT
      8441**DCL-ENT  7465--DCLINIT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:535  
FXP$POPTS
      8427**DCL-ENT  8084--DCLINIT
FXP$TRAP
      8440**DCL-ENT  7788--DCLINIT
FXP$TWO
      9815**ENTRY   11875--CALL
FXP$XCON
      8442**DCL-ENT  7773--DCLINIT
FXU$CATADM
      8437**DCL-ENT 11103--CALL
FXU$CATL
      8438**DCL-ENT 11109--CALL
FXU$CATMNT
      8436**DCL-ENT 10022--CALL    10035--CALL
FXU$GINIT
      8435**DCL-ENT  9741--CALL
FXU$PROJAC
      8429**DCL-ENT 11556--CALL
FXU$PROJAD
      8428**DCL-ENT  9693--CALL     9930--CALL    11183--CALL
FXU$PROJDA
      8432**DCL-ENT 10633--CALL
FXU$PROJGR
      8431**DCL-ENT 10476--CALL
FXU$PROJNA
      8430**DCL-ENT 11463--CALL
FXU$PROJWR
      8433**DCL-ENT 10493--CALL    10641--CALL
FXU$PROTCHK
      8434**DCL-ENT 10330--CALL    10634--CALL    10699--CALL    10770--CALL    11068--CALL
FXU$TRACKER
      8439**DCL-ENT 10492--CALL    10639--CALL
FX_MSG$ IN PROCEDURE ADDPART
     11793**DCL     11801>>ASSIGN  11810>>ASSIGN
GAC
      8456**DCL      9968<<ASSIGN  10865<<ASSIGN  10868>>IF      10961<<ASSIGN  11836>>ASSIGN  11865>>IF
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:536  
     11899>>IF
GBUF.CADDR
      8008**DCL      9755<<ASSIGN   9757<<ASSIGN   9772<<ASSIGN   9773<<ASSIGN   9866>>ASSIGN   9894<<ASSIGN
GBUF.CODE
      8007**DCL      9754<<ASSIGN   9775<<ASSIGN   9862>>ASSIGN   9864>>ASSIGN   9867>>DOCASE   9885<<ASSIGN
     11856<<ASSIGN
GBUF.PSN
      8009**DCL      9758<<ASSIGN   9776<<ASSIGN   9863>>ASSIGN   9886<<ASSIGN   9887>>IF      10012>>IF
     11857<<CALLBLT
GETVSN
     10738**LABEL   10663--GOTO    10789--GOTO
GETVSNBRET
     10662**LABEL   10771--GOTO
GETVSNERET
     10788**LABEL   10772--GOTO
GET_OPTIONS
     11903**PROC    10470--CALL    10669--CALL    10951--CALL    11298--CALL
GPBUF
      9482**DCL     10715>>ASSIGN
GRANULE
      8478**DCL      7428--DCLINIT  7429--DCLINIT  9979<<ASSIGN  10237<<ASSIGN  10312>>IF      10326>>IF
     10329>>IF      10338>>IF      10342>>IF      10390<<ASSIGN  10390>>ASSIGN  10393>>IF      10714<<ASSIGN
     10714>>ASSIGN  10722<<ASSIGN  10722>>ASSIGN  10734<<ASSIGN  10734>>ASSIGN  10736<<ASSIGN  10798>>IF
     10801>>IF      10812<<ASSIGN  10812>>ASSIGN  11069<<ASSIGN  11403>>ASSIGN  11404<<ASSIGN
HELP1
     11229**LABEL   11227--CALLALT
HELP_ERR
     11197**LABEL   11198--CALLALT 11235--CALLALT
HERE3
     11728**LABEL   11729--CALLALT
HERE7
     11770**LABEL   11771--CALLALT
I
      8458**DCL      9698<<CALLBLT  9699>>CALLBLT  9742<<ASSIGN   9743>>DOWHILE  9744>>IF       9745>>ASSIGN
      9750>>IF       9750<<ASSIGN   9750>>ASSIGN   9751<<ASSIGN   9751>>ASSIGN   9760<<ASSIGN   9761>>DOWHILE
      9762>>IF       9763>>ASSIGN   9766>>IF       9766<<ASSIGN   9766>>ASSIGN   9767<<ASSIGN   9767>>ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:537  
      9770<<DOINDEX  9772>>IF       9774>>ASSIGN   9775>>ASSIGN   9776>>ASSIGN   9804<<DOINDEX  9805>>IF
      9831<<ASSIGN   9832>>DOWHILE  9833>>IF       9837>>ASSIGN   9840<<ASSIGN   9840>>ASSIGN   9883<<ASSIGN
      9884>>DOWHILE  9886>>ASSIGN   9887>>IF       9887>>IF       9889<<ASSIGN   9889>>ASSIGN   9919<<DOINDEX
      9920>>IF       9920>>IF       9920>>IF       9981<<ASSIGN  10028<<DOINDEX 10029>>IF      10029>>IF
     10031>>IF      10103<<ASSIGN  10104<<ASSIGN  10105>>IF      10107>>IF      10108>>ASSIGN  10112>>ASSIGN
     10113>>ASSIGN  10115>>ASSIGN  10116>>IF      10117>>IF      10121<<ASSIGN  10125>>CALLBLT 10126>>ASSIGN
     10127<<ASSIGN  10127>>ASSIGN  10151>>ASSIGN  10182<<ASSIGN  10207<<ASSIGN  10237>>ASSIGN  10282<<ASSIGN
     10283>>DOWHILE 10284>>ASSIGN  10287>>CALLBLT 10287>>CALLBLT 10289<<ASSIGN  10289>>ASSIGN  10301>>ASSIGN
     10305<<ASSIGN  10305>>ASSIGN  10307<<ASSIGN  10309>>DOWHILE 10311>>ASSIGN  10322>>ASSIGN  10337>>ASSIGN
     10338>>IF      10345<<DOINDEX 10346>>IF      10346>>IF      10346>>IF      10349>>ASSIGN  10351<<ASSIGN
     10353<<ASSIGN  10371>>IF      10390>>ASSIGN  10391>>IF      10394<<ASSIGN  10394>>ASSIGN  10453<<ASSIGN
     10456<<ASSIGN  10469>>DOWHILE 10471<<ASSIGN  10471>>ASSIGN  10475<<ASSIGN  10476<>CALL    10526<<ASSIGN
     10527>>ASSIGN  10604<<CALLBLT 10605>>CALLBLT 10661>>DOWHILE 10662>>IF      10668>>DOWHILE 10670<<ASSIGN
     10670>>ASSIGN  10672<<ASSIGN  10672>>ASSIGN  10676<<ASSIGN  10677>>DOWHILE 10678>>IF      10678>>IF
     10678>>IF      10682>>ASSIGN  10685<<ASSIGN  10685>>ASSIGN  10688<<ASSIGN  10690>>DOWHILE 10691<<ASSIGN
     10691>>ASSIGN  10692>>ASSIGN  10703<<ASSIGN  10713>>IF      10743>>CALLBLT 10743>>CALLBLT 10745>>IF
     10746>>IF      10747>>ASSIGN  10747>>ASSIGN  10749<<ASSIGN  10749>>ASSIGN  10788>>DOWHILE 10793<<ASSIGN
     10793>>ASSIGN  10795<<ASSIGN  10796>>DOWHILE 10797<<ASSIGN  10797>>ASSIGN  10799>>ASSIGN  10812>>ASSIGN
     10816<<ASSIGN  10818>>IF      10818>>IF      10818<<ASSIGN  10818>>ASSIGN  10819<<ASSIGN  10819>>ASSIGN
     10820>>ASSIGN  10824>>IF      10832<<DOINDEX 10833>>IF      10837>>ASSIGN  10838>>ASSIGN  10839>>ASSIGN
     10840>>ASSIGN  10841>>ASSIGN  10844>>ASSIGN  10846>>IF      10846>>IF      10847>>ASSIGN  10848<<ASSIGN
     10849>>ASSIGN  10850>>ASSIGN  10852>>IF      10852>>ASSIGN  10862>>IF      10864>>IF      10871>>ASSIGN
     10873>>ASSIGN  10895<<DOINDEX 10896>>IF      10897>>ASSIGN  10929<<ASSIGN  10946>>IF      10950>>DOWHILE
     10952<<ASSIGN  10952>>ASSIGN  11006<<ASSIGN  11035>>IF      11037<<ASSIGN  11039>>CALLBLT 11040<<ASSIGN
     11040>>ASSIGN  11043>>IF      11063<<ASSIGN  11086>>IF      11088<<ASSIGN  11090>>CALLBLT 11091<<ASSIGN
     11091>>ASSIGN  11098>>IF      11107<<ASSIGN  11139>>DOWHILE 11140>>IF      11141>>ASSIGN  11142>>ASSIGN
     11142>>ASSIGN  11144>>ASSIGN  11145>>IF      11146>>ASSIGN  11146>>ASSIGN  11147<<ASSIGN  11147>>ASSIGN
     11197<<ASSIGN  11206>>ASSIGN  11258<<ASSIGN  11294<<ASSIGN  11297>>DOWHILE 11299<<ASSIGN  11299>>ASSIGN
     11312<<ASSIGN  11313>>IF      11313>>IF      11319<<ASSIGN  11320<<ASSIGN  11321>>CALLBLT 11321>>CALLBLT
     11323<<ASSIGN  11324<<ASSIGN  11326<>CALL    11327>>IF      11658<<DOINDEX 11659>>IF      11664>>ASSIGN
     11672>>IF      11673>>ASSIGN  11680>>IF      11681>>ASSIGN  11715>>ASSIGN  11716<<ASSIGN  11725<<ASSIGN
     11757>>ASSIGN  11817>>IF      11820<<ASSIGN  11826>>CALLBLT 11827<<ASSIGN  11827>>ASSIGN  11837>>IF
     11844>>ASSIGN  11880<<DOINDEX 11881>>IF      11915>>ASSIGN  11934<<ASSIGN  11934>>ASSIGN  11949<<ASSIGN
     11949>>ASSIGN  11950>>CALLBLT 11950>>CALLBLT 11974<<ASSIGN  11974>>ASSIGN  11975>>CALLBLT 11975>>CALLBLT
     11984<<ASSIGN  11984>>ASSIGN  12091>>ASSIGN
I IN PROCEDURE ERROR
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:538  
     11334**DCL     11333--PROC    11347>>DOCASE  11360>>ASSIGN  11371>>DOCASE  11390>>IF      11391>>ASSIGN
     11395>>IF      11400>>IF      11432--ENTRY   11433>>ASSIGN
I0
      8459**DCL      9978<<ASSIGN  10527<<ASSIGN  11108<<ASSIGN  11258>>ASSIGN  11404>>ASSIGN  11405>>ASSIGN
     11820>>ASSIGN
ITEMXMASK
      9518**DCL     11585>>ASSIGN  11594>>ASSIGN  11597>>ASSIGN
J
      8464**DCL      9985<<CALLBLT 10026<<ASSIGN  10027>>IF      10029>>IF      10029>>IF      10034>>ASSIGN
     10122<<ASSIGN  10132<<ASSIGN  10149<<ASSIGN  10153<<ASSIGN  10154>>IF      10159<<ASSIGN  10160<<ASSIGN
     10160>>ASSIGN  10162>>CALLBLT 10176<<ASSIGN  10221<<ASSIGN  10243<<ASSIGN  10244>>IF      10248<<ASSIGN
     10258<<ASSIGN  10259>>IF      10260<<ASSIGN  10262>>ASSIGN  10263>>IF      10279<<ASSIGN  10285<<ASSIGN
     10291>>ASSIGN  10295>>IF      10296>>IF      10296>>ASSIGN  10298>>IF      10299>>ASSIGN  10299>>ASSIGN
     10300>>ASSIGN  10300>>ASSIGN  10301>>ASSIGN  10303<<ASSIGN  10303>>ASSIGN  10343<<ASSIGN  10344>>DOWHILE
     10344>>DOWHILE 10346>>IF      10346>>IF      10346>>IF      10349>>ASSIGN  10352>>IF      10353>>ASSIGN
     10357>>IF      10357>>IF      10358>>ASSIGN  10359>>ASSIGN  10359>>ASSIGN  10359>>ASSIGN  10360>>IF
     10361<<ASSIGN  10361>>ASSIGN  10520<<CALLBLT 10521>>CALLBLT 10543<<ASSIGN  10546<<ASSIGN  10547>>IF
     10557<<ASSIGN  10558>>IF      10682<<ASSIGN  10683--ASSIGN  10743<<CALLBLT 10744>>ASSIGN  10751<<DOINDEX
     10752>>IF      11267--ASSIGN  11565<<ASSIGN  11566>>DOWHILE 11567<<ASSIGN  11567>>ASSIGN  11568>>IF
     11569>>CALLBLT 11573>>IF      11573>>IF      11574>>CALLBLT 11703<<ASSIGN  11705<<ASSIGN  11706>>IF
     11717>>IF      11718--CALLBLT 11719--CALLBLT 11721>>CALLBLT 11721>>CALLBLT 11792--IMP-SIZ 11796<<ASSIGN
     11803>>CALLBLT 11805<<CALLBLT 11806<<ASSIGN  11806>>ASSIGN  11807>>CALLBLT 11807>>CALLBLT 11812<<ASSIGN
     11814>>DOWHILE 11814>>DOWHILE 11815<<ASSIGN  11815>>ASSIGN  11817>>IF      11821>>IF      11822<<ASSIGN
     11822>>ASSIGN  11826>>CALLBLT 11827>>ASSIGN  11912<<ASSIGN  11950<<CALLBLT 11951<<ASSIGN  11951>>ASSIGN
     11952>>ASSIGN  11953>>IF      11975<<CALLBLT 11976>>ASSIGN  11977>>IF      12038<<DOINDEX 12039>>IF
     12040>>ASSIGN  12040>>ASSIGN  12040>>ASSIGN  12041>>ASSIGN  12041>>ASSIGN  12041>>ASSIGN  12043>>ASSIGN
     12046>>DOWHILE 12047>>IF      12049>>ASSIGN  12050<<ASSIGN  12050>>ASSIGN  12052>>IF      12052>>IF
     12052>>IF      12052>>IF      12052>>IF      12061>>DOWHILE 12063>>ASSIGN  12063>>ASSIGN  12084<<ASSIGN
     12084>>ASSIGN  12091>>ASSIGN
K IN PROCEDURE GET_OPTIONS
     11911**DCL     12069<<DOINDEX 12070>>IF      12072>>ASSIGN  12073>>ASSIGN  12073>>ASSIGN  12075>>ASSIGN
     12075>>ASSIGN  12076>>ASSIGN  12077>>IF
L IN PROCEDURE ADDPART
     11787**DCL     11786--PROC    11789--IMP-SIZ 11796>>ASSIGN  11800--ENTRY   11801>>ASSIGN  11808--ENTRY
     11809--ENTRY   11810>>ASSIGN
LBUF
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:539  
      9646**DCL      7265--DCLINIT  9603--DCLINIT  9603--DCLINIT  9605--DCLINIT 10526--ASSIGN
LBUF.ACCT
      9647**DCL     10542<<ASSIGN
LBUF.CGRANS
      9649**DCL     10516<<ASSIGN  10517<<CALLBLT 10518<<CALLBLT 10518>>CALLBLT
LBUF.MGRANS
      9651**DCL     10523<<ASSIGN  10524<<CALLBLT 10525<<CALLBLT 10525>>CALLBLT
LBUF.REST
      9653**DCL     10526--ASSIGN
LBUF0
      9664**DCL     10515>>ASSIGN
LBUFC
      9645**DCL      9646--REDEF    9654--REDEF    9658--REDEF    9688<<CALLBLT  9698>>CALLBLT  9699<<CALLBLT
      9895<<ASSIGN   9966<<ASSIGN  10093<<ASSIGN  10125<<CALLBLT 10126>>ASSIGN  10151<<ASSIGN  10205<<ASSIGN
     10445<<ASSIGN  10452>>ASSIGN  10515<<ASSIGN  10520>>CALLBLT 10521<<CALLBLT 10597<<ASSIGN  11039<<CALLBLT
     11043>>IF      11090<<CALLBLT 11190<<CALLBLT 11257<<ASSIGN  11403<<ASSIGN  11403>>ASSIGN  11721>>CALLBLT
     11728<<ASSIGN  11819<<ASSIGN  11826<<CALLBLT 11831<<CALLBLT
LISTGP
     10614**LABEL   10508--CALLALT 10613--CALLALT
LISTH1
      9618**DCL      9605--DCLINIT
LISTH1.PSN
      9620**DCL     10505<<ASSIGN
LISTH2
      9623**DCL      9605--DCLINIT
LISTNXT
     10506**LABEL   10494--GOTO    10614--GOTO    11739--GOTO
LISTNXT0
     10503**LABEL   10925--GOTO
LISTNXT1
     10512**LABEL   10957--GOTO
LISTNXTM
     10500**LABEL   11026--GOTO
LISTO0
     10585**LABEL   10590--GOTO
LISTO1
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:540  
     10587**LABEL   10584--GOTO
LIST_ATTR
      8465**DCL     10596>>IF      10648<<ASSIGN  10649<<ASSIGN  10650<<ASSIGN
LOFPT
      8303**DCL     11356<>CALL    11366<>CALL    11379<>CALL
LOFPT.BUF_
      8303**DCL     11349<<ASSIGN  11360<<ASSIGN
LOFPT.BUF_.BOUND
      8303**DCL     11353>>DOWHILE 11354<<ASSIGN  11354>>ASSIGN  11361>>DOWHILE 11361>>DOWHILE 11363<<ASSIGN
     11363>>ASSIGN  11386>>ASSIGN
LOFPT.BUF_.BUF$
      8305**DCL     11361>>DOWHILE 11387>>CALLBLT
LOFPT.STATION_
      8305**DCL      8305--REDEF
LOFPT.V
      8306**DCL      8303--DCLINIT
LOFPT.V.DCB#
      8306**DCL     11350<<ASSIGN  11365<<ASSIGN  11378<<ASSIGN
LOFPT.V.DVBYTE.VFC#
      8312**DCL      8312--REDEF
M$CAT
      8448**DCL      9710<>CALL    11114>>ASSIGN
M$CHECK
      3547**DCL-ENT  9808--CALL
M$CLOSE
      3545**DCL-ENT  9747--CALL    10019--CALL    10622--CALL    10705--CALL    10787--CALL    10825--CALL
     10872--CALL    10907--CALL    10979--CALL    10991--CALL    11172--CALL    11245--CALL    11249--CALL
     11434--CALL    11649--CALL    11743--CALL
M$CORRES
      3550**DCL-ENT 11344--CALL    11346--CALL    11377--CALL
M$DEQ
      3612**DCL-ENT  9715--CALL
M$DO
      8446**DCL     11225>>ASSIGN  11350>>ASSIGN  11378>>ASSIGN
M$DP
      8447**DCL      9819>>ASSIGN  10090<>CALL    10321<>CALL    10354<>CALL    10393<>CALL    10396<>CALL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:541  
     10485<>CALL    10666<>CALL    10738<>CALL    10791<>CALL    10810<>CALL    10867<>CALL    10973<>CALL
     11075<>CALL    11246<>CALL    11250<>CALL    11873<>CALL
M$DP$
      8482**DCL      6703--IMP-PTR 10016>>ASSIGN  10018>>ASSIGN  10081>>ASSIGN  10088>>ASSIGN  10327>>IF
     10352>>IF      10358>>ASSIGN  10373>>IF      10451>>IF      10484>>IF      10503>>IF      10512>>IF
     10533>>IF      10542>>ASSIGN  10698>>IF      10759>>ASSIGN  10760>>ASSIGN  10762>>IF      10785>>IF
     10815>>IF      10816>>ASSIGN  10824>>IF      10824>>IF      10862>>IF      10864>>IF      10868>>IF
     10877>>ASSIGN  10909>>ASSIGN  10971>>IF      11017>>IF      11022>>ASSIGN  11082>>IF      11083>>IF
     11165>>ASSIGN  11455>>IF      11456>>IF      11460>>ASSIGN  11705>>ASSIGN
M$ERRMSG
      3608**DCL-ENT 11227--CALL    11729--CALL    11771--CALL
M$EVENT
      3600**DCL-ENT  9740--CALL
M$GDS
      3580**DCL-ENT  9683--CALL     9836--CALL    11314--CALL
M$INT
      3600**DCL-ENT  9684--CALL
M$LDEV
      3545**DCL-ENT  9797--CALL
M$LO
      8445**DCL      9703--ASSIGN  10005<>CALL    11345>>ASSIGN  11365>>ASSIGN  11376>>ASSIGN  11778<>CALL
M$LO$
      8484**DCL      9703<<ASSIGN   9795>>IF       9798>>ASSIGN   9821>>IF      11369>>ASSIGN  11773>>IF
M$MADMUCK
      3553**DCL-ENT 11020--CALL    11084--CALL
M$MERC
      3601**DCL-ENT 11367--CALL    11784--CALL
M$OPEN
      3545**DCL-ENT  9746--CALL    10015--CALL    10077--CALL    10087--CALL    10317--CALL    10326--CALL
     10449--CALL    10461--CALL    10481--CALL    10487--CALL    10502--CALL    10511--CALL    10620--CALL
     10630--CALL    10637--CALL    10695--CALL    10758--CALL    10780--CALL    10800--CALL    10803--CALL
     10823--CALL    10858--CALL    10861--CALL    10870--CALL    10903--CALL    10924--CALL    10970--CALL
     10975--CALL    10987--CALL    11072--CALL    11157--CALL    11161--CALL    11166--CALL    11243--CALL
     11292--CALL    11453--CALL    11554--CALL    11645--CALL    11647--CALL    11883--CALL
M$PIGCG
      9315**DCL     11643--IF      11653>>ASSIGN  11669--ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:542  
M$PROJ
      9155**DCL      9860<>CALL
M$PROMPT
      3569**DCL-ENT  9680--CALL
M$READ
      3546**DCL-ENT  9812--CALL    10017--CALL    10318--CALL    10328--CALL    10483--CALL    10696--CALL
     10761--CALL    10781--CALL    10805--CALL    11244--CALL    11422--CALL    11667--CALL    11853--CALL
     11887--CALL
M$RETRY
      3602**DCL-ENT  9784--CALL    11650--CALL    11696--CALL    11736--CALL    11766--CALL
M$RPRIV
      3604**DCL-ENT  9687--CALL     9712--CALL     9714--CALL    10491--CALL    11179--CALL
M$SAD
      3584**DCL-ENT  9713--CALL    10048--CALL
M$SI
      8444**DCL      9705--ASSIGN  11343>>ASSIGN  11679>>IF      11770>>ASSIGN
M$SI$
      8485**DCL      9705<<ASSIGN   9717>>ASSIGN   9720>>IF       9821>>IF       9859>>IF      11344>>IF
     11631>>ASSIGN  11773>>IF
M$SPRIV
      3604**DCL-ENT  9990--CALL    10049--CALL    10451--CALL    10504--CALL    10619--CALL    10969--CALL
     10977--CALL    10986--CALL    10988--CALL    11005--CALL    11102--CALL    11105--CALL    11106--CALL
     11152--CALL    11288--CALL    11604--CALL    11606--CALL    11609--CALL
M$TIME
      3612**DCL-ENT 10600--CALL    10726--CALL
M$TRAP
      3599**DCL-ENT  9685--CALL
M$WAIT
      3603**DCL-ENT  9727--CALL     9783--CALL    10014--CALL    10398--CALL    10911--CALL    11695--CALL
     11735--CALL
M$WRITE
      3546**DCL-ENT  9721--CALL     9764--CALL     9778--CALL     9888--CALL    10389--CALL    10711--CALL
     10716--CALL    10732--CALL    10735--CALL    10809--CALL    11074--CALL    11356--CALL    11366--CALL
     11379--CALL    11407--CALL    11417--CALL    11430--CALL    11633--CALL    11671--CALL    11679--CALL
M$XCON
      3600**DCL-ENT  9686--CALL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:543  
MADBUF
      9500**DCL      9500--DCLINIT 10733>>ASSIGN  11073>>ASSIGN
MADBUF.K
      9501**DCL     10729>>ASSIGN
MADD1
     11089**LABEL   11024--GOTO    11028--GOTO    11084--CALLALT
MADDA
     11061**LABEL   11055--GOTO
MADLIST
     10991**LABEL   10438--GOTO    10500--GOTO    10611--GOTO    10628--GOTO
MADLX
     11043**LABEL   11014--CALLALT 11015--GOTO    11032--GOTO    11079--CALLALT 11080--GOTO    11082--GOTO
     11096--GOTO
MADM
      7402**DCL     11020<>CALL    11084<>CALL
MADM.V
      7403**DCL      7402--DCLINIT  9980<<ASSIGN
MADM.V.DELETE#
      7404**DCL     11060<<ASSIGN  11067>>IF      11445>>IF
MADM.V.READ#
      7403**DCL     11019<<ASSIGN
MADM.V.WRITE#
      7404**DCL     11054<<ASSIGN
MENU
      9824**LABEL   11329--GOTO
MERCER
      7251**DCL     11784<>CALL
MNTERR
     10878**LABEL   10861--CALLALT
MNTRECERR
     10882**LABEL   10869--CALLALT
MODE
      8483**DCL      9716>>IF       9729>>IF       9753<<ASSIGN   9795>>IF       9818>>IF       9820>>IF
     10070>>IF      10439>>IF      10610>>IF      10845>>IF      10853>>IF      10863>>IF      10874>>IF
     10875>>IF      10893>>IF      10910>>IF      11367>>IF      11369>>IF      11371>>IF      11763>>IF
     11777>>IF      11818>>IF      11832>>IF      11870>>IF
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:544  
MOUNT0
     10839**LABEL   10833--GOTO
MOUNT00
     10832**LABEL   10036--GOTO
MOUNT1
     10840**LABEL    9805--GOTO    10031--GOTO    10035--CALLALT
MOVEFIT IN PROCEDURE ERROR
     11582**ENTRY   10462--CALL    10513--CALL    10631--CALL    11293--CALL
NEWPARSE
      9849**LABEL    9951--GOTO    11315--GOTO
NEXT
      9707**LABEL    9707--GOTO     9829--GOTO     9897--GOTO     9901--GOTO    10024--GOTO    10075--GOTO
     10193--GOTO    10196--GOTO    10267--GOTO    10442--GOTO    10455--CALLALT 10610--GOTO    10616--GOTO
     10622--CALLALT 10815--GOTO    10825--CALLALT 10979--CALLALT 10991--CALLALT 11076--GOTO    11085--GOTO
     11111--GOTO    11199--GOTO    11238--GOTO    11331--GOTO    11749--GOTO    11777--GOTO
NOALT
     11777**LABEL    9712--CALLALT  9713--CALLALT  9714--CALLALT  9715--CALLALT  9721--CALLALT  9797--CALLALT
     10017--CALLALT 10049--CALLALT 10077--CALLALT 10087--CALLALT 10449--CALLALT 10481--CALLALT 10487--CALLALT
     10491--CALLALT 10502--CALLALT 10504--CALLALT 10619--CALLALT 10637--CALLALT 10858--CALLALT 10867--CALLALT
     10924--CALLALT 10969--CALLALT 10977--CALLALT 10986--CALLALT 10988--CALLALT 11005--CALLALT 11020--CALLALT
     11102--CALLALT 11105--CALLALT 11106--CALLALT 11152--CALLALT 11161--CALLALT 11172--CALLALT
NOCORE
     11760**LABEL    9836--CALLALT 11314--CALLALT
NOMATCH IN PROCEDURE ERROR
     11548**LABEL   11525--GOTO    11544--GOTO
NOMORE IN PROCEDURE DEFER
     11672**LABEL   11667--CALLALT 11671--CALLALT 11679--CALLALT
NONEMSG
      9608**DCL      9966>>ASSIGN  11043>>IF
NOSEL IN PROCEDURE ERROR
     11550**LABEL   11450--GOTO    11462--GOTO
NOSEL1 IN PROCEDURE ERROR
     11555**LABEL   11554--CALLALT
NOTOWNER
     11748**LABEL   10327--GOTO    10698--GOTO    10785--GOTO    10862--GOTO
NO_DO IN PROCEDURE ERROR
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:545  
     11378**LABEL   11377--CALLALT
NO_EKO IN PROCEDURE ERROR
     11356**LABEL   11344--CALLALT 11346--CALLALT
NUMSNS
      8476**DCL      9958<<ASSIGN  10242<<DOINDEX 10243>>ASSIGN  10308<<ASSIGN  10309>>DOWHILE 10391<<ASSIGN
     10391>>ASSIGN  10530>>CALLBLT 10564>>CALLBLT 10571<<CALLBLT 10572>>CALLBLT 10576>>CALLBLT 10577>>CALL
     10665<<ASSIGN  10665>>ASSIGN  10675>>IF      10688>>ASSIGN  10689>>IF      10697>>IF      10702<<ASSIGN
     10703>>ASSIGN  10708>>ASSIGN  10744>>ASSIGN  10747>>ASSIGN  10751>>DOINDEX 10752>>IF      10757>>ASSIGN
     10759>>ASSIGN  10760>>ASSIGN  10762>>IF      10783<<ASSIGN  10792<<ASSIGN  10792>>ASSIGN  10795>>ASSIGN
     10808>>ASSIGN  11564<<ASSIGN  11570<<CALLBLT 11574>>CALLBLT 11575<<ASSIGN  11575>>ASSIGN
NXTA1 IN PROCEDURE ERROR
     11453**LABEL   11453--CALLALT
NXTACCT IN PROCEDURE ERROR
     11441**ENTRY   10455--CALL    10508--CALL    10613--CALL    11014--CALL    11079--CALL
NXTOPT IN PROCEDURE GET_OPTIONS
     11913**LABEL   11935--GOTO
OCMSG
      7319**DCL     11407<>CALL    11417<>CALL
OCMSG.BUF_.BOUND
      7319**DCL      9702<<ASSIGN
OCMSG.STATION_
      7321**DCL      7321--REDEF
OCMSG.V
      7322**DCL      7319--DCLINIT
OCMSG.V.DVBYTE.VFC#
      7328**DCL      7328--REDEF
OPNACCT
     10461**LABEL   10926--GOTO
OPNDP
      7041**DCL      9746<>CALL    10015<>CALL    10077<>CALL    10087<>CALL    10317<>CALL    10326<>CALL
     10449<>CALL    10461<>CALL    10481<>CALL    10487<>CALL    10502<>CALL    10511<>CALL    10620<>CALL
     10630<>CALL    10637<>CALL    10695<>CALL    10758<>CALL    10780<>CALL    10800<>CALL    10803<>CALL
     10823<>CALL    10861<>CALL    10870<>CALL    10903<>CALL    10924<>CALL    10970<>CALL    10975<>CALL
     10987<>CALL    11072<>CALL    11157<>CALL    11166<>CALL    11243<>CALL    11292<>CALL    11883<>CALL
OPNDP.ACSVEH_
      7043**DCL      7044--REDEF
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:546  
OPNDP.ALTKEYS_
      7049**DCL      7050--REDEF    7050--REDEF
OPNDP.FPARAM_
      7046**DCL      9969<<ASSIGN  10478>>ASSIGN  10618<<ASSIGN  10660<<ASSIGN  10779<<ASSIGN  10854<<ASSIGN
     10892<<ASSIGN  10968<<ASSIGN  10985<<ASSIGN  11122<<ASSIGN  11289<<ASSIGN
OPNDP.HDR_
      7048**DCL      7049--REDEF
OPNDP.IFPARAM_
      7046**DCL      9970<<ASSIGN  10478<<ASSIGN  10479<<ASSIGN  10489<<ASSIGN  11290<<ASSIGN
OPNDP.TAB_
      7047**DCL      7048--REDEF
OPNDP.UHL_
      7041**DCL      7042--REDEF    7042--REDEF
OPNDP.V
      7050**DCL      7041--DCLINIT
OPNDP.V.DELETE#
      7052**DCL     10635<<ASSIGN  10638<<ASSIGN
OPNDP.V.FSN#
      7081**DCL      7081--REDEF    7081--REDEF
OPNDP.V.FUN#
      7060**DCL      9963<<ASSIGN  10315<<ASSIGN  10325<<ASSIGN  10480<<ASSIGN  10694<<ASSIGN  10778<<ASSIGN
     10855<<ASSIGN  10974<<ASSIGN  11071<<ASSIGN  11151<<ASSIGN  11882<<ASSIGN
OPNDP.WSN_
      7047**DCL      7047--REDEF
OPNFIL
      7644**DCL     11161<>CALL
OPNFIL.ACSVEH_
      7646**DCL      7647--REDEF
OPNFIL.ALTKEYS_
      7652**DCL      7653--REDEF    7653--REDEF
OPNFIL.HDR_
      7651**DCL      7652--REDEF
OPNFIL.TAB_
      7650**DCL      7651--REDEF
OPNFIL.UHL_
      7644**DCL      7645--REDEF    7645--REDEF
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:547  
OPNFIL.V
      7653**DCL      7644--DCLINIT
OPNFIL.V.FSN#
      7684**DCL      7684--REDEF    7684--REDEF
OPNFIL.V.FUN#
      7663**DCL     11150<<ASSIGN  11154<<ASSIGN
OPNFIL.WSN_
      7650**DCL      7650--REDEF
OPNSN
      6954**DCL      7041--DCLINIT  7403--DCLINIT  7534--DCLINIT  7644--DCLINIT 11878<<ASSIGN
OPNSN.SN#
      6954**DCL      9971<<ASSIGN   9975<<ASSIGN  10034<<ASSIGN  10050<<ASSIGN  10051>>IF      10052>>IF
     10057>>DOWHILE 10061>>IF      10061>>IF      10061>>IF      10061>>IF      10061>>IF      10067>>CALLBLT
     10068<<CALLBLT 10073>>ASSIGN  10078>>IF      10079<<ASSIGN  10086<<CALLBLT 10188>>IF      10193>>IF
     10209>>ASSIGN  10281>>ASSIGN  10287<<CALLBLT 10310>>IF      10310>>IF      10311<<ASSIGN  10312>>IF
     10316<<ASSIGN  10322<<ASSIGN  10327>>IF      10370>>IF      10371>>IF      10439>>IF      10500>>IF
     10505>>ASSIGN  10628>>IF      10659<<ASSIGN  10659>>ASSIGN  10674<<ASSIGN  10674>>ASSIGN  10678>>IF
     10683<<ASSIGN  10692<<ASSIGN  10700<<ASSIGN  10710>>ASSIGN  10757<<ASSIGN  10784<<ASSIGN  10784>>ASSIGN
     10785>>IF      10798<<ASSIGN  10798>>ASSIGN  10799<<ASSIGN  10802<<ASSIGN  10802>>ASSIGN  10811>>IF
     10811>>IF      10820<<ASSIGN  10822<<ASSIGN  10822>>ASSIGN  10833>>IF      10838>>ASSIGN  10844<<ASSIGN
     10896>>IF      11008<<ASSIGN  11011<<ASSIGN  11017>>IF      11018<<ASSIGN  11022<<ASSIGN  11023<<ASSIGN
     11031<>CALL    11039>>CALLBLT 11061<<ASSIGN  11070<<ASSIGN  11127>>IF      11129<<CALLBLT 11132--CALLBLT
     11134<<CALLBLT 11241<<ASSIGN  11242<<ASSIGN  11286<<ASSIGN  11398>>ASSIGN  11543>>IF      11692>>IF
     11703--ASSIGN  11705>>IF      11723>>IF      11723>>IF      11724>>ASSIGN  11733>>IF      11734>>ASSIGN
     11831>>CALLBLT 11881>>IF
OPNXTA
      7534**DCL     10858<>CALL    11453<>CALL    11554<>CALL
OPNXTA.ACSVEH_
      7536**DCL      7537--REDEF
OPNXTA.ALTKEYS_
      7542**DCL      7543--REDEF    7543--REDEF
OPNXTA.HDR_
      7541**DCL      7542--REDEF
OPNXTA.TAB_
      7540**DCL      7541--REDEF
OPNXTA.UHL_
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:548  
      7534**DCL      7535--REDEF    7535--REDEF
OPNXTA.V
      7543**DCL      7534--DCLINIT
OPNXTA.V.FSN#
      7574**DCL      7574--REDEF    7574--REDEF
OPNXTA.V.SETDCB#
      7544**DCL     11553<<ASSIGN  11555<<ASSIGN
OPNXTA.WSN_
      7540**DCL      7540--REDEF
OUT$BLK
      8323**DCL      9736--ASSIGN   9737--ASSIGN
OUT$BLK.CODE
      8331**DCL      9862<<ASSIGN   9864<<ASSIGN   9865<<ASSIGN   9869<<ASSIGN   9870<<ASSIGN   9872<<ASSIGN
      9873<<ASSIGN   9875<<ASSIGN   9877<<ASSIGN   9880<<ASSIGN   9899<<ASSIGN   9974>>IF       9982>>ASSIGN
      9983>>ASSIGN  10052>>IF      10060>>IF      10285>>IF      10286>>IF      10438>>IF      10453>>IF
     10611>>IF      10649>>IF      10841>>ASSIGN  10905>>ASSIGN  10922>>ASSIGN  10932>>ASSIGN  11128>>IF
     11140>>IF      11144>>ASSIGN  11145>>IF      11916>>DOCASE  12046>>DOWHILE 12047>>IF      12049>>ASSIGN
     12052>>IF      12052>>IF
OUT$BLK.CPOS
      8349**DCL     10056>>ASSIGN  11757>>ASSIGN  12052>>IF      12052>>IF
OUT$BLK.NDTYPE
      8326**DCL     10291>>IF      10662>>IF      10746>>IF
OUT$BLK.NSUBLKS
      8335**DCL      9734<<ASSIGN   9973>>IF      10050>>IF      10283>>DOWHILE 10469>>DOWHILE 10506>>IF
     10616>>IF      10648>>IF      10661>>DOWHILE 10668>>DOWHILE 10745>>IF      10788>>DOWHILE 10841>>IF
     10905>>IF      10925>>IF      10931>>IF      10950>>DOWHILE 11009>>IF      11064>>IF      11134>>IF
     11139>>DOWHILE 11180>>IF      11297>>DOWHILE 12038>>DOINDEX 12061>>DOWHILE
OUT$BLK.SUBLK$
      8356**DCL      9735<<ASSIGN   9736<<ASSIGN   9737<<ASSIGN   9738>>ASSIGN   9739>>ASSIGN   9863>>ASSIGN
      9863>>ASSIGN   9864>>ASSIGN   9865>>ASSIGN   9870>>ASSIGN   9873>>ASSIGN   9878>>IF       9878>>IF
      9879>>ASSIGN   9879>>ASSIGN   9880>>ASSIGN   9974>>IF       9975>>ASSIGN   9975>>ASSIGN   9983>>ASSIGN
     10050>>ASSIGN  10050>>ASSIGN  10052>>IF      10056>>ASSIGN  10060>>IF      10284>>ASSIGN  10287>>CALLBLT
     10287>>CALLBLT 10438>>IF      10444>>ASSIGN  10444>>ASSIGN  10453>>IF      10507>>ASSIGN  10507>>ASSIGN
     10611>>IF      10629>>ASSIGN  10629>>ASSIGN  10649>>IF      10662>>IF      10743>>CALLBLT 10743>>CALLBLT
     10746>>IF      10747>>ASSIGN  10747>>ASSIGN  10841>>ASSIGN  10905>>ASSIGN  10922>>ASSIGN  10932>>ASSIGN
     11010>>IF      11011>>ASSIGN  11011>>ASSIGN  11012>>ASSIGN  11012>>ASSIGN  11064>>ASSIGN  11064>>ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:549  
     11065>>ASSIGN  11066>>ASSIGN  11066>>ASSIGN  11082>>IF      11082>>IF      11083>>IF      11083>>IF
     11128>>IF      11129>>CALLBLT 11129>>CALLBLT 11132>>CALLBLT 11132>>CALLBLT 11134>>CALLBLT 11134>>CALLBLT
     11140>>IF      11141>>ASSIGN  11141>>ASSIGN  11142>>ASSIGN  11142>>ASSIGN  11142>>ASSIGN  11142>>ASSIGN
     11144>>ASSIGN  11145>>IF      11146>>ASSIGN  11146>>ASSIGN  11181>>ASSIGN  11181>>ASSIGN  11182>>ASSIGN
     11182>>ASSIGN  11196>>ASSIGN  11197>>ASSIGN  11286>>ASSIGN  11286>>ASSIGN  11757>>ASSIGN  11915>>ASSIGN
     11950>>CALLBLT 11950>>CALLBLT 11975>>CALLBLT 11975>>CALLBLT 12040>>ASSIGN  12040>>ASSIGN  12041>>ASSIGN
     12041>>ASSIGN  12046>>DOWHILE 12047>>IF      12049>>ASSIGN  12052>>IF      12052>>IF      12052>>IF
     12052>>IF      12063>>ASSIGN  12063>>ASSIGN  12091<<ASSIGN  12091>>ASSIGN
OUT$SYM
      8369**DCL      9733<<ASSIGN
OUT$SYM.CODE
      8375**DCL     11010>>IF      11065>>ASSIGN
OUT$SYM.COUNT
      8392**DCL      8395--IMP-SIZ  9732<<ASSIGN   9733>>ASSIGN   9738<<ASSIGN   9739<<ASSIGN   9863>>ASSIGN
      9878>>IF       9879>>ASSIGN   9975>>ASSIGN  10050>>ASSIGN  10287>>CALLBLT 10291>>ASSIGN  10294>>CALLBLT
     10444>>ASSIGN  10507>>ASSIGN  10629>>ASSIGN  10743>>CALLBLT 10747>>ASSIGN  11011>>ASSIGN  11012>>ASSIGN
     11064>>ASSIGN  11066>>ASSIGN  11082>>IF      11083>>IF      11129>>CALLBLT 11132>>CALLBLT 11134>>CALLBLT
     11141>>ASSIGN  11142>>ASSIGN  11146>>ASSIGN  11181>>ASSIGN  11182>>ASSIGN  11196--ASSIGN  11242>>ASSIGN
     11286>>ASSIGN  11950>>CALLBLT 11975>>CALLBLT 12040>>ASSIGN  12041>>ASSIGN  12063>>ASSIGN
OUT$SYM.CPOS
      8384**DCL     11197>>ASSIGN
OUT$SYM.TEXT
      8395**DCL      9863<<ASSIGN   9878>>IF       9879<<ASSIGN   9975>>ASSIGN  10050>>ASSIGN  10287>>CALLBLT
     10291>>ASSIGN  10294>>CALLBLT 10444>>ASSIGN  10507>>ASSIGN  10629>>ASSIGN  10743>>CALLBLT 10747>>ASSIGN
     11011>>ASSIGN  11012>>ASSIGN  11064>>ASSIGN  11066>>ASSIGN  11082>>IF      11083>>IF      11129>>CALLBLT
     11132>>CALLBLT 11134>>CALLBLT 11142>>ASSIGN  11146>>ASSIGN  11181>>ASSIGN  11182>>ASSIGN  11242>>ASSIGN
     11286>>ASSIGN  11950>>CALLBLT 11975>>CALLBLT 12040>>ASSIGN  12041>>ASSIGN  12063>>ASSIGN
P$
      8463**DCL      4644--IMP-PTR 10239<<ASSIGN  10240>>DOWHILE 10241>>ASSIGN  10242>>DOINDEX 10243>>ASSIGN
     10246<<ASSIGN  10246>>ASSIGN  10284<<ASSIGN  10285>>IF      10286>>IF      10291>>IF      10291>>ASSIGN
     10291>>ASSIGN  10294>>CALLBLT 10294>>CALLBLT 11915<<ASSIGN  11916>>DOCASE  12038>>DOINDEX 12040>>ASSIGN
     12040>>ASSIGN  12041>>ASSIGN  12041>>ASSIGN  12046>>DOWHILE 12047>>IF      12049>>ASSIGN  12052>>IF
     12052>>IF      12052>>IF      12052>>IF      12061>>DOWHILE 12063>>ASSIGN  12063>>ASSIGN  12091>>ASSIGN
P$ IN PROCEDURE ADDPART
     11788**DCL     11790--IMP-PTR 11794--IMP-PTR 11797<<ASSIGN  11801<<ASSIGN  11802<<ASSIGN  11802>>ASSIGN
     11802>>ASSIGN  11803>>CALLBLT 11804>>CALLBLT 11804>>CALLBLT 11805>>CALLBLT 11807>>CALLBLT 11807>>CALLBLT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:550  
     11810<<ASSIGN  11812>>ASSIGN  11814>>DOWHILE 11821>>IF      11823<<ASSIGN  11823>>ASSIGN  11826>>CALLBLT
P$PCB.ERROR
      9060**DCL     11278>>IF
P$PCB.OUT$
      8969**DCL     11276>>ASSIGN  11277<<ASSIGN  11283>>ASSIGN  11301>>ASSIGN
P$PCB.TEXT$
      8957**DCL     11296>>ASSIGN
PADBUF
      9515**DCL      9704--ASSIGN   9961--ASSIGN  10728--ASSIGN  10956--ASSIGN
PADBUF.AVAIL
      9516**DCL     10721<<ASSIGN
PADBUF.FCEX
      9516**DCL     10718<<ASSIGN  10720>>ASSIGN  10723>>ASSIGN  10729>>ASSIGN
PADBUF.NAVX
      9515**DCL     10720<<ASSIGN  10721>>ASSIGN
PARM
         7**DCL         6--PROC    11240--ENTRY   11241--ASSIGN  11254--ENTRY   11255--IF      11260--ENTRY
     11263--ENTRY   11266--ENTRY   11275--ENTRY   11276--ASSIGN  11277--ASSIGN  11278--IF      11283--ASSIGN
     11296--ASSIGN  11301--ASSIGN
PARM.P$
         9**DCL     11242>>ASSIGN  11242>>ASSIGN  11261>>CALL    11267--ASSIGN
PARM.U
         8**DCL     11241>>IF      11256<>CALL    11261<>CALL    11264<>CALL    11268<>CALL
PARSERR
     11312**LABEL    9855--CALLALT 10070--GOTO    11207--GOTO
PIGST
      7376**DCL      7352--DCLINIT
PIGST.MSGIDXT
      7386**DCL      7389--REDEF
PPRIVFPT
      7742**DCL      9687<>CALL    11179<>CALL    11604<>CALL
PPRIVFPT.V
      7742**DCL      7742--DCLINIT
PPRIVFPT.V.PRIV#
      7742**DCL     11605>>ASSIGN
PRIVFPT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:551  
      7726**DCL      9712<>CALL     9990<>CALL    10451<>CALL    10491<>CALL    10504<>CALL    10977<>CALL
     10988<>CALL    11005<>CALL    11105<>CALL    11152<>CALL    11288<>CALL    11606<>CALL    11609<>CALL
PRIVFPT.V
      7726**DCL      7726--DCLINIT
PRIVFPT.V.PRIV#
      7726**DCL      9989<<ASSIGN   9991<<ASSIGN  11287<<ASSIGN  11605<<ASSIGN  11607<<ASSIGN  11608<<ASSIGN
     11610<<ASSIGN
PROJAD.ACCT
      8934**DCL      9692<<ASSIGN   9929<<ASSIGN  11181<<ASSIGN
PROJAD.L
      8933**DCL      9694>>IF       9696>>IF       9715>>IF       9722<<ASSIGN   9984>>IF      10449>>IF
     10474>>IF      10482>>IF      10493>>IF      10512>>IF      10616>>IF      10633>>IF      10640>>IF
     10998>>IF      11022>>IF      11177<<ASSIGN  11185>>IF      11187>>IF      11188>>IF      11452>>IF
     11543>>IF      11556>>IF      11614<<ASSIGN
PROJAD.NAME
      8935**DCL      9691<<ASSIGN   9928<<ASSIGN  11182<<ASSIGN
PROJAD.PSN
      8936**DCL      9697>>CALLBLT 10998>>IF      11023>>ASSIGN  11189>>CALLBLT
PROJADC
      8931**DCL      9985>>CALLBLT
PROJADCU
      8927**DCL      8931--REDEF
PRTXT
      8047**DCL      8041--DCLINIT
P_PCB
      8066**DCL      9826<>CALL     9855<>CALL    10492<>CALL    10639<>CALL
P_PCB.ERROR
      8170**DCL     11202<<ASSIGN
P_PCB.ERROR.CODE
      8178**DCL     11312>>ASSIGN  11317<<ASSIGN  11324>>ASSIGN  11756<<ASSIGN
P_PCB.HI_CHAR
      8217**DCL      9823>>IF       9825>>CALLBLT 10056<<ASSIGN  11206<<ASSIGN  11319>>IF      11320>>ASSIGN
     11321>>CALLBLT 11321>>CALLBLT 11321>>CALLBLT 11323>>IF      11328>>IF      11328>>IF      11757<<ASSIGN
P_PCB.NCHARS
      8213**DCL      9823>>IF       9827<<ASSIGN   9849<<ASSIGN   9851>>ASSIGN   9918<<ASSIGN  11319>>IF
     11321>>CALLBLT 11328>>IF      11330<<ASSIGN  11330>>ASSIGN  11351>>IF      11352>>ASSIGN  11775<<ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:552  
P_PCB.NXT
      8116**DCL      9824<<ASSIGN   9828<<ASSIGN
P_PCB.OUT$
      8079**DCL      9856>>ASSIGN
P_PCB.TEXT$
      8067**DCL      9706<<ASSIGN   9825>>CALLBLT  9845>>IF       9851>>ASSIGN   9949<<ASSIGN  11277>>ASSIGN
     11283<<ASSIGN  11296<<ASSIGN  11301<<ASSIGN  11321>>CALLBLT 11321>>CALLBLT 11328>>IF      11352>>ASSIGN
P_PCB.WKSZ
      8096**DCL      9853<<ASSIGN
P_PCB.WORK$
      8075**DCL      9851<<ASSIGN   9852<<ASSIGN   9852>>ASSIGN   9853>>ASSIGN
P_TO_S
      9189**DCL      9719--ASSIGN
P_TO_S.COUNT
      9191**DCL      9719>>ASSIGN  11385>>IF      11385<<ASSIGN  11387>>CALLBLT 11389<<ASSIGN  11389>>ASSIGN
P_TO_S.ERR
      9190**DCL     11390<<ASSIGN  11391<<ASSIGN  11392<<ASSIGN
P_TO_S.TEXT
      9194**DCL      9719--ASSIGN  11387--CALLBLT
RCNSN
      8460**DCL     11878>>ASSIGN
READCAT
      7186**DCL     11422<>CALL
READCAT.STATION_
      7189**DCL      7190--REDEF
READCAT.V
      7190**DCL      7186--DCLINIT
READCAT.V.DCB#
      7190**DCL     11424--ASSIGN
READCAT.V.DVBYTE.REREAD#
      7201**DCL      7201--REDEF
READCAT.V.INDX#
      7199**DCL      7199--REDEF
READVID
      7428**DCL     10017<>CALL    10318<>CALL    10328<>CALL    10389<>CALL    10483<>CALL    10696<>CALL
     10711<>CALL    10716<>CALL    10732<>CALL    10735<>CALL    10761<>CALL    10781<>CALL    10805<>CALL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:553  
     10809<>CALL    11074<>CALL    11244<>CALL
READVID.BUF_
      7430**DCL      9969>>ASSIGN  11289>>ASSIGN
READVID.STATION_
      7431**DCL      7432--REDEF
READVID.V
      7432**DCL      7428--DCLINIT
READVID.V.DVBYTE.REREAD#
      7443**DCL      7443--REDEF
READVID.V.INDX#
      7441**DCL      7441--REDEF
RECONERE IN PROCEDURE ADDPART
     11869**ENTRY   10990--CALL    11174--CALL
RECONERR IN PROCEDURE ADDPART
     11870**LABEL   11863--CALLALT 11888--CALLALT
RECONERR0 IN PROCEDURE ADDPART
     11867**LABEL   11883--CALLALT
RECONST IN PROCEDURE ADDPART
     11830**ENTRY   10484--CALL    10824--CALL    10869--CALL    10978--CALL
RECONXIT IN PROCEDURE ADDPART
     11864**LABEL   11889--GOTO
RELPIGCG
      9448**DCL     11649<>CALL
RELPIGCG.SN_
      9448**DCL      9448--REDEF
RELPIGCG.UTL_
      9449**DCL      9449--REDEF
RELPIGCG.V
      9453**DCL      9448--DCLINIT
RELPIGCG.V.EXPIRE#
      9463**DCL      9463--REDEF
RELPIGCG.V.TYPE#
      9461**DCL      9461--REDEF
RELPIGCG.V.XTNSIZE#
      9458**DCL      9458--REDEF    9460--REDEF
RELPIGFIL
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:554  
      9381**DCL     11645<>CALL    11647<>CALL
RELPIGFIL.ACSVEH_
      9383**DCL      9384--REDEF
RELPIGFIL.ALTKEYS_
      9389**DCL      9390--REDEF    9390--REDEF
RELPIGFIL.HDR_
      9388**DCL      9389--REDEF
RELPIGFIL.TAB_
      9387**DCL      9388--REDEF
RELPIGFIL.UHL_
      9381**DCL      9382--REDEF    9382--REDEF
RELPIGFIL.V
      9390**DCL      9381--DCLINIT
RELPIGFIL.V.ASN#
      9400**DCL     11644<<ASSIGN  11646<<ASSIGN
RELPIGFIL.V.FSN#
      9421**DCL      9421--REDEF    9421--REDEF
RELPIGFIL.WSN_
      9387**DCL      9387--REDEF
RESTART
      9956**LABEL    9955--REMEMBR
RETALT IN PROCEDURE ERROR
     11438**LABEL   11430--CALLALT 11463--CALLALT
RETALT IN PROCEDURE GET_OPTIONS
     12086**LABEL   12039--GOTO    12062--GOTO
RVIDALT
     11249**LABEL   11243--CALLALT 11244--CALLALT
SAVUNW
      8475**DCL      9791>>ASSIGN   9792>>ASSIGN   9816<<ASSIGN
SELACCT
      8014**DCL      9965<<ASSIGN  10444<<ASSIGN  10507<<ASSIGN  10921<<ASSIGN  11012>>IF      11012<<ASSIGN
     11027>>IF      11064<<ASSIGN  11066<<ASSIGN  11067>>IF      11081>>IF      11085>>IF      11442>>CALLBLT
     11444>>CALLBLT 11445>>IF      11448<<ASSIGN  11490>>ASSIGN  11506--ASSIGN  11513--DOWHILE 11513>>DOWHILE
     11515--IF      11515>>IF      11520--IF      11520>>IF      11524--IF      11537--IF      11545<<ASSIGN
     11546>>IF      11546<<ASSIGN  11550>>ASSIGN  11551>>IF      11552<<ASSIGN
SETSAD
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:555  
      7918**DCL      9713<>CALL    10048<>CALL
SETSAD.V
      7918**DCL      7918--DCLINIT
SETSUP
      9923**LABEL    9921--GOTO
SET_PRIV IN PROCEDURE ERROR
     11603**ENTRY    9689--CALL     9694--CALL     9723--CALL    11173--CALL    11185--CALL
SIERR
     11757**LABEL    9808--CALLALT  9812--CALLALT
ST
      9211**DCL      9717--ASSIGN
ST.MSGIDXT
      9221**DCL      9224--REDEF
ST.MSGTYP#
      9215**DCL      9859>>IF
ST.STATION#
      9215**DCL      9720>>IF
S_TO_P
      9157**DCL      9912--IF       9915<<ASSIGN   9915>>ASSIGN   9918--ASSIGN   9918--ASSIGN
S_TO_P.ACCT
      9178**DCL      9945<<ASSIGN
S_TO_P.ATTR.COUNT
      9180**DCL      9183--IMP-SIZ  9912>>IF       9913<<ASSIGN   9914<<ASSIGN   9914>>ASSIGN   9915>>ASSIGN
      9915>>ASSIGN   9918>>ASSIGN   9935<<ASSIGN
S_TO_P.PACKSET
      9177**DCL      9920>>IF       9933>>ASSIGN   9934<<ASSIGN  11632>>ASSIGN
S_TO_P.PROJ
      9166**DCL      9927>>IF
S_TO_P.PROJECT
      9173**DCL      9176--REDEF    9918--ASSIGN   9949--ASSIGN
S_TO_P.PROJECT.ACCT
      9174**DCL      9929>>ASSIGN   9938<<ASSIGN   9940<<ASSIGN   9942<<ASSIGN   9947<<ASSIGN
S_TO_P.PROJECT.UNAME
      9175**DCL      9928>>ASSIGN   9933<<ASSIGN
S_TO_P.PROJECT_TEXT
      9176**DCL      9944<<ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:556  
S_TO_P.SUPER
      9169**DCL      9172--REDEF
S_TO_P.SUPER.ACCT
      9170**DCL      9925>>ASSIGN
S_TO_P.SUPER.UNAME
      9171**DCL      9926>>ASSIGN
S_TO_P.TYPE
      9158**DCL      9936>>DOCASE  11624>>IF      11625>>IF
S_TO_P.WIDTH
      9168**DCL      9950>>ASSIGN
TCXT
      8005**DCL      7266--DCLINIT  9604--DCLINIT  9811<<ASSIGN   9819>>IF       9823>>IF       9833>>IF
      9837>>ASSIGN   9911--IF       9912--IF       9912--IF       9912--IF       9913--ASSIGN   9913--ASSIGN
      9914--ASSIGN   9915--ASSIGN   9915--ASSIGN   9917--ASSIGN  10530<<CALLBLT 10530>>CALLBLT 10531<>CALL
     10564<<CALLBLT 10568<>CALL    10569<<CALLBLT 10571>>CALLBLT 10572<<CALLBLT 10573<>CALL    10576<<CALLBLT
     10577<>CALL    10582<<CALLBLT 10585<>CALL    10586<<CALLBLT 10587<>CALL    10588<<CALLBLT 10591>>CALLBLT
     10592<<CALLBLT 10593<>CALL    11222<<ASSIGN  11233>>IF      11351>>IF      11352<<ASSIGN  11353>>DOWHILE
     11356>>IF      11357<<ASSIGN  11563<<ASSIGN  11569<<CALLBLT 11570>>CALLBLT 11574<<CALLBLT 11578>>IF
     11578<<CALLBLT 11579>>IF      11579<<CALLBLT 11717<<CALLBLT 11718<<CALLBLT 11721<<CALLBLT 11721>>CALLBLT
     11724<<ASSIGN  11760<<ASSIGN  11763--IF      11773>>IF      11852<<ASSIGN  11884<<ASSIGN
TEXT
      8004**DCL      8005--REDEF    8006--REDEF    8011--REDEF    8266--DCLINIT  8267--DCLINIT  8304--DCLINIT
      8305--DCLINIT
TEXT IN PROCEDURE ADDPART
     11789**DCL     11786--PROC    11797--ASSIGN
THING IN PROCEDURE ADDPART
     11790**DCL     11802--ASSIGN
THING.L IN PROCEDURE ADDPART
     11791**DCL     11802>>ASSIGN  11812>>ASSIGN
THING.T IN PROCEDURE ADDPART
     11792**DCL     11814>>DOWHILE 11821>>IF      11826>>CALLBLT
TIME$
      7963**DCL     10599>>ASSIGN
TIMEFPT
      7933**DCL     10726<>CALL
TIMEFPT.V
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:557  
      7937**DCL      7933--DCLINIT
TIMES
      7961**DCL     10598>>ASSIGN
TIMETEXT.B
      9663**DCL     10603<<CALLBLT 10604>>CALLBLT 10605<<CALLBLT
TIMETEXT.D
      9662**DCL      7953--DCLINIT  7954--DCLINIT
TIMETEXT.T
      9661**DCL      7955--DCLINIT  7956--DCLINIT
TIMETEXT.TYP
      9660**DCL     10598<<ASSIGN
TIMEUTS
      8457**DCL      7937--DCLINIT  7957--DCLINIT 10559<<ASSIGN  10560>>DOINDEX 10563>>IF      10565>>DOWHILE
     10580<<ASSIGN  10581>>IF      10590>>IF      10599<<ASSIGN  10601>>IF      10727>>ASSIGN
TIME_TEXT
      7953**DCL     10600<>CALL
TIME_TEXT.V
      7957**DCL      7953--DCLINIT
TOOMANY
     11752**LABEL   10295--GOTO    10298--GOTO    10355--GOTO    10470--CALLALT 10669--CALLALT 10951--CALLALT
TRAPCNT
      8462**DCL      9956<<ASSIGN  10197<<ASSIGN  10269<<ASSIGN  11693>>IF      11694<<ASSIGN  11694>>ASSIGN
     11733--IF      11734--ASSIGN
TRAPX
      8461**DCL      9955<<REMEMBR 10091<<REMEMBR 10204<<REMEMBR
UNCMD
      9606**DCL      9604--DCLINIT
UNDEFER IN PROCEDURE DEFER
     11662**ENTRY   10875--CALL
UNDEFER0 IN PROCEDURE DEFER
     11658**LABEL   11659--GOTO
UNDEFER1 IN PROCEDURE DEFER
     11657**ENTRY    9720--CALL
USER_ACCN
      8481**DCL      9682<<ASSIGN   9925<<ASSIGN
USER_NAME
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:558  
      8480**DCL      9681<<ASSIGN   9926<<ASSIGN
USW
      8015**DCL      9788<<ASSIGN   9833>>IF       9838<<ASSIGN   9838>>ASSIGN   9854<<ASSIGN  11445>>IF
     11545>>IF
V IN PROCEDURE ADDPART
     11794**DCL     11803<<CALLBLT 11804<<CALLBLT 11804>>CALLBLT 11805>>CALLBLT 11807<<CALLBLT 11807>>CALLBLT
VALERR
     11317**LABEL   11758--GOTO
VALMSG
      9615**DCL      9604--DCLINIT
VALMSG.T
      9617**DCL     11325<<ASSIGN
VID1
      9596**DCL     10280<<ASSIGN  10320<<ASSIGN  10339>>ASSIGN  10368>>ASSIGN  10782<<ASSIGN
VID1.DGT
      9598**DCL     10365<<ASSIGN
VID1.DTT
      9598**DCL      9598--REDEF   10364<<ASSIGN
VID1.PSN
      9596**DCL     10281<<ASSIGN  10282>>IF      10806>>ASSIGN
VID1.SECTSTRT
      9597**DCL     10299<<ASSIGN  10299>>ASSIGN  10300<<ASSIGN  10300>>ASSIGN  10340<<ASSIGN  10342>>IF
     10344>>DOWHILE 10344>>DOWHILE 10346>>IF      10346>>IF      10346>>IF      10349<<ASSIGN  10352>>IF
     10357>>IF      10357>>IF      10358<<ASSIGN  10359>>ASSIGN  10359>>ASSIGN  10363>>ASSIGN
VID1.SNLIST
      9599**DCL     10311--ASSIGN  10319>>ASSIGN  10333<<ASSIGN  10334<<ASSIGN  10391>>IF      10701<<ASSIGN
     10709>>ASSIGN  10807>>ASSIGN
VID1.SNLIST.SIZE
      9599**DCL     10301<<ASSIGN  10353>>ASSIGN  10359<<ASSIGN  10360>>IF      10371>>IF      10390>>ASSIGN
     10759<<ASSIGN  10812>>ASSIGN
VID1.SNLIST.TYPE
      9599**DCL     10760<<ASSIGN
VID1.SNLIST.VSN
      9599**DCL     10331>>IF      10692--ASSIGN  10744<<ASSIGN  10752>>IF      10752>>IF      10757--ASSIGN
     10799--ASSIGN
VID1.SNLIST.VSN.N
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:559  
      9599**DCL     10296<<ASSIGN  10337>>ASSIGN
VID1.SNLIST.VSN.S
      9599**DCL     10291<<ASSIGN  10322>>ASSIGN  10338>>IF      10747<<ASSIGN  10762>>IF
VID1.VOLCNT
      9596**DCL     10812>>ASSIGN
VID1.VSN
      9596**DCL     10366<<ASSIGN
VIDBUF
      9580**DCL      7430--DCLINIT  7431--DCLINIT  9585--REDEF    9587--REDEF   10320>>ASSIGN  10330<>CALL
     10339<<ASSIGN  10368<<ASSIGN  10450<<ASSIGN  10512<<ASSIGN  10699<>CALL    10715<<ASSIGN  10728<<ASSIGN
     10733<<ASSIGN  10770<>CALL    10782>>ASSIGN  11073<<ASSIGN
VIDBUF.DGT
      9582**DCL     10365>>ASSIGN
VIDBUF.DGT.FGRAN
      9582**DCL     10346>>IF
VIDBUF.DGT.LGRAN
      9582**DCL     10346>>IF      10349>>ASSIGN
VIDBUF.DTT
      9582**DCL      9582--REDEF   10346>>IF      10364>>ASSIGN
VIDBUF.ID
      9580**DCL     10388<<ASSIGN
VIDBUF.PSN
      9580**DCL     10036>>IF      10700>>ASSIGN  10710<<ASSIGN  10806<<ASSIGN
VIDBUF.SECTSTRT
      9581**DCL     10363<<ASSIGN  10370<<ASSIGN  10371>>IF      10373>>IF      10373>>IF      10762>>IF
     10762>>IF
VIDBUF.SNLIST
      9583**DCL     10319<<ASSIGN  10333>>ASSIGN  10701>>ASSIGN  10709<<ASSIGN  10807<<ASSIGN
VIDBUF.SYSSIZE
      9580**DCL     10387<<ASSIGN
VIDBUF.VOLCNT
      9580**DCL     10021<<ASSIGN  10332>>IF      10334>>ASSIGN  10386<<ASSIGN  10702>>ASSIGN  10708<<ASSIGN
     10783>>ASSIGN  10808<<ASSIGN
VIDBUF.VSN
      9580**DCL     10294<<CALLBLT 10295>>IF      10296>>ASSIGN  10298>>IF      10298>>IF      10299>>ASSIGN
     10337<<ASSIGN  10366>>ASSIGN
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:560  
VLP_ACCT
      6967**DCL      7046--DCLINIT  7402--DCLINIT  7539--DCLINIT  7649--DCLINIT 10633<>CALL    10857<<ASSIGN
     11463<>CALL
VLP_ACCT.ACCT#
      6967**DCL      9964<<ASSIGN  10445>>ASSIGN  10446<<ASSIGN  10452<<ASSIGN  10537>>IF      10629<<ASSIGN
     11029<>CALL    11039>>CALLBLT 11090>>CALLBLT 11121<<ASSIGN  11146<<ASSIGN  11291<<ASSIGN  11443>>IF
     11444<<CALLBLT 11446--ASSIGN  11446--ASSIGN  11456>>IF      11460<<ASSIGN  11513--DOWHILE 11513>>DOWHILE
     11520--IF      11520>>IF      11524--IF      11550<<ASSIGN
VLP_NAME
      7713**DCL      7645--DCLINIT  9972<<ASSIGN  11162>>IF
VLP_NAME.L#
      7713**DCL     11141<<ASSIGN
VLP_NAME.NAME#
      7713**DCL     11142<<ASSIGN
VOLERR
     11692**LABEL   10317--CALLALT 10326--CALLALT 10695--CALLALT 10758--CALLALT 10801--GOTO    10803--CALLALT
WAIT1
      7848**DCL      9727<>CALL     9783<>CALL    10014<>CALL    10398<>CALL    10911<>CALL    11695<>CALL
     11735<>CALL
WAIT1.V
      7849**DCL      7848--DCLINIT
WAIT4KEYIN
      9783**LABEL    9764--CALLALT  9778--CALLALT
WBUF
      9585**DCL     10729<<ASSIGN  10731--ASSIGN  11587--ASSIGN
WIDTH
      8486**DCL      9903<<ASSIGN   9950<<ASSIGN  11035>>IF      11086>>IF      11369<<ASSIGN  11370>>IF
     11370>>IF      11370<<ASSIGN  11405<<ASSIGN  11817>>IF
WILD_XC IN PROCEDURE ERROR
     11336**DCL     11490<<ASSIGN
WORKFPT
      8411**DCL      9683<>CALL     9836<>CALL    11314<>CALL
WORKFPT.V
      8411**DCL      8411--DCLINIT
WORK_
      8016**DCL      8411--DCLINIT
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:561  
WORK_.FIRST$
      8018**DCL      9683>>IF       9706>>ASSIGN   9716>>IF       9731>>ASSIGN   9786>>ASSIGN   9835>>IF
      9842>>IF       9845>>ASSIGN   9849>>ASSIGN   9853>>ASSIGN   9861>>ASSIGN   9931>>ASSIGN  11383>>IF
     11384>>ASSIGN  11665>>ASSIGN  11764>>ASSIGN
WORK_.SIZE
      8017**DCL      9835>>IF       9853>>ASSIGN
WRAVR
      7350**DCL      9764<>CALL     9778<>CALL     9888<>CALL
WRAVR.STATION_
      7352**DCL      7352--REDEF
WRAVR.V
      7353**DCL      7350--DCLINIT
WRAVR.V.DVBYTE.VFC#
      7359**DCL      7359--REDEF
WRITECAT
      7225**DCL     11430<>CALL
WRITECAT.BUF_.BOUND
      7225**DCL     11429<<ASSIGN
WRITECAT.STATION_
      7227**DCL      7227--REDEF
WRITECAT.V
      7228**DCL      7225--DCLINIT
WRITECAT.V.DVBYTE.VFC#
      7234**DCL      7234--REDEF
WROC
      9626**DCL      7320--DCLINIT  7321--DCLINIT  9702--ASSIGN
WROC.CADDR
      9627**DCL      9802<<ASSIGN   9866<<ASSIGN  10863>>IF      11396>>IF      11396<<ASSIGN  11400<<ASSIGN
     11401>>IF      11416<<ASSIGN  11877<<ASSIGN
WROC.DEVNM
      9636**DCL     10018<<ASSIGN  10067<<CALLBLT 10068>>CALLBLT 10088<<ASSIGN  10094>>ASSIGN
WROC.DPSN
      9644**DCL     10109<<ASSIGN  10113<<ASSIGN  10136>>IF      10138<>CALL
WROC.FLAGS
      9633**DCL      9634--REDEF
WROC.MSG#
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:562  
      9628**DCL      9726>>DOWHILE  9795>>IF       9977<<ASSIGN  10072<<ASSIGN  10092<<ASSIGN  10188<<ASSIGN
     10206<<ASSIGN  11402>>IF      11415<<ASSIGN  11731<<ASSIGN  11835<<ASSIGN
WROC.MSGID
      9629**DCL      9630--REDEF
WROC.N
      9641**DCL     10098<<ASSIGN  10115<<ASSIGN  10117<<ASSIGN  10118<<ASSIGN  10130<<ASSIGN  10141>>IF
     10141<<ASSIGN  10143>>DOCASE  10176>>ASSIGN  10184<<ASSIGN  10191>>IF      10210<<ASSIGN  10214<<ASSIGN
     10219>>IF      10221>>ASSIGN  10223>>ASSIGN  10229<<ASSIGN  10233<<ASSIGN  10238<<ASSIGN  10238>>ASSIGN
     10258>>ASSIGN  10261<<ASSIGN  10266>>IF      11397<<ASSIGN
WROC.PSN
      9640**DCL     10073<<ASSIGN  10099<<ASSIGN  10108<<ASSIGN  10112<<ASSIGN  10131>>IF      10135<>CALL
     10141>>IF      10161<<ASSIGN  10162<<CALLBLT 10171<>CALL    10209<<ASSIGN  10213<<ASSIGN  10216<>CALL
     11398<<ASSIGN
WROC.SECT
      9643**DCL     10126<<ASSIGN  10129<<ASSIGN  10155<<ASSIGN  10164<<ASSIGN  10168<<ASSIGN
WROC.VOL
      9642**DCL     10106<<ASSIGN  10132>>ASSIGN
WROC.VSN
      9639**DCL     10097<<ASSIGN  10120>>IF      10122>>ASSIGN  10185<<ASSIGN  10191>>IF      10223<<ASSIGN
     10236<<ASSIGN  10241<<ASSIGN  10241>>ASSIGN  10248>>ASSIGN  10254<<ASSIGN  10262<<ASSIGN  10266>>IF
     11836<<ASSIGN
WRSUPER
      9243**DCL      9721<>CALL    11671<>CALL
WRSUPER.BUF_
      9243**DCL     11670<<ASSIGN
WRSUPER.BUF_.BOUND
      9243**DCL      9719<<ASSIGN
WRSUPER.BUF_.BUF$
      9245**DCL      9718<<ASSIGN
WRSUPER.STATION_
      9245**DCL      9245--REDEF    9717<<ASSIGN  11668<<ASSIGN
WRSUPER.V
      9246**DCL      9243--DCLINIT
WRSUPER.V.DVBYTE.VFC#
      9252**DCL      9252--REDEF
X$HELP
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:563  
      8418**DCL-ENT 11198--CALL    11235--CALL
X$PARSE
      8417**DCL-ENT  9826--CALL     9855--CALL
X9
      8477**DCL      9959<<ASSIGN  10011<<ASSIGN  10016<<ASSIGN  10017>>IF      10020>>IF      10020>>IF
     10023>>IF      10023>>IF      10026>>ASSIGN  10039<<ASSIGN  10039>>ASSIGN  10040>>IF      10055<<ASSIGN
     10057>>DOWHILE 10057>>DOWHILE 10058<<ASSIGN  10058>>ASSIGN  10081<<ASSIGN  10084<<ASSIGN  10085>>DOWHILE
     10086--CALLBLT 10095>>IF      10095>>IF      10097>>ASSIGN  10100>>IF      10100>>IF      10100>>IF
     10100>>IF      10102<<ASSIGN  10102>>ASSIGN  10103>>IF      10103>>IF      10104>>ASSIGN  10106>>ASSIGN
     10124>>IF      10125>>CALLBLT 10130>>IF      10153>>ASSIGN  10159>>IF      10159>>ASSIGN  10163>>IF
     10187>>IF      10187>>IF      10193>>IF      10194>>IF      10194<<ASSIGN  10194>>ASSIGN  10195<<ASSIGN
     10195>>ASSIGN  10201<<ASSIGN  10202>>DOWHILE 10208>>IF      10213>>ASSIGN  10214>>ASSIGN  10217>>IF
     10217>>IF      10218>>IF      10227>>IF      10235>>IF      10239>>ASSIGN  10259>>IF      10259>>IF
     10268<<ASSIGN  10268>>ASSIGN  10468<<ASSIGN  10560<<DOINDEX 10561>>ASSIGN  10563>>IF      10563>>IF
     10563>>IF      10564>>CALLBLT 10565>>DOWHILE 10565>>DOWHILE 10565>>DOWHILE 10567<<ASSIGN  10567>>ASSIGN
     10569>>CALLBLT 10576>>CALLBLT 10583<<ASSIGN  10586>>CALLBLT 10588>>CALLBLT 10589<<ASSIGN  10589>>ASSIGN
     10590>>IF      10591<<CALLBLT 10592>>CALLBLT 10596<<DOINDEX 10598>>ASSIGN  10599>>ASSIGN  10602>>IF
     10877<<ASSIGN  10909<<ASSIGN  10922<<ASSIGN  10923>>IF      10928>>IF      10949<<ASSIGN  11295<<ASSIGN
     11410<<ASSIGN  11411>>DOWHILE 11412>>IF      11412>>IF      11413<<ASSIGN  11413>>ASSIGN  11715<<ASSIGN
     11725>>ASSIGN  11744<>CALL    11857--CALLBLT 11874<<ASSIGN  11876>>ASSIGN  12047>>IF      12048<<ASSIGN
     12062>>IF      12063>>ASSIGN  12064>>ASSIGN  12065>>IF      12065>>IF      12069>>DOINDEX 12070>>IF
     12071<<ASSIGN  12071>>ASSIGN  12076>>ASSIGN  12077>>IF      12077<<ASSIGN  12077>>ASSIGN  12078<<ASSIGN
     12078>>ASSIGN  12082<<ASSIGN  12082>>ASSIGN  12086>>ASSIGN
XCONWIND
      8474**DCL      9791<<ASSIGN   9818<<ASSIGN
XUH
      3221**DCL     11198<>CALL    11235<>CALL
XUH.ALL#
      3233**DCL     11233<<ASSIGN
XUH.CHARPOS
      3245**DCL     11206>>ASSIGN
XUH.ERR
      3238**DCL     11201>>ASSIGN  11232>>IF
XUH.ERR_DCB#
      3244**DCL     11203>>ASSIGN
XUH.HELP$
PL6.E3A0      #002=FXP$MAIN File=FXP$PIG.:E05TSI                                 THU 09/04/97 08:42 Page:564  
      3231**DCL     11196<<ASSIGN
XUH.MORE#
      3234**DCL     11234<<ASSIGN
ZAP
      8466**DCL      9882<<ASSIGN  11409>>IF

PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:565  
     2700        1        /*T***********************************************************/
     2701        2        /*T*                                                         */
     2702        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2703        4        /*T*                                                         */
     2704        5        /*T***********************************************************/
     2705        6        FXP$POPTS: PROC(PARM);
     2706        7        %INCLUDE XU_MACRO_C;
     2707     3113        %INCLUDE XU_SUBS_C;
     2708     3205        %INCLUDE FX_SUBS_C;
     2709     3241        %INCLUDE FX_PERR_C;
     2710     3300        %INCLUDE F_MACROS_C;
     2711     3311        %P$NODE(NAME=NODE,STCLASS=BASED);
     2712     3405        %ERRCODE(NAME=FXP$E$HELP,COD#=%E$PIGH,FCG#='0630'O,MID#='20'O,SEV#=7);
     2713     3409    1   DCL 1 FLAG SYMREF,
     2714     3410    1         2 * BIT(18),
     2715     3411    1         2 CODE UBIN(15)UNAL,
     2716     3412    1         2 * BIT(3);
     2717     3413        %PARSE$PARAM(NAME=PARM,STCLASS=);
     2718     3494        %G$D(STCLASS="BASED(PARM.GLOBAL$)");
     2719     3590    1   DCL B BASED PTR;
     2720     3591    1   DCL CODE UBIN;
     2721     3592    1   DCL USW BIT(1)SYMREF;
     2722     3593    1   DCL 1 PROJAD SYMREF,
     2723     3594    1         2 L UBIN(9)UNAL,
     2724     3595    1         2 ACCT CHAR(8),
     2725     3596    1         2 NAME CHAR(12),
     2726     3597    1         2 PSN CHAR(6);
     2727     3598    1   DCL X$GETSPACE ENTRY(3);
     2728     3599    1   DCL FXU$PROJAD ENTRY(1) ALTRET;
     2729     3600    1   DCL DPERX BIT(72) SYMREF;
     2730     3601        %P$PCB(NAME=PCB,STCLASS="BASED(PARM.PCB$)");
     2731     3802        %PARSE$OUT(NAME=OUT,STCLASS=BASED);
     2732     3847        %PARSE$SYM(NAME=SYM,STCLASS="BASED(PARM.OUT$)");
     2733     3885    1      CODE=PINCRW(PCB.WORK$,PCB.WKSZ-1)->B->OUT.CODE;
     2734     3886    2      IF PARM.CODE=0 THEN DO CASE(G$D.STACKTOP$->B->OUT.CODE);
     2735     3887                    /* REJECT SET-ONLY OPTIONS FOR ACCOUNTS */
     2736     3888    2      CASE(2,12); /* NEWFDS, SHELFTIME */
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:566  
     2737     3889    2         IF CODE=%E$DEFAULT
     2738     3890    2         THEN CODE=PINCRW(PCB.WORK$,PCB.WKSZ-2)->B->OUT.CODE;
     2739     3891    3         IF CODE=%E$CREATE OR CODE=%E$MODIFY THEN DO;
     2740     3892    3            PARM.REJECT='1'B;
     2741     3893    3            PCB.HI_CHAR=G$D.STACKTOP$->B->OUT.CPOS;
     2742     3894    3            END;
     2743     3895    2      END;
     2744     3896    1      ELSE IF PARM.CODE~=%E$MAKEME THEN USW='1'B;
     2745     3897    2      ELSE IF PARM.TYPE=%FAIL# THEN DO;
     2746     3898    2         IF CODE=%E$MADLIST OR PROJAD.L=0
     2747     3899    2           OR CODE~=%E$DELETE AND PROJAD.PSN=' ' OR G$D.CCHAR~='.' THEN RETURN;
     2748     3900    2         CALL X$GETSPACE(7,PARM.OUT$,G$D);
     2749     3901    2         SYM.COUNT=6;
     2750     3902    2         SYM.CODE=%E$PSN;
     2751     3903    2         SYM.TEXT=PROJAD.PSN;
     2752     3904    2         PARM.ACCEPT='1'B;
     2753     3905    2         RETURN;
     2754     3906    2         END;
     2755     3907    2      ELSE DO;
     2756     3908    2         IF PROJAD.L=0 OR PARM.OUT$~=ADDR(NIL)
     2757     3909    2           OR PROJAD.PSN=G$D.STACKTOP$->B->SYM.TEXT THEN RETURN;
     2758     3910    2         CALL FXU$PROJAD(G$D.STACKTOP$->B->SYM.COUNT);
     2759     3911    2         IF FLAG THEN UNWIND TO DPERX;
     2760     3912    2         RETURN;
     2761     3913    2         END;
     2762     3914    1      IF PARM.NODE$->NODE.F_F
     2763     3915    2      THEN IF PCB.HINODE$->NODE.CODE>=%E$PIGH THEN DO;
     2764     3916    2         FLAG=FXP$E$HELP;
     2765     3917    2         IF PARM.CHARPOS~=PCB.HI_CHAR THEN FLAG.CODE=PCB.HINODE$->NODE.CODE;
     2766     3918    2         PARM.CHARPOS=PCB.HI_CHAR;
     2767     3919    2         PARM.ACCEPT='1'B;
     2768     3920    2         END;
     2769     3921    1      ELSE PCB.HI_CHAR=PARM.CHARPOS;
     2770     3922    1      RETURN;
     2771     3923    1   END;
     2772     3924        %EOD;

PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:567  
--  Include file information  --

   F_MACROS_C.:E05TOU  is referenced.
   FX_PERR_C.:E05TOU  is referenced.
   FX_SUBS_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure FXP$POPTS.

   Procedure FXP$POPTS requires 166 words for executable code.
   Procedure FXP$POPTS requires 10 words of local(AUTO) storage.

PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:568  

 Object Unit name= FXP$POPTS                                  File name= FXP$PIG.:E05TOU
 UTS= SEP 04 '97 08:44:20.76 THU                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  FXP$POPTS
    1   Proc  even  none   166    246  FXP$POPTS
    2  RoData even  none     1      1  FXP$POPTS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  FXP$POPTS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 X$GETSPACE
 yes     yes           Std       1 FXU$PROJAD
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AUNWIND
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:569  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     FLAG                                  USW                                   PROJAD
     DPERX                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:570  


     2700        1        /*T***********************************************************/
     2701        2        /*T*                                                         */
     2702        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2703        4        /*T*                                                         */
     2704        5        /*T***********************************************************/
     2705        6        FXP$POPTS: PROC(PARM);

      6  1 000000   000000 700200 xent  FXP$POPTS    TSX0  ! X66_AUTO_1
         1 000001   000012 000001                    ZERO    10,1

     2706        7        %INCLUDE XU_MACRO_C;
     2707     3113        %INCLUDE XU_SUBS_C;
     2708     3205        %INCLUDE FX_SUBS_C;
     2709     3241        %INCLUDE FX_PERR_C;
     2710     3300        %INCLUDE F_MACROS_C;
     2711     3311        %P$NODE(NAME=NODE,STCLASS=BASED);
     2712     3405        %ERRCODE(NAME=FXP$E$HELP,COD#=%E$PIGH,FCG#='0630'O,MID#='20'O,SEV#=7);
     2713     3409    1   DCL 1 FLAG SYMREF,
     2714     3410    1         2 * BIT(18),
     2715     3411    1         2 CODE UBIN(15)UNAL,
     2716     3412    1         2 * BIT(3);
     2717     3413        %PARSE$PARAM(NAME=PARM,STCLASS=);
     2718     3494        %G$D(STCLASS="BASED(PARM.GLOBAL$)");
     2719     3590    1   DCL B BASED PTR;
     2720     3591    1   DCL CODE UBIN;
     2721     3592    1   DCL USW BIT(1)SYMREF;
     2722     3593    1   DCL 1 PROJAD SYMREF,
     2723     3594    1         2 L UBIN(9)UNAL,
     2724     3595    1         2 ACCT CHAR(8),
     2725     3596    1         2 NAME CHAR(12),
     2726     3597    1         2 PSN CHAR(6);
     2727     3598    1   DCL X$GETSPACE ENTRY(3);
     2728     3599    1   DCL FXU$PROJAD ENTRY(1) ALTRET;
     2729     3600    1   DCL DPERX BIT(72) SYMREF;
     2730     3601        %P$PCB(NAME=PCB,STCLASS="BASED(PARM.PCB$)");
     2731     3802        %PARSE$OUT(NAME=OUT,STCLASS=BASED);
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:571  
     2732     3847        %PARSE$SYM(NAME=SYM,STCLASS="BASED(PARM.OUT$)");
     2733     3885    1      CODE=PINCRW(PCB.WORK$,PCB.WKSZ-1)->B->OUT.CODE;

   3885  1 000002   200003 470500                    LDP0    @PARM,,AUTO
         1 000003   000005 471500                    LDP1    5,,PR0
         1 000004   100005 220100                    LDX0    5,,PR1
         1 000005   100002 473500                    LDP3    2,,PR1
         1 000006   377777 474510                    LDP4    -1,X0,PR3
         1 000007   400000 236100                    LDQ     0,,PR4
         1 000010   777777 376007                    ANQ     -1,DL
         1 000011   200004 756100                    STQ     CODE,,AUTO

     2734     3886    2      IF PARM.CODE=0 THEN DO CASE(G$D.STACKTOP$->B->OUT.CODE);

   3886  1 000012   000000 721100                    LXL1    0,,PR0
         1 000013   000064 601000 1                  TNZ     s:3896

   3886  1 000014   000003 475500                    LDP5    3,,PR0
         1 000015   500010 476500                    LDP6    8,,PR5
         1 000016   600000 477500                    LDP7    0,,PR6
         1 000017   700000 722100                    LXL2    0,,PR7
         1 000020   000015 102003                    CMPX2   13,DU
         1 000021   000023 602012 1                  TNC     s:3886+9,X2
         1 000022   000211 710000 1                  TRA     s:3914
         1 000023   000063 710000 1                  TRA     s:3895
         1 000024   000063 710000 1                  TRA     s:3895
         1 000025   000040 710000 1                  TRA     s:3889
         1 000026   000063 710000 1                  TRA     s:3895
         1 000027   000063 710000 1                  TRA     s:3895
         1 000030   000063 710000 1                  TRA     s:3895
         1 000031   000063 710000 1                  TRA     s:3895
         1 000032   000063 710000 1                  TRA     s:3895
         1 000033   000063 710000 1                  TRA     s:3895
         1 000034   000063 710000 1                  TRA     s:3895
         1 000035   000063 710000 1                  TRA     s:3895
         1 000036   000063 710000 1                  TRA     s:3895
         1 000037   000040 710000 1                  TRA     s:3889
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:572  

     2735     3887                    /* REJECT SET-ONLY OPTIONS FOR ACCOUNTS */
     2736     3888    2      CASE(2,12); /* NEWFDS, SHELFTIME */

     2737     3889    2         IF CODE=%E$DEFAULT

   3889  1 000040   000157 116007                    CMPQ    111,DL
         1 000041   000046 601000 1                  TNZ     s:3891

     2738     3890    2         THEN CODE=PINCRW(PCB.WORK$,PCB.WKSZ-2)->B->OUT.CODE;

   3890  1 000042   377776 470510                    LDP0    -2,X0,PR3
         1 000043   000000 236100                    LDQ     0,,PR0
         1 000044   777777 376007                    ANQ     -1,DL
         1 000045   200004 756100                    STQ     CODE,,AUTO

     2739     3891    3         IF CODE=%E$CREATE OR CODE=%E$MODIFY THEN DO;

   3891  1 000046   000153 116007                    CMPQ    107,DL
         1 000047   000052 600000 1                  TZE     s:3892
         1 000050   000154 116007                    CMPQ    108,DL
         1 000051   000211 601000 1                  TNZ     s:3914

     2740     3892    3            PARM.REJECT='1'B;

   3892  1 000052   200003 470500                    LDP0    @PARM,,AUTO
         1 000053   000200 236003                    LDQ     128,DU
         1 000054   000000 256100                    ORSQ    0,,PR0

     2741     3893    3            PCB.HI_CHAR=G$D.STACKTOP$->B->OUT.CPOS;

   3893  1 000055   000005 471500                    LDP1    5,,PR0
         1 000056   000003 473500                    LDP3    3,,PR0
         1 000057   300010 474500                    LDP4    8,,PR3
         1 000060   400000 475500                    LDP5    0,,PR4
         1 000061   500002 235100                    LDA     2,,PR5
         1 000062   100012 755100                    STA     10,,PR1
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:573  

     2742     3894    3            END;

     2743     3895    2      END;

   3895  1 000063   000211 710000 1                  TRA     s:3914

     2744     3896    1      ELSE IF PARM.CODE~=%E$MAKEME THEN USW='1'B;

   3896  1 000064   000177 101003                    CMPX1   127,DU
         1 000065   000071 600000 1                  TZE     s:3897

   3896  1 000066   400000 236003                    LDQ     -131072,DU
         1 000067   000000 756000 xsym               STQ     USW
         1 000070   000211 710000 1                  TRA     s:3914

     2745     3897    2      ELSE IF PARM.TYPE=%FAIL# THEN DO;

   3897  1 000071   000000 236100                    LDQ     0,,PR0
         1 000072   777000 376003                    ANQ     -512,DU
         1 000073   003000 116003                    CMPQ    1536,DU
         1 000074   000151 601000 1                  TNZ     s:3908

     2746     3898    2         IF CODE=%E$MADLIST OR PROJAD.L=0

   3898  1 000075   200004 235100                    LDA     CODE,,AUTO
         1 000076   000165 115007                    CMPA    117,DL
         1 000077   000116 600000 1                  TZE     s:3899
         1 000100   000000 236000 xsym               LDQ     PROJAD
         1 000101   777000 316003                    CANQ    -512,DU
         1 000102   000116 600000 1                  TZE     s:3899
         1 000103   000160 115007                    CMPA    112,DL
         1 000104   000111 600000 1                  TZE     s:3898+12
         1 000105   040000 106400                    CMPC    fill='040'O
         1 000106   000005 200006 xsym               ADSC9   PROJAD+5                 cn=1,n=6
         1 000107   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000110   000116 600000 1                  TZE     s:3899
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:574  
         1 000111   000003 475500                    LDP5    3,,PR0
         1 000112   500015 236100                    LDQ     13,,PR5
         1 000113   777000 376003                    ANQ     -512,DU
         1 000114   056000 116003                    CMPQ    23552,DU
         1 000115   000117 600000 1                  TZE     s:3900

     2747     3899    2           OR CODE~=%E$DELETE AND PROJAD.PSN=' ' OR G$D.CCHAR~='.' THEN RETURN;

   3899  1 000116   000000 702200 xent               TSX2  ! X66_ARET

     2748     3900    2         CALL X$GETSPACE(7,PARM.OUT$,G$D);

   3900  1 000117   200010 455500                    STP5    CODE+4,,AUTO
         1 000120   200003 236100                    LDQ     @PARM,,AUTO
         1 000121   000002 036003                    ADLQ    2,DU
         1 000122   000000 235000 2                  LDA     0
         1 000123   200006 757100                    STAQ    CODE+2,,AUTO
         1 000124   200006 630500                    EPPR0   CODE+2,,AUTO
         1 000125   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000126   000000 701000 xent               TSX1    X$GETSPACE
         1 000127   000000 011000                    NOP     0

     2749     3901    2         SYM.COUNT=6;

   3901  1 000130   200003 470500                    LDP0    @PARM,,AUTO
         1 000131   000002 471500                    LDP1    2,,PR0
         1 000132   006000 236003                    LDQ     3072,DU
         1 000133   100004 552140                    STBQ    4,'40'O,PR1

     2750     3902    2         SYM.CODE=%E$PSN;

   3902  1 000134   000002 471500                    LDP1    2,,PR0
         1 000135   000106 220003                    LDX0    70,DU
         1 000136   100000 440100                    SXL0    0,,PR1

     2751     3903    2         SYM.TEXT=PROJAD.PSN;

PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:575  
   3903  1 000137   000002 471500                    LDP1    2,,PR0
         1 000140   100004 236100                    LDQ     4,,PR1
         1 000141   000033 772000                    QRL     27
         1 000142   000000 621006                    EAX1    0,QL
         1 000143   040140 100400                    MLR     fill='040'O
         1 000144   000005 200006 xsym               ADSC9   PROJAD+5                 cn=1,n=6
         1 000145   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1

     2752     3904    2         PARM.ACCEPT='1'B;

   3904  1 000146   000400 236003                    LDQ     256,DU
         1 000147   000000 256100                    ORSQ    0,,PR0

     2753     3905    2         RETURN;

   3905  1 000150   000000 702200 xent               TSX2  ! X66_ARET

     2754     3906    2         END;
     2755     3907    2      ELSE DO;

     2756     3908    2         IF PROJAD.L=0 OR PARM.OUT$~=ADDR(NIL)

   3908  1 000151   000000 236000 xsym               LDQ     PROJAD
         1 000152   777000 316003                    CANQ    -512,DU
         1 000153   000171 600000 1                  TZE     s:3909
         1 000154   000002 236100                    LDQ     2,,PR0
         1 000155   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000156   000171 601000 1                  TNZ     s:3909
         1 000157   000003 475500                    LDP5    3,,PR0
         1 000160   500010 476500                    LDP6    8,,PR5
         1 000161   600000 477500                    LDP7    0,,PR6
         1 000162   700004 236100                    LDQ     4,,PR7
         1 000163   000033 772000                    QRL     27
         1 000164   000000 622006                    EAX2    0,QL
         1 000165   040140 106400                    CMPC    fill='040'O
         1 000166   000005 200006 xsym               ADSC9   PROJAD+5                 cn=1,n=6
         1 000167   700004 200012                    ADSC9   4,,PR7                   cn=1,n=*X2
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:576  
         1 000170   000172 601000 1                  TNZ     s:3910

     2757     3909    2           OR PROJAD.PSN=G$D.STACKTOP$->B->SYM.TEXT THEN RETURN;

   3909  1 000171   000000 702200 xent               TSX2  ! X66_ARET

     2758     3910    2         CALL FXU$PROJAD(G$D.STACKTOP$->B->SYM.COUNT);

   3910  1 000172   700004 630500                    EPPR0   4,,PR7
         1 000173   200006 450500                    STP0    CODE+2,,AUTO
         1 000174   200006 630500                    EPPR0   CODE+2,,AUTO
         1 000175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000176   000000 701000 xent               TSX1    FXU$PROJAD
         1 000177   000000 011000                    NOP     0

     2759     3911    2         IF FLAG THEN UNWIND TO DPERX;

   3911  1 000200   000000 235000 xsym               LDA     FLAG
         1 000201   000210 600000 1                  TZE     s:3912

   3911  1 000202   000100 100600                    MLR   ! fill='000'O
         1 000203   000000 000010 xsym               ADSC9   DPERX                    cn=0,n=8
         1 000204   200006 000010                    ADSC9   CODE+2,,AUTO             cn=0,n=8
         1 000205   200006 237300                    LDAQ  ! CODE+2,,AUTO
         1 000206   000000 700200 xent               TSX0  ! X66_AUNWIND
         1 000207   000000 000200                    ZERO    0,128

     2760     3912    2         RETURN;

   3912  1 000210   000000 702200 xent               TSX2  ! X66_ARET

     2761     3913    2         END;
     2762     3914    1      IF PARM.NODE$->NODE.F_F

   3914  1 000211   200003 470500                    LDP0    @PARM,,AUTO
         1 000212   000001 471500                    LDP1    1,,PR0
         1 000213   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:577  
         1 000214   010000 316003                    CANQ    4096,DU
         1 000215   000245 600000 1                  TZE     s:3922

     2763     3915    2      THEN IF PCB.HINODE$->NODE.CODE>=%E$PIGH THEN DO;

   3915  1 000216   000005 473500                    LDP3    5,,PR0
         1 000217   300013 474500                    LDP4    11,,PR3
         1 000220   400000 236100                    LDQ     0,,PR4
         1 000221   177777 376007                    ANQ     65535,DL
         1 000222   000144 116007                    CMPQ    100,DL
         1 000223   000243 602000 1                  TNC     s:3921

     2764     3916    2         FLAG=FXP$E$HELP;

   3916  1 000224   000000 236000 0                  LDQ     FXP$E$HELP
         1 000225   000000 756000 xsym               STQ     FLAG

     2765     3917    2         IF PARM.CHARPOS~=PCB.HI_CHAR THEN FLAG.CODE=PCB.HINODE$->NODE.CODE;

   3917  1 000226   000004 236100                    LDQ     4,,PR0
         1 000227   300012 116100                    CMPQ    10,,PR3
         1 000230   000236 600000 1                  TZE     s:3918

   3917  1 000231   400000 236100                    LDQ     0,,PR4
         1 000232   000003 736000                    QLS     3
         1 000233   000000 676000 xsym               ERQ     FLAG
         1 000234   777770 376007                    ANQ     -8,DL
         1 000235   000000 656000 xsym               ERSQ    FLAG

     2766     3918    2         PARM.CHARPOS=PCB.HI_CHAR;

   3918  1 000236   300012 235100                    LDA     10,,PR3
         1 000237   000004 755100                    STA     4,,PR0

     2767     3919    2         PARM.ACCEPT='1'B;

   3919  1 000240   000400 236003                    LDQ     256,DU
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:578  
         1 000241   000000 256100                    ORSQ    0,,PR0

     2768     3920    2         END;

   3920  1 000242   000245 710000 1                  TRA     s:3922

     2769     3921    1      ELSE PCB.HI_CHAR=PARM.CHARPOS;

   3921  1 000243   000004 235100                    LDA     4,,PR0
         1 000244   300012 755100                    STA     10,,PR3

     2770     3922    1      RETURN;

   3922  1 000245   000000 702200 xent               TSX2  ! X66_ARET
     2771     3923    1   END;
     2772     3924        %EOD;

PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:579  
--  Include file information  --

   F_MACROS_C.:E05TOU  is referenced.
   FX_PERR_C.:E05TOU  is referenced.
   FX_SUBS_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure FXP$POPTS.
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:580  

 **** Variables and constants ****

  ****  Section 000 RoData FXP$POPTS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 FXP$E$HELP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARM                      4-0-0/w UBIN        r     1 CODE
    *0-0-0/w STRC(270)   r     1 PARM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT (72)    r     1 DPERX                      0-0-0/b STRC        r     1 FLAG
     0-0-0/c STRC(243)   r     1 PROJAD                     0-0-0/b BIT         r     1 USW

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B                          0-0-0/d STRC(5175)  r     1 G$D
     0-0-0/w STRC(72)    r     1 NODE                       0-0-0/w STRC(144)   r     1 OUT
     0-0-0/w STRC(504)   r     1 PCB                        0-0-0/w ASTR(153)   r     1 SYM


   Procedure FXP$POPTS requires 166 words for executable code.
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:581  
   Procedure FXP$POPTS requires 10 words of local(AUTO) storage.
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:582  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:583  
          MINI XREF LISTING

B
      3590**DCL      3885>>ASSIGN   3886>>DOCASE   3890>>ASSIGN   3893>>ASSIGN   3908>>IF       3908>>IF
      3910>>CALL
CODE
      3591**DCL      3885<<ASSIGN   3889>>IF       3890<<ASSIGN   3891>>IF       3891>>IF       3898>>IF
      3898>>IF
DPERX
      3600**DCL      3911>>UNWIND
FLAG
      3409**DCL      3911>>IF       3916<<ASSIGN
FLAG.CODE
      3411**DCL      3917<<ASSIGN
FXP$E$HELP
      3406**DCL      3916>>ASSIGN
FXU$PROJAD
      3599**DCL-ENT  3910--CALL
G$D
      3503**DCL      3900<>CALL
G$D.CCHAR
      3559**DCL      3898>>IF
G$D.LDCMNT.TX
      3573**DCL      3574--REDEF
G$D.SCRATCH
      3540**DCL      3543--REDEF
G$D.STACKTOP$
      3532**DCL      3886>>DOCASE   3893>>ASSIGN   3908>>IF       3908>>IF       3910>>CALL
G$D.TRCMNT.TX
      3581**DCL      3582--REDEF
NODE.CODE
      3390**DCL      3915>>IF       3917>>ASSIGN
NODE.F_F
      3349**DCL      3914>>IF
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:584  
OUT.CODE
      3816**DCL      3885>>ASSIGN   3886>>DOCASE   3890>>ASSIGN
OUT.CPOS
      3834**DCL      3893>>ASSIGN
PARM
      3432**DCL         6--PROC
PARM.ACCEPT
      3439**DCL      3904<<ASSIGN   3919<<ASSIGN
PARM.CHARPOS
      3470**DCL      3917>>IF       3918<<ASSIGN   3921>>ASSIGN
PARM.CODE
      3453**DCL      3886>>IF       3896>>IF
PARM.GLOBAL$
      3466**DCL      3503--IMP-PTR  3886>>DOCASE   3893>>ASSIGN   3898>>IF       3900>>CALL     3908>>IF
      3908>>IF       3910>>CALL
PARM.NODE$
      3458**DCL      3914>>IF
PARM.OUT$
      3462**DCL      3854--IMP-PTR  3900<>CALL     3901>>ASSIGN   3902>>ASSIGN   3903>>ASSIGN   3903>>ASSIGN
      3908>>IF
PARM.PCB$
      3476**DCL      3620--IMP-PTR  3885>>ASSIGN   3885>>ASSIGN   3890>>ASSIGN   3890>>ASSIGN   3893>>ASSIGN
      3915>>IF       3917>>IF       3917>>ASSIGN   3918>>ASSIGN   3921>>ASSIGN
PARM.REJECT
      3444**DCL      3892<<ASSIGN
PARM.TYPE
      3433**DCL      3897>>IF
PCB.HINODE$
      3778**DCL      3915>>IF       3917>>ASSIGN
PCB.HI_CHAR
      3771**DCL      3893<<ASSIGN   3917>>IF       3918>>ASSIGN   3921<<ASSIGN
PCB.WKSZ
      3650**DCL      3885>>ASSIGN   3890>>ASSIGN
PCB.WORK$
      3629**DCL      3885>>ASSIGN   3890>>ASSIGN
PROJAD.L
PL6.E3A0      #003=FXP$POPTS File=FXP$PIG.:E05TSI                                THU 09/04/97 08:44 Page:585  
      3594**DCL      3898>>IF       3908>>IF
PROJAD.PSN
      3597**DCL      3898>>IF       3903>>ASSIGN   3908>>IF
SYM.CODE
      3860**DCL      3902<<ASSIGN
SYM.COUNT
      3877**DCL      3880--IMP-SIZ  3901<<ASSIGN   3903>>ASSIGN   3908>>IF       3910<>CALL
SYM.TEXT
      3880**DCL      3903<<ASSIGN   3908>>IF
USW
      3592**DCL      3896<<ASSIGN
X$GETSPACE
      3598**DCL-ENT  3900--CALL

PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:586  
     2773        1        /*T***********************************************************/
     2774        2        /*T*                                                         */
     2775        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2776        4        /*T*                                                         */
     2777        5        /*T***********************************************************/
     2778        6        FXP$INT: PROC ASYNC;
     2779        7    1   DCL TRAPCNT SBIN SYMREF;
     2780        8    1   DCL TRAPX BIT(72)SYMREF;
     2781        9        %INCLUDE CP_6;
     2782       90        %INCLUDE JG_GHOSTS_C;
     2783      180        %INCLUDE F_SCODE_C;
     2784      216        %INCLUDE J$JIT_C;
     2785      416    1   DCL B$JIT$ PTR SYMREF;
     2786      417        %FPT_XCON(FPTN=NOXCON,STCLASS=CONSTANT);
     2787      431        %VLP_SCODE (FPTN=PIGTRAP, CODE=%S$PIGERR, FCG=FX, MID=P, CFUS=YES, CUSR=YES,
     2788      432              FMBUF=YES,ROSEG=YES,DDSEG=YES,ISEG=YES);
     2789      493        %FPT_SCREECH(FPTN=PIGSCR,STCLASS=CONSTANT,SCODE=PIGTRAP);
     2790      507    1   DCL B$TCB$ PTR SYMREF;
     2791      508        %B$TCB(STCLASS="BASED(B$TCB$)");
     2792      511        %B$XCON;
     2793      521    1   DCL FLAG BIT(36) SYMREF;
     2794      522    1   DCL XCONWIND BIT(72)STATIC SYMDEF INIT('0'B);
     2795      523    1   DCL SETSAD BIT(72)SYMREF DALIGNED;
     2796      524    1   DCL BREAK UBIN SYMREF;
     2797      525        %FPT_TRMPRG (STCLASS=CONSTANT, RESETBREAK=YES);
     2798      554    1      CALL M$TRMPRG (FPT_TRMPRG);
     2799      555    1      BREAK=1;
     2800      556    1      RETURN;
     2801      557    1   FXP$TRAP: ENTRY ASYNC;
     2802      558    1      IF TRAPCNT~=0 THEN GOTO XCON;
     2803      559    1      TRAPCNT=TRAPCNT+1;
     2804      560    1      CALL M$CLRSTK;
     2805      561    1      CALL M$SAD(SETSAD)ALTRET(NOALT);
     2806      562    1   NOALT:;
     2807      563    1      UNWIND TO TRAPX;
     2808      564    1   FXP$XCON: ENTRY ASYNC;
     2809      565    1   XCON:;
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:587  
     2810      566    2      IF XCONWIND AND TRAPCNT<4 THEN DO;
     2811      567    2         TRAPCNT=TRAPCNT+1;
     2812      568    3         IF B$JIT.SYSID=JG_PIG# THEN DO;
     2813      569    3            FLAG=B$TCB.STK$->B$XCON.ERR;
     2814      570    3            CALL M$SCREECH(PIGSCR);
     2815      571    3            END;
     2816      572                    /*S*      SCREECH_CODE: FXP-S$PIGERR
     2817      573                    *         TYPE: SNAP
     2818      574                    *         MESSAGE: PIG exit, error, or abort.
     2819      575                    *         DESCRIPTION: PIG's exit control was entered while running as
     2820      576                    *         a ghost not becaouse of a ZAP. PIG unwinds (after this snap)
     2821      577                    *         to the general error return (DPERR1).
     2822      578                    */
     2823      579    2         CALL M$CLRSTK;
     2824      580    2         UNWIND TO XCONWIND;
     2825      581    2         END;
     2826      582    1      IF B$JIT.XCONF THEN CALL M$MERCS;
     2827      583    1      ELSE CALL M$XCON(NOXCON);
     2828      584    1   END FXP$INT;

PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:588  
--  Include file information  --

   J$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F_SCODE_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXP$INT.

   Procedure FXP$INT requires 61 words for executable code.
   Procedure FXP$INT requires 6 words of local(AUTO) storage.

    No errors detected in file FXP$PIG.:E05TSI    .

PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:589  

 Object Unit name= FXP$INT                                    File name= FXP$PIG.:E05TOU
 UTS= SEP 04 '97 08:44:27.32 THU                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     20     24  FXP$INT
    2   Data  even  none     4      4  FXP$INT
    3   Proc  even  none    61     75  FXP$INT
    4  RoData even  none     2      2  FXP$INT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes     Async       0  FXP$INT
     3     10                  yes     Async       0  FXP$TRAP
     3     31                  yes     Async       0  FXP$XCON

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2      2  XCONWIND

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AARET
                       nStd      0 X66_AAUNWIND
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:590  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     TRAPCNT                               TRAPX                                 M$UC
     B$JIT$                                B$TCB$                                FLAG
     SETSAD                                BREAK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:591  


     2773        1        /*T***********************************************************/
     2774        2        /*T*                                                         */
     2775        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2776        4        /*T*                                                         */
     2777        5        /*T***********************************************************/
     2778        6        FXP$INT: PROC ASYNC;

      6  3 000000   000000 700200 xent  FXP$INT      TSX0  ! X66_AAUTO
         3 000001   000006 000000                    ZERO    6,0

     2779        7    1   DCL TRAPCNT SBIN SYMREF;
     2780        8    1   DCL TRAPX BIT(72)SYMREF;
     2781        9        %INCLUDE CP_6;
     2782       90        %INCLUDE JG_GHOSTS_C;
     2783      180        %INCLUDE F_SCODE_C;
     2784      216        %INCLUDE J$JIT_C;
     2785      416    1   DCL B$JIT$ PTR SYMREF;
     2786      417        %FPT_XCON(FPTN=NOXCON,STCLASS=CONSTANT);
     2787      431        %VLP_SCODE (FPTN=PIGTRAP, CODE=%S$PIGERR, FCG=FX, MID=P, CFUS=YES, CUSR=YES,
     2788      432              FMBUF=YES,ROSEG=YES,DDSEG=YES,ISEG=YES);
     2789      493        %FPT_SCREECH(FPTN=PIGSCR,STCLASS=CONSTANT,SCODE=PIGTRAP);
     2790      507    1   DCL B$TCB$ PTR SYMREF;
     2791      508        %B$TCB(STCLASS="BASED(B$TCB$)");
     2792      511        %B$XCON;
     2793      521    1   DCL FLAG BIT(36) SYMREF;
     2794      522    1   DCL XCONWIND BIT(72)STATIC SYMDEF INIT('0'B);
     2795      523    1   DCL SETSAD BIT(72)SYMREF DALIGNED;
     2796      524    1   DCL BREAK UBIN SYMREF;
     2797      525        %FPT_TRMPRG (STCLASS=CONSTANT, RESETBREAK=YES);
     2798      554    1      CALL M$TRMPRG (FPT_TRMPRG);

    554  3 000002   000014 630400 1                  EPPR0   FPT_TRMPRG
         3 000003   160004 713400                    CLIMB   57348
         3 000004   400400 401760                    pmme    nvectors=2

     2799      555    1      BREAK=1;
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:592  

    555  3 000005   000001 235007                    LDA     1,DL
         3 000006   000000 755000 xsym               STA     BREAK

     2800      556    1      RETURN;

    556  3 000007   000000 702200 xent               TSX2  ! X66_AARET

     2801      557    1   FXP$TRAP: ENTRY ASYNC;

    557  3 000010   000000 700200 xent  FXP$TRAP     TSX0  ! X66_AAUTO
         3 000011   000006 000000                    ZERO    6,0

     2802      558    1      IF TRAPCNT~=0 THEN GOTO XCON;

    558  3 000012   000000 235000 xsym               LDA     TRAPCNT
         3 000013   000033 601000 3                  TNZ     XCON

     2803      559    1      TRAPCNT=TRAPCNT+1;

    559  3 000014   000000 054000 xsym               AOS     TRAPCNT

     2804      560    1      CALL M$CLRSTK;

    560  3 000015   010013 713400                    CLIMB   4107
         3 000016   000000 401760                    pmme    nvectors=0

     2805      561    1      CALL M$SAD(SETSAD)ALTRET(NOALT);

    561  3 000017   000000 630400 xsym               EPPR0   SETSAD
         3 000020   430015 713400                    CLIMB   alt,+12301
         3 000021   400000 401760                    pmme    nvectors=1
         3 000022   000023 702000 3                  TSX2    NOALT

    559  3 000023                       NOALT        null
     2806      562    1   NOALT:;
     2807      563    1      UNWIND TO TRAPX;
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:593  

    563  3 000023   000100 100600                    MLR   ! fill='000'O
         3 000024   000000 000010 xsym               ADSC9   TRAPX                    cn=0,n=8
         3 000025   200004 000010                    ADSC9   4,,AUTO                  cn=0,n=8
         3 000026   200004 237300                    LDAQ  ! 4,,AUTO
         3 000027   000000 700200 xent               TSX0  ! X66_AAUNWIND
         3 000030   000000 000200                    ZERO    0,128

     2808      564    1   FXP$XCON: ENTRY ASYNC;

    564  3 000031   000000 700200 xent  FXP$XCON     TSX0  ! X66_AAUTO
         3 000032   000006 000000                    ZERO    6,0

    563  3 000033                       XCON         null
     2809      565    1   XCON:;
     2810      566    2      IF XCONWIND AND TRAPCNT<4 THEN DO;

    566  3 000033   000002 237000 2                  LDAQ    XCONWIND
         3 000034   000000 117000 4                  CMPAQ   0
         3 000035   000062 600000 3                  TZE     s:582
         3 000036   000000 235000 xsym               LDA     TRAPCNT
         3 000037   000004 115007                    CMPA    4,DL
         3 000040   000062 605000 3                  TPL     s:582

     2811      567    2         TRAPCNT=TRAPCNT+1;

    567  3 000041   000000 054000 xsym               AOS     TRAPCNT

     2812      568    3         IF B$JIT.SYSID=JG_PIG# THEN DO;

    568  3 000042   000000 470400 xsym               LDP0    B$JIT$
         3 000043   000000 720100                    LXL0    0,,PR0
         3 000044   000007 100003                    CMPX0   7,DU
         3 000045   000055 601000 3                  TNZ     s:579

     2813      569    3            FLAG=B$TCB.STK$->B$XCON.ERR;

PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:594  
    569  3 000046   000000 471400 xsym               LDP1    B$TCB$
         3 000047   100001 473500                    LDP3    1,,PR1
         3 000050   300102 236100                    LDQ     66,,PR3
         3 000051   000000 756000 xsym               STQ     FLAG

     2814      570    3            CALL M$SCREECH(PIGSCR);

    570  3 000052   000006 630400 1                  EPPR0   PIGSCR
         3 000053   000013 713400                    CLIMB   11
         3 000054   401000 401760                    pmme    nvectors=3

     2815      571    3            END;

     2816      572                    /*S*      SCREECH_CODE: FXP-S$PIGERR
     2817      573                    *         TYPE: SNAP
     2818      574                    *         MESSAGE: PIG exit, error, or abort.
     2819      575                    *         DESCRIPTION: PIG's exit control was entered while running as
     2820      576                    *         a ghost not becaouse of a ZAP. PIG unwinds (after this snap)
     2821      577                    *         to the general error return (DPERR1).
     2822      578                    */
     2823      579    2         CALL M$CLRSTK;

    579  3 000055   010013 713400                    CLIMB   4107
         3 000056   000000 401760                    pmme    nvectors=0

     2824      580    2         UNWIND TO XCONWIND;

    580  3 000057   000002 237200 2                  LDAQ  ! XCONWIND
         3 000060   000000 700200 xent               TSX0  ! X66_AAUNWIND
         3 000061   000000 000200                    ZERO    0,128

     2825      581    2         END;
     2826      582    1      IF B$JIT.XCONF THEN CALL M$MERCS;

    582  3 000062   000000 470400 xsym               LDP0    B$JIT$
         3 000063   000316 236100                    LDQ     206,,PR0
         3 000064   777000 316003                    CANQ    -512,DU
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:595  
         3 000065   000071 600000 3                  TZE     s:583

    582  3 000066   010014 713400                    CLIMB   4108
         3 000067   000000 401760                    pmme    nvectors=0
         3 000070   000074 710000 3                  TRA     s:584

     2827      583    1      ELSE CALL M$XCON(NOXCON);

    583  3 000071   000000 630400 1                  EPPR0   NOXCON
         3 000072   010003 713400                    CLIMB   4099
         3 000073   400400 401760                    pmme    nvectors=2

     2828      584    1   END FXP$INT;

    584  3 000074   000000 702200 xent               TSX2  ! X66_AARET

PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:596  
--  Include file information  --

   J$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F_SCODE_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXP$INT.
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:597  

 **** Variables and constants ****

  ****  Section 001 RoData FXP$INT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/d STRC(288)   r     1 FPT_TRMPRG                 0-0-0/d STRC(216)   r     1 NOXCON
     6-0-0/d STRC(216)   r     1 PIGSCR

  ****  Section 002  Data  FXP$INT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(72)    r     1 PIGTRAP                    2-0-0/b BIT (72)    r     1 XCONWIND

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w UBIN        r     1 BREAK                      0-0-0/b BIT         r     1 FLAG
     0-0-0/d BIT (72)    r     1 SETSAD                     0-0-0/w SBIN        r     1 TRAPCNT
     0-0-0/b BIT (72)    r     1 TRAPX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(2448)  r     1 B$XCON                     0-0-0N  NULL        r     1 M$UC

PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:598  

   Procedure FXP$INT requires 61 words for executable code.
   Procedure FXP$INT requires 6 words of local(AUTO) storage.

    No errors detected in file FXP$PIG.:E05TSI    .
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:599  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:600  
          MINI XREF LISTING

B$JIT.ERR.MID
       231**DCL       231--REDEF
B$JIT.SYSID
       230**DCL       568>>IF
B$JIT.XCONF
       368**DCL       582>>IF
B$JIT$
       416**DCL       225--IMP-PTR   568>>IF        582>>IF
B$TCB.STK$
       509**DCL       569>>ASSIGN
B$TCB$
       507**DCL       509--IMP-PTR   569>>ASSIGN
B$XCON.ERR
       518**DCL       569>>ASSIGN
B$XCON.ERR.ERR#
       518**DCL       518--REDEF
B$XCON.LIMIT.MEM
       516**DCL       516--REDEF
BREAK
       524**DCL       555<<ASSIGN
FLAG
       521**DCL       569<<ASSIGN
FPT_TRMPRG
       541**DCL       554<>CALL
FPT_TRMPRG.V
       548**DCL       543--DCLINIT
FPT_TRMPRG.V.CTLFLG.RSTBRK#
       549**DCL       550--REDEF
M$CLRSTK
        76**DCL-ENT   560--CALL      579--CALL
M$MERCS
        75**DCL-ENT   582--CALL
PL6.E3A0      #004=FXP$INT File=FXP$PIG.:E05TSI                                  THU 09/04/97 08:44 Page:601  
M$SAD
        57**DCL-ENT   561--CALL
M$SCREECH
        32**DCL-ENT   570--CALL
M$TRMPRG
        43**DCL-ENT   554--CALL
M$XCON
        73**DCL-ENT   583--CALL
NOALT
       559**LABEL     561--CALLALT
NOXCON
       428**DCL       583<>CALL
NOXCON.V
       429**DCL       428--DCLINIT
PIGSCR
       504**DCL       570<>CALL
PIGTRAP
       447**DCL       504--DCLINIT
SETSAD
       523**DCL       561<>CALL
TRAPCNT
         7**DCL       558>>IF        559<<ASSIGN    559>>ASSIGN    566>>IF        567<<ASSIGN    567>>ASSIGN
TRAPX
         8**DCL       563>>UNWIND
XCON
       563**LABEL     558--GOTO
XCONWIND
       522**DCL       566>>IF        580>>UNWIND
