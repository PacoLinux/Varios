VERSION E05

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:1    
        1        1        /*M* ACCEPT, DIRECTORY, PRIORITY, SETUP, TABS cmds */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DFC   */
        8        8        /*P*   NAME:   CPI$IBEX
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of selected IBEX commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPI$IBEX:
       16       16          PROC(P$PCB,MSGFLAG) ALTRET;
       17       17                   %INCLUDE CP_6;
       18       98                   %INCLUDE B$JIT;
       19      388                   %INCLUDE B_STRINGS_C;
       20      517                   %INCLUDE B_MACROS_C;
       21      628                   %INCLUDE CP_MACROS_C;
       22     1380                   %INCLUDE XU_MACRO_C;
       23     4486                   %INCLUDE CP_SUBS_C;
       24     5403                   %INCLUDE CP_PERR_C;
       25     5741                   %INCLUDE CP_6_SUBS;
       26     6281                   %INCLUDE F_ERRORS_C;
       27     6521                   %INCLUDE CP_DATA_R;
       28     9084                   %INCLUDE AS_SUPER_C;
       29     9519              /***** Ptr variable declarations *****/
       30     9520    1   DCL MSGFLAG BIT(1) ALIGNED;                         /*Parameter*/
       31     9521    1   DCL BLK$ PTR;                                    /*Parse output block ptr*/
       32     9522    1   DCL TEMP$ PTR;                                   /*Temp. Pointer*/
       33     9523    1   DCL P$ PTR;
       34     9524    1   DCL OUTBUFF$ PTR;                                /*Output buffer ptr*/
       35     9525    1   DCL DEST$ PTR;                                   /*Dynamic buffer ptr*/
       36     9526    1   DCL FID$ PTR;
       37     9527             /***** UBIN declarations *****/
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:2    
       38     9528    1   DCL I SBIN;                                      /*Temp. Loc. For indexes*/
       39     9529    1   DCL MODE SBIN;                                   /*MODE to use for SETUP*/
       40     9530    1   DCL TSTOR UBIN;                                  /*Temp. Storage*/
       41     9531    1   DCL VARY_CNT UBIN WORD ;                        /* CNT for VARY$STR */
       42     9532    1   DCL ASN UBIN(9);                                 /*Fid assignment type*/
       43     9533             /***** Character declarations *****/
       44     9534    1   DCL OUTBUFF CHAR(120);                           /*Text buffer*/
       45     9535    1   DCL TEMPBUFF CHAR(50);                           /*Temp. Buffer*/
       46     9536    1   DCL TBUFF CHAR(4);                               /*Temp. Buffer*/
       47     9537    1   DCL TABS_VAL UBIN;                               /*Tabs value for display*/
       48     9538    1   DCL CHR$ARY(0:0) CHAR(1) BASED;
       49     9539    1   DCL PRIO_HDR CONSTANT CHAR(22) INIT('   Batching Priority: ');
       50     9540    1   DCL MAX_PRIO CONSTANT CHAR(10) INIT('Maximum = ');
       51     9541    1   DCL DEF_PRIO CONSTANT CHAR(12) INIT('  Default = ');
       52     9542    1   DCL 1 M$DRDCB CONSTANT DALIGNED,    /* DCB for DRIBBLE */
       53     9543    1          2 CNT UBIN(9) INIT(4) UNAL,
       54     9544    1          2 TXT CHAR(4) INIT('M$DR');
       55     9545              /***** External procedure (entry) declarations *****/
       56     9546    1   DCL ASC$SETUP ENTRY(3) ALTRET;
       57     9547    1   DCL CPE$RZEROS ENTRY(3);                         /*Remove leading zeros*/
       58     9548    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;                /*Build print image*/
       59     9549    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;                 /*Output print image*/
       60     9550    1   DCL CPE$RFEXT ENTRY(1);                 /*Reset file extension*/
       61     9551    1   DCL CPC$WRITEMSGE ENTRY(6);
       62     9552    1   DCL CPC$RDUSERS ENTRY(2) ALTRET;
       63     9553    1   DCL CPC$WRUSERS ENTRY(1) ALTRET;
       64     9554    1   DCL CXP$POSTERR ENTRY(5);
       65     9555    1   DCL CPE$GENRUAM ENTRY(5) ALTRET;
       66     9556             /***** Based structures *****/
       67     9557        %B$TCB (STCLASS="BASED(B$TCB$)");
       68     9560        %B$EXCFR;
       69     9578        %B$ALT;
       70     9586        %P$PCB(NAME=P$PCB,STCLASS="");
       71     9787        %PARSE$OUT (NAME=P$B);
       72     9832        %PARSE$SYM (NAME=P$S);
       73     9870        %SEG$2(NAME=SEG$2);
       74     9930        %TEXTC(NAME=TEXT$C);
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:3    
       75     9935    1   DCL 1 MOV$STR BASED UNAL,
       76     9936    1         2 CNT UBIN BYTE CALIGNED,
       77     9937    1         2 TXT CHAR(MOV$STR.CNT) CALIGNED ;
       78     9938    1   DCL VARY$STR CHAR(VARY_CNT) BASED UNAL ;
       79     9939             /***** Fpts *****/
       80     9940        %FPT_SETFMA(FPTN=FPT_SETFMA,STCLASS=AUTO);
       81     9953        %FPT_FID(FPTN=FPT$FID,STCLASS=BASED);
       82     9976        %FPT_DEVICE(FPTN=FPT_DEVICE,STCLASS=AUTO);
       83     9994        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED);
       84    10025        %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
       85    10067        %FPT_TRMISC(FPTN=FPT_TRMISC,STCLASS=AUTO);
       86    10088        %FPT_DRIBBLE(FPTN=FPT_DRIBBLE,STCLASS=AUTO);
       87    10099        %F$DCB(DCBN=F$DCB);
       88    10156        %VLP_TAB(FPTN=VLP$TAB,STCLASS=BASED);
       89    10170        %VLP_TAB(FPTN=VLP_TAB,STCLASS=AUTO);
       90    10184        %VLP_NAME(FPTN=VLP_NAME,LEN=31,STCLASS=AUTO);
       91    10211        %VLP_ACCT(FPTN=VLP_ACCT,STCLASS=AUTO);
       92    10224        %VLP_SN(FPTN=VLP_SN,N=50,STCLASS=AUTO);
       93    10237        %VLR_FID(FPTN=FID_RESULTS,STCLASS=AUTO);
       94    10256        %AS_USERS(STR_NAME=AS_USERS,STCLASS=AUTO);
       95    10434        %AS_USERS(STR_NAME=AS$USERS,STCLASS=BASED);
       96    10612             /***** Error codes *****/
       97    10613        %ERR_CODE (NAME=E_NOSCMND,MID#=CPI$IBEXMID,CODE#=E$NOSCMND,STCLASS=CONSTANT);
       98    10633        %ERR_CODE (NAME=E_NOCHGSETUP,MID#=CPI$IBEXMID,CODE#=E$NOCHGSETUP,STCLASS=CONSTANT);
       99    10653        %ERR_CODE (NAME=E_NOROOM4SETUP,MID#=CPI$IBEXMID,CODE#=E$NOROOM4SETUP,STCLASS=
             10653            CONSTANT);
      100    10673                   %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:4    
      101    10674        /**********************************************************************/
      102    10675        /*F*    NAME:   CPI$ACCEPT
      103    10676                PURPOSE: The ACCEPT command is utilized to allow SEND,
      104    10677                        BROADCAST and tape mount messages to be output to the terminal .
      105    10678                REFERENCE: Programmers Reference Manual
      106    10679        */
      107    10680        /*D*    NAME:   CPI$ACCEPT
      108    10681                CALL:   CALL CPI$ACCEPT(P$PCB)
      109    10682                INTERFACE: None
      110    10683                INPUT:  P$PCB - parse control block
      111    10684                OUTPUT: None
      112    10685                DESCRIPTION: The ACCEPT command is scanned and the M$TRMISC pmme
      113    10686                        initialized with the appropriate information.
      114    10687        */
      115    10688        /**********************************************************************/
      116    10689        /**/
      117    10690        /**/
      118    10691    1   CPI$ACCEPT: ENTRY(P$PCB) ALTRET;
      119    10692    1     BLK$ = P$PCB.OUT$;
      120    10693    1     FPT_TRMISC = CFPT_TRMISC;
      121    10694    1     FPT_TRMISC.V_ = VECTOR(FPT_TRMISC.V);
      122    10695    1     FPT_TRMISC.V.DCB# = M$UC_NUM;
      123    10696    1     I = 0;
      124    10697    2     DO WHILE (I < BLK$->P$B.NSUBLKS);
      125    10698    2        P$ = BLK$->P$B.SUBLK$(I);
      126    10699    3        DO CASE(P$->P$B.CODE);
      127    10700    3         CASE(AC_ALL);
      128    10701    3           FPT_TRMISC.V.SEND# = %YES#;
      129    10702    3           FPT_TRMISC.V.BROADCAST# = %YES#;
      130    10703    3           FPT_TRMISC.V.ANNOUNCE# = %YES#;
      131    10704    3         CASE(AC_ANNOUNCE);
      132    10705    3           FPT_TRMISC.V.ANNOUNCE# = %YES#;
      133    10706    3         CASE(AC_BROADCAST);
      134    10707    3           FPT_TRMISC.V.BROADCAST# = %YES#;
      135    10708    3         CASE(AC_SEND);
      136    10709    3           FPT_TRMISC.V.SEND# = %YES#;
      137    10710    3         END;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:5    
      138    10711    2        I=I+1;
      139    10712    2     END;
      140    10713    1     CALL M$TRMISC (FPT_TRMISC) ALTRET(ACCEPT_ERR);
      141    10714    1     RETURN;
      142    10715    1   ACCEPT_ERR:
      143    10716    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
      144    10717    1     ALTRETURN;
      145    10718                %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:6    
      146    10719        /**********************************************************************/
      147    10720        /*F*   NAME:   CPI$DIRECTORY
      148    10721               PURPOSE: The DIRECTORY command is utilized to reset or display the
      149    10722                       user's file management directory consisting of an
      150    10723                       account and pack set name.
      151    10724               DESCRIPTION: A user is permitted to set either just an account or a pack
      152    10725                       set name and account to be utilized by file management.
      153    10726                       Specifying a RESET resets the account and pack set to
      154    10727                       their defaults. With no options specified, the account
      155    10728                       and pack set are displayed.
      156    10729               REFERENCE: Programmers Reference Manual
      157    10730        */
      158    10731        /*D*   NAME:   CPI$DIRECTORY
      159    10732               CALL:   CALL CPI$DIRECTORY(P$PCB)
      160    10733               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT,CPC$WRITEMSGE
      161    10734               INPUT:  P$PCB - parse control block
      162    10735               OUTPUT: B$JIT.FPSN - set,reset or displayed
      163    10736                       B$JIT.FACCN - set,reset or displayed
      164    10737               DESCRIPTION: If no sub-blocks are found, the account and pack set
      165    10738                       are displayed. If RESET is specified, the file management
      166    10739                       account is set to its default(always running account) and
      167    10740                       pack set to its default(blanks). The specified information for
      168    10741                       pack set and account is stored in the JIT if a user  is
      169    10742                       setting directory information.
      170    10743        */
      171    10744        /**********************************************************************/
      172    10745    1   CPI$DIRECTORY: ENTRY(P$PCB) ALTRET;
      173    10746        /**/
      174    10747        /**/
      175    10748    1     BLK$=P$PCB.OUT$;
      176    10749        /*
      177    10750          ****     No options after command indicates info. Is to be displayed
      178    10751        */
      179    10752    1     IF BLK$->P$B.NSUBLKS=0
      180    10753    1        THEN
      181    10754    2           DO;
      182    10755    2              OUTBUFF$=ADDR(OUTBUFF);
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:7    
      183    10756    2              DEST$=OUTBUFF$;
      184    10757        /* ****          Insert DIRECTORY: Into output image */
      185    10758    2              OUTBUFF='   Directory: ';
      186    10759    2              DEST$=PINCRC(DEST$,SIZEC('   DIRECTORY: '));    /*Bump pointer*/
      187    10760        /* ****          Insert pack set name if present */
      188    10761    2              CALL INDEX(TSTOR,' ',B$JIT.FPSN);
      189    10762    2              IF TSTOR>0
      190    10763    2                 THEN
      191    10764    3                    DO;
      192    10765    3                       TEMPBUFF='DP#';
      193    10766    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TEMPBUFF),3);
      194    10767    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(B$JIT.FPSN),TSTOR);
      195    10768    3                       CALL CONCAT(TEMPBUFF,'.',B$JIT.FACCN,' ');
      196    10769    3                       CALL INDEX(TSTOR,' ',TEMPBUFF);
      197    10770    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TEMPBUFF),TSTOR);
      198    10771    3                    END;
      199    10772    2                 ELSE
      200    10773        /*
      201    10774          ****           Insert only account
      202    10775        */
      203    10776    3                    DO;
      204    10777    3                       CALL CONCAT(TEMPBUFF,'.',B$JIT.FACCN,' ');
      205    10778    3                       CALL INDEX(TSTOR,' ',TEMPBUFF);
      206    10779    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TEMPBUFF),TSTOR);
      207    10780    3                    END;
      208    10781    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
      209    10782    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
      210    10783    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DIR50);
      211    10784    2              RETURN;
      212    10785    2           END;
      213    10786        /*
      214    10787          ****     Set or reset directory info. In jit
      215    10788        */
      216    10789    1     FPT_SETFMA = CFPT_SETFMA;
      217    10790    2     DO CASE(BLK$->P$B.SUBLK$(0)->P$B.CODE);
      218    10791    2      CASE(DIRRESETOPT);
      219    10792        /* ****      NOTE: No code required as default fpt is what's required*/
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:8    
      220    10793    2      CASE(FIDOPT);
      221    10794    2        SEG$2.FPT_FID$->FPT$FID.TEXTFID_=VECTOR(BLK$->P$B.
      222    10795    2             SUBLK$(0)->P$S.TEXTC$->TEXT$C.TEXT);
      223    10796    2        SEG$2.FPT_FID$->FPT$FID.NAME_=VECTOR(VLP_NAME);
      224    10797    2        SEG$2.FPT_FID$->FPT$FID.ACCT_=VECTOR(VLP_ACCT);
      225    10798    2        SEG$2.FPT_FID$->FPT$FID.PASS_=VECTOR(VLP_ACCT);
      226    10799    2        SEG$2.FPT_FID$->FPT$FID.SN_=VECTOR(VLP_SN);
      227    10800    2        SEG$2.FPT_FID$->FPT$FID.WSN_=VECTOR(VLP_ACCT);
      228    10801    2        SEG$2.FPT_FID$->FPT$FID.ASN_=VECTOR(ASN);
      229    10802    2        SEG$2.FPT_FID$->FPT$FID.RES_=VECTOR(TBUFF);
      230    10803    2        SEG$2.FPT_FID$->FPT$FID.RESULTS_=VECTOR(FID_RESULTS);
      231    10804    2        CALL M$FID(SEG$2.FPT_FID$->FPT$FID) ALTRET(DIR50);
      232    10805        /* ****         Determine if DP#NN.ACCT or .ACCT spec'd*/
      233    10806    2        FPT_SETFMA.ACCT_ = VECTOR(VLP_ACCT);
      234    10807    2        IF FID_RESULTS.SN
      235    10808
      236    10809    2           THEN /* Sn specified as well */
      237    10810    2              FPT_SETFMA.PSN_ = VECTOR(VLP_SN.SN#);
      238    10811    2      END;
      239    10812    1     CALL M$SETFMA (FPT_SETFMA) ALTRET(DIR50);
      240    10813    1     RETURN;
      241    10814    1   DIR50: ;
      242    10815    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
      243    10816    1     ALTRETURN;
      244    10817                %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:9    
      245    10818        /**********************************************************************/
      246    10819        /*F*    NAME:   CPI$DRIBBLE
      247    10820                PURPOSE: The DRIBBLE command provides a means of recording
      248    10821                        interactive terminal transactions on a device,file, or
      249    10822                        magnetic tape.
      250    10823                REFERENCE: Programmers Reference Manual
      251    10824        */
      252    10825        /*D*    NAME:   CPI$DRIBBLE
      253    10826                CALL:   CALL CPI$DRIBBLE(P$PCB)
      254    10827                INTERFACE: CPE$GENRUAM
      255    10828                INPUT:  P$PCB - parse control block
      256    10829                OUTPUT: M$DRIBBLE assign merge record created
      257    10830                DESCRIPTION: The DRIBBLE command is scanned and the presence of
      258    10831                        a fid determined. A dcb assignment is made for
      259    10832                        M$DRIBBLE if ON/OVER/INTO and a fid exists. The M$DRIBBLE
      260    10833                        pmme is executed to turn on the dribble process.
      261    10834        */
      262    10835        /**********************************************************************/
      263    10836        /**/
      264    10837        /**/
      265    10838    1   CPI$DRIBBLE: ENTRY(P$PCB) ALTRET;
      266    10839    1     FPT_DRIBBLE = CFPT_DRIBBLE;
      267    10840    1     FPT_DRIBBLE.V_ = VECTOR(FPT_DRIBBLE.V);
      268    10841    1     FPT_DRIBBLE.V.DRIBBLE# = %YES#;
      269    10842    1     BLK$ = P$PCB.OUT$;
      270    10843    1     I = 511;
      271    10844    1     IF BLK$->P$B.NSUBLKS > 0
      272    10845    1        THEN
      273    10846    2           DO;
      274    10847    2              TEMP$ = BLK$->P$B.SUBLK$(0);          /*PTR TO OVER,ON,INTO*/
      275    10848    2              FID$ = BLK$->P$B.SUBLK$(1)->P$B.SUBLK$(0); /*PTR TO FID */
      276    10849    2              I = BLK$ -> P$B.SUBLK$(1) -> P$S.CPOS;
      277    10850    2              CALL CPE$GENRUAM(BLK$,TEMP$,FID$,ADDR(DRIBBLEDCB),%YES#)
      278    10851    2                                           ALTRET(DRIB60);
      279    10852    2           END;
      280    10853    1     CALL CPE$RFEXT (ADDR(M$DRDCB));
      281    10854    1     CALL M$DRIBBLE(FPT_DRIBBLE) ALTRET(DRIB50);
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:10   
      282    10855    1     RETURN;
      283    10856    1   DRIB50:;
      284    10857    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),I,B$TCB.ALT$->B$ALT.ERR,,
      285    10858    1           B$TCB.ALT$->B$ALT.DCB#);
      286    10859    1   DRIB60:;
      287    10860    1     ALTRETURN;
      288    10861               %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:11   
      289    10862        /**********************************************************************/
      290    10863        /*F*   NAME:    CPI$PRIORITY
      291    10864               PURPOSE: The PRIORITY commmand is utilized to establish a user's
      292    10865                        batching default priorities or to display the current priorities
      293    10866                        (maximum and default).
      294    10867               REFERENCE: Programmers Reference Manual
      295    10868        */
      296    10869        /*D*   NAME:    CPI$PRIORITY
      297    10870               CALL:    CALL CPI$PRIORITY(P$PCB)
      298    10871               INTERFACE: NONE
      299    10872               INPUT:   P$PCB - parse control block
      300    10873                        B$JIT.MAXPRI - maximum priority
      301    10874                        B$JIT.DEFPRI - default priority
      302    10875               DESCRIPTION: The specified default priority is stored into the JIT.
      303    10876                        A user cannot specify a priority greater than his maximum
      304    10877                        which was established in his JIT at logon time.
      305    10878        */
      306    10879        /*********************************************************************/
      307    10880    1   CPI$PRIORITY: ENTRY(P$PCB) ALTRET;
      308    10881        /**/
      309    10882        /**/
      310    10883    1     BLK$ = P$PCB.OUT$;
      311    10884    1     IF BLK$->P$B.NSUBLKS=0
      312    10885    1        THEN
      313    10886    1           GOTO PRIO10;
      314    10887    1     CALL CHARBIN(TSTOR,BLK$->P$B.SUBLK$(0)->P$S.TEXT);
      315    10888    1     B$JIT.DEFPRI = TSTOR;
      316    10889    1     RETURN;
      317    10890        /*
      318    10891          ****  Display batching priority
      319    10892        */
      320    10893    1   PRIO10:;
      321    10894    1     OUTBUFF$=ADDR(OUTBUFF);
      322    10895    1     DEST$=OUTBUFF$;
      323    10896    1     OUTBUFF=' ';
      324    10897    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(PRIO_HDR),SIZEC(PRIO_HDR))
      325    10898    1          ALTRET(PRIO50);
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:12   
      326    10899    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(MAX_PRIO),SIZEC(MAX_PRIO))
      327    10900    1          ALTRET(PRIO50);
      328    10901    1     CALL BINCHAR(TBUFF,B$JIT.MAXPRI);
      329    10902    1     CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),TSTOR);
      330    10903    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),TSTOR)
      331    10904    1          ALTRET(PRIO50);
      332    10905    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(DEF_PRIO),SIZEC(DEF_PRIO))
      333    10906    1          ALTRET(PRIO50);
      334    10907    1     CALL BINCHAR(TBUFF,B$JIT.DEFPRI);
      335    10908    1     CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),TSTOR);
      336    10909    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),TSTOR)
      337    10910    1          ALTRET(PRIO50);
      338    10911    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
      339    10912    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
      340    10913    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PRIO50);
      341    10914    1     RETURN;
      342    10915    1   PRIO50:;
      343    10916    1     ALTRETURN;
      344    10917                   %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:13   
      345    10918        /**********************************************************************/
      346    10919        /*F*   NAME:   CPI$SETUP
      347    10920               PURPOSE: The SETUP command is utilized to create/modify FCOMMAND
      348    10921                       in the :USERS record. The specified command line will
      349    10922                       executed automatically at logon time.
      350    10923               REFERENCE: Programmers Reference Manual
      351    10924        */
      352    10925        /*D*   NAME:   CPI$SETUP
      353    10926               CALL:   CALL CPI$SETUP(P$PCB)
      354    10927               INTERFACE: CPC$GETDCB,CPC$RELDCB,CPC$RDUSERS,CPC$WRUSERS
      355    10928               INPUT:  parse control block
      356    10929                       MSGFLAG - indicates if msge. is to be output
      357    10930               OUTPUT: FCOMMAND initialized in :USERS or displayed
      358    10931               DESCRIPTION: The specified command is either stored into the :USERS
      359    10932                            record,reset, or displayed.
      360    10933                            The FCOMMAND initialized in :USERS is mode dependent.
      361    10934        */
      362    10935        /**********************************************************************/
      363    10936    1   CPI$SETUP: ENTRY(P$PCB,MSGFLAG) ALTRET;
      364    10937        /**/
      365    10938        /**/
      366    10939    1     BLK$=P$PCB.OUT$;
      367    10940    1     I = 0;
      368    10941    1     MODE = B$JIT.MODE;
      369    10942    1     IF BLK$->P$B.NSUBLKS>0 AND BLK$->P$B.SUBLK$(0)->P$B.CODE=SETUPMODE
      370    10943    2       THEN DO;
      371    10944    2         I = 1;
      372    10945    2         MODE = BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE;
      373    10946    2       END;
      374    10947        /*
      375    10948             ***** Force the :USERS file to be read...
      376    10949        */
      377    10950    1     SEG$2.FLAGS.USERS = %NO#;
      378    10951        /*
      379    10952          ****  No text after command infers a display
      380    10953        */
      381    10954    1     IF BLK$->P$B.NSUBLKS=I
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:14   
      382    10955    1        THEN
      383    10956    2           DO;
      384    10957    2              CALL CPC$RDUSERS (M$IBEX1_NUM,%IN#) ALTRET(SETUP55);
      385    10958        /*         **** Determine if fcommand in :USERS  */
      386    10959    2              IF SEG$2.USERS$ -> AS$USERS.SETUP(MODE-1) ~= -1
      387    10960    2                 THEN
      388    10961    3                    DO;
      389    10962    3                       TABS_VAL=6;
      390    10963    3                       OUTBUFF$=ADDR(OUTBUFF);
      391    10964    3                       DEST$=OUTBUFF$;
      392    10965    3                       OUTBUFF='   Setup: ';
      393    10966    3                       DEST$=PINCRC(DEST$,SIZEC('   Setup: '));
      394    10967    3                       TEMP$ = PINCRC(ADDR(SEG$2.USERS$->AS$USERS.SETUP_CHRA.TXT),
      395    10968    3                                           SEG$2.USERS$->AS$USERS.SETUP(MODE-1));
      396    10969    3                       VARY_CNT = TEMP$->MOV$STR.CNT;
      397    10970    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TEMP$->MOV$STR.TXT),
      398    10971    3                            VARY_CNT, TABS_VAL) ALTRET(SETUP55);
      399    10972    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
      400    10973    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
      401    10974    3                       CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(SETUP55);
      402    10975    3                    END;
      403    10976        /*
      404    10977          ****     Output msge by default or if specified. Do not want to output
      405    10978          ****     On users display.
      406    10979        */
      407    10980    2                 ELSE
      408    10981    2                    IF (ADDR(MSGFLAG)=ADDR(NIL))  OR (ADDR(MSGFLAG)~=ADDR(NIL)
      409    10982    2                         AND MSGFLAG=%YES#)
      410    10983
      411    10984    2                       THEN
      412    10985    3                          DO;
      413    10986        /*E*       ERROR:   CPI-E$NOSCMND-E
      414    10987                   MESSAGE: NO SETUP COMMAND
      415    10988                   DESCRIPTION: Command doesn't exist in :USERS record.
      416    10989        */
      417    10990    3                             CALL CPC$WRITEMSGE(E_NOSCMND,,,,,%YES#);
      418    10991    3                          END;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:15   
      419    10992    2              RETURN;
      420    10993    2           END;
      421    10994        /*
      422    10995             ***** Define a new setup cmd...
      423    10996        */
      424    10997    1     CALL CPC$RDUSERS (M$IBEX1_NUM,%UPDATE#) ALTRET(SETUP55);
      425    10998    1     IF SEG$2.USERS$ -> AS$USERS.SETUP_PERM(MODE-1)
      426    10999    1         THEN
      427    11000    2             DO ;                            /* Not allowed to change SETUP.    */
      428    11001    2               CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_NOCHGSETUP) ;
      429    11002    2               SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;
      430    11003    2               SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;
      431    11004    2               CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(SETUP55);
      432    11005    2               GOTO SETUP55 ;
      433    11006    2             END ; /* Then Do */
      434    11007        /*E*       ERROR:   CPI-E$NOCHGSETUP-C
      435    11008                   MESSAGE: You are not allowed to change your SETUP command.
      436    11009                   DESCRIPTION: The user is not allowed to change his SETUP command.
      437    11010        */
      438    11011    1     TEMP$ = ADDR(BLK$->P$B.SUBLK$(I)->P$S.COUNT) ;
      439    11012    1     CALL ASC$SETUP (SEG$2.USERS$, MODE-1, TEMP$->MOV$STR) WHENALTRETURN
      440    11013    2               DO ;
      441    11014    2                 CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),511,E_NOROOM4SETUP) ;
      442    11015    2                 GOTO SETUP55 ;
      443    11016    2               END ; /* Then Do */
      444    11017        /*E*       ERROR: CPI-E$NOROOM4SETUP-0
      445    11018                   MESSAGE: No room to put SETUP command.
      446    11019                   MESSAGE1: Because of the size of your SETUPs and BANNERTEXTs
      447    11020                             there is no more room for your SETUP command.
      448    11021                   DESCRIPTION: The user has run out of space for a SETUP command
      449    11022                                in his :USERS file.
      450    11023        */
      451    11024        /*
      452    11025             ***** Write the new setup cmd to the :USERS file...
      453    11026        */
      454    11027    1     CALL CPC$WRUSERS (M$IBEX1_NUM) ALTRET(SETUP55);
      455    11028    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:16   
      456    11029    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;
      457    11030    1     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(SETUP55);
      458    11031    1     RETURN;
      459    11032    1   SETUP55:;
      460    11033    1     ALTRETURN;
      461    11034                   %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:17   
      462    11035        /**********************************************************************/
      463    11036        /*F*   NAME:   CPI$TABS
      464    11037               PURPOSE: The TABS command is utilized to set or display
      465    11038                       simulated tab stops.
      466    11039               DESCRIPTION: A user is permitted to set up to 31 tabs in
      467    11040                       ascending sequence or to reset tabs by specifying 0,NO, or
      468    11041                       OFF. With no arguments, the current tab stop settings
      469    11042                       are displayed.
      470    11043               REFERENCE: Programmers Reference Manual
      471    11044        */
      472    11045        /*D*   NAME:   CPI$TABS
      473    11046               CALL:   CALL CPI$TABS(P$PCB)
      474    11047               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT,CPE$RZEROS
      475    11048               INPUT:  P$PCB - parse control block
      476    11049               OUTPUT: tabs set
      477    11050               DESCRIPTION: If no sub-blocks are found, the tab settings are
      478    11051                       displayed. Individual tab stops are set as specified by the
      479    11052                       various sub-blocks. All tab stops are reset if a 0,NO, or OFF
      480    11053                       is encountered.
      481    11054        */
      482    11055        /****************************************************************************/
      483    11056    1   CPI$TABS: ENTRY(P$PCB) ALTRET;
      484    11057        /**/
      485    11058        /**/
      486    11059    1     BLK$=P$PCB.OUT$;
      487    11060        /*
      488    11061          ****     No options after tabs indicates tabs are to be displayed
      489    11062        */
      490    11063    1     IF BLK$->P$B.NSUBLKS=0
      491    11064    1        THEN
      492    11065    2           DO;
      493    11066    2              TABS_VAL=6;
      494    11067    2              OUTBUFF$=ADDR(OUTBUFF);
      495    11068    2              DEST$=OUTBUFF$;
      496    11069        /* ****          Insert 'Tabs Set: ' into output image*/
      497    11070    2              OUTBUFF='   Tabs Set: ';
      498    11071    2              DEST$=PINCRC(DEST$,SIZEC('   Tabs Set: ')); /*Incr. To nxt LOC.*/
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:18   
      499    11072        /* ****          Insert tab values into output image*/
      500    11073    2              I=0;
      501    11074    2              TEMP$ = DCBADDR(M$UC_NUM) -> F$DCB.TAB$;
      502    11075    3              DO WHILE (TEMP$ -> VLP$TAB.TABS#(I) ~= 0 AND I < 31);
      503    11076    3                 CALL BINCHAR(TBUFF,TEMP$ -> VLP$TAB.TABS#(I));
      504    11077    3                 CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),TSTOR);
      505    11078    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),TSTOR,
      506    11079    3                      TABS_VAL) ALTRET(TABS50);
      507    11080    3                 TBUFF=',';
      508    11081    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),1,TABS_VAL) ALTRET(TABS50
             11081                          );
      509    11082    3                 I=I+1;
      510    11083    3              END;
      511    11084        /* ****          Determine if any tabs set   */
      512    11085    2              IF I>0
      513    11086    2                 THEN
      514    11087    2                    SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,
      515    11088    2                         OUTBUFF$)-2;
      516    11089    2                 ELSE
      517    11090    3                    DO;
      518    11091    3                       TBUFF='None';
      519    11092    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),4);
      520    11093    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,
      521    11094    3                            OUTBUFF$);
      522    11095    3                    END;
      523    11096    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
      524    11097    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TABS50);
      525    11098    2              RETURN;
      526    11099    2           END;
      527    11100        /*
      528    11101             ***** Set or reset specified TABS...
      529    11102        */
      530    11103    1     FPT_DEVICE = CFPT_DEVICE;
      531    11104    1     FPT_DEVICE.V_ = VECTOR(FPT_DEVICE.V);
      532    11105    1     FPT_DEVICE.V.DCB# = M$UC_NUM;
      533    11106    2     DO CASE(BLK$->P$B.SUBLK$(0)->P$B.CODE);
      534    11107    2      CASE(TABSLISTOPT);  /* list of tabs to set */
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:19   
      535    11108    2        VLP_TAB=CVLP_TAB;
      536    11109    2        FPT_DEVICE.TAB_ = VECTOR(VLP_TAB);
      537    11110    2        BLK$ = BLK$ -> P$B.SUBLK$(0);
      538    11111    3        DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;
      539    11112    3           TEMP$=BLK$->P$B.SUBLK$(I);
      540    11113    3           CALL CHARBIN(TSTOR,TEMP$->P$S.TEXT);
      541    11114    3           VLP_TAB.TABS#(I)=TSTOR;
      542    11115    3        END;
      543    11116    2      CASE(TABSRESETOPT);
      544    11117    2        FPT_DEVICE.TAB_ = VECTOR(ERASE);
      545    11118    2      END;
      546    11119    1     CALL M$DEVICE (FPT_DEVICE) ALTRET(TABS45);
      547    11120    1     RETURN;
      548    11121    1   TABS45: ;
      549    11122    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
      550    11123    1   TABS50: ;
      551    11124    1     ALTRETURN;
      552    11125    1   END CPI$IBEX;

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:20   
--  Include file information  --

   AS_SUPER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPI$IBEX.

   Procedure CPI$IBEX requires 1033 words for executable code.
   Procedure CPI$IBEX requires 712 words of local(AUTO) storage.

    No errors detected in file CPI$IBEX.:E05TSI    .

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:21   

 Object Unit name= CPI$IBEX                                   File name= CPI$IBEX.:E05TOU
 UTS= JUL 29 '97 11:50:39.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     34     42  CPI$IBEX
    2   Proc  even  none  1033   2011  CPI$IBEX
    3  RoData even  none    40     50  CPI$IBEX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  CPI$IBEX
     2      3          yes     yes      Std        1  CPI$ACCEPT
     2    121          yes     yes      Std        1  CPI$DIRECTORY
     2    553          yes     yes      Std        1  CPI$DRIBBLE
     2    670          yes     yes      Std        1  CPI$PRIORITY
     2   1130          yes     yes      Std        2  CPI$SETUP
     2   1461          yes     yes      Std        1  CPI$TABS
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:22   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       5 CPB$BLDIMAGE
         yes           Std       3 CPE$RZEROS
 yes     yes           Std       1 CPC$WRUSERS
 yes     yes           Std       1 CPE$LISTOUT
 yes     yes           Std       3 ASC$SETUP
 yes     yes           Std       2 CPC$RDUSERS
         yes           Std       6 CPC$WRITEMSGE
 yes     yes           Std       5 CPE$GENRUAM
         yes           Std       1 CPE$RFEXT
         yes           Std       5 CXP$POSTERR
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CFPT_TRMISC                           CFPT_DEVICE
     CFPT_SETFMA                           DRIBBLEDCB                            CVLP_TAB
     CFPT_DRIBBLE                     r    SEG2$                            r    B$JIT$
r    B$TCB$                                M$UC_NUM                              M$IBEX1_NUM
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 NULLSID                               ISSID
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:23   


        1        1        /*M* ACCEPT, DIRECTORY, PRIORITY, SETUP, TABS cmds */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DFC   */
        8        8        /*P*   NAME:   CPI$IBEX
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of selected IBEX commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPI$IBEX:
       16       16          PROC(P$PCB,MSGFLAG) ALTRET;

     16  2 000000   000000 700200 xent  CPI$IBEX     TSX0  ! X66_AUTO_2
         2 000001   001310 000002                    ZERO    712,2
         2 000002   000005 710000 2                  TRA     s:10692

       17       17                   %INCLUDE CP_6;
       18       98                   %INCLUDE B$JIT;
       19      388                   %INCLUDE B_STRINGS_C;
       20      517                   %INCLUDE B_MACROS_C;
       21      628                   %INCLUDE CP_MACROS_C;
       22     1380                   %INCLUDE XU_MACRO_C;
       23     4486                   %INCLUDE CP_SUBS_C;
       24     5403                   %INCLUDE CP_PERR_C;
       25     5741                   %INCLUDE CP_6_SUBS;
       26     6281                   %INCLUDE F_ERRORS_C;
       27     6521                   %INCLUDE CP_DATA_R;
       28     9084                   %INCLUDE AS_SUPER_C;
       29     9519              /***** Ptr variable declarations *****/
       30     9520    1   DCL MSGFLAG BIT(1) ALIGNED;                         /*Parameter*/
       31     9521    1   DCL BLK$ PTR;                                    /*Parse output block ptr*/
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:24   
       32     9522    1   DCL TEMP$ PTR;                                   /*Temp. Pointer*/
       33     9523    1   DCL P$ PTR;
       34     9524    1   DCL OUTBUFF$ PTR;                                /*Output buffer ptr*/
       35     9525    1   DCL DEST$ PTR;                                   /*Dynamic buffer ptr*/
       36     9526    1   DCL FID$ PTR;
       37     9527             /***** UBIN declarations *****/
       38     9528    1   DCL I SBIN;                                      /*Temp. Loc. For indexes*/
       39     9529    1   DCL MODE SBIN;                                   /*MODE to use for SETUP*/
       40     9530    1   DCL TSTOR UBIN;                                  /*Temp. Storage*/
       41     9531    1   DCL VARY_CNT UBIN WORD ;                        /* CNT for VARY$STR */
       42     9532    1   DCL ASN UBIN(9);                                 /*Fid assignment type*/
       43     9533             /***** Character declarations *****/
       44     9534    1   DCL OUTBUFF CHAR(120);                           /*Text buffer*/
       45     9535    1   DCL TEMPBUFF CHAR(50);                           /*Temp. Buffer*/
       46     9536    1   DCL TBUFF CHAR(4);                               /*Temp. Buffer*/
       47     9537    1   DCL TABS_VAL UBIN;                               /*Tabs value for display*/
       48     9538    1   DCL CHR$ARY(0:0) CHAR(1) BASED;
       49     9539    1   DCL PRIO_HDR CONSTANT CHAR(22) INIT('   Batching Priority: ');
       50     9540    1   DCL MAX_PRIO CONSTANT CHAR(10) INIT('Maximum = ');
       51     9541    1   DCL DEF_PRIO CONSTANT CHAR(12) INIT('  Default = ');
       52     9542    1   DCL 1 M$DRDCB CONSTANT DALIGNED,    /* DCB for DRIBBLE */
       53     9543    1          2 CNT UBIN(9) INIT(4) UNAL,
       54     9544    1          2 TXT CHAR(4) INIT('M$DR');
       55     9545              /***** External procedure (entry) declarations *****/
       56     9546    1   DCL ASC$SETUP ENTRY(3) ALTRET;
       57     9547    1   DCL CPE$RZEROS ENTRY(3);                         /*Remove leading zeros*/
       58     9548    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;                /*Build print image*/
       59     9549    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;                 /*Output print image*/
       60     9550    1   DCL CPE$RFEXT ENTRY(1);                 /*Reset file extension*/
       61     9551    1   DCL CPC$WRITEMSGE ENTRY(6);
       62     9552    1   DCL CPC$RDUSERS ENTRY(2) ALTRET;
       63     9553    1   DCL CPC$WRUSERS ENTRY(1) ALTRET;
       64     9554    1   DCL CXP$POSTERR ENTRY(5);
       65     9555    1   DCL CPE$GENRUAM ENTRY(5) ALTRET;
       66     9556             /***** Based structures *****/
       67     9557        %B$TCB (STCLASS="BASED(B$TCB$)");
       68     9560        %B$EXCFR;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:25   
       69     9578        %B$ALT;
       70     9586        %P$PCB(NAME=P$PCB,STCLASS="");
       71     9787        %PARSE$OUT (NAME=P$B);
       72     9832        %PARSE$SYM (NAME=P$S);
       73     9870        %SEG$2(NAME=SEG$2);
       74     9930        %TEXTC(NAME=TEXT$C);
       75     9935    1   DCL 1 MOV$STR BASED UNAL,
       76     9936    1         2 CNT UBIN BYTE CALIGNED,
       77     9937    1         2 TXT CHAR(MOV$STR.CNT) CALIGNED ;
       78     9938    1   DCL VARY$STR CHAR(VARY_CNT) BASED UNAL ;
       79     9939             /***** Fpts *****/
       80     9940        %FPT_SETFMA(FPTN=FPT_SETFMA,STCLASS=AUTO);
       81     9953        %FPT_FID(FPTN=FPT$FID,STCLASS=BASED);
       82     9976        %FPT_DEVICE(FPTN=FPT_DEVICE,STCLASS=AUTO);
       83     9994        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED);
       84    10025        %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
       85    10067        %FPT_TRMISC(FPTN=FPT_TRMISC,STCLASS=AUTO);
       86    10088        %FPT_DRIBBLE(FPTN=FPT_DRIBBLE,STCLASS=AUTO);
       87    10099        %F$DCB(DCBN=F$DCB);
       88    10156        %VLP_TAB(FPTN=VLP$TAB,STCLASS=BASED);
       89    10170        %VLP_TAB(FPTN=VLP_TAB,STCLASS=AUTO);
       90    10184        %VLP_NAME(FPTN=VLP_NAME,LEN=31,STCLASS=AUTO);
       91    10211        %VLP_ACCT(FPTN=VLP_ACCT,STCLASS=AUTO);
       92    10224        %VLP_SN(FPTN=VLP_SN,N=50,STCLASS=AUTO);
       93    10237        %VLR_FID(FPTN=FID_RESULTS,STCLASS=AUTO);
       94    10256        %AS_USERS(STR_NAME=AS_USERS,STCLASS=AUTO);
       95    10434        %AS_USERS(STR_NAME=AS$USERS,STCLASS=BASED);
       96    10612             /***** Error codes *****/
       97    10613        %ERR_CODE (NAME=E_NOSCMND,MID#=CPI$IBEXMID,CODE#=E$NOSCMND,STCLASS=CONSTANT);
       98    10633        %ERR_CODE (NAME=E_NOCHGSETUP,MID#=CPI$IBEXMID,CODE#=E$NOCHGSETUP,STCLASS=CONSTANT);
       99    10653        %ERR_CODE (NAME=E_NOROOM4SETUP,MID#=CPI$IBEXMID,CODE#=E$NOROOM4SETUP,STCLASS=
             10653            CONSTANT);
      100    10673                   %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:26   
      101    10674        /**********************************************************************/
      102    10675        /*F*    NAME:   CPI$ACCEPT
      103    10676                PURPOSE: The ACCEPT command is utilized to allow SEND,
      104    10677                        BROADCAST and tape mount messages to be output to the terminal .
      105    10678                REFERENCE: Programmers Reference Manual
      106    10679        */
      107    10680        /*D*    NAME:   CPI$ACCEPT
      108    10681                CALL:   CALL CPI$ACCEPT(P$PCB)
      109    10682                INTERFACE: None
      110    10683                INPUT:  P$PCB - parse control block
      111    10684                OUTPUT: None
      112    10685                DESCRIPTION: The ACCEPT command is scanned and the M$TRMISC pmme
      113    10686                        initialized with the appropriate information.
      114    10687        */
      115    10688        /**********************************************************************/
      116    10689        /**/
      117    10690        /**/
      118    10691    1   CPI$ACCEPT: ENTRY(P$PCB) ALTRET;

  10691  2 000003   000000 700200 xent  CPI$ACCEPT   TSX0  ! X66_AUTO_2
         2 000004   001310 000002                    ZERO    712,2

      119    10692    1     BLK$ = P$PCB.OUT$;

  10692  2 000005   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000006   000003 236100                    LDQ     3,,PR0
         2 000007   200005 756100                    STQ     BLK$,,AUTO

      120    10693    1     FPT_TRMISC = CFPT_TRMISC;

  10693  2 000010   000100 100400                    MLR     fill='000'O
         2 000011   000000 000030 xsym               ADSC9   CFPT_TRMISC              cn=0,n=24
         2 000012   200114 000030                    ADSC9   FPT_TRMISC,,AUTO         cn=0,n=24

      121    10694    1     FPT_TRMISC.V_ = VECTOR(FPT_TRMISC.V);

  10694  2 000013   000000 235000 3                  LDA     0
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:27   
         2 000014   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000015   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000016   000120 036003                    ADLQ    80,DU
         2 000017   200114 757100                    STAQ    FPT_TRMISC,,AUTO

      122    10695    1     FPT_TRMISC.V.DCB# = M$UC_NUM;

  10695  2 000020   000000 720000 xsym               LXL0    M$UC_NUM
         2 000021   200120 740100                    STX0    FPT_TRMISC+4,,AUTO

      123    10696    1     I = 0;

  10696  2 000022   200013 450100                    STZ     I,,AUTO

      124    10697    2     DO WHILE (I < BLK$->P$B.NSUBLKS);

  10697  2 000023   200005 471500                    LDP1    BLK$,,AUTO
         2 000024   100001 236100                    LDQ     1,,PR1
         2 000025   000022 772000                    QRL     18
         2 000026   200013 116100                    CMPQ    I,,AUTO
         2 000027   000106 604400 2                  TMOZ    s:10713

      125    10698    2        P$ = BLK$->P$B.SUBLK$(I);

  10698  2 000030   200005 470500                    LDP0    BLK$,,AUTO
         2 000031   200013 720100                    LXL0    I,,AUTO
         2 000032   000003 236110                    LDQ     3,X0,PR0
         2 000033   200007 756100                    STQ     P$,,AUTO

      126    10699    3        DO CASE(P$->P$B.CODE);

  10699  2 000034   200007 471500                    LDP1    P$,,AUTO
         2 000035   100000 721100                    LXL1    0,,PR1
         2 000036   000005 101003                    CMPX1   5,DU
         2 000037   000041 602011 2                  TNC     s:10699+5,X1
         2 000040   000101 710000 2                  TRA     s:10711
         2 000041   000101 710000 2                  TRA     s:10711
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:28   
         2 000042   000046 710000 2                  TRA     s:10701
         2 000043   000063 710000 2                  TRA     s:10705
         2 000044   000070 710000 2                  TRA     s:10707
         2 000045   000075 710000 2                  TRA     s:10709

      127    10700    3         CASE(AC_ALL);

      128    10701    3           FPT_TRMISC.V.SEND# = %YES#;

  10701  2 000046   200121 236100                    LDQ     FPT_TRMISC+5,,AUTO
         2 000047   000001 376000 3                  ANQ     1
         2 000050   400000 276003                    ORQ     -131072,DU
         2 000051   200121 756100                    STQ     FPT_TRMISC+5,,AUTO

      129    10702    3           FPT_TRMISC.V.BROADCAST# = %YES#;

  10702  2 000052   200121 236100                    LDQ     FPT_TRMISC+5,,AUTO
         2 000053   000002 376000 3                  ANQ     2
         2 000054   100000 276003                    ORQ     32768,DU
         2 000055   200121 756100                    STQ     FPT_TRMISC+5,,AUTO

      130    10703    3           FPT_TRMISC.V.ANNOUNCE# = %YES#;

  10703  2 000056   200121 236100                    LDQ     FPT_TRMISC+5,,AUTO
         2 000057   000003 376000 3                  ANQ     3
         2 000060   020000 276003                    ORQ     8192,DU
         2 000061   200121 756100                    STQ     FPT_TRMISC+5,,AUTO
         2 000062   000101 710000 2                  TRA     s:10711

      131    10704    3         CASE(AC_ANNOUNCE);

      132    10705    3           FPT_TRMISC.V.ANNOUNCE# = %YES#;

  10705  2 000063   200121 236100                    LDQ     FPT_TRMISC+5,,AUTO
         2 000064   000003 376000 3                  ANQ     3
         2 000065   020000 276003                    ORQ     8192,DU
         2 000066   200121 756100                    STQ     FPT_TRMISC+5,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:29   
         2 000067   000101 710000 2                  TRA     s:10711

      133    10706    3         CASE(AC_BROADCAST);

      134    10707    3           FPT_TRMISC.V.BROADCAST# = %YES#;

  10707  2 000070   200121 236100                    LDQ     FPT_TRMISC+5,,AUTO
         2 000071   000002 376000 3                  ANQ     2
         2 000072   100000 276003                    ORQ     32768,DU
         2 000073   200121 756100                    STQ     FPT_TRMISC+5,,AUTO
         2 000074   000101 710000 2                  TRA     s:10711

      135    10708    3         CASE(AC_SEND);

      136    10709    3           FPT_TRMISC.V.SEND# = %YES#;

  10709  2 000075   200121 236100                    LDQ     FPT_TRMISC+5,,AUTO
         2 000076   000001 376000 3                  ANQ     1
         2 000077   400000 276003                    ORQ     -131072,DU
         2 000100   200121 756100                    STQ     FPT_TRMISC+5,,AUTO

      137    10710    3         END;

      138    10711    2        I=I+1;

  10711  2 000101   200013 054100                    AOS     I,,AUTO

      139    10712    2     END;

  10712  2 000102   000001 236100                    LDQ     1,,PR0
         2 000103   000022 772000                    QRL     18
         2 000104   200013 116100                    CMPQ    I,,AUTO
         2 000105   000030 605400 2                  TPNZ    s:10698

      140    10713    1     CALL M$TRMISC (FPT_TRMISC) ALTRET(ACCEPT_ERR);

  10713  2 000106   200114 630500                    EPPR0   FPT_TRMISC,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:30   
         2 000107   560020 713400                    CLIMB   alt,+57360
         2 000110   400400 401760                    pmme    nvectors=2
         2 000111   000113 702000 2                  TSX2    ACCEPT_ERR

      141    10714    1     RETURN;

  10714  2 000112   000000 702200 xent               TSX2  ! X66_ARET

      142    10715    1   ACCEPT_ERR:
      143    10716    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  10716  2 000113   000000 470400 xsym  ACCEPT_ERR   LDP0    B$TCB$
         2 000114   000000 471500                    LDP1    0,,PR0
         2 000115   100102 236100                    LDQ     66,,PR1
         2 000116   000000 473400 xsym               LDP3    B$JIT$
         2 000117   300144 756100                    STQ     100,,PR3

      144    10717    1     ALTRETURN;

  10717  2 000120   000000 702200 xent               TSX2  ! X66_AALT

      145    10718                %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:31   
      146    10719        /**********************************************************************/
      147    10720        /*F*   NAME:   CPI$DIRECTORY
      148    10721               PURPOSE: The DIRECTORY command is utilized to reset or display the
      149    10722                       user's file management directory consisting of an
      150    10723                       account and pack set name.
      151    10724               DESCRIPTION: A user is permitted to set either just an account or a pack
      152    10725                       set name and account to be utilized by file management.
      153    10726                       Specifying a RESET resets the account and pack set to
      154    10727                       their defaults. With no options specified, the account
      155    10728                       and pack set are displayed.
      156    10729               REFERENCE: Programmers Reference Manual
      157    10730        */
      158    10731        /*D*   NAME:   CPI$DIRECTORY
      159    10732               CALL:   CALL CPI$DIRECTORY(P$PCB)
      160    10733               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT,CPC$WRITEMSGE
      161    10734               INPUT:  P$PCB - parse control block
      162    10735               OUTPUT: B$JIT.FPSN - set,reset or displayed
      163    10736                       B$JIT.FACCN - set,reset or displayed
      164    10737               DESCRIPTION: If no sub-blocks are found, the account and pack set
      165    10738                       are displayed. If RESET is specified, the file management
      166    10739                       account is set to its default(always running account) and
      167    10740                       pack set to its default(blanks). The specified information for
      168    10741                       pack set and account is stored in the JIT if a user  is
      169    10742                       setting directory information.
      170    10743        */
      171    10744        /**********************************************************************/
      172    10745    1   CPI$DIRECTORY: ENTRY(P$PCB) ALTRET;

  10745  2 000121   000000 700200 xent  CPI$DIRECTO* TSX0  ! X66_AUTO_2
         2 000122   001310 000002                    ZERO    712,2

      173    10746        /**/
      174    10747        /**/
      175    10748    1     BLK$=P$PCB.OUT$;

  10748  2 000123   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000124   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:32   
         2 000125   200005 756100                    STQ     BLK$,,AUTO

      176    10749        /*
      177    10750          ****     No options after command indicates info. Is to be displayed
      178    10751        */
      179    10752    1     IF BLK$->P$B.NSUBLKS=0

  10752  2 000126   200005 471500                    LDP1    BLK$,,AUTO
         2 000127   100001 220100                    LDX0    1,,PR1
         2 000130   000326 601000 2                  TNZ     s:10789

      180    10753    1        THEN
      181    10754    2           DO;

      182    10755    2              OUTBUFF$=ADDR(OUTBUFF);

  10755  2 000131   200020 633500                    EPPR3   OUTBUFF,,AUTO
         2 000132   200010 453500                    STP3    OUTBUFF$,,AUTO

      183    10756    2              DEST$=OUTBUFF$;

  10756  2 000133   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 000134   200011 756100                    STQ     DEST$,,AUTO

      184    10757        /* ****          Insert DIRECTORY: Into output image */
      185    10758    2              OUTBUFF='   Directory: ';

  10758  2 000135   040100 100400                    MLR     fill='040'O
         2 000136   000021 000016 1                  ADSC9   E_NOROOM4SETUP+1         cn=0,n=14
         2 000137   200020 000170                    ADSC9   OUTBUFF,,AUTO            cn=0,n=120

      186    10759    2              DEST$=PINCRC(DEST$,SIZEC('   DIRECTORY: '));    /*Bump pointer*/

  10759  2 000140   000004 036000 3                  ADLQ    4
         2 000141   200011 756100                    STQ     DEST$,,AUTO

      187    10760        /* ****          Insert pack set name if present */
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:33   
      188    10761    2              CALL INDEX(TSTOR,' ',B$JIT.FPSN);

  10761  2 000142   000000 474400 xsym               LDP4    B$JIT$
         2 000143   000000 124500                    SCM     mask='000'O
         2 000144   400021 000006                    ADSC9   17,,PR4                  cn=0,n=6
         2 000145   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000146   200015 000100                    ARG     TSTOR,,AUTO

      189    10762    2              IF TSTOR>0

  10762  2 000147   200015 235100                    LDA     TSTOR,,AUTO
         2 000150   000245 600000 2                  TZE     s:10777

      190    10763    2                 THEN
      191    10764    3                    DO;

      192    10765    3                       TEMPBUFF='DP#';

  10765  2 000151   040100 100400                    MLR     fill='040'O
         2 000152   000031 000003 1                  ADSC9   E_NOROOM4SETUP+9         cn=0,n=3
         2 000153   200056 000062                    ADSC9   TEMPBUFF,,AUTO           cn=0,n=50

      193    10766    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TEMPBUFF),3);

  10766  2 000154   200056 635500                    EPPR5   TEMPBUFF,,AUTO
         2 000155   201302 455500                    STP5    FID_RESULTS+526,,AUTO
         2 000156   000005 236000 3                  LDQ     5
         2 000157   201307 756100                    STQ     FID_RESULTS+531,,AUTO
         2 000160   201302 636500                    EPPR6   FID_RESULTS+526,,AUTO
         2 000161   201306 456500                    STP6    FID_RESULTS+530,,AUTO
         2 000162   200011 637500                    EPPR7   DEST$,,AUTO
         2 000163   201305 457500                    STP7    FID_RESULTS+529,,AUTO
         2 000164   200010 630500                    EPPR0   OUTBUFF$,,AUTO
         2 000165   201304 450500                    STP0    FID_RESULTS+528,,AUTO
         2 000166   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 000167   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000170   000000 701000 xent               TSX1    CPB$BLDIMAGE
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:34   
         2 000171   000000 011000                    NOP     0

      194    10767    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(B$JIT.FPSN),TSTOR);

  10767  2 000172   000000 236000 xsym               LDQ     B$JIT$
         2 000173   000021 036003                    ADLQ    17,DU
         2 000174   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 000175   200015 630500                    EPPR0   TSTOR,,AUTO
         2 000176   201307 450500                    STP0    FID_RESULTS+531,,AUTO
         2 000177   201302 631500                    EPPR1   FID_RESULTS+526,,AUTO
         2 000200   201306 451500                    STP1    FID_RESULTS+530,,AUTO
         2 000201   200011 633500                    EPPR3   DEST$,,AUTO
         2 000202   201305 453500                    STP3    FID_RESULTS+529,,AUTO
         2 000203   200010 634500                    EPPR4   OUTBUFF$,,AUTO
         2 000204   201304 454500                    STP4    FID_RESULTS+528,,AUTO
         2 000205   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 000206   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000207   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000210   000000 011000                    NOP     0

      195    10768    3                       CALL CONCAT(TEMPBUFF,'.',B$JIT.FACCN,' ');

  10768  2 000211   056000 236003                    LDQ     23552,DU
         2 000212   200056 756100                    STQ     TEMPBUFF,,AUTO
         2 000213   000000 470400 xsym               LDP0    B$JIT$
         2 000214   040100 100500                    MLR     fill='040'O
         2 000215   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         2 000216   200056 200010                    ADSC9   TEMPBUFF,,AUTO           cn=1,n=8
         2 000217   040100 100400                    MLR     fill='040'O
         2 000220   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000221   200060 200051                    ADSC9   TEMPBUFF+2,,AUTO         cn=1,n=41

      196    10769    3                       CALL INDEX(TSTOR,' ',TEMPBUFF);

  10769  2 000222   000000 124500                    SCM     mask='000'O
         2 000223   200056 000062                    ADSC9   TEMPBUFF,,AUTO           cn=0,n=50
         2 000224   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:35   
         2 000225   200015 000100                    ARG     TSTOR,,AUTO

      197    10770    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TEMPBUFF),TSTOR);

  10770  2 000226   200056 630500                    EPPR0   TEMPBUFF,,AUTO
         2 000227   201302 450500                    STP0    FID_RESULTS+526,,AUTO
         2 000230   200015 631500                    EPPR1   TSTOR,,AUTO
         2 000231   201307 451500                    STP1    FID_RESULTS+531,,AUTO
         2 000232   201302 633500                    EPPR3   FID_RESULTS+526,,AUTO
         2 000233   201306 453500                    STP3    FID_RESULTS+530,,AUTO
         2 000234   200011 634500                    EPPR4   DEST$,,AUTO
         2 000235   201305 454500                    STP4    FID_RESULTS+529,,AUTO
         2 000236   200010 635500                    EPPR5   OUTBUFF$,,AUTO
         2 000237   201304 455500                    STP5    FID_RESULTS+528,,AUTO
         2 000240   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 000241   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000242   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000243   000000 011000                    NOP     0

      198    10771    3                    END;

  10771  2 000244   000277 710000 2                  TRA     s:10781

      199    10772    2                 ELSE
      200    10773        /*
      201    10774          ****           Insert only account
      202    10775        */
      203    10776    3                    DO;

      204    10777    3                       CALL CONCAT(TEMPBUFF,'.',B$JIT.FACCN,' ');

  10777  2 000245   056000 236003                    LDQ     23552,DU
         2 000246   200056 756100                    STQ     TEMPBUFF,,AUTO
         2 000247   040100 100500                    MLR     fill='040'O
         2 000250   400006 000010                    ADSC9   6,,PR4                   cn=0,n=8
         2 000251   200056 200010                    ADSC9   TEMPBUFF,,AUTO           cn=1,n=8
         2 000252   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:36   
         2 000253   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000254   200060 200051                    ADSC9   TEMPBUFF+2,,AUTO         cn=1,n=41

      205    10778    3                       CALL INDEX(TSTOR,' ',TEMPBUFF);

  10778  2 000255   000000 124500                    SCM     mask='000'O
         2 000256   200056 000062                    ADSC9   TEMPBUFF,,AUTO           cn=0,n=50
         2 000257   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000260   200015 000100                    ARG     TSTOR,,AUTO

      206    10779    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TEMPBUFF),TSTOR);

  10779  2 000261   200056 630500                    EPPR0   TEMPBUFF,,AUTO
         2 000262   201302 450500                    STP0    FID_RESULTS+526,,AUTO
         2 000263   200015 631500                    EPPR1   TSTOR,,AUTO
         2 000264   201307 451500                    STP1    FID_RESULTS+531,,AUTO
         2 000265   201302 633500                    EPPR3   FID_RESULTS+526,,AUTO
         2 000266   201306 453500                    STP3    FID_RESULTS+530,,AUTO
         2 000267   200011 634500                    EPPR4   DEST$,,AUTO
         2 000270   201305 454500                    STP4    FID_RESULTS+529,,AUTO
         2 000271   200010 635500                    EPPR5   OUTBUFF$,,AUTO
         2 000272   201304 455500                    STP5    FID_RESULTS+528,,AUTO
         2 000273   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 000274   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000275   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000276   000000 011000                    NOP     0

      207    10780    3                    END;

      208    10781    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  10781  2 000277   000000 470400 xsym               LDP0    SEG2$
         2 000300   000165 471500                    LDP1    117,,PR0
         2 000301   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 000302   000020 772000                    QRL     16
         2 000303   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 000304   200011 236100                    LDQ     DEST$,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:37   
         2 000305   000020 772000                    QRL     16
         2 000306   201302 136100                    SBLQ    FID_RESULTS+526,,AUTO
         2 000307   000020 736000                    QLS     16
         2 000310   100004 676100                    ERQ     4,,PR1
         2 000311   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000312   100004 656100                    ERSQ    4,,PR1

      209    10782    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  10782  2 000313   000165 471500                    LDP1    117,,PR0
         2 000314   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 000315   100005 756100                    STQ     5,,PR1

      210    10783    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DIR50);

  10783  2 000316   000000 236000 xsym               LDQ     SEG2$
         2 000317   000165 036003                    ADLQ    117,DU
         2 000320   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 000321   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 000322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000323   000000 701000 xent               TSX1    CPE$LISTOUT
         2 000324   000545 702000 2                  TSX2    DIR50

      211    10784    2              RETURN;

  10784  2 000325   000000 702200 xent               TSX2  ! X66_ARET

      212    10785    2           END;
      213    10786        /*
      214    10787          ****     Set or reset directory info. In jit
      215    10788        */
      216    10789    1     FPT_SETFMA = CFPT_SETFMA;

  10789  2 000326   000100 100400                    MLR     fill='000'O
         2 000327   000000 000020 xsym               ADSC9   CFPT_SETFMA              cn=0,n=16
         2 000330   200076 000020                    ADSC9   FPT_SETFMA,,AUTO         cn=0,n=16

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:38   
      217    10790    2     DO CASE(BLK$->P$B.SUBLK$(0)->P$B.CODE);

  10790  2 000331   100003 473500                    LDP3    3,,PR1
         2 000332   300000 720100                    LXL0    0,,PR3
         2 000333   000062 100003                    CMPX0   50,DU
         2 000334   000336 602010 2                  TNC     s:10790+5,X0
         2 000335   000540 710000 2                  TRA     s:10812
         2 000336   000540 710000 2                  TRA     s:10812
         2 000337   000540 710000 2                  TRA     s:10812
         2 000340   000540 710000 2                  TRA     s:10812
         2 000341   000540 710000 2                  TRA     s:10812
         2 000342   000540 710000 2                  TRA     s:10812
         2 000343   000540 710000 2                  TRA     s:10812
         2 000344   000540 710000 2                  TRA     s:10812
         2 000345   000540 710000 2                  TRA     s:10812
         2 000346   000540 710000 2                  TRA     s:10812
         2 000347   000540 710000 2                  TRA     s:10812
         2 000350   000540 710000 2                  TRA     s:10812
         2 000351   000540 710000 2                  TRA     s:10812
         2 000352   000540 710000 2                  TRA     s:10812
         2 000353   000540 710000 2                  TRA     s:10812
         2 000354   000540 710000 2                  TRA     s:10812
         2 000355   000540 710000 2                  TRA     s:10812
         2 000356   000540 710000 2                  TRA     s:10812
         2 000357   000540 710000 2                  TRA     s:10812
         2 000360   000540 710000 2                  TRA     s:10812
         2 000361   000540 710000 2                  TRA     s:10812
         2 000362   000540 710000 2                  TRA     s:10812
         2 000363   000540 710000 2                  TRA     s:10812
         2 000364   000540 710000 2                  TRA     s:10812
         2 000365   000540 710000 2                  TRA     s:10812
         2 000366   000540 710000 2                  TRA     s:10812
         2 000367   000540 710000 2                  TRA     s:10812
         2 000370   000540 710000 2                  TRA     s:10812
         2 000371   000540 710000 2                  TRA     s:10812
         2 000372   000540 710000 2                  TRA     s:10812
         2 000373   000540 710000 2                  TRA     s:10812
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:39   
         2 000374   000540 710000 2                  TRA     s:10812
         2 000375   000540 710000 2                  TRA     s:10812
         2 000376   000540 710000 2                  TRA     s:10812
         2 000377   000540 710000 2                  TRA     s:10812
         2 000400   000540 710000 2                  TRA     s:10812
         2 000401   000540 710000 2                  TRA     s:10812
         2 000402   000540 710000 2                  TRA     s:10812
         2 000403   000540 710000 2                  TRA     s:10812
         2 000404   000540 710000 2                  TRA     s:10812
         2 000405   000540 710000 2                  TRA     s:10812
         2 000406   000540 710000 2                  TRA     s:10812
         2 000407   000540 710000 2                  TRA     s:10812
         2 000410   000540 710000 2                  TRA     s:10812
         2 000411   000540 710000 2                  TRA     s:10812
         2 000412   000540 710000 2                  TRA     s:10812
         2 000413   000540 710000 2                  TRA     s:10812
         2 000414   000540 710000 2                  TRA     s:10812
         2 000415   000540 710000 2                  TRA     s:10812
         2 000416   000540 710000 2                  TRA     s:10812
         2 000417   000420 710000 2                  TRA     s:10794

      218    10791    2      CASE(DIRRESETOPT);

      219    10792        /* ****      NOTE: No code required as default fpt is what's required*/
      220    10793    2      CASE(FIDOPT);

      221    10794    2        SEG$2.FPT_FID$->FPT$FID.TEXTFID_=VECTOR(BLK$->P$B.

  10794  2 000420   000000 474400 xsym               LDP4    SEG2$
         2 000421   400167 475500                    LDP5    119,,PR4
         2 000422   300003 476500                    LDP6    3,,PR3
         2 000423   000100 101500                    MRL     fill='000'O
         2 000424   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         2 000425   201302 000002                    ADSC9   FID_RESULTS+526,,AUTO    cn=0,n=2
         2 000426   201302 220100                    LDX0    FID_RESULTS+526,,AUTO
         2 000427   000000 635010                    EAA     0,X0
         2 000430   000002 771000                    ARL     2
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:40   
         2 000431   000140 135007                    SBLA    96,DL
         2 000432   201303 456500                    STP6    FID_RESULTS+527,,AUTO
         2 000433   201303 236100                    LDQ     FID_RESULTS+527,,AUTO
         2 000434   200000 036007                    ADLQ    65536,DL
         2 000435   500002 757100                    STAQ    2,,PR5

      222    10795    2             SUBLK$(0)->P$S.TEXTC$->TEXT$C.TEXT);
      223    10796    2        SEG$2.FPT_FID$->FPT$FID.NAME_=VECTOR(VLP_NAME);

  10796  2 000436   400167 471500                    LDP1    119,,PR4
         2 000437   000006 235000 3                  LDA     6
         2 000440   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000441   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000442   000136 036003                    ADLQ    94,DU
         2 000443   100004 757100                    STAQ    4,,PR1

      224    10797    2        SEG$2.FPT_FID$->FPT$FID.ACCT_=VECTOR(VLP_ACCT);

  10797  2 000444   400167 471500                    LDP1    119,,PR4
         2 000445   000000 235000 3                  LDA     0
         2 000446   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000447   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000450   000146 036003                    ADLQ    102,DU
         2 000451   100006 757100                    STAQ    6,,PR1

      225    10798    2        SEG$2.FPT_FID$->FPT$FID.PASS_=VECTOR(VLP_ACCT);

  10798  2 000452   400167 471500                    LDP1    119,,PR4
         2 000453   000000 235000 3                  LDA     0
         2 000454   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000455   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000456   000146 036003                    ADLQ    102,DU
         2 000457   100010 757100                    STAQ    8,,PR1

      226    10799    2        SEG$2.FPT_FID$->FPT$FID.SN_=VECTOR(VLP_SN);

  10799  2 000460   400167 471500                    LDP1    119,,PR4
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:41   
         2 000461   000007 235000 3                  LDA     7
         2 000462   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000463   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000464   000150 036003                    ADLQ    104,DU
         2 000465   100012 757100                    STAQ    10,,PR1

      227    10800    2        SEG$2.FPT_FID$->FPT$FID.WSN_=VECTOR(VLP_ACCT);

  10800  2 000466   400167 471500                    LDP1    119,,PR4
         2 000467   000000 235000 3                  LDA     0
         2 000470   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000471   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000472   000146 036003                    ADLQ    102,DU
         2 000473   100014 757100                    STAQ    12,,PR1

      228    10801    2        SEG$2.FPT_FID$->FPT$FID.ASN_=VECTOR(ASN);

  10801  2 000474   400167 471500                    LDP1    119,,PR4
         2 000475   777640 235007                    LDA     -96,DL
         2 000476   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000477   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000500   000017 036003                    ADLQ    15,DU
         2 000501   100016 757100                    STAQ    14,,PR1

      229    10802    2        SEG$2.FPT_FID$->FPT$FID.RES_=VECTOR(TBUFF);

  10802  2 000502   400167 471500                    LDP1    119,,PR4
         2 000503   777640 235007                    LDA     -96,DL
         2 000504   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000505   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000506   000073 036003                    ADLQ    59,DU
         2 000507   100020 757100                    STAQ    16,,PR1

      230    10803    2        SEG$2.FPT_FID$->FPT$FID.RESULTS_=VECTOR(FID_RESULTS);

  10803  2 000510   400167 471500                    LDP1    119,,PR4
         2 000511   000010 235000 3                  LDA     8
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:42   
         2 000512   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000513   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000514   000264 036003                    ADLQ    180,DU
         2 000515   100022 757100                    STAQ    18,,PR1

      231    10804    2        CALL M$FID(SEG$2.FPT_FID$->FPT$FID) ALTRET(DIR50);

  10804  2 000516   400167 471500                    LDP1    119,,PR4
         2 000517   100000 630500                    EPPR0   0,,PR1
         2 000520   420001 713400                    CLIMB   alt,+8193
         2 000521   404400 401760                    pmme    nvectors=10
         2 000522   000545 702000 2                  TSX2    DIR50

      232    10805        /* ****         Determine if DP#NN.ACCT or .ACCT spec'd*/
      233    10806    2        FPT_SETFMA.ACCT_ = VECTOR(VLP_ACCT);

  10806  2 000523   000000 235000 3                  LDA     0
         2 000524   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000525   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000526   000146 036003                    ADLQ    102,DU
         2 000527   200076 757100                    STAQ    FPT_SETFMA,,AUTO

      234    10807    2        IF FID_RESULTS.SN

  10807  2 000530   200264 236100                    LDQ     FID_RESULTS,,AUTO
         2 000531   040000 316003                    CANQ    16384,DU
         2 000532   000540 600000 2                  TZE     s:10812

      235    10808
      236    10809    2           THEN /* Sn specified as well */
      237    10810    2              FPT_SETFMA.PSN_ = VECTOR(VLP_SN.SN#);

  10810  2 000533   000011 235000 3                  LDA     9
         2 000534   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000535   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000536   000151 036003                    ADLQ    105,DU
         2 000537   200100 757100                    STAQ    FPT_SETFMA+2,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:43   

      238    10811    2      END;

      239    10812    1     CALL M$SETFMA (FPT_SETFMA) ALTRET(DIR50);

  10812  2 000540   200076 630500                    EPPR0   FPT_SETFMA,,AUTO
         2 000541   460001 713400                    CLIMB   alt,+24577
         2 000542   400400 401760                    pmme    nvectors=2
         2 000543   000545 702000 2                  TSX2    DIR50

      240    10813    1     RETURN;

  10813  2 000544   000000 702200 xent               TSX2  ! X66_ARET

  10812  2 000545                       DIR50        null
      241    10814    1   DIR50: ;
      242    10815    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  10815  2 000545   000000 470400 xsym               LDP0    B$TCB$
         2 000546   000000 471500                    LDP1    0,,PR0
         2 000547   100102 236100                    LDQ     66,,PR1
         2 000550   000000 473400 xsym               LDP3    B$JIT$
         2 000551   300144 756100                    STQ     100,,PR3

      243    10816    1     ALTRETURN;

  10816  2 000552   000000 702200 xent               TSX2  ! X66_AALT

      244    10817                %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:44   
      245    10818        /**********************************************************************/
      246    10819        /*F*    NAME:   CPI$DRIBBLE
      247    10820                PURPOSE: The DRIBBLE command provides a means of recording
      248    10821                        interactive terminal transactions on a device,file, or
      249    10822                        magnetic tape.
      250    10823                REFERENCE: Programmers Reference Manual
      251    10824        */
      252    10825        /*D*    NAME:   CPI$DRIBBLE
      253    10826                CALL:   CALL CPI$DRIBBLE(P$PCB)
      254    10827                INTERFACE: CPE$GENRUAM
      255    10828                INPUT:  P$PCB - parse control block
      256    10829                OUTPUT: M$DRIBBLE assign merge record created
      257    10830                DESCRIPTION: The DRIBBLE command is scanned and the presence of
      258    10831                        a fid determined. A dcb assignment is made for
      259    10832                        M$DRIBBLE if ON/OVER/INTO and a fid exists. The M$DRIBBLE
      260    10833                        pmme is executed to turn on the dribble process.
      261    10834        */
      262    10835        /**********************************************************************/
      263    10836        /**/
      264    10837        /**/
      265    10838    1   CPI$DRIBBLE: ENTRY(P$PCB) ALTRET;

  10838  2 000553   000000 700200 xent  CPI$DRIBBLE  TSX0  ! X66_AUTO_2
         2 000554   001310 000002                    ZERO    712,2

      266    10839    1     FPT_DRIBBLE = CFPT_DRIBBLE;

  10839  2 000555   000100 100400                    MLR     fill='000'O
         2 000556   000000 000020 xsym               ADSC9   CFPT_DRIBBLE             cn=0,n=16
         2 000557   200122 000020                    ADSC9   FPT_DRIBBLE,,AUTO        cn=0,n=16

      267    10840    1     FPT_DRIBBLE.V_ = VECTOR(FPT_DRIBBLE.V);

  10840  2 000560   000000 235000 3                  LDA     0
         2 000561   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 000562   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 000563   000124 036003                    ADLQ    84,DU
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:45   
         2 000564   200122 757100                    STAQ    FPT_DRIBBLE,,AUTO

      268    10841    1     FPT_DRIBBLE.V.DRIBBLE# = %YES#;

  10841  2 000565   400000 236003                    LDQ     -131072,DU
         2 000566   200124 756100                    STQ     FPT_DRIBBLE+2,,AUTO

      269    10842    1     BLK$ = P$PCB.OUT$;

  10842  2 000567   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000570   000003 236100                    LDQ     3,,PR0
         2 000571   200005 756100                    STQ     BLK$,,AUTO

      270    10843    1     I = 511;

  10843  2 000572   000777 235007                    LDA     511,DL
         2 000573   200013 755100                    STA     I,,AUTO

      271    10844    1     IF BLK$->P$B.NSUBLKS > 0

  10844  2 000574   200005 471500                    LDP1    BLK$,,AUTO
         2 000575   100001 220100                    LDX0    1,,PR1
         2 000576   000627 600000 2                  TZE     s:10853

      272    10845    1        THEN
      273    10846    2           DO;

      274    10847    2              TEMP$ = BLK$->P$B.SUBLK$(0);          /*PTR TO OVER,ON,INTO*/

  10847  2 000577   100003 236100                    LDQ     3,,PR1
         2 000600   200006 756100                    STQ     TEMP$,,AUTO

      275    10848    2              FID$ = BLK$->P$B.SUBLK$(1)->P$B.SUBLK$(0); /*PTR TO FID */

  10848  2 000601   100004 473500                    LDP3    4,,PR1
         2 000602   300003 236100                    LDQ     3,,PR3
         2 000603   200012 756100                    STQ     FID$,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:46   

      276    10849    2              I = BLK$ -> P$B.SUBLK$(1) -> P$S.CPOS;

  10849  2 000604   100004 473500                    LDP3    4,,PR1
         2 000605   300002 235100                    LDA     2,,PR3
         2 000606   200013 755100                    STA     I,,AUTO

      277    10850    2              CALL CPE$GENRUAM(BLK$,TEMP$,FID$,ADDR(DRIBBLEDCB),%YES#)

  10850  2 000607   000012 236000 3                  LDQ     10
         2 000610   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 000611   000013 236000 3                  LDQ     11
         2 000612   201307 756100                    STQ     FID_RESULTS+531,,AUTO
         2 000613   201302 633500                    EPPR3   FID_RESULTS+526,,AUTO
         2 000614   201306 453500                    STP3    FID_RESULTS+530,,AUTO
         2 000615   200012 634500                    EPPR4   FID$,,AUTO
         2 000616   201305 454500                    STP4    FID_RESULTS+529,,AUTO
         2 000617   200006 635500                    EPPR5   TEMP$,,AUTO
         2 000620   201304 455500                    STP5    FID_RESULTS+528,,AUTO
         2 000621   200005 636500                    EPPR6   BLK$,,AUTO
         2 000622   201303 456500                    STP6    FID_RESULTS+527,,AUTO
         2 000623   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 000624   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000625   000000 701000 xent               TSX1    CPE$GENRUAM
         2 000626   000667 702000 2                  TSX2    DRIB60

      278    10851    2                                           ALTRET(DRIB60);
      279    10852    2           END;

      280    10853    1     CALL CPE$RFEXT (ADDR(M$DRDCB));

  10853  2 000627   000014 236000 3                  LDQ     12
         2 000630   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 000631   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 000632   201303 450500                    STP0    FID_RESULTS+527,,AUTO
         2 000633   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 000634   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:47   
         2 000635   000000 701000 xent               TSX1    CPE$RFEXT
         2 000636   000000 011000                    NOP     0

      281    10854    1     CALL M$DRIBBLE(FPT_DRIBBLE) ALTRET(DRIB50);

  10854  2 000637   200122 630500                    EPPR0   FPT_DRIBBLE,,AUTO
         2 000640   560022 713400                    CLIMB   alt,+57362
         2 000641   400000 401760                    pmme    nvectors=1
         2 000642   000644 702000 2                  TSX2    DRIB50

      282    10855    1     RETURN;

  10855  2 000643   000000 702200 xent               TSX2  ! X66_ARET

  10849  2 000644                       DRIB50       null
      283    10856    1   DRIB50:;
      284    10857    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),I,B$TCB.ALT$->B$ALT.ERR,,

  10857  2 000644   000000 470400 xsym               LDP0    B$TCB$
         2 000645   000000 471500                    LDP1    0,,PR0
         2 000646   000000 236000 xsym               LDQ     SEG2$
         2 000647   000003 036003                    ADLQ    3,DU
         2 000650   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 000651   100101 633500                    EPPR3   65,,PR1
         2 000652   201307 453500                    STP3    FID_RESULTS+531,,AUTO
         2 000653   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000654   201306 756100                    STQ     FID_RESULTS+530,,AUTO
         2 000655   100102 634500                    EPPR4   66,,PR1
         2 000656   201305 454500                    STP4    FID_RESULTS+529,,AUTO
         2 000657   200013 631500                    EPPR1   I,,AUTO
         2 000660   201304 451500                    STP1    FID_RESULTS+528,,AUTO
         2 000661   201302 635500                    EPPR5   FID_RESULTS+526,,AUTO
         2 000662   201303 455500                    STP5    FID_RESULTS+527,,AUTO
         2 000663   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 000664   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000665   000000 701000 xent               TSX1    CXP$POSTERR
         2 000666   000000 011000                    NOP     0
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:48   

  10857  2 000667                       DRIB60       null
      285    10858    1           B$TCB.ALT$->B$ALT.DCB#);
      286    10859    1   DRIB60:;
      287    10860    1     ALTRETURN;

  10860  2 000667   000000 702200 xent               TSX2  ! X66_AALT

      288    10861               %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:49   
      289    10862        /**********************************************************************/
      290    10863        /*F*   NAME:    CPI$PRIORITY
      291    10864               PURPOSE: The PRIORITY commmand is utilized to establish a user's
      292    10865                        batching default priorities or to display the current priorities
      293    10866                        (maximum and default).
      294    10867               REFERENCE: Programmers Reference Manual
      295    10868        */
      296    10869        /*D*   NAME:    CPI$PRIORITY
      297    10870               CALL:    CALL CPI$PRIORITY(P$PCB)
      298    10871               INTERFACE: NONE
      299    10872               INPUT:   P$PCB - parse control block
      300    10873                        B$JIT.MAXPRI - maximum priority
      301    10874                        B$JIT.DEFPRI - default priority
      302    10875               DESCRIPTION: The specified default priority is stored into the JIT.
      303    10876                        A user cannot specify a priority greater than his maximum
      304    10877                        which was established in his JIT at logon time.
      305    10878        */
      306    10879        /*********************************************************************/
      307    10880    1   CPI$PRIORITY: ENTRY(P$PCB) ALTRET;

  10880  2 000670   000000 700200 xent  CPI$PRIORITY TSX0  ! X66_AUTO_2
         2 000671   001310 000002                    ZERO    712,2

      308    10881        /**/
      309    10882        /**/
      310    10883    1     BLK$ = P$PCB.OUT$;

  10883  2 000672   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000673   000003 236100                    LDQ     3,,PR0
         2 000674   200005 756100                    STQ     BLK$,,AUTO

      311    10884    1     IF BLK$->P$B.NSUBLKS=0

  10884  2 000675   200005 471500                    LDP1    BLK$,,AUTO
         2 000676   100001 220100                    LDX0    1,,PR1
         2 000677   000716 600000 2                  TZE     PRIO10

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:50   
      312    10885    1        THEN
      313    10886    1           GOTO PRIO10;
      314    10887    1     CALL CHARBIN(TSTOR,BLK$->P$B.SUBLK$(0)->P$S.TEXT);

  10887  2 000700   100003 473500                    LDP3    3,,PR1
         2 000701   300004 236100                    LDQ     4,,PR3
         2 000702   000033 772000                    QRL     27
         2 000703   000000 621006                    EAX1    0,QL
         2 000704   000100 305540                    DTB
         2 000705   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         2 000706   201302 000010                    NDSC9   FID_RESULTS+526,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 000707   201303 235100                    LDA     FID_RESULTS+527,,AUTO
         2 000710   200015 755100                    STA     TSTOR,,AUTO

      315    10888    1     B$JIT.DEFPRI = TSTOR;

  10888  2 000711   000000 473400 xsym               LDP3    B$JIT$
         2 000712   200015 236100                    LDQ     TSTOR,,AUTO
         2 000713   000033 736000                    QLS     27
         2 000714   300153 552140                    STBQ    107,'40'O,PR3

      316    10889    1     RETURN;

  10889  2 000715   000000 702200 xent               TSX2  ! X66_ARET

  10888  2 000716                       PRIO10       null
      317    10890        /*
      318    10891          ****  Display batching priority
      319    10892        */
      320    10893    1   PRIO10:;
      321    10894    1     OUTBUFF$=ADDR(OUTBUFF);

  10894  2 000716   200020 633500                    EPPR3   OUTBUFF,,AUTO
         2 000717   200010 453500                    STP3    OUTBUFF$,,AUTO

      322    10895    1     DEST$=OUTBUFF$;

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:51   
  10895  2 000720   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 000721   200011 756100                    STQ     DEST$,,AUTO

      323    10896    1     OUTBUFF=' ';

  10896  2 000722   040100 100400                    MLR     fill='040'O
         2 000723   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000724   200020 000170                    ADSC9   OUTBUFF,,AUTO            cn=0,n=120

      324    10897    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(PRIO_HDR),SIZEC(PRIO_HDR))

  10897  2 000725   000015 236000 3                  LDQ     13
         2 000726   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 000727   000017 236000 3                  LDQ     15
         2 000730   201307 756100                    STQ     FID_RESULTS+531,,AUTO
         2 000731   201302 634500                    EPPR4   FID_RESULTS+526,,AUTO
         2 000732   201306 454500                    STP4    FID_RESULTS+530,,AUTO
         2 000733   200011 635500                    EPPR5   DEST$,,AUTO
         2 000734   201305 455500                    STP5    FID_RESULTS+529,,AUTO
         2 000735   200010 636500                    EPPR6   OUTBUFF$,,AUTO
         2 000736   201304 456500                    STP6    FID_RESULTS+528,,AUTO
         2 000737   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 000740   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000741   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000742   001127 702000 2                  TSX2    PRIO50

      325    10898    1          ALTRET(PRIO50);
      326    10899    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(MAX_PRIO),SIZEC(MAX_PRIO))

  10899  2 000743   000020 236000 3                  LDQ     16
         2 000744   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 000745   000021 236000 3                  LDQ     17
         2 000746   201307 756100                    STQ     FID_RESULTS+531,,AUTO
         2 000747   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 000750   201306 450500                    STP0    FID_RESULTS+530,,AUTO
         2 000751   200011 631500                    EPPR1   DEST$,,AUTO
         2 000752   201305 451500                    STP1    FID_RESULTS+529,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:52   
         2 000753   200010 633500                    EPPR3   OUTBUFF$,,AUTO
         2 000754   201304 453500                    STP3    FID_RESULTS+528,,AUTO
         2 000755   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 000756   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000757   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000760   001127 702000 2                  TSX2    PRIO50

      327    10900    1          ALTRET(PRIO50);
      328    10901    1     CALL BINCHAR(TBUFF,B$JIT.MAXPRI);

  10901  2 000761   000000 470400 xsym               LDP0    B$JIT$
         2 000762   000153 236100                    LDQ     107,,PR0
         2 000763   000022 772000                    QRL     18
         2 000764   000777 376007                    ANQ     511,DL
         2 000765   000000 235003                    LDA     0,DU
         2 000766   201302 757100                    STAQ    FID_RESULTS+526,,AUTO
         2 000767   000100 301500                    BTD
         2 000770   201302 000010                    NDSC9   FID_RESULTS+526,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 000771   200073 030004                    NDSC9   TBUFF,,AUTO              cn=0,s=nosgn,sf=0,n=4

      329    10902    1     CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),TSTOR);

  10902  2 000772   200015 631500                    EPPR1   TSTOR,,AUTO
         2 000773   201304 451500                    STP1    FID_RESULTS+528,,AUTO
         2 000774   000022 236000 3                  LDQ     18
         2 000775   201303 756100                    STQ     FID_RESULTS+527,,AUTO
         2 000776   200073 633500                    EPPR3   TBUFF,,AUTO
         2 000777   201302 453500                    STP3    FID_RESULTS+526,,AUTO
         2 001000   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001001   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001002   000000 701000 xent               TSX1    CPE$RZEROS
         2 001003   000000 011000                    NOP     0

      330    10903    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),TSTOR)

  10903  2 001004   200073 630500                    EPPR0   TBUFF,,AUTO
         2 001005   201302 450500                    STP0    FID_RESULTS+526,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:53   
         2 001006   200015 631500                    EPPR1   TSTOR,,AUTO
         2 001007   201307 451500                    STP1    FID_RESULTS+531,,AUTO
         2 001010   201302 633500                    EPPR3   FID_RESULTS+526,,AUTO
         2 001011   201306 453500                    STP3    FID_RESULTS+530,,AUTO
         2 001012   200011 634500                    EPPR4   DEST$,,AUTO
         2 001013   201305 454500                    STP4    FID_RESULTS+529,,AUTO
         2 001014   200010 635500                    EPPR5   OUTBUFF$,,AUTO
         2 001015   201304 455500                    STP5    FID_RESULTS+528,,AUTO
         2 001016   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 001017   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001020   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001021   001127 702000 2                  TSX2    PRIO50

      331    10904    1          ALTRET(PRIO50);
      332    10905    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(DEF_PRIO),SIZEC(DEF_PRIO))

  10905  2 001022   000023 236000 3                  LDQ     19
         2 001023   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001024   000025 236000 3                  LDQ     21
         2 001025   201307 756100                    STQ     FID_RESULTS+531,,AUTO
         2 001026   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001027   201306 450500                    STP0    FID_RESULTS+530,,AUTO
         2 001030   200011 631500                    EPPR1   DEST$,,AUTO
         2 001031   201305 451500                    STP1    FID_RESULTS+529,,AUTO
         2 001032   200010 633500                    EPPR3   OUTBUFF$,,AUTO
         2 001033   201304 453500                    STP3    FID_RESULTS+528,,AUTO
         2 001034   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 001035   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001036   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001037   001127 702000 2                  TSX2    PRIO50

      333    10906    1          ALTRET(PRIO50);
      334    10907    1     CALL BINCHAR(TBUFF,B$JIT.DEFPRI);

  10907  2 001040   000000 470400 xsym               LDP0    B$JIT$
         2 001041   000153 236100                    LDQ     107,,PR0
         2 001042   000033 772000                    QRL     27
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:54   
         2 001043   000000 235003                    LDA     0,DU
         2 001044   201302 757100                    STAQ    FID_RESULTS+526,,AUTO
         2 001045   000100 301500                    BTD
         2 001046   201302 000010                    NDSC9   FID_RESULTS+526,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 001047   200073 030004                    NDSC9   TBUFF,,AUTO              cn=0,s=nosgn,sf=0,n=4

      335    10908    1     CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),TSTOR);

  10908  2 001050   200015 631500                    EPPR1   TSTOR,,AUTO
         2 001051   201304 451500                    STP1    FID_RESULTS+528,,AUTO
         2 001052   000022 236000 3                  LDQ     18
         2 001053   201303 756100                    STQ     FID_RESULTS+527,,AUTO
         2 001054   200073 633500                    EPPR3   TBUFF,,AUTO
         2 001055   201302 453500                    STP3    FID_RESULTS+526,,AUTO
         2 001056   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001057   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001060   000000 701000 xent               TSX1    CPE$RZEROS
         2 001061   000000 011000                    NOP     0

      336    10909    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),TSTOR)

  10909  2 001062   200073 630500                    EPPR0   TBUFF,,AUTO
         2 001063   201302 450500                    STP0    FID_RESULTS+526,,AUTO
         2 001064   200015 631500                    EPPR1   TSTOR,,AUTO
         2 001065   201307 451500                    STP1    FID_RESULTS+531,,AUTO
         2 001066   201302 633500                    EPPR3   FID_RESULTS+526,,AUTO
         2 001067   201306 453500                    STP3    FID_RESULTS+530,,AUTO
         2 001070   200011 634500                    EPPR4   DEST$,,AUTO
         2 001071   201305 454500                    STP4    FID_RESULTS+529,,AUTO
         2 001072   200010 635500                    EPPR5   OUTBUFF$,,AUTO
         2 001073   201304 455500                    STP5    FID_RESULTS+528,,AUTO
         2 001074   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 001075   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001076   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001077   001127 702000 2                  TSX2    PRIO50

      337    10910    1          ALTRET(PRIO50);
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:55   
      338    10911    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  10911  2 001100   000000 470400 xsym               LDP0    SEG2$
         2 001101   000165 471500                    LDP1    117,,PR0
         2 001102   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001103   100005 756100                    STQ     5,,PR1

      339    10912    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  10912  2 001104   000165 471500                    LDP1    117,,PR0
         2 001105   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001106   000020 772000                    QRL     16
         2 001107   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001110   200011 236100                    LDQ     DEST$,,AUTO
         2 001111   000020 772000                    QRL     16
         2 001112   201302 136100                    SBLQ    FID_RESULTS+526,,AUTO
         2 001113   000020 736000                    QLS     16
         2 001114   100004 676100                    ERQ     4,,PR1
         2 001115   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001116   100004 656100                    ERSQ    4,,PR1

      340    10913    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PRIO50);

  10913  2 001117   000000 236000 xsym               LDQ     SEG2$
         2 001120   000165 036003                    ADLQ    117,DU
         2 001121   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001122   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001123   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001124   000000 701000 xent               TSX1    CPE$LISTOUT
         2 001125   001127 702000 2                  TSX2    PRIO50

      341    10914    1     RETURN;

  10914  2 001126   000000 702200 xent               TSX2  ! X66_ARET

  10912  2 001127                       PRIO50       null
      342    10915    1   PRIO50:;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:56   
      343    10916    1     ALTRETURN;

  10916  2 001127   000000 702200 xent               TSX2  ! X66_AALT

      344    10917                   %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:57   
      345    10918        /**********************************************************************/
      346    10919        /*F*   NAME:   CPI$SETUP
      347    10920               PURPOSE: The SETUP command is utilized to create/modify FCOMMAND
      348    10921                       in the :USERS record. The specified command line will
      349    10922                       executed automatically at logon time.
      350    10923               REFERENCE: Programmers Reference Manual
      351    10924        */
      352    10925        /*D*   NAME:   CPI$SETUP
      353    10926               CALL:   CALL CPI$SETUP(P$PCB)
      354    10927               INTERFACE: CPC$GETDCB,CPC$RELDCB,CPC$RDUSERS,CPC$WRUSERS
      355    10928               INPUT:  parse control block
      356    10929                       MSGFLAG - indicates if msge. is to be output
      357    10930               OUTPUT: FCOMMAND initialized in :USERS or displayed
      358    10931               DESCRIPTION: The specified command is either stored into the :USERS
      359    10932                            record,reset, or displayed.
      360    10933                            The FCOMMAND initialized in :USERS is mode dependent.
      361    10934        */
      362    10935        /**********************************************************************/
      363    10936    1   CPI$SETUP: ENTRY(P$PCB,MSGFLAG) ALTRET;

  10936  2 001130   000000 700200 xent  CPI$SETUP    TSX0  ! X66_AUTO_2
         2 001131   001310 000002                    ZERO    712,2

      364    10937        /**/
      365    10938        /**/
      366    10939    1     BLK$=P$PCB.OUT$;

  10939  2 001132   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001133   000003 236100                    LDQ     3,,PR0
         2 001134   200005 756100                    STQ     BLK$,,AUTO

      367    10940    1     I = 0;

  10940  2 001135   200013 450100                    STZ     I,,AUTO

      368    10941    1     MODE = B$JIT.MODE;

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:58   
  10941  2 001136   000000 471400 xsym               LDP1    B$JIT$
         2 001137   100000 236100                    LDQ     0,,PR1
         2 001140   000040 772000                    QRL     32
         2 001141   200014 756100                    STQ     MODE,,AUTO

      369    10942    1     IF BLK$->P$B.NSUBLKS>0 AND BLK$->P$B.SUBLK$(0)->P$B.CODE=SETUPMODE

  10942  2 001142   200005 473500                    LDP3    BLK$,,AUTO
         2 001143   300001 220100                    LDX0    1,,PR3
         2 001144   001160 600000 2                  TZE     s:10950
         2 001145   300003 474500                    LDP4    3,,PR3
         2 001146   400000 721100                    LXL1    0,,PR4
         2 001147   000003 101003                    CMPX1   3,DU
         2 001150   001160 601000 2                  TNZ     s:10950

      370    10943    2       THEN DO;

      371    10944    2         I = 1;

  10944  2 001151   000001 235007                    LDA     1,DL
         2 001152   200013 755100                    STA     I,,AUTO

      372    10945    2         MODE = BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE;

  10945  2 001153   300003 474500                    LDP4    3,,PR3
         2 001154   400003 475500                    LDP5    3,,PR4
         2 001155   500000 236100                    LDQ     0,,PR5
         2 001156   777777 376007                    ANQ     -1,DL
         2 001157   200014 756100                    STQ     MODE,,AUTO

      373    10946    2       END;

      374    10947        /*
      375    10948             ***** Force the :USERS file to be read...
      376    10949        */
      377    10950    1     SEG$2.FLAGS.USERS = %NO#;

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:59   
  10950  2 001160   000000 474400 xsym               LDP4    SEG2$
         2 001161   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 001162   400000 356100                    ANSQ    0,,PR4

      378    10951        /*
      379    10952          ****  No text after command infers a display
      380    10953        */
      381    10954    1     IF BLK$->P$B.NSUBLKS=I

  10954  2 001163   200005 473500                    LDP3    BLK$,,AUTO
         2 001164   300001 236100                    LDQ     1,,PR3
         2 001165   000022 772000                    QRL     18
         2 001166   200013 116100                    CMPQ    I,,AUTO
         2 001167   001332 601000 2                  TNZ     s:10997

      382    10955    1        THEN
      383    10956    2           DO;

      384    10957    2              CALL CPC$RDUSERS (M$IBEX1_NUM,%IN#) ALTRET(SETUP55);

  10957  2 001170   000026 630400 3                  EPPR0   22
         2 001171   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001172   000000 701000 xent               TSX1    CPC$RDUSERS
         2 001173   001460 702000 2                  TSX2    SETUP55

      385    10958        /*         **** Determine if fcommand in :USERS  */
      386    10959    2              IF SEG$2.USERS$ -> AS$USERS.SETUP(MODE-1) ~= -1

  10959  2 001174   000000 470400 xsym               LDP0    SEG2$
         2 001175   000152 471500                    LDP1    106,,PR0
         2 001176   200014 235100                    LDA     MODE,,AUTO
         2 001177   000001 735000                    ALS     1
         2 001200   000100 100505                    MLR     fill='000'O
         2 001201   100351 400002                    ADSC9   233,A,PR1                cn=2,n=2
         2 001202   201302 000004                    ADSC9   FID_RESULTS+526,,AUTO    cn=0,n=4
         2 001203   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 001204   000022 732000                    QRS     18
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:60   
         2 001205   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 001206   001305 600000 2                  TZE     s:10981

      387    10960    2                 THEN
      388    10961    3                    DO;

      389    10962    3                       TABS_VAL=6;

  10962  2 001207   000006 236007                    LDQ     6,DL
         2 001210   200074 756100                    STQ     TABS_VAL,,AUTO

      390    10963    3                       OUTBUFF$=ADDR(OUTBUFF);

  10963  2 001211   200020 631500                    EPPR1   OUTBUFF,,AUTO
         2 001212   200010 451500                    STP1    OUTBUFF$,,AUTO

      391    10964    3                       DEST$=OUTBUFF$;

  10964  2 001213   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001214   200011 756100                    STQ     DEST$,,AUTO

      392    10965    3                       OUTBUFF='   Setup: ';

  10965  2 001215   040100 100400                    MLR     fill='040'O
         2 001216   000032 000012 1                  ADSC9   E_NOROOM4SETUP+10        cn=0,n=10
         2 001217   200020 000170                    ADSC9   OUTBUFF,,AUTO            cn=0,n=120

      393    10966    3                       DEST$=PINCRC(DEST$,SIZEC('   Setup: '));

  10966  2 001220   000030 036000 3                  ADLQ    24
         2 001221   200011 756100                    STQ     DEST$,,AUTO

      394    10967    3                       TEMP$ = PINCRC(ADDR(SEG$2.USERS$->AS$USERS.SETUP_CHRA.TXT),

  10967  2 001222   000152 473500                    LDP3    106,,PR0
         2 001223   000100 100505                    MLR     fill='000'O
         2 001224   300351 400002                    ADSC9   233,A,PR3                cn=2,n=2
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:61   
         2 001225   201302 000004                    ADSC9   FID_RESULTS+526,,AUTO    cn=0,n=4
         2 001226   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 001227   000022 732000                    QRS     18
         2 001230   300362 500506                    A9BD    242,QL,PR3
         2 001231   200006 453500                    STP3    TEMP$,,AUTO

      395    10968    3                                           SEG$2.USERS$->AS$USERS.SETUP(MODE-1));
      396    10969    3                       VARY_CNT = TEMP$->MOV$STR.CNT;

  10969  2 001232   000100 101500                    MRL     fill='000'O
         2 001233   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 001234   200016 000004                    ADSC9   VARY_CNT,,AUTO           cn=0,n=4

      397    10970    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TEMP$->MOV$STR.TXT),

  10970  2 001235   200006 236100                    LDQ     TEMP$,,AUTO
         2 001236   200000 036007                    ADLQ    65536,DL
         2 001237   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001240   200074 634500                    EPPR4   TABS_VAL,,AUTO
         2 001241   201307 454500                    STP4    FID_RESULTS+531,,AUTO
         2 001242   200016 635500                    EPPR5   VARY_CNT,,AUTO
         2 001243   201306 455500                    STP5    FID_RESULTS+530,,AUTO
         2 001244   201302 636500                    EPPR6   FID_RESULTS+526,,AUTO
         2 001245   201305 456500                    STP6    FID_RESULTS+529,,AUTO
         2 001246   200011 637500                    EPPR7   DEST$,,AUTO
         2 001247   201304 457500                    STP7    FID_RESULTS+528,,AUTO
         2 001250   200010 630500                    EPPR0   OUTBUFF$,,AUTO
         2 001251   201303 450500                    STP0    FID_RESULTS+527,,AUTO
         2 001252   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 001253   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001254   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001255   001460 702000 2                  TSX2    SETUP55

      398    10971    3                            VARY_CNT, TABS_VAL) ALTRET(SETUP55);
      399    10972    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  10972  2 001256   000000 470400 xsym               LDP0    SEG2$
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:62   
         2 001257   000165 471500                    LDP1    117,,PR0
         2 001260   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001261   100005 756100                    STQ     5,,PR1

      400    10973    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  10973  2 001262   000165 471500                    LDP1    117,,PR0
         2 001263   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001264   000020 772000                    QRL     16
         2 001265   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001266   200011 236100                    LDQ     DEST$,,AUTO
         2 001267   000020 772000                    QRL     16
         2 001270   201302 136100                    SBLQ    FID_RESULTS+526,,AUTO
         2 001271   000020 736000                    QLS     16
         2 001272   100004 676100                    ERQ     4,,PR1
         2 001273   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001274   100004 656100                    ERSQ    4,,PR1

      401    10974    3                       CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(SETUP55);

  10974  2 001275   000000 236000 xsym               LDQ     SEG2$
         2 001276   000165 036003                    ADLQ    117,DU
         2 001277   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001300   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001301   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001302   000000 701000 xent               TSX1    CPE$LISTOUT
         2 001303   001460 702000 2                  TSX2    SETUP55

      402    10975    3                    END;

  10975  2 001304   001331 710000 2                  TRA     s:10992

      403    10976        /*
      404    10977          ****     Output msge by default or if specified. Do not want to output
      405    10978          ****     On users display.
      406    10979        */
      407    10980    2                 ELSE
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:63   
      408    10981    2                    IF (ADDR(MSGFLAG)=ADDR(NIL))  OR (ADDR(MSGFLAG)~=ADDR(NIL)

  10981  2 001305   200004 236100                    LDQ     @MSGFLAG,,AUTO
         2 001306   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001307   001314 600000 2                  TZE     s:10990
         2 001310   001331 600000 2                  TZE     s:10992
         2 001311   200004 471500                    LDP1    @MSGFLAG,,AUTO
         2 001312   100000 234100                    SZN     0,,PR1
         2 001313   001331 605000 2                  TPL     s:10992

      409    10982    2                         AND MSGFLAG=%YES#)
      410    10983
      411    10984    2                       THEN
      412    10985    3                          DO;

      413    10986        /*E*       ERROR:   CPI-E$NOSCMND-E
      414    10987                   MESSAGE: NO SETUP COMMAND
      415    10988                   DESCRIPTION: Command doesn't exist in :USERS record.
      416    10989        */
      417    10990    3                             CALL CPC$WRITEMSGE(E_NOSCMND,,,,,%YES#);

  10990  2 001314   000013 236000 3                  LDQ     11
         2 001315   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001316   201306 757100                    STAQ    FID_RESULTS+530,,AUTO
         2 001317   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001320   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001321   201304 757100                    STAQ    FID_RESULTS+528,,AUTO
         2 001322   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001323   000031 235000 3                  LDA     25
         2 001324   201302 757100                    STAQ    FID_RESULTS+526,,AUTO
         2 001325   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001326   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001327   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 001330   000000 011000                    NOP     0

      418    10991    3                          END;

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:64   
      419    10992    2              RETURN;

  10992  2 001331   000000 702200 xent               TSX2  ! X66_ARET

      420    10993    2           END;
      421    10994        /*
      422    10995             ***** Define a new setup cmd...
      423    10996        */
      424    10997    1     CALL CPC$RDUSERS (M$IBEX1_NUM,%UPDATE#) ALTRET(SETUP55);

  10997  2 001332   000032 630400 3                  EPPR0   26
         2 001333   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001334   000000 701000 xent               TSX1    CPC$RDUSERS
         2 001335   001460 702000 2                  TSX2    SETUP55

      425    10998    1     IF SEG$2.USERS$ -> AS$USERS.SETUP_PERM(MODE-1)

  10998  2 001336   000000 470400 xsym               LDP0    SEG2$
         2 001337   000152 471500                    LDP1    106,,PR0
         2 001340   200014 235100                    LDA     MODE,,AUTO
         2 001341   001343 605000 2                  TPL     s:10998+5
         2 001342   000044 035003                    ADLA    36,DU
         2 001343   000000 066505                    CMPB    filb='0'B
         2 001344   100351 300001                    BDSC    233,A,PR1                by=1,bit=8,n=1
         2 001345   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 001346   001377 600000 2                  TZE     s:11011

      426    10999    1         THEN
      427    11000    2             DO ;                            /* Not allowed to change SETUP.    */

      428    11001    2               CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_NOCHGSETUP) ;

  11001  2 001347   000000 236000 xsym               LDQ     SEG2$
         2 001350   000003 036003                    ADLQ    3,DU
         2 001351   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001352   000036 237000 3                  LDAQ    30
         2 001353   201304 757100                    STAQ    FID_RESULTS+528,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:65   
         2 001354   201302 631500                    EPPR1   FID_RESULTS+526,,AUTO
         2 001355   201303 451500                    STP1    FID_RESULTS+527,,AUTO
         2 001356   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 001357   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001360   000000 701000 xent               TSX1    CXP$POSTERR
         2 001361   000000 011000                    NOP     0

      429    11002    2               SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;

  11002  2 001362   000000 470400 xsym               LDP0    SEG2$
         2 001363   000163 471500                    LDP1    115,,PR0
         2 001364   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001365   100032 740100                    STX0    26,,PR1

      430    11003    2               SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;

  11003  2 001366   000163 471500                    LDP1    115,,PR0
         2 001367   000002 236007                    LDQ     2,DL
         2 001370   100032 552104                    STBQ    26,'04'O,PR1

      431    11004    2               CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(SETUP55);

  11004  2 001371   000163 471500                    LDP1    115,,PR0
         2 001372   100000 630500                    EPPR0   0,,PR1
         2 001373   450001 713400                    CLIMB   alt,close
         2 001374   406000 401760                    pmme    nvectors=13
         2 001375   001460 702000 2                  TSX2    SETUP55

      432    11005    2               GOTO SETUP55 ;

  11005  2 001376   001460 710000 2                  TRA     SETUP55

      433    11006    2             END ; /* Then Do */
      434    11007        /*E*       ERROR:   CPI-E$NOCHGSETUP-C
      435    11008                   MESSAGE: You are not allowed to change your SETUP command.
      436    11009                   DESCRIPTION: The user is not allowed to change his SETUP command.
      437    11010        */
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:66   
      438    11011    1     TEMP$ = ADDR(BLK$->P$B.SUBLK$(I)->P$S.COUNT) ;

  11011  2 001377   200005 473500                    LDP3    BLK$,,AUTO
         2 001400   200013 720100                    LXL0    I,,AUTO
         2 001401   300003 474510                    LDP4    3,X0,PR3
         2 001402   400004 635500                    EPPR5   4,,PR4
         2 001403   200006 455500                    STP5    TEMP$,,AUTO

      439    11012    1     CALL ASC$SETUP (SEG$2.USERS$, MODE-1, TEMP$->MOV$STR) WHENALTRETURN

  11012  2 001404   200014 235100                    LDA     MODE,,AUTO
         2 001405   000001 135007                    SBLA    1,DL
         2 001406   201302 755100                    STA     FID_RESULTS+526,,AUTO
         2 001407   200006 236100                    LDQ     TEMP$,,AUTO
         2 001410   201305 756100                    STQ     FID_RESULTS+529,,AUTO
         2 001411   201302 631500                    EPPR1   FID_RESULTS+526,,AUTO
         2 001412   201304 451500                    STP1    FID_RESULTS+528,,AUTO
         2 001413   000000 236000 xsym               LDQ     SEG2$
         2 001414   000152 036003                    ADLQ    106,DU
         2 001415   201303 756100                    STQ     FID_RESULTS+527,,AUTO
         2 001416   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 001417   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001420   000000 701000 xent               TSX1    ASC$SETUP
         2 001421   001423 702000 2                  TSX2    s:11014
         2 001422   001437 710000 2                  TRA     s:11027

      440    11013    2               DO ;

      441    11014    2                 CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),511,E_NOROOM4SETUP) ;

  11014  2 001423   000000 236000 xsym               LDQ     SEG2$
         2 001424   000003 036003                    ADLQ    3,DU
         2 001425   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001426   000040 237000 3                  LDAQ    32
         2 001427   201304 757100                    STAQ    FID_RESULTS+528,,AUTO
         2 001430   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001431   201303 450500                    STP0    FID_RESULTS+527,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:67   
         2 001432   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 001433   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001434   000000 701000 xent               TSX1    CXP$POSTERR
         2 001435   000000 011000                    NOP     0

      442    11015    2                 GOTO SETUP55 ;

  11015  2 001436   001460 710000 2                  TRA     SETUP55

      443    11016    2               END ; /* Then Do */
      444    11017        /*E*       ERROR: CPI-E$NOROOM4SETUP-0
      445    11018                   MESSAGE: No room to put SETUP command.
      446    11019                   MESSAGE1: Because of the size of your SETUPs and BANNERTEXTs
      447    11020                             there is no more room for your SETUP command.
      448    11021                   DESCRIPTION: The user has run out of space for a SETUP command
      449    11022                                in his :USERS file.
      450    11023        */
      451    11024        /*
      452    11025             ***** Write the new setup cmd to the :USERS file...
      453    11026        */
      454    11027    1     CALL CPC$WRUSERS (M$IBEX1_NUM) ALTRET(SETUP55);

  11027  2 001437   000026 630400 3                  EPPR0   22
         2 001440   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001441   000000 701000 xent               TSX1    CPC$WRUSERS
         2 001442   001460 702000 2                  TSX2    SETUP55

      455    11028    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;

  11028  2 001443   000000 470400 xsym               LDP0    SEG2$
         2 001444   000163 471500                    LDP1    115,,PR0
         2 001445   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001446   100032 740100                    STX0    26,,PR1

      456    11029    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;

  11029  2 001447   000163 471500                    LDP1    115,,PR0
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:68   
         2 001450   000002 236007                    LDQ     2,DL
         2 001451   100032 552104                    STBQ    26,'04'O,PR1

      457    11030    1     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(SETUP55);

  11030  2 001452   000163 471500                    LDP1    115,,PR0
         2 001453   100000 630500                    EPPR0   0,,PR1
         2 001454   450001 713400                    CLIMB   alt,close
         2 001455   406000 401760                    pmme    nvectors=13
         2 001456   001460 702000 2                  TSX2    SETUP55

      458    11031    1     RETURN;

  11031  2 001457   000000 702200 xent               TSX2  ! X66_ARET

  11029  2 001460                       SETUP55      null
      459    11032    1   SETUP55:;
      460    11033    1     ALTRETURN;

  11033  2 001460   000000 702200 xent               TSX2  ! X66_AALT

      461    11034                   %EJECT;
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:69   
      462    11035        /**********************************************************************/
      463    11036        /*F*   NAME:   CPI$TABS
      464    11037               PURPOSE: The TABS command is utilized to set or display
      465    11038                       simulated tab stops.
      466    11039               DESCRIPTION: A user is permitted to set up to 31 tabs in
      467    11040                       ascending sequence or to reset tabs by specifying 0,NO, or
      468    11041                       OFF. With no arguments, the current tab stop settings
      469    11042                       are displayed.
      470    11043               REFERENCE: Programmers Reference Manual
      471    11044        */
      472    11045        /*D*   NAME:   CPI$TABS
      473    11046               CALL:   CALL CPI$TABS(P$PCB)
      474    11047               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT,CPE$RZEROS
      475    11048               INPUT:  P$PCB - parse control block
      476    11049               OUTPUT: tabs set
      477    11050               DESCRIPTION: If no sub-blocks are found, the tab settings are
      478    11051                       displayed. Individual tab stops are set as specified by the
      479    11052                       various sub-blocks. All tab stops are reset if a 0,NO, or OFF
      480    11053                       is encountered.
      481    11054        */
      482    11055        /****************************************************************************/
      483    11056    1   CPI$TABS: ENTRY(P$PCB) ALTRET;

  11056  2 001461   000000 700200 xent  CPI$TABS     TSX0  ! X66_AUTO_2
         2 001462   001310 000002                    ZERO    712,2

      484    11057        /**/
      485    11058        /**/
      486    11059    1     BLK$=P$PCB.OUT$;

  11059  2 001463   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001464   000003 236100                    LDQ     3,,PR0
         2 001465   200005 756100                    STQ     BLK$,,AUTO

      487    11060        /*
      488    11061          ****     No options after tabs indicates tabs are to be displayed
      489    11062        */
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:70   
      490    11063    1     IF BLK$->P$B.NSUBLKS=0

  11063  2 001466   200005 471500                    LDP1    BLK$,,AUTO
         2 001467   100001 220100                    LDX0    1,,PR1
         2 001470   001706 601000 2                  TNZ     s:11103

      491    11064    1        THEN
      492    11065    2           DO;

      493    11066    2              TABS_VAL=6;

  11066  2 001471   000006 235007                    LDA     6,DL
         2 001472   200074 755100                    STA     TABS_VAL,,AUTO

      494    11067    2              OUTBUFF$=ADDR(OUTBUFF);

  11067  2 001473   200020 633500                    EPPR3   OUTBUFF,,AUTO
         2 001474   200010 453500                    STP3    OUTBUFF$,,AUTO

      495    11068    2              DEST$=OUTBUFF$;

  11068  2 001475   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001476   200011 756100                    STQ     DEST$,,AUTO

      496    11069        /* ****          Insert 'Tabs Set: ' into output image*/
      497    11070    2              OUTBUFF='   Tabs Set: ';

  11070  2 001477   040100 100400                    MLR     fill='040'O
         2 001500   000035 000015 1                  ADSC9   E_NOROOM4SETUP+13        cn=0,n=13
         2 001501   200020 000170                    ADSC9   OUTBUFF,,AUTO            cn=0,n=120

      498    11071    2              DEST$=PINCRC(DEST$,SIZEC('   Tabs Set: ')); /*Incr. To nxt LOC.*/

  11071  2 001502   000035 036000 3                  ADLQ    29
         2 001503   200011 756100                    STQ     DEST$,,AUTO

      499    11072        /* ****          Insert tab values into output image*/
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:71   
      500    11073    2              I=0;

  11073  2 001504   200013 450100                    STZ     I,,AUTO

      501    11074    2              TEMP$ = DCBADDR(M$UC_NUM) -> F$DCB.TAB$;

  11074  2 001505   000042 474400 3                  LDP4    34
         2 001506   400000 475500                    LDP5    0,,PR4
         2 001507   000000 720000 xsym               LXL0    M$UC_NUM
         2 001510   500000 476510                    LDP6    0,X0,PR5
         2 001511   600047 236100                    LDQ     39,,PR6
         2 001512   200006 756100                    STQ     TEMP$,,AUTO

      502    11075    3              DO WHILE (TEMP$ -> VLP$TAB.TABS#(I) ~= 0 AND I < 31);

  11075  2 001513   001604 710000 2                  TRA     s:11083

      503    11076    3                 CALL BINCHAR(TBUFF,TEMP$ -> VLP$TAB.TABS#(I));

  11076  2 001514   200006 470500                    LDP0    TEMP$,,AUTO
         2 001515   200013 235100                    LDA     I,,AUTO
         2 001516   000100 101505                    MRL     fill='000'O
         2 001517   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         2 001520   201302 000004                    ADSC9   FID_RESULTS+526,,AUTO    cn=0,n=4
         2 001521   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 001522   000000 235003                    LDA     0,DU
         2 001523   201304 757100                    STAQ    FID_RESULTS+528,,AUTO
         2 001524   000100 301500                    BTD
         2 001525   201304 000010                    NDSC9   FID_RESULTS+528,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 001526   200073 030004                    NDSC9   TBUFF,,AUTO              cn=0,s=nosgn,sf=0,n=4

      504    11077    3                 CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),TSTOR);

  11077  2 001527   200015 631500                    EPPR1   TSTOR,,AUTO
         2 001530   201304 451500                    STP1    FID_RESULTS+528,,AUTO
         2 001531   000022 236000 3                  LDQ     18
         2 001532   201303 756100                    STQ     FID_RESULTS+527,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:72   
         2 001533   200073 633500                    EPPR3   TBUFF,,AUTO
         2 001534   201302 453500                    STP3    FID_RESULTS+526,,AUTO
         2 001535   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001536   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001537   000000 701000 xent               TSX1    CPE$RZEROS
         2 001540   000000 011000                    NOP     0

      505    11078    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),TSTOR,

  11078  2 001541   200073 630500                    EPPR0   TBUFF,,AUTO
         2 001542   201302 450500                    STP0    FID_RESULTS+526,,AUTO
         2 001543   200074 631500                    EPPR1   TABS_VAL,,AUTO
         2 001544   201307 451500                    STP1    FID_RESULTS+531,,AUTO
         2 001545   200015 633500                    EPPR3   TSTOR,,AUTO
         2 001546   201306 453500                    STP3    FID_RESULTS+530,,AUTO
         2 001547   201302 634500                    EPPR4   FID_RESULTS+526,,AUTO
         2 001550   201305 454500                    STP4    FID_RESULTS+529,,AUTO
         2 001551   200011 635500                    EPPR5   DEST$,,AUTO
         2 001552   201304 455500                    STP5    FID_RESULTS+528,,AUTO
         2 001553   200010 636500                    EPPR6   OUTBUFF$,,AUTO
         2 001554   201303 456500                    STP6    FID_RESULTS+527,,AUTO
         2 001555   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 001556   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001557   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001560   002010 702000 2                  TSX2    TABS50

      506    11079    3                      TABS_VAL) ALTRET(TABS50);
      507    11080    3                 TBUFF=',';

  11080  2 001561   000043 236000 3                  LDQ     35
         2 001562   200073 756100                    STQ     TBUFF,,AUTO

      508    11081    3                CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),1,TABS_VAL) ALTRET(TABS50
             11081                          );

  11081  2 001563   200073 630500                    EPPR0   TBUFF,,AUTO
         2 001564   201302 450500                    STP0    FID_RESULTS+526,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:73   
         2 001565   200074 631500                    EPPR1   TABS_VAL,,AUTO
         2 001566   201307 451500                    STP1    FID_RESULTS+531,,AUTO
         2 001567   000033 236000 3                  LDQ     27
         2 001570   201306 756100                    STQ     FID_RESULTS+530,,AUTO
         2 001571   201302 633500                    EPPR3   FID_RESULTS+526,,AUTO
         2 001572   201305 453500                    STP3    FID_RESULTS+529,,AUTO
         2 001573   200011 634500                    EPPR4   DEST$,,AUTO
         2 001574   201304 454500                    STP4    FID_RESULTS+528,,AUTO
         2 001575   200010 635500                    EPPR5   OUTBUFF$,,AUTO
         2 001576   201303 455500                    STP5    FID_RESULTS+527,,AUTO
         2 001577   201303 630500                    EPPR0   FID_RESULTS+527,,AUTO
         2 001600   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001601   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001602   002010 702000 2                  TSX2    TABS50

      509    11082    3                 I=I+1;

  11082  2 001603   200013 054100                    AOS     I,,AUTO

      510    11083    3              END;

  11083  2 001604   200006 470500                    LDP0    TEMP$,,AUTO
         2 001605   200013 235100                    LDA     I,,AUTO
         2 001606   000100 101505                    MRL     fill='000'O
         2 001607   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         2 001610   201302 000004                    ADSC9   FID_RESULTS+526,,AUTO    cn=0,n=4
         2 001611   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 001612   000000 116003                    CMPQ    0,DU
         2 001613   001616 600000 2                  TZE     s:11085
         2 001614   000037 115007                    CMPA    31,DL
         2 001615   001514 604000 2                  TMI     s:11076

      511    11084        /* ****          Determine if any tabs set   */
      512    11085    2              IF I>0

  11085  2 001616   000000 115003                    CMPA    0,DU
         2 001617   001636 604400 2                  TMOZ    s:11091
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:74   

      513    11086    2                 THEN
      514    11087    2                    SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,

  11087  2 001620   000000 471400 xsym               LDP1    SEG2$
         2 001621   100165 473500                    LDP3    117,,PR1
         2 001622   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001623   000020 772000                    QRL     16
         2 001624   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001625   200011 236100                    LDQ     DEST$,,AUTO
         2 001626   000020 772000                    QRL     16
         2 001627   201302 136100                    SBLQ    FID_RESULTS+526,,AUTO
         2 001630   000002 136007                    SBLQ    2,DL
         2 001631   000020 736000                    QLS     16
         2 001632   300004 676100                    ERQ     4,,PR3
         2 001633   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001634   300004 656100                    ERSQ    4,,PR3
         2 001635   001672 710000 2                  TRA     s:11096

      515    11088    2                         OUTBUFF$)-2;
      516    11089    2                 ELSE
      517    11090    3                    DO;

      518    11091    3                       TBUFF='None';

  11091  2 001636   000041 236000 1                  LDQ     E_NOROOM4SETUP+17
         2 001637   200073 756100                    STQ     TBUFF,,AUTO

      519    11092    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),4);

  11092  2 001640   200073 631500                    EPPR1   TBUFF,,AUTO
         2 001641   201302 451500                    STP1    FID_RESULTS+526,,AUTO
         2 001642   000022 236000 3                  LDQ     18
         2 001643   201307 756100                    STQ     FID_RESULTS+531,,AUTO
         2 001644   201302 633500                    EPPR3   FID_RESULTS+526,,AUTO
         2 001645   201306 453500                    STP3    FID_RESULTS+530,,AUTO
         2 001646   200011 634500                    EPPR4   DEST$,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:75   
         2 001647   201305 454500                    STP4    FID_RESULTS+529,,AUTO
         2 001650   200010 635500                    EPPR5   OUTBUFF$,,AUTO
         2 001651   201304 455500                    STP5    FID_RESULTS+528,,AUTO
         2 001652   201304 630500                    EPPR0   FID_RESULTS+528,,AUTO
         2 001653   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001654   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001655   000000 011000                    NOP     0

      520    11093    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,

  11093  2 001656   000000 470400 xsym               LDP0    SEG2$
         2 001657   000165 471500                    LDP1    117,,PR0
         2 001660   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001661   000020 772000                    QRL     16
         2 001662   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001663   200011 236100                    LDQ     DEST$,,AUTO
         2 001664   000020 772000                    QRL     16
         2 001665   201302 136100                    SBLQ    FID_RESULTS+526,,AUTO
         2 001666   000020 736000                    QLS     16
         2 001667   100004 676100                    ERQ     4,,PR1
         2 001670   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001671   100004 656100                    ERSQ    4,,PR1

      521    11094    3                            OUTBUFF$);
      522    11095    3                    END;

      523    11096    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  11096  2 001672   000000 470400 xsym               LDP0    SEG2$
         2 001673   000165 471500                    LDP1    117,,PR0
         2 001674   200010 236100                    LDQ     OUTBUFF$,,AUTO
         2 001675   100005 756100                    STQ     5,,PR1

      524    11097    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TABS50);

  11097  2 001676   000000 236000 xsym               LDQ     SEG2$
         2 001677   000165 036003                    ADLQ    117,DU
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:76   
         2 001700   201302 756100                    STQ     FID_RESULTS+526,,AUTO
         2 001701   201302 630500                    EPPR0   FID_RESULTS+526,,AUTO
         2 001702   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001703   000000 701000 xent               TSX1    CPE$LISTOUT
         2 001704   002010 702000 2                  TSX2    TABS50

      525    11098    2              RETURN;

  11098  2 001705   000000 702200 xent               TSX2  ! X66_ARET

      526    11099    2           END;
      527    11100        /*
      528    11101             ***** Set or reset specified TABS...
      529    11102        */
      530    11103    1     FPT_DEVICE = CFPT_DEVICE;

  11103  2 001706   000100 100400                    MLR     fill='000'O
         2 001707   000000 000050 xsym               ADSC9   CFPT_DEVICE              cn=0,n=40
         2 001710   200102 000050                    ADSC9   FPT_DEVICE,,AUTO         cn=0,n=40

      531    11104    1     FPT_DEVICE.V_ = VECTOR(FPT_DEVICE.V);

  11104  2 001711   000044 235000 3                  LDA     36
         2 001712   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 001713   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 001714   000110 036003                    ADLQ    72,DU
         2 001715   200102 757100                    STAQ    FPT_DEVICE,,AUTO

      532    11105    1     FPT_DEVICE.V.DCB# = M$UC_NUM;

  11105  2 001716   000000 720000 xsym               LXL0    M$UC_NUM
         2 001717   200110 740100                    STX0    FPT_DEVICE+6,,AUTO

      533    11106    2     DO CASE(BLK$->P$B.SUBLK$(0)->P$B.CODE);

  11106  2 001720   100003 473500                    LDP3    3,,PR1
         2 001721   300000 721100                    LXL1    0,,PR3
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:77   
         2 001722   000003 101003                    CMPX1   3,DU
         2 001723   001725 602011 2                  TNC     s:11106+5,X1
         2 001724   001776 710000 2                  TRA     s:11119
         2 001725   001774 710000 2                  TRA     s:11117
         2 001726   001776 710000 2                  TRA     s:11119
         2 001727   001730 710000 2                  TRA     s:11108

      534    11107    2      CASE(TABSLISTOPT);  /* list of tabs to set */

      535    11108    2        VLP_TAB=CVLP_TAB;

  11108  2 001730   000100 100400                    MLR     fill='000'O
         2 001731   000000 000040 xsym               ADSC9   CVLP_TAB                 cn=0,n=32
         2 001732   200126 000040                    ADSC9   VLP_TAB,,AUTO            cn=0,n=32

      536    11109    2        FPT_DEVICE.TAB_ = VECTOR(VLP_TAB);

  11109  2 001733   000006 235000 3                  LDA     6
         2 001734   201302 452500                    STP2    FID_RESULTS+526,,AUTO
         2 001735   201302 236100                    LDQ     FID_RESULTS+526,,AUTO
         2 001736   000126 036003                    ADLQ    86,DU
         2 001737   200104 757100                    STAQ    FPT_DEVICE+2,,AUTO

      537    11110    2        BLK$ = BLK$ -> P$B.SUBLK$(0);

  11110  2 001740   100003 236100                    LDQ     3,,PR1
         2 001741   200005 756100                    STQ     BLK$,,AUTO

      538    11111    3        DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;

  11111  2 001742   200013 450100                    STZ     I,,AUTO
         2 001743   001766 710000 2                  TRA     s:11115+1

      539    11112    3           TEMP$=BLK$->P$B.SUBLK$(I);

  11112  2 001744   200005 470500                    LDP0    BLK$,,AUTO
         2 001745   200013 720100                    LXL0    I,,AUTO
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:78   
         2 001746   000003 236110                    LDQ     3,X0,PR0
         2 001747   200006 756100                    STQ     TEMP$,,AUTO

      540    11113    3           CALL CHARBIN(TSTOR,TEMP$->P$S.TEXT);

  11113  2 001750   200006 471500                    LDP1    TEMP$,,AUTO
         2 001751   100004 236100                    LDQ     4,,PR1
         2 001752   000033 772000                    QRL     27
         2 001753   000000 621006                    EAX1    0,QL
         2 001754   000100 305540                    DTB
         2 001755   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         2 001756   201302 000010                    NDSC9   FID_RESULTS+526,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 001757   201303 235100                    LDA     FID_RESULTS+527,,AUTO
         2 001760   200015 755100                    STA     TSTOR,,AUTO

      541    11114    3           VLP_TAB.TABS#(I)=TSTOR;

  11114  2 001761   200013 236100                    LDQ     I,,AUTO
         2 001762   000106 101500                    MRL     fill='000'O
         2 001763   200015 000004                    ADSC9   TSTOR,,AUTO              cn=0,n=4
         2 001764   200126 200001                    ADSC9   VLP_TAB,Q,AUTO           cn=1,n=1

      542    11115    3        END;

  11115  2 001765   200013 054100                    AOS     I,,AUTO
         2 001766   200005 470500                    LDP0    BLK$,,AUTO
         2 001767   000001 236100                    LDQ     1,,PR0
         2 001770   000022 772000                    QRL     18
         2 001771   200013 116100                    CMPQ    I,,AUTO
         2 001772   001744 605400 2                  TPNZ    s:11112
         2 001773   001776 710000 2                  TRA     s:11119

      543    11116    2      CASE(TABSRESETOPT);

      544    11117    2        FPT_DEVICE.TAB_ = VECTOR(ERASE);

  11117  2 001774   000046 237000 3                  LDAQ    38
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:79   
         2 001775   200104 757100                    STAQ    FPT_DEVICE+2,,AUTO

      545    11118    2      END;

      546    11119    1     CALL M$DEVICE (FPT_DEVICE) ALTRET(TABS45);

  11119  2 001776   200102 630500                    EPPR0   FPT_DEVICE,,AUTO
         2 001777   450006 713400                    CLIMB   alt,+20486
         2 002000   401000 401760                    pmme    nvectors=3
         2 002001   002003 702000 2                  TSX2    TABS45

      547    11120    1     RETURN;

  11120  2 002002   000000 702200 xent               TSX2  ! X66_ARET

  11117  2 002003                       TABS45       null
      548    11121    1   TABS45: ;
      549    11122    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  11122  2 002003   000000 470400 xsym               LDP0    B$TCB$
         2 002004   000000 471500                    LDP1    0,,PR0
         2 002005   100102 236100                    LDQ     66,,PR1
         2 002006   000000 473400 xsym               LDP3    B$JIT$
         2 002007   300144 756100                    STQ     100,,PR3

  11122  2 002010                       TABS50       null
      550    11123    1   TABS50: ;
      551    11124    1     ALTRETURN;

  11124  2 002010   000000 702200 xent               TSX2  ! X66_AALT
      552    11125    1   END CPI$IBEX;

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:80   
--  Include file information  --

   AS_SUPER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPI$IBEX.
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:81   

 **** Variables and constants ****

  ****  Section 001 RoData CPI$IBEX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/c CHAR(12)    r     1 DEF_PRIO                  17-0-0/w STRC        r     1 E_NOCHGSETUP
    20-0-0/w STRC        r     1 E_NOROOM4SETUP            16-0-0/w STRC        r     1 E_NOSCMND
    14-0-0/d STRC(45)    r     1 M$DRDCB                    6-0-0/c CHAR(10)    r     1 MAX_PRIO
     0-0-0/c CHAR(22)    r     1 PRIO_HDR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @MSGFLAG                   3-0-0/w PTR         r     1 @P$PCB
    17-0-0/w UBIN(9)     r     1 ASN                        5-0-0/w PTR         r     1 BLK$
    11-0-0/w PTR         r     1 DEST$                     12-0-0/w PTR         r     1 FID$
   264-0-0/d STRC(324)   r     1 FID_RESULTS              102-0-0/d STRC(360)   r     1 FPT_DEVICE
   122-0-0/d STRC(144)   r     1 FPT_DRIBBLE               76-0-0/d STRC(144)   r     1 FPT_SETFMA
   114-0-0/d STRC(216)   r     1 FPT_TRMISC                13-0-0/w SBIN        r     1 I
    14-0-0/w SBIN        r     1 MODE                      *0-0-0/w BIT         r     1 MSGFLAG
    20-0-0/c CHAR(120)   r     1 OUTBUFF                   10-0-0/w PTR         r     1 OUTBUFF$
     7-0-0/w PTR         r     1 P$                        *0-0-0/w STRC(504)   r     1 P$PCB
    74-0-0/w UBIN        r     1 TABS_VAL                  73-0-0/c CHAR(4)     r     1 TBUFF
     6-0-0/w PTR         r     1 TEMP$                     56-0-0/c CHAR(50)    r     1 TEMPBUFF
    15-0-0/w UBIN        r     1 TSTOR                     16-0-0/w UBIN        r     1 VARY_CNT
   146-0-0/c STRC(72)    r     1 VLP_ACCT                 136-0-0/c STRC(288)   r     1 VLP_NAME
   150-0-0/d STRC(2736)  r     1 VLP_SN                   126-0-0/w STRC(288)   r     1 VLP_TAB

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:82   
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d STRC(360)   r     1 CFPT_DEVICE                0-0-0/d STRC(144)   r     1 CFPT_DRIBBLE
     0-0-0/d STRC(144)   r     1 CFPT_SETFMA                0-0-0/d STRC(216)   r     1 CFPT_TRMISC
     0-0-0/w STRC(288)   r     1 CVLP_TAB                   0-0-0/c STRC(45)    r     1 DRIBBLEDCB
     0-0-0/w UBIN        r     1 M$IBEX1_NUM                0-0-0/w UBIN        r     1 M$UC_NUM
     0-0-0/w PTR         r     1 SEG2$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(18576) r     1 AS$USERS                   0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/w STRC(2448)  r     1 B$EXCFR                    0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(1080)  r     1 FPT$CLOSE                  0-0-0/d STRC(864)   r     1 FPT$FID
     0-0-0/d STRC(432)   r     1 FPT$WRITE                  0-0-0/c ASTR(9)     r     1 MOV$STR
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S
     0-0-0/w STRC(6264)  r     1 SEG$2                      0-0-0/c ASTR(9)     r     1 TEXT$C
     0-0-0/w STRC(288)   r     1 VLP$TAB


   Procedure CPI$IBEX requires 1033 words for executable code.
   Procedure CPI$IBEX requires 712 words of local(AUTO) storage.

    No errors detected in file CPI$IBEX.:E05TSI    .
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:84   
          MINI XREF LISTING

ACCEPT_ERR
     10716**LABEL   10713--CALLALT
AS$USERS.BANNER_PERM
     10562**DCL     10563--REDEF
AS$USERS.BUDGET.MACCT
     10467**DCL     10471--REDEF
AS$USERS.BUDGET.MAX_PROJECTS
     10480**DCL     10483--REDEF
AS$USERS.BUDGET.PACCUM
     10463**DCL     10465--REDEF
AS$USERS.BUDGET.PMAXC
     10458**DCL     10460--REDEF
AS$USERS.SETUP
     10574**DCL     10959>>IF      10967>>ASSIGN
AS$USERS.SETUP_CHRA.TXT
     10578**DCL     10579--REDEF   10580--REDEF   10967--ASSIGN
AS$USERS.SETUP_PERM
     10561**DCL     10998>>IF
ASC$SETUP
      9546**DCL-ENT 11012--CALL
ASN
      9532**DCL     10801--ASSIGN
AS_USERS.BANNER_PERM
     10384**DCL     10385--REDEF
AS_USERS.BUDGET.MACCT
     10289**DCL     10293--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10302**DCL     10305--REDEF
AS_USERS.BUDGET.PACCUM
     10285**DCL     10287--REDEF
AS_USERS.BUDGET.PMAXC
     10280**DCL     10282--REDEF
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:85   
AS_USERS.SETUP_CHRA.TXT
     10400**DCL     10401--REDEF   10402--REDEF
B$ALT.CODE
      9580**DCL      9580--REDEF    9581--REDEF    9581--REDEF
B$ALT.DCB#
      9581**DCL     10857<>CALL
B$ALT.ERR
      9581**DCL     10857<>CALL
B$ALT.ERR.ERR#
      9582**DCL      9582--REDEF
B$ALT.EVID
      9581**DCL      9581--REDEF    9581--REDEF
B$EXCFR.ASL
      9561**DCL      9561--REDEF
B$EXCFR.ERR
      9575**DCL     10716>>ASSIGN  10815>>ASSIGN  11122>>ASSIGN
B$EXCFR.ERR.ERR#
      9575**DCL      9575--REDEF
B$EXCFR.EVID
      9574**DCL      9574--REDEF    9575--REDEF
B$EXCFR.IR
      9562**DCL      9562--REDEF
B$EXCFR.PREVSZ
      9561**DCL      9561--REDEF
B$EXCFR.SUBC
      9573**DCL      9573--REDEF    9574--REDEF    9574--REDEF
B$JIT.CPFLAGS1.SLEAZE
       206**DCL       206--REDEF
B$JIT.DEFPRI
       260**DCL     10888<<ASSIGN  10907>>CALLBLT
B$JIT.ERR.MID
       113**DCL       113--REDEF
B$JIT.FACCN
       112**DCL     10768>>CALLBLT 10777>>CALLBLT
B$JIT.FPSN
       193**DCL     10761>>CALLBLT 10767--CALL
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:86   
B$JIT.JRESPEAK
       274**DCL       275--REDEF
B$JIT.MAXPRI
       260**DCL     10901>>CALLBLT
B$JIT.MODE
       107**DCL     10941>>ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
       383**DCL       383--REDEF     384--REDEF
B$JIT.PNR
       287**DCL       287--REDEF
B$JIT.TSLINE
       381**DCL       382--REDEF
B$JIT.USRERR
       248**DCL     10716<<ASSIGN  10815<<ASSIGN  11122<<ASSIGN
B$JIT$
      9017**DCL       107--IMP-PTR 10716>>ASSIGN  10761>>CALLBLT 10767>>CALL    10768>>CALLBLT 10777>>CALLBLT
     10815>>ASSIGN  10888>>ASSIGN  10901>>CALLBLT 10907>>CALLBLT 10941>>ASSIGN  11122>>ASSIGN
B$TCB.ALT$
      9558**DCL     10716>>ASSIGN  10815>>ASSIGN  10857>>CALL    10857>>CALL    11122>>ASSIGN
B$TCB$
      9019**DCL      9558--IMP-PTR 10716>>ASSIGN  10815>>ASSIGN  10857>>CALL    10857>>CALL    11122>>ASSIGN
BLK$
      9521**DCL      9793--IMP-PTR  9839--IMP-PTR 10692<<ASSIGN  10697>>DOWHILE 10698>>ASSIGN  10748<<ASSIGN
     10752>>IF      10790>>DOCASE  10794>>ASSIGN  10794>>ASSIGN  10842<<ASSIGN  10844>>IF      10847>>ASSIGN
     10848>>ASSIGN  10849>>ASSIGN  10850<>CALL    10883<<ASSIGN  10884>>IF      10887>>CALLBLT 10887>>CALLBLT
     10939<<ASSIGN  10942>>IF      10942>>IF      10945>>ASSIGN  10954>>IF      11011>>ASSIGN  11059<<ASSIGN
     11063>>IF      11106>>DOCASE  11110<<ASSIGN  11110>>ASSIGN  11111>>DOINDEX 11112>>ASSIGN
CAMR_REC.ACSVEH_
      8056**DCL      8057--REDEF
CAMR_REC.ALTKEYS_
      8062**DCL      8063--REDEF    8063--REDEF
CAMR_REC.HDR_
      8061**DCL      8062--REDEF
CAMR_REC.TAB_
      8060**DCL      8061--REDEF
CAMR_REC.UHL_
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:87   
      8054**DCL      8055--REDEF    8055--REDEF
CAMR_REC.V.FSN#
      8094**DCL      8094--REDEF    8094--REDEF
CAMR_REC.WSN_
      8060**DCL      8060--REDEF
CFPT_CLOSE.SN_
      6898**DCL      6898--REDEF
CFPT_CLOSE.UTL_
      6899**DCL      6899--REDEF
CFPT_CLOSE.V.EXPIRE#
      6913**DCL      6913--REDEF
CFPT_CLOSE.V.TYPE#
      6911**DCL      6911--REDEF
CFPT_CLOSE.V.XTNSIZE#
      6908**DCL      6908--REDEF    6910--REDEF
CFPT_DEVICE
      7559**DCL     11103>>ASSIGN
CFPT_DRIBBLE
      8241**DCL     10839>>ASSIGN
CFPT_OPEN.ACSVEH_
      6833**DCL      6834--REDEF
CFPT_OPEN.ALTKEYS_
      6839**DCL      6840--REDEF    6840--REDEF
CFPT_OPEN.HDR_
      6838**DCL      6839--REDEF
CFPT_OPEN.TAB_
      6837**DCL      6838--REDEF
CFPT_OPEN.UHL_
      6831**DCL      6832--REDEF    6832--REDEF
CFPT_OPEN.V.FSN#
      6871**DCL      6871--REDEF    6871--REDEF
CFPT_OPEN.WSN_
      6837**DCL      6837--REDEF
CFPT_READ.STATION_
      6937**DCL      6938--REDEF
CFPT_READ.V.DVBYTE.REREAD#
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:88   
      6949**DCL      6949--REDEF
CFPT_READ.V.INDX#
      6947**DCL      6947--REDEF
CFPT_READUC.STATION_
      7307**DCL      7308--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
      7319**DCL      7319--REDEF
CFPT_READUC.V.INDX#
      7317**DCL      7317--REDEF
CFPT_SETFMA
      7577**DCL     10789>>ASSIGN
CFPT_TRMISC
      7249**DCL     10693>>ASSIGN
CFPT_TRTN.V.IR#
      7543**DCL      7544--REDEF
CFPT_WRITE.STATION_
      6975**DCL      6975--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      6982**DCL      6982--REDEF
CFPT_WRITEUC.STATION_
      7275**DCL      7275--REDEF
CFPT_WRITEUC.V.DVBYTE.VFC#
      7282**DCL      7282--REDEF
CFPT_XXX.V.STEPCC#
      8255**DCL      8255--REDEF
CGETCMD.OUT$
      8276**DCL      8282--REDEF
CPB$BLDIMAGE
      9548**DCL-ENT 10766--CALL    10767--CALL    10770--CALL    10779--CALL    10897--CALL    10899--CALL
     10903--CALL    10905--CALL    10909--CALL    10970--CALL    11078--CALL    11081--CALL    11092--CALL
CPC$RDUSERS
      9552**DCL-ENT 10957--CALL    10997--CALL
CPC$WRITEMSGE
      9551**DCL-ENT 10990--CALL
CPC$WRUSERS
      9553**DCL-ENT 11027--CALL
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:89   
CPE$GENRUAM
      9555**DCL-ENT 10850--CALL
CPE$LISTOUT
      9549**DCL-ENT 10783--CALL    10913--CALL    10974--CALL    11097--CALL
CPE$RFEXT
      9550**DCL-ENT 10853--CALL
CPE$RZEROS
      9547**DCL-ENT 10902--CALL    10908--CALL    11077--CALL
CVLP_TAB
      7738**DCL     11108>>ASSIGN
CVLP_TRMCTL.BREAKCOUNT
      7867**DCL      7868--REDEF
CVLP_WINDOW.FWINDOW#
      7963**DCL      7963--REDEF    7964--REDEF
CXP$POSTERR
      9554**DCL-ENT 10857--CALL    11001--CALL    11014--CALL
DEF_PRIO
      9541**DCL     10905--CALL    10905--CALL
DEST$
      9525**DCL     10756<<ASSIGN  10759<<ASSIGN  10759>>ASSIGN  10766<>CALL    10767<>CALL    10770<>CALL
     10779<>CALL    10781>>ASSIGN  10895<<ASSIGN  10897<>CALL    10899<>CALL    10903<>CALL    10905<>CALL
     10909<>CALL    10912>>ASSIGN  10964<<ASSIGN  10966<<ASSIGN  10966>>ASSIGN  10970<>CALL    10973>>ASSIGN
     11068<<ASSIGN  11071<<ASSIGN  11071>>ASSIGN  11078<>CALL    11081<>CALL    11087>>ASSIGN  11092<>CALL
     11093>>ASSIGN
DIR50
     10812**LABEL   10783--CALLALT 10804--CALLALT 10812--CALLALT
DRIB50
     10849**LABEL   10854--CALLALT
DRIB60
     10857**LABEL   10850--CALLALT
DRIBBLEDCB
      7698**DCL     10850--CALL
E_NOCHGSETUP
     10646**DCL     11001<>CALL
E_NOROOM4SETUP
     10666**DCL     11014<>CALL
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:90   
E_NOSCMND
     10626**DCL     10990<>CALL
F$DCB.ACTPOS
     10132**DCL     10132--REDEF
F$DCB.ARS#
     10106**DCL     10106--REDEF
F$DCB.ATTR
     10125**DCL     10126--REDEF
F$DCB.BORROW
     10140**DCL     10140--REDEF   10140--REDEF   10140--REDEF
F$DCB.DCBNAME.L
     10154**DCL     10154--IMP-SIZ
F$DCB.EOMCHAR#
     10110**DCL     10110--REDEF
F$DCB.FLDID
     10135**DCL     10135--REDEF
F$DCB.FORM$
     10129**DCL     10129--REDEF
F$DCB.FSECT
     10145**DCL     10145--REDEF
F$DCB.FSN#
     10122**DCL     10122--REDEF   10122--REDEF   10123--REDEF
F$DCB.HEADER$
     10128**DCL     10128--REDEF
F$DCB.IXTNSIZE#
     10126**DCL     10126--REDEF
F$DCB.LASTSTA$
     10115**DCL     10115--REDEF
F$DCB.LVL
     10141**DCL     10141--REDEF
F$DCB.NAME#.C
     10116**DCL     10116--REDEF
F$DCB.NOEOF
     10138**DCL     10138--REDEF
F$DCB.NRECS#
     10127**DCL     10127--REDEF
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:91   
F$DCB.NRECX
     10146**DCL     10146--REDEF
F$DCB.OHDR
     10138**DCL     10138--REDEF
F$DCB.ORG#
     10121**DCL     10121--REDEF
F$DCB.PRECNO
     10144**DCL     10144--REDEF
F$DCB.RCSZ
     10150**DCL     10150--REDEF
F$DCB.RES#
     10117**DCL     10117--REDEF
F$DCB.SETX
     10129**DCL     10129--REDEF
F$DCB.TAB$
     10129**DCL     10129--REDEF   11074>>ASSIGN
F$DCB.TDA
     10143**DCL     10144--REDEF
F$DCB.WSN#
     10117**DCL     10117--REDEF
FID$
      9526**DCL     10848<<ASSIGN  10850<>CALL
FID_RESULTS
     10248**DCL     10803--ASSIGN
FID_RESULTS.SN
     10248**DCL     10807>>IF
FPT$CLOSE
     10048**DCL     11004<>CALL    11030<>CALL
FPT$CLOSE.SN_
     10048**DCL     10048--REDEF
FPT$CLOSE.UTL_
     10049**DCL     10049--REDEF
FPT$CLOSE.V.DCB#
     10054**DCL     11002<<ASSIGN  11028<<ASSIGN
FPT$CLOSE.V.DISP#
     10057**DCL     11003<<ASSIGN  11029<<ASSIGN
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:92   
FPT$CLOSE.V.EXPIRE#
     10063**DCL     10063--REDEF
FPT$CLOSE.V.TYPE#
     10061**DCL     10061--REDEF
FPT$CLOSE.V.XTNSIZE#
     10058**DCL     10058--REDEF   10060--REDEF
FPT$FID
      9964**DCL     10804<>CALL
FPT$FID.ACCT_
      9965**DCL     10797<<ASSIGN
FPT$FID.ASN_
      9967**DCL     10801<<ASSIGN
FPT$FID.NAME_
      9965**DCL     10796<<ASSIGN
FPT$FID.PASS_
      9965**DCL     10798<<ASSIGN
FPT$FID.RESULTS_
      9967**DCL     10803<<ASSIGN
FPT$FID.RES_
      9967**DCL     10802<<ASSIGN
FPT$FID.SN_
      9966**DCL     10799<<ASSIGN
FPT$FID.TEXTFID_
      9964**DCL     10794<<ASSIGN
FPT$FID.WSN_
      9966**DCL     10800<<ASSIGN
FPT$WRITE.BUF_.BOUND
     10011**DCL     10781<<ASSIGN  10912<<ASSIGN  10973<<ASSIGN  11087<<ASSIGN  11093<<ASSIGN
FPT$WRITE.BUF_.BUF$
     10013**DCL     10782<<ASSIGN  10911<<ASSIGN  10972<<ASSIGN  11096<<ASSIGN
FPT$WRITE.STATION_
     10013**DCL     10013--REDEF
FPT$WRITE.V.DVBYTE.VFC#
     10020**DCL     10020--REDEF
FPT_DEVICE
      9987**DCL     11103<<ASSIGN  11119<>CALL
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:93   
FPT_DEVICE.TAB_
      9987**DCL     11109<<ASSIGN  11117<<ASSIGN
FPT_DEVICE.V
      9988**DCL     11104--ASSIGN
FPT_DEVICE.V.DCB#
      9988**DCL     11105<<ASSIGN
FPT_DEVICE.V_
      9987**DCL     11104<<ASSIGN
FPT_DRIBBLE
     10097**DCL     10839<<ASSIGN  10854<>CALL
FPT_DRIBBLE.V
     10097**DCL     10840--ASSIGN
FPT_DRIBBLE.V.DRIBBLE#
     10097**DCL     10841<<ASSIGN
FPT_DRIBBLE.V_
     10097**DCL     10840<<ASSIGN
FPT_SETFMA
      9951**DCL     10789<<ASSIGN  10812<>CALL
FPT_SETFMA.ACCT_
      9951**DCL     10806<<ASSIGN
FPT_SETFMA.PSN_
      9951**DCL     10810<<ASSIGN
FPT_TRMISC
     10081**DCL     10693<<ASSIGN  10713<>CALL
FPT_TRMISC.V
     10085**DCL     10694--ASSIGN
FPT_TRMISC.V.ANNOUNCE#
     10086**DCL     10703<<ASSIGN  10705<<ASSIGN
FPT_TRMISC.V.BROADCAST#
     10085**DCL     10702<<ASSIGN  10707<<ASSIGN
FPT_TRMISC.V.DCB#
     10085**DCL     10695<<ASSIGN
FPT_TRMISC.V.SEND#
     10085**DCL     10701<<ASSIGN  10709<<ASSIGN
FPT_TRMISC.V_
     10083**DCL     10694<<ASSIGN
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:94   
I
      9528**DCL     10696<<ASSIGN  10697>>DOWHILE 10698>>ASSIGN  10711<<ASSIGN  10711>>ASSIGN  10843<<ASSIGN
     10849<<ASSIGN  10857<>CALL    10940<<ASSIGN  10944<<ASSIGN  10954>>IF      11011>>ASSIGN  11073<<ASSIGN
     11075>>DOWHILE 11075>>DOWHILE 11076>>CALLBLT 11082<<ASSIGN  11082>>ASSIGN  11085>>IF      11111<<DOINDEX
     11112>>ASSIGN  11114>>ASSIGN
M$CLOSE
        26**DCL-ENT 11004--CALL    11030--CALL
M$DEVICE
        30**DCL-ENT 11119--CALL
M$DRDCB
      9542**DCL     10853--CALL
M$DRIBBLE
        56**DCL-ENT 10854--CALL
M$FID
        89**DCL-ENT 10804--CALL
M$IBEX1_NUM
      9023**DCL     10957<>CALL    10997<>CALL    11002>>ASSIGN  11027<>CALL    11028>>ASSIGN
M$SETFMA
        26**DCL-ENT 10812--CALL
M$TRMISC
        55**DCL-ENT 10713--CALL
M$UC_NUM
      9020**DCL     10695>>ASSIGN  11074--ASSIGN  11105>>ASSIGN
MAX_PRIO
      9540**DCL     10899--CALL    10899--CALL
MODE
      9529**DCL     10941<<ASSIGN  10945<<ASSIGN  10959>>IF      10967>>ASSIGN  10998>>IF      11012>>CALL
MOV$STR
      9935**DCL     11012<>CALL
MOV$STR.CNT
      9936**DCL      9937--IMP-SIZ 10969>>ASSIGN  11012>>CALL
MOV$STR.TXT
      9937**DCL     10970--CALL
MSGFLAG
      9520**DCL        15--PROC    10936--ENTRY   10981--IF      10981--IF      10981>>IF
OUTBUFF
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:95   
      9534**DCL     10755--ASSIGN  10758<<ASSIGN  10894--ASSIGN  10896<<ASSIGN  10963--ASSIGN  10965<<ASSIGN
     11067--ASSIGN  11070<<ASSIGN
OUTBUFF$
      9524**DCL     10755<<ASSIGN  10756>>ASSIGN  10766<>CALL    10767<>CALL    10770<>CALL    10779<>CALL
     10781>>ASSIGN  10782>>ASSIGN  10894<<ASSIGN  10895>>ASSIGN  10897<>CALL    10899<>CALL    10903<>CALL
     10905<>CALL    10909<>CALL    10911>>ASSIGN  10912>>ASSIGN  10963<<ASSIGN  10964>>ASSIGN  10970<>CALL
     10972>>ASSIGN  10973>>ASSIGN  11067<<ASSIGN  11068>>ASSIGN  11078<>CALL    11081<>CALL    11087>>ASSIGN
     11092<>CALL    11093>>ASSIGN  11096>>ASSIGN
P$
      9523**DCL     10698<<ASSIGN  10699>>DOCASE
P$B.CODE
      9801**DCL     10699>>DOCASE  10790>>DOCASE  10942>>IF      10945>>ASSIGN  11106>>DOCASE
P$B.NSUBLKS
      9805**DCL     10697>>DOWHILE 10752>>IF      10844>>IF      10884>>IF      10942>>IF      10954>>IF
     11063>>IF      11111>>DOINDEX
P$B.SUBLK$
      9826**DCL     10698>>ASSIGN  10790>>DOCASE  10794>>ASSIGN  10794>>ASSIGN  10847>>ASSIGN  10848>>ASSIGN
     10848>>ASSIGN  10849>>ASSIGN  10887>>CALLBLT 10887>>CALLBLT 10942>>IF      10945>>ASSIGN  10945>>ASSIGN
     11011>>ASSIGN  11106>>DOCASE  11110>>ASSIGN  11112>>ASSIGN
P$PCB
      9605**DCL        15--PROC    10691--ENTRY   10745--ENTRY   10838--ENTRY   10880--ENTRY   10936--ENTRY
     11056--ENTRY
P$PCB.OUT$
      9618**DCL     10692>>ASSIGN  10748>>ASSIGN  10842>>ASSIGN  10883>>ASSIGN  10939>>ASSIGN  11059>>ASSIGN
P$S.COUNT
      9862**DCL      9865--IMP-SIZ 10887>>CALLBLT 11011--ASSIGN  11113>>CALLBLT
P$S.CPOS
      9854**DCL     10849>>ASSIGN
P$S.TEXT
      9865**DCL     10887>>CALLBLT 11113>>CALLBLT
P$S.TEXTC$
      9857**DCL     10794>>ASSIGN  10794>>ASSIGN
PRIO10
     10888**LABEL   10886--GOTO
PRIO50
     10912**LABEL   10897--CALLALT 10899--CALLALT 10903--CALLALT 10905--CALLALT 10909--CALLALT 10913--CALLALT
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:96   
PRIO_HDR
      9539**DCL     10897--CALL    10897--CALL
SEG$2.ERRBUF
      9896**DCL     10857--CALL    11001--CALL    11014--CALL
SEG$2.FLAGS.USERS
      9873**DCL     10950<<ASSIGN
SEG$2.FPT_CLOSE$
      9909**DCL     11002>>ASSIGN  11003>>ASSIGN  11004>>CALL    11028>>ASSIGN  11029>>ASSIGN  11030>>CALL
SEG$2.FPT_FID$
      9913**DCL     10794>>ASSIGN  10796>>ASSIGN  10797>>ASSIGN  10798>>ASSIGN  10799>>ASSIGN  10800>>ASSIGN
     10801>>ASSIGN  10802>>ASSIGN  10803>>ASSIGN  10804>>CALL
SEG$2.FPT_WRITE$
      9911**DCL     10781>>ASSIGN  10782>>ASSIGN  10783<>CALL    10911>>ASSIGN  10912>>ASSIGN  10913<>CALL
     10972>>ASSIGN  10973>>ASSIGN  10974<>CALL    11087>>ASSIGN  11093>>ASSIGN  11096>>ASSIGN  11097<>CALL
SEG$2.USERS$
      9900**DCL     10959>>IF      10967>>ASSIGN  10967>>ASSIGN  10998>>IF      11012<>CALL
SEG2$
      9010**DCL      9871--IMP-PTR 10781>>ASSIGN  10782>>ASSIGN  10783>>CALL    10794>>ASSIGN  10796>>ASSIGN
     10797>>ASSIGN  10798>>ASSIGN  10799>>ASSIGN  10800>>ASSIGN  10801>>ASSIGN  10802>>ASSIGN  10803>>ASSIGN
     10804>>CALL    10857>>CALL    10911>>ASSIGN  10912>>ASSIGN  10913>>CALL    10950>>ASSIGN  10959>>IF
     10967>>ASSIGN  10967>>ASSIGN  10972>>ASSIGN  10973>>ASSIGN  10974>>CALL    10998>>IF      11001>>CALL
     11002>>ASSIGN  11003>>ASSIGN  11004>>CALL    11012>>CALL    11014>>CALL    11028>>ASSIGN  11029>>ASSIGN
     11030>>CALL    11087>>ASSIGN  11093>>ASSIGN  11096>>ASSIGN  11097>>CALL
SETUP55
     11029**LABEL   10957--CALLALT 10970--CALLALT 10974--CALLALT 10997--CALLALT 11004--CALLALT 11005--GOTO
     11015--GOTO    11027--CALLALT 11030--CALLALT
TABS45
     11117**LABEL   11119--CALLALT
TABS50
     11122**LABEL   11078--CALLALT 11081--CALLALT 11097--CALLALT
TABS_VAL
      9537**DCL     10962<<ASSIGN  10970<>CALL    11066<<ASSIGN  11078<>CALL    11081<>CALL
TBUFF
      9536**DCL     10802--ASSIGN  10901<<CALLBLT 10902<>CALL    10902--CALL    10903--CALL    10907<<CALLBLT
     10908<>CALL    10908--CALL    10909--CALL    11076<<CALLBLT 11077<>CALL    11077--CALL    11078--CALL
     11080<<ASSIGN  11081--CALL    11091<<ASSIGN  11092--CALL
PL6.E3A0      #001=CPI$IBEX File=CPI$IBEX.:E05TSI                                TUE 07/29/97 11:50 Page:97   
TEMP$
      9522**DCL     10847<<ASSIGN  10850<>CALL    10967<<ASSIGN  10969>>ASSIGN  10970>>CALL    11011<<ASSIGN
     11012>>CALL    11012>>CALL    11074<<ASSIGN  11075>>DOWHILE 11076>>CALLBLT 11112<<ASSIGN  11113>>CALLBLT
     11113>>CALLBLT
TEMPBUFF
      9535**DCL     10765<<ASSIGN  10766--CALL    10768<<CALLBLT 10769>>CALLBLT 10770--CALL    10777<<CALLBLT
     10778>>CALLBLT 10779--CALL
TEXT$C.SIZ
      9932**DCL      9933--IMP-SIZ 10794>>ASSIGN
TEXT$C.TEXT
      9933**DCL     10794--ASSIGN
TSTOR
      9530**DCL     10761<<CALLBLT 10762>>IF      10767<>CALL    10769<<CALLBLT 10770<>CALL    10778<<CALLBLT
     10779<>CALL    10887<<CALLBLT 10888>>ASSIGN  10902<>CALL    10903<>CALL    10908<>CALL    10909<>CALL
     11077<>CALL    11078<>CALL    11113<<CALLBLT 11114>>ASSIGN
VARY_CNT
      9531**DCL      9938--IMP-SIZ 10969<<ASSIGN  10970<>CALL
VLP$TAB.TABS#
     10167**DCL     11075>>DOWHILE 11076>>CALLBLT
VLP_ACCT
     10222**DCL     10797--ASSIGN  10798--ASSIGN  10800--ASSIGN  10806--ASSIGN
VLP_NAME
     10209**DCL     10796--ASSIGN
VLP_SN
     10235**DCL     10799--ASSIGN
VLP_SN.SN#
     10235**DCL     10810--ASSIGN
VLP_TAB
     10181**DCL     11108<<ASSIGN  11109--ASSIGN
VLP_TAB.TABS#
     10181**DCL     11114<<ASSIGN
