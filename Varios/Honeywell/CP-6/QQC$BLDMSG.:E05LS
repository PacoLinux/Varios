VERSION E05

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:1    
        1        1        /*M* QQC$BLDMSG - Build a message */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQC$BLDMSG:
        9        9                PROC(P_MSGBLK);
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QQ_MACROS_C;
       16      575        %INCLUDE QQ_SUBS_C;
       17      767        %PAGE(ARG="Parameters");

               784    1   /***************************************************************************
               785    1    *                                                                         *
               786    1    *                                 Parameters                              *
               787    1    *                                                                         *
               788    1    ***************************************************************************/

       18      792        %MSGBLK(FPTN=P_MSGBLK);
       19      882        %PAGE(ARG="Externally defined routines");

               899    1   /***************************************************************************
               900    1    *                                                                         *
               901    1    *                        Externally defined routines                      *
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:2    
               902    1    *                                                                         *
               903    1    ***************************************************************************/

       20      907    1   DCL QQC$SNDMSG ENTRY(1);
       21      908        %PAGE(ARG="DCBs");

               925    1   /***************************************************************************
               926    1    *                                                                         *
               927    1    *                                    DCBs                                 *
               928    1    *                                                                         *
               929    1    ***************************************************************************/

       22      933    1   DCL M$DO DCB;
       23      934        %PAGE(ARG="Based");

               951    1   /***************************************************************************
               952    1    *                                                                         *
               953    1    *                                   Based                                 *
               954    1    *                                                                         *
               955    1    ***************************************************************************/

       24      959    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       25      960        %PAGE(ARG="Constants");

               977    1   /***************************************************************************
               978    1    *                                                                         *
               979    1    *                                 Constants                               *
               980    1    *                                                                         *
               981    1    ***************************************************************************/

       26      985        %VLP_NAME(FPTN=QQERRMSG, STCLASS=CONSTANT, NAME=':QQERRMSG');
       27     1012        %PAGE(ARG="Auto");

              1029    1   /***************************************************************************
              1030    1    *                                                                         *
              1031    1    *                                    Auto                                 *
              1032    1    *                                                                         *
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:3    
              1033    1    ***************************************************************************/

       28     1037    1   DCL P$ PTR;
       29     1038    1   DCL TO$ PTR;
       30     1039    1   DCL FROM$ PTR;
       31     1040    1   DCL K UBIN WORD;
       32     1041    1   DCL I UBIN WORD;
       33     1042    1   DCL NEXT_OFFSET UBIN WORD;
       34     1043    1   DCL SPACE_USED UBIN WORD;
       35     1044    1   DCL CHAR_STRING_SIZE SBIN WORD;
       36     1045    1   DCL ERRBUF CHAR(960);
       37     1046        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:4    
              1063    1   /***************************************************************************
              1064    1    *                                                                         *
              1065    1    *                                    FPTs                                 *
              1066    1    *                                                                         *
              1067    1    ***************************************************************************/

       38     1071        %FPT_ERRMSG(FILENAME=QQERRMSG, INCLCODE=NO, RESULTS=VLR_ERRMSG);
       39     1098        %PAGE(ARG="VLRs");

              1115    1   /***************************************************************************
              1116    1    *                                                                         *
              1117    1    *                                    VLRs                                 *
              1118    1    *                                                                         *
              1119    1    ***************************************************************************/

       40     1123        %VLR_ERRMSG;
       41     1145        %PAGE(ARG="QQC$BLDMSG", PAGE=YES);

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:5    
              1162    1   /***************************************************************************
              1163    1    *                                                                         *
              1164    1    *                                 QQC$BLDMSG                              *
              1165    1    *                                                                         *
              1166    1    ***************************************************************************/

       42     1170    1           ERRBUF = ' ';
       43     1171    1           SPACE_USED = 0;
       44     1172
       45     1173    1           IF P_MSGBLK.TEXT$ ~= ADDR(NIL) THEN
       46     1174    2             DO;
       47     1175    2               CHAR_STRING_SIZE = P_MSGBLK.ARS;
       48     1176    2               ADDR(ERRBUF) -> CHAR$STRING = P_MSGBLK.TEXT$ -> CHAR$STRING;
       49     1177    2               SPACE_USED = CHAR_STRING_SIZE;
       50     1178    2             END;
       51     1179
       52     1180    2           DO I = 0 TO P_MSGBLK.CODECNT - 1;
       53     1181    2             IF P_MSGBLK.ERRINFO.ERR(I) = '0'B THEN
       54     1182    3               DO;
       55     1183    3                 GOTO LOOP;
       56     1184    3               END;
       57     1185
       58     1186    2             NEXT_OFFSET = (SPACE_USED + 79) / 80 * 80;
       59     1187    2             CHAR_STRING_SIZE = 960 - NEXT_OFFSET;
       60     1188    2             IF CHAR_STRING_SIZE < 0 THEN
       61     1189    3               DO;
       62     1190    3                 GOTO LOOP;
       63     1191    3               END;
       64     1192
       65     1193    2             SPACE_USED = NEXT_OFFSET;
       66     1194    2             P$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET);
       67     1195    2             FPT_ERRMSG.BUF_ = VECTOR(P$ -> CHAR$STRING);
       68     1196    2             FPT_ERRMSG.CODE_ = VECTOR(P_MSGBLK.ERRINFO.ERR(I));
       69     1197    2             FPT_ERRMSG.FIELD1_ = P_MSGBLK.ERRINFO.FIELD1(I);
       70     1198    2             FPT_ERRMSG.FIELD2_ = P_MSGBLK.ERRINFO.FIELD2(I);
       71     1199    2             FPT_ERRMSG.FIELD3_ = P_MSGBLK.ERRINFO.FIELD3(I);
       72     1200    2             FPT_ERRMSG.V.DCB# = P_MSGBLK.ERRINFO.DCB#(I);
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:6    
       73     1201    2             CALL M$ERRMSG(FPT_ERRMSG);
       74     1202    2             IF VLR_ERRMSG.NOMSG OR VLR_ERRMSG.NOFILE THEN
       75     1203    3               DO;
       76     1204        /* When a message is not found M$ERRMSG puts the error
       77     1205           code in the buffer.  So the least we can do is print
       78     1206           out the error code */
       79     1207    3                 VLR_ERRMSG.RECCNT = 1;
       80     1208    3               END;
       81     1209    2             ELSE
       82     1210    3               DO;
       83     1211    3                 P_MSGBLK.FLAGS.FOUND = '1'B;
       84     1212    3               END;
       85     1213
       86     1214    2             CHAR_STRING_SIZE = 80;
       87     1215    3             DO K = 1 TO VLR_ERRMSG.RECCNT;
       88     1216    3               TO$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET + 80 * K);
       89     1217    3               FROM$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET + 120 * K);
       90     1218    3               TO$ -> CHAR$STRING = FROM$ -> CHAR$STRING;
       91     1219    3             END;
       92     1220
       93     1221    2             SPACE_USED = SPACE_USED + 80 * VLR_ERRMSG.RECCNT;
       94     1222    2   LOOP:
       95     1223    2           END;
       96     1224
       97     1225    1           P_MSGBLK.ARS = SPACE_USED;
       98     1226    1           P_MSGBLK.TEXT$ = ADDR(ERRBUF);
       99     1227    1           CALL QQC$SNDMSG(P_MSGBLK);
      100     1228    1           RETURN;
      101     1229    1   END QQC$BLDMSG;

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:7    
--  Include file information  --

   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQC$BLDMSG.

   Procedure QQC$BLDMSG requires 143 words for executable code.
   Procedure QQC$BLDMSG requires 254 words of local(AUTO) storage.

    No errors detected in file QQC$BLDMSG.:E05TSI    .

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:8    

 Object Unit name= QQC$BLDMSG                                 File name= QQC$BLDMSG.:E05TOU
 UTS= JUL 30 '97 05:38:17.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DO
    2  RoData even  UTS      3      3  QQC$BLDMSG
    3   Data  even  none    30     36  QQC$BLDMSG
    4   Proc  even  none   143    217  QQC$BLDMSG
    5  RoData even  none     1      1  QQC$BLDMSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  QQC$BLDMSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 QQC$SNDMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:9    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:10   


        1        1        /*M* QQC$BLDMSG - Build a message */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQC$BLDMSG:
        9        9                PROC(P_MSGBLK);

      9  4 000000   000000 700200 xent  QQC$BLDMSG   TSX0  ! X66_AUTO_1
         4 000001   000376 000001                    ZERO    254,1

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QQ_MACROS_C;
       16      575        %INCLUDE QQ_SUBS_C;
       17      767        %PAGE(ARG="Parameters");

               784    1   /***************************************************************************
               785    1    *                                                                         *
               786    1    *                                 Parameters                              *
               787    1    *                                                                         *
               788    1    ***************************************************************************/

       18      792        %MSGBLK(FPTN=P_MSGBLK);
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:11   
       19      882        %PAGE(ARG="Externally defined routines");

               899    1   /***************************************************************************
               900    1    *                                                                         *
               901    1    *                        Externally defined routines                      *
               902    1    *                                                                         *
               903    1    ***************************************************************************/

       20      907    1   DCL QQC$SNDMSG ENTRY(1);
       21      908        %PAGE(ARG="DCBs");

               925    1   /***************************************************************************
               926    1    *                                                                         *
               927    1    *                                    DCBs                                 *
               928    1    *                                                                         *
               929    1    ***************************************************************************/

       22      933    1   DCL M$DO DCB;
       23      934        %PAGE(ARG="Based");

               951    1   /***************************************************************************
               952    1    *                                                                         *
               953    1    *                                   Based                                 *
               954    1    *                                                                         *
               955    1    ***************************************************************************/

       24      959    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       25      960        %PAGE(ARG="Constants");

               977    1   /***************************************************************************
               978    1    *                                                                         *
               979    1    *                                 Constants                               *
               980    1    *                                                                         *
               981    1    ***************************************************************************/

       26      985        %VLP_NAME(FPTN=QQERRMSG, STCLASS=CONSTANT, NAME=':QQERRMSG');
       27     1012        %PAGE(ARG="Auto");
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:12   

              1029    1   /***************************************************************************
              1030    1    *                                                                         *
              1031    1    *                                    Auto                                 *
              1032    1    *                                                                         *
              1033    1    ***************************************************************************/

       28     1037    1   DCL P$ PTR;
       29     1038    1   DCL TO$ PTR;
       30     1039    1   DCL FROM$ PTR;
       31     1040    1   DCL K UBIN WORD;
       32     1041    1   DCL I UBIN WORD;
       33     1042    1   DCL NEXT_OFFSET UBIN WORD;
       34     1043    1   DCL SPACE_USED UBIN WORD;
       35     1044    1   DCL CHAR_STRING_SIZE SBIN WORD;
       36     1045    1   DCL ERRBUF CHAR(960);
       37     1046        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:13   
              1063    1   /***************************************************************************
              1064    1    *                                                                         *
              1065    1    *                                    FPTs                                 *
              1066    1    *                                                                         *
              1067    1    ***************************************************************************/

       38     1071        %FPT_ERRMSG(FILENAME=QQERRMSG, INCLCODE=NO, RESULTS=VLR_ERRMSG);
       39     1098        %PAGE(ARG="VLRs");

              1115    1   /***************************************************************************
              1116    1    *                                                                         *
              1117    1    *                                    VLRs                                 *
              1118    1    *                                                                         *
              1119    1    ***************************************************************************/

       40     1123        %VLR_ERRMSG;
       41     1145        %PAGE(ARG="QQC$BLDMSG", PAGE=YES);

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:14   
              1162    1   /***************************************************************************
              1163    1    *                                                                         *
              1164    1    *                                 QQC$BLDMSG                              *
              1165    1    *                                                                         *
              1166    1    ***************************************************************************/

       42     1170    1           ERRBUF = ' ';

   1170  4 000002   040100 100400                    MLR     fill='040'O
         4 000003   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000004   200014 001700                    ADSC9   ERRBUF,,AUTO             cn=0,n=960

       43     1171    1           SPACE_USED = 0;

   1171  4 000005   200012 450100                    STZ     SPACE_USED,,AUTO

       44     1172
       45     1173    1           IF P_MSGBLK.TEXT$ ~= ADDR(NIL) THEN

   1173  4 000006   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         4 000007   000005 236100                    LDQ     5,,PR0
         4 000010   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000011   000025 600000 4                  TZE     s:1180

       46     1174    2             DO;

       47     1175    2               CHAR_STRING_SIZE = P_MSGBLK.ARS;

   1175  4 000012   000003 236100                    LDQ     3,,PR0
         4 000013   000022 772000                    QRL     18
         4 000014   200013 756100                    STQ     CHAR_STRING_SIZE,,AUTO

       48     1176    2               ADDR(ERRBUF) -> CHAR$STRING = P_MSGBLK.TEXT$ -> CHAR$STRING;

   1176  4 000015   000005 471500                    LDP1    5,,PR0
         4 000016   000000 620006                    EAX0    0,QL
         4 000017   200013 721100                    LXL1    CHAR_STRING_SIZE,,AUTO
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:15   
         4 000020   040140 100540                    MLR     fill='040'O
         4 000021   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         4 000022   200014 000011                    ADSC9   ERRBUF,,AUTO             cn=0,n=*X1

       49     1177    2               SPACE_USED = CHAR_STRING_SIZE;

   1177  4 000023   200013 235100                    LDA     CHAR_STRING_SIZE,,AUTO
         4 000024   200012 755100                    STA     SPACE_USED,,AUTO

       50     1178    2             END;

       51     1179
       52     1180    2           DO I = 0 TO P_MSGBLK.CODECNT - 1;

   1180  4 000025   200010 450100                    STZ     I,,AUTO
         4 000026   000177 710000 4                  TRA     LOOP+3

       53     1181    2             IF P_MSGBLK.ERRINFO.ERR(I) = '0'B THEN

   1181  4 000027   200010 236100                    LDQ     I,,AUTO
         4 000030   000035 402007                    MPY     29,DL
         4 000031   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         4 000032   000000 106506                    CMPC    fill='000'O
         4 000033   000006 000004                    ADSC9   6,Q,PR0                  cn=0,n=4
         4 000034   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         4 000035   000037 601000 4                  TNZ     s:1186

       54     1182    3               DO;

       55     1183    3                 GOTO LOOP;

   1183  4 000036   000174 710000 4                  TRA     LOOP

       56     1184    3               END;
       57     1185
       58     1186    2             NEXT_OFFSET = (SPACE_USED + 79) / 80 * 80;

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:16   
   1186  4 000037   200012 236100                    LDQ     SPACE_USED,,AUTO
         4 000040   000117 036007                    ADLQ    79,DL
         4 000041   000001 772000                    QRL     1
         4 000042   000050 506007                    DIV     40,DL
         4 000043   000120 402007                    MPY     80,DL
         4 000044   200011 756100                    STQ     NEXT_OFFSET,,AUTO

       59     1187    2             CHAR_STRING_SIZE = 960 - NEXT_OFFSET;

   1187  4 000045   001700 235007                    LDA     960,DL
         4 000046   200011 135100                    SBLA    NEXT_OFFSET,,AUTO
         4 000047   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

       60     1188    2             IF CHAR_STRING_SIZE < 0 THEN

   1188  4 000050   000052 605000 4                  TPL     s:1193

       61     1189    3               DO;

       62     1190    3                 GOTO LOOP;

   1190  4 000051   000174 710000 4                  TRA     LOOP

       63     1191    3               END;
       64     1192
       65     1193    2             SPACE_USED = NEXT_OFFSET;

   1193  4 000052   200012 756100                    STQ     SPACE_USED,,AUTO

       66     1194    2             P$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET);

   1194  4 000053   200374 452500                    STP2    ERRBUF+240,,AUTO
         4 000054   000020 736000                    QLS     16
         4 000055   000014 036003                    ADLQ    12,DU
         4 000056   200374 036100                    ADLQ    ERRBUF+240,,AUTO
         4 000057   200004 756100                    STQ     P$,,AUTO

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:17   
       67     1195    2             FPT_ERRMSG.BUF_ = VECTOR(P$ -> CHAR$STRING);

   1195  4 000060   000020 735000                    ALS     16
         4 000061   000140 135007                    SBLA    96,DL
         4 000062   000004 757000 3                  STAQ    FPT_ERRMSG+4

       68     1196    2             FPT_ERRMSG.CODE_ = VECTOR(P_MSGBLK.ERRINFO.ERR(I));

   1196  4 000063   777640 235007                    LDA     -96,DL
         4 000064   200010 236100                    LDQ     I,,AUTO
         4 000065   200374 755100                    STA     ERRBUF+240,,AUTO
         4 000066   000000 402000 5                  MPY     0
         4 000067   000006 036003                    ADLQ    6,DU
         4 000070   200003 036100                    ADLQ    @P_MSGBLK,,AUTO
         4 000071   200374 235100                    LDA     ERRBUF+240,,AUTO
         4 000072   000002 757000 3                  STAQ    FPT_ERRMSG+2

       69     1197    2             FPT_ERRMSG.FIELD1_ = P_MSGBLK.ERRINFO.FIELD1(I);

   1197  4 000073   200010 236100                    LDQ     I,,AUTO
         4 000074   000035 402007                    MPY     29,DL
         4 000075   000000 100506                    MLR     fill='000'O
         4 000076   000007 200010                    ADSC9   7,Q,PR0                  cn=1,n=8
         4 000077   000014 000010 3                  ADSC9   FPT_ERRMSG+12            cn=0,n=8

       70     1198    2             FPT_ERRMSG.FIELD2_ = P_MSGBLK.ERRINFO.FIELD2(I);

   1198  4 000100   000000 100506                    MLR     fill='000'O
         4 000101   000011 200010                    ADSC9   9,Q,PR0                  cn=1,n=8
         4 000102   000016 000010 3                  ADSC9   FPT_ERRMSG+14            cn=0,n=8

       71     1199    2             FPT_ERRMSG.FIELD3_ = P_MSGBLK.ERRINFO.FIELD3(I);

   1199  4 000103   000000 100506                    MLR     fill='000'O
         4 000104   000013 200010                    ADSC9   11,Q,PR0                 cn=1,n=8
         4 000105   000020 000010 3                  ADSC9   FPT_ERRMSG+16            cn=0,n=8

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:18   
       72     1200    2             FPT_ERRMSG.V.DCB# = P_MSGBLK.ERRINFO.DCB#(I);

   1200  4 000106   000000 101506                    MRL     fill='000'O
         4 000107   000007 000001                    ADSC9   7,Q,PR0                  cn=0,n=1
         4 000110   000026 000002 3                  ADSC9   FPT_ERRMSG+22            cn=0,n=2

       73     1201    2             CALL M$ERRMSG(FPT_ERRMSG);

   1201  4 000111   000000 630400 3                  EPPR0   FPT_ERRMSG
         4 000112   020000 713400                    CLIMB   8192
         4 000113   405000 401760                    pmme    nvectors=11

       74     1202    2             IF VLR_ERRMSG.NOMSG OR VLR_ERRMSG.NOFILE THEN

   1202  4 000114   000032 236000 3                  LDQ     VLR_ERRMSG
         4 000115   100000 316003                    CANQ    32768,DU
         4 000116   000121 601000 4                  TNZ     s:1207
         4 000117   200000 316003                    CANQ    65536,DU
         4 000120   000124 600000 4                  TZE     s:1211

       75     1203    3               DO;

       76     1204        /* When a message is not found M$ERRMSG puts the error
       77     1205           code in the buffer.  So the least we can do is print
       78     1206           out the error code */
       79     1207    3                 VLR_ERRMSG.RECCNT = 1;

   1207  4 000121   000001 236007                    LDQ     1,DL
         4 000122   000032 552004 3                  STBQ    VLR_ERRMSG,'04'O

       80     1208    3               END;

   1208  4 000123   000127 710000 4                  TRA     s:1214

       81     1209    2             ELSE
       82     1210    3               DO;

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:19   
       83     1211    3                 P_MSGBLK.FLAGS.FOUND = '1'B;

   1211  4 000124   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         4 000125   400000 236007                    LDQ     -131072,DL
         4 000126   000002 256100                    ORSQ    2,,PR0

       84     1212    3               END;

       85     1213
       86     1214    2             CHAR_STRING_SIZE = 80;

   1214  4 000127   000120 235007                    LDA     80,DL
         4 000130   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

       87     1215    3             DO K = 1 TO VLR_ERRMSG.RECCNT;

   1215  4 000131   000001 236007                    LDQ     1,DL
         4 000132   200007 756100                    STQ     K,,AUTO
         4 000133   000165 710000 4                  TRA     s:1219+3

       88     1216    3               TO$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET + 80 * K);

   1216  4 000134   200007 236100                    LDQ     K,,AUTO
         4 000135   000120 402007                    MPY     80,DL
         4 000136   200011 036100                    ADLQ    NEXT_OFFSET,,AUTO
         4 000137   200374 452500                    STP2    ERRBUF+240,,AUTO
         4 000140   000020 736000                    QLS     16
         4 000141   000014 036003                    ADLQ    12,DU
         4 000142   200374 036100                    ADLQ    ERRBUF+240,,AUTO
         4 000143   200005 756100                    STQ     TO$,,AUTO

       89     1217    3               FROM$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET + 120 * K);

   1217  4 000144   200007 236100                    LDQ     K,,AUTO
         4 000145   000170 402007                    MPY     120,DL
         4 000146   200011 036100                    ADLQ    NEXT_OFFSET,,AUTO
         4 000147   200374 452500                    STP2    ERRBUF+240,,AUTO
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:20   
         4 000150   000020 736000                    QLS     16
         4 000151   000014 036003                    ADLQ    12,DU
         4 000152   200374 036100                    ADLQ    ERRBUF+240,,AUTO
         4 000153   200006 756100                    STQ     FROM$,,AUTO

       90     1218    3               TO$ -> CHAR$STRING = FROM$ -> CHAR$STRING;

   1218  4 000154   200006 470500                    LDP0    FROM$,,AUTO
         4 000155   200013 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         4 000156   200005 471500                    LDP1    TO$,,AUTO
         4 000157   040140 100540                    MLR     fill='040'O
         4 000160   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 000161   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

       91     1219    3             END;

   1219  4 000162   200007 235100                    LDA     K,,AUTO
         4 000163   000001 035007                    ADLA    1,DL
         4 000164   200007 755100                    STA     K,,AUTO
         4 000165   000032 236000 3                  LDQ     VLR_ERRMSG
         4 000166   000777 376007                    ANQ     511,DL
         4 000167   200007 116100                    CMPQ    K,,AUTO
         4 000170   000134 603000 4                  TRC     s:1216

       92     1220
       93     1221    2             SPACE_USED = SPACE_USED + 80 * VLR_ERRMSG.RECCNT;

   1221  4 000171   000120 402007                    MPY     80,DL
         4 000172   200012 036100                    ADLQ    SPACE_USED,,AUTO
         4 000173   200012 756100                    STQ     SPACE_USED,,AUTO

       94     1222    2   LOOP:
       95     1223    2           END;

   1223  4 000174   200010 235100       LOOP         LDA     I,,AUTO
         4 000175   000001 035007                    ADLA    1,DL
         4 000176   200010 755100                    STA     I,,AUTO
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:21   
         4 000177   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         4 000200   000003 236100                    LDQ     3,,PR0
         4 000201   000011 772000                    QRL     9
         4 000202   000777 376007                    ANQ     511,DL
         4 000203   200010 116100                    CMPQ    I,,AUTO
         4 000204   000206 600000 4                  TZE     s:1225
         4 000205   000027 603000 4                  TRC     s:1181

       96     1224
       97     1225    1           P_MSGBLK.ARS = SPACE_USED;

   1225  4 000206   200012 720100                    LXL0    SPACE_USED,,AUTO
         4 000207   000003 740100                    STX0    3,,PR0

       98     1226    1           P_MSGBLK.TEXT$ = ADDR(ERRBUF);

   1226  4 000210   200014 631500                    EPPR1   ERRBUF,,AUTO
         4 000211   000005 451500                    STP1    5,,PR0

       99     1227    1           CALL QQC$SNDMSG(P_MSGBLK);

   1227  4 000212   200003 630500                    EPPR0   @P_MSGBLK,,AUTO
         4 000213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000214   000000 701000 xent               TSX1    QQC$SNDMSG
         4 000215   000000 011000                    NOP     0

      100     1228    1           RETURN;

   1228  4 000216   000000 702200 xent               TSX2  ! X66_ARET
      101     1229    1   END QQC$BLDMSG;

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:22   
--  Include file information  --

   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQC$BLDMSG.
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:23   

 **** Variables and constants ****

  ****  Section 002 RoData QQC$BLDMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(90)    r     1 QQERRMSG

  ****  Section 003  Data  QQC$BLDMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(936)   r     1 FPT_ERRMSG                32-0-0/d STRC(144)   r     1 VLR_ERRMSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P_MSGBLK                 13-0-0/w SBIN        r     1 CHAR_STRING_SIZE
    14-0-0/c CHAR(960)   r     1 ERRBUF                     6-0-0/w PTR         r     1 FROM$
    10-0-0/w UBIN        r     1 I                          7-0-0/w UBIN        r     1 K
    11-0-0/w UBIN        r     1 NEXT_OFFSET                4-0-0/w PTR         r     1 P$
    *0-0-0/w STRC(738)   r     1 P_MSGBLK                  12-0-0/w UBIN        r     1 SPACE_USED
     5-0-0/w PTR         r     1 TO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 CHAR$STRING

PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:24   

   Procedure QQC$BLDMSG requires 143 words for executable code.
   Procedure QQC$BLDMSG requires 254 words of local(AUTO) storage.

    No errors detected in file QQC$BLDMSG.:E05TSI    .
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:25   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:26   
          MINI XREF LISTING

CHAR$STRING
       959**DCL      1176<<ASSIGN   1176>>ASSIGN   1195--ASSIGN   1218<<ASSIGN   1218>>ASSIGN
CHAR_STRING_SIZE
      1044**DCL       959--IMP-SIZ  1175<<ASSIGN   1176>>ASSIGN   1176>>ASSIGN   1177>>ASSIGN   1187<<ASSIGN
      1188>>IF       1195>>ASSIGN   1214<<ASSIGN   1218>>ASSIGN   1218>>ASSIGN
ERRBUF
      1045**DCL      1170<<ASSIGN   1176--ASSIGN   1194--ASSIGN   1216--ASSIGN   1217--ASSIGN   1226--ASSIGN
FPT_ERRMSG
      1082**DCL      1201<>CALL
FPT_ERRMSG.BUF_
      1082**DCL      1195<<ASSIGN
FPT_ERRMSG.CODE_
      1082**DCL      1196<<ASSIGN
FPT_ERRMSG.FIELD1_
      1084**DCL      1197<<ASSIGN
FPT_ERRMSG.FIELD2_
      1085**DCL      1198<<ASSIGN
FPT_ERRMSG.FIELD3_
      1085**DCL      1199<<ASSIGN
FPT_ERRMSG.V
      1086**DCL      1082--DCLINIT
FPT_ERRMSG.V.DCB#
      1086**DCL      1200<<ASSIGN
FROM$
      1039**DCL      1217<<ASSIGN   1218>>ASSIGN
I
      1041**DCL      1180<<DOINDEX  1181>>IF       1196>>ASSIGN   1197>>ASSIGN   1198>>ASSIGN   1199>>ASSIGN
      1200>>ASSIGN
K
      1040**DCL      1215<<DOINDEX  1216>>ASSIGN   1217>>ASSIGN
LOOP
      1223**LABEL    1183--GOTO     1190--GOTO
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:27   
M$ERRMSG
       141**DCL-ENT  1201--CALL
NEXT_OFFSET
      1042**DCL      1186<<ASSIGN   1187>>ASSIGN   1193>>ASSIGN   1194>>ASSIGN   1216>>ASSIGN   1217>>ASSIGN
P$
      1037**DCL      1194<<ASSIGN   1195>>ASSIGN
P_MSGBLK
       793**DCL         8--PROC     1227<>CALL
P_MSGBLK.ARS
       860**DCL      1175>>ASSIGN   1225<<ASSIGN
P_MSGBLK.CODECNT
       862**DCL      1180>>DOINDEX
P_MSGBLK.ERRINFO.DCB#
       873**DCL      1200>>ASSIGN
P_MSGBLK.ERRINFO.ERR
       871**DCL      1181>>IF       1196--ASSIGN
P_MSGBLK.ERRINFO.FIELD1
       875**DCL      1197>>ASSIGN
P_MSGBLK.ERRINFO.FIELD2
       877**DCL      1198>>ASSIGN
P_MSGBLK.ERRINFO.FIELD3
       879**DCL      1199>>ASSIGN
P_MSGBLK.FLAGS.FOUND
       849**DCL      1211<<ASSIGN
P_MSGBLK.TEXT$
       867**DCL      1173>>IF       1176>>ASSIGN   1226<<ASSIGN
QQC$SNDMSG
       907**DCL-ENT  1227--CALL
QQERRMSG
      1010**DCL      1083--DCLINIT
SPACE_USED
      1043**DCL      1171<<ASSIGN   1177<<ASSIGN   1186>>ASSIGN   1193<<ASSIGN   1221<<ASSIGN   1221>>ASSIGN
      1225>>ASSIGN
TO$
      1038**DCL      1216<<ASSIGN   1218>>ASSIGN
VLR_ERRMSG
PL6.E3A0      #001=QQC$BLDMSG File=QQC$BLDMSG.:E05TSI                            WED 07/30/97 05:38 Page:28   
      1134**DCL      1086--DCLINIT
VLR_ERRMSG.NOFILE
      1134**DCL      1202>>IF
VLR_ERRMSG.NOMSG
      1134**DCL      1202>>IF
VLR_ERRMSG.RECCNT
      1138**DCL      1207<<ASSIGN   1215>>DOINDEX  1221>>ASSIGN
