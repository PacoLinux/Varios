VERSION A06

PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6
        7        7        /*M*  Z8ET$PROCESS_TREE---Traverse the input LX tree */
        8        8
        9        9
       10       10        /*P*
       11       11               NAME:  Z8ET$PROCESS_TREE.
       12       12             AUTHOR:  Min Lee.
       13       13            PURPOSE:  Traverse the deferred ID tree to find the deferred ID
       14       14                      node and then process it.
       15       15        */
       16       16
       17       17        /*D*
       18       18               NAME:  Z8ET$PROCESS_TREE
       19       19
       20       20              INPUT:  Abstract Syntax Tree for the deferred identifier.
       21       21
       22       22             OUTPUT:  The ETT tree of the deferred identifier.
       23       23
       24       24        DESCRIPTION:  This routine call itself recursively to find the
       25       25                      %DEFERED_ID_TREE node then call Z8ET$PROCESS_DEFERED_ID
       26       26                      to create the ETT tree for that node.
       27       27                      The deferred ID tree were built up in Z8EM$SEMANTICS_DATA_DIV
       28       28                      and saved on O1COM.REPORT_SOURCE$ or O1COM.REPORT_SUM$
       29       29                      lists.  This routine is called by Z8ET$DEFERED_SUM_AND_SOURCE
       30       30                      only.
       31       31         */
       32       32         %EJECT;
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:2    
       33       33         Z8ET$PROCESS_TREE:  PROC (TREE$);
       34       34
       35       35
       36       36           %EQU  PHASE = 1;
       37       37           %INCLUDE Z8A_DEFC;
       38      105           %INCLUDE Z8A_SUPP_MAC;
       39     2505           %INCLUDE Z8E_STACKS;
       40     4771           %INCLUDE Z8A_ERR_NUMS;
       41     5535
       42     5536
       43     5537    1      DCL TREE$           PTR;
       44     5538    1      DCL TEMP$           PTR;
       45     5539    1      DCL Z8ED$DISPOSE_HEAP     ENTRY (2);
       46     5540    1      DCL Z8ET$PROCESS_DEFERED_ID  ENTRY (1);
       47     5541    1      DCL TAIL_IS_LARGE   BOOLEAN;
       48     5542    1      DCL Z8AE$ERROR      ENTRY (12);
       49     5543
       50     5544
       51     5545
       52     5546    1      IF TREE$ = ADDR(NIL) THEN
       53     5547    1        RETURN;
       54     5548
       55     5549    2      DO CASE (TREE$ -> LX_ITEM.ID);
       56     5550    2        CASE (%LX_TERMINAL);
       57     5551    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_TERMINAL.LINK);
       58     5552
       59     5553    2        CASE (%LX_LARGE);
       60     5554    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_LARGE.LARGE_ITEM$);
       61     5555    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_LARGE.LINK);
       62     5556    2            TEMP$ = TREE$;
       63     5557    2            TREE$ = TEMP$ -> LX_LARGE.LARGE_ITEM$;
       64     5558    2            TREE$ -> LX_ITEM.LINK = TEMP$ -> LX_LARGE.LINK;
       65     5559    2            CALL Z8ED$DISPOSE_HEAP (TEMP$, %LENGTH_LX_ITEM);
       66     5560
       67     5561    2        CASE (%LX_LIST);
       68     5562    2            IF TREE$ -> LX_LIST.TAIL$ -> LX_ITEM.ID = %LX_LARGE THEN
       69     5563    2              TAIL_IS_LARGE = TRUE;
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:3    
       70     5564    2            ELSE
       71     5565    2              TAIL_IS_LARGE = FALSE;
       72     5566
       73     5567    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_LIST.HEAD$);
       74     5568    2            IF TAIL_IS_LARGE THEN
       75     5569    2              TREE$ -> LX_LIST.TAIL$ = TREE$ -> LX_LIST.TAIL$ -> LX_LARGE.LARGE_ITEM$;
       76     5570    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_LIST.LINK);
       77     5571
       78     5572    2        CASE (%BINARY_OP);
       79     5573    2            CALL Z8ET$PROCESS_TREE (TREE$ -> BINARY_OP.LOP$);
       80     5574    2            CALL Z8ET$PROCESS_TREE (TREE$ -> BINARY_OP.ROP$);
       81     5575    2            CALL Z8ET$PROCESS_TREE (TREE$ -> BINARY_OP.LINK);
       82     5576
       83     5577    2        CASE (%UNARY_OP);
       84     5578    2            CALL Z8ET$PROCESS_TREE (TREE$ -> UNARY_OP.LOP$);
       85     5579    2            CALL Z8ET$PROCESS_TREE (TREE$ -> UNARY_OP.LINK);
       86     5580
       87     5581    2        CASE (%DEFERED_ID_TREE);
       88     5582    2            CALL Z8ET$PROCESS_TREE (TREE$ -> DEFERED_ID_TREE.SUB$);
       89     5583    2            CALL Z8ET$PROCESS_TREE (TREE$ -> DEFERED_ID_TREE.REF$);
       90     5584    2            CALL Z8ET$PROCESS_DEFERED_ID (TREE$);
       91     5585
       92     5586    2        CASE (ELSE);
       93     5587    2            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
       94     5588
       95     5589    2      END;  /* case */
       96     5590
       97     5591    1      RETURN;
       98     5592    1    END Z8ET$PROCESS_TREE;
       99     5593
      100     5594        %EOD;

PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:4    
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$PROCESS_TREE.

   Procedure Z8ET$PROCESS_TREE requires 172 words for executable code.
   Procedure Z8ET$PROCESS_TREE requires 8 words of local(AUTO) storage.

PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:5    

 Object Unit name= Z8ET$PROCESS_TREE                          File name= Z8ET.:Z8A6TOU
 UTS= AUG 09 '97 12:41:40.88 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5   Proc  even  none   172    254  Z8ET$PROCESS_TREE
    6  RoData even  none     7      7  Z8ET$PROCESS_TREE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        1  Z8ET$PROCESS_TREE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8ED$DISPOSE_HEAP
         yes           Std       1 Z8ET$PROCESS_DEFERED_ID
         yes           Std      12 Z8AE$ERROR
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:6    

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:7    


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6
        7        7        /*M*  Z8ET$PROCESS_TREE---Traverse the input LX tree */
        8        8
        9        9
       10       10        /*P*
       11       11               NAME:  Z8ET$PROCESS_TREE.
       12       12             AUTHOR:  Min Lee.
       13       13            PURPOSE:  Traverse the deferred ID tree to find the deferred ID
       14       14                      node and then process it.
       15       15        */
       16       16
       17       17        /*D*
       18       18               NAME:  Z8ET$PROCESS_TREE
       19       19
       20       20              INPUT:  Abstract Syntax Tree for the deferred identifier.
       21       21
       22       22             OUTPUT:  The ETT tree of the deferred identifier.
       23       23
       24       24        DESCRIPTION:  This routine call itself recursively to find the
       25       25                      %DEFERED_ID_TREE node then call Z8ET$PROCESS_DEFERED_ID
       26       26                      to create the ETT tree for that node.
       27       27                      The deferred ID tree were built up in Z8EM$SEMANTICS_DATA_DIV
       28       28                      and saved on O1COM.REPORT_SOURCE$ or O1COM.REPORT_SUM$
       29       29                      lists.  This routine is called by Z8ET$DEFERED_SUM_AND_SOURCE
       30       30                      only.
       31       31         */
       32       32         %EJECT;
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:8    
       33       33         Z8ET$PROCESS_TREE:  PROC (TREE$);

     33  5 000000   000000 700200 xent  Z8ET$PROCES* TSX0  ! X66_AUTO_1
         5 000001   000010 000001                    ZERO    8,1

       34       34
       35       35
       36       36           %EQU  PHASE = 1;
       37       37           %INCLUDE Z8A_DEFC;
       38      105           %INCLUDE Z8A_SUPP_MAC;
       39     2505           %INCLUDE Z8E_STACKS;
       40     4771           %INCLUDE Z8A_ERR_NUMS;
       41     5535
       42     5536
       43     5537    1      DCL TREE$           PTR;
       44     5538    1      DCL TEMP$           PTR;
       45     5539    1      DCL Z8ED$DISPOSE_HEAP     ENTRY (2);
       46     5540    1      DCL Z8ET$PROCESS_DEFERED_ID  ENTRY (1);
       47     5541    1      DCL TAIL_IS_LARGE   BOOLEAN;
       48     5542    1      DCL Z8AE$ERROR      ENTRY (12);
       49     5543
       50     5544
       51     5545
       52     5546    1      IF TREE$ = ADDR(NIL) THEN

   5546  5 000002   200003 470500                    LDP0    @TREE$,,AUTO
         5 000003   000000 236100                    LDQ     0,,PR0
         5 000004   000000 116000 6                  CMPQ    0
         5 000005   000007 601000 5                  TNZ     s:5549

       53     5547    1        RETURN;

   5547  5 000006   000000 702200 xent               TSX2  ! X66_ARET

       54     5548
       55     5549    2      DO CASE (TREE$ -> LX_ITEM.ID);

PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:9    
   5549  5 000007   000000 471500                    LDP1    0,,PR0
         5 000010   100000 220100                    LDX0    0,,PR1
         5 000011   000034 100003                    CMPX0   28,DU
         5 000012   000014 602010 5                  TNC     s:5549+5,X0
         5 000013   000247 710000 5                  TRA     s:5587
         5 000014   000050 710000 5                  TRA     s:5551
         5 000015   000057 710000 5                  TRA     s:5554
         5 000016   000120 710000 5                  TRA     s:5562
         5 000017   000247 710000 5                  TRA     s:5587
         5 000020   000247 710000 5                  TRA     s:5587
         5 000021   000156 710000 5                  TRA     s:5573
         5 000022   000205 710000 5                  TRA     s:5578
         5 000023   000247 710000 5                  TRA     s:5587
         5 000024   000247 710000 5                  TRA     s:5587
         5 000025   000247 710000 5                  TRA     s:5587
         5 000026   000247 710000 5                  TRA     s:5587
         5 000027   000247 710000 5                  TRA     s:5587
         5 000030   000247 710000 5                  TRA     s:5587
         5 000031   000247 710000 5                  TRA     s:5587
         5 000032   000247 710000 5                  TRA     s:5587
         5 000033   000247 710000 5                  TRA     s:5587
         5 000034   000247 710000 5                  TRA     s:5587
         5 000035   000247 710000 5                  TRA     s:5587
         5 000036   000247 710000 5                  TRA     s:5587
         5 000037   000247 710000 5                  TRA     s:5587
         5 000040   000247 710000 5                  TRA     s:5587
         5 000041   000247 710000 5                  TRA     s:5587
         5 000042   000247 710000 5                  TRA     s:5587
         5 000043   000247 710000 5                  TRA     s:5587
         5 000044   000247 710000 5                  TRA     s:5587
         5 000045   000247 710000 5                  TRA     s:5587
         5 000046   000247 710000 5                  TRA     s:5587
         5 000047   000224 710000 5                  TRA     s:5582

       56     5550    2        CASE (%LX_TERMINAL);

       57     5551    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_TERMINAL.LINK);
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:10   

   5551  5 000050   100007 633500                    EPPR3   7,,PR1
         5 000051   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000052   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000053   000001 631400 6                  EPPR1   1
         5 000054   000000 701000 5                  TSX1    s:33
         5 000055   000000 011000                    NOP     0
         5 000056   000253 710000 5                  TRA     s:5591

       58     5552
       59     5553    2        CASE (%LX_LARGE);

       60     5554    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_LARGE.LARGE_ITEM$);

   5554  5 000057   100001 633500                    EPPR3   1,,PR1
         5 000060   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000061   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000062   000001 631400 6                  EPPR1   1
         5 000063   000000 701000 5                  TSX1    s:33
         5 000064   000000 011000                    NOP     0

       61     5555    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_LARGE.LINK);

   5555  5 000065   200003 470500                    LDP0    @TREE$,,AUTO
         5 000066   000000 471500                    LDP1    0,,PR0
         5 000067   100007 633500                    EPPR3   7,,PR1
         5 000070   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000071   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000072   000001 631400 6                  EPPR1   1
         5 000073   000000 701000 5                  TSX1    s:33
         5 000074   000000 011000                    NOP     0

       62     5556    2            TEMP$ = TREE$;

   5556  5 000075   200003 470500                    LDP0    @TREE$,,AUTO
         5 000076   000000 236100                    LDQ     0,,PR0
         5 000077   200004 756100                    STQ     TEMP$,,AUTO
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:11   

       63     5557    2            TREE$ = TEMP$ -> LX_LARGE.LARGE_ITEM$;

   5557  5 000100   200004 471500                    LDP1    TEMP$,,AUTO
         5 000101   100001 236100                    LDQ     1,,PR1
         5 000102   000000 756100                    STQ     0,,PR0

       64     5558    2            TREE$ -> LX_ITEM.LINK = TEMP$ -> LX_LARGE.LINK;

   5558  5 000103   000000 471500                    LDP1    0,,PR0
         5 000104   200004 473500                    LDP3    TEMP$,,AUTO
         5 000105   300007 236100                    LDQ     7,,PR3
         5 000106   100007 756100                    STQ     7,,PR1

       65     5559    2            CALL Z8ED$DISPOSE_HEAP (TEMP$, %LENGTH_LX_ITEM);

   5559  5 000107   000004 236000 6                  LDQ     4
         5 000110   200007 756100                    STQ     TAIL_IS_LARGE+2,,AUTO
         5 000111   200004 631500                    EPPR1   TEMP$,,AUTO
         5 000112   200006 451500                    STP1    TAIL_IS_LARGE+1,,AUTO
         5 000113   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000114   000002 631400 6                  EPPR1   2
         5 000115   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
         5 000116   000000 011000                    NOP     0
         5 000117   000253 710000 5                  TRA     s:5591

       66     5560
       67     5561    2        CASE (%LX_LIST);

       68     5562    2            IF TREE$ -> LX_LIST.TAIL$ -> LX_ITEM.ID = %LX_LARGE THEN

   5562  5 000120   100001 473500                    LDP3    1,,PR1
         5 000121   300000 221100                    LDX1    0,,PR3
         5 000122   000001 101003                    CMPX1   1,DU
         5 000123   000127 601000 5                  TNZ     s:5565

       69     5563    2              TAIL_IS_LARGE = TRUE;
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:12   

   5563  5 000124   400000 236003                    LDQ     -131072,DU
         5 000125   200005 756100                    STQ     TAIL_IS_LARGE,,AUTO
         5 000126   000130 710000 5                  TRA     s:5567

       70     5564    2            ELSE
       71     5565    2              TAIL_IS_LARGE = FALSE;

   5565  5 000127   200005 450100                    STZ     TAIL_IS_LARGE,,AUTO

       72     5566
       73     5567    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_LIST.HEAD$);

   5567  5 000130   100004 634500                    EPPR4   4,,PR1
         5 000131   200006 454500                    STP4    TAIL_IS_LARGE+1,,AUTO
         5 000132   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000133   000001 631400 6                  EPPR1   1
         5 000134   000000 701000 5                  TSX1    s:33
         5 000135   000000 011000                    NOP     0

       74     5568    2            IF TAIL_IS_LARGE THEN

   5568  5 000136   200005 234100                    SZN     TAIL_IS_LARGE,,AUTO
         5 000137   000145 605000 5                  TPL     s:5570

       75     5569    2              TREE$ -> LX_LIST.TAIL$ = TREE$ -> LX_LIST.TAIL$ -> LX_LARGE.LARGE_ITEM$;

   5569  5 000140   200003 470500                    LDP0    @TREE$,,AUTO
         5 000141   000000 471500                    LDP1    0,,PR0
         5 000142   100001 473500                    LDP3    1,,PR1
         5 000143   300001 236100                    LDQ     1,,PR3
         5 000144   100001 756100                    STQ     1,,PR1

       76     5570    2            CALL Z8ET$PROCESS_TREE (TREE$ -> LX_LIST.LINK);

   5570  5 000145   200003 470500                    LDP0    @TREE$,,AUTO
         5 000146   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:13   
         5 000147   100007 633500                    EPPR3   7,,PR1
         5 000150   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000151   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000152   000001 631400 6                  EPPR1   1
         5 000153   000000 701000 5                  TSX1    s:33
         5 000154   000000 011000                    NOP     0
         5 000155   000253 710000 5                  TRA     s:5591

       77     5571
       78     5572    2        CASE (%BINARY_OP);

       79     5573    2            CALL Z8ET$PROCESS_TREE (TREE$ -> BINARY_OP.LOP$);

   5573  5 000156   100001 633500                    EPPR3   1,,PR1
         5 000157   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000160   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000161   000001 631400 6                  EPPR1   1
         5 000162   000000 701000 5                  TSX1    s:33
         5 000163   000000 011000                    NOP     0

       80     5574    2            CALL Z8ET$PROCESS_TREE (TREE$ -> BINARY_OP.ROP$);

   5574  5 000164   200003 470500                    LDP0    @TREE$,,AUTO
         5 000165   000000 471500                    LDP1    0,,PR0
         5 000166   100002 633500                    EPPR3   2,,PR1
         5 000167   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000170   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000171   000001 631400 6                  EPPR1   1
         5 000172   000000 701000 5                  TSX1    s:33
         5 000173   000000 011000                    NOP     0

       81     5575    2            CALL Z8ET$PROCESS_TREE (TREE$ -> BINARY_OP.LINK);

   5575  5 000174   200003 470500                    LDP0    @TREE$,,AUTO
         5 000175   000000 471500                    LDP1    0,,PR0
         5 000176   100007 633500                    EPPR3   7,,PR1
         5 000177   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:14   
         5 000200   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000201   000001 631400 6                  EPPR1   1
         5 000202   000000 701000 5                  TSX1    s:33
         5 000203   000000 011000                    NOP     0
         5 000204   000253 710000 5                  TRA     s:5591

       82     5576
       83     5577    2        CASE (%UNARY_OP);

       84     5578    2            CALL Z8ET$PROCESS_TREE (TREE$ -> UNARY_OP.LOP$);

   5578  5 000205   100001 633500                    EPPR3   1,,PR1
         5 000206   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000207   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000210   000001 631400 6                  EPPR1   1
         5 000211   000000 701000 5                  TSX1    s:33
         5 000212   000000 011000                    NOP     0

       85     5579    2            CALL Z8ET$PROCESS_TREE (TREE$ -> UNARY_OP.LINK);

   5579  5 000213   200003 470500                    LDP0    @TREE$,,AUTO
         5 000214   000000 471500                    LDP1    0,,PR0
         5 000215   100007 633500                    EPPR3   7,,PR1
         5 000216   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000217   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000220   000001 631400 6                  EPPR1   1
         5 000221   000000 701000 5                  TSX1    s:33
         5 000222   000000 011000                    NOP     0
         5 000223   000253 710000 5                  TRA     s:5591

       86     5580
       87     5581    2        CASE (%DEFERED_ID_TREE);

       88     5582    2            CALL Z8ET$PROCESS_TREE (TREE$ -> DEFERED_ID_TREE.SUB$);

   5582  5 000224   100002 633500                    EPPR3   2,,PR1
         5 000225   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:15   
         5 000226   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000227   000001 631400 6                  EPPR1   1
         5 000230   000000 701000 5                  TSX1    s:33
         5 000231   000000 011000                    NOP     0

       89     5583    2            CALL Z8ET$PROCESS_TREE (TREE$ -> DEFERED_ID_TREE.REF$);

   5583  5 000232   200003 470500                    LDP0    @TREE$,,AUTO
         5 000233   000000 471500                    LDP1    0,,PR0
         5 000234   100003 633500                    EPPR3   3,,PR1
         5 000235   200006 453500                    STP3    TAIL_IS_LARGE+1,,AUTO
         5 000236   200006 630500                    EPPR0   TAIL_IS_LARGE+1,,AUTO
         5 000237   000001 631400 6                  EPPR1   1
         5 000240   000000 701000 5                  TSX1    s:33
         5 000241   000000 011000                    NOP     0

       90     5584    2            CALL Z8ET$PROCESS_DEFERED_ID (TREE$);

   5584  5 000242   200003 630500                    EPPR0   @TREE$,,AUTO
         5 000243   000001 631400 6                  EPPR1   1
         5 000244   000000 701000 xent               TSX1    Z8ET$PROCESS_DEFERED_ID
         5 000245   000000 011000                    NOP     0
         5 000246   000253 710000 5                  TRA     s:5591

       91     5585
       92     5586    2        CASE (ELSE);

       93     5587    2            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

   5587  5 000247   000006 630400 6                  EPPR0   6
         5 000250   000001 631400 6                  EPPR1   1
         5 000251   000000 701000 xent               TSX1    Z8AE$ERROR
         5 000252   000000 011000                    NOP     0

       94     5588
       95     5589    2      END;  /* case */

PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:16   
       96     5590
       97     5591    1      RETURN;

   5591  5 000253   000000 702200 xent               TSX2  ! X66_ARET
       98     5592    1    END Z8ET$PROCESS_TREE;
       99     5593
      100     5594        %EOD;

PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:17   
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$PROCESS_TREE.
PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:18   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:19   
  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TREE$                     5-0-0/b BIT         r     1 TAIL_IS_LARGE
     4-0-0/w PTR         r     1 TEMP$                     *0-0-0/w PTR         r     1 TREE$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)   r     1 BINARY_OP                  0-0-0/w STRC(288)         1 CALL_STMT
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)   r     1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)   r     1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(288)   r     1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(288)         1 WRITE_STMT

PL6.E3A0      #001=Z8ET$PROCESS_TREE File=Z8ET.:Z8A6TSI                          SAT 08/09/97 12:41 Page:20   

   Procedure Z8ET$PROCESS_TREE requires 172 words for executable code.
   Procedure Z8ET$PROCESS_TREE requires 8 words of local(AUTO) storage.

PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:21   
      101        1        /*T***********************************************************/
      102        2        /*T*                                                         */
      103        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      104        4        /*T*                                                         */
      105        5        /*T***********************************************************/
      106        6
      107        7        /*M*  Z8ET$PROCESS_DEFERED_ID---Create ETT tree for the identifier*/
      108        8
      109        9
      110       10        /*P*
      111       11               NAME:  Z8ET$PROCESS_DEFERED_ID
      112       12             AUTHOR:  Min Lee.
      113       13            PURPOSE:  Creates the ETT tree for the identifier syntax tree.
      114       14
      115       15        */
      116       16
      117       17        /*D*
      118       18               NAME:  Z8ET$PROCESS_DEFERED_ID
      119       19               CALL:  CALL Z8ET$PROCESS_DEFERED_ID (DEFERED_ID).
      120       20              INPUT:  Abstract Syntax Tree for the deferred identifier.
      121       21
      122       22             OUTPUT:  The ETT tree of the deferred identifier.
      123       23
      124       24        DESCRIPTION:  The action no# for that defered id tree is checked and
      125       25                      an identifier item is created with the correct triads
      126       26                      above it. Z8EY$SUBSCRIPT will be called to process the
      127       27                      subscripts and the Z8EY$SUBSTR will be called to process
      128       28                      the reference modifications.
      129       29                      This routine is called by Z8ET$PROCESS_TREE only.
      130       30         */
      131       31         %EJECT;
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:22   
      132       32          Z8ET$PROCESS_DEFERED_ID:  PROC (DEFERED_ID$);
      133       33
      134       34
      135       35            %EQU PHASE =1;
      136       36            %INCLUDE Z8A_DEFC;
      137      104            %INCLUDE Z8A_SUPP_MAC;
      138     2504            %INCLUDE Z8A_COMCOM;
      139     3154            %INCLUDE Z8E_STACKS;
      140     5420            %INCLUDE Z8E_O1COM;
      141     6181            %INCLUDE Z8A_ERR_NUMS;
      142     6945            %INCLUDE Z8A_DNT;
      143     7166            %INCLUDE Z8A_LTS;
      144     9243            %INCLUDE Z8A_ST;
      145    12902            %INCLUDE Z8A_ETT;
      146    13203            %INCLUDE Z8A_XREF;
      147    13275            %INCLUDE Z8E_ABSSYN;
      148    13481            %INCLUDE Z8E_HEAP;
      149    13537            %INCLUDE Z8E_MACROS;
      150    14212            %INCLUDE Z8A_TYPES;
      151    14386
      152    14387
      153    14388
      154    14389    1       DCL DEFERED_ID$        PTR;
      155    14390    1       DCL ID$$               PTR;
      156    14391    1       DCL Z8AE$ERROR         ENTRY (12);
      157    14392    1       DCL Z8ED$DISPOSE_ABSSYN_TREE  ENTRY (1);
      158    14393    1       DCL Z8EY$SUBSCRIPT     ENTRY (2);
      159    14394    1       DCL Z8EY$SUBSTR        ENTRY (4);
      160    14395    1       DCL Z8AF$NEW_BASE      ENTRY (3);
      161    14396    1       DCL Z8CO$QUALIFY_VARIABLE   ENTRY (2) ALTRET;
      162    14397    1       DCL Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2);
      163    14398         %EJECT;
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:23   
      164    14399        /*-----------------*/
      165    14400    1     CREATE_IDENTIFIER: PROC (QUAL_ID$, IDENT$) ;
      166    14401        /*-----------------*/
      167    14402
      168    14403        /*I*
      169    14404               NAME:  CREATE_IDENTIFIER
      170    14405               CALL:  CALL CREATE_IDENTIFIER(QUAL_ID$, IDENT$) ;
      171    14406
      172    14407              INPUT:  QUAL_ID$ - Pointer to the the head entry of the qualified identifier.
      173    14408             OUTPUT:  An Identifier item is created with the correct triads above it.
      174    14409                      These include BASE's (required by all identifiers), SSOP's and
      175    14410                      OFF's (for arrays), and SIZ's and FISS's (reference modification
      176    14411                      and data item's greater than 256k).
      177    14412
      178    14413        */
      179    14414
      180    14415    2   DCL  QUAL_ID$  PTR ;
      181    14416    2   DCL IDENT$ PTR;
      182    14417
      183    14418    2   DCL  QUALIFIED_ITEM$   PTR ;
             14418            /* Ptr to item containing information on qualified id */
      184    14419    2   DCL ST$ PTR;
      185    14420    2   DCL QUAL_ERROR BOOLEAN;
      186    14421    2   DCL LIDENT$ PTR;
      187    14422
      188    14423
      189    14424    2          QUAL_ERROR = FALSE;
      190    14425
      191    14426    2          IF QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.DNT$ -> DNT.B.REP_COUNTER THEN
      192    14427    3            DO;
      193    14428
      194    14429    3              QUAL_ERROR = TRUE;
      195    14430
      196    14431    3              IF QUAL_ID$ -> LX_LIST.COUNT = 1 THEN
      197    14432    4                DO;
      198    14433    4                  IF QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.DNT$ ->
      199    14434    4                                 DNT.TEXT.NAME = 'LINE-COUNTER' THEN
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:24   
      200    14435    4                    ST$ = O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.LINE_COUNTER$;
      201    14436    4                  ELSE
      202    14437    4                    ST$ = O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.PAGE_COUNTER$;
      203    14438
      204    14439    4                  GOTO NEXT_STEP;
      205    14440    4                END;
      206    14441    3            END;
      207    14442
      208    14443
      209    14444    2          CALL Z8CO$QUALIFY_VARIABLE(QUAL_ID$, ST$)
      210    14445    2              WHENALTRETURN
      211    14446    3                DO;
      212    14447    3                  QUAL_ERROR = TRUE;
      213    14448    3                END;
      214    14449
      215    14450    2        NEXT_STEP:
      216    14451
      217    14452               %ADD_XREF (SYM = ST$,
      218    14453                          ISN = "QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.LINE",
      219    14454                          TYPE = %XREF_UNK);
      220    14472
      221    14473    2         LIDENT$ = IDENT$;
      222    14474
      223    14475               %INIT_LX_ETT_ITEM (@POINTER = LIDENT$,
      224    14476                                  @TYPE = %TYG,
      225    14477                                  @LINE = "QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.LINE",
      226    14478                                  @COLUMN =
             14478                                      "QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.COLUMN");
      227    14500    2          LIDENT$ -> LX_ETT_ITEM.B.ERROR = QUAL_ERROR;
      228    14501
      229    14502    3          DO SELECT(ST$ -> ST.ID);
      230    14503
      231    14504    3            SELECT(%SCALAR, %ARRAY);
      232    14505
      233    14506                   /* The type is valid */
      234    14507    3              LIDENT$ -> LX_ETT_ITEM.TYPE = ST$ -> SCALAR.TYPE;
      235    14508
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:25   
      236    14509    3            SELECT(ELSE);
      237    14510
      238    14511    3              CALL Z8AE$ERROR (%E$ERROR_DATA_NAME,
      239    14512    3                        QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.LINE,
      240    14513    3                        QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.COLUMN);
      241    14514
      242    14515                   %FISH (TRIAD = COMCOM.VALUE_0,
      243    14516                          RTN = ST$);
      244    14524
      245    14525
      246    14526    3          END;
      247    14527
      248    14528    2          CALL Z8AF$NEW_BASE ( ST$,
      249    14529    2                               ADDR(NIL),
      250    14530    2                               LIDENT$ -> LX_ETT_ITEM.ETT$);
      251    14531
      252    14532    2   END CREATE_IDENTIFIER ;
      253    14533        %EJECT;
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:26   
      254    14534        /*-------------------*/
      255    14535    1     VERIFY_NOT_AN_ARRAY : PROC (IDENT$);
      256    14536        /*-------------------*/
      257    14537
      258    14538        /*I*
      259    14539                 NAME: VERIFY_NOT_AN_ARRAY
      260    14540
      261    14541          DESCRIPTION: Checks to make sure that the identifier is not an array.
      262    14542                       If it is an array, an error message is printed saying that
      263    14543                       a subscript is expected.
      264    14544        */
      265    14545
      266    14546    2     DCL DIMS$ PTR;
      267    14547
      268    14548    2     DCL IDENT$ PTR;
      269    14549
      270    14550    2     DCL IDENT_ST$ PTR;
      271    14551
      272    14552        %FISH (TRIAD = IDENT$ -> LX_ETT_ITEM.ETT$,
      273    14553               RTN   = IDENT_ST$);
      274    14561
      275    14562    2   IF IDENT_ST$ -> ST.ID = %ARRAY THEN
      276    14563    3     DO;
      277    14564            %GET_LTS (@ID = %DIMS, @ST$ = IDENT_ST$, @RETURN$ = DIMS$);
      278    14607    3       IF DIMS$ -> DIMS.N = 8 /* One dimension */
      279    14608    4       AND DIMS$ -> DIMS.D.DIM (1) = 1 THEN DO;
      280    14609    4         IF COMCOM.OB.FIPS.LEVEL > 0 THEN
      281    14610                %CONDITIONAL_ERROR (@LX_ITEM$ = IDENT$,
      282    14611                                    @ERROR# = %E$SUBSCRIPT_EXPECTED_ANSI,
      283    14612                                    @LINE = IDENT$ -> LX_ETT_ITEM.LINE,
      284    14613                                    @COLUMN = IDENT$ -> LX_ETT_ITEM.COLUMN);
      285    14643    4       END;
      286    14644    3       ELSE
      287    14645              %CONDITIONAL_ERROR (@LX_ITEM$ = IDENT$,
      288    14646                                  @ERROR# = %E$SUBSCRIPT_EXPECTED,
      289    14647                                  @LINE = IDENT$ -> LX_ETT_ITEM.LINE,
      290    14648                                  @COLUMN = IDENT$ -> LX_ETT_ITEM.COLUMN);
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:27   
      291    14678    3     END;
      292    14679
      293    14680    2   END VERIFY_NOT_AN_ARRAY;
      294    14681        %EJECT ;
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:28   
      295    14682
      296    14683         /*     Main  Program     */
      297    14684
      298    14685    1      ID$$ = DEFERED_ID$;
      299    14686
      300    14687    2      DO CASE (ID$$ -> DEFERED_ID_TREE.ACTION_NO#);
      301    14688    2        CASE (%REP_ACT_ID);
      302    14689
      303    14690    2          CALL CREATE_IDENTIFIER (ID$$ -> DEFERED_ID_TREE.QUAL_ID$,
      304    14691    2                                  ADDR(TEMP_LX_NODE));
      305    14692    2          CALL VERIFY_NOT_AN_ARRAY (ADDR(TEMP_LX_NODE));
      306    14693    2          CALL Z8ED$DISPOSE_ABSSYN_TREE(DEFERED_ID$);
      307    14694               %NEW_COPY_LX_ITEM (@FROM$   = "ADDR(TEMP_LX_NODE)",
      308    14695                                  @TO$     = DEFERED_ID$);
      309    14707
      310    14708    2        CASE (%REP_ACT_ID_REF);
      311    14709
      312    14710    2          CALL CREATE_IDENTIFIER (ID$$ -> DEFERED_ID_TREE.QUAL_ID$,
      313    14711    2                                  ADDR(TEMP_LX_NODE));
      314    14712    2          CALL Z8EY$SUBSTR( ADDR( TEMP_LX_NODE ),
      315    14713    2                            ID$$ -> DEFERED_ID_TREE.REF$ -> LX_LIST.HEAD$,
      316    14714    2                            ID$$ -> DEFERED_ID_TREE.REF$ -> LX_LIST.HEAD$ -> LX_ITEM.
             14714                                     LINK,
      317    14715    2                            ADDR( TEMP_LX_NODE ));
      318    14716    2          CALL VERIFY_NOT_AN_ARRAY (ADDR(TEMP_LX_NODE));
      319    14717    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (DEFERED_ID$);
      320    14718               %NEW_COPY_LX_ITEM (@FROM$  = "ADDR(TEMP_LX_NODE)",
      321    14719                                  @TO$    = DEFERED_ID$);
      322    14731
      323    14732    2        CASE (%REP_ACT_ID_SUB);
      324    14733
      325    14734    2          CALL CREATE_IDENTIFIER (ID$$ -> DEFERED_ID_TREE.QUAL_ID$,
      326    14735    2                                  ADDR(TEMP_LX_NODE));
      327    14736    2          CALL Z8EY$SUBSCRIPT (ID$$ -> DEFERED_ID_TREE.SUB$,
      328    14737    2                               ADDR(TEMP_LX_NODE));
      329    14738    2          CALL Z8ED$DISPOSE_ABSSYN_TREE(DEFERED_ID$);
      330    14739               %NEW_COPY_LX_ITEM (@FROM$   = "ADDR(TEMP_LX_NODE)",
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:29   
      331    14740                                  @TO$     = DEFERED_ID$);
      332    14752
      333    14753    2        CASE (%REP_ACT_ID_SUB_REF);
      334    14754
      335    14755    2          CALL CREATE_IDENTIFIER (ID$$ -> DEFERED_ID_TREE.QUAL_ID$,
      336    14756    2                                  ADDR(TEMP_LX_NODE));
      337    14757    2          CALL Z8EY$SUBSCRIPT (ID$$ -> DEFERED_ID_TREE.SUB$,
      338    14758    2                               ADDR(TEMP_LX_NODE));
      339    14759    2          CALL Z8EY$SUBSTR (ADDR(TEMP_LX_NODE),
      340    14760    2                            ID$$ -> DEFERED_ID_TREE.REF$ -> LX_LIST.HEAD$,
      341    14761    2                            ID$$ -> DEFERED_ID_TREE.REF$ -> LX_LIST.HEAD$ -> LX_ITEM.
             14761                                     LINK,
      342    14762    2                            ADDR(TEMP_LX_NODE));
      343    14763    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (DEFERED_ID$);
      344    14764               %NEW_COPY_LX_ITEM (@FROM$  = "ADDR(TEMP_LX_NODE)",
      345    14765                                  @TO$    = DEFERED_ID$);
      346    14777
      347    14778    2        CASE (ELSE);
      348    14779
      349    14780    2          CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      350    14781
      351    14782    2      END;  /* case */
      352    14783
      353    14784    1    END Z8ET$PROCESS_DEFERED_ID;
      354    14785
      355    14786        %EOD;

PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:30   
--  Include file information  --

   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_XREF.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$PROCESS_DEFERED_ID.

   Procedure Z8ET$PROCESS_DEFERED_ID requires 451 words for executable code.
   Procedure Z8ET$PROCESS_DEFERED_ID requires 26 words of local(AUTO) storage.

PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:31   

 Object Unit name= Z8ET$PROCESS_DEFERED_ID                    File name= Z8ET.:Z8A6TOU
 UTS= AUG 09 '97 12:42:27.36 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  DNT$
    6  LblCom even  none     5      5  DNT_
    7  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    8  LblCom even  none     1      1  DNT_OF_1$
    9  LblCom even  none     1      1  LTS$
   10  LblCom even  none     5      5  LTS_
   11  LblCom even  none     1      1  ST$
   12  LblCom even  none     5      5  ST_
   13  LblCom even  none     1      1  ETT$
   14  LblCom even  none     1      1  HEAD_ETT$
   15  LblCom even  none   512   1000  ETT_BUCKETS
   16  LblCom even  none     5      5  ETT_
   17  LblCom even  none     1      1  XREF$
   18  LblCom even  none     5      5  XREF_
   19  LblCom even  none     8     10  TEMP_LX_NODE
   20  LblCom even  none     1      1  HEAP$
   21  RoData even  UTS      3      3  Z8ET$PROCESS_DEFERED_ID
   22   Proc  even  none   451    703  Z8ET$PROCESS_DEFERED_ID
   23  RoData even  none    17     21  Z8ET$PROCESS_DEFERED_ID
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:32   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    22      0   yes            yes      Std        1  Z8ET$PROCESS_DEFERED_ID

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std      12 Z8AE$ERROR
         yes           Std       1 Z8ED$DISPOSE_ABSSYN_TREE
         yes           Std       4 Z8EY$SUBSTR
         yes           Std       2 Z8EY$SUBSCRIPT
 yes     yes           Std       2 Z8CO$QUALIFY_VARIABLE
         yes           Std       1 Z8AR$RESERVER
         yes           Std       3 Z8AF$NEW_BASE
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                                O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK                          r    LTS_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:33   


      101        1        /*T***********************************************************/
      102        2        /*T*                                                         */
      103        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      104        4        /*T*                                                         */
      105        5        /*T***********************************************************/
      106        6
      107        7        /*M*  Z8ET$PROCESS_DEFERED_ID---Create ETT tree for the identifier*/
      108        8
      109        9
      110       10        /*P*
      111       11               NAME:  Z8ET$PROCESS_DEFERED_ID
      112       12             AUTHOR:  Min Lee.
      113       13            PURPOSE:  Creates the ETT tree for the identifier syntax tree.
      114       14
      115       15        */
      116       16
      117       17        /*D*
      118       18               NAME:  Z8ET$PROCESS_DEFERED_ID
      119       19               CALL:  CALL Z8ET$PROCESS_DEFERED_ID (DEFERED_ID).
      120       20              INPUT:  Abstract Syntax Tree for the deferred identifier.
      121       21
      122       22             OUTPUT:  The ETT tree of the deferred identifier.
      123       23
      124       24        DESCRIPTION:  The action no# for that defered id tree is checked and
      125       25                      an identifier item is created with the correct triads
      126       26                      above it. Z8EY$SUBSCRIPT will be called to process the
      127       27                      subscripts and the Z8EY$SUBSTR will be called to process
      128       28                      the reference modifications.
      129       29                      This routine is called by Z8ET$PROCESS_TREE only.
      130       30         */
      131       31         %EJECT;
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:34   
      132       32          Z8ET$PROCESS_DEFERED_ID:  PROC (DEFERED_ID$);

     32 22 000000   000000 700200 xent  Z8ET$PROCES* TSX0  ! X66_AUTO_1
        22 000001   000032 000001                    ZERO    26,1
        22 000002   000370 710000 22                 TRA     s:14685

      133       33
      134       34
      135       35            %EQU PHASE =1;
      136       36            %INCLUDE Z8A_DEFC;
      137      104            %INCLUDE Z8A_SUPP_MAC;
      138     2504            %INCLUDE Z8A_COMCOM;
      139     3154            %INCLUDE Z8E_STACKS;
      140     5420            %INCLUDE Z8E_O1COM;
      141     6181            %INCLUDE Z8A_ERR_NUMS;
      142     6945            %INCLUDE Z8A_DNT;
      143     7166            %INCLUDE Z8A_LTS;
      144     9243            %INCLUDE Z8A_ST;
      145    12902            %INCLUDE Z8A_ETT;
      146    13203            %INCLUDE Z8A_XREF;
      147    13275            %INCLUDE Z8E_ABSSYN;
      148    13481            %INCLUDE Z8E_HEAP;
      149    13537            %INCLUDE Z8E_MACROS;
      150    14212            %INCLUDE Z8A_TYPES;
      151    14386
      152    14387
      153    14388
      154    14389    1       DCL DEFERED_ID$        PTR;
      155    14390    1       DCL ID$$               PTR;
      156    14391    1       DCL Z8AE$ERROR         ENTRY (12);
      157    14392    1       DCL Z8ED$DISPOSE_ABSSYN_TREE  ENTRY (1);
      158    14393    1       DCL Z8EY$SUBSCRIPT     ENTRY (2);
      159    14394    1       DCL Z8EY$SUBSTR        ENTRY (4);
      160    14395    1       DCL Z8AF$NEW_BASE      ENTRY (3);
      161    14396    1       DCL Z8CO$QUALIFY_VARIABLE   ENTRY (2) ALTRET;
      162    14397    1       DCL Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2);
      163    14398         %EJECT;
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:35   
      164    14399        /*-----------------*/
      165    14400    1     CREATE_IDENTIFIER: PROC (QUAL_ID$, IDENT$) ;

  14400 22 000003   200006 741300       CREATE_IDEN* STX1  ! ID$$+2,,AUTO

      166    14401        /*-----------------*/
      167    14402
      168    14403        /*I*
      169    14404               NAME:  CREATE_IDENTIFIER
      170    14405               CALL:  CALL CREATE_IDENTIFIER(QUAL_ID$, IDENT$) ;
      171    14406
      172    14407              INPUT:  QUAL_ID$ - Pointer to the the head entry of the qualified identifier.
      173    14408             OUTPUT:  An Identifier item is created with the correct triads above it.
      174    14409                      These include BASE's (required by all identifiers), SSOP's and
      175    14410                      OFF's (for arrays), and SIZ's and FISS's (reference modification
      176    14411                      and data item's greater than 256k).
      177    14412
      178    14413        */
      179    14414
      180    14415    2   DCL  QUAL_ID$  PTR ;
      181    14416    2   DCL IDENT$ PTR;
      182    14417
      183    14418    2   DCL  QUALIFIED_ITEM$   PTR ;
             14418            /* Ptr to item containing information on qualified id */
      184    14419    2   DCL ST$ PTR;
      185    14420    2   DCL QUAL_ERROR BOOLEAN;
      186    14421    2   DCL LIDENT$ PTR;
      187    14422
      188    14423
      189    14424    2          QUAL_ERROR = FALSE;

  14424 22 000004   200013 450100                    STZ     QUAL_ERROR,,AUTO

      190    14425
      191    14426    2          IF QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.DNT$ -> DNT.B.REP_COUNTER THEN

  14426 22 000005   200007 470500                    LDP0    @QUAL_ID$,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:36   
        22 000006   000000 471500                    LDP1    0,,PR0
        22 000007   100004 473500                    LDP3    4,,PR1
        22 000010   300002 474500                    LDP4    2,,PR3
        22 000011   400003 236100                    LDQ     3,,PR4
        22 000012   000020 316003                    CANQ    16,DU
        22 000013   000036 600000 22                 TZE     s:14444

      192    14427    3            DO;

      193    14428
      194    14429    3              QUAL_ERROR = TRUE;

  14429 22 000014   400000 236003                    LDQ     -131072,DU
        22 000015   200013 756100                    STQ     QUAL_ERROR,,AUTO

      195    14430
      196    14431    3              IF QUAL_ID$ -> LX_LIST.COUNT = 1 THEN

  14431 22 000016   100002 235100                    LDA     2,,PR1
        22 000017   000001 115007                    CMPA    1,DL
        22 000020   000036 601000 22                 TNZ     s:14444

      197    14432    4                DO;

      198    14433    4                  IF QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.DNT$ ->

  14433 22 000021   400004 220100                    LDX0    4,,PR4
        22 000022   040000 106540                    CMPC    fill='040'O
        22 000023   400004 400010                    ADSC9   4,,PR4                   cn=2,n=*X0
        22 000024   000000 000014 21                 ADSC9   0                        cn=0,n=12
        22 000025   000032 601000 22                 TNZ     s:14437

      199    14434    4                                 DNT.TEXT.NAME = 'LINE-COUNTER' THEN
      200    14435    4                    ST$ = O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.LINE_COUNTER$;

  14435 22 000026   000064 475400 xsym               LDP5    O1COM+52
        22 000027   500020 236100                    LDQ     16,,PR5
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:37   
        22 000030   200012 756100                    STQ     ST$,,AUTO
        22 000031   000035 710000 22                 TRA     s:14439

      201    14436    4                  ELSE
      202    14437    4                    ST$ = O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.PAGE_COUNTER$;

  14437 22 000032   000064 475400 xsym               LDP5    O1COM+52
        22 000033   500017 236100                    LDQ     15,,PR5
        22 000034   200012 756100                    STQ     ST$,,AUTO

      203    14438
      204    14439    4                  GOTO NEXT_STEP;

  14439 22 000035   000051 710000 22                 TRA     NEXT_STEP

      205    14440    4                END;
      206    14441    3            END;
      207    14442
      208    14443
      209    14444    2          CALL Z8CO$QUALIFY_VARIABLE(QUAL_ID$, ST$)

  14444 22 000036   200012 635500                    EPPR5   ST$,,AUTO
        22 000037   200017 455500                    STP5    LIDENT$+3,,AUTO
        22 000040   200007 236100                    LDQ     @QUAL_ID$,,AUTO
        22 000041   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000042   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000043   000000 631400 23                 EPPR1   0
        22 000044   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        22 000045   000047 702000 22                 TSX2    s:14447
        22 000046   000051 710000 22                 TRA     NEXT_STEP

      210    14445    2              WHENALTRETURN
      211    14446    3                DO;

      212    14447    3                  QUAL_ERROR = TRUE;

  14447 22 000047   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:38   
        22 000050   200013 756100                    STQ     QUAL_ERROR,,AUTO

      213    14448    3                END;

      214    14449
      215    14450    2        NEXT_STEP:
      216    14451
      217    14452               %ADD_XREF (SYM = ST$,
      218    14453                          ISN = "QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.LINE",
      219    14454                          TYPE = %XREF_UNK);

  14455 22 000051                       NEXT_STEP    null
  14456 22 000051   000055 234000 xsym               SZN     COMCOM+45
        22 000052   000112 605000 22                 TPL     s:14473

  14460 22 000053   000002 236000 18                 LDQ     XREF_+2
        22 000054   000002 036007                    ADLQ    2,DL
        22 000055   000003 116000 18                 CMPQ    XREF_+3
        22 000056   000067 602000 22                 TNC     s:14462

  14461 22 000057   000003 236000 23                 LDQ     3
        22 000060   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000061   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000062   200017 450500                    STP0    LIDENT$+3,,AUTO
        22 000063   200017 630500                    EPPR0   LIDENT$+3,,AUTO
        22 000064   000002 631400 23                 EPPR1   2
        22 000065   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000066   000000 011000                    NOP     0

  14462 22 000067   000002 236000 18                 LDQ     XREF_+2
        22 000070   000022 736000                    QLS     18
        22 000071   000001 036000 18                 ADLQ    XREF_+1
        22 000072   000000 756000 17                 STQ     XREF$

  14463 22 000073   000002 235000 18                 LDA     XREF_+2
        22 000074   000002 035007                    ADLA    2,DL
        22 000075   000002 755000 18                 STA     XREF_+2
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:39   

  14464 22 000076   000010 220003                    LDX0    8,DU
        22 000077   000000 470400 17                 LDP0    XREF$
        22 000100   000000 740100                    STX0    0,,PR0

  14467 22 000101   200007 470500                    LDP0    @QUAL_ID$,,AUTO
        22 000102   000000 471500                    LDP1    0,,PR0
        22 000103   100004 473500                    LDP3    4,,PR1
        22 000104   300005 721100                    LXL1    5,,PR3
        22 000105   000000 474400 17                 LDP4    XREF$
        22 000106   400000 441100                    SXL1    0,,PR4

  14468 22 000107   200012 236100                    LDQ     ST$,,AUTO
        22 000110   000000 471400 17                 LDP1    XREF$
        22 000111   100001 756100                    STQ     1,,PR1

      220    14472
      221    14473    2         LIDENT$ = IDENT$;

  14473 22 000112   200010 470500                    LDP0    @IDENT$,,AUTO
        22 000113   000000 236100                    LDQ     0,,PR0
        22 000114   200014 756100                    STQ     LIDENT$,,AUTO

      222    14474
      223    14475               %INIT_LX_ETT_ITEM (@POINTER = LIDENT$,
      224    14476                                  @TYPE = %TYG,
      225    14477                                  @LINE = "QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.LINE",
      226    14478                                  @COLUMN =
             14478                                      "QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.COLUMN");

  14480 22 000115   000004 220003                    LDX0    4,DU
        22 000116   200014 471500                    LDP1    LIDENT$,,AUTO
        22 000117   100000 740100                    STX0    0,,PR1

  14481 22 000120   000000 221003                    LDX1    0,DU
        22 000121   100000 441100                    SXL1    0,,PR1

PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:40   
  14482 22 000122   000020 235007                    LDA     16,DL
        22 000123   100004 755100                    STA     4,,PR1

  14483 22 000124   000001 236000 23                 LDQ     1
        22 000125   100007 756100                    STQ     7,,PR1

  14484 22 000126   100001 756100                    STQ     1,,PR1

  14485 22 000127   000001 236000 23                 LDQ     1
        22 000130   100002 756100                    STQ     2,,PR1

  14487 22 000131   200007 473500                    LDP3    @QUAL_ID$,,AUTO
        22 000132   300000 474500                    LDP4    0,,PR3
        22 000133   400004 475500                    LDP5    4,,PR4
        22 000134   500005 235100                    LDA     5,,PR5
        22 000135   100005 755100                    STA     5,,PR1

  14488 22 000136   300000 474500                    LDP4    0,,PR3
        22 000137   400004 475500                    LDP5    4,,PR4
        22 000140   500006 235100                    LDA     6,,PR5
        22 000141   100006 755100                    STA     6,,PR1

      227    14500    2          LIDENT$ -> LX_ETT_ITEM.B.ERROR = QUAL_ERROR;

  14500 22 000142   200013 236100                    LDQ     QUAL_ERROR,,AUTO
        22 000143   000022 772000                    QRL     18
        22 000144   100000 676100                    ERQ     0,,PR1
        22 000145   400000 376007                    ANQ     -131072,DL
        22 000146   100000 656100                    ERSQ    0,,PR1

      228    14501
      229    14502    3          DO SELECT(ST$ -> ST.ID);

  14502 22 000147   200012 474500                    LDP4    ST$,,AUTO
        22 000150   400000 236100                    LDQ     0,,PR4
        22 000151   000022 772000                    QRL     18
        22 000152   000766 116007                    CMPQ    502,DL
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:41   
        22 000153   000156 602000 22                 TNC     s:14502+7
        22 000154   000162 600000 22                 TZE     s:14507
        22 000155   000166 710000 22                 TRA     s:14511
        22 000156   400000 222100                    LDX2    0,,PR4
        22 000157   000765 102003                    CMPX2   501,DU
        22 000160   000166 601000 22                 TNZ     s:14511
        22 000161   000162 710000 22                 TRA     s:14507

      230    14503
      231    14504    3            SELECT(%SCALAR, %ARRAY);

      232    14505
      233    14506                   /* The type is valid */
      234    14507    3              LIDENT$ -> LX_ETT_ITEM.TYPE = ST$ -> SCALAR.TYPE;

  14507 22 000162   400002 236100                    LDQ     2,,PR4
        22 000163   000022 772000                    QRL     18
        22 000164   100004 756100                    STQ     4,,PR1
        22 000165   000217 710000 22                 TRA     s:14528

      235    14508
      236    14509    3            SELECT(ELSE);

      237    14510
      238    14511    3              CALL Z8AE$ERROR (%E$ERROR_DATA_NAME,

  14511 22 000166   300000 475500                    LDP5    0,,PR3
        22 000167   500004 476500                    LDP6    4,,PR5
        22 000170   600006 637500                    EPPR7   6,,PR6
        22 000171   200020 457500                    STP7    LIDENT$+4,,AUTO
        22 000172   600005 635500                    EPPR5   5,,PR6
        22 000173   200017 455500                    STP5    LIDENT$+3,,AUTO
        22 000174   000006 236000 23                 LDQ     6
        22 000175   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000176   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000177   000004 631400 23                 EPPR1   4
        22 000200   000000 701000 xent               TSX1    Z8AE$ERROR
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:42   
        22 000201   000000 011000                    NOP     0

      239    14512    3                        QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.LINE,
      240    14513    3                        QUAL_ID$ -> LX_LIST.HEAD$ -> LX_TERMINAL.COLUMN);
      241    14514
      242    14515                   %FISH (TRIAD = COMCOM.VALUE_0,
      243    14516                          RTN = ST$);

  14518 22 000202   000124 236000 xsym               LDQ     COMCOM+84
        22 000203   200012 756100                    STQ     ST$,,AUTO

  14519 22 000204   200012 470500                    LDP0    ST$,,AUTO
        22 000205   000000 220100                    LDX0    0,,PR0
        22 000206   000751 100003                    CMPX0   489,DU
        22 000207   000217 603000 22                 TRC     s:14528

  14520 22 000210   200012 470500                    LDP0    ST$,,AUTO
        22 000211   000001 236100                    LDQ     1,,PR0
        22 000212   200012 756100                    STQ     ST$,,AUTO

  14521 22 000213   200012 470500                    LDP0    ST$,,AUTO
        22 000214   000000 220100                    LDX0    0,,PR0
        22 000215   000751 100003                    CMPX0   489,DU
        22 000216   000210 602000 22                 TNC     s:14520

      244    14524
      245    14525
      246    14526    3          END;

      247    14527
      248    14528    2          CALL Z8AF$NEW_BASE ( ST$,

  14528 22 000217   000001 236000 23                 LDQ     1
        22 000220   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000221   200014 236100                    LDQ     LIDENT$,,AUTO
        22 000222   000001 036003                    ADLQ    1,DU
        22 000223   200021 756100                    STQ     LIDENT$+5,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:43   
        22 000224   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000225   200020 450500                    STP0    LIDENT$+4,,AUTO
        22 000226   200012 631500                    EPPR1   ST$,,AUTO
        22 000227   200017 451500                    STP1    LIDENT$+3,,AUTO
        22 000230   200017 630500                    EPPR0   LIDENT$+3,,AUTO
        22 000231   000004 631400 23                 EPPR1   4
        22 000232   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        22 000233   000000 011000                    NOP     0

      249    14529    2                               ADDR(NIL),
      250    14530    2                               LIDENT$ -> LX_ETT_ITEM.ETT$);
      251    14531
      252    14532    2   END CREATE_IDENTIFIER ;

  14532 22 000234   200006 221300                    LDX1  ! ID$$+2,,AUTO
        22 000235   000001 702211                    TSX2  ! 1,X1

      253    14533        %EJECT;
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:44   
      254    14534        /*-------------------*/
      255    14535    1     VERIFY_NOT_AN_ARRAY : PROC (IDENT$);

  14535 22 000236   200006 741300       VERIFY_NOT_* STX1  ! ID$$+2,,AUTO

      256    14536        /*-------------------*/
      257    14537
      258    14538        /*I*
      259    14539                 NAME: VERIFY_NOT_AN_ARRAY
      260    14540
      261    14541          DESCRIPTION: Checks to make sure that the identifier is not an array.
      262    14542                       If it is an array, an error message is printed saying that
      263    14543                       a subscript is expected.
      264    14544        */
      265    14545
      266    14546    2     DCL DIMS$ PTR;
      267    14547
      268    14548    2     DCL IDENT$ PTR;
      269    14549
      270    14550    2     DCL IDENT_ST$ PTR;
      271    14551
      272    14552        %FISH (TRIAD = IDENT$ -> LX_ETT_ITEM.ETT$,
      273    14553               RTN   = IDENT_ST$);

  14555 22 000237   200007 470500                    LDP0    @IDENT$,,AUTO
        22 000240   000000 471500                    LDP1    0,,PR0
        22 000241   100001 236100                    LDQ     1,,PR1
        22 000242   200011 756100                    STQ     IDENT_ST$,,AUTO

  14556 22 000243   200011 473500                    LDP3    IDENT_ST$,,AUTO
        22 000244   300000 220100                    LDX0    0,,PR3
        22 000245   000751 100003                    CMPX0   489,DU
        22 000246   000256 603000 22                 TRC     s:14562

  14557 22 000247   200011 470500                    LDP0    IDENT_ST$,,AUTO
        22 000250   000001 236100                    LDQ     1,,PR0
        22 000251   200011 756100                    STQ     IDENT_ST$,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:45   

  14558 22 000252   200011 470500                    LDP0    IDENT_ST$,,AUTO
        22 000253   000000 220100                    LDX0    0,,PR0
        22 000254   000751 100003                    CMPX0   489,DU
        22 000255   000247 602000 22                 TNC     s:14557

      274    14561
      275    14562    2   IF IDENT_ST$ -> ST.ID = %ARRAY THEN

  14562 22 000256   200011 470500                    LDP0    IDENT_ST$,,AUTO
        22 000257   000000 220100                    LDX0    0,,PR0
        22 000260   000765 100003                    CMPX0   501,DU
        22 000261   000366 601000 22                 TNZ     s:14680

      276    14563    3     DO;

      277    14564            %GET_LTS (@ID = %DIMS, @ST$ = IDENT_ST$, @RETURN$ = DIMS$);

  14566 22 000262   000005 236100                    LDQ     5,,PR0
        22 000263   000001 116000 23                 CMPQ    1
        22 000264   000274 600000 22                 TZE     s:14600
        22 000265   000005 471500                    LDP1    5,,PR0
        22 000266   100000 221100                    LDX1    0,,PR1
        22 000267   001105 101003                    CMPX1   581,DU
        22 000270   000274 601000 22                 TNZ     s:14600

  14570 22 000271   100001 236100                    LDQ     1,,PR1
        22 000272   200010 756100                    STQ     DIMS$,,AUTO

  14598 22 000273   000306 710000 22                 TRA     s:14607

  14600 22 000274   000001 116000 23                 CMPQ    1
        22 000275   000304 600000 22                 TZE     s:14604
        22 000276   000005 471500                    LDP1    5,,PR0
        22 000277   100000 221100                    LDX1    0,,PR1
        22 000300   001104 101003                    CMPX1   580,DU
        22 000301   000304 601000 22                 TNZ     s:14604
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:46   

  14602 22 000302   200010 756100                    STQ     DIMS$,,AUTO
        22 000303   000306 710000 22                 TRA     s:14607

  14604 22 000304   000001 236000 23                 LDQ     1
        22 000305   200010 756100                    STQ     DIMS$,,AUTO

      278    14607    3       IF DIMS$ -> DIMS.N = 8 /* One dimension */

  14607 22 000306   200010 471500                    LDP1    DIMS$,,AUTO
        22 000307   100000 721100                    LXL1    0,,PR1
        22 000310   000010 101003                    CMPX1   8,DU
        22 000311   000343 601000 22                 TNZ     s:14658
        22 000312   100006 235100                    LDA     6,,PR1
        22 000313   000001 115007                    CMPA    1,DL
        22 000314   000343 601000 22                 TNZ     s:14658

      279    14608    4       AND DIMS$ -> DIMS.D.DIM (1) = 1 THEN DO;

      280    14609    4         IF COMCOM.OB.FIPS.LEVEL > 0 THEN

  14609 22 000315   000036 722000 xsym               LXL2    COMCOM+30
        22 000316   000366 604400 22                 TMOZ    s:14680

      281    14610                %CONDITIONAL_ERROR (@LX_ITEM$ = IDENT$,
      282    14611                                    @ERROR# = %E$SUBSCRIPT_EXPECTED_ANSI,
      283    14612                                    @LINE = IDENT$ -> LX_ETT_ITEM.LINE,
      284    14613                                    @COLUMN = IDENT$ -> LX_ETT_ITEM.COLUMN);

  14623 22 000317   200007 473500                    LDP3    @IDENT$,,AUTO
        22 000320   300000 474500                    LDP4    0,,PR3
        22 000321   400000 236100                    LDQ     0,,PR4
        22 000322   400000 316007                    CANQ    -131072,DL
        22 000323   000366 601000 22                 TNZ     s:14680

  14625 22 000324   400006 635500                    EPPR5   6,,PR4
        22 000325   200020 455500                    STP5    LIDENT$+4,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:47   
        22 000326   400005 636500                    EPPR6   5,,PR4
        22 000327   200017 456500                    STP6    LIDENT$+3,,AUTO
        22 000330   000010 236000 23                 LDQ     8
        22 000331   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000332   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000333   000004 631400 23                 EPPR1   4
        22 000334   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000335   000000 011000                    NOP     0

  14634 22 000336   200007 470500                    LDP0    @IDENT$,,AUTO
        22 000337   000000 471500                    LDP1    0,,PR0
        22 000340   400000 236007                    LDQ     -131072,DL
        22 000341   100000 256100                    ORSQ    0,,PR1

      285    14643    4       END;

  14643 22 000342   000366 710000 22                 TRA     s:14680

      286    14644    3       ELSE
      287    14645              %CONDITIONAL_ERROR (@LX_ITEM$ = IDENT$,
      288    14646                                  @ERROR# = %E$SUBSCRIPT_EXPECTED,
      289    14647                                  @LINE = IDENT$ -> LX_ETT_ITEM.LINE,
      290    14648                                  @COLUMN = IDENT$ -> LX_ETT_ITEM.COLUMN);

  14658 22 000343   200007 473500                    LDP3    @IDENT$,,AUTO
        22 000344   300000 474500                    LDP4    0,,PR3
        22 000345   400000 236100                    LDQ     0,,PR4
        22 000346   400000 316007                    CANQ    -131072,DL
        22 000347   000366 601000 22                 TNZ     s:14680

  14660 22 000350   400006 635500                    EPPR5   6,,PR4
        22 000351   200020 455500                    STP5    LIDENT$+4,,AUTO
        22 000352   400005 636500                    EPPR6   5,,PR4
        22 000353   200017 456500                    STP6    LIDENT$+3,,AUTO
        22 000354   000012 236000 23                 LDQ     10
        22 000355   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000356   200016 630500                    EPPR0   LIDENT$+2,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:48   
        22 000357   000004 631400 23                 EPPR1   4
        22 000360   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000361   000000 011000                    NOP     0

  14669 22 000362   200007 470500                    LDP0    @IDENT$,,AUTO
        22 000363   000000 471500                    LDP1    0,,PR0
        22 000364   400000 236007                    LDQ     -131072,DL
        22 000365   100000 256100                    ORSQ    0,,PR1

      291    14678    3     END;

      292    14679
      293    14680    2   END VERIFY_NOT_AN_ARRAY;

  14680 22 000366   200006 221300                    LDX1  ! ID$$+2,,AUTO
        22 000367   000001 702211                    TSX2  ! 1,X1

      294    14681        %EJECT ;
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:49   
      295    14682
      296    14683         /*     Main  Program     */
      297    14684
      298    14685    1      ID$$ = DEFERED_ID$;

  14685 22 000370   200003 470500                    LDP0    @DEFERED_ID$,,AUTO
        22 000371   000000 236100                    LDQ     0,,PR0
        22 000372   200004 756100                    STQ     ID$$,,AUTO

      299    14686
      300    14687    2      DO CASE (ID$$ -> DEFERED_ID_TREE.ACTION_NO#);

  14687 22 000373   200004 471500                    LDP1    ID$$,,AUTO
        22 000374   100004 235100                    LDA     4,,PR1
        22 000375   000004 115007                    CMPA    4,DL
        22 000376   000400 602005 22                 TNC     s:14687+5,AL
        22 000377   000676 710000 22                 TRA     s:14780
        22 000400   000404 710000 22                 TRA     s:14690
        22 000401   000447 710000 22                 TRA     s:14710
        22 000402   000534 710000 22                 TRA     s:14734
        22 000403   000604 710000 22                 TRA     s:14755

      301    14688    2        CASE (%REP_ACT_ID);

      302    14689
      303    14690    2          CALL CREATE_IDENTIFIER (ID$$ -> DEFERED_ID_TREE.QUAL_ID$,

  14690 22 000404   000013 236000 23                 LDQ     11
        22 000405   200024 756100                    STQ     LIDENT$+8,,AUTO
        22 000406   200024 633500                    EPPR3   LIDENT$+8,,AUTO
        22 000407   200010 453500                    STP3    @IDENT$+1,,AUTO
        22 000410   200004 236100                    LDQ     ID$$,,AUTO
        22 000411   000001 036003                    ADLQ    1,DU
        22 000412   200007 756100                    STQ     ID$$+3,,AUTO
        22 000413   000003 701000 22                 TSX1    CREATE_IDENTIFIER
        22 000414   000000 011000                    NOP     0

PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:50   
      304    14691    2                                  ADDR(TEMP_LX_NODE));
      305    14692    2          CALL VERIFY_NOT_AN_ARRAY (ADDR(TEMP_LX_NODE));

  14692 22 000415   000013 236000 23                 LDQ     11
        22 000416   200025 756100                    STQ     LIDENT$+9,,AUTO
        22 000417   200025 630500                    EPPR0   LIDENT$+9,,AUTO
        22 000420   200007 450500                    STP0    ID$$+3,,AUTO
        22 000421   000236 701000 22                 TSX1    VERIFY_NOT_AN_ARRAY
        22 000422   000000 011000                    NOP     0

      306    14693    2          CALL Z8ED$DISPOSE_ABSSYN_TREE(DEFERED_ID$);

  14693 22 000423   200003 630500                    EPPR0   @DEFERED_ID$,,AUTO
        22 000424   000002 631400 23                 EPPR1   2
        22 000425   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        22 000426   000000 011000                    NOP     0

      307    14694               %NEW_COPY_LX_ITEM (@FROM$   = "ADDR(TEMP_LX_NODE)",
      308    14695                                  @TO$     = DEFERED_ID$);

  14700 22 000427   000015 236000 23                 LDQ     13
        22 000430   200003 235100                    LDA     @DEFERED_ID$,,AUTO
        22 000431   200016 757100                    STAQ    LIDENT$+2,,AUTO
        22 000432   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000433   000000 631400 23                 EPPR1   0
        22 000434   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        22 000435   000000 011000                    NOP     0

  14703 22 000436   200003 470500                    LDP0    @DEFERED_ID$,,AUTO
        22 000437   000000 471500                    LDP1    0,,PR0
        22 000440   000100 100400                    MLR     fill='000'O
        22 000441   000000 000040 19                 ADSC9   TEMP_LX_NODE             cn=0,n=32
        22 000442   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

  14704 22 000443   000000 471500                    LDP1    0,,PR0
        22 000444   000001 236000 23                 LDQ     1
        22 000445   100007 756100                    STQ     7,,PR1
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:51   

  14705 22 000446   000702 710000 22                 TRA     s:14784

      309    14707
      310    14708    2        CASE (%REP_ACT_ID_REF);

      311    14709
      312    14710    2          CALL CREATE_IDENTIFIER (ID$$ -> DEFERED_ID_TREE.QUAL_ID$,

  14710 22 000447   000013 236000 23                 LDQ     11
        22 000450   200026 756100                    STQ     LIDENT$+10,,AUTO
        22 000451   200026 633500                    EPPR3   LIDENT$+10,,AUTO
        22 000452   200010 453500                    STP3    @IDENT$+1,,AUTO
        22 000453   200004 236100                    LDQ     ID$$,,AUTO
        22 000454   000001 036003                    ADLQ    1,DU
        22 000455   200007 756100                    STQ     ID$$+3,,AUTO
        22 000456   000003 701000 22                 TSX1    CREATE_IDENTIFIER
        22 000457   000000 011000                    NOP     0

      313    14711    2                                  ADDR(TEMP_LX_NODE));
      314    14712    2          CALL Z8EY$SUBSTR( ADDR( TEMP_LX_NODE ),

  14712 22 000460   200004 470500                    LDP0    ID$$,,AUTO
        22 000461   000003 471500                    LDP1    3,,PR0
        22 000462   100004 473500                    LDP3    4,,PR1
        22 000463   000013 236000 23                 LDQ     11
        22 000464   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000465   200017 756100                    STQ     LIDENT$+3,,AUTO
        22 000466   200017 634500                    EPPR4   LIDENT$+3,,AUTO
        22 000467   200023 454500                    STP4    LIDENT$+7,,AUTO
        22 000470   300007 635500                    EPPR5   7,,PR3
        22 000471   200022 455500                    STP5    LIDENT$+6,,AUTO
        22 000472   100004 633500                    EPPR3   4,,PR1
        22 000473   200021 453500                    STP3    LIDENT$+5,,AUTO
        22 000474   200016 631500                    EPPR1   LIDENT$+2,,AUTO
        22 000475   200020 451500                    STP1    LIDENT$+4,,AUTO
        22 000476   200020 630500                    EPPR0   LIDENT$+4,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:52   
        22 000477   000016 631400 23                 EPPR1   14
        22 000500   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 000501   000000 011000                    NOP     0

      315    14713    2                            ID$$ -> DEFERED_ID_TREE.REF$ -> LX_LIST.HEAD$,
      316    14714    2                            ID$$ -> DEFERED_ID_TREE.REF$ -> LX_LIST.HEAD$ -> LX_ITEM.
             14714                                     LINK,
      317    14715    2                            ADDR( TEMP_LX_NODE ));
      318    14716    2          CALL VERIFY_NOT_AN_ARRAY (ADDR(TEMP_LX_NODE));

  14716 22 000502   000013 236000 23                 LDQ     11
        22 000503   200027 756100                    STQ     LIDENT$+11,,AUTO
        22 000504   200027 630500                    EPPR0   LIDENT$+11,,AUTO
        22 000505   200007 450500                    STP0    ID$$+3,,AUTO
        22 000506   000236 701000 22                 TSX1    VERIFY_NOT_AN_ARRAY
        22 000507   000000 011000                    NOP     0

      319    14717    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (DEFERED_ID$);

  14717 22 000510   200003 630500                    EPPR0   @DEFERED_ID$,,AUTO
        22 000511   000002 631400 23                 EPPR1   2
        22 000512   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        22 000513   000000 011000                    NOP     0

      320    14718               %NEW_COPY_LX_ITEM (@FROM$  = "ADDR(TEMP_LX_NODE)",
      321    14719                                  @TO$    = DEFERED_ID$);

  14724 22 000514   000015 236000 23                 LDQ     13
        22 000515   200003 235100                    LDA     @DEFERED_ID$,,AUTO
        22 000516   200016 757100                    STAQ    LIDENT$+2,,AUTO
        22 000517   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000520   000000 631400 23                 EPPR1   0
        22 000521   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        22 000522   000000 011000                    NOP     0

  14727 22 000523   200003 470500                    LDP0    @DEFERED_ID$,,AUTO
        22 000524   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:53   
        22 000525   000100 100400                    MLR     fill='000'O
        22 000526   000000 000040 19                 ADSC9   TEMP_LX_NODE             cn=0,n=32
        22 000527   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

  14728 22 000530   000000 471500                    LDP1    0,,PR0
        22 000531   000001 236000 23                 LDQ     1
        22 000532   100007 756100                    STQ     7,,PR1

  14729 22 000533   000702 710000 22                 TRA     s:14784

      322    14731
      323    14732    2        CASE (%REP_ACT_ID_SUB);

      324    14733
      325    14734    2          CALL CREATE_IDENTIFIER (ID$$ -> DEFERED_ID_TREE.QUAL_ID$,

  14734 22 000534   000013 236000 23                 LDQ     11
        22 000535   200030 756100                    STQ     LIDENT$+12,,AUTO
        22 000536   200030 633500                    EPPR3   LIDENT$+12,,AUTO
        22 000537   200010 453500                    STP3    @IDENT$+1,,AUTO
        22 000540   200004 236100                    LDQ     ID$$,,AUTO
        22 000541   000001 036003                    ADLQ    1,DU
        22 000542   200007 756100                    STQ     ID$$+3,,AUTO
        22 000543   000003 701000 22                 TSX1    CREATE_IDENTIFIER
        22 000544   000000 011000                    NOP     0

      326    14735    2                                  ADDR(TEMP_LX_NODE));
      327    14736    2          CALL Z8EY$SUBSCRIPT (ID$$ -> DEFERED_ID_TREE.SUB$,

  14736 22 000545   000013 236000 23                 LDQ     11
        22 000546   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000547   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000550   200021 450500                    STP0    LIDENT$+5,,AUTO
        22 000551   200004 236100                    LDQ     ID$$,,AUTO
        22 000552   000002 036003                    ADLQ    2,DU
        22 000553   200020 756100                    STQ     LIDENT$+4,,AUTO
        22 000554   200020 630500                    EPPR0   LIDENT$+4,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:54   
        22 000555   000000 631400 23                 EPPR1   0
        22 000556   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        22 000557   000000 011000                    NOP     0

      328    14737    2                               ADDR(TEMP_LX_NODE));
      329    14738    2          CALL Z8ED$DISPOSE_ABSSYN_TREE(DEFERED_ID$);

  14738 22 000560   200003 630500                    EPPR0   @DEFERED_ID$,,AUTO
        22 000561   000002 631400 23                 EPPR1   2
        22 000562   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        22 000563   000000 011000                    NOP     0

      330    14739               %NEW_COPY_LX_ITEM (@FROM$   = "ADDR(TEMP_LX_NODE)",
      331    14740                                  @TO$     = DEFERED_ID$);

  14745 22 000564   000015 236000 23                 LDQ     13
        22 000565   200003 235100                    LDA     @DEFERED_ID$,,AUTO
        22 000566   200016 757100                    STAQ    LIDENT$+2,,AUTO
        22 000567   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000570   000000 631400 23                 EPPR1   0
        22 000571   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        22 000572   000000 011000                    NOP     0

  14748 22 000573   200003 470500                    LDP0    @DEFERED_ID$,,AUTO
        22 000574   000000 471500                    LDP1    0,,PR0
        22 000575   000100 100400                    MLR     fill='000'O
        22 000576   000000 000040 19                 ADSC9   TEMP_LX_NODE             cn=0,n=32
        22 000577   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

  14749 22 000600   000000 471500                    LDP1    0,,PR0
        22 000601   000001 236000 23                 LDQ     1
        22 000602   100007 756100                    STQ     7,,PR1

  14750 22 000603   000702 710000 22                 TRA     s:14784

      332    14752
      333    14753    2        CASE (%REP_ACT_ID_SUB_REF);
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:55   

      334    14754
      335    14755    2          CALL CREATE_IDENTIFIER (ID$$ -> DEFERED_ID_TREE.QUAL_ID$,

  14755 22 000604   000013 236000 23                 LDQ     11
        22 000605   200031 756100                    STQ     LIDENT$+13,,AUTO
        22 000606   200031 633500                    EPPR3   LIDENT$+13,,AUTO
        22 000607   200010 453500                    STP3    @IDENT$+1,,AUTO
        22 000610   200004 236100                    LDQ     ID$$,,AUTO
        22 000611   000001 036003                    ADLQ    1,DU
        22 000612   200007 756100                    STQ     ID$$+3,,AUTO
        22 000613   000003 701000 22                 TSX1    CREATE_IDENTIFIER
        22 000614   000000 011000                    NOP     0

      336    14756    2                                  ADDR(TEMP_LX_NODE));
      337    14757    2          CALL Z8EY$SUBSCRIPT (ID$$ -> DEFERED_ID_TREE.SUB$,

  14757 22 000615   000013 236000 23                 LDQ     11
        22 000616   200016 756100                    STQ     LIDENT$+2,,AUTO
        22 000617   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000620   200021 450500                    STP0    LIDENT$+5,,AUTO
        22 000621   200004 236100                    LDQ     ID$$,,AUTO
        22 000622   000002 036003                    ADLQ    2,DU
        22 000623   200020 756100                    STQ     LIDENT$+4,,AUTO
        22 000624   200020 630500                    EPPR0   LIDENT$+4,,AUTO
        22 000625   000000 631400 23                 EPPR1   0
        22 000626   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        22 000627   000000 011000                    NOP     0

      338    14758    2                               ADDR(TEMP_LX_NODE));
      339    14759    2          CALL Z8EY$SUBSTR (ADDR(TEMP_LX_NODE),

  14759 22 000630   200004 470500                    LDP0    ID$$,,AUTO
        22 000631   000003 471500                    LDP1    3,,PR0
        22 000632   100004 473500                    LDP3    4,,PR1
        22 000633   000013 236000 23                 LDQ     11
        22 000634   200016 756100                    STQ     LIDENT$+2,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:56   
        22 000635   200017 756100                    STQ     LIDENT$+3,,AUTO
        22 000636   200017 634500                    EPPR4   LIDENT$+3,,AUTO
        22 000637   200023 454500                    STP4    LIDENT$+7,,AUTO
        22 000640   300007 635500                    EPPR5   7,,PR3
        22 000641   200022 455500                    STP5    LIDENT$+6,,AUTO
        22 000642   100004 633500                    EPPR3   4,,PR1
        22 000643   200021 453500                    STP3    LIDENT$+5,,AUTO
        22 000644   200016 631500                    EPPR1   LIDENT$+2,,AUTO
        22 000645   200020 451500                    STP1    LIDENT$+4,,AUTO
        22 000646   200020 630500                    EPPR0   LIDENT$+4,,AUTO
        22 000647   000016 631400 23                 EPPR1   14
        22 000650   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 000651   000000 011000                    NOP     0

      340    14760    2                            ID$$ -> DEFERED_ID_TREE.REF$ -> LX_LIST.HEAD$,
      341    14761    2                            ID$$ -> DEFERED_ID_TREE.REF$ -> LX_LIST.HEAD$ -> LX_ITEM.
             14761                                     LINK,
      342    14762    2                            ADDR(TEMP_LX_NODE));
      343    14763    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (DEFERED_ID$);

  14763 22 000652   200003 630500                    EPPR0   @DEFERED_ID$,,AUTO
        22 000653   000002 631400 23                 EPPR1   2
        22 000654   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        22 000655   000000 011000                    NOP     0

      344    14764               %NEW_COPY_LX_ITEM (@FROM$  = "ADDR(TEMP_LX_NODE)",
      345    14765                                  @TO$    = DEFERED_ID$);

  14770 22 000656   000015 236000 23                 LDQ     13
        22 000657   200003 235100                    LDA     @DEFERED_ID$,,AUTO
        22 000660   200016 757100                    STAQ    LIDENT$+2,,AUTO
        22 000661   200016 630500                    EPPR0   LIDENT$+2,,AUTO
        22 000662   000000 631400 23                 EPPR1   0
        22 000663   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        22 000664   000000 011000                    NOP     0

  14773 22 000665   200003 470500                    LDP0    @DEFERED_ID$,,AUTO
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:57   
        22 000666   000000 471500                    LDP1    0,,PR0
        22 000667   000100 100400                    MLR     fill='000'O
        22 000670   000000 000040 19                 ADSC9   TEMP_LX_NODE             cn=0,n=32
        22 000671   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

  14774 22 000672   000000 471500                    LDP1    0,,PR0
        22 000673   000001 236000 23                 LDQ     1
        22 000674   100007 756100                    STQ     7,,PR1

  14775 22 000675   000702 710000 22                 TRA     s:14784

      346    14777
      347    14778    2        CASE (ELSE);

      348    14779
      349    14780    2          CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  14780 22 000676   000020 630400 23                 EPPR0   16
        22 000677   000002 631400 23                 EPPR1   2
        22 000700   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000701   000000 011000                    NOP     0

      350    14781
      351    14782    2      END;  /* case */

      352    14783
      353    14784    1    END Z8ET$PROCESS_DEFERED_ID;

  14784 22 000702   000000 702200 xent               TSX2  ! X66_ARET
      354    14785
      355    14786        %EOD;

PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:58   
--  Include file information  --

   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_XREF.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$PROCESS_DEFERED_ID.
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:59   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:60   
  ****  Section 005 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 006 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 007 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 008 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 009 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 010 LblCom LTS_

PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:61   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 011 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 012 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 013 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 014 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 015 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:62   

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 016 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 017 LblCom XREF$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 XREF$

  ****  Section 018 LblCom XREF_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 XREF_

  ****  Section 019 LblCom TEMP_LX_NODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)   r     1 TEMP_LX_NODE

  ****  Section 020 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:63   

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DEFERED_ID$              10-0-0/w PTR         r     1 @IDENT$
     7-0-0/w PTR         r     1 @IDENT$                    7-0-0/w PTR         r     1 @QUAL_ID$
    *0-0-0/w PTR         r     1 DEFERED_ID$               10-0-0/w PTR         r     1 DIMS$
     4-0-0/w PTR         r     1 ID$$                      *0-0-0/w PTR         r     1 IDENT$
    *0-0-0/w PTR         r     1 IDENT$                    11-0-0/w PTR         r     1 IDENT_ST$
    14-0-0/w PTR         r     1 LIDENT$                   11-0-0/w PTR               1 QUALIFIED_ITEM$
    13-0-0/b BIT         r     1 QUAL_ERROR                *0-0-0/w PTR         r     1 QUAL_ID$
    12-0-0/w PTR         r     1 ST$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:64   
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)   r     1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)  r     1 DIMS                       0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)   r     1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)   r     1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
PL6.E3A0      #002=Z8ET$PROCESS_DEFERED_ID File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:42 Page:65   
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)         1 REPORT_01_LTS
     0-0-0/w STRC(432)         1 REPORT_ELEM_LTS            0-0-0/w STRC(252)         1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)  r     1 REPORT_LTS                 0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/d STRC(612)         1 USE                        0-0-0/w STRC(252)         1 USE_SUPP
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(288)         1 WRITE_STMT
     0-0-0/w STRC(72)    r     1 XREF


   Procedure Z8ET$PROCESS_DEFERED_ID requires 451 words for executable code.
   Procedure Z8ET$PROCESS_DEFERED_ID requires 26 words of local(AUTO) storage.

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:66   
      356        1        /*T***********************************************************/
      357        2        /*T*                                                         */
      358        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      359        4        /*T*                                                         */
      360        5        /*T***********************************************************/
      361        6
      362        7        /*M*  Z8ET$DEFERED_SUM_AND_SOUCE---for SUM and SOURCE clause*/
      363        8
      364        9
      365       10        /*P*
      366       11               NAME:  Z8ET$DEFERED_SUM_AND_SOURCE
      367       12             AUTHOR:  Min Lee.
      368       13            PURPOSE:  Wrap up the SUM clause and the SOURCE clause in the
      369       14                      REPORT SECTION of the DATA DIVISION.
      370       15        */
      371       16
      372       17        /*D*
      373       18               NAME:  Z8ET$DEFERED_SUM_AND_SOURCE
      374       19               CALL:  CALL Z8ET$DEFERED_SUM_AND_SOURCE
      375       20              INPUT:  O1COM.REPORT_SOURCE$, O1COM.REPORT_SUM$.
      376       21
      377       22
      378       23
      379       24        DESCRIPTION:  1. Call Z8ET$PROCESS_TREE to create the ETT tree of the
      380       25                         identifiers in the SUM and SOURCE clause .
      381       26                      2. Generates all the ETT and LX_ETT items for the Special
      382       27                         Subtotaling Subroutine, General Subtotaling Subroutine,
      383       28                         Cross Footing/Rolling Forward Subroutine, Sum Counter
      384       29                         Resetting Subroutine.
      385       30                      3. Call Z8ET$CREATE_SUBROUTINES to create all the
      386       31                         subroutines that will be excuted by the RWCS.
      387       32         */
      388       33         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:67   
      389       34
      390       35         Z8ET$DEFERED_SUM_AND_SOURCE: PROC;
      391       36
      392       37
      393       38
      394       39        %EQU PHASE = 1;
      395       40        %INCLUDE Z8A_DEFC;
      396      108        %INCLUDE Z8A_SUPP_MAC;
      397     2508        %INCLUDE Z8A_COMCOM;
      398     3158        %INCLUDE Z8A_ST;
      399     6817        %INCLUDE Z8A_QLT;
      400     6923        %INCLUDE Z8A_LTS;
      401     9000        %INCLUDE Z8A_TYPES;
      402     9174        %INCLUDE Z8A_DNT;
      403     9395        %INCLUDE Z8A_ERR_NUMS;
      404    10159        %INCLUDE Z8A_ILL;
      405    10852        %INCLUDE Z8A_ETT;
      406    11153        %INCLUDE Z8A_MKCN;
      407    11170
      408    11171        %INCLUDE Z8E_STACKS;
      409    13437        %INCLUDE Z8E_WINDOW;
      410    15507        %INCLUDE Z8E_O1COM;
      411    16268        %INCLUDE Z8E_MACROS;
      412    16943        %INCLUDE Z8D_PIC_PARM;
      413    17049        %INCLUDE Z8E_HEAP;
      414    17105        %INCLUDE Z8E_ABSSYN;
      415    17311        %INCLUDE Z8E_STATEMNT;
      416    17380
      417    17381    1   DCL Z8AE$ERROR     ENTRY (12);
      418    17382    1   DCL Z8CO$QUALIFY_VARIABLE ENTRY (2) ALTRET;
      419    17383    1   DCL Z8ET$PROCESS_TREE    ENTRY (1);
      420    17384    1   DCL Z8ED$DISPOSE_ABSSYN_TREE  ENTRY (1);
      421    17385    1   DCL Z8AT$CREATE_TEMPORARY  ENTRY (2);
      422    17386    1   DCL Z8EK$BRANCH    ENTRY (1);
      423    17387    1   DCL Z8ET$CREATE_SUBROUTINES  ENTRY(1);
      424    17388    1   DCL ASSOC_01_LTS$     PTR;
      425    17389    1   DCL I              SBIN WORD;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:68   
      426    17390
      427    17391
      428    17392
      429    17393
      430    17394        %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:69   
      431    17395
      432    17396         /*=================*/
      433    17397    1      CREATE_SOURCE_ETT:  PROC;
      434    17398         /*=================*/
      435    17399
      436    17400        /*I*
      437    17401
      438    17402             NAME:  CREATE_SOURCE_ETT
      439    17403
      440    17404          PURPOSE: Process the SOURCE clauses.
      441    17405
      442    17406             CALL: CALL CREATE_SOURCE_ETT.
      443    17407
      444    17408            INPUT: O1COM.REPORT_SOURCE$--Point to a list of DEFERED_IDENTIFIER
      445    17409                   items that contain the SOURCE clauses' informations.
      446    17410          DESCRIPTION: This routine steps through the O1COM.REPORT_SOURCE$
      447    17411                       chain to get the identifier in each SOURCE clause and
      448    17412                       calls Z8ET$PROCESS_TREE to create the ETT tree for it.
      449    17413                       Also to flag it as an error if it is a report item but
      450    17414                       not a sum counter or is a sum counter nit in same report.
      451    17415
      452    17416        */
      453    17417
      454    17418
      455    17419    2      DCL LTS$$           PTR;
      456    17420    2      DCL NEXT$           PTR;
      457    17421    2       DCL SUM_BIT        BIT (1) ALIGNED;
      458    17422    2       DCL ELEM_LTS$      PTR;
      459    17423
      460    17424    2      NEXT$ = O1COM.REPORT_SOURCE$;
      461    17425
      462    17426    3      DO WHILE (NEXT$ ~= ADDR(NIL));
      463    17427
      464    17428    3        LTS$$ = NEXT$ -> DEFERED_IDENTIFIER.ASSOC_VAR_LTS$;
      465    17429    3        O1COM.CURRENT_REPORT_LTS$ = NEXT$ -> DEFERED_IDENTIFIER.ASSOC_REPORT_LTS$;
      466    17430
      467    17431    3        CALL Z8ET$PROCESS_TREE (NEXT$ -> DEFERED_IDENTIFIER.DEFERED_ID$);
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:70   
      468    17432
      469    17433    3        LTS$$ -> REPORT_ELEM_LTS.SOURCE_ETT$ =
      470    17434    3                 NEXT$ -> DEFERED_IDENTIFIER.DEFERED_ID$ -> LX_ETT_ITEM.ETT$;
      471    17435
      472    17436    3        IF NOT NEXT$ -> DEFERED_IDENTIFIER.DEFERED_ID$ -> LX_ETT_ITEM.B.ERROR THEN
      473    17437    3          CALL REP_ITEM_CHECK (NEXT$ -> DEFERED_IDENTIFIER.DEFERED_ID$,
      474    17438    3                               SUM_BIT,
      475    17439    3                               ELEM_LTS$,
      476    17440    3                               %E$MUST_SUM_IN_SAME_REPORT);
      477    17441    3        NEXT$ = NEXT$ -> DEFERED_IDENTIFIER.LINK;
      478    17442    3      END;  /* while */
      479    17443
      480    17444    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (O1COM.REPORT_SOURCE$);
      481    17445
      482    17446    2    END CREATE_SOURCE_ETT;
      483    17447         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:71   
      484    17448
      485    17449         /*==============*/
      486    17450    1      REP_ITEM_CHECK: PROC (LX_ETT$, SUM_BIT, ELEM_LTS$, ERR_NUMBER);
      487    17451         /*==============*/
      488    17452
      489    17453        /*I*
      490    17454
      491    17455             NAME:  REPORT_ITEM_CHECK
      492    17456
      493    17457          PURPOSE: Verify a report item in the SOURCE or SUM clause.
      494    17458
      495    17459             CALL: CALL REPORT_ITEM_CHECK(LX_ETT$, SUM_BIT, ELEM_LTS$, ERR_NUMBER)
      496    17460
      497    17461            INPUT: LX_ETT$--ETT tree of the identifier.
      498    17462                   ELEM_LTS$--LTS item associate with the report item.
      499    17463                   ERR_NUMBER-- error number of the error message.
      500    17464           OUTPUT: SUM_BIT--a bit will be set 'on' for a valid sum counter.
      501    17465          DESCRIPTION: If the identifier is a report item but is not a sum
      502    17466                       counter or is a sum counter but not in the same report
      503    17467                       then a error message will be issued.
      504    17468                       If it is a valid sum counter the set the SUM_BIT on.
      505    17469
      506    17470        */
      507    17471
      508    17472
      509    17473    2   DCL LX_ETT$        PTR;
      510    17474    2   DCL SUM_BIT        BIT (1) ALIGNED;
      511    17475    2   DCL ELEM_LTS$      PTR;
      512    17476    2   DCL ST$$           PTR;
      513    17477    2   DCL ERR_NUMBER     UBIN WORD;
      514    17478
      515    17479
      516    17480    2          SUM_BIT = FALSE;
      517    17481
      518    17482               %FISH (TRIAD = LX_ETT$ -> LX_ETT_ITEM.ETT$,
      519    17483                      RTN   = ST$$);
      520    17491
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:72   
      521    17492    2          IF ST$$ -> SCALAR.B.REPORT_ITEM THEN
      522    17493    3            DO;
      523    17494    3              IF ST$$ -> SCALAR.B.SUM_COUNTER THEN
      524    17495    4                DO;
      525    17496
      526    17497                       %GET_LTS (@ID     = %REPORT_ELEM_LTS,
      527    17498                                 @ST$    = ST$$,
      528    17499                                 @RETURN$ = ELEM_LTS$);
      529    17542
      530    17543    4                  IF ELEM_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.REPORT_LTS$ ~=
      531    17544    4                          O1COM.CURRENT_REPORT_LTS$ THEN
      532    17545    5                    DO;
      533    17546    5                      CALL Z8AE$ERROR (ERR_NUMBER,
      534    17547    5                                       LX_ETT$ -> LX_ETT_ITEM.LINE,
      535    17548    5                                       LX_ETT$ -> LX_ETT_ITEM.COLUMN);
      536    17549    5                    END;
      537    17550    4                  ELSE
      538    17551    4                    SUM_BIT = TRUE;
      539    17552
      540    17553    4                END;
      541    17554
      542    17555    3              ELSE
      543    17556    4                DO;
      544    17557    4                  CALL Z8AE$ERROR (ERR_NUMBER,
      545    17558    4                                   LX_ETT$ -> LX_ETT_ITEM.LINE,
      546    17559    4                                   LX_ETT$ -> LX_ETT_ITEM.COLUMN);
      547    17560    4                END;
      548    17561    3            END;
      549    17562
      550    17563    2    END REP_ITEM_CHECK;
      551    17564         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:73   
      552    17565
      553    17566
      554    17567         /*=================*/
      555    17568    1      CREATE_REPORT_SUM: PROC;
      556    17569         /*=================*/
      557    17570
      558    17571        /*I*
      559    17572
      560    17573             NAME:  CREATE_REPORT_SUM
      561    17574
      562    17575          DESCRIPTION: This routine steps through the O1COM.REPORT_SUM$ list
      563    17576                       which chains all the DEFERED_SUM_CLAUSE_LIST that
      564    17577                       containing the informations of the SUM clauses of a sum
      565    17578                       counter and call PROCESS_SUM to process it and then,
      566    17579                       call GENERATE_SUBS  to generate the run time subroutines.
      567    17580        */
      568    17581
      569    17582
      570    17583    2      DCL NEXT$           PTR;
      571    17584
      572    17585
      573    17586
      574    17587    2        NEXT$ = O1COM.REPORT_SUM$;
      575    17588
      576    17589    3      DO WHILE (NEXT$ ~= ADDR(NIL));
      577    17590
      578    17591    3        O1COM.CURRENT_REPORT_LTS$ = NEXT$ -> DEFERED_SUM_CLAUSE_LIST.ASSOC_REPORT_LTS$;
      579    17592    3        ASSOC_01_LTS$ = NEXT$ -> DEFERED_SUM_CLAUSE_LIST.ASSOC_01_LTS$;
      580    17593
      581    17594    3        CALL PROCESS_SUM (NEXT$ -> DEFERED_SUM_CLAUSE_LIST.SUM_CLAUSE_LIST$,
      582    17595    3                          NEXT$ -> DEFERED_SUM_CLAUSE_LIST.ASSOC_VAR_LTS$);
      583    17596
      584    17597    3        NEXT$ = NEXT$ -> DEFERED_SUM_CLAUSE_LIST.LINK;
      585    17598    3      END; /* while */
      586    17599
      587    17600    2      IF O1COM.REPORT_SUM$ ~= ADDR(NIL) THEN
      588    17601    3        DO;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:74   
      589    17602
      590    17603    3          CALL Z8ED$DISPOSE_ABSSYN_TREE (O1COM.REPORT_SUM$);
      591    17604
      592    17605    3          CALL GENERATE_SUBS;
      593    17606    3        END;
      594    17607
      595    17608
      596    17609    2    END CREATE_REPORT_SUM;
      597    17610         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:75   
      598    17611
      599    17612         /*===========*/
      600    17613    1      PROCESS_SUM: PROC (SUM_LIST$, VAR_LTS$);
      601    17614         /*===========*/
      602    17615
      603    17616        /*I*
      604    17617             NAME:  PROCESS_SUM
      605    17618
      606    17619          DESCRIPTION: This routine calls several modules to generate the
      607    17620                       ETT items that reset or subtotalling the sum counter.
      608    17621        */
      609    17622
      610    17623
      611    17624    2      DCL SUM_LIST$       PTR;
      612    17625    2      DCL VAR_LTS$        PTR;
      613    17626    2      DCL ID_LIST$        PTR;
      614    17627    2      DCL LTS$$           PTR;
      615    17628    2      DCL SUM_CLAUSE$     PTR;
      616    17629    2      DCL ID$$            PTR;
      617    17630
      618    17631
      619    17632
      620    17633    2      IF SUM_LIST$ -> LX_LIST.TAIL$ -> DEFERED_SUM_CLAUSE.B.RESET_ID OR
      621    17634    2         SUM_LIST$ -> LX_LIST.TAIL$ -> DEFERED_SUM_CLAUSE.B.RESET_FINAL THEN
      622    17635
      623    17636    2        CALL PROCESS_RESET (SUM_LIST$ -> LX_LIST.TAIL$,
      624    17637    2                            VAR_LTS$);
      625    17638
      626    17639    2        SUM_CLAUSE$ = SUM_LIST$ -> LX_LIST.HEAD$;
      627    17640
      628    17641    3      DO WHILE (SUM_CLAUSE$ ~= ADDR(NIL));
      629    17642
      630    17643    3        CALL Z8ET$PROCESS_TREE (SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$);
      631    17644
      632    17645    3        IF SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_UPON$ ~= ADDR(NIL) THEN
      633    17646    3           CALL BUILD_SUM_W_UPON (SUM_CLAUSE$, VAR_LTS$);
      634    17647    3        ELSE
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:76   
      635    17648    3           CALL BUILD_SUM_N_UPON (SUM_CLAUSE$, VAR_LTS$);
      636    17649
      637    17650    3        SUM_CLAUSE$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.LINK;
      638    17651    3      END; /* while */
      639    17652
      640    17653    2    END PROCESS_SUM;
      641    17654         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:77   
      642    17655
      643    17656         /*=============*/
      644    17657    1      PROCESS_RESET: PROC (SUM_CLAUSE$, VAR_LTS$);
      645    17658         /*=============*/
      646    17659
      647    17660        /*I*
      648    17661
      649    17662             NAME:  PROCESS_RESET
      650    17663
      651    17664          DESCRIPTION: This routine validate the RESET phrase against the
      652    17665                       CONTROL clause  in RD entry and call SET_SUM_ZERO
      653    17666                       to get a LX_ETT item of the sum counter and then links
      654    17667                       it on the CONTROL_NAME_LTS, at the later time this
      655    17668                       LX_ETT item will be used to generate the sum counter
      656    17669                       resetting routine.
      657    17670        */
      658    17671
      659    17672
      660    17673    2      DCL SUM_CLAUSE$         PTR;
      661    17674    2      DCL VAR_LTS$            PTR;
      662    17675    2      DCL CTR_LTS$            PTR;
      663    17676    2      DCL LX_ETT$             PTR;
      664    17677
      665    17678
      666    17679
      667    17680    2      IF SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.B.RESET_FINAL THEN
      668    17681    3        DO;
      669    17682    3          IF NOT O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.B.CONTROL_FINAL THEN
      670    17683
      671    17684    3            CALL Z8AE$ERROR (%E$ONLY_CONTROL_FINAL_IN_RD,
      672    17685    3                  SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_RESET$ -> LX_ITEM.LINE,
      673    17686    3                  SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_RESET$ -> LX_ITEM.COLUMN);
      674    17687
      675    17688    3          ELSE
      676    17689    4            DO;
      677    17690    4              CALL SET_SUM_ZERO (VAR_LTS$,
      678    17691    4                                 LX_ETT$);
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:78   
      679    17692
      680    17693    4              LX_ETT$ -> LX_ETT_ITEM.LINK = O1COM.CURRENT_REPORT_LTS$
      681    17694    4                  -> REPORT_LTS.CONTROL_FINAL$ -> CONTROL_NAME_LTS.SUM_RESET$;
      682    17695    4              O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.CONTROL_FINAL$ ->
      683    17696    4                  CONTROL_NAME_LTS.SUM_RESET$ = LX_ETT$;
      684    17697
      685    17698    4            END;
      686    17699    3        END;
      687    17700    2      ELSE
      688    17701    3        DO;
      689    17702    3          CALL CONTROL_NAME_CHECK (SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_RESET$,
      690    17703    3                                   CTR_LTS$)
      691    17704    3            WHENALTRETURN
      692    17705    4              DO;
      693    17706    4                GOTO LAST_STEP;
      694    17707    4              END;
      695    17708
      696    17709    3          CALL SET_SUM_ZERO (VAR_LTS$,
      697    17710    3                             LX_ETT$);
      698    17711
      699    17712    3          LX_ETT$ -> LX_ETT_ITEM.LINK = CTR_LTS$ ->
      700    17713    3                                          CONTROL_NAME_LTS.SUM_RESET$;
      701    17714    3          CTR_LTS$ -> CONTROL_NAME_LTS.SUM_RESET$ = LX_ETT$;
      702    17715    3        END;
      703    17716
      704    17717    2      LAST_STEP:
      705    17718    2        CALL Z8ED$DISPOSE_ABSSYN_TREE(SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_RESET$);
      706    17719
      707    17720    2    END PROCESS_RESET;
      708    17721         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:79   
      709    17722
      710    17723         /*============*/
      711    17724    1      SET_SUM_ZERO: PROC (VAR_LTS$, LX_ETT$);
      712    17725         /*============*/
      713    17726
      714    17727        /*I*
      715    17728             NAME:  SET_SUM_ZERO
      716    17729
      717    17730          DESCRIPTION: This routine creates a LX_ETT_ITEM of the sum counter
      718    17731                       and set the bit SUM_LTS.B.RESETED on.
      719    17732        */
      720    17733
      721    17734
      722    17735    2      DCL VAR_LTS$        PTR;
      723    17736    2      DCL LX_ETT$         PTR;
      724    17737
      725    17738
      726    17739
      727    17740           %NEW_HEAP (@POINTER = LX_ETT$);
      728    17745
      729    17746
      730    17747           %INIT_LX_ETT_ITEM (@POINTER = LX_ETT$,
      731    17748                              @TYPE    = %TYD,
      732    17749                              @ETT$    =
             17749                                 VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.SUM_ST_ILL$
             17749                                  ,
      733    17750                              @LINE    = VAR_LTS$ -> REPORT_ELEM_LTS.ST$ -> ST.LINE_NO,
      734    17751                              @COLUMN  = 0);
      735    17773
      736    17774    2      VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.B.RESETED = TRUE;
      737    17775
      738    17776
      739    17777    2    END SET_SUM_ZERO;
      740    17778         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:80   
      741    17779
      742    17780         /*==================*/
      743    17781    1      CONTROL_NAME_CHECK:  PROC (QUAL_ID$, CTR_LTS$) ALTRET;
      744    17782         /*==================*/
      745    17783
      746    17784        /*I*
      747    17785
      748    17786             NAME:  CONTROL_NAME_CHECK
      749    17787
      750    17788          DESCRIPTION: This routine validate the control name against the
      751    17789                       CONTROL clause  in RD entry and returns the LTS item
      752    17790                       for that control name.
      753    17791        */
      754    17792
      755    17793
      756    17794    2     DCL ST$$              PTR;
      757    17795    2     DCL LTS$$             PTR;
      758    17796    2     DCL QUAL_ID$           PTR;
      759    17797    2     DCL LEN               UBIN HALF UNAL;
      760    17798    2     DCL CTR$              PTR;
      761    17799    2     DCL RSV_WRD#          SBIN WORD;
      762    17800    2     DCL CTR_LTS$          PTR;
      763    17801
      764    17802
      765    17803
      766    17804    2      CALL Z8CO$QUALIFY_VARIABLE (QUAL_ID$, ST$$)
      767    17805    2        WHENALTRETURN
      768    17806    3          DO;
      769    17807    3            IF ST$$ -> SCALAR.B.COMPILER_CREATED THEN
      770    17808    4              DO;
      771    17809    4                ST$$ -> SCALAR.DNT$ -> DNT.ST$ =
      772    17810    4                        ST$$ -> SCALAR.DNT$ -> DNT.ST$ -> ST.NEXT;
      773    17811    4              END;
      774    17812    3            ALTRETURN;
      775    17813    3          END;
      776    17814
      777    17815    2      LTS$$ = O1COM.CURRENT_REPORT_LTS$;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:81   
      778    17816
      779    17817    2      IF LTS$$ -> REPORT_LTS.CONTROL$ = ADDR(NIL) THEN
      780    17818    3        DO;
      781    17819    3          CALL Z8AE$ERROR (%E$NAME_NOT_IN_CONTROL_CLAUSE,
      782    17820    3                           QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      783    17821    3                           QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
      784    17822    3          ALTRETURN;
      785    17823    3        END;
      786    17824
      787    17825    2      IF ST$$ -> SCALAR.B.REPORT_ITEM  THEN
      788    17826    3        DO;
      789    17827    3          CALL Z8AE$ERROR (%E$DCL_IN_REPORT,
      790    17828    3                           QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      791    17829    3                           QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
      792    17830    3          ALTRETURN;
      793    17831    3        END;
      794    17832
      795    17833    2      CTR$ = LTS$$ -> REPORT_LTS.CONTROL$;
      796    17834    2      LEN = CTR$ -> LTS_PTR_ARRAY.N - 3;
      797    17835
      798    17836    3      DO I = 1 TO LEN;
      799    17837    3        IF ST$$ = CTR$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.ST$ THEN
      800    17838    3          GOTO NEXT_STEP;
      801    17839    3      END;
      802    17840    2      CALL Z8AE$ERROR (%E$NAME_NOT_IN_CONTROL_CLAUSE,
      803    17841    2                       QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      804    17842    2                       QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
      805    17843    2      ALTRETURN;
      806    17844
      807    17845    2    NEXT_STEP:
      808    17846    2      CTR_LTS$ = CTR$ -> LTS_PTR_ARRAY.P$(I);
      809    17847
      810    17848    2    END CONTROL_NAME_CHECK;
      811    17849         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:82   
      812    17850
      813    17851         /*================*/
      814    17852    1      BUILD_SUM_W_UPON: PROC (SUM_CLAUSE$, VAR_LTS$);
      815    17853         /*================*/
      816    17854
      817    17855        /*I*
      818    17856
      819    17857             NAME:  BUILD_SUM_W_UPON
      820    17858
      821    17859          DESCRIPTION: This routine validates the UPON phrase and checks
      822    17860                       items in the SUM clause and then an abstract syntax
      823    17861                       tree for a "plus" operation is built that will add
      824    17862                       the items in the SUM clause to the sum counter on
      825    17863                       the run time, in the later time this tree will be
      826    17864                       used to generate the special subtotalling subroutine.
      827    17865        */
      828    17866
      829    17867
      830    17868    2   DCL SUM_CLAUSE$         PTR;
      831    17869    2   DCL VAR_LTS$            PTR;
      832    17870    2   DCL UPON_LTS$          PTR;
      833    17871    2   DCL LX_ETT$            PTR;
      834    17872    2   DCL ST$$               PTR;
      835    17873    2   DCL UPON$$             PTR;
      836    17874    2   DCL HEAP$$             PTR;
      837    17875    2   DCL OP$                PTR;
      838    17876    2   DCL TREE$              PTR;
      839    17877    2   DCL SUM_LX_ETT$        PTR;
      840    17878    2   DCL LINE_NO#           SBIN WORD;
      841    17879
      842    17880
      843    17881    2          LINE_NO# = VAR_LTS$ -> REPORT_ELEM_LTS.ST$ -> ST.LINE_NO;
      844    17882    2          LX_ETT$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$ -> LX_LIST.HEAD$;
      845    17883
      846    17884    3      DO WHILE (LX_ETT$ ~= ADDR(NIL));
      847    17885
      848    17886    4        DO CASE (LX_ETT$ -> LX_ETT_ITEM.TYPE);
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:83   
      849    17887
      850    17888    4          CASE (
      851    17889                     %SET_OF_NUMERIC_TYPES;
      852    17892    4               );
      853    17893
      854    17894                   %FISH (TRIAD = LX_ETT$ -> LX_ETT_ITEM.ETT$,
      855    17895                          RTN   = ST$$);
      856    17903
      857    17904    4              IF ST$$ -> SCALAR.B.REPORT_ITEM THEN
      858    17905
      859    17906    4                CALL Z8AE$ERROR (%E$REP_ITEM_W_UPON,
      860    17907    4                                 LX_ETT$ -> LX_ITEM.LINE,
      861    17908    4                                 LX_ETT$ -> LX_ITEM.COLUMN);
      862    17909
      863    17910    4          CASE (ELSE);
      864    17911
      865    17912    4              CALL Z8AE$ERROR (%E$NUMERIC_TYPE_EXPECTED,
      866    17913    4                               LX_ETT$ -> LX_ITEM.LINE,
      867    17914    4                               LX_ETT$ -> LX_ITEM.COLUMN);
      868    17915
      869    17916    4              LX_ETT$ -> LX_ETT_ITEM.ETT$ = COMCOM.VALUE_0;
      870    17917    4              LX_ETT$ -> LX_ETT_ITEM.TYPE = %TYI;
      871    17918
      872    17919    4        END; /* DO CASE */
      873    17920
      874    17921    3        LX_ETT$ = LX_ETT$ -> LX_ITEM.LINK;
      875    17922
      876    17923    3      END; /* WHILE */
      877    17924
      878    17925    2      UPON$$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_UPON$ -> LX_LIST.HEAD$;
      879    17926
      880    17927    3      DO WHILE (UPON$$ ~= ADDR(NIL));
      881    17928
      882    17929    3        CALL Z8CO$QUALIFY_VARIABLE (UPON$$, ST$$);
      883    17930
      884    17931    3        IF ST$$ -> ST.ID ~= %SCALAR OR
      885    17932    3           NOT ST$$ -> SCALAR.B.REPORT_ITEM THEN
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:84   
      886    17933    3          UPON_LTS$ = ADDR(NIL);
      887    17934    3        ELSE
      888    17935    3          IF ST$$ -> SCALAR.LTS$ = ADDR(NIL) THEN
      889    17936    3            UPON_LTS$ = ADDR(NIL);
      890    17937    3          ELSE
      891    17938                 %GET_LTS (@ID    = %REPORT_01_LTS,
      892    17939                           @ST$   = ST$$,
      893    17940                           @RETURN$ = UPON_LTS$);
      894    17983
      895    17984    3        IF UPON_LTS$ = ADDR(NIL)  OR
      896    17985    3          UPON_LTS$ -> LTS.ID ~= %REPORT_01_LTS  OR
      897    17986    3          UPON_LTS$ -> REPORT_01_LTS.GROUP_TYPE ~= %TYPE_DETAIL  OR
      898    17987    3          UPON_LTS$ -> REPORT_01_LTS.REPORT_LTS$ ~= O1COM.CURRENT_REPORT_LTS$ THEN
      899    17988    4          DO;
      900    17989
      901    17990    4            CALL Z8AE$ERROR (%E$MUST_BE_DETAIL_GROUP,
      902    17991    4                             UPON$$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      903    17992    4                             UPON$$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
      904    17993    4          END;
      905    17994    3        ELSE
      906    17995    4          DO;
      907    17996    4            IF UPON$$ -> LX_LIST.LINK = ADDR(NIL) THEN
      908    17997    5              DO;
      909    17998    5                TREE$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$ -> LX_LIST.HEAD$;
      910    17999
      911    18000                     %INIT_LX_LIST (@POINTER = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$
             18000                         );
      912    18010
      913    18011    5              END;
      914    18012    4            ELSE
      915    18013    5              DO;
      916    18014    5                TREE$ = ADDR(NIL);
      917    18015
      918    18016    5                LX_ETT$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$ -> LX_LIST.
             18016                         HEAD$;
      919    18017
      920    18018    6                DO WHILE (LX_ETT$ ~= ADDR(NIL));
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:85   
      921    18019
      922    18020                       %NEW_HEAP (@POINTER = HEAP$$);
      923    18025
      924    18026    6                  HEAP$$ -> LX_ETT_ITEM = LX_ETT$ -> LX_ETT_ITEM;
      925    18027    6                  HEAP$$ -> LX_ETT_ITEM.LINK = TREE$;
      926    18028    6                  TREE$ = HEAP$$;
      927    18029    6                END; /* WHILE */
      928    18030    5              END;  /* DO */
      929    18031
      930    18032    4              HEAP$ = TREE$ -> LX_ETT_ITEM.LINK;
      931    18033    4              TREE$ -> LX_ETT_ITEM.LINK = ADDR(NIL);
      932    18034
      933    18035    5              DO WHILE (HEAP$ ~= ADDR(NIL));
      934    18036
      935    18037                     %NEW (@TEMPLATE = BINARY_OP,
      936    18038                           @POINTER  = OP$);
      937    18048
      938    18049                     %INIT_BINARY_OP (@POINTER = OP$,
      939    18050                                      @BERR    = "HEAP$ -> LX_ITEM.B.ERROR",
      940    18051                                      @LINE    = "HEAP$ -> LX_ITEM.LINE",
      941    18052                                      @COLUMN  = "HEAP$ -> LX_ITEM.COLUMN",
      942    18053                                      @ROP$    = HEAP$,
      943    18054                                      @LOP$    = TREE$,
      944    18055                                      @OP      = %OP_PLUS);
      945    18073
      946    18074    5                TREE$ = HEAP$;
      947    18075    5                HEAP$ = TREE$ -> LX_ITEM.LINK;
      948    18076    5                TREE$ -> LX_ITEM.LINK = ADDR(NIL);
      949    18077    5                TREE$ = OP$;
      950    18078
      951    18079    5              END; /* WHILE */
      952    18080
      953    18081                   %NEW_HEAP (@POINTER = SUM_LX_ETT$);
      954    18086
      955    18087                   %INIT_LX_ETT_ITEM (@POINTER = SUM_LX_ETT$,
      956    18088                                      @TYPE    = %TYD,
      957    18089                      @ETT$ = VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.SUM_ST_ILL$,
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:86   
      958    18090                                      @LINE    = LINE_NO#,
      959    18091                                      @COLUMN  = 0);
      960    18113
      961    18114                     %NEW (@TEMPLATE = BINARY_OP,
      962    18115                           @POINTER  = OP$);
      963    18125
      964    18126                     %INIT_BINARY_OP (@POINTER = OP$,
      965    18127                                      @LINE    = LINE_NO#,
      966    18128                                      @COLUMN  = 0,
      967    18129                                      @ROP$    = TREE$,
      968    18130                                      @LOP$    = SUM_LX_ETT$,
      969    18131                                      @OP      = %OP_PLUS);
      970    18149
      971    18150    4              OP$ -> BINARY_OP.LINK = UPON_LTS$ -> REPORT_01_LTS.SPECIAL_SUBTOTAL$;
      972    18151    4              UPON_LTS$ -> REPORT_01_LTS.SPECIAL_SUBTOTAL$ = OP$;
      973    18152
      974    18153    4            END; /* DO */
      975    18154
      976    18155    3          UPON$$ = UPON$$ -> LX_LIST.LINK;
      977    18156
      978    18157    3        END;
      979    18158
      980    18159
      981    18160
      982    18161
      983    18162    2    RETURN;
      984    18163    2    END BUILD_SUM_W_UPON;
      985    18164         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:87   
      986    18165
      987    18166         /*================*/
      988    18167    1      BUILD_SUM_N_UPON: PROC (SUM_CLAUSE$, VAR_LTS$);
      989    18168         /*================*/
      990    18169
      991    18170        /*I*
      992    18171
      993    18172             NAME:  BUILD_SUM_N_UPON
      994    18173
      995    18174          DESCRIPTION: This routine validate the items in the SUM clause
      996    18175                       then an abstract syntax tree for a "plus" operation
      997    18176                       is built, in the later tim this tree will be used
      998    18177                       to generate the cross footing/rolling forward
      999    18178                       subroutine or the general subtotalling subroutine.
     1000    18179        */
     1001    18180
     1002    18181
     1003    18182    2   DCL SUM_CLAUSE$         PTR;
     1004    18183    2   DCL VAR_LTS$            PTR;
     1005    18184    2   DCL CTR_LTS$           PTR;
     1006    18185    2   DCL LX_ETT$            PTR;
     1007    18186    2   DCL ST$$               PTR;
     1008    18187    2   DCL SUM_BIT_ON         BIT (1) ALIGNED;
     1009    18188    2   DCL ELEM_LTS$          PTR;
     1010    18189    2   DCL OP$                PTR;
     1011    18190    2   DCL ITEM$              PTR;
     1012    18191    2   DCL SUM_LX_ETT$        PTR;
     1013    18192    2   DCL LINE_NO#           SBIN WORD;
     1014    18193
     1015    18194
     1016    18195    2          LINE_NO# = VAR_LTS$ -> REPORT_ELEM_LTS.ST$ -> ST.LINE_NO;
     1017    18196    2          LX_ETT$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$ -> LX_LIST.HEAD$;
     1018    18197
     1019    18198    3      DO WHILE (LX_ETT$ ~= ADDR(NIL));
     1020    18199
     1021    18200    4        DO CASE (LX_ETT$ -> LX_ETT_ITEM.TYPE);
     1022    18201
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:88   
     1023    18202    4          CASE (
     1024    18203                     %SET_OF_NUMERIC_TYPES;
     1025    18206    4               );
     1026    18207
     1027    18208                   %FISH (TRIAD = LX_ETT$ -> LX_ETT_ITEM.ETT$,
     1028    18209                          RTN   = ST$$);
     1029    18217
     1030    18218    4              CALL  REP_ITEM_CHECK (LX_ETT$,
     1031    18219    4                                    SUM_BIT_ON,
     1032    18220    4                                    ELEM_LTS$,
     1033    18221    4                                    %E$SUM_IN_SAME_REPORT);
     1034    18222
     1035    18223    4              IF SUM_BIT_ON THEN
     1036    18224    5                DO;
     1037    18225    5                  CTR_LTS$ = ELEM_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ ->
     1038    18226    5                             SUM_LTS.REPORT_01_LTS$ -> REPORT_01_LTS.CONTROL_LTS$;
     1039    18227    5                  IF CTR_LTS$ -> CONTROL_NAME_LTS.LEVEL <
     1040    18228    5                     VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.REPORT_01_LTS$ ->
     1041    18229    5                     REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_NAME_LTS.LEVEL THEN
     1042    18230    6                    DO;
     1043    18231    6                      CALL Z8AE$ERROR (%E$EQU_OR_LOWER_LVL_SUM,
     1044    18232    6                                       LX_ETT$ -> LX_ITEM.LINE,
     1045    18233    6                                       LX_ETT$ -> LX_ITEM.COLUMN);
     1046    18234
     1047    18235    6                    END;
     1048    18236    5                END;
     1049    18237
     1050    18238    4          CASE (ELSE);
     1051    18239
     1052    18240    4              CALL Z8AE$ERROR (%E$NUMERIC_TYPE_EXPECTED,
     1053    18241    4                               LX_ETT$ -> LX_ITEM.LINE,
     1054    18242    4                               LX_ETT$ -> LX_ITEM.COLUMN);
     1055    18243
     1056    18244    4              LX_ETT$ -> LX_ETT_ITEM.ETT$ = COMCOM.VALUE_0;
     1057    18245    4              LX_ETT$ -> LX_ETT_ITEM.TYPE = %TYI;
     1058    18246    4              SUM_BIT_ON = FALSE;
     1059    18247
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:89   
     1060    18248    4        END; /* DO CASE */
     1061    18249
     1062    18250    3        ITEM$ = LX_ETT$;
     1063    18251    3        LX_ETT$ = ITEM$ -> LX_ITEM.LINK;
     1064    18252    3        ITEM$ -> LX_ITEM.LINK = ADDR(NIL);
     1065    18253
     1066    18254                   %NEW_HEAP (@POINTER = SUM_LX_ETT$);
     1067    18259
     1068    18260                   %INIT_LX_ETT_ITEM (@POINTER = SUM_LX_ETT$,
     1069    18261                                      @TYPE    = %TYD,
     1070    18262                      @ETT$ = VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.SUM_ST_ILL$,
     1071    18263                                      @LINE    = LINE_NO#,
     1072    18264                                      @COLUMN  = 0);
     1073    18286
     1074    18287                     %NEW (@TEMPLATE = BINARY_OP,
     1075    18288                           @POINTER  = OP$);
     1076    18298
     1077    18299                     %INIT_BINARY_OP (@POINTER = OP$,
     1078    18300                                      @LINE    = LINE_NO#,
     1079    18301                                      @COLUMN  = 0,
     1080    18302                                      @ROP$    = ITEM$,
     1081    18303                                      @LOP$    = SUM_LX_ETT$,
     1082    18304                                      @OP      = %OP_PLUS);
     1083    18322
     1084    18323    3              IF SUM_BIT_ON THEN
     1085    18324    4                DO;
     1086    18325    4                  OP$ -> BINARY_OP.LINK = CTR_LTS$ -> CONTROL_NAME_LTS.SUM_SUBTOTAL$;
     1087    18326    4                  CTR_LTS$ -> CONTROL_NAME_LTS.SUM_SUBTOTAL$ = OP$;
     1088    18327
     1089    18328    4                END;
     1090    18329    3              ELSE
     1091    18330    4                DO;
     1092    18331    4                  OP$ -> BINARY_OP.LINK = O1COM.CURRENT_REPORT_LTS$ ->
     1093    18332    4                                          REPORT_LTS.GENERAL_SUBTOTAL$;
     1094    18333    4                  O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.GENERAL_SUBTOTAL$ = OP$;
     1095    18334    4                END;
     1096    18335    3            END; /* WHILE */
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:90   
     1097    18336
     1098    18337               %INIT_LX_LIST (@POINTER = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$);
     1099    18347
     1100    18348    2    END BUILD_SUM_N_UPON;
     1101    18349         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:91   
     1102    18350
     1103    18351         /*=============*/
     1104    18352    1      GENERATE_SUBS: PROC;
     1105    18353         /*=============*/
     1106    18354
     1107    18355        /*I*
     1108    18356
     1109    18357             NAME:  GENERATE_SUBS
     1110    18358
     1111    18359          DESCRIPTION: This routine steps through the COMCOM.FILE_LTS_CHAIN$
     1112    18360                       and generates all the run time subroutines for every
     1113    18361                       report on the top of the procedure division. Reason
     1114    18362                       to do that is to solve the problem of phase 1 heap
     1115    18363                       not returned, or else the run time subroutines will be
     1116    18364                       generated on processing the INITIATE statement.
     1117    18365        */
     1118    18366
     1119    18367    2   DCL FILE_LTS$          PTR;
     1120    18368    2   DCL REP_LTS$           PTR;
     1121    18369    2   DCL LABEL$             PTR;
     1122    18370
     1123    18371
     1124    18372
     1125    18373    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, LABEL$);
     1126    18374
     1127    18375    2          CALL Z8EK$BRANCH (LABEL$);
     1128    18376
     1129    18377    2          FILE_LTS$ = COMCOM.FILE_LTS_CHAIN$;
     1130    18378
     1131    18379    3          DO WHILE(FILE_LTS$ ~= ADDR(NIL));
     1132    18380
     1133    18381    3            IF FILE_LTS$ -> FILE_LTS.REPORT$ ~= ADDR(NIL) THEN
     1134    18382    4              DO;
     1135    18383    4                REP_LTS$ = FILE_LTS$ -> FILE_LTS.REPORT$;
     1136    18384
     1137    18385    5                DO WHILE (REP_LTS$ ~= ADDR(NIL));
     1138    18386
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:92   
     1139    18387    5                  IF REP_LTS$ -> REPORT_LTS.PAGE_COUNTER$ ~= ADDR(NIL) AND
     1140    18388    5                     NOT REP_LTS$ -> REPORT_LTS.B.REFERENCED THEN
     1141    18389    6                    DO;
     1142    18390    6                      REP_LTS$ -> REPORT_LTS.B.REFERENCED = TRUE;
     1143    18391
     1144    18392    6                      CALL Z8ET$CREATE_SUBROUTINES (REP_LTS$);
     1145    18393    6                    END;
     1146    18394
     1147    18395    5                    REP_LTS$ = REP_LTS$ -> REPORT_LTS.LINK;
     1148    18396
     1149    18397    5                END; /* WHILE */
     1150    18398    4            END;  /* IF */
     1151    18399
     1152    18400    3            FILE_LTS$ = FILE_LTS$ -> FILE_LTS.FILE_LTS_CHAIN$;
     1153    18401    3          END; /* WHILE */
     1154    18402
     1155    18403               %NEW_ILL (@ID     = %DEFLB,
     1156    18404                         @LABEL$ = LABEL$);
     1157    18783
     1158    18784    2    END GENERATE_SUBS;
     1159    18785         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:93   
     1160    18786
     1161    18787         /* main routine */
     1162    18788
     1163    18789    1      CALL CREATE_SOURCE_ETT;
     1164    18790
     1165    18791    1      CALL CREATE_REPORT_SUM;
     1166    18792
     1167    18793    1    END Z8ET$DEFERED_SUM_AND_SOURCE;
     1168    18794         %EOD;

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:94   
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8D_PIC_PARM.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$DEFERED_SUM_AND_SOURCE.

   Procedure Z8ET$DEFERED_SUM_AND_SOURCE requires 1076 words for executable code.
   Procedure Z8ET$DEFERED_SUM_AND_SOURCE requires 40 words of local(AUTO) storage.

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:95   

 Object Unit name= Z8ET$DEFERED_SUM_AND_SOURCE                File name= Z8ET.:Z8A6TOU
 UTS= AUG 09 '97 12:45:02.36 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ST$
    2  LblCom even  none     5      5  ST_
    3  LblCom even  none     1      1  QLT$
    4  LblCom even  none     1      1  PREV_01_QLT$
    5  LblCom even  none     5      5  QLT_
    6  LblCom even  none     1      1  LTS$
    7  LblCom even  none     5      5  LTS_
    8  LblCom even  none     1      1  DNT$
    9  LblCom even  none     5      5  DNT_
   10  LblCom even  none     1      1  DNT_BUCKET_NUMBER
   11  LblCom even  none     1      1  DNT_OF_1$
   12  LblCom even  none     1      1  ILL$
   13  LblCom even  none     5      5  ILL_
   14  LblCom even  none     1      1  ETT$
   15  LblCom even  none     1      1  HEAD_ETT$
   16  LblCom even  none   512   1000  ETT_BUCKETS
   17  LblCom even  none     5      5  ETT_
   18  LblCom even  none     2      2  MKCN
   19  LblCom even  none    90    132  LEX_SYMBOL
   20  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   21  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   22  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   23  LblCom even  none     1      1  HEAP$
   24  LblCom even  none     8     10  TEMP_LX_NODE
   25   Proc  even  none  1076   2064  Z8ET$DEFERED_SUM_AND_SOURCE
   26  RoData even  none    36     44  Z8ET$DEFERED_SUM_AND_SOURCE
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:96   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    25      0   yes            yes      Std        0  Z8ET$DEFERED_SUM_AND_SOURCE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8ET$PROCESS_TREE
         yes           Std       1 Z8ED$DISPOSE_ABSSYN_TREE
         yes           Std      12 Z8AE$ERROR
         yes           Std       2 Z8ED$NEW_HEAP
 yes     yes           Std       2 Z8CO$QUALIFY_VARIABLE
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       1 Z8EK$BRANCH
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       1 Z8ET$CREATE_SUBROUTINES
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    LTS_STEP                         r    ILL_STEP
     O1COM                                 HIER_STK_PTR                          HIER_STK
     PAGE_FORMAT                           REP_STK_PTR                           REP_STK
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:97   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:98   


      356        1        /*T***********************************************************/
      357        2        /*T*                                                         */
      358        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      359        4        /*T*                                                         */
      360        5        /*T***********************************************************/
      361        6
      362        7        /*M*  Z8ET$DEFERED_SUM_AND_SOUCE---for SUM and SOURCE clause*/
      363        8
      364        9
      365       10        /*P*
      366       11               NAME:  Z8ET$DEFERED_SUM_AND_SOURCE
      367       12             AUTHOR:  Min Lee.
      368       13            PURPOSE:  Wrap up the SUM clause and the SOURCE clause in the
      369       14                      REPORT SECTION of the DATA DIVISION.
      370       15        */
      371       16
      372       17        /*D*
      373       18               NAME:  Z8ET$DEFERED_SUM_AND_SOURCE
      374       19               CALL:  CALL Z8ET$DEFERED_SUM_AND_SOURCE
      375       20              INPUT:  O1COM.REPORT_SOURCE$, O1COM.REPORT_SUM$.
      376       21
      377       22
      378       23
      379       24        DESCRIPTION:  1. Call Z8ET$PROCESS_TREE to create the ETT tree of the
      380       25                         identifiers in the SUM and SOURCE clause .
      381       26                      2. Generates all the ETT and LX_ETT items for the Special
      382       27                         Subtotaling Subroutine, General Subtotaling Subroutine,
      383       28                         Cross Footing/Rolling Forward Subroutine, Sum Counter
      384       29                         Resetting Subroutine.
      385       30                      3. Call Z8ET$CREATE_SUBROUTINES to create all the
      386       31                         subroutines that will be excuted by the RWCS.
      387       32         */
      388       33         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:99   
      389       34
      390       35         Z8ET$DEFERED_SUM_AND_SOURCE: PROC;

     35 25 000000   000000 700200 xent  Z8ET$DEFERE* TSX0  ! X66_AUTO_0
        25 000001   000050 000000                    ZERO    40,0
        25 000002   002057 710000 25                 TRA     s:18789

      391       36
      392       37
      393       38
      394       39        %EQU PHASE = 1;
      395       40        %INCLUDE Z8A_DEFC;
      396      108        %INCLUDE Z8A_SUPP_MAC;
      397     2508        %INCLUDE Z8A_COMCOM;
      398     3158        %INCLUDE Z8A_ST;
      399     6817        %INCLUDE Z8A_QLT;
      400     6923        %INCLUDE Z8A_LTS;
      401     9000        %INCLUDE Z8A_TYPES;
      402     9174        %INCLUDE Z8A_DNT;
      403     9395        %INCLUDE Z8A_ERR_NUMS;
      404    10159        %INCLUDE Z8A_ILL;
      405    10852        %INCLUDE Z8A_ETT;
      406    11153        %INCLUDE Z8A_MKCN;
      407    11170
      408    11171        %INCLUDE Z8E_STACKS;
      409    13437        %INCLUDE Z8E_WINDOW;
      410    15507        %INCLUDE Z8E_O1COM;
      411    16268        %INCLUDE Z8E_MACROS;
      412    16943        %INCLUDE Z8D_PIC_PARM;
      413    17049        %INCLUDE Z8E_HEAP;
      414    17105        %INCLUDE Z8E_ABSSYN;
      415    17311        %INCLUDE Z8E_STATEMNT;
      416    17380
      417    17381    1   DCL Z8AE$ERROR     ENTRY (12);
      418    17382    1   DCL Z8CO$QUALIFY_VARIABLE ENTRY (2) ALTRET;
      419    17383    1   DCL Z8ET$PROCESS_TREE    ENTRY (1);
      420    17384    1   DCL Z8ED$DISPOSE_ABSSYN_TREE  ENTRY (1);
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:100  
      421    17385    1   DCL Z8AT$CREATE_TEMPORARY  ENTRY (2);
      422    17386    1   DCL Z8EK$BRANCH    ENTRY (1);
      423    17387    1   DCL Z8ET$CREATE_SUBROUTINES  ENTRY(1);
      424    17388    1   DCL ASSOC_01_LTS$     PTR;
      425    17389    1   DCL I              SBIN WORD;
      426    17390
      427    17391
      428    17392
      429    17393
      430    17394        %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:101  
      431    17395
      432    17396         /*=================*/
      433    17397    1      CREATE_SOURCE_ETT:  PROC;

  17397 25 000003   200006 741300       CREATE_SOUR* STX1  ! I+2,,AUTO

      434    17398         /*=================*/
      435    17399
      436    17400        /*I*
      437    17401
      438    17402             NAME:  CREATE_SOURCE_ETT
      439    17403
      440    17404          PURPOSE: Process the SOURCE clauses.
      441    17405
      442    17406             CALL: CALL CREATE_SOURCE_ETT.
      443    17407
      444    17408            INPUT: O1COM.REPORT_SOURCE$--Point to a list of DEFERED_IDENTIFIER
      445    17409                   items that contain the SOURCE clauses' informations.
      446    17410          DESCRIPTION: This routine steps through the O1COM.REPORT_SOURCE$
      447    17411                       chain to get the identifier in each SOURCE clause and
      448    17412                       calls Z8ET$PROCESS_TREE to create the ETT tree for it.
      449    17413                       Also to flag it as an error if it is a report item but
      450    17414                       not a sum counter or is a sum counter nit in same report.
      451    17415
      452    17416        */
      453    17417
      454    17418
      455    17419    2      DCL LTS$$           PTR;
      456    17420    2      DCL NEXT$           PTR;
      457    17421    2       DCL SUM_BIT        BIT (1) ALIGNED;
      458    17422    2       DCL ELEM_LTS$      PTR;
      459    17423
      460    17424    2      NEXT$ = O1COM.REPORT_SOURCE$;

  17424 25 000004   000066 236000 xsym               LDQ     O1COM+54
        25 000005   200010 756100                    STQ     NEXT$,,AUTO

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:102  
      461    17425
      462    17426    3      DO WHILE (NEXT$ ~= ADDR(NIL));

  17426 25 000006   000052 710000 25                 TRA     s:17442

      463    17427
      464    17428    3        LTS$$ = NEXT$ -> DEFERED_IDENTIFIER.ASSOC_VAR_LTS$;

  17428 25 000007   200010 470500                    LDP0    NEXT$,,AUTO
        25 000010   000002 236100                    LDQ     2,,PR0
        25 000011   200007 756100                    STQ     LTS$$,,AUTO

      465    17429    3        O1COM.CURRENT_REPORT_LTS$ = NEXT$ -> DEFERED_IDENTIFIER.ASSOC_REPORT_LTS$;

  17429 25 000012   000003 236100                    LDQ     3,,PR0
        25 000013   000064 756000 xsym               STQ     O1COM+52

      466    17430
      467    17431    3        CALL Z8ET$PROCESS_TREE (NEXT$ -> DEFERED_IDENTIFIER.DEFERED_ID$);

  17431 25 000014   200010 236100                    LDQ     NEXT$,,AUTO
        25 000015   000001 036003                    ADLQ    1,DU
        25 000016   200042 756100                    STQ     ST$$+1,,AUTO
        25 000017   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000020   000000 631400 26                 EPPR1   0
        25 000021   000000 701000 xent               TSX1    Z8ET$PROCESS_TREE
        25 000022   000000 011000                    NOP     0

      468    17432
      469    17433    3        LTS$$ -> REPORT_ELEM_LTS.SOURCE_ETT$ =

  17433 25 000023   200010 470500                    LDP0    NEXT$,,AUTO
        25 000024   000001 471500                    LDP1    1,,PR0
        25 000025   100001 236100                    LDQ     1,,PR1
        25 000026   200007 473500                    LDP3    LTS$$,,AUTO
        25 000027   300011 756100                    STQ     9,,PR3

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:103  
      470    17434    3                 NEXT$ -> DEFERED_IDENTIFIER.DEFERED_ID$ -> LX_ETT_ITEM.ETT$;
      471    17435
      472    17436    3        IF NOT NEXT$ -> DEFERED_IDENTIFIER.DEFERED_ID$ -> LX_ETT_ITEM.B.ERROR THEN

  17436 25 000030   000001 471500                    LDP1    1,,PR0
        25 000031   100000 236100                    LDQ     0,,PR1
        25 000032   400000 316007                    CANQ    -131072,DL
        25 000033   000047 601000 25                 TNZ     s:17441

      473    17437    3          CALL REP_ITEM_CHECK (NEXT$ -> DEFERED_IDENTIFIER.DEFERED_ID$,

  17437 25 000034   000002 236000 26                 LDQ     2
        25 000035   200040 756100                    STQ     @ELEM_LTS$+1,,AUTO
        25 000036   200012 631500                    EPPR1   ELEM_LTS$,,AUTO
        25 000037   200037 451500                    STP1    @SUM_BIT+1,,AUTO
        25 000040   200011 634500                    EPPR4   SUM_BIT,,AUTO
        25 000041   200036 454500                    STP4    RSV_WRD#+1,,AUTO
        25 000042   200010 236100                    LDQ     NEXT$,,AUTO
        25 000043   000001 036003                    ADLQ    1,DU
        25 000044   200035 756100                    STQ     CTR$+1,,AUTO
        25 000045   000062 701000 25                 TSX1    REP_ITEM_CHECK
        25 000046   000000 011000                    NOP     0

      474    17438    3                               SUM_BIT,
      475    17439    3                               ELEM_LTS$,
      476    17440    3                               %E$MUST_SUM_IN_SAME_REPORT);
      477    17441    3        NEXT$ = NEXT$ -> DEFERED_IDENTIFIER.LINK;

  17441 25 000047   200010 470500                    LDP0    NEXT$,,AUTO
        25 000050   000007 236100                    LDQ     7,,PR0
        25 000051   200010 756100                    STQ     NEXT$,,AUTO

      478    17442    3      END;  /* while */

  17442 25 000052   000003 116000 26                 CMPQ    3
        25 000053   000007 601000 25                 TNZ     s:17428

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:104  
      479    17443
      480    17444    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (O1COM.REPORT_SOURCE$);

  17444 25 000054   000004 630400 26                 EPPR0   4
        25 000055   000000 631400 26                 EPPR1   0
        25 000056   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        25 000057   000000 011000                    NOP     0

      481    17445
      482    17446    2    END CREATE_SOURCE_ETT;

  17446 25 000060   200006 221300                    LDX1  ! I+2,,AUTO
        25 000061   000001 702211                    TSX2  ! 1,X1

      483    17447         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:105  
      484    17448
      485    17449         /*==============*/
      486    17450    1      REP_ITEM_CHECK: PROC (LX_ETT$, SUM_BIT, ELEM_LTS$, ERR_NUMBER);

  17450 25 000062   200034 741300       REP_ITEM_CH* STX1  ! LINE_NO#+1,,AUTO

      487    17451         /*==============*/
      488    17452
      489    17453        /*I*
      490    17454
      491    17455             NAME:  REPORT_ITEM_CHECK
      492    17456
      493    17457          PURPOSE: Verify a report item in the SOURCE or SUM clause.
      494    17458
      495    17459             CALL: CALL REPORT_ITEM_CHECK(LX_ETT$, SUM_BIT, ELEM_LTS$, ERR_NUMBER)
      496    17460
      497    17461            INPUT: LX_ETT$--ETT tree of the identifier.
      498    17462                   ELEM_LTS$--LTS item associate with the report item.
      499    17463                   ERR_NUMBER-- error number of the error message.
      500    17464           OUTPUT: SUM_BIT--a bit will be set 'on' for a valid sum counter.
      501    17465          DESCRIPTION: If the identifier is a report item but is not a sum
      502    17466                       counter or is a sum counter but not in the same report
      503    17467                       then a error message will be issued.
      504    17468                       If it is a valid sum counter the set the SUM_BIT on.
      505    17469
      506    17470        */
      507    17471
      508    17472
      509    17473    2   DCL LX_ETT$        PTR;
      510    17474    2   DCL SUM_BIT        BIT (1) ALIGNED;
      511    17475    2   DCL ELEM_LTS$      PTR;
      512    17476    2   DCL ST$$           PTR;
      513    17477    2   DCL ERR_NUMBER     UBIN WORD;
      514    17478
      515    17479
      516    17480    2          SUM_BIT = FALSE;

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:106  
  17480 25 000063   200036 470500                    LDP0    @SUM_BIT,,AUTO
        25 000064   000000 450100                    STZ     0,,PR0

      517    17481
      518    17482               %FISH (TRIAD = LX_ETT$ -> LX_ETT_ITEM.ETT$,
      519    17483                      RTN   = ST$$);

  17485 25 000065   200035 471500                    LDP1    @LX_ETT$,,AUTO
        25 000066   100000 473500                    LDP3    0,,PR1
        25 000067   300001 236100                    LDQ     1,,PR3
        25 000070   200041 756100                    STQ     ST$$,,AUTO

  17486 25 000071   200041 474500                    LDP4    ST$$,,AUTO
        25 000072   400000 220100                    LDX0    0,,PR4
        25 000073   000751 100003                    CMPX0   489,DU
        25 000074   000104 603000 25                 TRC     s:17492

  17487 25 000075   200041 470500                    LDP0    ST$$,,AUTO
        25 000076   000001 236100                    LDQ     1,,PR0
        25 000077   200041 756100                    STQ     ST$$,,AUTO

  17488 25 000100   200041 470500                    LDP0    ST$$,,AUTO
        25 000101   000000 220100                    LDX0    0,,PR0
        25 000102   000751 100003                    CMPX0   489,DU
        25 000103   000075 602000 25                 TNC     s:17487

      520    17491
      521    17492    2          IF ST$$ -> SCALAR.B.REPORT_ITEM THEN

  17492 25 000104   200041 470500                    LDP0    ST$$,,AUTO
        25 000105   000003 236100                    LDQ     3,,PR0
        25 000106   010000 316007                    CANQ    4096,DL
        25 000107   000204 600000 25                 TZE     s:17563

      522    17493    3            DO;

      523    17494    3              IF ST$$ -> SCALAR.B.SUM_COUNTER THEN
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:107  

  17494 25 000110   004000 316007                    CANQ    2048,DL
        25 000111   000170 600000 25                 TZE     s:17557

      524    17495    4                DO;

      525    17496
      526    17497                       %GET_LTS (@ID     = %REPORT_ELEM_LTS,
      527    17498                                 @ST$    = ST$$,
      528    17499                                 @RETURN$ = ELEM_LTS$);

  17501 25 000112   000005 236100                    LDQ     5,,PR0
        25 000113   000003 116000 26                 CMPQ    3
        25 000114   000125 600000 25                 TZE     s:17535
        25 000115   000005 471500                    LDP1    5,,PR0
        25 000116   100000 220100                    LDX0    0,,PR1
        25 000117   001105 100003                    CMPX0   581,DU
        25 000120   000125 601000 25                 TNZ     s:17535

  17523 25 000121   100007 236100                    LDQ     7,,PR1
        25 000122   200037 473500                    LDP3    @ELEM_LTS$,,AUTO
        25 000123   300000 756100                    STQ     0,,PR3

  17533 25 000124   000141 710000 25                 TRA     s:17543

  17535 25 000125   000003 116000 26                 CMPQ    3
        25 000126   000136 600000 25                 TZE     s:17539
        25 000127   000005 471500                    LDP1    5,,PR0
        25 000130   100000 220100                    LDX0    0,,PR1
        25 000131   001102 100003                    CMPX0   578,DU
        25 000132   000136 601000 25                 TNZ     s:17539

  17537 25 000133   200037 473500                    LDP3    @ELEM_LTS$,,AUTO
        25 000134   300000 756100                    STQ     0,,PR3
        25 000135   000141 710000 25                 TRA     s:17543

  17539 25 000136   000003 236000 26                 LDQ     3
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:108  
        25 000137   200037 471500                    LDP1    @ELEM_LTS$,,AUTO
        25 000140   100000 756100                    STQ     0,,PR1

      529    17542
      530    17543    4                  IF ELEM_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.REPORT_LTS$ ~=

  17543 25 000141   200037 471500                    LDP1    @ELEM_LTS$,,AUTO
        25 000142   100000 473500                    LDP3    0,,PR1
        25 000143   300012 474500                    LDP4    10,,PR3
        25 000144   400005 236100                    LDQ     5,,PR4
        25 000145   000064 116000 xsym               CMPQ    O1COM+52
        25 000146   000164 600000 25                 TZE     s:17551

      531    17544    4                          O1COM.CURRENT_REPORT_LTS$ THEN
      532    17545    5                    DO;

      533    17546    5                      CALL Z8AE$ERROR (ERR_NUMBER,

  17546 25 000147   200035 475500                    LDP5    @LX_ETT$,,AUTO
        25 000150   500000 476500                    LDP6    0,,PR5
        25 000151   600006 637500                    EPPR7   6,,PR6
        25 000152   200044 457500                    STP7    ST$$+3,,AUTO
        25 000153   600005 633500                    EPPR3   5,,PR6
        25 000154   200043 453500                    STP3    ST$$+2,,AUTO
        25 000155   200040 236100                    LDQ     @ERR_NUMBER,,AUTO
        25 000156   200042 756100                    STQ     ST$$+1,,AUTO
        25 000157   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000160   000005 631400 26                 EPPR1   5
        25 000161   000000 701000 xent               TSX1    Z8AE$ERROR
        25 000162   000000 011000                    NOP     0

      534    17547    5                                       LX_ETT$ -> LX_ETT_ITEM.LINE,
      535    17548    5                                       LX_ETT$ -> LX_ETT_ITEM.COLUMN);
      536    17549    5                    END;

  17549 25 000163   000204 710000 25                 TRA     s:17563

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:109  
      537    17550    4                  ELSE
      538    17551    4                    SUM_BIT = TRUE;

  17551 25 000164   400000 236003                    LDQ     -131072,DU
        25 000165   200036 475500                    LDP5    @SUM_BIT,,AUTO
        25 000166   500000 756100                    STQ     0,,PR5

      539    17552
      540    17553    4                END;

  17553 25 000167   000204 710000 25                 TRA     s:17563

      541    17554
      542    17555    3              ELSE
      543    17556    4                DO;

      544    17557    4                  CALL Z8AE$ERROR (ERR_NUMBER,

  17557 25 000170   200035 471500                    LDP1    @LX_ETT$,,AUTO
        25 000171   100000 473500                    LDP3    0,,PR1
        25 000172   300006 634500                    EPPR4   6,,PR3
        25 000173   200044 454500                    STP4    ST$$+3,,AUTO
        25 000174   300005 635500                    EPPR5   5,,PR3
        25 000175   200043 455500                    STP5    ST$$+2,,AUTO
        25 000176   200040 236100                    LDQ     @ERR_NUMBER,,AUTO
        25 000177   200042 756100                    STQ     ST$$+1,,AUTO
        25 000200   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000201   000005 631400 26                 EPPR1   5
        25 000202   000000 701000 xent               TSX1    Z8AE$ERROR
        25 000203   000000 011000                    NOP     0

      545    17558    4                                   LX_ETT$ -> LX_ETT_ITEM.LINE,
      546    17559    4                                   LX_ETT$ -> LX_ETT_ITEM.COLUMN);
      547    17560    4                END;

      548    17561    3            END;

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:110  
      549    17562
      550    17563    2    END REP_ITEM_CHECK;

  17563 25 000204   200034 221300                    LDX1  ! LINE_NO#+1,,AUTO
        25 000205   000001 702211                    TSX2  ! 1,X1

      551    17564         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:111  
      552    17565
      553    17566
      554    17567         /*=================*/
      555    17568    1      CREATE_REPORT_SUM: PROC;

  17568 25 000206   200006 741300       CREATE_REPO* STX1  ! I+2,,AUTO

      556    17569         /*=================*/
      557    17570
      558    17571        /*I*
      559    17572
      560    17573             NAME:  CREATE_REPORT_SUM
      561    17574
      562    17575          DESCRIPTION: This routine steps through the O1COM.REPORT_SUM$ list
      563    17576                       which chains all the DEFERED_SUM_CLAUSE_LIST that
      564    17577                       containing the informations of the SUM clauses of a sum
      565    17578                       counter and call PROCESS_SUM to process it and then,
      566    17579                       call GENERATE_SUBS  to generate the run time subroutines.
      567    17580        */
      568    17581
      569    17582
      570    17583    2      DCL NEXT$           PTR;
      571    17584
      572    17585
      573    17586
      574    17587    2        NEXT$ = O1COM.REPORT_SUM$;

  17587 25 000207   000070 236000 xsym               LDQ     O1COM+56
        25 000210   200007 756100                    STQ     NEXT$,,AUTO

      575    17588
      576    17589    3      DO WHILE (NEXT$ ~= ADDR(NIL));

  17589 25 000211   000232 710000 25                 TRA     s:17598

      577    17590
      578    17591    3       O1COM.CURRENT_REPORT_LTS$ = NEXT$ -> DEFERED_SUM_CLAUSE_LIST.ASSOC_REPORT_LTS$;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:112  

  17591 25 000212   200007 470500                    LDP0    NEXT$,,AUTO
        25 000213   000003 236100                    LDQ     3,,PR0
        25 000214   000064 756000 xsym               STQ     O1COM+52

      579    17592    3        ASSOC_01_LTS$ = NEXT$ -> DEFERED_SUM_CLAUSE_LIST.ASSOC_01_LTS$;

  17592 25 000215   000004 236100                    LDQ     4,,PR0
        25 000216   200003 756100                    STQ     ASSOC_01_LTS$,,AUTO

      580    17593
      581    17594    3        CALL PROCESS_SUM (NEXT$ -> DEFERED_SUM_CLAUSE_LIST.SUM_CLAUSE_LIST$,

  17594 25 000217   200007 236100                    LDQ     NEXT$,,AUTO
        25 000220   000002 036003                    ADLQ    2,DU
        25 000221   200012 756100                    STQ     ELEM_LTS$,,AUTO
        25 000222   200007 236100                    LDQ     NEXT$,,AUTO
        25 000223   000001 036003                    ADLQ    1,DU
        25 000224   200011 756100                    STQ     SUM_BIT,,AUTO
        25 000225   000247 701000 25                 TSX1    PROCESS_SUM
        25 000226   000000 011000                    NOP     0

      582    17595    3                          NEXT$ -> DEFERED_SUM_CLAUSE_LIST.ASSOC_VAR_LTS$);
      583    17596
      584    17597    3        NEXT$ = NEXT$ -> DEFERED_SUM_CLAUSE_LIST.LINK;

  17597 25 000227   200007 470500                    LDP0    NEXT$,,AUTO
        25 000230   000007 236100                    LDQ     7,,PR0
        25 000231   200007 756100                    STQ     NEXT$,,AUTO

      585    17598    3      END; /* while */

  17598 25 000232   000003 116000 26                 CMPQ    3
        25 000233   000212 601000 25                 TNZ     s:17591

      586    17599
      587    17600    2      IF O1COM.REPORT_SUM$ ~= ADDR(NIL) THEN
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:113  

  17600 25 000234   000070 236000 xsym               LDQ     O1COM+56
        25 000235   000003 116000 26                 CMPQ    3
        25 000236   000245 600000 25                 TZE     s:17609

      588    17601    3        DO;

      589    17602
      590    17603    3          CALL Z8ED$DISPOSE_ABSSYN_TREE (O1COM.REPORT_SUM$);

  17603 25 000237   000006 630400 26                 EPPR0   6
        25 000240   000000 631400 26                 EPPR1   0
        25 000241   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        25 000242   000000 011000                    NOP     0

      591    17604
      592    17605    3          CALL GENERATE_SUBS;

  17605 25 000243   001756 701000 25                 TSX1    GENERATE_SUBS
        25 000244   000000 011000                    NOP     0

      593    17606    3        END;

      594    17607
      595    17608
      596    17609    2    END CREATE_REPORT_SUM;

  17609 25 000245   200006 221300                    LDX1  ! I+2,,AUTO
        25 000246   000001 702211                    TSX2  ! 1,X1

      597    17610         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:114  
      598    17611
      599    17612         /*===========*/
      600    17613    1      PROCESS_SUM: PROC (SUM_LIST$, VAR_LTS$);

  17613 25 000247   200010 741300       PROCESS_SUM  STX1  ! NEXT$,,AUTO

      601    17614         /*===========*/
      602    17615
      603    17616        /*I*
      604    17617             NAME:  PROCESS_SUM
      605    17618
      606    17619          DESCRIPTION: This routine calls several modules to generate the
      607    17620                       ETT items that reset or subtotalling the sum counter.
      608    17621        */
      609    17622
      610    17623
      611    17624    2      DCL SUM_LIST$       PTR;
      612    17625    2      DCL VAR_LTS$        PTR;
      613    17626    2      DCL ID_LIST$        PTR;
      614    17627    2      DCL LTS$$           PTR;
      615    17628    2      DCL SUM_CLAUSE$     PTR;
      616    17629    2      DCL ID$$            PTR;
      617    17630
      618    17631
      619    17632
      620    17633    2      IF SUM_LIST$ -> LX_LIST.TAIL$ -> DEFERED_SUM_CLAUSE.B.RESET_ID OR

  17633 25 000250   200011 470500                    LDP0    @SUM_LIST$,,AUTO
        25 000251   000000 471500                    LDP1    0,,PR0
        25 000252   100001 473500                    LDP3    1,,PR1
        25 000253   300000 236100                    LDQ     0,,PR3
        25 000254   200000 316007                    CANQ    65536,DL
        25 000255   000260 601000 25                 TNZ     s:17636
        25 000256   100000 316007                    CANQ    32768,DL
        25 000257   000266 600000 25                 TZE     s:17639

      621    17634    2         SUM_LIST$ -> LX_LIST.TAIL$ -> DEFERED_SUM_CLAUSE.B.RESET_FINAL THEN
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:115  
      622    17635
      623    17636    2        CALL PROCESS_RESET (SUM_LIST$ -> LX_LIST.TAIL$,

  17636 25 000260   200012 236100                    LDQ     @VAR_LTS$,,AUTO
        25 000261   200022 756100                    STQ     @SUM_CLAUSE$+1,,AUTO
        25 000262   100001 633500                    EPPR3   1,,PR1
        25 000263   200021 453500                    STP3    ID$$+3,,AUTO
        25 000264   000332 701000 25                 TSX1    PROCESS_RESET
        25 000265   000000 011000                    NOP     0

      624    17637    2                            VAR_LTS$);
      625    17638
      626    17639    2        SUM_CLAUSE$ = SUM_LIST$ -> LX_LIST.HEAD$;

  17639 25 000266   200011 470500                    LDP0    @SUM_LIST$,,AUTO
        25 000267   000000 471500                    LDP1    0,,PR0
        25 000270   100004 236100                    LDQ     4,,PR1
        25 000271   200015 756100                    STQ     SUM_CLAUSE$,,AUTO

      627    17640
      628    17641    3      DO WHILE (SUM_CLAUSE$ ~= ADDR(NIL));

  17641 25 000272   000326 710000 25                 TRA     s:17651

      629    17642
      630    17643    3        CALL Z8ET$PROCESS_TREE (SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$);

  17643 25 000273   200015 236100                    LDQ     SUM_CLAUSE$,,AUTO
        25 000274   000001 036003                    ADLQ    1,DU
        25 000275   200042 756100                    STQ     ST$$+1,,AUTO
        25 000276   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000277   000000 631400 26                 EPPR1   0
        25 000300   000000 701000 xent               TSX1    Z8ET$PROCESS_TREE
        25 000301   000000 011000                    NOP     0

      631    17644
      632    17645    3        IF SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_UPON$ ~= ADDR(NIL) THEN
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:116  

  17645 25 000302   200015 470500                    LDP0    SUM_CLAUSE$,,AUTO
        25 000303   000003 236100                    LDQ     3,,PR0
        25 000304   000003 116000 26                 CMPQ    3
        25 000305   000315 600000 25                 TZE     s:17648

      633    17646    3           CALL BUILD_SUM_W_UPON (SUM_CLAUSE$, VAR_LTS$);

  17646 25 000306   200012 236100                    LDQ     @VAR_LTS$,,AUTO
        25 000307   200022 756100                    STQ     @SUM_CLAUSE$+1,,AUTO
        25 000310   200015 631500                    EPPR1   SUM_CLAUSE$,,AUTO
        25 000311   200021 451500                    STP1    ID$$+3,,AUTO
        25 000312   000656 701000 25                 TSX1    BUILD_SUM_W_UPON
        25 000313   000000 011000                    NOP     0
        25 000314   000323 710000 25                 TRA     s:17650

      634    17647    3        ELSE
      635    17648    3           CALL BUILD_SUM_N_UPON (SUM_CLAUSE$, VAR_LTS$);

  17648 25 000315   200012 236100                    LDQ     @VAR_LTS$,,AUTO
        25 000316   200022 756100                    STQ     @SUM_CLAUSE$+1,,AUTO
        25 000317   200015 631500                    EPPR1   SUM_CLAUSE$,,AUTO
        25 000320   200021 451500                    STP1    ID$$+3,,AUTO
        25 000321   001420 701000 25                 TSX1    BUILD_SUM_N_UPON
        25 000322   000000 011000                    NOP     0

      636    17649
      637    17650    3        SUM_CLAUSE$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.LINK;

  17650 25 000323   200015 470500                    LDP0    SUM_CLAUSE$,,AUTO
        25 000324   000007 236100                    LDQ     7,,PR0
        25 000325   200015 756100                    STQ     SUM_CLAUSE$,,AUTO

      638    17651    3      END; /* while */

  17651 25 000326   000003 116000 26                 CMPQ    3
        25 000327   000273 601000 25                 TNZ     s:17643
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:117  

      639    17652
      640    17653    2    END PROCESS_SUM;

  17653 25 000330   200010 221300                    LDX1  ! NEXT$,,AUTO
        25 000331   000001 702211                    TSX2  ! 1,X1

      641    17654         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:118  
      642    17655
      643    17656         /*=============*/
      644    17657    1      PROCESS_RESET: PROC (SUM_CLAUSE$, VAR_LTS$);

  17657 25 000332   200020 741300       PROCESS_RES* STX1  ! ID$$+2,,AUTO

      645    17658         /*=============*/
      646    17659
      647    17660        /*I*
      648    17661
      649    17662             NAME:  PROCESS_RESET
      650    17663
      651    17664          DESCRIPTION: This routine validate the RESET phrase against the
      652    17665                       CONTROL clause  in RD entry and call SET_SUM_ZERO
      653    17666                       to get a LX_ETT item of the sum counter and then links
      654    17667                       it on the CONTROL_NAME_LTS, at the later time this
      655    17668                       LX_ETT item will be used to generate the sum counter
      656    17669                       resetting routine.
      657    17670        */
      658    17671
      659    17672
      660    17673    2      DCL SUM_CLAUSE$         PTR;
      661    17674    2      DCL VAR_LTS$            PTR;
      662    17675    2      DCL CTR_LTS$            PTR;
      663    17676    2      DCL LX_ETT$             PTR;
      664    17677
      665    17678
      666    17679
      667    17680    2      IF SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.B.RESET_FINAL THEN

  17680 25 000333   200021 470500                    LDP0    @SUM_CLAUSE$,,AUTO
        25 000334   000000 471500                    LDP1    0,,PR0
        25 000335   100000 236100                    LDQ     0,,PR1
        25 000336   100000 316007                    CANQ    32768,DL
        25 000337   000400 600000 25                 TZE     s:17702

      668    17681    3        DO;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:119  

      669    17682    3          IF NOT O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.B.CONTROL_FINAL THEN

  17682 25 000340   000064 473400 xsym               LDP3    O1COM+52
        25 000341   300003 236100                    LDQ     3,,PR3
        25 000342   200000 316003                    CANQ    65536,DU
        25 000343   000360 601000 25                 TNZ     s:17690

      670    17683
      671    17684    3            CALL Z8AE$ERROR (%E$ONLY_CONTROL_FINAL_IN_RD,

  17684 25 000344   100004 474500                    LDP4    4,,PR1
        25 000345   400006 635500                    EPPR5   6,,PR4
        25 000346   200044 455500                    STP5    ST$$+3,,AUTO
        25 000347   400005 631500                    EPPR1   5,,PR4
        25 000350   200043 451500                    STP1    ST$$+2,,AUTO
        25 000351   000010 236000 26                 LDQ     8
        25 000352   200042 756100                    STQ     ST$$+1,,AUTO
        25 000353   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000354   000005 631400 26                 EPPR1   5
        25 000355   000000 701000 xent               TSX1    Z8AE$ERROR
        25 000356   000000 011000                    NOP     0
        25 000357   000425 710000 25                 TRA     LAST_STEP

      672    17685    3                  SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_RESET$ -> LX_ITEM.LINE,
      673    17686    3                  SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_RESET$ -> LX_ITEM.COLUMN);
      674    17687
      675    17688    3          ELSE
      676    17689    4            DO;

      677    17690    4              CALL SET_SUM_ZERO (VAR_LTS$,

  17690 25 000360   200024 634500                    EPPR4   LX_ETT$,,AUTO
        25 000361   200030 454500                    STP4    ELEM_LTS$+1,,AUTO
        25 000362   200022 236100                    LDQ     @VAR_LTS$,,AUTO
        25 000363   200027 756100                    STQ     SUM_BIT_ON+1,,AUTO
        25 000364   000437 701000 25                 TSX1    SET_SUM_ZERO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:120  
        25 000365   000000 011000                    NOP     0

      678    17691    4                                 LX_ETT$);
      679    17692
      680    17693    4              LX_ETT$ -> LX_ETT_ITEM.LINK = O1COM.CURRENT_REPORT_LTS$

  17693 25 000366   000064 470400 xsym               LDP0    O1COM+52
        25 000367   000006 471500                    LDP1    6,,PR0
        25 000370   100004 236100                    LDQ     4,,PR1
        25 000371   200024 473500                    LDP3    LX_ETT$,,AUTO
        25 000372   300007 756100                    STQ     7,,PR3

      681    17694    4                  -> REPORT_LTS.CONTROL_FINAL$ -> CONTROL_NAME_LTS.SUM_RESET$;
      682    17695    4              O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.CONTROL_FINAL$ ->

  17695 25 000373   000064 470400 xsym               LDP0    O1COM+52
        25 000374   000006 471500                    LDP1    6,,PR0
        25 000375   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 000376   100004 756100                    STQ     4,,PR1

      683    17696    4                  CONTROL_NAME_LTS.SUM_RESET$ = LX_ETT$;
      684    17697
      685    17698    4            END;

      686    17699    3        END;

  17699 25 000377   000425 710000 25                 TRA     LAST_STEP

      687    17700    2      ELSE
      688    17701    3        DO;

      689    17702    3          CALL CONTROL_NAME_CHECK (SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_RESET$,

  17702 25 000400   200023 633500                    EPPR3   CTR_LTS$,,AUTO
        25 000401   200030 453500                    STP3    ELEM_LTS$+1,,AUTO
        25 000402   100004 634500                    EPPR4   4,,PR1
        25 000403   200027 454500                    STP4    SUM_BIT_ON+1,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:121  
        25 000404   000512 701000 25                 TSX1    CONTROL_NAME_CHECK
        25 000405   000407 702000 25                 TSX2    s:17706
        25 000406   000410 710000 25                 TRA     s:17709

      690    17703    3                                   CTR_LTS$)
      691    17704    3            WHENALTRETURN
      692    17705    4              DO;

      693    17706    4                GOTO LAST_STEP;

  17706 25 000407   000425 710000 25                 TRA     LAST_STEP

      694    17707    4              END;
      695    17708
      696    17709    3          CALL SET_SUM_ZERO (VAR_LTS$,

  17709 25 000410   200024 630500                    EPPR0   LX_ETT$,,AUTO
        25 000411   200030 450500                    STP0    ELEM_LTS$+1,,AUTO
        25 000412   200022 236100                    LDQ     @VAR_LTS$,,AUTO
        25 000413   200027 756100                    STQ     SUM_BIT_ON+1,,AUTO
        25 000414   000437 701000 25                 TSX1    SET_SUM_ZERO
        25 000415   000000 011000                    NOP     0

      697    17710    3                             LX_ETT$);
      698    17711
      699    17712    3          LX_ETT$ -> LX_ETT_ITEM.LINK = CTR_LTS$ ->

  17712 25 000416   200023 470500                    LDP0    CTR_LTS$,,AUTO
        25 000417   000004 236100                    LDQ     4,,PR0
        25 000420   200024 471500                    LDP1    LX_ETT$,,AUTO
        25 000421   100007 756100                    STQ     7,,PR1

      700    17713    3                                          CONTROL_NAME_LTS.SUM_RESET$;
      701    17714    3          CTR_LTS$ -> CONTROL_NAME_LTS.SUM_RESET$ = LX_ETT$;

  17714 25 000422   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 000423   200023 470500                    LDP0    CTR_LTS$,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:122  
        25 000424   000004 756100                    STQ     4,,PR0

      702    17715    3        END;

      703    17716
      704    17717    2      LAST_STEP:
      705    17718    2        CALL Z8ED$DISPOSE_ABSSYN_TREE(SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_RESET$);

  17718 25 000425   200021 470500       LAST_STEP    LDP0    @SUM_CLAUSE$,,AUTO
        25 000426   000000 471500                    LDP1    0,,PR0
        25 000427   100004 633500                    EPPR3   4,,PR1
        25 000430   200042 453500                    STP3    ST$$+1,,AUTO
        25 000431   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000432   000000 631400 26                 EPPR1   0
        25 000433   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        25 000434   000000 011000                    NOP     0

      706    17719
      707    17720    2    END PROCESS_RESET;

  17720 25 000435   200020 221300                    LDX1  ! ID$$+2,,AUTO
        25 000436   000001 702211                    TSX2  ! 1,X1

      708    17721         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:123  
      709    17722
      710    17723         /*============*/
      711    17724    1      SET_SUM_ZERO: PROC (VAR_LTS$, LX_ETT$);

  17724 25 000437   200026 741300       SET_SUM_ZERO STX1  ! ST$$+1,,AUTO

      712    17725         /*============*/
      713    17726
      714    17727        /*I*
      715    17728             NAME:  SET_SUM_ZERO
      716    17729
      717    17730          DESCRIPTION: This routine creates a LX_ETT_ITEM of the sum counter
      718    17731                       and set the bit SUM_LTS.B.RESETED on.
      719    17732        */
      720    17733
      721    17734
      722    17735    2      DCL VAR_LTS$        PTR;
      723    17736    2      DCL LX_ETT$         PTR;
      724    17737
      725    17738
      726    17739
      727    17740           %NEW_HEAP (@POINTER = LX_ETT$);

  17742 25 000440   000013 236000 26                 LDQ     11
        25 000441   200030 235100                    LDA     @LX_ETT$,,AUTO
        25 000442   200042 757100                    STAQ    ST$$+1,,AUTO
        25 000443   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000444   000011 631400 26                 EPPR1   9
        25 000445   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        25 000446   000000 011000                    NOP     0

      728    17745
      729    17746
      730    17747           %INIT_LX_ETT_ITEM (@POINTER = LX_ETT$,
      731    17748                              @TYPE    = %TYD,
      732    17749                              @ETT$    =
             17749                                VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.SUM_ST_ILL$
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:124  
             17749                                  ,
      733    17750                              @LINE    = VAR_LTS$ -> REPORT_ELEM_LTS.ST$ -> ST.LINE_NO,
      734    17751                              @COLUMN  = 0);

  17753 25 000447   200030 470500                    LDP0    @LX_ETT$,,AUTO
        25 000450   000000 471500                    LDP1    0,,PR0
        25 000451   000004 220003                    LDX0    4,DU
        25 000452   100000 740100                    STX0    0,,PR1

  17754 25 000453   000000 471500                    LDP1    0,,PR0
        25 000454   000000 221003                    LDX1    0,DU
        25 000455   100000 441100                    SXL1    0,,PR1

  17755 25 000456   000000 471500                    LDP1    0,,PR0
        25 000457   100004 450100                    STZ     4,,PR1

  17756 25 000460   000000 471500                    LDP1    0,,PR0
        25 000461   000003 236000 26                 LDQ     3
        25 000462   100007 756100                    STQ     7,,PR1

  17757 25 000463   000000 471500                    LDP1    0,,PR0
        25 000464   200027 473500                    LDP3    @VAR_LTS$,,AUTO
        25 000465   300000 474500                    LDP4    0,,PR3
        25 000466   400012 475500                    LDP5    10,,PR4
        25 000467   500004 236100                    LDQ     4,,PR5
        25 000470   100001 756100                    STQ     1,,PR1

  17758 25 000471   000000 471500                    LDP1    0,,PR0
        25 000472   000003 236000 26                 LDQ     3
        25 000473   100002 756100                    STQ     2,,PR1

  17760 25 000474   000000 471500                    LDP1    0,,PR0
        25 000475   300000 474500                    LDP4    0,,PR3
        25 000476   400003 475500                    LDP5    3,,PR4
        25 000477   500002 236100                    LDQ     2,,PR5
        25 000500   777777 376007                    ANQ     -1,DL
        25 000501   100005 756100                    STQ     5,,PR1
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:125  

  17761 25 000502   000000 471500                    LDP1    0,,PR0
        25 000503   100006 450100                    STZ     6,,PR1

      735    17773
      736    17774    2      VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.B.RESETED = TRUE;

  17774 25 000504   300000 471500                    LDP1    0,,PR3
        25 000505   100012 474500                    LDP4    10,,PR1
        25 000506   400000 236007                    LDQ     -131072,DL
        25 000507   400000 256100                    ORSQ    0,,PR4

      737    17775
      738    17776
      739    17777    2    END SET_SUM_ZERO;

  17777 25 000510   200026 221300                    LDX1  ! ST$$+1,,AUTO
        25 000511   000001 702211                    TSX2  ! 1,X1

      740    17778         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:126  
      741    17779
      742    17780         /*==================*/
      743    17781    1      CONTROL_NAME_CHECK:  PROC (QUAL_ID$, CTR_LTS$) ALTRET;

  17781 25 000512   200026 741300       CONTROL_NAM* STX1  ! ST$$+1,,AUTO

      744    17782         /*==================*/
      745    17783
      746    17784        /*I*
      747    17785
      748    17786             NAME:  CONTROL_NAME_CHECK
      749    17787
      750    17788          DESCRIPTION: This routine validate the control name against the
      751    17789                       CONTROL clause  in RD entry and returns the LTS item
      752    17790                       for that control name.
      753    17791        */
      754    17792
      755    17793
      756    17794    2     DCL ST$$              PTR;
      757    17795    2     DCL LTS$$             PTR;
      758    17796    2     DCL QUAL_ID$           PTR;
      759    17797    2     DCL LEN               UBIN HALF UNAL;
      760    17798    2     DCL CTR$              PTR;
      761    17799    2     DCL RSV_WRD#          SBIN WORD;
      762    17800    2     DCL CTR_LTS$          PTR;
      763    17801
      764    17802
      765    17803
      766    17804    2      CALL Z8CO$QUALIFY_VARIABLE (QUAL_ID$, ST$$)

  17804 25 000513   200031 630500                    EPPR0   ST$$,,AUTO
        25 000514   200043 450500                    STP0    ST$$+2,,AUTO
        25 000515   200027 236100                    LDQ     @QUAL_ID$,,AUTO
        25 000516   200042 756100                    STQ     ST$$+1,,AUTO
        25 000517   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000520   000011 631400 26                 EPPR1   9
        25 000521   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:127  
        25 000522   000524 702000 25                 TSX2    s:17807
        25 000523   000536 710000 25                 TRA     s:17815

      767    17805    2        WHENALTRETURN
      768    17806    3          DO;

      769    17807    3            IF ST$$ -> SCALAR.B.COMPILER_CREATED THEN

  17807 25 000524   200031 470500                    LDP0    ST$$,,AUTO
        25 000525   000003 236100                    LDQ     3,,PR0
        25 000526   100000 316003                    CANQ    32768,DU
        25 000527   000534 600000 25                 TZE     s:17812

      770    17808    4              DO;

      771    17809    4                ST$$ -> SCALAR.DNT$ -> DNT.ST$ =

  17809 25 000530   000006 471500                    LDP1    6,,PR0
        25 000531   100001 473500                    LDP3    1,,PR1
        25 000532   300004 236100                    LDQ     4,,PR3
        25 000533   100001 756100                    STQ     1,,PR1

      772    17810    4                        ST$$ -> SCALAR.DNT$ -> DNT.ST$ -> ST.NEXT;
      773    17811    4              END;

      774    17812    3            ALTRETURN;

  17812 25 000534   200026 221300                    LDX1  ! ST$$+1,,AUTO
        25 000535   000000 702211                    TSX2  ! 0,X1

      775    17813    3          END;
      776    17814
      777    17815    2      LTS$$ = O1COM.CURRENT_REPORT_LTS$;

  17815 25 000536   000064 236000 xsym               LDQ     O1COM+52
        25 000537   200032 756100                    STQ     LTS$$,,AUTO

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:128  
      778    17816
      779    17817    2      IF LTS$$ -> REPORT_LTS.CONTROL$ = ADDR(NIL) THEN

  17817 25 000540   200032 470500                    LDP0    LTS$$,,AUTO
        25 000541   000005 236100                    LDQ     5,,PR0
        25 000542   000003 116000 26                 CMPQ    3
        25 000543   000563 601000 25                 TNZ     s:17825

      780    17818    3        DO;

      781    17819    3          CALL Z8AE$ERROR (%E$NAME_NOT_IN_CONTROL_CLAUSE,

  17819 25 000544   200027 471500                    LDP1    @QUAL_ID$,,AUTO
        25 000545   100000 473500                    LDP3    0,,PR1
        25 000546   300004 474500                    LDP4    4,,PR3
        25 000547   400006 635500                    EPPR5   6,,PR4
        25 000550   200044 455500                    STP5    ST$$+3,,AUTO
        25 000551   400005 633500                    EPPR3   5,,PR4
        25 000552   200043 453500                    STP3    ST$$+2,,AUTO
        25 000553   000015 236000 26                 LDQ     13
        25 000554   200042 756100                    STQ     ST$$+1,,AUTO
        25 000555   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000556   000005 631400 26                 EPPR1   5
        25 000557   000000 701000 xent               TSX1    Z8AE$ERROR
        25 000560   000000 011000                    NOP     0

      782    17820    3                           QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      783    17821    3                           QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
      784    17822    3          ALTRETURN;

  17822 25 000561   200026 221300                    LDX1  ! ST$$+1,,AUTO
        25 000562   000000 702211                    TSX2  ! 0,X1

      785    17823    3        END;
      786    17824
      787    17825    2      IF ST$$ -> SCALAR.B.REPORT_ITEM  THEN

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:129  
  17825 25 000563   200031 471500                    LDP1    ST$$,,AUTO
        25 000564   100003 236100                    LDQ     3,,PR1
        25 000565   010000 316007                    CANQ    4096,DL
        25 000566   000606 600000 25                 TZE     s:17833

      788    17826    3        DO;

      789    17827    3          CALL Z8AE$ERROR (%E$DCL_IN_REPORT,

  17827 25 000567   200027 473500                    LDP3    @QUAL_ID$,,AUTO
        25 000570   300000 474500                    LDP4    0,,PR3
        25 000571   400004 475500                    LDP5    4,,PR4
        25 000572   500006 636500                    EPPR6   6,,PR5
        25 000573   200044 456500                    STP6    ST$$+3,,AUTO
        25 000574   500005 634500                    EPPR4   5,,PR5
        25 000575   200043 454500                    STP4    ST$$+2,,AUTO
        25 000576   000017 236000 26                 LDQ     15
        25 000577   200042 756100                    STQ     ST$$+1,,AUTO
        25 000600   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000601   000005 631400 26                 EPPR1   5
        25 000602   000000 701000 xent               TSX1    Z8AE$ERROR
        25 000603   000000 011000                    NOP     0

      790    17828    3                           QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      791    17829    3                           QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
      792    17830    3          ALTRETURN;

  17830 25 000604   200026 221300                    LDX1  ! ST$$+1,,AUTO
        25 000605   000000 702211                    TSX2  ! 0,X1

      793    17831    3        END;
      794    17832
      795    17833    2      CTR$ = LTS$$ -> REPORT_LTS.CONTROL$;

  17833 25 000606   000005 236100                    LDQ     5,,PR0
        25 000607   200034 756100                    STQ     CTR$,,AUTO

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:130  
      796    17834    2      LEN = CTR$ -> LTS_PTR_ARRAY.N - 3;

  17834 25 000610   200034 473500                    LDP3    CTR$,,AUTO
        25 000611   300000 720100                    LXL0    0,,PR3
        25 000612   777775 621010                    EAX1    -3,X0
        25 000613   200033 741100                    STX1    LEN,,AUTO

      797    17835
      798    17836    3      DO I = 1 TO LEN;

  17836 25 000614   000001 235007                    LDA     1,DL
        25 000615   200004 755100                    STA     I,,AUTO
        25 000616   000626 710000 25                 TRA     s:17839+1

      799    17837    3        IF ST$$ = CTR$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.ST$ THEN

  17837 25 000617   200034 470500                    LDP0    CTR$,,AUTO
        25 000620   200004 720100                    LXL0    I,,AUTO
        25 000621   000002 471510                    LDP1    2,X0,PR0
        25 000622   200031 236100                    LDQ     ST$$,,AUTO
        25 000623   100001 116100                    CMPQ    1,,PR1
        25 000624   000651 600000 25                 TZE     NEXT_STEP

      800    17838    3          GOTO NEXT_STEP;
      801    17839    3      END;

  17839 25 000625   200004 054100                    AOS     I,,AUTO
        25 000626   200033 236100                    LDQ     LEN,,AUTO
        25 000627   000022 772000                    QRL     18
        25 000630   200004 116100                    CMPQ    I,,AUTO
        25 000631   000617 605000 25                 TPL     s:17837

      802    17840    2      CALL Z8AE$ERROR (%E$NAME_NOT_IN_CONTROL_CLAUSE,

  17840 25 000632   200027 470500                    LDP0    @QUAL_ID$,,AUTO
        25 000633   000000 471500                    LDP1    0,,PR0
        25 000634   100004 473500                    LDP3    4,,PR1
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:131  
        25 000635   300006 634500                    EPPR4   6,,PR3
        25 000636   200044 454500                    STP4    ST$$+3,,AUTO
        25 000637   300005 631500                    EPPR1   5,,PR3
        25 000640   200043 451500                    STP1    ST$$+2,,AUTO
        25 000641   000015 236000 26                 LDQ     13
        25 000642   200042 756100                    STQ     ST$$+1,,AUTO
        25 000643   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000644   000005 631400 26                 EPPR1   5
        25 000645   000000 701000 xent               TSX1    Z8AE$ERROR
        25 000646   000000 011000                    NOP     0

      803    17841    2                       QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      804    17842    2                       QUAL_ID$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
      805    17843    2      ALTRETURN;

  17843 25 000647   200026 221300                    LDX1  ! ST$$+1,,AUTO
        25 000650   000000 702211                    TSX2  ! 0,X1

      806    17844
      807    17845    2    NEXT_STEP:
      808    17846    2      CTR_LTS$ = CTR$ -> LTS_PTR_ARRAY.P$(I);

  17846 25 000651   000002 236110       NEXT_STEP    LDQ     2,X0,PR0
        25 000652   200030 473500                    LDP3    @CTR_LTS$,,AUTO
        25 000653   300000 756100                    STQ     0,,PR3

      809    17847
      810    17848    2    END CONTROL_NAME_CHECK;

  17848 25 000654   200026 221300                    LDX1  ! ST$$+1,,AUTO
        25 000655   000001 702211                    TSX2  ! 1,X1

      811    17849         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:132  
      812    17850
      813    17851         /*================*/
      814    17852    1      BUILD_SUM_W_UPON: PROC (SUM_CLAUSE$, VAR_LTS$);

  17852 25 000656   200020 741300       BUILD_SUM_W* STX1  ! ID$$+2,,AUTO

      815    17853         /*================*/
      816    17854
      817    17855        /*I*
      818    17856
      819    17857             NAME:  BUILD_SUM_W_UPON
      820    17858
      821    17859          DESCRIPTION: This routine validates the UPON phrase and checks
      822    17860                       items in the SUM clause and then an abstract syntax
      823    17861                       tree for a "plus" operation is built that will add
      824    17862                       the items in the SUM clause to the sum counter on
      825    17863                       the run time, in the later time this tree will be
      826    17864                       used to generate the special subtotalling subroutine.
      827    17865        */
      828    17866
      829    17867
      830    17868    2   DCL SUM_CLAUSE$         PTR;
      831    17869    2   DCL VAR_LTS$            PTR;
      832    17870    2   DCL UPON_LTS$          PTR;
      833    17871    2   DCL LX_ETT$            PTR;
      834    17872    2   DCL ST$$               PTR;
      835    17873    2   DCL UPON$$             PTR;
      836    17874    2   DCL HEAP$$             PTR;
      837    17875    2   DCL OP$                PTR;
      838    17876    2   DCL TREE$              PTR;
      839    17877    2   DCL SUM_LX_ETT$        PTR;
      840    17878    2   DCL LINE_NO#           SBIN WORD;
      841    17879
      842    17880
      843    17881    2          LINE_NO# = VAR_LTS$ -> REPORT_ELEM_LTS.ST$ -> ST.LINE_NO;

  17881 25 000657   200022 470500                    LDP0    @VAR_LTS$,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:133  
        25 000660   000000 471500                    LDP1    0,,PR0
        25 000661   100003 473500                    LDP3    3,,PR1
        25 000662   300002 236100                    LDQ     2,,PR3
        25 000663   777777 376007                    ANQ     -1,DL
        25 000664   200033 756100                    STQ     LINE_NO#,,AUTO

      844    17882    2          LX_ETT$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$ -> LX_LIST.HEAD$;

  17882 25 000665   200021 474500                    LDP4    @SUM_CLAUSE$,,AUTO
        25 000666   400000 475500                    LDP5    0,,PR4
        25 000667   500001 476500                    LDP6    1,,PR5
        25 000670   600004 236100                    LDQ     4,,PR6
        25 000671   200024 756100                    STQ     LX_ETT$,,AUTO

      845    17883
      846    17884    3      DO WHILE (LX_ETT$ ~= ADDR(NIL));

  17884 25 000672   001004 710000 25                 TRA     s:17923

      847    17885
      848    17886    4        DO CASE (LX_ETT$ -> LX_ETT_ITEM.TYPE);

  17886 25 000673   200024 470500                    LDP0    LX_ETT$,,AUTO
        25 000674   000004 235100                    LDA     4,,PR0
        25 000675   000024 115007                    CMPA    20,DL
        25 000676   000700 602005 25                 TNC     s:17886+5,AL
        25 000677   000761 710000 25                 TRA     s:17912
        25 000700   000724 710000 25                 TRA     s:17897
        25 000701   000724 710000 25                 TRA     s:17897
        25 000702   000724 710000 25                 TRA     s:17897
        25 000703   000724 710000 25                 TRA     s:17897
        25 000704   000724 710000 25                 TRA     s:17897
        25 000705   000724 710000 25                 TRA     s:17897
        25 000706   000761 710000 25                 TRA     s:17912
        25 000707   000724 710000 25                 TRA     s:17897
        25 000710   000761 710000 25                 TRA     s:17912
        25 000711   000761 710000 25                 TRA     s:17912
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:134  
        25 000712   000761 710000 25                 TRA     s:17912
        25 000713   000724 710000 25                 TRA     s:17897
        25 000714   000761 710000 25                 TRA     s:17912
        25 000715   000761 710000 25                 TRA     s:17912
        25 000716   000761 710000 25                 TRA     s:17912
        25 000717   000724 710000 25                 TRA     s:17897
        25 000720   000761 710000 25                 TRA     s:17912
        25 000721   000761 710000 25                 TRA     s:17912
        25 000722   000761 710000 25                 TRA     s:17912
        25 000723   000724 710000 25                 TRA     s:17897

      849    17887
      850    17888    4          CASE (

      851    17889                     %SET_OF_NUMERIC_TYPES;
      852    17892    4               );
      853    17893
      854    17894                   %FISH (TRIAD = LX_ETT$ -> LX_ETT_ITEM.ETT$,
      855    17895                          RTN   = ST$$);

  17897 25 000724   000001 236100                    LDQ     1,,PR0
        25 000725   200025 756100                    STQ     ST$$,,AUTO

  17898 25 000726   200025 471500                    LDP1    ST$$,,AUTO
        25 000727   100000 220100                    LDX0    0,,PR1
        25 000730   000751 100003                    CMPX0   489,DU
        25 000731   000741 603000 25                 TRC     s:17904

  17899 25 000732   200025 470500                    LDP0    ST$$,,AUTO
        25 000733   000001 236100                    LDQ     1,,PR0
        25 000734   200025 756100                    STQ     ST$$,,AUTO

  17900 25 000735   200025 470500                    LDP0    ST$$,,AUTO
        25 000736   000000 220100                    LDX0    0,,PR0
        25 000737   000751 100003                    CMPX0   489,DU
        25 000740   000732 602000 25                 TNC     s:17899

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:135  
      856    17903
      857    17904    4              IF ST$$ -> SCALAR.B.REPORT_ITEM THEN

  17904 25 000741   200025 470500                    LDP0    ST$$,,AUTO
        25 000742   000003 236100                    LDQ     3,,PR0
        25 000743   010000 316007                    CANQ    4096,DL
        25 000744   001001 600000 25                 TZE     s:17921

      858    17905
      859    17906    4                CALL Z8AE$ERROR (%E$REP_ITEM_W_UPON,

  17906 25 000745   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 000746   000006 036003                    ADLQ    6,DU
        25 000747   200044 756100                    STQ     ST$$+3,,AUTO
        25 000750   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 000751   000005 036003                    ADLQ    5,DU
        25 000752   000021 235000 26                 LDA     17
        25 000753   200042 757100                    STAQ    ST$$+1,,AUTO
        25 000754   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000755   000005 631400 26                 EPPR1   5
        25 000756   000000 701000 xent               TSX1    Z8AE$ERROR
        25 000757   000000 011000                    NOP     0
        25 000760   001001 710000 25                 TRA     s:17921

      860    17907    4                                 LX_ETT$ -> LX_ITEM.LINE,
      861    17908    4                                 LX_ETT$ -> LX_ITEM.COLUMN);
      862    17909
      863    17910    4          CASE (ELSE);

      864    17911
      865    17912    4              CALL Z8AE$ERROR (%E$NUMERIC_TYPE_EXPECTED,

  17912 25 000761   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 000762   000006 036003                    ADLQ    6,DU
        25 000763   200044 756100                    STQ     ST$$+3,,AUTO
        25 000764   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 000765   000005 036003                    ADLQ    5,DU
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:136  
        25 000766   000023 235000 26                 LDA     19
        25 000767   200042 757100                    STAQ    ST$$+1,,AUTO
        25 000770   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 000771   000005 631400 26                 EPPR1   5
        25 000772   000000 701000 xent               TSX1    Z8AE$ERROR
        25 000773   000000 011000                    NOP     0

      866    17913    4                               LX_ETT$ -> LX_ITEM.LINE,
      867    17914    4                               LX_ETT$ -> LX_ITEM.COLUMN);
      868    17915
      869    17916    4              LX_ETT$ -> LX_ETT_ITEM.ETT$ = COMCOM.VALUE_0;

  17916 25 000774   000124 236000 xsym               LDQ     COMCOM+84
        25 000775   200024 470500                    LDP0    LX_ETT$,,AUTO
        25 000776   000001 756100                    STQ     1,,PR0

      870    17917    4              LX_ETT$ -> LX_ETT_ITEM.TYPE = %TYI;

  17917 25 000777   000001 235007                    LDA     1,DL
        25 001000   000004 755100                    STA     4,,PR0

      871    17918
      872    17919    4        END; /* DO CASE */

      873    17920
      874    17921    3        LX_ETT$ = LX_ETT$ -> LX_ITEM.LINK;

  17921 25 001001   200024 470500                    LDP0    LX_ETT$,,AUTO
        25 001002   000007 236100                    LDQ     7,,PR0
        25 001003   200024 756100                    STQ     LX_ETT$,,AUTO

      875    17922
      876    17923    3      END; /* WHILE */

  17923 25 001004   000003 116000 26                 CMPQ    3
        25 001005   000673 601000 25                 TNZ     s:17886

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:137  
      877    17924
      878    17925    2      UPON$$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.SUM_UPON$ -> LX_LIST.HEAD$;

  17925 25 001006   200021 470500                    LDP0    @SUM_CLAUSE$,,AUTO
        25 001007   000000 471500                    LDP1    0,,PR0
        25 001010   100003 473500                    LDP3    3,,PR1
        25 001011   300004 236100                    LDQ     4,,PR3
        25 001012   200026 756100                    STQ     UPON$$,,AUTO

      879    17926
      880    17927    3      DO WHILE (UPON$$ ~= ADDR(NIL));

  17927 25 001013   001414 710000 25                 TRA     s:18157

      881    17928
      882    17929    3        CALL Z8CO$QUALIFY_VARIABLE (UPON$$, ST$$);

  17929 25 001014   200025 630500                    EPPR0   ST$$,,AUTO
        25 001015   200043 450500                    STP0    ST$$+2,,AUTO
        25 001016   200026 631500                    EPPR1   UPON$$,,AUTO
        25 001017   200042 451500                    STP1    ST$$+1,,AUTO
        25 001020   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001021   000011 631400 26                 EPPR1   9
        25 001022   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        25 001023   000000 011000                    NOP     0

      883    17930
      884    17931    3        IF ST$$ -> ST.ID ~= %SCALAR OR

  17931 25 001024   200025 470500                    LDP0    ST$$,,AUTO
        25 001025   000000 220100                    LDX0    0,,PR0
        25 001026   000766 100003                    CMPX0   502,DU
        25 001027   001033 601000 25                 TNZ     s:17933
        25 001030   000003 236100                    LDQ     3,,PR0
        25 001031   010000 316007                    CANQ    4096,DL
        25 001032   001036 601000 25                 TNZ     s:17935

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:138  
      885    17932    3           NOT ST$$ -> SCALAR.B.REPORT_ITEM THEN
      886    17933    3          UPON_LTS$ = ADDR(NIL);

  17933 25 001033   000003 236000 26                 LDQ     3
        25 001034   200023 756100                    STQ     UPON_LTS$,,AUTO
        25 001035   001066 710000 25                 TRA     s:17984

      887    17934    3        ELSE
      888    17935    3          IF ST$$ -> SCALAR.LTS$ = ADDR(NIL) THEN

  17935 25 001036   000005 236100                    LDQ     5,,PR0
        25 001037   000003 116000 26                 CMPQ    3
        25 001040   001044 601000 25                 TNZ     s:17942

      889    17936    3            UPON_LTS$ = ADDR(NIL);

  17936 25 001041   000003 236000 26                 LDQ     3
        25 001042   200023 756100                    STQ     UPON_LTS$,,AUTO
        25 001043   001066 710000 25                 TRA     s:17984

      890    17937    3          ELSE
      891    17938                 %GET_LTS (@ID    = %REPORT_01_LTS,
      892    17939                           @ST$   = ST$$,
      893    17940                           @RETURN$ = UPON_LTS$);

  17942 25 001044   001054 600000 25                 TZE     s:17976
        25 001045   000005 471500                    LDP1    5,,PR0
        25 001046   100000 221100                    LDX1    0,,PR1
        25 001047   001105 101003                    CMPX1   581,DU
        25 001050   001054 601000 25                 TNZ     s:17976

  17960 25 001051   100007 236100                    LDQ     7,,PR1
        25 001052   200023 756100                    STQ     UPON_LTS$,,AUTO

  17974 25 001053   001066 710000 25                 TRA     s:17984

  17976 25 001054   000003 116000 26                 CMPQ    3
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:139  
        25 001055   001064 600000 25                 TZE     s:17980
        25 001056   000005 471500                    LDP1    5,,PR0
        25 001057   100000 221100                    LDX1    0,,PR1
        25 001060   001101 101003                    CMPX1   577,DU
        25 001061   001064 601000 25                 TNZ     s:17980

  17978 25 001062   200023 756100                    STQ     UPON_LTS$,,AUTO
        25 001063   001066 710000 25                 TRA     s:17984

  17980 25 001064   000003 236000 26                 LDQ     3
        25 001065   200023 756100                    STQ     UPON_LTS$,,AUTO

      894    17983
      895    17984    3        IF UPON_LTS$ = ADDR(NIL)  OR

  17984 25 001066   000003 116000 26                 CMPQ    3
        25 001067   001102 600000 25                 TZE     s:17990
        25 001070   200023 471500                    LDP1    UPON_LTS$,,AUTO
        25 001071   100000 221100                    LDX1    0,,PR1
        25 001072   001101 101003                    CMPX1   577,DU
        25 001073   001102 601000 25                 TNZ     s:17990
        25 001074   100010 235100                    LDA     8,,PR1
        25 001075   000005 115007                    CMPA    5,DL
        25 001076   001102 601000 25                 TNZ     s:17990
        25 001077   100015 236100                    LDQ     13,,PR1
        25 001100   000064 116000 xsym               CMPQ    O1COM+52
        25 001101   001117 600000 25                 TZE     s:17996

      896    17985    3          UPON_LTS$ -> LTS.ID ~= %REPORT_01_LTS  OR
      897    17986    3          UPON_LTS$ -> REPORT_01_LTS.GROUP_TYPE ~= %TYPE_DETAIL  OR
      898    17987    3          UPON_LTS$ -> REPORT_01_LTS.REPORT_LTS$ ~= O1COM.CURRENT_REPORT_LTS$ THEN
      899    17988    4          DO;

      900    17989
      901    17990    4            CALL Z8AE$ERROR (%E$MUST_BE_DETAIL_GROUP,

  17990 25 001102   200026 471500                    LDP1    UPON$$,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:140  
        25 001103   100004 473500                    LDP3    4,,PR1
        25 001104   300006 634500                    EPPR4   6,,PR3
        25 001105   200044 454500                    STP4    ST$$+3,,AUTO
        25 001106   300005 635500                    EPPR5   5,,PR3
        25 001107   200043 455500                    STP5    ST$$+2,,AUTO
        25 001110   000025 236000 26                 LDQ     21
        25 001111   200042 756100                    STQ     ST$$+1,,AUTO
        25 001112   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001113   000005 631400 26                 EPPR1   5
        25 001114   000000 701000 xent               TSX1    Z8AE$ERROR
        25 001115   000000 011000                    NOP     0

      902    17991    4                             UPON$$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      903    17992    4                             UPON$$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
      904    17993    4          END;

  17993 25 001116   001411 710000 25                 TRA     s:18155

      905    17994    3        ELSE
      906    17995    4          DO;

      907    17996    4            IF UPON$$ -> LX_LIST.LINK = ADDR(NIL) THEN

  17996 25 001117   200026 473500                    LDP3    UPON$$,,AUTO
        25 001120   300007 236100                    LDQ     7,,PR3
        25 001121   000003 116000 26                 CMPQ    3
        25 001122   001155 601000 25                 TNZ     s:18014

      908    17997    5              DO;

      909    17998    5               TREE$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$ -> LX_LIST.HEAD$;

  17998 25 001123   200021 474500                    LDP4    @SUM_CLAUSE$,,AUTO
        25 001124   400000 475500                    LDP5    0,,PR4
        25 001125   500001 476500                    LDP6    1,,PR5
        25 001126   600004 236100                    LDQ     4,,PR6
        25 001127   200031 756100                    STQ     TREE$,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:141  

      910    17999
      911    18000                    %INIT_LX_LIST (@POINTER = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$
             18000                         );

  18002 25 001130   000002 222003                    LDX2    2,DU
        25 001131   600000 742100                    STX2    0,,PR6

  18003 25 001132   400000 470500                    LDP0    0,,PR4
        25 001133   000001 473500                    LDP3    1,,PR0
        25 001134   000000 220003                    LDX0    0,DU
        25 001135   300000 440100                    SXL0    0,,PR3

  18004 25 001136   400000 470500                    LDP0    0,,PR4
        25 001137   000001 473500                    LDP3    1,,PR0
        25 001140   000003 236000 26                 LDQ     3
        25 001141   300001 756100                    STQ     1,,PR3

  18005 25 001142   400000 470500                    LDP0    0,,PR4
        25 001143   000001 473500                    LDP3    1,,PR0
        25 001144   000003 236000 26                 LDQ     3
        25 001145   300004 756100                    STQ     4,,PR3

  18006 25 001146   400000 470500                    LDP0    0,,PR4
        25 001147   000001 473500                    LDP3    1,,PR0
        25 001150   300007 756100                    STQ     7,,PR3

  18007 25 001151   400000 470500                    LDP0    0,,PR4
        25 001152   000001 473500                    LDP3    1,,PR0
        25 001153   300002 450100                    STZ     2,,PR3

      912    18010
      913    18011    5              END;

  18011 25 001154   001212 710000 25                 TRA     s:18032

      914    18012    4            ELSE
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:142  
      915    18013    5              DO;

      916    18014    5                TREE$ = ADDR(NIL);

  18014 25 001155   000003 236000 26                 LDQ     3
        25 001156   200031 756100                    STQ     TREE$,,AUTO

      917    18015
      918    18016    5                LX_ETT$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$ -> LX_LIST.
             18016                         HEAD$;

  18016 25 001157   200021 474500                    LDP4    @SUM_CLAUSE$,,AUTO
        25 001160   400000 475500                    LDP5    0,,PR4
        25 001161   500001 476500                    LDP6    1,,PR5
        25 001162   600004 236100                    LDQ     4,,PR6
        25 001163   200024 756100                    STQ     LX_ETT$,,AUTO

      919    18017
      920    18018    6                DO WHILE (LX_ETT$ ~= ADDR(NIL));

  18018 25 001164   001207 710000 25                 TRA     s:18029

      921    18019
      922    18020                       %NEW_HEAP (@POINTER = HEAP$$);

  18022 25 001165   000013 236000 26                 LDQ     11
        25 001166   200043 756100                    STQ     ST$$+2,,AUTO
        25 001167   200027 630500                    EPPR0   HEAP$$,,AUTO
        25 001170   200042 450500                    STP0    ST$$+1,,AUTO
        25 001171   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001172   000011 631400 26                 EPPR1   9
        25 001173   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        25 001174   000000 011000                    NOP     0

      923    18025
      924    18026    6                  HEAP$$ -> LX_ETT_ITEM = LX_ETT$ -> LX_ETT_ITEM;

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:143  
  18026 25 001175   200024 470500                    LDP0    LX_ETT$,,AUTO
        25 001176   200027 471500                    LDP1    HEAP$$,,AUTO
        25 001177   000100 100500                    MLR     fill='000'O
        25 001200   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
        25 001201   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      925    18027    6                  HEAP$$ -> LX_ETT_ITEM.LINK = TREE$;

  18027 25 001202   200031 236100                    LDQ     TREE$,,AUTO
        25 001203   200027 471500                    LDP1    HEAP$$,,AUTO
        25 001204   100007 756100                    STQ     7,,PR1

      926    18028    6                  TREE$ = HEAP$$;

  18028 25 001205   200027 236100                    LDQ     HEAP$$,,AUTO
        25 001206   200031 756100                    STQ     TREE$,,AUTO

      927    18029    6                END; /* WHILE */

  18029 25 001207   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 001210   000003 116000 26                 CMPQ    3
        25 001211   001165 601000 25                 TNZ     s:18022

      928    18030    5              END;  /* DO */

      929    18031
      930    18032    4              HEAP$ = TREE$ -> LX_ETT_ITEM.LINK;

  18032 25 001212   200031 470500                    LDP0    TREE$,,AUTO
        25 001213   000007 236100                    LDQ     7,,PR0
        25 001214   000000 756000 23                 STQ     HEAP$

      931    18033    4              TREE$ -> LX_ETT_ITEM.LINK = ADDR(NIL);

  18033 25 001215   000003 236000 26                 LDQ     3
        25 001216   000007 756100                    STQ     7,,PR0

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:144  
      932    18034
      933    18035    5              DO WHILE (HEAP$ ~= ADDR(NIL));

  18035 25 001217   001300 710000 25                 TRA     s:18079

      934    18036
      935    18037                     %NEW (@TEMPLATE = BINARY_OP,
      936    18038                           @POINTER  = OP$);

  18044 25 001220   000013 236000 26                 LDQ     11
        25 001221   200043 756100                    STQ     ST$$+2,,AUTO
        25 001222   200030 630500                    EPPR0   OP$,,AUTO
        25 001223   200042 450500                    STP0    ST$$+1,,AUTO
        25 001224   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001225   000011 631400 26                 EPPR1   9
        25 001226   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        25 001227   000000 011000                    NOP     0

      937    18048
      938    18049                     %INIT_BINARY_OP (@POINTER = OP$,
      939    18050                                      @BERR    = "HEAP$ -> LX_ITEM.B.ERROR",
      940    18051                                      @LINE    = "HEAP$ -> LX_ITEM.LINE",
      941    18052                                      @COLUMN  = "HEAP$ -> LX_ITEM.COLUMN",
      942    18053                                      @ROP$    = HEAP$,
      943    18054                                      @LOP$    = TREE$,
      944    18055                                      @OP      = %OP_PLUS);

  18057 25 001230   000005 220003                    LDX0    5,DU
        25 001231   200030 470500                    LDP0    OP$,,AUTO
        25 001232   000000 740100                    STX0    0,,PR0

  18058 25 001233   000000 221003                    LDX1    0,DU
        25 001234   200030 470500                    LDP0    OP$,,AUTO
        25 001235   000000 441100                    SXL1    0,,PR0

  18060 25 001236   200030 470500                    LDP0    OP$,,AUTO
        25 001237   000000 471400 23                 LDP1    HEAP$
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:145  
        25 001240   100000 236100                    LDQ     0,,PR1
        25 001241   000000 676100                    ERQ     0,,PR0
        25 001242   400000 376007                    ANQ     -131072,DL
        25 001243   000000 656100                    ERSQ    0,,PR0

  18065 25 001244   000000 470400 23                 LDP0    HEAP$
        25 001245   200030 471500                    LDP1    OP$,,AUTO
        25 001246   000005 235100                    LDA     5,,PR0
        25 001247   100005 755100                    STA     5,,PR1

  18066 25 001250   200030 471500                    LDP1    OP$,,AUTO
        25 001251   000006 235100                    LDA     6,,PR0
        25 001252   100006 755100                    STA     6,,PR1

  18067 25 001253   000000 236000 23                 LDQ     HEAP$
        25 001254   200030 471500                    LDP1    OP$,,AUTO
        25 001255   100002 756100                    STQ     2,,PR1

  18068 25 001256   200031 236100                    LDQ     TREE$,,AUTO
        25 001257   200030 471500                    LDP1    OP$,,AUTO
        25 001260   100001 756100                    STQ     1,,PR1

  18069 25 001261   000020 235007                    LDA     16,DL
        25 001262   200030 471500                    LDP1    OP$,,AUTO
        25 001263   100003 755100                    STA     3,,PR1

  18070 25 001264   000003 236000 26                 LDQ     3
        25 001265   200030 471500                    LDP1    OP$,,AUTO
        25 001266   100007 756100                    STQ     7,,PR1

      945    18073
      946    18074    5                TREE$ = HEAP$;

  18074 25 001267   000000 236000 23                 LDQ     HEAP$
        25 001270   200031 756100                    STQ     TREE$,,AUTO

      947    18075    5                HEAP$ = TREE$ -> LX_ITEM.LINK;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:146  

  18075 25 001271   200031 471500                    LDP1    TREE$,,AUTO
        25 001272   100007 236100                    LDQ     7,,PR1
        25 001273   000000 756000 23                 STQ     HEAP$

      948    18076    5                TREE$ -> LX_ITEM.LINK = ADDR(NIL);

  18076 25 001274   000003 236000 26                 LDQ     3
        25 001275   100007 756100                    STQ     7,,PR1

      949    18077    5                TREE$ = OP$;

  18077 25 001276   200030 236100                    LDQ     OP$,,AUTO
        25 001277   200031 756100                    STQ     TREE$,,AUTO

      950    18078
      951    18079    5              END; /* WHILE */

  18079 25 001300   000000 236000 23                 LDQ     HEAP$
        25 001301   000003 116000 26                 CMPQ    3
        25 001302   001220 601000 25                 TNZ     s:18044

      952    18080
      953    18081                   %NEW_HEAP (@POINTER = SUM_LX_ETT$);

  18083 25 001303   000013 236000 26                 LDQ     11
        25 001304   200043 756100                    STQ     ST$$+2,,AUTO
        25 001305   200032 630500                    EPPR0   SUM_LX_ETT$,,AUTO
        25 001306   200042 450500                    STP0    ST$$+1,,AUTO
        25 001307   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001310   000011 631400 26                 EPPR1   9
        25 001311   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        25 001312   000000 011000                    NOP     0

      954    18086
      955    18087                   %INIT_LX_ETT_ITEM (@POINTER = SUM_LX_ETT$,
      956    18088                                      @TYPE    = %TYD,
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:147  
      957    18089                      @ETT$ = VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.SUM_ST_ILL$,
      958    18090                                      @LINE    = LINE_NO#,
      959    18091                                      @COLUMN  = 0);

  18093 25 001313   000004 220003                    LDX0    4,DU
        25 001314   200032 470500                    LDP0    SUM_LX_ETT$,,AUTO
        25 001315   000000 740100                    STX0    0,,PR0

  18094 25 001316   000000 221003                    LDX1    0,DU
        25 001317   200032 470500                    LDP0    SUM_LX_ETT$,,AUTO
        25 001320   000000 441100                    SXL1    0,,PR0

  18095 25 001321   200032 470500                    LDP0    SUM_LX_ETT$,,AUTO
        25 001322   000004 450100                    STZ     4,,PR0

  18096 25 001323   000003 236000 26                 LDQ     3
        25 001324   200032 470500                    LDP0    SUM_LX_ETT$,,AUTO
        25 001325   000007 756100                    STQ     7,,PR0

  18097 25 001326   200022 470500                    LDP0    @VAR_LTS$,,AUTO
        25 001327   000000 471500                    LDP1    0,,PR0
        25 001330   100012 473500                    LDP3    10,,PR1
        25 001331   300004 236100                    LDQ     4,,PR3
        25 001332   200032 474500                    LDP4    SUM_LX_ETT$,,AUTO
        25 001333   400001 756100                    STQ     1,,PR4

  18098 25 001334   000003 236000 26                 LDQ     3
        25 001335   200032 471500                    LDP1    SUM_LX_ETT$,,AUTO
        25 001336   100002 756100                    STQ     2,,PR1

  18100 25 001337   200033 235100                    LDA     LINE_NO#,,AUTO
        25 001340   200032 471500                    LDP1    SUM_LX_ETT$,,AUTO
        25 001341   100005 755100                    STA     5,,PR1

  18101 25 001342   200032 471500                    LDP1    SUM_LX_ETT$,,AUTO
        25 001343   100006 450100                    STZ     6,,PR1

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:148  
      960    18113
      961    18114                     %NEW (@TEMPLATE = BINARY_OP,
      962    18115                           @POINTER  = OP$);

  18121 25 001344   000013 236000 26                 LDQ     11
        25 001345   200043 756100                    STQ     ST$$+2,,AUTO
        25 001346   200030 631500                    EPPR1   OP$,,AUTO
        25 001347   200042 451500                    STP1    ST$$+1,,AUTO
        25 001350   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001351   000011 631400 26                 EPPR1   9
        25 001352   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        25 001353   000000 011000                    NOP     0

      963    18125
      964    18126                     %INIT_BINARY_OP (@POINTER = OP$,
      965    18127                                      @LINE    = LINE_NO#,
      966    18128                                      @COLUMN  = 0,
      967    18129                                      @ROP$    = TREE$,
      968    18130                                      @LOP$    = SUM_LX_ETT$,
      969    18131                                      @OP      = %OP_PLUS);

  18133 25 001354   000005 220003                    LDX0    5,DU
        25 001355   200030 470500                    LDP0    OP$,,AUTO
        25 001356   000000 740100                    STX0    0,,PR0

  18134 25 001357   000000 221003                    LDX1    0,DU
        25 001360   200030 470500                    LDP0    OP$,,AUTO
        25 001361   000000 441100                    SXL1    0,,PR0

  18141 25 001362   200033 235100                    LDA     LINE_NO#,,AUTO
        25 001363   200030 470500                    LDP0    OP$,,AUTO
        25 001364   000005 755100                    STA     5,,PR0

  18142 25 001365   200030 470500                    LDP0    OP$,,AUTO
        25 001366   000006 450100                    STZ     6,,PR0

  18143 25 001367   200031 236100                    LDQ     TREE$,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:149  
        25 001370   200030 470500                    LDP0    OP$,,AUTO
        25 001371   000002 756100                    STQ     2,,PR0

  18144 25 001372   200032 236100                    LDQ     SUM_LX_ETT$,,AUTO
        25 001373   200030 470500                    LDP0    OP$,,AUTO
        25 001374   000001 756100                    STQ     1,,PR0

  18145 25 001375   000020 236007                    LDQ     16,DL
        25 001376   200030 470500                    LDP0    OP$,,AUTO
        25 001377   000003 756100                    STQ     3,,PR0

  18146 25 001400   000003 236000 26                 LDQ     3
        25 001401   200030 470500                    LDP0    OP$,,AUTO
        25 001402   000007 756100                    STQ     7,,PR0

      970    18149
      971    18150    4              OP$ -> BINARY_OP.LINK = UPON_LTS$ -> REPORT_01_LTS.SPECIAL_SUBTOTAL$;

  18150 25 001403   200023 470500                    LDP0    UPON_LTS$,,AUTO
        25 001404   000016 236100                    LDQ     14,,PR0
        25 001405   200030 471500                    LDP1    OP$,,AUTO
        25 001406   100007 756100                    STQ     7,,PR1

      972    18151    4              UPON_LTS$ -> REPORT_01_LTS.SPECIAL_SUBTOTAL$ = OP$;

  18151 25 001407   200030 236100                    LDQ     OP$,,AUTO
        25 001410   000016 756100                    STQ     14,,PR0

      973    18152
      974    18153    4            END; /* DO */

      975    18154
      976    18155    3          UPON$$ = UPON$$ -> LX_LIST.LINK;

  18155 25 001411   200026 470500                    LDP0    UPON$$,,AUTO
        25 001412   000007 236100                    LDQ     7,,PR0
        25 001413   200026 756100                    STQ     UPON$$,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:150  

      977    18156
      978    18157    3        END;

  18157 25 001414   000003 116000 26                 CMPQ    3
        25 001415   001014 601000 25                 TNZ     s:17929

      979    18158
      980    18159
      981    18160
      982    18161
      983    18162    2    RETURN;

  18162 25 001416   200020 221300                    LDX1  ! ID$$+2,,AUTO
        25 001417   000001 702211                    TSX2  ! 1,X1

      984    18163    2    END BUILD_SUM_W_UPON;
      985    18164         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:151  
      986    18165
      987    18166         /*================*/
      988    18167    1      BUILD_SUM_N_UPON: PROC (SUM_CLAUSE$, VAR_LTS$);

  18167 25 001420   200020 741300       BUILD_SUM_N* STX1  ! ID$$+2,,AUTO

      989    18168         /*================*/
      990    18169
      991    18170        /*I*
      992    18171
      993    18172             NAME:  BUILD_SUM_N_UPON
      994    18173
      995    18174          DESCRIPTION: This routine validate the items in the SUM clause
      996    18175                       then an abstract syntax tree for a "plus" operation
      997    18176                       is built, in the later tim this tree will be used
      998    18177                       to generate the cross footing/rolling forward
      999    18178                       subroutine or the general subtotalling subroutine.
     1000    18179        */
     1001    18180
     1002    18181
     1003    18182    2   DCL SUM_CLAUSE$         PTR;
     1004    18183    2   DCL VAR_LTS$            PTR;
     1005    18184    2   DCL CTR_LTS$           PTR;
     1006    18185    2   DCL LX_ETT$            PTR;
     1007    18186    2   DCL ST$$               PTR;
     1008    18187    2   DCL SUM_BIT_ON         BIT (1) ALIGNED;
     1009    18188    2   DCL ELEM_LTS$          PTR;
     1010    18189    2   DCL OP$                PTR;
     1011    18190    2   DCL ITEM$              PTR;
     1012    18191    2   DCL SUM_LX_ETT$        PTR;
     1013    18192    2   DCL LINE_NO#           SBIN WORD;
     1014    18193
     1015    18194
     1016    18195    2          LINE_NO# = VAR_LTS$ -> REPORT_ELEM_LTS.ST$ -> ST.LINE_NO;

  18195 25 001421   200022 470500                    LDP0    @VAR_LTS$,,AUTO
        25 001422   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:152  
        25 001423   100003 473500                    LDP3    3,,PR1
        25 001424   300002 236100                    LDQ     2,,PR3
        25 001425   777777 376007                    ANQ     -1,DL
        25 001426   200033 756100                    STQ     LINE_NO#,,AUTO

     1017    18196    2          LX_ETT$ = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$ -> LX_LIST.HEAD$;

  18196 25 001427   200021 474500                    LDP4    @SUM_CLAUSE$,,AUTO
        25 001430   400000 475500                    LDP5    0,,PR4
        25 001431   500001 476500                    LDP6    1,,PR5
        25 001432   600004 236100                    LDQ     4,,PR6
        25 001433   200024 756100                    STQ     LX_ETT$,,AUTO

     1018    18197
     1019    18198    3      DO WHILE (LX_ETT$ ~= ADDR(NIL));

  18198 25 001434   001722 710000 25                 TRA     s:18335

     1020    18199
     1021    18200    4        DO CASE (LX_ETT$ -> LX_ETT_ITEM.TYPE);

  18200 25 001435   200024 470500                    LDP0    LX_ETT$,,AUTO
        25 001436   000004 235100                    LDA     4,,PR0
        25 001437   000024 115007                    CMPA    20,DL
        25 001440   001442 602005 25                 TNC     s:18200+5,AL
        25 001441   001551 710000 25                 TRA     s:18240
        25 001442   001466 710000 25                 TRA     s:18211
        25 001443   001466 710000 25                 TRA     s:18211
        25 001444   001466 710000 25                 TRA     s:18211
        25 001445   001466 710000 25                 TRA     s:18211
        25 001446   001466 710000 25                 TRA     s:18211
        25 001447   001466 710000 25                 TRA     s:18211
        25 001450   001551 710000 25                 TRA     s:18240
        25 001451   001466 710000 25                 TRA     s:18211
        25 001452   001551 710000 25                 TRA     s:18240
        25 001453   001551 710000 25                 TRA     s:18240
        25 001454   001551 710000 25                 TRA     s:18240
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:153  
        25 001455   001466 710000 25                 TRA     s:18211
        25 001456   001551 710000 25                 TRA     s:18240
        25 001457   001551 710000 25                 TRA     s:18240
        25 001460   001551 710000 25                 TRA     s:18240
        25 001461   001466 710000 25                 TRA     s:18211
        25 001462   001551 710000 25                 TRA     s:18240
        25 001463   001551 710000 25                 TRA     s:18240
        25 001464   001551 710000 25                 TRA     s:18240
        25 001465   001466 710000 25                 TRA     s:18211

     1022    18201
     1023    18202    4          CASE (

     1024    18203                     %SET_OF_NUMERIC_TYPES;
     1025    18206    4               );
     1026    18207
     1027    18208                   %FISH (TRIAD = LX_ETT$ -> LX_ETT_ITEM.ETT$,
     1028    18209                          RTN   = ST$$);

  18211 25 001466   000001 236100                    LDQ     1,,PR0
        25 001467   200025 756100                    STQ     ST$$,,AUTO

  18212 25 001470   200025 471500                    LDP1    ST$$,,AUTO
        25 001471   100000 220100                    LDX0    0,,PR1
        25 001472   000751 100003                    CMPX0   489,DU
        25 001473   001503 603000 25                 TRC     s:18218

  18213 25 001474   200025 470500                    LDP0    ST$$,,AUTO
        25 001475   000001 236100                    LDQ     1,,PR0
        25 001476   200025 756100                    STQ     ST$$,,AUTO

  18214 25 001477   200025 470500                    LDP0    ST$$,,AUTO
        25 001500   000000 220100                    LDX0    0,,PR0
        25 001501   000751 100003                    CMPX0   489,DU
        25 001502   001474 602000 25                 TNC     s:18213

     1029    18217
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:154  
     1030    18218    4              CALL  REP_ITEM_CHECK (LX_ETT$,

  18218 25 001503   000027 236000 26                 LDQ     23
        25 001504   200040 756100                    STQ     @ERR_NUMBER,,AUTO
        25 001505   200027 630500                    EPPR0   ELEM_LTS$,,AUTO
        25 001506   200037 450500                    STP0    @ELEM_LTS$,,AUTO
        25 001507   200026 631500                    EPPR1   SUM_BIT_ON,,AUTO
        25 001510   200036 451500                    STP1    @SUM_BIT,,AUTO
        25 001511   200024 633500                    EPPR3   LX_ETT$,,AUTO
        25 001512   200035 453500                    STP3    RSV_WRD#,,AUTO
        25 001513   000062 701000 25                 TSX1    REP_ITEM_CHECK
        25 001514   000000 011000                    NOP     0

     1031    18219    4                                    SUM_BIT_ON,
     1032    18220    4                                    ELEM_LTS$,
     1033    18221    4                                    %E$SUM_IN_SAME_REPORT);
     1034    18222
     1035    18223    4              IF SUM_BIT_ON THEN

  18223 25 001515   200026 234100                    SZN     SUM_BIT_ON,,AUTO
        25 001516   001573 605000 25                 TPL     s:18250

     1036    18224    5                DO;

     1037    18225    5                  CTR_LTS$ = ELEM_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ ->

  18225 25 001517   200027 470500                    LDP0    ELEM_LTS$,,AUTO
        25 001520   000012 471500                    LDP1    10,,PR0
        25 001521   100006 473500                    LDP3    6,,PR1
        25 001522   300014 236100                    LDQ     12,,PR3
        25 001523   200023 756100                    STQ     CTR_LTS$,,AUTO

     1038    18226    5                             SUM_LTS.REPORT_01_LTS$ -> REPORT_01_LTS.CONTROL_LTS$;
     1039    18227    5                  IF CTR_LTS$ -> CONTROL_NAME_LTS.LEVEL <

  18227 25 001524   200022 474500                    LDP4    @VAR_LTS$,,AUTO
        25 001525   400000 475500                    LDP5    0,,PR4
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:155  
        25 001526   500012 476500                    LDP6    10,,PR5
        25 001527   600006 477500                    LDP7    6,,PR6
        25 001530   700014 470500                    LDP0    12,,PR7
        25 001531   200023 471500                    LDP1    CTR_LTS$,,AUTO
        25 001532   100007 236100                    LDQ     7,,PR1
        25 001533   000007 116100                    CMPQ    7,,PR0
        25 001534   001573 605000 25                 TPL     s:18250

     1040    18228    5                     VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.REPORT_01_LTS$ ->
     1041    18229    5                     REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_NAME_LTS.LEVEL THEN
     1042    18230    6                    DO;

     1043    18231    6                      CALL Z8AE$ERROR (%E$EQU_OR_LOWER_LVL_SUM,

  18231 25 001535   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 001536   000006 036003                    ADLQ    6,DU
        25 001537   200044 756100                    STQ     ST$$+3,,AUTO
        25 001540   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 001541   000005 036003                    ADLQ    5,DU
        25 001542   000031 235000 26                 LDA     25
        25 001543   200042 757100                    STAQ    ST$$+1,,AUTO
        25 001544   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001545   000005 631400 26                 EPPR1   5
        25 001546   000000 701000 xent               TSX1    Z8AE$ERROR
        25 001547   000000 011000                    NOP     0

     1044    18232    6                                       LX_ETT$ -> LX_ITEM.LINE,
     1045    18233    6                                       LX_ETT$ -> LX_ITEM.COLUMN);
     1046    18234
     1047    18235    6                    END;

     1048    18236    5                END;

  18236 25 001550   001573 710000 25                 TRA     s:18250

     1049    18237
     1050    18238    4          CASE (ELSE);
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:156  

     1051    18239
     1052    18240    4              CALL Z8AE$ERROR (%E$NUMERIC_TYPE_EXPECTED,

  18240 25 001551   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 001552   000006 036003                    ADLQ    6,DU
        25 001553   200044 756100                    STQ     ST$$+3,,AUTO
        25 001554   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 001555   000005 036003                    ADLQ    5,DU
        25 001556   000023 235000 26                 LDA     19
        25 001557   200042 757100                    STAQ    ST$$+1,,AUTO
        25 001560   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001561   000005 631400 26                 EPPR1   5
        25 001562   000000 701000 xent               TSX1    Z8AE$ERROR
        25 001563   000000 011000                    NOP     0

     1053    18241    4                               LX_ETT$ -> LX_ITEM.LINE,
     1054    18242    4                               LX_ETT$ -> LX_ITEM.COLUMN);
     1055    18243
     1056    18244    4              LX_ETT$ -> LX_ETT_ITEM.ETT$ = COMCOM.VALUE_0;

  18244 25 001564   000124 236000 xsym               LDQ     COMCOM+84
        25 001565   200024 470500                    LDP0    LX_ETT$,,AUTO
        25 001566   000001 756100                    STQ     1,,PR0

     1057    18245    4              LX_ETT$ -> LX_ETT_ITEM.TYPE = %TYI;

  18245 25 001567   000001 235007                    LDA     1,DL
        25 001570   200024 470500                    LDP0    LX_ETT$,,AUTO
        25 001571   000004 755100                    STA     4,,PR0

     1058    18246    4              SUM_BIT_ON = FALSE;

  18246 25 001572   200026 450100                    STZ     SUM_BIT_ON,,AUTO

     1059    18247
     1060    18248    4        END; /* DO CASE */
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:157  

     1061    18249
     1062    18250    3        ITEM$ = LX_ETT$;

  18250 25 001573   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 001574   200031 756100                    STQ     ITEM$,,AUTO

     1063    18251    3        LX_ETT$ = ITEM$ -> LX_ITEM.LINK;

  18251 25 001575   200031 470500                    LDP0    ITEM$,,AUTO
        25 001576   000007 236100                    LDQ     7,,PR0
        25 001577   200024 756100                    STQ     LX_ETT$,,AUTO

     1064    18252    3        ITEM$ -> LX_ITEM.LINK = ADDR(NIL);

  18252 25 001600   000003 236000 26                 LDQ     3
        25 001601   000007 756100                    STQ     7,,PR0

     1065    18253
     1066    18254                   %NEW_HEAP (@POINTER = SUM_LX_ETT$);

  18256 25 001602   000013 236000 26                 LDQ     11
        25 001603   200043 756100                    STQ     ST$$+2,,AUTO
        25 001604   200032 631500                    EPPR1   SUM_LX_ETT$,,AUTO
        25 001605   200042 451500                    STP1    ST$$+1,,AUTO
        25 001606   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001607   000011 631400 26                 EPPR1   9
        25 001610   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        25 001611   000000 011000                    NOP     0

     1067    18259
     1068    18260                   %INIT_LX_ETT_ITEM (@POINTER = SUM_LX_ETT$,
     1069    18261                                      @TYPE    = %TYD,
     1070    18262                      @ETT$ = VAR_LTS$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.SUM_ST_ILL$,
     1071    18263                                      @LINE    = LINE_NO#,
     1072    18264                                      @COLUMN  = 0);

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:158  
  18266 25 001612   000004 220003                    LDX0    4,DU
        25 001613   200032 470500                    LDP0    SUM_LX_ETT$,,AUTO
        25 001614   000000 740100                    STX0    0,,PR0

  18267 25 001615   000000 221003                    LDX1    0,DU
        25 001616   200032 470500                    LDP0    SUM_LX_ETT$,,AUTO
        25 001617   000000 441100                    SXL1    0,,PR0

  18268 25 001620   200032 470500                    LDP0    SUM_LX_ETT$,,AUTO
        25 001621   000004 450100                    STZ     4,,PR0

  18269 25 001622   000003 236000 26                 LDQ     3
        25 001623   200032 470500                    LDP0    SUM_LX_ETT$,,AUTO
        25 001624   000007 756100                    STQ     7,,PR0

  18270 25 001625   200022 470500                    LDP0    @VAR_LTS$,,AUTO
        25 001626   000000 471500                    LDP1    0,,PR0
        25 001627   100012 473500                    LDP3    10,,PR1
        25 001630   300004 236100                    LDQ     4,,PR3
        25 001631   200032 474500                    LDP4    SUM_LX_ETT$,,AUTO
        25 001632   400001 756100                    STQ     1,,PR4

  18271 25 001633   000003 236000 26                 LDQ     3
        25 001634   200032 471500                    LDP1    SUM_LX_ETT$,,AUTO
        25 001635   100002 756100                    STQ     2,,PR1

  18273 25 001636   200033 235100                    LDA     LINE_NO#,,AUTO
        25 001637   200032 471500                    LDP1    SUM_LX_ETT$,,AUTO
        25 001640   100005 755100                    STA     5,,PR1

  18274 25 001641   200032 471500                    LDP1    SUM_LX_ETT$,,AUTO
        25 001642   100006 450100                    STZ     6,,PR1

     1073    18286
     1074    18287                     %NEW (@TEMPLATE = BINARY_OP,
     1075    18288                           @POINTER  = OP$);

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:159  
  18294 25 001643   000013 236000 26                 LDQ     11
        25 001644   200043 756100                    STQ     ST$$+2,,AUTO
        25 001645   200030 631500                    EPPR1   OP$,,AUTO
        25 001646   200042 451500                    STP1    ST$$+1,,AUTO
        25 001647   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001650   000011 631400 26                 EPPR1   9
        25 001651   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        25 001652   000000 011000                    NOP     0

     1076    18298
     1077    18299                     %INIT_BINARY_OP (@POINTER = OP$,
     1078    18300                                      @LINE    = LINE_NO#,
     1079    18301                                      @COLUMN  = 0,
     1080    18302                                      @ROP$    = ITEM$,
     1081    18303                                      @LOP$    = SUM_LX_ETT$,
     1082    18304                                      @OP      = %OP_PLUS);

  18306 25 001653   000005 220003                    LDX0    5,DU
        25 001654   200030 470500                    LDP0    OP$,,AUTO
        25 001655   000000 740100                    STX0    0,,PR0

  18307 25 001656   000000 221003                    LDX1    0,DU
        25 001657   200030 470500                    LDP0    OP$,,AUTO
        25 001660   000000 441100                    SXL1    0,,PR0

  18314 25 001661   200033 235100                    LDA     LINE_NO#,,AUTO
        25 001662   200030 470500                    LDP0    OP$,,AUTO
        25 001663   000005 755100                    STA     5,,PR0

  18315 25 001664   200030 470500                    LDP0    OP$,,AUTO
        25 001665   000006 450100                    STZ     6,,PR0

  18316 25 001666   200031 236100                    LDQ     ITEM$,,AUTO
        25 001667   200030 470500                    LDP0    OP$,,AUTO
        25 001670   000002 756100                    STQ     2,,PR0

  18317 25 001671   200032 236100                    LDQ     SUM_LX_ETT$,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:160  
        25 001672   200030 470500                    LDP0    OP$,,AUTO
        25 001673   000001 756100                    STQ     1,,PR0

  18318 25 001674   000020 236007                    LDQ     16,DL
        25 001675   200030 470500                    LDP0    OP$,,AUTO
        25 001676   000003 756100                    STQ     3,,PR0

  18319 25 001677   000003 236000 26                 LDQ     3
        25 001700   200030 470500                    LDP0    OP$,,AUTO
        25 001701   000007 756100                    STQ     7,,PR0

     1083    18322
     1084    18323    3              IF SUM_BIT_ON THEN

  18323 25 001702   200026 234100                    SZN     SUM_BIT_ON,,AUTO
        25 001703   001713 605000 25                 TPL     s:18331

     1085    18324    4                DO;

     1086    18325    4                  OP$ -> BINARY_OP.LINK = CTR_LTS$ -> CONTROL_NAME_LTS.SUM_SUBTOTAL$;

  18325 25 001704   200023 470500                    LDP0    CTR_LTS$,,AUTO
        25 001705   000005 236100                    LDQ     5,,PR0
        25 001706   200030 471500                    LDP1    OP$,,AUTO
        25 001707   100007 756100                    STQ     7,,PR1

     1087    18326    4                  CTR_LTS$ -> CONTROL_NAME_LTS.SUM_SUBTOTAL$ = OP$;

  18326 25 001710   200030 236100                    LDQ     OP$,,AUTO
        25 001711   000005 756100                    STQ     5,,PR0

     1088    18327
     1089    18328    4                END;

  18328 25 001712   001722 710000 25                 TRA     s:18335

     1090    18329    3              ELSE
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:161  
     1091    18330    4                DO;

     1092    18331    4                  OP$ -> BINARY_OP.LINK = O1COM.CURRENT_REPORT_LTS$ ->

  18331 25 001713   000064 470400 xsym               LDP0    O1COM+52
        25 001714   000010 236100                    LDQ     8,,PR0
        25 001715   200030 471500                    LDP1    OP$,,AUTO
        25 001716   100007 756100                    STQ     7,,PR1

     1093    18332    4                                          REPORT_LTS.GENERAL_SUBTOTAL$;
     1094    18333    4                  O1COM.CURRENT_REPORT_LTS$ -> REPORT_LTS.GENERAL_SUBTOTAL$ = OP$;

  18333 25 001717   200030 236100                    LDQ     OP$,,AUTO
        25 001720   000064 470400 xsym               LDP0    O1COM+52
        25 001721   000010 756100                    STQ     8,,PR0

     1095    18334    4                END;

     1096    18335    3            END; /* WHILE */

  18335 25 001722   200024 236100                    LDQ     LX_ETT$,,AUTO
        25 001723   000003 116000 26                 CMPQ    3
        25 001724   001435 601000 25                 TNZ     s:18200

     1097    18336
     1098    18337               %INIT_LX_LIST (@POINTER = SUM_CLAUSE$ -> DEFERED_SUM_CLAUSE.DEFERED_ID$);

  18339 25 001725   200021 470500                    LDP0    @SUM_CLAUSE$,,AUTO
        25 001726   000000 471500                    LDP1    0,,PR0
        25 001727   100001 473500                    LDP3    1,,PR1
        25 001730   000002 220003                    LDX0    2,DU
        25 001731   300000 740100                    STX0    0,,PR3

  18340 25 001732   000000 471500                    LDP1    0,,PR0
        25 001733   100001 473500                    LDP3    1,,PR1
        25 001734   000000 221003                    LDX1    0,DU
        25 001735   300000 441100                    SXL1    0,,PR3
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:162  

  18341 25 001736   000000 471500                    LDP1    0,,PR0
        25 001737   100001 473500                    LDP3    1,,PR1
        25 001740   000003 236000 26                 LDQ     3
        25 001741   300001 756100                    STQ     1,,PR3

  18342 25 001742   000000 471500                    LDP1    0,,PR0
        25 001743   100001 473500                    LDP3    1,,PR1
        25 001744   000003 236000 26                 LDQ     3
        25 001745   300004 756100                    STQ     4,,PR3

  18343 25 001746   000000 471500                    LDP1    0,,PR0
        25 001747   100001 473500                    LDP3    1,,PR1
        25 001750   300007 756100                    STQ     7,,PR3

  18344 25 001751   000000 471500                    LDP1    0,,PR0
        25 001752   100001 473500                    LDP3    1,,PR1
        25 001753   300002 450100                    STZ     2,,PR3

     1099    18347
     1100    18348    2    END BUILD_SUM_N_UPON;

  18348 25 001754   200020 221300                    LDX1  ! ID$$+2,,AUTO
        25 001755   000001 702211                    TSX2  ! 1,X1

     1101    18349         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:163  
     1102    18350
     1103    18351         /*=============*/
     1104    18352    1      GENERATE_SUBS: PROC;

  18352 25 001756   200010 741300       GENERATE_SU* STX1  ! NEXT$,,AUTO

     1105    18353         /*=============*/
     1106    18354
     1107    18355        /*I*
     1108    18356
     1109    18357             NAME:  GENERATE_SUBS
     1110    18358
     1111    18359          DESCRIPTION: This routine steps through the COMCOM.FILE_LTS_CHAIN$
     1112    18360                       and generates all the run time subroutines for every
     1113    18361                       report on the top of the procedure division. Reason
     1114    18362                       to do that is to solve the problem of phase 1 heap
     1115    18363                       not returned, or else the run time subroutines will be
     1116    18364                       generated on processing the INITIATE statement.
     1117    18365        */
     1118    18366
     1119    18367    2   DCL FILE_LTS$          PTR;
     1120    18368    2   DCL REP_LTS$           PTR;
     1121    18369    2   DCL LABEL$             PTR;
     1122    18370
     1123    18371
     1124    18372
     1125    18373    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, LABEL$);

  18373 25 001757   200013 630500                    EPPR0   LABEL$,,AUTO
        25 001760   200043 450500                    STP0    ST$$+2,,AUTO
        25 001761   000033 236000 26                 LDQ     27
        25 001762   200042 756100                    STQ     ST$$+1,,AUTO
        25 001763   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001764   000011 631400 26                 EPPR1   9
        25 001765   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        25 001766   000000 011000                    NOP     0

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:164  
     1126    18374
     1127    18375    2          CALL Z8EK$BRANCH (LABEL$);

  18375 25 001767   200013 630500                    EPPR0   LABEL$,,AUTO
        25 001770   200042 450500                    STP0    ST$$+1,,AUTO
        25 001771   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 001772   000000 631400 26                 EPPR1   0
        25 001773   000000 701000 xent               TSX1    Z8EK$BRANCH
        25 001774   000000 011000                    NOP     0

     1128    18376
     1129    18377    2          FILE_LTS$ = COMCOM.FILE_LTS_CHAIN$;

  18377 25 001775   000434 236000 xsym               LDQ     COMCOM+284
        25 001776   200011 756100                    STQ     FILE_LTS$,,AUTO

     1130    18378
     1131    18379    3          DO WHILE(FILE_LTS$ ~= ADDR(NIL));

  18379 25 001777   002034 710000 25                 TRA     s:18401

     1132    18380
     1133    18381    3            IF FILE_LTS$ -> FILE_LTS.REPORT$ ~= ADDR(NIL) THEN

  18381 25 002000   200011 470500                    LDP0    FILE_LTS$,,AUTO
        25 002001   000040 236100                    LDQ     32,,PR0
        25 002002   000003 116000 26                 CMPQ    3
        25 002003   002031 600000 25                 TZE     s:18400

     1134    18382    4              DO;

     1135    18383    4                REP_LTS$ = FILE_LTS$ -> FILE_LTS.REPORT$;

  18383 25 002004   200012 756100                    STQ     REP_LTS$,,AUTO

     1136    18384
     1137    18385    5                DO WHILE (REP_LTS$ ~= ADDR(NIL));
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:165  

  18385 25 002005   002027 710000 25                 TRA     s:18397

     1138    18386
     1139    18387    5                  IF REP_LTS$ -> REPORT_LTS.PAGE_COUNTER$ ~= ADDR(NIL) AND

  18387 25 002006   200012 470500                    LDP0    REP_LTS$,,AUTO
        25 002007   000017 236100                    LDQ     15,,PR0
        25 002010   000003 116000 26                 CMPQ    3
        25 002011   002024 600000 25                 TZE     s:18395
        25 002012   000003 430100                    FSZN    3,,PR0
        25 002013   002024 604000 25                 TMI     s:18395

     1140    18388    5                     NOT REP_LTS$ -> REPORT_LTS.B.REFERENCED THEN
     1141    18389    6                    DO;

     1142    18390    6                      REP_LTS$ -> REPORT_LTS.B.REFERENCED = TRUE;

  18390 25 002014   001000 236003                    LDQ     512,DU
        25 002015   000003 256100                    ORSQ    3,,PR0

     1143    18391
     1144    18392    6                      CALL Z8ET$CREATE_SUBROUTINES (REP_LTS$);

  18392 25 002016   200012 630500                    EPPR0   REP_LTS$,,AUTO
        25 002017   200042 450500                    STP0    ST$$+1,,AUTO
        25 002020   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 002021   000000 631400 26                 EPPR1   0
        25 002022   000000 701000 xent               TSX1    Z8ET$CREATE_SUBROUTINES
        25 002023   000000 011000                    NOP     0

     1145    18393    6                    END;

     1146    18394
     1147    18395    5                    REP_LTS$ = REP_LTS$ -> REPORT_LTS.LINK;

  18395 25 002024   200012 470500                    LDP0    REP_LTS$,,AUTO
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:166  
        25 002025   000043 236100                    LDQ     35,,PR0
        25 002026   200012 756100                    STQ     REP_LTS$,,AUTO

     1148    18396
     1149    18397    5                END; /* WHILE */

  18397 25 002027   000003 116000 26                 CMPQ    3
        25 002030   002006 601000 25                 TNZ     s:18387

     1150    18398    4            END;  /* IF */

     1151    18399
     1152    18400    3            FILE_LTS$ = FILE_LTS$ -> FILE_LTS.FILE_LTS_CHAIN$;

  18400 25 002031   200011 470500                    LDP0    FILE_LTS$,,AUTO
        25 002032   000003 236100                    LDQ     3,,PR0
        25 002033   200011 756100                    STQ     FILE_LTS$,,AUTO

     1153    18401    3          END; /* WHILE */

  18401 25 002034   000003 116000 26                 CMPQ    3
        25 002035   002000 601000 25                 TNZ     s:18381

     1154    18402
     1155    18403               %NEW_ILL (@ID     = %DEFLB,
     1156    18404                         @LABEL$ = LABEL$);

  18736 25 002036   000037 236000 26                 LDQ     31
        25 002037   200042 756100                    STQ     ST$$+1,,AUTO
        25 002040   200042 630500                    EPPR0   ST$$+1,,AUTO
        25 002041   200047 450500                    STP0    ST$$+6,,AUTO
        25 002042   000040 236000 26                 LDQ     32
        25 002043   200046 756100                    STQ     ST$$+5,,AUTO
        25 002044   000042 237000 26                 LDAQ    34
        25 002045   200044 757100                    STAQ    ST$$+3,,AUTO
        25 002046   200044 630500                    EPPR0   ST$$+3,,AUTO
        25 002047   000034 631400 26                 EPPR1   28
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:167  
        25 002050   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        25 002051   000000 011000                    NOP     0

  18737 25 002052   200013 236100                    LDQ     LABEL$,,AUTO
        25 002053   000000 470400 12                 LDP0    ILL$
        25 002054   000001 756100                    STQ     1,,PR0

     1157    18783
     1158    18784    2    END GENERATE_SUBS;

  18784 25 002055   200010 221300                    LDX1  ! NEXT$,,AUTO
        25 002056   000001 702211                    TSX2  ! 1,X1

     1159    18785         %EJECT;
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:168  
     1160    18786
     1161    18787         /* main routine */
     1162    18788
     1163    18789    1      CALL CREATE_SOURCE_ETT;

  18789 25 002057   000003 701000 25                 TSX1    CREATE_SOURCE_ETT
        25 002060   000000 011000                    NOP     0

     1164    18790
     1165    18791    1      CALL CREATE_REPORT_SUM;

  18791 25 002061   000206 701000 25                 TSX1    CREATE_REPORT_SUM
        25 002062   000000 011000                    NOP     0

     1166    18792
     1167    18793    1    END Z8ET$DEFERED_SUM_AND_SOURCE;

  18793 25 002063   000000 702200 xent               TSX2  ! X66_ARET
     1168    18794         %EOD;

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:169  
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8D_PIC_PARM.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$DEFERED_SUM_AND_SOURCE.
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:170  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 002 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 003 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 004 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:171  
  ****  Section 005 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 006 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 007 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 008 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 009 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 010 LblCom DNT_BUCKET_NUMBER

PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:172  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 011 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 012 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 013 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 014 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 015 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:173  

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 016 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 017 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 018 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)          1 MKCN

  ****  Section 019 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 020 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:174  

  ****  Section 021 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 022 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 023 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAP$

  ****  Section 024 LblCom TEMP_LX_NODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)         1 TEMP_LX_NODE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    30-0-0/w PTR         r     1 @CTR_LTS$                 37-0-0/w PTR         r     1 @ELEM_LTS$
    40-0-0/w PTR         r     1 @ERR_NUMBER               35-0-0/w PTR         r     1 @LX_ETT$
    30-0-0/w PTR         r     1 @LX_ETT$                  27-0-0/w PTR         r     1 @QUAL_ID$
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:175  
    36-0-0/w PTR         r     1 @SUM_BIT                  21-0-0/w PTR         r     1 @SUM_CLAUSE$
    21-0-0/w PTR         r     1 @SUM_CLAUSE$              21-0-0/w PTR         r     1 @SUM_CLAUSE$
    11-0-0/w PTR         r     1 @SUM_LIST$                12-0-0/w PTR         r     1 @VAR_LTS$
    22-0-0/w PTR         r     1 @VAR_LTS$                 27-0-0/w PTR         r     1 @VAR_LTS$
    22-0-0/w PTR         r     1 @VAR_LTS$                 22-0-0/w PTR         r     1 @VAR_LTS$
     3-0-0/w PTR         r     1 ASSOC_01_LTS$             34-0-0/w PTR         r     1 CTR$
    23-0-0/w PTR         r     1 CTR_LTS$                  *0-0-0/w PTR         r     1 CTR_LTS$
    23-0-0/w PTR         r     1 CTR_LTS$                  12-0-0/w PTR         r     1 ELEM_LTS$
    *0-0-0/w PTR         r     1 ELEM_LTS$                 27-0-0/w PTR         r     1 ELEM_LTS$
    *0-0-0/w UBIN        r     1 ERR_NUMBER                11-0-0/w PTR         r     1 FILE_LTS$
    27-0-0/w PTR         r     1 HEAP$$                     4-0-0/w SBIN        r     1 I
    16-0-0/w PTR               1 ID$$                      13-0-0/w PTR               1 ID_LIST$
    31-0-0/w PTR         r     1 ITEM$                     13-0-0/w PTR         r     1 LABEL$
    33-0-0/b UBIN(18)    r     1 LEN                       33-0-0/w SBIN        r     1 LINE_NO#
    33-0-0/w SBIN        r     1 LINE_NO#                   7-0-0/w PTR         r     1 LTS$$
    14-0-0/w PTR               1 LTS$$                     32-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LX_ETT$                   24-0-0/w PTR         r     1 LX_ETT$
    *0-0-0/w PTR         r     1 LX_ETT$                   24-0-0/w PTR         r     1 LX_ETT$
    24-0-0/w PTR         r     1 LX_ETT$                   10-0-0/w PTR         r     1 NEXT$
     7-0-0/w PTR         r     1 NEXT$                     30-0-0/w PTR         r     1 OP$
    30-0-0/w PTR         r     1 OP$                       *0-0-0/w PTR         r     1 QUAL_ID$
    12-0-0/w PTR         r     1 REP_LTS$                  35-0-0/w SBIN              1 RSV_WRD#
    41-0-0/w PTR         r     1 ST$$                      31-0-0/w PTR         r     1 ST$$
    25-0-0/w PTR         r     1 ST$$                      25-0-0/w PTR         r     1 ST$$
    11-0-0/w BIT         r     1 SUM_BIT                   *0-0-0/w BIT         r     1 SUM_BIT
    26-0-0/w BIT         r     1 SUM_BIT_ON                15-0-0/w PTR         r     1 SUM_CLAUSE$
    *0-0-0/w PTR         r     1 SUM_CLAUSE$               *0-0-0/w PTR         r     1 SUM_CLAUSE$
    *0-0-0/w PTR         r     1 SUM_CLAUSE$               *0-0-0/w PTR         r     1 SUM_LIST$
    32-0-0/w PTR         r     1 SUM_LX_ETT$               32-0-0/w PTR         r     1 SUM_LX_ETT$
    31-0-0/w PTR         r     1 TREE$                     26-0-0/w PTR         r     1 UPON$$
    23-0-0/w PTR         r     1 UPON_LTS$                 *0-0-0/w PTR         r     1 VAR_LTS$
    *0-0-0/w PTR         r     1 VAR_LTS$                  *0-0-0/w PTR         r     1 VAR_LTS$
    *0-0-0/w PTR         r     1 VAR_LTS$                  *0-0-0/w PTR         r     1 VAR_LTS$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:176  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)   r     1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)   r     1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)   r     1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)   r     1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)   r     1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)   r     1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:177  
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)  r     1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)   r     1 LTSS
     0-0-0/w STRC(36936) r     1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)   r     1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(216)         1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)   r     1 REPORT_01_LTS
     0-0-0/w STRC(432)   r     1 REPORT_ELEM_LTS            0-0-0/w STRC(252)         1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)  r     1 REPORT_LTS                 0-0-0/w STRC(288)         1 REWRITE_STMT
PL6.E3A0      #003=Z8ET$DEFERED_SUM_AND_SOURCE File=Z8ET.:Z8A6TSI                SAT 08/09/97 12:45 Page:178  
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(144)         1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)   r     1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(216)         1 USER_CALL                  0-0-0/w STRC(252)         1 USE_SUPP
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)         1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8ET$DEFERED_SUM_AND_SOURCE requires 1076 words for executable code.
   Procedure Z8ET$DEFERED_SUM_AND_SOURCE requires 40 words of local(AUTO) storage.

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:179  
     1169        1        /*T***********************************************************/
     1170        2        /*T*                                                         */
     1171        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1172        4        /*T*                                                         */
     1173        5        /*T***********************************************************/
     1174        6
     1175        7        /*M*  Z8ET$CREATE_SUBROUTINES---Create 10 run time subroutines */
     1176        8
     1177        9
     1178       10        /*P*
     1179       11               NAME:  Z8ET$CREATE_SUBROUTINES
     1180       12             AUTHOR:  Min Lee.
     1181       13            PURPOSE:  Creates 10 run time subroutines to be executed by
     1182       14                      Report Writer Control System.
     1183       15        */
     1184       16
     1185       17        /*D*
     1186       18               NAME:  Z8ET$CREATE_SUBROUTINES
     1187       19               CALL:  CALL Z8ET$CREATE_SUBROUTINES (LTS$$)
     1188       20              INPUT:  LTS$$ --- Pointed to a REPORT's LTS item.
     1189       21
     1190       22
     1191       23
     1192       24        DESCRIPTION:  These are the 10 run time subroutines generated by these
     1193       25                      modules:
     1194       26                      1. Top of Page subroutine---by CREATE_TOP_PAGE_SUB
     1195       27                      2. Formatting Subroutine ---by CREATE_FORMATTING_SUB
     1196       28                      3. Control Item Initial Subroutine--by CREATE_SHADOW_INIT_SUB
     1197       29                      4. Control Break Identification Sub--by CREATE_CONTROL_DETECT_SUB
     1198       30                      5. Control Item Swapback Subroutine--by CREATE_SHADOW_SWAP_SUB
     1199       31                      6. Sum Counter Clear Subroutine--by GEN_CLEAR_SUB
     1200       32                      7. Sum Counter Resetting Subroutine--by GEN_RESET_SUB
     1201       33                      8. Cross Footing/Rolling forward Sub--by GEN_CROSS_ROLL_SUB
     1202       34                      9. General Subtotaling Subroutine--by GEN_GENERAL_SUB
     1203       35                     10. Special Subtotaling Subroutine--by GEN_SPECIAL_SUB
     1204       36         */
     1205       37         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:180  
     1206       38
     1207       39         /*=======================*/
     1208       40           Z8ET$CREATE_SUBROUTINES:  PROC (LTS$$);
     1209       41         /*=======================*/
     1210       42        %EQU PHASE = 1;
     1211       43        %EQU DEFAULT_REPORT_CODE = 55;  /* report code for display item is 00 */
     1212       44
     1213       45        %INCLUDE Z8A_DEFC;
     1214      113        %INCLUDE Z8A_SUPP_MAC ;
     1215     2513        %INCLUDE Z8A_COMCOM ;
     1216     3163        %INCLUDE Z8E_STACKS ;
     1217     5429        %INCLUDE Z8E_O1COM;
     1218     6190        %INCLUDE Z8E_MACROS;
     1219     6865        %INCLUDE Z8A_DNT ;
     1220     7086        %INCLUDE Z8A_ST ;
     1221    10745        %INCLUDE Z8A_TYPES;
     1222    10919        %INCLUDE Z8A_QLT;
     1223    11025        %INCLUDE Z8A_ETT ;
     1224    11326        %INCLUDE Z8A_ILL ;
     1225    12019        %INCLUDE Z8A_ILS ;
     1226    12128        %INCLUDE Z8A_LTS ;
     1227    14205        %INCLUDE Z8A_MKCN;
     1228    14222        %INCLUDE Z8E_HEAP ;
     1229    14278        %INCLUDE Z8E_ABSSYN;
     1230    14484        %INCLUDE X9A_IO;
     1231    14634        %INCLUDE Z9A_SUPP_MAC;
     1232    14923
     1233    14924
     1234    14925    1   DCL Z8E5$MATH_PACK ENTRY(2) ;
     1235    14926    1   DCL Z8EX$SET_INDEX  ENTRY(2);
     1236    14927    1   DCL Z8EK$BRANCH          ENTRY(1);
     1237    14928    1   DCL Z8EK$BRANCH_TRUE     ENTRY(2);
     1238    14929    1   DCL Z8EK$BRANCH_FALSE    ENTRY(2);
     1239    14930    1   DCL Z8ED$DISPOSE_ABSSYN_TREE ENTRY(1);
     1240    14931    1   DCL Z8AF$FORME       ENTRY(4) ;
     1241    14932    1   DCL Z8AF$NEW_BASE    ENTRY(3);
     1242    14933    1   DCL Z8AC$MAKE_CONST               ENTRY(1);
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:181  
     1243    14934    1   DCL Z8AC$MAKE_TYA_CONST           ENTRY(4);
     1244    14935    1   DCL Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2);
     1245    14936    1   DCL Z8E7$MOVE      ENTRY(2) ;
     1246    14937    1   DCL Z8AT$CREATE_TEMPORARY ENTRY(2) ;
     1247    14938    1   DCL Z9EN$WRITE_NEXT ENTRY(7);
     1248    14939    1   DCL Z9EN$WRITE_PAGE ENTRY(3);
     1249    14940
     1250    14941    1   DCL REPORT_CODE_NO     UBIN WORD;
     1251    14942    1   DCL RWCT_LEN           SBIN WORD;
     1252    14943    1   DCL LAST_WORD_OFFSET   SBIN WORD;
     1253    14944
     1254    14945    1   DCL I                  SBIN WORD;
     1255    14946    1   DCL SA_ADJ             SBIN WORD;
     1256    14947    1   DCL CONST_ETT$         PTR;
     1257    14948    1   DCL LTS$$              PTR;
     1258    14949    1   DCL BUFFER_ETT$        PTR;
     1259    14950    1   DCL PAGE_COUNTER_ETT$  PTR;
     1260    14951    1   DCL LINE_COUNTER_ETT$  PTR;
     1261    14952    1   DCL AFTER_AREA_ETT$    PTR;
     1262    14953    1   DCL SEND_ETT$          PTR;
     1263    14954    1   DCL RECV_ETT$          PTR;
     1264    14955    1   DCL CODE_ETT$          PTR;
     1265    14956    1   DCL IND$$              PTR;
     1266    14957    1   DCL IND_ETT$           PTR;
     1267    14958    1   DCL RECORD_LEN         SBIN WORD;
     1268    14959    1   DCL MIN_REC_LEN        SBIN WORD;
     1269    14960    1   DCL CURRENT$       PTR;
     1270    14961    1   DCL PHONY_LTS$         PTR;
     1271    14962    1   DCL FILE_LTS$          PTR;
     1272    14963    1   DCL VAL_ST$            PTR;
     1273    14964    1   DCL ALL_BIT            BIT (1) ALIGNED;
     1274    14965
     1275    14966
     1276    14967
     1277    14968        %DCL_AUTO_LX_ITEM (@NAME = AFTER_FIELD);
     1278    14972        %DCL_AUTO_LX_ITEM (@NAME = LINE_COUNTER_FIELD);
     1279    14976
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:182  
     1280    14977    1   DCL DETAIL_GRP$    PTR;
     1281    14978
     1282    14979        %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
     1283    14983        %DCL_AUTO_LX_ITEM (@NAME = OP_NODE);
     1284    14987        %DCL_AUTO_LX_ITEM (@NAME = SEND_FIELD);
     1285    14991        %DCL_AUTO_LX_ITEM (@NAME = RECV_FIELD);
     1286    14995        %DCL_AUTO_LX_ITEM (@NAME = RECORD_LENGTH);
     1287    14999        %DCL_AUTO_LX_ITEM (@NAME = LINE_FIELD);
     1288    15003        %DCL_AUTO_LX_ITEM (@NAME = ZERO);
     1289    15007        %DCL_AUTO_LX_ITEM (@NAME = COMPARE);
     1290    15011        %DCL_AUTO_LX_ITEM (@NAME = IND_FIELD);
     1291    15015        %DCL_AUTO_LX_ITEM (@NAME = ONE_FIELD);
     1292    15019        %DCL_AUTO_LX_ITEM (@NAME = CTR_LVL_FIELD);
     1293    15023    1   DCL CTR_LVL_ETT$           PTR;
     1294    15024
     1295    15025        %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:183  
     1296    15026         %MACRO SUB_HEAD (OFFSET_V = ,
     1297    15027                          RWCT_PTR = );
     1298    15028           DO;
     1299    15029
     1300    15030               CALL Z8AT$CREATE_TEMPORARY (%PARA, LABEL$);
     1301    15031
     1302    15032               LABEL$ -> LABEL.B.REFERENCED = TRUE;
     1303    15033               LABEL$ -> LABEL.B.USE_PROC = TRUE;
     1304    15034
     1305    15035               %NEW_ILL (@ID       = %DEFLB,
     1306    15036                         @LABEL$   = LABEL$);
     1307    15037
     1308    15038               %NEW_ILL (@ID       = %P_A_PRESET,
     1309    15039                         @OFFSET   = OFFSET_V,
     1310    15040                         @TO       = RWCT_PTR,
     1311    15041                         @LOP      = LABEL$,
     1312    15042                         @ROPCON   = 0);
     1313    15043
     1314    15044               %NEW_ILL (@ID       = %USE_ENTRY,
     1315    15045                         @CODE     = %DB_EXCEPT_PROC);
     1316    15046
     1317    15047           END;
     1318    15048         %MEND;
     1319    15049         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:184  
     1320    15050
     1321    15051
     1322    15052
     1323    15053         /*===================*/
     1324    15054    1      CREATE_TOP_PAGE_SUB: PROC;
     1325    15055         /*===================*/
     1326    15056
     1327    15057        /*I*
     1328    15058
     1329    15059             NAME:  CREATE_TOP_PAGE_SUB
     1330    15060
     1331    15061          DESCRIPTION: This routine creates the top of page subroutine
     1332    15062                       that will initiate the line counter to 0, add 1 to
     1333    15063                       the page counter, clear the report line buffer,
     1334    15064                       advance to the top of the next page.
     1335    15065        */
     1336    15066
     1337    15067
     1338    15068    2   DCL LABEL$         PTR;
     1339    15069    2   DCL SEND$          PTR;
     1340    15070    2   DCL RECV$          PTR;
     1341    15071
     1342    15072
     1343    15073
     1344    15074
     1345    15075               %SUB_HEAD (OFFSET_V = %TOP_OF_PAGE_OFF,
     1346    15076                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);
     1347    16226
     1348    16227               /* MOVE 0 TO LINE COUNTER */
     1349    16228
     1350    16229               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(SEND_FIELD)",
     1351    16230                                  @TYPE    = %TYI,
     1352    16231                                  @ETT$    = COMCOM.VALUE_0);
     1353    16253
     1354    16254               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     1355    16255                                  @TYPE    = %TYI,
     1356    16256                                  @ETT$    = LINE_COUNTER_ETT$);
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:185  
     1357    16278
     1358    16279    2          CALL Z8E7$MOVE (ADDR(RECV_FIELD), ADDR(SEND_FIELD));
     1359    16280
     1360    16281               /* ADD 1 TO PAGE COUNTER */
     1361    16282
     1362    16283               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     1363    16284                                  @TYPE    = %TYI,
     1364    16285                                  @ETT$    = PAGE_COUNTER_ETT$);
     1365    16307
     1366    16308               %INIT_BINARY_OP (@POINTER   = "ADDR(OP_NODE)",
     1367    16309                                @ROP$      = "ADDR(ONE_FIELD)",
     1368    16310                                @LOP$      = "ADDR(RECV_FIELD)",
     1369    16311                                @OP        = %OP_PLUS);
     1370    16329
     1371    16330    2          CALL Z8E5$MATH_PACK (ADDR(OP_NODE),
     1372    16331    2                               ADDR(ETT_ITEM));
     1373    16332
     1374    16333    2          CALL Z8E7$MOVE (ADDR(RECV_FIELD),
     1375    16334    2                          ADDR(ETT_ITEM));
     1376    16335
     1377    16336               /* CLEAR THE BUFFER */
     1378    16337
     1379    16338                   %NEW_ILL (@ID   = %MVAN,
     1380    16339                             @LOP  = BUFFER_ETT$,
     1381    16340                             @ROP  = CODE_ETT$);
     1382    16719
     1383    16720               /* WRITE AFTER ADVANING PAGE */
     1384    16721
     1385    16722    2          RECORD_LEN = MIN_REC_LEN; /* initialize the RECORD_LEN */
     1386    16723
     1387    16724    2          CALL Z8AC$LX_ETT_ITEM_TYI_CONST ( RECORD_LEN,
     1388    16725    2                                           ADDR(RECORD_LENGTH));
     1389    16726
     1390    16727    2          CALL Z9EN$WRITE_PAGE (FILE_LTS$,
     1391    16728    2                                ADDR(NIL),
     1392    16729    2                                ADDR(NIL) );
     1393    16730
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:186  
     1394    16731               %DB_EXCEPT_LIBRARY_RETURN;
     1395    17115
     1396    17116    2    END CREATE_TOP_PAGE_SUB;
     1397    17117         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:187  
     1398    17118
     1399    17119         /*=====================*/
     1400    17120    1      CREATE_FORMATTING_SUB:  PROC (GROUP$);
     1401    17121         /*=====================*/
     1402    17122
     1403    17123        /*I*
     1404    17124
     1405    17125             NAME:  CREATE_FORMATTING_SUB
     1406    17126
     1407    17127          DESCRIPTION: This routine creates the formatting subroutine for
     1408    17128                       each printable group--i.e. at least one LINE clause
     1409    17129                       specified in that group. It steps through the 01 group
     1410    17130                       entry to the last entry that subordinats to this group
     1411    17131                       entry, creates ILLs to advance lines for the LINE clause,
     1412    17132                       formaating the print line buffer according the specified
     1413    17133                       COLUMN clauses, codes that conditionally prints the
     1414    17134                       printable item will be generated if the GROUP INDICATE
     1415    17135                       clause presented.
     1416    17136        */
     1417    17137
     1418    17138
     1419    17139    2   DCL GROUP$         PTR;
     1420    17140    2   DCL CURRENT$       PTR;
     1421    17141    2   DCL NEXT$          PTR;
     1422    17142    2   DCL LABEL$         PTR;
     1423    17143    2   DCL PREV$          PTR;
     1424    17144    2   DCL LINE_SPAN      SBIN WORD;
     1425    17145    2    DCL LINE_NO#      UBIN WORD;
     1426    17146    2   DCL ST$$           PTR;
     1427    17147    2   DCL ST_TYPE        UBIN WORD;
     1428    17148    2   DCL BYTE_POS       UBIN WORD;
     1429    17149    2   DCL WORD_POS       UBIN WORD;
     1430    17150    2   DCL QLT$$          PTR;
     1431    17151    2   DCL RECV_ST$       PTR;
     1432    17152    2   DCL BUF_ST$        PTR;
     1433    17153
     1434    17154
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:188  
     1435    17155        %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:189  
     1436    17156
     1437    17157        %MACRO NEW_EDIT_ST (@ETT$ = RECV_ETT$);
     1438    17158           DO;
     1439    17159
     1440    17160             %RESERVE_ST (POINTER = ST$$);
     1441    17161
     1442    17162             ST$$ -> SCALAR = @ETT$ -> ETT.LOP -> SCALAR;
     1443    17163
     1444    17164             %NEW_QLT (@POINTER = QLT$$,
     1445    17165                       @FATHER  = LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.QLT$,
     1446    17166                       @BROTHER = LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.QLT$ -> QLT.SON,
     1447    17167                       @ST$     = ST$$,
     1448    17168                       @DNT$    = ST$$ -> ST.DNT$,
     1449    17169                       @LEVEL#  = 2);
     1450    17170
     1451    17171               LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.QLT$ -> QLT.SON = QLT$$;
     1452    17172
     1453    17173             ST$$ -> SCALAR.QLT$ = QLT$$;
     1454    17174             ST$$ -> SCALAR.B.REDEF_SUB = TRUE;
     1455    17175             ST$$ -> SCALAR.COUNT = LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.COUNT;
     1456    17176             @ETT$ -> ETT.LOP = ST$$;
     1457    17177
     1458    17178           END;
     1459    17179         %MEND;
     1460    17180
     1461    17181
     1462    17182         %MACRO EDIT_PRINTABLE_ITEM (@FROM = ,
     1463    17183                                     @TO   = );
     1464    17184           DO;
     1465    17185             RECORD_LEN = 0;  /* initialize the record length */
     1466    17186             DO WHILE (@FROM ~= @TO -> REPORT_GRP_LTS.NEXT);
     1467    17187
     1468    17188               IF @FROM -> LTS.ID = %REPORT_ELEM_LTS AND
     1469    17189                  @FROM -> REPORT_ELEM_LTS.B.PRINTABLE  THEN
     1470    17190
     1471    17191                 DO;
     1472    17192
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:190  
     1473    17193                   ALL_BIT = FALSE;
     1474    17194
     1475    17195                   IF @FROM -> REPORT_ELEM_LTS.B.SUM_PRESENTED THEN
     1476    17196                     DO;
     1477    17197                       SEND_ETT$ = @FROM -> REPORT_ELEM_LTS.SUM_LTS$ ->
     1478    17198                                   SUM_LTS.SUM_ST_ILL$;
     1479    17199                       RECV_ETT$ = @FROM -> REPORT_ELEM_LTS.SUM_LTS$ ->
     1480    17200                                   SUM_LTS.EDIT_ST_ILL$;
     1481    17201                     END;
     1482    17202                   ELSE
     1483    17203                     DO;
     1484    17204                       CALL Z8AF$NEW_BASE (@FROM -> REPORT_ELEM_LTS.ST$,
     1485    17205                                           ADDR(NIL),
     1486    17206                                           RECV_ETT$);
     1487    17207
     1488    17208                       IF @FROM -> REPORT_ELEM_LTS.B.SOURCE_PRESENTED THEN
     1489    17209                         SEND_ETT$ = @FROM -> REPORT_ELEM_LTS.SOURCE_ETT$;
     1490    17210                       ELSE
     1491    17211                         DO;
     1492    17212
     1493    17213                           SEND_ETT$ = @FROM -> REPORT_ELEM_LTS.VALUE_ETT$;
     1494    17214
     1495    17215                           %FISH (TRIAD = SEND_ETT$,
     1496    17216                                  RTN   = VAL_ST$);
     1497    17217
     1498    17218                           IF VAL_ST$ -> ST.ID = %CONST THEN
     1499    17219                             ALL_BIT = VAL_ST$ -> CONST.B.ALL;
     1500    17220
     1501    17221                         END;
     1502    17222
     1503    17223                     END;
     1504    17224
     1505    17225                   IF RECV_ETT$ -> ETT.ID = %BASE THEN
     1506    17226                     %NEW_EDIT_ST (@ETT$ = RECV_ETT$);
     1507    17227                   ELSE
     1508    17228                     %NEW_EDIT_ST (@ETT$ = RECV_ETT$ -> ETT.LOP);
     1509    17229
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:191  
     1510    17230                   %FISH (TRIAD = RECV_ETT$,  RTN = RECV_ST$);
     1511    17231
     1512    17232                   %FISH (TRIAD = BUFFER_ETT$,  RTN = BUF_ST$);
     1513    17233
     1514    17234
     1515    17235                   RECV_ST$ -> ST.R = BUF_ST$ -> ST.R;
     1516    17236                   RECV_ST$ -> ST.COUNT = BUF_ST$ -> ST.COUNT;
     1517    17237                   RECV_ST$ -> ST.SA = (@FROM -> REPORT_ELEM_LTS.COLUMN_NO# + SA_ADJ) / 4 ;
     1518    17238           RECV_ST$ -> ST.ADSC.CN = MOD((@FROM -> REPORT_ELEM_LTS.COLUMN_NO# + SA_ADJ) , 4);
     1519    17239                   RECORD_LEN = @FROM -> REPORT_ELEM_LTS.COLUMN_NO# +
     1520    17240                                @FROM -> REPORT_ELEM_LTS.SPAN + SA_ADJ;
     1521    17241
     1522    17242                   LINE_NO# = RECV_ST$ -> ST.LINE_NO;
     1523    17243
     1524    17244                   %GET_TYPE (@ETT$  = SEND_ETT$);
     1525    17245
     1526    17246                   %INIT_LX_ETT_ITEM (@POINTER = "ADDR(SEND_FIELD)",
     1527    17247                                      @TYPE    = ST_TYPE,
     1528    17248                                      @ALL     = ALL_BIT,
     1529    17249                                      @ETT$    = SEND_ETT$,
     1530    17250                                      @LINE    = LINE_NO#,
     1531    17251                                      @COLUMN  = 0);
     1532    17252
     1533    17253                   %GET_TYPE (@ETT$  = RECV_ETT$);
     1534    17254
     1535    17255                   %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     1536    17256                                      @TYPE    = ST_TYPE,
     1537    17257                                      @ETT$    = RECV_ETT$,
     1538    17258                                      @LINE    = LINE_NO#,
     1539    17259                                      @COLUMN  = 0);
     1540    17260
     1541    17261                   IF @FROM -> REPORT_ELEM_LTS.B.GROUP_INDICATE THEN
     1542    17262                     DO;
     1543    17263
     1544    17264                       CALL Z8AT$CREATE_TEMPORARY(%PARA, IND$$);
     1545    17265
     1546    17266                       %INIT_BINARY_OP (@POINTER = "ADDR(COMPARE)",
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:192  
     1547    17267                                        @LOP$    = "ADDR(IND_FIELD)",
     1548    17268                                        @ROP$    = "ADDR(ZERO)",
     1549    17269                                        @OP      = %OP_EQUAL);
     1550    17270
     1551    17271                       CALL Z8EK$BRANCH_TRUE (IND$$,
     1552    17272                                              ADDR(COMPARE));
     1553    17273
     1554    17274                       CALL Z8E7$MOVE (ADDR(RECV_FIELD),
     1555    17275                                       ADDR(SEND_FIELD));
     1556    17276
     1557    17277                       %NEW_ILL (@ID     = %DEFLB,
     1558    17278                                 @LABEL$ = IND$$);
     1559    17279
     1560    17280                     END;
     1561    17281                   ELSE
     1562    17282                     CALL Z8E7$MOVE (ADDR(RECV_FIELD),
     1563    17283                                     ADDR(SEND_FIELD));
     1564    17284
     1565    17285                 END;  /* END IF */
     1566    17286
     1567    17287               @FROM = @FROM -> REPORT_GRP_LTS.NEXT;
     1568    17288
     1569    17289             END; /* WHILE */
     1570    17290
     1571    17291           END;
     1572    17292         %MEND;
     1573    17293
     1574    17294         %MACRO GET_TYPE (@TYPE = ST_TYPE,
     1575    17295                          @ETT$ = SEND_ETT$);
     1576    17296           DO;
     1577    17297             %FISH (TRIAD = @ETT$,
     1578    17298                    RTN   = ST$$);
     1579    17299
     1580    17300             @TYPE = ST$$ -> ST.TYPE;
     1581    17301           END;
     1582    17302         %MEND;
     1583    17303         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:193  
     1584    17304
     1585    17305    2          IF GROUP$ -> REPORT_01_LTS.FIRST_LINE.LTS$ = ADDR(NIL)
     1586    17306    2            THEN
     1587    17307    2              RETURN;
     1588    17308
     1589    17309               %SUB_HEAD (OFFSET_V = %FORMATTING_SUB_OFF,
     1590    17310                          RWCT_PTR = GROUP$ -> REPORT_01_LTS.RWCT$);
     1591    18460
     1592    18461               /* CLEAR THE BUFFER */
     1593    18462
     1594    18463                   %NEW_ILL (@ID   = %MVAN,
     1595    18464                             @LOP  = BUFFER_ETT$,
     1596    18465                             @ROP  = CODE_ETT$);
     1597    18844
     1598    18845               /* PRINT THE FIRST LINE OF THIS GROUP */
     1599    18846
     1600    18847    2          CURRENT$ = GROUP$;
     1601    18848
     1602    18849    2          NEXT$ = GROUP$ -> REPORT_01_LTS.FIRST_LINE.LTS$;
     1603    18850    2          PREV$ = NEXT$;
     1604    18851
     1605    18852    3          DO WHILE (NEXT$ -> REPORT_GRP_LTS.NEXT ~= ADDR(NIL)  AND
     1606    18853    3             NOT NEXT$ -> REPORT_GRP_LTS.NEXT -> REPORT_GRP_LTS.B.LINE_PRESENTED);
     1607    18854
     1608    18855    3            NEXT$ = NEXT$ -> REPORT_GRP_LTS.NEXT;
     1609    18856
     1610    18857    3          END; /* WHILE */
     1611    18858
     1612    18859               %EDIT_PRINTABLE_ITEM (@FROM = CURRENT$,
     1613    18860                                     @TO   = NEXT$);
     1614    19517
     1615    19518    2            IF RECORD_LEN < MIN_REC_LEN THEN
     1616    19519    2              RECORD_LEN = MIN_REC_LEN;
     1617    19520
     1618    19521    2          CALL Z8AC$LX_ETT_ITEM_TYI_CONST (RECORD_LEN,
     1619    19522    2                                           ADDR(RECORD_LENGTH));
     1620    19523
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:194  
     1621    19524    2          CALL Z9EN$WRITE_NEXT (FILE_LTS$,
     1622    19525    2                                ADDR(NIL),
     1623    19526    2                                ADDR(NIL),
     1624    19527    2                                ADDR(RECORD_LENGTH),
     1625    19528    2                                ADDR(AFTER_FIELD),
     1626    19529    2                                %AFTER_LINES,
     1627    19530    2                                REPORT_CODE_NO);
     1628    19531
     1629    19532               /* PRINT THE REMAINING LINES */
     1630    19533
     1631    19534    2          NEXT$ = NEXT$ -> REPORT_GRP_LTS.NEXT;
     1632    19535
     1633    19536    3          DO WHILE (NEXT$ ~= ADDR(NIL));
     1634    19537
     1635    19538    3            CURRENT$ = NEXT$;
     1636    19539
     1637    19540    3            IF CURRENT$ -> REPORT_GRP_LTS.LINE_TYPE = %REPORT_LINE_INT THEN
     1638    19541    3              LINE_SPAN = CURRENT$ -> REPORT_GRP_LTS.LINE_NO# -
     1639    19542    3                          PREV$ -> REPORT_GRP_LTS.LINE_NO#;
     1640    19543    3            ELSE
     1641    19544    3              LINE_SPAN = CURRENT$ -> REPORT_GRP_LTS.LINE_NO#;
     1642    19545
     1643    19546                   /* UPDATE LINE COUNTER */
     1644    19547
     1645    19548    3            MKCN.CON = LINE_SPAN;
     1646    19549
     1647    19550    3            CALL Z8AC$MAKE_CONST (CONST_ETT$);
     1648    19551
     1649    19552                 %INIT_LX_ETT_ITEM (@POINTER = "ADDR(LINE_FIELD)",
     1650    19553                                    @TYPE    = %TYI,
     1651    19554                                    @ETT$    = CONST_ETT$);
     1652    19576
     1653    19577                 %INIT_BINARY_OP (@POINTER   = "ADDR(OP_NODE)",
     1654    19578                                  @ROP$      = "ADDR(LINE_FIELD)",
     1655    19579                                  @LOP$      = "ADDR(LINE_COUNTER_FIELD)",
     1656    19580                                  @OP        = %OP_PLUS);
     1657    19598
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:195  
     1658    19599    3            CALL Z8E5$MATH_PACK (ADDR(OP_NODE),
     1659    19600    3                                 ADDR(ETT_ITEM));
     1660    19601
     1661    19602    3            CALL Z8E7$MOVE (ADDR(LINE_COUNTER_FIELD),
     1662    19603    3                            ADDR(ETT_ITEM));
     1663    19604
     1664    19605    3            PREV$ = NEXT$;
     1665    19606
     1666    19607                 /* BLANK OUT THE BUFFER */
     1667    19608
     1668    19609
     1669    19610                   %NEW_ILL (@ID   = %MVAN,
     1670    19611                             @LOP  = BUFFER_ETT$,
     1671    19612                             @ROP  = CODE_ETT$);
     1672    19991
     1673    19992    4            DO WHILE (NEXT$ -> REPORT_GRP_LTS.NEXT ~= ADDR(NIL)  AND
     1674    19993    4               NOT NEXT$ -> REPORT_GRP_LTS.NEXT -> REPORT_GRP_LTS.B.LINE_PRESENTED);
     1675    19994
     1676    19995    4              NEXT$ = NEXT$ -> REPORT_GRP_LTS.NEXT;
     1677    19996
     1678    19997    4            END; /* WHILE */
     1679    19998
     1680    19999                 %EDIT_PRINTABLE_ITEM (@FROM = CURRENT$,
     1681    20000                                       @TO   = NEXT$);
     1682    20657
     1683    20658    3            IF RECORD_LEN < MIN_REC_LEN THEN
     1684    20659    3              RECORD_LEN = MIN_REC_LEN;
     1685    20660
     1686    20661    3            CALL Z8AC$LX_ETT_ITEM_TYI_CONST (RECORD_LEN,
     1687    20662    3                                             ADDR(RECORD_LENGTH));
     1688    20663
     1689    20664    3            CALL Z9EN$WRITE_NEXT (FILE_LTS$,
     1690    20665    3                                  ADDR(NIL),
     1691    20666    3                                  ADDR(NIL),
     1692    20667    3                                  ADDR(RECORD_LENGTH),
     1693    20668    3                                  ADDR(LINE_FIELD),
     1694    20669    3                                  %AFTER_LINES,
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:196  
     1695    20670    3                                  REPORT_CODE_NO);
     1696    20671
     1697    20672
     1698    20673    3            NEXT$ = NEXT$ -> REPORT_GRP_LTS.NEXT;
     1699    20674
     1700    20675    3          END; /* OUTER WHILE */
     1701    20676
     1702    20677               %DB_EXCEPT_LIBRARY_RETURN;
     1703    21061
     1704    21062    2    END CREATE_FORMATTING_SUB;
     1705    21063         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:197  
     1706    21064         /*================*/
     1707    21065    1      BUILD_FORMAT_SUB: PROC;
     1708    21066         /*================*/
     1709    21067
     1710    21068        /*I*
     1711    21069
     1712    21070             NAME:  BUILD_FORMAT_SUB
     1713    21071
     1714    21072          DESCRIPTION: This routine steps through the report LTS item and
     1715    21073                       calls CREATE_FORMATTING_SUB to create the subroutines
     1716    21074                       that will print--- report heading, report footing,
     1717    21075                       detail, page heading, page footing, control heading
     1718    21076                       and control footing groups.
     1719    21077        */
     1720    21078
     1721    21079
     1722    21080    2          IF LTS$$ -> REPORT_LTS.REPORT_HEADING$ ~= ADDR(NIL) THEN
     1723    21081    2              CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.REPORT_HEADING$);
     1724    21082
     1725    21083    2          IF LTS$$ -> REPORT_LTS.REPORT_FOOTING$ ~= ADDR(NIL) THEN
     1726    21084    2              CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.REPORT_FOOTING$);
     1727    21085
     1728    21086    2          IF LTS$$ -> REPORT_LTS.PAGE_HEADING$ ~= ADDR(NIL) THEN
     1729    21087    2              CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.PAGE_HEADING$);
     1730    21088
     1731    21089    2          IF LTS$$ -> REPORT_LTS.PAGE_FOOTING$ ~= ADDR(NIL) THEN
     1732    21090    2              CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.PAGE_FOOTING$);
     1733    21091
     1734    21092    2          DETAIL_GRP$ = LTS$$ -> REPORT_LTS.DETAIL$;
     1735    21093
     1736    21094    3          DO WHILE (DETAIL_GRP$ ~= ADDR(NIL));
     1737    21095
     1738    21096    3            IF DETAIL_GRP$ -> REPORT_01_LTS.B.GROUP_INDICATE THEN
     1739    21097    4              DO;
     1740    21098    4                CALL Z8AF$NEW_BASE (DETAIL_GRP$ -> REPORT_01_LTS.GROUP_INDICATOR$,
     1741    21099    4                                    ADDR(NIL),
     1742    21100    4                                    IND_ETT$);
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:198  
     1743    21101
     1744    21102                     %INIT_LX_ETT_ITEM (@POINTER = "ADDR(IND_FIELD)",
     1745    21103                                        @TYPE    = %TYI,
     1746    21104                                        @ETT$    = IND_ETT$);
     1747    21126
     1748    21127    4              END;
     1749    21128
     1750    21129    3            CALL CREATE_FORMATTING_SUB (DETAIL_GRP$);
     1751    21130
     1752    21131    3            DETAIL_GRP$ = DETAIL_GRP$ -> REPORT_01_LTS.LINK;
     1753    21132
     1754    21133    3          END; /* WHILE */
     1755    21134
     1756    21135    2          IF LTS$$ -> REPORT_LTS.B.CONTROL_FINAL THEN
     1757    21136    3            DO;
     1758    21137    3              IF LTS$$ -> REPORT_LTS.CONTROL_FINAL$ -> CONTROL_NAME_LTS.
             21137                       CONTROL_HEADING$
     1759    21138    3                          ~= ADDR(NIL) THEN
     1760    21139    3                CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.CONTROL_FINAL$ ->
     1761    21140    3                          CONTROL_NAME_LTS.CONTROL_HEADING$);
     1762    21141
     1763    21142    3              IF LTS$$ -> REPORT_LTS.CONTROL_FINAL$ -> CONTROL_NAME_LTS.
             21142                       CONTROL_FOOTING$
     1764    21143    3                          ~= ADDR(NIL) THEN
     1765    21144    3                CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.CONTROL_FINAL$ ->
     1766    21145    3                          CONTROL_NAME_LTS.CONTROL_FOOTING$);
     1767    21146
     1768    21147    3            END;
     1769    21148
     1770    21149    2          IF LTS$$ -> REPORT_LTS.CONTROL$ ~= ADDR(NIL) THEN
     1771    21150    3            DO;
     1772    21151    4              DO I = 1 TO LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.N - 3;
     1773    21152    4                IF LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.P$(I) ->
     1774    21153    4                          CONTROL_NAME_LTS.CONTROL_HEADING$ ~= ADDR(NIL) THEN
     1775    21154    4                  CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.CONTROL$ ->
     1776    21155    4                          LTS_PTR_ARRAY.P$ (I) -> CONTROL_NAME_LTS.CONTROL_HEADING$);
     1777    21156    4                IF LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.P$(I) ->
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:199  
     1778    21157    4                          CONTROL_NAME_LTS.CONTROL_FOOTING$ ~= ADDR(NIL) THEN
     1779    21158    4                  CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.CONTROL$ ->
     1780    21159    4                          LTS_PTR_ARRAY.P$ (I) -> CONTROL_NAME_LTS.CONTROL_FOOTING$);
     1781    21160
     1782    21161    4              END;
     1783    21162    3            END;
     1784    21163
     1785    21164    2          LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.B.ELEMENTARY = FALSE;
     1786    21165
     1787    21166    2    END BUILD_FORMAT_SUB;
     1788    21167         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:200  
     1789    21168
     1790    21169         /*============*/
     1791    21170    1      STORE_EDITED:  PROC (CONTROL$$);
     1792    21171         /*============*/
     1793    21172
     1794    21173        /*I*
     1795    21174
     1796    21175             NAME:  STORE_EDITED
     1797    21176
     1798    21177          DESCRIPTION: When a control item's data type is numeric edited
     1799    21178                       or alphanumeric edited, they need special processes,
     1800    21179                       i.e. save there data type and pretend that they are
     1801    21180                       type alphanumeric during the swapping process.
     1802    21181         */
     1803    21182
     1804    21183    2    DCL CONTROL$$         PTR;
     1805    21184    2    DCL NAME$             PTR;
     1806    21185    2    DCL ST$$              PTR;
     1807    21186
     1808    21187
     1809    21188    3      DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;
     1810    21189
     1811    21190    3        NAME$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);
     1812    21191    3        ST$$ = NAME$ -> CONTROL_NAME_LTS.ST$;
     1813    21192
     1814    21193    3        IF ST$$ -> SCALAR.B.CLASS = %CLASS_NUMERIC_EDITED OR
     1815    21194    3           ST$$ -> SCALAR.B.CLASS = %CLASS_ALPHANUMERIC_EDITED THEN
     1816    21195    4          DO;
     1817    21196    4            NAME$ -> CONTROL_NAME_LTS.B.CLASS_EDITED = TRUE;
     1818    21197    4            NAME$ -> CONTROL_NAME_LTS.B.CLASS = ST$$ -> SCALAR.B.CLASS;
     1819    21198    4            ST$$ -> SCALAR.B.CLASS = %CLASS_ALPHANUMERIC;
     1820    21199    4          END;
     1821    21200    3        ELSE
     1822    21201    3          NAME$ -> CONTROL_NAME_LTS.B.CLASS_EDITED = FALSE;
     1823    21202
     1824    21203    3      END;
     1825    21204
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:201  
     1826    21205    2    END STORE_EDITED;
     1827    21206         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:202  
     1828    21207
     1829    21208         /*==============*/
     1830    21209    1      RESTORE_EDITED: PROC (CONTROL$$);
     1831    21210         /*==============*/
     1832    21211
     1833    21212        /*I*
     1834    21213
     1835    21214             NAME:  RESTORE_EDITED
     1836    21215
     1837    21216          DESCRIPTION: This routine restore the original data type of the
     1838    21217                       edited type control items after the swapping process.
     1839    21218         */
     1840    21219
     1841    21220
     1842    21221    2    DCL CONTROL$$         PTR;
     1843    21222    2    DCL ST$$              PTR;
     1844    21223    2    DCL NAME$             PTR;
     1845    21224
     1846    21225
     1847    21226    3      DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;
     1848    21227
     1849    21228    3        NAME$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);
     1850    21229
     1851    21230    3        IF NAME$ -> CONTROL_NAME_LTS.B.CLASS_EDITED THEN
     1852    21231    3           NAME$ -> CONTROL_NAME_LTS.ST$ -> SCALAR.B.CLASS =
     1853    21232    3             NAME$ -> CONTROL_NAME_LTS.B.CLASS;
     1854    21233
     1855    21234    3      END;
     1856    21235    2    END RESTORE_EDITED;
     1857    21236         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:203  
     1858    21237
     1859    21238         /*================*/
     1860    21239    1      BUILD_CTR_FIELDS: PROC (CONTROL$$);
     1861    21240         /*================*/
     1862    21241
     1863    21242        /*I*
     1864    21243
     1865    21244             NAME:  BUILD_CTR_FIELD
     1866    21245
     1867    21246          DESCRIPTION: This routine creates the ST and LX_ETT items for
     1868    21247                       shadow and temporary field of the control items.
     1869    21248        */
     1870    21249
     1871    21250
     1872    21251    2   DCL CONTROL$$          PTR;
     1873    21252    2   DCL NAME$              PTR;
     1874    21253    2   DCL ETT$$              PTR;
     1875    21254    2   DCL ST$$               PTR;
     1876    21255
     1877    21256
     1878    21257        %MACRO BUILD_LX_ETT (@ST$$ = ,
     1879    21258                             @FIELD$ = );
     1880    21259           DO;
     1881    21260               ST$$ = @ST$$;
     1882    21261               CALL Z8AF$NEW_BASE (ST$$,
     1883    21262                                   ADDR(NIL),
     1884    21263                                   ETT$$);
     1885    21264
     1886    21265               %NEW_HEAP (@POINTER = @FIELD$);
     1887    21266
     1888    21267               %INIT_LX_ETT_ITEM (@POINTER = @FIELD$,
     1889    21268                                  @TYPE    = ST$$ -> SCALAR.TYPE,
     1890    21269                                  @ETT$    = ETT$$);
     1891    21270
     1892    21271           END;
     1893    21272        %MEND;
     1894    21273        %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:204  
     1895    21274
     1896    21275
     1897    21276    3          DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;
     1898    21277
     1899    21278    3            NAME$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);
     1900    21279
     1901    21280    3            IF NAME$ -> CONTROL_NAME_LTS.ST$ -> SCALAR.TYPE = %TYX  OR
     1902    21281    3               NAME$ -> CONTROL_NAME_LTS.ST$ -> SCALAR.TYPE = %TYY THEN
     1903    21282    3               NAME$ -> CONTROL_NAME_LTS.ST$ = NAME$ -> CONTROL_NAME_LTS.ST$ ->
     1904    21283    3               SCALAR.QLT$ -> QLT.BROTHER -> QLT.ST$;
     1905    21284
     1906    21285
     1907    21286    3            CALL CREATE_SHADOW_ST (NAME$ -> CONTROL_NAME_LTS.ST$,
     1908    21287    3                                   NAME$ -> CONTROL_NAME_LTS.TEMP$);
     1909    21288
     1910    21289    3            CALL CREATE_SHADOW_ST (NAME$ -> CONTROL_NAME_LTS.ST$,
     1911    21290    3                                   NAME$ -> CONTROL_NAME_LTS.SHADOW$);
     1912    21291
     1913    21292                 %BUILD_LX_ETT (@ST$$ = NAME$ -> CONTROL_NAME_LTS.ST$,
     1914    21293                                @FIELD$ = NAME$ -> CONTROL_NAME_LTS.ST_FIELD$);
     1915    21330
     1916    21331                 %BUILD_LX_ETT (@ST$$ = NAME$ -> CONTROL_NAME_LTS.TEMP$,
     1917    21332                                @FIELD$ = NAME$ -> CONTROL_NAME_LTS.TEMP_FIELD$);
     1918    21369
     1919    21370                 %BUILD_LX_ETT (@ST$$ = NAME$ -> CONTROL_NAME_LTS.SHADOW$,
     1920    21371                                @FIELD$ = NAME$ -> CONTROL_NAME_LTS.SHADOW_FIELD$);
     1921    21408
     1922    21409    3          END;
     1923    21410
     1924    21411    2    END BUILD_CTR_FIELDS;
     1925    21412         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:205  
     1926    21413
     1927    21414         /*==================*/
     1928    21415    1      DISPOSE_CTR_FIELDS: PROC (CONTROL$$);
     1929    21416         /*==================*/
     1930    21417
     1931    21418        /*I*
     1932    21419
     1933    21420             NAME:  DISPOSE_CTR_FIELD
     1934    21421
     1935    21422          DESCRIPTION: This routine disposes LX_ETT items for st,
     1936    21423                       shadow and temporary field of the control items.
     1937    21424        */
     1938    21425
     1939    21426
     1940    21427    2   DCL CONTROL$$      PTR;
     1941    21428
     1942    21429
     1943    21430
     1944    21431    3          DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;
     1945    21432
     1946    21433    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) ->
             21433                     CONTROL_NAME_LTS.ST_FIELD$);
     1947    21434
     1948    21435    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) ->
             21435                     CONTROL_NAME_LTS.TEMP_FIELD$);
     1949    21436
     1950    21437    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) ->
             21437                     CONTROL_NAME_LTS.SHADOW_FIELD$);
     1951    21438
     1952    21439    3          END;
     1953    21440
     1954    21441    2    END DISPOSE_CTR_FIELDS;
     1955    21442         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:206  
     1956    21443
     1957    21444         /*================*/
     1958    21445    1      CREATE_SHADOW_ST: PROC (ITEM$, SHADOW$);
     1959    21446         /*================*/
     1960    21447
     1961    21448        /*I*
     1962    21449
     1963    21450             NAME:  CREATE_SHADOW_ST
     1964    21451
     1965    21452          DESCRIPTION: This routine creates ST item and initialize the
     1966    21453                       st item for calling module.
     1967    21454        */
     1968    21455
     1969    21456
     1970    21457    2   DCL ITEM$              PTR;
     1971    21458    2   DCL SHADOW$            PTR;
     1972    21459
     1973    21460
     1974    21461
     1975    21462    2          CALL Z8AT$CREATE_TEMPORARY (%SCALAR, SHADOW$);
     1976    21463
     1977    21464    2          SHADOW$ -> SCALAR.DESCL = ITEM$ -> SCALAR.DESCL;
     1978    21465    2          SHADOW$ -> SCALAR.ADSC.CN = 0;
     1979    21466    2          SHADOW$ -> SCALAR.B.LENGTH_4096 = ITEM$ -> SCALAR.B.LENGTH_4096;
     1980    21467    2          SHADOW$ -> SCALAR.B.CLASS = ITEM$ -> SCALAR.B.CLASS;
     1981    21468    2          SHADOW$ -> SCALAR.TYPE = ITEM$ -> SCALAR.TYPE;
     1982    21469    2          SHADOW$ -> SCALAR.LTS$ = ITEM$ -> SCALAR.LTS$;
     1983    21470    2          SHADOW$ -> SCALAR.B.DML_TYPE = ITEM$ -> SCALAR.B.DML_TYPE;
     1984    21471
     1985    21472    2    END CREATE_SHADOW_ST;
     1986    21473         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:207  
     1987    21474
     1988    21475         /*======================*/
     1989    21476    1      CREATE_SHADOW_INIT_SUB: PROC (CONTROL$$);
     1990    21477         /*======================*/
     1991    21478
     1992    21479        /*I*
     1993    21480
     1994    21481             NAME:  CREATE_SHADOW_INIT_SUB
     1995    21482
     1996    21483          DESCRIPTION: This routine creates shadow item initialize
     1997    21484                       subroutine that will executed by the RWCS to
     1998    21485                       initialize the shadow field of the control items.
     1999    21486        */
     2000    21487
     2001    21488
     2002    21489    2   DCL CONTROL$$      PTR;
     2003    21490    2   DCL LABEL$         PTR;
     2004    21491
     2005    21492
     2006    21493
     2007    21494               %SUB_HEAD (OFFSET_V = %CTR_SHADOW_INIT_OFF,
     2008    21495                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);
     2009    22645
     2010    22646    3          DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;
     2011    22647
     2012    22648    3            IF CONTROL$$ -> LTS_PTR_ARRAY.P$(I) ->
     2013    22649    3               CONTROL_NAME_LTS.ST_FIELD$ -> LX_ETT_ITEM.TYPE = %TYX THEN
     2014    22650    3              CALL Z8EX$SET_INDEX (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS
             22650                       .SHADOW_FIELD$,
     2015    22651    3                            CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.
             22651                                     ST_FIELD$);
     2016    22652    3            ELSE
     2017    22653    3              CALL Z8E7$MOVE (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.
             22653                       SHADOW_FIELD$,
     2018    22654    3                            CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.
             22654                                     ST_FIELD$);
     2019    22655
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:208  
     2020    22656    3          END;
     2021    22657
     2022    22658               %DB_EXCEPT_LIBRARY_RETURN;
     2023    23042
     2024    23043    2    END CREATE_SHADOW_INIT_SUB;
     2025    23044         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:209  
     2026    23045
     2027    23046         /*=====================*/
     2028    23047    1      CREATE_CTR_DETECT_SUB: PROC (CONTROL$$);
     2029    23048         /*=====================*/
     2030    23049
     2031    23050        /*I*
     2032    23051
     2033    23052             NAME:  CREATE_CTR_DETECT_SUB
     2034    23053
     2035    23054          DESCRIPTION: This routine creates control break detect subroutine
     2036    23055                       that will executed by the RWCS to compare the control
     2037    23056                       items with its shadow fields to determine the break.
     2038    23057        */
     2039    23058
     2040    23059
     2041    23060    2   DCL LBL$$ (0:25)       PTR;
     2042    23061    2   DCL LABEL$             PTR;
     2043    23062    2   DCL CTR_LVL_NO#        SBIN WORD;
     2044    23063    2   DCL CONTROL$$          PTR;
     2045    23064    2   DCL NAME$$             PTR;
     2046    23065    2   DCL TARGET_NO#         SBIN WORD;
     2047    23066    2   DCL END_LABEL$         PTR;
     2048    23067
     2049    23068
     2050    23069
     2051    23070               %SUB_HEAD (OFFSET_V = %CTR_BREAK_OFF,
     2052    23071                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);
     2053    24221
     2054    24222    2          IF LTS$$ -> REPORT_LTS.B.CONTROL_FINAL THEN
     2055    24223    2            CTR_LVL_NO# = 2;
     2056    24224    2          ELSE
     2057    24225    2            CTR_LVL_NO# = 1;
     2058    24226
     2059    24227    2          MKCN.CON = CTR_LVL_NO#;
     2060    24228
     2061    24229    2          CALL Z8AC$MAKE_CONST (CONST_ETT$);
     2062    24230
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:210  
     2063    24231               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(SEND_FIELD)",
     2064    24232                              @TYPE    = %TYI,
     2065    24233                              @ETT$    = CONST_ETT$);
     2066    24255
     2067    24256    2          CALL Z8E7$MOVE (ADDR(CTR_LVL_FIELD),
     2068    24257    2                          ADDR(SEND_FIELD));
     2069    24258
     2070    24259               %INIT_BINARY_OP (@POINTER = "ADDR(OP_NODE)",
     2071    24260                                @ROP$    = "ADDR(ONE_FIELD)",
     2072    24261                                @LOP$    = "ADDR(CTR_LVL_FIELD)",
     2073    24262                                @OP      = %OP_PLUS);
     2074    24280
     2075    24281    2          CALL Z8E5$MATH_PACK (ADDR(OP_NODE),
     2076    24282    2                               ADDR(ETT_ITEM));
     2077    24283
     2078    24284    2          TARGET_NO# = CONTROL$$ -> LTS_PTR_ARRAY.N - 3;
     2079    24285
     2080    24286    3          DO I = 1 TO TARGET_NO#;
     2081    24287
     2082    24288    3            CALL Z8AT$CREATE_TEMPORARY (%PARA, LBL$$(I));
     2083    24289
     2084    24290                 %INIT_BINARY_OP (@POINTER = "ADDR(COMPARE)",
     2085    24291                                  @LOP$    =
             24291                            "CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.ST_FIELD$"
             24291                                      ,
     2086    24292                                  @ROP$    =
             24292                        "CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.SHADOW_FIELD$"
             24292                                      ,
     2087    24293                                  @OP      = %OP_EQUAL);
     2088    24311
     2089    24312    3            CALL Z8EK$BRANCH_FALSE (LBL$$(I),
     2090    24313    3                                    ADDR(COMPARE));
     2091    24314
     2092    24315    3            IF I < TARGET_NO# THEN
     2093    24316    4              DO;
     2094    24317
     2095    24318    4                CALL Z8E7$MOVE (ADDR(CTR_LVL_FIELD),
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:211  
     2096    24319    4                                ADDR(ETT_ITEM));
     2097    24320
     2098    24321    4              END;
     2099    24322    3            ELSE
     2100    24323    4              DO;
     2101    24324    4                CALL Z8E7$MOVE (ADDR(CTR_LVL_FIELD),
     2102    24325    4                                ADDR(ZERO));
     2103    24326    4              END;
     2104    24327
     2105    24328    3          END; /* DO LOOP */
     2106    24329
     2107    24330    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, END_LABEL$);
     2108    24331
     2109    24332    2          CALL Z8EK$BRANCH (END_LABEL$);
     2110    24333
     2111    24334    3          DO I = 1 TO TARGET_NO#;
     2112    24335
     2113    24336    3            NAME$$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);
     2114    24337
     2115    24338                 %NEW_ILL (@ID    = %DEFLB,
     2116    24339                       @LABEL$ = "LBL$$(I)");
     2117    24718
     2118    24719    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.TEMP_FIELD$,
     2119    24720    3                            NAME$$ -> CONTROL_NAME_LTS.ST_FIELD$);
     2120    24721
     2121    24722    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.ST_FIELD$,
     2122    24723    3                            NAME$$ -> CONTROL_NAME_LTS.SHADOW_FIELD$);
     2123    24724
     2124    24725    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.SHADOW_FIELD$,
     2125    24726    3                            NAME$$ -> CONTROL_NAME_LTS.TEMP_FIELD$);
     2126    24727
     2127    24728    3          END; /* DO LOOP */
     2128    24729
     2129    24730               %NEW_ILL (@ID   = %DEFLB,
     2130    24731                         @LABEL$ = END_LABEL$);
     2131    25110
     2132    25111               %DB_EXCEPT_LIBRARY_RETURN;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:212  
     2133    25495
     2134    25496    2    END CREATE_CTR_DETECT_SUB;
     2135    25497         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:213  
     2136    25498
     2137    25499         /*======================*/
     2138    25500    1      CREATE_SHADOW_SWAP_SUB: PROC(CONTROL$$);
     2139    25501         /*======================*/
     2140    25502
     2141    25503        /*I*
     2142    25504
     2143    25505             NAME:  CREATE_SHADOW_SWAP_SUB
     2144    25506
     2145    25507          DESCRIPTION: This routine creates shadow swap subroutine
     2146    25508                       that will executed by the RWCS to swap the control
     2147    25509                       items with its shadow fields.
     2148    25510        */
     2149    25511
     2150    25512
     2151    25513    2   DCL CONTROL$$      PTR;
     2152    25514    2   DCL LABEL$         PTR;
     2153    25515    2   DCL CTR_FINAL_IND  SBIN WORD;
     2154    25516    2   DCL LBL$$ (0 : 25) PTR;
     2155    25517    2   DCL ETT$$          PTR;
     2156    25518    2   DCL END_LABEL$     PTR;
     2157    25519    2   DCL START_LABEL$   PTR;
     2158    25520    2   DCL NAME$$         PTR;
     2159    25521    2   DCL TARGET_NO#     SBIN WORD;
     2160    25522    2   DCL CETT$$         PTR;
     2161    25523
     2162    25524               %SUB_HEAD (OFFSET_V = %CTR_ITEM_SWAP_OFF,
     2163    25525                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);
     2164    26675
     2165    26676    2          TARGET_NO# = CONTROL$$ -> LTS_PTR_ARRAY.N - 3;
     2166    26677
     2167    26678    2          IF LTS$$ -> REPORT_LTS.B.CONTROL_FINAL THEN
     2168    26679    2            MKCN.CON = TARGET_NO# + 2;
     2169    26680    2          ELSE
     2170    26681    2            MKCN.CON = TARGET_NO# + 1;
     2171    26682
     2172    26683    2          CALL Z8AC$MAKE_CONST (CONST_ETT$);
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:214  
     2173    26684
     2174    26685    2          CALL Z8AF$FORME (%CMPI,
     2175    26686    2                           CTR_LVL_ETT$,
     2176    26687    2                           CONST_ETT$,
     2177    26688    2                           CETT$$);
     2178    26689
     2179    26690    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, END_LABEL$);
     2180    26691
     2181    26692    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, START_LABEL$);
     2182    26693
     2183    26694    2          START_LABEL$ -> LABEL.B.GO_VECTOR_START = TRUE;
     2184    26695    2          START_LABEL$ -> LABEL.P_END$ = END_LABEL$;
     2185    26696
     2186    26697    2          CALL Z8AF$NEW_BASE (START_LABEL$,
     2187    26698    2                              ADDR(NIL),
     2188    26699    2                              ETT$$);
     2189    26700    2          CALL Z8AF$FORME (%SSOP,
     2190    26701    2                           ETT$$,
     2191    26702    2                           CTR_LVL_ETT$,
     2192    26703    2                           ETT$$);
     2193    26704
     2194    26705               %NEW_ILL (@ID   = %GO,
     2195    26706                         @CODE = %GO_LESS_THAN_LOGICAL,
     2196    26707                         @LOP  = ETT$$,
     2197    26708                         @ROP  = CETT$$);
     2198    27087
     2199    27088               %NEW_ILL (@ID = %DEFLB,
     2200    27089                         @LABEL$ = START_LABEL$);
     2201    27468
     2202    27469    2          CALL Z8EK$BRANCH (END_LABEL$);
     2203    27470
     2204    27471    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, LBL$$ (1));
     2205    27472
     2206    27473    2          CALL Z8EK$BRANCH (LBL$$(1));
     2207    27474
     2208    27475    2          IF LTS$$ -> REPORT_LTS.B.CONTROL_FINAL THEN
     2209    27476
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:215  
     2210    27477    2            CALL Z8EK$BRANCH (LBL$$(1));
     2211    27478
     2212    27479    3          DO I = 2 TO TARGET_NO#;
     2213    27480
     2214    27481    3            CALL Z8AT$CREATE_TEMPORARY (%PARA, LBL$$ (I));
     2215    27482
     2216    27483    3            CALL Z8EK$BRANCH (LBL$$(I));
     2217    27484
     2218    27485    3          END;
     2219    27486
     2220    27487
     2221    27488    3          DO I = 1 TO TARGET_NO#;
     2222    27489    3            NAME$$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);
     2223    27490
     2224    27491                 %NEW_ILL (@ID    = %DEFLB,
     2225    27492                           @LABEL$ = "LBL$$(I)");
     2226    27871
     2227    27872    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.TEMP_FIELD$,
     2228    27873    3                            NAME$$ -> CONTROL_NAME_LTS.ST_FIELD$);
     2229    27874
     2230    27875    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.ST_FIELD$,
     2231    27876    3                            NAME$$ -> CONTROL_NAME_LTS.SHADOW_FIELD$);
     2232    27877
     2233    27878    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.SHADOW_FIELD$,
     2234    27879    3                            NAME$$ -> CONTROL_NAME_LTS.TEMP_FIELD$);
     2235    27880
     2236    27881    3          END; /* DO LOOP */
     2237    27882
     2238    27883               %NEW_ILL (@ID   = %DEFLB,
     2239    27884                         @LABEL$ = END_LABEL$);
     2240    28263
     2241    28264               %DB_EXCEPT_LIBRARY_RETURN;
     2242    28648
     2243    28649    2    END CREATE_SHADOW_SWAP_SUB;
     2244    28650         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:216  
     2245    28651
     2246    28652         /*============*/
     2247    28653    1      GEN_ADD_CODE: PROC (ADD_LIST$);
     2248    28654         /*============*/
     2249    28655
     2250    28656        /*I*
     2251    28657
     2252    28658             NAME:  GEN_ADD_CODE
     2253    28659
     2254    28660          DESCRIPTION: This routine creates ILL item of the "add" operation
     2255    28661                       for the calling module.
     2256    28662        */
     2257    28663
     2258    28664
     2259    28665    2   DCL ADD_LIST$      PTR;
     2260    28666    2   DCL BIN_OP$        PTR;
     2261    28667        %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
     2262    28671
     2263    28672
     2264    28673
     2265    28674    2          BIN_OP$ = ADD_LIST$;
     2266    28675
     2267    28676    3          DO WHILE (BIN_OP$ ~= ADDR(NIL));
     2268    28677
     2269    28678    3              CALL Z8E5$MATH_PACK (BIN_OP$,
     2270    28679    3                                   ADDR(ETT_ITEM));
     2271    28680
     2272    28681    3              CALL Z8E7$MOVE (BIN_OP$ -> BINARY_OP.LOP$,
     2273    28682    3                              ADDR(ETT_ITEM));
     2274    28683
     2275    28684    3              BIN_OP$ = BIN_OP$ -> BINARY_OP.LINK;
     2276    28685
     2277    28686    3          END; /* WHILE */
     2278    28687
     2279    28688    2    END GEN_ADD_CODE;
     2280    28689         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:217  
     2281    28690
     2282    28691         /*=============*/
     2283    28692    1      GEN_CLEAR_SUB: PROC (GROUP$$);
     2284    28693         /*=============*/
     2285    28694
     2286    28695        /*I*
     2287    28696
     2288    28697             NAME:  GEN_CLEAR_SUB
     2289    28698
     2290    28699          DESCRIPTION: This routine creates sum counter clear subroutine
     2291    28700                       that will executed by the RWCS to clear the sum
     2292    28701                       counter after the control footing is presented.
     2293    28702        */
     2294    28703
     2295    28704
     2296    28705    2   DCL GROUP$$        PTR;
     2297    28706    2   DCL LABEL$         PTR;
     2298    28707    2   DCL SUM$$          PTR;
     2299    28708
     2300    28709
     2301    28710
     2302    28711    2          IF GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_NAME_LTS.START_OFFSET
     2303    28712    2              >= %CTR_TBL_START_OFF THEN
     2304    28713    3            DO;
     2305    28714
     2306    28715                   %SUB_HEAD (OFFSET_V = "GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_N
             28715        AME_LTS.START_OFFSET + %SUM_CLEAR_SUB_OFF",
     2307    28716                              RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);
     2308    29866
     2309    29867    3              SUM$$ = GROUP$$;
     2310    29868
     2311    29869    4              DO WHILE (SUM$$ ~= ADDR(NIL));
     2312    29870
     2313    29871    4                IF SUM$$ -> REPORT_ELEM_LTS.ID = %REPORT_ELEM_LTS AND
     2314    29872    4                   SUM$$ -> REPORT_ELEM_LTS.B.SUM_PRESENTED THEN
     2315    29873    4                  IF NOT SUM$$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.B.RESETED THEN
     2316    29874    5                    DO;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:218  
     2317    29875
     2318    29876                           %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     2319    29877                                              @TYPE    = %TYD,
     2320    29878                                @ETT$ =
             29878                                  "SUM$$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.SUM_ST_ILL$"
             29878                                    );
     2321    29900
     2322    29901    5                      CALL Z8E7$MOVE (ADDR(RECV_FIELD),
     2323    29902    5                                      ADDR(ZERO));
     2324    29903    5                    END;
     2325    29904
     2326    29905    4                  SUM$$ = SUM$$ -> REPORT_ELEM_LTS.NEXT;
     2327    29906
     2328    29907    4              END;  /* WHILE */
     2329    29908
     2330    29909                   %DB_EXCEPT_LIBRARY_RETURN;
     2331    30293    3          END;
     2332    30294
     2333    30295    2    END GEN_CLEAR_SUB;
     2334    30296         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:219  
     2335    30297
     2336    30298
     2337    30299        /*==================*/
     2338    30300    1     GEN_CROSS_ROLL_SUB: PROC (GROUP$$);
     2339    30301        /*==================*/
     2340    30302
     2341    30303        /*I*
     2342    30304
     2343    30305             NAME:  GEN_CROSS_ROLL_SUB
     2344    30306
     2345    30307          DESCRIPTION: This routine creates cross footing/rolling forward
     2346    30308                       subroutine that will executed by the RWCS to sum up
     2347    30309                       the sum counter to another sum counter.
     2348    30310        */
     2349    30311
     2350    30312    2   DCL GROUP$$        PTR;
     2351    30313    2   DCL LABEL$         PTR;
     2352    30314
     2353    30315
     2354    30316
     2355    30317    2          IF GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_NAME_LTS.START_OFFSET
     2356    30318    2              >= %CTR_TBL_START_OFF THEN
     2357    30319    3            DO;
     2358    30320
     2359    30321                   %SUB_HEAD (OFFSET_V = "GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_N
             30321        AME_LTS.START_OFFSET + %CROSS_ROLL_SUB_OFF",
     2360    30322                              RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);
     2361    31472    3              CALL GEN_ADD_CODE (GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ ->
     2362    31473    3                                 CONTROL_NAME_LTS.SUM_SUBTOTAL$);
     2363    31474
     2364    31475                   %DB_EXCEPT_LIBRARY_RETURN;
     2365    31859
     2366    31860    3            END;
     2367    31861
     2368    31862    2    END GEN_CROSS_ROLL_SUB;
     2369    31863         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:220  
     2370    31864
     2371    31865
     2372    31866        /*=============*/
     2373    31867    1     GEN_RESET_SUB: PROC (CONTROL_LTS$);
     2374    31868        /*=============*/
     2375    31869
     2376    31870        /*I*
     2377    31871
     2378    31872             NAME:  GEN_RESET_SUB
     2379    31873
     2380    31874          DESCRIPTION: This routine creates sum counter resetting
     2381    31875                       subroutine that will executed by the RWCS to clear
     2382    31876                       the sum counter when the control break occurs.
     2383    31877        */
     2384    31878
     2385    31879
     2386    31880    2   DCL CONTROL_LTS$   PTR;
     2387    31881    2   DCL LABEL$         PTR;
     2388    31882    2   DCL LX_ETT$        PTR;
     2389    31883
     2390    31884
     2391    31885
     2392    31886    2          IF CONTROL_LTS$ = ADDR(NIL) OR
     2393    31887    2             CONTROL_LTS$ -> CONTROL_NAME_LTS.SUM_RESET$ = ADDR(NIL) THEN
     2394    31888    2              RETURN;
     2395    31889
     2396    31890
     2397    31891    2          IF CONTROL_LTS$ -> CONTROL_NAME_LTS.START_OFFSET
     2398    31892    2              >= %CTR_TBL_START_OFF THEN
     2399    31893    3            DO;
     2400    31894
     2401    31895                   %SUB_HEAD (OFFSET_V =
             31895                       "CONTROL_LTS$ -> CONTROL_NAME_LTS.START_OFFSET + %RESET_SUB_OFF",
     2402    31896                              RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);
     2403    33046    3              LX_ETT$ = CONTROL_LTS$ -> CONTROL_NAME_LTS.SUM_RESET$;
     2404    33047
     2405    33048    4              DO WHILE (LX_ETT$ ~= ADDR(NIL));
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:221  
     2406    33049
     2407    33050    4                CALL Z8E7$MOVE (LX_ETT$, ADDR(ZERO));
     2408    33051
     2409    33052    4                LX_ETT$ = LX_ETT$ -> LX_ETT_ITEM.LINK;
     2410    33053
     2411    33054    4              END;
     2412    33055
     2413    33056                   %DB_EXCEPT_LIBRARY_RETURN;
     2414    33440
     2415    33441    3            END;
     2416    33442
     2417    33443    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (CONTROL_LTS$ -> CONTROL_NAME_LTS.SUM_RESET$);
     2418    33444
     2419    33445    2    END GEN_RESET_SUB;
     2420    33446         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:222  
     2421    33447
     2422    33448         /*============*/
     2423    33449    1      GEN_SUM_SUBS: PROC (GROUP$$);
     2424    33450         /*============*/
     2425    33451
     2426    33452        /*I*
     2427    33453
     2428    33454             NAME:  GEN_SUM_SUBS
     2429    33455
     2430    33456          DESCRIPTION: This routine calls  to generate cross footing
     2431    33457                       and sum counter clear subroutines.
     2432    33458        */
     2433    33459
     2434    33460
     2435    33461    2   DCL GROUP$$         PTR;
     2436    33462
     2437    33463
     2438    33464
     2439    33465    2          IF GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ ->
     2440    33466    2             CONTROL_NAME_LTS.SUM_SUBTOTAL$ ~= ADDR(NIL) THEN
     2441    33467    3            DO;
     2442    33468
     2443    33469    3              CALL GEN_CROSS_ROLL_SUB (GROUP$$);
     2444    33470
     2445    33471    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ ->
     2446    33472    3                                             CONTROL_NAME_LTS.SUM_SUBTOTAL$);
     2447    33473
     2448    33474    3            END;
     2449    33475
     2450    33476    2          CALL GEN_CLEAR_SUB (GROUP$$);
     2451    33477
     2452    33478    2    END GEN_SUM_SUBS;
     2453    33479         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:223  
     2454    33480
     2455    33481         /*===============*/
     2456    33482    1      GEN_SPECIAL_SUB: PROC (CURRENT$);
     2457    33483         /*===============*/
     2458    33484
     2459    33485        /*I*
     2460    33486
     2461    33487             NAME:  GEN_SPECIAL_SUB
     2462    33488
     2463    33489          DESCRIPTION: This routine creates special subtotalling subroutine
     2464    33490                       that will executed by the RWCS to sum up the sum
     2465    33491                       counter when the special detail group presented.
     2466    33492        */
     2467    33493
     2468    33494
     2469    33495    2   DCL CURRENT$       PTR;
     2470    33496    2   DCL LABEL$         PTR;
     2471    33497
     2472    33498
     2473    33499
     2474    33500    2          IF CURRENT$ -> REPORT_01_LTS.SPECIAL_SUBTOTAL$ ~= ADDR(NIL) THEN
     2475    33501    3            DO;
     2476    33502
     2477    33503                   %SUB_HEAD (OFFSET_V = %SPECIAL_SUBTOTAL_SUB_OFF,
     2478    33504                              RWCT_PTR = CURRENT$ -> REPORT_01_LTS.RWCT$);
     2479    34654
     2480    34655    3              CALL GEN_ADD_CODE (CURRENT$ -> REPORT_01_LTS.SPECIAL_SUBTOTAL$);
     2481    34656
     2482    34657    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (CURRENT$ -> REPORT_01_LTS.
             34657                       SPECIAL_SUBTOTAL$);
     2483    34658
     2484    34659                   %DB_EXCEPT_LIBRARY_RETURN;
     2485    35043
     2486    35044    3            END;
     2487    35045
     2488    35046    2    END GEN_SPECIAL_SUB;
     2489    35047         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:224  
     2490    35048
     2491    35049         /*===============*/
     2492    35050    1      GEN_GENERAL_SUB: PROC;
     2493    35051         /*===============*/
     2494    35052
     2495    35053        /*I*
     2496    35054
     2497    35055             NAME:  GEN_GENERAL_SUB
     2498    35056
     2499    35057          DESCRIPTION: This routine creates general subtotalling subroutine
     2500    35058                       that will executed by the RWCS to sum up the sum
     2501    35059                       counter when any detail group presented.
     2502    35060        */
     2503    35061
     2504    35062
     2505    35063    2   DCL LABEL$     PTR;
     2506    35064
     2507    35065
     2508    35066
     2509    35067    2      IF LTS$$ -> REPORT_LTS.GENERAL_SUBTOTAL$ ~= ADDR(NIL) THEN
     2510    35068    3        DO;
     2511    35069
     2512    35070               %SUB_HEAD (OFFSET_V = %GEN_SUBTOTAL_OFF,
     2513    35071                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);
     2514    36221
     2515    36222    3          CALL GEN_ADD_CODE (LTS$$ -> REPORT_LTS.GENERAL_SUBTOTAL$);
     2516    36223
     2517    36224    3          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> REPORT_LTS.GENERAL_SUBTOTAL$);
     2518    36225
     2519    36226               %DB_EXCEPT_LIBRARY_RETURN;
     2520    36610
     2521    36611    3        END;
     2522    36612
     2523    36613    2    END GEN_GENERAL_SUB;
     2524    36614         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:225  
     2525    36615
     2526    36616               /* Main routine */
     2527    36617
     2528    36618    1          MKCN.CON = 1;
     2529    36619
     2530    36620    1          CALL Z8AC$MAKE_CONST (CONST_ETT$);
     2531    36621
     2532    36622               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ONE_FIELD)",
     2533    36623                                  @TYPE    = %TYI,
     2534    36624                                  @ETT$    = CONST_ETT$);
     2535    36646
     2536    36647               %GET_LTS (@ID       = %FILE_LTS,
     2537    36648                         @ST$      = LTS$$ -> REPORT_LTS.FILE$,
     2538    36649                         @RETURN$  = FILE_LTS$ );
     2539    36692
     2540    36693
     2541    36694               %GET_ADSC_LEN (ST$  = LTS$$ -> REPORT_LTS.RWCT$,
     2542    36695                              RTN  = RWCT_LEN);
     2543    36706
     2544    36707    1          LAST_WORD_OFFSET = (RWCT_LEN - 20) / 4;
     2545    36708
     2546    36709    1          MKCN.CON = LTS$$ -> REPORT_LTS.B.CODE_NUMBER;
     2547    36710    1          CALL Z8AC$MAKE_CONST (CONST_ETT$);
     2548    36711
     2549    36712               %NEW_ILL (@ID     = %PREOFF,
     2550    36713                         @OFFSET = LAST_WORD_OFFSET,
     2551    36714                         @LOP    = LTS$$ -> REPORT_LTS.RWCT$,
     2552    36715                         @ROP    = CONST_ETT$ -> ETT.LOP,
     2553    36716                         @N      = 1);
     2554    37095
     2555    37096               %NEW_ILL (@ID     = %PTR_SET,
     2556    37097                         @OFFSET = "LAST_WORD_OFFSET + 1",
     2557    37098                         @LOP    = LTS$$ -> REPORT_LTS.RWCT$,
     2558    37099                         @ROP    = FILE_LTS$ -> FILE_LTS.FAB$);
     2559    37478    1          CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.BUFFER_ST$,
     2560    37479    1                              ADDR(NIL),
     2561    37480    1                              BUFFER_ETT$);
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:226  
     2562    37481
     2563    37482    1          IF LTS$$ -> REPORT_LTS.B.CODE_ON THEN
     2564    37483    2            DO;
     2565    37484    2              MIN_REC_LEN = 2;    /*#32312#*/
     2566    37485    2              FILE_LTS$ ->FILE_LTS.RECORD_CONTAINS.INT_1 = 2; /*#32312#*/
     2567    37486    2              REPORT_CODE_NO = LTS$$ -> REPORT_LTS.B.CODE_NUMBER;
     2568    37487    2              CALL Z8AC$MAKE_TYA_CONST (LTS$$ -> REPORT_LTS.CODE,
     2569    37488    2                                        2,
     2570    37489    2                                        0,
     2571    37490    2                                        CODE_ETT$);
     2572    37491    2            END;
     2573    37492    1          ELSE
     2574    37493    2            DO;
     2575    37494    2              MIN_REC_LEN = 1;   /*#32312#*/
     2576    37495    2              FILE_LTS$ ->FILE_LTS.RECORD_CONTAINS.INT_1 = 1; /*#32312#*/
     2577    37496    2              REPORT_CODE_NO = %DEFAULT_REPORT_CODE;
     2578    37497    2              CALL Z8AC$MAKE_TYA_CONST ('  ',
     2579    37498    2                                        2,
     2580    37499    2                                        0,
     2581    37500    2                                        CODE_ETT$);
     2582    37501    2            END;
     2583    37502
     2584    37503    1          CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.LINE_COUNTER$,
     2585    37504    1                              ADDR(NIL),
     2586    37505    1                              LINE_COUNTER_ETT$);
     2587    37506
     2588    37507    1          CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.PAGE_COUNTER$,
     2589    37508    1                              ADDR(NIL),
     2590    37509    1                              PAGE_COUNTER_ETT$);
     2591    37510
     2592    37511    1          IF LTS$$ -> REPORT_LTS.B.CODE_ON THEN
     2593    37512    2            DO;
     2594    37513
     2595    37514    2              SA_ADJ = 1;
     2596    37515    2            END;
     2597    37516    1          ELSE
     2598    37517    2            DO;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:227  
     2599    37518    2              SA_ADJ = -1;
     2600    37519    2            END;
     2601    37520
     2602    37521    1          CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.AFTER_ADVANCE$,
     2603    37522    1                              ADDR(NIL),
     2604    37523    1                              AFTER_AREA_ETT$);
     2605    37524
     2606    37525               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(AFTER_FIELD)",
     2607    37526                                  @TYPE    = %TYI,
     2608    37527                                  @ETT$    = AFTER_AREA_ETT$);
     2609    37549
     2610    37550               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(LINE_COUNTER_FIELD)",
     2611    37551                                  @TYPE    = %TYI,
     2612    37552                                  @ETT$    = LINE_COUNTER_ETT$);
     2613    37574
     2614    37575               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ZERO)",
     2615    37576                                  @TYPE    = %TYI,
     2616    37577                                  @ETT$    = COMCOM.VALUE_0);
     2617    37599
     2618    37600
     2619    37601
     2620    37602    1          CALL CREATE_TOP_PAGE_SUB;
     2621    37603
     2622    37604    1          CALL BUILD_FORMAT_SUB;
     2623    37605
     2624    37606    1          IF LTS$$ -> REPORT_LTS.CONTROL$ ~= ADDR(NIL) THEN
     2625    37607    2            DO;
     2626    37608
     2627    37609    2              CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.CTR_LVL_COUNTER$,
     2628    37610    2                                  ADDR(NIL),
     2629    37611    2                                  CTR_LVL_ETT$);
     2630    37612
     2631    37613                   %INIT_LX_ETT_ITEM (@POINTER = "ADDR(CTR_LVL_FIELD)",
     2632    37614                                      @TYPE    = %TYI,
     2633    37615                                      @ETT$    = CTR_LVL_ETT$);
     2634    37637
     2635    37638    2              CALL STORE_EDITED (LTS$$ -> REPORT_LTS.CONTROL$);
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:228  
     2636    37639
     2637    37640    2              CALL BUILD_CTR_FIELDS (LTS$$ -> REPORT_LTS.CONTROL$);
     2638    37641
     2639    37642    2              CALL CREATE_SHADOW_INIT_SUB (LTS$$ -> REPORT_LTS.CONTROL$);
     2640    37643
     2641    37644    2              CALL CREATE_CTR_DETECT_SUB (LTS$$ -> REPORT_LTS.CONTROL$);
     2642    37645
     2643    37646    2              CALL CREATE_SHADOW_SWAP_SUB (LTS$$ -> REPORT_LTS.CONTROL$);
     2644    37647
     2645    37648    2              CALL DISPOSE_CTR_FIELDS (LTS$$ -> REPORT_LTS.CONTROL$);
     2646    37649
     2647    37650    2              CALL RESTORE_EDITED (LTS$$ -> REPORT_LTS.CONTROL$);
     2648    37651
     2649    37652    2            END;
     2650    37653
     2651    37654
     2652    37655    1          CURRENT$ = LTS$$ -> REPORT_LTS.DETAIL$;
     2653    37656
     2654    37657    2          DO WHILE (CURRENT$ ~= ADDR(NIL));
     2655    37658
     2656    37659    2            CALL GEN_SPECIAL_SUB (CURRENT$);
     2657    37660
     2658    37661    2            CURRENT$ = CURRENT$ -> REPORT_01_LTS.LINK;
     2659    37662
     2660    37663    2          END; /* WHILE */
     2661    37664
     2662    37665    1          CURRENT$ = LTS$$ -> REPORT_LTS.CONTROL_FOOTING_FINAL$;
     2663    37666
     2664    37667    1        IF CURRENT$ ~= ADDR(NIL) THEN
     2665    37668    2          DO;
     2666    37669    3            DO WHILE (CURRENT$ ~= ADDR(NIL));
     2667    37670
     2668    37671    3              CALL GEN_SUM_SUBS (CURRENT$);
     2669    37672
     2670    37673    3              CURRENT$ = CURRENT$ -> REPORT_01_LTS.LINK;
     2671    37674
     2672    37675    3            END; /* WHILE */
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:229  
     2673    37676    2          END;
     2674    37677    1        ELSE
     2675    37678    2          DO;
     2676    37679                 %NEW_REPORT_01_LTS (@POINTER = PHONY_LTS$,
     2677    37680                                     @CONTROL_LTS$ = LTS$$ -> REPORT_LTS.CONTROL_FINAL$);
     2678    37794
     2679    37795    2            CALL GEN_SUM_SUBS (PHONY_LTS$);
     2680    37796    2          END;
     2681    37797
     2682    37798
     2683    37799    1          CURRENT$ = LTS$$ -> REPORT_LTS.CONTROL_FOOTING$;
     2684    37800
     2685    37801    2          DO WHILE (CURRENT$ ~= ADDR(NIL));
     2686    37802
     2687    37803    2            CALL GEN_SUM_SUBS (CURRENT$);
     2688    37804
     2689    37805    2            CURRENT$ = CURRENT$ -> REPORT_01_LTS.LINK;
     2690    37806
     2691    37807    2          END; /* WHILE */
     2692    37808
     2693    37809    1          CALL GEN_GENERAL_SUB;
     2694    37810
     2695    37811    1          IF LTS$$ -> REPORT_LTS.CONTROL$ ~= ADDR(NIL) THEN
     2696    37812    2            DO;
     2697    37813    3              DO I = 1 TO LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.N - 3;
     2698    37814
     2699    37815    3                CALL GEN_RESET_SUB (LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.P$(I)
             37815                         );
     2700    37816
     2701    37817    3              END;
     2702    37818    2            END;
     2703    37819
     2704    37820    1          CALL GEN_RESET_SUB (LTS$$ -> REPORT_LTS.CONTROL_FINAL$);
     2705    37821
     2706    37822    1    END Z8ET$CREATE_SUBROUTINES;
     2707    37823         %EOD;

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:230  
--  Include file information  --

   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$CREATE_SUBROUTINES.

   Procedure Z8ET$CREATE_SUBROUTINES requires 3976 words for executable code.
   Procedure Z8ET$CREATE_SUBROUTINES requires 182 words of local(AUTO) storage.

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:231  

 Object Unit name= Z8ET$CREATE_SUBROUTINES                    File name= Z8ET.:Z8A6TOU
 UTS= AUG 09 '97 12:48:40.60 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  DNT$
    6  LblCom even  none     5      5  DNT_
    7  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    8  LblCom even  none     1      1  DNT_OF_1$
    9  LblCom even  none     1      1  ST$
   10  LblCom even  none     5      5  ST_
   11  LblCom even  none     1      1  QLT$
   12  LblCom even  none     1      1  PREV_01_QLT$
   13  LblCom even  none     5      5  QLT_
   14  LblCom even  none     1      1  ETT$
   15  LblCom even  none     1      1  HEAD_ETT$
   16  LblCom even  none   512   1000  ETT_BUCKETS
   17  LblCom even  none     5      5  ETT_
   18  LblCom even  none     1      1  ILL$
   19  LblCom even  none     5      5  ILL_
   20  LblCom even  none     1      1  ILS$
   21  LblCom even  none     5      5  ILS_
   22  LblCom even  none     1      1  LTS$
   23  LblCom even  none     5      5  LTS_
   24  LblCom even  none     2      2  MKCN
   25  LblCom even  none     1      1  HEAP$
   26  LblCom even  none     8     10  TEMP_LX_NODE
   27  RoData even  UTS      1      1  Z8ET$CREATE_SUBROUTINES
   28   Proc  even  none  3976   7610  Z8ET$CREATE_SUBROUTINES
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:232  
   29  RoData even  none    61     75  Z8ET$CREATE_SUBROUTINES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    28      0   yes            yes      Std        1  Z8ET$CREATE_SUBROUTINES

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8AC$MAKE_CONST
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       4 Z8AC$MAKE_TYA_CONST
         yes           Std       3 Z8AF$NEW_BASE
         yes           Std       1 Z8AR$RESERVER
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       3 Z9EN$WRITE_PAGE
         yes           Std       2 Z8E7$MOVE
         yes           Std       2 Z8AC$LX_ETT_ITEM_TYI_CONST
         yes           Std       2 Z8E5$MATH_PACK
         yes           Std       5 Z8AN$NEW_ILL1
         yes           Std       7 Z9EN$WRITE_NEXT
         yes           Std       2 Z8EK$BRANCH_TRUE
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std       1 Z8ED$DISPOSE_ABSSYN_TREE
         yes           Std       2 Z8EX$SET_INDEX
         yes           Std       1 Z8EK$BRANCH
         yes           Std       2 Z8EK$BRANCH_FALSE
         yes           Std       4 Z8AF$FORME
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:233  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                                O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK                          r    ILL_STEP                         r    ILS_STEP_TABLE
r    LTS_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:234  


     1169        1        /*T***********************************************************/
     1170        2        /*T*                                                         */
     1171        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1172        4        /*T*                                                         */
     1173        5        /*T***********************************************************/
     1174        6
     1175        7        /*M*  Z8ET$CREATE_SUBROUTINES---Create 10 run time subroutines */
     1176        8
     1177        9
     1178       10        /*P*
     1179       11               NAME:  Z8ET$CREATE_SUBROUTINES
     1180       12             AUTHOR:  Min Lee.
     1181       13            PURPOSE:  Creates 10 run time subroutines to be executed by
     1182       14                      Report Writer Control System.
     1183       15        */
     1184       16
     1185       17        /*D*
     1186       18               NAME:  Z8ET$CREATE_SUBROUTINES
     1187       19               CALL:  CALL Z8ET$CREATE_SUBROUTINES (LTS$$)
     1188       20              INPUT:  LTS$$ --- Pointed to a REPORT's LTS item.
     1189       21
     1190       22
     1191       23
     1192       24        DESCRIPTION:  These are the 10 run time subroutines generated by these
     1193       25                      modules:
     1194       26                      1. Top of Page subroutine---by CREATE_TOP_PAGE_SUB
     1195       27                      2. Formatting Subroutine ---by CREATE_FORMATTING_SUB
     1196       28                      3. Control Item Initial Subroutine--by CREATE_SHADOW_INIT_SUB
     1197       29                      4. Control Break Identification Sub--by CREATE_CONTROL_DETECT_SUB
     1198       30                      5. Control Item Swapback Subroutine--by CREATE_SHADOW_SWAP_SUB
     1199       31                      6. Sum Counter Clear Subroutine--by GEN_CLEAR_SUB
     1200       32                      7. Sum Counter Resetting Subroutine--by GEN_RESET_SUB
     1201       33                      8. Cross Footing/Rolling forward Sub--by GEN_CROSS_ROLL_SUB
     1202       34                      9. General Subtotaling Subroutine--by GEN_GENERAL_SUB
     1203       35                     10. Special Subtotaling Subroutine--by GEN_SPECIAL_SUB
     1204       36         */
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:235  
     1205       37         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:236  
     1206       38
     1207       39         /*=======================*/
     1208       40           Z8ET$CREATE_SUBROUTINES:  PROC (LTS$$);

     40 28 000000   000000 700200 xent  Z8ET$CREATE* TSX0  ! X66_AUTO_1
        28 000001   000266 000001                    ZERO    182,1
        28 000002   006604 710000 28                 TRA     s:36618

     1209       41         /*=======================*/
     1210       42        %EQU PHASE = 1;
     1211       43        %EQU DEFAULT_REPORT_CODE = 55;  /* report code for display item is 00 */
     1212       44
     1213       45        %INCLUDE Z8A_DEFC;
     1214      113        %INCLUDE Z8A_SUPP_MAC ;
     1215     2513        %INCLUDE Z8A_COMCOM ;
     1216     3163        %INCLUDE Z8E_STACKS ;
     1217     5429        %INCLUDE Z8E_O1COM;
     1218     6190        %INCLUDE Z8E_MACROS;
     1219     6865        %INCLUDE Z8A_DNT ;
     1220     7086        %INCLUDE Z8A_ST ;
     1221    10745        %INCLUDE Z8A_TYPES;
     1222    10919        %INCLUDE Z8A_QLT;
     1223    11025        %INCLUDE Z8A_ETT ;
     1224    11326        %INCLUDE Z8A_ILL ;
     1225    12019        %INCLUDE Z8A_ILS ;
     1226    12128        %INCLUDE Z8A_LTS ;
     1227    14205        %INCLUDE Z8A_MKCN;
     1228    14222        %INCLUDE Z8E_HEAP ;
     1229    14278        %INCLUDE Z8E_ABSSYN;
     1230    14484        %INCLUDE X9A_IO;
     1231    14634        %INCLUDE Z9A_SUPP_MAC;
     1232    14923
     1233    14924
     1234    14925    1   DCL Z8E5$MATH_PACK ENTRY(2) ;
     1235    14926    1   DCL Z8EX$SET_INDEX  ENTRY(2);
     1236    14927    1   DCL Z8EK$BRANCH          ENTRY(1);
     1237    14928    1   DCL Z8EK$BRANCH_TRUE     ENTRY(2);
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:237  
     1238    14929    1   DCL Z8EK$BRANCH_FALSE    ENTRY(2);
     1239    14930    1   DCL Z8ED$DISPOSE_ABSSYN_TREE ENTRY(1);
     1240    14931    1   DCL Z8AF$FORME       ENTRY(4) ;
     1241    14932    1   DCL Z8AF$NEW_BASE    ENTRY(3);
     1242    14933    1   DCL Z8AC$MAKE_CONST               ENTRY(1);
     1243    14934    1   DCL Z8AC$MAKE_TYA_CONST           ENTRY(4);
     1244    14935    1   DCL Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2);
     1245    14936    1   DCL Z8E7$MOVE      ENTRY(2) ;
     1246    14937    1   DCL Z8AT$CREATE_TEMPORARY ENTRY(2) ;
     1247    14938    1   DCL Z9EN$WRITE_NEXT ENTRY(7);
     1248    14939    1   DCL Z9EN$WRITE_PAGE ENTRY(3);
     1249    14940
     1250    14941    1   DCL REPORT_CODE_NO     UBIN WORD;
     1251    14942    1   DCL RWCT_LEN           SBIN WORD;
     1252    14943    1   DCL LAST_WORD_OFFSET   SBIN WORD;
     1253    14944
     1254    14945    1   DCL I                  SBIN WORD;
     1255    14946    1   DCL SA_ADJ             SBIN WORD;
     1256    14947    1   DCL CONST_ETT$         PTR;
     1257    14948    1   DCL LTS$$              PTR;
     1258    14949    1   DCL BUFFER_ETT$        PTR;
     1259    14950    1   DCL PAGE_COUNTER_ETT$  PTR;
     1260    14951    1   DCL LINE_COUNTER_ETT$  PTR;
     1261    14952    1   DCL AFTER_AREA_ETT$    PTR;
     1262    14953    1   DCL SEND_ETT$          PTR;
     1263    14954    1   DCL RECV_ETT$          PTR;
     1264    14955    1   DCL CODE_ETT$          PTR;
     1265    14956    1   DCL IND$$              PTR;
     1266    14957    1   DCL IND_ETT$           PTR;
     1267    14958    1   DCL RECORD_LEN         SBIN WORD;
     1268    14959    1   DCL MIN_REC_LEN        SBIN WORD;
     1269    14960    1   DCL CURRENT$       PTR;
     1270    14961    1   DCL PHONY_LTS$         PTR;
     1271    14962    1   DCL FILE_LTS$          PTR;
     1272    14963    1   DCL VAL_ST$            PTR;
     1273    14964    1   DCL ALL_BIT            BIT (1) ALIGNED;
     1274    14965
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:238  
     1275    14966
     1276    14967
     1277    14968        %DCL_AUTO_LX_ITEM (@NAME = AFTER_FIELD);
     1278    14972        %DCL_AUTO_LX_ITEM (@NAME = LINE_COUNTER_FIELD);
     1279    14976
     1280    14977    1   DCL DETAIL_GRP$    PTR;
     1281    14978
     1282    14979        %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
     1283    14983        %DCL_AUTO_LX_ITEM (@NAME = OP_NODE);
     1284    14987        %DCL_AUTO_LX_ITEM (@NAME = SEND_FIELD);
     1285    14991        %DCL_AUTO_LX_ITEM (@NAME = RECV_FIELD);
     1286    14995        %DCL_AUTO_LX_ITEM (@NAME = RECORD_LENGTH);
     1287    14999        %DCL_AUTO_LX_ITEM (@NAME = LINE_FIELD);
     1288    15003        %DCL_AUTO_LX_ITEM (@NAME = ZERO);
     1289    15007        %DCL_AUTO_LX_ITEM (@NAME = COMPARE);
     1290    15011        %DCL_AUTO_LX_ITEM (@NAME = IND_FIELD);
     1291    15015        %DCL_AUTO_LX_ITEM (@NAME = ONE_FIELD);
     1292    15019        %DCL_AUTO_LX_ITEM (@NAME = CTR_LVL_FIELD);
     1293    15023    1   DCL CTR_LVL_ETT$           PTR;
     1294    15024
     1295    15025        %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:239  
     1296    15026         %MACRO SUB_HEAD (OFFSET_V = ,
     1297    15027                          RWCT_PTR = );
     1298    15028           DO;
     1299    15029
     1300    15030               CALL Z8AT$CREATE_TEMPORARY (%PARA, LABEL$);
     1301    15031
     1302    15032               LABEL$ -> LABEL.B.REFERENCED = TRUE;
     1303    15033               LABEL$ -> LABEL.B.USE_PROC = TRUE;
     1304    15034
     1305    15035               %NEW_ILL (@ID       = %DEFLB,
     1306    15036                         @LABEL$   = LABEL$);
     1307    15037
     1308    15038               %NEW_ILL (@ID       = %P_A_PRESET,
     1309    15039                         @OFFSET   = OFFSET_V,
     1310    15040                         @TO       = RWCT_PTR,
     1311    15041                         @LOP      = LABEL$,
     1312    15042                         @ROPCON   = 0);
     1313    15043
     1314    15044               %NEW_ILL (@ID       = %USE_ENTRY,
     1315    15045                         @CODE     = %DB_EXCEPT_PROC);
     1316    15046
     1317    15047           END;
     1318    15048         %MEND;
     1319    15049         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:240  
     1320    15050
     1321    15051
     1322    15052
     1323    15053         /*===================*/
     1324    15054    1      CREATE_TOP_PAGE_SUB: PROC;

  15054 28 000003   200206 741300       CREATE_TOP_* STX1  ! CTR_LVL_ETT$+2,,AUTO

     1325    15055         /*===================*/
     1326    15056
     1327    15057        /*I*
     1328    15058
     1329    15059             NAME:  CREATE_TOP_PAGE_SUB
     1330    15060
     1331    15061          DESCRIPTION: This routine creates the top of page subroutine
     1332    15062                       that will initiate the line counter to 0, add 1 to
     1333    15063                       the page counter, clear the report line buffer,
     1334    15064                       advance to the top of the next page.
     1335    15065        */
     1336    15066
     1337    15067
     1338    15068    2   DCL LABEL$         PTR;
     1339    15069    2   DCL SEND$          PTR;
     1340    15070    2   DCL RECV$          PTR;
     1341    15071
     1342    15072
     1343    15073
     1344    15074
     1345    15075               %SUB_HEAD (OFFSET_V = %TOP_OF_PAGE_OFF,
     1346    15076                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);

  15078 28 000004   200207 630500                    EPPR0   LABEL$,,AUTO
        28 000005   200253 450500                    STP0    CETT$$+2,,AUTO
        28 000006   000002 236000 29                 LDQ     2
        28 000007   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000010   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 000011   000000 631400 29                 EPPR1   0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:241  
        28 000012   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 000013   000000 011000                    NOP     0

  15079 28 000014   200207 470500                    LDP0    LABEL$,,AUTO
        28 000015   400000 236003                    LDQ     -131072,DU
        28 000016   000003 256100                    ORSQ    3,,PR0

  15080 28 000017   200207 470500                    LDP0    LABEL$,,AUTO
        28 000020   001000 236007                    LDQ     512,DL
        28 000021   000003 256100                    ORSQ    3,,PR0

  15414 28 000022   000006 236000 29                 LDQ     6
        28 000023   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000024   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 000025   200257 450500                    STP0    CETT$$+6,,AUTO
        28 000026   000007 236000 29                 LDQ     7
        28 000027   200256 756100                    STQ     CETT$$+5,,AUTO
        28 000030   000010 237000 29                 LDAQ    8
        28 000031   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 000032   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000033   000003 631400 29                 EPPR1   3
        28 000034   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 000035   000000 011000                    NOP     0

  15415 28 000036   200207 236100                    LDQ     LABEL$,,AUTO
        28 000037   000000 470400 18                 LDP0    ILL$
        28 000040   000001 756100                    STQ     1,,PR0

  15722 28 000041   000006 236000 29                 LDQ     6
        28 000042   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000043   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 000044   200257 451500                    STP1    CETT$$+6,,AUTO
        28 000045   000007 236000 29                 LDQ     7
        28 000046   200256 756100                    STQ     CETT$$+5,,AUTO
        28 000047   000014 237000 29                 LDAQ    12
        28 000050   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 000051   200254 630500                    EPPR0   CETT$$+3,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:242  
        28 000052   000003 631400 29                 EPPR1   3
        28 000053   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 000054   000000 011000                    NOP     0

  15726 28 000055   000014 220003                    LDX0    12,DU
        28 000056   000000 470400 18                 LDP0    ILL$
        28 000057   000000 440100                    SXL0    0,,PR0

  15728 28 000060   000000 470400 18                 LDP0    ILL$
        28 000061   000002 450100                    STZ     2,,PR0

  15729 28 000062   200207 236100                    LDQ     LABEL$,,AUTO
        28 000063   000001 756100                    STQ     1,,PR0

  15730 28 000064   200003 471500                    LDP1    @LTS$$,,AUTO
        28 000065   100000 473500                    LDP3    0,,PR1
        28 000066   300022 236100                    LDQ     18,,PR3
        28 000067   000003 756100                    STQ     3,,PR0

  16052 28 000070   000006 236000 29                 LDQ     6
        28 000071   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000072   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 000073   200257 453500                    STP3    CETT$$+6,,AUTO
        28 000074   000007 236000 29                 LDQ     7
        28 000075   200256 756100                    STQ     CETT$$+5,,AUTO
        28 000076   000020 237000 29                 LDAQ    16
        28 000077   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 000100   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000101   000003 631400 29                 EPPR1   3
        28 000102   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 000103   000000 011000                    NOP     0

  16053 28 000104   000001 220003                    LDX0    1,DU
        28 000105   000000 470400 18                 LDP0    ILL$
        28 000106   000000 440100                    SXL0    0,,PR0

  16057 28 000107   000057 470400 xsym               LDP0    O1COM+47
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:243  
        28 000110   000006 236100                    LDQ     6,,PR0
        28 000111   000000 471400 18                 LDP1    ILL$
        28 000112   100001 756100                    STQ     1,,PR1

     1347    16226
     1348    16227               /* MOVE 0 TO LINE COUNTER */
     1349    16228
     1350    16229               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(SEND_FIELD)",
     1351    16230                                  @TYPE    = %TYI,
     1352    16231                                  @ETT$    = COMCOM.VALUE_0);

  16233 28 000113   000004 221003                    LDX1    4,DU
        28 000114   200074 741100                    STX1    SEND_FIELD,,AUTO

  16234 28 000115   000000 222003                    LDX2    0,DU
        28 000116   200074 442100                    SXL2    SEND_FIELD,,AUTO

  16235 28 000117   000001 235007                    LDA     1,DL
        28 000120   200100 755100                    STA     SEND_FIELD+4,,AUTO

  16236 28 000121   000017 236000 29                 LDQ     15
        28 000122   200103 756100                    STQ     SEND_FIELD+7,,AUTO

  16237 28 000123   000124 236000 xsym               LDQ     COMCOM+84
        28 000124   200075 756100                    STQ     SEND_FIELD+1,,AUTO

  16238 28 000125   000017 236000 29                 LDQ     15
        28 000126   200076 756100                    STQ     SEND_FIELD+2,,AUTO

  16240 28 000127   000133 235000 xsym               LDA     COMCOM+91
        28 000130   200101 755100                    STA     SEND_FIELD+5,,AUTO

  16241 28 000131   000134 235000 xsym               LDA     COMCOM+92
        28 000132   200102 755100                    STA     SEND_FIELD+6,,AUTO

     1353    16253
     1354    16254               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:244  
     1355    16255                                  @TYPE    = %TYI,
     1356    16256                                  @ETT$    = LINE_COUNTER_ETT$);

  16258 28 000133   200104 741100                    STX1    RECV_FIELD,,AUTO

  16259 28 000134   200104 442100                    SXL2    RECV_FIELD,,AUTO

  16260 28 000135   000001 235007                    LDA     1,DL
        28 000136   200110 755100                    STA     RECV_FIELD+4,,AUTO

  16261 28 000137   200113 756100                    STQ     RECV_FIELD+7,,AUTO

  16262 28 000140   200014 236100                    LDQ     LINE_COUNTER_ETT$,,AUTO
        28 000141   200105 756100                    STQ     RECV_FIELD+1,,AUTO

  16263 28 000142   000017 236000 29                 LDQ     15
        28 000143   200106 756100                    STQ     RECV_FIELD+2,,AUTO

  16265 28 000144   000133 235000 xsym               LDA     COMCOM+91
        28 000145   200111 755100                    STA     RECV_FIELD+5,,AUTO

  16266 28 000146   000134 235000 xsym               LDA     COMCOM+92
        28 000147   200112 755100                    STA     RECV_FIELD+6,,AUTO

     1357    16278
     1358    16279    2          CALL Z8E7$MOVE (ADDR(RECV_FIELD), ADDR(SEND_FIELD));

  16279 28 000150   200104 630500                    EPPR0   RECV_FIELD,,AUTO
        28 000151   200252 450500                    STP0    CETT$$+1,,AUTO
        28 000152   200074 633500                    EPPR3   SEND_FIELD,,AUTO
        28 000153   200253 453500                    STP3    CETT$$+2,,AUTO
        28 000154   200253 634500                    EPPR4   CETT$$+2,,AUTO
        28 000155   200255 454500                    STP4    CETT$$+4,,AUTO
        28 000156   200252 635500                    EPPR5   CETT$$+1,,AUTO
        28 000157   200254 455500                    STP5    CETT$$+3,,AUTO
        28 000160   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000161   000000 631400 29                 EPPR1   0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:245  
        28 000162   000000 701000 xent               TSX1    Z8E7$MOVE
        28 000163   000000 011000                    NOP     0

     1359    16280
     1360    16281               /* ADD 1 TO PAGE COUNTER */
     1361    16282
     1362    16283               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     1363    16284                                  @TYPE    = %TYI,
     1364    16285                                  @ETT$    = PAGE_COUNTER_ETT$);

  16287 28 000164   000004 220003                    LDX0    4,DU
        28 000165   200104 740100                    STX0    RECV_FIELD,,AUTO

  16288 28 000166   000000 221003                    LDX1    0,DU
        28 000167   200104 441100                    SXL1    RECV_FIELD,,AUTO

  16289 28 000170   000001 235007                    LDA     1,DL
        28 000171   200110 755100                    STA     RECV_FIELD+4,,AUTO

  16290 28 000172   000017 236000 29                 LDQ     15
        28 000173   200113 756100                    STQ     RECV_FIELD+7,,AUTO

  16291 28 000174   200013 236100                    LDQ     PAGE_COUNTER_ETT$,,AUTO
        28 000175   200105 756100                    STQ     RECV_FIELD+1,,AUTO

  16292 28 000176   000017 236000 29                 LDQ     15
        28 000177   200106 756100                    STQ     RECV_FIELD+2,,AUTO

  16294 28 000200   000133 235000 xsym               LDA     COMCOM+91
        28 000201   200111 755100                    STA     RECV_FIELD+5,,AUTO

  16295 28 000202   000134 235000 xsym               LDA     COMCOM+92
        28 000203   200112 755100                    STA     RECV_FIELD+6,,AUTO

     1365    16307
     1366    16308               %INIT_BINARY_OP (@POINTER   = "ADDR(OP_NODE)",
     1367    16309                                @ROP$      = "ADDR(ONE_FIELD)",
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:246  
     1368    16310                                @LOP$      = "ADDR(RECV_FIELD)",
     1369    16311                                @OP        = %OP_PLUS);

  16313 28 000204   000005 222003                    LDX2    5,DU
        28 000205   200064 742100                    STX2    OP_NODE,,AUTO

  16314 28 000206   200064 441100                    SXL1    OP_NODE,,AUTO

  16321 28 000207   000133 235000 xsym               LDA     COMCOM+91
        28 000210   200071 755100                    STA     OP_NODE+5,,AUTO

  16322 28 000211   000134 235000 xsym               LDA     COMCOM+92
        28 000212   200072 755100                    STA     OP_NODE+6,,AUTO

  16323 28 000213   200164 630500                    EPPR0   ONE_FIELD,,AUTO
        28 000214   200066 450500                    STP0    OP_NODE+2,,AUTO

  16324 28 000215   200104 631500                    EPPR1   RECV_FIELD,,AUTO
        28 000216   200065 451500                    STP1    OP_NODE+1,,AUTO

  16325 28 000217   000020 235007                    LDA     16,DL
        28 000220   200067 755100                    STA     OP_NODE+3,,AUTO

  16326 28 000221   200073 756100                    STQ     OP_NODE+7,,AUTO

     1370    16329
     1371    16330    2          CALL Z8E5$MATH_PACK (ADDR(OP_NODE),

  16330 28 000222   200064 633500                    EPPR3   OP_NODE,,AUTO
        28 000223   200252 453500                    STP3    CETT$$+1,,AUTO
        28 000224   200054 634500                    EPPR4   ETT_ITEM,,AUTO
        28 000225   200253 454500                    STP4    CETT$$+2,,AUTO
        28 000226   200253 635500                    EPPR5   CETT$$+2,,AUTO
        28 000227   200255 455500                    STP5    CETT$$+4,,AUTO
        28 000230   200252 636500                    EPPR6   CETT$$+1,,AUTO
        28 000231   200254 456500                    STP6    CETT$$+3,,AUTO
        28 000232   200254 630500                    EPPR0   CETT$$+3,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:247  
        28 000233   000000 631400 29                 EPPR1   0
        28 000234   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        28 000235   000000 011000                    NOP     0

     1372    16331    2                               ADDR(ETT_ITEM));
     1373    16332
     1374    16333    2          CALL Z8E7$MOVE (ADDR(RECV_FIELD),

  16333 28 000236   200104 630500                    EPPR0   RECV_FIELD,,AUTO
        28 000237   200252 450500                    STP0    CETT$$+1,,AUTO
        28 000240   200054 631500                    EPPR1   ETT_ITEM,,AUTO
        28 000241   200253 451500                    STP1    CETT$$+2,,AUTO
        28 000242   200253 633500                    EPPR3   CETT$$+2,,AUTO
        28 000243   200255 453500                    STP3    CETT$$+4,,AUTO
        28 000244   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 000245   200254 454500                    STP4    CETT$$+3,,AUTO
        28 000246   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000247   000000 631400 29                 EPPR1   0
        28 000250   000000 701000 xent               TSX1    Z8E7$MOVE
        28 000251   000000 011000                    NOP     0

     1375    16334    2                          ADDR(ETT_ITEM));
     1376    16335
     1377    16336               /* CLEAR THE BUFFER */
     1378    16337
     1379    16338                   %NEW_ILL (@ID   = %MVAN,
     1380    16339                             @LOP  = BUFFER_ETT$,
     1381    16340                             @ROP  = CODE_ETT$);

  16653 28 000252   000006 236000 29                 LDQ     6
        28 000253   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000254   200012 630500                    EPPR0   BUFFER_ETT$,,AUTO
        28 000255   200257 450500                    STP0    CETT$$+6,,AUTO
        28 000256   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 000257   200256 451500                    STP1    CETT$$+5,,AUTO
        28 000260   000026 237000 29                 LDAQ    22
        28 000261   200254 757100                    STAQ    CETT$$+3,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:248  
        28 000262   000025 236000 29                 LDQ     21
        28 000263   200253 756100                    STQ     CETT$$+2,,AUTO
        28 000264   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 000265   000022 631400 29                 EPPR1   18
        28 000266   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        28 000267   000000 011000                    NOP     0

  16656 28 000270   200012 236100                    LDQ     BUFFER_ETT$,,AUTO
        28 000271   000000 470400 18                 LDP0    ILL$
        28 000272   000001 756100                    STQ     1,,PR0

  16657 28 000273   200020 236100                    LDQ     CODE_ETT$,,AUTO
        28 000274   000002 756100                    STQ     2,,PR0

     1382    16719
     1383    16720               /* WRITE AFTER ADVANING PAGE */
     1384    16721
     1385    16722    2          RECORD_LEN = MIN_REC_LEN; /* initialize the RECORD_LEN */

  16722 28 000275   200024 235100                    LDA     MIN_REC_LEN,,AUTO
        28 000276   200023 755100                    STA     RECORD_LEN,,AUTO

     1386    16723
     1387    16724    2          CALL Z8AC$LX_ETT_ITEM_TYI_CONST ( RECORD_LEN,

  16724 28 000277   200114 631500                    EPPR1   RECORD_LENGTH,,AUTO
        28 000300   200252 451500                    STP1    CETT$$+1,,AUTO
        28 000301   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 000302   200255 453500                    STP3    CETT$$+4,,AUTO
        28 000303   200023 634500                    EPPR4   RECORD_LEN,,AUTO
        28 000304   200254 454500                    STP4    CETT$$+3,,AUTO
        28 000305   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000306   000000 631400 29                 EPPR1   0
        28 000307   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        28 000310   000000 011000                    NOP     0

     1388    16725    2                                           ADDR(RECORD_LENGTH));
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:249  
     1389    16726
     1390    16727    2          CALL Z9EN$WRITE_PAGE (FILE_LTS$,

  16727 28 000311   000017 236000 29                 LDQ     15
        28 000312   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000313   200253 756100                    STQ     CETT$$+2,,AUTO
        28 000314   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 000315   200256 450500                    STP0    CETT$$+5,,AUTO
        28 000316   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 000317   200255 451500                    STP1    CETT$$+4,,AUTO
        28 000320   200027 633500                    EPPR3   FILE_LTS$,,AUTO
        28 000321   200254 453500                    STP3    CETT$$+3,,AUTO
        28 000322   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000323   000030 631400 29                 EPPR1   24
        28 000324   000000 701000 xent               TSX1    Z9EN$WRITE_PAGE
        28 000325   000000 011000                    NOP     0

     1391    16728    2                                ADDR(NIL),
     1392    16729    2                                ADDR(NIL) );
     1393    16730
     1394    16731               %DB_EXCEPT_LIBRARY_RETURN;

  16941 28 000326   000006 236000 29                 LDQ     6
        28 000327   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000330   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 000331   200257 450500                    STP0    CETT$$+6,,AUTO
        28 000332   000007 236000 29                 LDQ     7
        28 000333   200256 756100                    STQ     CETT$$+5,,AUTO
        28 000334   000032 237000 29                 LDAQ    26
        28 000335   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 000336   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000337   000003 631400 29                 EPPR1   3
        28 000340   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 000341   000000 011000                    NOP     0

  16942 28 000342   000001 220003                    LDX0    1,DU
        28 000343   000000 470400 18                 LDP0    ILL$
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:250  
        28 000344   000000 440100                    SXL0    0,,PR0

  16946 28 000345   000057 470400 xsym               LDP0    O1COM+47
        28 000346   000006 236100                    LDQ     6,,PR0
        28 000347   000000 471400 18                 LDP1    ILL$
        28 000350   100001 756100                    STQ     1,,PR1

     1395    17115
     1396    17116    2    END CREATE_TOP_PAGE_SUB;

  17116 28 000351   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 000352   000001 702211                    TSX2  ! 1,X1

     1397    17117         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:251  
     1398    17118
     1399    17119         /*=====================*/
     1400    17120    1      CREATE_FORMATTING_SUB:  PROC (GROUP$);

  17120 28 000353   200210 741300       CREATE_FORM* STX1  ! SEND$,,AUTO

     1401    17121         /*=====================*/
     1402    17122
     1403    17123        /*I*
     1404    17124
     1405    17125             NAME:  CREATE_FORMATTING_SUB
     1406    17126
     1407    17127          DESCRIPTION: This routine creates the formatting subroutine for
     1408    17128                       each printable group--i.e. at least one LINE clause
     1409    17129                       specified in that group. It steps through the 01 group
     1410    17130                       entry to the last entry that subordinats to this group
     1411    17131                       entry, creates ILLs to advance lines for the LINE clause,
     1412    17132                       formaating the print line buffer according the specified
     1413    17133                       COLUMN clauses, codes that conditionally prints the
     1414    17134                       printable item will be generated if the GROUP INDICATE
     1415    17135                       clause presented.
     1416    17136        */
     1417    17137
     1418    17138
     1419    17139    2   DCL GROUP$         PTR;
     1420    17140    2   DCL CURRENT$       PTR;
     1421    17141    2   DCL NEXT$          PTR;
     1422    17142    2   DCL LABEL$         PTR;
     1423    17143    2   DCL PREV$          PTR;
     1424    17144    2   DCL LINE_SPAN      SBIN WORD;
     1425    17145    2    DCL LINE_NO#      UBIN WORD;
     1426    17146    2   DCL ST$$           PTR;
     1427    17147    2   DCL ST_TYPE        UBIN WORD;
     1428    17148    2   DCL BYTE_POS       UBIN WORD;
     1429    17149    2   DCL WORD_POS       UBIN WORD;
     1430    17150    2   DCL QLT$$          PTR;
     1431    17151    2   DCL RECV_ST$       PTR;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:252  
     1432    17152    2   DCL BUF_ST$        PTR;
     1433    17153
     1434    17154
     1435    17155        %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:253  
     1436    17156
     1437    17157        %MACRO NEW_EDIT_ST (@ETT$ = RECV_ETT$);
     1438    17158           DO;
     1439    17159
     1440    17160             %RESERVE_ST (POINTER = ST$$);
     1441    17161
     1442    17162             ST$$ -> SCALAR = @ETT$ -> ETT.LOP -> SCALAR;
     1443    17163
     1444    17164             %NEW_QLT (@POINTER = QLT$$,
     1445    17165                       @FATHER  = LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.QLT$,
     1446    17166                       @BROTHER = LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.QLT$ -> QLT.SON,
     1447    17167                       @ST$     = ST$$,
     1448    17168                       @DNT$    = ST$$ -> ST.DNT$,
     1449    17169                       @LEVEL#  = 2);
     1450    17170
     1451    17171               LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.QLT$ -> QLT.SON = QLT$$;
     1452    17172
     1453    17173             ST$$ -> SCALAR.QLT$ = QLT$$;
     1454    17174             ST$$ -> SCALAR.B.REDEF_SUB = TRUE;
     1455    17175             ST$$ -> SCALAR.COUNT = LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.COUNT;
     1456    17176             @ETT$ -> ETT.LOP = ST$$;
     1457    17177
     1458    17178           END;
     1459    17179         %MEND;
     1460    17180
     1461    17181
     1462    17182         %MACRO EDIT_PRINTABLE_ITEM (@FROM = ,
     1463    17183                                     @TO   = );
     1464    17184           DO;
     1465    17185             RECORD_LEN = 0;  /* initialize the record length */
     1466    17186             DO WHILE (@FROM ~= @TO -> REPORT_GRP_LTS.NEXT);
     1467    17187
     1468    17188               IF @FROM -> LTS.ID = %REPORT_ELEM_LTS AND
     1469    17189                  @FROM -> REPORT_ELEM_LTS.B.PRINTABLE  THEN
     1470    17190
     1471    17191                 DO;
     1472    17192
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:254  
     1473    17193                   ALL_BIT = FALSE;
     1474    17194
     1475    17195                   IF @FROM -> REPORT_ELEM_LTS.B.SUM_PRESENTED THEN
     1476    17196                     DO;
     1477    17197                       SEND_ETT$ = @FROM -> REPORT_ELEM_LTS.SUM_LTS$ ->
     1478    17198                                   SUM_LTS.SUM_ST_ILL$;
     1479    17199                       RECV_ETT$ = @FROM -> REPORT_ELEM_LTS.SUM_LTS$ ->
     1480    17200                                   SUM_LTS.EDIT_ST_ILL$;
     1481    17201                     END;
     1482    17202                   ELSE
     1483    17203                     DO;
     1484    17204                       CALL Z8AF$NEW_BASE (@FROM -> REPORT_ELEM_LTS.ST$,
     1485    17205                                           ADDR(NIL),
     1486    17206                                           RECV_ETT$);
     1487    17207
     1488    17208                       IF @FROM -> REPORT_ELEM_LTS.B.SOURCE_PRESENTED THEN
     1489    17209                         SEND_ETT$ = @FROM -> REPORT_ELEM_LTS.SOURCE_ETT$;
     1490    17210                       ELSE
     1491    17211                         DO;
     1492    17212
     1493    17213                           SEND_ETT$ = @FROM -> REPORT_ELEM_LTS.VALUE_ETT$;
     1494    17214
     1495    17215                           %FISH (TRIAD = SEND_ETT$,
     1496    17216                                  RTN   = VAL_ST$);
     1497    17217
     1498    17218                           IF VAL_ST$ -> ST.ID = %CONST THEN
     1499    17219                             ALL_BIT = VAL_ST$ -> CONST.B.ALL;
     1500    17220
     1501    17221                         END;
     1502    17222
     1503    17223                     END;
     1504    17224
     1505    17225                   IF RECV_ETT$ -> ETT.ID = %BASE THEN
     1506    17226                     %NEW_EDIT_ST (@ETT$ = RECV_ETT$);
     1507    17227                   ELSE
     1508    17228                     %NEW_EDIT_ST (@ETT$ = RECV_ETT$ -> ETT.LOP);
     1509    17229
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:255  
     1510    17230                   %FISH (TRIAD = RECV_ETT$,  RTN = RECV_ST$);
     1511    17231
     1512    17232                   %FISH (TRIAD = BUFFER_ETT$,  RTN = BUF_ST$);
     1513    17233
     1514    17234
     1515    17235                   RECV_ST$ -> ST.R = BUF_ST$ -> ST.R;
     1516    17236                   RECV_ST$ -> ST.COUNT = BUF_ST$ -> ST.COUNT;
     1517    17237                   RECV_ST$ -> ST.SA = (@FROM -> REPORT_ELEM_LTS.COLUMN_NO# + SA_ADJ) / 4 ;
     1518    17238          RECV_ST$ -> ST.ADSC.CN = MOD((@FROM -> REPORT_ELEM_LTS.COLUMN_NO# + SA_ADJ) , 4);
     1519    17239                   RECORD_LEN = @FROM -> REPORT_ELEM_LTS.COLUMN_NO# +
     1520    17240                                @FROM -> REPORT_ELEM_LTS.SPAN + SA_ADJ;
     1521    17241
     1522    17242                   LINE_NO# = RECV_ST$ -> ST.LINE_NO;
     1523    17243
     1524    17244                   %GET_TYPE (@ETT$  = SEND_ETT$);
     1525    17245
     1526    17246                   %INIT_LX_ETT_ITEM (@POINTER = "ADDR(SEND_FIELD)",
     1527    17247                                      @TYPE    = ST_TYPE,
     1528    17248                                      @ALL     = ALL_BIT,
     1529    17249                                      @ETT$    = SEND_ETT$,
     1530    17250                                      @LINE    = LINE_NO#,
     1531    17251                                      @COLUMN  = 0);
     1532    17252
     1533    17253                   %GET_TYPE (@ETT$  = RECV_ETT$);
     1534    17254
     1535    17255                   %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     1536    17256                                      @TYPE    = ST_TYPE,
     1537    17257                                      @ETT$    = RECV_ETT$,
     1538    17258                                      @LINE    = LINE_NO#,
     1539    17259                                      @COLUMN  = 0);
     1540    17260
     1541    17261                   IF @FROM -> REPORT_ELEM_LTS.B.GROUP_INDICATE THEN
     1542    17262                     DO;
     1543    17263
     1544    17264                       CALL Z8AT$CREATE_TEMPORARY(%PARA, IND$$);
     1545    17265
     1546    17266                       %INIT_BINARY_OP (@POINTER = "ADDR(COMPARE)",
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:256  
     1547    17267                                        @LOP$    = "ADDR(IND_FIELD)",
     1548    17268                                        @ROP$    = "ADDR(ZERO)",
     1549    17269                                        @OP      = %OP_EQUAL);
     1550    17270
     1551    17271                       CALL Z8EK$BRANCH_TRUE (IND$$,
     1552    17272                                              ADDR(COMPARE));
     1553    17273
     1554    17274                       CALL Z8E7$MOVE (ADDR(RECV_FIELD),
     1555    17275                                       ADDR(SEND_FIELD));
     1556    17276
     1557    17277                       %NEW_ILL (@ID     = %DEFLB,
     1558    17278                                 @LABEL$ = IND$$);
     1559    17279
     1560    17280                     END;
     1561    17281                   ELSE
     1562    17282                     CALL Z8E7$MOVE (ADDR(RECV_FIELD),
     1563    17283                                     ADDR(SEND_FIELD));
     1564    17284
     1565    17285                 END;  /* END IF */
     1566    17286
     1567    17287               @FROM = @FROM -> REPORT_GRP_LTS.NEXT;
     1568    17288
     1569    17289             END; /* WHILE */
     1570    17290
     1571    17291           END;
     1572    17292         %MEND;
     1573    17293
     1574    17294         %MACRO GET_TYPE (@TYPE = ST_TYPE,
     1575    17295                          @ETT$ = SEND_ETT$);
     1576    17296           DO;
     1577    17297             %FISH (TRIAD = @ETT$,
     1578    17298                    RTN   = ST$$);
     1579    17299
     1580    17300             @TYPE = ST$$ -> ST.TYPE;
     1581    17301           END;
     1582    17302         %MEND;
     1583    17303         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:257  
     1584    17304
     1585    17305    2          IF GROUP$ -> REPORT_01_LTS.FIRST_LINE.LTS$ = ADDR(NIL)

  17305 28 000354   200211 470500                    LDP0    @GROUP$,,AUTO
        28 000355   000000 471500                    LDP1    0,,PR0
        28 000356   100021 236100                    LDQ     17,,PR1
        28 000357   000017 116000 29                 CMPQ    15
        28 000360   000362 601000 28                 TNZ     s:17312

     1586    17306    2            THEN
     1587    17307    2              RETURN;

  17307 28 000361   000001 702211                    TSX2  ! 1,X1

     1588    17308
     1589    17309               %SUB_HEAD (OFFSET_V = %FORMATTING_SUB_OFF,
     1590    17310                          RWCT_PTR = GROUP$ -> REPORT_01_LTS.RWCT$);

  17312 28 000362   200214 633500                    EPPR3   LABEL$,,AUTO
        28 000363   200253 453500                    STP3    CETT$$+2,,AUTO
        28 000364   000002 236000 29                 LDQ     2
        28 000365   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000366   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 000367   000000 631400 29                 EPPR1   0
        28 000370   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 000371   000000 011000                    NOP     0

  17313 28 000372   200214 470500                    LDP0    LABEL$,,AUTO
        28 000373   400000 236003                    LDQ     -131072,DU
        28 000374   000003 256100                    ORSQ    3,,PR0

  17314 28 000375   200214 470500                    LDP0    LABEL$,,AUTO
        28 000376   001000 236007                    LDQ     512,DL
        28 000377   000003 256100                    ORSQ    3,,PR0

  17648 28 000400   000006 236000 29                 LDQ     6
        28 000401   200252 756100                    STQ     CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:258  
        28 000402   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 000403   200257 450500                    STP0    CETT$$+6,,AUTO
        28 000404   000007 236000 29                 LDQ     7
        28 000405   200256 756100                    STQ     CETT$$+5,,AUTO
        28 000406   000010 237000 29                 LDAQ    8
        28 000407   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 000410   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000411   000003 631400 29                 EPPR1   3
        28 000412   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 000413   000000 011000                    NOP     0

  17649 28 000414   200214 236100                    LDQ     LABEL$,,AUTO
        28 000415   000000 470400 18                 LDP0    ILL$
        28 000416   000001 756100                    STQ     1,,PR0

  17956 28 000417   000006 236000 29                 LDQ     6
        28 000420   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000421   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 000422   200257 451500                    STP1    CETT$$+6,,AUTO
        28 000423   000007 236000 29                 LDQ     7
        28 000424   200256 756100                    STQ     CETT$$+5,,AUTO
        28 000425   000014 237000 29                 LDAQ    12
        28 000426   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 000427   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000430   000003 631400 29                 EPPR1   3
        28 000431   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 000432   000000 011000                    NOP     0

  17960 28 000433   000002 220003                    LDX0    2,DU
        28 000434   000000 470400 18                 LDP0    ILL$
        28 000435   000000 440100                    SXL0    0,,PR0

  17962 28 000436   000000 470400 18                 LDP0    ILL$
        28 000437   000002 450100                    STZ     2,,PR0

  17963 28 000440   200214 236100                    LDQ     LABEL$,,AUTO
        28 000441   000001 756100                    STQ     1,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:259  

  17964 28 000442   200211 471500                    LDP1    @GROUP$,,AUTO
        28 000443   100000 473500                    LDP3    0,,PR1
        28 000444   300022 236100                    LDQ     18,,PR3
        28 000445   000003 756100                    STQ     3,,PR0

  18286 28 000446   000006 236000 29                 LDQ     6
        28 000447   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000450   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 000451   200257 453500                    STP3    CETT$$+6,,AUTO
        28 000452   000007 236000 29                 LDQ     7
        28 000453   200256 756100                    STQ     CETT$$+5,,AUTO
        28 000454   000020 237000 29                 LDAQ    16
        28 000455   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 000456   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 000457   000003 631400 29                 EPPR1   3
        28 000460   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 000461   000000 011000                    NOP     0

  18287 28 000462   000001 220003                    LDX0    1,DU
        28 000463   000000 470400 18                 LDP0    ILL$
        28 000464   000000 440100                    SXL0    0,,PR0

  18291 28 000465   000057 470400 xsym               LDP0    O1COM+47
        28 000466   000006 236100                    LDQ     6,,PR0
        28 000467   000000 471400 18                 LDP1    ILL$
        28 000470   100001 756100                    STQ     1,,PR1

     1591    18460
     1592    18461               /* CLEAR THE BUFFER */
     1593    18462
     1594    18463                   %NEW_ILL (@ID   = %MVAN,
     1595    18464                             @LOP  = BUFFER_ETT$,
     1596    18465                             @ROP  = CODE_ETT$);

  18778 28 000471   000006 236000 29                 LDQ     6
        28 000472   200252 756100                    STQ     CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:260  
        28 000473   200012 630500                    EPPR0   BUFFER_ETT$,,AUTO
        28 000474   200257 450500                    STP0    CETT$$+6,,AUTO
        28 000475   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 000476   200256 453500                    STP3    CETT$$+5,,AUTO
        28 000477   000026 237000 29                 LDAQ    22
        28 000500   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 000501   000025 236000 29                 LDQ     21
        28 000502   200253 756100                    STQ     CETT$$+2,,AUTO
        28 000503   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 000504   000022 631400 29                 EPPR1   18
        28 000505   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        28 000506   000000 011000                    NOP     0

  18781 28 000507   200012 236100                    LDQ     BUFFER_ETT$,,AUTO
        28 000510   000000 470400 18                 LDP0    ILL$
        28 000511   000001 756100                    STQ     1,,PR0

  18782 28 000512   200020 236100                    LDQ     CODE_ETT$,,AUTO
        28 000513   000002 756100                    STQ     2,,PR0

     1597    18844
     1598    18845               /* PRINT THE FIRST LINE OF THIS GROUP */
     1599    18846
     1600    18847    2          CURRENT$ = GROUP$;

  18847 28 000514   200211 471500                    LDP1    @GROUP$,,AUTO
        28 000515   100000 236100                    LDQ     0,,PR1
        28 000516   200212 756100                    STQ     CURRENT$,,AUTO

     1601    18848
     1602    18849    2          NEXT$ = GROUP$ -> REPORT_01_LTS.FIRST_LINE.LTS$;

  18849 28 000517   100000 473500                    LDP3    0,,PR1
        28 000520   300021 236100                    LDQ     17,,PR3
        28 000521   200213 756100                    STQ     NEXT$,,AUTO

     1603    18850    2          PREV$ = NEXT$;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:261  

  18850 28 000522   200215 756100                    STQ     PREV$,,AUTO

     1604    18851
     1605    18852    3          DO WHILE (NEXT$ -> REPORT_GRP_LTS.NEXT ~= ADDR(NIL)  AND

  18852 28 000523   000527 710000 28                 TRA     s:18857

     1606    18853    3             NOT NEXT$ -> REPORT_GRP_LTS.NEXT -> REPORT_GRP_LTS.B.LINE_PRESENTED);
     1607    18854
     1608    18855    3            NEXT$ = NEXT$ -> REPORT_GRP_LTS.NEXT;

  18855 28 000524   200213 470500                    LDP0    NEXT$,,AUTO
        28 000525   000006 236100                    LDQ     6,,PR0
        28 000526   200213 756100                    STQ     NEXT$,,AUTO

     1609    18856
     1610    18857    3          END; /* WHILE */

  18857 28 000527   200213 470500                    LDP0    NEXT$,,AUTO
        28 000530   000006 236100                    LDQ     6,,PR0
        28 000531   000017 116000 29                 CMPQ    15
        28 000532   000537 600000 28                 TZE     s:18862
        28 000533   000006 471500                    LDP1    6,,PR0
        28 000534   100000 236100                    LDQ     0,,PR1
        28 000535   400000 316007                    CANQ    -131072,DL
        28 000536   000524 600000 28                 TZE     s:18855

     1611    18858
     1612    18859               %EDIT_PRINTABLE_ITEM (@FROM = CURRENT$,
     1613    18860                                     @TO   = NEXT$);

  18862 28 000537   200023 450100                    STZ     RECORD_LEN,,AUTO

  18863 28 000540   200212 236100                    LDQ     CURRENT$,,AUTO
        28 000541   000006 116100                    CMPQ    6,,PR0
        28 000542   001442 600000 28                 TZE     s:19518
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:262  

  18864 28 000543   200212 470500                    LDP0    CURRENT$,,AUTO
        28 000544   000000 220100                    LDX0    0,,PR0
        28 000545   001102 100003                    CMPX0   578,DU
        28 000546   001434 601000 28                 TNZ     s:19513
        28 000547   000000 236100                    LDQ     0,,PR0
        28 000550   010000 316007                    CANQ    4096,DL
        28 000551   001434 600000 28                 TZE     s:19513

  18867 28 000552   200031 450100                    STZ     ALL_BIT,,AUTO

  18868 28 000553   040000 316007                    CANQ    16384,DL
        28 000554   000563 600000 28                 TZE     s:18877

  18870 28 000555   000012 471500                    LDP1    10,,PR0
        28 000556   100004 236100                    LDQ     4,,PR1
        28 000557   200016 756100                    STQ     SEND_ETT$,,AUTO

  18872 28 000560   100002 236100                    LDQ     2,,PR1
        28 000561   200017 756100                    STQ     RECV_ETT$,,AUTO

  18874 28 000562   000635 710000 28                 TRA     s:18898

  18877 28 000563   000017 236000 29                 LDQ     15
        28 000564   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000565   200017 631500                    EPPR1   RECV_ETT$,,AUTO
        28 000566   200255 451500                    STP1    CETT$$+4,,AUTO
        28 000567   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 000570   200254 453500                    STP3    CETT$$+3,,AUTO
        28 000571   200212 236100                    LDQ     CURRENT$,,AUTO
        28 000572   000003 036003                    ADLQ    3,DU
        28 000573   200253 756100                    STQ     CETT$$+2,,AUTO
        28 000574   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 000575   000030 631400 29                 EPPR1   24
        28 000576   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 000577   000000 011000                    NOP     0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:263  
  18880 28 000600   200212 470500                    LDP0    CURRENT$,,AUTO
        28 000601   000000 236100                    LDQ     0,,PR0
        28 000602   100000 316007                    CANQ    32768,DL
        28 000603   000607 600000 28                 TZE     s:18884

  18881 28 000604   000011 236100                    LDQ     9,,PR0
        28 000605   200016 756100                    STQ     SEND_ETT$,,AUTO
        28 000606   000635 710000 28                 TRA     s:18898

  18884 28 000607   000013 236100                    LDQ     11,,PR0
        28 000610   200016 756100                    STQ     SEND_ETT$,,AUTO

  18888 28 000611   200030 756100                    STQ     VAL_ST$,,AUTO

  18889 28 000612   200030 471500                    LDP1    VAL_ST$,,AUTO
        28 000613   100000 220100                    LDX0    0,,PR1
        28 000614   000751 100003                    CMPX0   489,DU
        28 000615   000625 603000 28                 TRC     s:18894

  18890 28 000616   200030 470500                    LDP0    VAL_ST$,,AUTO
        28 000617   000001 236100                    LDQ     1,,PR0
        28 000620   200030 756100                    STQ     VAL_ST$,,AUTO

  18891 28 000621   200030 470500                    LDP0    VAL_ST$,,AUTO
        28 000622   000000 220100                    LDX0    0,,PR0
        28 000623   000751 100003                    CMPX0   489,DU
        28 000624   000616 602000 28                 TNC     s:18890

  18894 28 000625   200030 470500                    LDP0    VAL_ST$,,AUTO
        28 000626   000000 220100                    LDX0    0,,PR0
        28 000627   000767 100003                    CMPX0   503,DU
        28 000630   000635 601000 28                 TNZ     s:18898

  18895 28 000631   000003 236100                    LDQ     3,,PR0
        28 000632   000003 736000                    QLS     3
        28 000633   400000 376003                    ANQ     -131072,DU
        28 000634   200031 756100                    STQ     ALL_BIT,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:264  

  18898 28 000635   200017 470500                    LDP0    RECV_ETT$,,AUTO
        28 000636   000000 220100                    LDX0    0,,PR0
        28 000637   000001 100003                    CMPX0   1,DU
        28 000640   000774 601000 28                 TNZ     s:18952

  18903 28 000641   000002 236000 10                 LDQ     ST_+2
        28 000642   000013 036007                    ADLQ    11,DL
        28 000643   000003 116000 10                 CMPQ    ST_+3
        28 000644   000655 604000 28                 TMI     s:18905

  18904 28 000645   000035 236000 29                 LDQ     29
        28 000646   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000647   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 000650   200253 451500                    STP1    CETT$$+2,,AUTO
        28 000651   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 000652   000034 631400 29                 EPPR1   28
        28 000653   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 000654   000000 011000                    NOP     0

  18905 28 000655   000002 236000 10                 LDQ     ST_+2
        28 000656   000022 736000                    QLS     18
        28 000657   000001 036000 10                 ADLQ    ST_+1
        28 000660   200220 756100                    STQ     ST$$,,AUTO

  18906 28 000661   000013 236007                    LDQ     11,DL
        28 000662   000002 056000 10                 ASQ     ST_+2

  18909 28 000663   200017 470500                    LDP0    RECV_ETT$,,AUTO
        28 000664   000001 471500                    LDP1    1,,PR0
        28 000665   200220 473500                    LDP3    ST$$,,AUTO
        28 000666   000100 100500                    MLR     fill='000'O
        28 000667   100000 000054                    ADSC9   0,,PR1                   cn=0,n=44
        28 000670   300000 000054                    ADSC9   0,,PR3                   cn=0,n=44

  18920 28 000671   000002 236000 13                 LDQ     QLT_+2
        28 000672   000006 036007                    ADLQ    6,DL
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:265  
        28 000673   000003 116000 13                 CMPQ    QLT_+3
        28 000674   000705 602000 28                 TNC     s:18922

  18921 28 000675   000036 236000 29                 LDQ     30
        28 000676   200252 756100                    STQ     CETT$$+1,,AUTO
        28 000677   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 000700   200253 450500                    STP0    CETT$$+2,,AUTO
        28 000701   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 000702   000034 631400 29                 EPPR1   28
        28 000703   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 000704   000000 011000                    NOP     0

  18922 28 000705   000002 236000 13                 LDQ     QLT_+2
        28 000706   000022 736000                    QLS     18
        28 000707   000001 036000 13                 ADLQ    QLT_+1
        28 000710   200224 756100                    STQ     QLT$$,,AUTO

  18923 28 000711   000002 235000 13                 LDA     QLT_+2
        28 000712   000006 035007                    ADLA    6,DL
        28 000713   000002 755000 13                 STA     QLT_+2

  18924 28 000714   001053 220003                    LDX0    555,DU
        28 000715   200224 470500                    LDP0    QLT$$,,AUTO
        28 000716   000000 740100                    STX0    0,,PR0

  18927 28 000717   200003 471500                    LDP1    @LTS$$,,AUTO
        28 000720   100000 473500                    LDP3    0,,PR1
        28 000721   300034 474500                    LDP4    28,,PR3
        28 000722   400007 236100                    LDQ     7,,PR4
        28 000723   000001 756100                    STQ     1,,PR0

  18928 28 000724   100000 473500                    LDP3    0,,PR1
        28 000725   300034 474500                    LDP4    28,,PR3
        28 000726   400007 475500                    LDP5    7,,PR4
        28 000727   500003 236100                    LDQ     3,,PR5
        28 000730   000002 756100                    STQ     2,,PR0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:266  
  18929 28 000731   000017 236000 29                 LDQ     15
        28 000732   000003 756100                    STQ     3,,PR0

  18930 28 000733   200220 236100                    LDQ     ST$$,,AUTO
        28 000734   000004 756100                    STQ     4,,PR0

  18931 28 000735   200220 473500                    LDP3    ST$$,,AUTO
        28 000736   300006 236100                    LDQ     6,,PR3
        28 000737   000005 756100                    STQ     5,,PR0

  18932 28 000740   000002 236007                    LDQ     2,DL
        28 000741   000000 552104                    STBQ    0,'04'O,PR0

  18933 28 000742   000000 236003                    LDQ     0,DU
        28 000743   000000 552110                    STBQ    0,'10'O,PR0

  18934 28 000744   000037 236000 29                 LDQ     31
        28 000745   000000 356100                    ANSQ    0,,PR0

  18935 28 000746   000040 236000 29                 LDQ     32
        28 000747   000000 356100                    ANSQ    0,,PR0

  18936 28 000750   000041 236000 29                 LDQ     33
        28 000751   000000 356100                    ANSQ    0,,PR0

  18937 28 000752   000042 236000 29                 LDQ     34
        28 000753   000000 356100                    ANSQ    0,,PR0

  18940 28 000754   100000 474500                    LDP4    0,,PR1
        28 000755   400034 475500                    LDP5    28,,PR4
        28 000756   500007 476500                    LDP6    7,,PR5
        28 000757   200224 236100                    LDQ     QLT$$,,AUTO
        28 000760   600003 756100                    STQ     3,,PR6

  18941 28 000761   300007 756100                    STQ     7,,PR3

  18942 28 000762   001000 236003                    LDQ     512,DU
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:267  
        28 000763   300003 256100                    ORSQ    3,,PR3

  18943 28 000764   100000 474500                    LDP4    0,,PR1
        28 000765   400034 475500                    LDP5    28,,PR4
        28 000766   500000 236100                    LDQ     0,,PR5
        28 000767   300000 552104                    STBQ    0,'04'O,PR3

  18944 28 000770   200220 236100                    LDQ     ST$$,,AUTO
        28 000771   200017 474500                    LDP4    RECV_ETT$,,AUTO
        28 000772   400001 756100                    STQ     1,,PR4

  18945 28 000773   001130 710000 28                 TRA     s:18998

  18952 28 000774   000002 236000 10                 LDQ     ST_+2
        28 000775   000013 036007                    ADLQ    11,DL
        28 000776   000003 116000 10                 CMPQ    ST_+3
        28 000777   001010 604000 28                 TMI     s:18954

  18953 28 001000   000035 236000 29                 LDQ     29
        28 001001   200252 756100                    STQ     CETT$$+1,,AUTO
        28 001002   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 001003   200253 451500                    STP1    CETT$$+2,,AUTO
        28 001004   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 001005   000034 631400 29                 EPPR1   28
        28 001006   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 001007   000000 011000                    NOP     0

  18954 28 001010   000002 236000 10                 LDQ     ST_+2
        28 001011   000022 736000                    QLS     18
        28 001012   000001 036000 10                 ADLQ    ST_+1
        28 001013   200220 756100                    STQ     ST$$,,AUTO

  18955 28 001014   000013 236007                    LDQ     11,DL
        28 001015   000002 056000 10                 ASQ     ST_+2

  18958 28 001016   200017 470500                    LDP0    RECV_ETT$,,AUTO
        28 001017   000001 471500                    LDP1    1,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:268  
        28 001020   100001 473500                    LDP3    1,,PR1
        28 001021   200220 474500                    LDP4    ST$$,,AUTO
        28 001022   000100 100500                    MLR     fill='000'O
        28 001023   300000 000054                    ADSC9   0,,PR3                   cn=0,n=44
        28 001024   400000 000054                    ADSC9   0,,PR4                   cn=0,n=44

  18969 28 001025   000002 236000 13                 LDQ     QLT_+2
        28 001026   000006 036007                    ADLQ    6,DL
        28 001027   000003 116000 13                 CMPQ    QLT_+3
        28 001030   001041 602000 28                 TNC     s:18971

  18970 28 001031   000036 236000 29                 LDQ     30
        28 001032   200252 756100                    STQ     CETT$$+1,,AUTO
        28 001033   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 001034   200253 450500                    STP0    CETT$$+2,,AUTO
        28 001035   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 001036   000034 631400 29                 EPPR1   28
        28 001037   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 001040   000000 011000                    NOP     0

  18971 28 001041   000002 236000 13                 LDQ     QLT_+2
        28 001042   000022 736000                    QLS     18
        28 001043   000001 036000 13                 ADLQ    QLT_+1
        28 001044   200224 756100                    STQ     QLT$$,,AUTO

  18972 28 001045   000002 235000 13                 LDA     QLT_+2
        28 001046   000006 035007                    ADLA    6,DL
        28 001047   000002 755000 13                 STA     QLT_+2

  18973 28 001050   001053 220003                    LDX0    555,DU
        28 001051   200224 470500                    LDP0    QLT$$,,AUTO
        28 001052   000000 740100                    STX0    0,,PR0

  18976 28 001053   200003 471500                    LDP1    @LTS$$,,AUTO
        28 001054   100000 473500                    LDP3    0,,PR1
        28 001055   300034 474500                    LDP4    28,,PR3
        28 001056   400007 236100                    LDQ     7,,PR4
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:269  
        28 001057   000001 756100                    STQ     1,,PR0

  18977 28 001060   100000 473500                    LDP3    0,,PR1
        28 001061   300034 474500                    LDP4    28,,PR3
        28 001062   400007 475500                    LDP5    7,,PR4
        28 001063   500003 236100                    LDQ     3,,PR5
        28 001064   000002 756100                    STQ     2,,PR0

  18978 28 001065   000017 236000 29                 LDQ     15
        28 001066   000003 756100                    STQ     3,,PR0

  18979 28 001067   200220 236100                    LDQ     ST$$,,AUTO
        28 001070   000004 756100                    STQ     4,,PR0

  18980 28 001071   200220 473500                    LDP3    ST$$,,AUTO
        28 001072   300006 236100                    LDQ     6,,PR3
        28 001073   000005 756100                    STQ     5,,PR0

  18981 28 001074   000002 236007                    LDQ     2,DL
        28 001075   000000 552104                    STBQ    0,'04'O,PR0

  18982 28 001076   000000 236003                    LDQ     0,DU
        28 001077   000000 552110                    STBQ    0,'10'O,PR0

  18983 28 001100   000037 236000 29                 LDQ     31
        28 001101   000000 356100                    ANSQ    0,,PR0

  18984 28 001102   000040 236000 29                 LDQ     32
        28 001103   000000 356100                    ANSQ    0,,PR0

  18985 28 001104   000041 236000 29                 LDQ     33
        28 001105   000000 356100                    ANSQ    0,,PR0

  18986 28 001106   000042 236000 29                 LDQ     34
        28 001107   000000 356100                    ANSQ    0,,PR0

  18989 28 001110   100000 474500                    LDP4    0,,PR1
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:270  
        28 001111   400034 475500                    LDP5    28,,PR4
        28 001112   500007 476500                    LDP6    7,,PR5
        28 001113   200224 236100                    LDQ     QLT$$,,AUTO
        28 001114   600003 756100                    STQ     3,,PR6

  18990 28 001115   300007 756100                    STQ     7,,PR3

  18991 28 001116   001000 236003                    LDQ     512,DU
        28 001117   300003 256100                    ORSQ    3,,PR3

  18992 28 001120   100000 474500                    LDP4    0,,PR1
        28 001121   400034 475500                    LDP5    28,,PR4
        28 001122   500000 236100                    LDQ     0,,PR5
        28 001123   300000 552104                    STBQ    0,'04'O,PR3

  18993 28 001124   200017 474500                    LDP4    RECV_ETT$,,AUTO
        28 001125   400001 475500                    LDP5    1,,PR4
        28 001126   200220 236100                    LDQ     ST$$,,AUTO
        28 001127   500001 756100                    STQ     1,,PR5

  18998 28 001130   200017 236100                    LDQ     RECV_ETT$,,AUTO
        28 001131   200225 756100                    STQ     RECV_ST$,,AUTO

  18999 28 001132   200225 474500                    LDP4    RECV_ST$,,AUTO
        28 001133   400000 221100                    LDX1    0,,PR4
        28 001134   000751 101003                    CMPX1   489,DU
        28 001135   001145 603000 28                 TRC     s:19006

  19000 28 001136   200225 470500                    LDP0    RECV_ST$,,AUTO
        28 001137   000001 236100                    LDQ     1,,PR0
        28 001140   200225 756100                    STQ     RECV_ST$,,AUTO

  19001 28 001141   200225 470500                    LDP0    RECV_ST$,,AUTO
        28 001142   000000 220100                    LDX0    0,,PR0
        28 001143   000751 100003                    CMPX0   489,DU
        28 001144   001136 602000 28                 TNC     s:19000

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:271  
  19006 28 001145   200012 236100                    LDQ     BUFFER_ETT$,,AUTO
        28 001146   200226 756100                    STQ     BUF_ST$,,AUTO

  19007 28 001147   200226 470500                    LDP0    BUF_ST$,,AUTO
        28 001150   000000 220100                    LDX0    0,,PR0
        28 001151   000751 100003                    CMPX0   489,DU
        28 001152   001162 603000 28                 TRC     s:19012

  19008 28 001153   200226 470500                    LDP0    BUF_ST$,,AUTO
        28 001154   000001 236100                    LDQ     1,,PR0
        28 001155   200226 756100                    STQ     BUF_ST$,,AUTO

  19009 28 001156   200226 470500                    LDP0    BUF_ST$,,AUTO
        28 001157   000000 220100                    LDX0    0,,PR0
        28 001160   000751 100003                    CMPX0   489,DU
        28 001161   001153 602000 28                 TNC     s:19008

  19012 28 001162   200225 471500                    LDP1    RECV_ST$,,AUTO
        28 001163   000000 236100                    LDQ     0,,PR0
        28 001164   100000 552110                    STBQ    0,'10'O,PR1

  19013 28 001165   000000 236100                    LDQ     0,,PR0
        28 001166   100000 552104                    STBQ    0,'04'O,PR1

  19014 28 001167   200212 473500                    LDP3    CURRENT$,,AUTO
        28 001170   300007 236100                    LDQ     7,,PR3
        28 001171   200010 036100                    ADLQ    SA_ADJ,,AUTO
        28 001172   000004 506007                    DIV     4,DL
        28 001173   000000 620006                    EAX0    0,QL
        28 001174   100001 740100                    STX0    1,,PR1

  19015 28 001175   300007 236100                    LDQ     7,,PR3
        28 001176   200010 036100                    ADLQ    SA_ADJ,,AUTO
        28 001177   000004 506007                    DIV     4,DL
        28 001200   000044 733000                    LRS     36
        28 001201   000020 736000                    QLS     16
        28 001202   100001 676100                    ERQ     1,,PR1
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:272  
        28 001203   600000 376007                    ANQ     -65536,DL
        28 001204   100001 656100                    ERSQ    1,,PR1

  19016 28 001205   300007 236100                    LDQ     7,,PR3
        28 001206   300010 036100                    ADLQ    8,,PR3
        28 001207   200010 036100                    ADLQ    SA_ADJ,,AUTO
        28 001210   200023 756100                    STQ     RECORD_LEN,,AUTO

  19018 28 001211   100002 236100                    LDQ     2,,PR1
        28 001212   777777 376007                    ANQ     -1,DL
        28 001213   200217 756100                    STQ     LINE_NO#,,AUTO

  19024 28 001214   200016 236100                    LDQ     SEND_ETT$,,AUTO
        28 001215   200220 756100                    STQ     ST$$,,AUTO

  19025 28 001216   200220 474500                    LDP4    ST$$,,AUTO
        28 001217   400000 220100                    LDX0    0,,PR4
        28 001220   000751 100003                    CMPX0   489,DU
        28 001221   001231 603000 28                 TRC     s:19030

  19026 28 001222   200220 470500                    LDP0    ST$$,,AUTO
        28 001223   000001 236100                    LDQ     1,,PR0
        28 001224   200220 756100                    STQ     ST$$,,AUTO

  19027 28 001225   200220 470500                    LDP0    ST$$,,AUTO
        28 001226   000000 220100                    LDX0    0,,PR0
        28 001227   000751 100003                    CMPX0   489,DU
        28 001230   001222 602000 28                 TNC     s:19026

  19030 28 001231   200220 470500                    LDP0    ST$$,,AUTO
        28 001232   000002 236100                    LDQ     2,,PR0
        28 001233   000022 772000                    QRL     18
        28 001234   200221 756100                    STQ     ST_TYPE,,AUTO

  19040 28 001235   000004 220003                    LDX0    4,DU
        28 001236   200074 740100                    STX0    SEND_FIELD,,AUTO

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:273  
  19041 28 001237   000000 221003                    LDX1    0,DU
        28 001240   200074 441100                    SXL1    SEND_FIELD,,AUTO

  19042 28 001241   200100 756100                    STQ     SEND_FIELD+4,,AUTO

  19043 28 001242   000017 236000 29                 LDQ     15
        28 001243   200103 756100                    STQ     SEND_FIELD+7,,AUTO

  19044 28 001244   200016 236100                    LDQ     SEND_ETT$,,AUTO
        28 001245   200075 756100                    STQ     SEND_FIELD+1,,AUTO

  19045 28 001246   000017 236000 29                 LDQ     15
        28 001247   200076 756100                    STQ     SEND_FIELD+2,,AUTO

  19047 28 001250   200217 235100                    LDA     LINE_NO#,,AUTO
        28 001251   200101 755100                    STA     SEND_FIELD+5,,AUTO

  19048 28 001252   200102 450100                    STZ     SEND_FIELD+6,,AUTO

  19053 28 001253   200031 236100                    LDQ     ALL_BIT,,AUTO
        28 001254   000025 772000                    QRL     21
        28 001255   200074 676100                    ERQ     SEND_FIELD,,AUTO
        28 001256   040000 376007                    ANQ     16384,DL
        28 001257   200074 656100                    ERSQ    SEND_FIELD,,AUTO

  19065 28 001260   200017 236100                    LDQ     RECV_ETT$,,AUTO
        28 001261   200220 756100                    STQ     ST$$,,AUTO

  19066 28 001262   200220 470500                    LDP0    ST$$,,AUTO
        28 001263   000000 222100                    LDX2    0,,PR0
        28 001264   000751 102003                    CMPX2   489,DU
        28 001265   001275 603000 28                 TRC     s:19071

  19067 28 001266   200220 470500                    LDP0    ST$$,,AUTO
        28 001267   000001 236100                    LDQ     1,,PR0
        28 001270   200220 756100                    STQ     ST$$,,AUTO

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:274  
  19068 28 001271   200220 470500                    LDP0    ST$$,,AUTO
        28 001272   000000 220100                    LDX0    0,,PR0
        28 001273   000751 100003                    CMPX0   489,DU
        28 001274   001266 602000 28                 TNC     s:19067

  19071 28 001275   000002 236100                    LDQ     2,,PR0
        28 001276   000022 772000                    QRL     18
        28 001277   200221 756100                    STQ     ST_TYPE,,AUTO

  19080 28 001300   000004 220003                    LDX0    4,DU
        28 001301   200104 740100                    STX0    RECV_FIELD,,AUTO

  19081 28 001302   000000 221003                    LDX1    0,DU
        28 001303   200104 441100                    SXL1    RECV_FIELD,,AUTO

  19082 28 001304   200110 756100                    STQ     RECV_FIELD+4,,AUTO

  19083 28 001305   000017 236000 29                 LDQ     15
        28 001306   200113 756100                    STQ     RECV_FIELD+7,,AUTO

  19084 28 001307   200017 236100                    LDQ     RECV_ETT$,,AUTO
        28 001310   200105 756100                    STQ     RECV_FIELD+1,,AUTO

  19085 28 001311   000017 236000 29                 LDQ     15
        28 001312   200106 756100                    STQ     RECV_FIELD+2,,AUTO

  19087 28 001313   200217 235100                    LDA     LINE_NO#,,AUTO
        28 001314   200111 755100                    STA     RECV_FIELD+5,,AUTO

  19088 28 001315   200112 450100                    STZ     RECV_FIELD+6,,AUTO

  19100 28 001316   200212 471500                    LDP1    CURRENT$,,AUTO
        28 001317   100000 236100                    LDQ     0,,PR1
        28 001320   020000 316007                    CANQ    8192,DL
        28 001321   001420 600000 28                 TZE     s:19510

  19102 28 001322   200021 633500                    EPPR3   IND$$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:275  
        28 001323   200253 453500                    STP3    CETT$$+2,,AUTO
        28 001324   000002 236000 29                 LDQ     2
        28 001325   200252 756100                    STQ     CETT$$+1,,AUTO
        28 001326   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 001327   000000 631400 29                 EPPR1   0
        28 001330   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 001331   000000 011000                    NOP     0

  19108 28 001332   000005 220003                    LDX0    5,DU
        28 001333   200144 740100                    STX0    COMPARE,,AUTO

  19109 28 001334   000000 221003                    LDX1    0,DU
        28 001335   200144 441100                    SXL1    COMPARE,,AUTO

  19116 28 001336   000133 235000 xsym               LDA     COMCOM+91
        28 001337   200151 755100                    STA     COMPARE+5,,AUTO

  19117 28 001340   000134 236000 xsym               LDQ     COMCOM+92
        28 001341   200152 756100                    STQ     COMPARE+6,,AUTO

  19118 28 001342   200134 630500                    EPPR0   ZERO,,AUTO
        28 001343   200146 450500                    STP0    COMPARE+2,,AUTO

  19119 28 001344   200154 631500                    EPPR1   IND_FIELD,,AUTO
        28 001345   200145 451500                    STP1    COMPARE+1,,AUTO

  19120 28 001346   000027 235007                    LDA     23,DL
        28 001347   200147 755100                    STA     COMPARE+3,,AUTO

  19121 28 001350   000017 236000 29                 LDQ     15
        28 001351   200153 756100                    STQ     COMPARE+7,,AUTO

  19124 28 001352   200144 633500                    EPPR3   COMPARE,,AUTO
        28 001353   200252 453500                    STP3    CETT$$+1,,AUTO
        28 001354   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 001355   200255 454500                    STP4    CETT$$+4,,AUTO
        28 001356   200021 635500                    EPPR5   IND$$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:276  
        28 001357   200254 455500                    STP5    CETT$$+3,,AUTO
        28 001360   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 001361   000000 631400 29                 EPPR1   0
        28 001362   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        28 001363   000000 011000                    NOP     0

  19126 28 001364   200104 630500                    EPPR0   RECV_FIELD,,AUTO
        28 001365   200252 450500                    STP0    CETT$$+1,,AUTO
        28 001366   200074 631500                    EPPR1   SEND_FIELD,,AUTO
        28 001367   200253 451500                    STP1    CETT$$+2,,AUTO
        28 001370   200253 633500                    EPPR3   CETT$$+2,,AUTO
        28 001371   200255 453500                    STP3    CETT$$+4,,AUTO
        28 001372   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 001373   200254 454500                    STP4    CETT$$+3,,AUTO
        28 001374   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 001375   000000 631400 29                 EPPR1   0
        28 001376   000000 701000 xent               TSX1    Z8E7$MOVE
        28 001377   000000 011000                    NOP     0

  19461 28 001400   000006 236000 29                 LDQ     6
        28 001401   200252 756100                    STQ     CETT$$+1,,AUTO
        28 001402   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 001403   200257 450500                    STP0    CETT$$+6,,AUTO
        28 001404   000007 236000 29                 LDQ     7
        28 001405   200256 756100                    STQ     CETT$$+5,,AUTO
        28 001406   000010 237000 29                 LDAQ    8
        28 001407   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 001410   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 001411   000003 631400 29                 EPPR1   3
        28 001412   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 001413   000000 011000                    NOP     0

  19462 28 001414   200021 236100                    LDQ     IND$$,,AUTO
        28 001415   000000 470400 18                 LDP0    ILL$
        28 001416   000001 756100                    STQ     1,,PR0

  19508 28 001417   001434 710000 28                 TRA     s:19513
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:277  

  19510 28 001420   200104 633500                    EPPR3   RECV_FIELD,,AUTO
        28 001421   200252 453500                    STP3    CETT$$+1,,AUTO
        28 001422   200074 634500                    EPPR4   SEND_FIELD,,AUTO
        28 001423   200253 454500                    STP4    CETT$$+2,,AUTO
        28 001424   200253 635500                    EPPR5   CETT$$+2,,AUTO
        28 001425   200255 455500                    STP5    CETT$$+4,,AUTO
        28 001426   200252 636500                    EPPR6   CETT$$+1,,AUTO
        28 001427   200254 456500                    STP6    CETT$$+3,,AUTO
        28 001430   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 001431   000000 631400 29                 EPPR1   0
        28 001432   000000 701000 xent               TSX1    Z8E7$MOVE
        28 001433   000000 011000                    NOP     0

  19513 28 001434   200212 470500                    LDP0    CURRENT$,,AUTO
        28 001435   000006 236100                    LDQ     6,,PR0
        28 001436   200212 756100                    STQ     CURRENT$,,AUTO

  19514 28 001437   200213 470500                    LDP0    NEXT$,,AUTO
        28 001440   000006 116100                    CMPQ    6,,PR0
        28 001441   000543 601000 28                 TNZ     s:18864

     1614    19517
     1615    19518    2            IF RECORD_LEN < MIN_REC_LEN THEN

  19518 28 001442   200023 236100                    LDQ     RECORD_LEN,,AUTO
        28 001443   200024 116100                    CMPQ    MIN_REC_LEN,,AUTO
        28 001444   001447 605000 28                 TPL     s:19521

     1616    19519    2              RECORD_LEN = MIN_REC_LEN;

  19519 28 001445   200024 235100                    LDA     MIN_REC_LEN,,AUTO
        28 001446   200023 755100                    STA     RECORD_LEN,,AUTO

     1617    19520
     1618    19521    2          CALL Z8AC$LX_ETT_ITEM_TYI_CONST (RECORD_LEN,

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:278  
  19521 28 001447   200114 631500                    EPPR1   RECORD_LENGTH,,AUTO
        28 001450   200252 451500                    STP1    CETT$$+1,,AUTO
        28 001451   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 001452   200255 453500                    STP3    CETT$$+4,,AUTO
        28 001453   200023 634500                    EPPR4   RECORD_LEN,,AUTO
        28 001454   200254 454500                    STP4    CETT$$+3,,AUTO
        28 001455   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 001456   000000 631400 29                 EPPR1   0
        28 001457   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        28 001460   000000 011000                    NOP     0

     1619    19522    2                                           ADDR(RECORD_LENGTH));
     1620    19523
     1621    19524    2          CALL Z9EN$WRITE_NEXT (FILE_LTS$,

  19524 28 001461   000017 236000 29                 LDQ     15
        28 001462   200252 756100                    STQ     CETT$$+1,,AUTO
        28 001463   200253 756100                    STQ     CETT$$+2,,AUTO
        28 001464   200114 630500                    EPPR0   RECORD_LENGTH,,AUTO
        28 001465   200254 450500                    STP0    CETT$$+3,,AUTO
        28 001466   200032 631500                    EPPR1   AFTER_FIELD,,AUTO
        28 001467   200255 451500                    STP1    CETT$$+4,,AUTO
        28 001470   200004 633500                    EPPR3   REPORT_CODE_NO,,AUTO
        28 001471   200264 453500                    STP3    CETT$$+11,,AUTO
        28 001472   000045 236000 29                 LDQ     37
        28 001473   200263 756100                    STQ     CETT$$+10,,AUTO
        28 001474   200255 634500                    EPPR4   CETT$$+4,,AUTO
        28 001475   200262 454500                    STP4    CETT$$+9,,AUTO
        28 001476   200254 635500                    EPPR5   CETT$$+3,,AUTO
        28 001477   200261 455500                    STP5    CETT$$+8,,AUTO
        28 001500   200253 636500                    EPPR6   CETT$$+2,,AUTO
        28 001501   200260 456500                    STP6    CETT$$+7,,AUTO
        28 001502   200252 637500                    EPPR7   CETT$$+1,,AUTO
        28 001503   200257 457500                    STP7    CETT$$+6,,AUTO
        28 001504   200027 630500                    EPPR0   FILE_LTS$,,AUTO
        28 001505   200256 450500                    STP0    CETT$$+5,,AUTO
        28 001506   200256 630500                    EPPR0   CETT$$+5,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:279  
        28 001507   000043 631400 29                 EPPR1   35
        28 001510   000000 701000 xent               TSX1    Z9EN$WRITE_NEXT
        28 001511   000000 011000                    NOP     0

     1622    19525    2                                ADDR(NIL),
     1623    19526    2                                ADDR(NIL),
     1624    19527    2                                ADDR(RECORD_LENGTH),
     1625    19528    2                                ADDR(AFTER_FIELD),
     1626    19529    2                                %AFTER_LINES,
     1627    19530    2                                REPORT_CODE_NO);
     1628    19531
     1629    19532               /* PRINT THE REMAINING LINES */
     1630    19533
     1631    19534    2          NEXT$ = NEXT$ -> REPORT_GRP_LTS.NEXT;

  19534 28 001512   200213 470500                    LDP0    NEXT$,,AUTO
        28 001513   000006 236100                    LDQ     6,,PR0
        28 001514   200213 756100                    STQ     NEXT$,,AUTO

     1632    19535
     1633    19536    3          DO WHILE (NEXT$ ~= ADDR(NIL));

  19536 28 001515   002650 710000 28                 TRA     s:20675

     1634    19537
     1635    19538    3            CURRENT$ = NEXT$;

  19538 28 001516   200213 236100                    LDQ     NEXT$,,AUTO
        28 001517   200212 756100                    STQ     CURRENT$,,AUTO

     1636    19539
     1637    19540    3            IF CURRENT$ -> REPORT_GRP_LTS.LINE_TYPE = %REPORT_LINE_INT THEN

  19540 28 001520   200212 470500                    LDP0    CURRENT$,,AUTO
        28 001521   000001 235100                    LDA     1,,PR0
        28 001522   000001 115007                    CMPA    1,DL
        28 001523   001531 601000 28                 TNZ     s:19544
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:280  

     1638    19541    3              LINE_SPAN = CURRENT$ -> REPORT_GRP_LTS.LINE_NO# -

  19541 28 001524   200215 471500                    LDP1    PREV$,,AUTO
        28 001525   000002 236100                    LDQ     2,,PR0
        28 001526   100002 136100                    SBLQ    2,,PR1
        28 001527   200216 756100                    STQ     LINE_SPAN,,AUTO
        28 001530   001533 710000 28                 TRA     s:19548

     1639    19542    3                          PREV$ -> REPORT_GRP_LTS.LINE_NO#;
     1640    19543    3            ELSE
     1641    19544    3              LINE_SPAN = CURRENT$ -> REPORT_GRP_LTS.LINE_NO#;

  19544 28 001531   000002 235100                    LDA     2,,PR0
        28 001532   200216 755100                    STA     LINE_SPAN,,AUTO

     1642    19545
     1643    19546                   /* UPDATE LINE COUNTER */
     1644    19547
     1645    19548    3            MKCN.CON = LINE_SPAN;

  19548 28 001533   200216 235100                    LDA     LINE_SPAN,,AUTO
        28 001534   000000 755000 24                 STA     MKCN

     1646    19549
     1647    19550    3            CALL Z8AC$MAKE_CONST (CONST_ETT$);

  19550 28 001535   200011 631500                    EPPR1   CONST_ETT$,,AUTO
        28 001536   200252 451500                    STP1    CETT$$+1,,AUTO
        28 001537   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 001540   000034 631400 29                 EPPR1   28
        28 001541   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        28 001542   000000 011000                    NOP     0

     1648    19551
     1649    19552                 %INIT_LX_ETT_ITEM (@POINTER = "ADDR(LINE_FIELD)",
     1650    19553                                    @TYPE    = %TYI,
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:281  
     1651    19554                                    @ETT$    = CONST_ETT$);

  19556 28 001543   000004 220003                    LDX0    4,DU
        28 001544   200124 740100                    STX0    LINE_FIELD,,AUTO

  19557 28 001545   000000 221003                    LDX1    0,DU
        28 001546   200124 441100                    SXL1    LINE_FIELD,,AUTO

  19558 28 001547   000001 235007                    LDA     1,DL
        28 001550   200130 755100                    STA     LINE_FIELD+4,,AUTO

  19559 28 001551   000017 236000 29                 LDQ     15
        28 001552   200133 756100                    STQ     LINE_FIELD+7,,AUTO

  19560 28 001553   200011 236100                    LDQ     CONST_ETT$,,AUTO
        28 001554   200125 756100                    STQ     LINE_FIELD+1,,AUTO

  19561 28 001555   000017 236000 29                 LDQ     15
        28 001556   200126 756100                    STQ     LINE_FIELD+2,,AUTO

  19563 28 001557   000133 235000 xsym               LDA     COMCOM+91
        28 001560   200131 755100                    STA     LINE_FIELD+5,,AUTO

  19564 28 001561   000134 235000 xsym               LDA     COMCOM+92
        28 001562   200132 755100                    STA     LINE_FIELD+6,,AUTO

     1652    19576
     1653    19577                 %INIT_BINARY_OP (@POINTER   = "ADDR(OP_NODE)",
     1654    19578                                  @ROP$      = "ADDR(LINE_FIELD)",
     1655    19579                                  @LOP$      = "ADDR(LINE_COUNTER_FIELD)",
     1656    19580                                  @OP        = %OP_PLUS);

  19582 28 001563   000005 222003                    LDX2    5,DU
        28 001564   200064 742100                    STX2    OP_NODE,,AUTO

  19583 28 001565   200064 441100                    SXL1    OP_NODE,,AUTO

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:282  
  19590 28 001566   000133 235000 xsym               LDA     COMCOM+91
        28 001567   200071 755100                    STA     OP_NODE+5,,AUTO

  19591 28 001570   000134 235000 xsym               LDA     COMCOM+92
        28 001571   200072 755100                    STA     OP_NODE+6,,AUTO

  19592 28 001572   200124 630500                    EPPR0   LINE_FIELD,,AUTO
        28 001573   200066 450500                    STP0    OP_NODE+2,,AUTO

  19593 28 001574   200042 631500                    EPPR1   LINE_COUNTER_FIELD,,AUTO
        28 001575   200065 451500                    STP1    OP_NODE+1,,AUTO

  19594 28 001576   000020 235007                    LDA     16,DL
        28 001577   200067 755100                    STA     OP_NODE+3,,AUTO

  19595 28 001600   200073 756100                    STQ     OP_NODE+7,,AUTO

     1657    19598
     1658    19599    3            CALL Z8E5$MATH_PACK (ADDR(OP_NODE),

  19599 28 001601   200064 633500                    EPPR3   OP_NODE,,AUTO
        28 001602   200252 453500                    STP3    CETT$$+1,,AUTO
        28 001603   200054 634500                    EPPR4   ETT_ITEM,,AUTO
        28 001604   200253 454500                    STP4    CETT$$+2,,AUTO
        28 001605   200253 635500                    EPPR5   CETT$$+2,,AUTO
        28 001606   200255 455500                    STP5    CETT$$+4,,AUTO
        28 001607   200252 636500                    EPPR6   CETT$$+1,,AUTO
        28 001610   200254 456500                    STP6    CETT$$+3,,AUTO
        28 001611   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 001612   000000 631400 29                 EPPR1   0
        28 001613   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        28 001614   000000 011000                    NOP     0

     1659    19600    3                                 ADDR(ETT_ITEM));
     1660    19601
     1661    19602    3            CALL Z8E7$MOVE (ADDR(LINE_COUNTER_FIELD),

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:283  
  19602 28 001615   200042 630500                    EPPR0   LINE_COUNTER_FIELD,,AUTO
        28 001616   200252 450500                    STP0    CETT$$+1,,AUTO
        28 001617   200054 631500                    EPPR1   ETT_ITEM,,AUTO
        28 001620   200253 451500                    STP1    CETT$$+2,,AUTO
        28 001621   200253 633500                    EPPR3   CETT$$+2,,AUTO
        28 001622   200255 453500                    STP3    CETT$$+4,,AUTO
        28 001623   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 001624   200254 454500                    STP4    CETT$$+3,,AUTO
        28 001625   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 001626   000000 631400 29                 EPPR1   0
        28 001627   000000 701000 xent               TSX1    Z8E7$MOVE
        28 001630   000000 011000                    NOP     0

     1662    19603    3                            ADDR(ETT_ITEM));
     1663    19604
     1664    19605    3            PREV$ = NEXT$;

  19605 28 001631   200213 236100                    LDQ     NEXT$,,AUTO
        28 001632   200215 756100                    STQ     PREV$,,AUTO

     1665    19606
     1666    19607                 /* BLANK OUT THE BUFFER */
     1667    19608
     1668    19609
     1669    19610                   %NEW_ILL (@ID   = %MVAN,
     1670    19611                             @LOP  = BUFFER_ETT$,
     1671    19612                             @ROP  = CODE_ETT$);

  19925 28 001633   000006 236000 29                 LDQ     6
        28 001634   200252 756100                    STQ     CETT$$+1,,AUTO
        28 001635   200012 630500                    EPPR0   BUFFER_ETT$,,AUTO
        28 001636   200257 450500                    STP0    CETT$$+6,,AUTO
        28 001637   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 001640   200256 451500                    STP1    CETT$$+5,,AUTO
        28 001641   000026 237000 29                 LDAQ    22
        28 001642   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 001643   000025 236000 29                 LDQ     21
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:284  
        28 001644   200253 756100                    STQ     CETT$$+2,,AUTO
        28 001645   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 001646   000022 631400 29                 EPPR1   18
        28 001647   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        28 001650   000000 011000                    NOP     0

  19928 28 001651   200012 236100                    LDQ     BUFFER_ETT$,,AUTO
        28 001652   000000 470400 18                 LDP0    ILL$
        28 001653   000001 756100                    STQ     1,,PR0

  19929 28 001654   200020 236100                    LDQ     CODE_ETT$,,AUTO
        28 001655   000002 756100                    STQ     2,,PR0

     1672    19991
     1673    19992    4            DO WHILE (NEXT$ -> REPORT_GRP_LTS.NEXT ~= ADDR(NIL)  AND

  19992 28 001656   001662 710000 28                 TRA     s:19997

     1674    19993    4               NOT NEXT$ -> REPORT_GRP_LTS.NEXT -> REPORT_GRP_LTS.B.LINE_PRESENTED);
     1675    19994
     1676    19995    4              NEXT$ = NEXT$ -> REPORT_GRP_LTS.NEXT;

  19995 28 001657   200213 470500                    LDP0    NEXT$,,AUTO
        28 001660   000006 236100                    LDQ     6,,PR0
        28 001661   200213 756100                    STQ     NEXT$,,AUTO

     1677    19996
     1678    19997    4            END; /* WHILE */

  19997 28 001662   200213 470500                    LDP0    NEXT$,,AUTO
        28 001663   000006 236100                    LDQ     6,,PR0
        28 001664   000017 116000 29                 CMPQ    15
        28 001665   001672 600000 28                 TZE     s:20002
        28 001666   000006 471500                    LDP1    6,,PR0
        28 001667   100000 236100                    LDQ     0,,PR1
        28 001670   400000 316007                    CANQ    -131072,DL
        28 001671   001657 600000 28                 TZE     s:19995
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:285  

     1679    19998
     1680    19999                 %EDIT_PRINTABLE_ITEM (@FROM = CURRENT$,
     1681    20000                                       @TO   = NEXT$);

  20002 28 001672   200023 450100                    STZ     RECORD_LEN,,AUTO

  20003 28 001673   200212 236100                    LDQ     CURRENT$,,AUTO
        28 001674   000006 116100                    CMPQ    6,,PR0
        28 001675   002575 600000 28                 TZE     s:20658

  20004 28 001676   200212 470500                    LDP0    CURRENT$,,AUTO
        28 001677   000000 220100                    LDX0    0,,PR0
        28 001700   001102 100003                    CMPX0   578,DU
        28 001701   002567 601000 28                 TNZ     s:20653
        28 001702   000000 236100                    LDQ     0,,PR0
        28 001703   010000 316007                    CANQ    4096,DL
        28 001704   002567 600000 28                 TZE     s:20653

  20007 28 001705   200031 450100                    STZ     ALL_BIT,,AUTO

  20008 28 001706   040000 316007                    CANQ    16384,DL
        28 001707   001716 600000 28                 TZE     s:20017

  20010 28 001710   000012 471500                    LDP1    10,,PR0
        28 001711   100004 236100                    LDQ     4,,PR1
        28 001712   200016 756100                    STQ     SEND_ETT$,,AUTO

  20012 28 001713   100002 236100                    LDQ     2,,PR1
        28 001714   200017 756100                    STQ     RECV_ETT$,,AUTO

  20014 28 001715   001770 710000 28                 TRA     s:20038

  20017 28 001716   000017 236000 29                 LDQ     15
        28 001717   200252 756100                    STQ     CETT$$+1,,AUTO
        28 001720   200017 631500                    EPPR1   RECV_ETT$,,AUTO
        28 001721   200255 451500                    STP1    CETT$$+4,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:286  
        28 001722   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 001723   200254 453500                    STP3    CETT$$+3,,AUTO
        28 001724   200212 236100                    LDQ     CURRENT$,,AUTO
        28 001725   000003 036003                    ADLQ    3,DU
        28 001726   200253 756100                    STQ     CETT$$+2,,AUTO
        28 001727   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 001730   000030 631400 29                 EPPR1   24
        28 001731   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 001732   000000 011000                    NOP     0

  20020 28 001733   200212 470500                    LDP0    CURRENT$,,AUTO
        28 001734   000000 236100                    LDQ     0,,PR0
        28 001735   100000 316007                    CANQ    32768,DL
        28 001736   001742 600000 28                 TZE     s:20024

  20021 28 001737   000011 236100                    LDQ     9,,PR0
        28 001740   200016 756100                    STQ     SEND_ETT$,,AUTO
        28 001741   001770 710000 28                 TRA     s:20038

  20024 28 001742   000013 236100                    LDQ     11,,PR0
        28 001743   200016 756100                    STQ     SEND_ETT$,,AUTO

  20028 28 001744   200030 756100                    STQ     VAL_ST$,,AUTO

  20029 28 001745   200030 471500                    LDP1    VAL_ST$,,AUTO
        28 001746   100000 220100                    LDX0    0,,PR1
        28 001747   000751 100003                    CMPX0   489,DU
        28 001750   001760 603000 28                 TRC     s:20034

  20030 28 001751   200030 470500                    LDP0    VAL_ST$,,AUTO
        28 001752   000001 236100                    LDQ     1,,PR0
        28 001753   200030 756100                    STQ     VAL_ST$,,AUTO

  20031 28 001754   200030 470500                    LDP0    VAL_ST$,,AUTO
        28 001755   000000 220100                    LDX0    0,,PR0
        28 001756   000751 100003                    CMPX0   489,DU
        28 001757   001751 602000 28                 TNC     s:20030
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:287  

  20034 28 001760   200030 470500                    LDP0    VAL_ST$,,AUTO
        28 001761   000000 220100                    LDX0    0,,PR0
        28 001762   000767 100003                    CMPX0   503,DU
        28 001763   001770 601000 28                 TNZ     s:20038

  20035 28 001764   000003 236100                    LDQ     3,,PR0
        28 001765   000003 736000                    QLS     3
        28 001766   400000 376003                    ANQ     -131072,DU
        28 001767   200031 756100                    STQ     ALL_BIT,,AUTO

  20038 28 001770   200017 470500                    LDP0    RECV_ETT$,,AUTO
        28 001771   000000 220100                    LDX0    0,,PR0
        28 001772   000001 100003                    CMPX0   1,DU
        28 001773   002127 601000 28                 TNZ     s:20092

  20043 28 001774   000002 236000 10                 LDQ     ST_+2
        28 001775   000013 036007                    ADLQ    11,DL
        28 001776   000003 116000 10                 CMPQ    ST_+3
        28 001777   002010 604000 28                 TMI     s:20045

  20044 28 002000   000035 236000 29                 LDQ     29
        28 002001   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002002   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 002003   200253 451500                    STP1    CETT$$+2,,AUTO
        28 002004   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 002005   000034 631400 29                 EPPR1   28
        28 002006   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 002007   000000 011000                    NOP     0

  20045 28 002010   000002 236000 10                 LDQ     ST_+2
        28 002011   000022 736000                    QLS     18
        28 002012   000001 036000 10                 ADLQ    ST_+1
        28 002013   200220 756100                    STQ     ST$$,,AUTO

  20046 28 002014   000013 236007                    LDQ     11,DL
        28 002015   000002 056000 10                 ASQ     ST_+2
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:288  

  20049 28 002016   200017 470500                    LDP0    RECV_ETT$,,AUTO
        28 002017   000001 471500                    LDP1    1,,PR0
        28 002020   200220 473500                    LDP3    ST$$,,AUTO
        28 002021   000100 100500                    MLR     fill='000'O
        28 002022   100000 000054                    ADSC9   0,,PR1                   cn=0,n=44
        28 002023   300000 000054                    ADSC9   0,,PR3                   cn=0,n=44

  20060 28 002024   000002 236000 13                 LDQ     QLT_+2
        28 002025   000006 036007                    ADLQ    6,DL
        28 002026   000003 116000 13                 CMPQ    QLT_+3
        28 002027   002040 602000 28                 TNC     s:20062

  20061 28 002030   000036 236000 29                 LDQ     30
        28 002031   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002032   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 002033   200253 450500                    STP0    CETT$$+2,,AUTO
        28 002034   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 002035   000034 631400 29                 EPPR1   28
        28 002036   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 002037   000000 011000                    NOP     0

  20062 28 002040   000002 236000 13                 LDQ     QLT_+2
        28 002041   000022 736000                    QLS     18
        28 002042   000001 036000 13                 ADLQ    QLT_+1
        28 002043   200224 756100                    STQ     QLT$$,,AUTO

  20063 28 002044   000002 235000 13                 LDA     QLT_+2
        28 002045   000006 035007                    ADLA    6,DL
        28 002046   000002 755000 13                 STA     QLT_+2

  20064 28 002047   001053 220003                    LDX0    555,DU
        28 002050   200224 470500                    LDP0    QLT$$,,AUTO
        28 002051   000000 740100                    STX0    0,,PR0

  20067 28 002052   200003 471500                    LDP1    @LTS$$,,AUTO
        28 002053   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:289  
        28 002054   300034 474500                    LDP4    28,,PR3
        28 002055   400007 236100                    LDQ     7,,PR4
        28 002056   000001 756100                    STQ     1,,PR0

  20068 28 002057   100000 473500                    LDP3    0,,PR1
        28 002060   300034 474500                    LDP4    28,,PR3
        28 002061   400007 475500                    LDP5    7,,PR4
        28 002062   500003 236100                    LDQ     3,,PR5
        28 002063   000002 756100                    STQ     2,,PR0

  20069 28 002064   000017 236000 29                 LDQ     15
        28 002065   000003 756100                    STQ     3,,PR0

  20070 28 002066   200220 236100                    LDQ     ST$$,,AUTO
        28 002067   000004 756100                    STQ     4,,PR0

  20071 28 002070   200220 473500                    LDP3    ST$$,,AUTO
        28 002071   300006 236100                    LDQ     6,,PR3
        28 002072   000005 756100                    STQ     5,,PR0

  20072 28 002073   000002 236007                    LDQ     2,DL
        28 002074   000000 552104                    STBQ    0,'04'O,PR0

  20073 28 002075   000000 236003                    LDQ     0,DU
        28 002076   000000 552110                    STBQ    0,'10'O,PR0

  20074 28 002077   000037 236000 29                 LDQ     31
        28 002100   000000 356100                    ANSQ    0,,PR0

  20075 28 002101   000040 236000 29                 LDQ     32
        28 002102   000000 356100                    ANSQ    0,,PR0

  20076 28 002103   000041 236000 29                 LDQ     33
        28 002104   000000 356100                    ANSQ    0,,PR0

  20077 28 002105   000042 236000 29                 LDQ     34
        28 002106   000000 356100                    ANSQ    0,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:290  

  20080 28 002107   100000 474500                    LDP4    0,,PR1
        28 002110   400034 475500                    LDP5    28,,PR4
        28 002111   500007 476500                    LDP6    7,,PR5
        28 002112   200224 236100                    LDQ     QLT$$,,AUTO
        28 002113   600003 756100                    STQ     3,,PR6

  20081 28 002114   300007 756100                    STQ     7,,PR3

  20082 28 002115   001000 236003                    LDQ     512,DU
        28 002116   300003 256100                    ORSQ    3,,PR3

  20083 28 002117   100000 474500                    LDP4    0,,PR1
        28 002120   400034 475500                    LDP5    28,,PR4
        28 002121   500000 236100                    LDQ     0,,PR5
        28 002122   300000 552104                    STBQ    0,'04'O,PR3

  20084 28 002123   200220 236100                    LDQ     ST$$,,AUTO
        28 002124   200017 474500                    LDP4    RECV_ETT$,,AUTO
        28 002125   400001 756100                    STQ     1,,PR4

  20085 28 002126   002263 710000 28                 TRA     s:20138

  20092 28 002127   000002 236000 10                 LDQ     ST_+2
        28 002130   000013 036007                    ADLQ    11,DL
        28 002131   000003 116000 10                 CMPQ    ST_+3
        28 002132   002143 604000 28                 TMI     s:20094

  20093 28 002133   000035 236000 29                 LDQ     29
        28 002134   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002135   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 002136   200253 451500                    STP1    CETT$$+2,,AUTO
        28 002137   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 002140   000034 631400 29                 EPPR1   28
        28 002141   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 002142   000000 011000                    NOP     0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:291  
  20094 28 002143   000002 236000 10                 LDQ     ST_+2
        28 002144   000022 736000                    QLS     18
        28 002145   000001 036000 10                 ADLQ    ST_+1
        28 002146   200220 756100                    STQ     ST$$,,AUTO

  20095 28 002147   000013 236007                    LDQ     11,DL
        28 002150   000002 056000 10                 ASQ     ST_+2

  20098 28 002151   200017 470500                    LDP0    RECV_ETT$,,AUTO
        28 002152   000001 471500                    LDP1    1,,PR0
        28 002153   100001 473500                    LDP3    1,,PR1
        28 002154   200220 474500                    LDP4    ST$$,,AUTO
        28 002155   000100 100500                    MLR     fill='000'O
        28 002156   300000 000054                    ADSC9   0,,PR3                   cn=0,n=44
        28 002157   400000 000054                    ADSC9   0,,PR4                   cn=0,n=44

  20109 28 002160   000002 236000 13                 LDQ     QLT_+2
        28 002161   000006 036007                    ADLQ    6,DL
        28 002162   000003 116000 13                 CMPQ    QLT_+3
        28 002163   002174 602000 28                 TNC     s:20111

  20110 28 002164   000036 236000 29                 LDQ     30
        28 002165   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002166   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 002167   200253 450500                    STP0    CETT$$+2,,AUTO
        28 002170   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 002171   000034 631400 29                 EPPR1   28
        28 002172   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 002173   000000 011000                    NOP     0

  20111 28 002174   000002 236000 13                 LDQ     QLT_+2
        28 002175   000022 736000                    QLS     18
        28 002176   000001 036000 13                 ADLQ    QLT_+1
        28 002177   200224 756100                    STQ     QLT$$,,AUTO

  20112 28 002200   000002 235000 13                 LDA     QLT_+2
        28 002201   000006 035007                    ADLA    6,DL
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:292  
        28 002202   000002 755000 13                 STA     QLT_+2

  20113 28 002203   001053 220003                    LDX0    555,DU
        28 002204   200224 470500                    LDP0    QLT$$,,AUTO
        28 002205   000000 740100                    STX0    0,,PR0

  20116 28 002206   200003 471500                    LDP1    @LTS$$,,AUTO
        28 002207   100000 473500                    LDP3    0,,PR1
        28 002210   300034 474500                    LDP4    28,,PR3
        28 002211   400007 236100                    LDQ     7,,PR4
        28 002212   000001 756100                    STQ     1,,PR0

  20117 28 002213   100000 473500                    LDP3    0,,PR1
        28 002214   300034 474500                    LDP4    28,,PR3
        28 002215   400007 475500                    LDP5    7,,PR4
        28 002216   500003 236100                    LDQ     3,,PR5
        28 002217   000002 756100                    STQ     2,,PR0

  20118 28 002220   000017 236000 29                 LDQ     15
        28 002221   000003 756100                    STQ     3,,PR0

  20119 28 002222   200220 236100                    LDQ     ST$$,,AUTO
        28 002223   000004 756100                    STQ     4,,PR0

  20120 28 002224   200220 473500                    LDP3    ST$$,,AUTO
        28 002225   300006 236100                    LDQ     6,,PR3
        28 002226   000005 756100                    STQ     5,,PR0

  20121 28 002227   000002 236007                    LDQ     2,DL
        28 002230   000000 552104                    STBQ    0,'04'O,PR0

  20122 28 002231   000000 236003                    LDQ     0,DU
        28 002232   000000 552110                    STBQ    0,'10'O,PR0

  20123 28 002233   000037 236000 29                 LDQ     31
        28 002234   000000 356100                    ANSQ    0,,PR0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:293  
  20124 28 002235   000040 236000 29                 LDQ     32
        28 002236   000000 356100                    ANSQ    0,,PR0

  20125 28 002237   000041 236000 29                 LDQ     33
        28 002240   000000 356100                    ANSQ    0,,PR0

  20126 28 002241   000042 236000 29                 LDQ     34
        28 002242   000000 356100                    ANSQ    0,,PR0

  20129 28 002243   100000 474500                    LDP4    0,,PR1
        28 002244   400034 475500                    LDP5    28,,PR4
        28 002245   500007 476500                    LDP6    7,,PR5
        28 002246   200224 236100                    LDQ     QLT$$,,AUTO
        28 002247   600003 756100                    STQ     3,,PR6

  20130 28 002250   300007 756100                    STQ     7,,PR3

  20131 28 002251   001000 236003                    LDQ     512,DU
        28 002252   300003 256100                    ORSQ    3,,PR3

  20132 28 002253   100000 474500                    LDP4    0,,PR1
        28 002254   400034 475500                    LDP5    28,,PR4
        28 002255   500000 236100                    LDQ     0,,PR5
        28 002256   300000 552104                    STBQ    0,'04'O,PR3

  20133 28 002257   200017 474500                    LDP4    RECV_ETT$,,AUTO
        28 002260   400001 475500                    LDP5    1,,PR4
        28 002261   200220 236100                    LDQ     ST$$,,AUTO
        28 002262   500001 756100                    STQ     1,,PR5

  20138 28 002263   200017 236100                    LDQ     RECV_ETT$,,AUTO
        28 002264   200225 756100                    STQ     RECV_ST$,,AUTO

  20139 28 002265   200225 474500                    LDP4    RECV_ST$,,AUTO
        28 002266   400000 221100                    LDX1    0,,PR4
        28 002267   000751 101003                    CMPX1   489,DU
        28 002270   002300 603000 28                 TRC     s:20146
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:294  

  20140 28 002271   200225 470500                    LDP0    RECV_ST$,,AUTO
        28 002272   000001 236100                    LDQ     1,,PR0
        28 002273   200225 756100                    STQ     RECV_ST$,,AUTO

  20141 28 002274   200225 470500                    LDP0    RECV_ST$,,AUTO
        28 002275   000000 220100                    LDX0    0,,PR0
        28 002276   000751 100003                    CMPX0   489,DU
        28 002277   002271 602000 28                 TNC     s:20140

  20146 28 002300   200012 236100                    LDQ     BUFFER_ETT$,,AUTO
        28 002301   200226 756100                    STQ     BUF_ST$,,AUTO

  20147 28 002302   200226 470500                    LDP0    BUF_ST$,,AUTO
        28 002303   000000 220100                    LDX0    0,,PR0
        28 002304   000751 100003                    CMPX0   489,DU
        28 002305   002315 603000 28                 TRC     s:20152

  20148 28 002306   200226 470500                    LDP0    BUF_ST$,,AUTO
        28 002307   000001 236100                    LDQ     1,,PR0
        28 002310   200226 756100                    STQ     BUF_ST$,,AUTO

  20149 28 002311   200226 470500                    LDP0    BUF_ST$,,AUTO
        28 002312   000000 220100                    LDX0    0,,PR0
        28 002313   000751 100003                    CMPX0   489,DU
        28 002314   002306 602000 28                 TNC     s:20148

  20152 28 002315   200225 471500                    LDP1    RECV_ST$,,AUTO
        28 002316   000000 236100                    LDQ     0,,PR0
        28 002317   100000 552110                    STBQ    0,'10'O,PR1

  20153 28 002320   000000 236100                    LDQ     0,,PR0
        28 002321   100000 552104                    STBQ    0,'04'O,PR1

  20154 28 002322   200212 473500                    LDP3    CURRENT$,,AUTO
        28 002323   300007 236100                    LDQ     7,,PR3
        28 002324   200010 036100                    ADLQ    SA_ADJ,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:295  
        28 002325   000004 506007                    DIV     4,DL
        28 002326   000000 620006                    EAX0    0,QL
        28 002327   100001 740100                    STX0    1,,PR1

  20155 28 002330   300007 236100                    LDQ     7,,PR3
        28 002331   200010 036100                    ADLQ    SA_ADJ,,AUTO
        28 002332   000004 506007                    DIV     4,DL
        28 002333   000044 733000                    LRS     36
        28 002334   000020 736000                    QLS     16
        28 002335   100001 676100                    ERQ     1,,PR1
        28 002336   600000 376007                    ANQ     -65536,DL
        28 002337   100001 656100                    ERSQ    1,,PR1

  20156 28 002340   300007 236100                    LDQ     7,,PR3
        28 002341   300010 036100                    ADLQ    8,,PR3
        28 002342   200010 036100                    ADLQ    SA_ADJ,,AUTO
        28 002343   200023 756100                    STQ     RECORD_LEN,,AUTO

  20158 28 002344   100002 236100                    LDQ     2,,PR1
        28 002345   777777 376007                    ANQ     -1,DL
        28 002346   200217 756100                    STQ     LINE_NO#,,AUTO

  20164 28 002347   200016 236100                    LDQ     SEND_ETT$,,AUTO
        28 002350   200220 756100                    STQ     ST$$,,AUTO

  20165 28 002351   200220 474500                    LDP4    ST$$,,AUTO
        28 002352   400000 220100                    LDX0    0,,PR4
        28 002353   000751 100003                    CMPX0   489,DU
        28 002354   002364 603000 28                 TRC     s:20170

  20166 28 002355   200220 470500                    LDP0    ST$$,,AUTO
        28 002356   000001 236100                    LDQ     1,,PR0
        28 002357   200220 756100                    STQ     ST$$,,AUTO

  20167 28 002360   200220 470500                    LDP0    ST$$,,AUTO
        28 002361   000000 220100                    LDX0    0,,PR0
        28 002362   000751 100003                    CMPX0   489,DU
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:296  
        28 002363   002355 602000 28                 TNC     s:20166

  20170 28 002364   200220 470500                    LDP0    ST$$,,AUTO
        28 002365   000002 236100                    LDQ     2,,PR0
        28 002366   000022 772000                    QRL     18
        28 002367   200221 756100                    STQ     ST_TYPE,,AUTO

  20180 28 002370   000004 220003                    LDX0    4,DU
        28 002371   200074 740100                    STX0    SEND_FIELD,,AUTO

  20181 28 002372   000000 221003                    LDX1    0,DU
        28 002373   200074 441100                    SXL1    SEND_FIELD,,AUTO

  20182 28 002374   200100 756100                    STQ     SEND_FIELD+4,,AUTO

  20183 28 002375   000017 236000 29                 LDQ     15
        28 002376   200103 756100                    STQ     SEND_FIELD+7,,AUTO

  20184 28 002377   200016 236100                    LDQ     SEND_ETT$,,AUTO
        28 002400   200075 756100                    STQ     SEND_FIELD+1,,AUTO

  20185 28 002401   000017 236000 29                 LDQ     15
        28 002402   200076 756100                    STQ     SEND_FIELD+2,,AUTO

  20187 28 002403   200217 235100                    LDA     LINE_NO#,,AUTO
        28 002404   200101 755100                    STA     SEND_FIELD+5,,AUTO

  20188 28 002405   200102 450100                    STZ     SEND_FIELD+6,,AUTO

  20193 28 002406   200031 236100                    LDQ     ALL_BIT,,AUTO
        28 002407   000025 772000                    QRL     21
        28 002410   200074 676100                    ERQ     SEND_FIELD,,AUTO
        28 002411   040000 376007                    ANQ     16384,DL
        28 002412   200074 656100                    ERSQ    SEND_FIELD,,AUTO

  20205 28 002413   200017 236100                    LDQ     RECV_ETT$,,AUTO
        28 002414   200220 756100                    STQ     ST$$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:297  

  20206 28 002415   200220 470500                    LDP0    ST$$,,AUTO
        28 002416   000000 222100                    LDX2    0,,PR0
        28 002417   000751 102003                    CMPX2   489,DU
        28 002420   002430 603000 28                 TRC     s:20211

  20207 28 002421   200220 470500                    LDP0    ST$$,,AUTO
        28 002422   000001 236100                    LDQ     1,,PR0
        28 002423   200220 756100                    STQ     ST$$,,AUTO

  20208 28 002424   200220 470500                    LDP0    ST$$,,AUTO
        28 002425   000000 220100                    LDX0    0,,PR0
        28 002426   000751 100003                    CMPX0   489,DU
        28 002427   002421 602000 28                 TNC     s:20207

  20211 28 002430   000002 236100                    LDQ     2,,PR0
        28 002431   000022 772000                    QRL     18
        28 002432   200221 756100                    STQ     ST_TYPE,,AUTO

  20220 28 002433   000004 220003                    LDX0    4,DU
        28 002434   200104 740100                    STX0    RECV_FIELD,,AUTO

  20221 28 002435   000000 221003                    LDX1    0,DU
        28 002436   200104 441100                    SXL1    RECV_FIELD,,AUTO

  20222 28 002437   200110 756100                    STQ     RECV_FIELD+4,,AUTO

  20223 28 002440   000017 236000 29                 LDQ     15
        28 002441   200113 756100                    STQ     RECV_FIELD+7,,AUTO

  20224 28 002442   200017 236100                    LDQ     RECV_ETT$,,AUTO
        28 002443   200105 756100                    STQ     RECV_FIELD+1,,AUTO

  20225 28 002444   000017 236000 29                 LDQ     15
        28 002445   200106 756100                    STQ     RECV_FIELD+2,,AUTO

  20227 28 002446   200217 235100                    LDA     LINE_NO#,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:298  
        28 002447   200111 755100                    STA     RECV_FIELD+5,,AUTO

  20228 28 002450   200112 450100                    STZ     RECV_FIELD+6,,AUTO

  20240 28 002451   200212 471500                    LDP1    CURRENT$,,AUTO
        28 002452   100000 236100                    LDQ     0,,PR1
        28 002453   020000 316007                    CANQ    8192,DL
        28 002454   002553 600000 28                 TZE     s:20650

  20242 28 002455   200021 633500                    EPPR3   IND$$,,AUTO
        28 002456   200253 453500                    STP3    CETT$$+2,,AUTO
        28 002457   000002 236000 29                 LDQ     2
        28 002460   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002461   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 002462   000000 631400 29                 EPPR1   0
        28 002463   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 002464   000000 011000                    NOP     0

  20248 28 002465   000005 220003                    LDX0    5,DU
        28 002466   200144 740100                    STX0    COMPARE,,AUTO

  20249 28 002467   000000 221003                    LDX1    0,DU
        28 002470   200144 441100                    SXL1    COMPARE,,AUTO

  20256 28 002471   000133 235000 xsym               LDA     COMCOM+91
        28 002472   200151 755100                    STA     COMPARE+5,,AUTO

  20257 28 002473   000134 236000 xsym               LDQ     COMCOM+92
        28 002474   200152 756100                    STQ     COMPARE+6,,AUTO

  20258 28 002475   200134 630500                    EPPR0   ZERO,,AUTO
        28 002476   200146 450500                    STP0    COMPARE+2,,AUTO

  20259 28 002477   200154 631500                    EPPR1   IND_FIELD,,AUTO
        28 002500   200145 451500                    STP1    COMPARE+1,,AUTO

  20260 28 002501   000027 235007                    LDA     23,DL
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:299  
        28 002502   200147 755100                    STA     COMPARE+3,,AUTO

  20261 28 002503   000017 236000 29                 LDQ     15
        28 002504   200153 756100                    STQ     COMPARE+7,,AUTO

  20264 28 002505   200144 633500                    EPPR3   COMPARE,,AUTO
        28 002506   200252 453500                    STP3    CETT$$+1,,AUTO
        28 002507   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 002510   200255 454500                    STP4    CETT$$+4,,AUTO
        28 002511   200021 635500                    EPPR5   IND$$,,AUTO
        28 002512   200254 455500                    STP5    CETT$$+3,,AUTO
        28 002513   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 002514   000000 631400 29                 EPPR1   0
        28 002515   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        28 002516   000000 011000                    NOP     0

  20266 28 002517   200104 630500                    EPPR0   RECV_FIELD,,AUTO
        28 002520   200252 450500                    STP0    CETT$$+1,,AUTO
        28 002521   200074 631500                    EPPR1   SEND_FIELD,,AUTO
        28 002522   200253 451500                    STP1    CETT$$+2,,AUTO
        28 002523   200253 633500                    EPPR3   CETT$$+2,,AUTO
        28 002524   200255 453500                    STP3    CETT$$+4,,AUTO
        28 002525   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 002526   200254 454500                    STP4    CETT$$+3,,AUTO
        28 002527   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 002530   000000 631400 29                 EPPR1   0
        28 002531   000000 701000 xent               TSX1    Z8E7$MOVE
        28 002532   000000 011000                    NOP     0

  20601 28 002533   000006 236000 29                 LDQ     6
        28 002534   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002535   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 002536   200257 450500                    STP0    CETT$$+6,,AUTO
        28 002537   000007 236000 29                 LDQ     7
        28 002540   200256 756100                    STQ     CETT$$+5,,AUTO
        28 002541   000010 237000 29                 LDAQ    8
        28 002542   200254 757100                    STAQ    CETT$$+3,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:300  
        28 002543   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 002544   000003 631400 29                 EPPR1   3
        28 002545   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 002546   000000 011000                    NOP     0

  20602 28 002547   200021 236100                    LDQ     IND$$,,AUTO
        28 002550   000000 470400 18                 LDP0    ILL$
        28 002551   000001 756100                    STQ     1,,PR0

  20648 28 002552   002567 710000 28                 TRA     s:20653

  20650 28 002553   200104 633500                    EPPR3   RECV_FIELD,,AUTO
        28 002554   200252 453500                    STP3    CETT$$+1,,AUTO
        28 002555   200074 634500                    EPPR4   SEND_FIELD,,AUTO
        28 002556   200253 454500                    STP4    CETT$$+2,,AUTO
        28 002557   200253 635500                    EPPR5   CETT$$+2,,AUTO
        28 002560   200255 455500                    STP5    CETT$$+4,,AUTO
        28 002561   200252 636500                    EPPR6   CETT$$+1,,AUTO
        28 002562   200254 456500                    STP6    CETT$$+3,,AUTO
        28 002563   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 002564   000000 631400 29                 EPPR1   0
        28 002565   000000 701000 xent               TSX1    Z8E7$MOVE
        28 002566   000000 011000                    NOP     0

  20653 28 002567   200212 470500                    LDP0    CURRENT$,,AUTO
        28 002570   000006 236100                    LDQ     6,,PR0
        28 002571   200212 756100                    STQ     CURRENT$,,AUTO

  20654 28 002572   200213 470500                    LDP0    NEXT$,,AUTO
        28 002573   000006 116100                    CMPQ    6,,PR0
        28 002574   001676 601000 28                 TNZ     s:20004

     1682    20657
     1683    20658    3            IF RECORD_LEN < MIN_REC_LEN THEN

  20658 28 002575   200023 236100                    LDQ     RECORD_LEN,,AUTO
        28 002576   200024 116100                    CMPQ    MIN_REC_LEN,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:301  
        28 002577   002602 605000 28                 TPL     s:20661

     1684    20659    3              RECORD_LEN = MIN_REC_LEN;

  20659 28 002600   200024 235100                    LDA     MIN_REC_LEN,,AUTO
        28 002601   200023 755100                    STA     RECORD_LEN,,AUTO

     1685    20660
     1686    20661    3            CALL Z8AC$LX_ETT_ITEM_TYI_CONST (RECORD_LEN,

  20661 28 002602   200114 631500                    EPPR1   RECORD_LENGTH,,AUTO
        28 002603   200252 451500                    STP1    CETT$$+1,,AUTO
        28 002604   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 002605   200255 453500                    STP3    CETT$$+4,,AUTO
        28 002606   200023 634500                    EPPR4   RECORD_LEN,,AUTO
        28 002607   200254 454500                    STP4    CETT$$+3,,AUTO
        28 002610   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 002611   000000 631400 29                 EPPR1   0
        28 002612   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        28 002613   000000 011000                    NOP     0

     1687    20662    3                                             ADDR(RECORD_LENGTH));
     1688    20663
     1689    20664    3            CALL Z9EN$WRITE_NEXT (FILE_LTS$,

  20664 28 002614   000017 236000 29                 LDQ     15
        28 002615   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002616   200253 756100                    STQ     CETT$$+2,,AUTO
        28 002617   200114 630500                    EPPR0   RECORD_LENGTH,,AUTO
        28 002620   200254 450500                    STP0    CETT$$+3,,AUTO
        28 002621   200124 631500                    EPPR1   LINE_FIELD,,AUTO
        28 002622   200255 451500                    STP1    CETT$$+4,,AUTO
        28 002623   200004 633500                    EPPR3   REPORT_CODE_NO,,AUTO
        28 002624   200264 453500                    STP3    CETT$$+11,,AUTO
        28 002625   000045 236000 29                 LDQ     37
        28 002626   200263 756100                    STQ     CETT$$+10,,AUTO
        28 002627   200255 634500                    EPPR4   CETT$$+4,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:302  
        28 002630   200262 454500                    STP4    CETT$$+9,,AUTO
        28 002631   200254 635500                    EPPR5   CETT$$+3,,AUTO
        28 002632   200261 455500                    STP5    CETT$$+8,,AUTO
        28 002633   200253 636500                    EPPR6   CETT$$+2,,AUTO
        28 002634   200260 456500                    STP6    CETT$$+7,,AUTO
        28 002635   200252 637500                    EPPR7   CETT$$+1,,AUTO
        28 002636   200257 457500                    STP7    CETT$$+6,,AUTO
        28 002637   200027 630500                    EPPR0   FILE_LTS$,,AUTO
        28 002640   200256 450500                    STP0    CETT$$+5,,AUTO
        28 002641   200256 630500                    EPPR0   CETT$$+5,,AUTO
        28 002642   000043 631400 29                 EPPR1   35
        28 002643   000000 701000 xent               TSX1    Z9EN$WRITE_NEXT
        28 002644   000000 011000                    NOP     0

     1690    20665    3                                  ADDR(NIL),
     1691    20666    3                                  ADDR(NIL),
     1692    20667    3                                  ADDR(RECORD_LENGTH),
     1693    20668    3                                  ADDR(LINE_FIELD),
     1694    20669    3                                  %AFTER_LINES,
     1695    20670    3                                  REPORT_CODE_NO);
     1696    20671
     1697    20672
     1698    20673    3            NEXT$ = NEXT$ -> REPORT_GRP_LTS.NEXT;

  20673 28 002645   200213 470500                    LDP0    NEXT$,,AUTO
        28 002646   000006 236100                    LDQ     6,,PR0
        28 002647   200213 756100                    STQ     NEXT$,,AUTO

     1699    20674
     1700    20675    3          END; /* OUTER WHILE */

  20675 28 002650   000017 116000 29                 CMPQ    15
        28 002651   001516 601000 28                 TNZ     s:19538

     1701    20676
     1702    20677               %DB_EXCEPT_LIBRARY_RETURN;

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:303  
  20887 28 002652   000006 236000 29                 LDQ     6
        28 002653   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002654   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 002655   200257 450500                    STP0    CETT$$+6,,AUTO
        28 002656   000007 236000 29                 LDQ     7
        28 002657   200256 756100                    STQ     CETT$$+5,,AUTO
        28 002660   000032 237000 29                 LDAQ    26
        28 002661   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 002662   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 002663   000003 631400 29                 EPPR1   3
        28 002664   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 002665   000000 011000                    NOP     0

  20888 28 002666   000001 220003                    LDX0    1,DU
        28 002667   000000 470400 18                 LDP0    ILL$
        28 002670   000000 440100                    SXL0    0,,PR0

  20892 28 002671   000057 470400 xsym               LDP0    O1COM+47
        28 002672   000006 236100                    LDQ     6,,PR0
        28 002673   000000 471400 18                 LDP1    ILL$
        28 002674   100001 756100                    STQ     1,,PR1

     1703    21061
     1704    21062    2    END CREATE_FORMATTING_SUB;

  21062 28 002675   200210 221300                    LDX1  ! SEND$,,AUTO
        28 002676   000001 702211                    TSX2  ! 1,X1

     1705    21063         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:304  
     1706    21064         /*================*/
     1707    21065    1      BUILD_FORMAT_SUB: PROC;

  21065 28 002677   200206 741300       BUILD_FORMA* STX1  ! CTR_LVL_ETT$+2,,AUTO

     1708    21066         /*================*/
     1709    21067
     1710    21068        /*I*
     1711    21069
     1712    21070             NAME:  BUILD_FORMAT_SUB
     1713    21071
     1714    21072          DESCRIPTION: This routine steps through the report LTS item and
     1715    21073                       calls CREATE_FORMATTING_SUB to create the subroutines
     1716    21074                       that will print--- report heading, report footing,
     1717    21075                       detail, page heading, page footing, control heading
     1718    21076                       and control footing groups.
     1719    21077        */
     1720    21078
     1721    21079
     1722    21080    2          IF LTS$$ -> REPORT_LTS.REPORT_HEADING$ ~= ADDR(NIL) THEN

  21080 28 002700   200003 470500                    LDP0    @LTS$$,,AUTO
        28 002701   000000 471500                    LDP1    0,,PR0
        28 002702   100023 236100                    LDQ     19,,PR1
        28 002703   000017 116000 29                 CMPQ    15
        28 002704   002711 600000 28                 TZE     s:21083

     1723    21081    2              CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.REPORT_HEADING$);

  21081 28 002705   100023 633500                    EPPR3   19,,PR1
        28 002706   200211 453500                    STP3    @GROUP$,,AUTO
        28 002707   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 002710   000000 011000                    NOP     0

     1724    21082
     1725    21083    2          IF LTS$$ -> REPORT_LTS.REPORT_FOOTING$ ~= ADDR(NIL) THEN

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:305  
  21083 28 002711   200003 470500                    LDP0    @LTS$$,,AUTO
        28 002712   000000 471500                    LDP1    0,,PR0
        28 002713   100033 236100                    LDQ     27,,PR1
        28 002714   000017 116000 29                 CMPQ    15
        28 002715   002722 600000 28                 TZE     s:21086

     1726    21084    2              CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.REPORT_FOOTING$);

  21084 28 002716   100033 633500                    EPPR3   27,,PR1
        28 002717   200211 453500                    STP3    @GROUP$,,AUTO
        28 002720   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 002721   000000 011000                    NOP     0

     1727    21085
     1728    21086    2          IF LTS$$ -> REPORT_LTS.PAGE_HEADING$ ~= ADDR(NIL) THEN

  21086 28 002722   200003 470500                    LDP0    @LTS$$,,AUTO
        28 002723   000000 471500                    LDP1    0,,PR0
        28 002724   100024 236100                    LDQ     20,,PR1
        28 002725   000017 116000 29                 CMPQ    15
        28 002726   002733 600000 28                 TZE     s:21089

     1729    21087    2              CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.PAGE_HEADING$);

  21087 28 002727   100024 633500                    EPPR3   20,,PR1
        28 002730   200211 453500                    STP3    @GROUP$,,AUTO
        28 002731   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 002732   000000 011000                    NOP     0

     1730    21088
     1731    21089    2          IF LTS$$ -> REPORT_LTS.PAGE_FOOTING$ ~= ADDR(NIL) THEN

  21089 28 002733   200003 470500                    LDP0    @LTS$$,,AUTO
        28 002734   000000 471500                    LDP1    0,,PR0
        28 002735   100032 236100                    LDQ     26,,PR1
        28 002736   000017 116000 29                 CMPQ    15
        28 002737   002744 600000 28                 TZE     s:21092
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:306  

     1732    21090    2              CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.PAGE_FOOTING$);

  21090 28 002740   100032 633500                    EPPR3   26,,PR1
        28 002741   200211 453500                    STP3    @GROUP$,,AUTO
        28 002742   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 002743   000000 011000                    NOP     0

     1733    21091
     1734    21092    2          DETAIL_GRP$ = LTS$$ -> REPORT_LTS.DETAIL$;

  21092 28 002744   200003 470500                    LDP0    @LTS$$,,AUTO
        28 002745   000000 471500                    LDP1    0,,PR0
        28 002746   100027 236100                    LDQ     23,,PR1
        28 002747   200052 756100                    STQ     DETAIL_GRP$,,AUTO

     1735    21093
     1736    21094    3          DO WHILE (DETAIL_GRP$ ~= ADDR(NIL));

  21094 28 002750   003021 710000 28                 TRA     s:21133

     1737    21095
     1738    21096    3            IF DETAIL_GRP$ -> REPORT_01_LTS.B.GROUP_INDICATE THEN

  21096 28 002751   200052 470500                    LDP0    DETAIL_GRP$,,AUTO
        28 002752   000000 236100                    LDQ     0,,PR0
        28 002753   020000 316007                    CANQ    8192,DL
        28 002754   003012 600000 28                 TZE     s:21129

     1739    21097    4              DO;

     1740    21098    4                CALL Z8AF$NEW_BASE (DETAIL_GRP$ -> REPORT_01_LTS.GROUP_INDICATOR$,

  21098 28 002755   000017 236000 29                 LDQ     15
        28 002756   200252 756100                    STQ     CETT$$+1,,AUTO
        28 002757   200022 631500                    EPPR1   IND_ETT$,,AUTO
        28 002760   200255 451500                    STP1    CETT$$+4,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:307  
        28 002761   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 002762   200254 453500                    STP3    CETT$$+3,,AUTO
        28 002763   200052 236100                    LDQ     DETAIL_GRP$,,AUTO
        28 002764   000023 036003                    ADLQ    19,DU
        28 002765   200253 756100                    STQ     CETT$$+2,,AUTO
        28 002766   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 002767   000030 631400 29                 EPPR1   24
        28 002770   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 002771   000000 011000                    NOP     0

     1741    21099    4                                    ADDR(NIL),
     1742    21100    4                                    IND_ETT$);
     1743    21101
     1744    21102                     %INIT_LX_ETT_ITEM (@POINTER = "ADDR(IND_FIELD)",
     1745    21103                                        @TYPE    = %TYI,
     1746    21104                                        @ETT$    = IND_ETT$);

  21106 28 002772   000004 220003                    LDX0    4,DU
        28 002773   200154 740100                    STX0    IND_FIELD,,AUTO

  21107 28 002774   000000 221003                    LDX1    0,DU
        28 002775   200154 441100                    SXL1    IND_FIELD,,AUTO

  21108 28 002776   000001 235007                    LDA     1,DL
        28 002777   200160 755100                    STA     IND_FIELD+4,,AUTO

  21109 28 003000   000017 236000 29                 LDQ     15
        28 003001   200163 756100                    STQ     IND_FIELD+7,,AUTO

  21110 28 003002   200022 236100                    LDQ     IND_ETT$,,AUTO
        28 003003   200155 756100                    STQ     IND_FIELD+1,,AUTO

  21111 28 003004   000017 236000 29                 LDQ     15
        28 003005   200156 756100                    STQ     IND_FIELD+2,,AUTO

  21113 28 003006   000133 235000 xsym               LDA     COMCOM+91
        28 003007   200161 755100                    STA     IND_FIELD+5,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:308  

  21114 28 003010   000134 235000 xsym               LDA     COMCOM+92
        28 003011   200162 755100                    STA     IND_FIELD+6,,AUTO

     1747    21126
     1748    21127    4              END;

     1749    21128
     1750    21129    3            CALL CREATE_FORMATTING_SUB (DETAIL_GRP$);

  21129 28 003012   200052 630500                    EPPR0   DETAIL_GRP$,,AUTO
        28 003013   200211 450500                    STP0    @GROUP$,,AUTO
        28 003014   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 003015   000000 011000                    NOP     0

     1751    21130
     1752    21131    3            DETAIL_GRP$ = DETAIL_GRP$ -> REPORT_01_LTS.LINK;

  21131 28 003016   200052 470500                    LDP0    DETAIL_GRP$,,AUTO
        28 003017   000007 236100                    LDQ     7,,PR0
        28 003020   200052 756100                    STQ     DETAIL_GRP$,,AUTO

     1753    21132
     1754    21133    3          END; /* WHILE */

  21133 28 003021   000017 116000 29                 CMPQ    15
        28 003022   002751 601000 28                 TNZ     s:21096

     1755    21134
     1756    21135    2          IF LTS$$ -> REPORT_LTS.B.CONTROL_FINAL THEN

  21135 28 003023   200003 470500                    LDP0    @LTS$$,,AUTO
        28 003024   000000 471500                    LDP1    0,,PR0
        28 003025   100003 236100                    LDQ     3,,PR1
        28 003026   200000 316003                    CANQ    65536,DU
        28 003027   003052 600000 28                 TZE     s:21149

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:309  
     1757    21136    3            DO;

     1758    21137    3              IF LTS$$ -> REPORT_LTS.CONTROL_FINAL$ -> CONTROL_NAME_LTS.
             21137                       CONTROL_HEADING$

  21137 28 003030   100006 473500                    LDP3    6,,PR1
        28 003031   300002 236100                    LDQ     2,,PR3
        28 003032   000017 116000 29                 CMPQ    15
        28 003033   003040 600000 28                 TZE     s:21142

     1759    21138    3                          ~= ADDR(NIL) THEN
     1760    21139    3                CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.CONTROL_FINAL$ ->

  21139 28 003034   300002 634500                    EPPR4   2,,PR3
        28 003035   200211 454500                    STP4    @GROUP$,,AUTO
        28 003036   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 003037   000000 011000                    NOP     0

     1761    21140    3                          CONTROL_NAME_LTS.CONTROL_HEADING$);
     1762    21141
     1763    21142    3              IF LTS$$ -> REPORT_LTS.CONTROL_FINAL$ -> CONTROL_NAME_LTS.
             21142                       CONTROL_FOOTING$

  21142 28 003040   200003 470500                    LDP0    @LTS$$,,AUTO
        28 003041   000000 471500                    LDP1    0,,PR0
        28 003042   100006 473500                    LDP3    6,,PR1
        28 003043   300003 236100                    LDQ     3,,PR3
        28 003044   000017 116000 29                 CMPQ    15
        28 003045   003052 600000 28                 TZE     s:21149

     1764    21143    3                          ~= ADDR(NIL) THEN
     1765    21144    3                CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.CONTROL_FINAL$ ->

  21144 28 003046   300003 634500                    EPPR4   3,,PR3
        28 003047   200211 454500                    STP4    @GROUP$,,AUTO
        28 003050   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 003051   000000 011000                    NOP     0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:310  

     1766    21145    3                          CONTROL_NAME_LTS.CONTROL_FOOTING$);
     1767    21146
     1768    21147    3            END;

     1769    21148
     1770    21149    2          IF LTS$$ -> REPORT_LTS.CONTROL$ ~= ADDR(NIL) THEN

  21149 28 003052   200003 470500                    LDP0    @LTS$$,,AUTO
        28 003053   000000 471500                    LDP1    0,,PR0
        28 003054   100005 236100                    LDQ     5,,PR1
        28 003055   000017 116000 29                 CMPQ    15
        28 003056   003123 600000 28                 TZE     s:21164

     1771    21150    3            DO;

     1772    21151    4              DO I = 1 TO LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.N - 3;

  21151 28 003057   000001 235007                    LDA     1,DL
        28 003060   200007 755100                    STA     I,,AUTO
        28 003061   003113 710000 28                 TRA     s:21161+1

     1773    21152    4                IF LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.P$(I) ->

  21152 28 003062   200003 470500                    LDP0    @LTS$$,,AUTO
        28 003063   000000 471500                    LDP1    0,,PR0
        28 003064   100005 473500                    LDP3    5,,PR1
        28 003065   200007 720100                    LXL0    I,,AUTO
        28 003066   300002 474510                    LDP4    2,X0,PR3
        28 003067   400002 236100                    LDQ     2,,PR4
        28 003070   000017 116000 29                 CMPQ    15
        28 003071   003076 600000 28                 TZE     s:21156

     1774    21153    4                          CONTROL_NAME_LTS.CONTROL_HEADING$ ~= ADDR(NIL) THEN
     1775    21154    4                  CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.CONTROL$ ->

  21154 28 003072   400002 635500                    EPPR5   2,,PR4
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:311  
        28 003073   200211 455500                    STP5    @GROUP$,,AUTO
        28 003074   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 003075   000000 011000                    NOP     0

     1776    21155    4                          LTS_PTR_ARRAY.P$ (I) -> CONTROL_NAME_LTS.CONTROL_HEADING$);
     1777    21156    4                IF LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.P$(I) ->

  21156 28 003076   200003 470500                    LDP0    @LTS$$,,AUTO
        28 003077   000000 471500                    LDP1    0,,PR0
        28 003100   100005 473500                    LDP3    5,,PR1
        28 003101   200007 720100                    LXL0    I,,AUTO
        28 003102   300002 474510                    LDP4    2,X0,PR3
        28 003103   400003 236100                    LDQ     3,,PR4
        28 003104   000017 116000 29                 CMPQ    15
        28 003105   003112 600000 28                 TZE     s:21161

     1778    21157    4                          CONTROL_NAME_LTS.CONTROL_FOOTING$ ~= ADDR(NIL) THEN
     1779    21158    4                  CALL CREATE_FORMATTING_SUB (LTS$$ -> REPORT_LTS.CONTROL$ ->

  21158 28 003106   400003 635500                    EPPR5   3,,PR4
        28 003107   200211 455500                    STP5    @GROUP$,,AUTO
        28 003110   000353 701000 28                 TSX1    CREATE_FORMATTING_SUB
        28 003111   000000 011000                    NOP     0

     1780    21159    4                          LTS_PTR_ARRAY.P$ (I) -> CONTROL_NAME_LTS.CONTROL_FOOTING$);
     1781    21160
     1782    21161    4              END;

  21161 28 003112   200007 054100                    AOS     I,,AUTO
        28 003113   200003 470500                    LDP0    @LTS$$,,AUTO
        28 003114   000000 471500                    LDP1    0,,PR0
        28 003115   100005 473500                    LDP3    5,,PR1
        28 003116   300000 236100                    LDQ     0,,PR3
        28 003117   777777 376007                    ANQ     -1,DL
        28 003120   000003 136007                    SBLQ    3,DL
        28 003121   200007 116100                    CMPQ    I,,AUTO
        28 003122   003062 605000 28                 TPL     s:21152
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:312  

     1783    21162    3            END;

     1784    21163
     1785    21164    2          LTS$$ -> REPORT_LTS.BUFFER_ST$ -> SCALAR.B.ELEMENTARY = FALSE;

  21164 28 003123   100034 473500                    LDP3    28,,PR1
        28 003124   000046 236000 29                 LDQ     38
        28 003125   300003 356100                    ANSQ    3,,PR3

     1786    21165
     1787    21166    2    END BUILD_FORMAT_SUB;

  21166 28 003126   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 003127   000001 702211                    TSX2  ! 1,X1

     1788    21167         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:313  
     1789    21168
     1790    21169         /*============*/
     1791    21170    1      STORE_EDITED:  PROC (CONTROL$$);

  21170 28 003130   200206 741300       STORE_EDITED STX1  ! CTR_LVL_ETT$+2,,AUTO

     1792    21171         /*============*/
     1793    21172
     1794    21173        /*I*
     1795    21174
     1796    21175             NAME:  STORE_EDITED
     1797    21176
     1798    21177          DESCRIPTION: When a control item's data type is numeric edited
     1799    21178                       or alphanumeric edited, they need special processes,
     1800    21179                       i.e. save there data type and pretend that they are
     1801    21180                       type alphanumeric during the swapping process.
     1802    21181         */
     1803    21182
     1804    21183    2    DCL CONTROL$$         PTR;
     1805    21184    2    DCL NAME$             PTR;
     1806    21185    2    DCL ST$$              PTR;
     1807    21186
     1808    21187
     1809    21188    3      DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;

  21188 28 003131   000001 235007                    LDA     1,DL
        28 003132   200007 755100                    STA     I,,AUTO
        28 003133   003171 710000 28                 TRA     s:21203+1

     1810    21189
     1811    21190    3        NAME$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);

  21190 28 003134   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003135   000000 471500                    LDP1    0,,PR0
        28 003136   200007 720100                    LXL0    I,,AUTO
        28 003137   100002 236110                    LDQ     2,X0,PR1
        28 003140   200210 756100                    STQ     NAME$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:314  

     1812    21191    3        ST$$ = NAME$ -> CONTROL_NAME_LTS.ST$;

  21191 28 003141   200210 473500                    LDP3    NAME$,,AUTO
        28 003142   300001 236100                    LDQ     1,,PR3
        28 003143   200211 756100                    STQ     ST$$,,AUTO

     1813    21192
     1814    21193    3        IF ST$$ -> SCALAR.B.CLASS = %CLASS_NUMERIC_EDITED OR

  21193 28 003144   200211 474500                    LDP4    ST$$,,AUTO
        28 003145   400003 236100                    LDQ     3,,PR4
        28 003146   000007 376007                    ANQ     7,DL
        28 003147   000005 116007                    CMPQ    5,DL
        28 003150   003153 600000 28                 TZE     s:21196
        28 003151   000007 116007                    CMPQ    7,DL
        28 003152   003166 601000 28                 TNZ     s:21201

     1815    21194    3           ST$$ -> SCALAR.B.CLASS = %CLASS_ALPHANUMERIC_EDITED THEN
     1816    21195    4          DO;

     1817    21196    4            NAME$ -> CONTROL_NAME_LTS.B.CLASS_EDITED = TRUE;

  21196 28 003153   400000 236007                    LDQ     -131072,DL
        28 003154   300000 256100                    ORSQ    0,,PR3

     1818    21197    4            NAME$ -> CONTROL_NAME_LTS.B.CLASS = ST$$ -> SCALAR.B.CLASS;

  21197 28 003155   400003 236100                    LDQ     3,,PR4
        28 003156   300000 676100                    ERQ     0,,PR3
        28 003157   000007 376007                    ANQ     7,DL
        28 003160   300000 656100                    ERSQ    0,,PR3

     1819    21198    4            ST$$ -> SCALAR.B.CLASS = %CLASS_ALPHANUMERIC;

  21198 28 003161   400003 236100                    LDQ     3,,PR4
        28 003162   000047 376000 29                 ANQ     39
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:315  
        28 003163   000003 276007                    ORQ     3,DL
        28 003164   400003 756100                    STQ     3,,PR4

     1820    21199    4          END;

  21199 28 003165   003170 710000 28                 TRA     s:21203

     1821    21200    3        ELSE
     1822    21201    3          NAME$ -> CONTROL_NAME_LTS.B.CLASS_EDITED = FALSE;

  21201 28 003166   000037 236000 29                 LDQ     31
        28 003167   300000 356100                    ANSQ    0,,PR3

     1823    21202
     1824    21203    3      END;

  21203 28 003170   200007 054100                    AOS     I,,AUTO
        28 003171   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003172   000000 471500                    LDP1    0,,PR0
        28 003173   100000 236100                    LDQ     0,,PR1
        28 003174   777777 376007                    ANQ     -1,DL
        28 003175   000003 136007                    SBLQ    3,DL
        28 003176   200007 116100                    CMPQ    I,,AUTO
        28 003177   003134 605000 28                 TPL     s:21190

     1825    21204
     1826    21205    2    END STORE_EDITED;

  21205 28 003200   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 003201   000001 702211                    TSX2  ! 1,X1

     1827    21206         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:316  
     1828    21207
     1829    21208         /*==============*/
     1830    21209    1      RESTORE_EDITED: PROC (CONTROL$$);

  21209 28 003202   200206 741300       RESTORE_EDI* STX1  ! CTR_LVL_ETT$+2,,AUTO

     1831    21210         /*==============*/
     1832    21211
     1833    21212        /*I*
     1834    21213
     1835    21214             NAME:  RESTORE_EDITED
     1836    21215
     1837    21216          DESCRIPTION: This routine restore the original data type of the
     1838    21217                       edited type control items after the swapping process.
     1839    21218         */
     1840    21219
     1841    21220
     1842    21221    2    DCL CONTROL$$         PTR;
     1843    21222    2    DCL ST$$              PTR;
     1844    21223    2    DCL NAME$             PTR;
     1845    21224
     1846    21225
     1847    21226    3      DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;

  21226 28 003203   000001 235007                    LDA     1,DL
        28 003204   200007 755100                    STA     I,,AUTO
        28 003205   003224 710000 28                 TRA     s:21234+1

     1848    21227
     1849    21228    3        NAME$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);

  21228 28 003206   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003207   000000 471500                    LDP1    0,,PR0
        28 003210   200007 720100                    LXL0    I,,AUTO
        28 003211   100002 236110                    LDQ     2,X0,PR1
        28 003212   200211 756100                    STQ     NAME$,,AUTO

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:317  
     1850    21229
     1851    21230    3        IF NAME$ -> CONTROL_NAME_LTS.B.CLASS_EDITED THEN

  21230 28 003213   200211 473500                    LDP3    NAME$,,AUTO
        28 003214   300000 236100                    LDQ     0,,PR3
        28 003215   400000 316007                    CANQ    -131072,DL
        28 003216   003223 600000 28                 TZE     s:21234

     1852    21231    3           NAME$ -> CONTROL_NAME_LTS.ST$ -> SCALAR.B.CLASS =

  21231 28 003217   300001 474500                    LDP4    1,,PR3
        28 003220   400003 676100                    ERQ     3,,PR4
        28 003221   000007 376007                    ANQ     7,DL
        28 003222   400003 656100                    ERSQ    3,,PR4

     1853    21232    3             NAME$ -> CONTROL_NAME_LTS.B.CLASS;
     1854    21233
     1855    21234    3      END;

  21234 28 003223   200007 054100                    AOS     I,,AUTO
        28 003224   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003225   000000 471500                    LDP1    0,,PR0
        28 003226   100000 236100                    LDQ     0,,PR1
        28 003227   777777 376007                    ANQ     -1,DL
        28 003230   000003 136007                    SBLQ    3,DL
        28 003231   200007 116100                    CMPQ    I,,AUTO
        28 003232   003206 605000 28                 TPL     s:21228

     1856    21235    2    END RESTORE_EDITED;

  21235 28 003233   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 003234   000001 702211                    TSX2  ! 1,X1

     1857    21236         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:318  
     1858    21237
     1859    21238         /*================*/
     1860    21239    1      BUILD_CTR_FIELDS: PROC (CONTROL$$);

  21239 28 003235   200206 741300       BUILD_CTR_F* STX1  ! CTR_LVL_ETT$+2,,AUTO

     1861    21240         /*================*/
     1862    21241
     1863    21242        /*I*
     1864    21243
     1865    21244             NAME:  BUILD_CTR_FIELD
     1866    21245
     1867    21246          DESCRIPTION: This routine creates the ST and LX_ETT items for
     1868    21247                       shadow and temporary field of the control items.
     1869    21248        */
     1870    21249
     1871    21250
     1872    21251    2   DCL CONTROL$$          PTR;
     1873    21252    2   DCL NAME$              PTR;
     1874    21253    2   DCL ETT$$              PTR;
     1875    21254    2   DCL ST$$               PTR;
     1876    21255
     1877    21256
     1878    21257        %MACRO BUILD_LX_ETT (@ST$$ = ,
     1879    21258                             @FIELD$ = );
     1880    21259           DO;
     1881    21260               ST$$ = @ST$$;
     1882    21261               CALL Z8AF$NEW_BASE (ST$$,
     1883    21262                                   ADDR(NIL),
     1884    21263                                   ETT$$);
     1885    21264
     1886    21265               %NEW_HEAP (@POINTER = @FIELD$);
     1887    21266
     1888    21267               %INIT_LX_ETT_ITEM (@POINTER = @FIELD$,
     1889    21268                                  @TYPE    = ST$$ -> SCALAR.TYPE,
     1890    21269                                  @ETT$    = ETT$$);
     1891    21270
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:319  
     1892    21271           END;
     1893    21272        %MEND;
     1894    21273        %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:320  
     1895    21274
     1896    21275
     1897    21276    3          DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;

  21276 28 003236   000001 235007                    LDA     1,DL
        28 003237   200007 755100                    STA     I,,AUTO
        28 003240   003531 710000 28                 TRA     s:21409+1

     1898    21277
     1899    21278    3            NAME$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);

  21278 28 003241   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003242   000000 471500                    LDP1    0,,PR0
        28 003243   200007 720100                    LXL0    I,,AUTO
        28 003244   100002 236110                    LDQ     2,X0,PR1
        28 003245   200210 756100                    STQ     NAME$,,AUTO

     1900    21279
     1901    21280    3            IF NAME$ -> CONTROL_NAME_LTS.ST$ -> SCALAR.TYPE = %TYX  OR

  21280 28 003246   200210 473500                    LDP3    NAME$,,AUTO
        28 003247   300001 474500                    LDP4    1,,PR3
        28 003250   400002 221100                    LDX1    2,,PR4
        28 003251   000011 101003                    CMPX1   9,DU
        28 003252   003255 600000 28                 TZE     s:21282
        28 003253   000012 101003                    CMPX1   10,DU
        28 003254   003261 601000 28                 TNZ     s:21286

     1902    21281    3               NAME$ -> CONTROL_NAME_LTS.ST$ -> SCALAR.TYPE = %TYY THEN
     1903    21282    3               NAME$ -> CONTROL_NAME_LTS.ST$ = NAME$ -> CONTROL_NAME_LTS.ST$ ->

  21282 28 003255   400007 475500                    LDP5    7,,PR4
        28 003256   500002 476500                    LDP6    2,,PR5
        28 003257   600004 236100                    LDQ     4,,PR6
        28 003260   300001 756100                    STQ     1,,PR3

     1904    21283    3               SCALAR.QLT$ -> QLT.BROTHER -> QLT.ST$;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:321  
     1905    21284
     1906    21285
     1907    21286    3            CALL CREATE_SHADOW_ST (NAME$ -> CONTROL_NAME_LTS.ST$,

  21286 28 003261   200210 236100                    LDQ     NAME$,,AUTO
        28 003262   000011 036003                    ADLQ    9,DU
        28 003263   200216 756100                    STQ     LINE_SPAN,,AUTO
        28 003264   200210 236100                    LDQ     NAME$,,AUTO
        28 003265   000001 036003                    ADLQ    1,DU
        28 003266   200215 756100                    STQ     PREV$,,AUTO
        28 003267   003616 701000 28                 TSX1    CREATE_SHADOW_ST
        28 003270   000000 011000                    NOP     0

     1908    21287    3                                   NAME$ -> CONTROL_NAME_LTS.TEMP$);
     1909    21288
     1910    21289    3            CALL CREATE_SHADOW_ST (NAME$ -> CONTROL_NAME_LTS.ST$,

  21289 28 003271   200210 236100                    LDQ     NAME$,,AUTO
        28 003272   000012 036003                    ADLQ    10,DU
        28 003273   200216 756100                    STQ     LINE_SPAN,,AUTO
        28 003274   200210 236100                    LDQ     NAME$,,AUTO
        28 003275   000001 036003                    ADLQ    1,DU
        28 003276   200215 756100                    STQ     PREV$,,AUTO
        28 003277   003616 701000 28                 TSX1    CREATE_SHADOW_ST
        28 003300   000000 011000                    NOP     0

     1911    21290    3                                   NAME$ -> CONTROL_NAME_LTS.SHADOW$);
     1912    21291
     1913    21292                 %BUILD_LX_ETT (@ST$$ = NAME$ -> CONTROL_NAME_LTS.ST$,
     1914    21293                                @FIELD$ = NAME$ -> CONTROL_NAME_LTS.ST_FIELD$);

  21295 28 003301   200210 470500                    LDP0    NAME$,,AUTO
        28 003302   000001 236100                    LDQ     1,,PR0
        28 003303   200212 756100                    STQ     ST$$,,AUTO

  21296 28 003304   000017 236000 29                 LDQ     15
        28 003305   200252 756100                    STQ     CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:322  
        28 003306   200211 631500                    EPPR1   ETT$$,,AUTO
        28 003307   200255 451500                    STP1    CETT$$+4,,AUTO
        28 003310   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 003311   200254 453500                    STP3    CETT$$+3,,AUTO
        28 003312   200212 634500                    EPPR4   ST$$,,AUTO
        28 003313   200253 454500                    STP4    CETT$$+2,,AUTO
        28 003314   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 003315   000030 631400 29                 EPPR1   24
        28 003316   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 003317   000000 011000                    NOP     0

  21301 28 003320   000051 236000 29                 LDQ     41
        28 003321   200253 756100                    STQ     CETT$$+2,,AUTO
        28 003322   200210 236100                    LDQ     NAME$,,AUTO
        28 003323   000013 036003                    ADLQ    11,DU
        28 003324   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003325   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003326   000000 631400 29                 EPPR1   0
        28 003327   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        28 003330   000000 011000                    NOP     0

  21308 28 003331   200210 470500                    LDP0    NAME$,,AUTO
        28 003332   000013 471500                    LDP1    11,,PR0
        28 003333   000004 220003                    LDX0    4,DU
        28 003334   100000 740100                    STX0    0,,PR1

  21309 28 003335   000013 471500                    LDP1    11,,PR0
        28 003336   000000 221003                    LDX1    0,DU
        28 003337   100000 441100                    SXL1    0,,PR1

  21310 28 003340   000013 471500                    LDP1    11,,PR0
        28 003341   200212 473500                    LDP3    ST$$,,AUTO
        28 003342   300002 236100                    LDQ     2,,PR3
        28 003343   000022 772000                    QRL     18
        28 003344   100004 756100                    STQ     4,,PR1

  21311 28 003345   000013 471500                    LDP1    11,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:323  
        28 003346   000017 236000 29                 LDQ     15
        28 003347   100007 756100                    STQ     7,,PR1

  21312 28 003350   000013 471500                    LDP1    11,,PR0
        28 003351   200211 236100                    LDQ     ETT$$,,AUTO
        28 003352   100001 756100                    STQ     1,,PR1

  21313 28 003353   000013 471500                    LDP1    11,,PR0
        28 003354   000017 236000 29                 LDQ     15
        28 003355   100002 756100                    STQ     2,,PR1

  21315 28 003356   000013 471500                    LDP1    11,,PR0
        28 003357   000133 235000 xsym               LDA     COMCOM+91
        28 003360   100005 755100                    STA     5,,PR1

  21316 28 003361   000013 471500                    LDP1    11,,PR0
        28 003362   000134 235000 xsym               LDA     COMCOM+92
        28 003363   100006 755100                    STA     6,,PR1

     1915    21330
     1916    21331                 %BUILD_LX_ETT (@ST$$ = NAME$ -> CONTROL_NAME_LTS.TEMP$,
     1917    21332                                @FIELD$ = NAME$ -> CONTROL_NAME_LTS.TEMP_FIELD$);

  21334 28 003364   000011 236100                    LDQ     9,,PR0
        28 003365   200212 756100                    STQ     ST$$,,AUTO

  21335 28 003366   000017 236000 29                 LDQ     15
        28 003367   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003370   200211 631500                    EPPR1   ETT$$,,AUTO
        28 003371   200255 451500                    STP1    CETT$$+4,,AUTO
        28 003372   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 003373   200254 453500                    STP3    CETT$$+3,,AUTO
        28 003374   200212 634500                    EPPR4   ST$$,,AUTO
        28 003375   200253 454500                    STP4    CETT$$+2,,AUTO
        28 003376   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 003377   000030 631400 29                 EPPR1   24
        28 003400   000000 701000 xent               TSX1    Z8AF$NEW_BASE
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:324  
        28 003401   000000 011000                    NOP     0

  21340 28 003402   000051 236000 29                 LDQ     41
        28 003403   200253 756100                    STQ     CETT$$+2,,AUTO
        28 003404   200210 236100                    LDQ     NAME$,,AUTO
        28 003405   000014 036003                    ADLQ    12,DU
        28 003406   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003407   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003410   000000 631400 29                 EPPR1   0
        28 003411   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        28 003412   000000 011000                    NOP     0

  21347 28 003413   200210 470500                    LDP0    NAME$,,AUTO
        28 003414   000014 471500                    LDP1    12,,PR0
        28 003415   000004 220003                    LDX0    4,DU
        28 003416   100000 740100                    STX0    0,,PR1

  21348 28 003417   000014 471500                    LDP1    12,,PR0
        28 003420   000000 221003                    LDX1    0,DU
        28 003421   100000 441100                    SXL1    0,,PR1

  21349 28 003422   000014 471500                    LDP1    12,,PR0
        28 003423   200212 473500                    LDP3    ST$$,,AUTO
        28 003424   300002 236100                    LDQ     2,,PR3
        28 003425   000022 772000                    QRL     18
        28 003426   100004 756100                    STQ     4,,PR1

  21350 28 003427   000014 471500                    LDP1    12,,PR0
        28 003430   000017 236000 29                 LDQ     15
        28 003431   100007 756100                    STQ     7,,PR1

  21351 28 003432   000014 471500                    LDP1    12,,PR0
        28 003433   200211 236100                    LDQ     ETT$$,,AUTO
        28 003434   100001 756100                    STQ     1,,PR1

  21352 28 003435   000014 471500                    LDP1    12,,PR0
        28 003436   000017 236000 29                 LDQ     15
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:325  
        28 003437   100002 756100                    STQ     2,,PR1

  21354 28 003440   000014 471500                    LDP1    12,,PR0
        28 003441   000133 235000 xsym               LDA     COMCOM+91
        28 003442   100005 755100                    STA     5,,PR1

  21355 28 003443   000014 471500                    LDP1    12,,PR0
        28 003444   000134 235000 xsym               LDA     COMCOM+92
        28 003445   100006 755100                    STA     6,,PR1

     1918    21369
     1919    21370                 %BUILD_LX_ETT (@ST$$ = NAME$ -> CONTROL_NAME_LTS.SHADOW$,
     1920    21371                                @FIELD$ = NAME$ -> CONTROL_NAME_LTS.SHADOW_FIELD$);

  21373 28 003446   000012 236100                    LDQ     10,,PR0
        28 003447   200212 756100                    STQ     ST$$,,AUTO

  21374 28 003450   000017 236000 29                 LDQ     15
        28 003451   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003452   200211 631500                    EPPR1   ETT$$,,AUTO
        28 003453   200255 451500                    STP1    CETT$$+4,,AUTO
        28 003454   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 003455   200254 453500                    STP3    CETT$$+3,,AUTO
        28 003456   200212 634500                    EPPR4   ST$$,,AUTO
        28 003457   200253 454500                    STP4    CETT$$+2,,AUTO
        28 003460   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 003461   000030 631400 29                 EPPR1   24
        28 003462   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 003463   000000 011000                    NOP     0

  21379 28 003464   000051 236000 29                 LDQ     41
        28 003465   200253 756100                    STQ     CETT$$+2,,AUTO
        28 003466   200210 236100                    LDQ     NAME$,,AUTO
        28 003467   000015 036003                    ADLQ    13,DU
        28 003470   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003471   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003472   000000 631400 29                 EPPR1   0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:326  
        28 003473   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        28 003474   000000 011000                    NOP     0

  21386 28 003475   200210 470500                    LDP0    NAME$,,AUTO
        28 003476   000015 471500                    LDP1    13,,PR0
        28 003477   000004 220003                    LDX0    4,DU
        28 003500   100000 740100                    STX0    0,,PR1

  21387 28 003501   000015 471500                    LDP1    13,,PR0
        28 003502   000000 221003                    LDX1    0,DU
        28 003503   100000 441100                    SXL1    0,,PR1

  21388 28 003504   000015 471500                    LDP1    13,,PR0
        28 003505   200212 473500                    LDP3    ST$$,,AUTO
        28 003506   300002 236100                    LDQ     2,,PR3
        28 003507   000022 772000                    QRL     18
        28 003510   100004 756100                    STQ     4,,PR1

  21389 28 003511   000015 471500                    LDP1    13,,PR0
        28 003512   000017 236000 29                 LDQ     15
        28 003513   100007 756100                    STQ     7,,PR1

  21390 28 003514   000015 471500                    LDP1    13,,PR0
        28 003515   200211 236100                    LDQ     ETT$$,,AUTO
        28 003516   100001 756100                    STQ     1,,PR1

  21391 28 003517   000015 471500                    LDP1    13,,PR0
        28 003520   000017 236000 29                 LDQ     15
        28 003521   100002 756100                    STQ     2,,PR1

  21393 28 003522   000015 471500                    LDP1    13,,PR0
        28 003523   000133 235000 xsym               LDA     COMCOM+91
        28 003524   100005 755100                    STA     5,,PR1

  21394 28 003525   000015 471500                    LDP1    13,,PR0
        28 003526   000134 235000 xsym               LDA     COMCOM+92
        28 003527   100006 755100                    STA     6,,PR1
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:327  

     1921    21408
     1922    21409    3          END;

  21409 28 003530   200007 054100                    AOS     I,,AUTO
        28 003531   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003532   000000 471500                    LDP1    0,,PR0
        28 003533   100000 236100                    LDQ     0,,PR1
        28 003534   777777 376007                    ANQ     -1,DL
        28 003535   000003 136007                    SBLQ    3,DL
        28 003536   200007 116100                    CMPQ    I,,AUTO
        28 003537   003241 605000 28                 TPL     s:21278

     1923    21410
     1924    21411    2    END BUILD_CTR_FIELDS;

  21411 28 003540   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 003541   000001 702211                    TSX2  ! 1,X1

     1925    21412         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:328  
     1926    21413
     1927    21414         /*==================*/
     1928    21415    1      DISPOSE_CTR_FIELDS: PROC (CONTROL$$);

  21415 28 003542   200206 741300       DISPOSE_CTR* STX1  ! CTR_LVL_ETT$+2,,AUTO

     1929    21416         /*==================*/
     1930    21417
     1931    21418        /*I*
     1932    21419
     1933    21420             NAME:  DISPOSE_CTR_FIELD
     1934    21421
     1935    21422          DESCRIPTION: This routine disposes LX_ETT items for st,
     1936    21423                       shadow and temporary field of the control items.
     1937    21424        */
     1938    21425
     1939    21426
     1940    21427    2   DCL CONTROL$$      PTR;
     1941    21428
     1942    21429
     1943    21430
     1944    21431    3          DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;

  21431 28 003543   000001 235007                    LDA     1,DL
        28 003544   200007 755100                    STA     I,,AUTO
        28 003545   003605 710000 28                 TRA     s:21439+1

     1945    21432
     1946    21433    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) ->
             21433                     CONTROL_NAME_LTS.ST_FIELD$);

  21433 28 003546   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003547   000000 471500                    LDP1    0,,PR0
        28 003550   200007 720100                    LXL0    I,,AUTO
        28 003551   100002 473510                    LDP3    2,X0,PR1
        28 003552   300013 634500                    EPPR4   11,,PR3
        28 003553   200252 454500                    STP4    CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:329  
        28 003554   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003555   000034 631400 29                 EPPR1   28
        28 003556   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        28 003557   000000 011000                    NOP     0

     1947    21434
     1948    21435    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) ->
             21435                     CONTROL_NAME_LTS.TEMP_FIELD$);

  21435 28 003560   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003561   000000 471500                    LDP1    0,,PR0
        28 003562   200007 720100                    LXL0    I,,AUTO
        28 003563   100002 473510                    LDP3    2,X0,PR1
        28 003564   300014 634500                    EPPR4   12,,PR3
        28 003565   200252 454500                    STP4    CETT$$+1,,AUTO
        28 003566   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003567   000034 631400 29                 EPPR1   28
        28 003570   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        28 003571   000000 011000                    NOP     0

     1949    21436
     1950    21437    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) ->
             21437                     CONTROL_NAME_LTS.SHADOW_FIELD$);

  21437 28 003572   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003573   000000 471500                    LDP1    0,,PR0
        28 003574   200007 720100                    LXL0    I,,AUTO
        28 003575   100002 473510                    LDP3    2,X0,PR1
        28 003576   300015 634500                    EPPR4   13,,PR3
        28 003577   200252 454500                    STP4    CETT$$+1,,AUTO
        28 003600   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003601   000034 631400 29                 EPPR1   28
        28 003602   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        28 003603   000000 011000                    NOP     0

     1951    21438
     1952    21439    3          END;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:330  

  21439 28 003604   200007 054100                    AOS     I,,AUTO
        28 003605   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 003606   000000 471500                    LDP1    0,,PR0
        28 003607   100000 236100                    LDQ     0,,PR1
        28 003610   777777 376007                    ANQ     -1,DL
        28 003611   000003 136007                    SBLQ    3,DL
        28 003612   200007 116100                    CMPQ    I,,AUTO
        28 003613   003546 605000 28                 TPL     s:21433

     1953    21440
     1954    21441    2    END DISPOSE_CTR_FIELDS;

  21441 28 003614   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 003615   000001 702211                    TSX2  ! 1,X1

     1955    21442         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:331  
     1956    21443
     1957    21444         /*================*/
     1958    21445    1      CREATE_SHADOW_ST: PROC (ITEM$, SHADOW$);

  21445 28 003616   200214 741300       CREATE_SHAD* STX1  ! LABEL$,,AUTO

     1959    21446         /*================*/
     1960    21447
     1961    21448        /*I*
     1962    21449
     1963    21450             NAME:  CREATE_SHADOW_ST
     1964    21451
     1965    21452          DESCRIPTION: This routine creates ST item and initialize the
     1966    21453                       st item for calling module.
     1967    21454        */
     1968    21455
     1969    21456
     1970    21457    2   DCL ITEM$              PTR;
     1971    21458    2   DCL SHADOW$            PTR;
     1972    21459
     1973    21460
     1974    21461
     1975    21462    2          CALL Z8AT$CREATE_TEMPORARY (%SCALAR, SHADOW$);

  21462 28 003617   200216 236100                    LDQ     @SHADOW$,,AUTO
        28 003620   000053 235000 29                 LDA     43
        28 003621   200252 757100                    STAQ    CETT$$+1,,AUTO
        28 003622   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003623   000000 631400 29                 EPPR1   0
        28 003624   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 003625   000000 011000                    NOP     0

     1976    21463
     1977    21464    2          SHADOW$ -> SCALAR.DESCL = ITEM$ -> SCALAR.DESCL;

  21464 28 003626   200216 470500                    LDP0    @SHADOW$,,AUTO
        28 003627   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:332  
        28 003630   200215 473500                    LDP3    @ITEM$,,AUTO
        28 003631   300000 474500                    LDP4    0,,PR3
        28 003632   400001 720100                    LXL0    1,,PR4
        28 003633   100001 440100                    SXL0    1,,PR1

     1978    21465    2          SHADOW$ -> SCALAR.ADSC.CN = 0;

  21465 28 003634   000000 471500                    LDP1    0,,PR0
        28 003635   000054 236000 29                 LDQ     44
        28 003636   100001 356100                    ANSQ    1,,PR1

     1979    21466    2          SHADOW$ -> SCALAR.B.LENGTH_4096 = ITEM$ -> SCALAR.B.LENGTH_4096;

  21466 28 003637   000000 471500                    LDP1    0,,PR0
        28 003640   300000 474500                    LDP4    0,,PR3
        28 003641   400003 236100                    LDQ     3,,PR4
        28 003642   100003 676100                    ERQ     3,,PR1
        28 003643   004000 376003                    ANQ     2048,DU
        28 003644   100003 656100                    ERSQ    3,,PR1

     1980    21467    2          SHADOW$ -> SCALAR.B.CLASS = ITEM$ -> SCALAR.B.CLASS;

  21467 28 003645   000000 471500                    LDP1    0,,PR0
        28 003646   300000 474500                    LDP4    0,,PR3
        28 003647   400003 236100                    LDQ     3,,PR4
        28 003650   100003 676100                    ERQ     3,,PR1
        28 003651   000007 376007                    ANQ     7,DL
        28 003652   100003 656100                    ERSQ    3,,PR1

     1981    21468    2          SHADOW$ -> SCALAR.TYPE = ITEM$ -> SCALAR.TYPE;

  21468 28 003653   000000 471500                    LDP1    0,,PR0
        28 003654   300000 474500                    LDP4    0,,PR3
        28 003655   400002 220100                    LDX0    2,,PR4
        28 003656   100002 740100                    STX0    2,,PR1

     1982    21469    2          SHADOW$ -> SCALAR.LTS$ = ITEM$ -> SCALAR.LTS$;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:333  

  21469 28 003657   000000 471500                    LDP1    0,,PR0
        28 003660   300000 474500                    LDP4    0,,PR3
        28 003661   400005 236100                    LDQ     5,,PR4
        28 003662   100005 756100                    STQ     5,,PR1

     1983    21470    2          SHADOW$ -> SCALAR.B.DML_TYPE = ITEM$ -> SCALAR.B.DML_TYPE;

  21470 28 003663   000000 471500                    LDP1    0,,PR0
        28 003664   300000 474500                    LDP4    0,,PR3
        28 003665   400003 236100                    LDQ     3,,PR4
        28 003666   100003 676100                    ERQ     3,,PR1
        28 003667   160000 376007                    ANQ     57344,DL
        28 003670   100003 656100                    ERSQ    3,,PR1

     1984    21471
     1985    21472    2    END CREATE_SHADOW_ST;

  21472 28 003671   200214 221300                    LDX1  ! LABEL$,,AUTO
        28 003672   000001 702211                    TSX2  ! 1,X1

     1986    21473         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:334  
     1987    21474
     1988    21475         /*======================*/
     1989    21476    1      CREATE_SHADOW_INIT_SUB: PROC (CONTROL$$);

  21476 28 003673   200206 741300       CREATE_SHAD* STX1  ! CTR_LVL_ETT$+2,,AUTO

     1990    21477         /*======================*/
     1991    21478
     1992    21479        /*I*
     1993    21480
     1994    21481             NAME:  CREATE_SHADOW_INIT_SUB
     1995    21482
     1996    21483          DESCRIPTION: This routine creates shadow item initialize
     1997    21484                       subroutine that will executed by the RWCS to
     1998    21485                       initialize the shadow field of the control items.
     1999    21486        */
     2000    21487
     2001    21488
     2002    21489    2   DCL CONTROL$$      PTR;
     2003    21490    2   DCL LABEL$         PTR;
     2004    21491
     2005    21492
     2006    21493
     2007    21494               %SUB_HEAD (OFFSET_V = %CTR_SHADOW_INIT_OFF,
     2008    21495                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);

  21497 28 003674   200210 630500                    EPPR0   LABEL$,,AUTO
        28 003675   200253 450500                    STP0    CETT$$+2,,AUTO
        28 003676   000002 236000 29                 LDQ     2
        28 003677   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003700   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003701   000000 631400 29                 EPPR1   0
        28 003702   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 003703   000000 011000                    NOP     0

  21498 28 003704   200210 470500                    LDP0    LABEL$,,AUTO
        28 003705   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:335  
        28 003706   000003 256100                    ORSQ    3,,PR0

  21499 28 003707   200210 470500                    LDP0    LABEL$,,AUTO
        28 003710   001000 236007                    LDQ     512,DL
        28 003711   000003 256100                    ORSQ    3,,PR0

  21833 28 003712   000006 236000 29                 LDQ     6
        28 003713   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003714   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 003715   200257 450500                    STP0    CETT$$+6,,AUTO
        28 003716   000007 236000 29                 LDQ     7
        28 003717   200256 756100                    STQ     CETT$$+5,,AUTO
        28 003720   000010 237000 29                 LDAQ    8
        28 003721   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 003722   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 003723   000003 631400 29                 EPPR1   3
        28 003724   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 003725   000000 011000                    NOP     0

  21834 28 003726   200210 236100                    LDQ     LABEL$,,AUTO
        28 003727   000000 470400 18                 LDP0    ILL$
        28 003730   000001 756100                    STQ     1,,PR0

  22141 28 003731   000006 236000 29                 LDQ     6
        28 003732   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003733   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 003734   200257 451500                    STP1    CETT$$+6,,AUTO
        28 003735   000007 236000 29                 LDQ     7
        28 003736   200256 756100                    STQ     CETT$$+5,,AUTO
        28 003737   000014 237000 29                 LDAQ    12
        28 003740   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 003741   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 003742   000003 631400 29                 EPPR1   3
        28 003743   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 003744   000000 011000                    NOP     0

  22145 28 003745   000012 220003                    LDX0    10,DU
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:336  
        28 003746   000000 470400 18                 LDP0    ILL$
        28 003747   000000 440100                    SXL0    0,,PR0

  22147 28 003750   000000 470400 18                 LDP0    ILL$
        28 003751   000002 450100                    STZ     2,,PR0

  22148 28 003752   200210 236100                    LDQ     LABEL$,,AUTO
        28 003753   000001 756100                    STQ     1,,PR0

  22149 28 003754   200003 471500                    LDP1    @LTS$$,,AUTO
        28 003755   100000 473500                    LDP3    0,,PR1
        28 003756   300022 236100                    LDQ     18,,PR3
        28 003757   000003 756100                    STQ     3,,PR0

  22471 28 003760   000006 236000 29                 LDQ     6
        28 003761   200252 756100                    STQ     CETT$$+1,,AUTO
        28 003762   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 003763   200257 453500                    STP3    CETT$$+6,,AUTO
        28 003764   000007 236000 29                 LDQ     7
        28 003765   200256 756100                    STQ     CETT$$+5,,AUTO
        28 003766   000020 237000 29                 LDAQ    16
        28 003767   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 003770   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 003771   000003 631400 29                 EPPR1   3
        28 003772   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 003773   000000 011000                    NOP     0

  22472 28 003774   000001 220003                    LDX0    1,DU
        28 003775   000000 470400 18                 LDP0    ILL$
        28 003776   000000 440100                    SXL0    0,,PR0

  22476 28 003777   000057 470400 xsym               LDP0    O1COM+47
        28 004000   000006 236100                    LDQ     6,,PR0
        28 004001   000000 471400 18                 LDP1    ILL$
        28 004002   100001 756100                    STQ     1,,PR1

     2009    22645
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:337  
     2010    22646    3          DO I = 1 TO CONTROL$$ -> LTS_PTR_ARRAY.N - 3;

  22646 28 004003   000001 235007                    LDA     1,DL
        28 004004   200007 755100                    STA     I,,AUTO
        28 004005   004040 710000 28                 TRA     s:22656+1

     2011    22647
     2012    22648    3            IF CONTROL$$ -> LTS_PTR_ARRAY.P$(I) ->

  22648 28 004006   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 004007   000000 471500                    LDP1    0,,PR0
        28 004010   200007 720100                    LXL0    I,,AUTO
        28 004011   100002 473510                    LDP3    2,X0,PR1
        28 004012   300013 474500                    LDP4    11,,PR3
        28 004013   400004 235100                    LDA     4,,PR4
        28 004014   000011 115007                    CMPA    9,DL
        28 004015   004027 601000 28                 TNZ     s:22653

     2013    22649    3               CONTROL_NAME_LTS.ST_FIELD$ -> LX_ETT_ITEM.TYPE = %TYX THEN
     2014    22650    3             CALL Z8EX$SET_INDEX (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS
             22650                       .SHADOW_FIELD$,

  22650 28 004016   300013 635500                    EPPR5   11,,PR3
        28 004017   200253 455500                    STP5    CETT$$+2,,AUTO
        28 004020   300015 631500                    EPPR1   13,,PR3
        28 004021   200252 451500                    STP1    CETT$$+1,,AUTO
        28 004022   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004023   000000 631400 29                 EPPR1   0
        28 004024   000000 701000 xent               TSX1    Z8EX$SET_INDEX
        28 004025   000000 011000                    NOP     0
        28 004026   004037 710000 28                 TRA     s:22656

     2015    22651    3                            CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.
             22651                                     ST_FIELD$);
     2016    22652    3            ELSE
     2017    22653    3              CALL Z8E7$MOVE (CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.
             22653                       SHADOW_FIELD$,
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:338  

  22653 28 004027   300013 635500                    EPPR5   11,,PR3
        28 004030   200253 455500                    STP5    CETT$$+2,,AUTO
        28 004031   300015 631500                    EPPR1   13,,PR3
        28 004032   200252 451500                    STP1    CETT$$+1,,AUTO
        28 004033   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004034   000000 631400 29                 EPPR1   0
        28 004035   000000 701000 xent               TSX1    Z8E7$MOVE
        28 004036   000000 011000                    NOP     0

     2018    22654    3                            CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.
             22654                                     ST_FIELD$);
     2019    22655
     2020    22656    3          END;

  22656 28 004037   200007 054100                    AOS     I,,AUTO
        28 004040   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 004041   000000 471500                    LDP1    0,,PR0
        28 004042   100000 236100                    LDQ     0,,PR1
        28 004043   777777 376007                    ANQ     -1,DL
        28 004044   000003 136007                    SBLQ    3,DL
        28 004045   200007 116100                    CMPQ    I,,AUTO
        28 004046   004006 605000 28                 TPL     s:22648

     2021    22657
     2022    22658               %DB_EXCEPT_LIBRARY_RETURN;

  22868 28 004047   000006 236000 29                 LDQ     6
        28 004050   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004051   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 004052   200257 451500                    STP1    CETT$$+6,,AUTO
        28 004053   000007 236000 29                 LDQ     7
        28 004054   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004055   000032 237000 29                 LDAQ    26
        28 004056   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004057   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004060   000003 631400 29                 EPPR1   3
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:339  
        28 004061   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004062   000000 011000                    NOP     0

  22869 28 004063   000001 220003                    LDX0    1,DU
        28 004064   000000 470400 18                 LDP0    ILL$
        28 004065   000000 440100                    SXL0    0,,PR0

  22873 28 004066   000057 470400 xsym               LDP0    O1COM+47
        28 004067   000006 236100                    LDQ     6,,PR0
        28 004070   000000 471400 18                 LDP1    ILL$
        28 004071   100001 756100                    STQ     1,,PR1

     2023    23042
     2024    23043    2    END CREATE_SHADOW_INIT_SUB;

  23043 28 004072   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 004073   000001 702211                    TSX2  ! 1,X1

     2025    23044         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:340  
     2026    23045
     2027    23046         /*=====================*/
     2028    23047    1      CREATE_CTR_DETECT_SUB: PROC (CONTROL$$);

  23047 28 004074   200206 741300       CREATE_CTR_* STX1  ! CTR_LVL_ETT$+2,,AUTO

     2029    23048         /*=====================*/
     2030    23049
     2031    23050        /*I*
     2032    23051
     2033    23052             NAME:  CREATE_CTR_DETECT_SUB
     2034    23053
     2035    23054          DESCRIPTION: This routine creates control break detect subroutine
     2036    23055                       that will executed by the RWCS to compare the control
     2037    23056                       items with its shadow fields to determine the break.
     2038    23057        */
     2039    23058
     2040    23059
     2041    23060    2   DCL LBL$$ (0:25)       PTR;
     2042    23061    2   DCL LABEL$             PTR;
     2043    23062    2   DCL CTR_LVL_NO#        SBIN WORD;
     2044    23063    2   DCL CONTROL$$          PTR;
     2045    23064    2   DCL NAME$$             PTR;
     2046    23065    2   DCL TARGET_NO#         SBIN WORD;
     2047    23066    2   DCL END_LABEL$         PTR;
     2048    23067
     2049    23068
     2050    23069
     2051    23070               %SUB_HEAD (OFFSET_V = %CTR_BREAK_OFF,
     2052    23071                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);

  23073 28 004075   200242 630500                    EPPR0   LABEL$,,AUTO
        28 004076   200253 450500                    STP0    CETT$$+2,,AUTO
        28 004077   000002 236000 29                 LDQ     2
        28 004100   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004101   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004102   000000 631400 29                 EPPR1   0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:341  
        28 004103   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 004104   000000 011000                    NOP     0

  23074 28 004105   200242 470500                    LDP0    LABEL$,,AUTO
        28 004106   400000 236003                    LDQ     -131072,DU
        28 004107   000003 256100                    ORSQ    3,,PR0

  23075 28 004110   200242 470500                    LDP0    LABEL$,,AUTO
        28 004111   001000 236007                    LDQ     512,DL
        28 004112   000003 256100                    ORSQ    3,,PR0

  23409 28 004113   000006 236000 29                 LDQ     6
        28 004114   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004115   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004116   200257 450500                    STP0    CETT$$+6,,AUTO
        28 004117   000007 236000 29                 LDQ     7
        28 004120   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004121   000010 237000 29                 LDAQ    8
        28 004122   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004123   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004124   000003 631400 29                 EPPR1   3
        28 004125   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004126   000000 011000                    NOP     0

  23410 28 004127   200242 236100                    LDQ     LABEL$,,AUTO
        28 004130   000000 470400 18                 LDP0    ILL$
        28 004131   000001 756100                    STQ     1,,PR0

  23717 28 004132   000006 236000 29                 LDQ     6
        28 004133   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004134   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 004135   200257 451500                    STP1    CETT$$+6,,AUTO
        28 004136   000007 236000 29                 LDQ     7
        28 004137   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004140   000014 237000 29                 LDAQ    12
        28 004141   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004142   200254 630500                    EPPR0   CETT$$+3,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:342  
        28 004143   000003 631400 29                 EPPR1   3
        28 004144   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004145   000000 011000                    NOP     0

  23721 28 004146   000011 220003                    LDX0    9,DU
        28 004147   000000 470400 18                 LDP0    ILL$
        28 004150   000000 440100                    SXL0    0,,PR0

  23723 28 004151   000000 470400 18                 LDP0    ILL$
        28 004152   000002 450100                    STZ     2,,PR0

  23724 28 004153   200242 236100                    LDQ     LABEL$,,AUTO
        28 004154   000001 756100                    STQ     1,,PR0

  23725 28 004155   200003 471500                    LDP1    @LTS$$,,AUTO
        28 004156   100000 473500                    LDP3    0,,PR1
        28 004157   300022 236100                    LDQ     18,,PR3
        28 004160   000003 756100                    STQ     3,,PR0

  24047 28 004161   000006 236000 29                 LDQ     6
        28 004162   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004163   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 004164   200257 453500                    STP3    CETT$$+6,,AUTO
        28 004165   000007 236000 29                 LDQ     7
        28 004166   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004167   000020 237000 29                 LDAQ    16
        28 004170   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004171   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004172   000003 631400 29                 EPPR1   3
        28 004173   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004174   000000 011000                    NOP     0

  24048 28 004175   000001 220003                    LDX0    1,DU
        28 004176   000000 470400 18                 LDP0    ILL$
        28 004177   000000 440100                    SXL0    0,,PR0

  24052 28 004200   000057 470400 xsym               LDP0    O1COM+47
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:343  
        28 004201   000006 236100                    LDQ     6,,PR0
        28 004202   000000 471400 18                 LDP1    ILL$
        28 004203   100001 756100                    STQ     1,,PR1

     2053    24221
     2054    24222    2          IF LTS$$ -> REPORT_LTS.B.CONTROL_FINAL THEN

  24222 28 004204   200003 470500                    LDP0    @LTS$$,,AUTO
        28 004205   000000 473500                    LDP3    0,,PR0
        28 004206   300003 236100                    LDQ     3,,PR3
        28 004207   200000 316003                    CANQ    65536,DU
        28 004210   004214 600000 28                 TZE     s:24225

     2055    24223    2            CTR_LVL_NO# = 2;

  24223 28 004211   000002 235007                    LDA     2,DL
        28 004212   200243 755100                    STA     CTR_LVL_NO#,,AUTO
        28 004213   004216 710000 28                 TRA     s:24227

     2056    24224    2          ELSE
     2057    24225    2            CTR_LVL_NO# = 1;

  24225 28 004214   000001 235007                    LDA     1,DL
        28 004215   200243 755100                    STA     CTR_LVL_NO#,,AUTO

     2058    24226
     2059    24227    2          MKCN.CON = CTR_LVL_NO#;

  24227 28 004216   000000 755000 24                 STA     MKCN

     2060    24228
     2061    24229    2          CALL Z8AC$MAKE_CONST (CONST_ETT$);

  24229 28 004217   200011 633500                    EPPR3   CONST_ETT$,,AUTO
        28 004220   200252 453500                    STP3    CETT$$+1,,AUTO
        28 004221   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004222   000034 631400 29                 EPPR1   28
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:344  
        28 004223   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        28 004224   000000 011000                    NOP     0

     2062    24230
     2063    24231               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(SEND_FIELD)",
     2064    24232                              @TYPE    = %TYI,
     2065    24233                              @ETT$    = CONST_ETT$);

  24235 28 004225   000004 220003                    LDX0    4,DU
        28 004226   200074 740100                    STX0    SEND_FIELD,,AUTO

  24236 28 004227   000000 221003                    LDX1    0,DU
        28 004230   200074 441100                    SXL1    SEND_FIELD,,AUTO

  24237 28 004231   000001 235007                    LDA     1,DL
        28 004232   200100 755100                    STA     SEND_FIELD+4,,AUTO

  24238 28 004233   000017 236000 29                 LDQ     15
        28 004234   200103 756100                    STQ     SEND_FIELD+7,,AUTO

  24239 28 004235   200011 236100                    LDQ     CONST_ETT$,,AUTO
        28 004236   200075 756100                    STQ     SEND_FIELD+1,,AUTO

  24240 28 004237   000017 236000 29                 LDQ     15
        28 004240   200076 756100                    STQ     SEND_FIELD+2,,AUTO

  24242 28 004241   000133 235000 xsym               LDA     COMCOM+91
        28 004242   200101 755100                    STA     SEND_FIELD+5,,AUTO

  24243 28 004243   000134 235000 xsym               LDA     COMCOM+92
        28 004244   200102 755100                    STA     SEND_FIELD+6,,AUTO

     2066    24255
     2067    24256    2          CALL Z8E7$MOVE (ADDR(CTR_LVL_FIELD),

  24256 28 004245   200174 630500                    EPPR0   CTR_LVL_FIELD,,AUTO
        28 004246   200252 450500                    STP0    CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:345  
        28 004247   200074 631500                    EPPR1   SEND_FIELD,,AUTO
        28 004250   200253 451500                    STP1    CETT$$+2,,AUTO
        28 004251   200253 633500                    EPPR3   CETT$$+2,,AUTO
        28 004252   200255 453500                    STP3    CETT$$+4,,AUTO
        28 004253   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 004254   200254 454500                    STP4    CETT$$+3,,AUTO
        28 004255   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004256   000000 631400 29                 EPPR1   0
        28 004257   000000 701000 xent               TSX1    Z8E7$MOVE
        28 004260   000000 011000                    NOP     0

     2068    24257    2                          ADDR(SEND_FIELD));
     2069    24258
     2070    24259               %INIT_BINARY_OP (@POINTER = "ADDR(OP_NODE)",
     2071    24260                                @ROP$    = "ADDR(ONE_FIELD)",
     2072    24261                                @LOP$    = "ADDR(CTR_LVL_FIELD)",
     2073    24262                                @OP      = %OP_PLUS);

  24264 28 004261   000005 220003                    LDX0    5,DU
        28 004262   200064 740100                    STX0    OP_NODE,,AUTO

  24265 28 004263   000000 221003                    LDX1    0,DU
        28 004264   200064 441100                    SXL1    OP_NODE,,AUTO

  24272 28 004265   000133 235000 xsym               LDA     COMCOM+91
        28 004266   200071 755100                    STA     OP_NODE+5,,AUTO

  24273 28 004267   000134 236000 xsym               LDQ     COMCOM+92
        28 004270   200072 756100                    STQ     OP_NODE+6,,AUTO

  24274 28 004271   200164 630500                    EPPR0   ONE_FIELD,,AUTO
        28 004272   200066 450500                    STP0    OP_NODE+2,,AUTO

  24275 28 004273   200174 631500                    EPPR1   CTR_LVL_FIELD,,AUTO
        28 004274   200065 451500                    STP1    OP_NODE+1,,AUTO

  24276 28 004275   000020 235007                    LDA     16,DL
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:346  
        28 004276   200067 755100                    STA     OP_NODE+3,,AUTO

  24277 28 004277   000017 236000 29                 LDQ     15
        28 004300   200073 756100                    STQ     OP_NODE+7,,AUTO

     2074    24280
     2075    24281    2          CALL Z8E5$MATH_PACK (ADDR(OP_NODE),

  24281 28 004301   200064 633500                    EPPR3   OP_NODE,,AUTO
        28 004302   200252 453500                    STP3    CETT$$+1,,AUTO
        28 004303   200054 634500                    EPPR4   ETT_ITEM,,AUTO
        28 004304   200253 454500                    STP4    CETT$$+2,,AUTO
        28 004305   200253 635500                    EPPR5   CETT$$+2,,AUTO
        28 004306   200255 455500                    STP5    CETT$$+4,,AUTO
        28 004307   200252 636500                    EPPR6   CETT$$+1,,AUTO
        28 004310   200254 456500                    STP6    CETT$$+3,,AUTO
        28 004311   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004312   000000 631400 29                 EPPR1   0
        28 004313   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        28 004314   000000 011000                    NOP     0

     2076    24282    2                               ADDR(ETT_ITEM));
     2077    24283
     2078    24284    2          TARGET_NO# = CONTROL$$ -> LTS_PTR_ARRAY.N - 3;

  24284 28 004315   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 004316   000000 471500                    LDP1    0,,PR0
        28 004317   100000 236100                    LDQ     0,,PR1
        28 004320   777777 376007                    ANQ     -1,DL
        28 004321   000003 136007                    SBLQ    3,DL
        28 004322   200245 756100                    STQ     TARGET_NO#,,AUTO

     2079    24285
     2080    24286    3          DO I = 1 TO TARGET_NO#;

  24286 28 004323   000001 235007                    LDA     1,DL
        28 004324   200007 755100                    STA     I,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:347  
        28 004325   004434 710000 28                 TRA     s:24328+1

     2081    24287
     2082    24288    3            CALL Z8AT$CREATE_TEMPORARY (%PARA, LBL$$(I));

  24288 28 004326   200007 720100                    LXL0    I,,AUTO
        28 004327   200210 630510                    EPPR0   LBL$$,X0,AUTO
        28 004330   200253 450500                    STP0    CETT$$+2,,AUTO
        28 004331   000002 236000 29                 LDQ     2
        28 004332   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004333   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004334   000000 631400 29                 EPPR1   0
        28 004335   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 004336   000000 011000                    NOP     0

     2083    24289
     2084    24290                 %INIT_BINARY_OP (@POINTER = "ADDR(COMPARE)",
     2085    24291                                  @LOP$    =
             24291                           "CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.ST_FIELD$"
             24291                                      ,
     2086    24292                                  @ROP$    =
             24292                       "CONTROL$$ -> LTS_PTR_ARRAY.P$(I) -> CONTROL_NAME_LTS.SHADOW_FIELD$"
             24292                                      ,
     2087    24293                                  @OP      = %OP_EQUAL);

  24295 28 004337   000005 220003                    LDX0    5,DU
        28 004340   200144 740100                    STX0    COMPARE,,AUTO

  24296 28 004341   000000 221003                    LDX1    0,DU
        28 004342   200144 441100                    SXL1    COMPARE,,AUTO

  24303 28 004343   000133 235000 xsym               LDA     COMCOM+91
        28 004344   200151 755100                    STA     COMPARE+5,,AUTO

  24304 28 004345   000134 236000 xsym               LDQ     COMCOM+92
        28 004346   200152 756100                    STQ     COMPARE+6,,AUTO

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:348  
  24305 28 004347   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 004350   000000 471500                    LDP1    0,,PR0
        28 004351   200007 722100                    LXL2    I,,AUTO
        28 004352   100002 473512                    LDP3    2,X2,PR1
        28 004353   300015 236100                    LDQ     13,,PR3
        28 004354   200146 756100                    STQ     COMPARE+2,,AUTO

  24306 28 004355   000000 471500                    LDP1    0,,PR0
        28 004356   100002 473512                    LDP3    2,X2,PR1
        28 004357   300013 236100                    LDQ     11,,PR3
        28 004360   200145 756100                    STQ     COMPARE+1,,AUTO

  24307 28 004361   000027 235007                    LDA     23,DL
        28 004362   200147 755100                    STA     COMPARE+3,,AUTO

  24308 28 004363   000017 236000 29                 LDQ     15
        28 004364   200153 756100                    STQ     COMPARE+7,,AUTO

     2088    24311
     2089    24312    3            CALL Z8EK$BRANCH_FALSE (LBL$$(I),

  24312 28 004365   200144 631500                    EPPR1   COMPARE,,AUTO
        28 004366   200252 451500                    STP1    CETT$$+1,,AUTO
        28 004367   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 004370   200255 453500                    STP3    CETT$$+4,,AUTO
        28 004371   200210 634512                    EPPR4   LBL$$,X2,AUTO
        28 004372   200254 454500                    STP4    CETT$$+3,,AUTO
        28 004373   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004374   000000 631400 29                 EPPR1   0
        28 004375   000000 701000 xent               TSX1    Z8EK$BRANCH_FALSE
        28 004376   000000 011000                    NOP     0

     2090    24313    3                                    ADDR(COMPARE));
     2091    24314
     2092    24315    3            IF I < TARGET_NO# THEN

  24315 28 004377   200007 236100                    LDQ     I,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:349  
        28 004400   200245 116100                    CMPQ    TARGET_NO#,,AUTO
        28 004401   004417 605000 28                 TPL     s:24324

     2093    24316    4              DO;

     2094    24317
     2095    24318    4                CALL Z8E7$MOVE (ADDR(CTR_LVL_FIELD),

  24318 28 004402   200174 630500                    EPPR0   CTR_LVL_FIELD,,AUTO
        28 004403   200252 450500                    STP0    CETT$$+1,,AUTO
        28 004404   200054 631500                    EPPR1   ETT_ITEM,,AUTO
        28 004405   200253 451500                    STP1    CETT$$+2,,AUTO
        28 004406   200253 633500                    EPPR3   CETT$$+2,,AUTO
        28 004407   200255 453500                    STP3    CETT$$+4,,AUTO
        28 004410   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 004411   200254 454500                    STP4    CETT$$+3,,AUTO
        28 004412   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004413   000000 631400 29                 EPPR1   0
        28 004414   000000 701000 xent               TSX1    Z8E7$MOVE
        28 004415   000000 011000                    NOP     0

     2096    24319    4                                ADDR(ETT_ITEM));
     2097    24320
     2098    24321    4              END;

  24321 28 004416   004433 710000 28                 TRA     s:24328

     2099    24322    3            ELSE
     2100    24323    4              DO;

     2101    24324    4                CALL Z8E7$MOVE (ADDR(CTR_LVL_FIELD),

  24324 28 004417   200174 630500                    EPPR0   CTR_LVL_FIELD,,AUTO
        28 004420   200252 450500                    STP0    CETT$$+1,,AUTO
        28 004421   200134 631500                    EPPR1   ZERO,,AUTO
        28 004422   200253 451500                    STP1    CETT$$+2,,AUTO
        28 004423   200253 633500                    EPPR3   CETT$$+2,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:350  
        28 004424   200255 453500                    STP3    CETT$$+4,,AUTO
        28 004425   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 004426   200254 454500                    STP4    CETT$$+3,,AUTO
        28 004427   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004430   000000 631400 29                 EPPR1   0
        28 004431   000000 701000 xent               TSX1    Z8E7$MOVE
        28 004432   000000 011000                    NOP     0

     2102    24325    4                                ADDR(ZERO));
     2103    24326    4              END;

     2104    24327
     2105    24328    3          END; /* DO LOOP */

  24328 28 004433   200007 054100                    AOS     I,,AUTO
        28 004434   200007 236100                    LDQ     I,,AUTO
        28 004435   200245 116100                    CMPQ    TARGET_NO#,,AUTO
        28 004436   004326 604400 28                 TMOZ    s:24288

     2106    24329
     2107    24330    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, END_LABEL$);

  24330 28 004437   200246 630500                    EPPR0   END_LABEL$,,AUTO
        28 004440   200253 450500                    STP0    CETT$$+2,,AUTO
        28 004441   000002 236000 29                 LDQ     2
        28 004442   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004443   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004444   000000 631400 29                 EPPR1   0
        28 004445   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 004446   000000 011000                    NOP     0

     2108    24331
     2109    24332    2          CALL Z8EK$BRANCH (END_LABEL$);

  24332 28 004447   200246 630500                    EPPR0   END_LABEL$,,AUTO
        28 004450   200252 450500                    STP0    CETT$$+1,,AUTO
        28 004451   200252 630500                    EPPR0   CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:351  
        28 004452   000034 631400 29                 EPPR1   28
        28 004453   000000 701000 xent               TSX1    Z8EK$BRANCH
        28 004454   000000 011000                    NOP     0

     2110    24333
     2111    24334    3          DO I = 1 TO TARGET_NO#;

  24334 28 004455   000001 235007                    LDA     1,DL
        28 004456   200007 755100                    STA     I,,AUTO
        28 004457   004544 710000 28                 TRA     s:24728+1

     2112    24335
     2113    24336    3            NAME$$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);

  24336 28 004460   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 004461   000000 471500                    LDP1    0,,PR0
        28 004462   200007 720100                    LXL0    I,,AUTO
        28 004463   100002 236110                    LDQ     2,X0,PR1
        28 004464   200244 756100                    STQ     NAME$$,,AUTO

     2114    24337
     2115    24338                 %NEW_ILL (@ID    = %DEFLB,
     2116    24339                       @LABEL$ = "LBL$$(I)");

  24671 28 004465   000006 236000 29                 LDQ     6
        28 004466   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004467   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 004470   200257 451500                    STP1    CETT$$+6,,AUTO
        28 004471   000007 236000 29                 LDQ     7
        28 004472   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004473   000010 237000 29                 LDAQ    8
        28 004474   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004475   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004476   000003 631400 29                 EPPR1   3
        28 004477   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004500   000000 011000                    NOP     0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:352  
  24672 28 004501   200007 720100                    LXL0    I,,AUTO
        28 004502   200210 236110                    LDQ     LBL$$,X0,AUTO
        28 004503   000000 470400 18                 LDP0    ILL$
        28 004504   000001 756100                    STQ     1,,PR0

     2117    24718
     2118    24719    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.TEMP_FIELD$,

  24719 28 004505   200244 236100                    LDQ     NAME$$,,AUTO
        28 004506   000013 036003                    ADLQ    11,DU
        28 004507   200253 756100                    STQ     CETT$$+2,,AUTO
        28 004510   200244 236100                    LDQ     NAME$$,,AUTO
        28 004511   000014 036003                    ADLQ    12,DU
        28 004512   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004513   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004514   000000 631400 29                 EPPR1   0
        28 004515   000000 701000 xent               TSX1    Z8E7$MOVE
        28 004516   000000 011000                    NOP     0

     2119    24720    3                            NAME$$ -> CONTROL_NAME_LTS.ST_FIELD$);
     2120    24721
     2121    24722    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.ST_FIELD$,

  24722 28 004517   200244 236100                    LDQ     NAME$$,,AUTO
        28 004520   000015 036003                    ADLQ    13,DU
        28 004521   200253 756100                    STQ     CETT$$+2,,AUTO
        28 004522   200244 236100                    LDQ     NAME$$,,AUTO
        28 004523   000013 036003                    ADLQ    11,DU
        28 004524   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004525   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004526   000000 631400 29                 EPPR1   0
        28 004527   000000 701000 xent               TSX1    Z8E7$MOVE
        28 004530   000000 011000                    NOP     0

     2122    24723    3                            NAME$$ -> CONTROL_NAME_LTS.SHADOW_FIELD$);
     2123    24724
     2124    24725    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.SHADOW_FIELD$,
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:353  

  24725 28 004531   200244 236100                    LDQ     NAME$$,,AUTO
        28 004532   000014 036003                    ADLQ    12,DU
        28 004533   200253 756100                    STQ     CETT$$+2,,AUTO
        28 004534   200244 236100                    LDQ     NAME$$,,AUTO
        28 004535   000015 036003                    ADLQ    13,DU
        28 004536   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004537   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004540   000000 631400 29                 EPPR1   0
        28 004541   000000 701000 xent               TSX1    Z8E7$MOVE
        28 004542   000000 011000                    NOP     0

     2125    24726    3                            NAME$$ -> CONTROL_NAME_LTS.TEMP_FIELD$);
     2126    24727
     2127    24728    3          END; /* DO LOOP */

  24728 28 004543   200007 054100                    AOS     I,,AUTO
        28 004544   200007 236100                    LDQ     I,,AUTO
        28 004545   200245 116100                    CMPQ    TARGET_NO#,,AUTO
        28 004546   004460 604400 28                 TMOZ    s:24336

     2128    24729
     2129    24730               %NEW_ILL (@ID   = %DEFLB,
     2130    24731                         @LABEL$ = END_LABEL$);

  25063 28 004547   000006 236000 29                 LDQ     6
        28 004550   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004551   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004552   200257 450500                    STP0    CETT$$+6,,AUTO
        28 004553   000007 236000 29                 LDQ     7
        28 004554   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004555   000010 237000 29                 LDAQ    8
        28 004556   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004557   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004560   000003 631400 29                 EPPR1   3
        28 004561   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004562   000000 011000                    NOP     0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:354  

  25064 28 004563   200246 236100                    LDQ     END_LABEL$,,AUTO
        28 004564   000000 470400 18                 LDP0    ILL$
        28 004565   000001 756100                    STQ     1,,PR0

     2131    25110
     2132    25111               %DB_EXCEPT_LIBRARY_RETURN;

  25321 28 004566   000006 236000 29                 LDQ     6
        28 004567   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004570   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 004571   200257 451500                    STP1    CETT$$+6,,AUTO
        28 004572   000007 236000 29                 LDQ     7
        28 004573   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004574   000032 237000 29                 LDAQ    26
        28 004575   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004576   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004577   000003 631400 29                 EPPR1   3
        28 004600   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004601   000000 011000                    NOP     0

  25322 28 004602   000001 220003                    LDX0    1,DU
        28 004603   000000 470400 18                 LDP0    ILL$
        28 004604   000000 440100                    SXL0    0,,PR0

  25326 28 004605   000057 470400 xsym               LDP0    O1COM+47
        28 004606   000006 236100                    LDQ     6,,PR0
        28 004607   000000 471400 18                 LDP1    ILL$
        28 004610   100001 756100                    STQ     1,,PR1

     2133    25495
     2134    25496    2    END CREATE_CTR_DETECT_SUB;

  25496 28 004611   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 004612   000001 702211                    TSX2  ! 1,X1

     2135    25497         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:355  
     2136    25498
     2137    25499         /*======================*/
     2138    25500    1      CREATE_SHADOW_SWAP_SUB: PROC(CONTROL$$);

  25500 28 004613   200206 741300       CREATE_SHAD* STX1  ! CTR_LVL_ETT$+2,,AUTO

     2139    25501         /*======================*/
     2140    25502
     2141    25503        /*I*
     2142    25504
     2143    25505             NAME:  CREATE_SHADOW_SWAP_SUB
     2144    25506
     2145    25507          DESCRIPTION: This routine creates shadow swap subroutine
     2146    25508                       that will executed by the RWCS to swap the control
     2147    25509                       items with its shadow fields.
     2148    25510        */
     2149    25511
     2150    25512
     2151    25513    2   DCL CONTROL$$      PTR;
     2152    25514    2   DCL LABEL$         PTR;
     2153    25515    2   DCL CTR_FINAL_IND  SBIN WORD;
     2154    25516    2   DCL LBL$$ (0 : 25) PTR;
     2155    25517    2   DCL ETT$$          PTR;
     2156    25518    2   DCL END_LABEL$     PTR;
     2157    25519    2   DCL START_LABEL$   PTR;
     2158    25520    2   DCL NAME$$         PTR;
     2159    25521    2   DCL TARGET_NO#     SBIN WORD;
     2160    25522    2   DCL CETT$$         PTR;
     2161    25523
     2162    25524               %SUB_HEAD (OFFSET_V = %CTR_ITEM_SWAP_OFF,
     2163    25525                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);

  25527 28 004614   200210 630500                    EPPR0   LABEL$,,AUTO
        28 004615   200253 450500                    STP0    CETT$$+2,,AUTO
        28 004616   000002 236000 29                 LDQ     2
        28 004617   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004620   200252 630500                    EPPR0   CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:356  
        28 004621   000000 631400 29                 EPPR1   0
        28 004622   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 004623   000000 011000                    NOP     0

  25528 28 004624   200210 470500                    LDP0    LABEL$,,AUTO
        28 004625   400000 236003                    LDQ     -131072,DU
        28 004626   000003 256100                    ORSQ    3,,PR0

  25529 28 004627   200210 470500                    LDP0    LABEL$,,AUTO
        28 004630   001000 236007                    LDQ     512,DL
        28 004631   000003 256100                    ORSQ    3,,PR0

  25863 28 004632   000006 236000 29                 LDQ     6
        28 004633   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004634   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004635   200257 450500                    STP0    CETT$$+6,,AUTO
        28 004636   000007 236000 29                 LDQ     7
        28 004637   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004640   000010 237000 29                 LDAQ    8
        28 004641   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004642   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004643   000003 631400 29                 EPPR1   3
        28 004644   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004645   000000 011000                    NOP     0

  25864 28 004646   200210 236100                    LDQ     LABEL$,,AUTO
        28 004647   000000 470400 18                 LDP0    ILL$
        28 004650   000001 756100                    STQ     1,,PR0

  26171 28 004651   000006 236000 29                 LDQ     6
        28 004652   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004653   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 004654   200257 451500                    STP1    CETT$$+6,,AUTO
        28 004655   000007 236000 29                 LDQ     7
        28 004656   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004657   000014 237000 29                 LDAQ    12
        28 004660   200254 757100                    STAQ    CETT$$+3,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:357  
        28 004661   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004662   000003 631400 29                 EPPR1   3
        28 004663   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004664   000000 011000                    NOP     0

  26175 28 004665   000013 220003                    LDX0    11,DU
        28 004666   000000 470400 18                 LDP0    ILL$
        28 004667   000000 440100                    SXL0    0,,PR0

  26177 28 004670   000000 470400 18                 LDP0    ILL$
        28 004671   000002 450100                    STZ     2,,PR0

  26178 28 004672   200210 236100                    LDQ     LABEL$,,AUTO
        28 004673   000001 756100                    STQ     1,,PR0

  26179 28 004674   200003 471500                    LDP1    @LTS$$,,AUTO
        28 004675   100000 473500                    LDP3    0,,PR1
        28 004676   300022 236100                    LDQ     18,,PR3
        28 004677   000003 756100                    STQ     3,,PR0

  26501 28 004700   000006 236000 29                 LDQ     6
        28 004701   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004702   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 004703   200257 453500                    STP3    CETT$$+6,,AUTO
        28 004704   000007 236000 29                 LDQ     7
        28 004705   200256 756100                    STQ     CETT$$+5,,AUTO
        28 004706   000020 237000 29                 LDAQ    16
        28 004707   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 004710   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 004711   000003 631400 29                 EPPR1   3
        28 004712   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 004713   000000 011000                    NOP     0

  26502 28 004714   000001 220003                    LDX0    1,DU
        28 004715   000000 470400 18                 LDP0    ILL$
        28 004716   000000 440100                    SXL0    0,,PR0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:358  
  26506 28 004717   000057 470400 xsym               LDP0    O1COM+47
        28 004720   000006 236100                    LDQ     6,,PR0
        28 004721   000000 471400 18                 LDP1    ILL$
        28 004722   100001 756100                    STQ     1,,PR1

     2164    26675
     2165    26676    2          TARGET_NO# = CONTROL$$ -> LTS_PTR_ARRAY.N - 3;

  26676 28 004723   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 004724   000000 473500                    LDP3    0,,PR0
        28 004725   300000 236100                    LDQ     0,,PR3
        28 004726   777777 376007                    ANQ     -1,DL
        28 004727   000003 136007                    SBLQ    3,DL
        28 004730   200250 756100                    STQ     TARGET_NO#,,AUTO

     2166    26677
     2167    26678    2          IF LTS$$ -> REPORT_LTS.B.CONTROL_FINAL THEN

  26678 28 004731   200003 474500                    LDP4    @LTS$$,,AUTO
        28 004732   400000 475500                    LDP5    0,,PR4
        28 004733   500003 236100                    LDQ     3,,PR5
        28 004734   200000 316003                    CANQ    65536,DU
        28 004735   004742 600000 28                 TZE     s:26681

     2168    26679    2            MKCN.CON = TARGET_NO# + 2;

  26679 28 004736   200250 235100                    LDA     TARGET_NO#,,AUTO
        28 004737   000002 035007                    ADLA    2,DL
        28 004740   000000 755000 24                 STA     MKCN
        28 004741   004745 710000 28                 TRA     s:26683

     2169    26680    2          ELSE
     2170    26681    2            MKCN.CON = TARGET_NO# + 1;

  26681 28 004742   200250 235100                    LDA     TARGET_NO#,,AUTO
        28 004743   000001 035007                    ADLA    1,DL
        28 004744   000000 755000 24                 STA     MKCN
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:359  

     2171    26682
     2172    26683    2          CALL Z8AC$MAKE_CONST (CONST_ETT$);

  26683 28 004745   200011 633500                    EPPR3   CONST_ETT$,,AUTO
        28 004746   200252 453500                    STP3    CETT$$+1,,AUTO
        28 004747   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004750   000034 631400 29                 EPPR1   28
        28 004751   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        28 004752   000000 011000                    NOP     0

     2173    26684
     2174    26685    2          CALL Z8AF$FORME (%CMPI,

  26685 28 004753   200251 630500                    EPPR0   CETT$$,,AUTO
        28 004754   200255 450500                    STP0    CETT$$+4,,AUTO
        28 004755   200011 631500                    EPPR1   CONST_ETT$,,AUTO
        28 004756   200254 451500                    STP1    CETT$$+3,,AUTO
        28 004757   200204 633500                    EPPR3   CTR_LVL_ETT$,,AUTO
        28 004760   200253 453500                    STP3    CETT$$+2,,AUTO
        28 004761   000056 236000 29                 LDQ     46
        28 004762   200252 756100                    STQ     CETT$$+1,,AUTO
        28 004763   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004764   000003 631400 29                 EPPR1   3
        28 004765   000000 701000 xent               TSX1    Z8AF$FORME
        28 004766   000000 011000                    NOP     0

     2175    26686    2                           CTR_LVL_ETT$,
     2176    26687    2                           CONST_ETT$,
     2177    26688    2                           CETT$$);
     2178    26689
     2179    26690    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, END_LABEL$);

  26690 28 004767   200245 630500                    EPPR0   END_LABEL$,,AUTO
        28 004770   200253 450500                    STP0    CETT$$+2,,AUTO
        28 004771   000002 236000 29                 LDQ     2
        28 004772   200252 756100                    STQ     CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:360  
        28 004773   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 004774   000000 631400 29                 EPPR1   0
        28 004775   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 004776   000000 011000                    NOP     0

     2180    26691
     2181    26692    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, START_LABEL$);

  26692 28 004777   200246 630500                    EPPR0   START_LABEL$,,AUTO
        28 005000   200253 450500                    STP0    CETT$$+2,,AUTO
        28 005001   000002 236000 29                 LDQ     2
        28 005002   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005003   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005004   000000 631400 29                 EPPR1   0
        28 005005   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 005006   000000 011000                    NOP     0

     2182    26693
     2183    26694    2          START_LABEL$ -> LABEL.B.GO_VECTOR_START = TRUE;

  26694 28 005007   200246 470500                    LDP0    START_LABEL$,,AUTO
        28 005010   000004 236003                    LDQ     4,DU
        28 005011   000003 256100                    ORSQ    3,,PR0

     2184    26695    2          START_LABEL$ -> LABEL.P_END$ = END_LABEL$;

  26695 28 005012   200245 236100                    LDQ     END_LABEL$,,AUTO
        28 005013   200246 470500                    LDP0    START_LABEL$,,AUTO
        28 005014   000001 756100                    STQ     1,,PR0

     2185    26696
     2186    26697    2          CALL Z8AF$NEW_BASE (START_LABEL$,

  26697 28 005015   000017 236000 29                 LDQ     15
        28 005016   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005017   200244 630500                    EPPR0   ETT$$,,AUTO
        28 005020   200255 450500                    STP0    CETT$$+4,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:361  
        28 005021   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 005022   200254 451500                    STP1    CETT$$+3,,AUTO
        28 005023   200246 633500                    EPPR3   START_LABEL$,,AUTO
        28 005024   200253 453500                    STP3    CETT$$+2,,AUTO
        28 005025   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 005026   000030 631400 29                 EPPR1   24
        28 005027   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 005030   000000 011000                    NOP     0

     2187    26698    2                              ADDR(NIL),
     2188    26699    2                              ETT$$);
     2189    26700    2          CALL Z8AF$FORME (%SSOP,

  26700 28 005031   200244 630500                    EPPR0   ETT$$,,AUTO
        28 005032   200255 450500                    STP0    CETT$$+4,,AUTO
        28 005033   200204 631500                    EPPR1   CTR_LVL_ETT$,,AUTO
        28 005034   200254 451500                    STP1    CETT$$+3,,AUTO
        28 005035   200244 633500                    EPPR3   ETT$$,,AUTO
        28 005036   200253 453500                    STP3    CETT$$+2,,AUTO
        28 005037   000045 236000 29                 LDQ     37
        28 005040   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005041   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005042   000003 631400 29                 EPPR1   3
        28 005043   000000 701000 xent               TSX1    Z8AF$FORME
        28 005044   000000 011000                    NOP     0

     2190    26701    2                           ETT$$,
     2191    26702    2                           CTR_LVL_ETT$,
     2192    26703    2                           ETT$$);
     2193    26704
     2194    26705               %NEW_ILL (@ID   = %GO,
     2195    26706                         @CODE = %GO_LESS_THAN_LOGICAL,
     2196    26707                         @LOP  = ETT$$,
     2197    26708                         @ROP  = CETT$$);

  26898 28 005045   000006 236000 29                 LDQ     6
        28 005046   200252 756100                    STQ     CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:362  
        28 005047   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005050   200257 450500                    STP0    CETT$$+6,,AUTO
        28 005051   000007 236000 29                 LDQ     7
        28 005052   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005053   000060 237000 29                 LDAQ    48
        28 005054   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005055   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005056   000003 631400 29                 EPPR1   3
        28 005057   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005060   000000 011000                    NOP     0

  26899 28 005061   000027 220003                    LDX0    23,DU
        28 005062   000000 470400 18                 LDP0    ILL$
        28 005063   000000 440100                    SXL0    0,,PR0

  26900 28 005064   200244 236100                    LDQ     ETT$$,,AUTO
        28 005065   000000 470400 18                 LDP0    ILL$
        28 005066   000001 756100                    STQ     1,,PR0

  26901 28 005067   200251 236100                    LDQ     CETT$$,,AUTO
        28 005070   000002 756100                    STQ     2,,PR0

     2198    27087
     2199    27088               %NEW_ILL (@ID = %DEFLB,
     2200    27089                         @LABEL$ = START_LABEL$);

  27421 28 005071   000006 236000 29                 LDQ     6
        28 005072   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005073   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 005074   200257 451500                    STP1    CETT$$+6,,AUTO
        28 005075   000007 236000 29                 LDQ     7
        28 005076   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005077   000010 237000 29                 LDAQ    8
        28 005100   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005101   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005102   000003 631400 29                 EPPR1   3
        28 005103   000000 701000 xent               TSX1    Z8AN$NEW_ILL
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:363  
        28 005104   000000 011000                    NOP     0

  27422 28 005105   200246 236100                    LDQ     START_LABEL$,,AUTO
        28 005106   000000 470400 18                 LDP0    ILL$
        28 005107   000001 756100                    STQ     1,,PR0

     2201    27468
     2202    27469    2          CALL Z8EK$BRANCH (END_LABEL$);

  27469 28 005110   200245 631500                    EPPR1   END_LABEL$,,AUTO
        28 005111   200252 451500                    STP1    CETT$$+1,,AUTO
        28 005112   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005113   000034 631400 29                 EPPR1   28
        28 005114   000000 701000 xent               TSX1    Z8EK$BRANCH
        28 005115   000000 011000                    NOP     0

     2203    27470
     2204    27471    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, LBL$$ (1));

  27471 28 005116   200213 630500                    EPPR0   NEXT$,,AUTO
        28 005117   200253 450500                    STP0    CETT$$+2,,AUTO
        28 005120   000002 236000 29                 LDQ     2
        28 005121   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005122   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005123   000000 631400 29                 EPPR1   0
        28 005124   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 005125   000000 011000                    NOP     0

     2205    27472
     2206    27473    2          CALL Z8EK$BRANCH (LBL$$(1));

  27473 28 005126   200213 630500                    EPPR0   NEXT$,,AUTO
        28 005127   200252 450500                    STP0    CETT$$+1,,AUTO
        28 005130   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005131   000034 631400 29                 EPPR1   28
        28 005132   000000 701000 xent               TSX1    Z8EK$BRANCH
        28 005133   000000 011000                    NOP     0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:364  

     2207    27474
     2208    27475    2          IF LTS$$ -> REPORT_LTS.B.CONTROL_FINAL THEN

  27475 28 005134   200003 470500                    LDP0    @LTS$$,,AUTO
        28 005135   000000 471500                    LDP1    0,,PR0
        28 005136   100003 236100                    LDQ     3,,PR1
        28 005137   200000 316003                    CANQ    65536,DU
        28 005140   005147 600000 28                 TZE     s:27479

     2209    27476
     2210    27477    2            CALL Z8EK$BRANCH (LBL$$(1));

  27477 28 005141   200213 633500                    EPPR3   NEXT$,,AUTO
        28 005142   200252 453500                    STP3    CETT$$+1,,AUTO
        28 005143   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005144   000034 631400 29                 EPPR1   28
        28 005145   000000 701000 xent               TSX1    Z8EK$BRANCH
        28 005146   000000 011000                    NOP     0

     2211    27478
     2212    27479    3          DO I = 2 TO TARGET_NO#;

  27479 28 005147   000002 235007                    LDA     2,DL
        28 005150   200007 755100                    STA     I,,AUTO
        28 005151   005173 710000 28                 TRA     s:27485+1

     2213    27480
     2214    27481    3            CALL Z8AT$CREATE_TEMPORARY (%PARA, LBL$$ (I));

  27481 28 005152   200007 720100                    LXL0    I,,AUTO
        28 005153   200212 630510                    EPPR0   LBL$$,X0,AUTO
        28 005154   200253 450500                    STP0    CETT$$+2,,AUTO
        28 005155   000002 236000 29                 LDQ     2
        28 005156   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005157   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005160   000000 631400 29                 EPPR1   0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:365  
        28 005161   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 005162   000000 011000                    NOP     0

     2215    27482
     2216    27483    3            CALL Z8EK$BRANCH (LBL$$(I));

  27483 28 005163   200007 720100                    LXL0    I,,AUTO
        28 005164   200212 630510                    EPPR0   LBL$$,X0,AUTO
        28 005165   200252 450500                    STP0    CETT$$+1,,AUTO
        28 005166   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005167   000034 631400 29                 EPPR1   28
        28 005170   000000 701000 xent               TSX1    Z8EK$BRANCH
        28 005171   000000 011000                    NOP     0

     2217    27484
     2218    27485    3          END;

  27485 28 005172   200007 054100                    AOS     I,,AUTO
        28 005173   200007 236100                    LDQ     I,,AUTO
        28 005174   200250 116100                    CMPQ    TARGET_NO#,,AUTO
        28 005175   005152 604400 28                 TMOZ    s:27481

     2219    27486
     2220    27487
     2221    27488    3          DO I = 1 TO TARGET_NO#;

  27488 28 005176   000001 235007                    LDA     1,DL
        28 005177   200007 755100                    STA     I,,AUTO
        28 005200   005265 710000 28                 TRA     s:27881+1

     2222    27489    3            NAME$$ = CONTROL$$ -> LTS_PTR_ARRAY.P$(I);

  27489 28 005201   200207 470500                    LDP0    @CONTROL$$,,AUTO
        28 005202   000000 471500                    LDP1    0,,PR0
        28 005203   200007 720100                    LXL0    I,,AUTO
        28 005204   100002 236110                    LDQ     2,X0,PR1
        28 005205   200247 756100                    STQ     NAME$$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:366  

     2223    27490
     2224    27491                 %NEW_ILL (@ID    = %DEFLB,
     2225    27492                           @LABEL$ = "LBL$$(I)");

  27824 28 005206   000006 236000 29                 LDQ     6
        28 005207   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005210   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 005211   200257 451500                    STP1    CETT$$+6,,AUTO
        28 005212   000007 236000 29                 LDQ     7
        28 005213   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005214   000010 237000 29                 LDAQ    8
        28 005215   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005216   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005217   000003 631400 29                 EPPR1   3
        28 005220   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005221   000000 011000                    NOP     0

  27825 28 005222   200007 720100                    LXL0    I,,AUTO
        28 005223   200212 236110                    LDQ     LBL$$,X0,AUTO
        28 005224   000000 470400 18                 LDP0    ILL$
        28 005225   000001 756100                    STQ     1,,PR0

     2226    27871
     2227    27872    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.TEMP_FIELD$,

  27872 28 005226   200247 236100                    LDQ     NAME$$,,AUTO
        28 005227   000013 036003                    ADLQ    11,DU
        28 005230   200253 756100                    STQ     CETT$$+2,,AUTO
        28 005231   200247 236100                    LDQ     NAME$$,,AUTO
        28 005232   000014 036003                    ADLQ    12,DU
        28 005233   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005234   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005235   000000 631400 29                 EPPR1   0
        28 005236   000000 701000 xent               TSX1    Z8E7$MOVE
        28 005237   000000 011000                    NOP     0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:367  
     2228    27873    3                            NAME$$ -> CONTROL_NAME_LTS.ST_FIELD$);
     2229    27874
     2230    27875    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.ST_FIELD$,

  27875 28 005240   200247 236100                    LDQ     NAME$$,,AUTO
        28 005241   000015 036003                    ADLQ    13,DU
        28 005242   200253 756100                    STQ     CETT$$+2,,AUTO
        28 005243   200247 236100                    LDQ     NAME$$,,AUTO
        28 005244   000013 036003                    ADLQ    11,DU
        28 005245   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005246   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005247   000000 631400 29                 EPPR1   0
        28 005250   000000 701000 xent               TSX1    Z8E7$MOVE
        28 005251   000000 011000                    NOP     0

     2231    27876    3                            NAME$$ -> CONTROL_NAME_LTS.SHADOW_FIELD$);
     2232    27877
     2233    27878    3            CALL Z8E7$MOVE (NAME$$ -> CONTROL_NAME_LTS.SHADOW_FIELD$,

  27878 28 005252   200247 236100                    LDQ     NAME$$,,AUTO
        28 005253   000014 036003                    ADLQ    12,DU
        28 005254   200253 756100                    STQ     CETT$$+2,,AUTO
        28 005255   200247 236100                    LDQ     NAME$$,,AUTO
        28 005256   000015 036003                    ADLQ    13,DU
        28 005257   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005260   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005261   000000 631400 29                 EPPR1   0
        28 005262   000000 701000 xent               TSX1    Z8E7$MOVE
        28 005263   000000 011000                    NOP     0

     2234    27879    3                            NAME$$ -> CONTROL_NAME_LTS.TEMP_FIELD$);
     2235    27880
     2236    27881    3          END; /* DO LOOP */

  27881 28 005264   200007 054100                    AOS     I,,AUTO
        28 005265   200007 236100                    LDQ     I,,AUTO
        28 005266   200250 116100                    CMPQ    TARGET_NO#,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:368  
        28 005267   005201 604400 28                 TMOZ    s:27489

     2237    27882
     2238    27883               %NEW_ILL (@ID   = %DEFLB,
     2239    27884                         @LABEL$ = END_LABEL$);

  28216 28 005270   000006 236000 29                 LDQ     6
        28 005271   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005272   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005273   200257 450500                    STP0    CETT$$+6,,AUTO
        28 005274   000007 236000 29                 LDQ     7
        28 005275   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005276   000010 237000 29                 LDAQ    8
        28 005277   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005300   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005301   000003 631400 29                 EPPR1   3
        28 005302   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005303   000000 011000                    NOP     0

  28217 28 005304   200245 236100                    LDQ     END_LABEL$,,AUTO
        28 005305   000000 470400 18                 LDP0    ILL$
        28 005306   000001 756100                    STQ     1,,PR0

     2240    28263
     2241    28264               %DB_EXCEPT_LIBRARY_RETURN;

  28474 28 005307   000006 236000 29                 LDQ     6
        28 005310   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005311   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 005312   200257 451500                    STP1    CETT$$+6,,AUTO
        28 005313   000007 236000 29                 LDQ     7
        28 005314   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005315   000032 237000 29                 LDAQ    26
        28 005316   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005317   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005320   000003 631400 29                 EPPR1   3
        28 005321   000000 701000 xent               TSX1    Z8AN$NEW_ILL
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:369  
        28 005322   000000 011000                    NOP     0

  28475 28 005323   000001 220003                    LDX0    1,DU
        28 005324   000000 470400 18                 LDP0    ILL$
        28 005325   000000 440100                    SXL0    0,,PR0

  28479 28 005326   000057 470400 xsym               LDP0    O1COM+47
        28 005327   000006 236100                    LDQ     6,,PR0
        28 005330   000000 471400 18                 LDP1    ILL$
        28 005331   100001 756100                    STQ     1,,PR1

     2242    28648
     2243    28649    2    END CREATE_SHADOW_SWAP_SUB;

  28649 28 005332   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 005333   000001 702211                    TSX2  ! 1,X1

     2244    28650         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:370  
     2245    28651
     2246    28652         /*============*/
     2247    28653    1      GEN_ADD_CODE: PROC (ADD_LIST$);

  28653 28 005334   200214 741300       GEN_ADD_CODE STX1  ! LABEL$,,AUTO

     2248    28654         /*============*/
     2249    28655
     2250    28656        /*I*
     2251    28657
     2252    28658             NAME:  GEN_ADD_CODE
     2253    28659
     2254    28660          DESCRIPTION: This routine creates ILL item of the "add" operation
     2255    28661                       for the calling module.
     2256    28662        */
     2257    28663
     2258    28664
     2259    28665    2   DCL ADD_LIST$      PTR;
     2260    28666    2   DCL BIN_OP$        PTR;
     2261    28667        %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
     2262    28671
     2263    28672
     2264    28673
     2265    28674    2          BIN_OP$ = ADD_LIST$;

  28674 28 005335   200215 470500                    LDP0    @ADD_LIST$,,AUTO
        28 005336   000000 236100                    LDQ     0,,PR0
        28 005337   200216 756100                    STQ     BIN_OP$,,AUTO

     2266    28675
     2267    28676    3          DO WHILE (BIN_OP$ ~= ADDR(NIL));

  28676 28 005340   005371 710000 28                 TRA     s:28686

     2268    28677
     2269    28678    3              CALL Z8E5$MATH_PACK (BIN_OP$,

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:371  
  28678 28 005341   200220 630500                    EPPR0   ETT_ITEM,,AUTO
        28 005342   200252 450500                    STP0    CETT$$+1,,AUTO
        28 005343   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 005344   200255 451500                    STP1    CETT$$+4,,AUTO
        28 005345   200216 633500                    EPPR3   BIN_OP$,,AUTO
        28 005346   200254 453500                    STP3    CETT$$+3,,AUTO
        28 005347   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005350   000000 631400 29                 EPPR1   0
        28 005351   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        28 005352   000000 011000                    NOP     0

     2270    28679    3                                   ADDR(ETT_ITEM));
     2271    28680
     2272    28681    3              CALL Z8E7$MOVE (BIN_OP$ -> BINARY_OP.LOP$,

  28681 28 005353   200220 630500                    EPPR0   ETT_ITEM,,AUTO
        28 005354   200252 450500                    STP0    CETT$$+1,,AUTO
        28 005355   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 005356   200255 451500                    STP1    CETT$$+4,,AUTO
        28 005357   200216 236100                    LDQ     BIN_OP$,,AUTO
        28 005360   000001 036003                    ADLQ    1,DU
        28 005361   200254 756100                    STQ     CETT$$+3,,AUTO
        28 005362   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005363   000000 631400 29                 EPPR1   0
        28 005364   000000 701000 xent               TSX1    Z8E7$MOVE
        28 005365   000000 011000                    NOP     0

     2273    28682    3                              ADDR(ETT_ITEM));
     2274    28683
     2275    28684    3              BIN_OP$ = BIN_OP$ -> BINARY_OP.LINK;

  28684 28 005366   200216 470500                    LDP0    BIN_OP$,,AUTO
        28 005367   000007 236100                    LDQ     7,,PR0
        28 005370   200216 756100                    STQ     BIN_OP$,,AUTO

     2276    28685
     2277    28686    3          END; /* WHILE */
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:372  

  28686 28 005371   000017 116000 29                 CMPQ    15
        28 005372   005341 601000 28                 TNZ     s:28678

     2278    28687
     2279    28688    2    END GEN_ADD_CODE;

  28688 28 005373   200214 221300                    LDX1  ! LABEL$,,AUTO
        28 005374   000001 702211                    TSX2  ! 1,X1

     2280    28689         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:373  
     2281    28690
     2282    28691         /*=============*/
     2283    28692    1      GEN_CLEAR_SUB: PROC (GROUP$$);

  28692 28 005375   200210 741300       GEN_CLEAR_S* STX1  ! LABEL$,,AUTO

     2284    28693         /*=============*/
     2285    28694
     2286    28695        /*I*
     2287    28696
     2288    28697             NAME:  GEN_CLEAR_SUB
     2289    28698
     2290    28699          DESCRIPTION: This routine creates sum counter clear subroutine
     2291    28700                       that will executed by the RWCS to clear the sum
     2292    28701                       counter after the control footing is presented.
     2293    28702        */
     2294    28703
     2295    28704
     2296    28705    2   DCL GROUP$$        PTR;
     2297    28706    2   DCL LABEL$         PTR;
     2298    28707    2   DCL SUM$$          PTR;
     2299    28708
     2300    28709
     2301    28710
     2302    28711    2          IF GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_NAME_LTS.START_OFFSET

  28711 28 005376   200211 470500                    LDP0    @GROUP$$,,AUTO
        28 005377   000000 471500                    LDP1    0,,PR0
        28 005400   100014 473500                    LDP3    12,,PR1
        28 005401   300016 235100                    LDA     14,,PR3
        28 005402   000031 115007                    CMPA    25,DL
        28 005403   005622 604000 28                 TMI     s:30295

     2303    28712    2              >= %CTR_TBL_START_OFF THEN
     2304    28713    3            DO;

     2305    28714
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:374  
     2306    28715                  %SUB_HEAD (OFFSET_V = "GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_N
             28715        AME_LTS.START_OFFSET + %SUM_CLEAR_SUB_OFF",
     2307    28716                              RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);

  28718 28 005404   200212 634500                    EPPR4   LABEL$,,AUTO
        28 005405   200253 454500                    STP4    CETT$$+2,,AUTO
        28 005406   000002 236000 29                 LDQ     2
        28 005407   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005410   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005411   000000 631400 29                 EPPR1   0
        28 005412   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 005413   000000 011000                    NOP     0

  28719 28 005414   200212 470500                    LDP0    LABEL$,,AUTO
        28 005415   400000 236003                    LDQ     -131072,DU
        28 005416   000003 256100                    ORSQ    3,,PR0

  28720 28 005417   200212 470500                    LDP0    LABEL$,,AUTO
        28 005420   001000 236007                    LDQ     512,DL
        28 005421   000003 256100                    ORSQ    3,,PR0

  29054 28 005422   000006 236000 29                 LDQ     6
        28 005423   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005424   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005425   200257 450500                    STP0    CETT$$+6,,AUTO
        28 005426   000007 236000 29                 LDQ     7
        28 005427   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005430   000010 237000 29                 LDAQ    8
        28 005431   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005432   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005433   000003 631400 29                 EPPR1   3
        28 005434   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005435   000000 011000                    NOP     0

  29055 28 005436   200212 236100                    LDQ     LABEL$,,AUTO
        28 005437   000000 470400 18                 LDP0    ILL$
        28 005440   000001 756100                    STQ     1,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:375  

  29362 28 005441   000006 236000 29                 LDQ     6
        28 005442   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005443   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 005444   200257 451500                    STP1    CETT$$+6,,AUTO
        28 005445   000007 236000 29                 LDQ     7
        28 005446   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005447   000014 237000 29                 LDAQ    12
        28 005450   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005451   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005452   000003 631400 29                 EPPR1   3
        28 005453   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005454   000000 011000                    NOP     0

  29366 28 005455   200211 470500                    LDP0    @GROUP$$,,AUTO
        28 005456   000000 471500                    LDP1    0,,PR0
        28 005457   100014 473500                    LDP3    12,,PR1
        28 005460   300016 720100                    LXL0    14,,PR3
        28 005461   000004 621010                    EAX1    4,X0
        28 005462   000000 474400 18                 LDP4    ILL$
        28 005463   400000 441100                    SXL1    0,,PR4

  29368 28 005464   000000 471400 18                 LDP1    ILL$
        28 005465   100002 450100                    STZ     2,,PR1

  29369 28 005466   200212 236100                    LDQ     LABEL$,,AUTO
        28 005467   100001 756100                    STQ     1,,PR1

  29370 28 005470   200003 473500                    LDP3    @LTS$$,,AUTO
        28 005471   300000 474500                    LDP4    0,,PR3
        28 005472   400022 236100                    LDQ     18,,PR4
        28 005473   100003 756100                    STQ     3,,PR1

  29692 28 005474   000006 236000 29                 LDQ     6
        28 005475   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005476   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 005477   200257 454500                    STP4    CETT$$+6,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:376  
        28 005500   000007 236000 29                 LDQ     7
        28 005501   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005502   000020 237000 29                 LDAQ    16
        28 005503   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005504   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005505   000003 631400 29                 EPPR1   3
        28 005506   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005507   000000 011000                    NOP     0

  29693 28 005510   000001 220003                    LDX0    1,DU
        28 005511   000000 470400 18                 LDP0    ILL$
        28 005512   000000 440100                    SXL0    0,,PR0

  29697 28 005513   000057 470400 xsym               LDP0    O1COM+47
        28 005514   000006 236100                    LDQ     6,,PR0
        28 005515   000000 471400 18                 LDP1    ILL$
        28 005516   100001 756100                    STQ     1,,PR1

     2308    29866
     2309    29867    3              SUM$$ = GROUP$$;

  29867 28 005517   200211 470500                    LDP0    @GROUP$$,,AUTO
        28 005520   000000 236100                    LDQ     0,,PR0
        28 005521   200213 756100                    STQ     SUM$$,,AUTO

     2310    29868
     2311    29869    4              DO WHILE (SUM$$ ~= ADDR(NIL));

  29869 28 005522   005575 710000 28                 TRA     s:29907

     2312    29870
     2313    29871    4                IF SUM$$ -> REPORT_ELEM_LTS.ID = %REPORT_ELEM_LTS AND

  29871 28 005523   200213 470500                    LDP0    SUM$$,,AUTO
        28 005524   000000 220100                    LDX0    0,,PR0
        28 005525   001102 100003                    CMPX0   578,DU
        28 005526   005572 601000 28                 TNZ     s:29905
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:377  
        28 005527   000000 236100                    LDQ     0,,PR0
        28 005530   040000 316007                    CANQ    16384,DL
        28 005531   005572 600000 28                 TZE     s:29905

     2314    29872    4                   SUM$$ -> REPORT_ELEM_LTS.B.SUM_PRESENTED THEN
     2315    29873    4                  IF NOT SUM$$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.B.RESETED THEN

  29873 28 005532   000012 471500                    LDP1    10,,PR0
        28 005533   100000 236100                    LDQ     0,,PR1
        28 005534   400000 316007                    CANQ    -131072,DL
        28 005535   005572 601000 28                 TNZ     s:29905

     2316    29874    5                    DO;

     2317    29875
     2318    29876                           %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     2319    29877                                              @TYPE    = %TYD,
     2320    29878                                @ETT$ =
             29878                                 "SUM$$ -> REPORT_ELEM_LTS.SUM_LTS$ -> SUM_LTS.SUM_ST_ILL$"
             29878                                    );

  29880 28 005536   000004 221003                    LDX1    4,DU
        28 005537   200104 741100                    STX1    RECV_FIELD,,AUTO

  29881 28 005540   000000 220003                    LDX0    0,DU
        28 005541   200104 440100                    SXL0    RECV_FIELD,,AUTO

  29882 28 005542   200110 450100                    STZ     RECV_FIELD+4,,AUTO

  29883 28 005543   000017 236000 29                 LDQ     15
        28 005544   200113 756100                    STQ     RECV_FIELD+7,,AUTO

  29884 28 005545   000012 471500                    LDP1    10,,PR0
        28 005546   100004 236100                    LDQ     4,,PR1
        28 005547   200105 756100                    STQ     RECV_FIELD+1,,AUTO

  29885 28 005550   000017 236000 29                 LDQ     15
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:378  
        28 005551   200106 756100                    STQ     RECV_FIELD+2,,AUTO

  29887 28 005552   000133 235000 xsym               LDA     COMCOM+91
        28 005553   200111 755100                    STA     RECV_FIELD+5,,AUTO

  29888 28 005554   000134 235000 xsym               LDA     COMCOM+92
        28 005555   200112 755100                    STA     RECV_FIELD+6,,AUTO

     2321    29900
     2322    29901    5                      CALL Z8E7$MOVE (ADDR(RECV_FIELD),

  29901 28 005556   200104 631500                    EPPR1   RECV_FIELD,,AUTO
        28 005557   200252 451500                    STP1    CETT$$+1,,AUTO
        28 005560   200134 633500                    EPPR3   ZERO,,AUTO
        28 005561   200253 453500                    STP3    CETT$$+2,,AUTO
        28 005562   200253 634500                    EPPR4   CETT$$+2,,AUTO
        28 005563   200255 454500                    STP4    CETT$$+4,,AUTO
        28 005564   200252 635500                    EPPR5   CETT$$+1,,AUTO
        28 005565   200254 455500                    STP5    CETT$$+3,,AUTO
        28 005566   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005567   000000 631400 29                 EPPR1   0
        28 005570   000000 701000 xent               TSX1    Z8E7$MOVE
        28 005571   000000 011000                    NOP     0

     2323    29902    5                                      ADDR(ZERO));
     2324    29903    5                    END;

     2325    29904
     2326    29905    4                  SUM$$ = SUM$$ -> REPORT_ELEM_LTS.NEXT;

  29905 28 005572   200213 470500                    LDP0    SUM$$,,AUTO
        28 005573   000006 236100                    LDQ     6,,PR0
        28 005574   200213 756100                    STQ     SUM$$,,AUTO

     2327    29906
     2328    29907    4              END;  /* WHILE */

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:379  
  29907 28 005575   000017 116000 29                 CMPQ    15
        28 005576   005523 601000 28                 TNZ     s:29871

     2329    29908
     2330    29909                   %DB_EXCEPT_LIBRARY_RETURN;

  30119 28 005577   000006 236000 29                 LDQ     6
        28 005600   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005601   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005602   200257 450500                    STP0    CETT$$+6,,AUTO
        28 005603   000007 236000 29                 LDQ     7
        28 005604   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005605   000032 237000 29                 LDAQ    26
        28 005606   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005607   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005610   000003 631400 29                 EPPR1   3
        28 005611   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005612   000000 011000                    NOP     0

  30120 28 005613   000001 220003                    LDX0    1,DU
        28 005614   000000 470400 18                 LDP0    ILL$
        28 005615   000000 440100                    SXL0    0,,PR0

  30124 28 005616   000057 470400 xsym               LDP0    O1COM+47
        28 005617   000006 236100                    LDQ     6,,PR0
        28 005620   000000 471400 18                 LDP1    ILL$
        28 005621   100001 756100                    STQ     1,,PR1

     2331    30293    3          END;

     2332    30294
     2333    30295    2    END GEN_CLEAR_SUB;

  30295 28 005622   200210 221300                    LDX1  ! LABEL$,,AUTO
        28 005623   000001 702211                    TSX2  ! 1,X1

     2334    30296         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:380  
     2335    30297
     2336    30298
     2337    30299        /*==================*/
     2338    30300    1     GEN_CROSS_ROLL_SUB: PROC (GROUP$$);

  30300 28 005624   200210 741300       GEN_CROSS_R* STX1  ! LABEL$,,AUTO

     2339    30301        /*==================*/
     2340    30302
     2341    30303        /*I*
     2342    30304
     2343    30305             NAME:  GEN_CROSS_ROLL_SUB
     2344    30306
     2345    30307          DESCRIPTION: This routine creates cross footing/rolling forward
     2346    30308                       subroutine that will executed by the RWCS to sum up
     2347    30309                       the sum counter to another sum counter.
     2348    30310        */
     2349    30311
     2350    30312    2   DCL GROUP$$        PTR;
     2351    30313    2   DCL LABEL$         PTR;
     2352    30314
     2353    30315
     2354    30316
     2355    30317    2          IF GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_NAME_LTS.START_OFFSET

  30317 28 005625   200211 470500                    LDP0    @GROUP$$,,AUTO
        28 005626   000000 471500                    LDP1    0,,PR0
        28 005627   100014 473500                    LDP3    12,,PR1
        28 005630   300016 235100                    LDA     14,,PR3
        28 005631   000031 115007                    CMPA    25,DL
        28 005632   006000 604000 28                 TMI     s:31862

     2356    30318    2              >= %CTR_TBL_START_OFF THEN
     2357    30319    3            DO;

     2358    30320
     2359    30321                  %SUB_HEAD (OFFSET_V = "GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ -> CONTROL_N
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:381  
             30321        AME_LTS.START_OFFSET + %CROSS_ROLL_SUB_OFF",
     2360    30322                              RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);

  30324 28 005633   200212 634500                    EPPR4   LABEL$,,AUTO
        28 005634   200253 454500                    STP4    CETT$$+2,,AUTO
        28 005635   000002 236000 29                 LDQ     2
        28 005636   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005637   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005640   000000 631400 29                 EPPR1   0
        28 005641   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 005642   000000 011000                    NOP     0

  30325 28 005643   200212 470500                    LDP0    LABEL$,,AUTO
        28 005644   400000 236003                    LDQ     -131072,DU
        28 005645   000003 256100                    ORSQ    3,,PR0

  30326 28 005646   200212 470500                    LDP0    LABEL$,,AUTO
        28 005647   001000 236007                    LDQ     512,DL
        28 005650   000003 256100                    ORSQ    3,,PR0

  30660 28 005651   000006 236000 29                 LDQ     6
        28 005652   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005653   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005654   200257 450500                    STP0    CETT$$+6,,AUTO
        28 005655   000007 236000 29                 LDQ     7
        28 005656   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005657   000010 237000 29                 LDAQ    8
        28 005660   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005661   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005662   000003 631400 29                 EPPR1   3
        28 005663   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005664   000000 011000                    NOP     0

  30661 28 005665   200212 236100                    LDQ     LABEL$,,AUTO
        28 005666   000000 470400 18                 LDP0    ILL$
        28 005667   000001 756100                    STQ     1,,PR0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:382  
  30968 28 005670   000006 236000 29                 LDQ     6
        28 005671   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005672   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 005673   200257 451500                    STP1    CETT$$+6,,AUTO
        28 005674   000007 236000 29                 LDQ     7
        28 005675   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005676   000014 237000 29                 LDAQ    12
        28 005677   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005700   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005701   000003 631400 29                 EPPR1   3
        28 005702   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005703   000000 011000                    NOP     0

  30972 28 005704   200211 470500                    LDP0    @GROUP$$,,AUTO
        28 005705   000000 471500                    LDP1    0,,PR0
        28 005706   100014 473500                    LDP3    12,,PR1
        28 005707   300016 720100                    LXL0    14,,PR3
        28 005710   000003 621010                    EAX1    3,X0
        28 005711   000000 474400 18                 LDP4    ILL$
        28 005712   400000 441100                    SXL1    0,,PR4

  30974 28 005713   000000 471400 18                 LDP1    ILL$
        28 005714   100002 450100                    STZ     2,,PR1

  30975 28 005715   200212 236100                    LDQ     LABEL$,,AUTO
        28 005716   100001 756100                    STQ     1,,PR1

  30976 28 005717   200003 473500                    LDP3    @LTS$$,,AUTO
        28 005720   300000 474500                    LDP4    0,,PR3
        28 005721   400022 236100                    LDQ     18,,PR4
        28 005722   100003 756100                    STQ     3,,PR1

  31298 28 005723   000006 236000 29                 LDQ     6
        28 005724   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005725   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 005726   200257 454500                    STP4    CETT$$+6,,AUTO
        28 005727   000007 236000 29                 LDQ     7
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:383  
        28 005730   200256 756100                    STQ     CETT$$+5,,AUTO
        28 005731   000020 237000 29                 LDAQ    16
        28 005732   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005733   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005734   000003 631400 29                 EPPR1   3
        28 005735   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005736   000000 011000                    NOP     0

  31299 28 005737   000001 220003                    LDX0    1,DU
        28 005740   000000 470400 18                 LDP0    ILL$
        28 005741   000000 440100                    SXL0    0,,PR0

  31303 28 005742   000057 470400 xsym               LDP0    O1COM+47
        28 005743   000006 236100                    LDQ     6,,PR0
        28 005744   000000 471400 18                 LDP1    ILL$
        28 005745   100001 756100                    STQ     1,,PR1

     2361    31472    3              CALL GEN_ADD_CODE (GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ ->

  31472 28 005746   200211 470500                    LDP0    @GROUP$$,,AUTO
        28 005747   000000 473500                    LDP3    0,,PR0
        28 005750   300014 474500                    LDP4    12,,PR3
        28 005751   400005 635500                    EPPR5   5,,PR4
        28 005752   200215 455500                    STP5    @ADD_LIST$,,AUTO
        28 005753   005334 701000 28                 TSX1    GEN_ADD_CODE
        28 005754   000000 011000                    NOP     0

     2362    31473    3                                 CONTROL_NAME_LTS.SUM_SUBTOTAL$);
     2363    31474
     2364    31475                   %DB_EXCEPT_LIBRARY_RETURN;

  31685 28 005755   000006 236000 29                 LDQ     6
        28 005756   200252 756100                    STQ     CETT$$+1,,AUTO
        28 005757   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 005760   200257 450500                    STP0    CETT$$+6,,AUTO
        28 005761   000007 236000 29                 LDQ     7
        28 005762   200256 756100                    STQ     CETT$$+5,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:384  
        28 005763   000032 237000 29                 LDAQ    26
        28 005764   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 005765   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 005766   000003 631400 29                 EPPR1   3
        28 005767   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 005770   000000 011000                    NOP     0

  31686 28 005771   000001 220003                    LDX0    1,DU
        28 005772   000000 470400 18                 LDP0    ILL$
        28 005773   000000 440100                    SXL0    0,,PR0

  31690 28 005774   000057 470400 xsym               LDP0    O1COM+47
        28 005775   000006 236100                    LDQ     6,,PR0
        28 005776   000000 471400 18                 LDP1    ILL$
        28 005777   100001 756100                    STQ     1,,PR1

     2365    31859
     2366    31860    3            END;

     2367    31861
     2368    31862    2    END GEN_CROSS_ROLL_SUB;

  31862 28 006000   200210 221300                    LDX1  ! LABEL$,,AUTO
        28 006001   000001 702211                    TSX2  ! 1,X1

     2369    31863         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:385  
     2370    31864
     2371    31865
     2372    31866        /*=============*/
     2373    31867    1     GEN_RESET_SUB: PROC (CONTROL_LTS$);

  31867 28 006002   200206 741300       GEN_RESET_S* STX1  ! CTR_LVL_ETT$+2,,AUTO

     2374    31868        /*=============*/
     2375    31869
     2376    31870        /*I*
     2377    31871
     2378    31872             NAME:  GEN_RESET_SUB
     2379    31873
     2380    31874          DESCRIPTION: This routine creates sum counter resetting
     2381    31875                       subroutine that will executed by the RWCS to clear
     2382    31876                       the sum counter when the control break occurs.
     2383    31877        */
     2384    31878
     2385    31879
     2386    31880    2   DCL CONTROL_LTS$   PTR;
     2387    31881    2   DCL LABEL$         PTR;
     2388    31882    2   DCL LX_ETT$        PTR;
     2389    31883
     2390    31884
     2391    31885
     2392    31886    2          IF CONTROL_LTS$ = ADDR(NIL) OR

  31886 28 006003   200207 470500                    LDP0    @CONTROL_LTS$,,AUTO
        28 006004   000000 236100                    LDQ     0,,PR0
        28 006005   000017 116000 29                 CMPQ    15
        28 006006   006013 600000 28                 TZE     s:31888
        28 006007   000000 471500                    LDP1    0,,PR0
        28 006010   100004 236100                    LDQ     4,,PR1
        28 006011   000017 116000 29                 CMPQ    15
        28 006012   006014 601000 28                 TNZ     s:31891

     2393    31887    2             CONTROL_LTS$ -> CONTROL_NAME_LTS.SUM_RESET$ = ADDR(NIL) THEN
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:386  
     2394    31888    2              RETURN;

  31888 28 006013   000001 702211                    TSX2  ! 1,X1

     2395    31889
     2396    31890
     2397    31891    2          IF CONTROL_LTS$ -> CONTROL_NAME_LTS.START_OFFSET

  31891 28 006014   100016 235100                    LDA     14,,PR1
        28 006015   000031 115007                    CMPA    25,DL
        28 006016   006200 604000 28                 TMI     s:33443

     2398    31892    2              >= %CTR_TBL_START_OFF THEN
     2399    31893    3            DO;

     2400    31894
     2401    31895                   %SUB_HEAD (OFFSET_V =
             31895                       "CONTROL_LTS$ -> CONTROL_NAME_LTS.START_OFFSET + %RESET_SUB_OFF",
     2402    31896                              RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);

  31898 28 006017   200210 633500                    EPPR3   LABEL$,,AUTO
        28 006020   200253 453500                    STP3    CETT$$+2,,AUTO
        28 006021   000002 236000 29                 LDQ     2
        28 006022   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006023   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006024   000000 631400 29                 EPPR1   0
        28 006025   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 006026   000000 011000                    NOP     0

  31899 28 006027   200210 470500                    LDP0    LABEL$,,AUTO
        28 006030   400000 236003                    LDQ     -131072,DU
        28 006031   000003 256100                    ORSQ    3,,PR0

  31900 28 006032   200210 470500                    LDP0    LABEL$,,AUTO
        28 006033   001000 236007                    LDQ     512,DL
        28 006034   000003 256100                    ORSQ    3,,PR0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:387  
  32234 28 006035   000006 236000 29                 LDQ     6
        28 006036   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006037   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006040   200257 450500                    STP0    CETT$$+6,,AUTO
        28 006041   000007 236000 29                 LDQ     7
        28 006042   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006043   000010 237000 29                 LDAQ    8
        28 006044   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006045   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006046   000003 631400 29                 EPPR1   3
        28 006047   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006050   000000 011000                    NOP     0

  32235 28 006051   200210 236100                    LDQ     LABEL$,,AUTO
        28 006052   000000 470400 18                 LDP0    ILL$
        28 006053   000001 756100                    STQ     1,,PR0

  32542 28 006054   000006 236000 29                 LDQ     6
        28 006055   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006056   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 006057   200257 451500                    STP1    CETT$$+6,,AUTO
        28 006060   000007 236000 29                 LDQ     7
        28 006061   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006062   000014 237000 29                 LDAQ    12
        28 006063   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006064   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006065   000003 631400 29                 EPPR1   3
        28 006066   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006067   000000 011000                    NOP     0

  32546 28 006070   200207 470500                    LDP0    @CONTROL_LTS$,,AUTO
        28 006071   000000 471500                    LDP1    0,,PR0
        28 006072   100016 720100                    LXL0    14,,PR1
        28 006073   000002 621010                    EAX1    2,X0
        28 006074   000000 473400 18                 LDP3    ILL$
        28 006075   300000 441100                    SXL1    0,,PR3

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:388  
  32548 28 006076   000000 471400 18                 LDP1    ILL$
        28 006077   100002 450100                    STZ     2,,PR1

  32549 28 006100   200210 236100                    LDQ     LABEL$,,AUTO
        28 006101   100001 756100                    STQ     1,,PR1

  32550 28 006102   200003 473500                    LDP3    @LTS$$,,AUTO
        28 006103   300000 474500                    LDP4    0,,PR3
        28 006104   400022 236100                    LDQ     18,,PR4
        28 006105   100003 756100                    STQ     3,,PR1

  32872 28 006106   000006 236000 29                 LDQ     6
        28 006107   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006110   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 006111   200257 454500                    STP4    CETT$$+6,,AUTO
        28 006112   000007 236000 29                 LDQ     7
        28 006113   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006114   000020 237000 29                 LDAQ    16
        28 006115   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006116   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006117   000003 631400 29                 EPPR1   3
        28 006120   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006121   000000 011000                    NOP     0

  32873 28 006122   000001 220003                    LDX0    1,DU
        28 006123   000000 470400 18                 LDP0    ILL$
        28 006124   000000 440100                    SXL0    0,,PR0

  32877 28 006125   000057 470400 xsym               LDP0    O1COM+47
        28 006126   000006 236100                    LDQ     6,,PR0
        28 006127   000000 471400 18                 LDP1    ILL$
        28 006130   100001 756100                    STQ     1,,PR1

     2403    33046    3              LX_ETT$ = CONTROL_LTS$ -> CONTROL_NAME_LTS.SUM_RESET$;

  33046 28 006131   200207 470500                    LDP0    @CONTROL_LTS$,,AUTO
        28 006132   000000 473500                    LDP3    0,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:389  
        28 006133   300004 236100                    LDQ     4,,PR3
        28 006134   200211 756100                    STQ     LX_ETT$,,AUTO

     2404    33047
     2405    33048    4              DO WHILE (LX_ETT$ ~= ADDR(NIL));

  33048 28 006135   006153 710000 28                 TRA     s:33054

     2406    33049
     2407    33050    4                CALL Z8E7$MOVE (LX_ETT$, ADDR(ZERO));

  33050 28 006136   200134 630500                    EPPR0   ZERO,,AUTO
        28 006137   200252 450500                    STP0    CETT$$+1,,AUTO
        28 006140   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 006141   200255 451500                    STP1    CETT$$+4,,AUTO
        28 006142   200211 633500                    EPPR3   LX_ETT$,,AUTO
        28 006143   200254 453500                    STP3    CETT$$+3,,AUTO
        28 006144   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006145   000000 631400 29                 EPPR1   0
        28 006146   000000 701000 xent               TSX1    Z8E7$MOVE
        28 006147   000000 011000                    NOP     0

     2408    33051
     2409    33052    4                LX_ETT$ = LX_ETT$ -> LX_ETT_ITEM.LINK;

  33052 28 006150   200211 470500                    LDP0    LX_ETT$,,AUTO
        28 006151   000007 236100                    LDQ     7,,PR0
        28 006152   200211 756100                    STQ     LX_ETT$,,AUTO

     2410    33053
     2411    33054    4              END;

  33054 28 006153   000017 116000 29                 CMPQ    15
        28 006154   006136 601000 28                 TNZ     s:33050

     2412    33055
     2413    33056                   %DB_EXCEPT_LIBRARY_RETURN;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:390  

  33266 28 006155   000006 236000 29                 LDQ     6
        28 006156   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006157   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006160   200257 450500                    STP0    CETT$$+6,,AUTO
        28 006161   000007 236000 29                 LDQ     7
        28 006162   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006163   000032 237000 29                 LDAQ    26
        28 006164   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006165   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006166   000003 631400 29                 EPPR1   3
        28 006167   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006170   000000 011000                    NOP     0

  33267 28 006171   000001 220003                    LDX0    1,DU
        28 006172   000000 470400 18                 LDP0    ILL$
        28 006173   000000 440100                    SXL0    0,,PR0

  33271 28 006174   000057 470400 xsym               LDP0    O1COM+47
        28 006175   000006 236100                    LDQ     6,,PR0
        28 006176   000000 471400 18                 LDP1    ILL$
        28 006177   100001 756100                    STQ     1,,PR1

     2414    33440
     2415    33441    3            END;

     2416    33442
     2417    33443    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (CONTROL_LTS$ -> CONTROL_NAME_LTS.SUM_RESET$);

  33443 28 006200   200207 470500                    LDP0    @CONTROL_LTS$,,AUTO
        28 006201   000000 471500                    LDP1    0,,PR0
        28 006202   100004 633500                    EPPR3   4,,PR1
        28 006203   200252 453500                    STP3    CETT$$+1,,AUTO
        28 006204   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006205   000034 631400 29                 EPPR1   28
        28 006206   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        28 006207   000000 011000                    NOP     0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:391  

     2418    33444
     2419    33445    2    END GEN_RESET_SUB;

  33445 28 006210   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 006211   000001 702211                    TSX2  ! 1,X1

     2420    33446         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:392  
     2421    33447
     2422    33448         /*============*/
     2423    33449    1      GEN_SUM_SUBS: PROC (GROUP$$);

  33449 28 006212   200206 741300       GEN_SUM_SUBS STX1  ! CTR_LVL_ETT$+2,,AUTO

     2424    33450         /*============*/
     2425    33451
     2426    33452        /*I*
     2427    33453
     2428    33454             NAME:  GEN_SUM_SUBS
     2429    33455
     2430    33456          DESCRIPTION: This routine calls  to generate cross footing
     2431    33457                       and sum counter clear subroutines.
     2432    33458        */
     2433    33459
     2434    33460
     2435    33461    2   DCL GROUP$$         PTR;
     2436    33462
     2437    33463
     2438    33464
     2439    33465    2          IF GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ ->

  33465 28 006213   200207 470500                    LDP0    @GROUP$$,,AUTO
        28 006214   000000 471500                    LDP1    0,,PR0
        28 006215   100014 473500                    LDP3    12,,PR1
        28 006216   300005 236100                    LDQ     5,,PR3
        28 006217   000017 116000 29                 CMPQ    15
        28 006220   006236 600000 28                 TZE     s:33476

     2440    33466    2             CONTROL_NAME_LTS.SUM_SUBTOTAL$ ~= ADDR(NIL) THEN
     2441    33467    3            DO;

     2442    33468
     2443    33469    3              CALL GEN_CROSS_ROLL_SUB (GROUP$$);

  33469 28 006221   200207 236100                    LDQ     @GROUP$$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:393  
        28 006222   200211 756100                    STQ     LX_ETT$,,AUTO
        28 006223   005624 701000 28                 TSX1    GEN_CROSS_ROLL_SUB
        28 006224   000000 011000                    NOP     0

     2444    33470
     2445    33471    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (GROUP$$ -> REPORT_01_LTS.CONTROL_LTS$ ->

  33471 28 006225   200207 470500                    LDP0    @GROUP$$,,AUTO
        28 006226   000000 471500                    LDP1    0,,PR0
        28 006227   100014 473500                    LDP3    12,,PR1
        28 006230   300005 634500                    EPPR4   5,,PR3
        28 006231   200252 454500                    STP4    CETT$$+1,,AUTO
        28 006232   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006233   000034 631400 29                 EPPR1   28
        28 006234   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        28 006235   000000 011000                    NOP     0

     2446    33472    3                                             CONTROL_NAME_LTS.SUM_SUBTOTAL$);
     2447    33473
     2448    33474    3            END;

     2449    33475
     2450    33476    2          CALL GEN_CLEAR_SUB (GROUP$$);

  33476 28 006236   200207 236100                    LDQ     @GROUP$$,,AUTO
        28 006237   200211 756100                    STQ     LX_ETT$,,AUTO
        28 006240   005375 701000 28                 TSX1    GEN_CLEAR_SUB
        28 006241   000000 011000                    NOP     0

     2451    33477
     2452    33478    2    END GEN_SUM_SUBS;

  33478 28 006242   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 006243   000001 702211                    TSX2  ! 1,X1

     2453    33479         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:394  
     2454    33480
     2455    33481         /*===============*/
     2456    33482    1      GEN_SPECIAL_SUB: PROC (CURRENT$);

  33482 28 006244   200206 741300       GEN_SPECIAL* STX1  ! CTR_LVL_ETT$+2,,AUTO

     2457    33483         /*===============*/
     2458    33484
     2459    33485        /*I*
     2460    33486
     2461    33487             NAME:  GEN_SPECIAL_SUB
     2462    33488
     2463    33489          DESCRIPTION: This routine creates special subtotalling subroutine
     2464    33490                       that will executed by the RWCS to sum up the sum
     2465    33491                       counter when the special detail group presented.
     2466    33492        */
     2467    33493
     2468    33494
     2469    33495    2   DCL CURRENT$       PTR;
     2470    33496    2   DCL LABEL$         PTR;
     2471    33497
     2472    33498
     2473    33499
     2474    33500    2          IF CURRENT$ -> REPORT_01_LTS.SPECIAL_SUBTOTAL$ ~= ADDR(NIL) THEN

  33500 28 006245   200207 470500                    LDP0    @CURRENT$,,AUTO
        28 006246   000000 471500                    LDP1    0,,PR0
        28 006247   100016 236100                    LDQ     14,,PR1
        28 006250   000017 116000 29                 CMPQ    15
        28 006251   006422 600000 28                 TZE     s:35046

     2475    33501    3            DO;

     2476    33502
     2477    33503                   %SUB_HEAD (OFFSET_V = %SPECIAL_SUBTOTAL_SUB_OFF,
     2478    33504                              RWCT_PTR = CURRENT$ -> REPORT_01_LTS.RWCT$);

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:395  
  33506 28 006252   200210 633500                    EPPR3   LABEL$,,AUTO
        28 006253   200253 453500                    STP3    CETT$$+2,,AUTO
        28 006254   000002 236000 29                 LDQ     2
        28 006255   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006256   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006257   000000 631400 29                 EPPR1   0
        28 006260   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 006261   000000 011000                    NOP     0

  33507 28 006262   200210 470500                    LDP0    LABEL$,,AUTO
        28 006263   400000 236003                    LDQ     -131072,DU
        28 006264   000003 256100                    ORSQ    3,,PR0

  33508 28 006265   200210 470500                    LDP0    LABEL$,,AUTO
        28 006266   001000 236007                    LDQ     512,DL
        28 006267   000003 256100                    ORSQ    3,,PR0

  33842 28 006270   000006 236000 29                 LDQ     6
        28 006271   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006272   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006273   200257 450500                    STP0    CETT$$+6,,AUTO
        28 006274   000007 236000 29                 LDQ     7
        28 006275   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006276   000010 237000 29                 LDAQ    8
        28 006277   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006300   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006301   000003 631400 29                 EPPR1   3
        28 006302   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006303   000000 011000                    NOP     0

  33843 28 006304   200210 236100                    LDQ     LABEL$,,AUTO
        28 006305   000000 470400 18                 LDP0    ILL$
        28 006306   000001 756100                    STQ     1,,PR0

  34150 28 006307   000006 236000 29                 LDQ     6
        28 006310   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006311   200252 631500                    EPPR1   CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:396  
        28 006312   200257 451500                    STP1    CETT$$+6,,AUTO
        28 006313   000007 236000 29                 LDQ     7
        28 006314   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006315   000014 237000 29                 LDAQ    12
        28 006316   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006317   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006320   000003 631400 29                 EPPR1   3
        28 006321   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006322   000000 011000                    NOP     0

  34154 28 006323   000010 220003                    LDX0    8,DU
        28 006324   000000 470400 18                 LDP0    ILL$
        28 006325   000000 440100                    SXL0    0,,PR0

  34156 28 006326   000000 470400 18                 LDP0    ILL$
        28 006327   000002 450100                    STZ     2,,PR0

  34157 28 006330   200210 236100                    LDQ     LABEL$,,AUTO
        28 006331   000001 756100                    STQ     1,,PR0

  34158 28 006332   200207 471500                    LDP1    @CURRENT$,,AUTO
        28 006333   100000 473500                    LDP3    0,,PR1
        28 006334   300022 236100                    LDQ     18,,PR3
        28 006335   000003 756100                    STQ     3,,PR0

  34480 28 006336   000006 236000 29                 LDQ     6
        28 006337   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006340   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 006341   200257 453500                    STP3    CETT$$+6,,AUTO
        28 006342   000007 236000 29                 LDQ     7
        28 006343   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006344   000020 237000 29                 LDAQ    16
        28 006345   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006346   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006347   000003 631400 29                 EPPR1   3
        28 006350   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006351   000000 011000                    NOP     0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:397  

  34481 28 006352   000001 220003                    LDX0    1,DU
        28 006353   000000 470400 18                 LDP0    ILL$
        28 006354   000000 440100                    SXL0    0,,PR0

  34485 28 006355   000057 470400 xsym               LDP0    O1COM+47
        28 006356   000006 236100                    LDQ     6,,PR0
        28 006357   000000 471400 18                 LDP1    ILL$
        28 006360   100001 756100                    STQ     1,,PR1

     2479    34654
     2480    34655    3              CALL GEN_ADD_CODE (CURRENT$ -> REPORT_01_LTS.SPECIAL_SUBTOTAL$);

  34655 28 006361   200207 470500                    LDP0    @CURRENT$,,AUTO
        28 006362   000000 473500                    LDP3    0,,PR0
        28 006363   300016 634500                    EPPR4   14,,PR3
        28 006364   200215 454500                    STP4    @ADD_LIST$,,AUTO
        28 006365   005334 701000 28                 TSX1    GEN_ADD_CODE
        28 006366   000000 011000                    NOP     0

     2481    34656
     2482    34657    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (CURRENT$ -> REPORT_01_LTS.
             34657                       SPECIAL_SUBTOTAL$);

  34657 28 006367   200207 470500                    LDP0    @CURRENT$,,AUTO
        28 006370   000000 471500                    LDP1    0,,PR0
        28 006371   100016 633500                    EPPR3   14,,PR1
        28 006372   200252 453500                    STP3    CETT$$+1,,AUTO
        28 006373   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006374   000034 631400 29                 EPPR1   28
        28 006375   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        28 006376   000000 011000                    NOP     0

     2483    34658
     2484    34659                   %DB_EXCEPT_LIBRARY_RETURN;

  34869 28 006377   000006 236000 29                 LDQ     6
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:398  
        28 006400   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006401   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006402   200257 450500                    STP0    CETT$$+6,,AUTO
        28 006403   000007 236000 29                 LDQ     7
        28 006404   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006405   000032 237000 29                 LDAQ    26
        28 006406   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006407   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006410   000003 631400 29                 EPPR1   3
        28 006411   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006412   000000 011000                    NOP     0

  34870 28 006413   000001 220003                    LDX0    1,DU
        28 006414   000000 470400 18                 LDP0    ILL$
        28 006415   000000 440100                    SXL0    0,,PR0

  34874 28 006416   000057 470400 xsym               LDP0    O1COM+47
        28 006417   000006 236100                    LDQ     6,,PR0
        28 006420   000000 471400 18                 LDP1    ILL$
        28 006421   100001 756100                    STQ     1,,PR1

     2485    35043
     2486    35044    3            END;

     2487    35045
     2488    35046    2    END GEN_SPECIAL_SUB;

  35046 28 006422   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 006423   000001 702211                    TSX2  ! 1,X1

     2489    35047         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:399  
     2490    35048
     2491    35049         /*===============*/
     2492    35050    1      GEN_GENERAL_SUB: PROC;

  35050 28 006424   200206 741300       GEN_GENERAL* STX1  ! CTR_LVL_ETT$+2,,AUTO

     2493    35051         /*===============*/
     2494    35052
     2495    35053        /*I*
     2496    35054
     2497    35055             NAME:  GEN_GENERAL_SUB
     2498    35056
     2499    35057          DESCRIPTION: This routine creates general subtotalling subroutine
     2500    35058                       that will executed by the RWCS to sum up the sum
     2501    35059                       counter when any detail group presented.
     2502    35060        */
     2503    35061
     2504    35062
     2505    35063    2   DCL LABEL$     PTR;
     2506    35064
     2507    35065
     2508    35066
     2509    35067    2      IF LTS$$ -> REPORT_LTS.GENERAL_SUBTOTAL$ ~= ADDR(NIL) THEN

  35067 28 006425   200003 470500                    LDP0    @LTS$$,,AUTO
        28 006426   000000 471500                    LDP1    0,,PR0
        28 006427   100010 236100                    LDQ     8,,PR1
        28 006430   000017 116000 29                 CMPQ    15
        28 006431   006602 600000 28                 TZE     s:36613

     2510    35068    3        DO;

     2511    35069
     2512    35070               %SUB_HEAD (OFFSET_V = %GEN_SUBTOTAL_OFF,
     2513    35071                          RWCT_PTR = LTS$$ -> REPORT_LTS.RWCT$);

  35073 28 006432   200207 633500                    EPPR3   LABEL$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:400  
        28 006433   200253 453500                    STP3    CETT$$+2,,AUTO
        28 006434   000002 236000 29                 LDQ     2
        28 006435   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006436   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006437   000000 631400 29                 EPPR1   0
        28 006440   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        28 006441   000000 011000                    NOP     0

  35074 28 006442   200207 470500                    LDP0    LABEL$,,AUTO
        28 006443   400000 236003                    LDQ     -131072,DU
        28 006444   000003 256100                    ORSQ    3,,PR0

  35075 28 006445   200207 470500                    LDP0    LABEL$,,AUTO
        28 006446   001000 236007                    LDQ     512,DL
        28 006447   000003 256100                    ORSQ    3,,PR0

  35409 28 006450   000006 236000 29                 LDQ     6
        28 006451   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006452   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006453   200257 450500                    STP0    CETT$$+6,,AUTO
        28 006454   000007 236000 29                 LDQ     7
        28 006455   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006456   000010 237000 29                 LDAQ    8
        28 006457   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006460   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006461   000003 631400 29                 EPPR1   3
        28 006462   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006463   000000 011000                    NOP     0

  35410 28 006464   200207 236100                    LDQ     LABEL$,,AUTO
        28 006465   000000 470400 18                 LDP0    ILL$
        28 006466   000001 756100                    STQ     1,,PR0

  35717 28 006467   000006 236000 29                 LDQ     6
        28 006470   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006471   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 006472   200257 451500                    STP1    CETT$$+6,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:401  
        28 006473   000007 236000 29                 LDQ     7
        28 006474   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006475   000014 237000 29                 LDAQ    12
        28 006476   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006477   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006500   000003 631400 29                 EPPR1   3
        28 006501   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006502   000000 011000                    NOP     0

  35721 28 006503   000010 220003                    LDX0    8,DU
        28 006504   000000 470400 18                 LDP0    ILL$
        28 006505   000000 440100                    SXL0    0,,PR0

  35723 28 006506   000000 470400 18                 LDP0    ILL$
        28 006507   000002 450100                    STZ     2,,PR0

  35724 28 006510   200207 236100                    LDQ     LABEL$,,AUTO
        28 006511   000001 756100                    STQ     1,,PR0

  35725 28 006512   200003 471500                    LDP1    @LTS$$,,AUTO
        28 006513   100000 473500                    LDP3    0,,PR1
        28 006514   300022 236100                    LDQ     18,,PR3
        28 006515   000003 756100                    STQ     3,,PR0

  36047 28 006516   000006 236000 29                 LDQ     6
        28 006517   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006520   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 006521   200257 453500                    STP3    CETT$$+6,,AUTO
        28 006522   000007 236000 29                 LDQ     7
        28 006523   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006524   000020 237000 29                 LDAQ    16
        28 006525   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006526   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006527   000003 631400 29                 EPPR1   3
        28 006530   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006531   000000 011000                    NOP     0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:402  
  36048 28 006532   000001 220003                    LDX0    1,DU
        28 006533   000000 470400 18                 LDP0    ILL$
        28 006534   000000 440100                    SXL0    0,,PR0

  36052 28 006535   000057 470400 xsym               LDP0    O1COM+47
        28 006536   000006 236100                    LDQ     6,,PR0
        28 006537   000000 471400 18                 LDP1    ILL$
        28 006540   100001 756100                    STQ     1,,PR1

     2514    36221
     2515    36222    3          CALL GEN_ADD_CODE (LTS$$ -> REPORT_LTS.GENERAL_SUBTOTAL$);

  36222 28 006541   200003 470500                    LDP0    @LTS$$,,AUTO
        28 006542   000000 473500                    LDP3    0,,PR0
        28 006543   300010 634500                    EPPR4   8,,PR3
        28 006544   200215 454500                    STP4    @ADD_LIST$,,AUTO
        28 006545   005334 701000 28                 TSX1    GEN_ADD_CODE
        28 006546   000000 011000                    NOP     0

     2516    36223
     2517    36224    3          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> REPORT_LTS.GENERAL_SUBTOTAL$);

  36224 28 006547   200003 470500                    LDP0    @LTS$$,,AUTO
        28 006550   000000 471500                    LDP1    0,,PR0
        28 006551   100010 633500                    EPPR3   8,,PR1
        28 006552   200252 453500                    STP3    CETT$$+1,,AUTO
        28 006553   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006554   000034 631400 29                 EPPR1   28
        28 006555   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        28 006556   000000 011000                    NOP     0

     2518    36225
     2519    36226               %DB_EXCEPT_LIBRARY_RETURN;

  36436 28 006557   000006 236000 29                 LDQ     6
        28 006560   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006561   200252 630500                    EPPR0   CETT$$+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:403  
        28 006562   200257 450500                    STP0    CETT$$+6,,AUTO
        28 006563   000007 236000 29                 LDQ     7
        28 006564   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006565   000032 237000 29                 LDAQ    26
        28 006566   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006567   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006570   000003 631400 29                 EPPR1   3
        28 006571   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006572   000000 011000                    NOP     0

  36437 28 006573   000001 220003                    LDX0    1,DU
        28 006574   000000 470400 18                 LDP0    ILL$
        28 006575   000000 440100                    SXL0    0,,PR0

  36441 28 006576   000057 470400 xsym               LDP0    O1COM+47
        28 006577   000006 236100                    LDQ     6,,PR0
        28 006600   000000 471400 18                 LDP1    ILL$
        28 006601   100001 756100                    STQ     1,,PR1

     2520    36610
     2521    36611    3        END;

     2522    36612
     2523    36613    2    END GEN_GENERAL_SUB;

  36613 28 006602   200206 221300                    LDX1  ! CTR_LVL_ETT$+2,,AUTO
        28 006603   000001 702211                    TSX2  ! 1,X1

     2524    36614         %EJECT;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:404  
     2525    36615
     2526    36616               /* Main routine */
     2527    36617
     2528    36618    1          MKCN.CON = 1;

  36618 28 006604   000001 235007                    LDA     1,DL
        28 006605   000000 755000 24                 STA     MKCN

     2529    36619
     2530    36620    1          CALL Z8AC$MAKE_CONST (CONST_ETT$);

  36620 28 006606   200011 630500                    EPPR0   CONST_ETT$,,AUTO
        28 006607   200252 450500                    STP0    CETT$$+1,,AUTO
        28 006610   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006611   000034 631400 29                 EPPR1   28
        28 006612   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        28 006613   000000 011000                    NOP     0

     2531    36621
     2532    36622               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ONE_FIELD)",
     2533    36623                                  @TYPE    = %TYI,
     2534    36624                                  @ETT$    = CONST_ETT$);

  36626 28 006614   000004 220003                    LDX0    4,DU
        28 006615   200164 740100                    STX0    ONE_FIELD,,AUTO

  36627 28 006616   000000 221003                    LDX1    0,DU
        28 006617   200164 441100                    SXL1    ONE_FIELD,,AUTO

  36628 28 006620   000001 235007                    LDA     1,DL
        28 006621   200170 755100                    STA     ONE_FIELD+4,,AUTO

  36629 28 006622   000017 236000 29                 LDQ     15
        28 006623   200173 756100                    STQ     ONE_FIELD+7,,AUTO

  36630 28 006624   200011 236100                    LDQ     CONST_ETT$,,AUTO
        28 006625   200165 756100                    STQ     ONE_FIELD+1,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:405  

  36631 28 006626   000017 236000 29                 LDQ     15
        28 006627   200166 756100                    STQ     ONE_FIELD+2,,AUTO

  36633 28 006630   000133 235000 xsym               LDA     COMCOM+91
        28 006631   200171 755100                    STA     ONE_FIELD+5,,AUTO

  36634 28 006632   000134 235000 xsym               LDA     COMCOM+92
        28 006633   200172 755100                    STA     ONE_FIELD+6,,AUTO

     2535    36646
     2536    36647               %GET_LTS (@ID       = %FILE_LTS,
     2537    36648                         @ST$      = LTS$$ -> REPORT_LTS.FILE$,
     2538    36649                         @RETURN$  = FILE_LTS$ );

  36651 28 006634   200003 470500                    LDP0    @LTS$$,,AUTO
        28 006635   000000 471500                    LDP1    0,,PR0
        28 006636   100002 473500                    LDP3    2,,PR1
        28 006637   300005 236100                    LDQ     5,,PR3
        28 006640   000017 116000 29                 CMPQ    15
        28 006641   006651 600000 28                 TZE     s:36685
        28 006642   300005 474500                    LDP4    5,,PR3
        28 006643   400000 222100                    LDX2    0,,PR4
        28 006644   001105 102003                    CMPX2   581,DU
        28 006645   006651 601000 28                 TNZ     s:36685

  36665 28 006646   400006 236100                    LDQ     6,,PR4
        28 006647   200027 756100                    STQ     FILE_LTS$,,AUTO

  36683 28 006650   006663 710000 28                 TRA     s:36697

  36685 28 006651   000017 116000 29                 CMPQ    15
        28 006652   006661 600000 28                 TZE     s:36689
        28 006653   300005 474500                    LDP4    5,,PR3
        28 006654   400000 222100                    LDX2    0,,PR4
        28 006655   001121 102003                    CMPX2   593,DU
        28 006656   006661 601000 28                 TNZ     s:36689
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:406  

  36687 28 006657   200027 756100                    STQ     FILE_LTS$,,AUTO
        28 006660   006663 710000 28                 TRA     s:36697

  36689 28 006661   000017 236000 29                 LDQ     15
        28 006662   200027 756100                    STQ     FILE_LTS$,,AUTO

     2539    36692
     2540    36693
     2541    36694               %GET_ADSC_LEN (ST$  = LTS$$ -> REPORT_LTS.RWCT$,
     2542    36695                              RTN  = RWCT_LEN);

  36697 28 006663   000000 471500                    LDP1    0,,PR0
        28 006664   100022 473500                    LDP3    18,,PR1
        28 006665   300003 236100                    LDQ     3,,PR3
        28 006666   004000 316003                    CANQ    2048,DU
        28 006667   006703 600000 28                 TZE     s:36703

  36698 28 006670   300005 474500                    LDP4    5,,PR3
        28 006671   400000 222100                    LDX2    0,,PR4
        28 006672   001105 102003                    CMPX2   581,DU
        28 006673   006700 601000 28                 TNZ     s:36701

  36699 28 006674   400003 475500                    LDP5    3,,PR4
        28 006675   500001 235100                    LDA     1,,PR5
        28 006676   200005 755100                    STA     RWCT_LEN,,AUTO
        28 006677   006706 710000 28                 TRA     s:36707

  36701 28 006700   400001 235100                    LDA     1,,PR4
        28 006701   200005 755100                    STA     RWCT_LEN,,AUTO
        28 006702   006706 710000 28                 TRA     s:36707

  36703 28 006703   300001 236100                    LDQ     1,,PR3
        28 006704   007777 376007                    ANQ     4095,DL
        28 006705   200005 756100                    STQ     RWCT_LEN,,AUTO

     2543    36706
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:407  
     2544    36707    1          LAST_WORD_OFFSET = (RWCT_LEN - 20) / 4;

  36707 28 006706   200005 236100                    LDQ     RWCT_LEN,,AUTO
        28 006707   000024 136007                    SBLQ    20,DL
        28 006710   000004 506007                    DIV     4,DL
        28 006711   200006 756100                    STQ     LAST_WORD_OFFSET,,AUTO

     2545    36708
     2546    36709    1          MKCN.CON = LTS$$ -> REPORT_LTS.B.CODE_NUMBER;

  36709 28 006712   100003 236100                    LDQ     3,,PR1
        28 006713   777777 376007                    ANQ     -1,DL
        28 006714   000000 756000 24                 STQ     MKCN

     2547    36710    1          CALL Z8AC$MAKE_CONST (CONST_ETT$);

  36710 28 006715   200011 631500                    EPPR1   CONST_ETT$,,AUTO
        28 006716   200252 451500                    STP1    CETT$$+1,,AUTO
        28 006717   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006720   000034 631400 29                 EPPR1   28
        28 006721   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        28 006722   000000 011000                    NOP     0

     2548    36711
     2549    36712               %NEW_ILL (@ID     = %PREOFF,
     2550    36713                         @OFFSET = LAST_WORD_OFFSET,
     2551    36714                         @LOP    = LTS$$ -> REPORT_LTS.RWCT$,
     2552    36715                         @ROP    = CONST_ETT$ -> ETT.LOP,
     2553    36716                         @N      = 1);

  36945 28 006723   000006 236000 29                 LDQ     6
        28 006724   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006725   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 006726   200257 450500                    STP0    CETT$$+6,,AUTO
        28 006727   000007 236000 29                 LDQ     7
        28 006730   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006731   000064 237000 29                 LDAQ    52
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:408  
        28 006732   200254 757100                    STAQ    CETT$$+3,,AUTO
        28 006733   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006734   000003 631400 29                 EPPR1   3
        28 006735   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006736   000000 011000                    NOP     0

  36949 28 006737   200006 720100                    LXL0    LAST_WORD_OFFSET,,AUTO
        28 006740   000000 470400 18                 LDP0    ILL$
        28 006741   000000 440100                    SXL0    0,,PR0

  36954 28 006742   000001 235007                    LDA     1,DL
        28 006743   000000 470400 18                 LDP0    ILL$
        28 006744   000003 755100                    STA     3,,PR0

  36956 28 006745   200003 471500                    LDP1    @LTS$$,,AUTO
        28 006746   100000 473500                    LDP3    0,,PR1
        28 006747   300022 236100                    LDQ     18,,PR3
        28 006750   000001 756100                    STQ     1,,PR0

  36957 28 006751   200011 473500                    LDP3    CONST_ETT$,,AUTO
        28 006752   300001 236100                    LDQ     1,,PR3
        28 006753   000002 756100                    STQ     2,,PR0

     2554    37095
     2555    37096               %NEW_ILL (@ID     = %PTR_SET,
     2556    37097                         @OFFSET = "LAST_WORD_OFFSET + 1",
     2557    37098                         @LOP    = LTS$$ -> REPORT_LTS.RWCT$,
     2558    37099                         @ROP    = FILE_LTS$ -> FILE_LTS.FAB$);

  37319 28 006754   000006 236000 29                 LDQ     6
        28 006755   200252 756100                    STQ     CETT$$+1,,AUTO
        28 006756   200252 633500                    EPPR3   CETT$$+1,,AUTO
        28 006757   200257 453500                    STP3    CETT$$+6,,AUTO
        28 006760   000007 236000 29                 LDQ     7
        28 006761   200256 756100                    STQ     CETT$$+5,,AUTO
        28 006762   000066 237000 29                 LDAQ    54
        28 006763   200254 757100                    STAQ    CETT$$+3,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:409  
        28 006764   200254 630500                    EPPR0   CETT$$+3,,AUTO
        28 006765   000003 631400 29                 EPPR1   3
        28 006766   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        28 006767   000000 011000                    NOP     0

  37323 28 006770   200006 720100                    LXL0    LAST_WORD_OFFSET,,AUTO
        28 006771   000001 621010                    EAX1    1,X0
        28 006772   000000 470400 18                 LDP0    ILL$
        28 006773   000000 441100                    SXL1    0,,PR0

  37325 28 006774   200003 470500                    LDP0    @LTS$$,,AUTO
        28 006775   000000 471500                    LDP1    0,,PR0
        28 006776   100022 236100                    LDQ     18,,PR1
        28 006777   000000 473400 18                 LDP3    ILL$
        28 007000   300001 756100                    STQ     1,,PR3

  37326 28 007001   200027 471500                    LDP1    FILE_LTS$,,AUTO
        28 007002   100002 236100                    LDQ     2,,PR1
        28 007003   300002 756100                    STQ     2,,PR3

     2559    37478    1          CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.BUFFER_ST$,

  37478 28 007004   000000 471500                    LDP1    0,,PR0
        28 007005   000017 236000 29                 LDQ     15
        28 007006   200252 756100                    STQ     CETT$$+1,,AUTO
        28 007007   200012 634500                    EPPR4   BUFFER_ETT$,,AUTO
        28 007010   200255 454500                    STP4    CETT$$+4,,AUTO
        28 007011   200252 635500                    EPPR5   CETT$$+1,,AUTO
        28 007012   200254 455500                    STP5    CETT$$+3,,AUTO
        28 007013   100034 636500                    EPPR6   28,,PR1
        28 007014   200253 456500                    STP6    CETT$$+2,,AUTO
        28 007015   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 007016   000030 631400 29                 EPPR1   24
        28 007017   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 007020   000000 011000                    NOP     0

     2560    37479    1                              ADDR(NIL),
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:410  
     2561    37480    1                              BUFFER_ETT$);
     2562    37481
     2563    37482    1          IF LTS$$ -> REPORT_LTS.B.CODE_ON THEN

  37482 28 007021   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007022   000000 471500                    LDP1    0,,PR0
        28 007023   100003 234100                    SZN     3,,PR1
        28 007024   007053 605000 28                 TPL     s:37494

     2564    37483    2            DO;

     2565    37484    2              MIN_REC_LEN = 2;    /*#32312#*/

  37484 28 007025   000002 235007                    LDA     2,DL
        28 007026   200024 755100                    STA     MIN_REC_LEN,,AUTO

     2566    37485    2              FILE_LTS$ ->FILE_LTS.RECORD_CONTAINS.INT_1 = 2; /*#32312#*/

  37485 28 007027   200027 473500                    LDP3    FILE_LTS$,,AUTO
        28 007030   300023 755100                    STA     19,,PR3

     2567    37486    2              REPORT_CODE_NO = LTS$$ -> REPORT_LTS.B.CODE_NUMBER;

  37486 28 007031   000000 471500                    LDP1    0,,PR0
        28 007032   100003 236100                    LDQ     3,,PR1
        28 007033   777777 376007                    ANQ     -1,DL
        28 007034   200004 756100                    STQ     REPORT_CODE_NO,,AUTO

     2568    37487    2              CALL Z8AC$MAKE_TYA_CONST (LTS$$ -> REPORT_LTS.CODE,

  37487 28 007035   000000 471500                    LDP1    0,,PR0
        28 007036   200020 633500                    EPPR3   CODE_ETT$,,AUTO
        28 007037   200255 453500                    STP3    CETT$$+4,,AUTO
        28 007040   000014 236000 29                 LDQ     12
        28 007041   200254 756100                    STQ     CETT$$+3,,AUTO
        28 007042   000071 236000 29                 LDQ     57
        28 007043   200253 756100                    STQ     CETT$$+2,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:411  
        28 007044   100004 634500                    EPPR4   4,,PR1
        28 007045   200252 454500                    STP4    CETT$$+1,,AUTO
        28 007046   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 007047   000003 631400 29                 EPPR1   3
        28 007050   000000 701000 xent               TSX1    Z8AC$MAKE_TYA_CONST
        28 007051   000000 011000                    NOP     0

     2569    37488    2                                        2,
     2570    37489    2                                        0,
     2571    37490    2                                        CODE_ETT$);
     2572    37491    2            END;

  37491 28 007052   007073 710000 28                 TRA     s:37503

     2573    37492    1          ELSE
     2574    37493    2            DO;

     2575    37494    2              MIN_REC_LEN = 1;   /*#32312#*/

  37494 28 007053   000001 235007                    LDA     1,DL
        28 007054   200024 755100                    STA     MIN_REC_LEN,,AUTO

     2576    37495    2              FILE_LTS$ ->FILE_LTS.RECORD_CONTAINS.INT_1 = 1; /*#32312#*/

  37495 28 007055   200027 473500                    LDP3    FILE_LTS$,,AUTO
        28 007056   300023 755100                    STA     19,,PR3

     2577    37496    2              REPORT_CODE_NO = %DEFAULT_REPORT_CODE;

  37496 28 007057   000067 236007                    LDQ     55,DL
        28 007060   200004 756100                    STQ     REPORT_CODE_NO,,AUTO

     2578    37497    2              CALL Z8AC$MAKE_TYA_CONST ('  ',

  37497 28 007061   200020 631500                    EPPR1   CODE_ETT$,,AUTO
        28 007062   200255 451500                    STP1    CETT$$+4,,AUTO
        28 007063   000014 236000 29                 LDQ     12
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:412  
        28 007064   200254 756100                    STQ     CETT$$+3,,AUTO
        28 007065   000072 237000 29                 LDAQ    58
        28 007066   200252 757100                    STAQ    CETT$$+1,,AUTO
        28 007067   200252 630500                    EPPR0   CETT$$+1,,AUTO
        28 007070   000003 631400 29                 EPPR1   3
        28 007071   000000 701000 xent               TSX1    Z8AC$MAKE_TYA_CONST
        28 007072   000000 011000                    NOP     0

     2579    37498    2                                        2,
     2580    37499    2                                        0,
     2581    37500    2                                        CODE_ETT$);
     2582    37501    2            END;

     2583    37502
     2584    37503    1          CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.LINE_COUNTER$,

  37503 28 007073   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007074   000000 471500                    LDP1    0,,PR0
        28 007075   000017 236000 29                 LDQ     15
        28 007076   200252 756100                    STQ     CETT$$+1,,AUTO
        28 007077   200014 633500                    EPPR3   LINE_COUNTER_ETT$,,AUTO
        28 007100   200255 453500                    STP3    CETT$$+4,,AUTO
        28 007101   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 007102   200254 454500                    STP4    CETT$$+3,,AUTO
        28 007103   100020 635500                    EPPR5   16,,PR1
        28 007104   200253 455500                    STP5    CETT$$+2,,AUTO
        28 007105   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 007106   000030 631400 29                 EPPR1   24
        28 007107   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 007110   000000 011000                    NOP     0

     2585    37504    1                              ADDR(NIL),
     2586    37505    1                              LINE_COUNTER_ETT$);
     2587    37506
     2588    37507    1          CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.PAGE_COUNTER$,

  37507 28 007111   200003 470500                    LDP0    @LTS$$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:413  
        28 007112   000000 471500                    LDP1    0,,PR0
        28 007113   000017 236000 29                 LDQ     15
        28 007114   200252 756100                    STQ     CETT$$+1,,AUTO
        28 007115   200013 633500                    EPPR3   PAGE_COUNTER_ETT$,,AUTO
        28 007116   200255 453500                    STP3    CETT$$+4,,AUTO
        28 007117   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 007120   200254 454500                    STP4    CETT$$+3,,AUTO
        28 007121   100017 635500                    EPPR5   15,,PR1
        28 007122   200253 455500                    STP5    CETT$$+2,,AUTO
        28 007123   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 007124   000030 631400 29                 EPPR1   24
        28 007125   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 007126   000000 011000                    NOP     0

     2589    37508    1                              ADDR(NIL),
     2590    37509    1                              PAGE_COUNTER_ETT$);
     2591    37510
     2592    37511    1          IF LTS$$ -> REPORT_LTS.B.CODE_ON THEN

  37511 28 007127   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007130   000000 471500                    LDP1    0,,PR0
        28 007131   100003 234100                    SZN     3,,PR1
        28 007132   007136 605000 28                 TPL     s:37518

     2593    37512    2            DO;

     2594    37513
     2595    37514    2              SA_ADJ = 1;

  37514 28 007133   000001 235007                    LDA     1,DL
        28 007134   200010 755100                    STA     SA_ADJ,,AUTO

     2596    37515    2            END;

  37515 28 007135   007140 710000 28                 TRA     s:37521

     2597    37516    1          ELSE
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:414  
     2598    37517    2            DO;

     2599    37518    2              SA_ADJ = -1;

  37518 28 007136   000001 335007                    LCA     1,DL
        28 007137   200010 755100                    STA     SA_ADJ,,AUTO

     2600    37519    2            END;

     2601    37520
     2602    37521    1          CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.AFTER_ADVANCE$,

  37521 28 007140   000017 236000 29                 LDQ     15
        28 007141   200252 756100                    STQ     CETT$$+1,,AUTO
        28 007142   200015 633500                    EPPR3   AFTER_AREA_ETT$,,AUTO
        28 007143   200255 453500                    STP3    CETT$$+4,,AUTO
        28 007144   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 007145   200254 454500                    STP4    CETT$$+3,,AUTO
        28 007146   100040 635500                    EPPR5   32,,PR1
        28 007147   200253 455500                    STP5    CETT$$+2,,AUTO
        28 007150   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 007151   000030 631400 29                 EPPR1   24
        28 007152   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 007153   000000 011000                    NOP     0

     2603    37522    1                              ADDR(NIL),
     2604    37523    1                              AFTER_AREA_ETT$);
     2605    37524
     2606    37525               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(AFTER_FIELD)",
     2607    37526                                  @TYPE    = %TYI,
     2608    37527                                  @ETT$    = AFTER_AREA_ETT$);

  37529 28 007154   000004 220003                    LDX0    4,DU
        28 007155   200032 740100                    STX0    AFTER_FIELD,,AUTO

  37530 28 007156   000000 221003                    LDX1    0,DU
        28 007157   200032 441100                    SXL1    AFTER_FIELD,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:415  

  37531 28 007160   000001 235007                    LDA     1,DL
        28 007161   200036 755100                    STA     AFTER_FIELD+4,,AUTO

  37532 28 007162   000017 236000 29                 LDQ     15
        28 007163   200041 756100                    STQ     AFTER_FIELD+7,,AUTO

  37533 28 007164   200015 236100                    LDQ     AFTER_AREA_ETT$,,AUTO
        28 007165   200033 756100                    STQ     AFTER_FIELD+1,,AUTO

  37534 28 007166   000017 236000 29                 LDQ     15
        28 007167   200034 756100                    STQ     AFTER_FIELD+2,,AUTO

  37536 28 007170   000133 235000 xsym               LDA     COMCOM+91
        28 007171   200037 755100                    STA     AFTER_FIELD+5,,AUTO

  37537 28 007172   000134 235000 xsym               LDA     COMCOM+92
        28 007173   200040 755100                    STA     AFTER_FIELD+6,,AUTO

     2609    37549
     2610    37550               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(LINE_COUNTER_FIELD)",
     2611    37551                                  @TYPE    = %TYI,
     2612    37552                                  @ETT$    = LINE_COUNTER_ETT$);

  37554 28 007174   200042 740100                    STX0    LINE_COUNTER_FIELD,,AUTO

  37555 28 007175   200042 441100                    SXL1    LINE_COUNTER_FIELD,,AUTO

  37556 28 007176   000001 235007                    LDA     1,DL
        28 007177   200046 755100                    STA     LINE_COUNTER_FIELD+4,,AUTO

  37557 28 007200   200051 756100                    STQ     LINE_COUNTER_FIELD+7,,AUTO

  37558 28 007201   200014 236100                    LDQ     LINE_COUNTER_ETT$,,AUTO
        28 007202   200043 756100                    STQ     LINE_COUNTER_FIELD+1,,AUTO

  37559 28 007203   000017 236000 29                 LDQ     15
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:416  
        28 007204   200044 756100                    STQ     LINE_COUNTER_FIELD+2,,AUTO

  37561 28 007205   000133 235000 xsym               LDA     COMCOM+91
        28 007206   200047 755100                    STA     LINE_COUNTER_FIELD+5,,AUTO

  37562 28 007207   000134 235000 xsym               LDA     COMCOM+92
        28 007210   200050 755100                    STA     LINE_COUNTER_FIELD+6,,AUTO

     2613    37574
     2614    37575               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ZERO)",
     2615    37576                                  @TYPE    = %TYI,
     2616    37577                                  @ETT$    = COMCOM.VALUE_0);

  37579 28 007211   200134 740100                    STX0    ZERO,,AUTO

  37580 28 007212   200134 441100                    SXL1    ZERO,,AUTO

  37581 28 007213   000001 235007                    LDA     1,DL
        28 007214   200140 755100                    STA     ZERO+4,,AUTO

  37582 28 007215   200143 756100                    STQ     ZERO+7,,AUTO

  37583 28 007216   000124 236000 xsym               LDQ     COMCOM+84
        28 007217   200135 756100                    STQ     ZERO+1,,AUTO

  37584 28 007220   000017 236000 29                 LDQ     15
        28 007221   200136 756100                    STQ     ZERO+2,,AUTO

  37586 28 007222   000133 235000 xsym               LDA     COMCOM+91
        28 007223   200141 755100                    STA     ZERO+5,,AUTO

  37587 28 007224   000134 235000 xsym               LDA     COMCOM+92
        28 007225   200142 755100                    STA     ZERO+6,,AUTO

     2617    37599
     2618    37600
     2619    37601
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:417  
     2620    37602    1          CALL CREATE_TOP_PAGE_SUB;

  37602 28 007226   000003 701000 28                 TSX1    CREATE_TOP_PAGE_SUB
        28 007227   000000 011000                    NOP     0

     2621    37603
     2622    37604    1          CALL BUILD_FORMAT_SUB;

  37604 28 007230   002677 701000 28                 TSX1    BUILD_FORMAT_SUB
        28 007231   000000 011000                    NOP     0

     2623    37605
     2624    37606    1          IF LTS$$ -> REPORT_LTS.CONTROL$ ~= ADDR(NIL) THEN

  37606 28 007232   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007233   000000 471500                    LDP1    0,,PR0
        28 007234   100005 236100                    LDQ     5,,PR1
        28 007235   000017 116000 29                 CMPQ    15
        28 007236   007345 600000 28                 TZE     s:37655

     2625    37607    2            DO;

     2626    37608
     2627    37609    2              CALL Z8AF$NEW_BASE (LTS$$ -> REPORT_LTS.CTR_LVL_COUNTER$,

  37609 28 007237   000017 236000 29                 LDQ     15
        28 007240   200252 756100                    STQ     CETT$$+1,,AUTO
        28 007241   200204 633500                    EPPR3   CTR_LVL_ETT$,,AUTO
        28 007242   200255 453500                    STP3    CETT$$+4,,AUTO
        28 007243   200252 634500                    EPPR4   CETT$$+1,,AUTO
        28 007244   200254 454500                    STP4    CETT$$+3,,AUTO
        28 007245   100035 635500                    EPPR5   29,,PR1
        28 007246   200253 455500                    STP5    CETT$$+2,,AUTO
        28 007247   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 007250   000030 631400 29                 EPPR1   24
        28 007251   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        28 007252   000000 011000                    NOP     0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:418  

     2628    37610    2                                  ADDR(NIL),
     2629    37611    2                                  CTR_LVL_ETT$);
     2630    37612
     2631    37613                   %INIT_LX_ETT_ITEM (@POINTER = "ADDR(CTR_LVL_FIELD)",
     2632    37614                                      @TYPE    = %TYI,
     2633    37615                                      @ETT$    = CTR_LVL_ETT$);

  37617 28 007253   000004 220003                    LDX0    4,DU
        28 007254   200174 740100                    STX0    CTR_LVL_FIELD,,AUTO

  37618 28 007255   000000 221003                    LDX1    0,DU
        28 007256   200174 441100                    SXL1    CTR_LVL_FIELD,,AUTO

  37619 28 007257   000001 235007                    LDA     1,DL
        28 007260   200200 755100                    STA     CTR_LVL_FIELD+4,,AUTO

  37620 28 007261   000017 236000 29                 LDQ     15
        28 007262   200203 756100                    STQ     CTR_LVL_FIELD+7,,AUTO

  37621 28 007263   200204 236100                    LDQ     CTR_LVL_ETT$,,AUTO
        28 007264   200175 756100                    STQ     CTR_LVL_FIELD+1,,AUTO

  37622 28 007265   000017 236000 29                 LDQ     15
        28 007266   200176 756100                    STQ     CTR_LVL_FIELD+2,,AUTO

  37624 28 007267   000133 235000 xsym               LDA     COMCOM+91
        28 007270   200201 755100                    STA     CTR_LVL_FIELD+5,,AUTO

  37625 28 007271   000134 235000 xsym               LDA     COMCOM+92
        28 007272   200202 755100                    STA     CTR_LVL_FIELD+6,,AUTO

     2634    37637
     2635    37638    2              CALL STORE_EDITED (LTS$$ -> REPORT_LTS.CONTROL$);

  37638 28 007273   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007274   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:419  
        28 007275   100005 633500                    EPPR3   5,,PR1
        28 007276   200207 453500                    STP3    CTR_LVL_ETT$+3,,AUTO
        28 007277   003130 701000 28                 TSX1    STORE_EDITED
        28 007300   000000 011000                    NOP     0

     2636    37639
     2637    37640    2              CALL BUILD_CTR_FIELDS (LTS$$ -> REPORT_LTS.CONTROL$);

  37640 28 007301   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007302   000000 471500                    LDP1    0,,PR0
        28 007303   100005 633500                    EPPR3   5,,PR1
        28 007304   200207 453500                    STP3    CTR_LVL_ETT$+3,,AUTO
        28 007305   003235 701000 28                 TSX1    BUILD_CTR_FIELDS
        28 007306   000000 011000                    NOP     0

     2638    37641
     2639    37642    2              CALL CREATE_SHADOW_INIT_SUB (LTS$$ -> REPORT_LTS.CONTROL$);

  37642 28 007307   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007310   000000 471500                    LDP1    0,,PR0
        28 007311   100005 633500                    EPPR3   5,,PR1
        28 007312   200207 453500                    STP3    CTR_LVL_ETT$+3,,AUTO
        28 007313   003673 701000 28                 TSX1    CREATE_SHADOW_INIT_SUB
        28 007314   000000 011000                    NOP     0

     2640    37643
     2641    37644    2              CALL CREATE_CTR_DETECT_SUB (LTS$$ -> REPORT_LTS.CONTROL$);

  37644 28 007315   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007316   000000 471500                    LDP1    0,,PR0
        28 007317   100005 633500                    EPPR3   5,,PR1
        28 007320   200207 453500                    STP3    CTR_LVL_ETT$+3,,AUTO
        28 007321   004074 701000 28                 TSX1    CREATE_CTR_DETECT_SUB
        28 007322   000000 011000                    NOP     0

     2642    37645
     2643    37646    2              CALL CREATE_SHADOW_SWAP_SUB (LTS$$ -> REPORT_LTS.CONTROL$);
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:420  

  37646 28 007323   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007324   000000 471500                    LDP1    0,,PR0
        28 007325   100005 633500                    EPPR3   5,,PR1
        28 007326   200207 453500                    STP3    CTR_LVL_ETT$+3,,AUTO
        28 007327   004613 701000 28                 TSX1    CREATE_SHADOW_SWAP_SUB
        28 007330   000000 011000                    NOP     0

     2644    37647
     2645    37648    2              CALL DISPOSE_CTR_FIELDS (LTS$$ -> REPORT_LTS.CONTROL$);

  37648 28 007331   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007332   000000 471500                    LDP1    0,,PR0
        28 007333   100005 633500                    EPPR3   5,,PR1
        28 007334   200207 453500                    STP3    CTR_LVL_ETT$+3,,AUTO
        28 007335   003542 701000 28                 TSX1    DISPOSE_CTR_FIELDS
        28 007336   000000 011000                    NOP     0

     2646    37649
     2647    37650    2              CALL RESTORE_EDITED (LTS$$ -> REPORT_LTS.CONTROL$);

  37650 28 007337   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007340   000000 471500                    LDP1    0,,PR0
        28 007341   100005 633500                    EPPR3   5,,PR1
        28 007342   200207 453500                    STP3    CTR_LVL_ETT$+3,,AUTO
        28 007343   003202 701000 28                 TSX1    RESTORE_EDITED
        28 007344   000000 011000                    NOP     0

     2648    37651
     2649    37652    2            END;

     2650    37653
     2651    37654
     2652    37655    1          CURRENT$ = LTS$$ -> REPORT_LTS.DETAIL$;

  37655 28 007345   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007346   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:421  
        28 007347   100027 236100                    LDQ     23,,PR1
        28 007350   200025 756100                    STQ     CURRENT$,,AUTO

     2653    37656
     2654    37657    2          DO WHILE (CURRENT$ ~= ADDR(NIL));

  37657 28 007351   007361 710000 28                 TRA     s:37663

     2655    37658
     2656    37659    2            CALL GEN_SPECIAL_SUB (CURRENT$);

  37659 28 007352   200025 630500                    EPPR0   CURRENT$,,AUTO
        28 007353   200207 450500                    STP0    CTR_LVL_ETT$+3,,AUTO
        28 007354   006244 701000 28                 TSX1    GEN_SPECIAL_SUB
        28 007355   000000 011000                    NOP     0

     2657    37660
     2658    37661    2            CURRENT$ = CURRENT$ -> REPORT_01_LTS.LINK;

  37661 28 007356   200025 470500                    LDP0    CURRENT$,,AUTO
        28 007357   000007 236100                    LDQ     7,,PR0
        28 007360   200025 756100                    STQ     CURRENT$,,AUTO

     2659    37662
     2660    37663    2          END; /* WHILE */

  37663 28 007361   000017 116000 29                 CMPQ    15
        28 007362   007352 601000 28                 TNZ     s:37659

     2661    37664
     2662    37665    1          CURRENT$ = LTS$$ -> REPORT_LTS.CONTROL_FOOTING_FINAL$;

  37665 28 007363   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007364   000000 471500                    LDP1    0,,PR0
        28 007365   100031 236100                    LDQ     25,,PR1
        28 007366   200025 756100                    STQ     CURRENT$,,AUTO

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:422  
     2663    37666
     2664    37667    1        IF CURRENT$ ~= ADDR(NIL) THEN

  37667 28 007367   000017 116000 29                 CMPQ    15
        28 007370   007404 600000 28                 TZE     s:37759

     2665    37668    2          DO;

     2666    37669    3            DO WHILE (CURRENT$ ~= ADDR(NIL));

  37669 28 007371   007401 710000 28                 TRA     s:37675

     2667    37670
     2668    37671    3              CALL GEN_SUM_SUBS (CURRENT$);

  37671 28 007372   200025 630500                    EPPR0   CURRENT$,,AUTO
        28 007373   200207 450500                    STP0    CTR_LVL_ETT$+3,,AUTO
        28 007374   006212 701000 28                 TSX1    GEN_SUM_SUBS
        28 007375   000000 011000                    NOP     0

     2669    37672
     2670    37673    3              CURRENT$ = CURRENT$ -> REPORT_01_LTS.LINK;

  37673 28 007376   200025 470500                    LDP0    CURRENT$,,AUTO
        28 007377   000007 236100                    LDQ     7,,PR0
        28 007400   200025 756100                    STQ     CURRENT$,,AUTO

     2671    37674
     2672    37675    3            END; /* WHILE */

  37675 28 007401   000017 116000 29                 CMPQ    15
        28 007402   007372 601000 28                 TNZ     s:37671

     2673    37676    2          END;

  37676 28 007403   007532 710000 28                 TRA     s:37799

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:423  
     2674    37677    1        ELSE
     2675    37678    2          DO;

     2676    37679                 %NEW_REPORT_01_LTS (@POINTER = PHONY_LTS$,
     2677    37680                                     @CONTROL_LTS$ = LTS$$ -> REPORT_LTS.CONTROL_FINAL$);

  37759 28 007404   000002 236000 23                 LDQ     LTS_+2
        28 007405   000024 036007                    ADLQ    20,DL
        28 007406   000003 116000 23                 CMPQ    LTS_+3
        28 007407   007420 604000 28                 TMI     s:37761

  37760 28 007410   000074 236000 29                 LDQ     60
        28 007411   200252 756100                    STQ     CETT$$+1,,AUTO
        28 007412   200252 631500                    EPPR1   CETT$$+1,,AUTO
        28 007413   200253 451500                    STP1    CETT$$+2,,AUTO
        28 007414   200253 630500                    EPPR0   CETT$$+2,,AUTO
        28 007415   000034 631400 29                 EPPR1   28
        28 007416   000000 701000 xent               TSX1    Z8AR$RESERVER
        28 007417   000000 011000                    NOP     0

  37761 28 007420   000002 236000 23                 LDQ     LTS_+2
        28 007421   000022 736000                    QLS     18
        28 007422   000001 036000 23                 ADLQ    LTS_+1
        28 007423   200026 756100                    STQ     PHONY_LTS$,,AUTO

  37762 28 007424   000024 236007                    LDQ     20,DL
        28 007425   000002 056000 23                 ASQ     LTS_+2

  37763 28 007426   001101 220003                    LDX0    577,DU
        28 007427   200026 470500                    LDP0    PHONY_LTS$,,AUTO
        28 007430   000000 740100                    STX0    0,,PR0

  37769 28 007431   200026 470500                    LDP0    PHONY_LTS$,,AUTO
        28 007432   000000 740100                    STX0    0,,PR0

  37770 28 007433   000017 236000 29                 LDQ     15
        28 007434   200026 470500                    LDP0    PHONY_LTS$,,AUTO
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:424  
        28 007435   000003 756100                    STQ     3,,PR0

  37771 28 007436   000017 236000 29                 LDQ     15
        28 007437   200026 470500                    LDP0    PHONY_LTS$,,AUTO
        28 007440   000004 756100                    STQ     4,,PR0

  37772 28 007441   000017 236000 29                 LDQ     15
        28 007442   200026 470500                    LDP0    PHONY_LTS$,,AUTO
        28 007443   000006 756100                    STQ     6,,PR0

  37773 28 007444   000017 236000 29                 LDQ     15
        28 007445   200026 470500                    LDP0    PHONY_LTS$,,AUTO
        28 007446   000005 756100                    STQ     5,,PR0

  37774 28 007447   000017 236000 29                 LDQ     15
        28 007450   200026 470500                    LDP0    PHONY_LTS$,,AUTO
        28 007451   000007 756100                    STQ     7,,PR0

  37775 28 007452   000017 236000 29                 LDQ     15
        28 007453   200026 470500                    LDP0    PHONY_LTS$,,AUTO
        28 007454   000022 756100                    STQ     18,,PR0

  37776 28 007455   200026 470500                    LDP0    PHONY_LTS$,,AUTO
        28 007456   000023 756100                    STQ     19,,PR0

  37777 28 007457   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007460   000000 471500                    LDP1    0,,PR0
        28 007461   100006 236100                    LDQ     6,,PR1
        28 007462   200026 473500                    LDP3    PHONY_LTS$,,AUTO
        28 007463   300014 756100                    STQ     12,,PR3

  37778 28 007464   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007465   100010 450100                    STZ     8,,PR1

  37779 28 007466   000017 236000 29                 LDQ     15
        28 007467   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007470   100015 756100                    STQ     13,,PR1
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:425  

  37780 28 007471   000017 236000 29                 LDQ     15
        28 007472   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007473   100016 756100                    STQ     14,,PR1

  37781 28 007474   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007475   100017 450100                    STZ     15,,PR1

  37782 28 007476   000017 236000 29                 LDQ     15
        28 007477   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007500   100021 756100                    STQ     17,,PR1

  37783 28 007501   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007502   100020 450100                    STZ     16,,PR1

  37784 28 007503   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007504   100001 450100                    STZ     1,,PR1

  37785 28 007505   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007506   100011 450100                    STZ     9,,PR1

  37786 28 007507   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007510   100012 450100                    STZ     10,,PR1

  37787 28 007511   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007512   100002 450100                    STZ     2,,PR1

  37788 28 007513   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007514   100013 450100                    STZ     11,,PR1

  37789 28 007515   000000 221003                    LDX1    0,DU
        28 007516   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007517   100000 441100                    SXL1    0,,PR1

  37790 28 007520   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007521   000037 236000 29                 LDQ     31
        28 007522   100000 356100                    ANSQ    0,,PR1
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:426  

  37791 28 007523   200026 471500                    LDP1    PHONY_LTS$,,AUTO
        28 007524   000041 236000 29                 LDQ     33
        28 007525   100000 356100                    ANSQ    0,,PR1

     2678    37794
     2679    37795    2            CALL GEN_SUM_SUBS (PHONY_LTS$);

  37795 28 007526   200026 631500                    EPPR1   PHONY_LTS$,,AUTO
        28 007527   200207 451500                    STP1    CTR_LVL_ETT$+3,,AUTO
        28 007530   006212 701000 28                 TSX1    GEN_SUM_SUBS
        28 007531   000000 011000                    NOP     0

     2680    37796    2          END;

     2681    37797
     2682    37798
     2683    37799    1          CURRENT$ = LTS$$ -> REPORT_LTS.CONTROL_FOOTING$;

  37799 28 007532   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007533   000000 471500                    LDP1    0,,PR0
        28 007534   100030 236100                    LDQ     24,,PR1
        28 007535   200025 756100                    STQ     CURRENT$,,AUTO

     2684    37800
     2685    37801    2          DO WHILE (CURRENT$ ~= ADDR(NIL));

  37801 28 007536   007546 710000 28                 TRA     s:37807

     2686    37802
     2687    37803    2            CALL GEN_SUM_SUBS (CURRENT$);

  37803 28 007537   200025 630500                    EPPR0   CURRENT$,,AUTO
        28 007540   200207 450500                    STP0    CTR_LVL_ETT$+3,,AUTO
        28 007541   006212 701000 28                 TSX1    GEN_SUM_SUBS
        28 007542   000000 011000                    NOP     0

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:427  
     2688    37804
     2689    37805    2            CURRENT$ = CURRENT$ -> REPORT_01_LTS.LINK;

  37805 28 007543   200025 470500                    LDP0    CURRENT$,,AUTO
        28 007544   000007 236100                    LDQ     7,,PR0
        28 007545   200025 756100                    STQ     CURRENT$,,AUTO

     2690    37806
     2691    37807    2          END; /* WHILE */

  37807 28 007546   000017 116000 29                 CMPQ    15
        28 007547   007537 601000 28                 TNZ     s:37803

     2692    37808
     2693    37809    1          CALL GEN_GENERAL_SUB;

  37809 28 007550   006424 701000 28                 TSX1    GEN_GENERAL_SUB
        28 007551   000000 011000                    NOP     0

     2694    37810
     2695    37811    1          IF LTS$$ -> REPORT_LTS.CONTROL$ ~= ADDR(NIL) THEN

  37811 28 007552   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007553   000000 471500                    LDP1    0,,PR0
        28 007554   100005 236100                    LDQ     5,,PR1
        28 007555   000017 116000 29                 CMPQ    15
        28 007556   007603 600000 28                 TZE     s:37820

     2696    37812    2            DO;

     2697    37813    3              DO I = 1 TO LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.N - 3;

  37813 28 007557   000001 235007                    LDA     1,DL
        28 007560   200007 755100                    STA     I,,AUTO
        28 007561   007573 710000 28                 TRA     s:37817+1

     2698    37814
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:428  
     2699    37815    3               CALL GEN_RESET_SUB (LTS$$ -> REPORT_LTS.CONTROL$ -> LTS_PTR_ARRAY.P$(I)
             37815                         );

  37815 28 007562   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007563   000000 471500                    LDP1    0,,PR0
        28 007564   100005 473500                    LDP3    5,,PR1
        28 007565   200007 720100                    LXL0    I,,AUTO
        28 007566   300002 634510                    EPPR4   2,X0,PR3
        28 007567   200207 454500                    STP4    CTR_LVL_ETT$+3,,AUTO
        28 007570   006002 701000 28                 TSX1    GEN_RESET_SUB
        28 007571   000000 011000                    NOP     0

     2700    37816
     2701    37817    3              END;

  37817 28 007572   200007 054100                    AOS     I,,AUTO
        28 007573   200003 470500                    LDP0    @LTS$$,,AUTO
        28 007574   000000 471500                    LDP1    0,,PR0
        28 007575   100005 473500                    LDP3    5,,PR1
        28 007576   300000 236100                    LDQ     0,,PR3
        28 007577   777777 376007                    ANQ     -1,DL
        28 007600   000003 136007                    SBLQ    3,DL
        28 007601   200007 116100                    CMPQ    I,,AUTO
        28 007602   007562 605000 28                 TPL     s:37815

     2702    37818    2            END;

     2703    37819
     2704    37820    1          CALL GEN_RESET_SUB (LTS$$ -> REPORT_LTS.CONTROL_FINAL$);

  37820 28 007603   100006 633500                    EPPR3   6,,PR1
        28 007604   200207 453500                    STP3    CTR_LVL_ETT$+3,,AUTO
        28 007605   006002 701000 28                 TSX1    GEN_RESET_SUB
        28 007606   000000 011000                    NOP     0

     2705    37821
     2706    37822    1    END Z8ET$CREATE_SUBROUTINES;
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:429  

  37822 28 007607   000000 702200 xent               TSX2  ! X66_ARET
     2707    37823         %EOD;

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:430  
--  Include file information  --

   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$CREATE_SUBROUTINES.
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:431  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:432  
  ****  Section 005 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 006 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 007 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 008 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 009 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 010 LblCom ST_

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:433  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_

  ****  Section 011 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 012 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 013 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 QLT_

  ****  Section 014 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 015 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:434  

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 016 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 017 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 018 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 019 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 020 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:435  

  ****  Section 021 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 022 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 023 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 024 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Section 025 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 026 LblCom TEMP_LX_NODE
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:436  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)         1 TEMP_LX_NODE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   215-0-0/w PTR         r     1 @ADD_LIST$               207-0-0/w PTR         r     1 @CONTROL$$
   207-0-0/w PTR         r     1 @CONTROL$$               207-0-0/w PTR         r     1 @CONTROL$$
   207-0-0/w PTR         r     1 @CONTROL$$               207-0-0/w PTR         r     1 @CONTROL$$
   207-0-0/w PTR         r     1 @CONTROL$$               207-0-0/w PTR         r     1 @CONTROL$$
   207-0-0/w PTR         r     1 @CONTROL_LTS$            207-0-0/w PTR         r     1 @CURRENT$
   211-0-0/w PTR         r     1 @GROUP$                  211-0-0/w PTR         r     1 @GROUP$$
   211-0-0/w PTR         r     1 @GROUP$$                 207-0-0/w PTR         r     1 @GROUP$$
   215-0-0/w PTR         r     1 @ITEM$                     3-0-0/w PTR         r     1 @LTS$$
   216-0-0/w PTR         r     1 @SHADOW$                  *0-0-0/w PTR         r     1 ADD_LIST$
    15-0-0/w PTR         r     1 AFTER_AREA_ETT$           32-0-0/d STRC(288)   r     1 AFTER_FIELD
    31-0-0/w BIT         r     1 ALL_BIT                  216-0-0/w PTR         r     1 BIN_OP$
    12-0-0/w PTR         r     1 BUFFER_ETT$              226-0-0/w PTR         r     1 BUF_ST$
   222-0-0/w UBIN              1 BYTE_POS                 251-0-0/w PTR         r     1 CETT$$
    20-0-0/w PTR         r     1 CODE_ETT$                144-0-0/d STRC(288)   r     1 COMPARE
    11-0-0/w PTR         r     1 CONST_ETT$                *0-0-0/w PTR         r     1 CONTROL$$
    *0-0-0/w PTR         r     1 CONTROL$$                 *0-0-0/w PTR         r     1 CONTROL$$
    *0-0-0/w PTR         r     1 CONTROL$$                 *0-0-0/w PTR         r     1 CONTROL$$
    *0-0-0/w PTR         r     1 CONTROL$$                 *0-0-0/w PTR         r     1 CONTROL$$
    *0-0-0/w PTR         r     1 CONTROL_LTS$             211-0-0/w SBIN              1 CTR_FINAL_IND
   204-0-0/w PTR         r     1 CTR_LVL_ETT$             174-0-0/d STRC(288)   r     1 CTR_LVL_FIELD
   243-0-0/w SBIN        r     1 CTR_LVL_NO#               25-0-0/w PTR         r     1 CURRENT$
   212-0-0/w PTR         r     1 CURRENT$                  *0-0-0/w PTR         r     1 CURRENT$
    52-0-0/w PTR         r     1 DETAIL_GRP$              246-0-0/w PTR         r     1 END_LABEL$
   245-0-0/w PTR         r     1 END_LABEL$               211-0-0/w PTR         r     1 ETT$$
   244-0-0/w PTR         r     1 ETT$$                     54-0-0/d STRC(288)   r     1 ETT_ITEM
   220-0-0/d STRC(288)   r     1 ETT_ITEM                  27-0-0/w PTR         r     1 FILE_LTS$
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:437  
    *0-0-0/w PTR         r     1 GROUP$                    *0-0-0/w PTR         r     1 GROUP$$
    *0-0-0/w PTR         r     1 GROUP$$                   *0-0-0/w PTR         r     1 GROUP$$
     7-0-0/w SBIN        r     1 I                         21-0-0/w PTR         r     1 IND$$
    22-0-0/w PTR         r     1 IND_ETT$                 154-0-0/d STRC(288)   r     1 IND_FIELD
    *0-0-0/w PTR         r     1 ITEM$                    207-0-0/w PTR         r     1 LABEL$
   214-0-0/w PTR         r     1 LABEL$                   210-0-0/w PTR         r     1 LABEL$
   242-0-0/w PTR         r     1 LABEL$                   210-0-0/w PTR         r     1 LABEL$
   212-0-0/w PTR         r     1 LABEL$                   212-0-0/w PTR         r     1 LABEL$
   210-0-0/w PTR         r     1 LABEL$                   210-0-0/w PTR         r     1 LABEL$
   207-0-0/w PTR         r     1 LABEL$                     6-0-0/w SBIN        r     1 LAST_WORD_OFFSET
   210-0-0/w PTR         r     1 LBL$$(0:25)              212-0-0/w PTR         r     1 LBL$$(0:25)
    14-0-0/w PTR         r     1 LINE_COUNTER_ETT$         42-0-0/d STRC(288)   r     1 LINE_COUNTER_FIELD
   124-0-0/d STRC(288)   r     1 LINE_FIELD               217-0-0/w UBIN        r     1 LINE_NO#
   216-0-0/w SBIN        r     1 LINE_SPAN                 *0-0-0/w PTR         r     1 LTS$$
   211-0-0/w PTR         r     1 LX_ETT$                   24-0-0/w SBIN        r     1 MIN_REC_LEN
   210-0-0/w PTR         r     1 NAME$                    211-0-0/w PTR         r     1 NAME$
   210-0-0/w PTR         r     1 NAME$                    244-0-0/w PTR         r     1 NAME$$
   247-0-0/w PTR         r     1 NAME$$                   213-0-0/w PTR         r     1 NEXT$
   164-0-0/d STRC(288)   r     1 ONE_FIELD                 64-0-0/d STRC(288)   r     1 OP_NODE
    13-0-0/w PTR         r     1 PAGE_COUNTER_ETT$         26-0-0/w PTR         r     1 PHONY_LTS$
   215-0-0/w PTR         r     1 PREV$                    224-0-0/w PTR         r     1 QLT$$
    23-0-0/w SBIN        r     1 RECORD_LEN               114-0-0/d STRC(288)   r     1 RECORD_LENGTH
   211-0-0/w PTR               1 RECV$                     17-0-0/w PTR         r     1 RECV_ETT$
   104-0-0/d STRC(288)   r     1 RECV_FIELD               225-0-0/w PTR         r     1 RECV_ST$
     4-0-0/w UBIN        r     1 REPORT_CODE_NO             5-0-0/w SBIN        r     1 RWCT_LEN
    10-0-0/w SBIN        r     1 SA_ADJ                   210-0-0/w PTR               1 SEND$
    16-0-0/w PTR         r     1 SEND_ETT$                 74-0-0/d STRC(288)   r     1 SEND_FIELD
    *0-0-0/w PTR         r     1 SHADOW$                  220-0-0/w PTR         r     1 ST$$
   211-0-0/w PTR         r     1 ST$$                     210-0-0/w PTR               1 ST$$
   212-0-0/w PTR         r     1 ST$$                     246-0-0/w PTR         r     1 START_LABEL$
   221-0-0/w UBIN        r     1 ST_TYPE                  213-0-0/w PTR         r     1 SUM$$
   245-0-0/w SBIN        r     1 TARGET_NO#               250-0-0/w SBIN        r     1 TARGET_NO#
    30-0-0/w PTR         r     1 VAL_ST$                  223-0-0/w UBIN              1 WORD_POS
   134-0-0/d STRC(288)   r     1 ZERO

  ****  SYMREF variables  ****

PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:438  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)   r     1 BINARY_ILL
     0-0-0/w STRC(288)   r     1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)   r     1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)   r     1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:439  
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)   r     1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)  r     1 FILE_LTS                   0-0-0/w STRC(144)   r     1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(180)         1 ILS                        0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)   r     1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(108)         1 LINOI
     0-0-0/w STRC(72)    r     1 LONG                       0-0-0/w STRC        r     1 LTS
     0-0-0/w STRC(360)   r     1 LTSS                       0-0-0/w STRC(36936) r     1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)   r     1 LX_ETT_ITEM
     0-0-0/w STRC(288)   r     1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(72)          1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(144)         1 OPN
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)   r     1 PREOFF
     0-0-0/w STRC(108)   r     1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(144)   r     1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(144)         1 REMEM
PL6.E3A0      #004=Z8ET$CREATE_SUBROUTINES File=Z8ET.:Z8A6TSI                    SAT 08/09/97 12:48 Page:440  
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)   r     1 REPORT_01_LTS
     0-0-0/w STRC(432)   r     1 REPORT_ELEM_LTS            0-0-0/w STRC(252)   r     1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)  r     1 REPORT_LTS                 0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(144)         1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)   r     1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(216)         1 USER_CALL                  0-0-0/w STRC(252)         1 USE_SUPP
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)         1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8ET$CREATE_SUBROUTINES requires 3976 words for executable code.
   Procedure Z8ET$CREATE_SUBROUTINES requires 182 words of local(AUTO) storage.

PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:441  
     2708        1        /*T***********************************************************/
     2709        2        /*T*                                                         */
     2710        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2711        4        /*T*                                                         */
     2712        5        /*T***********************************************************/
     2713        6
     2714        7        /*M*  Z8ET$USE_BEFORE_REPORTING---Save the USE PROC address*/
     2715        8
     2716        9
     2717       10        /*P*
     2718       11               NAME:  Z8ET$USE_BEFORE_REPORTING
     2719       12             AUTHOR:  Min Lee.
     2720       13            PURPOSE:  Verify the USE BEFORE REPORTING statement and save
     2721       14                      the USE procedure's entry point.
     2722       15        */
     2723       16
     2724       17        /*D*
     2725       18               NAME:  Z8ET$USE_BEFORE_REPORTING
     2726       19               CALL:  CALL Z8ET$USE_BEFORE_REPORTING(GLOBAL$,OPERAND$,USE_SECT$)
     2727       20              INPUT:  USE_SECT$ --- entry point of the USE PROC
     2728       21                      GLOBAL$   --- LX_STK item for GLOBAL clause
     2729       22                      OPERAND$  --- qual_id list for the report group name
     2730       23
     2731       24        DESCRIPTION:  verify the operand and GLOBAL clause in the USE BEFORE
     2732       25                      REPORTING statement and then save the USE procedure's
     2733       26                      entry point.
     2734       27         */
     2735       28         %EJECT;
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:442  
     2736       29
     2737       30         /*=========================*/
     2738       31           Z8ET$USE_BEFORE_REPORTING: PROC (GLOBAL$, OPERAND$, USE_SECT$);
     2739       32         /*=========================*/
     2740       33
     2741       34        %EQU PHASE = 1;
     2742       35
     2743       36        %INCLUDE Z8A_DEFC;
     2744      104        %INCLUDE Z8A_SUPP_MAC ;
     2745     2504        %INCLUDE Z8E_STACKS ;
     2746     4770        %INCLUDE Z8E_O1COM;
     2747     5531        %INCLUDE Z8E_MACROS;
     2748     6206        %INCLUDE Z8A_ERR_NUMS;
     2749     6970        %INCLUDE Z8A_TYPES;
     2750     7144        %INCLUDE Z8A_ST ;
     2751    10803        %INCLUDE Z8E_WINDOW;
     2752    12873        %INCLUDE Z8A_ETT ;
     2753    13174        %INCLUDE Z8A_ILL ;
     2754    13867        %INCLUDE Z8A_ILS ;
     2755    13976        %INCLUDE Z8A_LTS ;
     2756    16053
     2757    16054    1   DCL GLOBAL$        PTR;
     2758    16055    1   DCL OPERAND$       PTR;
     2759    16056    1   DCL USE_SECT$      PTR;
     2760    16057    1   DCL GROUP_LTS$     PTR;
     2761    16058    1   DCL ST$$           PTR;
     2762    16059    1   DCL NEXT$          PTR;
     2763    16060
     2764    16061    1   DCL Z8AE$ERROR ENTRY (12);
     2765    16062    1   DCL Z8CO$QUALIFY_VARIABLE ENTRY (2) ALTRET;
     2766    16063    1   DCL Z8AT$CREATE_TEMPORARY ENTRY (2);
     2767    16064
     2768    16065    1          CALL Z8CO$QUALIFY_VARIABLE (OPERAND$, ST$$);
     2769    16066
     2770    16067    1          IF ST$$ -> SCALAR.LTS$ = ADDR(NIL) THEN
     2771    16068    1            GROUP_LTS$ = ADDR(NIL);
     2772    16069    1          ELSE
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:443  
     2773    16070                 %GET_LTS (@ID   = %REPORT_01_LTS,
     2774    16071                           @ST$  = ST$$,
     2775    16072                           @RETURN$ = GROUP_LTS$);
     2776    16115
     2777    16116    1          IF GROUP_LTS$ = ADDR(NIL) OR
     2778    16117    1             GROUP_LTS$ -> LTS.ID ~= %REPORT_01_LTS THEN
     2779    16118    2            DO;
     2780    16119    2              CALL Z8AE$ERROR (%E$MUST_BE_REPORT_GROUP,
     2781    16120    2                               OPERAND$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     2782    16121    2                               OPERAND$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
     2783    16122
     2784    16123                   %NEW_REPORT_01_LTS (@POINTER = O1COM.USE_REPORT$);
     2785    16237
     2786    16238    2              RETURN;
     2787    16239    2            END;
     2788    16240
     2789    16241    1          IF GLOBAL$ -> LX_TERMINAL.SYMBOL ~= %EMPTY AND
     2790    16242    1                NOT ST$$ -> SCALAR.B.GLOBAL THEN
     2791    16243
     2792    16244                 %CONDITIONAL_ERROR (@LX_ITEM$  = GLOBAL$,
     2793    16245                                     @ERROR#    = %E$GLOBAL_INVALID_IN_USE,
     2794    16246                                     @LINE      = GLOBAL$ -> LX_ITEM.LINE,
     2795    16247                                     @COLUMN    = GLOBAL$ -> LX_ITEM.COLUMN);
     2796    16277
     2797    16278    1          NEXT$ = O1COM.REPORT_DD$;
     2798    16279
     2799    16280    2          DO WHILE (NEXT$ ~= ADDR(NIL));
     2800    16281
     2801    16282    2            IF NEXT$ = GROUP_LTS$ THEN
     2802    16283    3              DO;
     2803    16284    3                CALL Z8AE$ERROR (%E$DUP_USE_BEFORE_REPORTING,
     2804    16285    3                                 OPERAND$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     2805    16286    3                                 OPERAND$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
     2806    16287
     2807    16288    3                RETURN;
     2808    16289    3              END;
     2809    16290
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:444  
     2810    16291    2            NEXT$ = NEXT$ -> REPORT_01_LTS.USE_CHAIN$;
     2811    16292
     2812    16293    2          END; /* WHILE */
     2813    16294
     2814    16295    1          GROUP_LTS$ -> REPORT_01_LTS.USE_CHAIN$ = O1COM.REPORT_DD$;
     2815    16296    1          O1COM.REPORT_DD$ = GROUP_LTS$;
     2816    16297
     2817    16298
     2818    16299    1          IF GROUP_LTS$ -> REPORT_01_LTS.RWCT$ = ADDR(NIL) THEN
     2819    16300    2            DO;
     2820    16301
     2821    16302    2              CALL Z8AT$CREATE_TEMPORARY (%SCALAR,
     2822    16303    2                        GROUP_LTS$ -> REPORT_01_LTS.RWCT$);
     2823    16304
     2824    16305    2              GROUP_LTS$ -> REPORT_01_LTS.RWCT$ -> SCALAR.TYPE = %TYA;
     2825    16306    2              GROUP_LTS$ -> REPORT_01_LTS.RWCT$ -> SCALAR.ADSC.N = 32;
     2826    16307    2              GROUP_LTS$ -> REPORT_01_LTS.RWCT$ -> SCALAR.ADSC.TA = %ADSC9;
     2827    16308
     2828    16309    2            END;
     2829    16310
     2830    16311    1          USE_SECT$ -> SECTION.B.REFERENCED = TRUE;
     2831    16312
     2832    16313               %NEW_ILL(@ID  = %P_A_PRESET,
     2833    16314                        @OFFSET = %USE_PROC_PTR_OFF,
     2834    16315                        @TO     = GROUP_LTS$ -> REPORT_01_LTS.RWCT$,
     2835    16316                        @LOP    = USE_SECT$,
     2836    16317                        @ROPCON = 0);
     2837    16696
     2838    16697    1          O1COM.USE_REPORT$ = GROUP_LTS$;
     2839    16698
     2840    16699
     2841    16700    1    RETURN;
     2842    16701    1    END Z8ET$USE_BEFORE_REPORTING;
     2843    16702         %EOD;

PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:445  
--  Include file information  --

   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$USE_BEFORE_REPORTING.

   Procedure Z8ET$USE_BEFORE_REPORTING requires 231 words for executable code.
   Procedure Z8ET$USE_BEFORE_REPORTING requires 16 words of local(AUTO) storage.

PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:446  

 Object Unit name= Z8ET$USE_BEFORE_REPORTING                  File name= Z8ET.:Z8A6TOU
 UTS= AUG 09 '97 12:54:22.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  ST$
    6  LblCom even  none     5      5  ST_
    7  LblCom even  none     1      1  ETT$
    8  LblCom even  none     1      1  HEAD_ETT$
    9  LblCom even  none   512   1000  ETT_BUCKETS
   10  LblCom even  none     5      5  ETT_
   11  LblCom even  none     1      1  ILL$
   12  LblCom even  none     5      5  ILL_
   13  LblCom even  none     1      1  ILS$
   14  LblCom even  none     5      5  ILS_
   15  LblCom even  none     1      1  LTS$
   16  LblCom even  none     5      5  LTS_
   17   Proc  even  none   231    347  Z8ET$USE_BEFORE_REPORTING
   18  RoData even  none    24     30  Z8ET$USE_BEFORE_REPORTING

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    17      0   yes            yes      Std        3  Z8ET$USE_BEFORE_REPORTING
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:447  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 Z8CO$QUALIFY_VARIABLE
         yes           Std      12 Z8AE$ERROR
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       1 Z8AR$RESERVER
         yes           Std       2 Z8AT$CREATE_TEMPORARY
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     O1COM                                 HIER_STK_PTR                          HIER_STK
     PAGE_FORMAT                           REP_STK_PTR                           REP_STK
r    ILL_STEP                         r    ILS_STEP_TABLE                   r    LTS_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:448  


     2708        1        /*T***********************************************************/
     2709        2        /*T*                                                         */
     2710        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2711        4        /*T*                                                         */
     2712        5        /*T***********************************************************/
     2713        6
     2714        7        /*M*  Z8ET$USE_BEFORE_REPORTING---Save the USE PROC address*/
     2715        8
     2716        9
     2717       10        /*P*
     2718       11               NAME:  Z8ET$USE_BEFORE_REPORTING
     2719       12             AUTHOR:  Min Lee.
     2720       13            PURPOSE:  Verify the USE BEFORE REPORTING statement and save
     2721       14                      the USE procedure's entry point.
     2722       15        */
     2723       16
     2724       17        /*D*
     2725       18               NAME:  Z8ET$USE_BEFORE_REPORTING
     2726       19               CALL:  CALL Z8ET$USE_BEFORE_REPORTING(GLOBAL$,OPERAND$,USE_SECT$)
     2727       20              INPUT:  USE_SECT$ --- entry point of the USE PROC
     2728       21                      GLOBAL$   --- LX_STK item for GLOBAL clause
     2729       22                      OPERAND$  --- qual_id list for the report group name
     2730       23
     2731       24        DESCRIPTION:  verify the operand and GLOBAL clause in the USE BEFORE
     2732       25                      REPORTING statement and then save the USE procedure's
     2733       26                      entry point.
     2734       27         */
     2735       28         %EJECT;
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:449  
     2736       29
     2737       30         /*=========================*/
     2738       31           Z8ET$USE_BEFORE_REPORTING: PROC (GLOBAL$, OPERAND$, USE_SECT$);

     31 17 000000   000000 700200 xent  Z8ET$USE_BE* TSX0  ! X66_AUTO_3
        17 000001   000020 000003                    ZERO    16,3

     2739       32         /*=========================*/
     2740       33
     2741       34        %EQU PHASE = 1;
     2742       35
     2743       36        %INCLUDE Z8A_DEFC;
     2744      104        %INCLUDE Z8A_SUPP_MAC ;
     2745     2504        %INCLUDE Z8E_STACKS ;
     2746     4770        %INCLUDE Z8E_O1COM;
     2747     5531        %INCLUDE Z8E_MACROS;
     2748     6206        %INCLUDE Z8A_ERR_NUMS;
     2749     6970        %INCLUDE Z8A_TYPES;
     2750     7144        %INCLUDE Z8A_ST ;
     2751    10803        %INCLUDE Z8E_WINDOW;
     2752    12873        %INCLUDE Z8A_ETT ;
     2753    13174        %INCLUDE Z8A_ILL ;
     2754    13867        %INCLUDE Z8A_ILS ;
     2755    13976        %INCLUDE Z8A_LTS ;
     2756    16053
     2757    16054    1   DCL GLOBAL$        PTR;
     2758    16055    1   DCL OPERAND$       PTR;
     2759    16056    1   DCL USE_SECT$      PTR;
     2760    16057    1   DCL GROUP_LTS$     PTR;
     2761    16058    1   DCL ST$$           PTR;
     2762    16059    1   DCL NEXT$          PTR;
     2763    16060
     2764    16061    1   DCL Z8AE$ERROR ENTRY (12);
     2765    16062    1   DCL Z8CO$QUALIFY_VARIABLE ENTRY (2) ALTRET;
     2766    16063    1   DCL Z8AT$CREATE_TEMPORARY ENTRY (2);
     2767    16064
     2768    16065    1          CALL Z8CO$QUALIFY_VARIABLE (OPERAND$, ST$$);
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:450  

  16065 17 000002   200007 630500                    EPPR0   ST$$,,AUTO
        17 000003   200013 450500                    STP0    NEXT$+3,,AUTO
        17 000004   200004 236100                    LDQ     @OPERAND$,,AUTO
        17 000005   200012 756100                    STQ     NEXT$+2,,AUTO
        17 000006   200012 630500                    EPPR0   NEXT$+2,,AUTO
        17 000007   000000 631400 18                 EPPR1   0
        17 000010   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        17 000011   000000 011000                    NOP     0

     2769    16066
     2770    16067    1          IF ST$$ -> SCALAR.LTS$ = ADDR(NIL) THEN

  16067 17 000012   200007 470500                    LDP0    ST$$,,AUTO
        17 000013   000005 236100                    LDQ     5,,PR0
        17 000014   000001 116000 18                 CMPQ    1
        17 000015   000021 601000 17                 TNZ     s:16074

     2771    16068    1            GROUP_LTS$ = ADDR(NIL);

  16068 17 000016   000001 236000 18                 LDQ     1
        17 000017   200006 756100                    STQ     GROUP_LTS$,,AUTO
        17 000020   000043 710000 17                 TRA     s:16116

     2772    16069    1          ELSE
     2773    16070                 %GET_LTS (@ID   = %REPORT_01_LTS,
     2774    16071                           @ST$  = ST$$,
     2775    16072                           @RETURN$ = GROUP_LTS$);

  16074 17 000021   000031 600000 17                 TZE     s:16108
        17 000022   000005 471500                    LDP1    5,,PR0
        17 000023   100000 220100                    LDX0    0,,PR1
        17 000024   001105 100003                    CMPX0   581,DU
        17 000025   000031 601000 17                 TNZ     s:16108

  16092 17 000026   100007 236100                    LDQ     7,,PR1
        17 000027   200006 756100                    STQ     GROUP_LTS$,,AUTO
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:451  

  16106 17 000030   000043 710000 17                 TRA     s:16116

  16108 17 000031   000001 116000 18                 CMPQ    1
        17 000032   000041 600000 17                 TZE     s:16112
        17 000033   000005 471500                    LDP1    5,,PR0
        17 000034   100000 220100                    LDX0    0,,PR1
        17 000035   001101 100003                    CMPX0   577,DU
        17 000036   000041 601000 17                 TNZ     s:16112

  16110 17 000037   200006 756100                    STQ     GROUP_LTS$,,AUTO
        17 000040   000043 710000 17                 TRA     s:16116

  16112 17 000041   000001 236000 18                 LDQ     1
        17 000042   200006 756100                    STQ     GROUP_LTS$,,AUTO

     2776    16115
     2777    16116    1          IF GROUP_LTS$ = ADDR(NIL) OR

  16116 17 000043   000001 116000 18                 CMPQ    1
        17 000044   000051 600000 17                 TZE     s:16119
        17 000045   200006 471500                    LDP1    GROUP_LTS$,,AUTO
        17 000046   100000 220100                    LDX0    0,,PR1
        17 000047   001101 100003                    CMPX0   577,DU
        17 000050   000176 600000 17                 TZE     s:16241

     2778    16117    1             GROUP_LTS$ -> LTS.ID ~= %REPORT_01_LTS THEN
     2779    16118    2            DO;

     2780    16119    2              CALL Z8AE$ERROR (%E$MUST_BE_REPORT_GROUP,

  16119 17 000051   200004 471500                    LDP1    @OPERAND$,,AUTO
        17 000052   100000 473500                    LDP3    0,,PR1
        17 000053   300004 474500                    LDP4    4,,PR3
        17 000054   400006 635500                    EPPR5   6,,PR4
        17 000055   200014 455500                    STP5    NEXT$+4,,AUTO
        17 000056   400005 633500                    EPPR3   5,,PR4
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:452  
        17 000057   200013 453500                    STP3    NEXT$+3,,AUTO
        17 000060   000004 236000 18                 LDQ     4
        17 000061   200012 756100                    STQ     NEXT$+2,,AUTO
        17 000062   200012 630500                    EPPR0   NEXT$+2,,AUTO
        17 000063   000002 631400 18                 EPPR1   2
        17 000064   000000 701000 xent               TSX1    Z8AE$ERROR
        17 000065   000000 011000                    NOP     0

     2781    16120    2                               OPERAND$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     2782    16121    2                               OPERAND$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
     2783    16122
     2784    16123                   %NEW_REPORT_01_LTS (@POINTER = O1COM.USE_REPORT$);

  16202 17 000066   000002 236000 16                 LDQ     LTS_+2
        17 000067   000024 036007                    ADLQ    20,DL
        17 000070   000003 116000 16                 CMPQ    LTS_+3
        17 000071   000102 604000 17                 TMI     s:16204

  16203 17 000072   000006 236000 18                 LDQ     6
        17 000073   200012 756100                    STQ     NEXT$+2,,AUTO
        17 000074   200012 630500                    EPPR0   NEXT$+2,,AUTO
        17 000075   200013 450500                    STP0    NEXT$+3,,AUTO
        17 000076   200013 630500                    EPPR0   NEXT$+3,,AUTO
        17 000077   000005 631400 18                 EPPR1   5
        17 000100   000000 701000 xent               TSX1    Z8AR$RESERVER
        17 000101   000000 011000                    NOP     0

  16204 17 000102   000002 236000 16                 LDQ     LTS_+2
        17 000103   000022 736000                    QLS     18
        17 000104   000001 036000 16                 ADLQ    LTS_+1
        17 000105   000106 756000 xsym               STQ     O1COM+70

  16205 17 000106   000024 236007                    LDQ     20,DL
        17 000107   000002 056000 16                 ASQ     LTS_+2

  16206 17 000110   001101 220003                    LDX0    577,DU
        17 000111   000106 470400 xsym               LDP0    O1COM+70
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:453  
        17 000112   000000 740100                    STX0    0,,PR0

  16212 17 000113   000106 470400 xsym               LDP0    O1COM+70
        17 000114   000000 740100                    STX0    0,,PR0

  16213 17 000115   000001 236000 18                 LDQ     1
        17 000116   000106 470400 xsym               LDP0    O1COM+70
        17 000117   000003 756100                    STQ     3,,PR0

  16214 17 000120   000106 470400 xsym               LDP0    O1COM+70
        17 000121   000004 756100                    STQ     4,,PR0

  16215 17 000122   000106 470400 xsym               LDP0    O1COM+70
        17 000123   000006 756100                    STQ     6,,PR0

  16216 17 000124   000106 470400 xsym               LDP0    O1COM+70
        17 000125   000005 756100                    STQ     5,,PR0

  16217 17 000126   000106 470400 xsym               LDP0    O1COM+70
        17 000127   000007 756100                    STQ     7,,PR0

  16218 17 000130   000106 470400 xsym               LDP0    O1COM+70
        17 000131   000022 756100                    STQ     18,,PR0

  16219 17 000132   000106 470400 xsym               LDP0    O1COM+70
        17 000133   000023 756100                    STQ     19,,PR0

  16220 17 000134   000106 470400 xsym               LDP0    O1COM+70
        17 000135   000014 756100                    STQ     12,,PR0

  16221 17 000136   000106 470400 xsym               LDP0    O1COM+70
        17 000137   000010 450100                    STZ     8,,PR0

  16222 17 000140   000106 470400 xsym               LDP0    O1COM+70
        17 000141   000015 756100                    STQ     13,,PR0

  16223 17 000142   000106 470400 xsym               LDP0    O1COM+70
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:454  
        17 000143   000016 756100                    STQ     14,,PR0

  16224 17 000144   000106 470400 xsym               LDP0    O1COM+70
        17 000145   000017 450100                    STZ     15,,PR0

  16225 17 000146   000106 470400 xsym               LDP0    O1COM+70
        17 000147   000021 756100                    STQ     17,,PR0

  16226 17 000150   000106 470400 xsym               LDP0    O1COM+70
        17 000151   000020 450100                    STZ     16,,PR0

  16227 17 000152   000106 470400 xsym               LDP0    O1COM+70
        17 000153   000001 450100                    STZ     1,,PR0

  16228 17 000154   000106 470400 xsym               LDP0    O1COM+70
        17 000155   000011 450100                    STZ     9,,PR0

  16229 17 000156   000106 470400 xsym               LDP0    O1COM+70
        17 000157   000012 450100                    STZ     10,,PR0

  16230 17 000160   000106 470400 xsym               LDP0    O1COM+70
        17 000161   000002 450100                    STZ     2,,PR0

  16231 17 000162   000106 470400 xsym               LDP0    O1COM+70
        17 000163   000013 450100                    STZ     11,,PR0

  16232 17 000164   000000 221003                    LDX1    0,DU
        17 000165   000106 470400 xsym               LDP0    O1COM+70
        17 000166   000000 441100                    SXL1    0,,PR0

  16233 17 000167   000106 470400 xsym               LDP0    O1COM+70
        17 000170   000007 236000 18                 LDQ     7
        17 000171   000000 356100                    ANSQ    0,,PR0

  16234 17 000172   000106 470400 xsym               LDP0    O1COM+70
        17 000173   000010 236000 18                 LDQ     8
        17 000174   000000 356100                    ANSQ    0,,PR0
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:455  

     2785    16237
     2786    16238    2              RETURN;

  16238 17 000175   000000 702200 xent               TSX2  ! X66_ARET

     2787    16239    2            END;
     2788    16240
     2789    16241    1          IF GLOBAL$ -> LX_TERMINAL.SYMBOL ~= %EMPTY AND

  16241 17 000176   200003 473500                    LDP3    @GLOBAL$,,AUTO
        17 000177   300000 474500                    LDP4    0,,PR3
        17 000200   400003 235100                    LDA     3,,PR4
        17 000201   000226 600000 17                 TZE     s:16278
        17 000202   000003 236100                    LDQ     3,,PR0
        17 000203   000010 316003                    CANQ    8,DU
        17 000204   000226 601000 17                 TNZ     s:16278

     2790    16242    1                NOT ST$$ -> SCALAR.B.GLOBAL THEN
     2791    16243
     2792    16244                 %CONDITIONAL_ERROR (@LX_ITEM$  = GLOBAL$,
     2793    16245                                     @ERROR#    = %E$GLOBAL_INVALID_IN_USE,
     2794    16246                                     @LINE      = GLOBAL$ -> LX_ITEM.LINE,
     2795    16247                                     @COLUMN    = GLOBAL$ -> LX_ITEM.COLUMN);

  16257 17 000205   400000 236100                    LDQ     0,,PR4
        17 000206   400000 316007                    CANQ    -131072,DL
        17 000207   000226 601000 17                 TNZ     s:16278

  16259 17 000210   400006 635500                    EPPR5   6,,PR4
        17 000211   200014 455500                    STP5    NEXT$+4,,AUTO
        17 000212   400005 636500                    EPPR6   5,,PR4
        17 000213   200013 456500                    STP6    NEXT$+3,,AUTO
        17 000214   000012 236000 18                 LDQ     10
        17 000215   200012 756100                    STQ     NEXT$+2,,AUTO
        17 000216   200012 630500                    EPPR0   NEXT$+2,,AUTO
        17 000217   000002 631400 18                 EPPR1   2
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:456  
        17 000220   000000 701000 xent               TSX1    Z8AE$ERROR
        17 000221   000000 011000                    NOP     0

  16268 17 000222   200003 470500                    LDP0    @GLOBAL$,,AUTO
        17 000223   000000 471500                    LDP1    0,,PR0
        17 000224   400000 236007                    LDQ     -131072,DL
        17 000225   100000 256100                    ORSQ    0,,PR1

     2796    16277
     2797    16278    1          NEXT$ = O1COM.REPORT_DD$;

  16278 17 000226   000067 236000 xsym               LDQ     O1COM+55
        17 000227   200010 756100                    STQ     NEXT$,,AUTO

     2798    16279
     2799    16280    2          DO WHILE (NEXT$ ~= ADDR(NIL));

  16280 17 000230   000255 710000 17                 TRA     s:16293

     2800    16281
     2801    16282    2            IF NEXT$ = GROUP_LTS$ THEN

  16282 17 000231   200010 236100                    LDQ     NEXT$,,AUTO
        17 000232   200006 116100                    CMPQ    GROUP_LTS$,,AUTO
        17 000233   000252 601000 17                 TNZ     s:16291

     2802    16283    3              DO;

     2803    16284    3                CALL Z8AE$ERROR (%E$DUP_USE_BEFORE_REPORTING,

  16284 17 000234   200004 470500                    LDP0    @OPERAND$,,AUTO
        17 000235   000000 471500                    LDP1    0,,PR0
        17 000236   100004 473500                    LDP3    4,,PR1
        17 000237   300006 634500                    EPPR4   6,,PR3
        17 000240   200014 454500                    STP4    NEXT$+4,,AUTO
        17 000241   300005 631500                    EPPR1   5,,PR3
        17 000242   200013 451500                    STP1    NEXT$+3,,AUTO
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:457  
        17 000243   000014 236000 18                 LDQ     12
        17 000244   200012 756100                    STQ     NEXT$+2,,AUTO
        17 000245   200012 630500                    EPPR0   NEXT$+2,,AUTO
        17 000246   000002 631400 18                 EPPR1   2
        17 000247   000000 701000 xent               TSX1    Z8AE$ERROR
        17 000250   000000 011000                    NOP     0

     2804    16285    3                                 OPERAND$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     2805    16286    3                                 OPERAND$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
     2806    16287
     2807    16288    3                RETURN;

  16288 17 000251   000000 702200 xent               TSX2  ! X66_ARET

     2808    16289    3              END;
     2809    16290
     2810    16291    2            NEXT$ = NEXT$ -> REPORT_01_LTS.USE_CHAIN$;

  16291 17 000252   200010 470500                    LDP0    NEXT$,,AUTO
        17 000253   000004 236100                    LDQ     4,,PR0
        17 000254   200010 756100                    STQ     NEXT$,,AUTO

     2811    16292
     2812    16293    2          END; /* WHILE */

  16293 17 000255   000001 116000 18                 CMPQ    1
        17 000256   000231 601000 17                 TNZ     s:16282

     2813    16294
     2814    16295    1          GROUP_LTS$ -> REPORT_01_LTS.USE_CHAIN$ = O1COM.REPORT_DD$;

  16295 17 000257   000067 236000 xsym               LDQ     O1COM+55
        17 000260   200006 470500                    LDP0    GROUP_LTS$,,AUTO
        17 000261   000004 756100                    STQ     4,,PR0

     2815    16296    1          O1COM.REPORT_DD$ = GROUP_LTS$;

PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:458  
  16296 17 000262   200006 236100                    LDQ     GROUP_LTS$,,AUTO
        17 000263   000067 756000 xsym               STQ     O1COM+55

     2816    16297
     2817    16298
     2818    16299    1          IF GROUP_LTS$ -> REPORT_01_LTS.RWCT$ = ADDR(NIL) THEN

  16299 17 000264   000022 236100                    LDQ     18,,PR0
        17 000265   000001 116000 18                 CMPQ    1
        17 000266   000311 601000 17                 TNZ     s:16311

     2819    16300    2            DO;

     2820    16301
     2821    16302    2              CALL Z8AT$CREATE_TEMPORARY (%SCALAR,

  16302 17 000267   200006 236100                    LDQ     GROUP_LTS$,,AUTO
        17 000270   000022 036003                    ADLQ    18,DU
        17 000271   000016 235000 18                 LDA     14
        17 000272   200012 757100                    STAQ    NEXT$+2,,AUTO
        17 000273   200012 630500                    EPPR0   NEXT$+2,,AUTO
        17 000274   000000 631400 18                 EPPR1   0
        17 000275   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        17 000276   000000 011000                    NOP     0

     2822    16303    2                        GROUP_LTS$ -> REPORT_01_LTS.RWCT$);
     2823    16304
     2824    16305    2              GROUP_LTS$ -> REPORT_01_LTS.RWCT$ -> SCALAR.TYPE = %TYA;

  16305 17 000277   200006 470500                    LDP0    GROUP_LTS$,,AUTO
        17 000300   000022 471500                    LDP1    18,,PR0
        17 000301   000010 220003                    LDX0    8,DU
        17 000302   100002 740100                    STX0    2,,PR1

     2825    16306    2              GROUP_LTS$ -> REPORT_01_LTS.RWCT$ -> SCALAR.ADSC.N = 32;

  16306 17 000303   000022 471500                    LDP1    18,,PR0
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:459  
        17 000304   000040 236007                    LDQ     32,DL
        17 000305   100001 752103                    STCQ    1,'03'O,PR1

     2826    16307    2              GROUP_LTS$ -> REPORT_01_LTS.RWCT$ -> SCALAR.ADSC.TA = %ADSC9;

  16307 17 000306   000022 471500                    LDP1    18,,PR0
        17 000307   000017 236000 18                 LDQ     15
        17 000310   100001 356100                    ANSQ    1,,PR1

     2827    16308
     2828    16309    2            END;

     2829    16310
     2830    16311    1          USE_SECT$ -> SECTION.B.REFERENCED = TRUE;

  16311 17 000311   200005 471500                    LDP1    @USE_SECT$,,AUTO
        17 000312   100000 473500                    LDP3    0,,PR1
        17 000313   400000 236003                    LDQ     -131072,DU
        17 000314   300003 256100                    ORSQ    3,,PR3

     2831    16312
     2832    16313               %NEW_ILL(@ID  = %P_A_PRESET,
     2833    16314                        @OFFSET = %USE_PROC_PTR_OFF,
     2834    16315                        @TO     = GROUP_LTS$ -> REPORT_01_LTS.RWCT$,
     2835    16316                        @LOP    = USE_SECT$,
     2836    16317                        @ROPCON = 0);

  16574 17 000315   000023 236000 18                 LDQ     19
        17 000316   200012 756100                    STQ     NEXT$+2,,AUTO
        17 000317   200012 633500                    EPPR3   NEXT$+2,,AUTO
        17 000320   200017 453500                    STP3    NEXT$+7,,AUTO
        17 000321   000024 236000 18                 LDQ     20
        17 000322   200016 756100                    STQ     NEXT$+6,,AUTO
        17 000323   000026 237000 18                 LDAQ    22
        17 000324   200014 757100                    STAQ    NEXT$+4,,AUTO
        17 000325   200014 630500                    EPPR0   NEXT$+4,,AUTO
        17 000326   000020 631400 18                 EPPR1   16
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:460  
        17 000327   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        17 000330   000000 011000                    NOP     0

  16578 17 000331   000000 220003                    LDX0    0,DU
        17 000332   000000 470400 11                 LDP0    ILL$
        17 000333   000000 440100                    SXL0    0,,PR0

  16580 17 000334   000000 470400 11                 LDP0    ILL$
        17 000335   000002 450100                    STZ     2,,PR0

  16581 17 000336   200005 471500                    LDP1    @USE_SECT$,,AUTO
        17 000337   100000 236100                    LDQ     0,,PR1
        17 000340   000001 756100                    STQ     1,,PR0

  16582 17 000341   200006 473500                    LDP3    GROUP_LTS$,,AUTO
        17 000342   300022 236100                    LDQ     18,,PR3
        17 000343   000003 756100                    STQ     3,,PR0

     2837    16696
     2838    16697    1          O1COM.USE_REPORT$ = GROUP_LTS$;

  16697 17 000344   200006 236100                    LDQ     GROUP_LTS$,,AUTO
        17 000345   000106 756000 xsym               STQ     O1COM+70

     2839    16698
     2840    16699
     2841    16700    1    RETURN;

  16700 17 000346   000000 702200 xent               TSX2  ! X66_ARET
     2842    16701    1    END Z8ET$USE_BEFORE_REPORTING;
     2843    16702         %EOD;

PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:461  
--  Include file information  --

   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$USE_BEFORE_REPORTING.
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:462  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:463  
  ****  Section 005 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 006 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 007 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 008 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 009 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 010 LblCom ETT_

PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:464  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 011 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 012 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 013 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 014 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 015 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:465  

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 016 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GLOBAL$                   4-0-0/w PTR         r     1 @OPERAND$
     5-0-0/w PTR         r     1 @USE_SECT$                *0-0-0/w PTR         r     1 GLOBAL$
     6-0-0/w PTR         r     1 GROUP_LTS$                10-0-0/w PTR         r     1 NEXT$
    *0-0-0/w PTR         r     1 OPERAND$                   7-0-0/w PTR         r     1 ST$$
    *0-0-0/w PTR         r     1 USE_SECT$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:466  

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w STRC(144)         1 DOEND
     0-0-0/w STRC(396)         1 DO_N                       0-0-0/w STRC(180)         1 DV4I
     0-0-0/w STRC(180)         1 ENTRY_ILL                  0-0-0/w STRC(180)         1 ETT
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(1692)        1 FILE_LTS
     0-0-0/w STRC(144)         1 GO                         0-0-0/w STRC(180)         1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(180)         1 ILS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:467  
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)   r     1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(144)         1 OPN                        0-0-0/w STRC(180)         1 OS_CALL
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(216)         1 PFORM                      0-0-0/w STRC(144)         1 PINC
     0-0-0/w STRC(144)         1 PREOFF                     0-0-0/w STRC(108)         1 PRESET
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)         1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(900)         1 PROC_SUPP
     0-0-0/w STRC(144)   r     1 P_A_PRESET                 0-0-0/w STRC(144)         1 P_P_PRESET
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)   r     1 REPORT_01_LTS
     0-0-0/w STRC(432)         1 REPORT_ELEM_LTS            0-0-0/w STRC(252)         1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)        1 REPORT_LTS                 0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(144)         1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)   r     1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(396)         1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(216)         1 USER_CALL                  0-0-0/w STRC(252)         1 USE_SUPP
PL6.E3A0      #005=Z8ET$USE_BEFORE_REPORTING File=Z8ET.:Z8A6TSI                  SAT 08/09/97 12:54 Page:468  
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)         1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8ET$USE_BEFORE_REPORTING requires 231 words for executable code.
   Procedure Z8ET$USE_BEFORE_REPORTING requires 16 words of local(AUTO) storage.

PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:469  
     2844        1        /*T***********************************************************/
     2845        2        /*T*                                                         */
     2846        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2847        4        /*T*                                                         */
     2848        5        /*T***********************************************************/
     2849        6
     2850        7        /*M*  Z8ET$SUPPRESS---Process the SUPPRESS statement*/
     2851        8
     2852        9
     2853       10        /*P*
     2854       11               NAME:  Z8ET$SUPPRESS
     2855       12             AUTHOR:  Min Lee.
     2856       13            PURPOSE:  Verify and process SUPPRESS statement
     2857       14
     2858       15        */
     2859       16
     2860       17        /*D*
     2861       18               NAME:  Z8ET$SUPPRESS
     2862       19               CALL:  CALL Z8ET$SUPPRESS(KEYWORD$)
     2863       20              INPUT:  KEYWORD$  --- LX_STK item of the keyword SUPPRESS
     2864       21
     2865       22
     2866       23
     2867       24        DESCRIPTION:  Verify the SUPPRESS statement and create run time
     2868       25                      instructions to flag the suppress printing bit on,
     2869       26                      that bit is on the report group run time table.
     2870       27         */
     2871       28         %EJECT;
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:470  
     2872       29
     2873       30         /*=============*/
     2874       31           Z8ET$SUPPRESS: PROC (KEYWORD$);
     2875       32         /*=============*/
     2876       33
     2877       34        %EQU PHASE = 1;
     2878       35
     2879       36        %INCLUDE Z8A_DEFC;
     2880      104        %INCLUDE Z8A_SUPP_MAC ;
     2881     2504        %INCLUDE Z8E_STACKS ;
     2882     4770        %INCLUDE Z8E_O1COM;
     2883     5531        %INCLUDE Z8A_COMCOM;
     2884     6181        %INCLUDE Z8A_ERR_NUMS;
     2885     6945        %INCLUDE Z8A_ST ;
     2886    10604        %INCLUDE Z8A_TYPES;
     2887    10778        %INCLUDE Z8A_ETT ;
     2888    11079        %INCLUDE Z8A_LTS ;
     2889    13156        %INCLUDE Z8A_MKCN;
     2890    13173
     2891    13174
     2892    13175    1   DCL KEYWORD$       PTR;
     2893    13176    1   DCL GROUP_LTS$     PTR;
     2894    13177    1   DCL RWCT$          PTR;
     2895    13178    1   DCL CONST_ETT$     PTR;
     2896    13179    1   DCL BASE_ETT$      PTR;
     2897    13180    1   DCL Z8AE$ERROR     ENTRY (12);
     2898    13181    1   DCL Z8AC$MAKE_CONST ENTRY (1);
     2899    13182    1   DCL Z8AF$NEW_BASE ENTRY (3);
     2900    13183    1   DCL Z8AF$NEW_OFF  ENTRY (3);
     2901    13184    1   DCL Z8E7$MOVE     ENTRY (2);
     2902    13185
     2903    13186
     2904    13187        %DCL_AUTO_LX_ITEM (@NAME = SEND_FIELD);
     2905    13191        %DCL_AUTO_LX_ITEM (@NAME = RECV_FIELD);
     2906    13195
     2907    13196
     2908    13197
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:471  
     2909    13198    1          IF O1COM.USE_REPORT$ = ADDR(NIL) OR
     2910    13199    1             O1COM.USE_REPORT$ -> REPORT_01_LTS.RWCT$ = ADDR(NIL) THEN
     2911    13200    2            DO;
     2912    13201
     2913    13202    2              CALL Z8AE$ERROR (%E$SUPPRESS_ERROR,
     2914    13203    2                               KEYWORD$ -> LX_ITEM.LINE,
     2915    13204    2                               KEYWORD$ -> LX_ITEM.COLUMN);
     2916    13205
     2917    13206    2              RETURN;
     2918    13207    2            END;
     2919    13208
     2920    13209    1          RWCT$ = O1COM.USE_REPORT$ -> REPORT_01_LTS.RWCT$;
     2921    13210
     2922    13211    1          MKCN.CON = -1;
     2923    13212
     2924    13213    1          CALL Z8AC$MAKE_CONST (CONST_ETT$);
     2925    13214
     2926    13215               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(SEND_FIELD)",
     2927    13216                                  @TYPE    = %TYI,
     2928    13217                                  @ETT$    = CONST_ETT$);
     2929    13239
     2930    13240    1          CALL Z8AF$NEW_BASE (RWCT$,
     2931    13241    1                              ADDR(NIL),
     2932    13242    1                              BASE_ETT$);
     2933    13243
     2934    13244    1          CALL Z8AF$NEW_OFF (BASE_ETT$,
     2935    13245    1                             4, /* 1 word, in units of bytes */
     2936    13246    1                             BASE_ETT$);
     2937    13247
     2938    13248               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     2939    13249                                  @TYPE    = %TYI,
     2940    13250                                  @ETT$    = BASE_ETT$);
     2941    13272
     2942    13273    1          CALL Z8E7$MOVE (ADDR(RECV_FIELD),
     2943    13274    1                          ADDR(SEND_FIELD));
     2944    13275
     2945    13276
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:472  
     2946    13277
     2947    13278    1    RETURN;
     2948    13279    1    END Z8ET$SUPPRESS;

PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:473  
--  Include file information  --

   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$SUPPRESS.

   Procedure Z8ET$SUPPRESS requires 97 words for executable code.
   Procedure Z8ET$SUPPRESS requires 28 words of local(AUTO) storage.

    No errors detected in file Z8ET.:Z8A6TSI    .

PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:474  

 Object Unit name= Z8ET$SUPPRESS                              File name= Z8ET.:Z8A6TOU
 UTS= AUG 09 '97 12:56:24.88 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  ST$
    6  LblCom even  none     5      5  ST_
    7  LblCom even  none     1      1  ETT$
    8  LblCom even  none     1      1  HEAD_ETT$
    9  LblCom even  none   512   1000  ETT_BUCKETS
   10  LblCom even  none     5      5  ETT_
   11  LblCom even  none     1      1  LTS$
   12  LblCom even  none     5      5  LTS_
   13  LblCom even  none     2      2  MKCN
   14   Proc  even  none    97    141  Z8ET$SUPPRESS
   15  RoData even  none     8     10  Z8ET$SUPPRESS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    14      0   yes            yes      Std        1  Z8ET$SUPPRESS
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:475  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       3 Z8AF$NEW_OFF
         yes           Std       1 Z8AC$MAKE_CONST
         yes           Std       3 Z8AF$NEW_BASE
         yes           Std       2 Z8E7$MOVE
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     O1COM                                 HIER_STK_PTR                          HIER_STK
     PAGE_FORMAT                           REP_STK_PTR                           REP_STK
     COMCOM                           r    LTS_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:476  


     2844        1        /*T***********************************************************/
     2845        2        /*T*                                                         */
     2846        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2847        4        /*T*                                                         */
     2848        5        /*T***********************************************************/
     2849        6
     2850        7        /*M*  Z8ET$SUPPRESS---Process the SUPPRESS statement*/
     2851        8
     2852        9
     2853       10        /*P*
     2854       11               NAME:  Z8ET$SUPPRESS
     2855       12             AUTHOR:  Min Lee.
     2856       13            PURPOSE:  Verify and process SUPPRESS statement
     2857       14
     2858       15        */
     2859       16
     2860       17        /*D*
     2861       18               NAME:  Z8ET$SUPPRESS
     2862       19               CALL:  CALL Z8ET$SUPPRESS(KEYWORD$)
     2863       20              INPUT:  KEYWORD$  --- LX_STK item of the keyword SUPPRESS
     2864       21
     2865       22
     2866       23
     2867       24        DESCRIPTION:  Verify the SUPPRESS statement and create run time
     2868       25                      instructions to flag the suppress printing bit on,
     2869       26                      that bit is on the report group run time table.
     2870       27         */
     2871       28         %EJECT;
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:477  
     2872       29
     2873       30         /*=============*/
     2874       31           Z8ET$SUPPRESS: PROC (KEYWORD$);

     31 14 000000   000000 700200 xent  Z8ET$SUPPRE* TSX0  ! X66_AUTO_1
        14 000001   000034 000001                    ZERO    28,1

     2875       32         /*=============*/
     2876       33
     2877       34        %EQU PHASE = 1;
     2878       35
     2879       36        %INCLUDE Z8A_DEFC;
     2880      104        %INCLUDE Z8A_SUPP_MAC ;
     2881     2504        %INCLUDE Z8E_STACKS ;
     2882     4770        %INCLUDE Z8E_O1COM;
     2883     5531        %INCLUDE Z8A_COMCOM;
     2884     6181        %INCLUDE Z8A_ERR_NUMS;
     2885     6945        %INCLUDE Z8A_ST ;
     2886    10604        %INCLUDE Z8A_TYPES;
     2887    10778        %INCLUDE Z8A_ETT ;
     2888    11079        %INCLUDE Z8A_LTS ;
     2889    13156        %INCLUDE Z8A_MKCN;
     2890    13173
     2891    13174
     2892    13175    1   DCL KEYWORD$       PTR;
     2893    13176    1   DCL GROUP_LTS$     PTR;
     2894    13177    1   DCL RWCT$          PTR;
     2895    13178    1   DCL CONST_ETT$     PTR;
     2896    13179    1   DCL BASE_ETT$      PTR;
     2897    13180    1   DCL Z8AE$ERROR     ENTRY (12);
     2898    13181    1   DCL Z8AC$MAKE_CONST ENTRY (1);
     2899    13182    1   DCL Z8AF$NEW_BASE ENTRY (3);
     2900    13183    1   DCL Z8AF$NEW_OFF  ENTRY (3);
     2901    13184    1   DCL Z8E7$MOVE     ENTRY (2);
     2902    13185
     2903    13186
     2904    13187        %DCL_AUTO_LX_ITEM (@NAME = SEND_FIELD);
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:478  
     2905    13191        %DCL_AUTO_LX_ITEM (@NAME = RECV_FIELD);
     2906    13195
     2907    13196
     2908    13197
     2909    13198    1          IF O1COM.USE_REPORT$ = ADDR(NIL) OR

  13198 14 000002   000106 236000 xsym               LDQ     O1COM+70
        14 000003   000000 116000 15                 CMPQ    0
        14 000004   000011 600000 14                 TZE     s:13202
        14 000005   000106 470400 xsym               LDP0    O1COM+70
        14 000006   000022 236100                    LDQ     18,,PR0
        14 000007   000000 116000 15                 CMPQ    0
        14 000010   000026 601000 14                 TNZ     s:13209

     2910    13199    1             O1COM.USE_REPORT$ -> REPORT_01_LTS.RWCT$ = ADDR(NIL) THEN
     2911    13200    2            DO;

     2912    13201
     2913    13202    2              CALL Z8AE$ERROR (%E$SUPPRESS_ERROR,

  13202 14 000011   200003 470500                    LDP0    @KEYWORD$,,AUTO
        14 000012   000000 471500                    LDP1    0,,PR0
        14 000013   100006 633500                    EPPR3   6,,PR1
        14 000014   200032 453500                    STP3    RECV_FIELD+10,,AUTO
        14 000015   100005 634500                    EPPR4   5,,PR1
        14 000016   200031 454500                    STP4    RECV_FIELD+9,,AUTO
        14 000017   000003 236000 15                 LDQ     3
        14 000020   200030 756100                    STQ     RECV_FIELD+8,,AUTO
        14 000021   200030 630500                    EPPR0   RECV_FIELD+8,,AUTO
        14 000022   000001 631400 15                 EPPR1   1
        14 000023   000000 701000 xent               TSX1    Z8AE$ERROR
        14 000024   000000 011000                    NOP     0

     2914    13203    2                               KEYWORD$ -> LX_ITEM.LINE,
     2915    13204    2                               KEYWORD$ -> LX_ITEM.COLUMN);
     2916    13205
     2917    13206    2              RETURN;
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:479  

  13206 14 000025   000000 702200 xent               TSX2  ! X66_ARET

     2918    13207    2            END;
     2919    13208
     2920    13209    1          RWCT$ = O1COM.USE_REPORT$ -> REPORT_01_LTS.RWCT$;

  13209 14 000026   200005 756100                    STQ     RWCT$,,AUTO

     2921    13210
     2922    13211    1          MKCN.CON = -1;

  13211 14 000027   000001 335007                    LCA     1,DL
        14 000030   000000 755000 13                 STA     MKCN

     2923    13212
     2924    13213    1          CALL Z8AC$MAKE_CONST (CONST_ETT$);

  13213 14 000031   200006 631500                    EPPR1   CONST_ETT$,,AUTO
        14 000032   200030 451500                    STP1    RECV_FIELD+8,,AUTO
        14 000033   200030 630500                    EPPR0   RECV_FIELD+8,,AUTO
        14 000034   000004 631400 15                 EPPR1   4
        14 000035   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        14 000036   000000 011000                    NOP     0

     2925    13214
     2926    13215               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(SEND_FIELD)",
     2927    13216                                  @TYPE    = %TYI,
     2928    13217                                  @ETT$    = CONST_ETT$);

  13219 14 000037   000004 220003                    LDX0    4,DU
        14 000040   200010 740100                    STX0    SEND_FIELD,,AUTO

  13220 14 000041   000000 221003                    LDX1    0,DU
        14 000042   200010 441100                    SXL1    SEND_FIELD,,AUTO

  13221 14 000043   000001 235007                    LDA     1,DL
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:480  
        14 000044   200014 755100                    STA     SEND_FIELD+4,,AUTO

  13222 14 000045   000000 236000 15                 LDQ     0
        14 000046   200017 756100                    STQ     SEND_FIELD+7,,AUTO

  13223 14 000047   200006 236100                    LDQ     CONST_ETT$,,AUTO
        14 000050   200011 756100                    STQ     SEND_FIELD+1,,AUTO

  13224 14 000051   000000 236000 15                 LDQ     0
        14 000052   200012 756100                    STQ     SEND_FIELD+2,,AUTO

  13226 14 000053   000133 235000 xsym               LDA     COMCOM+91
        14 000054   200015 755100                    STA     SEND_FIELD+5,,AUTO

  13227 14 000055   000134 235000 xsym               LDA     COMCOM+92
        14 000056   200016 755100                    STA     SEND_FIELD+6,,AUTO

     2929    13239
     2930    13240    1          CALL Z8AF$NEW_BASE (RWCT$,

  13240 14 000057   200030 756100                    STQ     RECV_FIELD+8,,AUTO
        14 000060   200007 630500                    EPPR0   BASE_ETT$,,AUTO
        14 000061   200033 450500                    STP0    RECV_FIELD+11,,AUTO
        14 000062   200030 631500                    EPPR1   RECV_FIELD+8,,AUTO
        14 000063   200032 451500                    STP1    RECV_FIELD+10,,AUTO
        14 000064   200005 633500                    EPPR3   RWCT$,,AUTO
        14 000065   200031 453500                    STP3    RECV_FIELD+9,,AUTO
        14 000066   200031 630500                    EPPR0   RECV_FIELD+9,,AUTO
        14 000067   000001 631400 15                 EPPR1   1
        14 000070   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        14 000071   000000 011000                    NOP     0

     2931    13241    1                              ADDR(NIL),
     2932    13242    1                              BASE_ETT$);
     2933    13243
     2934    13244    1          CALL Z8AF$NEW_OFF (BASE_ETT$,

PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:481  
  13244 14 000072   200007 630500                    EPPR0   BASE_ETT$,,AUTO
        14 000073   200032 450500                    STP0    RECV_FIELD+10,,AUTO
        14 000074   000006 236000 15                 LDQ     6
        14 000075   200031 756100                    STQ     RECV_FIELD+9,,AUTO
        14 000076   200007 631500                    EPPR1   BASE_ETT$,,AUTO
        14 000077   200030 451500                    STP1    RECV_FIELD+8,,AUTO
        14 000100   200030 630500                    EPPR0   RECV_FIELD+8,,AUTO
        14 000101   000001 631400 15                 EPPR1   1
        14 000102   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        14 000103   000000 011000                    NOP     0

     2935    13245    1                             4, /* 1 word, in units of bytes */
     2936    13246    1                             BASE_ETT$);
     2937    13247
     2938    13248               %INIT_LX_ETT_ITEM (@POINTER = "ADDR(RECV_FIELD)",
     2939    13249                                  @TYPE    = %TYI,
     2940    13250                                  @ETT$    = BASE_ETT$);

  13252 14 000104   000004 220003                    LDX0    4,DU
        14 000105   200020 740100                    STX0    RECV_FIELD,,AUTO

  13253 14 000106   000000 221003                    LDX1    0,DU
        14 000107   200020 441100                    SXL1    RECV_FIELD,,AUTO

  13254 14 000110   000001 235007                    LDA     1,DL
        14 000111   200024 755100                    STA     RECV_FIELD+4,,AUTO

  13255 14 000112   000000 236000 15                 LDQ     0
        14 000113   200027 756100                    STQ     RECV_FIELD+7,,AUTO

  13256 14 000114   200007 236100                    LDQ     BASE_ETT$,,AUTO
        14 000115   200021 756100                    STQ     RECV_FIELD+1,,AUTO

  13257 14 000116   000000 236000 15                 LDQ     0
        14 000117   200022 756100                    STQ     RECV_FIELD+2,,AUTO

  13259 14 000120   000133 235000 xsym               LDA     COMCOM+91
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:482  
        14 000121   200025 755100                    STA     RECV_FIELD+5,,AUTO

  13260 14 000122   000134 235000 xsym               LDA     COMCOM+92
        14 000123   200026 755100                    STA     RECV_FIELD+6,,AUTO

     2941    13272
     2942    13273    1          CALL Z8E7$MOVE (ADDR(RECV_FIELD),

  13273 14 000124   200020 630500                    EPPR0   RECV_FIELD,,AUTO
        14 000125   200030 450500                    STP0    RECV_FIELD+8,,AUTO
        14 000126   200010 631500                    EPPR1   SEND_FIELD,,AUTO
        14 000127   200031 451500                    STP1    RECV_FIELD+9,,AUTO
        14 000130   200031 633500                    EPPR3   RECV_FIELD+9,,AUTO
        14 000131   200033 453500                    STP3    RECV_FIELD+11,,AUTO
        14 000132   200030 634500                    EPPR4   RECV_FIELD+8,,AUTO
        14 000133   200032 454500                    STP4    RECV_FIELD+10,,AUTO
        14 000134   200032 630500                    EPPR0   RECV_FIELD+10,,AUTO
        14 000135   000007 631400 15                 EPPR1   7
        14 000136   000000 701000 xent               TSX1    Z8E7$MOVE
        14 000137   000000 011000                    NOP     0

     2943    13274    1                          ADDR(SEND_FIELD));
     2944    13275
     2945    13276
     2946    13277
     2947    13278    1    RETURN;

  13278 14 000140   000000 702200 xent               TSX2  ! X66_ARET
     2948    13279    1    END Z8ET$SUPPRESS;

PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:483  
--  Include file information  --

   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8ET$SUPPRESS.
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:484  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:485  
  ****  Section 005 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 006 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 007 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 008 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 009 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 010 LblCom ETT_

PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:486  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 011 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 012 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 013 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @KEYWORD$                  7-0-0/w PTR         r     1 BASE_ETT$
     6-0-0/w PTR         r     1 CONST_ETT$                 4-0-0/w PTR               1 GROUP_LTS$
    *0-0-0/w PTR         r     1 KEYWORD$                  20-0-0/d STRC(288)   r     1 RECV_FIELD
     5-0-0/w PTR         r     1 RWCT$                     10-0-0/d STRC(288)   r     1 SEND_FIELD

  ****  SYMREF variables  ****
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:487  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)        1 DIMS                       0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w STRC(180)         1 ETT                        0-0-0/w STRC(73836)       1 EVALUATE
PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:488  
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(1692)        1 FILE_LTS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(72)          1 LONG                       0-0-0/w STRC              1 LTS
     0-0-0/w STRC(360)         1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)   r     1 LX_ETT_ITEM
     0-0-0/w STRC(288)   r     1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)         1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(900)         1 PROC_SUPP
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)   r     1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)         1 SCALAR                     0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)         1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(288)         1 WRITE_STMT

PL6.E3A0      #006=Z8ET$SUPPRESS File=Z8ET.:Z8A6TSI                              SAT 08/09/97 12:56 Page:489  

   Procedure Z8ET$SUPPRESS requires 97 words for executable code.
   Procedure Z8ET$SUPPRESS requires 28 words of local(AUTO) storage.

    No errors detected in file Z8ET.:Z8A6TSI    .
