VERSION E05

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:1    
        1        1        /*M*  DDA$MOD  -  DO routine for MODIFY and MACTIVE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F*  NAME: DDA$MOD
       10       10              PURPOSE: Performs the MODIFY  command
       11       11                                                     */
       12       12        DDA$MOD: PROC ALTRET;
       13       13
       14       14          /* Locals */
       15       15
       16       16    1   DCL ADDRESS SBIN;
       17       17    1   DCL 1 L6_ADDRESS REDEF ADDRESS,
       18       18    1         2 * BIT(16) UNAL,
       19       19    1         2 L4 UBIN(4) UNAL,
       20       20    1         2 R16 UBIN(16) UNAL;
       21       21    1   DCL SEG UBIN;
       22       22    1   DCL DESC# UBIN;
       23       23    1   DCL NOT_IS BIT(1) ALIGNED;
       24       24    1   DCL SIZE UBIN;
       25       25    1   DCL EXPR_OP BIT(1) ALIGNED;
       26       26    1   DCL L6_TEMP1 UBIN;
       27       27    1   DCL 1 L6_TEMP1_WORD REDEF L6_TEMP1,
       28       28    1         2 * UBIN(20) UNAL,
       29       29    1         2 L6WORD UBIN(16) UNAL;
       30       30    1   DCL L6_TEMP2 UBIN;
       31       31    1   DCL 1 L6_TEMP2_WORD REDEF L6_TEMP2,
       32       32    1         2 * UBIN(20) UNAL,
       33       33    1         2 L6WORD UBIN(16) UNAL;
       34       34    1   DCL L6_TEMP_VALUE UBIN;
       35       35    1   DCL 1 L6_TEMP_VALUE_WORD REDEF L6_TEMP_VALUE,
       36       36    1         2 * BIT(4) UNAL,
       37       37    1         2 UH UBIN(16) UNAL,
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:2    
       38       38    1         2 LH UBIN(16) UNAL;
       39       39    1   DCL NODE UBIN;
       40       40    1   DCL MACTIVE BIT(1);
       41       41    1   DCL OLD_NOT_OLD BIT(1);
       42       42    1   DCL I UBIN;
       43       43    1   DCL OFFSET UBIN;
       44       44    1   DCL TADDRESS SBIN;
       45       45    1   DCL VALUE UBIN;
       46       46    1   DCL 1 OVALUE,
       47       47    1         2 SIZE UBIN WORD,
       48       48    1         2 OPS(0:15) UBIN WORD;
       49       49    1   DCL 1 NVALUE,
       50       50    1         2 SIZE UBIN WORD,
       51       51    1         2 OPS(0:15) UBIN WORD;
       52       52    1   DCL 1 EVALUE,
       53       53    1         2 SIZE UBIN WORD,
       54       54    1         2 OPS(0:15) UBIN WORD;
       55       55    1   DCL PLUS BIT(1);
       56       56    1   DCL IS_AUTO BIT(1) ALIGNED;
       57       57    1   DCL FMT UBIN;
       58       58    1   DCL START$ PTR;
       59       59    1   DCL MYBUF CHAR(200) ALIGNED;
       60       60    1   DCL 1 MYBUF_R REDEF MYBUF,
       61       61    1         2 UBIN9 UBIN(9) CALIGNED,
       62       62    1         2 TEXT CHAR(199) CALIGNED;
       63       63    1   DCL CASECODE SBIN;
       64       64    1   DCL TEXT$ PTR;
       65       65    1   DCL NCHARS UBIN;
       66       66    1   DCL TEXTR CHAR(NCHARS) BASED;
       67       67    1   DCL DO$ PTR;
       68       68    1   DCL SUPADR BIT(1);
       69       69    1   DCL NMSLASH BIT(1);
       70       70    1   DCL SETNA$ BIT(1);
       71       71    1   DCL TSIZE UBIN;
       72       72    1   DCL TEMP SBIN;
       73       73    1   DCL CHAR1 CHAR(1) BASED;
       74       74    1   DCL CHAR2 CHAR(2) BASED;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:3    
       75       75    1   DCL LVALUE UBIN;
       76       76    1   DCL 1 LINSTR REDEF LVALUE,
       77       77    1         2 PADD,
       78       78    1           3 PNTR UBIN(3) UNAL,
       79       79    1           3 OFFSET SBIN(15) UNAL,
       80       80    1         2 ADDRESS REDEF PADD UBIN(18) UNAL,
       81       81    1         2 * UBIN(11) UNAL,
       82       82    1         2 BIT29 BIT(1) UNAL,
       83       83    1         2 TAG UBIN(6) UNAL;
       84       84    1   DCL 1 LAR REDEF LVALUE,
       85       85    1         2 OFFSET UBIN(18) UNAL,
       86       86    1         2 PLUS UBIN(6) UNAL,
       87       87    1         2 SEG UBIN(2) UNAL,
       88       88    1         2 DESC# UBIN(10) UNAL;
       89       89    1   DCL 1 LRELVAL REDEF LVALUE,
       90       90    1         2 LH UBIN(18) UNAL,
       91       91    1         2 RH UBIN(18) UNAL;
       92       92    1   DCL SAVE_DOMAIN BIT(1) ALIGNED;
       93       93    1   DCL SAVE_EXEC_DOMAIN UBIN;
       94       94    1   DCL BIT36 BIT(36) ALIGNED BASED;
       95       95    1   DCL 1 PR,
       96       96    1         2 AR,
       97       97    1           3 W UBIN(18) UNAL,
       98       98    1           3 * BIT(6) UNAL,
       99       99    1         2 SD,
      100      100    1           3 S UBIN(2) UNAL,
      101      101    1           3 D UBIN(10) UNAL;
      102      102
      103      103          /* Misc */
      104      104
      105      105        %INCLUDE DD$DITEM;
       12+     208             %LIST;
       13+     209    1        DCL SDD$ PTR;
       14+     210    1        DCL ZITEM$ PTR;
       15+     211    1        DCL SDD_L6$ PTR;
       16+     212    1        DCL ZITEM_L6$ PTR;
      106      786        %ZITEM;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:4    
      107      858        %INCLUDE DD$BASED;
      108     2161        %MODIFY$CMD(NAME=MOD$CMD,STCLASS="BASED(DO$)");
      109     2177        %MACTIVE$CMD(NAME=MACT$CMD,STCLASS="BASED(DO$)");
      110     2196        %INCLUDE DD_ERR_C;
      111     2593        %INCLUDE DD_SUBS_C;
      112     2864             %INCLUDE XUH_MACRO_C;
      113     2948             %INCLUDE DD_SD_M;
      114     4284             %S_D;
      115     5602             %S_D_PTRS;
      116     5639        %INCLUDE DD_PSUBS_C;
      117     6114        %INCLUDE OC_SUBS_C;
      118     6845        %INCLUDE B$OBJECT_C;
      119    10275        %B$RECORDSUBS;
      120    10303        %INCLUDE GM_VIRTUAL_E;
      121    10513        %INCLUDE GD$MSG_M;
      122    10677        %GD$MSG(FPTN=GD$MSG,STCLASS="BASED(S_D_L6_MESSAGE$)",L6=YES,L6PTR="UBIN(32) UNAL");
      123    10833
      124    10834          /* External routines */
      125    10835
      126    10836    1   DCL DDK$EVAL ENTRY(6) ALTRET;
      127    10837    1   DCL DFK$EVAL ENTRY(8) ALTRET;
      128    10838    1   DCL DFK$GETMVAL ENTRY(6) ALTRET;
      129    10839    1   DCL DFK$PUTMVAL ENTRY(6) ALTRET;
      130    10840    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      131    10841    1   DCL DDK$PUTMVAL ENTRY(5) ALTRET;
      132    10842    1   DCL DUU$GETMVAL ENTRY(6) ALTRET;
      133    10843    1   DCL DUU$PUTMVAL ENTRY(6) ALTRET;
      134    10844    1   DCL DUL$GETMVAL ENTRY(5) ALTRET;
      135    10845    1   DCL DDQ$WRITELM ENTRY(5) ALTRET;
      136    10846    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      137    10847    1   DCL DUQ$OCMSG ENTRY(1);
      138    10848    1   DCL DUQ$WRERRLOG ENTRY(1);
      139    10849    1   DCL DDK$INCR@ ENTRY(2) ALTRET;
      140    10850    1   DCL DDK$INCR# ENTRY(2) ALTRET;
      141    10851    1   DCL DDE$ERROR ENTRY;
      142    10852    1   DCL DDA$DISPADR ENTRY(7) ALTRET;
      143    10853    1   DCL DDA$DISPFMT ENTRY(6) ALTRET;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:5    
      144    10854    1   DCL DDR$BUMPC_D$ ENTRY(1) ALTRET;
      145    10855    1   DCL DDQ$WRITE ENTRY(2);
      146    10856    1   DCL DDQ$WRITENU ENTRY(2);
      147    10857    1   DCL DDR$INSTR ENTRY(1) ALTRET;
      148    10858    1   DCL DDS$SET_Q2D ENTRY ALTRET;
      149    10859    1   DCL DXQ$WRTPI ENTRY(2);
      150    10860    1   DCL DFS$INSTR ENTRY(4) ALTRET;
      151    10861    1   DCL DFR$INSTR ENTRY(4) ALTRET;
      152    10862    1        S_D.L$.VALUE = OVALUE.OPS;
      153    10863                                                /**/
      154    10864    1        S_D.GOT$L = '0'B;
      155    10865    1        S_D.EIS = '0'B;
      156    10866    1        SUPADR = '0'B;
      157    10867    1        NMSLASH = '0'B;
      158    10868    1        SAVE_DOMAIN = '0'B;
      159    10869    1        SETNA$ = '0'B;
      160    10870    1        DO$ = S_D.DO$;
      161    10871    1        S_D.DESC$ = S_D.D$;
      162    10872    1        ZITEM$ = S_D.D$;
      163    10873    1        FMT = ZITEM.FMT_SPEC;
      164    10874    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND ZITEM.ADDR_TYPE = %AUTO_ACODE
      165    10875    1        THEN IS_AUTO = '1'B;
      166    10876    1        ELSE IS_AUTO = '0'B;
      167    10877    1        IF FMT = %L$_FMT
      168    10878    1        THEN FMT = S_D.L$.FMT;
      169    10879    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST OR S_D.RUM OR
      170    10880    1          (ZITEM.ADDR_TYPE = %SPEC_ACODE AND
      171    10881    1          (ZITEM.SP.VS.ID = %O_RTN OR
      172    10882    1          ZITEM.SP.VS.ID = %I_RTN OR
      173    10883    1          ZITEM.SP.VS.ID = %L_RTN OR
      174    10884    1          ZITEM.SP.VS.ID = %@_RTN OR
      175    10885    1          ZITEM.SP.VS.ID = %@@_RTN OR
      176    10886    1          ZITEM.SP.VS.ID = %#_RTN OR
      177    10887    1          ZITEM.SP.VS.ID = %##_RTN OR
      178    10888    1          ZITEM.SP.VS.ID = %RI_RTN OR
      179    10889    1          ZITEM.SP.VS.ID = %NA_RTN OR
      180    10890    1          ZITEM.SP.VS.ID = %IC_RTN OR
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:6    
      181    10891    1          ZITEM.SP.VS.ID = %N_RTN OR
      182    10892    1          ZITEM.SP.VS.ID = %FMASK_RTN OR
      183    10893    1          ZITEM.SP.VS.ID = %FRANGE_RTN))
      184    10894    1        THEN CALL DDK$EVAL(ADDRESS, SEG, DESC#, NOT_IS) ALTRET(MERR);
      185    10895    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      186    10896    2             THEN DO;
      187    10897    2                  CALL DFK$EVAL(OVALUE, ADDRESS, SEG, DESC#, NOT_IS, SIZE, EXPR_OP,
             10897                           '1'B) ALTRET(MERR);
      188    10898    2                  GOTO GOTIT;
      189    10899    2                END;
      190    10900    1             ELSE GOTO MERR1;
      191    10901    1        IF S_D.RUM
      192    10902    2        THEN DO;
      193    10903    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND
      194    10904    2               SEG = 7 AND
      195    10905    2               DESC# = 2
      196    10906    3             THEN DO;
      197    10907    3                  SAVE_DOMAIN = '1'B;
      198    10908    3                  SAVE_EXEC_DOMAIN = S_D.ONE_TO_TWO.EXEC_DOMAIN;
      199    10909    3                  S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST;
      200    10910    3                END;
      201    10911    2             NODE = 0;
      202    10912    2             IF S_D.OVERLAID
      203    10913    2             THEN CALL DDS$IC2NODE( ADDRESS, NODE ) ALTRET( MERR );
      204    10914    2             CALL DUU$GETMVAL(OVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(MERR);
      205    10915    2           END;
      206    10916    2        ELSE DO;
      207    10917    2             OVALUE.SIZE = 1;
      208    10918    2             IF S_D.ANLZ_FILE
      209    10919    2             THEN CALL DUL$GETMVAL(OVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
             10919                      MERR);
      210    10920    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST OR
      211    10921    2                    (ZITEM.ADDR_TYPE = %SPEC_ACODE AND
      212    10922    2                    (ZITEM.SP.VS.ID = %FMASK_RTN OR
      213    10923    2                    ZITEM.SP.VS.ID = %FRANGE_RTN OR
      214    10924    2                    ZITEM.SP.VS.ID = %RI_RTN))
      215    10925    2                  THEN CALL DDK$GETMVAL(OVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS)
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:7    
             10925                           ALTRET(MERR);
      216    10926    2                  ELSE CALL DFK$GETMVAL(OVALUE, ADDRESS, SEG, DESC#, NOT_IS, '1'B)
             10926                           ALTRET(MERR);
      217    10927    2           END;
      218    10928
      219    10929    1   GOTIT: ;
      220    10930    1        S_D.L$.VALUE = OVALUE.OPS;
      221    10931    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      222    10932    1        THEN S_D.L$.SIZE = 36;
      223    10933    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      224    10934    1             THEN S_D.L$.SIZE = OVALUE.SIZE * 16;
      225    10935    1             ELSE GOTO MERR1;
      226    10936    1        S_D.O$.ADDRESS = ADDRESS;
      227    10937    1        S_D.O$.SEG = SEG;
      228    10938    1        S_D.O$.DESC# = DESC#;
      229    10939    1        S_D.O$.NOT_IS = NOT_IS;
      230    10940    1        IF MOD$CMD.DW OR S_D.L$.SIZE = 32
      231    10941    1        THEN S_D.MDW = '1'B;
      232    10942    1        ELSE S_D.MDW = '0'B;
      233    10943
      234    10944    1        IF MOD$CMD.DDESC(0)
      235    10945    2        THEN DO;            /* New value specified - non-interactive command */
      236    10946    2             MACTIVE = '0'B;
      237    10947    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      238    10948    2             THEN CALL IORVALUE(NVALUE,MOD$CMD.INSTR(0),MOD$CMD.IGNPR(0),
      239    10949    2                    MOD$CMD.AWDX(0))ALTRET(MERR);
      240    10950    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      241    10951    2                  THEN CALL L6_IORVALUE(NVALUE,MOD$CMD.INSTR(0),ADDRESS)ALTRET(MERR);
      242    10952    2                  ELSE GOTO MERR1;
      243    10953    2             IF MOD$CMD.DDESC(1)
      244    10954    3             THEN DO;                      /* Expected old value specified */
      245    10955    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      246    10956    3                  THEN CALL IORVALUE(EVALUE,MOD$CMD.INSTR(1),MOD$CMD.IGNPR(1),
      247    10957    3                         MOD$CMD.AWDX(1))ALTRET(MERR);
      248    10958    3                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      249    10959    3                       THEN CALL L6_IORVALUE(EVALUE,MOD$CMD.INSTR(1),ADDRESS)
      250    10960    3                              ALTRET(MERR);
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:8    
      251    10961    3                       ELSE GOTO MERR1;
      252    10962    3                  OLD_NOT_OLD = '0'B;
      253    10963    4                  DO I = 0 TO EVALUE.SIZE -1;
      254    10964    4                       IF EVALUE.OPS(I) ~= OVALUE.OPS(I)
      255    10965    4                       THEN OLD_NOT_OLD = '1'B;
      256    10966    4                     END;
      257    10967    3                  IF OLD_NOT_OLD
      258    10968    4                  THEN DO;                 /* Previous ~= expected -> error */
      259    10969    4                       S_D.ERROR = 82; /* E@OLDNOTOLD */
      260    10970    4                       START$ = PINCRC(ADDR(MYBUF), 1);
      261    10971    4                       S_D.D$ = START$;
      262    10972    4                       S_D.DESCL$ = PINCRC(S_D.D$, SIZEC(MYBUF) - 1);
      263    10973    4                       IF MOD$CMD.INSTR(1)
      264    10974    4                       THEN IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      265    10975    4                            THEN CALL DDR$INSTR(EVALUE.OPS(0))ALTRET(MERR);
      266    10976    4                            ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      267    10977    4                                 THEN CALL DFR$INSTR(EVALUE.OPS, EVALUE.SIZE, '1'B )
             10977                                          ALTRET(MERR);
      268    10978    4                                 ELSE GOTO MERR1;
      269    10979    4                       ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      270    10980    4                            THEN CALL DDA$DISPFMT(%OCT_FMT,36,EVALUE.OPS)ALTRET(MERR);
      271    10981    4                            ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      272    10982    5                                 THEN DO;
      273    10983    5                                      IF S_D.MDW
      274    10984    5                                      THEN CALL DDA$DISPFMT(%X_FMT,32,EVALUE.OPS)
             10984                                               ALTRET(MERR);
      275    10985    5                                      ELSE CALL DDA$DISPFMT(%X_FMT,16,EVALUE.OPS)
             10985                                               ALTRET(MERR);
      276    10986    5                                    END;
      277    10987    4                                 ELSE GOTO MERR1;
      278    10988    4                       MYBUF_R.UBIN9 = POFFC(S_D.D$, START$);
      279    10989    4                       IF MYBUF_R.UBIN9 <= 31
      280    10990    5                       THEN DO;
      281    10991    5                            S_D.ERROR_SYM$ = ADDR(MYBUF);
      282    10992    5                            CALL DDE$ERROR;
      283    10993    5                          END;
      284    10994    5                       ELSE DO;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:9    
      285    10995    5                            I = MYBUF_R.UBIN9;
      286    10996    5                            CALL DDQ$WRITE (ADDR(MYBUF_R.TEXT), I);
      287    10997    5                            S_D.ERROR_SYM$ = ADDR (NIL);
      288    10998    5                            CALL DDE$ERROR;
      289    10999    5                          END;
      290    11000    4                       NVALUE = OVALUE;
      291    11001    4                       MACTIVE = '1'B;     /* Go interactive */
      292    11002    4                       GOTO DISPMOD;
      293    11003    4                     END;                  /* DO  ( previous ~= expected ) */
      294    11004    3                  IF NVALUE.SIZE ~= EVALUE.SIZE AND
      295    11005    3                    (NOT MOD$CMD.NWARN) AND
      296    11006    3                    (NOT S_D.GOT$L)
      297    11007    4                  THEN DO;       /* Sizes of new and expected values don't match */
      298    11008    4                       S_D.ERROR = 285; /* E@WRONG_SIZE */
      299    11009    4                       S_D.ERROR_SYM$ = ADDR(NIL);
      300    11010    4                       CALL DDE$ERROR;
      301    11011    4                     END;
      302    11012    3                END;                  /* DO  ( expected old value specified ) */
      303    11013    2             IF S_D.RUM
      304    11014    3             THEN DO;
      305    11015    3                  NODE = 0;
      306    11016    3                  IF S_D.OVERLAID
      307    11017    3                  THEN CALL DDS$IC2NODE( ADDRESS, NODE ) ALTRET( MERR );
      308    11018    3                  CALL DUU$PUTMVAL(NVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
             11018                           MERR);
      309    11019    3                END;
      310    11020    2             ELSE IF S_D.ANLZ_FILE
      311    11021    3                  THEN DO;
      312    11022    3                       S_D.ERROR = 155; /*E@CANTPUTINANLZ*/
      313    11023    3                       GOTO MERR;
      314    11024    3                     END;
      315    11025    2                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      316    11026    2                       THEN CALL DDK$PUTMVAL(NVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS
             11026                                ) ALTRET(MERR);
      317    11027    2                       ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      318    11028    2                            THEN CALL DFK$PUTMVAL(NVALUE, EVALUE, ADDRESS, SEG, DESC#,
             11028                                     NOT_IS) ALTRET(MERR);
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:10   
      319    11029    2                            ELSE GOTO MERR1;
      320    11030    2             IF NOT(NOT_IS)
      321    11031    3             THEN DO;
      322    11032    3                  IF (ADDRESS >= S_D.NEXT@) AND (ADDRESS <= S_D.HIGH@) AND S_D.GOT@
      323    11033    3                  THEN CALL DDK$INCR@ (ADDRESS, NVALUE.SIZE) ALTRET(MERR);
      324    11034    4                  ELSE DO;
      325    11035    4                       IF (ADDRESS >= S_D.NEXT#) AND (ADDRESS <= S_D.HIGH#) AND S_D.
             11035                                GOT#
      326    11036    4                       THEN CALL DDK$INCR# (ADDRESS, NVALUE.SIZE) ALTRET(MERR);
      327    11037    5                       ELSE DO;
      328    11038    5                            S_D.RI$ = OVALUE;
      329    11039    5                            IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      330    11040    5                            THEN
      331    11041    5                                 S_D.NA$ = ADDRESS + 1;
      332    11042    5                            ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      333    11043    6                                 THEN DO;
      334    11044    6                                      S_D.NA$ = ADDRESS;
      335    11045    6                                      SETNA$ = '1'B;
      336    11046    6                                    END;
      337    11047    5                                 ELSE GOTO MERR1;
      338    11048    5                          END;
      339    11049    4                     END;
      340    11050    3                END;
      341    11051    2           END;                            /* DO  ( new value specified ) */
      342    11052    2        ELSE DO;                           /* Interactive MODIFY  command */
      343    11053    2             NVALUE = OVALUE;
      344    11054    2             MACTIVE = '1'B;
      345    11055    2             IF MOD$CMD.SACT               /* Check for activation '/' */
      346    11056    2             THEN SUPADR = '1'B;
      347    11057    2           END;                            /* DO  ( interactive modify command ) */
      348    11058    1        GOTO DISPMOD;
      349    11059                                                /**/
      350    11060        /*F*  NAME: DDA$MACTIVE
      351    11061              PURPOSE: To perform action as indicated by interactive
      352    11062                  MODIFY  command response.
      353    11063                                                     */
      354    11064    1   DDA$MACTIVE: ENTRY ALTRET;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:11   
      355    11065                                                /**/
      356    11066    1        SUPADR = '0'B;
      357    11067    1        S_D.MACTIVE = '0'B;
      358    11068    1        SETNA$ = '0'B;
      359    11069    1        DO$ = S_D.DO$;
      360    11070    1        NMSLASH = MACT$CMD.NMSLASH;
      361    11071    1        FMT = MACT$CMD.FORMAT;
      362    11072    1        IF FMT = %DEFAULT_FMT
      363    11073    1        THEN FMT = S_D.O$.FMT;
      364    11074    1        ADDRESS = S_D.O$.ADDRESS;
      365    11075    1        SEG = S_D.O$.SEG;
      366    11076    1        DESC# = S_D.O$.DESC#;
      367    11077    1        NOT_IS = S_D.O$.NOT_IS;
      368    11078    1        SAVE_DOMAIN = '0'B;
      369    11079    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND
      370    11080    1          SEG = 7 AND
      371    11081    1          DESC# = 2 AND
      372    11082    1          S_D.RUM
      373    11083    2        THEN DO;
      374    11084    2             SAVE_DOMAIN = '1'B;
      375    11085    2             SAVE_EXEC_DOMAIN = S_D.ONE_TO_TWO.EXEC_DOMAIN;
      376    11086    2             S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST;
      377    11087    2           END;
      378    11088
      379    11089    1        IF MACT$CMD.DDESC
      380    11090    2        THEN DO;
      381    11091    2             S_D.DESC$ = S_D.D$;
      382    11092    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      383    11093    2             THEN CALL IORVALUE(NVALUE,MACT$CMD.INSTR,MACT$CMD.IGNPR,MACT$CMD.AWDX)
             11093                      ALTRET(MERR);
      384    11094    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      385    11095    2                  THEN CALL L6_IORVALUE(NVALUE,MACT$CMD.INSTR,ADDRESS)ALTRET(MERR);
      386    11096    2                  ELSE GOTO MERR1;
      387    11097    2             IF S_D.RUM
      388    11098    3             THEN DO;
      389    11099    3                  NODE = 0;
      390    11100    3                  IF S_D.OVERLAID
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:12   
      391    11101    3                  THEN CALL DDS$IC2NODE( ADDRESS, NODE ) ALTRET( MERR );
      392    11102    3                  CALL DUU$PUTMVAL(NVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
             11102                           MERR);
      393    11103    3                END;
      394    11104    2             ELSE IF S_D.ANLZ_FILE
      395    11105    3                  THEN DO;
      396    11106    3                       S_D.ERROR = 155; /*E@CANTPUTINANLZ*/
      397    11107    3                       GOTO MERR;
      398    11108    3                     END;
      399    11109    2                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      400    11110    2                       THEN CALL DDK$PUTMVAL(NVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS
             11110                                ) ALTRET(MERR);
      401    11111    2                       ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      402    11112    2                            THEN CALL DFK$PUTMVAL(NVALUE, , ADDRESS, SEG, DESC#, NOT_IS
             11112                                     ) ALTRET(MERR);
      403    11113    2                            ELSE GOTO MERR1;
      404    11114    2             IF S_D.ANLZ AND NOT S_D.ANLZ_MODIFIED AND NOT S_D.ANLZ_FILE AND NOT (
             11114                      MACTIVE AND S_D.ALIB_SAID_GOBACK)
      405    11115    3             THEN DO;
      406    11116    3                  S_D.ANLZ_MODIFIED = '1'B;
      407    11117    3                  CALL DUQ$OCMSG (60 /* ANLZMOD_MSG# */);
      408    11118    3                END;
      409    11119    2             OVALUE.OPS = S_D.L$.VALUE;
      410    11120    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      411    11121    2             THEN OVALUE.SIZE = S_D.L$.SIZE / 36;
      412    11122    2             ELSE OVALUE.SIZE = S_D.L$.SIZE / 16;
      413    11123    2             S_D.L$.VALUE = NVALUE.OPS;
      414    11124    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      415    11125    2             THEN S_D.L$.SIZE = 36;
      416    11126    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      417    11127    3                  THEN DO;
      418    11128    3                       IF FMT = %INST_FMT
      419    11129    4                       THEN DO;
      420    11130    4                            CALL DFR$INSTR (NVALUE.OPS, S_D.O$SIZE,
      421    11131    4                              '0'B, '1'B) ALTRET(NOTINST);
      422    11132    4                          END;
      423    11133    4                       ELSE DO;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:13   
      424    11134    4   NOTINST:
      425    11135    4                            IF S_D.MDW = '1'B OR FMT = %PTR_FMT
      426    11136    4                            THEN S_D.O$SIZE = 2;
      427    11137    4                            ELSE S_D.O$SIZE = 1;
      428    11138    4                          END;
      429    11139    3                       S_D.L$.SIZE = S_D.O$SIZE * 16;
      430    11140    3                     END;
      431    11141    2             IF MACT$CMD.INSTR
      432    11142    2             THEN S_D.L$.FMT = %INST_FMT;
      433    11143    2             ELSE S_D.L$.FMT = S_D.POFMT;  /* If not instr use old FMT */
      434    11144    2             IF NOT_IS AND SEG = 9 AND DESC# = 0
      435    11145    2             THEN S_D.L$.FMT = FMT;
      436    11146    2             IF S_D.RUM OR S_D.ANLZ OR S_D.PATCH
      437    11147    3             THEN DO;
      438    11148                                 /* Reserve 16 characters for the replacement value */
      439    11149    3                  S_D.DESCL$ = PINCRC(ADDR(S_D.PIMAGE), LENGTHC(S_D.PIMAGE)-16);
      440    11150    3                  S_D.D$ = PINCRC(ADDR(S_D.PIMAGE), S_D.PCHARS);
      441    11151    3                  TEXT$ = S_D.D$;
      442    11152    3                  CALL DDR$BUMPC_D$(2) ALTRET(BUFFUL0);
      443    11153    3                  TEXT$ -> CHAR2 = '/ ';
      444    11154    3                  CALL DDA$DISPFMT(S_D.L$.FMT, S_D.L$.SIZE, NVALUE.OPS)
      445    11155    3                    ALTRET(BUFFUL0);
      446    11156    3                  S_D.DESCL$ = PINCRC(S_D.DESCL$, 16);
      447    11157    3                  TEXT$ = S_D.D$;
      448    11158    3                  CALL DDR$BUMPC_D$(2) ALTRET(BUFFULL);
      449    11159    3                  TEXT$ -> CHAR2 = ' (';
      450    11160    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      451    11161    3                  THEN CALL DDA$DISPFMT(S_D.POFMT, OVALUE.SIZE * 36, S_D.POVALUE.OPS,,
             11161                           '1'B) ALTRET(BUFFULL);
      452    11162    3                  ELSE CALL DDA$DISPFMT(S_D.POFMT, OVALUE.SIZE * 16, S_D.POVALUE.OPS,,
             11162                           '1'B) ALTRET(BUFFULL);
      453    11163    3                  TEXT$ = S_D.D$;
      454    11164    3                  CALL DDR$BUMPC_D$(1) ALTRET(BUFFULL);
      455    11165    3                  TEXT$ -> CHAR1 = ')';
      456    11166    4                  DO WHILE ('0'B);
      457    11167    4   BUFFUL0:            S_D.DESCL$ = PINCRC(S_D.DESCL$, 16);
      458    11168    4   BUFFULL:            IF S_D.ERROR ~= 88 /*E@BUFFULL*/ THEN GOTO MERR1;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:14   
      459    11169    4                       S_D.ERROR = 349; /* E@ROBFULL */
      460    11170    4                       CALL DDE$ERROR;
      461    11171    4                       IF S_D.D$ > PINCRC(S_D.DESCL$, -3)
      462    11172    4                       THEN S_D.D$ = PINCRC(S_D.DESCL$, -3);
      463    11173    4                       NCHARS = 3;
      464    11174    4                       S_D.D$ -> TEXTR = '...';
      465    11175    4                       CALL DDR$BUMPC_D$(3) ALTRET(MERR1);
      466    11176    4                     END;
      467    11177    3                  TEMP = POFFC(S_D.D$, ADDR(S_D.PIMAGE));
      468    11178    3                  IF S_D.RUM AND NOT S_D.RUM_TEST
      469    11179    4                  THEN DO;
      470    11180    4                       START$ = ADDR(S_D.PIMAGE);
      471    11181    4                       CALL DDQ$WRITELM(%TYPRUM, 0, NODE, START$, TEMP ) ALTRET(MERR2);
      472    11182    4                     END;
      473    11183    3                  ELSE IF S_D.PATCH
      474    11184    4                       THEN DO;
      475    11185    4                            S_D.XDP.IMAGE.INP = S_D.INPUT;
      476    11186    4                            S_D.XDP.IMAGE.OTP = S_D.PIMAGE;
      477    11187    4                            CALL DXQ$WRTPI (ADDR(S_D.XDP), SIZEC(S_D.XDP.IMAGE));
      478    11188    4                          END;
      479    11189    3                       ELSE IF S_D.ANLZ AND NOT S_D.ANLZ_FILE AND NOT(MACTIVE AND S_D.
             11189                                ALIB_SAID_GOBACK)
      480    11190    4                            THEN DO;
      481    11191    4                                 S_D.OUTPUT = S_D.PIMAGE;
      482    11192    4                                 CALL DUQ$WRERRLOG (TEMP);
      483    11193    4                               END;
      484    11194    3                END;                       /* DO S_D.RUM */
      485    11195    2             IF NOT(NOT_IS)
      486    11196    3             THEN DO;
      487    11197    3                  IF (ADDRESS >= S_D.NEXT@) AND (ADDRESS <= S_D.HIGH@) AND S_D.GOT@
      488    11198    3                  THEN CALL DDK$INCR@ (ADDRESS, NVALUE.SIZE) ALTRET(MERR);
      489    11199    4                  ELSE DO;
      490    11200    4                       IF (ADDRESS >= S_D.NEXT#) AND (ADDRESS <= S_D.HIGH#) AND S_D.
             11200                                GOT#
      491    11201    4                       THEN CALL DDK$INCR# (ADDRESS, NVALUE.SIZE) ALTRET(MERR);
      492    11202    5                       ELSE DO;
      493    11203    5                            S_D.RI$ = OVALUE;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:15   
      494    11204    5                            IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      495    11205    5                            THEN
      496    11206    5                                 S_D.NA$ = ADDRESS + 1;
      497    11207    5                            ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      498    11208    5                                 THEN
      499    11209    5                                      S_D.NA$ = ADDRESS + NVALUE.SIZE;
      500    11210    5                                 ELSE GOTO MERR1;
      501    11211    5                          END;
      502    11212    4                     END;
      503    11213    3                END;
      504    11214    2           END;                            /* DO  ( value specified ) */
      505    11215    1        CASECODE = MACT$CMD.SUBCODE ;
      506    11216    1        IF CASECODE < 393 THEN GOTO MRTN;
      507    11217    2        DO CASE( CASECODE );
      508    11218
      509    11219    2          CASE( 393 );     /* M@NEXT */ /* <lf>, n */
      510    11220
      511    11221    2             S_D.EIS = S_D.EIS_SHIFT.X;
      512    11222    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST OR SEG = 9
      513    11223    2             THEN
      514    11224    2                  ADDRESS = ADDRESS + 1;
      515    11225    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      516    11226    2                  THEN ADDRESS = ADDRESS + S_D.O$SIZE;
      517    11227    2             IF NOT_IS AND SEG = 6         /* Host encoded special symbols */
      518    11228    3             THEN DO;
      519    11229    4                  DO CASE( DESC# );
      520    11230    4                    CASE( 0 );             /* $E ... $IC */
      521    11231    4                       TEMP = 12;
      522    11232    4                    CASE( 1 );             /* $ARn */
      523    11233    4                       TEMP = 7;
      524    11234    4                    CASE( 2 );             /* $PRn */
      525    11235    4                       TEMP = 7;
      526    11236    4                    CASE( 3 );             /* $AU ... $QL */
      527    11237    4                       TEMP = 3;
      528    11238    4                    CASE( 4 );             /* $IOBUFSZ */
      529    11239    4                       TEMP = 0;
      530    11240    4                    CASE( 5 );             /* $WSRn */
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:16   
      531    11241    4                       TEMP = 7;
      532    11242    4                    CASE( 6 );             /* $WSQn */
      533    11243    4                       TEMP = 510;
      534    11244    4                    CASE( 7 );             /* $Fxxxx */
      535    11245    4                       TEMP = 1;
      536    11246    4                    END;                   /* DO CASE( DESC# ) */
      537    11247    3                  IF ADDRESS > TEMP
      538    11248    4                  THEN DO;
      539    11249    4                       RETURN;
      540    11250    4                     END;
      541    11251    3                END;                       /* IF SEG = 6 */
      542    11252    2             IF SEG = 7                    /* RUM symbols */
      543    11253    3             THEN DO;
      544    11254    3                  IF DESC# ~= 2 OR ADDRESS > 39 /* SIZEW(HEAD) */
      545    11255    4                  THEN DO;
      546    11256    4                       GOTO MRTN;
      547    11257    4                     END;
      548    11258    3                END;
      549    11259    2             IF NOT_IS AND SEG = 9 AND DESC# = 0 /* L6 encoded special symbols */
      550    11260    3             THEN DO;
      551    11261    3                  IF ADDRESS > 21
      552    11262    4                  THEN DO;
      553    11263    4                       RETURN;
      554    11264    4                     END;
      555    11265    3                  GOTO SET_FMTMDW;
      556    11266    3                END;
      557    11267    2             IF NOT_IS AND SEG = 10 AND NOT S_D.IS_PTR
      558    11268    3             THEN DO;
      559    11269    3                  DESC# = DESC# + 1;
      560    11270    3                  ADDRESS = 0;
      561    11271    3                  IF DESC# > 7
      562    11272    4                  THEN DO;
      563    11273    4                       SEG = 9;
      564    11274    4                       DESC# = 0;
      565    11275    4                       FMT = %X_FMT;
      566    11276    4                       S_D.MDW = '0'B;
      567    11277    4                     END;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:17   
      568    11278    3                END;
      569    11279
      570    11280    2          CASE( 394 );     /* M@PREV */ /* ^, p */
      571    11281
      572    11282    2             S_D.EIS = '0'B;
      573    11283    2             IF SEG = 10 AND
      574    11284    2               NOT_IS AND
      575    11285    2               NOT S_D.IS_PTR
      576    11286    3             THEN DO;
      577    11287    3                  DESC# = DESC# - 1;
      578    11288    3                  IF DESC# < 1
      579    11289    4                  THEN DO;
      580    11290    4                       RETURN;
      581    11291    4                     END;
      582    11292    3                END;
      583    11293    2             ELSE IF SEG = 9 AND
      584    11294    2                    DESC# = 0 AND
      585    11295    2                    ADDRESS = 0 AND
      586    11296    2                    NOT_IS
      587    11297    3                  THEN DO;
      588    11298    3                       SEG = 10;
      589    11299    3                       DESC# = 7;
      590    11300    3                       FMT = %PTR_FMT;
      591    11301    3                       S_D.MDW = '1'B;
      592    11302    3                     END;
      593    11303    3                  ELSE DO;
      594    11304    3                       ADDRESS = ADDRESS - 1;
      595    11305    3                       IF ADDRESS < 0 OR SEG = 6 AND ADDRESS < %IC_RTN
      596    11306    3                         AND S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      597    11307    4                       THEN DO;
      598    11308    4                            GOTO MRTN;
      599    11309    4                          END;
      600    11310    3   SET_FMTMDW:         IF NOT_IS AND SEG = 9 AND DESC# = 0
      601    11311    4                       THEN DO CASE (ADDRESS);
      602    11312    4                         CASE(6, 15, 18, 20); /* R6< >S Z< >CI */
      603    11313    4                            FMT = %X_FMT;
      604    11314    4                            S_D.MDW = '0'B;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:18   
      605    11315    4                         CASE(7, 13);      /* >M1 M7< */
      606    11316    4                            FMT = %BIT_FMT;
      607    11317    4                            S_D.MDW = '0'B;
      608    11318    4                         CASE(14, 16, 17, 19); /* >T< >A IV< >ASV< */
      609    11319    4                            FMT = %PTR_FMT;
      610    11320    4                            S_D.MDW = '1'B;
      611    11321    4                         END;
      612    11322    3                     END;
      613    11323
      614    11324    2          CASE( 396 ); /* M@INDIRECT_PTR */ /* *P */
      615    11325
      616    11326    2             S_D.L$.FMT = %PTR_FMT;
      617    11327    2             GOTO TAB;
      618    11328
      619    11329    2          CASE( 397 ); /* M@INDIRECT_SHORTPTR */ /* *SP */
      620    11330
      621    11331    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      622    11332    3             THEN DO;
      623    11333    3                  S_D.ERROR = 290;
      624    11334                                                /* E@INVALID_HOSTSUBDIRECTIVE */
      625    11335    3                  ALTRETURN;
      626    11336    3                END;
      627    11337    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      628    11338    3                  THEN DO;
      629    11339    3                       ADDRESS = 0;
      630    11340    3                       L6_ADDRESS.R16 = S_D.L$.L6_VALUE.OPS(0);
      631    11341    3                     END;
      632    11342    2                  ELSE GOTO MERR1;
      633    11343
      634    11344    2          CASE( 398 ); /* M@INDIRECT_LEFT */ /* *L */
      635    11345
      636    11346    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      637    11347    3             THEN DO;
      638    11348    3                  S_D.ERROR = 291;/*E@INVALID_FEPSUBDIRECTIVE*/
      639    11349    3                  ALTRETURN;
      640    11350    3                END;
      641    11351    2             S_D.L$.FMT = %OCT_FMT;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:19   
      642    11352    2             GOTO TAB;
      643    11353
      644    11354    2          CASE( 399 );/* M@INDIRECT_RIGHT */ /* *R */
      645    11355
      646    11356    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      647    11357    3             THEN DO;
      648    11358    3                  S_D.ERROR = 291;/*E@INVALID_FEPSUBDIRECTIVE*/
      649    11359    3                  ALTRETURN;
      650    11360    3                END;
      651    11361    2             S_D.L$.FMT = %REL_FMT;
      652    11362    2             GOTO TAB;
      653    11363
      654    11364    2          CASE( 400 );     /* M@OPEN */ /* [, O, { */
      655    11365                                                /* DO NOTHING */
      656    11366    2          CASE( 395 ); /* M@INDIRECT */ /* *, <slash> */
      657    11367    2   TAB:
      658    11368    2             S_D.EIS = '0'B;
      659    11369    2             FMT = MACT$CMD.FORMAT;
      660    11370    2             LVALUE = S_D.L$.VALUE.L;
      661    11371    2             NOT_IS = '0'B;
      662    11372    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      663    11373    3             THEN DO CASE(S_D.L$.FMT);
      664    11374    3               CASE( %INST_FMT );
      665    11375                                                /* For now use y-field only, into IS  */
      666    11376    3                  OFFSET = 0;
      667    11377    3                  TADDRESS = LINSTR.ADDRESS;
      668    11378    3                  IF (NOT S_D.O$.NOT_IS)
      669    11379    4                  THEN DO;
      670    11380    4                       IF LINSTR.TAG = 4/*IC_MOD*/ THEN OFFSET = ADDRESS;
      671    11381    5                       IF LINSTR.BIT29 THEN DO;
      672    11382    5                            PR = PINCRW(S_D.USS$, 16+LINSTR.PADD.PNTR)->BIT36;
      673    11383    5                            SEG = PR.SD.S;
      674    11384    5                            DESC# = PR.SD.D;
      675    11385    5                            OFFSET = OFFSET + PR.AR.W;
      676    11386    5                            NOT_IS = '1'B;
      677    11387    5                            TADDRESS = LINSTR.PADD.OFFSET;
      678    11388    5                          END;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:20   
      679    11389    4                     END;
      680    11390    3                  IF ADDRESS >= S_D.ISBASE AND S_D.ISBASE ~= 0 AND NOT(NOT_IS)
      681    11391    3                  THEN ADDRESS = TADDRESS + S_D.ISBASE + OFFSET;
      682    11392    3                  ELSE ADDRESS = TADDRESS + OFFSET;
      683    11393    3               CASE( %PTR_FMT );
      684    11394    3                  ADDRESS = LAR.OFFSET;
      685    11395    3                  IF LAR.PLUS ~= 0
      686    11396    3                  THEN PLUS = '1'B;
      687    11397    3                  SEG = LAR.SEG;
      688    11398    3                  IF SEG = 1
      689    11399    3                  THEN SEG = 3;            /* Funny segid */
      690    11400    3                  DESC# = LAR.DESC#;
      691    11401    3                  IF DESC# > BITBIN('1700'O)
      692    11402    4                  THEN DO;
      693    11403    4                       S_D.ERROR = 84; /* E@CANTFINDSEG */
      694    11404    4                       GOTO MERR;
      695    11405    4                     END;
      696    11406    3                  IF SEG = 3
      697    11407    3                    AND DESC# = 0
      698    11408    3                  THEN NOT_IS = '0'B;
      699    11409    3                  ELSE NOT_IS = '1'B;
      700    11410    3               CASE( %REL_FMT );
      701    11411    3                  IF ADDRESS >= S_D.ISBASE AND S_D.ISBASE ~= 0
      702    11412    3                  THEN ADDRESS = LRELVAL.RH + S_D.ISBASE;
      703    11413    3                  ELSE ADDRESS = LRELVAL.RH;
      704    11414    3               CASE( %OCT_FMT, %UINT_FMT, %SINT_FMT, %BIT_FMT, %X_FMT );
      705    11415    3                  IF ADDRESS >= S_D.ISBASE AND S_D.ISBASE ~= 0
      706    11416    3                  THEN ADDRESS = LINSTR.ADDRESS + S_D.ISBASE;
      707    11417    3                  ELSE ADDRESS = LINSTR.ADDRESS;
      708    11418    3               CASE( ELSE );
      709    11419    3                  S_D.ERROR = 85;   /* E@CANTTAB */
      710    11420    3                  GOTO MERR;
      711    11421    3               END;                        /* DO  CASE(S_D.L$.FMT)  */
      712    11422    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      713    11423    3                  THEN DO CASE(S_D.L$.FMT);
      714    11424    3                    CASE( %INST_FMT );
      715    11425    3                       IF S_D.L6_TAB
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:21   
      716    11426    3                       THEN ADDRESS = S_D.L6_TAB_VALUE;
      717    11427    4                       ELSE DO;
      718    11428    4                            S_D.ERROR = 340; /* E@NOTAB */
      719    11429    4                            GOTO MERR;
      720    11430    4                          END;
      721    11431    3                    CASE( %PTR_FMT, %REL_FMT );
      722    11432    3                       ADDRESS = 0;
      723    11433    3                       SEG = 3;
      724    11434    3                       DESC# = 0;
      725    11435    3                       L6_ADDRESS.L4 = S_D.L$.L6_VALUE.OPS(0);
      726    11436    3                       L6_ADDRESS.R16 = S_D.L$.L6_VALUE.OPS(1);
      727    11437    3                    CASE( %OCT_FMT, %UINT_FMT, %SINT_FMT, %BIT_FMT, %X_FMT );
      728    11438    3                       IF S_D.L$.SIZE <= 16
      729    11439    3                       THEN ADDRESS = S_D.L$.L6_VALUE.OPS(0);
      730    11440    4                       ELSE DO;
      731    11441    4                            L6_ADDRESS.L4 = S_D.L$.L6_VALUE.OPS(0);
      732    11442    4                            L6_ADDRESS.R16 = S_D.L$.L6_VALUE.OPS(1);
      733    11443    4                          END;
      734    11444    3                    CASE (ELSE );
      735    11445    3                       S_D.ERROR = 85; /* E@CANTTAB */
      736    11446    3                       GOTO MERR;
      737    11447    3                    END;
      738    11448    2                  ELSE
      739    11449    2                       GOTO MERR1;
      740    11450    2          END;                             /* DO  CASE(CASECODE)  */
      741    11451    1        IF S_D.RUM
      742    11452    2        THEN DO;
      743    11453    2             NODE = 0;
      744    11454    2             IF S_D.OVERLAID
      745    11455    2             THEN CALL DDS$IC2NODE( ADDRESS, NODE ) ALTRET( MERR );
      746    11456    2             CALL DUU$GETMVAL(NVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(MERR);
      747    11457    2           END;
      748    11458    2        ELSE DO;
      749    11459    2             NVALUE.SIZE = 1;
      750    11460    2             IF S_D.ANLZ_FILE
      751    11461    2             THEN CALL DUL$GETMVAL(NVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
             11461                      MERR);
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:22   
      752    11462    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      753    11463    2                  THEN CALL DDK$GETMVAL(NVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS)
             11463                           ALTRET(MERR);
      754    11464    2                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      755    11465    2                       THEN CALL DFK$GETMVAL(NVALUE, ADDRESS, SEG, DESC#, NOT_IS, '1'B)
             11465                                ALTRET(MERR);
      756    11466    2                       ELSE GOTO MERR1;
      757    11467    2           END;
      758    11468    1        MACTIVE = '1'B;
      759    11469                                                /**/
      760    11470    1   DISPMOD:                                /* All MODIFY  commands end up here */
      761    11471                                                /**/
      762    11472    1        IF NOT NMSLASH
      763    11473    2        THEN DO;
      764    11474    2             S_D.O$.ADDRESS = ADDRESS;
      765    11475    2             S_D.O$.SEG = SEG;
      766    11476    2             S_D.O$.DESC# = DESC#;
      767    11477    2             S_D.O$.NOT_IS = NOT_IS;
      768    11478    2           END;
      769    11479                                                /**/
      770    11480    1        S_D.D$ = ADDR(S_D.OUTPUT);
      771    11481    1        S_D.OUTPUT = ' ';
      772    11482    1        S_D.DESCL$ = PINCRC(S_D.D$, LENGTHC(S_D.OUTPUT));
      773    11483    1        S_D.FNDENTDEF = '0'B;
      774    11484    1        CALL DDA$DISPADR(ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT,,36) ALTRET(MERR);
      775    11485    1        CALL DDS$SET_Q2D;
      776    11486    1        TEXT$ = S_D.D$;
      777    11487    1        IF MACTIVE AND (S_D.RUM OR S_D.ANLZ)
      778    11488    2        THEN DO;                 /* Remember old address and previous contents */
      779    11489    2             NCHARS = POFFC(TEXT$, ADDR(S_D.OUTPUT));
      780    11490    2             S_D.PCHARS = NCHARS;
      781    11491    2             S_D.PIMAGE = ' ';
      782    11492    2             ADDR(S_D.PIMAGE) -> TEXTR = S_D.OUTPUT;
      783    11493    2             S_D.POVALUE = NVALUE;
      784    11494    2           END;
      785    11495    1        CALL DDR$BUMPC_D$(2) ALTRET(MERR1);
      786    11496    1        TEXT$ -> CHAR2 = '/ ';
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:23   
      787    11497    1        IF SUPADR
      788    11498    1        THEN S_D.D$ = ADDR(S_D.OUTPUT);    /* '/' activation */
      789    11499    1        IF (FMT = %DEFAULT_FMT OR FMT = %INST_FMT)
      790    11500    1          AND ADDRESS >= S_D.ISBASE AND S_D.ISBASE ~= 0
      791    11501    2        THEN DO;
      792    11502    2             FMT = %INST_FMT;
      793    11503    2             S_D.KILLEDEF = '1'B;
      794    11504    2             S_D.MDW = '0'B;
      795    11505    2           END;
      796    11506    1        ELSE IF FMT = %DEFAULT_FMT
      797    11507    1             THEN IF S_D.FNDENTDEF /* ( set by DDR$POSIT called by DDA$DISPADR ) */
      798    11508    2                  THEN DO;
      799    11509    2                       FMT = %INST_FMT;
      800    11510    2                       S_D.MDW = '0'B;
      801    11511    2                     END;
      802    11512    1                  ELSE FMT = S_D.FMT_DEFAULT;
      803    11513    1        S_D.POFMT = FMT; /* Remember old format in case we're interactively RUMing */
      804    11514    1        IF FMT = %L$_FMT
      805    11515    1        THEN FMT = S_D.L$.FMT;
      806    11516    1        IF NOT NMSLASH
      807    11517    1        THEN S_D.O$.FMT = FMT;
      808    11518    1        S_D.L$.FMT = FMT;
      809    11519    1        S_D.L$.VALUE = NVALUE.OPS;
      810    11520    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      811    11521    1        THEN S_D.L$.SIZE = 36;
      812    11522    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      813    11523    2             THEN DO;
      814    11524    2                  IF FMT = %INST_FMT AND NOT S_D.MDW
      815    11525    3                  THEN DO;
      816    11526    3                       CALL DFR$INSTR (NVALUE.OPS, S_D.L$.SIZE, '0'B, '1'B) ALTRET(
             11526                                NOTINSTR);
      817    11527    3                       S_D.L$.SIZE = S_D.L$.SIZE * 16;
      818    11528    3                     END;
      819    11529    3                  ELSE DO;
      820    11530    3   NOTINSTR:
      821    11531    3                       IF S_D.MDW = '1'B OR FMT = %PTR_FMT
      822    11532    3                       THEN S_D.L$.SIZE = 2 * 16;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:24   
      823    11533    3                       ELSE S_D.L$.SIZE = 1 * 16;
      824    11534    3                       IF SEG = 6 OR SEG = 7 OR SEG = 10
      825    11535    3                       THEN S_D.L$.SIZE = 32;
      826    11536    3                     END;
      827    11537    2                END;
      828    11538    1        IF MACTIVE
      829    11539    1        THEN
      830    11540    1             S_D.MACTIVE = ~ S_D.ALIB_SAID_GOBACK;
      831    11541    1        CALL DDA$DISPFMT(FMT, S_D.L$.SIZE, NVALUE.OPS) ALTRET(MERR);
      832    11542    1        IF FMT = %INST_FMT
      833    11543    2        THEN DO;
      834    11544    2             CALL DFR$INSTR (OVALUE.OPS, TSIZE, '0'B) ALTRET(NOTINS);
      835    11545    2             TSIZE = TSIZE * 16;
      836    11546    2           END;
      837    11547    2        ELSE DO;
      838    11548    2   NOTINS:
      839    11549    2             TSIZE = S_D.L$.SIZE;
      840    11550    2           END;
      841    11551    1        IF SETNA$
      842    11552    2        THEN DO;
      843    11553    2             S_D.NA$ = S_D.NA$ + (S_D.L$.SIZE / 16);
      844    11554    2             S_D.RI$.SIZE = TSIZE / 16;
      845    11555    2           END;
      846    11556    1        IF NOT NMSLASH
      847    11557    1        THEN S_D.O$SIZE = S_D.L$.SIZE / 16;
      848    11558    1        IF NOT MACTIVE
      849    11559    2        THEN DO;
      850    11560    2             TEXT$ = S_D.D$;
      851    11561    2             CALL DDR$BUMPC_D$(2) ALTRET(MERR1);
      852    11562    2             TEXT$ -> CHAR2 = ' (';
      853    11563    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      854    11564    2             THEN CALL DDA$DISPFMT(FMT, 36, OVALUE.OPS) ALTRET(MERR1);
      855    11565    2             ELSE CALL DDA$DISPFMT(FMT, TSIZE, OVALUE.OPS) ALTRET(MERR1);
      856    11566    2             TEXT$ = S_D.D$;
      857    11567    2             CALL DDR$BUMPC_D$(1) ALTRET(MERR1);
      858    11568    2             TEXT$ -> CHAR1 = ')';
      859    11569    2           END;                            /* if NOT MACTIVE */
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:25   
      860    11570    1        START$ = ADDR( S_D.OUTPUT );
      861    11571    1        TEMP = POFFC( S_D.D$, START$ );
      862    11572    1        IF S_D.SILENT THEN RETURN;         /* ATTACHENT TO SILENT BREAKPOINT */
      863    11573    1        IF S_D.MACTIVE
      864    11574    1        THEN CALL DDQ$WRITENU( START$, TEMP );
      865    11575    2        ELSE DO;
      866    11576    2             CALL DDQ$WRITE( START$, TEMP );
      867    11577    2             IF S_D.ANLZ AND NOT S_D.ANLZ_MODIFIED AND NOT S_D.ANLZ_FILE AND NOT (
             11577                      MACTIVE AND S_D.ALIB_SAID_GOBACK)
      868    11578    3             THEN DO;
      869    11579    3                  S_D.ANLZ_MODIFIED = '1'B;
      870    11580    3                  CALL DUQ$OCMSG (60 /* ANLZMOD_MSG# */);
      871    11581    3                END;
      872    11582    2             IF S_D.RUM AND NOT S_D.RUM_TEST
      873    11583    3             THEN DO;
      874    11584    3                  S_D.D$ = ADDR(S_D.OUTPUT);
      875    11585    3                  S_D.OUTPUT = ' ';
      876    11586    3                  S_D.DESCL$ = PINCRC(S_D.D$, LENGTHC(S_D.OUTPUT));
      877    11587    3                  CALL DDA$DISPADR(ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT, '1'B, 36)
             11587                           ALTRET(MERR);
      878    11588    3                  CALL DDR$BUMPC_D$(2) ALTRET(MERR1);
      879    11589    3                  TEXT$ -> CHAR2 = '/ ';
      880    11590    3                  IF SUPADR
      881    11591    3                  THEN S_D.D$ = ADDR(S_D.OUTPUT); /* '/' activation */
      882    11592    3                  CALL DDA$DISPFMT(FMT, S_D.L$.SIZE, NVALUE.OPS, , '1'B) ALTRET(MERR);
      883    11593    3                  IF MACTIVE
      884    11594    3                  THEN
      885    11595    3                       S_D.MACTIVE = '1'B;
      886    11596    4                  ELSE DO;
      887    11597    4                       TEXT$ = S_D.D$;
      888    11598    4                       CALL DDR$BUMPC_D$(2) ALTRET(MERR1);
      889    11599    4                       TEXT$ -> CHAR2 = ' (';
      890    11600    4                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      891    11601    4                       THEN CALL DDA$DISPFMT(FMT, 36, OVALUE.OPS(0), , '1'B) ALTRET(
             11601                                MERR1);
      892    11602    4                       ELSE CALL DDA$DISPFMT(FMT, TSIZE, OVALUE.OPS(0), , '1'B) ALTRET(
             11602                                MERR1);
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:26   
      893    11603    4                       TEXT$ = S_D.D$;
      894    11604    4                       CALL DDR$BUMPC_D$(1) ALTRET(MERR1);
      895    11605    4                       TEXT$ -> CHAR1 = ')';
      896    11606    4                     END;                  /* not MACTIVE */
      897    11607    3                  START$ = ADDR( S_D.OUTPUT );
      898    11608    3                  TEMP = POFFC( S_D.D$, START$ );
      899    11609    3                  CALL DDQ$WRITELM( %TYPRUM, 0, NODE, START$, TEMP ) ALTRET( MERR2 );
      900    11610    3                END;
      901    11611    2             ELSE IF S_D.PATCH
      902    11612    3                  THEN DO;
      903    11613    3                       MYBUF = S_D.OUTPUT;
      904    11614    3                       S_D.XDP.IMAGE.INP = S_D.INPUT;
      905    11615    3                       S_D.XDP.IMAGE.OTP = MYBUF;
      906    11616    3                       CALL DXQ$WRTPI (ADDR(S_D.XDP), SIZEC(S_D.XDP.IMAGE));
      907    11617    3                     END;
      908    11618    2                  ELSE IF S_D.ANLZ AND NOT S_D.ANLZ_FILE AND NOT(MACTIVE AND S_D.
             11618                           ALIB_SAID_GOBACK)
      909    11619    2                       THEN CALL DUQ$WRERRLOG(TEMP);
      910    11620    2           END;
      911    11621    1        IF NMSLASH
      912    11622    2        THEN DO;
      913    11623    2             S_D.MACTIVE = '0'B;
      914    11624    2             S_D.STEP = '1'B;              /* KEEP PROMPT ON SAME LINE */
      915    11625    2           END;
      916    11626    1        GOTO MRTN;
      917    11627    1   MERR1:
      918    11628    1        S_D.ERROR = 502;              /* E@DELBUG */
      919    11629    1        CALL DDE$ERROR;
      920    11630    1        GOTO MRTN;
      921    11631    1   MERR2:
      922    11632    1        S_D.ERROR = 239;      /* E@CANT_UPDATE_RU */
      923    11633    1        CALL DDE$ERROR;
      924    11634    1   MRTN: ;
      925    11635    1        IF SAVE_DOMAIN
      926    11636    2        THEN DO;
      927    11637    2             S_D.ONE_TO_TWO.EXEC_DOMAIN = SAVE_EXEC_DOMAIN;
      928    11638    2           END;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:27   
      929    11639    1        RETURN;
      930    11640    1   MERR:
      931    11641    1        IF SAVE_DOMAIN
      932    11642    2        THEN DO;
      933    11643    2             S_D.ONE_TO_TWO.EXEC_DOMAIN = SAVE_EXEC_DOMAIN;
      934    11644    2           END;
      935    11645    1        ALTRETURN;
      936    11646             %EJECT;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:28   
      937    11647    1   IORVALUE: PROC(RVALUE, IFLAG, ZFLAG, XFLAG) ALTRET;
      938    11648    2   DCL 1 RVALUE,
      939    11649    2         2 SIZE UBIN WORD,
      940    11650    2         2 OPS(0:15) UBIN WORD;
      941    11651    2   DCL IFLAG BIT(1) UNAL;
      942    11652    2   DCL ZFLAG BIT(1) UNAL;
      943    11653    2   DCL XFLAG BIT(1) UNAL;
      944    11654        /*D* NAME: IORVALUE */
      945    11655        /*D* The routine IOVALUE  constructs a 36-bit value from a data
      946    11656             descriptor optionally preceded  by an instruction template
      947    11657             as specified by IFLAG.   This input information is at S_D.D$,
      948    11658             and upon normal return S_D.D$ points to the next word following
      949    11659             the data descriptor.  ALTRET  is taken if the address data
      950    11660             descriptor cant be evaluated.
      951    11661                                                     */
      952    11662    2   DCL VALUE UBIN;
      953    11663    2   DCL 1 OVALUE REDEF VALUE,
      954    11664    2         2 * UBIN(3) UNAL,
      955    11665    2         2 OFFSET SBIN(15) UNAL,
      956    11666    2         2 * UBIN(11) UNAL,
      957    11667    2         2 BIT29 BIT(1) UNAL,
      958    11668    2         2 * UBIN(6) UNAL;
      959    11669    2   DCL 1 YVALUE REDEF VALUE,
      960    11670    2         2 Y UBIN(18) UNAL,
      961    11671    2         2 * UBIN(18) UNAL;
      962    11672    2   DCL UBIN36 UBIN BASED;
      963    11673    2   DCL ADDRESS UBIN;
      964    11674    2   DCL NOT_IS BIT(1) ALIGNED;
      965    11675    2   DCL DUM UBIN;
      966    11676    2   DCL DUM2 UBIN;
      967    11677                                                /**/
      968    11678    2        IF IFLAG
      969    11679    3        THEN DO;
      970    11680    3             VALUE = S_D.DESC$ -> UBIN36;
      971    11681    3             S_D.DESC$ = PINCRW(S_D.DESC$, 1);
      972    11682    3           END;
      973    11683    2        CALL DDK$EVAL(ADDRESS, DUM, DUM2, NOT_IS) ALTRET(ARET);
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:29   
      974    11684    2        IF NOT_IS
      975    11685    3        THEN DO;
      976    11686    3             S_D.ERROR = 86;      /* E@BADVALEXP */
      977    11687    3             ALTRETURN;
      978    11688    3           END;
      979    11689    2        IF IFLAG
      980    11690    2        THEN IF ( OVALUE.BIT29 AND NOT ZFLAG ) OR XFLAG
      981    11691    2             THEN OVALUE.OFFSET = ADDRESS;
      982    11692    2             ELSE YVALUE.Y = ADDRESS;
      983    11693    2        ELSE VALUE = ADDRESS;
      984    11694    2        RVALUE.SIZE = 1;
      985    11695    2        RVALUE.OPS(0) = VALUE;
      986    11696    2        RETURN;
      987    11697    2   ARET:
      988    11698    2        ALTRETURN;
      989    11699    2   END IORVALUE;
      990    11700        %EJECT;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:30   
      991    11701    1   L6_IORVALUE: PROC ( RVALUE ,IFLAG ,MOD_LOC ) ALTRET;
      992    11702
      993    11703        /*D* NAME: L6_IORVALUE */
      994    11704        /*D* This routine either assembles a L6 instruction or evaluates a
      995    11705             data descriptor.  */
      996    11706
      997    11707    2   DCL 1 RVALUE,
      998    11708    2         2 SIZE UBIN WORD,
      999    11709    2         2 OPS(0:15) UBIN WORD;
     1000    11710    2   DCL IFLAG BIT(1) UNAL;
     1001    11711    2   DCL MOD_LOC UBIN WORD;
     1002    11712    2   DCL ADDRESS UBIN;
     1003    11713    2   DCL 1 L6_DW REDEF ADDRESS,
     1004    11714    2         2 * UBIN(4) UNAL,
     1005    11715    2         2 UW UBIN(16) UNAL,
     1006    11716    2         2 LW UBIN(16) UNAL;
     1007    11717    2   DCL ADDRESSB REDEF ADDRESS BIT(36);
     1008    11718    2   DCL DUM UBIN;
     1009    11719    2   DCL DUM2 UBIN;
     1010    11720    2   DCL NOT_IS BIT(1) ALIGNED;
     1011    11721
     1012    11722    2        IF IFLAG
     1013    11723    2        THEN CALL DFS$INSTR(RVALUE,MOD_LOC,'0'B) ALTRET(ARET);
     1014    11724    3        ELSE DO;
     1015    11725    3             S_D.GOT$RI = '0'B;
     1016    11726    3             S_D.GOT$L = '0'B;
     1017    11727    3             CALL DDK$EVAL(ADDRESS ,DUM ,DUM2 ,NOT_IS)ALTRET(ARET);
     1018    11728    3             IF S_D.GOT$RI
     1019    11729    4             THEN DO;
     1020    11730    4                  RVALUE = S_D.RI$;
     1021    11731    4                  RETURN;
     1022    11732    4                END;
     1023    11733    3             IF S_D.GOT$L
     1024    11734    4             THEN DO;
     1025    11735    4                  RVALUE.OPS = S_D.L$.VALUE;
     1026    11736    4                  RVALUE.SIZE = S_D.L$.SIZE;
     1027    11737    4                  RETURN;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:31   
     1028    11738    4                END;
     1029    11739    3             IF NOT_IS
     1030    11740    4             THEN DO;
     1031    11741    4   BADVALEXP:     S_D.ERROR = 86; /* E@BADVALEXP */
     1032    11742    4                  ALTRETURN;
     1033    11743    4                END;
     1034    11744    3             IF FMT = %PTR_FMT OR S_D.MDW
     1035    11745    4             THEN DO;
     1036    11746    4                  RVALUE.SIZE = 2;
     1037    11747    4                  RVALUE.OPS(0) = L6_DW.UW;
     1038    11748    4                  RVALUE.OPS(1) = L6_DW.LW;
     1039    11749    4                END;
     1040    11750    4             ELSE DO;
     1041    11751    4                  IF S_D.SDOT AND L6_DW.LW = BITBIN('2020'X) /* Only use the top */
     1042    11752    4                  THEN
     1043    11753    4                       ADDRESS = ADDRESS / 65536; /* If the bottom isn't there */
     1044    11754    4                  IF ADDRESS > 65535 AND ADDRESS <= BITBIN('777777700000'O)
     1045    11755    4                  THEN
     1046    11756    4                       GOTO BADVALEXP;
     1047    11757    4                  RVALUE.SIZE = 1;
     1048    11758    4                  RVALUE.OPS(0) = ADDRESS;
     1049    11759    4                END;
     1050    11760    3           END;
     1051    11761    2        RETURN;
     1052    11762    2   ARET:
     1053    11763    2        ALTRETURN;
     1054    11764    2   END L6_IORVALUE;
     1055    11765
     1056    11766    1   END DDA$MOD;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:32   
--  Include file information  --

   GD$MSG_M.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$MOD.

   Procedure DDA$MOD requires 2375 words for executable code.
   Procedure DDA$MOD requires 160 words of local(AUTO) storage.

    No errors detected in file DDA$MOD.:E05TSI    .

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:33   

 Object Unit name= DDA$MOD                                    File name= DDA$MOD.:E05TOU
 UTS= JUL 29 '97 13:33:42.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      4      4  DDA$MOD
    1   Proc  even  none  2375   4507  DDA$MOD
    2  RoData even  none    38     46  DDA$MOD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  DDA$MOD
     1   1154          yes     yes      Std        0  DDA$MACTIVE
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:34   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       6 DDK$EVAL
 yes     yes           Std       6 DUU$PUTMVAL
 yes     yes           Std       8 DFK$EVAL
 yes     yes           Std       2 DDS$IC2NODE
 yes     yes           Std       6 DUU$GETMVAL
 yes     yes           Std       5 DDK$GETMVAL
 yes     yes           Std       1 DDR$BUMPC_D$
 yes     yes           Std       0 DDS$SET_Q2D
         yes           Std       1 DUQ$WRERRLOG
         yes           Std       2 DDQ$WRITE
         yes           Std       1 DUQ$OCMSG
 yes     yes           Std       7 DDA$DISPADR
 yes     yes           Std       5 DDK$PUTMVAL
 yes     yes           Std       2 DDK$INCR@
         yes           Std       2 DDQ$WRITENU
 yes     yes           Std       5 DUL$GETMVAL
 yes     yes           Std       6 DFK$GETMVAL
 yes     yes           Std       4 DFR$INSTR
 yes     yes           Std       2 DDK$INCR#
 yes     yes           Std       5 DDQ$WRITELM
 yes     yes           Std       1 DDR$INSTR
 yes     yes           Std       6 DDA$DISPFMT
         yes           Std       0 DDE$ERROR
 yes     yes           Std       6 DFK$PUTMVAL
         yes           Std       2 DXQ$WRTPI
 yes     yes           Std       4 DFS$INSTR
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:35   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                             r    S_D_L6_MESSAGE$                       B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:36   


        1        1        /*M*  DDA$MOD  -  DO routine for MODIFY and MACTIVE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F*  NAME: DDA$MOD
       10       10              PURPOSE: Performs the MODIFY  command
       11       11                                                     */
       12       12        DDA$MOD: PROC ALTRET;

     12  1 000000   000000 700200 xent  DDA$MOD      TSX0  ! X66_AUTO_0
         1 000001   000240 000000                    ZERO    160,0

       13       13
       14       14          /* Locals */
       15       15
       16       16    1   DCL ADDRESS SBIN;
       17       17    1   DCL 1 L6_ADDRESS REDEF ADDRESS,
       18       18    1         2 * BIT(16) UNAL,
       19       19    1         2 L4 UBIN(4) UNAL,
       20       20    1         2 R16 UBIN(16) UNAL;
       21       21    1   DCL SEG UBIN;
       22       22    1   DCL DESC# UBIN;
       23       23    1   DCL NOT_IS BIT(1) ALIGNED;
       24       24    1   DCL SIZE UBIN;
       25       25    1   DCL EXPR_OP BIT(1) ALIGNED;
       26       26    1   DCL L6_TEMP1 UBIN;
       27       27    1   DCL 1 L6_TEMP1_WORD REDEF L6_TEMP1,
       28       28    1         2 * UBIN(20) UNAL,
       29       29    1         2 L6WORD UBIN(16) UNAL;
       30       30    1   DCL L6_TEMP2 UBIN;
       31       31    1   DCL 1 L6_TEMP2_WORD REDEF L6_TEMP2,
       32       32    1         2 * UBIN(20) UNAL,
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:37   
       33       33    1         2 L6WORD UBIN(16) UNAL;
       34       34    1   DCL L6_TEMP_VALUE UBIN;
       35       35    1   DCL 1 L6_TEMP_VALUE_WORD REDEF L6_TEMP_VALUE,
       36       36    1         2 * BIT(4) UNAL,
       37       37    1         2 UH UBIN(16) UNAL,
       38       38    1         2 LH UBIN(16) UNAL;
       39       39    1   DCL NODE UBIN;
       40       40    1   DCL MACTIVE BIT(1);
       41       41    1   DCL OLD_NOT_OLD BIT(1);
       42       42    1   DCL I UBIN;
       43       43    1   DCL OFFSET UBIN;
       44       44    1   DCL TADDRESS SBIN;
       45       45    1   DCL VALUE UBIN;
       46       46    1   DCL 1 OVALUE,
       47       47    1         2 SIZE UBIN WORD,
       48       48    1         2 OPS(0:15) UBIN WORD;
       49       49    1   DCL 1 NVALUE,
       50       50    1         2 SIZE UBIN WORD,
       51       51    1         2 OPS(0:15) UBIN WORD;
       52       52    1   DCL 1 EVALUE,
       53       53    1         2 SIZE UBIN WORD,
       54       54    1         2 OPS(0:15) UBIN WORD;
       55       55    1   DCL PLUS BIT(1);
       56       56    1   DCL IS_AUTO BIT(1) ALIGNED;
       57       57    1   DCL FMT UBIN;
       58       58    1   DCL START$ PTR;
       59       59    1   DCL MYBUF CHAR(200) ALIGNED;
       60       60    1   DCL 1 MYBUF_R REDEF MYBUF,
       61       61    1         2 UBIN9 UBIN(9) CALIGNED,
       62       62    1         2 TEXT CHAR(199) CALIGNED;
       63       63    1   DCL CASECODE SBIN;
       64       64    1   DCL TEXT$ PTR;
       65       65    1   DCL NCHARS UBIN;
       66       66    1   DCL TEXTR CHAR(NCHARS) BASED;
       67       67    1   DCL DO$ PTR;
       68       68    1   DCL SUPADR BIT(1);
       69       69    1   DCL NMSLASH BIT(1);
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:38   
       70       70    1   DCL SETNA$ BIT(1);
       71       71    1   DCL TSIZE UBIN;
       72       72    1   DCL TEMP SBIN;
       73       73    1   DCL CHAR1 CHAR(1) BASED;
       74       74    1   DCL CHAR2 CHAR(2) BASED;
       75       75    1   DCL LVALUE UBIN;
       76       76    1   DCL 1 LINSTR REDEF LVALUE,
       77       77    1         2 PADD,
       78       78    1           3 PNTR UBIN(3) UNAL,
       79       79    1           3 OFFSET SBIN(15) UNAL,
       80       80    1         2 ADDRESS REDEF PADD UBIN(18) UNAL,
       81       81    1         2 * UBIN(11) UNAL,
       82       82    1         2 BIT29 BIT(1) UNAL,
       83       83    1         2 TAG UBIN(6) UNAL;
       84       84    1   DCL 1 LAR REDEF LVALUE,
       85       85    1         2 OFFSET UBIN(18) UNAL,
       86       86    1         2 PLUS UBIN(6) UNAL,
       87       87    1         2 SEG UBIN(2) UNAL,
       88       88    1         2 DESC# UBIN(10) UNAL;
       89       89    1   DCL 1 LRELVAL REDEF LVALUE,
       90       90    1         2 LH UBIN(18) UNAL,
       91       91    1         2 RH UBIN(18) UNAL;
       92       92    1   DCL SAVE_DOMAIN BIT(1) ALIGNED;
       93       93    1   DCL SAVE_EXEC_DOMAIN UBIN;
       94       94    1   DCL BIT36 BIT(36) ALIGNED BASED;
       95       95    1   DCL 1 PR,
       96       96    1         2 AR,
       97       97    1           3 W UBIN(18) UNAL,
       98       98    1           3 * BIT(6) UNAL,
       99       99    1         2 SD,
      100      100    1           3 S UBIN(2) UNAL,
      101      101    1           3 D UBIN(10) UNAL;
      102      102
      103      103          /* Misc */
      104      104
      105      105        %INCLUDE DD$DITEM;
       12+     208             %LIST;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:39   
       13+     209    1        DCL SDD$ PTR;
       14+     210    1        DCL ZITEM$ PTR;
       15+     211    1        DCL SDD_L6$ PTR;
       16+     212    1        DCL ZITEM_L6$ PTR;
      106      786        %ZITEM;
      107      858        %INCLUDE DD$BASED;
      108     2161        %MODIFY$CMD(NAME=MOD$CMD,STCLASS="BASED(DO$)");
      109     2177        %MACTIVE$CMD(NAME=MACT$CMD,STCLASS="BASED(DO$)");
      110     2196        %INCLUDE DD_ERR_C;
      111     2593        %INCLUDE DD_SUBS_C;
      112     2864             %INCLUDE XUH_MACRO_C;
      113     2948             %INCLUDE DD_SD_M;
      114     4284             %S_D;
      115     5602             %S_D_PTRS;
      116     5639        %INCLUDE DD_PSUBS_C;
      117     6114        %INCLUDE OC_SUBS_C;
      118     6845        %INCLUDE B$OBJECT_C;
      119    10275        %B$RECORDSUBS;
      120    10303        %INCLUDE GM_VIRTUAL_E;
      121    10513        %INCLUDE GD$MSG_M;
      122    10677        %GD$MSG(FPTN=GD$MSG,STCLASS="BASED(S_D_L6_MESSAGE$)",L6=YES,L6PTR="UBIN(32) UNAL");
      123    10833
      124    10834          /* External routines */
      125    10835
      126    10836    1   DCL DDK$EVAL ENTRY(6) ALTRET;
      127    10837    1   DCL DFK$EVAL ENTRY(8) ALTRET;
      128    10838    1   DCL DFK$GETMVAL ENTRY(6) ALTRET;
      129    10839    1   DCL DFK$PUTMVAL ENTRY(6) ALTRET;
      130    10840    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      131    10841    1   DCL DDK$PUTMVAL ENTRY(5) ALTRET;
      132    10842    1   DCL DUU$GETMVAL ENTRY(6) ALTRET;
      133    10843    1   DCL DUU$PUTMVAL ENTRY(6) ALTRET;
      134    10844    1   DCL DUL$GETMVAL ENTRY(5) ALTRET;
      135    10845    1   DCL DDQ$WRITELM ENTRY(5) ALTRET;
      136    10846    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      137    10847    1   DCL DUQ$OCMSG ENTRY(1);
      138    10848    1   DCL DUQ$WRERRLOG ENTRY(1);
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:40   
      139    10849    1   DCL DDK$INCR@ ENTRY(2) ALTRET;
      140    10850    1   DCL DDK$INCR# ENTRY(2) ALTRET;
      141    10851    1   DCL DDE$ERROR ENTRY;
      142    10852    1   DCL DDA$DISPADR ENTRY(7) ALTRET;
      143    10853    1   DCL DDA$DISPFMT ENTRY(6) ALTRET;
      144    10854    1   DCL DDR$BUMPC_D$ ENTRY(1) ALTRET;
      145    10855    1   DCL DDQ$WRITE ENTRY(2);
      146    10856    1   DCL DDQ$WRITENU ENTRY(2);
      147    10857    1   DCL DDR$INSTR ENTRY(1) ALTRET;
      148    10858    1   DCL DDS$SET_Q2D ENTRY ALTRET;
      149    10859    1   DCL DXQ$WRTPI ENTRY(2);
      150    10860    1   DCL DFS$INSTR ENTRY(4) ALTRET;
      151    10861    1   DCL DFR$INSTR ENTRY(4) ALTRET;
      152    10862    1        S_D.L$.VALUE = OVALUE.OPS;

  10862  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   000100 100500                    MLR     fill='000'O
         1 000004   200024 000100                    ADSC9   OVALUE+1,,AUTO           cn=0,n=64
         1 000005   000106 000100                    ADSC9   70,,PR0                  cn=0,n=64

      153    10863                                                /**/
      154    10864    1        S_D.GOT$L = '0'B;

  10864  1 000006   006723 450100                    STZ     3539,,PR0

      155    10865    1        S_D.EIS = '0'B;

  10865  1 000007   006740 450100                    STZ     3552,,PR0

      156    10866    1        SUPADR = '0'B;

  10866  1 000010   200200 450100                    STZ     SUPADR,,AUTO

      157    10867    1        NMSLASH = '0'B;

  10867  1 000011   200201 450100                    STZ     NMSLASH,,AUTO

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:41   
      158    10868    1        SAVE_DOMAIN = '0'B;

  10868  1 000012   200206 450100                    STZ     SAVE_DOMAIN,,AUTO

      159    10869    1        SETNA$ = '0'B;

  10869  1 000013   200202 450100                    STZ     SETNA$,,AUTO

      160    10870    1        DO$ = S_D.DO$;

  10870  1 000014   000031 236100                    LDQ     25,,PR0
         1 000015   200177 756100                    STQ     DO$,,AUTO

      161    10871    1        S_D.DESC$ = S_D.D$;

  10871  1 000016   000044 236100                    LDQ     36,,PR0
         1 000017   000041 756100                    STQ     33,,PR0

      162    10872    1        ZITEM$ = S_D.D$;

  10872  1 000020   200212 756100                    STQ     ZITEM$,,AUTO

      163    10873    1        FMT = ZITEM.FMT_SPEC;

  10873  1 000021   200212 471500                    LDP1    ZITEM$,,AUTO
         1 000022   100006 236100                    LDQ     6,,PR1
         1 000023   000011 772000                    QRL     9
         1 000024   000777 376007                    ANQ     511,DL
         1 000025   200110 756100                    STQ     FMT,,AUTO

      164    10874    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND ZITEM.ADDR_TYPE = %AUTO_ACODE

  10874  1 000026   006714 235100                    LDA     3532,,PR0
         1 000027   000002 115007                    CMPA    2,DL
         1 000030   000040 601000 1                  TNZ     s:10876
         1 000031   100006 236100                    LDQ     6,,PR1
         1 000032   000777 376003                    ANQ     511,DU
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:42   
         1 000033   000001 116003                    CMPQ    1,DU
         1 000034   000040 601000 1                  TNZ     s:10876

      165    10875    1        THEN IS_AUTO = '1'B;

  10875  1 000035   400000 236003                    LDQ     -131072,DU
         1 000036   200107 756100                    STQ     IS_AUTO,,AUTO
         1 000037   000041 710000 1                  TRA     s:10877

      166    10876    1        ELSE IS_AUTO = '0'B;

  10876  1 000040   200107 450100                    STZ     IS_AUTO,,AUTO

      167    10877    1        IF FMT = %L$_FMT

  10877  1 000041   200110 236100                    LDQ     FMT,,AUTO
         1 000042   000017 116007                    CMPQ    15,DL
         1 000043   000046 601000 1                  TNZ     s:10879

      168    10878    1        THEN FMT = S_D.L$.FMT;

  10878  1 000044   000127 235100                    LDA     87,,PR0
         1 000045   200110 755100                    STA     FMT,,AUTO

      169    10879    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST OR S_D.RUM OR

  10879  1 000046   006714 235100                    LDA     3532,,PR0
         1 000047   000001 115007                    CMPA    1,DL
         1 000050   000114 600000 1                  TZE     s:10894
         1 000051   004755 234100                    SZN     2541,,PR0
         1 000052   000114 604000 1                  TMI     s:10894
         1 000053   100006 236100                    LDQ     6,,PR1
         1 000054   000777 376003                    ANQ     511,DU
         1 000055   000101 116003                    CMPQ    65,DU
         1 000056   000131 601000 1                  TNZ     s:10895
         1 000057   100007 236100                    LDQ     7,,PR1
         1 000060   777000 316003                    CANQ    -512,DU
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:43   
         1 000061   000114 600000 1                  TZE     s:10894
         1 000062   100007 236100                    LDQ     7,,PR1
         1 000063   777000 376003                    ANQ     -512,DU
         1 000064   001000 116003                    CMPQ    512,DU
         1 000065   000114 600000 1                  TZE     s:10894
         1 000066   002000 116003                    CMPQ    1024,DU
         1 000067   000114 600000 1                  TZE     s:10894
         1 000070   040000 116003                    CMPQ    16384,DU
         1 000071   000114 600000 1                  TZE     s:10894
         1 000072   041000 116003                    CMPQ    16896,DU
         1 000073   000114 600000 1                  TZE     s:10894
         1 000074   042000 116003                    CMPQ    17408,DU
         1 000075   000114 600000 1                  TZE     s:10894
         1 000076   043000 116003                    CMPQ    17920,DU
         1 000077   000114 600000 1                  TZE     s:10894
         1 000100   036000 116003                    CMPQ    15360,DU
         1 000101   000114 600000 1                  TZE     s:10894
         1 000102   037000 116003                    CMPQ    15872,DU
         1 000103   000114 600000 1                  TZE     s:10894
         1 000104   016000 116003                    CMPQ    7168,DU
         1 000105   000114 600000 1                  TZE     s:10894
         1 000106   060000 116003                    CMPQ    24576,DU
         1 000107   000114 600000 1                  TZE     s:10894
         1 000110   030000 116003                    CMPQ    12288,DU
         1 000111   000114 600000 1                  TZE     s:10894
         1 000112   027000 116003                    CMPQ    11776,DU
         1 000113   000131 601000 1                  TNZ     s:10895

      170    10880    1          (ZITEM.ADDR_TYPE = %SPEC_ACODE AND
      171    10881    1          (ZITEM.SP.VS.ID = %O_RTN OR
      172    10882    1          ZITEM.SP.VS.ID = %I_RTN OR
      173    10883    1          ZITEM.SP.VS.ID = %L_RTN OR
      174    10884    1          ZITEM.SP.VS.ID = %@_RTN OR
      175    10885    1          ZITEM.SP.VS.ID = %@@_RTN OR
      176    10886    1          ZITEM.SP.VS.ID = %#_RTN OR
      177    10887    1          ZITEM.SP.VS.ID = %##_RTN OR
      178    10888    1          ZITEM.SP.VS.ID = %RI_RTN OR
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:44   
      179    10889    1          ZITEM.SP.VS.ID = %NA_RTN OR
      180    10890    1          ZITEM.SP.VS.ID = %IC_RTN OR
      181    10891    1          ZITEM.SP.VS.ID = %N_RTN OR
      182    10892    1          ZITEM.SP.VS.ID = %FMASK_RTN OR
      183    10893    1          ZITEM.SP.VS.ID = %FRANGE_RTN))
      184    10894    1        THEN CALL DDK$EVAL(ADDRESS, SEG, DESC#, NOT_IS) ALTRET(MERR);

  10894  1 000114   200006 633500                    EPPR3   NOT_IS,,AUTO
         1 000115   200233 453500                    STP3    DUM2+4,,AUTO
         1 000116   200005 634500                    EPPR4   DESC#,,AUTO
         1 000117   200232 454500                    STP4    DUM2+3,,AUTO
         1 000120   200004 635500                    EPPR5   SEG,,AUTO
         1 000121   200231 455500                    STP5    DUM2+2,,AUTO
         1 000122   200003 636500                    EPPR6   ADDRESS,,AUTO
         1 000123   200230 456500                    STP6    DUM2+1,,AUTO
         1 000124   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000125   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000126   000000 701000 xent               TSX1    DDK$EVAL
         1 000127   004232 702000 1                  TSX2    MERR
         1 000130   000160 710000 1                  TRA     s:10901

      185    10895    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  10895  1 000131   000002 115007                    CMPA    2,DL
         1 000132   004207 601000 1                  TNZ     MERR1

      186    10896    2             THEN DO;

      187    10897    2                  CALL DFK$EVAL(OVALUE, ADDRESS, SEG, DESC#, NOT_IS, SIZE, EXPR_OP,
             10897                           '1'B) ALTRET(MERR);

  10897  1 000133   000000 236000 2                  LDQ     0
         1 000134   200237 756100                    STQ     DUM2+8,,AUTO
         1 000135   200010 633500                    EPPR3   EXPR_OP,,AUTO
         1 000136   200236 453500                    STP3    DUM2+7,,AUTO
         1 000137   200007 634500                    EPPR4   SIZE,,AUTO
         1 000140   200235 454500                    STP4    DUM2+6,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:45   
         1 000141   200006 635500                    EPPR5   NOT_IS,,AUTO
         1 000142   200234 455500                    STP5    DUM2+5,,AUTO
         1 000143   200005 636500                    EPPR6   DESC#,,AUTO
         1 000144   200233 456500                    STP6    DUM2+4,,AUTO
         1 000145   200004 637500                    EPPR7   SEG,,AUTO
         1 000146   200232 457500                    STP7    DUM2+3,,AUTO
         1 000147   200003 630500                    EPPR0   ADDRESS,,AUTO
         1 000150   200231 450500                    STP0    DUM2+2,,AUTO
         1 000151   200023 630500                    EPPR0   OVALUE,,AUTO
         1 000152   200230 450500                    STP0    DUM2+1,,AUTO
         1 000153   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000154   000026 631400 xsym               EPPR1   B_VECTNIL+22
         1 000155   000000 701000 xent               TSX1    DFK$EVAL
         1 000156   004232 702000 1                  TSX2    MERR

      188    10898    2                  GOTO GOTIT;

  10898  1 000157   000340 710000 1                  TRA     GOTIT

      189    10899    2                END;
      190    10900    1             ELSE GOTO MERR1;
      191    10901    1        IF S_D.RUM

  10901  1 000160   000000 470400 xsym               LDP0    S_D$
         1 000161   004755 234100                    SZN     2541,,PR0
         1 000162   000236 605000 1                  TPL     s:10917

      192    10902    2        THEN DO;

      193    10903    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND

  10903  1 000163   006714 235100                    LDA     3532,,PR0
         1 000164   000002 115007                    CMPA    2,DL
         1 000165   000202 601000 1                  TNZ     s:10911
         1 000166   200004 236100                    LDQ     SEG,,AUTO
         1 000167   000007 116007                    CMPQ    7,DL
         1 000170   000202 601000 1                  TNZ     s:10911
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:46   
         1 000171   200005 235100                    LDA     DESC#,,AUTO
         1 000172   000002 115007                    CMPA    2,DL
         1 000173   000202 601000 1                  TNZ     s:10911

      194    10904    2               SEG = 7 AND
      195    10905    2               DESC# = 2
      196    10906    3             THEN DO;

      197    10907    3                  SAVE_DOMAIN = '1'B;

  10907  1 000174   400000 236003                    LDQ     -131072,DU
         1 000175   200206 756100                    STQ     SAVE_DOMAIN,,AUTO

      198    10908    3                  SAVE_EXEC_DOMAIN = S_D.ONE_TO_TWO.EXEC_DOMAIN;

  10908  1 000176   006714 235100                    LDA     3532,,PR0
         1 000177   200207 755100                    STA     SAVE_EXEC_DOMAIN,,AUTO

      199    10909    3                  S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST;

  10909  1 000200   000001 235007                    LDA     1,DL
         1 000201   006714 755100                    STA     3532,,PR0

      200    10910    3                END;

      201    10911    2             NODE = 0;

  10911  1 000202   200014 450100                    STZ     NODE,,AUTO

      202    10912    2             IF S_D.OVERLAID

  10912  1 000203   004764 234100                    SZN     2548,,PR0
         1 000204   000215 605000 1                  TPL     s:10914

      203    10913    2             THEN CALL DDS$IC2NODE( ADDRESS, NODE ) ALTRET( MERR );

  10913  1 000205   200014 631500                    EPPR1   NODE,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:47   
         1 000206   200231 451500                    STP1    DUM2+2,,AUTO
         1 000207   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 000210   200230 453500                    STP3    DUM2+1,,AUTO
         1 000211   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000212   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000213   000000 701000 xent               TSX1    DDS$IC2NODE
         1 000214   004232 702000 1                  TSX2    MERR

      204    10914    2             CALL DUU$GETMVAL(OVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(MERR);

  10914  1 000215   200006 630500                    EPPR0   NOT_IS,,AUTO
         1 000216   200235 450500                    STP0    DUM2+6,,AUTO
         1 000217   200005 631500                    EPPR1   DESC#,,AUTO
         1 000220   200234 451500                    STP1    DUM2+5,,AUTO
         1 000221   200004 633500                    EPPR3   SEG,,AUTO
         1 000222   200233 453500                    STP3    DUM2+4,,AUTO
         1 000223   200003 634500                    EPPR4   ADDRESS,,AUTO
         1 000224   200232 454500                    STP4    DUM2+3,,AUTO
         1 000225   200014 635500                    EPPR5   NODE,,AUTO
         1 000226   200231 455500                    STP5    DUM2+2,,AUTO
         1 000227   200023 636500                    EPPR6   OVALUE,,AUTO
         1 000230   200230 456500                    STP6    DUM2+1,,AUTO
         1 000231   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000232   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000233   000000 701000 xent               TSX1    DUU$GETMVAL
         1 000234   004232 702000 1                  TSX2    MERR

      205    10915    2           END;

  10915  1 000235   000340 710000 1                  TRA     GOTIT

      206    10916    2        ELSE DO;

      207    10917    2             OVALUE.SIZE = 1;

  10917  1 000236   000001 235007                    LDA     1,DL
         1 000237   200023 755100                    STA     OVALUE,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:48   

      208    10918    2             IF S_D.ANLZ_FILE

  10918  1 000240   005052 234100                    SZN     2602,,PR0
         1 000241   000261 605000 1                  TPL     s:10920

      209    10919    2             THEN CALL DUL$GETMVAL(OVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
             10919                      MERR);

  10919  1 000242   200006 631500                    EPPR1   NOT_IS,,AUTO
         1 000243   200234 451500                    STP1    DUM2+5,,AUTO
         1 000244   200005 633500                    EPPR3   DESC#,,AUTO
         1 000245   200233 453500                    STP3    DUM2+4,,AUTO
         1 000246   200004 634500                    EPPR4   SEG,,AUTO
         1 000247   200232 454500                    STP4    DUM2+3,,AUTO
         1 000250   200003 635500                    EPPR5   ADDRESS,,AUTO
         1 000251   200231 455500                    STP5    DUM2+2,,AUTO
         1 000252   200024 636500                    EPPR6   OVALUE+1,,AUTO
         1 000253   200230 456500                    STP6    DUM2+1,,AUTO
         1 000254   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000255   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000256   000000 701000 xent               TSX1    DUL$GETMVAL
         1 000257   004232 702000 1                  TSX2    MERR
         1 000260   000340 710000 1                  TRA     GOTIT

      210    10920    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST OR

  10920  1 000261   006714 235100                    LDA     3532,,PR0
         1 000262   000001 115007                    CMPA    1,DL
         1 000263   000301 600000 1                  TZE     s:10925
         1 000264   200212 471500                    LDP1    ZITEM$,,AUTO
         1 000265   100006 236100                    LDQ     6,,PR1
         1 000266   000777 376003                    ANQ     511,DU
         1 000267   000101 116003                    CMPQ    65,DU
         1 000270   000320 601000 1                  TNZ     s:10926
         1 000271   100007 236100                    LDQ     7,,PR1
         1 000272   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:49   
         1 000273   030000 116003                    CMPQ    12288,DU
         1 000274   000301 600000 1                  TZE     s:10925
         1 000275   027000 116003                    CMPQ    11776,DU
         1 000276   000301 600000 1                  TZE     s:10925
         1 000277   036000 116003                    CMPQ    15360,DU
         1 000300   000320 601000 1                  TNZ     s:10926

      211    10921    2                    (ZITEM.ADDR_TYPE = %SPEC_ACODE AND
      212    10922    2                    (ZITEM.SP.VS.ID = %FMASK_RTN OR
      213    10923    2                    ZITEM.SP.VS.ID = %FRANGE_RTN OR
      214    10924    2                    ZITEM.SP.VS.ID = %RI_RTN))
      215    10925    2                  THEN CALL DDK$GETMVAL(OVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS)
             10925                           ALTRET(MERR);

  10925  1 000301   200006 631500                    EPPR1   NOT_IS,,AUTO
         1 000302   200234 451500                    STP1    DUM2+5,,AUTO
         1 000303   200005 633500                    EPPR3   DESC#,,AUTO
         1 000304   200233 453500                    STP3    DUM2+4,,AUTO
         1 000305   200004 634500                    EPPR4   SEG,,AUTO
         1 000306   200232 454500                    STP4    DUM2+3,,AUTO
         1 000307   200003 635500                    EPPR5   ADDRESS,,AUTO
         1 000310   200231 455500                    STP5    DUM2+2,,AUTO
         1 000311   200024 636500                    EPPR6   OVALUE+1,,AUTO
         1 000312   200230 456500                    STP6    DUM2+1,,AUTO
         1 000313   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000314   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000315   000000 701000 xent               TSX1    DDK$GETMVAL
         1 000316   004232 702000 1                  TSX2    MERR
         1 000317   000340 710000 1                  TRA     GOTIT

      216    10926    2                  ELSE CALL DFK$GETMVAL(OVALUE, ADDRESS, SEG, DESC#, NOT_IS, '1'B)
             10926                           ALTRET(MERR);

  10926  1 000320   000000 236000 2                  LDQ     0
         1 000321   200235 756100                    STQ     DUM2+6,,AUTO
         1 000322   200006 633500                    EPPR3   NOT_IS,,AUTO
         1 000323   200234 453500                    STP3    DUM2+5,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:50   
         1 000324   200005 634500                    EPPR4   DESC#,,AUTO
         1 000325   200233 454500                    STP4    DUM2+4,,AUTO
         1 000326   200004 635500                    EPPR5   SEG,,AUTO
         1 000327   200232 455500                    STP5    DUM2+3,,AUTO
         1 000330   200003 636500                    EPPR6   ADDRESS,,AUTO
         1 000331   200231 456500                    STP6    DUM2+2,,AUTO
         1 000332   200023 637500                    EPPR7   OVALUE,,AUTO
         1 000333   200230 457500                    STP7    DUM2+1,,AUTO
         1 000334   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000335   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000336   000000 701000 xent               TSX1    DFK$GETMVAL
         1 000337   004232 702000 1                  TSX2    MERR

      217    10927    2           END;

  10926  1 000340                       GOTIT        null
      218    10928
      219    10929    1   GOTIT: ;
      220    10930    1        S_D.L$.VALUE = OVALUE.OPS;

  10930  1 000340   000000 470400 xsym               LDP0    S_D$
         1 000341   000100 100500                    MLR     fill='000'O
         1 000342   200024 000100                    ADSC9   OVALUE+1,,AUTO           cn=0,n=64
         1 000343   000106 000100                    ADSC9   70,,PR0                  cn=0,n=64

      221    10931    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  10931  1 000344   006714 235100                    LDA     3532,,PR0
         1 000345   000001 115007                    CMPA    1,DL
         1 000346   000352 601000 1                  TNZ     s:10933

      222    10932    1        THEN S_D.L$.SIZE = 36;

  10932  1 000347   000044 236007                    LDQ     36,DL
         1 000350   000126 756100                    STQ     86,,PR0
         1 000351   000360 710000 1                  TRA     s:10936

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:51   
      223    10933    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  10933  1 000352   000002 115007                    CMPA    2,DL
         1 000353   004207 601000 1                  TNZ     MERR1

      224    10934    1             THEN S_D.L$.SIZE = OVALUE.SIZE * 16;

  10934  1 000354   200023 236100                    LDQ     OVALUE,,AUTO
         1 000355   000004 736000                    QLS     4
         1 000356   000126 756100                    STQ     86,,PR0
         1 000357   000360 710000 1                  TRA     s:10936

      225    10935    1             ELSE GOTO MERR1;
      226    10936    1        S_D.O$.ADDRESS = ADDRESS;

  10936  1 000360   200003 235100                    LDA     ADDRESS,,AUTO
         1 000361   000132 755100                    STA     90,,PR0

      227    10937    1        S_D.O$.SEG = SEG;

  10937  1 000362   200004 235100                    LDA     SEG,,AUTO
         1 000363   000130 755100                    STA     88,,PR0

      228    10938    1        S_D.O$.DESC# = DESC#;

  10938  1 000364   200005 235100                    LDA     DESC#,,AUTO
         1 000365   000131 755100                    STA     89,,PR0

      229    10939    1        S_D.O$.NOT_IS = NOT_IS;

  10939  1 000366   003100 060500                    CSL     bolr='003'O
         1 000367   200006 000001                    BDSC    NOT_IS,,AUTO             by=0,bit=0,n=1
         1 000370   200230 000044                    BDSC    DUM2+1,,AUTO             by=0,bit=0,n=36
         1 000371   200230 220100                    LDX0    DUM2+1,,AUTO
         1 000372   000133 740100                    STX0    91,,PR0

      230    10940    1        IF MOD$CMD.DW OR S_D.L$.SIZE = 32
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:52   

  10940  1 000373   200177 471500                    LDP1    DO$,,AUTO
         1 000374   100001 430100                    FSZN    1,,PR1
         1 000375   000401 604000 1                  TMI     s:10941
         1 000376   000126 235100                    LDA     86,,PR0
         1 000377   000040 115007                    CMPA    32,DL
         1 000400   000404 601000 1                  TNZ     s:10942

      231    10941    1        THEN S_D.MDW = '1'B;

  10941  1 000401   400000 236003                    LDQ     -131072,DU
         1 000402   006724 756100                    STQ     3540,,PR0
         1 000403   000405 710000 1                  TRA     s:10944

      232    10942    1        ELSE S_D.MDW = '0'B;

  10942  1 000404   006724 450100                    STZ     3540,,PR0

      233    10943
      234    10944    1        IF MOD$CMD.DDESC(0)

  10944  1 000405   100001 234100                    SZN     1,,PR1
         1 000406   001141 605000 1                  TPL     s:11053

      235    10945    2        THEN DO;            /* New value specified - non-interactive command */

      236    10946    2             MACTIVE = '0'B;

  10946  1 000407   200015 450100                    STZ     MACTIVE,,AUTO

      237    10947    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  10947  1 000410   006714 235100                    LDA     3532,,PR0
         1 000411   000001 115007                    CMPA    1,DL
         1 000412   000431 601000 1                  TNZ     s:10950

      238    10948    2             THEN CALL IORVALUE(NVALUE,MOD$CMD.INSTR(0),MOD$CMD.IGNPR(0),
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:53   

  10948  1 000413   200177 236100                    LDQ     DO$,,AUTO
         1 000414   000001 036000 2                  ADLQ    1
         1 000415   200222 756100                    STQ     @MOD_LOC+1,,AUTO
         1 000416   200177 236100                    LDQ     DO$,,AUTO
         1 000417   000002 036000 2                  ADLQ    2
         1 000420   200221 756100                    STQ     @IFLAG+1,,AUTO
         1 000421   200177 236100                    LDQ     DO$,,AUTO
         1 000422   000003 036000 2                  ADLQ    3
         1 000423   200220 756100                    STQ     @RVALUE+1,,AUTO
         1 000424   200044 633500                    EPPR3   NVALUE,,AUTO
         1 000425   200217 453500                    STP3    ZITEM$+5,,AUTO
         1 000426   004240 701000 1                  TSX1    IORVALUE
         1 000427   004232 702000 1                  TSX2    MERR
         1 000430   000445 710000 1                  TRA     s:10953

      239    10949    2                    MOD$CMD.AWDX(0))ALTRET(MERR);
      240    10950    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  10950  1 000431   000002 115007                    CMPA    2,DL
         1 000432   004207 601000 1                  TNZ     MERR1

      241    10951    2                  THEN CALL L6_IORVALUE(NVALUE,MOD$CMD.INSTR(0),ADDRESS)ALTRET(MERR);

  10951  1 000433   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 000434   200221 453500                    STP3    @IFLAG+1,,AUTO
         1 000435   200177 236100                    LDQ     DO$,,AUTO
         1 000436   000003 036000 2                  ADLQ    3
         1 000437   200220 756100                    STQ     @RVALUE+1,,AUTO
         1 000440   200044 634500                    EPPR4   NVALUE,,AUTO
         1 000441   200217 454500                    STP4    ZITEM$+5,,AUTO
         1 000442   004346 701000 1                  TSX1    L6_IORVALUE
         1 000443   004232 702000 1                  TSX2    MERR
         1 000444   000445 710000 1                  TRA     s:10953

      242    10952    2                  ELSE GOTO MERR1;
      243    10953    2             IF MOD$CMD.DDESC(1)
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:54   

  10953  1 000445   200177 470500                    LDP0    DO$,,AUTO
         1 000446   000001 236100                    LDQ     1,,PR0
         1 000447   200000 316003                    CANQ    65536,DU
         1 000450   000736 600000 1                  TZE     s:11013

      244    10954    3             THEN DO;                      /* Expected old value specified */

      245    10955    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  10955  1 000451   000000 471400 xsym               LDP1    S_D$
         1 000452   106714 235100                    LDA     3532,,PR1
         1 000453   000001 115007                    CMPA    1,DL
         1 000454   000473 601000 1                  TNZ     s:10958

      246    10956    3                  THEN CALL IORVALUE(EVALUE,MOD$CMD.INSTR(1),MOD$CMD.IGNPR(1),

  10956  1 000455   200177 236100                    LDQ     DO$,,AUTO
         1 000456   000004 036000 2                  ADLQ    4
         1 000457   200222 756100                    STQ     @MOD_LOC+1,,AUTO
         1 000460   200177 236100                    LDQ     DO$,,AUTO
         1 000461   000005 036000 2                  ADLQ    5
         1 000462   200221 756100                    STQ     @IFLAG+1,,AUTO
         1 000463   200177 236100                    LDQ     DO$,,AUTO
         1 000464   000006 036000 2                  ADLQ    6
         1 000465   200220 756100                    STQ     @RVALUE+1,,AUTO
         1 000466   200065 633500                    EPPR3   EVALUE,,AUTO
         1 000467   200217 453500                    STP3    ZITEM$+5,,AUTO
         1 000470   004240 701000 1                  TSX1    IORVALUE
         1 000471   004232 702000 1                  TSX2    MERR
         1 000472   000507 710000 1                  TRA     s:10962

      247    10957    3                         MOD$CMD.AWDX(1))ALTRET(MERR);
      248    10958    3                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  10958  1 000473   000002 115007                    CMPA    2,DL
         1 000474   004207 601000 1                  TNZ     MERR1
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:55   

      249    10959    3                       THEN CALL L6_IORVALUE(EVALUE,MOD$CMD.INSTR(1),ADDRESS)

  10959  1 000475   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 000476   200221 453500                    STP3    @IFLAG+1,,AUTO
         1 000477   200177 236100                    LDQ     DO$,,AUTO
         1 000500   000006 036000 2                  ADLQ    6
         1 000501   200220 756100                    STQ     @RVALUE+1,,AUTO
         1 000502   200065 634500                    EPPR4   EVALUE,,AUTO
         1 000503   200217 454500                    STP4    ZITEM$+5,,AUTO
         1 000504   004346 701000 1                  TSX1    L6_IORVALUE
         1 000505   004232 702000 1                  TSX2    MERR
         1 000506   000507 710000 1                  TRA     s:10962

      250    10960    3                              ALTRET(MERR);
      251    10961    3                       ELSE GOTO MERR1;
      252    10962    3                  OLD_NOT_OLD = '0'B;

  10962  1 000507   200016 450100                    STZ     OLD_NOT_OLD,,AUTO

      253    10963    4                  DO I = 0 TO EVALUE.SIZE -1;

  10963  1 000510   200017 450100                    STZ     I,,AUTO
         1 000511   000523 710000 1                  TRA     s:10966+3

      254    10964    4                       IF EVALUE.OPS(I) ~= OVALUE.OPS(I)

  10964  1 000512   200017 720100                    LXL0    I,,AUTO
         1 000513   200066 236110                    LDQ     EVALUE+1,X0,AUTO
         1 000514   200024 116110                    CMPQ    OVALUE+1,X0,AUTO
         1 000515   000520 600000 1                  TZE     s:10966

      255    10965    4                       THEN OLD_NOT_OLD = '1'B;

  10965  1 000516   400000 236003                    LDQ     -131072,DU
         1 000517   200016 756100                    STQ     OLD_NOT_OLD,,AUTO

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:56   
      256    10966    4                     END;

  10966  1 000520   200017 235100                    LDA     I,,AUTO
         1 000521   000001 035007                    ADLA    1,DL
         1 000522   200017 755100                    STA     I,,AUTO
         1 000523   200017 236100                    LDQ     I,,AUTO
         1 000524   200065 116100                    CMPQ    EVALUE,,AUTO
         1 000525   000512 602000 1                  TNC     s:10964

      257    10967    3                  IF OLD_NOT_OLD

  10967  1 000526   200016 234100                    SZN     OLD_NOT_OLD,,AUTO
         1 000527   000715 605000 1                  TPL     s:11004

      258    10968    4                  THEN DO;                 /* Previous ~= expected -> error */

      259    10969    4                       S_D.ERROR = 82; /* E@OLDNOTOLD */

  10969  1 000530   000122 235007                    LDA     82,DL
         1 000531   000000 470400 xsym               LDP0    S_D$
         1 000532   000013 755100                    STA     11,,PR0

      260    10970    4                       START$ = PINCRC(ADDR(MYBUF), 1);

  10970  1 000533   200230 452500                    STP2    DUM2+1,,AUTO
         1 000534   200230 236100                    LDQ     DUM2+1,,AUTO
         1 000535   000007 036000 2                  ADLQ    7
         1 000536   200111 756100                    STQ     START$,,AUTO

      261    10971    4                       S_D.D$ = START$;

  10971  1 000537   000044 756100                    STQ     36,,PR0

      262    10972    4                       S_D.DESCL$ = PINCRC(S_D.D$, SIZEC(MYBUF) - 1);

  10972  1 000540   000010 036000 2                  ADLQ    8
         1 000541   000042 756100                    STQ     34,,PR0
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:57   

      263    10973    4                       IF MOD$CMD.INSTR(1)

  10973  1 000542   200177 471500                    LDP1    DO$,,AUTO
         1 000543   100001 236100                    LDQ     1,,PR1
         1 000544   040000 316003                    CANQ    16384,DU
         1 000545   000575 600000 1                  TZE     s:10979

      264    10974    4                       THEN IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  10974  1 000546   006714 235100                    LDA     3532,,PR0
         1 000547   000001 115007                    CMPA    1,DL
         1 000550   000560 601000 1                  TNZ     s:10976

      265    10975    4                            THEN CALL DDR$INSTR(EVALUE.OPS(0))ALTRET(MERR);

  10975  1 000551   200066 633500                    EPPR3   EVALUE+1,,AUTO
         1 000552   200230 453500                    STP3    DUM2+1,,AUTO
         1 000553   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000554   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000555   000000 701000 xent               TSX1    DDR$INSTR
         1 000556   004232 702000 1                  TSX2    MERR
         1 000557   000637 710000 1                  TRA     s:10988

      266    10976    4                            ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  10976  1 000560   000002 115007                    CMPA    2,DL
         1 000561   004207 601000 1                  TNZ     MERR1

      267    10977    4                                 THEN CALL DFR$INSTR(EVALUE.OPS, EVALUE.SIZE, '1'B )
             10977                                          ALTRET(MERR);

  10977  1 000562   000000 236000 2                  LDQ     0
         1 000563   200232 756100                    STQ     DUM2+3,,AUTO
         1 000564   200065 633500                    EPPR3   EVALUE,,AUTO
         1 000565   200231 453500                    STP3    DUM2+2,,AUTO
         1 000566   200066 634500                    EPPR4   EVALUE+1,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:58   
         1 000567   200230 454500                    STP4    DUM2+1,,AUTO
         1 000570   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000571   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000572   000000 701000 xent               TSX1    DFR$INSTR
         1 000573   004232 702000 1                  TSX2    MERR
         1 000574   000637 710000 1                  TRA     s:10988

      268    10978    4                                 ELSE GOTO MERR1;
      269    10979    4                       ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  10979  1 000575   006714 235100                    LDA     3532,,PR0
         1 000576   000001 115007                    CMPA    1,DL
         1 000577   000611 601000 1                  TNZ     s:10981

      270    10980    4                            THEN CALL DDA$DISPFMT(%OCT_FMT,36,EVALUE.OPS)ALTRET(MERR);

  10980  1 000600   200066 633500                    EPPR3   EVALUE+1,,AUTO
         1 000601   200232 453500                    STP3    DUM2+3,,AUTO
         1 000602   000012 237000 2                  LDAQ    10
         1 000603   200230 757100                    STAQ    DUM2+1,,AUTO
         1 000604   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000605   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000606   000000 701000 xent               TSX1    DDA$DISPFMT
         1 000607   004232 702000 1                  TSX2    MERR
         1 000610   000637 710000 1                  TRA     s:10988

      271    10981    4                            ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  10981  1 000611   000002 115007                    CMPA    2,DL
         1 000612   004207 601000 1                  TNZ     MERR1

      272    10982    5                                 THEN DO;

      273    10983    5                                      IF S_D.MDW

  10983  1 000613   006724 234100                    SZN     3540,,PR0
         1 000614   000626 605000 1                  TPL     s:10985
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:59   

      274    10984    5                                      THEN CALL DDA$DISPFMT(%X_FMT,32,EVALUE.OPS)
             10984                                               ALTRET(MERR);

  10984  1 000615   200066 633500                    EPPR3   EVALUE+1,,AUTO
         1 000616   200232 453500                    STP3    DUM2+3,,AUTO
         1 000617   000016 237000 2                  LDAQ    14
         1 000620   200230 757100                    STAQ    DUM2+1,,AUTO
         1 000621   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000622   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000623   000000 701000 xent               TSX1    DDA$DISPFMT
         1 000624   004232 702000 1                  TSX2    MERR
         1 000625   000637 710000 1                  TRA     s:10988

      275    10985    5                                      ELSE CALL DDA$DISPFMT(%X_FMT,16,EVALUE.OPS)
             10985                                               ALTRET(MERR);

  10985  1 000626   200066 633500                    EPPR3   EVALUE+1,,AUTO
         1 000627   200232 453500                    STP3    DUM2+3,,AUTO
         1 000630   000022 237000 2                  LDAQ    18
         1 000631   200230 757100                    STAQ    DUM2+1,,AUTO
         1 000632   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000633   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000634   000000 701000 xent               TSX1    DDA$DISPFMT
         1 000635   004232 702000 1                  TSX2    MERR

      276    10986    5                                    END;

  10986  1 000636   000637 710000 1                  TRA     s:10988

      277    10987    4                                 ELSE GOTO MERR1;
      278    10988    4                       MYBUF_R.UBIN9 = POFFC(S_D.D$, START$);

  10988  1 000637   200111 236100                    LDQ     START$,,AUTO
         1 000640   000020 772000                    QRL     16
         1 000641   200230 756100                    STQ     DUM2+1,,AUTO
         1 000642   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:60   
         1 000643   000044 236100                    LDQ     36,,PR0
         1 000644   000020 772000                    QRL     16
         1 000645   200230 136100                    SBLQ    DUM2+1,,AUTO
         1 000646   000033 736000                    QLS     27
         1 000647   200112 552140                    STBQ    MYBUF,'40'O,AUTO

      279    10989    4                       IF MYBUF_R.UBIN9 <= 31

  10989  1 000650   200112 236100                    LDQ     MYBUF,,AUTO
         1 000651   777000 376003                    ANQ     -512,DU
         1 000652   040000 116003                    CMPQ    16384,DU
         1 000653   000662 603000 1                  TRC     s:10995

      280    10990    5                       THEN DO;

      281    10991    5                            S_D.ERROR_SYM$ = ADDR(MYBUF);

  10991  1 000654   200112 631500                    EPPR1   MYBUF,,AUTO
         1 000655   000032 451500                    STP1    26,,PR0

      282    10992    5                            CALL DDE$ERROR;

  10992  1 000656   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000657   000000 701000 xent               TSX1    DDE$ERROR
         1 000660   000000 011000                    NOP     0

      283    10993    5                          END;

  10993  1 000661   000707 710000 1                  TRA     s:11000

      284    10994    5                       ELSE DO;

      285    10995    5                            I = MYBUF_R.UBIN9;

  10995  1 000662   200112 236100                    LDQ     MYBUF,,AUTO
         1 000663   000033 772000                    QRL     27
         1 000664   200017 756100                    STQ     I,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:61   

      286    10996    5                            CALL DDQ$WRITE (ADDR(MYBUF_R.TEXT), I);

  10996  1 000665   200231 452500                    STP2    DUM2+2,,AUTO
         1 000666   200231 236100                    LDQ     DUM2+2,,AUTO
         1 000667   000007 036000 2                  ADLQ    7
         1 000670   200230 756100                    STQ     DUM2+1,,AUTO
         1 000671   200017 631500                    EPPR1   I,,AUTO
         1 000672   200233 451500                    STP1    DUM2+4,,AUTO
         1 000673   200230 633500                    EPPR3   DUM2+1,,AUTO
         1 000674   200232 453500                    STP3    DUM2+3,,AUTO
         1 000675   200232 630500                    EPPR0   DUM2+3,,AUTO
         1 000676   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000677   000000 701000 xent               TSX1    DDQ$WRITE
         1 000700   000000 011000                    NOP     0

      287    10997    5                            S_D.ERROR_SYM$ = ADDR (NIL);

  10997  1 000701   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000702   000000 470400 xsym               LDP0    S_D$
         1 000703   000032 756100                    STQ     26,,PR0

      288    10998    5                            CALL DDE$ERROR;

  10998  1 000704   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000705   000000 701000 xent               TSX1    DDE$ERROR
         1 000706   000000 011000                    NOP     0

      289    10999    5                          END;

      290    11000    4                       NVALUE = OVALUE;

  11000  1 000707   000100 100500                    MLR     fill='000'O
         1 000710   200023 000104                    ADSC9   OVALUE,,AUTO             cn=0,n=68
         1 000711   200044 000104                    ADSC9   NVALUE,,AUTO             cn=0,n=68

      291    11001    4                       MACTIVE = '1'B;     /* Go interactive */
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:62   

  11001  1 000712   400000 236003                    LDQ     -131072,DU
         1 000713   200015 756100                    STQ     MACTIVE,,AUTO

      292    11002    4                       GOTO DISPMOD;

  11002  1 000714   003176 710000 1                  TRA     DISPMOD

      293    11003    4                     END;                  /* DO  ( previous ~= expected ) */
      294    11004    3                  IF NVALUE.SIZE ~= EVALUE.SIZE AND

  11004  1 000715   200044 236100                    LDQ     NVALUE,,AUTO
         1 000716   200065 116100                    CMPQ    EVALUE,,AUTO
         1 000717   000736 600000 1                  TZE     s:11013
         1 000720   200177 470500                    LDP0    DO$,,AUTO
         1 000721   000001 236100                    LDQ     1,,PR0
         1 000722   000400 316003                    CANQ    256,DU
         1 000723   000736 601000 1                  TNZ     s:11013
         1 000724   000000 471400 xsym               LDP1    S_D$
         1 000725   106723 234100                    SZN     3539,,PR1
         1 000726   000736 604000 1                  TMI     s:11013

      295    11005    3                    (NOT MOD$CMD.NWARN) AND
      296    11006    3                    (NOT S_D.GOT$L)
      297    11007    4                  THEN DO;       /* Sizes of new and expected values don't match */

      298    11008    4                       S_D.ERROR = 285; /* E@WRONG_SIZE */

  11008  1 000727   000435 235007                    LDA     285,DL
         1 000730   100013 755100                    STA     11,,PR1

      299    11009    4                       S_D.ERROR_SYM$ = ADDR(NIL);

  11009  1 000731   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000732   100032 756100                    STQ     26,,PR1

      300    11010    4                       CALL DDE$ERROR;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:63   

  11010  1 000733   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000734   000000 701000 xent               TSX1    DDE$ERROR
         1 000735   000000 011000                    NOP     0

      301    11011    4                     END;

      302    11012    3                END;                  /* DO  ( expected old value specified ) */

      303    11013    2             IF S_D.RUM

  11013  1 000736   000000 470400 xsym               LDP0    S_D$
         1 000737   004755 234100                    SZN     2541,,PR0
         1 000740   000775 605000 1                  TPL     s:11020

      304    11014    3             THEN DO;

      305    11015    3                  NODE = 0;

  11015  1 000741   200014 450100                    STZ     NODE,,AUTO

      306    11016    3                  IF S_D.OVERLAID

  11016  1 000742   004764 234100                    SZN     2548,,PR0
         1 000743   000754 605000 1                  TPL     s:11018

      307    11017    3                  THEN CALL DDS$IC2NODE( ADDRESS, NODE ) ALTRET( MERR );

  11017  1 000744   200014 631500                    EPPR1   NODE,,AUTO
         1 000745   200231 451500                    STP1    DUM2+2,,AUTO
         1 000746   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 000747   200230 453500                    STP3    DUM2+1,,AUTO
         1 000750   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000751   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000752   000000 701000 xent               TSX1    DDS$IC2NODE
         1 000753   004232 702000 1                  TSX2    MERR

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:64   
      308    11018    3                  CALL DUU$PUTMVAL(NVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
             11018                           MERR);

  11018  1 000754   200006 630500                    EPPR0   NOT_IS,,AUTO
         1 000755   200235 450500                    STP0    DUM2+6,,AUTO
         1 000756   200005 631500                    EPPR1   DESC#,,AUTO
         1 000757   200234 451500                    STP1    DUM2+5,,AUTO
         1 000760   200004 633500                    EPPR3   SEG,,AUTO
         1 000761   200233 453500                    STP3    DUM2+4,,AUTO
         1 000762   200003 634500                    EPPR4   ADDRESS,,AUTO
         1 000763   200232 454500                    STP4    DUM2+3,,AUTO
         1 000764   200014 635500                    EPPR5   NODE,,AUTO
         1 000765   200231 455500                    STP5    DUM2+2,,AUTO
         1 000766   200044 636500                    EPPR6   NVALUE,,AUTO
         1 000767   200230 456500                    STP6    DUM2+1,,AUTO
         1 000770   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 000771   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000772   000000 701000 xent               TSX1    DUU$PUTMVAL
         1 000773   004232 702000 1                  TSX2    MERR

      309    11019    3                END;

  11019  1 000774   001047 710000 1                  TRA     s:11030

      310    11020    2             ELSE IF S_D.ANLZ_FILE

  11020  1 000775   005052 234100                    SZN     2602,,PR0
         1 000776   001002 605000 1                  TPL     s:11025

      311    11021    3                  THEN DO;

      312    11022    3                       S_D.ERROR = 155; /*E@CANTPUTINANLZ*/

  11022  1 000777   000233 235007                    LDA     155,DL
         1 001000   000013 755100                    STA     11,,PR0

      313    11023    3                       GOTO MERR;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:65   

  11023  1 001001   004232 710000 1                  TRA     MERR

      314    11024    3                     END;
      315    11025    2                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11025  1 001002   006714 235100                    LDA     3532,,PR0
         1 001003   000001 115007                    CMPA    1,DL
         1 001004   001024 601000 1                  TNZ     s:11027

      316    11026    2                      THEN CALL DDK$PUTMVAL(NVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS
             11026                                ) ALTRET(MERR);

  11026  1 001005   200006 631500                    EPPR1   NOT_IS,,AUTO
         1 001006   200234 451500                    STP1    DUM2+5,,AUTO
         1 001007   200005 633500                    EPPR3   DESC#,,AUTO
         1 001010   200233 453500                    STP3    DUM2+4,,AUTO
         1 001011   200004 634500                    EPPR4   SEG,,AUTO
         1 001012   200232 454500                    STP4    DUM2+3,,AUTO
         1 001013   200003 635500                    EPPR5   ADDRESS,,AUTO
         1 001014   200231 455500                    STP5    DUM2+2,,AUTO
         1 001015   200045 636500                    EPPR6   NVALUE+1,,AUTO
         1 001016   200230 456500                    STP6    DUM2+1,,AUTO
         1 001017   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001020   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001021   000000 701000 xent               TSX1    DDK$PUTMVAL
         1 001022   004232 702000 1                  TSX2    MERR
         1 001023   001047 710000 1                  TRA     s:11030

      317    11027    2                       ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11027  1 001024   000002 115007                    CMPA    2,DL
         1 001025   004207 601000 1                  TNZ     MERR1

      318    11028    2                            THEN CALL DFK$PUTMVAL(NVALUE, EVALUE, ADDRESS, SEG, DESC#,
             11028                                     NOT_IS) ALTRET(MERR);

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:66   
  11028  1 001026   200006 631500                    EPPR1   NOT_IS,,AUTO
         1 001027   200235 451500                    STP1    DUM2+6,,AUTO
         1 001030   200005 633500                    EPPR3   DESC#,,AUTO
         1 001031   200234 453500                    STP3    DUM2+5,,AUTO
         1 001032   200004 634500                    EPPR4   SEG,,AUTO
         1 001033   200233 454500                    STP4    DUM2+4,,AUTO
         1 001034   200003 635500                    EPPR5   ADDRESS,,AUTO
         1 001035   200232 455500                    STP5    DUM2+3,,AUTO
         1 001036   200065 636500                    EPPR6   EVALUE,,AUTO
         1 001037   200231 456500                    STP6    DUM2+2,,AUTO
         1 001040   200044 637500                    EPPR7   NVALUE,,AUTO
         1 001041   200230 457500                    STP7    DUM2+1,,AUTO
         1 001042   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001043   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 001044   000000 701000 xent               TSX1    DFK$PUTMVAL
         1 001045   004232 702000 1                  TSX2    MERR
         1 001046   001047 710000 1                  TRA     s:11030

      319    11029    2                            ELSE GOTO MERR1;
      320    11030    2             IF NOT(NOT_IS)

  11030  1 001047   200006 234100                    SZN     NOT_IS,,AUTO
         1 001050   001153 604000 1                  TMI     s:11058

      321    11031    3             THEN DO;

      322    11032    3                  IF (ADDRESS >= S_D.NEXT@) AND (ADDRESS <= S_D.HIGH@) AND S_D.GOT@

  11032  1 001051   000000 470400 xsym               LDP0    S_D$
         1 001052   200003 236100                    LDQ     ADDRESS,,AUTO
         1 001053   001076 604000 1                  TMI     s:11035
         1 001054   005055 116100                    CMPQ    2605,,PR0
         1 001055   001076 602000 1                  TNC     s:11035
         1 001056   000000 116003                    CMPQ    0,DU
         1 001057   001063 604000 1                  TMI     s:11032+10
         1 001060   005133 116100                    CMPQ    2651,,PR0
         1 001061   001063 600000 1                  TZE     s:11032+10
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:67   
         1 001062   001076 603000 1                  TRC     s:11035
         1 001063   005054 234100                    SZN     2604,,PR0
         1 001064   001076 605000 1                  TPL     s:11035

      323    11033    3                  THEN CALL DDK$INCR@ (ADDRESS, NVALUE.SIZE) ALTRET(MERR);

  11033  1 001065   200044 631500                    EPPR1   NVALUE,,AUTO
         1 001066   200231 451500                    STP1    DUM2+2,,AUTO
         1 001067   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 001070   200230 453500                    STP3    DUM2+1,,AUTO
         1 001071   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001072   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001073   000000 701000 xent               TSX1    DDK$INCR@
         1 001074   004232 702000 1                  TSX2    MERR
         1 001075   001153 710000 1                  TRA     s:11058

      324    11034    4                  ELSE DO;

      325    11035    4                       IF (ADDRESS >= S_D.NEXT#) AND (ADDRESS <= S_D.HIGH#) AND S_D.
             11035                                GOT#

  11035  1 001076   000000 116003                    CMPQ    0,DU
         1 001077   001122 604000 1                  TMI     s:11038
         1 001100   005062 116100                    CMPQ    2610,,PR0
         1 001101   001122 602000 1                  TNC     s:11038
         1 001102   000000 116003                    CMPQ    0,DU
         1 001103   001107 604000 1                  TMI     s:11035+9
         1 001104   005136 116100                    CMPQ    2654,,PR0
         1 001105   001107 600000 1                  TZE     s:11035+9
         1 001106   001122 603000 1                  TRC     s:11038
         1 001107   005061 234100                    SZN     2609,,PR0
         1 001110   001122 605000 1                  TPL     s:11038

      326    11036    4                       THEN CALL DDK$INCR# (ADDRESS, NVALUE.SIZE) ALTRET(MERR);

  11036  1 001111   200044 631500                    EPPR1   NVALUE,,AUTO
         1 001112   200231 451500                    STP1    DUM2+2,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:68   
         1 001113   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 001114   200230 453500                    STP3    DUM2+1,,AUTO
         1 001115   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001116   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001117   000000 701000 xent               TSX1    DDK$INCR#
         1 001120   004232 702000 1                  TSX2    MERR
         1 001121   001153 710000 1                  TRA     s:11058

      327    11037    5                       ELSE DO;

      328    11038    5                            S_D.RI$ = OVALUE;

  11038  1 001122   000100 100500                    MLR     fill='000'O
         1 001123   200023 000104                    ADSC9   OVALUE,,AUTO             cn=0,n=68
         1 001124   005066 000104                    ADSC9   2614,,PR0                cn=0,n=68

      329    11039    5                            IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11039  1 001125   006714 235100                    LDA     3532,,PR0
         1 001126   000001 115007                    CMPA    1,DL
         1 001127   001133 601000 1                  TNZ     s:11042

      330    11040    5                            THEN
      331    11041    5                                 S_D.NA$ = ADDRESS + 1;

  11041  1 001130   000001 036007                    ADLQ    1,DL
         1 001131   005107 756100                    STQ     2631,,PR0
         1 001132   001153 710000 1                  TRA     s:11058

      332    11042    5                            ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11042  1 001133   000002 115007                    CMPA    2,DL
         1 001134   004207 601000 1                  TNZ     MERR1

      333    11043    6                                 THEN DO;

      334    11044    6                                      S_D.NA$ = ADDRESS;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:69   

  11044  1 001135   005107 756100                    STQ     2631,,PR0

      335    11045    6                                      SETNA$ = '1'B;

  11045  1 001136   400000 236003                    LDQ     -131072,DU
         1 001137   200202 756100                    STQ     SETNA$,,AUTO

      336    11046    6                                    END;

  11046  1 001140   001153 710000 1                  TRA     s:11058

      337    11047    5                                 ELSE GOTO MERR1;
      338    11048    5                          END;
      339    11049    4                     END;
      340    11050    3                END;
      341    11051    2           END;                            /* DO  ( new value specified ) */
      342    11052    2        ELSE DO;                           /* Interactive MODIFY  command */

      343    11053    2             NVALUE = OVALUE;

  11053  1 001141   000100 100500                    MLR     fill='000'O
         1 001142   200023 000104                    ADSC9   OVALUE,,AUTO             cn=0,n=68
         1 001143   200044 000104                    ADSC9   NVALUE,,AUTO             cn=0,n=68

      344    11054    2             MACTIVE = '1'B;

  11054  1 001144   400000 236003                    LDQ     -131072,DU
         1 001145   200015 756100                    STQ     MACTIVE,,AUTO

      345    11055    2             IF MOD$CMD.SACT               /* Check for activation '/' */

  11055  1 001146   100001 236100                    LDQ     1,,PR1
         1 001147   000400 316007                    CANQ    256,DL
         1 001150   001153 600000 1                  TZE     s:11058

      346    11056    2             THEN SUPADR = '1'B;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:70   

  11056  1 001151   400000 236003                    LDQ     -131072,DU
         1 001152   200200 756100                    STQ     SUPADR,,AUTO

      347    11057    2           END;                            /* DO  ( interactive modify command ) */

      348    11058    1        GOTO DISPMOD;

  11058  1 001153   003176 710000 1                  TRA     DISPMOD

      349    11059                                                /**/
      350    11060        /*F*  NAME: DDA$MACTIVE
      351    11061              PURPOSE: To perform action as indicated by interactive
      352    11062                  MODIFY  command response.
      353    11063                                                     */
      354    11064    1   DDA$MACTIVE: ENTRY ALTRET;

  11064  1 001154   000000 700200 xent  DDA$MACTIVE  TSX0  ! X66_AUTO_0
         1 001155   000240 000000                    ZERO    160,0

      355    11065                                                /**/
      356    11066    1        SUPADR = '0'B;

  11066  1 001156   200200 450100                    STZ     SUPADR,,AUTO

      357    11067    1        S_D.MACTIVE = '0'B;

  11067  1 001157   000000 470400 xsym               LDP0    S_D$
         1 001160   000713 450100                    STZ     459,,PR0

      358    11068    1        SETNA$ = '0'B;

  11068  1 001161   200202 450100                    STZ     SETNA$,,AUTO

      359    11069    1        DO$ = S_D.DO$;

  11069  1 001162   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:71   
         1 001163   200177 756100                    STQ     DO$,,AUTO

      360    11070    1        NMSLASH = MACT$CMD.NMSLASH;

  11070  1 001164   200177 471500                    LDP1    DO$,,AUTO
         1 001165   100001 236100                    LDQ     1,,PR1
         1 001166   000002 736000                    QLS     2
         1 001167   400000 376003                    ANQ     -131072,DU
         1 001170   200201 756100                    STQ     NMSLASH,,AUTO

      361    11071    1        FMT = MACT$CMD.FORMAT;

  11071  1 001171   100002 236100                    LDQ     2,,PR1
         1 001172   000033 772000                    QRL     27
         1 001173   200110 756100                    STQ     FMT,,AUTO

      362    11072    1        IF FMT = %DEFAULT_FMT

  11072  1 001174   000037 116007                    CMPQ    31,DL
         1 001175   001201 601000 1                  TNZ     s:11074

      363    11073    1        THEN FMT = S_D.O$.FMT;

  11073  1 001176   000133 236100                    LDQ     91,,PR0
         1 001177   777777 376007                    ANQ     -1,DL
         1 001200   200110 756100                    STQ     FMT,,AUTO

      364    11074    1        ADDRESS = S_D.O$.ADDRESS;

  11074  1 001201   000132 235100                    LDA     90,,PR0
         1 001202   200003 755100                    STA     ADDRESS,,AUTO

      365    11075    1        SEG = S_D.O$.SEG;

  11075  1 001203   000130 235100                    LDA     88,,PR0
         1 001204   200004 755100                    STA     SEG,,AUTO

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:72   
      366    11076    1        DESC# = S_D.O$.DESC#;

  11076  1 001205   000131 235100                    LDA     89,,PR0
         1 001206   200005 755100                    STA     DESC#,,AUTO

      367    11077    1        NOT_IS = S_D.O$.NOT_IS;

  11077  1 001207   000133 236100                    LDQ     91,,PR0
         1 001210   400000 376003                    ANQ     -131072,DU
         1 001211   200006 756100                    STQ     NOT_IS,,AUTO

      368    11078    1        SAVE_DOMAIN = '0'B;

  11078  1 001212   200206 450100                    STZ     SAVE_DOMAIN,,AUTO

      369    11079    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND

  11079  1 001213   006714 235100                    LDA     3532,,PR0
         1 001214   000002 115007                    CMPA    2,DL
         1 001215   001234 601000 1                  TNZ     s:11089
         1 001216   200004 235100                    LDA     SEG,,AUTO
         1 001217   000007 115007                    CMPA    7,DL
         1 001220   001234 601000 1                  TNZ     s:11089
         1 001221   200005 235100                    LDA     DESC#,,AUTO
         1 001222   000002 115007                    CMPA    2,DL
         1 001223   001234 601000 1                  TNZ     s:11089
         1 001224   004755 234100                    SZN     2541,,PR0
         1 001225   001234 605000 1                  TPL     s:11089

      370    11080    1          SEG = 7 AND
      371    11081    1          DESC# = 2 AND
      372    11082    1          S_D.RUM
      373    11083    2        THEN DO;

      374    11084    2             SAVE_DOMAIN = '1'B;

  11084  1 001226   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:73   
         1 001227   200206 756100                    STQ     SAVE_DOMAIN,,AUTO

      375    11085    2             SAVE_EXEC_DOMAIN = S_D.ONE_TO_TWO.EXEC_DOMAIN;

  11085  1 001230   006714 235100                    LDA     3532,,PR0
         1 001231   200207 755100                    STA     SAVE_EXEC_DOMAIN,,AUTO

      376    11086    2             S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST;

  11086  1 001232   000001 235007                    LDA     1,DL
         1 001233   006714 755100                    STA     3532,,PR0

      377    11087    2           END;

      378    11088
      379    11089    1        IF MACT$CMD.DDESC

  11089  1 001234   100001 234100                    SZN     1,,PR1
         1 001235   002137 605000 1                  TPL     s:11215

      380    11090    2        THEN DO;

      381    11091    2             S_D.DESC$ = S_D.D$;

  11091  1 001236   000044 236100                    LDQ     36,,PR0
         1 001237   000041 756100                    STQ     33,,PR0

      382    11092    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11092  1 001240   006714 235100                    LDA     3532,,PR0
         1 001241   000001 115007                    CMPA    1,DL
         1 001242   001261 601000 1                  TNZ     s:11094

      383    11093    2             THEN CALL IORVALUE(NVALUE,MACT$CMD.INSTR,MACT$CMD.IGNPR,MACT$CMD.AWDX)
             11093                      ALTRET(MERR);

  11093  1 001243   200177 236100                    LDQ     DO$,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:74   
         1 001244   000002 036000 2                  ADLQ    2
         1 001245   200222 756100                    STQ     @MOD_LOC+1,,AUTO
         1 001246   200177 236100                    LDQ     DO$,,AUTO
         1 001247   000006 036000 2                  ADLQ    6
         1 001250   200221 756100                    STQ     @IFLAG+1,,AUTO
         1 001251   200177 236100                    LDQ     DO$,,AUTO
         1 001252   000021 036000 2                  ADLQ    17
         1 001253   200220 756100                    STQ     @RVALUE+1,,AUTO
         1 001254   200044 633500                    EPPR3   NVALUE,,AUTO
         1 001255   200217 453500                    STP3    ZITEM$+5,,AUTO
         1 001256   004240 701000 1                  TSX1    IORVALUE
         1 001257   004232 702000 1                  TSX2    MERR
         1 001260   001275 710000 1                  TRA     s:11097

      384    11094    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11094  1 001261   000002 115007                    CMPA    2,DL
         1 001262   004207 601000 1                  TNZ     MERR1

      385    11095    2                  THEN CALL L6_IORVALUE(NVALUE,MACT$CMD.INSTR,ADDRESS)ALTRET(MERR);

  11095  1 001263   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 001264   200221 453500                    STP3    @IFLAG+1,,AUTO
         1 001265   200177 236100                    LDQ     DO$,,AUTO
         1 001266   000021 036000 2                  ADLQ    17
         1 001267   200220 756100                    STQ     @RVALUE+1,,AUTO
         1 001270   200044 634500                    EPPR4   NVALUE,,AUTO
         1 001271   200217 454500                    STP4    ZITEM$+5,,AUTO
         1 001272   004346 701000 1                  TSX1    L6_IORVALUE
         1 001273   004232 702000 1                  TSX2    MERR
         1 001274   001275 710000 1                  TRA     s:11097

      386    11096    2                  ELSE GOTO MERR1;
      387    11097    2             IF S_D.RUM

  11097  1 001275   000000 470400 xsym               LDP0    S_D$
         1 001276   004755 234100                    SZN     2541,,PR0
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:75   
         1 001277   001334 605000 1                  TPL     s:11104

      388    11098    3             THEN DO;

      389    11099    3                  NODE = 0;

  11099  1 001300   200014 450100                    STZ     NODE,,AUTO

      390    11100    3                  IF S_D.OVERLAID

  11100  1 001301   004764 234100                    SZN     2548,,PR0
         1 001302   001313 605000 1                  TPL     s:11102

      391    11101    3                  THEN CALL DDS$IC2NODE( ADDRESS, NODE ) ALTRET( MERR );

  11101  1 001303   200014 631500                    EPPR1   NODE,,AUTO
         1 001304   200231 451500                    STP1    DUM2+2,,AUTO
         1 001305   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 001306   200230 453500                    STP3    DUM2+1,,AUTO
         1 001307   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001310   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001311   000000 701000 xent               TSX1    DDS$IC2NODE
         1 001312   004232 702000 1                  TSX2    MERR

      392    11102    3                  CALL DUU$PUTMVAL(NVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
             11102                           MERR);

  11102  1 001313   200006 630500                    EPPR0   NOT_IS,,AUTO
         1 001314   200235 450500                    STP0    DUM2+6,,AUTO
         1 001315   200005 631500                    EPPR1   DESC#,,AUTO
         1 001316   200234 451500                    STP1    DUM2+5,,AUTO
         1 001317   200004 633500                    EPPR3   SEG,,AUTO
         1 001320   200233 453500                    STP3    DUM2+4,,AUTO
         1 001321   200003 634500                    EPPR4   ADDRESS,,AUTO
         1 001322   200232 454500                    STP4    DUM2+3,,AUTO
         1 001323   200014 635500                    EPPR5   NODE,,AUTO
         1 001324   200231 455500                    STP5    DUM2+2,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:76   
         1 001325   200044 636500                    EPPR6   NVALUE,,AUTO
         1 001326   200230 456500                    STP6    DUM2+1,,AUTO
         1 001327   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001330   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 001331   000000 701000 xent               TSX1    DUU$PUTMVAL
         1 001332   004232 702000 1                  TSX2    MERR

      393    11103    3                END;

  11103  1 001333   001406 710000 1                  TRA     s:11114

      394    11104    2             ELSE IF S_D.ANLZ_FILE

  11104  1 001334   005052 234100                    SZN     2602,,PR0
         1 001335   001341 605000 1                  TPL     s:11109

      395    11105    3                  THEN DO;

      396    11106    3                       S_D.ERROR = 155; /*E@CANTPUTINANLZ*/

  11106  1 001336   000233 235007                    LDA     155,DL
         1 001337   000013 755100                    STA     11,,PR0

      397    11107    3                       GOTO MERR;

  11107  1 001340   004232 710000 1                  TRA     MERR

      398    11108    3                     END;
      399    11109    2                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11109  1 001341   006714 235100                    LDA     3532,,PR0
         1 001342   000001 115007                    CMPA    1,DL
         1 001343   001363 601000 1                  TNZ     s:11111

      400    11110    2                      THEN CALL DDK$PUTMVAL(NVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS
             11110                                ) ALTRET(MERR);

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:77   
  11110  1 001344   200006 631500                    EPPR1   NOT_IS,,AUTO
         1 001345   200234 451500                    STP1    DUM2+5,,AUTO
         1 001346   200005 633500                    EPPR3   DESC#,,AUTO
         1 001347   200233 453500                    STP3    DUM2+4,,AUTO
         1 001350   200004 634500                    EPPR4   SEG,,AUTO
         1 001351   200232 454500                    STP4    DUM2+3,,AUTO
         1 001352   200003 635500                    EPPR5   ADDRESS,,AUTO
         1 001353   200231 455500                    STP5    DUM2+2,,AUTO
         1 001354   200045 636500                    EPPR6   NVALUE+1,,AUTO
         1 001355   200230 456500                    STP6    DUM2+1,,AUTO
         1 001356   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001357   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001360   000000 701000 xent               TSX1    DDK$PUTMVAL
         1 001361   004232 702000 1                  TSX2    MERR
         1 001362   001406 710000 1                  TRA     s:11114

      401    11111    2                       ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11111  1 001363   000002 115007                    CMPA    2,DL
         1 001364   004207 601000 1                  TNZ     MERR1

      402    11112    2                           THEN CALL DFK$PUTMVAL(NVALUE, , ADDRESS, SEG, DESC#, NOT_IS
             11112                                     ) ALTRET(MERR);

  11112  1 001365   200006 631500                    EPPR1   NOT_IS,,AUTO
         1 001366   200235 451500                    STP1    DUM2+6,,AUTO
         1 001367   200005 633500                    EPPR3   DESC#,,AUTO
         1 001370   200234 453500                    STP3    DUM2+5,,AUTO
         1 001371   200004 634500                    EPPR4   SEG,,AUTO
         1 001372   200233 454500                    STP4    DUM2+4,,AUTO
         1 001373   200003 635500                    EPPR5   ADDRESS,,AUTO
         1 001374   200232 455500                    STP5    DUM2+3,,AUTO
         1 001375   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001376   200231 756100                    STQ     DUM2+2,,AUTO
         1 001377   200044 636500                    EPPR6   NVALUE,,AUTO
         1 001400   200230 456500                    STP6    DUM2+1,,AUTO
         1 001401   200230 630500                    EPPR0   DUM2+1,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:78   
         1 001402   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 001403   000000 701000 xent               TSX1    DFK$PUTMVAL
         1 001404   004232 702000 1                  TSX2    MERR
         1 001405   001406 710000 1                  TRA     s:11114

      403    11113    2                            ELSE GOTO MERR1;
      404    11114    2             IF S_D.ANLZ AND NOT S_D.ANLZ_MODIFIED AND NOT S_D.ANLZ_FILE AND NOT (
             11114                      MACTIVE AND S_D.ALIB_SAID_GOBACK)

  11114  1 001406   000000 470400 xsym               LDP0    S_D$
         1 001407   004756 234100                    SZN     2542,,PR0
         1 001410   001427 605000 1                  TPL     s:11119
         1 001411   005311 234100                    SZN     2761,,PR0
         1 001412   001427 604000 1                  TMI     s:11119
         1 001413   005052 234100                    SZN     2602,,PR0
         1 001414   001427 604000 1                  TMI     s:11119
         1 001415   200015 234100                    SZN     MACTIVE,,AUTO
         1 001416   001421 605000 1                  TPL     s:11116
         1 001417   000075 234100                    SZN     61,,PR0
         1 001420   001427 604000 1                  TMI     s:11119

      405    11115    3             THEN DO;

      406    11116    3                  S_D.ANLZ_MODIFIED = '1'B;

  11116  1 001421   400000 236003                    LDQ     -131072,DU
         1 001422   005311 756100                    STQ     2761,,PR0

      407    11117    3                  CALL DUQ$OCMSG (60 /* ANLZMOD_MSG# */);

  11117  1 001423   000025 630400 2                  EPPR0   21
         1 001424   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001425   000000 701000 xent               TSX1    DUQ$OCMSG
         1 001426   000000 011000                    NOP     0

      408    11118    3                END;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:79   
      409    11119    2             OVALUE.OPS = S_D.L$.VALUE;

  11119  1 001427   000000 470400 xsym               LDP0    S_D$
         1 001430   000100 100500                    MLR     fill='000'O
         1 001431   000106 000100                    ADSC9   70,,PR0                  cn=0,n=64
         1 001432   200024 000100                    ADSC9   OVALUE+1,,AUTO           cn=0,n=64

      410    11120    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11120  1 001433   006714 235100                    LDA     3532,,PR0
         1 001434   000001 115007                    CMPA    1,DL
         1 001435   001442 601000 1                  TNZ     s:11122

      411    11121    2             THEN OVALUE.SIZE = S_D.L$.SIZE / 36;

  11121  1 001436   000126 236100                    LDQ     86,,PR0
         1 001437   000044 506007                    DIV     36,DL
         1 001440   200023 756100                    STQ     OVALUE,,AUTO
         1 001441   001445 710000 1                  TRA     s:11123

      412    11122    2             ELSE OVALUE.SIZE = S_D.L$.SIZE / 16;

  11122  1 001442   000126 236100                    LDQ     86,,PR0
         1 001443   000020 506007                    DIV     16,DL
         1 001444   200023 756100                    STQ     OVALUE,,AUTO

      413    11123    2             S_D.L$.VALUE = NVALUE.OPS;

  11123  1 001445   000100 100500                    MLR     fill='000'O
         1 001446   200045 000100                    ADSC9   NVALUE+1,,AUTO           cn=0,n=64
         1 001447   000106 000100                    ADSC9   70,,PR0                  cn=0,n=64

      414    11124    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11124  1 001450   006714 235100                    LDA     3532,,PR0
         1 001451   000001 115007                    CMPA    1,DL
         1 001452   001456 601000 1                  TNZ     s:11126
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:80   

      415    11125    2             THEN S_D.L$.SIZE = 36;

  11125  1 001453   000044 235007                    LDA     36,DL
         1 001454   000126 755100                    STA     86,,PR0
         1 001455   001516 710000 1                  TRA     s:11141

      416    11126    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11126  1 001456   000002 115007                    CMPA    2,DL
         1 001457   001516 601000 1                  TNZ     s:11141

      417    11127    3                  THEN DO;

      418    11128    3                       IF FMT = %INST_FMT

  11128  1 001460   200110 235100                    LDA     FMT,,AUTO
         1 001461   000006 115007                    CMPA    6,DL
         1 001462   001477 601000 1                  TNZ     NOTINST

      419    11129    4                       THEN DO;

      420    11130    4                            CALL DFR$INSTR (NVALUE.OPS, S_D.O$SIZE,

  11130  1 001463   000026 237000 2                  LDAQ    22
         1 001464   200232 757100                    STAQ    DUM2+3,,AUTO
         1 001465   000000 236000 xsym               LDQ     S_D$
         1 001466   006763 036003                    ADLQ    3571,DU
         1 001467   200231 756100                    STQ     DUM2+2,,AUTO
         1 001470   200045 631500                    EPPR1   NVALUE+1,,AUTO
         1 001471   200230 451500                    STP1    DUM2+1,,AUTO
         1 001472   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001473   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001474   000000 701000 xent               TSX1    DFR$INSTR
         1 001475   001477 702000 1                  TSX2    NOTINST

      421    11131    4                              '0'B, '1'B) ALTRET(NOTINST);
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:81   
      422    11132    4                          END;

  11132  1 001476   001512 710000 1                  TRA     s:11139

      423    11133    4                       ELSE DO;

      424    11134    4   NOTINST:
      425    11135    4                            IF S_D.MDW = '1'B OR FMT = %PTR_FMT

  11135  1 001477   000000 470400 xsym  NOTINST      LDP0    S_D$
         1 001500   006724 234100                    SZN     3540,,PR0
         1 001501   001505 604000 1                  TMI     s:11136
         1 001502   200110 235100                    LDA     FMT,,AUTO
         1 001503   000007 115007                    CMPA    7,DL
         1 001504   001510 601000 1                  TNZ     s:11137

      426    11136    4                            THEN S_D.O$SIZE = 2;

  11136  1 001505   000002 235007                    LDA     2,DL
         1 001506   006763 755100                    STA     3571,,PR0
         1 001507   001512 710000 1                  TRA     s:11139

      427    11137    4                            ELSE S_D.O$SIZE = 1;

  11137  1 001510   000001 236007                    LDQ     1,DL
         1 001511   006763 756100                    STQ     3571,,PR0

      428    11138    4                          END;

      429    11139    3                       S_D.L$.SIZE = S_D.O$SIZE * 16;

  11139  1 001512   000000 470400 xsym               LDP0    S_D$
         1 001513   006763 235100                    LDA     3571,,PR0
         1 001514   000004 735000                    ALS     4
         1 001515   000126 755100                    STA     86,,PR0

      430    11140    3                     END;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:82   

      431    11141    2             IF MACT$CMD.INSTR

  11141  1 001516   200177 471500                    LDP1    DO$,,AUTO
         1 001517   100001 236100                    LDQ     1,,PR1
         1 001520   200000 316003                    CANQ    65536,DU
         1 001521   001525 600000 1                  TZE     s:11143

      432    11142    2             THEN S_D.L$.FMT = %INST_FMT;

  11142  1 001522   000006 235007                    LDA     6,DL
         1 001523   000127 755100                    STA     87,,PR0
         1 001524   001527 710000 1                  TRA     s:11144

      433    11143    2             ELSE S_D.L$.FMT = S_D.POFMT;  /* If not instr use old FMT */

  11143  1 001525   005132 235100                    LDA     2650,,PR0
         1 001526   000127 755100                    STA     87,,PR0

      434    11144    2             IF NOT_IS AND SEG = 9 AND DESC# = 0

  11144  1 001527   200006 234100                    SZN     NOT_IS,,AUTO
         1 001530   001540 605000 1                  TPL     s:11146
         1 001531   200004 236100                    LDQ     SEG,,AUTO
         1 001532   000011 116007                    CMPQ    9,DL
         1 001533   001540 601000 1                  TNZ     s:11146
         1 001534   200005 235100                    LDA     DESC#,,AUTO
         1 001535   001540 601000 1                  TNZ     s:11146

      435    11145    2             THEN S_D.L$.FMT = FMT;

  11145  1 001536   200110 235100                    LDA     FMT,,AUTO
         1 001537   000127 755100                    STA     87,,PR0

      436    11146    2             IF S_D.RUM OR S_D.ANLZ OR S_D.PATCH

  11146  1 001540   004755 234100                    SZN     2541,,PR0
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:83   
         1 001541   001546 604000 1                  TMI     s:11149
         1 001542   004756 234100                    SZN     2542,,PR0
         1 001543   001546 604000 1                  TMI     s:11149
         1 001544   004754 234100                    SZN     2540,,PR0
         1 001545   002046 605000 1                  TPL     s:11195

      437    11147    3             THEN DO;

      438    11148                                 /* Reserve 16 characters for the replacement value */
      439    11149    3                  S_D.DESCL$ = PINCRC(ADDR(S_D.PIMAGE), LENGTHC(S_D.PIMAGE)-16);

  11149  1 001546   000000 236000 xsym               LDQ     S_D$
         1 001547   005043 036003                    ADLQ    2595,DU
         1 001550   000042 756100                    STQ     34,,PR0

      440    11150    3                  S_D.D$ = PINCRC(ADDR(S_D.PIMAGE), S_D.PCHARS);

  11150  1 001551   005047 236100                    LDQ     2599,,PR0
         1 001552   000020 736000                    QLS     16
         1 001553   005011 036003                    ADLQ    2569,DU
         1 001554   000000 036000 xsym               ADLQ    S_D$
         1 001555   000044 756100                    STQ     36,,PR0

      441    11151    3                  TEXT$ = S_D.D$;

  11151  1 001556   200175 756100                    STQ     TEXT$,,AUTO

      442    11152    3                  CALL DDR$BUMPC_D$(2) ALTRET(BUFFUL0);

  11152  1 001557   000030 630400 2                  EPPR0   24
         1 001560   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001561   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001562   001706 702000 1                  TSX2    BUFFUL0

      443    11153    3                  TEXT$ -> CHAR2 = '/ ';

  11153  1 001563   200175 470500                    LDP0    TEXT$,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:84   
         1 001564   040100 100400                    MLR     fill='040'O
         1 001565   000000 000002 0                  ADSC9   0                        cn=0,n=2
         1 001566   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      444    11154    3                  CALL DDA$DISPFMT(S_D.L$.FMT, S_D.L$.SIZE, NVALUE.OPS)

  11154  1 001567   200045 631500                    EPPR1   NVALUE+1,,AUTO
         1 001570   200232 451500                    STP1    DUM2+3,,AUTO
         1 001571   000000 236000 xsym               LDQ     S_D$
         1 001572   000126 036003                    ADLQ    86,DU
         1 001573   200231 756100                    STQ     DUM2+2,,AUTO
         1 001574   000000 236000 xsym               LDQ     S_D$
         1 001575   000127 036003                    ADLQ    87,DU
         1 001576   200230 756100                    STQ     DUM2+1,,AUTO
         1 001577   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001600   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001601   000000 701000 xent               TSX1    DDA$DISPFMT
         1 001602   001706 702000 1                  TSX2    BUFFUL0

      445    11155    3                    ALTRET(BUFFUL0);
      446    11156    3                  S_D.DESCL$ = PINCRC(S_D.DESCL$, 16);

  11156  1 001603   000000 470400 xsym               LDP0    S_D$
         1 001604   000042 236100                    LDQ     34,,PR0
         1 001605   000004 036003                    ADLQ    4,DU
         1 001606   000042 756100                    STQ     34,,PR0

      447    11157    3                  TEXT$ = S_D.D$;

  11157  1 001607   000044 236100                    LDQ     36,,PR0
         1 001610   200175 756100                    STQ     TEXT$,,AUTO

      448    11158    3                  CALL DDR$BUMPC_D$(2) ALTRET(BUFFULL);

  11158  1 001611   000030 630400 2                  EPPR0   24
         1 001612   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001613   000000 701000 xent               TSX1    DDR$BUMPC_D$
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:85   
         1 001614   001712 702000 1                  TSX2    BUFFULL

      449    11159    3                  TEXT$ -> CHAR2 = ' (';

  11159  1 001615   200175 470500                    LDP0    TEXT$,,AUTO
         1 001616   040100 100400                    MLR     fill='040'O
         1 001617   000001 000002 0                  ADSC9   1                        cn=0,n=2
         1 001620   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      450    11160    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11160  1 001621   000000 471400 xsym               LDP1    S_D$
         1 001622   106714 235100                    LDA     3532,,PR1
         1 001623   000001 115007                    CMPA    1,DL
         1 001624   001650 601000 1                  TNZ     s:11162

      451    11161    3                  THEN CALL DDA$DISPFMT(S_D.POFMT, OVALUE.SIZE * 36, S_D.POVALUE.OPS,,
             11161                           '1'B) ALTRET(BUFFULL);

  11161  1 001625   200023 236100                    LDQ     OVALUE,,AUTO
         1 001626   000044 402007                    MPY     36,DL
         1 001627   200230 756100                    STQ     DUM2+1,,AUTO
         1 001630   000000 236000 2                  LDQ     0
         1 001631   000001 235000 xsym               LDA     B_VECTNIL+1
         1 001632   200234 757100                    STAQ    DUM2+5,,AUTO
         1 001633   000000 236000 xsym               LDQ     S_D$
         1 001634   005112 036003                    ADLQ    2634,DU
         1 001635   200233 756100                    STQ     DUM2+4,,AUTO
         1 001636   200230 633500                    EPPR3   DUM2+1,,AUTO
         1 001637   200232 453500                    STP3    DUM2+3,,AUTO
         1 001640   000000 236000 xsym               LDQ     S_D$
         1 001641   005132 036003                    ADLQ    2650,DU
         1 001642   200231 756100                    STQ     DUM2+2,,AUTO
         1 001643   200231 630500                    EPPR0   DUM2+2,,AUTO
         1 001644   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001645   000000 701000 xent               TSX1    DDA$DISPFMT
         1 001646   001712 702000 1                  TSX2    BUFFULL
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:86   
         1 001647   001672 710000 1                  TRA     s:11163

      452    11162    3                  ELSE CALL DDA$DISPFMT(S_D.POFMT, OVALUE.SIZE * 16, S_D.POVALUE.OPS,,
             11162                           '1'B) ALTRET(BUFFULL);

  11162  1 001650   200023 236100                    LDQ     OVALUE,,AUTO
         1 001651   000004 736000                    QLS     4
         1 001652   200230 756100                    STQ     DUM2+1,,AUTO
         1 001653   000000 236000 2                  LDQ     0
         1 001654   000001 235000 xsym               LDA     B_VECTNIL+1
         1 001655   200234 757100                    STAQ    DUM2+5,,AUTO
         1 001656   000000 236000 xsym               LDQ     S_D$
         1 001657   005112 036003                    ADLQ    2634,DU
         1 001660   200233 756100                    STQ     DUM2+4,,AUTO
         1 001661   200230 633500                    EPPR3   DUM2+1,,AUTO
         1 001662   200232 453500                    STP3    DUM2+3,,AUTO
         1 001663   000000 236000 xsym               LDQ     S_D$
         1 001664   005132 036003                    ADLQ    2650,DU
         1 001665   200231 756100                    STQ     DUM2+2,,AUTO
         1 001666   200231 630500                    EPPR0   DUM2+2,,AUTO
         1 001667   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001670   000000 701000 xent               TSX1    DDA$DISPFMT
         1 001671   001712 702000 1                  TSX2    BUFFULL

      453    11163    3                  TEXT$ = S_D.D$;

  11163  1 001672   000000 470400 xsym               LDP0    S_D$
         1 001673   000044 236100                    LDQ     36,,PR0
         1 001674   200175 756100                    STQ     TEXT$,,AUTO

      454    11164    3                  CALL DDR$BUMPC_D$(1) ALTRET(BUFFULL);

  11164  1 001675   000012 630400 2                  EPPR0   10
         1 001676   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001677   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001700   001712 702000 1                  TSX2    BUFFULL

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:87   
      455    11165    3                  TEXT$ -> CHAR1 = ')';

  11165  1 001701   200175 470500                    LDP0    TEXT$,,AUTO
         1 001702   040100 100400                    MLR     fill='040'O
         1 001703   000031 000001 2                  ADSC9   25                       cn=0,n=1
         1 001704   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      456    11166    4                  DO WHILE ('0'B);

  11166  1 001705   001744 710000 1                  TRA     s:11177

      457    11167    4   BUFFUL0:            S_D.DESCL$ = PINCRC(S_D.DESCL$, 16);

  11167  1 001706   000000 470400 xsym  BUFFUL0      LDP0    S_D$
         1 001707   000042 236100                    LDQ     34,,PR0
         1 001710   000004 036003                    ADLQ    4,DU
         1 001711   000042 756100                    STQ     34,,PR0

      458    11168    4   BUFFULL:            IF S_D.ERROR ~= 88 /*E@BUFFULL*/ THEN GOTO MERR1;

  11168  1 001712   000000 470400 xsym  BUFFULL      LDP0    S_D$
         1 001713   000013 235100                    LDA     11,,PR0
         1 001714   000130 115007                    CMPA    88,DL
         1 001715   004207 601000 1                  TNZ     MERR1

      459    11169    4                       S_D.ERROR = 349; /* E@ROBFULL */

  11169  1 001716   000535 236007                    LDQ     349,DL
         1 001717   000013 756100                    STQ     11,,PR0

      460    11170    4                       CALL DDE$ERROR;

  11170  1 001720   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001721   000000 701000 xent               TSX1    DDE$ERROR
         1 001722   000000 011000                    NOP     0

      461    11171    4                       IF S_D.D$ > PINCRC(S_D.DESCL$, -3)
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:88   

  11171  1 001723   000000 470400 xsym               LDP0    S_D$
         1 001724   000042 236100                    LDQ     34,,PR0
         1 001725   000032 036000 2                  ADLQ    26
         1 001726   000044 116100                    CMPQ    36,,PR0
         1 001727   001731 603000 1                  TRC     s:11173

      462    11172    4                       THEN S_D.D$ = PINCRC(S_D.DESCL$, -3);

  11172  1 001730   000044 756100                    STQ     36,,PR0

      463    11173    4                       NCHARS = 3;

  11173  1 001731   000003 235007                    LDA     3,DL
         1 001732   200176 755100                    STA     NCHARS,,AUTO

      464    11174    4                       S_D.D$ -> TEXTR = '...';

  11174  1 001733   000044 471500                    LDP1    36,,PR0
         1 001734   000000 620005                    EAX0    0,AL
         1 001735   040140 100400                    MLR     fill='040'O
         1 001736   000002 000003 0                  ADSC9   2                        cn=0,n=3
         1 001737   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      465    11175    4                       CALL DDR$BUMPC_D$(3) ALTRET(MERR1);

  11175  1 001740   000033 630400 2                  EPPR0   27
         1 001741   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001742   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001743   004207 702000 1                  TSX2    MERR1

      466    11176    4                     END;

      467    11177    3                  TEMP = POFFC(S_D.D$, ADDR(S_D.PIMAGE));

  11177  1 001744   000000 236000 xsym               LDQ     S_D$
         1 001745   005011 036003                    ADLQ    2569,DU
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:89   
         1 001746   000020 772000                    QRL     16
         1 001747   200230 756100                    STQ     DUM2+1,,AUTO
         1 001750   000000 470400 xsym               LDP0    S_D$
         1 001751   000044 236100                    LDQ     36,,PR0
         1 001752   000020 772000                    QRL     16
         1 001753   200230 136100                    SBLQ    DUM2+1,,AUTO
         1 001754   200204 756100                    STQ     TEMP,,AUTO

      468    11178    3                  IF S_D.RUM AND NOT S_D.RUM_TEST

  11178  1 001755   004755 234100                    SZN     2541,,PR0
         1 001756   002001 605000 1                  TPL     s:11183
         1 001757   005004 234100                    SZN     2564,,PR0
         1 001760   002001 604000 1                  TMI     s:11183

      469    11179    4                  THEN DO;

      470    11180    4                       START$ = ADDR(S_D.PIMAGE);

  11180  1 001761   000000 236000 xsym               LDQ     S_D$
         1 001762   005011 036003                    ADLQ    2569,DU
         1 001763   200111 756100                    STQ     START$,,AUTO

      471    11181    4                      CALL DDQ$WRITELM(%TYPRUM, 0, NODE, START$, TEMP ) ALTRET(MERR2);

  11181  1 001764   200204 631500                    EPPR1   TEMP,,AUTO
         1 001765   200234 451500                    STP1    DUM2+5,,AUTO
         1 001766   200111 633500                    EPPR3   START$,,AUTO
         1 001767   200233 453500                    STP3    DUM2+4,,AUTO
         1 001770   200014 634500                    EPPR4   NODE,,AUTO
         1 001771   200232 454500                    STP4    DUM2+3,,AUTO
         1 001772   000036 237000 2                  LDAQ    30
         1 001773   200230 757100                    STAQ    DUM2+1,,AUTO
         1 001774   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 001775   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001776   000000 701000 xent               TSX1    DDQ$WRITELM
         1 001777   004216 702000 1                  TSX2    MERR2
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:90   

      472    11182    4                     END;

  11182  1 002000   002046 710000 1                  TRA     s:11195

      473    11183    3                  ELSE IF S_D.PATCH

  11183  1 002001   004754 234100                    SZN     2540,,PR0
         1 002002   002025 605000 1                  TPL     s:11189

      474    11184    4                       THEN DO;

      475    11185    4                            S_D.XDP.IMAGE.INP = S_D.INPUT;

  11185  1 002003   040100 100500                    MLR     fill='040'O
         1 002004   000610 000120                    ADSC9   392,,PR0                 cn=0,n=80
         1 002005   005335 000120                    ADSC9   2781,,PR0                cn=0,n=80

      476    11186    4                            S_D.XDP.IMAGE.OTP = S_D.PIMAGE;

  11186  1 002006   040100 100500                    MLR     fill='040'O
         1 002007   005011 000170                    ADSC9   2569,,PR0                cn=0,n=120
         1 002010   005361 000170                    ADSC9   2801,,PR0                cn=0,n=120

      477    11187    4                            CALL DXQ$WRTPI (ADDR(S_D.XDP), SIZEC(S_D.XDP.IMAGE));

  11187  1 002011   000000 236000 xsym               LDQ     S_D$
         1 002012   005335 036003                    ADLQ    2781,DU
         1 002013   200230 756100                    STQ     DUM2+1,,AUTO
         1 002014   000040 236000 2                  LDQ     32
         1 002015   200233 756100                    STQ     DUM2+4,,AUTO
         1 002016   200230 631500                    EPPR1   DUM2+1,,AUTO
         1 002017   200232 451500                    STP1    DUM2+3,,AUTO
         1 002020   200232 630500                    EPPR0   DUM2+3,,AUTO
         1 002021   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002022   000000 701000 xent               TSX1    DXQ$WRTPI
         1 002023   000000 011000                    NOP     0
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:91   

      478    11188    4                          END;

  11188  1 002024   002046 710000 1                  TRA     s:11195

      479    11189    3                       ELSE IF S_D.ANLZ AND NOT S_D.ANLZ_FILE AND NOT(MACTIVE AND S_D.
             11189                                ALIB_SAID_GOBACK)

  11189  1 002025   004756 234100                    SZN     2542,,PR0
         1 002026   002046 605000 1                  TPL     s:11195
         1 002027   005052 234100                    SZN     2602,,PR0
         1 002030   002046 604000 1                  TMI     s:11195
         1 002031   200015 234100                    SZN     MACTIVE,,AUTO
         1 002032   002035 605000 1                  TPL     s:11191
         1 002033   000075 234100                    SZN     61,,PR0
         1 002034   002046 604000 1                  TMI     s:11195

      480    11190    4                            THEN DO;

      481    11191    4                                 S_D.OUTPUT = S_D.PIMAGE;

  11191  1 002035   040100 100500                    MLR     fill='040'O
         1 002036   005011 000170                    ADSC9   2569,,PR0                cn=0,n=120
         1 002037   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      482    11192    4                                 CALL DUQ$WRERRLOG (TEMP);

  11192  1 002040   200204 631500                    EPPR1   TEMP,,AUTO
         1 002041   200230 451500                    STP1    DUM2+1,,AUTO
         1 002042   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 002043   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002044   000000 701000 xent               TSX1    DUQ$WRERRLOG
         1 002045   000000 011000                    NOP     0

      483    11193    4                               END;

      484    11194    3                END;                       /* DO S_D.RUM */
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:92   

      485    11195    2             IF NOT(NOT_IS)

  11195  1 002046   200006 234100                    SZN     NOT_IS,,AUTO
         1 002047   002137 604000 1                  TMI     s:11215

      486    11196    3             THEN DO;

      487    11197    3                  IF (ADDRESS >= S_D.NEXT@) AND (ADDRESS <= S_D.HIGH@) AND S_D.GOT@

  11197  1 002050   000000 470400 xsym               LDP0    S_D$
         1 002051   200003 236100                    LDQ     ADDRESS,,AUTO
         1 002052   002075 604000 1                  TMI     s:11200
         1 002053   005055 116100                    CMPQ    2605,,PR0
         1 002054   002075 602000 1                  TNC     s:11200
         1 002055   000000 116003                    CMPQ    0,DU
         1 002056   002062 604000 1                  TMI     s:11197+10
         1 002057   005133 116100                    CMPQ    2651,,PR0
         1 002060   002062 600000 1                  TZE     s:11197+10
         1 002061   002075 603000 1                  TRC     s:11200
         1 002062   005054 234100                    SZN     2604,,PR0
         1 002063   002075 605000 1                  TPL     s:11200

      488    11198    3                  THEN CALL DDK$INCR@ (ADDRESS, NVALUE.SIZE) ALTRET(MERR);

  11198  1 002064   200044 631500                    EPPR1   NVALUE,,AUTO
         1 002065   200231 451500                    STP1    DUM2+2,,AUTO
         1 002066   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 002067   200230 453500                    STP3    DUM2+1,,AUTO
         1 002070   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 002071   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002072   000000 701000 xent               TSX1    DDK$INCR@
         1 002073   004232 702000 1                  TSX2    MERR
         1 002074   002137 710000 1                  TRA     s:11215

      489    11199    4                  ELSE DO;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:93   
      490    11200    4                       IF (ADDRESS >= S_D.NEXT#) AND (ADDRESS <= S_D.HIGH#) AND S_D.
             11200                                GOT#

  11200  1 002075   000000 116003                    CMPQ    0,DU
         1 002076   002121 604000 1                  TMI     s:11203
         1 002077   005062 116100                    CMPQ    2610,,PR0
         1 002100   002121 602000 1                  TNC     s:11203
         1 002101   000000 116003                    CMPQ    0,DU
         1 002102   002106 604000 1                  TMI     s:11200+9
         1 002103   005136 116100                    CMPQ    2654,,PR0
         1 002104   002106 600000 1                  TZE     s:11200+9
         1 002105   002121 603000 1                  TRC     s:11203
         1 002106   005061 234100                    SZN     2609,,PR0
         1 002107   002121 605000 1                  TPL     s:11203

      491    11201    4                       THEN CALL DDK$INCR# (ADDRESS, NVALUE.SIZE) ALTRET(MERR);

  11201  1 002110   200044 631500                    EPPR1   NVALUE,,AUTO
         1 002111   200231 451500                    STP1    DUM2+2,,AUTO
         1 002112   200003 633500                    EPPR3   ADDRESS,,AUTO
         1 002113   200230 453500                    STP3    DUM2+1,,AUTO
         1 002114   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 002115   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002116   000000 701000 xent               TSX1    DDK$INCR#
         1 002117   004232 702000 1                  TSX2    MERR
         1 002120   002137 710000 1                  TRA     s:11215

      492    11202    5                       ELSE DO;

      493    11203    5                            S_D.RI$ = OVALUE;

  11203  1 002121   000100 100500                    MLR     fill='000'O
         1 002122   200023 000104                    ADSC9   OVALUE,,AUTO             cn=0,n=68
         1 002123   005066 000104                    ADSC9   2614,,PR0                cn=0,n=68

      494    11204    5                            IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:94   
  11204  1 002124   006714 235100                    LDA     3532,,PR0
         1 002125   000001 115007                    CMPA    1,DL
         1 002126   002132 601000 1                  TNZ     s:11207

      495    11205    5                            THEN
      496    11206    5                                 S_D.NA$ = ADDRESS + 1;

  11206  1 002127   000001 036007                    ADLQ    1,DL
         1 002130   005107 756100                    STQ     2631,,PR0
         1 002131   002137 710000 1                  TRA     s:11215

      497    11207    5                            ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11207  1 002132   000002 115007                    CMPA    2,DL
         1 002133   004207 601000 1                  TNZ     MERR1

      498    11208    5                                 THEN
      499    11209    5                                      S_D.NA$ = ADDRESS + NVALUE.SIZE;

  11209  1 002134   200044 036100                    ADLQ    NVALUE,,AUTO
         1 002135   005107 756100                    STQ     2631,,PR0
         1 002136   002137 710000 1                  TRA     s:11215

      500    11210    5                                 ELSE GOTO MERR1;
      501    11211    5                          END;
      502    11212    4                     END;
      503    11213    3                END;
      504    11214    2           END;                            /* DO  ( value specified ) */
      505    11215    1        CASECODE = MACT$CMD.SUBCODE ;

  11215  1 002137   200177 470500                    LDP0    DO$,,AUTO
         1 002140   000002 236100                    LDQ     2,,PR0
         1 002141   000022 772000                    QRL     18
         1 002142   000777 376007                    ANQ     511,DL
         1 002143   200174 756100                    STQ     CASECODE,,AUTO

      506    11216    1        IF CASECODE < 393 THEN GOTO MRTN;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:95   

  11216  1 002144   000611 116007                    CMPQ    393,DL
         1 002145   004224 604000 1                  TMI     MRTN

      507    11217    2        DO CASE( CASECODE );

  11217  1 002146   000611 136007                    SBLQ    393,DL
         1 002147   000007 116007                    CMPQ    7,DL
         1 002150   002152 602006 1                  TNC     s:11217+4,QL
         1 002151   003045 710000 1                  TRA     s:11451
         1 002152   002161 710000 1                  TRA     s:11221
         1 002153   002330 710000 1                  TRA     s:11282
         1 002154   002522 710000 1                  TRA     TAB
         1 002155   002453 710000 1                  TRA     s:11326
         1 002156   002457 710000 1                  TRA     s:11331
         1 002157   002476 710000 1                  TRA     s:11346
         1 002160   002510 710000 1                  TRA     s:11356

      508    11218
      509    11219    2          CASE( 393 );     /* M@NEXT */ /* <lf>, n */

      510    11220
      511    11221    2             S_D.EIS = S_D.EIS_SHIFT.X;

  11221  1 002161   000000 471400 xsym               LDP1    S_D$
         1 002162   106740 236100                    LDQ     3552,,PR1
         1 002163   000007 736000                    QLS     7
         1 002164   106740 756100                    STQ     3552,,PR1

      512    11222    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST OR SEG = 9

  11222  1 002165   106714 235100                    LDA     3532,,PR1
         1 002166   000001 115007                    CMPA    1,DL
         1 002167   002173 600000 1                  TZE     s:11224
         1 002170   200004 235100                    LDA     SEG,,AUTO
         1 002171   000011 115007                    CMPA    9,DL
         1 002172   002175 601000 1                  TNZ     s:11225
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:96   

      513    11223    2             THEN
      514    11224    2                  ADDRESS = ADDRESS + 1;

  11224  1 002173   200003 054100                    AOS     ADDRESS,,AUTO
         1 002174   002203 710000 1                  TRA     s:11227

      515    11225    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11225  1 002175   106714 235100                    LDA     3532,,PR1
         1 002176   000002 115007                    CMPA    2,DL
         1 002177   002203 601000 1                  TNZ     s:11227

      516    11226    2                  THEN ADDRESS = ADDRESS + S_D.O$SIZE;

  11226  1 002200   200003 236100                    LDQ     ADDRESS,,AUTO
         1 002201   106763 036100                    ADLQ    3571,,PR1
         1 002202   200003 756100                    STQ     ADDRESS,,AUTO

      517    11227    2             IF NOT_IS AND SEG = 6         /* Host encoded special symbols */

  11227  1 002203   200006 234100                    SZN     NOT_IS,,AUTO
         1 002204   002256 605000 1                  TPL     s:11252
         1 002205   200004 235100                    LDA     SEG,,AUTO
         1 002206   000006 115007                    CMPA    6,DL
         1 002207   002256 601000 1                  TNZ     s:11252

      518    11228    3             THEN DO;

      519    11229    4                  DO CASE( DESC# );

  11229  1 002210   200005 236100                    LDQ     DESC#,,AUTO
         1 002211   000010 116007                    CMPQ    8,DL
         1 002212   002214 602006 1                  TNC     s:11229+4,QL
         1 002213   002252 710000 1                  TRA     s:11247
         1 002214   002224 710000 1                  TRA     s:11231
         1 002215   002227 710000 1                  TRA     s:11233
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:97   
         1 002216   002232 710000 1                  TRA     s:11235
         1 002217   002235 710000 1                  TRA     s:11237
         1 002220   002240 710000 1                  TRA     s:11239
         1 002221   002242 710000 1                  TRA     s:11241
         1 002222   002245 710000 1                  TRA     s:11243
         1 002223   002250 710000 1                  TRA     s:11245

      520    11230    4                    CASE( 0 );             /* $E ... $IC */

      521    11231    4                       TEMP = 12;

  11231  1 002224   000014 235007                    LDA     12,DL
         1 002225   200204 755100                    STA     TEMP,,AUTO
         1 002226   002252 710000 1                  TRA     s:11247

      522    11232    4                    CASE( 1 );             /* $ARn */

      523    11233    4                       TEMP = 7;

  11233  1 002227   000007 235007                    LDA     7,DL
         1 002230   200204 755100                    STA     TEMP,,AUTO
         1 002231   002252 710000 1                  TRA     s:11247

      524    11234    4                    CASE( 2 );             /* $PRn */

      525    11235    4                       TEMP = 7;

  11235  1 002232   000007 235007                    LDA     7,DL
         1 002233   200204 755100                    STA     TEMP,,AUTO
         1 002234   002252 710000 1                  TRA     s:11247

      526    11236    4                    CASE( 3 );             /* $AU ... $QL */

      527    11237    4                       TEMP = 3;

  11237  1 002235   000003 235007                    LDA     3,DL
         1 002236   200204 755100                    STA     TEMP,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:98   
         1 002237   002252 710000 1                  TRA     s:11247

      528    11238    4                    CASE( 4 );             /* $IOBUFSZ */

      529    11239    4                       TEMP = 0;

  11239  1 002240   200204 450100                    STZ     TEMP,,AUTO
         1 002241   002252 710000 1                  TRA     s:11247

      530    11240    4                    CASE( 5 );             /* $WSRn */

      531    11241    4                       TEMP = 7;

  11241  1 002242   000007 235007                    LDA     7,DL
         1 002243   200204 755100                    STA     TEMP,,AUTO
         1 002244   002252 710000 1                  TRA     s:11247

      532    11242    4                    CASE( 6 );             /* $WSQn */

      533    11243    4                       TEMP = 510;

  11243  1 002245   000776 235007                    LDA     510,DL
         1 002246   200204 755100                    STA     TEMP,,AUTO
         1 002247   002252 710000 1                  TRA     s:11247

      534    11244    4                    CASE( 7 );             /* $Fxxxx */

      535    11245    4                       TEMP = 1;

  11245  1 002250   000001 235007                    LDA     1,DL
         1 002251   200204 755100                    STA     TEMP,,AUTO

      536    11246    4                    END;                   /* DO CASE( DESC# ) */

      537    11247    3                  IF ADDRESS > TEMP

  11247  1 002252   200003 236100                    LDQ     ADDRESS,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:99   
         1 002253   200204 116100                    CMPQ    TEMP,,AUTO
         1 002254   002256 604400 1                  TMOZ    s:11252

      538    11248    4                  THEN DO;

      539    11249    4                       RETURN;

  11249  1 002255   000000 702200 xent               TSX2  ! X66_ARET

      540    11250    4                     END;
      541    11251    3                END;                       /* IF SEG = 6 */
      542    11252    2             IF SEG = 7                    /* RUM symbols */

  11252  1 002256   200004 235100                    LDA     SEG,,AUTO
         1 002257   000007 115007                    CMPA    7,DL
         1 002260   002270 601000 1                  TNZ     s:11259

      543    11253    3             THEN DO;

      544    11254    3                  IF DESC# ~= 2 OR ADDRESS > 39 /* SIZEW(HEAD) */

  11254  1 002261   200005 236100                    LDQ     DESC#,,AUTO
         1 002262   000002 116007                    CMPQ    2,DL
         1 002263   002267 601000 1                  TNZ     s:11256
         1 002264   200003 235100                    LDA     ADDRESS,,AUTO
         1 002265   000047 115007                    CMPA    39,DL
         1 002266   002270 604400 1                  TMOZ    s:11259

      545    11255    4                  THEN DO;

      546    11256    4                       GOTO MRTN;

  11256  1 002267   004224 710000 1                  TRA     MRTN

      547    11257    4                     END;
      548    11258    3                END;
      549    11259    2             IF NOT_IS AND SEG = 9 AND DESC# = 0 /* L6 encoded special symbols */
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:100  

  11259  1 002270   200006 234100                    SZN     NOT_IS,,AUTO
         1 002271   002304 605000 1                  TPL     s:11267
         1 002272   200004 235100                    LDA     SEG,,AUTO
         1 002273   000011 115007                    CMPA    9,DL
         1 002274   002304 601000 1                  TNZ     s:11267
         1 002275   200005 236100                    LDQ     DESC#,,AUTO
         1 002276   002304 601000 1                  TNZ     s:11267

      550    11260    3             THEN DO;

      551    11261    3                  IF ADDRESS > 21

  11261  1 002277   200003 235100                    LDA     ADDRESS,,AUTO
         1 002300   000025 115007                    CMPA    21,DL
         1 002301   002303 604400 1                  TMOZ    s:11265

      552    11262    4                  THEN DO;

      553    11263    4                       RETURN;

  11263  1 002302   000000 702200 xent               TSX2  ! X66_ARET

      554    11264    4                     END;
      555    11265    3                  GOTO SET_FMTMDW;

  11265  1 002303   002403 710000 1                  TRA     SET_FMTMDW

      556    11266    3                END;
      557    11267    2             IF NOT_IS AND SEG = 10 AND NOT S_D.IS_PTR

  11267  1 002304   200006 234100                    SZN     NOT_IS,,AUTO
         1 002305   003045 605000 1                  TPL     s:11451
         1 002306   200004 235100                    LDA     SEG,,AUTO
         1 002307   000012 115007                    CMPA    10,DL
         1 002310   003045 601000 1                  TNZ     s:11451
         1 002311   105237 234100                    SZN     2719,,PR1
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:101  
         1 002312   003045 604000 1                  TMI     s:11451

      558    11268    3             THEN DO;

      559    11269    3                  DESC# = DESC# + 1;

  11269  1 002313   200005 236100                    LDQ     DESC#,,AUTO
         1 002314   000001 036007                    ADLQ    1,DL
         1 002315   200005 756100                    STQ     DESC#,,AUTO

      560    11270    3                  ADDRESS = 0;

  11270  1 002316   200003 450100                    STZ     ADDRESS,,AUTO

      561    11271    3                  IF DESC# > 7

  11271  1 002317   000010 116007                    CMPQ    8,DL
         1 002320   003045 602000 1                  TNC     s:11451

      562    11272    4                  THEN DO;

      563    11273    4                       SEG = 9;

  11273  1 002321   000011 235007                    LDA     9,DL
         1 002322   200004 755100                    STA     SEG,,AUTO

      564    11274    4                       DESC# = 0;

  11274  1 002323   200005 450100                    STZ     DESC#,,AUTO

      565    11275    4                       FMT = %X_FMT;

  11275  1 002324   000015 236007                    LDQ     13,DL
         1 002325   200110 756100                    STQ     FMT,,AUTO

      566    11276    4                       S_D.MDW = '0'B;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:102  
  11276  1 002326   106724 450100                    STZ     3540,,PR1

      567    11277    4                     END;

      568    11278    3                END;

  11278  1 002327   003045 710000 1                  TRA     s:11451

      569    11279
      570    11280    2          CASE( 394 );     /* M@PREV */ /* ^, p */

      571    11281
      572    11282    2             S_D.EIS = '0'B;

  11282  1 002330   000000 471400 xsym               LDP1    S_D$
         1 002331   106740 450100                    STZ     3552,,PR1

      573    11283    2             IF SEG = 10 AND

  11283  1 002332   200004 235100                    LDA     SEG,,AUTO
         1 002333   000012 115007                    CMPA    10,DL
         1 002334   002346 601000 1                  TNZ     s:11293
         1 002335   200006 234100                    SZN     NOT_IS,,AUTO
         1 002336   002346 605000 1                  TPL     s:11293
         1 002337   105237 234100                    SZN     2719,,PR1
         1 002340   002346 604000 1                  TMI     s:11293

      574    11284    2               NOT_IS AND
      575    11285    2               NOT S_D.IS_PTR
      576    11286    3             THEN DO;

      577    11287    3                  DESC# = DESC# - 1;

  11287  1 002341   200005 235100                    LDA     DESC#,,AUTO
         1 002342   000001 135007                    SBLA    1,DL
         1 002343   200005 755100                    STA     DESC#,,AUTO

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:103  
      578    11288    3                  IF DESC# < 1

  11288  1 002344   003045 601000 1                  TNZ     s:11451

      579    11289    4                  THEN DO;

      580    11290    4                       RETURN;

  11290  1 002345   000000 702200 xent               TSX2  ! X66_ARET

      581    11291    4                     END;
      582    11292    3                END;
      583    11293    2             ELSE IF SEG = 9 AND

  11293  1 002346   000011 115007                    CMPA    9,DL
         1 002347   002366 601000 1                  TNZ     s:11304
         1 002350   200005 235100                    LDA     DESC#,,AUTO
         1 002351   002366 601000 1                  TNZ     s:11304
         1 002352   200003 235100                    LDA     ADDRESS,,AUTO
         1 002353   002366 601000 1                  TNZ     s:11304
         1 002354   200006 234100                    SZN     NOT_IS,,AUTO
         1 002355   002366 605000 1                  TPL     s:11304

      584    11294    2                    DESC# = 0 AND
      585    11295    2                    ADDRESS = 0 AND
      586    11296    2                    NOT_IS
      587    11297    3                  THEN DO;

      588    11298    3                       SEG = 10;

  11298  1 002356   000012 235007                    LDA     10,DL
         1 002357   200004 755100                    STA     SEG,,AUTO

      589    11299    3                       DESC# = 7;

  11299  1 002360   000007 235007                    LDA     7,DL
         1 002361   200005 755100                    STA     DESC#,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:104  

      590    11300    3                       FMT = %PTR_FMT;

  11300  1 002362   200110 755100                    STA     FMT,,AUTO

      591    11301    3                       S_D.MDW = '1'B;

  11301  1 002363   400000 236003                    LDQ     -131072,DU
         1 002364   106724 756100                    STQ     3540,,PR1

      592    11302    3                     END;

  11302  1 002365   003045 710000 1                  TRA     s:11451

      593    11303    3                  ELSE DO;

      594    11304    3                       ADDRESS = ADDRESS - 1;

  11304  1 002366   000001 336007                    LCQ     1,DL
         1 002367   200003 056100                    ASQ     ADDRESS,,AUTO

      595    11305    3                       IF ADDRESS < 0 OR SEG = 6 AND ADDRESS < %IC_RTN

  11305  1 002370   002402 604000 1                  TMI     s:11308
         1 002371   200004 235100                    LDA     SEG,,AUTO
         1 002372   000006 115007                    CMPA    6,DL
         1 002373   002403 601000 1                  TNZ     SET_FMTMDW
         1 002374   200003 235100                    LDA     ADDRESS,,AUTO
         1 002375   000016 115007                    CMPA    14,DL
         1 002376   002403 605000 1                  TPL     SET_FMTMDW
         1 002377   106714 235100                    LDA     3532,,PR1
         1 002400   000002 115007                    CMPA    2,DL
         1 002401   002403 601000 1                  TNZ     SET_FMTMDW

      596    11306    3                         AND S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      597    11307    4                       THEN DO;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:105  
      598    11308    4                            GOTO MRTN;

  11308  1 002402   004224 710000 1                  TRA     MRTN

      599    11309    4                          END;
      600    11310    3   SET_FMTMDW:         IF NOT_IS AND SEG = 9 AND DESC# = 0

  11310  1 002403   200006 234100       SET_FMTMDW   SZN     NOT_IS,,AUTO
         1 002404   003045 605000 1                  TPL     s:11451
         1 002405   200004 235100                    LDA     SEG,,AUTO
         1 002406   000011 115007                    CMPA    9,DL
         1 002407   003045 601000 1                  TNZ     s:11451
         1 002410   200005 236100                    LDQ     DESC#,,AUTO
         1 002411   003045 601000 1                  TNZ     s:11451

      601    11311    4                       THEN DO CASE (ADDRESS);

  11311  1 002412   200003 235100                    LDA     ADDRESS,,AUTO
         1 002413   000006 135007                    SBLA    6,DL
         1 002414   000017 115007                    CMPA    15,DL
         1 002415   002417 602005 1                  TNC     s:11311+5,AL
         1 002416   003045 710000 1                  TRA     s:11451
         1 002417   002436 710000 1                  TRA     s:11313
         1 002420   002442 710000 1                  TRA     s:11316
         1 002421   002452 710000 1                  TRA     s:11322
         1 002422   002452 710000 1                  TRA     s:11322
         1 002423   002452 710000 1                  TRA     s:11322
         1 002424   002452 710000 1                  TRA     s:11322
         1 002425   002452 710000 1                  TRA     s:11322
         1 002426   002442 710000 1                  TRA     s:11316
         1 002427   002446 710000 1                  TRA     s:11319
         1 002430   002436 710000 1                  TRA     s:11313
         1 002431   002446 710000 1                  TRA     s:11319
         1 002432   002446 710000 1                  TRA     s:11319
         1 002433   002436 710000 1                  TRA     s:11313
         1 002434   002446 710000 1                  TRA     s:11319
         1 002435   002436 710000 1                  TRA     s:11313
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:106  

      602    11312    4                         CASE(6, 15, 18, 20); /* R6< >S Z< >CI */

      603    11313    4                            FMT = %X_FMT;

  11313  1 002436   000015 235007                    LDA     13,DL
         1 002437   200110 755100                    STA     FMT,,AUTO

      604    11314    4                            S_D.MDW = '0'B;

  11314  1 002440   106724 450100                    STZ     3540,,PR1
         1 002441   003045 710000 1                  TRA     s:11451

      605    11315    4                         CASE(7, 13);      /* >M1 M7< */

      606    11316    4                            FMT = %BIT_FMT;

  11316  1 002442   000005 235007                    LDA     5,DL
         1 002443   200110 755100                    STA     FMT,,AUTO

      607    11317    4                            S_D.MDW = '0'B;

  11317  1 002444   106724 450100                    STZ     3540,,PR1
         1 002445   003045 710000 1                  TRA     s:11451

      608    11318    4                         CASE(14, 16, 17, 19); /* >T< >A IV< >ASV< */

      609    11319    4                            FMT = %PTR_FMT;

  11319  1 002446   000007 235007                    LDA     7,DL
         1 002447   200110 755100                    STA     FMT,,AUTO

      610    11320    4                            S_D.MDW = '1'B;

  11320  1 002450   400000 236003                    LDQ     -131072,DU
         1 002451   106724 756100                    STQ     3540,,PR1

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:107  
      611    11321    4                         END;

      612    11322    3                     END;

  11322  1 002452   003045 710000 1                  TRA     s:11451

      613    11323
      614    11324    2          CASE( 396 ); /* M@INDIRECT_PTR */ /* *P */

      615    11325
      616    11326    2             S_D.L$.FMT = %PTR_FMT;

  11326  1 002453   000007 235007                    LDA     7,DL
         1 002454   000000 471400 xsym               LDP1    S_D$
         1 002455   100127 755100                    STA     87,,PR1

      617    11327    2             GOTO TAB;

  11327  1 002456   002522 710000 1                  TRA     TAB

      618    11328
      619    11329    2          CASE( 397 ); /* M@INDIRECT_SHORTPTR */ /* *SP */

      620    11330
      621    11331    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11331  1 002457   000000 471400 xsym               LDP1    S_D$
         1 002460   106714 235100                    LDA     3532,,PR1
         1 002461   000001 115007                    CMPA    1,DL
         1 002462   002466 601000 1                  TNZ     s:11337

      622    11332    3             THEN DO;

      623    11333    3                  S_D.ERROR = 290;

  11333  1 002463   000442 235007                    LDA     290,DL
         1 002464   100013 755100                    STA     11,,PR1
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:108  

      624    11334                                                /* E@INVALID_HOSTSUBDIRECTIVE */
      625    11335    3                  ALTRETURN;

  11335  1 002465   000000 702200 xent               TSX2  ! X66_AALT

      626    11336    3                END;
      627    11337    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11337  1 002466   000002 115007                    CMPA    2,DL
         1 002467   004207 601000 1                  TNZ     MERR1

      628    11338    3                  THEN DO;

      629    11339    3                       ADDRESS = 0;

  11339  1 002470   200003 450100                    STZ     ADDRESS,,AUTO

      630    11340    3                       L6_ADDRESS.R16 = S_D.L$.L6_VALUE.OPS(0);

  11340  1 002471   100106 236100                    LDQ     70,,PR1
         1 002472   200003 676100                    ERQ     ADDRESS,,AUTO
         1 002473   177777 376007                    ANQ     65535,DL
         1 002474   200003 656100                    ERSQ    ADDRESS,,AUTO

      631    11341    3                     END;

  11341  1 002475   003045 710000 1                  TRA     s:11451

      632    11342    2                  ELSE GOTO MERR1;
      633    11343
      634    11344    2          CASE( 398 ); /* M@INDIRECT_LEFT */ /* *L */

      635    11345
      636    11346    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11346  1 002476   000000 471400 xsym               LDP1    S_D$
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:109  
         1 002477   106714 235100                    LDA     3532,,PR1
         1 002500   000002 115007                    CMPA    2,DL
         1 002501   002505 601000 1                  TNZ     s:11351

      637    11347    3             THEN DO;

      638    11348    3                  S_D.ERROR = 291;/*E@INVALID_FEPSUBDIRECTIVE*/

  11348  1 002502   000443 235007                    LDA     291,DL
         1 002503   100013 755100                    STA     11,,PR1

      639    11349    3                  ALTRETURN;

  11349  1 002504   000000 702200 xent               TSX2  ! X66_AALT

      640    11350    3                END;
      641    11351    2             S_D.L$.FMT = %OCT_FMT;

  11351  1 002505   000001 235007                    LDA     1,DL
         1 002506   100127 755100                    STA     87,,PR1

      642    11352    2             GOTO TAB;

  11352  1 002507   002522 710000 1                  TRA     TAB

      643    11353
      644    11354    2          CASE( 399 );/* M@INDIRECT_RIGHT */ /* *R */

      645    11355
      646    11356    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11356  1 002510   000000 471400 xsym               LDP1    S_D$
         1 002511   106714 235100                    LDA     3532,,PR1
         1 002512   000002 115007                    CMPA    2,DL
         1 002513   002517 601000 1                  TNZ     s:11361

      647    11357    3             THEN DO;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:110  

      648    11358    3                  S_D.ERROR = 291;/*E@INVALID_FEPSUBDIRECTIVE*/

  11358  1 002514   000443 235007                    LDA     291,DL
         1 002515   100013 755100                    STA     11,,PR1

      649    11359    3                  ALTRETURN;

  11359  1 002516   000000 702200 xent               TSX2  ! X66_AALT

      650    11360    3                END;
      651    11361    2             S_D.L$.FMT = %REL_FMT;

  11361  1 002517   000011 235007                    LDA     9,DL
         1 002520   100127 755100                    STA     87,,PR1

      652    11362    2             GOTO TAB;

  11362  1 002521   002522 710000 1                  TRA     TAB

      653    11363
      654    11364    2          CASE( 400 );     /* M@OPEN */ /* [, O, { */

      655    11365                                                /* DO NOTHING */
      656    11366    2          CASE( 395 ); /* M@INDIRECT */ /* *, <slash> */

      657    11367    2   TAB:
      658    11368    2             S_D.EIS = '0'B;

  11368  1 002522   000000 471400 xsym  TAB          LDP1    S_D$
         1 002523   106740 450100                    STZ     3552,,PR1

      659    11369    2             FMT = MACT$CMD.FORMAT;

  11369  1 002524   000002 236100                    LDQ     2,,PR0
         1 002525   000033 772000                    QRL     27
         1 002526   200110 756100                    STQ     FMT,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:111  

      660    11370    2             LVALUE = S_D.L$.VALUE.L;

  11370  1 002527   100106 235100                    LDA     70,,PR1
         1 002530   200205 755100                    STA     LVALUE,,AUTO

      661    11371    2             NOT_IS = '0'B;

  11371  1 002531   200006 450100                    STZ     NOT_IS,,AUTO

      662    11372    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11372  1 002532   106714 235100                    LDA     3532,,PR1
         1 002533   000001 115007                    CMPA    1,DL
         1 002534   002750 601000 1                  TNZ     s:11422

      663    11373    3             THEN DO CASE(S_D.L$.FMT);

  11373  1 002535   100127 235100                    LDA     87,,PR1
         1 002536   000016 115007                    CMPA    14,DL
         1 002537   002541 602005 1                  TNC     s:11373+4,AL
         1 002540   002745 710000 1                  TRA     s:11419
         1 002541   002745 710000 1                  TRA     s:11419
         1 002542   002726 710000 1                  TRA     s:11415
         1 002543   002726 710000 1                  TRA     s:11415
         1 002544   002726 710000 1                  TRA     s:11415
         1 002545   002745 710000 1                  TRA     s:11419
         1 002546   002726 710000 1                  TRA     s:11415
         1 002547   002557 710000 1                  TRA     s:11376
         1 002550   002645 710000 1                  TRA     s:11394
         1 002551   002745 710000 1                  TRA     s:11419
         1 002552   002707 710000 1                  TRA     s:11411
         1 002553   002745 710000 1                  TRA     s:11419
         1 002554   002745 710000 1                  TRA     s:11419
         1 002555   002745 710000 1                  TRA     s:11419
         1 002556   002726 710000 1                  TRA     s:11415

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:112  
      664    11374    3               CASE( %INST_FMT );

      665    11375                                                /* For now use y-field only, into IS  */
      666    11376    3                  OFFSET = 0;

  11376  1 002557   200020 450100                    STZ     OFFSET,,AUTO

      667    11377    3                  TADDRESS = LINSTR.ADDRESS;

  11377  1 002560   200205 235100                    LDA     LVALUE,,AUTO
         1 002561   000022 771000                    ARL     18
         1 002562   200021 755100                    STA     TADDRESS,,AUTO

      668    11378    3                  IF (NOT S_D.O$.NOT_IS)

  11378  1 002563   100133 234100                    SZN     91,,PR1
         1 002564   002624 604000 1                  TMI     s:11390

      669    11379    4                  THEN DO;

      670    11380    4                       IF LINSTR.TAG = 4/*IC_MOD*/ THEN OFFSET = ADDRESS;

  11380  1 002565   200205 236100                    LDQ     LVALUE,,AUTO
         1 002566   000077 376007                    ANQ     63,DL
         1 002567   000004 116007                    CMPQ    4,DL
         1 002570   002573 601000 1                  TNZ     s:11381

  11380  1 002571   200003 235100                    LDA     ADDRESS,,AUTO
         1 002572   200020 755100                    STA     OFFSET,,AUTO

      671    11381    5                       IF LINSTR.BIT29 THEN DO;

  11381  1 002573   200205 236100                    LDQ     LVALUE,,AUTO
         1 002574   000100 316007                    CANQ    64,DL
         1 002575   002624 600000 1                  TZE     s:11390

      672    11382    5                            PR = PINCRW(S_D.USS$, 16+LINSTR.PADD.PNTR)->BIT36;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:113  

  11382  1 002576   200205 236100                    LDQ     LVALUE,,AUTO
         1 002577   000041 772000                    QRL     33
         1 002600   100005 473500                    LDP3    5,,PR1
         1 002601   300020 236106                    LDQ     16,QL,PR3
         1 002602   200210 756100                    STQ     PR,,AUTO

      673    11383    5                            SEG = PR.SD.S;

  11383  1 002603   200210 236100                    LDQ     PR,,AUTO
         1 002604   000012 772000                    QRL     10
         1 002605   000003 376007                    ANQ     3,DL
         1 002606   200004 756100                    STQ     SEG,,AUTO

      674    11384    5                            DESC# = PR.SD.D;

  11384  1 002607   200210 236100                    LDQ     PR,,AUTO
         1 002610   001777 376007                    ANQ     1023,DL
         1 002611   200005 756100                    STQ     DESC#,,AUTO

      675    11385    5                            OFFSET = OFFSET + PR.AR.W;

  11385  1 002612   200210 236100                    LDQ     PR,,AUTO
         1 002613   000022 772000                    QRL     18
         1 002614   200020 036100                    ADLQ    OFFSET,,AUTO
         1 002615   200020 756100                    STQ     OFFSET,,AUTO

      676    11386    5                            NOT_IS = '1'B;

  11386  1 002616   400000 236003                    LDQ     -131072,DU
         1 002617   200006 756100                    STQ     NOT_IS,,AUTO

      677    11387    5                            TADDRESS = LINSTR.PADD.OFFSET;

  11387  1 002620   200205 236100                    LDQ     LVALUE,,AUTO
         1 002621   000003 736000                    QLS     3
         1 002622   000025 732000                    QRS     21
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:114  
         1 002623   200021 756100                    STQ     TADDRESS,,AUTO

      678    11388    5                          END;

      679    11389    4                     END;

      680    11390    3                  IF ADDRESS >= S_D.ISBASE AND S_D.ISBASE ~= 0 AND NOT(NOT_IS)

  11390  1 002624   200003 236100                    LDQ     ADDRESS,,AUTO
         1 002625   002641 604000 1                  TMI     s:11392
         1 002626   100720 116100                    CMPQ    464,,PR1
         1 002627   002641 602000 1                  TNC     s:11392
         1 002630   100720 235100                    LDA     464,,PR1
         1 002631   002641 600000 1                  TZE     s:11392
         1 002632   200006 234100                    SZN     NOT_IS,,AUTO
         1 002633   002641 604000 1                  TMI     s:11392

      681    11391    3                  THEN ADDRESS = TADDRESS + S_D.ISBASE + OFFSET;

  11391  1 002634   200021 236100                    LDQ     TADDRESS,,AUTO
         1 002635   100720 036100                    ADLQ    464,,PR1
         1 002636   200020 036100                    ADLQ    OFFSET,,AUTO
         1 002637   200003 756100                    STQ     ADDRESS,,AUTO
         1 002640   003045 710000 1                  TRA     s:11451

      682    11392    3                  ELSE ADDRESS = TADDRESS + OFFSET;

  11392  1 002641   200021 236100                    LDQ     TADDRESS,,AUTO
         1 002642   200020 036100                    ADLQ    OFFSET,,AUTO
         1 002643   200003 756100                    STQ     ADDRESS,,AUTO
         1 002644   003045 710000 1                  TRA     s:11451

      683    11393    3               CASE( %PTR_FMT );

      684    11394    3                  ADDRESS = LAR.OFFSET;

  11394  1 002645   200205 235100                    LDA     LVALUE,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:115  
         1 002646   000022 771000                    ARL     18
         1 002647   200003 755100                    STA     ADDRESS,,AUTO

      685    11395    3                  IF LAR.PLUS ~= 0

  11395  1 002650   200205 236100                    LDQ     LVALUE,,AUTO
         1 002651   770000 316007                    CANQ    -4096,DL
         1 002652   002655 600000 1                  TZE     s:11397

      686    11396    3                  THEN PLUS = '1'B;

  11396  1 002653   400000 236003                    LDQ     -131072,DU
         1 002654   200106 756100                    STQ     PLUS,,AUTO

      687    11397    3                  SEG = LAR.SEG;

  11397  1 002655   200205 236100                    LDQ     LVALUE,,AUTO
         1 002656   000012 772000                    QRL     10
         1 002657   000003 376007                    ANQ     3,DL
         1 002660   200004 756100                    STQ     SEG,,AUTO

      688    11398    3                  IF SEG = 1

  11398  1 002661   000001 116007                    CMPQ    1,DL
         1 002662   002665 601000 1                  TNZ     s:11400

      689    11399    3                  THEN SEG = 3;            /* Funny segid */

  11399  1 002663   000003 235007                    LDA     3,DL
         1 002664   200004 755100                    STA     SEG,,AUTO

      690    11400    3                  DESC# = LAR.DESC#;

  11400  1 002665   200205 236100                    LDQ     LVALUE,,AUTO
         1 002666   001777 376007                    ANQ     1023,DL
         1 002667   200005 756100                    STQ     DESC#,,AUTO

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:116  
      691    11401    3                  IF DESC# > BITBIN('1700'O)

  11401  1 002670   001701 116007                    CMPQ    961,DL
         1 002671   002675 602000 1                  TNC     s:11406

      692    11402    4                  THEN DO;

      693    11403    4                       S_D.ERROR = 84; /* E@CANTFINDSEG */

  11403  1 002672   000124 235007                    LDA     84,DL
         1 002673   100013 755100                    STA     11,,PR1

      694    11404    4                       GOTO MERR;

  11404  1 002674   004232 710000 1                  TRA     MERR

      695    11405    4                     END;
      696    11406    3                  IF SEG = 3

  11406  1 002675   200004 235100                    LDA     SEG,,AUTO
         1 002676   000003 115007                    CMPA    3,DL
         1 002677   002704 601000 1                  TNZ     s:11409
         1 002700   000000 116003                    CMPQ    0,DU
         1 002701   002704 601000 1                  TNZ     s:11409

      697    11407    3                    AND DESC# = 0
      698    11408    3                  THEN NOT_IS = '0'B;

  11408  1 002702   200006 450100                    STZ     NOT_IS,,AUTO
         1 002703   003045 710000 1                  TRA     s:11451

      699    11409    3                  ELSE NOT_IS = '1'B;

  11409  1 002704   400000 236003                    LDQ     -131072,DU
         1 002705   200006 756100                    STQ     NOT_IS,,AUTO
         1 002706   003045 710000 1                  TRA     s:11451

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:117  
      700    11410    3               CASE( %REL_FMT );

      701    11411    3                  IF ADDRESS >= S_D.ISBASE AND S_D.ISBASE ~= 0

  11411  1 002707   200003 236100                    LDQ     ADDRESS,,AUTO
         1 002710   002722 604000 1                  TMI     s:11413
         1 002711   100720 116100                    CMPQ    464,,PR1
         1 002712   002722 602000 1                  TNC     s:11413
         1 002713   100720 235100                    LDA     464,,PR1
         1 002714   002722 600000 1                  TZE     s:11413

      702    11412    3                  THEN ADDRESS = LRELVAL.RH + S_D.ISBASE;

  11412  1 002715   200205 236100                    LDQ     LVALUE,,AUTO
         1 002716   777777 376007                    ANQ     -1,DL
         1 002717   100720 036100                    ADLQ    464,,PR1
         1 002720   200003 756100                    STQ     ADDRESS,,AUTO
         1 002721   003045 710000 1                  TRA     s:11451

      703    11413    3                  ELSE ADDRESS = LRELVAL.RH;

  11413  1 002722   200205 236100                    LDQ     LVALUE,,AUTO
         1 002723   777777 376007                    ANQ     -1,DL
         1 002724   200003 756100                    STQ     ADDRESS,,AUTO
         1 002725   003045 710000 1                  TRA     s:11451

      704    11414    3               CASE( %OCT_FMT, %UINT_FMT, %SINT_FMT, %BIT_FMT, %X_FMT );

      705    11415    3                  IF ADDRESS >= S_D.ISBASE AND S_D.ISBASE ~= 0

  11415  1 002726   200003 236100                    LDQ     ADDRESS,,AUTO
         1 002727   002741 604000 1                  TMI     s:11417
         1 002730   100720 116100                    CMPQ    464,,PR1
         1 002731   002741 602000 1                  TNC     s:11417
         1 002732   100720 235100                    LDA     464,,PR1
         1 002733   002741 600000 1                  TZE     s:11417

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:118  
      706    11416    3                  THEN ADDRESS = LINSTR.ADDRESS + S_D.ISBASE;

  11416  1 002734   200205 236100                    LDQ     LVALUE,,AUTO
         1 002735   000022 772000                    QRL     18
         1 002736   100720 036100                    ADLQ    464,,PR1
         1 002737   200003 756100                    STQ     ADDRESS,,AUTO
         1 002740   003045 710000 1                  TRA     s:11451

      707    11417    3                  ELSE ADDRESS = LINSTR.ADDRESS;

  11417  1 002741   200205 235100                    LDA     LVALUE,,AUTO
         1 002742   000022 771000                    ARL     18
         1 002743   200003 755100                    STA     ADDRESS,,AUTO
         1 002744   003045 710000 1                  TRA     s:11451

      708    11418    3               CASE( ELSE );

      709    11419    3                  S_D.ERROR = 85;   /* E@CANTTAB */

  11419  1 002745   000125 235007                    LDA     85,DL
         1 002746   100013 755100                    STA     11,,PR1

      710    11420    3                  GOTO MERR;

  11420  1 002747   004232 710000 1                  TRA     MERR

      711    11421    3               END;                        /* DO  CASE(S_D.L$.FMT)  */

      712    11422    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11422  1 002750   000002 115007                    CMPA    2,DL
         1 002751   004207 601000 1                  TNZ     MERR1

      713    11423    3                  THEN DO CASE(S_D.L$.FMT);

  11423  1 002752   100127 235100                    LDA     87,,PR1
         1 002753   000016 115007                    CMPA    14,DL
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:119  
         1 002754   002756 602005 1                  TNC     s:11423+4,AL
         1 002755   003042 710000 1                  TRA     s:11445
         1 002756   003042 710000 1                  TRA     s:11445
         1 002757   003022 710000 1                  TRA     s:11438
         1 002760   003022 710000 1                  TRA     s:11438
         1 002761   003022 710000 1                  TRA     s:11438
         1 002762   003042 710000 1                  TRA     s:11445
         1 002763   003022 710000 1                  TRA     s:11438
         1 002764   002774 710000 1                  TRA     s:11425
         1 002765   003004 710000 1                  TRA     s:11432
         1 002766   003042 710000 1                  TRA     s:11445
         1 002767   003004 710000 1                  TRA     s:11432
         1 002770   003042 710000 1                  TRA     s:11445
         1 002771   003042 710000 1                  TRA     s:11445
         1 002772   003042 710000 1                  TRA     s:11445
         1 002773   003022 710000 1                  TRA     s:11438

      714    11424    3                    CASE( %INST_FMT );

      715    11425    3                       IF S_D.L6_TAB

  11425  1 002774   106734 234100                    SZN     3548,,PR1
         1 002775   003001 605000 1                  TPL     s:11428

      716    11426    3                       THEN ADDRESS = S_D.L6_TAB_VALUE;

  11426  1 002776   106735 235100                    LDA     3549,,PR1
         1 002777   200003 755100                    STA     ADDRESS,,AUTO
         1 003000   003045 710000 1                  TRA     s:11451

      717    11427    4                       ELSE DO;

      718    11428    4                            S_D.ERROR = 340; /* E@NOTAB */

  11428  1 003001   000524 235007                    LDA     340,DL
         1 003002   100013 755100                    STA     11,,PR1

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:120  
      719    11429    4                            GOTO MERR;

  11429  1 003003   004232 710000 1                  TRA     MERR

      720    11430    4                          END;
      721    11431    3                    CASE( %PTR_FMT, %REL_FMT );

      722    11432    3                       ADDRESS = 0;

  11432  1 003004   200003 450100                    STZ     ADDRESS,,AUTO

      723    11433    3                       SEG = 3;

  11433  1 003005   000003 235007                    LDA     3,DL
         1 003006   200004 755100                    STA     SEG,,AUTO

      724    11434    3                       DESC# = 0;

  11434  1 003007   200005 450100                    STZ     DESC#,,AUTO

      725    11435    3                       L6_ADDRESS.L4 = S_D.L$.L6_VALUE.OPS(0);

  11435  1 003010   100106 236100                    LDQ     70,,PR1
         1 003011   000020 736000                    QLS     16
         1 003012   200003 676100                    ERQ     ADDRESS,,AUTO
         1 003013   000041 376000 2                  ANQ     33
         1 003014   200003 656100                    ERSQ    ADDRESS,,AUTO

      726    11436    3                       L6_ADDRESS.R16 = S_D.L$.L6_VALUE.OPS(1);

  11436  1 003015   100107 236100                    LDQ     71,,PR1
         1 003016   200003 676100                    ERQ     ADDRESS,,AUTO
         1 003017   177777 376007                    ANQ     65535,DL
         1 003020   200003 656100                    ERSQ    ADDRESS,,AUTO
         1 003021   003045 710000 1                  TRA     s:11451

      727    11437    3                    CASE( %OCT_FMT, %UINT_FMT, %SINT_FMT, %BIT_FMT, %X_FMT );
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:121  

      728    11438    3                       IF S_D.L$.SIZE <= 16

  11438  1 003022   100126 235100                    LDA     86,,PR1
         1 003023   000020 115007                    CMPA    16,DL
         1 003024   003030 605400 1                  TPNZ    s:11441

      729    11439    3                       THEN ADDRESS = S_D.L$.L6_VALUE.OPS(0);

  11439  1 003025   100106 235100                    LDA     70,,PR1
         1 003026   200003 755100                    STA     ADDRESS,,AUTO
         1 003027   003045 710000 1                  TRA     s:11451

      730    11440    4                       ELSE DO;

      731    11441    4                            L6_ADDRESS.L4 = S_D.L$.L6_VALUE.OPS(0);

  11441  1 003030   100106 236100                    LDQ     70,,PR1
         1 003031   000020 736000                    QLS     16
         1 003032   200003 676100                    ERQ     ADDRESS,,AUTO
         1 003033   000041 376000 2                  ANQ     33
         1 003034   200003 656100                    ERSQ    ADDRESS,,AUTO

      732    11442    4                            L6_ADDRESS.R16 = S_D.L$.L6_VALUE.OPS(1);

  11442  1 003035   100107 236100                    LDQ     71,,PR1
         1 003036   200003 676100                    ERQ     ADDRESS,,AUTO
         1 003037   177777 376007                    ANQ     65535,DL
         1 003040   200003 656100                    ERSQ    ADDRESS,,AUTO

      733    11443    4                          END;

  11443  1 003041   003045 710000 1                  TRA     s:11451

      734    11444    3                    CASE (ELSE );

      735    11445    3                       S_D.ERROR = 85; /* E@CANTTAB */
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:122  

  11445  1 003042   000125 235007                    LDA     85,DL
         1 003043   100013 755100                    STA     11,,PR1

      736    11446    3                       GOTO MERR;

  11446  1 003044   004232 710000 1                  TRA     MERR

      737    11447    3                    END;

      738    11448    2                  ELSE
      739    11449    2                       GOTO MERR1;
      740    11450    2          END;                             /* DO  CASE(CASECODE)  */

      741    11451    1        IF S_D.RUM

  11451  1 003045   000000 471400 xsym               LDP1    S_D$
         1 003046   104755 234100                    SZN     2541,,PR1
         1 003047   003104 605000 1                  TPL     s:11459

      742    11452    2        THEN DO;

      743    11453    2             NODE = 0;

  11453  1 003050   200014 450100                    STZ     NODE,,AUTO

      744    11454    2             IF S_D.OVERLAID

  11454  1 003051   104764 234100                    SZN     2548,,PR1
         1 003052   003063 605000 1                  TPL     s:11456

      745    11455    2             THEN CALL DDS$IC2NODE( ADDRESS, NODE ) ALTRET( MERR );

  11455  1 003053   200014 633500                    EPPR3   NODE,,AUTO
         1 003054   200231 453500                    STP3    DUM2+2,,AUTO
         1 003055   200003 634500                    EPPR4   ADDRESS,,AUTO
         1 003056   200230 454500                    STP4    DUM2+1,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:123  
         1 003057   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003060   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003061   000000 701000 xent               TSX1    DDS$IC2NODE
         1 003062   004232 702000 1                  TSX2    MERR

      746    11456    2             CALL DUU$GETMVAL(NVALUE, NODE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(MERR);

  11456  1 003063   200006 630500                    EPPR0   NOT_IS,,AUTO
         1 003064   200235 450500                    STP0    DUM2+6,,AUTO
         1 003065   200005 631500                    EPPR1   DESC#,,AUTO
         1 003066   200234 451500                    STP1    DUM2+5,,AUTO
         1 003067   200004 633500                    EPPR3   SEG,,AUTO
         1 003070   200233 453500                    STP3    DUM2+4,,AUTO
         1 003071   200003 634500                    EPPR4   ADDRESS,,AUTO
         1 003072   200232 454500                    STP4    DUM2+3,,AUTO
         1 003073   200014 635500                    EPPR5   NODE,,AUTO
         1 003074   200231 455500                    STP5    DUM2+2,,AUTO
         1 003075   200044 636500                    EPPR6   NVALUE,,AUTO
         1 003076   200230 456500                    STP6    DUM2+1,,AUTO
         1 003077   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003100   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 003101   000000 701000 xent               TSX1    DUU$GETMVAL
         1 003102   004232 702000 1                  TSX2    MERR

      747    11457    2           END;

  11457  1 003103   003174 710000 1                  TRA     s:11468

      748    11458    2        ELSE DO;

      749    11459    2             NVALUE.SIZE = 1;

  11459  1 003104   000001 235007                    LDA     1,DL
         1 003105   200044 755100                    STA     NVALUE,,AUTO

      750    11460    2             IF S_D.ANLZ_FILE

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:124  
  11460  1 003106   105052 234100                    SZN     2602,,PR1
         1 003107   003127 605000 1                  TPL     s:11462

      751    11461    2             THEN CALL DUL$GETMVAL(NVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS) ALTRET(
             11461                      MERR);

  11461  1 003110   200006 633500                    EPPR3   NOT_IS,,AUTO
         1 003111   200234 453500                    STP3    DUM2+5,,AUTO
         1 003112   200005 634500                    EPPR4   DESC#,,AUTO
         1 003113   200233 454500                    STP4    DUM2+4,,AUTO
         1 003114   200004 635500                    EPPR5   SEG,,AUTO
         1 003115   200232 455500                    STP5    DUM2+3,,AUTO
         1 003116   200003 636500                    EPPR6   ADDRESS,,AUTO
         1 003117   200231 456500                    STP6    DUM2+2,,AUTO
         1 003120   200045 637500                    EPPR7   NVALUE+1,,AUTO
         1 003121   200230 457500                    STP7    DUM2+1,,AUTO
         1 003122   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003123   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 003124   000000 701000 xent               TSX1    DUL$GETMVAL
         1 003125   004232 702000 1                  TSX2    MERR
         1 003126   003174 710000 1                  TRA     s:11468

      752    11462    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11462  1 003127   106714 235100                    LDA     3532,,PR1
         1 003130   000001 115007                    CMPA    1,DL
         1 003131   003151 601000 1                  TNZ     s:11464

      753    11463    2                  THEN CALL DDK$GETMVAL(NVALUE.OPS(0), ADDRESS, SEG, DESC#, NOT_IS)
             11463                           ALTRET(MERR);

  11463  1 003132   200006 633500                    EPPR3   NOT_IS,,AUTO
         1 003133   200234 453500                    STP3    DUM2+5,,AUTO
         1 003134   200005 634500                    EPPR4   DESC#,,AUTO
         1 003135   200233 454500                    STP4    DUM2+4,,AUTO
         1 003136   200004 635500                    EPPR5   SEG,,AUTO
         1 003137   200232 455500                    STP5    DUM2+3,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:125  
         1 003140   200003 636500                    EPPR6   ADDRESS,,AUTO
         1 003141   200231 456500                    STP6    DUM2+2,,AUTO
         1 003142   200045 637500                    EPPR7   NVALUE+1,,AUTO
         1 003143   200230 457500                    STP7    DUM2+1,,AUTO
         1 003144   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003145   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 003146   000000 701000 xent               TSX1    DDK$GETMVAL
         1 003147   004232 702000 1                  TSX2    MERR
         1 003150   003174 710000 1                  TRA     s:11468

      754    11464    2                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11464  1 003151   000002 115007                    CMPA    2,DL
         1 003152   004207 601000 1                  TNZ     MERR1

      755    11465    2                      THEN CALL DFK$GETMVAL(NVALUE, ADDRESS, SEG, DESC#, NOT_IS, '1'B)
             11465                                ALTRET(MERR);

  11465  1 003153   000000 236000 2                  LDQ     0
         1 003154   200235 756100                    STQ     DUM2+6,,AUTO
         1 003155   200006 633500                    EPPR3   NOT_IS,,AUTO
         1 003156   200234 453500                    STP3    DUM2+5,,AUTO
         1 003157   200005 634500                    EPPR4   DESC#,,AUTO
         1 003160   200233 454500                    STP4    DUM2+4,,AUTO
         1 003161   200004 635500                    EPPR5   SEG,,AUTO
         1 003162   200232 455500                    STP5    DUM2+3,,AUTO
         1 003163   200003 636500                    EPPR6   ADDRESS,,AUTO
         1 003164   200231 456500                    STP6    DUM2+2,,AUTO
         1 003165   200044 637500                    EPPR7   NVALUE,,AUTO
         1 003166   200230 457500                    STP7    DUM2+1,,AUTO
         1 003167   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003170   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 003171   000000 701000 xent               TSX1    DFK$GETMVAL
         1 003172   004232 702000 1                  TSX2    MERR
         1 003173   003174 710000 1                  TRA     s:11468

      756    11466    2                       ELSE GOTO MERR1;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:126  
      757    11467    2           END;
      758    11468    1        MACTIVE = '1'B;

  11468  1 003174   400000 236003                    LDQ     -131072,DU
         1 003175   200015 756100                    STQ     MACTIVE,,AUTO

      759    11469                                                /**/
      760    11470    1   DISPMOD:                                /* All MODIFY  commands end up here */
      761    11471                                                /**/
      762    11472    1        IF NOT NMSLASH

  11472  1 003176   200201 234100       DISPMOD      SZN     NMSLASH,,AUTO
         1 003177   003214 604000 1                  TMI     s:11480

      763    11473    2        THEN DO;

      764    11474    2             S_D.O$.ADDRESS = ADDRESS;

  11474  1 003200   200003 235100                    LDA     ADDRESS,,AUTO
         1 003201   000000 470400 xsym               LDP0    S_D$
         1 003202   000132 755100                    STA     90,,PR0

      765    11475    2             S_D.O$.SEG = SEG;

  11475  1 003203   200004 236100                    LDQ     SEG,,AUTO
         1 003204   000130 756100                    STQ     88,,PR0

      766    11476    2             S_D.O$.DESC# = DESC#;

  11476  1 003205   200005 235100                    LDA     DESC#,,AUTO
         1 003206   000131 755100                    STA     89,,PR0

      767    11477    2             S_D.O$.NOT_IS = NOT_IS;

  11477  1 003207   003100 060500                    CSL     bolr='003'O
         1 003210   200006 000001                    BDSC    NOT_IS,,AUTO             by=0,bit=0,n=1
         1 003211   200230 000044                    BDSC    DUM2+1,,AUTO             by=0,bit=0,n=36
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:127  
         1 003212   200230 220100                    LDX0    DUM2+1,,AUTO
         1 003213   000133 740100                    STX0    91,,PR0

      768    11478    2           END;

      769    11479                                                /**/
      770    11480    1        S_D.D$ = ADDR(S_D.OUTPUT);

  11480  1 003214   000000 236000 xsym               LDQ     S_D$
         1 003215   005335 036003                    ADLQ    2781,DU
         1 003216   000000 470400 xsym               LDP0    S_D$
         1 003217   000044 756100                    STQ     36,,PR0

      771    11481    1        S_D.OUTPUT = ' ';

  11481  1 003220   040100 100400                    MLR     fill='040'O
         1 003221   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 003222   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      772    11482    1        S_D.DESCL$ = PINCRC(S_D.D$, LENGTHC(S_D.OUTPUT));

  11482  1 003223   001000 036003                    ADLQ    512,DU
         1 003224   000042 756100                    STQ     34,,PR0

      773    11483    1        S_D.FNDENTDEF = '0'B;

  11483  1 003225   000721 450100                    STZ     465,,PR0

      774    11484    1        CALL DDA$DISPADR(ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT,,36) ALTRET(MERR);

  11484  1 003226   000013 236000 2                  LDQ     11
         1 003227   200236 756100                    STQ     DUM2+7,,AUTO
         1 003230   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 003231   000042 235000 2                  LDA     34
         1 003232   200234 757100                    STAQ    DUM2+5,,AUTO
         1 003233   200006 631500                    EPPR1   NOT_IS,,AUTO
         1 003234   200233 451500                    STP1    DUM2+4,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:128  
         1 003235   200005 633500                    EPPR3   DESC#,,AUTO
         1 003236   200232 453500                    STP3    DUM2+3,,AUTO
         1 003237   200004 634500                    EPPR4   SEG,,AUTO
         1 003240   200231 454500                    STP4    DUM2+2,,AUTO
         1 003241   200003 635500                    EPPR5   ADDRESS,,AUTO
         1 003242   200230 455500                    STP5    DUM2+1,,AUTO
         1 003243   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003244   000025 631400 xsym               EPPR1   B_VECTNIL+21
         1 003245   000000 701000 xent               TSX1    DDA$DISPADR
         1 003246   004232 702000 1                  TSX2    MERR

      775    11485    1        CALL DDS$SET_Q2D;

  11485  1 003247   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003250   000000 701000 xent               TSX1    DDS$SET_Q2D
         1 003251   000000 011000                    NOP     0

      776    11486    1        TEXT$ = S_D.D$;

  11486  1 003252   000000 470400 xsym               LDP0    S_D$
         1 003253   000044 236100                    LDQ     36,,PR0
         1 003254   200175 756100                    STQ     TEXT$,,AUTO

      777    11487    1        IF MACTIVE AND (S_D.RUM OR S_D.ANLZ)

  11487  1 003255   200015 234100                    SZN     MACTIVE,,AUTO
         1 003256   003306 605000 1                  TPL     s:11495
         1 003257   004755 234100                    SZN     2541,,PR0
         1 003260   003263 604000 1                  TMI     s:11489
         1 003261   004756 234100                    SZN     2542,,PR0
         1 003262   003306 605000 1                  TPL     s:11495

      778    11488    2        THEN DO;                 /* Remember old address and previous contents */

      779    11489    2             NCHARS = POFFC(TEXT$, ADDR(S_D.OUTPUT));

  11489  1 003263   000000 236000 xsym               LDQ     S_D$
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:129  
         1 003264   005335 036003                    ADLQ    2781,DU
         1 003265   000020 772000                    QRL     16
         1 003266   200230 756100                    STQ     DUM2+1,,AUTO
         1 003267   200175 236100                    LDQ     TEXT$,,AUTO
         1 003270   000020 772000                    QRL     16
         1 003271   200230 136100                    SBLQ    DUM2+1,,AUTO
         1 003272   200176 756100                    STQ     NCHARS,,AUTO

      780    11490    2             S_D.PCHARS = NCHARS;

  11490  1 003273   005047 756100                    STQ     2599,,PR0

      781    11491    2             S_D.PIMAGE = ' ';

  11491  1 003274   040100 100400                    MLR     fill='040'O
         1 003275   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 003276   005011 000170                    ADSC9   2569,,PR0                cn=0,n=120

      782    11492    2             ADDR(S_D.PIMAGE) -> TEXTR = S_D.OUTPUT;

  11492  1 003277   000000 620006                    EAX0    0,QL
         1 003300   040140 100500                    MLR     fill='040'O
         1 003301   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048
         1 003302   005011 000010                    ADSC9   2569,,PR0                cn=0,n=*X0

      783    11493    2             S_D.POVALUE = NVALUE;

  11493  1 003303   000100 100500                    MLR     fill='000'O
         1 003304   200044 000104                    ADSC9   NVALUE,,AUTO             cn=0,n=68
         1 003305   005111 000104                    ADSC9   2633,,PR0                cn=0,n=68

      784    11494    2           END;

      785    11495    1        CALL DDR$BUMPC_D$(2) ALTRET(MERR1);

  11495  1 003306   000030 630400 2                  EPPR0   24
         1 003307   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:130  
         1 003310   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003311   004207 702000 1                  TSX2    MERR1

      786    11496    1        TEXT$ -> CHAR2 = '/ ';

  11496  1 003312   200175 470500                    LDP0    TEXT$,,AUTO
         1 003313   040100 100400                    MLR     fill='040'O
         1 003314   000000 000002 0                  ADSC9   0                        cn=0,n=2
         1 003315   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      787    11497    1        IF SUPADR

  11497  1 003316   200200 234100                    SZN     SUPADR,,AUTO
         1 003317   003324 605000 1                  TPL     s:11499

      788    11498    1        THEN S_D.D$ = ADDR(S_D.OUTPUT);    /* '/' activation */

  11498  1 003320   000000 236000 xsym               LDQ     S_D$
         1 003321   005335 036003                    ADLQ    2781,DU
         1 003322   000000 471400 xsym               LDP1    S_D$
         1 003323   100044 756100                    STQ     36,,PR1

      789    11499    1        IF (FMT = %DEFAULT_FMT OR FMT = %INST_FMT)

  11499  1 003324   200110 235100                    LDA     FMT,,AUTO
         1 003325   000037 115007                    CMPA    31,DL
         1 003326   003331 600000 1                  TZE     s:11499+5
         1 003327   000006 115007                    CMPA    6,DL
         1 003330   003346 601000 1                  TNZ     s:11506
         1 003331   000000 471400 xsym               LDP1    S_D$
         1 003332   200003 236100                    LDQ     ADDRESS,,AUTO
         1 003333   003346 604000 1                  TMI     s:11506
         1 003334   100720 116100                    CMPQ    464,,PR1
         1 003335   003346 602000 1                  TNC     s:11506
         1 003336   100720 235100                    LDA     464,,PR1
         1 003337   003346 600000 1                  TZE     s:11506

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:131  
      790    11500    1          AND ADDRESS >= S_D.ISBASE AND S_D.ISBASE ~= 0
      791    11501    2        THEN DO;

      792    11502    2             FMT = %INST_FMT;

  11502  1 003340   000006 235007                    LDA     6,DL
         1 003341   200110 755100                    STA     FMT,,AUTO

      793    11503    2             S_D.KILLEDEF = '1'B;

  11503  1 003342   400000 236003                    LDQ     -131072,DU
         1 003343   100105 756100                    STQ     69,,PR1

      794    11504    2             S_D.MDW = '0'B;

  11504  1 003344   106724 450100                    STZ     3540,,PR1

      795    11505    2           END;

  11505  1 003345   003362 710000 1                  TRA     s:11513

      796    11506    1        ELSE IF FMT = %DEFAULT_FMT

  11506  1 003346   200110 235100                    LDA     FMT,,AUTO
         1 003347   000037 115007                    CMPA    31,DL
         1 003350   003362 601000 1                  TNZ     s:11513

      797    11507    1             THEN IF S_D.FNDENTDEF /* ( set by DDR$POSIT called by DDA$DISPADR ) */

  11507  1 003351   000000 471400 xsym               LDP1    S_D$
         1 003352   100721 234100                    SZN     465,,PR1
         1 003353   003360 605000 1                  TPL     s:11512

      798    11508    2                  THEN DO;

      799    11509    2                       FMT = %INST_FMT;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:132  
  11509  1 003354   000006 236007                    LDQ     6,DL
         1 003355   200110 756100                    STQ     FMT,,AUTO

      800    11510    2                       S_D.MDW = '0'B;

  11510  1 003356   106724 450100                    STZ     3540,,PR1

      801    11511    2                     END;

  11511  1 003357   003362 710000 1                  TRA     s:11513

      802    11512    1                  ELSE FMT = S_D.FMT_DEFAULT;

  11512  1 003360   100723 235100                    LDA     467,,PR1
         1 003361   200110 755100                    STA     FMT,,AUTO

      803    11513    1        S_D.POFMT = FMT; /* Remember old format in case we're interactively RUMing */

  11513  1 003362   000000 471400 xsym               LDP1    S_D$
         1 003363   200110 235100                    LDA     FMT,,AUTO
         1 003364   105132 755100                    STA     2650,,PR1

      804    11514    1        IF FMT = %L$_FMT

  11514  1 003365   000017 115007                    CMPA    15,DL
         1 003366   003371 601000 1                  TNZ     s:11516

      805    11515    1        THEN FMT = S_D.L$.FMT;

  11515  1 003367   100127 235100                    LDA     87,,PR1
         1 003370   200110 755100                    STA     FMT,,AUTO

      806    11516    1        IF NOT NMSLASH

  11516  1 003371   200201 234100                    SZN     NMSLASH,,AUTO
         1 003372   003375 604000 1                  TMI     s:11518

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:133  
      807    11517    1        THEN S_D.O$.FMT = FMT;

  11517  1 003373   000000 620005                    EAX0    0,AL
         1 003374   100133 440100                    SXL0    91,,PR1

      808    11518    1        S_D.L$.FMT = FMT;

  11518  1 003375   200110 235100                    LDA     FMT,,AUTO
         1 003376   100127 755100                    STA     87,,PR1

      809    11519    1        S_D.L$.VALUE = NVALUE.OPS;

  11519  1 003377   000100 100500                    MLR     fill='000'O
         1 003400   200045 000100                    ADSC9   NVALUE+1,,AUTO           cn=0,n=64
         1 003401   100106 000100                    ADSC9   70,,PR1                  cn=0,n=64

      810    11520    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11520  1 003402   106714 235100                    LDA     3532,,PR1
         1 003403   000001 115007                    CMPA    1,DL
         1 003404   003410 601000 1                  TNZ     s:11522

      811    11521    1        THEN S_D.L$.SIZE = 36;

  11521  1 003405   000044 236007                    LDQ     36,DL
         1 003406   100126 756100                    STQ     86,,PR1
         1 003407   003463 710000 1                  TRA     s:11538

      812    11522    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  11522  1 003410   000002 115007                    CMPA    2,DL
         1 003411   003463 601000 1                  TNZ     s:11538

      813    11523    2             THEN DO;

      814    11524    2                  IF FMT = %INST_FMT AND NOT S_D.MDW

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:134  
  11524  1 003412   200110 236100                    LDQ     FMT,,AUTO
         1 003413   000006 116007                    CMPQ    6,DL
         1 003414   003437 601000 1                  TNZ     NOTINSTR
         1 003415   106724 234100                    SZN     3540,,PR1
         1 003416   003437 604000 1                  TMI     NOTINSTR

      815    11525    3                  THEN DO;

      816    11526    3                       CALL DFR$INSTR (NVALUE.OPS, S_D.L$.SIZE, '0'B, '1'B) ALTRET(
             11526                                NOTINSTR);

  11526  1 003417   000026 237000 2                  LDAQ    22
         1 003420   200232 757100                    STAQ    DUM2+3,,AUTO
         1 003421   000000 236000 xsym               LDQ     S_D$
         1 003422   000126 036003                    ADLQ    86,DU
         1 003423   200231 756100                    STQ     DUM2+2,,AUTO
         1 003424   200045 633500                    EPPR3   NVALUE+1,,AUTO
         1 003425   200230 453500                    STP3    DUM2+1,,AUTO
         1 003426   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003427   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 003430   000000 701000 xent               TSX1    DFR$INSTR
         1 003431   003437 702000 1                  TSX2    NOTINSTR

      817    11527    3                       S_D.L$.SIZE = S_D.L$.SIZE * 16;

  11527  1 003432   000000 470400 xsym               LDP0    S_D$
         1 003433   000126 235100                    LDA     86,,PR0
         1 003434   000004 735000                    ALS     4
         1 003435   000126 755100                    STA     86,,PR0

      818    11528    3                     END;

  11528  1 003436   003463 710000 1                  TRA     s:11538

      819    11529    3                  ELSE DO;

      820    11530    3   NOTINSTR:
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:135  
      821    11531    3                       IF S_D.MDW = '1'B OR FMT = %PTR_FMT

  11531  1 003437   000000 470400 xsym  NOTINSTR     LDP0    S_D$
         1 003440   006724 234100                    SZN     3540,,PR0
         1 003441   003445 604000 1                  TMI     s:11532
         1 003442   200110 235100                    LDA     FMT,,AUTO
         1 003443   000007 115007                    CMPA    7,DL
         1 003444   003450 601000 1                  TNZ     s:11533

      822    11532    3                       THEN S_D.L$.SIZE = 2 * 16;

  11532  1 003445   000040 235007                    LDA     32,DL
         1 003446   000126 755100                    STA     86,,PR0
         1 003447   003452 710000 1                  TRA     s:11534

      823    11533    3                       ELSE S_D.L$.SIZE = 1 * 16;

  11533  1 003450   000020 236007                    LDQ     16,DL
         1 003451   000126 756100                    STQ     86,,PR0

      824    11534    3                       IF SEG = 6 OR SEG = 7 OR SEG = 10

  11534  1 003452   200004 235100                    LDA     SEG,,AUTO
         1 003453   000006 115007                    CMPA    6,DL
         1 003454   003461 600000 1                  TZE     s:11535
         1 003455   000007 115007                    CMPA    7,DL
         1 003456   003461 600000 1                  TZE     s:11535
         1 003457   000012 115007                    CMPA    10,DL
         1 003460   003463 601000 1                  TNZ     s:11538

      825    11535    3                       THEN S_D.L$.SIZE = 32;

  11535  1 003461   000040 236007                    LDQ     32,DL
         1 003462   000126 756100                    STQ     86,,PR0

      826    11536    3                     END;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:136  
      827    11537    2                END;

      828    11538    1        IF MACTIVE

  11538  1 003463   200015 234100                    SZN     MACTIVE,,AUTO
         1 003464   003472 605000 1                  TPL     s:11541

      829    11539    1        THEN
      830    11540    1             S_D.MACTIVE = ~ S_D.ALIB_SAID_GOBACK;

  11540  1 003465   000000 470400 xsym               LDP0    S_D$
         1 003466   000075 236100                    LDQ     61,,PR0
         1 003467   400000 376003                    ANQ     -131072,DU
         1 003470   400000 676003                    ERQ     -131072,DU
         1 003471   000713 756100                    STQ     459,,PR0

      831    11541    1        CALL DDA$DISPFMT(FMT, S_D.L$.SIZE, NVALUE.OPS) ALTRET(MERR);

  11541  1 003472   200045 630500                    EPPR0   NVALUE+1,,AUTO
         1 003473   200232 450500                    STP0    DUM2+3,,AUTO
         1 003474   000000 236000 xsym               LDQ     S_D$
         1 003475   000126 036003                    ADLQ    86,DU
         1 003476   200231 756100                    STQ     DUM2+2,,AUTO
         1 003477   200110 631500                    EPPR1   FMT,,AUTO
         1 003500   200230 451500                    STP1    DUM2+1,,AUTO
         1 003501   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003502   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003503   000000 701000 xent               TSX1    DDA$DISPFMT
         1 003504   004232 702000 1                  TSX2    MERR

      832    11542    1        IF FMT = %INST_FMT

  11542  1 003505   200110 235100                    LDA     FMT,,AUTO
         1 003506   000006 115007                    CMPA    6,DL
         1 003507   003526 601000 1                  TNZ     NOTINS

      833    11543    2        THEN DO;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:137  

      834    11544    2             CALL DFR$INSTR (OVALUE.OPS, TSIZE, '0'B) ALTRET(NOTINS);

  11544  1 003510   000026 236000 2                  LDQ     22
         1 003511   200232 756100                    STQ     DUM2+3,,AUTO
         1 003512   200203 630500                    EPPR0   TSIZE,,AUTO
         1 003513   200231 450500                    STP0    DUM2+2,,AUTO
         1 003514   200024 631500                    EPPR1   OVALUE+1,,AUTO
         1 003515   200230 451500                    STP1    DUM2+1,,AUTO
         1 003516   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003517   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003520   000000 701000 xent               TSX1    DFR$INSTR
         1 003521   003526 702000 1                  TSX2    NOTINS

      835    11545    2             TSIZE = TSIZE * 16;

  11545  1 003522   200203 235100                    LDA     TSIZE,,AUTO
         1 003523   000004 735000                    ALS     4
         1 003524   200203 755100                    STA     TSIZE,,AUTO

      836    11546    2           END;

  11546  1 003525   003531 710000 1                  TRA     s:11551

      837    11547    2        ELSE DO;

      838    11548    2   NOTINS:
      839    11549    2             TSIZE = S_D.L$.SIZE;

  11549  1 003526   000000 470400 xsym  NOTINS       LDP0    S_D$
         1 003527   000126 235100                    LDA     86,,PR0
         1 003530   200203 755100                    STA     TSIZE,,AUTO

      840    11550    2           END;

      841    11551    1        IF SETNA$

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:138  
  11551  1 003531   200202 234100                    SZN     SETNA$,,AUTO
         1 003532   003543 605000 1                  TPL     s:11556

      842    11552    2        THEN DO;

      843    11553    2             S_D.NA$ = S_D.NA$ + (S_D.L$.SIZE / 16);

  11553  1 003533   000000 470400 xsym               LDP0    S_D$
         1 003534   000126 236100                    LDQ     86,,PR0
         1 003535   000020 506007                    DIV     16,DL
         1 003536   005107 036100                    ADLQ    2631,,PR0
         1 003537   005107 756100                    STQ     2631,,PR0

      844    11554    2             S_D.RI$.SIZE = TSIZE / 16;

  11554  1 003540   200203 236100                    LDQ     TSIZE,,AUTO
         1 003541   000004 772000                    QRL     4
         1 003542   005066 756100                    STQ     2614,,PR0

      845    11555    2           END;

      846    11556    1        IF NOT NMSLASH

  11556  1 003543   200201 234100                    SZN     NMSLASH,,AUTO
         1 003544   003551 604000 1                  TMI     s:11558

      847    11557    1        THEN S_D.O$SIZE = S_D.L$.SIZE / 16;

  11557  1 003545   000000 470400 xsym               LDP0    S_D$
         1 003546   000126 236100                    LDQ     86,,PR0
         1 003547   000020 506007                    DIV     16,DL
         1 003550   006763 756100                    STQ     3571,,PR0

      848    11558    1        IF NOT MACTIVE

  11558  1 003551   200015 234100                    SZN     MACTIVE,,AUTO
         1 003552   003632 604000 1                  TMI     s:11570
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:139  

      849    11559    2        THEN DO;

      850    11560    2             TEXT$ = S_D.D$;

  11560  1 003553   000000 470400 xsym               LDP0    S_D$
         1 003554   000044 236100                    LDQ     36,,PR0
         1 003555   200175 756100                    STQ     TEXT$,,AUTO

      851    11561    2             CALL DDR$BUMPC_D$(2) ALTRET(MERR1);

  11561  1 003556   000030 630400 2                  EPPR0   24
         1 003557   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003560   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003561   004207 702000 1                  TSX2    MERR1

      852    11562    2             TEXT$ -> CHAR2 = ' (';

  11562  1 003562   200175 470500                    LDP0    TEXT$,,AUTO
         1 003563   040100 100400                    MLR     fill='040'O
         1 003564   000001 000002 0                  ADSC9   1                        cn=0,n=2
         1 003565   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      853    11563    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11563  1 003566   000000 471400 xsym               LDP1    S_D$
         1 003567   106714 235100                    LDA     3532,,PR1
         1 003570   000001 115007                    CMPA    1,DL
         1 003571   003605 601000 1                  TNZ     s:11565

      854    11564    2             THEN CALL DDA$DISPFMT(FMT, 36, OVALUE.OPS) ALTRET(MERR1);

  11564  1 003572   200024 633500                    EPPR3   OVALUE+1,,AUTO
         1 003573   200232 453500                    STP3    DUM2+3,,AUTO
         1 003574   000013 236000 2                  LDQ     11
         1 003575   200231 756100                    STQ     DUM2+2,,AUTO
         1 003576   200110 634500                    EPPR4   FMT,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:140  
         1 003577   200230 454500                    STP4    DUM2+1,,AUTO
         1 003600   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003601   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003602   000000 701000 xent               TSX1    DDA$DISPFMT
         1 003603   004207 702000 1                  TSX2    MERR1
         1 003604   003617 710000 1                  TRA     s:11566

      855    11565    2             ELSE CALL DDA$DISPFMT(FMT, TSIZE, OVALUE.OPS) ALTRET(MERR1);

  11565  1 003605   200024 633500                    EPPR3   OVALUE+1,,AUTO
         1 003606   200232 453500                    STP3    DUM2+3,,AUTO
         1 003607   200203 634500                    EPPR4   TSIZE,,AUTO
         1 003610   200231 454500                    STP4    DUM2+2,,AUTO
         1 003611   200110 635500                    EPPR5   FMT,,AUTO
         1 003612   200230 455500                    STP5    DUM2+1,,AUTO
         1 003613   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003614   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003615   000000 701000 xent               TSX1    DDA$DISPFMT
         1 003616   004207 702000 1                  TSX2    MERR1

      856    11566    2             TEXT$ = S_D.D$;

  11566  1 003617   000000 470400 xsym               LDP0    S_D$
         1 003620   000044 236100                    LDQ     36,,PR0
         1 003621   200175 756100                    STQ     TEXT$,,AUTO

      857    11567    2             CALL DDR$BUMPC_D$(1) ALTRET(MERR1);

  11567  1 003622   000012 630400 2                  EPPR0   10
         1 003623   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003624   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003625   004207 702000 1                  TSX2    MERR1

      858    11568    2             TEXT$ -> CHAR1 = ')';

  11568  1 003626   200175 470500                    LDP0    TEXT$,,AUTO
         1 003627   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:141  
         1 003630   000031 000001 2                  ADSC9   25                       cn=0,n=1
         1 003631   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      859    11569    2           END;                            /* if NOT MACTIVE */

      860    11570    1        START$ = ADDR( S_D.OUTPUT );

  11570  1 003632   000000 236000 xsym               LDQ     S_D$
         1 003633   005335 036003                    ADLQ    2781,DU
         1 003634   200111 756100                    STQ     START$,,AUTO

      861    11571    1        TEMP = POFFC( S_D.D$, START$ );

  11571  1 003635   200111 236100                    LDQ     START$,,AUTO
         1 003636   000020 772000                    QRL     16
         1 003637   200230 756100                    STQ     DUM2+1,,AUTO
         1 003640   000000 470400 xsym               LDP0    S_D$
         1 003641   000044 236100                    LDQ     36,,PR0
         1 003642   000020 772000                    QRL     16
         1 003643   200230 136100                    SBLQ    DUM2+1,,AUTO
         1 003644   200204 756100                    STQ     TEMP,,AUTO

      862    11572    1        IF S_D.SILENT THEN RETURN;         /* ATTACHENT TO SILENT BREAKPOINT */

  11572  1 003645   004735 234100                    SZN     2525,,PR0
         1 003646   003650 605000 1                  TPL     s:11573

  11572  1 003647   000000 702200 xent               TSX2  ! X66_ARET

      863    11573    1        IF S_D.MACTIVE

  11573  1 003650   000713 234100                    SZN     459,,PR0
         1 003651   003663 605000 1                  TPL     s:11576

      864    11574    1        THEN CALL DDQ$WRITENU( START$, TEMP );

  11574  1 003652   200204 631500                    EPPR1   TEMP,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:142  
         1 003653   200231 451500                    STP1    DUM2+2,,AUTO
         1 003654   200111 633500                    EPPR3   START$,,AUTO
         1 003655   200230 453500                    STP3    DUM2+1,,AUTO
         1 003656   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003657   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003660   000000 701000 xent               TSX1    DDQ$WRITENU
         1 003661   000000 011000                    NOP     0
         1 003662   004200 710000 1                  TRA     s:11621

      865    11575    2        ELSE DO;

      866    11576    2             CALL DDQ$WRITE( START$, TEMP );

  11576  1 003663   200204 631500                    EPPR1   TEMP,,AUTO
         1 003664   200231 451500                    STP1    DUM2+2,,AUTO
         1 003665   200111 633500                    EPPR3   START$,,AUTO
         1 003666   200230 453500                    STP3    DUM2+1,,AUTO
         1 003667   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003670   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003671   000000 701000 xent               TSX1    DDQ$WRITE
         1 003672   000000 011000                    NOP     0

      867    11577    2             IF S_D.ANLZ AND NOT S_D.ANLZ_MODIFIED AND NOT S_D.ANLZ_FILE AND NOT (
             11577                      MACTIVE AND S_D.ALIB_SAID_GOBACK)

  11577  1 003673   000000 470400 xsym               LDP0    S_D$
         1 003674   004756 234100                    SZN     2542,,PR0
         1 003675   003714 605000 1                  TPL     s:11582
         1 003676   005311 234100                    SZN     2761,,PR0
         1 003677   003714 604000 1                  TMI     s:11582
         1 003700   005052 234100                    SZN     2602,,PR0
         1 003701   003714 604000 1                  TMI     s:11582
         1 003702   200015 234100                    SZN     MACTIVE,,AUTO
         1 003703   003706 605000 1                  TPL     s:11579
         1 003704   000075 234100                    SZN     61,,PR0
         1 003705   003714 604000 1                  TMI     s:11582

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:143  
      868    11578    3             THEN DO;

      869    11579    3                  S_D.ANLZ_MODIFIED = '1'B;

  11579  1 003706   400000 236003                    LDQ     -131072,DU
         1 003707   005311 756100                    STQ     2761,,PR0

      870    11580    3                  CALL DUQ$OCMSG (60 /* ANLZMOD_MSG# */);

  11580  1 003710   000025 630400 2                  EPPR0   21
         1 003711   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003712   000000 701000 xent               TSX1    DUQ$OCMSG
         1 003713   000000 011000                    NOP     0

      871    11581    3                END;

      872    11582    2             IF S_D.RUM AND NOT S_D.RUM_TEST

  11582  1 003714   000000 470400 xsym               LDP0    S_D$
         1 003715   004755 234100                    SZN     2541,,PR0
         1 003716   004133 605000 1                  TPL     s:11611
         1 003717   005004 234100                    SZN     2564,,PR0
         1 003720   004133 604000 1                  TMI     s:11611

      873    11583    3             THEN DO;

      874    11584    3                  S_D.D$ = ADDR(S_D.OUTPUT);

  11584  1 003721   000000 236000 xsym               LDQ     S_D$
         1 003722   005335 036003                    ADLQ    2781,DU
         1 003723   000044 756100                    STQ     36,,PR0

      875    11585    3                  S_D.OUTPUT = ' ';

  11585  1 003724   040100 100400                    MLR     fill='040'O
         1 003725   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 003726   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:144  

      876    11586    3                  S_D.DESCL$ = PINCRC(S_D.D$, LENGTHC(S_D.OUTPUT));

  11586  1 003727   001000 036003                    ADLQ    512,DU
         1 003730   000042 756100                    STQ     34,,PR0

      877    11587    3                  CALL DDA$DISPADR(ADDRESS, SEG, DESC#, NOT_IS, %REL_FMT, '1'B, 36)
             11587                           ALTRET(MERR);

  11587  1 003731   000013 236000 2                  LDQ     11
         1 003732   200236 756100                    STQ     DUM2+7,,AUTO
         1 003733   000044 237000 2                  LDAQ    36
         1 003734   200234 757100                    STAQ    DUM2+5,,AUTO
         1 003735   200006 631500                    EPPR1   NOT_IS,,AUTO
         1 003736   200233 451500                    STP1    DUM2+4,,AUTO
         1 003737   200005 633500                    EPPR3   DESC#,,AUTO
         1 003740   200232 453500                    STP3    DUM2+3,,AUTO
         1 003741   200004 634500                    EPPR4   SEG,,AUTO
         1 003742   200231 454500                    STP4    DUM2+2,,AUTO
         1 003743   200003 635500                    EPPR5   ADDRESS,,AUTO
         1 003744   200230 455500                    STP5    DUM2+1,,AUTO
         1 003745   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 003746   000025 631400 xsym               EPPR1   B_VECTNIL+21
         1 003747   000000 701000 xent               TSX1    DDA$DISPADR
         1 003750   004232 702000 1                  TSX2    MERR

      878    11588    3                  CALL DDR$BUMPC_D$(2) ALTRET(MERR1);

  11588  1 003751   000030 630400 2                  EPPR0   24
         1 003752   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003753   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003754   004207 702000 1                  TSX2    MERR1

      879    11589    3                  TEXT$ -> CHAR2 = '/ ';

  11589  1 003755   200175 470500                    LDP0    TEXT$,,AUTO
         1 003756   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:145  
         1 003757   000000 000002 0                  ADSC9   0                        cn=0,n=2
         1 003760   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      880    11590    3                  IF SUPADR

  11590  1 003761   200200 234100                    SZN     SUPADR,,AUTO
         1 003762   003767 605000 1                  TPL     s:11592

      881    11591    3                  THEN S_D.D$ = ADDR(S_D.OUTPUT); /* '/' activation */

  11591  1 003763   000000 236000 xsym               LDQ     S_D$
         1 003764   005335 036003                    ADLQ    2781,DU
         1 003765   000000 471400 xsym               LDP1    S_D$
         1 003766   100044 756100                    STQ     36,,PR1

      882    11592    3                  CALL DDA$DISPFMT(FMT, S_D.L$.SIZE, NVALUE.OPS, , '1'B) ALTRET(MERR);

  11592  1 003767   000000 236000 2                  LDQ     0
         1 003770   200234 756100                    STQ     DUM2+5,,AUTO
         1 003771   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 003772   200233 756100                    STQ     DUM2+4,,AUTO
         1 003773   200045 631500                    EPPR1   NVALUE+1,,AUTO
         1 003774   200232 451500                    STP1    DUM2+3,,AUTO
         1 003775   000000 236000 xsym               LDQ     S_D$
         1 003776   000126 036003                    ADLQ    86,DU
         1 003777   200231 756100                    STQ     DUM2+2,,AUTO
         1 004000   200110 633500                    EPPR3   FMT,,AUTO
         1 004001   200230 453500                    STP3    DUM2+1,,AUTO
         1 004002   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 004003   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 004004   000000 701000 xent               TSX1    DDA$DISPFMT
         1 004005   004232 702000 1                  TSX2    MERR

      883    11593    3                  IF MACTIVE

  11593  1 004006   200015 234100                    SZN     MACTIVE,,AUTO
         1 004007   004014 605000 1                  TPL     s:11597
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:146  

      884    11594    3                  THEN
      885    11595    3                       S_D.MACTIVE = '1'B;

  11595  1 004010   400000 236003                    LDQ     -131072,DU
         1 004011   000000 470400 xsym               LDP0    S_D$
         1 004012   000713 756100                    STQ     459,,PR0
         1 004013   004103 710000 1                  TRA     s:11607

      886    11596    4                  ELSE DO;

      887    11597    4                       TEXT$ = S_D.D$;

  11597  1 004014   000000 470400 xsym               LDP0    S_D$
         1 004015   000044 236100                    LDQ     36,,PR0
         1 004016   200175 756100                    STQ     TEXT$,,AUTO

      888    11598    4                       CALL DDR$BUMPC_D$(2) ALTRET(MERR1);

  11598  1 004017   000030 630400 2                  EPPR0   24
         1 004020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004021   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 004022   004207 702000 1                  TSX2    MERR1

      889    11599    4                       TEXT$ -> CHAR2 = ' (';

  11599  1 004023   200175 470500                    LDP0    TEXT$,,AUTO
         1 004024   040100 100400                    MLR     fill='040'O
         1 004025   000001 000002 0                  ADSC9   1                        cn=0,n=2
         1 004026   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      890    11600    4                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  11600  1 004027   000000 471400 xsym               LDP1    S_D$
         1 004030   106714 235100                    LDA     3532,,PR1
         1 004031   000001 115007                    CMPA    1,DL
         1 004032   004052 601000 1                  TNZ     s:11602
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:147  

      891    11601    4                       THEN CALL DDA$DISPFMT(FMT, 36, OVALUE.OPS(0), , '1'B) ALTRET(
             11601                                MERR1);

  11601  1 004033   000000 236000 2                  LDQ     0
         1 004034   200234 756100                    STQ     DUM2+5,,AUTO
         1 004035   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 004036   200233 756100                    STQ     DUM2+4,,AUTO
         1 004037   200024 633500                    EPPR3   OVALUE+1,,AUTO
         1 004040   200232 453500                    STP3    DUM2+3,,AUTO
         1 004041   000013 236000 2                  LDQ     11
         1 004042   200231 756100                    STQ     DUM2+2,,AUTO
         1 004043   200110 634500                    EPPR4   FMT,,AUTO
         1 004044   200230 454500                    STP4    DUM2+1,,AUTO
         1 004045   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 004046   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 004047   000000 701000 xent               TSX1    DDA$DISPFMT
         1 004050   004207 702000 1                  TSX2    MERR1
         1 004051   004070 710000 1                  TRA     s:11603

      892    11602    4                      ELSE CALL DDA$DISPFMT(FMT, TSIZE, OVALUE.OPS(0), , '1'B) ALTRET(
             11602                                MERR1);

  11602  1 004052   000000 236000 2                  LDQ     0
         1 004053   200234 756100                    STQ     DUM2+5,,AUTO
         1 004054   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 004055   200233 756100                    STQ     DUM2+4,,AUTO
         1 004056   200024 633500                    EPPR3   OVALUE+1,,AUTO
         1 004057   200232 453500                    STP3    DUM2+3,,AUTO
         1 004060   200203 634500                    EPPR4   TSIZE,,AUTO
         1 004061   200231 454500                    STP4    DUM2+2,,AUTO
         1 004062   200110 635500                    EPPR5   FMT,,AUTO
         1 004063   200230 455500                    STP5    DUM2+1,,AUTO
         1 004064   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 004065   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 004066   000000 701000 xent               TSX1    DDA$DISPFMT
         1 004067   004207 702000 1                  TSX2    MERR1
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:148  

      893    11603    4                       TEXT$ = S_D.D$;

  11603  1 004070   000000 470400 xsym               LDP0    S_D$
         1 004071   000044 236100                    LDQ     36,,PR0
         1 004072   200175 756100                    STQ     TEXT$,,AUTO

      894    11604    4                       CALL DDR$BUMPC_D$(1) ALTRET(MERR1);

  11604  1 004073   000012 630400 2                  EPPR0   10
         1 004074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004075   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 004076   004207 702000 1                  TSX2    MERR1

      895    11605    4                       TEXT$ -> CHAR1 = ')';

  11605  1 004077   200175 470500                    LDP0    TEXT$,,AUTO
         1 004100   040100 100400                    MLR     fill='040'O
         1 004101   000031 000001 2                  ADSC9   25                       cn=0,n=1
         1 004102   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      896    11606    4                     END;                  /* not MACTIVE */

      897    11607    3                  START$ = ADDR( S_D.OUTPUT );

  11607  1 004103   000000 236000 xsym               LDQ     S_D$
         1 004104   005335 036003                    ADLQ    2781,DU
         1 004105   200111 756100                    STQ     START$,,AUTO

      898    11608    3                  TEMP = POFFC( S_D.D$, START$ );

  11608  1 004106   200111 236100                    LDQ     START$,,AUTO
         1 004107   000020 772000                    QRL     16
         1 004110   200230 756100                    STQ     DUM2+1,,AUTO
         1 004111   000000 470400 xsym               LDP0    S_D$
         1 004112   000044 236100                    LDQ     36,,PR0
         1 004113   000020 772000                    QRL     16
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:149  
         1 004114   200230 136100                    SBLQ    DUM2+1,,AUTO
         1 004115   200204 756100                    STQ     TEMP,,AUTO

      899    11609    3                  CALL DDQ$WRITELM( %TYPRUM, 0, NODE, START$, TEMP ) ALTRET( MERR2 );

  11609  1 004116   200204 631500                    EPPR1   TEMP,,AUTO
         1 004117   200234 451500                    STP1    DUM2+5,,AUTO
         1 004120   200111 633500                    EPPR3   START$,,AUTO
         1 004121   200233 453500                    STP3    DUM2+4,,AUTO
         1 004122   200014 634500                    EPPR4   NODE,,AUTO
         1 004123   200232 454500                    STP4    DUM2+3,,AUTO
         1 004124   000036 237000 2                  LDAQ    30
         1 004125   200230 757100                    STAQ    DUM2+1,,AUTO
         1 004126   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 004127   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 004130   000000 701000 xent               TSX1    DDQ$WRITELM
         1 004131   004216 702000 1                  TSX2    MERR2

      900    11610    3                END;

  11610  1 004132   004200 710000 1                  TRA     s:11621

      901    11611    2             ELSE IF S_D.PATCH

  11611  1 004133   004754 234100                    SZN     2540,,PR0
         1 004134   004162 605000 1                  TPL     s:11618

      902    11612    3                  THEN DO;

      903    11613    3                       MYBUF = S_D.OUTPUT;

  11613  1 004135   040100 100500                    MLR     fill='040'O
         1 004136   005335 000310                    ADSC9   2781,,PR0                cn=0,n=200
         1 004137   200112 000310                    ADSC9   MYBUF,,AUTO              cn=0,n=200

      904    11614    3                       S_D.XDP.IMAGE.INP = S_D.INPUT;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:150  
  11614  1 004140   040100 100500                    MLR     fill='040'O
         1 004141   000610 000120                    ADSC9   392,,PR0                 cn=0,n=80
         1 004142   005335 000120                    ADSC9   2781,,PR0                cn=0,n=80

      905    11615    3                       S_D.XDP.IMAGE.OTP = MYBUF;

  11615  1 004143   040100 100500                    MLR     fill='040'O
         1 004144   200112 000170                    ADSC9   MYBUF,,AUTO              cn=0,n=120
         1 004145   005361 000170                    ADSC9   2801,,PR0                cn=0,n=120

      906    11616    3                       CALL DXQ$WRTPI (ADDR(S_D.XDP), SIZEC(S_D.XDP.IMAGE));

  11616  1 004146   000000 236000 xsym               LDQ     S_D$
         1 004147   005335 036003                    ADLQ    2781,DU
         1 004150   200230 756100                    STQ     DUM2+1,,AUTO
         1 004151   000040 236000 2                  LDQ     32
         1 004152   200233 756100                    STQ     DUM2+4,,AUTO
         1 004153   200230 631500                    EPPR1   DUM2+1,,AUTO
         1 004154   200232 451500                    STP1    DUM2+3,,AUTO
         1 004155   200232 630500                    EPPR0   DUM2+3,,AUTO
         1 004156   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004157   000000 701000 xent               TSX1    DXQ$WRTPI
         1 004160   000000 011000                    NOP     0

      907    11617    3                     END;

  11617  1 004161   004200 710000 1                  TRA     s:11621

      908    11618    2                  ELSE IF S_D.ANLZ AND NOT S_D.ANLZ_FILE AND NOT(MACTIVE AND S_D.
             11618                           ALIB_SAID_GOBACK)

  11618  1 004162   004756 234100                    SZN     2542,,PR0
         1 004163   004200 605000 1                  TPL     s:11621
         1 004164   005052 234100                    SZN     2602,,PR0
         1 004165   004200 604000 1                  TMI     s:11621
         1 004166   200015 234100                    SZN     MACTIVE,,AUTO
         1 004167   004172 605000 1                  TPL     s:11619
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:151  
         1 004170   000075 234100                    SZN     61,,PR0
         1 004171   004200 604000 1                  TMI     s:11621

      909    11619    2                       THEN CALL DUQ$WRERRLOG(TEMP);

  11619  1 004172   200204 631500                    EPPR1   TEMP,,AUTO
         1 004173   200230 451500                    STP1    DUM2+1,,AUTO
         1 004174   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 004175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004176   000000 701000 xent               TSX1    DUQ$WRERRLOG
         1 004177   000000 011000                    NOP     0

      910    11620    2           END;

      911    11621    1        IF NMSLASH

  11621  1 004200   200201 234100                    SZN     NMSLASH,,AUTO
         1 004201   004206 605000 1                  TPL     s:11626

      912    11622    2        THEN DO;

      913    11623    2             S_D.MACTIVE = '0'B;

  11623  1 004202   000000 470400 xsym               LDP0    S_D$
         1 004203   000713 450100                    STZ     459,,PR0

      914    11624    2             S_D.STEP = '1'B;              /* KEEP PROMPT ON SAME LINE */

  11624  1 004204   400000 236003                    LDQ     -131072,DU
         1 004205   000722 756100                    STQ     466,,PR0

      915    11625    2           END;

      916    11626    1        GOTO MRTN;

  11626  1 004206   004224 710000 1                  TRA     MRTN

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:152  
      917    11627    1   MERR1:
      918    11628    1        S_D.ERROR = 502;              /* E@DELBUG */

  11628  1 004207   000766 235007       MERR1        LDA     502,DL
         1 004210   000000 470400 xsym               LDP0    S_D$
         1 004211   000013 755100                    STA     11,,PR0

      919    11629    1        CALL DDE$ERROR;

  11629  1 004212   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004213   000000 701000 xent               TSX1    DDE$ERROR
         1 004214   000000 011000                    NOP     0

      920    11630    1        GOTO MRTN;

  11630  1 004215   004224 710000 1                  TRA     MRTN

      921    11631    1   MERR2:
      922    11632    1        S_D.ERROR = 239;      /* E@CANT_UPDATE_RU */

  11632  1 004216   000357 235007       MERR2        LDA     239,DL
         1 004217   000000 470400 xsym               LDP0    S_D$
         1 004220   000013 755100                    STA     11,,PR0

      923    11633    1        CALL DDE$ERROR;

  11633  1 004221   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004222   000000 701000 xent               TSX1    DDE$ERROR
         1 004223   000000 011000                    NOP     0

  11621  1 004224                       MRTN         null
      924    11634    1   MRTN: ;
      925    11635    1        IF SAVE_DOMAIN

  11635  1 004224   200206 234100                    SZN     SAVE_DOMAIN,,AUTO
         1 004225   004231 605000 1                  TPL     s:11639

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:153  
      926    11636    2        THEN DO;

      927    11637    2             S_D.ONE_TO_TWO.EXEC_DOMAIN = SAVE_EXEC_DOMAIN;

  11637  1 004226   000000 470400 xsym               LDP0    S_D$
         1 004227   200207 235100                    LDA     SAVE_EXEC_DOMAIN,,AUTO
         1 004230   006714 755100                    STA     3532,,PR0

      928    11638    2           END;

      929    11639    1        RETURN;

  11639  1 004231   000000 702200 xent               TSX2  ! X66_ARET

      930    11640    1   MERR:
      931    11641    1        IF SAVE_DOMAIN

  11641  1 004232   200206 234100       MERR         SZN     SAVE_DOMAIN,,AUTO
         1 004233   004237 605000 1                  TPL     s:11645

      932    11642    2        THEN DO;

      933    11643    2             S_D.ONE_TO_TWO.EXEC_DOMAIN = SAVE_EXEC_DOMAIN;

  11643  1 004234   000000 470400 xsym               LDP0    S_D$
         1 004235   200207 235100                    LDA     SAVE_EXEC_DOMAIN,,AUTO
         1 004236   006714 755100                    STA     3532,,PR0

      934    11644    2           END;

      935    11645    1        ALTRETURN;

  11645  1 004237   000000 702200 xent               TSX2  ! X66_AALT

      936    11646             %EJECT;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:154  
      937    11647    1   IORVALUE: PROC(RVALUE, IFLAG, ZFLAG, XFLAG) ALTRET;

  11647  1 004240   200216 741300       IORVALUE     STX1  ! ZITEM$+4,,AUTO

      938    11648    2   DCL 1 RVALUE,
      939    11649    2         2 SIZE UBIN WORD,
      940    11650    2         2 OPS(0:15) UBIN WORD;
      941    11651    2   DCL IFLAG BIT(1) UNAL;
      942    11652    2   DCL ZFLAG BIT(1) UNAL;
      943    11653    2   DCL XFLAG BIT(1) UNAL;
      944    11654        /*D* NAME: IORVALUE */
      945    11655        /*D* The routine IOVALUE  constructs a 36-bit value from a data
      946    11656             descriptor optionally preceded  by an instruction template
      947    11657             as specified by IFLAG.   This input information is at S_D.D$,
      948    11658             and upon normal return S_D.D$ points to the next word following
      949    11659             the data descriptor.  ALTRET  is taken if the address data
      950    11660             descriptor cant be evaluated.
      951    11661                                                     */
      952    11662    2   DCL VALUE UBIN;
      953    11663    2   DCL 1 OVALUE REDEF VALUE,
      954    11664    2         2 * UBIN(3) UNAL,
      955    11665    2         2 OFFSET SBIN(15) UNAL,
      956    11666    2         2 * UBIN(11) UNAL,
      957    11667    2         2 BIT29 BIT(1) UNAL,
      958    11668    2         2 * UBIN(6) UNAL;
      959    11669    2   DCL 1 YVALUE REDEF VALUE,
      960    11670    2         2 Y UBIN(18) UNAL,
      961    11671    2         2 * UBIN(18) UNAL;
      962    11672    2   DCL UBIN36 UBIN BASED;
      963    11673    2   DCL ADDRESS UBIN;
      964    11674    2   DCL NOT_IS BIT(1) ALIGNED;
      965    11675    2   DCL DUM UBIN;
      966    11676    2   DCL DUM2 UBIN;
      967    11677                                                /**/
      968    11678    2        IF IFLAG

  11678  1 004241   200220 470500                    LDP0    @IFLAG,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:155  
         1 004242   000000 066500                    CMPB    filb='0'B
         1 004243   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 004244   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004245   004255 600000 1                  TZE     s:11683

      969    11679    3        THEN DO;

      970    11680    3             VALUE = S_D.DESC$ -> UBIN36;

  11680  1 004246   000000 471400 xsym               LDP1    S_D$
         1 004247   100041 473500                    LDP3    33,,PR1
         1 004250   300000 235100                    LDA     0,,PR3
         1 004251   200223 755100                    STA     VALUE,,AUTO

      971    11681    3             S_D.DESC$ = PINCRW(S_D.DESC$, 1);

  11681  1 004252   100041 236100                    LDQ     33,,PR1
         1 004253   000001 036003                    ADLQ    1,DU
         1 004254   100041 756100                    STQ     33,,PR1

      972    11682    3           END;

      973    11683    2        CALL DDK$EVAL(ADDRESS, DUM, DUM2, NOT_IS) ALTRET(ARET);

  11683  1 004255   200225 631500                    EPPR1   NOT_IS,,AUTO
         1 004256   200233 451500                    STP1    DUM2+4,,AUTO
         1 004257   200227 633500                    EPPR3   DUM2,,AUTO
         1 004260   200232 453500                    STP3    DUM2+3,,AUTO
         1 004261   200226 634500                    EPPR4   DUM,,AUTO
         1 004262   200231 454500                    STP4    DUM2+2,,AUTO
         1 004263   200224 635500                    EPPR5   ADDRESS,,AUTO
         1 004264   200230 455500                    STP5    DUM2+1,,AUTO
         1 004265   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 004266   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 004267   000000 701000 xent               TSX1    DDK$EVAL
         1 004270   004344 702000 1                  TSX2    ARET

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:156  
      974    11684    2        IF NOT_IS

  11684  1 004271   200225 234100                    SZN     NOT_IS,,AUTO
         1 004272   004300 605000 1                  TPL     s:11689

      975    11685    3        THEN DO;

      976    11686    3             S_D.ERROR = 86;      /* E@BADVALEXP */

  11686  1 004273   000126 235007                    LDA     86,DL
         1 004274   000000 470400 xsym               LDP0    S_D$
         1 004275   000013 755100                    STA     11,,PR0

      977    11687    3             ALTRETURN;

  11687  1 004276   200216 221300                    LDX1  ! ZITEM$+4,,AUTO
         1 004277   000000 702211                    TSX2  ! 0,X1

      978    11688    3           END;
      979    11689    2        IF IFLAG

  11689  1 004300   200220 470500                    LDP0    @IFLAG,,AUTO
         1 004301   000000 066500                    CMPB    filb='0'B
         1 004302   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 004303   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004304   004333 600000 1                  TZE     s:11693

      980    11690    2        THEN IF ( OVALUE.BIT29 AND NOT ZFLAG ) OR XFLAG

  11690  1 004305   200223 236100                    LDQ     VALUE,,AUTO
         1 004306   000100 316007                    CANQ    64,DL
         1 004307   004315 600000 1                  TZE     s:11690+8
         1 004310   200221 471500                    LDP1    @ZFLAG,,AUTO
         1 004311   000000 066500                    CMPB    filb='0'B
         1 004312   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         1 004313   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004314   004322 600000 1                  TZE     s:11691
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:157  
         1 004315   200222 471500                    LDP1    @XFLAG,,AUTO
         1 004316   000000 066500                    CMPB    filb='0'B
         1 004317   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         1 004320   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004321   004330 600000 1                  TZE     s:11692

      981    11691    2             THEN OVALUE.OFFSET = ADDRESS;

  11691  1 004322   200224 236100                    LDQ     ADDRESS,,AUTO
         1 004323   000022 736000                    QLS     18
         1 004324   200223 676100                    ERQ     VALUE,,AUTO
         1 004325   077777 376003                    ANQ     32767,DU
         1 004326   200223 656100                    ERSQ    VALUE,,AUTO
         1 004327   004335 710000 1                  TRA     s:11694

      982    11692    2             ELSE YVALUE.Y = ADDRESS;

  11692  1 004330   200224 720100                    LXL0    ADDRESS,,AUTO
         1 004331   200223 740100                    STX0    VALUE,,AUTO
         1 004332   004335 710000 1                  TRA     s:11694

      983    11693    2        ELSE VALUE = ADDRESS;

  11693  1 004333   200224 235100                    LDA     ADDRESS,,AUTO
         1 004334   200223 755100                    STA     VALUE,,AUTO

      984    11694    2        RVALUE.SIZE = 1;

  11694  1 004335   000001 235007                    LDA     1,DL
         1 004336   200217 471500                    LDP1    @RVALUE,,AUTO
         1 004337   100000 755100                    STA     0,,PR1

      985    11695    2        RVALUE.OPS(0) = VALUE;

  11695  1 004340   200223 236100                    LDQ     VALUE,,AUTO
         1 004341   100001 756100                    STQ     1,,PR1

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:158  
      986    11696    2        RETURN;

  11696  1 004342   200216 221300                    LDX1  ! ZITEM$+4,,AUTO
         1 004343   000001 702211                    TSX2  ! 1,X1

      987    11697    2   ARET:
      988    11698    2        ALTRETURN;

  11698  1 004344   200216 221300       ARET         LDX1  ! ZITEM$+4,,AUTO
         1 004345   000000 702211                    TSX2  ! 0,X1

      989    11699    2   END IORVALUE;
      990    11700        %EJECT;
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:159  
      991    11701    1   L6_IORVALUE: PROC ( RVALUE ,IFLAG ,MOD_LOC ) ALTRET;

  11701  1 004346   200216 741300       L6_IORVALUE  STX1  ! ZITEM$+4,,AUTO

      992    11702
      993    11703        /*D* NAME: L6_IORVALUE */
      994    11704        /*D* This routine either assembles a L6 instruction or evaluates a
      995    11705             data descriptor.  */
      996    11706
      997    11707    2   DCL 1 RVALUE,
      998    11708    2         2 SIZE UBIN WORD,
      999    11709    2         2 OPS(0:15) UBIN WORD;
     1000    11710    2   DCL IFLAG BIT(1) UNAL;
     1001    11711    2   DCL MOD_LOC UBIN WORD;
     1002    11712    2   DCL ADDRESS UBIN;
     1003    11713    2   DCL 1 L6_DW REDEF ADDRESS,
     1004    11714    2         2 * UBIN(4) UNAL,
     1005    11715    2         2 UW UBIN(16) UNAL,
     1006    11716    2         2 LW UBIN(16) UNAL;
     1007    11717    2   DCL ADDRESSB REDEF ADDRESS BIT(36);
     1008    11718    2   DCL DUM UBIN;
     1009    11719    2   DCL DUM2 UBIN;
     1010    11720    2   DCL NOT_IS BIT(1) ALIGNED;
     1011    11721
     1012    11722    2        IF IFLAG

  11722  1 004347   200220 470500                    LDP0    @IFLAG,,AUTO
         1 004350   000000 066500                    CMPB    filb='0'B
         1 004351   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 004352   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004353   004366 600000 1                  TZE     s:11725

     1013    11723    2        THEN CALL DFS$INSTR(RVALUE,MOD_LOC,'0'B) ALTRET(ARET);

  11723  1 004354   000026 236000 2                  LDQ     22
         1 004355   200232 756100                    STQ     DUM2+3,,AUTO
         1 004356   200221 236100                    LDQ     @MOD_LOC,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:160  
         1 004357   200217 235100                    LDA     @RVALUE,,AUTO
         1 004360   200230 757100                    STAQ    DUM2+1,,AUTO
         1 004361   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 004362   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 004363   000000 701000 xent               TSX1    DFS$INSTR
         1 004364   004505 702000 1                  TSX2    ARET
         1 004365   004503 710000 1                  TRA     s:11761

     1014    11724    3        ELSE DO;

     1015    11725    3             S_D.GOT$RI = '0'B;

  11725  1 004366   000000 471400 xsym               LDP1    S_D$
         1 004367   105236 450100                    STZ     2718,,PR1

     1016    11726    3             S_D.GOT$L = '0'B;

  11726  1 004370   106723 450100                    STZ     3539,,PR1

     1017    11727    3             CALL DDK$EVAL(ADDRESS ,DUM ,DUM2 ,NOT_IS)ALTRET(ARET);

  11727  1 004371   200225 633500                    EPPR3   NOT_IS,,AUTO
         1 004372   200233 453500                    STP3    DUM2+4,,AUTO
         1 004373   200224 634500                    EPPR4   DUM2,,AUTO
         1 004374   200232 454500                    STP4    DUM2+3,,AUTO
         1 004375   200223 635500                    EPPR5   DUM,,AUTO
         1 004376   200231 455500                    STP5    DUM2+2,,AUTO
         1 004377   200222 636500                    EPPR6   ADDRESS,,AUTO
         1 004400   200230 456500                    STP6    DUM2+1,,AUTO
         1 004401   200230 630500                    EPPR0   DUM2+1,,AUTO
         1 004402   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 004403   000000 701000 xent               TSX1    DDK$EVAL
         1 004404   004505 702000 1                  TSX2    ARET

     1018    11728    3             IF S_D.GOT$RI

  11728  1 004405   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:161  
         1 004406   005236 234100                    SZN     2718,,PR0
         1 004407   004416 605000 1                  TPL     s:11733

     1019    11729    4             THEN DO;

     1020    11730    4                  RVALUE = S_D.RI$;

  11730  1 004410   200217 471500                    LDP1    @RVALUE,,AUTO
         1 004411   000100 100500                    MLR     fill='000'O
         1 004412   005066 000104                    ADSC9   2614,,PR0                cn=0,n=68
         1 004413   100000 000104                    ADSC9   0,,PR1                   cn=0,n=68

     1021    11731    4                  RETURN;

  11731  1 004414   200216 221300                    LDX1  ! ZITEM$+4,,AUTO
         1 004415   000001 702211                    TSX2  ! 1,X1

     1022    11732    4                END;
     1023    11733    3             IF S_D.GOT$L

  11733  1 004416   006723 234100                    SZN     3539,,PR0
         1 004417   004430 605000 1                  TPL     s:11739

     1024    11734    4             THEN DO;

     1025    11735    4                  RVALUE.OPS = S_D.L$.VALUE;

  11735  1 004420   200217 471500                    LDP1    @RVALUE,,AUTO
         1 004421   000100 100500                    MLR     fill='000'O
         1 004422   000106 000100                    ADSC9   70,,PR0                  cn=0,n=64
         1 004423   100001 000100                    ADSC9   1,,PR1                   cn=0,n=64

     1026    11736    4                  RVALUE.SIZE = S_D.L$.SIZE;

  11736  1 004424   000126 235100                    LDA     86,,PR0
         1 004425   100000 755100                    STA     0,,PR1

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:162  
     1027    11737    4                  RETURN;

  11737  1 004426   200216 221300                    LDX1  ! ZITEM$+4,,AUTO
         1 004427   000001 702211                    TSX2  ! 1,X1

     1028    11738    4                END;
     1029    11739    3             IF NOT_IS

  11739  1 004430   200225 234100                    SZN     NOT_IS,,AUTO
         1 004431   004437 605000 1                  TPL     s:11744

     1030    11740    4             THEN DO;

     1031    11741    4   BADVALEXP:     S_D.ERROR = 86; /* E@BADVALEXP */

  11741  1 004432   000126 235007       BADVALEXP    LDA     86,DL
         1 004433   000000 470400 xsym               LDP0    S_D$
         1 004434   000013 755100                    STA     11,,PR0

     1032    11742    4                  ALTRETURN;

  11742  1 004435   200216 221300                    LDX1  ! ZITEM$+4,,AUTO
         1 004436   000000 702211                    TSX2  ! 0,X1

     1033    11743    4                END;
     1034    11744    3             IF FMT = %PTR_FMT OR S_D.MDW

  11744  1 004437   200110 235100                    LDA     FMT,,AUTO
         1 004440   000007 115007                    CMPA    7,DL
         1 004441   004444 600000 1                  TZE     s:11746
         1 004442   006724 234100                    SZN     3540,,PR0
         1 004443   004457 605000 1                  TPL     s:11751

     1035    11745    4             THEN DO;

     1036    11746    4                  RVALUE.SIZE = 2;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:163  
  11746  1 004444   000002 236007                    LDQ     2,DL
         1 004445   200217 471500                    LDP1    @RVALUE,,AUTO
         1 004446   100000 756100                    STQ     0,,PR1

     1037    11747    4                  RVALUE.OPS(0) = L6_DW.UW;

  11747  1 004447   200222 236100                    LDQ     ADDRESS,,AUTO
         1 004450   000020 772000                    QRL     16
         1 004451   177777 376007                    ANQ     65535,DL
         1 004452   100001 756100                    STQ     1,,PR1

     1038    11748    4                  RVALUE.OPS(1) = L6_DW.LW;

  11748  1 004453   200222 236100                    LDQ     ADDRESS,,AUTO
         1 004454   177777 376007                    ANQ     65535,DL
         1 004455   100002 756100                    STQ     2,,PR1

     1039    11749    4                END;

  11749  1 004456   004503 710000 1                  TRA     s:11761

     1040    11750    4             ELSE DO;

     1041    11751    4                  IF S_D.SDOT AND L6_DW.LW = BITBIN('2020'X) /* Only use the top */

  11751  1 004457   004741 234100                    SZN     2529,,PR0
         1 004460   004470 605000 1                  TPL     s:11754
         1 004461   200222 236100                    LDQ     ADDRESS,,AUTO
         1 004462   177777 376007                    ANQ     65535,DL
         1 004463   020040 116007                    CMPQ    8224,DL
         1 004464   004470 601000 1                  TNZ     s:11754

     1042    11752    4                  THEN
     1043    11753    4                       ADDRESS = ADDRESS / 65536; /* If the bottom isn't there */

  11753  1 004465   200222 236100                    LDQ     ADDRESS,,AUTO
         1 004466   000020 772000                    QRL     16
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:164  
         1 004467   200222 756100                    STQ     ADDRESS,,AUTO

     1044    11754    4                  IF ADDRESS > 65535 AND ADDRESS <= BITBIN('777777700000'O)

  11754  1 004470   200222 236100                    LDQ     ADDRESS,,AUTO
         1 004471   200000 116007                    CMPQ    65536,DL
         1 004472   004476 602000 1                  TNC     s:11757
         1 004473   000003 116000 0                  CMPQ    3
         1 004474   004432 602000 1                  TNC     BADVALEXP
         1 004475   004432 600000 1                  TZE     BADVALEXP

     1045    11755    4                  THEN
     1046    11756    4                       GOTO BADVALEXP;
     1047    11757    4                  RVALUE.SIZE = 1;

  11757  1 004476   000001 235007                    LDA     1,DL
         1 004477   200217 471500                    LDP1    @RVALUE,,AUTO
         1 004500   100000 755100                    STA     0,,PR1

     1048    11758    4                  RVALUE.OPS(0) = ADDRESS;

  11758  1 004501   200222 236100                    LDQ     ADDRESS,,AUTO
         1 004502   100001 756100                    STQ     1,,PR1

     1049    11759    4                END;

     1050    11760    3           END;

     1051    11761    2        RETURN;

  11761  1 004503   200216 221300                    LDX1  ! ZITEM$+4,,AUTO
         1 004504   000001 702211                    TSX2  ! 1,X1

     1052    11762    2   ARET:
     1053    11763    2        ALTRETURN;

  11763  1 004505   200216 221300       ARET         LDX1  ! ZITEM$+4,,AUTO
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:165  
         1 004506   000000 702211                    TSX2  ! 0,X1

(unnamed)
 Sect OctLoc
   0     000   057040 040040   040050 040040   056056 056040   777777 700000    /    (  ... ....

(unnamed)
 Sect OctLoc
   2     000   000030 006000   000001 060000   000001 040000   000001 020000    ......0... .....
   2     004   000001 070000   000001 050000   000001 030000   000112 200000    ..8...(......J..
   2     010   000061 600000   000000 000044   000003 006000   000011 006000    .1.....$........
   2     014   000000 000015   000000 000040   000014 006000   000015 006000    ....... ........
   2     020   000000 000020   000001 010000   000014 006000   000020 006000    ................
   2     024   000000 000074   000024 006000   000002 006000   000030 006000    ...<............
   2     030   000004 006000   051040 040040   777777 200000   000005 006000    ....)   ........
   2     034   000000 000024   000000 000310   000034 006000   000002 006000    ................
   2     040   000035 006000   000003 600000   000013 006000   000000 000000    ................
   2     044   000013 006000   000030 006000                                    ........
     1054    11764    2   END L6_IORVALUE;
     1055    11765
     1056    11766    1   END DDA$MOD;

PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:166  
--  Include file information  --

   GD$MSG_M.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$MOD.

   Procedure DDA$MOD requires 2375 words for executable code.
   Procedure DDA$MOD requires 160 words of local(AUTO) storage.

    No errors detected in file DDA$MOD.:E05TSI    .
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:167  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:168  
          MINI XREF LISTING

ADDRESS
        16**DCL        17--REDEF   10894<>CALL    10897<>CALL    10913<>CALL    10914<>CALL    10919<>CALL
     10925<>CALL    10926<>CALL    10936>>ASSIGN  10951<>CALL    10959<>CALL    11017<>CALL    11018<>CALL
     11026<>CALL    11028<>CALL    11032>>IF      11032>>IF      11033<>CALL    11035>>IF      11035>>IF
     11036<>CALL    11041>>ASSIGN  11044>>ASSIGN  11074<<ASSIGN  11095<>CALL    11101<>CALL    11102<>CALL
     11110<>CALL    11112<>CALL    11197>>IF      11197>>IF      11198<>CALL    11200>>IF      11200>>IF
     11201<>CALL    11206>>ASSIGN  11209>>ASSIGN  11224<<ASSIGN  11224>>ASSIGN  11226<<ASSIGN  11226>>ASSIGN
     11247>>IF      11254>>IF      11261>>IF      11270<<ASSIGN  11293>>IF      11304<<ASSIGN  11304>>ASSIGN
     11305>>IF      11305>>IF      11311>>DOCASE  11339<<ASSIGN  11380>>ASSIGN  11390>>IF      11391<<ASSIGN
     11392<<ASSIGN  11394<<ASSIGN  11411>>IF      11412<<ASSIGN  11413<<ASSIGN  11415>>IF      11416<<ASSIGN
     11417<<ASSIGN  11426<<ASSIGN  11432<<ASSIGN  11439<<ASSIGN  11455<>CALL    11456<>CALL    11461<>CALL
     11463<>CALL    11465<>CALL    11474>>ASSIGN  11484<>CALL    11499>>IF      11587<>CALL
ADDRESS IN PROCEDURE IORVALUE
     11673**DCL     11683<>CALL    11691>>ASSIGN  11692>>ASSIGN  11693>>ASSIGN
ADDRESS IN PROCEDURE L6_IORVALUE
     11712**DCL     11713--REDEF   11717--REDEF   11727<>CALL    11753<<ASSIGN  11753>>ASSIGN  11754>>IF
     11754>>IF      11758>>ASSIGN
ARET IN PROCEDURE IORVALUE
     11698**LABEL   11683--CALLALT
ARET IN PROCEDURE L6_IORVALUE
     11763**LABEL   11723--CALLALT 11727--CALLALT
BADVALEXP IN PROCEDURE L6_IORVALUE
     11741**LABEL   11756--GOTO
BIT36
        94**DCL     11382>>ASSIGN
BUFFUL0
     11167**LABEL   11152--CALLALT 11154--CALLALT
BUFFULL
     11168**LABEL   11158--CALLALT 11161--CALLALT 11162--CALLALT 11164--CALLALT
CASECODE
        63**DCL     11215<<ASSIGN  11216>>IF      11217>>DOCASE
CHAR1
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:169  
        73**DCL     11165<<ASSIGN  11568<<ASSIGN  11605<<ASSIGN
CHAR2
        74**DCL     11153<<ASSIGN  11159<<ASSIGN  11496<<ASSIGN  11562<<ASSIGN  11589<<ASSIGN  11599<<ASSIGN
DDA$DISPADR
     10852**DCL-ENT 11484--CALL    11587--CALL
DDA$DISPFMT
     10853**DCL-ENT 10980--CALL    10984--CALL    10985--CALL    11154--CALL    11161--CALL    11162--CALL
     11541--CALL    11564--CALL    11565--CALL    11592--CALL    11601--CALL    11602--CALL
DDE$ERROR
     10851**DCL-ENT 10992--CALL    10998--CALL    11010--CALL    11170--CALL    11629--CALL    11633--CALL
DDK$EVAL
     10836**DCL-ENT 10894--CALL    11683--CALL    11727--CALL
DDK$GETMVAL
     10840**DCL-ENT 10925--CALL    11463--CALL
DDK$INCR#
     10850**DCL-ENT 11036--CALL    11201--CALL
DDK$INCR@
     10849**DCL-ENT 11033--CALL    11198--CALL
DDK$PUTMVAL
     10841**DCL-ENT 11026--CALL    11110--CALL
DDQ$WRITE
     10855**DCL-ENT 10996--CALL    11576--CALL
DDQ$WRITELM
     10845**DCL-ENT 11181--CALL    11609--CALL
DDQ$WRITENU
     10856**DCL-ENT 11574--CALL
DDR$BUMPC_D$
     10854**DCL-ENT 11152--CALL    11158--CALL    11164--CALL    11175--CALL    11495--CALL    11561--CALL
     11567--CALL    11588--CALL    11598--CALL    11604--CALL
DDR$INSTR
     10857**DCL-ENT 10975--CALL
DDS$IC2NODE
     10846**DCL-ENT 10913--CALL    11017--CALL    11101--CALL    11455--CALL
DDS$SET_Q2D
     10858**DCL-ENT 11485--CALL
DESC#
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:170  
        22**DCL     10894<>CALL    10897<>CALL    10903>>IF      10914<>CALL    10919<>CALL    10925<>CALL
     10926<>CALL    10938>>ASSIGN  11018<>CALL    11026<>CALL    11028<>CALL    11076<<ASSIGN  11079>>IF
     11102<>CALL    11110<>CALL    11112<>CALL    11144>>IF      11229>>DOCASE  11254>>IF      11259>>IF
     11269<<ASSIGN  11269>>ASSIGN  11271>>IF      11274<<ASSIGN  11287<<ASSIGN  11287>>ASSIGN  11288>>IF
     11293>>IF      11299<<ASSIGN  11310>>IF      11384<<ASSIGN  11400<<ASSIGN  11401>>IF      11406>>IF
     11434<<ASSIGN  11456<>CALL    11461<>CALL    11463<>CALL    11465<>CALL    11476>>ASSIGN  11484<>CALL
     11587<>CALL
DFK$EVAL
     10837**DCL-ENT 10897--CALL
DFK$GETMVAL
     10838**DCL-ENT 10926--CALL    11465--CALL
DFK$PUTMVAL
     10839**DCL-ENT 11028--CALL    11112--CALL
DFR$INSTR
     10861**DCL-ENT 10977--CALL    11130--CALL    11526--CALL    11544--CALL
DFS$INSTR
     10860**DCL-ENT 11723--CALL
DISPMOD
     11472**LABEL   11002--GOTO    11058--GOTO
DO$
        67**DCL      2162--IMP-PTR  2178--IMP-PTR 10870<<ASSIGN  10940>>IF      10944>>IF      10948>>CALL
     10948>>CALL    10948>>CALL    10951>>CALL    10953>>IF      10956>>CALL    10956>>CALL    10956>>CALL
     10959>>CALL    10973>>IF      11004>>IF      11055>>IF      11069<<ASSIGN  11070>>ASSIGN  11071>>ASSIGN
     11089>>IF      11093>>CALL    11093>>CALL    11093>>CALL    11095>>CALL    11141>>IF      11215>>ASSIGN
     11369>>ASSIGN
DUL$GETMVAL
     10844**DCL-ENT 10919--CALL    11461--CALL
DUM IN PROCEDURE IORVALUE
     11675**DCL     11683<>CALL
DUM IN PROCEDURE L6_IORVALUE
     11718**DCL     11727<>CALL
DUM2 IN PROCEDURE IORVALUE
     11676**DCL     11683<>CALL
DUM2 IN PROCEDURE L6_IORVALUE
     11719**DCL     11727<>CALL
DUQ$OCMSG
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:171  
     10847**DCL-ENT 11117--CALL    11580--CALL
DUQ$WRERRLOG
     10848**DCL-ENT 11192--CALL    11619--CALL
DUU$GETMVAL
     10842**DCL-ENT 10914--CALL    11456--CALL
DUU$PUTMVAL
     10843**DCL-ENT 11018--CALL    11102--CALL
DXQ$WRTPI
     10859**DCL-ENT 11187--CALL    11616--CALL
EVALUE
        52**DCL     10956<>CALL    10959<>CALL    11028<>CALL
EVALUE.OPS
        54**DCL     10964>>IF      10975<>CALL    10977<>CALL    10980<>CALL    10984<>CALL    10985<>CALL
EVALUE.SIZE
        53**DCL     10963>>DOINDEX 10977<>CALL    11004>>IF
EXPR_OP
        25**DCL     10897<>CALL
FMT
        57**DCL     10873<<ASSIGN  10877>>IF      10878<<ASSIGN  11071<<ASSIGN  11072>>IF      11073<<ASSIGN
     11128>>IF      11135>>IF      11145>>ASSIGN  11275<<ASSIGN  11300<<ASSIGN  11313<<ASSIGN  11316<<ASSIGN
     11319<<ASSIGN  11369<<ASSIGN  11499>>IF      11499>>IF      11502<<ASSIGN  11506>>IF      11509<<ASSIGN
     11512<<ASSIGN  11513>>ASSIGN  11514>>IF      11515<<ASSIGN  11517>>ASSIGN  11518>>ASSIGN  11524>>IF
     11531>>IF      11541<>CALL    11542>>IF      11564<>CALL    11565<>CALL    11592<>CALL    11601<>CALL
     11602<>CALL    11744>>IF
GD$MSG.BRKRQS.IF$CONST.SIZE
     10745**DCL     10745--REDEF
GD$MSG.BRKRQS.IF$CONST.TEXT
     10745**DCL     10746--REDEF   10746--REDEF   10747--REDEF   10748--REDEF
GD$MSG.BRKRSP.BRK#
     10759**DCL     10759--REDEF
GD$MSG.BRKRSP.USER#
     10759**DCL     10759--REDEF
GD$MSG.LETMEM_D.VALUE.SIZE
     10717**DCL     10717--REDEF
GD$MSG.LETMEM_D.VALUE.TEXT
     10718**DCL     10718--REDEF   10718--REDEF   10719--REDEF   10720--REDEF
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:172  
GD$MSG.MESSAGE
     10699**DCL     10699--REDEF   10700--REDEF   10700--REDEF   10701--REDEF   10712--REDEF   10725--REDEF
     10730--REDEF   10737--REDEF   10753--REDEF   10758--REDEF   10764--REDEF   10765--REDEF   10794--REDEF
     10796--REDEF   10807--REDEF   10814--REDEF   10826--REDEF
GD$MSG.SUBFNC
     10694**DCL     10694--REDEF   10698--REDEF
GD$MSG.TSA.I
     10766**DCL     10766--REDEF
GD$MSG.TSA.S
     10768**DCL     10768--REDEF
GD$MSG.USERQS.ASDT$
     10794**DCL     10794--REDEF   10795--REDEF
GOTIT
     10926**LABEL   10898--GOTO
I
        42**DCL     10963<<DOINDEX 10964>>IF      10964>>IF      10995<<ASSIGN  10996<>CALL
IFLAG IN PROCEDURE IORVALUE
     11651**DCL     11647--PROC    11678>>IF      11689>>IF
IFLAG IN PROCEDURE L6_IORVALUE
     11710**DCL     11701--PROC    11722>>IF
IORVALUE
     11647**PROC    10948--CALL    10956--CALL    11093--CALL
IS_AUTO
        56**DCL     10875<<ASSIGN  10876<<ASSIGN
L6_ADDRESS.L4
        19**DCL     11435<<ASSIGN  11441<<ASSIGN
L6_ADDRESS.R16
        20**DCL     11340<<ASSIGN  11436<<ASSIGN  11442<<ASSIGN
L6_DW.LW IN PROCEDURE L6_IORVALUE
     11716**DCL     11748>>ASSIGN  11751>>IF
L6_DW.UW IN PROCEDURE L6_IORVALUE
     11715**DCL     11747>>ASSIGN
L6_IORVALUE
     11701**PROC    10951--CALL    10959--CALL    11095--CALL
L6_TEMP1
        26**DCL        27--REDEF
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:173  
L6_TEMP2
        30**DCL        31--REDEF
L6_TEMP_VALUE
        34**DCL        35--REDEF
LAR.DESC#
        88**DCL     11400>>ASSIGN
LAR.OFFSET
        85**DCL     11394>>ASSIGN
LAR.PLUS
        86**DCL     11395>>IF
LAR.SEG
        87**DCL     11397>>ASSIGN
LINSTR.ADDRESS
        80**DCL     11377>>ASSIGN  11416>>ASSIGN  11417>>ASSIGN
LINSTR.BIT29
        82**DCL     11381>>IF
LINSTR.PADD
        77**DCL        80--REDEF
LINSTR.PADD.OFFSET
        79**DCL     11387>>ASSIGN
LINSTR.PADD.PNTR
        78**DCL     11382>>ASSIGN
LINSTR.TAG
        83**DCL     11380>>IF
LRELVAL.RH
        91**DCL     11412>>ASSIGN  11413>>ASSIGN
LVALUE
        75**DCL        76--REDEF      84--REDEF      89--REDEF   11370<<ASSIGN
MACT$CMD.AWDX
      2186**DCL     11093<>CALL
MACT$CMD.DDESC
      2182**DCL     11089>>IF
MACT$CMD.FORMAT
      2191**DCL      2192--REDEF   11071>>ASSIGN  11369>>ASSIGN
MACT$CMD.IGNPR
      2185**DCL     11093<>CALL
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:174  
MACT$CMD.INSTR
      2183**DCL     11093<>CALL    11095<>CALL    11141>>IF
MACT$CMD.NMSLASH
      2184**DCL     11070>>ASSIGN
MACT$CMD.SUBCODE
      2193**DCL     11215>>ASSIGN
MACTIVE
        40**DCL     10946<<ASSIGN  11001<<ASSIGN  11054<<ASSIGN  11114>>IF      11189>>IF      11468<<ASSIGN
     11487>>IF      11538>>IF      11558>>IF      11577>>IF      11593>>IF      11618>>IF
MERR
     11641**LABEL   10894--CALLALT 10897--CALLALT 10913--CALLALT 10914--CALLALT 10919--CALLALT 10925--CALLALT
     10926--CALLALT 10948--CALLALT 10951--CALLALT 10956--CALLALT 10959--CALLALT 10975--CALLALT 10977--CALLALT
     10980--CALLALT 10984--CALLALT 10985--CALLALT 11017--CALLALT 11018--CALLALT 11023--GOTO    11026--CALLALT
     11028--CALLALT 11033--CALLALT 11036--CALLALT 11093--CALLALT 11095--CALLALT 11101--CALLALT 11102--CALLALT
     11107--GOTO    11110--CALLALT 11112--CALLALT 11198--CALLALT 11201--CALLALT 11404--GOTO    11420--GOTO
     11429--GOTO    11446--GOTO    11455--CALLALT 11456--CALLALT 11461--CALLALT 11463--CALLALT 11465--CALLALT
     11484--CALLALT 11541--CALLALT 11587--CALLALT 11592--CALLALT
MERR1
     11628**LABEL   10900--GOTO    10935--GOTO    10952--GOTO    10961--GOTO    10978--GOTO    10987--GOTO
     11029--GOTO    11047--GOTO    11096--GOTO    11113--GOTO    11168--GOTO    11175--CALLALT 11210--GOTO
     11342--GOTO    11449--GOTO    11466--GOTO    11495--CALLALT 11561--CALLALT 11564--CALLALT 11565--CALLALT
     11567--CALLALT 11588--CALLALT 11598--CALLALT 11601--CALLALT 11602--CALLALT 11604--CALLALT
MERR2
     11632**LABEL   11181--CALLALT 11609--CALLALT
MOD$CMD.AWDX
      2169**DCL     10948<>CALL    10956<>CALL
MOD$CMD.DDESC
      2166**DCL     10944>>IF      10953>>IF
MOD$CMD.DW
      2170**DCL     10940>>IF
MOD$CMD.IGNPR
      2168**DCL     10948<>CALL    10956<>CALL
MOD$CMD.INSTR
      2167**DCL     10948<>CALL    10951<>CALL    10956<>CALL    10959<>CALL    10973>>IF
MOD$CMD.NWARN
      2171**DCL     11004>>IF
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:175  
MOD$CMD.SACT
      2173**DCL     11055>>IF
MOD_LOC IN PROCEDURE L6_IORVALUE
     11711**DCL     11701--PROC    11723<>CALL
MRTN
     11621**LABEL   11216--GOTO    11256--GOTO    11308--GOTO    11626--GOTO    11630--GOTO
MYBUF
        59**DCL        60--REDEF   10970--ASSIGN  10972--ASSIGN  10991--ASSIGN  11613<<ASSIGN  11615>>ASSIGN
MYBUF_R.TEXT
        62**DCL     10996--CALL
MYBUF_R.UBIN9
        61**DCL     10988<<ASSIGN  10989>>IF      10995>>ASSIGN
NCHARS
        65**DCL        66--IMP-SIZ 11173<<ASSIGN  11174>>ASSIGN  11489<<ASSIGN  11490>>ASSIGN  11492>>ASSIGN
NMSLASH
        69**DCL     10867<<ASSIGN  11070<<ASSIGN  11472>>IF      11516>>IF      11556>>IF      11621>>IF
NODE
        39**DCL     10911<<ASSIGN  10913<>CALL    10914<>CALL    11015<<ASSIGN  11017<>CALL    11018<>CALL
     11099<<ASSIGN  11101<>CALL    11102<>CALL    11181<>CALL    11453<<ASSIGN  11455<>CALL    11456<>CALL
     11609<>CALL
NOTINS
     11549**LABEL   11544--CALLALT
NOTINST
     11135**LABEL   11130--CALLALT
NOTINSTR
     11531**LABEL   11526--CALLALT
NOT_IS
        23**DCL     10894<>CALL    10897<>CALL    10914<>CALL    10919<>CALL    10925<>CALL    10926<>CALL
     10939>>ASSIGN  11018<>CALL    11026<>CALL    11028<>CALL    11030>>IF      11077<<ASSIGN  11102<>CALL
     11110<>CALL    11112<>CALL    11144>>IF      11195>>IF      11227>>IF      11259>>IF      11267>>IF
     11283>>IF      11293>>IF      11310>>IF      11371<<ASSIGN  11386<<ASSIGN  11390>>IF      11408<<ASSIGN
     11409<<ASSIGN  11456<>CALL    11461<>CALL    11463<>CALL    11465<>CALL    11477>>ASSIGN  11484<>CALL
     11587<>CALL
NOT_IS IN PROCEDURE IORVALUE
     11674**DCL     11683<>CALL    11684>>IF
NOT_IS IN PROCEDURE L6_IORVALUE
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:176  
     11720**DCL     11727<>CALL    11739>>IF
NVALUE
        49**DCL     10948<>CALL    10951<>CALL    11000<<ASSIGN  11018<>CALL    11028<>CALL    11053<<ASSIGN
     11093<>CALL    11095<>CALL    11102<>CALL    11112<>CALL    11456<>CALL    11465<>CALL    11493>>ASSIGN
NVALUE.OPS
        51**DCL     11026<>CALL    11110<>CALL    11123>>ASSIGN  11130<>CALL    11154<>CALL    11461<>CALL
     11463<>CALL    11519>>ASSIGN  11526<>CALL    11541<>CALL    11592<>CALL
NVALUE.SIZE
        50**DCL     11004>>IF      11033<>CALL    11036<>CALL    11198<>CALL    11201<>CALL    11209>>ASSIGN
     11459<<ASSIGN
OFFSET
        43**DCL     11376<<ASSIGN  11380<<ASSIGN  11385<<ASSIGN  11385>>ASSIGN  11391>>ASSIGN  11392>>ASSIGN
OLD_NOT_OLD
        41**DCL     10962<<ASSIGN  10965<<ASSIGN  10967>>IF
OVALUE
        46**DCL     10897<>CALL    10914<>CALL    10926<>CALL    11000>>ASSIGN  11038>>ASSIGN  11053>>ASSIGN
     11203>>ASSIGN
OVALUE.OPS
        48**DCL     10862>>ASSIGN  10919<>CALL    10925<>CALL    10930>>ASSIGN  10964>>IF      11119<<ASSIGN
     11544<>CALL    11564<>CALL    11565<>CALL    11601<>CALL    11602<>CALL
OVALUE.SIZE
        47**DCL     10917<<ASSIGN  10934>>ASSIGN  11121<<ASSIGN  11122<<ASSIGN  11161>>CALL    11162>>CALL
OVALUE.BIT29 IN PROCEDURE IORVALUE
     11667**DCL     11690>>IF
OVALUE.OFFSET IN PROCEDURE IORVALUE
     11665**DCL     11691<<ASSIGN
PLUS
        55**DCL     11396<<ASSIGN
PR
        95**DCL     11382<<ASSIGN
PR.AR.W
        97**DCL     11385>>ASSIGN
PR.SD.D
       101**DCL     11384>>ASSIGN
PR.SD.S
       100**DCL     11383>>ASSIGN
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:177  
RVALUE IN PROCEDURE IORVALUE
     11648**DCL     11647--PROC
RVALUE.OPS IN PROCEDURE IORVALUE
     11650**DCL     11695<<ASSIGN
RVALUE.SIZE IN PROCEDURE IORVALUE
     11649**DCL     11694<<ASSIGN
RVALUE IN PROCEDURE L6_IORVALUE
     11707**DCL     11701--PROC    11723<>CALL    11730<<ASSIGN
RVALUE.OPS IN PROCEDURE L6_IORVALUE
     11709**DCL     11735<<ASSIGN  11747<<ASSIGN  11748<<ASSIGN  11758<<ASSIGN
RVALUE.SIZE IN PROCEDURE L6_IORVALUE
     11708**DCL     11736<<ASSIGN  11746<<ASSIGN  11757<<ASSIGN
SAVE_DOMAIN
        92**DCL     10868<<ASSIGN  10907<<ASSIGN  11078<<ASSIGN  11084<<ASSIGN  11635>>IF      11641>>IF
SAVE_EXEC_DOMAIN
        93**DCL     10908<<ASSIGN  11085<<ASSIGN  11637>>ASSIGN  11643>>ASSIGN
SEG
        21**DCL     10894<>CALL    10897<>CALL    10903>>IF      10914<>CALL    10919<>CALL    10925<>CALL
     10926<>CALL    10937>>ASSIGN  11018<>CALL    11026<>CALL    11028<>CALL    11075<<ASSIGN  11079>>IF
     11102<>CALL    11110<>CALL    11112<>CALL    11144>>IF      11222>>IF      11227>>IF      11252>>IF
     11259>>IF      11267>>IF      11273<<ASSIGN  11283>>IF      11293>>IF      11298<<ASSIGN  11305>>IF
     11310>>IF      11383<<ASSIGN  11397<<ASSIGN  11398>>IF      11399<<ASSIGN  11406>>IF      11433<<ASSIGN
     11456<>CALL    11461<>CALL    11463<>CALL    11465<>CALL    11475>>ASSIGN  11484<>CALL    11534>>IF
     11534>>IF      11534>>IF      11587<>CALL
SETNA$
        70**DCL     10869<<ASSIGN  11045<<ASSIGN  11068<<ASSIGN  11551>>IF
SET_FMTMDW
     11310**LABEL   11265--GOTO
SIZE
        24**DCL     10897<>CALL
START$
        58**DCL     10970<<ASSIGN  10971>>ASSIGN  10988>>ASSIGN  11180<<ASSIGN  11181<>CALL    11570<<ASSIGN
     11571>>ASSIGN  11574<>CALL    11576<>CALL    11607<<ASSIGN  11608>>ASSIGN  11609<>CALL
SUPADR
        68**DCL     10866<<ASSIGN  11056<<ASSIGN  11066<<ASSIGN  11497>>IF      11590>>IF
S_D.ALIB_SAID_GOBACK
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:178  
      4426**DCL     11114>>IF      11189>>IF      11540>>ASSIGN  11577>>IF      11618>>IF
S_D.ANLZ
      4936**DCL     11114>>IF      11146>>IF      11189>>IF      11487>>IF      11577>>IF      11618>>IF
S_D.ANLZ_FILE
      5000**DCL     10918>>IF      11020>>IF      11104>>IF      11114>>IF      11189>>IF      11460>>IF
     11577>>IF      11618>>IF
S_D.ANLZ_MODIFIED
      5216**DCL     11114>>IF      11116<<ASSIGN  11577>>IF      11579<<ASSIGN
S_D.CURRENT_CHANNEL
      5236**DCL      5238--REDEF
S_D.D$
      4374**DCL     10871>>ASSIGN  10872>>ASSIGN  10971<<ASSIGN  10972>>ASSIGN  10988>>ASSIGN  11091>>ASSIGN
     11150<<ASSIGN  11151>>ASSIGN  11157>>ASSIGN  11163>>ASSIGN  11171>>IF      11172<<ASSIGN  11174>>ASSIGN
     11177>>ASSIGN  11480<<ASSIGN  11482>>ASSIGN  11486>>ASSIGN  11498<<ASSIGN  11560>>ASSIGN  11566>>ASSIGN
     11571>>ASSIGN  11584<<ASSIGN  11586>>ASSIGN  11591<<ASSIGN  11597>>ASSIGN  11603>>ASSIGN  11608>>ASSIGN
S_D.DEBUGA
      4388**DCL      4390--REDEF
S_D.DESC$
      4368**DCL     10871<<ASSIGN  11091<<ASSIGN  11680>>ASSIGN  11681<<ASSIGN  11681>>ASSIGN
S_D.DESCL$
      4370**DCL     10972<<ASSIGN  11149<<ASSIGN  11156<<ASSIGN  11156>>ASSIGN  11167<<ASSIGN  11167>>ASSIGN
     11171>>IF      11172>>ASSIGN  11482<<ASSIGN  11586<<ASSIGN
S_D.DO$
      4339**DCL     10870>>ASSIGN  11069>>ASSIGN
S_D.EIS
      5346**DCL      5375--REDEF   10865<<ASSIGN  11221<<ASSIGN  11282<<ASSIGN  11368<<ASSIGN
S_D.EIS_SHIFT.X
      5377**DCL     11221>>ASSIGN
S_D.ERROR
      4317**DCL     10969<<ASSIGN  11008<<ASSIGN  11022<<ASSIGN  11106<<ASSIGN  11168>>IF      11169<<ASSIGN
     11333<<ASSIGN  11348<<ASSIGN  11358<<ASSIGN  11403<<ASSIGN  11419<<ASSIGN  11428<<ASSIGN  11445<<ASSIGN
     11628<<ASSIGN  11632<<ASSIGN  11686<<ASSIGN  11741<<ASSIGN
S_D.ERROR_SYM$
      4341**DCL     10991<<ASSIGN  10997<<ASSIGN  11009<<ASSIGN
S_D.FMT_DEFAULT
      4572**DCL     11512>>ASSIGN
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:179  
S_D.FNDENTDEF
      4568**DCL     11483<<ASSIGN  11507>>IF
S_D.GOT#
      5014**DCL     11035>>IF      11200>>IF
S_D.GOT$L
      5325**DCL     10864<<ASSIGN  11004>>IF      11726<<ASSIGN  11733>>IF
S_D.GOT$RI
      5119**DCL     11725<<ASSIGN  11728>>IF
S_D.GOT@
      5004**DCL     11032>>IF      11197>>IF
S_D.HIGH#
      5044**DCL     11035>>IF      11200>>IF
S_D.HIGH@
      5038**DCL     11032>>IF      11197>>IF
S_D.HOST_MESSAGE_BUF_REMOTE
      5279**DCL      5280--REDEF    5294--REDEF
S_D.INPUT
      4551**DCL     11185>>ASSIGN  11614>>ASSIGN
S_D.ISBASE
      4566**DCL     11390>>IF      11390>>IF      11391>>ASSIGN  11411>>IF      11411>>IF      11412>>ASSIGN
     11415>>IF      11415>>IF      11416>>ASSIGN  11499>>IF      11499>>IF
S_D.IS_PTR
      5121**DCL     11267>>IF      11283>>IF
S_D.JDE
      4893**DCL      4894--REDEF
S_D.KILLEDEF
      4442**DCL     11503<<ASSIGN
S_D.L$.FMT
      4472**DCL     10878>>ASSIGN  11142<<ASSIGN  11143<<ASSIGN  11145<<ASSIGN  11154<>CALL    11326<<ASSIGN
     11351<<ASSIGN  11361<<ASSIGN  11373>>DOCASE  11423>>DOCASE  11515>>ASSIGN  11518<<ASSIGN
S_D.L$.L6_VALUE.OPS
      4470**DCL     11340>>ASSIGN  11435>>ASSIGN  11436>>ASSIGN  11439>>ASSIGN  11441>>ASSIGN  11442>>ASSIGN
S_D.L$.SIZE
      4471**DCL     10932<<ASSIGN  10934<<ASSIGN  10940>>IF      11121>>ASSIGN  11122>>ASSIGN  11125<<ASSIGN
     11139<<ASSIGN  11154<>CALL    11438>>IF      11521<<ASSIGN  11526<>CALL    11527<<ASSIGN  11527>>ASSIGN
     11532<<ASSIGN  11533<<ASSIGN  11535<<ASSIGN  11541<>CALL    11549>>ASSIGN  11553>>ASSIGN  11557>>ASSIGN
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:180  
     11592<>CALL    11736>>ASSIGN
S_D.L$.VALUE
      4446**DCL      4452--REDEF    4460--REDEF    4463--REDEF    4466--REDEF    4469--REDEF   10862<<ASSIGN
     10930<<ASSIGN  11119>>ASSIGN  11123<<ASSIGN  11519<<ASSIGN  11735>>ASSIGN
S_D.L$.VALUE.L
      4447**DCL      4448--REDEF    4449--REDEF   11370>>ASSIGN
S_D.L6_MESSAGE_BUF
      5300**DCL      5302--REDEF
S_D.L6_TAB
      5338**DCL     11425>>IF
S_D.L6_TAB_VALUE
      5340**DCL     11426>>ASSIGN
S_D.MACTIVE
      4557**DCL     11067<<ASSIGN  11540<<ASSIGN  11573>>IF      11595<<ASSIGN  11623<<ASSIGN
S_D.MDW
      5327**DCL     10941<<ASSIGN  10942<<ASSIGN  10983>>IF      11135>>IF      11276<<ASSIGN  11301<<ASSIGN
     11314<<ASSIGN  11317<<ASSIGN  11320<<ASSIGN  11504<<ASSIGN  11510<<ASSIGN  11524>>IF      11531>>IF
     11744>>IF
S_D.NA$
      5028**DCL     11041<<ASSIGN  11044<<ASSIGN  11206<<ASSIGN  11209<<ASSIGN  11553<<ASSIGN  11553>>ASSIGN
S_D.NEXT#
      5016**DCL     11035>>IF      11200>>IF
S_D.NEXT@
      5006**DCL     11032>>IF      11197>>IF
S_D.O$.ADDRESS
      4477**DCL     10936<<ASSIGN  11074>>ASSIGN  11474<<ASSIGN
S_D.O$.DESC#
      4476**DCL     10938<<ASSIGN  11076>>ASSIGN  11476<<ASSIGN
S_D.O$.FMT
      4479**DCL     11073>>ASSIGN  11517<<ASSIGN
S_D.O$.NOT_IS
      4478**DCL     10939<<ASSIGN  11077>>ASSIGN  11378>>IF      11477<<ASSIGN
S_D.O$.SEG
      4475**DCL     10937<<ASSIGN  11075>>ASSIGN  11475<<ASSIGN
S_D.O$SIZE
      5398**DCL     11130<>CALL    11136<<ASSIGN  11137<<ASSIGN  11139>>ASSIGN  11226>>ASSIGN  11557<<ASSIGN
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:181  
S_D.ONE_TO_TWO.EXEC_DOMAIN
      5311**DCL     10874>>IF      10879>>IF      10895>>IF      10903>>IF      10908>>ASSIGN  10909<<ASSIGN
     10920>>IF      10931>>IF      10933>>IF      10947>>IF      10950>>IF      10955>>IF      10958>>IF
     10974>>IF      10976>>IF      10979>>IF      10981>>IF      11025>>IF      11027>>IF      11039>>IF
     11042>>IF      11079>>IF      11085>>ASSIGN  11086<<ASSIGN  11092>>IF      11094>>IF      11109>>IF
     11111>>IF      11120>>IF      11124>>IF      11126>>IF      11160>>IF      11204>>IF      11207>>IF
     11222>>IF      11225>>IF      11305>>IF      11331>>IF      11337>>IF      11346>>IF      11356>>IF
     11372>>IF      11422>>IF      11462>>IF      11464>>IF      11520>>IF      11522>>IF      11563>>IF
     11600>>IF      11637<<ASSIGN  11643<<ASSIGN
S_D.OUTPUT
      5266**DCL      5268--REDEF   11191<<ASSIGN  11480--ASSIGN  11481<<ASSIGN  11482--ASSIGN  11489--ASSIGN
     11492>>ASSIGN  11498--ASSIGN  11570--ASSIGN  11584--ASSIGN  11585<<ASSIGN  11586--ASSIGN  11591--ASSIGN
     11607--ASSIGN  11613>>ASSIGN
S_D.OVERLAID
      4950**DCL     10912>>IF      11016>>IF      11100>>IF      11454>>IF
S_D.PATCH
      4932**DCL     11146>>IF      11183>>IF      11611>>IF
S_D.PCHARS
      4994**DCL     11150>>ASSIGN  11490<<ASSIGN
S_D.PIMAGE
      4992**DCL     11149--ASSIGN  11149--ASSIGN  11150--ASSIGN  11177--ASSIGN  11180--ASSIGN  11186>>ASSIGN
     11191>>ASSIGN  11491<<ASSIGN  11492--ASSIGN
S_D.POFMT
      5036**DCL     11143>>ASSIGN  11161<>CALL    11162<>CALL    11513<<ASSIGN
S_D.POVALUE
      5032**DCL     11493<<ASSIGN
S_D.POVALUE.OPS
      5034**DCL     11161<>CALL    11162<>CALL
S_D.REMOTE_MSG.FNCC
      5285**DCL      5286--REDEF
S_D.REMOTE_MSG.STXC
      5281**DCL      5282--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5289**DCL      5290--REDEF
S_D.RI$
      5024**DCL     11038<<ASSIGN  11203<<ASSIGN  11730>>ASSIGN
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:182  
S_D.RI$.SIZE
      5025**DCL     11554<<ASSIGN
S_D.RUM
      4934**DCL     10879>>IF      10901>>IF      11013>>IF      11079>>IF      11097>>IF      11146>>IF
     11178>>IF      11451>>IF      11487>>IF      11582>>IF
S_D.RUM_TEST
      4982**DCL     11178>>IF      11582>>IF
S_D.SDOT
      4910**DCL     11751>>IF
S_D.SILENT
      4902**DCL     11572>>IF
S_D.STEP
      4570**DCL     11624<<ASSIGN
S_D.SV
      4345**DCL      4366--REDEF
S_D.USS$
      4305**DCL     11382>>ASSIGN
S_D.XDP
      5268**DCL     11187--CALL    11616--CALL
S_D.XDP.IMAGE
      5270**DCL     11187--CALL    11616--CALL
S_D.XDP.IMAGE.INP
      5272**DCL     11185<<ASSIGN  11614<<ASSIGN
S_D.XDP.IMAGE.OTP
      5274**DCL     11186<<ASSIGN  11615<<ASSIGN
S_D$
      5597**DCL      4293--IMP-PTR 10862>>ASSIGN  10864>>ASSIGN  10865>>ASSIGN  10870>>ASSIGN  10871>>ASSIGN
     10871>>ASSIGN  10872>>ASSIGN  10874>>IF      10878>>ASSIGN  10879>>IF      10879>>IF      10895>>IF
     10901>>IF      10903>>IF      10908>>ASSIGN  10909>>ASSIGN  10912>>IF      10918>>IF      10920>>IF
     10930>>ASSIGN  10931>>IF      10932>>ASSIGN  10933>>IF      10934>>ASSIGN  10936>>ASSIGN  10937>>ASSIGN
     10938>>ASSIGN  10939>>ASSIGN  10940>>IF      10941>>ASSIGN  10942>>ASSIGN  10947>>IF      10950>>IF
     10955>>IF      10958>>IF      10969>>ASSIGN  10971>>ASSIGN  10972>>ASSIGN  10972>>ASSIGN  10974>>IF
     10976>>IF      10979>>IF      10981>>IF      10983>>IF      10988>>ASSIGN  10991>>ASSIGN  10997>>ASSIGN
     11004>>IF      11008>>ASSIGN  11009>>ASSIGN  11013>>IF      11016>>IF      11020>>IF      11022>>ASSIGN
     11025>>IF      11027>>IF      11032>>IF      11032>>IF      11032>>IF      11035>>IF      11035>>IF
     11035>>IF      11038>>ASSIGN  11039>>IF      11041>>ASSIGN  11042>>IF      11044>>ASSIGN  11067>>ASSIGN
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:183  
     11069>>ASSIGN  11073>>ASSIGN  11074>>ASSIGN  11075>>ASSIGN  11076>>ASSIGN  11077>>ASSIGN  11079>>IF
     11079>>IF      11085>>ASSIGN  11086>>ASSIGN  11091>>ASSIGN  11091>>ASSIGN  11092>>IF      11094>>IF
     11097>>IF      11100>>IF      11104>>IF      11106>>ASSIGN  11109>>IF      11111>>IF      11114>>IF
     11114>>IF      11114>>IF      11114>>IF      11116>>ASSIGN  11119>>ASSIGN  11120>>IF      11121>>ASSIGN
     11122>>ASSIGN  11123>>ASSIGN  11124>>IF      11125>>ASSIGN  11126>>IF      11130>>CALL    11135>>IF
     11136>>ASSIGN  11137>>ASSIGN  11139>>ASSIGN  11139>>ASSIGN  11142>>ASSIGN  11143>>ASSIGN  11143>>ASSIGN
     11145>>ASSIGN  11146>>IF      11146>>IF      11146>>IF      11149>>ASSIGN  11149>>ASSIGN  11150>>ASSIGN
     11150>>ASSIGN  11150>>ASSIGN  11151>>ASSIGN  11154>>CALL    11154>>CALL    11156>>ASSIGN  11156>>ASSIGN
     11157>>ASSIGN  11160>>IF      11161>>CALL    11161>>CALL    11162>>CALL    11162>>CALL    11163>>ASSIGN
     11167>>ASSIGN  11167>>ASSIGN  11168>>IF      11169>>ASSIGN  11171>>IF      11171>>IF      11172>>ASSIGN
     11172>>ASSIGN  11174>>ASSIGN  11177>>ASSIGN  11177>>ASSIGN  11178>>IF      11178>>IF      11180>>ASSIGN
     11183>>IF      11185>>ASSIGN  11185>>ASSIGN  11186>>ASSIGN  11186>>ASSIGN  11187>>CALL    11189>>IF
     11189>>IF      11189>>IF      11191>>ASSIGN  11191>>ASSIGN  11197>>IF      11197>>IF      11197>>IF
     11200>>IF      11200>>IF      11200>>IF      11203>>ASSIGN  11204>>IF      11206>>ASSIGN  11207>>IF
     11209>>ASSIGN  11221>>ASSIGN  11221>>ASSIGN  11222>>IF      11225>>IF      11226>>ASSIGN  11267>>IF
     11276>>ASSIGN  11282>>ASSIGN  11283>>IF      11301>>ASSIGN  11305>>IF      11314>>ASSIGN  11317>>ASSIGN
     11320>>ASSIGN  11326>>ASSIGN  11331>>IF      11333>>ASSIGN  11337>>IF      11340>>ASSIGN  11346>>IF
     11348>>ASSIGN  11351>>ASSIGN  11356>>IF      11358>>ASSIGN  11361>>ASSIGN  11368>>ASSIGN  11370>>ASSIGN
     11372>>IF      11373>>DOCASE  11378>>IF      11382>>ASSIGN  11390>>IF      11390>>IF      11391>>ASSIGN
     11403>>ASSIGN  11411>>IF      11411>>IF      11412>>ASSIGN  11415>>IF      11415>>IF      11416>>ASSIGN
     11419>>ASSIGN  11422>>IF      11423>>DOCASE  11425>>IF      11426>>ASSIGN  11428>>ASSIGN  11435>>ASSIGN
     11436>>ASSIGN  11438>>IF      11439>>ASSIGN  11441>>ASSIGN  11442>>ASSIGN  11445>>ASSIGN  11451>>IF
     11454>>IF      11460>>IF      11462>>IF      11464>>IF      11474>>ASSIGN  11475>>ASSIGN  11476>>ASSIGN
     11477>>ASSIGN  11480>>ASSIGN  11480>>ASSIGN  11481>>ASSIGN  11482>>ASSIGN  11482>>ASSIGN  11483>>ASSIGN
     11486>>ASSIGN  11487>>IF      11487>>IF      11489>>ASSIGN  11490>>ASSIGN  11491>>ASSIGN  11492>>ASSIGN
     11492>>ASSIGN  11493>>ASSIGN  11498>>ASSIGN  11498>>ASSIGN  11499>>IF      11499>>IF      11503>>ASSIGN
     11504>>ASSIGN  11507>>IF      11510>>ASSIGN  11512>>ASSIGN  11513>>ASSIGN  11515>>ASSIGN  11517>>ASSIGN
     11518>>ASSIGN  11519>>ASSIGN  11520>>IF      11521>>ASSIGN  11522>>IF      11524>>IF      11526>>CALL
     11527>>ASSIGN  11527>>ASSIGN  11531>>IF      11532>>ASSIGN  11533>>ASSIGN  11535>>ASSIGN  11540>>ASSIGN
     11540>>ASSIGN  11541>>CALL    11549>>ASSIGN  11553>>ASSIGN  11553>>ASSIGN  11553>>ASSIGN  11554>>ASSIGN
     11557>>ASSIGN  11557>>ASSIGN  11560>>ASSIGN  11563>>IF      11566>>ASSIGN  11570>>ASSIGN  11571>>ASSIGN
     11572>>IF      11573>>IF      11577>>IF      11577>>IF      11577>>IF      11577>>IF      11579>>ASSIGN
     11582>>IF      11582>>IF      11584>>ASSIGN  11584>>ASSIGN  11585>>ASSIGN  11586>>ASSIGN  11586>>ASSIGN
     11591>>ASSIGN  11591>>ASSIGN  11592>>CALL    11595>>ASSIGN  11597>>ASSIGN  11600>>IF      11603>>ASSIGN
     11607>>ASSIGN  11608>>ASSIGN  11611>>IF      11613>>ASSIGN  11614>>ASSIGN  11614>>ASSIGN  11615>>ASSIGN
     11616>>CALL    11618>>IF      11618>>IF      11618>>IF      11623>>ASSIGN  11624>>ASSIGN  11628>>ASSIGN
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:184  
     11632>>ASSIGN  11637>>ASSIGN  11643>>ASSIGN  11680>>ASSIGN  11681>>ASSIGN  11681>>ASSIGN  11686>>ASSIGN
     11725>>ASSIGN  11726>>ASSIGN  11728>>IF      11730>>ASSIGN  11733>>IF      11735>>ASSIGN  11736>>ASSIGN
     11741>>ASSIGN  11744>>IF      11751>>IF
S_D_L6_MESSAGE$
      5634**DCL     10694--IMP-PTR
TAB
     11368**LABEL   11327--GOTO    11352--GOTO    11362--GOTO
TADDRESS
        44**DCL     11377<<ASSIGN  11387<<ASSIGN  11391>>ASSIGN  11392>>ASSIGN
TEMP
        72**DCL     11177<<ASSIGN  11181<>CALL    11192<>CALL    11231<<ASSIGN  11233<<ASSIGN  11235<<ASSIGN
     11237<<ASSIGN  11239<<ASSIGN  11241<<ASSIGN  11243<<ASSIGN  11245<<ASSIGN  11247>>IF      11571<<ASSIGN
     11574<>CALL    11576<>CALL    11608<<ASSIGN  11609<>CALL    11619<>CALL
TEXT$
        64**DCL     11151<<ASSIGN  11153>>ASSIGN  11157<<ASSIGN  11159>>ASSIGN  11163<<ASSIGN  11165>>ASSIGN
     11486<<ASSIGN  11489>>ASSIGN  11496>>ASSIGN  11560<<ASSIGN  11562>>ASSIGN  11566<<ASSIGN  11568>>ASSIGN
     11589>>ASSIGN  11597<<ASSIGN  11599>>ASSIGN  11603<<ASSIGN  11605>>ASSIGN
TEXTR
        66**DCL     11174<<ASSIGN  11492<<ASSIGN
TSIZE
        71**DCL     11544<>CALL    11545<<ASSIGN  11545>>ASSIGN  11549<<ASSIGN  11554>>ASSIGN  11565<>CALL
     11602<>CALL
UBIN36 IN PROCEDURE IORVALUE
     11672**DCL     11680>>ASSIGN
VALUE IN PROCEDURE IORVALUE
     11662**DCL     11663--REDEF   11669--REDEF   11680<<ASSIGN  11693<<ASSIGN  11695>>ASSIGN
XFLAG IN PROCEDURE IORVALUE
     11653**DCL     11647--PROC    11690>>IF
YVALUE.Y IN PROCEDURE IORVALUE
     11670**DCL     11692<<ASSIGN
ZFLAG IN PROCEDURE IORVALUE
     11652**DCL     11647--PROC    11690>>IF
ZITEM.ADDRESS
       821**DCL       826--REDEF     827--REDEF     828--REDEF
ZITEM.ADDR_TYPE
       815**DCL     10874>>IF      10879>>IF      10920>>IF
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:185  
ZITEM.FMT_SPEC
       817**DCL     10873>>ASSIGN
ZITEM.SP.VD
       829**DCL       833--REDEF     836--REDEF
ZITEM.SP.VS.ID
       837**DCL     10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF
     10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF
     10920>>IF      10920>>IF      10920>>IF
ZITEM$
       210**DCL       787--IMP-PTR 10872<<ASSIGN  10873>>ASSIGN  10874>>IF      10879>>IF      10879>>IF
     10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF
     10879>>IF      10879>>IF      10879>>IF      10879>>IF      10879>>IF      10920>>IF      10920>>IF
     10920>>IF      10920>>IF
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:186  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:187  
              MINI UREF LISTING

ADDRESSB IN PROCEDURE L6_IORVALUE  11717**DCL
DDA$MACTIVE   11064**ENTRY
DDA$MOD      12**PROC
L6_TEMP1_WORD      27**DCL
L6_TEMP2_WORD      31**DCL
L6_TEMP_VALUE_WORD      35**DCL
SDD$     209**DCL
SDD_L6$     211**DCL
S_D_ACCESS$    5612**DCL
S_D_ANLZ$    5614**DCL
S_D_ASTACKOFF$    5613**DCL
S_D_BREAK$    5615**DCL
S_D_DO_SCAN$    5616**DCL
S_D_ERROR$    5617**DCL
S_D_FAULTCMD$$    5618**DCL
S_D_FAULTINS$$    5619**DCL
S_D_GOIC$    5620**DCL
S_D_GO_MODE$    5621**DCL
S_D_HOST_MESSAGE$    5633**DCL
S_D_HW_PTB_UNITS$    5637**DCL
S_D_HW_RES_MEM$    5635**DCL
S_D_HW_WSQ0PT$    5636**DCL
S_D_IPRFLT$    5623**DCL
S_D_IXFIX$    5622**DCL
S_D_REM_ACCESS$    5624**DCL
S_D_REM_DISKBOOT$    5626**DCL
S_D_REM_DO_SCAN$    5625**DCL
S_D_RETURNN$    5627**DCL
S_D_SAD$    5628**DCL
S_D_SAVEIC$    5629**DCL
S_D_SEG$    5611**DCL
S_D_TCB$$    5630**DCL
PL6.E3A0      #001=DDA$MOD File=DDA$MOD.:E05TSI                                  TUE 07/29/97 13:33 Page:188  
S_D_UREG$$    5631**DCL
S_D_USS$$    5632**DCL
VALUE      45**DCL
ZITEM_L6$     212**DCL
