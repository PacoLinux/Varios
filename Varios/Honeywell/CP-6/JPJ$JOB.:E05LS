VERSION E05

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:1    
        1        1        /*M*    JPJ$JOB     Process the JOB command in PRESCAN                        */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8        JPJ$JOB: PROC ALTRET;
        9        9        /***** Include files *****/
       10       10          %INCLUDE AS_SUPER_C;
       11      445 S        %INCLUDE B$JIT_C;
       12      446          %INCLUDE B_ERRORS_C;
       13     1573          %INCLUDE CP_6;
       14     1654          %INCLUDE CP_6_SUBS;
       15     2194          %INCLUDE CP_MACROS_C;
       16     2946          %INCLUDE CP_SUBS_C;
       17     3863          %INCLUDE FM$FIT;
       18     4084          %INCLUDE FS$FIT;
       19     4127          %INCLUDE JM$STRUCT;
       20     4872          %INCLUDE JM_SUBS_C;
       21     4978          %INCLUDE JP_MACRO_C;
       22     5133          %INCLUDE JP_PERR_C;
       23     5151          %INCLUDE KL_SUPER_C;
       24     8053          %INCLUDE XSJ_MAC_C;
       25     8132          %INCLUDE XSJ_SUBS_C;
       26     8159          %INCLUDE XU_MACRO_C;
       27    11265          %INCLUDE XU_PERR_C;
       28    11456          %INCLUDE JP_DATA_R;
       29    12001          %INCLUDE ES_SUBS_E;
       30    12027          %INCLUDE PC_SUBS_C;
       31    12359          %INCLUDE EL_SUBS_C;
       32    12443        /***** External routines *****/
       33    12444    1     DCL   ASZ$SCRAMBLE   ENTRY(1);
       34    12445    1     DCL   CPD$SET_NODES  ENTRY(4);
       35    12446    1     DCL   CPD$SYNTAX     ENTRY(1)    ALTRET;
       36    12447    1     DCL   CPD$SYNTRY     ENTRY(1);
       37    12448    1     DCL   CXP$POSTERR    ENTRY(5);
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:2    
       38    12449    1     DCL   CPX$JOB        ENTRY(1);
       39    12450    1     DCL   JPA$CONTINUE    ENTRY(1);
       40    12451    1     DCL   JPE$ERRORS     ENTRY(2);
       41    12452    1     DCL   JPE$REASON     ENTRY(1);
       42    12453    1     DCL   JPT$REPORT    ENTRY(1);
       43    12454    1     DCL   X$PARSE        ENTRY(1)    ALTRET;
       44    12455    1     DCL   XSJ$READ       ENTRY(1)    ALTRET;
       45    12456    1     DCL   XSJ$WRITE      ENTRY(1)    ALTRET;
       46    12457        /***** Symref data *****/
       47    12458    1     DCL B$JIT0_LO$ PTR SYMREF;
       48    12459    1     DCL LO_WSN CHAR(8) SYMREF;
       49    12460    1     DCL INSYM_INFO$ PTR SYMREF;
       50    12461    1     DCL CODE04$ PTR SYMREF;
       51    12462        %ERR_BLK (STCLASS="SYMREF");
       52    12487        %P$PCB(NAME = PCB,STCLASS = SYMREF);
       53    12688        %U$PARAM(NAME = U$PARAM,STCLASS = SYMREF);
       54    12704        %JP_CONTINUE (STCLASS = SYMREF);
       55    12710        /***** Fpts *****/
       56    12711        %FPT_OPEN(FPTN = OPEN_LO,STCLASS = SYMREF);
       57    12820        %VLP_HDR (FPTN=ABORTHDR,STCLASS=SYMREF,LEN="ABORTHDR.TITL.L#");
       58    12836        %FPT_WRITE(FPTN = FPT_REWRITE,DCB = M$EI,REWRITE = YES);
       59    12867        %FPT_TIME(FPTN = DEFER_TSTAMP,SOURCE = LOCAL,DEST = UTS,
       60    12868                  TSTAMP = DEFER_UTS,STCLASS = STATIC);
       61    12887        %FPT_TIME(FPTN = TODAYS_DATE,SOURCE = CLOCK,DEST = LOCAL,
       62    12888                  DATE = DEFER_DATE,STCLASS = CONSTANT);
       63    12907        %FPT_PRECORD (DCB = M$EI,KEYS = NO,BOF = YES,STCLASS = STATIC);
       64    12928        %FPT_READ(FPTN = READ_USERS,STCLASS = CONSTANT,
       65    12929                  DCB = M$USERS,
       66    12930                  BUF = AS_USERS,
       67    12931                  KEY = UKEY,
       68    12932                  KEYS = YES);
       69    12971        %FPT_READ(FPTN = READ_HLP,STCLASS = CONSTANT,
       70    12972                  DCB = M$HLP,
       71    12973                  BUF = KL_DREC,
       72    12974                  KEY = UKEY,
       73    12975                  KEYS = YES);
       74    13014        /***** Based variables *****/
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:3    
       75    13015        %JM_IF (FPTN=JOB_TBL,FIT = YES,STCLASS=SYMREF);
       76    13173        %PARSE$OUT(NAME = P$B,STCLASS = BASED);
       77    13218        %PARSE$SYM(NAME = P$S,STCLASS = BASED);
       78    13256    1     DCL      T$BUF    CHAR(4096)     BASED    ALIGNED;
       79    13257        %CODE04 (BASED="BASED(CODE04$)");
       80    13265        %FS$JOBORIG(NAME = INSYM$INFO,STCLASS = "BASED(INSYM_INFO$)");
       81    13271        %B$JIT0;
       82    13360    1           2 * BIT(1);
       83    13361        /***** Static data *****/
       84    13362    1     DCL DEFER_UTS UBIN WORD STATIC;
       85    13363    1     DCL DEFER_DATE CHAR(8) STATIC;
       86    13364    1     DCL DEFER_TIME CHAR(5) STATIC;
       87    13365    1     DCL 1 UKEY STATIC,
       88    13366    1           2 LEN UBIN BYTE UNAL,
       89    13367    1           2 KEY,
       90    13368    1             3 ACCN CHAR(8), /* SIZEC(B$JIT.ACCN) */
       91    13369    1             3 UNAME CHAR(12), /* SIZEC(B$JIT.UNAME) */
       92    13370    1           2 KEY_ARY(0:19) REDEF KEY CHAR(1);
       93    13371        %XSJ_PARAM(FPTN = XSJ_PARAM,TYPE = %TYP_NAME#,DCB = M$JOBSTAT,
       94    13372                   NAME = FOL_NAME,ACCT = FOL_ACCT,STCLASS = STATIC);
       95    13389    1     DCL FOL_NAME CHAR(31) STATIC;
       96    13390    1     DCL FOL_ACCT CHAR(8) STATIC DALIGNED;
       97    13391        /***** Constant Variables *****/
       98    13392    1     DCL 1 LEGAL_LENGTH CONSTANT ALIGNED,
       99    13393    1           2 LEN(0:2) UBIN BYTE UNAL INIT(8,12,8); /* ACCN,UNAME,UPASS */
      100    13394        /***** Auto variables *****/
      101    13395    1     DCL   I        SBIN     WORD;
      102    13396    1     DCL   J        SBIN     WORD;
      103    13397    1     DCL   K        SBIN     WORD;
      104    13398    1     DCL   P$       PTR;
      105    13399    1     DCL   T$       PTR;
      106    13400    1     DCL   T2$      PTR;
      107    13401    1     DCL CALL_FLAG# BIT(1) ALIGNED AUTO;
      108    13402    1     DCL UPASS CHAR(8);
      109    13403    1     DCL SAVE_UPASS CHAR(8);
      110    13404    1     DCL PASS_POS UBIN WORD AUTO;
      111    13405    1     DCL COMMA_POS UBIN WORD AUTO;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:4    
      112    13406    1     DCL SAVE_ERR BIT(36) AUTO;
      113    13407    1     DCL PASS_SPECIFIED# BIT(1) SYMREF;
      114    13408    1     DCL ES_FLG BIT(1) ALIGNED;
      115    13409        %PARSE$OUT(NAME = JOB_BLK,STCLASS = AUTO);
      116    13454        /***** Error messages *****/
      117    13455        %ERR_CODE(NAME=E_NOID,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPNOID,STCLASS=CONSTANT);
      118    13475        /*E* ERROR: JPJ-E$JPNOID
      119    13476             MESSAGE: No ID.
      120    13477        */
      121    13478        %ERR_CODE(NAME=E_NONAME,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPNONAME,STCLASS=
             13478            CONSTANT);
      122    13498        /*E* ERROR: JPJ-E$JPNONAME
      123    13499             MESSAGE: The job this one is to follow does not exist.
      124    13500        */
      125    13501        %ERR_CODE(NAME=E_BADWSN,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPBADWSN,STCLASS=
             13501            CONSTANT);
      126    13521        /*E* ERROR: JPJ-E$JPBADWSN
      127    13522             MESSAGE: An unknown WSN was specified.
      128    13523        */
      129    13524        %ERR_CODE(NAME=E_CANTWSN,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPCANTWSN,STCLASS=
             13524            CONSTANT);
      130    13544        /*E* ERROR: JPJ-E$JPCANTWSN
      131    13545             MESSAGE: The WSN specified does not allow access from this account.
      132    13546        */
      133    13547        %ERR_CODE(NAME=E_MANYFOLLOW,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPMANYFOLLOW,STCLASS
             13547            =CONSTANT);
      134    13567        /*E* ERROR: JPJ-E$JPMANYFOLLOW
      135    13568             MESSAGE: A maximum of 8 FOLLOW jobnames may be specified.
      136    13569        */
      137    13570        %ERR_CODE(NAME=E_BADID,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPBADID,STCLASS=CONSTANT)
             13570            ;
      138    13590        /*E* ERROR: JPJ-E$JPBADID
      139    13591             MESSAGE: Illegal ID.
      140    13592        */
      141    13593        %ERR_CODE(NAME=E_MAXPRIO,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPMAXPRIO,STCLASS=
             13593            CONSTANT);
      142    13613        /*E* ERROR: JPJ-E$JPMAXPRIO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:5    
      143    13614             MESSAGE: The PRIO specified exceeds this account's maximum.
      144    13615        */
      145    13616        %ERR_CODE(NAME=E_NOBATCH,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPNOBATCH,STCLASS=
             13616            CONSTANT);
      146    13636        /*E* ERROR: JPJ-E$JPNOBATCH
      147    13637             MESSAGE: This account is not authorized to run in BATCH mode.
      148    13638        */
      149    13639        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:6    
      150    13640    1       SUBSTR(ABORTHDR.TITL.TITLE#,2,8)='UNKNOWN';
      151    13641    1       SUBSTR(ABORTHDR.TITL.TITLE#,10,12)='UNKNOWN';
      152    13642    1       UPASS = ' ';
      153    13643    1       UKEY.KEY.ACCN = CODE04.CREATOR.ACCT;
      154    13644    1       UKEY.KEY.UNAME = CODE04.CREATOR.NAME;
      155    13645    1       UKEY.LEN = SIZEC(UKEY.KEY);
      156    13646    1       CALL ASZ$SCRAMBLE(UPASS); /* Default password */
      157    13647    1       UKEY.LEN = 0; /* If unaltered, will cause E$JPNOID error */
      158    13648        /*
      159    13649             ***** Setup everything for call to CPD$SYNTAX
      160    13650                   Throw away old errors.
      161    13651                   Setup fake P$B -> JOBCMND to drive second parse ...
      162    13652        */
      163    13653    1       ERR_BLK.FIRST = 0;
      164    13654    1       JOB_BLK = %NO#;
      165    13655    1       JOB_BLK.CODE = JOBCMND;
      166    13656    1       PCB.OUT$ = ADDR(JOB_BLK); /* To let CPD$SYNTAX work correctly */
      167    13657    1       PCB.NCHARS = PCB.NCHARS - 1;
      168    13658    1       U$PARAM.CNTU$$ = ENTADDR(JPA$CONTINUE);
      169    13659    1       U$PARAM.REMEM_CONTEXT_ERR$ = ADDR(NIL);
      170    13660    1       PCB.U$$ = ENTADDR(CPD$SYNTRY);
      171    13661    1       PCB.CONTINUE = '1'B;
      172    13662    1       CALL CPD$SET_NODES(PCB,PCB.ROOT$,U$PARAM.SPCL$$,CALL_FLAG#);
      173    13663    1       CALL X$PARSE(PCB) ALTRET(E_SYNTAX);
      174    13664        /*
      175    13665             ***** Process the SCAN option even if there are context errors ...
      176    13666        */
      177    13667    2       DO I = 0 TO PCB.OUT$->P$B.NSUBLKS-1;
      178    13668    2         IF PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = JOB_SCAN
      179    13669    2         THEN
      180    13670    2           SCAN_CMDS# = %YES#;
      181    13671    2       END;
      182    13672        /*
      183    13673             ***** Process parsed command if no errors ...
      184    13674        */
      185    13675    1       IF ERR_BLK.FIRST = 0
      186    13676    1       THEN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:7    
      187    13677    2         DO; /* If no errors then get name,acct,password */
      188    13678    2           IF PCB.OUT$->P$B.NSUBLKS>0 AND PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE =
             13678                    JOB_ACCTNAME
      189    13679    2           THEN
      190    13680    3             DO;
      191    13681    3               UKEY.KEY.ACCN = PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$S.TEXT;
      192    13682    3               UKEY.KEY.UNAME = PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$S.TEXT;
      193    13683    3               UKEY.LEN = SIZEC(UKEY.KEY);
      194    13684    3               IF PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS>2
      195    13685    3               THEN
      196    13686    4                 DO;
      197    13687    4                   PASS_SPECIFIED# = %YES#;
      198    13688    4                   P$ = PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(2);
      199    13689    4                   PASS_POS = P$->P$S.CPOS;
      200    13690    4                   UPASS = P$->P$S.TEXT;
      201    13691    4                   SAVE_UPASS = UPASS;
      202    13692    4                   CALL ASZ$SCRAMBLE(UPASS);
      203    13693    4                   COMMA_POS = PASS_POS;
      204    13694    5                   DO UNTIL SUBSTR(PCB.TEXT$->T$BUF,COMMA_POS,1) = ',';
      205    13695        /*
      206    13696             ***** Only the comma still needs blanking - CPX$JOB did the rest.
      207    13697        */
      208    13698    5                     COMMA_POS = COMMA_POS - 1;
      209    13699    5                     IF SUBSTR(PCB.TEXT$->T$BUF,COMMA_POS,1) = '"'
      210    13700    5                     THEN
      211    13701    6                       DO UNTIL SUBSTR(PCB.TEXT$->T$BUF,COMMA_POS,1) = '"';
      212    13702    6                         COMMA_POS = COMMA_POS - 1;
      213    13703    6                       END;
      214    13704    5                   END;
      215    13705    4                   SUBSTR(PCB.TEXT$->T$BUF,COMMA_POS,1) = ' ';
      216    13706    4                 END;
      217    13707    3             END;
      218    13708    2           ELSE   /* No ACCT,NAME specified. */
      219    13709    2             IF INSYM$INFO.FLAG = JOBORIG_DEVICE#
      220    13710    2             THEN   /* Came from 'CARD READER' */
      221    13711    3               DO;   /* Flush this job */
      222    13712    3                 CALL JPE$REASON(%REJ_BADID#);
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:8    
      223    13713    3                 CALL CXP$POSTERR(ADDR(ERR_BLK),511,E_NOID);
      224    13714    3               END;
      225    13715    2             ELSE   /* Came from a user already on sys */
      226    13716    3               DO;   /* Insert name,acct from submittor */
      227    13717    3                 UKEY.KEY.ACCN = CODE04.CREATOR.ACCT;
      228    13718    3                 UKEY.KEY.UNAME = CODE04.CREATOR.NAME;
      229    13719    3                 UKEY.LEN = SIZEC(UKEY.KEY);
      230    13720    3               END;
      231    13721        /**/
      232    13722    3           DO NEVER;
      233    13723    3   E_SYNTAX: CALL JPE$REASON(%REJ_SYNTAX#);
      234    13724    3             CALL CXP$POSTERR(ADDR(ERR_BLK),PCB.HI_CHAR,PCB.ERROR);
      235    13725    3           END;
      236    13726        /**/
      237    13727    2           IF UKEY.LEN>0
      238    13728    2           THEN
      239    13729    2             CALL PROCESS_JOB; /* No errors yet - possible valid id */
      240    13730    2         END;
      241    13731    1       ELSE IF NOT PASS_TWO# AND ES$LOGSYSACC >= %PC_ES_FAILED# THEN
      242    13732    1           IF PCB.OUT$->P$B.NSUBLKS>0 AND PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE =
             13732                    JOB_ACCTNAME THEN
      243    13733    2             DO;
      244    13734    2               ES_FLG='0'B;
      245    13735    3               DO I=0 TO PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS-1;
      246    13736    3                 IF PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(I)->P$S.COUNT > LEGAL_LENGTH.
             13736                          LEN(I) THEN
      247    13737    3                   ES_FLG='1'B;
      248    13738    3               END;
      249    13739    2               IF ES_FLG THEN
      250    13740    2                 CALL SECLOG(%ES_JUNK_LOGON#);
      251    13741    2             END;
      252    13742        /*
      253    13743             ***** If there was a WSN = xxx option on the !JOB command
      254    13744                   then try to open this wsn first. M$OPEN does
      255    13745                   special processing for PRESCAN. It looks at
      256    13746                   the JIT of the submitter (B$JIT0_LO$ -> B$JIT)
      257    13747                   which is passed thru the PROCATTR portion of
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:9    
      258    13748                   FPT_OPEN (OPEN_LO). The entry in :USERS for the
      259    13749                   submitter (UNAME and ACCT from phony JIT) are
      260    13750                   checked to make sure that this user may access
      261    13751                   the requested WSN.
      262    13752
      263    13753                   There are two error cases.
      264    13754                   1) B$JIT0_LO$ -> B$JIT.ERR non zero means ....
      265    13755                   2) Altret from M$OPEN ...
      266    13756        */
      267    13757    1       IF PASS_TWO#
      268    13758    1       THEN
      269    13759    1         OPEN_LO.V.OPER.TEST# = %NO#;
      270    13760    1       ELSE
      271    13761    1         OPEN_LO.V.OPER.TEST# = %YES#;
      272    13762    1       SUBSTR(ABORTHDR.TITL.TITLE#,2,8)=UKEY.KEY.ACCN;
      273    13763    1       SUBSTR(ABORTHDR.TITL.TITLE#,10,12)=UKEY.KEY.UNAME;
      274    13764    1       CALL M$OPEN (OPEN_LO) ALTRET(E_OPEN_LO);
      275    13765    1       IF B$JIT0_LO$ -> B$JIT.ERR ~= '0'B
      276    13766    1       THEN /* Report error */
      277    13767    2         DO; /* Report error */
      278    13768    2           CALL CXP$POSTERR (ADDR(ERR_BLK),0,B$JIT0_LO$ -> B$JIT.ERR);
      279    13769    2           LO_WSN = B$JIT0_LO$ -> B$JIT.WOO;
      280    13770    2         END;
      281    13771    2       DO NEVER;
      282    13772    2   E_OPEN_LO: /* Bitch about bad wsn */
      283    13773    2         LO_WSN = '@'; /* workstation of origin */
      284    13774    2         SAVE_ERR = B$TCB.ALT$ -> B$ALT.ERR;
      285    13775    2         CALL M$OPEN (OPEN_LO) ALTRET(E_OPEN_LOCAL);
      286    13776    2         CALL CXP$POSTERR (ADDR(ERR_BLK),0,SAVE_ERR);
      287    13777    3         DO NEVER;
      288    13778    3   E_OPEN_LOCAL:
      289    13779    3           CALL JPT$REPORT;
      290    13780    3         END;  /* Do never ... E_OPEN_LOCAL ... end */
      291    13781    2       END; /* Do never ... E_OPEN ... end */
      292    13782    1       IF PASS_SPECIFIED#
      293    13783    1       THEN
      294    13784    2         DO; /* Must rewrite record with password blanked */
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:10   
      295    13785    3           DO K = 0 TO JP_CONTINUE.REC_NUM;
      296    13786    3             IF K < JP_CONTINUE.REC_NUM
      297    13787    3             THEN
      298    13788    3               JP_CONTINUE.LEN(K) =
      299    13789    3                 JP_CONTINUE.CHARPOS(K+1)-JP_CONTINUE.CHARPOS(K)-1;
      300    13790    3             IF JP_CONTINUE.CHARPOS(K)+JP_CONTINUE.LEN(K) > COMMA_POS
      301    13791    3             THEN
      302    13792    4               DO;
      303    13793    4                 FPT_REWRITE.BUF_.BUF$ = PINCRC(PCB.TEXT$,JP_CONTINUE.CHARPOS(K));
      304    13794    4                 FPT_REWRITE.BUF_.BOUND = JP_CONTINUE.LEN(K)-1;
      305    13795    4                 IF K = 0 /* Put the bang back in for the first chunk */
      306    13796    4                 THEN
      307    13797    5                   DO;
      308    13798    5                     FPT_REWRITE.BUF_.BUF$ = PINCRC(PCB.TEXT$,-1);
      309    13799    5                     FPT_REWRITE.BUF_.BOUND = JP_CONTINUE.LEN(K);
      310    13800    5                   END;
      311    13801    4                 FPT_PRECORD.V.N# = K;
      312    13802    4                 CALL M$PRECORD (FPT_PRECORD) ALTRET(ABORT);
      313    13803    4                 FPT_REWRITE.V.DVBYTE = M$EI$->F$DCB.DVBYTE;
      314    13804    4                 CALL M$WRITE (FPT_REWRITE)
      315    13805    4                 WHENALTRETURN
      316    13806    5                   DO;
      317    13807    5                     IF NOT M$EI$->F$DCB.TYC.LD#
      318    13808    5                     THEN
      319    13809    5                       GOTO ABORT;
      320    13810    5                   END;
      321    13811    4                 COMMA_POS = PASS_POS;
      322    13812    4                 IF JP_CONTINUE.CHARPOS(K)+JP_CONTINUE.LEN(K) > PASS_POS
      323    13813    4                 THEN
      324    13814    4                   K = JP_CONTINUE.REC_NUM; /* quit when password is rewrit */
      325    13815    4               END;
      326    13816    3           END; /* do K = ... */
      327    13817    2           FPT_PRECORD.V.N# = JP_CONTINUE.REC_NUM + 1;
      328    13818    2           CALL M$PRECORD (FPT_PRECORD) ALTRET(ABORT);
      329    13819    2         END;
      330    13820    1       RETURN;
      331    13821        /*
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:11   
      332    13822             ***** Flush this job ...
      333    13823        */
      334    13824    1   ABORT:
      335    13825    1       CALL JPE$REASON (%REJ_IO#);
      336    13826    1       CALL JPT$REPORT;
      337    13827    1       ALTRETURN;
      338    13828        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:12   
      339    13829    1   PROCESS_JOB: PROC;
      340    13830    2       JOB_TBL.ACCT = UKEY.KEY.ACCN;
      341    13831    2       JOB_TBL.UNAME = UKEY.KEY.UNAME;
      342    13832    2       CALL GET_USERS ALTRET(INVALID_ID);
      343    13833    2       B$JIT0_LO$->B$JIT.ACCN = UKEY.KEY.ACCN;
      344    13834    2       B$JIT0_LO$->B$JIT.UNAME = UKEY.KEY.UNAME;
      345    13835    2       IF KL_DREC.FLAGS.BATOK = %NO#
      346    13836    2       THEN
      347    13837    3         DO; /* Not authorized for BATCH */
      348    13838    3           CALL JPE$REASON(%REJ_NOBATCH#);
      349    13839    3           CALL CXP$POSTERR(ADDR(ERR_BLK),511,E_NOBATCH);
      350    13840    3         END;
      351    13841        /*
      352    13842             ***** Get the default values for TIME,MEM and PRIO ...
      353    13843        */
      354    13844    2       JOB_TBL.TIM = AS_USERS.DTIME(%M_BATCH#-1);
      355    13845    2       JOB_TBL.RRT(JM_RX$MEM) = AS_USERS.DMEM(%M_BATCH#-1);
      356    13846    2       IF INSYM$INFO.DEFPRI = 511
      357    13847    2       THEN /* Job came from CR */
      358    13848    2         JOB_TBL.PRIO = AS_USERS.DMPRIO(%M_BATCH#-1);
      359    13849    2       ELSE /* Get default PRIO from passed JIT */
      360    13850    2         JOB_TBL.PRIO = INSYM$INFO.DEFPRI;
      361    13851        /*
      362    13852             ***** Process the options on !JOB command ...
      363    13853        */
      364    13854    2       CALL PROCESS_OPTS;
      365    13855    3       DO NEVER;
      366    13856    3   INVALID_ID: CALL JPE$REASON(%REJ_BADID#);
      367    13857    3         CALL CXP$POSTERR(ADDR(ERR_BLK),511,E_BADID);
      368    13858    3         IF INSYM$INFO.FLAG = JOBORIG_DEVICE#
      369    13859    3         THEN
      370    13860    4           DO; /* bad id input from CR...put out bad id on banner */
      371    13861    4             B$JIT0_LO$->B$JIT.ACCN = UKEY.KEY.ACCN;
      372    13862    4             B$JIT0_LO$->B$JIT.UNAME = UKEY.KEY.UNAME;
      373    13863    4           END;
      374    13864    3       END;
      375    13865    2       RETURN;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:13   
      376    13866        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:14   
      377    13867    2   GET_USERS: PROC ALTRET;
      378    13868        /*
      379    13869             ***** Strip trailing blanks off :USERS/:HLP key ...
      380    13870        */
      381    13871    4       DO WHILE(UKEY.KEY_ARY(UKEY.LEN-1) = ' ');
      382    13872    4         UKEY.LEN = UKEY.LEN - 1;
      383    13873    4       END;
      384    13874    3       CALL M$READ(READ_USERS) ALTRET(RD_ALT);
      385    13875    3       CALL M$READ(READ_HLP) ALTRET(RD_ALT);
      386    13876        /*
      387    13877            ***** If no PASSWORD was specified on the !JOB
      388    13878                  command and the job is to run in the
      389    13879                  submitter's account, then let it go thru ...
      390    13880        */
      391    13881    3       IF PASS_SPECIFIED# = %NO#
      392    13882    3         AND (UKEY.KEY.ACCN = CODE04.CREATOR.ACCT
      393    13883    3         AND UKEY.KEY.UNAME = CODE04.CREATOR.NAME)
      394    13884    3       THEN
      395    13885    3         PASSWORD_OK# = %YES#;
      396    13886        /*
      397    13887          This setting and then testing of PASSWORD_OK# is done so that the printing
      398    13888          pass of a bad job will not fail on a blanked out password field
      399    13889        */
      400    13890    3       IF PASSWORD_OK# = %NO# AND UPASS ~= KL_DREC.PASSWORD
      401    13891    4       THEN DO; /* May want to log in security log and/or update :USERS */
      402    13892    4           IF NOT PASS_TWO# THEN
      403    13893    4             IF ES$LOGSYSACC >= %PC_ES_FAILEDPW# THEN
      404    13894    4               CALL SECLOG(%ES_BAD_PW#);
      405    13895    5             ELSE CALL UPD_USERS(%ES_BAD_PW#) WHENALTRETURN DO;
      406    13896    5                 END;
      407    13897    4           ALTRETURN;
      408    13898    4         END;
      409    13899    3       ELSE
      410    13900    3         PASSWORD_OK# = %YES#;
      411    13901    3       RETURN;
      412    13902        /*
      413    13903             ***** Handle read errors ...
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:15   
      414    13904        */
      415    13905    3   RD_ALT:
      416    13906    3       IF B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$NOKEY
      417    13907    3       THEN
      418    13908    3         CALL JPT$REPORT;
      419    13909    3       ELSE IF NOT PASS_TWO# AND ES$LOGSYSACC >= %PC_ES_FAILEDPWNE# THEN
      420    13910    3           CALL SECLOG(%ES_NO_SUCH_USER#);
      421    13911    3       ALTRETURN;
      422    13912    3   END GET_USERS;
      423    13913        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:16   
      424    13914    2   PROCESS_OPTS: PROC;
      425    13915    3     DCL I SBIN;
      426    13916    3     DCL J SBIN;
      427    13917    3     DCL K SBIN;
      428    13918    3     DCL TEMP UBIN WORD;
      429    13919    3     DCL VAR_LEN SBIN STATIC;
      430    13920    3     DCL VAR$CHAR CHAR(VAR_LEN) BASED;
      431    13921    3     DCL JOBNAME CHAR(31) CALIGNED;
      432    13922    4       DO I = 0 TO PCB.OUT$->P$B.NSUBLKS-1;
      433    13923    4         P$ = PCB.OUT$->P$B.SUBLK$(I);
      434    13924    5         DO CASE(P$->P$B.CODE);
      435    13925    5           CASE(JOB_ACCTNAME);
      436    13926             /* Ignore */
      437    13927    5           CASE(JOB_PRIO);
      438    13928    5             CALL CHARBIN(TEMP,P$->P$S.TEXT);
      439    13929    5             JOB_TBL.PRIO = TEMP;
      440    13930    5             IF INSYM$INFO.MAXPRI = 511
      441    13931    5             THEN
      442    13932    5               TEMP = AS_USERS.MMPRIO(%M_BATCH#-1);
      443    13933    5             ELSE
      444    13934    5               TEMP = INSYM$INFO.MAXPRI;
      445    13935    5             IF JOB_TBL.PRIO>TEMP
      446    13936    5             THEN
      447    13937    6               DO;
      448    13938    6                 TEMP = P$ -> P$S.CPOS;
      449    13939    6                 CALL CXP$POSTERR(ADDR(ERR_BLK),TEMP,E_MAXPRIO);
      450    13940    6               END;
      451    13941    5           CASE(JOB_ORDER);
      452    13942    5             JOB_TBL.FLG.O1 = %YES#;
      453    13943    5           CASE(JOB_NORDER);
      454    13944    5             JOB_TBL.FLG.O1 = %NO#;
      455    13945    5           CASE(JOB_ACCT);
      456    13946    5             JOB_TBL.FLG.ACC = %YES#;
      457    13947    5           CASE(JOB_WSN);
      458    13948    5             JOB_TBL.WSN = P$->P$S.TEXT;
      459    13949    5             LO_WSN = JOB_TBL.WSN;
      460    13950    5           CASE(JOB_SCAN);
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:17   
      461    13951    5             SCAN_CMDS# = %YES#;
      462    13952    5           CASE(JOB_JNAME);
      463    13953    5             JOBNAME = P$ -> P$S.TEXT;
      464    13954    5             CALL INDEX (TEMP,' ',JOBNAME);
      465    13955    5             JOB_TBL.JNL = TEMP;
      466    13956    5             JOB_TBL.JNAME = JOBNAME;
      467    13957    5           CASE(JOB_NPI);
      468    13958    5             JOB_TBL.FLG.NPI = %YES#;
      469    13959    5           CASE(JOB_RERUN);
      470    13960    5             JOB_TBL.FLG.RR = %YES#;
      471    13961    5           CASE(JOB_NRERUN);
      472    13962    5             JOB_TBL.FLG.RR = %NO#;
      473    13963    5           CASE(JOB_DEFER);
      474    13964    5             DEFER_TSTAMP.DATE_ = VECTOR(DEFER_DATE);
      475    13965    5             DEFER_TSTAMP.TIME_ = VECTOR(NIL);
      476    13966    5             CALL M$TIME(TODAYS_DATE);
      477    13967    6             DO J = 0 TO P$->P$B.NSUBLKS-1;
      478    13968    6               T$ = P$->P$B.SUBLK$(J);
      479    13969    6               IF T$->P$B.CODE = JOB_DTIME
      480    13970    6               THEN
      481    13971    7                 DO;
      482    13972    7                   CALL CONCAT(DEFER_TIME,
      483    13973    7                     T$->P$B.SUBLK$(0)->P$S.TEXT,
      484    13974    7                     ':',
      485    13975    7                     T$->P$B.SUBLK$(1)->P$S.TEXT);
      486    13976    7                   VAR_LEN = T$->P$B.SUBLK$(0)->P$S.COUNT + 1 +
      487    13977    7                     T$->P$B.SUBLK$(1)->P$S.COUNT;
      488    13978    7                   DEFER_TSTAMP.TIME_ = VECTOR(ADDR(DEFER_TIME)->VAR$CHAR);
      489    13979    7                 END;
      490    13980    6               ELSE
      491    13981    7                 DO;
      492    13982    7                   CALL CONCAT(DEFER_DATE,
      493    13983    7                     T$->P$B.SUBLK$(0)->P$S.TEXT,
      494    13984    7                     '/',
      495    13985    7                     T$->P$B.SUBLK$(1)->P$S.TEXT,
      496    13986    7                     '/',
      497    13987    7                     T$->P$B.SUBLK$(2)->P$S.TEXT);
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:18   
      498    13988    7                   VAR_LEN = T$->P$B.SUBLK$(0)->P$S.COUNT +
      499    13989    7                     T$->P$B.SUBLK$(1)->P$S.COUNT +
      500    13990    7                     T$->P$B.SUBLK$(2)->P$S.COUNT + 2;
      501    13991    7                   DEFER_TSTAMP.DATE_ = VECTOR(ADDR(DEFER_DATE)->VAR$CHAR);
      502    13992    7                 END;
      503    13993    6             END;
      504    13994    5             CALL M$TIME(DEFER_TSTAMP) ALTRET(E_TIME);
      505    13995    5             JOB_TBL.FLG.RA = %YES#;
      506    13996    5             JOB_TBL.RATIM = DEFER_UTS;
      507    13997    6             DO NEVER;
      508    13998    6   E_TIME:
      509    13999    6               CALL CXP$POSTERR (ADDR(ERR_BLK),511,B$TCB.ALT$ -> B$ALT.ERR);
      510    14000    6             END;
      511    14001    5           CASE(JOB_FOLLOW);
      512    14002    5             IF P$->P$B.NSUBLKS>8
      513    14003    5             THEN
      514    14004    5               CALL CXP$POSTERR(ADDR(ERR_BLK),511,E_MANYFOLLOW);
      515    14005    5             ELSE
      516    14006    6               DO;
      517    14007    6                 JOB_TBL.FLG.O3 = %YES#;
      518    14008    6                 IF P$->P$B.NSUBLKS = 0
      519    14009    6                 THEN
      520    14010    6   FOLLOW_ACCOUNT:
      521    14011    7                   DO;
      522    14012    7                     JOB_TBL.NJD = 1;
      523    14013    7                     JOB_TBL.JDID.FOLLOW_TYPE(0) = %JM_FOLLOW_ACCOUNT;
      524    14014    7                   END FOLLOW_ACCOUNT;
      525    14015    6                 ELSE
      526    14016    6   FOLLOW_STEPCC_OKERRORABORT:
      527    14017    7                   DO;
      528    14018    7                     JOB_TBL.NJD = P$->P$B.NSUBLKS;
      529    14019    8                     DO J = 0 TO JOB_TBL.NJD-1;
      530    14020    8                       T$ = P$->P$B.SUBLK$(J);
      531    14021    8                       JOB_TBL.JDID.FOLLOW_TYPE(J) = %JM_FOLLOW_STEPCC;
      532    14022    8                       JOB_TBL.JDID.RELATION(J) = JM_EQ;
      533    14023    8                       JOB_TBL.JDSTEPCC(J) = 0;
      534    14024    9                       DO K = 0 TO T$->P$B.NSUBLKS-1;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:19   
      535    14025   10                         DO CASE(T$->P$B.SUBLK$(K)->P$B.CODE);
      536    14026   10                           CASE(JOB_NAME);
      537    14027   10                             T2$ = T$->P$B.SUBLK$(K);
      538    14028   10                             IF T2$->P$B.SUBLK$(0)->P$B.CODE = JOB_SYSID
      539    14029   10                             THEN
      540    14030   11                               DO;
      541    14031   11                                 CALL CHARBIN(TEMP,T2$->P$B.SUBLK$(0)->P$S.TEXT);
      542    14032   11                                 JOB_TBL.JDID.SYSID(J) = TEMP;
      543    14033   11                               END;
      544    14034   10                             ELSE
      545    14035   11                               DO; /* NAME not SYSID */
      546    14036   11                                 FOL_NAME = T2$->P$B.SUBLK$(0)->P$S.TEXT;
      547    14037   11                                 IF T2$->P$B.NSUBLKS > 1
      548    14038   11                                 THEN /* Acct specified */
      549    14039   11                                   FOL_ACCT = T2$->P$B.SUBLK$(1)->P$S.TEXT;
      550    14040   11                                 ELSE /* Use default acct */
      551    14041   11                                   FOL_ACCT = JOB_TBL.ACCT;
      552    14042   11                                 XSJ_PARAM.BUF_ = VECTOR(JOB_TBL.JDID.SYSID(J));
      553    14043   11                                 CALL XSJ$READ(XSJ_PARAM) ALTRET(XSJ_ALT1);
      554    14044   12                                 DO NEVER;
      555    14045   12   XSJ_ALT1:
      556    14046   12                                   TEMP = T2$ -> P$S.CPOS;
      557    14047   12                                   IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$NOKEY
      558    14048   12                                   THEN
      559    14049   12                                     CALL CXP$POSTERR (ADDR(ERR_BLK),
      560    14050   12                                       TEMP,E_NONAME);
      561    14051   12                                   ELSE
      562    14052   12                                     GOTO  XSJ_ALT2;
      563    14053   12                                 END;
      564    14054   11                               END;
      565    14055   10                           CASE(JOB_OK);
      566    14056   10                             JOB_TBL.JDID.FOLLOW_TYPE(J) = %JM_FOLLOW_OK;
      567    14057   10                           CASE(JOB_ERROR);
      568    14058   10                             JOB_TBL.JDID.FOLLOW_TYPE(J) = %JM_FOLLOW_ERROR;
      569    14059   10                           CASE(JOB_ABORT);
      570    14060   10                             JOB_TBL.JDID.FOLLOW_TYPE(J) = %JM_FOLLOW_ABORT;
      571    14061   10                           CASE(JOB_STREL);
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:20   
      572    14062   10                             JOB_TBL.JDID.RELATION(J) =
      573    14063   10                               T$->P$B.SUBLK$(K)->P$B.SUBLK$(0)->P$B.CODE;
      574    14064   10                             CALL CHARBIN(TEMP,
      575    14065   10                               T$->P$B.SUBLK$(K)->P$B.SUBLK$(1)->P$S.TEXT);
      576    14066   10                             JOB_TBL.JDSTEPCC(J) = TEMP;
      577    14067   10                         END;
      578    14068    9                       END;
      579    14069    8                     END;
      580    14070    7                   END FOLLOW_STEPCC_OKERRORABORT;
      581    14071    6               END;
      582    14072    5         END;
      583    14073    4       END;
      584    14074        /*
      585    14075        		***** If a JOBNAME was specified, then stash it ...
      586    14076        */
      587    14077    3       IF JOB_TBL.JNAME ~= ' '
      588    14078    3       THEN
      589    14079    4         DO;   /* Store JOBNAME in :JOBSTATS */
      590    14080    4           FOL_NAME = JOB_TBL.JNAME;
      591    14081    4           FOL_ACCT = JOB_TBL.ACCT;
      592    14082    4           XSJ_PARAM.BUF_ = VECTOR(JOB_TBL.SYSID);
      593    14083    4           CALL XSJ$WRITE(XSJ_PARAM) ALTRET(XSJ_ALT2);
      594    14084    5           DO NEVER;
      595    14085    5   XSJ_ALT2:
      596    14086    5             CALL JPE$REASON (%REJ_IO#);
      597    14087    5             CALL JPT$REPORT;
      598    14088    5           END;
      599    14089    4         END;
      600    14090    3       RETURN;
      601    14091    3   END PROCESS_OPTS;
      602    14092    2   END PROCESS_JOB;
      603    14093        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:21   
      604    14094    1   SECLOG: PROC(REASON);
      605    14095
      606    14096        /*I* NAME:        SECLOG
      607    14097
      608    14098             PURPOSE:     To fill in and write a record to the security log
      609    14099                          for system accesses and/or possibly update the
      610    14100                          :USERS record for security purposes.
      611    14101
      612    14102             CALL:        CALL SECLOG(reason);
      613    14103
      614    14104             INPUT:       A reason as defined in the ES_SUBS_E include file.
      615    14105
      616    14106             OUTPUT:      In all cases, a record will be written to the
      617    14107                          security log via M$WRSYSLOG. Some cases will also
      618    14108                          require security updates to the :USERS record.
      619    14109
      620    14110             DESCRIPTION: SECLOG will only be called if the value of
      621    14111                          ES_LOGSYSACC (defined via CONTROL) indicates that
      622    14112                          security logging is desired. Dependent upon the
      623    14113                          specific type of logging desired, it may be called
      624    14114                          when (1) a garbage logon is given, (2) a logon
      625    14115                          is given which does not exist in :USERS, (3) a logon
      626    14116                          is given which does exist in :USERS but has failed
      627    14117                          the password check, or (4) logging of all system
      628    14118                          accesses is desired.
      629    14119
      630    14120                          It will fill in the security log structure from
      631    14121                          information found in JOB_TBL, the FM$JOBORIG
      632    14122                          structure, the CODE04, and/or the parse nodes and
      633    14123                          call M$WRSYSLOG. If the reason passed to SECLOG
      634    14124                          indicates that the logon given was good except for
      635    14125                          the password, the bad password is also placed in
      636    14126                          the security record and the count of bad logon
      637    14127                          attempts since the last system exit is incremented
      638    14128                          in the :USERS record. The batch PRIV and PPRIV
      639    14129                          information is copied from the :USERS record into
      640    14130                          the security record in this case. If logging a
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:22   
      641    14131                          good logon, the logon time and bad logon counts
      642    14132                          are updated in the :USERS record.
      643    14133        */
      644    14134    2     DCL REASON UBIN;
      645    14135    2     DCL P$ PTR;
      646    14136    2     DCL LOGON_LEN UBIN;
      647    14137        %INCLUDE ES_TABLES_M;
      648    14531        %ES$SECLOG(NAME=ES$SECLOG_INIT,STCLASS=CONSTANT);
      649    14808        %ES$SECLOG(NAME=ES$SECLOG,STCLASS=STATIC);
      650    15085        %FPT_WRSYSLOG(FPTN=WR_SECLOG,
      651    15086                  ENTRY=ES$SECLOG,
      652    15087                  FILENUM=EL_SEC,
      653    15088                  SIZE="SIZEW(ES$SECLOG)",
      654    15089                  TYPE=EL_SYS_ACCESS);
      655    15104        %INCLUDE AS_SUBS_C;
      656    16518
      657    16519    2       ES$SECLOG=ES$SECLOG_INIT;
      658    16520    2       ES$SECLOG.REASON=REASON;
      659    16521    2       ES$SECLOG.MODE=%M_BATCH#;
      660    16522        /* Log info about the very first user who caused this job to be
      661    16523           spawned.                                                     */
      662    16524    2       ES$SECLOG.ORIG_MODE=INSYM$INFO.ORIGINATOR_MODE;
      663    16525    3       DO CASE (INSYM$INFO.ORIGINATOR_MODE);
      664    16526    3         CASE(0,%M_BATCH#);
      665    16527            /* If 0, this guy is the originator, so must be a device. */
      666    16528    3           ES$SECLOG.DEVICE_TNAME = INSYM$INFO.ORIGINATOR_PORT.FROM_CR.TNAME;
      667    16529    3           ES$SECLOG.DEVICE = INSYM$INFO.ORIGINATOR_PORT.FROM_CR.DEVICE;
      668    16530    3         CASE(%M_GHOST#);
      669    16531    3           ES$SECLOG.ORIG_SYSID=INSYM$INFO.ORIGINATOR_PORT.FROM_GHOST.SYSID;
      670    16532    3         CASE(%M_INT#);
      671    16533    3           ES$SECLOG.TSLINE.FEX = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.FEX;
      672    16534    3           ES$SECLOG.TSLINE.PORT = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.PORT;
      673    16535    3           ES$SECLOG.TSLINE.LEV = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.LEV;
      674    16536    3           ES$SECLOG.TSLINE.SUBDEVICE = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.
             16536                    SUBDEVICE;
      675    16537    3           ES$SECLOG.TSLINE.SUBSUBDEVICE = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.
             16537                    SUBSUBDEVICE;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:23   
      676    16538    3       END;
      677    16539        /* Log info about immediately preceding user */
      678    16540    3       IF INSYM$INFO.FLAG ~= JOBORIG_DEVICE# THEN DO;
      679    16541    3           ES$SECLOG.PREV_USER.MODE=INSYM$INFO.FLAG;
      680    16542    3           ES$SECLOG.PREV_USER.SYSID=INSYM$INFO.SYSID;
      681    16543    3           ES$SECLOG.PREV_USER.ACCT=CODE04.CREATOR.ACCT;
      682    16544    3           ES$SECLOG.PREV_USER.UNAME.L=12;
      683    16545    3           ES$SECLOG.PREV_USER.UNAME.C=CODE04.CREATOR.NAME;
      684    16546    3         END;
      685    16547
      686    16548    3       DO CASE(REASON);
      687    16549    3         CASE(%ES_LOG_ALL#);
      688    16550    3           ES$SECLOG.GRANTED='1'B;
      689    16551    3           ES$SECLOG.ACCN=JOB_TBL.ACCT;
      690    16552    3           ES$SECLOG.UNAME=JOB_TBL.UNAME;
      691    16553    3           CALL UPD_USERS(%ES_LOG_ALL#) ALTRET(LOG_IT);
      692    16554    3         CASE(%ES_JUNK_LOGON#);
      693    16555    3           LOGON_LEN = LENGTHC(ES$SECLOG.LOGON.C);
      694    16556    3           P$=PCB.OUT$->P$B.SUBLK$(0);
      695    16557    3           CALL CONCAT(ES$SECLOG.LOGON.C,P$->P$B.SUBLK$(0)->P$S.TEXT,',',
      696    16558    3             P$->P$B.SUBLK$(1)->P$S.TEXT);
      697    16559    3           ES$SECLOG.LOGON.L=P$->P$B.SUBLK$(0)->P$S.COUNT+
      698    16560    3             P$->P$B.SUBLK$(1)->P$S.COUNT+1;
      699    16561    4           IF P$->P$B.NSUBLKS > 2 AND ES$SECLOG.LOGON.L < LOGON_LEN THEN DO;
      700    16562    4               CALL INSERT(ES$SECLOG.LOGON.C,ES$SECLOG.LOGON.L-1,,',',
      701    16563    4                 P$->P$B.SUBLK$(2)->P$S.TEXT);
      702    16564    4               ES$SECLOG.LOGON.L=ES$SECLOG.LOGON.L+
      703    16565    4                 P$->P$B.SUBLK$(2)->P$S.COUNT+1;
      704    16566    4             END;
      705    16567    3           IF ES$SECLOG.LOGON.L > LOGON_LEN THEN
      706    16568    3             ES$SECLOG.LOGON.L = LOGON_LEN;
      707    16569    3         CASE(%ES_NO_SUCH_USER#);
      708    16570    3           ES$SECLOG.ACCN=JOB_TBL.ACCT;
      709    16571    3           ES$SECLOG.UNAME=JOB_TBL.UNAME;
      710    16572    3         CASE(%ES_BAD_PW#);
      711    16573    3           ES$SECLOG.ACCN=JOB_TBL.ACCT;
      712    16574    3           ES$SECLOG.UNAME=JOB_TBL.UNAME;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:24   
      713    16575    3           ES$SECLOG.PASSWORD = SAVE_UPASS;
      714    16576    3           CALL UPD_USERS(%ES_BAD_PW#) ALTRET(LOG_IT);
      715    16577    3           ES$SECLOG.PRIV = AS_USERS.PRIV(AS_M_BATCH#);
      716    16578    3           ES$SECLOG.PPRIV = AS_USERS.PPRIV(AS_M_BATCH#);
      717    16579    3         CASE(ELSE);
      718    16580            /* Should never happen */
      719    16581    3           RETURN;
      720    16582    3       END; /* End Do Case(Reason) */
      721    16583    2   LOG_IT:;
      722    16584    2       CALL M$WRSYSLOG(WR_SECLOG);
      723    16585    2       RETURN;
      724    16586    2   END SECLOG;
      725    16587        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:25   
      726    16588    1   UPD_USERS: PROC(REASON) ALTRET;
      727    16589        /* Update the :USERS record for good or bad password logons. */
      728    16590    2     DCL REASON UBIN;
      729    16591        %AS_USERS(STR_NAME=AS_USERS_SEC,STCLASS=STATIC);
      730    16769        %FPT_READ(FPTN=READ_USERS_SEC,
      731    16770                  DCB=M$USERS,
      732    16771                  KEYS=YES,
      733    16772                  KEY=UKEY,
      734    16773                  BUF=AS_USERS_SEC);
      735    16812        %FPT_WRITE(FPTN=WRITE_USERS_SEC,
      736    16813                  DCB=M$USERS,
      737    16814                  KEY=UKEY,
      738    16815                  BUF=AS_USERS_SEC);
      739    16846        %FPT_ENQ(FPTN=ENQ_USERS_SEC,
      740    16847                  DCB=M$USERS,
      741    16848                  RNAME=UKEY,
      742    16849                  SHARE=NONE);
      743    16867        %FPT_DEQ(FPTN=DEQ_USERS_SEC,
      744    16868                  DCB=M$USERS);
      745    16885
      746    16886
      747    16887            /* If this job's logon is the same as the guy who batched it,
      748    16888               don't bother to update :USERS. Want to avoid having the logon
      749    16889               time and bad logon counts rolling over so often that they
      750    16890               become useless.                                             */
      751    16891    2       IF REASON=%ES_LOG_ALL# AND INSYM$INFO.FLAG~=JOBORIG_DEVICE# AND
      752    16892    2         JOB_TBL.ACCT=CODE04.CREATOR.ACCT AND
      753    16893    2         JOB_TBL.UNAME=CODE04.CREATOR.NAME THEN
      754    16894    2         RETURN;
      755    16895    2       CALL M$ENQ(ENQ_USERS_SEC) ALTRET(ERR);
      756    16896    3       CALL M$READ(READ_USERS_SEC) WHENALTRETURN DO;
      757    16897    3           CALL M$DEQ(DEQ_USERS_SEC);
      758    16898    3           GOTO ERR;
      759    16899    3         END;
      760    16900    3       IF REASON=%ES_BAD_PW# THEN DO;
      761    16901    3           AS_USERS_SEC.BAD_LOGON_CNT=AS_USERS_SEC.BAD_LOGON_CNT+1;
      762    16902    3           AS_USERS_SEC.LOGINS.BAD_LOGON_CNT(%M_BATCH#-1)=
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:26   
      763    16903    3             AS_USERS_SEC.LOGINS.BAD_LOGON_CNT(%M_BATCH#-1)+1;
      764    16904    3         END;
      765    16905    2       CALL M$WRITE(WRITE_USERS_SEC);
      766    16906    2       CALL M$DEQ(DEQ_USERS_SEC);
      767    16907    2       RETURN;
      768    16908    2   ERR:;
      769    16909    2       ALTRETURN;
      770    16910
      771    16911    2   END UPD_USERS;
      772    16912        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:27   
      773    16913    1   JPJ$LOG_GOOD: ENTRY ALTRET; /* Never altrets */
      774    16914        /**/
      775    16915        /*P* NAME:         JPJ$LOG_GOOD
      776    16916             PURPOSE:      To allow JPS$SCAN to gain access to the SECLOG
      777    16917                           and/or UPD_USERS subroutines in JPJ$JOB for logging
      778    16918                           successful logons.
      779    16919        */
      780    16920        /**/
      781    16921        /*F* NAME:         JPJ$LOG_GOOD
      782    16922             PURPOSE:      To allow JPS$SCAN to gain access to the SECLOG
      783    16923                           and/or UPD_USERS subroutines in JPJ$JOB for logging
      784    16924                           successful logons.
      785    16925
      786    16926             CALL:         CALL JPJ$LOG_GOOD;
      787    16927
      788    16928             INPUT:        None
      789    16929
      790    16930             DESCRIPTION:  JPJ$LOG_GOOD calls SECLOG if we're logging all
      791    16931                           logons in the security log. Otherwise, it calls
      792    16932                           UPD_USERS to update the :USERS record. Called by
      793    16933                           JPS$SCAN before he sends the job to MBS.
      794    16934        */
      795    16935    1       IF ES$LOGSYSACC=%PC_ES_LOGACC_ALL# THEN
      796    16936    1         CALL SECLOG(%ES_LOG_ALL#);
      797    16937    2       ELSE CALL UPD_USERS(%ES_LOG_ALL#) WHENALTRETURN DO;
      798    16938    2           END;
      799    16939    1       RETURN;
      800    16940    1   END JPJ$JOB;

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:28   
--  Include file information  --

   AS_SUBS_C.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   JP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   JP_PERR_C.:E05TOU  is referenced.
   JP_MACRO_C.:E05TOU  is referenced.
   JM_SUBS_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JPJ$JOB.

   Procedure JPJ$JOB requires 1458 words for executable code.
   Procedure JPJ$JOB requires 44 words of local(AUTO) storage.

    No errors detected in file JPJ$JOB.:E05TSI    .

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:29   

 Object Unit name= JPJ$JOB                                    File name= JPJ$JOB.:E05TOU
 UTS= JUL 29 '97 23:36:32.00 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2   DCB   even  none     0      0  M$EI
    3   DCB   even  none     0      0  M$LO
    4   DCB   even  none     0      0  M$JOBSTAT
    5   DCB   even  none     0      0  M$HLP
    6   DCB   even  none     0      0  M$USERS
    7   Data  even  none   682   1252  JPJ$JOB
    8  RoData even  UTS    100    144  JPJ$JOB
    9   Proc  even  none  1458   2662  JPJ$JOB
   10  RoData even  none    50     62  JPJ$JOB

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      Std        0  JPJ$JOB
     9   2641          yes     yes      Std        0  JPJ$LOG_GOOD
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:30   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 ASZ$SCRAMBLE
         yes           Std       1 JPA$CONTINUE
         yes           Std       1 CPD$SYNTRY
         yes           Std       4 CPD$SET_NODES
         yes           Std       5 CXP$POSTERR
 yes     yes           Std       1 X$PARSE
         yes           Std       1 JPE$REASON
         yes           Std       1 JPT$REPORT
 yes     yes           Std       1 XSJ$READ
 yes     yes           Std       1 XSJ$WRITE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$EI$                            r    B$JIT$
r    B$TCB$                                AS_USERS                              KL_DREC
     M$CG                                  M$EI                                  M$LO
     M$JOBSTAT                             M$HLP                                 M$USERS
     SCAN_CMDS#                            PASSWORD_OK#                          PASS_TWO#
     ES$                                   B$JIT0_LO$                            LO_WSN
     INSYM_INFO$                           CODE04$                               ERR_BLK
     PCB                                   U$PARAM                               JP_CONTINUE
     OPEN_LO                               ABORTHDR                              JOB_TBL
     PASS_SPECIFIED#                       B_VECTNIL
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:31   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:32   


        1        1        /*M*    JPJ$JOB     Process the JOB command in PRESCAN                        */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8        JPJ$JOB: PROC ALTRET;

      8  9 000000   000000 700200 xent  JPJ$JOB      TSX0  ! X66_AUTO_0
         9 000001   000054 000000                    ZERO    44,0

        9        9        /***** Include files *****/
       10       10          %INCLUDE AS_SUPER_C;
       11      445 S        %INCLUDE B$JIT_C;
       12      446          %INCLUDE B_ERRORS_C;
       13     1573          %INCLUDE CP_6;
       14     1654          %INCLUDE CP_6_SUBS;
       15     2194          %INCLUDE CP_MACROS_C;
       16     2946          %INCLUDE CP_SUBS_C;
       17     3863          %INCLUDE FM$FIT;
       18     4084          %INCLUDE FS$FIT;
       19     4127          %INCLUDE JM$STRUCT;
       20     4872          %INCLUDE JM_SUBS_C;
       21     4978          %INCLUDE JP_MACRO_C;
       22     5133          %INCLUDE JP_PERR_C;
       23     5151          %INCLUDE KL_SUPER_C;
       24     8053          %INCLUDE XSJ_MAC_C;
       25     8132          %INCLUDE XSJ_SUBS_C;
       26     8159          %INCLUDE XU_MACRO_C;
       27    11265          %INCLUDE XU_PERR_C;
       28    11456          %INCLUDE JP_DATA_R;
       29    12001          %INCLUDE ES_SUBS_E;
       30    12027          %INCLUDE PC_SUBS_C;
       31    12359          %INCLUDE EL_SUBS_C;
       32    12443        /***** External routines *****/
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:33   
       33    12444    1     DCL   ASZ$SCRAMBLE   ENTRY(1);
       34    12445    1     DCL   CPD$SET_NODES  ENTRY(4);
       35    12446    1     DCL   CPD$SYNTAX     ENTRY(1)    ALTRET;
       36    12447    1     DCL   CPD$SYNTRY     ENTRY(1);
       37    12448    1     DCL   CXP$POSTERR    ENTRY(5);
       38    12449    1     DCL   CPX$JOB        ENTRY(1);
       39    12450    1     DCL   JPA$CONTINUE    ENTRY(1);
       40    12451    1     DCL   JPE$ERRORS     ENTRY(2);
       41    12452    1     DCL   JPE$REASON     ENTRY(1);
       42    12453    1     DCL   JPT$REPORT    ENTRY(1);
       43    12454    1     DCL   X$PARSE        ENTRY(1)    ALTRET;
       44    12455    1     DCL   XSJ$READ       ENTRY(1)    ALTRET;
       45    12456    1     DCL   XSJ$WRITE      ENTRY(1)    ALTRET;
       46    12457        /***** Symref data *****/
       47    12458    1     DCL B$JIT0_LO$ PTR SYMREF;
       48    12459    1     DCL LO_WSN CHAR(8) SYMREF;
       49    12460    1     DCL INSYM_INFO$ PTR SYMREF;
       50    12461    1     DCL CODE04$ PTR SYMREF;
       51    12462        %ERR_BLK (STCLASS="SYMREF");
       52    12487        %P$PCB(NAME = PCB,STCLASS = SYMREF);
       53    12688        %U$PARAM(NAME = U$PARAM,STCLASS = SYMREF);
       54    12704        %JP_CONTINUE (STCLASS = SYMREF);
       55    12710        /***** Fpts *****/
       56    12711        %FPT_OPEN(FPTN = OPEN_LO,STCLASS = SYMREF);
       57    12820        %VLP_HDR (FPTN=ABORTHDR,STCLASS=SYMREF,LEN="ABORTHDR.TITL.L#");
       58    12836        %FPT_WRITE(FPTN = FPT_REWRITE,DCB = M$EI,REWRITE = YES);
       59    12867        %FPT_TIME(FPTN = DEFER_TSTAMP,SOURCE = LOCAL,DEST = UTS,
       60    12868                  TSTAMP = DEFER_UTS,STCLASS = STATIC);
       61    12887        %FPT_TIME(FPTN = TODAYS_DATE,SOURCE = CLOCK,DEST = LOCAL,
       62    12888                  DATE = DEFER_DATE,STCLASS = CONSTANT);
       63    12907        %FPT_PRECORD (DCB = M$EI,KEYS = NO,BOF = YES,STCLASS = STATIC);
       64    12928        %FPT_READ(FPTN = READ_USERS,STCLASS = CONSTANT,
       65    12929                  DCB = M$USERS,
       66    12930                  BUF = AS_USERS,
       67    12931                  KEY = UKEY,
       68    12932                  KEYS = YES);
       69    12971        %FPT_READ(FPTN = READ_HLP,STCLASS = CONSTANT,
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:34   
       70    12972                  DCB = M$HLP,
       71    12973                  BUF = KL_DREC,
       72    12974                  KEY = UKEY,
       73    12975                  KEYS = YES);
       74    13014        /***** Based variables *****/
       75    13015        %JM_IF (FPTN=JOB_TBL,FIT = YES,STCLASS=SYMREF);
       76    13173        %PARSE$OUT(NAME = P$B,STCLASS = BASED);
       77    13218        %PARSE$SYM(NAME = P$S,STCLASS = BASED);
       78    13256    1     DCL      T$BUF    CHAR(4096)     BASED    ALIGNED;
       79    13257        %CODE04 (BASED="BASED(CODE04$)");
       80    13265        %FS$JOBORIG(NAME = INSYM$INFO,STCLASS = "BASED(INSYM_INFO$)");
       81    13271        %B$JIT0;
       82    13360    1           2 * BIT(1);
       83    13361        /***** Static data *****/
       84    13362    1     DCL DEFER_UTS UBIN WORD STATIC;
       85    13363    1     DCL DEFER_DATE CHAR(8) STATIC;
       86    13364    1     DCL DEFER_TIME CHAR(5) STATIC;
       87    13365    1     DCL 1 UKEY STATIC,
       88    13366    1           2 LEN UBIN BYTE UNAL,
       89    13367    1           2 KEY,
       90    13368    1             3 ACCN CHAR(8), /* SIZEC(B$JIT.ACCN) */
       91    13369    1             3 UNAME CHAR(12), /* SIZEC(B$JIT.UNAME) */
       92    13370    1           2 KEY_ARY(0:19) REDEF KEY CHAR(1);
       93    13371        %XSJ_PARAM(FPTN = XSJ_PARAM,TYPE = %TYP_NAME#,DCB = M$JOBSTAT,
       94    13372                   NAME = FOL_NAME,ACCT = FOL_ACCT,STCLASS = STATIC);
       95    13389    1     DCL FOL_NAME CHAR(31) STATIC;
       96    13390    1     DCL FOL_ACCT CHAR(8) STATIC DALIGNED;
       97    13391        /***** Constant Variables *****/
       98    13392    1     DCL 1 LEGAL_LENGTH CONSTANT ALIGNED,
       99    13393    1           2 LEN(0:2) UBIN BYTE UNAL INIT(8,12,8); /* ACCN,UNAME,UPASS */
      100    13394        /***** Auto variables *****/
      101    13395    1     DCL   I        SBIN     WORD;
      102    13396    1     DCL   J        SBIN     WORD;
      103    13397    1     DCL   K        SBIN     WORD;
      104    13398    1     DCL   P$       PTR;
      105    13399    1     DCL   T$       PTR;
      106    13400    1     DCL   T2$      PTR;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:35   
      107    13401    1     DCL CALL_FLAG# BIT(1) ALIGNED AUTO;
      108    13402    1     DCL UPASS CHAR(8);
      109    13403    1     DCL SAVE_UPASS CHAR(8);
      110    13404    1     DCL PASS_POS UBIN WORD AUTO;
      111    13405    1     DCL COMMA_POS UBIN WORD AUTO;
      112    13406    1     DCL SAVE_ERR BIT(36) AUTO;
      113    13407    1     DCL PASS_SPECIFIED# BIT(1) SYMREF;
      114    13408    1     DCL ES_FLG BIT(1) ALIGNED;
      115    13409        %PARSE$OUT(NAME = JOB_BLK,STCLASS = AUTO);
      116    13454        /***** Error messages *****/
      117    13455        %ERR_CODE(NAME=E_NOID,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPNOID,STCLASS=CONSTANT);
      118    13475        /*E* ERROR: JPJ-E$JPNOID
      119    13476             MESSAGE: No ID.
      120    13477        */
      121    13478        %ERR_CODE(NAME=E_NONAME,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPNONAME,STCLASS=
             13478            CONSTANT);
      122    13498        /*E* ERROR: JPJ-E$JPNONAME
      123    13499             MESSAGE: The job this one is to follow does not exist.
      124    13500        */
      125    13501        %ERR_CODE(NAME=E_BADWSN,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPBADWSN,STCLASS=
             13501            CONSTANT);
      126    13521        /*E* ERROR: JPJ-E$JPBADWSN
      127    13522             MESSAGE: An unknown WSN was specified.
      128    13523        */
      129    13524        %ERR_CODE(NAME=E_CANTWSN,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPCANTWSN,STCLASS=
             13524            CONSTANT);
      130    13544        /*E* ERROR: JPJ-E$JPCANTWSN
      131    13545             MESSAGE: The WSN specified does not allow access from this account.
      132    13546        */
      133    13547       %ERR_CODE(NAME=E_MANYFOLLOW,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPMANYFOLLOW,STCLASS
             13547            =CONSTANT);
      134    13567        /*E* ERROR: JPJ-E$JPMANYFOLLOW
      135    13568             MESSAGE: A maximum of 8 FOLLOW jobnames may be specified.
      136    13569        */
      137    13570       %ERR_CODE(NAME=E_BADID,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPBADID,STCLASS=CONSTANT)
             13570            ;
      138    13590        /*E* ERROR: JPJ-E$JPBADID
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:36   
      139    13591             MESSAGE: Illegal ID.
      140    13592        */
      141    13593        %ERR_CODE(NAME=E_MAXPRIO,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPMAXPRIO,STCLASS=
             13593            CONSTANT);
      142    13613        /*E* ERROR: JPJ-E$JPMAXPRIO
      143    13614             MESSAGE: The PRIO specified exceeds this account's maximum.
      144    13615        */
      145    13616        %ERR_CODE(NAME=E_NOBATCH,FCG#=PRESCANFCG,MID#='12'O,CODE#=%E$JPNOBATCH,STCLASS=
             13616            CONSTANT);
      146    13636        /*E* ERROR: JPJ-E$JPNOBATCH
      147    13637             MESSAGE: This account is not authorized to run in BATCH mode.
      148    13638        */
      149    13639        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:37   
      150    13640    1       SUBSTR(ABORTHDR.TITL.TITLE#,2,8)='UNKNOWN';

  13640  9 000002   000001 236000 xsym               LDQ     ABORTHDR+1
         9 000003   000033 772000                    QRL     27
         9 000004   040000 100400                    MLR     fill='040'O
         9 000005   000142 000007 8                  ADSC9   ES$SECLOG_INIT+49        cn=0,n=7
         9 000006   000001 600010 xsym               ADSC9   ABORTHDR+1               cn=3,n=8

      151    13641    1       SUBSTR(ABORTHDR.TITL.TITLE#,10,12)='UNKNOWN';

  13641  9 000007   040000 100400                    MLR     fill='040'O
         9 000010   000142 000007 8                  ADSC9   ES$SECLOG_INIT+49        cn=0,n=7
         9 000011   000003 600014 xsym               ADSC9   ABORTHDR+3               cn=3,n=12

      152    13642    1       UPASS = ' ';

  13642  9 000012   000035 235000 xsym               LDA     B_VECTNIL+29
         9 000013   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 000014   200012 757100                    STAQ    UPASS,,AUTO

      153    13643    1       UKEY.KEY.ACCN = CODE04.CREATOR.ACCT;

  13643  9 000015   000000 470400 xsym               LDP0    CODE04$
         9 000016   040000 100500                    MLR     fill='040'O
         9 000017   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         9 000020   000047 200010 7                  ADSC9   UKEY                     cn=1,n=8

      154    13644    1       UKEY.KEY.UNAME = CODE04.CREATOR.NAME;

  13644  9 000021   040000 100500                    MLR     fill='040'O
         9 000022   000005 000014                    ADSC9   5,,PR0                   cn=0,n=12
         9 000023   000051 200014 7                  ADSC9   UKEY+2                   cn=1,n=12

      155    13645    1       UKEY.LEN = SIZEC(UKEY.KEY);

  13645  9 000024   024000 236003                    LDQ     10240,DU
         9 000025   000047 552040 7                  STBQ    UKEY,'40'O
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:38   

      156    13646    1       CALL ASZ$SCRAMBLE(UPASS); /* Default password */

  13646  9 000026   200012 631500                    EPPR1   UPASS,,AUTO
         9 000027   200046 451500                    STP1    @REASON+7,,AUTO
         9 000030   200046 630500                    EPPR0   @REASON+7,,AUTO
         9 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000032   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         9 000033   000000 011000                    NOP     0

      157    13647    1       UKEY.LEN = 0; /* If unaltered, will cause E$JPNOID error */

  13647  9 000034   000000 236003                    LDQ     0,DU
         9 000035   000047 552040 7                  STBQ    UKEY,'40'O

      158    13648        /*
      159    13649             ***** Setup everything for call to CPD$SYNTAX
      160    13650                   Throw away old errors.
      161    13651                   Setup fake P$B -> JOBCMND to drive second parse ...
      162    13652        */
      163    13653    1       ERR_BLK.FIRST = 0;

  13653  9 000036   000001 450000 xsym               STZ     ERR_BLK+1

      164    13654    1       JOB_BLK = %NO#;

  13654  9 000037   000100 100400                    MLR     fill='000'O
         9 000040   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 000041   200022 000020                    ADSC9   JOB_BLK,,AUTO            cn=0,n=16

      165    13655    1       JOB_BLK.CODE = JOBCMND;

  13655  9 000042   000037 220003                    LDX0    31,DU
         9 000043   200022 440100                    SXL0    JOB_BLK,,AUTO

      166    13656    1       PCB.OUT$ = ADDR(JOB_BLK); /* To let CPD$SYNTAX work correctly */

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:39   
  13656  9 000044   200022 630500                    EPPR0   JOB_BLK,,AUTO
         9 000045   000003 450400 xsym               STP0    PCB+3

      167    13657    1       PCB.NCHARS = PCB.NCHARS - 1;

  13657  9 000046   000011 235000 xsym               LDA     PCB+9
         9 000047   000001 135007                    SBLA    1,DL
         9 000050   000011 755000 xsym               STA     PCB+9

      168    13658    1       U$PARAM.CNTU$$ = ENTADDR(JPA$CONTINUE);

  13658  9 000051   000000 636000 xent               EAQ     JPA$CONTINUE
         9 000052   000002 756000 xsym               STQ     U$PARAM+2

      169    13659    1       U$PARAM.REMEM_CONTEXT_ERR$ = ADDR(NIL);

  13659  9 000053   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000054   000017 756000 xsym               STQ     U$PARAM+15

      170    13660    1       PCB.U$$ = ENTADDR(CPD$SYNTRY);

  13660  9 000055   000000 636000 xent               EAQ     CPD$SYNTRY
         9 000056   000004 756000 xsym               STQ     PCB+4

      171    13661    1       PCB.CONTINUE = '1'B;

  13661  9 000057   200000 236007                    LDQ     65536,DL
         9 000060   000005 256000 xsym               ORSQ    PCB+5

      172    13662    1       CALL CPD$SET_NODES(PCB,PCB.ROOT$,U$PARAM.SPCL$$,CALL_FLAG#);

  13662  9 000061   200011 631500                    EPPR1   CALL_FLAG#,,AUTO
         9 000062   200051 451500                    STP1    @REASON+10,,AUTO
         9 000063   000000 236000 10                 LDQ     0
         9 000064   200050 756100                    STQ     @REASON+9,,AUTO
         9 000065   000002 237000 10                 LDAQ    2
         9 000066   200046 757100                    STAQ    @REASON+7,,AUTO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:40   
         9 000067   200046 630500                    EPPR0   @REASON+7,,AUTO
         9 000070   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 000071   000000 701000 xent               TSX1    CPD$SET_NODES
         9 000072   000000 011000                    NOP     0

      173    13663    1       CALL X$PARSE(PCB) ALTRET(E_SYNTAX);

  13663  9 000073   000002 630400 10                 EPPR0   2
         9 000074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000075   000000 701000 xent               TSX1    X$PARSE
         9 000076   000270 702000 9                  TSX2    E_SYNTAX

      174    13664        /*
      175    13665             ***** Process the SCAN option even if there are context errors ...
      176    13666        */
      177    13667    2       DO I = 0 TO PCB.OUT$->P$B.NSUBLKS-1;

  13667  9 000077   200003 450100                    STZ     I,,AUTO
         9 000100   000112 710000 9                  TRA     s:13671+1

      178    13668    2         IF PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = JOB_SCAN

  13668  9 000101   000003 470400 xsym               LDP0    PCB+3
         9 000102   200003 720100                    LXL0    I,,AUTO
         9 000103   000003 471510                    LDP1    3,X0,PR0
         9 000104   100000 721100                    LXL1    0,,PR1
         9 000105   000040 101003                    CMPX1   32,DU
         9 000106   000111 601000 9                  TNZ     s:13671

      179    13669    2         THEN
      180    13670    2           SCAN_CMDS# = %YES#;

  13670  9 000107   400000 236003                    LDQ     -131072,DU
         9 000110   000000 756000 xsym               STQ     SCAN_CMDS#

      181    13671    2       END;

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:41   
  13671  9 000111   200003 054100                    AOS     I,,AUTO
         9 000112   000003 470400 xsym               LDP0    PCB+3
         9 000113   000001 236100                    LDQ     1,,PR0
         9 000114   000022 772000                    QRL     18
         9 000115   200003 116100                    CMPQ    I,,AUTO
         9 000116   000101 605400 9                  TPNZ    s:13668

      182    13672        /*
      183    13673             ***** Process parsed command if no errors ...
      184    13674        */
      185    13675    1       IF ERR_BLK.FIRST = 0

  13675  9 000117   000001 235000 xsym               LDA     ERR_BLK+1
         9 000120   000314 601000 9                  TNZ     s:13731

      186    13676    1       THEN
      187    13677    2         DO; /* If no errors then get name,acct,password */

      188    13678    2           IF PCB.OUT$->P$B.NSUBLKS>0 AND PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE =
             13678                    JOB_ACCTNAME

  13678  9 000121   000001 220100                    LDX0    1,,PR0
         9 000122   000233 600000 9                  TZE     s:13709
         9 000123   000003 471500                    LDP1    3,,PR0
         9 000124   100000 721100                    LXL1    0,,PR1
         9 000125   000003 101003                    CMPX1   3,DU
         9 000126   000233 601000 9                  TNZ     s:13709

      189    13679    2           THEN
      190    13680    3             DO;

      191    13681    3               UKEY.KEY.ACCN = PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$S.TEXT;

  13681  9 000127   100003 473500                    LDP3    3,,PR1
         9 000130   300004 236100                    LDQ     4,,PR3
         9 000131   000033 772000                    QRL     27
         9 000132   000000 622006                    EAX2    0,QL
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:42   
         9 000133   040000 100540                    MLR     fill='040'O
         9 000134   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 000135   000047 200010 7                  ADSC9   UKEY                     cn=1,n=8

      192    13682    3               UKEY.KEY.UNAME = PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$S.TEXT;

  13682  9 000136   000003 471500                    LDP1    3,,PR0
         9 000137   100004 473500                    LDP3    4,,PR1
         9 000140   300004 236100                    LDQ     4,,PR3
         9 000141   000033 772000                    QRL     27
         9 000142   000000 620006                    EAX0    0,QL
         9 000143   040000 100540                    MLR     fill='040'O
         9 000144   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         9 000145   000051 200014 7                  ADSC9   UKEY+2                   cn=1,n=12

      193    13683    3               UKEY.LEN = SIZEC(UKEY.KEY);

  13683  9 000146   024000 236003                    LDQ     10240,DU
         9 000147   000047 552040 7                  STBQ    UKEY,'40'O

      194    13684    3               IF PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS>2

  13684  9 000150   000003 471500                    LDP1    3,,PR0
         9 000151   100001 220100                    LDX0    1,,PR1
         9 000152   000003 100003                    CMPX0   3,DU
         9 000153   000267 602000 9                  TNC     s:13722

      195    13685    3               THEN
      196    13686    4                 DO;

      197    13687    4                   PASS_SPECIFIED# = %YES#;

  13687  9 000154   400000 236003                    LDQ     -131072,DU
         9 000155   000000 756000 xsym               STQ     PASS_SPECIFIED#

      198    13688    4                   P$ = PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(2);

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:43   
  13688  9 000156   100005 236100                    LDQ     5,,PR1
         9 000157   200006 756100                    STQ     P$,,AUTO

      199    13689    4                   PASS_POS = P$->P$S.CPOS;

  13689  9 000160   200006 473500                    LDP3    P$,,AUTO
         9 000161   300002 235100                    LDA     2,,PR3
         9 000162   200016 755100                    STA     PASS_POS,,AUTO

      200    13690    4                   UPASS = P$->P$S.TEXT;

  13690  9 000163   300004 236100                    LDQ     4,,PR3
         9 000164   000033 772000                    QRL     27
         9 000165   000000 621006                    EAX1    0,QL
         9 000166   040100 100540                    MLR     fill='040'O
         9 000167   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         9 000170   200012 000010                    ADSC9   UPASS,,AUTO              cn=0,n=8

      201    13691    4                   SAVE_UPASS = UPASS;

  13691  9 000171   200012 237100                    LDAQ    UPASS,,AUTO
         9 000172   200014 757100                    STAQ    SAVE_UPASS,,AUTO

      202    13692    4                   CALL ASZ$SCRAMBLE(UPASS);

  13692  9 000173   200012 631500                    EPPR1   UPASS,,AUTO
         9 000174   200046 451500                    STP1    @REASON+7,,AUTO
         9 000175   200046 630500                    EPPR0   @REASON+7,,AUTO
         9 000176   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000177   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         9 000200   000000 011000                    NOP     0

      203    13693    4                   COMMA_POS = PASS_POS;

  13693  9 000201   200016 235100                    LDA     PASS_POS,,AUTO
         9 000202   200017 755100                    STA     COMMA_POS,,AUTO

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:44   
      204    13694    5                   DO UNTIL SUBSTR(PCB.TEXT$->T$BUF,COMMA_POS,1) = ',';

      205    13695        /*
      206    13696             ***** Only the comma still needs blanking - CPX$JOB did the rest.
      207    13697        */
      208    13698    5                     COMMA_POS = COMMA_POS - 1;

  13698  9 000203   200017 235100                    LDA     COMMA_POS,,AUTO
         9 000204   000001 135007                    SBLA    1,DL
         9 000205   200017 755100                    STA     COMMA_POS,,AUTO

      209    13699    5                     IF SUBSTR(PCB.TEXT$->T$BUF,COMMA_POS,1) = '"'

  13699  9 000206   000000 470400 xsym               LDP0    PCB
         9 000207   040000 106505                    CMPC    fill='040'O
         9 000210   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         9 000211   000004 000001 10                 ADSC9   4                        cn=0,n=1
         9 000212   000223 601000 9                  TNZ     s:13704

      210    13700    5                     THEN
      211    13701    6                       DO UNTIL SUBSTR(PCB.TEXT$->T$BUF,COMMA_POS,1) = '"';

      212    13702    6                         COMMA_POS = COMMA_POS - 1;

  13702  9 000213   200017 235100                    LDA     COMMA_POS,,AUTO
         9 000214   000001 135007                    SBLA    1,DL
         9 000215   200017 755100                    STA     COMMA_POS,,AUTO

      213    13703    6                       END;

  13703  9 000216   000000 470400 xsym               LDP0    PCB
         9 000217   040000 106505                    CMPC    fill='040'O
         9 000220   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         9 000221   000004 000001 10                 ADSC9   4                        cn=0,n=1
         9 000222   000213 601000 9                  TNZ     s:13702

      214    13704    5                   END;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:45   

  13704  9 000223   040000 106505                    CMPC    fill='040'O
         9 000224   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         9 000225   000005 000001 10                 ADSC9   5                        cn=0,n=1
         9 000226   000203 601000 9                  TNZ     s:13698

      215    13705    4                   SUBSTR(PCB.TEXT$->T$BUF,COMMA_POS,1) = ' ';

  13705  9 000227   040105 100400                    MLR     fill='040'O
         9 000230   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000231   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

      216    13706    4                 END;

      217    13707    3             END;

  13707  9 000232   000267 710000 9                  TRA     s:13722

      218    13708    2           ELSE   /* No ACCT,NAME specified. */
      219    13709    2             IF INSYM$INFO.FLAG = JOBORIG_DEVICE#

  13709  9 000233   000000 471400 xsym               LDP1    INSYM_INFO$
         9 000234   100006 236100                    LDQ     6,,PR1
         9 000235   777000 316003                    CANQ    -512,DU
         9 000236   000256 601000 9                  TNZ     s:13717

      220    13710    2             THEN   /* Came from 'CARD READER' */
      221    13711    3               DO;   /* Flush this job */

      222    13712    3                 CALL JPE$REASON(%REJ_BADID#);

  13712  9 000237   000007 630400 10                 EPPR0   7
         9 000240   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000241   000000 701000 xent               TSX1    JPE$REASON
         9 000242   000000 011000                    NOP     0

      223    13713    3                 CALL CXP$POSTERR(ADDR(ERR_BLK),511,E_NOID);
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:46   

  13713  9 000243   000010 236000 10                 LDQ     8
         9 000244   200046 756100                    STQ     @REASON+7,,AUTO
         9 000245   000012 237000 10                 LDAQ    10
         9 000246   200050 757100                    STAQ    @REASON+9,,AUTO
         9 000247   200046 630500                    EPPR0   @REASON+7,,AUTO
         9 000250   200047 450500                    STP0    @REASON+8,,AUTO
         9 000251   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 000252   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000253   000000 701000 xent               TSX1    CXP$POSTERR
         9 000254   000000 011000                    NOP     0

      224    13714    3               END;

  13714  9 000255   000267 710000 9                  TRA     s:13722

      225    13715    2             ELSE   /* Came from a user already on sys */
      226    13716    3               DO;   /* Insert name,acct from submittor */

      227    13717    3                 UKEY.KEY.ACCN = CODE04.CREATOR.ACCT;

  13717  9 000256   000000 473400 xsym               LDP3    CODE04$
         9 000257   040000 100500                    MLR     fill='040'O
         9 000260   300003 000010                    ADSC9   3,,PR3                   cn=0,n=8
         9 000261   000047 200010 7                  ADSC9   UKEY                     cn=1,n=8

      228    13718    3                 UKEY.KEY.UNAME = CODE04.CREATOR.NAME;

  13718  9 000262   040000 100500                    MLR     fill='040'O
         9 000263   300005 000014                    ADSC9   5,,PR3                   cn=0,n=12
         9 000264   000051 200014 7                  ADSC9   UKEY+2                   cn=1,n=12

      229    13719    3                 UKEY.LEN = SIZEC(UKEY.KEY);

  13719  9 000265   024000 236003                    LDQ     10240,DU
         9 000266   000047 552040 7                  STBQ    UKEY,'40'O

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:47   
      230    13720    3               END;

      231    13721        /**/
      232    13722    3           DO NEVER;

  13722  9 000267   000306 710000 9                  TRA     s:13727

      233    13723    3   E_SYNTAX: CALL JPE$REASON(%REJ_SYNTAX#);

  13723  9 000270   000015 630400 10    E_SYNTAX     EPPR0   13
         9 000271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000272   000000 701000 xent               TSX1    JPE$REASON
         9 000273   000000 011000                    NOP     0

      234    13724    3             CALL CXP$POSTERR(ADDR(ERR_BLK),PCB.HI_CHAR,PCB.ERROR);

  13724  9 000274   000010 236000 10                 LDQ     8
         9 000275   200046 756100                    STQ     @REASON+7,,AUTO
         9 000276   000016 237000 10                 LDAQ    14
         9 000277   200050 757100                    STAQ    @REASON+9,,AUTO
         9 000300   200046 630500                    EPPR0   @REASON+7,,AUTO
         9 000301   200047 450500                    STP0    @REASON+8,,AUTO
         9 000302   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 000303   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000304   000000 701000 xent               TSX1    CXP$POSTERR
         9 000305   000000 011000                    NOP     0

      235    13725    3           END;

      236    13726        /**/
      237    13727    2           IF UKEY.LEN>0

  13727  9 000306   000047 236000 7                  LDQ     UKEY
         9 000307   777000 316003                    CANQ    -512,DU
         9 000310   000367 600000 9                  TZE     s:13757

      238    13728    2           THEN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:48   
      239    13729    2             CALL PROCESS_JOB; /* No errors yet - possible valid id */

  13729  9 000311   000665 701000 9                  TSX1    PROCESS_JOB
         9 000312   000000 011000                    NOP     0

      240    13730    2         END;

  13730  9 000313   000367 710000 9                  TRA     s:13757

      241    13731    1       ELSE IF NOT PASS_TWO# AND ES$LOGSYSACC >= %PC_ES_FAILED# THEN

  13731  9 000314   000000 234000 xsym               SZN     PASS_TWO#
         9 000315   000367 604000 9                  TMI     s:13757
         9 000316   000000 471400 xsym               LDP1    ES$
         9 000317   100000 235100                    LDA     0,,PR1
         9 000320   000003 115007                    CMPA    3,DL
         9 000321   000367 602000 9                  TNC     s:13757

      242    13732    1           IF PCB.OUT$->P$B.NSUBLKS>0 AND PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE =
             13732                    JOB_ACCTNAME THEN

  13732  9 000322   000001 220100                    LDX0    1,,PR0
         9 000323   000367 600000 9                  TZE     s:13757
         9 000324   000003 473500                    LDP3    3,,PR0
         9 000325   300000 721100                    LXL1    0,,PR3
         9 000326   000003 101003                    CMPX1   3,DU
         9 000327   000367 601000 9                  TNZ     s:13757

      243    13733    2             DO;

      244    13734    2               ES_FLG='0'B;

  13734  9 000330   200021 450100                    STZ     ES_FLG,,AUTO

      245    13735    3               DO I=0 TO PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS-1;

  13735  9 000331   200003 450100                    STZ     I,,AUTO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:49   
         9 000332   000354 710000 9                  TRA     s:13738+1

      246    13736    3                 IF PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(I)->P$S.COUNT > LEGAL_LENGTH.
             13736                          LEN(I) THEN

  13736  9 000333   000003 470400 xsym               LDP0    PCB+3
         9 000334   000003 471500                    LDP1    3,,PR0
         9 000335   200003 720100                    LXL0    I,,AUTO
         9 000336   100003 473510                    LDP3    3,X0,PR1
         9 000337   300004 236100                    LDQ     4,,PR3
         9 000340   000033 772000                    QRL     27
         9 000341   200046 756100                    STQ     @REASON+7,,AUTO
         9 000342   200003 235100                    LDA     I,,AUTO
         9 000343   000100 101405                    MRL     fill='000'O
         9 000344   000050 000001 8                  ADSC9   LEGAL_LENGTH,A           cn=0,n=1
         9 000345   200047 000004                    ADSC9   @REASON+8,,AUTO          cn=0,n=4
         9 000346   200047 236100                    LDQ     @REASON+8,,AUTO
         9 000347   200046 116100                    CMPQ    @REASON+7,,AUTO
         9 000350   000353 605000 9                  TPL     s:13738

      247    13737    3                   ES_FLG='1'B;

  13737  9 000351   400000 236003                    LDQ     -131072,DU
         9 000352   200021 756100                    STQ     ES_FLG,,AUTO

      248    13738    3               END;

  13738  9 000353   200003 054100                    AOS     I,,AUTO
         9 000354   000003 471500                    LDP1    3,,PR0
         9 000355   100001 236100                    LDQ     1,,PR1
         9 000356   000022 772000                    QRL     18
         9 000357   200003 116100                    CMPQ    I,,AUTO
         9 000360   000333 605400 9                  TPNZ    s:13736

      249    13739    2               IF ES_FLG THEN

  13739  9 000361   200021 234100                    SZN     ES_FLG,,AUTO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:50   
         9 000362   000367 605000 9                  TPL     s:13757

      250    13740    2                 CALL SECLOG(%ES_JUNK_LOGON#);

  13740  9 000363   000020 236000 10                 LDQ     16
         9 000364   200033 756100                    STQ     J+1,,AUTO
         9 000365   002232 701000 9                  TSX1    SECLOG
         9 000366   000000 011000                    NOP     0

      251    13741    2             END;

      252    13742        /*
      253    13743             ***** If there was a WSN = xxx option on the !JOB command
      254    13744                   then try to open this wsn first. M$OPEN does
      255    13745                   special processing for PRESCAN. It looks at
      256    13746                   the JIT of the submitter (B$JIT0_LO$ -> B$JIT)
      257    13747                   which is passed thru the PROCATTR portion of
      258    13748                   FPT_OPEN (OPEN_LO). The entry in :USERS for the
      259    13749                   submitter (UNAME and ACCT from phony JIT) are
      260    13750                   checked to make sure that this user may access
      261    13751                   the requested WSN.
      262    13752
      263    13753                   There are two error cases.
      264    13754                   1) B$JIT0_LO$ -> B$JIT.ERR non zero means ....
      265    13755                   2) Altret from M$OPEN ...
      266    13756        */
      267    13757    1       IF PASS_TWO#

  13757  9 000367   000000 234000 xsym               SZN     PASS_TWO#
         9 000370   000374 605000 9                  TPL     s:13761

      268    13758    1       THEN
      269    13759    1         OPEN_LO.V.OPER.TEST# = %NO#;

  13759  9 000371   000021 236000 10                 LDQ     17
         9 000372   000044 356000 xsym               ANSQ    OPEN_LO+36
         9 000373   000376 710000 9                  TRA     s:13762
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:51   

      270    13760    1       ELSE
      271    13761    1         OPEN_LO.V.OPER.TEST# = %YES#;

  13761  9 000374   020000 236007                    LDQ     8192,DL
         9 000375   000044 256000 xsym               ORSQ    OPEN_LO+36

      272    13762    1       SUBSTR(ABORTHDR.TITL.TITLE#,2,8)=UKEY.KEY.ACCN;

  13762  9 000376   000001 236000 xsym               LDQ     ABORTHDR+1
         9 000377   000033 772000                    QRL     27
         9 000400   040000 100400                    MLR     fill='040'O
         9 000401   000047 200010 7                  ADSC9   UKEY                     cn=1,n=8
         9 000402   000001 600010 xsym               ADSC9   ABORTHDR+1               cn=3,n=8

      273    13763    1       SUBSTR(ABORTHDR.TITL.TITLE#,10,12)=UKEY.KEY.UNAME;

  13763  9 000403   040000 100400                    MLR     fill='040'O
         9 000404   000051 200014 7                  ADSC9   UKEY+2                   cn=1,n=12
         9 000405   000003 600014 xsym               ADSC9   ABORTHDR+3               cn=3,n=12

      274    13764    1       CALL M$OPEN (OPEN_LO) ALTRET(E_OPEN_LO);

  13764  9 000406   000000 630400 xsym               EPPR0   OPEN_LO
         9 000407   450000 713400                    CLIMB   alt,open
         9 000410   410400 401760                    pmme    nvectors=18
         9 000411   000436 702000 9                  TSX2    E_OPEN_LO

      275    13765    1       IF B$JIT0_LO$ -> B$JIT.ERR ~= '0'B

  13765  9 000412   000000 470400 xsym               LDP0    B$JIT0_LO$
         9 000413   000012 235100                    LDA     10,,PR0
         9 000414   000435 600000 9                  TZE     s:13771

      276    13766    1       THEN /* Report error */
      277    13767    2         DO; /* Report error */

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:52   
      278    13768    2           CALL CXP$POSTERR (ADDR(ERR_BLK),0,B$JIT0_LO$ -> B$JIT.ERR);

  13768  9 000415   000010 236000 10                 LDQ     8
         9 000416   200046 756100                    STQ     @REASON+7,,AUTO
         9 000417   000000 236000 xsym               LDQ     B$JIT0_LO$
         9 000420   000012 036003                    ADLQ    10,DU
         9 000421   000022 235000 10                 LDA     18
         9 000422   200050 757100                    STAQ    @REASON+9,,AUTO
         9 000423   200046 631500                    EPPR1   @REASON+7,,AUTO
         9 000424   200047 451500                    STP1    @REASON+8,,AUTO
         9 000425   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 000426   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000427   000000 701000 xent               TSX1    CXP$POSTERR
         9 000430   000000 011000                    NOP     0

      279    13769    2           LO_WSN = B$JIT0_LO$ -> B$JIT.WOO;

  13769  9 000431   000000 470400 xsym               LDP0    B$JIT0_LO$
         9 000432   000010 237100                    LDAQ    8,,PR0
         9 000433   000000 755000 xsym               STA     LO_WSN
         9 000434   000001 756000 xsym               STQ     LO_WSN+1

      280    13770    2         END;

      281    13771    2       DO NEVER;

  13771  9 000435   000472 710000 9                  TRA     s:13782

      282    13772    2   E_OPEN_LO: /* Bitch about bad wsn */
      283    13773    2         LO_WSN = '@'; /* workstation of origin */

  13773  9 000436   000023 235000 10    E_OPEN_LO    LDA     19
         9 000437   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 000440   000000 755000 xsym               STA     LO_WSN
         9 000441   000001 756000 xsym               STQ     LO_WSN+1

      284    13774    2         SAVE_ERR = B$TCB.ALT$ -> B$ALT.ERR;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:53   

  13774  9 000442   000000 470400 xsym               LDP0    B$TCB$
         9 000443   000000 471500                    LDP1    0,,PR0
         9 000444   100102 236100                    LDQ     66,,PR1
         9 000445   200020 756100                    STQ     SAVE_ERR,,AUTO

      285    13775    2         CALL M$OPEN (OPEN_LO) ALTRET(E_OPEN_LOCAL);

  13775  9 000446   000000 630400 xsym               EPPR0   OPEN_LO
         9 000447   450000 713400                    CLIMB   alt,open
         9 000450   410400 401760                    pmme    nvectors=18
         9 000451   000467 702000 9                  TSX2    E_OPEN_LOCAL

      286    13776    2         CALL CXP$POSTERR (ADDR(ERR_BLK),0,SAVE_ERR);

  13776  9 000452   000010 236000 10                 LDQ     8
         9 000453   200046 756100                    STQ     @REASON+7,,AUTO
         9 000454   200020 630500                    EPPR0   SAVE_ERR,,AUTO
         9 000455   200051 450500                    STP0    @REASON+10,,AUTO
         9 000456   000022 236000 10                 LDQ     18
         9 000457   200050 756100                    STQ     @REASON+9,,AUTO
         9 000460   200046 631500                    EPPR1   @REASON+7,,AUTO
         9 000461   200047 451500                    STP1    @REASON+8,,AUTO
         9 000462   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 000463   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000464   000000 701000 xent               TSX1    CXP$POSTERR
         9 000465   000000 011000                    NOP     0

      287    13777    3         DO NEVER;

  13777  9 000466   000472 710000 9                  TRA     s:13782

      288    13778    3   E_OPEN_LOCAL:
      289    13779    3           CALL JPT$REPORT;

  13779  9 000467   000002 631400 xsym  E_OPEN_LOCAL EPPR1   B_VECTNIL+2
         9 000470   000000 701000 xent               TSX1    JPT$REPORT
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:54   
         9 000471   000000 011000                    NOP     0

      290    13780    3         END;  /* Do never ... E_OPEN_LOCAL ... end */

      291    13781    2       END; /* Do never ... E_OPEN ... end */

      292    13782    1       IF PASS_SPECIFIED#

  13782  9 000472   000000 234000 xsym               SZN     PASS_SPECIFIED#
         9 000473   000654 605000 9                  TPL     s:13820

      293    13783    1       THEN
      294    13784    2         DO; /* Must rewrite record with password blanked */

      295    13785    3           DO K = 0 TO JP_CONTINUE.REC_NUM;

  13785  9 000474   200005 450100                    STZ     K,,AUTO
         9 000475   000642 710000 9                  TRA     s:13816+1

      296    13786    3             IF K < JP_CONTINUE.REC_NUM

  13786  9 000476   200005 236100                    LDQ     K,,AUTO
         9 000477   000000 116000 xsym               CMPQ    JP_CONTINUE
         9 000500   000521 605000 9                  TPL     s:13790

      297    13787    3             THEN
      298    13788    3               JP_CONTINUE.LEN(K) =

  13788  9 000501   200005 235100                    LDA     K,,AUTO
         9 000502   000001 735000                    ALS     1
         9 000503   000100 101405                    MRL     fill='000'O
         9 000504   000001 000002 xsym               ADSC9   JP_CONTINUE+1,A          cn=0,n=2
         9 000505   200046 000004                    ADSC9   @REASON+7,,AUTO          cn=0,n=4
         9 000506   000100 101405                    MRL     fill='000'O
         9 000507   000001 400002 xsym               ADSC9   JP_CONTINUE+1,A          cn=2,n=2
         9 000510   200047 000004                    ADSC9   @REASON+8,,AUTO          cn=0,n=4
         9 000511   200047 236100                    LDQ     @REASON+8,,AUTO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:55   
         9 000512   200046 136100                    SBLQ    @REASON+7,,AUTO
         9 000513   000001 136007                    SBLQ    1,DL
         9 000514   200050 756100                    STQ     @REASON+9,,AUTO
         9 000515   200005 235100                    LDA     K,,AUTO
         9 000516   000005 101500                    MRL     fill='000'O
         9 000517   200050 000004                    ADSC9   @REASON+9,,AUTO          cn=0,n=4
         9 000520   000032 000001 xsym               ADSC9   JP_CONTINUE+26,A         cn=0,n=1

      299    13789    3                 JP_CONTINUE.CHARPOS(K+1)-JP_CONTINUE.CHARPOS(K)-1;
      300    13790    3             IF JP_CONTINUE.CHARPOS(K)+JP_CONTINUE.LEN(K) > COMMA_POS

  13790  9 000521   200005 235100                    LDA     K,,AUTO
         9 000522   000100 101405                    MRL     fill='000'O
         9 000523   000032 000001 xsym               ADSC9   JP_CONTINUE+26,A         cn=0,n=1
         9 000524   200046 000004                    ADSC9   @REASON+7,,AUTO          cn=0,n=4
         9 000525   000001 735000                    ALS     1
         9 000526   000100 101405                    MRL     fill='000'O
         9 000527   000001 000002 xsym               ADSC9   JP_CONTINUE+1,A          cn=0,n=2
         9 000530   200047 000004                    ADSC9   @REASON+8,,AUTO          cn=0,n=4
         9 000531   200047 236100                    LDQ     @REASON+8,,AUTO
         9 000532   200046 036100                    ADLQ    @REASON+7,,AUTO
         9 000533   200017 116100                    CMPQ    COMMA_POS,,AUTO
         9 000534   000641 602000 9                  TNC     s:13816
         9 000535   000641 600000 9                  TZE     s:13816

      301    13791    3             THEN
      302    13792    4               DO;

      303    13793    4                 FPT_REWRITE.BUF_.BUF$ = PINCRC(PCB.TEXT$,JP_CONTINUE.CHARPOS(K));

  13793  9 000536   000100 101405                    MRL     fill='000'O
         9 000537   000001 000002 xsym               ADSC9   JP_CONTINUE+1,A          cn=0,n=2
         9 000540   200046 000004                    ADSC9   @REASON+7,,AUTO          cn=0,n=4
         9 000541   200046 236100                    LDQ     @REASON+7,,AUTO
         9 000542   000020 736000                    QLS     16
         9 000543   000000 036000 xsym               ADLQ    PCB
         9 000544   000005 756000 7                  STQ     FPT_REWRITE+5
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:56   

      304    13794    4                 FPT_REWRITE.BUF_.BOUND = JP_CONTINUE.LEN(K)-1;

  13794  9 000545   200005 235100                    LDA     K,,AUTO
         9 000546   000100 101405                    MRL     fill='000'O
         9 000547   000032 000001 xsym               ADSC9   JP_CONTINUE+26,A         cn=0,n=1
         9 000550   200046 000004                    ADSC9   @REASON+7,,AUTO          cn=0,n=4
         9 000551   200046 236100                    LDQ     @REASON+7,,AUTO
         9 000552   000001 136007                    SBLQ    1,DL
         9 000553   000020 736000                    QLS     16
         9 000554   000004 676000 7                  ERQ     FPT_REWRITE+4
         9 000555   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 000556   000004 656000 7                  ERSQ    FPT_REWRITE+4

      305    13795    4                 IF K = 0 /* Put the bang back in for the first chunk */

  13795  9 000557   000000 115003                    CMPA    0,DU
         9 000560   000574 601000 9                  TNZ     s:13801

      306    13796    4                 THEN
      307    13797    5                   DO;

      308    13798    5                     FPT_REWRITE.BUF_.BUF$ = PINCRC(PCB.TEXT$,-1);

  13798  9 000561   000000 236000 xsym               LDQ     PCB
         9 000562   000034 036000 xsym               ADLQ    B_VECTNIL+28
         9 000563   000005 756000 7                  STQ     FPT_REWRITE+5

      309    13799    5                     FPT_REWRITE.BUF_.BOUND = JP_CONTINUE.LEN(K);

  13799  9 000564   200005 236100                    LDQ     K,,AUTO
         9 000565   000011 402007                    MPY     9,DL
         9 000566   000000 116003                    CMPQ    0,DU
         9 000567   000571 605000 9                  TPL     s:13799+5
         9 000570   000044 036003                    ADLQ    36,DU
         9 000571   003000 061406                    CSR     bolr='003'O
         9 000572   000032 000011 xsym               BDSC    JP_CONTINUE+26,Q         by=0,bit=0,n=9
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:57   
         9 000573   000004 000024 7                  BDSC    FPT_REWRITE+4            by=0,bit=0,n=20

      310    13800    5                   END;

      311    13801    4                 FPT_PRECORD.V.N# = K;

  13801  9 000574   200005 235100                    LDA     K,,AUTO
         9 000575   000037 755000 7                  STA     FPT_PRECORD+7

      312    13802    4                 CALL M$PRECORD (FPT_PRECORD) ALTRET(ABORT);

  13802  9 000576   000030 630400 7                  EPPR0   FPT_PRECORD
         9 000577   440003 713400                    CLIMB   alt,+16387
         9 000600   401000 401760                    pmme    nvectors=3
         9 000601   000655 702000 9                  TSX2    ABORT

      313    13803    4                 FPT_REWRITE.V.DVBYTE = M$EI$->F$DCB.DVBYTE;

  13803  9 000602   000000 470400 xsym               LDP0    M$EI$
         9 000603   000003 236100                    LDQ     3,,PR0
         9 000604   776000 376003                    ANQ     -1024,DU
         9 000605   000013 552040 7                  STBQ    FPT_REWRITE+11,'40'O

      314    13804    4                 CALL M$WRITE (FPT_REWRITE)

  13804  9 000606   000000 630400 7                  EPPR0   FPT_REWRITE
         9 000607   440001 713400                    CLIMB   alt,write
         9 000610   401400 401760                    pmme    nvectors=4
         9 000611   000613 702000 9                  TSX2    s:13807
         9 000612   000617 710000 9                  TRA     s:13811

      315    13805    4                 WHENALTRETURN
      316    13806    5                   DO;

      317    13807    5                     IF NOT M$EI$->F$DCB.TYC.LD#

  13807  9 000613   000000 470400 xsym               LDP0    M$EI$
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:58   
         9 000614   000002 236100                    LDQ     2,,PR0
         9 000615   002000 316003                    CANQ    1024,DU
         9 000616   000655 600000 9                  TZE     ABORT

      318    13808    5                     THEN
      319    13809    5                       GOTO ABORT;
      320    13810    5                   END;

      321    13811    4                 COMMA_POS = PASS_POS;

  13811  9 000617   200016 235100                    LDA     PASS_POS,,AUTO
         9 000620   200017 755100                    STA     COMMA_POS,,AUTO

      322    13812    4                 IF JP_CONTINUE.CHARPOS(K)+JP_CONTINUE.LEN(K) > PASS_POS

  13812  9 000621   200005 236100                    LDQ     K,,AUTO
         9 000622   000100 101406                    MRL     fill='000'O
         9 000623   000032 000001 xsym               ADSC9   JP_CONTINUE+26,Q         cn=0,n=1
         9 000624   200046 000004                    ADSC9   @REASON+7,,AUTO          cn=0,n=4
         9 000625   200005 235100                    LDA     K,,AUTO
         9 000626   000001 735000                    ALS     1
         9 000627   000100 101405                    MRL     fill='000'O
         9 000630   000001 000002 xsym               ADSC9   JP_CONTINUE+1,A          cn=0,n=2
         9 000631   200047 000004                    ADSC9   @REASON+8,,AUTO          cn=0,n=4
         9 000632   200047 236100                    LDQ     @REASON+8,,AUTO
         9 000633   200046 036100                    ADLQ    @REASON+7,,AUTO
         9 000634   200016 116100                    CMPQ    PASS_POS,,AUTO
         9 000635   000641 602000 9                  TNC     s:13816
         9 000636   000641 600000 9                  TZE     s:13816

      323    13813    4                 THEN
      324    13814    4                   K = JP_CONTINUE.REC_NUM; /* quit when password is rewrit */

  13814  9 000637   000000 236000 xsym               LDQ     JP_CONTINUE
         9 000640   200005 756100                    STQ     K,,AUTO

      325    13815    4               END;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:59   

      326    13816    3           END; /* do K = ... */

  13816  9 000641   200005 054100                    AOS     K,,AUTO
         9 000642   200005 236100                    LDQ     K,,AUTO
         9 000643   000000 116000 xsym               CMPQ    JP_CONTINUE
         9 000644   000476 604400 9                  TMOZ    s:13786

      327    13817    2           FPT_PRECORD.V.N# = JP_CONTINUE.REC_NUM + 1;

  13817  9 000645   000000 235000 xsym               LDA     JP_CONTINUE
         9 000646   000001 035007                    ADLA    1,DL
         9 000647   000037 755000 7                  STA     FPT_PRECORD+7

      328    13818    2           CALL M$PRECORD (FPT_PRECORD) ALTRET(ABORT);

  13818  9 000650   000030 630400 7                  EPPR0   FPT_PRECORD
         9 000651   440003 713400                    CLIMB   alt,+16387
         9 000652   401000 401760                    pmme    nvectors=3
         9 000653   000655 702000 9                  TSX2    ABORT

      329    13819    2         END;

      330    13820    1       RETURN;

  13820  9 000654   000000 702200 xent               TSX2  ! X66_ARET

      331    13821        /*
      332    13822             ***** Flush this job ...
      333    13823        */
      334    13824    1   ABORT:
      335    13825    1       CALL JPE$REASON (%REJ_IO#);

  13825  9 000655   000025 630400 10    ABORT        EPPR0   21
         9 000656   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000657   000000 701000 xent               TSX1    JPE$REASON
         9 000660   000000 011000                    NOP     0
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:60   

      336    13826    1       CALL JPT$REPORT;

  13826  9 000661   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 000662   000000 701000 xent               TSX1    JPT$REPORT
         9 000663   000000 011000                    NOP     0

      337    13827    1       ALTRETURN;

  13827  9 000664   000000 702200 xent               TSX2  ! X66_AALT

      338    13828        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:61   
      339    13829    1   PROCESS_JOB: PROC;

  13829  9 000665   200026 741300       PROCESS_JOB  STX1  ! JOB_BLK+4,,AUTO

      340    13830    2       JOB_TBL.ACCT = UKEY.KEY.ACCN;

  13830  9 000666   040000 100400                    MLR     fill='040'O
         9 000667   000047 200010 7                  ADSC9   UKEY                     cn=1,n=8
         9 000670   000016 000010 xsym               ADSC9   JOB_TBL+14               cn=0,n=8

      341    13831    2       JOB_TBL.UNAME = UKEY.KEY.UNAME;

  13831  9 000671   040000 100400                    MLR     fill='040'O
         9 000672   000051 200014 7                  ADSC9   UKEY+2                   cn=1,n=12
         9 000673   000020 000014 xsym               ADSC9   JOB_TBL+16               cn=0,n=12

      342    13832    2       CALL GET_USERS ALTRET(INVALID_ID);

  13832  9 000674   001004 701000 9                  TSX1    GET_USERS
         9 000675   000751 702000 9                  TSX2    INVALID_ID

      343    13833    2       B$JIT0_LO$->B$JIT.ACCN = UKEY.KEY.ACCN;

  13833  9 000676   000000 470400 xsym               LDP0    B$JIT0_LO$
         9 000677   040100 100400                    MLR     fill='040'O
         9 000700   000047 200010 7                  ADSC9   UKEY                     cn=1,n=8
         9 000701   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8

      344    13834    2       B$JIT0_LO$->B$JIT.UNAME = UKEY.KEY.UNAME;

  13834  9 000702   040100 100400                    MLR     fill='040'O
         9 000703   000051 200014 7                  ADSC9   UKEY+2                   cn=1,n=12
         9 000704   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12

      345    13835    2       IF KL_DREC.FLAGS.BATOK = %NO#

  13835  9 000705   000000 236000 xsym               LDQ     KL_DREC
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:62   
         9 000706   000040 316003                    CANQ    32,DU
         9 000707   000726 601000 9                  TNZ     s:13844

      346    13836    2       THEN
      347    13837    3         DO; /* Not authorized for BATCH */

      348    13838    3           CALL JPE$REASON(%REJ_NOBATCH#);

  13838  9 000710   000027 630400 10                 EPPR0   23
         9 000711   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000712   000000 701000 xent               TSX1    JPE$REASON
         9 000713   000000 011000                    NOP     0

      349    13839    3           CALL CXP$POSTERR(ADDR(ERR_BLK),511,E_NOBATCH);

  13839  9 000714   000010 236000 10                 LDQ     8
         9 000715   200046 756100                    STQ     @REASON+7,,AUTO
         9 000716   000030 237000 10                 LDAQ    24
         9 000717   200050 757100                    STAQ    @REASON+9,,AUTO
         9 000720   200046 630500                    EPPR0   @REASON+7,,AUTO
         9 000721   200047 450500                    STP0    @REASON+8,,AUTO
         9 000722   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 000723   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000724   000000 701000 xent               TSX1    CXP$POSTERR
         9 000725   000000 011000                    NOP     0

      350    13840    3         END;

      351    13841        /*
      352    13842             ***** Get the default values for TIME,MEM and PRIO ...
      353    13843        */
      354    13844    2       JOB_TBL.TIM = AS_USERS.DTIME(%M_BATCH#-1);

  13844  9 000726   000255 235000 xsym               LDA     AS_USERS+173
         9 000727   000013 755000 xsym               STA     JOB_TBL+11

      355    13845    2       JOB_TBL.RRT(JM_RX$MEM) = AS_USERS.DMEM(%M_BATCH#-1);
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:63   

  13845  9 000730   000263 220000 xsym               LDX0    AS_USERS+179
         9 000731   000042 740000 xsym               STX0    JOB_TBL+34

      356    13846    2       IF INSYM$INFO.DEFPRI = 511

  13846  9 000732   000000 470400 xsym               LDP0    INSYM_INFO$
         9 000733   000005 236100                    LDQ     5,,PR0
         9 000734   000777 376007                    ANQ     511,DL
         9 000735   000777 116007                    CMPQ    511,DL
         9 000736   000743 601000 9                  TNZ     s:13850

      357    13847    2       THEN /* Job came from CR */
      358    13848    2         JOB_TBL.PRIO = AS_USERS.DMPRIO(%M_BATCH#-1);

  13848  9 000737   000111 236000 xsym               LDQ     AS_USERS+73
         9 000740   000011 772000                    QRL     9
         9 000741   000014 552020 xsym               STBQ    JOB_TBL+12,'20'O
         9 000742   000746 710000 9                  TRA     s:13854

      359    13849    2       ELSE /* Get default PRIO from passed JIT */
      360    13850    2         JOB_TBL.PRIO = INSYM$INFO.DEFPRI;

  13850  9 000743   000005 236100                    LDQ     5,,PR0
         9 000744   000022 736000                    QLS     18
         9 000745   000014 552020 xsym               STBQ    JOB_TBL+12,'20'O

      361    13851        /*
      362    13852             ***** Process the options on !JOB command ...
      363    13853        */
      364    13854    2       CALL PROCESS_OPTS;

  13854  9 000746   001132 701000 9                  TSX1    PROCESS_OPTS
         9 000747   000000 011000                    NOP     0

      365    13855    3       DO NEVER;

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:64   
  13855  9 000750   001002 710000 9                  TRA     s:13865

      366    13856    3   INVALID_ID: CALL JPE$REASON(%REJ_BADID#);

  13856  9 000751   000007 630400 10    INVALID_ID   EPPR0   7
         9 000752   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000753   000000 701000 xent               TSX1    JPE$REASON
         9 000754   000000 011000                    NOP     0

      367    13857    3         CALL CXP$POSTERR(ADDR(ERR_BLK),511,E_BADID);

  13857  9 000755   000010 236000 10                 LDQ     8
         9 000756   200046 756100                    STQ     @REASON+7,,AUTO
         9 000757   000032 237000 10                 LDAQ    26
         9 000760   200050 757100                    STAQ    @REASON+9,,AUTO
         9 000761   200046 630500                    EPPR0   @REASON+7,,AUTO
         9 000762   200047 450500                    STP0    @REASON+8,,AUTO
         9 000763   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 000764   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000765   000000 701000 xent               TSX1    CXP$POSTERR
         9 000766   000000 011000                    NOP     0

      368    13858    3         IF INSYM$INFO.FLAG = JOBORIG_DEVICE#

  13858  9 000767   000000 470400 xsym               LDP0    INSYM_INFO$
         9 000770   000006 236100                    LDQ     6,,PR0
         9 000771   777000 316003                    CANQ    -512,DU
         9 000772   001002 601000 9                  TNZ     s:13865

      369    13859    3         THEN
      370    13860    4           DO; /* bad id input from CR...put out bad id on banner */

      371    13861    4             B$JIT0_LO$->B$JIT.ACCN = UKEY.KEY.ACCN;

  13861  9 000773   000000 471400 xsym               LDP1    B$JIT0_LO$
         9 000774   040100 100400                    MLR     fill='040'O
         9 000775   000047 200010 7                  ADSC9   UKEY                     cn=1,n=8
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:65   
         9 000776   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

      372    13862    4             B$JIT0_LO$->B$JIT.UNAME = UKEY.KEY.UNAME;

  13862  9 000777   040100 100400                    MLR     fill='040'O
         9 001000   000051 200014 7                  ADSC9   UKEY+2                   cn=1,n=12
         9 001001   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12

      373    13863    4           END;

      374    13864    3       END;

      375    13865    2       RETURN;

  13865  9 001002   200026 221300                    LDX1  ! JOB_BLK+4,,AUTO
         9 001003   000001 702211                    TSX2  ! 1,X1

      376    13866        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:66   
      377    13867    2   GET_USERS: PROC ALTRET;

  13867  9 001004   200030 741300       GET_USERS    STX1  ! JOB_BLK+6,,AUTO

      378    13868        /*
      379    13869             ***** Strip trailing blanks off :USERS/:HLP key ...
      380    13870        */
      381    13871    4       DO WHILE(UKEY.KEY_ARY(UKEY.LEN-1) = ' ');

  13871  9 001005   000047 236000 7                  LDQ     UKEY
         9 001006   000033 772000                    QRL     27
         9 001007   040000 106406                    CMPC    fill='040'O
         9 001010   000047 000001 7                  ADSC9   UKEY,Q                   cn=0,n=1
         9 001011   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 001012   001024 601000 9                  TNZ     s:13874

      382    13872    4         UKEY.LEN = UKEY.LEN - 1;

  13872  9 001013   000047 236000 7                  LDQ     UKEY
         9 001014   777000 036003                    ADLQ    -512,DU
         9 001015   000047 552040 7                  STBQ    UKEY,'40'O

      383    13873    4       END;

  13873  9 001016   000047 236000 7                  LDQ     UKEY
         9 001017   000033 772000                    QRL     27
         9 001020   040000 106406                    CMPC    fill='040'O
         9 001021   000047 000001 7                  ADSC9   UKEY,Q                   cn=0,n=1
         9 001022   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 001023   001013 600000 9                  TZE     s:13872

      384    13874    3       CALL M$READ(READ_USERS) ALTRET(RD_ALT);

  13874  9 001024   000014 630400 8                  EPPR0   READ_USERS
         9 001025   440000 713400                    CLIMB   alt,read
         9 001026   401400 401760                    pmme    nvectors=4
         9 001027   001104 702000 9                  TSX2    RD_ALT
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:67   

      385    13875    3       CALL M$READ(READ_HLP) ALTRET(RD_ALT);

  13875  9 001030   000032 630400 8                  EPPR0   READ_HLP
         9 001031   440000 713400                    CLIMB   alt,read
         9 001032   401400 401760                    pmme    nvectors=4
         9 001033   001104 702000 9                  TSX2    RD_ALT

      386    13876        /*
      387    13877            ***** If no PASSWORD was specified on the !JOB
      388    13878                  command and the job is to run in the
      389    13879                  submitter's account, then let it go thru ...
      390    13880        */
      391    13881    3       IF PASS_SPECIFIED# = %NO#

  13881  9 001034   000000 234000 xsym               SZN     PASS_SPECIFIED#
         9 001035   001051 604000 9                  TMI     s:13890
         9 001036   000000 470400 xsym               LDP0    CODE04$
         9 001037   040100 106400                    CMPC    fill='040'O
         9 001040   000047 200010 7                  ADSC9   UKEY                     cn=1,n=8
         9 001041   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         9 001042   001051 601000 9                  TNZ     s:13890
         9 001043   040100 106400                    CMPC    fill='040'O
         9 001044   000051 200014 7                  ADSC9   UKEY+2                   cn=1,n=12
         9 001045   000005 000014                    ADSC9   5,,PR0                   cn=0,n=12
         9 001046   001051 601000 9                  TNZ     s:13890

      392    13882    3         AND (UKEY.KEY.ACCN = CODE04.CREATOR.ACCT
      393    13883    3         AND UKEY.KEY.UNAME = CODE04.CREATOR.NAME)
      394    13884    3       THEN
      395    13885    3         PASSWORD_OK# = %YES#;

  13885  9 001047   400000 236003                    LDQ     -131072,DU
         9 001050   000000 756000 xsym               STQ     PASSWORD_OK#

      396    13886        /*
      397    13887          This setting and then testing of PASSWORD_OK# is done so that the printing
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:68   
      398    13888          pass of a bad job will not fail on a blanked out password field
      399    13889        */
      400    13890    3       IF PASSWORD_OK# = %NO# AND UPASS ~= KL_DREC.PASSWORD

  13890  9 001051   000000 234000 xsym               SZN     PASSWORD_OK#
         9 001052   001100 604000 9                  TMI     s:13900
         9 001053   040000 106500                    CMPC    fill='040'O
         9 001054   200012 000010                    ADSC9   UPASS,,AUTO              cn=0,n=8
         9 001055   000002 000010 xsym               ADSC9   KL_DREC+2                cn=0,n=8
         9 001056   001100 600000 9                  TZE     s:13900

      401    13891    4       THEN DO; /* May want to log in security log and/or update :USERS */

      402    13892    4           IF NOT PASS_TWO# THEN

  13892  9 001057   000000 234000 xsym               SZN     PASS_TWO#
         9 001060   001076 604000 9                  TMI     s:13897

      403    13893    4             IF ES$LOGSYSACC >= %PC_ES_FAILEDPW# THEN

  13893  9 001061   000000 470400 xsym               LDP0    ES$
         9 001062   000000 235100                    LDA     0,,PR0
         9 001063   001071 600000 9                  TZE     s:13895

      404    13894    4               CALL SECLOG(%ES_BAD_PW#);

  13894  9 001064   000034 236000 10                 LDQ     28
         9 001065   200033 756100                    STQ     J+1,,AUTO
         9 001066   002232 701000 9                  TSX1    SECLOG
         9 001067   000000 011000                    NOP     0
         9 001070   001076 710000 9                  TRA     s:13897

      405    13895    5             ELSE CALL UPD_USERS(%ES_BAD_PW#) WHENALTRETURN DO;

  13895  9 001071   000034 236000 10                 LDQ     28
         9 001072   200037 756100                    STQ     LOGON_LEN+2,,AUTO
         9 001073   002555 701000 9                  TSX1    UPD_USERS
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:69   
         9 001074   001076 702000 9                  TSX2    s:13897
         9 001075   001076 710000 9                  TRA     s:13897

      406    13896    5                 END;

      407    13897    4           ALTRETURN;

  13897  9 001076   200030 221300                    LDX1  ! JOB_BLK+6,,AUTO
         9 001077   000000 702211                    TSX2  ! 0,X1

      408    13898    4         END;
      409    13899    3       ELSE
      410    13900    3         PASSWORD_OK# = %YES#;

  13900  9 001100   400000 236003                    LDQ     -131072,DU
         9 001101   000000 756000 xsym               STQ     PASSWORD_OK#

      411    13901    3       RETURN;

  13901  9 001102   200030 221300                    LDX1  ! JOB_BLK+6,,AUTO
         9 001103   000001 702211                    TSX2  ! 1,X1

      412    13902        /*
      413    13903             ***** Handle read errors ...
      414    13904        */
      415    13905    3   RD_ALT:
      416    13906    3       IF B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$NOKEY

  13906  9 001104   000000 470400 xsym  RD_ALT       LDP0    B$TCB$
         9 001105   000000 471500                    LDP1    0,,PR0
         9 001106   100102 236100                    LDQ     66,,PR1
         9 001107   377770 376007                    ANQ     131064,DL
         9 001110   001020 116007                    CMPQ    528,DL
         9 001111   001116 600000 9                  TZE     s:13909

      417    13907    3       THEN
      418    13908    3         CALL JPT$REPORT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:70   

  13908  9 001112   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001113   000000 701000 xent               TSX1    JPT$REPORT
         9 001114   000000 011000                    NOP     0
         9 001115   001130 710000 9                  TRA     s:13911

      419    13909    3       ELSE IF NOT PASS_TWO# AND ES$LOGSYSACC >= %PC_ES_FAILEDPWNE# THEN

  13909  9 001116   000000 234000 xsym               SZN     PASS_TWO#
         9 001117   001130 604000 9                  TMI     s:13911
         9 001120   000000 473400 xsym               LDP3    ES$
         9 001121   300000 235100                    LDA     0,,PR3
         9 001122   000002 115007                    CMPA    2,DL
         9 001123   001130 602000 9                  TNC     s:13911

      420    13910    3           CALL SECLOG(%ES_NO_SUCH_USER#);

  13910  9 001124   000035 236000 10                 LDQ     29
         9 001125   200033 756100                    STQ     J+1,,AUTO
         9 001126   002232 701000 9                  TSX1    SECLOG
         9 001127   000000 011000                    NOP     0

      421    13911    3       ALTRETURN;

  13911  9 001130   200030 221300                    LDX1  ! JOB_BLK+6,,AUTO
         9 001131   000000 702211                    TSX2  ! 0,X1

      422    13912    3   END GET_USERS;
      423    13913        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:71   
      424    13914    2   PROCESS_OPTS: PROC;

  13914  9 001132   200030 741300       PROCESS_OPTS STX1  ! JOB_BLK+6,,AUTO

      425    13915    3     DCL I SBIN;
      426    13916    3     DCL J SBIN;
      427    13917    3     DCL K SBIN;
      428    13918    3     DCL TEMP UBIN WORD;
      429    13919    3     DCL VAR_LEN SBIN STATIC;
      430    13920    3     DCL VAR$CHAR CHAR(VAR_LEN) BASED;
      431    13921    3     DCL JOBNAME CHAR(31) CALIGNED;
      432    13922    4       DO I = 0 TO PCB.OUT$->P$B.NSUBLKS-1;

  13922  9 001133   200031 450100                    STZ     I,,AUTO
         9 001134   002173 710000 9                  TRA     s:14073+1

      433    13923    4         P$ = PCB.OUT$->P$B.SUBLK$(I);

  13923  9 001135   000003 470400 xsym               LDP0    PCB+3
         9 001136   200031 720100                    LXL0    I,,AUTO
         9 001137   000003 236110                    LDQ     3,X0,PR0
         9 001140   200006 756100                    STQ     P$,,AUTO

      434    13924    5         DO CASE(P$->P$B.CODE);

  13924  9 001141   200006 471500                    LDP1    P$,,AUTO
         9 001142   100000 721100                    LXL1    0,,PR1
         9 001143   000053 101003                    CMPX1   43,DU
         9 001144   001146 602011 9                  TNC     s:13924+5,X1
         9 001145   002172 710000 9                  TRA     s:14073
         9 001146   002172 710000 9                  TRA     s:14073
         9 001147   002172 710000 9                  TRA     s:14073
         9 001150   001304 710000 9                  TRA     s:13946
         9 001151   002172 710000 9                  TRA     s:14073
         9 001152   002172 710000 9                  TRA     s:14073
         9 001153   002172 710000 9                  TRA     s:14073
         9 001154   002172 710000 9                  TRA     s:14073
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:72   
         9 001155   002172 710000 9                  TRA     s:14073
         9 001156   001356 710000 9                  TRA     s:13964
         9 001157   002172 710000 9                  TRA     s:14073
         9 001160   002172 710000 9                  TRA     s:14073
         9 001161   002172 710000 9                  TRA     s:14073
         9 001162   002172 710000 9                  TRA     s:14073
         9 001163   002172 710000 9                  TRA     s:14073
         9 001164   002172 710000 9                  TRA     s:14073
         9 001165   001644 710000 9                  TRA     s:14002
         9 001166   002172 710000 9                  TRA     s:14073
         9 001167   002172 710000 9                  TRA     s:14073
         9 001170   002172 710000 9                  TRA     s:14073
         9 001171   001324 710000 9                  TRA     s:13953
         9 001172   002172 710000 9                  TRA     s:14073
         9 001173   002172 710000 9                  TRA     s:14073
         9 001174   002172 710000 9                  TRA     s:14073
         9 001175   002172 710000 9                  TRA     s:14073
         9 001176   001301 710000 9                  TRA     s:13944
         9 001177   001345 710000 9                  TRA     s:13958
         9 001200   001353 710000 9                  TRA     s:13962
         9 001201   002172 710000 9                  TRA     s:14073
         9 001202   001276 710000 9                  TRA     s:13942
         9 001203   002172 710000 9                  TRA     s:14073
         9 001204   001221 710000 9                  TRA     s:13928
         9 001205   001350 710000 9                  TRA     s:13960
         9 001206   001321 710000 9                  TRA     s:13951
         9 001207   002172 710000 9                  TRA     s:14073
         9 001210   002172 710000 9                  TRA     s:14073
         9 001211   002172 710000 9                  TRA     s:14073
         9 001212   002172 710000 9                  TRA     s:14073
         9 001213   002172 710000 9                  TRA     s:14073
         9 001214   002172 710000 9                  TRA     s:14073
         9 001215   002172 710000 9                  TRA     s:14073
         9 001216   002172 710000 9                  TRA     s:14073
         9 001217   002172 710000 9                  TRA     s:14073
         9 001220   001307 710000 9                  TRA     s:13948

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:73   
      435    13925    5           CASE(JOB_ACCTNAME);

      436    13926             /* Ignore */
      437    13927    5           CASE(JOB_PRIO);

      438    13928    5             CALL CHARBIN(TEMP,P$->P$S.TEXT);

  13928  9 001221   100004 236100                    LDQ     4,,PR1
         9 001222   000033 772000                    QRL     27
         9 001223   000000 622006                    EAX2    0,QL
         9 001224   000100 305540                    DTB
         9 001225   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
         9 001226   200046 000010                    NDSC9   @REASON+7,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         9 001227   200047 235100                    LDA     @REASON+8,,AUTO
         9 001230   200034 755100                    STA     TEMP,,AUTO

      439    13929    5             JOB_TBL.PRIO = TEMP;

  13929  9 001231   200034 236100                    LDQ     TEMP,,AUTO
         9 001232   000022 736000                    QLS     18
         9 001233   000014 552020 xsym               STBQ    JOB_TBL+12,'20'O

      440    13930    5             IF INSYM$INFO.MAXPRI = 511

  13930  9 001234   000000 473400 xsym               LDP3    INSYM_INFO$
         9 001235   300005 236100                    LDQ     5,,PR3
         9 001236   777000 376007                    ANQ     -512,DL
         9 001237   777000 116007                    CMPQ    -512,DL
         9 001240   001245 601000 9                  TNZ     s:13934

      441    13931    5             THEN
      442    13932    5               TEMP = AS_USERS.MMPRIO(%M_BATCH#-1);

  13932  9 001241   000110 236000 xsym               LDQ     AS_USERS+72
         9 001242   000033 772000                    QRL     27
         9 001243   200034 756100                    STQ     TEMP,,AUTO
         9 001244   001251 710000 9                  TRA     s:13935
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:74   

      443    13933    5             ELSE
      444    13934    5               TEMP = INSYM$INFO.MAXPRI;

  13934  9 001245   300005 236100                    LDQ     5,,PR3
         9 001246   000011 772000                    QRL     9
         9 001247   000777 376007                    ANQ     511,DL
         9 001250   200034 756100                    STQ     TEMP,,AUTO

      445    13935    5             IF JOB_TBL.PRIO>TEMP

  13935  9 001251   000014 236000 xsym               LDQ     JOB_TBL+12
         9 001252   000022 772000                    QRL     18
         9 001253   000777 376007                    ANQ     511,DL
         9 001254   200034 116100                    CMPQ    TEMP,,AUTO
         9 001255   002172 602000 9                  TNC     s:14073
         9 001256   002172 600000 9                  TZE     s:14073

      446    13936    5             THEN
      447    13937    6               DO;

      448    13938    6                 TEMP = P$ -> P$S.CPOS;

  13938  9 001257   100002 235100                    LDA     2,,PR1
         9 001260   200034 755100                    STA     TEMP,,AUTO

      449    13939    6                 CALL CXP$POSTERR(ADDR(ERR_BLK),TEMP,E_MAXPRIO);

  13939  9 001261   000010 236000 10                 LDQ     8
         9 001262   200046 756100                    STQ     @REASON+7,,AUTO
         9 001263   000036 236000 10                 LDQ     30
         9 001264   200051 756100                    STQ     @REASON+10,,AUTO
         9 001265   200034 634500                    EPPR4   TEMP,,AUTO
         9 001266   200050 454500                    STP4    @REASON+9,,AUTO
         9 001267   200046 635500                    EPPR5   @REASON+7,,AUTO
         9 001270   200047 455500                    STP5    @REASON+8,,AUTO
         9 001271   200047 630500                    EPPR0   @REASON+8,,AUTO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:75   
         9 001272   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001273   000000 701000 xent               TSX1    CXP$POSTERR
         9 001274   000000 011000                    NOP     0

      450    13940    6               END;

  13940  9 001275   002172 710000 9                  TRA     s:14073

      451    13941    5           CASE(JOB_ORDER);

      452    13942    5             JOB_TBL.FLG.O1 = %YES#;

  13942  9 001276   400000 236007                    LDQ     -131072,DL
         9 001277   000014 256000 xsym               ORSQ    JOB_TBL+12
         9 001300   002172 710000 9                  TRA     s:14073

      453    13943    5           CASE(JOB_NORDER);

      454    13944    5             JOB_TBL.FLG.O1 = %NO#;

  13944  9 001301   000037 236000 10                 LDQ     31
         9 001302   000014 356000 xsym               ANSQ    JOB_TBL+12
         9 001303   002172 710000 9                  TRA     s:14073

      455    13945    5           CASE(JOB_ACCT);

      456    13946    5             JOB_TBL.FLG.ACC = %YES#;

  13946  9 001304   040000 236007                    LDQ     16384,DL
         9 001305   000014 256000 xsym               ORSQ    JOB_TBL+12
         9 001306   002172 710000 9                  TRA     s:14073

      457    13947    5           CASE(JOB_WSN);

      458    13948    5             JOB_TBL.WSN = P$->P$S.TEXT;

  13948  9 001307   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:76   
         9 001310   000033 772000                    QRL     27
         9 001311   000000 622006                    EAX2    0,QL
         9 001312   040000 100540                    MLR     fill='040'O
         9 001313   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         9 001314   000025 000010 xsym               ADSC9   JOB_TBL+21               cn=0,n=8

      459    13949    5             LO_WSN = JOB_TBL.WSN;

  13949  9 001315   040000 100400                    MLR     fill='040'O
         9 001316   000025 000010 xsym               ADSC9   JOB_TBL+21               cn=0,n=8
         9 001317   000000 000010 xsym               ADSC9   LO_WSN                   cn=0,n=8
         9 001320   002172 710000 9                  TRA     s:14073

      460    13950    5           CASE(JOB_SCAN);

      461    13951    5             SCAN_CMDS# = %YES#;

  13951  9 001321   400000 236003                    LDQ     -131072,DU
         9 001322   000000 756000 xsym               STQ     SCAN_CMDS#
         9 001323   002172 710000 9                  TRA     s:14073

      462    13952    5           CASE(JOB_JNAME);

      463    13953    5             JOBNAME = P$ -> P$S.TEXT;

  13953  9 001324   100004 236100                    LDQ     4,,PR1
         9 001325   000033 772000                    QRL     27
         9 001326   000000 622006                    EAX2    0,QL
         9 001327   040100 100540                    MLR     fill='040'O
         9 001330   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         9 001331   200035 000037                    ADSC9   JOBNAME,,AUTO            cn=0,n=31

      464    13954    5             CALL INDEX (TEMP,' ',JOBNAME);

  13954  9 001332   000000 124500                    SCM     mask='000'O
         9 001333   200035 000037                    ADSC9   JOBNAME,,AUTO            cn=0,n=31
         9 001334   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:77   
         9 001335   200034 000100                    ARG     TEMP,,AUTO

      465    13955    5             JOB_TBL.JNL = TEMP;

  13955  9 001336   200034 236100                    LDQ     TEMP,,AUTO
         9 001337   000033 736000                    QLS     27
         9 001340   000057 552040 xsym               STBQ    JOB_TBL+47,'40'O

      466    13956    5             JOB_TBL.JNAME = JOBNAME;

  13956  9 001341   040000 100500                    MLR     fill='040'O
         9 001342   200035 000037                    ADSC9   JOBNAME,,AUTO            cn=0,n=31
         9 001343   000057 200037 xsym               ADSC9   JOB_TBL+47               cn=1,n=31
         9 001344   002172 710000 9                  TRA     s:14073

      467    13957    5           CASE(JOB_NPI);

      468    13958    5             JOB_TBL.FLG.NPI = %YES#;

  13958  9 001345   004000 236007                    LDQ     2048,DL
         9 001346   000014 256000 xsym               ORSQ    JOB_TBL+12
         9 001347   002172 710000 9                  TRA     s:14073

      469    13959    5           CASE(JOB_RERUN);

      470    13960    5             JOB_TBL.FLG.RR = %YES#;

  13960  9 001350   020000 236007                    LDQ     8192,DL
         9 001351   000014 256000 xsym               ORSQ    JOB_TBL+12
         9 001352   002172 710000 9                  TRA     s:14073

      471    13961    5           CASE(JOB_NRERUN);

      472    13962    5             JOB_TBL.FLG.RR = %NO#;

  13962  9 001353   000021 236000 10                 LDQ     17
         9 001354   000014 356000 xsym               ANSQ    JOB_TBL+12
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:78   
         9 001355   002172 710000 9                  TRA     s:14073

      473    13963    5           CASE(JOB_DEFER);

      474    13964    5             DEFER_TSTAMP.DATE_ = VECTOR(DEFER_DATE);

  13964  9 001356   000040 237000 10                 LDAQ    32
         9 001357   000016 757000 7                  STAQ    DEFER_TSTAMP+2

      475    13965    5             DEFER_TSTAMP.TIME_ = VECTOR(NIL);

  13965  9 001360   000042 237000 10                 LDAQ    34
         9 001361   000020 757000 7                  STAQ    DEFER_TSTAMP+4

      476    13966    5             CALL M$TIME(TODAYS_DATE);

  13966  9 001362   000000 630400 8                  EPPR0   TODAYS_DATE
         9 001363   020004 713400                    CLIMB   8196
         9 001364   402000 401760                    pmme    nvectors=5

      477    13967    6             DO J = 0 TO P$->P$B.NSUBLKS-1;

  13967  9 001365   200032 450100                    STZ     J,,AUTO
         9 001366   001607 710000 9                  TRA     s:13993+1

      478    13968    6               T$ = P$->P$B.SUBLK$(J);

  13968  9 001367   200006 470500                    LDP0    P$,,AUTO
         9 001370   200032 720100                    LXL0    J,,AUTO
         9 001371   000003 236110                    LDQ     3,X0,PR0
         9 001372   200007 756100                    STQ     T$,,AUTO

      479    13969    6               IF T$->P$B.CODE = JOB_DTIME

  13969  9 001373   200007 471500                    LDP1    T$,,AUTO
         9 001374   100000 721100                    LXL1    0,,PR1
         9 001375   000011 101003                    CMPX1   9,DU
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:79   
         9 001376   001457 601000 9                  TNZ     s:13982

      480    13970    6               THEN
      481    13971    7                 DO;

      482    13972    7                   CALL CONCAT(DEFER_TIME,

  13972  9 001377   100003 473500                    LDP3    3,,PR1
         9 001400   300004 236100                    LDQ     4,,PR3
         9 001401   000033 772000                    QRL     27
         9 001402   100004 474500                    LDP4    4,,PR1
         9 001403   000000 622006                    EAX2    0,QL
         9 001404   400004 236100                    LDQ     4,,PR4
         9 001405   000033 772000                    QRL     27
         9 001406   040000 100540                    MLR     fill='040'O
         9 001407   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 001410   000045 000005 7                  ADSC9   DEFER_TIME               cn=0,n=5
         9 001411   000000 621006                    EAX1    0,QL
         9 001412   000000 636012                    EAQ     0,X2
         9 001413   000022 772000                    QRL     18
         9 001414   000005 116007                    CMPQ    5,DL
         9 001415   001437 603000 9                  TRC     s:13976
         9 001416   200046 742100                    STX2    @REASON+7,,AUTO
         9 001417   777772 622012                    EAX2    -6,X2
         9 001420   777777 662003                    ERX2    -1,DU
         9 001421   200046 235100                    LDA     @REASON+7,,AUTO
         9 001422   000022 771000                    ARL     18
         9 001423   040045 100400                    MLR     fill='040'O
         9 001424   000044 000001 10                 ADSC9   36                       cn=0,n=1
         9 001425   000045 000012 7                  ADSC9   DEFER_TIME,A             cn=0,n=*X2
         9 001426   200046 236100                    LDQ     @REASON+7,,AUTO
         9 001427   000022 772000                    QRL     18
         9 001430   000004 116007                    CMPQ    4,DL
         9 001431   001437 603000 9                  TRC     s:13976
         9 001432   777773 622006                    EAX2    -5,QL
         9 001433   777777 662003                    ERX2    -1,DU
         9 001434   040046 100540                    MLR     fill='040'O
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:80   
         9 001435   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
         9 001436   000045 200012 7                  ADSC9   DEFER_TIME,Q             cn=1,n=*X2

      483    13973    7                     T$->P$B.SUBLK$(0)->P$S.TEXT,
      484    13974    7                     ':',
      485    13975    7                     T$->P$B.SUBLK$(1)->P$S.TEXT);
      486    13976    7                   VAR_LEN = T$->P$B.SUBLK$(0)->P$S.COUNT + 1 +

  13976  9 001437   100003 473500                    LDP3    3,,PR1
         9 001440   100004 474500                    LDP4    4,,PR1
         9 001441   400004 236100                    LDQ     4,,PR4
         9 001442   000033 772000                    QRL     27
         9 001443   200046 756100                    STQ     @REASON+7,,AUTO
         9 001444   300004 236100                    LDQ     4,,PR3
         9 001445   000033 772000                    QRL     27
         9 001446   200046 036100                    ADLQ    @REASON+7,,AUTO
         9 001447   000001 036007                    ADLQ    1,DL
         9 001450   000100 756000 7                  STQ     VAR_LEN

      487    13977    7                     T$->P$B.SUBLK$(1)->P$S.COUNT;
      488    13978    7                   DEFER_TSTAMP.TIME_ = VECTOR(ADDR(DEFER_TIME)->VAR$CHAR);

  13978  9 001451   000100 235000 7                  LDA     VAR_LEN
         9 001452   000020 735000                    ALS     16
         9 001453   000140 135007                    SBLA    96,DL
         9 001454   000045 236000 10                 LDQ     37
         9 001455   000020 757000 7                  STAQ    DEFER_TSTAMP+4

      489    13979    7                 END;

  13979  9 001456   001606 710000 9                  TRA     s:13993

      490    13980    6               ELSE
      491    13981    7                 DO;

      492    13982    7                   CALL CONCAT(DEFER_DATE,

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:81   
  13982  9 001457   100003 473500                    LDP3    3,,PR1
         9 001460   300004 236100                    LDQ     4,,PR3
         9 001461   000033 772000                    QRL     27
         9 001462   100004 474500                    LDP4    4,,PR1
         9 001463   000000 622006                    EAX2    0,QL
         9 001464   400004 236100                    LDQ     4,,PR4
         9 001465   000033 772000                    QRL     27
         9 001466   100005 475500                    LDP5    5,,PR1
         9 001467   000000 623006                    EAX3    0,QL
         9 001470   500004 236100                    LDQ     4,,PR5
         9 001471   000033 772000                    QRL     27
         9 001472   040000 100540                    MLR     fill='040'O
         9 001473   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 001474   000043 000010 7                  ADSC9   DEFER_DATE               cn=0,n=8
         9 001475   000000 621006                    EAX1    0,QL
         9 001476   000000 636012                    EAQ     0,X2
         9 001477   000022 772000                    QRL     18
         9 001500   000010 116007                    CMPQ    8,DL
         9 001501   001560 603000 9                  TRC     s:13988
         9 001502   200046 742100                    STX2    @REASON+7,,AUTO
         9 001503   777767 622012                    EAX2    -9,X2
         9 001504   777777 662003                    ERX2    -1,DU
         9 001505   200046 235100                    LDA     @REASON+7,,AUTO
         9 001506   000022 771000                    ARL     18
         9 001507   040045 100400                    MLR     fill='040'O
         9 001510   000046 000001 10                 ADSC9   38                       cn=0,n=1
         9 001511   000043 000012 7                  ADSC9   DEFER_DATE,A             cn=0,n=*X2
         9 001512   200046 236100                    LDQ     @REASON+7,,AUTO
         9 001513   000022 772000                    QRL     18
         9 001514   000007 116007                    CMPQ    7,DL
         9 001515   001560 603000 9                  TRC     s:13988
         9 001516   777770 622006                    EAX2    -8,QL
         9 001517   777777 662003                    ERX2    -1,DU
         9 001520   040046 100540                    MLR     fill='040'O
         9 001521   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         9 001522   000043 200012 7                  ADSC9   DEFER_DATE,Q             cn=1,n=*X2
         9 001523   000000 635013                    EAA     0,X3
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:82   
         9 001524   000022 771000                    ARL     18
         9 001525   200047 755100                    STA     @REASON+8,,AUTO
         9 001526   200047 036100                    ADLQ    @REASON+8,,AUTO
         9 001527   000007 116007                    CMPQ    7,DL
         9 001530   001560 603000 9                  TRC     s:13988
         9 001531   000000 635013                    EAA     0,X3
         9 001532   000022 771000                    ARL     18
         9 001533   200050 755100                    STA     @REASON+9,,AUTO
         9 001534   200051 756100                    STQ     @REASON+10,,AUTO
         9 001535   200046 236100                    LDQ     @REASON+7,,AUTO
         9 001536   000022 772000                    QRL     18
         9 001537   200050 036100                    ADLQ    @REASON+9,,AUTO
         9 001540   200051 723100                    LXL3    @REASON+10,,AUTO
         9 001541   777770 623013                    EAX3    -8,X3
         9 001542   777777 663003                    ERX3    -1,DU
         9 001543   040046 100400                    MLR     fill='040'O
         9 001544   000046 000001 10                 ADSC9   38                       cn=0,n=1
         9 001545   000043 200013 7                  ADSC9   DEFER_DATE,Q             cn=1,n=*X3
         9 001546   200052 756100                    STQ     @REASON+11,,AUTO
         9 001547   200051 236100                    LDQ     @REASON+10,,AUTO
         9 001550   000006 116007                    CMPQ    6,DL
         9 001551   001560 603000 9                  TRC     s:13988
         9 001552   777771 624006                    EAX4    -7,QL
         9 001553   777777 664003                    ERX4    -1,DU
         9 001554   200052 235100                    LDA     @REASON+11,,AUTO
         9 001555   040045 100540                    MLR     fill='040'O
         9 001556   500004 200011                    ADSC9   4,,PR5                   cn=1,n=*X1
         9 001557   000043 400014 7                  ADSC9   DEFER_DATE,A             cn=2,n=*X4

      493    13983    7                     T$->P$B.SUBLK$(0)->P$S.TEXT,
      494    13984    7                     '/',
      495    13985    7                     T$->P$B.SUBLK$(1)->P$S.TEXT,
      496    13986    7                     '/',
      497    13987    7                     T$->P$B.SUBLK$(2)->P$S.TEXT);
      498    13988    7                   VAR_LEN = T$->P$B.SUBLK$(0)->P$S.COUNT +

  13988  9 001560   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:83   
         9 001561   100004 474500                    LDP4    4,,PR1
         9 001562   400004 236100                    LDQ     4,,PR4
         9 001563   000033 772000                    QRL     27
         9 001564   200046 756100                    STQ     @REASON+7,,AUTO
         9 001565   300004 236100                    LDQ     4,,PR3
         9 001566   000033 772000                    QRL     27
         9 001567   200046 036100                    ADLQ    @REASON+7,,AUTO
         9 001570   100005 473500                    LDP3    5,,PR1
         9 001571   200047 756100                    STQ     @REASON+8,,AUTO
         9 001572   300004 236100                    LDQ     4,,PR3
         9 001573   000033 772000                    QRL     27
         9 001574   200050 756100                    STQ     @REASON+9,,AUTO
         9 001575   200047 236100                    LDQ     @REASON+8,,AUTO
         9 001576   200050 036100                    ADLQ    @REASON+9,,AUTO
         9 001577   000002 036007                    ADLQ    2,DL
         9 001600   000100 756000 7                  STQ     VAR_LEN

      499    13989    7                     T$->P$B.SUBLK$(1)->P$S.COUNT +
      500    13990    7                     T$->P$B.SUBLK$(2)->P$S.COUNT + 2;
      501    13991    7                   DEFER_TSTAMP.DATE_ = VECTOR(ADDR(DEFER_DATE)->VAR$CHAR);

  13991  9 001601   000100 235000 7                  LDA     VAR_LEN
         9 001602   000020 735000                    ALS     16
         9 001603   000140 135007                    SBLA    96,DL
         9 001604   000041 236000 10                 LDQ     33
         9 001605   000016 757000 7                  STAQ    DEFER_TSTAMP+2

      502    13992    7                 END;

      503    13993    6             END;

  13993  9 001606   200032 054100                    AOS     J,,AUTO
         9 001607   200006 470500                    LDP0    P$,,AUTO
         9 001610   000001 236100                    LDQ     1,,PR0
         9 001611   000022 772000                    QRL     18
         9 001612   200032 116100                    CMPQ    J,,AUTO
         9 001613   001367 605400 9                  TPNZ    s:13968
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:84   

      504    13994    5             CALL M$TIME(DEFER_TSTAMP) ALTRET(E_TIME);

  13994  9 001614   000014 630400 7                  EPPR0   DEFER_TSTAMP
         9 001615   420004 713400                    CLIMB   alt,+8196
         9 001616   402000 401760                    pmme    nvectors=5
         9 001617   001625 702000 9                  TSX2    E_TIME

      505    13995    5             JOB_TBL.FLG.RA = %YES#;

  13995  9 001620   002000 236007                    LDQ     1024,DL
         9 001621   000014 256000 xsym               ORSQ    JOB_TBL+12

      506    13996    5             JOB_TBL.RATIM = DEFER_UTS;

  13996  9 001622   000042 235000 7                  LDA     DEFER_UTS
         9 001623   000027 755000 xsym               STA     JOB_TBL+23

      507    13997    6             DO NEVER;

  13997  9 001624   002172 710000 9                  TRA     s:14073

      508    13998    6   E_TIME:
      509    13999    6               CALL CXP$POSTERR (ADDR(ERR_BLK),511,B$TCB.ALT$ -> B$ALT.ERR);

  13999  9 001625   000000 470400 xsym  E_TIME       LDP0    B$TCB$
         9 001626   000000 471500                    LDP1    0,,PR0
         9 001627   000010 236000 10                 LDQ     8
         9 001630   200046 756100                    STQ     @REASON+7,,AUTO
         9 001631   100102 633500                    EPPR3   66,,PR1
         9 001632   200051 453500                    STP3    @REASON+10,,AUTO
         9 001633   000012 236000 10                 LDQ     10
         9 001634   200050 756100                    STQ     @REASON+9,,AUTO
         9 001635   200046 631500                    EPPR1   @REASON+7,,AUTO
         9 001636   200047 451500                    STP1    @REASON+8,,AUTO
         9 001637   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 001640   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:85   
         9 001641   000000 701000 xent               TSX1    CXP$POSTERR
         9 001642   000000 011000                    NOP     0

      510    14000    6             END;

  14000  9 001643   002172 710000 9                  TRA     s:14073

      511    14001    5           CASE(JOB_FOLLOW);

      512    14002    5             IF P$->P$B.NSUBLKS>8

  14002  9 001644   100001 222100                    LDX2    1,,PR1
         9 001645   000011 102003                    CMPX2   9,DU
         9 001646   001662 602000 9                  TNC     s:14007

      513    14003    5             THEN
      514    14004    5               CALL CXP$POSTERR(ADDR(ERR_BLK),511,E_MANYFOLLOW);

  14004  9 001647   000010 236000 10                 LDQ     8
         9 001650   200046 756100                    STQ     @REASON+7,,AUTO
         9 001651   000050 237000 10                 LDAQ    40
         9 001652   200050 757100                    STAQ    @REASON+9,,AUTO
         9 001653   200046 633500                    EPPR3   @REASON+7,,AUTO
         9 001654   200047 453500                    STP3    @REASON+8,,AUTO
         9 001655   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 001656   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001657   000000 701000 xent               TSX1    CXP$POSTERR
         9 001660   000000 011000                    NOP     0
         9 001661   002172 710000 9                  TRA     s:14073

      515    14005    5             ELSE
      516    14006    6               DO;

      517    14007    6                 JOB_TBL.FLG.O3 = %YES#;

  14007  9 001662   100000 236007                    LDQ     32768,DL
         9 001663   000014 256000 xsym               ORSQ    JOB_TBL+12
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:86   

      518    14008    6                 IF P$->P$B.NSUBLKS = 0

  14008  9 001664   100001 221100                    LDX1    1,,PR1
         9 001665   001675 601000 9                  TNZ     FOLLOW_STEPCC_OKERRORABORT

      519    14009    6                 THEN
      520    14010    6   FOLLOW_ACCOUNT:
      521    14011    7                   DO;

  14011  9 001666                       FOLLOW_ACCO* null
      522    14012    7                     JOB_TBL.NJD = 1;

  14012  9 001666   001000 236003                    LDQ     512,DU
         9 001667   000014 552040 xsym               STBQ    JOB_TBL+12,'40'O

      523    14013    7                     JOB_TBL.JDID.FOLLOW_TYPE(0) = %JM_FOLLOW_ACCOUNT;

  14013  9 001670   000030 236000 xsym               LDQ     JOB_TBL+24
         9 001671   000047 376000 10                 ANQ     39
         9 001672   040000 276003                    ORQ     16384,DU
         9 001673   000030 756000 xsym               STQ     JOB_TBL+24

      524    14014    7                   END FOLLOW_ACCOUNT;

  14014  9 001674   002172 710000 9                  TRA     s:14073

      525    14015    6                 ELSE
      526    14016    6   FOLLOW_STEPCC_OKERRORABORT:
      527    14017    7                   DO;

  14017  9 001675                       FOLLOW_STEP* null
      528    14018    7                     JOB_TBL.NJD = P$->P$B.NSUBLKS;

  14018  9 001675   100001 236100                    LDQ     1,,PR1
         9 001676   000011 736000                    QLS     9
         9 001677   000014 552040 xsym               STBQ    JOB_TBL+12,'40'O
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:87   

      529    14019    8                     DO J = 0 TO JOB_TBL.NJD-1;

  14019  9 001700   200032 450100                    STZ     J,,AUTO
         9 001701   002166 710000 9                  TRA     s:14069+1

      530    14020    8                       T$ = P$->P$B.SUBLK$(J);

  14020  9 001702   200006 470500                    LDP0    P$,,AUTO
         9 001703   200032 720100                    LXL0    J,,AUTO
         9 001704   000003 236110                    LDQ     3,X0,PR0
         9 001705   200007 756100                    STQ     T$,,AUTO

      531    14021    8                       JOB_TBL.JDID.FOLLOW_TYPE(J) = %JM_FOLLOW_STEPCC;

  14021  9 001706   000047 236000 10                 LDQ     39
         9 001707   000030 356010 xsym               ANSQ    JOB_TBL+24,X0

      532    14022    8                       JOB_TBL.JDID.RELATION(J) = JM_EQ;

  14022  9 001710   000030 236010 xsym               LDQ     JOB_TBL+24,X0
         9 001711   000052 376000 10                 ANQ     42
         9 001712   200000 276003                    ORQ     65536,DU
         9 001713   000030 756010 xsym               STQ     JOB_TBL+24,X0

      533    14023    8                       JOB_TBL.JDSTEPCC(J) = 0;

  14023  9 001714   200032 235100                    LDA     J,,AUTO
         9 001715   000005 101400                    MRL     fill='000'O
         9 001716   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         9 001717   000040 000001 xsym               ADSC9   JOB_TBL+32,A             cn=0,n=1

      534    14024    9                       DO K = 0 TO T$->P$B.NSUBLKS-1;

  14024  9 001720   200033 450100                    STZ     K,,AUTO
         9 001721   002160 710000 9                  TRA     s:14068+1

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:88   
      535    14025   10                         DO CASE(T$->P$B.SUBLK$(K)->P$B.CODE);

  14025  9 001722   200007 470500                    LDP0    T$,,AUTO
         9 001723   200033 720100                    LXL0    K,,AUTO
         9 001724   000003 471510                    LDP1    3,X0,PR0
         9 001725   100000 721100                    LXL1    0,,PR1
         9 001726   000047 101003                    CMPX1   39,DU
         9 001727   001731 602011 9                  TNC     s:14025+7,X1
         9 001730   002157 710000 9                  TRA     s:14068
         9 001731   002157 710000 9                  TRA     s:14068
         9 001732   002124 710000 9                  TRA     s:14060
         9 001733   002157 710000 9                  TRA     s:14068
         9 001734   002157 710000 9                  TRA     s:14068
         9 001735   002157 710000 9                  TRA     s:14068
         9 001736   002157 710000 9                  TRA     s:14068
         9 001737   002157 710000 9                  TRA     s:14068
         9 001740   002157 710000 9                  TRA     s:14068
         9 001741   002157 710000 9                  TRA     s:14068
         9 001742   002157 710000 9                  TRA     s:14068
         9 001743   002157 710000 9                  TRA     s:14068
         9 001744   002157 710000 9                  TRA     s:14068
         9 001745   002157 710000 9                  TRA     s:14068
         9 001746   002116 710000 9                  TRA     s:14058
         9 001747   002157 710000 9                  TRA     s:14068
         9 001750   002157 710000 9                  TRA     s:14068
         9 001751   002157 710000 9                  TRA     s:14068
         9 001752   002157 710000 9                  TRA     s:14068
         9 001753   002157 710000 9                  TRA     s:14068
         9 001754   002157 710000 9                  TRA     s:14068
         9 001755   002157 710000 9                  TRA     s:14068
         9 001756   002157 710000 9                  TRA     s:14068
         9 001757   002000 710000 9                  TRA     s:14027
         9 001760   002157 710000 9                  TRA     s:14068
         9 001761   002157 710000 9                  TRA     s:14068
         9 001762   002157 710000 9                  TRA     s:14068
         9 001763   002157 710000 9                  TRA     s:14068
         9 001764   002110 710000 9                  TRA     s:14056
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:89   
         9 001765   002157 710000 9                  TRA     s:14068
         9 001766   002157 710000 9                  TRA     s:14068
         9 001767   002157 710000 9                  TRA     s:14068
         9 001770   002157 710000 9                  TRA     s:14068
         9 001771   002157 710000 9                  TRA     s:14068
         9 001772   002157 710000 9                  TRA     s:14068
         9 001773   002157 710000 9                  TRA     s:14068
         9 001774   002157 710000 9                  TRA     s:14068
         9 001775   002157 710000 9                  TRA     s:14068
         9 001776   002157 710000 9                  TRA     s:14068
         9 001777   002132 710000 9                  TRA     s:14062

      536    14026   10                           CASE(JOB_NAME);

      537    14027   10                             T2$ = T$->P$B.SUBLK$(K);

  14027  9 002000   000003 236110                    LDQ     3,X0,PR0
         9 002001   200010 756100                    STQ     T2$,,AUTO

      538    14028   10                             IF T2$->P$B.SUBLK$(0)->P$B.CODE = JOB_SYSID

  14028  9 002002   200010 473500                    LDP3    T2$,,AUTO
         9 002003   300003 474500                    LDP4    3,,PR3
         9 002004   400000 722100                    LXL2    0,,PR4
         9 002005   000047 102003                    CMPX2   39,DU
         9 002006   002023 601000 9                  TNZ     s:14036

      539    14029   10                             THEN
      540    14030   11                               DO;

      541    14031   11                                 CALL CHARBIN(TEMP,T2$->P$B.SUBLK$(0)->P$S.TEXT);

  14031  9 002007   400004 236100                    LDQ     4,,PR4
         9 002010   000033 772000                    QRL     27
         9 002011   000000 623006                    EAX3    0,QL
         9 002012   000100 305540                    DTB
         9 002013   400004 230013                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X3
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:90   
         9 002014   200046 000010                    NDSC9   @REASON+7,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         9 002015   200047 235100                    LDA     @REASON+8,,AUTO
         9 002016   200034 755100                    STA     TEMP,,AUTO

      542    14032   11                                 JOB_TBL.JDID.SYSID(J) = TEMP;

  14032  9 002017   000000 621005                    EAX1    0,AL
         9 002020   200032 722100                    LXL2    J,,AUTO
         9 002021   000030 441012 xsym               SXL1    JOB_TBL+24,X2

      543    14033   11                               END;

  14033  9 002022   002157 710000 9                  TRA     s:14068

      544    14034   10                             ELSE
      545    14035   11                               DO; /* NAME not SYSID */

      546    14036   11                                 FOL_NAME = T2$->P$B.SUBLK$(0)->P$S.TEXT;

  14036  9 002023   400004 236100                    LDQ     4,,PR4
         9 002024   000033 772000                    QRL     27
         9 002025   000000 623006                    EAX3    0,QL
         9 002026   040000 100540                    MLR     fill='040'O
         9 002027   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         9 002030   000066 000037 7                  ADSC9   FOL_NAME                 cn=0,n=31

      547    14037   11                                 IF T2$->P$B.NSUBLKS > 1

  14037  9 002031   300001 221100                    LDX1    1,,PR3
         9 002032   000002 101003                    CMPX1   2,DU
         9 002033   002044 602000 9                  TNC     s:14041

      548    14038   11                                 THEN /* Acct specified */
      549    14039   11                                   FOL_ACCT = T2$->P$B.SUBLK$(1)->P$S.TEXT;

  14039  9 002034   300004 471500                    LDP1    4,,PR3
         9 002035   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:91   
         9 002036   000033 772000                    QRL     27
         9 002037   000000 622006                    EAX2    0,QL
         9 002040   040000 100540                    MLR     fill='040'O
         9 002041   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         9 002042   000076 000010 7                  ADSC9   FOL_ACCT                 cn=0,n=8
         9 002043   002047 710000 9                  TRA     s:14042

      550    14040   11                                 ELSE /* Use default acct */
      551    14041   11                                   FOL_ACCT = JOB_TBL.ACCT;

  14041  9 002044   040000 100400                    MLR     fill='040'O
         9 002045   000016 000010 xsym               ADSC9   JOB_TBL+14               cn=0,n=8
         9 002046   000076 000010 7                  ADSC9   FOL_ACCT                 cn=0,n=8

      552    14042   11                                 XSJ_PARAM.BUF_ = VECTOR(JOB_TBL.JDID.SYSID(J));

  14042  9 002047   377640 235007                    LDA     130976,DL
         9 002050   200032 236100                    LDQ     J,,AUTO
         9 002051   000022 736000                    QLS     18
         9 002052   000053 036000 10                 ADLQ    43
         9 002053   000056 757000 7                  STAQ    XSJ_PARAM

      553    14043   11                                 CALL XSJ$READ(XSJ_PARAM) ALTRET(XSJ_ALT1);

  14043  9 002054   000054 630400 10                 EPPR0   44
         9 002055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002056   000000 701000 xent               TSX1    XSJ$READ
         9 002057   002061 702000 9                  TSX2    XSJ_ALT1

      554    14044   12                                 DO NEVER;

  14044  9 002060   002157 710000 9                  TRA     s:14068

      555    14045   12   XSJ_ALT1:
      556    14046   12                                   TEMP = T2$ -> P$S.CPOS;

  14046  9 002061   200010 470500       XSJ_ALT1     LDP0    T2$,,AUTO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:92   
         9 002062   000002 235100                    LDA     2,,PR0
         9 002063   200034 755100                    STA     TEMP,,AUTO

      557    14047   12                                   IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$NOKEY

  14047  9 002064   000000 471400 xsym               LDP1    B$TCB$
         9 002065   100000 473500                    LDP3    0,,PR1
         9 002066   300102 236100                    LDQ     66,,PR3
         9 002067   377770 376007                    ANQ     131064,DL
         9 002070   001020 116007                    CMPQ    528,DL
         9 002071   002221 601000 9                  TNZ     XSJ_ALT2

      558    14048   12                                   THEN
      559    14049   12                                     CALL CXP$POSTERR (ADDR(ERR_BLK),

  14049  9 002072   000010 236000 10                 LDQ     8
         9 002073   200046 756100                    STQ     @REASON+7,,AUTO
         9 002074   000055 236000 10                 LDQ     45
         9 002075   200051 756100                    STQ     @REASON+10,,AUTO
         9 002076   200034 633500                    EPPR3   TEMP,,AUTO
         9 002077   200050 453500                    STP3    @REASON+9,,AUTO
         9 002100   200046 634500                    EPPR4   @REASON+7,,AUTO
         9 002101   200047 454500                    STP4    @REASON+8,,AUTO
         9 002102   200047 630500                    EPPR0   @REASON+8,,AUTO
         9 002103   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002104   000000 701000 xent               TSX1    CXP$POSTERR
         9 002105   000000 011000                    NOP     0
         9 002106   002107 710000 9                  TRA     s:14054

      560    14050   12                                       TEMP,E_NONAME);
      561    14051   12                                   ELSE
      562    14052   12                                     GOTO  XSJ_ALT2;
      563    14053   12                                 END;

      564    14054   11                               END;

  14054  9 002107   002157 710000 9                  TRA     s:14068
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:93   

      565    14055   10                           CASE(JOB_OK);

      566    14056   10                             JOB_TBL.JDID.FOLLOW_TYPE(J) = %JM_FOLLOW_OK;

  14056  9 002110   200032 722100                    LXL2    J,,AUTO
         9 002111   000030 236012 xsym               LDQ     JOB_TBL+24,X2
         9 002112   000047 376000 10                 ANQ     39
         9 002113   010000 276003                    ORQ     4096,DU
         9 002114   000030 756012 xsym               STQ     JOB_TBL+24,X2
         9 002115   002157 710000 9                  TRA     s:14068

      567    14057   10                           CASE(JOB_ERROR);

      568    14058   10                             JOB_TBL.JDID.FOLLOW_TYPE(J) = %JM_FOLLOW_ERROR;

  14058  9 002116   200032 722100                    LXL2    J,,AUTO
         9 002117   000030 236012 xsym               LDQ     JOB_TBL+24,X2
         9 002120   000047 376000 10                 ANQ     39
         9 002121   020000 276003                    ORQ     8192,DU
         9 002122   000030 756012 xsym               STQ     JOB_TBL+24,X2
         9 002123   002157 710000 9                  TRA     s:14068

      569    14059   10                           CASE(JOB_ABORT);

      570    14060   10                             JOB_TBL.JDID.FOLLOW_TYPE(J) = %JM_FOLLOW_ABORT;

  14060  9 002124   200032 722100                    LXL2    J,,AUTO
         9 002125   000030 236012 xsym               LDQ     JOB_TBL+24,X2
         9 002126   000047 376000 10                 ANQ     39
         9 002127   030000 276003                    ORQ     12288,DU
         9 002130   000030 756012 xsym               STQ     JOB_TBL+24,X2
         9 002131   002157 710000 9                  TRA     s:14068

      571    14061   10                           CASE(JOB_STREL);

      572    14062   10                             JOB_TBL.JDID.RELATION(J) =
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:94   

  14062  9 002132   100003 473500                    LDP3    3,,PR1
         9 002133   200032 722100                    LXL2    J,,AUTO
         9 002134   300000 236100                    LDQ     0,,PR3
         9 002135   000041 736000                    QLS     33
         9 002136   000030 676012 xsym               ERQ     JOB_TBL+24,X2
         9 002137   700000 376003                    ANQ     -32768,DU
         9 002140   000030 656012 xsym               ERSQ    JOB_TBL+24,X2

      573    14063   10                               T$->P$B.SUBLK$(K)->P$B.SUBLK$(0)->P$B.CODE;
      574    14064   10                             CALL CHARBIN(TEMP,

  14064  9 002141   000003 471510                    LDP1    3,X0,PR0
         9 002142   100004 473500                    LDP3    4,,PR1
         9 002143   300004 236100                    LDQ     4,,PR3
         9 002144   000033 772000                    QRL     27
         9 002145   000000 621006                    EAX1    0,QL
         9 002146   000100 305540                    DTB
         9 002147   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         9 002150   200046 000010                    NDSC9   @REASON+7,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         9 002151   200047 235100                    LDA     @REASON+8,,AUTO
         9 002152   200034 755100                    STA     TEMP,,AUTO

      575    14065   10                               T$->P$B.SUBLK$(K)->P$B.SUBLK$(1)->P$S.TEXT);
      576    14066   10                             JOB_TBL.JDSTEPCC(J) = TEMP;

  14066  9 002153   200032 236100                    LDQ     J,,AUTO
         9 002154   000006 101500                    MRL     fill='000'O
         9 002155   200034 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4
         9 002156   000040 000001 xsym               ADSC9   JOB_TBL+32,Q             cn=0,n=1

      577    14067   10                         END;

      578    14068    9                       END;

  14068  9 002157   200033 054100                    AOS     K,,AUTO
         9 002160   200007 470500                    LDP0    T$,,AUTO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:95   
         9 002161   000001 236100                    LDQ     1,,PR0
         9 002162   000022 772000                    QRL     18
         9 002163   200033 116100                    CMPQ    K,,AUTO
         9 002164   001722 605400 9                  TPNZ    s:14025

      579    14069    8                     END;

  14069  9 002165   200032 054100                    AOS     J,,AUTO
         9 002166   000014 236000 xsym               LDQ     JOB_TBL+12
         9 002167   000033 772000                    QRL     27
         9 002170   200032 116100                    CMPQ    J,,AUTO
         9 002171   001702 605400 9                  TPNZ    s:14020

      580    14070    7                   END FOLLOW_STEPCC_OKERRORABORT;

      581    14071    6               END;

      582    14072    5         END;

      583    14073    4       END;

  14073  9 002172   200031 054100                    AOS     I,,AUTO
         9 002173   000003 470400 xsym               LDP0    PCB+3
         9 002174   000001 236100                    LDQ     1,,PR0
         9 002175   000022 772000                    QRL     18
         9 002176   200031 116100                    CMPQ    I,,AUTO
         9 002177   001135 605400 9                  TPNZ    s:13923

      584    14074        /*
      585    14075        		***** If a JOBNAME was specified, then stash it ...
      586    14076        */
      587    14077    3       IF JOB_TBL.JNAME ~= ' '

  14077  9 002200   040000 106400                    CMPC    fill='040'O
         9 002201   000057 200037 xsym               ADSC9   JOB_TBL+47               cn=1,n=31
         9 002202   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 002203   002230 600000 9                  TZE     s:14090
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:96   

      588    14078    3       THEN
      589    14079    4         DO;   /* Store JOBNAME in :JOBSTATS */

      590    14080    4           FOL_NAME = JOB_TBL.JNAME;

  14080  9 002204   040000 100400                    MLR     fill='040'O
         9 002205   000057 200037 xsym               ADSC9   JOB_TBL+47               cn=1,n=31
         9 002206   000066 000037 7                  ADSC9   FOL_NAME                 cn=0,n=31

      591    14081    4           FOL_ACCT = JOB_TBL.ACCT;

  14081  9 002207   040000 100400                    MLR     fill='040'O
         9 002210   000016 000010 xsym               ADSC9   JOB_TBL+14               cn=0,n=8
         9 002211   000076 000010 7                  ADSC9   FOL_ACCT                 cn=0,n=8

      592    14082    4           XSJ_PARAM.BUF_ = VECTOR(JOB_TBL.SYSID);

  14082  9 002212   000056 237000 10                 LDAQ    46
         9 002213   000056 757000 7                  STAQ    XSJ_PARAM

      593    14083    4           CALL XSJ$WRITE(XSJ_PARAM) ALTRET(XSJ_ALT2);

  14083  9 002214   000054 630400 10                 EPPR0   44
         9 002215   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002216   000000 701000 xent               TSX1    XSJ$WRITE
         9 002217   002221 702000 9                  TSX2    XSJ_ALT2

      594    14084    5           DO NEVER;

  14084  9 002220   002230 710000 9                  TRA     s:14090

      595    14085    5   XSJ_ALT2:
      596    14086    5             CALL JPE$REASON (%REJ_IO#);

  14086  9 002221   000025 630400 10    XSJ_ALT2     EPPR0   21
         9 002222   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:97   
         9 002223   000000 701000 xent               TSX1    JPE$REASON
         9 002224   000000 011000                    NOP     0

      597    14087    5             CALL JPT$REPORT;

  14087  9 002225   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002226   000000 701000 xent               TSX1    JPT$REPORT
         9 002227   000000 011000                    NOP     0

      598    14088    5           END;

      599    14089    4         END;

      600    14090    3       RETURN;

  14090  9 002230   200030 221300                    LDX1  ! JOB_BLK+6,,AUTO
         9 002231   000001 702211                    TSX2  ! 1,X1

      601    14091    3   END PROCESS_OPTS;
      602    14092    2   END PROCESS_JOB;
      603    14093        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:98   
      604    14094    1   SECLOG: PROC(REASON);

  14094  9 002232   200032 741300       SECLOG       STX1  ! J,,AUTO

      605    14095
      606    14096        /*I* NAME:        SECLOG
      607    14097
      608    14098             PURPOSE:     To fill in and write a record to the security log
      609    14099                          for system accesses and/or possibly update the
      610    14100                          :USERS record for security purposes.
      611    14101
      612    14102             CALL:        CALL SECLOG(reason);
      613    14103
      614    14104             INPUT:       A reason as defined in the ES_SUBS_E include file.
      615    14105
      616    14106             OUTPUT:      In all cases, a record will be written to the
      617    14107                          security log via M$WRSYSLOG. Some cases will also
      618    14108                          require security updates to the :USERS record.
      619    14109
      620    14110             DESCRIPTION: SECLOG will only be called if the value of
      621    14111                          ES_LOGSYSACC (defined via CONTROL) indicates that
      622    14112                          security logging is desired. Dependent upon the
      623    14113                          specific type of logging desired, it may be called
      624    14114                          when (1) a garbage logon is given, (2) a logon
      625    14115                          is given which does not exist in :USERS, (3) a logon
      626    14116                          is given which does exist in :USERS but has failed
      627    14117                          the password check, or (4) logging of all system
      628    14118                          accesses is desired.
      629    14119
      630    14120                          It will fill in the security log structure from
      631    14121                          information found in JOB_TBL, the FM$JOBORIG
      632    14122                          structure, the CODE04, and/or the parse nodes and
      633    14123                          call M$WRSYSLOG. If the reason passed to SECLOG
      634    14124                          indicates that the logon given was good except for
      635    14125                          the password, the bad password is also placed in
      636    14126                          the security record and the count of bad logon
      637    14127                          attempts since the last system exit is incremented
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:99   
      638    14128                          in the :USERS record. The batch PRIV and PPRIV
      639    14129                          information is copied from the :USERS record into
      640    14130                          the security record in this case. If logging a
      641    14131                          good logon, the logon time and bad logon counts
      642    14132                          are updated in the :USERS record.
      643    14133        */
      644    14134    2     DCL REASON UBIN;
      645    14135    2     DCL P$ PTR;
      646    14136    2     DCL LOGON_LEN UBIN;
      647    14137        %INCLUDE ES_TABLES_M;
      648    14531        %ES$SECLOG(NAME=ES$SECLOG_INIT,STCLASS=CONSTANT);
      649    14808        %ES$SECLOG(NAME=ES$SECLOG,STCLASS=STATIC);
      650    15085        %FPT_WRSYSLOG(FPTN=WR_SECLOG,
      651    15086                  ENTRY=ES$SECLOG,
      652    15087                  FILENUM=EL_SEC,
      653    15088                  SIZE="SIZEW(ES$SECLOG)",
      654    15089                  TYPE=EL_SYS_ACCESS);
      655    15104        %INCLUDE AS_SUBS_C;
      656    16518
      657    16519    2       ES$SECLOG=ES$SECLOG_INIT;

  16519  9 002233   000000 100400                    MLR     fill='000'O
         9 002234   000061 000304 8                  ADSC9   ES$SECLOG_INIT           cn=0,n=196
         9 002235   000101 000304 7                  ADSC9   ES$SECLOG                cn=0,n=196

      658    16520    2       ES$SECLOG.REASON=REASON;

  16520  9 002236   200033 470500                    LDP0    @REASON,,AUTO
         9 002237   000000 236100                    LDQ     0,,PR0
         9 002240   000033 736000                    QLS     27
         9 002241   000101 552040 7                  STBQ    ES$SECLOG,'40'O

      659    16521    2       ES$SECLOG.MODE=%M_BATCH#;

  16521  9 002242   000102 236000 7                  LDQ     ES$SECLOG+1
         9 002243   000060 376000 10                 ANQ     48
         9 002244   040000 276003                    ORQ     16384,DU
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:100  
         9 002245   000102 756000 7                  STQ     ES$SECLOG+1

      660    16522        /* Log info about the very first user who caused this job to be
      661    16523           spawned.                                                     */
      662    16524    2       ES$SECLOG.ORIG_MODE=INSYM$INFO.ORIGINATOR_MODE;

  16524  9 002246   000000 471400 xsym               LDP1    INSYM_INFO$
         9 002247   100006 236100                    LDQ     6,,PR1
         9 002250   000740 376003                    ANQ     480,DU
         9 002251   000016 772000                    QRL     14
         9 002252   000143 552010 7                  STBQ    ES$SECLOG+34,'10'O

      663    16525    3       DO CASE (INSYM$INFO.ORIGINATOR_MODE);

  16525  9 002253   100006 236100                    LDQ     6,,PR1
         9 002254   000027 772000                    QRL     23
         9 002255   000017 376007                    ANQ     15,DL
         9 002256   000004 116007                    CMPQ    4,DL
         9 002257   002261 602006 9                  TNC     s:16525+6,QL
         9 002260   002312 710000 9                  TRA     s:16540
         9 002261   002265 710000 9                  TRA     s:16528
         9 002262   002265 710000 9                  TRA     s:16528
         9 002263   002273 710000 9                  TRA     s:16531
         9 002264   002276 710000 9                  TRA     s:16533

      664    16526    3         CASE(0,%M_BATCH#);

      665    16527            /* If 0, this guy is the originator, so must be a device. */
      666    16528    3           ES$SECLOG.DEVICE_TNAME = INSYM$INFO.ORIGINATOR_PORT.FROM_CR.TNAME;

  16528  9 002265   040000 100500                    MLR     fill='040'O
         9 002266   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         9 002267   000140 000010 7                  ADSC9   ES$SECLOG+31             cn=0,n=8

      667    16529    3           ES$SECLOG.DEVICE = INSYM$INFO.ORIGINATOR_PORT.FROM_CR.DEVICE;

  16529  9 002270   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:101  
         9 002271   000137 756000 7                  STQ     ES$SECLOG+30
         9 002272   002312 710000 9                  TRA     s:16540

      668    16530    3         CASE(%M_GHOST#);

      669    16531    3           ES$SECLOG.ORIG_SYSID=INSYM$INFO.ORIGINATOR_PORT.FROM_GHOST.SYSID;

  16531  9 002273   100000 220100                    LDX0    0,,PR1
         9 002274   000134 440000 7                  SXL0    ES$SECLOG+27
         9 002275   002312 710000 9                  TRA     s:16540

      670    16532    3         CASE(%M_INT#);

      671    16533    3           ES$SECLOG.TSLINE.FEX = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.FEX;

  16533  9 002276   100000 236100                    LDQ     0,,PR1
         9 002277   000135 552040 7                  STBQ    ES$SECLOG+28,'40'O

      672    16534    3           ES$SECLOG.TSLINE.PORT = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.PORT;

  16534  9 002300   100000 236100                    LDQ     0,,PR1
         9 002301   000011 736000                    QLS     9
         9 002302   000135 552030 7                  STBQ    ES$SECLOG+28,'30'O

      673    16535    3           ES$SECLOG.TSLINE.LEV = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.LEV;

  16535  9 002303   100001 236100                    LDQ     1,,PR1
         9 002304   000033 772000                    QRL     27
         9 002305   000135 552004 7                  STBQ    ES$SECLOG+28,'04'O

      674    16536    3           ES$SECLOG.TSLINE.SUBDEVICE = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.
             16536                    SUBDEVICE;

  16536  9 002306   100001 720100                    LXL0    1,,PR1
         9 002307   000136 740000 7                  STX0    ES$SECLOG+29

      675    16537    3           ES$SECLOG.TSLINE.SUBSUBDEVICE = INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:102  
             16537                    SUBSUBDEVICE;

  16537  9 002310   100002 222100                    LDX2    2,,PR1
         9 002311   000136 442000 7                  SXL2    ES$SECLOG+29

      676    16538    3       END;

      677    16539        /* Log info about immediately preceding user */
      678    16540    3       IF INSYM$INFO.FLAG ~= JOBORIG_DEVICE# THEN DO;

  16540  9 002312   100006 236100                    LDQ     6,,PR1
         9 002313   777000 316003                    CANQ    -512,DU
         9 002314   002331 600000 9                  TZE     s:16548

      679    16541    3           ES$SECLOG.PREV_USER.MODE=INSYM$INFO.FLAG;

  16541  9 002315   000144 552040 7                  STBQ    ES$SECLOG+35,'40'O

      680    16542    3           ES$SECLOG.PREV_USER.SYSID=INSYM$INFO.SYSID;

  16542  9 002316   100005 220100                    LDX0    5,,PR1
         9 002317   000145 740000 7                  STX0    ES$SECLOG+36

      681    16543    3           ES$SECLOG.PREV_USER.ACCT=CODE04.CREATOR.ACCT;

  16543  9 002320   000000 473400 xsym               LDP3    CODE04$
         9 002321   040000 100500                    MLR     fill='040'O
         9 002322   300003 000010                    ADSC9   3,,PR3                   cn=0,n=8
         9 002323   000150 000010 7                  ADSC9   ES$SECLOG+39             cn=0,n=8

      682    16544    3           ES$SECLOG.PREV_USER.UNAME.L=12;

  16544  9 002324   014000 236003                    LDQ     6144,DU
         9 002325   000152 552040 7                  STBQ    ES$SECLOG+41,'40'O

      683    16545    3           ES$SECLOG.PREV_USER.UNAME.C=CODE04.CREATOR.NAME;

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:103  
  16545  9 002326   040000 100500                    MLR     fill='040'O
         9 002327   300005 000014                    ADSC9   5,,PR3                   cn=0,n=12
         9 002330   000152 200037 7                  ADSC9   ES$SECLOG+41             cn=1,n=31

      684    16546    3         END;

      685    16547
      686    16548    3       DO CASE(REASON);

  16548  9 002331   000000 235100                    LDA     0,,PR0
         9 002332   000005 115007                    CMPA    5,DL
         9 002333   002335 602005 9                  TNC     s:16548+4,AL
         9 002334   002547 710000 9                  TRA     s:16581
         9 002335   002547 710000 9                  TRA     s:16581
         9 002336   002342 710000 9                  TRA     s:16550
         9 002337   002526 710000 9                  TRA     s:16573
         9 002340   002517 710000 9                  TRA     s:16570
         9 002341   002357 710000 9                  TRA     s:16555

      687    16549    3         CASE(%ES_LOG_ALL#);

      688    16550    3           ES$SECLOG.GRANTED='1'B;

  16550  9 002342   000400 236003                    LDQ     256,DU
         9 002343   000101 256000 7                  ORSQ    ES$SECLOG

      689    16551    3           ES$SECLOG.ACCN=JOB_TBL.ACCT;

  16551  9 002344   040000 100400                    MLR     fill='040'O
         9 002345   000016 000010 xsym               ADSC9   JOB_TBL+14               cn=0,n=8
         9 002346   000103 000010 7                  ADSC9   ES$SECLOG+2              cn=0,n=8

      690    16552    3           ES$SECLOG.UNAME=JOB_TBL.UNAME;

  16552  9 002347   040000 100400                    MLR     fill='040'O
         9 002350   000020 000014 xsym               ADSC9   JOB_TBL+16               cn=0,n=12
         9 002351   000105 000014 7                  ADSC9   ES$SECLOG+4              cn=0,n=12
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:104  

      691    16553    3           CALL UPD_USERS(%ES_LOG_ALL#) ALTRET(LOG_IT);

  16553  9 002352   000061 236000 10                 LDQ     49
         9 002353   200037 756100                    STQ     LOGON_LEN+2,,AUTO
         9 002354   002555 701000 9                  TSX1    UPD_USERS
         9 002355   002550 702000 9                  TSX2    LOG_IT
         9 002356   002550 710000 9                  TRA     LOG_IT

      692    16554    3         CASE(%ES_JUNK_LOGON#);

      693    16555    3           LOGON_LEN = LENGTHC(ES$SECLOG.LOGON.C);

  16555  9 002357   000037 236007                    LDQ     31,DL
         9 002360   200035 756100                    STQ     LOGON_LEN,,AUTO

      694    16556    3           P$=PCB.OUT$->P$B.SUBLK$(0);

  16556  9 002361   000003 473400 xsym               LDP3    PCB+3
         9 002362   300003 236100                    LDQ     3,,PR3
         9 002363   200034 756100                    STQ     P$,,AUTO

      695    16557    3           CALL CONCAT(ES$SECLOG.LOGON.C,P$->P$B.SUBLK$(0)->P$S.TEXT,',',

  16557  9 002364   200034 474500                    LDP4    P$,,AUTO
         9 002365   400003 475500                    LDP5    3,,PR4
         9 002366   500004 236100                    LDQ     4,,PR5
         9 002367   000033 772000                    QRL     27
         9 002370   400004 476500                    LDP6    4,,PR4
         9 002371   000000 620006                    EAX0    0,QL
         9 002372   600004 236100                    LDQ     4,,PR6
         9 002373   000033 772000                    QRL     27
         9 002374   040000 100540                    MLR     fill='040'O
         9 002375   500004 200010                    ADSC9   4,,PR5                   cn=1,n=*X0
         9 002376   000121 200037 7                  ADSC9   ES$SECLOG+16             cn=1,n=31
         9 002377   000000 622006                    EAX2    0,QL
         9 002400   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:105  
         9 002401   000022 772000                    QRL     18
         9 002402   000037 116007                    CMPQ    31,DL
         9 002403   002425 603000 9                  TRC     s:16559
         9 002404   200046 740100                    STX0    @REASON+7,,AUTO
         9 002405   777740 620010                    EAX0    -32,X0
         9 002406   777777 660003                    ERX0    -1,DU
         9 002407   200046 235100                    LDA     @REASON+7,,AUTO
         9 002410   000022 771000                    ARL     18
         9 002411   040045 100400                    MLR     fill='040'O
         9 002412   000005 000001 10                 ADSC9   5                        cn=0,n=1
         9 002413   000121 200010 7                  ADSC9   ES$SECLOG+16,A           cn=1,n=*X0
         9 002414   200046 236100                    LDQ     @REASON+7,,AUTO
         9 002415   000022 772000                    QRL     18
         9 002416   000036 116007                    CMPQ    30,DL
         9 002417   002425 603000 9                  TRC     s:16559
         9 002420   777741 620006                    EAX0    -31,QL
         9 002421   777777 660003                    ERX0    -1,DU
         9 002422   040046 100540                    MLR     fill='040'O
         9 002423   600004 200012                    ADSC9   4,,PR6                   cn=1,n=*X2
         9 002424   000121 400010 7                  ADSC9   ES$SECLOG+16,Q           cn=2,n=*X0

      696    16558    3             P$->P$B.SUBLK$(1)->P$S.TEXT);
      697    16559    3           ES$SECLOG.LOGON.L=P$->P$B.SUBLK$(0)->P$S.COUNT+

  16559  9 002425   400003 475500                    LDP5    3,,PR4
         9 002426   400004 476500                    LDP6    4,,PR4
         9 002427   600004 236100                    LDQ     4,,PR6
         9 002430   000033 772000                    QRL     27
         9 002431   200046 756100                    STQ     @REASON+7,,AUTO
         9 002432   500004 236100                    LDQ     4,,PR5
         9 002433   000033 772000                    QRL     27
         9 002434   200046 036100                    ADLQ    @REASON+7,,AUTO
         9 002435   000001 036007                    ADLQ    1,DL
         9 002436   000033 736000                    QLS     27
         9 002437   000121 552040 7                  STBQ    ES$SECLOG+16,'40'O

      698    16560    3             P$->P$B.SUBLK$(1)->P$S.COUNT+1;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:106  
      699    16561    4           IF P$->P$B.NSUBLKS > 2 AND ES$SECLOG.LOGON.L < LOGON_LEN THEN DO;

  16561  9 002440   400001 220100                    LDX0    1,,PR4
         9 002441   000003 100003                    CMPX0   3,DU
         9 002442   002506 602000 9                  TNC     s:16567
         9 002443   000121 236000 7                  LDQ     ES$SECLOG+16
         9 002444   000033 772000                    QRL     27
         9 002445   200035 116100                    CMPQ    LOGON_LEN,,AUTO
         9 002446   002506 603000 9                  TRC     s:16567

      700    16562    4               CALL INSERT(ES$SECLOG.LOGON.C,ES$SECLOG.LOGON.L-1,,',',

  16562  9 002447   400005 475500                    LDP5    5,,PR4
         9 002450   500004 236100                    LDQ     4,,PR5
         9 002451   000033 772000                    QRL     27
         9 002452   000000 622006                    EAX2    0,QL
         9 002453   000121 236000 7                  LDQ     ES$SECLOG+16
         9 002454   000033 772000                    QRL     27
         9 002455   777737 623006                    EAX3    -33,QL
         9 002456   777777 663003                    ERX3    -1,DU
         9 002457   040046 100400                    MLR     fill='040'O
         9 002460   000005 000001 10                 ADSC9   5                        cn=0,n=1
         9 002461   000121 000013 7                  ADSC9   ES$SECLOG+16,Q           cn=0,n=*X3
         9 002462   200046 756100                    STQ     @REASON+7,,AUTO
         9 002463   000000 636013                    EAQ     0,X3
         9 002464   000022 772000                    QRL     18
         9 002465   000002 116007                    CMPQ    2,DL
         9 002466   002474 602000 9                  TNC     s:16564
         9 002467   777777 620013                    EAX0    -1,X3
         9 002470   200046 235100                    LDA     @REASON+7,,AUTO
         9 002471   040045 100540                    MLR     fill='040'O
         9 002472   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         9 002473   000121 200010 7                  ADSC9   ES$SECLOG+16,A           cn=1,n=*X0

      701    16563    4                 P$->P$B.SUBLK$(2)->P$S.TEXT);
      702    16564    4               ES$SECLOG.LOGON.L=ES$SECLOG.LOGON.L+

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:107  
  16564  9 002474   400005 475500                    LDP5    5,,PR4
         9 002475   500004 236100                    LDQ     4,,PR5
         9 002476   000033 772000                    QRL     27
         9 002477   200046 756100                    STQ     @REASON+7,,AUTO
         9 002500   000121 236000 7                  LDQ     ES$SECLOG+16
         9 002501   000033 772000                    QRL     27
         9 002502   200046 036100                    ADLQ    @REASON+7,,AUTO
         9 002503   000001 036007                    ADLQ    1,DL
         9 002504   000033 736000                    QLS     27
         9 002505   000121 552040 7                  STBQ    ES$SECLOG+16,'40'O

      703    16565    4                 P$->P$B.SUBLK$(2)->P$S.COUNT+1;
      704    16566    4             END;

      705    16567    3           IF ES$SECLOG.LOGON.L > LOGON_LEN THEN

  16567  9 002506   000121 236000 7                  LDQ     ES$SECLOG+16
         9 002507   000033 772000                    QRL     27
         9 002510   200035 116100                    CMPQ    LOGON_LEN,,AUTO
         9 002511   002550 602000 9                  TNC     LOG_IT
         9 002512   002550 600000 9                  TZE     LOG_IT

      706    16568    3             ES$SECLOG.LOGON.L = LOGON_LEN;

  16568  9 002513   200035 236100                    LDQ     LOGON_LEN,,AUTO
         9 002514   000033 736000                    QLS     27
         9 002515   000121 552040 7                  STBQ    ES$SECLOG+16,'40'O
         9 002516   002550 710000 9                  TRA     LOG_IT

      707    16569    3         CASE(%ES_NO_SUCH_USER#);

      708    16570    3           ES$SECLOG.ACCN=JOB_TBL.ACCT;

  16570  9 002517   040000 100400                    MLR     fill='040'O
         9 002520   000016 000010 xsym               ADSC9   JOB_TBL+14               cn=0,n=8
         9 002521   000103 000010 7                  ADSC9   ES$SECLOG+2              cn=0,n=8

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:108  
      709    16571    3           ES$SECLOG.UNAME=JOB_TBL.UNAME;

  16571  9 002522   040000 100400                    MLR     fill='040'O
         9 002523   000020 000014 xsym               ADSC9   JOB_TBL+16               cn=0,n=12
         9 002524   000105 000014 7                  ADSC9   ES$SECLOG+4              cn=0,n=12
         9 002525   002550 710000 9                  TRA     LOG_IT

      710    16572    3         CASE(%ES_BAD_PW#);

      711    16573    3           ES$SECLOG.ACCN=JOB_TBL.ACCT;

  16573  9 002526   040000 100400                    MLR     fill='040'O
         9 002527   000016 000010 xsym               ADSC9   JOB_TBL+14               cn=0,n=8
         9 002530   000103 000010 7                  ADSC9   ES$SECLOG+2              cn=0,n=8

      712    16574    3           ES$SECLOG.UNAME=JOB_TBL.UNAME;

  16574  9 002531   040000 100400                    MLR     fill='040'O
         9 002532   000020 000014 xsym               ADSC9   JOB_TBL+16               cn=0,n=12
         9 002533   000105 000014 7                  ADSC9   ES$SECLOG+4              cn=0,n=12

      713    16575    3           ES$SECLOG.PASSWORD = SAVE_UPASS;

  16575  9 002534   200014 237100                    LDAQ    SAVE_UPASS,,AUTO
         9 002535   000110 757000 7                  STAQ    ES$SECLOG+7

      714    16576    3           CALL UPD_USERS(%ES_BAD_PW#) ALTRET(LOG_IT);

  16576  9 002536   000034 236000 10                 LDQ     28
         9 002537   200037 756100                    STQ     LOGON_LEN+2,,AUTO
         9 002540   002555 701000 9                  TSX1    UPD_USERS
         9 002541   002550 702000 9                  TSX2    LOG_IT

      715    16577    3           ES$SECLOG.PRIV = AS_USERS.PRIV(AS_M_BATCH#);

  16577  9 002542   000225 236000 xsym               LDQ     AS_USERS+149
         9 002543   000115 756000 7                  STQ     ES$SECLOG+12
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:109  

      716    16578    3           ES$SECLOG.PPRIV = AS_USERS.PPRIV(AS_M_BATCH#);

  16578  9 002544   000231 236000 xsym               LDQ     AS_USERS+153
         9 002545   000116 756000 7                  STQ     ES$SECLOG+13
         9 002546   002550 710000 9                  TRA     LOG_IT

      717    16579    3         CASE(ELSE);

      718    16580            /* Should never happen */
      719    16581    3           RETURN;

  16581  9 002547   000001 702211                    TSX2  ! 1,X1

      720    16582    3       END; /* End Do Case(Reason) */

  16577  9 002550                       LOG_IT       null
      721    16583    2   LOG_IT:;
      722    16584    2       CALL M$WRSYSLOG(WR_SECLOG);

  16584  9 002550   000162 630400 7                  EPPR0   WR_SECLOG
         9 002551   070001 713400                    CLIMB   28673
         9 002552   400400 401760                    pmme    nvectors=2

      723    16585    2       RETURN;

  16585  9 002553   200032 221300                    LDX1  ! J,,AUTO
         9 002554   000001 702211                    TSX2  ! 1,X1

      724    16586    2   END SECLOG;
      725    16587        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:110  
      726    16588    1   UPD_USERS: PROC(REASON) ALTRET;

  16588  9 002555   200036 741300       UPD_USERS    STX1  ! LOGON_LEN+1,,AUTO

      727    16589        /* Update the :USERS record for good or bad password logons. */
      728    16590    2     DCL REASON UBIN;
      729    16591        %AS_USERS(STR_NAME=AS_USERS_SEC,STCLASS=STATIC);
      730    16769        %FPT_READ(FPTN=READ_USERS_SEC,
      731    16770                  DCB=M$USERS,
      732    16771                  KEYS=YES,
      733    16772                  KEY=UKEY,
      734    16773                  BUF=AS_USERS_SEC);
      735    16812        %FPT_WRITE(FPTN=WRITE_USERS_SEC,
      736    16813                  DCB=M$USERS,
      737    16814                  KEY=UKEY,
      738    16815                  BUF=AS_USERS_SEC);
      739    16846        %FPT_ENQ(FPTN=ENQ_USERS_SEC,
      740    16847                  DCB=M$USERS,
      741    16848                  RNAME=UKEY,
      742    16849                  SHARE=NONE);
      743    16867        %FPT_DEQ(FPTN=DEQ_USERS_SEC,
      744    16868                  DCB=M$USERS);
      745    16885
      746    16886
      747    16887            /* If this job's logon is the same as the guy who batched it,
      748    16888               don't bother to update :USERS. Want to avoid having the logon
      749    16889               time and bad logon counts rolling over so often that they
      750    16890               become useless.                                             */
      751    16891    2       IF REASON=%ES_LOG_ALL# AND INSYM$INFO.FLAG~=JOBORIG_DEVICE# AND

  16891  9 002556   200037 470500                    LDP0    @REASON,,AUTO
         9 002557   000000 235100                    LDA     0,,PR0
         9 002560   000001 115007                    CMPA    1,DL
         9 002561   002600 601000 9                  TNZ     s:16895
         9 002562   000000 471400 xsym               LDP1    INSYM_INFO$
         9 002563   100006 236100                    LDQ     6,,PR1
         9 002564   777000 316003                    CANQ    -512,DU
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:111  
         9 002565   002600 600000 9                  TZE     s:16895
         9 002566   000000 473400 xsym               LDP3    CODE04$
         9 002567   040100 106400                    CMPC    fill='040'O
         9 002570   000016 000010 xsym               ADSC9   JOB_TBL+14               cn=0,n=8
         9 002571   300003 000010                    ADSC9   3,,PR3                   cn=0,n=8
         9 002572   002600 601000 9                  TNZ     s:16895
         9 002573   040100 106400                    CMPC    fill='040'O
         9 002574   000020 000014 xsym               ADSC9   JOB_TBL+16               cn=0,n=12
         9 002575   300005 000014                    ADSC9   5,,PR3                   cn=0,n=12
         9 002576   002600 601000 9                  TNZ     s:16895

      752    16892    2         JOB_TBL.ACCT=CODE04.CREATOR.ACCT AND
      753    16893    2         JOB_TBL.UNAME=CODE04.CREATOR.NAME THEN
      754    16894    2         RETURN;

  16894  9 002577   000001 702211                    TSX2  ! 1,X1

      755    16895    2       CALL M$ENQ(ENQ_USERS_SEC) ALTRET(ERR);

  16895  9 002600   001230 630400 7                  EPPR0   ENQ_USERS_SEC
         9 002601   420002 713400                    CLIMB   alt,+8194
         9 002602   401000 401760                    pmme    nvectors=3
         9 002603   002637 702000 9                  TSX2    ERR

      756    16896    3       CALL M$READ(READ_USERS_SEC) WHENALTRETURN DO;

  16896  9 002604   001176 630400 7                  EPPR0   READ_USERS_SEC
         9 002605   440000 713400                    CLIMB   alt,read
         9 002606   401400 401760                    pmme    nvectors=4
         9 002607   002611 702000 9                  TSX2    s:16897
         9 002610   002615 710000 9                  TRA     s:16900

      757    16897    3           CALL M$DEQ(DEQ_USERS_SEC);

  16897  9 002611   001242 630400 7                  EPPR0   DEQ_USERS_SEC
         9 002612   020003 713400                    CLIMB   8195
         9 002613   401000 401760                    pmme    nvectors=3
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:112  

      758    16898    3           GOTO ERR;

  16898  9 002614   002637 710000 9                  TRA     ERR

      759    16899    3         END;
      760    16900    3       IF REASON=%ES_BAD_PW# THEN DO;

  16900  9 002615   200037 470500                    LDP0    @REASON,,AUTO
         9 002616   000000 235100                    LDA     0,,PR0
         9 002617   000002 115007                    CMPA    2,DL
         9 002620   002627 601000 9                  TNZ     s:16905

      761    16901    3           AS_USERS_SEC.BAD_LOGON_CNT=AS_USERS_SEC.BAD_LOGON_CNT+1;

  16901  9 002621   001155 220000 7                  LDX0    AS_USERS_SEC+499
         9 002622   000001 621010                    EAX1    1,X0
         9 002623   001155 741000 7                  STX1    AS_USERS_SEC+499

      762    16902    3           AS_USERS_SEC.LOGINS.BAD_LOGON_CNT(%M_BATCH#-1)=

  16902  9 002624   001157 235000 7                  LDA     AS_USERS_SEC+501
         9 002625   000001 035007                    ADLA    1,DL
         9 002626   001157 755000 7                  STA     AS_USERS_SEC+501

      763    16903    3             AS_USERS_SEC.LOGINS.BAD_LOGON_CNT(%M_BATCH#-1)+1;
      764    16904    3         END;

      765    16905    2       CALL M$WRITE(WRITE_USERS_SEC);

  16905  9 002627   001214 630400 7                  EPPR0   WRITE_USERS_SEC
         9 002630   040001 713400                    CLIMB   write
         9 002631   401400 401760                    pmme    nvectors=4

      766    16906    2       CALL M$DEQ(DEQ_USERS_SEC);

  16906  9 002632   001242 630400 7                  EPPR0   DEQ_USERS_SEC
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:113  
         9 002633   020003 713400                    CLIMB   8195
         9 002634   401000 401760                    pmme    nvectors=3

      767    16907    2       RETURN;

  16907  9 002635   200036 221300                    LDX1  ! LOGON_LEN+1,,AUTO
         9 002636   000001 702211                    TSX2  ! 1,X1

  16906  9 002637                       ERR          null
      768    16908    2   ERR:;
      769    16909    2       ALTRETURN;

  16909  9 002637   200036 221300                    LDX1  ! LOGON_LEN+1,,AUTO
         9 002640   000000 702211                    TSX2  ! 0,X1

      770    16910
      771    16911    2   END UPD_USERS;
      772    16912        %EJECT;
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:114  
      773    16913    1   JPJ$LOG_GOOD: ENTRY ALTRET; /* Never altrets */

  16913  9 002641   000000 700200 xent  JPJ$LOG_GOOD TSX0  ! X66_AUTO_0
         9 002642   000054 000000                    ZERO    44,0

      774    16914        /**/
      775    16915        /*P* NAME:         JPJ$LOG_GOOD
      776    16916             PURPOSE:      To allow JPS$SCAN to gain access to the SECLOG
      777    16917                           and/or UPD_USERS subroutines in JPJ$JOB for logging
      778    16918                           successful logons.
      779    16919        */
      780    16920        /**/
      781    16921        /*F* NAME:         JPJ$LOG_GOOD
      782    16922             PURPOSE:      To allow JPS$SCAN to gain access to the SECLOG
      783    16923                           and/or UPD_USERS subroutines in JPJ$JOB for logging
      784    16924                           successful logons.
      785    16925
      786    16926             CALL:         CALL JPJ$LOG_GOOD;
      787    16927
      788    16928             INPUT:        None
      789    16929
      790    16930             DESCRIPTION:  JPJ$LOG_GOOD calls SECLOG if we're logging all
      791    16931                           logons in the security log. Otherwise, it calls
      792    16932                           UPD_USERS to update the :USERS record. Called by
      793    16933                           JPS$SCAN before he sends the job to MBS.
      794    16934        */
      795    16935    1       IF ES$LOGSYSACC=%PC_ES_LOGACC_ALL# THEN

  16935  9 002643   000000 470400 xsym               LDP0    ES$
         9 002644   000000 235100                    LDA     0,,PR0
         9 002645   000004 115007                    CMPA    4,DL
         9 002646   002654 601000 9                  TNZ     s:16937

      796    16936    1         CALL SECLOG(%ES_LOG_ALL#);

  16936  9 002647   000061 236000 10                 LDQ     49
         9 002650   200033 756100                    STQ     J+1,,AUTO
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:115  
         9 002651   002232 701000 9                  TSX1    SECLOG
         9 002652   000000 011000                    NOP     0
         9 002653   002661 710000 9                  TRA     s:16939

      797    16937    2       ELSE CALL UPD_USERS(%ES_LOG_ALL#) WHENALTRETURN DO;

  16937  9 002654   000061 236000 10                 LDQ     49
         9 002655   200037 756100                    STQ     LOGON_LEN+2,,AUTO
         9 002656   002555 701000 9                  TSX1    UPD_USERS
         9 002657   002661 702000 9                  TSX2    s:16939
         9 002660   002661 710000 9                  TRA     s:16939

      798    16938    2           END;

      799    16939    1       RETURN;

  16939  9 002661   000000 702200 xent               TSX2  ! X66_ARET
      800    16940    1   END JPJ$JOB;

PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:116  
--  Include file information  --

   AS_SUBS_C.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   JP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   JP_PERR_C.:E05TOU  is referenced.
   JP_MACRO_C.:E05TOU  is referenced.
   JM_SUBS_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JPJ$JOB.
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:117  

 **** Variables and constants ****

  ****  Section 007  Data  JPJ$JOB

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   172-0-0/w STRC(18576) r     1 AS_USERS_SEC              43-0-0/c CHAR(8)     r     1 DEFER_DATE
    45-0-0/c CHAR(5)     r     1 DEFER_TIME                14-0-0/d STRC(432)   r     1 DEFER_TSTAMP
    42-0-0/w UBIN        r     1 DEFER_UTS               1242-0-0/d STRC(288)   r     1 DEQ_USERS_SEC
  1230-0-0/d STRC(360)   r     1 ENQ_USERS_SEC            101-0-0/w STRC(1764)  r     1 ES$SECLOG
    76-0-0/d CHAR(8)     r     1 FOL_ACCT                  66-0-0/c CHAR(31)    r     1 FOL_NAME
    30-0-0/d STRC(360)   r     1 FPT_PRECORD                0-0-0/d STRC(432)   r     1 FPT_REWRITE
  1176-0-0/d STRC(504)   r     1 READ_USERS_SEC            47-0-0/c STRC(189)   r     1 UKEY
   100-0-0/w SBIN        r     1 VAR_LEN                 1214-0-0/d STRC(432)   r     1 WRITE_USERS_SEC
   162-0-0/d STRC(288)   r     1 WR_SECLOG                 56-0-0/d STRC(288)   r     1 XSJ_PARAM

  ****  Section 008 RoData JPJ$JOB

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    61-0-0/w STRC(1764)  r     1 ES$SECLOG_INIT            56-0-0/w STRC        r     1 E_BADID
    55-0-0/w STRC        r     1 E_MANYFOLLOW              57-0-0/w STRC        r     1 E_MAXPRIO
    60-0-0/w STRC        r     1 E_NOBATCH                 51-0-0/w STRC        r     1 E_NOID
    52-0-0/w STRC        r     1 E_NONAME                  50-0-0/w STRC(27)    r     1 LEGAL_LENGTH
    32-0-0/d STRC(504)   r     1 READ_HLP                  14-0-0/d STRC(504)   r     1 READ_USERS
     0-0-0/d STRC(432)   r     1 TODAYS_DATE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    33-0-0/w PTR         r     1 @REASON                   37-0-0/w PTR         r     1 @REASON
    11-0-0/w BIT         r     1 CALL_FLAG#                17-0-0/w UBIN        r     1 COMMA_POS
    21-0-0/w BIT         r     1 ES_FLG                     3-0-0/w SBIN        r     1 I
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:118  
    31-0-0/w SBIN        r     1 I                         32-0-0/w SBIN        r     1 J
    35-0-0/c CHAR(31)    r     1 JOBNAME                   22-0-0/w STRC(144)   r     1 JOB_BLK
     5-0-0/w SBIN        r     1 K                         33-0-0/w SBIN        r     1 K
    35-0-0/w UBIN        r     1 LOGON_LEN                  6-0-0/w PTR         r     1 P$
    34-0-0/w PTR         r     1 P$                        16-0-0/w UBIN        r     1 PASS_POS
    *0-0-0/w UBIN        r     1 REASON                    *0-0-0/w UBIN        r     1 REASON
    20-0-0/b BIT         r     1 SAVE_ERR                  14-0-0/c CHAR(8)     r     1 SAVE_UPASS
     7-0-0/w PTR         r     1 T$                        10-0-0/w PTR         r     1 T2$
    34-0-0/w UBIN        r     1 TEMP                      12-0-0/c CHAR(8)     r     1 UPASS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(45)    r     1 ABORTHDR                   0-0-0/w STRC(18576) r     1 AS_USERS
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$JIT0_LO$
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 CODE04$
     0-0-0/w STRC(828)   r     1 ERR_BLK                    0-0-0/w PTR         r     1 ES$
     0-0-0/w PTR         r     1 INSYM_INFO$                0-0-0/w STRC(1980)  r     1 JOB_TBL
     0-0-0/w STRC(1386)  r     1 JP_CONTINUE                0-0-0/w STRC(6084)  r     1 KL_DREC
     0-0-0/c CHAR(8)     r     1 LO_WSN                     0-0-0/w PTR         r     1 M$EI$
     0-0-0/d STRC(2088)  r     1 OPEN_LO                    0-0-0/b BIT         r     1 PASSWORD_OK#
     0-0-0/b BIT         r     1 PASS_SPECIFIED#            0-0-0/b BIT         r     1 PASS_TWO#
     0-0-0/w STRC(504)   r     1 PCB                        0-0-0/b BIT         r     1 SCAN_CMDS#
     0-0-0/w STRC(576)   r     1 U$PARAM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(865)   r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(396)   r     1 CODE04
     0-0-0/w UBIN        r     1 ES$LOGSYSACC               0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(288)   r     1 INSYM$INFO                 0-0-0N  NULL        r     1 M$EI
     0-0-0N  NULL        r     1 M$HLP                      0-0-0N  NULL        r     1 M$JOBSTAT
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:119  
     0-0-0N  NULL        r     1 M$USERS                    0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S                        0-0-0/w CHAR(4096)  r     1 T$BUF
     0-0-0/c ACHR        r     1 VAR$CHAR


   Procedure JPJ$JOB requires 1458 words for executable code.
   Procedure JPJ$JOB requires 44 words of local(AUTO) storage.

    No errors detected in file JPJ$JOB.:E05TSI    .
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:120  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:121  
          MINI XREF LISTING

ABORT
     13825**LABEL   13802--CALLALT 13809--GOTO    13818--CALLALT
ABORTHDR.TITL.L#
     12833**DCL     12834--IMP-SIZ 13640>>ASSIGN  13641>>ASSIGN  13762>>ASSIGN  13763>>ASSIGN
ABORTHDR.TITL.TITLE#
     12834**DCL     13640<<ASSIGN  13641<<ASSIGN  13762<<ASSIGN  13763<<ASSIGN
ASZ$SCRAMBLE
     12444**DCL-ENT 13646--CALL    13692--CALL
AS_USERS
     11645**DCL     12951--DCLINIT 12952--DCLINIT
AS_USERS.BANNER_PERM
     11760**DCL     11761--REDEF
AS_USERS.BUDGET.MACCT
     11665**DCL     11669--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11678**DCL     11681--REDEF
AS_USERS.BUDGET.PACCUM
     11661**DCL     11663--REDEF
AS_USERS.BUDGET.PMAXC
     11656**DCL     11658--REDEF
AS_USERS.DMEM
     11745**DCL     13845>>ASSIGN
AS_USERS.DMPRIO
     11707**DCL     13848>>ASSIGN
AS_USERS.DTIME
     11742**DCL     13844>>ASSIGN
AS_USERS.MMPRIO
     11706**DCL     13932>>ASSIGN
AS_USERS.PPRIV
     11724**DCL     16578>>ASSIGN
AS_USERS.PRIV
     11723**DCL     16577>>ASSIGN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:122  
AS_USERS.SETUP_CHRA.TXT
     11776**DCL     11777--REDEF   11778--REDEF
AS_USERS_SEC IN PROCEDURE UPD_USERS
     16604**DCL     16792--DCLINIT 16793--DCLINIT 16833--DCLINIT 16834--DCLINIT
AS_USERS_SEC.BAD_LOGON_CNT IN PROCEDURE UPD_USERS
     16746**DCL     16901<<ASSIGN  16901>>ASSIGN
AS_USERS_SEC.BANNER_PERM IN PROCEDURE UPD_USERS
     16719**DCL     16720--REDEF
AS_USERS_SEC.BUDGET.MACCT IN PROCEDURE UPD_USERS
     16624**DCL     16628--REDEF
AS_USERS_SEC.BUDGET.MAX_PROJECTS IN PROCEDURE UPD_USERS
     16637**DCL     16640--REDEF
AS_USERS_SEC.BUDGET.PACCUM IN PROCEDURE UPD_USERS
     16620**DCL     16622--REDEF
AS_USERS_SEC.BUDGET.PMAXC IN PROCEDURE UPD_USERS
     16615**DCL     16617--REDEF
AS_USERS_SEC.LOGINS.BAD_LOGON_CNT IN PROCEDURE UPD_USERS
     16754**DCL     16902<<ASSIGN  16902>>ASSIGN
AS_USERS_SEC.SETUP_CHRA.TXT IN PROCEDURE UPD_USERS
     16735**DCL     16736--REDEF   16737--REDEF
B$ALT.CODE
     11569**DCL     11569--REDEF   11570--REDEF   11570--REDEF
B$ALT.ERR
     11570**DCL     13774>>ASSIGN  13999<>CALL
B$ALT.ERR.CODE
     11571**DCL     13906>>IF      14047>>IF
B$ALT.ERR.ERR#
     11571**DCL     11571--REDEF
B$ALT.EVID
     11570**DCL     11570--REDEF   11570--REDEF
B$JIT.ACCN
     13277**DCL     13833<<ASSIGN  13861<<ASSIGN
B$JIT.ERR
     13277**DCL     13765>>IF      13768<>CALL
B$JIT.ERR.MID
     13278**DCL     13278--REDEF
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:123  
B$JIT.UNAME
     13277**DCL     13834<<ASSIGN  13862<<ASSIGN
B$JIT.WOO
     13277**DCL     13769>>ASSIGN
B$JIT$
     11557**DCL     13272--IMP-PTR
B$JIT0_LO$
     12458**DCL     13765>>IF      13768>>CALL    13769>>ASSIGN  13833>>ASSIGN  13834>>ASSIGN  13861>>ASSIGN
     13862>>ASSIGN
B$TCB.ALT$
     11565**DCL     13774>>ASSIGN  13906>>IF      13999>>CALL    14047>>IF
B$TCB$
     11559**DCL     11565--IMP-PTR 13774>>ASSIGN  13906>>IF      13999>>CALL    14047>>IF
CALL_FLAG#
     13401**DCL     13662<>CALL
CODE04.CREATOR.ACCT
     13262**DCL     13643>>ASSIGN  13717>>ASSIGN  13881>>IF      16543>>ASSIGN  16891>>IF
CODE04.CREATOR.NAME
     13262**DCL     13644>>ASSIGN  13718>>ASSIGN  13881>>IF      16545>>ASSIGN  16891>>IF
CODE04$
     12461**DCL     13260--IMP-PTR 13643>>ASSIGN  13644>>ASSIGN  13717>>ASSIGN  13718>>ASSIGN  13881>>IF
     13881>>IF      16543>>ASSIGN  16545>>ASSIGN  16891>>IF      16891>>IF
COMMA_POS
     13405**DCL     13693<<ASSIGN  13694>>DOUNTIL 13698<<ASSIGN  13698>>ASSIGN  13699>>IF      13701>>DOUNTIL
     13702<<ASSIGN  13702>>ASSIGN  13705>>ASSIGN  13790>>IF      13811<<ASSIGN
CPD$SET_NODES
     12445**DCL-ENT 13662--CALL
CPD$SYNTRY
     12447**DCL-ENT 13660--ASSIGN
CXP$POSTERR
     12448**DCL-ENT 13713--CALL    13724--CALL    13768--CALL    13776--CALL    13839--CALL    13857--CALL
     13939--CALL    13999--CALL    14004--CALL    14049--CALL
DEFER_DATE
     13363**DCL     12899--DCLINIT 12900--DCLINIT 13964--ASSIGN  13982<<CALLBLT 13991--ASSIGN
DEFER_TIME
     13364**DCL     13972<<CALLBLT 13978--ASSIGN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:124  
DEFER_TSTAMP
     12879**DCL     13994<>CALL
DEFER_TSTAMP.DATE_
     12879**DCL     13964<<ASSIGN  13991<<ASSIGN
DEFER_TSTAMP.TIME_
     12881**DCL     13965<<ASSIGN  13978<<ASSIGN
DEFER_TSTAMP.V
     12883**DCL     12879--DCLINIT
DEFER_UTS
     13362**DCL     12883--DCLINIT 13996>>ASSIGN
DEQ_USERS_SEC IN PROCEDURE UPD_USERS
     16879**DCL     16897<>CALL    16906<>CALL
DEQ_USERS_SEC.V IN PROCEDURE UPD_USERS
     16880**DCL     16879--DCLINIT
ENQ_USERS_SEC IN PROCEDURE UPD_USERS
     16860**DCL     16895<>CALL
ENQ_USERS_SEC.V IN PROCEDURE UPD_USERS
     16861**DCL     16860--DCLINIT
ERR IN PROCEDURE UPD_USERS
     16906**LABEL   16895--CALLALT 16898--GOTO
ERR_BLK
     12476**DCL     13713--CALL    13724--CALL    13768--CALL    13776--CALL    13839--CALL    13857--CALL
     13939--CALL    13999--CALL    14004--CALL    14049--CALL
ERR_BLK.FIRST
     12478**DCL     13653<<ASSIGN  13675>>IF
ES$
     11994**DCL     11995--REDEF   11998--IMP-PTR 13731>>IF      13893>>IF      13909>>IF      16935>>IF
ES$LOGSYSACC
     11998**DCL     13731>>IF      13893>>IF      13909>>IF      16935>>IF
ES$SECLOG IN PROCEDURE SECLOG
     14822**DCL     15100--DCLINIT 15102--DCLINIT 16519<<ASSIGN
ES$SECLOG.ACCN IN PROCEDURE SECLOG
     14855**DCL     16551<<ASSIGN  16570<<ASSIGN  16573<<ASSIGN
ES$SECLOG.DEVICE IN PROCEDURE SECLOG
     14979**DCL     16529<<ASSIGN
ES$SECLOG.DEVICE_TNAME IN PROCEDURE SECLOG
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:125  
     14984**DCL     16528<<ASSIGN
ES$SECLOG.FACCN IN PROCEDURE SECLOG
     14863**DCL     14867--REDEF
ES$SECLOG.FILE IN PROCEDURE SECLOG
     15023**DCL     15054--REDEF
ES$SECLOG.GRANTED IN PROCEDURE SECLOG
     14829**DCL     16550<<ASSIGN
ES$SECLOG.LOGON IN PROCEDURE SECLOG
     14912**DCL     14924--REDEF
ES$SECLOG.LOGON.C IN PROCEDURE SECLOG
     14921**DCL     16555--ASSIGN  16557<<CALLBLT 16562<<CALLBLT
ES$SECLOG.LOGON.L IN PROCEDURE SECLOG
     14918**DCL     16559<<ASSIGN  16561>>IF      16562>>CALLBLT 16564<<ASSIGN  16564>>ASSIGN  16567>>IF
     16568<<ASSIGN
ES$SECLOG.MODE IN PROCEDURE SECLOG
     14833**DCL     16521<<ASSIGN
ES$SECLOG.ORIG_MODE IN PROCEDURE SECLOG
     15016**DCL     16524<<ASSIGN
ES$SECLOG.ORIG_SYSID IN PROCEDURE SECLOG
     14947**DCL     16531<<ASSIGN
ES$SECLOG.PASSWORD IN PROCEDURE SECLOG
     14867**DCL     16575<<ASSIGN
ES$SECLOG.PPRIV IN PROCEDURE SECLOG
     14898**DCL     16578<<ASSIGN
ES$SECLOG.PREV_USER.ACCT IN PROCEDURE SECLOG
     15072**DCL     16543<<ASSIGN
ES$SECLOG.PREV_USER.MODE IN PROCEDURE SECLOG
     15062**DCL     16541<<ASSIGN
ES$SECLOG.PREV_USER.SYSID IN PROCEDURE SECLOG
     15067**DCL     16542<<ASSIGN
ES$SECLOG.PREV_USER.UNAME.C IN PROCEDURE SECLOG
     15081**DCL     16545<<ASSIGN
ES$SECLOG.PREV_USER.UNAME.L IN PROCEDURE SECLOG
     15078**DCL     16544<<ASSIGN
ES$SECLOG.PRIV IN PROCEDURE SECLOG
     14891**DCL     16577<<ASSIGN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:126  
ES$SECLOG.REASON IN PROCEDURE SECLOG
     14824**DCL     16520<<ASSIGN
ES$SECLOG.TSLINE.FEX IN PROCEDURE SECLOG
     14964**DCL     16533<<ASSIGN
ES$SECLOG.TSLINE.LEV IN PROCEDURE SECLOG
     14970**DCL     16535<<ASSIGN
ES$SECLOG.TSLINE.PORT IN PROCEDURE SECLOG
     14967**DCL     16534<<ASSIGN
ES$SECLOG.TSLINE.SUBDEVICE IN PROCEDURE SECLOG
     14973**DCL     16536<<ASSIGN
ES$SECLOG.TSLINE.SUBSUBDEVICE IN PROCEDURE SECLOG
     14976**DCL     16537<<ASSIGN
ES$SECLOG.UNAME IN PROCEDURE SECLOG
     14859**DCL     16552<<ASSIGN  16571<<ASSIGN  16574<<ASSIGN
ES$SECLOG_INIT IN PROCEDURE SECLOG
     14545**DCL     16519>>ASSIGN
ES$SECLOG_INIT.FACCN IN PROCEDURE SECLOG
     14586**DCL     14590--REDEF
ES$SECLOG_INIT.FILE IN PROCEDURE SECLOG
     14746**DCL     14777--REDEF
ES$SECLOG_INIT.LOGON IN PROCEDURE SECLOG
     14635**DCL     14647--REDEF
ES_FLG
     13408**DCL     13734<<ASSIGN  13737<<ASSIGN  13739>>IF
E_BADID
     13583**DCL     13857<>CALL
E_MANYFOLLOW
     13560**DCL     14004<>CALL
E_MAXPRIO
     13606**DCL     13939<>CALL
E_NOBATCH
     13629**DCL     13839<>CALL
E_NOID
     13468**DCL     13713<>CALL
E_NONAME
     13491**DCL     14049<>CALL
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:127  
E_OPEN_LO
     13773**LABEL   13764--CALLALT
E_OPEN_LOCAL
     13779**LABEL   13775--CALLALT
E_SYNTAX
     13723**LABEL   13663--CALLALT
E_TIME IN PROCEDURE PROCESS_OPTS
     13999**LABEL   13994--CALLALT
F$DCB.ACTPOS
     11608**DCL     11608--REDEF
F$DCB.ARS#
     11582**DCL     11582--REDEF
F$DCB.ATTR
     11601**DCL     11602--REDEF
F$DCB.BORROW
     11616**DCL     11616--REDEF   11616--REDEF   11616--REDEF
F$DCB.DCBNAME.L
     11630**DCL     11630--IMP-SIZ
F$DCB.DVBYTE
     11585**DCL     13803>>ASSIGN
F$DCB.EOMCHAR#
     11586**DCL     11586--REDEF
F$DCB.FLDID
     11611**DCL     11611--REDEF
F$DCB.FORM$
     11605**DCL     11605--REDEF
F$DCB.FSECT
     11621**DCL     11621--REDEF
F$DCB.FSN#
     11598**DCL     11598--REDEF   11598--REDEF   11599--REDEF
F$DCB.HEADER$
     11604**DCL     11604--REDEF
F$DCB.IXTNSIZE#
     11602**DCL     11602--REDEF
F$DCB.LASTSTA$
     11591**DCL     11591--REDEF
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:128  
F$DCB.LVL
     11617**DCL     11617--REDEF
F$DCB.NAME#.C
     11592**DCL     11592--REDEF
F$DCB.NOEOF
     11614**DCL     11614--REDEF
F$DCB.NRECS#
     11603**DCL     11603--REDEF
F$DCB.NRECX
     11622**DCL     11622--REDEF
F$DCB.OHDR
     11614**DCL     11614--REDEF
F$DCB.ORG#
     11597**DCL     11597--REDEF
F$DCB.PRECNO
     11620**DCL     11620--REDEF
F$DCB.RCSZ
     11626**DCL     11626--REDEF
F$DCB.RES#
     11593**DCL     11593--REDEF
F$DCB.SETX
     11605**DCL     11605--REDEF
F$DCB.TAB$
     11605**DCL     11605--REDEF
F$DCB.TDA
     11619**DCL     11620--REDEF
F$DCB.TYC.LD#
     11583**DCL     13807>>IF
F$DCB.WSN#
     11593**DCL     11593--REDEF
FOL_ACCT
     13390**DCL     13384--DCLINIT 14039<<ASSIGN  14041<<ASSIGN  14081<<ASSIGN
FOL_NAME
     13389**DCL     13385--DCLINIT 14036<<ASSIGN  14080<<ASSIGN
FPT_PRECORD
     12918**DCL     13802<>CALL    13818<>CALL
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:129  
FPT_PRECORD.V
     12920**DCL     12918--DCLINIT
FPT_PRECORD.V.N#
     12924**DCL     13801<<ASSIGN  13817<<ASSIGN
FPT_REWRITE
     12853**DCL     13804<>CALL
FPT_REWRITE.BUF_.BOUND
     12853**DCL     13794<<ASSIGN  13799<<ASSIGN
FPT_REWRITE.BUF_.BUF$
     12855**DCL     13793<<ASSIGN  13798<<ASSIGN
FPT_REWRITE.STATION_
     12855**DCL     12855--REDEF
FPT_REWRITE.V
     12856**DCL     12853--DCLINIT
FPT_REWRITE.V.DVBYTE
     12861**DCL     13803<<ASSIGN
FPT_REWRITE.V.DVBYTE.VFC#
     12862**DCL     12862--REDEF
GET_USERS IN PROCEDURE PROCESS_JOB
     13867**PROC    13832--CALL
I
     13395**DCL     13667<<DOINDEX 13668>>IF      13735<<DOINDEX 13736>>IF      13736>>IF
I IN PROCEDURE PROCESS_OPTS
     13915**DCL     13922<<DOINDEX 13923>>ASSIGN
INSYM$INFO.DEFPRI
     13269**DCL     13846>>IF      13850>>ASSIGN
INSYM$INFO.FLAG
     13269**DCL     13709>>IF      13858>>IF      16540>>IF      16541>>ASSIGN  16891>>IF
INSYM$INFO.MAXPRI
     13269**DCL     13930>>IF      13934>>ASSIGN
INSYM$INFO.ORIGINATOR_MODE
     13269**DCL     16524>>ASSIGN  16525>>DOCASE
INSYM$INFO.ORIGINATOR_PORT.FROM_CR
     13266**DCL     13266--REDEF   13267--REDEF
INSYM$INFO.ORIGINATOR_PORT.FROM_CR.DEVICE
     13266**DCL     16529>>ASSIGN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:130  
INSYM$INFO.ORIGINATOR_PORT.FROM_CR.TNAME
     13266**DCL     16528>>ASSIGN
INSYM$INFO.ORIGINATOR_PORT.FROM_GHOST.SYSID
     13266**DCL     16531>>ASSIGN
INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.FEX
     13267**DCL     16533>>ASSIGN
INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.LEV
     13267**DCL     16535>>ASSIGN
INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.PORT
     13267**DCL     16534>>ASSIGN
INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.SUBDEVICE
     13268**DCL     16536>>ASSIGN
INSYM$INFO.ORIGINATOR_PORT.FROM_INT.TSLINE.SUBSUBDEVICE
     13268**DCL     16537>>ASSIGN
INSYM$INFO.SYSID
     13268**DCL     16542>>ASSIGN
INSYM_INFO$
     12460**DCL     13266--IMP-PTR 13709>>IF      13846>>IF      13850>>ASSIGN  13858>>IF      13930>>IF
     13934>>ASSIGN  16524>>ASSIGN  16525>>DOCASE  16528>>ASSIGN  16529>>ASSIGN  16531>>ASSIGN  16533>>ASSIGN
     16534>>ASSIGN  16535>>ASSIGN  16536>>ASSIGN  16537>>ASSIGN  16540>>IF      16541>>ASSIGN  16542>>ASSIGN
     16891>>IF
INVALID_ID IN PROCEDURE PROCESS_JOB
     13856**LABEL   13832--CALLALT
J IN PROCEDURE PROCESS_OPTS
     13916**DCL     13967<<DOINDEX 13968>>ASSIGN  14019<<DOINDEX 14020>>ASSIGN  14021>>ASSIGN  14022>>ASSIGN
     14023>>ASSIGN  14032>>ASSIGN  14042>>ASSIGN  14056>>ASSIGN  14058>>ASSIGN  14060>>ASSIGN  14062>>ASSIGN
     14066>>ASSIGN
JOBNAME IN PROCEDURE PROCESS_OPTS
     13921**DCL     13953<<ASSIGN  13954>>CALLBLT 13956>>ASSIGN
JOB_BLK
     13415**DCL     13654<<ASSIGN  13656--ASSIGN
JOB_BLK.CODE
     13423**DCL     13655<<ASSIGN
JOB_TBL.ACCT
     13104**DCL     13830<<ASSIGN  14041>>ASSIGN  14081>>ASSIGN  16551>>ASSIGN  16570>>ASSIGN  16573>>ASSIGN
     16891>>IF
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:131  
JOB_TBL.FLG.ACC
     13082**DCL     13946<<ASSIGN
JOB_TBL.FLG.NPI
     13088**DCL     13958<<ASSIGN
JOB_TBL.FLG.O1
     13075**DCL     13942<<ASSIGN  13944<<ASSIGN
JOB_TBL.FLG.O3
     13080**DCL     14007<<ASSIGN
JOB_TBL.FLG.RA
     13090**DCL     13995<<ASSIGN
JOB_TBL.FLG.RR
     13084**DCL     13960<<ASSIGN  13962<<ASSIGN
JOB_TBL.JDID.FOLLOW_TYPE
     13120**DCL     14013<<ASSIGN  14021<<ASSIGN  14056<<ASSIGN  14058<<ASSIGN  14060<<ASSIGN
JOB_TBL.JDID.RELATION
     13116**DCL     14022<<ASSIGN  14062<<ASSIGN
JOB_TBL.JDID.SYSID
     13135**DCL     14032<<ASSIGN  14042--ASSIGN
JOB_TBL.JDSTEPCC
     13137**DCL     14023<<ASSIGN  14066<<ASSIGN
JOB_TBL.JNAME
     13167**DCL     13956<<ASSIGN  14077>>IF      14080>>ASSIGN
JOB_TBL.JNL
     13158**DCL     13955<<ASSIGN
JOB_TBL.NJD
     13068**DCL     14012<<ASSIGN  14018<<ASSIGN  14019>>DOINDEX
JOB_TBL.PRIO
     13072**DCL     13848<<ASSIGN  13850<<ASSIGN  13929<<ASSIGN  13935>>IF
JOB_TBL.RATIM
     13112**DCL     13996<<ASSIGN
JOB_TBL.RRT
     13144**DCL     13845<<ASSIGN
JOB_TBL.SYSID
     13102**DCL     14082--ASSIGN
JOB_TBL.TIM
     13066**DCL     13844<<ASSIGN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:132  
JOB_TBL.UNAME
     13106**DCL     13831<<ASSIGN  16552>>ASSIGN  16571>>ASSIGN  16574>>ASSIGN  16891>>IF
JOB_TBL.WSN
     13110**DCL     13948<<ASSIGN  13949>>ASSIGN
JPA$CONTINUE
     12450**DCL-ENT 13658--ASSIGN
JPE$REASON
     12452**DCL-ENT 13712--CALL    13723--CALL    13825--CALL    13838--CALL    13856--CALL    14086--CALL
JPT$REPORT
     12453**DCL-ENT 13779--CALL    13826--CALL    13908--CALL    14087--CALL
JP_CONTINUE.CHARPOS
     12707**DCL     13788>>ASSIGN  13788>>ASSIGN  13790>>IF      13793>>ASSIGN  13812>>IF
JP_CONTINUE.LEN
     12708**DCL     13788<<ASSIGN  13790>>IF      13794>>ASSIGN  13799>>ASSIGN  13812>>IF
JP_CONTINUE.REC_NUM
     12706**DCL     13785>>DOINDEX 13786>>IF      13814>>ASSIGN  13817>>ASSIGN
K
     13397**DCL     13785<<DOINDEX 13786>>IF      13788>>ASSIGN  13788>>ASSIGN  13788>>ASSIGN  13790>>IF
     13790>>IF      13793>>ASSIGN  13794>>ASSIGN  13795>>IF      13799>>ASSIGN  13801>>ASSIGN  13812>>IF
     13812>>IF      13814<<ASSIGN
K IN PROCEDURE PROCESS_OPTS
     13917**DCL     14024<<DOINDEX 14025>>DOCASE  14027>>ASSIGN  14062>>ASSIGN  14064>>CALLBLT 14064>>CALLBLT
KL_DREC
     11823**DCL     12994--DCLINIT 12995--DCLINIT
KL_DREC.FLAGS.BATOK
     11845**DCL     13835>>IF
KL_DREC.PASSWORD
     11881**DCL     11885--REDEF   13890>>IF
KL_DREC.RENAME
     11904**DCL     11905--REDEF
LEGAL_LENGTH.LEN
     13393**DCL     13736>>IF
LOGON_LEN IN PROCEDURE SECLOG
     14136**DCL     16555<<ASSIGN  16561>>IF      16567>>IF      16568>>ASSIGN
LOG_IT IN PROCEDURE SECLOG
     16577**LABEL   16553--CALLALT 16576--CALLALT
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:133  
LO_WSN
     12459**DCL     13769<<ASSIGN  13773<<ASSIGN  13949<<ASSIGN
M$DEQ
      1649**DCL-ENT 16897--CALL    16906--CALL
M$EI$
     11551**DCL     13803>>ASSIGN  13807>>IF
M$ENQ
      1648**DCL-ENT 16895--CALL
M$OPEN
      1582**DCL-ENT 13764--CALL    13775--CALL
M$PRECORD
      1586**DCL-ENT 13802--CALL    13818--CALL
M$READ
      1583**DCL-ENT 13874--CALL    13875--CALL    16896--CALL
M$TIME
      1649**DCL-ENT 13966--CALL    13994--CALL
M$WRITE
      1583**DCL-ENT 13804--CALL    16905--CALL
M$WRSYSLOG
      1631**DCL-ENT 16584--CALL
OPEN_LO
     12776**DCL     13764<>CALL    13775<>CALL
OPEN_LO.ACSVEH_
     12778**DCL     12779--REDEF
OPEN_LO.ALTKEYS_
     12784**DCL     12785--REDEF   12785--REDEF
OPEN_LO.HDR_
     12783**DCL     12784--REDEF
OPEN_LO.TAB_
     12782**DCL     12783--REDEF
OPEN_LO.UHL_
     12776**DCL     12777--REDEF   12777--REDEF
OPEN_LO.V.FSN#
     12816**DCL     12816--REDEF   12816--REDEF
OPEN_LO.V.OPER.TEST#
     12787**DCL     13759<<ASSIGN  13761<<ASSIGN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:134  
OPEN_LO.WSN_
     12782**DCL     12782--REDEF
P$
     13398**DCL     13688<<ASSIGN  13689>>ASSIGN  13690>>ASSIGN  13690>>ASSIGN  13923<<ASSIGN  13924>>DOCASE
     13928>>CALLBLT 13928>>CALLBLT 13938>>ASSIGN  13948>>ASSIGN  13948>>ASSIGN  13953>>ASSIGN  13953>>ASSIGN
     13967>>DOINDEX 13968>>ASSIGN  14002>>IF      14008>>IF      14018>>ASSIGN  14020>>ASSIGN
P$ IN PROCEDURE SECLOG
     14135**DCL     16556<<ASSIGN  16557>>CALLBLT 16557>>CALLBLT 16557>>CALLBLT 16557>>CALLBLT 16559>>ASSIGN
     16559>>ASSIGN  16561>>IF      16562>>CALLBLT 16562>>CALLBLT 16564>>ASSIGN
P$B.CODE
     13187**DCL     13668>>IF      13678>>IF      13732>>IF      13924>>DOCASE  13969>>IF      14025>>DOCASE
     14028>>IF      14062>>ASSIGN
P$B.NSUBLKS
     13191**DCL     13667>>DOINDEX 13678>>IF      13684>>IF      13732>>IF      13735>>DOINDEX 13922>>DOINDEX
     13967>>DOINDEX 14002>>IF      14008>>IF      14018>>ASSIGN  14024>>DOINDEX 14037>>IF      16561>>IF
P$B.SUBLK$
     13212**DCL     13668>>IF      13678>>IF      13681>>ASSIGN  13681>>ASSIGN  13681>>ASSIGN  13681>>ASSIGN
     13682>>ASSIGN  13682>>ASSIGN  13682>>ASSIGN  13682>>ASSIGN  13684>>IF      13688>>ASSIGN  13688>>ASSIGN
     13732>>IF      13735>>DOINDEX 13736>>IF      13736>>IF      13923>>ASSIGN  13968>>ASSIGN  13972>>CALLBLT
     13972>>CALLBLT 13972>>CALLBLT 13972>>CALLBLT 13976>>ASSIGN  13976>>ASSIGN  13982>>CALLBLT 13982>>CALLBLT
     13982>>CALLBLT 13982>>CALLBLT 13982>>CALLBLT 13982>>CALLBLT 13988>>ASSIGN  13988>>ASSIGN  13988>>ASSIGN
     14020>>ASSIGN  14025>>DOCASE  14027>>ASSIGN  14028>>IF      14031>>CALLBLT 14031>>CALLBLT 14036>>ASSIGN
     14036>>ASSIGN  14039>>ASSIGN  14039>>ASSIGN  14062>>ASSIGN  14062>>ASSIGN  14064>>CALLBLT 14064>>CALLBLT
     14064>>CALLBLT 14064>>CALLBLT 16556>>ASSIGN  16557>>CALLBLT 16557>>CALLBLT 16557>>CALLBLT 16557>>CALLBLT
     16559>>ASSIGN  16559>>ASSIGN  16562>>CALLBLT 16562>>CALLBLT 16564>>ASSIGN
P$S.COUNT
     13248**DCL     13251--IMP-SIZ 13681>>ASSIGN  13682>>ASSIGN  13690>>ASSIGN  13736>>IF      13928>>CALLBLT
     13948>>ASSIGN  13953>>ASSIGN  13972>>CALLBLT 13972>>CALLBLT 13976>>ASSIGN  13976>>ASSIGN  13982>>CALLBLT
     13982>>CALLBLT 13982>>CALLBLT 13988>>ASSIGN  13988>>ASSIGN  13988>>ASSIGN  14031>>CALLBLT 14036>>ASSIGN
     14039>>ASSIGN  14064>>CALLBLT 16557>>CALLBLT 16557>>CALLBLT 16559>>ASSIGN  16559>>ASSIGN  16562>>CALLBLT
     16564>>ASSIGN
P$S.CPOS
     13240**DCL     13689>>ASSIGN  13938>>ASSIGN  14046>>ASSIGN
P$S.TEXT
     13251**DCL     13681>>ASSIGN  13682>>ASSIGN  13690>>ASSIGN  13928>>CALLBLT 13948>>ASSIGN  13953>>ASSIGN
     13972>>CALLBLT 13972>>CALLBLT 13982>>CALLBLT 13982>>CALLBLT 13982>>CALLBLT 14031>>CALLBLT 14036>>ASSIGN
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:135  
     14039>>ASSIGN  14064>>CALLBLT 16557>>CALLBLT 16557>>CALLBLT 16562>>CALLBLT
PASSWORD_OK#
     11982**DCL     13885<<ASSIGN  13890>>IF      13900<<ASSIGN
PASS_POS
     13404**DCL     13689<<ASSIGN  13693>>ASSIGN  13811>>ASSIGN  13812>>IF
PASS_SPECIFIED#
     13407**DCL     13687<<ASSIGN  13782>>IF      13881>>IF
PASS_TWO#
     11983**DCL     13731>>IF      13757>>IF      13892>>IF      13909>>IF
PCB
     12506**DCL     13662<>CALL    13663<>CALL
PCB.CONTINUE
     12547**DCL     13661<<ASSIGN
PCB.ERROR
     12610**DCL     13724<>CALL
PCB.HI_CHAR
     12657**DCL     13724<>CALL
PCB.NCHARS
     12653**DCL     13657<<ASSIGN  13657>>ASSIGN
PCB.OUT$
     12519**DCL     13656<<ASSIGN  13667>>DOINDEX 13668>>IF      13678>>IF      13678>>IF      13681>>ASSIGN
     13681>>ASSIGN  13682>>ASSIGN  13682>>ASSIGN  13684>>IF      13688>>ASSIGN  13732>>IF      13732>>IF
     13735>>DOINDEX 13736>>IF      13922>>DOINDEX 13923>>ASSIGN  16556>>ASSIGN
PCB.ROOT$
     12511**DCL     13662<>CALL
PCB.TEXT$
     12507**DCL     13694>>DOUNTIL 13699>>IF      13701>>DOUNTIL 13705>>ASSIGN  13793>>ASSIGN  13798>>ASSIGN
PCB.U$$
     12524**DCL     13660<<ASSIGN
PROCESS_JOB
     13829**PROC    13729--CALL
PROCESS_OPTS IN PROCEDURE PROCESS_JOB
     13914**PROC    13854--CALL
RD_ALT IN PROCEDURE GET_USERS
     13906**LABEL   13874--CALLALT 13875--CALLALT
READ_CARD.STATION_
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:136  
     11530**DCL     11531--REDEF
READ_CARD.V.DVBYTE.REREAD#
     11542**DCL     11542--REDEF
READ_CARD.V.INDX#
     11540**DCL     11540--REDEF
READ_HLP
     12992**DCL     13875<>CALL
READ_HLP.STATION_
     12995**DCL     12996--REDEF
READ_HLP.V
     12996**DCL     12992--DCLINIT
READ_HLP.V.DVBYTE.REREAD#
     13007**DCL     13007--REDEF
READ_HLP.V.INDX#
     13005**DCL     13005--REDEF
READ_USERS
     12949**DCL     13874<>CALL
READ_USERS.STATION_
     12952**DCL     12953--REDEF
READ_USERS.V
     12953**DCL     12949--DCLINIT
READ_USERS.V.DVBYTE.REREAD#
     12964**DCL     12964--REDEF
READ_USERS.V.INDX#
     12962**DCL     12962--REDEF
READ_USERS_SEC IN PROCEDURE UPD_USERS
     16790**DCL     16896<>CALL
READ_USERS_SEC.STATION_ IN PROCEDURE UPD_USERS
     16793**DCL     16794--REDEF
READ_USERS_SEC.V IN PROCEDURE UPD_USERS
     16794**DCL     16790--DCLINIT
READ_USERS_SEC.V.DVBYTE.REREAD# IN PROCEDURE UPD_USERS
     16805**DCL     16805--REDEF
READ_USERS_SEC.V.INDX# IN PROCEDURE UPD_USERS
     16803**DCL     16803--REDEF
REASON IN PROCEDURE SECLOG
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:137  
     14134**DCL     14094--PROC    16520>>ASSIGN  16548>>DOCASE
REASON IN PROCEDURE UPD_USERS
     16590**DCL     16588--PROC    16891>>IF      16900>>IF
SAVE_ERR
     13406**DCL     13774<<ASSIGN  13776<>CALL
SAVE_UPASS
     13403**DCL     13691<<ASSIGN  16575>>ASSIGN
SCAN_CMDS#
     11981**DCL     13670<<ASSIGN  13951<<ASSIGN
SECLOG
     14094**PROC    13740--CALL    13894--CALL    13910--CALL    16936--CALL
T$
     13399**DCL     13968<<ASSIGN  13969>>IF      13972>>CALLBLT 13972>>CALLBLT 13972>>CALLBLT 13972>>CALLBLT
     13976>>ASSIGN  13976>>ASSIGN  13982>>CALLBLT 13982>>CALLBLT 13982>>CALLBLT 13982>>CALLBLT 13982>>CALLBLT
     13982>>CALLBLT 13988>>ASSIGN  13988>>ASSIGN  13988>>ASSIGN  14020<<ASSIGN  14024>>DOINDEX 14025>>DOCASE
     14027>>ASSIGN  14062>>ASSIGN  14064>>CALLBLT 14064>>CALLBLT
T$BUF
     13256**DCL     13694>>DOUNTIL 13699>>IF      13701>>DOUNTIL 13705<<ASSIGN
T2$
     13400**DCL     14027<<ASSIGN  14028>>IF      14031>>CALLBLT 14031>>CALLBLT 14036>>ASSIGN  14036>>ASSIGN
     14037>>IF      14039>>ASSIGN  14039>>ASSIGN  14046>>ASSIGN
TEMP IN PROCEDURE PROCESS_OPTS
     13918**DCL     13928<<CALLBLT 13929>>ASSIGN  13932<<ASSIGN  13934<<ASSIGN  13935>>IF      13938<<ASSIGN
     13939<>CALL    13954<<CALLBLT 13955>>ASSIGN  14031<<CALLBLT 14032>>ASSIGN  14046<<ASSIGN  14049<>CALL
     14064<<CALLBLT 14066>>ASSIGN
TODAYS_DATE
     12899**DCL     13966<>CALL
TODAYS_DATE.V
     12903**DCL     12899--DCLINIT
U$PARAM.CNTU$$
     12692**DCL     13658<<ASSIGN
U$PARAM.REMEM_CONTEXT_ERR$
     12702**DCL     13659<<ASSIGN
U$PARAM.SPCL$$
     12693**DCL     13662<>CALL
UKEY
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:138  
     13365**DCL     12949--DCLINIT 12950--DCLINIT 12992--DCLINIT 12993--DCLINIT 16790--DCLINIT 16791--DCLINIT
     16832--DCLINIT 16860--DCLINIT
UKEY.KEY
     13367**DCL     13370--REDEF   13645--ASSIGN  13683--ASSIGN  13719--ASSIGN
UKEY.KEY.ACCN
     13368**DCL     13643<<ASSIGN  13681<<ASSIGN  13717<<ASSIGN  13762>>ASSIGN  13830>>ASSIGN  13833>>ASSIGN
     13861>>ASSIGN  13881>>IF
UKEY.KEY.UNAME
     13369**DCL     13644<<ASSIGN  13682<<ASSIGN  13718<<ASSIGN  13763>>ASSIGN  13831>>ASSIGN  13834>>ASSIGN
     13862>>ASSIGN  13881>>IF
UKEY.KEY_ARY
     13370**DCL     13871>>DOWHILE
UKEY.LEN
     13366**DCL     13645<<ASSIGN  13647<<ASSIGN  13683<<ASSIGN  13719<<ASSIGN  13727>>IF      13871>>DOWHILE
     13872<<ASSIGN  13872>>ASSIGN
UPASS
     13402**DCL     13642<<ASSIGN  13646<>CALL    13690<<ASSIGN  13691>>ASSIGN  13692<>CALL    13890>>IF
UPD_USERS
     16588**PROC    13895--CALL    16553--CALL    16576--CALL    16937--CALL
VAR$CHAR IN PROCEDURE PROCESS_OPTS
     13920**DCL     13978--ASSIGN  13991--ASSIGN
VAR_LEN IN PROCEDURE PROCESS_OPTS
     13919**DCL     13920--IMP-SIZ 13976<<ASSIGN  13978>>ASSIGN  13988<<ASSIGN  13991>>ASSIGN
WRITE_USERS_SEC IN PROCEDURE UPD_USERS
     16832**DCL     16905<>CALL
WRITE_USERS_SEC.STATION_ IN PROCEDURE UPD_USERS
     16834**DCL     16834--REDEF
WRITE_USERS_SEC.V IN PROCEDURE UPD_USERS
     16835**DCL     16832--DCLINIT
WRITE_USERS_SEC.V.DVBYTE.VFC# IN PROCEDURE UPD_USERS
     16841**DCL     16841--REDEF
WR_SECLOG IN PROCEDURE SECLOG
     15100**DCL     16584<>CALL
WR_SECLOG.V IN PROCEDURE SECLOG
     15100**DCL     15100--DCLINIT
X$PARSE
PL6.E3A0      #001=JPJ$JOB File=JPJ$JOB.:E05TSI                                  TUE 07/29/97 23:36 Page:139  
     12454**DCL-ENT 13663--CALL
XSJ$READ
     12455**DCL-ENT 14043--CALL
XSJ$WRITE
     12456**DCL-ENT 14083--CALL
XSJ_ALT1 IN PROCEDURE PROCESS_OPTS
     14046**LABEL   14043--CALLALT
XSJ_ALT2 IN PROCEDURE PROCESS_OPTS
     14086**LABEL   14052--GOTO    14083--CALLALT
XSJ_PARAM
     13383**DCL     14043<>CALL    14083<>CALL
XSJ_PARAM.BUF_
     13383**DCL     14042<<ASSIGN  14082<<ASSIGN
