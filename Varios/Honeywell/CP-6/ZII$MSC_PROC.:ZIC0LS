
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ZII$READ_SS: PROC ALTRET AVOID($PR5,$PR6,$PR7);
        7        7        /*****************Ext dcls******************/
        8        8    1   DCL I_O_IDX UBIN(36) EXT;
        9        9    1   DCL I_O_BUF CHAR(256) EXT;
       10       10    1   DCL ZI$KEY_NUMBER UBIN(36) EXT;
       11       11    1   DCL 1 TMP_KEY EXT,
       12       12    1         2 LEN UBIN(9) UNAL,
       13       13    1         2 ACT_KEY UBIN(27) UNAL;
       14       14    1   DCL ERROR_CODE UBIN(36) EXT;
       15       15    1   DCL 1 SUBSCH EXT,
       16       16    1         2 NAME,
       17       17    1           3 CNT UBIN(9) UNAL,
       18       18    1           3 TEXT CHAR(32) UNAL,
       19       19    1         2 DCB# UBIN(18) ALIGNED;
       20       20        /****************Include files**************/
       21       21        %INCLUDE CP_6;
       22      102        %INCLUDE CP_6_SUBS;
       23      642        %FPT_READ(FPTN=READ_FPT,KEYS=YES,BUF=I_O_BUF,KEY=TMP_KEY);
       24      681        %FPT_OPEN(FPTN=OPEN_FPT,FUN=IN,ORG=KEYED,ACS=DIRECT,ASN=FILE,SETDCB=YES,SHARE=IN);
       25      790        %FPT_OPEN(FPTN=RES_FPT,REASSIGN=YES,SETDCB=NO);
       26      899        %F$DCB;
       27      956        %INCLUDE ZI_ERRORS_SUBS;
       28     1476        /****************Program procedure********/
       29     1477    1       IF DCBADDR(SUBSCH.DCB#)->F$DCB.FCD#=%NO# THEN
       30     1478    2       DO;
       31     1479    2           OPEN_FPT.V.DCB#=SUBSCH.DCB#;
       32     1480    2           CALL M$OPEN(OPEN_FPT) ALTRET(ER_OPEN);
       33     1481    2           RES_FPT.V.DCB#=SUBSCH.DCB#;
       34     1482    2           CALL M$OPEN(RES_FPT) ALTRET(ER_OPEN);
       35     1483    2           END;
       36     1484    1       IF I_O_IDX>=2 THEN
       37     1485    2       DO;
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:2    
       38     1486    2           ZI$KEY_NUMBER=ZI$KEY_NUMBER+1;
       39     1487    2           I_O_IDX=0;
       40     1488    2           TMP_KEY.ACT_KEY=ZI$KEY_NUMBER;
       41     1489    2           TMP_KEY.LEN=3;
       42     1490    2           READ_FPT.V.DCB#=SUBSCH.DCB#;
       43     1491    2           CALL M$READ(READ_FPT) ALTRET(ER_READ);
       44     1492    2           END;
       45     1493    1   RET:
       46     1494    1       RETURN;
       47     1495    1   ER_READ:
       48     1496        /************************************************************/
       49     1497        /*E*
       50     1498           ERROR: ZII-#BADREAD-C
       51     1499           MESSAGE: Cannot read subschema %U1.
       52     1500        */
       53     1501        /************************************************************/
       54     1502    1       ERROR_CODE=#BADREAD;
       55     1503    1       GOTO COM_ERR;
       56     1504    1   ER_OPEN:
       57     1505        /***********************************************************/
       58     1506        /*
       59     1507           ERROR: ZII-#OPNER-C
       60     1508        MESSAGE:  Cannot open the subschema %U1.
       61     1509        */
       62     1510        /*************************************************************/
       63     1511    1       ERROR_CODE = #OPNER;
       64     1512    1       GOTO COM_ERR;
       65     1513    1   COM_ERR:
       66     1514    1       ALTRETURN;
       67     1515    1   END ZII$READ_SS;
       68     1516        %EOD;

PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:3    
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$READ_SS.

   Procedure ZII$READ_SS requires 44 words for executable code.
   Procedure ZII$READ_SS requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:4    

 Object Unit name= ZII$READ_SS                                File name= ZII$MSC_PROC.:ZIC0TOU
 UTS= SEP 05 '97 12:29:45.44 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  I_O_IDX
    1  LblCom even  none    64    100  I_O_BUF
    2  LblCom even  none     1      1  ZI$KEY_NUMBER
    3  LblCom even  none     1      1  TMP_KEY
    4  LblCom even  none     1      1  ERROR_CODE
    5  LblCom even  none    10     12  SUBSCH
    6   DCB   even  none     0      0  M$UC
    7   Data  even  none   130    202  ZII$READ_SS
    8   Proc  even  none    44     54  ZII$READ_SS
    9  RoData even  none     1      1  ZII$READ_SS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes    yes     yes      XStd       0  ZII$READ_SS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:5    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:6    


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ZII$READ_SS: PROC ALTRET AVOID($PR5,$PR6,$PR7);

      6  8 000000   000000 700200 xent  ZII$READ_SS  TSX0  ! X66_AUTO_0
         8 000001   000004 000000                    ZERO    4,0

        7        7        /*****************Ext dcls******************/
        8        8    1   DCL I_O_IDX UBIN(36) EXT;
        9        9    1   DCL I_O_BUF CHAR(256) EXT;
       10       10    1   DCL ZI$KEY_NUMBER UBIN(36) EXT;
       11       11    1   DCL 1 TMP_KEY EXT,
       12       12    1         2 LEN UBIN(9) UNAL,
       13       13    1         2 ACT_KEY UBIN(27) UNAL;
       14       14    1   DCL ERROR_CODE UBIN(36) EXT;
       15       15    1   DCL 1 SUBSCH EXT,
       16       16    1         2 NAME,
       17       17    1           3 CNT UBIN(9) UNAL,
       18       18    1           3 TEXT CHAR(32) UNAL,
       19       19    1         2 DCB# UBIN(18) ALIGNED;
       20       20        /****************Include files**************/
       21       21        %INCLUDE CP_6;
       22      102        %INCLUDE CP_6_SUBS;
       23      642        %FPT_READ(FPTN=READ_FPT,KEYS=YES,BUF=I_O_BUF,KEY=TMP_KEY);
       24      681        %FPT_OPEN(FPTN=OPEN_FPT,FUN=IN,ORG=KEYED,ACS=DIRECT,ASN=FILE,SETDCB=YES,SHARE=IN);
       25      790        %FPT_OPEN(FPTN=RES_FPT,REASSIGN=YES,SETDCB=NO);
       26      899        %F$DCB;
       27      956        %INCLUDE ZI_ERRORS_SUBS;
       28     1476        /****************Program procedure********/
       29     1477    1       IF DCBADDR(SUBSCH.DCB#)->F$DCB.FCD#=%NO# THEN

   1477  8 000002   000000 470400 9                  LDP0    0
         8 000003   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:7    
         8 000004   000011 220000 5                  LDX0    SUBSCH+9
         8 000005   100000 473510                    LDP3    0,X0,PR1
         8 000006   300031 236100                    LDQ     25,,PR3
         8 000007   020000 316007                    CANQ    8192,DL
         8 000010   000024 601000 8                  TNZ     s:1484

       30     1478    2       DO;

       31     1479    2           OPEN_FPT.V.DCB#=SUBSCH.DCB#;

   1479  8 000011   000062 740000 7                  STX0    OPEN_FPT+36

       32     1480    2           CALL M$OPEN(OPEN_FPT) ALTRET(ER_OPEN);

   1480  8 000012   000016 630400 7                  EPPR0   OPEN_FPT
         8 000013   450000 713400                    CLIMB   alt,open
         8 000014   410400 401760                    pmme    nvectors=18
         8 000015   000050 702000 8                  TSX2    ER_OPEN

       33     1481    2           RES_FPT.V.DCB#=SUBSCH.DCB#;

   1481  8 000016   000011 220000 5                  LDX0    SUBSCH+9
         8 000017   000154 740000 7                  STX0    RES_FPT+36

       34     1482    2           CALL M$OPEN(RES_FPT) ALTRET(ER_OPEN);

   1482  8 000020   000110 630400 7                  EPPR0   RES_FPT
         8 000021   450000 713400                    CLIMB   alt,open
         8 000022   410400 401760                    pmme    nvectors=18
         8 000023   000050 702000 8                  TSX2    ER_OPEN

       35     1483    2           END;

       36     1484    1       IF I_O_IDX>=2 THEN

   1484  8 000024   000000 235000 0                  LDA     I_O_IDX
         8 000025   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:8    
         8 000026   000044 602000 8                  TNC     RET

       37     1485    2       DO;

       38     1486    2           ZI$KEY_NUMBER=ZI$KEY_NUMBER+1;

   1486  8 000027   000000 236000 2                  LDQ     ZI$KEY_NUMBER
         8 000030   000001 036007                    ADLQ    1,DL
         8 000031   000000 756000 2                  STQ     ZI$KEY_NUMBER

       39     1487    2           I_O_IDX=0;

   1487  8 000032   000000 450000 0                  STZ     I_O_IDX

       40     1488    2           TMP_KEY.ACT_KEY=ZI$KEY_NUMBER;

   1488  8 000033   000000 552034 3                  STBQ    TMP_KEY,'34'O

       41     1489    2           TMP_KEY.LEN=3;

   1489  8 000034   003000 236003                    LDQ     1536,DU
         8 000035   000000 552040 3                  STBQ    TMP_KEY,'40'O

       42     1490    2           READ_FPT.V.DCB#=SUBSCH.DCB#;

   1490  8 000036   000011 220000 5                  LDX0    SUBSCH+9
         8 000037   000010 740000 7                  STX0    READ_FPT+8

       43     1491    2           CALL M$READ(READ_FPT) ALTRET(ER_READ);

   1491  8 000040   000000 630400 7                  EPPR0   READ_FPT
         8 000041   440000 713400                    CLIMB   alt,read
         8 000042   401400 401760                    pmme    nvectors=4
         8 000043   000045 702000 8                  TSX2    ER_READ

       44     1492    2           END;

PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:9    
       45     1493    1   RET:
       46     1494    1       RETURN;

   1494  8 000044   000000 702200 xent  RET          TSX2  ! X66_ARET

       47     1495    1   ER_READ:
       48     1496        /************************************************************/
       49     1497        /*E*
       50     1498           ERROR: ZII-#BADREAD-C
       51     1499           MESSAGE: Cannot read subschema %U1.
       52     1500        */
       53     1501        /************************************************************/
       54     1502    1       ERROR_CODE=#BADREAD;

   1502  8 000045   011610 235007       ER_READ      LDA     5000,DL
         8 000046   000000 755000 4                  STA     ERROR_CODE

       55     1503    1       GOTO COM_ERR;

   1503  8 000047   000053 710000 8                  TRA     COM_ERR

       56     1504    1   ER_OPEN:
       57     1505        /***********************************************************/
       58     1506        /*
       59     1507           ERROR: ZII-#OPNER-C
       60     1508        MESSAGE:  Cannot open the subschema %U1.
       61     1509        */
       62     1510        /*************************************************************/
       63     1511    1       ERROR_CODE = #OPNER;

   1511  8 000050   011612 235007       ER_OPEN      LDA     5002,DL
         8 000051   000000 755000 4                  STA     ERROR_CODE

       64     1512    1       GOTO COM_ERR;

   1512  8 000052   000053 710000 8                  TRA     COM_ERR

PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:10   
       65     1513    1   COM_ERR:
       66     1514    1       ALTRETURN;

   1514  8 000053   000000 702200 xent  COM_ERR      TSX2  ! X66_AALT

I_O_BUF
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SUBSCH
 Sect OctLoc
   5     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

READ_FPT
 Sect OctLoc
   7     000   000005 777640   000010 006000   000000 777640   000000 006000    ................
   7     004   000077 777640   000000 006000   000000 177640   000000 006014    .?..............
   7     010   000000 600000   000000 000000   000000 000000   000000 000000    ................
   7     014   000000 000000   000000 000000                                    ........

OPEN_FPT
 Sect OctLoc
   7     016   000025 777640   000062 006000   000000 177640   000000 006014    .....2..........
   7     022   000000 177640   000000 006014   000000 177640   000000 006014    ................
   7     062*  000000 100062   000000 002001   252525 002002   000040 252520    ..@2......... ..
   7     066   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   7     072   000000 000000   000000 000000   000000 000000   000000 000000    ................
   7     076   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   7     102   040040 040040   000000 000000   000000 000000   000000 000000        ............
   7     106   000000 000000   ****** ******                                    ........

RES_FPT
 Sect OctLoc
   7     110   000025 777640   000154 006000   000000 177640   000000 006014    .....l..........
   7     114   000000 177640   000000 006014   000000 177640   000000 006014    ................
   7     154*  000000 200042   000000 000000   252525 000000   000040 252520    ..."......... ..
   7     160   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:11   
   7     164   000000 000000   000000 000000   000000 000000   000000 000000    ................
   7     170   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   7     174   040040 040040   000000 000000   000000 000000   000000 000000        ............
   7     200   000000 000000   ****** ******                                    ........

(unnamed)
 Sect OctLoc
   9     000   000000 006003                                                    ....
       67     1515    1   END ZII$READ_SS;
       68     1516        %EOD;

PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:12   
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$READ_SS.

   Procedure ZII$READ_SS requires 44 words for executable code.
   Procedure ZII$READ_SS requires 4 words of local(AUTO) storage.
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:13   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:14   
          MINI XREF LISTING

COM_ERR
      1514**LABEL    1503--GOTO     1512--GOTO
ERROR_CODE
        14**DCL      1502<<ASSIGN   1511<<ASSIGN
ER_OPEN
      1511**LABEL    1480--CALLALT  1482--CALLALT
ER_READ
      1502**LABEL    1491--CALLALT
F$DCB.ACTPOS
       932**DCL       932--REDEF
F$DCB.ARS#
       906**DCL       906--REDEF
F$DCB.ATTR
       925**DCL       926--REDEF
F$DCB.BORROW
       940**DCL       940--REDEF     940--REDEF     940--REDEF
F$DCB.DCBNAME.L
       954**DCL       954--IMP-SIZ
F$DCB.EOMCHAR#
       910**DCL       910--REDEF
F$DCB.FCD#
       919**DCL      1477>>IF
F$DCB.FLDID
       935**DCL       935--REDEF
F$DCB.FORM$
       929**DCL       929--REDEF
F$DCB.FSECT
       945**DCL       945--REDEF
F$DCB.FSN#
       922**DCL       922--REDEF     922--REDEF     923--REDEF
F$DCB.HEADER$
       928**DCL       928--REDEF
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:15   
F$DCB.IXTNSIZE#
       926**DCL       926--REDEF
F$DCB.LASTSTA$
       915**DCL       915--REDEF
F$DCB.LVL
       941**DCL       941--REDEF
F$DCB.NAME#.C
       916**DCL       916--REDEF
F$DCB.NOEOF
       938**DCL       938--REDEF
F$DCB.NRECS#
       927**DCL       927--REDEF
F$DCB.NRECX
       946**DCL       946--REDEF
F$DCB.OHDR
       938**DCL       938--REDEF
F$DCB.ORG#
       921**DCL       921--REDEF
F$DCB.PRECNO
       944**DCL       944--REDEF
F$DCB.RCSZ
       950**DCL       950--REDEF
F$DCB.RES#
       917**DCL       917--REDEF
F$DCB.SETX
       929**DCL       929--REDEF
F$DCB.TAB$
       929**DCL       929--REDEF
F$DCB.TDA
       943**DCL       944--REDEF
F$DCB.WSN#
       917**DCL       917--REDEF
I_O_BUF
         9**DCL       661--DCLINIT   662--DCLINIT
I_O_IDX
         8**DCL      1484>>IF       1487<<ASSIGN
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:16   
M$OPEN
        30**DCL-ENT  1480--CALL     1482--CALL
M$READ
        31**DCL-ENT  1491--CALL
OPEN_FPT
       746**DCL      1480<>CALL
OPEN_FPT.ACSVEH_
       748**DCL       749--REDEF
OPEN_FPT.ALTKEYS_
       754**DCL       755--REDEF     755--REDEF
OPEN_FPT.HDR_
       753**DCL       754--REDEF
OPEN_FPT.TAB_
       752**DCL       753--REDEF
OPEN_FPT.UHL_
       746**DCL       747--REDEF     747--REDEF
OPEN_FPT.V
       755**DCL       746--DCLINIT
OPEN_FPT.V.DCB#
       755**DCL      1479<<ASSIGN
OPEN_FPT.V.FSN#
       786**DCL       786--REDEF     786--REDEF
OPEN_FPT.WSN_
       752**DCL       752--REDEF
READ_FPT
       659**DCL      1491<>CALL
READ_FPT.STATION_
       662**DCL       663--REDEF
READ_FPT.V
       663**DCL       659--DCLINIT
READ_FPT.V.DCB#
       663**DCL      1490<<ASSIGN
READ_FPT.V.DVBYTE.REREAD#
       674**DCL       674--REDEF
READ_FPT.V.INDX#
       672**DCL       672--REDEF
PL6.E3A0      #001=ZII$READ_SS File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:29 Page:17   
RES_FPT
       855**DCL      1482<>CALL
RES_FPT.ACSVEH_
       857**DCL       858--REDEF
RES_FPT.ALTKEYS_
       863**DCL       864--REDEF     864--REDEF
RES_FPT.HDR_
       862**DCL       863--REDEF
RES_FPT.TAB_
       861**DCL       862--REDEF
RES_FPT.UHL_
       855**DCL       856--REDEF     856--REDEF
RES_FPT.V
       864**DCL       855--DCLINIT
RES_FPT.V.DCB#
       864**DCL      1481<<ASSIGN
RES_FPT.V.FSN#
       895**DCL       895--REDEF     895--REDEF
RES_FPT.WSN_
       861**DCL       861--REDEF
SUBSCH.DCB#
        19**DCL      1477--IF       1479>>ASSIGN   1481>>ASSIGN   1490>>ASSIGN
TMP_KEY
        11**DCL       659--DCLINIT   660--DCLINIT
TMP_KEY.ACT_KEY
        13**DCL      1488<<ASSIGN
TMP_KEY.LEN
        12**DCL      1489<<ASSIGN
ZI$KEY_NUMBER
        10**DCL      1486<<ASSIGN   1486>>ASSIGN   1488>>ASSIGN

PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:18   
       69        1        /*T***********************************************************/
       70        2        /*T*                                                         */
       71        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       72        4        /*T*                                                         */
       73        5        /*T***********************************************************/
       74        6        %EJECT;
PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:19   
       75        7        ZII$HASH: PROC(ARG1,ENTRIES#,HASH_VAL) AVOID($PR5,$PR6,$PR7);
       76        8        /*******************Parameters***************/
       77        9    1   DCL ARG1 (0:7) UBIN;
       78       10    1   DCL ENTRIES# UBIN(36); /* # of prime number slots for  hash val divider*/
       79       11    1   DCL HASH_VAL UBIN(36) ;
       80       12        /*******************Program procedure*********/
       81       13    1       HASH_VAL=MOD(
       82       14    1          BITBIN(BINBIT(
       83       15    1          ARG1(0)+ARG1(1)+ARG1(2)+ARG1(3)+ARG1(4)+ARG1(5)+ARG1(6)+ARG1(7)
       84       16    1          ,36) & '377777777777'O)
       85       17    1          ,ENTRIES#);
       86       18    1   RET:
       87       19    1       RETURN;
       88       20    1   END ZII$HASH;
       89       21        %EOD;

PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:20   
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$HASH.

   Procedure ZII$HASH requires 34 words for executable code.
   Procedure ZII$HASH requires 6 words of local(AUTO) storage.

PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:21   

 Object Unit name= ZII$HASH                                   File name= ZII$MSC_PROC.:ZIC0TOU
 UTS= SEP 05 '97 12:30:04.60 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  ZII$HASH
    1   Proc  even  none    34     42  ZII$HASH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       3  ZII$HASH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:22   


       69        1        /*T***********************************************************/
       70        2        /*T*                                                         */
       71        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       72        4        /*T*                                                         */
       73        5        /*T***********************************************************/
       74        6        %EJECT;
PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:23   
       75        7        ZII$HASH: PROC(ARG1,ENTRIES#,HASH_VAL) AVOID($PR5,$PR6,$PR7);

      7  1 000000   000000 700200 xent  ZII$HASH     TSX0  ! X66_AUTO_3
         1 000001   000006 000003                    ZERO    6,3

       76        8        /*******************Parameters***************/
       77        9    1   DCL ARG1 (0:7) UBIN;
       78       10    1   DCL ENTRIES# UBIN(36); /* # of prime number slots for  hash val divider*/
       79       11    1   DCL HASH_VAL UBIN(36) ;
       80       12        /*******************Program procedure*********/
       81       13    1       HASH_VAL=MOD(

     13  1 000002   200003 470500                    LDP0    @ARG1,,AUTO
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000001 036100                    ADLQ    1,,PR0
         1 000005   000002 036100                    ADLQ    2,,PR0
         1 000006   000003 036100                    ADLQ    3,,PR0
         1 000007   000004 036100                    ADLQ    4,,PR0
         1 000010   000005 036100                    ADLQ    5,,PR0
         1 000011   000006 036100                    ADLQ    6,,PR0
         1 000012   000007 036100                    ADLQ    7,,PR0
         1 000013   000000 376000 0                  ANQ     0
         1 000014   200004 471500                    LDP1    @ENTRIES#,,AUTO
         1 000015   000032 605000 1                  TPL     s:13+24
         1 000016   100000 235100                    LDA     0,,PR1
         1 000017   000026 604000 1                  TMI     s:13+20
         1 000020   000001 115007                    CMPA    1,DL
         1 000021   000034 600000 1                  TZE     s:13+26
         1 000022   000000 235003                    LDA     0,DU
         1 000023   000001 737000                    LLS     1
         1 000024   100000 507100                    DVF     0,,PR1
         1 000025   000034 710000 1                  TRA     s:13+26
         1 000026   100000 116100                    CMPQ    0,,PR1
         1 000027   000034 604000 1                  TMI     s:13+26
         1 000030   100000 136100                    SBLQ    0,,PR1
         1 000031   000034 710000 1                  TRA     s:13+26
         1 000032   100000 235100                    LDA     0,,PR1
PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:24   
         1 000033   000036 605000 1                  TPL     s:13+28
         1 000034   000044 737000                    LLS     36
         1 000035   000037 710000 1                  TRA     s:13+29
         1 000036   100000 506100                    DIV     0,,PR1
         1 000037   200005 473500                    LDP3    @HASH_VAL,,AUTO
         1 000040   300000 755100                    STA     0,,PR3

       82       14    1          BITBIN(BINBIT(
       83       15    1          ARG1(0)+ARG1(1)+ARG1(2)+ARG1(3)+ARG1(4)+ARG1(5)+ARG1(6)+ARG1(7)
       84       16    1          ,36) & '377777777777'O)
       85       17    1          ,ENTRIES#);
       86       18    1   RET:
       87       19    1       RETURN;

     19  1 000041   000000 702200 xent  RET          TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   0     000   377777 777777                                                    ....
       88       20    1   END ZII$HASH;
       89       21        %EOD;

PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:25   
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$HASH.

   Procedure ZII$HASH requires 34 words for executable code.
   Procedure ZII$HASH requires 6 words of local(AUTO) storage.
PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:26   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ZII$HASH File=ZII$MSC_PROC.:ZIC0TSI                           FRI 09/05/97 12:30 Page:27   
          MINI XREF LISTING

ARG1
         9**DCL         7--PROC       13>>ASSIGN     13>>ASSIGN     13>>ASSIGN     13>>ASSIGN     13>>ASSIGN
        13>>ASSIGN     13>>ASSIGN     13>>ASSIGN
ENTRIES#
        10**DCL         7--PROC       13>>ASSIGN
HASH_VAL
        11**DCL         7--PROC       13<<ASSIGN

PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:28   
       90        1        /*T***********************************************************/
       91        2        /*T*                                                         */
       92        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       93        4        /*T*                                                         */
       94        5        /*T***********************************************************/
       95        6        %EJECT;
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:29   
       96        7        ZII$FDDESC: PROC(NAME,TYPE,DD$,FTYPE,QNAME) ALTRET AVOID($PR5,$PR6,$PR7);
       97        8        /**************************************************************
       98        9        This routine  is passed  up to 5 parameters, 3 of
       99       10        which are required( the last 2 parameters are optional).
      100       11         Name - is the  text name for which we want to find the descriptor            (requi
                11        red)
      101       12         type - is the  type of descripotr we area looking for(#area,#set,etc)        (requi
                12        red)
      102       13         DD$  - is the ptr to the descriptor  wanted(and is returned)                 (requi
                13        red)
      103       14         ftype- lets this routine what function you are doing (#STORE/#RETRIEVE)      (optio
                14        nal)
      104       15         qname- is used when you are trying to find a specific field within a record  (optio
                15        nal)
      105       16        **************************************************************/
      106       17        /*******************Parameters**************/
      107       18    1   DCL NAME CHAR(32) ALIGNED;
      108       19    1   DCL QNAME CHAR(32);
      109       20    1   DCL TYPE UBIN(36);
      110       21    1   DCL FTYPE BIT(1); /*Type of descriptor find. Value are:
      111       22         0 = retrieval
      112       23         1 = store */
      113       24        /*******************Ext dcls****************/
      114       25    1   DCL HSH_VAL UBIN(36) EXT;
      115       26    1   DCL TNAM2$ PTR EXT;
      116       27        /******************Entry dcls***************/
      117       28    1   DCL ZII$HASH ENTRY(3);
      118       29        /******************Include files************/
      119       30        %INCLUDE ZI$DESC;
      120      880        %DSC_DESC (STCLASS=);
      121      888        %DSC_FLD;
      122     1003        %TYPE_SUBS;
      123     1013        %INCLUDE ZI$STRUCTS;
      124     1085        %NAM2;
      125     1099        %NAM1;
      126     1128        /******************Program procedure**********/
      127     1129    1       CALL ZII$HASH(NAME,#ENTRY,HSH_VAL);
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:30   
      128     1130    1       IF ADDR(FTYPE) ~= ADDR(NIL) AND FTYPE = #STORE THEN
      129     1131    2       DO;
      130     1132    2           TNAM2$=PINCRW(TNAM2$,#DSC_SIZ);
      131     1133    2           IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN
      132     1134    3           DO;
      133     1135    3               DD$=TNAM2$;
      134     1136    3               NAM2.LLIST$(HSH_VAL)=TNAM2$;
      135     1137    3               IF TYPE = #FIELD THEN DD$->FIELD.SYN_NAM=#SYN_NAM_NIL;
              1137                        /*Put in the synonym thread for IDP*/
      136     1138    3               RETURN;
      137     1139    3               END;
      138     1140    3           ELSE DO;
      139     1141    3               DD$=NAM2.LLIST$(HSH_VAL);
      140     1142    4               DO WHILE(DESC.LLIST$ ~= ADDR(NIL));
      141     1143    4                   IF TYPE=#FIELD /*Hook up the field to the syn chain*/
      142     1144    4                      AND NAME = NAM1.NAME.TEXT(DESC.NAM_IDX)
      143     1145    4                      AND NAM1.TYPE(DESC.NAM_IDX)=#FIELD
      144     1146    4                      AND FIELD.SYN_NAM = #SYN_NAM_NIL THEN
      145     1147    4                       FIELD.SYN_NAM = POFFW(TNAM2$,NAM2$);
      146     1148    4                   DD$=DESC.LLIST$;
      147     1149    4                   END;
      148     1150    3               DESC.LLIST$=TNAM2$;
      149     1151    3               DD$=TNAM2$;
      150     1152    3               RETURN;
      151     1153    3               END;
      152     1154    2           END;
      153     1155    2       ELSE DO;
      154     1156    2           IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN GOTO ALT;
      155     1157    2           DD$=NAM2.LLIST$(HSH_VAL);
      156     1158    3           DO WHILE(NAME ~= NAM1.NAME.TEXT(DESC.NAM_IDX) OR TYPE ~= NAM1.TYPE(DESC.
              1158                    NAM_IDX));
      157     1159    3               IF DESC.LLIST$ = ADDR(NIL) THEN ALTRETURN;
      158     1160    3               DD$=DESC.LLIST$;
      159     1161    3               END;
      160     1162    2           IF ( ADDR(QNAME) ~= ADDR(NIL) AND ADDR(TYPE) ~= ADDR(NIL) AND TYPE = #FIELD)
              1162                    THEN
      161     1163    3           DO WHILE((TYPE ~= NAM1.TYPE(DD$->DESC.NAM_IDX))
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:31   
      162     1164    3              OR (QNAME ~= NAM1.NAME.TEXT(DD$->FIELD.REC_ASSC_IDX))
      163     1165    3              OR (NAME ~= NAM1.NAME.TEXT(DD$->FIELD.NAM_IDX)));
      164     1166    3               DD$=DESC.LLIST$;
      165     1167    3               END;
      166     1168    2           END;
      167     1169    1   RET:
      168     1170    1       RETURN;
      169     1171    1   ALT:
      170     1172    1       ALTRETURN;
      171     1173    1   END ZII$FDDESC;
      172     1174        %EOD;

PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:32   
--  Include file information  --

   ZI$STRUCTS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FDDESC.

   Procedure ZII$FDDESC requires 175 words for executable code.
   Procedure ZII$FDDESC requires 12 words of local(AUTO) storage.

PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:33   

 Object Unit name= ZII$FDDESC                                 File name= ZII$MSC_PROC.:ZIC0TOU
 UTS= SEP 05 '97 12:30:07.52 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  HSH_VAL
    1  LblCom even  none     1      1  TNAM2$
    2  LblCom even  none     1      1  DF$
    3  LblCom even  none     1      1  NAM2$
    4  LblCom even  none     1      1  NAM2_SIZ
    5  LblCom even  none     1      1  DESC#
    6  LblCom even  none     1      1  NAM1$
    7  LblCom even  none     1      1  NAM1_SIZ
    8  LblCom even  none     1      1  NAM1_IDX
    9   Proc  even  none   175    257  ZII$FDDESC
   10  RoData even  none     6      6  ZII$FDDESC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      XStd       5  ZII$FDDESC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      3 ZII$HASH
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:34   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:35   


       90        1        /*T***********************************************************/
       91        2        /*T*                                                         */
       92        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       93        4        /*T*                                                         */
       94        5        /*T***********************************************************/
       95        6        %EJECT;
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:36   
       96        7        ZII$FDDESC: PROC(NAME,TYPE,DD$,FTYPE,QNAME) ALTRET AVOID($PR5,$PR6,$PR7);

      7  9 000000   000000 700200 xent  ZII$FDDESC   TSX0  ! X66_AUTO_5
         9 000001   000014 000005                    ZERO    12,5

       97        8        /**************************************************************
       98        9        This routine  is passed  up to 5 parameters, 3 of
       99       10        which are required( the last 2 parameters are optional).
      100       11         Name - is the  text name for which we want to find the descriptor           (requi
                11        red)
      101       12         type - is the  type of descripotr we area looking for(#area,#set,etc)       (requi
                12        red)
      102       13         DD$  - is the ptr to the descriptor  wanted(and is returned)                (requi
                13        red)
      103       14         ftype- lets this routine what function you are doing (#STORE/#RETRIEVE)     (optio
                14        nal)
      104       15         qname- is used when you are trying to find a specific field within a record (optio
                15        nal)
      105       16        **************************************************************/
      106       17        /*******************Parameters**************/
      107       18    1   DCL NAME CHAR(32) ALIGNED;
      108       19    1   DCL QNAME CHAR(32);
      109       20    1   DCL TYPE UBIN(36);
      110       21    1   DCL FTYPE BIT(1); /*Type of descriptor find. Value are:
      111       22         0 = retrieval
      112       23         1 = store */
      113       24        /*******************Ext dcls****************/
      114       25    1   DCL HSH_VAL UBIN(36) EXT;
      115       26    1   DCL TNAM2$ PTR EXT;
      116       27        /******************Entry dcls***************/
      117       28    1   DCL ZII$HASH ENTRY(3);
      118       29        /******************Include files************/
      119       30        %INCLUDE ZI$DESC;
      120      880        %DSC_DESC (STCLASS=);
      121      888        %DSC_FLD;
      122     1003        %TYPE_SUBS;
      123     1013        %INCLUDE ZI$STRUCTS;
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:37   
      124     1085        %NAM2;
      125     1099        %NAM1;
      126     1128        /******************Program procedure**********/
      127     1129    1       CALL ZII$HASH(NAME,#ENTRY,HSH_VAL);

   1129  9 000002   000002 236000 10                 LDQ     2
         9 000003   200012 756100                    STQ     @QNAME+3,,AUTO
         9 000004   000003 236000 10                 LDQ     3
         9 000005   200003 235100                    LDA     @NAME,,AUTO
         9 000006   200010 757100                    STAQ    @QNAME+1,,AUTO
         9 000007   200010 630500                    EPPR0   @QNAME+1,,AUTO
         9 000010   000000 631400 10                 EPPR1   0
         9 000011   000000 701000 xent               TSX1    ZII$HASH
         9 000012   000000 011000                    NOP     0

      128     1130    1       IF ADDR(FTYPE) ~= ADDR(NIL) AND FTYPE = #STORE THEN

   1130  9 000013   200006 236100                    LDQ     @FTYPE,,AUTO
         9 000014   000004 116000 10                 CMPQ    4
         9 000015   000135 600000 9                  TZE     s:1156
         9 000016   200006 470500                    LDP0    @FTYPE,,AUTO
         9 000017   000000 066500                    CMPB    filb='0'B
         9 000020   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         9 000021   000005 000022 10                 BDSC    5                        by=0,bit=0,n=18
         9 000022   000135 600000 9                  TZE     s:1156

      129     1131    2       DO;

      130     1132    2           TNAM2$=PINCRW(TNAM2$,#DSC_SIZ);

   1132  9 000023   000000 236000 1                  LDQ     TNAM2$
         9 000024   000011 036003                    ADLQ    9,DU
         9 000025   000000 756000 1                  STQ     TNAM2$

      131     1133    2           IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN

   1133  9 000026   000000 471400 3                  LDP1    NAM2$
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:38   
         9 000027   000000 720000 0                  LXL0    HSH_VAL
         9 000030   100000 236110                    LDQ     0,X0,PR1
         9 000031   000004 116000 10                 CMPQ    4
         9 000032   000052 601000 9                  TNZ     s:1141

      132     1134    3           DO;

      133     1135    3               DD$=TNAM2$;

   1135  9 000033   000000 236000 1                  LDQ     TNAM2$
         9 000034   200005 473500                    LDP3    @DD$,,AUTO
         9 000035   300000 756100                    STQ     0,,PR3

      134     1136    3               NAM2.LLIST$(HSH_VAL)=TNAM2$;

   1136  9 000036   000000 236000 1                  LDQ     TNAM2$
         9 000037   000000 471400 3                  LDP1    NAM2$
         9 000040   000000 720000 0                  LXL0    HSH_VAL
         9 000041   100000 756110                    STQ     0,X0,PR1

      135     1137    3               IF TYPE = #FIELD THEN DD$->FIELD.SYN_NAM=#SYN_NAM_NIL;
              1137                        /*Put in the synonym thread for IDP*/

   1137  9 000042   200004 471500                    LDP1    @TYPE,,AUTO
         9 000043   100000 235100                    LDA     0,,PR1
         9 000044   000003 115007                    CMPA    3,DL
         9 000045   000051 601000 9                  TNZ     s:1138

   1137  9 000046   300000 474500                    LDP4    0,,PR3
         9 000047   777777 220003                    LDX0    -1,DU
         9 000050   400002 440100                    SXL0    2,,PR4

      136     1138    3               RETURN;

   1138  9 000051   000000 702200 xent               TSX2  ! X66_ARET

      137     1139    3               END;
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:39   
      138     1140    3           ELSE DO;

      139     1141    3               DD$=NAM2.LLIST$(HSH_VAL);

   1141  9 000052   200005 473500                    LDP3    @DD$,,AUTO
         9 000053   300000 756100                    STQ     0,,PR3

      140     1142    4               DO WHILE(DESC.LLIST$ ~= ADDR(NIL));

   1142  9 000054   000124 710000 9                  TRA     s:1149

      141     1143    4                   IF TYPE=#FIELD /*Hook up the field to the syn chain*/

   1143  9 000055   200004 470500                    LDP0    @TYPE,,AUTO
         9 000056   000000 235100                    LDA     0,,PR0
         9 000057   000003 115007                    CMPA    3,DL
         9 000060   000120 601000 9                  TNZ     s:1148
         9 000061   200005 471500                    LDP1    @DD$,,AUTO
         9 000062   100000 473500                    LDP3    0,,PR1
         9 000063   300000 236100                    LDQ     0,,PR3
         9 000064   000022 772000                    QRL     18
         9 000065   000012 402007                    MPY     10,DL
         9 000066   000002 736000                    QLS     2
         9 000067   200003 474500                    LDP4    @NAME,,AUTO
         9 000070   000000 470400 6                  LDP0    NAM1$
         9 000071   040106 106500                    CMPC    fill='040'O
         9 000072   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
         9 000073   000001 000040                    ADSC9   1,Q,PR0                  cn=0,n=32
         9 000074   000120 601000 9                  TNZ     s:1148
         9 000075   300000 236100                    LDQ     0,,PR3
         9 000076   000022 772000                    QRL     18
         9 000077   000012 402007                    MPY     10,DL
         9 000100   000000 236106                    LDQ     0,QL,PR0
         9 000101   777000 376003                    ANQ     -512,DU
         9 000102   003000 116003                    CMPQ    1536,DU
         9 000103   000120 601000 9                  TNZ     s:1148
         9 000104   000000 470400 2                  LDP0    DF$
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:40   
         9 000105   000002 720100                    LXL0    2,,PR0
         9 000106   777777 100003                    CMPX0   -1,DU
         9 000107   000120 601000 9                  TNZ     s:1148

      142     1144    4                      AND NAME = NAM1.NAME.TEXT(DESC.NAM_IDX)
      143     1145    4                      AND NAM1.TYPE(DESC.NAM_IDX)=#FIELD
      144     1146    4                      AND FIELD.SYN_NAM = #SYN_NAM_NIL THEN
      145     1147    4                       FIELD.SYN_NAM = POFFW(TNAM2$,NAM2$);

   1147  9 000110   000000 235000 3                  LDA     NAM2$
         9 000111   000022 771000                    ARL     18
         9 000112   200010 755100                    STA     @QNAME+1,,AUTO
         9 000113   000000 236000 1                  LDQ     TNAM2$
         9 000114   000022 772000                    QRL     18
         9 000115   200010 136100                    SBLQ    @QNAME+1,,AUTO
         9 000116   000000 620006                    EAX0    0,QL
         9 000117   000002 440100                    SXL0    2,,PR0

      146     1148    4                   DD$=DESC.LLIST$;

   1148  9 000120   200005 470500                    LDP0    @DD$,,AUTO
         9 000121   000000 471500                    LDP1    0,,PR0
         9 000122   100010 236100                    LDQ     8,,PR1
         9 000123   000000 756100                    STQ     0,,PR0

      147     1149    4                   END;

   1149  9 000124   200005 470500                    LDP0    @DD$,,AUTO
         9 000125   000000 471500                    LDP1    0,,PR0
         9 000126   100010 236100                    LDQ     8,,PR1
         9 000127   000004 116000 10                 CMPQ    4
         9 000130   000055 601000 9                  TNZ     s:1143

      148     1150    3               DESC.LLIST$=TNAM2$;

   1150  9 000131   000000 236000 1                  LDQ     TNAM2$
         9 000132   100010 756100                    STQ     8,,PR1
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:41   

      149     1151    3               DD$=TNAM2$;

   1151  9 000133   000000 756100                    STQ     0,,PR0

      150     1152    3               RETURN;

   1152  9 000134   000000 702200 xent               TSX2  ! X66_ARET

      151     1153    3               END;
      152     1154    2           END;
      153     1155    2       ELSE DO;

      154     1156    2           IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN GOTO ALT;

   1156  9 000135   000000 470400 3                  LDP0    NAM2$
         9 000136   000000 720000 0                  LXL0    HSH_VAL
         9 000137   000000 236110                    LDQ     0,X0,PR0
         9 000140   000004 116000 10                 CMPQ    4
         9 000141   000256 600000 9                  TZE     ALT

      155     1157    2           DD$=NAM2.LLIST$(HSH_VAL);

   1157  9 000142   200005 471500                    LDP1    @DD$,,AUTO
         9 000143   100000 756100                    STQ     0,,PR1

      156     1158    3           DO WHILE(NAME ~= NAM1.NAME.TEXT(DESC.NAM_IDX) OR TYPE ~= NAM1.TYPE(DESC.
              1158                    NAM_IDX));

   1158  9 000144   000154 710000 9                  TRA     s:1161

      157     1159    3               IF DESC.LLIST$ = ADDR(NIL) THEN ALTRETURN;

   1159  9 000145   200005 470500                    LDP0    @DD$,,AUTO
         9 000146   000000 471500                    LDP1    0,,PR0
         9 000147   100010 236100                    LDQ     8,,PR1
         9 000150   000004 116000 10                 CMPQ    4
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:42   
         9 000151   000153 601000 9                  TNZ     s:1160

   1159  9 000152   000000 702200 xent               TSX2  ! X66_AALT

      158     1160    3               DD$=DESC.LLIST$;

   1160  9 000153   000000 756100                    STQ     0,,PR0

      159     1161    3               END;

   1161  9 000154   200005 470500                    LDP0    @DD$,,AUTO
         9 000155   000000 471500                    LDP1    0,,PR0
         9 000156   100000 236100                    LDQ     0,,PR1
         9 000157   000022 772000                    QRL     18
         9 000160   000012 402007                    MPY     10,DL
         9 000161   000002 736000                    QLS     2
         9 000162   200003 473500                    LDP3    @NAME,,AUTO
         9 000163   000000 474400 6                  LDP4    NAM1$
         9 000164   040106 106500                    CMPC    fill='040'O
         9 000165   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32
         9 000166   400001 000040                    ADSC9   1,Q,PR4                  cn=0,n=32
         9 000167   000145 601000 9                  TNZ     s:1159
         9 000170   100000 236100                    LDQ     0,,PR1
         9 000171   000022 772000                    QRL     18
         9 000172   000012 402007                    MPY     10,DL
         9 000173   200004 470500                    LDP0    @TYPE,,AUTO
         9 000174   400000 236106                    LDQ     0,QL,PR4
         9 000175   000033 772000                    QRL     27
         9 000176   000000 116100                    CMPQ    0,,PR0
         9 000177   000145 601000 9                  TNZ     s:1159

      160     1162    2          IF ( ADDR(QNAME) ~= ADDR(NIL) AND ADDR(TYPE) ~= ADDR(NIL) AND TYPE = #FIELD)
              1162                    THEN

   1162  9 000200   200007 236100                    LDQ     @QNAME,,AUTO
         9 000201   000004 116000 10                 CMPQ    4
         9 000202   000255 600000 9                  TZE     RET
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:43   
         9 000203   200004 236100                    LDQ     @TYPE,,AUTO
         9 000204   000004 116000 10                 CMPQ    4
         9 000205   000255 600000 9                  TZE     RET
         9 000206   000000 235100                    LDA     0,,PR0
         9 000207   000003 115007                    CMPA    3,DL
         9 000210   000255 601000 9                  TNZ     RET

      161     1163    3           DO WHILE((TYPE ~= NAM1.TYPE(DD$->DESC.NAM_IDX))

   1163  9 000211   000216 710000 9                  TRA     s:1167

      162     1164    3              OR (QNAME ~= NAM1.NAME.TEXT(DD$->FIELD.REC_ASSC_IDX))
      163     1165    3              OR (NAME ~= NAM1.NAME.TEXT(DD$->FIELD.NAM_IDX)));
      164     1166    3               DD$=DESC.LLIST$;

   1166  9 000212   200005 470500                    LDP0    @DD$,,AUTO
         9 000213   000000 471500                    LDP1    0,,PR0
         9 000214   100010 236100                    LDQ     8,,PR1
         9 000215   000000 756100                    STQ     0,,PR0

      165     1167    3               END;

   1167  9 000216   200005 470500                    LDP0    @DD$,,AUTO
         9 000217   000000 471500                    LDP1    0,,PR0
         9 000220   100000 236100                    LDQ     0,,PR1
         9 000221   000022 772000                    QRL     18
         9 000222   000012 402007                    MPY     10,DL
         9 000223   200004 473500                    LDP3    @TYPE,,AUTO
         9 000224   000000 474400 6                  LDP4    NAM1$
         9 000225   400000 236106                    LDQ     0,QL,PR4
         9 000226   000033 772000                    QRL     27
         9 000227   300000 116100                    CMPQ    0,,PR3
         9 000230   000212 601000 9                  TNZ     s:1166
         9 000231   100001 236100                    LDQ     1,,PR1
         9 000232   777777 376007                    ANQ     -1,DL
         9 000233   000012 402007                    MPY     10,DL
         9 000234   000002 736000                    QLS     2
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:44   
         9 000235   200007 470500                    LDP0    @QNAME,,AUTO
         9 000236   040106 106500                    CMPC    fill='040'O
         9 000237   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
         9 000240   400001 000040                    ADSC9   1,Q,PR4                  cn=0,n=32
         9 000241   000212 601000 9                  TNZ     s:1166
         9 000242   200005 471500                    LDP1    @DD$,,AUTO
         9 000243   100000 470500                    LDP0    0,,PR1
         9 000244   000000 236100                    LDQ     0,,PR0
         9 000245   000022 772000                    QRL     18
         9 000246   000012 402007                    MPY     10,DL
         9 000247   000002 736000                    QLS     2
         9 000250   200003 470500                    LDP0    @NAME,,AUTO
         9 000251   040106 106500                    CMPC    fill='040'O
         9 000252   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
         9 000253   400001 000040                    ADSC9   1,Q,PR4                  cn=0,n=32
         9 000254   000212 601000 9                  TNZ     s:1166

      166     1168    2           END;

      167     1169    1   RET:
      168     1170    1       RETURN;

   1170  9 000255   000000 702200 xent  RET          TSX2  ! X66_ARET

      169     1171    1   ALT:
      170     1172    1       ALTRETURN;

   1172  9 000256   000000 702200 xent  ALT          TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
  10     000   000003 000000   000000 001447   000000 006000   000001 006000    ................
  10     004   000000 006014   000000 000000                                    ........
      171     1173    1   END ZII$FDDESC;
      172     1174        %EOD;

PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:45   
--  Include file information  --

   ZI$STRUCTS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FDDESC.

   Procedure ZII$FDDESC requires 175 words for executable code.
   Procedure ZII$FDDESC requires 12 words of local(AUTO) storage.
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:46   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:47   
          MINI XREF LISTING

ALT
      1172**LABEL    1156--GOTO
DD$
       881**DCL         7--PROC      882--IMP-PTR  1135<<ASSIGN   1137>>ASSIGN   1141<<ASSIGN   1142>>DOWHILE
      1143>>IF       1143>>IF       1148<<ASSIGN   1148>>ASSIGN   1150>>ASSIGN   1151<<ASSIGN   1157<<ASSIGN
      1158>>DOWHILE  1158>>DOWHILE  1159>>IF       1160<<ASSIGN   1160>>ASSIGN   1163>>DOWHILE  1163>>DOWHILE
      1163>>DOWHILE  1166<<ASSIGN   1166>>ASSIGN
DESC.LLIST$
       886**DCL      1142>>DOWHILE  1148>>ASSIGN   1150<<ASSIGN   1159>>IF       1160>>ASSIGN   1166>>ASSIGN
DESC.NAM_IDX
       883**DCL      1143>>IF       1143>>IF       1158>>DOWHILE  1158>>DOWHILE  1163>>DOWHILE
DESC#
      1092**DCL      1097--IMP-SIZ
DF$
       889**DCL       890--IMP-PTR  1143>>IF       1147>>ASSIGN
FIELD.EIS_BITS.NDSC
       961**DCL       990--REDEF
FIELD.FLAG_BITS_1
       902**DCL       903--REDEF
FIELD.FLAG_BITS_2
       929**DCL       930--REDEF
FIELD.NAM_IDX
       891**DCL      1163>>DOWHILE
FIELD.REC_ASSC_IDX
       895**DCL      1163>>DOWHILE
FIELD.SYN_NAM
       899**DCL      1137<<ASSIGN   1143>>IF       1147<<ASSIGN
FTYPE
        21**DCL         7--PROC     1130--IF       1130>>IF
HSH_VAL
        25**DCL      1129<>CALL     1133>>IF       1136>>ASSIGN   1141>>ASSIGN   1156>>IF       1157>>ASSIGN
NAM1.NAME.TEXT
PL6.E3A0      #003=ZII$FDDESC File=ZII$MSC_PROC.:ZIC0TSI                         FRI 09/05/97 12:30 Page:48   
      1125**DCL      1143>>IF       1158>>DOWHILE  1163>>DOWHILE  1163>>DOWHILE
NAM1.TYPE
      1112**DCL      1143>>IF       1158>>DOWHILE  1163>>DOWHILE
NAM1$
      1108**DCL      1111--IMP-PTR  1143>>IF       1143>>IF       1158>>DOWHILE  1158>>DOWHILE  1163>>DOWHILE
      1163>>DOWHILE  1163>>DOWHILE
NAM2.DESC
      1096**DCL      1097--REDEF
NAM2.LLIST$
      1094**DCL      1133>>IF       1136<<ASSIGN   1141>>ASSIGN   1156>>IF       1157>>ASSIGN
NAM2$
      1090**DCL      1093--IMP-PTR  1133>>IF       1136>>ASSIGN   1141>>ASSIGN   1147>>ASSIGN   1156>>IF
      1157>>ASSIGN
NAME
        18**DCL         7--PROC     1129<>CALL     1143>>IF       1158>>DOWHILE  1163>>DOWHILE
QNAME
        19**DCL         7--PROC     1162--IF       1163>>DOWHILE
TNAM2$
        26**DCL      1132<<ASSIGN   1132>>ASSIGN   1135>>ASSIGN   1136>>ASSIGN   1147>>ASSIGN   1150>>ASSIGN
      1151>>ASSIGN
TYPE
        20**DCL         7--PROC     1137>>IF       1143>>IF       1158>>DOWHILE  1162--IF       1162>>IF
      1163>>DOWHILE
ZII$HASH
        28**DCL-ENT  1129--CALL

PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:49   
      173        1        /*T***********************************************************/
      174        2        /*T*                                                         */
      175        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      176        4        /*T*                                                         */
      177        5        /*T***********************************************************/
      178        6        %EJECT;
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:50   
      179        7        ZII$FDRLDSC: PROC (NAMM1,NAMM2,NAMM3,DSC$,FTYPE) ALTRET AVOID($PR5,$PR6,$PR7);
      180        8        /**************Parameters************/
      181        9    1   DCL NAMM1 CHAR(32) ALIGNED;
      182       10    1   DCL NAMM2 CHAR(32) ALIGNED;
      183       11    1   DCL NAMM3 CHAR(32) ALIGNED;
      184       12    1   DCL DSC$ PTR;
      185       13    1   DCL FTYPE BIT(1);
      186       14        /***************Ext dcls************/
      187       15    1   DCL ERROR_CODE UBIN(36) EXT;
      188       16    1   DCL HSH_VAL UBIN(36) EXT;
      189       17    1   DCL TNAM2$ PTR EXT;
      190       18        /***************Auto dlcs************/
      191       19        /**************Entry dcls************/
      192       20    1   DCL ZII$HASH2 ENTRY(4);
      193       21    1   DCL ZII$HASH3 ENTRY(5);
      194       22        /**************Include files**********/
      195       23        %INCLUDE ZI$STRUCTS;
      196       95        %NAM1;
      197      124        %NAM2;
      198      138        %INCLUDE ZI$DESC;
      199      988        %DSC_DESC;
      200      996        %DSC_RFK;
      201     1012        /**************Program procedure********/
      202     1013        /**/
      203     1014    1       IF ADDR(NAMM3) = ADDR(NIL) THEN
      204     1015    1           CALL ZII$HASH2(NAMM1,NAMM2,#ENTRY,HSH_VAL);
      205     1016    1       ELSE CALL ZII$HASH3(NAMM1,NAMM2,NAMM3,#ENTRY,HSH_VAL);
      206     1017    1       IF ADDR(FTYPE) ~= ADDR(NIL) AND FTYPE = #STORE THEN
      207     1018    2       DO;
      208     1019    2           TNAM2$=PINCRW(TNAM2$,#DSC_SIZ);
      209     1020    2           IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN
      210     1021    3           DO;
      211     1022    3               DSC$=TNAM2$;
      212     1023    3               NAM2.LLIST$(HSH_VAL)=TNAM2$;
      213     1024    3               RETURN;
      214     1025    3               END;
      215     1026    3           ELSE DO;
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:51   
      216     1027    3               DSC$=NAM2.LLIST$(HSH_VAL);
      217     1028    4               DO WHILE(DSC$->DESC.LLIST$ ~= ADDR(NIL));
      218     1029    4                   DSC$=DSC$->DESC.LLIST$;
      219     1030    4                   END;
      220     1031    3               DSC$->DESC.LLIST$=TNAM2$;
      221     1032    3               DSC$=TNAM2$;
      222     1033    3               RETURN;
      223     1034    3               END;
      224     1035    2           END;
      225     1036    2       ELSE DO;
      226     1037    2           IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN GOTO ALT;
      227     1038    2           IF ADDR(NAMM3) = ADDR(NIL) THEN
      228     1039    3           DO;
      229     1040    3               DRFK$=NAM2.LLIST$(HSH_VAL);
      230     1041    4               DO WHILE((NAMM1 ~= NAM1.NAME.TEXT(RFK_DSC.REC_IDX))
      231     1042    4                  OR (NAMM2 ~= NAM1.NAME.TEXT(RFK_DSC.KEY_IDX)));
      232     1043    4                   DRFK$=RFK_DSC.LLIST$;
      233     1044    4                   END;
      234     1045    3               END;
      235     1046    3           ELSE DO;
      236     1047    3               DRFK$=NAM2.LLIST$(HSH_VAL);
      237     1048    4               DO WHILE ((NAMM1 ~= NAM1.NAME.TEXT(RFK_DSC.REC_IDX))
      238     1049    4                  OR (NAMM2 ~= NAM1.NAME.TEXT(RFK_DSC.KEY_IDX))
      239     1050    4                  OR (NAMM3 ~= NAM1.NAME.TEXT(RFK_DSC.FLD_IDX)));
      240     1051    4                   DRFK$=RFK_DSC.LLIST$;
      241     1052    4                   END;
      242     1053    3               END;
      243     1054    2           END;
      244     1055    1   RET:
      245     1056    1       DSC$=DRFK$;
      246     1057    1       RETURN;
      247     1058    1   ALT:
      248     1059    1       ALTRETURN;
      249     1060    1   END ZII$FDRLDSC;
      250     1061        %EOD;

PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:52   
--  Include file information  --

   ZI$DESC.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FDRLDSC.

   Procedure ZII$FDRLDSC requires 142 words for executable code.
   Procedure ZII$FDRLDSC requires 14 words of local(AUTO) storage.

PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:53   

 Object Unit name= ZII$FDRLDSC                                File name= ZII$MSC_PROC.:ZIC0TOU
 UTS= SEP 05 '97 12:30:19.32 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ERROR_CODE
    1  LblCom even  none     1      1  HSH_VAL
    2  LblCom even  none     1      1  TNAM2$
    3  LblCom even  none     1      1  NAM1$
    4  LblCom even  none     1      1  NAM1_SIZ
    5  LblCom even  none     1      1  NAM1_IDX
    6  LblCom even  none     1      1  NAM2$
    7  LblCom even  none     1      1  NAM2_SIZ
    8  LblCom even  none     1      1  DESC#
    9  LblCom even  none     1      1  DD$
   10  LblCom even  none     1      1  DRFK$
   11   Proc  even  none   142    216  ZII$FDRLDSC
   12  RoData even  none     7      7  ZII$FDRLDSC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes    yes     yes      XStd       5  ZII$FDRLDSC
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:54   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      4 ZII$HASH2
         yes           XStd      5 ZII$HASH3
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:55   


      173        1        /*T***********************************************************/
      174        2        /*T*                                                         */
      175        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      176        4        /*T*                                                         */
      177        5        /*T***********************************************************/
      178        6        %EJECT;
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:56   
      179        7        ZII$FDRLDSC: PROC (NAMM1,NAMM2,NAMM3,DSC$,FTYPE) ALTRET AVOID($PR5,$PR6,$PR7);

      7 11 000000   000000 700200 xent  ZII$FDRLDSC  TSX0  ! X66_AUTO_5
        11 000001   000016 000005                    ZERO    14,5

      180        8        /**************Parameters************/
      181        9    1   DCL NAMM1 CHAR(32) ALIGNED;
      182       10    1   DCL NAMM2 CHAR(32) ALIGNED;
      183       11    1   DCL NAMM3 CHAR(32) ALIGNED;
      184       12    1   DCL DSC$ PTR;
      185       13    1   DCL FTYPE BIT(1);
      186       14        /***************Ext dcls************/
      187       15    1   DCL ERROR_CODE UBIN(36) EXT;
      188       16    1   DCL HSH_VAL UBIN(36) EXT;
      189       17    1   DCL TNAM2$ PTR EXT;
      190       18        /***************Auto dlcs************/
      191       19        /**************Entry dcls************/
      192       20    1   DCL ZII$HASH2 ENTRY(4);
      193       21    1   DCL ZII$HASH3 ENTRY(5);
      194       22        /**************Include files**********/
      195       23        %INCLUDE ZI$STRUCTS;
      196       95        %NAM1;
      197      124        %NAM2;
      198      138        %INCLUDE ZI$DESC;
      199      988        %DSC_DESC;
      200      996        %DSC_RFK;
      201     1012        /**************Program procedure********/
      202     1013        /**/
      203     1014    1       IF ADDR(NAMM3) = ADDR(NIL) THEN

   1014 11 000002   200005 236100                    LDQ     @NAMM3,,AUTO
        11 000003   000000 116000 12                 CMPQ    0
        11 000004   000017 601000 11                 TNZ     s:1016

      204     1015    1           CALL ZII$HASH2(NAMM1,NAMM2,#ENTRY,HSH_VAL);

   1015 11 000005   000004 237000 12                 LDAQ    4
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:57   
        11 000006   200012 757100                    STAQ    @FTYPE+3,,AUTO
        11 000007   200004 236100                    LDQ     @NAMM2,,AUTO
        11 000010   200003 235100                    LDA     @NAMM1,,AUTO
        11 000011   200010 757100                    STAQ    @FTYPE+1,,AUTO
        11 000012   200010 630500                    EPPR0   @FTYPE+1,,AUTO
        11 000013   000001 631400 12                 EPPR1   1
        11 000014   000000 701000 xent               TSX1    ZII$HASH2
        11 000015   000000 011000                    NOP     0
        11 000016   000033 710000 11                 TRA     s:1017

      205     1016    1       ELSE CALL ZII$HASH3(NAMM1,NAMM2,NAMM3,#ENTRY,HSH_VAL);

   1016 11 000017   000005 236000 12                 LDQ     5
        11 000020   200014 756100                    STQ     @FTYPE+5,,AUTO
        11 000021   000004 236000 12                 LDQ     4
        11 000022   200005 235100                    LDA     @NAMM3,,AUTO
        11 000023   200012 757100                    STAQ    @FTYPE+3,,AUTO
        11 000024   200004 236100                    LDQ     @NAMM2,,AUTO
        11 000025   200003 235100                    LDA     @NAMM1,,AUTO
        11 000026   200010 757100                    STAQ    @FTYPE+1,,AUTO
        11 000027   200010 630500                    EPPR0   @FTYPE+1,,AUTO
        11 000030   000003 631400 12                 EPPR1   3
        11 000031   000000 701000 xent               TSX1    ZII$HASH3
        11 000032   000000 011000                    NOP     0

      206     1017    1       IF ADDR(FTYPE) ~= ADDR(NIL) AND FTYPE = #STORE THEN

   1017 11 000033   200007 236100                    LDQ     @FTYPE,,AUTO
        11 000034   000000 116000 12                 CMPQ    0
        11 000035   000103 600000 11                 TZE     s:1037
        11 000036   200007 470500                    LDP0    @FTYPE,,AUTO
        11 000037   000000 066500                    CMPB    filb='0'B
        11 000040   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
        11 000041   000006 000022 12                 BDSC    6                        by=0,bit=0,n=18
        11 000042   000103 600000 11                 TZE     s:1037

      207     1018    2       DO;
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:58   

      208     1019    2           TNAM2$=PINCRW(TNAM2$,#DSC_SIZ);

   1019 11 000043   000000 236000 2                  LDQ     TNAM2$
        11 000044   000011 036003                    ADLQ    9,DU
        11 000045   000000 756000 2                  STQ     TNAM2$

      209     1020    2           IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN

   1020 11 000046   000000 471400 6                  LDP1    NAM2$
        11 000047   000000 720000 1                  LXL0    HSH_VAL
        11 000050   100000 236110                    LDQ     0,X0,PR1
        11 000051   000000 116000 12                 CMPQ    0
        11 000052   000063 601000 11                 TNZ     s:1027

      210     1021    3           DO;

      211     1022    3               DSC$=TNAM2$;

   1022 11 000053   000000 236000 2                  LDQ     TNAM2$
        11 000054   200006 473500                    LDP3    @DSC$,,AUTO
        11 000055   300000 756100                    STQ     0,,PR3

      212     1023    3               NAM2.LLIST$(HSH_VAL)=TNAM2$;

   1023 11 000056   000000 236000 2                  LDQ     TNAM2$
        11 000057   000000 471400 6                  LDP1    NAM2$
        11 000060   000000 720000 1                  LXL0    HSH_VAL
        11 000061   100000 756110                    STQ     0,X0,PR1

      213     1024    3               RETURN;

   1024 11 000062   000000 702200 xent               TSX2  ! X66_ARET

      214     1025    3               END;
      215     1026    3           ELSE DO;

PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:59   
      216     1027    3               DSC$=NAM2.LLIST$(HSH_VAL);

   1027 11 000063   200006 473500                    LDP3    @DSC$,,AUTO
        11 000064   300000 756100                    STQ     0,,PR3

      217     1028    4               DO WHILE(DSC$->DESC.LLIST$ ~= ADDR(NIL));

   1028 11 000065   000072 710000 11                 TRA     s:1030

      218     1029    4                   DSC$=DSC$->DESC.LLIST$;

   1029 11 000066   200006 470500                    LDP0    @DSC$,,AUTO
        11 000067   000000 471500                    LDP1    0,,PR0
        11 000070   100010 236100                    LDQ     8,,PR1
        11 000071   000000 756100                    STQ     0,,PR0

      219     1030    4                   END;

   1030 11 000072   200006 470500                    LDP0    @DSC$,,AUTO
        11 000073   000000 471500                    LDP1    0,,PR0
        11 000074   100010 236100                    LDQ     8,,PR1
        11 000075   000000 116000 12                 CMPQ    0
        11 000076   000066 601000 11                 TNZ     s:1029

      220     1031    3               DSC$->DESC.LLIST$=TNAM2$;

   1031 11 000077   000000 236000 2                  LDQ     TNAM2$
        11 000100   100010 756100                    STQ     8,,PR1

      221     1032    3               DSC$=TNAM2$;

   1032 11 000101   000000 756100                    STQ     0,,PR0

      222     1033    3               RETURN;

   1033 11 000102   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:60   
      223     1034    3               END;
      224     1035    2           END;
      225     1036    2       ELSE DO;

      226     1037    2           IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN GOTO ALT;

   1037 11 000103   000000 470400 6                  LDP0    NAM2$
        11 000104   000000 720000 1                  LXL0    HSH_VAL
        11 000105   000000 236110                    LDQ     0,X0,PR0
        11 000106   000000 116000 12                 CMPQ    0
        11 000107   000215 600000 11                 TZE     ALT

      227     1038    2           IF ADDR(NAMM3) = ADDR(NIL) THEN

   1038 11 000110   200005 236100                    LDQ     @NAMM3,,AUTO
        11 000111   000000 116000 12                 CMPQ    0
        11 000112   000146 601000 11                 TNZ     s:1047

      228     1039    3           DO;

      229     1040    3               DRFK$=NAM2.LLIST$(HSH_VAL);

   1040 11 000113   000000 236110                    LDQ     0,X0,PR0
        11 000114   000000 756000 10                 STQ     DRFK$

      230     1041    4               DO WHILE((NAMM1 ~= NAM1.NAME.TEXT(RFK_DSC.REC_IDX))

   1041 11 000115   000121 710000 11                 TRA     s:1044

      231     1042    4                  OR (NAMM2 ~= NAM1.NAME.TEXT(RFK_DSC.KEY_IDX)));
      232     1043    4                   DRFK$=RFK_DSC.LLIST$;

   1043 11 000116   000000 470400 10                 LDP0    DRFK$
        11 000117   000010 236100                    LDQ     8,,PR0
        11 000120   000000 756000 10                 STQ     DRFK$

      233     1044    4                   END;
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:61   

   1044 11 000121   000000 470400 10                 LDP0    DRFK$
        11 000122   000000 236100                    LDQ     0,,PR0
        11 000123   000022 772000                    QRL     18
        11 000124   000012 402007                    MPY     10,DL
        11 000125   000002 736000                    QLS     2
        11 000126   200003 471500                    LDP1    @NAMM1,,AUTO
        11 000127   000000 473400 3                  LDP3    NAM1$
        11 000130   040106 106500                    CMPC    fill='040'O
        11 000131   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        11 000132   300001 000040                    ADSC9   1,Q,PR3                  cn=0,n=32
        11 000133   000116 601000 11                 TNZ     s:1043
        11 000134   000000 236100                    LDQ     0,,PR0
        11 000135   777777 376007                    ANQ     -1,DL
        11 000136   000012 402007                    MPY     10,DL
        11 000137   000002 736000                    QLS     2
        11 000140   200004 474500                    LDP4    @NAMM2,,AUTO
        11 000141   040106 106500                    CMPC    fill='040'O
        11 000142   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
        11 000143   300001 000040                    ADSC9   1,Q,PR3                  cn=0,n=32
        11 000144   000116 601000 11                 TNZ     s:1043

      234     1045    3               END;

   1045 11 000145   000211 710000 11                 TRA     RET

      235     1046    3           ELSE DO;

      236     1047    3               DRFK$=NAM2.LLIST$(HSH_VAL);

   1047 11 000146   000000 236110                    LDQ     0,X0,PR0
        11 000147   000000 756000 10                 STQ     DRFK$

      237     1048    4               DO WHILE ((NAMM1 ~= NAM1.NAME.TEXT(RFK_DSC.REC_IDX))

   1048 11 000150   000154 710000 11                 TRA     s:1052

PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:62   
      238     1049    4                  OR (NAMM2 ~= NAM1.NAME.TEXT(RFK_DSC.KEY_IDX))
      239     1050    4                  OR (NAMM3 ~= NAM1.NAME.TEXT(RFK_DSC.FLD_IDX)));
      240     1051    4                   DRFK$=RFK_DSC.LLIST$;

   1051 11 000151   000000 470400 10                 LDP0    DRFK$
        11 000152   000010 236100                    LDQ     8,,PR0
        11 000153   000000 756000 10                 STQ     DRFK$

      241     1052    4                   END;

   1052 11 000154   000000 470400 10                 LDP0    DRFK$
        11 000155   000000 236100                    LDQ     0,,PR0
        11 000156   000022 772000                    QRL     18
        11 000157   000012 402007                    MPY     10,DL
        11 000160   000002 736000                    QLS     2
        11 000161   200003 471500                    LDP1    @NAMM1,,AUTO
        11 000162   000000 473400 3                  LDP3    NAM1$
        11 000163   040106 106500                    CMPC    fill='040'O
        11 000164   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        11 000165   300001 000040                    ADSC9   1,Q,PR3                  cn=0,n=32
        11 000166   000151 601000 11                 TNZ     s:1051
        11 000167   000000 236100                    LDQ     0,,PR0
        11 000170   777777 376007                    ANQ     -1,DL
        11 000171   000012 402007                    MPY     10,DL
        11 000172   000002 736000                    QLS     2
        11 000173   200004 474500                    LDP4    @NAMM2,,AUTO
        11 000174   040106 106500                    CMPC    fill='040'O
        11 000175   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
        11 000176   300001 000040                    ADSC9   1,Q,PR3                  cn=0,n=32
        11 000177   000151 601000 11                 TNZ     s:1051
        11 000200   000001 236100                    LDQ     1,,PR0
        11 000201   000022 772000                    QRL     18
        11 000202   000012 402007                    MPY     10,DL
        11 000203   000002 736000                    QLS     2
        11 000204   200005 470500                    LDP0    @NAMM3,,AUTO
        11 000205   040106 106500                    CMPC    fill='040'O
        11 000206   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:63   
        11 000207   300001 000040                    ADSC9   1,Q,PR3                  cn=0,n=32
        11 000210   000151 601000 11                 TNZ     s:1051

      242     1053    3               END;

      243     1054    2           END;

      244     1055    1   RET:
      245     1056    1       DSC$=DRFK$;

   1056 11 000211   000000 236000 10    RET          LDQ     DRFK$
        11 000212   200006 470500                    LDP0    @DSC$,,AUTO
        11 000213   000000 756100                    STQ     0,,PR0

      246     1057    1       RETURN;

   1057 11 000214   000000 702200 xent               TSX2  ! X66_ARET

      247     1058    1   ALT:
      248     1059    1       ALTRETURN;

   1059 11 000215   000000 702200 xent  ALT          TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
  12     000   000000 006014   000004 000000   000000 001447   000005 000000    ................
  12     004   000002 006000   000000 006000   000000 000000                    ............
      249     1060    1   END ZII$FDRLDSC;
      250     1061        %EOD;

PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:64   
--  Include file information  --

   ZI$DESC.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FDRLDSC.

   Procedure ZII$FDRLDSC requires 142 words for executable code.
   Procedure ZII$FDRLDSC requires 14 words of local(AUTO) storage.
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:65   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:66   
          MINI XREF LISTING

ALT
      1059**LABEL    1037--GOTO
DD$
       989**DCL       990--IMP-PTR
DESC.LLIST$
       994**DCL      1028>>DOWHILE  1029>>ASSIGN   1031<<ASSIGN
DESC#
       131**DCL       136--IMP-SIZ
DRFK$
       997**DCL       998--IMP-PTR  1040<<ASSIGN   1041>>DOWHILE  1041>>DOWHILE  1043<<ASSIGN   1043>>ASSIGN
      1047<<ASSIGN   1048>>DOWHILE  1048>>DOWHILE  1048>>DOWHILE  1051<<ASSIGN   1051>>ASSIGN   1056>>ASSIGN
DSC$
        12**DCL         7--PROC     1022<<ASSIGN   1027<<ASSIGN   1028>>DOWHILE  1029<<ASSIGN   1029>>ASSIGN
      1031>>ASSIGN   1032<<ASSIGN   1056<<ASSIGN
FTYPE
        13**DCL         7--PROC     1017--IF       1017>>IF
HSH_VAL
        16**DCL      1015<>CALL     1016<>CALL     1020>>IF       1023>>ASSIGN   1027>>ASSIGN   1037>>IF
      1040>>ASSIGN   1047>>ASSIGN
NAM1.NAME.TEXT
       121**DCL      1041>>DOWHILE  1041>>DOWHILE  1048>>DOWHILE  1048>>DOWHILE  1048>>DOWHILE
NAM1$
       104**DCL       107--IMP-PTR  1041>>DOWHILE  1041>>DOWHILE  1048>>DOWHILE  1048>>DOWHILE  1048>>DOWHILE
NAM2.DESC
       135**DCL       136--REDEF
NAM2.LLIST$
       133**DCL      1020>>IF       1023<<ASSIGN   1027>>ASSIGN   1037>>IF       1040>>ASSIGN   1047>>ASSIGN
NAM2$
       129**DCL       132--IMP-PTR  1020>>IF       1023>>ASSIGN   1027>>ASSIGN   1037>>IF       1040>>ASSIGN
      1047>>ASSIGN
NAMM1
         9**DCL         7--PROC     1015<>CALL     1016<>CALL     1041>>DOWHILE  1048>>DOWHILE
PL6.E3A0      #004=ZII$FDRLDSC File=ZII$MSC_PROC.:ZIC0TSI                        FRI 09/05/97 12:30 Page:67   
NAMM2
        10**DCL         7--PROC     1015<>CALL     1016<>CALL     1041>>DOWHILE  1048>>DOWHILE
NAMM3
        11**DCL         7--PROC     1014--IF       1016<>CALL     1038--IF       1048>>DOWHILE
RFK_DSC.FLD_IDX
      1001**DCL      1048>>DOWHILE
RFK_DSC.KEY_IDX
      1000**DCL      1041>>DOWHILE  1048>>DOWHILE
RFK_DSC.LLIST$
      1010**DCL      1043>>ASSIGN   1051>>ASSIGN
RFK_DSC.REC_IDX
       999**DCL      1041>>DOWHILE  1048>>DOWHILE
TNAM2$
        17**DCL      1019<<ASSIGN   1019>>ASSIGN   1022>>ASSIGN   1023>>ASSIGN   1031>>ASSIGN   1032>>ASSIGN
ZII$HASH2
        20**DCL-ENT  1015--CALL
ZII$HASH3
        21**DCL-ENT  1016--CALL

PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:68   
      251        1        /*T***********************************************************/
      252        2        /*T*                                                         */
      253        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      254        4        /*T*                                                         */
      255        5        /*T***********************************************************/
      256        6        %EJECT;
PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:69   
      257        7        ZII$HASH2: PROC(ARG1,ARG2,ENTRIES#,HASH_VAL) AVOID($PR5,$PR6,$PR7);
      258        8        /*****************Parameters**************/
      259        9    1   DCL HASH_VAL UBIN;
      260       10    1   DCL ARG1(0:7) UBIN;
      261       11    1   DCL ARG2(0:7) UBIN;
      262       12    1   DCL ENTRIES# UBIN(36);
      263       13        /***************Program procedure*********/
      264       14    1       HASH_VAL = MOD(
      265       15    1          BITBIN(BINBIT(
      266       16    1          ARG1(0)+ARG1(1)+ARG1(2)+ARG1(3)+ARG1(4)+ARG1(5)+ARG1(6)+ARG1(7)
      267       17    1          +ARG2(0)+ARG2(1)+ARG2(2)+ARG2(3)+ARG2(4)+ARG2(5)+ARG2(6)+ARG2(7)
      268       18    1          ,36) & '377777777777'O)
      269       19    1          ,ENTRIES#);
      270       20    1   RET:
      271       21    1       RETURN;
      272       22    1   END ZII$HASH2;
      273       23        %EOD;

PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:70   
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$HASH2.

   Procedure ZII$HASH2 requires 43 words for executable code.
   Procedure ZII$HASH2 requires 8 words of local(AUTO) storage.

PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:71   

 Object Unit name= ZII$HASH2                                  File name= ZII$MSC_PROC.:ZIC0TOU
 UTS= SEP 05 '97 12:30:33.40 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  ZII$HASH2
    1   Proc  even  none    43     53  ZII$HASH2

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       4  ZII$HASH2

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:72   


      251        1        /*T***********************************************************/
      252        2        /*T*                                                         */
      253        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      254        4        /*T*                                                         */
      255        5        /*T***********************************************************/
      256        6        %EJECT;
PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:73   
      257        7        ZII$HASH2: PROC(ARG1,ARG2,ENTRIES#,HASH_VAL) AVOID($PR5,$PR6,$PR7);

      7  1 000000   000000 700200 xent  ZII$HASH2    TSX0  ! X66_AUTO_4
         1 000001   000010 000004                    ZERO    8,4

      258        8        /*****************Parameters**************/
      259        9    1   DCL HASH_VAL UBIN;
      260       10    1   DCL ARG1(0:7) UBIN;
      261       11    1   DCL ARG2(0:7) UBIN;
      262       12    1   DCL ENTRIES# UBIN(36);
      263       13        /***************Program procedure*********/
      264       14    1       HASH_VAL = MOD(

     14  1 000002   200003 470500                    LDP0    @ARG1,,AUTO
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000001 036100                    ADLQ    1,,PR0
         1 000005   000002 036100                    ADLQ    2,,PR0
         1 000006   000003 036100                    ADLQ    3,,PR0
         1 000007   000004 036100                    ADLQ    4,,PR0
         1 000010   000005 036100                    ADLQ    5,,PR0
         1 000011   000006 036100                    ADLQ    6,,PR0
         1 000012   000007 036100                    ADLQ    7,,PR0
         1 000013   200004 471500                    LDP1    @ARG2,,AUTO
         1 000014   100000 036100                    ADLQ    0,,PR1
         1 000015   100001 036100                    ADLQ    1,,PR1
         1 000016   100002 036100                    ADLQ    2,,PR1
         1 000017   100003 036100                    ADLQ    3,,PR1
         1 000020   100004 036100                    ADLQ    4,,PR1
         1 000021   100005 036100                    ADLQ    5,,PR1
         1 000022   100006 036100                    ADLQ    6,,PR1
         1 000023   100007 036100                    ADLQ    7,,PR1
         1 000024   000000 376000 0                  ANQ     0
         1 000025   200005 473500                    LDP3    @ENTRIES#,,AUTO
         1 000026   000043 605000 1                  TPL     s:14+33
         1 000027   300000 235100                    LDA     0,,PR3
         1 000030   000037 604000 1                  TMI     s:14+29
         1 000031   000001 115007                    CMPA    1,DL
PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:74   
         1 000032   000045 600000 1                  TZE     s:14+35
         1 000033   000000 235003                    LDA     0,DU
         1 000034   000001 737000                    LLS     1
         1 000035   300000 507100                    DVF     0,,PR3
         1 000036   000045 710000 1                  TRA     s:14+35
         1 000037   300000 116100                    CMPQ    0,,PR3
         1 000040   000045 604000 1                  TMI     s:14+35
         1 000041   300000 136100                    SBLQ    0,,PR3
         1 000042   000045 710000 1                  TRA     s:14+35
         1 000043   300000 235100                    LDA     0,,PR3
         1 000044   000047 605000 1                  TPL     s:14+37
         1 000045   000044 737000                    LLS     36
         1 000046   000050 710000 1                  TRA     s:14+38
         1 000047   300000 506100                    DIV     0,,PR3
         1 000050   200006 474500                    LDP4    @HASH_VAL,,AUTO
         1 000051   400000 755100                    STA     0,,PR4

      265       15    1          BITBIN(BINBIT(
      266       16    1          ARG1(0)+ARG1(1)+ARG1(2)+ARG1(3)+ARG1(4)+ARG1(5)+ARG1(6)+ARG1(7)
      267       17    1          +ARG2(0)+ARG2(1)+ARG2(2)+ARG2(3)+ARG2(4)+ARG2(5)+ARG2(6)+ARG2(7)
      268       18    1          ,36) & '377777777777'O)
      269       19    1          ,ENTRIES#);
      270       20    1   RET:
      271       21    1       RETURN;

     21  1 000052   000000 702200 xent  RET          TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   0     000   377777 777777                                                    ....
      272       22    1   END ZII$HASH2;
      273       23        %EOD;

PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:75   
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$HASH2.

   Procedure ZII$HASH2 requires 43 words for executable code.
   Procedure ZII$HASH2 requires 8 words of local(AUTO) storage.
PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:76   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=ZII$HASH2 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:77   
          MINI XREF LISTING

ARG1
        10**DCL         7--PROC       14>>ASSIGN     14>>ASSIGN     14>>ASSIGN     14>>ASSIGN     14>>ASSIGN
        14>>ASSIGN     14>>ASSIGN     14>>ASSIGN
ARG2
        11**DCL         7--PROC       14>>ASSIGN     14>>ASSIGN     14>>ASSIGN     14>>ASSIGN     14>>ASSIGN
        14>>ASSIGN     14>>ASSIGN     14>>ASSIGN
ENTRIES#
        12**DCL         7--PROC       14>>ASSIGN
HASH_VAL
         9**DCL         7--PROC       14<<ASSIGN

PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:78   
      274        1        /*T***********************************************************/
      275        2        /*T*                                                         */
      276        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      277        4        /*T*                                                         */
      278        5        /*T***********************************************************/
      279        6        %EJECT;
PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:79   
      280        7        ZII$HASH3: PROC(ARG1,ARG2,ARG3,ENTRIES#,HASH_VAL) AVOID($PR5,$PR6,$PR7);
      281        8        /*****************Parameters**************/
      282        9    1   DCL HASH_VAL UBIN;
      283       10    1   DCL ARG1(0:7) UBIN;
      284       11    1   DCL ARG2(0:7) UBIN;
      285       12    1   DCL ARG3(0:7) UBIN;
      286       13    1   DCL ENTRIES# UBIN(36);
      287       14        /****************Program procedure*********/
      288       15    1       HASH_VAL = MOD(
      289       16    1          BITBIN(BINBIT(
      290       17    1          ARG1(0)+ARG1(1)+ARG1(2)+ARG1(3)+ARG1(4)+ARG1(5)+ARG1(6)+ARG1(7)
      291       18    1          +ARG2(0)+ARG2(1)+ARG2(2)+ARG2(3)+ARG2(4)+ARG2(5)+ARG2(6)+ARG2(7)
      292       19    1          +ARG3(0)+ARG3(1)+ARG3(2)+ARG3(3)+ARG3(4)+ARG3(5)+ARG3(6)+ARG3(7)
      293       20    1          ,36) & '377777777777'O)
      294       21    1          ,ENTRIES#);
      295       22    1   RET:
      296       23    1       RETURN;
      297       24    1   END ZII$HASH3;
      298       25        %EOD;

PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:80   
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$HASH3.

   Procedure ZII$HASH3 requires 52 words for executable code.
   Procedure ZII$HASH3 requires 8 words of local(AUTO) storage.

PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:81   

 Object Unit name= ZII$HASH3                                  File name= ZII$MSC_PROC.:ZIC0TOU
 UTS= SEP 05 '97 12:30:37.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  ZII$HASH3
    1   Proc  even  none    52     64  ZII$HASH3

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       5  ZII$HASH3

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET
PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:82   


      274        1        /*T***********************************************************/
      275        2        /*T*                                                         */
      276        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      277        4        /*T*                                                         */
      278        5        /*T***********************************************************/
      279        6        %EJECT;
PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:83   
      280        7        ZII$HASH3: PROC(ARG1,ARG2,ARG3,ENTRIES#,HASH_VAL) AVOID($PR5,$PR6,$PR7);

      7  1 000000   000000 700200 xent  ZII$HASH3    TSX0  ! X66_AUTO_5
         1 000001   000010 000005                    ZERO    8,5

      281        8        /*****************Parameters**************/
      282        9    1   DCL HASH_VAL UBIN;
      283       10    1   DCL ARG1(0:7) UBIN;
      284       11    1   DCL ARG2(0:7) UBIN;
      285       12    1   DCL ARG3(0:7) UBIN;
      286       13    1   DCL ENTRIES# UBIN(36);
      287       14        /****************Program procedure*********/
      288       15    1       HASH_VAL = MOD(

     15  1 000002   200003 470500                    LDP0    @ARG1,,AUTO
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000001 036100                    ADLQ    1,,PR0
         1 000005   000002 036100                    ADLQ    2,,PR0
         1 000006   000003 036100                    ADLQ    3,,PR0
         1 000007   000004 036100                    ADLQ    4,,PR0
         1 000010   000005 036100                    ADLQ    5,,PR0
         1 000011   000006 036100                    ADLQ    6,,PR0
         1 000012   000007 036100                    ADLQ    7,,PR0
         1 000013   200004 471500                    LDP1    @ARG2,,AUTO
         1 000014   100000 036100                    ADLQ    0,,PR1
         1 000015   100001 036100                    ADLQ    1,,PR1
         1 000016   100002 036100                    ADLQ    2,,PR1
         1 000017   100003 036100                    ADLQ    3,,PR1
         1 000020   100004 036100                    ADLQ    4,,PR1
         1 000021   100005 036100                    ADLQ    5,,PR1
         1 000022   100006 036100                    ADLQ    6,,PR1
         1 000023   100007 036100                    ADLQ    7,,PR1
         1 000024   200005 473500                    LDP3    @ARG3,,AUTO
         1 000025   300000 036100                    ADLQ    0,,PR3
         1 000026   300001 036100                    ADLQ    1,,PR3
         1 000027   300002 036100                    ADLQ    2,,PR3
         1 000030   300003 036100                    ADLQ    3,,PR3
PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:84   
         1 000031   300004 036100                    ADLQ    4,,PR3
         1 000032   300005 036100                    ADLQ    5,,PR3
         1 000033   300006 036100                    ADLQ    6,,PR3
         1 000034   300007 036100                    ADLQ    7,,PR3
         1 000035   000000 376000 0                  ANQ     0
         1 000036   200006 474500                    LDP4    @ENTRIES#,,AUTO
         1 000037   000054 605000 1                  TPL     s:15+42
         1 000040   400000 235100                    LDA     0,,PR4
         1 000041   000050 604000 1                  TMI     s:15+38
         1 000042   000001 115007                    CMPA    1,DL
         1 000043   000056 600000 1                  TZE     s:15+44
         1 000044   000000 235003                    LDA     0,DU
         1 000045   000001 737000                    LLS     1
         1 000046   400000 507100                    DVF     0,,PR4
         1 000047   000056 710000 1                  TRA     s:15+44
         1 000050   400000 116100                    CMPQ    0,,PR4
         1 000051   000056 604000 1                  TMI     s:15+44
         1 000052   400000 136100                    SBLQ    0,,PR4
         1 000053   000056 710000 1                  TRA     s:15+44
         1 000054   400000 235100                    LDA     0,,PR4
         1 000055   000060 605000 1                  TPL     s:15+46
         1 000056   000044 737000                    LLS     36
         1 000057   000061 710000 1                  TRA     s:15+47
         1 000060   400000 506100                    DIV     0,,PR4
         1 000061   200007 470500                    LDP0    @HASH_VAL,,AUTO
         1 000062   000000 755100                    STA     0,,PR0

      289       16    1          BITBIN(BINBIT(
      290       17    1          ARG1(0)+ARG1(1)+ARG1(2)+ARG1(3)+ARG1(4)+ARG1(5)+ARG1(6)+ARG1(7)
      291       18    1          +ARG2(0)+ARG2(1)+ARG2(2)+ARG2(3)+ARG2(4)+ARG2(5)+ARG2(6)+ARG2(7)
      292       19    1          +ARG3(0)+ARG3(1)+ARG3(2)+ARG3(3)+ARG3(4)+ARG3(5)+ARG3(6)+ARG3(7)
      293       20    1          ,36) & '377777777777'O)
      294       21    1          ,ENTRIES#);
      295       22    1   RET:
      296       23    1       RETURN;

     23  1 000063   000000 702200 xent  RET          TSX2  ! X66_ARET
PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:85   

(unnamed)
 Sect OctLoc
   0     000   377777 777777                                                    ....
      297       24    1   END ZII$HASH3;
      298       25        %EOD;

PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:86   
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$HASH3.

   Procedure ZII$HASH3 requires 52 words for executable code.
   Procedure ZII$HASH3 requires 8 words of local(AUTO) storage.
PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:87   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=ZII$HASH3 File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:30 Page:88   
          MINI XREF LISTING

ARG1
        10**DCL         7--PROC       15>>ASSIGN     15>>ASSIGN     15>>ASSIGN     15>>ASSIGN     15>>ASSIGN
        15>>ASSIGN     15>>ASSIGN     15>>ASSIGN
ARG2
        11**DCL         7--PROC       15>>ASSIGN     15>>ASSIGN     15>>ASSIGN     15>>ASSIGN     15>>ASSIGN
        15>>ASSIGN     15>>ASSIGN     15>>ASSIGN
ARG3
        12**DCL         7--PROC       15>>ASSIGN     15>>ASSIGN     15>>ASSIGN     15>>ASSIGN     15>>ASSIGN
        15>>ASSIGN     15>>ASSIGN     15>>ASSIGN
ENTRIES#
        13**DCL         7--PROC       15>>ASSIGN
HASH_VAL
         9**DCL         7--PROC       15<<ASSIGN

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:89   
      299        1        /*T***********************************************************/
      300        2        /*T*                                                         */
      301        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      302        4        /*T*                                                         */
      303        5        /*T***********************************************************/
      304        6        %EJECT;
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:90   
      305        7        ZII$WRT_COMP_REC: PROC ALTRET AVOID($PR5,$PR6,$PR7);
      306        8        /**********************************************************
      307        9        This routine updates the subschema file by putting in or updating
      308       10        an existing compilation unit record when a user makes a call to the
      309       11        build tables routines. This code was duplicated from the way that cobol
      310       12        updates the  subschema file., so as to be in
      311       13        ***********************************************************/
      312       14        /******************Auto  dcls***************/
      313       15    1   DCL RNUMB UBIN(36);
      314       16    1   DCL I UBIN(36) ;
      315       17        /***********************Ext dcls*****************/
      316       18    1   DCL REC$ PTR EXT;
      317       19    1   DCL 1 SUBSCH EXT,
      318       20    1         2 NAME,
      319       21    1           3 CNT UBIN(9) UNAL,
      320       22    1           3 TEXT CHAR(32) UNAL,
      321       23    1         2 DCB# UBIN(18) ALIGNED;
      322       24    1   DCL 1 TMP_KEY EXT,
      323       25    1         2 LEN UBIN(9) UNAL,
      324       26    1         2 ACT_KEY UBIN(27) UNAL;
      325       27    1   DCL 1 SUBSCH_CON_BLK EXT,
      326       28    1         2 * (0:63) UBIN(36) UNAL;
      327       29    1   DCL SUB_CONBLK$ PTR EXT;
      328       30    1   DCL 1 I_O_BUF EXT,
      329       31    1         2 REC (0:1) CHAR(128) UNAL;
      330       32    1   DCL I_O_IDX UBIN(36) EXT;
      331       33    1   DCL ERROR_CODE UBIN(36) EXT;
      332       34    1   DCL SYS_ID CHAR(32) EXT;
      333       35    1   DCL B$JIT$ PTR SYMREF;
      334       36    1   DCL B$TCB$ PTR SYMREF;
      335       37        /*******************Include files*****************/
      336       38        %INCLUDE B_ERRORS_C;
      337     1165        %INCLUDE B$JIT;
      338     1455        %INCLUDE CP_6;
      339     1536        %INCLUDE CP_6_SUBS;
      340     2076        %FPT_OPEN(FPTN=OPEN_FPT,FUN=UPDATE,ORG=KEYED,ACS=DIRECT,ASN=FILE,SETDCB=YES,SHARE=
              2076            ALL);
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:91   
      341     2185        %VLP_NAME (FPTN=PIST,NAME ='HIST');
      342     2212        %FPT_ENQ(FPTN=ENQ_FPT,WAIT=YES,WAIT_TIME=-1,SHARE=NONE,RNAME=PIST);
      343     2230        %FPT_DEQ(FPTN=DEQ_FPT,RNAME=PIST,RELRES=NO);
      344     2247        %FPT_OPEN(FPTN=RES_FPT,REASSIGN=YES,SETDCB=NO);
      345     2356        %FPT_CLOSE(FPTN=CLOSE_FPT);
      346     2398        %FPT_READ (FPTN=READ_FPT,KEYS=YES,BUF=I_O_BUF,KEY=TMP_KEY);
      347     2437        %FPT_WRITE(FPTN=WRITE_FPT,KEY=TMP_KEY,BUF=I_O_BUF);
      348     2468        %FPT_TIME(FPTN=TIME_FPT,SOURCE=CLOCK);
      349     2487        %F$DCB;
      350     2544        %B$TCB;
      351     2547        %B$EXCFR;
      352     2565        %INCLUDE ZI_SUB_LANG;
      353     4280        %CONTROL_BLOCK (STCLASS="BASED(SUB_CONBLK$)");
      354     4388        %COMPILATION_UNIT_REC (STCLASS="BASED(REC$)");
      355     4421        %INCLUDE ZI_ERRORS_SUBS;
      356     4941        /*****************Program procedure************/
      357     4942    1       OPEN_FPT.V.DCB#=SUBSCH.DCB#;
      358     4943    1       OPEN_FPT.V.SHARE#=%NONE#;
      359     4944    1       CALL M$OPEN(OPEN_FPT) ALTRET(ER_OPEN);
      360     4945    1       RES_FPT.V.DCB#=SUBSCH.DCB#;
      361     4946    1       CALL M$OPEN(RES_FPT) ALTRET(ER_OPEN);
      362     4947    1       ENQ_FPT.V.DCB#=SUBSCH.DCB#;
      363     4948    1       DEQ_FPT.V.DCB#=SUBSCH.DCB#;
      364     4949    1   DOENQ:
      365     4950    1       CALL M$ENQ(ENQ_FPT) ALTRET(ER_ENQ);
      366     4951    1       TMP_KEY.LEN=3;
      367     4952    1       TMP_KEY.ACT_KEY=0;
      368     4953    1       WRITE_FPT.V.DCB#=SUBSCH.DCB#;
      369     4954    1       READ_FPT.V.DCB#=SUBSCH.DCB#;
      370     4955    1       CALL M$READ(READ_FPT) ALTRET(ER_READ);
      371     4956    1   UPDAT:
      372     4957    1       RNUMB=0;
      373     4958    1       IF CONTROL.FIRST_CU_RECORD = 0 THEN
      374     4959    2       DO;
      375     4960    2           CONTROL.FIRST_CU_RECORD=CONTROL.NEXT_AVAILABLE_RECORD;
      376     4961    2           CONTROL.NEXT_AVAILABLE_RECORD=CONTROL.NEXT_AVAILABLE_RECORD+1;
      377     4962    2           TMP_KEY.ACT_KEY=0;
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:92   
      378     4963    2           WRITE_FPT.BUF_=VECTOR(CONTROL);
      379     4964    2           CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);
      380     4965    2           RNUMB=CONTROL.FIRST_CU_RECORD;
      381     4966    2           CALL READ ALTRET(ER_READ);
      382     4967    2   ADDTO:
      383     4968    2           COMPILATION_UNIT_REC='0'B;
      384     4969    2           COMPILATION_UNIT_REC.NEXT_CU_RECORD=0;
      385     4970    2           COMPILATION_UNIT_REC.TYPE=1000;
      386     4971    2           COMPILATION_UNIT_REC.PROGRAM_ID= SYS_ID;
      387     4972    2           COMPILATION_UNIT_REC.AUTHOR=B$JIT$->B$JIT.ACCN;
      388     4973    2           TIME_FPT.TSTAMP_=VECTOR(COMPILATION_UNIT_REC.COMP_UTS);
      389     4974    2           CALL M$TIME(TIME_FPT) ALTRET(ER_TIME);
      390     4975    2           COMPILATION_UNIT_REC.TRN_UTS=CONTROL.SUBSCHEMA_UTS;
      391     4976    2           WRITE_FPT.BUF_=VECTOR(I_O_BUF);
      392     4977    2           CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);
      393     4978    2           GOTO DODEQ;
      394     4979    2           END;
      395     4980    1       RNUMB=CONTROL.FIRST_CU_RECORD;
      396     4981    1   AGAIN:
      397     4982    1       CALL READ ALTRET(ADDAG);
      398     4983    1       IF COMPILATION_UNIT_REC.PROGRAM_ID = SYS_ID THEN
      399     4984    2       DO;
      400     4985    2           TIME_FPT.TSTAMP_=VECTOR(COMPILATION_UNIT_REC.COMP_UTS);
      401     4986    2           CALL M$TIME(TIME_FPT) ALTRET(ER_TIME);
      402     4987    2           COMPILATION_UNIT_REC.AUTHOR=B$JIT$->B$JIT.ACCN;
      403     4988    2           WRITE_FPT.BUF_=VECTOR(I_O_BUF);
      404     4989    2           CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);
      405     4990    2           GOTO DODEQ;
      406     4991    2           END;
      407     4992    1       RNUMB=COMPILATION_UNIT_REC.NEXT_CU_RECORD;
      408     4993    1       IF COMPILATION_UNIT_REC.NEXT_CU_RECORD ~= 0 THEN GOTO AGAIN;
      409     4994    1       COMPILATION_UNIT_REC.NEXT_CU_RECORD=CONTROL.NEXT_AVAILABLE_RECORD;
      410     4995    1       WRITE_FPT.BUF_=VECTOR(I_O_BUF);
      411     4996    1       CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);
      412     4997    1       RNUMB=CONTROL.NEXT_AVAILABLE_RECORD;
      413     4998    1       CALL READ ALTRET(ADDAG);
      414     4999    1   ADDAG:
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:93   
      415     5000    1       COMPILATION_UNIT_REC='0'B;
      416     5001    1       COMPILATION_UNIT_REC='0'B;
      417     5002    1       COMPILATION_UNIT_REC.NEXT_CU_RECORD=0;
      418     5003    1       COMPILATION_UNIT_REC.TYPE=1000;
      419     5004    1       COMPILATION_UNIT_REC.PROGRAM_ID=SYS_ID;
      420     5005    1       COMPILATION_UNIT_REC.AUTHOR=B$JIT$->B$JIT.ACCN;
      421     5006    1       TIME_FPT.TSTAMP_=VECTOR(COMPILATION_UNIT_REC.COMP_UTS);
      422     5007    1       CALL M$TIME(TIME_FPT) ALTRET(ER_TIME);
      423     5008    1       COMPILATION_UNIT_REC.TRN_UTS=CONTROL.SUBSCHEMA_UTS;
      424     5009    1       WRITE_FPT.BUF_=VECTOR(I_O_BUF);
      425     5010    1       CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);
      426     5011    1       CONTROL.NEXT_AVAILABLE_RECORD=CONTROL.NEXT_AVAILABLE_RECORD+1;
      427     5012    1       TMP_KEY.ACT_KEY=0;
      428     5013    1       WRITE_FPT.BUF_=VECTOR(CONTROL);
      429     5014    1       CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);
      430     5015    1   DODEQ:
      431     5016    1       CALL M$DEQ(DEQ_FPT) ALTRET(ER_DEQ);
      432     5017    1       GOTO CLSE_UP;
      433     5018    1   READ: PROC ALTRET;
      434     5019    2   DCL REM UBIN(18) STATIC;
      435     5020    2       I=RNUMB/2;
      436     5021    2       REM=MOD(RNUMB,2);
      437     5022    2       IF I = TMP_KEY.ACT_KEY THEN;
      438     5023    3       ELSE DO;
      439     5024    3           TMP_KEY.ACT_KEY=I;
      440     5025    3           CALL M$READ(READ_FPT) ALTRET(ER_READ);
      441     5026    3           END;
      442     5027    2       IF REM =0 THEN REC$=ADDR(I_O_BUF);
      443     5028    2       ELSE REC$=PINCRW(ADDR(I_O_BUF),32);
      444     5029    2       RETURN;
      445     5030    2   ER_READ:
      446     5031    2       IF B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.ERR# = %E$NOKEY THEN
      447     5032    3       DO;
      448     5033    3           REC$=ADDR(I_O_BUF);
      449     5034    3           I_O_BUF='0'B;
      450     5035    3           RETURN;
      451     5036    3           END;
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:94   
      452     5037    2       ELSE ALTRETURN;
      453     5038    2   END READ;
      454     5039    1   CLSE_UP:
      455     5040    1       CALL M$DEQ(DEQ_FPT) ALTRET(CONT);
      456     5041    1   CONT:
      457     5042    1       CLOSE_FPT.V.DCB#=SUBSCH.DCB#;
      458     5043    1       CALL M$CLOSE(CLOSE_FPT) ALTRET (ER_CLOSE);
      459     5044    1   RET:
      460     5045    1       RETURN;
      461     5046    1   ER_ENQ: ;
      462     5047    1   ER_OPEN:
      463     5048        /**************************************************************/
      464     5049        /*
      465     5050              ERROR: ZII-#OPNER-C
      466     5051        MESSAGE: Cannot open the subschema file %U1.
      467     5052        */
      468     5053        /**********************************************************/
      469     5054    1       ERROR_CODE=#OPNER;
      470     5055    1       GOTO NOOP;
      471     5056    1   ER_READ:
      472     5057        /**********************************************************/
      473     5058        /*
      474     5059              ERROR: ZII-#BADREAD-C
      475     5060        MESSAGE: Cannot read subschema %U1.
      476     5061        */
      477     5062        /**********************************************************/
      478     5063    1       ERROR_CODE=#BADREAD;
      479     5064    1       GOTO COM_ERR;
      480     5065    1   ER_DEQ: ;
      481     5066    1   ER_CLOSE:
      482     5067        /************************************************************/
      483     5068        /*
      484     5069            ERROR: ZII-#CLOSE_ER-C
      485     5070            MESSAGE: Error in closing the subschema file.
      486     5071        */
      487     5072        /**********************************************************/
      488     5073    1       ERROR_CODE=#CLOSE_ER;
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:95   
      489     5074    1       GOTO COM_ERR;
      490     5075    1   ER_TIME:
      491     5076        /***********************************************************/
      492     5077        /*
      493     5078            ERROR: ZII-#BADTME-C
      494     5079            MESSAGE: Cannot put the TSTAMP in the compilation unit record of subschema %U1.
      495     5080        */
      496     5081        /************************************************************/
      497     5082    1       ERROR_CODE=#BADTME;
      498     5083    1       GOTO COM_ERR;
      499     5084    1   ER_WRT:
      500     5085        /************************************************************/
      501     5086        /*E*
      502     5087            ERROR: ZII-#WRT_ER-C
      503     5088            MESSAGE: Cannot write compilation unit record to subschema.
      504     5089        */
      505     5090        /**********************************************************/
      506     5091    1       ERROR_CODE=#WRT_ER;
      507     5092    1       GOTO COM_ERR;
      508     5093    1   COM_ERR:
      509     5094    1       CALL M$DEQ(DEQ_FPT) ALTRET(NOOP);
      510     5095    1   NOOP:
      511     5096    1       CLOSE_FPT.V.DCB#=SUBSCH.DCB#;
      512     5097    1       IF DCBADDR(SUBSCH.DCB#)->F$DCB.FCD# THEN
      513     5098    1           CALL M$CLOSE(CLOSE_FPT);
      514     5099    1       ALTRETURN;
      515     5100    1   END ZII$WRT_COMP_REC;
      516     5101        %EOD;

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:96   
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$WRT_COMP_REC.

   Procedure ZII$WRT_COMP_REC requires 291 words for executable code.
   Procedure ZII$WRT_COMP_REC requires 10 words of local(AUTO) storage.

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:97   

 Object Unit name= ZII$WRT_COMP_REC                           File name= ZII$MSC_PROC.:ZIC0TOU
 UTS= SEP 05 '97 12:30:42.88 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  REC$
    1  LblCom even  none    10     12  SUBSCH
    2  LblCom even  none     1      1  TMP_KEY
    3  LblCom even  none    64    100  SUBSCH_CON_BLK
    4  LblCom even  none     1      1  SUB_CONBLK$
    5  LblCom even  none    64    100  I_O_BUF
    6  LblCom even  none     1      1  I_O_IDX
    7  LblCom even  none     1      1  ERROR_CODE
    8  LblCom even  none     8     10  SYS_ID
    9   DCB   even  none     0      0  M$UC
   10   Data  even  none   205    315  ZII$WRT_COMP_REC
   11   Proc  even  none   291    443  ZII$WRT_COMP_REC
   12  RoData even  none     8     10  ZII$WRT_COMP_REC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes    yes     yes      XStd       0  ZII$WRT_COMP_REC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:98   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B$TCB$                                M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:99   


      299        1        /*T***********************************************************/
      300        2        /*T*                                                         */
      301        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      302        4        /*T*                                                         */
      303        5        /*T***********************************************************/
      304        6        %EJECT;
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:100  
      305        7        ZII$WRT_COMP_REC: PROC ALTRET AVOID($PR5,$PR6,$PR7);

      7 11 000000   000000 700200 xent  ZII$WRT_COM* TSX0  ! X66_AUTO_0
        11 000001   000012 000000                    ZERO    10,0

      306        8        /**********************************************************
      307        9        This routine updates the subschema file by putting in or updating
      308       10        an existing compilation unit record when a user makes a call to the
      309       11        build tables routines. This code was duplicated from the way that cobol
      310       12        updates the  subschema file., so as to be in
      311       13        ***********************************************************/
      312       14        /******************Auto  dcls***************/
      313       15    1   DCL RNUMB UBIN(36);
      314       16    1   DCL I UBIN(36) ;
      315       17        /***********************Ext dcls*****************/
      316       18    1   DCL REC$ PTR EXT;
      317       19    1   DCL 1 SUBSCH EXT,
      318       20    1         2 NAME,
      319       21    1           3 CNT UBIN(9) UNAL,
      320       22    1           3 TEXT CHAR(32) UNAL,
      321       23    1         2 DCB# UBIN(18) ALIGNED;
      322       24    1   DCL 1 TMP_KEY EXT,
      323       25    1         2 LEN UBIN(9) UNAL,
      324       26    1         2 ACT_KEY UBIN(27) UNAL;
      325       27    1   DCL 1 SUBSCH_CON_BLK EXT,
      326       28    1         2 * (0:63) UBIN(36) UNAL;
      327       29    1   DCL SUB_CONBLK$ PTR EXT;
      328       30    1   DCL 1 I_O_BUF EXT,
      329       31    1         2 REC (0:1) CHAR(128) UNAL;
      330       32    1   DCL I_O_IDX UBIN(36) EXT;
      331       33    1   DCL ERROR_CODE UBIN(36) EXT;
      332       34    1   DCL SYS_ID CHAR(32) EXT;
      333       35    1   DCL B$JIT$ PTR SYMREF;
      334       36    1   DCL B$TCB$ PTR SYMREF;
      335       37        /*******************Include files*****************/
      336       38        %INCLUDE B_ERRORS_C;
      337     1165        %INCLUDE B$JIT;
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:101  
      338     1455        %INCLUDE CP_6;
      339     1536        %INCLUDE CP_6_SUBS;
      340     2076        %FPT_OPEN(FPTN=OPEN_FPT,FUN=UPDATE,ORG=KEYED,ACS=DIRECT,ASN=FILE,SETDCB=YES,SHARE=
              2076            ALL);
      341     2185        %VLP_NAME (FPTN=PIST,NAME ='HIST');
      342     2212        %FPT_ENQ(FPTN=ENQ_FPT,WAIT=YES,WAIT_TIME=-1,SHARE=NONE,RNAME=PIST);
      343     2230        %FPT_DEQ(FPTN=DEQ_FPT,RNAME=PIST,RELRES=NO);
      344     2247        %FPT_OPEN(FPTN=RES_FPT,REASSIGN=YES,SETDCB=NO);
      345     2356        %FPT_CLOSE(FPTN=CLOSE_FPT);
      346     2398        %FPT_READ (FPTN=READ_FPT,KEYS=YES,BUF=I_O_BUF,KEY=TMP_KEY);
      347     2437        %FPT_WRITE(FPTN=WRITE_FPT,KEY=TMP_KEY,BUF=I_O_BUF);
      348     2468        %FPT_TIME(FPTN=TIME_FPT,SOURCE=CLOCK);
      349     2487        %F$DCB;
      350     2544        %B$TCB;
      351     2547        %B$EXCFR;
      352     2565        %INCLUDE ZI_SUB_LANG;
      353     4280        %CONTROL_BLOCK (STCLASS="BASED(SUB_CONBLK$)");
      354     4388        %COMPILATION_UNIT_REC (STCLASS="BASED(REC$)");
      355     4421        %INCLUDE ZI_ERRORS_SUBS;
      356     4941        /*****************Program procedure************/
      357     4942    1       OPEN_FPT.V.DCB#=SUBSCH.DCB#;

   4942 11 000002   000011 220000 1                  LDX0    SUBSCH+9
        11 000003   000044 740000 10                 STX0    OPEN_FPT+36

      358     4943    1       OPEN_FPT.V.SHARE#=%NONE#;

   4943 11 000004   000030 236007                    LDQ     24,DL
        11 000005   000044 256000 10                 ORSQ    OPEN_FPT+36

      359     4944    1       CALL M$OPEN(OPEN_FPT) ALTRET(ER_OPEN);

   4944 11 000006   000000 630400 10                 EPPR0   OPEN_FPT
        11 000007   450000 713400                    CLIMB   alt,open
        11 000010   410400 401760                    pmme    nvectors=18
        11 000011   000404 702000 11                 TSX2    ER_ENQ

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:102  
      360     4945    1       RES_FPT.V.DCB#=SUBSCH.DCB#;

   4945 11 000012   000011 220000 1                  LDX0    SUBSCH+9
        11 000013   000162 740000 10                 STX0    RES_FPT+36

      361     4946    1       CALL M$OPEN(RES_FPT) ALTRET(ER_OPEN);

   4946 11 000014   000116 630400 10                 EPPR0   RES_FPT
        11 000015   450000 713400                    CLIMB   alt,open
        11 000016   410400 401760                    pmme    nvectors=18
        11 000017   000404 702000 11                 TSX2    ER_ENQ

      362     4947    1       ENQ_FPT.V.DCB#=SUBSCH.DCB#;

   4947 11 000020   000011 220000 1                  LDX0    SUBSCH+9
        11 000021   000102 740000 10                 STX0    ENQ_FPT+6

      363     4948    1       DEQ_FPT.V.DCB#=SUBSCH.DCB#;

   4948 11 000022   000114 740000 10                 STX0    DEQ_FPT+6

      364     4949    1   DOENQ:
      365     4950    1       CALL M$ENQ(ENQ_FPT) ALTRET(ER_ENQ);

   4950 11 000023   000074 630400 10    DOENQ        EPPR0   ENQ_FPT
        11 000024   420002 713400                    CLIMB   alt,+8194
        11 000025   401000 401760                    pmme    nvectors=3
        11 000026   000404 702000 11                 TSX2    ER_ENQ

      366     4951    1       TMP_KEY.LEN=3;

   4951 11 000027   003000 236003                    LDQ     1536,DU
        11 000030   000000 552040 2                  STBQ    TMP_KEY,'40'O

      367     4952    1       TMP_KEY.ACT_KEY=0;

   4952 11 000031   000000 236003                    LDQ     0,DU
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:103  
        11 000032   000000 552034 2                  STBQ    TMP_KEY,'34'O

      368     4953    1       WRITE_FPT.V.DCB#=SUBSCH.DCB#;

   4953 11 000033   000011 220000 1                  LDX0    SUBSCH+9
        11 000034   000274 740000 10                 STX0    WRITE_FPT+8

      369     4954    1       READ_FPT.V.DCB#=SUBSCH.DCB#;

   4954 11 000035   000256 740000 10                 STX0    READ_FPT+8

      370     4955    1       CALL M$READ(READ_FPT) ALTRET(ER_READ);

   4955 11 000036   000246 630400 10                 EPPR0   READ_FPT
        11 000037   440000 713400                    CLIMB   alt,read
        11 000040   401400 401760                    pmme    nvectors=4
        11 000041   000407 702000 11                 TSX2    ER_READ

      371     4956    1   UPDAT:
      372     4957    1       RNUMB=0;

   4957 11 000042   200003 450100       UPDAT        STZ     RNUMB,,AUTO

      373     4958    1       IF CONTROL.FIRST_CU_RECORD = 0 THEN

   4958 11 000043   000000 470400 4                  LDP0    SUB_CONBLK$
        11 000044   000073 235100                    LDA     59,,PR0
        11 000045   000137 601000 11                 TNZ     s:4980

      374     4959    2       DO;

      375     4960    2           CONTROL.FIRST_CU_RECORD=CONTROL.NEXT_AVAILABLE_RECORD;

   4960 11 000046   000072 235100                    LDA     58,,PR0
        11 000047   000073 755100                    STA     59,,PR0

      376     4961    2           CONTROL.NEXT_AVAILABLE_RECORD=CONTROL.NEXT_AVAILABLE_RECORD+1;
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:104  

   4961 11 000050   000001 035007                    ADLA    1,DL
        11 000051   000072 755100                    STA     58,,PR0

      377     4962    2           TMP_KEY.ACT_KEY=0;

   4962 11 000052   000000 236003                    LDQ     0,DU
        11 000053   000000 552034 2                  STBQ    TMP_KEY,'34'O

      378     4963    2           WRITE_FPT.BUF_=VECTOR(CONTROL);

   4963 11 000054   000000 235000 12                 LDA     0
        11 000055   000000 236000 4                  LDQ     SUB_CONBLK$
        11 000056   000270 757000 10                 STAQ    WRITE_FPT+4

      379     4964    2           CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);

   4964 11 000057   000264 630400 10                 EPPR0   WRITE_FPT
        11 000060   440001 713400                    CLIMB   alt,write
        11 000061   401400 401760                    pmme    nvectors=4
        11 000062   000420 702000 11                 TSX2    ER_WRT

      380     4965    2           RNUMB=CONTROL.FIRST_CU_RECORD;

   4965 11 000063   000000 470400 4                  LDP0    SUB_CONBLK$
        11 000064   000073 235100                    LDA     59,,PR0
        11 000065   200003 755100                    STA     RNUMB,,AUTO

      381     4966    2           CALL READ ALTRET(ER_READ);

   4966 11 000066   000317 701000 11                 TSX1    READ
        11 000067   000407 702000 11                 TSX2    ER_READ

      382     4967    2   ADDTO:
      383     4968    2           COMPILATION_UNIT_REC='0'B;

   4968 11 000070   000000 470400 0     ADDTO        LDP0    REC$
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:105  
        11 000071   000100 100400                    MLR     fill='000'O
        11 000072   000001 000001 12                 ADSC9   1                        cn=0,n=1
        11 000073   000000 000200                    ADSC9   0,,PR0                   cn=0,n=128

      384     4969    2           COMPILATION_UNIT_REC.NEXT_CU_RECORD=0;

   4969 11 000074   000000 470400 0                  LDP0    REC$
        11 000075   000100 100400                    MLR     fill='000'O
        11 000076   000001 000004 12                 ADSC9   1                        cn=0,n=4
        11 000077   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      385     4970    2           COMPILATION_UNIT_REC.TYPE=1000;

   4970 11 000100   000000 470400 0                  LDP0    REC$
        11 000101   000100 100400                    MLR     fill='000'O
        11 000102   000002 000004 12                 ADSC9   2                        cn=0,n=4
        11 000103   000003 000004                    ADSC9   3,,PR0                   cn=0,n=4

      386     4971    2           COMPILATION_UNIT_REC.PROGRAM_ID= SYS_ID;

   4971 11 000104   040100 100400                    MLR     fill='040'O
        11 000105   000000 000040 8                  ADSC9   SYS_ID                   cn=0,n=32
        11 000106   000004 000040                    ADSC9   4,,PR0                   cn=0,n=32

      387     4972    2           COMPILATION_UNIT_REC.AUTHOR=B$JIT$->B$JIT.ACCN;

   4972 11 000107   000000 471400 xsym               LDP1    B$JIT$
        11 000110   040100 100500                    MLR     fill='040'O
        11 000111   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
        11 000112   000014 000040                    ADSC9   12,,PR0                  cn=0,n=32

      388     4973    2           TIME_FPT.TSTAMP_=VECTOR(COMPILATION_UNIT_REC.COMP_UTS);

   4973 11 000113   777640 235007                    LDA     -96,DL
        11 000114   000000 236000 0                  LDQ     REC$
        11 000115   000025 036003                    ADLQ    21,DU
        11 000116   000310 757000 10                 STAQ    TIME_FPT+8
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:106  

      389     4974    2           CALL M$TIME(TIME_FPT) ALTRET(ER_TIME);

   4974 11 000117   000300 630400 10                 EPPR0   TIME_FPT
        11 000120   420004 713400                    CLIMB   alt,+8196
        11 000121   402000 401760                    pmme    nvectors=5
        11 000122   000415 702000 11                 TSX2    ER_TIME

      390     4975    2           COMPILATION_UNIT_REC.TRN_UTS=CONTROL.SUBSCHEMA_UTS;

   4975 11 000123   000000 470400 4                  LDP0    SUB_CONBLK$
        11 000124   000000 471400 0                  LDP1    REC$
        11 000125   000100 100500                    MLR     fill='000'O
        11 000126   000053 000004                    ADSC9   43,,PR0                  cn=0,n=4
        11 000127   100027 000004                    ADSC9   23,,PR1                  cn=0,n=4

      391     4976    2           WRITE_FPT.BUF_=VECTOR(I_O_BUF);

   4976 11 000130   000004 237000 12                 LDAQ    4
        11 000131   000270 757000 10                 STAQ    WRITE_FPT+4

      392     4977    2           CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);

   4977 11 000132   000264 630400 10                 EPPR0   WRITE_FPT
        11 000133   440001 713400                    CLIMB   alt,write
        11 000134   401400 401760                    pmme    nvectors=4
        11 000135   000420 702000 11                 TSX2    ER_WRT

      393     4978    2           GOTO DODEQ;

   4978 11 000136   000312 710000 11                 TRA     DODEQ

      394     4979    2           END;
      395     4980    1       RNUMB=CONTROL.FIRST_CU_RECORD;

   4980 11 000137   200003 755100                    STA     RNUMB,,AUTO

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:107  
      396     4981    1   AGAIN:
      397     4982    1       CALL READ ALTRET(ADDAG);

   4982 11 000140   000317 701000 11    AGAIN        TSX1    READ
        11 000141   000223 702000 11                 TSX2    ADDAG

      398     4983    1       IF COMPILATION_UNIT_REC.PROGRAM_ID = SYS_ID THEN

   4983 11 000142   000000 470400 0                  LDP0    REC$
        11 000143   040000 106500                    CMPC    fill='040'O
        11 000144   000004 000040                    ADSC9   4,,PR0                   cn=0,n=32
        11 000145   000000 000040 8                  ADSC9   SYS_ID                   cn=0,n=32
        11 000146   000173 601000 11                 TNZ     s:4992

      399     4984    2       DO;

      400     4985    2           TIME_FPT.TSTAMP_=VECTOR(COMPILATION_UNIT_REC.COMP_UTS);

   4985 11 000147   777640 235007                    LDA     -96,DL
        11 000150   000000 236000 0                  LDQ     REC$
        11 000151   000025 036003                    ADLQ    21,DU
        11 000152   000310 757000 10                 STAQ    TIME_FPT+8

      401     4986    2           CALL M$TIME(TIME_FPT) ALTRET(ER_TIME);

   4986 11 000153   000300 630400 10                 EPPR0   TIME_FPT
        11 000154   420004 713400                    CLIMB   alt,+8196
        11 000155   402000 401760                    pmme    nvectors=5
        11 000156   000415 702000 11                 TSX2    ER_TIME

      402     4987    2           COMPILATION_UNIT_REC.AUTHOR=B$JIT$->B$JIT.ACCN;

   4987 11 000157   000000 470400 xsym               LDP0    B$JIT$
        11 000160   000000 471400 0                  LDP1    REC$
        11 000161   040100 100500                    MLR     fill='040'O
        11 000162   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        11 000163   100014 000040                    ADSC9   12,,PR1                  cn=0,n=32
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:108  

      403     4988    2           WRITE_FPT.BUF_=VECTOR(I_O_BUF);

   4988 11 000164   000004 237000 12                 LDAQ    4
        11 000165   000270 757000 10                 STAQ    WRITE_FPT+4

      404     4989    2           CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);

   4989 11 000166   000264 630400 10                 EPPR0   WRITE_FPT
        11 000167   440001 713400                    CLIMB   alt,write
        11 000170   401400 401760                    pmme    nvectors=4
        11 000171   000420 702000 11                 TSX2    ER_WRT

      405     4990    2           GOTO DODEQ;

   4990 11 000172   000312 710000 11                 TRA     DODEQ

      406     4991    2           END;
      407     4992    1       RNUMB=COMPILATION_UNIT_REC.NEXT_CU_RECORD;

   4992 11 000173   000100 100500                    MLR     fill='000'O
        11 000174   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        11 000175   200003 000004                    ADSC9   RNUMB,,AUTO              cn=0,n=4

      408     4993    1       IF COMPILATION_UNIT_REC.NEXT_CU_RECORD ~= 0 THEN GOTO AGAIN;

   4993 11 000176   000100 100500                    MLR     fill='000'O
        11 000177   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        11 000200   200010 000004                    ADSC9   I+4,,AUTO                cn=0,n=4
        11 000201   200010 236100                    LDQ     I+4,,AUTO
        11 000202   000000 116003                    CMPQ    0,DU
        11 000203   000140 601000 11                 TNZ     AGAIN

      409     4994    1       COMPILATION_UNIT_REC.NEXT_CU_RECORD=CONTROL.NEXT_AVAILABLE_RECORD;

   4994 11 000204   000000 471400 4                  LDP1    SUB_CONBLK$
        11 000205   000100 100500                    MLR     fill='000'O
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:109  
        11 000206   100072 000004                    ADSC9   58,,PR1                  cn=0,n=4
        11 000207   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      410     4995    1       WRITE_FPT.BUF_=VECTOR(I_O_BUF);

   4995 11 000210   000004 237000 12                 LDAQ    4
        11 000211   000270 757000 10                 STAQ    WRITE_FPT+4

      411     4996    1       CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);

   4996 11 000212   000264 630400 10                 EPPR0   WRITE_FPT
        11 000213   440001 713400                    CLIMB   alt,write
        11 000214   401400 401760                    pmme    nvectors=4
        11 000215   000420 702000 11                 TSX2    ER_WRT

      412     4997    1       RNUMB=CONTROL.NEXT_AVAILABLE_RECORD;

   4997 11 000216   000000 470400 4                  LDP0    SUB_CONBLK$
        11 000217   000072 235100                    LDA     58,,PR0
        11 000220   200003 755100                    STA     RNUMB,,AUTO

      413     4998    1       CALL READ ALTRET(ADDAG);

   4998 11 000221   000317 701000 11                 TSX1    READ
        11 000222   000223 702000 11                 TSX2    ADDAG

      414     4999    1   ADDAG:
      415     5000    1       COMPILATION_UNIT_REC='0'B;

   5000 11 000223   000000 470400 0     ADDAG        LDP0    REC$
        11 000224   000100 100400                    MLR     fill='000'O
        11 000225   000001 000001 12                 ADSC9   1                        cn=0,n=1
        11 000226   000000 000200                    ADSC9   0,,PR0                   cn=0,n=128

      416     5001    1       COMPILATION_UNIT_REC='0'B;

   5001 11 000227   000000 470400 0                  LDP0    REC$
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:110  
        11 000230   000100 100400                    MLR     fill='000'O
        11 000231   000001 000001 12                 ADSC9   1                        cn=0,n=1
        11 000232   000000 000200                    ADSC9   0,,PR0                   cn=0,n=128

      417     5002    1       COMPILATION_UNIT_REC.NEXT_CU_RECORD=0;

   5002 11 000233   000000 470400 0                  LDP0    REC$
        11 000234   000100 100400                    MLR     fill='000'O
        11 000235   000001 000004 12                 ADSC9   1                        cn=0,n=4
        11 000236   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      418     5003    1       COMPILATION_UNIT_REC.TYPE=1000;

   5003 11 000237   000000 470400 0                  LDP0    REC$
        11 000240   000100 100400                    MLR     fill='000'O
        11 000241   000002 000004 12                 ADSC9   2                        cn=0,n=4
        11 000242   000003 000004                    ADSC9   3,,PR0                   cn=0,n=4

      419     5004    1       COMPILATION_UNIT_REC.PROGRAM_ID=SYS_ID;

   5004 11 000243   040100 100400                    MLR     fill='040'O
        11 000244   000000 000040 8                  ADSC9   SYS_ID                   cn=0,n=32
        11 000245   000004 000040                    ADSC9   4,,PR0                   cn=0,n=32

      420     5005    1       COMPILATION_UNIT_REC.AUTHOR=B$JIT$->B$JIT.ACCN;

   5005 11 000246   000000 471400 xsym               LDP1    B$JIT$
        11 000247   040100 100500                    MLR     fill='040'O
        11 000250   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
        11 000251   000014 000040                    ADSC9   12,,PR0                  cn=0,n=32

      421     5006    1       TIME_FPT.TSTAMP_=VECTOR(COMPILATION_UNIT_REC.COMP_UTS);

   5006 11 000252   777640 235007                    LDA     -96,DL
        11 000253   000000 236000 0                  LDQ     REC$
        11 000254   000025 036003                    ADLQ    21,DU
        11 000255   000310 757000 10                 STAQ    TIME_FPT+8
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:111  

      422     5007    1       CALL M$TIME(TIME_FPT) ALTRET(ER_TIME);

   5007 11 000256   000300 630400 10                 EPPR0   TIME_FPT
        11 000257   420004 713400                    CLIMB   alt,+8196
        11 000260   402000 401760                    pmme    nvectors=5
        11 000261   000415 702000 11                 TSX2    ER_TIME

      423     5008    1       COMPILATION_UNIT_REC.TRN_UTS=CONTROL.SUBSCHEMA_UTS;

   5008 11 000262   000000 470400 4                  LDP0    SUB_CONBLK$
        11 000263   000000 471400 0                  LDP1    REC$
        11 000264   000100 100500                    MLR     fill='000'O
        11 000265   000053 000004                    ADSC9   43,,PR0                  cn=0,n=4
        11 000266   100027 000004                    ADSC9   23,,PR1                  cn=0,n=4

      424     5009    1       WRITE_FPT.BUF_=VECTOR(I_O_BUF);

   5009 11 000267   000004 237000 12                 LDAQ    4
        11 000270   000270 757000 10                 STAQ    WRITE_FPT+4

      425     5010    1       CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);

   5010 11 000271   000264 630400 10                 EPPR0   WRITE_FPT
        11 000272   440001 713400                    CLIMB   alt,write
        11 000273   401400 401760                    pmme    nvectors=4
        11 000274   000420 702000 11                 TSX2    ER_WRT

      426     5011    1       CONTROL.NEXT_AVAILABLE_RECORD=CONTROL.NEXT_AVAILABLE_RECORD+1;

   5011 11 000275   000000 470400 4                  LDP0    SUB_CONBLK$
        11 000276   000072 235100                    LDA     58,,PR0
        11 000277   000001 035007                    ADLA    1,DL
        11 000300   000072 755100                    STA     58,,PR0

      427     5012    1       TMP_KEY.ACT_KEY=0;

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:112  
   5012 11 000301   000000 236003                    LDQ     0,DU
        11 000302   000000 552034 2                  STBQ    TMP_KEY,'34'O

      428     5013    1       WRITE_FPT.BUF_=VECTOR(CONTROL);

   5013 11 000303   000000 235000 12                 LDA     0
        11 000304   000000 236000 4                  LDQ     SUB_CONBLK$
        11 000305   000270 757000 10                 STAQ    WRITE_FPT+4

      429     5014    1       CALL M$WRITE(WRITE_FPT) ALTRET(ER_WRT);

   5014 11 000306   000264 630400 10                 EPPR0   WRITE_FPT
        11 000307   440001 713400                    CLIMB   alt,write
        11 000310   401400 401760                    pmme    nvectors=4
        11 000311   000420 702000 11                 TSX2    ER_WRT

      430     5015    1   DODEQ:
      431     5016    1       CALL M$DEQ(DEQ_FPT) ALTRET(ER_DEQ);

   5016 11 000312   000106 630400 10    DODEQ        EPPR0   DEQ_FPT
        11 000313   420003 713400                    CLIMB   alt,+8195
        11 000314   401000 401760                    pmme    nvectors=3
        11 000315   000412 702000 11                 TSX2    ER_DEQ

      432     5017    1       GOTO CLSE_UP;

   5017 11 000316   000371 710000 11                 TRA     CLSE_UP

      433     5018    1   READ: PROC ALTRET;

   5018 11 000317   200006 741300       READ         STX1  ! I+2,,AUTO

      434     5019    2   DCL REM UBIN(18) STATIC;
      435     5020    2       I=RNUMB/2;

   5020 11 000320   200003 236100                    LDQ     RNUMB,,AUTO
        11 000321   000001 772000                    QRL     1
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:113  
        11 000322   200004 756100                    STQ     I,,AUTO

      436     5021    2       REM=MOD(RNUMB,2);

   5021 11 000323   200003 236100                    LDQ     RNUMB,,AUTO
        11 000324   000001 376007                    ANQ     1,DL
        11 000325   000000 620006                    EAX0    0,QL
        11 000326   000314 740000 10                 STX0    REM

      437     5022    2       IF I = TMP_KEY.ACT_KEY THEN;

   5022 11 000327   000000 236000 2                  LDQ     TMP_KEY
        11 000330   000003 376000 12                 ANQ     3
        11 000331   200004 116100                    CMPQ    I,,AUTO
        11 000332   000341 600000 11                 TZE     s:5027

      438     5023    3       ELSE DO;

      439     5024    3           TMP_KEY.ACT_KEY=I;

   5024 11 000333   200004 236100                    LDQ     I,,AUTO
        11 000334   000000 552034 2                  STBQ    TMP_KEY,'34'O

      440     5025    3           CALL M$READ(READ_FPT) ALTRET(ER_READ);

   5025 11 000335   000246 630400 10                 EPPR0   READ_FPT
        11 000336   440000 713400                    CLIMB   alt,read
        11 000337   401400 401760                    pmme    nvectors=4
        11 000340   000352 702000 11                 TSX2    ER_READ

      441     5026    3           END;

      442     5027    2       IF REM =0 THEN REC$=ADDR(I_O_BUF);

   5027 11 000341   000314 220000 10                 LDX0    REM
        11 000342   000346 601000 11                 TNZ     s:5028

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:114  
   5027 11 000343   000005 236000 12                 LDQ     5
        11 000344   000000 756000 0                  STQ     REC$
        11 000345   000350 710000 11                 TRA     s:5029

      443     5028    2       ELSE REC$=PINCRW(ADDR(I_O_BUF),32);

   5028 11 000346   000006 236000 12                 LDQ     6
        11 000347   000000 756000 0                  STQ     REC$

      444     5029    2       RETURN;

   5029 11 000350   200006 221300                    LDX1  ! I+2,,AUTO
        11 000351   000001 702211                    TSX2  ! 1,X1

      445     5030    2   ER_READ:
      446     5031    2       IF B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.ERR# = %E$NOKEY THEN

   5031 11 000352   000000 470400 xsym  ER_READ      LDP0    B$TCB$
        11 000353   000000 471500                    LDP1    0,,PR0
        11 000354   100102 236100                    LDQ     66,,PR1
        11 000355   377770 376007                    ANQ     131064,DL
        11 000356   001020 116007                    CMPQ    528,DL
        11 000357   000367 601000 11                 TNZ     s:5037

      447     5032    3       DO;

      448     5033    3           REC$=ADDR(I_O_BUF);

   5033 11 000360   000005 236000 12                 LDQ     5
        11 000361   000000 756000 0                  STQ     REC$

      449     5034    3           I_O_BUF='0'B;

   5034 11 000362   000000 100400                    MLR     fill='000'O
        11 000363   000001 000001 12                 ADSC9   1                        cn=0,n=1
        11 000364   000000 000400 5                  ADSC9   I_O_BUF                  cn=0,n=256

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:115  
      450     5035    3           RETURN;

   5035 11 000365   200006 221300                    LDX1  ! I+2,,AUTO
        11 000366   000001 702211                    TSX2  ! 1,X1

      451     5036    3           END;
      452     5037    2       ELSE ALTRETURN;

   5037 11 000367   200006 221300                    LDX1  ! I+2,,AUTO
        11 000370   000000 702211                    TSX2  ! 0,X1

      453     5038    2   END READ;
      454     5039    1   CLSE_UP:
      455     5040    1       CALL M$DEQ(DEQ_FPT) ALTRET(CONT);

   5040 11 000371   000106 630400 10    CLSE_UP      EPPR0   DEQ_FPT
        11 000372   420003 713400                    CLIMB   alt,+8195
        11 000373   401000 401760                    pmme    nvectors=3
        11 000374   000375 702000 11                 TSX2    CONT

      456     5041    1   CONT:
      457     5042    1       CLOSE_FPT.V.DCB#=SUBSCH.DCB#;

   5042 11 000375   000011 220000 1     CONT         LDX0    SUBSCH+9
        11 000376   000242 740000 10                 STX0    CLOSE_FPT+26

      458     5043    1       CALL M$CLOSE(CLOSE_FPT) ALTRET (ER_CLOSE);

   5043 11 000377   000210 630400 10                 EPPR0   CLOSE_FPT
        11 000400   450001 713400                    CLIMB   alt,close
        11 000401   406000 401760                    pmme    nvectors=13
        11 000402   000412 702000 11                 TSX2    ER_DEQ

      459     5044    1   RET:
      460     5045    1       RETURN;

   5045 11 000403   000000 702200 xent  RET          TSX2  ! X66_ARET
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:116  

   5040 11 000404                       ER_ENQ       null
      461     5046    1   ER_ENQ: ;
      462     5047    1   ER_OPEN:
      463     5048        /**************************************************************/
      464     5049        /*
      465     5050              ERROR: ZII-#OPNER-C
      466     5051        MESSAGE: Cannot open the subschema file %U1.
      467     5052        */
      468     5053        /**********************************************************/
      469     5054    1       ERROR_CODE=#OPNER;

   5054 11 000404   011612 235007       ER_OPEN      LDA     5002,DL
        11 000405   000000 755000 7                  STA     ERROR_CODE

      470     5055    1       GOTO NOOP;

   5055 11 000406   000427 710000 11                 TRA     NOOP

      471     5056    1   ER_READ:
      472     5057        /**********************************************************/
      473     5058        /*
      474     5059              ERROR: ZII-#BADREAD-C
      475     5060        MESSAGE: Cannot read subschema %U1.
      476     5061        */
      477     5062        /**********************************************************/
      478     5063    1       ERROR_CODE=#BADREAD;

   5063 11 000407   011610 235007       ER_READ      LDA     5000,DL
        11 000410   000000 755000 7                  STA     ERROR_CODE

      479     5064    1       GOTO COM_ERR;

   5064 11 000411   000423 710000 11                 TRA     COM_ERR

   5040 11 000412                       ER_DEQ       null
      480     5065    1   ER_DEQ: ;
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:117  
      481     5066    1   ER_CLOSE:
      482     5067        /************************************************************/
      483     5068        /*
      484     5069            ERROR: ZII-#CLOSE_ER-C
      485     5070            MESSAGE: Error in closing the subschema file.
      486     5071        */
      487     5072        /**********************************************************/
      488     5073    1       ERROR_CODE=#CLOSE_ER;

   5073 11 000412   011623 235007       ER_CLOSE     LDA     5011,DL
        11 000413   000000 755000 7                  STA     ERROR_CODE

      489     5074    1       GOTO COM_ERR;

   5074 11 000414   000423 710000 11                 TRA     COM_ERR

      490     5075    1   ER_TIME:
      491     5076        /***********************************************************/
      492     5077        /*
      493     5078            ERROR: ZII-#BADTME-C
      494     5079            MESSAGE: Cannot put the TSTAMP in the compilation unit record of subschema %U1.
      495     5080        */
      496     5081        /************************************************************/
      497     5082    1       ERROR_CODE=#BADTME;

   5082 11 000415   011615 235007       ER_TIME      LDA     5005,DL
        11 000416   000000 755000 7                  STA     ERROR_CODE

      498     5083    1       GOTO COM_ERR;

   5083 11 000417   000423 710000 11                 TRA     COM_ERR

      499     5084    1   ER_WRT:
      500     5085        /************************************************************/
      501     5086        /*E*
      502     5087            ERROR: ZII-#WRT_ER-C
      503     5088            MESSAGE: Cannot write compilation unit record to subschema.
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:118  
      504     5089        */
      505     5090        /**********************************************************/
      506     5091    1       ERROR_CODE=#WRT_ER;

   5091 11 000420   011624 235007       ER_WRT       LDA     5012,DL
        11 000421   000000 755000 7                  STA     ERROR_CODE

      507     5092    1       GOTO COM_ERR;

   5092 11 000422   000423 710000 11                 TRA     COM_ERR

      508     5093    1   COM_ERR:
      509     5094    1       CALL M$DEQ(DEQ_FPT) ALTRET(NOOP);

   5094 11 000423   000106 630400 10    COM_ERR      EPPR0   DEQ_FPT
        11 000424   420003 713400                    CLIMB   alt,+8195
        11 000425   401000 401760                    pmme    nvectors=3
        11 000426   000427 702000 11                 TSX2    NOOP

      510     5095    1   NOOP:
      511     5096    1       CLOSE_FPT.V.DCB#=SUBSCH.DCB#;

   5096 11 000427   000011 220000 1     NOOP         LDX0    SUBSCH+9
        11 000430   000242 740000 10                 STX0    CLOSE_FPT+26

      512     5097    1       IF DCBADDR(SUBSCH.DCB#)->F$DCB.FCD# THEN

   5097 11 000431   000007 470400 12                 LDP0    7
        11 000432   000000 471500                    LDP1    0,,PR0
        11 000433   100000 473510                    LDP3    0,X0,PR1
        11 000434   300031 236100                    LDQ     25,,PR3
        11 000435   020000 316007                    CANQ    8192,DL
        11 000436   000442 600000 11                 TZE     s:5099

      513     5098    1           CALL M$CLOSE(CLOSE_FPT);

   5098 11 000437   000210 630400 10                 EPPR0   CLOSE_FPT
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:119  
        11 000440   050001 713400                    CLIMB   close
        11 000441   406000 401760                    pmme    nvectors=13

      514     5099    1       ALTRETURN;

   5099 11 000442   000000 702200 xent               TSX2  ! X66_AALT

SUBSCH
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SUBSCH_CON_BLK
 Sect OctLoc
   3     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

I_O_BUF
 Sect OctLoc
   5     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SYS_ID
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

OPEN_FPT
 Sect OctLoc
  10     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
  10     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
  10     044*  000000 100052   000000 001001   252525 002002   000040 252520    ..@*......... ..
  10     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
  10     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  10     060   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
  10     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
  10     070   000000 000000   ****** ******                                    ........

PIST
 Sect OctLoc
  10     072   004110 111123   124*** ******                                    .HIST...
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:120  

ENQ_FPT
 Sect OctLoc
  10     074   000003 777640   000102 006000   000001 177640   000072 006000    .....B.......:..
  10     100   000000 177640   000000 006014   000000 540000   777777 777777    ................
  10     104   000000 000000   000000 000000                                    ........

DEQ_FPT
 Sect OctLoc
  10     106   000001 777640   000114 006000   000001 177640   000072 006000    .....L.......:..
  10     112   000000 177640   000000 006014   000000 000000   000000 000000    ................

RES_FPT
 Sect OctLoc
  10     116   000025 777640   000162 006000   000000 177640   000000 006014    .....r..........
  10     122   000000 177640   000000 006014   000000 177640   000000 006014    ................
  10     162*  000000 200042   000000 000000   252525 000000   000040 252520    ..."......... ..
  10     166   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
  10     172   000000 000000   000000 000000   000000 000000   000000 000000    ................
  10     176   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
  10     202   040040 040040   000000 000000   000000 000000   000000 000000        ............
  10     206   000000 000000   ****** ******                                    ........

CLOSE_FPT
 Sect OctLoc
  10     210   000003 777640   000242 006000   000000 177640   000000 006014    ................
  10     214   000000 177640   000000 006014   000000 177640   000000 006014    ................
  10     240*  000000 177640   000000 006014   000000 000000   000000 000040    ...............
  10     244   000220 000000   000000 000000                                    ........

READ_FPT
 Sect OctLoc
  10     246   000005 777640   000256 006000   000000 777640   000000 006000    ................
  10     252   000077 777640   000000 006000   000000 177640   000000 006014    .?..............
  10     256   000000 600000   000000 000000   000000 000000   000000 000000    ................
  10     262   000000 000000   000000 000000                                    ........

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:121  
WRITE_FPT
 Sect OctLoc
  10     264   000003 777640   000274 006000   000000 777640   000000 006000    ................
  10     270   000077 777640   000000 006000   000000 177640   000000 006014    .?..............
  10     274   000000 400400   000000 000000   000000 000000   000000 000000    ................

TIME_FPT
 Sect OctLoc
  10     300   000001 777640   000312 006000   000000 177640   000000 006014    ................
  10     304   000000 177640   000000 006014   000000 177640   000000 006014    ................
  10     310   000000 177640   000000 006014   000001 000000   ****** ******    ................

(unnamed)
 Sect OctLoc
  12     000   000077 777640   000000 000000   000000 001750   000777 777777    .?..............
  12     004   000077 777640   000000 006000   000040 006000   000000 006003    .?....... ......
      515     5100    1   END ZII$WRT_COMP_REC;
      516     5101        %EOD;

PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:122  
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$WRT_COMP_REC.

   Procedure ZII$WRT_COMP_REC requires 291 words for executable code.
   Procedure ZII$WRT_COMP_REC requires 10 words of local(AUTO) storage.
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:123  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:124  
          MINI XREF LISTING

ADDAG
      5000**LABEL    4982--CALLALT  4998--CALLALT
AGAIN
      4982**LABEL    4993--GOTO
B$EXCFR.ASL
      2548**DCL      2548--REDEF
B$EXCFR.ERR.ERR#
      2562**DCL      2562--REDEF    5031>>IF
B$EXCFR.EVID
      2561**DCL      2561--REDEF    2562--REDEF
B$EXCFR.IR
      2549**DCL      2549--REDEF
B$EXCFR.PREVSZ
      2548**DCL      2548--REDEF
B$EXCFR.SUBC
      2560**DCL      2560--REDEF    2561--REDEF    2561--REDEF
B$JIT.ACCN
      1179**DCL      4972>>ASSIGN   4987>>ASSIGN   5005>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      1273**DCL      1273--REDEF
B$JIT.ERR.MID
      1180**DCL      1180--REDEF
B$JIT.JRESPEAK
      1341**DCL      1342--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1450**DCL      1450--REDEF    1451--REDEF
B$JIT.PNR
      1354**DCL      1354--REDEF
B$JIT.TSLINE
      1448**DCL      1449--REDEF
B$JIT$
        35**DCL      1174--IMP-PTR  4972>>ASSIGN   4987>>ASSIGN   5005>>ASSIGN
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:125  
B$TCB.ALT$
      2545**DCL      5031>>IF
B$TCB$
        36**DCL      5031>>IF
CLOSE_FPT
      2379**DCL      5043<>CALL     5098<>CALL
CLOSE_FPT.SN_
      2379**DCL      2379--REDEF
CLOSE_FPT.UTL_
      2380**DCL      2380--REDEF
CLOSE_FPT.V
      2384**DCL      2379--DCLINIT
CLOSE_FPT.V.DCB#
      2385**DCL      5042<<ASSIGN   5096<<ASSIGN
CLOSE_FPT.V.EXPIRE#
      2394**DCL      2394--REDEF
CLOSE_FPT.V.TYPE#
      2392**DCL      2392--REDEF
CLOSE_FPT.V.XTNSIZE#
      2389**DCL      2389--REDEF    2391--REDEF
CLSE_UP
      5040**LABEL    5017--GOTO
COMPILATION_UNIT_REC
      4409**DCL      4968<<ASSIGN   5000<<ASSIGN   5001<<ASSIGN
COMPILATION_UNIT_REC.AUTHOR
      4414**DCL      4972<<ASSIGN   4987<<ASSIGN   5005<<ASSIGN
COMPILATION_UNIT_REC.COMP_UTS
      4416**DCL      4973--ASSIGN   4985--ASSIGN   5006--ASSIGN
COMPILATION_UNIT_REC.NEXT_CU_RECORD
      4410**DCL      4969<<ASSIGN   4992>>ASSIGN   4993>>IF       4994<<ASSIGN   5002<<ASSIGN
COMPILATION_UNIT_REC.PROGRAM_ID
      4413**DCL      4971<<ASSIGN   4983>>IF       5004<<ASSIGN
COMPILATION_UNIT_REC.TRN_UTS
      4418**DCL      4975<<ASSIGN   5008<<ASSIGN
COMPILATION_UNIT_REC.TYPE
      4412**DCL      4970<<ASSIGN   5003<<ASSIGN
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:126  
COM_ERR
      5094**LABEL    5064--GOTO     5074--GOTO     5083--GOTO     5092--GOTO
CONT
      5042**LABEL    5040--CALLALT
CONTROL
      4345**DCL      4963--ASSIGN   5013--ASSIGN
CONTROL.FIRST_CU_RECORD
      4382**DCL      4958>>IF       4960<<ASSIGN   4965>>ASSIGN   4980>>ASSIGN
CONTROL.NEXT_AVAILABLE_RECORD
      4381**DCL      4960>>ASSIGN   4961<<ASSIGN   4961>>ASSIGN   4994>>ASSIGN   4997>>ASSIGN   5011<<ASSIGN
      5011>>ASSIGN
CONTROL.SUBSCHEMA_UTS
      4369**DCL      4975>>ASSIGN   5008>>ASSIGN
DEQ_FPT
      2241**DCL      5016<>CALL     5040<>CALL     5094<>CALL
DEQ_FPT.V
      2242**DCL      2241--DCLINIT
DEQ_FPT.V.DCB#
      2242**DCL      4948<<ASSIGN
DODEQ
      5016**LABEL    4978--GOTO     4990--GOTO
ENQ_FPT
      2223**DCL      4950<>CALL
ENQ_FPT.V
      2224**DCL      2223--DCLINIT
ENQ_FPT.V.DCB#
      2224**DCL      4947<<ASSIGN
ERROR_CODE
        33**DCL      5054<<ASSIGN   5063<<ASSIGN   5073<<ASSIGN   5082<<ASSIGN   5091<<ASSIGN
ER_CLOSE
      5073**LABEL    5043--CALLALT
ER_DEQ
      5040**LABEL    5016--CALLALT
ER_ENQ
      5040**LABEL    4950--CALLALT
ER_OPEN
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:127  
      5054**LABEL    4944--CALLALT  4946--CALLALT
ER_READ
      5063**LABEL    4955--CALLALT  4966--CALLALT
ER_READ IN PROCEDURE READ
      5031**LABEL    5025--CALLALT
ER_TIME
      5082**LABEL    4974--CALLALT  4986--CALLALT  5007--CALLALT
ER_WRT
      5091**LABEL    4964--CALLALT  4977--CALLALT  4989--CALLALT  4996--CALLALT  5010--CALLALT  5014--CALLALT
F$DCB.ACTPOS
      2520**DCL      2520--REDEF
F$DCB.ARS#
      2494**DCL      2494--REDEF
F$DCB.ATTR
      2513**DCL      2514--REDEF
F$DCB.BORROW
      2528**DCL      2528--REDEF    2528--REDEF    2528--REDEF
F$DCB.DCBNAME.L
      2542**DCL      2542--IMP-SIZ
F$DCB.EOMCHAR#
      2498**DCL      2498--REDEF
F$DCB.FCD#
      2507**DCL      5097>>IF
F$DCB.FLDID
      2523**DCL      2523--REDEF
F$DCB.FORM$
      2517**DCL      2517--REDEF
F$DCB.FSECT
      2533**DCL      2533--REDEF
F$DCB.FSN#
      2510**DCL      2510--REDEF    2510--REDEF    2511--REDEF
F$DCB.HEADER$
      2516**DCL      2516--REDEF
F$DCB.IXTNSIZE#
      2514**DCL      2514--REDEF
F$DCB.LASTSTA$
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:128  
      2503**DCL      2503--REDEF
F$DCB.LVL
      2529**DCL      2529--REDEF
F$DCB.NAME#.C
      2504**DCL      2504--REDEF
F$DCB.NOEOF
      2526**DCL      2526--REDEF
F$DCB.NRECS#
      2515**DCL      2515--REDEF
F$DCB.NRECX
      2534**DCL      2534--REDEF
F$DCB.OHDR
      2526**DCL      2526--REDEF
F$DCB.ORG#
      2509**DCL      2509--REDEF
F$DCB.PRECNO
      2532**DCL      2532--REDEF
F$DCB.RCSZ
      2538**DCL      2538--REDEF
F$DCB.RES#
      2505**DCL      2505--REDEF
F$DCB.SETX
      2517**DCL      2517--REDEF
F$DCB.TAB$
      2517**DCL      2517--REDEF
F$DCB.TDA
      2531**DCL      2532--REDEF
F$DCB.WSN#
      2505**DCL      2505--REDEF
I
        16**DCL      5020<<ASSIGN   5022>>IF       5024>>ASSIGN
I_O_BUF
        30**DCL      2417--DCLINIT  2418--DCLINIT  2455--DCLINIT  2456--DCLINIT  4976--ASSIGN   4988--ASSIGN
      4995--ASSIGN   5009--ASSIGN   5027--ASSIGN   5028--ASSIGN   5033--ASSIGN   5034<<ASSIGN
M$CLOSE
      1464**DCL-ENT  5043--CALL     5098--CALL
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:129  
M$DEQ
      1531**DCL-ENT  5016--CALL     5040--CALL     5094--CALL
M$ENQ
      1530**DCL-ENT  4950--CALL
M$OPEN
      1464**DCL-ENT  4944--CALL     4946--CALL
M$READ
      1465**DCL-ENT  4955--CALL     5025--CALL
M$TIME
      1531**DCL-ENT  4974--CALL     4986--CALL     5007--CALL
M$WRITE
      1465**DCL-ENT  4964--CALL     4977--CALL     4989--CALL     4996--CALL     5010--CALL     5014--CALL
NOOP
      5096**LABEL    5055--GOTO     5094--CALLALT
OPEN_FPT
      2141**DCL      4944<>CALL
OPEN_FPT.ACSVEH_
      2143**DCL      2144--REDEF
OPEN_FPT.ALTKEYS_
      2149**DCL      2150--REDEF    2150--REDEF
OPEN_FPT.HDR_
      2148**DCL      2149--REDEF
OPEN_FPT.TAB_
      2147**DCL      2148--REDEF
OPEN_FPT.UHL_
      2141**DCL      2142--REDEF    2142--REDEF
OPEN_FPT.V
      2150**DCL      2141--DCLINIT
OPEN_FPT.V.DCB#
      2150**DCL      4942<<ASSIGN
OPEN_FPT.V.FSN#
      2181**DCL      2181--REDEF    2181--REDEF
OPEN_FPT.V.SHARE#
      2155**DCL      4943<<ASSIGN
OPEN_FPT.WSN_
      2147**DCL      2147--REDEF
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:130  
PIST
      2210**DCL      2223--DCLINIT  2241--DCLINIT
READ
      5018**PROC     4966--CALL     4982--CALL     4998--CALL
READ_FPT
      2415**DCL      4955<>CALL     5025<>CALL
READ_FPT.STATION_
      2418**DCL      2419--REDEF
READ_FPT.V
      2419**DCL      2415--DCLINIT
READ_FPT.V.DCB#
      2419**DCL      4954<<ASSIGN
READ_FPT.V.DVBYTE.REREAD#
      2430**DCL      2430--REDEF
READ_FPT.V.INDX#
      2428**DCL      2428--REDEF
REC$
        18**DCL      4409--IMP-PTR  4968>>ASSIGN   4969>>ASSIGN   4970>>ASSIGN   4971>>ASSIGN   4972>>ASSIGN
      4973>>ASSIGN   4975>>ASSIGN   4983>>IF       4985>>ASSIGN   4987>>ASSIGN   4992>>ASSIGN   4993>>IF
      4994>>ASSIGN   5000>>ASSIGN   5001>>ASSIGN   5002>>ASSIGN   5003>>ASSIGN   5004>>ASSIGN   5005>>ASSIGN
      5006>>ASSIGN   5008>>ASSIGN   5027<<ASSIGN   5028<<ASSIGN   5033<<ASSIGN
REM IN PROCEDURE READ
      5019**DCL      5021<<ASSIGN   5027>>IF
RES_FPT
      2312**DCL      4946<>CALL
RES_FPT.ACSVEH_
      2314**DCL      2315--REDEF
RES_FPT.ALTKEYS_
      2320**DCL      2321--REDEF    2321--REDEF
RES_FPT.HDR_
      2319**DCL      2320--REDEF
RES_FPT.TAB_
      2318**DCL      2319--REDEF
RES_FPT.UHL_
      2312**DCL      2313--REDEF    2313--REDEF
RES_FPT.V
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:131  
      2321**DCL      2312--DCLINIT
RES_FPT.V.DCB#
      2321**DCL      4945<<ASSIGN
RES_FPT.V.FSN#
      2352**DCL      2352--REDEF    2352--REDEF
RES_FPT.WSN_
      2318**DCL      2318--REDEF
RNUMB
        15**DCL      4957<<ASSIGN   4965<<ASSIGN   4980<<ASSIGN   4992<<ASSIGN   4997<<ASSIGN   5020>>ASSIGN
      5021>>ASSIGN
SUBSCH.DCB#
        23**DCL      4942>>ASSIGN   4945>>ASSIGN   4947>>ASSIGN   4948>>ASSIGN   4953>>ASSIGN   4954>>ASSIGN
      5042>>ASSIGN   5096>>ASSIGN   5097--IF
SUB_CONBLK$
        29**DCL      4345--IMP-PTR  4958>>IF       4960>>ASSIGN   4960>>ASSIGN   4961>>ASSIGN   4961>>ASSIGN
      4963>>ASSIGN   4965>>ASSIGN   4975>>ASSIGN   4980>>ASSIGN   4994>>ASSIGN   4997>>ASSIGN   5008>>ASSIGN
      5011>>ASSIGN   5011>>ASSIGN   5013>>ASSIGN
SYS_ID
        34**DCL      4971>>ASSIGN   4983>>IF       5004>>ASSIGN
TIME_FPT
      2479**DCL      4974<>CALL     4986<>CALL     5007<>CALL
TIME_FPT.TSTAMP_
      2482**DCL      4973<<ASSIGN   4985<<ASSIGN   5006<<ASSIGN
TIME_FPT.V
      2483**DCL      2479--DCLINIT
TMP_KEY
        24**DCL      2415--DCLINIT  2416--DCLINIT  2454--DCLINIT
TMP_KEY.ACT_KEY
        26**DCL      4952<<ASSIGN   4962<<ASSIGN   5012<<ASSIGN   5022>>IF       5024<<ASSIGN
TMP_KEY.LEN
        25**DCL      4951<<ASSIGN
WRITE_FPT
      2454**DCL      4964<>CALL     4977<>CALL     4989<>CALL     4996<>CALL     5010<>CALL     5014<>CALL
WRITE_FPT.BUF_
      2454**DCL      4963<<ASSIGN   4976<<ASSIGN   4988<<ASSIGN   4995<<ASSIGN   5009<<ASSIGN   5013<<ASSIGN
WRITE_FPT.STATION_
PL6.E3A0      #007=ZII$WRT_COMP_REC File=ZII$MSC_PROC.:ZIC0TSI                   FRI 09/05/97 12:30 Page:132  
      2456**DCL      2456--REDEF
WRITE_FPT.V
      2457**DCL      2454--DCLINIT
WRITE_FPT.V.DCB#
      2457**DCL      4953<<ASSIGN
WRITE_FPT.V.DVBYTE.VFC#
      2463**DCL      2463--REDEF

PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:133  
      517        1        /*T***********************************************************/
      518        2        /*T*                                                         */
      519        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      520        4        /*T*                                                         */
      521        5        /*T***********************************************************/
      522        6        ZII$FINDD: PROC(NAME,TYPE,DD$) ALTRET AVOID($PR5,$PR6,$PR7);
      523        7        /**************************************************************/
      524        8    1   DCL NAME CHAR(32) ALIGNED;
      525        9    1   DCL TYPE UBIN(36);
      526       10    1   DCL HSH_VAL UBIN(36) EXT;
      527       11        /**/
      528       12        %INCLUDE ZI$DESC;
      529      862        %DSC_DESC (STCLASS=);
      530      870        %TYPE_SUBS;
      531      880        %INCLUDE ZI$STRUCTS;
      532      952        %NAM1;
      533      981        %NAM2;
      534      995        /**/
      535      996    1   DCL ZII$HASH ENTRY(3);
      536      997        /****************************************************************/
      537      998    1       CALL ZII$HASH(NAME,#ENTRY,HSH_VAL);
      538      999    1       IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN
      539     1000    1           ALTRETURN;
      540     1001    1       DD$ = NAM2.LLIST$(HSH_VAL);
      541     1002    2       DO WHILE( NAME ~= NAM1.NAME.TEXT(DESC.NAM_IDX));
      542     1003    2           IF DESC.LLIST$ = ADDR(NIL) THEN
      543     1004    3           DO;
      544     1005    3               TYPE=0;
      545     1006    3               DD$=ADDR(NIL);
      546     1007    3               ALTRETURN;
      547     1008    3               END;
      548     1009    2           DD$=DESC.LLIST$;
      549     1010    2           END;
      550     1011    1       TYPE=NAM1.TYPE(DESC.NAM_IDX);
      551     1012    1       RETURN;
      552     1013    1   END ZII$FINDD;

PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:134  
--  Include file information  --

   ZI$STRUCTS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FINDD.

   Procedure ZII$FINDD requires 62 words for executable code.
   Procedure ZII$FINDD requires 10 words of local(AUTO) storage.

    No errors detected in file ZII$MSC_PROC.:ZIC0TSI    .

PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:135  

 Object Unit name= ZII$FINDD                                  File name= ZII$MSC_PROC.:ZIC0TOU
 UTS= SEP 05 '97 12:31:27.88 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  HSH_VAL
    1  LblCom even  none     1      1  NAM1$
    2  LblCom even  none     1      1  NAM1_SIZ
    3  LblCom even  none     1      1  NAM1_IDX
    4  LblCom even  none     1      1  NAM2$
    5  LblCom even  none     1      1  NAM2_SIZ
    6  LblCom even  none     1      1  DESC#
    7   Proc  even  none    62     76  ZII$FINDD
    8  RoData even  none     5      5  ZII$FINDD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes    yes     yes      XStd       3  ZII$FINDD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      3 ZII$HASH
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:136  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:137  


      517        1        /*T***********************************************************/
      518        2        /*T*                                                         */
      519        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      520        4        /*T*                                                         */
      521        5        /*T***********************************************************/
      522        6        ZII$FINDD: PROC(NAME,TYPE,DD$) ALTRET AVOID($PR5,$PR6,$PR7);

      6  7 000000   000000 700200 xent  ZII$FINDD    TSX0  ! X66_AUTO_3
         7 000001   000012 000003                    ZERO    10,3

      523        7        /**************************************************************/
      524        8    1   DCL NAME CHAR(32) ALIGNED;
      525        9    1   DCL TYPE UBIN(36);
      526       10    1   DCL HSH_VAL UBIN(36) EXT;
      527       11        /**/
      528       12        %INCLUDE ZI$DESC;
      529      862        %DSC_DESC (STCLASS=);
      530      870        %TYPE_SUBS;
      531      880        %INCLUDE ZI$STRUCTS;
      532      952        %NAM1;
      533      981        %NAM2;
      534      995        /**/
      535      996    1   DCL ZII$HASH ENTRY(3);
      536      997        /****************************************************************/
      537      998    1       CALL ZII$HASH(NAME,#ENTRY,HSH_VAL);

    998  7 000002   000002 236000 8                  LDQ     2
         7 000003   200010 756100                    STQ     @DD$+3,,AUTO
         7 000004   000003 236000 8                  LDQ     3
         7 000005   200003 235100                    LDA     @NAME,,AUTO
         7 000006   200006 757100                    STAQ    @DD$+1,,AUTO
         7 000007   200006 630500                    EPPR0   @DD$+1,,AUTO
         7 000010   000000 631400 8                  EPPR1   0
         7 000011   000000 701000 xent               TSX1    ZII$HASH
         7 000012   000000 011000                    NOP     0

PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:138  
      538      999    1       IF NAM2.LLIST$(HSH_VAL) = ADDR(NIL) THEN

    999  7 000013   000000 470400 4                  LDP0    NAM2$
         7 000014   000000 720000 0                  LXL0    HSH_VAL
         7 000015   000000 236110                    LDQ     0,X0,PR0
         7 000016   000004 116000 8                  CMPQ    4
         7 000017   000021 601000 7                  TNZ     s:1001

      539     1000    1           ALTRETURN;

   1000  7 000020   000000 702200 xent               TSX2  ! X66_AALT

      540     1001    1       DD$ = NAM2.LLIST$(HSH_VAL);

   1001  7 000021   200005 471500                    LDP1    @DD$,,AUTO
         7 000022   100000 756100                    STQ     0,,PR1

      541     1002    2       DO WHILE( NAME ~= NAM1.NAME.TEXT(DESC.NAM_IDX));

   1002  7 000023   100000 470500                    LDP0    0,,PR1
         7 000024   000000 236100                    LDQ     0,,PR0
         7 000025   000022 772000                    QRL     18
         7 000026   000012 402007                    MPY     10,DL
         7 000027   000002 736000                    QLS     2
         7 000030   200003 473500                    LDP3    @NAME,,AUTO
         7 000031   000000 474400 1                  LDP4    NAM1$
         7 000032   040106 106500                    CMPC    fill='040'O
         7 000033   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32
         7 000034   400001 000040                    ADSC9   1,Q,PR4                  cn=0,n=32
         7 000035   000064 600000 7                  TZE     s:1011

      542     1003    2           IF DESC.LLIST$ = ADDR(NIL) THEN

   1003  7 000036   200005 470500                    LDP0    @DD$,,AUTO
         7 000037   000000 471500                    LDP1    0,,PR0
         7 000040   100010 236100                    LDQ     8,,PR1
         7 000041   000004 116000 8                  CMPQ    4
PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:139  
         7 000042   000050 601000 7                  TNZ     s:1009

      543     1004    3           DO;

      544     1005    3               TYPE=0;

   1005  7 000043   200004 473500                    LDP3    @TYPE,,AUTO
         7 000044   300000 450100                    STZ     0,,PR3

      545     1006    3               DD$=ADDR(NIL);

   1006  7 000045   000004 236000 8                  LDQ     4
         7 000046   000000 756100                    STQ     0,,PR0

      546     1007    3               ALTRETURN;

   1007  7 000047   000000 702200 xent               TSX2  ! X66_AALT

      547     1008    3               END;
      548     1009    2           DD$=DESC.LLIST$;

   1009  7 000050   000000 756100                    STQ     0,,PR0

      549     1010    2           END;

   1010  7 000051   000000 471500                    LDP1    0,,PR0
         7 000052   100000 236100                    LDQ     0,,PR1
         7 000053   000022 772000                    QRL     18
         7 000054   000012 402007                    MPY     10,DL
         7 000055   000002 736000                    QLS     2
         7 000056   200003 473500                    LDP3    @NAME,,AUTO
         7 000057   000000 474400 1                  LDP4    NAM1$
         7 000060   040106 106500                    CMPC    fill='040'O
         7 000061   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32
         7 000062   400001 000040                    ADSC9   1,Q,PR4                  cn=0,n=32
         7 000063   000036 601000 7                  TNZ     s:1003

PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:140  
      550     1011    1       TYPE=NAM1.TYPE(DESC.NAM_IDX);

   1011  7 000064   200005 470500                    LDP0    @DD$,,AUTO
         7 000065   000000 471500                    LDP1    0,,PR0
         7 000066   100000 236100                    LDQ     0,,PR1
         7 000067   000022 772000                    QRL     18
         7 000070   000012 402007                    MPY     10,DL
         7 000071   200004 470500                    LDP0    @TYPE,,AUTO
         7 000072   400000 236106                    LDQ     0,QL,PR4
         7 000073   000033 772000                    QRL     27
         7 000074   000000 756100                    STQ     0,,PR0

      551     1012    1       RETURN;

   1012  7 000075   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   8     000   000003 000000   000000 001447   000000 006000   000001 006000    ................
   8     004   000000 006014                                                    ....
      552     1013    1   END ZII$FINDD;

PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:141  
--  Include file information  --

   ZI$STRUCTS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FINDD.

   Procedure ZII$FINDD requires 62 words for executable code.
   Procedure ZII$FINDD requires 10 words of local(AUTO) storage.

    No errors detected in file ZII$MSC_PROC.:ZIC0TSI    .
PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:142  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=ZII$FINDD File=ZII$MSC_PROC.:ZIC0TSI                          FRI 09/05/97 12:31 Page:143  
          MINI XREF LISTING

DD$
       863**DCL         6--PROC      864--IMP-PTR  1001<<ASSIGN   1002>>DOWHILE  1003>>IF       1006<<ASSIGN
      1009<<ASSIGN   1009>>ASSIGN   1011>>ASSIGN
DESC.LLIST$
       868**DCL      1003>>IF       1009>>ASSIGN
DESC.NAM_IDX
       865**DCL      1002>>DOWHILE  1011>>ASSIGN
DESC#
       988**DCL       993--IMP-SIZ
HSH_VAL
        10**DCL       998<>CALL      999>>IF       1001>>ASSIGN
NAM1.NAME.TEXT
       978**DCL      1002>>DOWHILE
NAM1.TYPE
       965**DCL      1011>>ASSIGN
NAM1$
       961**DCL       964--IMP-PTR  1002>>DOWHILE  1011>>ASSIGN
NAM2.DESC
       992**DCL       993--REDEF
NAM2.LLIST$
       990**DCL       999>>IF       1001>>ASSIGN
NAM2$
       986**DCL       989--IMP-PTR   999>>IF       1001>>ASSIGN
NAME
         8**DCL         6--PROC      998<>CALL     1002>>DOWHILE
TYPE
         9**DCL         6--PROC     1005<<ASSIGN   1011<<ASSIGN
ZII$HASH
       996**DCL-ENT   998--CALL
