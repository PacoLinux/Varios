VERSION A06

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:1    
        1        1        /*M*   Z8DM$DML_UWA -  Data division for COBOL-E DML/IDS II  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME:  Z8DM$DML_UWA
        9        9             PURPOSE:
       10       10                  Process the subschema file.
       11       11             DESCRIPTION:
       12       12                  Adds to and creates the following:  ST, DNT, QLT, LTS,
       13       13                  Reference Vector Area (RVA), Use Procedure table (USEP),
       14       14                  and the DML special registers.
       15       15        */
       16       16        /*F*
       17       17             NAME:  Z8DM$DML_UWA
       18       18             PURPOSE:
       19       19                  Process the subschema file.
       20       20             DESCRIPTION:
       21       21                  Processes the the records for the subschema depending on
       22       22                  their type.
       23       23             REFERENCE:
       24       24
       25       25
       26       26        */
       27       27        /*D*
       28       28             NAME: Z8DM$DML_UWA
       29       29             CALL:   Z8DM$DML_UWA( PRIVACY$, SCHEMA$, SUB_SCHEMA$, POINT$);
       30       30
       31       31             PARAMETERS:
       32       32                    PRIVACY$    -  LX_ITEM of the privacy key.
       33       33                    SCHEMA$     -  LX_ITEM of the schema name.
       34       34                    SUB_SCHEMA$ -  LX_ITEM of the the subschema name.
       35       35                    POINT$      -  LX_ITEM of the end of statement.
       36       36             INTERFACE:
       37       37                    Z8AH$NEW_DNT
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:2    
       38       38                    Z8AE$ERROR
       39       39                    Z8AT$CREATE_TEMPORARY
       40       40                    Z9AT$TERMINATOR
       41       41                    Z8EL$START_WRITING_ES_FILE
       42       42                    Z9AE$ISSUE_SYSTEM_ERROR
       43       43
       44       44             ENVIRONMENT:
       45       45                    None.
       46       46             INPUT:
       47       47                PRIVACY$
       48       48                SCHEMA$
       49       49                SUB_SCHEMA$
       50       50                POINT$
       51       51             OUTPUT:
       52       52                None.
       53       53
       54       54             DESCRIPTION:
       55       55                The subschema file has records which describe all of the
       56       56                data items along with Realms, Sets, and Privacy keys. It
       57       57                also has records describing the Set, Realm and Record
       58       58                relationships.  The actual source lines are also included.
       59       59                Each of these items have a type field with the following types:
       60       60
       61       61                Type 6 -  Text of line
       62       62                Type 9 -  Cobol data items
       63       63                Type 31 - Record Realm relationship
       64       64                Type 32 - Record Set relationship
       65       65                Type 33 - Record Key relationship
       66       66
       67       67                Action on the records is taken depending on the type.
       68       68                Preliminary set up of the RVA and Usep table is also
       69       69                done.
       70       70
       71       71                RVA Table  -   The RVA table contains an for each subschema
       72       72                               item referenced in the program.  If there is
       73       73                               multiple references there is only one entry.
       74       74                               Each entry contains a type field (realm, set,
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:3    
       75       75                               key, record, field, or null) and  either the
       76       76                               offset into the user work area or its internal
       77       77                               name.
       78       78
       79       79                USEP Table -   This table has two entries for each use procedure.
       80       80                               One entry tells if it is a USE for DB-EXCEPTION
       81       81                               and the status code or if it is USE for PRIVACY.
       82       82                               The entry is the address of the procedure.
       83       83
       84       84             AUTHOR:
       85       85                    Corey Nypen.
       86       86        */
       87       87        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:4    
       88       88        /*============*/
       89       89          Z8DM$DML_UWA :  PROC(PRIVACY$, SCHEMA$, SUB_SCHEMA$, POINT$);
       90       90        /*============*/
       91       91
       92       92    1   DCL PRIVACY$    PTR;
       93       93    1   DCL SCHEMA$     PTR;
       94       94    1   DCL SUB_SCHEMA$ PTR;
       95       95    1   DCL POINT$      PTR;
       96       96
       97       97        %SET PHASE = 1;
       98       98        %INCLUDE Z8A_DEFC;
       99      166        %INCLUDE Z8A_SYS_FILE;
      100     6441        %INCLUDE Z8A_SUPP_MAC;
      101     8841        %INCLUDE Z8A_COMCOM;
      102     9491        %INCLUDE Z8A_ST;
      103    13150        %INCLUDE Z8A_QLT;
      104    13256        %INCLUDE Z8A_LTS;
      105    15333        %INCLUDE Z8A_TYPES;
      106    15507        %INCLUDE Z8A_DNT;
      107    15728        %INCLUDE Z8A_ERR_NUMS;
      108    16492        %INCLUDE Z8A_ILL;
      109    17185        %INCLUDE Z8E_MACROS;
      110    17860        %INCLUDE Z8E_HEAP;
      111    17916        %INCLUDE Z8E_DML;
      112    18036        %INCLUDE Z8E_BUFFERS;
      113    18226        %SET EMPTY = 0;
      114    18227        %INCLUDE Z8E_STACKS;
      115    20493        %INCLUDE Z8E_O1COM;
      116    21254        %INCLUDE Z8E_STATEMNT;
      117    21323
      118    21324            %DEF_BUCKETS;
      119    21327
      120    21328    1       DCL     RETURN_PTR$     PTR;
      121    21329    1       DCL     NEW_QLT$        PTR;
      122    21330    1       DCL     PREVIOUS_BRO_QLT$ PTR;
      123    21331    1       DCL     RETURN$         PTR;
      124    21332    1       DCL     HEAD_UWA_QLT$   PTR;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:5    
      125    21333    1       DCL     NEW_DNT$        PTR;
      126    21334    1       DCL     NEW_DNT$$       PTR;
      127    21335    1       DCL     NEW_LTS$        PTR;
      128    21336    1       DCL     NEW_LONG$       PTR;
      129    21337    1       DCL     CURRENT_PTR$    PTR;
      130    21338    1       DCL     CURRENT_LTS$    PTR;
      131    21339    1       DCL     HEAD$           PTR;
      132    21340
      133    21341    1       DCL     TYPE            UBIN HALF;
      134    21342    1       DCL     CLASS_          UBIN (3);
      135    21343    1       DCL     DML_TYPE        UBIN (3);
      136    21344    1       DCL     LEVEL_#         UBIN;
      137    21345    1       DCL     NEXT_LEVEL      UBIN WORD;
      138    21346    1       DCL     NAME_X          CHAR(6);
      139    21347    1       DCL     01   UWA_NAME   REDEF NAME_X,
      140    21348    1                  02  FIRST    CHAR(2) UNAL,
      141    21349    1                  02  LAST     CHAR(4) UNAL;
      142    21350    1       DCL     DML_STK_PTR    UBIN WORD;
      143    21351    1       DCL     DML_STK_PTR_OF_FATHER   UBIN WORD;
      144    21352    1       DCL     DML_ID          UBIN(18);
      145    21353    1       DCL     INDEXED_REALM   BIT(1);
      146    21354    1       DCL     REALM_NO        UBIN;
      147    21355    1       DCL     SA              UBIN HALF;
      148    21356    1       DCL     WORD_OFFSET     UBIN HALF;
      149    21357    1       DCL     MEMBERSHIP      BIT(2);
      150    21358    1       DCL     I               SBIN(18);
      151    21359    1       DCL     J               UBIN;
      152    21360    1       DCL     K               UBIN;
      153    21361    1       DCL     START_LEVEL_# (0:49)   UBIN(9);
      154    21362    1       DCL     LENGTH          BOOLEAN;
      155    21363    1       DCL     P_BIT           BOOLEAN;
      156    21364    1       DCL     NEED_DUMMY_BUF  BOOLEAN STATIC INIT (FALSE);
      157    21365
      158    21366    1       DCL     Z8AH$NEW_DNT                ENTRY(3);
      159    21367    1       DCL     Z8AE$ERROR                  ENTRY(12);
      160    21368    1       DCL     Z8AT$CREATE_TEMPORARY       ENTRY(2);
      161    21369    1       DCL     Z9AT$TERMINATOR             ENTRY;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:6    
      162    21370    1       DCL     Z8EL$START_WRITING_ES_FILE  ENTRY(1);
      163    21371    1       DCL     Z9DM$READY_SSCHEMA          ENTRY(3) ALTRET;
      164    21372    1       DCL     Z9DM$GET_SUB_SCHEMA         ENTRY(2);
      165    21373
      166    21374    1       DCL     FOUND           BOOLEAN;
      167    21375    1          DCL  1  CONTROL_SEG  BASED(RETURN_PTR$)  ALIGNED,
      168    21376    1                  2  * (0:41)          SBIN WORD UNAL,
      169    21377    1                  2  TIME_DATE         CHAR(8) UNAL,
      170    21378    1                  2  * (0:19)          SBIN WORD UNAL;
      171    21379
      172    21380        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:7    
      173    21381    1       DCL     1   DESC,
      174    21382    1                   2   DESCL      UBIN HALF UNAL,
      175    21383    1                   2   ALPHA_ADSC       REDEF DESCL,
      176    21384    1                       3   CN              UBIN(2) UNAL,
      177    21385    1                       3   MBZ1            BIT(1)  UNAL,
      178    21386    1                       3   TA              BIT(2)  UNAL,
      179    21387    1                       3   MBZ2            BIT(1)  UNAL,
      180    21388    1                       3   N               UBIN(12) UNAL,
      181    21389
      182    21390    1                   2   NUM_NDSC       REDEF DESCL,
      183    21391    1                       3   CN              UBIN(3)  UNAL,
      184    21392    1                       3   TN              BIT(1)   UNAL,
      185    21393    1                       3   S               BIT(2)   UNAL,
      186    21394    1                       3   SF              SBIN(6)  UNAL,
      187    21395    1                       3   N               UBIN(6)  UNAL;
      188    21396
      189    21397    1       DCL     1   RECORD_INFO,
      190    21398    1                   2   LOCATION_CALC       BIT(1)    UNAL;
      191    21399                /*      2   PARTIAL_RECORD      BIT(1)    UNAL,
      192    21400                        2   STORE_NOT_PER       BIT(1)    UNAL,
      193    21401                        2   MODIFY_ONLY         BIT(1)    UNAL,
      194    21402                        2   ALL_CALC_PRES       BIT(1)    UNAL,
      195    21403                        2   ERASE_ALL_NOT_PER   BIT(1)    UNAL,
      196    21404                        2   ERASE_NOT_PER       BIT(1)    UNAL;     */
      197    21405
      198    21406    1       DCL     REGISTER_NAME (0:7)   CHAR(17) STATIC INIT ('DB-STATUS',
      199    21407    1               'DB-SET-NAME','DB-REALM-NAME','DB-PRIVACY-KEY',
      200    21408    1         'DB-RECORD-NAME','DB-DATA-NAME','DB-KEY-NAME','DIRECT-REFERENCE');
      201    21409
      202    21410    1       DCL     REGISTER_OFFSET (0:7)  UBIN HALF STATIC INIT
      203    21411    1                   (4,44,12,108,76,124,156,120);
      204    21412
      205    21413    1       DCL     NAME_LENGTH (0:7)  SBIN STATIC INIT(9,11,13,14,14,12,11,16);
      206    21414
      207    21415    1       DCL     REGISTER_LENGTH (0:7)  UBIN HALF STATIC INIT
      208    21416    1                   (7,30,30,12,30,30,30,4);
      209    21417    1       DCL     NAME  CHAR(30);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:8    
      210    21418
      211    21419    1       DCL 1 DML_STK(0:99),
      212    21420    1             2 QLT$    PTR  UNAL,
      213    21421    1             2 LEVEL_# UBIN WORD,
      214    21422    1             2 FATHER  UBIN WORD;
      215    21423        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:9    
      216    21424        /*V*
      217    21425                The type 9 token is the major token or record returned from
      218    21426                GET_SUB_SCHEMA.  It describes the subschema items.
      219    21427        */
      220    21428    1       DCL  1  TOKEN_9     BASED(RETURN_PTR$)  ALIGNED,
      221    21429    1               2   SIZE_OF_DESCRIPTOR      UBIN WORD  UNAL,   /*V*   0  */
      222    21430    1               2   LINE_NUMBER             UBIN WORD  UNAL,   /*V*   1  */
      223    21431    1               2   COLUMN                  UBIN WORD  UNAL,   /*V*   2  */
      224    21432    1               2   TYPE                    UBIN WORD  UNAL,   /*V*   3  */
      225    21433    1               2   WORD_4                  UBIN WORD  UNAL,   /*V*   4  */
      226    21434    1               2   WORD4                   REDEF WORD_4,      /*V*   4  */
      227    21435    1                   3  BIT0                 BIT(1)     UNAL,
      228    21436    1                   3  BIT1                 BIT(1)     UNAL,
      229    21437    1                   3  BIT2                 BIT(1)     UNAL,
      230    21438    1                   3  BIT3                 BIT(1)     UNAL,
      231    21439    1                   3  BIT4                 BIT(1)     UNAL,
      232    21440    1                   3  *  (0:30)            BIT(1)     UNAL,
      233    21441    1               2   * (0:2)                 UBIN WORD  UNAL,  /*V*  5-7 */
      234    21442    1               2   BIB,                                      /*V*   8  */
      235    21443    1                   3 * (0:18)              BOOLEAN,          /*V* BIT 0-18 */
      236    21444    1                   3  REALM                BOOLEAN,          /*V* BIT 19 */
      237    21445    1                   3  SET                  BOOLEAN,          /*V* BIT 20 */
      238    21446    1                   3  RECORD               BOOLEAN,          /*V* BIT 21 */
      239    21447    1                   3  FIELD                BOOLEAN,          /*V* BIT 22 */
      240    21448    1                   3  PRIVACY_KEY          BOOLEAN,          /*V* BIT 23 */
      241    21449    1                   3  USER_WORK_AREA       BOOLEAN,          /*V* BIT 24 */
      242    21450    1                   3  KEY                  BOOLEAN,          /*V* BIT 25 */
      243    21451    1                   3  NOT_IN_SCHEMA        BOOLEAN,          /*V* BIT 26 */
      244    21452    1                   3  DB_KEY               BOOLEAN,          /*V* BIT 27 */
      245    21453    1                   3  COMP_11              BOOLEAN,          /*V* BIT 28 */
      246    21454    1                   3  COMP_12              BOOLEAN,          /*V* BIT 29 */
      247    21455    1                   3  BIT30                BOOLEAN,          /*V* BIT 30 */
      248    21456    1                   3  BIT31                BOOLEAN,          /*V* BIT 31 */
      249    21457    1                   3  BIT32                BOOLEAN,          /*V* BIT 32 */
      250    21458    1                   3  BIT33                BOOLEAN,          /*V* BIT 33 */
      251    21459    1                   3  BIT34                BOOLEAN,          /*V* BIT 34 */
      252    21460    1                   3  BIT35                BOOLEAN,          /*V* BIT 35 */
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:10   
      253    21461    1               2   *                       UBIN WORD  UNAL,  /*V*   9    */
      254    21462    1               2   LEVEL_NUMBER            UBIN WORD  UNAL,  /*V*   10   */
      255    21463    1               2   * (0:2)                 UBIN WORD  UNAL,  /*V* 11-13 */
      256    21464    1               2   LENGTH                  UBIN WORD UNAL,     /*V*  14  */
      257    21465    1               2   LTDP                    UBIN WORD  UNAL,  /*V*   15  */
      258    21466    1               2   RTDP                    UBIN WORD  UNAL,  /*V*   16  */
      259    21467    1               2   SIB,                                      /*V* 17-18 */
      260    21468    1                   3 * (0:5)               BOOLEAN,  /*V* 0-5 */
      261    21469    1                   3 ITEM_NOT_RECORD       BOOLEAN,  /*V*  6  */
      262    21470    1                   3 ENTRY_01              BOOLEAN,  /*V*  7  */
      263    21471    1                   3 *                     BOOLEAN,  /*V* 8    */
      264    21472    1                   3 ELEMENTARY            BOOLEAN,  /*V*  9  */
      265    21473    1                   3 * (0:6)               BOOLEAN,  /*V* 10-16 */
      266    21474    1                   3 NUMERIC               BOOLEAN,  /*V*  17 */
      267    21475    1                   3 *                     BOOLEAN,  /*V*  18 */
      268    21476    1                   3 ALPHANUMERIC          BOOLEAN,  /*V*  19 */
      269    21477    1                   3 *                     BOOLEAN,  /*V*  20 */
      270    21478    1                   3 ALPHABETIC            BOOLEAN,  /*V*  21 */
      271    21479    1                   3 *                     BOOLEAN,  /*V*  22 */
      272    21480    1                   3 PIC_WITH_P            BOOLEAN,  /*V*  23 */
      273    21481    1                   3 *                     BOOLEAN,  /*V*  24 */
      274    21482    1                   3 PIC_WITH_S            BOOLEAN,  /*V*  25 */
      275    21483    1                   3 USAGE_DISPLAY_SEP_SIGN BOOLEAN, /*V*  26 */
      276    21484    1                   3 DISPLAY               BOOLEAN,  /*V*  27 */
      277    21485    1                   3 COMP                  BOOLEAN,  /*V*  28 */
      278    21486    1                   3 COMP_1                BOOLEAN,  /*V*  29 */
      279    21487    1                   3 COMP_2                BOOLEAN,  /*V*  30 */
      280    21488    1                   3 COMP_3                BOOLEAN,  /*V*  31 */
      281    21489    1                   3 *                     BOOLEAN,  /*V*  32 */
      282    21490    1                   3 COMP_6                BOOLEAN,  /*V*  33 */
      283    21491    1                   3 *                     BOOLEAN,  /*V*  34 */
      284    21492    1                   3 JUSTIFIED             BOOLEAN,  /*V*  35 */
      285    21493    1                   3 COMP_4                BOOLEAN,  /*V*  36 */
      286    21494    1                   3 SYNCH                 BOOLEAN,  /*V*  37 */
      287    21495    1                   3 * (0:10)              BOOLEAN,  /*V* 38-48 */
      288    21496    1                   3 SIGN                  UBIN(3)    UNAL,  /*V* 49-51 */
      289    21497    1                   3 * (0:14)              BOOLEAN,  /*V* 52-66 */
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:11   
      290    21498    1                   3 FLOAT_BIT             BOOLEAN,  /*V* 67    */
      291    21499    1                   3 * (0:3)               BOOLEAN,  /*V* 68-71 */
      292    21500    1               2   RPT_CODE                UBIN WORD  UNAL,  /*V*  19  */
      293    21501    1               2   OFFSET                  UBIN WORD  UNAL,  /*V*  20  */
      294    21502    1               2   * (0:1)                 UBIN WORD  UNAL,  /*V* 21-22 */
      295    21503    1               2   NAME_SIZE               UBIN WORD  UNAL,  /*V*  23  */
      296    21504    1               2   DATA_ITEM_NAME          CHAR(TOKEN_9.NAME_SIZE) UNAL;
      297    21505
      298    21506    1       DCL IA_TIME_DATE    CHAR(8);
      299    21507         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:12   
      300    21508        %MACRO UPDATE_DML_STK( @HEAD = ,
      301    21509                               @LEVEL# = ,
      302    21510                               @QLT$ = ,
      303    21511                               @PTR_TO_FATHER = );
      304    21512            DO;
      305    21513                DML_STK.QLT$(@HEAD) = @QLT$;
      306    21514                DML_STK.LEVEL_#(@HEAD) = @LEVEL#;
      307    21515                DML_STK.FATHER(@HEAD) = @PTR_TO_FATHER;
      308    21516            END;
      309    21517        %MEND;
      310    21518        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:13   
      311    21519    1   IF COMCOM.IDS_SUB_SCHEMA                         THEN
      312    21520    2     DO;
      313    21521    2       CALL Z8AE$ERROR(%E$DUPLICATE_SUB_SCHEMA_SECTION,POINT$ -> LX_ITEM.LINE,POINT$ ->
             21521                LX_ITEM.COLUMN);
      314    21522    2       RETURN;
      315    21523    2     END;
      316    21524
      317    21525    1   IF PRIVACY$ -> LX_ITEM.SYMBOL ~= %EMPTY    THEN
      318    21526    2     DO;
      319    21527    2       IF PRIVACY$ -> LX_ITEM.DNT$ -> DNT.TEXT.LENGTH > 14  THEN
      320    21528    3         DO;
      321    21529    3           PRIVACY$ -> LX_ITEM.DNT$ -> DNT.TEXT.LENGTH = 14;
      322    21530    3           CALL Z8AE$ERROR(%E$PRIVACY_KEY_TO_LONG,
      323    21531    3                           PRIVACY$ -> LX_ITEM.LINE,
      324    21532    3                           PRIVACY$ -> LX_ITEM.COLUMN);
      325    21533    3         END;
      326    21534    2       COMCOM.PRIVACY_LINE = PRIVACY$ -> LX_ITEM.LINE;
      327    21535    2       COMCOM.PRIVACY_COL = PRIVACY$ -> LX_ITEM.COLUMN;
      328    21536    2     END;
      329    21537    1   IF SCHEMA$ -> LX_ITEM.B.ERROR  OR SUB_SCHEMA$ -> LX_ITEM.B.ERROR  THEN
      330    21538    2     DO;
      331    21539    2       CALL Z8AE$ERROR(%E$SCHEMA_SUB_SCHEMA_ERROR);
      332    21540    2       CALL Z9AT$TERMINATOR;
      333    21541    2     END;
      334    21542
      335    21543
      336    21544    1   CALL Z9DM$READY_SSCHEMA( SCHEMA$, SUB_SCHEMA$, PRIVACY$ )
      337    21545    1     WHENALTRETURN
      338    21546    2     DO;
      339    21547    2       CALL Z8AE$ERROR(%E$SCHEMA_SUB_SCHEMA_ERROR);
      340    21548    2       CALL Z9AT$TERMINATOR;
      341    21549    2     END;
      342    21550
      343    21551    1   CALL Z9DM$GET_SUB_SCHEMA( RETURN_PTR$ );
      344    21552
      345    21553    1   O1COM.SECTION_FOUND.SUB_SCHEMA = TRUE;
      346    21554    1   COMCOM.IDS_SUB_SCHEMA = TRUE;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:14   
      347    21555    1   IA_TIME_DATE = CONTROL_SEG.TIME_DATE;
      348    21556    1   UWA_NAME.LAST = SUBSTR(SUB_SCHEMA$ -> LX_ITEM.DNT$->DNT.TEXT.NAME,0,4);
      349    21557    1   UWA_NAME.FIRST = 'U.';
      350    21558
      351    21559    1   CALL Z8AH$NEW_DNT(UWA_NAME,6,NEW_DNT$);
      352    21560
      353    21561    1   IF NEW_DNT$ -> DNT.ST$ = ADDR(NIL)    THEN
      354    21562    2     DO;
      355    21563
      356    21564            %NEW_BLOCK ( @ST$   = O1COM.DML_UWA$,
      357    21565                         @DNT$  = NEW_DNT$,
      358    21566                         @SIZE  = TOKEN_9.WORD_4);
      359    21643    2     END;
      360    21644    1   ELSE
      361    21645    1      O1COM.DML_UWA$ = NEW_DNT$ -> DNT.ST$;
      362    21646
      363    21647    1   NEW_DNT$ -> DNT.ST$ = O1COM.DML_UWA$;
      364    21648
      365    21649    1   IF TOKEN_9.WORD_4 > %#256K   THEN
      366    21650    2     DO;
      367    21651    2       CALL Z8AE$ERROR(%E$BLOCK_DATA_LIMIT,,,O1COM.DML_UWA$ -> BLOCK.DNT$);
      368    21652    2       COMCOM.DATA_LIMIT_ERROR_FLAGGED = TRUE;
      369    21653    2       COMCOM.OB.CHECK = '1'B;                 /*V* AVOID PHASE 5 ERROR */
      370    21654    2       O1COM.DML_UWA$ -> BLOCK.SIZE = 0;
      371    21655    2     END;
      372    21656
      373    21657    1   HEAD_UWA_QLT$ = ADDR(NIL);
      374    21658
      375    21659    1   CALL Z8EL$START_WRITING_ES_FILE(POINT$ -> LX_ITEM.LINE);
      376    21660
      377    21661    1   HEAD$ = LINE_LIST$;
      378    21662    1   IF HEAD$ -> FILL_BUFFER.ISN > POINT$ -> LX_ITEM.LINE THEN
      379    21663    2     DO; /* E.g., next statement is COPY */
      380    21664    2       NEED_DUMMY_BUF = TRUE; /* Subschema must come before this line */
      381    21665            %NEW_HEAP (@POINTER = HEAD$, @SIZE = %MAX_INPUT_BUFFER_LEN);
      382    21670    2       HEAD$ -> FILL_BUFFER.NEXT$ = LINE_LIST$;
      383    21671    2       HEAD$ -> FILL_BUFFER.ISN = LINE_LIST$ -> FILL_BUFFER.ISN - 1;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:15   
      384    21672    2     END;
      385    21673    1   ELSE
      386    21674    2   DO WHILE HEAD$ -> FILL_BUFFER.ISN ~= POINT$ -> LX_ITEM.LINE;
      387    21675
      388    21676    2       HEAD$ = HEAD$ -> FILL_BUFFER.NEXT$;
      389    21677
      390    21678    2   END;
      391    21679
      392    21680        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:16   
      393    21681    1   CALL Z9DM$GET_SUB_SCHEMA( RETURN_PTR$, HEAD$ );
      394    21682
      395    21683    2   DO WHILE RETURN_PTR$ ~= ADDR(NIL);
      396    21684
      397    21685    2       IF TOKEN_9.TYPE = %TYPE_9   THEN
      398    21686
      399    21687
      400    21688    2           IF TOKEN_9.BIB.RECORD OR TOKEN_9.BIB.FIELD   THEN  /*V* COBOL Data Item   */
      401    21689    3             DO;
      402    21690
      403    21691    3               DESC.DESCL = 0;                    /*V* ZERO DESCL FIELD */
      404    21692    3               NEW_LTS$ = ADDR(NIL);         /*V* NIL PTR FOR NOT RECORD */
      405    21693    3               NEW_LONG$ = ADDR(NIL);        /*V* NIL PTR FOR > 4095 */
      406    21694    3               DML_TYPE = %NO_TYPE;
      407    21695    3               P_BIT = %FALSE;
      408    21696    3               LENGTH = %SHORT_ITEM;                          /*#39131*/
      409    21697    3               IF TOKEN_9.LEVEL_NUMBER  = 77   THEN
      410    21698    3                   TOKEN_9.LEVEL_NUMBER = 1;
      411    21699
      412    21700    3               IF TOKEN_9.SIB.NUMERIC  THEN
      413    21701    4                 DO;
      414    21702                          /*V*             NUMERIC ITEM          */
      415    21703
      416    21704    4                   IF TOKEN_9.SIB.FLOAT_BIT    THEN      /*#36312*/
      417    21705    5                     DO;
      418    21706    5                       IF TOKEN_9.SIB.COMP_2   THEN
      419    21707    5                         TYPE = %TYR;
      420    21708    5                       ELSE
      421    21709    5                         TYPE = %TYQ;
      422    21710
      423    21711    5                       SA = TOKEN_9.OFFSET/4;
      424    21712    5                       DESC.NUM_NDSC.CN = (TOKEN_9.OFFSET - (SA* 4)) * 2;
      425    21713    5                       DESC.NUM_NDSC.TN = '0'B;
      426    21714    5                     END;
      427    21715    4                   ELSE
      428    21716    4                   IF TOKEN_9.SIB.COMP OR TOKEN_9.SIB.COMP_3 OR
      429    21717    4                      TOKEN_9.SIB.COMP_4 OR TOKEN_9.SIB.PIC_WITH_P THEN
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:17   
      430    21718    5                     DO;
      431    21719
      432    21720                            /*V*           PACKED DECIMAL        */
      433    21721
      434    21722    5                       TYPE = %TYD;
      435    21723    5                       DESC.NUM_NDSC.TN = '1'B;
      436    21724    5                       SA = TOKEN_9.OFFSET /8;
      437    21725    5                       DESC.NUM_NDSC.CN = TOKEN_9.OFFSET - (SA * 8);
      438    21726    5                       IF TOKEN_9.SIB.COMP_3 = %FALSE  THEN
      439    21727    5                          P_BIT = TRUE;
      440    21728
      441    21729    5                     END;
      442    21730
      443    21731    4                   ELSE
      444    21732
      445    21733    5                     DO;       /*V*           NON-PACKED      */
      446    21734
      447    21735    5                       IF TOKEN_9.SIB.COMP_1  THEN
      448    21736    5                           TYPE = %TYJ;
      449    21737    5                       ELSE
      450    21738    5                           IF TOKEN_9.SIB.COMP_2  THEN
      451    21739    5                               TYPE = %TYK;
      452    21740    5                           ELSE
      453    21741    5                               IF TOKEN_9.SIB.COMP_6    THEN
      454    21742    5                                   TYPE = %TYI;
      455    21743    5                               ELSE
      456    21744    5                                   IF TOKEN_9.BIB.COMP_11  THEN
      457    21745    5                                       TYPE = %TYR;
      458    21746    5                                   ELSE
      459    21747    5                                       IF TOKEN_9.BIB.COMP_12  THEN
      460    21748    5                                           TYPE = % TYQ;
      461    21749    5                                       ELSE
      462    21750    5                                          IF TOKEN_9.SIB.DISPLAY  THEN
      463    21751    5                                             TYPE = %TYD;
      464    21752    5                                          ELSE
      465    21753    5                                              TYPE = %TYO;    /*V*  PIC WITH A P */
      466    21754
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:18   
      467    21755
      468    21756    5                       SA = TOKEN_9.OFFSET/4;
      469    21757    5                       DESC.NUM_NDSC.CN = (TOKEN_9.OFFSET - (SA * 4)) * 2;
      470    21758    5                       DESC.NUM_NDSC.TN = '0'B;
      471    21759                                        /*V*  9-bit are stacked high   */
      472    21760
      473    21761    5                     END;      /*V*    NON  PACKED   */
      474    21762
      475    21763                        /*V*  Set scale factor                               */
      476    21764
      477    21765    4                   IF TYPE = %TYO   OR  TYPE = %TYD     THEN
      478    21766    5                     DO;
      479    21767    5                       IF TOKEN_9.LTDP > 0 THEN
      480    21768    6                         DO;                             /* STAR 24756 */
      481    21769    6                           DESC.NUM_NDSC.SF = TOKEN_9.LTDP - TOKEN_9.LENGTH;
      482    21770    6                           IF TOKEN_9.SIB.SIGN = %IDS_TRAILING_SEPARATE OR
      483    21771    6                                TOKEN_9.SIB.SIGN = %IDS_LEADING_SEPARATE  THEN
      484    21772    6                             DESC.NUM_NDSC.SF = DESC.NUM_NDSC.SF + 1;
      485    21773    6                         END;
      486    21774    5                       ELSE
      487    21775    5                           DESC.NUM_NDSC.SF = TOKEN_9.RTDP * (-1);
      488    21776
      489    21777                            /*V*  Set sign convention                            */
      490    21778
      491    21779    6                       DO CASE(TOKEN_9.SIB.SIGN);
      492    21780
      493    21781    6                         CASE( %IDS_TRAILING_SEPARATE );
      494    21782    6                           DESC.NUM_NDSC.S = %TRAILING_SIGN;
      495    21783
      496    21784    6                         CASE( %IDS_TRAILING_OVER );
      497    21785    6                           DESC.NUM_NDSC.S = %TRAILING_SIGN;   /*#30383*/
      498    21786    6                           TYPE = %TYO;                        /*#30383*/
      499    21787
      500    21788    6                         CASE( %IDS_LEADING_OVER );
      501    21789    6                           DESC.NUM_NDSC.S = %LEADING_SIGN;    /*#30383*/
      502    21790    6                           TYPE = %TYO;                        /*#30383*/
      503    21791
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:19   
      504    21792    6                         CASE( %IDS_LEADING_SEPARATE );
      505    21793    6                           DESC.NUM_NDSC.S = %LEADING_SIGN;
      506    21794
      507    21795    6                         CASE(ELSE);
      508    21796    6                           DESC.NUM_NDSC.S = %NO_SIGN;
      509    21797
      510    21798    6                       END;   /*V*    CASE    */
      511    21799
      512    21800    5                     END;     /*  IF TYPE = %TYO   OR  %TYD  */
      513    21801
      514    21802    4                   DESC.NUM_NDSC.N = TOKEN_9.LENGTH;
      515    21803    4                   CLASS_ = %CLASS_NUMERIC;
      516    21804
      517    21805    4                 END;   /*V*      NUMERIC     */
      518    21806
      519    21807    3               ELSE
      520    21808
      521    21809    4                 DO;                       /*V*   ALPHABETIC OR ALPHANUMERIC  */
      522    21810
      523    21811    4                   TYPE = %TYA;
      524    21812    4                   IF TOKEN_9.SIB.ALPHANUMERIC   OR
      525    21813    4                       NOT TOKEN_9.SIB.ELEMENTARY   THEN  /*#32332*/
      526    21814    4                       CLASS_ = %CLASS_ALPHANUMERIC;
      527    21815    4                   ELSE
      528    21816    4                       CLASS_ = %CLASS_ALPHABETIC;
      529    21817
      530    21818    4                       IF TOKEN_9.LENGTH > 4095    THEN
      531    21819    5                         DO;
      532    21820    5                           LENGTH = %LONG_ITEM;
      533    21821                                %NEW_LONG(@POINTER = NEW_LONG$,
      534    21822                                          @LENGTH  = TOKEN_9.LENGTH);
      535    21914    5                         END;
      536    21915                         /* ELSE
      537    21916                                LENGTH = %SHORT_ITEM; */           /*#39131*/
      538    21917
      539    21918    4                   SA = TOKEN_9.OFFSET/4;
      540    21919    4                   DESC.ALPHA_ADSC.CN = TOKEN_9.OFFSET - (SA * 4);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:20   
      541    21920    4                   DESC.ALPHA_ADSC.TA = '00'B;
      542    21921    4                   DESC.ALPHA_ADSC.N = TOKEN_9.LENGTH;
      543    21922
      544    21923    4                 END;       /*V*   ALPHA  AND ALPHANUMRIC   */
      545    21924         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:21   
      546    21925    3               IF TOKEN_9.LEVEL_NUMBER = 1      THEN
      547    21926    4                 DO;
      548    21927    4                   IF (TOKEN_9.BIB.FIELD = TRUE) AND (TOKEN_9.BIB.DB_KEY = %TRUE)  THEN
      549    21928    5                     DO;
      550    21929    5                       TYPE = %TYI;
      551    21930    5                       DML_TYPE = %DATA_BASE_KEY;
      552    21931    5                     END;
      553    21932                           /*V*      01   LEVEL   ITEM   */
      554    21933    4                   IF TOKEN_9.BIB.RECORD  THEN
      555    21934    5                     DO;
      556    21935
      557    21936    5                       DML_TYPE = %RECORD;
      558    21937    5                       RECORD_INFO.LOCATION_CALC = TOKEN_9.BIB.DB_KEY;
      559    21938               /*           RECORD_INFO.PARTIAL_RECORD = TOKEN_9.BIB.COMP_11;
      560    21939                            RECORD_INFO.STORE_NOT_PER = TOKEN_9.BIB.BIT30;
      561    21940                            RECORD_INFO.MODIFY_ONLY   = TOKEN_9.BIB.BIT31;
      562    21941                            RECORD_INFO.ALL_CALC_PRES = TOKEN_9.BIB.BIT33;
      563    21942                            RECORD_INFO.ERASE_ALL_NOT_PER = TOKEN_9.BIB.BIT34;
      564    21943                            RECORD_INFO.ERASE_NOT_PER = TOKEN_9.BIB.BIT35;
      565    21944                  These items are never referenced so have been commented out  */
      566    21945                            %NEW_DML_REC( @INFO  =  RECORD_INFO, @POINTER = NEW_LTS$);
      567    22037    5                     END;
      568    22038    4                   LEVEL_# = TOKEN_9.LEVEL_NUMBER;
      569    22039    4                   DML_STK_PTR = 1;
      570    22040    4                   START_LEVEL_#(LEVEL_#) = 1;
      571    22041    4                   DML_STK_PTR_OF_FATHER = 0;
      572    22042
      573    22043    4                   CALL BUILD_ST_ITEM;
      574    22044
      575    22045                        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);
      576    22052    4                   IF HEAD_UWA_QLT$ = ADDR(NIL)   THEN
      577    22053    4                       HEAD_UWA_QLT$ = NEW_QLT$;
      578    22054
      579    22055    4                   CALL Z9DM$GET_SUB_SCHEMA(RETURN_PTR$ );
      580    22056
      581    22057    4                 END;      /*V*    01  LEVEL  ITEM    */
      582    22058         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:22   
      583    22059    3               ELSE
      584    22060    4                 DO;                       /*V*     FIELD   ITEM       */
      585    22061
      586    22062    4                   IF HEAD_UWA_QLT$ = ADDR(NIL) THEN
      587    22063    5                     DO;
      588    22064    5                       CALL Z8AE$ERROR (%E$LEVEL_1_OR_77_AT_TOP);
      589    22065    5                       LEVEL_# = 1;
      590    22066    5                       START_LEVEL_# (1) = 1;
      591    22067    5                       DML_STK_PTR = 1;
      592    22068    5                       DML_STK_PTR_OF_FATHER = 0;
      593    22069    5                       CALL Z8AT$CREATE_TEMPORARY(%SCALAR,RETURN$);
      594    22070    5                       RETURN$ -> SCALAR.COUNT = O1COM.DML_UWA$ -> BLOCK.COUNT;
      595    22071    5                       RETURN$ -> SCALAR.B.ELEMENTARY = FALSE;
      596    22072    5                       RETURN$ -> SCALAR.B.GLOBAL = TRUE;
      597    22073    5                       RETURN$ -> SCALAR.B.EXTERNAL = TRUE;
      598    22074    5                       RETURN$ -> SCALAR.B.DML_UWA = TRUE;
      599    22075    5                       HEAD_UWA_QLT$ = RETURN$ -> SCALAR.QLT$;
      600    22076                            %UPDATE_DML_STK( @HEAD = 1,
      601    22077                                             @QLT$ = HEAD_UWA_QLT$,
      602    22078                                             @LEVEL# = 1,
      603    22079                                             @PTR_TO_FATHER = 0 );
      604    22086    5                     END;
      605    22087
      606    22088    4                   IF (TOKEN_9.BIB.FIELD = TRUE) AND (TOKEN_9.BIB.DB_KEY = %TRUE)  THEN
      607    22089    5                     DO;
      608    22090    5                       TYPE = %TYI;
      609    22091    5                       DML_TYPE = %DATA_BASE_KEY;
      610    22092    5                     END;
      611    22093    4                   ELSE IF TOKEN_9.BIB.NOT_IN_SCHEMA = %FALSE THEN
      612    22094    4                       DML_TYPE = %FIELD;
      613    22095
      614    22096    4                   IF TOKEN_9.LEVEL_NUMBER > LEVEL_#    THEN
      615    22097    5                     DO;
      616    22098    5                       DML_STK_PTR_OF_FATHER  =  DML_STK_PTR;
      617    22099    5                       LEVEL_# = TOKEN_9.LEVEL_NUMBER;
      618    22100    5                       START_LEVEL_#(LEVEL_#) = DML_STK_PTR + 1;
      619    22101    5                     END;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:23   
      620    22102
      621    22103    4                   DML_STK_PTR = DML_STK_PTR + 1;
      622    22104
      623    22105    4                   CALL BUILD_ST_ITEM;
      624    22106
      625    22107    4                   CALL Z9DM$GET_SUB_SCHEMA(RETURN_PTR$ );
      626    22108         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:24   
      627    22109    4                   IF RETURN_PTR$ = ADDR(NIL)        THEN
      628    22110    4                      NEXT_LEVEL = 1;
      629    22111    4                   ELSE
      630    22112
      631    22113    4                       IF TOKEN_9.TYPE ~= %TYPE_9        THEN
      632    22114    4                         NEXT_LEVEL = 1;
      633    22115    4                       ELSE
      634    22116
      635    22117    4                           IF TOKEN_9.LEVEL_NUMBER = 77     THEN
      636    22118    4                             NEXT_LEVEL = 1;
      637    22119    4                           ELSE
      638    22120    4                             NEXT_LEVEL = TOKEN_9.LEVEL_NUMBER;
      639    22121
      640    22122
      641    22123    5                   DO WHILE NEXT_LEVEL < LEVEL_#;
      642    22124    5                       PREVIOUS_BRO_QLT$ = ADDR(NIL);
      643    22125
      644    22126    6                       DO WHILE (DML_STK.LEVEL_#(DML_STK_PTR) = LEVEL_#);
      645    22127    6                           DML_STK.QLT$(DML_STK_PTR) -> QLT.FATHER  =
      646    22128    6                               DML_STK.QLT$(DML_STK.FATHER(DML_STK_PTR));
      647    22129
      648    22130    6                           DML_STK.QLT$(DML_STK_PTR) -> QLT.BROTHER =
      649    22131    6                                                       PREVIOUS_BRO_QLT$;
      650    22132
      651    22133    6                           PREVIOUS_BRO_QLT$ = DML_STK.QLT$(DML_STK_PTR);
      652    22134    6                           DML_STK_PTR = DML_STK_PTR - 1;
      653    22135
      654    22136    6                       END;    /*V*    WHILE    */
      655    22137
      656    22138    5                       IF DML_STK.QLT$(DML_STK_PTR) -> QLT.SON = ADDR(NIL) THEN
      657    22139    5                           DML_STK.QLT$(DML_STK_PTR) -> QLT.SON =
      658    22140    5                                                     PREVIOUS_BRO_QLT$;
      659    22141    5                       LEVEL_# = DML_STK.LEVEL_#(DML_STK_PTR);
      660    22142                                                              /*  STAR  24786  24820  */
      661    22143    5                       DML_STK_PTR_OF_FATHER = DML_STK.FATHER(DML_STK_PTR);
      662    22144
      663    22145    5                   END;      /*V*   WHILE   */
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:25   
      664    22146         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:26   
      665    22147                        /*V* Eliminate one item from the DML_STK when there
      666    22148                             are three consecutive data-names at the same
      667    22149                             level (next, DML_STK_PTR, DML_STK_PTR - 1).
      668    22150                             Set the "FATHER", "BROTHER", and "SON" QLT
      669    22151                             pointers for the item at DML_STK_PTR - 1;
      670    22152                             then move the item at DML_STK_PTR to DML_STK_PTR
      671    22153                             - 1; then decrement DML_STK_PTR by one.
      672    22154                        */
      673    22155
      674    22156    4                   IF NEXT_LEVEL = LEVEL_#
      675    22157    4                   AND DML_STK.LEVEL_# (DML_STK_PTR) =
      676    22158    4                       DML_STK.LEVEL_# (DML_STK_PTR - 1) THEN
      677    22159    5                     DO;
      678    22160
      679    22161    5                       DML_STK.QLT$ (DML_STK_PTR - 1) -> QLT.FATHER =
      680    22162    5                         DML_STK.QLT$ (DML_STK.FATHER (DML_STK_PTR - 1));
      681    22163    5                       DML_STK.QLT$ (DML_STK_PTR - 1) -> QLT.BROTHER =
      682    22164    5                         DML_STK.QLT$ (DML_STK_PTR);
      683    22165
      684    22166    5                       IF DML_STK.QLT$ (DML_STK.FATHER (DML_STK_PTR - 1)) ->
      685    22167    5                          QLT.SON = ADDR (NIL) THEN
      686    22168    5                         DML_STK.QLT$ (DML_STK.FATHER (DML_STK_PTR - 1)) ->
      687    22169    5                           QLT.SON = DML_STK.QLT$ (DML_STK_PTR - 1);
      688    22170
      689    22171    5                       DML_STK.QLT$ (DML_STK_PTR - 1) =
      690    22172    5                         DML_STK.QLT$ (DML_STK_PTR);
      691    22173                            /* LEVEL_# and FATHER are already equal,
      692    22174                               therefore no need to move them.
      693    22175                            */
      694    22176
      695    22177    5                       DML_STK_PTR = DML_STK_PTR - 1;
      696    22178
      697    22179    5                     END; /* 3 consecutive items at same level */
      698    22180        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:27   
      699    22181                        /*V*   IF DML_STK IS FULL, LINK QLT'S FOR CURRENT LEVEL */
      700    22182
      701    22183    4                   IF DML_STK_PTR >= 98     THEN /* Impossible */
      702    22184    5                     DO;
      703    22185
      704    22186    5                       IF DML_STK.QLT$(DML_STK.FATHER(DML_STK_PTR)) -> QLT.SON =
      705    22187    5                                                       ADDR(NIL)   THEN
      706    22188                                /*V*  SET SON IF THIS IS FIRST ITEM OF SUBSTRUCTURE    */
      707    22189
      708    22190    5                           DML_STK.QLT$(DML_STK.FATHER(DML_STK_PTR)) -> QLT.SON =
      709    22191    5                                    DML_STK.QLT$(START_LEVEL_#(LEVEL_#));
      710    22192
      711    22193    6                       IF START_LEVEL_#(LEVEL_#) < DML_STK_PTR THEN DO;
      712    22194
      713    22195    7                         DO I = START_LEVEL_#(LEVEL_#) TO (DML_STK_PTR - 1);
      714    22196    7                             DML_STK.QLT$(I) -> QLT.BROTHER = DML_STK.QLT$(I + 1);
      715    22197    7                             DML_STK.QLT$(I) -> QLT.FATHER = DML_STK.QLT$
      716    22198    7                                                       (DML_STK.FATHER(I));
      717    22199    7                         END;
      718    22200
      719    22201    6                         DML_STK(START_LEVEL_#(LEVEL_#)) = DML_STK(DML_STK_PTR);
      720    22202    6                         DML_STK_PTR = START_LEVEL_#(LEVEL_#);
      721    22203    6                       END;
      722    22204    6                       ELSE DO;
      723    22205    6                         J = DML_STK_PTR - 1;
      724    22206    7                         DO WHILE DML_STK.FATHER(J) = J - 1;
      725    22207    7                           J = J - 1;
      726    22208    7                         END;
      727    22209    6                         K = J - 1;
      728    22210    7                         DO I = START_LEVEL_#(DML_STK.LEVEL_#(J)) TO K;
      729    22211    7                           DML_STK.QLT$(I) -> QLT.BROTHER = DML_STK.QLT$(I + 1);
      730    22212    7                           DML_STK.QLT$(I) -> QLT.FATHER = DML_STK.QLT$(DML_STK.FATHER(
             22212                                    I));
      731    22213    7                         END;
      732    22214    6                         I = DML_STK.FATHER(J) + 1;
      733    22215    6                         DML_STK.QLT$(I) = DML_STK.QLT$(K + 1);
      734    22216    7                         DO K = K TO 23;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:28   
      735    22217    7                           DML_STK.QLT$ (I + 1) = DML_STK.QLT$ (K + 2);
      736    22218    7                           J = DML_STK.LEVEL_# (K + 2);
      737    22219    7                           DML_STK.LEVEL_# (I + 1) = J;
      738    22220    7                           DML_STK.FATHER (I + 1) = I;
      739    22221    7                           I = I + 1;
      740    22222    7                           START_LEVEL_#(J) = I;
      741    22223    7                         END;
      742    22224    6                         DML_STK_PTR = I;
      743    22225    6                         DML_STK_PTR_OF_FATHER = DML_STK.FATHER(I);
      744    22226    6                       END;
      745    22227
      746    22228    5                     END;
      747    22229
      748    22230    4               END;       /*V*        FIELD    ITEM     */
      749    22231
      750    22232    3             END;         /*V*        COBOL DATA ITEM    */
      751    22233        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:29   
      752    22234    2           ELSE
      753    22235    3             DO;               /*V*      IDS II TOKENS           */
      754    22236
      755    22237    4               IF TOKEN_9.BIB.REALM  THEN DO;
      756    22238    4                   DML_ID = %REALM;
      757    22239    4                   INDEXED_REALM = TOKEN_9.BIB.COMP_11;
      758    22240    4               END;
      759    22241    4               ELSE DO;
      760    22242    4                   INDEXED_REALM = %FALSE;
      761    22243    4                   IF TOKEN_9.BIB.SET  THEN
      762    22244    4                       DML_ID = %DML_SET;
      763    22245    4                   ELSE
      764    22246    4                       IF TOKEN_9.BIB.KEY  THEN
      765    22247    4                           DML_ID = %DML_KEY;
      766    22248    4                       ELSE
      767    22249    4                           DML_ID = %PRIVACY_KEY;
      768    22250    4               END;
      769    22251
      770    22252    3               CALL Z8AH$NEW_DNT(TOKEN_9.DATA_ITEM_NAME,
      771    22253    3                                 TOKEN_9.NAME_SIZE,NEW_DNT$);
      772    22254
      773    22255    3               IF NEW_DNT$ -> DNT.B.RW THEN
      774    22256    4                 DO;
      775    22257    4                   CALL Z8AE$ERROR (%E$RW_USED_AS_DATA_NAME,
      776    22258    4                                    COMCOM.CURRENT.LINE + TOKEN_9.LINE_NUMBER,
      777    22259    4                                    TOKEN_9.COLUMN,
      778    22260    4                                    NEW_DNT$);
      779    22261                        %NEW_DNT (@SIZE = TOKEN_9.NAME_SIZE,
      780    22262                                  @NAME = TOKEN_9.DATA_ITEM_NAME,
      781    22263                                  @NEXT = "DNT_BUCKETS(DNT_BUCKET_NUMBER)");
      782    22321    4                   DNT$ -> DNT.ATTR = NEW_DNT$ -> DNT.ATTR;
      783    22322    4                   DNT$ -> DNT.B.USER_WORD = TRUE;
      784    22323    4                   DNT$ -> DNT.B.RW = FALSE;
      785    22324    4                   DNT_BUCKETS(DNT_BUCKET_NUMBER) = DNT$;
      786    22325    4                   NEW_DNT$ = DNT$;
      787    22326    4                 END;
      788    22327
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:30   
      789    22328                    %NEW_DML_ITEM(  @ST$    = RETURN$,
      790    22329                                    @ID     = DML_ID,
      791    22330                                    @INT_NAME = TOKEN_9.OFFSET,
      792    22331                                    @TEMP     = TOKEN_9.BIB.DB_KEY,
      793    22332                                    @INDEXED_REALM = INDEXED_REALM,
      794    22333                                    @NEXT   = NEW_DNT$ -> DNT.ST$,
      795    22334                                    @DNT$   = NEW_DNT$);
      796    22405
      797    22406                    %NEW_QLT(   @POINTER  = NEW_QLT$,
      798    22407                                @DNT$     = NEW_DNT$,
      799    22408                                @ST$      = RETURN$);
      800    22433
      801    22434    3               RETURN$ -> DML_ITEM.QLT$ = NEW_QLT$;
      802    22435                    %UPDATE_PREV_QLT$ (@NEW_QLT$ = NEW_QLT$);
      803    22442    3               NEW_DNT$ -> DNT.ST$ = RETURN$;
      804    22443
      805    22444    3               CALL Z9DM$GET_SUB_SCHEMA(RETURN_PTR$ );
      806    22445
      807    22446    3             END;      /*V*     IDS  II  TOKENS  */
      808    22447        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:31   
      809    22448    2       ELSE
      810    22449    3         DO;                               /*V*  TYPE 31, 32, OR 33    */
      811    22450    3           IF TOKEN_9.TYPE = %TYPE_31 OR TOKEN_9.TYPE = %TYPE_32    THEN
      812    22451    4             DO;
      813    22452    4               CURRENT_PTR$ = HEAD_UWA_QLT$;
      814    22453    4               WORD_OFFSET = TOKEN_9.LINE_NUMBER / 4;
      815    22454    4               FOUND = %FALSE;
      816    22455    5               DO UNTIL FOUND OR (CURRENT_PTR$ = ADDR(NIL));
      817    22456    5                   IF CURRENT_PTR$ -> QLT.ST$ -> SCALAR.SA = WORD_OFFSET THEN
      818    22457    6                     DO;
      819    22458    6                       FOUND = TRUE;
      820    22459                            %GET_LTS (@ID      = %DML_REC,
      821    22460                                      @ST$     = "CURRENT_PTR$ -> QLT.ST$",
      822    22461                                      @RETURN$ = CURRENT_LTS$);
      823    22504    6                     END;
      824    22505    5                   ELSE
      825    22506    5                       CURRENT_PTR$ = CURRENT_PTR$ -> QLT.BROTHER;
      826    22507
      827    22508    5               END;
      828    22509
      829    22510    5               IF FOUND = FALSE THEN DO;
      830    22511    5                 CALL Z8AE$ERROR (%E$ILLEGAL_TYPE_31_32_RECORD);
      831    22512    5                 CALL Z8AE$ERROR (%E$SCHEMA_SUB_SCHEMA_ERROR);
      832    22513                      /* Subschema file is in inconsistent state.
      833    22514                         Recovery is not possible. */
      834    22515    5                 CALL Z9AT$TERMINATOR;
      835    22516    5               END;
      836    22517    5               ELSE IF TOKEN_9.TYPE = %TYPE_31 THEN DO;
      837    22518                      %TOP_QLT (POINTER=CURRENT_PTR$);
      838    22523    5                 REALM_NO = TOKEN_9.COLUMN; /* FOR TYPE 31, REALM NUMBER */
      839    22524    5                 FOUND = %FALSE;
      840    22525    6                 DO UNTIL FOUND OR (CURRENT_PTR$ = ADDR(NIL));
      841    22526    6                   IF CURRENT_PTR$ -> QLT.ST$ -> ST.ID = %REALM AND
      842    22527    6                       CURRENT_PTR$ -> QLT.ST$ -> DML_ITEM.INTERNAL_NAME = REALM_NO
             22527                                THEN
      843    22528    6                     FOUND = TRUE;
      844    22529    6                   ELSE
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:32   
      845    22530    6                     CURRENT_PTR$ = CURRENT_PTR$ -> QLT.BROTHER;
      846    22531    6                 END;
      847    22532    5                 IF FOUND THEN
      848    22533    5                   CURRENT_LTS$ -> DML_REC.RECORD_INFO.RECORD_PARTIAL_DESCRIBED =
      849    22534    5                       CURRENT_PTR$ -> QLT.ST$ -> DML_ITEM.B.INDEXED_REALM;
      850    22535    6                 DO WHILE(CURRENT_LTS$ -> DML_REC.REALM_RELATIONSHIP
      851    22536    6                                                              = TRUE);
      852    22537    6                     IF CURRENT_LTS$ -> DML_REC.EXTEND$ = ADDR(NIL)  THEN
      853    22538    7                       DO;
      854    22539                              %NEW_EXT_DML( @POINTER  = NEW_LTS$);
      855    22630    7                         CURRENT_LTS$ -> DML_REC.EXTEND$ = NEW_LTS$;
      856    22631    7                         CURRENT_LTS$ = NEW_LTS$;
      857    22632    7                       END;
      858    22633    6                     ELSE
      859    22634    6                         CURRENT_LTS$ = CURRENT_LTS$ -> DML_REC.EXTEND$;
      860    22635
      861    22636    6                 END;    /*     WHILE     */
      862    22637
      863    22638    5                 CURRENT_LTS$ -> DML_REC.REALM_RELATIONSHIP = TRUE;
      864    22639    5                 CURRENT_LTS$ -> DML_REC.REALM_NAME = TOKEN_9.COLUMN;
      865    22640    5                 CURRENT_LTS$ -> DML_REC.REALM_INFO.TEMP_AREA =
      866    22641    5                                                   TOKEN_9.WORD4.BIT0;
      867    22642    5               END;
      868    22643            %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:33   
      869    22644    5               ELSE DO; /* %TYPE_32 */
      870    22645
      871    22646    6                       DO WHILE(CURRENT_LTS$ -> DML_REC.SET_RELATIONSHIP
      872    22647    6                                                                    = TRUE);
      873    22648    6                           IF CURRENT_LTS$ -> DML_REC.EXTEND$ = ADDR(NIL)  THEN
      874    22649    7                             DO;
      875    22650                                    %NEW_EXT_DML( @POINTER  = NEW_LTS$);
      876    22741    7                               CURRENT_LTS$ -> DML_REC.EXTEND$ = NEW_LTS$;
      877    22742    7                               CURRENT_LTS$ = NEW_LTS$;
      878    22743    7                             END;
      879    22744
      880    22745    6                           ELSE
      881    22746    6                               CURRENT_LTS$ = CURRENT_LTS$ -> DML_REC.EXTEND$;
      882    22747
      883    22748    6                       END;   /*V*     WHILE     */
      884    22749
      885    22750    5                       CURRENT_LTS$ -> DML_REC.SET_RELATIONSHIP = TRUE;
      886    22751    5                       CURRENT_LTS$ -> DML_REC.SET_NAME = TOKEN_9.COLUMN;
      887    22752    5                       CURRENT_LTS$ -> DML_REC.SET_INFO.MODIFY_ONLY_NOT_PERMITTED =
      888    22753    5                                                         TOKEN_9.WORD4.BIT4;
      889    22754
      890    22755    5                       IF TOKEN_9.WORD4.BIT0 = TRUE  THEN
      891    22756    5                             MEMBERSHIP = %OWNER;
      892    22757    5                       ELSE
      893    22758                            /*  IF TOKEN_9.WORD4.BIT1 = TRUE  THEN
      894    22759                                    MEMBERSHIP = %MEMBER;
      895    22760                                ELSE
      896    22761                                    IF TOKEN_9.WORD4.BIT2 = TRUE  THEN
      897    22762                                        MEMBERSHIP = %MEMBER_OPT;
      898    22763                                    ELSE      **  NEVER REFERENCED  ** */
      899    22764    5                                   MEMBERSHIP = %MEMBER_MANUAL;
      900    22765
      901    22766    5                       CURRENT_LTS$ -> DML_REC.SET_INFO.MEMBERSHIP =MEMBERSHIP;
      902    22767            %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:34   
      903    22768             /*         CASE(%TYPE_33);
      904    22769                            DO WHILE(CURRENT_LTS$ -> DML_REC.KEY_RELATIONSHIP
      905    22770                                                                         = TRUE);
      906    22771                                IF CURRENT_LTS$ -> DML_REC.EXTEND$ = ADDR(NIL)  THEN
      907    22772                                  DO;
      908    22773                                    %NEW_EXT_DML( @POINTER  = NEW_LTS$);
      909    22774                                    CURRENT_LTS$ -> DML_REC.EXTEND$ = NEW_LTS$;
      910    22775                                    CURRENT_LTS$ = NEW_LTS$;
      911    22776                                  END;
      912    22777
      913    22778                                ELSE
      914    22779                                    CURRENT_LTS$ = CURRENT_LTS$ -> DML_REC.EXTEND$;
      915    22780
      916    22781                            END;    *V*     WHILE        *
      917    22782
      918    22783                            CURRENT_LTS$ -> DML_REC.KEY_RELATIONSHIP = TRUE;
      919    22784                            CURRENT_LTS$ -> DML_REC.KEY_NAME =TOKEN_9.COLUMN;
      920    22785
      921    22786
      922    22787                    END;    *V*     CASE                   */
      923    22788
      924    22789    5               END; /* %TYPE_32 */
      925    22790
      926    22791    4             END;            /*  IF TYPE_31 OR TYPE_32   */
      927    22792
      928    22793
      929    22794    3           CALL Z9DM$GET_SUB_SCHEMA(RETURN_PTR$ );
      930    22795
      931    22796    3         END;                              /*V*   TYPE 31, 32, 33  */
      932    22797
      933    22798    2   END;      /*V*    WHILE    */
      934    22799
      935    22800    1   IF NEED_DUMMY_BUF THEN
      936    22801    2     DO;
      937    22802    2       LINE_LIST$ = HEAD$ -> FILL_BUFFER.NEXT$;
      938    22803            %DISPOSE_HEAP (@POINTER = HEAD$, @SIZE = %MAX_INPUT_BUFFER_LEN);
      939    22808    2     END;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:35   
      940    22809        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:36   
      941    22810         /*V*      BUILDING THE DML STATUS REGISTERS      */
      942    22811
      943    22812    1   DESC.DESCL = 0;
      944    22813    1   SA = REGISTER_OFFSET(0) / 4;
      945    22814    1   DESC.NUM_NDSC.CN = REGISTER_OFFSET(0) - (SA * 4);
      946    22815    1   DESC.NUM_NDSC.TN = '0'B;
      947    22816    1   DESC.NUM_NDSC.S = %NO_SIGN;
      948    22817    1   DESC.NUM_NDSC.N = REGISTER_LENGTH(0);
      949    22818
      950    22819    1   CALL Z8AH$NEW_DNT(SUBSTR(REGISTER_NAME(0),0,NAME_LENGTH(0)),NAME_LENGTH(0),NEW_DNT$)
             22819            ;
      951    22820
      952    22821        %NEW_SCALAR( @ST$   = RETURN$,
      953    22822                     @DESCL = DESC.DESCL,
      954    22823                     @NEXT  = NEW_DNT$ -> DNT.ST$,
      955    22824                     @COUNT = O1COM.DML_UWA$ -> BLOCK.COUNT,
      956    22825                     @SA    = SA,
      957    22826                     @CLASS = %CLASS_NUMERIC,
      958    22827                     @ELEMENTARY = TRUE,
      959    22828                     @GLOBAL     = TRUE,
      960    22829                     @EXTERNAL   = TRUE,
      961    22830                     @COMPILER_CREATED = TRUE,
      962    22831                     @DNT$  = NEW_DNT$,
      963    22832                     @TYPE  = %TYD,
      964    22833                     @DML_UWA = TRUE,
      965    22834                     @DML_TYPE = %DML_REG);
      966    23034
      967    23035        %NEW_QLT(   @POINTER    = NEW_QLT$,
      968    23036                    @DNT$       = NEW_DNT$,
      969    23037                    @ST$        = RETURN$);
      970    23062
      971    23063    1   RETURN$ -> SCALAR.QLT$ = NEW_QLT$;
      972    23064    1   NEW_DNT$ -> DNT.ST$ = RETURN$;
      973    23065
      974    23066        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);
      975    23073
      976    23074    1   DESC.DESCL = 0;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:37   
      977    23075    1   DESC.ALPHA_ADSC.TA = '00'B;
      978    23076    2   DO I = 1 TO 6;
      979    23077
      980    23078    2       SA = REGISTER_OFFSET(I) / 4;
      981    23079    2       DESC.ALPHA_ADSC.CN = REGISTER_OFFSET(I) - (SA * 4);
      982    23080    2       DESC.ALPHA_ADSC.N = REGISTER_LENGTH(I);
      983    23081
      984    23082    2       CALL Z8AH$NEW_DNT(SUBSTR(REGISTER_NAME(I),0,NAME_LENGTH(I)),NAME_LENGTH(I),
             23082                NEW_DNT$);
      985    23083
      986    23084            %NEW_SCALAR( @ST$   = RETURN$,
      987    23085                         @DESCL = DESC.DESCL,
      988    23086                         @NEXT  = NEW_DNT$ -> DNT.ST$,
      989    23087                         @COUNT = O1COM.DML_UWA$ -> BLOCK.COUNT,
      990    23088                         @SA    = SA,
      991    23089                         @CLASS = %CLASS_ALPHANUMERIC,
      992    23090                         @ELEMENTARY = TRUE,
      993    23091                         @GLOBAL     = TRUE,
      994    23092                         @EXTERNAL   = TRUE,
      995    23093                         @COMPILER_CREATED = TRUE,
      996    23094                         @DNT$  = NEW_DNT$,
      997    23095                         @TYPE  = %TYA,
      998    23096                         @DML_UWA  = TRUE,
      999    23097                         @DML_TYPE = %DML_REG);
     1000    23297
     1001    23298            %NEW_QLT(   @POINTER    = NEW_QLT$,
     1002    23299                        @DNT$       = NEW_DNT$,
     1003    23300                        @ST$        = RETURN$);
     1004    23325
     1005    23326    2       RETURN$ -> SCALAR.QLT$ = NEW_QLT$;
     1006    23327    2       NEW_DNT$ -> DNT.ST$ = RETURN$;
     1007    23328
     1008    23329            %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);
     1009    23336
     1010    23337    2   END;  /*V*   DO LOOP   */
     1011    23338        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:38   
     1012    23339                 /*V*    BUILD LAST  REGISTER   */
     1013    23340
     1014    23341    1   DESC.DESCL = 0;
     1015    23342    1   SA = REGISTER_OFFSET(7) / 4;
     1016    23343    1   DESC.NUM_NDSC.CN = REGISTER_OFFSET(7) - (SA * 4);
     1017    23344    1   DESC.NUM_NDSC.TN = '0'B;
     1018    23345    1   DESC.NUM_NDSC.N = REGISTER_LENGTH(7);
     1019    23346
     1020    23347    1   CALL Z8AH$NEW_DNT(SUBSTR(REGISTER_NAME(7),0,NAME_LENGTH(7)),NAME_LENGTH(7),NEW_DNT$)
             23347            ;
     1021    23348
     1022    23349        %NEW_SCALAR( @ST$   = RETURN$,
     1023    23350                     @DESCL = DESC.DESCL,
     1024    23351                     @NEXT  = NEW_DNT$ -> DNT.ST$,
     1025    23352                     @COUNT = O1COM.DML_UWA$ -> BLOCK.COUNT,
     1026    23353                     @SA    = SA,
     1027    23354                     @CLASS = %CLASS_NUMERIC,
     1028    23355                     @ELEMENTARY = TRUE,
     1029    23356                     @GLOBAL     = TRUE,
     1030    23357                     @EXTERNAL   = TRUE,
     1031    23358                     @COMPILER_CREATED = TRUE,
     1032    23359                     @DNT$  = NEW_DNT$,
     1033    23360                     @TYPE  = %TYI,
     1034    23361                     @DML_UWA = TRUE,
     1035    23362                     @DML_TYPE = %DIRECT_REFERENCE);
     1036    23562
     1037    23563        %NEW_QLT(   @POINTER    = NEW_QLT$,
     1038    23564                    @DNT$       = NEW_DNT$,
     1039    23565                    @ST$        = RETURN$);
     1040    23590
     1041    23591    1   RETURN$ -> SCALAR.QLT$ = NEW_QLT$;
     1042    23592    1   NEW_DNT$ -> DNT.ST$ = RETURN$;
     1043    23593        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);
     1044    23600        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:39   
     1045    23601                      /*V* BUILD  ST ITEM FOR TENANCY CONDITIONS */
     1046    23602
     1047    23603    1   DESC.DESCL = 0;
     1048    23604    1   DESC.NUM_NDSC.CN = 0;
     1049    23605    1   DESC.NUM_NDSC.TN = '0'B;
     1050    23606    1   DESC.NUM_NDSC.N = 4;
     1051    23607
     1052    23608    1   CALL Z8AH$NEW_DNT( 'UWA+0', 5, NEW_DNT$);
     1053    23609        %NEW_SCALAR( @ST$ = O1COM.UWA_PLUS_ZERO$,
     1054    23610                     @DESCL = DESC.DESCL,
     1055    23611                     @NEXT = NEW_DNT$ -> DNT.ST$,
     1056    23612                     @COUNT = O1COM.DML_UWA$  -> BLOCK.COUNT,
     1057    23613                     @SA = 0,
     1058    23614                     @ELEMENTARY = TRUE,
     1059    23615                     @GLOBAL     = TRUE,
     1060    23616                     @EXTERNAL   = TRUE,
     1061    23617                     @DNT$ = NEW_DNT$,
     1062    23618                     @TYPE = %TYI,
     1063    23619                     @DML_UWA = TRUE);
     1064    23819        %NEW_QLT( @POINTER = NEW_QLT$,
     1065    23820                  @DNT$ = NEW_DNT$,
     1066    23821                  @ST$ = O1COM.UWA_PLUS_ZERO$);
     1067    23846    1   O1COM.UWA_PLUS_ZERO$ -> SCALAR.QLT$ = NEW_QLT$;
     1068    23847    1   NEW_DNT$ -> DNT.ST$ = O1COM.UWA_PLUS_ZERO$;
     1069    23848        %UPDATE_PREV_QLT$( @NEW_QLT$ = NEW_QLT$);
     1070    23855        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:40   
     1071    23856         /*V*      BUILD DML INTERFACE AREA                              */
     1072    23857
     1073    23858    1   DESC.DESCL = 0;
     1074    23859    1   DESC.ALPHA_ADSC.N = 184;                         /*V*  46 WORDS  */
     1075    23860    1   CALL Z8AH$NEW_DNT('DML$INTERFACE$AREA',18,NEW_DNT$);
     1076    23861
     1077    23862        %NEW_SCALAR(@ST$    = O1COM.DML_IA$,
     1078    23863                    @DESCL  = DESC.DESCL,
     1079    23864                    @NEXT   = NEW_DNT$ -> DNT.ST$,
     1080    23865                    @CLASS  = %CLASS_ALPHABETIC,
     1081    23866                    @DNT$   = NEW_DNT$,
     1082    23867                    @TYPE   = %TYA,
     1083    23868           /*       @MOD_8  = TRUE,  */
     1084    23869                    @ELEMENTARY = TRUE);
     1085    24069
     1086    24070        %NEW_QLT  ( @POINTER = NEW_QLT$,
     1087    24071                    @DNT$    = NEW_DNT$,
     1088    24072                    @ST$     = O1COM.DML_IA$);
     1089    24097
     1090    24098        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);
     1091    24105
     1092    24106    1   O1COM.DML_IA$ -> SCALAR.QLT$ = NEW_QLT$;
     1093    24107    1   NEW_DNT$ -> DNT.ST$ = O1COM.DML_IA$;
     1094    24108    1   DESC.DESCL = 0;                                /*V* ZERO DESCL FIELD */
     1095    24109
     1096    24110
     1097    24111    1   CALL Z8AH$NEW_DNT('DML$USEP',8,NEW_DNT$);
     1098    24112        %NEW_SCALAR(@ST$    = O1COM.USEP$,
     1099    24113                    @NEXT   = NEW_DNT$ -> DNT.ST$,
     1100    24114                    @CLASS  = %CLASS_ALPHANUMERIC,
     1101    24115                    @DNT$   = NEW_DNT$,
     1102    24116                    @TYPE   = %TYA);
     1103    24316        %NEW_QLT(@POINTER   = NEW_QLT$,
     1104    24317                 @DNT$      = NEW_DNT$,
     1105    24318                 @ST$       = O1COM.USEP$);
     1106    24343        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);
     1107    24350    1   O1COM.USEP$ -> SCALAR.QLT$ = NEW_QLT$;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:41   
     1108    24351    1   NEW_DNT$ -> DNT.ST$ = O1COM.USEP$;
     1109    24352
     1110    24353    1   CALL Z8AH$NEW_DNT('DML$RVA',7,NEW_DNT$);
     1111    24354        %NEW_SCALAR(@ST$    = O1COM.RVA$,
     1112    24355                    @NEXT   = NEW_DNT$ -> DNT.ST$,
     1113    24356                    @CLASS  = %CLASS_ALPHANUMERIC,
     1114    24357                    @DNT$   = NEW_DNT$,
     1115    24358                    @TYPE   = %TYA);
     1116    24558        %NEW_QLT(@POINTER   = NEW_QLT$,
     1117    24559                 @DNT$      = NEW_DNT$,
     1118    24560                 @ST$       = O1COM.RVA$);
     1119    24585        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);
     1120    24592    1   O1COM.RVA$ -> SCALAR.QLT$ = NEW_QLT$;
     1121    24593    1   NEW_DNT$ -> DNT.ST$ = O1COM.RVA$;
     1122    24594
     1123    24595        /*V*   Preset the needed items into the DML$INTERFACE$AREA    */
     1124    24596
     1125    24597        %SET_PHASE_1_POSITION(@TYPE = %S_TYPE_INITIALIZE);
     1126    24986
     1127    24987        %NEW_ILL( @ID = %P_A_PRESET,
     1128    24988                  @OFFSET = 1,
     1129    24989                  @LOP    = O1COM.DML_UWA$,
     1130    24990                  @ROPCON = 0,
     1131    24991                  @TO     = O1COM.DML_IA$);
     1132    25370
     1133    25371    1   NAME =  SCHEMA$ -> LX_ITEM.DNT$ -> DNT.TEXT.NAME;
     1134    25372    2   DO I = 0 TO 29;                    /*V*   Change   -  to  _  for IDS */
     1135    25373    2       IF SUBSTR(NAME,I,1) = '-'     THEN
     1136    25374    2           SUBSTR(NAME,I,1) = '_';
     1137    25375    2   END;
     1138    25376
     1139    25377        %NEW_CONST( @ST$ = RETURN$);
     1140    25418        %NEW_LCNST( @POINTER = NEW_LTS$,
     1141    25419                    @SIZE    = 9,
     1142    25420                    @CONST   = NAME);
     1143    25513    1   RETURN$ -> CONST.B.LONG_CONSTANT = TRUE;
     1144    25514    1   RETURN$ -> CONST.CONST$.PTR$ = NEW_LTS$;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:42   
     1145    25515
     1146    25516    1   RETURN$ -> CONST.ADSC.N = 30;
     1147    25517    1   RETURN$ -> CONST.TYPE = %TYA;
     1148    25518
     1149    25519        %NEW_ILL(@ID = %PRESET,
     1150    25520                 @LOP = O1COM.DML_IA$,
     1151    25521                 @ROP = RETURN$,
     1152    25522                 @OFFSET = 10);
     1153    25901
     1154    25902        %NEW_CONST( @ST$ = RETURN$);
     1155    25943    1   NAME = SUB_SCHEMA$ -> LX_ITEM.DNT$ -> DNT.TEXT.NAME;
     1156    25944        %NEW_LCNST( @POINTER = NEW_LTS$,
     1157    25945                    @SIZE    = 9,
     1158    25946                    @CONST   = NAME);
     1159    26039    1   RETURN$ -> CONST.B.LONG_CONSTANT = TRUE;
     1160    26040    1   RETURN$ -> CONST.CONST$.PTR$ = NEW_LTS$;
     1161    26041
     1162    26042    1   RETURN$ -> CONST.ADSC.N = 30;
     1163    26043    1   RETURN$ -> CONST.TYPE = %TYA;
     1164    26044
     1165    26045        %NEW_ILL(@ID = %PRESET,
     1166    26046                 @LOP = O1COM.DML_IA$,
     1167    26047                 @ROP = RETURN$,
     1168    26048                 @OFFSET = 18);
     1169    26427
     1170    26428
     1171    26429
     1172    26430        %NEW_CONST( @ST$ = RETURN$);
     1173    26471    1   NAME = O1COM.PROG_ID_DNT$ -> DNT.TEXT.NAME;
     1174    26472
     1175    26473        %NEW_LCNST( @POINTER = NEW_LTS$,
     1176    26474                    @SIZE    = 30,
     1177    26475                    @CONST   = NAME);
     1178    26568    1   RETURN$ -> CONST.B.LONG_CONSTANT = TRUE;
     1179    26569    1   RETURN$ -> CONST.CONST$.PTR$ = NEW_LTS$;
     1180    26570
     1181    26571    1   RETURN$ -> CONST.ADSC.N = 30;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:43   
     1182    26572    1   RETURN$ -> CONST.TYPE = %TYA;
     1183    26573
     1184    26574        %NEW_ILL(@ID = %PRESET,
     1185    26575                 @LOP = O1COM.DML_IA$,
     1186    26576                 @ROP = RETURN$,
     1187    26577                 @OFFSET = 26);
     1188    26956
     1189    26957        %NEW_CONST( @ST$ = RETURN$);
     1190    26998    1   IF COMCOM.AUTHOR$ = ADDR(NIL)   THEN
     1191    26999    1       NAME = ' ';
     1192    27000    1   ELSE
     1193    27001    1       NAME = COMCOM.AUTHOR$ -> DNT.TEXT.NAME;
     1194    27002
     1195    27003        %NEW_LCNST( @POINTER = NEW_LTS$,
     1196    27004                    @SIZE    = 30,
     1197    27005                    @CONST   = NAME);
     1198    27098    1   RETURN$ -> CONST.B.LONG_CONSTANT = TRUE;
     1199    27099    1   RETURN$ -> CONST.CONST$.PTR$ = NEW_LTS$;
     1200    27100
     1201    27101    1   RETURN$ -> CONST.ADSC.N = 30;
     1202    27102    1   RETURN$ -> CONST.TYPE = %TYA;
     1203    27103
     1204    27104        %NEW_ILL(@ID = %PRESET,
     1205    27105                 @LOP = O1COM.DML_IA$,
     1206    27106                 @ROP = RETURN$,
     1207    27107                 @OFFSET = 34);
     1208    27486
     1209    27487        %NEW_CONST( @ST$ = RETURN$);
     1210    27528    1   RETURN$ -> CONST.CONSTA = IA_TIME_DATE;
     1211    27529    1   RETURN$ -> CONST.ADSC.N = 8;
     1212    27530    1   RETURN$ -> CONST.TYPE = %TYA;
     1213    27531
     1214    27532        %NEW_ILL( @ID = %PRESET,
     1215    27533                  @LOP = O1COM.DML_IA$,
     1216    27534                  @ROP = RETURN$,
     1217    27535                  @OFFSET = 44);
     1218    27914
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:44   
     1219    27915    1   RETURN;
     1220    27916        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:45   
     1221    27917        /*-------------*/
     1222    27918    1     BUILD_ST_ITEM :  PROC;
     1223    27919        /*-------------*/
     1224    27920
     1225    27921
     1226    27922    2   DCL    LINE_NUMBER     SBIN WORD;
     1227    27923    2   DCL    Z8DO$LINK_WITH_LTS ENTRY(2);
     1228    27924
     1229    27925
     1230    27926    2        CALL Z8AH$NEW_DNT(TOKEN_9.DATA_ITEM_NAME, TOKEN_9.NAME_SIZE, NEW_DNT$);
     1231    27927    2        IF NEW_DNT$ -> DNT.B.RW   THEN
     1232    27928    3          DO;
     1233    27929                                                                  /*#30134*/
     1234    27930    3            LINE_NUMBER = COMCOM.CURRENT.LINE + TOKEN_9.LINE_NUMBER;
     1235    27931
     1236    27932    3            CALL Z8AE$ERROR( %E$RW_USED_AS_DATA_NAME,
     1237    27933    3                             LINE_NUMBER,
     1238    27934    3                             TOKEN_9.COLUMN,
     1239    27935    3                             NEW_DNT$ );
     1240    27936                  %NEW_DNT(@SIZE = TOKEN_9.NAME_SIZE,
     1241    27937                              @POINTER = NEW_DNT$$,
     1242    27938                              @NAME = TOKEN_9.DATA_ITEM_NAME,
     1243    27939                              @ST$ = "ADDR(NIL)",
     1244    27940                              @NEXT = "DNT_BUCKETS(DNT_BUCKET_NUMBER)");
     1245    27998    3             NEW_DNT$$ -> DNT.ATTR = NEW_DNT$ -> DNT.ATTR;
     1246    27999    3             NEW_DNT$$ -> DNT.B.USER_WORD = TRUE;
     1247    28000    3             NEW_DNT$$ -> DNT.B.RW = FALSE;
     1248    28001    3             DNT_BUCKETS(DNT_BUCKET_NUMBER) = NEW_DNT$$;
     1249    28002    3             NEW_DNT$ = NEW_DNT$$;
     1250    28003
     1251    28004    3          END;
     1252    28005
     1253    28006             %NEW_SCALAR( @ST$       = RETURN$,
     1254    28007                          @DESCL     = DESC.DESCL,
     1255    28008                          @NEXT      = NEW_DNT$ -> DNT.ST$,
     1256    28009                          @COUNT     = O1COM.DML_UWA$ -> BLOCK.COUNT,
     1257    28010                          @SA        = SA,
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:46   
     1258    28011                          @CLASS     = CLASS_,
     1259    28012                          @DNT$      = NEW_DNT$,
     1260    28013                          @TYPE      = TYPE,
     1261    28014                          @JUSTIFIED = TOKEN_9.SIB.JUSTIFIED,
     1262    28015                          @ELEMENTARY = TOKEN_9.SIB.ELEMENTARY,
     1263    28016                          @DIGIT     = P_BIT,
     1264    28017                          @GLOBAL    = TRUE,
     1265    28018                          @EXTERNAL  = TRUE,
     1266    28019                          @LENGTH_4096 = LENGTH,
     1267    28020                          @LTS$      = NEW_LTS$,
     1268    28021                          @P         = P_BIT,
     1269    28022                          @DML_UWA   = TOKEN_9.BIB.USER_WORK_AREA,
     1270    28023                          @DML_TYPE  = DML_TYPE);
     1271    28223
     1272    28224    2        IF NEW_LONG$ ~= ADDR(NIL) THEN
     1273    28225    2          CALL Z8DO$LINK_WITH_LTS (RETURN$ -> SCALAR.LTS$, NEW_LONG$);
     1274    28226
     1275    28227             %NEW_QLT(    @POINTER   = NEW_QLT$,
     1276    28228                          @DNT$      = NEW_DNT$,
     1277    28229                          @ST$       = RETURN$,
     1278    28230                          @LEVEL#    = LEVEL_#);
     1279    28255
     1280    28256    2        RETURN$ -> SCALAR.QLT$ = NEW_QLT$;
     1281    28257    2        NEW_DNT$ -> DNT.ST$ = RETURN$;
     1282    28258
     1283    28259    2        IF DML_STK_PTR > 98 THEN                  /* Impossible */
     1284    28260    2          CALL Z8AE$ERROR( %E$DML_STACK_OVERFLOW_ERROR,
     1285    28261    2                           LINE_NUMBER,
     1286    28262    2                           0 );
     1287    28263
     1288    28264             %UPDATE_DML_STK( @HEAD = DML_STK_PTR,
     1289    28265                               @QLT$ = NEW_QLT$,
     1290    28266                               @LEVEL#  = LEVEL_#,
     1291    28267                      @PTR_TO_FATHER = DML_STK_PTR_OF_FATHER);
     1292    28274    2   END BUILD_ST_ITEM;
     1293    28275        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:47   
     1294    28276    1   END;                     /*V*      MAIN      */

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:48   
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_DML.:Z8A6TOU  is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8DM$DML_UWA.

   Procedure Z8DM$DML_UWA requires 3653 words for executable code.
   Procedure Z8DM$DML_UWA requires 410 words of local(AUTO) storage.

    No errors detected in file Z8DM.:Z8A6TSI    .
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:49   

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:50   

 Object Unit name= Z8DM$DML_UWA                               File name= Z8DM.:Z8A6TOU
 UTS= AUG 09 '97 11:10:50.60 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1   DCB   even  none     0      0  M$UC
    2  LblCom even  none     1      1  ST$
    3  LblCom even  none     5      5  ST_
    4  LblCom even  none     1      1  QLT$
    5  LblCom even  none     1      1  PREV_01_QLT$
    6  LblCom even  none     5      5  QLT_
    7  LblCom even  none     1      1  LTS$
    8  LblCom even  none     5      5  LTS_
    9  LblCom even  none     1      1  DNT$
   10  LblCom even  none     5      5  DNT_
   11  LblCom even  none     1      1  DNT_BUCKET_NUMBER
   12  LblCom even  none     1      1  DNT_OF_1$
   13  LblCom even  none     1      1  ILL$
   14  LblCom even  none     5      5  ILL_
   15  LblCom even  none     1      1  HEAP$
   16  LblCom even  none     1      1  SCANNER_STATE
   17  LblCom even  none     1      1  CURRENT_BUFFER$
   18  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
   19  LblCom even  none     1      1  CURRENT_LINE_LEVEL
   20  LblCom even  none     1      1  LINE_LIST$
   21  LblCom even  none     7      7  BUFFER
   22  LblCom even  none     1      1  ORIGINAL_ISN
   23  LblCom even  none     1      1  EXPANDED_ISN
   24  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   25  LblCom even  none    90    132  LEX_SYMBOL
   26  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   27  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   28  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:51   
   29   Data  even  none    59     73  Z8DM$DML_UWA
   30  RoData even  UTS     12     14  Z8DM$DML_UWA
   31   Proc  even  none  3653   7105  Z8DM$DML_UWA
   32  RoData even  none    79    117  Z8DM$DML_UWA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    31      0   yes            yes      Std        4  Z8DM$DML_UWA

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std       0 Z9AT$TERMINATOR
         yes           Std       2 Z9DM$GET_SUB_SCHEMA
         yes           Std       3 Z8AH$NEW_DNT
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       1 Z8AR$RESERVER
 yes     yes           Std       3 Z9DM$READY_SSCHEMA
         yes           Std       1 Z8EL$START_WRITING_ES_FILE
         yes           Std       2 Z8ED$DISPOSE_HEAP
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       2 Z8DO$LINK_WITH_LTS
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:52   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  COMCOM                           r    LTS_STEP
r    ILL_STEP                              O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK                               DNT_BUCKETS

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:53   


        1        1        /*M*   Z8DM$DML_UWA -  Data division for COBOL-E DML/IDS II  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME:  Z8DM$DML_UWA
        9        9             PURPOSE:
       10       10                  Process the subschema file.
       11       11             DESCRIPTION:
       12       12                  Adds to and creates the following:  ST, DNT, QLT, LTS,
       13       13                  Reference Vector Area (RVA), Use Procedure table (USEP),
       14       14                  and the DML special registers.
       15       15        */
       16       16        /*F*
       17       17             NAME:  Z8DM$DML_UWA
       18       18             PURPOSE:
       19       19                  Process the subschema file.
       20       20             DESCRIPTION:
       21       21                  Processes the the records for the subschema depending on
       22       22                  their type.
       23       23             REFERENCE:
       24       24
       25       25
       26       26        */
       27       27        /*D*
       28       28             NAME: Z8DM$DML_UWA
       29       29             CALL:   Z8DM$DML_UWA( PRIVACY$, SCHEMA$, SUB_SCHEMA$, POINT$);
       30       30
       31       31             PARAMETERS:
       32       32                    PRIVACY$    -  LX_ITEM of the privacy key.
       33       33                    SCHEMA$     -  LX_ITEM of the schema name.
       34       34                    SUB_SCHEMA$ -  LX_ITEM of the the subschema name.
       35       35                    POINT$      -  LX_ITEM of the end of statement.
       36       36             INTERFACE:
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:54   
       37       37                    Z8AH$NEW_DNT
       38       38                    Z8AE$ERROR
       39       39                    Z8AT$CREATE_TEMPORARY
       40       40                    Z9AT$TERMINATOR
       41       41                    Z8EL$START_WRITING_ES_FILE
       42       42                    Z9AE$ISSUE_SYSTEM_ERROR
       43       43
       44       44             ENVIRONMENT:
       45       45                    None.
       46       46             INPUT:
       47       47                PRIVACY$
       48       48                SCHEMA$
       49       49                SUB_SCHEMA$
       50       50                POINT$
       51       51             OUTPUT:
       52       52                None.
       53       53
       54       54             DESCRIPTION:
       55       55                The subschema file has records which describe all of the
       56       56                data items along with Realms, Sets, and Privacy keys. It
       57       57                also has records describing the Set, Realm and Record
       58       58                relationships.  The actual source lines are also included.
       59       59                Each of these items have a type field with the following types:
       60       60
       61       61                Type 6 -  Text of line
       62       62                Type 9 -  Cobol data items
       63       63                Type 31 - Record Realm relationship
       64       64                Type 32 - Record Set relationship
       65       65                Type 33 - Record Key relationship
       66       66
       67       67                Action on the records is taken depending on the type.
       68       68                Preliminary set up of the RVA and Usep table is also
       69       69                done.
       70       70
       71       71                RVA Table  -   The RVA table contains an for each subschema
       72       72                               item referenced in the program.  If there is
       73       73                               multiple references there is only one entry.
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:55   
       74       74                               Each entry contains a type field (realm, set,
       75       75                               key, record, field, or null) and  either the
       76       76                               offset into the user work area or its internal
       77       77                               name.
       78       78
       79       79                USEP Table -   This table has two entries for each use procedure.
       80       80                               One entry tells if it is a USE for DB-EXCEPTION
       81       81                               and the status code or if it is USE for PRIVACY.
       82       82                               The entry is the address of the procedure.
       83       83
       84       84             AUTHOR:
       85       85                    Corey Nypen.
       86       86        */
       87       87        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:56   
       88       88        /*============*/
       89       89          Z8DM$DML_UWA :  PROC(PRIVACY$, SCHEMA$, SUB_SCHEMA$, POINT$);

     89 31 000000   000000 700200 xent  Z8DM$DML_UWA TSX0  ! X66_AUTO_4
        31 000001   000632 000004                    ZERO    410,4

       90       90        /*============*/
       91       91
       92       92    1   DCL PRIVACY$    PTR;
       93       93    1   DCL SCHEMA$     PTR;
       94       94    1   DCL SUB_SCHEMA$ PTR;
       95       95    1   DCL POINT$      PTR;
       96       96
       97       97        %SET PHASE = 1;
       98       98        %INCLUDE Z8A_DEFC;
       99      166        %INCLUDE Z8A_SYS_FILE;
      100     6441        %INCLUDE Z8A_SUPP_MAC;
      101     8841        %INCLUDE Z8A_COMCOM;
      102     9491        %INCLUDE Z8A_ST;
      103    13150        %INCLUDE Z8A_QLT;
      104    13256        %INCLUDE Z8A_LTS;
      105    15333        %INCLUDE Z8A_TYPES;
      106    15507        %INCLUDE Z8A_DNT;
      107    15728        %INCLUDE Z8A_ERR_NUMS;
      108    16492        %INCLUDE Z8A_ILL;
      109    17185        %INCLUDE Z8E_MACROS;
      110    17860        %INCLUDE Z8E_HEAP;
      111    17916        %INCLUDE Z8E_DML;
      112    18036        %INCLUDE Z8E_BUFFERS;
      113    18226        %SET EMPTY = 0;
      114    18227        %INCLUDE Z8E_STACKS;
      115    20493        %INCLUDE Z8E_O1COM;
      116    21254        %INCLUDE Z8E_STATEMNT;
      117    21323
      118    21324            %DEF_BUCKETS;
      119    21327
      120    21328    1       DCL     RETURN_PTR$     PTR;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:57   
      121    21329    1       DCL     NEW_QLT$        PTR;
      122    21330    1       DCL     PREVIOUS_BRO_QLT$ PTR;
      123    21331    1       DCL     RETURN$         PTR;
      124    21332    1       DCL     HEAD_UWA_QLT$   PTR;
      125    21333    1       DCL     NEW_DNT$        PTR;
      126    21334    1       DCL     NEW_DNT$$       PTR;
      127    21335    1       DCL     NEW_LTS$        PTR;
      128    21336    1       DCL     NEW_LONG$       PTR;
      129    21337    1       DCL     CURRENT_PTR$    PTR;
      130    21338    1       DCL     CURRENT_LTS$    PTR;
      131    21339    1       DCL     HEAD$           PTR;
      132    21340
      133    21341    1       DCL     TYPE            UBIN HALF;
      134    21342    1       DCL     CLASS_          UBIN (3);
      135    21343    1       DCL     DML_TYPE        UBIN (3);
      136    21344    1       DCL     LEVEL_#         UBIN;
      137    21345    1       DCL     NEXT_LEVEL      UBIN WORD;
      138    21346    1       DCL     NAME_X          CHAR(6);
      139    21347    1       DCL     01   UWA_NAME   REDEF NAME_X,
      140    21348    1                  02  FIRST    CHAR(2) UNAL,
      141    21349    1                  02  LAST     CHAR(4) UNAL;
      142    21350    1       DCL     DML_STK_PTR    UBIN WORD;
      143    21351    1       DCL     DML_STK_PTR_OF_FATHER   UBIN WORD;
      144    21352    1       DCL     DML_ID          UBIN(18);
      145    21353    1       DCL     INDEXED_REALM   BIT(1);
      146    21354    1       DCL     REALM_NO        UBIN;
      147    21355    1       DCL     SA              UBIN HALF;
      148    21356    1       DCL     WORD_OFFSET     UBIN HALF;
      149    21357    1       DCL     MEMBERSHIP      BIT(2);
      150    21358    1       DCL     I               SBIN(18);
      151    21359    1       DCL     J               UBIN;
      152    21360    1       DCL     K               UBIN;
      153    21361    1       DCL     START_LEVEL_# (0:49)   UBIN(9);
      154    21362    1       DCL     LENGTH          BOOLEAN;
      155    21363    1       DCL     P_BIT           BOOLEAN;
      156    21364    1       DCL     NEED_DUMMY_BUF  BOOLEAN STATIC INIT (FALSE);
      157    21365
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:58   
      158    21366    1       DCL     Z8AH$NEW_DNT                ENTRY(3);
      159    21367    1       DCL     Z8AE$ERROR                  ENTRY(12);
      160    21368    1       DCL     Z8AT$CREATE_TEMPORARY       ENTRY(2);
      161    21369    1       DCL     Z9AT$TERMINATOR             ENTRY;
      162    21370    1       DCL     Z8EL$START_WRITING_ES_FILE  ENTRY(1);
      163    21371    1       DCL     Z9DM$READY_SSCHEMA          ENTRY(3) ALTRET;
      164    21372    1       DCL     Z9DM$GET_SUB_SCHEMA         ENTRY(2);
      165    21373
      166    21374    1       DCL     FOUND           BOOLEAN;
      167    21375    1          DCL  1  CONTROL_SEG  BASED(RETURN_PTR$)  ALIGNED,
      168    21376    1                  2  * (0:41)          SBIN WORD UNAL,
      169    21377    1                  2  TIME_DATE         CHAR(8) UNAL,
      170    21378    1                  2  * (0:19)          SBIN WORD UNAL;
      171    21379
      172    21380        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:59   
      173    21381    1       DCL     1   DESC,
      174    21382    1                   2   DESCL      UBIN HALF UNAL,
      175    21383    1                   2   ALPHA_ADSC       REDEF DESCL,
      176    21384    1                       3   CN              UBIN(2) UNAL,
      177    21385    1                       3   MBZ1            BIT(1)  UNAL,
      178    21386    1                       3   TA              BIT(2)  UNAL,
      179    21387    1                       3   MBZ2            BIT(1)  UNAL,
      180    21388    1                       3   N               UBIN(12) UNAL,
      181    21389
      182    21390    1                   2   NUM_NDSC       REDEF DESCL,
      183    21391    1                       3   CN              UBIN(3)  UNAL,
      184    21392    1                       3   TN              BIT(1)   UNAL,
      185    21393    1                       3   S               BIT(2)   UNAL,
      186    21394    1                       3   SF              SBIN(6)  UNAL,
      187    21395    1                       3   N               UBIN(6)  UNAL;
      188    21396
      189    21397    1       DCL     1   RECORD_INFO,
      190    21398    1                   2   LOCATION_CALC       BIT(1)    UNAL;
      191    21399                /*      2   PARTIAL_RECORD      BIT(1)    UNAL,
      192    21400                        2   STORE_NOT_PER       BIT(1)    UNAL,
      193    21401                        2   MODIFY_ONLY         BIT(1)    UNAL,
      194    21402                        2   ALL_CALC_PRES       BIT(1)    UNAL,
      195    21403                        2   ERASE_ALL_NOT_PER   BIT(1)    UNAL,
      196    21404                        2   ERASE_NOT_PER       BIT(1)    UNAL;     */
      197    21405
      198    21406    1       DCL     REGISTER_NAME (0:7)   CHAR(17) STATIC INIT ('DB-STATUS',
      199    21407    1               'DB-SET-NAME','DB-REALM-NAME','DB-PRIVACY-KEY',
      200    21408    1         'DB-RECORD-NAME','DB-DATA-NAME','DB-KEY-NAME','DIRECT-REFERENCE');
      201    21409
      202    21410    1       DCL     REGISTER_OFFSET (0:7)  UBIN HALF STATIC INIT
      203    21411    1                   (4,44,12,108,76,124,156,120);
      204    21412
      205    21413    1       DCL     NAME_LENGTH (0:7)  SBIN STATIC INIT(9,11,13,14,14,12,11,16);
      206    21414
      207    21415    1       DCL     REGISTER_LENGTH (0:7)  UBIN HALF STATIC INIT
      208    21416    1                   (7,30,30,12,30,30,30,4);
      209    21417    1       DCL     NAME  CHAR(30);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:60   
      210    21418
      211    21419    1       DCL 1 DML_STK(0:99),
      212    21420    1             2 QLT$    PTR  UNAL,
      213    21421    1             2 LEVEL_# UBIN WORD,
      214    21422    1             2 FATHER  UBIN WORD;
      215    21423        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:61   
      216    21424        /*V*
      217    21425                The type 9 token is the major token or record returned from
      218    21426                GET_SUB_SCHEMA.  It describes the subschema items.
      219    21427        */
      220    21428    1       DCL  1  TOKEN_9     BASED(RETURN_PTR$)  ALIGNED,
      221    21429    1               2   SIZE_OF_DESCRIPTOR      UBIN WORD  UNAL,   /*V*   0  */
      222    21430    1               2   LINE_NUMBER             UBIN WORD  UNAL,   /*V*   1  */
      223    21431    1               2   COLUMN                  UBIN WORD  UNAL,   /*V*   2  */
      224    21432    1               2   TYPE                    UBIN WORD  UNAL,   /*V*   3  */
      225    21433    1               2   WORD_4                  UBIN WORD  UNAL,   /*V*   4  */
      226    21434    1               2   WORD4                   REDEF WORD_4,      /*V*   4  */
      227    21435    1                   3  BIT0                 BIT(1)     UNAL,
      228    21436    1                   3  BIT1                 BIT(1)     UNAL,
      229    21437    1                   3  BIT2                 BIT(1)     UNAL,
      230    21438    1                   3  BIT3                 BIT(1)     UNAL,
      231    21439    1                   3  BIT4                 BIT(1)     UNAL,
      232    21440    1                   3  *  (0:30)            BIT(1)     UNAL,
      233    21441    1               2   * (0:2)                 UBIN WORD  UNAL,  /*V*  5-7 */
      234    21442    1               2   BIB,                                      /*V*   8  */
      235    21443    1                   3 * (0:18)              BOOLEAN,          /*V* BIT 0-18 */
      236    21444    1                   3  REALM                BOOLEAN,          /*V* BIT 19 */
      237    21445    1                   3  SET                  BOOLEAN,          /*V* BIT 20 */
      238    21446    1                   3  RECORD               BOOLEAN,          /*V* BIT 21 */
      239    21447    1                   3  FIELD                BOOLEAN,          /*V* BIT 22 */
      240    21448    1                   3  PRIVACY_KEY          BOOLEAN,          /*V* BIT 23 */
      241    21449    1                   3  USER_WORK_AREA       BOOLEAN,          /*V* BIT 24 */
      242    21450    1                   3  KEY                  BOOLEAN,          /*V* BIT 25 */
      243    21451    1                   3  NOT_IN_SCHEMA        BOOLEAN,          /*V* BIT 26 */
      244    21452    1                   3  DB_KEY               BOOLEAN,          /*V* BIT 27 */
      245    21453    1                   3  COMP_11              BOOLEAN,          /*V* BIT 28 */
      246    21454    1                   3  COMP_12              BOOLEAN,          /*V* BIT 29 */
      247    21455    1                   3  BIT30                BOOLEAN,          /*V* BIT 30 */
      248    21456    1                   3  BIT31                BOOLEAN,          /*V* BIT 31 */
      249    21457    1                   3  BIT32                BOOLEAN,          /*V* BIT 32 */
      250    21458    1                   3  BIT33                BOOLEAN,          /*V* BIT 33 */
      251    21459    1                   3  BIT34                BOOLEAN,          /*V* BIT 34 */
      252    21460    1                   3  BIT35                BOOLEAN,          /*V* BIT 35 */
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:62   
      253    21461    1               2   *                       UBIN WORD  UNAL,  /*V*   9    */
      254    21462    1               2   LEVEL_NUMBER            UBIN WORD  UNAL,  /*V*   10   */
      255    21463    1               2   * (0:2)                 UBIN WORD  UNAL,  /*V* 11-13 */
      256    21464    1               2   LENGTH                  UBIN WORD UNAL,     /*V*  14  */
      257    21465    1               2   LTDP                    UBIN WORD  UNAL,  /*V*   15  */
      258    21466    1               2   RTDP                    UBIN WORD  UNAL,  /*V*   16  */
      259    21467    1               2   SIB,                                      /*V* 17-18 */
      260    21468    1                   3 * (0:5)               BOOLEAN,  /*V* 0-5 */
      261    21469    1                   3 ITEM_NOT_RECORD       BOOLEAN,  /*V*  6  */
      262    21470    1                   3 ENTRY_01              BOOLEAN,  /*V*  7  */
      263    21471    1                   3 *                     BOOLEAN,  /*V* 8    */
      264    21472    1                   3 ELEMENTARY            BOOLEAN,  /*V*  9  */
      265    21473    1                   3 * (0:6)               BOOLEAN,  /*V* 10-16 */
      266    21474    1                   3 NUMERIC               BOOLEAN,  /*V*  17 */
      267    21475    1                   3 *                     BOOLEAN,  /*V*  18 */
      268    21476    1                   3 ALPHANUMERIC          BOOLEAN,  /*V*  19 */
      269    21477    1                   3 *                     BOOLEAN,  /*V*  20 */
      270    21478    1                   3 ALPHABETIC            BOOLEAN,  /*V*  21 */
      271    21479    1                   3 *                     BOOLEAN,  /*V*  22 */
      272    21480    1                   3 PIC_WITH_P            BOOLEAN,  /*V*  23 */
      273    21481    1                   3 *                     BOOLEAN,  /*V*  24 */
      274    21482    1                   3 PIC_WITH_S            BOOLEAN,  /*V*  25 */
      275    21483    1                   3 USAGE_DISPLAY_SEP_SIGN BOOLEAN, /*V*  26 */
      276    21484    1                   3 DISPLAY               BOOLEAN,  /*V*  27 */
      277    21485    1                   3 COMP                  BOOLEAN,  /*V*  28 */
      278    21486    1                   3 COMP_1                BOOLEAN,  /*V*  29 */
      279    21487    1                   3 COMP_2                BOOLEAN,  /*V*  30 */
      280    21488    1                   3 COMP_3                BOOLEAN,  /*V*  31 */
      281    21489    1                   3 *                     BOOLEAN,  /*V*  32 */
      282    21490    1                   3 COMP_6                BOOLEAN,  /*V*  33 */
      283    21491    1                   3 *                     BOOLEAN,  /*V*  34 */
      284    21492    1                   3 JUSTIFIED             BOOLEAN,  /*V*  35 */
      285    21493    1                   3 COMP_4                BOOLEAN,  /*V*  36 */
      286    21494    1                   3 SYNCH                 BOOLEAN,  /*V*  37 */
      287    21495    1                   3 * (0:10)              BOOLEAN,  /*V* 38-48 */
      288    21496    1                   3 SIGN                  UBIN(3)    UNAL,  /*V* 49-51 */
      289    21497    1                   3 * (0:14)              BOOLEAN,  /*V* 52-66 */
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:63   
      290    21498    1                   3 FLOAT_BIT             BOOLEAN,  /*V* 67    */
      291    21499    1                   3 * (0:3)               BOOLEAN,  /*V* 68-71 */
      292    21500    1               2   RPT_CODE                UBIN WORD  UNAL,  /*V*  19  */
      293    21501    1               2   OFFSET                  UBIN WORD  UNAL,  /*V*  20  */
      294    21502    1               2   * (0:1)                 UBIN WORD  UNAL,  /*V* 21-22 */
      295    21503    1               2   NAME_SIZE               UBIN WORD  UNAL,  /*V*  23  */
      296    21504    1               2   DATA_ITEM_NAME          CHAR(TOKEN_9.NAME_SIZE) UNAL;
      297    21505
      298    21506    1       DCL IA_TIME_DATE    CHAR(8);
      299    21507         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:64   
      300    21508        %MACRO UPDATE_DML_STK( @HEAD = ,
      301    21509                               @LEVEL# = ,
      302    21510                               @QLT$ = ,
      303    21511                               @PTR_TO_FATHER = );
      304    21512            DO;
      305    21513                DML_STK.QLT$(@HEAD) = @QLT$;
      306    21514                DML_STK.LEVEL_#(@HEAD) = @LEVEL#;
      307    21515                DML_STK.FATHER(@HEAD) = @PTR_TO_FATHER;
      308    21516            END;
      309    21517        %MEND;
      310    21518        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:65   
      311    21519    1   IF COMCOM.IDS_SUB_SCHEMA                         THEN

  21519 31 000002   000477 234000 xsym               SZN     COMCOM+319
        31 000003   000021 605000 31                 TPL     s:21525

      312    21520    2     DO;

      313    21521    2      CALL Z8AE$ERROR(%E$DUPLICATE_SUB_SCHEMA_SECTION,POINT$ -> LX_ITEM.LINE,POINT$ ->
             21521                LX_ITEM.COLUMN);

  21521 31 000004   200006 470500                    LDP0    @POINT$,,AUTO
        31 000005   000000 471500                    LDP1    0,,PR0
        31 000006   100006 633500                    EPPR3   6,,PR1
        31 000007   200626 453500                    STP3    LINE_NUMBER+3,,AUTO
        31 000010   100005 634500                    EPPR4   5,,PR1
        31 000011   200625 454500                    STP4    LINE_NUMBER+2,,AUTO
        31 000012   000002 236000 32                 LDQ     2
        31 000013   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 000014   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000015   000000 631400 32                 EPPR1   0
        31 000016   000000 701000 xent               TSX1    Z8AE$ERROR
        31 000017   000000 011000                    NOP     0

      314    21522    2       RETURN;

  21522 31 000020   000000 702200 xent               TSX2  ! X66_ARET

      315    21523    2     END;
      316    21524
      317    21525    1   IF PRIVACY$ -> LX_ITEM.SYMBOL ~= %EMPTY    THEN

  21525 31 000021   200003 470500                    LDP0    @PRIVACY$,,AUTO
        31 000022   000000 471500                    LDP1    0,,PR0
        31 000023   100003 235100                    LDA     3,,PR1
        31 000024   000055 600000 31                 TZE     s:21537

      318    21526    2     DO;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:66   

      319    21527    2       IF PRIVACY$ -> LX_ITEM.DNT$ -> DNT.TEXT.LENGTH > 14  THEN

  21527 31 000025   100002 473500                    LDP3    2,,PR1
        31 000026   300004 220100                    LDX0    4,,PR3
        31 000027   000017 100003                    CMPX0   15,DU
        31 000030   000046 602000 31                 TNC     s:21534

      320    21528    3         DO;

      321    21529    3           PRIVACY$ -> LX_ITEM.DNT$ -> DNT.TEXT.LENGTH = 14;

  21529 31 000031   000016 221003                    LDX1    14,DU
        31 000032   300004 741100                    STX1    4,,PR3

      322    21530    3           CALL Z8AE$ERROR(%E$PRIVACY_KEY_TO_LONG,

  21530 31 000033   000000 471500                    LDP1    0,,PR0
        31 000034   100006 633500                    EPPR3   6,,PR1
        31 000035   200626 453500                    STP3    LINE_NUMBER+3,,AUTO
        31 000036   100005 634500                    EPPR4   5,,PR1
        31 000037   200625 454500                    STP4    LINE_NUMBER+2,,AUTO
        31 000040   000004 236000 32                 LDQ     4
        31 000041   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 000042   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000043   000000 631400 32                 EPPR1   0
        31 000044   000000 701000 xent               TSX1    Z8AE$ERROR
        31 000045   000000 011000                    NOP     0

      323    21531    3                           PRIVACY$ -> LX_ITEM.LINE,
      324    21532    3                           PRIVACY$ -> LX_ITEM.COLUMN);
      325    21533    3         END;

      326    21534    2       COMCOM.PRIVACY_LINE = PRIVACY$ -> LX_ITEM.LINE;

  21534 31 000046   200003 470500                    LDP0    @PRIVACY$,,AUTO
        31 000047   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:67   
        31 000050   100005 235100                    LDA     5,,PR1
        31 000051   000447 755000 xsym               STA     COMCOM+295

      327    21535    2       COMCOM.PRIVACY_COL = PRIVACY$ -> LX_ITEM.COLUMN;

  21535 31 000052   000000 471500                    LDP1    0,,PR0
        31 000053   100006 235100                    LDA     6,,PR1
        31 000054   000450 755000 xsym               STA     COMCOM+296

      328    21536    2     END;

      329    21537    1   IF SCHEMA$ -> LX_ITEM.B.ERROR  OR SUB_SCHEMA$ -> LX_ITEM.B.ERROR  THEN

  21537 31 000055   200004 471500                    LDP1    @SCHEMA$,,AUTO
        31 000056   100000 473500                    LDP3    0,,PR1
        31 000057   300000 236100                    LDQ     0,,PR3
        31 000060   400000 316007                    CANQ    -131072,DL
        31 000061   000067 601000 31                 TNZ     s:21539
        31 000062   200005 474500                    LDP4    @SUB_SCHEMA$,,AUTO
        31 000063   400000 475500                    LDP5    0,,PR4
        31 000064   500000 236100                    LDQ     0,,PR5
        31 000065   400000 316007                    CANQ    -131072,DL
        31 000066   000076 600000 31                 TZE     s:21544

      330    21538    2     DO;

      331    21539    2       CALL Z8AE$ERROR(%E$SCHEMA_SUB_SCHEMA_ERROR);

  21539 31 000067   000007 630400 32                 EPPR0   7
        31 000070   000005 631400 32                 EPPR1   5
        31 000071   000000 701000 xent               TSX1    Z8AE$ERROR
        31 000072   000000 011000                    NOP     0

      332    21540    2       CALL Z9AT$TERMINATOR;

  21540 31 000073   000010 631400 32                 EPPR1   8
        31 000074   000000 701000 xent               TSX1    Z9AT$TERMINATOR
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:68   
        31 000075   000000 011000                    NOP     0

      333    21541    2     END;

      334    21542
      335    21543
      336    21544    1   CALL Z9DM$READY_SSCHEMA( SCHEMA$, SUB_SCHEMA$, PRIVACY$ )

  21544 31 000076   200003 236100                    LDQ     @PRIVACY$,,AUTO
        31 000077   200626 756100                    STQ     LINE_NUMBER+3,,AUTO
        31 000100   200004 237100                    LDAQ    @SCHEMA$,,AUTO
        31 000101   200624 757100                    STAQ    LINE_NUMBER+1,,AUTO
        31 000102   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000103   000000 631400 32                 EPPR1   0
        31 000104   000000 701000 xent               TSX1    Z9DM$READY_SSCHEMA
        31 000105   000107 702000 31                 TSX2    s:21547
        31 000106   000116 710000 31                 TRA     s:21551

      337    21545    1     WHENALTRETURN
      338    21546    2     DO;

      339    21547    2       CALL Z8AE$ERROR(%E$SCHEMA_SUB_SCHEMA_ERROR);

  21547 31 000107   000007 630400 32                 EPPR0   7
        31 000110   000005 631400 32                 EPPR1   5
        31 000111   000000 701000 xent               TSX1    Z8AE$ERROR
        31 000112   000000 011000                    NOP     0

      340    21548    2       CALL Z9AT$TERMINATOR;

  21548 31 000113   000010 631400 32                 EPPR1   8
        31 000114   000000 701000 xent               TSX1    Z9AT$TERMINATOR
        31 000115   000000 011000                    NOP     0

      341    21549    2     END;

      342    21550
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:69   
      343    21551    1   CALL Z9DM$GET_SUB_SCHEMA( RETURN_PTR$ );

  21551 31 000116   200007 630500                    EPPR0   RETURN_PTR$,,AUTO
        31 000117   200624 450500                    STP0    LINE_NUMBER+1,,AUTO
        31 000120   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000121   000005 631400 32                 EPPR1   5
        31 000122   000000 701000 xent               TSX1    Z9DM$GET_SUB_SCHEMA
        31 000123   000000 011000                    NOP     0

      344    21552
      345    21553    1   O1COM.SECTION_FOUND.SUB_SCHEMA = TRUE;

  21553 31 000124   010000 236003                    LDQ     4096,DU
        31 000125   000063 256000 xsym               ORSQ    O1COM+51

      346    21554    1   COMCOM.IDS_SUB_SCHEMA = TRUE;

  21554 31 000126   400000 236003                    LDQ     -131072,DU
        31 000127   000477 756000 xsym               STQ     COMCOM+319

      347    21555    1   IA_TIME_DATE = CONTROL_SEG.TIME_DATE;

  21555 31 000130   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 000131   040100 100500                    MLR     fill='040'O
        31 000132   000052 000010                    ADSC9   42,,PR0                  cn=0,n=8
        31 000133   200620 000010                    ADSC9   IA_TIME_DATE,,AUTO       cn=0,n=8

      348    21556    1   UWA_NAME.LAST = SUBSTR(SUB_SCHEMA$ -> LX_ITEM.DNT$->DNT.TEXT.NAME,0,4);

  21556 31 000134   200005 471500                    LDP1    @SUB_SCHEMA$,,AUTO
        31 000135   100000 473500                    LDP3    0,,PR1
        31 000136   300002 474500                    LDP4    2,,PR3
        31 000137   400004 220100                    LDX0    4,,PR4
        31 000140   040100 100500                    MLR     fill='040'O
        31 000141   400004 400004                    ADSC9   4,,PR4                   cn=2,n=4
        31 000142   200030 400004                    ADSC9   NAME_X,,AUTO             cn=2,n=4

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:70   
      349    21557    1   UWA_NAME.FIRST = 'U.';

  21557 31 000143   000000 220000 30                 LDX0    0
        31 000144   200030 740100                    STX0    NAME_X,,AUTO

      350    21558
      351    21559    1   CALL Z8AH$NEW_DNT(UWA_NAME,6,NEW_DNT$);

  21559 31 000145   200014 633500                    EPPR3   NEW_DNT$,,AUTO
        31 000146   200626 453500                    STP3    LINE_NUMBER+3,,AUTO
        31 000147   000012 236000 32                 LDQ     10
        31 000150   200625 756100                    STQ     LINE_NUMBER+2,,AUTO
        31 000151   200030 634500                    EPPR4   NAME_X,,AUTO
        31 000152   200624 454500                    STP4    LINE_NUMBER+1,,AUTO
        31 000153   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000154   000000 631400 32                 EPPR1   0
        31 000155   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 000156   000000 011000                    NOP     0

      352    21560
      353    21561    1   IF NEW_DNT$ -> DNT.ST$ = ADDR(NIL)    THEN

  21561 31 000157   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 000160   000001 236100                    LDQ     1,,PR0
        31 000161   000013 116000 32                 CMPQ    11
        31 000162   000303 601000 31                 TNZ     s:21645

      354    21562    2     DO;

      355    21563
      356    21564            %NEW_BLOCK ( @ST$   = O1COM.DML_UWA$,
      357    21565                         @DNT$  = NEW_DNT$,
      358    21566                         @SIZE  = TOKEN_9.WORD_4);

  21570 31 000163   000002 236000 3                  LDQ     ST_+2
        31 000164   000013 036007                    ADLQ    11,DL
        31 000165   000003 116000 3                  CMPQ    ST_+3
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:71   
        31 000166   000177 604000 31                 TMI     s:21572

  21571 31 000167   000014 236000 32                 LDQ     12
        31 000170   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 000171   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 000172   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 000173   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 000174   000005 631400 32                 EPPR1   5
        31 000175   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 000176   000000 011000                    NOP     0

  21572 31 000177   000002 236000 3                  LDQ     ST_+2
        31 000200   000022 736000                    QLS     18
        31 000201   000001 036000 3                  ADLQ    ST_+1
        31 000202   000077 756000 xsym               STQ     O1COM+63

  21573 31 000203   000013 236007                    LDQ     11,DL
        31 000204   000002 056000 3                  ASQ     ST_+2

  21577 31 000205   000144 054000 xsym               AOS     COMCOM+100

  21578 31 000206   000077 470400 xsym               LDP0    O1COM+63
        31 000207   000144 236000 xsym               LDQ     COMCOM+100
        31 000210   000000 552104                    STBQ    0,'04'O,PR0

  21580 31 000211   000077 236000 xsym               LDQ     O1COM+63
        31 000212   000004 470400 xsym               LDP0    O1COM+4
        31 000213   000004 756100                    STQ     4,,PR0

  21581 31 000214   000077 236000 xsym               LDQ     O1COM+63
        31 000215   000004 756000 xsym               STQ     O1COM+4

  21586 31 000216   000774 220003                    LDX0    508,DU
        31 000217   000077 470400 xsym               LDP0    O1COM+63
        31 000220   000000 740100                    STX0    0,,PR0

  21587 31 000221   000077 470400 xsym               LDP0    O1COM+63
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:72   
        31 000222   003000 236007                    LDQ     1536,DL
        31 000223   000000 552110                    STBQ    0,'10'O,PR0

  21588 31 000224   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 000225   000004 721100                    LXL1    4,,PR0
        31 000226   000077 471400 xsym               LDP1    O1COM+63
        31 000227   100002 741100                    STX1    2,,PR1

  21589 31 000230   000133 721000 xsym               LXL1    COMCOM+91
        31 000231   000077 470400 xsym               LDP0    O1COM+63
        31 000232   000002 441100                    SXL1    2,,PR0

  21590 31 000233   000077 470400 xsym               LDP0    O1COM+63
        31 000234   000003 450100                    STZ     3,,PR0

  21591 31 000235   000013 236000 32                 LDQ     11
        31 000236   000077 470400 xsym               LDP0    O1COM+63
        31 000237   000004 756100                    STQ     4,,PR0

  21592 31 000240   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 000241   000077 470400 xsym               LDP0    O1COM+63
        31 000242   000006 756100                    STQ     6,,PR0

  21593 31 000243   000013 236000 32                 LDQ     11
        31 000244   000077 470400 xsym               LDP0    O1COM+63
        31 000245   000007 756100                    STQ     7,,PR0

  21603 31 000246   000013 236000 32                 LDQ     11
        31 000247   000077 470400 xsym               LDP0    O1COM+63
        31 000250   000012 756100                    STQ     10,,PR0

  21606 31 000251   000057 236000 xsym               LDQ     O1COM+47
        31 000252   000077 470400 xsym               LDP0    O1COM+63
        31 000253   000011 756100                    STQ     9,,PR0

  21607 31 000254   000057 236000 xsym               LDQ     O1COM+47
        31 000255   000013 116000 32                 CMPQ    11
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:73   
        31 000256   000304 600000 31                 TZE     s:21647

  21611 31 000257   000057 470400 xsym               LDP0    O1COM+47
        31 000260   000001 471500                    LDP1    1,,PR0
        31 000261   100012 236100                    LDQ     10,,PR1
        31 000262   000013 116000 32                 CMPQ    11
        31 000263   000273 601000 31                 TNZ     s:21618

  21613 31 000264   000077 236000 xsym               LDQ     O1COM+63
        31 000265   100011 756100                    STQ     9,,PR1

  21614 31 000266   000057 470400 xsym               LDP0    O1COM+47
        31 000267   000001 471500                    LDP1    1,,PR0
        31 000270   000077 236000 xsym               LDQ     O1COM+63
        31 000271   100012 756100                    STQ     10,,PR1

  21615 31 000272   000304 710000 31                 TRA     s:21647

  21618 31 000273   100012 473500                    LDP3    10,,PR1
        31 000274   000077 236000 xsym               LDQ     O1COM+63
        31 000275   300012 756100                    STQ     10,,PR3

  21619 31 000276   000057 470400 xsym               LDP0    O1COM+47
        31 000277   000001 471500                    LDP1    1,,PR0
        31 000300   000077 236000 xsym               LDQ     O1COM+63
        31 000301   100012 756100                    STQ     10,,PR1

      359    21643    2     END;

  21643 31 000302   000304 710000 31                 TRA     s:21647

      360    21644    1   ELSE
      361    21645    1      O1COM.DML_UWA$ = NEW_DNT$ -> DNT.ST$;

  21645 31 000303   000077 756000 xsym               STQ     O1COM+63

      362    21646
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:74   
      363    21647    1   NEW_DNT$ -> DNT.ST$ = O1COM.DML_UWA$;

  21647 31 000304   000077 236000 xsym               LDQ     O1COM+63
        31 000305   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 000306   000001 756100                    STQ     1,,PR0

      364    21648
      365    21649    1   IF TOKEN_9.WORD_4 > %#256K   THEN

  21649 31 000307   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 000310   000004 235100                    LDA     4,,PR0
        31 000311   000015 115000 32                 CMPA    13
        31 000312   000334 602000 31                 TNC     s:21657

      366    21650    2     DO;

      367    21651    2       CALL Z8AE$ERROR(%E$BLOCK_DATA_LIMIT,,,O1COM.DML_UWA$ -> BLOCK.DNT$);

  21651 31 000313   000077 236000 xsym               LDQ     O1COM+63
        31 000314   000006 036003                    ADLQ    6,DU
        31 000315   000013 235000 32                 LDA     11
        31 000316   200626 757100                    STAQ    LINE_NUMBER+3,,AUTO
        31 000317   000013 236000 32                 LDQ     11
        31 000320   000020 235000 32                 LDA     16
        31 000321   200624 757100                    STAQ    LINE_NUMBER+1,,AUTO
        31 000322   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000323   000016 631400 32                 EPPR1   14
        31 000324   000000 701000 xent               TSX1    Z8AE$ERROR
        31 000325   000000 011000                    NOP     0

      368    21652    2       COMCOM.DATA_LIMIT_ERROR_FLAGGED = TRUE;

  21652 31 000326   400000 236003                    LDQ     -131072,DU
        31 000327   000506 756000 xsym               STQ     COMCOM+326

      369    21653    2       COMCOM.OB.CHECK = '1'B;                 /*V* AVOID PHASE 5 ERROR */

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:75   
  21653 31 000330   000072 256000 xsym               ORSQ    COMCOM+58

      370    21654    2       O1COM.DML_UWA$ -> BLOCK.SIZE = 0;

  21654 31 000331   000000 220003                    LDX0    0,DU
        31 000332   000077 470400 xsym               LDP0    O1COM+63
        31 000333   000002 740100                    STX0    2,,PR0

      371    21655    2     END;

      372    21656
      373    21657    1   HEAD_UWA_QLT$ = ADDR(NIL);

  21657 31 000334   000013 236000 32                 LDQ     11
        31 000335   200013 756100                    STQ     HEAD_UWA_QLT$,,AUTO

      374    21658
      375    21659    1   CALL Z8EL$START_WRITING_ES_FILE(POINT$ -> LX_ITEM.LINE);

  21659 31 000336   200006 470500                    LDP0    @POINT$,,AUTO
        31 000337   000000 471500                    LDP1    0,,PR0
        31 000340   100005 633500                    EPPR3   5,,PR1
        31 000341   200624 453500                    STP3    LINE_NUMBER+1,,AUTO
        31 000342   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000343   000005 631400 32                 EPPR1   5
        31 000344   000000 701000 xent               TSX1    Z8EL$START_WRITING_ES_FILE
        31 000345   000000 011000                    NOP     0

      376    21660
      377    21661    1   HEAD$ = LINE_LIST$;

  21661 31 000346   000000 236000 20                 LDQ     LINE_LIST$
        31 000347   200022 756100                    STQ     HEAD$,,AUTO

      378    21662    1   IF HEAD$ -> FILL_BUFFER.ISN > POINT$ -> LX_ITEM.LINE THEN

  21662 31 000350   200006 470500                    LDP0    @POINT$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:76   
        31 000351   000000 471500                    LDP1    0,,PR0
        31 000352   200022 473500                    LDP3    HEAD$,,AUTO
        31 000353   100005 236100                    LDQ     5,,PR1
        31 000354   000402 604000 31                 TMI     s:21674
        31 000355   300004 116100                    CMPQ    4,,PR3
        31 000356   000402 605000 31                 TPL     s:21674

      379    21663    2     DO; /* E.g., next statement is COPY */

      380    21664    2       NEED_DUMMY_BUF = TRUE; /* Subschema must come before this line */

  21664 31 000357   400000 236003                    LDQ     -131072,DU
        31 000360   000000 756000 29                 STQ     NEED_DUMMY_BUF

      381    21665            %NEW_HEAP (@POINTER = HEAD$, @SIZE = %MAX_INPUT_BUFFER_LEN);

  21667 31 000361   000023 236000 32                 LDQ     19
        31 000362   200625 756100                    STQ     LINE_NUMBER+2,,AUTO
        31 000363   200022 631500                    EPPR1   HEAD$,,AUTO
        31 000364   200624 451500                    STP1    LINE_NUMBER+1,,AUTO
        31 000365   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000366   000021 631400 32                 EPPR1   17
        31 000367   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        31 000370   000000 011000                    NOP     0

      382    21670    2       HEAD$ -> FILL_BUFFER.NEXT$ = LINE_LIST$;

  21670 31 000371   000000 236000 20                 LDQ     LINE_LIST$
        31 000372   200022 470500                    LDP0    HEAD$,,AUTO
        31 000373   000002 756100                    STQ     2,,PR0

      383    21671    2       HEAD$ -> FILL_BUFFER.ISN = LINE_LIST$ -> FILL_BUFFER.ISN - 1;

  21671 31 000374   000000 470400 20                 LDP0    LINE_LIST$
        31 000375   200022 471500                    LDP1    HEAD$,,AUTO
        31 000376   000004 235100                    LDA     4,,PR0
        31 000377   000001 135007                    SBLA    1,DL
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:77   
        31 000400   100004 755100                    STA     4,,PR1

      384    21672    2     END;

  21672 31 000401   000420 710000 31                 TRA     s:21681

      385    21673    1   ELSE
      386    21674    2   DO WHILE HEAD$ -> FILL_BUFFER.ISN ~= POINT$ -> LX_ITEM.LINE;

  21674 31 000402   000000 116003                    CMPQ    0,DU
        31 000403   000406 604000 31                 TMI     s:21676
        31 000404   300004 116100                    CMPQ    4,,PR3
        31 000405   000420 600000 31                 TZE     s:21681

      387    21675
      388    21676    2       HEAD$ = HEAD$ -> FILL_BUFFER.NEXT$;

  21676 31 000406   200022 470500                    LDP0    HEAD$,,AUTO
        31 000407   000002 236100                    LDQ     2,,PR0
        31 000410   200022 756100                    STQ     HEAD$,,AUTO

      389    21677
      390    21678    2   END;

  21678 31 000411   200006 470500                    LDP0    @POINT$,,AUTO
        31 000412   000000 471500                    LDP1    0,,PR0
        31 000413   200022 473500                    LDP3    HEAD$,,AUTO
        31 000414   300004 236100                    LDQ     4,,PR3
        31 000415   000406 604000 31                 TMI     s:21676
        31 000416   100005 116100                    CMPQ    5,,PR1
        31 000417   000406 601000 31                 TNZ     s:21676

      391    21679
      392    21680        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:78   
      393    21681    1   CALL Z9DM$GET_SUB_SCHEMA( RETURN_PTR$, HEAD$ );

  21681 31 000420   200022 630500                    EPPR0   HEAD$,,AUTO
        31 000421   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 000422   200007 631500                    EPPR1   RETURN_PTR$,,AUTO
        31 000423   200624 451500                    STP1    LINE_NUMBER+1,,AUTO
        31 000424   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 000425   000021 631400 32                 EPPR1   17
        31 000426   000000 701000 xent               TSX1    Z9DM$GET_SUB_SCHEMA
        31 000427   000000 011000                    NOP     0

      394    21682
      395    21683    2   DO WHILE RETURN_PTR$ ~= ADDR(NIL);

  21683 31 000430   002676 710000 31                 TRA     s:22798

      396    21684
      397    21685    2       IF TOKEN_9.TYPE = %TYPE_9   THEN

  21685 31 000431   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 000432   000003 235100                    LDA     3,,PR0
        31 000433   000011 115007                    CMPA    9,DL
        31 000434   002341 601000 31                 TNZ     s:22450

      398    21686
      399    21687
      400    21688    2           IF TOKEN_9.BIB.RECORD OR TOKEN_9.BIB.FIELD   THEN  /*V* COBOL Data Item  */

  21688 31 000435   000010 236100                    LDQ     8,,PR0
        31 000436   040000 316007                    CANQ    16384,DL
        31 000437   000442 601000 31                 TNZ     s:21691
        31 000440   020000 316007                    CANQ    8192,DL
        31 000441   001707 600000 31                 TZE     s:22237

      401    21689    3             DO;

      402    21690
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:79   
      403    21691    3               DESC.DESCL = 0;                    /*V* ZERO DESCL FIELD */

  21691 31 000442   000000 220003                    LDX0    0,DU
        31 000443   200132 740100                    STX0    DESC,,AUTO

      404    21692    3               NEW_LTS$ = ADDR(NIL);         /*V* NIL PTR FOR NOT RECORD */

  21692 31 000444   000013 236000 32                 LDQ     11
        31 000445   200016 756100                    STQ     NEW_LTS$,,AUTO

      405    21693    3               NEW_LONG$ = ADDR(NIL);        /*V* NIL PTR FOR > 4095 */

  21693 31 000446   200017 756100                    STQ     NEW_LONG$,,AUTO

      406    21694    3               DML_TYPE = %NO_TYPE;

  21694 31 000447   200025 450100                    STZ     DML_TYPE,,AUTO

      407    21695    3               P_BIT = %FALSE;

  21695 31 000450   200130 450100                    STZ     P_BIT,,AUTO

      408    21696    3               LENGTH = %SHORT_ITEM;                          /*#39131*/

  21696 31 000451   200127 450100                    STZ     LENGTH,,AUTO

      409    21697    3               IF TOKEN_9.LEVEL_NUMBER  = 77   THEN

  21697 31 000452   000012 235100                    LDA     10,,PR0
        31 000453   000115 115007                    CMPA    77,DL
        31 000454   000457 601000 31                 TNZ     s:21700

      410    21698    3                   TOKEN_9.LEVEL_NUMBER = 1;

  21698 31 000455   000001 235007                    LDA     1,DL
        31 000456   000012 755100                    STA     10,,PR0

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:80   
      411    21699
      412    21700    3               IF TOKEN_9.SIB.NUMERIC  THEN

  21700 31 000457   000021 236100                    LDQ     17,,PR0
        31 000460   000001 316003                    CANQ    1,DU
        31 000461   000746 600000 31                 TZE     s:21811

      413    21701    4                 DO;

      414    21702                          /*V*             NUMERIC ITEM          */
      415    21703
      416    21704    4                   IF TOKEN_9.SIB.FLOAT_BIT    THEN      /*#36312*/

  21704 31 000462   000022 236100                    LDQ     18,,PR0
        31 000463   000020 316007                    CANQ    16,DL
        31 000464   000517 600000 31                 TZE     s:21716

      417    21705    5                     DO;

      418    21706    5                       IF TOKEN_9.SIB.COMP_2   THEN

  21706 31 000465   000021 236100                    LDQ     17,,PR0
        31 000466   000040 316007                    CANQ    32,DL
        31 000467   000473 600000 31                 TZE     s:21709

      419    21707    5                         TYPE = %TYR;

  21707 31 000470   000004 221003                    LDX1    4,DU
        31 000471   200023 741100                    STX1    TYPE,,AUTO
        31 000472   000475 710000 31                 TRA     s:21711

      420    21708    5                       ELSE
      421    21709    5                         TYPE = %TYQ;

  21709 31 000473   000005 221003                    LDX1    5,DU
        31 000474   200023 741100                    STX1    TYPE,,AUTO

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:81   
      422    21710
      423    21711    5                       SA = TOKEN_9.OFFSET/4;

  21711 31 000475   000024 236100                    LDQ     20,,PR0
        31 000476   000002 772000                    QRL     2
        31 000477   000000 622006                    EAX2    0,QL
        31 000500   200037 742100                    STX2    SA,,AUTO

      424    21712    5                       DESC.NUM_NDSC.CN = (TOKEN_9.OFFSET - (SA* 4)) * 2;

  21712 31 000501   200037 236100                    LDQ     SA,,AUTO
        31 000502   777777 376003                    ANQ     -1,DU
        31 000503   000020 772000                    QRL     16
        31 000504   000024 676000 32                 ERQ     20
        31 000505   000001 036007                    ADLQ    1,DL
        31 000506   000024 036100                    ADLQ    20,,PR0
        31 000507   000001 736000                    QLS     1
        31 000510   000041 736000                    QLS     33
        31 000511   200132 676100                    ERQ     DESC,,AUTO
        31 000512   700000 376003                    ANQ     -32768,DU
        31 000513   200132 656100                    ERSQ    DESC,,AUTO

      425    21713    5                       DESC.NUM_NDSC.TN = '0'B;

  21713 31 000514   000025 236000 32                 LDQ     21
        31 000515   200132 356100                    ANSQ    DESC,,AUTO

      426    21714    5                     END;

  21714 31 000516   000641 710000 31                 TRA     s:21765

      427    21715    4                   ELSE
      428    21716    4                   IF TOKEN_9.SIB.COMP OR TOKEN_9.SIB.COMP_3 OR

  21716 31 000517   000021 236100                    LDQ     17,,PR0
        31 000520   000200 316007                    CANQ    128,DL
        31 000521   000530 601000 31                 TNZ     s:21722
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:82   
        31 000522   000020 316007                    CANQ    16,DL
        31 000523   000530 601000 31                 TNZ     s:21722
        31 000524   000022 234100                    SZN     18,,PR0
        31 000525   000530 604000 31                 TMI     s:21722
        31 000526   010000 316007                    CANQ    4096,DL
        31 000527   000557 600000 31                 TZE     s:21735

      429    21717    4                      TOKEN_9.SIB.COMP_4 OR TOKEN_9.SIB.PIC_WITH_P THEN
      430    21718    5                     DO;

      431    21719
      432    21720                            /*V*           PACKED DECIMAL        */
      433    21721
      434    21722    5                       TYPE = %TYD;

  21722 31 000530   200023 740100                    STX0    TYPE,,AUTO

      435    21723    5                       DESC.NUM_NDSC.TN = '1'B;

  21723 31 000531   040000 236003                    LDQ     16384,DU
        31 000532   200132 256100                    ORSQ    DESC,,AUTO

      436    21724    5                       SA = TOKEN_9.OFFSET /8;

  21724 31 000533   000024 236100                    LDQ     20,,PR0
        31 000534   000003 772000                    QRL     3
        31 000535   000000 621006                    EAX1    0,QL
        31 000536   200037 741100                    STX1    SA,,AUTO

      437    21725    5                       DESC.NUM_NDSC.CN = TOKEN_9.OFFSET - (SA * 8);

  21725 31 000537   200037 236100                    LDQ     SA,,AUTO
        31 000540   777777 376003                    ANQ     -1,DU
        31 000541   000017 772000                    QRL     15
        31 000542   000024 676000 32                 ERQ     20
        31 000543   000001 036007                    ADLQ    1,DL
        31 000544   000024 036100                    ADLQ    20,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:83   
        31 000545   000041 736000                    QLS     33
        31 000546   200132 676100                    ERQ     DESC,,AUTO
        31 000547   700000 376003                    ANQ     -32768,DU
        31 000550   200132 656100                    ERSQ    DESC,,AUTO

      438    21726    5                       IF TOKEN_9.SIB.COMP_3 = %FALSE  THEN

  21726 31 000551   000021 236100                    LDQ     17,,PR0
        31 000552   000020 316007                    CANQ    16,DL
        31 000553   000641 601000 31                 TNZ     s:21765

      439    21727    5                          P_BIT = TRUE;

  21727 31 000554   400000 236003                    LDQ     -131072,DU
        31 000555   200130 756100                    STQ     P_BIT,,AUTO

      440    21728
      441    21729    5                     END;

  21729 31 000556   000641 710000 31                 TRA     s:21765

      442    21730
      443    21731    4                   ELSE
      444    21732
      445    21733    5                     DO;       /*V*           NON-PACKED      */

      446    21734
      447    21735    5                       IF TOKEN_9.SIB.COMP_1  THEN

  21735 31 000557   000100 316007                    CANQ    64,DL
        31 000560   000564 600000 31                 TZE     s:21738

      448    21736    5                           TYPE = %TYJ;

  21736 31 000561   000002 221003                    LDX1    2,DU
        31 000562   200023 741100                    STX1    TYPE,,AUTO
        31 000563   000620 710000 31                 TRA     s:21756
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:84   

      449    21737    5                       ELSE
      450    21738    5                           IF TOKEN_9.SIB.COMP_2  THEN

  21738 31 000564   000040 316007                    CANQ    32,DL
        31 000565   000571 600000 31                 TZE     s:21741

      451    21739    5                               TYPE = %TYK;

  21739 31 000566   000017 221003                    LDX1    15,DU
        31 000567   200023 741100                    STX1    TYPE,,AUTO
        31 000570   000620 710000 31                 TRA     s:21756

      452    21740    5                           ELSE
      453    21741    5                               IF TOKEN_9.SIB.COMP_6    THEN

  21741 31 000571   000004 316007                    CANQ    4,DL
        31 000572   000576 600000 31                 TZE     s:21744

      454    21742    5                                   TYPE = %TYI;

  21742 31 000573   000001 221003                    LDX1    1,DU
        31 000574   200023 741100                    STX1    TYPE,,AUTO
        31 000575   000620 710000 31                 TRA     s:21756

      455    21743    5                               ELSE
      456    21744    5                                   IF TOKEN_9.BIB.COMP_11  THEN

  21744 31 000576   000010 236100                    LDQ     8,,PR0
        31 000577   000200 316007                    CANQ    128,DL
        31 000600   000604 600000 31                 TZE     s:21747

      457    21745    5                                       TYPE = %TYR;

  21745 31 000601   000004 221003                    LDX1    4,DU
        31 000602   200023 741100                    STX1    TYPE,,AUTO
        31 000603   000620 710000 31                 TRA     s:21756
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:85   

      458    21746    5                                   ELSE
      459    21747    5                                       IF TOKEN_9.BIB.COMP_12  THEN

  21747 31 000604   000100 316007                    CANQ    64,DL
        31 000605   000611 600000 31                 TZE     s:21750

      460    21748    5                                           TYPE = % TYQ;

  21748 31 000606   000005 221003                    LDX1    5,DU
        31 000607   200023 741100                    STX1    TYPE,,AUTO
        31 000610   000620 710000 31                 TRA     s:21756

      461    21749    5                                       ELSE
      462    21750    5                                          IF TOKEN_9.SIB.DISPLAY  THEN

  21750 31 000611   000021 236100                    LDQ     17,,PR0
        31 000612   000400 316007                    CANQ    256,DL
        31 000613   000616 600000 31                 TZE     s:21753

      463    21751    5                                             TYPE = %TYD;

  21751 31 000614   200023 740100                    STX0    TYPE,,AUTO
        31 000615   000620 710000 31                 TRA     s:21756

      464    21752    5                                          ELSE
      465    21753    5                                              TYPE = %TYO;    /*V*  PIC WITH A P */

  21753 31 000616   000003 221003                    LDX1    3,DU
        31 000617   200023 741100                    STX1    TYPE,,AUTO

      466    21754
      467    21755
      468    21756    5                       SA = TOKEN_9.OFFSET/4;

  21756 31 000620   000024 236100                    LDQ     20,,PR0
        31 000621   000002 772000                    QRL     2
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:86   
        31 000622   000000 621006                    EAX1    0,QL
        31 000623   200037 741100                    STX1    SA,,AUTO

      469    21757    5                       DESC.NUM_NDSC.CN = (TOKEN_9.OFFSET - (SA * 4)) * 2;

  21757 31 000624   200037 236100                    LDQ     SA,,AUTO
        31 000625   777777 376003                    ANQ     -1,DU
        31 000626   000020 772000                    QRL     16
        31 000627   000024 676000 32                 ERQ     20
        31 000630   000001 036007                    ADLQ    1,DL
        31 000631   000024 036100                    ADLQ    20,,PR0
        31 000632   000001 736000                    QLS     1
        31 000633   000041 736000                    QLS     33
        31 000634   200132 676100                    ERQ     DESC,,AUTO
        31 000635   700000 376003                    ANQ     -32768,DU
        31 000636   200132 656100                    ERSQ    DESC,,AUTO

      470    21758    5                       DESC.NUM_NDSC.TN = '0'B;

  21758 31 000637   000025 236000 32                 LDQ     21
        31 000640   200132 356100                    ANSQ    DESC,,AUTO

      471    21759                                        /*V*  9-bit are stacked high   */
      472    21760
      473    21761    5                     END;      /*V*    NON  PACKED   */

      474    21762
      475    21763                        /*V*  Set scale factor                               */
      476    21764
      477    21765    4                   IF TYPE = %TYO   OR  TYPE = %TYD     THEN

  21765 31 000641   200023 221100                    LDX1    TYPE,,AUTO
        31 000642   000003 101003                    CMPX1   3,DU
        31 000643   000646 600000 31                 TZE     s:21767
        31 000644   000000 101003                    CMPX1   0,DU
        31 000645   000740 601000 31                 TNZ     s:21802

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:87   
      478    21766    5                     DO;

      479    21767    5                       IF TOKEN_9.LTDP > 0 THEN

  21767 31 000646   000017 235100                    LDA     15,,PR0
        31 000647   000666 600000 31                 TZE     s:21775

      480    21768    6                         DO;                             /* STAR 24756 */

      481    21769    6                           DESC.NUM_NDSC.SF = TOKEN_9.LTDP - TOKEN_9.LENGTH;

  21769 31 000650   000017 236100                    LDQ     15,,PR0
        31 000651   000016 136100                    SBLQ    14,,PR0
        31 000652   000030 736000                    QLS     24
        31 000653   200132 752120                    STCQ    DESC,'20'O,AUTO

      482    21770    6                           IF TOKEN_9.SIB.SIGN = %IDS_TRAILING_SEPARATE OR

  21770 31 000654   000022 236100                    LDQ     18,,PR0
        31 000655   000034 376003                    ANQ     28,DU
        31 000656   000014 116003                    CMPQ    12,DU
        31 000657   000662 600000 31                 TZE     s:21772
        31 000660   000020 116003                    CMPQ    16,DU
        31 000661   000673 601000 31                 TNZ     s:21779

      483    21771    6                                TOKEN_9.SIB.SIGN = %IDS_LEADING_SEPARATE  THEN
      484    21772    6                             DESC.NUM_NDSC.SF = DESC.NUM_NDSC.SF + 1;

  21772 31 000662   200132 236100                    LDQ     DESC,,AUTO
        31 000663   000100 036003                    ADLQ    64,DU
        31 000664   200132 752120                    STCQ    DESC,'20'O,AUTO

      485    21773    6                         END;

  21773 31 000665   000673 710000 31                 TRA     s:21779

      486    21774    5                       ELSE
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:88   
      487    21775    5                           DESC.NUM_NDSC.SF = TOKEN_9.RTDP * (-1);

  21775 31 000666   000020 236100                    LDQ     16,,PR0
        31 000667   000024 676000 32                 ERQ     20
        31 000670   000001 036007                    ADLQ    1,DL
        31 000671   000030 736000                    QLS     24
        31 000672   200132 752120                    STCQ    DESC,'20'O,AUTO

      488    21776
      489    21777                            /*V*  Set sign convention                            */
      490    21778
      491    21779    6                       DO CASE(TOKEN_9.SIB.SIGN);

  21779 31 000673   000022 236100                    LDQ     18,,PR0
        31 000674   000024 772000                    QRL     20
        31 000675   000007 376007                    ANQ     7,DL
        31 000676   000005 116007                    CMPQ    5,DL
        31 000677   000701 602006 31                 TNC     s:21779+6,QL
        31 000700   000736 710000 31                 TRA     s:21796
        31 000701   000736 710000 31                 TRA     s:21796
        31 000702   000713 710000 31                 TRA     s:21785
        31 000703   000722 710000 31                 TRA     s:21789
        31 000704   000706 710000 31                 TRA     s:21782
        31 000705   000731 710000 31                 TRA     s:21793

      492    21780
      493    21781    6                         CASE( %IDS_TRAILING_SEPARATE );

      494    21782    6                           DESC.NUM_NDSC.S = %TRAILING_SIGN;

  21782 31 000706   200132 236100                    LDQ     DESC,,AUTO
        31 000707   000026 376000 32                 ANQ     22
        31 000710   020000 276003                    ORQ     8192,DU
        31 000711   200132 756100                    STQ     DESC,,AUTO
        31 000712   000740 710000 31                 TRA     s:21802

      495    21783
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:89   
      496    21784    6                         CASE( %IDS_TRAILING_OVER );

      497    21785    6                           DESC.NUM_NDSC.S = %TRAILING_SIGN;   /*#30383*/

  21785 31 000713   200132 236100                    LDQ     DESC,,AUTO
        31 000714   000026 376000 32                 ANQ     22
        31 000715   020000 276003                    ORQ     8192,DU
        31 000716   200132 756100                    STQ     DESC,,AUTO

      498    21786    6                           TYPE = %TYO;                        /*#30383*/

  21786 31 000717   000003 222003                    LDX2    3,DU
        31 000720   200023 742100                    STX2    TYPE,,AUTO
        31 000721   000740 710000 31                 TRA     s:21802

      499    21787
      500    21788    6                         CASE( %IDS_LEADING_OVER );

      501    21789    6                           DESC.NUM_NDSC.S = %LEADING_SIGN;    /*#30383*/

  21789 31 000722   200132 236100                    LDQ     DESC,,AUTO
        31 000723   000026 376000 32                 ANQ     22
        31 000724   010000 276003                    ORQ     4096,DU
        31 000725   200132 756100                    STQ     DESC,,AUTO

      502    21790    6                           TYPE = %TYO;                        /*#30383*/

  21790 31 000726   000003 222003                    LDX2    3,DU
        31 000727   200023 742100                    STX2    TYPE,,AUTO
        31 000730   000740 710000 31                 TRA     s:21802

      503    21791
      504    21792    6                         CASE( %IDS_LEADING_SEPARATE );

      505    21793    6                           DESC.NUM_NDSC.S = %LEADING_SIGN;

  21793 31 000731   200132 236100                    LDQ     DESC,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:90   
        31 000732   000026 376000 32                 ANQ     22
        31 000733   010000 276003                    ORQ     4096,DU
        31 000734   200132 756100                    STQ     DESC,,AUTO
        31 000735   000740 710000 31                 TRA     s:21802

      506    21794
      507    21795    6                         CASE(ELSE);

      508    21796    6                           DESC.NUM_NDSC.S = %NO_SIGN;

  21796 31 000736   030000 236003                    LDQ     12288,DU
        31 000737   200132 256100                    ORSQ    DESC,,AUTO

      509    21797
      510    21798    6                       END;   /*V*    CASE    */

      511    21799
      512    21800    5                     END;     /*  IF TYPE = %TYO   OR  %TYD  */

      513    21801
      514    21802    4                   DESC.NUM_NDSC.N = TOKEN_9.LENGTH;

  21802 31 000740   000016 236100                    LDQ     14,,PR0
        31 000741   000022 736000                    QLS     18
        31 000742   200132 752110                    STCQ    DESC,'10'O,AUTO

      515    21803    4                   CLASS_ = %CLASS_NUMERIC;

  21803 31 000743   100000 236003                    LDQ     32768,DU
        31 000744   200024 756100                    STQ     CLASS_,,AUTO

      516    21804
      517    21805    4                 END;   /*V*      NUMERIC     */

  21805 31 000745   001043 710000 31                 TRA     s:21925

      518    21806
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:91   
      519    21807    3               ELSE
      520    21808
      521    21809    4                 DO;                       /*V*   ALPHABETIC OR ALPHANUMERIC  */

      522    21810
      523    21811    4                   TYPE = %TYA;

  21811 31 000746   000010 221003                    LDX1    8,DU
        31 000747   200023 741100                    STX1    TYPE,,AUTO

      524    21812    4                   IF TOKEN_9.SIB.ALPHANUMERIC   OR

  21812 31 000750   200000 316007                    CANQ    65536,DL
        31 000751   000754 601000 31                 TNZ     s:21814
        31 000752   000400 316003                    CANQ    256,DU
        31 000753   000757 601000 31                 TNZ     s:21816

      525    21813    4                       NOT TOKEN_9.SIB.ELEMENTARY   THEN  /*#32332*/
      526    21814    4                       CLASS_ = %CLASS_ALPHANUMERIC;

  21814 31 000754   300000 236003                    LDQ     98304,DU
        31 000755   200024 756100                    STQ     CLASS_,,AUTO
        31 000756   000761 710000 31                 TRA     s:21818

      527    21815    4                   ELSE
      528    21816    4                       CLASS_ = %CLASS_ALPHABETIC;

  21816 31 000757   200000 236003                    LDQ     65536,DU
        31 000760   200024 756100                    STQ     CLASS_,,AUTO

      529    21817
      530    21818    4                       IF TOKEN_9.LENGTH > 4095    THEN

  21818 31 000761   000016 235100                    LDA     14,,PR0
        31 000762   010000 115007                    CMPA    4096,DL
        31 000763   001017 602000 31                 TNC     s:21918

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:92   
      531    21819    5                         DO;

      532    21820    5                           LENGTH = %LONG_ITEM;

  21820 31 000764   400000 236003                    LDQ     -131072,DU
        31 000765   200127 756100                    STQ     LENGTH,,AUTO

      533    21821                                %NEW_LONG(@POINTER = NEW_LONG$,
      534    21822                                          @LENGTH  = TOKEN_9.LENGTH);

  21901 31 000766   000002 236000 8                  LDQ     LTS_+2
        31 000767   000002 036007                    ADLQ    2,DL
        31 000770   000003 116000 8                  CMPQ    LTS_+3
        31 000771   001002 604000 31                 TMI     s:21903

  21902 31 000772   000027 236000 32                 LDQ     23
        31 000773   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 000774   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 000775   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 000776   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 000777   000005 631400 32                 EPPR1   5
        31 001000   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 001001   000000 011000                    NOP     0

  21903 31 001002   000002 236000 8                  LDQ     LTS_+2
        31 001003   000022 736000                    QLS     18
        31 001004   000001 036000 8                  ADLQ    LTS_+1
        31 001005   200017 756100                    STQ     NEW_LONG$,,AUTO

  21904 31 001006   000002 236007                    LDQ     2,DL
        31 001007   000002 056000 8                  ASQ     LTS_+2

  21905 31 001010   001110 220003                    LDX0    584,DU
        31 001011   200017 470500                    LDP0    NEW_LONG$,,AUTO
        31 001012   000000 740100                    STX0    0,,PR0

  21911 31 001013   200007 470500                    LDP0    RETURN_PTR$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:93   
        31 001014   200017 471500                    LDP1    NEW_LONG$,,AUTO
        31 001015   000016 235100                    LDA     14,,PR0
        31 001016   100001 755100                    STA     1,,PR1

      535    21914    5                         END;

      536    21915                         /* ELSE
      537    21916                                LENGTH = %SHORT_ITEM; */           /*#39131*/
      538    21917
      539    21918    4                   SA = TOKEN_9.OFFSET/4;

  21918 31 001017   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 001020   000024 236100                    LDQ     20,,PR0
        31 001021   000002 772000                    QRL     2
        31 001022   000000 620006                    EAX0    0,QL
        31 001023   200037 740100                    STX0    SA,,AUTO

      540    21919    4                   DESC.ALPHA_ADSC.CN = TOKEN_9.OFFSET - (SA * 4);

  21919 31 001024   200037 236100                    LDQ     SA,,AUTO
        31 001025   777777 376003                    ANQ     -1,DU
        31 001026   000020 772000                    QRL     16
        31 001027   000024 676000 32                 ERQ     20
        31 001030   000001 036007                    ADLQ    1,DL
        31 001031   000024 036100                    ADLQ    20,,PR0
        31 001032   000042 736000                    QLS     34
        31 001033   200132 676100                    ERQ     DESC,,AUTO
        31 001034   600000 376003                    ANQ     -65536,DU
        31 001035   200132 656100                    ERSQ    DESC,,AUTO

      541    21920    4                   DESC.ALPHA_ADSC.TA = '00'B;

  21920 31 001036   000030 236000 32                 LDQ     24
        31 001037   200132 356100                    ANSQ    DESC,,AUTO

      542    21921    4                   DESC.ALPHA_ADSC.N = TOKEN_9.LENGTH;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:94   
  21921 31 001040   000016 236100                    LDQ     14,,PR0
        31 001041   000022 736000                    QLS     18
        31 001042   200132 752130                    STCQ    DESC,'30'O,AUTO

      543    21922
      544    21923    4                 END;       /*V*   ALPHA  AND ALPHANUMRIC   */

      545    21924         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:95   
      546    21925    3               IF TOKEN_9.LEVEL_NUMBER = 1      THEN

  21925 31 001043   000012 235100                    LDA     10,,PR0
        31 001044   000001 115007                    CMPA    1,DL
        31 001045   001163 601000 31                 TNZ     s:22062

      547    21926    4                 DO;

      548    21927    4                   IF (TOKEN_9.BIB.FIELD = TRUE) AND (TOKEN_9.BIB.DB_KEY = %TRUE) THEN

  21927 31 001046   000010 236100                    LDQ     8,,PR0
        31 001047   020000 316007                    CANQ    8192,DL
        31 001050   001057 600000 31                 TZE     s:21933
        31 001051   000400 316007                    CANQ    256,DL
        31 001052   001057 600000 31                 TZE     s:21933

      549    21928    5                     DO;

      550    21929    5                       TYPE = %TYI;

  21929 31 001053   000001 220003                    LDX0    1,DU
        31 001054   200023 740100                    STX0    TYPE,,AUTO

      551    21930    5                       DML_TYPE = %DATA_BASE_KEY;

  21930 31 001055   200000 236003                    LDQ     65536,DU
        31 001056   200025 756100                    STQ     DML_TYPE,,AUTO

      552    21931    5                     END;

      553    21932                           /*V*      01   LEVEL   ITEM   */
      554    21933    4                   IF TOKEN_9.BIB.RECORD  THEN

  21933 31 001057   000010 236100                    LDQ     8,,PR0
        31 001060   040000 316007                    CANQ    16384,DL
        31 001061   001125 600000 31                 TZE     s:22038

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:96   
      555    21934    5                     DO;

      556    21935
      557    21936    5                       DML_TYPE = %RECORD;

  21936 31 001062   300000 236003                    LDQ     98304,DU
        31 001063   200025 756100                    STQ     DML_TYPE,,AUTO

      558    21937    5                       RECORD_INFO.LOCATION_CALC = TOKEN_9.BIB.DB_KEY;

  21937 31 001064   000010 236100                    LDQ     8,,PR0
        31 001065   000033 736000                    QLS     27
        31 001066   200133 676100                    ERQ     RECORD_INFO,,AUTO
        31 001067   400000 376003                    ANQ     -131072,DU
        31 001070   200133 656100                    ERSQ    RECORD_INFO,,AUTO

      559    21938               /*           RECORD_INFO.PARTIAL_RECORD = TOKEN_9.BIB.COMP_11;
      560    21939                            RECORD_INFO.STORE_NOT_PER = TOKEN_9.BIB.BIT30;
      561    21940                            RECORD_INFO.MODIFY_ONLY   = TOKEN_9.BIB.BIT31;
      562    21941                            RECORD_INFO.ALL_CALC_PRES = TOKEN_9.BIB.BIT33;
      563    21942                            RECORD_INFO.ERASE_ALL_NOT_PER = TOKEN_9.BIB.BIT34;
      564    21943                            RECORD_INFO.ERASE_NOT_PER = TOKEN_9.BIB.BIT35;
      565    21944                  These items are never referenced so have been commented out  */
      566    21945                            %NEW_DML_REC( @INFO  =  RECORD_INFO, @POINTER = NEW_LTS$);

  22023 31 001071   000002 236000 8                  LDQ     LTS_+2
        31 001072   000006 036007                    ADLQ    6,DL
        31 001073   000003 116000 8                  CMPQ    LTS_+3
        31 001074   001105 604000 31                 TMI     s:22025

  22024 31 001075   000027 236000 32                 LDQ     23
        31 001076   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 001077   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 001100   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 001101   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 001102   000005 631400 32                 EPPR1   5
        31 001103   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:97   
        31 001104   000000 011000                    NOP     0

  22025 31 001105   000002 236000 8                  LDQ     LTS_+2
        31 001106   000022 736000                    QLS     18
        31 001107   000001 036000 8                  ADLQ    LTS_+1
        31 001110   200016 756100                    STQ     NEW_LTS$,,AUTO

  22026 31 001111   000006 236007                    LDQ     6,DL
        31 001112   000002 056000 8                  ASQ     LTS_+2

  22027 31 001113   001125 220003                    LDX0    597,DU
        31 001114   200016 470500                    LDP0    NEW_LTS$,,AUTO
        31 001115   000000 740100                    STX0    0,,PR0

  22033 31 001116   200133 236100                    LDQ     RECORD_INFO,,AUTO
        31 001117   400000 376003                    ANQ     -131072,DU
        31 001120   000001 676100                    ERQ     1,,PR0
        31 001121   774000 376003                    ANQ     -2048,DU
        31 001122   000001 656100                    ERSQ    1,,PR0

  22034 31 001123   000013 236000 32                 LDQ     11
        31 001124   000005 756100                    STQ     5,,PR0

      567    22037    5                     END;

      568    22038    4                   LEVEL_# = TOKEN_9.LEVEL_NUMBER;

  22038 31 001125   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 001126   000012 235100                    LDA     10,,PR0
        31 001127   200026 755100                    STA     LEVEL_#,,AUTO

      569    22039    4                   DML_STK_PTR = 1;

  22039 31 001130   000001 236007                    LDQ     1,DL
        31 001131   200032 756100                    STQ     DML_STK_PTR,,AUTO

      570    22040    4                   START_LEVEL_#(LEVEL_#) = 1;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:98   

  22040 31 001132   001000 236003                    LDQ     512,DU
        31 001133   200045 756105                    STQ     START_LEVEL_#,AL,AUTO

      571    22041    4                   DML_STK_PTR_OF_FATHER = 0;

  22041 31 001134   200033 450100                    STZ     DML_STK_PTR_OF_FATHER,,AUTO

      572    22042
      573    22043    4                   CALL BUILD_ST_ITEM;

  22043 31 001135   006404 701000 31                 TSX1    BUILD_ST_ITEM
        31 001136   000000 011000                    NOP     0

      574    22044
      575    22045                        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);

  22047 31 001137   000424 236000 xsym               LDQ     COMCOM+276
        31 001140   000013 116000 32                 CMPQ    11
        31 001141   001145 600000 31                 TZE     s:22049

  22048 31 001142   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 001143   000424 470400 xsym               LDP0    COMCOM+276
        31 001144   000002 756100                    STQ     2,,PR0

  22049 31 001145   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 001146   000424 756000 xsym               STQ     COMCOM+276

      576    22052    4                   IF HEAD_UWA_QLT$ = ADDR(NIL)   THEN

  22052 31 001147   200013 236100                    LDQ     HEAD_UWA_QLT$,,AUTO
        31 001150   000013 116000 32                 CMPQ    11
        31 001151   001154 601000 31                 TNZ     s:22055

      577    22053    4                       HEAD_UWA_QLT$ = NEW_QLT$;

  22053 31 001152   200010 236100                    LDQ     NEW_QLT$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:99   
        31 001153   200013 756100                    STQ     HEAD_UWA_QLT$,,AUTO

      578    22054
      579    22055    4                   CALL Z9DM$GET_SUB_SCHEMA(RETURN_PTR$ );

  22055 31 001154   200007 630500                    EPPR0   RETURN_PTR$,,AUTO
        31 001155   200624 450500                    STP0    LINE_NUMBER+1,,AUTO
        31 001156   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 001157   000005 631400 32                 EPPR1   5
        31 001160   000000 701000 xent               TSX1    Z9DM$GET_SUB_SCHEMA
        31 001161   000000 011000                    NOP     0

      580    22056
      581    22057    4                 END;      /*V*    01  LEVEL  ITEM    */

  22057 31 001162   002676 710000 31                 TRA     s:22798

      582    22058         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:100  
      583    22059    3               ELSE
      584    22060    4                 DO;                       /*V*     FIELD   ITEM       */

      585    22061
      586    22062    4                   IF HEAD_UWA_QLT$ = ADDR(NIL) THEN

  22062 31 001163   200013 236100                    LDQ     HEAD_UWA_QLT$,,AUTO
        31 001164   000013 116000 32                 CMPQ    11
        31 001165   001237 601000 31                 TNZ     s:22088

      587    22063    5                     DO;

      588    22064    5                       CALL Z8AE$ERROR (%E$LEVEL_1_OR_77_AT_TOP);

  22064 31 001166   000032 630400 32                 EPPR0   26
        31 001167   000005 631400 32                 EPPR1   5
        31 001170   000000 701000 xent               TSX1    Z8AE$ERROR
        31 001171   000000 011000                    NOP     0

      589    22065    5                       LEVEL_# = 1;

  22065 31 001172   000001 235007                    LDA     1,DL
        31 001173   200026 755100                    STA     LEVEL_#,,AUTO

      590    22066    5                       START_LEVEL_# (1) = 1;

  22066 31 001174   001000 236003                    LDQ     512,DU
        31 001175   200046 756100                    STQ     START_LEVEL_#+1,,AUTO

      591    22067    5                       DML_STK_PTR = 1;

  22067 31 001176   200032 755100                    STA     DML_STK_PTR,,AUTO

      592    22068    5                       DML_STK_PTR_OF_FATHER = 0;

  22068 31 001177   200033 450100                    STZ     DML_STK_PTR_OF_FATHER,,AUTO

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:101  
      593    22069    5                       CALL Z8AT$CREATE_TEMPORARY(%SCALAR,RETURN$);

  22069 31 001200   200012 630500                    EPPR0   RETURN$,,AUTO
        31 001201   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 001202   000034 236000 32                 LDQ     28
        31 001203   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 001204   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 001205   000021 631400 32                 EPPR1   17
        31 001206   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        31 001207   000000 011000                    NOP     0

      594    22070    5                       RETURN$ -> SCALAR.COUNT = O1COM.DML_UWA$ -> BLOCK.COUNT;

  22070 31 001210   000077 470400 xsym               LDP0    O1COM+63
        31 001211   200012 471500                    LDP1    RETURN$,,AUTO
        31 001212   000000 236100                    LDQ     0,,PR0
        31 001213   100000 552104                    STBQ    0,'04'O,PR1

      595    22071    5                       RETURN$ -> SCALAR.B.ELEMENTARY = FALSE;

  22071 31 001214   200012 470500                    LDP0    RETURN$,,AUTO
        31 001215   000035 236000 32                 LDQ     29
        31 001216   000003 356100                    ANSQ    3,,PR0

      596    22072    5                       RETURN$ -> SCALAR.B.GLOBAL = TRUE;

  22072 31 001217   200012 470500                    LDP0    RETURN$,,AUTO
        31 001220   000010 236003                    LDQ     8,DU
        31 001221   000003 256100                    ORSQ    3,,PR0

      597    22073    5                       RETURN$ -> SCALAR.B.EXTERNAL = TRUE;

  22073 31 001222   200012 470500                    LDP0    RETURN$,,AUTO
        31 001223   000004 236003                    LDQ     4,DU
        31 001224   000003 256100                    ORSQ    3,,PR0

      598    22074    5                       RETURN$ -> SCALAR.B.DML_UWA = TRUE;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:102  

  22074 31 001225   200012 470500                    LDP0    RETURN$,,AUTO
        31 001226   200000 236007                    LDQ     65536,DL
        31 001227   000003 256100                    ORSQ    3,,PR0

      599    22075    5                       HEAD_UWA_QLT$ = RETURN$ -> SCALAR.QLT$;

  22075 31 001230   200012 470500                    LDP0    RETURN$,,AUTO
        31 001231   000007 236100                    LDQ     7,,PR0
        31 001232   200013 756100                    STQ     HEAD_UWA_QLT$,,AUTO

      600    22076                            %UPDATE_DML_STK( @HEAD = 1,
      601    22077                                             @QLT$ = HEAD_UWA_QLT$,
      602    22078                                             @LEVEL# = 1,
      603    22079                                             @PTR_TO_FATHER = 0 );

  22081 31 001233   200147 756100                    STQ     DML_STK+3,,AUTO

  22082 31 001234   000001 235007                    LDA     1,DL
        31 001235   200150 755100                    STA     DML_STK+4,,AUTO

  22083 31 001236   200151 450100                    STZ     DML_STK+5,,AUTO

      604    22086    5                     END;

      605    22087
      606    22088    4                   IF (TOKEN_9.BIB.FIELD = TRUE) AND (TOKEN_9.BIB.DB_KEY = %TRUE) THEN

  22088 31 001237   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 001240   000010 236100                    LDQ     8,,PR0
        31 001241   020000 316007                    CANQ    8192,DL
        31 001242   001252 600000 31                 TZE     s:22093
        31 001243   000400 316007                    CANQ    256,DL
        31 001244   001252 600000 31                 TZE     s:22093

      607    22089    5                     DO;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:103  
      608    22090    5                       TYPE = %TYI;

  22090 31 001245   000001 220003                    LDX0    1,DU
        31 001246   200023 740100                    STX0    TYPE,,AUTO

      609    22091    5                       DML_TYPE = %DATA_BASE_KEY;

  22091 31 001247   200000 236003                    LDQ     65536,DU
        31 001250   200025 756100                    STQ     DML_TYPE,,AUTO

      610    22092    5                     END;

  22092 31 001251   001256 710000 31                 TRA     s:22096

      611    22093    4                   ELSE IF TOKEN_9.BIB.NOT_IN_SCHEMA = %FALSE THEN

  22093 31 001252   001000 316007                    CANQ    512,DL
        31 001253   001256 601000 31                 TNZ     s:22096

      612    22094    4                       DML_TYPE = %FIELD;

  22094 31 001254   100000 236003                    LDQ     32768,DU
        31 001255   200025 756100                    STQ     DML_TYPE,,AUTO

      613    22095
      614    22096    4                   IF TOKEN_9.LEVEL_NUMBER > LEVEL_#    THEN

  22096 31 001256   200026 236100                    LDQ     LEVEL_#,,AUTO
        31 001257   000012 116100                    CMPQ    10,,PR0
        31 001260   001271 603000 31                 TRC     s:22103

      615    22097    5                     DO;

      616    22098    5                       DML_STK_PTR_OF_FATHER  =  DML_STK_PTR;

  22098 31 001261   200032 235100                    LDA     DML_STK_PTR,,AUTO
        31 001262   200033 755100                    STA     DML_STK_PTR_OF_FATHER,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:104  

      617    22099    5                       LEVEL_# = TOKEN_9.LEVEL_NUMBER;

  22099 31 001263   000012 235100                    LDA     10,,PR0
        31 001264   200026 755100                    STA     LEVEL_#,,AUTO

      618    22100    5                       START_LEVEL_#(LEVEL_#) = DML_STK_PTR + 1;

  22100 31 001265   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001266   000001 036007                    ADLQ    1,DL
        31 001267   000033 736000                    QLS     27
        31 001270   200045 756105                    STQ     START_LEVEL_#,AL,AUTO

      619    22101    5                     END;

      620    22102
      621    22103    4                   DML_STK_PTR = DML_STK_PTR + 1;

  22103 31 001271   200032 235100                    LDA     DML_STK_PTR,,AUTO
        31 001272   000001 035007                    ADLA    1,DL
        31 001273   200032 755100                    STA     DML_STK_PTR,,AUTO

      622    22104
      623    22105    4                   CALL BUILD_ST_ITEM;

  22105 31 001274   006404 701000 31                 TSX1    BUILD_ST_ITEM
        31 001275   000000 011000                    NOP     0

      624    22106
      625    22107    4                   CALL Z9DM$GET_SUB_SCHEMA(RETURN_PTR$ );

  22107 31 001276   200007 630500                    EPPR0   RETURN_PTR$,,AUTO
        31 001277   200624 450500                    STP0    LINE_NUMBER+1,,AUTO
        31 001300   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 001301   000005 631400 32                 EPPR1   5
        31 001302   000000 701000 xent               TSX1    Z9DM$GET_SUB_SCHEMA
        31 001303   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:105  

      626    22108         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:106  
      627    22109    4                   IF RETURN_PTR$ = ADDR(NIL)        THEN

  22109 31 001304   200007 236100                    LDQ     RETURN_PTR$,,AUTO
        31 001305   000013 116000 32                 CMPQ    11
        31 001306   001312 601000 31                 TNZ     s:22113

      628    22110    4                      NEXT_LEVEL = 1;

  22110 31 001307   000001 235007                    LDA     1,DL
        31 001310   200027 755100                    STA     NEXT_LEVEL,,AUTO
        31 001311   001330 710000 31                 TRA     s:22123

      629    22111    4                   ELSE
      630    22112
      631    22113    4                       IF TOKEN_9.TYPE ~= %TYPE_9        THEN

  22113 31 001312   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 001313   000003 235100                    LDA     3,,PR0
        31 001314   000011 115007                    CMPA    9,DL
        31 001315   001321 600000 31                 TZE     s:22117

      632    22114    4                         NEXT_LEVEL = 1;

  22114 31 001316   000001 235007                    LDA     1,DL
        31 001317   200027 755100                    STA     NEXT_LEVEL,,AUTO
        31 001320   001330 710000 31                 TRA     s:22123

      633    22115    4                       ELSE
      634    22116
      635    22117    4                           IF TOKEN_9.LEVEL_NUMBER = 77     THEN

  22117 31 001321   000012 235100                    LDA     10,,PR0
        31 001322   000115 115007                    CMPA    77,DL
        31 001323   001327 601000 31                 TNZ     s:22120

      636    22118    4                             NEXT_LEVEL = 1;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:107  
  22118 31 001324   000001 235007                    LDA     1,DL
        31 001325   200027 755100                    STA     NEXT_LEVEL,,AUTO
        31 001326   001330 710000 31                 TRA     s:22123

      637    22119    4                           ELSE
      638    22120    4                             NEXT_LEVEL = TOKEN_9.LEVEL_NUMBER;

  22120 31 001327   200027 755100                    STA     NEXT_LEVEL,,AUTO

      639    22121
      640    22122
      641    22123    5                   DO WHILE NEXT_LEVEL < LEVEL_#;

  22123 31 001330   200027 236100                    LDQ     NEXT_LEVEL,,AUTO
        31 001331   200026 116100                    CMPQ    LEVEL_#,,AUTO
        31 001332   001416 603000 31                 TRC     s:22156

      642    22124    5                       PREVIOUS_BRO_QLT$ = ADDR(NIL);

  22124 31 001333   000013 236000 32                 LDQ     11
        31 001334   200011 756100                    STQ     PREVIOUS_BRO_QLT$,,AUTO

      643    22125
      644    22126    6                       DO WHILE (DML_STK.LEVEL_#(DML_STK_PTR) = LEVEL_#);

  22126 31 001335   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001336   000003 402007                    MPY     3,DL
        31 001337   200145 236106                    LDQ     DML_STK+1,QL,AUTO
        31 001340   200026 116100                    CMPQ    LEVEL_#,,AUTO
        31 001341   001372 601000 31                 TNZ     s:22138

      645    22127    6                           DML_STK.QLT$(DML_STK_PTR) -> QLT.FATHER  =

  22127 31 001342   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001343   000003 402007                    MPY     3,DL
        31 001344   200144 470506                    LDP0    DML_STK,QL,AUTO
        31 001345   200146 236106                    LDQ     DML_STK+2,QL,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:108  
        31 001346   000003 402007                    MPY     3,DL
        31 001347   200144 236106                    LDQ     DML_STK,QL,AUTO
        31 001350   000001 756100                    STQ     1,,PR0

      646    22128    6                               DML_STK.QLT$(DML_STK.FATHER(DML_STK_PTR));
      647    22129
      648    22130    6                           DML_STK.QLT$(DML_STK_PTR) -> QLT.BROTHER =

  22130 31 001351   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001352   000003 402007                    MPY     3,DL
        31 001353   200144 470506                    LDP0    DML_STK,QL,AUTO
        31 001354   200011 236100                    LDQ     PREVIOUS_BRO_QLT$,,AUTO
        31 001355   000002 756100                    STQ     2,,PR0

      649    22131    6                                                       PREVIOUS_BRO_QLT$;
      650    22132
      651    22133    6                           PREVIOUS_BRO_QLT$ = DML_STK.QLT$(DML_STK_PTR);

  22133 31 001356   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001357   000003 402007                    MPY     3,DL
        31 001360   200144 236106                    LDQ     DML_STK,QL,AUTO
        31 001361   200011 756100                    STQ     PREVIOUS_BRO_QLT$,,AUTO

      652    22134    6                           DML_STK_PTR = DML_STK_PTR - 1;

  22134 31 001362   200032 235100                    LDA     DML_STK_PTR,,AUTO
        31 001363   000001 135007                    SBLA    1,DL
        31 001364   200032 755100                    STA     DML_STK_PTR,,AUTO

      653    22135
      654    22136    6                       END;    /*V*    WHILE    */

  22136 31 001365   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001366   000003 402007                    MPY     3,DL
        31 001367   200145 236106                    LDQ     DML_STK+1,QL,AUTO
        31 001370   200026 116100                    CMPQ    LEVEL_#,,AUTO
        31 001371   001342 600000 31                 TZE     s:22127
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:109  

      655    22137
      656    22138    5                       IF DML_STK.QLT$(DML_STK_PTR) -> QLT.SON = ADDR(NIL) THEN

  22138 31 001372   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001373   000003 402007                    MPY     3,DL
        31 001374   200144 470506                    LDP0    DML_STK,QL,AUTO
        31 001375   000003 236100                    LDQ     3,,PR0
        31 001376   000013 116000 32                 CMPQ    11
        31 001377   001405 601000 31                 TNZ     s:22141

      657    22139    5                           DML_STK.QLT$(DML_STK_PTR) -> QLT.SON =

  22139 31 001400   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001401   000003 402007                    MPY     3,DL
        31 001402   200144 470506                    LDP0    DML_STK,QL,AUTO
        31 001403   200011 236100                    LDQ     PREVIOUS_BRO_QLT$,,AUTO
        31 001404   000003 756100                    STQ     3,,PR0

      658    22140    5                                                     PREVIOUS_BRO_QLT$;
      659    22141    5                       LEVEL_# = DML_STK.LEVEL_#(DML_STK_PTR);

  22141 31 001405   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001406   000003 402007                    MPY     3,DL
        31 001407   200145 235106                    LDA     DML_STK+1,QL,AUTO
        31 001410   200026 755100                    STA     LEVEL_#,,AUTO

      660    22142                                                              /*  STAR  24786  24820  */
      661    22143    5                       DML_STK_PTR_OF_FATHER = DML_STK.FATHER(DML_STK_PTR);

  22143 31 001411   200146 235106                    LDA     DML_STK+2,QL,AUTO
        31 001412   200033 755100                    STA     DML_STK_PTR_OF_FATHER,,AUTO

      662    22144
      663    22145    5                   END;      /*V*   WHILE   */

  22145 31 001413   200027 236100                    LDQ     NEXT_LEVEL,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:110  
        31 001414   200026 116100                    CMPQ    LEVEL_#,,AUTO
        31 001415   001333 602000 31                 TNC     s:22124

      664    22146         %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:111  
      665    22147                        /*V* Eliminate one item from the DML_STK when there
      666    22148                             are three consecutive data-names at the same
      667    22149                             level (next, DML_STK_PTR, DML_STK_PTR - 1).
      668    22150                             Set the "FATHER", "BROTHER", and "SON" QLT
      669    22151                             pointers for the item at DML_STK_PTR - 1;
      670    22152                             then move the item at DML_STK_PTR to DML_STK_PTR
      671    22153                             - 1; then decrement DML_STK_PTR by one.
      672    22154                        */
      673    22155
      674    22156    4                   IF NEXT_LEVEL = LEVEL_#

  22156 31 001416   001454 601000 31                 TNZ     s:22183
        31 001417   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001420   000003 402007                    MPY     3,DL
        31 001421   000000 620006                    EAX0    0,QL
        31 001422   200145 236110                    LDQ     DML_STK+1,X0,AUTO
        31 001423   200142 116110                    CMPQ    NAME+6,X0,AUTO
        31 001424   001454 601000 31                 TNZ     s:22183

      675    22157    4                   AND DML_STK.LEVEL_# (DML_STK_PTR) =
      676    22158    4                       DML_STK.LEVEL_# (DML_STK_PTR - 1) THEN
      677    22159    5                     DO;

      678    22160
      679    22161    5                       DML_STK.QLT$ (DML_STK_PTR - 1) -> QLT.FATHER =

  22161 31 001425   200141 470510                    LDP0    NAME+5,X0,AUTO
        31 001426   200143 236110                    LDQ     NAME+7,X0,AUTO
        31 001427   000003 402007                    MPY     3,DL
        31 001430   200144 236106                    LDQ     DML_STK,QL,AUTO
        31 001431   000001 756100                    STQ     1,,PR0

      680    22162    5                         DML_STK.QLT$ (DML_STK.FATHER (DML_STK_PTR - 1));
      681    22163    5                       DML_STK.QLT$ (DML_STK_PTR - 1) -> QLT.BROTHER =

  22163 31 001432   200144 236110                    LDQ     DML_STK,X0,AUTO
        31 001433   000002 756100                    STQ     2,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:112  

      682    22164    5                         DML_STK.QLT$ (DML_STK_PTR);
      683    22165
      684    22166    5                       IF DML_STK.QLT$ (DML_STK.FATHER (DML_STK_PTR - 1)) ->

  22166 31 001434   200143 236110                    LDQ     NAME+7,X0,AUTO
        31 001435   000003 402007                    MPY     3,DL
        31 001436   200144 471506                    LDP1    DML_STK,QL,AUTO
        31 001437   100003 236100                    LDQ     3,,PR1
        31 001440   000013 116000 32                 CMPQ    11
        31 001441   001447 601000 31                 TNZ     s:22171

      685    22167    5                          QLT.SON = ADDR (NIL) THEN
      686    22168    5                         DML_STK.QLT$ (DML_STK.FATHER (DML_STK_PTR - 1)) ->

  22168 31 001442   200143 236110                    LDQ     NAME+7,X0,AUTO
        31 001443   000003 402007                    MPY     3,DL
        31 001444   200144 471506                    LDP1    DML_STK,QL,AUTO
        31 001445   200141 236110                    LDQ     NAME+5,X0,AUTO
        31 001446   100003 756100                    STQ     3,,PR1

      687    22169    5                           QLT.SON = DML_STK.QLT$ (DML_STK_PTR - 1);
      688    22170
      689    22171    5                       DML_STK.QLT$ (DML_STK_PTR - 1) =

  22171 31 001447   200144 236110                    LDQ     DML_STK,X0,AUTO
        31 001450   200141 756110                    STQ     NAME+5,X0,AUTO

      690    22172    5                         DML_STK.QLT$ (DML_STK_PTR);
      691    22173                            /* LEVEL_# and FATHER are already equal,
      692    22174                               therefore no need to move them.
      693    22175                            */
      694    22176
      695    22177    5                       DML_STK_PTR = DML_STK_PTR - 1;

  22177 31 001451   200032 235100                    LDA     DML_STK_PTR,,AUTO
        31 001452   000001 135007                    SBLA    1,DL
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:113  
        31 001453   200032 755100                    STA     DML_STK_PTR,,AUTO

      696    22178
      697    22179    5                     END; /* 3 consecutive items at same level */

      698    22180        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:114  
      699    22181                        /*V*   IF DML_STK IS FULL, LINK QLT'S FOR CURRENT LEVEL */
      700    22182
      701    22183    4                   IF DML_STK_PTR >= 98     THEN /* Impossible */

  22183 31 001454   200032 235100                    LDA     DML_STK_PTR,,AUTO
        31 001455   000142 115007                    CMPA    98,DL
        31 001456   002676 602000 31                 TNC     s:22798

      702    22184    5                     DO;

      703    22185
      704    22186    5                       IF DML_STK.QLT$(DML_STK.FATHER(DML_STK_PTR)) -> QLT.SON =

  22186 31 001457   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001460   000003 402007                    MPY     3,DL
        31 001461   200146 236106                    LDQ     DML_STK+2,QL,AUTO
        31 001462   000003 402007                    MPY     3,DL
        31 001463   200144 470506                    LDP0    DML_STK,QL,AUTO
        31 001464   000003 236100                    LDQ     3,,PR0
        31 001465   000013 116000 32                 CMPQ    11
        31 001466   001502 601000 31                 TNZ     s:22193

      705    22187    5                                                       ADDR(NIL)   THEN
      706    22188                                /*V*  SET SON IF THIS IS FIRST ITEM OF SUBSTRUCTURE    */
      707    22189
      708    22190    5                           DML_STK.QLT$(DML_STK.FATHER(DML_STK_PTR)) -> QLT.SON =

  22190 31 001467   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001470   000003 402007                    MPY     3,DL
        31 001471   200146 236106                    LDQ     DML_STK+2,QL,AUTO
        31 001472   000003 402007                    MPY     3,DL
        31 001473   200144 470506                    LDP0    DML_STK,QL,AUTO
        31 001474   200026 720100                    LXL0    LEVEL_#,,AUTO
        31 001475   200045 236110                    LDQ     START_LEVEL_#,X0,AUTO
        31 001476   000033 772000                    QRL     27
        31 001477   000003 402007                    MPY     3,DL
        31 001500   200144 236106                    LDQ     DML_STK,QL,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:115  
        31 001501   000003 756100                    STQ     3,,PR0

      709    22191    5                                    DML_STK.QLT$(START_LEVEL_#(LEVEL_#));
      710    22192
      711    22193    6                       IF START_LEVEL_#(LEVEL_#) < DML_STK_PTR THEN DO;

  22193 31 001502   200026 720100                    LXL0    LEVEL_#,,AUTO
        31 001503   200045 236110                    LDQ     START_LEVEL_#,X0,AUTO
        31 001504   000033 772000                    QRL     27
        31 001505   200032 116100                    CMPQ    DML_STK_PTR,,AUTO
        31 001506   001554 603000 31                 TRC     s:22205

      712    22194
      713    22195    7                         DO I = START_LEVEL_#(LEVEL_#) TO (DML_STK_PTR - 1);

  22195 31 001507   000000 621006                    EAX1    0,QL
        31 001510   200042 741100                    STX1    I,,AUTO
        31 001511   001527 710000 31                 TRA     s:22199+3

      714    22196    7                             DML_STK.QLT$(I) -> QLT.BROTHER = DML_STK.QLT$(I + 1);

  22196 31 001512   200042 220100                    LDX0    I,,AUTO
        31 001513   200042 020100                    ADLX0   I,,AUTO
        31 001514   200042 020100                    ADLX0   I,,AUTO
        31 001515   200144 470510                    LDP0    DML_STK,X0,AUTO
        31 001516   200147 236110                    LDQ     DML_STK+3,X0,AUTO
        31 001517   000002 756100                    STQ     2,,PR0

      715    22197    7                             DML_STK.QLT$(I) -> QLT.FATHER = DML_STK.QLT$

  22197 31 001520   200146 236110                    LDQ     DML_STK+2,X0,AUTO
        31 001521   000003 402007                    MPY     3,DL
        31 001522   200144 236106                    LDQ     DML_STK,QL,AUTO
        31 001523   000001 756100                    STQ     1,,PR0

      716    22198    7                                                       (DML_STK.FATHER(I));
      717    22199    7                         END;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:116  

  22199 31 001524   200042 221100                    LDX1    I,,AUTO
        31 001525   000001 622011                    EAX2    1,X1
        31 001526   200042 742100                    STX2    I,,AUTO
        31 001527   200042 236100                    LDQ     I,,AUTO
        31 001530   000022 732000                    QRS     18
        31 001531   001512 604000 31                 TMI     s:22196
        31 001532   200032 116100                    CMPQ    DML_STK_PTR,,AUTO
        31 001533   001512 602000 31                 TNC     s:22196

      718    22200
      719    22201    6                         DML_STK(START_LEVEL_#(LEVEL_#)) = DML_STK(DML_STK_PTR);

  22201 31 001534   200026 720100                    LXL0    LEVEL_#,,AUTO
        31 001535   200045 236110                    LDQ     START_LEVEL_#,X0,AUTO
        31 001536   000033 772000                    QRL     27
        31 001537   000003 402007                    MPY     3,DL
        31 001540   000000 621006                    EAX1    0,QL
        31 001541   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 001542   000014 402007                    MPY     12,DL
        31 001543   000000 635011                    EAA     0,X1
        31 001544   000020 771000                    ARL     16
        31 001545   000105 100506                    MLR     fill='000'O
        31 001546   200144 000014                    ADSC9   DML_STK,Q,AUTO           cn=0,n=12
        31 001547   200144 000014                    ADSC9   DML_STK,A,AUTO           cn=0,n=12

      720    22202    6                         DML_STK_PTR = START_LEVEL_#(LEVEL_#);

  22202 31 001550   200045 236110                    LDQ     START_LEVEL_#,X0,AUTO
        31 001551   000033 772000                    QRL     27
        31 001552   200032 756100                    STQ     DML_STK_PTR,,AUTO

      721    22203    6                       END;

  22203 31 001553   002676 710000 31                 TRA     s:22798

      722    22204    6                       ELSE DO;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:117  

      723    22205    6                         J = DML_STK_PTR - 1;

  22205 31 001554   200032 235100                    LDA     DML_STK_PTR,,AUTO
        31 001555   000001 135007                    SBLA    1,DL
        31 001556   200043 755100                    STA     J,,AUTO

      724    22206    7                         DO WHILE DML_STK.FATHER(J) = J - 1;

  22206 31 001557   001563 710000 31                 TRA     s:22208

      725    22207    7                           J = J - 1;

  22207 31 001560   200043 235100                    LDA     J,,AUTO
        31 001561   000001 135007                    SBLA    1,DL
        31 001562   200043 755100                    STA     J,,AUTO

      726    22208    7                         END;

  22208 31 001563   200043 236100                    LDQ     J,,AUTO
        31 001564   000003 402007                    MPY     3,DL
        31 001565   000000 620006                    EAX0    0,QL
        31 001566   200043 236100                    LDQ     J,,AUTO
        31 001567   000001 136007                    SBLQ    1,DL
        31 001570   001573 604000 31                 TMI     s:22209
        31 001571   200146 116110                    CMPQ    DML_STK+2,X0,AUTO
        31 001572   001560 600000 31                 TZE     s:22207

      727    22209    6                         K = J - 1;

  22209 31 001573   200044 756100                    STQ     K,,AUTO

      728    22210    7                         DO I = START_LEVEL_#(DML_STK.LEVEL_#(J)) TO K;

  22210 31 001574   200145 721110                    LXL1    DML_STK+1,X0,AUTO
        31 001575   200045 236111                    LDQ     START_LEVEL_#,X1,AUTO
        31 001576   000033 772000                    QRL     27
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:118  
        31 001577   000000 622006                    EAX2    0,QL
        31 001600   200042 742100                    STX2    I,,AUTO
        31 001601   001617 710000 31                 TRA     s:22213+3

      729    22211    7                           DML_STK.QLT$(I) -> QLT.BROTHER = DML_STK.QLT$(I + 1);

  22211 31 001602   200042 220100                    LDX0    I,,AUTO
        31 001603   200042 020100                    ADLX0   I,,AUTO
        31 001604   200042 020100                    ADLX0   I,,AUTO
        31 001605   200144 470510                    LDP0    DML_STK,X0,AUTO
        31 001606   200147 236110                    LDQ     DML_STK+3,X0,AUTO
        31 001607   000002 756100                    STQ     2,,PR0

      730    22212    7                          DML_STK.QLT$(I) -> QLT.FATHER = DML_STK.QLT$(DML_STK.FATHER(
             22212                                    I));

  22212 31 001610   200146 236110                    LDQ     DML_STK+2,X0,AUTO
        31 001611   000003 402007                    MPY     3,DL
        31 001612   200144 236106                    LDQ     DML_STK,QL,AUTO
        31 001613   000001 756100                    STQ     1,,PR0

      731    22213    7                         END;

  22213 31 001614   200042 221100                    LDX1    I,,AUTO
        31 001615   000001 622011                    EAX2    1,X1
        31 001616   200042 742100                    STX2    I,,AUTO
        31 001617   200042 236100                    LDQ     I,,AUTO
        31 001620   000022 732000                    QRS     18
        31 001621   001602 604000 31                 TMI     s:22211
        31 001622   200044 116100                    CMPQ    K,,AUTO
        31 001623   001602 602000 31                 TNC     s:22211
        31 001624   001602 600000 31                 TZE     s:22211

      732    22214    6                         I = DML_STK.FATHER(J) + 1;

  22214 31 001625   200043 236100                    LDQ     J,,AUTO
        31 001626   000003 402007                    MPY     3,DL
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:119  
        31 001627   200146 720106                    LXL0    DML_STK+2,QL,AUTO
        31 001630   000001 621010                    EAX1    1,X0
        31 001631   200042 741100                    STX1    I,,AUTO

      733    22215    6                         DML_STK.QLT$(I) = DML_STK.QLT$(K + 1);

  22215 31 001632   200042 222100                    LDX2    I,,AUTO
        31 001633   200042 022100                    ADLX2   I,,AUTO
        31 001634   200042 022100                    ADLX2   I,,AUTO
        31 001635   200044 236100                    LDQ     K,,AUTO
        31 001636   000003 402007                    MPY     3,DL
        31 001637   200147 236106                    LDQ     DML_STK+3,QL,AUTO
        31 001640   200144 756112                    STQ     DML_STK,X2,AUTO

      734    22216    7                         DO K = K TO 23;

  22216 31 001641   001673 710000 31                 TRA     s:22223+3

      735    22217    7                           DML_STK.QLT$ (I + 1) = DML_STK.QLT$ (K + 2);

  22217 31 001642   200042 220100                    LDX0    I,,AUTO
        31 001643   200042 020100                    ADLX0   I,,AUTO
        31 001644   200042 020100                    ADLX0   I,,AUTO
        31 001645   200044 236100                    LDQ     K,,AUTO
        31 001646   000003 402007                    MPY     3,DL
        31 001647   200152 236106                    LDQ     DML_STK+6,QL,AUTO
        31 001650   200147 756110                    STQ     DML_STK+3,X0,AUTO

      736    22218    7                           J = DML_STK.LEVEL_# (K + 2);

  22218 31 001651   200044 236100                    LDQ     K,,AUTO
        31 001652   000003 402007                    MPY     3,DL
        31 001653   200153 235106                    LDA     DML_STK+7,QL,AUTO
        31 001654   200043 755100                    STA     J,,AUTO

      737    22219    7                           DML_STK.LEVEL_# (I + 1) = J;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:120  
  22219 31 001655   200150 755110                    STA     DML_STK+4,X0,AUTO

      738    22220    7                           DML_STK.FATHER (I + 1) = I;

  22220 31 001656   200042 235100                    LDA     I,,AUTO
        31 001657   000022 731000                    ARS     18
        31 001660   200151 755110                    STA     DML_STK+5,X0,AUTO

      739    22221    7                           I = I + 1;

  22221 31 001661   000001 621005                    EAX1    1,AL
        31 001662   200042 741100                    STX1    I,,AUTO

      740    22222    7                           START_LEVEL_#(J) = I;

  22222 31 001663   200042 235100                    LDA     I,,AUTO
        31 001664   000022 731000                    ARS     18
        31 001665   000033 735000                    ALS     27
        31 001666   200043 720100                    LXL0    J,,AUTO
        31 001667   200045 755110                    STA     START_LEVEL_#,X0,AUTO

      741    22223    7                         END;

  22223 31 001670   200044 235100                    LDA     K,,AUTO
        31 001671   000001 035007                    ADLA    1,DL
        31 001672   200044 755100                    STA     K,,AUTO
        31 001673   200044 235100                    LDA     K,,AUTO
        31 001674   000030 115007                    CMPA    24,DL
        31 001675   001642 602000 31                 TNC     s:22217

      742    22224    6                         DML_STK_PTR = I;

  22224 31 001676   200042 236100                    LDQ     I,,AUTO
        31 001677   000022 732000                    QRS     18
        31 001700   200032 756100                    STQ     DML_STK_PTR,,AUTO

      743    22225    6                         DML_STK_PTR_OF_FATHER = DML_STK.FATHER(I);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:121  

  22225 31 001701   200042 220100                    LDX0    I,,AUTO
        31 001702   200042 020100                    ADLX0   I,,AUTO
        31 001703   200042 020100                    ADLX0   I,,AUTO
        31 001704   200146 235110                    LDA     DML_STK+2,X0,AUTO
        31 001705   200033 755100                    STA     DML_STK_PTR_OF_FATHER,,AUTO

      744    22226    6                       END;

      745    22227
      746    22228    5                     END;

      747    22229
      748    22230    4               END;       /*V*        FIELD    ITEM     */

      749    22231
      750    22232    3             END;         /*V*        COBOL DATA ITEM    */

  22232 31 001706   002676 710000 31                 TRA     s:22798

      751    22233        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:122  
      752    22234    2           ELSE
      753    22235    3             DO;               /*V*      IDS II TOKENS           */

      754    22236
      755    22237    4               IF TOKEN_9.BIB.REALM  THEN DO;

  22237 31 001707   200000 316007                    CANQ    65536,DL
        31 001710   001720 600000 31                 TZE     s:22242

      756    22238    4                   DML_ID = %REALM;

  22238 31 001711   000752 220003                    LDX0    490,DU
        31 001712   200034 740100                    STX0    DML_ID,,AUTO

      757    22239    4                   INDEXED_REALM = TOKEN_9.BIB.COMP_11;

  22239 31 001713   000010 236100                    LDQ     8,,PR0
        31 001714   000034 736000                    QLS     28
        31 001715   400000 376003                    ANQ     -131072,DU
        31 001716   200035 756100                    STQ     INDEXED_REALM,,AUTO

      758    22240    4               END;

  22240 31 001717   001735 710000 31                 TRA     s:22252

      759    22241    4               ELSE DO;

      760    22242    4                   INDEXED_REALM = %FALSE;

  22242 31 001720   200035 450100                    STZ     INDEXED_REALM,,AUTO

      761    22243    4                   IF TOKEN_9.BIB.SET  THEN

  22243 31 001721   100000 316007                    CANQ    32768,DL
        31 001722   001726 600000 31                 TZE     s:22246

      762    22244    4                       DML_ID = %DML_SET;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:123  

  22244 31 001723   000753 220003                    LDX0    491,DU
        31 001724   200034 740100                    STX0    DML_ID,,AUTO
        31 001725   001735 710000 31                 TRA     s:22252

      763    22245    4                   ELSE
      764    22246    4                       IF TOKEN_9.BIB.KEY  THEN

  22246 31 001726   002000 316007                    CANQ    1024,DL
        31 001727   001733 600000 31                 TZE     s:22249

      765    22247    4                           DML_ID = %DML_KEY;

  22247 31 001730   000754 220003                    LDX0    492,DU
        31 001731   200034 740100                    STX0    DML_ID,,AUTO
        31 001732   001735 710000 31                 TRA     s:22252

      766    22248    4                       ELSE
      767    22249    4                           DML_ID = %PRIVACY_KEY;

  22249 31 001733   000755 220003                    LDX0    493,DU
        31 001734   200034 740100                    STX0    DML_ID,,AUTO

      768    22250    4               END;

      769    22251
      770    22252    3               CALL Z8AH$NEW_DNT(TOKEN_9.DATA_ITEM_NAME,

  22252 31 001735   200014 631500                    EPPR1   NEW_DNT$,,AUTO
        31 001736   200626 451500                    STP1    LINE_NUMBER+3,,AUTO
        31 001737   200007 236100                    LDQ     RETURN_PTR$,,AUTO
        31 001740   000027 036003                    ADLQ    23,DU
        31 001741   200625 756100                    STQ     LINE_NUMBER+2,,AUTO
        31 001742   200007 236100                    LDQ     RETURN_PTR$,,AUTO
        31 001743   000030 036003                    ADLQ    24,DU
        31 001744   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 001745   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:124  
        31 001746   000000 631400 32                 EPPR1   0
        31 001747   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 001750   000000 011000                    NOP     0

      771    22253    3                                 TOKEN_9.NAME_SIZE,NEW_DNT$);
      772    22254
      773    22255    3               IF NEW_DNT$ -> DNT.B.RW THEN

  22255 31 001751   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 001752   000003 234100                    SZN     3,,PR0
        31 001753   002067 605000 31                 TPL     s:22338

      774    22256    4                 DO;

      775    22257    4                   CALL Z8AE$ERROR (%E$RW_USED_AS_DATA_NAME,

  22257 31 001754   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 001755   000133 236000 xsym               LDQ     COMCOM+91
        31 001756   100001 036100                    ADLQ    1,,PR1
        31 001757   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 001760   200014 633500                    EPPR3   NEW_DNT$,,AUTO
        31 001761   200631 453500                    STP3    LINE_NUMBER+6,,AUTO
        31 001762   200007 236100                    LDQ     RETURN_PTR$,,AUTO
        31 001763   000002 036003                    ADLQ    2,DU
        31 001764   200630 756100                    STQ     LINE_NUMBER+5,,AUTO
        31 001765   200624 634500                    EPPR4   LINE_NUMBER+1,,AUTO
        31 001766   200627 454500                    STP4    LINE_NUMBER+4,,AUTO
        31 001767   000037 236000 32                 LDQ     31
        31 001770   200626 756100                    STQ     LINE_NUMBER+3,,AUTO
        31 001771   200626 630500                    EPPR0   LINE_NUMBER+3,,AUTO
        31 001772   000016 631400 32                 EPPR1   14
        31 001773   000000 701000 xent               TSX1    Z8AE$ERROR
        31 001774   000000 011000                    NOP     0

      776    22258    4                                    COMCOM.CURRENT.LINE + TOKEN_9.LINE_NUMBER,
      777    22259    4                                    TOKEN_9.COLUMN,
      778    22260    4                                    NEW_DNT$);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:125  
      779    22261                        %NEW_DNT (@SIZE = TOKEN_9.NAME_SIZE,
      780    22262                                  @NAME = TOKEN_9.DATA_ITEM_NAME,
      781    22263                                  @NEXT = "DNT_BUCKETS(DNT_BUCKET_NUMBER)");

  22266 31 001775   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 001776   000027 236100                    LDQ     23,,PR0
        31 001777   000025 036007                    ADLQ    21,DL
        31 002000   000002 772000                    QRL     2
        31 002001   000000 756000 0                  STQ     ITERATION

  22267 31 002002   000002 036000 10                 ADLQ    DNT_+2
        31 002003   002016 604000 31                 TMI     s:22269
        31 002004   000003 116000 10                 CMPQ    DNT_+3
        31 002005   002016 602000 31                 TNC     s:22269

  22268 31 002006   000040 236000 32                 LDQ     32
        31 002007   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 002010   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 002011   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 002012   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 002013   000005 631400 32                 EPPR1   5
        31 002014   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 002015   000000 011000                    NOP     0

  22269 31 002016   000002 236000 10                 LDQ     DNT_+2
        31 002017   000022 736000                    QLS     18
        31 002020   000001 036000 10                 ADLQ    DNT_+1
        31 002021   000000 756000 9                  STQ     DNT$

  22270 31 002022   000002 236000 10                 LDQ     DNT_+2
        31 002023   000000 036000 0                  ADLQ    ITERATION
        31 002024   000002 756000 10                 STQ     DNT_+2

  22271 31 002025   001046 220003                    LDX0    550,DU
        31 002026   000000 470400 9                  LDP0    DNT$
        31 002027   000000 740100                    STX0    0,,PR0

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:126  
  22272 31 002030   000000 721000 0                  LXL1    ITERATION
        31 002031   000000 470400 9                  LDP0    DNT$
        31 002032   000000 441100                    SXL1    0,,PR0

  22273 31 002033   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 002034   000027 721100                    LXL1    23,,PR0
        31 002035   000000 471400 9                  LDP1    DNT$
        31 002036   100004 741100                    STX1    4,,PR1

  22276 31 002037   000013 236000 32                 LDQ     11
        31 002040   100001 756100                    STQ     1,,PR1

  22277 31 002041   000000 722000 11                 LXL2    DNT_BUCKET_NUMBER
        31 002042   000000 236012 xsym               LDQ     DNT_BUCKETS,X2
        31 002043   100002 756100                    STQ     2,,PR1

  22278 31 002044   000000 223003                    LDX3    0,DU
        31 002045   100003 743100                    STX3    3,,PR1

  22279 31 002046   000000 224003                    LDX4    0,DU
        31 002047   100003 444100                    SXL4    3,,PR1

  22280 31 002050   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 002051   000027 725100                    LXL5    23,,PR0
        31 002052   040140 100540                    MLR     fill='040'O
        31 002053   000030 000015                    ADSC9   24,,PR0                  cn=0,n=*X5
        31 002054   100004 400011                    ADSC9   4,,PR1                   cn=2,n=*X1

      782    22321    4                   DNT$ -> DNT.ATTR = NEW_DNT$ -> DNT.ATTR;

  22321 31 002055   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 002056   000003 225100                    LDX5    3,,PR0
        31 002057   100003 745100                    STX5    3,,PR1

      783    22322    4                   DNT$ -> DNT.B.USER_WORD = TRUE;

  22322 31 002060   200000 236003                    LDQ     65536,DU
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:127  
        31 002061   100003 256100                    ORSQ    3,,PR1

      784    22323    4                   DNT$ -> DNT.B.RW = FALSE;

  22323 31 002062   000041 236000 32                 LDQ     33
        31 002063   100003 356100                    ANSQ    3,,PR1

      785    22324    4                   DNT_BUCKETS(DNT_BUCKET_NUMBER) = DNT$;

  22324 31 002064   000000 236000 9                  LDQ     DNT$
        31 002065   000000 756012 xsym               STQ     DNT_BUCKETS,X2

      786    22325    4                   NEW_DNT$ = DNT$;

  22325 31 002066   200014 756100                    STQ     NEW_DNT$,,AUTO

      787    22326    4                 END;

      788    22327
      789    22328                    %NEW_DML_ITEM(  @ST$    = RETURN$,
      790    22329                                    @ID     = DML_ID,
      791    22330                                    @INT_NAME = TOKEN_9.OFFSET,
      792    22331                                    @TEMP     = TOKEN_9.BIB.DB_KEY,
      793    22332                                    @INDEXED_REALM = INDEXED_REALM,
      794    22333                                    @NEXT   = NEW_DNT$ -> DNT.ST$,
      795    22334                                    @DNT$   = NEW_DNT$);

  22338 31 002067   000002 236000 3                  LDQ     ST_+2
        31 002070   000013 036007                    ADLQ    11,DL
        31 002071   000003 116000 3                  CMPQ    ST_+3
        31 002072   002103 604000 31                 TMI     s:22340

  22339 31 002073   000014 236000 32                 LDQ     12
        31 002074   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 002075   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 002076   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 002077   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:128  
        31 002100   000005 631400 32                 EPPR1   5
        31 002101   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 002102   000000 011000                    NOP     0

  22340 31 002103   000002 236000 3                  LDQ     ST_+2
        31 002104   000022 736000                    QLS     18
        31 002105   000001 036000 3                  ADLQ    ST_+1
        31 002106   200012 756100                    STQ     RETURN$,,AUTO

  22341 31 002107   000013 236007                    LDQ     11,DL
        31 002110   000002 056000 3                  ASQ     ST_+2

  22344 31 002111   200034 220100                    LDX0    DML_ID,,AUTO
        31 002112   200012 470500                    LDP0    RETURN$,,AUTO
        31 002113   000000 740100                    STX0    0,,PR0

  22345 31 002114   200012 470500                    LDP0    RETURN$,,AUTO
        31 002115   003000 236007                    LDQ     1536,DL
        31 002116   000000 552110                    STBQ    0,'10'O,PR0

  22346 31 002117   200012 470500                    LDP0    RETURN$,,AUTO
        31 002120   000001 236007                    LDQ     1,DL
        31 002121   000000 552104                    STBQ    0,'04'O,PR0

  22347 31 002122   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 002123   200012 471500                    LDP1    RETURN$,,AUTO
        31 002124   000024 235100                    LDA     20,,PR0
        31 002125   100001 755100                    STA     1,,PR1

  22348 31 002126   200012 470500                    LDP0    RETURN$,,AUTO
        31 002127   000003 450100                    STZ     3,,PR0

  22349 31 002130   200012 470500                    LDP0    RETURN$,,AUTO
        31 002131   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 002132   100010 236100                    LDQ     8,,PR1
        31 002133   000001 736000                    QLS     1
        31 002134   000003 676100                    ERQ     3,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:129  
        31 002135   001000 376007                    ANQ     512,DL
        31 002136   000003 656100                    ERSQ    3,,PR0

  22350 31 002137   200012 470500                    LDP0    RETURN$,,AUTO
        31 002140   000010 236003                    LDQ     8,DU
        31 002141   000003 256100                    ORSQ    3,,PR0

  22351 31 002142   200012 470500                    LDP0    RETURN$,,AUTO
        31 002143   000004 236003                    LDQ     4,DU
        31 002144   000003 256100                    ORSQ    3,,PR0

  22352 31 002145   200012 470500                    LDP0    RETURN$,,AUTO
        31 002146   200035 236100                    LDQ     INDEXED_REALM,,AUTO
        31 002147   000034 772000                    QRL     28
        31 002150   000003 676100                    ERQ     3,,PR0
        31 002151   000200 376007                    ANQ     128,DL
        31 002152   000003 656100                    ERSQ    3,,PR0

  22353 31 002153   000020 221003                    LDX1    16,DU
        31 002154   200012 470500                    LDP0    RETURN$,,AUTO
        31 002155   000002 741100                    STX1    2,,PR0

  22354 31 002156   000133 722000 xsym               LXL2    COMCOM+91
        31 002157   200012 470500                    LDP0    RETURN$,,AUTO
        31 002160   000002 442100                    SXL2    2,,PR0

  22355 31 002161   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 002162   000001 236100                    LDQ     1,,PR0
        31 002163   200012 471500                    LDP1    RETURN$,,AUTO
        31 002164   100004 756100                    STQ     4,,PR1

  22356 31 002165   000013 236000 32                 LDQ     11
        31 002166   200012 470500                    LDP0    RETURN$,,AUTO
        31 002167   000005 756100                    STQ     5,,PR0

  22357 31 002170   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 002171   200012 470500                    LDP0    RETURN$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:130  
        31 002172   000006 756100                    STQ     6,,PR0

  22358 31 002173   000013 236000 32                 LDQ     11
        31 002174   200012 470500                    LDP0    RETURN$,,AUTO
        31 002175   000007 756100                    STQ     7,,PR0

  22359 31 002176   000000 222003                    LDX2    0,DU
        31 002177   200012 470500                    LDP0    RETURN$,,AUTO
        31 002200   000010 742100                    STX2    8,,PR0

  22360 31 002201   777777 223003                    LDX3    -1,DU
        31 002202   200012 470500                    LDP0    RETURN$,,AUTO
        31 002203   000010 443100                    SXL3    8,,PR0

  22365 31 002204   000013 236000 32                 LDQ     11
        31 002205   200012 470500                    LDP0    RETURN$,,AUTO
        31 002206   000012 756100                    STQ     10,,PR0

  22368 31 002207   000057 236000 xsym               LDQ     O1COM+47
        31 002210   200012 470500                    LDP0    RETURN$,,AUTO
        31 002211   000011 756100                    STQ     9,,PR0

  22369 31 002212   000057 236000 xsym               LDQ     O1COM+47
        31 002213   000013 116000 32                 CMPQ    11
        31 002214   002240 600000 31                 TZE     s:22413

  22373 31 002215   000057 470400 xsym               LDP0    O1COM+47
        31 002216   000001 471500                    LDP1    1,,PR0
        31 002217   100012 236100                    LDQ     10,,PR1
        31 002220   000013 116000 32                 CMPQ    11
        31 002221   002231 601000 31                 TNZ     s:22380

  22375 31 002222   200012 236100                    LDQ     RETURN$,,AUTO
        31 002223   100011 756100                    STQ     9,,PR1

  22376 31 002224   000057 470400 xsym               LDP0    O1COM+47
        31 002225   000001 471500                    LDP1    1,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:131  
        31 002226   200012 236100                    LDQ     RETURN$,,AUTO
        31 002227   100012 756100                    STQ     10,,PR1

  22377 31 002230   002240 710000 31                 TRA     s:22413

  22380 31 002231   100012 473500                    LDP3    10,,PR1
        31 002232   200012 236100                    LDQ     RETURN$,,AUTO
        31 002233   300012 756100                    STQ     10,,PR3

  22381 31 002234   000057 470400 xsym               LDP0    O1COM+47
        31 002235   000001 471500                    LDP1    1,,PR0
        31 002236   200012 236100                    LDQ     RETURN$,,AUTO
        31 002237   100012 756100                    STQ     10,,PR1

      796    22405
      797    22406                    %NEW_QLT(   @POINTER  = NEW_QLT$,
      798    22407                                @DNT$     = NEW_DNT$,
      799    22408                                @ST$      = RETURN$);

  22413 31 002240   000002 236000 6                  LDQ     QLT_+2
        31 002241   000006 036007                    ADLQ    6,DL
        31 002242   000003 116000 6                  CMPQ    QLT_+3
        31 002243   002254 602000 31                 TNC     s:22415

  22414 31 002244   000042 236000 32                 LDQ     34
        31 002245   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 002246   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 002247   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 002250   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 002251   000005 631400 32                 EPPR1   5
        31 002252   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 002253   000000 011000                    NOP     0

  22415 31 002254   000002 236000 6                  LDQ     QLT_+2
        31 002255   000022 736000                    QLS     18
        31 002256   000001 036000 6                  ADLQ    QLT_+1
        31 002257   200010 756100                    STQ     NEW_QLT$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:132  

  22416 31 002260   000002 235000 6                  LDA     QLT_+2
        31 002261   000006 035007                    ADLA    6,DL
        31 002262   000002 755000 6                  STA     QLT_+2

  22417 31 002263   001053 220003                    LDX0    555,DU
        31 002264   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 002265   000000 740100                    STX0    0,,PR0

  22420 31 002266   000013 236000 32                 LDQ     11
        31 002267   000001 756100                    STQ     1,,PR0

  22421 31 002270   000013 236000 32                 LDQ     11
        31 002271   000002 756100                    STQ     2,,PR0

  22422 31 002272   000013 236000 32                 LDQ     11
        31 002273   000003 756100                    STQ     3,,PR0

  22423 31 002274   200012 236100                    LDQ     RETURN$,,AUTO
        31 002275   000004 756100                    STQ     4,,PR0

  22424 31 002276   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 002277   000005 756100                    STQ     5,,PR0

  22425 31 002300   000001 236007                    LDQ     1,DL
        31 002301   000000 552104                    STBQ    0,'04'O,PR0

  22426 31 002302   000000 236003                    LDQ     0,DU
        31 002303   000000 552110                    STBQ    0,'10'O,PR0

  22427 31 002304   000043 236000 32                 LDQ     35
        31 002305   000000 356100                    ANSQ    0,,PR0

  22428 31 002306   000044 236000 32                 LDQ     36
        31 002307   000000 356100                    ANSQ    0,,PR0

  22429 31 002310   000045 236000 32                 LDQ     37
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:133  
        31 002311   000000 356100                    ANSQ    0,,PR0

  22430 31 002312   000046 236000 32                 LDQ     38
        31 002313   000000 356100                    ANSQ    0,,PR0

      800    22433
      801    22434    3               RETURN$ -> DML_ITEM.QLT$ = NEW_QLT$;

  22434 31 002314   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 002315   200012 471500                    LDP1    RETURN$,,AUTO
        31 002316   100007 756100                    STQ     7,,PR1

      802    22435                    %UPDATE_PREV_QLT$ (@NEW_QLT$ = NEW_QLT$);

  22437 31 002317   000424 236000 xsym               LDQ     COMCOM+276
        31 002320   000013 116000 32                 CMPQ    11
        31 002321   002325 600000 31                 TZE     s:22439

  22438 31 002322   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 002323   000424 471400 xsym               LDP1    COMCOM+276
        31 002324   100002 756100                    STQ     2,,PR1

  22439 31 002325   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 002326   000424 756000 xsym               STQ     COMCOM+276

      803    22442    3               NEW_DNT$ -> DNT.ST$ = RETURN$;

  22442 31 002327   200012 236100                    LDQ     RETURN$,,AUTO
        31 002330   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 002331   100001 756100                    STQ     1,,PR1

      804    22443
      805    22444    3               CALL Z9DM$GET_SUB_SCHEMA(RETURN_PTR$ );

  22444 31 002332   200007 631500                    EPPR1   RETURN_PTR$,,AUTO
        31 002333   200624 451500                    STP1    LINE_NUMBER+1,,AUTO
        31 002334   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:134  
        31 002335   000005 631400 32                 EPPR1   5
        31 002336   000000 701000 xent               TSX1    Z9DM$GET_SUB_SCHEMA
        31 002337   000000 011000                    NOP     0

      806    22445
      807    22446    3             END;      /*V*     IDS  II  TOKENS  */

  22446 31 002340   002676 710000 31                 TRA     s:22798

      808    22447        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:135  
      809    22448    2       ELSE
      810    22449    3         DO;                               /*V*  TYPE 31, 32, OR 33    */

      811    22450    3           IF TOKEN_9.TYPE = %TYPE_31 OR TOKEN_9.TYPE = %TYPE_32    THEN

  22450 31 002341   000037 115007                    CMPA    31,DL
        31 002342   002345 600000 31                 TZE     s:22452
        31 002343   000040 115007                    CMPA    32,DL
        31 002344   002670 601000 31                 TNZ     s:22794

      812    22451    4             DO;

      813    22452    4               CURRENT_PTR$ = HEAD_UWA_QLT$;

  22452 31 002345   200013 236100                    LDQ     HEAD_UWA_QLT$,,AUTO
        31 002346   200020 756100                    STQ     CURRENT_PTR$,,AUTO

      814    22453    4               WORD_OFFSET = TOKEN_9.LINE_NUMBER / 4;

  22453 31 002347   000001 236100                    LDQ     1,,PR0
        31 002350   000002 772000                    QRL     2
        31 002351   000000 620006                    EAX0    0,QL
        31 002352   200040 740100                    STX0    WORD_OFFSET,,AUTO

      815    22454    4               FOUND = %FALSE;

  22454 31 002353   200131 450100                    STZ     FOUND,,AUTO

      816    22455    5               DO UNTIL FOUND OR (CURRENT_PTR$ = ADDR(NIL));

      817    22456    5                   IF CURRENT_PTR$ -> QLT.ST$ -> SCALAR.SA = WORD_OFFSET THEN

  22456 31 002354   200020 470500                    LDP0    CURRENT_PTR$,,AUTO
        31 002355   000004 471500                    LDP1    4,,PR0
        31 002356   100001 220100                    LDX0    1,,PR1
        31 002357   200040 100100                    CMPX0   WORD_OFFSET,,AUTO
        31 002360   002410 601000 31                 TNZ     s:22506
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:136  

      818    22457    6                     DO;

      819    22458    6                       FOUND = TRUE;

  22458 31 002361   400000 236003                    LDQ     -131072,DU
        31 002362   200131 756100                    STQ     FOUND,,AUTO

      820    22459                            %GET_LTS (@ID      = %DML_REC,
      821    22460                                      @ST$     = "CURRENT_PTR$ -> QLT.ST$",
      822    22461                                      @RETURN$ = CURRENT_LTS$);

  22463 31 002363   100005 236100                    LDQ     5,,PR1
        31 002364   000013 116000 32                 CMPQ    11
        31 002365   002375 600000 31                 TZE     s:22497
        31 002366   100005 473500                    LDP3    5,,PR1
        31 002367   300000 221100                    LDX1    0,,PR3
        31 002370   001105 101003                    CMPX1   581,DU
        31 002371   002375 601000 31                 TNZ     s:22497

  22487 31 002372   300007 236100                    LDQ     7,,PR3
        31 002373   200021 756100                    STQ     CURRENT_LTS$,,AUTO

  22495 31 002374   002412 710000 31                 TRA     s:22508

  22497 31 002375   000013 116000 32                 CMPQ    11
        31 002376   002405 600000 31                 TZE     s:22501
        31 002377   100005 473500                    LDP3    5,,PR1
        31 002400   300000 221100                    LDX1    0,,PR3
        31 002401   001125 101003                    CMPX1   597,DU
        31 002402   002405 601000 31                 TNZ     s:22501

  22499 31 002403   200021 756100                    STQ     CURRENT_LTS$,,AUTO
        31 002404   002412 710000 31                 TRA     s:22508

  22501 31 002405   000013 236000 32                 LDQ     11
        31 002406   200021 756100                    STQ     CURRENT_LTS$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:137  

      823    22504    6                     END;

  22504 31 002407   002412 710000 31                 TRA     s:22508

      824    22505    5                   ELSE
      825    22506    5                       CURRENT_PTR$ = CURRENT_PTR$ -> QLT.BROTHER;

  22506 31 002410   000002 236100                    LDQ     2,,PR0
        31 002411   200020 756100                    STQ     CURRENT_PTR$,,AUTO

      826    22507
      827    22508    5               END;

  22508 31 002412   200131 234100                    SZN     FOUND,,AUTO
        31 002413   002417 604000 31                 TMI     s:22510
        31 002414   200020 236100                    LDQ     CURRENT_PTR$,,AUTO
        31 002415   000013 116000 32                 CMPQ    11
        31 002416   002354 601000 31                 TNZ     s:22456

      828    22509
      829    22510    5               IF FOUND = FALSE THEN DO;

  22510 31 002417   200131 234100                    SZN     FOUND,,AUTO
        31 002420   002435 604000 31                 TMI     s:22517

      830    22511    5                 CALL Z8AE$ERROR (%E$ILLEGAL_TYPE_31_32_RECORD);

  22511 31 002421   000050 630400 32                 EPPR0   40
        31 002422   000005 631400 32                 EPPR1   5
        31 002423   000000 701000 xent               TSX1    Z8AE$ERROR
        31 002424   000000 011000                    NOP     0

      831    22512    5                 CALL Z8AE$ERROR (%E$SCHEMA_SUB_SCHEMA_ERROR);

  22512 31 002425   000007 630400 32                 EPPR0   7
        31 002426   000005 631400 32                 EPPR1   5
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:138  
        31 002427   000000 701000 xent               TSX1    Z8AE$ERROR
        31 002430   000000 011000                    NOP     0

      832    22513                      /* Subschema file is in inconsistent state.
      833    22514                         Recovery is not possible. */
      834    22515    5                 CALL Z9AT$TERMINATOR;

  22515 31 002431   000010 631400 32                 EPPR1   8
        31 002432   000000 701000 xent               TSX1    Z9AT$TERMINATOR
        31 002433   000000 011000                    NOP     0

      835    22516    5               END;

  22516 31 002434   002670 710000 31                 TRA     s:22794

      836    22517    5               ELSE IF TOKEN_9.TYPE = %TYPE_31 THEN DO;

  22517 31 002435   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 002436   000003 235100                    LDA     3,,PR0
        31 002437   000037 115007                    CMPA    31,DL
        31 002440   002567 601000 31                 TNZ     s:22646

      837    22518                      %TOP_QLT (POINTER=CURRENT_PTR$);

  22520 31 002441   000000 236000 6                  LDQ     QLT_
        31 002442   200020 756100                    STQ     CURRENT_PTR$,,AUTO

      838    22523    5                 REALM_NO = TOKEN_9.COLUMN; /* FOR TYPE 31, REALM NUMBER */

  22523 31 002443   000002 235100                    LDA     2,,PR0
        31 002444   200036 755100                    STA     REALM_NO,,AUTO

      839    22524    5                 FOUND = %FALSE;

  22524 31 002445   200131 450100                    STZ     FOUND,,AUTO

      840    22525    6                 DO UNTIL FOUND OR (CURRENT_PTR$ = ADDR(NIL));
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:139  

      841    22526    6                   IF CURRENT_PTR$ -> QLT.ST$ -> ST.ID = %REALM AND

  22526 31 002446   200020 470500                    LDP0    CURRENT_PTR$,,AUTO
        31 002447   000004 471500                    LDP1    4,,PR0
        31 002450   100000 220100                    LDX0    0,,PR1
        31 002451   000752 100003                    CMPX0   490,DU
        31 002452   002461 601000 31                 TNZ     s:22530
        31 002453   100001 236100                    LDQ     1,,PR1
        31 002454   200036 116100                    CMPQ    REALM_NO,,AUTO
        31 002455   002461 601000 31                 TNZ     s:22530

      842    22527    6                       CURRENT_PTR$ -> QLT.ST$ -> DML_ITEM.INTERNAL_NAME = REALM_NO
             22527                                THEN
      843    22528    6                     FOUND = TRUE;

  22528 31 002456   400000 236003                    LDQ     -131072,DU
        31 002457   200131 756100                    STQ     FOUND,,AUTO
        31 002460   002463 710000 31                 TRA     s:22531

      844    22529    6                   ELSE
      845    22530    6                     CURRENT_PTR$ = CURRENT_PTR$ -> QLT.BROTHER;

  22530 31 002461   000002 236100                    LDQ     2,,PR0
        31 002462   200020 756100                    STQ     CURRENT_PTR$,,AUTO

      846    22531    6                 END;

  22531 31 002463   200131 234100                    SZN     FOUND,,AUTO
        31 002464   002470 604000 31                 TMI     s:22532
        31 002465   200020 236100                    LDQ     CURRENT_PTR$,,AUTO
        31 002466   000013 116000 32                 CMPQ    11
        31 002467   002446 601000 31                 TNZ     s:22526

      847    22532    5                 IF FOUND THEN

  22532 31 002470   200131 234100                    SZN     FOUND,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:140  
        31 002471   002502 605000 31                 TPL     s:22535

      848    22533    5                   CURRENT_LTS$ -> DML_REC.RECORD_INFO.RECORD_PARTIAL_DESCRIBED =

  22533 31 002472   200020 470500                    LDP0    CURRENT_PTR$,,AUTO
        31 002473   000004 471500                    LDP1    4,,PR0
        31 002474   200021 473500                    LDP3    CURRENT_LTS$,,AUTO
        31 002475   100003 236100                    LDQ     3,,PR1
        31 002476   000033 736000                    QLS     27
        31 002477   300001 676100                    ERQ     1,,PR3
        31 002500   200000 376003                    ANQ     65536,DU
        31 002501   300001 656100                    ERSQ    1,,PR3

      849    22534    5                       CURRENT_PTR$ -> QLT.ST$ -> DML_ITEM.B.INDEXED_REALM;
      850    22535    6                 DO WHILE(CURRENT_LTS$ -> DML_REC.REALM_RELATIONSHIP

  22535 31 002502   200021 470500                    LDP0    CURRENT_LTS$,,AUTO
        31 002503   000001 236100                    LDQ     1,,PR0
        31 002504   000020 316003                    CANQ    16,DU
        31 002505   002553 600000 31                 TZE     s:22638

      851    22536    6                                                              = TRUE);
      852    22537    6                     IF CURRENT_LTS$ -> DML_REC.EXTEND$ = ADDR(NIL)  THEN

  22537 31 002506   200021 470500                    LDP0    CURRENT_LTS$,,AUTO
        31 002507   000005 236100                    LDQ     5,,PR0
        31 002510   000013 116000 32                 CMPQ    11
        31 002511   002546 601000 31                 TNZ     s:22634

      853    22538    7                       DO;

      854    22539                              %NEW_EXT_DML( @POINTER  = NEW_LTS$);

  22617 31 002512   000002 236000 8                  LDQ     LTS_+2
        31 002513   000006 036007                    ADLQ    6,DL
        31 002514   000003 116000 8                  CMPQ    LTS_+3
        31 002515   002526 604000 31                 TMI     s:22619
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:141  

  22618 31 002516   000027 236000 32                 LDQ     23
        31 002517   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 002520   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 002521   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 002522   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 002523   000005 631400 32                 EPPR1   5
        31 002524   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 002525   000000 011000                    NOP     0

  22619 31 002526   000002 236000 8                  LDQ     LTS_+2
        31 002527   000022 736000                    QLS     18
        31 002530   000001 036000 8                  ADLQ    LTS_+1
        31 002531   200016 756100                    STQ     NEW_LTS$,,AUTO

  22620 31 002532   000006 236007                    LDQ     6,DL
        31 002533   000002 056000 8                  ASQ     LTS_+2

  22621 31 002534   001125 220003                    LDX0    597,DU
        31 002535   200016 470500                    LDP0    NEW_LTS$,,AUTO
        31 002536   000000 740100                    STX0    0,,PR0

  22627 31 002537   000013 236000 32                 LDQ     11
        31 002540   000005 756100                    STQ     5,,PR0

      855    22630    7                         CURRENT_LTS$ -> DML_REC.EXTEND$ = NEW_LTS$;

  22630 31 002541   200016 236100                    LDQ     NEW_LTS$,,AUTO
        31 002542   200021 471500                    LDP1    CURRENT_LTS$,,AUTO
        31 002543   100005 756100                    STQ     5,,PR1

      856    22631    7                         CURRENT_LTS$ = NEW_LTS$;

  22631 31 002544   200021 756100                    STQ     CURRENT_LTS$,,AUTO

      857    22632    7                       END;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:142  
  22632 31 002545   002547 710000 31                 TRA     s:22636

      858    22633    6                     ELSE
      859    22634    6                         CURRENT_LTS$ = CURRENT_LTS$ -> DML_REC.EXTEND$;

  22634 31 002546   200021 756100                    STQ     CURRENT_LTS$,,AUTO

      860    22635
      861    22636    6                 END;    /*     WHILE     */

  22636 31 002547   200021 470500                    LDP0    CURRENT_LTS$,,AUTO
        31 002550   000001 236100                    LDQ     1,,PR0
        31 002551   000020 316003                    CANQ    16,DU
        31 002552   002506 601000 31                 TNZ     s:22537

      862    22637
      863    22638    5                 CURRENT_LTS$ -> DML_REC.REALM_RELATIONSHIP = TRUE;

  22638 31 002553   000020 236003                    LDQ     16,DU
        31 002554   000001 256100                    ORSQ    1,,PR0

      864    22639    5                 CURRENT_LTS$ -> DML_REC.REALM_NAME = TOKEN_9.COLUMN;

  22639 31 002555   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 002556   100002 235100                    LDA     2,,PR1
        31 002557   000002 755100                    STA     2,,PR0

      865    22640    5                 CURRENT_LTS$ -> DML_REC.REALM_INFO.TEMP_AREA =

  22640 31 002560   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 002561   100004 236100                    LDQ     4,,PR1
        31 002562   000014 772000                    QRL     12
        31 002563   000001 676100                    ERQ     1,,PR0
        31 002564   000040 376003                    ANQ     32,DU
        31 002565   000001 656100                    ERSQ    1,,PR0

      866    22641    5                                                   TOKEN_9.WORD4.BIT0;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:143  
      867    22642    5               END;

  22642 31 002566   002670 710000 31                 TRA     s:22794

      868    22643            %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:144  
      869    22644    5               ELSE DO; /* %TYPE_32 */

      870    22645
      871    22646    6                       DO WHILE(CURRENT_LTS$ -> DML_REC.SET_RELATIONSHIP

  22646 31 002567   200021 471500                    LDP1    CURRENT_LTS$,,AUTO
        31 002570   100001 236100                    LDQ     1,,PR1
        31 002571   000010 316003                    CANQ    8,DU
        31 002572   002640 600000 31                 TZE     s:22750

      872    22647    6                                                                    = TRUE);
      873    22648    6                           IF CURRENT_LTS$ -> DML_REC.EXTEND$ = ADDR(NIL)  THEN

  22648 31 002573   200021 470500                    LDP0    CURRENT_LTS$,,AUTO
        31 002574   000005 236100                    LDQ     5,,PR0
        31 002575   000013 116000 32                 CMPQ    11
        31 002576   002633 601000 31                 TNZ     s:22746

      874    22649    7                             DO;

      875    22650                                    %NEW_EXT_DML( @POINTER  = NEW_LTS$);

  22728 31 002577   000002 236000 8                  LDQ     LTS_+2
        31 002600   000006 036007                    ADLQ    6,DL
        31 002601   000003 116000 8                  CMPQ    LTS_+3
        31 002602   002613 604000 31                 TMI     s:22730

  22729 31 002603   000027 236000 32                 LDQ     23
        31 002604   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 002605   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 002606   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 002607   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 002610   000005 631400 32                 EPPR1   5
        31 002611   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 002612   000000 011000                    NOP     0

  22730 31 002613   000002 236000 8                  LDQ     LTS_+2
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:145  
        31 002614   000022 736000                    QLS     18
        31 002615   000001 036000 8                  ADLQ    LTS_+1
        31 002616   200016 756100                    STQ     NEW_LTS$,,AUTO

  22731 31 002617   000006 236007                    LDQ     6,DL
        31 002620   000002 056000 8                  ASQ     LTS_+2

  22732 31 002621   001125 220003                    LDX0    597,DU
        31 002622   200016 470500                    LDP0    NEW_LTS$,,AUTO
        31 002623   000000 740100                    STX0    0,,PR0

  22738 31 002624   000013 236000 32                 LDQ     11
        31 002625   000005 756100                    STQ     5,,PR0

      876    22741    7                               CURRENT_LTS$ -> DML_REC.EXTEND$ = NEW_LTS$;

  22741 31 002626   200016 236100                    LDQ     NEW_LTS$,,AUTO
        31 002627   200021 471500                    LDP1    CURRENT_LTS$,,AUTO
        31 002630   100005 756100                    STQ     5,,PR1

      877    22742    7                               CURRENT_LTS$ = NEW_LTS$;

  22742 31 002631   200021 756100                    STQ     CURRENT_LTS$,,AUTO

      878    22743    7                             END;

  22743 31 002632   002634 710000 31                 TRA     s:22748

      879    22744
      880    22745    6                           ELSE
      881    22746    6                               CURRENT_LTS$ = CURRENT_LTS$ -> DML_REC.EXTEND$;

  22746 31 002633   200021 756100                    STQ     CURRENT_LTS$,,AUTO

      882    22747
      883    22748    6                       END;   /*V*     WHILE     */

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:146  
  22748 31 002634   200021 470500                    LDP0    CURRENT_LTS$,,AUTO
        31 002635   000001 236100                    LDQ     1,,PR0
        31 002636   000010 316003                    CANQ    8,DU
        31 002637   002573 601000 31                 TNZ     s:22648

      884    22749
      885    22750    5                       CURRENT_LTS$ -> DML_REC.SET_RELATIONSHIP = TRUE;

  22750 31 002640   200021 470500                    LDP0    CURRENT_LTS$,,AUTO
        31 002641   000010 236003                    LDQ     8,DU
        31 002642   000001 256100                    ORSQ    1,,PR0

      886    22751    5                       CURRENT_LTS$ -> DML_REC.SET_NAME = TOKEN_9.COLUMN;

  22751 31 002643   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 002644   100002 235100                    LDA     2,,PR1
        31 002645   000003 755100                    STA     3,,PR0

      887    22752    5                       CURRENT_LTS$ -> DML_REC.SET_INFO.MODIFY_ONLY_NOT_PERMITTED =

  22752 31 002646   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 002647   100004 236100                    LDQ     4,,PR1
        31 002650   000007 772000                    QRL     7
        31 002651   000001 676100                    ERQ     1,,PR0
        31 002652   000100 376003                    ANQ     64,DU
        31 002653   000001 656100                    ERSQ    1,,PR0

      888    22753    5                                                         TOKEN_9.WORD4.BIT4;
      889    22754
      890    22755    5                       IF TOKEN_9.WORD4.BIT0 = TRUE  THEN

  22755 31 002654   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 002655   100004 234100                    SZN     4,,PR1
        31 002656   002661 605000 31                 TPL     s:22764

      891    22756    5                             MEMBERSHIP = %OWNER;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:147  
  22756 31 002657   200041 450100                    STZ     MEMBERSHIP,,AUTO
        31 002660   002663 710000 31                 TRA     s:22766

      892    22757    5                       ELSE
      893    22758                            /*  IF TOKEN_9.WORD4.BIT1 = TRUE  THEN
      894    22759                                    MEMBERSHIP = %MEMBER;
      895    22760                                ELSE
      896    22761                                    IF TOKEN_9.WORD4.BIT2 = TRUE  THEN
      897    22762                                        MEMBERSHIP = %MEMBER_OPT;
      898    22763                                    ELSE      **  NEVER REFERENCED  ** */
      899    22764    5                                   MEMBERSHIP = %MEMBER_MANUAL;

  22764 31 002661   600000 236003                    LDQ     -65536,DU
        31 002662   200041 756100                    STQ     MEMBERSHIP,,AUTO

      900    22765
      901    22766    5                       CURRENT_LTS$ -> DML_REC.SET_INFO.MEMBERSHIP =MEMBERSHIP;

  22766 31 002663   200041 236100                    LDQ     MEMBERSHIP,,AUTO
        31 002664   000011 772000                    QRL     9
        31 002665   000001 676100                    ERQ     1,,PR0
        31 002666   000600 376003                    ANQ     384,DU
        31 002667   000001 656100                    ERSQ    1,,PR0

      902    22767            %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:148  
      903    22768             /*         CASE(%TYPE_33);
      904    22769                            DO WHILE(CURRENT_LTS$ -> DML_REC.KEY_RELATIONSHIP
      905    22770                                                                         = TRUE);
      906    22771                                IF CURRENT_LTS$ -> DML_REC.EXTEND$ = ADDR(NIL)  THEN
      907    22772                                  DO;
      908    22773                                    %NEW_EXT_DML( @POINTER  = NEW_LTS$);
      909    22774                                    CURRENT_LTS$ -> DML_REC.EXTEND$ = NEW_LTS$;
      910    22775                                    CURRENT_LTS$ = NEW_LTS$;
      911    22776                                  END;
      912    22777
      913    22778                                ELSE
      914    22779                                    CURRENT_LTS$ = CURRENT_LTS$ -> DML_REC.EXTEND$;
      915    22780
      916    22781                            END;    *V*     WHILE        *
      917    22782
      918    22783                            CURRENT_LTS$ -> DML_REC.KEY_RELATIONSHIP = TRUE;
      919    22784                            CURRENT_LTS$ -> DML_REC.KEY_NAME =TOKEN_9.COLUMN;
      920    22785
      921    22786
      922    22787                    END;    *V*     CASE                   */
      923    22788
      924    22789    5               END; /* %TYPE_32 */

      925    22790
      926    22791    4             END;            /*  IF TYPE_31 OR TYPE_32   */

      927    22792
      928    22793
      929    22794    3           CALL Z9DM$GET_SUB_SCHEMA(RETURN_PTR$ );

  22794 31 002670   200007 630500                    EPPR0   RETURN_PTR$,,AUTO
        31 002671   200624 450500                    STP0    LINE_NUMBER+1,,AUTO
        31 002672   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 002673   000005 631400 32                 EPPR1   5
        31 002674   000000 701000 xent               TSX1    Z9DM$GET_SUB_SCHEMA
        31 002675   000000 011000                    NOP     0

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:149  
      930    22795
      931    22796    3         END;                              /*V*   TYPE 31, 32, 33  */

      932    22797
      933    22798    2   END;      /*V*    WHILE    */

  22798 31 002676   200007 236100                    LDQ     RETURN_PTR$,,AUTO
        31 002677   000013 116000 32                 CMPQ    11
        31 002700   000431 601000 31                 TNZ     s:21685

      934    22799
      935    22800    1   IF NEED_DUMMY_BUF THEN

  22800 31 002701   000000 234000 29                 SZN     NEED_DUMMY_BUF
        31 002702   002716 605000 31                 TPL     s:22812

      936    22801    2     DO;

      937    22802    2       LINE_LIST$ = HEAD$ -> FILL_BUFFER.NEXT$;

  22802 31 002703   200022 470500                    LDP0    HEAD$,,AUTO
        31 002704   000002 236100                    LDQ     2,,PR0
        31 002705   000000 756000 20                 STQ     LINE_LIST$

      938    22803            %DISPOSE_HEAP (@POINTER = HEAD$, @SIZE = %MAX_INPUT_BUFFER_LEN);

  22805 31 002706   000023 236000 32                 LDQ     19
        31 002707   200625 756100                    STQ     LINE_NUMBER+2,,AUTO
        31 002710   200022 631500                    EPPR1   HEAD$,,AUTO
        31 002711   200624 451500                    STP1    LINE_NUMBER+1,,AUTO
        31 002712   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 002713   000021 631400 32                 EPPR1   17
        31 002714   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        31 002715   000000 011000                    NOP     0

      939    22808    2     END;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:150  
      940    22809        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:151  
      941    22810         /*V*      BUILDING THE DML STATUS REGISTERS      */
      942    22811
      943    22812    1   DESC.DESCL = 0;

  22812 31 002716   000000 220003                    LDX0    0,DU
        31 002717   200132 740100                    STX0    DESC,,AUTO

      944    22813    1   SA = REGISTER_OFFSET(0) / 4;

  22813 31 002720   000043 236000 29                 LDQ     REGISTER_OFFSET
        31 002721   000022 772000                    QRL     18
        31 002722   000002 772000                    QRL     2
        31 002723   000000 621006                    EAX1    0,QL
        31 002724   200037 741100                    STX1    SA,,AUTO

      945    22814    1   DESC.NUM_NDSC.CN = REGISTER_OFFSET(0) - (SA * 4);

  22814 31 002725   000043 235000 29                 LDA     REGISTER_OFFSET
        31 002726   000022 771000                    ARL     18
        31 002727   200624 755100                    STA     LINE_NUMBER+1,,AUTO
        31 002730   200037 236100                    LDQ     SA,,AUTO
        31 002731   777777 376003                    ANQ     -1,DU
        31 002732   000020 772000                    QRL     16
        31 002733   000024 676000 32                 ERQ     20
        31 002734   000001 036007                    ADLQ    1,DL
        31 002735   200624 036100                    ADLQ    LINE_NUMBER+1,,AUTO
        31 002736   000041 736000                    QLS     33
        31 002737   200132 676100                    ERQ     DESC,,AUTO
        31 002740   700000 376003                    ANQ     -32768,DU
        31 002741   200132 656100                    ERSQ    DESC,,AUTO

      946    22815    1   DESC.NUM_NDSC.TN = '0'B;

  22815 31 002742   000025 236000 32                 LDQ     21
        31 002743   200132 356100                    ANSQ    DESC,,AUTO

      947    22816    1   DESC.NUM_NDSC.S = %NO_SIGN;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:152  

  22816 31 002744   030000 236003                    LDQ     12288,DU
        31 002745   200132 256100                    ORSQ    DESC,,AUTO

      948    22817    1   DESC.NUM_NDSC.N = REGISTER_LENGTH(0);

  22817 31 002746   000063 236000 29                 LDQ     REGISTER_LENGTH
        31 002747   200132 752110                    STCQ    DESC,'10'O,AUTO

      949    22818
      950    22819    1  CALL Z8AH$NEW_DNT(SUBSTR(REGISTER_NAME(0),0,NAME_LENGTH(0)),NAME_LENGTH(0),NEW_DNT$)
             22819            ;

  22819 31 002750   200014 630500                    EPPR0   NEW_DNT$,,AUTO
        31 002751   200626 450500                    STP0    LINE_NUMBER+3,,AUTO
        31 002752   000052 237000 32                 LDAQ    42
        31 002753   200624 757100                    STAQ    LINE_NUMBER+1,,AUTO
        31 002754   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 002755   000000 631400 32                 EPPR1   0
        31 002756   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 002757   000000 011000                    NOP     0

      951    22820
      952    22821        %NEW_SCALAR( @ST$   = RETURN$,
      953    22822                     @DESCL = DESC.DESCL,
      954    22823                     @NEXT  = NEW_DNT$ -> DNT.ST$,
      955    22824                     @COUNT = O1COM.DML_UWA$ -> BLOCK.COUNT,
      956    22825                     @SA    = SA,
      957    22826                     @CLASS = %CLASS_NUMERIC,
      958    22827                     @ELEMENTARY = TRUE,
      959    22828                     @GLOBAL     = TRUE,
      960    22829                     @EXTERNAL   = TRUE,
      961    22830                     @COMPILER_CREATED = TRUE,
      962    22831                     @DNT$  = NEW_DNT$,
      963    22832                     @TYPE  = %TYD,
      964    22833                     @DML_UWA = TRUE,
      965    22834                     @DML_TYPE = %DML_REG);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:153  

  22838 31 002760   000002 236000 3                  LDQ     ST_+2
        31 002761   000013 036007                    ADLQ    11,DL
        31 002762   000003 116000 3                  CMPQ    ST_+3
        31 002763   002774 604000 31                 TMI     s:22840

  22839 31 002764   000014 236000 32                 LDQ     12
        31 002765   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 002766   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 002767   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 002770   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 002771   000005 631400 32                 EPPR1   5
        31 002772   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 002773   000000 011000                    NOP     0

  22840 31 002774   000002 236000 3                  LDQ     ST_+2
        31 002775   000022 736000                    QLS     18
        31 002776   000001 036000 3                  ADLQ    ST_+1
        31 002777   200012 756100                    STQ     RETURN$,,AUTO

  22841 31 003000   000013 236007                    LDQ     11,DL
        31 003001   000002 056000 3                  ASQ     ST_+2

  22889 31 003002   000766 220003                    LDX0    502,DU
        31 003003   200012 470500                    LDP0    RETURN$,,AUTO
        31 003004   000000 740100                    STX0    0,,PR0

  22890 31 003005   200012 470500                    LDP0    RETURN$,,AUTO
        31 003006   003000 236007                    LDQ     1536,DL
        31 003007   000000 552110                    STBQ    0,'10'O,PR0

  22891 31 003010   000077 470400 xsym               LDP0    O1COM+63
        31 003011   200012 471500                    LDP1    RETURN$,,AUTO
        31 003012   000000 236100                    LDQ     0,,PR0
        31 003013   100000 552104                    STBQ    0,'04'O,PR1

  22892 31 003014   200037 221100                    LDX1    SA,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:154  
        31 003015   200012 470500                    LDP0    RETURN$,,AUTO
        31 003016   000001 741100                    STX1    1,,PR0

  22893 31 003017   200132 222100                    LDX2    DESC,,AUTO
        31 003020   200012 470500                    LDP0    RETURN$,,AUTO
        31 003021   000001 442100                    SXL2    1,,PR0

  22894 31 003022   000133 723000 xsym               LXL3    COMCOM+91
        31 003023   200012 470500                    LDP0    RETURN$,,AUTO
        31 003024   000002 443100                    SXL3    2,,PR0

  22895 31 003025   200012 470500                    LDP0    RETURN$,,AUTO
        31 003026   000003 450100                    STZ     3,,PR0

  22896 31 003027   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 003030   000001 236100                    LDQ     1,,PR0
        31 003031   200012 471500                    LDP1    RETURN$,,AUTO
        31 003032   100004 756100                    STQ     4,,PR1

  22897 31 003033   000013 236000 32                 LDQ     11
        31 003034   200012 470500                    LDP0    RETURN$,,AUTO
        31 003035   000005 756100                    STQ     5,,PR0

  22898 31 003036   000013 236000 32                 LDQ     11
        31 003037   200012 470500                    LDP0    RETURN$,,AUTO
        31 003040   000007 756100                    STQ     7,,PR0

  22899 31 003041   000000 223003                    LDX3    0,DU
        31 003042   200012 470500                    LDP0    RETURN$,,AUTO
        31 003043   000010 743100                    STX3    8,,PR0

  22900 31 003044   777777 224003                    LDX4    -1,DU
        31 003045   200012 470500                    LDP0    RETURN$,,AUTO
        31 003046   000010 444100                    SXL4    8,,PR0

  22904 31 003047   000013 236000 32                 LDQ     11
        31 003050   200012 470500                    LDP0    RETURN$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:155  
        31 003051   000012 756100                    STQ     10,,PR0

  22907 31 003052   000057 236000 xsym               LDQ     O1COM+47
        31 003053   200012 470500                    LDP0    RETURN$,,AUTO
        31 003054   000011 756100                    STQ     9,,PR0

  22908 31 003055   000057 236000 xsym               LDQ     O1COM+47
        31 003056   000013 116000 32                 CMPQ    11
        31 003057   003103 600000 31                 TZE     s:22943

  22912 31 003060   000057 470400 xsym               LDP0    O1COM+47
        31 003061   000001 471500                    LDP1    1,,PR0
        31 003062   100012 236100                    LDQ     10,,PR1
        31 003063   000013 116000 32                 CMPQ    11
        31 003064   003074 601000 31                 TNZ     s:22919

  22914 31 003065   200012 236100                    LDQ     RETURN$,,AUTO
        31 003066   100011 756100                    STQ     9,,PR1

  22915 31 003067   000057 470400 xsym               LDP0    O1COM+47
        31 003070   000001 471500                    LDP1    1,,PR0
        31 003071   200012 236100                    LDQ     RETURN$,,AUTO
        31 003072   100012 756100                    STQ     10,,PR1

  22916 31 003073   003103 710000 31                 TRA     s:22943

  22919 31 003074   100012 473500                    LDP3    10,,PR1
        31 003075   200012 236100                    LDQ     RETURN$,,AUTO
        31 003076   300012 756100                    STQ     10,,PR3

  22920 31 003077   000057 470400 xsym               LDP0    O1COM+47
        31 003100   000001 471500                    LDP1    1,,PR0
        31 003101   200012 236100                    LDQ     RETURN$,,AUTO
        31 003102   100012 756100                    STQ     10,,PR1

  22943 31 003103   200012 470500                    LDP0    RETURN$,,AUTO
        31 003104   000002 743100                    STX3    2,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:156  

  22948 31 003105   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 003106   200012 470500                    LDP0    RETURN$,,AUTO
        31 003107   000006 756100                    STQ     6,,PR0

  22965 31 003110   200012 470500                    LDP0    RETURN$,,AUTO
        31 003111   010000 236003                    LDQ     4096,DU
        31 003112   000003 256100                    ORSQ    3,,PR0

  22974 31 003113   200012 470500                    LDP0    RETURN$,,AUTO
        31 003114   100000 236003                    LDQ     32768,DU
        31 003115   000003 256100                    ORSQ    3,,PR0

  22995 31 003116   200012 470500                    LDP0    RETURN$,,AUTO
        31 003117   000004 236003                    LDQ     4,DU
        31 003120   000003 256100                    ORSQ    3,,PR0

  22998 31 003121   200012 470500                    LDP0    RETURN$,,AUTO
        31 003122   000010 236003                    LDQ     8,DU
        31 003123   000003 256100                    ORSQ    3,,PR0

  23013 31 003124   200012 470500                    LDP0    RETURN$,,AUTO
        31 003125   000003 236100                    LDQ     3,,PR0
        31 003126   000054 376000 32                 ANQ     44
        31 003127   000001 276007                    ORQ     1,DL
        31 003130   000003 756100                    STQ     3,,PR0

  23016 31 003131   200012 470500                    LDP0    RETURN$,,AUTO
        31 003132   000003 236100                    LDQ     3,,PR0
        31 003133   000055 376000 32                 ANQ     45
        31 003134   100000 276007                    ORQ     32768,DL
        31 003135   000003 756100                    STQ     3,,PR0

  23019 31 003136   200012 470500                    LDP0    RETURN$,,AUTO
        31 003137   200000 236007                    LDQ     65536,DL
        31 003140   000003 256100                    ORSQ    3,,PR0

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:157  
      966    23034
      967    23035        %NEW_QLT(   @POINTER    = NEW_QLT$,
      968    23036                    @DNT$       = NEW_DNT$,
      969    23037                    @ST$        = RETURN$);

  23042 31 003141   000002 236000 6                  LDQ     QLT_+2
        31 003142   000006 036007                    ADLQ    6,DL
        31 003143   000003 116000 6                  CMPQ    QLT_+3
        31 003144   003155 602000 31                 TNC     s:23044

  23043 31 003145   000042 236000 32                 LDQ     34
        31 003146   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 003147   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 003150   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 003151   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 003152   000005 631400 32                 EPPR1   5
        31 003153   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 003154   000000 011000                    NOP     0

  23044 31 003155   000002 236000 6                  LDQ     QLT_+2
        31 003156   000022 736000                    QLS     18
        31 003157   000001 036000 6                  ADLQ    QLT_+1
        31 003160   200010 756100                    STQ     NEW_QLT$,,AUTO

  23045 31 003161   000002 235000 6                  LDA     QLT_+2
        31 003162   000006 035007                    ADLA    6,DL
        31 003163   000002 755000 6                  STA     QLT_+2

  23046 31 003164   001053 220003                    LDX0    555,DU
        31 003165   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 003166   000000 740100                    STX0    0,,PR0

  23049 31 003167   000013 236000 32                 LDQ     11
        31 003170   000001 756100                    STQ     1,,PR0

  23050 31 003171   000013 236000 32                 LDQ     11
        31 003172   000002 756100                    STQ     2,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:158  

  23051 31 003173   000013 236000 32                 LDQ     11
        31 003174   000003 756100                    STQ     3,,PR0

  23052 31 003175   200012 236100                    LDQ     RETURN$,,AUTO
        31 003176   000004 756100                    STQ     4,,PR0

  23053 31 003177   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 003200   000005 756100                    STQ     5,,PR0

  23054 31 003201   000001 236007                    LDQ     1,DL
        31 003202   000000 552104                    STBQ    0,'04'O,PR0

  23055 31 003203   000000 236003                    LDQ     0,DU
        31 003204   000000 552110                    STBQ    0,'10'O,PR0

  23056 31 003205   000043 236000 32                 LDQ     35
        31 003206   000000 356100                    ANSQ    0,,PR0

  23057 31 003207   000044 236000 32                 LDQ     36
        31 003210   000000 356100                    ANSQ    0,,PR0

  23058 31 003211   000045 236000 32                 LDQ     37
        31 003212   000000 356100                    ANSQ    0,,PR0

  23059 31 003213   000046 236000 32                 LDQ     38
        31 003214   000000 356100                    ANSQ    0,,PR0

      970    23062
      971    23063    1   RETURN$ -> SCALAR.QLT$ = NEW_QLT$;

  23063 31 003215   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 003216   200012 471500                    LDP1    RETURN$,,AUTO
        31 003217   100007 756100                    STQ     7,,PR1

      972    23064    1   NEW_DNT$ -> DNT.ST$ = RETURN$;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:159  
  23064 31 003220   200012 236100                    LDQ     RETURN$,,AUTO
        31 003221   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 003222   100001 756100                    STQ     1,,PR1

      973    23065
      974    23066        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);

  23068 31 003223   000424 236000 xsym               LDQ     COMCOM+276
        31 003224   000013 116000 32                 CMPQ    11
        31 003225   003231 600000 31                 TZE     s:23070

  23069 31 003226   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 003227   000424 471400 xsym               LDP1    COMCOM+276
        31 003230   100002 756100                    STQ     2,,PR1

  23070 31 003231   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 003232   000424 756000 xsym               STQ     COMCOM+276

      975    23073
      976    23074    1   DESC.DESCL = 0;

  23074 31 003233   000000 221003                    LDX1    0,DU
        31 003234   200132 741100                    STX1    DESC,,AUTO

      977    23075    1   DESC.ALPHA_ADSC.TA = '00'B;

  23075 31 003235   000030 236000 32                 LDQ     24
        31 003236   200132 356100                    ANSQ    DESC,,AUTO

      978    23076    2   DO I = 1 TO 6;

  23076 31 003237   000001 222003                    LDX2    1,DU
        31 003240   200042 742100                    STX2    I,,AUTO

      979    23077
      980    23078    2       SA = REGISTER_OFFSET(I) / 4;

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:160  
  23078 31 003241   200042 220100                    LDX0    I,,AUTO
        31 003242   000043 236010 29                 LDQ     REGISTER_OFFSET,X0
        31 003243   000022 772000                    QRL     18
        31 003244   000002 772000                    QRL     2
        31 003245   000000 621006                    EAX1    0,QL
        31 003246   200037 741100                    STX1    SA,,AUTO

      981    23079    2       DESC.ALPHA_ADSC.CN = REGISTER_OFFSET(I) - (SA * 4);

  23079 31 003247   000043 236010 29                 LDQ     REGISTER_OFFSET,X0
        31 003250   000022 772000                    QRL     18
        31 003251   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 003252   200037 236100                    LDQ     SA,,AUTO
        31 003253   777777 376003                    ANQ     -1,DU
        31 003254   000020 772000                    QRL     16
        31 003255   000024 676000 32                 ERQ     20
        31 003256   000001 036007                    ADLQ    1,DL
        31 003257   200624 036100                    ADLQ    LINE_NUMBER+1,,AUTO
        31 003260   000042 736000                    QLS     34
        31 003261   200132 676100                    ERQ     DESC,,AUTO
        31 003262   600000 376003                    ANQ     -65536,DU
        31 003263   200132 656100                    ERSQ    DESC,,AUTO

      982    23080    2       DESC.ALPHA_ADSC.N = REGISTER_LENGTH(I);

  23080 31 003264   000063 236010 29                 LDQ     REGISTER_LENGTH,X0
        31 003265   200132 752130                    STCQ    DESC,'30'O,AUTO

      983    23081
      984    23082    2       CALL Z8AH$NEW_DNT(SUBSTR(REGISTER_NAME(I),0,NAME_LENGTH(I)),NAME_LENGTH(I),
             23082                NEW_DNT$);

  23082 31 003266   000053 722010 29                 LXL2    NAME_LENGTH,X0
        31 003267   200014 630500                    EPPR0   NEW_DNT$,,AUTO
        31 003270   200626 450500                    STP0    LINE_NUMBER+3,,AUTO
        31 003271   000053 631410 29                 EPPR1   NAME_LENGTH,X0
        31 003272   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:161  
        31 003273   200042 236100                    LDQ     I,,AUTO
        31 003274   000022 732000                    QRS     18
        31 003275   000056 402000 32                 MPY     46
        31 003276   000052 036000 32                 ADLQ    42
        31 003277   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 003300   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 003301   000000 631400 32                 EPPR1   0
        31 003302   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 003303   000000 011000                    NOP     0

      985    23083
      986    23084            %NEW_SCALAR( @ST$   = RETURN$,
      987    23085                         @DESCL = DESC.DESCL,
      988    23086                         @NEXT  = NEW_DNT$ -> DNT.ST$,
      989    23087                         @COUNT = O1COM.DML_UWA$ -> BLOCK.COUNT,
      990    23088                         @SA    = SA,
      991    23089                         @CLASS = %CLASS_ALPHANUMERIC,
      992    23090                         @ELEMENTARY = TRUE,
      993    23091                         @GLOBAL     = TRUE,
      994    23092                         @EXTERNAL   = TRUE,
      995    23093                         @COMPILER_CREATED = TRUE,
      996    23094                         @DNT$  = NEW_DNT$,
      997    23095                         @TYPE  = %TYA,
      998    23096                         @DML_UWA  = TRUE,
      999    23097                         @DML_TYPE = %DML_REG);

  23101 31 003304   000002 236000 3                  LDQ     ST_+2
        31 003305   000013 036007                    ADLQ    11,DL
        31 003306   000003 116000 3                  CMPQ    ST_+3
        31 003307   003320 604000 31                 TMI     s:23103

  23102 31 003310   000014 236000 32                 LDQ     12
        31 003311   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 003312   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 003313   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 003314   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 003315   000005 631400 32                 EPPR1   5
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:162  
        31 003316   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 003317   000000 011000                    NOP     0

  23103 31 003320   000002 236000 3                  LDQ     ST_+2
        31 003321   000022 736000                    QLS     18
        31 003322   000001 036000 3                  ADLQ    ST_+1
        31 003323   200012 756100                    STQ     RETURN$,,AUTO

  23104 31 003324   000013 236007                    LDQ     11,DL
        31 003325   000002 056000 3                  ASQ     ST_+2

  23152 31 003326   000766 220003                    LDX0    502,DU
        31 003327   200012 470500                    LDP0    RETURN$,,AUTO
        31 003330   000000 740100                    STX0    0,,PR0

  23153 31 003331   200012 470500                    LDP0    RETURN$,,AUTO
        31 003332   003000 236007                    LDQ     1536,DL
        31 003333   000000 552110                    STBQ    0,'10'O,PR0

  23154 31 003334   000077 470400 xsym               LDP0    O1COM+63
        31 003335   200012 471500                    LDP1    RETURN$,,AUTO
        31 003336   000000 236100                    LDQ     0,,PR0
        31 003337   100000 552104                    STBQ    0,'04'O,PR1

  23155 31 003340   200037 221100                    LDX1    SA,,AUTO
        31 003341   200012 470500                    LDP0    RETURN$,,AUTO
        31 003342   000001 741100                    STX1    1,,PR0

  23156 31 003343   200132 222100                    LDX2    DESC,,AUTO
        31 003344   200012 470500                    LDP0    RETURN$,,AUTO
        31 003345   000001 442100                    SXL2    1,,PR0

  23157 31 003346   000133 723000 xsym               LXL3    COMCOM+91
        31 003347   200012 470500                    LDP0    RETURN$,,AUTO
        31 003350   000002 443100                    SXL3    2,,PR0

  23158 31 003351   200012 470500                    LDP0    RETURN$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:163  
        31 003352   000003 450100                    STZ     3,,PR0

  23159 31 003353   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 003354   000001 236100                    LDQ     1,,PR0
        31 003355   200012 471500                    LDP1    RETURN$,,AUTO
        31 003356   100004 756100                    STQ     4,,PR1

  23160 31 003357   000013 236000 32                 LDQ     11
        31 003360   200012 470500                    LDP0    RETURN$,,AUTO
        31 003361   000005 756100                    STQ     5,,PR0

  23161 31 003362   000013 236000 32                 LDQ     11
        31 003363   200012 470500                    LDP0    RETURN$,,AUTO
        31 003364   000007 756100                    STQ     7,,PR0

  23162 31 003365   000000 223003                    LDX3    0,DU
        31 003366   200012 470500                    LDP0    RETURN$,,AUTO
        31 003367   000010 743100                    STX3    8,,PR0

  23163 31 003370   777777 224003                    LDX4    -1,DU
        31 003371   200012 470500                    LDP0    RETURN$,,AUTO
        31 003372   000010 444100                    SXL4    8,,PR0

  23167 31 003373   000013 236000 32                 LDQ     11
        31 003374   200012 470500                    LDP0    RETURN$,,AUTO
        31 003375   000012 756100                    STQ     10,,PR0

  23170 31 003376   000057 236000 xsym               LDQ     O1COM+47
        31 003377   200012 470500                    LDP0    RETURN$,,AUTO
        31 003400   000011 756100                    STQ     9,,PR0

  23171 31 003401   000057 236000 xsym               LDQ     O1COM+47
        31 003402   000013 116000 32                 CMPQ    11
        31 003403   003427 600000 31                 TZE     s:23206

  23175 31 003404   000057 470400 xsym               LDP0    O1COM+47
        31 003405   000001 471500                    LDP1    1,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:164  
        31 003406   100012 236100                    LDQ     10,,PR1
        31 003407   000013 116000 32                 CMPQ    11
        31 003410   003420 601000 31                 TNZ     s:23182

  23177 31 003411   200012 236100                    LDQ     RETURN$,,AUTO
        31 003412   100011 756100                    STQ     9,,PR1

  23178 31 003413   000057 470400 xsym               LDP0    O1COM+47
        31 003414   000001 471500                    LDP1    1,,PR0
        31 003415   200012 236100                    LDQ     RETURN$,,AUTO
        31 003416   100012 756100                    STQ     10,,PR1

  23179 31 003417   003427 710000 31                 TRA     s:23206

  23182 31 003420   100012 473500                    LDP3    10,,PR1
        31 003421   200012 236100                    LDQ     RETURN$,,AUTO
        31 003422   300012 756100                    STQ     10,,PR3

  23183 31 003423   000057 470400 xsym               LDP0    O1COM+47
        31 003424   000001 471500                    LDP1    1,,PR0
        31 003425   200012 236100                    LDQ     RETURN$,,AUTO
        31 003426   100012 756100                    STQ     10,,PR1

  23206 31 003427   000010 225003                    LDX5    8,DU
        31 003430   200012 470500                    LDP0    RETURN$,,AUTO
        31 003431   000002 745100                    STX5    2,,PR0

  23211 31 003432   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 003433   200012 470500                    LDP0    RETURN$,,AUTO
        31 003434   000006 756100                    STQ     6,,PR0

  23228 31 003435   200012 470500                    LDP0    RETURN$,,AUTO
        31 003436   010000 236003                    LDQ     4096,DU
        31 003437   000003 256100                    ORSQ    3,,PR0

  23237 31 003440   200012 470500                    LDP0    RETURN$,,AUTO
        31 003441   100000 236003                    LDQ     32768,DU
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:165  
        31 003442   000003 256100                    ORSQ    3,,PR0

  23258 31 003443   200012 470500                    LDP0    RETURN$,,AUTO
        31 003444   000004 236003                    LDQ     4,DU
        31 003445   000003 256100                    ORSQ    3,,PR0

  23261 31 003446   200012 470500                    LDP0    RETURN$,,AUTO
        31 003447   000010 236003                    LDQ     8,DU
        31 003450   000003 256100                    ORSQ    3,,PR0

  23276 31 003451   200012 470500                    LDP0    RETURN$,,AUTO
        31 003452   000003 236100                    LDQ     3,,PR0
        31 003453   000054 376000 32                 ANQ     44
        31 003454   000003 276007                    ORQ     3,DL
        31 003455   000003 756100                    STQ     3,,PR0

  23279 31 003456   200012 470500                    LDP0    RETURN$,,AUTO
        31 003457   000003 236100                    LDQ     3,,PR0
        31 003460   000055 376000 32                 ANQ     45
        31 003461   100000 276007                    ORQ     32768,DL
        31 003462   000003 756100                    STQ     3,,PR0

  23282 31 003463   200012 470500                    LDP0    RETURN$,,AUTO
        31 003464   200000 236007                    LDQ     65536,DL
        31 003465   000003 256100                    ORSQ    3,,PR0

     1000    23297
     1001    23298            %NEW_QLT(   @POINTER    = NEW_QLT$,
     1002    23299                        @DNT$       = NEW_DNT$,
     1003    23300                        @ST$        = RETURN$);

  23305 31 003466   000002 236000 6                  LDQ     QLT_+2
        31 003467   000006 036007                    ADLQ    6,DL
        31 003470   000003 116000 6                  CMPQ    QLT_+3
        31 003471   003502 602000 31                 TNC     s:23307

  23306 31 003472   000042 236000 32                 LDQ     34
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:166  
        31 003473   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 003474   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 003475   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 003476   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 003477   000005 631400 32                 EPPR1   5
        31 003500   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 003501   000000 011000                    NOP     0

  23307 31 003502   000002 236000 6                  LDQ     QLT_+2
        31 003503   000022 736000                    QLS     18
        31 003504   000001 036000 6                  ADLQ    QLT_+1
        31 003505   200010 756100                    STQ     NEW_QLT$,,AUTO

  23308 31 003506   000002 235000 6                  LDA     QLT_+2
        31 003507   000006 035007                    ADLA    6,DL
        31 003510   000002 755000 6                  STA     QLT_+2

  23309 31 003511   001053 220003                    LDX0    555,DU
        31 003512   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 003513   000000 740100                    STX0    0,,PR0

  23312 31 003514   000013 236000 32                 LDQ     11
        31 003515   000001 756100                    STQ     1,,PR0

  23313 31 003516   000013 236000 32                 LDQ     11
        31 003517   000002 756100                    STQ     2,,PR0

  23314 31 003520   000013 236000 32                 LDQ     11
        31 003521   000003 756100                    STQ     3,,PR0

  23315 31 003522   200012 236100                    LDQ     RETURN$,,AUTO
        31 003523   000004 756100                    STQ     4,,PR0

  23316 31 003524   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 003525   000005 756100                    STQ     5,,PR0

  23317 31 003526   000001 236007                    LDQ     1,DL
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:167  
        31 003527   000000 552104                    STBQ    0,'04'O,PR0

  23318 31 003530   000000 236003                    LDQ     0,DU
        31 003531   000000 552110                    STBQ    0,'10'O,PR0

  23319 31 003532   000043 236000 32                 LDQ     35
        31 003533   000000 356100                    ANSQ    0,,PR0

  23320 31 003534   000044 236000 32                 LDQ     36
        31 003535   000000 356100                    ANSQ    0,,PR0

  23321 31 003536   000045 236000 32                 LDQ     37
        31 003537   000000 356100                    ANSQ    0,,PR0

  23322 31 003540   000046 236000 32                 LDQ     38
        31 003541   000000 356100                    ANSQ    0,,PR0

     1004    23325
     1005    23326    2       RETURN$ -> SCALAR.QLT$ = NEW_QLT$;

  23326 31 003542   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 003543   200012 471500                    LDP1    RETURN$,,AUTO
        31 003544   100007 756100                    STQ     7,,PR1

     1006    23327    2       NEW_DNT$ -> DNT.ST$ = RETURN$;

  23327 31 003545   200012 236100                    LDQ     RETURN$,,AUTO
        31 003546   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 003547   100001 756100                    STQ     1,,PR1

     1007    23328
     1008    23329            %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);

  23331 31 003550   000424 236000 xsym               LDQ     COMCOM+276
        31 003551   000013 116000 32                 CMPQ    11
        31 003552   003556 600000 31                 TZE     s:23333

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:168  
  23332 31 003553   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 003554   000424 471400 xsym               LDP1    COMCOM+276
        31 003555   100002 756100                    STQ     2,,PR1

  23333 31 003556   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 003557   000424 756000 xsym               STQ     COMCOM+276

     1009    23336
     1010    23337    2   END;  /*V*   DO LOOP   */

  23337 31 003560   200042 221100                    LDX1    I,,AUTO
        31 003561   000001 622011                    EAX2    1,X1
        31 003562   200042 742100                    STX2    I,,AUTO
        31 003563   000006 102003                    CMPX2   6,DU
        31 003564   003241 604400 31                 TMOZ    s:23078

     1011    23338        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:169  
     1012    23339                 /*V*    BUILD LAST  REGISTER   */
     1013    23340
     1014    23341    1   DESC.DESCL = 0;

  23341 31 003565   000000 221003                    LDX1    0,DU
        31 003566   200132 741100                    STX1    DESC,,AUTO

     1015    23342    1   SA = REGISTER_OFFSET(7) / 4;

  23342 31 003567   000052 236000 29                 LDQ     REGISTER_OFFSET+7
        31 003570   000022 772000                    QRL     18
        31 003571   000002 772000                    QRL     2
        31 003572   000000 623006                    EAX3    0,QL
        31 003573   200037 743100                    STX3    SA,,AUTO

     1016    23343    1   DESC.NUM_NDSC.CN = REGISTER_OFFSET(7) - (SA * 4);

  23343 31 003574   000052 235000 29                 LDA     REGISTER_OFFSET+7
        31 003575   000022 771000                    ARL     18
        31 003576   200624 755100                    STA     LINE_NUMBER+1,,AUTO
        31 003577   200037 236100                    LDQ     SA,,AUTO
        31 003600   777777 376003                    ANQ     -1,DU
        31 003601   000020 772000                    QRL     16
        31 003602   000024 676000 32                 ERQ     20
        31 003603   000001 036007                    ADLQ    1,DL
        31 003604   200624 036100                    ADLQ    LINE_NUMBER+1,,AUTO
        31 003605   000041 736000                    QLS     33
        31 003606   200132 676100                    ERQ     DESC,,AUTO
        31 003607   700000 376003                    ANQ     -32768,DU
        31 003610   200132 656100                    ERSQ    DESC,,AUTO

     1017    23344    1   DESC.NUM_NDSC.TN = '0'B;

  23344 31 003611   000025 236000 32                 LDQ     21
        31 003612   200132 356100                    ANSQ    DESC,,AUTO

     1018    23345    1   DESC.NUM_NDSC.N = REGISTER_LENGTH(7);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:170  

  23345 31 003613   000072 236000 29                 LDQ     REGISTER_LENGTH+7
        31 003614   200132 752110                    STCQ    DESC,'10'O,AUTO

     1019    23346
     1020    23347    1  CALL Z8AH$NEW_DNT(SUBSTR(REGISTER_NAME(7),0,NAME_LENGTH(7)),NAME_LENGTH(7),NEW_DNT$)
             23347            ;

  23347 31 003615   200014 631500                    EPPR1   NEW_DNT$,,AUTO
        31 003616   200626 451500                    STP1    LINE_NUMBER+3,,AUTO
        31 003617   000060 237000 32                 LDAQ    48
        31 003620   200624 757100                    STAQ    LINE_NUMBER+1,,AUTO
        31 003621   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 003622   000000 631400 32                 EPPR1   0
        31 003623   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 003624   000000 011000                    NOP     0

     1021    23348
     1022    23349        %NEW_SCALAR( @ST$   = RETURN$,
     1023    23350                     @DESCL = DESC.DESCL,
     1024    23351                     @NEXT  = NEW_DNT$ -> DNT.ST$,
     1025    23352                     @COUNT = O1COM.DML_UWA$ -> BLOCK.COUNT,
     1026    23353                     @SA    = SA,
     1027    23354                     @CLASS = %CLASS_NUMERIC,
     1028    23355                     @ELEMENTARY = TRUE,
     1029    23356                     @GLOBAL     = TRUE,
     1030    23357                     @EXTERNAL   = TRUE,
     1031    23358                     @COMPILER_CREATED = TRUE,
     1032    23359                     @DNT$  = NEW_DNT$,
     1033    23360                     @TYPE  = %TYI,
     1034    23361                     @DML_UWA = TRUE,
     1035    23362                     @DML_TYPE = %DIRECT_REFERENCE);

  23366 31 003625   000002 236000 3                  LDQ     ST_+2
        31 003626   000013 036007                    ADLQ    11,DL
        31 003627   000003 116000 3                  CMPQ    ST_+3
        31 003630   003641 604000 31                 TMI     s:23368
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:171  

  23367 31 003631   000014 236000 32                 LDQ     12
        31 003632   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 003633   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 003634   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 003635   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 003636   000005 631400 32                 EPPR1   5
        31 003637   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 003640   000000 011000                    NOP     0

  23368 31 003641   000002 236000 3                  LDQ     ST_+2
        31 003642   000022 736000                    QLS     18
        31 003643   000001 036000 3                  ADLQ    ST_+1
        31 003644   200012 756100                    STQ     RETURN$,,AUTO

  23369 31 003645   000013 236007                    LDQ     11,DL
        31 003646   000002 056000 3                  ASQ     ST_+2

  23417 31 003647   000766 220003                    LDX0    502,DU
        31 003650   200012 470500                    LDP0    RETURN$,,AUTO
        31 003651   000000 740100                    STX0    0,,PR0

  23418 31 003652   200012 470500                    LDP0    RETURN$,,AUTO
        31 003653   003000 236007                    LDQ     1536,DL
        31 003654   000000 552110                    STBQ    0,'10'O,PR0

  23419 31 003655   000077 470400 xsym               LDP0    O1COM+63
        31 003656   200012 471500                    LDP1    RETURN$,,AUTO
        31 003657   000000 236100                    LDQ     0,,PR0
        31 003660   100000 552104                    STBQ    0,'04'O,PR1

  23420 31 003661   200037 221100                    LDX1    SA,,AUTO
        31 003662   200012 470500                    LDP0    RETURN$,,AUTO
        31 003663   000001 741100                    STX1    1,,PR0

  23421 31 003664   200132 222100                    LDX2    DESC,,AUTO
        31 003665   200012 470500                    LDP0    RETURN$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:172  
        31 003666   000001 442100                    SXL2    1,,PR0

  23422 31 003667   000133 723000 xsym               LXL3    COMCOM+91
        31 003670   200012 470500                    LDP0    RETURN$,,AUTO
        31 003671   000002 443100                    SXL3    2,,PR0

  23423 31 003672   200012 470500                    LDP0    RETURN$,,AUTO
        31 003673   000003 450100                    STZ     3,,PR0

  23424 31 003674   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 003675   000001 236100                    LDQ     1,,PR0
        31 003676   200012 471500                    LDP1    RETURN$,,AUTO
        31 003677   100004 756100                    STQ     4,,PR1

  23425 31 003700   000013 236000 32                 LDQ     11
        31 003701   200012 470500                    LDP0    RETURN$,,AUTO
        31 003702   000005 756100                    STQ     5,,PR0

  23426 31 003703   000013 236000 32                 LDQ     11
        31 003704   200012 470500                    LDP0    RETURN$,,AUTO
        31 003705   000007 756100                    STQ     7,,PR0

  23427 31 003706   000000 223003                    LDX3    0,DU
        31 003707   200012 470500                    LDP0    RETURN$,,AUTO
        31 003710   000010 743100                    STX3    8,,PR0

  23428 31 003711   777777 224003                    LDX4    -1,DU
        31 003712   200012 470500                    LDP0    RETURN$,,AUTO
        31 003713   000010 444100                    SXL4    8,,PR0

  23432 31 003714   000013 236000 32                 LDQ     11
        31 003715   200012 470500                    LDP0    RETURN$,,AUTO
        31 003716   000012 756100                    STQ     10,,PR0

  23435 31 003717   000057 236000 xsym               LDQ     O1COM+47
        31 003720   200012 470500                    LDP0    RETURN$,,AUTO
        31 003721   000011 756100                    STQ     9,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:173  

  23436 31 003722   000057 236000 xsym               LDQ     O1COM+47
        31 003723   000013 116000 32                 CMPQ    11
        31 003724   003750 600000 31                 TZE     s:23471

  23440 31 003725   000057 470400 xsym               LDP0    O1COM+47
        31 003726   000001 471500                    LDP1    1,,PR0
        31 003727   100012 236100                    LDQ     10,,PR1
        31 003730   000013 116000 32                 CMPQ    11
        31 003731   003741 601000 31                 TNZ     s:23447

  23442 31 003732   200012 236100                    LDQ     RETURN$,,AUTO
        31 003733   100011 756100                    STQ     9,,PR1

  23443 31 003734   000057 470400 xsym               LDP0    O1COM+47
        31 003735   000001 471500                    LDP1    1,,PR0
        31 003736   200012 236100                    LDQ     RETURN$,,AUTO
        31 003737   100012 756100                    STQ     10,,PR1

  23444 31 003740   003750 710000 31                 TRA     s:23471

  23447 31 003741   100012 473500                    LDP3    10,,PR1
        31 003742   200012 236100                    LDQ     RETURN$,,AUTO
        31 003743   300012 756100                    STQ     10,,PR3

  23448 31 003744   000057 470400 xsym               LDP0    O1COM+47
        31 003745   000001 471500                    LDP1    1,,PR0
        31 003746   200012 236100                    LDQ     RETURN$,,AUTO
        31 003747   100012 756100                    STQ     10,,PR1

  23471 31 003750   000001 225003                    LDX5    1,DU
        31 003751   200012 470500                    LDP0    RETURN$,,AUTO
        31 003752   000002 745100                    STX5    2,,PR0

  23476 31 003753   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 003754   200012 470500                    LDP0    RETURN$,,AUTO
        31 003755   000006 756100                    STQ     6,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:174  

  23493 31 003756   200012 470500                    LDP0    RETURN$,,AUTO
        31 003757   010000 236003                    LDQ     4096,DU
        31 003760   000003 256100                    ORSQ    3,,PR0

  23502 31 003761   200012 470500                    LDP0    RETURN$,,AUTO
        31 003762   100000 236003                    LDQ     32768,DU
        31 003763   000003 256100                    ORSQ    3,,PR0

  23523 31 003764   200012 470500                    LDP0    RETURN$,,AUTO
        31 003765   000004 236003                    LDQ     4,DU
        31 003766   000003 256100                    ORSQ    3,,PR0

  23526 31 003767   200012 470500                    LDP0    RETURN$,,AUTO
        31 003770   000010 236003                    LDQ     8,DU
        31 003771   000003 256100                    ORSQ    3,,PR0

  23541 31 003772   200012 470500                    LDP0    RETURN$,,AUTO
        31 003773   000003 236100                    LDQ     3,,PR0
        31 003774   000054 376000 32                 ANQ     44
        31 003775   000001 276007                    ORQ     1,DL
        31 003776   000003 756100                    STQ     3,,PR0

  23544 31 003777   200012 470500                    LDP0    RETURN$,,AUTO
        31 004000   000003 236100                    LDQ     3,,PR0
        31 004001   000055 376000 32                 ANQ     45
        31 004002   120000 276007                    ORQ     40960,DL
        31 004003   000003 756100                    STQ     3,,PR0

  23547 31 004004   200012 470500                    LDP0    RETURN$,,AUTO
        31 004005   200000 236007                    LDQ     65536,DL
        31 004006   000003 256100                    ORSQ    3,,PR0

     1036    23562
     1037    23563        %NEW_QLT(   @POINTER    = NEW_QLT$,
     1038    23564                    @DNT$       = NEW_DNT$,
     1039    23565                    @ST$        = RETURN$);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:175  

  23570 31 004007   000002 236000 6                  LDQ     QLT_+2
        31 004010   000006 036007                    ADLQ    6,DL
        31 004011   000003 116000 6                  CMPQ    QLT_+3
        31 004012   004023 602000 31                 TNC     s:23572

  23571 31 004013   000042 236000 32                 LDQ     34
        31 004014   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 004015   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004016   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 004017   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 004020   000005 631400 32                 EPPR1   5
        31 004021   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 004022   000000 011000                    NOP     0

  23572 31 004023   000002 236000 6                  LDQ     QLT_+2
        31 004024   000022 736000                    QLS     18
        31 004025   000001 036000 6                  ADLQ    QLT_+1
        31 004026   200010 756100                    STQ     NEW_QLT$,,AUTO

  23573 31 004027   000002 235000 6                  LDA     QLT_+2
        31 004030   000006 035007                    ADLA    6,DL
        31 004031   000002 755000 6                  STA     QLT_+2

  23574 31 004032   001053 220003                    LDX0    555,DU
        31 004033   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 004034   000000 740100                    STX0    0,,PR0

  23577 31 004035   000013 236000 32                 LDQ     11
        31 004036   000001 756100                    STQ     1,,PR0

  23578 31 004037   000013 236000 32                 LDQ     11
        31 004040   000002 756100                    STQ     2,,PR0

  23579 31 004041   000013 236000 32                 LDQ     11
        31 004042   000003 756100                    STQ     3,,PR0

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:176  
  23580 31 004043   200012 236100                    LDQ     RETURN$,,AUTO
        31 004044   000004 756100                    STQ     4,,PR0

  23581 31 004045   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 004046   000005 756100                    STQ     5,,PR0

  23582 31 004047   000001 236007                    LDQ     1,DL
        31 004050   000000 552104                    STBQ    0,'04'O,PR0

  23583 31 004051   000000 236003                    LDQ     0,DU
        31 004052   000000 552110                    STBQ    0,'10'O,PR0

  23584 31 004053   000043 236000 32                 LDQ     35
        31 004054   000000 356100                    ANSQ    0,,PR0

  23585 31 004055   000044 236000 32                 LDQ     36
        31 004056   000000 356100                    ANSQ    0,,PR0

  23586 31 004057   000045 236000 32                 LDQ     37
        31 004060   000000 356100                    ANSQ    0,,PR0

  23587 31 004061   000046 236000 32                 LDQ     38
        31 004062   000000 356100                    ANSQ    0,,PR0

     1040    23590
     1041    23591    1   RETURN$ -> SCALAR.QLT$ = NEW_QLT$;

  23591 31 004063   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 004064   200012 471500                    LDP1    RETURN$,,AUTO
        31 004065   100007 756100                    STQ     7,,PR1

     1042    23592    1   NEW_DNT$ -> DNT.ST$ = RETURN$;

  23592 31 004066   200012 236100                    LDQ     RETURN$,,AUTO
        31 004067   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 004070   100001 756100                    STQ     1,,PR1

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:177  
     1043    23593        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);

  23595 31 004071   000424 236000 xsym               LDQ     COMCOM+276
        31 004072   000013 116000 32                 CMPQ    11
        31 004073   004077 600000 31                 TZE     s:23597

  23596 31 004074   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 004075   000424 471400 xsym               LDP1    COMCOM+276
        31 004076   100002 756100                    STQ     2,,PR1

  23597 31 004077   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 004100   000424 756000 xsym               STQ     COMCOM+276

     1044    23600        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:178  
     1045    23601                      /*V* BUILD  ST ITEM FOR TENANCY CONDITIONS */
     1046    23602
     1047    23603    1   DESC.DESCL = 0;

  23603 31 004101   000000 221003                    LDX1    0,DU
        31 004102   200132 741100                    STX1    DESC,,AUTO

     1048    23604    1   DESC.NUM_NDSC.CN = 0;

  23604 31 004103   000057 236000 32                 LDQ     47
        31 004104   200132 356100                    ANSQ    DESC,,AUTO

     1049    23605    1   DESC.NUM_NDSC.TN = '0'B;

  23605 31 004105   000025 236000 32                 LDQ     21
        31 004106   200132 356100                    ANSQ    DESC,,AUTO

     1050    23606    1   DESC.NUM_NDSC.N = 4;

  23606 31 004107   000004 236003                    LDQ     4,DU
        31 004110   200132 752110                    STCQ    DESC,'10'O,AUTO

     1051    23607
     1052    23608    1   CALL Z8AH$NEW_DNT( 'UWA+0', 5, NEW_DNT$);

  23608 31 004111   200014 631500                    EPPR1   NEW_DNT$,,AUTO
        31 004112   200626 451500                    STP1    LINE_NUMBER+3,,AUTO
        31 004113   000064 237000 32                 LDAQ    52
        31 004114   200624 757100                    STAQ    LINE_NUMBER+1,,AUTO
        31 004115   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004116   000000 631400 32                 EPPR1   0
        31 004117   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 004120   000000 011000                    NOP     0

     1053    23609        %NEW_SCALAR( @ST$ = O1COM.UWA_PLUS_ZERO$,
     1054    23610                     @DESCL = DESC.DESCL,
     1055    23611                     @NEXT = NEW_DNT$ -> DNT.ST$,
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:179  
     1056    23612                     @COUNT = O1COM.DML_UWA$  -> BLOCK.COUNT,
     1057    23613                     @SA = 0,
     1058    23614                     @ELEMENTARY = TRUE,
     1059    23615                     @GLOBAL     = TRUE,
     1060    23616                     @EXTERNAL   = TRUE,
     1061    23617                     @DNT$ = NEW_DNT$,
     1062    23618                     @TYPE = %TYI,
     1063    23619                     @DML_UWA = TRUE);

  23623 31 004121   000002 236000 3                  LDQ     ST_+2
        31 004122   000013 036007                    ADLQ    11,DL
        31 004123   000003 116000 3                  CMPQ    ST_+3
        31 004124   004135 604000 31                 TMI     s:23625

  23624 31 004125   000014 236000 32                 LDQ     12
        31 004126   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 004127   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004130   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 004131   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 004132   000005 631400 32                 EPPR1   5
        31 004133   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 004134   000000 011000                    NOP     0

  23625 31 004135   000002 236000 3                  LDQ     ST_+2
        31 004136   000022 736000                    QLS     18
        31 004137   000001 036000 3                  ADLQ    ST_+1
        31 004140   000101 756000 xsym               STQ     O1COM+65

  23626 31 004141   000013 236007                    LDQ     11,DL
        31 004142   000002 056000 3                  ASQ     ST_+2

  23674 31 004143   000766 220003                    LDX0    502,DU
        31 004144   000101 470400 xsym               LDP0    O1COM+65
        31 004145   000000 740100                    STX0    0,,PR0

  23675 31 004146   000101 470400 xsym               LDP0    O1COM+65
        31 004147   003000 236007                    LDQ     1536,DL
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:180  
        31 004150   000000 552110                    STBQ    0,'10'O,PR0

  23676 31 004151   000077 470400 xsym               LDP0    O1COM+63
        31 004152   000101 471400 xsym               LDP1    O1COM+65
        31 004153   000000 236100                    LDQ     0,,PR0
        31 004154   100000 552104                    STBQ    0,'04'O,PR1

  23677 31 004155   000000 221003                    LDX1    0,DU
        31 004156   000101 470400 xsym               LDP0    O1COM+65
        31 004157   000001 741100                    STX1    1,,PR0

  23678 31 004160   200132 222100                    LDX2    DESC,,AUTO
        31 004161   000101 470400 xsym               LDP0    O1COM+65
        31 004162   000001 442100                    SXL2    1,,PR0

  23679 31 004163   000133 723000 xsym               LXL3    COMCOM+91
        31 004164   000101 470400 xsym               LDP0    O1COM+65
        31 004165   000002 443100                    SXL3    2,,PR0

  23680 31 004166   000101 470400 xsym               LDP0    O1COM+65
        31 004167   000003 450100                    STZ     3,,PR0

  23681 31 004170   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 004171   000001 236100                    LDQ     1,,PR0
        31 004172   000101 471400 xsym               LDP1    O1COM+65
        31 004173   100004 756100                    STQ     4,,PR1

  23682 31 004174   000013 236000 32                 LDQ     11
        31 004175   000101 470400 xsym               LDP0    O1COM+65
        31 004176   000005 756100                    STQ     5,,PR0

  23683 31 004177   000013 236000 32                 LDQ     11
        31 004200   000101 470400 xsym               LDP0    O1COM+65
        31 004201   000007 756100                    STQ     7,,PR0

  23684 31 004202   000101 470400 xsym               LDP0    O1COM+65
        31 004203   000010 741100                    STX1    8,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:181  

  23685 31 004204   777777 223003                    LDX3    -1,DU
        31 004205   000101 470400 xsym               LDP0    O1COM+65
        31 004206   000010 443100                    SXL3    8,,PR0

  23689 31 004207   000013 236000 32                 LDQ     11
        31 004210   000101 470400 xsym               LDP0    O1COM+65
        31 004211   000012 756100                    STQ     10,,PR0

  23692 31 004212   000057 236000 xsym               LDQ     O1COM+47
        31 004213   000101 470400 xsym               LDP0    O1COM+65
        31 004214   000011 756100                    STQ     9,,PR0

  23693 31 004215   000057 236000 xsym               LDQ     O1COM+47
        31 004216   000013 116000 32                 CMPQ    11
        31 004217   004243 600000 31                 TZE     s:23728

  23697 31 004220   000057 470400 xsym               LDP0    O1COM+47
        31 004221   000001 471500                    LDP1    1,,PR0
        31 004222   100012 236100                    LDQ     10,,PR1
        31 004223   000013 116000 32                 CMPQ    11
        31 004224   004234 601000 31                 TNZ     s:23704

  23699 31 004225   000101 236000 xsym               LDQ     O1COM+65
        31 004226   100011 756100                    STQ     9,,PR1

  23700 31 004227   000057 470400 xsym               LDP0    O1COM+47
        31 004230   000001 471500                    LDP1    1,,PR0
        31 004231   000101 236000 xsym               LDQ     O1COM+65
        31 004232   100012 756100                    STQ     10,,PR1

  23701 31 004233   004243 710000 31                 TRA     s:23728

  23704 31 004234   100012 473500                    LDP3    10,,PR1
        31 004235   000101 236000 xsym               LDQ     O1COM+65
        31 004236   300012 756100                    STQ     10,,PR3

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:182  
  23705 31 004237   000057 470400 xsym               LDP0    O1COM+47
        31 004240   000001 471500                    LDP1    1,,PR0
        31 004241   000101 236000 xsym               LDQ     O1COM+65
        31 004242   100012 756100                    STQ     10,,PR1

  23728 31 004243   000001 224003                    LDX4    1,DU
        31 004244   000101 470400 xsym               LDP0    O1COM+65
        31 004245   000002 744100                    STX4    2,,PR0

  23733 31 004246   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 004247   000101 470400 xsym               LDP0    O1COM+65
        31 004250   000006 756100                    STQ     6,,PR0

  23750 31 004251   000101 470400 xsym               LDP0    O1COM+65
        31 004252   010000 236003                    LDQ     4096,DU
        31 004253   000003 256100                    ORSQ    3,,PR0

  23780 31 004254   000101 470400 xsym               LDP0    O1COM+65
        31 004255   000004 236003                    LDQ     4,DU
        31 004256   000003 256100                    ORSQ    3,,PR0

  23783 31 004257   000101 470400 xsym               LDP0    O1COM+65
        31 004260   000010 236003                    LDQ     8,DU
        31 004261   000003 256100                    ORSQ    3,,PR0

  23804 31 004262   000101 470400 xsym               LDP0    O1COM+65
        31 004263   200000 236007                    LDQ     65536,DL
        31 004264   000003 256100                    ORSQ    3,,PR0

     1064    23819        %NEW_QLT( @POINTER = NEW_QLT$,
     1065    23820                  @DNT$ = NEW_DNT$,
     1066    23821                  @ST$ = O1COM.UWA_PLUS_ZERO$);

  23826 31 004265   000002 236000 6                  LDQ     QLT_+2
        31 004266   000006 036007                    ADLQ    6,DL
        31 004267   000003 116000 6                  CMPQ    QLT_+3
        31 004270   004301 602000 31                 TNC     s:23828
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:183  

  23827 31 004271   000042 236000 32                 LDQ     34
        31 004272   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 004273   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004274   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 004275   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 004276   000005 631400 32                 EPPR1   5
        31 004277   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 004300   000000 011000                    NOP     0

  23828 31 004301   000002 236000 6                  LDQ     QLT_+2
        31 004302   000022 736000                    QLS     18
        31 004303   000001 036000 6                  ADLQ    QLT_+1
        31 004304   200010 756100                    STQ     NEW_QLT$,,AUTO

  23829 31 004305   000002 235000 6                  LDA     QLT_+2
        31 004306   000006 035007                    ADLA    6,DL
        31 004307   000002 755000 6                  STA     QLT_+2

  23830 31 004310   001053 220003                    LDX0    555,DU
        31 004311   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 004312   000000 740100                    STX0    0,,PR0

  23833 31 004313   000013 236000 32                 LDQ     11
        31 004314   000001 756100                    STQ     1,,PR0

  23834 31 004315   000013 236000 32                 LDQ     11
        31 004316   000002 756100                    STQ     2,,PR0

  23835 31 004317   000013 236000 32                 LDQ     11
        31 004320   000003 756100                    STQ     3,,PR0

  23836 31 004321   000101 236000 xsym               LDQ     O1COM+65
        31 004322   000004 756100                    STQ     4,,PR0

  23837 31 004323   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 004324   000005 756100                    STQ     5,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:184  

  23838 31 004325   000001 236007                    LDQ     1,DL
        31 004326   000000 552104                    STBQ    0,'04'O,PR0

  23839 31 004327   000000 236003                    LDQ     0,DU
        31 004330   000000 552110                    STBQ    0,'10'O,PR0

  23840 31 004331   000043 236000 32                 LDQ     35
        31 004332   000000 356100                    ANSQ    0,,PR0

  23841 31 004333   000044 236000 32                 LDQ     36
        31 004334   000000 356100                    ANSQ    0,,PR0

  23842 31 004335   000045 236000 32                 LDQ     37
        31 004336   000000 356100                    ANSQ    0,,PR0

  23843 31 004337   000046 236000 32                 LDQ     38
        31 004340   000000 356100                    ANSQ    0,,PR0

     1067    23846    1   O1COM.UWA_PLUS_ZERO$ -> SCALAR.QLT$ = NEW_QLT$;

  23846 31 004341   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 004342   000101 471400 xsym               LDP1    O1COM+65
        31 004343   100007 756100                    STQ     7,,PR1

     1068    23847    1   NEW_DNT$ -> DNT.ST$ = O1COM.UWA_PLUS_ZERO$;

  23847 31 004344   000101 236000 xsym               LDQ     O1COM+65
        31 004345   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 004346   100001 756100                    STQ     1,,PR1

     1069    23848        %UPDATE_PREV_QLT$( @NEW_QLT$ = NEW_QLT$);

  23850 31 004347   000424 236000 xsym               LDQ     COMCOM+276
        31 004350   000013 116000 32                 CMPQ    11
        31 004351   004355 600000 31                 TZE     s:23852

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:185  
  23851 31 004352   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 004353   000424 471400 xsym               LDP1    COMCOM+276
        31 004354   100002 756100                    STQ     2,,PR1

  23852 31 004355   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 004356   000424 756000 xsym               STQ     COMCOM+276

     1070    23855        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:186  
     1071    23856         /*V*      BUILD DML INTERFACE AREA                              */
     1072    23857
     1073    23858    1   DESC.DESCL = 0;

  23858 31 004357   000000 221003                    LDX1    0,DU
        31 004360   200132 741100                    STX1    DESC,,AUTO

     1074    23859    1   DESC.ALPHA_ADSC.N = 184;                         /*V*  46 WORDS  */

  23859 31 004361   000270 236003                    LDQ     184,DU
        31 004362   200132 752130                    STCQ    DESC,'30'O,AUTO

     1075    23860    1   CALL Z8AH$NEW_DNT('DML$INTERFACE$AREA',18,NEW_DNT$);

  23860 31 004363   200014 631500                    EPPR1   NEW_DNT$,,AUTO
        31 004364   200626 451500                    STP1    LINE_NUMBER+3,,AUTO
        31 004365   000066 237000 32                 LDAQ    54
        31 004366   200624 757100                    STAQ    LINE_NUMBER+1,,AUTO
        31 004367   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004370   000000 631400 32                 EPPR1   0
        31 004371   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 004372   000000 011000                    NOP     0

     1076    23861
     1077    23862        %NEW_SCALAR(@ST$    = O1COM.DML_IA$,
     1078    23863                    @DESCL  = DESC.DESCL,
     1079    23864                    @NEXT   = NEW_DNT$ -> DNT.ST$,
     1080    23865                    @CLASS  = %CLASS_ALPHABETIC,
     1081    23866                    @DNT$   = NEW_DNT$,
     1082    23867                    @TYPE   = %TYA,
     1083    23868           /*       @MOD_8  = TRUE,  */
     1084    23869                    @ELEMENTARY = TRUE);

  23873 31 004373   000002 236000 3                  LDQ     ST_+2
        31 004374   000013 036007                    ADLQ    11,DL
        31 004375   000003 116000 3                  CMPQ    ST_+3
        31 004376   004407 604000 31                 TMI     s:23875
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:187  

  23874 31 004377   000014 236000 32                 LDQ     12
        31 004400   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 004401   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004402   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 004403   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 004404   000005 631400 32                 EPPR1   5
        31 004405   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 004406   000000 011000                    NOP     0

  23875 31 004407   000002 236000 3                  LDQ     ST_+2
        31 004410   000022 736000                    QLS     18
        31 004411   000001 036000 3                  ADLQ    ST_+1
        31 004412   000076 756000 xsym               STQ     O1COM+62

  23876 31 004413   000013 236007                    LDQ     11,DL
        31 004414   000002 056000 3                  ASQ     ST_+2

  23924 31 004415   000766 220003                    LDX0    502,DU
        31 004416   000076 470400 xsym               LDP0    O1COM+62
        31 004417   000000 740100                    STX0    0,,PR0

  23925 31 004420   000076 470400 xsym               LDP0    O1COM+62
        31 004421   003000 236007                    LDQ     1536,DL
        31 004422   000000 552110                    STBQ    0,'10'O,PR0

  23926 31 004423   000076 470400 xsym               LDP0    O1COM+62
        31 004424   000001 236007                    LDQ     1,DL
        31 004425   000000 552104                    STBQ    0,'04'O,PR0

  23927 31 004426   000000 221003                    LDX1    0,DU
        31 004427   000076 470400 xsym               LDP0    O1COM+62
        31 004430   000001 741100                    STX1    1,,PR0

  23928 31 004431   200132 222100                    LDX2    DESC,,AUTO
        31 004432   000076 470400 xsym               LDP0    O1COM+62
        31 004433   000001 442100                    SXL2    1,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:188  

  23929 31 004434   000133 723000 xsym               LXL3    COMCOM+91
        31 004435   000076 470400 xsym               LDP0    O1COM+62
        31 004436   000002 443100                    SXL3    2,,PR0

  23930 31 004437   000076 470400 xsym               LDP0    O1COM+62
        31 004440   000003 450100                    STZ     3,,PR0

  23931 31 004441   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 004442   000001 236100                    LDQ     1,,PR0
        31 004443   000076 471400 xsym               LDP1    O1COM+62
        31 004444   100004 756100                    STQ     4,,PR1

  23932 31 004445   000013 236000 32                 LDQ     11
        31 004446   000076 470400 xsym               LDP0    O1COM+62
        31 004447   000005 756100                    STQ     5,,PR0

  23933 31 004450   000013 236000 32                 LDQ     11
        31 004451   000076 470400 xsym               LDP0    O1COM+62
        31 004452   000007 756100                    STQ     7,,PR0

  23934 31 004453   000076 470400 xsym               LDP0    O1COM+62
        31 004454   000010 741100                    STX1    8,,PR0

  23935 31 004455   777777 223003                    LDX3    -1,DU
        31 004456   000076 470400 xsym               LDP0    O1COM+62
        31 004457   000010 443100                    SXL3    8,,PR0

  23939 31 004460   000013 236000 32                 LDQ     11
        31 004461   000076 470400 xsym               LDP0    O1COM+62
        31 004462   000012 756100                    STQ     10,,PR0

  23942 31 004463   000057 236000 xsym               LDQ     O1COM+47
        31 004464   000076 470400 xsym               LDP0    O1COM+62
        31 004465   000011 756100                    STQ     9,,PR0

  23943 31 004466   000057 236000 xsym               LDQ     O1COM+47
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:189  
        31 004467   000013 116000 32                 CMPQ    11
        31 004470   004514 600000 31                 TZE     s:23978

  23947 31 004471   000057 470400 xsym               LDP0    O1COM+47
        31 004472   000001 471500                    LDP1    1,,PR0
        31 004473   100012 236100                    LDQ     10,,PR1
        31 004474   000013 116000 32                 CMPQ    11
        31 004475   004505 601000 31                 TNZ     s:23954

  23949 31 004476   000076 236000 xsym               LDQ     O1COM+62
        31 004477   100011 756100                    STQ     9,,PR1

  23950 31 004500   000057 470400 xsym               LDP0    O1COM+47
        31 004501   000001 471500                    LDP1    1,,PR0
        31 004502   000076 236000 xsym               LDQ     O1COM+62
        31 004503   100012 756100                    STQ     10,,PR1

  23951 31 004504   004514 710000 31                 TRA     s:23978

  23954 31 004505   100012 473500                    LDP3    10,,PR1
        31 004506   000076 236000 xsym               LDQ     O1COM+62
        31 004507   300012 756100                    STQ     10,,PR3

  23955 31 004510   000057 470400 xsym               LDP0    O1COM+47
        31 004511   000001 471500                    LDP1    1,,PR0
        31 004512   000076 236000 xsym               LDQ     O1COM+62
        31 004513   100012 756100                    STQ     10,,PR1

  23978 31 004514   000010 224003                    LDX4    8,DU
        31 004515   000076 470400 xsym               LDP0    O1COM+62
        31 004516   000002 744100                    STX4    2,,PR0

  23983 31 004517   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 004520   000076 470400 xsym               LDP0    O1COM+62
        31 004521   000006 756100                    STQ     6,,PR0

  24000 31 004522   000076 470400 xsym               LDP0    O1COM+62
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:190  
        31 004523   010000 236003                    LDQ     4096,DU
        31 004524   000003 256100                    ORSQ    3,,PR0

  24048 31 004525   000076 470400 xsym               LDP0    O1COM+62
        31 004526   000003 236100                    LDQ     3,,PR0
        31 004527   000054 376000 32                 ANQ     44
        31 004530   000002 276007                    ORQ     2,DL
        31 004531   000003 756100                    STQ     3,,PR0

     1085    24069
     1086    24070        %NEW_QLT  ( @POINTER = NEW_QLT$,
     1087    24071                    @DNT$    = NEW_DNT$,
     1088    24072                    @ST$     = O1COM.DML_IA$);

  24077 31 004532   000002 236000 6                  LDQ     QLT_+2
        31 004533   000006 036007                    ADLQ    6,DL
        31 004534   000003 116000 6                  CMPQ    QLT_+3
        31 004535   004546 602000 31                 TNC     s:24079

  24078 31 004536   000042 236000 32                 LDQ     34
        31 004537   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 004540   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004541   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 004542   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 004543   000005 631400 32                 EPPR1   5
        31 004544   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 004545   000000 011000                    NOP     0

  24079 31 004546   000002 236000 6                  LDQ     QLT_+2
        31 004547   000022 736000                    QLS     18
        31 004550   000001 036000 6                  ADLQ    QLT_+1
        31 004551   200010 756100                    STQ     NEW_QLT$,,AUTO

  24080 31 004552   000002 235000 6                  LDA     QLT_+2
        31 004553   000006 035007                    ADLA    6,DL
        31 004554   000002 755000 6                  STA     QLT_+2

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:191  
  24081 31 004555   001053 220003                    LDX0    555,DU
        31 004556   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 004557   000000 740100                    STX0    0,,PR0

  24084 31 004560   000013 236000 32                 LDQ     11
        31 004561   000001 756100                    STQ     1,,PR0

  24085 31 004562   000013 236000 32                 LDQ     11
        31 004563   000002 756100                    STQ     2,,PR0

  24086 31 004564   000013 236000 32                 LDQ     11
        31 004565   000003 756100                    STQ     3,,PR0

  24087 31 004566   000076 236000 xsym               LDQ     O1COM+62
        31 004567   000004 756100                    STQ     4,,PR0

  24088 31 004570   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 004571   000005 756100                    STQ     5,,PR0

  24089 31 004572   000001 236007                    LDQ     1,DL
        31 004573   000000 552104                    STBQ    0,'04'O,PR0

  24090 31 004574   000000 236003                    LDQ     0,DU
        31 004575   000000 552110                    STBQ    0,'10'O,PR0

  24091 31 004576   000043 236000 32                 LDQ     35
        31 004577   000000 356100                    ANSQ    0,,PR0

  24092 31 004600   000044 236000 32                 LDQ     36
        31 004601   000000 356100                    ANSQ    0,,PR0

  24093 31 004602   000045 236000 32                 LDQ     37
        31 004603   000000 356100                    ANSQ    0,,PR0

  24094 31 004604   000046 236000 32                 LDQ     38
        31 004605   000000 356100                    ANSQ    0,,PR0

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:192  
     1089    24097
     1090    24098        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);

  24100 31 004606   000424 236000 xsym               LDQ     COMCOM+276
        31 004607   000013 116000 32                 CMPQ    11
        31 004610   004614 600000 31                 TZE     s:24102

  24101 31 004611   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 004612   000424 471400 xsym               LDP1    COMCOM+276
        31 004613   100002 756100                    STQ     2,,PR1

  24102 31 004614   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 004615   000424 756000 xsym               STQ     COMCOM+276

     1091    24105
     1092    24106    1   O1COM.DML_IA$ -> SCALAR.QLT$ = NEW_QLT$;

  24106 31 004616   000076 471400 xsym               LDP1    O1COM+62
        31 004617   100007 756100                    STQ     7,,PR1

     1093    24107    1   NEW_DNT$ -> DNT.ST$ = O1COM.DML_IA$;

  24107 31 004620   000076 236000 xsym               LDQ     O1COM+62
        31 004621   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 004622   100001 756100                    STQ     1,,PR1

     1094    24108    1   DESC.DESCL = 0;                                /*V* ZERO DESCL FIELD */

  24108 31 004623   000000 221003                    LDX1    0,DU
        31 004624   200132 741100                    STX1    DESC,,AUTO

     1095    24109
     1096    24110
     1097    24111    1   CALL Z8AH$NEW_DNT('DML$USEP',8,NEW_DNT$);

  24111 31 004625   200014 631500                    EPPR1   NEW_DNT$,,AUTO
        31 004626   200626 451500                    STP1    LINE_NUMBER+3,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:193  
        31 004627   000072 237000 32                 LDAQ    58
        31 004630   200624 757100                    STAQ    LINE_NUMBER+1,,AUTO
        31 004631   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004632   000000 631400 32                 EPPR1   0
        31 004633   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 004634   000000 011000                    NOP     0

     1098    24112        %NEW_SCALAR(@ST$    = O1COM.USEP$,
     1099    24113                    @NEXT   = NEW_DNT$ -> DNT.ST$,
     1100    24114                    @CLASS  = %CLASS_ALPHANUMERIC,
     1101    24115                    @DNT$   = NEW_DNT$,
     1102    24116                    @TYPE   = %TYA);

  24120 31 004635   000002 236000 3                  LDQ     ST_+2
        31 004636   000013 036007                    ADLQ    11,DL
        31 004637   000003 116000 3                  CMPQ    ST_+3
        31 004640   004651 604000 31                 TMI     s:24122

  24121 31 004641   000014 236000 32                 LDQ     12
        31 004642   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 004643   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004644   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 004645   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 004646   000005 631400 32                 EPPR1   5
        31 004647   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 004650   000000 011000                    NOP     0

  24122 31 004651   000002 236000 3                  LDQ     ST_+2
        31 004652   000022 736000                    QLS     18
        31 004653   000001 036000 3                  ADLQ    ST_+1
        31 004654   000073 756000 xsym               STQ     O1COM+59

  24123 31 004655   000013 236007                    LDQ     11,DL
        31 004656   000002 056000 3                  ASQ     ST_+2

  24171 31 004657   000766 220003                    LDX0    502,DU
        31 004660   000073 470400 xsym               LDP0    O1COM+59
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:194  
        31 004661   000000 740100                    STX0    0,,PR0

  24172 31 004662   000073 470400 xsym               LDP0    O1COM+59
        31 004663   003000 236007                    LDQ     1536,DL
        31 004664   000000 552110                    STBQ    0,'10'O,PR0

  24173 31 004665   000073 470400 xsym               LDP0    O1COM+59
        31 004666   000001 236007                    LDQ     1,DL
        31 004667   000000 552104                    STBQ    0,'04'O,PR0

  24174 31 004670   000000 221003                    LDX1    0,DU
        31 004671   000073 470400 xsym               LDP0    O1COM+59
        31 004672   000001 741100                    STX1    1,,PR0

  24175 31 004673   000073 470400 xsym               LDP0    O1COM+59
        31 004674   000001 441100                    SXL1    1,,PR0

  24176 31 004675   000133 722000 xsym               LXL2    COMCOM+91
        31 004676   000073 470400 xsym               LDP0    O1COM+59
        31 004677   000002 442100                    SXL2    2,,PR0

  24177 31 004700   000073 470400 xsym               LDP0    O1COM+59
        31 004701   000003 450100                    STZ     3,,PR0

  24178 31 004702   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 004703   000001 236100                    LDQ     1,,PR0
        31 004704   000073 471400 xsym               LDP1    O1COM+59
        31 004705   100004 756100                    STQ     4,,PR1

  24179 31 004706   000013 236000 32                 LDQ     11
        31 004707   000073 470400 xsym               LDP0    O1COM+59
        31 004710   000005 756100                    STQ     5,,PR0

  24180 31 004711   000013 236000 32                 LDQ     11
        31 004712   000073 470400 xsym               LDP0    O1COM+59
        31 004713   000007 756100                    STQ     7,,PR0

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:195  
  24181 31 004714   000073 470400 xsym               LDP0    O1COM+59
        31 004715   000010 741100                    STX1    8,,PR0

  24182 31 004716   777777 222003                    LDX2    -1,DU
        31 004717   000073 470400 xsym               LDP0    O1COM+59
        31 004720   000010 442100                    SXL2    8,,PR0

  24186 31 004721   000013 236000 32                 LDQ     11
        31 004722   000073 470400 xsym               LDP0    O1COM+59
        31 004723   000012 756100                    STQ     10,,PR0

  24189 31 004724   000057 236000 xsym               LDQ     O1COM+47
        31 004725   000073 470400 xsym               LDP0    O1COM+59
        31 004726   000011 756100                    STQ     9,,PR0

  24190 31 004727   000057 236000 xsym               LDQ     O1COM+47
        31 004730   000013 116000 32                 CMPQ    11
        31 004731   004755 600000 31                 TZE     s:24225

  24194 31 004732   000057 470400 xsym               LDP0    O1COM+47
        31 004733   000001 471500                    LDP1    1,,PR0
        31 004734   100012 236100                    LDQ     10,,PR1
        31 004735   000013 116000 32                 CMPQ    11
        31 004736   004746 601000 31                 TNZ     s:24201

  24196 31 004737   000073 236000 xsym               LDQ     O1COM+59
        31 004740   100011 756100                    STQ     9,,PR1

  24197 31 004741   000057 470400 xsym               LDP0    O1COM+47
        31 004742   000001 471500                    LDP1    1,,PR0
        31 004743   000073 236000 xsym               LDQ     O1COM+59
        31 004744   100012 756100                    STQ     10,,PR1

  24198 31 004745   004755 710000 31                 TRA     s:24225

  24201 31 004746   100012 473500                    LDP3    10,,PR1
        31 004747   000073 236000 xsym               LDQ     O1COM+59
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:196  
        31 004750   300012 756100                    STQ     10,,PR3

  24202 31 004751   000057 470400 xsym               LDP0    O1COM+47
        31 004752   000001 471500                    LDP1    1,,PR0
        31 004753   000073 236000 xsym               LDQ     O1COM+59
        31 004754   100012 756100                    STQ     10,,PR1

  24225 31 004755   000010 223003                    LDX3    8,DU
        31 004756   000073 470400 xsym               LDP0    O1COM+59
        31 004757   000002 743100                    STX3    2,,PR0

  24230 31 004760   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 004761   000073 470400 xsym               LDP0    O1COM+59
        31 004762   000006 756100                    STQ     6,,PR0

  24295 31 004763   000073 470400 xsym               LDP0    O1COM+59
        31 004764   000003 236100                    LDQ     3,,PR0
        31 004765   000054 376000 32                 ANQ     44
        31 004766   000003 276007                    ORQ     3,DL
        31 004767   000003 756100                    STQ     3,,PR0

     1103    24316        %NEW_QLT(@POINTER   = NEW_QLT$,
     1104    24317                 @DNT$      = NEW_DNT$,
     1105    24318                 @ST$       = O1COM.USEP$);

  24323 31 004770   000002 236000 6                  LDQ     QLT_+2
        31 004771   000006 036007                    ADLQ    6,DL
        31 004772   000003 116000 6                  CMPQ    QLT_+3
        31 004773   005004 602000 31                 TNC     s:24325

  24324 31 004774   000042 236000 32                 LDQ     34
        31 004775   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 004776   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 004777   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 005000   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 005001   000005 631400 32                 EPPR1   5
        31 005002   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:197  
        31 005003   000000 011000                    NOP     0

  24325 31 005004   000002 236000 6                  LDQ     QLT_+2
        31 005005   000022 736000                    QLS     18
        31 005006   000001 036000 6                  ADLQ    QLT_+1
        31 005007   200010 756100                    STQ     NEW_QLT$,,AUTO

  24326 31 005010   000002 235000 6                  LDA     QLT_+2
        31 005011   000006 035007                    ADLA    6,DL
        31 005012   000002 755000 6                  STA     QLT_+2

  24327 31 005013   001053 220003                    LDX0    555,DU
        31 005014   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 005015   000000 740100                    STX0    0,,PR0

  24330 31 005016   000013 236000 32                 LDQ     11
        31 005017   000001 756100                    STQ     1,,PR0

  24331 31 005020   000013 236000 32                 LDQ     11
        31 005021   000002 756100                    STQ     2,,PR0

  24332 31 005022   000013 236000 32                 LDQ     11
        31 005023   000003 756100                    STQ     3,,PR0

  24333 31 005024   000073 236000 xsym               LDQ     O1COM+59
        31 005025   000004 756100                    STQ     4,,PR0

  24334 31 005026   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 005027   000005 756100                    STQ     5,,PR0

  24335 31 005030   000001 236007                    LDQ     1,DL
        31 005031   000000 552104                    STBQ    0,'04'O,PR0

  24336 31 005032   000000 236003                    LDQ     0,DU
        31 005033   000000 552110                    STBQ    0,'10'O,PR0

  24337 31 005034   000043 236000 32                 LDQ     35
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:198  
        31 005035   000000 356100                    ANSQ    0,,PR0

  24338 31 005036   000044 236000 32                 LDQ     36
        31 005037   000000 356100                    ANSQ    0,,PR0

  24339 31 005040   000045 236000 32                 LDQ     37
        31 005041   000000 356100                    ANSQ    0,,PR0

  24340 31 005042   000046 236000 32                 LDQ     38
        31 005043   000000 356100                    ANSQ    0,,PR0

     1106    24343        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);

  24345 31 005044   000424 236000 xsym               LDQ     COMCOM+276
        31 005045   000013 116000 32                 CMPQ    11
        31 005046   005052 600000 31                 TZE     s:24347

  24346 31 005047   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 005050   000424 471400 xsym               LDP1    COMCOM+276
        31 005051   100002 756100                    STQ     2,,PR1

  24347 31 005052   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 005053   000424 756000 xsym               STQ     COMCOM+276

     1107    24350    1   O1COM.USEP$ -> SCALAR.QLT$ = NEW_QLT$;

  24350 31 005054   000073 471400 xsym               LDP1    O1COM+59
        31 005055   100007 756100                    STQ     7,,PR1

     1108    24351    1   NEW_DNT$ -> DNT.ST$ = O1COM.USEP$;

  24351 31 005056   000073 236000 xsym               LDQ     O1COM+59
        31 005057   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 005060   100001 756100                    STQ     1,,PR1

     1109    24352
     1110    24353    1   CALL Z8AH$NEW_DNT('DML$RVA',7,NEW_DNT$);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:199  

  24353 31 005061   200014 631500                    EPPR1   NEW_DNT$,,AUTO
        31 005062   200626 451500                    STP1    LINE_NUMBER+3,,AUTO
        31 005063   000074 237000 32                 LDAQ    60
        31 005064   200624 757100                    STAQ    LINE_NUMBER+1,,AUTO
        31 005065   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 005066   000000 631400 32                 EPPR1   0
        31 005067   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 005070   000000 011000                    NOP     0

     1111    24354        %NEW_SCALAR(@ST$    = O1COM.RVA$,
     1112    24355                    @NEXT   = NEW_DNT$ -> DNT.ST$,
     1113    24356                    @CLASS  = %CLASS_ALPHANUMERIC,
     1114    24357                    @DNT$   = NEW_DNT$,
     1115    24358                    @TYPE   = %TYA);

  24362 31 005071   000002 236000 3                  LDQ     ST_+2
        31 005072   000013 036007                    ADLQ    11,DL
        31 005073   000003 116000 3                  CMPQ    ST_+3
        31 005074   005105 604000 31                 TMI     s:24364

  24363 31 005075   000014 236000 32                 LDQ     12
        31 005076   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005077   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 005100   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 005101   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 005102   000005 631400 32                 EPPR1   5
        31 005103   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 005104   000000 011000                    NOP     0

  24364 31 005105   000002 236000 3                  LDQ     ST_+2
        31 005106   000022 736000                    QLS     18
        31 005107   000001 036000 3                  ADLQ    ST_+1
        31 005110   000075 756000 xsym               STQ     O1COM+61

  24365 31 005111   000013 236007                    LDQ     11,DL
        31 005112   000002 056000 3                  ASQ     ST_+2
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:200  

  24413 31 005113   000766 220003                    LDX0    502,DU
        31 005114   000075 470400 xsym               LDP0    O1COM+61
        31 005115   000000 740100                    STX0    0,,PR0

  24414 31 005116   000075 470400 xsym               LDP0    O1COM+61
        31 005117   003000 236007                    LDQ     1536,DL
        31 005120   000000 552110                    STBQ    0,'10'O,PR0

  24415 31 005121   000075 470400 xsym               LDP0    O1COM+61
        31 005122   000001 236007                    LDQ     1,DL
        31 005123   000000 552104                    STBQ    0,'04'O,PR0

  24416 31 005124   000000 221003                    LDX1    0,DU
        31 005125   000075 470400 xsym               LDP0    O1COM+61
        31 005126   000001 741100                    STX1    1,,PR0

  24417 31 005127   000075 470400 xsym               LDP0    O1COM+61
        31 005130   000001 441100                    SXL1    1,,PR0

  24418 31 005131   000133 722000 xsym               LXL2    COMCOM+91
        31 005132   000075 470400 xsym               LDP0    O1COM+61
        31 005133   000002 442100                    SXL2    2,,PR0

  24419 31 005134   000075 470400 xsym               LDP0    O1COM+61
        31 005135   000003 450100                    STZ     3,,PR0

  24420 31 005136   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 005137   000001 236100                    LDQ     1,,PR0
        31 005140   000075 471400 xsym               LDP1    O1COM+61
        31 005141   100004 756100                    STQ     4,,PR1

  24421 31 005142   000013 236000 32                 LDQ     11
        31 005143   000075 470400 xsym               LDP0    O1COM+61
        31 005144   000005 756100                    STQ     5,,PR0

  24422 31 005145   000013 236000 32                 LDQ     11
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:201  
        31 005146   000075 470400 xsym               LDP0    O1COM+61
        31 005147   000007 756100                    STQ     7,,PR0

  24423 31 005150   000075 470400 xsym               LDP0    O1COM+61
        31 005151   000010 741100                    STX1    8,,PR0

  24424 31 005152   777777 222003                    LDX2    -1,DU
        31 005153   000075 470400 xsym               LDP0    O1COM+61
        31 005154   000010 442100                    SXL2    8,,PR0

  24428 31 005155   000013 236000 32                 LDQ     11
        31 005156   000075 470400 xsym               LDP0    O1COM+61
        31 005157   000012 756100                    STQ     10,,PR0

  24431 31 005160   000057 236000 xsym               LDQ     O1COM+47
        31 005161   000075 470400 xsym               LDP0    O1COM+61
        31 005162   000011 756100                    STQ     9,,PR0

  24432 31 005163   000057 236000 xsym               LDQ     O1COM+47
        31 005164   000013 116000 32                 CMPQ    11
        31 005165   005211 600000 31                 TZE     s:24467

  24436 31 005166   000057 470400 xsym               LDP0    O1COM+47
        31 005167   000001 471500                    LDP1    1,,PR0
        31 005170   100012 236100                    LDQ     10,,PR1
        31 005171   000013 116000 32                 CMPQ    11
        31 005172   005202 601000 31                 TNZ     s:24443

  24438 31 005173   000075 236000 xsym               LDQ     O1COM+61
        31 005174   100011 756100                    STQ     9,,PR1

  24439 31 005175   000057 470400 xsym               LDP0    O1COM+47
        31 005176   000001 471500                    LDP1    1,,PR0
        31 005177   000075 236000 xsym               LDQ     O1COM+61
        31 005200   100012 756100                    STQ     10,,PR1

  24440 31 005201   005211 710000 31                 TRA     s:24467
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:202  

  24443 31 005202   100012 473500                    LDP3    10,,PR1
        31 005203   000075 236000 xsym               LDQ     O1COM+61
        31 005204   300012 756100                    STQ     10,,PR3

  24444 31 005205   000057 470400 xsym               LDP0    O1COM+47
        31 005206   000001 471500                    LDP1    1,,PR0
        31 005207   000075 236000 xsym               LDQ     O1COM+61
        31 005210   100012 756100                    STQ     10,,PR1

  24467 31 005211   000010 223003                    LDX3    8,DU
        31 005212   000075 470400 xsym               LDP0    O1COM+61
        31 005213   000002 743100                    STX3    2,,PR0

  24472 31 005214   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 005215   000075 470400 xsym               LDP0    O1COM+61
        31 005216   000006 756100                    STQ     6,,PR0

  24537 31 005217   000075 470400 xsym               LDP0    O1COM+61
        31 005220   000003 236100                    LDQ     3,,PR0
        31 005221   000054 376000 32                 ANQ     44
        31 005222   000003 276007                    ORQ     3,DL
        31 005223   000003 756100                    STQ     3,,PR0

     1116    24558        %NEW_QLT(@POINTER   = NEW_QLT$,
     1117    24559                 @DNT$      = NEW_DNT$,
     1118    24560                 @ST$       = O1COM.RVA$);

  24565 31 005224   000002 236000 6                  LDQ     QLT_+2
        31 005225   000006 036007                    ADLQ    6,DL
        31 005226   000003 116000 6                  CMPQ    QLT_+3
        31 005227   005240 602000 31                 TNC     s:24567

  24566 31 005230   000042 236000 32                 LDQ     34
        31 005231   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005232   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 005233   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:203  
        31 005234   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 005235   000005 631400 32                 EPPR1   5
        31 005236   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 005237   000000 011000                    NOP     0

  24567 31 005240   000002 236000 6                  LDQ     QLT_+2
        31 005241   000022 736000                    QLS     18
        31 005242   000001 036000 6                  ADLQ    QLT_+1
        31 005243   200010 756100                    STQ     NEW_QLT$,,AUTO

  24568 31 005244   000002 235000 6                  LDA     QLT_+2
        31 005245   000006 035007                    ADLA    6,DL
        31 005246   000002 755000 6                  STA     QLT_+2

  24569 31 005247   001053 220003                    LDX0    555,DU
        31 005250   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 005251   000000 740100                    STX0    0,,PR0

  24572 31 005252   000013 236000 32                 LDQ     11
        31 005253   000001 756100                    STQ     1,,PR0

  24573 31 005254   000013 236000 32                 LDQ     11
        31 005255   000002 756100                    STQ     2,,PR0

  24574 31 005256   000013 236000 32                 LDQ     11
        31 005257   000003 756100                    STQ     3,,PR0

  24575 31 005260   000075 236000 xsym               LDQ     O1COM+61
        31 005261   000004 756100                    STQ     4,,PR0

  24576 31 005262   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 005263   000005 756100                    STQ     5,,PR0

  24577 31 005264   000001 236007                    LDQ     1,DL
        31 005265   000000 552104                    STBQ    0,'04'O,PR0

  24578 31 005266   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:204  
        31 005267   000000 552110                    STBQ    0,'10'O,PR0

  24579 31 005270   000043 236000 32                 LDQ     35
        31 005271   000000 356100                    ANSQ    0,,PR0

  24580 31 005272   000044 236000 32                 LDQ     36
        31 005273   000000 356100                    ANSQ    0,,PR0

  24581 31 005274   000045 236000 32                 LDQ     37
        31 005275   000000 356100                    ANSQ    0,,PR0

  24582 31 005276   000046 236000 32                 LDQ     38
        31 005277   000000 356100                    ANSQ    0,,PR0

     1119    24585        %UPDATE_PREV_QLT$(@NEW_QLT$ = NEW_QLT$);

  24587 31 005300   000424 236000 xsym               LDQ     COMCOM+276
        31 005301   000013 116000 32                 CMPQ    11
        31 005302   005306 600000 31                 TZE     s:24589

  24588 31 005303   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 005304   000424 471400 xsym               LDP1    COMCOM+276
        31 005305   100002 756100                    STQ     2,,PR1

  24589 31 005306   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 005307   000424 756000 xsym               STQ     COMCOM+276

     1120    24592    1   O1COM.RVA$ -> SCALAR.QLT$ = NEW_QLT$;

  24592 31 005310   000075 471400 xsym               LDP1    O1COM+61
        31 005311   100007 756100                    STQ     7,,PR1

     1121    24593    1   NEW_DNT$ -> DNT.ST$ = O1COM.RVA$;

  24593 31 005312   000075 236000 xsym               LDQ     O1COM+61
        31 005313   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 005314   100001 756100                    STQ     1,,PR1
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:205  

     1122    24594
     1123    24595        /*V*   Preset the needed items into the DML$INTERFACE$AREA    */
     1124    24596
     1125    24597        %SET_PHASE_1_POSITION(@TYPE = %S_TYPE_INITIALIZE);

  24599 31 005315   000133 235000 xsym               LDA     COMCOM+91
        31 005316   000007 755000 xsym               STA     O1COM+7

  24600 31 005317   000134 236000 xsym               LDQ     COMCOM+92
        31 005320   000010 756000 xsym               STQ     O1COM+8

  24601 31 005321   000011 235000 xsym               LDA     O1COM+9
        31 005322   005337 600000 31                 TZE     s:24983

  24636 31 005323   000077 236000 32                 LDQ     63
        31 005324   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005325   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 005326   200631 451500                    STP1    LINE_NUMBER+6,,AUTO
        31 005327   000100 236000 32                 LDQ     64
        31 005330   200630 756100                    STQ     LINE_NUMBER+5,,AUTO
        31 005331   000102 237000 32                 LDAQ    66
        31 005332   200626 757100                    STAQ    LINE_NUMBER+3,,AUTO
        31 005333   200626 630500                    EPPR0   LINE_NUMBER+3,,AUTO
        31 005334   000016 631400 32                 EPPR1   14
        31 005335   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        31 005336   000000 011000                    NOP     0

  24983 31 005337   000074 235007                    LDA     60,DL
        31 005340   000011 755000 xsym               STA     O1COM+9

     1126    24986
     1127    24987        %NEW_ILL( @ID = %P_A_PRESET,
     1128    24988                  @OFFSET = 1,
     1129    24989                  @LOP    = O1COM.DML_UWA$,
     1130    24990                  @ROPCON = 0,
     1131    24991                  @TO     = O1COM.DML_IA$);
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:206  

  25248 31 005341   000077 236000 32                 LDQ     63
        31 005342   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005343   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 005344   200631 450500                    STP0    LINE_NUMBER+6,,AUTO
        31 005345   000100 236000 32                 LDQ     64
        31 005346   200630 756100                    STQ     LINE_NUMBER+5,,AUTO
        31 005347   000106 237000 32                 LDAQ    70
        31 005350   200626 757100                    STAQ    LINE_NUMBER+3,,AUTO
        31 005351   200626 630500                    EPPR0   LINE_NUMBER+3,,AUTO
        31 005352   000016 631400 32                 EPPR1   14
        31 005353   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        31 005354   000000 011000                    NOP     0

  25252 31 005355   000001 220003                    LDX0    1,DU
        31 005356   000000 470400 13                 LDP0    ILL$
        31 005357   000000 440100                    SXL0    0,,PR0

  25254 31 005360   000000 470400 13                 LDP0    ILL$
        31 005361   000002 450100                    STZ     2,,PR0

  25255 31 005362   000077 236000 xsym               LDQ     O1COM+63
        31 005363   000001 756100                    STQ     1,,PR0

  25256 31 005364   000076 236000 xsym               LDQ     O1COM+62
        31 005365   000003 756100                    STQ     3,,PR0

     1132    25370
     1133    25371    1   NAME =  SCHEMA$ -> LX_ITEM.DNT$ -> DNT.TEXT.NAME;

  25371 31 005366   200004 471500                    LDP1    @SCHEMA$,,AUTO
        31 005367   100000 473500                    LDP3    0,,PR1
        31 005370   300002 474500                    LDP4    2,,PR3
        31 005371   400004 221100                    LDX1    4,,PR4
        31 005372   040100 100540                    MLR     fill='040'O
        31 005373   400004 400011                    ADSC9   4,,PR4                   cn=2,n=*X1
        31 005374   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:207  

     1134    25372    2   DO I = 0 TO 29;                    /*V*   Change   -  to  _  for IDS */

  25372 31 005375   000000 222003                    LDX2    0,DU
        31 005376   200042 742100                    STX2    I,,AUTO

     1135    25373    2       IF SUBSTR(NAME,I,1) = '-'     THEN

  25373 31 005377   200042 235100                    LDA     I,,AUTO
        31 005400   000022 731000                    ARS     18
        31 005401   040000 106505                    CMPC    fill='040'O
        31 005402   200134 000001                    ADSC9   NAME,A,AUTO              cn=0,n=1
        31 005403   000105 000001 32                 ADSC9   69                       cn=0,n=1
        31 005404   005410 601000 31                 TNZ     s:25375

     1136    25374    2           SUBSTR(NAME,I,1) = '_';

  25374 31 005405   040105 100400                    MLR     fill='040'O
        31 005406   000110 000001 32                 ADSC9   72                       cn=0,n=1
        31 005407   200134 000001                    ADSC9   NAME,A,AUTO              cn=0,n=1

     1137    25375    2   END;

  25375 31 005410   000001 620005                    EAX0    1,AL
        31 005411   200042 740100                    STX0    I,,AUTO
        31 005412   000035 100003                    CMPX0   29,DU
        31 005413   005377 604400 31                 TMOZ    s:25373

     1138    25376
     1139    25377        %NEW_CONST( @ST$ = RETURN$);

  25381 31 005414   000002 236000 3                  LDQ     ST_+2
        31 005415   000013 036007                    ADLQ    11,DL
        31 005416   000003 116000 3                  CMPQ    ST_+3
        31 005417   005430 604000 31                 TMI     s:25383

  25382 31 005420   000014 236000 32                 LDQ     12
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:208  
        31 005421   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005422   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 005423   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 005424   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 005425   000005 631400 32                 EPPR1   5
        31 005426   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 005427   000000 011000                    NOP     0

  25383 31 005430   000002 236000 3                  LDQ     ST_+2
        31 005431   000022 736000                    QLS     18
        31 005432   000001 036000 3                  ADLQ    ST_+1
        31 005433   200012 756100                    STQ     RETURN$,,AUTO

  25384 31 005434   000013 236007                    LDQ     11,DL
        31 005435   000002 056000 3                  ASQ     ST_+2

  25387 31 005436   000767 220003                    LDX0    503,DU
        31 005437   200012 470500                    LDP0    RETURN$,,AUTO
        31 005440   000000 740100                    STX0    0,,PR0

  25388 31 005441   200012 470500                    LDP0    RETURN$,,AUTO
        31 005442   001000 236007                    LDQ     512,DL
        31 005443   000000 552110                    STBQ    0,'10'O,PR0

  25389 31 005444   200012 470500                    LDP0    RETURN$,,AUTO
        31 005445   000126 236000 xsym               LDQ     O1COM+86
        31 005446   000000 552104                    STBQ    0,'04'O,PR0

  25390 31 005447   000001 221003                    LDX1    1,DU
        31 005450   200012 470500                    LDP0    RETURN$,,AUTO
        31 005451   000002 741100                    STX1    2,,PR0

  25391 31 005452   200012 470500                    LDP0    RETURN$,,AUTO
        31 005453   000003 450100                    STZ     3,,PR0

  25392 31 005454   000013 236000 32                 LDQ     11
        31 005455   200012 470500                    LDP0    RETURN$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:209  
        31 005456   000004 756100                    STQ     4,,PR0

  25393 31 005457   000013 236000 32                 LDQ     11
        31 005460   200012 470500                    LDP0    RETURN$,,AUTO
        31 005461   000005 756100                    STQ     5,,PR0

  25394 31 005462   000013 236000 32                 LDQ     11
        31 005463   200012 470500                    LDP0    RETURN$,,AUTO
        31 005464   000006 756100                    STQ     6,,PR0

     1140    25418        %NEW_LCNST( @POINTER = NEW_LTS$,
     1141    25419                    @SIZE    = 9,
     1142    25420                    @CONST   = NAME);

  25422 31 005465   000011 235007                    LDA     9,DL
        31 005466   000000 755000 0                  STA     ITERATION

  25500 31 005467   000002 236000 8                  LDQ     LTS_+2
        31 005470   000000 036000 0                  ADLQ    ITERATION
        31 005471   000003 116000 8                  CMPQ    LTS_+3
        31 005472   005503 604000 31                 TMI     s:25502

  25501 31 005473   000027 236000 32                 LDQ     23
        31 005474   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005475   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 005476   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 005477   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 005500   000005 631400 32                 EPPR1   5
        31 005501   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 005502   000000 011000                    NOP     0

  25502 31 005503   000002 236000 8                  LDQ     LTS_+2
        31 005504   000022 736000                    QLS     18
        31 005505   000001 036000 8                  ADLQ    LTS_+1
        31 005506   200016 756100                    STQ     NEW_LTS$,,AUTO

  25503 31 005507   000002 236000 8                  LDQ     LTS_+2
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:210  
        31 005510   000000 036000 0                  ADLQ    ITERATION
        31 005511   000002 756000 8                  STQ     LTS_+2

  25504 31 005512   001106 220003                    LDX0    582,DU
        31 005513   200016 470500                    LDP0    NEW_LTS$,,AUTO
        31 005514   000000 740100                    STX0    0,,PR0

  25506 31 005515   000000 721000 0                  LXL1    ITERATION
        31 005516   000000 441100                    SXL1    0,,PR0

  25510 31 005517   040100 100500                    MLR     fill='040'O
        31 005520   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30
        31 005521   000001 000040                    ADSC9   1,,PR0                   cn=0,n=32

     1143    25513    1   RETURN$ -> CONST.B.LONG_CONSTANT = TRUE;

  25513 31 005522   200012 471500                    LDP1    RETURN$,,AUTO
        31 005523   400000 236003                    LDQ     -131072,DU
        31 005524   100003 256100                    ORSQ    3,,PR1

     1144    25514    1   RETURN$ -> CONST.CONST$.PTR$ = NEW_LTS$;

  25514 31 005525   200016 236100                    LDQ     NEW_LTS$,,AUTO
        31 005526   200012 471500                    LDP1    RETURN$,,AUTO
        31 005527   100010 756100                    STQ     8,,PR1

     1145    25515
     1146    25516    1   RETURN$ -> CONST.ADSC.N = 30;

  25516 31 005530   200012 471500                    LDP1    RETURN$,,AUTO
        31 005531   000036 236007                    LDQ     30,DL
        31 005532   100001 752103                    STCQ    1,'03'O,PR1

     1147    25517    1   RETURN$ -> CONST.TYPE = %TYA;

  25517 31 005533   000010 221003                    LDX1    8,DU
        31 005534   200012 471500                    LDP1    RETURN$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:211  
        31 005535   100002 741100                    STX1    2,,PR1

     1148    25518
     1149    25519        %NEW_ILL(@ID = %PRESET,
     1150    25520                 @LOP = O1COM.DML_IA$,
     1151    25521                 @ROP = RETURN$,
     1152    25522                 @OFFSET = 10);

  25742 31 005536   000077 236000 32                 LDQ     63
        31 005537   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005540   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 005541   200631 451500                    STP1    LINE_NUMBER+6,,AUTO
        31 005542   000100 236000 32                 LDQ     64
        31 005543   200630 756100                    STQ     LINE_NUMBER+5,,AUTO
        31 005544   000112 237000 32                 LDAQ    74
        31 005545   200626 757100                    STAQ    LINE_NUMBER+3,,AUTO
        31 005546   200626 630500                    EPPR0   LINE_NUMBER+3,,AUTO
        31 005547   000016 631400 32                 EPPR1   14
        31 005550   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        31 005551   000000 011000                    NOP     0

  25746 31 005552   000012 220003                    LDX0    10,DU
        31 005553   000000 470400 13                 LDP0    ILL$
        31 005554   000000 440100                    SXL0    0,,PR0

  25748 31 005555   000076 236000 xsym               LDQ     O1COM+62
        31 005556   000000 470400 13                 LDP0    ILL$
        31 005557   000001 756100                    STQ     1,,PR0

  25749 31 005560   200012 236100                    LDQ     RETURN$,,AUTO
        31 005561   000002 756100                    STQ     2,,PR0

     1153    25901
     1154    25902        %NEW_CONST( @ST$ = RETURN$);

  25906 31 005562   000002 236000 3                  LDQ     ST_+2
        31 005563   000013 036007                    ADLQ    11,DL
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:212  
        31 005564   000003 116000 3                  CMPQ    ST_+3
        31 005565   005576 604000 31                 TMI     s:25908

  25907 31 005566   000014 236000 32                 LDQ     12
        31 005567   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005570   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 005571   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 005572   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 005573   000005 631400 32                 EPPR1   5
        31 005574   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 005575   000000 011000                    NOP     0

  25908 31 005576   000002 236000 3                  LDQ     ST_+2
        31 005577   000022 736000                    QLS     18
        31 005600   000001 036000 3                  ADLQ    ST_+1
        31 005601   200012 756100                    STQ     RETURN$,,AUTO

  25909 31 005602   000013 236007                    LDQ     11,DL
        31 005603   000002 056000 3                  ASQ     ST_+2

  25912 31 005604   000767 220003                    LDX0    503,DU
        31 005605   200012 470500                    LDP0    RETURN$,,AUTO
        31 005606   000000 740100                    STX0    0,,PR0

  25913 31 005607   200012 470500                    LDP0    RETURN$,,AUTO
        31 005610   001000 236007                    LDQ     512,DL
        31 005611   000000 552110                    STBQ    0,'10'O,PR0

  25914 31 005612   200012 470500                    LDP0    RETURN$,,AUTO
        31 005613   000126 236000 xsym               LDQ     O1COM+86
        31 005614   000000 552104                    STBQ    0,'04'O,PR0

  25915 31 005615   000001 221003                    LDX1    1,DU
        31 005616   200012 470500                    LDP0    RETURN$,,AUTO
        31 005617   000002 741100                    STX1    2,,PR0

  25916 31 005620   200012 470500                    LDP0    RETURN$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:213  
        31 005621   000003 450100                    STZ     3,,PR0

  25917 31 005622   000013 236000 32                 LDQ     11
        31 005623   200012 470500                    LDP0    RETURN$,,AUTO
        31 005624   000004 756100                    STQ     4,,PR0

  25918 31 005625   000013 236000 32                 LDQ     11
        31 005626   200012 470500                    LDP0    RETURN$,,AUTO
        31 005627   000005 756100                    STQ     5,,PR0

  25919 31 005630   000013 236000 32                 LDQ     11
        31 005631   200012 470500                    LDP0    RETURN$,,AUTO
        31 005632   000006 756100                    STQ     6,,PR0

     1155    25943    1   NAME = SUB_SCHEMA$ -> LX_ITEM.DNT$ -> DNT.TEXT.NAME;

  25943 31 005633   200005 470500                    LDP0    @SUB_SCHEMA$,,AUTO
        31 005634   000000 471500                    LDP1    0,,PR0
        31 005635   100002 473500                    LDP3    2,,PR1
        31 005636   300004 222100                    LDX2    4,,PR3
        31 005637   040100 100540                    MLR     fill='040'O
        31 005640   300004 400012                    ADSC9   4,,PR3                   cn=2,n=*X2
        31 005641   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30

     1156    25944        %NEW_LCNST( @POINTER = NEW_LTS$,
     1157    25945                    @SIZE    = 9,
     1158    25946                    @CONST   = NAME);

  25948 31 005642   000011 235007                    LDA     9,DL
        31 005643   000000 755000 0                  STA     ITERATION

  26026 31 005644   000002 236000 8                  LDQ     LTS_+2
        31 005645   000000 036000 0                  ADLQ    ITERATION
        31 005646   000003 116000 8                  CMPQ    LTS_+3
        31 005647   005660 604000 31                 TMI     s:26028

  26027 31 005650   000027 236000 32                 LDQ     23
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:214  
        31 005651   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005652   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 005653   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 005654   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 005655   000005 631400 32                 EPPR1   5
        31 005656   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 005657   000000 011000                    NOP     0

  26028 31 005660   000002 236000 8                  LDQ     LTS_+2
        31 005661   000022 736000                    QLS     18
        31 005662   000001 036000 8                  ADLQ    LTS_+1
        31 005663   200016 756100                    STQ     NEW_LTS$,,AUTO

  26029 31 005664   000002 236000 8                  LDQ     LTS_+2
        31 005665   000000 036000 0                  ADLQ    ITERATION
        31 005666   000002 756000 8                  STQ     LTS_+2

  26030 31 005667   001106 220003                    LDX0    582,DU
        31 005670   200016 470500                    LDP0    NEW_LTS$,,AUTO
        31 005671   000000 740100                    STX0    0,,PR0

  26032 31 005672   000000 721000 0                  LXL1    ITERATION
        31 005673   000000 441100                    SXL1    0,,PR0

  26036 31 005674   040100 100500                    MLR     fill='040'O
        31 005675   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30
        31 005676   000001 000040                    ADSC9   1,,PR0                   cn=0,n=32

     1159    26039    1   RETURN$ -> CONST.B.LONG_CONSTANT = TRUE;

  26039 31 005677   200012 471500                    LDP1    RETURN$,,AUTO
        31 005700   400000 236003                    LDQ     -131072,DU
        31 005701   100003 256100                    ORSQ    3,,PR1

     1160    26040    1   RETURN$ -> CONST.CONST$.PTR$ = NEW_LTS$;

  26040 31 005702   200016 236100                    LDQ     NEW_LTS$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:215  
        31 005703   200012 471500                    LDP1    RETURN$,,AUTO
        31 005704   100010 756100                    STQ     8,,PR1

     1161    26041
     1162    26042    1   RETURN$ -> CONST.ADSC.N = 30;

  26042 31 005705   200012 471500                    LDP1    RETURN$,,AUTO
        31 005706   000036 236007                    LDQ     30,DL
        31 005707   100001 752103                    STCQ    1,'03'O,PR1

     1163    26043    1   RETURN$ -> CONST.TYPE = %TYA;

  26043 31 005710   000010 221003                    LDX1    8,DU
        31 005711   200012 471500                    LDP1    RETURN$,,AUTO
        31 005712   100002 741100                    STX1    2,,PR1

     1164    26044
     1165    26045        %NEW_ILL(@ID = %PRESET,
     1166    26046                 @LOP = O1COM.DML_IA$,
     1167    26047                 @ROP = RETURN$,
     1168    26048                 @OFFSET = 18);

  26268 31 005713   000077 236000 32                 LDQ     63
        31 005714   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005715   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 005716   200631 451500                    STP1    LINE_NUMBER+6,,AUTO
        31 005717   000100 236000 32                 LDQ     64
        31 005720   200630 756100                    STQ     LINE_NUMBER+5,,AUTO
        31 005721   000112 237000 32                 LDAQ    74
        31 005722   200626 757100                    STAQ    LINE_NUMBER+3,,AUTO
        31 005723   200626 630500                    EPPR0   LINE_NUMBER+3,,AUTO
        31 005724   000016 631400 32                 EPPR1   14
        31 005725   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        31 005726   000000 011000                    NOP     0

  26272 31 005727   000022 220003                    LDX0    18,DU
        31 005730   000000 470400 13                 LDP0    ILL$
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:216  
        31 005731   000000 440100                    SXL0    0,,PR0

  26274 31 005732   000076 236000 xsym               LDQ     O1COM+62
        31 005733   000000 470400 13                 LDP0    ILL$
        31 005734   000001 756100                    STQ     1,,PR0

  26275 31 005735   200012 236100                    LDQ     RETURN$,,AUTO
        31 005736   000002 756100                    STQ     2,,PR0

     1169    26427
     1170    26428
     1171    26429
     1172    26430        %NEW_CONST( @ST$ = RETURN$);

  26434 31 005737   000002 236000 3                  LDQ     ST_+2
        31 005740   000013 036007                    ADLQ    11,DL
        31 005741   000003 116000 3                  CMPQ    ST_+3
        31 005742   005753 604000 31                 TMI     s:26436

  26435 31 005743   000014 236000 32                 LDQ     12
        31 005744   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 005745   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 005746   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 005747   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 005750   000005 631400 32                 EPPR1   5
        31 005751   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 005752   000000 011000                    NOP     0

  26436 31 005753   000002 236000 3                  LDQ     ST_+2
        31 005754   000022 736000                    QLS     18
        31 005755   000001 036000 3                  ADLQ    ST_+1
        31 005756   200012 756100                    STQ     RETURN$,,AUTO

  26437 31 005757   000013 236007                    LDQ     11,DL
        31 005760   000002 056000 3                  ASQ     ST_+2

  26440 31 005761   000767 220003                    LDX0    503,DU
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:217  
        31 005762   200012 470500                    LDP0    RETURN$,,AUTO
        31 005763   000000 740100                    STX0    0,,PR0

  26441 31 005764   200012 470500                    LDP0    RETURN$,,AUTO
        31 005765   001000 236007                    LDQ     512,DL
        31 005766   000000 552110                    STBQ    0,'10'O,PR0

  26442 31 005767   200012 470500                    LDP0    RETURN$,,AUTO
        31 005770   000126 236000 xsym               LDQ     O1COM+86
        31 005771   000000 552104                    STBQ    0,'04'O,PR0

  26443 31 005772   000001 221003                    LDX1    1,DU
        31 005773   200012 470500                    LDP0    RETURN$,,AUTO
        31 005774   000002 741100                    STX1    2,,PR0

  26444 31 005775   200012 470500                    LDP0    RETURN$,,AUTO
        31 005776   000003 450100                    STZ     3,,PR0

  26445 31 005777   000013 236000 32                 LDQ     11
        31 006000   200012 470500                    LDP0    RETURN$,,AUTO
        31 006001   000004 756100                    STQ     4,,PR0

  26446 31 006002   000013 236000 32                 LDQ     11
        31 006003   200012 470500                    LDP0    RETURN$,,AUTO
        31 006004   000005 756100                    STQ     5,,PR0

  26447 31 006005   000013 236000 32                 LDQ     11
        31 006006   200012 470500                    LDP0    RETURN$,,AUTO
        31 006007   000006 756100                    STQ     6,,PR0

     1173    26471    1   NAME = O1COM.PROG_ID_DNT$ -> DNT.TEXT.NAME;

  26471 31 006010   000110 470400 xsym               LDP0    O1COM+72
        31 006011   000004 222100                    LDX2    4,,PR0
        31 006012   040100 100540                    MLR     fill='040'O
        31 006013   000004 400012                    ADSC9   4,,PR0                   cn=2,n=*X2
        31 006014   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:218  

     1174    26472
     1175    26473        %NEW_LCNST( @POINTER = NEW_LTS$,
     1176    26474                    @SIZE    = 30,
     1177    26475                    @CONST   = NAME);

  26477 31 006015   000036 235007                    LDA     30,DL
        31 006016   000000 755000 0                  STA     ITERATION

  26555 31 006017   000002 236000 8                  LDQ     LTS_+2
        31 006020   000000 036000 0                  ADLQ    ITERATION
        31 006021   000003 116000 8                  CMPQ    LTS_+3
        31 006022   006033 604000 31                 TMI     s:26557

  26556 31 006023   000027 236000 32                 LDQ     23
        31 006024   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006025   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 006026   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 006027   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 006030   000005 631400 32                 EPPR1   5
        31 006031   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 006032   000000 011000                    NOP     0

  26557 31 006033   000002 236000 8                  LDQ     LTS_+2
        31 006034   000022 736000                    QLS     18
        31 006035   000001 036000 8                  ADLQ    LTS_+1
        31 006036   200016 756100                    STQ     NEW_LTS$,,AUTO

  26558 31 006037   000002 236000 8                  LDQ     LTS_+2
        31 006040   000000 036000 0                  ADLQ    ITERATION
        31 006041   000002 756000 8                  STQ     LTS_+2

  26559 31 006042   001106 220003                    LDX0    582,DU
        31 006043   200016 470500                    LDP0    NEW_LTS$,,AUTO
        31 006044   000000 740100                    STX0    0,,PR0

  26561 31 006045   000000 721000 0                  LXL1    ITERATION
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:219  
        31 006046   000000 441100                    SXL1    0,,PR0

  26565 31 006047   040100 100500                    MLR     fill='040'O
        31 006050   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30
        31 006051   000001 000164                    ADSC9   1,,PR0                   cn=0,n=116

     1178    26568    1   RETURN$ -> CONST.B.LONG_CONSTANT = TRUE;

  26568 31 006052   200012 471500                    LDP1    RETURN$,,AUTO
        31 006053   400000 236003                    LDQ     -131072,DU
        31 006054   100003 256100                    ORSQ    3,,PR1

     1179    26569    1   RETURN$ -> CONST.CONST$.PTR$ = NEW_LTS$;

  26569 31 006055   200016 236100                    LDQ     NEW_LTS$,,AUTO
        31 006056   200012 471500                    LDP1    RETURN$,,AUTO
        31 006057   100010 756100                    STQ     8,,PR1

     1180    26570
     1181    26571    1   RETURN$ -> CONST.ADSC.N = 30;

  26571 31 006060   200012 471500                    LDP1    RETURN$,,AUTO
        31 006061   000036 236007                    LDQ     30,DL
        31 006062   100001 752103                    STCQ    1,'03'O,PR1

     1182    26572    1   RETURN$ -> CONST.TYPE = %TYA;

  26572 31 006063   000010 221003                    LDX1    8,DU
        31 006064   200012 471500                    LDP1    RETURN$,,AUTO
        31 006065   100002 741100                    STX1    2,,PR1

     1183    26573
     1184    26574        %NEW_ILL(@ID = %PRESET,
     1185    26575                 @LOP = O1COM.DML_IA$,
     1186    26576                 @ROP = RETURN$,
     1187    26577                 @OFFSET = 26);

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:220  
  26797 31 006066   000077 236000 32                 LDQ     63
        31 006067   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006070   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 006071   200631 451500                    STP1    LINE_NUMBER+6,,AUTO
        31 006072   000100 236000 32                 LDQ     64
        31 006073   200630 756100                    STQ     LINE_NUMBER+5,,AUTO
        31 006074   000112 237000 32                 LDAQ    74
        31 006075   200626 757100                    STAQ    LINE_NUMBER+3,,AUTO
        31 006076   200626 630500                    EPPR0   LINE_NUMBER+3,,AUTO
        31 006077   000016 631400 32                 EPPR1   14
        31 006100   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        31 006101   000000 011000                    NOP     0

  26801 31 006102   000032 220003                    LDX0    26,DU
        31 006103   000000 470400 13                 LDP0    ILL$
        31 006104   000000 440100                    SXL0    0,,PR0

  26803 31 006105   000076 236000 xsym               LDQ     O1COM+62
        31 006106   000000 470400 13                 LDP0    ILL$
        31 006107   000001 756100                    STQ     1,,PR0

  26804 31 006110   200012 236100                    LDQ     RETURN$,,AUTO
        31 006111   000002 756100                    STQ     2,,PR0

     1188    26956
     1189    26957        %NEW_CONST( @ST$ = RETURN$);

  26961 31 006112   000002 236000 3                  LDQ     ST_+2
        31 006113   000013 036007                    ADLQ    11,DL
        31 006114   000003 116000 3                  CMPQ    ST_+3
        31 006115   006126 604000 31                 TMI     s:26963

  26962 31 006116   000014 236000 32                 LDQ     12
        31 006117   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006120   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 006121   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 006122   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:221  
        31 006123   000005 631400 32                 EPPR1   5
        31 006124   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 006125   000000 011000                    NOP     0

  26963 31 006126   000002 236000 3                  LDQ     ST_+2
        31 006127   000022 736000                    QLS     18
        31 006130   000001 036000 3                  ADLQ    ST_+1
        31 006131   200012 756100                    STQ     RETURN$,,AUTO

  26964 31 006132   000013 236007                    LDQ     11,DL
        31 006133   000002 056000 3                  ASQ     ST_+2

  26967 31 006134   000767 220003                    LDX0    503,DU
        31 006135   200012 470500                    LDP0    RETURN$,,AUTO
        31 006136   000000 740100                    STX0    0,,PR0

  26968 31 006137   200012 470500                    LDP0    RETURN$,,AUTO
        31 006140   001000 236007                    LDQ     512,DL
        31 006141   000000 552110                    STBQ    0,'10'O,PR0

  26969 31 006142   200012 470500                    LDP0    RETURN$,,AUTO
        31 006143   000126 236000 xsym               LDQ     O1COM+86
        31 006144   000000 552104                    STBQ    0,'04'O,PR0

  26970 31 006145   000001 221003                    LDX1    1,DU
        31 006146   200012 470500                    LDP0    RETURN$,,AUTO
        31 006147   000002 741100                    STX1    2,,PR0

  26971 31 006150   200012 470500                    LDP0    RETURN$,,AUTO
        31 006151   000003 450100                    STZ     3,,PR0

  26972 31 006152   000013 236000 32                 LDQ     11
        31 006153   200012 470500                    LDP0    RETURN$,,AUTO
        31 006154   000004 756100                    STQ     4,,PR0

  26973 31 006155   000013 236000 32                 LDQ     11
        31 006156   200012 470500                    LDP0    RETURN$,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:222  
        31 006157   000005 756100                    STQ     5,,PR0

  26974 31 006160   000013 236000 32                 LDQ     11
        31 006161   200012 470500                    LDP0    RETURN$,,AUTO
        31 006162   000006 756100                    STQ     6,,PR0

     1190    26998    1   IF COMCOM.AUTHOR$ = ADDR(NIL)   THEN

  26998 31 006163   000505 236000 xsym               LDQ     COMCOM+325
        31 006164   000013 116000 32                 CMPQ    11
        31 006165   006172 601000 31                 TNZ     s:27001

     1191    26999    1       NAME = ' ';

  26999 31 006166   040100 100400                    MLR     fill='040'O
        31 006167   000114 000001 32                 ADSC9   76                       cn=0,n=1
        31 006170   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30
        31 006171   006177 710000 31                 TRA     s:27007

     1192    27000    1   ELSE
     1193    27001    1       NAME = COMCOM.AUTHOR$ -> DNT.TEXT.NAME;

  27001 31 006172   000505 470400 xsym               LDP0    COMCOM+325
        31 006173   000004 222100                    LDX2    4,,PR0
        31 006174   040100 100540                    MLR     fill='040'O
        31 006175   000004 400012                    ADSC9   4,,PR0                   cn=2,n=*X2
        31 006176   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30

     1194    27002
     1195    27003        %NEW_LCNST( @POINTER = NEW_LTS$,
     1196    27004                    @SIZE    = 30,
     1197    27005                    @CONST   = NAME);

  27007 31 006177   000036 235007                    LDA     30,DL
        31 006200   000000 755000 0                  STA     ITERATION

  27085 31 006201   000002 236000 8                  LDQ     LTS_+2
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:223  
        31 006202   000000 036000 0                  ADLQ    ITERATION
        31 006203   000003 116000 8                  CMPQ    LTS_+3
        31 006204   006215 604000 31                 TMI     s:27087

  27086 31 006205   000027 236000 32                 LDQ     23
        31 006206   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006207   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 006210   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 006211   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 006212   000005 631400 32                 EPPR1   5
        31 006213   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 006214   000000 011000                    NOP     0

  27087 31 006215   000002 236000 8                  LDQ     LTS_+2
        31 006216   000022 736000                    QLS     18
        31 006217   000001 036000 8                  ADLQ    LTS_+1
        31 006220   200016 756100                    STQ     NEW_LTS$,,AUTO

  27088 31 006221   000002 236000 8                  LDQ     LTS_+2
        31 006222   000000 036000 0                  ADLQ    ITERATION
        31 006223   000002 756000 8                  STQ     LTS_+2

  27089 31 006224   001106 220003                    LDX0    582,DU
        31 006225   200016 470500                    LDP0    NEW_LTS$,,AUTO
        31 006226   000000 740100                    STX0    0,,PR0

  27091 31 006227   000000 721000 0                  LXL1    ITERATION
        31 006230   000000 441100                    SXL1    0,,PR0

  27095 31 006231   040100 100500                    MLR     fill='040'O
        31 006232   200134 000036                    ADSC9   NAME,,AUTO               cn=0,n=30
        31 006233   000001 000164                    ADSC9   1,,PR0                   cn=0,n=116

     1198    27098    1   RETURN$ -> CONST.B.LONG_CONSTANT = TRUE;

  27098 31 006234   200012 471500                    LDP1    RETURN$,,AUTO
        31 006235   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:224  
        31 006236   100003 256100                    ORSQ    3,,PR1

     1199    27099    1   RETURN$ -> CONST.CONST$.PTR$ = NEW_LTS$;

  27099 31 006237   200016 236100                    LDQ     NEW_LTS$,,AUTO
        31 006240   200012 471500                    LDP1    RETURN$,,AUTO
        31 006241   100010 756100                    STQ     8,,PR1

     1200    27100
     1201    27101    1   RETURN$ -> CONST.ADSC.N = 30;

  27101 31 006242   200012 471500                    LDP1    RETURN$,,AUTO
        31 006243   000036 236007                    LDQ     30,DL
        31 006244   100001 752103                    STCQ    1,'03'O,PR1

     1202    27102    1   RETURN$ -> CONST.TYPE = %TYA;

  27102 31 006245   000010 221003                    LDX1    8,DU
        31 006246   200012 471500                    LDP1    RETURN$,,AUTO
        31 006247   100002 741100                    STX1    2,,PR1

     1203    27103
     1204    27104        %NEW_ILL(@ID = %PRESET,
     1205    27105                 @LOP = O1COM.DML_IA$,
     1206    27106                 @ROP = RETURN$,
     1207    27107                 @OFFSET = 34);

  27327 31 006250   000077 236000 32                 LDQ     63
        31 006251   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006252   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 006253   200631 451500                    STP1    LINE_NUMBER+6,,AUTO
        31 006254   000100 236000 32                 LDQ     64
        31 006255   200630 756100                    STQ     LINE_NUMBER+5,,AUTO
        31 006256   000112 237000 32                 LDAQ    74
        31 006257   200626 757100                    STAQ    LINE_NUMBER+3,,AUTO
        31 006260   200626 630500                    EPPR0   LINE_NUMBER+3,,AUTO
        31 006261   000016 631400 32                 EPPR1   14
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:225  
        31 006262   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        31 006263   000000 011000                    NOP     0

  27331 31 006264   000042 220003                    LDX0    34,DU
        31 006265   000000 470400 13                 LDP0    ILL$
        31 006266   000000 440100                    SXL0    0,,PR0

  27333 31 006267   000076 236000 xsym               LDQ     O1COM+62
        31 006270   000000 470400 13                 LDP0    ILL$
        31 006271   000001 756100                    STQ     1,,PR0

  27334 31 006272   200012 236100                    LDQ     RETURN$,,AUTO
        31 006273   000002 756100                    STQ     2,,PR0

     1208    27486
     1209    27487        %NEW_CONST( @ST$ = RETURN$);

  27491 31 006274   000002 236000 3                  LDQ     ST_+2
        31 006275   000013 036007                    ADLQ    11,DL
        31 006276   000003 116000 3                  CMPQ    ST_+3
        31 006277   006310 604000 31                 TMI     s:27493

  27492 31 006300   000014 236000 32                 LDQ     12
        31 006301   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006302   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 006303   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 006304   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 006305   000005 631400 32                 EPPR1   5
        31 006306   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 006307   000000 011000                    NOP     0

  27493 31 006310   000002 236000 3                  LDQ     ST_+2
        31 006311   000022 736000                    QLS     18
        31 006312   000001 036000 3                  ADLQ    ST_+1
        31 006313   200012 756100                    STQ     RETURN$,,AUTO

  27494 31 006314   000013 236007                    LDQ     11,DL
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:226  
        31 006315   000002 056000 3                  ASQ     ST_+2

  27497 31 006316   000767 220003                    LDX0    503,DU
        31 006317   200012 470500                    LDP0    RETURN$,,AUTO
        31 006320   000000 740100                    STX0    0,,PR0

  27498 31 006321   200012 470500                    LDP0    RETURN$,,AUTO
        31 006322   001000 236007                    LDQ     512,DL
        31 006323   000000 552110                    STBQ    0,'10'O,PR0

  27499 31 006324   200012 470500                    LDP0    RETURN$,,AUTO
        31 006325   000126 236000 xsym               LDQ     O1COM+86
        31 006326   000000 552104                    STBQ    0,'04'O,PR0

  27500 31 006327   000001 221003                    LDX1    1,DU
        31 006330   200012 470500                    LDP0    RETURN$,,AUTO
        31 006331   000002 741100                    STX1    2,,PR0

  27501 31 006332   200012 470500                    LDP0    RETURN$,,AUTO
        31 006333   000003 450100                    STZ     3,,PR0

  27502 31 006334   000013 236000 32                 LDQ     11
        31 006335   200012 470500                    LDP0    RETURN$,,AUTO
        31 006336   000004 756100                    STQ     4,,PR0

  27503 31 006337   000013 236000 32                 LDQ     11
        31 006340   200012 470500                    LDP0    RETURN$,,AUTO
        31 006341   000005 756100                    STQ     5,,PR0

  27504 31 006342   000013 236000 32                 LDQ     11
        31 006343   200012 470500                    LDP0    RETURN$,,AUTO
        31 006344   000006 756100                    STQ     6,,PR0

     1210    27528    1   RETURN$ -> CONST.CONSTA = IA_TIME_DATE;

  27528 31 006345   200012 470500                    LDP0    RETURN$,,AUTO
        31 006346   200620 237100                    LDAQ    IA_TIME_DATE,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:227  
        31 006347   000010 755100                    STA     8,,PR0
        31 006350   000011 756100                    STQ     9,,PR0

     1211    27529    1   RETURN$ -> CONST.ADSC.N = 8;

  27529 31 006351   200012 470500                    LDP0    RETURN$,,AUTO
        31 006352   000010 236007                    LDQ     8,DL
        31 006353   000001 752103                    STCQ    1,'03'O,PR0

     1212    27530    1   RETURN$ -> CONST.TYPE = %TYA;

  27530 31 006354   000010 222003                    LDX2    8,DU
        31 006355   200012 470500                    LDP0    RETURN$,,AUTO
        31 006356   000002 742100                    STX2    2,,PR0

     1213    27531
     1214    27532        %NEW_ILL( @ID = %PRESET,
     1215    27533                  @LOP = O1COM.DML_IA$,
     1216    27534                  @ROP = RETURN$,
     1217    27535                  @OFFSET = 44);

  27755 31 006357   000077 236000 32                 LDQ     63
        31 006360   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006361   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 006362   200631 450500                    STP0    LINE_NUMBER+6,,AUTO
        31 006363   000100 236000 32                 LDQ     64
        31 006364   200630 756100                    STQ     LINE_NUMBER+5,,AUTO
        31 006365   000112 237000 32                 LDAQ    74
        31 006366   200626 757100                    STAQ    LINE_NUMBER+3,,AUTO
        31 006367   200626 630500                    EPPR0   LINE_NUMBER+3,,AUTO
        31 006370   000016 631400 32                 EPPR1   14
        31 006371   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        31 006372   000000 011000                    NOP     0

  27759 31 006373   000054 220003                    LDX0    44,DU
        31 006374   000000 470400 13                 LDP0    ILL$
        31 006375   000000 440100                    SXL0    0,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:228  

  27761 31 006376   000076 236000 xsym               LDQ     O1COM+62
        31 006377   000000 470400 13                 LDP0    ILL$
        31 006400   000001 756100                    STQ     1,,PR0

  27762 31 006401   200012 236100                    LDQ     RETURN$,,AUTO
        31 006402   000002 756100                    STQ     2,,PR0

     1218    27914
     1219    27915    1   RETURN;

  27915 31 006403   000000 702200 xent               TSX2  ! X66_ARET

     1220    27916        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:229  
     1221    27917        /*-------------*/
     1222    27918    1     BUILD_ST_ITEM :  PROC;

  27918 31 006404   200622 741300       BUILD_ST_IT* STX1  ! IA_TIME_DATE+2,,AUTO

     1223    27919        /*-------------*/
     1224    27920
     1225    27921
     1226    27922    2   DCL    LINE_NUMBER     SBIN WORD;
     1227    27923    2   DCL    Z8DO$LINK_WITH_LTS ENTRY(2);
     1228    27924
     1229    27925
     1230    27926    2        CALL Z8AH$NEW_DNT(TOKEN_9.DATA_ITEM_NAME, TOKEN_9.NAME_SIZE, NEW_DNT$);

  27926 31 006405   200014 630500                    EPPR0   NEW_DNT$,,AUTO
        31 006406   200626 450500                    STP0    LINE_NUMBER+3,,AUTO
        31 006407   200007 236100                    LDQ     RETURN_PTR$,,AUTO
        31 006410   000027 036003                    ADLQ    23,DU
        31 006411   200625 756100                    STQ     LINE_NUMBER+2,,AUTO
        31 006412   200007 236100                    LDQ     RETURN_PTR$,,AUTO
        31 006413   000030 036003                    ADLQ    24,DU
        31 006414   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006415   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 006416   000000 631400 32                 EPPR1   0
        31 006417   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        31 006420   000000 011000                    NOP     0

     1231    27927    2        IF NEW_DNT$ -> DNT.B.RW   THEN

  27927 31 006421   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 006422   000003 234100                    SZN     3,,PR0
        31 006423   006535 605000 31                 TPL     s:28027

     1232    27928    3          DO;

     1233    27929                                                                  /*#30134*/
     1234    27930    3            LINE_NUMBER = COMCOM.CURRENT.LINE + TOKEN_9.LINE_NUMBER;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:230  

  27930 31 006424   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 006425   000133 236000 xsym               LDQ     COMCOM+91
        31 006426   100001 036100                    ADLQ    1,,PR1
        31 006427   200623 756100                    STQ     LINE_NUMBER,,AUTO

     1235    27931
     1236    27932    3            CALL Z8AE$ERROR( %E$RW_USED_AS_DATA_NAME,

  27932 31 006430   200014 633500                    EPPR3   NEW_DNT$,,AUTO
        31 006431   200627 453500                    STP3    LINE_NUMBER+4,,AUTO
        31 006432   200007 236100                    LDQ     RETURN_PTR$,,AUTO
        31 006433   000002 036003                    ADLQ    2,DU
        31 006434   200626 756100                    STQ     LINE_NUMBER+3,,AUTO
        31 006435   200623 634500                    EPPR4   LINE_NUMBER,,AUTO
        31 006436   200625 454500                    STP4    LINE_NUMBER+2,,AUTO
        31 006437   000037 236000 32                 LDQ     31
        31 006440   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006441   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 006442   000016 631400 32                 EPPR1   14
        31 006443   000000 701000 xent               TSX1    Z8AE$ERROR
        31 006444   000000 011000                    NOP     0

     1237    27933    3                             LINE_NUMBER,
     1238    27934    3                             TOKEN_9.COLUMN,
     1239    27935    3                             NEW_DNT$ );
     1240    27936                  %NEW_DNT(@SIZE = TOKEN_9.NAME_SIZE,
     1241    27937                              @POINTER = NEW_DNT$$,
     1242    27938                              @NAME = TOKEN_9.DATA_ITEM_NAME,
     1243    27939                              @ST$ = "ADDR(NIL)",
     1244    27940                              @NEXT = "DNT_BUCKETS(DNT_BUCKET_NUMBER)");

  27943 31 006445   200007 470500                    LDP0    RETURN_PTR$,,AUTO
        31 006446   000027 236100                    LDQ     23,,PR0
        31 006447   000025 036007                    ADLQ    21,DL
        31 006450   000002 772000                    QRL     2
        31 006451   000000 756000 0                  STQ     ITERATION
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:231  

  27944 31 006452   000002 036000 10                 ADLQ    DNT_+2
        31 006453   006466 604000 31                 TMI     s:27946
        31 006454   000003 116000 10                 CMPQ    DNT_+3
        31 006455   006466 602000 31                 TNC     s:27946

  27945 31 006456   000040 236000 32                 LDQ     32
        31 006457   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006460   200624 631500                    EPPR1   LINE_NUMBER+1,,AUTO
        31 006461   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 006462   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 006463   000005 631400 32                 EPPR1   5
        31 006464   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 006465   000000 011000                    NOP     0

  27946 31 006466   000002 236000 10                 LDQ     DNT_+2
        31 006467   000022 736000                    QLS     18
        31 006470   000001 036000 10                 ADLQ    DNT_+1
        31 006471   200015 756100                    STQ     NEW_DNT$$,,AUTO

  27947 31 006472   000002 236000 10                 LDQ     DNT_+2
        31 006473   000000 036000 0                  ADLQ    ITERATION
        31 006474   000002 756000 10                 STQ     DNT_+2

  27948 31 006475   001046 220003                    LDX0    550,DU
        31 006476   200015 470500                    LDP0    NEW_DNT$$,,AUTO
        31 006477   000000 740100                    STX0    0,,PR0

  27949 31 006500   000000 721000 0                  LXL1    ITERATION
        31 006501   000000 441100                    SXL1    0,,PR0

  27950 31 006502   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 006503   100027 722100                    LXL2    23,,PR1
        31 006504   000004 742100                    STX2    4,,PR0

  27953 31 006505   000013 236000 32                 LDQ     11
        31 006506   000001 756100                    STQ     1,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:232  

  27954 31 006507   000000 723000 11                 LXL3    DNT_BUCKET_NUMBER
        31 006510   000000 236013 xsym               LDQ     DNT_BUCKETS,X3
        31 006511   000002 756100                    STQ     2,,PR0

  27955 31 006512   000000 224003                    LDX4    0,DU
        31 006513   000003 744100                    STX4    3,,PR0

  27956 31 006514   000000 225003                    LDX5    0,DU
        31 006515   000003 445100                    SXL5    3,,PR0

  27957 31 006516   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 006517   100027 726100                    LXL6    23,,PR1
        31 006520   040140 100540                    MLR     fill='040'O
        31 006521   100030 000016                    ADSC9   24,,PR1                  cn=0,n=*X6
        31 006522   000004 400012                    ADSC9   4,,PR0                   cn=2,n=*X2

     1245    27998    3             NEW_DNT$$ -> DNT.ATTR = NEW_DNT$ -> DNT.ATTR;

  27998 31 006523   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 006524   100003 226100                    LDX6    3,,PR1
        31 006525   000003 746100                    STX6    3,,PR0

     1246    27999    3             NEW_DNT$$ -> DNT.B.USER_WORD = TRUE;

  27999 31 006526   200000 236003                    LDQ     65536,DU
        31 006527   000003 256100                    ORSQ    3,,PR0

     1247    28000    3             NEW_DNT$$ -> DNT.B.RW = FALSE;

  28000 31 006530   000041 236000 32                 LDQ     33
        31 006531   000003 356100                    ANSQ    3,,PR0

     1248    28001    3             DNT_BUCKETS(DNT_BUCKET_NUMBER) = NEW_DNT$$;

  28001 31 006532   200015 236100                    LDQ     NEW_DNT$$,,AUTO
        31 006533   000000 756013 xsym               STQ     DNT_BUCKETS,X3
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:233  

     1249    28002    3             NEW_DNT$ = NEW_DNT$$;

  28002 31 006534   200014 756100                    STQ     NEW_DNT$,,AUTO

     1250    28003
     1251    28004    3          END;

     1252    28005
     1253    28006             %NEW_SCALAR( @ST$       = RETURN$,
     1254    28007                          @DESCL     = DESC.DESCL,
     1255    28008                          @NEXT      = NEW_DNT$ -> DNT.ST$,
     1256    28009                          @COUNT     = O1COM.DML_UWA$ -> BLOCK.COUNT,
     1257    28010                          @SA        = SA,
     1258    28011                          @CLASS     = CLASS_,
     1259    28012                          @DNT$      = NEW_DNT$,
     1260    28013                          @TYPE      = TYPE,
     1261    28014                          @JUSTIFIED = TOKEN_9.SIB.JUSTIFIED,
     1262    28015                          @ELEMENTARY = TOKEN_9.SIB.ELEMENTARY,
     1263    28016                          @DIGIT     = P_BIT,
     1264    28017                          @GLOBAL    = TRUE,
     1265    28018                          @EXTERNAL  = TRUE,
     1266    28019                          @LENGTH_4096 = LENGTH,
     1267    28020                          @LTS$      = NEW_LTS$,
     1268    28021                          @P         = P_BIT,
     1269    28022                          @DML_UWA   = TOKEN_9.BIB.USER_WORK_AREA,
     1270    28023                          @DML_TYPE  = DML_TYPE);

  28027 31 006535   000002 236000 3                  LDQ     ST_+2
        31 006536   000013 036007                    ADLQ    11,DL
        31 006537   000003 116000 3                  CMPQ    ST_+3
        31 006540   006551 604000 31                 TMI     s:28029

  28028 31 006541   000014 236000 32                 LDQ     12
        31 006542   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006543   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 006544   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:234  
        31 006545   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 006546   000005 631400 32                 EPPR1   5
        31 006547   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 006550   000000 011000                    NOP     0

  28029 31 006551   000002 236000 3                  LDQ     ST_+2
        31 006552   000022 736000                    QLS     18
        31 006553   000001 036000 3                  ADLQ    ST_+1
        31 006554   200012 756100                    STQ     RETURN$,,AUTO

  28030 31 006555   000013 236007                    LDQ     11,DL
        31 006556   000002 056000 3                  ASQ     ST_+2

  28078 31 006557   000766 220003                    LDX0    502,DU
        31 006560   200012 470500                    LDP0    RETURN$,,AUTO
        31 006561   000000 740100                    STX0    0,,PR0

  28079 31 006562   200012 470500                    LDP0    RETURN$,,AUTO
        31 006563   003000 236007                    LDQ     1536,DL
        31 006564   000000 552110                    STBQ    0,'10'O,PR0

  28080 31 006565   000077 470400 xsym               LDP0    O1COM+63
        31 006566   200012 471500                    LDP1    RETURN$,,AUTO
        31 006567   000000 236100                    LDQ     0,,PR0
        31 006570   100000 552104                    STBQ    0,'04'O,PR1

  28081 31 006571   200037 221100                    LDX1    SA,,AUTO
        31 006572   200012 470500                    LDP0    RETURN$,,AUTO
        31 006573   000001 741100                    STX1    1,,PR0

  28082 31 006574   200132 222100                    LDX2    DESC,,AUTO
        31 006575   200012 470500                    LDP0    RETURN$,,AUTO
        31 006576   000001 442100                    SXL2    1,,PR0

  28083 31 006577   000133 723000 xsym               LXL3    COMCOM+91
        31 006600   200012 470500                    LDP0    RETURN$,,AUTO
        31 006601   000002 443100                    SXL3    2,,PR0
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:235  

  28084 31 006602   200012 470500                    LDP0    RETURN$,,AUTO
        31 006603   000003 450100                    STZ     3,,PR0

  28085 31 006604   200014 470500                    LDP0    NEW_DNT$,,AUTO
        31 006605   000001 236100                    LDQ     1,,PR0
        31 006606   200012 471500                    LDP1    RETURN$,,AUTO
        31 006607   100004 756100                    STQ     4,,PR1

  28086 31 006610   200016 236100                    LDQ     NEW_LTS$,,AUTO
        31 006611   200012 470500                    LDP0    RETURN$,,AUTO
        31 006612   000005 756100                    STQ     5,,PR0

  28087 31 006613   000013 236000 32                 LDQ     11
        31 006614   200012 470500                    LDP0    RETURN$,,AUTO
        31 006615   000007 756100                    STQ     7,,PR0

  28088 31 006616   000000 223003                    LDX3    0,DU
        31 006617   200012 470500                    LDP0    RETURN$,,AUTO
        31 006620   000010 743100                    STX3    8,,PR0

  28089 31 006621   777777 224003                    LDX4    -1,DU
        31 006622   200012 470500                    LDP0    RETURN$,,AUTO
        31 006623   000010 444100                    SXL4    8,,PR0

  28093 31 006624   000013 236000 32                 LDQ     11
        31 006625   200012 470500                    LDP0    RETURN$,,AUTO
        31 006626   000012 756100                    STQ     10,,PR0

  28096 31 006627   000057 236000 xsym               LDQ     O1COM+47
        31 006630   200012 470500                    LDP0    RETURN$,,AUTO
        31 006631   000011 756100                    STQ     9,,PR0

  28097 31 006632   000057 236000 xsym               LDQ     O1COM+47
        31 006633   000013 116000 32                 CMPQ    11
        31 006634   006660 600000 31                 TZE     s:28132

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:236  
  28101 31 006635   000057 470400 xsym               LDP0    O1COM+47
        31 006636   000001 471500                    LDP1    1,,PR0
        31 006637   100012 236100                    LDQ     10,,PR1
        31 006640   000013 116000 32                 CMPQ    11
        31 006641   006651 601000 31                 TNZ     s:28108

  28103 31 006642   200012 236100                    LDQ     RETURN$,,AUTO
        31 006643   100011 756100                    STQ     9,,PR1

  28104 31 006644   000057 470400 xsym               LDP0    O1COM+47
        31 006645   000001 471500                    LDP1    1,,PR0
        31 006646   200012 236100                    LDQ     RETURN$,,AUTO
        31 006647   100012 756100                    STQ     10,,PR1

  28105 31 006650   006660 710000 31                 TRA     s:28132

  28108 31 006651   100012 473500                    LDP3    10,,PR1
        31 006652   200012 236100                    LDQ     RETURN$,,AUTO
        31 006653   300012 756100                    STQ     10,,PR3

  28109 31 006654   000057 470400 xsym               LDP0    O1COM+47
        31 006655   000001 471500                    LDP1    1,,PR0
        31 006656   200012 236100                    LDQ     RETURN$,,AUTO
        31 006657   100012 756100                    STQ     10,,PR1

  28132 31 006660   200023 225100                    LDX5    TYPE,,AUTO
        31 006661   200012 470500                    LDP0    RETURN$,,AUTO
        31 006662   000002 745100                    STX5    2,,PR0

  28137 31 006663   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 006664   200012 470500                    LDP0    RETURN$,,AUTO
        31 006665   000006 756100                    STQ     6,,PR0

  28148 31 006666   200012 470500                    LDP0    RETURN$,,AUTO
        31 006667   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 006670   100021 236100                    LDQ     17,,PR1
        31 006671   000040 736000                    QLS     32
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:237  
        31 006672   000003 676100                    ERQ     3,,PR0
        31 006673   040000 376003                    ANQ     16384,DU
        31 006674   000003 656100                    ERSQ    3,,PR0

  28154 31 006675   200012 470500                    LDP0    RETURN$,,AUTO
        31 006676   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 006677   100021 236100                    LDQ     17,,PR1
        31 006700   000004 736000                    QLS     4
        31 006701   000003 676100                    ERQ     3,,PR0
        31 006702   010000 376003                    ANQ     4096,DU
        31 006703   000003 656100                    ERSQ    3,,PR0

  28157 31 006704   200012 470500                    LDP0    RETURN$,,AUTO
        31 006705   200127 236100                    LDQ     LENGTH,,AUTO
        31 006706   000006 772000                    QRL     6
        31 006707   000003 676100                    ERQ     3,,PR0
        31 006710   004000 376003                    ANQ     2048,DU
        31 006711   000003 656100                    ERSQ    3,,PR0

  28181 31 006712   200012 470500                    LDP0    RETURN$,,AUTO
        31 006713   200130 236100                    LDQ     P_BIT,,AUTO
        31 006714   000015 772000                    QRL     13
        31 006715   000003 676100                    ERQ     3,,PR0
        31 006716   000020 376003                    ANQ     16,DU
        31 006717   000003 656100                    ERSQ    3,,PR0

  28184 31 006720   200012 470500                    LDP0    RETURN$,,AUTO
        31 006721   000004 236003                    LDQ     4,DU
        31 006722   000003 256100                    ORSQ    3,,PR0

  28187 31 006723   200012 470500                    LDP0    RETURN$,,AUTO
        31 006724   000010 236003                    LDQ     8,DU
        31 006725   000003 256100                    ORSQ    3,,PR0

  28202 31 006726   200012 470500                    LDP0    RETURN$,,AUTO
        31 006727   200024 236100                    LDQ     CLASS_,,AUTO
        31 006730   000041 772000                    QRL     33
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:238  
        31 006731   000003 676100                    ERQ     3,,PR0
        31 006732   000007 376007                    ANQ     7,DL
        31 006733   000003 656100                    ERSQ    3,,PR0

  28205 31 006734   200012 470500                    LDP0    RETURN$,,AUTO
        31 006735   200025 236100                    LDQ     DML_TYPE,,AUTO
        31 006736   000024 772000                    QRL     20
        31 006737   000003 676100                    ERQ     3,,PR0
        31 006740   160000 376007                    ANQ     57344,DL
        31 006741   000003 656100                    ERSQ    3,,PR0

  28208 31 006742   200012 470500                    LDP0    RETURN$,,AUTO
        31 006743   200007 471500                    LDP1    RETURN_PTR$,,AUTO
        31 006744   100010 236100                    LDQ     8,,PR1
        31 006745   000005 736000                    QLS     5
        31 006746   000003 676100                    ERQ     3,,PR0
        31 006747   200000 376007                    ANQ     65536,DL
        31 006750   000003 656100                    ERSQ    3,,PR0

  28214 31 006751   200012 470500                    LDP0    RETURN$,,AUTO
        31 006752   200130 236100                    LDQ     P_BIT,,AUTO
        31 006753   000034 772000                    QRL     28
        31 006754   000003 676100                    ERQ     3,,PR0
        31 006755   000200 376007                    ANQ     128,DL
        31 006756   000003 656100                    ERSQ    3,,PR0

     1271    28223
     1272    28224    2        IF NEW_LONG$ ~= ADDR(NIL) THEN

  28224 31 006757   200017 236100                    LDQ     NEW_LONG$,,AUTO
        31 006760   000013 116000 32                 CMPQ    11
        31 006761   006773 600000 31                 TZE     s:28235

     1273    28225    2          CALL Z8DO$LINK_WITH_LTS (RETURN$ -> SCALAR.LTS$, NEW_LONG$);

  28225 31 006762   200017 630500                    EPPR0   NEW_LONG$,,AUTO
        31 006763   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:239  
        31 006764   200012 236100                    LDQ     RETURN$,,AUTO
        31 006765   000005 036003                    ADLQ    5,DU
        31 006766   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 006767   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 006770   000021 631400 32                 EPPR1   17
        31 006771   000000 701000 xent               TSX1    Z8DO$LINK_WITH_LTS
        31 006772   000000 011000                    NOP     0

     1274    28226
     1275    28227             %NEW_QLT(    @POINTER   = NEW_QLT$,
     1276    28228                          @DNT$      = NEW_DNT$,
     1277    28229                          @ST$       = RETURN$,
     1278    28230                          @LEVEL#    = LEVEL_#);

  28235 31 006773   000002 236000 6                  LDQ     QLT_+2
        31 006774   000006 036007                    ADLQ    6,DL
        31 006775   000003 116000 6                  CMPQ    QLT_+3
        31 006776   007007 602000 31                 TNC     s:28237

  28236 31 006777   000042 236000 32                 LDQ     34
        31 007000   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 007001   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 007002   200625 450500                    STP0    LINE_NUMBER+2,,AUTO
        31 007003   200625 630500                    EPPR0   LINE_NUMBER+2,,AUTO
        31 007004   000005 631400 32                 EPPR1   5
        31 007005   000000 701000 xent               TSX1    Z8AR$RESERVER
        31 007006   000000 011000                    NOP     0

  28237 31 007007   000002 236000 6                  LDQ     QLT_+2
        31 007010   000022 736000                    QLS     18
        31 007011   000001 036000 6                  ADLQ    QLT_+1
        31 007012   200010 756100                    STQ     NEW_QLT$,,AUTO

  28238 31 007013   000002 235000 6                  LDA     QLT_+2
        31 007014   000006 035007                    ADLA    6,DL
        31 007015   000002 755000 6                  STA     QLT_+2

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:240  
  28239 31 007016   001053 220003                    LDX0    555,DU
        31 007017   200010 470500                    LDP0    NEW_QLT$,,AUTO
        31 007020   000000 740100                    STX0    0,,PR0

  28242 31 007021   000013 236000 32                 LDQ     11
        31 007022   000001 756100                    STQ     1,,PR0

  28243 31 007023   000013 236000 32                 LDQ     11
        31 007024   000002 756100                    STQ     2,,PR0

  28244 31 007025   000013 236000 32                 LDQ     11
        31 007026   000003 756100                    STQ     3,,PR0

  28245 31 007027   200012 236100                    LDQ     RETURN$,,AUTO
        31 007030   000004 756100                    STQ     4,,PR0

  28246 31 007031   200014 236100                    LDQ     NEW_DNT$,,AUTO
        31 007032   000005 756100                    STQ     5,,PR0

  28247 31 007033   200026 236100                    LDQ     LEVEL_#,,AUTO
        31 007034   000000 552104                    STBQ    0,'04'O,PR0

  28248 31 007035   000000 236003                    LDQ     0,DU
        31 007036   000000 552110                    STBQ    0,'10'O,PR0

  28249 31 007037   000043 236000 32                 LDQ     35
        31 007040   000000 356100                    ANSQ    0,,PR0

  28250 31 007041   000044 236000 32                 LDQ     36
        31 007042   000000 356100                    ANSQ    0,,PR0

  28251 31 007043   000045 236000 32                 LDQ     37
        31 007044   000000 356100                    ANSQ    0,,PR0

  28252 31 007045   000046 236000 32                 LDQ     38
        31 007046   000000 356100                    ANSQ    0,,PR0

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:241  
     1279    28255
     1280    28256    2        RETURN$ -> SCALAR.QLT$ = NEW_QLT$;

  28256 31 007047   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 007050   200012 471500                    LDP1    RETURN$,,AUTO
        31 007051   100007 756100                    STQ     7,,PR1

     1281    28257    2        NEW_DNT$ -> DNT.ST$ = RETURN$;

  28257 31 007052   200012 236100                    LDQ     RETURN$,,AUTO
        31 007053   200014 471500                    LDP1    NEW_DNT$,,AUTO
        31 007054   100001 756100                    STQ     1,,PR1

     1282    28258
     1283    28259    2        IF DML_STK_PTR > 98 THEN                  /* Impossible */

  28259 31 007055   200032 235100                    LDA     DML_STK_PTR,,AUTO
        31 007056   000143 115007                    CMPA    99,DL
        31 007057   007072 602000 31                 TNC     s:28269

     1284    28260    2          CALL Z8AE$ERROR( %E$DML_STACK_OVERFLOW_ERROR,

  28260 31 007060   000102 236000 32                 LDQ     66
        31 007061   200626 756100                    STQ     LINE_NUMBER+3,,AUTO
        31 007062   200623 631500                    EPPR1   LINE_NUMBER,,AUTO
        31 007063   200625 451500                    STP1    LINE_NUMBER+2,,AUTO
        31 007064   000116 236000 32                 LDQ     78
        31 007065   200624 756100                    STQ     LINE_NUMBER+1,,AUTO
        31 007066   200624 630500                    EPPR0   LINE_NUMBER+1,,AUTO
        31 007067   000000 631400 32                 EPPR1   0
        31 007070   000000 701000 xent               TSX1    Z8AE$ERROR
        31 007071   000000 011000                    NOP     0

     1285    28261    2                           LINE_NUMBER,
     1286    28262    2                           0 );
     1287    28263
     1288    28264             %UPDATE_DML_STK( @HEAD = DML_STK_PTR,
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:242  
     1289    28265                               @QLT$ = NEW_QLT$,
     1290    28266                               @LEVEL#  = LEVEL_#,
     1291    28267                      @PTR_TO_FATHER = DML_STK_PTR_OF_FATHER);

  28269 31 007072   200032 236100                    LDQ     DML_STK_PTR,,AUTO
        31 007073   000003 402007                    MPY     3,DL
        31 007074   000000 620006                    EAX0    0,QL
        31 007075   200010 236100                    LDQ     NEW_QLT$,,AUTO
        31 007076   200144 756110                    STQ     DML_STK,X0,AUTO

  28270 31 007077   200026 235100                    LDA     LEVEL_#,,AUTO
        31 007100   200145 755110                    STA     DML_STK+1,X0,AUTO

  28271 31 007101   200033 235100                    LDA     DML_STK_PTR_OF_FATHER,,AUTO
        31 007102   200146 755110                    STA     DML_STK+2,X0,AUTO

     1292    28274    2   END BUILD_ST_ITEM;

  28274 31 007103   200622 221300                    LDX1  ! IA_TIME_DATE+2,,AUTO
        31 007104   000001 702211                    TSX2  ! 1,X1
     1293    28275        %EJECT;
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:243  
     1294    28276    1   END;                     /*V*      MAIN      */

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:244  
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_DML.:Z8A6TOU  is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8DM$DML_UWA.
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:245  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 002 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 003 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_

  ****  Section 004 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 005 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:246  
  ****  Section 006 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 QLT_

  ****  Section 007 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 008 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 009 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 010 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 DNT_

  ****  Section 011 LblCom DNT_BUCKET_NUMBER

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:247  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 DNT_BUCKET_NUMBER

  ****  Section 012 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 013 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 014 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 015 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 016 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:248  

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 017 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 018 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 019 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 020 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LINE_LIST$

  ****  Section 021 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:249  

  ****  Section 022 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 023 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 024 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 025 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 026 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 027 LblCom TEMP_LEX_SYMBOL
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:250  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 028 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 029  Data  Z8DM$DML_UWA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    53-0-0/w SBIN        r     1 NAME_LENGTH(0:7)
     0-0-0/b BIT         r     1 NEED_DUMMY_BUF
    63-0-0/w UBIN(18)    r     1 REGISTER_LENGTH(0:7)
     1-0-0/c CHAR(17)    r     1 REGISTER_NAME(0:7)
    43-0-0/w UBIN(18)    r     1 REGISTER_OFFSET(0:7)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @POINT$                    3-0-0/w PTR         r     1 @PRIVACY$
     4-0-0/w PTR         r     1 @SCHEMA$                   5-0-0/w PTR         r     1 @SUB_SCHEMA$
    24-0-0/w UBIN(3)     r     1 CLASS_                    21-0-0/w PTR         r     1 CURRENT_LTS$
    20-0-0/w PTR         r     1 CURRENT_PTR$             132-0-0/b STRC(18)    r     1 DESC
    34-0-0/w UBIN(18)    r     1 DML_ID                   144-0-0/w STRC(108)   r     1 DML_STK(0:99)
    32-0-0/w UBIN        r     1 DML_STK_PTR
    33-0-0/w UBIN        r     1 DML_STK_PTR_OF_FATHER
    25-0-0/w UBIN(3)     r     1 DML_TYPE                 131-0-0/b BIT         r     1 FOUND
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:251  
    22-0-0/w PTR         r     1 HEAD$                     13-0-0/w PTR         r     1 HEAD_UWA_QLT$
    42-0-0/w SBIN(18)    r     1 I                        620-0-0/c CHAR(8)     r     1 IA_TIME_DATE
    35-0-0/b BIT         r     1 INDEXED_REALM             43-0-0/w UBIN        r     1 J
    44-0-0/w UBIN        r     1 K                        127-0-0/b BIT         r     1 LENGTH
    26-0-0/w UBIN        r     1 LEVEL_#                  623-0-0/w SBIN        r     1 LINE_NUMBER
    41-0-0/b BIT (2)     r     1 MEMBERSHIP               134-0-0/c CHAR(30)    r     1 NAME
    30-0-0/c CHAR(6)     r     1 NAME_X                    14-0-0/w PTR         r     1 NEW_DNT$
    15-0-0/w PTR         r     1 NEW_DNT$$                 17-0-0/w PTR         r     1 NEW_LONG$
    16-0-0/w PTR         r     1 NEW_LTS$                  10-0-0/w PTR         r     1 NEW_QLT$
    27-0-0/w UBIN        r     1 NEXT_LEVEL                *0-0-0/w PTR         r     1 POINT$
    11-0-0/w PTR         r     1 PREVIOUS_BRO_QLT$         *0-0-0/w PTR         r     1 PRIVACY$
   130-0-0/b BIT         r     1 P_BIT                     36-0-0/w UBIN        r     1 REALM_NO
   133-0-0/b STRC        r     1 RECORD_INFO               12-0-0/w PTR         r     1 RETURN$
     7-0-0/w PTR         r     1 RETURN_PTR$               37-0-0/w UBIN(18)    r     1 SA
    *0-0-0/w PTR         r     1 SCHEMA$
    45-0-0/w UBIN(9)     r     1 START_LEVEL_#(0:49)
    *0-0-0/w PTR         r     1 SUB_SCHEMA$               23-0-0/w UBIN(18)    r     1 TYPE
    30-0-0/c STRC(54)    r     1 UWA_NAME                  40-0-0/w UBIN(18)    r     1 WORD_OFFSET

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w PTR         r     1 DNT_BUCKETS(0:1128)
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:252  
     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(396)   r     1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/c ACHR              1 BUFFER_LINE                0-0-0/w STRC(288)         1 CALL_STMT
     0-0-0/w STRC(216)         1 CCOSU                      0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(108)         1 CODED_MOVE
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(396)         1 CONDITION
     0-0-0/w STRC(396)   r     1 CONST                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(540)         1 CONTROL_NAME_LTS           0-0-0/w STRC(2304)  r     1 CONTROL_SEG
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)   r     1 DML_ITEM
     0-0-0/w STRC(216)   r     1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w ASTR(396)   r     1 FILL_BUFFER
     0-0-0/w STRC(144)         1 GO                         0-0-0/w STRC(180)         1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:253  
     0-0-0/w STRC(36864) r     1 LCNST                      0-0-0/w STRC(108)         1 LINOI
     0-0-0/w STRC(72)    r     1 LONG                       0-0-0/w STRC        r     1 LTS
     0-0-0/w STRC(360)   r     1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)   r     1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)   r     1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)   r     1 PROC_SUPP                  0-0-0/w STRC(144)   r     1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)         1 REPORT_01_LTS
     0-0-0/w STRC(432)         1 REPORT_ELEM_LTS            0-0-0/w STRC(252)         1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)        1 REPORT_LTS                 0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(144)         1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w ASTR(864)   r     1 TOKEN_9
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
PL6.E3A0      #001=Z8DM$DML_UWA File=Z8DM.:Z8A6TSI                               SAT 08/09/97 11:10 Page:254  
     0-0-0/d STRC(612)         1 USE                        0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)   r     1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8DM$DML_UWA requires 3653 words for executable code.
   Procedure Z8DM$DML_UWA requires 410 words of local(AUTO) storage.

    No errors detected in file Z8DM.:Z8A6TSI    .
