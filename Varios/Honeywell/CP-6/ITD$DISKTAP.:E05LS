VERSION E05

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:1    
        1        1        /*M*     Disk and tape sub-system tables builder */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X* DMR */
        9        9        /*P*     NAME:     ITD$DISKTAPE
       10       10                 PURPOSE:  ITD$DISKTAPE builds and initializes all of the
       11       11                           tables used by the I/O system to access DISK
       12       12                           and TAPE subsystems.
       13       13                 DESCRIPTION: The commands as placed in a command table by the
       14       14                           syntax checking routine are used to build tables in
       15       15                           the TIGR table area of the monitor WSQ and initialize
       16       16                           some tables in static storage.
       17       17                 INPUT:    PTR$ - pointer to next available location in TIGR
       18       18                           table area - parameter
       19       19                           CMD$ - pointer to command table in data segment
       20       20                 OUTPUT:   Built and initialized tables
       21       21                           PTR$ - has been updated to point to next available
       22       22                           location.                     */
       23       23        ITD$DISKTAPE: PROC (PTR$)  ALTRET;
       24       24        /**/
       25       25    1   DCL PTR$ PTR;                           /* PTR TO TIGR TABLE SPACE            */
       26       26        /**/
       27       27        /*  INCLUDE FILES */
       28       28        %INCLUDE IT_ERROR_C;
       29      111        %INCLUDE IT_SUBS_C;
       30      378        %INCLUDE IT$CMDWD;
       31      386        %INCLUDE IT$MPC;
       32      420        %INCLUDE IT$DTDEV;
       33      455        %INCLUDE NI_DATA_R;
       34      892        %INCLUDE FR$RAT;
       35      945        %FR$RAT;
       36      985        %INCLUDE FR_SUBS;
       37     1053        %INCLUDE FT_SUBS;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:2    
       38     1133        %INCLUDE FT$DDT;
       39     1194        %INCLUDE NK_SUBS;
       40     1219        %INCLUDE P_PMDAT_R;
       41     1527        %SUB YES = '1'B/*YES*/;
       42     1528        %SUB NO = '0'B/*NO*/;
       43     1529        /**/
       44     1530        /*  ENTRY DCLS  */
       45     1531        /**/
       46     1532    1   DCL ITE$ERROR ENTRY(2);
       47     1533    1   DCL NID$POSTER ENTRY(3);
       48     1534    1   DCL NIT$POSTER ENTRY(3);
       49     1535    1   DCL ITH$ALLOCATE ENTRY(2) ALTRET;
       50     1536    1   DCL ITH$SQH_INIT ENTRY(2) ALTRET;
       51     1537    1   DCL ITH$RAT_INIT ENTRY(2) ALTRET;
       52     1538    1   DCL ITH$DCT_INIT ENTRY(2) ALTRET;
       53     1539        /**/
       54     1540        /* AUTOMATIC */
       55     1541        /**/
       56     1542    1   DCL CMD$ PTR;
       57     1543    1   DCL SQH$ PTR;
       58     1544    1   DCL DQH$ PTR;
       59     1545    1   DCL DEV$ PTR;
       60     1546    1   DCL RAT$ PTR;
       61     1547    1   DCL DDT$ PTR;
       62     1548    1   DCL MPC$ PTR;
       63     1549    1   DCL DCT_DQH$ PTR;
       64     1550        /**/
       65     1551    1   DCL LA# SBIN(36);
       66     1552    1   DCL IOM# SBIN(36) ;
       67     1553    1   DCL LO_CHAN SBIN(36);
       68     1554    1   DCL HI_CHAN SBIN(36);
       69     1555    1   DCL LA_IOM# SBIN(36);
       70     1556    1   DCL CHTX SBIN(36);
       71     1557    1   DCL I SBIN(36);
       72     1558    1   DCL J SBIN(36);
       73     1559        /**/
       74     1560    1   DCL POSTER EPTR;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:3    
       75     1561        /**/
       76     1562    1   DCL 1 DUPCHANERR_TEXT,
       77     1563    1         2 COUNT UBIN(9) UNAL,
       78     1564    1         2 CHANNEL CHAR(8) UNAL,
       79     1565    1         2 IOMTEXT CHAR(1) UNAL,
       80     1566    1         2 DASH CHAR(1) UNAL,
       81     1567    1         2 CHANTEXT CHAR(2) UNAL;
       82     1568        /*  SYMREFS  */
       83     1569    1   DCL B$REAL$ PTR SYMREF;
       84     1570    1   DCL B$DS5$ PTR SYMREF;                  /* COMMANDS                           */
       85     1571    1   DCL IT_SYSDISK UBIN WORD SYMREF;        /* DCTX OF SYSTEM DISK                */
       86     1572    1   DCL IT_FEI$$ PTR SYMREF;
       87     1573        %NI$PARTITION (NAME=IT_PARTITION,STCLASS=SYMREF);
       88     1581        /**/
       89     1582        %INCLUDE NI_DATA_C;
       90     1695        %INCLUDE N_FC_C;
       91     1732        %INCLUDE FR_DATA_R;
       92     1764        %INCLUDE HF_DATA_R;
       93     1807        %INCLUDE CP_6_SUBS;
       94     2347        %INCLUDE KI_DATA_R;
       95     2373        %INCLUDE IT_IDATA_R;
       96     2490        /**/
       97     2491        /*  BASED */
       98     2492        %NI$DCT;
       99     2540        %NI$DQH;
      100     2563        %NI$SQH;
      101     2576        %NI$CHT;
      102     2579        %NI$DVT;
      103     2586        %NI$IOSTAT;
      104     2595        %NI$IOM;
      105     2600        %NI$MBX;
      106     2619    1   DCL IT$PTR PTR BASED ALIGNED;
      107     2620        /**/
      108     2621        %EJECT;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:4    
      109     2622        /*D*     NAME:     ITD$DISKTAPE
      110     2623                 PURPOSE:  To build and initialize the tables needed access
      111     2624                           devices on DISK and TAPE subsystems.
      112     2625                 DESCRIPTION: When ITD$DISKTAPE is entered datasegment 5 (DS5)
      113     2626                           contains the command table built by ITC$CHECK_DT.
      114     2627                           First a subsystem queue header (SQH) is allocated
      115     2628                           and then the internal routines EXEC_MPC and EXEC_DEV
      116     2629                           are called to fill in the SQH and build and initialize
      117     2630                           the other tables required(DQH,DCT,etc.).     */
      118     2631        /**/
      119     2632    1           CMD$ = B$DS5$;
      120     2633    1           IF (CMD$ -> IT$CMDWD = %ITS_DISK) THEN POSTER = ENTADDR(NID$POSTER);
      121     2634    1           ELSE POSTER = ENTADDR(NIT$POSTER);
      122     2635    1           CMD$ = PINCRW (CMD$,SIZEW(IT$CMDWD));
      123     2636        /**/
      124     2637    1           CALL ITH$SQH_INIT(PTR$,SQH$) ALTRET(ITD$DISKTAPE_ERR);
      125     2638        /**/
      126     2639    1           LA# = 0;
      127     2640        /**/
      128     2641        /**/
      129     2642    2           DO WHILE (CMD$ -> IT$DTDEV.CNTWD.TYPE ~= %ITS_ENDCMD);
      130     2643        /**/
      131     2644    3              DO CASE (CMD$ -> IT$DTDEV.CNTWD.TYPE);
      132     2645    3               CASE (%ITS_MPC);
      133     2646    3                 CALL EXEC_MPC  ALTRET(ITD$DISKTAPE_ERR);
      134     2647    3               CASE (%ITS_DEV);
      135     2648    3                 CALL EXEC_DEV  ALTRET(ITD$DISKTAPE_ERR);
      136     2649    3               END;
      137     2650        /**/
      138     2651    2              CMD$ = PINCRW(CMD$,CMD$ -> IT$DTDEV.CNTWD.OFFSET);
      139     2652    2              END;
      140     2653    1           RETURN;
      141     2654    1   ITD$DISKTAPE_ERR:
      142     2655    1           ALTRETURN;
      143     2656        /**/
      144     2657        %EJECT;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:5    
      145     2658        /*D*     INTERNAL ROUTINE:     EXEC_MPC
      146     2659                 DESCRIPTION: EXEC_MPC build the tables that define the IOM
      147     2660                           to MPC connection(s) for this subsystem.
      148     2661                           First a DCT entry is made for the MPC then a loop
      149     2662                           is entered to build the  tables that describe this
      150     2663                           connection. In this loop (EXEC_LA:) the device queue
      151     2664                           headers (DQH) tables are built, one per channel
      152     2665                           connected to this MPC. The IOM channel tables are
      153     2666                           filled in to point to the proper DQHs and the SQH
      154     2667                           is filled in. Durring this loop:
      155     2668                                LA# - is the current link adapter index, up
      156     2669                                      to four max - two per MPC.
      157     2670                                LA_IOM# - is the current LA to IOM connection
      158     2671                                      index - up to four - two per LA.
      159     2672                                HI_CHAN and LO_CHAN - define the range of IOM
      160     2673                                      channels used in the current IOM - LA
      161     2674                                      connection.        */
      162     2675        /**/
      163     2676    1   EXEC_MPC: PROC  ALTRET;
      164     2677    2   DCL CHX UBIN;
      165     2678    2   DCL SCHAN$ PTR;
      166     2679    2   DCL FOUND_LA BIT(1) ALIGNED ;
      167     2680        /**/
      168     2681    2           CHX=0;
      169     2682        /**/
      170     2683                                                /* BUILD DCT ENTRY FOR MPC */
      171     2684    2           CALL ITH$DCT_INIT(PTR$,DEV$) ALTRET(EXEC_MPC_ERR);
      172     2685        /**/
      173     2686    2           SQH$ -> NI$SQH.NDCT = SQH$ -> NI$SQH.NDCT + 1;
      174     2687    2           IF SQH$ -> NI$SQH.MPC$(0) = ADDR(NIL) THEN
      175     2688    2              SQH$ -> NI$SQH.MPC$(0) = DEV$;
      176     2689    2           ELSE
      177     2690    2              SQH$ -> NI$SQH.MPC$(1) = DEV$;
      178     2691        /**/
      179     2692    2           DEV$ -> NI$DCT.MPC.FW$ = ADDR(NIL);
      180     2693    2           DEV$ -> NI$DCT.DEVNM = CMD$ -> IT$MPC.MPCNAME;
      181     2694    2           DEV$ -> NI$DCT.DVT$ = NI$DVT$(CMD$ -> IT$MPC.MPCTYPE);
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:6    
      182     2695    2           DEV$ -> NI$DCT.TYPE = DEV$ -> NI$DCT.DVT$ -> NI$DVT.TYPE;
      183     2696    2           DEV$ -> NI$DCT.FX = CMD$ -> IT$MPC.FX;
      184     2697    2           DEV$ -> NI$DCT.MODX = CMD$ -> IT$MPC.MODX;
      185     2698    2           DEV$ -> NI$DCT.SQH$ = SQH$;
      186     2699    2           DEV$ -> NI$DCT.DQH$ = PTR$;
      187     2700    2           DEV$ -> NI$DCT.DFLG.INPUT = YES;
      188     2701    2           DEV$ -> NI$DCT.DFLG.OUTPUT = YES;
      189     2702    2           DEV$ -> NI$DCT.DFLG.PSIA = YES;
      190     2703    3           DO SELECT (DEV$ -> NI$DCT.DVT$ -> NI$DVT.MODEL(DEV$ -> NI$DCT.MODX));
      191     2704    3              SELECT ('MSP8000','MSP8001','MSP0611','MSP0612','MSP0645');
      192     2705    3              DEV$ -> NI$DCT.CTYP = %C_MPC;
      193     2706    3              SELECT ('MSP3881','MSP3885','MSP3882','MSP3886',
      194     2707    3                'MSP3990','MSP3991','MSP3992','MSP3993','MSP3994',
      195     2708    3                'MTP8215','MTP8216','MTP8218','MTP8225','MTP8226','MTP8228');
      196     2709    3              DEV$ -> NI$DCT.CTYP = %C_IPC;
      197     2710    3              DEV$ -> NI$DCT.DEV0LGL = '1'B;
      198     2711    3              DEV$ -> NI$DCT.FIPS = '1'B;
      199     2712    3              SELECT ('MSS8080','MSS8090');
      200     2713    3              DEV$ -> NI$DCT.CTYP = %C_IPC;
      201     2714    3              DEV$ -> NI$DCT.DEV0LGL = '1'B;
      202     2715    3              DEV$ -> NI$DCT.FIPS = '1'B;
      203     2716    3              END;                         /* SELECT */
      204     2717    2           MPC$ = DEV$;
      205     2718    2           IF ( B$DS5$ -> IT$CMDWD = %ITS_DISK ) THEN
      206     2719    2              DEV$->NI$DCT.MPC.TYPE=%DV_DP;
      207     2720    2           ELSE
      208     2721    2              DEV$->NI$DCT.MPC.TYPE=%DV_MT;
      209     2722    2           DEV$ -> NI$DCT.MPC.FWNAME = CMD$ -> IT$MPC.FWNAME;
      210     2723    2           IT_PARTITION.DEVICE(N_DCTXMAX) = CMD$ -> IT$MPC.FLAGS.DOWN;
      211     2724        /**/
      212     2725        /**/
      213     2726    2           DCT_DQH$ = PTR$;                /* NEXT DQH TO BE ALLOCATED           */
      214     2727    2           FOUND_LA = '0'B;                /* Found nonpartitioned channel to MPC*/
      215     2728        /**/
      216     2729    3           DO LA_IOM# = 0 TO 3;
      217     2730    4              IF CMD$ -> IT$MPC.LA_IOM.PRESENCE(LA_IOM#) THEN DO;
      218     2731    4                 IOM# = CMD$ -> IT$MPC.LA_IOM.IOM#(LA_IOM#);
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:7    
      219     2732    4                 LO_CHAN = CMD$ -> IT$MPC.LA_IOM.LO_CHAN(LA_IOM#);
      220     2733    4                 HI_CHAN = CMD$ -> IT$MPC.LA_IOM.HI_CHAN(LA_IOM#);
      221     2734    4                 I = HI_CHAN - LO_CHAN + 1;
      222     2735    5                 DO J = 0 TO I - 1;
      223     2736    5                    DQH$ = PTR$;
      224     2737    5                    CALL ITH$ALLOCATE(PTR$,SIZEW(NI$DQH)) ALTRET(EXEC_MPC_ERR);
      225     2738    5                    DQH$ -> NI$DQH = NI$DQH_C; /* set to constant inited struct */
      226     2739        /*               DQH$ -> NI$DQH.FL$ = ADDR(NIL);   */
      227     2740        /*               DQH$ -> NI$DQH.IO$ = ADDR(NIL);   */
      228     2741    5                    DQH$ -> NI$DQH.MPC$ = DEV$;
      229     2742    5                    DQH$ -> NI$DQH.SQH$ = SQH$;
      230     2743    5                    DQH$ -> NI$DQH.LA = LA_IOM#;
      231     2744    6                    IF HW_IMX THEN DO;
      232     2745        /*                  DQH$ -> NI$DQH.MBX$ = ADDR(NIL);       */
      233     2746        /*                  DQH$->NI$DQH.IOSTATUS$ = ADDR(NIL);    */
      234     2747    6                       END;
      235     2748    6                    ELSE DO;
      236     2749    6                       DQH$ -> NI$DQH.MBX$ = PINCRW (NI$IOM$(IOM#) -> NI$IOM.MBX$,
      237     2750    6                         SIZEW(NI$MBX(0)) * (LO_CHAN + J));
      238     2751    6                       DQH$ -> NI$DQH.IOSTATUS$ = NI$FQ$ -> NI$FQ.HD$;
              2751                                /* STATUS IN LOW REAL MEM */
      239     2752    7                       IF HW_IOP THEN DO;
      240     2753    7                          DQH$ -> NI$DQH.IOSTATUS$ -> NI$IOSTAT.AESDCW = %
              2753                                   IOP_AESDCW_INIT;
      241     2754    7                          DQH$ -> NI$DQH.IOSTATUS$ -> NI$IOSTAT.AESDCW.ADDRESS =
      242     2755    7                            POFFW (ADDR (DQH$ -> NI$DQH.IOSTATUS$ -> NI$IOSTAT.EXTST),
              2755                                     B$REAL$);
      243     2756    7                          END;
      244     2757
      245     2758    6                       NI$FQ$ -> NI$FQ.HD$ = PINCRW(NI$FQ$ -> NI$FQ.HD$,SIZEW(NI$IOSTAT
              2758                                ));
      246     2759    6                       END;
      247     2760    5                    IT_PARTITION.IOCHAN(IOM#*%N_MAXCHANS+LO_CHAN+J) = CMD$ -> IT$MPC.
              2760                             LA_IOM.DOWN (LA_IOM#);
      248     2761    5                    IF NOT CMD$ -> IT$MPC.LA_IOM.DOWN (LA_IOM#) AND
      249     2762    6                      NOT FOUND_LA THEN DO ;
      250     2763    6                       DCT_DQH$ = DQH$;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:8    
      251     2764    6                       FOUND_LA = '1'B ;
      252     2765    6                       END ;
      253     2766    6                    IF MOD(J,2)=0 THEN DO;
      254     2767    6                       SCHAN$ = DQH$;
      255     2768    6                       DQH$ -> NI$DQH.SCHAN$ = PINCRW(DQH$,SIZEW(NI$DQH));
      256     2769    6                       END;
      257     2770    6                    ELSE DO;
      258     2771    6                       DQH$ -> NI$DQH.SCHAN$ = SCHAN$;
      259     2772    6                       END;
      260     2773    5                    DQH$ -> NI$DQH.IOCHAN.IOM = IOM#;
      261     2774    5                    DQH$ -> NI$DQH.IOCHAN.CHANNEL = LO_CHAN + J;
      262     2775    6                    IF NI$CHT$ -> NI$CHT.DQH$(DQH$ -> NI$DQH.IOCHANX) ~= ADDR(NIL) THEN
              2775                             DO;
      263     2776    6                       DUPCHANERR_TEXT.COUNT = SIZEC(DUPCHANERR_TEXT) -1;
      264     2777    6                       DUPCHANERR_TEXT.CHANNEL = 'CHANNEL';
      265     2778    6                       CALL BINCHAR(DUPCHANERR_TEXT.IOMTEXT,IOM#);
      266     2779    6                       DUPCHANERR_TEXT.DASH = '-';
      267     2780    6                       CALL BINCHAR(DUPCHANERR_TEXT.CHANTEXT,LO_CHAN+J);
      268     2781    6                       CALL ITE$ERROR(%E$DUPCHAN,ADDR(DUPCHANERR_TEXT));
      269     2782    6                       END;
      270     2783    6                    ELSE DO;
      271     2784    6                       NI$CHT$ -> NI$CHT.DQH$(DQH$ -> NI$DQH.IOCHANX) = DQH$;
      272     2785    6                       NI$CHT$ -> NI$CHT.POSTER(DQH$ -> NI$DQH.IOCHANX) = POSTER;
      273     2786    6                       END;
      274     2787    5                    IF CHX = %N_CHANSPERMPC THEN
      275     2788    5                       GOTO EXEC_MPC_ERR;
      276     2789    5                    DEV$ -> NI$DCT.MPC.IOCHANX(CHX) = DQH$ -> NI$DQH.IOCHANX;
      277     2790    5                    CHX = CHX + 1;
      278     2791    5                    END;
      279     2792    4                 END;
      280     2793    3              END;
      281     2794    2           DEV$ -> NI$DCT.DQH$ = DCT_DQH$; /* MAKE SURE MPC'S DCT.DQH$ IS UP */
      282     2795    2           IF NOT FOUND_LA THEN            /*  All chans down;  MPC must be down */
      283     2796    2              IT_PARTITION.DEVICE(N_DCTXMAX) = '1'B ;
      284     2797    2           RETURN;
      285     2798    2   EXEC_MPC_ERR:
      286     2799    2           ALTRETURN;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:9    
      287     2800    2   END EXEC_MPC;
      288     2801        %EJECT;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:10   
      289     2802        /*D*     INTERNAL ROUTINE:   EXEC_DEV
      290     2803                 DESCRIPTION:   EXEC_DEV builds a DCT entry for a device and
      291     2804                           fills it in from the information in the command
      292     2805                           table. In addition a RAT table entry and a DDT
      293     2806                           table entry is built for each device for which
      294     2807                           they are required. In addition the number of packs
      295     2808                           N_NDPS is incremented if the device is a pack. */
      296     2809        /**/
      297     2810    1   EXEC_DEV: PROC ALTRET;
      298     2811        /**/
      299     2812                                                /* BUILD DCT ENTRY FOR DEVICE */
      300     2813    2           CALL ITH$DCT_INIT(PTR$,DEV$) ALTRET(EXEC_DEV_ERR);
      301     2814        /**/
      302     2815    2           IF (B$DS5$ -> IT$CMDWD = %ITS_DISK) THEN N_NDPS = N_NDPS + 1;
      303     2816        /**/
      304     2817    2           SQH$ -> NI$SQH.NDCT = SQH$ -> NI$SQH.NDCT + 1;
      305     2818        /**/
      306     2819    2           DEV$ -> NI$DCT.DEVNM = CMD$ -> IT$DTDEV.NAME;
      307     2820        /**/
      308     2821    2           CALL ITH$RAT_INIT(PTR$,RAT$) ALTRET(EXEC_DEV_ERR);
      309     2822    2           DEV$ -> NI$DCT.RAT$ = RAT$;
      310     2823    2           RAT$ -> FR$RAT.TYP = CMD$ -> IT$DTDEV.NM.MNEM;
      311     2824        /*
      312     2825           **** SET ATTR. AS SPECIFIED ON DEV COMMAND OR ELSE TO ITS DEFAULT
      313     2826        */
      314     2827    2           IF CMD$ -> IT$DTDEV.ATTR ~= NO THEN
      315     2828    2              RAT$ -> FR$RAT.M1 = CMD$ -> IT$DTDEV.ATTR;
      316     2829    2           ELSE
      317     2830    2              RAT$ -> FR$RAT.M1 = NI$DVT$(CMD$ -> IT$DTDEV.TYPE) -> NI$DVT.ATTR;
      318     2831        /**/
      319     2832    3           IF (B$DS5$ -> IT$CMDWD = %ITS_DISK) THEN DO; /* DISK                   */
      320     2833    3              FR_PRM$(0) -> FR$PR(FR_DP) = FR_PRM$(0) -> FR$PR(FR_DP) + 1;
      321     2834    3              DEV$ -> NI$DCT.PMD$ = PTR$;
      322     2835    3              PTR$ -> P$IODATA = NO;
      323     2836        /**/
      324     2837    3              CALL ITH$ALLOCATE(PTR$,SIZEW(P$IODATA)) ALTRET(EXEC_DEV_ERR);
      325     2838        /**/
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:11   
      326     2839    3              RAT$ -> FR$RAT.RCOD = FR_DP;
      327     2840    3              DDT$ = ADDR(FR$HD$(FR_DP));
      328     2841        /*
      329     2842           **** SET DP DEFAULT FOR RESOURCE MANAGEMENT EQUAL TO FIRST
      330     2843           **** DP DEVICE SPECIFIED.
      331     2844        */
      332     2845    3              IF FR_DPDFLT = NO THEN
      333     2846    3                 FR_DPDFLT = RAT$ -> FR$RAT.M1;
      334     2847    3              END;
      335     2848        /**/
      336     2849    3           ELSE DO;                        /* Tape or Optical Disc */
      337     2850    3              DEV$ -> NI$DCT.MT.FREPOS$ = ADDR(NIL);
      338     2851    3              DEV$ -> NI$DCT.MT.SETDENS$ = ADDR(NIL);
      339     2852    3              DEV$ -> NI$DCT.MT.CURDENS = %N_SD1600;
      340     2853    3              DDT$ = PTR$;                 /* BUILD DDT                          */
      341     2854    3              CALL ITH$ALLOCATE(PTR$,SIZEW(FT$DDT)) ALTRET(EXEC_DEV_ERR);
      342     2855        /**/
      343     2856    3              DDT$ -> FT$DDT = NO;
      344     2857        /**/
      345     2858    3              DDT$ -> FT$DDT.ACCT = ' ';
      346     2859    3              DDT$ -> FT$DDT.SN = ' ';
      347     2860    3              DDT$ -> FT$DDT.EXPIRE = ' ';
      348     2861        /**/
      349     2862    3              DEV$ -> NI$DCT.DDT$ = DDT$;
      350     2863    4              IF B$DS5$->IT$CMDWD = %ITS_TAPE THEN DO;
      351     2864    4                 RAT$->FR$RAT.RCOD = FR_MT;
      352     2865    4                 FR_PRM$(0)->FR$PR(FR_MT) = FR_PRM$(0)->FR$PR(FR_MT) + 1;
      353     2866    4                 DDT$ = ADDR(FR$HD$(FR_MT));
      354     2867        /*
      355     2868           ****       SET TAPE DENSITY DEFAULT FOR RESOURCE MANAGEMENT
      356     2869           ****       EQUAL TO FIRST DENSITY SPEC'D OR TO THE DEFAULT.
      357     2870           ****       DEFAULT SPEC'D ON MON COMMAND WILL TAKE PRECEDENCE IF SPEC'D
      358     2871        */
      359     2872    4                 IF FR_MTDFLT = NO THEN
      360     2873    4                    FR_MTDFLT = RAT$->FR$RAT.M1;
      361     2874    4                 END;
      362     2875    4              ELSE DO;                     /* Optical Disc Devices     */
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:12   
      363     2876    4                 RAT$->FR$RAT.M1 = '0'B;
      364     2877    4                 FR_PRM$(0)->FR$PR(FR_NPOOL) = FR_PRM$(0)->FR$PR(FR_NPOOL) + 1;
      365     2878    4                 DCT_DQH$ = NI$CHT$->NI$CHT.DQH$(CMD$->IT$DTDEV.VFC);
      366     2879    4                 DDT$ = ADDR(FR$HD$(FR_NPOOL));
      367     2880    4                 MPC$ = DEV$;              /* No DQH for these         */
      368     2881    4                 DEV$->NI$DCT.OD.OPCI$ = ADDR(CMD$->IT$DTDEV.CHAIN)->IT$PTR;
      369     2882    4                 DEV$->NI$DCT.OD.FEI$ = IT_FEI$$->KI$FEI$(DCT_DQH$->NI$DQH.FEX);
      370     2883    4                 END;
      371     2884    3              END;
      372     2885        /**/
      373     2886    3           IF (DDT$ -> IT$PTR ~= ADDR(NIL)) THEN DO;
      374     2887    3              DDT$ = DDT$ -> IT$PTR;
      375     2888    4              DO WHILE (DDT$ -> FR$RAT.LNK$ ~= ADDR(NIL));
      376     2889    4                 DDT$ = DDT$ -> FR$RAT.LNK$;
      377     2890    4                 END;
      378     2891    3              DDT$ -> FR$RAT.LNK$ = RAT$;
      379     2892    3              END;
      380     2893        /**/
      381     2894    3           ELSE DO;
      382     2895    3              DDT$ -> IT$PTR = RAT$;
      383     2896    3              END;
      384     2897        /**/
      385     2898    2           DEV$ -> NI$DCT.DVT$ = NI$DVT$(CMD$ -> IT$DTDEV.TYPE);
      386     2899    2           IF B$DS5$->IT$CMDWD = %ITS_OD THEN
      387     2900    2              DEV$ -> NI$DCT.TYPE = %DV_OD;
      388     2901    2           ELSE
      389     2902    2              DEV$ -> NI$DCT.TYPE = DEV$ -> NI$DCT.DVT$ -> NI$DVT.TYPE;
      390     2903    2           DEV$ -> NI$DCT.FX = CMD$ -> IT$DTDEV.FX;
      391     2904    2           DEV$ -> NI$DCT.MODX = CMD$ -> IT$DTDEV.MODX;
      392     2905    2           DEV$ -> NI$DCT.DVN = CMD$ -> IT$DTDEV.DEV#;
      393     2906    2           DEV$ -> NI$DCT.DFLG.INPUT = CMD$ -> IT$DTDEV.FLAGS.INPUT;
      394     2907    2           DEV$ -> NI$DCT.DFLG.OUTPUT = CMD$ -> IT$DTDEV.FLAGS.OUTPUT;
      395     2908    2           DEV$ -> NI$DCT.DFLG.CM = CMD$ -> IT$DTDEV.FLAGS.CM;
      396     2909    2           DEV$ -> NI$DCT.DFLG.SYMBIONT = CMD$ -> IT$DTDEV.FLAGS.SYMBIONT;
      397     2910    2           DEV$ -> NI$DCT.DFLG.PSIA = CMD$ -> IT$DTDEV.FLAGS.PSIA;
      398     2911    2           DEV$ -> NI$DCT.DFLG.CHECKWRITE = CMD$->IT$DTDEV.FLAGS.CHECKWRITE;
      399     2912    2           DEV$ -> NI$DCT.CTYP = MPC$ -> NI$DCT.CTYP;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:13   
      400     2913    2           DEV$ -> NI$DCT.DEV0LGL = MPC$ -> NI$DCT.DEV0LGL;
      401     2914    2           DEV$ -> NI$DCT.FIPS = MPC$ -> NI$DCT.FIPS;
      402     2915        /**/
      403     2916    2           IT_PARTITION.DEVICE(N_DCTXMAX) = CMD$ -> IT$DTDEV.FLAGS.DOWN;
      404     2917        /**/
      405     2918    2           DEV$ -> NI$DCT.SQH$ = SQH$;
      406     2919    2           DEV$ -> NI$DCT.DQH$ = DCT_DQH$;
      407     2920        /*      DEV$ -> NI$DCT.SPSTAT = NO;                */
      408     2921        /**/
      409     2922    2           DEV$ -> NI$DCT.DP.BQ$ = ADDR(NIL);
      410     2923    2           DEV$ -> NI$DCT.DP.SETL$ = ADDR(NIL);
      411     2924        /**/
      412     2925    2           RETURN;
      413     2926    2   EXEC_DEV_ERR:
      414     2927    2           ALTRETURN;
      415     2928    2   END;
      416     2929        /**/
      417     2930    1   END;

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:14   
--  Include file information  --

   IT_IDATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   N_FC_C.:E05TOU  is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   NK_SUBS.:E05TOU  is referenced.
   FT$DDT.:E05TOU  cannot be made into a system file and is referenced.
   FT_SUBS.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   FR$RAT.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   IT$DTDEV.:E05TOU  cannot be made into a system file and is referenced.
   IT$MPC.:E05TOU  cannot be made into a system file and is referenced.
   IT$CMDWD.:E05TOU  cannot be made into a system file and is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
   IT_ERROR_C.:E05TOU  is referenced.
      No diagnostics issued in procedure ITD$DISKTAPE.

   Procedure ITD$DISKTAPE requires 886 words for executable code.
   Procedure ITD$DISKTAPE requires 34 words of local(AUTO) storage.

    No errors detected in file ITD$DISKTAP.:E05TSI    .

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:15   

 Object Unit name= ITD$DISKTAPE                               File name= ITD$DISKTAP.:E05TOU
 UTS= JUL 29 '97 23:01:39.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     46     56  ITD$DISKTAPE
    1   Proc  even  none   886   1566  ITD$DISKTAPE
    2  RoData even  none    11     13  ITD$DISKTAPE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  ITD$DISKTAPE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 NID$POSTER
         yes           Std       3 NIT$POSTER
 yes     yes           Std       2 ITH$SQH_INIT
 yes     yes           Std       2 ITH$DCT_INIT
 yes     yes           Std       2 ITH$ALLOCATE
         yes           Std       2 ITE$ERROR
 yes     yes           Std       2 ITH$RAT_INIT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:16   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               N$FQ$                                 NI$CHT$
     NI$DVT$                               NI$FQ$                                NI$IBUF$
     NI$IOM$                               NI$RP$                                N_DCTXMAX
     N_NDPS                                P_RESOURCE$                           P_UPTIME
     P_NSCPU                               B$REAL$                               B$DS5$
     IT_FEI$$                              IT_PARTITION                          FR$HD$
     FR_PRM$                               FR_MTDFLT                             FR_DPDFLT
     HW_IOP                                HW_IMX                                KI_FEI$$
     NI$DQH_C                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:17   


        1        1        /*M*     Disk and tape sub-system tables builder */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X* DMR */
        9        9        /*P*     NAME:     ITD$DISKTAPE
       10       10                 PURPOSE:  ITD$DISKTAPE builds and initializes all of the
       11       11                           tables used by the I/O system to access DISK
       12       12                           and TAPE subsystems.
       13       13                 DESCRIPTION: The commands as placed in a command table by the
       14       14                           syntax checking routine are used to build tables in
       15       15                           the TIGR table area of the monitor WSQ and initialize
       16       16                           some tables in static storage.
       17       17                 INPUT:    PTR$ - pointer to next available location in TIGR
       18       18                           table area - parameter
       19       19                           CMD$ - pointer to command table in data segment
       20       20                 OUTPUT:   Built and initialized tables
       21       21                           PTR$ - has been updated to point to next available
       22       22                           location.                     */
       23       23        ITD$DISKTAPE: PROC (PTR$)  ALTRET;

     23  1 000000   000000 700200 xent  ITD$DISKTAPE TSX0  ! X66_AUTO_1
         1 000001   000042 000001                    ZERO    34,1

       24       24        /**/
       25       25    1   DCL PTR$ PTR;                           /* PTR TO TIGR TABLE SPACE            */
       26       26        /**/
       27       27        /*  INCLUDE FILES */
       28       28        %INCLUDE IT_ERROR_C;
       29      111        %INCLUDE IT_SUBS_C;
       30      378        %INCLUDE IT$CMDWD;
       31      386        %INCLUDE IT$MPC;
       32      420        %INCLUDE IT$DTDEV;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:18   
       33      455        %INCLUDE NI_DATA_R;
       34      892        %INCLUDE FR$RAT;
       35      945        %FR$RAT;
       36      985        %INCLUDE FR_SUBS;
       37     1053        %INCLUDE FT_SUBS;
       38     1133        %INCLUDE FT$DDT;
       39     1194        %INCLUDE NK_SUBS;
       40     1219        %INCLUDE P_PMDAT_R;
       41     1527        %SUB YES = '1'B/*YES*/;
       42     1528        %SUB NO = '0'B/*NO*/;
       43     1529        /**/
       44     1530        /*  ENTRY DCLS  */
       45     1531        /**/
       46     1532    1   DCL ITE$ERROR ENTRY(2);
       47     1533    1   DCL NID$POSTER ENTRY(3);
       48     1534    1   DCL NIT$POSTER ENTRY(3);
       49     1535    1   DCL ITH$ALLOCATE ENTRY(2) ALTRET;
       50     1536    1   DCL ITH$SQH_INIT ENTRY(2) ALTRET;
       51     1537    1   DCL ITH$RAT_INIT ENTRY(2) ALTRET;
       52     1538    1   DCL ITH$DCT_INIT ENTRY(2) ALTRET;
       53     1539        /**/
       54     1540        /* AUTOMATIC */
       55     1541        /**/
       56     1542    1   DCL CMD$ PTR;
       57     1543    1   DCL SQH$ PTR;
       58     1544    1   DCL DQH$ PTR;
       59     1545    1   DCL DEV$ PTR;
       60     1546    1   DCL RAT$ PTR;
       61     1547    1   DCL DDT$ PTR;
       62     1548    1   DCL MPC$ PTR;
       63     1549    1   DCL DCT_DQH$ PTR;
       64     1550        /**/
       65     1551    1   DCL LA# SBIN(36);
       66     1552    1   DCL IOM# SBIN(36) ;
       67     1553    1   DCL LO_CHAN SBIN(36);
       68     1554    1   DCL HI_CHAN SBIN(36);
       69     1555    1   DCL LA_IOM# SBIN(36);
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:19   
       70     1556    1   DCL CHTX SBIN(36);
       71     1557    1   DCL I SBIN(36);
       72     1558    1   DCL J SBIN(36);
       73     1559        /**/
       74     1560    1   DCL POSTER EPTR;
       75     1561        /**/
       76     1562    1   DCL 1 DUPCHANERR_TEXT,
       77     1563    1         2 COUNT UBIN(9) UNAL,
       78     1564    1         2 CHANNEL CHAR(8) UNAL,
       79     1565    1         2 IOMTEXT CHAR(1) UNAL,
       80     1566    1         2 DASH CHAR(1) UNAL,
       81     1567    1         2 CHANTEXT CHAR(2) UNAL;
       82     1568        /*  SYMREFS  */
       83     1569    1   DCL B$REAL$ PTR SYMREF;
       84     1570    1   DCL B$DS5$ PTR SYMREF;                  /* COMMANDS                           */
       85     1571    1   DCL IT_SYSDISK UBIN WORD SYMREF;        /* DCTX OF SYSTEM DISK                */
       86     1572    1   DCL IT_FEI$$ PTR SYMREF;
       87     1573        %NI$PARTITION (NAME=IT_PARTITION,STCLASS=SYMREF);
       88     1581        /**/
       89     1582        %INCLUDE NI_DATA_C;
       90     1695        %INCLUDE N_FC_C;
       91     1732        %INCLUDE FR_DATA_R;
       92     1764        %INCLUDE HF_DATA_R;
       93     1807        %INCLUDE CP_6_SUBS;
       94     2347        %INCLUDE KI_DATA_R;
       95     2373        %INCLUDE IT_IDATA_R;
       96     2490        /**/
       97     2491        /*  BASED */
       98     2492        %NI$DCT;
       99     2540        %NI$DQH;
      100     2563        %NI$SQH;
      101     2576        %NI$CHT;
      102     2579        %NI$DVT;
      103     2586        %NI$IOSTAT;
      104     2595        %NI$IOM;
      105     2600        %NI$MBX;
      106     2619    1   DCL IT$PTR PTR BASED ALIGNED;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:20   
      107     2620        /**/
      108     2621        %EJECT;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:21   
      109     2622        /*D*     NAME:     ITD$DISKTAPE
      110     2623                 PURPOSE:  To build and initialize the tables needed access
      111     2624                           devices on DISK and TAPE subsystems.
      112     2625                 DESCRIPTION: When ITD$DISKTAPE is entered datasegment 5 (DS5)
      113     2626                           contains the command table built by ITC$CHECK_DT.
      114     2627                           First a subsystem queue header (SQH) is allocated
      115     2628                           and then the internal routines EXEC_MPC and EXEC_DEV
      116     2629                           are called to fill in the SQH and build and initialize
      117     2630                           the other tables required(DQH,DCT,etc.).     */
      118     2631        /**/
      119     2632    1           CMD$ = B$DS5$;

   2632  1 000002   000000 236000 xsym               LDQ     B$DS5$
         1 000003   200004 756100                    STQ     CMD$,,AUTO

      120     2633    1           IF (CMD$ -> IT$CMDWD = %ITS_DISK) THEN POSTER = ENTADDR(NID$POSTER);

   2633  1 000004   200004 470500                    LDP0    CMD$,,AUTO
         1 000005   000000 235100                    LDA     0,,PR0
         1 000006   000002 115007                    CMPA    2,DL
         1 000007   000013 601000 1                  TNZ     s:2634

   2633  1 000010   000000 636000 xent               EAQ     NID$POSTER
         1 000011   200024 756100                    STQ     POSTER,,AUTO
         1 000012   000015 710000 1                  TRA     s:2635

      121     2634    1           ELSE POSTER = ENTADDR(NIT$POSTER);

   2634  1 000013   000000 636000 xent               EAQ     NIT$POSTER
         1 000014   200024 756100                    STQ     POSTER,,AUTO

      122     2635    1           CMD$ = PINCRW (CMD$,SIZEW(IT$CMDWD));

   2635  1 000015   200004 236100                    LDQ     CMD$,,AUTO
         1 000016   000001 036003                    ADLQ    1,DU
         1 000017   200004 756100                    STQ     CMD$,,AUTO

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:22   
      123     2636        /**/
      124     2637    1           CALL ITH$SQH_INIT(PTR$,SQH$) ALTRET(ITD$DISKTAPE_ERR);

   2637  1 000020   200005 630500                    EPPR0   SQH$,,AUTO
         1 000021   200037 450500                    STP0    FOUND_LA+2,,AUTO
         1 000022   200003 236100                    LDQ     @PTR$,,AUTO
         1 000023   200036 756100                    STQ     FOUND_LA+1,,AUTO
         1 000024   200036 630500                    EPPR0   FOUND_LA+1,,AUTO
         1 000025   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000026   000000 701000 xent               TSX1    ITH$SQH_INIT
         1 000027   000071 702000 1                  TSX2    ITD$DISKTAPE_ERR

      125     2638        /**/
      126     2639    1           LA# = 0;

   2639  1 000030   200014 450100                    STZ     LA#,,AUTO

      127     2640        /**/
      128     2641        /**/
      129     2642    2           DO WHILE (CMD$ -> IT$DTDEV.CNTWD.TYPE ~= %ITS_ENDCMD);

   2642  1 000031   200004 470500                    LDP0    CMD$,,AUTO
         1 000032   000000 236100                    LDQ     0,,PR0
         1 000033   000777 376007                    ANQ     511,DL
         1 000034   000145 116007                    CMPQ    101,DL
         1 000035   000070 600000 1                  TZE     s:2653

      130     2643        /**/
      131     2644    3              DO CASE (CMD$ -> IT$DTDEV.CNTWD.TYPE);

   2644  1 000036   200004 470500                    LDP0    CMD$,,AUTO
         1 000037   000000 720100                    LXL0    0,,PR0
         1 000040   000777 360003                    ANX0    511,DU
         1 000041   000003 100003                    CMPX0   3,DU
         1 000042   000044 602010 1                  TNC     s:2644+6,X0
         1 000043   000054 710000 1                  TRA     s:2651
         1 000044   000054 710000 1                  TRA     s:2651
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:23   
         1 000045   000047 710000 1                  TRA     s:2646
         1 000046   000052 710000 1                  TRA     s:2648

      132     2645    3               CASE (%ITS_MPC);

      133     2646    3                 CALL EXEC_MPC  ALTRET(ITD$DISKTAPE_ERR);

   2646  1 000047   000072 701000 1                  TSX1    EXEC_MPC
         1 000050   000071 702000 1                  TSX2    ITD$DISKTAPE_ERR
         1 000051   000054 710000 1                  TRA     s:2651

      134     2647    3               CASE (%ITS_DEV);

      135     2648    3                 CALL EXEC_DEV  ALTRET(ITD$DISKTAPE_ERR);

   2648  1 000052   001127 701000 1                  TSX1    EXEC_DEV
         1 000053   000071 702000 1                  TSX2    ITD$DISKTAPE_ERR

      136     2649    3               END;

      137     2650        /**/
      138     2651    2              CMD$ = PINCRW(CMD$,CMD$ -> IT$DTDEV.CNTWD.OFFSET);

   2651  1 000054   200004 470500                    LDP0    CMD$,,AUTO
         1 000055   000000 236100                    LDQ     0,,PR0
         1 000056   000011 772000                    QRL     9
         1 000057   000777 376007                    ANQ     511,DL
         1 000060   000022 736000                    QLS     18
         1 000061   200004 036100                    ADLQ    CMD$,,AUTO
         1 000062   200004 756100                    STQ     CMD$,,AUTO

      139     2652    2              END;

   2652  1 000063   200004 470500                    LDP0    CMD$,,AUTO
         1 000064   000000 236100                    LDQ     0,,PR0
         1 000065   000777 376007                    ANQ     511,DL
         1 000066   000145 116007                    CMPQ    101,DL
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:24   
         1 000067   000036 601000 1                  TNZ     s:2644

      140     2653    1           RETURN;

   2653  1 000070   000000 702200 xent               TSX2  ! X66_ARET

      141     2654    1   ITD$DISKTAPE_ERR:
      142     2655    1           ALTRETURN;

   2655  1 000071   000000 702200 xent  ITD$DISKTAP* TSX2  ! X66_AALT

      143     2656        /**/
      144     2657        %EJECT;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:25   
      145     2658        /*D*     INTERNAL ROUTINE:     EXEC_MPC
      146     2659                 DESCRIPTION: EXEC_MPC build the tables that define the IOM
      147     2660                           to MPC connection(s) for this subsystem.
      148     2661                           First a DCT entry is made for the MPC then a loop
      149     2662                           is entered to build the  tables that describe this
      150     2663                           connection. In this loop (EXEC_LA:) the device queue
      151     2664                           headers (DQH) tables are built, one per channel
      152     2665                           connected to this MPC. The IOM channel tables are
      153     2666                           filled in to point to the proper DQHs and the SQH
      154     2667                           is filled in. Durring this loop:
      155     2668                                LA# - is the current link adapter index, up
      156     2669                                      to four max - two per MPC.
      157     2670                                LA_IOM# - is the current LA to IOM connection
      158     2671                                      index - up to four - two per LA.
      159     2672                                HI_CHAN and LO_CHAN - define the range of IOM
      160     2673                                      channels used in the current IOM - LA
      161     2674                                      connection.        */
      162     2675        /**/
      163     2676    1   EXEC_MPC: PROC  ALTRET;

   2676  1 000072   200032 741300       EXEC_MPC     STX1  ! DUPCHANERR_TEXT+5,,AUTO

      164     2677    2   DCL CHX UBIN;
      165     2678    2   DCL SCHAN$ PTR;
      166     2679    2   DCL FOUND_LA BIT(1) ALIGNED ;
      167     2680        /**/
      168     2681    2           CHX=0;

   2681  1 000073   200033 450100                    STZ     CHX,,AUTO

      169     2682        /**/
      170     2683                                                /* BUILD DCT ENTRY FOR MPC */
      171     2684    2           CALL ITH$DCT_INIT(PTR$,DEV$) ALTRET(EXEC_MPC_ERR);

   2684  1 000074   200007 630500                    EPPR0   DEV$,,AUTO
         1 000075   200037 450500                    STP0    FOUND_LA+2,,AUTO
         1 000076   200003 236100                    LDQ     @PTR$,,AUTO
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:26   
         1 000077   200036 756100                    STQ     FOUND_LA+1,,AUTO
         1 000100   200036 630500                    EPPR0   FOUND_LA+1,,AUTO
         1 000101   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000102   000000 701000 xent               TSX1    ITH$DCT_INIT
         1 000103   001125 702000 1                  TSX2    EXEC_MPC_ERR

      172     2685        /**/
      173     2686    2           SQH$ -> NI$SQH.NDCT = SQH$ -> NI$SQH.NDCT + 1;

   2686  1 000104   200005 470500                    LDP0    SQH$,,AUTO
         1 000105   000002 720100                    LXL0    2,,PR0
         1 000106   000001 621010                    EAX1    1,X0
         1 000107   000002 441100                    SXL1    2,,PR0

      174     2687    2           IF SQH$ -> NI$SQH.MPC$(0) = ADDR(NIL) THEN

   2687  1 000110   200005 470500                    LDP0    SQH$,,AUTO
         1 000111   000005 236100                    LDQ     5,,PR0
         1 000112   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000113   000117 601000 1                  TNZ     s:2690

      175     2688    2              SQH$ -> NI$SQH.MPC$(0) = DEV$;

   2688  1 000114   200007 236100                    LDQ     DEV$,,AUTO
         1 000115   000005 756100                    STQ     5,,PR0
         1 000116   000121 710000 1                  TRA     s:2692

      176     2689    2           ELSE
      177     2690    2              SQH$ -> NI$SQH.MPC$(1) = DEV$;

   2690  1 000117   200007 236100                    LDQ     DEV$,,AUTO
         1 000120   000006 756100                    STQ     6,,PR0

      178     2691        /**/
      179     2692    2           DEV$ -> NI$DCT.MPC.FW$ = ADDR(NIL);

   2692  1 000121   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:27   
         1 000122   200007 470500                    LDP0    DEV$,,AUTO
         1 000123   000030 756100                    STQ     24,,PR0

      180     2693    2           DEV$ -> NI$DCT.DEVNM = CMD$ -> IT$MPC.MPCNAME;

   2693  1 000124   200004 471500                    LDP1    CMD$,,AUTO
         1 000125   040100 100500                    MLR     fill='040'O
         1 000126   100002 400010                    ADSC9   2,,PR1                   cn=2,n=8
         1 000127   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

      181     2694    2           DEV$ -> NI$DCT.DVT$ = NI$DVT$(CMD$ -> IT$MPC.MPCTYPE);

   2694  1 000130   100001 220100                    LDX0    1,,PR1
         1 000131   000000 236010 xsym               LDQ     NI$DVT$,X0
         1 000132   200007 470500                    LDP0    DEV$,,AUTO
         1 000133   000024 756100                    STQ     20,,PR0

      182     2695    2           DEV$ -> NI$DCT.TYPE = DEV$ -> NI$DCT.DVT$ -> NI$DVT.TYPE;

   2695  1 000134   000024 473500                    LDP3    20,,PR0
         1 000135   300053 236100                    LDQ     43,,PR3
         1 000136   000025 772000                    QRL     21
         1 000137   000007 752102                    STCQ    7,'02'O,PR0

      183     2696    2           DEV$ -> NI$DCT.FX = CMD$ -> IT$MPC.FX;

   2696  1 000140   200007 470500                    LDP0    DEV$,,AUTO
         1 000141   100002 236100                    LDQ     2,,PR1
         1 000142   000006 772000                    QRL     6
         1 000143   000007 752104                    STCQ    7,'04'O,PR0

      184     2697    2           DEV$ -> NI$DCT.MODX = CMD$ -> IT$MPC.MODX;

   2697  1 000144   200007 470500                    LDP0    DEV$,,AUTO
         1 000145   100001 236100                    LDQ     1,,PR1
         1 000146   000022 736000                    QLS     18
         1 000147   000007 752110                    STCQ    7,'10'O,PR0
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:28   

      185     2698    2           DEV$ -> NI$DCT.SQH$ = SQH$;

   2698  1 000150   200005 236100                    LDQ     SQH$,,AUTO
         1 000151   200007 470500                    LDP0    DEV$,,AUTO
         1 000152   000022 756100                    STQ     18,,PR0

      186     2699    2           DEV$ -> NI$DCT.DQH$ = PTR$;

   2699  1 000153   200003 473500                    LDP3    @PTR$,,AUTO
         1 000154   300000 236100                    LDQ     0,,PR3
         1 000155   000023 756100                    STQ     19,,PR0

      187     2700    2           DEV$ -> NI$DCT.DFLG.INPUT = YES;

   2700  1 000156   400000 236007                    LDQ     -131072,DL
         1 000157   000006 256100                    ORSQ    6,,PR0

      188     2701    2           DEV$ -> NI$DCT.DFLG.OUTPUT = YES;

   2701  1 000160   200007 470500                    LDP0    DEV$,,AUTO
         1 000161   200000 236007                    LDQ     65536,DL
         1 000162   000006 256100                    ORSQ    6,,PR0

      189     2702    2           DEV$ -> NI$DCT.DFLG.PSIA = YES;

   2702  1 000163   200007 470500                    LDP0    DEV$,,AUTO
         1 000164   010000 236007                    LDQ     4096,DL
         1 000165   000006 256100                    ORSQ    6,,PR0

      190     2703    3           DO SELECT (DEV$ -> NI$DCT.DVT$ -> NI$DVT.MODEL(DEV$ -> NI$DCT.MODX));

   2703  1 000166   200007 470500                    LDP0    DEV$,,AUTO
         1 000167   000024 474500                    LDP4    20,,PR0
         1 000170   000007 236100                    LDQ     7,,PR0
         1 000171   000021 772000                    QRL     17
         1 000172   000176 376007                    ANQ     126,DL
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:29   
         1 000173   000000 620006                    EAX0    0,QL
         1 000174   000002 736000                    QLS     2
         1 000175   040000 106506                    CMPC    fill='040'O
         1 000176   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000177   000000 000007 0                  ADSC9   0                        cn=0,n=7
         1 000200   000332 602000 1                  TNC     s:2703+100
         1 000201   000000 635010                    EAA     0,X0
         1 000202   000020 771000                    ARL     16
         1 000203   040000 106505                    CMPC    fill='040'O
         1 000204   400003 000010                    ADSC9   3,A,PR4                  cn=0,n=8
         1 000205   000000 000007 0                  ADSC9   0                        cn=0,n=7
         1 000206   000524 600000 1                  TZE     s:2705
         1 000207   000000 636010                    EAQ     0,X0
         1 000210   000020 772000                    QRL     16
         1 000211   040000 106506                    CMPC    fill='040'O
         1 000212   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000213   000002 000007 0                  ADSC9   2                        cn=0,n=7
         1 000214   000255 602000 1                  TNC     s:2703+55
         1 000215   000000 636010                    EAQ     0,X0
         1 000216   000020 772000                    QRL     16
         1 000217   040000 106506                    CMPC    fill='040'O
         1 000220   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000221   000002 000007 0                  ADSC9   2                        cn=0,n=7
         1 000222   000527 600000 1                  TZE     s:2709
         1 000223   000000 636010                    EAQ     0,X0
         1 000224   000020 772000                    QRL     16
         1 000225   040000 106506                    CMPC    fill='040'O
         1 000226   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000227   000004 000007 0                  ADSC9   4                        cn=0,n=7
         1 000230   000246 602000 1                  TNC     s:2703+48
         1 000231   000000 636010                    EAQ     0,X0
         1 000232   000020 772000                    QRL     16
         1 000233   040000 106506                    CMPC    fill='040'O
         1 000234   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000235   000004 000007 0                  ADSC9   4                        cn=0,n=7
         1 000236   000527 600000 1                  TZE     s:2709
         1 000237   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:30   
         1 000240   000020 772000                    QRL     16
         1 000241   040000 106506                    CMPC    fill='040'O
         1 000242   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000243   000006 000007 0                  ADSC9   6                        cn=0,n=7
         1 000244   000554 601000 1                  TNZ     s:2717
         1 000245   000527 710000 1                  TRA     s:2709
         1 000246   000000 636010                    EAQ     0,X0
         1 000247   000020 772000                    QRL     16
         1 000250   040000 106506                    CMPC    fill='040'O
         1 000251   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000252   000010 000007 0                  ADSC9   8                        cn=0,n=7
         1 000253   000554 601000 1                  TNZ     s:2717
         1 000254   000527 710000 1                  TRA     s:2709
         1 000255   000000 636010                    EAQ     0,X0
         1 000256   000020 772000                    QRL     16
         1 000257   040000 106506                    CMPC    fill='040'O
         1 000260   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000261   000012 000007 0                  ADSC9   10                       cn=0,n=7
         1 000262   000300 602000 1                  TNC     s:2703+74
         1 000263   000000 636010                    EAQ     0,X0
         1 000264   000020 772000                    QRL     16
         1 000265   040000 106506                    CMPC    fill='040'O
         1 000266   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000267   000012 000007 0                  ADSC9   10                       cn=0,n=7
         1 000270   000527 600000 1                  TZE     s:2709
         1 000271   000000 636010                    EAQ     0,X0
         1 000272   000020 772000                    QRL     16
         1 000273   040000 106506                    CMPC    fill='040'O
         1 000274   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000275   000014 000007 0                  ADSC9   12                       cn=0,n=7
         1 000276   000554 601000 1                  TNZ     s:2717
         1 000277   000527 710000 1                  TRA     s:2709
         1 000300   000000 636010                    EAQ     0,X0
         1 000301   000020 772000                    QRL     16
         1 000302   040000 106506                    CMPC    fill='040'O
         1 000303   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000304   000016 000007 0                  ADSC9   14                       cn=0,n=7
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:31   
         1 000305   000323 602000 1                  TNC     s:2703+93
         1 000306   000000 636010                    EAQ     0,X0
         1 000307   000020 772000                    QRL     16
         1 000310   040000 106506                    CMPC    fill='040'O
         1 000311   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000312   000016 000007 0                  ADSC9   14                       cn=0,n=7
         1 000313   000542 600000 1                  TZE     s:2713
         1 000314   000000 636010                    EAQ     0,X0
         1 000315   000020 772000                    QRL     16
         1 000316   040000 106506                    CMPC    fill='040'O
         1 000317   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000320   000020 000007 0                  ADSC9   16                       cn=0,n=7
         1 000321   000554 601000 1                  TNZ     s:2717
         1 000322   000542 710000 1                  TRA     s:2713
         1 000323   000000 636010                    EAQ     0,X0
         1 000324   000020 772000                    QRL     16
         1 000325   040000 106506                    CMPC    fill='040'O
         1 000326   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000327   000022 000007 0                  ADSC9   18                       cn=0,n=7
         1 000330   000554 601000 1                  TNZ     s:2717
         1 000331   000524 710000 1                  TRA     s:2705
         1 000332   000000 635010                    EAA     0,X0
         1 000333   000020 771000                    ARL     16
         1 000334   040000 106505                    CMPC    fill='040'O
         1 000335   400003 000010                    ADSC9   3,A,PR4                  cn=0,n=8
         1 000336   000024 000007 0                  ADSC9   20                       cn=0,n=7
         1 000337   000440 602000 1                  TNC     s:2703+170
         1 000340   000000 636010                    EAQ     0,X0
         1 000341   000020 772000                    QRL     16
         1 000342   040000 106506                    CMPC    fill='040'O
         1 000343   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000344   000024 000007 0                  ADSC9   20                       cn=0,n=7
         1 000345   000527 600000 1                  TZE     s:2709
         1 000346   000000 636010                    EAQ     0,X0
         1 000347   000020 772000                    QRL     16
         1 000350   040000 106506                    CMPC    fill='040'O
         1 000351   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:32   
         1 000352   000026 000007 0                  ADSC9   22                       cn=0,n=7
         1 000353   000414 602000 1                  TNC     s:2703+150
         1 000354   000000 636010                    EAQ     0,X0
         1 000355   000020 772000                    QRL     16
         1 000356   040000 106506                    CMPC    fill='040'O
         1 000357   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000360   000026 000007 0                  ADSC9   22                       cn=0,n=7
         1 000361   000527 600000 1                  TZE     s:2709
         1 000362   000000 636010                    EAQ     0,X0
         1 000363   000020 772000                    QRL     16
         1 000364   040000 106506                    CMPC    fill='040'O
         1 000365   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000366   000030 000007 0                  ADSC9   24                       cn=0,n=7
         1 000367   000405 602000 1                  TNC     s:2703+143
         1 000370   000000 636010                    EAQ     0,X0
         1 000371   000020 772000                    QRL     16
         1 000372   040000 106506                    CMPC    fill='040'O
         1 000373   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000374   000030 000007 0                  ADSC9   24                       cn=0,n=7
         1 000375   000527 600000 1                  TZE     s:2709
         1 000376   000000 636010                    EAQ     0,X0
         1 000377   000020 772000                    QRL     16
         1 000400   040000 106506                    CMPC    fill='040'O
         1 000401   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000402   000032 000007 0                  ADSC9   26                       cn=0,n=7
         1 000403   000554 601000 1                  TNZ     s:2717
         1 000404   000527 710000 1                  TRA     s:2709
         1 000405   000000 636010                    EAQ     0,X0
         1 000406   000020 772000                    QRL     16
         1 000407   040000 106506                    CMPC    fill='040'O
         1 000410   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000411   000034 000007 0                  ADSC9   28                       cn=0,n=7
         1 000412   000554 601000 1                  TNZ     s:2717
         1 000413   000527 710000 1                  TRA     s:2709
         1 000414   000000 636010                    EAQ     0,X0
         1 000415   000020 772000                    QRL     16
         1 000416   040000 106506                    CMPC    fill='040'O
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:33   
         1 000417   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000420   000036 000007 0                  ADSC9   30                       cn=0,n=7
         1 000421   000431 602000 1                  TNC     s:2703+163
         1 000422   000000 636010                    EAQ     0,X0
         1 000423   000020 772000                    QRL     16
         1 000424   040000 106506                    CMPC    fill='040'O
         1 000425   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000426   000036 000007 0                  ADSC9   30                       cn=0,n=7
         1 000427   000527 600000 1                  TZE     s:2709
         1 000430   000554 710000 1                  TRA     s:2717
         1 000431   000000 636010                    EAQ     0,X0
         1 000432   000020 772000                    QRL     16
         1 000433   040000 106506                    CMPC    fill='040'O
         1 000434   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000435   000040 000007 0                  ADSC9   32                       cn=0,n=7
         1 000436   000554 601000 1                  TNZ     s:2717
         1 000437   000527 710000 1                  TRA     s:2709
         1 000440   000000 636010                    EAQ     0,X0
         1 000441   000020 772000                    QRL     16
         1 000442   040000 106506                    CMPC    fill='040'O
         1 000443   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000444   000042 000007 0                  ADSC9   34                       cn=0,n=7
         1 000445   000500 602000 1                  TNC     s:2703+202
         1 000446   000000 636010                    EAQ     0,X0
         1 000447   000020 772000                    QRL     16
         1 000450   040000 106506                    CMPC    fill='040'O
         1 000451   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000452   000042 000007 0                  ADSC9   34                       cn=0,n=7
         1 000453   000524 600000 1                  TZE     s:2705
         1 000454   000000 636010                    EAQ     0,X0
         1 000455   000020 772000                    QRL     16
         1 000456   040000 106506                    CMPC    fill='040'O
         1 000457   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000460   000044 000007 0                  ADSC9   36                       cn=0,n=7
         1 000461   000471 602000 1                  TNC     s:2703+195
         1 000462   000000 636010                    EAQ     0,X0
         1 000463   000020 772000                    QRL     16
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:34   
         1 000464   040000 106506                    CMPC    fill='040'O
         1 000465   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000466   000044 000007 0                  ADSC9   36                       cn=0,n=7
         1 000467   000527 600000 1                  TZE     s:2709
         1 000470   000554 710000 1                  TRA     s:2717
         1 000471   000000 636010                    EAQ     0,X0
         1 000472   000020 772000                    QRL     16
         1 000473   040000 106506                    CMPC    fill='040'O
         1 000474   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000475   000046 000007 0                  ADSC9   38                       cn=0,n=7
         1 000476   000554 601000 1                  TNZ     s:2717
         1 000477   000527 710000 1                  TRA     s:2709
         1 000500   000000 636010                    EAQ     0,X0
         1 000501   000020 772000                    QRL     16
         1 000502   040000 106506                    CMPC    fill='040'O
         1 000503   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000504   000050 000007 0                  ADSC9   40                       cn=0,n=7
         1 000505   000515 602000 1                  TNC     s:2703+215
         1 000506   000000 636010                    EAQ     0,X0
         1 000507   000020 772000                    QRL     16
         1 000510   040000 106506                    CMPC    fill='040'O
         1 000511   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000512   000050 000007 0                  ADSC9   40                       cn=0,n=7
         1 000513   000524 600000 1                  TZE     s:2705
         1 000514   000554 710000 1                  TRA     s:2717
         1 000515   000000 636010                    EAQ     0,X0
         1 000516   000020 772000                    QRL     16
         1 000517   040000 106506                    CMPC    fill='040'O
         1 000520   400003 000010                    ADSC9   3,Q,PR4                  cn=0,n=8
         1 000521   000052 000007 0                  ADSC9   42                       cn=0,n=7
         1 000522   000554 601000 1                  TNZ     s:2717
         1 000523   000524 710000 1                  TRA     s:2705

      191     2704    3              SELECT ('MSP8000','MSP8001','MSP0611','MSP0612','MSP0645');

      192     2705    3              DEV$ -> NI$DCT.CTYP = %C_MPC;

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:35   
   2705  1 000524   000000 236000 2                  LDQ     0
         1 000525   000007 356100                    ANSQ    7,,PR0
         1 000526   000554 710000 1                  TRA     s:2717

      193     2706    3              SELECT ('MSP3881','MSP3885','MSP3882','MSP3886',

      194     2707    3                'MSP3990','MSP3991','MSP3992','MSP3993','MSP3994',
      195     2708    3                'MTP8215','MTP8216','MTP8218','MTP8225','MTP8226','MTP8228');
      196     2709    3              DEV$ -> NI$DCT.CTYP = %C_IPC;

   2709  1 000527   000007 236100                    LDQ     7,,PR0
         1 000530   000000 376000 2                  ANQ     0
         1 000531   020000 276003                    ORQ     8192,DU
         1 000532   000007 756100                    STQ     7,,PR0

      197     2710    3              DEV$ -> NI$DCT.DEV0LGL = '1'B;

   2710  1 000533   200007 470500                    LDP0    DEV$,,AUTO
         1 000534   400000 236003                    LDQ     -131072,DU
         1 000535   000007 256100                    ORSQ    7,,PR0

      198     2711    3              DEV$ -> NI$DCT.FIPS = '1'B;

   2711  1 000536   200007 470500                    LDP0    DEV$,,AUTO
         1 000537   200000 236003                    LDQ     65536,DU
         1 000540   000007 256100                    ORSQ    7,,PR0
         1 000541   000554 710000 1                  TRA     s:2717

      199     2712    3              SELECT ('MSS8080','MSS8090');

      200     2713    3              DEV$ -> NI$DCT.CTYP = %C_IPC;

   2713  1 000542   000007 236100                    LDQ     7,,PR0
         1 000543   000000 376000 2                  ANQ     0
         1 000544   020000 276003                    ORQ     8192,DU
         1 000545   000007 756100                    STQ     7,,PR0

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:36   
      201     2714    3              DEV$ -> NI$DCT.DEV0LGL = '1'B;

   2714  1 000546   200007 470500                    LDP0    DEV$,,AUTO
         1 000547   400000 236003                    LDQ     -131072,DU
         1 000550   000007 256100                    ORSQ    7,,PR0

      202     2715    3              DEV$ -> NI$DCT.FIPS = '1'B;

   2715  1 000551   200007 470500                    LDP0    DEV$,,AUTO
         1 000552   200000 236003                    LDQ     65536,DU
         1 000553   000007 256100                    ORSQ    7,,PR0

      203     2716    3              END;                         /* SELECT */

      204     2717    2           MPC$ = DEV$;

   2717  1 000554   200007 236100                    LDQ     DEV$,,AUTO
         1 000555   200012 756100                    STQ     MPC$,,AUTO

      205     2718    2           IF ( B$DS5$ -> IT$CMDWD = %ITS_DISK ) THEN

   2718  1 000556   000000 470400 xsym               LDP0    B$DS5$
         1 000557   000000 235100                    LDA     0,,PR0
         1 000560   000002 115007                    CMPA    2,DL
         1 000561   000566 601000 1                  TNZ     s:2721

      206     2719    2              DEV$->NI$DCT.MPC.TYPE=%DV_DP;

   2719  1 000562   200007 474500                    LDP4    DEV$,,AUTO
         1 000563   006000 236003                    LDQ     3072,DU
         1 000564   400035 552140                    STBQ    29,'40'O,PR4
         1 000565   000571 710000 1                  TRA     s:2722

      207     2720    2           ELSE
      208     2721    2              DEV$->NI$DCT.MPC.TYPE=%DV_MT;

   2721  1 000566   200007 474500                    LDP4    DEV$,,AUTO
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:37   
         1 000567   004000 236003                    LDQ     2048,DU
         1 000570   400035 552140                    STBQ    29,'40'O,PR4

      209     2722    2           DEV$ -> NI$DCT.MPC.FWNAME = CMD$ -> IT$MPC.FWNAME;

   2722  1 000571   100004 235100                    LDA     4,,PR1
         1 000572   100005 236100                    LDQ     5,,PR1
         1 000573   000022 773000                    LRL     18
         1 000574   000027 376000 xsym               ANQ     B_VECTNIL+23
         1 000575   400041 756100                    STQ     33,,PR4

      210     2723    2           IT_PARTITION.DEVICE(N_DCTXMAX) = CMD$ -> IT$MPC.FLAGS.DOWN;

   2723  1 000576   000000 235000 xsym               LDA     N_DCTXMAX
         1 000577   000601 605000 1                  TPL     s:2723+3
         1 000600   000044 035003                    ADLA    36,DU
         1 000601   003005 060500                    CSL     bolr='003'O
         1 000602   100007 400001                    BDSC    7,,PR1                   by=2,bit=0,n=1
         1 000603   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1

      211     2724        /**/
      212     2725        /**/
      213     2726    2           DCT_DQH$ = PTR$;                /* NEXT DQH TO BE ALLOCATED           */

   2726  1 000604   300000 236100                    LDQ     0,,PR3
         1 000605   200013 756100                    STQ     DCT_DQH$,,AUTO

      214     2727    2           FOUND_LA = '0'B;                /* Found nonpartitioned channel to MPC*/

   2727  1 000606   200035 450100                    STZ     FOUND_LA,,AUTO

      215     2728        /**/
      216     2729    3           DO LA_IOM# = 0 TO 3;

   2729  1 000607   200020 450100                    STZ     LA_IOM#,,AUTO

      217     2730    4              IF CMD$ -> IT$MPC.LA_IOM.PRESENCE(LA_IOM#) THEN DO;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:38   

   2730  1 000610   200020 235100                    LDA     LA_IOM#,,AUTO
         1 000611   000001 735000                    ALS     1
         1 000612   200004 470500                    LDP0    CMD$,,AUTO
         1 000613   000010 236105                    LDQ     8,AL,PR0
         1 000614   400000 316007                    CANQ    -131072,DL
         1 000615   001104 600000 1                  TZE     s:2793

      218     2731    4                 IOM# = CMD$ -> IT$MPC.LA_IOM.IOM#(LA_IOM#);

   2731  1 000616   000011 236105                    LDQ     9,AL,PR0
         1 000617   000022 772000                    QRL     18
         1 000620   200015 756100                    STQ     IOM#,,AUTO

      219     2732    4                 LO_CHAN = CMD$ -> IT$MPC.LA_IOM.LO_CHAN(LA_IOM#);

   2732  1 000621   000011 236105                    LDQ     9,AL,PR0
         1 000622   777777 376007                    ANQ     -1,DL
         1 000623   200016 756100                    STQ     LO_CHAN,,AUTO

      220     2733    4                 HI_CHAN = CMD$ -> IT$MPC.LA_IOM.HI_CHAN(LA_IOM#);

   2733  1 000624   000012 236105                    LDQ     10,AL,PR0
         1 000625   000022 772000                    QRL     18
         1 000626   200017 756100                    STQ     HI_CHAN,,AUTO

      221     2734    4                 I = HI_CHAN - LO_CHAN + 1;

   2734  1 000627   200016 136100                    SBLQ    LO_CHAN,,AUTO
         1 000630   000001 036007                    ADLQ    1,DL
         1 000631   200022 756100                    STQ     I,,AUTO

      222     2735    5                 DO J = 0 TO I - 1;

   2735  1 000632   200023 450100                    STZ     J,,AUTO
         1 000633   001101 710000 1                  TRA     s:2791+1

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:39   
      223     2736    5                    DQH$ = PTR$;

   2736  1 000634   200003 470500                    LDP0    @PTR$,,AUTO
         1 000635   000000 236100                    LDQ     0,,PR0
         1 000636   200006 756100                    STQ     DQH$,,AUTO

      224     2737    5                    CALL ITH$ALLOCATE(PTR$,SIZEW(NI$DQH)) ALTRET(EXEC_MPC_ERR);

   2737  1 000637   000002 236000 2                  LDQ     2
         1 000640   200003 235100                    LDA     @PTR$,,AUTO
         1 000641   200036 757100                    STAQ    FOUND_LA+1,,AUTO
         1 000642   200036 630500                    EPPR0   FOUND_LA+1,,AUTO
         1 000643   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000644   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 000645   001125 702000 1                  TSX2    EXEC_MPC_ERR

      225     2738    5                    DQH$ -> NI$DQH = NI$DQH_C; /* set to constant inited struct */

   2738  1 000646   200006 470500                    LDP0    DQH$,,AUTO
         1 000647   000100 100400                    MLR     fill='000'O
         1 000650   000000 000110 xsym               ADSC9   NI$DQH_C                 cn=0,n=72
         1 000651   000000 000110                    ADSC9   0,,PR0                   cn=0,n=72

      226     2739        /*               DQH$ -> NI$DQH.FL$ = ADDR(NIL);   */
      227     2740        /*               DQH$ -> NI$DQH.IO$ = ADDR(NIL);   */
      228     2741    5                    DQH$ -> NI$DQH.MPC$ = DEV$;

   2741  1 000652   200007 236100                    LDQ     DEV$,,AUTO
         1 000653   000015 756100                    STQ     13,,PR0

      229     2742    5                    DQH$ -> NI$DQH.SQH$ = SQH$;

   2742  1 000654   200005 236100                    LDQ     SQH$,,AUTO
         1 000655   000013 756100                    STQ     11,,PR0

      230     2743    5                    DQH$ -> NI$DQH.LA = LA_IOM#;

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:40   
   2743  1 000656   200020 236100                    LDQ     LA_IOM#,,AUTO
         1 000657   000033 736000                    QLS     27
         1 000660   000020 676100                    ERQ     16,,PR0
         1 000661   003000 376003                    ANQ     1536,DU
         1 000662   000020 656100                    ERSQ    16,,PR0

      231     2744    6                    IF HW_IMX THEN DO;

   2744  1 000663   000000 234000 xsym               SZN     HW_IMX
         1 000664   000666 605000 1                  TPL     s:2749

      232     2745        /*                  DQH$ -> NI$DQH.MBX$ = ADDR(NIL);       */
      233     2746        /*                  DQH$->NI$DQH.IOSTATUS$ = ADDR(NIL);    */
      234     2747    6                       END;

   2747  1 000665   000724 710000 1                  TRA     s:2760

      235     2748    6                    ELSE DO;

      236     2749    6                       DQH$ -> NI$DQH.MBX$ = PINCRW (NI$IOM$(IOM#) -> NI$IOM.MBX$,

   2749  1 000666   200015 720100                    LXL0    IOM#,,AUTO
         1 000667   000000 471410 xsym               LDP1    NI$IOM$,X0
         1 000670   200016 236100                    LDQ     LO_CHAN,,AUTO
         1 000671   200023 036100                    ADLQ    J,,AUTO
         1 000672   100002 473500                    LDP3    2,,PR1
         1 000673   000002 736000                    QLS     2
         1 000674   300000 634506                    EPPR4   0,QL,PR3
         1 000675   000021 454500                    STP4    17,,PR0

      237     2750    6                         SIZEW(NI$MBX(0)) * (LO_CHAN + J));
      238     2751    6                       DQH$ -> NI$DQH.IOSTATUS$ = NI$FQ$ -> NI$FQ.HD$;
              2751                                /* STATUS IN LOW REAL MEM */

   2751  1 000676   000000 471400 xsym               LDP1    NI$FQ$
         1 000677   100002 236100                    LDQ     2,,PR1
         1 000700   000016 756100                    STQ     14,,PR0
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:41   

      239     2752    7                       IF HW_IOP THEN DO;

   2752  1 000701   000000 234000 xsym               SZN     HW_IOP
         1 000702   000721 605000 1                  TPL     s:2758

      240     2753    7                          DQH$ -> NI$DQH.IOSTATUS$ -> NI$IOSTAT.AESDCW = %
              2753                                   IOP_AESDCW_INIT;

   2753  1 000703   000016 473500                    LDP3    14,,PR0
         1 000704   000012 236000 xsym               LDQ     B_VECTNIL+10
         1 000705   300004 756100                    STQ     4,,PR3

      241     2754    7                          DQH$ -> NI$DQH.IOSTATUS$ -> NI$IOSTAT.AESDCW.ADDRESS =

   2754  1 000706   000016 473500                    LDP3    14,,PR0
         1 000707   200036 453500                    STP3    FOUND_LA+1,,AUTO
         1 000710   200036 236100                    LDQ     FOUND_LA+1,,AUTO
         1 000711   000010 036003                    ADLQ    8,DU
         1 000712   000022 772000                    QRL     18
         1 000713   000000 235000 xsym               LDA     B$REAL$
         1 000714   000022 771000                    ARL     18
         1 000715   200037 755100                    STA     FOUND_LA+2,,AUTO
         1 000716   200037 136100                    SBLQ    FOUND_LA+2,,AUTO
         1 000717   000000 621006                    EAX1    0,QL
         1 000720   300004 741100                    STX1    4,,PR3

      242     2755    7                            POFFW (ADDR (DQH$ -> NI$DQH.IOSTATUS$ -> NI$IOSTAT.EXTST),
              2755                                     B$REAL$);
      243     2756    7                          END;

      244     2757
      245     2758    6                      NI$FQ$ -> NI$FQ.HD$ = PINCRW(NI$FQ$ -> NI$FQ.HD$,SIZEW(NI$IOSTAT
              2758                                ));

   2758  1 000721   100002 236100                    LDQ     2,,PR1
         1 000722   000020 036003                    ADLQ    16,DU
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:42   
         1 000723   100002 756100                    STQ     2,,PR1

      246     2759    6                       END;

      247     2760    5                    IT_PARTITION.IOCHAN(IOM#*%N_MAXCHANS+LO_CHAN+J) = CMD$ -> IT$MPC.
              2760                             LA_IOM.DOWN (LA_IOM#);

   2760  1 000724   200015 236100                    LDQ     IOM#,,AUTO
         1 000725   000007 736000                    QLS     7
         1 000726   200016 036100                    ADLQ    LO_CHAN,,AUTO
         1 000727   200023 036100                    ADLQ    J,,AUTO
         1 000730   200036 756100                    STQ     FOUND_LA+1,,AUTO
         1 000731   200020 236100                    LDQ     LA_IOM#,,AUTO
         1 000732   000110 402007                    MPY     72,DL
         1 000733   000000 116003                    CMPQ    0,DU
         1 000734   000736 605000 1                  TPL     s:2760+10
         1 000735   000044 036003                    ADLQ    36,DU
         1 000736   200036 235100                    LDA     FOUND_LA+1,,AUTO
         1 000737   000741 605000 1                  TPL     s:2760+13
         1 000740   000044 035003                    ADLA    36,DU
         1 000741   200004 471500                    LDP1    CMD$,,AUTO
         1 000742   003005 060506                    CSL     bolr='003'O
         1 000743   100010 410001                    BDSC    8,Q,PR1                  by=2,bit=1,n=1
         1 000744   000012 000001 xsym               BDSC    IT_PARTITION+10,A        by=0,bit=0,n=1

      248     2761    5                    IF NOT CMD$ -> IT$MPC.LA_IOM.DOWN (LA_IOM#) AND

   2761  1 000745   200020 235100                    LDA     LA_IOM#,,AUTO
         1 000746   000001 735000                    ALS     1
         1 000747   100010 236105                    LDQ     8,AL,PR1
         1 000750   200000 316007                    CANQ    65536,DL
         1 000751   000760 601000 1                  TNZ     s:2766
         1 000752   200035 234100                    SZN     FOUND_LA,,AUTO
         1 000753   000760 604000 1                  TMI     s:2766

      249     2762    6                      NOT FOUND_LA THEN DO ;

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:43   
      250     2763    6                       DCT_DQH$ = DQH$;

   2763  1 000754   200006 236100                    LDQ     DQH$,,AUTO
         1 000755   200013 756100                    STQ     DCT_DQH$,,AUTO

      251     2764    6                       FOUND_LA = '1'B ;

   2764  1 000756   400000 236003                    LDQ     -131072,DU
         1 000757   200035 756100                    STQ     FOUND_LA,,AUTO

      252     2765    6                       END ;

      253     2766    6                    IF MOD(J,2)=0 THEN DO;

   2766  1 000760   200023 236100                    LDQ     J,,AUTO
         1 000761   000002 506007                    DIV     2,DL
         1 000762   000044 733000                    LRS     36
         1 000763   000000 116003                    CMPQ    0,DU
         1 000764   000772 601000 1                  TNZ     s:2771

      254     2767    6                       SCHAN$ = DQH$;

   2767  1 000765   200006 236100                    LDQ     DQH$,,AUTO
         1 000766   200034 756100                    STQ     SCHAN$,,AUTO

      255     2768    6                       DQH$ -> NI$DQH.SCHAN$ = PINCRW(DQH$,SIZEW(NI$DQH));

   2768  1 000767   000022 036003                    ADLQ    18,DU
         1 000770   000012 756100                    STQ     10,,PR0

      256     2769    6                       END;

   2769  1 000771   000774 710000 1                  TRA     s:2773

      257     2770    6                    ELSE DO;

      258     2771    6                       DQH$ -> NI$DQH.SCHAN$ = SCHAN$;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:44   

   2771  1 000772   200034 236100                    LDQ     SCHAN$,,AUTO
         1 000773   000012 756100                    STQ     10,,PR0

      259     2772    6                       END;

      260     2773    5                    DQH$ -> NI$DQH.IOCHAN.IOM = IOM#;

   2773  1 000774   200015 236100                    LDQ     IOM#,,AUTO
         1 000775   000031 736000                    QLS     25
         1 000776   000001 676100                    ERQ     1,,PR0
         1 000777   000600 376003                    ANQ     384,DU
         1 001000   000001 656100                    ERSQ    1,,PR0

      261     2774    5                    DQH$ -> NI$DQH.IOCHAN.CHANNEL = LO_CHAN + J;

   2774  1 001001   200016 236100                    LDQ     LO_CHAN,,AUTO
         1 001002   200023 036100                    ADLQ    J,,AUTO
         1 001003   000022 736000                    QLS     18
         1 001004   000001 676100                    ERQ     1,,PR0
         1 001005   000177 376003                    ANQ     127,DU
         1 001006   000001 656100                    ERSQ    1,,PR0

      262     2775    6                   IF NI$CHT$ -> NI$CHT.DQH$(DQH$ -> NI$DQH.IOCHANX) ~= ADDR(NIL) THEN
              2775                             DO;

   2775  1 001007   000001 236100                    LDQ     1,,PR0
         1 001010   000021 772000                    QRL     17
         1 001011   001776 376007                    ANQ     1022,DL
         1 001012   000000 473400 xsym               LDP3    NI$CHT$
         1 001013   300000 236106                    LDQ     0,QL,PR3
         1 001014   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001015   001051 600000 1                  TZE     s:2784

      263     2776    6                       DUPCHANERR_TEXT.COUNT = SIZEC(DUPCHANERR_TEXT) -1;

   2776  1 001016   014000 236003                    LDQ     6144,DU
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:45   
         1 001017   200025 552140                    STBQ    DUPCHANERR_TEXT,'40'O,AUTO

      264     2777    6                       DUPCHANERR_TEXT.CHANNEL = 'CHANNEL';

   2777  1 001020   040100 100400                    MLR     fill='040'O
         1 001021   000054 000007 0                  ADSC9   44                       cn=0,n=7
         1 001022   200025 200010                    ADSC9   DUPCHANERR_TEXT,,AUTO    cn=1,n=8

      265     2778    6                       CALL BINCHAR(DUPCHANERR_TEXT.IOMTEXT,IOM#);

   2778  1 001023   000100 301500                    BTD
         1 001024   200015 000004                    NDSC9   IOM#,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         1 001025   200027 230001                    NDSC9   DUPCHANERR_TEXT+2,,AUTO  cn=1,s=nosgn,sf=0,n=1

      266     2779    6                       DUPCHANERR_TEXT.DASH = '-';

   2779  1 001026   055000 236007                    LDQ     23040,DL
         1 001027   200027 552110                    STBQ    DUPCHANERR_TEXT+2,'10'O,AUTO

      267     2780    6                       CALL BINCHAR(DUPCHANERR_TEXT.CHANTEXT,LO_CHAN+J);

   2780  1 001030   200016 236100                    LDQ     LO_CHAN,,AUTO
         1 001031   200023 036100                    ADLQ    J,,AUTO
         1 001032   200036 756100                    STQ     FOUND_LA+1,,AUTO
         1 001033   000100 301500                    BTD
         1 001034   200036 000004                    NDSC9   FOUND_LA+1,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         1 001035   200027 630002                    NDSC9   DUPCHANERR_TEXT+2,,AUTO  cn=3,s=nosgn,sf=0,n=2

      268     2781    6                       CALL ITE$ERROR(%E$DUPCHAN,ADDR(DUPCHANERR_TEXT));

   2781  1 001036   200025 634500                    EPPR4   DUPCHANERR_TEXT,,AUTO
         1 001037   200036 454500                    STP4    FOUND_LA+1,,AUTO
         1 001040   200036 635500                    EPPR5   FOUND_LA+1,,AUTO
         1 001041   200041 455500                    STP5    FOUND_LA+4,,AUTO
         1 001042   000004 236000 2                  LDQ     4
         1 001043   200040 756100                    STQ     FOUND_LA+3,,AUTO
         1 001044   200040 630500                    EPPR0   FOUND_LA+3,,AUTO
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:46   
         1 001045   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001046   000000 701000 xent               TSX1    ITE$ERROR
         1 001047   000000 011000                    NOP     0

      269     2782    6                       END;

   2782  1 001050   001066 710000 1                  TRA     s:2787

      270     2783    6                    ELSE DO;

      271     2784    6                       NI$CHT$ -> NI$CHT.DQH$(DQH$ -> NI$DQH.IOCHANX) = DQH$;

   2784  1 001051   000001 236100                    LDQ     1,,PR0
         1 001052   000021 772000                    QRL     17
         1 001053   001776 376007                    ANQ     1022,DL
         1 001054   000000 620006                    EAX0    0,QL
         1 001055   200006 236100                    LDQ     DQH$,,AUTO
         1 001056   300000 756110                    STQ     0,X0,PR3

      272     2785    6                       NI$CHT$ -> NI$CHT.POSTER(DQH$ -> NI$DQH.IOCHANX) = POSTER;

   2785  1 001057   000001 236100                    LDQ     1,,PR0
         1 001060   000021 772000                    QRL     17
         1 001061   001776 376007                    ANQ     1022,DL
         1 001062   000000 620006                    EAX0    0,QL
         1 001063   200024 236100                    LDQ     POSTER,,AUTO
         1 001064   000000 473400 xsym               LDP3    NI$CHT$
         1 001065   300001 756110                    STQ     1,X0,PR3

      273     2786    6                       END;

      274     2787    5                    IF CHX = %N_CHANSPERMPC THEN

   2787  1 001066   200033 235100                    LDA     CHX,,AUTO
         1 001067   000020 115007                    CMPA    16,DL
         1 001070   001125 600000 1                  TZE     EXEC_MPC_ERR

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:47   
      275     2788    5                       GOTO EXEC_MPC_ERR;
      276     2789    5                    DEV$ -> NI$DCT.MPC.IOCHANX(CHX) = DQH$ -> NI$DQH.IOCHANX;

   2789  1 001071   200006 470500                    LDP0    DQH$,,AUTO
         1 001072   200007 471500                    LDP1    DEV$,,AUTO
         1 001073   000105 100500                    MLR     fill='000'O
         1 001074   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1
         1 001075   100031 000001                    ADSC9   25,A,PR1                 cn=0,n=1

      277     2790    5                    CHX = CHX + 1;

   2790  1 001076   000001 035007                    ADLA    1,DL
         1 001077   200033 755100                    STA     CHX,,AUTO

      278     2791    5                    END;

   2791  1 001100   200023 054100                    AOS     J,,AUTO
         1 001101   200023 236100                    LDQ     J,,AUTO
         1 001102   200022 116100                    CMPQ    I,,AUTO
         1 001103   000634 604000 1                  TMI     s:2736

      279     2792    4                 END;

      280     2793    3              END;

   2793  1 001104   200020 054100                    AOS     LA_IOM#,,AUTO
         1 001105   200020 235100                    LDA     LA_IOM#,,AUTO
         1 001106   000003 115007                    CMPA    3,DL
         1 001107   000610 604400 1                  TMOZ    s:2730

      281     2794    2           DEV$ -> NI$DCT.DQH$ = DCT_DQH$; /* MAKE SURE MPC'S DCT.DQH$ IS UP */

   2794  1 001110   200013 236100                    LDQ     DCT_DQH$,,AUTO
         1 001111   200007 470500                    LDP0    DEV$,,AUTO
         1 001112   000023 756100                    STQ     19,,PR0

      282     2795    2           IF NOT FOUND_LA THEN            /*  All chans down;  MPC must be down */
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:48   

   2795  1 001113   200035 234100                    SZN     FOUND_LA,,AUTO
         1 001114   001123 604000 1                  TMI     s:2797

      283     2796    2              IT_PARTITION.DEVICE(N_DCTXMAX) = '1'B ;

   2796  1 001115   000000 235000 xsym               LDA     N_DCTXMAX
         1 001116   001120 605000 1                  TPL     s:2796+3
         1 001117   000044 035003                    ADLA    36,DU
         1 001120   003005 060400                    CSL     bolr='003'O
         1 001121   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 001122   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1

      284     2797    2           RETURN;

   2797  1 001123   200032 221300                    LDX1  ! DUPCHANERR_TEXT+5,,AUTO
         1 001124   000001 702211                    TSX2  ! 1,X1

      285     2798    2   EXEC_MPC_ERR:
      286     2799    2           ALTRETURN;

   2799  1 001125   200032 221300       EXEC_MPC_ERR LDX1  ! DUPCHANERR_TEXT+5,,AUTO
         1 001126   000000 702211                    TSX2  ! 0,X1

      287     2800    2   END EXEC_MPC;
      288     2801        %EJECT;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:49   
      289     2802        /*D*     INTERNAL ROUTINE:   EXEC_DEV
      290     2803                 DESCRIPTION:   EXEC_DEV builds a DCT entry for a device and
      291     2804                           fills it in from the information in the command
      292     2805                           table. In addition a RAT table entry and a DDT
      293     2806                           table entry is built for each device for which
      294     2807                           they are required. In addition the number of packs
      295     2808                           N_NDPS is incremented if the device is a pack. */
      296     2809        /**/
      297     2810    1   EXEC_DEV: PROC ALTRET;

   2810  1 001127   200032 741300       EXEC_DEV     STX1  ! DUPCHANERR_TEXT+5,,AUTO

      298     2811        /**/
      299     2812                                                /* BUILD DCT ENTRY FOR DEVICE */
      300     2813    2           CALL ITH$DCT_INIT(PTR$,DEV$) ALTRET(EXEC_DEV_ERR);

   2813  1 001130   200007 630500                    EPPR0   DEV$,,AUTO
         1 001131   200037 450500                    STP0    FOUND_LA+2,,AUTO
         1 001132   200003 236100                    LDQ     @PTR$,,AUTO
         1 001133   200036 756100                    STQ     FOUND_LA+1,,AUTO
         1 001134   200036 630500                    EPPR0   FOUND_LA+1,,AUTO
         1 001135   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001136   000000 701000 xent               TSX1    ITH$DCT_INIT
         1 001137   001564 702000 1                  TSX2    EXEC_DEV_ERR

      301     2814        /**/
      302     2815    2           IF (B$DS5$ -> IT$CMDWD = %ITS_DISK) THEN N_NDPS = N_NDPS + 1;

   2815  1 001140   000000 470400 xsym               LDP0    B$DS5$
         1 001141   000000 235100                    LDA     0,,PR0
         1 001142   000002 115007                    CMPA    2,DL
         1 001143   001145 601000 1                  TNZ     s:2817

   2815  1 001144   000000 054000 xsym               AOS     N_NDPS

      303     2816        /**/
      304     2817    2           SQH$ -> NI$SQH.NDCT = SQH$ -> NI$SQH.NDCT + 1;
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:50   

   2817  1 001145   200005 471500                    LDP1    SQH$,,AUTO
         1 001146   100002 720100                    LXL0    2,,PR1
         1 001147   000001 621010                    EAX1    1,X0
         1 001150   100002 441100                    SXL1    2,,PR1

      305     2818        /**/
      306     2819    2           DEV$ -> NI$DCT.DEVNM = CMD$ -> IT$DTDEV.NAME;

   2819  1 001151   200004 471500                    LDP1    CMD$,,AUTO
         1 001152   200007 473500                    LDP3    DEV$,,AUTO
         1 001153   040100 100500                    MLR     fill='040'O
         1 001154   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         1 001155   300002 000010                    ADSC9   2,,PR3                   cn=0,n=8

      307     2820        /**/
      308     2821    2           CALL ITH$RAT_INIT(PTR$,RAT$) ALTRET(EXEC_DEV_ERR);

   2821  1 001156   200010 633500                    EPPR3   RAT$,,AUTO
         1 001157   200037 453500                    STP3    FOUND_LA+2,,AUTO
         1 001160   200003 236100                    LDQ     @PTR$,,AUTO
         1 001161   200036 756100                    STQ     FOUND_LA+1,,AUTO
         1 001162   200036 630500                    EPPR0   FOUND_LA+1,,AUTO
         1 001163   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001164   000000 701000 xent               TSX1    ITH$RAT_INIT
         1 001165   001564 702000 1                  TSX2    EXEC_DEV_ERR

      309     2822    2           DEV$ -> NI$DCT.RAT$ = RAT$;

   2822  1 001166   200010 236100                    LDQ     RAT$,,AUTO
         1 001167   200007 470500                    LDP0    DEV$,,AUTO
         1 001170   000005 756100                    STQ     5,,PR0

      310     2823    2           RAT$ -> FR$RAT.TYP = CMD$ -> IT$DTDEV.NM.MNEM;

   2823  1 001171   200004 470500                    LDP0    CMD$,,AUTO
         1 001172   000002 220100                    LDX0    2,,PR0
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:51   
         1 001173   200010 471500                    LDP1    RAT$,,AUTO
         1 001174   100010 740100                    STX0    8,,PR1

      311     2824        /*
      312     2825           **** SET ATTR. AS SPECIFIED ON DEV COMMAND OR ELSE TO ITS DEFAULT
      313     2826        */
      314     2827    2           IF CMD$ -> IT$DTDEV.ATTR ~= NO THEN

   2827  1 001175   000000 106500                    CMPC    fill='000'O
         1 001176   000004 600002                    ADSC9   4,,PR0                   cn=3,n=2
         1 001177   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         1 001200   001210 600000 1                  TZE     s:2830

      315     2828    2              RAT$ -> FR$RAT.M1 = CMD$ -> IT$DTDEV.ATTR;

   2828  1 001201   000100 100500                    MLR     fill='000'O
         1 001202   000004 600002                    ADSC9   4,,PR0                   cn=3,n=2
         1 001203   200036 000004                    ADSC9   FOUND_LA+1,,AUTO         cn=0,n=4
         1 001204   200036 220100                    LDX0    FOUND_LA+1,,AUTO
         1 001205   200010 471500                    LDP1    RAT$,,AUTO
         1 001206   100006 740100                    STX0    6,,PR1
         1 001207   001216 710000 1                  TRA     s:2832

      316     2829    2           ELSE
      317     2830    2              RAT$ -> FR$RAT.M1 = NI$DVT$(CMD$ -> IT$DTDEV.TYPE) -> NI$DVT.ATTR;

   2830  1 001210   000004 236100                    LDQ     4,,PR0
         1 001211   000033 772000                    QRL     27
         1 001212   000000 471406 xsym               LDP1    NI$DVT$,QL
         1 001213   100056 720100                    LXL0    46,,PR1
         1 001214   200010 473500                    LDP3    RAT$,,AUTO
         1 001215   300006 740100                    STX0    6,,PR3

      318     2831        /**/
      319     2832    3           IF (B$DS5$ -> IT$CMDWD = %ITS_DISK) THEN DO; /* DISK                   */

   2832  1 001216   000000 471400 xsym               LDP1    B$DS5$
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:52   
         1 001217   100000 235100                    LDA     0,,PR1
         1 001220   000002 115007                    CMPA    2,DL
         1 001221   001257 601000 1                  TNZ     s:2850

      320     2833    3              FR_PRM$(0) -> FR$PR(FR_DP) = FR_PRM$(0) -> FR$PR(FR_DP) + 1;

   2833  1 001222   000000 473400 xsym               LDP3    FR_PRM$
         1 001223   300000 054100                    AOS     0,,PR3

      321     2834    3              DEV$ -> NI$DCT.PMD$ = PTR$;

   2834  1 001224   200003 471500                    LDP1    @PTR$,,AUTO
         1 001225   100000 236100                    LDQ     0,,PR1
         1 001226   200007 473500                    LDP3    DEV$,,AUTO
         1 001227   300044 756100                    STQ     36,,PR3

      322     2835    3              PTR$ -> P$IODATA = NO;

   2835  1 001230   100000 474500                    LDP4    0,,PR1
         1 001231   000100 100400                    MLR     fill='000'O
         1 001232   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001233   400000 000034                    ADSC9   0,,PR4                   cn=0,n=28

      323     2836        /**/
      324     2837    3              CALL ITH$ALLOCATE(PTR$,SIZEW(P$IODATA)) ALTRET(EXEC_DEV_ERR);

   2837  1 001234   000005 236000 2                  LDQ     5
         1 001235   200003 235100                    LDA     @PTR$,,AUTO
         1 001236   200036 757100                    STAQ    FOUND_LA+1,,AUTO
         1 001237   200036 630500                    EPPR0   FOUND_LA+1,,AUTO
         1 001240   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001241   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001242   001564 702000 1                  TSX2    EXEC_DEV_ERR

      325     2838        /**/
      326     2839    3              RAT$ -> FR$RAT.RCOD = FR_DP;

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:53   
   2839  1 001243   200010 470500                    LDP0    RAT$,,AUTO
         1 001244   000006 236000 2                  LDQ     6
         1 001245   000003 356100                    ANSQ    3,,PR0

      327     2840    3              DDT$ = ADDR(FR$HD$(FR_DP));

   2840  1 001246   000007 236000 2                  LDQ     7
         1 001247   200011 756100                    STQ     DDT$,,AUTO

      328     2841        /*
      329     2842           **** SET DP DEFAULT FOR RESOURCE MANAGEMENT EQUAL TO FIRST
      330     2843           **** DP DEVICE SPECIFIED.
      331     2844        */
      332     2845    3              IF FR_DPDFLT = NO THEN

   2845  1 001250   000000 235000 xsym               LDA     FR_DPDFLT
         1 001251   001402 601000 1                  TNZ     s:2886

      333     2846    3                 FR_DPDFLT = RAT$ -> FR$RAT.M1;

   2846  1 001252   200010 470500                    LDP0    RAT$,,AUTO
         1 001253   000006 236100                    LDQ     6,,PR0
         1 001254   777777 376003                    ANQ     -1,DU
         1 001255   000000 756000 xsym               STQ     FR_DPDFLT

      334     2847    3              END;

   2847  1 001256   001402 710000 1                  TRA     s:2886

      335     2848        /**/
      336     2849    3           ELSE DO;                        /* Tape or Optical Disc */

      337     2850    3              DEV$ -> NI$DCT.MT.FREPOS$ = ADDR(NIL);

   2850  1 001257   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001260   200007 473500                    LDP3    DEV$,,AUTO
         1 001261   300031 756100                    STQ     25,,PR3
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:54   

      338     2851    3              DEV$ -> NI$DCT.MT.SETDENS$ = ADDR(NIL);

   2851  1 001262   300042 756100                    STQ     34,,PR3

      339     2852    3              DEV$ -> NI$DCT.MT.CURDENS = %N_SD1600;

   2852  1 001263   024000 236003                    LDQ     10240,DU
         1 001264   300041 552140                    STBQ    33,'40'O,PR3

      340     2853    3              DDT$ = PTR$;                 /* BUILD DDT                          */

   2853  1 001265   200003 474500                    LDP4    @PTR$,,AUTO
         1 001266   400000 236100                    LDQ     0,,PR4
         1 001267   200011 756100                    STQ     DDT$,,AUTO

      341     2854    3              CALL ITH$ALLOCATE(PTR$,SIZEW(FT$DDT)) ALTRET(EXEC_DEV_ERR);

   2854  1 001270   000010 236000 2                  LDQ     8
         1 001271   200003 235100                    LDA     @PTR$,,AUTO
         1 001272   200036 757100                    STAQ    FOUND_LA+1,,AUTO
         1 001273   200036 630500                    EPPR0   FOUND_LA+1,,AUTO
         1 001274   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001275   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001276   001564 702000 1                  TSX2    EXEC_DEV_ERR

      342     2855        /**/
      343     2856    3              DDT$ -> FT$DDT = NO;

   2856  1 001277   200011 470500                    LDP0    DDT$,,AUTO
         1 001300   000100 100400                    MLR     fill='000'O
         1 001301   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001302   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32

      344     2857        /**/
      345     2858    3              DDT$ -> FT$DDT.ACCT = ' ';

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:55   
   2858  1 001303   000035 235000 xsym               LDA     B_VECTNIL+29
         1 001304   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 001305   000000 755100                    STA     0,,PR0
         1 001306   000001 756100                    STQ     1,,PR0

      346     2859    3              DDT$ -> FT$DDT.SN = ' ';

   2859  1 001307   040100 100400                    MLR     fill='040'O
         1 001310   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001311   000002 000006                    ADSC9   2,,PR0                   cn=0,n=6

      347     2860    3              DDT$ -> FT$DDT.EXPIRE = ' ';

   2860  1 001312   040100 100400                    MLR     fill='040'O
         1 001313   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001314   000003 400006                    ADSC9   3,,PR0                   cn=2,n=6

      348     2861        /**/
      349     2862    3              DEV$ -> NI$DCT.DDT$ = DDT$;

   2862  1 001315   200011 236100                    LDQ     DDT$,,AUTO
         1 001316   200007 471500                    LDP1    DEV$,,AUTO
         1 001317   100004 756100                    STQ     4,,PR1

      350     2863    4              IF B$DS5$->IT$CMDWD = %ITS_TAPE THEN DO;

   2863  1 001320   000000 471400 xsym               LDP1    B$DS5$
         1 001321   100000 235100                    LDA     0,,PR1
         1 001322   000003 115007                    CMPA    3,DL
         1 001323   001344 601000 1                  TNZ     s:2876

      351     2864    4                 RAT$->FR$RAT.RCOD = FR_MT;

   2864  1 001324   200010 473500                    LDP3    RAT$,,AUTO
         1 001325   300003 236100                    LDQ     3,,PR3
         1 001326   000006 376000 2                  ANQ     6
         1 001327   000040 276003                    ORQ     32,DU
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:56   
         1 001330   300003 756100                    STQ     3,,PR3

      352     2865    4                 FR_PRM$(0)->FR$PR(FR_MT) = FR_PRM$(0)->FR$PR(FR_MT) + 1;

   2865  1 001331   000000 473400 xsym               LDP3    FR_PRM$
         1 001332   300001 054100                    AOS     1,,PR3

      353     2866    4                 DDT$ = ADDR(FR$HD$(FR_MT));

   2866  1 001333   000011 236000 2                  LDQ     9
         1 001334   200011 756100                    STQ     DDT$,,AUTO

      354     2867        /*
      355     2868           ****       SET TAPE DENSITY DEFAULT FOR RESOURCE MANAGEMENT
      356     2869           ****       EQUAL TO FIRST DENSITY SPEC'D OR TO THE DEFAULT.
      357     2870           ****       DEFAULT SPEC'D ON MON COMMAND WILL TAKE PRECEDENCE IF SPEC'D
      358     2871        */
      359     2872    4                 IF FR_MTDFLT = NO THEN

   2872  1 001335   000000 235000 xsym               LDA     FR_MTDFLT
         1 001336   001402 601000 1                  TNZ     s:2886

      360     2873    4                    FR_MTDFLT = RAT$->FR$RAT.M1;

   2873  1 001337   200010 470500                    LDP0    RAT$,,AUTO
         1 001340   000006 236100                    LDQ     6,,PR0
         1 001341   777777 376003                    ANQ     -1,DU
         1 001342   000000 756000 xsym               STQ     FR_MTDFLT

      361     2874    4                 END;

   2874  1 001343   001402 710000 1                  TRA     s:2886

      362     2875    4              ELSE DO;                     /* Optical Disc Devices     */

      363     2876    4                 RAT$->FR$RAT.M1 = '0'B;

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:57   
   2876  1 001344   000000 220003                    LDX0    0,DU
         1 001345   200010 473500                    LDP3    RAT$,,AUTO
         1 001346   300006 740100                    STX0    6,,PR3

      364     2877    4                 FR_PRM$(0)->FR$PR(FR_NPOOL) = FR_PRM$(0)->FR$PR(FR_NPOOL) + 1;

   2877  1 001347   000000 473400 xsym               LDP3    FR_PRM$
         1 001350   300002 054100                    AOS     2,,PR3

      365     2878    4                 DCT_DQH$ = NI$CHT$->NI$CHT.DQH$(CMD$->IT$DTDEV.VFC);

   2878  1 001351   200004 474500                    LDP4    CMD$,,AUTO
         1 001352   400005 235100                    LDA     5,,PR4
         1 001353   400006 236100                    LDQ     6,,PR4
         1 001354   000033 773000                    LRL     27
         1 001355   000001 736000                    QLS     1
         1 001356   000000 475400 xsym               LDP5    NI$CHT$
         1 001357   500000 236106                    LDQ     0,QL,PR5
         1 001360   200013 756100                    STQ     DCT_DQH$,,AUTO

      366     2879    4                 DDT$ = ADDR(FR$HD$(FR_NPOOL));

   2879  1 001361   000012 236000 2                  LDQ     10
         1 001362   200011 756100                    STQ     DDT$,,AUTO

      367     2880    4                 MPC$ = DEV$;              /* No DQH for these         */

   2880  1 001363   200007 236100                    LDQ     DEV$,,AUTO
         1 001364   200012 756100                    STQ     MPC$,,AUTO

      368     2881    4                 DEV$->NI$DCT.OD.OPCI$ = ADDR(CMD$->IT$DTDEV.CHAIN)->IT$PTR;

   2881  1 001365   400006 235100                    LDA     6,,PR4
         1 001366   400007 236100                    LDQ     7,,PR4
         1 001367   000033 773000                    LRL     27
         1 001370   000027 376000 xsym               ANQ     B_VECTNIL+23
         1 001371   200007 470500                    LDP0    DEV$,,AUTO
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:58   
         1 001372   000031 756100                    STQ     25,,PR0

      369     2882    4                 DEV$->NI$DCT.OD.FEI$ = IT_FEI$$->KI$FEI$(DCT_DQH$->NI$DQH.FEX);

   2882  1 001373   200013 476500                    LDP6    DCT_DQH$,,AUTO
         1 001374   600001 236100                    LDQ     1,,PR6
         1 001375   000006 772000                    QRL     6
         1 001376   000077 376007                    ANQ     63,DL
         1 001377   000000 477400 xsym               LDP7    IT_FEI$$
         1 001400   700000 236106                    LDQ     0,QL,PR7
         1 001401   000032 756100                    STQ     26,,PR0

      370     2883    4                 END;

      371     2884    3              END;

      372     2885        /**/
      373     2886    3           IF (DDT$ -> IT$PTR ~= ADDR(NIL)) THEN DO;

   2886  1 001402   200011 470500                    LDP0    DDT$,,AUTO
         1 001403   000000 236100                    LDQ     0,,PR0
         1 001404   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001405   001422 600000 1                  TZE     s:2895

      374     2887    3              DDT$ = DDT$ -> IT$PTR;

   2887  1 001406   200011 756100                    STQ     DDT$,,AUTO

      375     2888    4              DO WHILE (DDT$ -> FR$RAT.LNK$ ~= ADDR(NIL));

   2888  1 001407   001413 710000 1                  TRA     s:2890

      376     2889    4                 DDT$ = DDT$ -> FR$RAT.LNK$;

   2889  1 001410   200011 470500                    LDP0    DDT$,,AUTO
         1 001411   000000 236100                    LDQ     0,,PR0
         1 001412   200011 756100                    STQ     DDT$,,AUTO
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:59   

      377     2890    4                 END;

   2890  1 001413   200011 470500                    LDP0    DDT$,,AUTO
         1 001414   000000 236100                    LDQ     0,,PR0
         1 001415   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001416   001410 601000 1                  TNZ     s:2889

      378     2891    3              DDT$ -> FR$RAT.LNK$ = RAT$;

   2891  1 001417   200010 236100                    LDQ     RAT$,,AUTO
         1 001420   000000 756100                    STQ     0,,PR0

      379     2892    3              END;

   2892  1 001421   001424 710000 1                  TRA     s:2898

      380     2893        /**/
      381     2894    3           ELSE DO;

      382     2895    3              DDT$ -> IT$PTR = RAT$;

   2895  1 001422   200010 236100                    LDQ     RAT$,,AUTO
         1 001423   000000 756100                    STQ     0,,PR0

      383     2896    3              END;

      384     2897        /**/
      385     2898    2           DEV$ -> NI$DCT.DVT$ = NI$DVT$(CMD$ -> IT$DTDEV.TYPE);

   2898  1 001424   200004 471500                    LDP1    CMD$,,AUTO
         1 001425   100004 236100                    LDQ     4,,PR1
         1 001426   000033 772000                    QRL     27
         1 001427   000000 236006 xsym               LDQ     NI$DVT$,QL
         1 001430   200007 473500                    LDP3    DEV$,,AUTO
         1 001431   300024 756100                    STQ     20,,PR3

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:60   
      386     2899    2           IF B$DS5$->IT$CMDWD = %ITS_OD THEN

   2899  1 001432   000000 474400 xsym               LDP4    B$DS5$
         1 001433   400000 235100                    LDA     0,,PR4
         1 001434   000017 115007                    CMPA    15,DL
         1 001435   001441 601000 1                  TNZ     s:2902

      387     2900    2              DEV$ -> NI$DCT.TYPE = %DV_OD;

   2900  1 001436   001300 236007                    LDQ     704,DL
         1 001437   300007 752102                    STCQ    7,'02'O,PR3
         1 001440   001445 710000 1                  TRA     s:2903

      388     2901    2           ELSE
      389     2902    2              DEV$ -> NI$DCT.TYPE = DEV$ -> NI$DCT.DVT$ -> NI$DVT.TYPE;

   2902  1 001441   300024 475500                    LDP5    20,,PR3
         1 001442   500053 236100                    LDQ     43,,PR5
         1 001443   000025 772000                    QRL     21
         1 001444   300007 752102                    STCQ    7,'02'O,PR3

      390     2903    2           DEV$ -> NI$DCT.FX = CMD$ -> IT$DTDEV.FX;

   2903  1 001445   200007 473500                    LDP3    DEV$,,AUTO
         1 001446   100004 236100                    LDQ     4,,PR1
         1 001447   000003 736000                    QLS     3
         1 001450   300007 752104                    STCQ    7,'04'O,PR3

      391     2904    2           DEV$ -> NI$DCT.MODX = CMD$ -> IT$DTDEV.MODX;

   2904  1 001451   200007 473500                    LDP3    DEV$,,AUTO
         1 001452   100004 236100                    LDQ     4,,PR1
         1 001453   300007 752110                    STCQ    7,'10'O,PR3

      392     2905    2           DEV$ -> NI$DCT.DVN = CMD$ -> IT$DTDEV.DEV#;

   2905  1 001454   200007 473500                    LDP3    DEV$,,AUTO
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:61   
         1 001455   100001 236100                    LDQ     1,,PR1
         1 001456   000030 736000                    QLS     24
         1 001457   300007 752120                    STCQ    7,'20'O,PR3

      393     2906    2           DEV$ -> NI$DCT.DFLG.INPUT = CMD$ -> IT$DTDEV.FLAGS.INPUT;

   2906  1 001460   200007 473500                    LDP3    DEV$,,AUTO
         1 001461   100001 236100                    LDQ     1,,PR1
         1 001462   000022 772000                    QRL     18
         1 001463   300006 676100                    ERQ     6,,PR3
         1 001464   400000 376007                    ANQ     -131072,DL
         1 001465   300006 656100                    ERSQ    6,,PR3

      394     2907    2           DEV$ -> NI$DCT.DFLG.OUTPUT = CMD$ -> IT$DTDEV.FLAGS.OUTPUT;

   2907  1 001466   200007 473500                    LDP3    DEV$,,AUTO
         1 001467   100001 236100                    LDQ     1,,PR1
         1 001470   000022 772000                    QRL     18
         1 001471   300006 676100                    ERQ     6,,PR3
         1 001472   200000 376007                    ANQ     65536,DL
         1 001473   300006 656100                    ERSQ    6,,PR3

      395     2908    2           DEV$ -> NI$DCT.DFLG.CM = CMD$ -> IT$DTDEV.FLAGS.CM;

   2908  1 001474   200007 473500                    LDP3    DEV$,,AUTO
         1 001475   100001 236100                    LDQ     1,,PR1
         1 001476   000022 772000                    QRL     18
         1 001477   300006 676100                    ERQ     6,,PR3
         1 001500   100000 376007                    ANQ     32768,DL
         1 001501   300006 656100                    ERSQ    6,,PR3

      396     2909    2           DEV$ -> NI$DCT.DFLG.SYMBIONT = CMD$ -> IT$DTDEV.FLAGS.SYMBIONT;

   2909  1 001502   200007 473500                    LDP3    DEV$,,AUTO
         1 001503   100001 236100                    LDQ     1,,PR1
         1 001504   000022 772000                    QRL     18
         1 001505   300006 676100                    ERQ     6,,PR3
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:62   
         1 001506   020000 376007                    ANQ     8192,DL
         1 001507   300006 656100                    ERSQ    6,,PR3

      397     2910    2           DEV$ -> NI$DCT.DFLG.PSIA = CMD$ -> IT$DTDEV.FLAGS.PSIA;

   2910  1 001510   200007 473500                    LDP3    DEV$,,AUTO
         1 001511   100001 236100                    LDQ     1,,PR1
         1 001512   000022 772000                    QRL     18
         1 001513   300006 676100                    ERQ     6,,PR3
         1 001514   010000 376007                    ANQ     4096,DL
         1 001515   300006 656100                    ERSQ    6,,PR3

      398     2911    2           DEV$ -> NI$DCT.DFLG.CHECKWRITE = CMD$->IT$DTDEV.FLAGS.CHECKWRITE;

   2911  1 001516   200007 473500                    LDP3    DEV$,,AUTO
         1 001517   100001 236100                    LDQ     1,,PR1
         1 001520   000027 772000                    QRL     23
         1 001521   300006 676100                    ERQ     6,,PR3
         1 001522   000040 376007                    ANQ     32,DL
         1 001523   300006 656100                    ERSQ    6,,PR3

      399     2912    2           DEV$ -> NI$DCT.CTYP = MPC$ -> NI$DCT.CTYP;

   2912  1 001524   200012 473500                    LDP3    MPC$,,AUTO
         1 001525   200007 475500                    LDP5    DEV$,,AUTO
         1 001526   300007 236100                    LDQ     7,,PR3
         1 001527   500007 676100                    ERQ     7,,PR5
         1 001530   070000 376003                    ANQ     28672,DU
         1 001531   500007 656100                    ERSQ    7,,PR5

      400     2913    2           DEV$ -> NI$DCT.DEV0LGL = MPC$ -> NI$DCT.DEV0LGL;

   2913  1 001532   200007 475500                    LDP5    DEV$,,AUTO
         1 001533   300007 236100                    LDQ     7,,PR3
         1 001534   500007 676100                    ERQ     7,,PR5
         1 001535   400000 376003                    ANQ     -131072,DU
         1 001536   500007 656100                    ERSQ    7,,PR5
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:63   

      401     2914    2           DEV$ -> NI$DCT.FIPS = MPC$ -> NI$DCT.FIPS;

   2914  1 001537   200007 475500                    LDP5    DEV$,,AUTO
         1 001540   300007 236100                    LDQ     7,,PR3
         1 001541   500007 676100                    ERQ     7,,PR5
         1 001542   200000 376003                    ANQ     65536,DU
         1 001543   500007 656100                    ERSQ    7,,PR5

      402     2915        /**/
      403     2916    2           IT_PARTITION.DEVICE(N_DCTXMAX) = CMD$ -> IT$DTDEV.FLAGS.DOWN;

   2916  1 001544   000000 235000 xsym               LDA     N_DCTXMAX
         1 001545   001547 605000 1                  TPL     s:2916+3
         1 001546   000044 035003                    ADLA    36,DU
         1 001547   003005 060500                    CSL     bolr='003'O
         1 001550   100001 030001                    BDSC    1,,PR1                   by=0,bit=3,n=1
         1 001551   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1

      404     2917        /**/
      405     2918    2           DEV$ -> NI$DCT.SQH$ = SQH$;

   2918  1 001552   200005 236100                    LDQ     SQH$,,AUTO
         1 001553   200007 475500                    LDP5    DEV$,,AUTO
         1 001554   500022 756100                    STQ     18,,PR5

      406     2919    2           DEV$ -> NI$DCT.DQH$ = DCT_DQH$;

   2919  1 001555   200013 236100                    LDQ     DCT_DQH$,,AUTO
         1 001556   500023 756100                    STQ     19,,PR5

      407     2920        /*      DEV$ -> NI$DCT.SPSTAT = NO;                */
      408     2921        /**/
      409     2922    2           DEV$ -> NI$DCT.DP.BQ$ = ADDR(NIL);

   2922  1 001557   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001560   500030 756100                    STQ     24,,PR5
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:64   

      410     2923    2           DEV$ -> NI$DCT.DP.SETL$ = ADDR(NIL);

   2923  1 001561   500032 756100                    STQ     26,,PR5

      411     2924        /**/
      412     2925    2           RETURN;

   2925  1 001562   200032 221300                    LDX1  ! DUPCHANERR_TEXT+5,,AUTO
         1 001563   000001 702211                    TSX2  ! 1,X1

      413     2926    2   EXEC_DEV_ERR:
      414     2927    2           ALTRETURN;

   2927  1 001564   200032 221300       EXEC_DEV_ERR LDX1  ! DUPCHANERR_TEXT+5,,AUTO
         1 001565   000000 702211                    TSX2  ! 0,X1

(unnamed)
 Sect OctLoc
   0     000   115123 120070   060060 060040   115124 120070   062061 070040    MSP8000 MTP8218
   0     004   115124 120070   062062 066040   115124 120070   062062 070040    MTP8226 MTP8228
   0     010   115124 120070   062062 065040   115124 120070   062061 065040    MTP8225 MTP8215
   0     014   115124 120070   062061 066040   115123 123070   060070 060040    MTP8216 MSS8080
   0     020   115123 123070   060071 060040   115123 120070   060060 061040    MSS8090 MSP8001
   0     024   115123 120063   070070 065040   115123 120063   071071 061040    MSP3885 MSP3991
   0     030   115123 120063   071071 063040   115123 120063   071071 064040    MSP3993 MSP3994
   0     034   115123 120063   071071 062040   115123 120063   071071 060040    MSP3992 MSP3990
   0     040   115123 120063   070070 066040   115123 120060   066064 065040    MSP3886 MSP0645
   0     044   115123 120063   070070 062040   115123 120063   070070 061040    MSP3882 MSP3881
   0     050   115123 120060   066061 062040   115123 120060   066061 061040    MSP0612 MSP0611
   0     054   103110 101116   116105 114040                                    CHANNEL

(unnamed)
 Sect OctLoc
   2     000   707777 777777   000000 000022   000001 006000   000000 000147    ...............g
   2     004   000003 006000   000011 006000   777037 777777   000000 006000    ................
   2     010   000012 006000   000001 006000   000002 006000                    ............
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:65   
      415     2928    2   END;
      416     2929        /**/
      417     2930    1   END;

PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:66   
--  Include file information  --

   IT_IDATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   N_FC_C.:E05TOU  is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   NK_SUBS.:E05TOU  is referenced.
   FT$DDT.:E05TOU  cannot be made into a system file and is referenced.
   FT_SUBS.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   FR$RAT.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   IT$DTDEV.:E05TOU  cannot be made into a system file and is referenced.
   IT$MPC.:E05TOU  cannot be made into a system file and is referenced.
   IT$CMDWD.:E05TOU  cannot be made into a system file and is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
   IT_ERROR_C.:E05TOU  is referenced.
      No diagnostics issued in procedure ITD$DISKTAPE.
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:67   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PTR$                     33-0-0/w UBIN        r     1 CHX
     4-0-0/w PTR         r     1 CMD$                      13-0-0/w PTR         r     1 DCT_DQH$
    11-0-0/w PTR         r     1 DDT$                       7-0-0/w PTR         r     1 DEV$
     6-0-0/w PTR         r     1 DQH$                      25-0-0/c STRC(117)   r     1 DUPCHANERR_TEXT
    35-0-0/w BIT         r     1 FOUND_LA                  17-0-0/w SBIN        r     1 HI_CHAN
    22-0-0/w SBIN        r     1 I                         15-0-0/w SBIN        r     1 IOM#
    23-0-0/w SBIN        r     1 J                         14-0-0/w SBIN        r     1 LA#
    20-0-0/w SBIN        r     1 LA_IOM#                   16-0-0/w SBIN        r     1 LO_CHAN
    12-0-0/w PTR         r     1 MPC$                      24-0-0/w EPTR        r     1 POSTER
    *0-0-0/w PTR         r     1 PTR$                      10-0-0/w PTR         r     1 RAT$
    34-0-0/w PTR         r     1 SCHAN$                     5-0-0/w PTR         r     1 SQH$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS5$                     0-0-0/w PTR         r     1 B$REAL$
     0-0-0/w PTR         r     1 FR$HD$(0:3)                0-0-0/b BIT         r     1 FR_DPDFLT
     0-0-0/b BIT         r     1 FR_MTDFLT
     0-0-0/w PTR         r     1 FR_PRM$(0:0)
     0-0-0/w BIT         r     1 HW_IMX                     0-0-0/w BIT         r     1 HW_IOP
     0-0-0/w PTR         r     1 IT_FEI$$                   0-0-0/w STRC(1800)  r     1 IT_PARTITION
     0-0-0/w PTR         r     1 KI_FEI$$                   0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w PTR         r     1 N$FQ$                      0-0-0/w PTR         r     1 NI$CHT$
     0-0-0/w STRC(648)   r     1 NI$DQH_C                   0-0-0/w PTR         r     1 NI$DVT$(0:49)
     0-0-0/w PTR         r     1 NI$FQ$                     0-0-0/w PTR         r     1 NI$IBUF$
     0-0-0/w PTR         r     1 NI$IOM$(0:3)
     0-0-0/w PTR         r     1 NI$RP$                     0-0-0/w SBIN        r     1 N_DCTXMAX
     0-0-0/w SBIN        r     1 N_NDPS                     0-0-0/w PTR         r     1 P_RESOURCE$
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:68   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 FR$PR(0:0)                 0-0-0/w STRC(324)   r     1 FR$RAT
     0-0-0/w STRC(288)   r     1 FT$DDT                     0-0-0/w UBIN        r     1 IT$CMDWD
     0-0-0/w STRC(261)   r     1 IT$DTDEV                   0-0-0/w STRC(594)   r     1 IT$MPC
     0-0-0/w PTR         r     1 IT$PTR
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/w STRC(72)    r     1 NI$CHT(0:127)              0-0-0/w STRC(1332)  r     1 NI$DCT
     0-0-0/w STRC(648)   r     1 NI$DQH                     0-0-0/w STRC(2844)  r     1 NI$DVT
     0-0-0/w STRC(144)   r     1 NI$FQ                      0-0-0/w STRC(252)   r     1 NI$IOM
     0-0-0/d STRC(576)   r     1 NI$IOSTAT                  0-0-0/d STRC(144)   r     1 NI$MBX(0:63)
     0-0-0/w STRC(252)   r     1 NI$SQH                     0-0-0/w STRC(252)   r     1 P$IODATA


   Procedure ITD$DISKTAPE requires 886 words for executable code.
   Procedure ITD$DISKTAPE requires 34 words of local(AUTO) storage.

    No errors detected in file ITD$DISKTAP.:E05TSI    .
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:69   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:70   
          MINI XREF LISTING

B$DS5$
      1570**DCL      2632>>ASSIGN   2718>>IF       2815>>IF       2832>>IF       2863>>IF       2899>>IF
B$REAL$
      1569**DCL      2754>>ASSIGN
CHX IN PROCEDURE EXEC_MPC
      2677**DCL      2681<<ASSIGN   2787>>IF       2789>>ASSIGN   2790<<ASSIGN   2790>>ASSIGN
CMD$
      1542**DCL      2632<<ASSIGN   2633>>IF       2635<<ASSIGN   2635>>ASSIGN   2642>>DOWHILE  2644>>DOCASE
      2651<<ASSIGN   2651>>ASSIGN   2651>>ASSIGN   2693>>ASSIGN   2694>>ASSIGN   2696>>ASSIGN   2697>>ASSIGN
      2722>>ASSIGN   2723>>ASSIGN   2730>>IF       2731>>ASSIGN   2732>>ASSIGN   2733>>ASSIGN   2760>>ASSIGN
      2761>>IF       2819>>ASSIGN   2823>>ASSIGN   2827>>IF       2828>>ASSIGN   2830>>ASSIGN   2878>>ASSIGN
      2881>>ASSIGN   2898>>ASSIGN   2903>>ASSIGN   2904>>ASSIGN   2905>>ASSIGN   2906>>ASSIGN   2907>>ASSIGN
      2908>>ASSIGN   2909>>ASSIGN   2910>>ASSIGN   2911>>ASSIGN   2916>>ASSIGN
DCT_DQH$
      1549**DCL      2726<<ASSIGN   2763<<ASSIGN   2794>>ASSIGN   2878<<ASSIGN   2882>>ASSIGN   2919>>ASSIGN
DDT$
      1547**DCL      2840<<ASSIGN   2853<<ASSIGN   2856>>ASSIGN   2858>>ASSIGN   2859>>ASSIGN   2860>>ASSIGN
      2862>>ASSIGN   2866<<ASSIGN   2879<<ASSIGN   2886>>IF       2887<<ASSIGN   2887>>ASSIGN   2888>>DOWHILE
      2889<<ASSIGN   2889>>ASSIGN   2891>>ASSIGN   2895>>ASSIGN
DEV$
      1545**DCL      2684<>CALL     2688>>ASSIGN   2690>>ASSIGN   2692>>ASSIGN   2693>>ASSIGN   2694>>ASSIGN
      2695>>ASSIGN   2695>>ASSIGN   2696>>ASSIGN   2697>>ASSIGN   2698>>ASSIGN   2699>>ASSIGN   2700>>ASSIGN
      2701>>ASSIGN   2702>>ASSIGN   2703>>DOSELCT  2703>>DOSELCT  2705>>ASSIGN   2709>>ASSIGN   2710>>ASSIGN
      2711>>ASSIGN   2713>>ASSIGN   2714>>ASSIGN   2715>>ASSIGN   2717>>ASSIGN   2719>>ASSIGN   2721>>ASSIGN
      2722>>ASSIGN   2741>>ASSIGN   2789>>ASSIGN   2794>>ASSIGN   2813<>CALL     2819>>ASSIGN   2822>>ASSIGN
      2834>>ASSIGN   2850>>ASSIGN   2851>>ASSIGN   2852>>ASSIGN   2862>>ASSIGN   2880>>ASSIGN   2881>>ASSIGN
      2882>>ASSIGN   2898>>ASSIGN   2900>>ASSIGN   2902>>ASSIGN   2902>>ASSIGN   2903>>ASSIGN   2904>>ASSIGN
      2905>>ASSIGN   2906>>ASSIGN   2907>>ASSIGN   2908>>ASSIGN   2909>>ASSIGN   2910>>ASSIGN   2911>>ASSIGN
      2912>>ASSIGN   2913>>ASSIGN   2914>>ASSIGN   2918>>ASSIGN   2919>>ASSIGN   2922>>ASSIGN   2923>>ASSIGN
DQH$
      1544**DCL      2736<<ASSIGN   2738>>ASSIGN   2741>>ASSIGN   2742>>ASSIGN   2743>>ASSIGN   2749>>ASSIGN
      2751>>ASSIGN   2753>>ASSIGN   2754>>ASSIGN   2754>>ASSIGN   2763>>ASSIGN   2767>>ASSIGN   2768>>ASSIGN
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:71   
      2768>>ASSIGN   2771>>ASSIGN   2773>>ASSIGN   2774>>ASSIGN   2775>>IF       2784>>ASSIGN   2784>>ASSIGN
      2785>>ASSIGN   2789>>ASSIGN
DUPCHANERR_TEXT
      1562**DCL      2776--ASSIGN   2781--CALL
DUPCHANERR_TEXT.CHANNEL
      1564**DCL      2777<<ASSIGN
DUPCHANERR_TEXT.CHANTEXT
      1567**DCL      2780<<CALLBLT
DUPCHANERR_TEXT.COUNT
      1563**DCL      2776<<ASSIGN
DUPCHANERR_TEXT.DASH
      1566**DCL      2779<<ASSIGN
DUPCHANERR_TEXT.IOMTEXT
      1565**DCL      2778<<CALLBLT
EXEC_DEV
      2810**PROC     2648--CALL
EXEC_DEV_ERR IN PROCEDURE EXEC_DEV
      2927**LABEL    2813--CALLALT  2821--CALLALT  2837--CALLALT  2854--CALLALT
EXEC_MPC
      2676**PROC     2646--CALL
EXEC_MPC_ERR IN PROCEDURE EXEC_MPC
      2799**LABEL    2684--CALLALT  2737--CALLALT  2788--GOTO
FOUND_LA IN PROCEDURE EXEC_MPC
      2679**DCL      2727<<ASSIGN   2761>>IF       2764<<ASSIGN   2795>>IF
FR$HD$
      1741**DCL      2840--ASSIGN   2866--ASSIGN   2879--ASSIGN
FR$PR
      1747**DCL      2833<<ASSIGN   2833>>ASSIGN   2865<<ASSIGN   2865>>ASSIGN   2877<<ASSIGN   2877>>ASSIGN
FR$RAT.LNK$
       948**DCL      2888>>DOWHILE  2889>>ASSIGN   2891<<ASSIGN
FR$RAT.M1
       969**DCL      2828<<ASSIGN   2830<<ASSIGN   2846>>ASSIGN   2873>>ASSIGN   2876<<ASSIGN
FR$RAT.RCOD
       960**DCL      2839<<ASSIGN   2864<<ASSIGN
FR$RAT.TYP
       971**DCL      2823<<ASSIGN
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:72   
FR_DPDFLT
      1760**DCL      2845>>IF       2846<<ASSIGN
FR_MTDFLT
      1759**DCL      2872>>IF       2873<<ASSIGN
FR_PRM$
      1748**DCL      2833>>ASSIGN   2833>>ASSIGN   2865>>ASSIGN   2865>>ASSIGN   2877>>ASSIGN   2877>>ASSIGN
FT$DDT
      1141**DCL      2854--CALL     2856<<ASSIGN
FT$DDT.ACCT
      1142**DCL      2858<<ASSIGN
FT$DDT.EXPIRE
      1150**DCL      2860<<ASSIGN
FT$DDT.SN
      1146**DCL      2859<<ASSIGN
HI_CHAN
      1554**DCL      2733<<ASSIGN   2734>>ASSIGN
HW_IMX
      1806**DCL      2744>>IF
HW_IOP
      1803**DCL      2752>>IF
I
      1557**DCL      2734<<ASSIGN   2735>>DOINDEX
IOM#
      1552**DCL      2731<<ASSIGN   2749>>ASSIGN   2760>>ASSIGN   2773>>ASSIGN   2778>>CALLBLT
IT$CMDWD
       385**DCL      2633>>IF       2635--ASSIGN   2718>>IF       2815>>IF       2832>>IF       2863>>IF
      2899>>IF
IT$DTDEV.ATTR
       452**DCL      2827>>IF       2828>>ASSIGN
IT$DTDEV.CHAIN
       454**DCL      2881--ASSIGN
IT$DTDEV.CNTWD.OFFSET
       431**DCL      2651>>ASSIGN
IT$DTDEV.CNTWD.TYPE
       432**DCL      2642>>DOWHILE  2644>>DOCASE
IT$DTDEV.DEV#
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:73   
       443**DCL      2905>>ASSIGN
IT$DTDEV.FLAGS.CHECKWRITE
       441**DCL      2911>>ASSIGN
IT$DTDEV.FLAGS.CM
       436**DCL      2908>>ASSIGN
IT$DTDEV.FLAGS.DOWN
       437**DCL      2916>>ASSIGN
IT$DTDEV.FLAGS.INPUT
       434**DCL      2906>>ASSIGN
IT$DTDEV.FLAGS.OUTPUT
       435**DCL      2907>>ASSIGN
IT$DTDEV.FLAGS.PSIA
       439**DCL      2910>>ASSIGN
IT$DTDEV.FLAGS.SYMBIONT
       438**DCL      2909>>ASSIGN
IT$DTDEV.FX
       451**DCL      2903>>ASSIGN
IT$DTDEV.MODX
       450**DCL      2904>>ASSIGN
IT$DTDEV.NAME
       444**DCL       445--REDEF    2819>>ASSIGN
IT$DTDEV.NM.MNEM
       446**DCL      2823>>ASSIGN
IT$DTDEV.TYPE
       449**DCL      2830>>ASSIGN   2898>>ASSIGN
IT$DTDEV.VFC
       453**DCL      2878>>ASSIGN
IT$MPC.FLAGS.DOWN
       411**DCL      2723>>ASSIGN
IT$MPC.FWNAME
       407**DCL      2722>>ASSIGN
IT$MPC.FX
       401**DCL      2696>>ASSIGN
IT$MPC.LA_IOM.DOWN
       415**DCL      2760>>ASSIGN   2761>>IF
IT$MPC.LA_IOM.HI_CHAN
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:74   
       419**DCL      2733>>ASSIGN
IT$MPC.LA_IOM.IOM#
       417**DCL      2731>>ASSIGN
IT$MPC.LA_IOM.LO_CHAN
       418**DCL      2732>>ASSIGN
IT$MPC.LA_IOM.PRESENCE
       414**DCL      2730>>IF
IT$MPC.MODX
       400**DCL      2697>>ASSIGN
IT$MPC.MPCNAME
       402**DCL       403--REDEF    2693>>ASSIGN
IT$MPC.MPCTYPE
       399**DCL      2694>>ASSIGN
IT$PTR
      2619**DCL      2881>>ASSIGN   2886>>IF       2887>>ASSIGN   2895<<ASSIGN
ITD$DISKTAPE_ERR
      2655**LABEL    2637--CALLALT  2646--CALLALT  2648--CALLALT
ITE$ERROR
      1532**DCL-ENT  2781--CALL
ITH$ALLOCATE
      1535**DCL-ENT  2737--CALL     2837--CALL     2854--CALL
ITH$DCT_INIT
      1538**DCL-ENT  2684--CALL     2813--CALL
ITH$RAT_INIT
      1537**DCL-ENT  2821--CALL
ITH$SQH_INIT
      1536**DCL-ENT  2637--CALL
IT_FEI$$
      1572**DCL      2882>>ASSIGN
IT_PARTITION.DEVICE
      1579**DCL      2723<<ASSIGN   2796<<ASSIGN   2916<<ASSIGN
IT_PARTITION.IOCHAN
      1579**DCL      2760<<ASSIGN
J
      1558**DCL      2735<<DOINDEX  2749>>ASSIGN   2760>>ASSIGN   2766>>IF       2774>>ASSIGN   2780>>CALLBLT
KI$FEI$
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:75   
      2359**DCL      2882>>ASSIGN
KI_FEI$$
      2358**DCL      2359--IMP-PTR
LA#
      1551**DCL      2639<<ASSIGN
LA_IOM#
      1555**DCL      2729<<DOINDEX  2730>>IF       2731>>ASSIGN   2732>>ASSIGN   2733>>ASSIGN   2743>>ASSIGN
      2760>>ASSIGN   2761>>IF
LO_CHAN
      1553**DCL      2732<<ASSIGN   2734>>ASSIGN   2749>>ASSIGN   2760>>ASSIGN   2774>>ASSIGN   2780>>CALLBLT
MPC$
      1548**DCL      2717<<ASSIGN   2880<<ASSIGN   2912>>ASSIGN   2913>>ASSIGN   2914>>ASSIGN
N$DCT$$
       753**DCL       887--IMP-PTR
N$FQ$
       753**DCL       888--IMP-PTR
N$REQ_INIT.BUFADDR
       772**DCL       773--REDEF     773--REDEF
N$REQ_INIT.DLA.DRELADDR
       764**DCL       764--REDEF
N$REQ_INIT.DVE.EOMCHAR
       801**DCL       802--REDEF
N$REQ_INIT.EAINFO
       795**DCL       795--REDEF
N$REQ_INIT.EAINFOX
       795**DCL       796--REDEF
N$REQ_INIT.EVNTINFO
       796**DCL       796--REDEF
N$REQ_INIT.STATUS
       777**DCL       783--REDEF
NI$CHT.DQH$
      2577**DCL      2775>>IF       2784<<ASSIGN   2878>>ASSIGN
NI$CHT.POSTER
      2577**DCL      2785<<ASSIGN
NI$CHT$
       812**DCL      2577--IMP-PTR  2775>>IF       2784>>ASSIGN   2785>>ASSIGN   2878>>ASSIGN
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:76   
NI$DCT.CTYP
      2509**DCL      2705<<ASSIGN   2709<<ASSIGN   2713<<ASSIGN   2912<<ASSIGN   2912>>ASSIGN
NI$DCT.DDT$
      2502**DCL      2862<<ASSIGN
NI$DCT.DEV0LGL
      2508**DCL      2710<<ASSIGN   2714<<ASSIGN   2913<<ASSIGN   2913>>ASSIGN
NI$DCT.DEVNM
      2501**DCL      2693<<ASSIGN   2819<<ASSIGN
NI$DCT.DFLG.CHECKWRITE
      2507**DCL      2911<<ASSIGN
NI$DCT.DFLG.CM
      2504**DCL      2908<<ASSIGN
NI$DCT.DFLG.INPUT
      2503**DCL      2700<<ASSIGN   2906<<ASSIGN
NI$DCT.DFLG.OUTPUT
      2504**DCL      2701<<ASSIGN   2907<<ASSIGN
NI$DCT.DFLG.PSIA
      2505**DCL      2702<<ASSIGN   2910<<ASSIGN
NI$DCT.DFLG.SYMBIONT
      2505**DCL      2909<<ASSIGN
NI$DCT.DP
      2521**DCL      2528--REDEF    2531--REDEF    2532--REDEF    2534--REDEF    2534--REDEF    2535--REDEF
      2536--REDEF    2536--REDEF
NI$DCT.DP.BQ$
      2521**DCL      2922<<ASSIGN
NI$DCT.DP.SETL$
      2522**DCL      2923<<ASSIGN
NI$DCT.DQH$
      2517**DCL      2699<<ASSIGN   2794<<ASSIGN   2919<<ASSIGN
NI$DCT.DVN
      2510**DCL      2905<<ASSIGN
NI$DCT.DVT$
      2517**DCL      2694<<ASSIGN   2695>>ASSIGN   2703>>DOSELCT  2898<<ASSIGN   2902>>ASSIGN
NI$DCT.FIPS
      2509**DCL      2711<<ASSIGN   2715<<ASSIGN   2914<<ASSIGN   2914>>ASSIGN
NI$DCT.FX
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:77   
      2510**DCL      2696<<ASSIGN   2903<<ASSIGN
NI$DCT.MODX
      2510**DCL      2697<<ASSIGN   2703>>DOSELCT  2904<<ASSIGN
NI$DCT.MPC.FW$
      2529**DCL      2692<<ASSIGN
NI$DCT.MPC.FWNAME
      2531**DCL      2722<<ASSIGN
NI$DCT.MPC.IOCHANX
      2529**DCL      2529--REDEF    2789<<ASSIGN
NI$DCT.MPC.TYPE
      2529**DCL      2719<<ASSIGN   2721<<ASSIGN
NI$DCT.MT.CURDENS
      2533**DCL      2852<<ASSIGN
NI$DCT.MT.FREPOS$
      2532**DCL      2850<<ASSIGN
NI$DCT.MT.SETDENS$
      2533**DCL      2851<<ASSIGN
NI$DCT.OD.FEI$
      2537**DCL      2882<<ASSIGN
NI$DCT.OD.OPCI$
      2536**DCL      2881<<ASSIGN
NI$DCT.PMD$
      2537**DCL      2834<<ASSIGN
NI$DCT.RAT$
      2502**DCL      2822<<ASSIGN
NI$DCT.SQH$
      2516**DCL      2698<<ASSIGN   2918<<ASSIGN
NI$DCT.TYPE
      2511**DCL      2695<<ASSIGN   2900<<ASSIGN   2902<<ASSIGN
NI$DCT_C.DP
      2420**DCL      2427--REDEF    2430--REDEF    2431--REDEF    2433--REDEF    2433--REDEF    2434--REDEF
      2435--REDEF    2435--REDEF
NI$DCT_C.MPC.IOCHANX
      2428**DCL      2428--REDEF
NI$DQH
      2549**DCL      2737--CALL     2738<<ASSIGN   2768--ASSIGN
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:78   
NI$DQH.FEX
      2552**DCL      2882>>ASSIGN
NI$DQH.IOCHAN.CHANNEL
      2552**DCL      2774<<ASSIGN
NI$DQH.IOCHAN.IOM
      2552**DCL      2773<<ASSIGN
NI$DQH.IOCHANX
      2551**DCL      2552--REDEF    2775>>IF       2784>>ASSIGN   2785>>ASSIGN   2789>>ASSIGN
NI$DQH.IOSTATUS$
      2556**DCL      2751<<ASSIGN   2753>>ASSIGN   2754>>ASSIGN   2754>>ASSIGN
NI$DQH.LA
      2559**DCL      2743<<ASSIGN
NI$DQH.MBX$
      2560**DCL      2561--REDEF    2749<<ASSIGN
NI$DQH.MPC$
      2556**DCL      2741<<ASSIGN
NI$DQH.SCHAN$
      2555**DCL      2768<<ASSIGN   2771<<ASSIGN
NI$DQH.SQH$
      2555**DCL      2742<<ASSIGN
NI$DQH_C
      2448**DCL      2738>>ASSIGN
NI$DQH_C.IOCHANX
      2450**DCL      2451--REDEF
NI$DQH_C.MBX$
      2459**DCL      2460--REDEF
NI$DVT.ATTR
      2582**DCL      2830>>ASSIGN
NI$DVT.MODEL
      2580**DCL      2703>>DOSELCT
NI$DVT.MPC
      2582**DCL      2583--REDEF
NI$DVT.TYPE
      2580**DCL      2695>>ASSIGN   2902>>ASSIGN
NI$DVT$
       812**DCL      2694>>ASSIGN   2830>>ASSIGN   2898>>ASSIGN
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:79   
NI$FQ.HD$
       889**DCL      2751>>ASSIGN   2758<<ASSIGN   2758>>ASSIGN
NI$FQ$
       813**DCL       889--IMP-PTR  2751>>ASSIGN   2758>>ASSIGN   2758>>ASSIGN
NI$IBUF$
       813**DCL       889--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
       823**DCL       824--REDEF     824--REDEF
NI$IMXMBX_INIT.SIZE
       825**DCL       825--REDEF
NI$IOM.MBX$
      2596**DCL      2749>>ASSIGN
NI$IOM$
       835**DCL      2749>>ASSIGN
NI$IOSTAT
      2587**DCL      2758--ASSIGN
NI$IOSTAT.AESDCW
      2592**DCL      2592--REDEF    2753<<ASSIGN
NI$IOSTAT.AESDCW.ADDRESS
      2592**DCL      2754<<ASSIGN
NI$IOSTAT.EXTST
      2593**DCL      2754--ASSIGN
NI$IOSTAT_C.AESDCW
      2486**DCL      2486--REDEF
NI$MBX
      2611**DCL      2749--ASSIGN
NI$MBX.DCW.CONTROL.AE
      2616**DCL      2616--REDEF
NI$MBX.LPW.CONTROL.AE
      2612**DCL      2612--REDEF
NI$REQ_INIT.DCW
       847**DCL       850--REDEF
NI$REQ_INIT.DCW.TALLY
       848**DCL       848--REDEF
NI$REQ_INIT.IDCW.EXTA
       850**DCL       850--REDEF
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:80   
NI$REQ_INIT.PCW
       852**DCL       856--REDEF
NI$REQ_INIT.SEEK
       857**DCL       858--REDEF     859--REDEF
NI$RP$
       861**DCL       891--IMP-PTR
NI$SQH.DOOR
      2572**DCL      2572--REDEF
NI$SQH.MPC$
      2574**DCL      2687>>IF       2688<<ASSIGN   2690<<ASSIGN
NI$SQH.NDCT
      2573**DCL      2686<<ASSIGN   2686>>ASSIGN   2817<<ASSIGN   2817>>ASSIGN
NI$SQH_C.DOOR
      2471**DCL      2471--REDEF
NID$POSTER
      1533**DCL-ENT  2633--ASSIGN
NIT$POSTER
      1534**DCL-ENT  2634--ASSIGN
NI_MBX_INIT.DCW.CONTROL.AE
       883**DCL       883--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
       879**DCL       879--REDEF
N_DCTXMAX
       861**DCL      2723>>ASSIGN   2796>>ASSIGN   2916>>ASSIGN
N_NDPS
       861**DCL      2815<<ASSIGN   2815>>ASSIGN
P$IODATA
      1461**DCL      2835<<ASSIGN   2837--CALL
POSTER
      1560**DCL      2633<<ASSIGN   2634<<ASSIGN   2785>>ASSIGN
PTR$
        25**DCL        23--PROC     2637<>CALL     2684<>CALL     2699>>ASSIGN   2726>>ASSIGN   2736>>ASSIGN
      2737<>CALL     2813<>CALL     2821<>CALL     2834>>ASSIGN   2835>>ASSIGN   2837<>CALL     2853>>ASSIGN
      2854<>CALL
P_NSCPU
      1507**DCL      1508--REDEF
PL6.E3A0      #001=ITD$DISKTAPE File=ITD$DISKTAP.:E05TSI                         TUE 07/29/97 23:01 Page:81   
P_RESOURCE.RES
      1380**DCL      1447--REDEF
P_RESOURCE$
      1460**DCL      1348--IMP-PTR
P_UPTIME
      1496**DCL      1497--REDEF
RAT$
      1546**DCL      2821<>CALL     2822>>ASSIGN   2823>>ASSIGN   2828>>ASSIGN   2830>>ASSIGN   2839>>ASSIGN
      2846>>ASSIGN   2864>>ASSIGN   2873>>ASSIGN   2876>>ASSIGN   2891>>ASSIGN   2895>>ASSIGN
SCHAN$ IN PROCEDURE EXEC_MPC
      2678**DCL      2767<<ASSIGN   2771>>ASSIGN
SQH$
      1543**DCL      2637<>CALL     2686>>ASSIGN   2686>>ASSIGN   2687>>IF       2688>>ASSIGN   2690>>ASSIGN
      2698>>ASSIGN   2742>>ASSIGN   2817>>ASSIGN   2817>>ASSIGN   2918>>ASSIGN
