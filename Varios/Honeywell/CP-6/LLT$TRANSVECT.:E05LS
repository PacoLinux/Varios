VERSION E05

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:1    
        1        1        /*M* LLT$TRANSVECT - Process transfer vector for the shared library */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,ENI=4,
        8        8             CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC*/
        9        9        /*F* NAME:       LLT$TRANSVECT
       10       10             PURPOSE:    LLT$TRANSVECT primary function is to process transfer
       11       11                         vecter option for building the shared library.
       12       12                         The VECTOR suboptions are RF, ENTRIES, DATA, REMOVE_E
       13       13                         NTDEFS, REMOVE_SYMDEFS.
       14       14                         RF suboption specifies that transfer vector found in
       15       15                         the file should be used.
       16       16                         DATA suboption specifies the maximun number of words
       17       17                         of static data the linker is to allocate.
       18       18                         REMOVE_ENTDEF and REMOVE_SYMDEF specifies that the
       19       19                         linker remove all ENTDEFS not in the transfer vector
       20       20                         and all SYMDEFS respectively.
       21       21                         ENTRIES option may take one or more argumemts as
       22       22                         follows:
       23       23                           1. an ENTDEF name,
       24       24                           2. a range of ENTDEF names,
       25       25                           3. EMPTY specifies the number of empty slots to
       26       26                              reserve in the transfer vector.
       27       27                                                                             */
       28       28        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:2    
       29       29        LLT$TRANSVECT:PROC ;
       30       30        %INCLUDE CP_6;
       31     5589        %INCLUDE B$OBJECT_C;
       32     9019        %INCLUDE LL_DATA_R;
       33     9055        %INCLUDE LL_SUBS_C;
       34     9184        %INCLUDE LL_MACS_C;
       35     9538        %INCLUDE B_ERRORS_C;
       36    10665         /* Entries */
       37    10666    1   DCL LLM$MON_SVC ENTRY(4) ALTRET;
       38    10667    1   DCL LLG$GROW ENTRY(7);
       39    10668    1   DCL LLI$BINHEX ENTRY(3);
       40    10669    1   DCL LLW$WRTDEF ENTRY(4);
       41    10670         /* Monitor services */
       42    10671        %FPT_GDS(FPTN = FPT_GDS,
       43    10672         STCLASS = CONSTANT,
       44    10673         SEGSIZE = 1024,
       45    10674         RESULTS = LL_DNAME_VEC);
       46    10690        %FPT_OPEN(FPTN = OPEN_TV,
       47    10691         ACS = DIRECT,
       48    10692         ASN = FILE,
       49    10693         DCB = M$TV,
       50    10694         FUN = CREATE,
       51    10695         NAME = TV_STAR,
       52    10696         ORG = KEYED);
       53    10805        %FPT_CLOSE ( FPTN = CLOSE_TV,
       54    10806         DCB = M$TV,
       55    10807         DISP = SAVE);
       56    10849        %FPT_WRITE(FPTN= WRITE_TV,
       57    10850         DCB = M$TV);
       58    10881
       59    10882        %FPT_FID (FPTN = RUN_FILE,
       60    10883         TEXTFID = LL_VECTOR_RF,
       61    10884         SN = VLP_SN,
       62    10885         WSN = VLP_WSN,
       63    10886         RES = OPEN_RF.V.RES#,
       64    10887         ASN = OPEN_RF.V.ASN#,
       65    10888         ACCT = VLP_ACCT,
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:3    
       66    10889         NAME = VLP_NAME,
       67    10890         PASS = VLP_PASS);
       68    10913
       69    10914        %FPT_OPEN (FPTN = OPEN_RF,
       70    10915         DCB = M$RF,
       71    10916         WSN = VLP_WSN,
       72    10917         SN = VLP_SN,
       73    10918         ORG = KEYED,
       74    10919         PASS = VLP_PASS,
       75    10920         NAME = VLP_NAME,
       76    10921         ACCT = VLP_ACCT,
       77    10922         ASN = FILE,
       78    10923         SCRUB = YES);
       79    11032
       80    11033        %FPT_READ ( FPTN = READ_RF_HEAD,
       81    11034         DCB = M$RF,
       82    11035         KEY = RF_HEAD_KEY,
       83    11036         KEYS = YES,
       84    11037         KEYR = YES);
       85    11076
       86    11077        %FPT_READ (FPTN = READ_RF,
       87    11078         DCB = M$RF,
       88    11079         KEY = NIL,
       89    11080         KEYS = YES,
       90    11081         KEYR = NO,
       91    11082         BUF = NIL,
       92    11083         WAIT = YES);
       93    11122
       94    11123        %FPT_CLOSE (FPTN = CLOSE_RF,
       95    11124         DCB = M$RF);
       96    11166
       97    11167        %VLP_ACCT;
       98    11180        %VLP_PASS;
       99    11193        %VLP_WSN;
      100    11206        %VLP_SN;
      101    11219        %VLP_NAME;
      102    11246        %VLP_NAME ( FPTN= TV_STAR,
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:4    
      103    11247         NAME = '*TV');
      104    11274
      105    11275         /* DCB */
      106    11276    1   DCL M$TV DCB;
      107    11277    1   DCL M$RF DCB;
      108    11278    1   DCL M$RU DCB;
      109    11279
      110    11280         /* MACROs */
      111    11281        %F$DCB (DCBN = B$DCB,
      112    11282         STCLASS = BASED);
      113    11339        %B$RECORDSUBS;
      114    11367        %B$SECTIONSUBS;
      115    11382        %SUB_LINKFLAGS;
      116    11391         /*%EQU PGSZ = 2048;*/
      117    11392        %B$DNAME ( NAME = TRANS_VEC_NAME,
      118    11393         STCLASS = CONSTANT,
      119    11394         TEXT = '<Transfer_vector>' );
      120    11413
      121    11414        %B$DNAME ( NAME = TV_START_NAME,
      122    11415         STCLASS = CONSTANT,
      123    11416         TEXT = '_TV_ST');
      124    11435
      125    11436        %B$DNAME ( NAME = TV_END_NAME,
      126    11437         STCLASS = CONSTANT,
      127    11438         TEXT = '_TV_EN');
      128    11457
      129    11458         %B$OUHEAD ( STCLASS = BASED);
      130    11576
      131    11577        %B$PRGRELKEY(NAME = ENTREF_RELOC_KEY,
      132    11578         STCLASS = STATIC);
      133    11609
      134    11610        %B$PRGRELKEY(NAME = REPEAT_TV_RELOC_KEY,
      135    11611         STCLASS = STATIC);
      136    11642
      137    11643        %B$RELOC2 ( NAME = BRK_SLOT,
      138    11644         STCLASS = STATIC);
      139    11711
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:5    
      140    11712        %B$RELOC2 ( NAME = ENTREF_RELOC,
      141    11713         STCLASS = STATIC);
      142    11780
      143    11781        %B$RELOC2 ;
      144    11848
      145    11849        %B$RELOC2 ( NAME = REPEAT_TV_RELOC,
      146    11850         STCLASS = STATIC);
      147    11917
      148    11918        %B$RUHEADKEY(NAME = RF_HEAD_KEY,
      149    11919         STCLASS = STATIC);
      150    11926
      151    11927        %B$HEAD (NAME = RF_HEAD,
      152    11928         STCLASS = STATIC,
      153    11929         SUBS = NO);
      154    12129
      155    12130        %B$FEP_RUKEY(NAME = B$RUKEY,
      156    12131         STCLASS = STATIC );
      157    12155        %B$DNAME;
      158    12174        %B$SDEF;
      159    12228        %B$EDEF;
      160    12298        %B$HEAD (NAME = LL_HEAD,
      161    12299         STCLASS = SYMREF);
      162    12499        %LL$NODE (NAME=TREE);
      163    12531        %LL$SECT_ENTRY (NAME=SECT_ENTRY);
      164    12564        %LL$OU_ENTRY (NAME=OU_ENTRY,
      165    12565         STCLASS = BASED);
      166    12613        %B$SECTION (NAME=LL_SECTION);
      167    12672    1   DCL 1 TV_DEF_NAMES CONSTANT ALIGNED,
      168    12673    1         2 TV_START_NAME,
      169    12674    1           3 * UBIN HALF UNAL INIT(6),
      170    12675    1           3 * CHAR(6) INIT ('_TV_ST'),
      171    12676    1         2 TV_END_NAME,
      172    12677    1           3 * UBIN HALF UNAL INIT(6),
      173    12678    1           3 * CHAR(6) INIT ('_TV_EN'),
      174    12679    1         2 T_VECTOR,
      175    12680    1           3 * UBIN HALF UNAL INIT(17),
      176    12681    1           3 * CHAR(18) INIT ('<Transfer vector>');
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:6    
      177    12682
      178    12683    1   DCL 1 TV_EDEF STATIC ALIGNED,
      179    12684    1         2 TV_START,
      180    12685    1           3 LFLAGS UBIN BYTE UNAL INIT(0),
      181    12686    1           3 OU UNAL,
      182    12687    1             4 SECTNUM UBIN BYTE UNAL INIT(0),
      183    12688    1             4 OFFSET UBIN HALF UNAL INIT(0),
      184    12689    1           3 ISADDR REDEF OU UBIN(27) UNAL,
      185    12690    1           3 NPOINTER UBIN HALF UNAL INIT(0),
      186    12691    1           3 PRI BIT(1) UNAL INIT('1'B),
      187    12692    1           3 ALT BIT(1) UNAL INIT('0'B),
      188    12693    1           3 CHECK BIT(1) UNAL INIT('0'B),
      189    12694    1           3 CST UBIN(4) UNAL INIT(15),
      190    12695    1           3 NPARAM UBIN(11) UNAL INIT(0),
      191    12696    1         2 TV_END,
      192    12697    1           3 LFLAGS UBIN BYTE UNAL INIT(0),
      193    12698    1           3 OU UNAL,
      194    12699    1             4 SECTNUM UBIN BYTE UNAL INIT(0),
      195    12700    1             4 OFFSET UBIN HALF UNAL INIT(0),
      196    12701    1           3 ISADDR REDEF OU UBIN(27) UNAL,
      197    12702    1           3 NPOINTER UBIN HALF UNAL INIT(2),
      198    12703    1           3 PRI BIT(1) UNAL INIT('0'B),
      199    12704    1           3 ALT BIT(1) UNAL INIT('0'B),
      200    12705    1           3 CHECK BIT(1) UNAL INIT('0'B),
      201    12706    1           3 CST UBIN(4) UNAL INIT(15),
      202    12707    1           3 NPARAM UBIN(11) UNAL INIT(0);
      203    12708
      204    12709    1   DCL 1 TV_SECTION STATIC ALIGNED,
      205    12710    1         2 TYPE UBIN BYTE UNAL INIT(1),
      206    12711    1         2 * BIT(1) INIT('0'B),
      207    12712    1         2 INITZ BIT(1) UNAL INIT('0'B),
      208    12713    1         2 INITUTS BIT(1) UNAL INIT('0'B),
      209    12714    1         2 SEGMENT BIT(1) INIT('0'B),
      210    12715    1         2 * BIT(3) INIT('0'B),
      211    12716    1         2 BOUND UBIN(2) UNAL INIT(0),
      212    12717    1         2 SIZE UBIN HALF UNAL INIT(0),
      213    12718    1         2 NPOINTER SBIN HALF UNAL INIT(4),
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:7    
      214    12719    1         2 * UBIN HALF UNAL INIT(0);
      215    12720
      216    12721    1   DCL 1 TV_HEAD STATIC ALIGNED,
      217    12722    1         2 UTS UBIN(36) UNAL INIT(0),
      218    12723    1         2 WORDSIZE UBIN BYTE UNAL INIT(16),
      219    12724    1         2 COMPID UBIN(27) UNAL INIT(0),
      220    12725    1         2 START,
      221    12726    1           3 OPNDTYP UBIN(4) UNAL INIT(0),
      222    12727    1           3 * BIT (5) UNAL INIT('0'B),
      223    12728    1           3 OPERAND UBIN(9) UNAL INIT(0),
      224    12729    1           3 OFFSET UBIN(18) UNAL INIT(0),
      225    12730    1         2 SEVLEV UBIN(18) UNAL INIT(0),
      226    12731    1         2 LOGBSIZ UBIN(18) UNAL INIT(0),
      227    12732    1         2 PROSIZE UBIN(18) UNAL INIT(0),
      228    12733    1         2 RELPSIZ UBIN(18) UNAL INIT(0),
      229    12734    1         2 DNAMSIZ UBIN(18) UNAL INIT(SIZEW(TV_DEF_NAMES)),
      230    12735    1         2 DNAMPSIZ UBIN(18) UNAL INIT(100),
      231    12736    1         2 RNAMSIZ UBIN(18) UNAL INIT(0),
      232    12737    1         2 RNAMPSIZ UBIN(18) UNAL INIT(0),
      233    12738    1         2 EDEFSIZ UBIN(18) UNAL INIT(SIZEW(TV_EDEF)),
      234    12739    1         2 EDEFPSIZ UBIN(18) UNAL INIT(SIZEW(TV_EDEF)),
      235    12740    1         2 EREFSIZ UBIN(18) UNAL INIT(0),
      236    12741    1         2 EREFPSIZ UBIN(18) UNAL INIT(0),
      237    12742    1         2 SDEFSIZE UBIN(18) UNAL INIT(0),
      238    12743    1         2 SDEFPSIZE UBIN(18) UNAL INIT(0),
      239    12744    1         2 SREFSIZE UBIN(18) UNAL INIT(0),
      240    12745    1         2 SREFPSIZE UBIN(18) UNAL INIT(0),
      241    12746    1         2 SEGDEFSIZ UBIN(18) UNAL INIT(0),
      242    12747    1         2 SEGDEFPSIZ UBIN(18) UNAL INIT(0),
      243    12748    1         2 SEGREFSIZ UBIN(18) UNAL INIT(0),
      244    12749    1         2 SEGREFPSIZ UBIN(18) UNAL INIT(0),
      245    12750    1         2 LIB,
      246    12751    1           3 COUNT UBIN(9) UNAL INIT(0),
      247    12752    1           3 LNAM CHAR(31) UNAL INIT(' '),
      248    12753    1         2 ALIB,
      249    12754    1           3 COUNT UBIN(9) UNAL INIT(0),
      250    12755    1           3 ANAM CHAR(31) UNAL INIT(' ');
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:8    
      251    12756
      252    12757    1   DCL 1 TV_MSG STATIC,
      253    12758    1         2 MSG ,
      254    12759    1           3 * CHAR(1) INIT('A'),
      255    12760    1           3 * CHAR(3) INIT(' '),
      256    12761    1           3 ADDR1 CHAR(6) INIT(' '),
      257    12762    1           3 * CHAR(1) INIT(' '),
      258    12763    1           3 NAME1 CHAR(31) INIT(' '),
      259    12764    1           3 * CHAR(4) INIT(' -> '),
      260    12765    1           3 ADDR2 CHAR(6) INIT(' '),
      261    12766    1           3 * CHAR(1) INIT(' '),
      262    12767    1           3 NAME2 CHAR(32) INIT(' '),
      263    12768    1         2 BUFFER REDEF MSG CHAR(85);
      264    12769
      265    12770    1   DCL 1 BUFFER STATIC,
      266    12771    1         2 ONE,
      267    12772    1           3 * CHAR(1) INIT('A'),
      268    12773    1           3 TEXT CHAR(79) INIT(' '),
      269    12774    1         2 TWO REDEF ONE CHAR(80);
      270    12775
      271    12776    1   DCL 1 EMPTY_MSG STATIC,
      272    12777    1         2 MSG ,
      273    12778    1           3 * CHAR(1) INIT('A'),
      274    12779    1           3 * CHAR(3) INIT(' '),
      275    12780    1           3 ADDR1 CHAR(6) INIT(' '),
      276    12781    1           3 * CHAR(0) INIT(' Empty slot'),
      277    12782    1         2 BUFFER REDEF MSG CHAR(21);
      278    12783
      279    12784    1   DCL 1 TV_HEAD_KEY STATIC ALIGNED,
      280    12785    1         2 COUNT UBIN BYTE UNAL INIT(7),
      281    12786    1         2 TEXT CHAR(9) INIT('"_TV_ST');
      282    12787
      283    12788    1   DCL 1 TV_OU_KEY STATIC ALIGNED,
      284    12789    1         2 KEYSIZ UBIN BYTE UNAL INIT(7),
      285    12790    1         2 * BIT(9) UNAL INIT('777'O),
      286    12791    1         2 UTS UBIN UNAL INIT(0),
      287    12792    1         2 TYPE UBIN BYTE UNAL,
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:9    
      288    12793    1         2 PAGE UBIN BYTE UNAL INIT(0);
      289    12794    1   DCL I UBIN;
      290    12795    1   DCL J UBIN;
      291    12796    1   DCL RF_DEF_SIZE UBIN WORD;
      292    12797    1   DCL RF_EDEF_SIZE UBIN;
      293    12798    1   DCL TEMP UBIN;
      294    12799    1   DCL N_DEFS UBIN;
      295    12800    1   DCL N_DEFNS UBIN;
      296    12801    1   DCL OFFSET UBIN STATIC INIT(0);
      297    12802    1   DCL 1 VECTOR_LIST BASED ALIGNED,
      298    12803    1         2 SIZEW1 UBIN HALF UNAL,
      299    12804    1         2 SIZEW2 UBIN HALF UNAL;
      300    12805    1   DCL NEXT UBIN;
      301    12806    1   DCL 1 TEMP_EDEF ALIGNED,
      302    12807    1         2 WORDS(0:1) UBIN WORD UNAL;
      303    12808    1   DCL REF_SIZE UBIN STATIC INIT(0);
      304    12809    1   DCL EREF_SIZE UBIN STATIC INIT(0);
      305    12810         /* PTRs */
      306    12811    1   DCL AVAIL$ PTR;
      307    12812    1   DCL DEF$ PTR STATIC INIT(ADDR(NIL));
      308    12813    1   DCL EREF$ PTR STATIC INIT(ADDR(NIL));
      309    12814    1   DCL TPTR1$ PTR STATIC INIT(ADDR(NIL));
      310    12815    1   DCL TPTR2$ PTR STATIC INIT(ADDR(NIL));
      311    12816    1   DCL REF$ PTR STATIC INIT(ADDR(NIL));
      312    12817    1   DCL RF_DEF$ PTR;
      313    12818    1   DCL RF_EDEF$ PTR;
      314    12819    1   DCL START$ PTR;
      315    12820    1   DCL TPTR$ PTR;
      316    12821    1   DCL NAME1$ PTR;
      317    12822    1   DCL NAME2$ PTR;
      318    12823    1   DCL LIST$ PTR;
      319    12824    1   DCL BEGIN$ PTR;
      320    12825    1   DCL END$ PTR;
      321    12826    1   DCL NAME$ PTR;
      322    12827    1   DCL STOP$ PTR;
      323    12828    1   DCL TPTR3$ PTR;
      324    12829    1   DCL MEM$ PTR;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:10   
      325    12830
      326    12831        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:11   
      327    12832    1   LLT$INIT_TV:ENTRY ;
      328    12833         /**/
      329    12834         /*     Create the transfer vector file. */
      330    12835         /**/
      331    12836    1       CALL M$OPEN(OPEN_TV) ALTRET(ERROR);
      332    12837    1       WRITE_TV.KEY_ = VECTOR(TV_OU_KEY);
      333    12838         /**/
      334    12839    1       TV_OU_KEY.TYPE = %TYPDNAM;
      335    12840    1       WRITE_TV.BUF_.BUF$ = ADDR(TV_DEF_NAMES);
      336    12841    1       WRITE_TV.BUF_.BOUND = SIZEW(TV_DEF_NAMES) * 4 -1;
      337    12842    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      338    12843         /**/
      339    12844    1       TV_OU_KEY.TYPE = %TYPSECT;
      340    12845    1       WRITE_TV.BUF_ = VECTOR(TV_SECTION);
      341    12846    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      342    12847         /**/
      343    12848    1       TV_OU_KEY.TYPE = %TYPEDEF;
      344    12849    1       WRITE_TV.BUF_ = VECTOR(TV_EDEF);
      345    12850    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      346    12851         /**/
      347    12852         /* Build head record for transfer vector ou file */
      348    12853         /**/
      349    12854
      350    12855    1       WRITE_TV.KEY_ = VECTOR(TV_HEAD_KEY);
      351    12856    1       WRITE_TV.BUF_.BUF$ = ADDR(TV_HEAD);
      352    12857    1       WRITE_TV.BUF_.BOUND = SIZEW(TV_HEAD) * 4 - 1;
      353    12858    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      354    12859    1       CALL M$CLOSE(CLOSE_TV) ALTRET(ERROR);
      355    12860    1       RETURN;
      356    12861        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:12   
      357    12862    1   LLT$BUILD_VECTOR:ENTRY;
      358    12863         /**/
      359    12864         /* Initialize all relocation key and record */
      360    12865         /**/
      361    12866
      362    12867    1       REPEAT_TV_RELOC_KEY.KEYSIZ = 12;
      363    12868    1       REPEAT_TV_RELOC_KEY.SECTNUM = 0;
      364    12869    1       REPEAT_TV_RELOC_KEY.OFFSET = 0;
      365    12870    1       REPEAT_TV_RELOC_KEY.SUBTYPE = 1;
      366    12871    1       REPEAT_TV_RELOC_KEY.SEQUENCE = 0;
      367    12872    1       REPEAT_TV_RELOC_KEY.UTS = 0;
      368    12873         /**/
      369    12874         /* Build the key for ENTREF relocation record */
      370    12875         /**/
      371    12876
      372    12877    1       ENTREF_RELOC_KEY = REPEAT_TV_RELOC_KEY;
      373    12878    1       ENTREF_RELOC_KEY.SEQUENCE = 1;
      374    12879         /**/
      375    12880         /* Build branch instruction */
      376    12881         /**/
      377    12882
      378    12883    1       BRK_SLOT = '0'B;
      379    12884    1       BRK_SLOT.OPNDTYP = 4;
      380    12885    1       BRK_SLOT.EVALOP = 7;
      381    12886    1       BRK_SLOT.RELOCOP = 14;
      382    12887    1       BRK_SLOT.OPERAND = 1;
      383    12888    1       BRK_SLOT.ENDBIT = 15;
      384    12889    1       BRK_SLOT.VALUE = BITBIN('0F80'X); /* B   instruction */
      385    12890         /**/
      386    12891         /* Build the ENTREF relocation directive to branch to right address */
      387    12892         /**/
      388    12893
      389    12894    1       ENTREF_RELOC = '0'B;
      390    12895    1       ENTREF_RELOC.OPNDTYP = 2; /* ENTREF */
      391    12896    1       ENTREF_RELOC.RELOCOP = 14;
      392    12897    1       ENTREF_RELOC.ENDBIT = 31;
      393    12898         /**/
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:13   
      394    12899         /* Build relocation directive to fill out control section with BRK instruction */
      395    12900         /**/
      396    12901
      397    12902    1       REPEAT_TV_RELOC = '0'B;
      398    12903    1       REPEAT_TV_RELOC.OPNDTYP = 4 ; /* CONSTANT */
      399    12904    1       REPEAT_TV_RELOC.EVALOP = 7; /* REPEAT */
      400    12905    1       REPEAT_TV_RELOC.RELOCOP = 14 ;
      401    12906    1       REPEAT_TV_RELOC.ENDBIT = 15;
      402    12907    1       REPEAT_TV_RELOC.VALUE = BITBIN('0002'X); /* BRK INSTRUCTION */
      403    12908         /**/
      404    12909         /* Open transfer vector file and process VECTOR options */
      405    12910         /**/
      406    12911    1       N_DEFS = LL_HEAD.EPRECSIZE;
      407    12912    1       N_DEFNS = LL_HEAD.NRECSIZE;
      408    12913
      409    12914    1       OPEN_TV.V.FUN# = 1;
      410    12915    1       CALL M$OPEN(OPEN_TV) ALTRET(ERROR);
      411    12916    1       AVAIL$ = LL_TOPOMEM$;
      412    12917         /**/
      413    12918         /* Allocate memory for ENTDEF */
      414    12919         /**/
      415    12920    1       CALL LLM$MON_SVC(LL#GETMEM,N_DEFS*6,AVAIL$);
      416    12921    1       MEM$ = AVAIL$;
      417    12922    1       AVAIL$ = PINCRW(AVAIL$,N_DEFS*6);
      418    12923
      419    12924         /**/
      420    12925         /* Get the DEF record from the target run unit */
      421    12926         /**/
      422    12927
      423    12928    1       DEF$ = LL_DNAME_VEC.P$;
      424    12929         /**/
      425    12930         /* Allocate the memory for relocation record */
      426    12931         /**/
      427    12932
      428    12933    1       CALL LLM$MON_SVC(LL#GETMEM,N_DEFS*6,AVAIL$);
      429    12934    1       TPTR$ = AVAIL$;
      430    12935    1       START$ = AVAIL$;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:14   
      431    12936    1       AVAIL$ = PINCRW(AVAIL$,N_DEFS*6);
      432    12937    1       TV_HEAD.RELPSIZ = N_DEFS * 6;
      433    12938    1       LL_R_OU$ -> OU_ENTRY.HEAD$ -> B$OUHEAD.RELPSIZ = TV_HEAD.RELPSIZ;
      434    12939    1       CALL LLM$MON_SVC(LL#GETMEM,N_DEFS,AVAIL$);
      435    12940    1       EREF$ = AVAIL$;
      436    12941    1       TPTR1$ = AVAIL$;
      437    12942    1       AVAIL$ = PINCRW(AVAIL$,N_DEFS);
      438    12943    1       CALL LLM$MON_SVC(LL#GETMEM,N_DEFNS+N_DEFS,AVAIL$);
      439    12944    1       REF$ = AVAIL$;
      440    12945    1       TPTR2$ = AVAIL$;
      441    12946    1       AVAIL$ = PINCRW(AVAIL$,N_DEFNS+N_DEFS);
      442    12947         /**/
      443    12948         /* Process RF option */
      444    12949         /**/
      445    12950
      446    12951    1       IF LL_FLAGS.RF# THEN
      447    12952    2       DO;
      448    12953    2           CALL M$FID(RUN_FILE);
      449    12954    2           CALL M$OPEN(OPEN_RF) ALTRET(ERROR);
      450    12955         /**/
      451    12956         /* Read run file head record for RF option */
      452    12957         /**/
      453    12958
      454    12959    2           READ_RF_HEAD.BUF_.BUF$ = ADDR(RF_HEAD);
      455    12960    2           READ_RF_HEAD.BUF_.BOUND = SIZEC(RF_HEAD);
      456    12961    2           CALL M$READ(READ_RF_HEAD)
      457    12962    3           WHENALTRETURN DO;
      458    12963    3               CALL INSERT(LL_DOBUF,0,,'A  *** Unable to read head record for ',
             12963                        LL_VECTOR_RF);
      459    12964    3               CALL LLM$MON_SVC(LL#WRITEDO);
      460    12965    3               LL_DOBUF = '      during transfer vector processing';
      461    12966    3               CALL LLM$MON_SVC(LL#WRITEDO);
      462    12967    3               CALL LLM$MON_SVC(LL#ERR);
      463    12968    3               END;
      464    12969         /**/
      465    12970         /* Read def record from run file for RF option */
      466    12971         /**/
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:15   
      467    12972
      468    12973    2           TEMP = RF_HEAD.NRECSIZE;
      469    12974    2           CALL LLM$MON_SVC(LL#GETMEM,TEMP,AVAIL$);
      470    12975    2           RF_DEF$ = AVAIL$;
      471    12976    2           AVAIL$ = PINCRW(AVAIL$,TEMP);
      472    12977    2           READ_RF.BUF_.BUF$ = RF_DEF$;
      473    12978    2           READ_RF.BUF_.BOUND = TEMP * 4 - 1;
      474    12979    2           B$RUKEY.TYPE = %TYPDNAM;
      475    12980    2           READ_RF.KEY_ = VECTOR(B$RUKEY);
      476    12981    2           CALL M$READ(READ_RF) ALTRET(READ_ERROR);
      477    12982    2           RF_DEF_SIZE = DCBADDR(DCBNUM(M$RF))->B$DCB.ARS# / 4;
      478    12983         /**/
      479    12984         /* Read entdef record from run file for RF option */
      480    12985         /**/
      481    12986
      482    12987    2           TEMP = RF_HEAD.EPRECSIZE;
      483    12988    2           CALL LLM$MON_SVC(LL#GETMEM,TEMP,AVAIL$);
      484    12989    2           RF_EDEF$ = AVAIL$;
      485    12990    2           AVAIL$ = PINCRW(AVAIL$,TEMP);
      486    12991    2           B$RUKEY.TYPE = %TYPEDEF;
      487    12992    2           READ_RF.BUF_.BUF$ = RF_EDEF$;
      488    12993    2           READ_RF.BUF_.BOUND = TEMP * 4 -1;
      489    12994    2           READ_RF.KEY_ = VECTOR(B$RUKEY);
      490    12995    2           CALL M$READ(READ_RF) ALTRET(READ_ERROR);
      491    12996    2           RF_EDEF_SIZE = DCBADDR(DCBNUM(M$RF))->B$DCB.ARS# / 4;
      492    12997    3           DO WHILE('0'B);
      493    12998    3   READ_ERROR:
      494    12999    3               CALL INSERT(LL_DOBUF,0,,'A  *** Missing record from ',
      495    13000    3                  LL_VECTOR_RF);
      496    13001    3               CALL LLM$MON_SVC(LL#WRITEDO);
      497    13002    3               LL_DOBUF = '      during transfer vector processing';
      498    13003    3               CALL LLM$MON_SVC(LL#WRITEDO);
      499    13004    3               CALL LLM$MON_SVC(LL#ERR);
      500    13005    3               END;
      501    13006    2           TEMP = RF_EDEF_SIZE / SIZEW(B$EDEF);
      502    13007         /**/
      503    13008         /* sorting RF entdef record by value */
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:16   
      504    13009         /**/
      505    13010
      506    13011    2           CALL SORT_BY_VALUE(RF_EDEF$->B$EDEF);
      507    13012         /**/
      508    13013         /* looking for _TV_ST */
      509    13014         /**/
      510    13015
      511    13016    2           CALL SEARCH_TV(ADDR(TV_START_NAME),NAME1$,RF_DEF$);
      512    13017    2           IF NAME1$ = RF_EDEF$
      513    13018    2           THEN
      514    13019    2               BEGIN$ = PINCRW(NAME1$,SIZEW(B$EDEF));
      515    13020    2           ELSE
      516    13021    3           DO;
      517    13022    3               NAME2$ = PINCRW(NAME1$,-SIZEW(B$EDEF));
      518    13023    3               IF NAME1$->B$EDEF.ISADDR ~= NAME2$->B$EDEF.ISADDR
      519    13024    3               THEN
      520    13025    3                   BEGIN$ = PINCRW(NAME1$,SIZEW(B$EDEF));
      521    13026    3               ELSE
      522    13027    4               DO;
      523    13028    4                   TEMP_EDEF = NAME1$->B$EDEF;
      524    13029    4                   NAME1$->B$EDEF = NAME2$->B$EDEF;
      525    13030    4                   NAME2$->B$EDEF = TEMP_EDEF;
      526    13031    4                   BEGIN$ = NAME1$;
      527    13032    4                   END;
      528    13033    3               END;
      529    13034         /**/
      530    13035         /* looking for _TV_EN */
      531    13036         /**/
      532    13037
      533    13038    2           CALL SEARCH_TV(ADDR(TV_END_NAME),END$,RF_DEF$);
      534    13039         /**/
      535    13040         /* Process transfer vector entries from RF */
      536    13041         /**/
      537    13042
      538    13043    2           I = BEGIN$->B$EDEF.ISADDR;
      539    13044    3           DO WHILE(BEGIN$ < END$);
      540    13045    3               IF BEGIN$->B$EDEF.ISADDR > I THEN
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:17   
      541    13046    4               DO;
      542    13047    4                   OFFSET = OFFSET + BEGIN$->B$EDEF.ISADDR - I;
      543    13048    4                   I = BEGIN$->B$EDEF.ISADDR;
      544    13049    4                   END;
      545    13050    3               NAME1$ = PINCRW(RF_DEF$,BEGIN$->B$EDEF.NPOINTER);
      546    13051    3               CALL SEARCH_ENTDEF(NAME1$,NAME2$) ALTRET(NOT_FOUND);
      547    13052    3               CALL INSERT_VECTOR(NAME1$->B$DNAME,NAME2$->B$EDEF);
      548    13053    4               DO WHILE('0'B);
      549    13054    4   NOT_FOUND:
      550    13055    4                   CALL CONCAT(LL_DOBUF,'A  *** Transfer vector entry (from)',
      551    13056    4                      LL_VECTOR_RF);
      552    13057    4                   CALL LLM$MON_SVC(LL#WRITEDO);
      553    13058    4                   CALL CONCAT(LL_DOBUF,'A      not defined:',
      554    13059    4                      SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.COUNT));
      555    13060    4                   CALL LLM$MON_SVC(LL#WRITEDO);
      556    13061    4                   LL_DOBUF = 'A  *** Empty slot reserved in transfer vector instead.';
      557    13062    4                   CALL LLM$MON_SVC(LL#WRITEDO);
      558    13063    4                   OFFSET = OFFSET + 3;
      559    13064    4                   END;
      560    13065    3               BEGIN$ = PINCRW(BEGIN$,SIZEW(B$EDEF));
      561    13066    3               I = I + 3;
      562    13067    3               END;
      563    13068    2           OFFSET = OFFSET + END$->B$EDEF.ISADDR - I;
      564    13069    2           CALL M$CLOSE(CLOSE_RF);
      565    13070    2           END;
      566    13071         /**/
      567    13072         /* Process ENTRIES suboptions */
      568    13073         /**/
      569    13074
      570    13075    1       LIST$ = LL_LIST$;
      571    13076    2       DO I = 1 TO LL_LIST_SIZE;
      572    13077    2           NAME1$ = PINCRW(LIST$,SIZEW(VECTOR_LIST));
      573    13078    2           NEXT = LIST$->VECTOR_LIST.SIZEW1 + 1;
      574    13079    2           IF LIST$->VECTOR_LIST.SIZEW1 = 0 THEN
      575    13080    3           DO; /* Empty slots option */
      576    13081    3               OFFSET = OFFSET + LIST$->VECTOR_LIST.SIZEW2*3;
      577    13082    3               END;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:18   
      578    13083    2           ELSE
      579    13084    2               IF LIST$->VECTOR_LIST.SIZEW2 = 0 THEN
      580    13085    3               DO; /* Entry names suboption */
      581    13086    3                   CALL SEARCH_ENTDEF(NAME1$,NAME$) ALTRET(NOT_DEFINED);
      582    13087    3                   CALL INSERT_VECTOR(NAME1$->B$DNAME,NAME$->B$EDEF);
      583    13088    4                   DO WHILE('0'B);
      584    13089    4   NOT_DEFINED:
      585    13090    4                       IF LL_HEAD.SEV < 7 THEN LL_HEAD.SEV = 7;
      586    13091    4                       CALL INSERT(LL_DOBUF,0,,
             13091                                'A  *** Transfer vector entry not defined: ',
      587    13092    4                          NAME1$->B$DNAME.TEXT);
      588    13093    4                       CALL LLM$MON_SVC(LL#WRITEDO);
      589    13094    4                       LL_DOBUF =
             13094                                'A     Empty slot reserved in transfer vector instead';
      590    13095    4                       CALL LLM$MON_SVC(LL#WRITEDO);
      591    13096    4                       OFFSET = OFFSET + 3;
      592    13097    4                       END;
      593    13098    3                   END; /* Entry names */
      594    13099    2               ELSE
      595    13100    3               DO; /* Entdef names range */
      596    13101    3                   NAME2$ = PINCRW(NAME1$,LIST$->VECTOR_LIST.SIZEW1);
      597    13102    3                   NEXT = NEXT + LIST$->VECTOR_LIST.SIZEW2;
      598    13103    3                   CALL LLM$MON_SVC(LL#GETMEM,4096,AVAIL$);
      599    13104    3                   CALL LLW$WRTDEF(LL_ENTDEF_R$,AVAIL$,%TYPEDEF,DEF$);
      600    13105    3                   B$RUKEY.TYPE = %TYPEDEF;
      601    13106    3                   CALL LLM$MON_SVC(LL#READRU,AVAIL$,4096,B$RUKEY);
      602    13107    3                   TEMP = DCBADDR(DCBNUM(M$RU))->B$DCB.ARS#/4;
      603    13108    3                   CALL RANGE_START(NAME1$->B$DNAME,BEGIN$) ALTRET(RANGE_ERROR);
      604    13109    3                   CALL RANGE_END(NAME2$->B$DNAME,BEGIN$,END$) ALTRET(RANGE_ERROR);
      605    13110    4                   DO WHILE (BEGIN$ < END$);
      606    13111    4                       NAME$ = PINCRW(DEF$,BEGIN$->B$EDEF.NPOINTER);
      607    13112    4                       CALL INSERT_VECTOR(NAME$->B$DNAME,BEGIN$->B$EDEF);
      608    13113    4                       BEGIN$ = PINCRW(BEGIN$,SIZEW(B$EDEF));
      609    13114    4                       END;
      610    13115    4                   DO WHILE('0'B);
      611    13116    4   RANGE_ERROR:
      612    13117    4                       LL_DOBUF =
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:19   
             13117                                'A  *** No transfer vector entries exist for the range:';
      613    13118    4                       CALL LLM$MON_SVC(LL#WRITEDO);
      614    13119    4                       CALL CONCAT(LL_DOBUF,'A     ',SUBSTR(NAME1$->B$DNAME.TEXT,0,
             13119                                NAME1$->B$DNAME.COUNT),
      615    13120    4                          ' - ',SUBSTR(NAME2$->B$DNAME.TEXT,0,NAME2$->B$DNAME.COUNT));
      616    13121    4                       CALL LLM$MON_SVC(LL#WRITEDO);
      617    13122    4                       END;
      618    13123    3                   END; /* RANGE */
      619    13124    2           LIST$ = PINCRW(LIST$,NEXT);
      620    13125    2           END; /* Entry suboption */
      621    13126         /**/
      622    13127         /* Finish transfer vector */
      623    13128         /**/
      624    13129
      625    13130    1       LL_TOPOMEM$ = MEM$;
      626    13131    1       CALL SEARCH_ENTDEF(ADDR(TV_END_NAME),NAME$);
      627    13132    1       NAME$->B$EDEF.OU.OFFSET = OFFSET;
      628    13133    1       TV_EDEF.TV_END.OU.OFFSET = OFFSET;
      629    13134    1       OFFSET = OFFSET + 3;
      630    13135    1       LL_R_CODE$->SECT_ENTRY.SECTION$->LL_SECTION.SIZE = OFFSET;
      631    13136    1       TV_SECTION.SIZE = OFFSET;
      632    13137         /**/
      633    13138         /* Write the relocation record */
      634    13139         /**/
      635    13140
      636    13141    1       WRITE_TV.KEY_ = VECTOR(ENTREF_RELOC_KEY);
      637    13142    1       WRITE_TV.BUF_.BUF$ = START$;
      638    13143    1       WRITE_TV.BUF_.BOUND = POFFC(TPTR$,START$) - 1;
      639    13144    1       IF TPTR$ ~= START$
      640    13145    1       THEN
      641    13146    1           CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      642    13147    1       REPEAT_TV_RELOC.OPERAND = OFFSET;
      643    13148    1       WRITE_TV.KEY_ = VECTOR(REPEAT_TV_RELOC_KEY);
      644    13149    1       WRITE_TV.BUF_ = VECTOR(REPEAT_TV_RELOC);
      645    13150    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      646    13151         /**/
      647    13152         /* Write section record and entdef */
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:20   
      648    13153         /**/
      649    13154
      650    13155    1       WRITE_TV.KEY_ = VECTOR(TV_OU_KEY);
      651    13156    1       TV_OU_KEY.TYPE = %TYPSECT;
      652    13157    1       WRITE_TV.BUF_ = VECTOR(TV_SECTION);
      653    13158    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      654    13159    1       TV_OU_KEY.TYPE = %TYPEDEF;
      655    13160    1       WRITE_TV.BUF_ = VECTOR(TV_EDEF);
      656    13161    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      657    13162         /**/
      658    13163         /* Write referenced names record */
      659    13164         /**/
      660    13165
      661    13166    1       TV_OU_KEY.TYPE = %TYPRNAM;
      662    13167    1       TV_HEAD.RNAMSIZ = REF_SIZE;
      663    13168    1       TV_HEAD.RNAMPSIZ = REF_SIZE;
      664    13169    1       WRITE_TV.BUF_.BUF$ = REF$;
      665    13170    1       WRITE_TV.BUF_.BOUND = REF_SIZE* 4 -1;
      666    13171    1       IF REF_SIZE > 0 THEN
      667    13172    1           CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      668    13173         /**/
      669    13174         /* Write ENTREF record */
      670    13175         /**/
      671    13176
      672    13177    1       TV_OU_KEY.TYPE = %TYPEREF;
      673    13178    1       WRITE_TV.BUF_.BUF$ = EREF$;
      674    13179    1       WRITE_TV.BUF_.BOUND = EREF_SIZE * 4 - 1;
      675    13180    1       TV_HEAD.EREFSIZ = EREF_SIZE;
      676    13181    1       TV_HEAD.EREFPSIZ = EREF_SIZE;
      677    13182    1       IF REF_SIZE > 0 THEN
      678    13183    1           CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      679    13184         /**/
      680    13185         /* Write head record */
      681    13186         /**/
      682    13187
      683    13188    1       WRITE_TV.KEY_ = VECTOR(TV_HEAD_KEY);
      684    13189    1       WRITE_TV.BUF_ = VECTOR(TV_HEAD);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:21   
      685    13190    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);
      686    13191    1       LL_R_OU$->OU_ENTRY.HEAD$->B$OUHEAD.RNAMSIZ = REF_SIZE;
      687    13192    1       LL_R_OU$->OU_ENTRY.HEAD$->B$OUHEAD.EREFSIZ = EREF_SIZE;
      688    13193    1       LL_R_OU$->OU_ENTRY.HEAD$->B$OUHEAD.RNAMPSIZ = REF_SIZE;
      689    13194    1       LL_R_OU$->OU_ENTRY.HEAD$->B$OUHEAD.EREFPSIZ = EREF_SIZE;
      690    13195
      691    13196         /* Close transfer vector file */
      692    13197
      693    13198    1       CALL M$CLOSE(CLOSE_TV) ALTRET(ERROR);
      694    13199
      695    13200    1       RETURN;
      696    13201        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:22   
      697    13202    1   LLT$FINISH_VECTOR: ENTRY;
      698    13203         /**/
      699    13204         /*    Finish transfer vector and process REMOVE_ENTDEF, REMOVE_SYMDEF
      700    13205            options and displays transfer vectors */
      701    13206         /**/
      702    13207
      703    13208    1       AVAIL$ = LL_BOTOMEM$;
      704    13209    1       B$RUKEY = '0'B;
      705    13210    1       B$RUKEY.TYPE = %TYPDNAM;
      706    13211    1       B$RUKEY.KEYSIZ = 5;
      707    13212    1       B$RUKEY.ISADDR = 0;
      708    13213    1       I = LL_HEAD.NRECSIZE;
      709    13214    1       CALL LLM$MON_SVC(LL#GETMEM,I,AVAIL$);
      710    13215    1       CALL LLM$MON_SVC(LL#READRU,AVAIL$,I*4-1,B$RUKEY);
      711    13216    1       DEF$ = AVAIL$;
      712    13217    1       AVAIL$ = PINCRW(AVAIL$,I);
      713    13218    1       I = LL_HEAD.EPRECSIZE;
      714    13219    1       CALL LLM$MON_SVC(LL#GETMEM,I,AVAIL$);
      715    13220    1       B$RUKEY.TYPE = %TYPEDEF;
      716    13221    1       CALL LLM$MON_SVC(LL#READRU,AVAIL$,I*4-1,B$RUKEY);
      717    13222    1       TEMP = (DCBADDR(DCBNUM(M$RU))->B$DCB.ARS#/4)/ SIZEW(B$EDEF);
      718    13223    1       RF_EDEF$ = AVAIL$;
      719    13224    1       AVAIL$ = PINCRW(AVAIL$,I);
      720    13225    1       END$ = PINCRW(RF_EDEF$,TEMP*2-SIZEW(B$EDEF));
      721    13226
      722    13227         /**/
      723    13228         /* Sort entdef by value for processing later on */
      724    13229         /**/
      725    13230
      726    13231    1       CALL SORT_BY_VALUE(RF_EDEF$->B$EDEF);
      727    13232
      728    13233         /**/
      729    13234         /* Sort entdefs not in transfer vector by name */
      730    13235         /**/
      731    13236
      732    13237    1       CALL SEARCH_TV(ADDR(TV_START_NAME),START$,DEF$);
      733    13238    1       TV_EDEF.TV_START = START$->B$EDEF;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:23   
      734    13239    1       IF START$ ~= RF_EDEF$
      735    13240    1       THEN
      736    13241    2       DO;
      737    13242    2           TPTR$ = PINCRW(START$,-SIZEW(B$EDEF));
      738    13243    2           IF TPTR$->B$EDEF.ISADDR = START$->B$EDEF.ISADDR
      739    13244    2           THEN
      740    13245    3           DO;
      741    13246    3               START$->B$EDEF = TPTR$->B$EDEF;
      742    13247    3               TPTR$->B$EDEF = TV_EDEF.TV_START;
      743    13248    3               START$ = TPTR$;
      744    13249    3               END;
      745    13250    2           END;
      746    13251    1       CALL SEARCH_TV(ADDR(TV_END_NAME),STOP$,DEF$);
      747    13252    1       TV_EDEF.TV_END = STOP$->B$EDEF;
      748    13253    1       TEMP = POFFW(START$,RF_EDEF$)/SIZEW(B$EDEF);
      749    13254    2       DO I = 0 TO TEMP;
      750    13255    2           TEMP_EDEF = RF_EDEF$->B$EDEF;
      751    13256    2           TPTR$ = RF_EDEF$;
      752    13257    3           DO WHILE(TPTR$ < STOP$);
      753    13258    3               TPTR1$ = PINCRW(TPTR$,SIZEW(B$EDEF));
      754    13259    3               TPTR$->B$EDEF = TPTR1$->B$EDEF;
      755    13260    3               TPTR$ = TPTR1$;
      756    13261    3               END;
      757    13262    2           STOP$->B$EDEF = TEMP_EDEF;
      758    13263    2           STOP$ = PINCRW(STOP$,-SIZEW(B$EDEF));
      759    13264    2           END;
      760    13265    1       BEGIN$ = STOP$; /* Name$ point to start of non transvect */
      761    13266    1       TEMP = (POFFW(END$,BEGIN$) + SIZEW(B$EDEF))/SIZEW(B$EDEF);
      762    13267    1       CALL SORT_BY_NAME(BEGIN$->B$EDEF);
      763    13268         /**/
      764    13269         /* Fix up the transfer vector */
      765    13270         /**/
      766    13271
      767    13272    1       LL_LOBUF = 'C   ';
      768    13273    1       CALL LLM$MON_SVC(LL#WRITELO);
      769    13274    1       LL_LOBUF = 'C ************* TRANSFER VECTOR **************';
      770    13275    1       CALL LLM$MON_SVC(LL#WRITELO);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:24   
      771    13276    1       START$ = RF_EDEF$;
      772    13277    1       TPTR1$ = STOP$;
      773    13278    1       OFFSET = TV_EDEF.TV_START.ISADDR;
      774    13279    2       DO WHILE (START$ < STOP$ );
      775    13280    3           DO WHILE(OFFSET < START$->B$EDEF.ISADDR);
      776    13281    3               CALL LLI$BINHEX(OFFSET,6,EMPTY_MSG.MSG.ADDR1);
      777    13282    3               LL_LOBUF = EMPTY_MSG.BUFFER;
      778    13283    3               CALL LLM$MON_SVC(LL#WRITELO);
      779    13284    3               OFFSET = OFFSET + 3;
      780    13285    3               END;
      781    13286    2           NAME1$ = PINCRW(DEF$,START$->B$EDEF.NPOINTER);
      782    13287    2           TV_MSG.MSG.NAME2 = NAME1$->B$DNAME.TEXT;
      783    13288    2           CALL LLI$BINHEX(OFFSET,6,TV_MSG.MSG.ADDR1);
      784    13289    2           TPTR$ = BEGIN$;
      785    13290    3           DO WHILE ( TPTR$ <= END$ );
      786    13291    3               NAME2$ = PINCRW(DEF$,TPTR$->B$EDEF.NPOINTER);
      787    13292    3               IF NAME2$->B$DNAME.TEXT = SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.
             13292                        COUNT-1)
      788    13293    3               THEN
      789    13294    3                   EXIT;
      790    13295    3               ELSE TPTR$ = PINCRW(TPTR$,SIZEW(B$EDEF));
      791    13296    3               END;
      792    13297    2           TV_MSG.MSG.NAME1 = SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.COUNT-1);
      793    13298    2           I = TPTR$->B$EDEF.ISADDR;
      794    13299    2           CALL LLI$BINHEX(I,6,TV_MSG.MSG.ADDR2);
      795    13300    2           I = START$->B$EDEF.NPOINTER;
      796    13301    2           START$->B$EDEF.NPOINTER = TPTR$->B$EDEF.NPOINTER;
      797    13302    2           TPTR$->B$EDEF.NPOINTER = I;
      798    13303    2           TEMP_EDEF = TPTR$->B$EDEF;
      799    13304    2           TPTR2$ = PINCRW(TPTR$,-SIZEW(B$EDEF));
      800    13305    3           DO WHILE (TPTR2$ >= BEGIN$);
      801    13306    3               IF PINCRW(DEF$,TPTR2$->B$EDEF.NPOINTER)->B$DNAME.TEXT
      802    13307    3                  ~= SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.COUNT-1)
      803    13308    3               THEN EXIT;
      804    13309    3               TPTR2$ = PINCRW(TPTR2$,-SIZEW(B$EDEF));
      805    13310    3               END;
      806    13311    2           TPTR3$ = PINCRW(TPTR$,SIZEW(B$EDEF));
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:25   
      807    13312    3           DO WHILE(TPTR3$ <= END$);
      808    13313    3               IF PINCRW(DEF$,TPTR3$->B$EDEF.NPOINTER)->B$DNAME.TEXT
      809    13314    3                  ~= SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.COUNT-1)
      810    13315    3               THEN EXIT;
      811    13316    3               ELSE TPTR3$ = PINCRW(TPTR3$,SIZEW(B$EDEF));
      812    13317    3               END;
      813    13318    2           TPTR3$ = PINCRW(TPTR3$,-SIZEW(B$EDEF));
      814    13319    3           DO WHILE (TPTR2$ >= BEGIN$);
      815    13320    3               TPTR3$->B$EDEF = TPTR2$->B$EDEF;
      816    13321    3               TPTR3$ = PINCRW(TPTR3$,-SIZEW(B$EDEF));
      817    13322    3               TPTR2$ = PINCRW(TPTR2$,-SIZEW(B$EDEF));
      818    13323    3               END;
      819    13324    2           BEGIN$ = PINCRW(TPTR3$,SIZEW(B$EDEF));
      820    13325    2           TPTR1$->B$EDEF = TEMP_EDEF;
      821    13326    2           TPTR1$ = PINCRW(TPTR1$,SIZEW(B$EDEF));
      822    13327    2           LL_LOBUF = TV_MSG.BUFFER;
      823    13328    2           CALL LLM$MON_SVC(LL#WRITELO);
      824    13329    2           START$ = PINCRW(START$,SIZEW(B$EDEF));
      825    13330    2           OFFSET = OFFSET + 3;
      826    13331    2           END; /* START$ < = STOP$ */
      827    13332    2       DO WHILE (OFFSET < TV_EDEF.TV_END.ISADDR);
      828    13333    2           CALL LLI$BINHEX(OFFSET,6,EMPTY_MSG.MSG.ADDR1);
      829    13334    2           LL_LOBUF = EMPTY_MSG.BUFFER;
      830    13335    2           CALL LLM$MON_SVC(LL#WRITELO);
      831    13336    2           OFFSET = OFFSET + 3;
      832    13337    2           END;
      833    13338         /**/
      834    13339         /* Display ENTDEF not in transfer vector */
      835    13340         /**/
      836    13341    1       LL_LOBUF = 'C       ';
      837    13342    1       CALL LLM$MON_SVC(LL#WRITELO);
      838    13343    1       LL_LOBUF = 'C *******ENTRY DEFINITIONS NOT IN TRANSFER VECTOR***********';
      839    13344    1       CALL LLM$MON_SVC(LL#WRITELO);
      840    13345    1       J = 0;
      841    13346    1       TPTR$ = BEGIN$;
      842    13347    2       DO WHILE( TPTR$ <= END$);
      843    13348    2           NAME1$ = PINCRW(DEF$,TPTR$->B$EDEF.NPOINTER);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:26   
      844    13349    2           TPTR2$ = PINCRW(TPTR$,SIZEW(B$EDEF));
      845    13350    3           DO WHILE ( TPTR2$ <= END$);
      846    13351    3               IF PINCRW(DEF$,TPTR2$->B$EDEF.NPOINTER)->B$DNAME.TEXT
      847    13352    3                  ~= NAME1$->B$DNAME.TEXT
      848    13353    3               THEN EXIT;
      849    13354    3               TPTR2$ = PINCRW(TPTR2$,SIZEW(B$EDEF));
      850    13355    3               END;
      851    13356    2           IF J = 2
      852    13357    2           THEN
      853    13358    3           DO;
      854    13359    3               LL_LOBUF = BUFFER.TWO;
      855    13360    3               CALL LLM$MON_SVC(LL#WRITELO);
      856    13361    3               BUFFER.ONE.TEXT = ' ';
      857    13362    3               J = 0;
      858    13363    3               END;
      859    13364    2           CALL INSERT(BUFFER.ONE.TEXT,J*40+5,,NAME1$->B$DNAME.TEXT);
      860    13365    2           J = J + 1;
      861    13366    2           TPTR$ = TPTR2$;
      862    13367    2           END;
      863    13368    1       IF J > 0
      864    13369    1       THEN
      865    13370    2       DO;
      866    13371    2           LL_LOBUF = BUFFER.TWO;
      867    13372    2           CALL LLM$MON_SVC(LL#WRITELO);
      868    13373    2           END;
      869    13374    1       IF TPTR1$ = BEGIN$
      870    13375    1       THEN
      871    13376    1           TPTR1$ = PINCRW(END$,SIZEW(B$EDEF));
      872    13377    1       ELSE
      873    13378    2       DO;
      874    13379    3           DO WHILE(BEGIN$ <= END$);
      875    13380    3               TPTR1$->B$EDEF = BEGIN$->B$EDEF;
      876    13381    3               TPTR1$ = PINCRW(TPTR1$,SIZEW(B$EDEF));
      877    13382    3               BEGIN$ = PINCRW(BEGIN$,SIZEW(B$EDEF));
      878    13383    3               END;
      879    13384    2           END;
      880    13385    1       LL_HEAD.EPRECSIZE = POFFW(TPTR1$,RF_EDEF$);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:27   
      881    13386         /**/
      882    13387         /* mark entdefs not in transfer vector if REMONE_ENTDEF is specified */
      883    13388         /**/
      884    13389
      885    13390    1       IF LL_FLAGS.REMOVE_E#
      886    13391    1       THEN
      887    13392    2       DO;
      888    13393    2           LL_HEAD.REMOVE_ENTDEF = '1'B;
      889    13394    3           DO WHILE ( STOP$ < TPTR1$);
      890    13395    3               STOP$->B$EDEF.LFLAGS.SOURCE = %SOURCE_REMOVED#;
      891    13396    3               STOP$ = PINCRW(STOP$,SIZEW(B$EDEF));
      892    13397    3               END;
      893    13398    2           END;
      894    13399    1       TEMP = (POFFW(TPTR1$,RF_EDEF$))/SIZEW(B$EDEF);
      895    13400    1       CALL SORT_BY_NAME(RF_EDEF$->B$EDEF);
      896    13401         /**/
      897    13402         /* Write entdef back to run unit */
      898    13403         /**/
      899    13404    1       B$RUKEY.TYPE = %TYPEDEF;
      900    13405    1       I = LL_HEAD.EPRECSIZE * 4 - 1;
      901    13406    1       CALL LLM$MON_SVC(LL#WRITERU,RF_EDEF$,I,B$RUKEY);
      902    13407         /**/
      903    13408         /* Process REMOVE_SYMDEF if specified */
      904    13409         /**/
      905    13410
      906    13411    1       IF LL_FLAGS.REMOVE_S#
      907    13412    1       THEN
      908    13413    2       DO;
      909    13414    2           TEMP = LL_HEAD.EDRECSIZE;
      910    13415    2           CALL LLM$MON_SVC(LL#GETMEM,TEMP,AVAIL$);
      911    13416    2           B$RUKEY.TYPE = %TYPSDEF;
      912    13417    2           CALL LLM$MON_SVC(LL#READRU,AVAIL$,TEMP*4-1,B$RUKEY);
      913    13418    2           TPTR$ = AVAIL$;
      914    13419    2           TEMP = DCBADDR(DCBNUM(M$RU))->B$DCB.ARS#/4;
      915    13420    2           IF TEMP > 0
      916    13421    2           THEN
      917    13422    3           DO;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:28   
      918    13423    3               LL_HEAD.REMOVE_SYMDEF = '1'B;
      919    13424    4               DO I = 0 TO (TEMP/2-1);
      920    13425    4                   TPTR$->B$SDEF.LFLAGS.SOURCE = %SOURCE_REMOVED#;
      921    13426    4                   TPTR$ = PINCRW(TPTR$,SIZEW(B$SDEF));
      922    13427    4                   END;
      923    13428    3               CALL LLM$MON_SVC(LL#WRITERU,AVAIL$,TEMP*4-1,B$RUKEY);
      924    13429    3               END;
      925    13430    2           END;
      926    13431         /**/
      927    13432         /* Write HEAD record back to run unit */
      928    13433         /**/
      929    13434
      930    13435    1       CALL LLM$MON_SVC(LL#WRITERU,ADDR(LL_HEAD),SIZEC(LL_HEAD)-1,RF_HEAD_KEY);
      931    13436
      932    13437         /**/
      933    13438         /* Delete the transfer vector file */
      934    13439         /**/
      935    13440
      936    13441    1       OPEN_TV.V.DELETE# = '1'B;
      937    13442    1       CALL M$OPEN(OPEN_TV) ALTRET(ERROR);
      938    13443    2       DO WHILE('0'B);
      939    13444    2   ERROR:
      940    13445    2           CALL M$MERC;
      941    13446    2           CALL LLM$MON_SVC(LL#ERR);
      942    13447    2           END;
      943    13448    1       RETURN;
      944    13449        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:29   
      945    13450    1   SEARCH_ENTDEF: PROC(P$,FOUND$) ALTRET;
      946    13451    2   DCL P$ PTR; /* point to entdef name being looked for */
      947    13452    2   DCL FOUND$ PTR; /* return location of entdef name already defined */
      948    13453    2   DCL Q$ PTR;
      949    13454    2   DCL DEF_NAME$ PTR;
      950    13455        %LL$NODE (NAME=TREE);
      951    13487        %B$EDEF(NAME= DEF);
      952    13557         /* Search for entdef record */
      953    13558    2       Q$ = LL_ENTDEF_R$;
      954    13559    3       DO WHILE (Q$ ~= ADDR(NIL));
      955    13560    3           FOUND$ = Q$->TREE.NODE$;
      956    13561    3           DEF_NAME$ = PINCRW(DEF$,FOUND$->DEF.NPOINTER);
      957    13562    3           IF P$->B$DNAME.TEXT > DEF_NAME$->B$DNAME.TEXT
      958    13563    3           THEN
      959    13564    3               Q$ = Q$->TREE.R_CHILD$;
      960    13565    3           ELSE
      961    13566    3               IF P$->B$DNAME.TEXT < DEF_NAME$->B$DNAME.TEXT
      962    13567    3               THEN
      963    13568    3                   Q$ = Q$->TREE.L_CHILD$;
      964    13569    3               ELSE
      965    13570    3                   RETURN;
      966    13571    3           END;
      967    13572    2       ALTRETURN;
      968    13573    2   END SEARCH_ENTDEF;
      969    13574        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:30   
      970    13575    1   INSERT_VECTOR:PROC(NAME,EDEF);
      971    13576        %B$DNAME (NAME = NAME ,STCLASS = " ");
      972    13595        %B$EDEF (NAME = EDEF ,STCLASS = " ");
      973    13665        %B$EREF;
      974    13708        %LL$NODE (NAME=NODE);
      975    13740    2   DCL NAME_SIZE UBIN;
      976    13741    2   DCL P$ PTR;
      977    13742    2   DCL K UBIN;
      978    13743    2       IF NOT EDEF.LFLAGS.USED
      979    13744    2       THEN
      980    13745    2           EDEF.LFLAGS.USED = '1'B;
      981    13746    2       ELSE
      982    13747    3       DO;
      983    13748    3           CALL CONCAT(LL_DOBUF,'A  *** Duplicate transfer vector element ignored: ',
      984    13749    3              SUBSTR(NAME.TEXT,0,NAME.COUNT));
      985    13750    3           CALL LLM$MON_SVC(LL#WRITEDO);
      986    13751    3           RETURN;
      987    13752    3           END;
      988    13753    2       NAME_SIZE = (NAME.COUNT + 6) /4;
      989    13754    2       TPTR2$->B$DNAME.COUNT = NAME.COUNT;
      990    13755    2       TPTR2$->B$DNAME.TEXT = NAME.TEXT;
      991    13756    2       TPTR2$ = PINCRW(TPTR2$,NAME_SIZE);
      992    13757    2       K = LL_HEAD.NRECSIZE;
      993    13758    2       IF NAME_SIZE + K > LL_DNAME_VEC.BOUND
      994    13759    3       THEN CALL M$GDS (FPT_GDS) WHENALTRETURN DO;
      995    13760    3               CALL LLM$MON_SVC(LL#GETMEM);
      996    13761    3               END;
      997    13762    2       P$ = PINCRW(DEF$,K);
      998    13763    2       P$->B$DNAME.COUNT = NAME.COUNT + 1;
      999    13764    2       P$->B$DNAME.TEXT = NAME.TEXT;
     1000    13765    2       CALL INSERT(P$->B$DNAME.TEXT,NAME.COUNT,1,'_');
     1001    13766    2       MEM$->B$EDEF = EDEF;
     1002    13767    2       MEM$->B$EDEF.NPOINTER = K;
     1003    13768    2       MEM$->B$EDEF.ISADDR = OFFSET + LL_LPROC_START + 8;
     1004    13769    2       MEM$->B$EDEF.PRI = '1'B;
     1005    13770    2       P$ = PINCRW(MEM$,SIZEW(B$EDEF));
     1006    13771    2       CALL LLG$GROW(LL_ENTDEF_R$,MEM$,1,LL_R_OU$,P$,DEF$,%TYPEDEF);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:31   
     1007    13772    2       MEM$ = P$;
     1008    13773    2       LL_HEAD.NRECSIZE = LL_HEAD.NRECSIZE + NAME_SIZE;
     1009    13774    2       TPTR1$->B$EREF.NPOINTER = REF_SIZE;
     1010    13775    2       REF_SIZE = REF_SIZE + NAME_SIZE;
     1011    13776    2       TPTR1$->B$EREF.SREF = '0'B;
     1012    13777    2       TPTR1$->B$EREF.ALT = EDEF.ALT;
     1013    13778    2       TPTR1$->B$EREF.CHECK = EDEF.CHECK;
     1014    13779    2       TPTR1$->B$EREF.CST = EDEF.CST;
     1015    13780    2       TPTR1$->B$EREF.NPARAM = EDEF.NPARAM;
     1016    13781    2       TPTR1$ = PINCRW(TPTR1$,SIZEW(B$EREF));
     1017    13782    2       ENTREF_RELOC.OPERAND = EREF_SIZE;
     1018    13783    2       EREF_SIZE = EREF_SIZE + SIZEW(B$EREF);
     1019    13784
     1020    13785         /* Add relocation directive to store the address of the entref */
     1021    13786         /* into the branch instruction for this transfer vector entry */
     1022    13787    2       TPTR$->B$RELOC2 = BRK_SLOT;
     1023    13788    2       TPTR$->B$RELOC2.DISP = OFFSET - ENTREF_RELOC_KEY.OFFSET;
     1024    13789    2       TPTR$ = PINCRW(TPTR$,SIZEW(ENTREF_RELOC));
     1025    13790    2       TPTR$->B$RELOC2 = ENTREF_RELOC;
     1026    13791    2       TPTR$->B$RELOC2.DISP = OFFSET - ENTREF_RELOC_KEY.OFFSET + 1;
     1027    13792    2       TPTR$ = PINCRW(TPTR$,SIZEW(ENTREF_RELOC));
     1028    13793    2       OFFSET = OFFSET + 3;
     1029    13794    2       RETURN;
     1030    13795    2   END INSERT_VECTOR;
     1031    13796        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:32   
     1032    13797    1   RANGE_START :PROC(NAME,P$) ALTRET;
     1033    13798        %B$DNAME(NAME=NAME,STCLASS = " ");
     1034    13817    2   DCL SIZE UBIN;
     1035    13818    2   DCL P$ PTR;
     1036    13819    2   DCL Q$ PTR;
     1037    13820        %LL$NODE(NAME=TREE);
     1038    13852    3       DO J = 0 TO TEMP/2 -1;
     1039    13853    3           P$ = PINCRW(AVAIL$,J*2);
     1040    13854    3           Q$ = PINCRW(DEF$,P$->B$EDEF.NPOINTER);
     1041    13855    3           IF Q$->B$DNAME.COUNT < NAME.COUNT
     1042    13856    3           THEN SIZE = Q$->B$DNAME.COUNT;
     1043    13857    3           ELSE SIZE = NAME.COUNT;
     1044    13858    3           IF SUBSTR(Q$->B$DNAME.TEXT,0,SIZE) >= NAME.TEXT
     1045    13859    3           THEN
     1046    13860    3               RETURN;
     1047    13861    3           END;
     1048    13862    2       ALTRETURN;
     1049    13863    2   END RANGE_START;
     1050    13864        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:33   
     1051    13865    1   RANGE_END:PROC(NAME,R$,P$) ALTRET;
     1052    13866        %B$DNAME(NAME=NAME,STCLASS=" ");
     1053    13885    2   DCL R$ PTR;
     1054    13886    2   DCL P$ PTR;
     1055    13887    2   DCL Q$ PTR;
     1056    13888    2   DCL SIZE UBIN;
     1057    13889        %LL$NODE(NAME=TREE);
     1058    13921    3       DO J = 0 TO TEMP/2 -1;
     1059    13922    3           P$ = PINCRW(AVAIL$,J*2);
     1060    13923    3           Q$ = PINCRW(DEF$,P$->B$EDEF.NPOINTER);
     1061    13924    3           IF Q$->B$DNAME.COUNT < NAME.COUNT
     1062    13925    3           THEN SIZE = Q$->B$DNAME.COUNT;
     1063    13926    3           ELSE SIZE = NAME.COUNT;
     1064    13927    3           IF SUBSTR(Q$->B$DNAME.TEXT,0,SIZE) > NAME.TEXT
     1065    13928    3           THEN
     1066    13929    4           DO;
     1067    13930    4               IF P$ = R$
     1068    13931    4               THEN ALTRETURN;
     1069    13932    4               ELSE RETURN;
     1070    13933    4               END;
     1071    13934    3           END;
     1072    13935    2       P$ = PINCRW(P$,-SIZEW(B$EDEF));
     1073    13936    2       RETURN;
     1074    13937    2   END RANGE_END;
     1075    13938        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:34   
     1076    13939    1   SORT_BY_NAME:PROC(EDEFARY);
     1077    13940        %B$EDEF (NAME="EDEFARY(0:0)", STCLASS=);
     1078    14010        %B$EDEF (NAME=TEMP_EDEF, STCLASS=);
     1079    14080    2   DCL EDEFS CHAR(SIZE) BASED ALIGNED;
     1080    14081    2   DCL FLAG UBIN;
     1081    14082    2   DCL SIZE UBIN;
     1082    14083    2       FLAG = 1;
     1083    14084    2       GOTO CMN;
     1084    14085    2   SORT_BY_VALUE: ENTRY (EDEFARY);
     1085    14086    2       FLAG = 0;
     1086    14087    2   CMN: I = TEMP-1;
     1087    14088    3       IF I>0 THEN DO UNTIL I = 0;
     1088    14089    3           I = I - 1;
     1089    14090    3           TEMP_EDEF = EDEFARY(I);
     1090    14091    4   J_LOOP: DO J = I+1 TO TEMP - 1;
     1091    14092    4               IF FLAG = 0 /* Sort by value */
     1092    14093    5               THEN DO;
     1093    14094    5                   IF EDEFARY.ISADDR(J) > TEMP_EDEF.ISADDR
     1094    14095    5                   THEN
     1095    14096    5                       EXIT J_LOOP;
     1096    14097    5                   END;
     1097    14098    4               ELSE /* Sort by name */
     1098    14099    4                   IF PINCRW(DEF$,EDEFARY.NPOINTER(J))->B$DNAME.TEXT >
     1099    14100    4                      PINCRW(DEF$,TEMP_EDEF.NPOINTER)->B$DNAME.TEXT
     1100    14101    4                   THEN
     1101    14102    4                       EXIT J_LOOP;
     1102    14103    4               END J_LOOP;
     1103    14104    3           SIZE = SIZEC(TEMP_EDEF)*(J-I-1);
     1104    14105    4           IF SIZE > 0 THEN DO;
     1105    14106    4               ADDR(EDEFARY(I))->EDEFS = ADDR(EDEFARY(I+1))->EDEFS;
     1106    14107    4               EDEFARY(J-1) = TEMP_EDEF;
     1107    14108    4               END;
     1108    14109    3           END;
     1109    14110    2   END SORT_BY_NAME;
     1110    14111        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:35   
     1111    14112    1   SEARCH_TV:PROC(P$,Q$,R$);
     1112    14113    2   DCL P$ PTR;
     1113    14114    2   DCL Q$ PTR;
     1114    14115    2   DCL R$ PTR;
     1115    14116    2       Q$ = RF_EDEF$;
     1116    14117    3       DO I = 0 TO TEMP - 1;
     1117    14118    3           NAME2$ = PINCRW(R$,Q$->B$EDEF.NPOINTER);
     1118    14119    3           IF NAME2$->B$DNAME.TEXT = P$->B$DNAME.TEXT
     1119    14120    3           THEN RETURN;
     1120    14121    3           ELSE Q$ = PINCRW(Q$,SIZEW(B$EDEF));
     1121    14122    3           END;
     1122    14123    2       CALL CONCAT(LL_DOBUF,'A   *** ',
     1123    14124    2          'There is no transfer vector in ',
     1124    14125    2          LL_VECTOR_RF);
     1125    14126    2       CALL LLM$MON_SVC(LL#WRITEDO);
     1126    14127    2       CALL LLM$MON_SVC(LL#ERR);
     1127    14128    2       RETURN;
     1128    14129    2   END SEARCH_TV;
     1129    14130    1   END LLT$TRANSVECT;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:36   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   LL_MACS_C.:E05TOU  is referenced.
   LL_SUBS_C.:E05TOU  is referenced.
   LL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure LLT$TRANSVECT.

   Procedure LLT$TRANSVECT requires 2027 words for executable code.
   Procedure LLT$TRANSVECT requires 46 words of local(AUTO) storage.

    No errors detected in file LLT$TRANSVECT.:E05TSI    .

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:37   

 Object Unit name= LLT$TRANSVECT                              File name= LLT$TRANSVECT.:E05TOU
 UTS= JUL 30 '97 03:17:46.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    171    253  LLT$TRANSVECT
    2   Data  even  none   416    640  LLT$TRANSVECT
    3   DCB   even  none     0      0  M$TV
    4   DCB   even  none     0      0  M$RF
    5   DCB   even  none     0      0  M$RU
    6   Proc  even  none  2027   3753  LLT$TRANSVECT
    7  RoData even  none    64    100  LLT$TRANSVECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        0  LLT$TRANSVECT
     6      3                  yes      Std        0  LLT$INIT_TV
     6     70                  yes      Std        0  LLT$BUILD_VECTOR
     6   1526                  yes      Std        0  LLT$FINISH_VECTOR
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:38   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 LLM$MON_SVC
         yes           Std       3 LLI$BINHEX
         yes           Std       4 LLW$WRTDEF
         yes           Std       7 LLG$GROW
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  LL_LOBUF                              LL_DOBUF
     LL_FLAGS                              LL_R_CODE$                            LL_ENTDEF_R$
     LL_BOTOMEM$                           LL_TOPOMEM$                           LL_R_OU$
r    LL_LPROC_START                        LL_DNAME_VEC                          LL_VECTOR_RF
     LL_LIST_SIZE                          LL_LIST$                              M$TV
     M$RF                                  M$RU                                  LL_HEAD
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:39   


        1        1        /*M* LLT$TRANSVECT - Process transfer vector for the shared library */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,ENI=4,
        8        8             CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC*/
        9        9        /*F* NAME:       LLT$TRANSVECT
       10       10             PURPOSE:    LLT$TRANSVECT primary function is to process transfer
       11       11                         vecter option for building the shared library.
       12       12                         The VECTOR suboptions are RF, ENTRIES, DATA, REMOVE_E
       13       13                         NTDEFS, REMOVE_SYMDEFS.
       14       14                         RF suboption specifies that transfer vector found in
       15       15                         the file should be used.
       16       16                         DATA suboption specifies the maximun number of words
       17       17                         of static data the linker is to allocate.
       18       18                         REMOVE_ENTDEF and REMOVE_SYMDEF specifies that the
       19       19                         linker remove all ENTDEFS not in the transfer vector
       20       20                         and all SYMDEFS respectively.
       21       21                         ENTRIES option may take one or more argumemts as
       22       22                         follows:
       23       23                           1. an ENTDEF name,
       24       24                           2. a range of ENTDEF names,
       25       25                           3. EMPTY specifies the number of empty slots to
       26       26                              reserve in the transfer vector.
       27       27                                                                             */
       28       28        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:40   
       29       29        LLT$TRANSVECT:PROC ;

     29  6 000000   000000 700200 xent  LLT$TRANSVE* TSX0  ! X66_AUTO_0
         6 000001   000056 000000                    ZERO    46,0
         6 000002   000005 710000 6                  TRA     s:12836

       30       30        %INCLUDE CP_6;
       31     5589        %INCLUDE B$OBJECT_C;
       32     9019        %INCLUDE LL_DATA_R;
       33     9055        %INCLUDE LL_SUBS_C;
       34     9184        %INCLUDE LL_MACS_C;
       35     9538        %INCLUDE B_ERRORS_C;
       36    10665         /* Entries */
       37    10666    1   DCL LLM$MON_SVC ENTRY(4) ALTRET;
       38    10667    1   DCL LLG$GROW ENTRY(7);
       39    10668    1   DCL LLI$BINHEX ENTRY(3);
       40    10669    1   DCL LLW$WRTDEF ENTRY(4);
       41    10670         /* Monitor services */
       42    10671        %FPT_GDS(FPTN = FPT_GDS,
       43    10672         STCLASS = CONSTANT,
       44    10673         SEGSIZE = 1024,
       45    10674         RESULTS = LL_DNAME_VEC);
       46    10690        %FPT_OPEN(FPTN = OPEN_TV,
       47    10691         ACS = DIRECT,
       48    10692         ASN = FILE,
       49    10693         DCB = M$TV,
       50    10694         FUN = CREATE,
       51    10695         NAME = TV_STAR,
       52    10696         ORG = KEYED);
       53    10805        %FPT_CLOSE ( FPTN = CLOSE_TV,
       54    10806         DCB = M$TV,
       55    10807         DISP = SAVE);
       56    10849        %FPT_WRITE(FPTN= WRITE_TV,
       57    10850         DCB = M$TV);
       58    10881
       59    10882        %FPT_FID (FPTN = RUN_FILE,
       60    10883         TEXTFID = LL_VECTOR_RF,
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:41   
       61    10884         SN = VLP_SN,
       62    10885         WSN = VLP_WSN,
       63    10886         RES = OPEN_RF.V.RES#,
       64    10887         ASN = OPEN_RF.V.ASN#,
       65    10888         ACCT = VLP_ACCT,
       66    10889         NAME = VLP_NAME,
       67    10890         PASS = VLP_PASS);
       68    10913
       69    10914        %FPT_OPEN (FPTN = OPEN_RF,
       70    10915         DCB = M$RF,
       71    10916         WSN = VLP_WSN,
       72    10917         SN = VLP_SN,
       73    10918         ORG = KEYED,
       74    10919         PASS = VLP_PASS,
       75    10920         NAME = VLP_NAME,
       76    10921         ACCT = VLP_ACCT,
       77    10922         ASN = FILE,
       78    10923         SCRUB = YES);
       79    11032
       80    11033        %FPT_READ ( FPTN = READ_RF_HEAD,
       81    11034         DCB = M$RF,
       82    11035         KEY = RF_HEAD_KEY,
       83    11036         KEYS = YES,
       84    11037         KEYR = YES);
       85    11076
       86    11077        %FPT_READ (FPTN = READ_RF,
       87    11078         DCB = M$RF,
       88    11079         KEY = NIL,
       89    11080         KEYS = YES,
       90    11081         KEYR = NO,
       91    11082         BUF = NIL,
       92    11083         WAIT = YES);
       93    11122
       94    11123        %FPT_CLOSE (FPTN = CLOSE_RF,
       95    11124         DCB = M$RF);
       96    11166
       97    11167        %VLP_ACCT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:42   
       98    11180        %VLP_PASS;
       99    11193        %VLP_WSN;
      100    11206        %VLP_SN;
      101    11219        %VLP_NAME;
      102    11246        %VLP_NAME ( FPTN= TV_STAR,
      103    11247         NAME = '*TV');
      104    11274
      105    11275         /* DCB */
      106    11276    1   DCL M$TV DCB;
      107    11277    1   DCL M$RF DCB;
      108    11278    1   DCL M$RU DCB;
      109    11279
      110    11280         /* MACROs */
      111    11281        %F$DCB (DCBN = B$DCB,
      112    11282         STCLASS = BASED);
      113    11339        %B$RECORDSUBS;
      114    11367        %B$SECTIONSUBS;
      115    11382        %SUB_LINKFLAGS;
      116    11391         /*%EQU PGSZ = 2048;*/
      117    11392        %B$DNAME ( NAME = TRANS_VEC_NAME,
      118    11393         STCLASS = CONSTANT,
      119    11394         TEXT = '<Transfer_vector>' );
      120    11413
      121    11414        %B$DNAME ( NAME = TV_START_NAME,
      122    11415         STCLASS = CONSTANT,
      123    11416         TEXT = '_TV_ST');
      124    11435
      125    11436        %B$DNAME ( NAME = TV_END_NAME,
      126    11437         STCLASS = CONSTANT,
      127    11438         TEXT = '_TV_EN');
      128    11457
      129    11458         %B$OUHEAD ( STCLASS = BASED);
      130    11576
      131    11577        %B$PRGRELKEY(NAME = ENTREF_RELOC_KEY,
      132    11578         STCLASS = STATIC);
      133    11609
      134    11610        %B$PRGRELKEY(NAME = REPEAT_TV_RELOC_KEY,
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:43   
      135    11611         STCLASS = STATIC);
      136    11642
      137    11643        %B$RELOC2 ( NAME = BRK_SLOT,
      138    11644         STCLASS = STATIC);
      139    11711
      140    11712        %B$RELOC2 ( NAME = ENTREF_RELOC,
      141    11713         STCLASS = STATIC);
      142    11780
      143    11781        %B$RELOC2 ;
      144    11848
      145    11849        %B$RELOC2 ( NAME = REPEAT_TV_RELOC,
      146    11850         STCLASS = STATIC);
      147    11917
      148    11918        %B$RUHEADKEY(NAME = RF_HEAD_KEY,
      149    11919         STCLASS = STATIC);
      150    11926
      151    11927        %B$HEAD (NAME = RF_HEAD,
      152    11928         STCLASS = STATIC,
      153    11929         SUBS = NO);
      154    12129
      155    12130        %B$FEP_RUKEY(NAME = B$RUKEY,
      156    12131         STCLASS = STATIC );
      157    12155        %B$DNAME;
      158    12174        %B$SDEF;
      159    12228        %B$EDEF;
      160    12298        %B$HEAD (NAME = LL_HEAD,
      161    12299         STCLASS = SYMREF);
      162    12499        %LL$NODE (NAME=TREE);
      163    12531        %LL$SECT_ENTRY (NAME=SECT_ENTRY);
      164    12564        %LL$OU_ENTRY (NAME=OU_ENTRY,
      165    12565         STCLASS = BASED);
      166    12613        %B$SECTION (NAME=LL_SECTION);
      167    12672    1   DCL 1 TV_DEF_NAMES CONSTANT ALIGNED,
      168    12673    1         2 TV_START_NAME,
      169    12674    1           3 * UBIN HALF UNAL INIT(6),
      170    12675    1           3 * CHAR(6) INIT ('_TV_ST'),
      171    12676    1         2 TV_END_NAME,
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:44   
      172    12677    1           3 * UBIN HALF UNAL INIT(6),
      173    12678    1           3 * CHAR(6) INIT ('_TV_EN'),
      174    12679    1         2 T_VECTOR,
      175    12680    1           3 * UBIN HALF UNAL INIT(17),
      176    12681    1           3 * CHAR(18) INIT ('<Transfer vector>');
      177    12682
      178    12683    1   DCL 1 TV_EDEF STATIC ALIGNED,
      179    12684    1         2 TV_START,
      180    12685    1           3 LFLAGS UBIN BYTE UNAL INIT(0),
      181    12686    1           3 OU UNAL,
      182    12687    1             4 SECTNUM UBIN BYTE UNAL INIT(0),
      183    12688    1             4 OFFSET UBIN HALF UNAL INIT(0),
      184    12689    1           3 ISADDR REDEF OU UBIN(27) UNAL,
      185    12690    1           3 NPOINTER UBIN HALF UNAL INIT(0),
      186    12691    1           3 PRI BIT(1) UNAL INIT('1'B),
      187    12692    1           3 ALT BIT(1) UNAL INIT('0'B),
      188    12693    1           3 CHECK BIT(1) UNAL INIT('0'B),
      189    12694    1           3 CST UBIN(4) UNAL INIT(15),
      190    12695    1           3 NPARAM UBIN(11) UNAL INIT(0),
      191    12696    1         2 TV_END,
      192    12697    1           3 LFLAGS UBIN BYTE UNAL INIT(0),
      193    12698    1           3 OU UNAL,
      194    12699    1             4 SECTNUM UBIN BYTE UNAL INIT(0),
      195    12700    1             4 OFFSET UBIN HALF UNAL INIT(0),
      196    12701    1           3 ISADDR REDEF OU UBIN(27) UNAL,
      197    12702    1           3 NPOINTER UBIN HALF UNAL INIT(2),
      198    12703    1           3 PRI BIT(1) UNAL INIT('0'B),
      199    12704    1           3 ALT BIT(1) UNAL INIT('0'B),
      200    12705    1           3 CHECK BIT(1) UNAL INIT('0'B),
      201    12706    1           3 CST UBIN(4) UNAL INIT(15),
      202    12707    1           3 NPARAM UBIN(11) UNAL INIT(0);
      203    12708
      204    12709    1   DCL 1 TV_SECTION STATIC ALIGNED,
      205    12710    1         2 TYPE UBIN BYTE UNAL INIT(1),
      206    12711    1         2 * BIT(1) INIT('0'B),
      207    12712    1         2 INITZ BIT(1) UNAL INIT('0'B),
      208    12713    1         2 INITUTS BIT(1) UNAL INIT('0'B),
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:45   
      209    12714    1         2 SEGMENT BIT(1) INIT('0'B),
      210    12715    1         2 * BIT(3) INIT('0'B),
      211    12716    1         2 BOUND UBIN(2) UNAL INIT(0),
      212    12717    1         2 SIZE UBIN HALF UNAL INIT(0),
      213    12718    1         2 NPOINTER SBIN HALF UNAL INIT(4),
      214    12719    1         2 * UBIN HALF UNAL INIT(0);
      215    12720
      216    12721    1   DCL 1 TV_HEAD STATIC ALIGNED,
      217    12722    1         2 UTS UBIN(36) UNAL INIT(0),
      218    12723    1         2 WORDSIZE UBIN BYTE UNAL INIT(16),
      219    12724    1         2 COMPID UBIN(27) UNAL INIT(0),
      220    12725    1         2 START,
      221    12726    1           3 OPNDTYP UBIN(4) UNAL INIT(0),
      222    12727    1           3 * BIT (5) UNAL INIT('0'B),
      223    12728    1           3 OPERAND UBIN(9) UNAL INIT(0),
      224    12729    1           3 OFFSET UBIN(18) UNAL INIT(0),
      225    12730    1         2 SEVLEV UBIN(18) UNAL INIT(0),
      226    12731    1         2 LOGBSIZ UBIN(18) UNAL INIT(0),
      227    12732    1         2 PROSIZE UBIN(18) UNAL INIT(0),
      228    12733    1         2 RELPSIZ UBIN(18) UNAL INIT(0),
      229    12734    1         2 DNAMSIZ UBIN(18) UNAL INIT(SIZEW(TV_DEF_NAMES)),
      230    12735    1         2 DNAMPSIZ UBIN(18) UNAL INIT(100),
      231    12736    1         2 RNAMSIZ UBIN(18) UNAL INIT(0),
      232    12737    1         2 RNAMPSIZ UBIN(18) UNAL INIT(0),
      233    12738    1         2 EDEFSIZ UBIN(18) UNAL INIT(SIZEW(TV_EDEF)),
      234    12739    1         2 EDEFPSIZ UBIN(18) UNAL INIT(SIZEW(TV_EDEF)),
      235    12740    1         2 EREFSIZ UBIN(18) UNAL INIT(0),
      236    12741    1         2 EREFPSIZ UBIN(18) UNAL INIT(0),
      237    12742    1         2 SDEFSIZE UBIN(18) UNAL INIT(0),
      238    12743    1         2 SDEFPSIZE UBIN(18) UNAL INIT(0),
      239    12744    1         2 SREFSIZE UBIN(18) UNAL INIT(0),
      240    12745    1         2 SREFPSIZE UBIN(18) UNAL INIT(0),
      241    12746    1         2 SEGDEFSIZ UBIN(18) UNAL INIT(0),
      242    12747    1         2 SEGDEFPSIZ UBIN(18) UNAL INIT(0),
      243    12748    1         2 SEGREFSIZ UBIN(18) UNAL INIT(0),
      244    12749    1         2 SEGREFPSIZ UBIN(18) UNAL INIT(0),
      245    12750    1         2 LIB,
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:46   
      246    12751    1           3 COUNT UBIN(9) UNAL INIT(0),
      247    12752    1           3 LNAM CHAR(31) UNAL INIT(' '),
      248    12753    1         2 ALIB,
      249    12754    1           3 COUNT UBIN(9) UNAL INIT(0),
      250    12755    1           3 ANAM CHAR(31) UNAL INIT(' ');
      251    12756
      252    12757    1   DCL 1 TV_MSG STATIC,
      253    12758    1         2 MSG ,
      254    12759    1           3 * CHAR(1) INIT('A'),
      255    12760    1           3 * CHAR(3) INIT(' '),
      256    12761    1           3 ADDR1 CHAR(6) INIT(' '),
      257    12762    1           3 * CHAR(1) INIT(' '),
      258    12763    1           3 NAME1 CHAR(31) INIT(' '),
      259    12764    1           3 * CHAR(4) INIT(' -> '),
      260    12765    1           3 ADDR2 CHAR(6) INIT(' '),
      261    12766    1           3 * CHAR(1) INIT(' '),
      262    12767    1           3 NAME2 CHAR(32) INIT(' '),
      263    12768    1         2 BUFFER REDEF MSG CHAR(85);
      264    12769
      265    12770    1   DCL 1 BUFFER STATIC,
      266    12771    1         2 ONE,
      267    12772    1           3 * CHAR(1) INIT('A'),
      268    12773    1           3 TEXT CHAR(79) INIT(' '),
      269    12774    1         2 TWO REDEF ONE CHAR(80);
      270    12775
      271    12776    1   DCL 1 EMPTY_MSG STATIC,
      272    12777    1         2 MSG ,
      273    12778    1           3 * CHAR(1) INIT('A'),
      274    12779    1           3 * CHAR(3) INIT(' '),
      275    12780    1           3 ADDR1 CHAR(6) INIT(' '),
      276    12781    1           3 * CHAR(0) INIT(' Empty slot'),
      277    12782    1         2 BUFFER REDEF MSG CHAR(21);
      278    12783
      279    12784    1   DCL 1 TV_HEAD_KEY STATIC ALIGNED,
      280    12785    1         2 COUNT UBIN BYTE UNAL INIT(7),
      281    12786    1         2 TEXT CHAR(9) INIT('"_TV_ST');
      282    12787
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:47   
      283    12788    1   DCL 1 TV_OU_KEY STATIC ALIGNED,
      284    12789    1         2 KEYSIZ UBIN BYTE UNAL INIT(7),
      285    12790    1         2 * BIT(9) UNAL INIT('777'O),
      286    12791    1         2 UTS UBIN UNAL INIT(0),
      287    12792    1         2 TYPE UBIN BYTE UNAL,
      288    12793    1         2 PAGE UBIN BYTE UNAL INIT(0);
      289    12794    1   DCL I UBIN;
      290    12795    1   DCL J UBIN;
      291    12796    1   DCL RF_DEF_SIZE UBIN WORD;
      292    12797    1   DCL RF_EDEF_SIZE UBIN;
      293    12798    1   DCL TEMP UBIN;
      294    12799    1   DCL N_DEFS UBIN;
      295    12800    1   DCL N_DEFNS UBIN;
      296    12801    1   DCL OFFSET UBIN STATIC INIT(0);
      297    12802    1   DCL 1 VECTOR_LIST BASED ALIGNED,
      298    12803    1         2 SIZEW1 UBIN HALF UNAL,
      299    12804    1         2 SIZEW2 UBIN HALF UNAL;
      300    12805    1   DCL NEXT UBIN;
      301    12806    1   DCL 1 TEMP_EDEF ALIGNED,
      302    12807    1         2 WORDS(0:1) UBIN WORD UNAL;
      303    12808    1   DCL REF_SIZE UBIN STATIC INIT(0);
      304    12809    1   DCL EREF_SIZE UBIN STATIC INIT(0);
      305    12810         /* PTRs */
      306    12811    1   DCL AVAIL$ PTR;
      307    12812    1   DCL DEF$ PTR STATIC INIT(ADDR(NIL));
      308    12813    1   DCL EREF$ PTR STATIC INIT(ADDR(NIL));
      309    12814    1   DCL TPTR1$ PTR STATIC INIT(ADDR(NIL));
      310    12815    1   DCL TPTR2$ PTR STATIC INIT(ADDR(NIL));
      311    12816    1   DCL REF$ PTR STATIC INIT(ADDR(NIL));
      312    12817    1   DCL RF_DEF$ PTR;
      313    12818    1   DCL RF_EDEF$ PTR;
      314    12819    1   DCL START$ PTR;
      315    12820    1   DCL TPTR$ PTR;
      316    12821    1   DCL NAME1$ PTR;
      317    12822    1   DCL NAME2$ PTR;
      318    12823    1   DCL LIST$ PTR;
      319    12824    1   DCL BEGIN$ PTR;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:48   
      320    12825    1   DCL END$ PTR;
      321    12826    1   DCL NAME$ PTR;
      322    12827    1   DCL STOP$ PTR;
      323    12828    1   DCL TPTR3$ PTR;
      324    12829    1   DCL MEM$ PTR;
      325    12830
      326    12831        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:49   
      327    12832    1   LLT$INIT_TV:ENTRY ;

  12832  6 000003   000000 700200 xent  LLT$INIT_TV  TSX0  ! X66_AUTO_0
         6 000004   000056 000000                    ZERO    46,0

      328    12833         /**/
      329    12834         /*     Create the transfer vector file. */
      330    12835         /**/
      331    12836    1       CALL M$OPEN(OPEN_TV) ALTRET(ERROR);

  12836  6 000005   000000 630400 2                  EPPR0   OPEN_TV
         6 000006   450000 713400                    CLIMB   alt,open
         6 000007   410400 401760                    pmme    nvectors=18
         6 000010   003037 702000 6                  TSX2    ERROR

      332    12837    1       WRITE_TV.KEY_ = VECTOR(TV_OU_KEY);

  12837  6 000011   000000 237000 7                  LDAQ    0
         6 000012   000132 757000 2                  STAQ    WRITE_TV+2

      333    12838         /**/
      334    12839    1       TV_OU_KEY.TYPE = %TYPDNAM;

  12839  6 000013   001000 236007                    LDQ     512,DL
         6 000014   000627 552010 2                  STBQ    TV_OU_KEY+1,'10'O

      335    12840    1       WRITE_TV.BUF_.BUF$ = ADDR(TV_DEF_NAMES);

  12840  6 000015   000002 236000 7                  LDQ     2
         6 000016   000135 756000 2                  STQ     WRITE_TV+5

      336    12841    1       WRITE_TV.BUF_.BOUND = SIZEW(TV_DEF_NAMES) * 4 -1;

  12841  6 000017   000134 236000 2                  LDQ     WRITE_TV+4
         6 000020   177777 376007                    ANQ     65535,DL
         6 000021   000003 276000 7                  ORQ     3
         6 000022   000134 756000 2                  STQ     WRITE_TV+4
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:50   

      337    12842    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  12842  6 000023   000130 630400 2                  EPPR0   WRITE_TV
         6 000024   440001 713400                    CLIMB   alt,write
         6 000025   401400 401760                    pmme    nvectors=4
         6 000026   003037 702000 6                  TSX2    ERROR

      338    12843         /**/
      339    12844    1       TV_OU_KEY.TYPE = %TYPSECT;

  12844  6 000027   003000 236007                    LDQ     1536,DL
         6 000030   000627 552010 2                  STBQ    TV_OU_KEY+1,'10'O

      340    12845    1       WRITE_TV.BUF_ = VECTOR(TV_SECTION);

  12845  6 000031   000004 237000 7                  LDAQ    4
         6 000032   000134 757000 2                  STAQ    WRITE_TV+4

      341    12846    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  12846  6 000033   000130 630400 2                  EPPR0   WRITE_TV
         6 000034   440001 713400                    CLIMB   alt,write
         6 000035   401400 401760                    pmme    nvectors=4
         6 000036   003037 702000 6                  TSX2    ERROR

      342    12847         /**/
      343    12848    1       TV_OU_KEY.TYPE = %TYPEDEF;

  12848  6 000037   004000 236007                    LDQ     2048,DL
         6 000040   000627 552010 2                  STBQ    TV_OU_KEY+1,'10'O

      344    12849    1       WRITE_TV.BUF_ = VECTOR(TV_EDEF);

  12849  6 000041   000006 237000 7                  LDAQ    6
         6 000042   000134 757000 2                  STAQ    WRITE_TV+4

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:51   
      345    12850    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  12850  6 000043   000130 630400 2                  EPPR0   WRITE_TV
         6 000044   440001 713400                    CLIMB   alt,write
         6 000045   401400 401760                    pmme    nvectors=4
         6 000046   003037 702000 6                  TSX2    ERROR

      346    12851         /**/
      347    12852         /* Build head record for transfer vector ou file */
      348    12853         /**/
      349    12854
      350    12855    1       WRITE_TV.KEY_ = VECTOR(TV_HEAD_KEY);

  12855  6 000047   000010 237000 7                  LDAQ    8
         6 000050   000132 757000 2                  STAQ    WRITE_TV+2

      351    12856    1       WRITE_TV.BUF_.BUF$ = ADDR(TV_HEAD);

  12856  6 000051   000012 236000 7                  LDQ     10
         6 000052   000135 756000 2                  STQ     WRITE_TV+5

      352    12857    1       WRITE_TV.BUF_.BOUND = SIZEW(TV_HEAD) * 4 - 1;

  12857  6 000053   000134 236000 2                  LDQ     WRITE_TV+4
         6 000054   177777 376007                    ANQ     65535,DL
         6 000055   000013 276000 7                  ORQ     11
         6 000056   000134 756000 2                  STQ     WRITE_TV+4

      353    12858    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  12858  6 000057   000130 630400 2                  EPPR0   WRITE_TV
         6 000060   440001 713400                    CLIMB   alt,write
         6 000061   401400 401760                    pmme    nvectors=4
         6 000062   003037 702000 6                  TSX2    ERROR

      354    12859    1       CALL M$CLOSE(CLOSE_TV) ALTRET(ERROR);

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:52   
  12859  6 000063   000072 630400 2                  EPPR0   CLOSE_TV
         6 000064   450001 713400                    CLIMB   alt,close
         6 000065   406000 401760                    pmme    nvectors=13
         6 000066   003037 702000 6                  TSX2    ERROR

      355    12860    1       RETURN;

  12860  6 000067   000000 702200 xent               TSX2  ! X66_ARET

      356    12861        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:53   
      357    12862    1   LLT$BUILD_VECTOR:ENTRY;

  12862  6 000070   000000 700200 xent  LLT$BUILD_V* TSX0  ! X66_AUTO_0
         6 000071   000056 000000                    ZERO    46,0

      358    12863         /**/
      359    12864         /* Initialize all relocation key and record */
      360    12865         /**/
      361    12866
      362    12867    1       REPEAT_TV_RELOC_KEY.KEYSIZ = 12;

  12867  6 000072   014000 236003                    LDQ     6144,DU
         6 000073   000407 552040 2                  STBQ    REPEAT_TV_RELOC_KEY,'40'O

      363    12868    1       REPEAT_TV_RELOC_KEY.SECTNUM = 0;

  12868  6 000074   000000 101400                    MRL     fill='000'O
         6 000075   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         6 000076   000410 600002 2                  ADSC9   REPEAT_TV_RELOC_KEY+1    cn=3,n=2

      364    12869    1       REPEAT_TV_RELOC_KEY.OFFSET = 0;

  12869  6 000077   000000 236003                    LDQ     0,DU
         6 000100   000411 552030 2                  STBQ    REPEAT_TV_RELOC_KEY+2,'30'O

      365    12870    1       REPEAT_TV_RELOC_KEY.SUBTYPE = 1;

  12870  6 000101   000001 236007                    LDQ     1,DL
         6 000102   000411 552004 2                  STBQ    REPEAT_TV_RELOC_KEY+2,'04'O

      366    12871    1       REPEAT_TV_RELOC_KEY.SEQUENCE = 0;

  12871  6 000103   000412 450000 2                  STZ     REPEAT_TV_RELOC_KEY+3

      367    12872    1       REPEAT_TV_RELOC_KEY.UTS = 0;

  12872  6 000104   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:54   
         6 000105   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         6 000106   000407 400004 2                  ADSC9   REPEAT_TV_RELOC_KEY      cn=2,n=4

      368    12873         /**/
      369    12874         /* Build the key for ENTREF relocation record */
      370    12875         /**/
      371    12876
      372    12877    1       ENTREF_RELOC_KEY = REPEAT_TV_RELOC_KEY;

  12877  6 000107   000000 100400                    MLR     fill='000'O
         6 000110   000407 000015 2                  ADSC9   REPEAT_TV_RELOC_KEY      cn=0,n=13
         6 000111   000403 000015 2                  ADSC9   ENTREF_RELOC_KEY         cn=0,n=13

      373    12878    1       ENTREF_RELOC_KEY.SEQUENCE = 1;

  12878  6 000112   001000 236003                    LDQ     512,DU
         6 000113   000406 756000 2                  STQ     ENTREF_RELOC_KEY+3

      374    12879         /**/
      375    12880         /* Build branch instruction */
      376    12881         /**/
      377    12882
      378    12883    1       BRK_SLOT = '0'B;

  12883  6 000114   000000 100400                    MLR     fill='000'O
         6 000115   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 000116   000413 000014 2                  ADSC9   BRK_SLOT                 cn=0,n=12

      379    12884    1       BRK_SLOT.OPNDTYP = 4;

  12884  6 000117   000413 236000 2                  LDQ     BRK_SLOT
         6 000120   000014 376000 7                  ANQ     12
         6 000121   002000 276003                    ORQ     1024,DU
         6 000122   000413 756000 2                  STQ     BRK_SLOT

      380    12885    1       BRK_SLOT.EVALOP = 7;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:55   
  12885  6 000123   000413 236000 2                  LDQ     BRK_SLOT
         6 000124   000015 376000 7                  ANQ     13
         6 000125   000160 276003                    ORQ     112,DU
         6 000126   000413 756000 2                  STQ     BRK_SLOT

      381    12886    1       BRK_SLOT.RELOCOP = 14;

  12886  6 000127   000413 236000 2                  LDQ     BRK_SLOT
         6 000130   000016 376000 7                  ANQ     14
         6 000131   000016 276003                    ORQ     14,DU
         6 000132   000413 756000 2                  STQ     BRK_SLOT

      382    12887    1       BRK_SLOT.OPERAND = 1;

  12887  6 000133   000001 220003                    LDX0    1,DU
         6 000134   000413 440000 2                  SXL0    BRK_SLOT

      383    12888    1       BRK_SLOT.ENDBIT = 15;

  12888  6 000135   000017 236007                    LDQ     15,DL
         6 000136   000414 552004 2                  STBQ    BRK_SLOT+1,'04'O

      384    12889    1       BRK_SLOT.VALUE = BITBIN('0F80'X); /* B   instruction */

  12889  6 000137   007600 235007                    LDA     3968,DL
         6 000140   000415 755000 2                  STA     BRK_SLOT+2

      385    12890         /**/
      386    12891         /* Build the ENTREF relocation directive to branch to right address */
      387    12892         /**/
      388    12893
      389    12894    1       ENTREF_RELOC = '0'B;

  12894  6 000141   000000 100400                    MLR     fill='000'O
         6 000142   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 000143   000416 000014 2                  ADSC9   ENTREF_RELOC             cn=0,n=12

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:56   
      390    12895    1       ENTREF_RELOC.OPNDTYP = 2; /* ENTREF */

  12895  6 000144   000416 236000 2                  LDQ     ENTREF_RELOC
         6 000145   000014 376000 7                  ANQ     12
         6 000146   001000 276003                    ORQ     512,DU
         6 000147   000416 756000 2                  STQ     ENTREF_RELOC

      391    12896    1       ENTREF_RELOC.RELOCOP = 14;

  12896  6 000150   000416 236000 2                  LDQ     ENTREF_RELOC
         6 000151   000016 376000 7                  ANQ     14
         6 000152   000016 276003                    ORQ     14,DU
         6 000153   000416 756000 2                  STQ     ENTREF_RELOC

      392    12897    1       ENTREF_RELOC.ENDBIT = 31;

  12897  6 000154   000037 236007                    LDQ     31,DL
         6 000155   000417 552004 2                  STBQ    ENTREF_RELOC+1,'04'O

      393    12898         /**/
      394    12899         /* Build relocation directive to fill out control section with BRK instruction */
      395    12900         /**/
      396    12901
      397    12902    1       REPEAT_TV_RELOC = '0'B;

  12902  6 000156   000000 100400                    MLR     fill='000'O
         6 000157   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 000160   000421 000014 2                  ADSC9   REPEAT_TV_RELOC          cn=0,n=12

      398    12903    1       REPEAT_TV_RELOC.OPNDTYP = 4 ; /* CONSTANT */

  12903  6 000161   000421 236000 2                  LDQ     REPEAT_TV_RELOC
         6 000162   000014 376000 7                  ANQ     12
         6 000163   002000 276003                    ORQ     1024,DU
         6 000164   000421 756000 2                  STQ     REPEAT_TV_RELOC

      399    12904    1       REPEAT_TV_RELOC.EVALOP = 7; /* REPEAT */
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:57   

  12904  6 000165   000421 236000 2                  LDQ     REPEAT_TV_RELOC
         6 000166   000015 376000 7                  ANQ     13
         6 000167   000160 276003                    ORQ     112,DU
         6 000170   000421 756000 2                  STQ     REPEAT_TV_RELOC

      400    12905    1       REPEAT_TV_RELOC.RELOCOP = 14 ;

  12905  6 000171   000421 236000 2                  LDQ     REPEAT_TV_RELOC
         6 000172   000016 376000 7                  ANQ     14
         6 000173   000016 276003                    ORQ     14,DU
         6 000174   000421 756000 2                  STQ     REPEAT_TV_RELOC

      401    12906    1       REPEAT_TV_RELOC.ENDBIT = 15;

  12906  6 000175   000017 236007                    LDQ     15,DL
         6 000176   000422 552004 2                  STBQ    REPEAT_TV_RELOC+1,'04'O

      402    12907    1       REPEAT_TV_RELOC.VALUE = BITBIN('0002'X); /* BRK INSTRUCTION */

  12907  6 000177   000002 235007                    LDA     2,DL
         6 000200   000423 755000 2                  STA     REPEAT_TV_RELOC+2

      403    12908         /**/
      404    12909         /* Open transfer vector file and process VECTOR options */
      405    12910         /**/
      406    12911    1       N_DEFS = LL_HEAD.EPRECSIZE;

  12911  6 000201   000007 235000 xsym               LDA     LL_HEAD+7
         6 000202   000022 771000                    ARL     18
         6 000203   200011 755100                    STA     N_DEFS,,AUTO

      407    12912    1       N_DEFNS = LL_HEAD.NRECSIZE;

  12912  6 000204   000006 236000 xsym               LDQ     LL_HEAD+6
         6 000205   777777 376007                    ANQ     -1,DL
         6 000206   200012 756100                    STQ     N_DEFNS,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:58   

      408    12913
      409    12914    1       OPEN_TV.V.FUN# = 1;

  12914  6 000207   001000 236007                    LDQ     512,DL
         6 000210   000045 552010 2                  STBQ    OPEN_TV+37,'10'O

      410    12915    1       CALL M$OPEN(OPEN_TV) ALTRET(ERROR);

  12915  6 000211   000000 630400 2                  EPPR0   OPEN_TV
         6 000212   450000 713400                    CLIMB   alt,open
         6 000213   410400 401760                    pmme    nvectors=18
         6 000214   003037 702000 6                  TSX2    ERROR

      411    12916    1       AVAIL$ = LL_TOPOMEM$;

  12916  6 000215   000000 236000 xsym               LDQ     LL_TOPOMEM$
         6 000216   200016 756100                    STQ     AVAIL$,,AUTO

      412    12917         /**/
      413    12918         /* Allocate memory for ENTDEF */
      414    12919         /**/
      415    12920    1       CALL LLM$MON_SVC(LL#GETMEM,N_DEFS*6,AVAIL$);

  12920  6 000217   200011 236100                    LDQ     N_DEFS,,AUTO
         6 000220   000006 402007                    MPY     6,DL
         6 000221   200042 756100                    STQ     SIZE+1,,AUTO
         6 000222   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 000223   200045 450500                    STP0    SIZE+4,,AUTO
         6 000224   200042 631500                    EPPR1   SIZE+1,,AUTO
         6 000225   200044 451500                    STP1    SIZE+3,,AUTO
         6 000226   000017 236000 7                  LDQ     15
         6 000227   200043 756100                    STQ     SIZE+2,,AUTO
         6 000230   200043 630500                    EPPR0   SIZE+2,,AUTO
         6 000231   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000232   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000233   000000 011000                    NOP     0
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:59   

      416    12921    1       MEM$ = AVAIL$;

  12921  6 000234   200016 236100                    LDQ     AVAIL$,,AUTO
         6 000235   200033 756100                    STQ     MEM$,,AUTO

      417    12922    1       AVAIL$ = PINCRW(AVAIL$,N_DEFS*6);

  12922  6 000236   200011 236100                    LDQ     N_DEFS,,AUTO
         6 000237   000006 402003                    MPY     6,DU
         6 000240   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 000241   200016 756100                    STQ     AVAIL$,,AUTO

      418    12923
      419    12924         /**/
      420    12925         /* Get the DEF record from the target run unit */
      421    12926         /**/
      422    12927
      423    12928    1       DEF$ = LL_DNAME_VEC.P$;

  12928  6 000242   000001 236000 xsym               LDQ     LL_DNAME_VEC+1
         6 000243   000633 756000 2                  STQ     DEF$

      424    12929         /**/
      425    12930         /* Allocate the memory for relocation record */
      426    12931         /**/
      427    12932
      428    12933    1       CALL LLM$MON_SVC(LL#GETMEM,N_DEFS*6,AVAIL$);

  12933  6 000244   200011 236100                    LDQ     N_DEFS,,AUTO
         6 000245   000006 402007                    MPY     6,DL
         6 000246   200042 756100                    STQ     SIZE+1,,AUTO
         6 000247   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 000250   200045 450500                    STP0    SIZE+4,,AUTO
         6 000251   200042 631500                    EPPR1   SIZE+1,,AUTO
         6 000252   200044 451500                    STP1    SIZE+3,,AUTO
         6 000253   000017 236000 7                  LDQ     15
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:60   
         6 000254   200043 756100                    STQ     SIZE+2,,AUTO
         6 000255   200043 630500                    EPPR0   SIZE+2,,AUTO
         6 000256   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000257   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000260   000000 011000                    NOP     0

      429    12934    1       TPTR$ = AVAIL$;

  12934  6 000261   200016 236100                    LDQ     AVAIL$,,AUTO
         6 000262   200022 756100                    STQ     TPTR$,,AUTO

      430    12935    1       START$ = AVAIL$;

  12935  6 000263   200021 756100                    STQ     START$,,AUTO

      431    12936    1       AVAIL$ = PINCRW(AVAIL$,N_DEFS*6);

  12936  6 000264   200011 236100                    LDQ     N_DEFS,,AUTO
         6 000265   000006 402003                    MPY     6,DU
         6 000266   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 000267   200016 756100                    STQ     AVAIL$,,AUTO

      432    12937    1       TV_HEAD.RELPSIZ = N_DEFS * 6;

  12937  6 000270   200011 236100                    LDQ     N_DEFS,,AUTO
         6 000271   000006 402007                    MPY     6,DL
         6 000272   000000 620006                    EAX0    0,QL
         6 000273   000512 440000 2                  SXL0    TV_HEAD+4

      433    12938    1       LL_R_OU$ -> OU_ENTRY.HEAD$ -> B$OUHEAD.RELPSIZ = TV_HEAD.RELPSIZ;

  12938  6 000274   000000 470400 xsym               LDP0    LL_R_OU$
         6 000275   000013 471500                    LDP1    11,,PR0
         6 000276   100004 440100                    SXL0    4,,PR1

      434    12939    1       CALL LLM$MON_SVC(LL#GETMEM,N_DEFS,AVAIL$);

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:61   
  12939  6 000277   200016 631500                    EPPR1   AVAIL$,,AUTO
         6 000300   200044 451500                    STP1    SIZE+3,,AUTO
         6 000301   200011 633500                    EPPR3   N_DEFS,,AUTO
         6 000302   200043 453500                    STP3    SIZE+2,,AUTO
         6 000303   000017 236000 7                  LDQ     15
         6 000304   200042 756100                    STQ     SIZE+1,,AUTO
         6 000305   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 000306   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000307   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000310   000000 011000                    NOP     0

      435    12940    1       EREF$ = AVAIL$;

  12940  6 000311   200016 236100                    LDQ     AVAIL$,,AUTO
         6 000312   000634 756000 2                  STQ     EREF$

      436    12941    1       TPTR1$ = AVAIL$;

  12941  6 000313   000635 756000 2                  STQ     TPTR1$

      437    12942    1       AVAIL$ = PINCRW(AVAIL$,N_DEFS);

  12942  6 000314   200011 236100                    LDQ     N_DEFS,,AUTO
         6 000315   000022 736000                    QLS     18
         6 000316   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 000317   200016 756100                    STQ     AVAIL$,,AUTO

      438    12943    1       CALL LLM$MON_SVC(LL#GETMEM,N_DEFNS+N_DEFS,AVAIL$);

  12943  6 000320   200012 236100                    LDQ     N_DEFNS,,AUTO
         6 000321   200011 036100                    ADLQ    N_DEFS,,AUTO
         6 000322   200042 756100                    STQ     SIZE+1,,AUTO
         6 000323   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 000324   200045 450500                    STP0    SIZE+4,,AUTO
         6 000325   200042 631500                    EPPR1   SIZE+1,,AUTO
         6 000326   200044 451500                    STP1    SIZE+3,,AUTO
         6 000327   000017 236000 7                  LDQ     15
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:62   
         6 000330   200043 756100                    STQ     SIZE+2,,AUTO
         6 000331   200043 630500                    EPPR0   SIZE+2,,AUTO
         6 000332   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000333   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000334   000000 011000                    NOP     0

      439    12944    1       REF$ = AVAIL$;

  12944  6 000335   200016 236100                    LDQ     AVAIL$,,AUTO
         6 000336   000637 756000 2                  STQ     REF$

      440    12945    1       TPTR2$ = AVAIL$;

  12945  6 000337   000636 756000 2                  STQ     TPTR2$

      441    12946    1       AVAIL$ = PINCRW(AVAIL$,N_DEFNS+N_DEFS);

  12946  6 000340   200012 236100                    LDQ     N_DEFNS,,AUTO
         6 000341   200011 036100                    ADLQ    N_DEFS,,AUTO
         6 000342   000022 736000                    QLS     18
         6 000343   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 000344   200016 756100                    STQ     AVAIL$,,AUTO

      442    12947         /**/
      443    12948         /* Process RF option */
      444    12949         /**/
      445    12950
      446    12951    1       IF LL_FLAGS.RF# THEN

  12951  6 000345   000000 236000 xsym               LDQ     LL_FLAGS
         6 000346   000010 316007                    CANQ    8,DL
         6 000347   001011 600000 6                  TZE     s:13075

      447    12952    2       DO;

      448    12953    2           CALL M$FID(RUN_FILE);

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:63   
  12953  6 000350   000144 630400 2                  EPPR0   RUN_FILE
         6 000351   020001 713400                    CLIMB   8193
         6 000352   404400 401760                    pmme    nvectors=10

      449    12954    2           CALL M$OPEN(OPEN_RF) ALTRET(ERROR);

  12954  6 000353   000174 630400 2                  EPPR0   OPEN_RF
         6 000354   450000 713400                    CLIMB   alt,open
         6 000355   410400 401760                    pmme    nvectors=18
         6 000356   003037 702000 6                  TSX2    ERROR

      450    12955         /**/
      451    12956         /* Read run file head record for RF option */
      452    12957         /**/
      453    12958
      454    12959    2           READ_RF_HEAD.BUF_.BUF$ = ADDR(RF_HEAD);

  12959  6 000357   000020 236000 7                  LDQ     16
         6 000360   000273 756000 2                  STQ     READ_RF_HEAD+5

      455    12960    2           READ_RF_HEAD.BUF_.BOUND = SIZEC(RF_HEAD);

  12960  6 000361   000272 236000 2                  LDQ     READ_RF_HEAD+4
         6 000362   177777 376007                    ANQ     65535,DL
         6 000363   000050 276003                    ORQ     40,DU
         6 000364   000272 756000 2                  STQ     READ_RF_HEAD+4

      456    12961    2           CALL M$READ(READ_RF_HEAD)

  12961  6 000365   000266 630400 2                  EPPR0   READ_RF_HEAD
         6 000366   440000 713400                    CLIMB   alt,read
         6 000367   401400 401760                    pmme    nvectors=4
         6 000370   000372 702000 6                  TSX2    s:12963
         6 000371   000417 710000 6                  TRA     s:12973

      457    12962    3           WHENALTRETURN DO;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:64   
      458    12963    3               CALL INSERT(LL_DOBUF,0,,'A  *** Unable to read head record for ',
             12963                        LL_VECTOR_RF);

  12963  6 000372   040000 100400                    MLR     fill='040'O
         6 000373   000030 000046 1                  ADSC9   TV_DEF_NAMES+9           cn=0,n=38
         6 000374   000000 000046 xsym               ADSC9   LL_DOBUF                 cn=0,n=38
         6 000375   040000 100400                    MLR     fill='040'O
         6 000376   000000 000037 xsym               ADSC9   LL_VECTOR_RF             cn=0,n=31
         6 000377   000011 400112 xsym               ADSC9   LL_DOBUF+9               cn=2,n=74

      459    12964    3               CALL LLM$MON_SVC(LL#WRITEDO);

  12964  6 000400   000021 630400 7                  EPPR0   17
         6 000401   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000402   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000403   000000 011000                    NOP     0

      460    12965    3               LL_DOBUF = '      during transfer vector processing';

  12965  6 000404   040000 100400                    MLR     fill='040'O
         6 000405   000042 000047 1                  ADSC9   TV_DEF_NAMES+19          cn=0,n=39
         6 000406   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      461    12966    3               CALL LLM$MON_SVC(LL#WRITEDO);

  12966  6 000407   000021 630400 7                  EPPR0   17
         6 000410   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000411   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000412   000000 011000                    NOP     0

      462    12967    3               CALL LLM$MON_SVC(LL#ERR);

  12967  6 000413   000023 630400 7                  EPPR0   19
         6 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000415   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000416   000000 011000                    NOP     0

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:65   
      463    12968    3               END;

      464    12969         /**/
      465    12970         /* Read def record from run file for RF option */
      466    12971         /**/
      467    12972
      468    12973    2           TEMP = RF_HEAD.NRECSIZE;

  12973  6 000417   000434 236000 2                  LDQ     RF_HEAD+6
         6 000420   777777 376007                    ANQ     -1,DL
         6 000421   200010 756100                    STQ     TEMP,,AUTO

      469    12974    2           CALL LLM$MON_SVC(LL#GETMEM,TEMP,AVAIL$);

  12974  6 000422   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 000423   200044 450500                    STP0    SIZE+3,,AUTO
         6 000424   200010 631500                    EPPR1   TEMP,,AUTO
         6 000425   200043 451500                    STP1    SIZE+2,,AUTO
         6 000426   000017 236000 7                  LDQ     15
         6 000427   200042 756100                    STQ     SIZE+1,,AUTO
         6 000430   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 000431   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000432   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000433   000000 011000                    NOP     0

      470    12975    2           RF_DEF$ = AVAIL$;

  12975  6 000434   200016 236100                    LDQ     AVAIL$,,AUTO
         6 000435   200017 756100                    STQ     RF_DEF$,,AUTO

      471    12976    2           AVAIL$ = PINCRW(AVAIL$,TEMP);

  12976  6 000436   200010 236100                    LDQ     TEMP,,AUTO
         6 000437   000022 736000                    QLS     18
         6 000440   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 000441   200016 756100                    STQ     AVAIL$,,AUTO

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:66   
      472    12977    2           READ_RF.BUF_.BUF$ = RF_DEF$;

  12977  6 000442   200017 236100                    LDQ     RF_DEF$,,AUTO
         6 000443   000311 756000 2                  STQ     READ_RF+5

      473    12978    2           READ_RF.BUF_.BOUND = TEMP * 4 - 1;

  12978  6 000444   200010 236100                    LDQ     TEMP,,AUTO
         6 000445   000002 736000                    QLS     2
         6 000446   000001 136007                    SBLQ    1,DL
         6 000447   000020 736000                    QLS     16
         6 000450   000310 676000 2                  ERQ     READ_RF+4
         6 000451   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 000452   000310 656000 2                  ERSQ    READ_RF+4

      474    12979    2           B$RUKEY.TYPE = %TYPDNAM;

  12979  6 000453   000001 236003                    LDQ     1,DU
         6 000454   000476 552020 2                  STBQ    B$RUKEY,'20'O

      475    12980    2           READ_RF.KEY_ = VECTOR(B$RUKEY);

  12980  6 000455   000024 237000 7                  LDAQ    20
         6 000456   000306 757000 2                  STAQ    READ_RF+2

      476    12981    2           CALL M$READ(READ_RF) ALTRET(READ_ERROR);

  12981  6 000457   000304 630400 2                  EPPR0   READ_RF
         6 000460   440000 713400                    CLIMB   alt,read
         6 000461   401400 401760                    pmme    nvectors=4
         6 000462   000546 702000 6                  TSX2    READ_ERROR

      477    12982    2           RF_DEF_SIZE = DCBADDR(DCBNUM(M$RF))->B$DCB.ARS# / 4;

  12982  6 000463   000000 236007 xsym               LDQ     M$RF,DL
         6 000464   000026 470400 7                  LDP0    22
         6 000465   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:67   
         6 000466   100000 473506                    LDP3    0,QL,PR1
         6 000467   300000 236100                    LDQ     0,,PR3
         6 000470   000004 506007                    DIV     4,DL
         6 000471   200006 756100                    STQ     RF_DEF_SIZE,,AUTO

      478    12983         /**/
      479    12984         /* Read entdef record from run file for RF option */
      480    12985         /**/
      481    12986
      482    12987    2           TEMP = RF_HEAD.EPRECSIZE;

  12987  6 000472   000435 235000 2                  LDA     RF_HEAD+7
         6 000473   000022 771000                    ARL     18
         6 000474   200010 755100                    STA     TEMP,,AUTO

      483    12988    2           CALL LLM$MON_SVC(LL#GETMEM,TEMP,AVAIL$);

  12988  6 000475   200016 633500                    EPPR3   AVAIL$,,AUTO
         6 000476   200044 453500                    STP3    SIZE+3,,AUTO
         6 000477   200010 634500                    EPPR4   TEMP,,AUTO
         6 000500   200043 454500                    STP4    SIZE+2,,AUTO
         6 000501   000017 236000 7                  LDQ     15
         6 000502   200042 756100                    STQ     SIZE+1,,AUTO
         6 000503   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 000504   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000505   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000506   000000 011000                    NOP     0

      484    12989    2           RF_EDEF$ = AVAIL$;

  12989  6 000507   200016 236100                    LDQ     AVAIL$,,AUTO
         6 000510   200020 756100                    STQ     RF_EDEF$,,AUTO

      485    12990    2           AVAIL$ = PINCRW(AVAIL$,TEMP);

  12990  6 000511   200010 236100                    LDQ     TEMP,,AUTO
         6 000512   000022 736000                    QLS     18
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:68   
         6 000513   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 000514   200016 756100                    STQ     AVAIL$,,AUTO

      486    12991    2           B$RUKEY.TYPE = %TYPEDEF;

  12991  6 000515   000004 236003                    LDQ     4,DU
         6 000516   000476 552020 2                  STBQ    B$RUKEY,'20'O

      487    12992    2           READ_RF.BUF_.BUF$ = RF_EDEF$;

  12992  6 000517   200020 236100                    LDQ     RF_EDEF$,,AUTO
         6 000520   000311 756000 2                  STQ     READ_RF+5

      488    12993    2           READ_RF.BUF_.BOUND = TEMP * 4 -1;

  12993  6 000521   200010 236100                    LDQ     TEMP,,AUTO
         6 000522   000002 736000                    QLS     2
         6 000523   000001 136007                    SBLQ    1,DL
         6 000524   000020 736000                    QLS     16
         6 000525   000310 676000 2                  ERQ     READ_RF+4
         6 000526   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 000527   000310 656000 2                  ERSQ    READ_RF+4

      489    12994    2           READ_RF.KEY_ = VECTOR(B$RUKEY);

  12994  6 000530   000024 237000 7                  LDAQ    20
         6 000531   000306 757000 2                  STAQ    READ_RF+2

      490    12995    2           CALL M$READ(READ_RF) ALTRET(READ_ERROR);

  12995  6 000532   000304 630400 2                  EPPR0   READ_RF
         6 000533   440000 713400                    CLIMB   alt,read
         6 000534   401400 401760                    pmme    nvectors=4
         6 000535   000546 702000 6                  TSX2    READ_ERROR

      491    12996    2           RF_EDEF_SIZE = DCBADDR(DCBNUM(M$RF))->B$DCB.ARS# / 4;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:69   
  12996  6 000536   000000 236007 xsym               LDQ     M$RF,DL
         6 000537   000026 470400 7                  LDP0    22
         6 000540   000000 471500                    LDP1    0,,PR0
         6 000541   100000 473506                    LDP3    0,QL,PR1
         6 000542   300000 236100                    LDQ     0,,PR3
         6 000543   000004 506007                    DIV     4,DL
         6 000544   200007 756100                    STQ     RF_EDEF_SIZE,,AUTO

      492    12997    3           DO WHILE('0'B);

  12997  6 000545   000573 710000 6                  TRA     s:13006

      493    12998    3   READ_ERROR:
      494    12999    3               CALL INSERT(LL_DOBUF,0,,'A  *** Missing record from ',

  12999  6 000546   040000 100400       READ_ERROR   MLR     fill='040'O
         6 000547   000054 000033 1                  ADSC9   TV_DEF_NAMES+29          cn=0,n=27
         6 000550   000000 000033 xsym               ADSC9   LL_DOBUF                 cn=0,n=27
         6 000551   040000 100400                    MLR     fill='040'O
         6 000552   000000 000037 xsym               ADSC9   LL_VECTOR_RF             cn=0,n=31
         6 000553   000006 600125 xsym               ADSC9   LL_DOBUF+6               cn=3,n=85

      495    13000    3                  LL_VECTOR_RF);
      496    13001    3               CALL LLM$MON_SVC(LL#WRITEDO);

  13001  6 000554   000021 630400 7                  EPPR0   17
         6 000555   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000556   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000557   000000 011000                    NOP     0

      497    13002    3               LL_DOBUF = '      during transfer vector processing';

  13002  6 000560   040000 100400                    MLR     fill='040'O
         6 000561   000042 000047 1                  ADSC9   TV_DEF_NAMES+19          cn=0,n=39
         6 000562   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      498    13003    3               CALL LLM$MON_SVC(LL#WRITEDO);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:70   

  13003  6 000563   000021 630400 7                  EPPR0   17
         6 000564   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000565   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000566   000000 011000                    NOP     0

      499    13004    3               CALL LLM$MON_SVC(LL#ERR);

  13004  6 000567   000023 630400 7                  EPPR0   19
         6 000570   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000571   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000572   000000 011000                    NOP     0

      500    13005    3               END;

      501    13006    2           TEMP = RF_EDEF_SIZE / SIZEW(B$EDEF);

  13006  6 000573   200007 236100                    LDQ     RF_EDEF_SIZE,,AUTO
         6 000574   000001 772000                    QRL     1
         6 000575   200010 756100                    STQ     TEMP,,AUTO

      502    13007         /**/
      503    13008         /* sorting RF entdef record by value */
      504    13009         /**/
      505    13010
      506    13011    2           CALL SORT_BY_VALUE(RF_EDEF$->B$EDEF);

  13011  6 000576   200020 236100                    LDQ     RF_EDEF$,,AUTO
         6 000577   200035 756100                    STQ     MEM$+2,,AUTO
         6 000600   003552 701000 6                  TSX1    SORT_BY_VALUE
         6 000601   000000 011000                    NOP     0

      507    13012         /**/
      508    13013         /* looking for _TV_ST */
      509    13014         /**/
      510    13015
      511    13016    2           CALL SEARCH_TV(ADDR(TV_START_NAME),NAME1$,RF_DEF$);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:71   

  13016  6 000602   000027 236000 7                  LDQ     23
         6 000603   200051 756100                    STQ     SIZE+8,,AUTO
         6 000604   200017 630500                    EPPR0   RF_DEF$,,AUTO
         6 000605   200037 450500                    STP0    @Q$+1,,AUTO
         6 000606   200023 631500                    EPPR1   NAME1$,,AUTO
         6 000607   200036 451500                    STP1    @P$+1,,AUTO
         6 000610   200051 633500                    EPPR3   SIZE+8,,AUTO
         6 000611   200035 453500                    STP3    MEM$+2,,AUTO
         6 000612   003670 701000 6                  TSX1    SEARCH_TV
         6 000613   000000 011000                    NOP     0

      512    13017    2           IF NAME1$ = RF_EDEF$

  13017  6 000614   200023 236100                    LDQ     NAME1$,,AUTO
         6 000615   200020 116100                    CMPQ    RF_EDEF$,,AUTO
         6 000616   000622 601000 6                  TNZ     s:13022

      513    13018    2           THEN
      514    13019    2               BEGIN$ = PINCRW(NAME1$,SIZEW(B$EDEF));

  13019  6 000617   000002 036003                    ADLQ    2,DU
         6 000620   200026 756100                    STQ     BEGIN$,,AUTO
         6 000621   000652 710000 6                  TRA     s:13038

      515    13020    2           ELSE
      516    13021    3           DO;

      517    13022    3               NAME2$ = PINCRW(NAME1$,-SIZEW(B$EDEF));

  13022  6 000622   777776 036003                    ADLQ    -2,DU
         6 000623   200024 756100                    STQ     NAME2$,,AUTO

      518    13023    3               IF NAME1$->B$EDEF.ISADDR ~= NAME2$->B$EDEF.ISADDR

  13023  6 000624   200024 470500                    LDP0    NAME2$,,AUTO
         6 000625   200023 471500                    LDP1    NAME1$,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:72   
         6 000626   100000 236100                    LDQ     0,,PR1
         6 000627   000000 676100                    ERQ     0,,PR0
         6 000630   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000631   000636 600000 6                  TZE     s:13028

      519    13024    3               THEN
      520    13025    3                   BEGIN$ = PINCRW(NAME1$,SIZEW(B$EDEF));

  13025  6 000632   200023 236100                    LDQ     NAME1$,,AUTO
         6 000633   000002 036003                    ADLQ    2,DU
         6 000634   200026 756100                    STQ     BEGIN$,,AUTO
         6 000635   000652 710000 6                  TRA     s:13038

      521    13026    3               ELSE
      522    13027    4               DO;

      523    13028    4                   TEMP_EDEF = NAME1$->B$EDEF;

  13028  6 000636   000100 100500                    MLR     fill='000'O
         6 000637   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 000640   200014 000010                    ADSC9   TEMP_EDEF,,AUTO          cn=0,n=8

      524    13029    4                   NAME1$->B$EDEF = NAME2$->B$EDEF;

  13029  6 000641   000100 100500                    MLR     fill='000'O
         6 000642   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000643   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

      525    13030    4                   NAME2$->B$EDEF = TEMP_EDEF;

  13030  6 000644   200024 470500                    LDP0    NAME2$,,AUTO
         6 000645   200014 237100                    LDAQ    TEMP_EDEF,,AUTO
         6 000646   000000 755100                    STA     0,,PR0
         6 000647   000001 756100                    STQ     1,,PR0

      526    13031    4                   BEGIN$ = NAME1$;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:73   
  13031  6 000650   200023 236100                    LDQ     NAME1$,,AUTO
         6 000651   200026 756100                    STQ     BEGIN$,,AUTO

      527    13032    4                   END;

      528    13033    3               END;

      529    13034         /**/
      530    13035         /* looking for _TV_EN */
      531    13036         /**/
      532    13037
      533    13038    2           CALL SEARCH_TV(ADDR(TV_END_NAME),END$,RF_DEF$);

  13038  6 000652   000030 236000 7                  LDQ     24
         6 000653   200052 756100                    STQ     SIZE+9,,AUTO
         6 000654   200017 630500                    EPPR0   RF_DEF$,,AUTO
         6 000655   200037 450500                    STP0    @Q$+1,,AUTO
         6 000656   200027 631500                    EPPR1   END$,,AUTO
         6 000657   200036 451500                    STP1    @P$+1,,AUTO
         6 000660   200052 633500                    EPPR3   SIZE+9,,AUTO
         6 000661   200035 453500                    STP3    MEM$+2,,AUTO
         6 000662   003670 701000 6                  TSX1    SEARCH_TV
         6 000663   000000 011000                    NOP     0

      534    13039         /**/
      535    13040         /* Process transfer vector entries from RF */
      536    13041         /**/
      537    13042
      538    13043    2           I = BEGIN$->B$EDEF.ISADDR;

  13043  6 000664   200026 470500                    LDP0    BEGIN$,,AUTO
         6 000665   000000 236100                    LDQ     0,,PR0
         6 000666   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000667   200004 756100                    STQ     I,,AUTO

      539    13044    3           DO WHILE(BEGIN$ < END$);

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:74   
  13044  6 000670   200026 236100                    LDQ     BEGIN$,,AUTO
         6 000671   200027 116100                    CMPQ    END$,,AUTO
         6 000672   001000 603000 6                  TRC     s:13068

      540    13045    3               IF BEGIN$->B$EDEF.ISADDR > I THEN

  13045  6 000673   200026 470500                    LDP0    BEGIN$,,AUTO
         6 000674   000000 236100                    LDQ     0,,PR0
         6 000675   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000676   200004 116100                    CMPQ    I,,AUTO
         6 000677   000707 602000 6                  TNC     s:13050
         6 000700   000707 600000 6                  TZE     s:13050

      541    13046    4               DO;

      542    13047    4                   OFFSET = OFFSET + BEGIN$->B$EDEF.ISADDR - I;

  13047  6 000701   000630 036000 2                  ADLQ    OFFSET
         6 000702   200004 136100                    SBLQ    I,,AUTO
         6 000703   000630 756000 2                  STQ     OFFSET

      543    13048    4                   I = BEGIN$->B$EDEF.ISADDR;

  13048  6 000704   000000 236100                    LDQ     0,,PR0
         6 000705   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000706   200004 756100                    STQ     I,,AUTO

      544    13049    4                   END;

      545    13050    3               NAME1$ = PINCRW(RF_DEF$,BEGIN$->B$EDEF.NPOINTER);

  13050  6 000707   000001 220100                    LDX0    1,,PR0
         6 000710   000000 636010                    EAQ     0,X0
         6 000711   200017 036100                    ADLQ    RF_DEF$,,AUTO
         6 000712   200023 756100                    STQ     NAME1$,,AUTO

      546    13051    3               CALL SEARCH_ENTDEF(NAME1$,NAME2$) ALTRET(NOT_FOUND);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:75   

  13051  6 000713   200024 631500                    EPPR1   NAME2$,,AUTO
         6 000714   200036 451500                    STP1    @P$+1,,AUTO
         6 000715   200023 633500                    EPPR3   NAME1$,,AUTO
         6 000716   200035 453500                    STP3    MEM$+2,,AUTO
         6 000717   003046 701000 6                  TSX1    SEARCH_ENTDEF
         6 000720   000730 702000 6                  TSX2    NOT_FOUND

      547    13052    3               CALL INSERT_VECTOR(NAME1$->B$DNAME,NAME2$->B$EDEF);

  13052  6 000721   200024 236100                    LDQ     NAME2$,,AUTO
         6 000722   200036 756100                    STQ     @P$+1,,AUTO
         6 000723   200023 236100                    LDQ     NAME1$,,AUTO
         6 000724   200035 756100                    STQ     MEM$+2,,AUTO
         6 000725   003112 701000 6                  TSX1    INSERT_VECTOR
         6 000726   000000 011000                    NOP     0

      548    13053    4               DO WHILE('0'B);

  13053  6 000727   000770 710000 6                  TRA     s:13065

      549    13054    4   NOT_FOUND:
      550    13055    4                   CALL CONCAT(LL_DOBUF,'A  *** Transfer vector entry (from)',

  13055  6 000730   040000 100400       NOT_FOUND    MLR     fill='040'O
         6 000731   000063 000043 1                  ADSC9   TV_DEF_NAMES+36          cn=0,n=35
         6 000732   000000 000043 xsym               ADSC9   LL_DOBUF                 cn=0,n=35
         6 000733   040000 100400                    MLR     fill='040'O
         6 000734   000000 000037 xsym               ADSC9   LL_VECTOR_RF             cn=0,n=31
         6 000735   000010 600115 xsym               ADSC9   LL_DOBUF+8               cn=3,n=77

      551    13056    4                      LL_VECTOR_RF);
      552    13057    4                   CALL LLM$MON_SVC(LL#WRITEDO);

  13057  6 000736   000021 630400 7                  EPPR0   17
         6 000737   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000740   000000 701000 xent               TSX1    LLM$MON_SVC
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:76   
         6 000741   000000 011000                    NOP     0

      553    13058    4                   CALL CONCAT(LL_DOBUF,'A      not defined:',

  13058  6 000742   200023 470500                    LDP0    NAME1$,,AUTO
         6 000743   000000 220100                    LDX0    0,,PR0
         6 000744   040000 100400                    MLR     fill='040'O
         6 000745   000074 000023 1                  ADSC9   TV_DEF_NAMES+45          cn=0,n=19
         6 000746   000000 000023 xsym               ADSC9   LL_DOBUF                 cn=0,n=19
         6 000747   040000 100540                    MLR     fill='040'O
         6 000750   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         6 000751   000004 600135 xsym               ADSC9   LL_DOBUF+4               cn=3,n=93

      554    13059    4                      SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.COUNT));
      555    13060    4                   CALL LLM$MON_SVC(LL#WRITEDO);

  13060  6 000752   000021 630400 7                  EPPR0   17
         6 000753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000754   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000755   000000 011000                    NOP     0

      556    13061    4                   LL_DOBUF = 'A *** Empty slot reserved in transfer vector instead.';

  13061  6 000756   040000 100400                    MLR     fill='040'O
         6 000757   000101 000066 1                  ADSC9   TV_DEF_NAMES+50          cn=0,n=54
         6 000760   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      557    13062    4                   CALL LLM$MON_SVC(LL#WRITEDO);

  13062  6 000761   000021 630400 7                  EPPR0   17
         6 000762   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000763   000000 701000 xent               TSX1    LLM$MON_SVC
         6 000764   000000 011000                    NOP     0

      558    13063    4                   OFFSET = OFFSET + 3;

  13063  6 000765   000630 235000 2                  LDA     OFFSET
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:77   
         6 000766   000003 035007                    ADLA    3,DL
         6 000767   000630 755000 2                  STA     OFFSET

      559    13064    4                   END;

      560    13065    3               BEGIN$ = PINCRW(BEGIN$,SIZEW(B$EDEF));

  13065  6 000770   200026 236100                    LDQ     BEGIN$,,AUTO
         6 000771   000002 036003                    ADLQ    2,DU
         6 000772   200026 756100                    STQ     BEGIN$,,AUTO

      561    13066    3               I = I + 3;

  13066  6 000773   200004 235100                    LDA     I,,AUTO
         6 000774   000003 035007                    ADLA    3,DL
         6 000775   200004 755100                    STA     I,,AUTO

      562    13067    3               END;

  13067  6 000776   200027 116100                    CMPQ    END$,,AUTO
         6 000777   000673 602000 6                  TNC     s:13045

      563    13068    2           OFFSET = OFFSET + END$->B$EDEF.ISADDR - I;

  13068  6 001000   200027 470500                    LDP0    END$,,AUTO
         6 001001   000000 236100                    LDQ     0,,PR0
         6 001002   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 001003   000630 036000 2                  ADLQ    OFFSET
         6 001004   200004 136100                    SBLQ    I,,AUTO
         6 001005   000630 756000 2                  STQ     OFFSET

      564    13069    2           CALL M$CLOSE(CLOSE_RF);

  13069  6 001006   000322 630400 2                  EPPR0   CLOSE_RF
         6 001007   050001 713400                    CLIMB   close
         6 001010   406000 401760                    pmme    nvectors=13

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:78   
      565    13070    2           END;

      566    13071         /**/
      567    13072         /* Process ENTRIES suboptions */
      568    13073         /**/
      569    13074
      570    13075    1       LIST$ = LL_LIST$;

  13075  6 001011   000000 236000 xsym               LDQ     LL_LIST$
         6 001012   200025 756100                    STQ     LIST$,,AUTO

      571    13076    2       DO I = 1 TO LL_LIST_SIZE;

  13076  6 001013   000001 235007                    LDA     1,DL
         6 001014   200004 755100                    STA     I,,AUTO
         6 001015   001311 710000 6                  TRA     s:13125+3

      572    13077    2           NAME1$ = PINCRW(LIST$,SIZEW(VECTOR_LIST));

  13077  6 001016   200025 236100                    LDQ     LIST$,,AUTO
         6 001017   000001 036003                    ADLQ    1,DU
         6 001020   200023 756100                    STQ     NAME1$,,AUTO

      573    13078    2           NEXT = LIST$->VECTOR_LIST.SIZEW1 + 1;

  13078  6 001021   200025 470500                    LDP0    LIST$,,AUTO
         6 001022   000000 236100                    LDQ     0,,PR0
         6 001023   000022 772000                    QRL     18
         6 001024   000001 036007                    ADLQ    1,DL
         6 001025   200013 756100                    STQ     NEXT,,AUTO

      574    13079    2           IF LIST$->VECTOR_LIST.SIZEW1 = 0 THEN

  13079  6 001026   000000 220100                    LDX0    0,,PR0
         6 001027   001036 601000 6                  TNZ     s:13084

      575    13080    3           DO; /* Empty slots option */
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:79   

      576    13081    3               OFFSET = OFFSET + LIST$->VECTOR_LIST.SIZEW2*3;

  13081  6 001030   000000 236100                    LDQ     0,,PR0
         6 001031   777777 376007                    ANQ     -1,DL
         6 001032   000003 402007                    MPY     3,DL
         6 001033   000630 036000 2                  ADLQ    OFFSET
         6 001034   000630 756000 2                  STQ     OFFSET

      577    13082    3               END;

  13082  6 001035   001302 710000 6                  TRA     s:13124

      578    13083    2           ELSE
      579    13084    2               IF LIST$->VECTOR_LIST.SIZEW2 = 0 THEN

  13084  6 001036   000000 721100                    LXL1    0,,PR0
         6 001037   001112 601000 6                  TNZ     s:13101

      580    13085    3               DO; /* Entry names suboption */

      581    13086    3                   CALL SEARCH_ENTDEF(NAME1$,NAME$) ALTRET(NOT_DEFINED);

  13086  6 001040   200030 631500                    EPPR1   NAME$,,AUTO
         6 001041   200036 451500                    STP1    @P$+1,,AUTO
         6 001042   200023 633500                    EPPR3   NAME1$,,AUTO
         6 001043   200035 453500                    STP3    MEM$+2,,AUTO
         6 001044   003046 701000 6                  TSX1    SEARCH_ENTDEF
         6 001045   001055 702000 6                  TSX2    NOT_DEFINED

      582    13087    3                   CALL INSERT_VECTOR(NAME1$->B$DNAME,NAME$->B$EDEF);

  13087  6 001046   200030 236100                    LDQ     NAME$,,AUTO
         6 001047   200036 756100                    STQ     @P$+1,,AUTO
         6 001050   200023 236100                    LDQ     NAME1$,,AUTO
         6 001051   200035 756100                    STQ     MEM$+2,,AUTO
         6 001052   003112 701000 6                  TSX1    INSERT_VECTOR
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:80   
         6 001053   000000 011000                    NOP     0

      583    13088    4                   DO WHILE('0'B);

  13088  6 001054   001302 710000 6                  TRA     s:13124

      584    13089    4   NOT_DEFINED:
      585    13090    4                       IF LL_HEAD.SEV < 7 THEN LL_HEAD.SEV = 7;

  13090  6 001055   000003 236000 xsym  NOT_DEFINED  LDQ     LL_HEAD+3
         6 001056   777000 376003                    ANQ     -512,DU
         6 001057   007000 116003                    CMPQ    3584,DU
         6 001060   001063 603000 6                  TRC     s:13091

  13090  6 001061   007000 236003                    LDQ     3584,DU
         6 001062   000003 552040 xsym               STBQ    LL_HEAD+3,'40'O

      586    13091    4                       CALL INSERT(LL_DOBUF,0,,
             13091                                'A  *** Transfer vector entry not defined: ',

  13091  6 001063   200023 470500                    LDP0    NAME1$,,AUTO
         6 001064   000000 220100                    LDX0    0,,PR0
         6 001065   040000 100400                    MLR     fill='040'O
         6 001066   000117 000052 1                  ADSC9   TV_DEF_NAMES+64          cn=0,n=42
         6 001067   000000 000052 xsym               ADSC9   LL_DOBUF                 cn=0,n=42
         6 001070   040000 100540                    MLR     fill='040'O
         6 001071   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         6 001072   000012 400106 xsym               ADSC9   LL_DOBUF+10              cn=2,n=70

      587    13092    4                          NAME1$->B$DNAME.TEXT);
      588    13093    4                       CALL LLM$MON_SVC(LL#WRITEDO);

  13093  6 001073   000021 630400 7                  EPPR0   17
         6 001074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 001075   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001076   000000 011000                    NOP     0

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:81   
      589    13094    4                       LL_DOBUF =
             13094                                'A     Empty slot reserved in transfer vector instead';

  13094  6 001077   040000 100400                    MLR     fill='040'O
         6 001100   000132 000064 1                  ADSC9   TV_DEF_NAMES+75          cn=0,n=52
         6 001101   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      590    13095    4                       CALL LLM$MON_SVC(LL#WRITEDO);

  13095  6 001102   000021 630400 7                  EPPR0   17
         6 001103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 001104   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001105   000000 011000                    NOP     0

      591    13096    4                       OFFSET = OFFSET + 3;

  13096  6 001106   000630 235000 2                  LDA     OFFSET
         6 001107   000003 035007                    ADLA    3,DL
         6 001110   000630 755000 2                  STA     OFFSET

      592    13097    4                       END;

      593    13098    3                   END; /* Entry names */

  13098  6 001111   001302 710000 6                  TRA     s:13124

      594    13099    2               ELSE
      595    13100    3               DO; /* Entdef names range */

      596    13101    3                   NAME2$ = PINCRW(NAME1$,LIST$->VECTOR_LIST.SIZEW1);

  13101  6 001112   000000 636010                    EAQ     0,X0
         6 001113   200023 036100                    ADLQ    NAME1$,,AUTO
         6 001114   200024 756100                    STQ     NAME2$,,AUTO

      597    13102    3                   NEXT = NEXT + LIST$->VECTOR_LIST.SIZEW2;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:82   
  13102  6 001115   000000 236100                    LDQ     0,,PR0
         6 001116   777777 376007                    ANQ     -1,DL
         6 001117   200013 036100                    ADLQ    NEXT,,AUTO
         6 001120   200013 756100                    STQ     NEXT,,AUTO

      598    13103    3                   CALL LLM$MON_SVC(LL#GETMEM,4096,AVAIL$);

  13103  6 001121   200016 631500                    EPPR1   AVAIL$,,AUTO
         6 001122   200044 451500                    STP1    SIZE+3,,AUTO
         6 001123   000032 237000 7                  LDAQ    26
         6 001124   200042 757100                    STAQ    SIZE+1,,AUTO
         6 001125   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 001126   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001127   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001130   000000 011000                    NOP     0

      599    13104    3                   CALL LLW$WRTDEF(LL_ENTDEF_R$,AVAIL$,%TYPEDEF,DEF$);

  13104  6 001131   000034 237000 7                  LDAQ    28
         6 001132   200044 757100                    STAQ    SIZE+3,,AUTO
         6 001133   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 001134   200043 450500                    STP0    SIZE+2,,AUTO
         6 001135   000036 236000 7                  LDQ     30
         6 001136   200042 756100                    STQ     SIZE+1,,AUTO
         6 001137   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 001140   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001141   000000 701000 xent               TSX1    LLW$WRTDEF
         6 001142   000000 011000                    NOP     0

      600    13105    3                   B$RUKEY.TYPE = %TYPEDEF;

  13105  6 001143   000004 236003                    LDQ     4,DU
         6 001144   000476 552020 2                  STBQ    B$RUKEY,'20'O

      601    13106    3                   CALL LLM$MON_SVC(LL#READRU,AVAIL$,4096,B$RUKEY);

  13106  6 001145   000040 237000 7                  LDAQ    32
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:83   
         6 001146   200044 757100                    STAQ    SIZE+3,,AUTO
         6 001147   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 001150   200043 450500                    STP0    SIZE+2,,AUTO
         6 001151   000042 236000 7                  LDQ     34
         6 001152   200042 756100                    STQ     SIZE+1,,AUTO
         6 001153   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 001154   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001155   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001156   000000 011000                    NOP     0

      602    13107    3                   TEMP = DCBADDR(DCBNUM(M$RU))->B$DCB.ARS#/4;

  13107  6 001157   000000 236007 xsym               LDQ     M$RU,DL
         6 001160   000026 470400 7                  LDP0    22
         6 001161   000000 471500                    LDP1    0,,PR0
         6 001162   100000 473506                    LDP3    0,QL,PR1
         6 001163   300000 236100                    LDQ     0,,PR3
         6 001164   000004 506007                    DIV     4,DL
         6 001165   200010 756100                    STQ     TEMP,,AUTO

      603    13108    3                   CALL RANGE_START(NAME1$->B$DNAME,BEGIN$) ALTRET(RANGE_ERROR);

  13108  6 001166   200026 633500                    EPPR3   BEGIN$,,AUTO
         6 001167   200036 453500                    STP3    @P$+1,,AUTO
         6 001170   200023 236100                    LDQ     NAME1$,,AUTO
         6 001171   200035 756100                    STQ     MEM$+2,,AUTO
         6 001172   003406 701000 6                  TSX1    RANGE_START
         6 001173   001230 702000 6                  TSX2    RANGE_ERROR

      604    13109    3                   CALL RANGE_END(NAME2$->B$DNAME,BEGIN$,END$) ALTRET(RANGE_ERROR);

  13109  6 001174   200027 630500                    EPPR0   END$,,AUTO
         6 001175   200037 450500                    STP0    @Q$+1,,AUTO
         6 001176   200026 631500                    EPPR1   BEGIN$,,AUTO
         6 001177   200036 451500                    STP1    @P$+1,,AUTO
         6 001200   200024 236100                    LDQ     NAME2$,,AUTO
         6 001201   200035 756100                    STQ     MEM$+2,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:84   
         6 001202   003461 701000 6                  TSX1    RANGE_END
         6 001203   001230 702000 6                  TSX2    RANGE_ERROR

      605    13110    4                   DO WHILE (BEGIN$ < END$);

  13110  6 001204   200026 236100                    LDQ     BEGIN$,,AUTO
         6 001205   200027 116100                    CMPQ    END$,,AUTO
         6 001206   001227 603000 6                  TRC     s:13115

      606    13111    4                       NAME$ = PINCRW(DEF$,BEGIN$->B$EDEF.NPOINTER);

  13111  6 001207   200026 470500                    LDP0    BEGIN$,,AUTO
         6 001210   000001 220100                    LDX0    1,,PR0
         6 001211   000000 636010                    EAQ     0,X0
         6 001212   000633 036000 2                  ADLQ    DEF$
         6 001213   200030 756100                    STQ     NAME$,,AUTO

      607    13112    4                       CALL INSERT_VECTOR(NAME$->B$DNAME,BEGIN$->B$EDEF);

  13112  6 001214   200026 236100                    LDQ     BEGIN$,,AUTO
         6 001215   200036 756100                    STQ     @P$+1,,AUTO
         6 001216   200030 236100                    LDQ     NAME$,,AUTO
         6 001217   200035 756100                    STQ     MEM$+2,,AUTO
         6 001220   003112 701000 6                  TSX1    INSERT_VECTOR
         6 001221   000000 011000                    NOP     0

      608    13113    4                       BEGIN$ = PINCRW(BEGIN$,SIZEW(B$EDEF));

  13113  6 001222   200026 236100                    LDQ     BEGIN$,,AUTO
         6 001223   000002 036003                    ADLQ    2,DU
         6 001224   200026 756100                    STQ     BEGIN$,,AUTO

      609    13114    4                       END;

  13114  6 001225   200027 116100                    CMPQ    END$,,AUTO
         6 001226   001207 602000 6                  TNC     s:13111

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:85   
      610    13115    4                   DO WHILE('0'B);

  13115  6 001227   001302 710000 6                  TRA     s:13124

      611    13116    4   RANGE_ERROR:
      612    13117    4                       LL_DOBUF =
             13117                                'A  *** No transfer vector entries exist for the range:';

  13117  6 001230   040000 100400       RANGE_ERROR  MLR     fill='040'O
         6 001231   000147 000066 1                  ADSC9   TV_DEF_NAMES+88          cn=0,n=54
         6 001232   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      613    13118    4                       CALL LLM$MON_SVC(LL#WRITEDO);

  13118  6 001233   000021 630400 7                  EPPR0   17
         6 001234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 001235   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001236   000000 011000                    NOP     0

      614    13119    4                       CALL CONCAT(LL_DOBUF,'A     ',SUBSTR(NAME1$->B$DNAME.TEXT,0,
             13119                                NAME1$->B$DNAME.COUNT),

  13119  6 001237   200023 470500                    LDP0    NAME1$,,AUTO
         6 001240   000000 220100                    LDX0    0,,PR0
         6 001241   200024 471500                    LDP1    NAME2$,,AUTO
         6 001242   100000 221100                    LDX1    0,,PR1
         6 001243   040000 100400                    MLR     fill='040'O
         6 001244   000074 000006 1                  ADSC9   TV_DEF_NAMES+45          cn=0,n=6
         6 001245   000000 000006 xsym               ADSC9   LL_DOBUF                 cn=0,n=6
         6 001246   040000 100540                    MLR     fill='040'O
         6 001247   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         6 001250   000001 400152 xsym               ADSC9   LL_DOBUF+1               cn=2,n=106
         6 001251   000000 636010                    EAQ     0,X0
         6 001252   000022 772000                    QRL     18
         6 001253   000152 116007                    CMPQ    106,DL
         6 001254   001276 603000 6                  TRC     s:13121
         6 001255   200042 740100                    STX0    SIZE+1,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:86   
         6 001256   777625 620010                    EAX0    -107,X0
         6 001257   777777 660003                    ERX0    -1,DU
         6 001260   200042 235100                    LDA     SIZE+1,,AUTO
         6 001261   000022 771000                    ARL     18
         6 001262   040045 100400                    MLR     fill='040'O
         6 001263   000165 000003 1                  ADSC9   TV_DEF_NAMES+102         cn=0,n=3
         6 001264   000001 400010 xsym               ADSC9   LL_DOBUF+1,A             cn=2,n=*X0
         6 001265   200042 236100                    LDQ     SIZE+1,,AUTO
         6 001266   000022 772000                    QRL     18
         6 001267   000147 116007                    CMPQ    103,DL
         6 001270   001276 603000 6                  TRC     s:13121
         6 001271   777630 620006                    EAX0    -104,QL
         6 001272   777777 660003                    ERX0    -1,DU
         6 001273   040046 100540                    MLR     fill='040'O
         6 001274   100000 400011                    ADSC9   0,,PR1                   cn=2,n=*X1
         6 001275   000002 200010 xsym               ADSC9   LL_DOBUF+2,Q             cn=1,n=*X0

      615    13120    4                          ' - ',SUBSTR(NAME2$->B$DNAME.TEXT,0,NAME2$->B$DNAME.COUNT));
      616    13121    4                       CALL LLM$MON_SVC(LL#WRITEDO);

  13121  6 001276   000021 630400 7                  EPPR0   17
         6 001277   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 001300   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001301   000000 011000                    NOP     0

      617    13122    4                       END;

      618    13123    3                   END; /* RANGE */

      619    13124    2           LIST$ = PINCRW(LIST$,NEXT);

  13124  6 001302   200013 236100                    LDQ     NEXT,,AUTO
         6 001303   000022 736000                    QLS     18
         6 001304   200025 036100                    ADLQ    LIST$,,AUTO
         6 001305   200025 756100                    STQ     LIST$,,AUTO

      620    13125    2           END; /* Entry suboption */
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:87   

  13125  6 001306   200004 235100                    LDA     I,,AUTO
         6 001307   000001 035007                    ADLA    1,DL
         6 001310   200004 755100                    STA     I,,AUTO
         6 001311   000000 236000 xsym               LDQ     LL_LIST_SIZE
         6 001312   200004 116100                    CMPQ    I,,AUTO
         6 001313   001016 603000 6                  TRC     s:13077

      621    13126         /**/
      622    13127         /* Finish transfer vector */
      623    13128         /**/
      624    13129
      625    13130    1       LL_TOPOMEM$ = MEM$;

  13130  6 001314   200033 236100                    LDQ     MEM$,,AUTO
         6 001315   000000 756000 xsym               STQ     LL_TOPOMEM$

      626    13131    1       CALL SEARCH_ENTDEF(ADDR(TV_END_NAME),NAME$);

  13131  6 001316   000030 236000 7                  LDQ     24
         6 001317   200053 756100                    STQ     SIZE+10,,AUTO
         6 001320   200030 630500                    EPPR0   NAME$,,AUTO
         6 001321   200036 450500                    STP0    @P$+1,,AUTO
         6 001322   200053 631500                    EPPR1   SIZE+10,,AUTO
         6 001323   200035 451500                    STP1    MEM$+2,,AUTO
         6 001324   003046 701000 6                  TSX1    SEARCH_ENTDEF
         6 001325   000000 011000                    NOP     0

      627    13132    1       NAME$->B$EDEF.OU.OFFSET = OFFSET;

  13132  6 001326   000630 720000 2                  LXL0    OFFSET
         6 001327   200030 470500                    LDP0    NAME$,,AUTO
         6 001330   000000 440100                    SXL0    0,,PR0

      628    13133    1       TV_EDEF.TV_END.OU.OFFSET = OFFSET;

  13133  6 001331   000630 720000 2                  LXL0    OFFSET
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:88   
         6 001332   000502 440000 2                  SXL0    TV_EDEF+2

      629    13134    1       OFFSET = OFFSET + 3;

  13134  6 001333   000630 235000 2                  LDA     OFFSET
         6 001334   000003 035007                    ADLA    3,DL
         6 001335   000630 755000 2                  STA     OFFSET

      630    13135    1       LL_R_CODE$->SECT_ENTRY.SECTION$->LL_SECTION.SIZE = OFFSET;

  13135  6 001336   000000 470400 xsym               LDP0    LL_R_CODE$
         6 001337   000001 471500                    LDP1    1,,PR0
         6 001340   000000 621005                    EAX1    0,AL
         6 001341   100000 441100                    SXL1    0,,PR1

      631    13136    1       TV_SECTION.SIZE = OFFSET;

  13136  6 001342   000630 720000 2                  LXL0    OFFSET
         6 001343   000504 440000 2                  SXL0    TV_SECTION

      632    13137         /**/
      633    13138         /* Write the relocation record */
      634    13139         /**/
      635    13140
      636    13141    1       WRITE_TV.KEY_ = VECTOR(ENTREF_RELOC_KEY);

  13141  6 001344   000044 237000 7                  LDAQ    36
         6 001345   000132 757000 2                  STAQ    WRITE_TV+2

      637    13142    1       WRITE_TV.BUF_.BUF$ = START$;

  13142  6 001346   200021 236100                    LDQ     START$,,AUTO
         6 001347   000135 756000 2                  STQ     WRITE_TV+5

      638    13143    1       WRITE_TV.BUF_.BOUND = POFFC(TPTR$,START$) - 1;

  13143  6 001350   200021 236100                    LDQ     START$,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:89   
         6 001351   000020 772000                    QRL     16
         6 001352   200042 756100                    STQ     SIZE+1,,AUTO
         6 001353   200022 236100                    LDQ     TPTR$,,AUTO
         6 001354   000020 772000                    QRL     16
         6 001355   200042 136100                    SBLQ    SIZE+1,,AUTO
         6 001356   000001 136007                    SBLQ    1,DL
         6 001357   000020 736000                    QLS     16
         6 001360   000134 676000 2                  ERQ     WRITE_TV+4
         6 001361   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001362   000134 656000 2                  ERSQ    WRITE_TV+4

      639    13144    1       IF TPTR$ ~= START$

  13144  6 001363   200022 236100                    LDQ     TPTR$,,AUTO
         6 001364   200021 116100                    CMPQ    START$,,AUTO
         6 001365   001372 600000 6                  TZE     s:13147

      640    13145    1       THEN
      641    13146    1           CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  13146  6 001366   000130 630400 2                  EPPR0   WRITE_TV
         6 001367   440001 713400                    CLIMB   alt,write
         6 001370   401400 401760                    pmme    nvectors=4
         6 001371   003037 702000 6                  TSX2    ERROR

      642    13147    1       REPEAT_TV_RELOC.OPERAND = OFFSET;

  13147  6 001372   000630 720000 2                  LXL0    OFFSET
         6 001373   000421 440000 2                  SXL0    REPEAT_TV_RELOC

      643    13148    1       WRITE_TV.KEY_ = VECTOR(REPEAT_TV_RELOC_KEY);

  13148  6 001374   000046 237000 7                  LDAQ    38
         6 001375   000132 757000 2                  STAQ    WRITE_TV+2

      644    13149    1       WRITE_TV.BUF_ = VECTOR(REPEAT_TV_RELOC);

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:90   
  13149  6 001376   000050 237000 7                  LDAQ    40
         6 001377   000134 757000 2                  STAQ    WRITE_TV+4

      645    13150    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  13150  6 001400   000130 630400 2                  EPPR0   WRITE_TV
         6 001401   440001 713400                    CLIMB   alt,write
         6 001402   401400 401760                    pmme    nvectors=4
         6 001403   003037 702000 6                  TSX2    ERROR

      646    13151         /**/
      647    13152         /* Write section record and entdef */
      648    13153         /**/
      649    13154
      650    13155    1       WRITE_TV.KEY_ = VECTOR(TV_OU_KEY);

  13155  6 001404   000000 237000 7                  LDAQ    0
         6 001405   000132 757000 2                  STAQ    WRITE_TV+2

      651    13156    1       TV_OU_KEY.TYPE = %TYPSECT;

  13156  6 001406   003000 236007                    LDQ     1536,DL
         6 001407   000627 552010 2                  STBQ    TV_OU_KEY+1,'10'O

      652    13157    1       WRITE_TV.BUF_ = VECTOR(TV_SECTION);

  13157  6 001410   000004 237000 7                  LDAQ    4
         6 001411   000134 757000 2                  STAQ    WRITE_TV+4

      653    13158    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  13158  6 001412   000130 630400 2                  EPPR0   WRITE_TV
         6 001413   440001 713400                    CLIMB   alt,write
         6 001414   401400 401760                    pmme    nvectors=4
         6 001415   003037 702000 6                  TSX2    ERROR

      654    13159    1       TV_OU_KEY.TYPE = %TYPEDEF;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:91   

  13159  6 001416   004000 236007                    LDQ     2048,DL
         6 001417   000627 552010 2                  STBQ    TV_OU_KEY+1,'10'O

      655    13160    1       WRITE_TV.BUF_ = VECTOR(TV_EDEF);

  13160  6 001420   000006 237000 7                  LDAQ    6
         6 001421   000134 757000 2                  STAQ    WRITE_TV+4

      656    13161    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  13161  6 001422   000130 630400 2                  EPPR0   WRITE_TV
         6 001423   440001 713400                    CLIMB   alt,write
         6 001424   401400 401760                    pmme    nvectors=4
         6 001425   003037 702000 6                  TSX2    ERROR

      657    13162         /**/
      658    13163         /* Write referenced names record */
      659    13164         /**/
      660    13165
      661    13166    1       TV_OU_KEY.TYPE = %TYPRNAM;

  13166  6 001426   002000 236007                    LDQ     1024,DL
         6 001427   000627 552010 2                  STBQ    TV_OU_KEY+1,'10'O

      662    13167    1       TV_HEAD.RNAMSIZ = REF_SIZE;

  13167  6 001430   000631 720000 2                  LXL0    REF_SIZE
         6 001431   000514 740000 2                  STX0    TV_HEAD+6

      663    13168    1       TV_HEAD.RNAMPSIZ = REF_SIZE;

  13168  6 001432   000514 440000 2                  SXL0    TV_HEAD+6

      664    13169    1       WRITE_TV.BUF_.BUF$ = REF$;

  13169  6 001433   000637 236000 2                  LDQ     REF$
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:92   
         6 001434   000135 756000 2                  STQ     WRITE_TV+5

      665    13170    1       WRITE_TV.BUF_.BOUND = REF_SIZE* 4 -1;

  13170  6 001435   000631 236000 2                  LDQ     REF_SIZE
         6 001436   000002 736000                    QLS     2
         6 001437   000001 136007                    SBLQ    1,DL
         6 001440   000020 736000                    QLS     16
         6 001441   000134 676000 2                  ERQ     WRITE_TV+4
         6 001442   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001443   000134 656000 2                  ERSQ    WRITE_TV+4

      666    13171    1       IF REF_SIZE > 0 THEN

  13171  6 001444   000631 235000 2                  LDA     REF_SIZE
         6 001445   001452 600000 6                  TZE     s:13177

      667    13172    1           CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  13172  6 001446   000130 630400 2                  EPPR0   WRITE_TV
         6 001447   440001 713400                    CLIMB   alt,write
         6 001450   401400 401760                    pmme    nvectors=4
         6 001451   003037 702000 6                  TSX2    ERROR

      668    13173         /**/
      669    13174         /* Write ENTREF record */
      670    13175         /**/
      671    13176
      672    13177    1       TV_OU_KEY.TYPE = %TYPEREF;

  13177  6 001452   005000 236007                    LDQ     2560,DL
         6 001453   000627 552010 2                  STBQ    TV_OU_KEY+1,'10'O

      673    13178    1       WRITE_TV.BUF_.BUF$ = EREF$;

  13178  6 001454   000634 236000 2                  LDQ     EREF$
         6 001455   000135 756000 2                  STQ     WRITE_TV+5
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:93   

      674    13179    1       WRITE_TV.BUF_.BOUND = EREF_SIZE * 4 - 1;

  13179  6 001456   000632 236000 2                  LDQ     EREF_SIZE
         6 001457   000002 736000                    QLS     2
         6 001460   000001 136007                    SBLQ    1,DL
         6 001461   000020 736000                    QLS     16
         6 001462   000134 676000 2                  ERQ     WRITE_TV+4
         6 001463   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001464   000134 656000 2                  ERSQ    WRITE_TV+4

      675    13180    1       TV_HEAD.EREFSIZ = EREF_SIZE;

  13180  6 001465   000632 720000 2                  LXL0    EREF_SIZE
         6 001466   000516 740000 2                  STX0    TV_HEAD+8

      676    13181    1       TV_HEAD.EREFPSIZ = EREF_SIZE;

  13181  6 001467   000516 440000 2                  SXL0    TV_HEAD+8

      677    13182    1       IF REF_SIZE > 0 THEN

  13182  6 001470   000631 235000 2                  LDA     REF_SIZE
         6 001471   001476 600000 6                  TZE     s:13188

      678    13183    1           CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  13183  6 001472   000130 630400 2                  EPPR0   WRITE_TV
         6 001473   440001 713400                    CLIMB   alt,write
         6 001474   401400 401760                    pmme    nvectors=4
         6 001475   003037 702000 6                  TSX2    ERROR

      679    13184         /**/
      680    13185         /* Write head record */
      681    13186         /**/
      682    13187
      683    13188    1       WRITE_TV.KEY_ = VECTOR(TV_HEAD_KEY);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:94   

  13188  6 001476   000010 237000 7                  LDAQ    8
         6 001477   000132 757000 2                  STAQ    WRITE_TV+2

      684    13189    1       WRITE_TV.BUF_ = VECTOR(TV_HEAD);

  13189  6 001500   000052 237000 7                  LDAQ    42
         6 001501   000134 757000 2                  STAQ    WRITE_TV+4

      685    13190    1       CALL M$WRITE(WRITE_TV) ALTRET(ERROR);

  13190  6 001502   000130 630400 2                  EPPR0   WRITE_TV
         6 001503   440001 713400                    CLIMB   alt,write
         6 001504   401400 401760                    pmme    nvectors=4
         6 001505   003037 702000 6                  TSX2    ERROR

      686    13191    1       LL_R_OU$->OU_ENTRY.HEAD$->B$OUHEAD.RNAMSIZ = REF_SIZE;

  13191  6 001506   000000 470400 xsym               LDP0    LL_R_OU$
         6 001507   000013 471500                    LDP1    11,,PR0
         6 001510   000631 720000 2                  LXL0    REF_SIZE
         6 001511   100006 740100                    STX0    6,,PR1

      687    13192    1       LL_R_OU$->OU_ENTRY.HEAD$->B$OUHEAD.EREFSIZ = EREF_SIZE;

  13192  6 001512   000013 471500                    LDP1    11,,PR0
         6 001513   000632 721000 2                  LXL1    EREF_SIZE
         6 001514   100010 741100                    STX1    8,,PR1

      688    13193    1       LL_R_OU$->OU_ENTRY.HEAD$->B$OUHEAD.RNAMPSIZ = REF_SIZE;

  13193  6 001515   000013 471500                    LDP1    11,,PR0
         6 001516   100006 440100                    SXL0    6,,PR1

      689    13194    1       LL_R_OU$->OU_ENTRY.HEAD$->B$OUHEAD.EREFPSIZ = EREF_SIZE;

  13194  6 001517   000013 471500                    LDP1    11,,PR0
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:95   
         6 001520   100010 441100                    SXL1    8,,PR1

      690    13195
      691    13196         /* Close transfer vector file */
      692    13197
      693    13198    1       CALL M$CLOSE(CLOSE_TV) ALTRET(ERROR);

  13198  6 001521   000072 630400 2                  EPPR0   CLOSE_TV
         6 001522   450001 713400                    CLIMB   alt,close
         6 001523   406000 401760                    pmme    nvectors=13
         6 001524   003037 702000 6                  TSX2    ERROR

      694    13199
      695    13200    1       RETURN;

  13200  6 001525   000000 702200 xent               TSX2  ! X66_ARET

      696    13201        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:96   
      697    13202    1   LLT$FINISH_VECTOR: ENTRY;

  13202  6 001526   000000 700200 xent  LLT$FINISH_* TSX0  ! X66_AUTO_0
         6 001527   000056 000000                    ZERO    46,0

      698    13203         /**/
      699    13204         /*    Finish transfer vector and process REMOVE_ENTDEF, REMOVE_SYMDEF
      700    13205            options and displays transfer vectors */
      701    13206         /**/
      702    13207
      703    13208    1       AVAIL$ = LL_BOTOMEM$;

  13208  6 001530   000000 236000 xsym               LDQ     LL_BOTOMEM$
         6 001531   200016 756100                    STQ     AVAIL$,,AUTO

      704    13209    1       B$RUKEY = '0'B;

  13209  6 001532   000476 450000 2                  STZ     B$RUKEY
         6 001533   000477 450000 2                  STZ     B$RUKEY+1

      705    13210    1       B$RUKEY.TYPE = %TYPDNAM;

  13210  6 001534   000001 236003                    LDQ     1,DU
         6 001535   000476 552020 2                  STBQ    B$RUKEY,'20'O

      706    13211    1       B$RUKEY.KEYSIZ = 5;

  13211  6 001536   005000 236003                    LDQ     2560,DU
         6 001537   000476 552040 2                  STBQ    B$RUKEY,'40'O

      707    13212    1       B$RUKEY.ISADDR = 0;

  13212  6 001540   003000 061400                    CSR     bolr='003'O
         6 001541   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         6 001542   000476 670024 2                  BDSC    B$RUKEY                  by=3,bit=7,n=20

      708    13213    1       I = LL_HEAD.NRECSIZE;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:97   

  13213  6 001543   000006 236000 xsym               LDQ     LL_HEAD+6
         6 001544   777777 376007                    ANQ     -1,DL
         6 001545   200004 756100                    STQ     I,,AUTO

      709    13214    1       CALL LLM$MON_SVC(LL#GETMEM,I,AVAIL$);

  13214  6 001546   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 001547   200044 450500                    STP0    SIZE+3,,AUTO
         6 001550   200004 631500                    EPPR1   I,,AUTO
         6 001551   200043 451500                    STP1    SIZE+2,,AUTO
         6 001552   000017 236000 7                  LDQ     15
         6 001553   200042 756100                    STQ     SIZE+1,,AUTO
         6 001554   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 001555   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001556   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001557   000000 011000                    NOP     0

      710    13215    1       CALL LLM$MON_SVC(LL#READRU,AVAIL$,I*4-1,B$RUKEY);

  13215  6 001560   200004 235100                    LDA     I,,AUTO
         6 001561   000002 735000                    ALS     2
         6 001562   000001 135007                    SBLA    1,DL
         6 001563   200042 755100                    STA     SIZE+1,,AUTO
         6 001564   000025 236000 7                  LDQ     21
         6 001565   200047 756100                    STQ     SIZE+6,,AUTO
         6 001566   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 001567   200046 450500                    STP0    SIZE+5,,AUTO
         6 001570   200016 631500                    EPPR1   AVAIL$,,AUTO
         6 001571   200045 451500                    STP1    SIZE+4,,AUTO
         6 001572   000042 236000 7                  LDQ     34
         6 001573   200044 756100                    STQ     SIZE+3,,AUTO
         6 001574   200044 630500                    EPPR0   SIZE+3,,AUTO
         6 001575   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001576   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001577   000000 011000                    NOP     0

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:98   
      711    13216    1       DEF$ = AVAIL$;

  13216  6 001600   200016 236100                    LDQ     AVAIL$,,AUTO
         6 001601   000633 756000 2                  STQ     DEF$

      712    13217    1       AVAIL$ = PINCRW(AVAIL$,I);

  13217  6 001602   200004 236100                    LDQ     I,,AUTO
         6 001603   000022 736000                    QLS     18
         6 001604   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 001605   200016 756100                    STQ     AVAIL$,,AUTO

      713    13218    1       I = LL_HEAD.EPRECSIZE;

  13218  6 001606   000007 235000 xsym               LDA     LL_HEAD+7
         6 001607   000022 771000                    ARL     18
         6 001610   200004 755100                    STA     I,,AUTO

      714    13219    1       CALL LLM$MON_SVC(LL#GETMEM,I,AVAIL$);

  13219  6 001611   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 001612   200044 450500                    STP0    SIZE+3,,AUTO
         6 001613   200004 631500                    EPPR1   I,,AUTO
         6 001614   200043 451500                    STP1    SIZE+2,,AUTO
         6 001615   000017 236000 7                  LDQ     15
         6 001616   200042 756100                    STQ     SIZE+1,,AUTO
         6 001617   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 001620   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001621   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001622   000000 011000                    NOP     0

      715    13220    1       B$RUKEY.TYPE = %TYPEDEF;

  13220  6 001623   000004 236003                    LDQ     4,DU
         6 001624   000476 552020 2                  STBQ    B$RUKEY,'20'O

      716    13221    1       CALL LLM$MON_SVC(LL#READRU,AVAIL$,I*4-1,B$RUKEY);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:99   

  13221  6 001625   200004 235100                    LDA     I,,AUTO
         6 001626   000002 735000                    ALS     2
         6 001627   000001 135007                    SBLA    1,DL
         6 001630   200042 755100                    STA     SIZE+1,,AUTO
         6 001631   000025 236000 7                  LDQ     21
         6 001632   200047 756100                    STQ     SIZE+6,,AUTO
         6 001633   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 001634   200046 450500                    STP0    SIZE+5,,AUTO
         6 001635   200016 631500                    EPPR1   AVAIL$,,AUTO
         6 001636   200045 451500                    STP1    SIZE+4,,AUTO
         6 001637   000042 236000 7                  LDQ     34
         6 001640   200044 756100                    STQ     SIZE+3,,AUTO
         6 001641   200044 630500                    EPPR0   SIZE+3,,AUTO
         6 001642   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001643   000000 701000 xent               TSX1    LLM$MON_SVC
         6 001644   000000 011000                    NOP     0

      717    13222    1       TEMP = (DCBADDR(DCBNUM(M$RU))->B$DCB.ARS#/4)/ SIZEW(B$EDEF);

  13222  6 001645   000000 236007 xsym               LDQ     M$RU,DL
         6 001646   000026 470400 7                  LDP0    22
         6 001647   000000 471500                    LDP1    0,,PR0
         6 001650   100000 473506                    LDP3    0,QL,PR1
         6 001651   300000 236100                    LDQ     0,,PR3
         6 001652   000004 506007                    DIV     4,DL
         6 001653   000002 506007                    DIV     2,DL
         6 001654   200010 756100                    STQ     TEMP,,AUTO

      718    13223    1       RF_EDEF$ = AVAIL$;

  13223  6 001655   200016 236100                    LDQ     AVAIL$,,AUTO
         6 001656   200020 756100                    STQ     RF_EDEF$,,AUTO

      719    13224    1       AVAIL$ = PINCRW(AVAIL$,I);

  13224  6 001657   200004 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:100  
         6 001660   000022 736000                    QLS     18
         6 001661   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 001662   200016 756100                    STQ     AVAIL$,,AUTO

      720    13225    1       END$ = PINCRW(RF_EDEF$,TEMP*2-SIZEW(B$EDEF));

  13225  6 001663   200010 236100                    LDQ     TEMP,,AUTO
         6 001664   000023 736000                    QLS     19
         6 001665   000002 136003                    SBLQ    2,DU
         6 001666   200020 036100                    ADLQ    RF_EDEF$,,AUTO
         6 001667   200027 756100                    STQ     END$,,AUTO

      721    13226
      722    13227         /**/
      723    13228         /* Sort entdef by value for processing later on */
      724    13229         /**/
      725    13230
      726    13231    1       CALL SORT_BY_VALUE(RF_EDEF$->B$EDEF);

  13231  6 001670   200020 236100                    LDQ     RF_EDEF$,,AUTO
         6 001671   200035 756100                    STQ     MEM$+2,,AUTO
         6 001672   003552 701000 6                  TSX1    SORT_BY_VALUE
         6 001673   000000 011000                    NOP     0

      727    13232
      728    13233         /**/
      729    13234         /* Sort entdefs not in transfer vector by name */
      730    13235         /**/
      731    13236
      732    13237    1       CALL SEARCH_TV(ADDR(TV_START_NAME),START$,DEF$);

  13237  6 001674   000027 236000 7                  LDQ     23
         6 001675   200054 756100                    STQ     SIZE+11,,AUTO
         6 001676   000035 236000 7                  LDQ     29
         6 001677   200037 756100                    STQ     @Q$+1,,AUTO
         6 001700   200021 630500                    EPPR0   START$,,AUTO
         6 001701   200036 450500                    STP0    @P$+1,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:101  
         6 001702   200054 631500                    EPPR1   SIZE+11,,AUTO
         6 001703   200035 451500                    STP1    MEM$+2,,AUTO
         6 001704   003670 701000 6                  TSX1    SEARCH_TV
         6 001705   000000 011000                    NOP     0

      733    13238    1       TV_EDEF.TV_START = START$->B$EDEF;

  13238  6 001706   200021 470500                    LDP0    START$,,AUTO
         6 001707   000000 100500                    MLR     fill='000'O
         6 001710   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001711   000500 000010 2                  ADSC9   TV_EDEF                  cn=0,n=8

      734    13239    1       IF START$ ~= RF_EDEF$

  13239  6 001712   200021 236100                    LDQ     START$,,AUTO
         6 001713   200020 116100                    CMPQ    RF_EDEF$,,AUTO
         6 001714   001734 600000 6                  TZE     s:13251

      735    13240    1       THEN
      736    13241    2       DO;

      737    13242    2           TPTR$ = PINCRW(START$,-SIZEW(B$EDEF));

  13242  6 001715   777776 036003                    ADLQ    -2,DU
         6 001716   200022 756100                    STQ     TPTR$,,AUTO

      738    13243    2           IF TPTR$->B$EDEF.ISADDR = START$->B$EDEF.ISADDR

  13243  6 001717   200022 471500                    LDP1    TPTR$,,AUTO
         6 001720   100000 236100                    LDQ     0,,PR1
         6 001721   000000 676100                    ERQ     0,,PR0
         6 001722   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 001723   001734 601000 6                  TNZ     s:13251

      739    13244    2           THEN
      740    13245    3           DO;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:102  
      741    13246    3               START$->B$EDEF = TPTR$->B$EDEF;

  13246  6 001724   000100 100500                    MLR     fill='000'O
         6 001725   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 001726   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

      742    13247    3               TPTR$->B$EDEF = TV_EDEF.TV_START;

  13247  6 001727   000500 237000 2                  LDAQ    TV_EDEF
         6 001730   100000 755100                    STA     0,,PR1
         6 001731   100001 756100                    STQ     1,,PR1

      743    13248    3               START$ = TPTR$;

  13248  6 001732   200022 236100                    LDQ     TPTR$,,AUTO
         6 001733   200021 756100                    STQ     START$,,AUTO

      744    13249    3               END;

      745    13250    2           END;

      746    13251    1       CALL SEARCH_TV(ADDR(TV_END_NAME),STOP$,DEF$);

  13251  6 001734   000030 236000 7                  LDQ     24
         6 001735   200055 756100                    STQ     SIZE+12,,AUTO
         6 001736   000035 236000 7                  LDQ     29
         6 001737   200037 756100                    STQ     @Q$+1,,AUTO
         6 001740   200031 630500                    EPPR0   STOP$,,AUTO
         6 001741   200036 450500                    STP0    @P$+1,,AUTO
         6 001742   200055 631500                    EPPR1   SIZE+12,,AUTO
         6 001743   200035 451500                    STP1    MEM$+2,,AUTO
         6 001744   003670 701000 6                  TSX1    SEARCH_TV
         6 001745   000000 011000                    NOP     0

      747    13252    1       TV_EDEF.TV_END = STOP$->B$EDEF;

  13252  6 001746   200031 470500                    LDP0    STOP$,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:103  
         6 001747   000000 100500                    MLR     fill='000'O
         6 001750   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001751   000502 000010 2                  ADSC9   TV_EDEF+2                cn=0,n=8

      748    13253    1       TEMP = POFFW(START$,RF_EDEF$)/SIZEW(B$EDEF);

  13253  6 001752   200020 235100                    LDA     RF_EDEF$,,AUTO
         6 001753   000022 771000                    ARL     18
         6 001754   200042 755100                    STA     SIZE+1,,AUTO
         6 001755   200021 236100                    LDQ     START$,,AUTO
         6 001756   000022 772000                    QRL     18
         6 001757   200042 136100                    SBLQ    SIZE+1,,AUTO
         6 001760   000002 506007                    DIV     2,DL
         6 001761   200010 756100                    STQ     TEMP,,AUTO

      749    13254    2       DO I = 0 TO TEMP;

  13254  6 001762   200004 450100                    STZ     I,,AUTO
         6 001763   002021 710000 6                  TRA     s:13264+3

      750    13255    2           TEMP_EDEF = RF_EDEF$->B$EDEF;

  13255  6 001764   200020 470500                    LDP0    RF_EDEF$,,AUTO
         6 001765   000100 100500                    MLR     fill='000'O
         6 001766   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001767   200014 000010                    ADSC9   TEMP_EDEF,,AUTO          cn=0,n=8

      751    13256    2           TPTR$ = RF_EDEF$;

  13256  6 001770   200020 236100                    LDQ     RF_EDEF$,,AUTO
         6 001771   200022 756100                    STQ     TPTR$,,AUTO

      752    13257    3           DO WHILE(TPTR$ < STOP$);

  13257  6 001772   200031 116100                    CMPQ    STOP$,,AUTO
         6 001773   002007 603000 6                  TRC     s:13262

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:104  
      753    13258    3               TPTR1$ = PINCRW(TPTR$,SIZEW(B$EDEF));

  13258  6 001774   200022 236100                    LDQ     TPTR$,,AUTO
         6 001775   000002 036003                    ADLQ    2,DU
         6 001776   000635 756000 2                  STQ     TPTR1$

      754    13259    3               TPTR$->B$EDEF = TPTR1$->B$EDEF;

  13259  6 001777   000635 470400 2                  LDP0    TPTR1$
         6 002000   200022 471500                    LDP1    TPTR$,,AUTO
         6 002001   000100 100500                    MLR     fill='000'O
         6 002002   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 002003   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

      755    13260    3               TPTR$ = TPTR1$;

  13260  6 002004   200022 756100                    STQ     TPTR$,,AUTO

      756    13261    3               END;

  13261  6 002005   200031 116100                    CMPQ    STOP$,,AUTO
         6 002006   001774 602000 6                  TNC     s:13258

      757    13262    2           STOP$->B$EDEF = TEMP_EDEF;

  13262  6 002007   200031 470500                    LDP0    STOP$,,AUTO
         6 002010   200014 237100                    LDAQ    TEMP_EDEF,,AUTO
         6 002011   000000 755100                    STA     0,,PR0
         6 002012   000001 756100                    STQ     1,,PR0

      758    13263    2           STOP$ = PINCRW(STOP$,-SIZEW(B$EDEF));

  13263  6 002013   200031 236100                    LDQ     STOP$,,AUTO
         6 002014   777776 036003                    ADLQ    -2,DU
         6 002015   200031 756100                    STQ     STOP$,,AUTO

      759    13264    2           END;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:105  

  13264  6 002016   200004 235100                    LDA     I,,AUTO
         6 002017   000001 035007                    ADLA    1,DL
         6 002020   200004 755100                    STA     I,,AUTO
         6 002021   200010 236100                    LDQ     TEMP,,AUTO
         6 002022   200004 116100                    CMPQ    I,,AUTO
         6 002023   001764 603000 6                  TRC     s:13255

      760    13265    1       BEGIN$ = STOP$; /* Name$ point to start of non transvect */

  13265  6 002024   200031 236100                    LDQ     STOP$,,AUTO
         6 002025   200026 756100                    STQ     BEGIN$,,AUTO

      761    13266    1       TEMP = (POFFW(END$,BEGIN$) + SIZEW(B$EDEF))/SIZEW(B$EDEF);

  13266  6 002026   200026 235100                    LDA     BEGIN$,,AUTO
         6 002027   000022 771000                    ARL     18
         6 002030   200042 755100                    STA     SIZE+1,,AUTO
         6 002031   200027 236100                    LDQ     END$,,AUTO
         6 002032   000022 772000                    QRL     18
         6 002033   200042 136100                    SBLQ    SIZE+1,,AUTO
         6 002034   000002 036007                    ADLQ    2,DL
         6 002035   000002 506007                    DIV     2,DL
         6 002036   200010 756100                    STQ     TEMP,,AUTO

      762    13267    1       CALL SORT_BY_NAME(BEGIN$->B$EDEF);

  13267  6 002037   200026 236100                    LDQ     BEGIN$,,AUTO
         6 002040   200035 756100                    STQ     MEM$+2,,AUTO
         6 002041   003546 701000 6                  TSX1    SORT_BY_NAME
         6 002042   000000 011000                    NOP     0

      763    13268         /**/
      764    13269         /* Fix up the transfer vector */
      765    13270         /**/
      766    13271
      767    13272    1       LL_LOBUF = 'C   ';
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:106  

  13272  6 002043   040000 100400                    MLR     fill='040'O
         6 002044   000166 000004 1                  ADSC9   TV_DEF_NAMES+103         cn=0,n=4
         6 002045   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

      768    13273    1       CALL LLM$MON_SVC(LL#WRITELO);

  13273  6 002046   000054 630400 7                  EPPR0   44
         6 002047   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002050   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002051   000000 011000                    NOP     0

      769    13274    1       LL_LOBUF = 'C ************* TRANSFER VECTOR **************';

  13274  6 002052   040000 100400                    MLR     fill='040'O
         6 002053   000167 000056 1                  ADSC9   TV_DEF_NAMES+104         cn=0,n=46
         6 002054   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

      770    13275    1       CALL LLM$MON_SVC(LL#WRITELO);

  13275  6 002055   000054 630400 7                  EPPR0   44
         6 002056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002057   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002060   000000 011000                    NOP     0

      771    13276    1       START$ = RF_EDEF$;

  13276  6 002061   200020 236100                    LDQ     RF_EDEF$,,AUTO
         6 002062   200021 756100                    STQ     START$,,AUTO

      772    13277    1       TPTR1$ = STOP$;

  13277  6 002063   200031 236100                    LDQ     STOP$,,AUTO
         6 002064   000635 756000 2                  STQ     TPTR1$

      773    13278    1       OFFSET = TV_EDEF.TV_START.ISADDR;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:107  
  13278  6 002065   000500 236000 2                  LDQ     TV_EDEF
         6 002066   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 002067   000630 756000 2                  STQ     OFFSET

      774    13279    2       DO WHILE (START$ < STOP$ );

  13279  6 002070   200021 236100                    LDQ     START$,,AUTO
         6 002071   200031 116100                    CMPQ    STOP$,,AUTO
         6 002072   002367 603000 6                  TRC     s:13332

      775    13280    3           DO WHILE(OFFSET < START$->B$EDEF.ISADDR);

  13280  6 002073   200021 470500                    LDP0    START$,,AUTO
         6 002074   000000 236100                    LDQ     0,,PR0
         6 002075   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 002076   000630 116000 2                  CMPQ    OFFSET
         6 002077   002125 602000 6                  TNC     s:13286
         6 002100   002125 600000 6                  TZE     s:13286

      776    13281    3               CALL LLI$BINHEX(OFFSET,6,EMPTY_MSG.MSG.ADDR1);

  13281  6 002101   000055 630400 7                  EPPR0   45
         6 002102   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 002103   000000 701000 xent               TSX1    LLI$BINHEX
         6 002104   000000 011000                    NOP     0

      777    13282    3               LL_LOBUF = EMPTY_MSG.BUFFER;

  13282  6 002105   040000 100400                    MLR     fill='040'O
         6 002106   000615 000025 2                  ADSC9   EMPTY_MSG                cn=0,n=21
         6 002107   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

      778    13283    3               CALL LLM$MON_SVC(LL#WRITELO);

  13283  6 002110   000054 630400 7                  EPPR0   44
         6 002111   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002112   000000 701000 xent               TSX1    LLM$MON_SVC
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:108  
         6 002113   000000 011000                    NOP     0

      779    13284    3               OFFSET = OFFSET + 3;

  13284  6 002114   000630 235000 2                  LDA     OFFSET
         6 002115   000003 035007                    ADLA    3,DL
         6 002116   000630 755000 2                  STA     OFFSET

      780    13285    3               END;

  13285  6 002117   200021 470500                    LDP0    START$,,AUTO
         6 002120   000000 236100                    LDQ     0,,PR0
         6 002121   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 002122   000630 116000 2                  CMPQ    OFFSET
         6 002123   002125 600000 6                  TZE     s:13286
         6 002124   002101 603000 6                  TRC     s:13281

      781    13286    2           NAME1$ = PINCRW(DEF$,START$->B$EDEF.NPOINTER);

  13286  6 002125   000001 220100                    LDX0    1,,PR0
         6 002126   000000 636010                    EAQ     0,X0
         6 002127   000633 036000 2                  ADLQ    DEF$
         6 002130   200023 756100                    STQ     NAME1$,,AUTO

      782    13287    2           TV_MSG.MSG.NAME2 = NAME1$->B$DNAME.TEXT;

  13287  6 002131   200023 471500                    LDP1    NAME1$,,AUTO
         6 002132   100000 220100                    LDX0    0,,PR1
         6 002133   040000 100540                    MLR     fill='040'O
         6 002134   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         6 002135   000560 200040 2                  ADSC9   TV_MSG+13                cn=1,n=32

      783    13288    2           CALL LLI$BINHEX(OFFSET,6,TV_MSG.MSG.ADDR1);

  13288  6 002136   000060 630400 7                  EPPR0   48
         6 002137   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 002140   000000 701000 xent               TSX1    LLI$BINHEX
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:109  
         6 002141   000000 011000                    NOP     0

      784    13289    2           TPTR$ = BEGIN$;

  13289  6 002142   200026 236100                    LDQ     BEGIN$,,AUTO
         6 002143   200022 756100                    STQ     TPTR$,,AUTO

      785    13290    3           DO WHILE ( TPTR$ <= END$ );

  13290  6 002144   200027 116100                    CMPQ    END$,,AUTO
         6 002145   002147 600000 6                  TZE     s:13291
         6 002146   002173 603000 6                  TRC     s:13297

      786    13291    3               NAME2$ = PINCRW(DEF$,TPTR$->B$EDEF.NPOINTER);

  13291  6 002147   200022 470500                    LDP0    TPTR$,,AUTO
         6 002150   000001 220100                    LDX0    1,,PR0
         6 002151   000000 636010                    EAQ     0,X0
         6 002152   000633 036000 2                  ADLQ    DEF$
         6 002153   200024 756100                    STQ     NAME2$,,AUTO

      787    13292    3              IF NAME2$->B$DNAME.TEXT = SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.
             13292                        COUNT-1)

  13292  6 002154   200024 471500                    LDP1    NAME2$,,AUTO
         6 002155   100000 220100                    LDX0    0,,PR1
         6 002156   200023 473500                    LDP3    NAME1$,,AUTO
         6 002157   300000 221100                    LDX1    0,,PR3
         6 002160   777777 622011                    EAX2    -1,X1
         6 002161   040140 106540                    CMPC    fill='040'O
         6 002162   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         6 002163   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         6 002164   002173 600000 6                  TZE     s:13297

      788    13293    3               THEN
      789    13294    3                   EXIT;
      790    13295    3               ELSE TPTR$ = PINCRW(TPTR$,SIZEW(B$EDEF));
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:110  

  13295  6 002165   200022 236100                    LDQ     TPTR$,,AUTO
         6 002166   000002 036003                    ADLQ    2,DU
         6 002167   200022 756100                    STQ     TPTR$,,AUTO

      791    13296    3               END;

  13296  6 002170   200027 116100                    CMPQ    END$,,AUTO
         6 002171   002147 602000 6                  TNC     s:13291
         6 002172   002147 600000 6                  TZE     s:13291

      792    13297    2           TV_MSG.MSG.NAME1 = SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.COUNT-1);

  13297  6 002173   200023 470500                    LDP0    NAME1$,,AUTO
         6 002174   000000 220100                    LDX0    0,,PR0
         6 002175   777777 621010                    EAX1    -1,X0
         6 002176   040000 100540                    MLR     fill='040'O
         6 002177   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         6 002200   000545 600037 2                  ADSC9   TV_MSG+2                 cn=3,n=31

      793    13298    2           I = TPTR$->B$EDEF.ISADDR;

  13298  6 002201   200022 471500                    LDP1    TPTR$,,AUTO
         6 002202   100000 236100                    LDQ     0,,PR1
         6 002203   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 002204   200004 756100                    STQ     I,,AUTO

      794    13299    2           CALL LLI$BINHEX(I,6,TV_MSG.MSG.ADDR2);

  13299  6 002205   000063 236000 7                  LDQ     51
         6 002206   200044 756100                    STQ     SIZE+3,,AUTO
         6 002207   000056 236000 7                  LDQ     46
         6 002210   200043 756100                    STQ     SIZE+2,,AUTO
         6 002211   200004 633500                    EPPR3   I,,AUTO
         6 002212   200042 453500                    STP3    SIZE+1,,AUTO
         6 002213   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 002214   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:111  
         6 002215   000000 701000 xent               TSX1    LLI$BINHEX
         6 002216   000000 011000                    NOP     0

      795    13300    2           I = START$->B$EDEF.NPOINTER;

  13300  6 002217   200021 470500                    LDP0    START$,,AUTO
         6 002220   000001 236100                    LDQ     1,,PR0
         6 002221   000022 732000                    QRS     18
         6 002222   200004 756100                    STQ     I,,AUTO

      796    13301    2           START$->B$EDEF.NPOINTER = TPTR$->B$EDEF.NPOINTER;

  13301  6 002223   200022 471500                    LDP1    TPTR$,,AUTO
         6 002224   100001 220100                    LDX0    1,,PR1
         6 002225   000001 740100                    STX0    1,,PR0

      797    13302    2           TPTR$->B$EDEF.NPOINTER = I;

  13302  6 002226   200004 720100                    LXL0    I,,AUTO
         6 002227   100001 740100                    STX0    1,,PR1

      798    13303    2           TEMP_EDEF = TPTR$->B$EDEF;

  13303  6 002230   000100 100500                    MLR     fill='000'O
         6 002231   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 002232   200014 000010                    ADSC9   TEMP_EDEF,,AUTO          cn=0,n=8

      799    13304    2           TPTR2$ = PINCRW(TPTR$,-SIZEW(B$EDEF));

  13304  6 002233   200022 236100                    LDQ     TPTR$,,AUTO
         6 002234   777776 036003                    ADLQ    -2,DU
         6 002235   000636 756000 2                  STQ     TPTR2$

      800    13305    3           DO WHILE (TPTR2$ >= BEGIN$);

  13305  6 002236   200026 116100                    CMPQ    BEGIN$,,AUTO
         6 002237   002262 602000 6                  TNC     s:13311
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:112  

      801    13306    3               IF PINCRW(DEF$,TPTR2$->B$EDEF.NPOINTER)->B$DNAME.TEXT

  13306  6 002240   000636 470400 2                  LDP0    TPTR2$
         6 002241   000001 220100                    LDX0    1,,PR0
         6 002242   000633 471400 2                  LDP1    DEF$
         6 002243   100000 221110                    LDX1    0,X0,PR1
         6 002244   200023 473500                    LDP3    NAME1$,,AUTO
         6 002245   300000 222100                    LDX2    0,,PR3
         6 002246   777777 623012                    EAX3    -1,X2
         6 002247   000000 635010                    EAA     0,X0
         6 002250   000020 731000                    ARS     16
         6 002251   040140 106545                    CMPC    fill='040'O
         6 002252   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
         6 002253   300000 400013                    ADSC9   0,,PR3                   cn=2,n=*X3
         6 002254   002262 601000 6                  TNZ     s:13311

      802    13307    3                  ~= SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.COUNT-1)
      803    13308    3               THEN EXIT;
      804    13309    3               TPTR2$ = PINCRW(TPTR2$,-SIZEW(B$EDEF));

  13309  6 002255   000636 236000 2                  LDQ     TPTR2$
         6 002256   777776 036003                    ADLQ    -2,DU
         6 002257   000636 756000 2                  STQ     TPTR2$

      805    13310    3               END;

  13310  6 002260   200026 116100                    CMPQ    BEGIN$,,AUTO
         6 002261   002240 603000 6                  TRC     s:13306

      806    13311    2           TPTR3$ = PINCRW(TPTR$,SIZEW(B$EDEF));

  13311  6 002262   200022 236100                    LDQ     TPTR$,,AUTO
         6 002263   000002 036003                    ADLQ    2,DU
         6 002264   200032 756100                    STQ     TPTR3$,,AUTO

      807    13312    3           DO WHILE(TPTR3$ <= END$);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:113  

  13312  6 002265   200027 116100                    CMPQ    END$,,AUTO
         6 002266   002270 600000 6                  TZE     s:13313
         6 002267   002313 603000 6                  TRC     s:13318

      808    13313    3               IF PINCRW(DEF$,TPTR3$->B$EDEF.NPOINTER)->B$DNAME.TEXT

  13313  6 002270   200032 470500                    LDP0    TPTR3$,,AUTO
         6 002271   000001 220100                    LDX0    1,,PR0
         6 002272   000633 471400 2                  LDP1    DEF$
         6 002273   100000 221110                    LDX1    0,X0,PR1
         6 002274   200023 473500                    LDP3    NAME1$,,AUTO
         6 002275   300000 222100                    LDX2    0,,PR3
         6 002276   777777 623012                    EAX3    -1,X2
         6 002277   000000 635010                    EAA     0,X0
         6 002300   000020 731000                    ARS     16
         6 002301   040140 106545                    CMPC    fill='040'O
         6 002302   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
         6 002303   300000 400013                    ADSC9   0,,PR3                   cn=2,n=*X3
         6 002304   002313 601000 6                  TNZ     s:13318

      809    13314    3                  ~= SUBSTR(NAME1$->B$DNAME.TEXT,0,NAME1$->B$DNAME.COUNT-1)
      810    13315    3               THEN EXIT;
      811    13316    3               ELSE TPTR3$ = PINCRW(TPTR3$,SIZEW(B$EDEF));

  13316  6 002305   200032 236100                    LDQ     TPTR3$,,AUTO
         6 002306   000002 036003                    ADLQ    2,DU
         6 002307   200032 756100                    STQ     TPTR3$,,AUTO

      812    13317    3               END;

  13317  6 002310   200027 116100                    CMPQ    END$,,AUTO
         6 002311   002270 602000 6                  TNC     s:13313
         6 002312   002270 600000 6                  TZE     s:13313

      813    13318    2           TPTR3$ = PINCRW(TPTR3$,-SIZEW(B$EDEF));

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:114  
  13318  6 002313   200032 236100                    LDQ     TPTR3$,,AUTO
         6 002314   777776 036003                    ADLQ    -2,DU
         6 002315   200032 756100                    STQ     TPTR3$,,AUTO

      814    13319    3           DO WHILE (TPTR2$ >= BEGIN$);

  13319  6 002316   000636 236000 2                  LDQ     TPTR2$
         6 002317   200026 116100                    CMPQ    BEGIN$,,AUTO
         6 002320   002336 602000 6                  TNC     s:13324

      815    13320    3               TPTR3$->B$EDEF = TPTR2$->B$EDEF;

  13320  6 002321   000636 470400 2                  LDP0    TPTR2$
         6 002322   200032 471500                    LDP1    TPTR3$,,AUTO
         6 002323   000100 100500                    MLR     fill='000'O
         6 002324   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 002325   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

      816    13321    3               TPTR3$ = PINCRW(TPTR3$,-SIZEW(B$EDEF));

  13321  6 002326   200032 236100                    LDQ     TPTR3$,,AUTO
         6 002327   777776 036003                    ADLQ    -2,DU
         6 002330   200032 756100                    STQ     TPTR3$,,AUTO

      817    13322    3               TPTR2$ = PINCRW(TPTR2$,-SIZEW(B$EDEF));

  13322  6 002331   000636 236000 2                  LDQ     TPTR2$
         6 002332   777776 036003                    ADLQ    -2,DU
         6 002333   000636 756000 2                  STQ     TPTR2$

      818    13323    3               END;

  13323  6 002334   200026 116100                    CMPQ    BEGIN$,,AUTO
         6 002335   002321 603000 6                  TRC     s:13320

      819    13324    2           BEGIN$ = PINCRW(TPTR3$,SIZEW(B$EDEF));

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:115  
  13324  6 002336   200032 236100                    LDQ     TPTR3$,,AUTO
         6 002337   000002 036003                    ADLQ    2,DU
         6 002340   200026 756100                    STQ     BEGIN$,,AUTO

      820    13325    2           TPTR1$->B$EDEF = TEMP_EDEF;

  13325  6 002341   000635 470400 2                  LDP0    TPTR1$
         6 002342   200014 237100                    LDAQ    TEMP_EDEF,,AUTO
         6 002343   000000 755100                    STA     0,,PR0
         6 002344   000001 756100                    STQ     1,,PR0

      821    13326    2           TPTR1$ = PINCRW(TPTR1$,SIZEW(B$EDEF));

  13326  6 002345   000635 236000 2                  LDQ     TPTR1$
         6 002346   000002 036003                    ADLQ    2,DU
         6 002347   000635 756000 2                  STQ     TPTR1$

      822    13327    2           LL_LOBUF = TV_MSG.BUFFER;

  13327  6 002350   040000 100400                    MLR     fill='040'O
         6 002351   000543 000125 2                  ADSC9   TV_MSG                   cn=0,n=85
         6 002352   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

      823    13328    2           CALL LLM$MON_SVC(LL#WRITELO);

  13328  6 002353   000054 630400 7                  EPPR0   44
         6 002354   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002355   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002356   000000 011000                    NOP     0

      824    13329    2           START$ = PINCRW(START$,SIZEW(B$EDEF));

  13329  6 002357   200021 236100                    LDQ     START$,,AUTO
         6 002360   000002 036003                    ADLQ    2,DU
         6 002361   200021 756100                    STQ     START$,,AUTO

      825    13330    2           OFFSET = OFFSET + 3;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:116  

  13330  6 002362   000630 235000 2                  LDA     OFFSET
         6 002363   000003 035007                    ADLA    3,DL
         6 002364   000630 755000 2                  STA     OFFSET

      826    13331    2           END; /* START$ < = STOP$ */

  13331  6 002365   200031 116100                    CMPQ    STOP$,,AUTO
         6 002366   002073 602000 6                  TNC     s:13280

      827    13332    2       DO WHILE (OFFSET < TV_EDEF.TV_END.ISADDR);

  13332  6 002367   000502 236000 2                  LDQ     TV_EDEF+2
         6 002370   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 002371   000630 116000 2                  CMPQ    OFFSET
         6 002372   002417 602000 6                  TNC     s:13341
         6 002373   002417 600000 6                  TZE     s:13341

      828    13333    2           CALL LLI$BINHEX(OFFSET,6,EMPTY_MSG.MSG.ADDR1);

  13333  6 002374   000055 630400 7                  EPPR0   45
         6 002375   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 002376   000000 701000 xent               TSX1    LLI$BINHEX
         6 002377   000000 011000                    NOP     0

      829    13334    2           LL_LOBUF = EMPTY_MSG.BUFFER;

  13334  6 002400   040000 100400                    MLR     fill='040'O
         6 002401   000615 000025 2                  ADSC9   EMPTY_MSG                cn=0,n=21
         6 002402   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

      830    13335    2           CALL LLM$MON_SVC(LL#WRITELO);

  13335  6 002403   000054 630400 7                  EPPR0   44
         6 002404   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002405   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002406   000000 011000                    NOP     0
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:117  

      831    13336    2           OFFSET = OFFSET + 3;

  13336  6 002407   000630 235000 2                  LDA     OFFSET
         6 002410   000003 035007                    ADLA    3,DL
         6 002411   000630 755000 2                  STA     OFFSET

      832    13337    2           END;

  13337  6 002412   000502 236000 2                  LDQ     TV_EDEF+2
         6 002413   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 002414   000630 116000 2                  CMPQ    OFFSET
         6 002415   002417 600000 6                  TZE     s:13341
         6 002416   002374 603000 6                  TRC     s:13333

      833    13338         /**/
      834    13339         /* Display ENTDEF not in transfer vector */
      835    13340         /**/
      836    13341    1       LL_LOBUF = 'C       ';

  13341  6 002417   040000 100400                    MLR     fill='040'O
         6 002420   000203 000010 1                  ADSC9   TV_DEF_NAMES+116         cn=0,n=8
         6 002421   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

      837    13342    1       CALL LLM$MON_SVC(LL#WRITELO);

  13342  6 002422   000054 630400 7                  EPPR0   44
         6 002423   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002424   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002425   000000 011000                    NOP     0

      838    13343    1       LL_LOBUF = 'C *******ENTRY DEFINITIONS NOT IN TRANSFER VECTOR***********';

  13343  6 002426   040000 100400                    MLR     fill='040'O
         6 002427   000205 000074 1                  ADSC9   TV_DEF_NAMES+118         cn=0,n=60
         6 002430   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:118  
      839    13344    1       CALL LLM$MON_SVC(LL#WRITELO);

  13344  6 002431   000054 630400 7                  EPPR0   44
         6 002432   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002433   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002434   000000 011000                    NOP     0

      840    13345    1       J = 0;

  13345  6 002435   200005 450100                    STZ     J,,AUTO

      841    13346    1       TPTR$ = BEGIN$;

  13346  6 002436   200026 236100                    LDQ     BEGIN$,,AUTO
         6 002437   200022 756100                    STQ     TPTR$,,AUTO

      842    13347    2       DO WHILE( TPTR$ <= END$);

  13347  6 002440   200027 116100                    CMPQ    END$,,AUTO
         6 002441   002443 600000 6                  TZE     s:13348
         6 002442   002541 603000 6                  TRC     s:13368

      843    13348    2           NAME1$ = PINCRW(DEF$,TPTR$->B$EDEF.NPOINTER);

  13348  6 002443   200022 470500                    LDP0    TPTR$,,AUTO
         6 002444   000001 220100                    LDX0    1,,PR0
         6 002445   000000 636010                    EAQ     0,X0
         6 002446   000633 036000 2                  ADLQ    DEF$
         6 002447   200023 756100                    STQ     NAME1$,,AUTO

      844    13349    2           TPTR2$ = PINCRW(TPTR$,SIZEW(B$EDEF));

  13349  6 002450   200022 236100                    LDQ     TPTR$,,AUTO
         6 002451   000002 036003                    ADLQ    2,DU
         6 002452   000636 756000 2                  STQ     TPTR2$

      845    13350    3           DO WHILE ( TPTR2$ <= END$);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:119  

  13350  6 002453   200027 116100                    CMPQ    END$,,AUTO
         6 002454   002456 600000 6                  TZE     s:13351
         6 002455   002500 603000 6                  TRC     s:13356

      846    13351    3               IF PINCRW(DEF$,TPTR2$->B$EDEF.NPOINTER)->B$DNAME.TEXT

  13351  6 002456   000636 470400 2                  LDP0    TPTR2$
         6 002457   000001 220100                    LDX0    1,,PR0
         6 002460   000633 471400 2                  LDP1    DEF$
         6 002461   100000 221110                    LDX1    0,X0,PR1
         6 002462   200023 473500                    LDP3    NAME1$,,AUTO
         6 002463   300000 222100                    LDX2    0,,PR3
         6 002464   000000 635010                    EAA     0,X0
         6 002465   000020 731000                    ARS     16
         6 002466   040140 106545                    CMPC    fill='040'O
         6 002467   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
         6 002470   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         6 002471   002500 601000 6                  TNZ     s:13356

      847    13352    3                  ~= NAME1$->B$DNAME.TEXT
      848    13353    3               THEN EXIT;
      849    13354    3               TPTR2$ = PINCRW(TPTR2$,SIZEW(B$EDEF));

  13354  6 002472   000636 236000 2                  LDQ     TPTR2$
         6 002473   000002 036003                    ADLQ    2,DU
         6 002474   000636 756000 2                  STQ     TPTR2$

      850    13355    3               END;

  13355  6 002475   200027 116100                    CMPQ    END$,,AUTO
         6 002476   002456 602000 6                  TNC     s:13351
         6 002477   002456 600000 6                  TZE     s:13351

      851    13356    2           IF J = 2

  13356  6 002500   200005 235100                    LDA     J,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:120  
         6 002501   000002 115007                    CMPA    2,DL
         6 002502   002516 601000 6                  TNZ     s:13364

      852    13357    2           THEN
      853    13358    3           DO;

      854    13359    3               LL_LOBUF = BUFFER.TWO;

  13359  6 002503   040000 100400                    MLR     fill='040'O
         6 002504   000571 000120 2                  ADSC9   BUFFER                   cn=0,n=80
         6 002505   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

      855    13360    3               CALL LLM$MON_SVC(LL#WRITELO);

  13360  6 002506   000054 630400 7                  EPPR0   44
         6 002507   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002510   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002511   000000 011000                    NOP     0

      856    13361    3               BUFFER.ONE.TEXT = ' ';

  13361  6 002512   040000 100400                    MLR     fill='040'O
         6 002513   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002514   000571 200117 2                  ADSC9   BUFFER                   cn=1,n=79

      857    13362    3               J = 0;

  13362  6 002515   200005 450100                    STZ     J,,AUTO

      858    13363    3               END;

      859    13364    2           CALL INSERT(BUFFER.ONE.TEXT,J*40+5,,NAME1$->B$DNAME.TEXT);

  13364  6 002516   200023 470500                    LDP0    NAME1$,,AUTO
         6 002517   000000 220100                    LDX0    0,,PR0
         6 002520   000000 236003                    LDQ     0,DU
         6 002521   200005 136100                    SBLQ    J,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:121  
         6 002522   000050 402007                    MPY     40,DL
         6 002523   000112 621006                    EAX1    74,QL
         6 002524   200005 236100                    LDQ     J,,AUTO
         6 002525   000050 402007                    MPY     40,DL
         6 002526   040046 100540                    MLR     fill='040'O
         6 002527   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         6 002530   000572 400011 2                  ADSC9   BUFFER+1,Q               cn=2,n=*X1

      860    13365    2           J = J + 1;

  13365  6 002531   200005 235100                    LDA     J,,AUTO
         6 002532   000001 035007                    ADLA    1,DL
         6 002533   200005 755100                    STA     J,,AUTO

      861    13366    2           TPTR$ = TPTR2$;

  13366  6 002534   000636 236000 2                  LDQ     TPTR2$
         6 002535   200022 756100                    STQ     TPTR$,,AUTO

      862    13367    2           END;

  13367  6 002536   200027 116100                    CMPQ    END$,,AUTO
         6 002537   002443 602000 6                  TNC     s:13348
         6 002540   002443 600000 6                  TZE     s:13348

      863    13368    1       IF J > 0

  13368  6 002541   200005 235100                    LDA     J,,AUTO
         6 002542   002552 600000 6                  TZE     s:13374

      864    13369    1       THEN
      865    13370    2       DO;

      866    13371    2           LL_LOBUF = BUFFER.TWO;

  13371  6 002543   040000 100400                    MLR     fill='040'O
         6 002544   000571 000120 2                  ADSC9   BUFFER                   cn=0,n=80
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:122  
         6 002545   000000 000160 xsym               ADSC9   LL_LOBUF                 cn=0,n=112

      867    13372    2           CALL LLM$MON_SVC(LL#WRITELO);

  13372  6 002546   000054 630400 7                  EPPR0   44
         6 002547   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002550   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002551   000000 011000                    NOP     0

      868    13373    2           END;

      869    13374    1       IF TPTR1$ = BEGIN$

  13374  6 002552   000635 236000 2                  LDQ     TPTR1$
         6 002553   200026 116100                    CMPQ    BEGIN$,,AUTO
         6 002554   002561 601000 6                  TNZ     s:13379

      870    13375    1       THEN
      871    13376    1           TPTR1$ = PINCRW(END$,SIZEW(B$EDEF));

  13376  6 002555   200027 236100                    LDQ     END$,,AUTO
         6 002556   000002 036003                    ADLQ    2,DU
         6 002557   000635 756000 2                  STQ     TPTR1$
         6 002560   002602 710000 6                  TRA     s:13385

      872    13377    1       ELSE
      873    13378    2       DO;

      874    13379    3           DO WHILE(BEGIN$ <= END$);

  13379  6 002561   200027 236100                    LDQ     END$,,AUTO
         6 002562   200026 116100                    CMPQ    BEGIN$,,AUTO
         6 002563   002602 602000 6                  TNC     s:13385

      875    13380    3               TPTR1$->B$EDEF = BEGIN$->B$EDEF;

  13380  6 002564   200026 470500                    LDP0    BEGIN$,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:123  
         6 002565   000635 471400 2                  LDP1    TPTR1$
         6 002566   000100 100500                    MLR     fill='000'O
         6 002567   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 002570   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

      876    13381    3               TPTR1$ = PINCRW(TPTR1$,SIZEW(B$EDEF));

  13381  6 002571   000635 236000 2                  LDQ     TPTR1$
         6 002572   000002 036003                    ADLQ    2,DU
         6 002573   000635 756000 2                  STQ     TPTR1$

      877    13382    3               BEGIN$ = PINCRW(BEGIN$,SIZEW(B$EDEF));

  13382  6 002574   200026 236100                    LDQ     BEGIN$,,AUTO
         6 002575   000002 036003                    ADLQ    2,DU
         6 002576   200026 756100                    STQ     BEGIN$,,AUTO

      878    13383    3               END;

  13383  6 002577   200027 116100                    CMPQ    END$,,AUTO
         6 002600   002564 602000 6                  TNC     s:13380
         6 002601   002564 600000 6                  TZE     s:13380

      879    13384    2           END;

      880    13385    1       LL_HEAD.EPRECSIZE = POFFW(TPTR1$,RF_EDEF$);

  13385  6 002602   200020 235100                    LDA     RF_EDEF$,,AUTO
         6 002603   000022 771000                    ARL     18
         6 002604   200042 755100                    STA     SIZE+1,,AUTO
         6 002605   000635 236000 2                  LDQ     TPTR1$
         6 002606   000022 772000                    QRL     18
         6 002607   200042 136100                    SBLQ    SIZE+1,,AUTO
         6 002610   000000 620006                    EAX0    0,QL
         6 002611   000007 740000 xsym               STX0    LL_HEAD+7

      881    13386         /**/
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:124  
      882    13387         /* mark entdefs not in transfer vector if REMONE_ENTDEF is specified */
      883    13388         /**/
      884    13389
      885    13390    1       IF LL_FLAGS.REMOVE_E#

  13390  6 002612   000000 236000 xsym               LDQ     LL_FLAGS
         6 002613   000040 316007                    CANQ    32,DL
         6 002614   002634 600000 6                  TZE     s:13399

      886    13391    1       THEN
      887    13392    2       DO;

      888    13393    2           LL_HEAD.REMOVE_ENTDEF = '1'B;

  13393  6 002615   000040 236007                    LDQ     32,DL
         6 002616   000011 256000 xsym               ORSQ    LL_HEAD+9

      889    13394    3           DO WHILE ( STOP$ < TPTR1$);

  13394  6 002617   200031 236100                    LDQ     STOP$,,AUTO
         6 002620   000635 116000 2                  CMPQ    TPTR1$
         6 002621   002634 603000 6                  TRC     s:13399

      890    13395    3               STOP$->B$EDEF.LFLAGS.SOURCE = %SOURCE_REMOVED#;

  13395  6 002622   200031 470500                    LDP0    STOP$,,AUTO
         6 002623   000000 236100                    LDQ     0,,PR0
         6 002624   000064 376000 7                  ANQ     52
         6 002625   500000 276003                    ORQ     -98304,DU
         6 002626   000000 756100                    STQ     0,,PR0

      891    13396    3               STOP$ = PINCRW(STOP$,SIZEW(B$EDEF));

  13396  6 002627   200031 236100                    LDQ     STOP$,,AUTO
         6 002630   000002 036003                    ADLQ    2,DU
         6 002631   200031 756100                    STQ     STOP$,,AUTO

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:125  
      892    13397    3               END;

  13397  6 002632   000635 116000 2                  CMPQ    TPTR1$
         6 002633   002622 602000 6                  TNC     s:13395

      893    13398    2           END;

      894    13399    1       TEMP = (POFFW(TPTR1$,RF_EDEF$))/SIZEW(B$EDEF);

  13399  6 002634   200020 235100                    LDA     RF_EDEF$,,AUTO
         6 002635   000022 771000                    ARL     18
         6 002636   200042 755100                    STA     SIZE+1,,AUTO
         6 002637   000635 236000 2                  LDQ     TPTR1$
         6 002640   000022 772000                    QRL     18
         6 002641   200042 136100                    SBLQ    SIZE+1,,AUTO
         6 002642   000002 506007                    DIV     2,DL
         6 002643   200010 756100                    STQ     TEMP,,AUTO

      895    13400    1       CALL SORT_BY_NAME(RF_EDEF$->B$EDEF);

  13400  6 002644   200020 236100                    LDQ     RF_EDEF$,,AUTO
         6 002645   200035 756100                    STQ     MEM$+2,,AUTO
         6 002646   003546 701000 6                  TSX1    SORT_BY_NAME
         6 002647   000000 011000                    NOP     0

      896    13401         /**/
      897    13402         /* Write entdef back to run unit */
      898    13403         /**/
      899    13404    1       B$RUKEY.TYPE = %TYPEDEF;

  13404  6 002650   000004 236003                    LDQ     4,DU
         6 002651   000476 552020 2                  STBQ    B$RUKEY,'20'O

      900    13405    1       I = LL_HEAD.EPRECSIZE * 4 - 1;

  13405  6 002652   000007 235000 xsym               LDA     LL_HEAD+7
         6 002653   777777 375003                    ANA     -1,DU
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:126  
         6 002654   000020 771000                    ARL     16
         6 002655   000001 135007                    SBLA    1,DL
         6 002656   200004 755100                    STA     I,,AUTO

      901    13406    1       CALL LLM$MON_SVC(LL#WRITERU,RF_EDEF$,I,B$RUKEY);

  13406  6 002657   000025 236000 7                  LDQ     21
         6 002660   200045 756100                    STQ     SIZE+4,,AUTO
         6 002661   200004 630500                    EPPR0   I,,AUTO
         6 002662   200044 450500                    STP0    SIZE+3,,AUTO
         6 002663   200020 631500                    EPPR1   RF_EDEF$,,AUTO
         6 002664   200043 451500                    STP1    SIZE+2,,AUTO
         6 002665   000066 236000 7                  LDQ     54
         6 002666   200042 756100                    STQ     SIZE+1,,AUTO
         6 002667   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 002670   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 002671   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002672   000000 011000                    NOP     0

      902    13407         /**/
      903    13408         /* Process REMOVE_SYMDEF if specified */
      904    13409         /**/
      905    13410
      906    13411    1       IF LL_FLAGS.REMOVE_S#

  13411  6 002673   000000 236000 xsym               LDQ     LL_FLAGS
         6 002674   000020 316007                    CANQ    16,DL
         6 002675   003014 600000 6                  TZE     s:13435

      907    13412    1       THEN
      908    13413    2       DO;

      909    13414    2           TEMP = LL_HEAD.EDRECSIZE;

  13414  6 002676   000007 236000 xsym               LDQ     LL_HEAD+7
         6 002677   777777 376007                    ANQ     -1,DL
         6 002700   200010 756100                    STQ     TEMP,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:127  

      910    13415    2           CALL LLM$MON_SVC(LL#GETMEM,TEMP,AVAIL$);

  13415  6 002701   200016 630500                    EPPR0   AVAIL$,,AUTO
         6 002702   200044 450500                    STP0    SIZE+3,,AUTO
         6 002703   200010 631500                    EPPR1   TEMP,,AUTO
         6 002704   200043 451500                    STP1    SIZE+2,,AUTO
         6 002705   000017 236000 7                  LDQ     15
         6 002706   200042 756100                    STQ     SIZE+1,,AUTO
         6 002707   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 002710   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 002711   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002712   000000 011000                    NOP     0

      911    13416    2           B$RUKEY.TYPE = %TYPSDEF;

  13416  6 002713   000006 236003                    LDQ     6,DU
         6 002714   000476 552020 2                  STBQ    B$RUKEY,'20'O

      912    13417    2           CALL LLM$MON_SVC(LL#READRU,AVAIL$,TEMP*4-1,B$RUKEY);

  13417  6 002715   200010 235100                    LDA     TEMP,,AUTO
         6 002716   000002 735000                    ALS     2
         6 002717   000001 135007                    SBLA    1,DL
         6 002720   200042 755100                    STA     SIZE+1,,AUTO
         6 002721   000025 236000 7                  LDQ     21
         6 002722   200047 756100                    STQ     SIZE+6,,AUTO
         6 002723   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 002724   200046 450500                    STP0    SIZE+5,,AUTO
         6 002725   200016 631500                    EPPR1   AVAIL$,,AUTO
         6 002726   200045 451500                    STP1    SIZE+4,,AUTO
         6 002727   000042 236000 7                  LDQ     34
         6 002730   200044 756100                    STQ     SIZE+3,,AUTO
         6 002731   200044 630500                    EPPR0   SIZE+3,,AUTO
         6 002732   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 002733   000000 701000 xent               TSX1    LLM$MON_SVC
         6 002734   000000 011000                    NOP     0
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:128  

      913    13418    2           TPTR$ = AVAIL$;

  13418  6 002735   200016 236100                    LDQ     AVAIL$,,AUTO
         6 002736   200022 756100                    STQ     TPTR$,,AUTO

      914    13419    2           TEMP = DCBADDR(DCBNUM(M$RU))->B$DCB.ARS#/4;

  13419  6 002737   000000 236007 xsym               LDQ     M$RU,DL
         6 002740   000026 470400 7                  LDP0    22
         6 002741   000000 471500                    LDP1    0,,PR0
         6 002742   100000 473506                    LDP3    0,QL,PR1
         6 002743   300000 236100                    LDQ     0,,PR3
         6 002744   000004 506007                    DIV     4,DL
         6 002745   200010 756100                    STQ     TEMP,,AUTO

      915    13420    2           IF TEMP > 0

  13420  6 002746   000000 116003                    CMPQ    0,DU
         6 002747   003014 600000 6                  TZE     s:13435

      916    13421    2           THEN
      917    13422    3           DO;

      918    13423    3               LL_HEAD.REMOVE_SYMDEF = '1'B;

  13423  6 002750   000020 236007                    LDQ     16,DL
         6 002751   000011 256000 xsym               ORSQ    LL_HEAD+9

      919    13424    4               DO I = 0 TO (TEMP/2-1);

  13424  6 002752   200004 450100                    STZ     I,,AUTO
         6 002753   002767 710000 6                  TRA     s:13427+3

      920    13425    4                   TPTR$->B$SDEF.LFLAGS.SOURCE = %SOURCE_REMOVED#;

  13425  6 002754   200022 470500                    LDP0    TPTR$,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:129  
         6 002755   000001 236100                    LDQ     1,,PR0
         6 002756   000067 376000 7                  ANQ     55
         6 002757   024000 276007                    ORQ     10240,DL
         6 002760   000001 756100                    STQ     1,,PR0

      921    13426    4                   TPTR$ = PINCRW(TPTR$,SIZEW(B$SDEF));

  13426  6 002761   200022 236100                    LDQ     TPTR$,,AUTO
         6 002762   000002 036003                    ADLQ    2,DU
         6 002763   200022 756100                    STQ     TPTR$,,AUTO

      922    13427    4                   END;

  13427  6 002764   200004 235100                    LDA     I,,AUTO
         6 002765   000001 035007                    ADLA    1,DL
         6 002766   200004 755100                    STA     I,,AUTO
         6 002767   200010 236100                    LDQ     TEMP,,AUTO
         6 002770   000001 772000                    QRL     1
         6 002771   200004 116100                    CMPQ    I,,AUTO
         6 002772   002774 600000 6                  TZE     s:13428
         6 002773   002754 603000 6                  TRC     s:13425

      923    13428    3               CALL LLM$MON_SVC(LL#WRITERU,AVAIL$,TEMP*4-1,B$RUKEY);

  13428  6 002774   200010 235100                    LDA     TEMP,,AUTO
         6 002775   000002 735000                    ALS     2
         6 002776   000001 135007                    SBLA    1,DL
         6 002777   200042 755100                    STA     SIZE+1,,AUTO
         6 003000   000025 236000 7                  LDQ     21
         6 003001   200047 756100                    STQ     SIZE+6,,AUTO
         6 003002   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 003003   200046 450500                    STP0    SIZE+5,,AUTO
         6 003004   200016 631500                    EPPR1   AVAIL$,,AUTO
         6 003005   200045 451500                    STP1    SIZE+4,,AUTO
         6 003006   000066 236000 7                  LDQ     54
         6 003007   200044 756100                    STQ     SIZE+3,,AUTO
         6 003010   200044 630500                    EPPR0   SIZE+3,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:130  
         6 003011   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 003012   000000 701000 xent               TSX1    LLM$MON_SVC
         6 003013   000000 011000                    NOP     0

      924    13429    3               END;

      925    13430    2           END;

      926    13431         /**/
      927    13432         /* Write HEAD record back to run unit */
      928    13433         /**/
      929    13434
      930    13435    1       CALL LLM$MON_SVC(LL#WRITERU,ADDR(LL_HEAD),SIZEC(LL_HEAD)-1,RF_HEAD_KEY);

  13435  6 003014   000070 236000 7                  LDQ     56
         6 003015   200042 756100                    STQ     SIZE+1,,AUTO
         6 003016   000072 237000 7                  LDAQ    58
         6 003017   200046 757100                    STAQ    SIZE+5,,AUTO
         6 003020   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 003021   200045 450500                    STP0    SIZE+4,,AUTO
         6 003022   000066 236000 7                  LDQ     54
         6 003023   200044 756100                    STQ     SIZE+3,,AUTO
         6 003024   200044 630500                    EPPR0   SIZE+3,,AUTO
         6 003025   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 003026   000000 701000 xent               TSX1    LLM$MON_SVC
         6 003027   000000 011000                    NOP     0

      931    13436
      932    13437         /**/
      933    13438         /* Delete the transfer vector file */
      934    13439         /**/
      935    13440
      936    13441    1       OPEN_TV.V.DELETE# = '1'B;

  13441  6 003030   040000 236007                    LDQ     16384,DL
         6 003031   000044 256000 2                  ORSQ    OPEN_TV+36

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:131  
      937    13442    1       CALL M$OPEN(OPEN_TV) ALTRET(ERROR);

  13442  6 003032   000000 630400 2                  EPPR0   OPEN_TV
         6 003033   450000 713400                    CLIMB   alt,open
         6 003034   410400 401760                    pmme    nvectors=18
         6 003035   003037 702000 6                  TSX2    ERROR

      938    13443    2       DO WHILE('0'B);

  13443  6 003036   003045 710000 6                  TRA     s:13448

      939    13444    2   ERROR:
      940    13445    2           CALL M$MERC;

  13445  6 003037   010007 713400       ERROR        CLIMB   4103
         6 003040   000000 401760                    pmme    nvectors=0

      941    13446    2           CALL LLM$MON_SVC(LL#ERR);

  13446  6 003041   000023 630400 7                  EPPR0   19
         6 003042   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 003043   000000 701000 xent               TSX1    LLM$MON_SVC
         6 003044   000000 011000                    NOP     0

      942    13447    2           END;

      943    13448    1       RETURN;

  13448  6 003045   000000 702200 xent               TSX2  ! X66_ARET

      944    13449        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:132  
      945    13450    1   SEARCH_ENTDEF: PROC(P$,FOUND$) ALTRET;

  13450  6 003046   200034 741300       SEARCH_ENTD* STX1  ! MEM$+1,,AUTO

      946    13451    2   DCL P$ PTR; /* point to entdef name being looked for */
      947    13452    2   DCL FOUND$ PTR; /* return location of entdef name already defined */
      948    13453    2   DCL Q$ PTR;
      949    13454    2   DCL DEF_NAME$ PTR;
      950    13455        %LL$NODE (NAME=TREE);
      951    13487        %B$EDEF(NAME= DEF);
      952    13557         /* Search for entdef record */
      953    13558    2       Q$ = LL_ENTDEF_R$;

  13558  6 003047   000000 236000 xsym               LDQ     LL_ENTDEF_R$
         6 003050   200037 756100                    STQ     Q$,,AUTO

      954    13559    3       DO WHILE (Q$ ~= ADDR(NIL));

  13559  6 003051   003106 710000 6                  TRA     s:13571

      955    13560    3           FOUND$ = Q$->TREE.NODE$;

  13560  6 003052   200037 470500                    LDP0    Q$,,AUTO
         6 003053   000001 236100                    LDQ     1,,PR0
         6 003054   200036 471500                    LDP1    @FOUND$,,AUTO
         6 003055   100000 756100                    STQ     0,,PR1

      956    13561    3           DEF_NAME$ = PINCRW(DEF$,FOUND$->DEF.NPOINTER);

  13561  6 003056   100000 473500                    LDP3    0,,PR1
         6 003057   300001 220100                    LDX0    1,,PR3
         6 003060   000000 636010                    EAQ     0,X0
         6 003061   000633 036000 2                  ADLQ    DEF$
         6 003062   200040 756100                    STQ     DEF_NAME$,,AUTO

      957    13562    3           IF P$->B$DNAME.TEXT > DEF_NAME$->B$DNAME.TEXT

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:133  
  13562  6 003063   200035 474500                    LDP4    @P$,,AUTO
         6 003064   400000 475500                    LDP5    0,,PR4
         6 003065   500000 221100                    LDX1    0,,PR5
         6 003066   200040 476500                    LDP6    DEF_NAME$,,AUTO
         6 003067   600000 222100                    LDX2    0,,PR6
         6 003070   040140 106540                    CMPC    fill='040'O
         6 003071   600000 400012                    ADSC9   0,,PR6                   cn=2,n=*X2
         6 003072   500000 400011                    ADSC9   0,,PR5                   cn=2,n=*X1
         6 003073   003077 603000 6                  TRC     s:13566

      958    13563    3           THEN
      959    13564    3               Q$ = Q$->TREE.R_CHILD$;

  13564  6 003074   000005 236100                    LDQ     5,,PR0
         6 003075   200037 756100                    STQ     Q$,,AUTO
         6 003076   003106 710000 6                  TRA     s:13571

      960    13565    3           ELSE
      961    13566    3               IF P$->B$DNAME.TEXT < DEF_NAME$->B$DNAME.TEXT

  13566  6 003077   003104 602000 6                  TNC     s:13570
         6 003100   003104 600000 6                  TZE     s:13570

      962    13567    3               THEN
      963    13568    3                   Q$ = Q$->TREE.L_CHILD$;

  13568  6 003101   000004 236100                    LDQ     4,,PR0
         6 003102   200037 756100                    STQ     Q$,,AUTO
         6 003103   003106 710000 6                  TRA     s:13571

      964    13569    3               ELSE
      965    13570    3                   RETURN;

  13570  6 003104   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003105   000001 702211                    TSX2  ! 1,X1

      966    13571    3           END;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:134  

  13571  6 003106   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 003107   003052 601000 6                  TNZ     s:13560

      967    13572    2       ALTRETURN;

  13572  6 003110   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003111   000000 702211                    TSX2  ! 0,X1

      968    13573    2   END SEARCH_ENTDEF;
      969    13574        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:135  
      970    13575    1   INSERT_VECTOR:PROC(NAME,EDEF);

  13575  6 003112   200034 741300       INSERT_VECT* STX1  ! MEM$+1,,AUTO

      971    13576        %B$DNAME (NAME = NAME ,STCLASS = " ");
      972    13595        %B$EDEF (NAME = EDEF ,STCLASS = " ");
      973    13665        %B$EREF;
      974    13708        %LL$NODE (NAME=NODE);
      975    13740    2   DCL NAME_SIZE UBIN;
      976    13741    2   DCL P$ PTR;
      977    13742    2   DCL K UBIN;
      978    13743    2       IF NOT EDEF.LFLAGS.USED

  13743  6 003113   200036 470500                    LDP0    @EDEF,,AUTO
         6 003114   000000 236100                    LDQ     0,,PR0
         6 003115   010000 316003                    CANQ    4096,DU
         6 003116   003122 601000 6                  TNZ     s:13748

      979    13744    2       THEN
      980    13745    2           EDEF.LFLAGS.USED = '1'B;

  13745  6 003117   010000 236003                    LDQ     4096,DU
         6 003120   000000 256100                    ORSQ    0,,PR0
         6 003121   003140 710000 6                  TRA     s:13753

      981    13746    2       ELSE
      982    13747    3       DO;

      983    13748    3           CALL CONCAT(LL_DOBUF,'A  *** Duplicate transfer vector element ignored: ',

  13748  6 003122   200035 471500                    LDP1    @NAME,,AUTO
         6 003123   100000 220100                    LDX0    0,,PR1
         6 003124   040000 100400                    MLR     fill='040'O
         6 003125   000224 000062 1                  ADSC9   TV_DEF_NAMES+133         cn=0,n=50
         6 003126   000000 000062 xsym               ADSC9   LL_DOBUF                 cn=0,n=50
         6 003127   040000 100540                    MLR     fill='040'O
         6 003130   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:136  
         6 003131   000014 400076 xsym               ADSC9   LL_DOBUF+12              cn=2,n=62

      984    13749    3              SUBSTR(NAME.TEXT,0,NAME.COUNT));
      985    13750    3           CALL LLM$MON_SVC(LL#WRITEDO);

  13750  6 003132   000021 630400 7                  EPPR0   17
         6 003133   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 003134   000000 701000 xent               TSX1    LLM$MON_SVC
         6 003135   000000 011000                    NOP     0

      986    13751    3           RETURN;

  13751  6 003136   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003137   000001 702211                    TSX2  ! 1,X1

      987    13752    3           END;
      988    13753    2       NAME_SIZE = (NAME.COUNT + 6) /4;

  13753  6 003140   200035 471500                    LDP1    @NAME,,AUTO
         6 003141   100000 236100                    LDQ     0,,PR1
         6 003142   000022 772000                    QRL     18
         6 003143   000006 036007                    ADLQ    6,DL
         6 003144   000002 772000                    QRL     2
         6 003145   200037 756100                    STQ     NAME_SIZE,,AUTO

      989    13754    2       TPTR2$->B$DNAME.COUNT = NAME.COUNT;

  13754  6 003146   100000 220100                    LDX0    0,,PR1
         6 003147   000636 473400 2                  LDP3    TPTR2$
         6 003150   300000 740100                    STX0    0,,PR3

      990    13755    2       TPTR2$->B$DNAME.TEXT = NAME.TEXT;

  13755  6 003151   100000 221100                    LDX1    0,,PR1
         6 003152   040140 100540                    MLR     fill='040'O
         6 003153   100000 400011                    ADSC9   0,,PR1                   cn=2,n=*X1
         6 003154   300000 400010                    ADSC9   0,,PR3                   cn=2,n=*X0
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:137  

      991    13756    2       TPTR2$ = PINCRW(TPTR2$,NAME_SIZE);

  13756  6 003155   000022 736000                    QLS     18
         6 003156   000636 036000 2                  ADLQ    TPTR2$
         6 003157   000636 756000 2                  STQ     TPTR2$

      992    13757    2       K = LL_HEAD.NRECSIZE;

  13757  6 003160   000006 236000 xsym               LDQ     LL_HEAD+6
         6 003161   777777 376007                    ANQ     -1,DL
         6 003162   200041 756100                    STQ     K,,AUTO

      993    13758    2       IF NAME_SIZE + K > LL_DNAME_VEC.BOUND

  13758  6 003163   200037 036100                    ADLQ    NAME_SIZE,,AUTO
         6 003164   200042 756100                    STQ     SIZE+1,,AUTO
         6 003165   000000 236000 xsym               LDQ     LL_DNAME_VEC
         6 003166   000022 772000                    QRL     18
         6 003167   200042 116100                    CMPQ    SIZE+1,,AUTO
         6 003170   003202 603000 6                  TRC     s:13762

      994    13759    3       THEN CALL M$GDS (FPT_GDS) WHENALTRETURN DO;

  13759  6 003171   000000 630400 1                  EPPR0   FPT_GDS
         6 003172   430001 713400                    CLIMB   alt,gds
         6 003173   400400 401760                    pmme    nvectors=2
         6 003174   003176 702000 6                  TSX2    s:13760
         6 003175   003202 710000 6                  TRA     s:13762

      995    13760    3               CALL LLM$MON_SVC(LL#GETMEM);

  13760  6 003176   000017 630400 7                  EPPR0   15
         6 003177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 003200   000000 701000 xent               TSX1    LLM$MON_SVC
         6 003201   000000 011000                    NOP     0

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:138  
      996    13761    3               END;

      997    13762    2       P$ = PINCRW(DEF$,K);

  13762  6 003202   200041 236100                    LDQ     K,,AUTO
         6 003203   000022 736000                    QLS     18
         6 003204   000633 036000 2                  ADLQ    DEF$
         6 003205   200040 756100                    STQ     P$,,AUTO

      998    13763    2       P$->B$DNAME.COUNT = NAME.COUNT + 1;

  13763  6 003206   200035 470500                    LDP0    @NAME,,AUTO
         6 003207   000000 220100                    LDX0    0,,PR0
         6 003210   000001 621010                    EAX1    1,X0
         6 003211   200040 471500                    LDP1    P$,,AUTO
         6 003212   100000 741100                    STX1    0,,PR1

      999    13764    2       P$->B$DNAME.TEXT = NAME.TEXT;

  13764  6 003213   200040 471500                    LDP1    P$,,AUTO
         6 003214   100000 220100                    LDX0    0,,PR1
         6 003215   000000 221100                    LDX1    0,,PR0
         6 003216   040140 100540                    MLR     fill='040'O
         6 003217   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         6 003220   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0

     1000    13765    2       CALL INSERT(P$->B$DNAME.TEXT,NAME.COUNT,1,'_');

  13765  6 003221   200040 471500                    LDP1    P$,,AUTO
         6 003222   100000 220100                    LDX0    0,,PR1
         6 003223   000000 236100                    LDQ     0,,PR0
         6 003224   000022 772000                    QRL     18
         6 003225   040106 100400                    MLR     fill='040'O
         6 003226   000074 000001 7                  ADSC9   60                       cn=0,n=1
         6 003227   100000 400001                    ADSC9   0,Q,PR1                  cn=2,n=1

     1001    13766    2       MEM$->B$EDEF = EDEF;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:139  

  13766  6 003230   200036 471500                    LDP1    @EDEF,,AUTO
         6 003231   200033 473500                    LDP3    MEM$,,AUTO
         6 003232   000100 100500                    MLR     fill='000'O
         6 003233   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 003234   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8

     1002    13767    2       MEM$->B$EDEF.NPOINTER = K;

  13767  6 003235   200041 720100                    LXL0    K,,AUTO
         6 003236   200033 473500                    LDP3    MEM$,,AUTO
         6 003237   300001 740100                    STX0    1,,PR3

     1003    13768    2       MEM$->B$EDEF.ISADDR = OFFSET + LL_LPROC_START + 8;

  13768  6 003240   000630 236000 2                  LDQ     OFFSET
         6 003241   000000 036000 xsym               ADLQ    LL_LPROC_START
         6 003242   200033 473500                    LDP3    MEM$,,AUTO
         6 003243   000010 036007                    ADLQ    8,DL
         6 003244   300000 552134                    STBQ    0,'34'O,PR3

     1004    13769    2       MEM$->B$EDEF.PRI = '1'B;

  13769  6 003245   200033 473500                    LDP3    MEM$,,AUTO
         6 003246   400000 236007                    LDQ     -131072,DL
         6 003247   300001 256100                    ORSQ    1,,PR3

     1005    13770    2       P$ = PINCRW(MEM$,SIZEW(B$EDEF));

  13770  6 003250   200033 236100                    LDQ     MEM$,,AUTO
         6 003251   000002 036003                    ADLQ    2,DU
         6 003252   200040 756100                    STQ     P$,,AUTO

     1006    13771    2       CALL LLG$GROW(LL_ENTDEF_R$,MEM$,1,LL_R_OU$,P$,DEF$,%TYPEDEF);

  13771  6 003253   000034 236000 7                  LDQ     28
         6 003254   200050 756100                    STQ     SIZE+7,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:140  
         6 003255   000035 236000 7                  LDQ     29
         6 003256   200047 756100                    STQ     SIZE+6,,AUTO
         6 003257   200040 633500                    EPPR3   P$,,AUTO
         6 003260   200046 453500                    STP3    SIZE+5,,AUTO
         6 003261   000076 237000 7                  LDAQ    62
         6 003262   200044 757100                    STAQ    SIZE+3,,AUTO
         6 003263   200033 634500                    EPPR4   MEM$,,AUTO
         6 003264   200043 454500                    STP4    SIZE+2,,AUTO
         6 003265   000036 236000 7                  LDQ     30
         6 003266   200042 756100                    STQ     SIZE+1,,AUTO
         6 003267   200042 630500                    EPPR0   SIZE+1,,AUTO
         6 003270   000025 631400 xsym               EPPR1   B_VECTNIL+21
         6 003271   000000 701000 xent               TSX1    LLG$GROW
         6 003272   000000 011000                    NOP     0

     1007    13772    2       MEM$ = P$;

  13772  6 003273   200040 236100                    LDQ     P$,,AUTO
         6 003274   200033 756100                    STQ     MEM$,,AUTO

     1008    13773    2       LL_HEAD.NRECSIZE = LL_HEAD.NRECSIZE + NAME_SIZE;

  13773  6 003275   000006 236000 xsym               LDQ     LL_HEAD+6
         6 003276   777777 376007                    ANQ     -1,DL
         6 003277   200037 036100                    ADLQ    NAME_SIZE,,AUTO
         6 003300   000000 620006                    EAX0    0,QL
         6 003301   000006 440000 xsym               SXL0    LL_HEAD+6

     1009    13774    2       TPTR1$->B$EREF.NPOINTER = REF_SIZE;

  13774  6 003302   000631 721000 2                  LXL1    REF_SIZE
         6 003303   000635 470400 2                  LDP0    TPTR1$
         6 003304   000000 741100                    STX1    0,,PR0

     1010    13775    2       REF_SIZE = REF_SIZE + NAME_SIZE;

  13775  6 003305   000631 236000 2                  LDQ     REF_SIZE
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:141  
         6 003306   200037 036100                    ADLQ    NAME_SIZE,,AUTO
         6 003307   000631 756000 2                  STQ     REF_SIZE

     1011    13776    2       TPTR1$->B$EREF.SREF = '0'B;

  13776  6 003310   000075 236000 7                  LDQ     61
         6 003311   000000 356100                    ANSQ    0,,PR0

     1012    13777    2       TPTR1$->B$EREF.ALT = EDEF.ALT;

  13777  6 003312   200036 471500                    LDP1    @EDEF,,AUTO
         6 003313   100001 236100                    LDQ     1,,PR1
         6 003314   000000 676100                    ERQ     0,,PR0
         6 003315   200000 376007                    ANQ     65536,DL
         6 003316   000000 656100                    ERSQ    0,,PR0

     1013    13778    2       TPTR1$->B$EREF.CHECK = EDEF.CHECK;

  13778  6 003317   100001 236100                    LDQ     1,,PR1
         6 003320   000000 676100                    ERQ     0,,PR0
         6 003321   100000 376007                    ANQ     32768,DL
         6 003322   000000 656100                    ERSQ    0,,PR0

     1014    13779    2       TPTR1$->B$EREF.CST = EDEF.CST;

  13779  6 003323   100001 236100                    LDQ     1,,PR1
         6 003324   000000 676100                    ERQ     0,,PR0
         6 003325   074000 376007                    ANQ     30720,DL
         6 003326   000000 656100                    ERSQ    0,,PR0

     1015    13780    2       TPTR1$->B$EREF.NPARAM = EDEF.NPARAM;

  13780  6 003327   100001 236100                    LDQ     1,,PR1
         6 003330   000000 676100                    ERQ     0,,PR0
         6 003331   003777 376007                    ANQ     2047,DL
         6 003332   000000 656100                    ERSQ    0,,PR0

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:142  
     1016    13781    2       TPTR1$ = PINCRW(TPTR1$,SIZEW(B$EREF));

  13781  6 003333   000635 236000 2                  LDQ     TPTR1$
         6 003334   000001 036003                    ADLQ    1,DU
         6 003335   000635 756000 2                  STQ     TPTR1$

     1017    13782    2       ENTREF_RELOC.OPERAND = EREF_SIZE;

  13782  6 003336   000632 720000 2                  LXL0    EREF_SIZE
         6 003337   000416 440000 2                  SXL0    ENTREF_RELOC

     1018    13783    2       EREF_SIZE = EREF_SIZE + SIZEW(B$EREF);

  13783  6 003340   000632 235000 2                  LDA     EREF_SIZE
         6 003341   000001 035007                    ADLA    1,DL
         6 003342   000632 755000 2                  STA     EREF_SIZE

     1019    13784
     1020    13785         /* Add relocation directive to store the address of the entref */
     1021    13786         /* into the branch instruction for this transfer vector entry */
     1022    13787    2       TPTR$->B$RELOC2 = BRK_SLOT;

  13787  6 003343   200022 470500                    LDP0    TPTR$,,AUTO
         6 003344   000100 100400                    MLR     fill='000'O
         6 003345   000413 000014 2                  ADSC9   BRK_SLOT                 cn=0,n=12
         6 003346   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

     1023    13788    2       TPTR$->B$RELOC2.DISP = OFFSET - ENTREF_RELOC_KEY.OFFSET;

  13788  6 003347   000405 236000 2                  LDQ     ENTREF_RELOC_KEY+2
         6 003350   000011 772000                    QRL     9
         6 003351   777777 376007                    ANQ     -1,DL
         6 003352   200042 756100                    STQ     SIZE+1,,AUTO
         6 003353   000630 236000 2                  LDQ     OFFSET
         6 003354   200042 136100                    SBLQ    SIZE+1,,AUTO
         6 003355   000000 621006                    EAX1    0,QL
         6 003356   000001 741100                    STX1    1,,PR0
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:143  

     1024    13789    2       TPTR$ = PINCRW(TPTR$,SIZEW(ENTREF_RELOC));

  13789  6 003357   200022 236100                    LDQ     TPTR$,,AUTO
         6 003360   000003 036003                    ADLQ    3,DU
         6 003361   200022 756100                    STQ     TPTR$,,AUTO

     1025    13790    2       TPTR$->B$RELOC2 = ENTREF_RELOC;

  13790  6 003362   200022 470500                    LDP0    TPTR$,,AUTO
         6 003363   000100 100400                    MLR     fill='000'O
         6 003364   000416 000014 2                  ADSC9   ENTREF_RELOC             cn=0,n=12
         6 003365   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

     1026    13791    2       TPTR$->B$RELOC2.DISP = OFFSET - ENTREF_RELOC_KEY.OFFSET + 1;

  13791  6 003366   000405 236000 2                  LDQ     ENTREF_RELOC_KEY+2
         6 003367   000011 772000                    QRL     9
         6 003370   777777 376007                    ANQ     -1,DL
         6 003371   200042 756100                    STQ     SIZE+1,,AUTO
         6 003372   000630 236000 2                  LDQ     OFFSET
         6 003373   200042 136100                    SBLQ    SIZE+1,,AUTO
         6 003374   000001 621006                    EAX1    1,QL
         6 003375   000001 741100                    STX1    1,,PR0

     1027    13792    2       TPTR$ = PINCRW(TPTR$,SIZEW(ENTREF_RELOC));

  13792  6 003376   200022 236100                    LDQ     TPTR$,,AUTO
         6 003377   000003 036003                    ADLQ    3,DU
         6 003400   200022 756100                    STQ     TPTR$,,AUTO

     1028    13793    2       OFFSET = OFFSET + 3;

  13793  6 003401   000630 235000 2                  LDA     OFFSET
         6 003402   000003 035007                    ADLA    3,DL
         6 003403   000630 755000 2                  STA     OFFSET

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:144  
     1029    13794    2       RETURN;

  13794  6 003404   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003405   000001 702211                    TSX2  ! 1,X1

     1030    13795    2   END INSERT_VECTOR;
     1031    13796        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:145  
     1032    13797    1   RANGE_START :PROC(NAME,P$) ALTRET;

  13797  6 003406   200034 741300       RANGE_START  STX1  ! MEM$+1,,AUTO

     1033    13798        %B$DNAME(NAME=NAME,STCLASS = " ");
     1034    13817    2   DCL SIZE UBIN;
     1035    13818    2   DCL P$ PTR;
     1036    13819    2   DCL Q$ PTR;
     1037    13820        %LL$NODE(NAME=TREE);
     1038    13852    3       DO J = 0 TO TEMP/2 -1;

  13852  6 003407   200005 450100                    STZ     J,,AUTO
         6 003410   003452 710000 6                  TRA     s:13861+3

     1039    13853    3           P$ = PINCRW(AVAIL$,J*2);

  13853  6 003411   200005 236100                    LDQ     J,,AUTO
         6 003412   000023 736000                    QLS     19
         6 003413   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 003414   200036 470500                    LDP0    @P$,,AUTO
         6 003415   000000 756100                    STQ     0,,PR0

     1040    13854    3           Q$ = PINCRW(DEF$,P$->B$EDEF.NPOINTER);

  13854  6 003416   000000 471500                    LDP1    0,,PR0
         6 003417   100001 220100                    LDX0    1,,PR1
         6 003420   000000 636010                    EAQ     0,X0
         6 003421   000633 036000 2                  ADLQ    DEF$
         6 003422   200040 756100                    STQ     Q$,,AUTO

     1041    13855    3           IF Q$->B$DNAME.COUNT < NAME.COUNT

  13855  6 003423   200040 473500                    LDP3    Q$,,AUTO
         6 003424   300000 221100                    LDX1    0,,PR3
         6 003425   200035 474500                    LDP4    @NAME,,AUTO
         6 003426   400000 101100                    CMPX1   0,,PR4
         6 003427   003434 603000 6                  TRC     s:13857
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:146  

     1042    13856    3           THEN SIZE = Q$->B$DNAME.COUNT;

  13856  6 003430   300000 236100                    LDQ     0,,PR3
         6 003431   000022 772000                    QRL     18
         6 003432   200037 756100                    STQ     SIZE,,AUTO
         6 003433   003437 710000 6                  TRA     s:13858

     1043    13857    3           ELSE SIZE = NAME.COUNT;

  13857  6 003434   400000 236100                    LDQ     0,,PR4
         6 003435   000022 772000                    QRL     18
         6 003436   200037 756100                    STQ     SIZE,,AUTO

     1044    13858    3           IF SUBSTR(Q$->B$DNAME.TEXT,0,SIZE) >= NAME.TEXT

  13858  6 003437   400000 222100                    LDX2    0,,PR4
         6 003440   000000 623006                    EAX3    0,QL
         6 003441   040140 106540                    CMPC    fill='040'O
         6 003442   300000 400013                    ADSC9   0,,PR3                   cn=2,n=*X3
         6 003443   400000 400012                    ADSC9   0,,PR4                   cn=2,n=*X2
         6 003444   003447 602000 6                  TNC     s:13861

     1045    13859    3           THEN
     1046    13860    3               RETURN;

  13860  6 003445   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003446   000001 702211                    TSX2  ! 1,X1

     1047    13861    3           END;

  13861  6 003447   200005 235100                    LDA     J,,AUTO
         6 003450   000001 035007                    ADLA    1,DL
         6 003451   200005 755100                    STA     J,,AUTO
         6 003452   200010 236100                    LDQ     TEMP,,AUTO
         6 003453   000001 772000                    QRL     1
         6 003454   200005 116100                    CMPQ    J,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:147  
         6 003455   003457 600000 6                  TZE     s:13862
         6 003456   003411 603000 6                  TRC     s:13853

     1048    13862    2       ALTRETURN;

  13862  6 003457   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003460   000000 702211                    TSX2  ! 0,X1

     1049    13863    2   END RANGE_START;
     1050    13864        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:148  
     1051    13865    1   RANGE_END:PROC(NAME,R$,P$) ALTRET;

  13865  6 003461   200034 741300       RANGE_END    STX1  ! MEM$+1,,AUTO

     1052    13866        %B$DNAME(NAME=NAME,STCLASS=" ");
     1053    13885    2   DCL R$ PTR;
     1054    13886    2   DCL P$ PTR;
     1055    13887    2   DCL Q$ PTR;
     1056    13888    2   DCL SIZE UBIN;
     1057    13889        %LL$NODE(NAME=TREE);
     1058    13921    3       DO J = 0 TO TEMP/2 -1;

  13921  6 003462   200005 450100                    STZ     J,,AUTO
         6 003463   003533 710000 6                  TRA     s:13934+3

     1059    13922    3           P$ = PINCRW(AVAIL$,J*2);

  13922  6 003464   200005 236100                    LDQ     J,,AUTO
         6 003465   000023 736000                    QLS     19
         6 003466   200016 036100                    ADLQ    AVAIL$,,AUTO
         6 003467   200037 470500                    LDP0    @P$,,AUTO
         6 003470   000000 756100                    STQ     0,,PR0

     1060    13923    3           Q$ = PINCRW(DEF$,P$->B$EDEF.NPOINTER);

  13923  6 003471   000000 471500                    LDP1    0,,PR0
         6 003472   100001 220100                    LDX0    1,,PR1
         6 003473   000000 636010                    EAQ     0,X0
         6 003474   000633 036000 2                  ADLQ    DEF$
         6 003475   200040 756100                    STQ     Q$,,AUTO

     1061    13924    3           IF Q$->B$DNAME.COUNT < NAME.COUNT

  13924  6 003476   200040 473500                    LDP3    Q$,,AUTO
         6 003477   300000 221100                    LDX1    0,,PR3
         6 003500   200035 474500                    LDP4    @NAME,,AUTO
         6 003501   400000 101100                    CMPX1   0,,PR4
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:149  
         6 003502   003507 603000 6                  TRC     s:13926

     1062    13925    3           THEN SIZE = Q$->B$DNAME.COUNT;

  13925  6 003503   300000 236100                    LDQ     0,,PR3
         6 003504   000022 772000                    QRL     18
         6 003505   200041 756100                    STQ     SIZE,,AUTO
         6 003506   003512 710000 6                  TRA     s:13927

     1063    13926    3           ELSE SIZE = NAME.COUNT;

  13926  6 003507   400000 236100                    LDQ     0,,PR4
         6 003510   000022 772000                    QRL     18
         6 003511   200041 756100                    STQ     SIZE,,AUTO

     1064    13927    3           IF SUBSTR(Q$->B$DNAME.TEXT,0,SIZE) > NAME.TEXT

  13927  6 003512   400000 222100                    LDX2    0,,PR4
         6 003513   000000 623006                    EAX3    0,QL
         6 003514   040140 106540                    CMPC    fill='040'O
         6 003515   400000 400012                    ADSC9   0,,PR4                   cn=2,n=*X2
         6 003516   300000 400013                    ADSC9   0,,PR3                   cn=2,n=*X3
         6 003517   003530 603000 6                  TRC     s:13934

     1065    13928    3           THEN
     1066    13929    4           DO;

     1067    13930    4               IF P$ = R$

  13930  6 003520   200036 475500                    LDP5    @R$,,AUTO
         6 003521   000000 236100                    LDQ     0,,PR0
         6 003522   500000 116100                    CMPQ    0,,PR5
         6 003523   003526 601000 6                  TNZ     s:13932

     1068    13931    4               THEN ALTRETURN;

  13931  6 003524   200034 221300                    LDX1  ! MEM$+1,,AUTO
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:150  
         6 003525   000000 702211                    TSX2  ! 0,X1

     1069    13932    4               ELSE RETURN;

  13932  6 003526   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003527   000001 702211                    TSX2  ! 1,X1

     1070    13933    4               END;
     1071    13934    3           END;

  13934  6 003530   200005 235100                    LDA     J,,AUTO
         6 003531   000001 035007                    ADLA    1,DL
         6 003532   200005 755100                    STA     J,,AUTO
         6 003533   200010 236100                    LDQ     TEMP,,AUTO
         6 003534   000001 772000                    QRL     1
         6 003535   200005 116100                    CMPQ    J,,AUTO
         6 003536   003540 600000 6                  TZE     s:13935
         6 003537   003464 603000 6                  TRC     s:13922

     1072    13935    2       P$ = PINCRW(P$,-SIZEW(B$EDEF));

  13935  6 003540   200037 470500                    LDP0    @P$,,AUTO
         6 003541   000000 236100                    LDQ     0,,PR0
         6 003542   777776 036003                    ADLQ    -2,DU
         6 003543   000000 756100                    STQ     0,,PR0

     1073    13936    2       RETURN;

  13936  6 003544   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003545   000001 702211                    TSX2  ! 1,X1

     1074    13937    2   END RANGE_END;
     1075    13938        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:151  
     1076    13939    1   SORT_BY_NAME:PROC(EDEFARY);

  13939  6 003546   200034 741300       SORT_BY_NAME STX1  ! MEM$+1,,AUTO

     1077    13940        %B$EDEF (NAME="EDEFARY(0:0)", STCLASS=);
     1078    14010        %B$EDEF (NAME=TEMP_EDEF, STCLASS=);
     1079    14080    2   DCL EDEFS CHAR(SIZE) BASED ALIGNED;
     1080    14081    2   DCL FLAG UBIN;
     1081    14082    2   DCL SIZE UBIN;
     1082    14083    2       FLAG = 1;

  14083  6 003547   000001 235007                    LDA     1,DL
         6 003550   200040 755100                    STA     FLAG,,AUTO

     1083    14084    2       GOTO CMN;

  14084  6 003551   003554 710000 6                  TRA     CMN

     1084    14085    2   SORT_BY_VALUE: ENTRY (EDEFARY);

  14085  6 003552   200034 741300       SORT_BY_VAL* STX1  ! MEM$+1,,AUTO

     1085    14086    2       FLAG = 0;

  14086  6 003553   200040 450100                    STZ     FLAG,,AUTO

     1086    14087    2   CMN: I = TEMP-1;

  14087  6 003554   200010 235100       CMN          LDA     TEMP,,AUTO
         6 003555   000001 135007                    SBLA    1,DL
         6 003556   200004 755100                    STA     I,,AUTO

     1087    14088    3       IF I>0 THEN DO UNTIL I = 0;

  14088  6 003557   003666 600000 6                  TZE     s:14110

     1088    14089    3           I = I - 1;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:152  

  14089  6 003560   200004 235100                    LDA     I,,AUTO
         6 003561   000001 135007                    SBLA    1,DL
         6 003562   200004 755100                    STA     I,,AUTO

     1089    14090    3           TEMP_EDEF = EDEFARY(I);

  14090  6 003563   000003 735000                    ALS     3
         6 003564   200035 470500                    LDP0    @EDEFARY,,AUTO
         6 003565   000100 100505                    MLR     fill='000'O
         6 003566   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8
         6 003567   200036 000010                    ADSC9   TEMP_EDEF,,AUTO          cn=0,n=8

     1090    14091    4   J_LOOP: DO J = I+1 TO TEMP - 1;

  14091  6 003570   200004 236100       J_LOOP       LDQ     I,,AUTO
         6 003571   000001 036007                    ADLQ    1,DL
         6 003572   200005 756100                    STQ     J,,AUTO
         6 003573   003635 710000 6                  TRA     s:14103+3

     1091    14092    4               IF FLAG = 0 /* Sort by value */

  14092  6 003574   200040 235100                    LDA     FLAG,,AUTO
         6 003575   003611 601000 6                  TNZ     s:14099

     1092    14093    5               THEN DO;

     1093    14094    5                   IF EDEFARY.ISADDR(J) > TEMP_EDEF.ISADDR

  14094  6 003576   200005 236100                    LDQ     J,,AUTO
         6 003577   000001 736000                    QLS     1
         6 003600   200035 470500                    LDP0    @EDEFARY,,AUTO
         6 003601   000000 236106                    LDQ     0,QL,PR0
         6 003602   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 003603   200042 756100                    STQ     SIZE+1,,AUTO
         6 003604   200036 236100                    LDQ     TEMP_EDEF,,AUTO
         6 003605   000032 376000 xsym               ANQ     B_VECTNIL+26
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:153  
         6 003606   200042 116100                    CMPQ    SIZE+1,,AUTO
         6 003607   003640 604000 6                  TMI     s:14104

     1094    14095    5                   THEN
     1095    14096    5                       EXIT J_LOOP;
     1096    14097    5                   END;

  14097  6 003610   003632 710000 6                  TRA     s:14103

     1097    14098    4               ELSE /* Sort by name */
     1098    14099    4                   IF PINCRW(DEF$,EDEFARY.NPOINTER(J))->B$DNAME.TEXT >

  14099  6 003611   200005 236100                    LDQ     J,,AUTO
         6 003612   000001 736000                    QLS     1
         6 003613   200035 470500                    LDP0    @EDEFARY,,AUTO
         6 003614   000001 220106                    LDX0    1,QL,PR0
         6 003615   000633 471400 2                  LDP1    DEF$
         6 003616   100000 221110                    LDX1    0,X0,PR1
         6 003617   200037 222100                    LDX2    @P$,,AUTO
         6 003620   100000 223112                    LDX3    0,X2,PR1
         6 003621   200037 235100                    LDA     @P$,,AUTO
         6 003622   777777 375003                    ANA     -1,DU
         6 003623   000020 731000                    ARS     16
         6 003624   000000 636010                    EAQ     0,X0
         6 003625   000020 732000                    QRS     16
         6 003626   040146 106545                    CMPC    fill='040'O
         6 003627   100000 400013                    ADSC9   0,A,PR1                  cn=2,n=*X3
         6 003630   100000 400011                    ADSC9   0,Q,PR1                  cn=2,n=*X1
         6 003631   003640 602000 6                  TNC     s:14104

     1099    14100    4                      PINCRW(DEF$,TEMP_EDEF.NPOINTER)->B$DNAME.TEXT
     1100    14101    4                   THEN
     1101    14102    4                       EXIT J_LOOP;
     1102    14103    4               END J_LOOP;

  14103  6 003632   200005 235100                    LDA     J,,AUTO
         6 003633   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:154  
         6 003634   200005 755100                    STA     J,,AUTO
         6 003635   200005 236100                    LDQ     J,,AUTO
         6 003636   200010 116100                    CMPQ    TEMP,,AUTO
         6 003637   003574 602000 6                  TNC     s:14092

     1103    14104    3           SIZE = SIZEC(TEMP_EDEF)*(J-I-1);

  14104  6 003640   200005 236100                    LDQ     J,,AUTO
         6 003641   200004 136100                    SBLQ    I,,AUTO
         6 003642   000003 736000                    QLS     3
         6 003643   000010 136007                    SBLQ    8,DL
         6 003644   200041 756100                    STQ     SIZE,,AUTO

     1104    14105    4           IF SIZE > 0 THEN DO;

  14105  6 003645   003664 600000 6                  TZE     s:14109

     1105    14106    4               ADDR(EDEFARY(I))->EDEFS = ADDR(EDEFARY(I+1))->EDEFS;

  14106  6 003646   200004 235100                    LDA     I,,AUTO
         6 003647   000003 735000                    ALS     3
         6 003650   000000 620006                    EAX0    0,QL
         6 003651   200041 721100                    LXL1    SIZE,,AUTO
         6 003652   040145 100545                    MLR     fill='040'O
         6 003653   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=*X0
         6 003654   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1

     1106    14107    4               EDEFARY(J-1) = TEMP_EDEF;

  14107  6 003655   200005 235100                    LDA     J,,AUTO
         6 003656   000001 735000                    ALS     1
         6 003657   000000 620005                    EAX0    0,AL
         6 003660   000000 622005                    EAX2    0,AL
         6 003661   200036 237100                    LDAQ    TEMP_EDEF,,AUTO
         6 003662   077776 755110                    STA     -2,X0,PR0
         6 003663   077777 756112                    STQ     -1,X2,PR0

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:155  
     1107    14108    4               END;

     1108    14109    3           END;

  14109  6 003664   200004 235100                    LDA     I,,AUTO
         6 003665   003560 601000 6                  TNZ     s:14089

     1109    14110    2   END SORT_BY_NAME;

  14110  6 003666   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003667   000001 702211                    TSX2  ! 1,X1

     1110    14111        %EJECT;
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:156  
     1111    14112    1   SEARCH_TV:PROC(P$,Q$,R$);

  14112  6 003670   200034 741300       SEARCH_TV    STX1  ! MEM$+1,,AUTO

     1112    14113    2   DCL P$ PTR;
     1113    14114    2   DCL Q$ PTR;
     1114    14115    2   DCL R$ PTR;
     1115    14116    2       Q$ = RF_EDEF$;

  14116  6 003671   200020 236100                    LDQ     RF_EDEF$,,AUTO
         6 003672   200036 470500                    LDP0    @Q$,,AUTO
         6 003673   000000 756100                    STQ     0,,PR0

     1116    14117    3       DO I = 0 TO TEMP - 1;

  14117  6 003674   200004 450100                    STZ     I,,AUTO
         6 003675   003725 710000 6                  TRA     s:14122+3

     1117    14118    3           NAME2$ = PINCRW(R$,Q$->B$EDEF.NPOINTER);

  14118  6 003676   200036 470500                    LDP0    @Q$,,AUTO
         6 003677   000000 471500                    LDP1    0,,PR0
         6 003700   100001 220100                    LDX0    1,,PR1
         6 003701   200037 473500                    LDP3    @R$,,AUTO
         6 003702   300000 474500                    LDP4    0,,PR3
         6 003703   400000 635510                    EPPR5   0,X0,PR4
         6 003704   200024 455500                    STP5    NAME2$,,AUTO

     1118    14119    3           IF NAME2$->B$DNAME.TEXT = P$->B$DNAME.TEXT

  14119  6 003705   500000 220100                    LDX0    0,,PR5
         6 003706   200035 471500                    LDP1    @P$,,AUTO
         6 003707   100000 474500                    LDP4    0,,PR1
         6 003710   400000 221100                    LDX1    0,,PR4
         6 003711   040140 106540                    CMPC    fill='040'O
         6 003712   500000 400010                    ADSC9   0,,PR5                   cn=2,n=*X0
         6 003713   400000 400011                    ADSC9   0,,PR4                   cn=2,n=*X1
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:157  
         6 003714   003717 601000 6                  TNZ     s:14121

     1119    14120    3           THEN RETURN;

  14120  6 003715   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003716   000001 702211                    TSX2  ! 1,X1

     1120    14121    3           ELSE Q$ = PINCRW(Q$,SIZEW(B$EDEF));

  14121  6 003717   000000 236100                    LDQ     0,,PR0
         6 003720   000002 036003                    ADLQ    2,DU
         6 003721   000000 756100                    STQ     0,,PR0

     1121    14122    3           END;

  14122  6 003722   200004 235100                    LDA     I,,AUTO
         6 003723   000001 035007                    ADLA    1,DL
         6 003724   200004 755100                    STA     I,,AUTO
         6 003725   200004 236100                    LDQ     I,,AUTO
         6 003726   200010 116100                    CMPQ    TEMP,,AUTO
         6 003727   003676 602000 6                  TNC     s:14118

     1122    14123    2       CALL CONCAT(LL_DOBUF,'A   *** ',

  14123  6 003730   040000 100400                    MLR     fill='040'O
         6 003731   000241 000010 1                  ADSC9   TV_DEF_NAMES+146         cn=0,n=8
         6 003732   000000 000010 xsym               ADSC9   LL_DOBUF                 cn=0,n=8
         6 003733   040000 100400                    MLR     fill='040'O
         6 003734   000243 000037 1                  ADSC9   TV_DEF_NAMES+148         cn=0,n=31
         6 003735   000002 000037 xsym               ADSC9   LL_DOBUF+2               cn=0,n=31
         6 003736   040000 100400                    MLR     fill='040'O
         6 003737   000000 000037 xsym               ADSC9   LL_VECTOR_RF             cn=0,n=31
         6 003740   000011 600111 xsym               ADSC9   LL_DOBUF+9               cn=3,n=73

     1123    14124    2          'There is no transfer vector in ',
     1124    14125    2          LL_VECTOR_RF);
     1125    14126    2       CALL LLM$MON_SVC(LL#WRITEDO);
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:158  

  14126  6 003741   000021 630400 7                  EPPR0   17
         6 003742   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 003743   000000 701000 xent               TSX1    LLM$MON_SVC
         6 003744   000000 011000                    NOP     0

     1126    14127    2       CALL LLM$MON_SVC(LL#ERR);

  14127  6 003745   000023 630400 7                  EPPR0   19
         6 003746   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 003747   000000 701000 xent               TSX1    LLM$MON_SVC
         6 003750   000000 011000                    NOP     0

     1127    14128    2       RETURN;

  14128  6 003751   200034 221300                    LDX1  ! MEM$+1,,AUTO
         6 003752   000001 702211                    TSX2  ! 1,X1
     1128    14129    2   END SEARCH_TV;
     1129    14130    1   END LLT$TRANSVECT;

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:159  
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   LL_MACS_C.:E05TOU  is referenced.
   LL_SUBS_C.:E05TOU  is referenced.
   LL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure LLT$TRANSVECT.
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:160  

 **** Variables and constants ****

  ****  Section 001 RoData LLT$TRANSVECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(216)   r     1 FPT_GDS                   17-0-0/w STRC(324)   r     1 TV_DEF_NAMES
    15-0-0/w STRC(72)    r     1 TV_END_NAME               13-0-0/w STRC(72)    r     1 TV_START_NAME

  ****  Section 002  Data  LLT$TRANSVECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   476-0-0/w STRC(54)    r     1 B$RUKEY                  413-0-0/w STRC(108)   r     1 BRK_SLOT
   571-0-0/c STRC(720)   r     1 BUFFER                   322-0-0/d STRC(1080)  r     1 CLOSE_RF
    72-0-0/d STRC(1080)  r     1 CLOSE_TV                 633-0-0/w PTR         r     1 DEF$
   615-0-0/c STRC(189)   r     1 EMPTY_MSG                416-0-0/w STRC(108)   r     1 ENTREF_RELOC
   403-0-0/w STRC(117)   r     1 ENTREF_RELOC_KEY         634-0-0/w PTR         r     1 EREF$
   632-0-0/w UBIN        r     1 EREF_SIZE                630-0-0/w UBIN        r     1 OFFSET
   174-0-0/d STRC(2088)  r     1 OPEN_RF                    0-0-0/d STRC(2088)  r     1 OPEN_TV
   304-0-0/d STRC(504)   r     1 READ_RF                  266-0-0/d STRC(504)   r     1 READ_RF_HEAD
   637-0-0/w PTR         r     1 REF$                     631-0-0/w UBIN        r     1 REF_SIZE
   421-0-0/w STRC(108)   r     1 REPEAT_TV_RELOC          407-0-0/w STRC(117)   r     1 REPEAT_TV_RELOC_KEY
   426-0-0/w STRC(1440)  r     1 RF_HEAD                  424-0-0/w STRC(45)    r     1 RF_HEAD_KEY
   144-0-0/d STRC(864)   r     1 RUN_FILE                 635-0-0/w PTR         r     1 TPTR1$
   636-0-0/w PTR         r     1 TPTR2$                   500-0-0/w STRC(144)   r     1 TV_EDEF
   506-0-0/w STRC(1044)  r     1 TV_HEAD                  623-0-0/w STRC(90)    r     1 TV_HEAD_KEY
   543-0-0/c STRC(765)   r     1 TV_MSG                   626-0-0/w STRC(72)    r     1 TV_OU_KEY
   504-0-0/w STRC(72)    r     1 TV_SECTION               402-0-0/c STRC        r     1 TV_STAR
   360-0-0/c STRC(72)    r     1 VLP_ACCT                 372-0-0/c STRC(288)   r     1 VLP_NAME
   362-0-0/c STRC(72)    r     1 VLP_PASS                 366-0-0/d STRC(90)    r     1 VLP_SN
   364-0-0/c STRC(72)    r     1 VLP_WSN                  130-0-0/d STRC(432)   r     1 WRITE_TV

  ****  Auto variables  ****

PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:161  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/w PTR         r     1 @EDEF                     35-0-0/w PTR         r     1 @EDEFARY
    36-0-0/w PTR         r     1 @FOUND$                   35-0-0/w PTR         r     1 @NAME
    35-0-0/w PTR         r     1 @NAME                     35-0-0/w PTR         r     1 @NAME
    35-0-0/w PTR         r     1 @P$                       36-0-0/w PTR         r     1 @P$
    37-0-0/w PTR         r     1 @P$                       35-0-0/w PTR         r     1 @P$
    36-0-0/w PTR         r     1 @Q$                       36-0-0/w PTR         r     1 @R$
    37-0-0/w PTR         r     1 @R$                       16-0-0/w PTR         r     1 AVAIL$
    26-0-0/w PTR         r     1 BEGIN$                    40-0-0/w PTR         r     1 DEF_NAME$
    *0-0-0/w STRC(72)    r     1 EDEF
    *0-0-0/w STRC(72)    r     1 EDEFARY(0:0)
    27-0-0/w PTR         r     1 END$                      40-0-0/w UBIN        r     1 FLAG
    *0-0-0/w PTR         r     1 FOUND$                     4-0-0/w UBIN        r     1 I
     5-0-0/w UBIN        r     1 J                         41-0-0/w UBIN        r     1 K
    25-0-0/w PTR         r     1 LIST$                     33-0-0/w PTR         r     1 MEM$
    *0-0-0/w ASTR(18)    r     1 NAME                      *0-0-0/w ASTR(18)    r     1 NAME
    *0-0-0/w ASTR(18)    r     1 NAME                      30-0-0/w PTR         r     1 NAME$
    23-0-0/w PTR         r     1 NAME1$                    24-0-0/w PTR         r     1 NAME2$
    37-0-0/w UBIN        r     1 NAME_SIZE                 13-0-0/w UBIN        r     1 NEXT
    12-0-0/w UBIN        r     1 N_DEFNS                   11-0-0/w UBIN        r     1 N_DEFS
    *0-0-0/w PTR         r     1 P$                        40-0-0/w PTR         r     1 P$
    *0-0-0/w PTR         r     1 P$                        *0-0-0/w PTR         r     1 P$
    *0-0-0/w PTR         r     1 P$                        37-0-0/w PTR         r     1 Q$
    40-0-0/w PTR         r     1 Q$                        40-0-0/w PTR         r     1 Q$
    *0-0-0/w PTR         r     1 Q$                        *0-0-0/w PTR         r     1 R$
    *0-0-0/w PTR         r     1 R$                        17-0-0/w PTR         r     1 RF_DEF$
     6-0-0/w UBIN        r     1 RF_DEF_SIZE               20-0-0/w PTR         r     1 RF_EDEF$
     7-0-0/w UBIN        r     1 RF_EDEF_SIZE              37-0-0/w UBIN        r     1 SIZE
    41-0-0/w UBIN        r     1 SIZE                      41-0-0/w UBIN        r     1 SIZE
    21-0-0/w PTR         r     1 START$                    31-0-0/w PTR         r     1 STOP$
    10-0-0/w UBIN        r     1 TEMP                      14-0-0/w STRC(72)    r     1 TEMP_EDEF
    36-0-0/w STRC(72)    r     1 TEMP_EDEF                 22-0-0/w PTR         r     1 TPTR$
    32-0-0/w PTR         r     1 TPTR3$

  ****  SYMREF variables  ****
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:162  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LL_BOTOMEM$                0-0-0/d STRC(72)    r     1 LL_DNAME_VEC
     0-0-0/w CHAR(112)   r     1 LL_DOBUF                   0-0-0/w PTR         r     1 LL_ENTDEF_R$
     0-0-0/w STRC        r     1 LL_FLAGS                   0-0-0/w STRC(1440)  r     1 LL_HEAD
     0-0-0/w PTR         r     1 LL_LIST$                   0-0-0/w UBIN        r     1 LL_LIST_SIZE
     0-0-0/w CHAR(112)   r     1 LL_LOBUF                   0-0-0/w UBIN        r     1 LL_LPROC_START
     0-0-0/w PTR         r     1 LL_R_CODE$                 0-0-0/w PTR         r     1 LL_R_OU$
     0-0-0/w PTR         r     1 LL_TOPOMEM$                0-0-0/c CHAR(31)    r     1 LL_VECTOR_RF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 B$DCB                      0-0-0/w ASTR(18)    r     1 B$DNAME
     0-0-0/w STRC(72)    r     1 B$EDEF                     0-0-0/w STRC        r     1 B$EREF
     0-0-0/w STRC(1044)  r     1 B$OUHEAD                   0-0-0/w STRC(108)   r     1 B$RELOC2
     0-0-0/w STRC(72)    r     1 B$SDEF                     0-0-0/w STRC(72)    r     1 DEF
     0-0-0/w ACHR        r     1 EDEFS                      0-0-0/w STRC(72)    r     1 LL_SECTION
     0-0-0N  NULL        r     1 M$RF                       0-0-0N  NULL        r     1 M$RU
     0-0-0N  NULL        r     1 M$TV                       0-0-0/w ASTR(504)   r     1 OU_ENTRY
     0-0-0/w STRC(180)   r     1 SECT_ENTRY                 0-0-0/w STRC(216)   r     1 TREE
     0-0-0/w STRC        r     1 VECTOR_LIST


   Procedure LLT$TRANSVECT requires 2027 words for executable code.
   Procedure LLT$TRANSVECT requires 46 words of local(AUTO) storage.

    No errors detected in file LLT$TRANSVECT.:E05TSI    .
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:163  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:164  
          MINI XREF LISTING

AVAIL$
     12811**DCL     12916<<ASSIGN  12920<>CALL    12921>>ASSIGN  12922<<ASSIGN  12922>>ASSIGN  12933<>CALL
     12934>>ASSIGN  12935>>ASSIGN  12936<<ASSIGN  12936>>ASSIGN  12939<>CALL    12940>>ASSIGN  12941>>ASSIGN
     12942<<ASSIGN  12942>>ASSIGN  12943<>CALL    12944>>ASSIGN  12945>>ASSIGN  12946<<ASSIGN  12946>>ASSIGN
     12974<>CALL    12975>>ASSIGN  12976<<ASSIGN  12976>>ASSIGN  12988<>CALL    12989>>ASSIGN  12990<<ASSIGN
     12990>>ASSIGN  13103<>CALL    13104<>CALL    13106<>CALL    13208<<ASSIGN  13214<>CALL    13215<>CALL
     13216>>ASSIGN  13217<<ASSIGN  13217>>ASSIGN  13219<>CALL    13221<>CALL    13223>>ASSIGN  13224<<ASSIGN
     13224>>ASSIGN  13415<>CALL    13417<>CALL    13418>>ASSIGN  13428<>CALL    13853>>ASSIGN  13922>>ASSIGN
B$DCB.ACTPOS
     11315**DCL     11315--REDEF
B$DCB.ARS#
     11289**DCL     11289--REDEF   12982>>ASSIGN  12996>>ASSIGN  13107>>ASSIGN  13222>>ASSIGN  13419>>ASSIGN
B$DCB.ATTR
     11308**DCL     11309--REDEF
B$DCB.BORROW
     11323**DCL     11323--REDEF   11323--REDEF   11323--REDEF
B$DCB.DCBNAME.L
     11337**DCL     11337--IMP-SIZ
B$DCB.EOMCHAR#
     11293**DCL     11293--REDEF
B$DCB.FLDID
     11318**DCL     11318--REDEF
B$DCB.FORM$
     11312**DCL     11312--REDEF
B$DCB.FSECT
     11328**DCL     11328--REDEF
B$DCB.FSN#
     11305**DCL     11305--REDEF   11305--REDEF   11306--REDEF
B$DCB.HEADER$
     11311**DCL     11311--REDEF
B$DCB.IXTNSIZE#
     11309**DCL     11309--REDEF
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:165  
B$DCB.LASTSTA$
     11298**DCL     11298--REDEF
B$DCB.LVL
     11324**DCL     11324--REDEF
B$DCB.NAME#.C
     11299**DCL     11299--REDEF
B$DCB.NOEOF
     11321**DCL     11321--REDEF
B$DCB.NRECS#
     11310**DCL     11310--REDEF
B$DCB.NRECX
     11329**DCL     11329--REDEF
B$DCB.OHDR
     11321**DCL     11321--REDEF
B$DCB.ORG#
     11304**DCL     11304--REDEF
B$DCB.PRECNO
     11327**DCL     11327--REDEF
B$DCB.RCSZ
     11333**DCL     11333--REDEF
B$DCB.RES#
     11300**DCL     11300--REDEF
B$DCB.SETX
     11312**DCL     11312--REDEF
B$DCB.TAB$
     11312**DCL     11312--REDEF
B$DCB.TDA
     11326**DCL     11327--REDEF
B$DCB.WSN#
     11300**DCL     11300--REDEF
B$DNAME
     12163**DCL     13052<>CALL    13087<>CALL    13108<>CALL    13109<>CALL    13112<>CALL
B$DNAME.COUNT
     12164**DCL     12171--IMP-SIZ 13052>>CALL    13058>>CALLBLT 13058>>CALLBLT 13087>>CALL    13091>>CALLBLT
     13108>>CALL    13109>>CALL    13112>>CALL    13119>>CALLBLT 13119>>CALLBLT 13119>>CALLBLT 13119>>CALLBLT
     13287>>ASSIGN  13292>>IF      13292>>IF      13292>>IF      13297>>ASSIGN  13297>>ASSIGN  13306>>IF
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:166  
     13306>>IF      13306>>IF      13313>>IF      13313>>IF      13313>>IF      13351>>IF      13351>>IF
     13364>>CALLBLT 13562>>IF      13562>>IF      13566>>IF      13566>>IF      13754<<ASSIGN  13755>>ASSIGN
     13763<<ASSIGN  13764>>ASSIGN  13765>>CALLBLT 13855>>IF      13856>>ASSIGN  13858>>IF      13924>>IF
     13925>>ASSIGN  13927>>IF      14099>>IF      14099>>IF      14119>>IF      14119>>IF
B$DNAME.TEXT
     12171**DCL     13058>>CALLBLT 13091>>CALLBLT 13119>>CALLBLT 13119>>CALLBLT 13287>>ASSIGN  13292>>IF
     13292>>IF      13297>>ASSIGN  13306>>IF      13306>>IF      13313>>IF      13313>>IF      13351>>IF
     13351>>IF      13364>>CALLBLT 13562>>IF      13562>>IF      13566>>IF      13566>>IF      13755<<ASSIGN
     13764<<ASSIGN  13765<<CALLBLT 13858>>IF      13927>>IF      14099>>IF      14099>>IF      14119>>IF
     14119>>IF
B$EDEF
     12229**DCL     13006--ASSIGN  13011<>CALL    13019--ASSIGN  13022--ASSIGN  13025--ASSIGN  13028>>ASSIGN
     13029<<ASSIGN  13029>>ASSIGN  13030<<ASSIGN  13052<>CALL    13065--ASSIGN  13087<>CALL    13112<>CALL
     13113--ASSIGN  13222--ASSIGN  13225--ASSIGN  13231<>CALL    13238>>ASSIGN  13242--ASSIGN  13246<<ASSIGN
     13246>>ASSIGN  13247<<ASSIGN  13252>>ASSIGN  13253--ASSIGN  13255>>ASSIGN  13258--ASSIGN  13259<<ASSIGN
     13259>>ASSIGN  13262<<ASSIGN  13263--ASSIGN  13266--ASSIGN  13266--ASSIGN  13267<>CALL    13295--ASSIGN
     13303>>ASSIGN  13304--ASSIGN  13309--ASSIGN  13311--ASSIGN  13316--ASSIGN  13318--ASSIGN  13320<<ASSIGN
     13320>>ASSIGN  13321--ASSIGN  13322--ASSIGN  13324--ASSIGN  13325<<ASSIGN  13326--ASSIGN  13329--ASSIGN
     13349--ASSIGN  13354--ASSIGN  13376--ASSIGN  13380<<ASSIGN  13380>>ASSIGN  13381--ASSIGN  13382--ASSIGN
     13396--ASSIGN  13399--ASSIGN  13400<>CALL    13766<<ASSIGN  13770--ASSIGN  13935--ASSIGN  14121--ASSIGN
B$EDEF.ISADDR
     12252**DCL     13023>>IF      13023>>IF      13043>>ASSIGN  13045>>IF      13047>>ASSIGN  13048>>ASSIGN
     13068>>ASSIGN  13243>>IF      13243>>IF      13280>>DOWHILE 13298>>ASSIGN  13768<<ASSIGN
B$EDEF.LFLAGS.SOURCE
     12234**DCL     13395<<ASSIGN
B$EDEF.NPOINTER
     12254**DCL     13050>>ASSIGN  13111>>ASSIGN  13286>>ASSIGN  13291>>ASSIGN  13300>>ASSIGN  13301<<ASSIGN
     13301>>ASSIGN  13302<<ASSIGN  13306>>IF      13306>>IF      13313>>IF      13313>>IF      13348>>ASSIGN
     13351>>IF      13351>>IF      13767<<ASSIGN  13854>>ASSIGN  13923>>ASSIGN  14118>>ASSIGN
B$EDEF.OU
     12246**DCL     12252--REDEF
B$EDEF.OU.OFFSET
     12250**DCL     13132<<ASSIGN
B$EDEF.PRI
     12257**DCL     13769<<ASSIGN
B$EREF IN PROCEDURE INSERT_VECTOR
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:167  
     13666**DCL     13781--ASSIGN  13783--ASSIGN
B$EREF.ALT IN PROCEDURE INSERT_VECTOR
     13673**DCL     13777<<ASSIGN
B$EREF.CHECK IN PROCEDURE INSERT_VECTOR
     13677**DCL     13778<<ASSIGN
B$EREF.CST IN PROCEDURE INSERT_VECTOR
     13685**DCL     13779<<ASSIGN
B$EREF.NPARAM IN PROCEDURE INSERT_VECTOR
     13705**DCL     13780<<ASSIGN
B$EREF.NPOINTER IN PROCEDURE INSERT_VECTOR
     13667**DCL     13774<<ASSIGN
B$EREF.SREF IN PROCEDURE INSERT_VECTOR
     13670**DCL     13776<<ASSIGN
B$OUHEAD.EREFPSIZ
     11537**DCL     13194<<ASSIGN
B$OUHEAD.EREFSIZ
     11534**DCL     13192<<ASSIGN
B$OUHEAD.RELPSIZ
     11516**DCL     12938<<ASSIGN
B$OUHEAD.RNAMPSIZ
     11527**DCL     13193<<ASSIGN
B$OUHEAD.RNAMSIZ
     11524**DCL     13191<<ASSIGN
B$OUHEAD.VERSION
     11477**DCL     11479--REDEF
B$RELOC2
     11782**DCL     13787<<ASSIGN  13790<<ASSIGN
B$RELOC2.DISP
     11834**DCL     13788<<ASSIGN  13791<<ASSIGN
B$RUKEY
     12144**DCL     12980--ASSIGN  12994--ASSIGN  13106<>CALL    13209<<ASSIGN  13215<>CALL    13221<>CALL
     13406<>CALL    13417<>CALL    13428<>CALL
B$RUKEY.ISADDR
     12153**DCL     13212<<ASSIGN
B$RUKEY.KEYSIZ
     12145**DCL     13211<<ASSIGN
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:168  
B$RUKEY.PAGE
     12151**DCL     12153--REDEF
B$RUKEY.TYPE
     12147**DCL     12979<<ASSIGN  12991<<ASSIGN  13105<<ASSIGN  13210<<ASSIGN  13220<<ASSIGN  13404<<ASSIGN
     13416<<ASSIGN
B$SDEF
     12175**DCL     13426--ASSIGN
B$SDEF.AD.OU
     12195**DCL     12201--REDEF
B$SDEF.LFLAGS.SOURCE
     12219**DCL     13425<<ASSIGN
B$SDEF.VALUE
     12176**DCL     12179--REDEF
BEGIN$
     12824**DCL     13019<<ASSIGN  13025<<ASSIGN  13031<<ASSIGN  13043>>ASSIGN  13044>>DOWHILE 13045>>IF
     13047>>ASSIGN  13048>>ASSIGN  13050>>ASSIGN  13065<<ASSIGN  13065>>ASSIGN  13108<>CALL    13109<>CALL
     13110>>DOWHILE 13111>>ASSIGN  13112>>CALL    13113<<ASSIGN  13113>>ASSIGN  13265<<ASSIGN  13266>>ASSIGN
     13267>>CALL    13289>>ASSIGN  13305>>DOWHILE 13319>>DOWHILE 13324<<ASSIGN  13346>>ASSIGN  13374>>IF
     13379>>DOWHILE 13380>>ASSIGN  13382<<ASSIGN  13382>>ASSIGN
BRK_SLOT
     11645**DCL     12883<<ASSIGN  13787>>ASSIGN
BRK_SLOT.ENDBIT
     11703**DCL     12888<<ASSIGN
BRK_SLOT.EVALOP
     11656**DCL     12885<<ASSIGN
BRK_SLOT.OPERAND
     11692**DCL     12887<<ASSIGN
BRK_SLOT.OPNDTYP
     11648**DCL     12884<<ASSIGN
BRK_SLOT.RELOCOP
     11676**DCL     12886<<ASSIGN
BRK_SLOT.VALUE
     11706**DCL     12889<<ASSIGN
BUFFER.ONE
     12771**DCL     12774--REDEF
BUFFER.ONE.TEXT
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:169  
     12773**DCL     13361<<ASSIGN  13364<<CALLBLT
BUFFER.TWO
     12774**DCL     13359>>ASSIGN  13371>>ASSIGN
CLOSE_RF
     11147**DCL     13069<>CALL
CLOSE_RF.SN_
     11147**DCL     11147--REDEF
CLOSE_RF.UTL_
     11148**DCL     11148--REDEF
CLOSE_RF.V
     11152**DCL     11147--DCLINIT
CLOSE_RF.V.EXPIRE#
     11162**DCL     11162--REDEF
CLOSE_RF.V.TYPE#
     11160**DCL     11160--REDEF
CLOSE_RF.V.XTNSIZE#
     11157**DCL     11157--REDEF   11159--REDEF
CLOSE_TV
     10830**DCL     12859<>CALL    13198<>CALL
CLOSE_TV.SN_
     10830**DCL     10830--REDEF
CLOSE_TV.UTL_
     10831**DCL     10831--REDEF
CLOSE_TV.V
     10835**DCL     10830--DCLINIT
CLOSE_TV.V.EXPIRE#
     10845**DCL     10845--REDEF
CLOSE_TV.V.TYPE#
     10843**DCL     10843--REDEF
CLOSE_TV.V.XTNSIZE#
     10840**DCL     10840--REDEF   10842--REDEF
CMN IN PROCEDURE SORT_BY_NAME
     14087**LABEL   14084--GOTO
DEF.NPOINTER IN PROCEDURE SEARCH_ENTDEF
     13513**DCL     13561>>ASSIGN
DEF.OU IN PROCEDURE SEARCH_ENTDEF
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:170  
     13505**DCL     13511--REDEF
DEF$
     12812**DCL     12928<<ASSIGN  13104<>CALL    13111>>ASSIGN  13216<<ASSIGN  13237<>CALL    13251<>CALL
     13286>>ASSIGN  13291>>ASSIGN  13306>>IF      13306>>IF      13313>>IF      13313>>IF      13348>>ASSIGN
     13351>>IF      13351>>IF      13561>>ASSIGN  13762>>ASSIGN  13771<>CALL    13854>>ASSIGN  13923>>ASSIGN
     14099>>IF      14099>>IF      14099>>IF      14099>>IF
DEF_NAME$ IN PROCEDURE SEARCH_ENTDEF
     13454**DCL     13561<<ASSIGN  13562>>IF      13562>>IF      13566>>IF      13566>>IF
EDEF IN PROCEDURE INSERT_VECTOR
     13596**DCL     13575--PROC    13766>>ASSIGN
EDEF.ALT IN PROCEDURE INSERT_VECTOR
     13629**DCL     13777>>ASSIGN
EDEF.CHECK IN PROCEDURE INSERT_VECTOR
     13634**DCL     13778>>ASSIGN
EDEF.CST IN PROCEDURE INSERT_VECTOR
     13642**DCL     13779>>ASSIGN
EDEF.LFLAGS.USED IN PROCEDURE INSERT_VECTOR
     13607**DCL     13743>>IF      13745<<ASSIGN
EDEF.NPARAM IN PROCEDURE INSERT_VECTOR
     13662**DCL     13780>>ASSIGN
EDEF.OU IN PROCEDURE INSERT_VECTOR
     13613**DCL     13619--REDEF
EDEFARY IN PROCEDURE SORT_BY_NAME
     13941**DCL     13939--PROC    14085--ENTRY   14090>>ASSIGN  14106--ASSIGN  14106--ASSIGN  14107<<ASSIGN
EDEFARY.ISADDR IN PROCEDURE SORT_BY_NAME
     13964**DCL     14094>>IF
EDEFARY.NPOINTER IN PROCEDURE SORT_BY_NAME
     13966**DCL     14099>>IF      14099>>IF
EDEFARY.OU IN PROCEDURE SORT_BY_NAME
     13958**DCL     13964--REDEF
EDEFS IN PROCEDURE SORT_BY_NAME
     14080**DCL     14106<<ASSIGN  14106>>ASSIGN
EMPTY_MSG.BUFFER
     12782**DCL     13282>>ASSIGN  13334>>ASSIGN
EMPTY_MSG.MSG
     12777**DCL     12782--REDEF
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:171  
EMPTY_MSG.MSG.ADDR1
     12780**DCL     13281<>CALL    13333<>CALL
END$
     12825**DCL     13038<>CALL    13044>>DOWHILE 13068>>ASSIGN  13109<>CALL    13110>>DOWHILE 13225<<ASSIGN
     13266>>ASSIGN  13290>>DOWHILE 13312>>DOWHILE 13347>>DOWHILE 13350>>DOWHILE 13376>>ASSIGN  13379>>DOWHILE
ENTREF_RELOC
     11714**DCL     12894<<ASSIGN  13789--ASSIGN  13790>>ASSIGN  13792--ASSIGN
ENTREF_RELOC.ENDBIT
     11772**DCL     12897<<ASSIGN
ENTREF_RELOC.OPERAND
     11761**DCL     13782<<ASSIGN
ENTREF_RELOC.OPNDTYP
     11717**DCL     12895<<ASSIGN
ENTREF_RELOC.RELOCOP
     11745**DCL     12896<<ASSIGN
ENTREF_RELOC_KEY
     11579**DCL     12877<<ASSIGN  13141--ASSIGN
ENTREF_RELOC_KEY.OFFSET
     11594**DCL     13788>>ASSIGN  13791>>ASSIGN
ENTREF_RELOC_KEY.SEQUENCE
     11602**DCL     12878<<ASSIGN
EREF$
     12813**DCL     12940<<ASSIGN  13178>>ASSIGN
EREF_SIZE
     12809**DCL     13179>>ASSIGN  13180>>ASSIGN  13181>>ASSIGN  13192>>ASSIGN  13194>>ASSIGN  13782>>ASSIGN
     13783<<ASSIGN  13783>>ASSIGN
ERROR
     13445**LABEL   12836--CALLALT 12842--CALLALT 12846--CALLALT 12850--CALLALT 12858--CALLALT 12859--CALLALT
     12915--CALLALT 12954--CALLALT 13146--CALLALT 13150--CALLALT 13158--CALLALT 13161--CALLALT 13172--CALLALT
     13183--CALLALT 13190--CALLALT 13198--CALLALT 13442--CALLALT
FLAG IN PROCEDURE SORT_BY_NAME
     14081**DCL     14083<<ASSIGN  14086<<ASSIGN  14092>>IF
FOUND$ IN PROCEDURE SEARCH_ENTDEF
     13452**DCL     13450--PROC    13560<<ASSIGN  13561>>ASSIGN
FPT_GDS
     10685**DCL     13759<>CALL
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:172  
FPT_GDS.V
     10685**DCL     10685--DCLINIT
I
     12794**DCL     13043<<ASSIGN  13045>>IF      13047>>ASSIGN  13048<<ASSIGN  13066<<ASSIGN  13066>>ASSIGN
     13068>>ASSIGN  13076<<DOINDEX 13213<<ASSIGN  13214<>CALL    13215>>CALL    13217>>ASSIGN  13218<<ASSIGN
     13219<>CALL    13221>>CALL    13224>>ASSIGN  13254<<DOINDEX 13298<<ASSIGN  13299<>CALL    13300<<ASSIGN
     13302>>ASSIGN  13405<<ASSIGN  13406<>CALL    13424<<DOINDEX 14087<<ASSIGN  14088>>IF      14088>>DOUNTIL
     14089<<ASSIGN  14089>>ASSIGN  14090>>ASSIGN  14091>>DOINDEX 14104>>ASSIGN  14106>>ASSIGN  14106>>ASSIGN
     14117<<DOINDEX
INSERT_VECTOR
     13575**PROC    13052--CALL    13087--CALL    13112--CALL
J
     12795**DCL     13345<<ASSIGN  13356>>IF      13362<<ASSIGN  13364>>CALLBLT 13365<<ASSIGN  13365>>ASSIGN
     13368>>IF      13852<<DOINDEX 13853>>ASSIGN  13921<<DOINDEX 13922>>ASSIGN  14091<<DOINDEX 14094>>IF
     14099>>IF      14099>>IF      14104>>ASSIGN  14107>>ASSIGN
J_LOOP IN PROCEDURE SORT_BY_NAME
     14091**LABEL   14096--EXIT    14102--EXIT
K IN PROCEDURE INSERT_VECTOR
     13742**DCL     13757<<ASSIGN  13758>>IF      13762>>ASSIGN  13767>>ASSIGN
LIST$
     12823**DCL     13075<<ASSIGN  13077>>ASSIGN  13078>>ASSIGN  13079>>IF      13081>>ASSIGN  13084>>IF
     13101>>ASSIGN  13102>>ASSIGN  13124<<ASSIGN  13124>>ASSIGN
LLG$GROW
     10667**DCL-ENT 13771--CALL
LLI$BINHEX
     10668**DCL-ENT 13281--CALL    13288--CALL    13299--CALL    13333--CALL
LLM$MON_SVC
     10666**DCL-ENT 12920--CALL    12933--CALL    12939--CALL    12943--CALL    12964--CALL    12966--CALL
     12967--CALL    12974--CALL    12988--CALL    13001--CALL    13003--CALL    13004--CALL    13057--CALL
     13060--CALL    13062--CALL    13093--CALL    13095--CALL    13103--CALL    13106--CALL    13118--CALL
     13121--CALL    13214--CALL    13215--CALL    13219--CALL    13221--CALL    13273--CALL    13275--CALL
     13283--CALL    13328--CALL    13335--CALL    13342--CALL    13344--CALL    13360--CALL    13372--CALL
     13406--CALL    13415--CALL    13417--CALL    13428--CALL    13435--CALL    13446--CALL    13750--CALL
     13760--CALL    14126--CALL    14127--CALL
LLW$WRTDEF
     10669**DCL-ENT 13104--CALL
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:173  
LL_BOTOMEM$
      9038**DCL     13208>>ASSIGN
LL_DNAME_VEC
      9049**DCL     10685--DCLINIT
LL_DNAME_VEC.BOUND
      9050**DCL     13758>>IF
LL_DNAME_VEC.P$
      9050**DCL     12928>>ASSIGN
LL_DOBUF
      9027**DCL     12963<<CALLBLT 12965<<ASSIGN  12999<<CALLBLT 13002<<ASSIGN  13055<<CALLBLT 13058<<CALLBLT
     13061<<ASSIGN  13091<<CALLBLT 13094<<ASSIGN  13117<<ASSIGN  13119<<CALLBLT 13748<<CALLBLT 14123<<CALLBLT
LL_ENTDEF_R$
      9037**DCL     13104<>CALL    13558>>ASSIGN  13771<>CALL
LL_FLAGS.REMOVE_E#
      9031**DCL     13390>>IF
LL_FLAGS.REMOVE_S#
      9031**DCL     13411>>IF
LL_FLAGS.RF#
      9031**DCL     12951>>IF
LL_HEAD
     12300**DCL     13435--CALL    13435--CALL
LL_HEAD.EDRECSIZE
     12372**DCL     13414>>ASSIGN
LL_HEAD.EPRECSIZE
     12369**DCL     12911>>ASSIGN  13218>>ASSIGN  13385<<ASSIGN  13405>>ASSIGN
LL_HEAD.NRECSIZE
     12366**DCL     12912>>ASSIGN  13213>>ASSIGN  13757>>ASSIGN  13773<<ASSIGN  13773>>ASSIGN
LL_HEAD.REMOVE_ENTDEF
     12400**DCL     13393<<ASSIGN
LL_HEAD.REMOVE_SYMDEF
     12403**DCL     13423<<ASSIGN
LL_HEAD.SEV
     12340**DCL     13090>>IF      13090<<ASSIGN
LL_LIST$
      9053**DCL     13075>>ASSIGN
LL_LIST_SIZE
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:174  
      9053**DCL     13076>>DOINDEX
LL_LOBUF
      9027**DCL     13272<<ASSIGN  13274<<ASSIGN  13282<<ASSIGN  13327<<ASSIGN  13334<<ASSIGN  13341<<ASSIGN
     13343<<ASSIGN  13359<<ASSIGN  13371<<ASSIGN
LL_LPROC_START
      9049**DCL     13768>>ASSIGN
LL_R_CODE$
      9036**DCL     13135>>ASSIGN
LL_R_OU$
      9038**DCL     12938>>ASSIGN  13191>>ASSIGN  13192>>ASSIGN  13193>>ASSIGN  13194>>ASSIGN  13771<>CALL
LL_SECTION.MBZ
     12661**DCL     12663--REDEF   12667--REDEF
LL_SECTION.SIZE
     12655**DCL     13135<<ASSIGN
LL_TOPOMEM$
      9038**DCL     12916>>ASSIGN  13130<<ASSIGN
LL_VECTOR_RF
      9052**DCL     10901--DCLINIT 12963>>CALLBLT 12999>>CALLBLT 13055>>CALLBLT 14123>>CALLBLT
M$CLOSE
      5517**DCL-ENT 12859--CALL    13069--CALL    13198--CALL
M$FID
      5580**DCL-ENT 12953--CALL
M$GDS
      5552**DCL-ENT 13759--CALL
M$MERC
      5573**DCL-ENT 13445--CALL
M$OPEN
      5517**DCL-ENT 12836--CALL    12915--CALL    12954--CALL    13442--CALL
M$READ
      5518**DCL-ENT 12961--CALL    12981--CALL    12995--CALL
M$RF
     11277**DCL     12982--ASSIGN  12996--ASSIGN
M$RU
     11278**DCL     13107--ASSIGN  13222--ASSIGN  13419--ASSIGN
M$WRITE
      5518**DCL-ENT 12842--CALL    12846--CALL    12850--CALL    12858--CALL    13146--CALL    13150--CALL
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:175  
     13158--CALL    13161--CALL    13172--CALL    13183--CALL    13190--CALL
MEM$
     12829**DCL     12921<<ASSIGN  13130>>ASSIGN  13766>>ASSIGN  13767>>ASSIGN  13768>>ASSIGN  13769>>ASSIGN
     13770>>ASSIGN  13771<>CALL    13772<<ASSIGN
NAME IN PROCEDURE INSERT_VECTOR
     13584**DCL     13575--PROC
NAME.COUNT IN PROCEDURE INSERT_VECTOR
     13585**DCL     13592--IMP-SIZ 13748>>CALLBLT 13748>>CALLBLT 13753>>ASSIGN  13754>>ASSIGN  13755>>ASSIGN
     13763>>ASSIGN  13764>>ASSIGN  13765>>CALLBLT
NAME.TEXT IN PROCEDURE INSERT_VECTOR
     13592**DCL     13748>>CALLBLT 13755>>ASSIGN  13764>>ASSIGN
NAME IN PROCEDURE RANGE_END
     13874**DCL     13865--PROC
NAME.COUNT IN PROCEDURE RANGE_END
     13875**DCL     13882--IMP-SIZ 13924>>IF      13926>>ASSIGN  13927>>IF
NAME.TEXT IN PROCEDURE RANGE_END
     13882**DCL     13927>>IF
NAME IN PROCEDURE RANGE_START
     13806**DCL     13797--PROC
NAME.COUNT IN PROCEDURE RANGE_START
     13807**DCL     13814--IMP-SIZ 13855>>IF      13857>>ASSIGN  13858>>IF
NAME.TEXT IN PROCEDURE RANGE_START
     13814**DCL     13858>>IF
NAME$
     12826**DCL     13086<>CALL    13087>>CALL    13111<<ASSIGN  13112>>CALL    13112>>CALL    13131<>CALL
     13132>>ASSIGN
NAME1$
     12821**DCL     13016<>CALL    13017>>IF      13019>>ASSIGN  13022>>ASSIGN  13023>>IF      13025>>ASSIGN
     13028>>ASSIGN  13029>>ASSIGN  13031>>ASSIGN  13050<<ASSIGN  13051<>CALL    13052>>CALL    13052>>CALL
     13058>>CALLBLT 13058>>CALLBLT 13058>>CALLBLT 13077<<ASSIGN  13086<>CALL    13087>>CALL    13087>>CALL
     13091>>CALLBLT 13091>>CALLBLT 13101>>ASSIGN  13108>>CALL    13108>>CALL    13119>>CALLBLT 13119>>CALLBLT
     13119>>CALLBLT 13286<<ASSIGN  13287>>ASSIGN  13287>>ASSIGN  13292>>IF      13292>>IF      13292>>IF
     13297>>ASSIGN  13297>>ASSIGN  13297>>ASSIGN  13306>>IF      13306>>IF      13306>>IF      13313>>IF
     13313>>IF      13313>>IF      13348<<ASSIGN  13351>>IF      13351>>IF      13364>>CALLBLT 13364>>CALLBLT
NAME2$
     12822**DCL     13022<<ASSIGN  13023>>IF      13029>>ASSIGN  13030>>ASSIGN  13051<>CALL    13052>>CALL
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:176  
     13101<<ASSIGN  13109>>CALL    13109>>CALL    13119>>CALLBLT 13119>>CALLBLT 13119>>CALLBLT 13291<<ASSIGN
     13292>>IF      13292>>IF      14118<<ASSIGN  14119>>IF      14119>>IF
NAME_SIZE IN PROCEDURE INSERT_VECTOR
     13740**DCL     13753<<ASSIGN  13756>>ASSIGN  13758>>IF      13773>>ASSIGN  13775>>ASSIGN
NEXT
     12805**DCL     13078<<ASSIGN  13102<<ASSIGN  13102>>ASSIGN  13124>>ASSIGN
NOT_DEFINED
     13090**LABEL   13086--CALLALT
NOT_FOUND
     13055**LABEL   13051--CALLALT
N_DEFNS
     12800**DCL     12912<<ASSIGN  12943>>CALL    12946>>ASSIGN
N_DEFS
     12799**DCL     12911<<ASSIGN  12920>>CALL    12922>>ASSIGN  12933>>CALL    12936>>ASSIGN  12937>>ASSIGN
     12939<>CALL    12942>>ASSIGN  12943>>CALL    12946>>ASSIGN
OFFSET
     12801**DCL     13047<<ASSIGN  13047>>ASSIGN  13063<<ASSIGN  13063>>ASSIGN  13068<<ASSIGN  13068>>ASSIGN
     13081<<ASSIGN  13081>>ASSIGN  13096<<ASSIGN  13096>>ASSIGN  13132>>ASSIGN  13133>>ASSIGN  13134<<ASSIGN
     13134>>ASSIGN  13135>>ASSIGN  13136>>ASSIGN  13147>>ASSIGN  13278<<ASSIGN  13280>>DOWHILE 13281<>CALL
     13284<<ASSIGN  13284>>ASSIGN  13288<>CALL    13330<<ASSIGN  13330>>ASSIGN  13332>>DOWHILE 13333<>CALL
     13336<<ASSIGN  13336>>ASSIGN  13768>>ASSIGN  13788>>ASSIGN  13791>>ASSIGN  13793<<ASSIGN  13793>>ASSIGN
OPEN_RF
     10988**DCL     12954<>CALL
OPEN_RF.ACSVEH_
     10990**DCL     10991--REDEF
OPEN_RF.ALTKEYS_
     10996**DCL     10997--REDEF   10997--REDEF
OPEN_RF.HDR_
     10995**DCL     10996--REDEF
OPEN_RF.TAB_
     10994**DCL     10995--REDEF
OPEN_RF.UHL_
     10988**DCL     10989--REDEF   10989--REDEF
OPEN_RF.V
     10997**DCL     10988--DCLINIT
OPEN_RF.V.ASN#
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:177  
     11007**DCL     10904--DCLINIT
OPEN_RF.V.FSN#
     11028**DCL     11028--REDEF   11028--REDEF
OPEN_RF.V.RES#
     11012**DCL     10904--DCLINIT
OPEN_RF.WSN_
     10994**DCL     10994--REDEF
OPEN_TV
     10761**DCL     12836<>CALL    12915<>CALL    13442<>CALL
OPEN_TV.ACSVEH_
     10763**DCL     10764--REDEF
OPEN_TV.ALTKEYS_
     10769**DCL     10770--REDEF   10770--REDEF
OPEN_TV.HDR_
     10768**DCL     10769--REDEF
OPEN_TV.TAB_
     10767**DCL     10768--REDEF
OPEN_TV.UHL_
     10761**DCL     10762--REDEF   10762--REDEF
OPEN_TV.V
     10770**DCL     10761--DCLINIT
OPEN_TV.V.DELETE#
     10772**DCL     13441<<ASSIGN
OPEN_TV.V.FSN#
     10801**DCL     10801--REDEF   10801--REDEF
OPEN_TV.V.FUN#
     10780**DCL     12914<<ASSIGN
OPEN_TV.WSN_
     10767**DCL     10767--REDEF
OU_ENTRY.HEAD$
     12603**DCL     12938>>ASSIGN  13191>>ASSIGN  13192>>ASSIGN  13193>>ASSIGN  13194>>ASSIGN
OU_ENTRY.OUNAME.SIZE
     12608**DCL     12610--IMP-SIZ
P$ IN PROCEDURE INSERT_VECTOR
     13741**DCL     13762<<ASSIGN  13763>>ASSIGN  13764>>ASSIGN  13764>>ASSIGN  13765>>CALLBLT 13765>>CALLBLT
     13770<<ASSIGN  13771<>CALL    13772>>ASSIGN
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:178  
P$ IN PROCEDURE RANGE_END
     13886**DCL     13865--PROC    13922<<ASSIGN  13923>>ASSIGN  13930>>IF      13935<<ASSIGN  13935>>ASSIGN
P$ IN PROCEDURE RANGE_START
     13818**DCL     13797--PROC    13853<<ASSIGN  13854>>ASSIGN
P$ IN PROCEDURE SEARCH_ENTDEF
     13451**DCL     13450--PROC    13562>>IF      13562>>IF      13566>>IF      13566>>IF
P$ IN PROCEDURE SEARCH_TV
     14113**DCL     14112--PROC    14119>>IF      14119>>IF
Q$ IN PROCEDURE RANGE_END
     13887**DCL     13923<<ASSIGN  13924>>IF      13925>>ASSIGN  13927>>IF      13927>>IF
Q$ IN PROCEDURE RANGE_START
     13819**DCL     13854<<ASSIGN  13855>>IF      13856>>ASSIGN  13858>>IF      13858>>IF
Q$ IN PROCEDURE SEARCH_ENTDEF
     13453**DCL     13558<<ASSIGN  13559>>DOWHILE 13560>>ASSIGN  13564<<ASSIGN  13564>>ASSIGN  13568<<ASSIGN
     13568>>ASSIGN
Q$ IN PROCEDURE SEARCH_TV
     14114**DCL     14112--PROC    14116<<ASSIGN  14118>>ASSIGN  14121<<ASSIGN  14121>>ASSIGN
R$ IN PROCEDURE RANGE_END
     13885**DCL     13865--PROC    13930>>IF
R$ IN PROCEDURE SEARCH_TV
     14115**DCL     14112--PROC    14118>>ASSIGN
RANGE_END
     13865**PROC    13109--CALL
RANGE_ERROR
     13117**LABEL   13108--CALLALT 13109--CALLALT
RANGE_START
     13797**PROC    13108--CALL
READ_ERROR
     12999**LABEL   12981--CALLALT 12995--CALLALT
READ_RF
     11100**DCL     12981<>CALL    12995<>CALL
READ_RF.BUF_.BOUND
     11102**DCL     12978<<ASSIGN  12993<<ASSIGN
READ_RF.BUF_.BUF$
     11103**DCL     12977<<ASSIGN  12992<<ASSIGN
READ_RF.KEY_
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:179  
     11100**DCL     12980<<ASSIGN  12994<<ASSIGN
READ_RF.STATION_
     11103**DCL     11104--REDEF
READ_RF.V
     11104**DCL     11100--DCLINIT
READ_RF.V.DVBYTE.REREAD#
     11115**DCL     11115--REDEF
READ_RF.V.INDX#
     11113**DCL     11113--REDEF
READ_RF_HEAD
     11054**DCL     12961<>CALL
READ_RF_HEAD.BUF_.BOUND
     11056**DCL     12960<<ASSIGN
READ_RF_HEAD.BUF_.BUF$
     11057**DCL     12959<<ASSIGN
READ_RF_HEAD.STATION_
     11057**DCL     11058--REDEF
READ_RF_HEAD.V
     11058**DCL     11054--DCLINIT
READ_RF_HEAD.V.DVBYTE.REREAD#
     11069**DCL     11069--REDEF
READ_RF_HEAD.V.INDX#
     11067**DCL     11067--REDEF
REF$
     12816**DCL     12944<<ASSIGN  13169>>ASSIGN
REF_SIZE
     12808**DCL     13167>>ASSIGN  13168>>ASSIGN  13170>>ASSIGN  13171>>IF      13182>>IF      13191>>ASSIGN
     13193>>ASSIGN  13774>>ASSIGN  13775<<ASSIGN  13775>>ASSIGN
REPEAT_TV_RELOC
     11851**DCL     12902<<ASSIGN  13149--ASSIGN
REPEAT_TV_RELOC.ENDBIT
     11909**DCL     12906<<ASSIGN
REPEAT_TV_RELOC.EVALOP
     11862**DCL     12904<<ASSIGN
REPEAT_TV_RELOC.OPERAND
     11898**DCL     13147<<ASSIGN
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:180  
REPEAT_TV_RELOC.OPNDTYP
     11854**DCL     12903<<ASSIGN
REPEAT_TV_RELOC.RELOCOP
     11882**DCL     12905<<ASSIGN
REPEAT_TV_RELOC.VALUE
     11912**DCL     12907<<ASSIGN
REPEAT_TV_RELOC_KEY
     11612**DCL     12877>>ASSIGN  13148--ASSIGN
REPEAT_TV_RELOC_KEY.KEYSIZ
     11613**DCL     12867<<ASSIGN
REPEAT_TV_RELOC_KEY.OFFSET
     11627**DCL     12869<<ASSIGN
REPEAT_TV_RELOC_KEY.SECTNUM
     11624**DCL     12868<<ASSIGN
REPEAT_TV_RELOC_KEY.SEQUENCE
     11635**DCL     12871<<ASSIGN
REPEAT_TV_RELOC_KEY.SUBTYPE
     11630**DCL     12870<<ASSIGN
REPEAT_TV_RELOC_KEY.UTS
     11619**DCL     12872<<ASSIGN
RF_DEF$
     12817**DCL     12975<<ASSIGN  12977>>ASSIGN  13016<>CALL    13038<>CALL    13050>>ASSIGN
RF_DEF_SIZE
     12796**DCL     12982<<ASSIGN
RF_EDEF$
     12818**DCL     12989<<ASSIGN  12992>>ASSIGN  13011>>CALL    13017>>IF      13223<<ASSIGN  13225>>ASSIGN
     13231>>CALL    13239>>IF      13253>>ASSIGN  13255>>ASSIGN  13256>>ASSIGN  13276>>ASSIGN  13385>>ASSIGN
     13399>>ASSIGN  13400>>CALL    13406<>CALL    14116>>ASSIGN
RF_EDEF_SIZE
     12797**DCL     12996<<ASSIGN  13006>>ASSIGN
RF_HEAD
     11930**DCL     12959--ASSIGN  12960--ASSIGN
RF_HEAD.EPRECSIZE
     11999**DCL     12987>>ASSIGN
RF_HEAD.NRECSIZE
     11996**DCL     12973>>ASSIGN
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:181  
RF_HEAD_KEY
     11920**DCL     11054--DCLINIT 11055--DCLINIT 13435<>CALL
RUN_FILE
     10901**DCL     12953<>CALL
RUN_FILE.V
     10905**DCL     10901--DCLINIT
SEARCH_ENTDEF
     13450**PROC    13051--CALL    13086--CALL    13131--CALL
SEARCH_TV
     14112**PROC    13016--CALL    13038--CALL    13237--CALL    13251--CALL
SECT_ENTRY.SECTION$
     12547**DCL     13135>>ASSIGN
SIZE IN PROCEDURE RANGE_END
     13888**DCL     13925<<ASSIGN  13926<<ASSIGN  13927>>IF
SIZE IN PROCEDURE RANGE_START
     13817**DCL     13856<<ASSIGN  13857<<ASSIGN  13858>>IF
SIZE IN PROCEDURE SORT_BY_NAME
     14082**DCL     14080--IMP-SIZ 14104<<ASSIGN  14105>>IF      14106>>ASSIGN  14106>>ASSIGN
SORT_BY_NAME
     13939**PROC    13267--CALL    13400--CALL
SORT_BY_VALUE IN PROCEDURE SORT_BY_NAME
     14085**ENTRY   13011--CALL    13231--CALL
START$
     12819**DCL     12935<<ASSIGN  13142>>ASSIGN  13143>>ASSIGN  13144>>IF      13237<>CALL    13238>>ASSIGN
     13239>>IF      13242>>ASSIGN  13243>>IF      13246>>ASSIGN  13248<<ASSIGN  13253>>ASSIGN  13276<<ASSIGN
     13279>>DOWHILE 13280>>DOWHILE 13286>>ASSIGN  13300>>ASSIGN  13301>>ASSIGN  13329<<ASSIGN  13329>>ASSIGN
STOP$
     12827**DCL     13251<>CALL    13252>>ASSIGN  13257>>DOWHILE 13262>>ASSIGN  13263<<ASSIGN  13263>>ASSIGN
     13265>>ASSIGN  13277>>ASSIGN  13279>>DOWHILE 13394>>DOWHILE 13395>>ASSIGN  13396<<ASSIGN  13396>>ASSIGN
TEMP
     12798**DCL     12973<<ASSIGN  12974<>CALL    12976>>ASSIGN  12978>>ASSIGN  12987<<ASSIGN  12988<>CALL
     12990>>ASSIGN  12993>>ASSIGN  13006<<ASSIGN  13107<<ASSIGN  13222<<ASSIGN  13225>>ASSIGN  13253<<ASSIGN
     13254>>DOINDEX 13266<<ASSIGN  13399<<ASSIGN  13414<<ASSIGN  13415<>CALL    13417>>CALL    13419<<ASSIGN
     13420>>IF      13424>>DOINDEX 13428>>CALL    13852>>DOINDEX 13921>>DOINDEX 14087>>ASSIGN  14091>>DOINDEX
     14117>>DOINDEX
TEMP_EDEF
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:182  
     12806**DCL     13028<<ASSIGN  13030>>ASSIGN  13255<<ASSIGN  13262>>ASSIGN  13303<<ASSIGN  13325>>ASSIGN
TEMP_EDEF IN PROCEDURE SORT_BY_NAME
     14011**DCL     14090<<ASSIGN  14104--ASSIGN  14107>>ASSIGN
TEMP_EDEF.ISADDR IN PROCEDURE SORT_BY_NAME
     14034**DCL     14094>>IF
TEMP_EDEF.NPOINTER IN PROCEDURE SORT_BY_NAME
     14036**DCL     14099>>IF      14099>>IF
TEMP_EDEF.OU IN PROCEDURE SORT_BY_NAME
     14028**DCL     14034--REDEF
TPTR$
     12820**DCL     12934<<ASSIGN  13143>>ASSIGN  13144>>IF      13242<<ASSIGN  13243>>IF      13246>>ASSIGN
     13247>>ASSIGN  13248>>ASSIGN  13256<<ASSIGN  13257>>DOWHILE 13258>>ASSIGN  13259>>ASSIGN  13260<<ASSIGN
     13289<<ASSIGN  13290>>DOWHILE 13291>>ASSIGN  13295<<ASSIGN  13295>>ASSIGN  13298>>ASSIGN  13301>>ASSIGN
     13302>>ASSIGN  13303>>ASSIGN  13304>>ASSIGN  13311>>ASSIGN  13346<<ASSIGN  13347>>DOWHILE 13348>>ASSIGN
     13349>>ASSIGN  13366<<ASSIGN  13418<<ASSIGN  13425>>ASSIGN  13426<<ASSIGN  13426>>ASSIGN  13787>>ASSIGN
     13788>>ASSIGN  13789<<ASSIGN  13789>>ASSIGN  13790>>ASSIGN  13791>>ASSIGN  13792<<ASSIGN  13792>>ASSIGN
TPTR1$
     12814**DCL     12941<<ASSIGN  13258<<ASSIGN  13259>>ASSIGN  13260>>ASSIGN  13277<<ASSIGN  13325>>ASSIGN
     13326<<ASSIGN  13326>>ASSIGN  13374>>IF      13376<<ASSIGN  13380>>ASSIGN  13381<<ASSIGN  13381>>ASSIGN
     13385>>ASSIGN  13394>>DOWHILE 13399>>ASSIGN  13774>>ASSIGN  13776>>ASSIGN  13777>>ASSIGN  13778>>ASSIGN
     13779>>ASSIGN  13780>>ASSIGN  13781<<ASSIGN  13781>>ASSIGN
TPTR2$
     12815**DCL     12945<<ASSIGN  13304<<ASSIGN  13305>>DOWHILE 13306>>IF      13306>>IF      13309<<ASSIGN
     13309>>ASSIGN  13319>>DOWHILE 13320>>ASSIGN  13322<<ASSIGN  13322>>ASSIGN  13349<<ASSIGN  13350>>DOWHILE
     13351>>IF      13351>>IF      13354<<ASSIGN  13354>>ASSIGN  13366>>ASSIGN  13754>>ASSIGN  13755>>ASSIGN
     13755>>ASSIGN  13756<<ASSIGN  13756>>ASSIGN
TPTR3$
     12828**DCL     13311<<ASSIGN  13312>>DOWHILE 13313>>IF      13313>>IF      13316<<ASSIGN  13316>>ASSIGN
     13318<<ASSIGN  13318>>ASSIGN  13320>>ASSIGN  13321<<ASSIGN  13321>>ASSIGN  13324>>ASSIGN
TREE.L_CHILD$ IN PROCEDURE SEARCH_ENTDEF
     13482**DCL     13568>>ASSIGN
TREE.NODE$ IN PROCEDURE SEARCH_ENTDEF
     13471**DCL     13560>>ASSIGN
TREE.R_CHILD$ IN PROCEDURE SEARCH_ENTDEF
     13484**DCL     13564>>ASSIGN
TV_DEF_NAMES
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:183  
     12672**DCL     12734--DCLINIT 12840--ASSIGN  12841--ASSIGN
TV_EDEF
     12683**DCL     12738--DCLINIT 12739--DCLINIT 12849--ASSIGN  13160--ASSIGN
TV_EDEF.TV_END
     12696**DCL     13252<<ASSIGN
TV_EDEF.TV_END.ISADDR
     12701**DCL     13332>>DOWHILE
TV_EDEF.TV_END.OU
     12698**DCL     12701--REDEF
TV_EDEF.TV_END.OU.OFFSET
     12700**DCL     13133<<ASSIGN
TV_EDEF.TV_START
     12684**DCL     13238<<ASSIGN  13247>>ASSIGN
TV_EDEF.TV_START.ISADDR
     12689**DCL     13278>>ASSIGN
TV_EDEF.TV_START.OU
     12686**DCL     12689--REDEF
TV_END_NAME
     11446**DCL     13038--CALL    13131--CALL    13251--CALL
TV_HEAD
     12721**DCL     12856--ASSIGN  12857--ASSIGN  13189--ASSIGN
TV_HEAD.EREFPSIZ
     12741**DCL     13181<<ASSIGN
TV_HEAD.EREFSIZ
     12740**DCL     13180<<ASSIGN
TV_HEAD.RELPSIZ
     12733**DCL     12937<<ASSIGN  12938>>ASSIGN
TV_HEAD.RNAMPSIZ
     12737**DCL     13168<<ASSIGN
TV_HEAD.RNAMSIZ
     12736**DCL     13167<<ASSIGN
TV_HEAD_KEY
     12784**DCL     12855--ASSIGN  13188--ASSIGN
TV_MSG.BUFFER
     12768**DCL     13327>>ASSIGN
TV_MSG.MSG
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:184  
     12758**DCL     12768--REDEF
TV_MSG.MSG.ADDR1
     12761**DCL     13288<>CALL
TV_MSG.MSG.ADDR2
     12765**DCL     13299<>CALL
TV_MSG.MSG.NAME1
     12763**DCL     13297<<ASSIGN
TV_MSG.MSG.NAME2
     12767**DCL     13287<<ASSIGN
TV_OU_KEY
     12788**DCL     12837--ASSIGN  13155--ASSIGN
TV_OU_KEY.TYPE
     12792**DCL     12839<<ASSIGN  12844<<ASSIGN  12848<<ASSIGN  13156<<ASSIGN  13159<<ASSIGN  13166<<ASSIGN
     13177<<ASSIGN
TV_SECTION
     12709**DCL     12845--ASSIGN  13157--ASSIGN
TV_SECTION.SIZE
     12717**DCL     13136<<ASSIGN
TV_STAR
     11272**DCL     10762--DCLINIT
TV_START_NAME
     11424**DCL     13016--CALL    13237--CALL
VECTOR_LIST
     12802**DCL     13077--ASSIGN
VECTOR_LIST.SIZEW1
     12803**DCL     13078>>ASSIGN  13079>>IF      13101>>ASSIGN
VECTOR_LIST.SIZEW2
     12804**DCL     13081>>ASSIGN  13084>>IF      13102>>ASSIGN
VLP_ACCT
     11178**DCL     10902--DCLINIT 10993--DCLINIT
VLP_NAME
     11244**DCL     10902--DCLINIT 10989--DCLINIT
VLP_PASS
     11191**DCL     10903--DCLINIT 10990--DCLINIT
VLP_SN
     11217**DCL     10903--DCLINIT 10988--DCLINIT
PL6.E3A0      #001=LLT$TRANSVECT File=LLT$TRANSVECT.:E05TSI                      WED 07/30/97 03:17 Page:185  
VLP_WSN
     11204**DCL     10903--DCLINIT 10994--DCLINIT
WRITE_TV
     10867**DCL     12842<>CALL    12846<>CALL    12850<>CALL    12858<>CALL    13146<>CALL    13150<>CALL
     13158<>CALL    13161<>CALL    13172<>CALL    13183<>CALL    13190<>CALL
WRITE_TV.BUF_
     10867**DCL     12845<<ASSIGN  12849<<ASSIGN  13149<<ASSIGN  13157<<ASSIGN  13160<<ASSIGN  13189<<ASSIGN
WRITE_TV.BUF_.BOUND
     10867**DCL     12841<<ASSIGN  12857<<ASSIGN  13143<<ASSIGN  13170<<ASSIGN  13179<<ASSIGN
WRITE_TV.BUF_.BUF$
     10869**DCL     12840<<ASSIGN  12856<<ASSIGN  13142<<ASSIGN  13169<<ASSIGN  13178<<ASSIGN
WRITE_TV.KEY_
     10867**DCL     12837<<ASSIGN  12855<<ASSIGN  13141<<ASSIGN  13148<<ASSIGN  13155<<ASSIGN  13188<<ASSIGN
WRITE_TV.STATION_
     10869**DCL     10869--REDEF
WRITE_TV.V
     10870**DCL     10867--DCLINIT
WRITE_TV.V.DVBYTE.VFC#
     10876**DCL     10876--REDEF
